/*!
*  filename: ej.pivotgauge.common.min.js
*  version : 14.2.0.26
*  Copyright Syncfusion Inc. 2001 - 2016. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min"],n):n()})(function(){ej.pivotgauge=ej.pivotgauge||{},function(n,t){t.pivotgauge.common={getJSONData:function(n,i){t.olap.base.getJSONData({action:n.action},i,n.activeObject)},generateJSON:function(n,t){var i,r,u;return this.baseObj=n.baseObj,this.pivotEngine=t,this.kpiInfo=[],pivotRecords="",this.baseObj._measureDt&&this.baseObj._measureDt.isKpiExist?(u=this.baseObj._measureDt.axis,t&&(u=="colheader"?(i=t.length,r=i?t[0].length:0):(r=t.length,i=r?t[0].length:0)),this._getKpiHeadersCollection(i,r,u)):this._getSummaryInfo(),pivotRecords=JSON.stringify(this.kpiInfo),this._renderControlSuccess({PivotRecords:pivotRecords,OlapReport:"null"}),this.kpiInfo},_getKpiHeadersCollection:function(t,i,r){var k=this.pivotEngine,o={},v,y,p,w,h,s,l,b,a,u,f,e,c;for(r=="rowheader"?(v=t,y=i,p=i,w=t,h="rowheader",s="colheader"):r=="colheader"&&(v=i,y=t,s="rowheader",h="colheader",p=t,w=i),u=0;u<y;u++){for(f=0;f<v;f++)if(e=null,e=r=="rowheader"?this.pivotEngine[f][u]:this.pivotEngine[u][f],e.CSS==h)o=this._fillKpiInfo_kpiAxis(e,h,u,o);else break;c=0;(c=this._isKpiExist(o))?this._copyKpi(parseInt(c),o):n.isEmptyObject(o)||this.kpiInfo.push(o);o={}}for(l={},b=this.kpiInfo,this.kpiInfo=[],u=0;u<w;u++){for(f=0;f<p;f++)if(e=null,r=="rowheader"?(e=this.pivotEngine[u][f],this.pivotEngine[f][u-1]&&(a=this.pivotEngine[f][u-1])):(e=this.pivotEngine[f][u],this.pivotEngine[f-1]&&(a=this.pivotEngine[f-1][u])),e&&e.CSS==s&&e.Value!="")l=this._fillKpiInfo_kpiAxis(e,s,u,o);else break;c=0;a&&a.CSS==s&&e.CSS.indexOf("summary")==-1&&this._mergeValues(l,b,r,u,f);l={}}},_mergeValues:function(t,i,r,u,f){for(var s={},h=i.length,e={},o=0;o<h;o++)e=i[o],t.MemberRowIndex?e.MemberRowIndex=t.MemberRowIndex:t.MemberColIndex&&(e.MemberColIndex=t.MemberColIndex),e.MemberName?t.MemberName&&(e.MemberName+="-"+t.MemberName):e.MemberName=t.MemberName,r=="rowheader"?(e.ValueIndex>0&&(e.MeasureValue=this.pivotEngine[f][e.ValueIndex].ActualValue,e.ActualMeasureValue=this.pivotEngine[f][e.ValueIndex].Value),e.TrendIndex>0&&(e.TrendValue=this.pivotEngine[f][e.TrendIndex].Value),e.StatusIndex>0&&(e.StatusValue=this.pivotEngine[f][e.StatusIndex].Value),e.GoalIndex>0):r=="colheader"&&(e.ValueIndex>0&&(e.MeasureValue=this.pivotEngine[e.ValueIndex][u].ActualValue,e.ActualMeasureValue=this.pivotEngine[e.ValueIndex][u].Value),e.TrendIndex>0&&(e.TrendValue=this.pivotEngine[e.TrendIndex][u].Value),e.StatusIndex>0&&(e.StatusValue=this.pivotEngine[e.StatusIndex][u].Value),e.GoalIndex>0&&(e.GoalValue=this.pivotEngine[e.GoalIndex][u].Value,e.ActualGoalValue=this.pivotEngine[e.GoalIndex][u].ActualValue)),e.IsValidKpi=!0,s={ActualMeasureValue:0,GoalCaption:"",Kpi_Name:"",MeasureCaption:"",GoalValue:"",ActualGoalValue:0,MeasureValue:"",MemberName:"",StatusValue:-2,TrendValue:-2,TrendGraphic:null,StatusGraphic:null,ValueIndex:"",TrendIndex:-1,GoalIndex:"",StatusIndex:-1,MemberRowIndex:null,MemberColIndex:null,IsValidKpi:!0},this.kpiInfo.push(n.extend(s,e))},_isKpiExist:function(n){for(var t=0;t<this.kpiInfo.length;t++)if(this.kpiInfo[t].MemberName==n.MemberName&&this.kpiInfo[t].Kpi_Name==n.Kpi_Name)return t+"";return!1},_copyKpi:function(t,i){this.kpiInfo[t]=n.extend(this.kpiInfo[t],i)},_fillKpiInfo_kpiAxis:function(n,t,i,r){var u=n.Info.split("::")[0],f;if(!n.kpiInfo&&n.CSS==t&&u.indexOf("[Measures]")>-1&&!n.kpiInfo)r.Kpi_Name=this._getKpiName(u),r.MeasureCaption=n.Value,r.ValueIndex=i;else if(n.CSS==t){n.kpiInfo?r.Kpi_Name=n.kpiInfo.Value:(!r.MemberName&&n.Value?r.MemberName=n.Value:n.Value&&(r.MemberName+=" - "+n.Value),t=="colheader"?r.MemberColIndex=i:r.MemberRowIndex=i);f=n.kpi?n.kpi:"none";switch(f){case"status":r.StatusGraphic=n.kpiInfo.Graphic;r.StatusIndex=i;break;case"goal":r.GoalCaption=n.Value;r.GoalIndex=i;break;case"trend":r.TrendGraphic=n.kpiInfo.Graphic;r.TrendIndex=i}}return r},_getSummaryInfo:function(){for(var e,i={},r=this,f=n.map(this.pivotEngine,function(u){var o=!1,e,f;if(i.Measure="",i.Value="",i.DoubleValue=0,t.browserInfo().name=="msie"&&t.browserInfo().version<=8){for(f=0;f<u.length;f++)(u[f].CSS.indexOf("summary col")>-1||u[f].CSS.indexOf("summary cgtot calc")>-1)&&(o=!0),(o&&u[f].Info.indexOf("[Measures]")>-1||u[f].CSS.indexOf("summary cgtot calc")>-1)&&(i.Measure=u[f].Value);if(!o||r._dataModel=="Pivot"){if(o&&r._dataModel=="Pivot")return i.Value=u[f-1].Value.toString(),i.DoubleValue=u[f-1].Value,n.extend({},i)}else return i.Value=u[f-1].ActualValue,i.DoubleValue=parseFloat(u[f-1].ActualValue),n.extend({},i)}else{for(e in u)(u[parseInt(e)].CSS.indexOf("summary col")>-1||u[parseInt(e)].CSS.indexOf("summary cgtot calc")>-1)&&(o=!0),(o&&u[parseInt(e)].Info.indexOf("[Measures]")>-1||u[parseInt(e)].CSS.indexOf("summary cgtot calc")>-1)&&(i.Measure=u[parseInt(e)].Value);if(!o||r._dataModel=="Pivot"){if(o&&r._dataModel=="Pivot")return i.Value=u[parseInt(e)].Value.toString(),i.DoubleValue=u[parseInt(e)].Value,n.extend({},i)}else return i.Value=u[parseInt(e)].ActualValue,i.DoubleValue=parseFloat(u[parseInt(e)].ActualValue),n.extend({},i)}}),u=0;u<f.length;u++)e={Caption:null,Object:null,CellIndex:-1,Type:-1,Measure:"",ClassName:"",DoubleValue:0,ExpandState:0,HasChildren:!1,Level:-1,RowIndex:3,Range:null,Span:null,Tag:null,UniqueName:"",Value:""},this.kpiInfo.push(n.extend(e,f[u]))},_getKpiName:function(t){var r=this.baseObj._kpi,i="";return(i=n(r).find("row:contains('"+t+"')"),i)?n(i).find("KPI_NAME").text():""}}}(jQuery,Syncfusion)});
