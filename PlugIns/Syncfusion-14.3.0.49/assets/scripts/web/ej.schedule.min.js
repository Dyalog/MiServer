/*!
*  filename: ej.schedule.min.js
*  version : 14.3.0.49
*  Copyright Syncfusion Inc. 2001 - 2016. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.globalize.min","jsrender","./../common/ej.core.min","./../common/ej.data.min","./../common/ej.touch.min","./../common/ej.draggable.min","./../common/ej.scroller.min","./ej.button.min","./ej.checkbox.min","./ej.autocomplete.min","./ej.datepicker.min","./ej.dialog.min","./ej.dropdownlist.min","./ej.togglebutton.min","./ej.radiobutton.min","./ej.timepicker.min","./ej.editor.min","./ej.navigationdrawer.min","./ej.recurrenceeditor.min","./ej.tooltip.min"],n):n()})(function(){(function(n,t){t.scheduleFeatures=t.scheduleFeatures||{};var r=function(){return this._horiDateHeader="{{if multiRes == true}}<td class = 'e-horizontalheader'><div class='e-horizontalresheader'>{{:label}}<\/div><\/td>{{else}}{{/if}}<td class='e-horizontaldaterender'><div class='e-horizontaltimecells' style='height:{{:height}}px;'><div class='e-headerdays' style='position:absolute;'><table class ='e-table' cellpadding='0px' cellspacing='0px' style='width:100%;border-collapse:separate;'><tbody>{{if view !== 'month'}}<tr style='width:100%;'> <td>{{if view === 'day'}}<table cellspacing='0px' style='width:100%;'>{{else}}<table class='e-table' cellspacing='0px'>{{/if}}<tbody><tr> {{for cols ~headercellWidth = headercellWidth}}<td class='e-headercells {{:cellToday}} e-horizontalheadertddate'><div class='{{:currentDateClass}} e-horizontalheaderdiv'>{{:currentDay}}<\/div><\/td>{{/for}} <\/tr><\/tbody><\/table><\/td> <\/tr><tr style='width:100%;position:absolute;'> <td><table class =' e-table e-horizontaltabletimecell' cellspacing='0px' style='border-collapse:collapse;'><tbody><tr> {{for timeTdCount  ~columnvalue =column  }}{{for ~name=time ~dayend=timecellclass ~index=#getIndex() }}<td class='e-horizontaltimetd {{:~dayend}}'><div style='width:{{:timeCellWidth}}'><span class ='e-horizontaltimespan'>{{:~name.slice(0,2)}}<\/span><div class ='e-horizontaltimespandiv'>{{:~name.slice(3,5)}}<\/div><\/div><\/td>{{for ~columnvalue[~index] ~width = timeCellWidth}}<td class='e-horizontalalternatetd'><div style='width:{{:~width}}'><\/div><\/td>{{/for}}{{/for}}{{/for}}  <\/tr><\/tbody><\/table><\/td> <\/tr>{{/if}}{{if view == 'month'}}<tr>{{for cols}}<td class='e-headercells e-horizontmonthheaderdatetd {{:cellToday}}'><div class='e-dateheadercell e-horizontmonthdatealign'>{{:currentDate}}<\/div><\/td>{{/for}}<\/tr><tr>{{for cols}}<td class ='e-horizontmonthheaderdaytd'><div class='e-dateheadercell e-horizontmonthdatealign' style='width:{{:cellWidth}}'>{{:currentDay}}<\/div><\/td>{{/for}}<\/tr>{{/if}}<\/tbody><\/table><\/div><\/div><\/td>",this._horiDateHeader},u=function(){return this._userTimeCellsHoriTemplate="{{if multiRes == true}}<td class = 'e-horizontalheader'><div class='e-horizontalresheader'>{{:label}}<\/div><\/td>{{else}}{{/if}}<td class='e-horizontaldaterender'><div class='e-horizontaltimecells' style='height:{{:height}}px;'><div class='e-headerdays' style='position:absolute;'><table class ='e-table' cellpadding='0px' cellspacing='0px' style='width:100%;border-collapse:separate;'><tbody>{{if view !== 'month'}}<tr style='width:100%;'> <td>{{if view === 'day'}}<table cellspacing='0px' style='width:100%;'>{{else}}<table class='e-table' cellspacing='0px'>{{/if}}<tbody><tr> {{for cols ~headercellWidth = headercellWidth}}<td class='e-headercells {{:cellToday}} e-horizontalheadertddate'><div class='{{:currentDateClass}} e-horizontalheaderdiv'>{{:currentDay}}<\/div><\/td>{{/for}} <\/tr><\/tbody><\/table><\/td> <\/tr><tr style='width:100%;position:absolute;'> <td><table class='e-table e-horizontaltabletimecell' cellspacing='0px' style='border-collapse:collapse;'><tbody><tr> {{for timeTdCount  ~userTemplateId = userTemplateId  ~template=template  ~columnvalue =column}}{{for ~name=time ~names=times ~dayend=timecellclass }}<td class='e-horizontaltimetd {{:~dayend}}'><div style='width:{{:timeCellWidth}}'><span class ='e-horizontaltimespan'>{{:~name}}<\/span><div class ='e-horizontaltimespandiv'><\/div><\/div><\/td>{{for ~columnvalue ~width = timeCellWidth ~names=~names}}<td class='e-horizontalalternatetd' style='vertical-align:middle !important;'><div style='width:{{:~width}};' > {{if ~template ==true || ~userTemplateId==true }}{{:~names[#getIndex()]}}{{else}}<\/div>{{/if}}<\/td>{{/for}}{{/for}}{{/for}}  <\/tr><\/tbody><\/table><\/td> <\/tr>{{/if}}{{if view == 'month'}}<tr>{{for cols}}<td class='e-headercells e-horizontmonthheaderdatetd {{:cellToday}}'><div class='e-dateheadercell e-horizontmonthdatealign'>{{:currentDate}}<\/div><\/td>{{/for}}<\/tr><tr>{{for cols}}<td class ='e-horizontmonthheaderdaytd'><div class='e-dateheadercell e-horizontmonthdatealign' style='width:{{:cellWidth}}'>{{:currentDay}}<\/div><\/td>{{/for}}<\/tr>{{/if}}<\/tbody><\/table><\/div><\/div><\/td>",this._userTimeCellsHoriTemplate},f=function(){return this._horizontalResHeader="<div class ='e-horizontresdiv'><div class='e-horires' style='height:100%'><table class='e-table e-resourceheadertable' width='100%' cellpadding='0px' cellspacing='0px' style='table-layout:fixed'><tbody>{{for trs}}<tr class='e-horizontresheaderdiv'>{{for ~resname=name ~marginleft=marginleft }}{{if classname == 'e-parentnode'}}<td class='{{:classname}} resemptytd' style='width:25px;height:{{:cellHeight}}'><\/td>{{else}}<td class='resemptytd' style='width:25px;height:{{:cellHeight}}'><\/td>{{/if}}<td class='{{:classname}}' style='vertical-align:middle;height:{{:cellHeight}};'>{{if classname == 'e-parentnode'}}<div id={{:idnum}} class='{{:classname}}category e-resourceicon e-resourcecollapse' style='width:20px;vertical-align:middle;float:left;margin-left:{{:~marginleft}};margin-top:2px;'><\/div>{{/if}}<div class='e-resourceheadertext' style='text-align:left;margin-left:{{:~marginleft}};' title='{{if userResTemplId == true}}{{:name}}{{else}}{{:~resname}}{{/if}}'>{{if userResTemplId == true}}{{:userResHeader}}{{else}}{{:~resname}}{{/if}}<\/div><\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table><\/div><\/div>",this._horizontalResHeader},e=function(){return this._cellsTemplate="<table class='e-table e-workcellstab'cellpadding='0px' cellspacing='0px'><tbody>{{for cellrows ~cols=cols ~hourdiff=hourdiff ~view=view ~classname=classname ~columnvalue=column ~userTemp=userTemplate ~userHtml=userHtml}}{{if classname == 'e-parentnode'}} <tr class='e-resourceheadertr' style='width:100%'>{{for ~cols ~value=#getIndex()}}{{if #index % ~hourdiff == 0 && #index != 0 && ~view !== 'month' }}<td class='e-resourceheadercells e-workcells e-parentworkcell e-dayend' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{else}}<td class='e-resourceheadercells e-workcells e-parentworkcell' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{/if}}{{if ~userTemp == true}}{{if ~view !== 'month'}}{{:~userHtml[~value][0][#getIndex()]}}{{else}}{{:~userHtml[~value][#getIndex()]}}{{/if}}{{/if}}<\/td>{{if ~view !== 'month' ~val=#index}}{{for ~columnvalue[#getIndex()] ~width = cellWidth}}<td class='e-resourceheadercells e-workcells e-parentworkcell e-alternateworkcell' style='width:{{:~width}};height:{{:cellHeight}}'>{{if ~userTemp == true}}{{:~userHtml[~value][1][~val][#getIndex()]}}{{/if}}<\/td>{{/for}}{{/if}}{{/for}}<\/tr>{{else}}<tr style='width:100%'>{{for ~cols ~value=#getIndex()}}{{if #index % ~hourdiff == 0 && #index != 0 && ~view !== 'month'  }}<td class='e-workcells e-childworkcell e-dayend' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{else}}<td class='e-workcells e-childworkcell' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{/if}}{{if ~userTemp == true}}{{if ~view !== 'month'}}{{:~userHtml[~value][0][#getIndex()]}}{{else}}{{:~userHtml[~value][#getIndex()]}}{{/if}}{{/if}}<\/td>{{if ~view !== 'month' ~val=#index}}{{for ~columnvalue[#getIndex()] ~width = cellWidth}}<td class='e-workcells e-childworkcell e-alternateworkcell' style='width:{{:~width}};height:{{:cellHeight}}'>{{if ~userTemp == true}}{{:~userHtml[~value][1][~val][#getIndex()]}}{{/if}}<\/td>{{/for}}{{/if}}{{/for}}<\/tr>{{/if}}{{/for}}<\/tbody><\/table>",this._cellsTemplate};t.scheduleFeatures.horizontal={_renderHorizontalTemplates:function(){this.horizontalHeader=n.templates(this._createTemplate(r(),"_HorizontalHeader"));this.cellTemplate=n.templates(this._createTemplate(e(),"_HorizontalCells"));this.horizontalResHeader=n.templates(this._createTemplate(f(),"_HorizontalResources"));this.userTimeCellHoriTemplate=n.templates(this._createTemplate(u(),"_userTimeCells"))},_horizontalViewNavigation:function(i){var e,r,o,s,u,h,f,c;if(i.type=="click"){if(this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7){if(this.element.find(".e-headercells").children().removeClass("e-activeview"),e=i.currentTarget.cellIndex,r=new Date(this._dateRender[e]),this.model.minDate<=r&&this.model.maxDate>=r)this.model.timeScale.enable&&n(i.currentTarget).children().addClass("e-activeview"),this.currentDate(r);else return!1;this.model.highlightBusinessHours!=!0||t.isNullOrUndefined(this.model.businessStartHour)?(o=this.element.find(".e-workcells")[parseInt(e*(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))].offsetLeft,this.element.find(".e-hscroll").length>0&&(this.model.enableRTL?(s=this.element.find(".e-workcells")[0].offsetLeft,u=s-o,n("div#"+this._id+"_scroller").ejScroller({scrollLeft:u}),h=s+this.element.find(".e-workcells").width()-this.element.find(".e-draggableworkarea").width(),u=u>=h?h:u,n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",u+"px")):(n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-o+"px"),n("div#"+this._id+"_scroller").ejScroller({scrollLeft:o})))):this._businessHourScroller()}else if(this.currentView()=="month"||this._isCustomMonthView()){if(e=i.currentTarget.cellIndex,this.model.views.indexOf("day")==-1)return!1;if(r=new Date(this.monthDays[e]),this.model.minDate<=r&&this.model.maxDate>=r)this.currentDate(r);else return!1;this._navView=!0;this._viewChange(i,this.currentView(),"day")}}else if(i.type=="dblclick"&&(this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7)){if(f=n(i.target),c=f.hasClass("e-headercells")?f:f.parent().hasClass("e-headercells")?f.parent():f.parent().parent(),this.model.views.indexOf("day")==-1||!c.hasClass("e-headercells"))return!1;if(r=new Date(this._dateRender[c.index()]),this.model.minDate<=r&&this.model.maxDate>=r)this.currentDate(r);else return!1;this._navView=!0;this._viewChange(i,this.currentView(),"day")}},_renderHorizontalHeaderDays:function(i){var u,o,s,h,c,f,e,r;if(this.element.find(".e-headercells").addClass("e-dateheaderselect"),this.currentView()==="month"||this._isCustomMonthView())for(e=this._horizontalMonthDates(),r=0;r<e.length;r++)new Date(new Date(e[r]).setHours(0,0,0,0)).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()&&n(this.element.find("td.e-headercells")[r]).addClass("e-currentdayhighlight");else{if(this.element.find(".e-currentdayhighlight").removeClass("e-currentdayhighlight"),t.isNullOrUndefined(this.model.dateHeaderTemplateId))for(r=0;r<this._dateRender.length;r++)u=this._mediaQuery&&(this.currentView()=="week"||this.currentView()=="workweek")?this._dayNames[new Date(this._dateRender[r]).getDay()].split("")[0]:this.currentView()==="day"?this._tempResource.length==0&&t.isNullOrUndefined(this.model.group)?i.calendar.days.names[new Date(this._dateRender[r]).getDay()]:this._dayShortNames[new Date(this._dateRender[r]).getDay()]:this._dayShortNames[new Date(this._dateRender[r]).getDay()],o=this.model.timeScale.enable?this._mediaQuery&&(this.currentView()=="week"||this.currentView()=="workweek")?u+parseInt(t.format(new Date(this._dateRender[r]),"dd")):this.currentView()==="day"?this._tempResource.length==0&&t.isNullOrUndefined(this.model.group)?u+" "+t.format(new Date(this._dateRender[r]),"dd MMMM yyyy"):u+" "+t.format(new Date(this._dateRender[r]),"dd MMM yy"):u+" "+new Date(this._dateRender[r]).getDate():this._mediaQuery&&(this.currentView()=="week"||this.currentView()=="workweek")?u+parseInt(t.format(new Date(this._dateRender[r]),"dd")):this.currentView()==="day"?this._tempResource.length==0&&t.isNullOrUndefined(this.model.group)?t.format(new Date(this._dateRender[r]),"dd MMMM yyyy"):t.format(new Date(this._dateRender[r]),"dd MMM yy"):("0"+new Date(this._dateRender[r]).getDate()).slice(-2),n(this.element.find(".e-headercells")[r]).find("div")[0].innerHTML=o,new Date(new Date(this._dateRender[r]).setHours(0,0,0,0)).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()&&n(this.element.find("td.e-headercells")[r]).addClass("e-currentdayhighlight");else for(s=this._getUserDateheaderTemplate(),r=0;r<this._dateRender.length;r++)n(this.element.find(".e-headercells")[r]).find("div")[0].innerHTML=s[r].currentDay,new Date(new Date(this._dateRender[r]).setHours(0,0,0,0)).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()&&n(this.element.find("td.e-headercells")[r]).addClass("e-currentdayhighlight");h=new Date(this.currentDate());this.model.orientation=="horizontal"&&this.currentView()!="month"&&this.model.timeScale.enable&&(new Date(this.currentDate()).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()&&(this.element.find(".e-headercells").children().removeClass("e-activeview"),this.element.find(".e-currentdayhighlight").children().addClass("e-activeview")),c=this.element.find(".e-headercells").children(".e-activeview").parent().index(),this.element.find(".e-headercells").children().removeClass("e-activeview"),f=this.currentView()==="day"?0:this.currentView()==="workweek"?h.getDay()-1:c,this.currentView()!="day"&&n(this.element.find(".e-headercells")[f]).children().addClass("e-activeview"),new Date(new Date(this.currentDate()).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()?n(this.element.find("td.e-horizontalheadertddate")[f]).addClass("e-headerToday"):"")}},_horizontalScroll:function(i,r){if(!t.isNullOrUndefined(i.scrollLeft)&&(r.currentView()=="week"||r.currentView()=="workweek"||this.currentView()==="customview"&&this._renderDays<=7)){var f=n(r.element.find(".e-headercells").find(".e-activeview").parent()).index(),u=Math.floor(Math.abs(i.scrollLeft)/(r.element.find(".e-workcells").width()+1)/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)));f!==u&&r.element.find(".e-headercells").children().removeClass("e-activeview");n(r.element.find(".e-headercells")[u]).children().addClass("e-activeview");this.model.timeScale.enable||r.element.find(".e-headercells").children().removeClass("e-activeview")}},_getHorizontalheaderCellCount:function(n){var f=[],r,u,e;if(this._isCustomMonthView(),!t.isNullOrUndefined(this.model.dateHeaderTemplateId)&&(this.currentView()=="day"||this.currentView()=="week"||this.currentView()=="workweek"||this.currentView()=="customview"&&this._oneWeek))f=this._getUserDateheaderTemplate();else for(i=0;i<this._dateRender.length;i++)r=this._mediaQuery&&(this.currentView()=="week"||this.currentView()=="workweek")?this._dayNames[new Date(this._dateRender[i]).getDay()].split("")[0]:this.currentView()==="month"||this.currentView()==="day"||this._isCustomMonthView()?this._tempResource.length==0&&t.isNullOrUndefined(this.model.group)?n.calendar.days.names[new Date(this._dateRender[i]).getDay()]:this._dayShortNames[new Date(this._dateRender[i]).getDay()]:this._dayShortNames[new Date(this._dateRender[i]).getDay()],u=new Date(new Date(this._dateRender[i]).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()?"e-headerToday":"",e=this.currentView()==="month"||this._isCustomMonthView()?{currentDay:r,currentDateClass:"",cellToday:u,cellWidth:this.model.cellWidth}:this.currentView()==="day"?this._tempResource.length==0&&t.isNullOrUndefined(this.model.group)?{currentDay:r+" "+t.format(new Date(this._dateRender[i]),"dd MMMM yyyy"),currentDateClass:"",cellToday:u,cellWidth:this.model.cellWidth}:{currentDay:r+" "+t.format(new Date(this._dateRender[i]),"dd MMM yy"),currentDateClass:"",cellToday:u,cellWidth:this.model.cellWidth}:{currentDay:this._mediaQuery?r+parseInt(t.format(new Date(this._dateRender[i]),"dd")):r+" "+new Date(this._dateRender[i]).getDate(),currentDateClass:new Date(this._dateRender[i]).getDate()===new Date(this.currentDate()).getDate()?"e-activeview":"",cellToday:u,cellWidth:this.model.cellWidth},f.push(e);return f},_getHoriStartEndTime:function(i){var c=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplateId),v,l,f,y,p,w,h,u,r,o;c&&(v=n.templates(n(this.model.timeScale.majorSlotTemplateId).html()),l=n.templates(n(this.model.timeScale.minorSlotTemplateId).html()));var e=[],s=this.model.cellWidth?this._safariBrowser?parseInt(this.model.cellWidth)-1+"px":this.model.cellWidth:this._safariBrowser?"29px":"30px",b=this.currentView()=="week"?7:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:this.model.workWeek.length;for(f=0;f<b;f++)if(c){var h=new Date((new Date).setHours(0,0,0,0)),r=0,a=[];for(u=this.model.startHour;u<this.model.endHour;){for(y=this.model.timeScale.majorSlot+r,p=r;r<y;)w=r,r=r*6e4,c?w==p?o=t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)?l.render(object={date:new Date(new Date(this._dateRender[0]).setHours(u,0,0,r))}):v.render(object={date:new Date(new Date(this._dateRender[0]).setHours(u,0,0,r))}):t.isNullOrUndefined(this.model.timeScale.minorSlotTemplateId)||a.push(l.render(object={date:new Date(new Date(this._dateRender[0]).setHours(u,0,0,r))}).trim()):this._timeMode==="12"?(o=(u===this.model.startHour||u===12)&&i.AM&&i.PM&&r==0?t.format(new Date(new Date(h).setHours(u,0,0,r)),"hh tt"):t.format(new Date(new Date(h).setHours(u,0,0,r)),"hh:mm tt"),e.push({time:o,id:u+"_"+r,timecellclass:u==this.model.startHour&&f!=0&&r==0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight,timeCellWidth:s})):e.push({time:(u<=9?"0"+u:u)+" 00",timecellclass:u%((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount)==this.model.startHour&&f!=0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight,timeCellWidth:s}),r=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplateId)?r/6e4+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount:r/6e4+this.model.timeScale.majorSlot;u=this.model.timeScale.majorSlot>60?u+this.model.timeScale.majorSlot/60:r>=60?u+1:u;r=r>=60?0:r;c&&(r==this.model.timeScale.majorSlot||r==0)&&(e.push({time:o.trim(),times:a,id:u+"_"+r,timecellclass:u-1==this.model.startHour&&f!=0&&r==0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight,timeCellWidth:s}),a=[])}}else for(h=new Date((new Date).setHours(0,0,0,0)),u=this.model.startHour;u<this.model.endHour;){for(r=0;r<60;)r=r*6e4,this._timeMode==="12"?(o=(u===this.model.startHour||u===12)&&i.AM&&i.PM&&r==0?t.format(new Date(new Date(h).setHours(u,0,0,r)),"hh tt"):t.format(new Date(new Date(h).setHours(u,0,0,r)),"hh:mm tt"),e.push({time:o,id:u+"_"+r,timecellclass:u==this.model.startHour&&f!=0&&r==0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight,timeCellWidth:s})):e.push({time:(u<=9?"0"+u:u)+" 00",timecellclass:u%((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount)==this.model.startHour&&f!=0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight,timeCellWidth:s}),r=r/6e4+this.model.timeScale.majorSlot;u=this.model.timeScale.majorSlot>60?u+this.model.timeScale.majorSlot/60:u+1}return e},_getHorizontalDayAppointments:function(n,i,r,u){for(var e=[],f=0;f<n.length;f++)e=!t.isNullOrUndefined(this.model.group)&&this._grouping.length>1?new t.DataManager(this._tempResource[this._tempResource.length-1].resourceSettings.dataSource).executeLocal((new t.Query).where(this._tempResource[this._tempResource.length-1].resourceSettings.groupId,t.FilterOperators.equal,n[f][this._appointmentSettings.resourceFields.split(",")[this._appointmentSettings.resourceFields.split(",").length-2]])):this.res1,e.length!=0&&(new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()==new Date(new Date(n[f][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()<=new Date(new Date(n[f][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?n[f][this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim()]==this.res1[u][this._tempResource[this._tempResource.length-1].resourceSettings.id]:!0&&new Date(new Date(n[f][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(n[f][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime())&&(this._renderApp(n[f],r,u),this._filtered.push(n[f]))},_horizontalMonthDates:function(){var n=[];for(i=0;i<this._dateRender.length;i++)new Date(this.currentDate()).getMonth()===new Date(this._dateRender[i]).getMonth()&&n.push(this._dateRender[i]);return n},_horiGroupCollection:function(){if(this._tempResource.length!=0){var n=this._resourceSort(),i=this.res1,r=n.filter(function(n){return i.indexOf(n)===-1});return t.isNullOrUndefined(this.model.group)&&(this.res1=["0"]),r}},_renderHorizontalApp:function(i,r,u,f,e,o,s,h){var ft=this.element.find(".e-workcellstab tr"),v,d,w,tt,pt,et,ot,st,it,ht,g,p,nt,lt,a,b,rt,ni,at,vt,yt,k,c;if(i<=r&&(pt=new Date(i).getHours()<s?new Date(i).getHours()+-new Date(i).getHours()+-new Date(i).getMinutes():new Date(i).getHours()+-s,et=new Date(r).getHours()>h?new Date(r).getHours()+(-new Date(r).getHours()+(h-s))+-new Date(r).getMinutes():new Date(r).getHours()+-s,et=new Date(r).getHours()==h?new Date(et).getMinutes()+-new Date(r).getMinutes():et,v=20,w=0,ot=0,this.model.startHour<=new Date(i).getHours()&&this.model.endHour>=new Date(i).getHours())){var l=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&this._grouping.length>1?this._findResourceIndex(this._horiHeaderCollection,this._tempResource[this._tempResource.length-2].resourceSettings.id,u[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-2].trim()])+1:0,y=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0?this._findResourceIndex(this.res1,this._tempResource[this._tempResource.length-1].resourceSettings.id,u[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim()])+1:1,ti=t.scheduleFeatures.resources&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&!t.isNullOrUndefined(this.model.group)?this._overlapApp(u.AppTaskId,u[this._appointmentSettings.startTime],u[this._appointmentSettings.endTime],u[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim()]):this._overlapApp(u.AppTaskId,u[this._appointmentSettings.startTime],u[this._appointmentSettings.endTime],null);if(!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&this._grouping.length>1&&(this.overlapList=new t.DataManager(ti).executeLocal((new t.Query).where(this._appointmentSettings.resourceFields.split(",")[this._appointmentSettings.resourceFields.split(",").length-2],t.FilterOperators.equal,u[this._appointmentSettings.resourceFields.split(",")[this._appointmentSettings.resourceFields.split(",").length-2]]))),st=this.model.appointmentTemplateId?!0:!1,it=st&&this._getUserAppointmentTemplate(u),v=this.model.appointmentTemplateId?n(it).css("height")=="100%"?e-15:n(it).css("height")=="0px"?v:n(it).height():v,ot=t.scheduleFeatures.resources&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&!t.isNullOrUndefined(this.model.group)?this._getOverlapCount(u,f,this._dateRender,u[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim()]):this._getOverlapCount(u,f,this._dateRender,null),this._renderedAllDay.push(u),w=w+ot*(v+2),u[this._appointmentSettings.allDay])ht=new Date(new Date(new Date(r).setHours(0,0,0,0)).getTime())-new Date(new Date(new Date(i).setHours(0,0,0,0)).getTime()),g=Math.round(ht/864e5)+1,g>this._dateRender.length&&(g=new Date(this._dateRender[this._dateRender.length-1]).getDay()+1-new Date(i).getDay()),p=g*(h-s)*60,nt=(this.model.endHour-this.model.startHour)*o*f,d=this.cellwidth/30*p+(p/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-1),tt="0";else if(new Date(new Date(new Date(u[this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime())<new Date(new Date(new Date(u[this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime())){var wt=new Date(r)<new Date(new Date(r).setHours(this.model.endHour,0,0))&&new Date(r)<new Date(new Date(r).setHours(this.model.startHour,0,0))?this.model.endHour*30:new Date(r).getHours()*60+new Date(r).getMinutes(),bt=new Date(i)>new Date(new Date(r).setHours(this.model.startHour,0,0))?this.model.startHour*60:new Date(i).getHours()*60+new Date(i).getMinutes(),ct=1,kt,ut,dt,gt,ht;if(kt=this._dateRender.indexOf(new Date(r).setHours(0,0,0,0)),ut=this._dateRender.indexOf(new Date(i).setHours(0,0,0,0)),kt==-1)while(ct<7)if(new Date(this._dateRender[this._dateRender.length-ct]).getTime()<new Date(r).setHours(0,0,0,0)){dt=this._dateRender.length-ct;wt=this.model.endHour*60;break}else ct++;else dt=kt;ut==-1?(gt=f,bt=this.model.startHour*60):gt=ut;ht=dt-gt;p=ht*(h-s)*60-bt+wt;nt=(this.model.endHour-this.model.startHour)*o*(60/this.model.timeScale.majorSlot)*f+(ut==-1?0:pt*o)*(60/this.model.timeScale.majorSlot);d=this.cellwidth/30*p+(p/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-2);g>this._dateRender.length&&(g=new Date(this._dateRender[this._dateRender.length-1]).getDay()+1-new Date(i).getDay(),p=g*(h-s)*60,d=p/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*this.cellwidth+(p/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-3));tt=ut==-1?0:parseFloat(new Date(i).getMinutes())*this.element.find(".e-workcells")[0].offsetWidth*o/this.model.timeScale.majorSlot}else{if(tt=parseFloat(new Date(i).getMinutes()+new Date(i).getMilliseconds()/60)*this.cellwidth*this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot-1,this.model.endHour-this.model.startHour==24)lt=new Date(r).getHours()*60+new Date(r).getMinutes()-(new Date(i).getHours()*60+new Date(i).getMinutes());else var wt=new Date(r).getHours()*60+new Date(r).getMinutes()>this.model.endHour*60?this.model.endHour*60:new Date(r).getHours()*60+new Date(r).getMinutes(),bt=new Date(i).getHours()*60+new Date(i).getMinutes()<this.model.startHour*60?this.model.startHour*60:new Date(i).getHours()*60+new Date(i).getMinutes(),lt=wt-bt;lt+=1;d=lt/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*this.cellwidth+(lt/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-2)+1;nt=(this.model.endHour-this.model.startHour)*o*(60/this.model.timeScale.majorSlot)*f+pt*o*(60/this.model.timeScale.majorSlot)}a=this._appointmentColor(u);e=t.isNullOrUndefined(this.model.group)||this._tempResource.length==0||this._tempResource[0].resourceSettings.dataSource.length==0?e:n(ft[y+l-1]).find(".e-workcells").outerHeight();b=this._indicationApp(u);w+v+1<e?(at=this._timeMode=="12"?t.format(new Date(u[this._appointmentSettings.startTime]),this._pattern.t):t.format(new Date(u[this._appointmentSettings.startTime]),"HH:mm"),vt=this._timeMode=="12"?t.format(new Date(u[this._appointmentSettings.endTime]),this._pattern.t):t.format(new Date(u[this._appointmentSettings.endTime]),"HH:mm"),t.isNullOrUndefined(u[this._appointmentSettings.recurrenceRule])||(yt=u[this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1),k=n(this.appTemplate.render({id:u.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),appHeight:v,rtl:this.model.enableRTL,subject:u[this._appointmentSettings.subject],startTime:at,endTime:vt,left:tt+"px",top:w,appWidth:d+"px",userAppTemplId:st,userTemplate:it,appClass:"e-appointment",appointData:a.appointColor.appointData,appointCustomcss:a.appointColor.appointCustomcss,appointtextcolor:a.appointColor.appointtextcolor,value:a.value,multiDiv:a.multiDiv,orientation:this.model.orientation,priority:this.model.prioritySettings.enable?u[this._appointmentSettings.priority]:"",enablePriority:this.model.prioritySettings.template,priorityTemplate:this.model.prioritySettings.template?this._priorityTemplate(u):u[this._appointmentSettings.priority],uid:u.Guid,recurrence:u[this._appointmentSettings.recurrence],recurrenceEdit:yt,leftInd:b.leftIndication,rightInd:b.rightIndication})),t.isNullOrUndefined(this.model.queryCellInfo)||this._renderQueryCellInfo("appointment",u,k),c=n(n(ft[y+l-1]).find("td.e-workcells")[nt]),c.find("div.e-appointwrapper").length>0?c.find("div.e-appointwrapper").append(k):c.prepend(n("<div class='e-appointwrapper'><\/div>").append(k))):this.model.showOverflowButton?(rt=nt+Math.round(new Date(i).getMinutes()/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)),n("#"+this._id+"_"+t.format(new Date(u[this._appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(y+l-1)+"_"+rt).length==0&&(c=n(n(ft[y+l-1]).find("td.e-workcells")[rt]),ni='<div id="'+this._id+"_"+t.format(new Date(u[this._appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(y+l-1)+"_"+rt+'" class="e-icon e-arrowhead-down e-appsoverflow" cellinfo="'+this._dateRender[f]+'"><\/div>',c.find("div.e-appointwrapper").length>0?c.find("div.e-appointwrapper").append(ni):c.prepend(n("<div class='e-appointwrapper'><\/div>").append(ni)),w=e-this.element.find(".e-appsoverflow").height(),this.element.find("#"+this._id+"_"+t.format(new Date(u[this._appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(y+l-1)+"_"+rt).css(this.model.enableRTL?"right":"left",this.cellwidth-25+"px").css("top",w+"px")),n("#"+this._id+"_"+t.format(new Date(u[this._appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(y+l-1)+"_"+rt).attr("appcount",ot+1)):(n(this.element.find(".e-workcellstab tr")[y+l-1]).find(".e-workcells").css("height",e+v-1+"px"),n(this.element.find(".e-resourceheadertable tr")[y+l-1]).find(".e-childnode").css("height",e+v-1+"px"),at=this._timeMode=="12"?t.format(new Date(u[this._appointmentSettings.startTime]),this._pattern.t):t.format(new Date(u[this._appointmentSettings.startTime]),"HH:mm"),vt=this._timeMode=="12"?t.format(new Date(u[this._appointmentSettings.endTime]),this._pattern.t):t.format(new Date(u[this._appointmentSettings.endTime]),"HH:mm"),t.isNullOrUndefined(u[this._appointmentSettings.recurrenceRule])||(yt=u[this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1),k=n(this.appTemplate.render({id:u.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),appHeight:v,rtl:this.model.enableRTL,subject:u[this._appointmentSettings.subject],startTime:at,endTime:vt,left:tt+"px",top:w,appWidth:d+"px",userAppTemplId:st,userTemplate:it,appClass:"e-appointment",appointData:a.appointColor.appointData,appointCustomcss:a.appointColor.appointCustomcss,appointtextcolor:a.appointColor.appointtextcolor,value:a.value,multiDiv:a.multiDiv,orientation:this.model.orientation,priority:this.model.prioritySettings.enable?u[this._appointmentSettings.priority]:"",enablePriority:this.model.prioritySettings.template,priorityTemplate:this.model.prioritySettings.template?this._priorityTemplate(u):u[this._appointmentSettings.priority],uid:u.Guid,recurrence:u[this._appointmentSettings.recurrence],recurrenceEdit:yt,leftInd:b.leftIndication,rightInd:b.rightIndication})),t.isNullOrUndefined(this.model.queryCellInfo)||this._renderQueryCellInfo("appointment",u,k),c=n(n(ft[y+l-1]).find("td.e-workcells")[nt]),c.find("div.e-appointwrapper").length>0?c.find("div.e-appointwrapper").append(k):c.prepend(n("<div class='e-appointwrapper'><\/div>").append(k)),this._overflowFlag=!0);t.isNullOrUndefined(b)||(b.leftIndication&&(this.model.enableRTL?this.element.find("[guid="+u.Guid+"]").find(".e-schedulemouseclose").css("margin-left","11px"):this.element.find("[guid="+u.Guid+"]").find(".e-apptime,.e-apptext").css("margin-left","13px")),b.rightIndication&&(this.model.enableRTL?this.element.find("[guid="+u.Guid+"]").find(".e-apptime,.e-apptext").css("margin-right","13px"):this.element.find("[guid="+u.Guid+"]").find("[guid="+u.Guid+"]").find(".e-schedulemouseclose").css("margin-right","11px")));!t.isNullOrUndefined(this.model.group)&&this._grouping.length>1&&this._renderAppointmentCategory(this._horiHeaderCollection,l,nt,u,d,tt)}},_renderAppointmentCategory:function(i,r,u,f,e,o){var h,y,c=0,w,b,l=[],p,v,s,a;if(!t.isNullOrUndefined(this.model.group)&&this._grouping.length>0){h=this._getResourceColor(f);y=h.appointData==""?"e-categorycolor":"";r-=1;e=this.currentView()=="month"||this._isCustomMonthView()?e:e+2;do if(s=n(n(this.element.find(".e-resourceheadertr")[r]).find("td.e-workcells")[u]),a=this.model.enableRTL?"<div class='e-categorybar "+y+"' id='categorybar_"+f.Guid+"' style='position:absolute;height:"+this.resHeaderHeight+"px;background:"+h.appointData+";width:"+e+"px;right:"+o+"px;'><\/div>":"<div class='e-categorybar "+y+"' id='categorybar_"+f.Guid+"' style='position:absolute;height:"+this.resHeaderHeight+"px;background:"+h.appointData+";width:"+e+"px;left:"+o+"px;'><\/div>",s.find("div.e-appointwrapper").length>0?s.find("div.e-appointwrapper").append(a):s.prepend(n("<div class='e-appointwrapper'><\/div>").append(a)),this._tempResource.length>2){for(v=this._tempResource.length-2;v>=0;v--)if(c=this._tempResource[v].resourceSettings.dataSource.indexOf(i[r]),c!=-1){c=v;w=this._tempResource[v].resourceSettings.groupId;break}b=c==0?c:c-1;l=new t.DataManager(i).executeLocal((new t.Query).where(this._tempResource[b].resourceSettings.id,t.FilterOperators.equal,i[r][w]));p=this._tempResource[0].resourceSettings.dataSource.indexOf(l[0]);p==0?(l=[],this._tempResource.length>2&&(s=n(n(this.element.find(".e-resourceheadertr")[p]).find("td.e-workcells")[u]),a=this.model.enableRTL?"<div class='e-categorybar "+y+"' id='categorybar_"+f.Guid+"' style='position:absolute;height:"+this.resHeaderHeight+"px;background:"+h.appointData+";width:"+e+"px;right:"+o+"px;'><\/div>":"<div class='e-categorybar "+y+"' id='categorybar_"+f.Guid+"' style='position:absolute;height:"+this.element.find(".e-resourceheadercells").height()+"px;background:"+h.appointData+";width:"+e+"px;left:"+o+"px;'><\/div>",s.find("div.e-appointwrapper").length>0?s.find("div.e-appointwrapper").append(a):s.prepend(n("<div class='e-appointwrapper'><\/div>").append(a)))):l.length!=0?r=i.indexOf(l[0]):""}while(l.length!=0)}},_getHorizontalOverlapCount:function(n,i,r,u,f){for(var o=[],e=0;e<n.length;e++)t.scheduleFeatures.resources&&this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)?new Date(new Date(n[e][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()&&new Date(new Date(n[e][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()>=new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()&&(new Date(u[this._appointmentSettings.startTime])<new Date(n[e][this._appointmentSettings.startTime])&&new Date(u[this._appointmentSettings.endTime])>=new Date(n[e][this._appointmentSettings.startTime])||new Date(u[this._appointmentSettings.startTime])<new Date(n[e][this._appointmentSettings.endTime])&&new Date(u[this._appointmentSettings.endTime])>new Date(n[e][this._appointmentSettings.endTime])||new Date(u[this._appointmentSettings.startTime])>=new Date(n[e][this._appointmentSettings.startTime])&&new Date(u[this._appointmentSettings.startTime])<new Date(n[e][this._appointmentSettings.endTime])||new Date(u[this._appointmentSettings.endTime])>new Date(n[e][this._appointmentSettings.startTime])&&new Date(u[this._appointmentSettings.endTime])<new Date(n[e][this._appointmentSettings.endTime]))&&(f!=null?f==n[e][this._tempResource[this._tempResource.length-1].field]:f==null)&&o.push(n[e]):new Date(new Date(n[e][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()&&new Date(new Date(n[e][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()>=new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()&&(new Date(u[this._appointmentSettings.startTime])<new Date(n[e][this._appointmentSettings.startTime])&&new Date(u[this._appointmentSettings.endTime])>=new Date(n[e][this._appointmentSettings.startTime])||new Date(u[this._appointmentSettings.startTime])<new Date(n[e][this._appointmentSettings.endTime])&&new Date(u[this._appointmentSettings.endTime])>new Date(n[e][this._appointmentSettings.endTime])||new Date(u[this._appointmentSettings.startTime])>=new Date(n[e][this._appointmentSettings.startTime])&&new Date(u[this._appointmentSettings.startTime])<new Date(n[e][this._appointmentSettings.endTime])||new Date(u[this._appointmentSettings.endTime])>new Date(n[e][this._appointmentSettings.startTime])&&new Date(u[this._appointmentSettings.endTime])<new Date(n[e][this._appointmentSettings.endTime]))&&o.push(n[e]);return o},_moveScroller:function(){if((this.currentView()=="week"||this.currentView()=="workweek"||this.currentView()==="customview"&&this._renderDays<=7)&&this.element.find(".e-headercells").children().hasClass("e-activeview")){var i=n(this.element.find(".e-headercells").find(".e-activeview").parent()).index(),t=n(this.element.find(".e-workcells")[parseInt(i*(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))]).offset().left;this.element.find(".e-hscroll").length>0&&(this.model.enableRTL?(t=this.element.find(".e-workcells:first").offset().left-t,this.element.find("div#"+this._id+"_scroller").ejScroller({scrollLeft:t}),n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",t+"px")):(n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-t+"px"),this.element.find("div#"+this._id+"_scroller").ejScroller({scrollLeft:t})))}},_renderHorizontalHeaderBar:function(){var u=this.model.timeScale.enable?this._isCustomMonthView()?"month":this.currentView():"month",a=u=="day"?1:u=="week"?7:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:this.model.workWeek.length,s,h,v,w,e,o,f,i,y,l,p;if(this._strTime=this._getStartEndTime(),s=this._columnTimeScale(this._strTime),this.datesColumn=this._getHeaderAllDayCellsCount(),u==="month"||this._isCustomMonthView()){for(this.datesColumn=[],this.monthDays=[],this.totdays=[],i=0;i<this._dateRender.length;i++)this.currentView()==="month"||this._isCustomMonthView()&&this._oneWeek?new Date(this.currentDate()).getMonth()===new Date(this._dateRender[i]).getMonth()&&this.totdays.push(this._dateRender[i]):this.totdays.push(new Date(this._dateRender[i]));if(h=this.totdays.length,!t.isNullOrUndefined(this.model.dateHeaderTemplateId)&&(this.currentView()=="day"||this.currentView()=="week"||this.currentView()=="workweek"||this.currentView()=="customview"&&this._oneWeek))for(v=this._getUserDateheaderTemplate(),i=0;i<h;i++)e={currentDate:v[i].currentDay,currentDateClass:"",currentDay:this.currentView()=="day"?this._dayFullNames[new Date(this.totdays[i]).getDay()]:this._dayShortNames[new Date(this.totdays[i]).getDay()].toString(),cellWidth:this.model.cellWidth?this.model.cellWidth:"100%",cellHeight:this.model.cellHeight,today:new Date(this.totdays[i]).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()},this.datesColumn.push(e),this.monthDays.push(this.totdays[i]);else for(i=0;i<h;i++)w=this._dayFullNames[new Date(this.totdays[i]).getDay()],e=this.model.timeScale.enable?{currentDate:t.format(new Date(this.totdays[i]),"dd"),currentDateClass:"",currentDay:this._dayFullNames[new Date(this.totdays[i]).getDay()].toString().slice(0,1),cellWidth:!this.model.cellWidth&&this.currentView()!="month"&&!this._isCustomMonthView()?"30px":this.model.cellWidth,cellHeight:this.model.cellHeight,today:new Date(this.totdays[i]).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()}:this.currentView()=="day"||this.currentView()=="week"||this.currentView()=="workweek"?{currentDate:t.format(new Date(this.totdays[i]),"dd"),currentDateClass:"",currentDay:this.currentView()=="day"?this._dayFullNames[new Date(this.totdays[i]).getDay()]:this._dayShortNames[new Date(this.totdays[i]).getDay()].toString(),cellWidth:this.model.cellWidth?this.model.cellWidth:"100%",cellHeight:this.model.cellHeight,today:new Date(this.totdays[i]).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()}:{currentDate:t.format(new Date(this.totdays[i]),"dd"),currentDateClass:"",currentDay:this._dayFullNames[new Date(this.totdays[i]).getDay()].toString().slice(0,1),cellWidth:this.model.cellWidth,cellHeight:this.model.cellHeight,today:new Date(this.totdays[i]).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()},this.datesColumn.push(e),this.monthDays.push(this.totdays[i])}if(o=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)&&!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplateId)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplateId)?!0:!1,f=t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)?!1:!0,o||f){var b=n.templates(n(this.model.timeScale.minorSlotTemplateId).html()),k=n.templates(n(this.model.timeScale.majorSlotTemplateId).html()),d=[],r=0;for(i=this.model.startHour;i<this.model.endHour;){for(var c=[],g=this.model.timeScale.majorSlot+r,nt=r;r<g;)y=r,r=r*6e4,this._timeMode==="12"&&(y!=nt||t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)?c.push(b.render(object={date:new Date(new Date(this._dateRender[0]).setHours(i,0,0,r))}).trim()):c.push(k.render(object={date:new Date(new Date(this._dateRender[0]).setHours(i,0,0,r))}).trim())),r=r/6e4+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount;i=this.model.timeScale.majorSlot>60?i+this.model.timeScale.majorSlot/60:r>=60?i+1:i;r=r>=60?0:r;d.push(c)}f=!0}l=this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)&&this._tempResource[0].resourceSettings.dataSource.length!=0?!0:!1;p=o||f?this.userTimeCellHoriTemplate.render({cols:this.datesColumn,label:this._getLocalizedLabels("Resources"),multiRes:l,view:u,timeTdCount:this._strTime,colspan:u=="month"?1:this._strTime.length/a*2,height:u=="month"?62:59,width:this.model.width,headercellWidth:u=="day"?"100%":"55px",column:s,userTemplateId:o,template:f}):this.horizontalHeader.render({cols:this.datesColumn,label:this._getLocalizedLabels("Resources"),multiRes:l,view:u,timeTdCount:this._strTime,colspan:u=="month"?1:this._strTime.length/a*2,height:u=="month"?62:59,width:this.model.width,headercellWidth:u=="day"?"100%":"55px",column:s});this.aTR.append(p)},_renderHorizontalContent:function(n,i,r,u,f,e){var y=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplateId),s,o,l=[],p=this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,v=this._strTime,h,a,c;l=this._columnValue;this._tempResource.length==0||t.isNullOrUndefined(this.model.group)||this._tempResource[0].resourceSettings.dataSource.length==0?(o="",s=[{classname:"e-childnode"}]):(o=this._renderHorizontalResources(),s=this._horiResources);h=t.isNullOrUndefined(this.model.workCellsTemplateId)?!1:!0;h&&(a=this._getUserWorkCellsTemplate());c=this.cellTemplate.render({cellrows:s,hourdiff:Math.ceil((this.model.endHour-this.model.startHour)*(60/this.model.timeScale.majorSlot)),view:this.model.timeScale.enable?this._isCustomMonthView()?"month":this.currentView():"month",cols:this.model.timeScale.enable?this.currentView()=="month"||this._isCustomMonthView()?this.datesColumn:v:this.datesColumn,column:l,userTemplate:h,userHtml:a});o==""?this.wTR.append(t.buildTag("td").append(n.append(i.append(r.append(u.append(f.append(e.append(this.$WorkCellDiv.append(c))))))))):this.wTR.append(t.buildTag("td.e-horizontalrestd",{},{},{width:"15%",height:"100%"}).append(o)).append(t.buildTag("td").append(n.append(i.append(r.append(u.append(f.append(e.append(this.$WorkCellDiv.append(c)))))))))},_columnTimeScale:function(n){var u,i;this._columnValue=[];_cols2=[];var r=this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,f=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate),e=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)&&!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)?!0:!1,o=t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)?!1:!0;if(f)for(i=0;i<n.length;i++)this._columnValue.push(i);else for(i=0;i<n.length;i++){for(u=0;u<this.model.timeScale.minorSlotCount-1;u++)if(r=r+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,r>(this.model.endHour-this.model.startHour)*60){if(_cols2.push(u),u==this.model.timeScale.minorSlotCount-2){r=0;break}}else _cols2.push(u);this._columnValue.push(_cols2);r=r+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount;_cols2=[]}return this._columnValue},_getResourceHeadTemplate:function(t){var i=n.templates(n(this.model.resourceHeaderTemplateId).html());return i.render(t)},_renderHorizontalResources:function(){var i,f,c,l,v,a,u,r,e,o;this._resCollect=[];this._horizontalResRender=[];this._horiResources=[];var s=this.currentView(),y=s=="day"?1:s=="week"||s=="month"||this._isCustomMonthView()?7:this.model.workWeek.length,h=this.model.resourceHeaderTemplateId?!0:!1;if(t.isNullOrUndefined(this.model.group))for(o=0;o<this._tempResource.length;o++)this._horizontalResRender.push(this._tempResource[o].resourceSettings.dataSource),this._resCollect.push(this._tempResource[o].resourceSettings.dataSource);else if(this._grouping.length===1){for(f=0;f<this._grouping.length;f++)i=this._findResourceIndex(this._tempResource,"name",this._grouping[f]);for(f=0;f<this._resourceInfo[i].dataSource.length;f++)this._horiResources.push({cellHeight:this.model.cellHeight,name:this._resourceInfo[i].dataSource[f][this._resourceInfo[i].text],idnum:this._resourceInfo[i].dataSource[f][this._resourceInfo[i].id],classname:"e-childnode",marginleft:"10px",width:"10px",backgroundcolor:"",border:"1px solid #bbbcbb",bordertop:"",userResHeader:this._getResourceHeadTemplate(n.extend(this._resourceInfo[i].dataSource[f],{classname:"e-childnode"})),userResTemplId:h}),this._resCollect.push(this._resourceInfo[i].dataSource[f]);this._horizontalResRender.push(this._resCollect)}else{for(u=this._resourceSort(),r=0;r<u.length;r++){for(v=this.res1.indexOf(u[r]),e=0;e<this.render_Resources.length;e++)if(rIndex=this.render_Resources[e].indexOf(u[r]),rIndex!=-1){i=e;l=this._tempResource[e].resourceSettings.id;c=this._tempResource[e].resourceSettings.text;a=this._tempResource[e].resourceSettings.groupId;break}i==this.render_Resources.length-1?(this._horiResources.push({cellHeight:this.model.cellHeight,name:u[r][c],classname:"e-childnode",marginleft:(this._mediaQuery?i*11:i*21)+"px",width:"20px",backgroundcolor:"",border:"1px dotted #bbbcbb",bordertop:"",userResHeader:this._getResourceHeadTemplate(n.extend(u[r],{classname:"e-childnode"})),userResTemplId:h}),this._resCollect.push(u[r])):(this._horiResources.push({cellHeight:this.model.cellHeight,name:u[r][c],idnum:u[r][l]+"_"+u[r][a],classname:"e-parentnode",marginleft:i*10+"px",width:"20px",backgroundcolor:"",border:"1px dotted #bbbcbb",bordertop:"",userResHeader:this._getResourceHeadTemplate(n.extend(u[r],{classname:"e-parentnode"})),userResTemplId:h}),this._resCollect.push(u[r]))}this._horizontalResRender.push(this._resCollect)}return this.horizontalResHeader.render({trs:this._horiResources})},_horizontalResIcon:function(){for(var r,s,e=this.element.find(".e-parentnodecategory"),o,u,h,i,f=0;f<e.length;f++){for(o=e[f].id.split("_")[0],r=0;r<this._tempResource.length;r++)if(u=new t.DataManager(this._tempResource[r].resourceSettings.dataSource).executeLocal((new t.Query).where(this._tempResource[r].resourceSettings.id,t.FilterOperators.equal,o)),u.length!=0){u=r;break}for(i=u+1,i=i==this._tempResource.length?i-1:i,s=0;s<this._tempResource.length;s++){h=new t.DataManager(this._resourceSort()).executeLocal((new t.Query).where(this._tempResource[i].resourceSettings.groupId,t.FilterOperators.equal,o));h.length==0&&n(e[f]).removeClass("e-resourceicon e-resourcecollapse");break}}},_renderHorizontalCurrentTime:function(){var i,r,t;if(this.currentView()==="month"||this._isCustomMonthView())for(i=this._horizontalMonthDates(),r=this.element.find(".e-headerdays").find("table").find("td"),t=0;t<i.length;t++)new Date(new Date(i[t]).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()&&n(r[t]).addClass("e-monthcurrenttime");else this.element.find("td.e-headerToday").length>0&&(this.element.find(".e-horizontaltabletimecell").parent().append('<div id="'+this._id+'_HighlightCurrentTimeline" class="e-highlightcurrenttimeline" style="height: 92%; width: 2px; position: absolute; background-color: red; "><\/div>'),n("#"+this._id+"_HighlightCurrentTimeline").css("top",this.element.find(".e-headerdays tr")[1].offsetTop))},_horizontalTimePosition:function(t,i){if(t.element.find("td.e-headerToday").length>0){var r=t.element.find("td.e-headerToday")[0].cellIndex,u=(t.model.endHour-t.model.startHour)*60/t.model.timeScale.majorSlot*t.model.timeScale.minorSlotCount*r+(i.getHours()-t.model.startHour)*60/t.model.timeScale.majorSlot*t.model.timeScale.minorSlotCount,f=parseFloat(i.getMinutes())*t.element.find(".e-workcells")[1].offsetWidth*t.model.timeScale.minorSlotCount/t.model.timeScale.majorSlot;n("#"+t._id+"_HighlightCurrentTimeline").css("left",u*t.element.find(".e-workcells")[1].offsetWidth+f)}},_horizontalBusinessHighlight:function(i,r,u,f,e){var a=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0?this._horiResources.length:1,h,l,o,c,s;if(this.currentView()!=="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable){for(o=0;o<a;o++)for(h=0;h<i.length;h++)for(s=0;s<this.model.workWeek.length;s++)this._dayNamesArray.indexOf(this.model.workWeek[s])==new Date(i[h]).getDay()&&n(n(this.element.find(".e-workcellstab tr")[o]).find(".e-workcells")[r*f+(this.model.endHour-this.model.startHour)*f*h-1]).nextAll(".e-workcells").slice(0,u*f-r*f).addClass("e-businesshighlightworkcells");this._businessHourScroller()}else for(l=this.monthDays,e=this.element.find(".e-workcells"),e.removeClass("e-monthcellhighlight"),o=0;o<a;o++)for(c=0;c<l.length;c++)for(s=0;s<this.model.workWeek.length;s++)this._dayNamesArray.indexOf(this.model.workWeek[s])==new Date(l[c]).getDay()&&n(n(this.element.find(".e-workcellstab tr")[o]).find(".e-workcells")[c]).addClass("e-monthcellhighlight")},_onResourceClick:function(i){var s,e,l,y,h,a,o,v,u=[],c=[],f,r;for(e=n(i.currentTarget),e.hasClass("e-resourceicon e-resourcecollapse")?(e.removeClass("e-resourceicon e-resourcecollapse").addClass("e-resourceicon e-resourceexpand"),l=!0):(e.removeClass("e-resourceicon e-resourceexpand").addClass("e-resourceicon e-resourcecollapse"),y=!0),this.element.find(".e-workcellstab").css("height","100%"),this.element.find(".e-resourceheadertable").css("height","100%"),s=n(i.currentTarget).closest("td.e-parentnode").parent().index(),v=this._getResourceCollection(),r=0;r<v.length;r++)if(h=new t.DataManager(this._tempResource[r].resourceSettings.dataSource).executeLocal((new t.Query).where(this._tempResource[r].resourceSettings.id,t.FilterOperators.equal,i.currentTarget.id.split("_")[0])),h.length!=0){a=h[0].count;break}for(f=0;f<a;f++)u.push(this.element.find(".e-resourceheadertable tr")[s+f+1]),c.push(this.element.find(".e-workcellstab tr")[s+f+1]);for(r=0;r<u.length;r++)l?(o=n(u[r]).children().hasClass("e-parentnode"),o&&n(u[r]).find(".e-parentnodecategory").removeClass("e-resourceicon e-resourcecollapse").addClass("e-resourceicon e-resourceexpand"),n(u[r]).is(":visible")&&(n(u[r]).toggle(),n(c[r]).toggle())):(o=n(u[r]).children().hasClass("e-parentnode"),o&&n(u[r]).find(".e-parentnodecategory").removeClass("e-resourceicon e-resourceexpand").addClass("e-resourceicon e-resourcecollapse"),n(u[r]).is(":hidden")&&(n(u[r]).toggle(),n(c[r]).toggle()));this.element.find(".e-horires").height(this.element.find(".e-draggableworkarea").height());this._horizontalRender();this.model.cellHeight!="20px"&&this._reRenderScroller();this._mediaQuery&&this.refreshScroller();this._horizontalResIcon();this.element.find("div.e-prevapp,div.e-nextapp").remove();this.element.find(".e-categorybar").height(this.element.find(".e-parentworkcell").height()-3);this._businessHourScroller();this._renderAppointmentAll()}}})(jQuery,Syncfusion),function(n,t){t.scheduleFeatures=t.scheduleFeatures||{};var r=function(){return this._resHeadTemplate="{{for resourceName}}{{for ~cols=colspan}}<td class='e-resourcecells' colspan='{{:~cols}}'> {{for ~resource=resourceNam}}<div class='e-resourceheadertext' align='center' title='{{if userResTemplId == true}}{{:resourceNam}}{{else}}{{:~resource}}{{/if}}'>{{if userResTemplId == true}}{{:userResHeader}}{{else}}{{:~resource}}{{/if}}<\/div>{{/for}}  <\/td>{{/for}}{{/for}}",this._resHeadTemplate};t.scheduleFeatures.resources={_getMultipleResourceCellsCount:function(n){var y,s,n,h,r,f,c,l,p,e,i,a,o,v,u;if(this._grouping.length===1){if(y=this._findResourceIndex(this._tempResource,"name",this._grouping[0]),s=this._resourceInfo[y].dataSource.length,this._resWorkWeek)for(n=0,h=this._resourceInfo[y].dataSource,u=0;u<h.length;u++)n=t.isNullOrUndefined(h[u][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?n+this.model.workWeek.length:n+h[u][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length}else{for(r=this._getResourceCollection(),f=[],i=0;i<r.length;i++)if(f=[],i==0)for(a=0;a<r[i].dataSource.length;a++)f.push({resourceNam:r[i].dataSource[a][r[i].text]});else for(i>1&&(r[i-1].dataSource=[],r[i-1].dataSource=this.res),this.res=[],c=t.group(r[i].dataSource,r[i].groupId),l=t.group(r[i-1].dataSource,r[i-1].id),this._resourceManager1=c instanceof t.DataManager?c:t.DataManager(c),o=0;o<l.length;o++)for(v=0;v<l[o].items.length;v++)if(p=(new t.Query).where("key",t.FilterOperators.equal,l[o].items[v][r[i-1].id]),e=this._resourceManager1.executeLocal(p),e.length>0)for(u=0;u<e[0].items.length;u++)f.push({resourceNam:e[0].items[u][r[i].text]}),this.res.push(e[0].items[u]);s=f.length;this.res1=f.length}return n=this._resWorkWeek?n:n*s,{resCount:s,count:n}},_initResourceData:function(n,t){var r=this._columnToSelect(n),i=this,u=n.dataSource.executeQuery(r);u.done(function(r){n.dataSource=r.result;i._resourceInfo.push(n);t==i.model.resources.length-1&&(i._renderInitSchedule(),i._bindAppointmentsData("Load"))})},_showMultipleResourceDetails:function(n){var f,e,o,u,i,r;if(this._tempResource.length>0){for(u=this._resCollection,r=0;r<u.length;r++)this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");for(i=0;i<this.render_Resources.length-1;i++)f=this.render_Resources[i+1]instanceof t.DataManager?this.render_Resources[i+1]:t.DataManager(this.render_Resources[i+1]),e=(new t.Query).where(u[i+1].groupId,t.FilterOperators.equal,n[this._appointmentSettings.resourceFields.toString().split(",")[i].trim()]),o=f.executeLocal(e),this._appointmentAddWindow.find(".owner_"+(i+1)).ejAutocomplete("clearText"),this._appointmentAddWindow.find(".owner_"+(i+1)).ejAutocomplete("option","dataSource",o);for(r=0;r<u.length;r++)this._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(n[this._appointmentSettings.resourceFields.toString().split(",")[r].trim()])}},_renderAppWindowResources:function(n){for(var i=this.render_Resources,r=this.model.enableRTL?"margin-right:30px;margin-top:-18px":"float:left",u=this.model.enableRTL?"float:none":"float:left",t=0;t<i.length;t++)this._tempResource[t].allowMultiple?n.find(".owner_"+t).ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:"visualmode",emptyResultText:this._getLocalizedLabels("EmptyResultText"),dataSource:i[t],fields:{text:this._resCollection[t].text,key:this._resCollection[t].id},change:this._onResourceChange,template:"<div class='e-resourcediv' style='height:15px; margin-right:5px; margin-top:3px; float:left; width:15px;"+u+"; background-color: ${"+this._resCollection[t].color+"}'><\/div> <div style= "+r+">${"+this._resCollection[t].text+"}<\/div>"}):n.find(".owner_"+t).ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:"none",emptyResultText:this._getLocalizedLabels("EmptyResultText"),dataSource:i[t],fields:{text:this._resCollection[t].text,key:this._resCollection[t].id},change:this._onResourceChange,template:"<div class='e-resourcediv' style='height:15px; margin-right:5px; margin-top:3px; float:left; width:15px;"+u+"; background-color: ${"+this._resCollection[t].color+"}'><\/div><div style= "+r+">${"+this._resCollection[t].text+"}<\/div>"})},_onResourceChange:function(i){var d,b,v,y,p,h,s;if(!t.isNullOrUndefined(i.value)&&i.value!=""){var g=n("#"+this._id.toString().split("_")[0]),f=g.ejSchedule("instance"),w=parseInt(this._id.toString().split("_")[2]),nt=f._appointmentAddWindow.find(".owner_"+w).ejAutocomplete("option","multiSelectMode"),o=this.getSelectedItems(),u=f._resCollection;if(w<f.render_Resources.length-1&&o.length>0){var r=w+1,k=f.render_Resources[r-1]instanceof t.DataManager?f.render_Resources[r-1]:t.DataManager(f.render_Resources[r-1]),tt=f.render_Resources[r]instanceof t.DataManager?f.render_Resources[r]:t.DataManager(f.render_Resources[r]),l,e,c=[];if(nt=="none"){if(t.isNullOrUndefined(i.value)||(d=(new t.Query).where(u[r-1].text,t.FilterOperators.equal,i.value),b=k.executeLocal(d)),v=!i.value||t.isNullOrUndefined(i.value)||b.length<=0?o[0][u[r-1].id]:b[0][u[r-1].id],!t.isNullOrUndefined(v))for(a=r;a<u.length;a++){for(e=new t.DataManager(u[r].dataSource).executeLocal((new t.Query).where(u[r].groupId,t.FilterOperators.equal,v)),e.length!=0&&(v=e[0][u[r-1].id]),c=[],s=0;s<e.length;s++)c.push(e[s]);e.length!=0?(f._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText"),f._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",c),f._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(e[0][u[r].id]),o=e[0][u[r].id]):(f._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText"),f._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",c));r++}}else{for(y=t.Predicate(u[r-1].id,t.FilterOperators.equal,o[0][u[r-1].id]),o=i.value.split(","),h=1;h<o.length;h++)y=y.or(u[r-1].text,t.FilterOperators.equal,o[h]);if(l=(new t.Query).where(y),resApp=k.executeLocal(l),resApp.length>0){for(p=t.Predicate(u[r].groupId,t.FilterOperators.equal,resApp[0][u[r-1].id]),h=1;h<resApp.length;h++)p=p.or(u[r].groupId,t.FilterOperators.equal,resApp[h][u[r-1].id]);for(l=(new t.Query).where(p),e=tt.executeLocal(l),c=[],s=0;s<e.length;s++)c.push(e[s]);f._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");f._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",c);f._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(e[0][u[r].id]);o.push(e[0][u[r].id])}}}}},_getResourceCollection:function(){var i=[],f,n,r,u;if(this._tempResource.length!=0){if(t.isNullOrUndefined(this.model.group)||this._tempResource.length==0||this._tempResource[0].resourceSettings.dataSource.length==0)for(n=0;n<this._tempResource.length;n++)i.push({index:n});else{for(n=0;n<this._grouping.length;n++)f=this._findResourceIndex(this._tempResource,"name",this._grouping[n]),i.push({index:f,name:this._tempResource[n].name});i=i.sort(function(n,t){var i=n.index,r=t.index;return i<r?-1:i>r?1:0})}for(r=[],u=0;u<i.length;u++)r.push(this._resourceInfo[i[u].index]);return this._resCollection=r,r}},_resourceSort:function(){var r,u,e,o,s,f,h,l=[],n=[],v=[];if(this._tempResource.length>1){for(i=0;i<this._tempResource.length;i++)for(j=0;j<this._tempResource[i].resourceSettings.dataSource.length;j++)l.push(this._tempResource[i].resourceSettings.dataSource[j]);for(u=1,a=0;a<this._tempResource.length;a++){for(b=0,f=this._tempResource[a].resourceSettings.dataSource;b<f.length;b++)if(h=this._tempResource[a].resourceSettings.id,e=n.indexOf(f[b]),e==-1?n.push(f[b]):"",r=new t.DataManager(l).executeLocal((new t.Query).where(this._tempResource[u].resourceSettings.groupId,t.FilterOperators.equal,f[b][h])),r=r.filter(function(n){return f.indexOf(n)===-1}),o=n.indexOf(f[b]),r.length!=0)for(c=0;c<r.length;c++)s=o+c+1,e=n.indexOf(r[c]),e==-1?n.splice(s,0,r[c]):"";u++;u=u==this._tempResource.length?u-1:u}for(x=0;x<n.length;x++)o=this.res1.indexOf(n[x]),o!=-1&&v.push(n[x]);this.res1=v}else n=this.res1;return n},_renderMultipleResourceHeaderTemplate:function(i,r){var nt,p,c,tt,it,k,a,u,e,ft,et,o,g,d,l,y,s;this.res1=[];this.render_Resources=[];this.level_Resources=[];var v=this.currentView(),f=this._getResourceCollection(),h=v=="day"?1:v=="week"||v=="month"?7:this.model.workWeek.length;if(h=v=="customview"&&this._dateRender.length>=7?7:v=="customview"&&this._dateRender.length<7?this._dateRender.length:h,t.isNullOrUndefined(this.model.group)||this._tempResource.length==0||this._tempResource[0].resourceSettings.dataSource.length==0){for(s=0;s<this._tempResource.length;s++)this.render_Resources.push(this._tempResource[s].resourceSettings.dataSource);this.res1=[0]}else if(nt=this.model.resourceHeaderTemplateId?!0:!1,p=[],this._grouping.length===1){for(u=0;u<this._grouping.length;u++)c=this._findResourceIndex(this._tempResource,"name",this._grouping[u]);for(u=0;u<this._resourceInfo[c].dataSource.length;u++)this._resWorkWeek&&(l=t.isNullOrUndefined(this._resourceInfo[c].dataSource[u][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?h:this._resourceInfo[c].dataSource[u][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length),this.currentView()!="agenda"&&p.push({resourceNam:this._resourceInfo[c].dataSource[u][this._resourceInfo[c].text],colspan:this._resWorkWeek?l:h,userResHeader:this._getResourceHeadTemplate(n.extend(this._resourceInfo[c].dataSource[u],{classname:"e-childnode"})),userResTemplId:nt}),this.res1.push(this._resourceInfo[c].dataSource[u]),this.level_Resources.push(this.res1[u]);this._valueCollection=this.res1;this.render_Resources.push(this.res1);this.model.orientation=="vertical"&&this.currentView()!="agenda"&&i!==null&&r!=null&&(tt=v=="month"?50:56,it=this.resourceHeadTemplate.render({cols:r,resourceName:p,leftWidth:tt}),i.append(t.buildTag("tr.e-headerbar").css("height","28px").append(it)))}else{var ot=[],ct=[],rt=[],b=0,st=[],ut=[],lt=[],ht=[];if(this.resourceValue=0,k=0,ot=n.merge(ot,f),this._tempResource.length){for(s=0,e=0;e<f[f.length-2].dataSource.length;e++)for(var d=(new t.Query).where(f[f.length-1].groupId,t.FilterOperators.equal,f[f.length-2].dataSource[e][f[f.length-2].id]),o=new t.DataManager(f[f.length-1].dataSource).executeLocal(d),w=0;w<o.length;)ct.push({resourceNam:o[w][f[f.length-1].text],colspan:1*h,userResHeader:this._getResourceHeadTemplate(n.extend(o[w],{classname:"e-childnode"})),userResTemplId:nt}),rt[s]=o[w],this.res1.push(o[w]),s++,w++;this._valueCollection=rt;f[f.length-1].dataSource=rt;a=n.extend(!0,[],f)}for(u=this._tempResource.length-1;u>=0;u--){for(lt.push(u),e=0;e<f[u].dataSource.length;e++){if(ft=u!=0?this._findResourceIndex(f[u-1].dataSource,f[u-1].id,f[u].dataSource[e][f[u].groupId]):0,et=u!=this._tempResource.length-1?this._findResourceIndex(f[u+1].dataSource,f[u+1].groupId,f[u].dataSource[e][f[u].id]):this._tempResource.length-1,t.isNullOrUndefined(ft)&&t.isNullOrUndefined(et)?f[u].dataSource[e]=0:"",!t.isNullOrUndefined(ft)&&!t.isNullOrUndefined(et)&&f[u].dataSource[e]!==0){if(ut.push(f[u].dataSource[e]),this.resourceValue=ut.length,u<=this._tempResource.length-2){if(d=(new t.Query).where(f[u+1].groupId,t.FilterOperators.equal,f[u].dataSource[e][f[u].id]),o=new t.DataManager(f[u+1].dataSource).executeLocal(d),u<=this._tempResource.length-3){for(s=0;s<o.length;s++)b=b+(t.isNullOrUndefined(o[s].count)?0:o[s].count);k=this.model.orientation=="vertical"?b:b+o.length;f[u].dataSource[e].count=k;b=0}u==this._tempResource.length-2&&(f[u].dataSource[e].count=o.length,k=o.length);this.resourceValue=k;o.length=0}if(this._resWorkWeek){if(g=0,u!=this._tempResource.length-1)for(d=(new t.Query).where(a[u+1].groupId,t.FilterOperators.equal,a[u].dataSource[e][a[u].id]),l=new t.DataManager(a[u+1].dataSource).executeLocal(d),y=0;y<l.length;y++)g+=t.isNullOrUndefined(l[y][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?t.isNullOrUndefined(l[y].colspan)?h:l[y].colspan:l[y][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length;else g+=t.isNullOrUndefined(a[u].dataSource[e][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?h:a[u].dataSource[e][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length;a[u].dataSource[e].colspan=g;this.resourceValue=g}this.currentView()!="agenda"&&p.push({resourceNam:f[u].dataSource[e][f[u].text],colspan:this._resWorkWeek?this.resourceValue:this.resourceValue*h,userResHeader:this._getResourceHeadTemplate(n.extend(f[u].dataSource[e],{classname:this._tempResource.length-1==u?"e-childnode":"e-parentnode"})),userResTemplId:nt});this.level_Resources.push(f[u].dataSource[e]);ut.length=0}this.model.orientation=="vertical"&&this.currentView()!="agenda"&&i!==null&&r!=null&&(tt=v=="month"?50:56,it=this.resourceHeadTemplate.render({cols:r,resourceName:p,leftWidth:tt}),ht[u]=t.buildTag("tr.e-headerbar").css("height","28px").append(it)[0])}st[u]=f[u].dataSource;p.length=0}this.render_Resources=st;this.model.orientation=="vertical"&&this.currentView()!="agenda"?i.append(ht):""}return i},_getMultipleResourceAlldayApp:function(n,t,i,r){this.allDayCount=[];new Date(new Date(n[t]).setHours(0,0,0,0)).getTime()==new Date(new Date(this._processed[r][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&this._processed[r][this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim()]==this.res1[i][this._tempResource[this._tempResource.length-1].resourceSettings.id]&&(this._processed[r][this._appointmentSettings.allDay]===!0||(new Date(this._processed[r][this._appointmentSettings.endTime])-new Date(this._processed[r][this._appointmentSettings.startTime]))/36e5>=24)&&(this._setAllDayPos(this._processed[r],t,i),this._filtered.push(this._processed[r]),this.allDayCount.push(r))},_getResourceColor:function(n){var i=this._resCollection,r,u="",f="";return t.isNullOrUndefined(this.model.group)?(r=this._findResourceIndex(this.render_Resources[this.render_Resources.length-1],i[i.length-1].id,n[this._appointmentSettings.resourceFields.split(",")[this._appointmentSettings.resourceFields.split(",").length-1].trim()]),t.isNullOrUndefined(r)||(u=t.isNullOrUndefined(this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].color])?u:this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].color],f=t.isNullOrUndefined(this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].appointmentClass])?f:this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].appointmentClass])):(r=this._findResourceIndex(this.render_Resources[0],i[0].id,n[this._appointmentSettings.resourceFields.split(",")[0].trim()]),t.isNullOrUndefined(r)||(u=t.isNullOrUndefined(this.render_Resources[0][r][i[0].color])?u:this.render_Resources[0][r][i[0].color],f=t.isNullOrUndefined(this.render_Resources[0][r][i[0].appointmentClass])?f:this.render_Resources[0][r][i[0].appointmentClass])),{appointData:u,appointCustomcss:f}},_getResourceValue:function(n){var r,i;return t.scheduleFeatures.resources&&this._tempResource.length!=0&&(i=this._getResourceDetails(n),r=t.DataManager(this._resCollection[i.length-1].dataSource).executeLocal((new t.Query).where(this._tempResource[i.length-1].resourceSettings.id,"equal",i[0].id))[0]),r},_getResourceDetails:function(n,i){var e,s,f,h,o,l,a,c,r,u;if(this._tempResource.length!=0&&this._tempResource.length>0){if(e=this.currentView()=="day"?1:this.currentView()=="week"||this.currentView()=="month"?7:this.model.workWeek.length,e=this.currentView()=="customview"&&this._dateRender.length>=7?7:this.currentView()=="customview"&&this._dateRender.length<7?this._dateRender.length:e,i=this.currentView()==="month"||this.currentView()=="customview"?n.index():!t.isNullOrUndefined(this._cellIndex)&&t.isNullOrUndefined(this._multiple)?this._cellIndex:n.index(),n.hasClass("e-detailedapp")?"":this.index=i,i=n.hasClass("e-detailedapp")?this.index:i,this._resWorkWeek){for(s=0,f=0;f<this._valueCollection.length;f++)if(s+=t.isNullOrUndefined(this._valueCollection[f][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?this.model.workWeek.length:this._valueCollection[f][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length,s>n.index()){i=f;break}}else i=this.model.orientation=="vertical"?parseInt(i/e):t.isNullOrUndefined(this._workCellIndex)?n.parent().index():this._workCellIndex;for(h=this.model.orientation=="vertical"?this._valueCollection:this._resCollect,this._resourceCollection=[],r=this._resCollection,u=r.length-1;u>=0;u--)u==r.length-1?t.isNullOrUndefined(this.model.group)?(this._resourceCollection.push({id:r[r.length-1].dataSource[i][r[r.length-1].id]}),o=r[r.length-1].dataSource[i][r[r.length-1].groupId]):(this._resourceCollection.push({id:h[i][r[u].id]}),o=h[i][r[u].groupId]):(l=r[u].dataSource instanceof t.DataManager?r[u].dataSource:t.DataManager(r[u].dataSource),a=(new t.Query).where(r[u].id,t.FilterOperators.equal,o),c=l.executeLocal(a),this._resourceCollection.push({id:c[0][r[u].id]}),o=c[0][r[u].groupId]);return this._resourceCollection}},_getResourceFields:function(n){if(!t.isNullOrUndefined(this.model.group)||this._tempResource.length>1)for(var i=0,r=this._resourceCollection.length-1;i<this._resourceCollection.length;i++,r--)n[this._appointmentSettings.resourceFields.split(",")[i].trim()]=this._resourceCollection[r].id;else n[this._appointmentSettings.resourceFields.split(",")[0].trim()]=this._resourceCollection[0].id;return n},_getDragDropResourceData:function(n,i,r){var f,e,o,u,s;if(!t.isNullOrUndefined(i)){if(f=n.currentView()=="day"?1:n.currentView()=="week"||n.currentView()=="month"?7:n.model.workWeek.length,f=n.currentView()=="customview"&&n._dateRender.length>=7?7:n.currentView()=="customview"&&n._dateRender.length<7?n._dateRender.length:f,e=n.model.enableRTL?n.res1.length-Math.floor(i/f)-1:Math.floor(i/f),n._resWorkWeek)for(o=0,u=0;u<n.res1.length;u++)if(o+=t.isNullOrUndefined(n.res1[u][n.model.resources[n.model.resources.length-1].resourceSettings.workWeek])?n.model.workWeek.length:n.res1[u][n.model.resources[n.model.resources.length-1].resourceSettings.workWeek].length,o>i){e=u;break}s=n.model.orientation=="vertical"?n.res1[e]:n._resCollect[i];r[n._appointmentSettings.resourceFields.split(",")[n._appointmentSettings.resourceFields.split(",").length-1].trim()]=s[n.model.resources[n.model.resources.length-1].resourceSettings.id];n._appointmentSettings.resourceFields.split(",").length>1&&(r[n._appointmentSettings.resourceFields.split(",")[n._appointmentSettings.resourceFields.split(",").length-2].trim()]=s[n.model.resources[n.model.resources.length-1].resourceSettings.groupId])}return r},_renderResourceData:function(n,i){var f,u,r,e,s,o;if((n.hasClass("e-workcells")||n.hasClass("e-alldaycells")||n.hasClass("e-monthcells"))&&!n.hasClass("e-resourceheadercells")&&this._getResourceDetails(n),f=[],u=[],this._tempResource.length)for(r=this._resourceCollection.length-1;r>=0;r--)e=this._findResourceIndex(this._resCollection[r].dataSource,this._resCollection[r].id,this._resourceCollection[this._resourceCollection.length-1-r].id),f.push(this._resCollection[r].dataSource[e]),r!=0?(s=(new t.Query).where(t.Predicate(this._resCollection[r].groupId,t.FilterOperators.equal,this._resCollection[r].dataSource[e][this._resCollection[r].groupId])),o=new t.DataManager(this._resCollection[r].dataSource).executeLocal(s),i=this._findResourceIndex(o,this._resCollection[r].id,this._resourceCollection[this._resourceCollection.length-1-r].id),u=o,this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText"),this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",u),this._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(u[i][this._resCollection[r].id])):(this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText"),this._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(f[this._resourceCollection.length-1-r][this._resCollection[r].id]))},_bindResourcesData:function(){var i,n;if(this._tempResource.length!=0){for(this._resourceInfo=[],i=!1,n=0;n<this._tempResource.length;n++)t.isNullOrUndefined(this._tempResource[n].resourceSettings)||(!t.isNullOrUndefined(this._tempResource[n].resourceSettings.query)&&this._tempResource[n].resourceSettings.query instanceof t.Query||(this._tempResource[n].resourceSettings.query=t.Query()),this._tempResource[n].resourceSettings.dataSource instanceof t.DataManager?this._initResourceData(this._tempResource[n].resourceSettings,n):(this._resourceInfo.push(this._tempResource[n].resourceSettings),i=!0));i&&this._renderInitSchedule()}},_renderResourceElements:function(n){for(var t=0;t<this._tempResource.length;t++)n+="<tr><td class='e-leftfields e-textlabel'>"+this._tempResource[t].title+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"_ownerfield_"+t+"'  class='owner_"+t+"' type='text' value=''/><div id='ownerlist'><\/div><\/td><\/tr>";return n},_renderResourcesTemplate:function(){this.model.orientation=="vertical"&&(this.resourceHeadTemplate=n.templates(this._createTemplate(r(),"_ResourceHeader")))}}}(jQuery,Syncfusion),function(n,t,r){t.scheduleFeatures=t.scheduleFeatures||{};var u=function(){return this._monthCellsTemplate="<table class='e-table e-workcellstab'  height='100%'width='100%' cellpadding='0px' cellspacing='0px'><tbody>{{for cellrows ~cols1=cols1 ~userTemp=userTemplate ~userHtml=userHtml}}<tr>{{for ~cwidth=cwidth ~cheight=cheight ~cols1 ~value=#getIndex()}}<td class='e-monthcells' width='{{:~cwidth}}' height='{{:~cheight}}'><div class='e-monthheader'><\/div>{{if ~userTemp == true}}{{:~userHtml[~value][#getIndex()]}}{{/if}}<\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._monthCellsTemplate},f=function(){return this._appTemplate="<div class='{{:appClass}} {{:appointCustomcss}}' id='Appointment_{{:id}}' guid= '{{:uid}}' role='presentation' style='{{if rtl == true}}right{{else}}left{{/if}}: {{:left}}; width: {{:appWidth}}; background: {{:appointData}};  color:{{:appointtextcolor}}; height: {{:appHeight}}px; top: {{:top}}px;' >{{if appResize == true}}{{if appClass == 'e-appointment'}}{{if orientation == 'vertical'}}<div class='e-tophandle'><\/div><div class='e-bottomhandle'><\/div>{{else}}<div class='e-lefthandle'><\/div><div class='e-righthandle'><\/div>{{/if}}{{else}}{{if currentview != 'day'}}<div class='e-lefthandle'><\/div><div class='e-righthandle'><\/div>{{/if}}{{/if}}{{/if}}<span class='e-icon e-schedulemouseclose'/><\/span>{{if (priority!=undefined && priority!='') && ((priorityTemplate!=undefined && priorityTemplate!=''))}}{{if enablePriority==null}}<div class='e-priority e-{{:priorityTemplate}}'><\/div>{{else}}<div class='e-priority'>{{:priorityTemplate}}<\/div>{{/if}}{{/if}}{{if userAppTemplId == false}}{{if leftInd ==true}}<span class='e-icon e-arrow-sans-left e-leftind'><\/span>{{/if}}{{if rightInd ==true}}<span class='e-icon e-arrow-sans-right e-rightind'><\/span>{{/if}}{{if bottomInd ==true}}<span class='e-icon e-arrow-sans-down e-bottomind'><\/span>{{/if}}{{if topInd ==true}}<span class='e-icon e-arrow-sans-up e-topind'><\/span>{{/if}}<div class='e-appointinnertext'><div class='e-apptext {{if (priority!=undefined && priority!='')}}e-priorwidth{{/if}}'>{{if recurrence == true}}{{if recurrenceEdit == true}}<span class='e-icon e-recureditapp'><\/span>{{else}}<span class='e-icon e-recurapp'><\/span>{{/if}}{{/if}}{{:subject}} <\/div><div class='e-apptime {{if (priority!=undefined && priority!='')}}e-priorwidth{{/if}}'> {{:startTime}} - {{:endTime}}<\/div>{{if value == true}}<div class='e-multipleCategory'>{{:multiDiv}}<\/div>{{/if}}<\/div>{{else}}{{if recurrence == true}}{{if recurrenceEdit == true}}<span class='e-icon e-recureditapp'><\/span>{{else}}<span class='e-icon e-recurapp'><\/span>{{/if}}{{/if}}{{:userTemplate}}{{/if}}<\/div>",this._appTemplate},e=function(){return this._blockTimeTemplate="<div class='e-blocktimewrapper'><div class='e-blocktimeappointment {{:blockClass}} {{:customStyle}}' id='BlockTime_{{:id}}' role='presentation' style='width: {{:appWidth}}; height: {{:appHeight}}px; left: {{:left}}px; top: {{:top}}px;'>{{if userTempId == false}}{{:subject}}{{else}}{{:userTemplate}}{{/if}}<\/div><\/div>",this._blockTimeTemplate},o=function(){return this._categorizeMultipleTemplate="{{for renderData }}<div style='background:{{:value}};height:11px;width:6px;float:left'><\/div>{{/for}}",this._categorizeMultipleTemplate},s=function(){return this._headerTemplate="{{for cols ~view=view ~colspan=colspan}}{{if cellToday == 'e-headerToday'}}<td class='e-headercells e-currentdayhighlight' colspan='{{:~colspan}}'>{{else}}<td class='e-headercells' colspan='{{:~colspan}}'>{{/if}}<div class='e-dateheadercell'> <span class='e-headerdaydisplay'>{{:currentDay}}<\/span><\/div><\/td>{{/for}}",this._headerTemplate},h=function(){return this._leftIndent="<table class='e-table e-leftindenttable' width='{{:cswidth}}' cellpadding='0px' cellspacing='0px'><tbody> {{for trs ~tdClass=tdClass ~divClass=divClass}} <tr>{{for ~tdClass=tdClass ~divClass=divClass}} <td class='{{:~tdClass}}'style='height:27px;'> <div class='{{:~divClass}}'><\/div><\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._leftIndent},l=function(){return this._alldayTemplate="{{for cols ~colspan=colspan ~userTemp=userTemp ~allDayHtml=userHtml}}<td class='e-alldaycells' style='height:27px;' colspan='{{:~colspan}}'>{{if ~userTemp==true}}{{:~allDayHtml[#getIndex()]}}{{/if}}<\/td>{{/for}}",this._alldayTemplate},v=function(){return this._workCellsTemplate="<table class='e-table e-workcellstab' width='100%' cellpadding='0px' cellspacing='0px'><tbody >{{for cellrows  ~timesc=timeScale ~cols1=cols1 ~userTemp=userTemplate ~userHtml=userHtml}}<tr>{{for ~index=#index ~cwidth=cwidth ~cheight=cheight ~cols1 ~value=#getIndex()}}{{if ((~index+1) % ~timesc) == 0 }}<td class='e-workcells' width='{{:~cwidth}}' height='{{:~cheight}}'>{{else}}<td class='e-workcells e-alternatecells'width='{{:~cwidth}}' height='{{:~cheight}}'>{{/if}}{{if ~userTemp == true}}{{:~userHtml[~value][#getIndex()]}}{{/if}}<\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._workCellsTemplate},y=function(){return this._timeCellsTemplate="<div class='e-scrolltimecells'><table class='e-table e-timecelltable' cellpadding='0px' cellspacing='0px'><tbody>{{for timerows ~timesc=timeScale ~cols1=cols1 ~view1=viewclass ~userTemplateId = userTemplateId ~timeValue1=timeValue1 ~template=template}}<tr>{{for ~name=time ~id=id ~view=~view1 ~index=#index }}{{if ~view == 0}}{{if ~userTemplateId==true}}<td class='e-timecells'>{{for ~cols1[~index] }}{{if (#index+1)% ~timesc ==0}}<div class='e-timecelldivs' style='height: 20px'>{{:~timeValue1[~index][#getIndex()]}}<\/div>{{else}}<div class='e-timecelldivs' style='height: 21px'>{{:~timeValue1[~index][#getIndex()]}}<\/div>{{/if}}{{/for}}<\/td>{{else}}<td class='e-timecells'><div class='e-timecelldivs'>{{if ~template==true}}{{:~name}}{{else}}{{:~name.slice(0,2)}}{{/if}}<\/div><\/td>{{/if}}<td class='e-timecells' rowspan='1'>{{for ~cols1[~index] }}{{if (#index+1)% ~timesc ==0}}<div class='e-ampmdisplay'><\/div>  {{else}} {{if (#getIndex())== 0}}<div id='{{:~id}}' class='e-ampmdisplay e-ampmstyle e-idAmpmstyle'> {{if ~template ==true || ~userTemplateId==true }}{{else}}{{:~name.slice(3,6)}}{{/if}}<\/div>{{else}}<div class='e-ampmdisplay e-ampmstyle'><\/div>{{/if}} {{/if}}{{/for}}<\/td>{{else}}<td class='e-timecells' style='width:51px;'><div class='e-timecelldivs'><\/div><\/td>{{/if}}{{/for}}<\/tr>{{/for}}<\/tbody><\/table><\/div>",this._timeCellsTemplate},p=function(){return this._userTimeCellsTemplate="<div class='e-scrolltimecells'><table class='e-table' cellpadding='0px' cellspacing='0px' width='70px'><tbody>{{for timerows ~timesc=timeScale ~cols1=cols1 ~view1=viewclass  ~userTemplateId = userTemplateId ~timeValue1=timeValue1 ~template=template ~cheight = cheight}}<tr height='21px'>{{if ~timesc == 1}}<th class='e-timecells' rowspan='1'>{{else}}<th class='' rowspan='1'>{{/if}}{{:~timeValue1[#getIndex()][0]}}<\/th><\/tr>{{for ~cols1 ~name=time ~id=id ~view=~view1 ~index=#index ~timeSc=~timesc}}{{if  (#getIndex()+2)% ~timeSc ==0}}<tr height='21px'><th class='e-timecells' style='text-align:left' rowspan='1'>{{:~timeValue1[~index][#getIndex()+1]}}<\/th><\/tr> {{else}}<tr height='21px'>{{if ~timesc == 1}}<th class='e-timecells' rowspan='1'>{{else}}<th class='' rowspan='1'>{{/if}}{{:~timeValue1[~index][#getIndex()+1]}}<\/th><\/tr>{{/if}}{{/for}}{{/for}}<\/tbody><\/table><\/div>",this._userTimeCellsTemplate},w=function(){return this._agendaHeaderTemplate="<tr>{{for cols}}<td class='e-headercells {{:className}} {{if (#index==0)}}e-firstcolumn{{/if}}'><div class='e-textwrapper'><b>{{:headertext}}<\/b><\/div><\/td>{{/for}}<\/tr>",this._agendaHeaderTemplate},k=function(){return this._agendaCellsTemplate="<table class='e-table e-agendacellstab' width='100%' cellpadding='0px' cellspacing='0px'><tbody >{{for cols}}<tr>{{if resGroup}}{{for resGroup}}<td class='e-agendacells {{:resId}} e-resourcecolumn {{if (#index==0)}}e-firstcolumn{{/if}}'><div class='e-textwrapper'>{{:text}}<\/div><\/td>{{/for}}{{/if}}{{if resChild}}<td rowspan={{:resRowSpan}} class='e-agendacells e-resourcecolumn {{if (resGroup.length==0)}}e-firstcolumn{{/if}}'><div class='e-textwrapper'>{{if userResourceId == false}}{{:resName}}{{else}}{{:userResourceHtml}}{{/if}}<\/div><\/td>{{/if}}{{if dayChild}}<td rowspan={{:dayRowSpan}} class='e-agendacells e-datecolumn {{if (resGroup.length != 0) }}{{else (resName =='')}}e-firstcolumn{{/if}}'><div class='e-textwrapper'>{{if userDateId == false}}{{:date}}{{else}}{{:userDateHtml}}{{/if}}<\/div><\/td>{{/if}}<td class='e-agendacells e-timecolumn {{if dayBorderBottom==false}}e-alternatecells{{/if}}'><div class='e-textwrapper'>{{if userTimeId == false}}{{:time}}{{else}}{{:userTimeHtml}}{{/if}}<\/div><\/td><td class='e-agendacells e-eventcolumn {{if dayBorderBottom==false}}e-alternatecells{{/if}}'><div class='e-textwrapper'><div id='Appointment_{{:id}}'  guid= '{{:uid}}' class='e-agendaappointment'>{{if userAppTemplId == false}}<span class='e-agendacolordiv' style='background:{{:background}};'/>{{:event}}{{else}}{{:userTemplate}}{{/if}}{{if readOnly == false}}<div class='e-agendahover'><span class='e-icon e-edit_05 e-editapp' title={{:edittext}}/><span class='e-icon e-close e-deleteapp' title={{:deletetext}}/><\/div>{{/if}}<\/div><\/div><\/td><\/tr>{{/for}}<\/tbody><\/table>",this._agendaCellsTemplate};t.widget("ejSchedule","ej.Schedule",{_rootCSS:"e-schedule",element:null,validTags:["div"],model:null,_requiresID:!0,defaults:{timeZoneCollection:{dataSource:[{text:"UTC -12:00",id:"1",value:"UTC -12:00"},{text:"UTC -11:00",id:"2",value:"UTC -11:00"},{text:"UTC -10:00",id:"3",value:"UTC -10:00"},{text:"UTC -09:00",id:"4",value:"UTC -09:00"},{text:"UTC -08:00",id:"5",value:"UTC -08:00"},{text:"UTC -07:00",id:"6",value:"UTC -07:00"},{text:"UTC -06:00",id:"7",value:"UTC -06:00"},{text:"UTC -05:00",id:"8",value:"UTC -05:00"},{text:"UTC -04:30",id:"9",value:"UTC -04:30"},{text:"UTC -04:00",id:"10",value:"UTC -04:00"},{text:"UTC -03:30",id:"11",value:"UTC -03:30"},{text:"UTC -03:00",id:"12",value:"UTC -03:00"},{text:"UTC -02:00",id:"13",value:"UTC -02:00"},{text:"UTC -01:00",id:"14",value:"UTC -01:00"},{text:"UTC +00:00",id:"15",value:"UTC +00:00"},{text:"UTC +01:00",id:"16",value:"UTC +01:00"},{text:"UTC +02:00",id:"17",value:"UTC +02:00"},{text:"UTC +03:00",id:"18",value:"UTC +03:00"},{text:"UTC +03:30",id:"19",value:"UTC +03:30"},{text:"UTC +04:00",id:"20",value:"UTC +04:00"},{text:"UTC +04:30",id:"21",value:"UTC +04:30"},{text:"UTC +05:00",id:"22",value:"UTC +05:00"},{text:"UTC +05:30",id:"23",value:"UTC +05:30"},{text:"UTC +05:45",id:"24",value:"UTC +05:45"},{text:"UTC +06:00",id:"25",value:"UTC +06:00"},{text:"UTC +06:30",id:"26",value:"UTC +06:30"},{text:"UTC +07:00",id:"27",value:"UTC +07:00"},{text:"UTC +08:00",id:"28",value:"UTC +08:00"},{text:"UTC +09:00",id:"29",value:"UTC +09:00"},{text:"UTC +09:30",id:"30",value:"UTC +09:30"},{text:"UTC +10:00",id:"31",value:"UTC +10:00"},{text:"UTC +11:00",id:"32",value:"UTC +11:00"},{text:"UTC +12:00",id:"33",value:"UTC +12:00"},{text:"UTC +13:00",id:"34",value:"UTC +13:00"}],text:"text",id:"id",value:"value"},views:["Day","Week","WorkWeek","Month","Agenda"],agendaViewSettings:{daysInAgenda:7,dateColumnTemplateId:null,timeColumnTemplateId:null},currentView:"week",timeMode:null,firstDayOfWeek:null,workWeek:["Monday","Tuesday","Wednesday","Thursday","Friday"],dateFormat:"",isDST:!1,timeZone:null,timeScale:{enable:!0,minorSlotCount:2,majorSlot:60,minorSlotTemplateId:null,majorSlotTemplateId:null},startHour:0,endHour:24,highlightBusinessHours:!0,enableLoadOnDemand:!1,enablePersistence:!1,showQuickWindow:!0,showLocationField:!1,showTimeZoneFields:!0,businessStartHour:9,businessEndHour:18,workHours:{highlight:!0,start:9,end:18},width:"100%",height:"1120px",cellHeight:"20px",cellWidth:"",currentDate:new Date,minDate:new Date(1900,01,01),maxDate:new Date(2099,12,31),cssClass:"",locale:"en-US",enableResize:!1,readOnly:!1,enableRTL:!1,enableAppointmentNavigation:null,showAppointmentNavigator:!0,appointmentTemplateId:null,allDayCellsTemplateId:null,dateHeaderTemplateId:null,workCellsTemplateId:null,resourceHeaderTemplateId:null,allowDragDrop:null,allowDragAndDrop:!0,enableAppointmentResize:!0,showCurrentTimeIndicator:!0,showAllDayRow:!0,showHeaderBar:!0,isResponsive:!0,enableRecurrenceValidation:!0,appointmentDragArea:"",showOverflowButton:!0,reminderSettings:{enable:!1,alertBefore:5},contextMenuSettings:{enable:!1,menuItems:{appointment:[{id:"open",text:"Open Appointment"},{id:"delete",text:"Delete Appointment"}],cells:[{id:"new",text:"New Appointment"},{id:"recurrence",text:"New Recurring Appointment"},{id:"today",text:"Today"},{id:"gotodate",text:"Go to date"},{id:"settings",text:"Settings"},{id:"view",text:"View",parentId:"settings"},{id:"timemode",text:"TimeMode",parentId:"settings"},{id:"view_Day",text:"Day",parentId:"view"},{id:"view_Week",text:"Week",parentId:"view"},{id:"view_Workweek",text:"Workweek",parentId:"view"},{id:"view_Month",text:"Month",parentId:"view"},{id:"view_Agenda",text:"Agenda",parentId:"view"},{id:"timemode_Hour12",text:"12 Hours",parentId:"timemode"},{id:"timemode_Hour24",text:"24 Hours",parentId:"timemode"},{id:"workhours",text:"Work Hours",parentId:"settings"}]}},group:null,resources:null,allowKeyboardNavigation:!0,blockoutSettings:{enable:!1,templateId:null,dataSource:[],query:null,tableName:null,id:"Id",subject:"Subject",startTime:"StartTime",endTime:"EndTime",isBlockAppointment:"IsBlockAppointment",isAllDay:null,customStyle:null,resourceId:null},appointmentSettings:{applyTimeOffset:!0,dataSource:[],query:null,tableName:null,id:null,subject:null,description:null,startTime:null,endTime:null,recurrence:null,recurrenceRule:null,allDay:null,resourceFields:null,categorize:null,recurrenceId:null,recurrenceExDate:null,location:null,priority:null,startTimeZone:null,endTimeZone:null},renderDates:null,orientation:"vertical",categorizeSettings:{title:null,enable:!1,allowMultiple:!1,dataSource:[{text:"Blue Category",id:1,color:"#43b496",fontColor:"#ffffff"},{text:"Green Category",id:2,color:"#7f993e",fontColor:"#ffffff"},{text:"Orange Category",id:3,color:"#cc8638",fontColor:"#ffffff"},{text:"Purple Category",id:4,color:"#ab54a0",fontColor:"#ffffff"},{text:"Red Category",id:5,color:"#dd654e",fontColor:"#ffffff"},{text:"Yellow Category",id:6,color:"#d0af2b",fontColor:"#ffffff"}],text:"text",id:"id",color:"color",fontColor:"fontColor"},prioritySettings:{title:null,enable:!1,template:null,dataSource:[{text:"None",value:"none"},{text:"High",value:"high"},{text:"Medium",value:"medium"},{text:"Low",value:"low"}],text:"text",value:"value"},showTimeScale:!0,tooltipSettings:{enable:!1,templateId:null},showDeleteConfirmationDialog:!0,showNextPrevMonth:!0,cellClick:null,cellHover:null,appointmentClick:null,appointmentHover:null,cellDoubleClick:null,appointmentWindowOpen:null,appointmentSaved:null,appointmentEdited:null,appointmentDeleted:null,beforeAppointmentCreate:null,beforeAppointmentChange:null,beforeAppointmentRemove:null,appointmentCreated:null,appointmentChanged:null,appointmentRemoved:null,keyDown:null,navigation:null,dragStart:null,drag:null,dragStop:null,resizeStart:null,resize:null,resizeStop:null,menuItemClick:null,beforeContextMenuOpen:null,reminder:null,actionBegin:null,actionComplete:null,overflowButtonClick:null,overflowButtonHover:null,create:null,load:null,destroy:null,queryCellInfo:null},dataTypes:{views:"array",workWeek:"array",timeZoneCollection:{dataSource:"data",query:"data"},renderDates:"data",enablePersistence:"boolean",showTimeScale:"boolean",resources:"array",group:{resources:"array"},appointmentSettings:{dataSource:"data",query:"data",subject:"parent",description:"parent",startTime:"parent",endTime:"parent",recurrence:"parent",recurrenceRule:"parent",allDay:"parent",resourceFields:"parent",categorize:"parent",location:"parent",priority:"parent",startTimeZone:"parent",endTimeZone:"parent"},categorizeSettings:{dataSource:"data",query:"data"},prioritySettings:{dataSource:"data",query:"data"},contextMenuSettings:{menuItems:{appointment:"array",cells:"array"}},blockoutSettings:{dataSource:"data",query:"data"}},_ignoreOnPersist:["appointmentSettings.query","appointmentSettings.dataSource","timeZoneCollection.dataSource","allowKeyboardNavigation","showQuickWindow","cssClass","locale","enableResize","showHeaderBar","readOnly","enableRTL","enableAppointmentNavigation",,"showAppointmentNavigator","appointmentTemplateId","resourceHeaderTemplateId","allowDragDrop","allowDragAndDrop","enableAppointmentResize","showCurrentTimeIndicator","reminderSettings.enable","contextMenuSettings.enable","group.resources","categorizeSettings.enable","categorizeSettings.dataSource","cellClick","overflowButtonClick ","overflowButtonHover","keyDown","appointmentClick","cellDoubleClick","appointmentWindowOpen","appointmentSaved","appointmentEdited","appointmentDeleted","beforeAppointmentCreate","beforeAppointmentChange","beforeAppointmentRemove","appointmentCreated","appiontmentChanged","appointmentRemoved","navigation","dragStart","dragStop","resizeStart","resize","resizeStop","menuItemClick","beforeContextMenuOpen","reminder","prioritySettings.dataSource","prioritySettings.enable","agendaViewSettings.daysInAgenda","agendaViewSettings.dateColumnTemplateId","agendaViewSettings.timeColumnTemplateId","blockoutSettings.dataSource"],_ignoreFromAppointmentOnExport:["dataSource","query","tableName","resourceFields"],_ignoreFromModelOnExport:["timezoneCollection","timeZoneCollection","contextMenuSettings","prioritySettings"],_resources:function(){this.element.empty();this._bindResourcesData();t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll()},observables:["appointmentSettings.dataSource","currentView","currentDate"],_tags:[{tag:"timeZoneCollection",attr:[],singular:"timeZoneCollection"},{tag:"appointmentSettings.dataSource",attr:[],singular:"dataSource"},{tag:"resources",attr:["allowMultiple","field","title","name","resourceSettings"]},{tag:"contextMenuSettings.menuItems.appointment",attr:["id","text","parentId"]},{tag:"contextMenuSettings.menuItems.cells",attr:["id","text","parentId"]},{tag:"categorizeSettings.dataSource",attr:["text","id","color","fontColor"]},{tag:"timeZoneCollection.dataSource",attr:["text","id","value"]},{tag:"prioritySettings.dataSource",attr:["text","value"]}],currentView:t.util.valueFunction("currentView"),currentDate:t.util.valueFunction("currentDate"),dataSource:t.util.valueFunction("appointmentSettings.dataSource"),_init:function(){n.isEmptyObject(this.model.group)&&(this.model.group=null);this._localizedLabels=t.getLocalizedConstants("ej.Schedule",this.model.locale);this.model.locale!="en-US"&&this._recurrenceLocal();t.isNullOrUndefined(this.model.workHours.start)&&(this.model.workHours.start=this.model.businessStartHour);t.isNullOrUndefined(this.model.workHours.end)&&(this.model.workHours.end=this.model.businessEndHour);t.isNullOrUndefined(this.model.workHours.highlight)&&(this.model.workHours.highlight=this.model.highlightBusinessHours);t.isNullOrUndefined(this.model.timeZoneCollection)&&(this.model.timeZoneCollection=this.model.timezoneCollection);t.isNullOrUndefined(this.model.timeScale.enable)&&(this.model.timeScale.enable=this.model.showTimeScale);this.model.showAppointmentNavigator=t.isNullOrUndefined(this.model.enableAppointmentNavigation)?this.model.showAppointmentNavigator:this.model.enableAppointmentNavigation;this.model.allowDragAndDrop=t.isNullOrUndefined(this.model.allowDragDrop)?this.model.allowDragAndDrop:this.model.allowDragDrop;t.isNullOrUndefined(this.model.beforeAppointmentCreate)&&(this.model.beforeAppointmentCreate=this.model.appointmentSaved);t.isNullOrUndefined(this.model.beforeAppointmentChange)&&(this.model.beforeAppointmentChange=this.model.appointmentEdited);t.isNullOrUndefined(this.model.beforeAppointmentRemove)&&(this.model.beforeAppointmentRemove=this.model.appointmentDeleted);this._processAppointmentSettings();this._currentDateFormat(this.model.dateFormat);this._trigger("load");this.element.addClass("e-schedule");!t.isNullOrUndefined(this.model.appointmentSettings.query)&&this.model.appointmentSettings.query instanceof t.Query||(this.model.appointmentSettings.query=t.Query());this.model.cssClass!=null&&this.element.addClass(this.model.cssClass);this._initPrivateProperties();t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._resourceSegregate();!t.isNullOrUndefined(this.model.categorizeSettings)&&this.model.categorizeSettings.dataSource instanceof t.DataManager&&this._bindCategorizeData();!t.isNullOrUndefined(this.model.prioritySettings)&&this.model.prioritySettings.dataSource instanceof t.DataManager&&this._bindPriorityData();t.scheduleFeatures.resources&&this._tempResource.length!=0?this._bindResourcesData():this._renderInitSchedule();this._wireEvents();t.isNullOrUndefined(this.model.appointmentSettings)||(this._dataManager=this.dataSource()instanceof t.DataManager?this.dataSource():this.dataSource()!=null?t.DataManager(this.dataSource()):null);this._bindAppointmentsData("Load");!t.isNullOrUndefined(this.model.blockoutSettings)&&this.model.blockoutSettings.dataSource instanceof t.DataManager?this._bindBlockData():this._renderBlockAppointments();this.model.enableRTL&&this.element.addClass("e-rtl");this.model.reminderSettings.enable&&(this._checkReminders(),this._reminderInterval=window.setInterval(n.proxy(this._checkReminders,this),6e4));this._businessHourScroller()},_processAppointmentSettings:function(){var i,r,u;this._appointmentSettings={};resource="";this._applyTimeOffset=this.model.appointmentSettings.applyTimeOffset;for(i in this.model.appointmentSettings)if(i!="applyTimeOffset"&&i!=="tableName"&&i!=="query"&&i!=="dataSource"&&(this._appointmentSettings[i]=n.type(this.model.appointmentSettings[i])=="string"||t.isNullOrUndefined(this.model.appointmentSettings[i])?this.model.appointmentSettings[i]:this.model.appointmentSettings[i].field,i!=="resourceFields"&&i!=="categorize"&&i!=="priority"&&t.isNullOrUndefined(this._appointmentSettings[i])&&(this._appointmentSettings[i]=i.charAt(0).toUpperCase()+i.slice(1)),i=="resourceFields"&&t.isNullOrUndefined(this._appointmentSettings.resourceFields)&&!t.isNullOrUndefined(this.model.resources)))for(r=0,u=this.model.resources.length;r<u;r++)resource=this.model.resources[r].field.charAt(0).toUpperCase()+this.model.resources[r].field.slice(1),this._appointmentSettings[i]+=(r!==0?",":"")+resource},_setModel:function(i){var u=!1,r,e,o,s,f,h,c,l,a;for(r in i)switch(r){case"views":this.model.views=i[r];this.model.views=this.model.views.length==0?this.currentView().toString().toLowerCase().split(","):this.model.views.toString().toLowerCase().split(",");this.hTR.find("table.e-viewstable").remove();this.hTR.find("div.e-viewsdiv").append(this._renderViewNavigation(i[r].toString().toLowerCase().split(",")));this.element.find(".e-commonviewbutton.e-"+this.currentView()).addClass("e-activeview").attr("tabIndex",0).focus();t.isNullOrUndefined(this._scheduleDrawer)||(this._scheduleDrawer.ejNavigationDrawer("destroy"),n(this._scheduleDrawer).remove(),this._scheduleDrawer=null,(this._mediaQuery||this.element.width()<600)&&!n("#"+this._id+"navDrawer").hasClass("e-scheduledrawer")&&this._renderNavigationDrawer());this.model.views.toString().toLowerCase().split(",").indexOf(this.currentView())==-1&&(this._navView=!0,this.model.views.length==0?(this.model.views=this.currentView().toString().toLowerCase().split(","),u=!0):this._viewChange(null,null,this.model.views[0].toLowerCase()));break;case"currentView":this.model.views.toString().toLowerCase().split(",").indexOf(t.util.getVal(i[r]).toLowerCase())!=-1?(this._navView=!0,this._viewChange(null,null,t.util.getVal(i[r]).toLowerCase())):(this._navView=!1,this.currentView(this.element.find(".e-activeview")[0].className.split("e-")[2].split(" ")[0]));break;case"currentDate":if(n.type(i[r])=="string"?this._currentDateFormat(this.model.dateFormat):n.type(i[r])=="function"&&n.type(t.util.getVal(i[r]))=="string"&&this.currentDate(t.parseDate(this.currentDate(),this._datepattern())),this._keyPressed)return this._keyPressed=!1,!1;this._setCurrentDate=!0;this.currentDate()<this.model.minDate&&this.currentDate(this.model.minDate);this.currentDate()>this.model.maxDate&&this.currentDate(this.model.maxDate);this._navigateClick(null,"DateNavigation");break;case"minDate":case"maxDate":this._currentDateFormat(this.model.dateFormat);u=!0;break;case"timeMode":this.model.timeMode=this._timeMode=i[r];this._updateTimeMode();break;case"timeZone":this._setmodelvalue=!0;this.model.timeZone=i[r];this.element.find("div.e-categorybar").remove();this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,.e-appsoverflow").remove();this._bindAppointmentsData("Load");!t.isNullOrUndefined(this.model.blockoutSettings)&&this.model.blockoutSettings.dataSource instanceof t.DataManager?this._bindBlockData():this._renderBlockAppointments();break;case"timeScale":n.extend(this.model.timeScale,i[r]);u=!0;break;case"timezoneCollection":case"timeZoneCollection":n.extend(this.model.timeZoneCollection,i[r]);this._appointmentAddWindow.find(".startutc").ejDropDownList({dataSource:this.model.timeZoneCollection.dataSource});this._appointmentAddWindow.find(".endutc").ejDropDownList({dataSource:this.model.timeZoneCollection.dataSource});break;case"showTimeZoneFields":this.model.showTimeZoneFields=i[r];this.model.showTimeZoneFields?(this._appointmentAddWindow.find("#"+this._id+"_appStartTime").children().length<4&&(this._mediaQuery?(e="<td width='31%'><input id='"+this._id+"startTimeZone' class='startutc'  name='"+this._appointmentSettings.startTimeZone+"' type='text' value=''/><div id='Timezoneliststr'><\/div><\/td>",o="<td><input  id='"+this._id+"endTimeZone' class='endutc' name='"+this._appointmentSettings.endTimeZone+"' type='text' value=''/><div id='Timezonelistend'><\/div><\/td>"):(e="<td width='28%'><input  id='"+this._id+"startTimeZone'  class='startutc'  name='"+this._appointmentSettings.startTimeZone+"' type='text' value=''/><div id='Timezoneliststr'><\/div><\/td>",o="<td><input id='"+this._id+"endTimeZone'  class='endutc'  name='"+this._appointmentSettings.endTimeZone+"'  type='text' value=''/><div id='Timezonelistend'><\/div><\/td>"),this._appointmentAddWindow.find("#"+this._id+"_appStartTime").append(e),this._appointmentAddWindow.find("#"+this._id+"_appEndTime").append(o),this._appointmentAddWindow.find("#"+this._id+"startTimeZone").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:this.model.timeZoneCollection.dataSource,fields:{text:"text",id:"id",value:"value"},width:"100%",select:n.proxy(this._startUtc,this),cssClass:this.model.cssClass}),this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:this.model.timeZoneCollection.dataSource,fields:{text:"text",id:"id",value:"value"},width:"100%",select:n.proxy(this._endUtc,this),cssClass:this.model.cssClass})),this._timeZoneCollection(null)):(this._appointmentAddWindow.find("#"+this._id+"_appStartTime").children().last().remove(),this._appointmentAddWindow.find("#"+this._id+"_appEndTime").children().last().remove());break;case"startHour":this.model.startHour=i[r];this.model.startHour<0&&(this.model.startHour=0);this.currentView()!=="agenda"&&this._setNewStartEndHours();break;case"endHour":this.model.endHour=i[r];this.model.endHour>24&&(this.model.endHour=24);this.currentView()!=="agenda"&&this._setNewStartEndHours();break;case"highlightBusinessHours":this.model.workHours.highlight=i[r];this.currentView()!=="agenda"&&(this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells")&&this.element.find(".e-monthcells").removeClass("e-monthcellhighlight"),this.model.workHours.highlight==!1?this._businessHourScroller():"");break;case"workHours":n.extend(this.model.workHours,i[r]);this.currentView()!=="agenda"&&(this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells")&&this.element.find(".e-monthcells").removeClass("e-monthcellhighlight"),this.model.workHours.highlight==!1?this._businessHourScroller():"",this._renderUpDownIconPosition());break;case"showAllDayRow":this.model.showAllDayRow=i[r];this.model.timeScale.enable||(this.model.showAllDayRow=!1);this.model.orientation=="vertical"&&this.model.timeScale.enable&&this.currentView()!="agenda"&&this.currentView()!="month"&&!this._isCustomMonthView()&&(this.aTR.empty(),this._renderHeaderAllDayTemplate(),this._borderAddRemove(),this._headerbarWidth(),this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay")),this.model.showAllDayRow&&this._reRenderAllDayAppointments(),this.model.orientation=="vertical"&&this.model.cellWidth&&this.element.find(".e-workcellstab tr td:first-child").width(this.element.find(".e-headercells").width()),this._reRenderScroller());break;case"isResponsive":this.model.isResponsive=i[r];this._onScheduleResize();break;case"isDST":this.model.isDST=i[r];t.isNullOrUndefined(this.model.timeZone)&&(s=new Date,this._timeValue=this._true==!1?-(s.getTimezoneOffset()-this._stdTimezoneOffset()):s.getTimezoneOffset()-this._stdTimezoneOffset(),this._true=this.model.isDST==!0?!1:!0,this._dayLight=!0,this.element.find("div.e-categorybar").remove(),this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-appsoverflow").remove(),t.isNullOrUndefined(this.model.appointmentSettings)||(this._dataManager=this.dataSource()instanceof t.DataManager?this.dataSource():this.dataSource()!=null?t.DataManager(this.dataSource()):null),this._bindAppointmentsData("Load"));break;case"enableRecurrenceValidation":this.model.enableRecurrenceValidation=i[r];this.model.enableRecurrenceValidation&&t.isNullOrUndefined(this._alertWindow)&&this._renderAlertWindow();this._dataProcessing(this._currentAppointmentData);this._renderAppointmentAll();break;case"businessStartHour":this.model.workHours.start=i[r];this.currentView()!=="agenda"&&(this.currentView()!=="month"&&!this._isCustomMonthView()?this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"):this.element.find(".e-monthcells").removeClass("e-monthcellhighlight"),this.model.workHours.highlight&&this._highlightBusinessHours());break;case"businessEndHour":this.model.workHours.end=i[r];this.currentView()!=="agenda"&&(this.currentView()!=="month"&&!this._isCustomMonthView()?this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"):this.element.find(".e-monthcells").removeClass("e-monthcellhighlight"),this.model.workHours.highlight&&this._highlightBusinessHours());break;case"height":this.model.height=i[r];this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove();u=!0;break;case"width":this.model.width=i[r];this._clientWidth=this.model.width;this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove();u=!0;break;case"cssClass":this.element.removeClass(this.model.cssClass).addClass(i[r]);break;case"locale":this.model.locale=i[r];this._localizedLabels=t.getLocalizedConstants("ej.Schedule",this.model.locale);this.model.locale!="en-US"&&this._recurrenceLocal();this._culture=t.preferredCulture(this.model.locale);this._dayShortNames=this._culture.calendar.days.namesAbbr;this._dayFullNames=this._culture.calendar.days.names;this._monthNames=this._culture.calendar.months.names;this._pattern=this._culture.calendar.patterns;this.model.contextMenuSettings.enable&&(n("#"+this._id+"gotoWindow_wrapper").remove(),this._gotoDate=!0);u=!0;break;case"dateFormat":this._appointmentAddWindow.find(".startenddate").ejDatePicker({dateFormat:i[r]});this._appointmentAddWindow.find(".recurstartdate").ejDatePicker({dateFormat:i[r]});this._appointmentAddWindow.find(".e-until").ejDatePicker({dateFormat:i[r]});this._currentDateFormat(i[r]);break;case"enableResize":this.model.enableResize=i[r];this.model.enableResize&&(t.isTouchDevice()?this._on(n(window),"orientationchange",n.proxy(this._onScheduleResize,this)):this._on(n(window),"resize",n.proxy(this._onScheduleResize,this)));break;case"readOnly":this.model.readOnly=i[r];this._renderAppointmentAll();break;case"showCurrentTimeIndicator":this.model.showCurrentTimeIndicator=i[r];this.currentView()!=="agenda"&&(this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this.model.showCurrentTimeIndicator||(this.currentView()!=="month"&&!this._isCustomMonthView()?this.element.find(".e-highlightcurrenttimeline").remove():n(this.element.find(".e-monthcells")).removeClass("e-monthcurrenttime")));break;case"enableRTL":i[r]?this.element.addClass("e-rtl"):this.element.removeClass("e-rtl");this.model.enableRTL=i[r];u=!0;this.model.contextMenuSettings.enable&&(n("#"+this._id+"gotoWindow_wrapper").remove(),this._gotoDate=!0);this._quickAppointWindow=null;break;case"appointmentTemplateId":this.model.appointmentTemplateId=i[r];this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,.e-appsoverflow").remove();this.element.find("div.e-categorybar").remove();t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll();break;case"allDayCellsTemplateId":this.model.allDayCellsTemplateId=i[r];u=!0;break;case"dateHeaderTemplateId":this.model.dateHeaderTemplateId=i[r];u=!0;break;case"workCellsTemplateId":this.model.workCellsTemplateId=i[r];u=!0;break;case"allowKeyboardNavigation":this.model.allowKeyboardNavigation=i[r];this.model.allowKeyboardNavigation?(this._on(this.element,"keydown",n.proxy(this._onKeyDown,this)),this._on(n(document),"keydown",n.proxy(this._documentOnKeyDown,this))):(this._off(this.element,"keydown"),this._off(n(document),"keydown"));break;case"renderDates":n.extend(this.model.renderDates,i[r]);this._navView=!0;this._navigate=!1;this._viewChange(null,null,"customview");break;case"showTimeScale":this.model.timeScale.enable=i[r];this.model.timeScale.enable?(this.model.showAllDayRow?this.model.showAllDayRow=!0:"",this.model.showCurrentTimeIndicator?this.model.showCurrentTimeIndicator=!0:""):(this.model.showAllDayRow=!1,this.model.showCurrentTimeIndicator=!1);this.currentView()!=="agenda"&&(u=!0);break;case"appointmentSettings":n.isEmptyObject(i[r])||(n.extend(this.model.appointmentSettings,i[r]),this._processAppointmentSettings(),this.element.find("div.e-categorybar").remove(),this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-appsoverflow").remove(),t.isNullOrUndefined(this.model.appointmentSettings)||(this._dataManager=this.dataSource()instanceof t.DataManager?this.dataSource():this.dataSource()!=null?t.DataManager(this.dataSource()):null),this._setmodelvalue=!0,this._bindAppointmentsData("Load"));break;case"contextMenuSettings":n.extend(this.model.contextMenuSettings,i[r]);this.model.contextMenuSettings.enable&&(t.isNullOrUndefined(this._contextMenu)||this.model.categorizeSettings.enable)&&this._showContextMenu(this.model.contextMenuSettings.enable);break;case"reminderSettings":i[r].enable?this._checkReminders()&&(this._reminderInterval=window.setInterval(n.proxy(this._checkReminders,this),6e4)):window.clearInterval(this._reminderInterval);break;case"showAppointmentNavigator":case"enableAppointmentNavigation":this.model.showAppointmentNavigator=this.model.enableAppointmentNavigation=i[r];this.model.showAppointmentNavigator?(this._nextPrevAppointment(this.model.showAppointmentNavigator),this.model.orientation=="vertical"&&this.element.find(".e-vscroll").length>0&&this.currentView()!="month"&&!this._isCustomMonthView()&&!this._mediaQuery&&this._renderUpDownIcon(),t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll()):(this.element.find(".e-prevapp,.e-nextapp").remove(),this.element.find(".e-upicon,.e-downicon").remove());break;case"enableLoadOnDemand":this.model.enableLoadOnDemand=i[r];this.element.find("div.e-categorybar").remove();this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,.e-appsoverflow").remove();this._bindAppointmentsData("Load");break;case"resources":t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&(t.copyObject(this.model.resources,i[r]),this.model.resources=i[r],this.model.resources.length==0?(this.model.resources=null,this.model.group=null,u=!0):u=!0);break;case"categorizeSettings":n.extend(this.model.categorizeSettings,i[r]);t.isNullOrUndefined(this.model.categorizeSettings)||(this.model.categorizeSettings.enable?(this._appointmentAddWindow.find(".e-categorizevalue").length==1&&this._appointmentAddWindow.find("#"+this._id+"categorizetr").remove(),f="<tr id='"+this._id+"categorizetr'><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Categorize")+":<\/td><td colspan='3' class='e-rightfields'><input id= '"+this._id+"categorize' class='e-categorizevalue' type='text' name='"+this._appointmentSettings.categorize+"' value=''/><\/td><\/tr>",this._appointmentAddWindow.find("."+this._id+"summary").after(f),this._renderTemplates(),this._renderCategoryItems(this._appointmentAddWindow)):this._appointmentAddWindow.find("#"+this._id+"categorizetr").remove(),this._showContextMenu(this.model.contextMenuSettings.enable),this._appointmentAddWindow.find(".e-categorizevalue").ejAutocomplete("clearText"),this._renderCategoryItems(this._appointmentAddWindow),t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll());break;case"group":t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&(n.extend(this.model.group,i[r]),n.isEmptyObject(this.model.group)&&(this.model.group=null),u=!0);break;case"cellWidth":this.model.cellWidth=i[r];this.currentView()!=="agenda"&&(u=!0);break;case"cellHeight":this.model.cellHeight=i[r];this.currentView()!=="agenda"&&(u=!0);break;case"orientation":this.model.orientation=i[r];t.scheduleFeatures.resources&&this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)&&this.model.orientation=="horizontal"&&this._on(this.element,"click",".e-parentnodecategory",n.proxy(this._onResourceClick,this));u=!0;break;case"resourceHeaderTemplateId":this.model.resourceHeaderTemplateId=i[r];t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&(this.currentView()!="agenda"?this.model.orientation=="horizontal"?(h=n(this.wTR.find("td")[0]),h.find("div.e-horizontresdiv").remove(),c=this._renderHorizontalResources(),h.html(c)):(this.aTR.empty(),this._renderHeaderAllDayTemplate(),this._borderAddRemove(),this._headerbarWidth(),this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay")),this.model.showAllDayRow&&this._reRenderAllDayAppointments()):this._renderAgendaContent());break;case"showLocationField":this.model.showLocationField=i[r];this.model.showLocationField?(f="<tr id='"+this._id+"showLocation' class='"+this._id+"showLocation'><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Location")+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"location' tabIndex='0' class='location e-inputtext' name='"+this._appointmentSettings.location+"' type='text' /><\/td><\/tr>",this._appointmentAddWindow.find("."+this._id+"subjecttr").after(f)):this._appointmentAddWindow.find("."+this._id+"showLocation").remove();break;case"prioritySettings":n.extend(this.model.prioritySettings,i[r]);this.model.prioritySettings.enable?(this._appointmentAddWindow.find("."+this._id+"priorityshow").length==1&&(this._appointmentAddWindow.find("."+this._id+"priorityshow").remove(),this._appointmentAddWindow.find("."+this._id+"prioritylistshow").remove()),f="<td colspan='1' class='e-textlabel "+this._id+"priorityshow'>"+this._getLocalizedLabels("Priority")+":<\/td><td colspan='1' class='"+this._id+"prioritylistshow'><input id='"+this._id+"priority' class='priority' type='text' name='"+this._appointmentSettings.priority+"' value='' /><div id='prioritylist'><\/div><\/td>",this._appointmentAddWindow.find("."+this._id+"parrow").prepend(f),this._renderPriorityItems(this._appointmentAddWindow),this._renderTemplates()):(this._appointmentAddWindow.find("."+this._id+"priorityshow").remove(),this._appointmentAddWindow.find("."+this._id+"prioritylistshow").remove());t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll();break;case"showQuickWindow":this.model.showQuickWindow=i[r];this.model.showQuickWindow&&t.isNullOrUndefined(this._quickAppointWindow)&&(this._renderQuickAppWindow()||this._renderQuickAppDetailsView());n.isFunction(n.validator)&&this._setQuickValidation();this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");this._quickWindow=this.model.showQuickWindow;break;case"allowDragAndDrop":case"allowDragDrop":if(this.model.allowDragAndDrop=this.model.allowDragDrop=i[r],this.currentView()=="agenda")return!1;this.model.allowDragAndDrop?this._dragdropAppointments():this._unWireDragDrop();break;case"enableAppointmentResize":if(this.model.enableAppointmentResize=i[r],this.currentView()=="agenda")return!1;this._renderAppointmentAll();break;case"showHeaderBar":this.model.showHeaderBar=i[r];this.model.showHeaderBar?(this.element.find(".e-scheduleheader").show(),this._reRenderHeaderBar()):(this.element.find(".e-scheduleheader").empty(),this.element.find(".e-scheduleheader").hide());this.refreshScroller();break;case"tooltipSettings":n.extend(this.model.tooltipSettings,i[r]);l=this.model.tooltipSettings.enable?".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendacells.e-eventcolumn,.e-appup,.e-appdown,.e-appsoverflow":".e-appup,.e-appdown,.e-appsoverflow";a=this.element.data("ejTooltip");a.setModel({target:l});break;case"showOverflowButton":this.model.showOverflowButton=i[r];u=!0;break;case"appointmentDragArea":this.model.appointmentDragArea=i[r];u=!0;break;case"firstDayOfWeek":this.model.firstDayOfWeek=this._firstdayofweek=i[r];this._firstdayofweek&&(u=!0);break;case"workWeek":this.model.workWeek=i[r];(this.model.workWeek==null||this.model.workWeek.length>=0)&&(u=!0);break;case"agendaViewSettings":n.extend(this.model.agendaViewSettings,i[r]);this.currentView()=="agenda"&&(this.model.showHeaderBar&&(this.element.find("div.e-datedisplay")[0].innerHTML=this._getCurrentDateHeaderValue()),this._renderAgendaContent());break;case"showNextPrevMonth":this.model.showNextPrevMonth=i[r];this.model.orientation=="vertical"&&this.currentView()=="month"&&(this._renderMonthTimeCells(),this._highlightBusinessHours(),this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll());break;case"blockoutSettings":n.isEmptyObject(i[r])||(n.extend(this.model.blockoutSettings,i[r]),!t.isNullOrUndefined(this.model.blockoutSettings)&&this.model.blockoutSettings.dataSource instanceof t.DataManager?this._bindBlockData():this._renderBlockAppointments())}u&&(this.element.empty(),t.isNullOrUndefined(this.element.data("ejTooltip"))||this.element.ejTooltip("destroy"),this._scheduleDrawer=null,n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"AppointmentQuickWindow_wrapper,#"+this._id+"AppDetailsWindow_wrapper,#"+this._id+"RecurrenceEdit_wrapper").remove(),t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._resourceSegregate(),this._setmodelvalue=!0,this._tempResource.length==0&&this._grouping.length==0?this._renderInitSchedule():this._bindResourcesData(),this.model.workHours.highlight==!0?this._businessHourScroller():"",t.isNullOrUndefined(this.dataSource())||this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll(),this._renderBlockAppointments())},_touchSchedule:function(t){if(n(t.target).is(".e-appointment,.e-alldayappointment,.e-monthappointment")||n(t.target).parents().is(".e-appointment,.e-alldayappointment,.e-monthappointment")||this.model.orientation=="horizontal")return!1;var e=this.model.enableRTL?t.type=="swipeleft"?"swiperight":"swipeleft":t.type,f=this.model.enableRTL?"margin-right":"margin-left",u,i=parseInt(this.element.find(".e-draggableworkarea").css(f)),r=Math.round(this.element.find(".e-draggableworkarea").width()/this.res1.length);switch(e){case"swipeleft":if(this._mediaQuery&&this.currentView()!="agenda"&&this.model.orientation=="vertical"){if(-i<this.element.find(".e-draggableworkarea").width()-r)return this.element.find(".e-headeralldaydiv,.e-draggableworkarea").animate(this.model.enableRTL?{"margin-right":i+-r}:{"margin-left":i+-r},500),!1;this.element.find(".e-headeralldaydiv,.e-draggableworkarea,.e-emptyscrolltd").css(f,"0px")}u={currentTarget:this.element.find(".e-navigatenext")};this._navigateClick(u,"Next");break;case"swiperight":if(this._mediaQuery&&this.currentView()!="agenda"&&this.model.orientation=="vertical"){if(-i>0)return this.element.find(".e-headeralldaydiv,.e-draggableworkarea").animate(this.model.enableRTL?{"margin-right":i+r}:{"margin-left":i+r},500),!1;this.element.find(".e-headeralldaydiv,.e-draggableworkarea,.e-emptyscrolltd").css(f,"0px")}u={currentTarget:this.element.find(".e-navigateprevious")};this._navigateClick(u,"Previous")}},_initPrivateProperties:function(){this._navSelected=this._navDrawer=this._alldayLevel=this._reminderClose=this._navView=this._editKey=this._cellClick=this._recurChecked=this._setCurrentDate=this._leftResizing=this._rightResizing=this._topResizing=this._bottomResizing=this._navigate=this._navigate=!1;this._gotoDate=this._bindapp=this._showBlockAlert=!0;this._tempStart=this._tempEnd=this._currentAction="";this._currentRowIndex=this._currentColIndex=0;this._appId=this._parentId=1;this.overlapList=this._currentAppointmentData=this._processed=this._dateRender=this._app=this._grouping=this._tempResource=[];this.res1=[0];this._appMainId=null;this._dayNamesArray=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];this._dayNames=["SU","MO","TU","WE","TH","FR","SA"];this._culture=t.preferredCulture(this.model.locale);this._dayShortNames=this._culture.calendar.days.namesAbbr;this._dayFullNames=this._culture.calendar.days.names;this._monthNames=this._culture.calendar.months.names;this._pattern=this._culture.calendar.patterns;this._browserInfo=t.browserInfo();this._safariBrowser=this._browserInfo.name=="webkit"&&!t.isTouchDevice();this._focused=null;String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")}},_destroy:function(){this.element.off();this._destorySubControls(n("#"+this._id+"_AddEditForm"));this._appointmentAddWindow.find("#"+this._id+"recurrenceEditor").ejRecurrenceEditor("destroy");this.element.find("#"+this._id+"_navigator").ejDatePicker("destroy");window.clearInterval(this._intervalID);t.isNullOrUndefined(this.element.data("ejTooltip"))||this.element.ejTooltip("destroy");n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"AppointmentQuickWindow_wrapper,#"+this._id+"AppDetailsWindow_wrapper,#"+this._id+"RecurrenceEdit_wrapper,#"+this._id+"gotoWindow_wrapper").remove();n("#"+this._id+"_WorkCells_Template,#"+this._id+"_MonthCells_Template,#"+this._id+"_TimeCells_Template,#"+this._id+"_HeaderDate_Template,#"+this._id+"_Appointment_Template,#"+this._id+"_AlldayCells_Template,#"+this._id+"_LeftIndentCells_Template,#"+this._id+"_AgendaCells_Template,#"+this._id+"_userTimeCells_Template,#"+this._id+"_BlockTime_Template,#"+this._id+"_HorizontalHeader_Template,#"+this._id+"_HorizontalCells_Template,#"+this._id+"_HorizontalResources_Template").remove();this.element.empty().removeClass("e-schedule")},_destorySubControls:function(t){for(var i,u=t.find(".e-timepicker,.e-datepicker,.e-dropdownlist,.e-autocomplete"),r=0;r<u.length;r++)i=n(u[r]),i.hasClass("e-timepicker")?i.ejTimePicker("destroy"):i.hasClass("e-datepicker")?i.ejDatePicker("destroy"):i.hasClass("e-dropdownlist")?i.ejDropDownList("destroy"):i.hasClass("e-autocomplete")&&i.ejAutocomplete("destroy")},_closeRecurence:function(n){if(this._appointmentAddWindow.find(".e-recuruntil").ejRadioButton("option","checked")&&n.model.text!=this._getLocalizedLabels("Cancel")&&this._appointmentAddWindow.find(".recurstartdate").ejDatePicker("option","value")>this._appointmentAddWindow.find(".e-until").ejDatePicker("option","value"))return this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("WrongPattern")),this._alertWindow.ejDialog("open"),!1;if(n.model.text==this._getLocalizedLabels("Cancel"))this._appointmentAddWindow.find(".e-recurFinalRule").html()==""&&this._appointmentAddWindow.find("#"+this._id+"recurrence").ejCheckBox({checked:!1});else{var t=this._appointmentAddWindow.find(".e-recurEditor").data("ejRecurrenceEditor"),r=t.closeRecurPublic(),i=t.element.find(".recurstartdate").ejDatePicker("option","value");new Date(this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value")).getTime()!=new Date(i).getTime()&&this._recurDateChange(i);this._appointmentAddWindow.find("."+this._id+"summary").css("display","table-row");this._appointmentAddWindow.find(".e-recurFinalRule").html(r);this._appointmentAddWindow.find(".e-recuredit").css("display","inline");recurOption=""}this._appointmentAddWindow.find(".e-recurEditor").toggle();this._appointmentAddWindow.find(".e-appwindow").css("margin-left",700).toggle().animate({"margin-left":10},300);this._mediaQuery&&this._appointmentAddWindow.parent().parent().find(".e-dialog-icon").css("display","block");this._appointmentAddWindow.find(".done").focus()},_wireEvents:function(){this._on((this.element,n(window)),"mousedown",n.proxy(this._onScheduleMouseDown,this));this._on(this.element,"click","div.e-navigateprevious,div.e-navigatenext",n.proxy(this._navigateClick,this));this._on(n(window),"resize",n.proxy(this._onScheduleResize,this));this._on(this.element,"click",".e-commonviewbutton",n.proxy(this._viewChange,this));this._on(this.element,"click",".e-datedisplay",n.proxy(this._viewCalendar,this));this._on(this.element,"click","div.e-appsoverflow",n.proxy(this._appOverflowClick,this));this._on(this.element,"click",".e-prevapp.enable,.e-nextapp.enable",n.proxy(this._nextPrev,this));this._on(this.element,"dblclick",".e-headercells",n.proxy(this._navigateView,this));this._on(this.element,"click",".e-headercells,.e-timecells,td.e-monthcells div.e-monthheader",n.proxy(this._navigateView,this));this._on(this.element,"mouseover","td.e-alldaycells,td.e-workcells:not('.e-resourceheadercells'),td.e-monthcells:not('.e-othermonths'),td.e-agendacells",n.proxy(this._onCellMouseOver,this));this._on(this.element,"mouseout","td.e-alldaycells,td.e-workcells:not('.e-resourceheadercells'),td.e-monthcells:not('.e-othermonths'),td.e-agendacells",n.proxy(this._onCellMouseOver,this));this._on(this.element,"click",".e-workcells,.e-alldaycells,.e-alldayappointment,.e-monthcells:not('.e-othermonths'),.e-agendacells",n.proxy(this._cellSelection,this));this._mediaQuery||t.isTouchDevice()||(this._on(this.element,t.eventType.mouseDown,"td.e-workcells,td.e-monthcells:not('.e-othermonths'),td.e-alldaycells",n.proxy(this._mouseButtonClick,this)),this._on(this.element,"keydown click","td.e-workcells,td.e-monthcells:not('.e-othermonths'),td.e-alldaycells",n.proxy(this._shiftSelection,this)));this._on(this.element,t.isMobile()?"click":"dblclick",".e-workcells:not('.e-resourceheadercells'),.e-alldaycells,.e-alldayappointment,.e-monthcells:not('.e-othermonths'),.e-agendacells.e-eventcolumn,.e-agendacells.e-timecolumn",n.proxy(this._appointmentWindow,this));(this._mediaQuery||t.isMobile())&&this._on(this.element,"tap",".e-appointment,.e-alldayappointment,div.e-monthappointment,.e-agendaappointment",n.proxy(this._appointmentWindow,this));this._on(this.element,"mouseover",".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment",n.proxy(this._onAppointMouseOver,this));this._on(this.element,"mouseout",".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment",n.proxy(this._onAppointMouseOver,this));this._on(this.element,"click",".e-appup,.e-appdown",n.proxy(this._renderAppPosition,this));(this._mediaQuery||this.element.width()<600)&&this._on(this.element,"click","#"+this._id+"navDrawerIcon",n.proxy(this._drawerOpen,this));this.model.allowKeyboardNavigation&&(this._on(this.element,"keydown",n.proxy(this._onKeyDown,this)),this._on(n(this.element),"keydown",n.proxy(this._documentOnKeyDown,this)));this.model.orientation=="horizontal"&&this._on(this.element,"click",".e-parentnodecategory",n.proxy(this._onResourceClick,this));(this._mediaQuery||t.isTouchDevice())&&this._on(this.element,"swipeleft swiperight",".e-contentarearow .e-workcellstab,.e-agendacellstab",n.proxy(this._touchSchedule,this));this.model.enableResize&&(t.isTouchDevice()?this._on(n(window),"orientationchange",n.proxy(this._onScheduleResize,this)):this._on(n(window),"resize",n.proxy(this._onScheduleResize,this)));this._on(this.element,"click",".e-schedulemouseclose,.e-deleteapp",n.proxy(this._deleteAppoint,this));this._on(this.element,"click",".e-editapp",n.proxy(this._appointmentWindow,this))},_drawerOpen:function(){this._scheduleDrawer.ejNavigationDrawer("open")},_mouseButtonClick:function(i){var s,e,o;if(!i.altKey&&!i.shiftKey&&!i.ctrlKey&&i.which!=3&&(i.which==1||i.type=="touchstart")&&!n(i.target).hasClass("e-resourceheadercells")&&!n(i.target).hasClass("e-othermonths")){var u=i.target||document.activeElement||i.srcElement,f=this.element.find("div.e-draggableworkarea tr"),r=this;if(n(u).hasClass("e-alldaycells")&&(f=this.element.find(".e-alldaycells").parent()),n(u).hasClass("e-selectedAppointment")&&(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(f[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()),this._currentRowIndex=n(u).parent()[0].rowIndex,this._currentColIndex=n(u)[0].cellIndex,s=r.model.orientation=="horizontal"&&r.currentView()=="month"?r.monthDays:r.model.orientation=="vertical"?r.dateRender:r._dateRender,e=n(i.target).hasClass("e-workcells")||n(i.target).hasClass("e-alldaycells")?n(i.target).index():7-((parseInt(n(i.target).index()/7)+1)*7-n(i.target).index())+n(i.target).parent().index()*7,this.model.orientation=="horizontal"&&(e=r.currentView()!=="month"?Math.floor(e/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))):e),o=new Date(s[e]),o>=this.model.minDate&&o<=this.model.maxDate&&(n(u).hasClass("e-workcells")||n(u).hasClass("e-monthcells")||n(u).hasClass("e-alldaycells"))){f.on(t.eventType.mouseMove,function(t){var i,f;r.model.showQuickWindow&&r._quickAppointWindow.ejDialog("close")&&r._quickAppDetailsWindow.ejDialog("close");t.preventDefault();i=t.target;t.type=="touchmove"&&(f=t.originalEvent.changedTouches[0],i=document.elementFromPoint(f.pageX,f.pageY));n(i).hasClass("e-selectedCell")&&r.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell");r._mouseSelection(t,r,u,i);r._moveScrollContent(u,r)});f.on(t.eventType.mouseUp,function(){f.off(t.eventType.mouseMove)});this.element.find("e.workcells,e.alldaycells,.e-monthcells").removeClass("e-mousehover");this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell");this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment")}}},_mouseSelection:function(t,i,r,u){var s=i.element.find("div.e-draggableworkarea tr"),a=n(r).parent().index(),o=n(r).index(),g=s.length-1,h,c,f,l=n(u).parent().index(),e=n(u).index(),p=i.element.find(".e-alldaycells").parent(),k=i.model.showAllDayRow,v,d,w,b,y;if(this._resWorkWeek)for(v=0,d=0;d<this.res1.length;d++)if(e<=v+(this.res1[d][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length-1)){w=v+this.res1[d][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length;break}else v+=this.res1[d][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length;else var nt=i.model.orientation=="horizontal"?s[0].cells.length:i.currentView()=="month"||i._isCustomMonthView()?s[0].cells.length/i.res1.length:i._dateRender.length,tt=Math.floor(n(u).index()/nt),w=nt*(tt+1),v=nt*tt;if(n(u).hasClass("e-workcells"))if(i.model.orientation=="vertical")if(o>=parseInt(v)&&o<=parseInt(w)-1&&e!="undefined"){if(o==e)if(l>a)for(f=parseInt(a);f<=l;f++)n(s[f].cells[o]).addClass("e-selectedCell");else if(l<a)for(f=parseInt(a);f>=l;f--)n(s[f].cells[o]).addClass("e-selectedCell");else n(s[l].cells[e]).addClass("e-selectedCell");else if(e>o){for(y=e-o,h=parseInt(a);h<=g;h++)n(s[h].cells[o]).addClass("e-selectedCell");if(k&&n(p[0].cells[[o]]).addClass("e-selectedCell"),k&&n(p[0].cells[[e]]).addClass("e-selectedCell"),y>1)for(f=1;f<=y-1;f++){for(b=0;b<=g;b++)n(s[b].cells[e-f]).addClass("e-selectedCell");k&&n(p[0].cells[[e-f]]).addClass("e-selectedCell")}for(c=0;c<=l;c++)n(s[c].cells[e]).addClass("e-selectedCell")}else if(e<o){for(y=o-e,h=parseInt(a);h>=0;h--)n(s[h].cells[o]).addClass("e-selectedCell");if(k&&n(p[0].cells[[o]]).addClass("e-selectedCell"),k&&n(p[0].cells[[e]]).addClass("e-selectedCell"),y>1)for(f=1;f<=y-1;f++){for(b=0;b<=g;b++)n(s[b].cells[[e+f]]).addClass("e-selectedCell");k&&n(p[0].cells[[e+f]]).addClass("e-selectedCell")}for(c=parseInt(l);c<=g;c++)n(s[c].cells[e]).addClass("e-selectedCell")}i._currentRowIndex=l;i._currentColIndex=e;n(s[l].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1;else if(a==l&&o>=parseInt(v)&&o<=parseInt(w)-1&&e!="undefined"){if(e>o)for(c=o;c<=e;c++)n(s[l].cells[c]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(e<=o)for(c=o;c>=e;c--)n(s[l].cells[c]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1;else if(n(u).hasClass("e-alldaycells"))if(o>=parseInt(v)&&o<=parseInt(w)-1&&e!="undefined"){if(e<o)for(f=o;f>=e;f--)n(p[0].cells[f]).addClass("e-selectedCell");else if(e>o)for(f=o;f<=e;f++)n(p[0].cells[f]).addClass("e-selectedCell");i._currentRowIndex=0;i._currentColIndex=e;n(p[0].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1;else if(n(u).hasClass("e-monthcells")){if(n(u).hasClass("e-othermonths"))return!1;if(o>=parseInt(v)&&o<=parseInt(w)-1&&e!="undefined"){if(l==a)if(e<o)for(f=o;f>=e;f--)n(s[l].cells[f]).addClass("e-selectedCell");else if(e>o)for(f=o;f<=e;f++)n(s[l].cells[f]).addClass("e-selectedCell");else e==o&&n(s[l].cells[e]).addClass("e-selectedCell");else if(l>a){for(y=l-a,h=o;h<w;h++)n(s[a].cells[h]).addClass("e-selectedCell");if(y>1)for(f=1;f<=y-1;f++)for(h=v;h<w;h++)n(s[a+f].cells[h]).addClass("e-selectedCell");for(c=v;c<=e;c++)n(s[l].cells[c]).addClass("e-selectedCell")}else if(l<a){for(y=a-l,h=o;h>=v;h--)n(s[a].cells[h]).addClass("e-selectedCell");if(y>1)for(f=1;f<=y-1;f++)for(h=v;h<w;h++)n(s[a-f].cells[h]).addClass("e-selectedCell");for(c=w-1;c>=e;c--)n(s[l].cells[c]).addClass("e-selectedCell")}i._currentRowIndex=l;i._currentColIndex=e;n(s[l].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1}},_shiftSelection:function(t){var u,i,r;if(t.shiftKey==!0&&t.which==1&&!n(t.target).hasClass("e-resourceheadercells")){var f=this._focused,e=this,o=t.target;this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");this.element.find("e.workcells,e.alldaycells,.e-monthcells").removeClass("e-mousehover");this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell");this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment");u=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender;i=n(t.target).hasClass("e-workcells")||n(t.target).hasClass("e-alldaycells")?n(t.target).index():7-((parseInt(n(t.target).index()/7)+1)*7-n(t.target).index())+n(t.target).parent().index()*7;this.model.orientation=="horizontal"&&(i=this.currentView()!=="month"?Math.floor(i/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))):i);r=new Date(u[i]);r>=this.model.minDate&&r<=this.model.maxDate&&this._mouseSelection(t,e,f,o)}},_moveScrollContent:function(t,i){var r,f,u;i.model.orientation==="horizontal"?(r=i.element.find(".e-draggableworkarea").scrollLeft(),r=i.model.enableRTL?i._browserInfo.name=="mozilla"?r>0?r:r*-1:i._browserInfo.name=="chrome"||i._browserInfo.name=="webkit"?i.element.find(".e-workcells")[0].offsetLeft+i.element.find(".e-workcells").width()-i.element.find(".e-draggableworkarea").scrollLeft()-i.element.find(".e-draggableworkarea").width():Math.abs(r):-r,i.currentView()!="month"?n(i.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",r+"px"):i.element.find(".e-headerdays").css("left",r+"px"),i.currentView()==="day"||i.currentView()==="month"||i.currentView()=="customview"&&i._dateRender.length>7||!i.model.timeScale.enable||(f=n(i.element.find(".e-headercells").find(".e-activeview").parent()).index(),u=Math.floor(Math.abs(r)/(i.element.find(".e-workcells").width()+1)/((i.model.endHour-i.model.startHour)*2)),f!==u&&i.element.find(".e-headercells").children().removeClass("e-activeview"),n(i.element.find(".e-headercells")[u]).children().addClass("e-activeview"))):n(t).hasClass("e-monthcells")||i.element.find(".e-scrolltimecells").css("top",-i.element.find(".e-draggableworkarea").scrollTop()+"px")},_onScheduleMouseDown:function(t){var i=n(t.target),r=i.hasClass("e-appointment,e-alldayappointment,e-monthappointment")?i:i.parents(".e-appointment,.e-alldayappointment,.e-monthappointment");i.hasClass("e-workcells")||r.hasClass("e-appointment")||r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment")||i.hasClass("e-alldaycells")||i.hasClass("e-monthcells")||i.parents(".e-scheduledialog").hasClass("e-scheduledialog")||(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),this.element.find(".e-workcells").removeClass("e-mousehover"))},_onCellMouseOver:function(i){var r,u,e,f,o;if(n(i.target).hasClass("e-blocktimeappointment")||n(i.target).closest(".e-blocktimeappointment").length>0)return!1;if(this.currentView()=="agenda"){if(this._mediaQuery==!0)return!1;r=n(i.currentTarget);i.type==="mouseover"?(this.element.find(".e-mousehover").removeClass("e-mousehover"),r.hasClass("e-agendacells")&&(r.parent().find(".e-timecolumn,.e-eventcolumn").addClass("e-mousehover"),r.parent().find(".e-editapp").parent().show())):i.type==="mouseout"&&r.hasClass("e-agendacells")&&(r.parent().find(".e-timecolumn,.e-eventcolumn").removeClass("e-mousehover"),r.parent().find(".e-editapp").parent().hide())}else if(r=n(i.currentTarget),u=n(i.target).hasClass("e-workcells")?n(i.target).index():n(i.target).hasClass("e-alldaycells")?n(i.target).index():7-((parseInt(n(i.target).index()/7)+1)*7-n(i.target).index())+n(i.target).parent().index()*7,this.model.orientation=="horizontal"&&(u=this.currentView()!=="month"?Math.floor(u/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))):u),e=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,f=new Date(e[u]),this._slotByElement(n(i.target),"cellHover"),o={cellIndex:u,startTime:new Date(this.cellHoverStartTime),endTime:new Date(this.cellHoverEndTime),target:i,resources:!t.isNullOrUndefined(this.model.cellHover)&&this._tempResource.length!=0?this._getResourceValue(r,u):null},f>=this.model.minDate&&f<=this.model.maxDate)if(i.type==="mouseover"){if(this._trigger("cellHover",o))return!1;this.element.find(".e-mousehover").removeClass("e-mousehover");(r.hasClass("e-workcells")||r.hasClass("e-monthcells"))&&!r.hasClass("e-resourceheadercells")&&r.addClass("e-mousehover")}else i.type==="mouseout"&&(r.hasClass("e-workcells")||r.hasClass("e-monthcells"))&&r.removeClass("e-mousehover");else return!1},_getAppDetails:function(i){var r=t.isNullOrUndefined(i.target)?n(i):n(i.target),o=r.hasClass("e-appointment")||r.hasClass("e-monthappointment")||r.hasClass("e-alldayappointment")||r.hasClass("e-agendaappointment")?r:r.parents(".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment"),u,f,e;return(this.currentView()=="agenda"&&r.hasClass("e-eventcolumn")&&(o=r.find(".e-agendaappointment")),appId=o.attr("guid"),t.isNullOrUndefined(appId))?!1:(u=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,appId)),u[0][this._appointmentSettings.recurrence]?(f=n.extend(!0,[],u),f[0][this._appointmentSettings.endTime]=f[f.length-1][this._appointmentSettings.endTime],e=u[0][this._appointmentSettings.recurrence]&&u[0][this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")==1?this._getAppointmentByParentId(appId):f[0]):e=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,appId))[0],e)},_onAppointMouseOver:function(i){var f,u,r;if(!this.model.readOnly){if(!t.isNullOrUndefined(this.model.appointmentHover)&&(f={appointment:this._getAppDetails(i)},this._trigger("appointmentHover",f)))return!1;if(this.currentView()=="agenda"){if(this._mediaQuery==!0)return!1;u=n(i.currentTarget);i.type==="mouseover"?(this.element.find(".e-mousehover").removeClass("e-mousehover"),u.hasClass("e-agendaappointment")&&(u.addClass("e-mousehover"),u.find(".e-editapp").parent().show())):i.type==="mouseout"&&u.hasClass("e-agendaappointment")&&(u.removeClass("e-mousehover"),u.find(".e-editapp").parent().hide())}else r=n(i.target).hasClass("e-appointment,e-alldayappointment,e-monthappointment")?n(i.target):n(i.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),r.hasClass("e-appointment")&&this.model.orientation=="vertical"?i.type==="mouseover"?(this.model.enableAppointmentResize&&(r.find(".e-bottomhandle,.e-tophandle").addClass("e-icon e-nsexpand"),r.find(".e-bottomhandle").addClass("e-appointresizer-bottom"),r.find(".e-tophandle").addClass("e-appointresizer-top")),r.find(".e-schedulemouseclose").css("display","block")):i.type==="mouseout"&&(this.model.enableAppointmentResize&&r.find(".e-bottomhandle,.e-tophandle").removeClass("e-icon e-nsexpand"),r.find(".e-schedulemouseclose").css("display","none")):((r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment"))&&this.model.orientation=="vertical"||this.model.orientation=="horizontal")&&(i.type==="mouseover"?(this.model.enableAppointmentResize&&(r.find(".e-lefthandle,.e-righthandle").addClass("e-icon e-ewexpand"),r.find(".e-lefthandle").addClass("e-appointresizer-left"),r.find(".e-righthandle").addClass("e-appointresizer-right")),r.find(".e-schedulemouseclose").css("display","block")):i.type==="mouseout"&&(this.model.enableAppointmentResize&&r.find(".e-lefthandle,.e-righthandle").removeClass("e-icon e-ewexpand"),r.find(".e-schedulemouseclose").css("display","none")))}},_quickWindowPosition:function(t,i,r,u){var a=u.find(".e-tableAppoint"),f=n("#"+u.prop("id")+"_wrapper").width(),e=this.element.offset().left,o=this.element.offset().left+this.element.width(),s=this.element.offset().top,w=this.element.offset().top+this.element.height(),c=r.width()/2,v="rotate(0deg)",l=!0,h="40%",y="4px",p;return t>e&&t+f>o&&i>s?(t=o-f-5,h=r.offset().left-t+c):t<e&&t+f<o&&i>s?(t=e+5,h=r.offset().left-t+c):i<s&&(l=!1,v="rotate(180deg)",y="-10px",t<e?(t=e+5,h=r.offset().left-t+c):t+f>o&&(t=o-f-5,h=r.offset().left-t+c),p=u.prop("id")==this._id+"AppDetailsWindow"?r.height():this.model.orientation=="horizontal"?r.height()/2:r.height()-4,i=r.offset().top+10+p,(i<s||i>w-n("#"+u.prop("id")+"_wrapper").height())&&(i=s+4,l=!0,v="rotate(0deg)",y="4px")),l?a.removeClass("e-tablePosition"):a.addClass("e-tablePosition"),u.find(".e-quickarrow").css("transform",v).css("top",l?a.outerHeight()+1:0).css("left",h),u.css("top",y),{X:t,Y:i}},_cellSelection:function(r){var u,k,d,a,h,g,v,f,nt,s,rt,ut,w,b,ft,et,ot,st,c,e;if(r.shiftKey||(t.isNullOrUndefined(this.element.data("ejTooltip"))||this.element.ejTooltip("hide"),this.element.find("e.workcells,e.alldaycells,.e-monthcells,.e-agendacells").removeClass("e-mousehover"),this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),u=t.isNullOrUndefined(r.target)?n(r):n(r.target),u.hasClass("e-blocktimeappointment")||u.closest(".e-blocktimeappointment").length>0))return!1;if(t.isNullOrUndefined(this.model.workCellsTemplateId)&&t.isNullOrUndefined(this.model.allDayCellsTemplateId)||(u=u.hasClass("e-apptime")||u.hasClass("e-apptext")||u.hasClass("e-appointinnertext")||u.hasClass("e-schedulemouseclose")||u.hasClass("e-monthheader")?n(r.target):u.closest(".e-workcells, .e-alldaycells, .e-monthcells")),u.hasClass("e-appointwrapper")||u.hasClass("e-textwrapper")&&(u=n(u).parent()),t.isNullOrUndefined(r.type)||r.type!="beforeOpen"?this.element.find(".e-workcells,.e-alldaycells,.e-monthcells,.e-agendacells").removeClass("e-selectedCell"):(k=this.element.find("td.e-selectedCell"),k.length>0&&!u.hasClass("e-selectedCell")&&this.element.find(".e-workcells,.e-alldaycells,.e-monthcells,.e-agendacells").removeClass("e-selectedCell")),this.currentView()!="agenda"){if((u.hasClass("e-workcells")||u.hasClass("e-alldaycells")||u.hasClass("e-monthcells"))&&!u.hasClass("e-resourceheadercells")){if((this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close"),this._slotByElement(u,"cellClick"),this.model.minDate>this.curDate||this.model.maxDate<this.curDate)||(d=this._dayFullNames[new Date(this.curDate).getDay()]+", "+t.format(new Date(this.curDate),"MMMM")+" "+new Date(this.curDate).getDate()+", "+t.format(new Date(this.cur_StartTime),this._timeMode=="12"?this._pattern.t:"HH:mm")+" - "+t.format(new Date(this.cur_EndTime),this._timeMode=="12"?this._pattern.t:"HH:mm"),a={cellIndex:this._cellIndex,startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,target:r,resources:(this.model.cellClick!=null||!t.isNullOrUndefined(this.model.serverEvents)&&this.model.serverEvents.indexOf("cellClick")!=-1)&&this._tempResource.length!=0?this._getResourceValue(u):null,quickString:d},this._trigger("cellClick",a)))return!1;if(this.model.showQuickWindow){this._quickAppointWindow.find("#"+this._id+"_quickAppwindow").css("display","block");this._quickAppointWindow.find(".e-quickstartend").html(a.quickString);h=n(r).hasClass("e-workcells")||n(r).hasClass("e-alldaycells")||n(r).hasClass("e-monthcells")?n(r):n(r.target);r.type!="beforeOpen"&&!this.model.readOnly?this._quickAppointWindow.ejDialog("open"):"";this._quickAppointWindow.find(".subject").val("");var ht=h.offset().left-(this._quickAppointWindow.width()-h.width())/2+10,ct=h.offset().top-this._quickAppointWindow.height()-10,c=this._quickWindowPosition(ht,ct,h,this._quickAppointWindow);this._quickAppointWindow.ejDialog({position:{X:c.X,Y:c.Y}});t.scheduleFeatures.resources&&this._tempResource.length!=0&&this._getResourceDetails(u,this._cellIndex)}u.addClass("e-selectedCell").attr("tabIndex",0).focus();this._focused=n(":focus");this.model.showQuickWindow&&this._quickAppointWindow.find(".subject").focus();this._cellClick=!0;this._appointmentAddWindow.ejDialog({title:this._getLocalizedLabels("CreateAppointmentTitle")});this.model.orientation=="horizontal"&&this._grouping.length>0&&this.element.find(".e-resourceheadertable").offset().top!=this.element.find(".e-workcellstab").offset().top&&(g=this.element.find(".e-draggableworkarea").offset().top-this.element.find(".e-workcellstab").offset().top,this.element.find("#"+this._id+"_scroller").ejScroller({scrollTop:g}))}else if(!u.hasClass("e-resourceheadercells")&&!u.hasClass("e-appsoverflow")&&!u.hasClass("e-monthheader")&&!u.hasClass("e-categorybar")){if(this._cellClick=!1,this._quickAppDetailsWindow&&this._quickAppDetailsWindow.find("#"+this._id+"_quickAppDetailswindow").css("display","block"),this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close"),e=u.hasClass("e-appointment")||u.hasClass("e-monthappointment")||u.hasClass("e-alldayappointment")?u:u.parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),this._appUid=e.attr("guid"),u.hasClass("e-schedulemouseclose"))return!1;for(this._processed=this._sortAppById(this._processed),v=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),i=0;i<v.length;i++){f=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,v[i].Guid));break}for(i=0;i<f.length;i++)nt=this.element.find("[guid="+f[i].Guid+"]"),nt.addClass("e-selectedAppointment");this._mediaQuery&&(this._mAppId=this._appUid);var tt=this._sortAppById(f),l=tt[0][this._appointmentSettings.recurrence]?tt[0]:this._getAppointmentByParentId(this._appUid),y=(new Date).getTime()-l[this._appointmentSettings.startTime].getTime(),p=6e4,lt=60*p,at=24*lt,it=Math.abs(new Date-l[this._appointmentSettings.startTime]),o=Math.floor(it/36e5);if(o=o<=9?"0"+o:o,s=new Date(it).getUTCMinutes(),s=s<=9?"0"+s:s,rt=Math.ceil(y/p-1)<0&&o<24?this._getLocalizedLabels("EventBeginsin")+" "+o+" "+this._getLocalizedLabels("Hours")+" "+s+" "+this._getLocalizedLabels("Minutes"):Math.ceil(y/p-1)<0&&o>=24?this._getLocalizedLabels("EventBeginsin")+" "+Math.abs(Math.ceil(y/at))+" "+this._getLocalizedLabels("Days"):this._getLocalizedLabels("Overdue"),ut={appointment:f[0]},this._trigger("appointmentClick",ut))return n(".e-selectedAppointment").css({border:"none"}),!1;this.model.showQuickWindow&&(this._quickAppDetailsWindow&&this._quickAppDetailsWindow.find(".e-quicksubject").html(l[this._appointmentSettings.subject]).attr("title",l[this._appointmentSettings.subject]),w=this._timeMode=="12"?t.format(f[0][this._appointmentSettings.startTime],this._pattern.t):t.format(f[0][this._appointmentSettings.startTime],"HH:mm"),b=this._timeMode=="12"?t.format(f[f.length-1][this._appointmentSettings.endTime],this._pattern.t):t.format(f[f.length-1][this._appointmentSettings.endTime],"HH:mm"),this._quickAppDetailsWindow.find(".e-rightfields").html(rt),ft=Math.ceil((f[0][this._appointmentSettings.endTime]-f[0][this._appointmentSettings.startTime])/36e5)/24,et=f.length>1||this.model.orientation=="horizontal"&&this.currentView()=="month"&&ft>1||f[0][this._appointmentSettings.startTime].getDay()!=f[f.length-1][this._appointmentSettings.endTime].getDay()?this._dayFullNames[f[0][this._appointmentSettings.startTime].getDay()]+", "+t.format(f[0][this._appointmentSettings.startTime],"MMMM")+" "+f[0][this._appointmentSettings.startTime].getDate()+" - "+w+" to "+this._dayFullNames[f[f.length-1][this._appointmentSettings.endTime].getDay()]+", "+t.format(f[f.length-1][this._appointmentSettings.endTime],"MMMM")+" "+f[f.length-1][this._appointmentSettings.endTime].getDate()+" - "+b:this._dayFullNames[f[0][this._appointmentSettings.startTime].getDay()]+", "+t.format(f[0][this._appointmentSettings.startTime],"MMMM")+" "+f[0][this._appointmentSettings.startTime].getDate()+", "+w+" - "+b,this._quickAppDetailsWindow.find(".e-quickstartendtime").html(et),l[this._appointmentSettings.recurrence]==1?this._quickAppDetailsWindow.find(".e-editseries").removeClass("e-disable"):this._quickAppDetailsWindow.find(".e-editseries").addClass("e-disable"),r.type!="beforeOpen"?this._quickAppDetailsWindow.ejDialog("open"):"",this.model.readOnly?this._quickAppDetailsWindow.find(".e-scheduledelete").addClass("e-disable"):this._quickAppDetailsWindow.find(".e-scheduledelete").removeClass("e-disable"),ot=n(e).width()>this.element.width()?n(e).offset().left>this.element.offset().left?n(e).offset().left:this.element.find(".e-draggableworkarea").scrollLeft()>n(e).width()?this.element.offset().left:this.element.width()/2-4:n(e).offset().left-((this._quickAppDetailsWindow.width()-n(e).width())/2-4),st=n(e).offset().top-this._quickAppDetailsWindow.height()-10,c=this._quickWindowPosition(ot,st,e,this._quickAppDetailsWindow),this._quickAppDetailsWindow.ejDialog({position:{X:c.X,Y:c.Y}}),this._quickAppDetailsWindow.focus());this._appointmentAddWindow.ejDialog({title:this._getLocalizedLabels("Editevent")})}n(u).hasClass("e-monthcells")||this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")}else{if((this._cellIndex=0,this.cur_StartTime=new Date(new Date(this.currentDate()).setHours(0,0)),this.cur_EndTime=new Date(new Date(this.currentDate()).setHours(23,59)),n(u).parentsUntil(".e-agendacellstab tbody").find(".e-eventcolumn,.e-timecolumn").addClass("e-selectedCell").attr("tabIndex",0).focus(),e=u.hasClass("e-agendaappointment")?u:this.element.find(".e-selectedCell").parent().find(".e-agendaappointment"),this._appUid=e.attr("guid"),this._mediaQuery&&(this._mAppId=this._appUid),u.hasClass("e-editapp")||u.hasClass("e-deleteapp"))||(e=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),this._trigger("appointmentClick",{appointment:e[0]})))return!1;this._cellClick=!1}},_getDateByElement:function(n){this._cellIndex=this.model.timeScale.enable?n.hasClass("e-workcells")?n.index():n.hasClass("e-alldaycells")?n.index():this._isCustomMonthView()&&this._oneWeek?n.index():7-((parseInt(n.index()/7)+1)*7-n.index())+n.parent().index()*7:this.model.orientation=="vertical"&&this.currentView()=="month"||this.currentView()=="customview"&&this._dateRender.length>=7?7-((parseInt(n.index()/7)+1)*7-n.index())+n.parent().index()*7:n.index();this.model.orientation=="horizontal"&&(this._cellIndex=this.model.timeScale.enable?this.currentView()!=="month"&&!this._isCustomMonthView()?Math.floor(this._cellIndex/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))):this._cellIndex:n.index(),this._workCellIndex=n.parent().index());var t=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"||this.currentView()=="customview"&&this._dateRender.length<=7?this._resWorkWeek?this._dateRender:this.dateRender:this._dateRender;t=this.model.orientation=="horizontal"&&this.currentView()=="customview"&&this._dateRender.length<=7?this._dateRender:t;this.curDate=new Date(t[this._cellIndex])},_slotByElement:function(n,t){this._getDateByElement(n);var i=this.curDate;n.hasClass("e-workcells")&&this.model.timeScale.enable&&this.currentView()!=="month"&&!this._isCustomMonthView()?(this._calcCurrentTime(i,n,t),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!1})):t=="cellHover"?(this.cellHoverStartTime=new Date(new Date(i).setHours(0,0,0)),this.cellHoverEndTime=new Date(new Date(i).setHours(23,59,59))):(this.cur_StartTime=new Date(new Date(i).setHours(0,0,0)),this.cur_EndTime=new Date(new Date(i).setHours(23,59,59)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0}))},_calcCurrentTime:function(n,t,i){var r=this.model.orientation=="vertical"?this.model.startHour*60+t.parent().index()*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount):this.model.startHour*60+t.index()*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*this._cellIndex*(60/this.model.timeScale.majorSlot)*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount),u;r=r*6e4;this._timeScaleMin=this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount;this._timeScaleMin=this._timeScaleMin*6e4;i=="cellHover"?(this.cellHoverStartTime=new Date(n).setMilliseconds(r),u=parseInt(new Date(this.cellHoverStartTime).getHours())==new Date(new Date(n).setMinutes(this._timeScaleMin*this.model.timeScale.minorSlotCount*(this.model.endHour-this.model.startHour)-this.model.timeScale.minorSlotCount)).getHours()&&parseInt(new Date(this.cellHoverStartTime).getMinutes())==new Date(new Date(n).setMinutes(this._timeScaleMin*this.model.timeScale.minorSlotCount*(this.model.endHour-this.model.startHour)-this.model.timeScale.minorSlotCount)).getMinutes()?r+(this._timeScaleMin-1):new Date(this.cellHoverStartTime).getMilliseconds()+this._timeScaleMin,this.cellHoverEndTime=new Date(new Date(this.cellHoverStartTime).setMilliseconds(u)),this.cellHoverEndTime=new Date(this.cellHoverStartTime).getDay()<new Date(this.cellHoverEndTime).getDay()?new Date(new Date(this.cellHoverStartTime).setHours(23,59,59)):this.cellHoverEndTime):(this.cur_StartTime=new Date(n).setMilliseconds(r),u=parseInt(new Date(this.cur_StartTime).getHours())==new Date(new Date(n).setMinutes(this._timeScaleMin*this.model.timeScale.minorSlotCount*(this.model.endHour-this.model.startHour)-this.model.timeScale.minorSlotCount)).getHours()&&parseInt(new Date(this.cur_StartTime).getMinutes())==new Date(new Date(n).setMinutes(this._timeScaleMin*this.model.timeScale.minorSlotCount*(this.model.endHour-this.model.startHour)-this.model.timeScale.minorSlotCount)).getMinutes()?r+(this._timeScaleMin-1):new Date(this.cur_StartTime).getMilliseconds()+this._timeScaleMin,this.cur_EndTime=new Date(new Date(this.cur_StartTime).setMilliseconds(u)),this.cur_EndTime=new Date(this.cur_StartTime).getDay()<new Date(this.cur_EndTime).getDay()?new Date(new Date(this.cur_StartTime).setHours(23,59,59)):this.cur_EndTime)},_checkReminders:function(){var n,t;for(this._todayAppointments=[],n=0;n<this._processed.length;n++)new Date(new Date(this._processed[n][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()>=new Date((new Date).setHours(0,0,0,0)).getTime()&&this._todayAppointments.push(this._processed[n]);t=this;jQuery.each(this._todayAppointments,function(n,i){var r=t.model.reminderSettings.alertBefore,e=i[t._appointmentSettings.startTime],u,f;r!=-1&&r!=null&&(u=(new Date).getTime(),f=(u-new Date(e).getTime())/6e4,Math.round(f)==r*-1&&t._trigger("reminder",{reminderAppointment:i}))})},_showContextMenu:function(i){var e=!1,o=!1,s=this.model.contextMenuSettings.menuItems.cells,f,h,c,l,r,u,a;if(i){if(this._contextMenu=t.buildTag("ul#"+this._id+"contextMenu"),this.element.append(this._contextMenu),this._contextMenu.ejMenu({fields:{id:"id",text:"text",parentId:"parentId"},menuType:t.MenuType.ContextMenu,openOnClick:!1,contextMenuTarget:"#"+this._id,width:"auto",click:n.proxy(this._onMenuSelect,this),beforeOpen:n.proxy(this._beforeopen,this)}),this.model.categorizeSettings.enable&&this.model.contextMenuSettings.menuItems.appointment){for(f=this.model.contextMenuSettings.menuItems.appointment,h=this.model.categorizeSettings.dataSource.length,r=0;r<f.length;r++)if(f[r].id=="categorize"){c=r;o=!0;break}if(o)for(l=new t.DataManager(this.model.contextMenuSettings.menuItems.appointment).executeLocal((new t.Query).where("parentId",t.FilterOperators.equal,"categorize")),new t.DataManager(this.model.contextMenuSettings.menuItems.appointment).saveChanges({added:[],changed:[],deleted:l},"parentId"),r=0;r<h;r++)u=this.model.categorizeSettings,this.model.contextMenuSettings.menuItems.appointment.push({text:u.dataSource[r][u.text],id:"categorize_"+u.dataSource[r][u.id],fontColor:u.dataSource[r][u.fontColor],color:u.dataSource[r][u.color],parentId:this.model.contextMenuSettings.menuItems.appointment[c].id.toString()})}if(this._gotoDate&&this.model.contextMenuSettings.enable){for(a in s)if(s[a].id=="gotodate"){e=!0;break}e&&(this._renderGotoWindow(),this._gotoDate=!1)}}},_beforeopen:function(i){var f,v,y,p,a,e,u,w,h;if(this.model.contextMenuSettings.enable){n(document).off(t.eventType.mouseMove);var r=n(i.target),c,o=null,s,l=n(r).parents(".e-draggableworkarea tr").length>0&&n(r).parentsUntil(".e-draggableworkarea tr").is(".e-agendaappointment,.e-eventcolumn,.e-timecolumn")||n(r).is(".e-agendaappointment,.e-eventcolumn,.e-timecolumn");if(r.hasClass("e-appointment")||r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells")||t.isNullOrUndefined(this.model.appointmentTemplateId)||(r=n(i.target).offsetParent()),i.cancel=r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment")||r.hasClass("e-appointment")||r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-appointinnertext")||r.hasClass("e-monthcells")||r.hasClass("e-apptime")||r.hasClass("e-apptext")||l?!1:!0,i.cancel==!0)return h=this._contextMenu.data("ejMenu"),h.hide(),!1;if(this.currentView()=="agenda"&&l&&(i=n(r).hasClass("e-agendaappointment")?i:n(r).parents(".e-draggableworkarea tr").find(".e-agendaappointment")),this._cellSelection(i),(r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells"))&&(s={currentDate:this.curDate,cellIndex:this._cellIndex,events:i,resources:!t.isNullOrUndefined(this.model.beforeContextMenuOpen)&&this._tempResource.length!=0?this._getResourceValue(r,this._cellIndex):null}),(r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment")||r.hasClass("e-appointinnertext")||r.hasClass("e-apptime")||r.hasClass("e-apptext")||r.hasClass("e-appointment"))&&(o=this._getAppDetails(i),s={appointment:o,events:i}),this.currentView()=="agenda"&&(o=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],s={appointment:o,events:i}),this._baseTarget=r,this._trigger("beforeContextMenuOpen",s))return!1;if(f=this._contextMenu.data("ejMenu"),c=r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment")||r.hasClass("e-appointment")||r.hasClass("e-appointinnertext")||r.hasClass("e-apptime")||r.hasClass("e-apptext")||l?!1:!0,c?f.option("fields.dataSource",this.model.contextMenuSettings.menuItems.cells):f.option("fields.dataSource",this.model.contextMenuSettings.menuItems.appointment),this.model.readOnly?(f.disableItemByID("new"),f.disableItemByID("recurrence"),f.disableItemByID("delete"),f.disableItemByID("categorize")):(f.enableItemByID("new"),f.enableItemByID("recurrence"),f.enableItemByID("delete"),f.enableItemByID("categorize")),v=this.element.find("td.e-selectedCell"),v.length>1&&this.currentView()!="agenda"&&this._multipleCellAppointCreation(i),this._target=i,this.model.showQuickWindow&&(this._quickAppointWindow.ejDialog("close"),this._quickAppDetailsWindow.ejDialog("close")),this.model.categorizeSettings.enable&&c==!1){if(y=this._contextMenu.find("li#categorize").find("li").children(),y.find("div").length==0)for(u=0;u<this.model.categorizeSettings.dataSource.length;u++)this._contextMenu.find("li#categorize").find("li#categorize_"+this.model.categorizeSettings.dataSource[u][this.model.categorizeSettings.id]).children().append('<div><div style="border: 1px solid black;height: 12px;margin-left: 2px;margin-top: 2px;width: 12px;background-color:'+this.model.categorizeSettings.dataSource[u][this.model.categorizeSettings.color]+'"><\/div><\/div>');for(u=1;u<=this.model.categorizeSettings.dataSource.length;u++)this._contextMenu.find("li#categorize").find("li#categorize_"+u).children().find("div:first-child.e-categorizeMenuSelected")&&this._contextMenu.find("li#categorize").find("li#categorize_"+u).children().find("div:first-child").removeClass("e-categorizeMenuSelected");if(p=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),a=t.DataManager(this._processed).executeLocal(p),a[0][this._appointmentSettings.categorize])if(e=a[0][this._appointmentSettings.categorize].split(","),this.model.categorizeSettings.allowMultiple){if(e[0].length>0)for(u=0;u<e.length;u++)this._contextMenu.find("li#categorize").find("li#categorize_"+e[u]).children().find("div:first-child").addClass("e-categorizeMenuSelected")}else e[0].length>0&&(w=e.length-1,this._contextMenu.find("li#categorize").find("li#categorize_"+e[w]).children().find("div:first-child").addClass("e-categorizeMenuSelected"))}else this._contextMenu.find("li#categorize")&&this._contextMenu.find("li#categorize").css("display","none")}else return h=this._contextMenu.data("ejMenu"),h.hide(),!1},_onMenuSelect:function(i){var s=i.events.ID.split("_"),f="",h=this._baseTarget,y=this,p,c,w,a,o,e,r,b,u,l,v;if(n(h).is(".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment")||h.parents(".e-appointment").hasClass("e-appointment")||h.parents(".e-monthappointment").hasClass("e-monthappointment")||h.parents(".e-alldayappointment").hasClass("e-alldayappointment")||this.currentView()=="agenda"&&this.element.find(".e-selectedCell").parent().find(".e-agendaappointment")?(p=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),c=t.DataManager(this._processed).executeLocal(p),f=c[0][this._appointmentSettings.recurrence]==1&&c[0][this._appointmentSettings.recurrenceRule].indexOf("RECUREDITID")!=-1?c[0]:this._getAppointmentByParentId(this._appUid)):f={startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,resourceInfo:this._getResourceDetails(h)},this._trigger("menuItemClick",{events:i,targetInfo:f}))return!1;w=f[this._appointmentSettings.categorize];switch(s[0]){case"new":this._appointmentWindow(this._target);break;case"recurrence":this._appointmentWindow(this._target);this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0});this._repeat(i={isChecked:!0,isInteraction:!0});break;case"open":this._appointmentWindow(this._target);break;case"today":this._navigateClick(this.currentDate(new Date),"DateNavigation");break;case"view":t.isNullOrUndefined(s[1])||(a=s[1].toLowerCase(),this._navView=!0,this.currentView()!=a&&this._viewChange(null,this.currentView(),a));break;case"timemode":t.isNullOrUndefined(s[1])||(this.model.timeMode=this._timeMode=s[1]=="Hour12"?"12":"24",this._updateTimeMode());break;case"businesshours":case"workhours":this.model.workHours.highlight=this.model.workHours.highlight?!1:!0;this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells")&&this.element.find(".e-monthcells").removeClass("e-monthcellhighlight");break;case"gotodate":this._gotoWindow.ejDialog("open");break;case"delete":this._deleteAppoint();break;case"print":this._printAppointment(this._appUid);break;case"categorize":if(t.isNullOrUndefined(s[1]))this.element.find(".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment").removeClass("e-selectedAppointment");else if(this.model.categorizeSettings.enable){if(o=s[1],e="",f[this._appointmentSettings.categorize])if(r=f[this._appointmentSettings.categorize].split(","),this.model.categorizeSettings.allowMultiple){if(r[0].length>0){for(u=0;u<r.length;u++)if(r[u]==o){b=!0;break}if(b==!0)for(u=0;u<r.length;u++)r[r.length-1]!=o?r[u]!=o&&(e=r.length-1!=u?e+r[u]+",":e+r[u]):r[u]!=o&&(e=r.length-2!=u?e+r[u]+",":e+r[u]);else e=f[this._appointmentSettings.categorize]+","+o}}else e=r[r.length-1]==o?"":o.toString();else e=o.toString();if(f[this._appointmentSettings.categorize]=e,!t.isNullOrUndefined(s[1])&&this._trigger("beforeAppointmentChange",{appointment:f}))return f[this._appointmentSettings.categorize]=w,!1;l=this._timeZoneAppointments(f,"");v=this.dataSource()instanceof t.DataManager?this._dataManager.update(this._appointmentSettings.id,l,this.model.appointmentSettings.query._fromTable):this._dataManager.update("AppTaskId",l);new t.DataManager(this._currentAppointmentData).update("AppTaskId",this._timeZoneAppointments(l,"reverse"));n.isFunction(v.promise)&&this.dataSource()instanceof t.DataManager?v.done(function(n){y._processUrlBinding(n);y._trigger("appointmentChanged",{appointment:f})}):(this._renderSingleApp(),this._trigger("appointmentChanged",{appointment:f}));break}}},_updateTimeMode:function(){var r=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)&&!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplateId)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplateId)?!0:!1,u=t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)?!1:!0,n=this._timeSlotCount(r,u),i,f,e,h,o,s;this._appointmentAddWindow.find(".startendtime").ejTimePicker({timeFormat:this._timeMode=="12"?this._pattern.t:"HH:mm"});this.model.orientation!="horizontal"||this.currentView()==="month"||this._isCustomMonthView()||this.currentView()==="agenda"?this.currentView()==="month"||this._isCustomMonthView()||this.currentView()==="agenda"||(o=this.currentView()=="month"?1:0,(r||u)&&this.currentView()!=="month"&&!this._isCustomMonthView()?(n.columnCount.pop(),s=this.userTimeCellTemplate.render({timerows:n.strTime,cols1:n.columnCount,viewclass:o,timeScale:this.model.timeScale.minorSlotCount,cheight:this.model.cellHeight,userTemplateId:r,timeValue1:n.timeValue1,template:u})):s=this.timeCellTemplate.render({timerows:n.strTime,cols1:n.columnCount,viewclass:o,timeScale:this.model.timeScale.minorSlotCount,userTemplateId:r,template:u}),this.$TimeCellTD.children().remove(),this.$TimeCellTD.append(s),this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove(),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px"),this.element.find(".e-headercells").addClass("e-dateheaderselect"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator)):(i=this.model.timeScale.enable?this._isCustomMonthView()?"month":this.currentView():"month",f=i=="day"?1:i=="week"?7:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:5,this.datesColumn=this._getHeaderAllDayCellsCount(),e=this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)?!0:!1,h=r||u?this.userTimeCellHoriTemplate.render({cols:this.datesColumn,label:this._getLocalizedLabels("Resources"),multiRes:e,view:i,timeTdCount:n.strTime,colspan:i=="month"?1:n.strTime.length/f*2,height:i=="month"?62:59,width:this.model.width,headercellWidth:i=="day"?"100%":"55px",column:n.columnCount,userTemplateId:r,template:u}):this.horizontalHeader.render({cols:this.datesColumn,label:this._getLocalizedLabels("Resources"),multiRes:e,view:i,timeTdCount:n.strTime,colspan:i=="month"?1:n.strTime.length/f*2,height:i=="month"?62:59,width:this.model.width,headercellWidth:i=="day"?"100%":"55px",column:n.columnCount}),this.aTR.children().remove(),this.aTR.append(h),this._borderAddRemove(),this._moveScroller(),this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"),this.element.find(".e-headercells").addClass("e-dateheaderselect"),this._businessHourScroller());t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll()},_gotoOk:function(t){var u,f,i,r;if(n(t.currentTarget).hasClass("e-gotoOk")){if(u=this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker("option","value"),f=this._gotoWindow.find("#"+this._id+"show").ejDropDownList("option","itemValue"),data={currentView:this.currentView(),currentDate:new Date(this.currentDate()),target:t},this._trigger("actionBegin",{data:data,requestType:"dateNavigate"}))return!1;if(i=this.currentDate(),r=this.currentView(),this.currentDate(new Date(u)),this.currentView(f.toLowerCase()),data={previousDate:i,currentDate:this.currentDate(),previousView:r,currentView:this.currentView(),target:t,requestType:"dateNavigate"},this._trigger("navigation",data))return this.currentDate(new Date(i)),this.currentView(r),this._navView=!1,!1;this._renderCurrentView("ViewChange");this._trigger("actionComplete",{data:data,requestType:"dateNavigate"})}this._gotoCancel()},_gotoCancel:function(){this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker({value:this.currentDate()});this._gotoWindow.find("#"+this._id+"show").ejDropDownList({value:this.currentView()});this._gotoWindow.ejDialog("close")},_renderGoto:function(){var n,t;for(this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker({buttonText:this._getLocalizedLabels("Today"),enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,cssClass:this.model.cssClass,minDate:this.model.minDate,maxDate:this.model.maxDate}),n=[],t=0;t<this.model.views.length;t++)switch(this.model.views[t]){case"day":n.push({text:this._getLocalizedLabels("Day"),value:"day"});break;case"week":n.push({text:this._getLocalizedLabels("Week"),value:"week"});break;case"workweek":n.push({text:this._getLocalizedLabels("WorkWeek"),value:"workweek"});break;case"month":n.push({text:this._getLocalizedLabels("Month"),value:"month"});break;case"customview":n.push({text:this._getLocalizedLabels("CustomView"),value:"customview"});break;case"agenda":n.push({text:this._getLocalizedLabels("Agenda"),value:"agenda"})}this._gotoWindow.find("#"+this._id+"show").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:n,width:"100%",selectedItemIndex:0,cssClass:this.model.cssClass});this._gotoWindow.find(".e-gotobutton").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"60px",cssClass:this.model.cssClass})},_renderGotoWindow:function(){this._gotoWindow=t.buildTag("div.e-gotodialog#"+this._id+"gotoWindow");var i="<div><table width='100%' cellpadding='5'><tbody><tr><td>"+this._getLocalizedLabels("Date")+":<\/td><td><input id='"+this._id+"gotodate' type='text' value='' /><\/td><\/tr><tr><td>"+this._getLocalizedLabels("Showin")+":<\/td><td><input type='text' id='"+this._id+"show' /><\/td><\/tr><\/tbody><\/table>";i+="<div class='e-floatright'><table><tr><td><div><button id='"+this._id+"gotook' type='button' class='e-gotobutton e-gotoOk'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div><button id='"+this._id+"gotocancel' type='button' class='e-gotobutton e-gotoCancel'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div><\/div>";this._on(this._gotoWindow,"click",".e-gotobutton",n.proxy(this._gotoOk,this));this._gotoWindow.append(i);this.element.append(this._gotoWindow);this._renderGoto();this._gotoWindow.ejDialog({width:300,cssClass:this.model.cssClass,showOnInit:!1,enableRTL:this.model.enableRTL,enableModal:!0,title:this._getLocalizedLabels("Gotodate"),target:"#"+this._id,enableResize:!1,allowKeyboardNavigation:!1,close:n.proxy(this._gotoCancel,this)});n("#"+this._id+"gotoWindow_wrapper").appendTo("body").addClass("e-scheduledialog").find(".e-titlebar").addClass("e-dialogheader")},_highlightCurrentTime:function(i){var e,f,h,o,s,u;if(t.preferredCulture(this.model.locale),i&&this.model.timeScale.enable){for(e=!1,f=0,u=0;u<this._dateRender.length;u++)if(new Date(new Date(this._dateRender[u]).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()){e=!0;f=u;break}if(h=this.element.find(".e-workcellstab tr").first().find("td"),this.currentView()==="month"||this._isCustomMonthView())if(e)if(this.model.orientation=="vertical")for(o=Math.floor(f/7),s=Math.abs(f-o*7),this.model.group||(this.res1=["0"]),u=0;u<this.res1.length;u++)n(n(this.element.find(".e-workcellstab tr")[o]).children()[Math.floor(s)]).hasClass("e-othermonths")||n(n(this.element.find(".e-workcellstab tr")[o]).children()[Math.floor(s)]).addClass("e-currentdayhighlight"),s+=7;else this._renderHorizontalCurrentTime();else this.model.orientation=="vertical"?this.element.find(".e-monthcells").removeClass("e-currentdayhighlight"):this.element.find(".e-workcells").removeClass("e-currentdayhighlight");else if(e){var r=this,c=this.currentView()==="week"?7:this.currentView()==="workweek"?this.model.workWeek.length:this.currentView()=="customview"?this._dateRender.length:1,l=this.model.cellWidth?parseInt(this.model.cellWidth):this.element.find(".e-draggableworkarea")[0].offsetWidth/(c*this.res1.length);if((new Date).getHours()>=r.model.startHour&&(new Date).getHours()<=r.model.endHour)if(r.model.orientation=="vertical")for(u=0;u<this.res1.length;u++)this.element.find(".e-draggableworkarea").append('<div id="'+this._id+u+'_HighlightCurrentTimeline" class="e-highlightcurrenttimeline"><\/div>'),n("#"+this._id+u+"_HighlightCurrentTimeline").append('<div class="e-currenttime"><\/div>').append(t.buildTag("div.e-icon e-circle_01 e-timeidicatorcircle e-lefttimeindicator")).append(t.buildTag("div.e-icon e-circle_01 e-timeidicatorcircle e-righttimeindicator")).css("width",l+"px").css("left",h[f+c*u].offsetLeft+"px").find(".e-righttimeindicator").css("margin-left",l-3+"px");else this._renderHorizontalCurrentTime();function a(){var h=r.element.find(".e-workcellstab tr").first().find("td"),f,u,e,o,s,i;if(r.element.find(".e-currentdayhighlight").removeClass("e-currentdayhighlight"),f=r.currentView()==="week"?7:r.currentView()==="workweek"?r.model.workWeek.length:r.currentView()=="customview"?r._dateRender.length:1,u=new Date,u.setMinutes(u.getMinutes()),e=r._dateRender.indexOf(new Date(u).setHours(0,0,0,0)),u.getHours()>=r.model.startHour&&u.getHours()<=r.model.endHour)if(r.model.orientation=="vertical"){for(o=((u.getHours()-r.model.startHour)*60+u.getMinutes())*(r.element.find(".e-workcells").height()+1)*r.model.timeScale.minorSlotCount/r.model.timeScale.majorSlot,i=0;i<r.res1.length;i++)r.element.find("#"+r._id+i+"_HighlightCurrentTimeline").css("top",o-1),r.element.find("#"+r._id+i+"_HighlightCurrentTimeline").css("left",h[e+f*i].offsetLeft),n(r.element.find(".e-dateheader").children()[e+f*i]).addClass("e-currentdayhighlight");for(s=r._timeMode=="12"?t.format(new Date,"hh:mm tt"):t.format(new Date,"HH:mm"),i=0;i<r.res1.length;i++)r.element.find("#"+r._id+i+"_HighlightCurrentTimeline").find(".e-currenttime").html(s),r._timeMode=="12"&&r.element.find("#"+r._id+i+"_HighlightCurrentTimeline").find(".e-currenttime").addClass("e-timewidth")}else r._horizontalTimePosition(r,u)}a();t.isNullOrUndefined(this._intervalID)&&(this._intervalID=window.setInterval(a,6e4))}else window.clearInterval(this._intervalID),this._intervalID=null,this.element.find(".e-highlightcurrenttimeline").remove()}},_filter:function(){var r=[],i=[],t;for(this._filt=!0,this._dataProcessing(this._currentAppointmentData),i=n.extend(!0,[],this._processed),this._filt=!1,t=0;t<i.length;t++)new Date(i[t][this._appointmentSettings.endTime])>=this.model.minDate&&new Date(i[t][this._appointmentSettings.endTime])<=this.model.maxDate&&r.push(i[t]);return r},_getPreviousNextAppointment:function(){var i=(this.model.orientation=="horizontal"||!this.model.showNextPrevMonth)&&this.currentView()=="month"?this.monthDays:this._dateRender,t=this._filter(),n,r;if(this._previousList=[],this._nextList=[],this.appointment,this.currentView()!="workweek")for(n=0;n<t.length;n++)new Date(t[n][this._appointmentSettings.startTime])<new Date(i[0])&&new Date(t[n][this._appointmentSettings.endTime])<new Date(i[0])?this._previousList.push(t[n]):new Date(t[n][this._appointmentSettings.startTime])>new Date(i[i.length-1])&&new Date(t[n][this._appointmentSettings.endTime])>new Date(i[i.length-1])&&this._nextList.push(t[n]);else for(n=0;n<t.length;n++)for(r=0;r<i.length;r++)new Date(t[n][this._appointmentSettings.startTime]).getDay()==new Date(i[r]).getDay()&&(new Date(t[n][this._appointmentSettings.startTime])<new Date(i[0])&&new Date(t[n][this._appointmentSettings.endTime])<new Date(i[0])?this._previousList.push(t[n]):new Date(t[n][this._appointmentSettings.startTime])>new Date(i[i.length-1])&&new Date(t[n][this._appointmentSettings.endTime])>new Date(i[i.length-1])&&this._nextList.push(t[n]));this.appointment={previous:this._previousList,next:this._nextList}},_nextPrevAppointment:function(n){var i,f,r;if(n&&!(this._browserInfo.name==="msie"&&this._browserInfo.version<9)){i=this.element.find("#"+this._id+"_scroller");this.height=i.height();this.width=i.width();f=i.ejScroller("instance").isVScroll()?this.element.find("#"+this._id+"_scroller").find(".e-vscroll").width():0;r=this.element.find(".e-scrolltimecells").width();r=t.isNullOrUndefined(r)?this.model.orientation=="vertical"?56:0:r;var u=this.height/2-75,e,o=t.buildTag("div.e-prevapp enable",this._getLocalizedLabels("PreviousAppointment"),{},{}),s=t.buildTag("div.e-nextapp enable",this._getLocalizedLabels("NextAppointment"),{},{});e=this.model.timeScale.enable&&this.currentView()!="agenda"?this.model.orientation=="vertical"?this.currentView()!="month"&&!this._isCustomMonthView()?-4:-10:-61:-61;this.width=this.model.timeScale.enable&&this.currentView()!="agenda"?this.width:this.width-r;this.model.enableRTL?(o.css("top",u+40+"px").css("transform","rotate(-90deg)").css("right",e+"px"),s.css("top",u+40+"px").css("transform","rotate(90deg)").css("right",this.width-f-(this.model.orientation=="vertical"&&(this.currentView()=="month"||this._isCustomMonthView())?41:this.model.orientation=="vertical"?35:90)+"px")):(o.css("top",u+40+"px").css("transform","rotate(90deg)").css("left",e+"px"),s.css("top",u+40+"px").css("transform","rotate(-90deg)").css("left",this.width-f-(this.model.orientation=="vertical"&&(this.currentView()=="month"||this._isCustomMonthView())?41:this.model.orientation=="vertical"?35:90)+"px"));i.append(o).append(s)}},_nextPrev:function(i){var r=this;n(i.currentTarget).hasClass("e-prevapp")?t.isNullOrUndefined(this.appointment)||(this.appointment.previous.sort(function(n,t){return new Date(t[r._appointmentSettings.startTime])-new Date(n[r._appointmentSettings.startTime])}),this.currentView()=="customview"&&(this._daterend=this.appointment.previous[0][this._appointmentSettings.startTime]),this._navigateClick(this.currentDate(new Date(this.appointment.previous[0][this._appointmentSettings.startTime])),"Previous")):n(i.currentTarget).hasClass("e-nextapp")&&(t.isNullOrUndefined(this.appointment)||(this.appointment.next.sort(function(n,t){return new Date(n[r._appointmentSettings.startTime])-new Date(t[r._appointmentSettings.startTime])}),this.currentView()=="customview"&&(this._daterend=this.appointment.next[0][this._appointmentSettings.startTime]),this._navigateClick(this.currentDate(new Date(this.appointment.next[0][this._appointmentSettings.startTime])),"Next")))},_nextPrevButton:function(n){n.length!=0?this.element.find(".e-prevapp,.e-nextapp").css("display","none"):(this.currentView()=="agenda"&&this._refreshAppNavigation(),this._getPreviousNextAppointment(),this.element.find(".e-prevapp,.e-nextapp").css("display","block"),this.appointment.previous.length==0?this.element.find(".e-prevapp").removeClass("enable").css("opacity","0.4"):this.element.find(".e-prevapp").addClass("enable").css("opacity","1"),this.appointment.next.length==0?this.element.find(".e-nextapp").removeClass("enable").css("opacity","0.4"):this.element.find(".e-nextapp").addClass("enable").css("opacity","1"))},_navigateView:function(i){var e,u,o,f,c=this.currentView(),r=n(i.target),s,h;if(this.currentView()=="agenda")return!1;if(this.model.orientation=="vertical"){if(this.currentView()==="month"||this._isCustomMonthView()){if(r.hasClass("e-monthheader")){if(this.model.views.toString().toLowerCase().split(",").indexOf("day")==-1)return!1;if(f=r.parent().index(),o=f>6?f%7:f,u=new Date(this._dateRender[r.parent().parent().index()*7+o]),this.model.minDate<=u&&this.model.maxDate>=u)this.currentDate(u);else return!1;e="day"}else if(r.hasClass("e-timecells")||r.hasClass("e-timecelldivs")){if(r=r.hasClass("e-timecells")?r:r.parent(),this.model.views.toString().toLowerCase().split(",").indexOf("week")==-1)return!1;if(u=new Date(this._dateRender[r.parent().index()*7]),this.model.minDate<=u&&this.model.maxDate>=u)this.currentDate(u);else return!1;e="week"}}else if(this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7){if(s=r.hasClass("e-headercells")?r:r.parent().hasClass("e-headercells")?r.parent():r.closest(".e-headercells"),this.model.views.toString().toLowerCase().split(",").indexOf("day")==-1||!s.hasClass("e-headercells"))return!1;if(f=s.index(),h=this.currentView()==="workweek"?this.model.workWeek.length:this.currentView()==="customview"?this._dateRender.length:7,o=f>h-1?f%h:f,u=new Date(this._dateRender[o]),this.model.minDate<=u&&this.model.maxDate>=u)this.currentDate(new Date(u));else return!1;e="day"}this._navView=!0;c=="day"||t.isNullOrUndefined(e)||(this._viewChange(i,c,e),this._businessHourScroller())}else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._horizontalViewNavigation(i)},_appOverflowClick:function(i){var r;if(this.model.views.toString().toLowerCase().split(",").indexOf("day")!==-1){if(this._trigger("overflowButtonClick",{event:i,Datas:this._overflowApp}))return!1;t.isNullOrUndefined(this.element.data("ejTooltip"))||this.element.ejTooltip("hide");this.model.orientation=="vertical"?(r=n(i.target).closest(".e-monthcells,.e-workcells").parent().index()*7+n(i.target).closest(".e-monthcells,.e-workcells").index()%7,this.currentDate(new Date(this._dateRender[r]))):(r=parseInt(n(i.target).attr("id").split("_")[n(i.target).attr("id").split("_").length-1]),this.currentDate(this.currentView()=="month"||this._isCustomMonthView()?new Date(this.monthDays[r]):new Date(parseInt(n(i.target).attr("cellinfo")))));this._navView=!0;this._viewChange(i,this.currentView(),"day")}else return!1},_viewCalendar:function(){var u=this.element.find("#"+this._id+"_navigator").data("ejDatePicker"),i,t,r;u&&(u.show(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}),i=this.element.offset(),this.model.enableRTL?(t=i.left+this.element.width()-280,t<0&&(t=0)):(t=i.left+55,r=n(document).scrollLeft()+n(window).width(),r-t<n("#e-"+this._id+"_navigator").width()&&(t=r-n("#e-"+this._id+"_navigator").width())),n("#e-"+this._id+"_navigator").css("top",i.top+47+"px").css("left",t+"px"));this.element.find(".e-workcells").removeClass("e-selectedCell");this.element.find(".e-workcells").removeClass("e-mousehover");this.element.find(".e-appointment,.e-alldayappointment,.e-monthappointment").removeClass("e-selectedAppointment")},_viewChange:function(i,r,u){this._viewchange=!0;this._renderedApp=[];u=t.isNullOrUndefined(u)?i.currentTarget.className.split("e-")[2].split(" ")[0]:u;var e=!0,f;if(f={currentView:this.currentView(),currentDate:new Date(this.currentDate()),target:i},this._trigger("actionBegin",{data:f,requestType:"viewNavigate"}))return!1;if(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),r!==u||!r&&!u){if(r=this.currentView(),this._navView?this.currentView(u):(e=this.currentView()==i.currentTarget.className.split("e-")[2].split(" ")[0]?!1:!0,this.currentView(n(i.currentTarget).hasClass("e-activeview")?this.currentView():i.currentTarget.className.split("e-")[2].split(" ")[0])),f={previousView:r,currentView:this.currentView(),currentDate:new Date(this.currentDate()),target:i,requestType:"viewNavigate"},this._trigger("navigation",f))return this.currentView(r),this._navView=!1,!1;e&&this._renderCurrentView("ViewChange")}f={previousView:r,currentView:this.currentView(),currentDate:new Date(this.currentDate()),target:i,requestType:"viewNavigate"};this._mediaQuery&&r!=this.currentView()&&this.element.find(".e-workareadiv,.e-navigate").addClass("navigate");this._trigger("actionComplete",{data:f,requestType:"viewNavigate"})},_renderCurrentView:function(n){t.isNullOrUndefined(this.element.data("ejTooltip"))||this.element.ejTooltip("hide");this._resWorkWeek=this.model.orientation=="vertical"&&this.currentView()=="workweek"&&this._tempResource.length!=0&&!t.isNullOrUndefined(this._tempResource[this._tempResource.length-1].resourceSettings.workWeek);this.element.find(".e-commonviewbutton").blur().removeClass("e-activeview");this.model.orientation=="vertical"&&this.element.find(".e-headerdaydisplay,.e-datedisplay,.e-headrealldaytable").children().remove();this.wTR.children().remove();this.aTR.children().remove();this._calculateCustomDays()._getRenderDates();this.element.find(".e-commonviewbutton.e-"+this.currentView()).addClass("e-activeview").attr("tabIndex",0).focus();t.isNullOrUndefined(this._scheduleDrawer)||this._navSelected||this._scheduleDrawer.ejNavigationDrawer({listViewSettings:{selectedItemIndex:this.model.views.toString().toLowerCase().split(",").indexOf(this.currentView())+1}});this._renderHeaderAllDayTemplate();this._renderContentAreaTemplate();this.currentView()=="agenda"&&this.model.showHeaderBar&&(this.element.find("div.e-datedisplay")[0].innerHTML=this._getCurrentDateHeaderValue());this._renderCommon("current");t.isNullOrUndefined(this.dataSource())||(this.model.enableLoadOnDemand?this._bindAppointmentsData(n):(this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll()),this._app.length<1&&this.model.showAppointmentNavigator&&this._nextPrevButton(this._app));this._renderBlockAppointments();this._navView=!1},_renderHeaderDays:function(){var e,u,h,f,c,r,o,i,s;if(this.dateRender=[],e=this._getRenderDates(),this.res1=t.isNullOrUndefined(this.model.group)?[0]:this.res1,!this._resWorkWeek)for(i=0;i<this.res1.length;i++)for(u=0;u<e.length;u++)this.dateRender.push(new Date(e[u]));if(this.model.showHeaderBar&&(h=this._getCurrentDateHeaderValue(),this.element.find("div.e-datedisplay")[0].innerHTML=h),this.currentDate()<this.model.minDate&&this.currentDate(this.model.minDate),this.currentDate()>this.model.maxDate&&this.currentDate(this.model.maxDate),this.model.orientation=="vertical")if(this.element.find(".e-currentdayhighlight").removeClass("e-currentdayhighlight"),this.currentView()==="month"||this._isCustomMonthView())this._renderMonthTimeCells();else{if(t.isNullOrUndefined(this.model.dateHeaderTemplateId))for(i=0;i<this.dateRender.length;i++)f=this.currentView()==="day"?this._tempResource.length==0&&t.isNullOrUndefined(this.model.group)?this._dayFullNames[new Date(this.dateRender[i]).getDay()]:this._dayShortNames[new Date(this.dateRender[i]).getDay()]:this._dayShortNames[new Date(this.dateRender[i]).getDay()],c=this.currentView()==="day"?this._tempResource.length==0&&t.isNullOrUndefined(this.model.group)?f+" "+t.format(new Date(this.dateRender[i]),"dd MMMM yyyy"):f+" "+t.format(new Date(this.dateRender[i]),"dd MMM yy"):f+" "+new Date(this.dateRender[i]).getDate(),this.element.find(".e-headerdaydisplay")[i].innerHTML=c,new Date(new Date(this.dateRender[i]).setHours(0,0,0,0)).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()&&n(this.element.find("td.e-headercells")[i]).addClass("e-currentdayhighlight");else{if(r=[],o=this._getUserDateheaderTemplate(),this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources)for(i=0;i<this.res1.length;i++)r=n.merge(r,o);else r=n.merge(r,o);for(i=0;i<this.dateRender.length;i++)this.element.find(".e-headerdaydisplay")[i].innerHTML=r[i].currentDay,new Date(new Date(this.dateRender[i]).setHours(0,0,0,0)).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()&&n(this.element.find("td.e-headercells")[i]).addClass("e-currentdayhighlight")}if(this._mediaQuery?(this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd").attr("style","height:40px !important"),this.model.enableRTL?this.element.find(".e-alldaycells").first().css("border-right","none"):this.element.find(".e-alldaycells").first().css("border-left","none")):this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd").css("height","27px"),!t.isNullOrUndefined(this.model.allDayCellsTemplateId)&&this.model.timeScale.enable){for(s=this._getUserAllDayCellsTemplate(),a=0;a<s.length;a++)this.element.find(".e-alldaycells")[a].innerHTML=s[a];this.element.find(".e-leftindent, .e-emptyalldaytd").height(this.element.find(".e-alldaycells").height())}this.element.find(".e-headercells").addClass("e-dateheaderselect")}else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._renderHorizontalHeaderDays(this._culture)},_renderMonthTimeCells:function(){var o=0,u=this._dateRender,e=0,f=t.isNullOrUndefined(this.model.group)?7:this.res1.length*7,s=this._tempResource.length!=0&&t.scheduleFeatures.resources?!0:!1,h,i,r;for(f=s?this._isCustomMonthView()&&this._oneWeek?this.res1.length*this._dateRender.length:this.res1.length*7:t.isNullOrUndefined(this.model.group)?7:this._isCustomMonthView()&&this._oneWeek?this.res1.length*this._dateRender.length:this.res1.length*7,h=s&&this._isCustomMonthView()&&this._oneWeek?!0:!1,i=0;i<u.length;i++){for(r=e;r<f;r=h?r+this._dateRender.length:r+7)n(this.element.find("div.e-monthheader"))[r].innerHTML=t.format(new Date(u[i]),"dd").toString(),this.currentView()!=="customview"&&(new Date(u[i]).getMonth()!==new Date(this.currentDate()).getMonth()?this.model.showNextPrevMonth?n(this.element.find("div.e-monthheader")[r]).addClass("e-monthdateshighlight").closest(".e-monthcells").removeClass("e-othermonths").children().show():n(this.element.find("div.e-monthheader")[r]).addClass("e-monthdateshighlight").closest(".e-monthcells").addClass("e-othermonths").children().hide():n(this.element.find("div.e-monthheader")[r]).removeClass("e-monthdateshighlight").closest(".e-monthcells").removeClass("e-othermonths").children().show()),new Date(u[i]).getTime()==new Date((new Date).setHours(0,0,0,0)).getTime()&&(n(this.element.find("td.e-monthcells")[r]).hasClass("e-othermonths")||n(this.element.find("td.e-monthcells")[r]).addClass("e-currentdayhighlight"));e++;(i+1)%7==0&&(e=f,f=f+(t.isNullOrUndefined(this.model.group)?1:this.res1.length)*7,this.model.showNextPrevMonth||this.currentView()=="customview"?(start=t.format(new Date(u[i-6]),"MMM dd"),end=t.format(new Date(u[i]),"MMM dd")):(tempDate=new Date(this.currentDate()),start=i==6?t.format(new Date(tempDate.getFullYear(),tempDate.getMonth(),1),"MMM dd"):t.format(new Date(u[i-6]),"MMM dd"),end=i==u.length-1?t.format(new Date(tempDate.getFullYear(),tempDate.getMonth()+1,0),"MMM dd"):t.format(new Date(u[i]),"MMM dd")),this.model.timeScale.enable&&(n(this.element.find(".e-timecelldivs"))[o].innerHTML=start+"- "+end),o++)}this.model.showNextPrevMonth||this.currentView()!="month"||this._refreshOtherMonthsBorder();this.element.find(".e-timecells").addClass("e-dateheaderselect");this.element.find(".e-monthcells, .e-timecells").height(this.model.cellHeight!="20px"?parseInt(this.model.cellHeight):parseInt(this.element.find(".e-draggableworkarea").height()/this.element.find(".e-draggableworkarea tr").length));r!=6&&this.element.find(".e-timecells").addClass("e-timecellpadding")},_refreshOtherMonthsBorder:function(){for(var r,o,t,u=this.model.enableRTL?"e-borderright":"e-borderleft",f=this.element.find(".e-workcellstab tr").first().find(".e-othermonths").length,e=f/this.res1.length,i=e;i<f;i=i+e)n(this.element.find(".e-workcellstab tr").first().find(".e-othermonths")[i]).addClass(u);for(r=this.element.find(".e-workcellstab tr").last().find(".e-othermonths").length,o=r/this.res1.length,t=0;t<r;t=t+o)n(this.element.find(".e-workcellstab tr").last().find(".e-othermonths")[t]).addClass(u)},_navigateClick:function(i,r){var e,u,h,l,f,c,s,o;if(this._viewchange=!0,u=r,h=new Date(this.currentDate()),e={currentView:this.currentView(),currentDate:new Date(this.currentDate()),target:i},this._trigger("actionBegin",{data:e,requestType:"dateNavigate"}))return!1;if(t.isNullOrUndefined(i)||t.isNullOrUndefined(i.value)||(l=t.parseDate(i.value,this._pattern.d),this.currentDate(l)),i!=null&&!this._setCurrentDate){if(n(i.currentTarget).hasClass("e-disable"))return!1;f=new Date(this.currentDate());c=this.currentView()==="day"||this.currentView()==="agenda"?1:this.currentView()==="customview"?this._dateRender.length:7;n(i.currentTarget).hasClass("e-navigateprevious")?(this._daterend=this._dateRender,this._isCustomMonthView()?(s=new Date(this._dateRender[0]),weekDate=new Date(this._dateRender[0]),weekDate.setTime(s.getTime()-this._dateRender.length*864e5),this.currentDate(new Date(weekDate))):this.currentDate(this.currentView()==="month"?new Date(f.setMonth(new Date(this.currentDate()).getMonth()-1)):new Date(f.setDate(new Date(this.currentDate()).getDate()-c))),this.element.find(".e-navigateprevious").attr("tabIndex",0).focus(),u="Previous"):n(i.currentTarget).hasClass("e-navigatenext")&&(this.currentView()=="customview"?(this._daterend=this._dateRender,s=new Date(this._dateRender[0]),weekDate=new Date(this._dateRender[0]),weekDate.setTime(s.getTime()+this._dateRender.length*864e5),this.currentDate(new Date(weekDate))):this.currentDate(this.currentView()==="month"?new Date(f.setMonth(new Date(this.currentDate()).getMonth()+1)):new Date(f.setDate(new Date(this.currentDate()).getDate()+c))),this.element.find(".e-navigatenext").attr("tabIndex",0).focus(),u="Next")}if(i!=null&&(n(i.currentTarget).hasClass("e-navigateprevious")||n(i.currentTarget).hasClass("e-navigatenext")||i.type=="select")&&(e={previousDate:h,currentDate:f,currentView:this.currentView(),target:i,requestType:"dateNavigate"}),this._trigger("navigation",e))return this.currentDate(new Date(h)),!1;this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell");this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment");this.element.find(".e-appsoverflow").remove();this.element.find(".e-monthcells").removeClass("e-monthcurrenttime");this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove();this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");t.isNullOrUndefined(this._scheduleDrawer)||this._scheduleDrawer.ejNavigationDrawer("close");this.currentView()==="month"||this.currentView()==="agenda"||this._isCustomMonthView()?(this._navigate=!0,this._renderCurrentView(u)):(this.model.timeScale.enable?t.isNullOrUndefined(this.model.workCellsTemplateId)?this._renderHeaderDays():this._renderCurrentView(u):this._renderCurrentView(u),!this._mediaQuery&&this.model.orientation=="vertical"&&this.model.timeScale.enable&&this._reRenderScroller(),this.model.showOverflowButton||this.model.orientation!="horizontal"||(this._horizontalRender(),this._reRenderScroller()),t.isNullOrUndefined(this.dataSource())||(this.model.enableLoadOnDemand?this._bindAppointmentsData(u):(this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll())),this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this._renderBlockAppointments());this._validateMinMaxDate();!t.isNullOrUndefined(this.oldDate)&&this.oldDate!=""&&this._setCurrentDate&&(this.currentDate(new Date(this.oldDate)),this.oldDate="");this._setCurrentDate=!1;this._mediaQuery&&!t.isNullOrUndefined(i)&&(o=n(i.currentTarget).hasClass("e-navigateprevious")?this.element.width():n(i.currentTarget).hasClass("e-navigatenext")||i.type=="select"?-this.element.width():0,this.element.find(".e-headeralldaydiv,.e-draggableworkarea,.e-vscroll,.e-emptyscrolltd").toggle(),this.model.enableRTL?this.element.find(".e-headeralldaydiv,.e-draggableworkarea,.e-vscroll").css("margin-right",-o).css("margin-left",o).toggle().animate({"margin-left":0,"margin-right":0},500,this.model.orientation=="vertical"&&this.element.find(".e-vscroll").length==1?n.proxy(this._animateScroll,this):""):this.element.find(".e-headeralldaydiv,.e-draggableworkarea,.e-vscroll").css("margin-left",-o).css("margin-right",o).toggle().animate({"margin-left":0,"margin-right":0},500,this.model.orientation=="vertical"&&this.element.find(".e-vscroll").length==1?n.proxy(this._animateScroll,this):""));this._trigger("actionComplete",{data:e,requestType:"dateNavigate"})},_animateScroll:function(){this.element.find(".e-emptyscrolltd").toggle();(this._browserInfo.name=="webkit"||this._browserInfo.name=="msie")&&(highScrol=this.element.find(".e-businesshighlightworkcells").length!=0?this.element.find(".e-businesshighlightworkcells").first().parent()[0].rowIndex*n(".e-workcells").height():0,n("#"+this._id+"_scroller").ejScroller({scrollTop:highScrol+1}),this.element.find(".e-scrolltimecells").css("top",-(highScrol+1)+"px"))},_validateMinMaxDate:function(){this.element.find(".e-navigateprevious,.e-navigatenext").removeClass("e-disable");var i=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this._dateRender,n=new Date(i[0]),t=new Date(i[i.length-1]);this.currentView()=="workweek"&&(n=new Date(n.setDate(n.getDate()-1)),t=new Date(t.setDate(t.getDate()+1)));n<=this.model.minDate?this.element.find(".e-navigateprevious").addClass("e-disable"):this.element.find(".e-navigateprevious").removeClass("e-disable");t>=this.model.maxDate?this.element.find(".e-navigatenext").addClass("e-disable"):this.element.find(".e-navigatenext").removeClass("e-disable")},_onScheduleResize:function(){var s,i,v,h,c,l,y,o,u,r,f,e,a;if(t.isNullOrUndefined(this._scheduleDrawer)||(t.isNullOrUndefined(this._scheduleDrawer.data("ejNavigationDrawer"))?(n(this._scheduleDrawer).remove(),this._scheduleDrawer=null):this._scheduleDrawer.ejNavigationDrawer("close")),this._mediaQuery&&t.isMobile()){if(this._recurEditWindow.ejDialog("refresh"),this._appointmentAddWindow.ejDialog("refresh"),window.orientation==this._screenOrientation)return!1;this._screenOrientation=window.orientation}if(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),e=this._mediaQuery,s=typeof innerWidth=="number"&&window.innerWidth>document.documentElement.clientWidth,this._mediaQuery=this._browserInfo.name=="msie"&&parseInt(this._browserInfo.version,10)<=8?!1:(document.documentElement.clientWidth+(s?17:0)<361||t.isMobile())&&this.model.isResponsive,this._mediaQuery?this.element.addClass("e-scheduleresponsive"):this.element.removeClass("e-scheduleresponsive"),i=this.element.find("div#"+this._id+"_scroller").data("ejScroller"),this.currentView()!="agenda"?(v=i.isVScroll()?this.element.find("div#"+this._id+"_scroller").find(".e-vscroll").width():0,this.element.find(".e-nextapp").css("left",this.element.width()-v-90+"px"),this.model.enableRTL&&this.element.find(".e-nextapp").css("left","-45px"),this.model.enableRTL&&this.element.find(".e-prevapp").css("left",this.element.width()-this.element.find(".e-scrolltimecells").width()-89+"px"),this.model.orientation!="horizontal"||t.isNullOrUndefined(this.model.group)||this._tempResource.length==0||(this.element.find(".resemptytd").width(this.element.find(".e-horizontalrestd").width()<100?5:this.element.find(".e-horizontalrestd").width()>=100&&this.element.find(".e-horizontalrestd").width()<=150?10:25),this.element.find(".e-horizontalresheader").width(this._mediaQuery?"50px":"100%"),this.element.find(".e-parentnodecategory").width(this._mediaQuery?"12px":"20px")),h=this.model.orientation==="vertical"?(s&&this._mediaQuery?this.element.outerWidth()+17:this.element.outerWidth())-(this._mediaQuery&&(this.currentView()=="month"||this._isCustomMonthView())?1:this.element.find(".e-scrolltimecells").parent().outerWidth()):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this.element.width()-this.element.find(".e-resourceheadertable").width():this.element.width(),i.model.width=parseInt(h)-2,i.model.height=this.scHeight-1-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),i.refresh(),this.model.orientation=="vertical"?(this.model.cellWidth&&!this._mediaQuery&&(c=this.currentView()=="workweek"?this.model.workWeek.length:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,l=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this.res1.length*c:c,this.element.find(".e-draggableworkarea").width(this.element.width()>(parseInt(this.model.cellWidth)+1)*l+this.element.find(".e-scrolltimecells").parent().width()+(i.isVScroll()?18:0)?(parseInt(this.model.cellWidth)+1)*l-1:h-2-(i.isVScroll()?18:0))),this.model.timeScale.enable||(this.element.find(".e-draggableworkarea").css("height",this.model.cellHeight!="20px"?parseInt(this.model.cellHeight):i.model.height-1+"px"),this.element.find(".e-draggableworkarea").height(t.isNullOrUndefined(this.element.find(".e-hscroll"))?this.element.find(".e-draggableworkarea").height():this.element.find(".e-draggableworkarea").height()-this.element.find(".e-hscroll").height())),this._mediaQuery&&this.res1.length>1&&this.element.find(".e-draggableworkarea").width(this.element.find(".e-draggableworkarea").width()*this.res1.length-1),this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width()),this.element.find(".e-datecommondiv").parent().width(parseInt(this.element.width())-2),this.element.find(".e-headrealldaytable").css("left",-this.element.find(".e-draggableworkarea").scrollLeft()+"px"),this.element.find(".e-upicon, .e-downicon").children().width(this.element.find(".e-workcells").width()),this.element.find(".e-headeralldaydiv,.e-draggableworkarea,.e-emptyscrolltd").css("margin-left","0px"),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")):(this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width()),n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-i.model.scrollLeft+"px"),this._horizontalRender()),this.currentView()=="month"||this._isCustomMonthView()||this.model.orientation!="vertical"?(this._isCustomMonthView()||this.currentView()=="month"||this.model.enableRTL)&&this._renderCurrentView("ScheduleResize"):this.model.enableRTL&&(this.model.cellWidth||this.model.cellHeight!="20px")?this._renderCurrentView("ScheduleResize"):(this.model.showAllDayRow&&this.model.timeScale.enable&&this.element.find("div.e-alldayappointment").remove()&&this._renderAllDayAppointments(),this.model.timeScale.enable||(this.element.find("div.e-monthappointment").remove(),this._renderMonthAppointment()),this._unWireResizeEvents(),this._wireResizeEvents(),this._dragdropAppointments()),this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove(),this._highlightCurrentTime(this.model.showCurrentTimeIndicator)):(i.model.width=parseInt(this.element.width())-2,i.model.height=this.scHeight-1-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),i.refresh(),y=n("div#"+this._id+"_scroller"),this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width()),this.element.find(".e-datecommondiv").parent().width(parseInt(this.element.width())-2),y.ejScroller("isVScroll")?this.element.find(".e-emptyscrolltd").show()&&this.element.find(".e-draggableworkarea").height(this.element.find(".e-draggableworkarea").height()+1):this.element.find(".e-emptyscrolltd").hide()),(this._mediaQuery||this.element.width()<600)&&!n("#"+this._id+"navDrawer").hasClass("e-scheduledrawer")&&this._renderNavigationDrawer(),o=this._mediaQuery==e?!1:!0,!o&&(this.element.width()<600&&this.hTR.find(".e-mobileNavigation").length<1||this.element.width()>600&&this.hTR.find("table.e-viewstable").length<1)&&(this._reRenderHeaderBar(),this._on(this.element,"click","#"+this._id+"navDrawerIcon",n.proxy(this._drawerOpen,this))),o){if(this.model.orientation=="horizontal")for(u=this._dateRender,r=0;r<u.length;r++)f=this._mediaQuery&&(this.currentView()=="week"||this.currentView()=="workweek")?this._dayNames[new Date(u[r]).getDay()].split("")[0]:this.currentView()==="day"?t.isNullOrUndefined(this._tempResource)&&t.isNullOrUndefined(this.model.group)?this._dayFullNames[new Date(u[r]).getDay()]:this._dayShortNames[new Date(u[r]).getDay()]:this._dayShortNames[new Date(u[r]).getDay()],e=this._mediaQuery&&(this.currentView()=="week"||this.currentView()=="workweek")?f+parseInt(t.format(new Date(u[r]),"dd")):this.currentView()==="day"?t.isNullOrUndefined(this._tempResource)&&t.isNullOrUndefined(this.model.group)?f+" "+t.format(new Date(u[r]),"dd MMMM yyyy"):f+" "+t.format(new Date(u[r]),"dd MMM yy"):f+" "+new Date(u[r]).getDate(),this.element.find(".e-headerdaydisplay,.e-horizontalheaderdiv").length!=0&&(this.element.find(".e-headerdaydisplay,.e-horizontalheaderdiv")[r].innerHTML=e);this.model.showAppointmentNavigator=o&&!this._mediaQuery;this.model.showAppointmentNavigator?this._nextPrevAppointment(this.model.showAppointmentNavigator):this.element.find(".e-prevapp,.e-nextapp").remove();this.model.showHeaderBar&&this._reRenderHeaderBar();this.element.find(".e-leftindenttable").width(this.element.find(".e-workleftindent").width());this.element.find(".e-ampmdisplay").height(this.element.find(".e-workcells").height());this._businessHourScroller();this.model.showQuickWindow=this._mediaQuery?!1:this._quickWindow;this.model.showQuickWindow&&t.isNullOrUndefined(this._quickAppointWindow)&&(this._renderQuickAppWindow()||this._renderQuickAppDetailsView());n.isFunction(n.validator)&&this._setQuickValidation();this._refreshAppointmentWindow();t.isNullOrUndefined(this._alertWindow)||this._alertWindow.ejDialog("close");this._recurEditWindow.ejDialog("close");this._recurEditWindow.ejDialog({width:this._mediaQuery?"90%":360});this._mediaQuery&&this._phoneChanges();this._renderAppointmentAll();this._renderBlockAppointments();this._mediaQuery?(this._off(this.element,t.eventType.mouseDown,"td.e-workcells,td.e-monthcells,td.e-alldaycells"),this._off(this.element,"keydown click","td.e-workcells,td.e-monthcells,td.e-alldaycells"),this._on(this.element,"click","#"+this._id+"navDrawerIcon",n.proxy(this._drawerOpen,this))):(this._on(this.element,t.eventType.mouseDown,"td.e-workcells,td.e-monthcells,td.e-alldaycells",n.proxy(this._mouseButtonClick,this)),this._on(this.element,"keydown click","td.e-workcells,td.e-monthcells,td.e-alldaycells",n.proxy(this._shiftSelection,this)),this.element.width()>600&&this._off(this.element,"click","#"+this._id+"navDrawerIcon"));this._mediaQuery||t.isTouchDevice()?this._on(this.element,"swipeleft swiperight",".e-contentarearow .e-workcellstab,.e-agendacellstab",n.proxy(this._touchSchedule,this)):this._off(this.element,"swipeleft swiperight",".e-contentarearow .e-workcellstab,.e-agendacellstab");this._on(this.element,t.isMobile()?"click":"dblclick",".e-workcells,.e-alldaycells,.e-alldayappointment,.e-monthcells",n.proxy(this._appointmentWindow,this));this._mediaQuery||t.isMobile()?this._on(this.element,"tap",".e-appointment,.e-alldayappointment,div.e-monthappointment,.e-agendaappointment",n.proxy(this._appointmentWindow,this)):this._off(this.element,"tap",".e-appointment,.e-alldayappointment,div.e-monthappointment,.e-agendaappointment");a=n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"RecurrenceEdit_wrapper,#"+this._id+"navDrawer,#"+this._id+"alertWindow_wrapper");this._mediaQuery?a.addClass("e-scheduleresponsive"):a.removeClass("e-scheduleresponsive");this._mediaQuery&&this.res1.length>1&&this.element.addClass("e-resources")}(this._mediaQuery||this.element.width()<600)&&this.element.find(".e-mobileNavigation").css(this.model.enableRTL?"right":"left",this.element.outerWidth()-36)},_reRenderHeaderBar:function(){var t=this.element.find(".e-scheduleheader");t.empty();this._renderHeaderBar(t);this.element.find("#"+this._id+"_navigator").ejDatePicker({enableRTL:this.model.enableRTL,buttonText:this._getLocalizedLabels("Today"),select:n.proxy(this._onselect,this),locale:this.model.locale,cssClass:this.model.cssClass,minDate:this.model.minDate,maxDate:this.model.maxDate});this.element.find(".e-datecommondiv").find(".e-datewidget").css("display","none");this.element.find(".e-commonviewbutton.e-"+this.currentView()).addClass("e-activeview")},_renderTemplates:function(){this.model.orientation=="vertical"&&(this.workcellTemp=n.templates(this._createTemplate(v(),"_WorkCells")),this.monthcellTemp=n.templates(this._createTemplate(u(),"_MonthCells")),this.timeCellTemplate=n.templates(this._createTemplate(y(),"_TimeCells")),this.userTimeCellTemplate=n.templates(this._createTemplate(p(),"_userTimeCells")),this.headTemplate=n.templates(this._createTemplate(s(),"_HeaderDate")),this.alldayTemp=n.templates(this._createTemplate(l(),"_AlldayCells")),this.leftIndent=n.templates(this._createTemplate(h(),"_LeftIndentCells")));t.scheduleFeatures.resources&&this._tempResource.length!=0&&this._renderResourcesTemplate();this.agendaheadTemplate=n.templates(this._createTemplate(w(),"_HeaderDate"));this.agendacellTemp=n.templates(this._createTemplate(k(),"_AgendaCells"));this.appTemplate=n.templates(this._createTemplate(f(),"_Appointment"));this.blockTimeTemplate=n.templates(this._createTemplate(e(),"_BlockTime"));t.scheduleFeatures.horizontal&&this.model.orientation==="horizontal"&&this._renderHorizontalTemplates();!t.isNullOrUndefined(this.model.categorizeSettings)&&this.model.categorizeSettings.enable&&(this._renderCategorizeTemplate(),this._categorizeMultipleTemplate=n.templates(this._createTemplate(o(),"_CategorizeMultiple")))},_setNewStartEndHours:function(){this.currentView()==="month"||this._isCustomMonthView()||(this.model.orientation=="horizontal"&&(this.aTR.children().remove(),this._renderHeaderAllDayTemplate()),this.wTR.children().remove(),this._renderContentAreaTemplate(),this._borderAddRemove(),this.model.orientation=="horizontal"&&this._horizontalRender(),this._renderScroller(),this.element.find(".e-ampmdisplay").height(this.element.find(".e-workcells").height()),this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").addClass("e-businesshighlightworkcells"),this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove(),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this._renderAppointmentAll(),!t.isNullOrUndefined(this.model.blockoutSettings)&&this.model.blockoutSettings.dataSource instanceof t.DataManager?this._bindBlockData():this._renderBlockAppointments())},_renderInitSchedule:function(){var f,i,r,e,u;this.element.addClass("e-scheduleouter");this._screenOrientation=window.orientation;this._quickWindow=this.model.showQuickWindow;f=typeof innerWidth=="number"&&window.innerWidth>document.documentElement.clientWidth;this._mediaQuery=this._browserInfo.name=="msie"&&parseInt(this._browserInfo.version,10)<=8?!1:(document.documentElement.clientWidth+(f?17:0)<361||t.isMobile())&&this.model.isResponsive;this._mediaQuery?this.element.addClass("e-scheduleresponsive"):this.element.removeClass("e-scheduleresponsive");this._mediaQuery&&(this.model.showQuickWindow=!1);i=t.preferredCulture(this.model.locale);r=i.calendar;t.isNullOrUndefined(this._clientWidth)&&(this._clientWidth=this.model.width);this.currentView(this.currentView().toLowerCase());this.model.views=this.model.views.length==0?this.currentView().toString().toLowerCase().split(","):this.model.views.toString().toLowerCase().split(",");this.model.workWeek=this.model.workWeek==""||this.model.workWeek==null?this._dayNamesArray:this.model.workWeek;this._resWorkWeek=this.model.orientation=="vertical"&&this.currentView()=="workweek"&&this._tempResource.length!=0&&!t.isNullOrUndefined(this._tempResource[this._tempResource.length-1].resourceSettings.workWeek);this.model.endHour>24&&(this.model.endHour=24);this.model.startHour<0&&(this.model.startHour=0);this._timeMode=this.model.timeMode==null?r.AM==null&&r.PM==null?"24":"12":this.model.timeMode;this.model.timeMode==null?this._pattern=i.calendar.patterns:this._pattern.t=this._timeMode=="12"?"h:mm tt":"HH:mm";this._firstdayofweek=this.model.firstDayOfWeek!=null?typeof this.model.firstDayOfWeek=="string"?this._dayNamesArray.indexOf(this.model.firstDayOfWeek.toString().toLowerCase()):this.model.firstDayOfWeek:i.calendar.firstDay;this.model.workWeek=this.model.workWeek.toString().toLowerCase().split(",");this.model.width=this.model.width?this.element.width(this._clientWidth).width():this.element.width();this.model.height=this.model.height?this.element.height(this.model.height).height():this.element.height();this.scWidth=this._scWidth?parseInt(this._scWidth):parseInt(this.model.width);this.scHeight=this._scHeight?parseInt(this._scHeight):parseInt(this.model.height);this.currentDate()<this.model.minDate&&this.currentDate(this.model.minDate);this.currentDate()>this.model.maxDate&&this.currentDate(this.model.maxDate);this.element.addClass("e-scheduleouter").height(this.model.height).width(this._clientWidth).attr("role","presentation");e=this.model.orientation=="vertical"?"e-vertical":"e-horizontal";n(this.element).attr("tabIndex",1);var o=t.buildTag("div.e-scheduleinner "+e,"",{},{height:this.scHeight,width:this.scWidth}).css("height",this.scHeight-2+"px").css("position","relative"),s=t.buildTag("table.e-table","",{},{cellpadding:"0px",cellspacing:"0px"}).addClass("e-scheduleoutertable"),h=t.buildTag("tbody");this.hTR=t.buildTag("tr.e-scheduleheader");this.aTR=t.buildTag("tr.e-headerarearow");this.model.views.toString().toLowerCase().split(",").indexOf(this.currentView())==-1&&this.currentView(this.model.views[0].toLowerCase());this._calculateCustomDays()._getRenderDates();this.wTR=t.buildTag("tr.e-contentarearow");this._renderTemplates();this.model.showHeaderBar&&this._renderHeaderBar(this.hTR);this._renderHeaderAllDayTemplate();this._renderContentAreaTemplate();o.append(s.append(h.append(this.hTR).append(this.aTR).append(this.wTR)));this._mediaQuery&&this.res1.length>1&&this.element.addClass("e-resources");this._renderDialogs();this._renderToolTip();this.element.append(o);this.model.showHeaderBar||this.element.find(".e-scheduleheader").hide();this.model.showHeaderBar&&(this.hTR.find(".e-commonviewbutton.e-"+this.currentView()).addClass("e-activeview"),this.element.find("#"+this._id+"_navigator").ejDatePicker({startDay:this._firstdayofweek,enableRTL:this.model.enableRTL,buttonText:this._getLocalizedLabels("Today"),select:n.proxy(this._onselect,this),locale:this.model.locale,cssClass:this.model.cssClass,minDate:this.model.minDate,maxDate:this.model.maxDate}),this.element.find("span.e-datewidget").css("display","none"));(this._mediaQuery||this.element.width()<600)&&this._renderNavigationDrawer();this._showContextMenu(this.model.contextMenuSettings.enable);this._renderAlertWindow();u=n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"RecurrenceEdit_wrapper,#"+this._id+"navDrawer,#"+this._id+"alertWindow_wrapper");this._mediaQuery?u.addClass("e-scheduleresponsive"):u.removeClass("e-scheduleresponsive");this._mediaQuery&&this._phoneChanges();this.model.enableRTL&&this._browserInfo.name=="webkit"&&this._appointmentAddWindow.find(".e-chk-image").css("margin-right","-13px");this._renderCommon("init")},_renderToolTip:function(){var i=this,r;t.isNullOrUndefined(this.element.data("ejTooltip"))&&(r=this.model.tooltipSettings.enable?".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendacells.e-eventcolumn,.e-appup,.e-appdown,.e-appsoverflow":".e-appup,.e-appdown,.e-appsoverflow",this.element.ejTooltip({target:r,associate:"mousefollow",isBalloon:!1,beforeOpen:function(n){i._showToolTip(n)?i._openTooltip=!0:(n.cancel=!0,i._openTooltip=!1)},containment:"#"+this._id,tip:{adjust:{xValue:20,yValue:20}},position:{target:{horizontal:"center",vertical:"bottom"},stem:{horizontal:"left",vertical:"top"}},tracking:function(t){(!i._openTooltip||n(t.event.target).is(".e-tophandle,.e-bottomhandle,.e-schedulemouseclose,.e-righthandle,.e-lefthandle,.e-schedulerepeat,.e-editapp,.e-deleteapp"))&&(t.cancel=!0,this.hide())}}))},_renderDialogs:function(){this._renderAppointmentWindow();n.isFunction(n.validator)&&this._setValidation();this._renderRecurEditWindow();this.model.showQuickWindow&&(this._renderQuickAppWindow()||this._renderQuickAppDetailsView());n.isFunction(n.validator)&&this._setQuickValidation()},_renderCommon:function(i){if(this.currentView()!="agenda"){if(this.model.orientation=="vertical"&&(this._headerbarWidth(),i=="init"&&(this.currentView()==="month"||this._isCustomMonthView())&&this._renderMonthTimeCells(),this.model.timeScale.enable||(this.element.find(".e-headercells").first("td").css("border-left","none"),this.element.find(".e-workcellstab").find("tr").find("td:first-child").css("border-left","none")),!this.model.showAllDayRow&&this.model.cellWidth&&this.element.find(".e-workcellstab tr td:first-child").width(this.element.find(".e-headercells").width()),this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay")),this.element.find(".e-ampmdisplay").height(this.element.find(".e-workcells").height())),this.model.enableRTL&&this.element.addClass("e-rtl"),this.model.timeScale.enable&&this._borderAddRemove(),this.model.enableRTL&&this.element.removeClass("e-rtl"),this.model.orientation=="vertical"?this.currentView()!=="month"&&!this._isCustomMonthView()?this.element.find(".e-headercells").addClass("e-dateheaderselect"):"":this.element.find(".e-headercells").addClass("e-dateheaderselect"),this.model.orientation=="horizontal"&&(this.currentView()=="month"||this._isCustomMonthView())&&this.element.find(".e-workcells").width()<this.element.find(".e-dateheadercell").width()&&this.model.cellWidth==""&&this.element.find(".e-workcells").width(this.element.find(".e-horizontmonthheaderdaytd").width()),this.element.find(".e-horizontalresheader").width(this._mediaQuery?"50px":"100%"),this._renderScroller(),this.model.showAppointmentNavigator&&this.model.orientation=="vertical"&&this.element.find(".e-vscroll").length>0&&this.currentView()!="month"&&!this._isCustomMonthView()&&!this._mediaQuery&&this._renderUpDownIcon(),this.model.showOverflowButton||this.model.orientation!="vertical"||this.currentView()!="month"||this._monthCellsRender(),this.model.orientation=="horizontal"?this._horizontalRender():this.currentView()=="month"||this._isCustomMonthView()?this.element.find(".e-monthcells, .e-timecells").height(this.model.cellHeight!="20px"?parseInt(this.model.cellHeight):parseInt(this.element.find(".e-draggableworkarea").height()/this.element.find(".e-draggableworkarea tr").length)):this.element.find(".e-ampmdisplay").height(n(this.element.find(".e-workcells")).height()),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this.model.enableRTL&&this.element.addClass("e-rtl"),this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal?(this._moveScroller(),this.model.timeScale.enable||this.element.find(".e-headercells").removeClass("e-dateheaderselect"),t.isNullOrUndefined(this.model.group)||this._tempResource.length==0||this._tempResource[0].resourceSettings.dataSource.length==0||this._horizontalResIcon(),!t.isNullOrUndefined(this.model.dateHeaderTemplateId)&&(this.currentView()=="day"||this.currentView()=="week"||this.currentView()=="workweek"||this.currentView()=="customview"&&this._oneWeek)&&this.element.find(".e-headercells").parent().parent().parent().css("width",this.element.width()/10*this._dateRender.length+"px"),this.element.find(".e-parentnodecategory").width(this._mediaQuery?"12px":"20px")):t.isNullOrUndefined(this.model.allDayCellsTemplateId)||this.element.find(".e-leftindent, .e-emptyalldaytd").height(this.element.find(".e-alldaycells").height()),this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"),i=="current"&&this._renderHeaderDays(),this._dateRender.length>60||n.isNumeric(this.element.find(".e-monthcells").height())&&this.element.find(".e-monthcells").height()!=n(this.element.find(".e-timecells")[3]).height()&&this.model.orientation=="vertical"&&this.model.showOverflowButton?this.element.find("td.e-timecells .e-timecelldivs").addClass("e-timedivcells"):"",this.model.orientation=="horizontal"&&this._safariBrowser&&this.element.find(".e-workcells.e-dayend").width(this.element.find(".e-workcells.e-dayend").outerWidth()+1),this.currentView()!="agenda"&&this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0){var r=this.model.enableRTL?"border-right":"border-left";this.element.find(".e-horizontaldaterender").css(r,"0px");this.wTR.find(".e-workareadiv").parent().css(r,"0px")}this._browserInfo.name=="msie"&&this._browserInfo.version<9&&this.model.orientation=="vertical"&&(this.element.find(".e-workleftindent").find("tr").last().find("td").addClass("e-lastcell"),this.element.find(".e-workcellstab").find("tr").last().find("td").addClass("e-lastcell"))}this._validateMinMaxDate();t.isNullOrUndefined(this.model.queryCellInfo)||this._renderQueryCellInfo("emptycell")},_resourceSegregate:function(){var r="",i;if(this._tempResource=[],this._grouping=[],t.isNullOrUndefined(this.model.group)||t.isNullOrUndefined(this.model.resources))t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)&&n.merge(this._tempResource,this.model.resources);else{for(i=0;i<this.model.group.resources.length;i++)if(index=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[i]),!t.isNullOrUndefined(index))if(this.model.resources.length!=0&&this.model.resources[index].resourceSettings.dataSource.length!=0)this._tempResource.push(this.model.resources[index]),this._grouping.push(this.model.group.resources[i]),r=i==this.model.group.resources.length-1?r+this.model.resources[index].field:r+this.model.resources[index].field+",";else return!1;this._appointmentSettings.resourceFields=r}},_borderAddRemove:function(){this.model.enableRTL?(this.element.find(".e-headrealldaytable tr td:first-child,.e-workcellstab tr td:first-child,.e-headerdays table tr td:first-child").css("border-right","none"),this.element.find(".e-horizontalheader,.e-horizontalrestd,.e-monthleftindent,.e-workleftindent,.e-empty").addClass("e-borderleft")):(this.element.find(".e-headrealldaytable tr td:first-child,.e-workcellstab tr td:first-child,.e-headerdays table tr td:first-child").css("border-left","none"),this.element.find(".e-horizontalheader,.e-horizontalrestd,.e-monthleftindent,.e-workleftindent,.e-empty").addClass("e-borderright"));this.model.orientation=="horizontal"?(parseInt(this.element.find(".e-horizontaltimetd,.e-horizontmonthheaderdaytd").css("border-bottom-width"),10)>1?"":this.element.find(".e-horizontaltimecells").height(this.element.find(".e-horizontaltimecells").height()-2),this.currentView()=="month"?this._browserInfo.name!="webkit"||this.model.cellWidth==""?this.element.find(".e-headerdays table tr td:first-child").width(this.element.find(".e-workcellstab tr td:first-child").width()):this.element.find(".e-workcellstab tr td:not(:first-child)").width(this.element.find(".e-horizontmonthheaderdaytd").first().width()+1):this._browserInfo.name=="webkit"&&this.element.find(".e-workcellstab tr td:first-child").width(this.element.find(".e-horizontaltimetd").first().width())):(this.model.cellWidth!=""&&this.element.find(".e-workcellstab tr td:first-child").width(this.element.find(".e-headercells").first().width()),this._safariBrowser&&(this.currentView()=="month"?this.element.find(".e-monthleftindent").width(this.element.find(".e-monthempty").width()+1):this.element.find(".e-workleftindent").attr("style","width:"+(this.element.find(".e-empty").width()+1)+"px !important")));t.isNullOrUndefined(this.oldDate)||this.oldDate==""||(this.currentDate(new Date(this.oldDate)),this.oldDate="")},_phoneChanges:function(){this._appointmentAddWindow.ejDialog({allowDraggable:!1,position:{X:"0",Y:"0"}})},_dateConvert:function(i){if(t.isNullOrUndefined(i))r=null;else{var r=new Date(parseInt(i.match(/\d+/).toString()));r=n.type(r)=="date"?r:new Date}return r},_calculateCustomDays:function(){var i,r;if(!t.isNullOrUndefined(this.model.renderDates)&&this.currentView()=="customview"&&!this._navigate&&(i=n.type(this.model.renderDates.start)!="date"?t.parseDate(this.model.renderDates.start,this._datepattern()):new Date(this.model.renderDates.start),i=t.isNullOrUndefined(i)?new Date(this.model.renderDates.start).toString()=="Invalid Date"||new Date(this.model.renderDates.start).toString()=="NaN"?this._dateConvert(this.model.renderDates.start):new Date(this.model.renderDates.start):i,r=n.type(this.model.renderDates.end)!="date"?t.parseDate(this.model.renderDates.end,this._datepattern()):new Date(this.model.renderDates.end),r=t.isNullOrUndefined(r)?new Date(this.model.renderDates.end).toString()=="Invalid Date"||new Date(this.model.renderDates.end).toString()=="NaN"?this._dateConvert(this.model.renderDates.end):new Date(this.model.renderDates.end):r,t.isNullOrUndefined(this.model.minDate)||t.isNullOrUndefined(this.model.maxDate)||(i=this.model.minDate>=i&&this.model.maxDate<=i?i:this.model.minDate>=i&&this.model.maxDate>=i?this.model.minDate:this.model.maxDate<=i?this.model.minDate:i,r=this.model.minDate>=r&&this.model.maxDate<=r?r:this.model.minDate<=r&&this.model.maxDate<=r?this.model.maxDate:this.model.minDate>=r?this.model.maxDate:r),this._renderStart=t.isNullOrUndefined(i)?r:new Date(i.getFullYear(),i.getMonth(),i.getDate()),this._renderEnd=t.isNullOrUndefined(r)?i:new Date(r.getFullYear(),r.getMonth(),r.getDate()),this._renderDays=Math.round((this._renderEnd-this._renderStart)/864e5)+1,this.oldDate=this.currentDate(),this._renderStart.getTime()>this.currentDate().getTime()||this._renderEnd.getTime()<this.currentDate().getTime()?(this._renderStart=new Date(this.currentDate()),this._renderEnd=new Date(this._renderStart.getTime()+(this._renderDays-1)*864e5)):this._renderStart.getTime()<this.currentDate().getTime()&&this._renderEnd.getTime()>this.currentDate().getTime()?this.currentDate(new Date(this._renderStart)):this.currentDate(new Date(this._renderStart)),this._renderDays>7)){var e=this.model.orientation=="vertical"?new Date(this._firstweekdate(this._renderStart)):new Date(this._renderStart),u=new Date(this._renderEnd),f=u.getDay();this._firstdayofweek==0&&f!=6?u.setDate(new Date(this._renderEnd).getDate()+(6-f)):u.setDate(new Date(this._renderEnd).getDate()+(6-f)+this._firstdayofweek);u=this.model.orientation=="vertical"?u:new Date(this._renderEnd);this._numDays=Math.round((u-e)/864e5)+1}return this},_isCustomMonthView:function(){return this.currentView()=="customview"?(this._oneWeek=this._dateRender.length>7?!1:!0,!this._oneWeek):!1},_headerbarWidth:function(){var i=this.currentView()=="workweek"?this.model.workWeek.length:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,n=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this.res1.length*i:i,r=this.element.outerWidth()-(this.element.find(".e-draggableworkarea").offset().left-this.element.offset().left)<parseInt(this.model.cellWidth)*n?1:0;this._browserInfo.name=="webkit"?this.aTR.find(".e-headrealldaytable").width(this.model.cellWidth?parseInt(this.model.cellWidth)*n+(r?0:n):"100%"):this.aTR.find(".e-headrealldaytable").width(this.model.cellWidth?parseInt(this.model.cellWidth)*n+n:"100%")},_renderScroller:function(){var r=this.element.find("div#"+this._id+"_scroller"),u=this.scHeight-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),i=this,f=this.model.orientation==="vertical"?this.element.width()-(this._mediaQuery&&(this.currentView()=="month"||this._isCustomMonthView())?1:this.element.find(".e-scrolltimecells").parent().outerWidth()):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this.element.width()-this.element.find(".e-resourceheadertable").width():this.element.width();r.ejScroller({enableRTL:this.model.enableRTL,height:u-1,width:parseInt(f)-2,cssClass:this.model.cssClass,thumbStart:function(t){var r=n(t.originalEvent.target);if(!i._mediaQuery&&r.hasClass("e-workcells")||r.parents(".e-appointment").hasClass("e-appointment")||r.parents(".e-monthappointment").hasClass("e-monthappointment")||r.hasClass("e-categorybar"))return!1},scroll:function(r){var e,o,u,f;if(r.originalEvent=="touchmove")return!1;e=i.element.find("div#"+i._id+"_scroller").data("ejScroller");(e.isVScroll()||e.isHScroll())&&(i.model.orientation==="vertical"?i.element.find(".e-scrolltimecells").css("top",-r.scrollTop+"px"):i.model.timeScale.enable&&i.currentView()!=="month"&&!i._isCustomMonthView()?n(i.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-r.scrollLeft+"px"):i.element.find(".e-headerdays").css("left",-r.scrollLeft+"px"),i.element.find(".e-vhandle").length==1&&i.element.find(".e-horires").css("top",-r.scrollTop+"px"),i.model.orientation=="vertical"?(i.element.find(".e-headrealldaytable").css("left",-r.scrollLeft+"px"),o=i.element.find(".e-scrolltimecells").width()-3,i.element.find(".e-upicon, .e-downicon").css("left",-(r.scrollLeft-o)+"px"),i._timeMode!=="12"||i.currentView()==="month"||i._isCustomMonthView()||(u=r.scrollTop/(i.element.find(".e-workcells").height()*i.model.timeScale.minorSlotCount),u=Math.round(u)<u?Math.round(u)+1:Math.round(u),f=t.preferredCulture(i.model.locale).calendar,f.AM&&f.PM&&i.element.find(".e-idAmpmstyle").each(function(t,i){t==u&&n(i).text().trim()=="00"?parseInt(n(i)[0].id)<12?n(i).text(f.AM[0]):n(i).text(f.PM[0]):(n(i).text()==f.AM[0]&&t>0||n(i).text()==f.PM[0]&&parseInt(n(i)[0].id)>12)&&n(i).text("00")})),i.model.showAppointmentNavigator&&i.model.orientation=="vertical"&&e.isVScroll()&&i.currentView()!="month"&&!i._isCustomMonthView()&&!i._mediaQuery&&(i._renderUpDownIcon(),i._renderUpDownIconPosition())):t.scheduleFeatures.horizontal&&i.model.orientation=="horizontal"&&i._horizontalScroll(r,i));i.model.showQuickWindow&&i._quickAppointWindow.ejDialog("close")&&i._quickAppDetailsWindow.ejDialog("close")}});this._mediaQuery||this._nextPrevAppointment(this.model.showAppointmentNavigator);this._renderHoriVerticalScroll();this.element.find(".e-mobileNavigation").css(this.model.enableRTL?"right":"left",this.element.outerWidth()-36);this._showScrollTd()},_showScrollTd:function(){var n=this.model.enableRTL?"e-borderright":"e-borderleft",i=this.model.orientation=="horizontal"?"16px":"18px";this.model.orientation=="horizontal"&&(this.element.find(".e-vscroll").length>0?(this.element.find(".e-scheduleheader td").first().attr("colspan","3"),this.element.find(".e-workareadiv").parent().attr("colspan","2"),this.element.find(".e-emptyscrolltd").length==0&&this.aTR.append(t.buildTag("td.e-emptyscrolltd","",{},{width:this._mediaQuery?"0px":"16px"})),this.element.find(".e-emptyscrolltd").addClass("e-horizontalemptytd")):(this.element.find(".e-scheduleheader td").first().attr("colspan","2"),this.element.find(".e-workareadiv").parent().attr("colspan","2")));this.element.find(".e-vscroll").length>0?this.element.find(".e-emptyscrolltd").addClass(n).attr("width",i).show():this.element.find(".e-emptyscrolltd").removeClass(n).attr("width","0px").hide()},_renderHoriVerticalScroll:function(){var i=this.element.find("div#"+this._id+"_scroller"),r=this.model.orientation==="vertical"?this.element.width()-(this._mediaQuery&&(this.currentView()=="month"||this._isCustomMonthView())?1:this.element.find(".e-scrolltimecells").parent().outerWidth()):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this.element.width()-this.element.find(".e-resourceheadertable").width():this.element.width(),f,o,h,l,s;if(r=parseInt(r)-1,f=parseInt(this.scHeight)-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),this.model.orientation=="vertical"){if(this.model.cellWidth||this.model.cellHeight!="20px"){o=this.currentView()=="workweek"?this.model.workWeek.length:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7;h=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this.res1.length*o:o;this.currentView()=="day"&&this.element.find(".e-headerdaydisplay").css("width",this.model.cellWidth);var a=this._dateRender.length/7,e=(parseInt(this.model.cellWidth)+1)*h,c=parseInt(this.model.cellHeight)*a,v=this.scWidth-this.element.find(".e-scrolltimecells").width()+(this.currentView()==="month"?0:4),u=f;this.currentView()=="month"||this._isCustomMonthView()?(this.element.find(".e-draggableworkarea").width(this.element.width()>e+this.element.find(".e-scrolltimecells").width()+18?e-1:i.ejScroller("isVScroll")?r-19:r-1),this.model.cellHeight!="20px"?this.element.find(".e-draggableworkarea").height(u>c?c:i.ejScroller("isHScroll")?u-19:u-1):this.element.find(".e-draggableworkarea").height(i.ejScroller("isHScroll")?u-19:u-1)):(this.element.find(".e-draggableworkarea").width(this.element.width()>e+this.element.find(".e-scrolltimecells").width()+(i.ejScroller("isVScroll")?18:0)?e-1:r-1-(i.ejScroller("isVScroll")?18:0)),this.model.timeScale.enable||(this.model.cellHeight=="20px"?this.element.find(".e-draggableworkarea").height(i.ejScroller("isHScroll")?u-1-(i.ejScroller("isHScroll")?18:0):u-1):this.element.find(".e-draggableworkarea").height(parseInt(this.model.cellHeight))));this.model.cellWidth&&this.element.find(".e-datecommondiv").parent().width(parseInt(this.element.width())-2)}else this.element.find(".e-draggableworkarea").height(f-1),this.model.showOverflowButton||this._monthCellsRender(),this.element.find(".e-vscroll").length>0&&!this._mediaQuery?this.element.find(".e-draggableworkarea").width(r-1-(i.ejScroller("isVScroll")?18:0)):(this.currentView()=="month"||this._isCustomMonthView()||!this.model.timeScale.enable)&&(this.element.find(".e-draggableworkarea").width(r-1),this.element.find(".e-draggableworkarea").height(f-5));this._mediaQuery&&this.res1.length>1&&this.element.find(".e-draggableworkarea").width(this.element.find(".e-draggableworkarea").width()*this.res1.length);this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width());this.element.find(".e-scrolltimecells").height(this.element.find(".e-draggableworkarea").height())}else i.ejScroller("isHScroll")?"":this.element.find(".e-draggableworkarea").css("height","100%")&&this.element.find(".e-resfootertr").css("height","0px"),i.ejScroller("isVScroll")?"":this.element.find(".e-draggableworkarea").css("height",f-18),this._mediaQuery&&(this.element.find(".e-horizontresdiv").height(i.height()),this.element.find(".e-draggableworkarea").children().height("100%"),this.element.find(".e-horires").height(this.element.find(".e-draggableworkarea").height()),this.element.find(".e-horires").children().height("100%")),(this.model.cellWidth||this.model.cellHeight!="20px")&&(l=n(this.element.find(".e-workcells")[0]).parent().find("td").length,i.ejScroller("isHScroll")?"":this.element.find(".e-draggableworkarea").width(parseInt(this.model.cellWidth)*l),(this.currentView()=="month"||this._isCustomMonthView())&&this.element.find(".e-headerdays").children().css("width",this.element.find(".e-draggableworkarea").children().width()+"px"),this.model.cellHeight=="20px"||this._tempResource||this.element.find(".e-draggableworkarea").height(parseInt(this.model.cellHeight)-1)),this.element.find(".e-horizontaltabletimecell").width(this.element.find(".e-workcellstab").width()),this.model.timeScale.enable&&!i.ejScroller("isHScroll")&&this.currentView()!="month"&&(s=Math.floor(this.element.find(".e-draggableworkarea").width()/this.element.find(".e-workcells").length),this.element.find(".e-workcells").width(s),this.element.find(".e-horizontaltabletimecell").find("tr td").width(s),this.element.find(".e-horizontaltabletimecell").css("table-layout","fixed"),this.element.find(".e-horizontaltabletimecell").width(this.element.find(".e-draggableworkarea").width())),this.currentView()!="month"&&(this.model.cellWidth||this._browserInfo.name=="webkit"?this._browserInfo.name=="webkit"&&this.currentView()!="month"&&(this.model.cellWidth&&this.element.find(".e-headerdays").width(this.model.cellWidth),this.element.find(".e-workcells").width(this.element.find(".e-draggableworkarea").width/this._dateRender.length),this.element.find(".e-dateheadercell").width(this.element.find(".e-workcells").width()),this.element.find(".e-headerdays table tr td:not(:first-child)").find(".e-dateheadercell").width(this.element.find(".e-workcells").width()-1),this.element.find(".e-workcells").width(this.element.find(".e-workcells").width())):(this.element.find(".e-dateheadercell").width(this.element.find(".e-workcells").width()),this.element.find(".e-workcells").width(this.element.find(".e-workcells").width())));this.model.timeScale.enable&&this._isCustomMonthView()&&this.element.find(".e-timecells").children().height(this.element.find(".e-workcells,.e-monthcells").height())},_getDayNameIndex:function(n){var r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=[],t=this._firstdayofweek;do t>6&&(t=0),i.push(r[t]),t++;while(i.length<7);return i.indexOf(n.capitalizeFirstString())},_highlightBusinessHours:function(){var ot,r,f,e,it,a,ut,l,rt,u,et,i,v;if(this.currentView()=="agenda")return!1;if(ot=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this._tempResource[this._tempResource.length-1].resourceSettings.workWeek)||!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&!t.isNullOrUndefined(this._tempResource[this._tempResource.length-1].resourceSettings.start)||!t.isNullOrUndefined(this._tempResource[this._tempResource.length-1].resourceSettings.end):!1,ot){this.element.find(".e-workcells, .e-monthcells").removeClass("e-businesshighlightworkcells e-monthcellhighlight");var c,k,d,y,p,w,nt,tt,g,l,o,s,a,st,ht,b=0,ct=[],u=this.element.find(".e-workcellstab tr"),h=this.model.orientation=="horizontal"&&this._grouping.length>1?this._resourceSort():this.res1;if(this.model.orientation=="vertical"){for(i=0;i<h.length;i++)if(o=t.isNullOrUndefined(h[i][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?this.model.workWeek:h[i][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek],this.currentView()!=="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable){for(c=this.dateRender,(t.isNullOrUndefined(this.model.group)||this._tempResource.length==0||t.isNullOrUndefined(this._tempResource[this._tempResource.length-1].resourceSettings.start))&&t.isNullOrUndefined(this._tempResource[this._tempResource.length-1].resourceSettings.end)?(k=this.model.workHours.start>=this.model.startHour?this.model.workHours.start-this.model.startHour:0,d=this.model.workHours.end<=this.model.endHour?this.model.workHours.end-this.model.startHour:this.model.endHour-this.model.startHour):(y=h[i][this._tempResource[this._tempResource.length-1].resourceSettings.start],p=h[i][this._tempResource[this._tempResource.length-1].resourceSettings.end],k=t.isNullOrUndefined(y)?this.model.workHours.start>=this.model.startHour?this.model.workHours.start:this.model.startHour:y>=this.model.startHour?y:this.model.workHours.start>=this.model.startHour?this.model.workHours.start:this.model.startHour,d=t.isNullOrUndefined(p)?this.model.workHours.end<=this.model.endHour?this.model.workHours.end:this.model.endHour:p<=this.model.endHour?p:this.model.workHours.end<=this.model.endHour?this.model.endHour:this.model.workHours.end),w=this.model.endHour-this.model.startHour,nt=Math.floor(u.length/w*k)-this.model.startHour*this.model.timeScale.minorSlotCount,tt=Math.floor(u.length/w*d)-this.model.startHour*this.model.timeScale.minorSlotCount,l=this.currentView()==="week"?7:this.currentView()==="workweek"?o.length:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:1,r=nt;r<tt;r++)for(f=b;f<b+l;f++)for(e=0;e<o.length;e++)s=this._dayNamesArray.indexOf(o[e]),s==-1&&(s=this._getDayNameIndex(o[e])),s==new Date(c[f]).getDay()&&n(n(u[r]).children()[f]).addClass("e-businesshighlightworkcells");b+=l}else{if(this._resWorkWeek){for(r=0;r<o.length;r++)a=this._dayFullNames.indexOf(o[r].capitalizeFirstString()),a==-1&&(a=this._getDayNameIndex(o[r])),ct.push(this._renderDates[a]);c=ct}else c=this.currentView()!="month"&&!this._isCustomMonthView()?this.dateRender:this._dateRender;for(l=this._resWorkWeek?o.length:this.currentView()=="day"?1:7,st=this.currentView()!="month"&&!this._isCustomMonthView()?b:i*7,ht=this.currentView()!="month"&&!this._isCustomMonthView()?b+l:(i+1)*7,r=0;r<u.length;r++)for(f=st;f<ht;f++)for(e=0;e<o.length;e++)s=this._dayNamesArray.indexOf(o[e]),s==-1&&(s=this._getDayNameIndex(o[e])),s==new Date(c[f]).getDay()&&(n(n(u[r]).children()[f]).hasClass("e-othermonths")?n(n(u[r]).children()[f]).removeClass("e-monthcellhighlight"):n(n(u[r]).children()[f]).addClass("e-monthcellhighlight"));b+=l}this.currentView()!=="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable&&this._businessHourScroller()}else if(this.currentView()!=="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable){for(c=this._dateRender,i=0;i<h.length;i++)if(h[i].classname!="e-parentnode")for(y=h[i][this._tempResource[this._tempResource.length-1].resourceSettings.start],p=h[i][this._tempResource[this._tempResource.length-1].resourceSettings.end],k=t.isNullOrUndefined(y)?this.model.workHours.start>=this.model.startHour?this.model.workHours.start:this.model.startHour:y>=this.model.startHour?y:this.model.workHours.start>=this.model.startHour?this.model.workHours.start:this.model.startHour,d=t.isNullOrUndefined(p)?this.model.workHours.end<=this.model.endHour?this.model.workHours.end:this.model.endHour:p<=this.model.endHour?p:this.model.workHours.end<=this.model.endHour?this.model.endHour:this.model.workHours.end,w=this.model.endHour-this.model.startHour,g=n(u[i]).children().length/c.length,nt=Math.floor(g/w*k),tt=Math.floor(g/w*d),r=0;r<c.length;r++)for(f=0;f<this.model.workWeek.length;f++)if(s=this._dayNamesArray.indexOf(this.model.workWeek[f]),s==-1&&(s=this._getDayNameIndex(this.model.workWeek[f])),s==new Date(c[r]).getDay())for(e=g*r+nt;e<g*r+tt;e++)if(n(n(u[i]).children()[e]).addClass("e-businesshighlightworkcells"),this._grouping.length>1){it=i;a=this._tempResource.length-1;do ut=new t.DataManager(this._tempResource[a-1].resourceSettings.dataSource).executeLocal((new t.Query).where(this._tempResource[a-1].resourceSettings.id,t.FilterOperators.equal,h[it][this._tempResource[this._tempResource.length-1].resourceSettings.groupId])),t.isNullOrUndefined(ut)||(it=h.indexOf(ut[0]),n(n(u[it]).children()[e]).addClass("e-businesshighlightworkcells")),a-=1;while(a>0)}this._businessHourScroller()}else this._horizontalBusinessHighlight(null,null,null,null,null)}else if(this.currentView()!=="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable){this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");var c=this.dateRender,u=this.element.find(".e-workcells"),lt=this.model.workHours.start>=this.model.startHour?this.model.workHours.start-this.model.startHour:0,at=this.model.workHours.end<=this.model.endHour?this.model.workHours.end-this.model.startHour:this.model.endHour-this.model.startHour,ft=60/this.model.timeScale.majorSlot*this.model.timeScale.minorSlotCount;if(this.res1=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this.res1:[0],l=this.currentView()==="week"?7*this.res1.length:this.currentView()==="workweek"?this.model.workWeek.length*this.res1.length:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length*this.res1.length:1*this.res1.length,this.model.orientation=="vertical"){for(i=lt*ft;i<at*ft;i++)for(v=0;v<l;v++)for(rt=0;rt<this.model.workWeek.length;rt++)this._dayNamesArray.indexOf(this.model.workWeek[rt])==new Date(c[v]).getDay()&&n(u[i*l+v]).addClass("e-businesshighlightworkcells");this._businessHourScroller()}else this._horizontalBusinessHighlight(this._dateRender,lt,at,ft,u)}else if(this.model.orientation=="vertical")for(et=this.dateRender,u=this.element.find(".e-monthcells"),u.removeClass("e-monthcellhighlight"),i=0;i<et.length;i++)for(v=0;v<this.model.workWeek.length;v++)this._dayNamesArray.indexOf(this.model.workWeek[v])==new Date(et[i]).getDay()&&(n(u[i]).hasClass("e-othermonths")?n(u[i]).removeClass("e-monthcellhighlight"):n(u[i]).addClass("e-monthcellhighlight"));else this._horizontalBusinessHighlight(null,null,null,null,null)},_onselect:function(n){this._navigateClick(n,"DateNavigation")},_renderHeaderBar:function(n){var e=this.model.orientation=="vertical"?1:3,r=t.buildTag("td","",{},{colspan:e}),i=t.buildTag("div.e-datecommondiv").append(t.buildTag("div.e-icon e-navigateprevious","",{},{title:this._getLocalizedLabels("Previous")})).append(t.buildTag("div","",{},{"aria-live":"assertive",tabindex:0}).html(this._getCurrentDateHeaderValue()).addClass("e-datedisplay")).append(t.buildTag("input#"+this._id+"_navigator").css("display","none").addClass("dateCalendar")).append(t.buildTag("div.e-icon e-navigatenext","",{},{title:this._getLocalizedLabels("Next")})),u,f;this._mediaQuery||this.element.width()<600?(this._mediaQuery&&(i=t.buildTag("div.e-datecommondiv").append(t.buildTag("div.e-icon e-navigateprevious","",{},{title:this._getLocalizedLabels("Previous")})).append(t.buildTag("div.e-icon e-navigatenext","",{},{title:this._getLocalizedLabels("Next")}).css("margin-left","5px")).append(t.buildTag("div","",{},{"aria-live":"assertive",tabindex:0}).html(this._getCurrentDateHeaderValue()).addClass("e-datedisplay").css("font-size","18px")).append(t.buildTag("input#"+this._id+"_navigator").css("display","none").addClass("dateCalendar"))),u=t.buildTag("div#"+this._id+"navDrawerIcon.e-mobileNavigation e-icon"),n.append(r.append(t.buildTag("div").css("width","100%").append(i).append(u)))):(f=t.buildTag("div.e-viewsdiv"),n.append(r.append(t.buildTag("div").css("width","100%").append(i).append(f.append(this._renderViewNavigation(this.model.views))))))},_renderViewNavigation:function(n){for(var e=t.buildTag("table.e-table e-viewstable","",{},{cellspacing:"0px",cellpadding:"0px"}),o=t.buildTag("tbody"),u=t.buildTag("tr"),r=n,f,i=0;i<r.length;i++){f=r.length==1?"e-"+r[i].toLowerCase()+" e-singleview":i==0?"e-"+r[i].toLowerCase()+" e-firstview":i==r.length-1?"e-"+r[i].toLowerCase()+" e-lastview":"e-"+r[i].toLowerCase();switch(r[i]){case"day":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("Day"),{},{}).addClass("e-commonviewbutton").addClass(f)));break;case"week":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("Week"),{},{}).addClass("e-commonviewbutton").addClass(f)));break;case"workweek":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("WorkWeek"),{},{}).addClass("e-commonviewbutton").addClass(f)));break;case"month":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("Month"),{},{}).addClass("e-commonviewbutton").addClass(f)));break;case"customview":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("CustomView"),{},{}).addClass("e-commonviewbutton").addClass(f)));break;case"agenda":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("Agenda"),{},{}).addClass("e-commonviewbutton").addClass(f)))}}return e.append(o.append(u)),e},_renderNavigationDrawer:function(){var r,i;if(t.isNullOrUndefined(this._scheduleDrawer)){for(this._scheduleDrawer=t.buildTag("div#"+this._id+"navDrawer.navDrawerMenu e-scheduledrawer"),r="<ul><li data-ej-imageClass='e-icon e-mAddEvent' data-ej-text='"+this._getLocalizedLabels("AddEvent")+"' id='addEvent'><\/li>",i=0;i<this.model.views.length;i++)switch(this.model.views[i]){case"day":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("Day")+"' id='"+this.model.views[i]+"'><\/li>";break;case"week":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("Week")+"' id='"+this.model.views[i]+"'><\/li>";break;case"workweek":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("WorkWeek")+"' id='"+this.model.views[i]+"'><\/li>";break;case"month":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("Month")+"' id='"+this.model.views[i]+"'><\/li>";break;case"customview":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("CustomView")+"' id='"+this.model.views[i]+"'><\/li>";break;case"agenda":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("Agenda")+"' id='"+this.model.views[i]+"'><\/li>"}r+="<\/ul>";this._scheduleDrawer.append(r);this.element.find(".e-scheduleinner").append(this._scheduleDrawer);this._navDrawer=!0;this._scheduleDrawer.ejNavigationDrawer({type:"overlay",targetId:this._id+"navDrawerIcon",direction:this.model.enableRTL?"left":"right",enableListView:!0,listViewSettings:{persistSelection:!0,selectedItemIndex:this.model.views.toString().toLowerCase().split(",").indexOf(this.currentView())+1,width:100,height:"auto",mouseUp:n.proxy(this._slideMenuClick,this)},position:"normal"});this.model.enableRTL&&this._scheduleDrawer.parent().css("left","0px");this._navDrawer=!1}},_slideMenuClick:function(t){var r,u,e,f,i,o;if(this._navDrawer)return!1;if(this._scheduleDrawer.ejNavigationDrawer("close"),r=t.item.find("div").hasClass("e-day")?"day":t.item.find("div").hasClass("e-week")?"week":t.item.find("div").hasClass("e-workweek")?"workweek":t.item.find("div").hasClass("e-month")?"month":t.item.find("div").hasClass("e-customview")?"customview":t.item.find("div").hasClass("e-agenda")?"agenda":"open",r!="open")this._navView=this._navSelected=!0,this.currentView()!=r&&this._viewChange(null,this.currentView(),r),this._navSelected=!1;else if(this.currentView()!="agenda"){for(u=new Date(this.currentDate()),f=0,u=new Date(u.setHours(0,0,0,0)),i=0;i<this.dateRender.length;i++)if(new Date(this.dateRender[i]).getTime()==u.getTime()){f=i;break}o=this.model.orientation=="vertical"?this.model.startHour+(new Date).getHours()*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot):this.res1.length-1;e=this.currentView()!="month"&&this.currentView()!="customview"&&this.model.timeScale.enable?this.element.find(".e-draggableworkarea tr")[o].cells[f]:this.element.find(".e-monthcells")[f];n(e).addClass(".e-selectedCell").trigger(n.Event("click"));this._appointmentWindow({target:e})}},_renderAlertWindow:function(){this._alertWindow=t.buildTag("div.e-alertdialog#"+this._id+"alertWindow");var i="<div><div class='e-alerttext'><\/div><div class='e-alertbtn'><button id='"+this._id+"alertok' type='button' class='e-alertbutton e-alertOk e-buttonactive'>"+this._getLocalizedLabels("Ok")+"<\/button><\/div><\/div>";this._alertWindow.append(i);this.element.append(this._alertWindow);this._alertWindow.find(".e-alertbutton").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._alertClose,this),cssClass:this.model.cssClass});this._alertWindow.ejDialog({width:this._mediaQuery?"75%":450,cssClass:this.model.cssClass,showOnInit:!1,enableRTL:this.model.enableRTL,enableModal:!0,title:this._getLocalizedLabels("RecurrenceAlert"),target:"#"+this._id,enableResize:!1,allowKeyboardNavigation:!1,close:n.proxy(this._alertClose,this)});n("#"+this._id+"alertWindow_wrapper").addClass("e-scheduledialog").find(".e-titlebar").addClass("e-dialogheader")},_alertClose:function(t){this._alertWindow.find(".e-alerttext").html("");t.type=="click"&&t.model.text==this._getLocalizedLabels("Ok")&&this._alertWindow.find(".e-alertCancel").length!=0&&this._deletingAppointment();n("#"+this._id+"alertcancel").length!=0&&n("#"+this._id+"alertcancel").remove();this._alertWindow.ejDialog("close")},_renderAppointmentWindow:function(){var i,r,u,f;this._appointmentAddWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppointmentAddEditWindow");i="<div class='e-appwindow e-windowmargin'><form id='"+this._id+"_AddEditForm'><table class='e-table' width='100%' cellpadding='7'><tbody>";this._mediaQuery?(i+="<tr id='"+this._id+"subjectlabeltr'><td colspan='3' class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("AppointmentSubject")+":<\/td><\/tr><tr id='"+this._id+"subjecttr' class='"+this._id+"subjecttr'><td colspan='3' class='e-rightfields'><input id='"+this._id+"subject' tabIndex='0' class='subject e-inputtext' name='"+this._appointmentSettings.subject+"' type='text' /><input id='id' class='id' type='text' name='"+this._appointmentSettings.id+"' value='' style='display: none'/><\/td><\/tr>",this.model.showLocationField&&(i+="<tr><td colspan='3' class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Location")+":<\/td><\/tr><tr><td colspan='3' class='e-rightfields'><input id='"+this._id+"location' tabIndex='0' class='location e-inputtext' name='"+this._appointmentSettings.location+"' type='text' /><\/td><\/tr>"),i+="<tr id='"+this._id+"_appStartTime'><td class='e-textlabel' colspan='3'>"+this._getLocalizedLabels("StartTime")+":<\/td><\/tr><tr><td width='37%'><input id='"+this._id+"startdate' class='startenddate' type='text' name='StartDate' value='' /><\/td><td width=31%'><input type='text' id='"+this._id+"starttime' class='startendtime' name='StartTime'/><\/td>",this.model.showTimeZoneFields&&(i+="<td width='31%'><input id='"+this._id+"startTimeZone' class='startutc'  name='"+this._appointmentSettings.startTimeZone+"' type='text' value=''/><div id='Timezoneliststr'><\/div><\/td>"),i+="<\/tr>",i+="<tr id='"+this._id+"_appEndTime'><td class='e-textlabel' colspan='3'>"+this._getLocalizedLabels("EndTime")+":<\/td><\/tr><tr><td><input id='"+this._id+"enddate' class='startenddate' type='text' name='EndDate' value='' /><\/td><td><input type=''text' id='"+this._id+"endtime' class='startendtime' name='EndTime'/><\/td>",this.model.showTimeZoneFields&&(i+="<td><input  id='"+this._id+"endTimeZone' class='endutc' name='"+this._appointmentSettings.endTimeZone+"' type='text' value=''/><div id='Timezonelistend'><\/div><\/td>"),i+="<\/tr>",this.model.prioritySettings.enable&&(i+="<tr><td class='e-leftfields e-textlabel' colspan='3'>"+this._getLocalizedLabels("Priority")+":<\/td><\/tr><tr><td colspan='3' class='e-rightfields'><input id= '"+this._id+"priority' class='priority' type='text' name='"+this._appointmentSettings.priority+"' value=''/><div id='prioritylist'><\/div><\/td><\/tr>"),i+="<tr class='"+this._id+"parrow'><td class='"+this._id+"allDay' colspan='3'><table class='e-table' cellpadding='3'><tr><td><div class='e-allday e-checkboxmargin'><input id='"+this._id+"allday' tabIndex='0' class='allday' type='checkbox' name='"+this._appointmentSettings.allDay+"'/><\/div><\/td><td><div class='e-alldaytext'><label for='"+this._id+"allday'>"+this._getLocalizedLabels("AllDay")+"<\/label><\/div><\/td><td><div class='e-checkboxmargin e-recurrence'><input id='"+this._id+"recurrence' tabIndex='0' class='recurrence' type='checkbox' name='"+this._appointmentSettings.recurrence+"' value='recurrence'/><\/div><\/td><td><label class='e-repeatlbl' for='"+this._id+"recurrence'>"+this._getLocalizedLabels("Recurrence")+"<\/label><\/td><\/tr><\/table><\/td><\/tr>",i+="<tr id='"+this._id+"summary' class='"+this._id+"summary' style='display:none'><td class='e-textlabel'><label>"+this._getLocalizedLabels("Summary")+":<\/label><\/td><\/tr><tr class='"+this._id+"summary' style='display:none'><td colspan='4'><table><tr><td><label class='e-recurFinalRule'><\/label><\/td><td><div class='e-recuredit'><a class='e-recuredit' href='#'>"+this._getLocalizedLabels("Edit")+"<\/a><span class='e-icon e-edit_01 e-scheduleedit'><\/span><\/div><\/td><\/tr><\/table><\/td><\/tr>",this.model.categorizeSettings.enable&&(i+="<tr id='"+this._id+"categorizetr'><td class='e-leftfields e-textlabel' colspan='3'>"+this._getLocalizedLabels("Categorize")+":<\/td><\/tr><tr><td colspan='3' class='e-rightfields'><input id= '"+this._id+"categorize' name='"+this._appointmentSettings.categorize+"' class='e-categorizevalue' type='text' value=''/><\/td><\/tr>"),this._tempResource.length!=0&&this._tempResource.length>0&&t.scheduleFeatures.resources&&(i=this._renderResourceElements(i)),i+="<tr><td colspan='3'><textarea class='e-description e-inputtext' id='"+this._id+"description' name='"+this._appointmentSettings.description+"'><\/textarea><\/td><\/tr>",i+="<\/tbody><\/table><\/form>",i+="<div class='e-floatright' style='width:100%'><table width='100%' class='e-table' cellpadding='5'><tr><td width='30%'><div class='e-btnmargin e-floatleft'><button id='mDelete' class='e-btndelete e-appdelete'>"+this._getLocalizedLabels("Delete")+"<\/button><\/div><\/td><td width='30%'><div class='e-btnmargin e-floatleft'><button id='done' class='e-btndone e-appsave e-buttonactive'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td width='30%'><div class='e-btnmargin e-floatleft'><button id='cancel' class='e-appointcancel cancel'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div><\/div>"):(i+="<tr  id='"+this._id+"subjecttr' class='"+this._id+"subjecttr'><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("AppointmentSubject")+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"subject' tabIndex='0' class='subject e-inputtext' name='"+this._appointmentSettings.subject+"' type='text' /><input id='id' class='id' type='text' name='"+this._appointmentSettings.id+"' value='' style='display: none'/><\/td><\/tr>",this.model.showLocationField&&(i+="<tr id='"+this._id+"showLocation' class='"+this._id+"showLocation'><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Location")+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"location' tabIndex='0' class='location e-inputtext' name='"+this._appointmentSettings.location+"' type='text' /><\/td><\/tr>"),i+="<tr id='"+this._id+"_appStartTime'><td class='e-textlabel'>"+this._getLocalizedLabels("StartTime")+":<\/td><td width='25%'><input id='"+this._id+"startdate' class='startenddate' type='text' name='StartDate' value='' /><\/td><td width=22%'><input type='text' id='"+this._id+"starttime' class='startendtime' name='StartTime'/><\/td>",this.model.showTimeZoneFields&&(i+="<td width='28%'><input  id='"+this._id+"startTimeZone'  class='startutc'  name='"+this._appointmentSettings.startTimeZone+"' type='text' value=''/><div id='Timezoneliststr'><\/div><\/td>"),i+="<\/tr>",i+="<tr id='"+this._id+"_appEndTime'><td class='e-textlabel'>"+this._getLocalizedLabels("EndTime")+":<\/td><td><input id='"+this._id+"enddate' class='startenddate' type='text' name='EndDate' value='' /><\/td><td><input type=''text' id='"+this._id+"endtime' class='startendtime' name='EndTime'/><\/td>",this.model.showTimeZoneFields&&(i+="<td><input id='"+this._id+"endTimeZone'  class='endutc'  name='"+this._appointmentSettings.endTimeZone+"'  type='text' value=''/><div id='Timezonelistend'><\/div><\/td>"),i+="<\/tr>",r=this.model.prioritySettings.enable?"<td colspan='1' class='e-textlabel "+this._id+"priorityshow'>"+this._getLocalizedLabels("Priority")+":<\/td><td colspan='1' class='"+this._id+"prioritylistshow'><input id='"+this._id+"priority' class='priority' type='text' name='"+this._appointmentSettings.priority+"' value='' /><div id='prioritylist'><\/div><\/td>":"",i+="<tr class='"+this._id+"parrow'>"+r+"<td class='"+this._id+"allDay' colspan='4'><table class='e-table' cellpadding='3'><tr><td><div class='e-allday e-checkboxmargin'><input id='"+this._id+"allday' tabIndex='0' class='allday' type='checkbox' name='"+this._appointmentSettings.allDay+"'/><\/div><\/td><td><div class='e-alldaytext'><label for='"+this._id+"allday'>"+this._getLocalizedLabels("AllDay")+"<\/label><\/div><\/td><td><div class='e-checkboxmargin e-recurrence'><input id='"+this._id+"recurrence' tabIndex='0' class='recurrence' type='checkbox' name='"+this._appointmentSettings.recurrence+"' value='recurrence'/><\/div><\/td><td><label class='e-repeatlbl' for='"+this._id+"recurrence'>"+this._getLocalizedLabels("Recurrence")+"<\/label><\/td><\/tr><\/table><\/td><\/tr>",i+="<tr id='"+this._id+"summary' class='"+this._id+"summary' style='display:none'><td class='e-textlabel'><label>"+this._getLocalizedLabels("Summary")+":<\/label><\/td><td colspan='3'><table><tr><td><label class='e-recurFinalRule'><\/label><\/td><td><div class='e-recuredit'><a class='e-recuredit' href='#'>"+this._getLocalizedLabels("Edit")+"<\/a><span class='e-icon e-edit_01 e-scheduleedit'><\/span><\/div><\/td><\/tr><\/table><\/td><\/tr>",this.model.categorizeSettings.enable&&(i+="<tr id='"+this._id+"categorizetr'><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Categorize")+":<\/td><td colspan='3' class='e-rightfields'><input id= '"+this._id+"categorize' name='"+this._appointmentSettings.categorize+"' class='e-categorizevalue' type='text' value=''/><\/td><\/tr>"),this._tempResource.length!=0&&this._tempResource.length>0&&t.scheduleFeatures.resources&&(i=this._renderResourceElements(i)),i+="<tr><td colspan='4'><textarea class='e-description e-inputtext' id='"+this._id+"description' name='"+this._appointmentSettings.description+"'><\/textarea><\/td><\/tr>",i+="<\/tbody><\/table><\/form>",i+="<div class='e-floatright'><table class='e-table' cellpadding='5'><tr><td><div class='e-btnmargin e-floatleft'><button id='done' class='e-btndone e-appsave e-buttonactive'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div class='e-btnmargin e-floatleft'><button id='cancel' class='e-appointcancel cancel'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div><\/div>");u=t.buildTag("div.e-recurEditor#"+this._id+"recurrenceEditor").ejRecurrenceEditor({selectedRecurrenceType:1,frequencies:["daily","weekly","monthly","yearly","everyweekday"],startDate:this.currentDate(),minDate:this.model.minDate,maxDate:this.model.maxDate,firstDayOfWeek:this.model.firstDayOfWeek,enableRTL:this.model.enableRTL,cssClass:this.model.cssClass,dateFormat:this.model.dateFormat,locale:this.model.locale});f="<div class='e-floatright'><table class='e-table' cellpadding='5'><tr><td><div class='e-btnmargin e-floatleft'><button id='"+this._id+"donerecur'  class='recurbutton e-buttonactive'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div class='e-btnmargin e-floatleft'><button id='"+this._id+"cancelrecur' class='e-cancelrecur recurbutton'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div>";this._appointmentAddWindow.append(i).append(u);this._appointmentAddWindow.find(".e-recurEditor").append(f);this._appointmentAddWindow.find("#"+this._id+"donerecur").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._closeRecurence,this),cssClass:this.model.cssClass});this._appointmentAddWindow.find("#"+this._id+"cancelrecur").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._closeRecurence,this),cssClass:this.model.cssClass});this._appointmentAddWindow.find(".e-recurEditor").css("display","none");this.element.append(this._appointmentAddWindow);this._renderControls();this._appointmentAddWindow.ejDialog({width:this._mediaQuery?"100%":600,cssClass:this.model.cssClass,showOnInit:!1,enableRTL:this.model.enableRTL,enableModal:!0,title:this._getLocalizedLabels("CreateAppointmentTitle"),target:"#"+this._id,enableResize:!1,allowKeyboardNavigation:!1,close:n.proxy(this._onclose,this)});n("#"+this._id+"AppointmentAddEditWindow_wrapper").appendTo("body").addClass("e-scheduledialog").find(".e-titlebar").addClass("e-dialogheader");n("#"+this._id+"priority_popup_wrapper").addClass("e-schedulepriority");this._on(this._appointmentAddWindow,"click","a.e-recuredit",n.proxy(this._editRecurrence,this));this._mediaQuery&&this._appointmentAddWindow.ejDialog("refresh")},_refreshAppointmentWindow:function(){this._destorySubControls(n("#"+this._id+"_AddEditForm"));this._destorySubControls(n("#"+this._id+"_RecurForm"));n("#"+this._id+"AppointmentAddEditWindow_wrapper").remove();this._renderAppointmentWindow();n.isFunction(n.validator)&&this._setValidation()},_renderQuickAppWindow:function(){var i,r;this._quickAppointWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppointmentQuickWindow");i="<div id='"+this._id+"_quickAppwindow' class='e-tableAppoint'><table cellpadding='7' class='e-qappwindow'><tbody>";i+="<tr><td colspan='2'><div class='e-quickstartend'><\/div> <div title='"+this._getLocalizedLabels("Close")+"'class='e-icon e-scheduleclose e-schedclosemargin e-pointercursor'><\/div><\/td><\/tr><tr><td class='e-subjectlabel'>"+this._getLocalizedLabels("AppointmentSubject")+":<\/td><td colspan='2' class='e-rightfields'><form id='"+this._id+"_AddForm' onsubmit='return false;'><input id='"+this._id+"subject' class='subject e-inputtext' name='"+this._appointmentSettings.subject+"'  type='text' /><\/form><\/td><\/tr><\/tbody><\/table>";i+="<div style='margin-top:5px; padding-bottom: 30px;'><div tabIndex='0' class='e-detailedapp e-detailedwindow'> "+this._getLocalizedLabels("Detailed")+" >><\/div><div style='margin-right:-3px;' class='e-floatright'><div class='e-quickAppDone'><button id='done' class='e-btndone qAppDone e-buttonactive' style='font-size:12px !important;'>"+this._getLocalizedLabels("CreateAppointmentTitle")+"<\/button><\/div><\/div><\/div><\/div>";this._quickAppointWindow.append(i);this.element.append(this._quickAppointWindow);this._quickAppointWindow.append(t.buildTag("div.e-quickarrow").append("<div class='e-outerarrowline'><\/div>").append("<div class='e-innerarrow'><\/div>"));r=this._quickAppointWindow;r.find(".e-btndone").ejButton({showRoundedCorner:!0,width:"130px",click:n.proxy(this._saveAppointment,this),cssClass:this.model.cssClass,enableRTL:this.model.enableRTL});this._on(r.find(".e-scheduleclose"),"click",n.proxy(this._quickWindowClose,this));this._on(r.find(".e-detailedapp"),"click",n.proxy(this._appointmentWindow,this));this._quickAppointWindow.ejDialog({width:330,minHeight:0,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,enableAnimation:!1,showOnInit:!1,enableResize:!1,allowDraggable:!1,showHeader:!1,allowKeyboardNavigation:!1,close:n.proxy(function(){this._processFocus()},this)});n("#"+this._id+"AppointmentQuickWindow_wrapper").addClass("e-scheduledialog e-schedulequickdialog").css("overflow","visible").find("#"+this._id+"AppointmentQuickWindow").addClass("e-dialogouter")},_renderQuickAppDetailsView:function(){this._quickAppDetailsWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppDetailsWindow");var i="<div id='"+this._id+"_quickAppDetailswindow' class='e-tableAppoint e-appdetails'><table cellpadding='1' class='e-qappwindow'><tbody>";i+="<tr><td colspan='2'><div class='e-quicksubject e-textellipsis'><\/div> <div title='"+this._getLocalizedLabels("Close")+"' class='e-icon e-scheduleclose e-schedclosemargin e-pointercursor'><\/div><\/td><\/tr><tr><td colspan='2' class='e-rightfields'><\/td><\/tr><tr><td colspan='2'><div class='e-quickstartendtime'><\/div><\/td><\/tr><\/tbody><\/table>";i+="<div style='margin-top:5px;'><div title='"+this._getLocalizedLabels("Delete")+"' class='e-icon e-delete e-scheduledelete e-pointercursor' tabIndex='0'><\/div><div class='e-floatright'><div class='e-editevents'><div class='e-editevent e-textellipsis' tabIndex='0'>"+this._getLocalizedLabels("Editevent")+" | <\/div><div class='e-editseries e-textellipsis' tabIndex='0'>"+this._getLocalizedLabels("Editseries")+" >><\/div> <\/div><\/div><\/div><\/div>";this._quickAppDetailsWindow.append(i);this.element.append(this._quickAppDetailsWindow);this._quickAppDetailsWindow.append(t.buildTag("div.e-quickarrow").append("<div class='e-outerarrowline'><\/div>").append("<div class='e-innerarrow'><\/div>"));this._on(this._quickAppDetailsWindow.find(".e-scheduleclose"),"click",n.proxy(this._quickAppDetailWindowClose,this));this._on(this._quickAppDetailsWindow.find(".e-scheduledelete"),"click",n.proxy(this._deleteAppoint,this));this._on(this._quickAppDetailsWindow.find(".e-editevent,.e-editseries"),"click",n.proxy(this._editClick,this));this._quickAppDetailsWindow.ejDialog({width:270,minHeight:0,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,enableAnimation:!1,showOnInit:!1,enableResize:!1,allowDraggable:!1,showHeader:!1,allowKeyboardNavigation:!1,close:n.proxy(function(){this._processFocus()},this)});n("#"+this._id+"AppDetailsWindow_wrapper").addClass("e-scheduledialog e-schedulequickdialog").css("overflow","visible").find("#"+this._id+"AppDetailsWindow").addClass("e-dialogouter")},_editClick:function(i){if(n(i.target).hasClass("e-editseries")&&this._quickAppDetailsWindow.find(".e-editseries").hasClass("e-disable"))return!1;var u=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),r=new t.DataManager(this._processed).executeLocal(u);n(i.target).hasClass("e-editevent")?r[0][this._appointmentSettings.recurrence]==1?(this._parentId=r[0].ParentId,this._currentAction=t.Schedule.Actions.EditOccurrence,this._showAppointmentDetails(this._appUid,!0)):t.isNullOrUndefined(r[0][this._appointmentSettings.recurrence])?(this._currentAction=t.Schedule.Actions.Save,this._showAppointmentDetails(this._appUid,!0)):(this._currentAction=t.Schedule.Actions.Save,this._showAppointmentDetails(r[0].Guid,!0)):n(i.target).hasClass("e-editseries")&&r[0][this._appointmentSettings.recurrence]==1&&(this._parentId=r[0][this._appointmentSettings.recurrenceId]==null?r[0].ParentId:r[0][this._appointmentSettings.recurrenceId],this._currentAction=t.Schedule.Actions.EditSeries,this._showAppointmentDetails(this._parentId,!1));this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close")},_deleteAppoint:function(i){var r,f,u;this.model.readOnly||(t.isNullOrUndefined(i)||!t.isNullOrUndefined(this._quickAppDetailsWindow)&&this._quickAppDetailsWindow.ejDialog("isOpen")?(u=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),u[0][this._appointmentSettings.recurrence]||!this.model.showDeleteConfirmationDialog?(this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("isOpen")&&this._quickAppDetailsWindow.ejDialog("close"),this._deletingAppointment()):this._deleteConfirmation()):(r=n(i.target).parent(),f=r.hasClass("e-appointment")||r.hasClass("e-monthappointment")||r.hasClass("e-alldayappointment")||r.hasClass("e-agendaappointment")?r:r.parents(".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment"),this._appUid=f.attr("guid"),this._mediaQuery&&(this._mAppId=this._appUid),u=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),u[0][this._appointmentSettings.recurrence]||!this.model.showDeleteConfirmationDialog?this._deletingAppointment():this._deleteConfirmation()))},_deletingAppointment:function(){if(this._appUid=t.isNullOrUndefined(this._appUid)?this._deleteUid:this._appUid,this._appUid){this._currentAction=t.Schedule.Actions.Delete;var n=this._getAppointmentByParentId(this._mediaQuery?t.isNullOrUndefined(this._mAppId)?this._appUid:this._mAppId:this._appUid);n[this._appointmentSettings.recurrence]?(this._parentId=n.ParentId,this._recurEditWindow.ejDialog("open"),this._recurEditWindow.focus(),this._deleteBeforeOpen()):this._deleteApp(this._mediaQuery?t.isNullOrUndefined(this._mAppId)?this._appUid:this._mAppId:this._appUid)}t.isNullOrUndefined(this._alertWindow)||this._alertWindow.ejDialog("close")},_deleteConfirmation:function(){if(this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close"),t.isNullOrUndefined(this._alertWindow)&&this._renderAlertWindow(),n(".e-alertbtn").find(".e-alertCancel").length==0){var i="<button id='"+this._id+"alertcancel' class='e-alertbutton e-alertCancel'>"+this._getLocalizedLabels("Cancel")+"<\/button>";this._alertWindow.find(".e-alertbtn").append(i);this._alertWindow.find(".e-alertCancel").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._alertClose,this),cssClass:this.model.cssClass});this._mediaQuery&&this._alertWindow.find(".e-alertCancel").css({margin:"0px 20px 15px 10px"});n("#"+this._id+"alertWindow").ejDialog({width:this._mediaQuery?"90%":450,title:this._getLocalizedLabels("MouseOverDeleteTitle")});this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("DeleteConfirmation"));this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Delete"))}this._alertWindow.ejDialog("isOpen")||(this._alertWindow.ejDialog("open"),this._alertWindow.find(".e-alertOk").attr("tabIndex",0).focus())},_quickAppDetailWindowClose:function(){this._quickAppDetailsWindow.ejDialog("close");this._processFocus()},_alldayCheck:function(){if(this._appointmentAddWindow.find(".allday").ejCheckBox("option","checked"))this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker({value:this._timeMode=="12"?"12:00 AM":"00:00",enabled:!1}),this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker({value:this._timeMode=="12"?"11:59 PM":"23:59",enabled:!1}),this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList({enabled:!1});else{if(this._tempStart!=""||this._tempEnd!=""){var n=t.format(new Date((new Date).setHours(0,0,0)),this._pattern.t),i=t.format(new Date((new Date).setHours(23,59,59)),this._pattern.t);this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker({value:this._tempStart});this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker({value:this._tempEnd});(this._timeMode=="12"?this._tempStart==n&&this._tempEnd==i:this._tempStart=="00:00"&&this._tempEnd=="23:59")&&(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker({value:t.format(new Date("1/1/2000 "+this.model.workHours.start+":00:00"),this._pattern.t)}),this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker({value:t.format(new Date("1/1/2000 "+this.model.workHours.start+":30:00"),this._pattern.t)}))}this._appointmentAddWindow.find(".startendtime").ejTimePicker({enabled:!0});this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList({enabled:!0});this._endSlotChange=!0;this._startSlotChange=!0}},_renderRecurEditWindow:function(){this._recurEditWindow=t.buildTag("div.e-scheduledialog#"+this._id+"RecurrenceEdit");var f=t.buildTag("div.e-recureditmsg",this._getLocalizedLabels("RecurrenceEditMessage")),i=this._getLocalizedLabels("RecurrenceEditOnly"),r=this._getLocalizedLabels("RecurrenceEditSeries"),u=t.buildTag("div.e-recureditbtns").append(t.buildTag("button.e-editonly#"+this._id+"Editonly",i,{},{name:"recurrenceeditonly",value:i})).append(t.buildTag("button.e-editseries#"+this._id+"EditSeries",r,{},{name:"recurrenceeditseries",value:r}));this._recurEditWindow.append(f).append(u);u.find(".e-editonly,.e-editseries").ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,showRoundedCorner:!0});this._on(this._recurEditWindow,"click",".e-editonly,.e-editseries",n.proxy(this._recurBtnClick,this));this._on(this._recurEditWindow,"click","div.e-scheduleclose",n.proxy(this._recrConformClose,this));this._recurEditWindow.appendTo(this.element);this._mediaQuery&&this._recurEditWindow.find(".e-editonly,.e-editseries").css({"margin-top":"10px"});this._recurEditWindow.ejDialog({width:this._mediaQuery?"90%":360,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,title:this._getLocalizedLabels("RecurrenceEditTitle"),showOnInit:!1,enableModal:!0,enableResize:!1,target:"#"+this._id,allowKeyboardNavigation:!1,close:n.proxy(this._processFocus,this),beforeOpen:n.proxy(this._deleteBeforeOpen,this)});n("#"+this._id+"RecurrenceEdit_wrapper").appendTo("body").addClass("e-scheduledialog")},_recrConformClose:function(){this._recurEditWindow.ejDialog("close");this._processFocus()},_deleteBeforeOpen:function(){n("#"+this._id+"RecurrenceEdit_title").addClass("e-dialogheader");n("#"+this._id+"RecurrenceEdit_title").find(".e-title").html(this._currentAction==t.Schedule.Actions.Delete?this._getLocalizedLabels("RecurrenceDeleteTitle"):this._getLocalizedLabels("RecurrenceEditTitle"))},_recurBtnClick:function(r){var u,h,s,v,f,o,e,l,a;if(n(r.target).hasClass("e-editonly"))if(this._editOnlyClicked=!0,this._currentAction==t.Schedule.Actions.Delete){if(u=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],u[this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1){if(this._trigger("actionBegin",{id:this._appUid,requestType:"appointmentDelete",currentAction:t.Schedule.Actions.DeleteOccurrence})||(h=u[this._appointmentSettings.recurrenceId]==null?u.ParentId:u[this._appointmentSettings.recurrenceId],s=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,h)),this._trigger("beforeAppointmentRemove ",{appointment:s,currentAction:t.Schedule.Actions.DeleteOccurrence})))return!1;f=this.dataSource()instanceof t.DataManager?this._dataManager.remove(this._appointmentSettings.id,u[this._appointmentSettings.id],this.model.appointmentSettings.query._fromTable):this._dataManager.remove("Guid",u.Guid);e=this;n.isFunction(f.promise)?(f.done(function(n){e._processUrlBinding(n);e._trigger("appointmentRemoved",{appointment:s,requestType:"appointmentDeleted",currentAction:t.Schedule.Actions.DeleteOccurrence});e._trigger("actionComplete",{appointment:s,requestType:"appointmentDelete",currentAction:t.Schedule.Actions.DeleteOccurrence})}),f.fail(function(){})):(v=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),new t.DataManager(this._processed).saveChanges({added:[],changed:[],deleted:v},"Guid"),this._renderAppointmentAll(),this._trigger("appointmentRemoved",{appointment:s,requestType:"appointmentDeleted",currentAction:t.Schedule.Actions.DeleteOccurrence}),this._trigger("actionComplete",{appointment:s,requestType:"appointmentDelete",currentAction:t.Schedule.Actions.DeleteOccurrence}))}else{if(this._trigger("actionBegin",{id:this._appId,requestType:"appointmentDelete",currentAction:t.Schedule.Actions.DeleteOccurrence}))return!1;var h=u[this._appointmentSettings.recurrenceId]==null?u.ParentId:u[this._appointmentSettings.recurrenceId],y=this._deleteOcurrence(h,u[this._appointmentSettings.startTime]),c=this._timeZoneAppointments(y[0],"");if(this._trigger("beforeAppointmentRemove",{appointment:u,currentAction:t.Schedule.Actions.DeleteOccurrence}))return this._recurEditWindow.ejDialog("close"),!1;if(f=this.dataSource()instanceof t.DataManager?this._dataManager.update(this._appointmentSettings.id,c,this.model.appointmentSettings.query._fromTable):this._dataManager.update("AppTaskId",c),o=this._timeZoneAppointments(c,"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",o),e=this,f&&n.isFunction(f.promise)&&this.dataSource()instanceof t.DataManager)f.done(function(n){e._processUrlBinding(n);e._trigger("appointmentRemoved",{appointment:u,requestType:"appointmentDeleted",currentAction:t.Schedule.Actions.DeleteOccurrence});e._trigger("actionComplete",{appointment:u,requestType:"appointmentDelete",currentAction:t.Schedule.Actions.DeleteOccurrence})}),f.fail(function(){});else{if(this._refreshCellsHeight(),new Date(new Date(o[this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(o[this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(o[this._appointmentSettings.endTime]-o[this._appointmentSettings.startTime])/36e5<24&&o[this._appointmentSettings.allDay]!==!0)for(l=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),i=0;i<l.length;i++)new t.DataManager(this._processed).remove("Guid",l[i].Guid);else new t.DataManager(this._processed).remove("Guid",this._appUid),this._appUid=null;this._renderAppointmentAll();this._trigger("appointmentRemoved",{appointment:u,requestType:"appointmentDeleted",currentAction:t.Schedule.Actions.DeleteOccurrence});this._trigger("actionComplete",{appointment:u,requestType:"appointmentDelete",currentAction:t.Schedule.Actions.DeleteOccurrence})}}a=this._appointmentCount();a.length<1&&this.model.showAppointmentNavigator&&this._nextPrevButton(a)}else this._currentAction=t.Schedule.Actions.EditOccurrence,this._showAppointmentDetails(this._appUid,!0);else this._editOnlyClicked=!1,this._currentAction==t.Schedule.Actions.Delete?(this._actionType=t.Schedule.Actions.DeleteSeries,this._deleteApp(this._appUid)):(this._currentAction=t.Schedule.Actions.EditSeries,this._showAppointmentDetails(this._parentId,!1));this._recurEditWindow.ejDialog("close")},_repeat:function(n){var i,r;n.isInteraction&&(n.isChecked||this._recurChecked?this._currentAction==t.Schedule.Actions.EditSeries||this._appointmentAddWindow.find(".e-recurFinalRule").html()!=""?this._appointmentAddWindow.find("."+this._id+"summary").css("display","table-row"):(this._mediaQuery&&this._appointmentAddWindow.parent().parent().find(".e-dialog-icon").css("display","none"),this._appointmentAddWindow.find(".e-appwindow").toggle(),this._appointmentAddWindow.find(".e-recurEditor").css("margin-left",700).toggle().animate({"margin-left":10},400),i=this._appointmentAddWindow.find(".e-recurrenceeditor").data("ejRecurrenceEditor"),i.clearRecurrenceFields(),this._appointmentAddWindow.find(".e-recurEditor").css("display","block"),r=new Date(this._appointmentAddWindow.find(".startenddate").ejDatePicker("option","value")),i.model.startDate=r,i.setDefaultValues()):(this._currentAction==t.Schedule.Actions.EditSeries||this._appointmentAddWindow.find(".e-recurFinalRule").html()!="")&&this._appointmentAddWindow.find("."+this._id+"summary").css("display","none"),this._recurChecked=!1)},_resourceDaysReorder:function(n){var c=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],f=[],r=[],e=[],h=[],o=this._firstdayofweek,s,i,u;do o>6&&(o=0),f.push(c[o]),o++;while(f.length<7);for(s=0;s<n.length;s++)r.push(n[s].toLowerCase());for(i=0;i<r.length;i++)f.indexOf(r[i])!=-1&&(e[f.indexOf(r[i])]=r[i]);for(u=0;u<e.length;u++)t.isNullOrUndefined(e[u])||h.push(e[u]);return h},_getRenderDates:function(){var v,h,y,p,o,a,c,w,g,s,b,k,d,nt,tt,u,it;this._dateRender=[];var e,f,i=[],l=[];if(this.currentView()==="week"||this.currentView()==="workweek"){if(e=this._firstweekdate(this.currentDate()),e.getDay()!=0||this._firstdayofweek==0&&this.model.workWeek.length>0&&this.currentView()=="workweek"||this.currentView()=="week"){for(u=0;u<7;u++)f=new Date(e),f.setDate(e.getDate()+u),this._dateRender.push(new Date(f.getFullYear(),f.getMonth(),f.getDate()).getTime());this._renderDates=n.extend(!0,[],this._dateRender)}if(this._resWorkWeek){if(this._tempResource.length>1){for(v=this._resourceSort(),h=[],x=0;x<v.length;x++)c=this._tempResource[this._tempResource.length-1].resourceSettings.dataSource.indexOf(v[x]),c!=-1&&h.push(v[x]);this.res1=h}else h=this._tempResource[this._tempResource.length-1].resourceSettings.dataSource;for(y=[],p=0;p<h.length;p++)if(o=h[p][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek],t.isNullOrUndefined(o))w=n.extend(!0,[],this._dateRender),w=w.filter(function(n){return new Date(n).getDay()!=0&&new Date(n).getDay()!=6}),n.merge(y,w);else for(o=this._resourceDaysReorder(o),a=0;a<o.length;a++)c=this._dayFullNames.indexOf(o[a].capitalizeFirstString()),c==-1&&(c=this._getDayNameIndex(o[a])),y.push(this._renderDates[c]);this.dateRender=this._dateRender=y}else if(this.currentView()=="workweek")if(this.model.workWeek[0]=="monday"&&this.model.workWeek[4]=="friday"&&t.isNullOrUndefined(this.model.workWeek[5]))this._dateRender=this._dateRender.filter(function(n){return new Date(n).getDay()!=0&&new Date(n).getDay()!=6});else{for(g=this,i=this.model.workWeek.map(function(n){return g._dayNamesArray.indexOf(n)}),s=0;s<i.length;s++)if(this._firstdayofweek>=i[0]){if(this._firstdayofweek<=i[s]){b=i[s];break}}else if(this._firstdayofweek>i[s]){b=i[s];break}for(u=0,k=0;u<i.length;u++)b<=i[u]&&(l[k]=i[u],k++);l=n.merge(l,i);d=this._firstdayofweek!=0&&this._firstdayofweek<=b?l:i;l=n.grep(d,function(t,i){return i===n.inArray(t,d)});nt=this._dateRender.map(function(n){if(i.indexOf(new Date(n).getDay())!=-1)return n});this._dateRender=nt.filter(function(n){return n!=r})}}else if(this.currentView()==="month")this._dateRender=this._monthdates();else if(this.currentView()==="customview")if(t.isNullOrUndefined(this.model.renderDates))it=this._monthdates(),this._dateRender=this.model.orientation=="vertical"?it:this.monthDays;else for(this._setCurrentDate&&this.model.orientation!="horizontal"&&(this.oldDate=this.currentDate(),this._renderStart.getTime()<this.currentDate().getTime()&&this._renderEnd.getTime()>this.currentDate().getTime()?this.currentDate(new Date(this._renderStart)):(this._renderStart=new Date(this.currentDate()),this._renderEnd=new Date(this._renderStart.getTime()+(this._renderDays-1)*864e5))),tt=this._renderDays<=7?this._renderDays:this._numDays,e=this._renderDays<=7?new Date(this.currentDate()):this.model.orientation=="vertical"?this._firstweekdate(this.currentDate()):new Date(this.currentDate()),u=0;u<tt;u++)f=new Date(e),f.setDate(e.getDate()+u),this._dateRender.push(new Date(f.getFullYear(),f.getMonth(),f.getDate()).getTime());else this._dateRender.push(new Date(this.currentDate()).setHours(0,0,0,0));return this._dateRender},_getCurrentDateHeaderValue:function(){var i,n=this._resWorkWeek?this._renderDates:this._dateRender,r;return this.currentView()==="day"?i=this._dayShortNames[new Date(n[0]).getDay()]+" "+new Date(n[0]).getDate()+" "+t.format(new Date(n[0]),"MMM")+" "+new Date(n[0]).getFullYear():this.currentView()==="week"||this.currentView()==="workweek"?new Date(n[0]).getYear()===new Date(n[n.length-1]).getYear()?new Date(n[0]).getMonth()===new Date(n[n.length-1]).getMonth()?i=t.format(new Date(n[0]),"dd")+" - "+t.format(new Date(n[n.length-1]),"dd MMM yyyy"):new Date(n[0]).getMonth()!==new Date(n[n.length-1]).getMonth()&&(i=this.model.enableRTL?t.format(new Date(n[n.length-1]),"MMM dd")+" - "+t.format(new Date(n[0]),"dd MMM yyyy"):t.format(new Date(n[0]),"dd MMM")+" - "+t.format(new Date(n[n.length-1]),"dd MMM yyyy")):i=t.format(new Date(n[0]),"MMM dd yyyy")+" - "+t.format(new Date(n[n.length-1]),"MMM dd yyyy"):this.currentView()==="customview"?n.length==1?i=this._dayShortNames[new Date(n[0]).getDay()]+" "+new Date(n[0]).getDate()+" "+t.format(new Date(n[0]),"MMM")+" "+new Date(n[0]).getFullYear():n.length>1&&n.length<=7?new Date(n[0]).getYear()===new Date(n[n.length-1]).getYear()?new Date(n[0]).getMonth()===new Date(n[n.length-1]).getMonth()?i=t.format(new Date(n[0]),"dd")+" - "+t.format(new Date(n[n.length-1]),"dd MMM yyyy"):new Date(n[0]).getMonth()!==new Date(n[n.length-1]).getMonth()&&(i=this.model.enableRTL?t.format(new Date(n[n.length-1]),"MMM dd")+" - "+t.format(new Date(n[0]),"dd MMM yyyy"):t.format(new Date(n[0]),"dd MMM")+" - "+t.format(new Date(n[n.length-1]),"dd MMM yyyy")):i=t.format(new Date(n[0]),"MMM dd yyyy")+" - "+t.format(new Date(n[n.length-1]),"MMM dd yyyy"):i=new Date(n[0]).getFullYear()==new Date(n[n.length-1]).getFullYear()?new Date(n[0]).getMonth()==new Date(n[n.length-1]).getMonth()?t.format(new Date(this.currentDate()),"MMM yyyy"):t.format(new Date(n[0]),"MMM")+" - "+t.format(new Date(n[n.length-1]),"MMM yyyy"):t.format(new Date(n[0]),"MMM yyyy")+" - "+t.format(new Date(n[n.length-1]),"MMM yyyy"):this.currentView()==="agenda"?(n=new Date(this.currentDate()),r=this.model.agendaViewSettings.daysInAgenda>0?this.model.agendaViewSettings.daysInAgenda-1:0,new Date(n).getYear()===new Date(new Date(n).setDate(n.getDate()+r)).getYear()?new Date(n).getMonth()===new Date(new Date(n).setDate(n.getDate()+r)).getMonth()?i=t.format(new Date(n),"dd")+" - "+t.format(new Date(new Date(n).setDate(n.getDate()+r)),"dd MMM yyyy"):new Date(n).getMonth()!==new Date(new Date(n).setDate(n.getDate()+r)).getMonth()&&(i=this.model.enableRTL?t.format(new Date(new Date(n).setDate(n.getDate()+r)),"MMM dd")+" - "+t.format(new Date(n),"dd MMM yyyy"):t.format(new Date(n),"dd MMM")+" - "+t.format(new Date(new Date(n).setDate(n.getDate()+r)),"dd MMM yyyy")):i=t.format(new Date(n),"MMM dd yyyy")+" - "+t.format(new Date(new Date(n).setDate(n.getDate()+r)),"MMM dd yyyy")):i=t.format(new Date(this.currentDate()),"MMM yyyy"),i},_firstweekdate:function(n){var t=new Date(n),i=t.getDay(),r,u;return this._firstdayofweek==0?i!=0&&(t.setDate(t.getDate()-i),!this.model.timeScale.enable&&(this.currentView()=="workweek"||this._oneWeek)&&this._resize&&(t=new Date(this._dateRender[0]))):this._firstdayofweek!=0&&(i=this._firstdayofweek-i,i>0&&this._viewchange?(r=new Date(t.valueOf()-(t.getDay()<=0?7-this._firstdayofweek:t.getDay()-this._firstdayofweek)*864e5),u=t.getDay()!=0?r.getDate()-7:r.getDate()):u=t.getDate()+i,new Date(t.setDate(u))),t},_getHeaderAllDayCellsCount:function(){var c,f,o,s=[],r,e,u,h,i;if(this.dateRender=[],this._value=[],this.value=[],u=1,r=[],this.model.orientation=="vertical"){if(this._isCustomMonthView(),!t.isNullOrUndefined(this.model.dateHeaderTemplateId)&&(this.currentView()=="day"||this.currentView()=="week"||this.currentView()=="workweek"||this.currentView()=="customview"&&this._oneWeek))s=this._getUserDateheaderTemplate(),this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&(h=this._getMultipleResourceCellsCount(o),u=h.resCount,this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length==0&&(u=1));else for(o=this._getColumnCount().length,this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&(h=this._getMultipleResourceCellsCount(o),u=h.resCount,this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length==0&&(u=1)),i=0;i<o;i++)e=this.currentView()==="month"||this.currentView()==="day"||this._isCustomMonthView()?this._tempResource.length==0&&t.isNullOrUndefined(this.model.group)?this._dayFullNames[new Date(this._dateRender[i]).getDay()]:this._dayShortNames[new Date(this._dateRender[i]).getDay()]:this._dayShortNames[new Date(this._dateRender[i]).getDay()],f=new Date(new Date(this._dateRender[i]).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()?"e-headerToday":"",c=this.currentView()==="month"||this._isCustomMonthView()?{currentDay:e,currentDateClass:"",cellToday:f}:this.currentView()==="day"?this._tempResource.length==0&&t.isNullOrUndefined(this.model.group)?{currentDay:e+" "+t.format(new Date(this._dateRender[i]),"dd MMMM yyyy"),currentDateClass:"",cellToday:f}:{currentDay:e+" "+t.format(new Date(this._dateRender[i]),"dd MMM yy"),currentDateClass:"",cellToday:f}:{currentDay:e+" "+new Date(this._dateRender[i]).getDate(),currentDateClass:new Date(this._dateRender[i]).getDate()===new Date(this.currentDate()).getDate()?"e-activeview":"",cellToday:f},s.push(c),this._value.push(i);if(this._resWorkWeek)r=n.merge(r,s),this.value=n.merge(this.value,this._value);else for(i=0;i<u;i++)this.dateRender=n.merge(this.dateRender,this._dateRender),r=n.merge(r,s),this.value=n.merge(this.value,this._value)}else r=this._getHorizontalheaderCellCount(this._culture);return r},_findResourceIndex:function(n,t,i){for(var r=0;r<n.length;r++)if(n[r][t]===i)return r},_renderHeaderAllDayTemplate:function(){var r,e,i,g,nt,w,tt,it,b,k,o;if(this.currentView()!="agenda")if(t.scheduleFeatures.horizontal&&this.model.orientation=="horizontal")this._tempResource.length!=0&&t.scheduleFeatures.resources&&this._renderMultipleResourceHeaderTemplate(null,null),this._renderHorizontalHeaderBar();else{var s=n(document.createElement("div")).addClass("e-headerscrolldiv"),h=t.buildTag("div.e-headeralldaydiv","",{},{height:"100%"}).css("position","relative").css("overflow","hidden"),c=0,l=t.buildTag("table.e-table e-headrealldaytable","",{},{cellspacing:"0px",cellpadding:"0px",width:"100%"}),u=t.buildTag("tbody"),d=t.buildTag("tr.e-dateheader"),f=this._getHeaderAllDayCellsCount(),o=this.headTemplate.render({cols:f,view:this.currentView(),colspan:1});this._tempResource.length!=0&&t.scheduleFeatures.resources&&(u=this._renderMultipleResourceHeaderTemplate(u,f),c=t.isNullOrUndefined(this.model.group)?0:this._grouping.length,this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length==0&&(c=0));var a=t.buildTag("div.e-navigate","",{},{}),v=t.buildTag("table.e-table e-headertable","",{},{cellspacing:"0px",cellpadding:"0px"}),y=t.buildTag("tbody"),p=t.buildTag("tr.e-headertr");for(headTrCount=this.currentView()=="month"||this._isCustomMonthView()?1:2,r=c+headTrCount,e=[],i=0;i<r;i++)this.currentView()=="month"||this._isCustomMonthView()?e.push({tdClass:i==r-1?"e-monthleftcells":"e-resourceleftindentcells",divClass:i==r-1?"e-dateheadercell":""}):e.push({tdClass:i==r-1?"e-leftindent":i==r-2?"e-settingsindent":"e-resourceleftindentcells",divClass:i==r-1?"e-schedulesettings e-textellipsis":i==r-2?"e-dateheadercell":""});g=this._mediaQuery?this.currentView()=="month"||this._isCustomMonthView()?"50px":"30px":this.currentView()=="month"||this._isCustomMonthView()?"50px":"56px";this.model.showAllDayRow||new t.DataManager(e).remove("tdClass","e-leftindent");nt=this.leftIndent.render({trs:e,cswidth:g});this.model.timeScale.enable?this.aTR.append(t.buildTag("td").append(a.append(v.append(y.append(p.append(t.buildTag("td.e-empty","",{},{width:this._mediaQuery?this.currentView()=="month"||this._isCustomMonthView()?"0px":"30px":this.currentView()=="month"||this._isCustomMonthView()?"50px":"56px"}).addClass(this.currentView()=="month"||this._isCustomMonthView()?"e-monthempty":"").append(nt)).append(t.buildTag("td").append(s.append(h.append(l.append(u.append(d.append(o))))))).append(t.buildTag("td.e-emptyscrolltd","",{},{width:this.currentView()=="month"||this._isCustomMonthView()?"0px":this._mediaQuery?"0px":"18px"}))))))):this.aTR.append(t.buildTag("td").append(a.append(v.append(y.append(p.append(t.buildTag("td").append(s.append(h.append(l.append(u.append(d.append(o))))))).append(t.buildTag("td.e-emptyscrolltd","",{},{width:this.currentView()=="month"||this._isCustomMonthView()?"0px":this._mediaQuery?"0px":"18px"})))))));this.currentView()!=="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable&&this.model.showAllDayRow&&(w=t.isNullOrUndefined(this.model.allDayCellsTemplateId)?!1:!0,w&&(tt=this._getUserAllDayCellsTemplate()),it=this.alldayTemp.render({cols:f,colspan:1,userTemp:w,userHtml:tt}),u.append(t.buildTag("tr").append(it)))}else{var a=t.buildTag("div.e-navigate","",{},{}),v=t.buildTag("table.e-table e-headertable","",{},{cellspacing:"0px",cellpadding:"0px"}),y=t.buildTag("tbody"),p=t.buildTag("tr.e-headertr"),s=n(document.createElement("div")).addClass("e-headerscrolldiv"),h=t.buildTag("div.e-headeralldaydiv","",{},{height:"100%"}).css("position","relative").css("overflow","hidden"),l=t.buildTag("table.e-table e-headrealldaytable","",{},{cellspacing:"0px",cellpadding:"0px",width:"100%"}),u=t.buildTag("tbody tr"),f=[{headertext:this._getLocalizedLabels("Date"),className:"e-datecolumn"},{headertext:this._getLocalizedLabels("Time"),className:"e-timecolumn"},{headertext:this._getLocalizedLabels("Event"),className:"e-eventcolumn"}];if(this._tempResource.length!=0&&t.scheduleFeatures.resources){for(this._renderMultipleResourceHeaderTemplate(null,null),b=[],k=0;k<this.render_Resources.length;k++)b.push({headertext:"",className:"e-resourcecolumn"});t.isNullOrUndefined(this.model.group)||this._tempResource.length==0||this._tempResource[0].resourceSettings.dataSource.length==0||(f=n.merge(b,f))}o=this.agendaheadTemplate.render({cols:f});this.aTR.append(t.buildTag("td").append(a.append(v.append(y.append(p.append(t.buildTag("td").append(s.append(h.append(l.append(u.append(o)))))).append(t.buildTag("td.e-emptyscrolltd","",{},{width:"18px"})))))))}t.isNullOrUndefined(this.model.queryCellInfo)||this._renderQueryCellInfo("renderHeaderAllDayTemplate")},_getDateTime:function(n){var t=n,r,i;return(this._cellIndex=this.model.timeScale.enable?t.is(".e-workcells, .e-alldaycells")||this._isCustomMonthView()&&this._oneWeek?t.index():7-((parseInt(t.index()/7)+1)*7-t.index())+t.parent().index()*7:this.model.orientation=="vertical"&&this.currentView()=="month"||this.currentView()=="customview"&&this._dateRender.length>=7?7-((parseInt(t.index()/7)+1)*7-t.index())+t.parent().index()*7:t.index(),this.model.orientation=="horizontal"&&(this._cellIndex=this.model.timeScale.enable?this.currentView()!=="month"&&!this._isCustomMonthView()?Math.floor(this._cellIndex/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))):this._cellIndex:t.index(),this._workCellIndex=t.parent().index()),r=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"||this.currentView()=="customview"&&this._dateRender.length<=7?this._resWorkWeek?this._dateRender:this.dateRender:this._dateRender,r=this.model.orientation=="horizontal"&&this.currentView()=="customview"&&this._dateRender.length<=7?this._dateRender:r,i=new Date(r[this._cellIndex]),this.model.minDate>i||this.model.maxDate<i)?!1:(t.hasClass("e-workcells")&&this.model.showTimeScale&&this.currentView()!=="month"&&!this._isCustomMonthView()?this._calcCurrentTime(i,t,""):(this.cur_StartTime=new Date(new Date(i).setHours(0,0)),this.cur_EndTime=new Date(new Date(i).setHours(23,59))),t.hasClass("e-horizontmonthheaderdaytd")?{startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,currentDate:i,cellIndex:this._cellIndex,currentDate:i}:{startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,currentDate:i,cellIndex:this._cellIndex,currentDate:i,resources:this._tempResource.length!=0?this._getResourceValue(t,this._cellIndex):null})},_getAgendaAppointment:function(i){var r=[],o,u,f,s,e;if(i.hasClass("e-datecolumn")){if(o=n(i).attr("rowspan"),u=n(i).parent().nextAll("tr").andSelf().slice(0,parseInt(o)),u.length>0)for(f=0;f<u.length;f++)s=n(u[f]).find(".e-eventcolumn .e-agendaappointment").attr("guid"),r.push(new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,s))[0])}else r=i.hasClass("e-agendaappointment")?i:i.parent().find(".e-agendaappointment"),e=r.attr("guid"),this._mediaQuery&&(this._mAppId=e),r=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,e));return r},_monthdates:function(){var t=new Date(this.currentDate()),n=new Date(t.getFullYear(),t.getMonth(),1),u=n.getDay()+1,i,r;this._firstdayofweek?n.setDate(n.getDate()-u+this._firstdayofweek):n.setDate(n.getDate()-u);n.getMonth()==new Date(t.getFullYear(),t.getMonth(),1).getMonth()&&n.setDate(new Date(t.getFullYear(),t.getMonth(),1).getDate()-u+this._firstdayofweek-7);var e=new Date(n.setDate(n.getDate()+1)),o=new Date(t.getFullYear(),t.getMonth()+1,0),f=Math.round(Math.abs(e.getTime()-o.getTime())/864e5+1);for(rows=f<=28?4:f>28&&f<=35?5:6,new Date(n.setDate(n.getDate()-1)),i=[],this.monthDays=[],r=0;r<rows*7;r++)n.setDate(n.getDate()+1),i.push(new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0).getTime()),new Date(this.currentDate()).getMonth()===new Date(i[r]).getMonth()&&this.monthDays.push(i[r]);return new Date(i[0]).getDate()==new Date(t.getFullYear(),t.getMonth(),1).getDate()&&(i=i.splice(0,35)),i},_getStartEndTime:function(){var i=[],f,u,e,r,n;if(this._timeInitial=0,u=this._culture.calendar,this.model.orientation==="vertical")if(this.currentView()=="month"||this._isCustomMonthView())for(e=this._dateRender.length,n=0;n<e/7;n++)i.push(n);else if(t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId))for(r=new Date((new Date).setHours(0,0,0,0)),n=this.model.startHour*60;n<this.model.endHour*60;)this._timeMode==="12"?new Date(new Date(r).setHours(this.model.endHour,0,0,0)).getTime()>new Date(new Date(r).setHours(0,n,0,0)).getTime()&&(f=(n/60===this.model.startHour||n/60==12)&&u.AM&&u.PM?t.format(new Date(new Date(r).setHours(0,n,0,0)),"hh tt"):t.format(new Date(new Date(r).setHours(0,n,0,0)),"hh mm"),i.push({time:f,id:n/60})):i.push({time:new Date(new Date(r).setHours(0,n,0,0)).toTimeString().slice(0,5)+" 00"}),n=n+this.model.timeScale.majorSlot;else i=this._getUserTimeCellsTemplate();else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(i=this._getHoriStartEndTime(u));return i},_getWorkCellsCount:function(){var t=[],u,r,i,n;if(this.model.timeScale.enable)if(this.currentView()=="month"||this._isCustomMonthView())for(i=this._dateRender.length,n=0;n<i/7;n++)t.push({crow:n,cwidth:this.model.cellWidth,cheight:this.model.cellHeight});else for(u=this._getStartEndTime(),r=0,n=0;n<this.model.timeScale.minorSlotCount*u.length;n++)if(r=r+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,r>(this.model.endHour-this.model.startHour)*60){t.push({crow:n,cwidth:this.model.cellWidth,cheight:this.model.cellHeight});break}else t.push({crow:n,cwidth:this.model.cellWidth,cheight:this.model.cellHeight});else for(i=this._resWorkWeek?1:this._dateRender.length,n=0;n<i/7;n++)t.push({crow:n,cwidth:this.model.cellWidth,cheight:this.model.cellHeight});return t},_renderContentAreaTemplate:function(){var n=t.buildTag("div.e-workareadiv"),i=t.buildTag("table.e-table e-worktable","",{},{height:"100%",cellpadding:"0px",cellspacing:"0px",width:"100%"}),r=t.buildTag("tbody"),u=t.buildTag("tr"),f=t.buildTag("td"),e=t.buildTag("div#"+this._id+"_scroller"),c,v;if(this.$WorkCellDiv=t.buildTag("div").css("position","relative").attr("class","e-draggableworkarea").css("height","100%"),this.currentView()!="agenda")if(t.scheduleFeatures.horizontal&&this.model.orientation=="horizontal")this._renderHorizontalContent(n,i,r,u,f,e);else{this.$TimeCellTD=t.buildTag("td","",{},{}).addClass(this.currentView()=="month"||this._isCustomMonthView()?"e-monthleftindent":"e-workleftindent");var l,a,o=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)&&!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplateId)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplateId)?!0:!1,s=t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)?!1:!0,y=this.currentView()=="month"||this._isCustomMonthView()?1:0,h=this._timeSlotCount(o,s);(o||s)&&this.currentView()!="month"&&!this._isCustomMonthView()?(h.columnCount.pop(),l=this.userTimeCellTemplate.render({timerows:this._getStartEndTime(),cols1:h.columnCount,viewclass:y,timeScale:this.model.timeScale.minorSlotCount,cheight:this.model.cellHeight,userTemplateId:o,timeValue1:h.timeValue1,template:s})):l=this.timeCellTemplate.render({timerows:this._getStartEndTime(),cols1:h.columnCount,viewclass:y,timeScale:this.model.timeScale.minorSlotCount,userTemplateId:o,template:s});c=t.isNullOrUndefined(this.model.workCellsTemplateId)?!1:!0;c&&(v=this._getUserWorkCellsTemplate());a=this.currentView()!="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable?this.workcellTemp.render({cellrows:this._getWorkCellsCount(),cols1:this.value,orientation:this.model.orientation,timeScale:this.model.timeScale.minorSlotCount,userTemplate:c,userHtml:v}):this.monthcellTemp.render({cellrows:this._getWorkCellsCount(),cols1:this.value,orientation:this.model.orientation,timeScale:this.model.timeScale.minorSlotCount,userTemplate:c,userHtml:v});this.model.timeScale.enable?this.wTR.append(t.buildTag("td").append(n.append(i.append(r.append(u.append(this.$TimeCellTD.append(l)).append(f.append(e.append(this.$WorkCellDiv.append(a))))))))):this.wTR.append(t.buildTag("td").append(n.append(i.append(r.append(u.append(f.append(e.append(this.$WorkCellDiv.append(a)))))))))}else this.wTR.append(t.buildTag("td").append(n.append(i.append(r.append(u.append(f.append(e.append(this.$WorkCellDiv))))))));t.isNullOrUndefined(this.model.queryCellInfo)||this._renderQueryCellInfo("renderContentAreaTemplate")},_renderQueryCellInfo:function(i,r,u){var it,h,a,v,ft,et,p,st,ht,w,nt,tt,o,f,e,s;if(i=="appointment"&&this._trigger("queryCellInfo",{appointment:r,element:u,requestType:"appointment"}),i=="blockAppointment"&&this._trigger("queryCellInfo",{appointment:r,element:u,requestType:"blockoutCells"}),i=="emptycell"&&(it=this.aTR.find(".e-emptyscrolltd"),this._trigger("queryCellInfo",{element:n(it[0]),requestType:"emptytd"})),i=="renderAgendaContent"){for(h=this.aTR.find(".e-headercells"),f=0;f<h.length;f++)this._trigger("queryCellInfo",{element:n(h[f]),cellType:"agendaheadercells",requestType:"agendacells"});var b=this.element.find(".e-draggableworkarea").find(".e-datecolumn"),k=this.element.find(".e-draggableworkarea").find(".e-timecolumn"),d=this.element.find(".e-draggableworkarea").find(".e-eventcolumn");if(this._tempResource.length!=0)for(a=this.element.find(".e-draggableworkarea").find(".e-resourcecolumn"),f=0;f<a.length;f++)e=this._getAgendaAppointment(n(a[f])),this._trigger("queryCellInfo",{appointment:e[0],element:n(a[f]),cellType:"agendaresourcecell",requestType:"agendacells"});for(f=0;f<b.length;f++)e=this._getAgendaAppointment(n(b[f])),this._trigger("queryCellInfo",{currentAppointmentDate:new Date(new Date(e[0][this._appointmentSettings.startTime]).setHours(0,0,0)),appointments:e,element:n(b[f]),cellType:"agendadatecell",requestType:"agendacells"});for(f=0;f<k.length;f++)e=this._getAgendaAppointment(n(k[f])),this._trigger("queryCellInfo",{appointment:e[0],element:n(k[f]),cellType:"agendatimecell",requestType:"agendacells"});for(f=0;f<d.length;f++)e=this._getAgendaAppointment(n(d[f])),this._trigger("queryCellInfo",{appointment:e[0],element:n(d[f]),cellType:"agendaeventcell",requestType:"agendacells"})}else if(i=="renderHeaderAllDayTemplate")if(this.model.orientation=="vertical"){var h=this.aTR.find(".e-headercells"),rt=this.res1,ut=this._getHeaderAllDayCellsCount();if(this.res1=rt,this.model.showAllDayRow)for(v=this.aTR.find(".e-alldaycells"),f=0;f<v.length;f++)e=this._getDateTime(n(v[f])),s={cellIndex:e.cellIndex,currentDate:e.currentDate,resources:e.resources},this._trigger("queryCellInfo",{cell:s,element:n(v[f]),requestType:"alldaycells"});if(this.currentView()!="agenda")for(ft=h.length/this.res1.length,f=0;f<h.length;f++)et=Math.floor(f/ft),this._trigger("queryCellInfo",{resource:this.res1[et],currentDay:ut[f].currentDay,element:n(h[f]),requestType:"headercells"});if(this._tempResource.length!=0){var y=[],c=this.aTR.find(".e-resourcecells"),ot=this.aTR.find(".e-resourceleftindentcells");for(p=0;p<this._tempResource.length;p++)n.merge(y,this._tempResource[p].resourceSettings.dataSource);for(f=0;f<c.length;f++)this._trigger("queryCellInfo",{resource:y[f],element:n(c[f]),cellType:"headercells",requestType:"resourceheadercells"});for(f=0;f<ot.length;f++)this._trigger("queryCellInfo",{element:n(ot[f]),cellType:"headerdivcells",requestType:"resourceheadercells"})}this.currentView()=="month"&&this._isCustomMonthView()||(st=this.aTR.find(".e-leftindent"),this._trigger("queryCellInfo",{element:st,requestType:"leftindentcells"}));ht=this.currentView()=="month"||this._isCustomMonthView()?this.aTR.find(".e-monthleftcells"):this.aTR.find(".e-settingsindent");this._trigger("queryCellInfo",{element:ht,requestType:"leftheadercells"})}else{var ct=this.aTR.find(".e-headercells"),rt=this.res1,ut=this._getHeaderAllDayCellsCount();this.res1=rt;var lt=this.aTR.find(".e-horizontaltimetd "),l=this.aTR.find(".e-horizontalalternatetd"),g=this._getStartEndTime();for(f=0;f<lt.length;f++)this._trigger("queryCellInfo",{cell:g[f],element:n(lt[f]),cellType:"timecell",requestType:"timecells"});for(f=0;f<l.length;f++)this._trigger("queryCellInfo",{element:n(l[f]),cellType:"timeampmcell",requestType:"timecells"});if(this.currentView()!="agenda")for(f=0;f<ct.length;f++)this._trigger("queryCellInfo",{currentDay:ut[f].currentDay,element:n(ct[f]),requestType:"headercells"});for(w=this.aTR.find(".e-horizontmonthheaderdaytd"),f=0;f<w.length;f++)e=this._getDateTime(n(w[f])),s={cellIndex:e.cellIndex,currentDate:e.currentDate},this._trigger("queryCellInfo",{cell:s,element:n(w[f]),requestType:"headerdate"});if(this._tempResource.length!=0)for(nt=this.aTR.find(".e-horizontalheader"),f=0;f<nt.length;f++)this._trigger("queryCellInfo",{element:n(nt[f]),requestType:"resourcegroupheader"})}else if(i=="renderContentAreaTemplate")if(this.model.orientation=="vertical"){for(l=this.wTR.find(".e-timecelldivs"),timeCellAMPM=this.wTR.find(".e-ampmdisplay"),g=this._getStartEndTime(),this.currentView()!="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable?(o=this.wTR.find(".e-workcells"),tt="workcells"):(o=this.wTR.find(".e-monthcells"),tt="monthcells"),f=0;f<l.length;f++)this._trigger("queryCellInfo",{cell:g[f],element:n(l[f]).parent(),cellType:"timecell",requestType:"timecells"});for(f=0;f<timeCellAMPM.length;f++)this._trigger("queryCellInfo",{element:n(timeCellAMPM[f]),cellType:"timeampmcell",requestType:"timecells"});for(f=0;f<o.length;f++)e=this._getDateTime(n(o[f])),s=this.currentView()!="month"&&this.currentView()!="customview"&&this.model.timeScale.enable?{cellIndex:e.cellIndex,startTime:e.startTime,endTime:e.endTime,resources:e.resources}:{cellIndex:e.cellIndex,currentDate:e.currentDate,resources:e.resources},this._trigger("queryCellInfo",{cell:s,element:n(o[f]),requestType:tt})}else{if(o=t.isNullOrUndefined(this.$WorkCellDiv)?null:this.$WorkCellDiv.find(".e-workcells"),this._tempResource.length!=0&&!t.isNullOrUndefined(this.$WorkCellDiv)){var c=this.$WorkCellDiv.find(".e-resourceheadercells"),y=this._resourceSort(),at=this.wTR.find(".e-horizontresheaderdiv");for(f=0;f<at.length;f++)this._trigger("queryCellInfo",{resource:y[n(c[f]).index()],element:n(at[f]),cellType:"headerdivcells",requestType:"resourceheadercells"});for(f=0;f<c.length;f++)this._trigger("queryCellInfo",{resource:y[n(n(c[f]).parent()).index()],element:n(c[f]),cellType:"headercells",requestType:"resourceheadercells"})}if(!t.isNullOrUndefined(o))for(f=0;f<o.length;f++)n(o[f]).hasClass("e-childworkcell")&&n(o[f]).hasClass("e-workcells")&&(e=this._getDateTime(n(o[f])),s={cellIndex:e.cellIndex,startTime:e.startTime,endTime:e.endTime,resources:e.resources},this._trigger("queryCellInfo",{cell:s,element:n(o[f]),requestType:"workcells"}))}},_timeSlotCount:function(i,r){var e=0,o=[],a=[],h,v,f,c,u,l;if((i||r)&&this.currentView()!=="month"&&!this._isCustomMonthView()){for(u=0;u<this.model.timeScale.minorSlotCount;u++)o.push(u);c=o}else{for(h=this._getStartEndTime(),v=this.model.orientation=="vertical"?this.model.timeScale.minorSlotCount:this.model.timeScale.minorSlotCount-1,f=0;f<h.length;f++){for(u=0;u<v;u++)if(e=e+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,e>(this.model.endHour-this.model.startHour)*60){if(o.push(u),u==this.model.timeScale.minorslotcount-2){e=0;break}}else o.push(u);a.push(o);e=e+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount;o=[]}c=a}if((i||r)&&this.currentView()!=="month"&&!this._isCustomMonthView()){var y=n.templates(n(this.model.timeScale.minorSlotTemplateId).html()),p=n.templates(n(this.model.timeScale.majorSlotTemplateId).html()),w=[],f=0;for(u=this.model.startHour;u<this.model.endHour;){for(var s=[],e=this.model.timeScale.majorSlot+f,b=f;f<e;)l=f,f=f*6e4,this._timeMode==="12"?l!=b||t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)?s.push(y.render(object={date:new Date(new Date(this._dateRender[0]).setHours(u,0,0,f))}).trim()):s.push(p.render(object={date:new Date(new Date(this._dateRender[0]).setHours(u,0,0,f))}).trim()):l!=b||t.isNullOrUndefined(this.model.timeScale.majorSlotTemplateId)?s.push(y.render(object={date:new Date(new Date(this._dateRender[0]).setHours(u,0,0,f))}).trim()):s.push(p.render(object={date:new Date(new Date(this._dateRender[0]).setHours(u,0,0,f))}).trim()),f=f/6e4+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount;u=this.model.timeScale.majorSlot>60?u+this.model.timeScale.majorSlot/60:f>=60?u+1:u;f=f>=60?0:f;w.push(s)}r=!0}return{columnCount:c,timeValue1:w,strTime:h}},_renderAgendaContent:function(){var ft,et,ot,st,ht,ct,lt,k,at,d,vt,g,yt,nt,pt,l,s,o,a,p,tt,w,it,wt,h,u,r,dt,e,i,v,y,c,rt;this.element.find(".e-agendacellstab").remove();var f=new Date(new Date(this.currentDate()).setHours(0,0,0,0)),b=[],ut=[];for(this._app=[],this.model.group||(this.res1=["0"]),l=this._getLocalizedLabels("Recurrence"),s=this.model.agendaViewSettings.daysInAgenda>0?this.model.agendaViewSettings.daysInAgenda-1:0,o=0;o<this.res1.length;o++)if(u=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(f)),u=u.and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(new Date(f).setDate(f.getDate()+s)).setHours(23,59,59))),u=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?u.and(this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim(),t.FilterOperators.equal,this.res1[o][this._tempResource[this._tempResource.length-1].resourceSettings.id]):u,a=new t.DataManager(this._processed).executeLocal((new t.Query).where(u)),this._app=n.merge(this._app,a),a.length>0){if(p=[],!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources){for(tt=this.res1[o][this._tempResource[this._tempResource.length-1].resourceSettings.groupId],e=this._resCollection,i=e.length-1;i>0;i--)w=new t.DataManager(e[i-1].dataSource).executeLocal((new t.Query).where(e[i-1].id,t.FilterOperators.equal,tt)),p.push({resId:"resLevel_"+i+"_"+w[0][e[i-1].id],text:w[0][e[i-1].text]}),tt=w[0][e[i-1].groupId];p.reverse()}for(it=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?!0:!1,wt=a.length,nt=this.model.resourceHeaderTemplateId?!0:!1,pt=nt?this._getResourceHeadTemplate(this.res1[o]):"",h=0,new Date(f)<this.model.minDate&&(h=Math.floor((new Date(this.model.minDate)-new Date(f))/864e5)),new Date(new Date(f).setDate(f.getDate()+s))>this.model.maxDate&&(s=s-Math.floor((new Date(new Date(f).setDate(f.getDate()+s))-new Date(this.model.maxDate))/864e5));h<=s;h++)if(u=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(new Date(f).setDate(f.getDate()+h))),u=u.and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(new Date(f).setDate(f.getDate()+h)).setHours(23,59,59))),u=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?u.and(this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim(),t.FilterOperators.equal,this.res1[o][this._tempResource[this._tempResource.length-1].resourceSettings.id]):u,r=new t.DataManager(a).executeLocal((new t.Query).where(u)),r.length>0){b.push(b.length+1);var gt=r.length,bt=!0,kt=!1;for(i=0;i<r.length;i++)i==r.length-1&&(kt=!0),ft=this._timeMode=="12"?t.format(r[i][this._appointmentSettings.startTime],this._pattern.t):t.format(r[i][this._appointmentSettings.startTime],"HH:mm"),et=this._timeMode=="12"?t.format(r[i][this._appointmentSettings.endTime],this._pattern.t):t.format(r[i][this._appointmentSettings.endTime],"HH:mm"),ot="<strong class='e-agendaday'>"+t.format(new Date(r[i][this._appointmentSettings.startTime]),"dd")+"<\/strong><span class='e-agendaweek'>"+t.format(new Date(r[i][this._appointmentSettings.startTime]),"dddd")+"<\/span><span class='e-agendamonth'>"+t.format(new Date(r[i][this._appointmentSettings.startTime]),"MMM, yyyy")+"<\/span>",st=!t.isNullOrUndefined(r[i][this._appointmentSettings.allDay])&&JSON.parse(r[i][this._appointmentSettings.allDay])?"<div class='e-icon e-circle e-scheduleallday'><\/div>"+this._getLocalizedLabels("AllDay"):ft+" - "+et,ht=!t.isNullOrUndefined(r[i][this._appointmentSettings.recurrence])&&JSON.parse(r[i][this._appointmentSettings.recurrence])?r[i][this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1?"<span class='e-icon e-schedulerepeatedit' title='"+l+"'/>"+r[i][this._appointmentSettings.subject]:"<span class='e-icon e-schedulerepeat' title='"+l+"'/>"+r[i][this._appointmentSettings.subject]:r[i][this._appointmentSettings.subject],ct=this.model.categorizeSettings.enable&&!t.isNullOrUndefined(r[i][this._appointmentSettings.categorize])&&r[i][this._appointmentSettings.categorize]!=""?this._getCategorizeColor(r[i]):this._tempResource.length!=0&&t.scheduleFeatures.resources?this._getResourceColor(r[i]):{appointData:"",appointCustomcss:"",appointtextcolor:""},lt=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&this._tempResource.length!=0?this.res1[o][this._tempResource[this._tempResource.length-1].resourceSettings.text]:"",k=this.model.appointmentTemplateId?!0:!1,at=k?r[i][this._appointmentSettings.recurrence]?r[i][this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1?"<span class='e-icon e-schedulerepeatedit' title='"+l+"'/>"+this._getUserAppointmentTemplate(r[i]):"<span class='e-icon e-schedulerepeat' title='"+l+"'/>"+this._getUserAppointmentTemplate(r[i]):this._getUserAppointmentTemplate(r[i]):"",d=this.model.agendaViewSettings.dateColumnTemplateId?!0:!1,vt=d?this._getUserTemplate(this.model.agendaViewSettings.dateColumnTemplateId,r[i]):"",g=this.model.agendaViewSettings.timeColumnTemplateId?!0:!1,yt=g?this._getUserTemplate(this.model.agendaViewSettings.timeColumnTemplateId,r[i]):"",ut.push({readOnly:this.model.readOnly,edittext:this._getLocalizedLabels("Edit"),deletetext:this._getLocalizedLabels("Delete"),userResourceId:nt,userResourceHtml:pt,userDateId:d,userDateHtml:vt,userTimeId:g,userTimeHtml:yt,userAppTemplId:k,userTemplate:at,resGroup:p,resName:lt,resChild:it,resRowSpan:wt,id:r[i].AppTaskId,uid:r[i].Guid,dayRowSpan:r.length,dayChild:bt,dayBorderBottom:kt,background:ct.appointData,date:ot,time:st,event:ht}),bt=!1,it=!1}}if(dt=this.agendacellTemp.render({rows:b,cols:ut}),this.element.find(".e-draggableworkarea").append(dt),!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources)for(e=this.render_Resources,i=0;i<e.length-1;i++)for(v=0;v<e[i].length;v++)y="resLevel_"+(i+1)+"_"+e[i][v][this._resCollection[i].id],this.element.find("."+y).first().attr("rowspan",this.element.find("."+y).length),this.element.find("."+y).slice(1).addClass("e-hide"),this.element.find(".e-hide").remove(),this.model.resourceHeaderTemplateId&&this.element.find("."+y).children().empty().append(this._getResourceHeadTemplate(e[i][v]));c=n("div#"+this._id+"_scroller");t.isNullOrUndefined(c.data("ejScroller"))&&(c.ejScroller({enableRTL:this.model.enableRTL,height:this.scHeight-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top)-1,width:parseInt(this.element.width())-2,cssClass:this.model.cssClass}),this._mediaQuery||this._nextPrevAppointment(this.model.showAppointmentNavigator));c.ejScroller("refresh");rt=this.model.enableRTL?"e-borderright":"e-borderleft";c.ejScroller("isVScroll")?this.element.find(".e-emptyscrolltd").addClass(rt).show()&&this.element.find(".e-draggableworkarea").height(this.element.find(".e-draggableworkarea").height()+1):this.element.find(".e-emptyscrolltd").removeClass(rt).hide();this.element.find(".e-vscroll").css("left",this.model.enableRTL?0:this.element.outerWidth()-(c.ejScroller("isVScroll")?19:0));this.element.find(".e-mobileNavigation").css(this.model.enableRTL?"right":"left",this.element.outerWidth()-36);this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width());this.model.showAppointmentNavigator&&this._nextPrevButton(this._app);t.isNullOrUndefined(this.model.queryCellInfo)||this._renderQueryCellInfo("renderAgendaContent")},_getUserTemplate:function(t,i){var r=n.extend(r,i);return r.View=this.currentView(),n.templates(n(t).html()).render(r)},_getColumnCount:function(){for(var t=[],i=this.currentView()==="month"||this._isCustomMonthView()?this._isCustomMonthView()?this._renderDays<=7?this._renderDays:7:7:this._getRenderDates().length,n=0;n<i;n++)t.push(n);return t},_bindAppointmentsData:function(i){t.isNullOrUndefined(this.model.appointmentSettings)||this.dataSource()==null||(this.model.enablePersistence&&(this.model.appointmentSettings.query=new t.Query,this._enablePersist=!0),!this.dataSource()instanceof t.DataManager&&this.dataSource().dataSource.offline&&this._dateFormat(this.dataSource()),this.dataSource()instanceof t.DataManager&&!this.dataSource().dataSource.offline?this._initDataSource(i):(this._bindAppointments=this.dataSource().length>0?!0:!1,this._angular=this._bindAppointments&&!this._bindapp&&!this._setmodelvalue&&this._viewchange==!0&&this._obj.length>0&&this.dataSource()[0][this._appointmentSettings.id]==this._obj[0][this._appointmentSettings.id],this._true=this.model.isDST==!0?!0:!1,this._timeZoneOffset=t.isNullOrUndefined(this.model.timeZone)&&this.model.isDST==!1?(new Date).getTimezoneOffset()-this._stdTimezoneOffset():0,this._currentAppointmentData=this.dataSource(),n.extend(!0,this._obj=[],this.dataSource()),!t.isNullOrUndefined(this.dataSource().dataSource)&&this.dataSource().dataSource.json&&(this._currentAppointmentData=this.dataSource().dataSource.json),this._dataCount=this._currentAppointmentData.length,this._dataProcessing(this._currentAppointmentData),this.element.children().length>0&&this._renderAppointmentAll(),this._app.length<1&&this.model.showAppointmentNavigator&&this._nextPrevButton(this._app),this.tzone=this.model.timeZone,this._bindapp=!1,this._setmodelvalue=!1,this._viewchange=!1))},_initDataSource:function(i){var e=this._columnToSelect(this.model.appointmentSettings,i),f=n.extend(!0,[],e._params),o,s,u,r,h;for(this._true=this.model.isDST==!0?!0:!1,this._timeZoneOffset=t.isNullOrUndefined(this.model.timeZone)&&this.model.isDST==!1?(new Date).getTimezoneOffset()-this._stdTimezoneOffset():0,e._params=[],o=new Date(new Date(this.currentDate()).setHours(0,0,0)),s=new Date(o.getTime()+-this._timeZoneCalculate()*6e4),e.addParams("CurrentDate",s).addParams("CurrentView",this.currentView()).addParams("CurrentAction",i),u=0;u<f.length;u++)f[u].key!="CurrentDate"&&f[u].key!="CurrentView"&&f[u].key!="CurrentAction"&&e.addParams(f[u].key,f[u].value);r=this;h=this.dataSource().executeQuery(e);h.done(function(n){r._dataCount=n.result.length;t.isNullOrUndefined(n.result.result)||(r._dataCount=n.result.count+1,n.result=n.result.result);r._bindAppointments=n.result.length>0?!0:!1;r._currentAppointmentData=n.result;r._overlapList=[];r._dataProcessing(n.result);r._renderAppointmentAll();r._app.length<1&&r.model.showAppointmentNavigator&&r._nextPrevButton(r._app)});(t.isNullOrUndefined(this._app)||this._app.length<1)&&(this._app=[],this._app.length<1&&this.model.showAppointmentNavigator&&this._nextPrevButton(this._app))},_bindCategorizeData:function(){t.isNullOrUndefined(this.model.categorizeSettings)||(this._categoryInfo=[],!t.isNullOrUndefined(this.model.categorizeSettings.query)&&this.model.categorizeSettings.query instanceof t.Query||(this.model.categorizeSettings.query=t.Query()),this.model.categorizeSettings.dataSource instanceof t.DataManager?this._initCategorizeData(this.model.categorizeSettings):this._categoryInfo.push(this.model.categorizeSettings))},_initCategorizeData:function(n){var i=this._columnToSelect(n),t=this,r=n.dataSource.executeQuery(i);r.done(function(i){n.dataSource=i.result;t._categoryInfo.push(n);t._renderCategoryItems(t._appointmentAddWindow)})},_bindPriorityData:function(){t.isNullOrUndefined(this.model.prioritySettings)||(this._priorityInfo=[],!t.isNullOrUndefined(this.model.prioritySettings.query)&&this.model.prioritySettings.query instanceof t.Query||(this.model.prioritySettings.query=t.Query()),this.model.prioritySettings.dataSource instanceof t.DataManager?this._initPriorityData(this.model.prioritySettings):this._priorityInfo.push(this.model.prioritySettings))},_initPriorityData:function(n){var i=this._columnToSelect(n),t=this,r=n.dataSource.executeQuery(i);r.done(function(i){n.dataSource=i.result;t._priorityInfo.push(n);t._renderPriorityItems(t._appointmentAddWindow)})},_bindBlockData:function(){if(!t.isNullOrUndefined(this.model.blockoutSettings)&&(!t.isNullOrUndefined(this.model.blockoutSettings.query)&&this.model.blockoutSettings.query instanceof t.Query||(this.model.blockoutSettings.query=t.Query()),this.model.blockoutSettings.dataSource instanceof t.DataManager)){var i=this._columnToSelect(this.model.blockoutSettings),n=this,r=this.model.blockoutSettings.dataSource.executeQuery(i);r.done(function(t){n.model.blockoutSettings.dataSource=t.result;n._renderBlockAppointments()})}},_dateFormat:function(n){if(n.length>0&&new Date(n[0][this._appointmentSettings.startTime]).toString()=="Invalid Date")for(var t=0;t<n.length;t++)n[t][this._appointmentSettings.startTime]=new Date(n[t][this._appointmentSettings.startTime]).toString()=="Invalid Date"||new Date(n[t][this._appointmentSettings.startTime]).toString()=="NaN"?new Date(parseInt(n[t][this._appointmentSettings.startTime].match(/\d+/).toString())):new Date(n[t][this._appointmentSettings.startTime]),n[t][this._appointmentSettings.endTime]=new Date(n[t][this._appointmentSettings.endTime]).toString()=="Invalid Date"?new Date(parseInt(n[t][this._appointmentSettings.endTime].match(/\d+/).toString())):new Date(n[t][this._appointmentSettings.endTime])},_columnToSelect:function(n){var i=t.Query();return t.isNullOrUndefined(n.tableName)||this.dataSource().dataSource.url.match(n.tableName+"$")?i=n.query:(i=n.query,i.from(n.tableName)),i},_getColumns:function(n){var r=[];for(var i in n)i!=="tableName"&&i!=="query"&&i!=="dataSource"&&(t.isNullOrUndefined(n[i])||r.push(n[i]));return r},_sortAppById:function(n){var t=this;return n.sort(function(n,t){var i=n.AppTaskId,r=t.AppTaskId;return i<r?-1:i>r?1:0}),n},_stdTimezoneOffset:function(){return Math.max(new Date((new Date).getFullYear(),0,1).getTimezoneOffset(),new Date((new Date).getFullYear(),6,1).getTimezoneOffset())},_timeZoneCalculate:function(){var i,r,f,o,s,e,h,c,l,u=(new Date).getTimezoneOffset();return t.isNullOrUndefined(this.model.timeZone)?i=this.model.isDST==!1?-u+this._timeZoneOffset:-u:this.model.timeZone.indexOf(":")!==-1?(t.isNullOrUndefined(this.tzone)&&(this.tzone=this.model.timeZone),r=this.model.timeZone.split(" ")[this.model.timeZone.split(" ").length-1].split(":"),f=this.tzone.split(" ")[this.tzone.split(" ").length-1].split(":"),n.isNumeric(parseInt(r[0]))&&parseInt(r[0]).toString.length<=2||r[0].indexOf("UTC")!==-1?(o=this.model.timeZone.indexOf("-")!==-1?-parseInt(r[0].replace(/\D/g,"")):parseInt(r[0].replace(/\D/g,"")),s=parseInt(r[1]),e=-(o*60+s),this._setmodelvalue==!0?this.tzone==this.model.timeZone?i=-(-u+e):(h=this.tzone.indexOf("-")!==-1?-parseInt(f[0].replace(/\D/g,"")):parseInt(f[0].replace(/\D/g,"")),c=parseInt(f[1]),l=-(h*60+c),i=-(-l+e)):i=-e):i=-u):i=-u,i},_timeZoneAppointments:function(i,r){if(this.model.appointmentSettings.applyTimeOffset){var o,s,u,f,e;if(i[this._appointmentSettings.allDay])i[this._appointmentSettings.startTime]=new Date(i[this._appointmentSettings.startTime]),i[this._appointmentSettings.endTime]=new Date(i[this._appointmentSettings.endTime]);else return t.isNullOrUndefined(this._dayLight)?(u=i[this._appointmentSettings.startTimeZone],f=i[this._appointmentSettings.endTimeZone],t.isNullOrUndefined(f)&&!t.isNullOrUndefined(u)&&(i[this._appointmentSettings.endTimeZone]=f=u),!t.isNullOrUndefined(f)&&t.isNullOrUndefined(u)&&(i[this._appointmentSettings.startTimeZone]=u=f),t.isNullOrUndefined(u)||t.isNullOrUndefined(f)||(u=u.indexOf("UTC")!=-1?parseInt(u.split(" ")[1].split(":")[0])*60+parseInt(u.split(" ")[1].split(":")[1]):parseInt(u.split(":")[0])*60+parseInt(u.split(":")[1]),f=f.indexOf("UTC")!=-1?parseInt(f.split(" ")[1].split(":")[0])*60+parseInt(f.split(" ")[1].split(":")[1]):parseInt(f.split(":")[0])*60+parseInt(f.split(":")[1])),e=t.isNullOrUndefined(u)&&!n.isNumeric(u)?this._timeZoneCalculate(i):u-this._timeZoneCalculate(i)):e=this._timeValue,e=r==""?-e:e,o=new Date(i[this._appointmentSettings.startTime]),s=new Date(i[this._appointmentSettings.endTime]),i[this._appointmentSettings.allDay]&&Math.round((new Date(i[this._appointmentSettings.endTime])-new Date(i[this._appointmentSettings.startTime]))/36e5)<24?i:(i[this._appointmentSettings.startTime]=new Date(o.setMinutes(o.getMinutes()+e)),i[this._appointmentSettings.endTime]=new Date(s.setMinutes(s.getMinutes()+e)),i);return i}return i},_processtimeZone:function(n){var t=new Date(n[this.model.blockoutSettings.startTime]),i=new Date(n[this.model.blockoutSettings.endTime]),r;return n[this.model.blockoutSettings.isAllDay]?(n[this.model.blockoutSettings.startTime]=new Date(t.getFullYear(),t.getMonth(),t.getDate()),n[this.model.blockoutSettings.endTime]=new Date(i.getFullYear(),i.getMonth(),i.getDate(),23,59,59)):(r=this._timeZoneCalculate(n),n[this.model.blockoutSettings.startTime]=new Date(t.setMinutes(t.getMinutes()+r)),n[this.model.blockoutSettings.endTime]=new Date(i.setMinutes(i.getMinutes()+r))),n},_dataProcessing:function(n){var u,i,r;if(this._processed=[],this._appMainId=null,n.length>0){for(u=this._sortAppById(n),this._maxId=t.isNullOrUndefined(n[0])||t.isNullOrUndefined(n[0].AppTaskId)?1:n[0].AppTaskId,i=0;i<n.length;i++)this._bindAppointments==!0&&!this._angular&&!this._setmodelvalue&&this._applyTimeOffset&&t.isNullOrUndefined(this._enablePersist)?(r=this._timeZoneAppointments(n[i],"reverse"),this._appointmentProcessing(r)):this._appointmentProcessing(n[i]);return this._bindAppointments=!1,this._setmodelvalue=!1,this._processed=this._sortAppById(this._processed),this._processed}},_guidFormatGenerate:function(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},_RecurrenceAppointment:function(i){var l=new Date(i[this._appointmentSettings.startTime]),a=i[this._appointmentSettings.endTime].getTimezoneOffset()-i[this._appointmentSettings.startTime].getTimezoneOffset(),h=(new Date(i[this._appointmentSettings.endTime])-new Date(i[this._appointmentSettings.startTime]))/1e3,v=Math.floor((h-a/1e3)/3600),y=Math.floor(h%3600/60),u=this._appointmentAddWindow.find(".e-recurrenceeditor").data("ejRecurrenceEditor"),s,e;u._rRule={};_count=0;this._filt=!0;_lastDay=!1;i.AppTaskId=t.isNullOrUndefined(i.AppTaskId)?this._maxId:i.AppTaskId;t.isNullOrUndefined(i[this._appointmentSettings.id])&&(i[this._appointmentSettings.id]=i.AppTaskId);u.model.startDate=new Date(this.currentDate());for(var p=u.recurrenceDateGenerator(i[this._appointmentSettings.recurrenceRule],l,i[this._appointmentSettings.recurrenceExDate]),o=0,c=p;o<c.length;){var f=new Date(c[o]),r={},w=i[this._appointmentSettings.endTime];u._rRule.freq!="MONTHLY"&&u._rRule.freq!="YEARLY"||t.isNullOrUndefined(u._rRule.setPositions)||(f=u._dayOfWeekInMonth(f,u._rRule.weekDays,u._rRule.setPositions));s=new Date(f.getFullYear(),f.getMonth(),f.getDate(),new Date(i[this._appointmentSettings.startTime]).getHours(),new Date(i[this._appointmentSettings.startTime]).getMinutes(),0);e=new Date(f.getFullYear(),f.getMonth(),f.getDate(),new Date(i[this._appointmentSettings.startTime]).getHours()+v,new Date(i[this._appointmentSettings.startTime]).getMinutes()+y,w.getSeconds());this._idChecking();i[this._appointmentSettings.recurrenceId]=i[this._appointmentSettings.recurrenceId]||i[this._appointmentSettings.id]||i.AppTaskId;i.ParentId=i[this._appointmentSettings.recurrenceId];t.isNullOrUndefined(u._rRule.exDate)?r=this._addAppData(i,this._maxId,s,e,i.ParentId):u._rRule.exDate.indexOf(t.format(new Date(f),this._pattern.d))==-1&&(r=this._addAppData(i,this._maxId,s,e,i.ParentId));new Date(new Date(i[this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(i[this._appointmentSettings.endTime]-i[this._appointmentSettings.startTime])/36e5<24&&i[this._appointmentSettings.allDay]!==!0?(r.Guid=this._guidFormatGenerate(),this._multipleDayApp(r,this._maxId,r[this._appointmentSettings.startTime],e)):Math.round((r[this._appointmentSettings.endTime]-r[this._appointmentSettings.startTime])/36e5)>24?(r.Guid=this._guidFormatGenerate(),this._multipleSplit(r,this._maxId,r[this._appointmentSettings.startTime],r[this._appointmentSettings.endTime])):n.isEmptyObject(r)||(r.Guid=this._guidFormatGenerate(),this._processed.push(r));o++;this._maxId++}this._filt=!1},_recurrenceAppSort:function(i){for(var e,u,f=[],r=0;r<i.length;r++)e=new t.DataManager(i).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,i[r].Guid)),e.length>1?(u=n.extend(!0,[],e),u[0][this._appointmentSettings.endTime]=u[u.length-1][this._appointmentSettings.endTime],f.push(u[0]),r++):f.push(i[r]);return f},_appointmentProcessing:function(i){var u=this._appointmentAddWindow.find(".e-recurrenceeditor").data("ejRecurrenceEditor"),e;this._maxId=t.isNullOrUndefined(this._appMainId)?parseInt(this._maxId):parseInt(this._appMainId)+1;var o=new Date(i[this._appointmentSettings.startTime]),f=(new Date(i[this._appointmentSettings.endTime])-new Date(i[this._appointmentSettings.startTime]))/1e3,s=Math.floor(f/3600),h=Math.floor(f%3600/60);u._rRule={};_count=0;_lastDay=!1;e={};e=n.extend(!0,{},i);t.isNullOrUndefined(i[this._appointmentSettings.recurrence])||t.isNullOrUndefined(i[this._appointmentSettings.recurrenceRule])||u.recurrenceRuleSplit(i[this._appointmentSettings.recurrenceRule],i[this._appointmentSettings.recurrenceExDate]);i[this._appointmentSettings.recurrence]==1&&t.isNullOrUndefined(u._rRule.recurEditId)?this._RecurrenceAppointment(i):new Date(new Date(i[this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(i[this._appointmentSettings.endTime]-i[this._appointmentSettings.startTime])/36e5<24&&i[this._appointmentSettings.allDay]!==!0&&(i[this._appointmentSettings.recurrence]&&!t.isNullOrUndefined(u._rRule.recurEditId)||!i[this._appointmentSettings.recurrence])?(this._appMainId=i.AppTaskId=i.AppTaskId==null?this._maxId:i.AppTaskId,t.isNullOrUndefined(i[this._appointmentSettings.id])&&(i[this._appointmentSettings.id]=i.AppTaskId),i.ParentId=t.isNullOrUndefined(u._rRule.recurEditId)?i[this._appointmentSettings.id]:u._rRule.recurEditId,i[this._appointmentSettings.recurrence]&&(i.ParentId=i[this._appointmentSettings.recurrenceId]=i[this._appointmentSettings.recurrenceId]==null?i.ParentId:i[this._appointmentSettings.recurrenceId]),i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,this._maxId=i.AppTaskId,this._multipleDayApp(i,this._maxId,i[this._appointmentSettings.startTime],i[this._appointmentSettings.endTime])):(i[this._appointmentSettings.endTime]-i[this._appointmentSettings.startTime])/36e5>=24?(this._filt=!0,this._appMainId=i.AppTaskId=i.AppTaskId==null?this._maxId:i.AppTaskId,t.isNullOrUndefined(i[this._appointmentSettings.id])&&(i[this._appointmentSettings.id]=i.AppTaskId),i.ParentId=t.isNullOrUndefined(u._rRule.recurEditId)?i[this._appointmentSettings.id]:u._rRule.recurEditId,i[this._appointmentSettings.recurrence]&&(i.ParentId=i[this._appointmentSettings.recurrenceId]=i[this._appointmentSettings.recurrenceId]==null?i.ParentId:i[this._appointmentSettings.recurrenceId]),i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,this._maxId=i.AppTaskId,this._multipleSplit(i,this._maxId,i[this._appointmentSettings.startTime],i[this._appointmentSettings.endTime]),this._filt=!1):i[this._appointmentSettings.recurrence]!=0&&t.isNullOrUndefined(u._rRule.recurEditId)?i[this._appointmentSettings.recurrence]!=r&&i[this._appointmentSettings.allDay]!=r||i[this._appointmentSettings.recurrence]||(this._appMainId=i.AppTaskId=i.AppTaskId==null?this._maxId:i.AppTaskId,t.isNullOrUndefined(i[this._appointmentSettings.id])&&(i[this._appointmentSettings.id]=i.AppTaskId),i.ParentId=i[this._appointmentSettings.id],i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,i.RecurrenceId=i.recurrenceExDate=null,this._processed.push(i)):(this._appMainId=i.AppTaskId=i.AppTaskId==null?this._maxId:i.AppTaskId,t.isNullOrUndefined(i[this._appointmentSettings.id])&&(i[this._appointmentSettings.id]=i.AppTaskId),i.ParentId=t.isNullOrUndefined(u._rRule.recurEditId)?i[this._appointmentSettings.id]:u._rRule.recurEditId,i[this._appointmentSettings.recurrence]&&(i.ParentId=i[this._appointmentSettings.recurrenceId]=i[this._appointmentSettings.recurrenceId]==null?i.ParentId:i[this._appointmentSettings.recurrenceId]),i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,this._processed.push(i));this._appMainId=t.isNullOrUndefined(this._appMainId)||this._appMainId<this._maxId?this._maxId:this._appMainId},_idChecking:function(){for(var n,i,r=0;r<this._currentAppointmentData.length;r++)if(n=(new t.Query).where("AppTaskId",t.FilterOperators.equal,this._maxId),i=new t.DataManager(this._currentAppointmentData).executeLocal(n),i.length==0){this._maxId;break}else this._maxId++;for(;;)if(n=(new t.Query).where("AppTaskId",t.FilterOperators.equal,this._maxId),i=new t.DataManager(this._processed).executeLocal(n),i.length==0){this._maxId;break}else this._maxId++;return this._maxId},_multipleDayApp:function(n,t,i,r){var f,e,u,o;for(r.getHours()==0&&r.getMinutes()==0&&(r=new Date(r.getTime()-1e3)),f=new Date(i),this.model.orientation=="vertical"||this.model.orientation=="horizontal"&&(i<new Date(this._dateRender[0])||r>new Date(new Date(this._dateRender[this._dateRender.length-1]).setHours(29,59,59)))?(e=new Date(new Date(i).getFullYear(),new Date(i).getMonth(),new Date(i).getDate()),u=new Date(new Date(e).setHours(new Date(e).getHours()+24)),u=new Date(new Date(u).getTime()-1e3)):u=new Date(r);f>=new Date(i)&&f<=u&&u<=new Date(r);)o=this._addAppData(n,t,f,u,n.ParentId),this._processed.push(o),f=new Date(new Date(u).setMinutes(new Date(u).getMinutes()+1)),u=n[this._appointmentSettings.endTime],this._maxId=t=this._idChecking()},_multipleSplit:function(t,i,r,u){var h,c,a,o,f,s,l,e,y;if(r=new Date(r),this.currentView()=="workweek"&&!this._resWorkWeek&&n.inArray(new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime(),this._dateRender)==-1){for(h=1;h<this._dateRender.length;h++)if(n.inArray(new Date(r.getFullYear(),r.getMonth(),r.getDate()+h).getTime(),this._dateRender)>=0){s=n.inArray(new Date(r.getFullYear(),r.getMonth(),r.getDate()+h).getTime(),this._dateRender);r=new Date(this._dateRender[s]);break}this.currentView()!="workweek"||this._resWorkWeek||this.model.orientation!="horizontal"||n.inArray(new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime(),this._dateRender)!=-1||(r=new Date(new Date(r).getFullYear(),new Date(r).getMonth(),new Date(r).getDate()+(7-this._dateRender.length)))}for(this.starttime=new Date(this._dateRender[0])<=r||this._filt==!0?new Date(new Date(r).getFullYear(),new Date(r).getMonth(),new Date(r).getDate(),new Date(r).getHours(),new Date(r).getMinutes(),new Date(r).getSeconds()):new Date(this._dateRender[0]),c=new Date(new Date(u).getFullYear(),new Date(u).getMonth(),new Date(u).getDate(),23,59,59),a=0;this.starttime<=c;){if(this.starttime>=c&&!((u-r)/36e5>24)?this._filt=!1:"",o=0,f=this.starttime,this.currentView()!="agenda")if(this.model.orientation=="horizontal"&&this.currentView()=="month")o=new Date(f.getFullYear(),f.getMonth()+1,0).getDate()-f.getDate();else if(this.currentView()=="customview"&&(this._renderDays<=7||this.model.orientation=="horizontal"))this.starttime=new Date(new Date(f).getFullYear(),new Date(f).getMonth(),new Date(f).getDate()),o=this._dateRender.indexOf(this.starttime.getTime())!=-1?this._dateRender.length-1-this._dateRender.indexOf(this.starttime.getTime()):this.starttime.getTime()<new Date(this._dateRender[0]).getTime()?(new Date(new Date(this._dateRender[0]).setDate(new Date(this._dateRender[0]).getDate()-1)).getTime()-new Date(this.starttime).setHours(0,0,0,0))/864e5:this.starttime.getTime()>new Date(this._dateRender[this._dateRender.length-1]).setHours(23,59,59)?this._dateRender.length-1:0;else if(this.currentView()!=="day"){if(this.model.showNextPrevMonth||this.currentView()!="month"||new Date(new Date(this.currentDate()).getFullYear(),new Date(this.currentDate()).getMonth(),1).getTime()==new Date(this.starttime.getFullYear(),this.starttime.getMonth(),1).getTime())if(this.currentView()!="workweek"||this._resWorkWeek)s=this._dateRender.indexOf(new Date(f).setHours(0,0,0)),s=s<0?0:s,o=this.currentView()=="month"||this._isCustomMonthView()?6-s%7:Math.abs(this._dateRender.length-1-(f.getDay()-this._firstdayofweek));else{var v=new Date(this.starttime),p=new Date(v.setDate(v.getDate()-(v.getDay()-this._firstdayofweek))),w=this._firstdayofweek==0?this.model.workWeek.length:6,b=new Date(p.getTime()+864e5*w);o=Math.abs(Math.ceil((b.getTime()-this.starttime.getTime())/864e5));o=o>6?6:o}else o=new Date(f.getFullYear(),f.getMonth()+1,0).getDate()-f.getDate();this._firstdayofweek>f.getDay()&&(o=6-f.getDay()-(7-this._firstdayofweek))}if(l=new Date(new Date(this.starttime).getFullYear(),new Date(this.starttime).getMonth(),new Date(this.starttime).getDate()+o),e=new Date(l).getDate()==new Date(c).getDate()&&this.currentView()!=="month"?new Date(new Date(l).setHours(u.getHours(),u.getMinutes(),u.getSeconds())):new Date(new Date(l).setHours(23,59,59)),e>=new Date(u)&&this.currentView!=="day"&&(e=t[this._appointmentSettings.endTime]),this.model.showNextPrevMonth||this.currentView()!="month"||new Date(this.starttime.getFullYear(),this.starttime.getMonth(),1).getTime()==new Date(e.getFullYear(),e.getMonth(),1).getTime()||(e=new Date(this.starttime.getFullYear(),this.starttime.getMonth()+1,0,e.getHours(),e.getMinutes(),e.getSeconds())),appointment=this._addAppData(t,i,f,e,t.ParentId),this._processed.push(appointment),this._maxId=i=this._idChecking(),a=this.currentView()=="workweek"&&this._firstdayofweek==0?8-this.model.workWeek.length:1,this.starttime=new Date(new Date(e).getFullYear(),new Date(e).getMonth(),new Date(e).getDate()+a),y=this.currentView()=="agenda"?new Date(new Date(new Date(this.currentDate()).setDate(new Date(this.currentDate()).getDate()+(this.model.agendaViewSettings.daysInAgenda>0?this.model.agendaViewSettings.daysInAgenda-1:0))).setHours(23,59,59)):new Date(this._dateRender[this._dateRender.length-1]),y<this.starttime&&!this._filt)break}},_deleteOcurrence:function(n,i){var s=this._appointmentAddWindow.find(".e-recurrenceeditor").data("ejRecurrenceEditor"),c=(new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,n),r=new t.DataManager(this._currentAppointmentData).executeLocal(c),u,o,e,f,h;if((this._currentAction=="delete"||this._currentAction=="editOccurrence")&&r[0][this._appointmentSettings.endTime].getDay()>r[0][this._appointmentSettings.startTime].getDay()&&(u=new t.DataManager(this._processed).executeLocal((new t.Query).where(this._appointmentSettings.startTime,t.FilterOperators.equal,i)),u=u.length==0?this._objDate:u,u=new t.DataManager(this._processed).executeLocal((new t.Query).where("AppTaskId",t.FilterOperators.equal,u[0].AppTaskId))),!t.isNullOrUndefined(r)&&!t.isNullOrUndefined(r[0][this._appointmentSettings.recurrenceRule])){if(o=r[0][this._appointmentSettings.recurrenceRule],s.recurrenceRuleSplit(o,r[0][this._appointmentSettings.recurrenceExDate]),t.isNullOrUndefined(s._rRule.exDate))(this._currentAction=="delete"||this._currentAction=="editOccurrence")&&r[0][this._appointmentSettings.endTime].getDay()>r[0][this._appointmentSettings.startTime].getDay()?u[0][this._appointmentSettings.startTime].getDay()==u[0][this._appointmentSettings.endTime].getDay()?(i=u[0][this._appointmentSettings.startTime],r[0][this._appointmentSettings.recurrenceRule]=o+";EXDATE="+t.format(i,this._pattern.d),r[0][this._appointmentSettings.recurrenceExDate]=t.isNullOrUndefined(r[0][this._appointmentSettings.recurrenceExDate])?t.format(i,this._pattern.d).toString():r[0][this._appointmentSettings.recurrenceExDate]+","+t.format(i,this._pattern.d).toString()):(r[0][this._appointmentSettings.recurrenceRule]=o+";EXDATE="+t.format(i,this._pattern.d),r[0][this._appointmentSettings.recurrenceExDate]=t.isNullOrUndefined(r[0][this._appointmentSettings.recurrenceExDate])?t.format(i,this._pattern.d).toString():r[0][this._appointmentSettings.recurrenceExDate]+","+t.format(i,this._pattern.d).toString()):(r[0][this._appointmentSettings.recurrenceRule]=o+";EXDATE="+t.format(i,this._pattern.d),r[0][this._appointmentSettings.recurrenceExDate]=t.isNullOrUndefined(r[0][this._appointmentSettings.recurrenceExDate])?t.format(i,this._pattern.d).toString():r[0][this._appointmentSettings.recurrenceExDate]+","+t.format(i,this._pattern.d).toString());else{for(e=o.split(";"),recurRule="",f=0;f<e.length;f++)recurRule!=""&&(recurRule+=";"),h=e[f].replace(/ /g,"").split("="),h[0]=="EXDATE"&&((this._currentAction=="delete"||this._currentAction=="editOccurrence")&&r[0][this._appointmentSettings.endTime].getDay()>r[0][this._appointmentSettings.startTime].getDay()?u[0][this._appointmentSettings.startTime].getDay()==u[0][this._appointmentSettings.endTime].getDay()?(i=u[0][this._appointmentSettings.startTime],e[f]=e[f]+","+t.format(i,this._pattern.d)):e[f]=e[f]+","+t.format(i,this._pattern.d):e[f]=e[f]+","+t.format(i,this._pattern.d)),recurRule+=e[f];r[0][this._appointmentSettings.recurrenceRule]=recurRule;r[0][this._appointmentSettings.recurrenceExDate]=t.isNullOrUndefined(r[0][this._appointmentSettings.recurrenceExDate])?t.format(i,this._pattern.d).toString():r[0][this._appointmentSettings.recurrenceExDate]+","+t.format(i,this._pattern.d).toString()}return r}},_getWeekIndex:function(n){var i=0,t=new Date(n.getFullYear(),n.getMonth(),1),r=n.getDay();if(r!=t.getDay())do t=new Date(t.setDate(t.getDate()+1));while(r!=t.getDay());while(t.getDate()!=n.getDate())t=new Date(t.setDate(t.getDate()+7)),i++;return i},_addAppData:function(i,r,u,f,e){var s={},o,h;for(o in this._appointmentSettings)if(o!="dataSource"&&o!="query"&&o!="tableName"&&o!="resourceFields"&&(s[this._appointmentSettings[o]]=i[this._appointmentSettings[o]]),o=="resourceFields")for(h in!t.isNullOrUndefined(this._appointmentSettings.resourceFields)&&this._appointmentSettings.resourceFields.split(","))s[this._appointmentSettings.resourceFields.split(",")[h].trim()]=i[this._appointmentSettings.resourceFields.split(",")[h].trim()];return t.isNullOrUndefined(r)||(s.AppTaskId=r),t.isNullOrUndefined(u)||(s[this._appointmentSettings.startTime]=u),t.isNullOrUndefined(f)||(s[this._appointmentSettings.endTime]=f),t.isNullOrUndefined(e)||(s.ParentId=e),n.extend({},i,s)},_renderAppointments:function(){var r=n.extend(!0,[],this._dateRender),h,u,f,s,e,o,i;for(this._overflowFlag=!1,this._tempapp=[],this._app=[],this._filterData=[],this._renderedApp=[],this._renderedAllDay=[],h=1,this.level=0,this.cellwidth=this.element.find(".e-workcells").width(),this.cellheight=this.element.find(".e-workcells").outerHeight(),this.model.orientation=="vertical"&&this.model.showAllDayRow&&(this._mediaQuery?this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd").attr("style","height:40px !important"):this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd").css("height","27px"),this.element.find(".e-alldaycells").first().css(this.model.enableRTL?"border-right":"border-left","none")),this._horiHeaderCollection=this._horiGroupCollection(),this.leftPosition=0,this._filtered=[],this._variable=[],this.model.group&&(this._tempResource.length==0||this._tempResource[0].resourceSettings.dataSource.length!=0)||(this.res1=["0"]),this.resIndex=0,u=0;u<this.res1.length;u++){if(f=0,e=r.length,new Date(r[0])<this.model.minDate&&(f=Math.floor((new Date(this.model.minDate)-new Date(r[0]))/864e5)),new Date(r[r.length-1])>this.model.maxDate&&(s=Math.floor((new Date(r[r.length-1])-new Date(this.model.maxDate))/864e5),e=r.length-s),this._resWorkWeek)for(e=0,f=0,o=0,i=0;i<u+1;i++)if(t.isNullOrUndefined(this.res1[i][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?(e+=this.model.workWeek.length,i==u&&(o+=this.model.workWeek.length)):(e+=this.res1[i][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length,i==u&&(o+=this.res1[i][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length)),i==u){f=e-o;break}for(f;f<e;f++)this._getDayAppointments(f,u)}this._overflowFlag&&this._reRenderScroller();this._overflowFlag=!1},_renderUpDownIcon:function(){if(this.element.find(".e-upicon, .e-downicon").length==0){var t=downIcon=upIconHtml=downIconHtml="",i=this.element.find(".e-hscroll").length==0?"0px":this.element.find(".e-hscroll").outerHeight()+"px";for(a=0;a<this.dateRender.length;a++)t=t+"<td class='upicon_"+a+"' style='width:100%;height:100%;'><span class='e-icon e-arrow-sans-up e-appup'><\/span><\/td>",downIcon=downIcon+"<td class='downicon_"+a+"' style='width:100%;height:100%;'><span class='e-icon e-arrow-sans-down e-appdown'><\/span><\/td>";upIconHtml="<tr class='e-upicon' style='pointer-events:none;top:0px;'>"+t+"<\/tr>";downIconHtml="<tr class='e-downicon' style='pointer-events:none;bottom:"+i+";'>"+downIcon+"<\/tr>";n(upIconHtml).insertBefore(n(this.element.find(".e-draggableworkarea").parent()));n(downIconHtml).insertAfter(n(this.element.find(".e-draggableworkarea").parent()));this.model.enableRTL&&this.element.find(".e-appup, .e-appdown").addClass("e-rtl");this.element.find(".e-upicon, .e-downicon").width(this.element.find(".e-workcellstab").width());this.element.find(".e-appup, .e-appdown").css("pointer-events","visible");this.element.find(".e-upicon, .e-downicon").children().width(Math.floor(this.element.find(".e-workcellstab").width()/this.element.find(".e-upicon").children().length));this.model.enableRTL?this.element.find(".e-upicon, .e-downicon").children().css("float","right"):this.element.find(".e-upicon, .e-downicon").children().css("float","left");this.element.find(".e-upicon, .e-downicon").children().css("visibility","hidden")}},_renderUpDownIconPosition:function(){var v,i,y,r,p;if(this.element.find(".e-upicon, .e-downicon").children().css("visibility","hidden"),this.element.find(".e-vscroll").length>0){var o=t.isNullOrUndefined(n("div#"+this._id+"_scroller").data("ejScroller")._scrollYdata)?this.element.height():n("div#"+this._id+"_scroller").data("ejScroller")._scrollYdata.scrollable,s=n("div#"+this._id+"_scroller").data("ejScroller").scrollTop(),h=s>o?o:s,w=h+this.element.find(".e-draggableworkarea").height(),k=parseInt(h/this.element.find(".e-workcells").outerHeight())+1,d=parseInt(w/this.element.find(".e-workcells").outerHeight()),u=this.element.find(".e-upicon"),f=this.element.find(".e-downicon"),g=(this.model.startHour*60+k*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*6e4,nt=this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount*6e4,tt=(this.model.startHour*60+d*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*6e4+nt,it=this._appointmentCount(),l=this;for(appointments=it.filter(function(n){return(n[l._appointmentSettings.endTime]-n[l._appointmentSettings.startTime])/36e5<24}),a=0;a<this._dateRender.length;a++){var rt=this.model.endHour<24?new Date(new Date(this._dateRender[a]).setHours(this.model.endHour,0,0)):new Date(new Date(this._dateRender[a]).setHours(23,59,59)),ut=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(new Date(this._dateRender[a]).setHours(this.model.startHour,0,0))).and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(rt)),e=new t.DataManager(appointments).executeLocal((new t.Query).where(ut));if(e.length!=0){if(v=new Date(new Date(this._dateRender[a]).setMilliseconds(g)),i=new t.DataManager(e).executeLocal((new t.Query).where(this._appointmentSettings.endTime,t.FilterOperators.lessThan,new Date(v))),i=this._appointmentSort(i).reverse(),!t.isNullOrUndefined(u)&&i.length!=0)if(this._grouping.length==0)n(u.children()[a]).css("visibility","visible");else for(b=0;b<this.res1.length;b++)y=new t.DataManager(i).executeLocal((new t.Query).where(this._appointmentSettings.resourceFields.split(",")[this._appointmentSettings.resourceFields.split(",").length-1],t.FilterOperators.equal,this.res1[b].id)),y.length!=0&&n(u.children()[a+b*this._dateRender.length]).css("visibility","visible");if(r=new t.DataManager(e).executeLocal((new t.Query).where(this._appointmentSettings.startTime,t.FilterOperators.greaterThan,new Date(new Date(this._dateRender[a]).setMilliseconds(tt)))),r=this._appointmentSort(r),!t.isNullOrUndefined(f)&&r.length!=0)if(this._grouping.length==0)n(f.children()[a]).css("visibility","visible");else for(c=0;c<this.res1.length;c++)p=new t.DataManager(r).executeLocal((new t.Query).where(this._appointmentSettings.resourceFields.split(",")[this._appointmentSettings.resourceFields.split(",").length-1],t.FilterOperators.equal,this.res1[c].id)),p.length!=0&&n(f.children()[a+c*this._dateRender.length]).css("visibility","visible")}}}},_renderAppPosition:function(i){var p=n(i.target).hasClass("e-appup")?"e-appup":"e-appdown",r=n(i.target).parent().index(),h=this._appointmentCount();switch(p){case"e-appup":var c=n("div#"+this._id+"_scroller").data("ejScroller").scrollTop(),e=parseInt(c/this.element.find(".e-workcells").outerHeight())+1,d=this.element.find(".e-draggableworkarea").find("tr")[e],u=(this.model.startHour*60+e*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*6e4,f=new Date(new Date(this.dateRender[r]).setMilliseconds(u)),l=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(this.dateRender[r])).and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(f)),a=new t.DataManager(h).executeLocal((new t.Query).where(l));if(a.length!=0){var w=Math.abs(a[0][this._appointmentSettings.startTime]-f),v=parseInt((u-w)/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount*6e4)),y=c-(e-v)*this.element.find(".e-workcells").height();n("div#"+this._id+"_scroller").ejScroller({scrollTop:y});this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")}break;case"e-appdown":var b=n("div#"+this._id+"_scroller").data("ejScroller").scrollTop()+n(this.element.find(".e-vscroll")[0]).height(),o=parseInt(b/this.element.find(".e-workcells").height()),g=this.element.find(".e-draggableworkarea").find("tr")[o],u=(this.model.startHour*60+o*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*6e4,f=new Date(new Date(this.dateRender[r]).setMilliseconds(u)),l=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(f)).and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(this.dateRender[r]).setHours(23,59,59))),s=new t.DataManager(h).executeLocal((new t.Query).where(l));if(s.length!=0){var k=f.getTime()-s[0][this._appointmentSettings.endTime].getTime(),v=parseInt((u-k)/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount*6e4)),y=n("div#"+this._id+"_scroller").data("ejScroller").scrollTop()+(v-o)*this.element.find(".e-workcells").height()+this.element.find("#Appointment_"+s[0].AppTaskId).height();n("div#"+this._id+"_scroller").ejScroller({scrollTop:y});this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")}}this._renderUpDownIconPosition();t.isNullOrUndefined(this.element.data("ejTooltip"))||this.element.ejTooltip("hide")},_findAllDayApp:function(n){if(n[this._appointmentSettings.allDay]!=!0){var i=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("ParentId",t.FilterOperators.equal,n.ParentId));return t.isNullOrUndefined(i[0])?!1:(i[0][this._appointmentSettings.endTime]-i[0][this._appointmentSettings.startTime])/36e5>=24?!0:!1}},_getDayAppointments:function(i,r){var l,f,a,o,v,h,y;this._appList=[];var e=this._dateRender,u=this._processed,c=this.model.endHour<24?new Date(new Date(e[i]).setHours(this.model.endHour,0,0)):new Date(new Date(e[i]).setHours(23,59,59)),p=t.Predicate(this._appointmentSettings.endTime,t.FilterOperators.greaterThanOrEqual,new Date(e[i])).and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(c)),w=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(e[i])).and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(c)),s=p.or(w);if(s=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?s.and(this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim(),t.FilterOperators.equal,this.res1[r][this._tempResource[this._tempResource.length-1].resourceSettings.id]):s,u=new t.DataManager(u).executeLocal((new t.Query).where(s)),l=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(new Date(e[i-1]).setHours(24,0,0))).or(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(e[i])),u=new t.DataManager(u).executeLocal((new t.Query).where(l)),this._appList=this._alldaySort(u),u=this._appointmentSort(u),(this._grouping.length==0&&this._tempResource.length!=0||this._grouping.length==0&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length==0)&&(u=this._sortAppById(u)),this._app=n.merge(this._app,u),this.model.orientation=="vertical")for(f=0;f<u.length;f++)a=(u[f][this._appointmentSettings.endTime]-u[f][this._appointmentSettings.startTime])/36e5>=24,o=u[f][this._appointmentSettings.allDay],new Date(new Date(e[i]).setHours(0,0,0,0)).getTime()==new Date(new Date(u[f][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&o||a?(this._setAllDayPos(u[f],i,r),this._filtered.push(u[f])):new Date(new Date(u[f][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(e[i]).setHours(0,0,0,0)).getTime()&&new Date(new Date(u[f][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()>=new Date(new Date(e[i]).setHours(0,0,0,0)).getTime()&&new Date(new Date(u[f][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()==new Date(new Date(u[f][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(t.isNullOrUndefined(o)||o==""?!1:o===!0?!0:o.toLowerCase()==="false"?!1:o)===!1&&new Date(new Date(u[f][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(u[f][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(v=(new t.Query).where("Guid",t.FilterOperators.equal,u[f].Guid),h=new t.DataManager(this._processed).executeLocal(v),o||(y=this._findAllDayApp(u[f])),y||h[0][this._appointmentSettings.allDay]&&Math.round((new Date(h[0][this._appointmentSettings.endTime])-new Date(h[0][this._appointmentSettings.startTime]))/36e5)>=24?(this._setAllDayPos(u[f],i,r),this._filtered.push(u[f])):(this._renderApp(u[f],i,r),this._filtered.push(u[f])));else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._getHorizontalDayAppointments(u,e,i,r)},_startUtc:function(n){!t.isNullOrUndefined(this.startutcValue)&&t.isNullOrUndefined(this.tempValue)?this._utcValue(n,"startUtc"):n.model.value==""?"":n.model.value==this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList("model.value")&&this._appointmentAddWindow.find("#"+this._id+"startTimeZone").attr("aria-expanded")=="true"?this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList("option",{text:n.text,value:n.value}):""},_endUtc:function(n){this._appointmentAddWindow.find("#"+this._id+"endTimeZone").attr("aria-expanded")=="true"?this._utcValue(n,"endUtc"):""},_utcValue:function(n,i){var h,p,w,b,l,a;t.preferredCulture(this.model.locale);i=="endUtc"?this._appointmentAddWindow.find(".endutc").val(n.text):"";var f=new Date(t.format(this._appointmentAddWindow.find("#"+this._id+"startdate").val(),this._datepattern())+" "+t.format(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("model.value"))),e=new Date(t.format(this._appointmentAddWindow.find("#"+this._id+"enddate").val(),this._datepattern())+" "+t.format(this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("model.value"))),v=new Date(f),k=new Date(e),u=i=="Appoint"?this.endTimeAppoint:i=="endUtc"?n.value:this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList("model.value"),r=i=="Appoint"?this.startTimeAppoint:i=="startUtc"?n.value:this._appointmentAddWindow.find("#"+this._id+"startTimeZone").ejDropDownList("model.value");if(r=r==""?this._timezoneStringValue():r,u=u==""?this._timezoneStringValue():u,u=u.indexOf("UTC")!=-1?parseInt(u.split(" ")[1].split(":")[0])*60+parseInt(u.split(" ")[1].split(":")[1]):parseInt(u.split(":")[0])*60+parseInt(u.split(":")[1]),r=r.indexOf("UTC")!=-1?parseInt(r.split(" ")[1].split(":")[0])*60+parseInt(r.split(" ")[1].split(":")[1]):parseInt(r.split(":")[0])*60+parseInt(r.split(":")[1]),h=u-r,f=new Date(f.setMinutes(f.getMinutes()+h)),i=="Appoint"){var y=new Date(n[this._appointmentSettings.startTime]),s=new Date(n[this._appointmentSettings.endTime]),c=t.isNullOrUndefined(this.model.timeZone)?-(new Date).getTimezoneOffset()+this._timeZoneOffset:this.model.timeZone.indexOf("UTC")!=-1?parseInt(this.model.timeZone.split(" ")[1].split(":")[0])*60+parseInt(this.model.timeZone.split(" ")[1].split(":")[1]):parseInt(this.model.timeZone.split(":")[0])*60+parseInt(this.model.timeZone.split(":")[1]),o=r==c?0:c-r;o=new Date(y.setMinutes(y.getMinutes()-o));p=this._timeMode=="12"?t.format(new Date(o),this._pattern.t):t.format(new Date(o),"HH:mm");this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker({value:t.format(new Date(o),this._datepattern())});w=u-c;this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker({value:p})}e=i=="endUtc"||i=="Appoint"?new Date(v.setMinutes(v.getMinutes()+h)):f;e=i=="Appoint"?new Date(s.setMinutes(s.getMinutes()+w)):e;b=this._timeMode=="12"?t.format(new Date(f),this._pattern.t):t.format(new Date(f),"HH:mm");i=="Appoint"?a=this._timeMode=="12"?t.format(new Date(s),this._pattern.t):t.format(new Date(s),"HH:mm"):(l=new Date(e.setMinutes(e.getMinutes()+30)),a=this._timeMode=="12"?t.format(new Date(l),this._pattern.t):t.format(new Date(l),"HH:mm"));this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker({value:t.format(new Date(e),this._datepattern())});this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker({value:a});this.startutcValue=1},_rowHandlesOver:function(t){this.model.enableAppointmentResize&&n(t.target).addClass("e-rowcursor")},_colHandlesOver:function(t){this.model.enableAppointmentResize&&n(t.target).addClass("e-columncursor")},_getDateCount:function(n){var u,i,r,f;if(this._resWorkWeek)for(f=[],i=t.isNullOrUndefined(this.res1[n][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?this.model.workWeek:this.res1[n][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek],i=this._resourceDaysReorder(i),r=0;r<i.length;r++)u=this._dayFullNames.indexOf(i[r].capitalizeFirstString()),u==-1&&(u=this._getDayNameIndex(i[r])),f.push(this._renderDates[u]);else f=this._dateRender;return f},_renderApp:function(i,r,u){var v=this.cellheight,l=parseInt(this.model.startHour)<parseInt(this.model.endHour)?parseInt(this.model.startHour):0,a=parseInt(this.model.startHour)<parseInt(this.model.endHour)?parseInt(this.model.endHour):24,y=this._getDateCount(u),f=new Date(i[this._appointmentSettings.startTime]),o=new Date(i[this._appointmentSettings.endTime]),h,p,ct,w,d,it,ft,ot,e,b,s,st,ht,ut,nt,c,tt;if(new Date(f).getHours()<l&&(f=new Date(new Date(f).setHours(l,f.getMinutes(),f.getSeconds()))),this.model.orientation=="vertical"){if(ct=parseInt(w*60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount),f<=o&&new Date(y[0]).getTime()<=f.getTime()&&new Date(new Date(y[y.length-1]).setHours(23,59,59))>=f.getTime()&&(w=new Date(f).getHours()<l?new Date(f).getHours()+-new Date(f).getHours()+-new Date(f).getMinutes():new Date(f).getHours()+-l,d=new Date(o).getHours()>a?new Date(o).getHours()+(-new Date(o).getHours()+(a-l))+-new Date(o).getMinutes():new Date(o).getHours()+-l,d=new Date(o).getHours()==a?new Date(d).getMinutes()+-new Date(o).getMinutes():d,a<=o.getHours()?(it=new Date(o.setHours(a,00,00)),p=parseFloat(new Date(it).getHours()*60+new Date(it).getMinutes()-(new Date(f).getHours()*60+new Date(f).getMinutes()))*v*this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot-2):(p=parseFloat(new Date(new Date(o).getTime())-new Date(new Date(f).getTime()))/6e4*v*this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot-2,i[this._appointmentSettings.endTime].getTimezoneOffset()-i[this._appointmentSettings.startTime].getTimezoneOffset()!=0&&(p=p-v*this.model.timeScale.minorSlotCount)),ft=(parseFloat(new Date(f).getHours()*60+new Date(f).getMinutes()+new Date(f).getSeconds()/60)-parseInt(w*60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-this.model.startHour*60)*v*(this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot),this.model.startHour<=new Date(f).getHours())){var lt=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?this.res1[u][this._tempResource[this._tempResource.length-1].resourceSettings.id]:null,rt=this._overlapApp(i.AppTaskId,i[this._appointmentSettings.startTime],i[this._appointmentSettings.endTime],lt),g=t.Predicate(this._appointmentSettings.endTime,t.FilterOperators.greaterThan,i[this._appointmentSettings.startTime]).and(this._appointmentSettings.startTime,t.FilterOperators.lessThan,i[this._appointmentSettings.endTime]);g=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?g.and(this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim(),t.FilterOperators.equal,this.res1[u][this._tempResource[this._tempResource.length-1].resourceSettings.id]):g;var et=new t.DataManager(rt).executeLocal((new t.Query).where(g)),wt=this,c=-1;for(et.length>0&&(ot=n.map(et,function(n){return[n.Index]}),c=this._smallestMissingNumber(ot)),c=c==-1?0:c,i.Index=c,rt.push(i),rt.length!=1?t.isNullOrUndefined(this._variable[c])?this._variable.push([i]):this._variable[c].push(i):(this._variable=[],this._variable.push([i])),h=(90-this._variable.length)/this._variable.length+"%",this.leftPosition="0%",e=0;e<this._variable.length;e++)for(b=0;b<this._variable[e].length;b++)s=this.element.find("[guid="+this._variable[e][b].Guid+"]"),t.isNullOrUndefined(s[0])||this._variable[e][b].Guid==i.Guid?(h=t.isNullOrUndefined(this._variable[e-1])?(90-this._variable.length)/this._variable.length:!t.isNullOrUndefined(this.element.find("[guid="+this._variable[e-1][0].Guid+"]")[0])&&parseFloat(this.element.find("[guid="+this._variable[e-1][0].Guid+"]")[0].style.width),this.leftPosition=(h+1)*c+"%"):parseFloat(h)<=parseFloat(s[0].style.width)?(this.model.enableRTL?s[0].style.right=(parseFloat(h)+1)*e+"%":s[0].style.left=(parseFloat(h)+1)*e+"%",s[0].style.width=parseFloat(h)+"%"):(st=this.element.find("[guid="+this._variable[t.isNullOrUndefined(this._variable[e-1])?e:e-1][0].Guid+"]"),s[0].style.width=st[0].style.width,this.model.enableRTL?s[0].style.right=(parseFloat(s[0].style.width)+1)*e+"%":s[0].style.left=(parseFloat(s[0].style.width)+1)*e+"%");h=parseFloat(h)+"%";this._renderedApp.push(i);var k=this._appointmentColor(i),at=this.model.appointmentTemplateId?!0:!1,vt=this._getUserAppointmentTemplate(i),yt=this._timeMode=="12"?t.format(i[this._appointmentSettings.startTime],this._pattern.t):t.format(i[this._appointmentSettings.startTime],"HH:mm"),pt=this._timeMode=="12"?t.format(i[this._appointmentSettings.endTime],this._pattern.t):t.format(i[this._appointmentSettings.endTime],"HH:mm");t.isNullOrUndefined(i[this._appointmentSettings.recurrenceRule])||(ht=i[this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1);ut=this._indicationApp(i);nt=n(this.appTemplate.render({id:i.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),appHeight:p,rtl:this.model.enableRTL,subject:i[this._appointmentSettings.subject],startTime:yt,endTime:pt,left:this.leftPosition,top:ft,appWidth:h,userAppTemplId:at,userTemplate:vt,appClass:"e-appointment",appointData:k.appointColor.appointData,appointCustomcss:k.appointColor.appointCustomcss,appointtextcolor:k.appointColor.appointtextcolor,value:k.value,multiDiv:k.multiDiv,orientation:this.model.orientation,priority:this.model.prioritySettings.enable?i[this._appointmentSettings.priority]:"",enablePriority:this.model.prioritySettings.template,priorityTemplate:this.model.prioritySettings.template?this._priorityTemplate(i):i[this._appointmentSettings.priority],uid:i.Guid,recurrence:i[this._appointmentSettings.recurrence],recurrenceEdit:ht,topInd:ut.leftIndication,bottomInd:ut.rightIndication}));t.isNullOrUndefined(this.model.queryCellInfo)||this._renderQueryCellInfo("appointment",i,nt);c=this._resWorkWeek?w*this.model.timeScale.minorSlotCount*this.element.find(".e-headercells").length+r:parseInt(w*60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*y.length*this.res1.length+r+y.length*u;tt=n(this.element.find("td.e-workcells")[c]);tt.find("div.e-appointwrapper").length>0?tt.find("div.e-appointwrapper").append(nt):tt.prepend(n("<div class='e-appointwrapper'><\/div>").append(nt))}}else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._renderHorizontalApp(f,o,i,r,v,this.model.timeScale.minorSlotCount,l,a)},_priorityTemplate:function(n){return this.model.prioritySettings.template.replace("{","").replace("$","").replace("}","").replace(this.model.prioritySettings.template.indexOf("value")!=-1?this.model.prioritySettings.value:this.model.prioritySettings.text,n[this._appointmentSettings.priority])},_getUserAppointmentTemplate:function(t){var r=n.templates(n(this.model.appointmentTemplateId).html()),i=n.extend(i,t);return i.View=this.currentView(),r.render(i)},_getUserTimeCellsTemplate:function(){for(var t,f=n.templates(n(this.model.timeScale.minorSlotTemplateId).html()),r,u=[],i=this.model.startHour;i<this.model.endHour;){for(t=0;t<60;)t=t*6e4,r=f.render(object={date:new Date(new Date(this._dateRender[0]).setHours(i,0,0,t))}),u.push({time:r.trim(),id:i+"_"+t}),t=t/6e4+this.model.timeScale.majorSlot;i=this.model.timeScale.majorSlot>60?i+this.model.timeScale.majorSlot/60:i+1}return u},_getUserAllDayCellsTemplate:function(){var t=[],i,r,u;for(r=n.templates(n(this.model.allDayCellsTemplateId).html()),a=0;a<this.res1.length;a++)for(b=0;b<this._dateRender.length;b++)i=new Date(new Date(this._dateRender[b]).setHours(this.model.startHour,0,0)),u=r.render(object={date:i,view:this.currentView(),resource:this.res1[a],timescale:this.model.timeScale.enable}),t.push(u.trim());return t},_getUserDateheaderTemplate:function(){var u=[],f,e,o,r,s;for(f=n.templates(n(this.model.dateHeaderTemplateId).html()),i=0;i<this._dateRender.length;i++)e=f.render(object={date:new Date(this._dateRender[i])}),o=this.currentView()==="month"||this.currentView()==="day"||this._isCustomMonthView()?this._tempResource.length==0&&t.isNullOrUndefined(this.model.group)?this._dayFullNames[new Date(this._dateRender[i]).getDay()]:this._dayShortNames[new Date(this._dateRender[i]).getDay()]:this._dayShortNames[new Date(this._dateRender[i]).getDay()],r=new Date(new Date(this._dateRender[i]).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()?"e-headerToday":"",s=this.currentView()==="month"||this._isCustomMonthView()?{currentDay:o,currentDateClass:"",cellToday:r}:{currentDay:e,currentDateClass:new Date(this._dateRender[i]).getDate()===new Date(this.currentDate()).getDate()?"e-activeview":"",cellToday:r},u.push(s),this._value.push(i);return u},_getUserWorkCellsTemplate:function(){var i,t=[],e=[],f,u,r=0,s=this.model.timeScale.minorSlotCount,h,k,g,p;if(f=n.templates(n(this.model.workCellsTemplateId).html()),this._isCustomMonthView(),this.model.orientation=="vertical")if(this.currentView()!="month"||this.currentView()=="customview"&&this._oneWeek)for(a=0;a<(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot);a++){for(t=[],b=0;b<this.res1.length;b++)for(c=0;c<this._dateRender.length;c++)i=new Date(new Date(this._dateRender[c]).setHours(this.model.startHour,r,0)),u=f.render(object={date:i,view:this.currentView(),resource:this.res1[b],timescale:this.model.timeScale.enable}),t.push(u.trim());r=r+this.model.timeScale.majorSlot/s;e.push(t)}else for(h=0,a=0;a<this._dateRender.length/7;a++){for(t=[],b=0;b<this.res1.length;b++)for(h=a*7,c=0;c<7;c++)i=new Date(new Date(this._dateRender[h]).setHours(this.model.startHour,r,0)),u=f.render(object={date:i,view:this.currentView(),resource:this.res1[b],timescale:this.model.timeScale.enable}),t.push(u.trim()),h++;e.push(t)}else{var w,l=[],v=[],y=[],o=this._tempResource.length==0?this.res1:this._resourceSort();if(this.model.timeScale.enable&&this.currentView()!="month"||this.currentView()=="customview"&&this._oneWeek)for(a=0;a<o.length;a++){for(t=[],v=[],y=[],b=0;b<this._dateRender.length;b++)for(r=0,c=0;c<(this.model.endHour-this.model.startHour)*(60/this.model.timeScale.majorSlot);c++)for(d=0;d<s;d++)i=new Date(new Date(this._dateRender[b]).setHours(this.model.startHour,r,0)),d==0?(u=f.render(object={date:i,view:this.currentView(),resource:o[a],timescale:this.model.timeScale.enable}),t.push(u.trim())):(w=f.render(object={date:i,view:this.currentView(),resource:o[a],timescale:this.model.timeScale.enable}),l.push(w.trim()),l.length==s-1&&(y.push(l),l=[])),r=r+this.model.timeScale.majorSlot/s;k=n.extend(!0,[],t);g=n.extend(!0,[],y);v.push(k,g);e.push(v)}else for(p=!this.model.timeScale.enable&&this.currentView()!="month"||this.currentView()=="customview"&&this._oneWeek?this._dateRender:this._horizontalMonthDates(),a=0;a<o.length;a++){for(t=[],b=0;b<p.length;b++)i=new Date(new Date(p[b]).setHours(this.model.startHour,r,0)),u=f.render(object={date:i,view:this.currentView(),resource:o[a],timescale:this.model.timeScale.enable}),t.push(u.trim());e.push(t)}}return e},_overlapApp:function(i,r,u,f){var o,s,c,h,e;if(this.overlapList=[],app=[],this.appointmentsList=[],this._appList=this._appointmentSort(this._renderedApp),this.model.orientation=="vertical"){for(o=t.Predicate(this._appointmentSettings.endTime,t.FilterOperators.greaterThan,new Date(r)).and(this._appointmentSettings.startTime,t.FilterOperators.lessThan,new Date(u)),o=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?o.and(this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim(),t.FilterOperators.equal,f):o,this.appointmentsList=new t.DataManager(this._appList).executeLocal((new t.Query).where(o)),e=0;e<this.appointmentsList.length;e++)s=t.Predicate(this._appointmentSettings.endTime,t.FilterOperators.greaterThanOrEqual,new Date(this.appointmentsList[e][this._appointmentSettings.startTime])).and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(this.appointmentsList[e][this._appointmentSettings.endTime])),s=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?o.and(this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim(),t.FilterOperators.equal,f):s,c=new t.DataManager(this._appList).executeLocal((new t.Query).where(s)),h=n(c).not(this.appointmentsList),h.length!=0&&(app=n.merge(app,h));this.overlapList=n.merge(this.appointmentsList,app)}else if(this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal)for(e=0;e<this._appList.length;e++)t.scheduleFeatures.resources&&this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)?new Date(this._appList[e][this._appointmentSettings.endTime])>new Date(r)&&new Date(this._appList[e][this._appointmentSettings.startTime])<=new Date(u)&&this._appList[e][this._tempResource[this._tempResource.length-1].field]==f&&new Date(new Date(this._appList[e][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()===new Date(new Date(r).setHours(0,0,0,0)).getTime()&&this.overlapList.push(this._appList[e]):new Date(this._appList[e][this._appointmentSettings.endTime])>new Date(r)&&new Date(this._appList[e][this._appointmentSettings.startTime])<=new Date(u)&&new Date(new Date(this._appList[e][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()===new Date(new Date(r).setHours(0,0,0,0)).getTime()&&this.overlapList.push(this._appList[e]);return this.overlapList},_getOverlapCount:function(i,r,u,f){var s,h,l,a,o,c;if(this._renderedAllDay.length==0)i.Index=0,o=0;else{var c=[],e=this._renderedAllDay,v=t.Predicate(this._appointmentSettings.endTime,t.FilterOperators.greaterThanOrEqual,new Date(u[r])).and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(u[r]).setHours(23,59,59))),y=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(u[r])).and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(u[r]).setHours(23,59,59))),p=v.or(y);if(e=new t.DataManager(e).executeLocal((new t.Query).where(p)),e=this._appointmentSort(e),s=[],this.model.orientation=="vertical")for(h=0;h<e.length;h++)l=(e[h][this._appointmentSettings.endTime]-e[h][this._appointmentSettings.startTime])/36e5>=24,a=e[h][this._appointmentSettings.allDay],(new Date(new Date(u[r]).setHours(0,0,0,0)).getTime()==new Date(new Date(e[h][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&a||l)&&(t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)?e[h][this._tempResource[this._tempResource.length-1].field]==f:!0)&&s.push(e[h]);else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(s=this._getHorizontalOverlapCount(e,u,r,i,f));s=this._sortAppById(s);s=this._appointmentSort(s);o=-1;o=this._findResourceIndex(s,"AppTaskId",i.AppTaskId);c=n.map(s,function(n){return[n.Index]});o=this._smallestMissingNumber(c);i.Index=o;o=o==-1?0:o}return o},_smallestMissingNumber:function(n){var i,t;if(n.length==0)return 0;for(i=Math.max.apply(Math,n),t=0;t<i;t++)if(n.indexOf(t)==-1)return t;return i+1},_setAllDayPos:function(i,r,u){var d,p,g,l,ot,w,a,h,v,ct,ht,c,rt,ut;this.overlapList=[];var o=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this._getOverlapCount(i,r,this._dateRender,i[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim()]):this._getOverlapCount(i,r,this._dateRender,null),e=i[this._appointmentSettings.startTime],f=i[this._appointmentSettings.endTime];if(new Date(e)<=new Date(f)){var s=this._dateRender,ft,b=0,k=16,et=19;if(this.level<=o&&(d=(o+1)*et+27,this._mediaQuery?(this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd").attr("style","height:"+(o==0?40:d)+"px !important"),this.element.find(".e-alldaycells").first().css(this.model.enableRTL?"border-right":"border-left","none")):this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd").css("height",d+"px")),this._overflowFlag=!0,this.model.showAppointmentNavigator&&this.model.orientation=="vertical"&&this.element.find(".e-vscroll").length>0&&this.currentView()!="month"&&!this._isCustomMonthView()&&!this._mediaQuery&&(this._renderUpDownIcon(),this.element.find(".e-upicon, .e-downicon").width(this.element.find(".e-workcellstab").width()),this.element.find(".e-appup, .e-appdown").css("pointer-events","visible"),this.element.find(".e-upicon, .e-downicon").children().width(Math.floor(this.element.find(".e-workcellstab").width()/this.element.find(".e-upicon").children().length)),this._renderUpDownIconPosition()),this._resWorkWeek){for(g=[],p=t.isNullOrUndefined(this.res1[u][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?this.model.workWeek:this.res1[u][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek],l=0;l<p.length;l++)h=this._dayFullNames.indexOf(p[l].capitalizeFirstString()),h==-1&&(h=this._getDayNameIndex(p[l])),g.push(this._renderDates[h]);s=g}if(ot=new Date(s[0]),w=new Date(s[s.length-1]),w.setHours(23,59,59),f=new Date(f)>new Date(w)?w:f,this.currentView()=="workweek"&&n.inArray(new Date(f.getFullYear(),f.getMonth(),f.getDate()).getTime(),this._dateRender)==-1)for(a=1;a<this._dateRender.length;a++)if(n.inArray(new Date(f.getFullYear(),f.getMonth(),f.getDate()-a).getTime(),this._dateRender)>0){h=n.inArray(new Date(f.getFullYear(),f.getMonth(),f.getDate()-a).getTime(),this._dateRender);f=new Date(new Date(this._dateRender[h]).setHours(i[this._appointmentSettings.endTime].getHours(),i[this._appointmentSettings.endTime].getMinutes(),i[this._appointmentSettings.endTime].getSeconds()));break}this._renderedAllDay.push(i);ct=Math.ceil((new Date(e)-new Date(ot))/864e5);v=this._resWorkWeek||this.currentView()=="workweek"?n.inArray(new Date(f.getFullYear(),f.getMonth(),f.getDate()).getTime(),s)-n.inArray(new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),s)+1:this.currentView()=="week"||this.currentView()=="day"||this.currentView()=="customview"&&parseFloat((f-e)/36e5)<=24?e.getHours()==0&&f.getHours()==0?Math.ceil((new Date(f)-new Date(e))/864e5):Math.ceil((new Date(f).setHours(23,59,59)-new Date(e).setHours(0,0,0))/864e5):n.inArray(new Date(f.getFullYear(),f.getMonth(),f.getDate()).getTime(),this._dateRender)-n.inArray(new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),this._dateRender)+1;v<=0&&(v=1);var lt=this.element.find(".e-alldaycells").width(),nt=this.currentView()==="week"?7:this.currentView()==="workweek"?this.model.workWeek.length:this.currentView()=="customview"&&this._renderDays<=7?this._renderDays:1,tt=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this._grouping.length:0,at=new Date(new Date(e).getFullYear(),new Date(e).getMonth(),new Date(e).getDate()),it=this.currentView()==="day"?0:this.currentView()==="workweek"&&this._firstdayofweek==0&&this.model.workWeek[0]=="Monday"&&this.model.workWeek[4]=="Friday"?new Date(e).getDay()-1:this._firstdayofweek||this.model.workWeek.length>0||this.currentView()=="customview"&&(this._renderDays<=7||this.model.orientation=="horizontal")?this._dateRender.indexOf(at.getTime()):new Date(e).getDay();this._resWorkWeek?b=this.model.enableRTL?this.element.find(".e-headrealldaytable").width()-this.element.find(".e-alldaycells")[r].offsetLeft-this.element.find(".e-alldaycells").width():this.element.find(".e-alldaycells")[r].offsetLeft:t.isNullOrUndefined(this.element.find(".e-alldaycells")[it+u*nt])||(b=this.model.enableRTL?this.element.find(".e-headrealldaytable").width()-this.element.find(".e-alldaycells")[it+u*nt].offsetLeft-this.element.find(".e-alldaycells").width():this.element.find(".e-alldaycells")[it+u*nt].offsetLeft);ft=v*lt+v-2;k=o*k+3*(o+1)+this.element.find(".e-headercells").height()+1+(tt!=0?tt*this.element.find(".e-headerbar").first().height():tt);var y=this._appointmentColor(i),st=this.model.appointmentTemplateId?!0:!1,vt=st&&this._getUserAppointmentTemplate(i),yt=this._timeMode=="12"?t.format(i[this._appointmentSettings.startTime],this._pattern.t):t.format(i[this._appointmentSettings.startTime],"HH:mm"),pt=this._timeMode=="12"?t.format(i[this._appointmentSettings.endTime],this._pattern.t):t.format(i[this._appointmentSettings.endTime],"HH:mm");i[this._appointmentSettings.recurrence]&&(ht=i[this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1);c=this._indicationApp(i);rt=n(this.appTemplate.render({id:i.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),top:k,appHeight:et,rtl:this.model.enableRTL,subject:i[this._appointmentSettings.subject],startTime:yt,endTime:pt,appWidth:ft+"px",allday:!0,left:b+"px",userAppTemplId:st,userTemplate:vt,appClass:"e-alldayappointment",appointData:y.appointColor.appointData,appointCustomcss:y.appointColor.appointCustomcss,appointtextcolor:y.appointColor.appointtextcolor,value:y.value,multiDiv:y.multiDiv,orientation:this.model.orientation,priority:this.model.prioritySettings.enable?i[this._appointmentSettings.priority]:"",enablePriority:this.model.prioritySettings.template,priorityTemplate:this.model.prioritySettings.template?this._priorityTemplate(i):i[this._appointmentSettings.priority],uid:i.Guid,recurrence:i[this._appointmentSettings.recurrence],recurrenceEdit:ht,leftInd:c.leftIndication,rightInd:c.rightIndication}));t.isNullOrUndefined(this.model.queryCellInfo)||this._renderQueryCellInfo("appointment",i,rt);this.element.find(".e-headrealldaytable").append(rt)}this._alldayLevel=!1;this.level=this.level<o?o:this.level;i[this._appointmentSettings.recurrence]!=1&&(ut=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,i.ParentId)),new Date(i[this._appointmentSettings.endTime])<ut[0][this._appointmentSettings.endTime]&&(this.model.enableRTL?this.element.find("[guid="+i.Guid+"]").children(".e-lefthandle").remove():this.element.find("[guid="+i.Guid+"]").children(".e-righthandle").remove()),new Date(i[this._appointmentSettings.startTime])>ut[0][this._appointmentSettings.startTime]&&(this.model.enableRTL?this.element.find("[guid="+i.Guid+"]").children(".e-righthandle").remove():this.element.find("[guid="+i.Guid+"]").children(".e-lefthandle").remove()));t.isNullOrUndefined(c)||(c.leftIndication&&(this.model.enableRTL?this.element.find("[guid="+i.Guid+"]").find(".e-schedulemouseclose").css("margin-left","11px"):this.element.find("[guid="+i.Guid+"]").find(".e-apptime,.e-apptext").css("margin-left","13px")),c.rightIndication&&(this.model.enableRTL?this.element.find("[guid="+i.Guid+"]").find(".e-apptime,.e-apptext").css("margin-right","13px"):this.element.find("[guid="+i.Guid+"]").find(".e-schedulemouseclose").css("margin-right","11px")))},_indicationApp:function(i){var r=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,i.ParentId))[0],u,f,o,s,h,e,c,l;return r[this._appointmentSettings.endTime].getHours()==0&&r[this._appointmentSettings.endTime].getMinutes()==0&&(r[this._appointmentSettings.endTime]=new Date(r[this._appointmentSettings.endTime].getTime()-1e3)),h=this.currentView()=="day"?[new Date(this._dateRender[0]).getTime()]:this._dateRender,e=this.currentView()=="month"&&new Date(new Date(r[this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(r[this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(r[this._appointmentSettings.endTime]-r[this._appointmentSettings.startTime])/36e5<24,o=n.inArray(new Date(new Date(i[this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime(),h),s=n.inArray(new Date(new Date(i[this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime(),h),i[this._appointmentSettings.recurrence]?(c=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,i.Guid)),c.length>1&&(l=this._sortAppById(c),(l[0][this._appointmentSettings.startTime]<i[this._appointmentSettings.startTime]||o==-1)&&!e&&(this.model.enableRTL?u=!0:f=!0),(l[1][this._appointmentSettings.endTime]>i[this._appointmentSettings.endTime]||s==-1)&&!e&&(this.model.enableRTL?f=!0:u=!0))):((new Date(r[this._appointmentSettings.startTime])<i[this._appointmentSettings.startTime]||o==-1)&&!e&&(this.model.enableRTL?u=!0:f=!0),(new Date(r[this._appointmentSettings.endTime])>i[this._appointmentSettings.endTime]||s==-1)&&!e&&(this.model.enableRTL?f=!0:u=!0)),{leftIndication:f,rightIndication:u}},_reRenderScroller:function(){var r=this._appointmentAddWindow.data("ejDialog"),f,n;r.option("enableAnimation",!1);r.close();var i=this.element.find("div#"+this._id+"_scroller"),u=i.data("ejScroller"),e=this.model.orientation==="vertical"?parseInt(this.element.width())-(this._mediaQuery&&(this.currentView()=="month"||this._isCustomMonthView())?1:parseInt(this.element.find(".e-scrolltimecells").parent().outerWidth())):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?parseInt(this.element.width())-parseInt(this.element.find(".e-resourceheadertable").width()):parseInt(this.element.width());u.model.width=parseInt(e)-2;u.model.height=this.scHeight-1-(this.wTR.find(".e-draggableworkarea").offset().top-this.element.offset().top);u.refresh();this.model.cellWidth!=""&&(f=this.currentView()=="workweek"?this.model.workWeek.length:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,n=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this.res1.length*f:f,this.model.orientation=="horizontal"&&(n=n+this.element.find(".e-workcellstab").find("tr:first").children().length),this.wTR.find(".e-draggableworkarea").width(this.element.width()>(parseInt(this.model.cellWidth)+1)*n+this.wTR.find(".e-scrolltimecells").parent().width()+(i.ejScroller("isVScroll")?18:0)?(parseInt(this.model.cellWidth)+1)*n-1:e-2-(i.ejScroller("isVScroll")?18:0)),this.aTR.find(".e-headeralldaydiv").width(this.wTR.find(".e-draggableworkarea").width()));this.model.orientation=="vertical"&&this._mediaQuery&&this.res1.length>1&&this.element.find(".e-draggableworkarea").width(this.element.find(".e-draggableworkarea").width()*this.res1.length);this.aTR.find(".e-headeralldaydiv").width(this.wTR.find(".e-draggableworkarea").width());this.wTR.find(".e-scrolltimecells").css("top",-this.wTR.find(".e-draggableworkarea").scrollTop()+"px");this._mediaQuery&&this._appointmentAddWindow.ejDialog("close");r.option("enableAnimation",!0);this.model.orientation=="horizontal"&&i.ejScroller("isVScroll")&&this._renderHoriVerticalScroll();this._showScrollTd()},_appointmentSort:function(n){var t=this;return this.currentView()!="day"?n.sort(function(n,i){var o=n[t._appointmentSettings.endTime]-n[t._appointmentSettings.startTime],s=i[t._appointmentSettings.endTime]-i[t._appointmentSettings.startTime],f=new Date(n[t._appointmentSettings.startTime]),e=new Date(i[t._appointmentSettings.startTime]),h=new Date(n[t._appointmentSettings.endTime]),c=new Date(i[t._appointmentSettings.endTime]),r=n[t._appointmentSettings.startTime],u=i[t._appointmentSettings.startTime];return f==e&&h==c?r-u||n.Guid.localeCompare(i.Guid):f-e==0?s-o||r-u||n.Guid.localeCompare(i.Guid):r-u||n.Guid.localeCompare(i.Guid)}):n.sort(function(n,i){var r=n[t._appointmentSettings.startTime],u=i[t._appointmentSettings.startTime],f=n[t._appointmentSettings.endTime]-n[t._appointmentSettings.startTime],e=i[t._appointmentSettings.endTime]-i[t._appointmentSettings.startTime];return r-u||e-f||n.Guid.localeCompare(i.Guid)}),n},_alldaySort:function(n){for(var i=[],t=0;t<n.length;t++)(new Date(n[t][this._appointmentSettings.endTime])-new Date(n[t][this._appointmentSettings.startTime]))/36e5<24&&!n[t][this._appointmentSettings.allDay]&&i.push(n[t]);return i},_appointmentRecurrenceSort:function(n){var t=this;return n.sort(function(n,i){var r=n[t._appointmentSettings.startTime],u=i[t._appointmentSettings.startTime];return r-u}),n},_renderMonthAppointment:function(){var h,r,i,e,o,u,l,c,s,a,f,v;for(this.filterData=[],h=[],this._app=[],this._renderedApp=[],r=this.model.orientation=="vertical"?this.currentView()=="month"&&!this.model.showNextPrevMonth?this.monthDays:this._dateRender:this.monthDays,i=this._processed,i=this._sortAppById(i),i=this._appointmentSort(i),e=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(r[0])),e=e.and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(r[r.length-1]).setHours(23,59,59))),this._appointmentsList=new t.DataManager(i).executeLocal((new t.Query).where(e)),i=this._appointmentsList,r=this.model.orientation=="vertical"?this._dateRender:this.monthDays,this.model.group&&(this._tempResource.length==0||this._tempResource[0].resourceSettings.dataSource.length!=0)||(this.res1=["0"]),o=0;o<this.res1.length;o++)for(u=0,c=r.length,new Date(r[0])<this.model.minDate&&(u=Math.floor((new Date(this.model.minDate)-new Date(r[0]))/864e5)),new Date(r[r.length-1])>this.model.maxDate&&(l=Math.floor((new Date(r[r.length-1])-new Date(this.model.maxDate))/864e5),c=r.length-l),u;u<c;u++)for(s=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(r[u])),s=s.and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(r[u]).setHours(23,59,59))),s=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?e.and(this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim(),t.FilterOperators.equal,this.res1[o][this._tempResource[this._tempResource.length-1].resourceSettings.id]):e,i=new t.DataManager(this._appointmentsList).executeLocal((new t.Query).where(s)),a=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(r[u])),i=new t.DataManager(i).executeLocal((new t.Query).where(a)),i=this._appointmentSort(i),this._app=n.merge(this._app,i),f=0;f<i.length;f++)v=this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&this._grouping.length>1?new t.DataManager(this._tempResource[this._tempResource.length-1].resourceSettings.dataSource).executeLocal((new t.Query).where(this._tempResource[this._tempResource.length-1].resourceSettings.groupId,t.FilterOperators.equal,i[f][this._appointmentSettings.resourceFields.split(",")[this._appointmentSettings.resourceFields.split(",").length-2]])):this.res1,v.length!=0&&new Date(new Date(r[u]).setHours(0,0,0,0)).getTime()==new Date(new Date(i[f][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(r[u]).setHours(0,0,0,0)).getTime()<=new Date(new Date(i[f][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(i[f][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(i[f][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(this._renderAppointmentMonth(i[f],u,o),h.push(i[f]));this.model.showAppointmentNavigator&&this._nextPrevButton(h)},_wireResizeEvents:function(){if(this.model.enableAppointmentResize&&!this.model.readOnly){this.element.find("div.e-lefthandle,div.e-righthandle,div.e-tophandle,div.e-bottomhandle").on("mousedown",n.proxy(this._appointmentResizeStart,this));this._on(this.element.find("div.e-lefthandle,div.e-righthandle"),"mouseover",n.proxy(this._colHandlesOver,this));this._on(this.element.find("div.e-tophandle,div.e-bottomhandle"),"mouseover",n.proxy(this._rowHandlesOver,this))}},_unWireResizeEvents:function(){this.model.enableAppointmentResize&&(this.element.find("div.e-lefthandle,div.e-righthandle,div.e-tophandle,div.e-bottomhandle").off("mousedown",n.proxy(this._appointmentResizeStart,this)),this._off(this.element.find("div.e-lefthandle,div.e-righthandle"),"mouseover",n.proxy(this._colHandlesOver,this)),this._off(this.element.find("div.e-tophandle,div.e-bottomhandle"),"mouseover",n.proxy(this._rowHandlesOver,this)))},_recuCollectionIndex:function(n,t){for(var r,u=this._appointmentSettings,i=0;i<n.length;i++)if(n[i].Guid==t.Guid&&n[i].AppTaskId==t.AppTaskId){r=i;break}return r},_getIndex:function(i,r,u,f,e){var l,a,o,h,s,c;if(this._renderedApp.length==0)r.Index=0,s=0;else{for(c=[],l=this,f=this._sortAppById(f),f=this._appointmentSort(f),a=u.length,o=[],h=0;h<f.length;h++)(t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0?f[h][this._tempResource[this._tempResource.length-1].field]==e:!0)&&new Date(new Date(f[h][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(u[i]).setHours(0,0,0,0)).getTime()&&new Date(new Date(f[h][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()>=new Date(new Date(u[i]).setHours(0,0,0,0)).getTime()&&new Date(new Date(f[h][this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(f[h][this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&o.push(f[h]);this.overlapList=o;o=this._sortAppById(o);o=this._appointmentSort(o);s=-1;o.length>0&&(s=this._findResourceIndex(o,"AppTaskId",r.AppTaskId),c=n.map(o,function(n){return[n.Index]}),s=this._smallestMissingNumber(c));s=s==-1?0:s;r.Index=s}return s},_recurrenceLocal:function(){var r=t.RecurrenceEditor.Locale[this.model.locale]=n.extend(!0,{},t.RecurrenceEditor.Locale["en-US"]),i=this;n.each(r,function(n){t.RecurrenceEditor.Locale[i.model.locale][n]=i._getLocalizedLabels(n)})},_renderAppointmentMonth:function(i,r){var nt=this.model.orientation=="vertical"?this._dateRender:this.monthDays,tt=this.model.orientation=="vertical"?"td.e-monthcells":"td.e-workcells",yt=this._renderedApp,y=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0?this._getIndex(r,i,nt,yt,i[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim()]):this._getIndex(r,i,nt,yt,null),w=new Date(i[this._appointmentSettings.startTime]),pt=new Date(i[this._appointmentSettings.endTime]),e,l=0,st,a,it,b,u,ht,ft,h,at,ni,rt,c,f,ot,vt;this.leftPosition=0;this.CellWidth=this.model.orientation=="vertical"?this.element.find(".e-monthcells").width():this.element.find(".e-workcells").width();this.CellHeight=this.model.orientation=="vertical"?this.element.find(".e-monthcells").height():this.element.find(".e-workcells").height();var k=new Date(w),d=new Date(pt),wt=new Date(new Date(nt[nt.length-1]).setHours(23,59,59));if(d=d>wt?wt:d,this._renderedApp.push(i),st=this._firstdayofweek==0?7-new Date(k).getDay():7-new Date(k).getDay()+this._firstdayofweek,!this.model.timeScale.enable&&this._oneWeek&&(st=7-nt.indexOf(k.getTime())),a=k.getHours()==0&&d.getHours()==0?Math.ceil((new Date(d)-new Date(k))/864e5):Math.ceil((new Date(d).setHours(23,59,59)-new Date(k).setHours(0,0,0))/864e5),d.getTimezoneOffset()-k.getTimezoneOffset()!=0&&(a-=1),w<=pt){this.model.orientation=="vertical"?(a=a>=st?st:a,it=Math.ceil((r+1)/7),e=a*this.CellWidth-this.CellWidth/20):e=!this.model.timeScale.enable||this.currentView()=="month"||this._isCustomMonthView()?this.model.cellWidth!=""?a*this.CellWidth+a:a*this.CellWidth:this.CellWidth*a-parseInt(this.CellWidth/10);b=this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this._findResourceIndex(this.res1,this._tempResource[this._tempResource.length-1].resourceSettings.id,i[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim()]):0;u=this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this.model.orientation=="vertical"?this.currentView()=="day"?b+1:this.currentView()=="workweek"||this._isCustomMonthView()&&this._oneWeek?b*this._dateRender.length+(r+1):this.currentView()=="workweek"?b*this._dateRender.length+(new Date(w).getDay()+1)+(it-1)*this.res1.length*this._dateRender.length:this._firstdayofweek==0?b*7+(new Date(w).getDay()+1)+(it-1)*this.res1.length*7:this.model.orientation=="vertical"&&this._firstdayofweek!=0?b*7+(new Date(w).getDay()+1)+(it-1)*this.res1.length*7-this._firstdayofweek:r+1:r+1:this.model.orientation=="vertical"&&this._isCustomMonthView()&&!this._oneWeek?b*7+(new Date(w).getDay()+1)+(it-1)*this.res1.length*7:r+1;this.model.orientation=="vertical"&&this._firstdayofweek!=0&&new Date(w).getDay()<this._firstdayofweek&&(u=b*7+(new Date(w).getDay()+1)+(it-1)*this.res1.length*7-this._firstdayofweek+7);var ti=e-1,ut=this.model.appointmentTemplateId?!0:!1,v=this._getUserAppointmentTemplate(i),o=this.model.appointmentTemplateId?n(v).css("height")=="100%"?this.CellHeight-this.element.find(".e-monthheader").height()-15:n(v).css("height")=="0px"?this.element.find(".e-monthappointment").height():n(v).height():19;e=this.model.appointmentTemplateId?n(v).css("width")=="100%"||n(v).css("width")=="0px"?e:n(v).width():e;l=y*o;this.leftPosition=0;this._tempResource.length!=0&&(ht=this._resCollection,ft=this._horiGroupCollection());h=this.model.orientation=="vertical"?!t.isNullOrUndefined(this.model.group)&&this._grouping.length>1?this._findResourceIndex(ht[0].dataSource,ht[0].id,i[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-2].trim()])+1:0:!t.isNullOrUndefined(this.model.group)&&this._grouping.length>1?this._findResourceIndex(ft,this._tempResource[this._tempResource.length-2].resourceSettings.id,i[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-2].trim()])+1:0;var p=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0?this._findResourceIndex(this.res1,this._tempResource[this._tempResource.length-1].resourceSettings.id,i[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim()])+1:1,s=this._appointmentColor(i),ii=this.element.find(".e-monthappointment").length!=0?this.element.find(".e-monthappointment").outerWidth(!0)-this.element.find(".e-monthappointment").width():0,bt=parseInt(this.CellWidth/(this.CellWidth<=e?this.CellWidth:e+ii)),ri=parseInt((this.CellHeight-this.element.find(".e-monthheader").height()-10)/(this.element.find(".e-monthappointment").length>0?this.element.find(".e-monthappointment").outerHeight(!0):o));this.CellHeight=this.model.orientation=="horizontal"?n(this.element.find(".e-workcellstab tr")[p+h-1]).find(".e-workcells").height():n(this.element.find("td.e-monthcells")[u-1]).closest("tr").find(".e-monthcells").outerHeight();var g=this._indicationApp(i),ct=this._timeMode=="12"?t.format(i[this._appointmentSettings.startTime],this._pattern.t):t.format(i[this._appointmentSettings.startTime],"HH:mm"),lt=this._timeMode=="12"?t.format(i[this._appointmentSettings.endTime],this._pattern.t):t.format(i[this._appointmentSettings.endTime],"HH:mm"),kt=this.element.find(".e-monthheader").length!=0?this.element.find(".e-monthheader").height():0;if(ut&&n(v).css("height")!="0px"&&this.model.orientation!="horizontal"?y+1<=bt*ri:this.CellHeight>kt+(y+1)*o+10)e<ti&&ut&&n(this.element.find(".e-appointwrapper")[u-1]).attr("style","height:"+(parseInt(y/bt)+1)*o+"px !important;width:"+this.CellWidth+"px !important;position:absolute !important;"),l>1&&(l=y*o),this.leftPosition>1&&(this.leftPosition-=1),t.isNullOrUndefined(i[this._appointmentSettings.recurrenceRule])||(rt=i[this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1),c=n(this.appTemplate.render({id:i.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),appHeight:o,rtl:this.model.enableRTL,subject:i[this._appointmentSettings.subject],startTime:ct,endTime:lt,left:this.leftPosition+"px",top:l,appWidth:e+"px",userAppTemplId:ut,userTemplate:v,appClass:"e-monthappointment",appointData:s.appointColor.appointData,appointCustomcss:s.appointColor.appointCustomcss,appointtextcolor:s.appointColor.appointtextcolor,value:s.value,multiDiv:s.multiDiv,priority:this.model.prioritySettings.enable?i[this._appointmentSettings.priority]:"",enablePriority:this.model.prioritySettings.template,priorityTemplate:this.model.prioritySettings.template?this._priorityTemplate(i):i[this._appointmentSettings.priority],uid:i.Guid,recurrence:i[this._appointmentSettings.recurrence],recurrenceEdit:rt,leftInd:g.leftIndication,rightInd:g.rightIndication})),t.isNullOrUndefined(this.model.queryCellInfo)||this._renderQueryCellInfo("appointment",i,c),this.model.orientation=="vertical"?(f=n(this.element.find("td.e-monthcells")[u-1]),f.find("div.e-appointwrapper").length>0?f.find("div.e-appointwrapper").append(c):f.find(".e-monthheader").after(n("<div class='e-appointwrapper'><\/div>").append(c))):this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(f=n(n(this.element.find(".e-workcellstab tr")[p+h-1]).find("td.e-workcells")[u-1]),f.find("div.e-appointwrapper").length>0?f.find("div.e-appointwrapper").append(c):f.prepend(n("<div class='e-appointwrapper'><\/div>").append(c)),!t.isNullOrUndefined(this.model.group)&&this._grouping.length>1&&this._renderAppointmentCategory(ft,h,u-1,i,e,this.leftPosition)),c="";else{if(n("#"+this._id+"_"+t.format(new Date(i[this._appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(p+h-1)+"_"+(u-1)).length!=0&&n("#"+this._id+"_"+t.format(new Date(i[this._appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(p+h-1)+"_"+(u-1)).remove(),this.model.showOverflowButton){var dt=u-1,gt=new Date(i[this._appointmentSettings.startTime]).getTime(),ui=Math.round((i[this._appointmentSettings.endTime]-i[this._appointmentSettings.startTime])/864e5),et=dt,fi=y+1;do f=this.model.orientation=="vertical"?n(this.element.find("td.e-monthcells")[et]):n(n(this.element.find(".e-workcellstab tr")[p+h-1]).find("td.e-workcells")[et]),at='<div id="'+this._id+"_"+t.format(new Date(i[this._appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(p+h-1)+"_"+et+'" class="e-icon e-arrowhead-down e-appsoverflow" cellinfo="'+nt[r]+'" appcount="'+fi+'"><\/div>',f.find("div.e-appointwrapper").length>0?f.find("div.e-appointwrapper").append(at):f.find(".e-monthheader").after(n("<div class='e-appointwrapper'><\/div>").append(at)),gt=gt+864e5,et++;while(et<ui+dt);this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&this._grouping.length>1&&this._renderAppointmentCategory(ft,h,u-1,i,e,this.leftPosition)}else this.model.orientation=="vertical"?(t.isNullOrUndefined(i[this._appointmentSettings.recurrenceRule])||(rt=i[this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1),l=y*o,ni=n(this.element.find("td.e-monthcells")[u-1]).closest("tr").index(),c=this.appTemplate.render({id:i.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),appHeight:o,rtl:this.model.enableRTL,subject:i[this._appointmentSettings.subject],startTime:ct,endTime:lt,left:this.leftPosition+"px",top:l,appWidth:e+"px",userAppTemplId:ut,userTemplate:v,appClass:"e-monthappointment",appointData:s.appointColor.appointData,appointCustomcss:s.appointColor.appointCustomcss,appointtextcolor:s.appointColor.appointtextcolor,value:s.value,multiDiv:s.multiDiv,uid:i.Guid,recurrence:i[this._appointmentSettings.recurrence],recurrenceEdit:rt}),n(this.element.find("td.e-monthcells")[u-1]).closest("tr").find(".e-monthcells").css("height",this.CellHeight+o-1+"px"),n(this.element.find(".e-timecells")[ni]).css("height",this.CellHeight+o-1+"px"),f=n(this.element.find("td.e-monthcells")[u-1]),f.find("div.e-appointwrapper").length>0?f.find("div.e-appointwrapper").append(c):f.find(".e-monthheader").after(n("<div class='e-appointwrapper'><\/div>").append(c)),this._reRenderScroller()):(l=y*o,this.CellHeight-10<o*(y+1)&&(n(this.element.find(".e-workcellstab tr")[p+h-1]).find(".e-workcells").css("height",this.CellHeight+o-1+"px"),n(this.element.find(".e-resourceheadertable tr")[p+h-1]).find(".e-childnode").css("height",this.CellHeight+o-1+"px")),t.isNullOrUndefined(i[this._appointmentSettings.recurrenceRule])||(rt=i[this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1),c=this.appTemplate.render({id:i.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),appHeight:o,rtl:this.model.enableRTL,subject:i[this._appointmentSettings.subject],startTime:ct,endTime:lt,left:this.leftPosition+"px",top:l,appWidth:e+"px",userAppTemplId:ut,userTemplate:v,appClass:"e-monthappointment",appointData:s.appointColor.appointData,appointCustomcss:s.appointColor.appointCustomcss,appointtextcolor:s.appointColor.appointtextcolor,value:s.value,multiDiv:s.multiDiv,uid:i.Guid,recurrence:i[this._appointmentSettings.recurrence],recurrenceEdit:rt,leftInd:g.leftIndication,rightInd:g.rightIndication}),this._reRenderScroller(),f=n(n(this.element.find(".e-workcellstab tr")[p+h-1]).find("td.e-workcells")[u-1]),f.find("div.e-appointwrapper").length>0?f.find("div.e-appointwrapper").append(c):f.prepend(n("<div class='e-appointwrapper'><\/div>").append(c)),!t.isNullOrUndefined(this.model.group)&&this._grouping.length>1&&this._renderAppointmentCategory(ft,h,u-1,i,e,this.leftPosition));l=this.CellHeight-(kt+this.element.find(".e-appsoverflow").height()-2);this.element.find(".e-icon.e-appsoverflow").css(this.model.enableRTL?"right":"left",this.CellWidth+this.leftPosition-25+"px").css("top",l+"px")}}i[this._appointmentSettings.recurrence]||(ot=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,i.ParentId)),vt=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,i.Guid)),new Date(i[this._appointmentSettings.endTime])<ot[0][this._appointmentSettings.endTime]&&(this.model.enableRTL?n(this.element.find(tt)[u-1]).find("[guid="+ot[0].Guid+"]").children(".e-lefthandle").remove():n(this.element.find(tt)[u-1]).find("[guid="+ot[0].Guid+"]").children(".e-righthandle").remove()),new Date(i[this._appointmentSettings.startTime])>ot[0][this._appointmentSettings.startTime]&&(this.model.enableRTL?n(this.element.find(tt)[u-1]).find("[guid="+i.Guid+"]").children(".e-righthandle").remove():n(this.element.find(tt)[u-1]).find("[guid="+i.Guid+"]").children(".e-lefthandle").remove()));!t.isNullOrUndefined(vt)&&vt>1&&(n(this.element.find(tt)[u-1]).find("[guid="+i.Guid+"]").children(".e-lefthandle").remove(),n(this.element.find(tt)[u-1]).find("[guid="+i.Guid+"]").children(".e-righthandle").remove());t.isNullOrUndefined(g)||(g.leftIndication&&(this.model.enableRTL?this.element.find("[guid="+i.Guid+"]").find(".e-schedulemouseclose").css("margin-left","11px"):this.element.find("[guid="+i.Guid+"]").find(".e-apptime,.e-apptext").css("margin-left","13px")),g.rightIndication&&(this.model.enableRTL?this.element.find("[guid="+i.Guid+"]").find(".e-apptime,.e-apptext").css("margin-right","13px"):this.element.find("[guid="+i.Guid+"]").find(".e-schedulemouseclose").css("margin-right","11px")))},_quickWindowClose:function(){this._quickAppointWindow.find(".e-error").remove();this._quickAppointWindow.ejDialog("close");this._processFocus()},_appointmentWindow:function(i){var f,e,r,u,o;if((this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close"),r=t.isNullOrUndefined(i.target)?n(i):n(i.target),t.isNullOrUndefined(this.model.workCellsTemplateId)&&t.isNullOrUndefined(this.model.allDayCellsTemplateId)||(r=r.closest(".e-workcells, .e-alldaycells, .e-monthcells")),r.hasClass("e-blocktimeappointment")||r.closest(".e-blocktimeappointment").length>0)||r.hasClass("e-appup")||r.hasClass("e-appdown"))return!1;var c=(r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells")||this._cellClick||r.hasClass("e-detailedapp"))&&!r.hasClass("e-resourceheadercells")&&!r.hasClass("e-schedulemouseclose")&&!r.hasClass("e-appointinnertext")&&!r.hasClass("e-apptext")&&!r.hasClass("e-apptime"),l=this.model.appointmentWindowOpen!=null||this.model.cellDoubleClick!=null||!t.isNullOrUndefined(this.model.serverEvents)&&(this.model.serverEvents.indexOf("appointmentWindowOpen")!=-1||this.model.serverEvents.indexOf("cellDoubleClick")!=-1),s={startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,target:i,resources:l&&c&&this._tempResource.length!=0?this._getResourceValue(r):null};if(!(r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells")||this._cellClick||r.hasClass("e-detailedapp"))||r.hasClass("e-resourceheadercells")||r.hasClass("e-schedulemouseclose")||r.hasClass("e-appointinnertext")||r.hasClass("e-apptext")||r.hasClass("e-apptime")){if(!r.hasClass("e-resourceheadercells")&&!r.hasClass("e-schedulemouseclose")){if(r.hasClass("e-monthheader")||r.hasClass("e-appsoverflow"))return!1;u=this._editKey?n(i):r.hasClass("e-appointment")||r.hasClass("e-monthappointment")||r.hasClass("e-alldayappointment")||r.hasClass("e-agendaappointment")?r:r.parents(".e-monthappointment,.e-appointment,.e-alldayappointment,.e-agendaappointment");this.currentView()=="agenda"&&(u=u.hasClass("e-agendaappointment")?u:this.element.find(".e-selectedCell").parent().find(".e-agendaappointment"));u.length>0&&!t.isNullOrUndefined(u[0].id)&&(this._currentAction=t.Schedule.Actions.Save,this._appUid=u.attr("guid"),o=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),o[0][this._appointmentSettings.recurrence]==1?(this._parentId=o[0].ParentId,this._recurEditWindow.ejDialog("open"),this._recurEditWindow.focus(),this._deleteBeforeOpen()):this._showAppointmentDetails(this._appUid,!0),this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close"));this._editKey=!1}}else{if(this._trigger("cellDoubleClick",s)||r.hasClass("e-categorybar"))return!1;this._currentAction=t.Schedule.Actions.Add;this._appointmentAddWindow.find(".e-recurEditor").css("display","none");this._appointmentAddWindow.find(".e-appwindow").css("display","block");var a=this._cellIndex,v=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,h=new Date(v[a]);if(this.model.minDate>h||this.model.maxDate<h||(f=new Date(this.cur_StartTime),e=new Date(this.cur_EndTime),(!t.isNullOrUndefined(this.model.appointmentWindowOpen)||!t.isNullOrUndefined(this.model.serverEvents)&&this.model.serverEvents.indexOf("appointmentWindowOpen")!=-1)&&this._trigger("appointmentWindowOpen",s)))return!1;this._appointmentAddWindow.find("#"+this._id+"subject").val(this.model.showQuickWindow?this._quickAppointWindow.find(".subject").val():"");this._appointmentAddWindow.find("#"+this._id+"location").val(this.model.showQuickWindow?this._quickAppointWindow.find(".location").val():"");this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option",{value:t.format(new Date(f),this._datepattern())});this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option",{value:t.format(new Date(e),this._datepattern())});this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",t.format(new Date(f),this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",t.format(new Date(e),this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"priority").ejDropDownList("option","value",this.model.prioritySettings.dataSource[0][this.model.prioritySettings.value]);(n(i.currentTarget).hasClass("e-alldaycells")||this.currentView()=="month"||this._isCustomMonthView())&&this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0});this._timeZoneCollection(null);this._tempStart=this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value");this._tempEnd=this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value");this._alldayCheck();t.scheduleFeatures.resources&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&this._renderResourceData(r,this._cellIndex);this.model.readOnly||(this._appointmentAddWindow.find(".e-appsave ,#"+this._id+"donerecur").ejButton("enable",!0),this._mediaQuery&&this._appointmentAddWindow.find(".e-btndelete").css("display","none"),this._appointmentAddWindow.ejDialog("open"));this._mediaQuery||this._appointmentAddWindow.find(".subject").focus();this._cellClick=!1}},_editRecurrence:function(){this._appointmentAddWindow.find(".e-appwindow").toggle();this._mediaQuery&&this._appointmentAddWindow.parent().parent().find(".e-dialog-icon").css("display","none");this._appointmentAddWindow.find(".e-recurEditor").css("margin-left",700).toggle().animate({"margin-left":10},300)},_showAppointmentDetails:function(n,i){var f=this._appointmentAddWindow.find(".e-recurrenceeditor").data("ejRecurrenceEditor"),u,e,o;this._appUid=t.isNullOrUndefined(this._appUid)?n:this._appUid;this._currentAction=t.isNullOrUndefined(this._currentAction)||this._currentAction==""?t.Schedule.Actions.Save:this._currentAction;var s=i==!0?(new t.Query).where("Guid",t.FilterOperators.equal,n):(new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,n),h=i==!0?this._processed:this._currentAppointmentData,r=this._sortAppById(new t.DataManager(h).executeLocal(s));if(r[0][this._appointmentSettings.endTime]=r[r.length-1][this._appointmentSettings.endTime],this._appointmentAddWindow.find(".subject").val(r[0][this._appointmentSettings.subject]),this._appointmentAddWindow.find(".location").val(r[0][this._appointmentSettings.location]),this._appointmentAddWindow.find(".id").val(r[0].AppTaskId),this._appointmentAddWindow.find(".e-description").val(r[0][this._appointmentSettings.description]?r[0][this._appointmentSettings.description]:""),u=r[0],this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",t.format(u[this._appointmentSettings.startTime],this._datepattern())),this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",t.format(u[this._appointmentSettings.endTime],this._datepattern())),this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",t.format(u[this._appointmentSettings.startTime],this._pattern.t)),this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",t.format(u[this._appointmentSettings.endTime],this._pattern.t)),this.model.prioritySettings.enable&&(t.isNullOrUndefined(u[this._appointmentSettings.priority])?this._appointmentAddWindow.find("#"+this._id+"priority").ejDropDownList("option",{value:this.model.prioritySettings.dataSource[0][this.model.prioritySettings.value]}):this._appointmentAddWindow.find("#"+this._id+"priority").ejDropDownList("option",{value:r[0][this._appointmentSettings.priority]})),this._timeZoneCollection(u),this._tempStart=this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value"),this._tempEnd=this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value"),r[0][this._appointmentSettings.allDay]==1&&this._appointmentAddWindow.find(".allday ").ejCheckBox({checked:!0}),r[0][this._appointmentSettings.recurrence]==1&&(f._recRule=r[0][this._appointmentSettings.recurrenceRule],i==!0?(t.isNullOrUndefined(r[0][this._appointmentSettings.recurrenceRule])||r[0][this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")==-1||(this._currentAction=t.Schedule.Actions.Save),this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0,enabled:!1}),this._appointmentAddWindow.find(".e-repeatlbl").addClass("e-disable"),this._appointmentAddWindow.find("."+this._id+"summary").css("display","none"),this._appointmentAddWindow.find(".e-recurFinalRule").html("")):(f.recurrenceRuleSplit(r[0][this._appointmentSettings.recurrenceRule],u[this._appointmentSettings.recurrenceExDate]),this._appointmentAddWindow.find(".recurstartdate").ejDatePicker({value:t.format(u[this._appointmentSettings.startTime],this._datepattern())}),this._appointmentAddWindow.find("."+this._id+"summary").css("display","table-row"),this._appointmentAddWindow.find(".e-recurFinalRule").html(f.showRecurrenceSummary(n)),this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0}),this._appointmentAddWindow.find(".e-recuredit").css("display","inline"))),this.model.categorizeSettings.enable&&!t.isNullOrUndefined(u[this._appointmentSettings.categorize])&&this._showCategorizeDetails(u),this._tempResource.length!=0&&t.scheduleFeatures.resources&&this._showMultipleResourceDetails(u),e={appointment:r[0],edit:i},this._trigger("appointmentWindowOpen",e))return!1;this._alldayCheck();o=this.model.readOnly?"disable":"enable";this._appointmentAddWindow.find(".e-appsave,#"+this._id+"donerecur").ejButton(o,!0);this._mediaQuery&&this._appointmentAddWindow.find(".e-btndelete").css("display","block");this._appointmentAddWindow.ejDialog("open");this._mediaQuery||this._appointmentAddWindow.find(".subject").focus()},_recurDateChange:function(n){this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",n);this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value")<this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value")?this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",n):n!=this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value")&&this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",n)},_cancel:function(){this._appointmentAddWindow.ejDialog("close")},_timeChange:function(n){var i=this._appointmentAddWindow.find("#"+this._id+"starttime").data("ejTimePicker");if(t.isNullOrUndefined(n.value)){i.option("value",new Date(this.cur_StartTime));return}if(i.showDropdown&&i._id==this._id+"starttime"){if(this._appointmentAddWindow.find(".startutc").val()!=this._appointmentAddWindow.find(".endutc").val())this._utcValue("","starttime");else{var u=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value")).split(":"),f=new Date(new Date("1/1/2000").setHours(parseInt(u[0],10),parseInt(u[1],10))),e=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value")).split(":"),r=new Date(new Date("1/1/2000").setHours(parseInt(e[0],10),parseInt(e[1],10))),o=this._timeFormat(n.prevTime).split(":"),s=new Date(new Date("1/1/2000").setHours(parseInt(o[0],10),parseInt(o[1],10))),h=new Date(new Date(r).setHours(r.getHours()+f.getHours()-s.getHours(),r.getMinutes()+f.getMinutes()-s.getMinutes()));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",h)}this._startSlotChange=!0}},_setQuickValidation:function(){var f,i,r,u;if(t.isNullOrUndefined(this._quickAppointWindow))return!1;f=this._id+"_AddForm";this._initValidator(f);t.isNullOrUndefined(this.model.appointmentSettings.subject)||t.isNullOrUndefined(this.model.appointmentSettings.subject.validationRules)||(i=this.model.appointmentSettings.subject.field,r=this.model.appointmentSettings.subject.validationRules,ele=this._quickAppointWindow.find(".subject"),ele.attr("name")||ele.attr("name",i),ele.rules("add",r),u=n("#"+this._id+"_AddForm").validate(),t.isNullOrUndefined(r.required)||(t.isNullOrUndefined(u.settings.messages[i])?u.settings.messages[i]={}:"",u.settings.messages[i].required=t.isNullOrUndefined(r.messages&&r.messages.required)?i+" is required.":r.messages.required))},_setValidation:function(){var r=this._id+"_AddEditForm",i;this._initValidator(r);i=this;n.each(this.model.appointmentSettings,function(n){t.isNullOrUndefined(i.model.appointmentSettings[n])||t.isNullOrUndefined(i.model.appointmentSettings[n].validationRules)||i._setValidationToField(n,i.model.appointmentSettings[n].field,i.model.appointmentSettings[n].validationRules)})},_initValidator:function(i){n("#"+i).validate({onfocusout:!1,ignore:".e-hide",errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(i,r){var e=r.closest("td"),u=n(i).addClass("e-error"),o=t.buildTag("div.e-errortail e-toparrow"),f;e.find(".e-error").remove();r.parent().hasClass("e-in-wrap")?u.insertAfter(r.closest(".e-widget")):u.insertAfter(r);u.prepend(o);f=r[0].type=="checkbox"||r[0].type=="hidden"?r.parent().offset().top+r.parent().height():r.offset().top+r.height();u.offset({top:f});u.fadeIn("slow")}})},_setValidationToField:function(i,r,u){var f,e,o;for(ele=i=="startTime"?this._appointmentAddWindow.find("#"+this._id+"startdate,#"+this._id+"starttime"):i=="endTime"?this._appointmentAddWindow.find("#"+this._id+"enddate,#"+this._id+"endtime"):i=="resourceFields"?n("#"+this._id+"AppointmentAddEditWindow").find("[id^="+this._id+"_ownerfield_][type!=hidden]").find(".e-autocomplete"):n("#"+this._id+"AppointmentAddEditWindow").find("[name="+r+"][type!=hidden]"),ele.length<1&&(ele=n("#"+this._id+i)),f=0;f<ele.length;f++)n(ele[f]).hasClass("e-autocomplete")&&(e=n(ele[f]).data("ejAutocomplete"),ele[f]=e.model.multiSelectMode=="visualmode"?e._hiddenInput:e.element),n(ele[f]).rules("add",u),o=n("#"+this._id+"_AddEditForm").validate(),t.isNullOrUndefined(u.required)||(t.isNullOrUndefined(o.settings.messages[r])?o.settings.messages[r]={}:"",o.settings.messages[r].required=t.isNullOrUndefined(u.messages&&u.messages.required)?r+" is required.":u.messages.required)},_endTimeChange:function(n){var i=this._appointmentAddWindow.find("#"+this._id+"endtime").data("ejTimePicker");if(t.isNullOrUndefined(n.value)){i.option("value",new Date(this.cur_EndTime));return}i.showDropdown&&i._id==this._id+"endtime"&&(this._endSlotChange=!0)},_renderControls:function(){var i=this._appointmentAddWindow;i.find(".allday").ejCheckBox({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass,change:n.proxy(this._alldayCheck,this)});i.find(".startenddate").ejDatePicker({buttonText:this._getLocalizedLabels("Today"),startDay:this._firstdayofweek,enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,dateFormat:this.model.dateFormat,cssClass:this.model.cssClass,minDate:this.model.minDate,maxDate:this.model.maxDate});i.find("#"+this._id+"starttime").ejTimePicker({enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,change:n.proxy(this._timeChange,this),cssClass:this.model.cssClass,interval:30,timeFormat:this._timeMode=="12"?this._pattern.t:"HH:mm"});i.find("#"+this._id+"endtime").ejTimePicker({enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,change:n.proxy(this._endTimeChange,this),cssClass:this.model.cssClass,interval:30,timeFormat:this._timeMode=="12"?this._pattern.t:"HH:mm"});i.find("#"+this._id+"startTimeZone").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:this.model.timeZoneCollection.dataSource,fields:{text:"text",id:"id",value:"value"},width:"100%",select:n.proxy(this._startUtc,this),cssClass:this.model.cssClass});i.find("#"+this._id+"endTimeZone").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:this.model.timeZoneCollection.dataSource,fields:{text:"text",id:"id",value:"value"},width:"100%",select:n.proxy(this._endUtc,this),cssClass:this.model.cssClass});!this.model.prioritySettings.enable||this.model.prioritySettings.dataSource instanceof t.DataManager||this._renderPriorityItems(i);this._tempResource.length!=0&&t.scheduleFeatures.resources&&this._renderAppWindowResources(i);!this.model.categorizeSettings.enable||this.model.categorizeSettings.dataSource instanceof t.DataManager||this._renderCategoryItems(i);i.find(".recurrence").ejCheckBox({enableRTL:this.model.enableRTL,change:n.proxy(this._repeat,this),cssClass:this.model.cssClass});i.find(".e-btndone").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:this._mediaQuery?"100%":"100px",click:n.proxy(this._saveAppointment,this),cssClass:this.model.cssClass});i.find(".cancel").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:this._mediaQuery?"100%":"100px",click:n.proxy(this._cancel,this),cssClass:this.model.cssClass});this._mediaQuery&&i.find(".e-btndelete").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100%",click:n.proxy(this._mobileAppDelete,this),cssClass:this.model.cssClass})},_mobileAppDelete:function(){this._mediaQuery&&!t.isNullOrUndefined(this._editOnlyClicked)&&!this._editOnlyClicked&&this._appointmentAddWindow.find(".recurrence").ejCheckBox("option","checked")?this._deleteApp(this._appUid):this._deleteAppoint();this._appointmentAddWindow.ejDialog("close")},_renderPriorityItems:function(n){t.isNullOrUndefined(n)||n.find(".priority").ejDropDownList({enableRTL:this.model.enableRTL,template:t.isNullOrUndefined(this.model.prioritySettings.template)?"<div class='e-${"+this.model.prioritySettings.value+"}'><\/div><div>${"+this.model.prioritySettings.text+"}<\/div>":this.model.prioritySettings.template+"${"+this.model.prioritySettings.text+"}",dataSource:this.model.prioritySettings.dataSource,fields:{text:this.model.prioritySettings.text,value:this.model.prioritySettings.value},width:"100%",cssClass:this.model.cssClass})},_renderCategoryItems:function(i){t.isNullOrUndefined(i)||i.find(".e-categorizevalue").ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:this.model.categorizeSettings.allowMultiple?"visualmode":"none",focusOut:n.proxy(this._categorizeValidate,this),dataSource:this.model.categorizeSettings.dataSource,fields:{text:this.model.categorizeSettings.text,value:this.model.categorizeSettings.color,key:this.model.categorizeSettings.id,fontColor:this.model.categorizeSettings.fontColor},template:this._categorizeTemplate,emptyResultText:this._getLocalizedLabels("EmptyResultText")})},_categorizeValidate:function(){if(n.isFunction(n.validator)&&!n("#"+this._id+"_AddEditForm").validate().form())return!1},_appointmentColor:function(n){var i=this.model.categorizeSettings.enable&&!t.isNullOrUndefined(n[this._appointmentSettings.categorize])&&n[this._appointmentSettings.categorize]!=""?this._getCategorizeColor(n):this._tempResource.length!=0&&t.scheduleFeatures.resources?this._getResourceColor(n):{appointData:"",appointCustomcss:"",appointtextcolor:""};if(this.model.categorizeSettings.enable&&this.model.categorizeSettings.allowMultiple&&!t.isNullOrUndefined(n[this._appointmentSettings.categorize]))var f=n[this._appointmentSettings.categorize].split(","),e=f.length,r=e>1?!0:!1,u=this._categorizeMultipleDiv(n,f,e);return!t.isNullOrUndefined(u)&&i.appointData.length>0&&this.model.categorizeSettings.allowMultiple?{appointColor:i,value:r,multiDiv:u}:i.appointData.length>0&&!this.model.categorizeSettings.allowMultiple||this._tempResource.length!=0&&t.scheduleFeatures.resources?{appointColor:i}:(appointData="",appointCustomcss="",appointtextcolor="",r="",{appointColor:i,value:r,multiDiv:u})},_categorizeMultipleDiv:function(n,r,u){var o=[],f,e;for(i=0;i<=u-1;i++)if(i!=u-1){if(f=this.model.categorizeSettings,e=this._findResourceIndex(f.dataSource,this.model.categorizeSettings.id,r[i]),t.isNullOrUndefined(e)&&(e=this._findResourceIndex(f.dataSource,this.model.categorizeSettings.id,parseInt(r[i]))),t.isNullOrUndefined(e))return n[this._appointmentSettings.categorize]="",null;o.push({text:f.dataSource[e][f.text],value:f.dataSource[e][f.color],key:f.dataSource[e][f.id],fontColor:f.dataSource[e][f.fontColor]})}return this._categorizeMultipleTemplate.render({renderData:o})},_getResCategorySaveData:function(n,i,r,u,f){var a=[],o,b,k,d=[],y,c,p,w,h,l,g,v,e,s;if(o=this._addAppData(r,u,new Date(r[this._appointmentSettings.startTime]),new Date(r[this._appointmentSettings.endTime]),f),n.length>0&&!t.isNullOrUndefined(n[0][0])){for(y=n[n.length-1].length-1,c="",e=0;e<=y;e++)p=n[n.length-1][e][this.model.categorizeSettings.id],c=e!=y?c+p.toString()+",":c+p.toString();o[this._appointmentSettings.categorize]=c}if(i.length>0){if(w=o[this._appointmentSettings.categorize],s=this._appointmentSettings.resourceFields.toString().split(","),this._grouping.length!=0&&s.length!=this._grouping.length){for(e=0;e<this._grouping.length;e++)d.push(s[e]);s=d}if(h=this._getResourceCollection(),i[i.length-1].length>0)for(l=0;l<i[i.length-1].length;l++){for(o=this._addAppData(r,u,new Date(r[this._appointmentSettings.startTime]),new Date(r[this._appointmentSettings.endTime]),f),o[this._appointmentSettings.categorize]=w,i[i.length-1].length>1&&(r.Guid=this._guidFormatGenerate(),u++,g=new t.DataManager(this._processed).executeLocal((new t.Query).where("AppTaskId",t.FilterOperators.equal,u)),u=g.length==0?u:this._sortAppById(this._processed)[this._processed.length-1].AppTaskId+1,r[this._appointmentSettings.id]=f=u,this._currentAction==t.Schedule.Actions.EditSeries&&(r[this._appointmentSettings.recurrenceId]=u)),o[s[s.length-1].trim()]=i[s.length-1][l][h[h.length-1].id],v=i[s.length-1][l][h[h.length-1].id],e=s.length-1;e>0;e--)b=this.render_Resources[e]instanceof t.DataManager?this.render_Resources[e]:t.DataManager(this.render_Resources[e]),query=(new t.Query).where(h[e].id,t.FilterOperators.equal,v),appointId=b.executeLocal(query),k=this.render_Resources[e-1]instanceof t.DataManager?this.render_Resources[e-1]:t.DataManager(this.render_Resources[e-1]),query1=(new t.Query).where(h[e-1].id,t.FilterOperators.equal,appointId[0][h[e].groupId]),appointGroupId=k.executeLocal(query1),v=appointGroupId[0][h[e-1].id],o[s[e-1]]=v;this._currentAction==t.Schedule.Actions.EditOccurrence&&(o[this._appointmentSettings.id]=o.AppTaskId);a.push(o)}else{if(s=this._appointmentSettings.resourceFields.toString().split(","),o=this._addAppData(r,u,new Date(r[this._appointmentSettings.startTime]),new Date(r[this._appointmentSettings.endTime]),f),o[this._appointmentSettings.categorize]=w,s.length>1)for(e=0;e<s.length;e++)o[s[e].trim()]=this._tempResource[e].resourceSettings.dataSource[0].id;else o[s[s.length-1].trim()]=this._tempResource[0].resourceSettings.dataSource[0].id;this._currentAction==t.Schedule.Actions.EditOccurrence&&(o[this._appointmentSettings.id]=o.AppTaskId);a.push(o)}}return i.length==0&&n.length>0&&(this._currentAction==t.Schedule.Actions.EditOccurrence&&(o[this._appointmentSettings.id]=o.AppTaskId),a.push(o)),a},_timeZoneCollection:function(n){t.isNullOrUndefined(n)||(this.startTimeAppoint=n[this._appointmentSettings.startTimeZone],this.endTimeAppoint=n[this._appointmentSettings.endTimeZone]);this.startutcValue=this.tempValue=null;!t.isNullOrUndefined(n)&&this.endTimeAppoint&&(this._utcValue(n,"Appoint"),this.tempValue=1);var o=this.model.timeZone==null?this._timezoneStringValue():this.model.timeZone,f=n!==null?t.isNullOrUndefined(this.startTimeAppoint)?o:this.startTimeAppoint:o,r=f.indexOf("UTC")!=0?"UTC "+f:f,e=r.split(" ")[1].split(":")[0].length!=3?r.split(" ")[1].split(":")[0][0]=="+"?"+0"+r.split(" ")[1].split(":")[0].split("+")[1]+":"+r.split(" ")[1].split(":")[1]:"-0"+r.split(" ")[1].split(":")[0].split("-")[1]+":"+r.split(" ")[1].split(":")[1]:r,u=e.indexOf("UTC")!=0?"UTC "+e:e,i=t.isNullOrUndefined(this._findResourceIndex(this.model.timeZoneCollection.dataSource,"value",u))?"add":this._findResourceIndex(this.model.timeZoneCollection.dataSource,"value",u);t.isNullOrUndefined(n)||t.isNullOrUndefined(this.startTimeAppoint)||t.isNullOrUndefined(this.endTimeAppoint)||(this._appointmentAddWindow.find("#"+this._id+"startTimeZone").ejDropDownList("option",{value:!t.isNullOrUndefined(n)&&this.startTimeAppoint?this.startTimeAppoint:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.value]}),this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList("option",{value:!t.isNullOrUndefined(n)&&this.endTimeAppoint?this.endTimeAppoint:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.value]}));i!=="add"&&(this._appointmentAddWindow.find("#"+this._id+"startTimeZone").ejDropDownList("option",{text:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.text],value:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.value]}),this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList("option",{text:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.text],value:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.value]}));i=="add"&&(this.model.timeZoneCollection.dataSource.push({text:u,id:(this.model.timeZoneCollection.dataSource.length+1).toString(),value:u}),this._appointmentAddWindow.find("#"+this._id+"startTimeZone").ejDropDownList({dataSource:this.model.timeZoneCollection.dataSource}),this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList({dataSource:this.model.timeZoneCollection.dataSource}),n!=null?this._timeZoneCollection(n):this._timeZoneCollection(null));this.tempValue=null},_timezoneStringValue:function(){var t=-(new Date).getTimezoneOffset()+this._timeZoneOffset,i=t<0?"-":"+",n=Math.abs(t),r=Math.floor(n/60)<10?"0"+Math.floor(n/60):Math.floor(n/60),u=n%60<10?"0"+n%60:n%60;return i+r+":"+u},_showCategorizeDetails:function(t){var r=t[this._appointmentSettings.categorize].split(","),u;for(i=0;i<r.length;i++)u=n.type(r[i])=="string"?r[i]:parseInt(r[i]),this._appointmentAddWindow.find(".e-categorizevalue").data("ejAutocomplete").selectValueByKey(u)},_renderCategorizeTemplate:function(){var n=this.model.enableRTL?"margin-right:30px;margin-top:-18px":"float:left",i=this.model.enableRTL?"float:none":"float:left";t.isNullOrUndefined(this.model.categorizeSettings)||(this._categorizeTemplate="<div class='e-categorizeTemplate' style='height:15px;margin-right:5px;margin-top:3px;"+i+";width:15px;background-color: ${"+this.model.categorizeSettings.color+"}'><\/div><div style= "+n+">${"+this.model.categorizeSettings.text+"}<\/div>")},_getCategorizeColor:function(n){var r=null,u="",o="",f="",e=n[this._appointmentSettings.categorize].split(","),s=e.length-1,i=this.model.categorizeSettings;return(r=this._findResourceIndex(i.dataSource,this.model.categorizeSettings.id,e[s]),t.isNullOrUndefined(r)&&(r=this._findResourceIndex(i.dataSource,this.model.categorizeSettings.id,parseInt(e[s]))),t.isNullOrUndefined(r))?(n[this._appointmentSettings.categorize]="",{appointData:u,appointCustomcss:o,appointtextcolor:f}):(u=t.isNullOrUndefined(i.dataSource[r][i.color])?u:i.dataSource[r][i.color],f=t.isNullOrUndefined(i.dataSource[r][i.fontColor])?f:i.dataSource[r][i.fontColor],{appointData:u,appointCustomcss:o,appointtextcolor:f})},_currentDateFormat:function(i){var r,u,f,e;t.isNullOrUndefined(i)||n.type(this.currentDate())=="date"&&n.type(this.model.minDate)=="date"&&n.type(this.model.maxDate)=="date"?i=="MM/dd/yyyy"&&(n.type(this.currentDate())!="date"||n.type(this.model.minDate)!="date"||n.type(this.model.maxDate)!="date")&&(e=t.parseDate(this.currentDate()),r=t.parseDate(this.model.minDate),u=t.parseDate(this.model.maxDate),t.isNullOrUndefined(e)?this.currentDate(new Date):this.currentDate(e),this.model.minDate=t.isNullOrUndefined(r)?this.model.minDate:r,this.model.maxDate=t.isNullOrUndefined(u)?this.model.maxDate:u):(f=t.parseDate(this.currentDate(),this.model.dateFormat),r=t.parseDate(this.model.minDate,this.model.dateFormat),u=t.parseDate(this.model.maxDate,this.model.dateFormat),this.currentDate(t.isNullOrUndefined(f)?new Date(this.currentDate()).toString()=="Invalid Date"||new Date(this.currentDate()).toString()=="NaN"?this._dateConvert(this.currentDate()):new Date(this.currentDate()):f),this.model.minDate=t.isNullOrUndefined(r)?new Date(this.model.minDate).toString()=="Invalid Date"||new Date(this.model.minDate).toString()=="NaN"?this._dateConvert(this.model.minDate):new Date(this.model.minDate):r,this.model.maxDate=t.isNullOrUndefined(u)?new Date(this.model.maxDate).toString()=="Invalid Date"||new Date(this.model.maxDate).toString()=="NaN"?this._dateConvert(this.model.maxDate):new Date(this.model.maxDate):u)},_datepattern:function(){return this.model.dateFormat!=""&&!t.isNullOrUndefined(this.model.dateFormat)?this.model.dateFormat:this._pattern.d},_businessHourScroller:function(){var i,r,u;if(this.currentView()=="agenda")return!1;i=0;this.model.orientation=="vertical"?(i=this.element.find(".e-businesshighlightworkcells").length!=0&&this.model.workHours.highlight==!0?this.element.find(".e-businesshighlightworkcells").first().parent()[0].rowIndex*this.element.find(".e-workcells").height():0,n("div#"+this._id+"_scroller").ejScroller({scrollTop:i}),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")):this.model.orientation=="horizontal"&&this.model.timeScale.enable&&(this.element.find(".e-businesshighlightworkcells").length!=0&&this.model.workHours.highlight==!0&&this.currentView()!="month"?this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7?(r=this.element.find(".e-activeview.e-horizontalheaderdiv").parent().index(),!t.isNullOrUndefined(r)&&r>=0&&(this.currentView()=="customview"?this.currentDate(new Date(this._dateRender[0])):this.currentDate(new Date(this._dateRender[r])),i=this.element.find(".e-workcells")[r*(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)].offsetLeft),(this.currentView()==="week"&&[0,6].indexOf(new Date(this._dateRender[r]).getDay())==-1||this.currentView()==="workweek")&&(i=this.model.enableRTL?i+this.element.find(".e-workcells").width()-this.model.workHours.start*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)*this.element.find(".e-workcells").width():this.model.workHours.start*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)*this.element.find(".e-workcells").width()+(i-this.element.find(".e-workcells").width()))):i=this.element.find(".e-businesshighlightworkcells")[0].offsetLeft:i=this.element.find(".e-activeview.e-horizontalheaderdiv").parent().index()!=-1?this.element.find(".e-workcells")[this.element.find(".e-activeview.e-horizontalheaderdiv").parent().index()*(this.model.endHour-this.model.startHour)*2]:0,this.model.enableRTL?(i=this.element.find(".e-workcells")[0].offsetLeft-i,n("div#"+this._id+"_scroller").ejScroller({scrollLeft:i}),u=this.element.find(".e-workcells")[0].offsetLeft+this.element.find(".e-workcells").width()-this.element.find(".e-draggableworkarea").width(),i=i>=u?u:i,n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",i+"px")):(n("div#"+this._id+"_scroller").ejScroller({scrollLeft:i}),n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-this.element.find(".e-draggableworkarea").scrollLeft()+"px")))},_minToHour:function(n){return{h:parseInt(n/60),m:n%60}},_onclose:function(){this._appointmentAddWindow.find(".e-error").remove();this._appointmentAddWindow.find(".e-recurEditor").hide();this._appointmentAddWindow.find(".e-appwindow").css("margin-left",700).show().animate({"margin-left":10},300);this._clearFields();this._processFocus()},_printAppointment:function(i){var h=t.buildTag("div"),r,c,f,u,s,l,a;typeof i=="object"?r=i:(c=(new t.Query).where("Guid",t.FilterOperators.equal,i),list=new t.DataManager(this._processed).executeLocal(c),list.length>1?(f=n.extend(!0,[],list),f[0][this._appointmentSettings.endTime]=f[f.length-1][this._appointmentSettings.endTime],r=f[0]):r=list[0]);var e="<table align='center' style='margin-top:50px;margin-left:50;'>",o=this,v=["Guid","ParentId","RecurrenceId","RecurrenceExDate","AppTaskId"];return n.each(r,function(n,i){v.indexOf(n)!=-1||t.isNullOrUndefined(i)||t.isNullOrUndefined(n)||n=="null"||((n==o._appointmentSettings.startTime||n==o._appointmentSettings.endTime)&&(i=i),e+="<tr style='height:30px'><td style='width:300px'><b>"+n+":<\/b><\/td><td  style='width:600px'>"+i+"<\/td><\/tr>")}),e+="<\/table>",u="",this._tempResource.length!=0&&(t.isNullOrUndefined(r[this._tempResource[this._tempResource.length-1].field])||(s=o._appointmentSettings.resourceFields.split(","),n.each(this._tempResource[this._tempResource.length-1].resourceSettings.dataSource,function(n,t){t.id==r[s[s.length-1].trim()]&&(u=t.text)}))),u=u==""?"Unknown":u,l="<font size='20' style='margin-top:50px;margin-left:50;font-family:Times New Roman'><b>"+u+"<\/b><\/font><\/br><hr style='margin-left:50' size='10'>",a=l+e,h.append(a),t.print(h),!1},_recurrenceValidate:function(n,i,r,u){var f=this._appointmentAddWindow.find(".e-recurrenceeditor").data("ejRecurrenceEditor"),s,h,y,p,o,c,b,l,k,v,e;if(t.isNullOrUndefined(n)||f.recurrenceRuleSplit(n,i),t.isNullOrUndefined(u)?(y=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value")).split(":"),s=new Date(this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value").setHours(parseInt(y[0],10),parseInt(y[1],10)))):s=u,t.isNullOrUndefined(r)?(p=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value")).split(":"),h=new Date(this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value").setHours(parseInt(p[0],10),parseInt(p[1],10)))):h=r,(s-h)/864e5<14){if(o=t.isNullOrUndefined(r)?this._appointmentAddWindow.find(".recurstartdate").ejDatePicker("option","value"):r,c=f._rRule.interval,t.isNullOrUndefined(f._rRule.until))if(t.isNullOrUndefined(f._rRule.count))recurEndDate=new Date(new Date(this.currentDate()).setDate(o.getDate()+42*c));else switch(f._rRule.freq){case"DAILY":recurEndDate=new Date(new Date(o).setDate(o.getDate()+f._rRule.count*c));break;case"WEEKLY":b=f._rRule.weekDays.split(",");l=o.getDate()+f._rRule.count/b.length*7*c;recurEndDate=new Date(new Date(o).setDate(Math.round(l)<l?l+1:l));break;case"MONTHLY":recurEndDate=new Date(new Date(o).setMonth(o.getMonth()+f._rRule.count*c));break;case"YEARLY":recurEndDate=new Date(new Date(o).setFullYear(o.getFullYear()+f._rRule.count*c))}else recurEndDate=new Date(f._rRule.until),recurEndDate.setDate(recurEndDate.getDate()+1);if((recurEndDate-o)/864e5<(f._rRule.freq=="DAILY"?2:f._rRule.freq=="WEEKLY"?7:1))return!0;switch(f._rRule.freq){case"DAILY":return k=f._rRule.interval,(s-h)/36e5>parseInt(k)*24?!1:!0;case"WEEKLY":if(n.split(";")[1].split("=")[0]=="INTERVAL"){var a=f._rRule.weekDays.split(","),g={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6},w=[],d=[];for(e=0;e<a.length*(parseInt(f._rRule.interval)+1);e++)w[e]=a.length>e?g[a[e]]:w[e-a.length]+7*parseInt(f._rRule.interval);for(v=w.sort(function(n,t){return n-t}),e=1;e<v.length;e++)d.push(v[e]-v[e-1]);return(s-h)/36e5>Math.min.apply(Math,d)*24?!1:!0}return(s-h)/36e5>24?!1:!0;case"MONTHLY":return!0;case"YEARLY":return!0}}else return!1},_saveAppointment:function(){var nt=this._appointmentAddWindow.find(".e-recurrenceeditor").data("ejRecurrenceEditor"),hi,g,ii,i,h,ri,st,tt,e,c,p,ui,ht,ct,l,kt,bt,u,lt,ut,o,at,f,dt,gt,ni,fi,ei,wt,oi,a,w,yt,y,s,pt,v,si;if(this._currentAction!=""){if(t.isNullOrUndefined(this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value"))||t.isNullOrUndefined(this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value")))return!1;if(start=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value")).split(":"),end=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value")).split(":"),startTime=new Date(this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value").setHours(parseInt(start[0],10),parseInt(start[1],10))),endTime=new Date(this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value").setHours(parseInt(end[0],10),parseInt(end[1],10))),startTime>endTime)return this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("StartEndError")),this._alertWindow.ejDialog("open"),!1}if(this._appointmentAddWindow.find("#"+this._id+"recurrence").ejCheckBox("option","checked")&&nt._recRule!=""&&!t.isNullOrUndefined(nt._recRule)&&this.model.enableRecurrenceValidation&&this._currentAction=="add"&&!this._recurrenceValidate(nt._recRule))return this._alertCreateError(),!1;if(hi=this._sortAppById(this._processed),this._cellClick&&this.model.showQuickWindow){if(n.isFunction(n.validator)&&!n("#"+this._id+"_AddForm").validate().form())return!1;if(i={},g=t.isNullOrUndefined(this._appMainId)?1:this._appMainId+1,this.model.enableLoadOnDemand&&(g=this._dataCount),i[this._appointmentSettings.id]=i.AppTaskId=i.ParentId=g,i[this._appointmentSettings.subject]=this._quickAppointWindow.find(".subject").val(),i[this._appointmentSettings.startTime]=new Date(this.cur_StartTime),i[this._appointmentSettings.endTime]=new Date(this.cur_EndTime),i[this._appointmentSettings.allDay]=this.currentView()==="month"||new Date(this.cur_StartTime).getHours()==0&&new Date(this.cur_EndTime).getHours()==23&&new Date(this.cur_EndTime).getMinutes()==59||this._isCustomMonthView()?!0:!1,this.model.appointmentSettings.applyTimeOffset&&!i[this._appointmentSettings.allDay]&&(i[this._appointmentSettings.startTimeZone]=this.model.timeZone==null?"UTC "+this._timezoneStringValue():this.model.timeZone,i[this._appointmentSettings.endTimeZone]=this.model.timeZone==null?"UTC "+this._timezoneStringValue():this.model.timeZone),i[this._appointmentSettings.recurrence]=!1,(!t.isNullOrUndefined(this.model.group)||this._tempResource.length!=0&&t.scheduleFeatures.resources)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&(i=this._getResourceFields(i)),"null"in i&&delete i[null],ut=this._checkAvailability(i),u={appointment:i},this._trigger("actionBegin",{data:u.appointment,requestType:"appointmentSave"})||ut.length>0)return this._showBlockAlert&&ut.length>0&&this._alertBlockError(),this._quickAppointWindow.ejDialog("close"),!1;if(this._trigger("beforeAppointmentCreate",u))return this._quickAppointWindow.ejDialog("close"),!1;this._currentAction==t.Schedule.Actions.Add;u.appointment.Guid=this._guidFormatGenerate();n.extend(!0,ii={},u.appointment);o=this._timeZoneAppointments(ii,"");y=this._dataManager.insert(o,this.model.appointmentSettings.query._fromTable);new t.DataManager(this._currentAppointmentData).update("AppTaskId",u.appointment);v=this;n.isFunction(y.promise)&&this.dataSource()instanceof t.DataManager?(y.done(function(n){v._processUrlBinding(n);v._trigger("appointmentCreated",{appointment:u.appointment,requestType:"appointmentSaved"});v._trigger("actionComplete",{data:u.appointment,requestType:"appointmentSave"})}),y.fail(function(){})):(this._processed.push(u.appointment),this._renderSingleApp(),this._appMainId=this._sortAppById(this._processed)[this._processed.length-1].AppTaskId,this._trigger("appointmentCreated",{appointment:u.appointment,requestType:"appointmentSaved"}),this._trigger("actionComplete",{data:u.appointment,requestType:"appointmentSave"}));this._cellClick=!1;this._quickAppointWindow.ejDialog("close")}else{if(n.isFunction(n.validator)&&!n("#"+this._id+"_AddEditForm").validate().form())return!1;for(i={},o={},ri=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),g=this._currentAction==t.Schedule.Actions.Add||this._currentAction==t.Schedule.Actions.EditOccurrence?this.model.enableLoadOnDemand?this._dataCount+1:t.isNullOrUndefined(this._appMainId)?parseInt(this._appId):this._appMainId+1:ri[0].AppTaskId,h=n("#"+this._id+"AppointmentAddEditWindow").find("#"+this._id+"_AddEditForm").get(0),st=[],tt=[],e=0;e<h.length;e++)c=h[e].name,p=n(h[e]),c!=r&&(l=h[e].value,c!=""&&i[c]==null?(c==this._appointmentSettings.id&&(l=l==""?parseInt(g):parseInt(l)),n(h[e]).hasClass("e-datepicker")?l=p.ejDatePicker("option","value"):n(h[e]).hasClass("e-timepicker")?l=p.ejTimePicker("option","value"):p.data("ejDropDownList")?l=p.ejDropDownList("model.value"):p.data("ejAutocomplete")&&(n(h[e])[0].id==this._id+"categorize"?tt.push(p.data("ejAutocomplete").getSelectedItems()):n(h[e])[0].id.indexOf(this._id+"_ownerfield_")==0&&st.push(p.data("ejAutocomplete").getSelectedItems())),c!="StartDate"&&c!="EndDate"&&c!="StartTime"&&c!="EndTime"?i[c]=h[e].type!="checkbox"?l:n(h[e]).is(":checked"):o[c]=c=="StartDate"||c=="EndDate"?new Date(l):l):p.data("ejAutocomplete")&&(n(h[e])[0].id==this._id+"categorize"?tt.push(p.data("ejAutocomplete").getSelectedItems()):n(h[e])[0].id.indexOf(this._id+"_ownerfield_")==0&&st.push(p.data("ejAutocomplete").getSelectedItems())));this.model.showTimeZoneFields||(i[this._appointmentSettings.startTimeZone]=this.model.timeZone==null?"UTC "+this._timezoneStringValue():this.model.timeZone,i[this._appointmentSettings.endTimeZone]=this.model.timeZone==null?"UTC "+this._timezoneStringValue():this.model.timeZone);this.model.categorizeSettings.enable==!0&&this.model.categorizeSettings.allowMultiple!=!0&&(ui=this.model.categorizeSettings,categorizeDataIndex=this._findResourceIndex(ui.dataSource,this.model.categorizeSettings.text,i[this._appointmentSettings.categorize]),tt[0].push(this.model.categorizeSettings.dataSource[categorizeDataIndex]),tt[0].shift());"null"in i&&delete i[null];ht=this._timeFormat(this._startSlotChange||t.isNullOrUndefined(this.cur_StartTime)?o.StartTime:new Date(this.cur_StartTime).toTimeString()).split(":");ct=this._timeFormat(this._endSlotChange||t.isNullOrUndefined(this.cur_EndTime)?o.EndTime:new Date(this.cur_EndTime).toTimeString()).split(":");i[this._appointmentSettings.startTime]=new Date(o.StartDate.setHours(parseInt(ht[0],10),parseInt(ht[1],10)));i[this._appointmentSettings.endTime]=new Date(o.EndDate.setHours(parseInt(ct[0],10),parseInt(ct[1],10)));i[this._appointmentSettings.recurrence]&&(i[this._appointmentSettings.recurrenceRule]=nt._recRule);this._publicMethodSave=!0;l=this._timeZoneSavingAppoint(i,o);i=l.obj;var rt=this._currentAction=="save"?"edit":this._currentAction,wt=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),k=new t.DataManager(this._processed).executeLocal(wt);if(i[this._appointmentSettings.recurrenceRule]!=""&&!t.isNullOrUndefined(i[this._appointmentSettings.recurrenceRule])&&this.model.enableRecurrenceValidation&&(this._currentAction=="editSeries"||this._currentAction=="editOccurrence"||this._currentAction=="save"))if(this._currentAction=="editOccurrence"||this._currentAction=="save"){var ft=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],bt=ft[this._appointmentSettings.recurrenceId]==null?ft.ParentId:ft[this._appointmentSettings.recurrenceId],kt=ft[this._appointmentSettings.recurrenceId]==null?"ParentId":this._appointmentSettings.recurrenceId,d=new t.DataManager(this._processed).executeLocal((new t.Query).where(kt,t.FilterOperators.equal,bt)),ci=(i[this._appointmentSettings.endTime]-i[this._appointmentSettings.startTime])/36e5<24&&i[this._appointmentSettings.endTime].getDate()!=i[this._appointmentSettings.startTime].getDate();ci&&(d=this._recurrenceAppSort(d));var d=this._appointmentRecurrenceSort(d),e=this._recuCollectionIndex(d,ft),it=this._appointmentSettings;if(e==0?t.isNullOrUndefined(d[e+1])?!1:!(new Date(new Date(d[e+1][it.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[it.endTime]).setHours(0,0,0,0)).getTime()):e==d.length-1?!(new Date(new Date(d[e-1][it.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[it.startTime]).setHours(0,0,0,0)).getTime()):!(new Date(new Date(d[e-1][it.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[it.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(d[e+1][it.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[it.endTime]).setHours(0,0,0,0)).getTime()))return this._alertCreateError(),!1}else if(!this._recurrenceValidate(i[this._appointmentSettings.recurrenceRule],k[0][this._appointmentSettings.recurrenceExDate]))return this._alertCreateError(),!1;if(this._currentAction==t.Schedule.Actions.EditOccurrence?(this._objDate=k,kt=this._objDate[0][this._appointmentSettings.recurrenceId]==null?"ParentId":this._appointmentSettings.recurrenceId,f=this._deleteOcurrence(this._objDate[0][kt],new Date(k[0][this._appointmentSettings.startTime])),i[this._appointmentSettings.recurrence]=1,i[this._appointmentSettings.recurrenceRule]=f[0][this._appointmentSettings.recurrenceRule]+";RECUREDITID="+f[0].ParentId,i[this._appointmentSettings.recurrenceId]=f[0][this._appointmentSettings.recurrenceId],i.Guid=this._appUid,i[this._appointmentSettings.recurrenceExDate]=f[0][this._appointmentSettings.recurrenceExDate]):this._currentAction==t.Schedule.Actions.EditSeries&&(bt=k[0][this._appointmentSettings.recurrenceId]==null?k[0].ParentId:k[0][this._appointmentSettings.recurrenceId],f=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,bt)),i.AppTaskId=f[0].AppTaskId,i[this._appointmentSettings.id]=f[0][this._appointmentSettings.id],i.Guid=this._appUid,g=f[0].AppTaskId,i[this._appointmentSettings.recurrenceId]=f[0][this._appointmentSettings.recurrenceId],i[this._appointmentSettings.recurrenceExDate]=null,i[this._appointmentSettings.recurrenceRule]=t.isNullOrUndefined(nt._recRule)||nt._recRule==""?f[0][this._appointmentSettings.recurrenceRule]:nt._recRule),this._currentAction!=t.Schedule.Actions.Add){if((i.Guid=k[0].Guid,i.AppTaskId=k[0].AppTaskId,i[this._appointmentSettings.id]=this._currentAction!=t.Schedule.Actions.EditSeries?k[0][this._appointmentSettings.id]:i[this._appointmentSettings.id],this._trigger("actionBegin",{data:i,requestType:"appointmentEdit",currentAction:rt}))||this._trigger("beforeAppointmentChange",{appointment:i,currentAction:rt}))return this._appointmentAddWindow.ejDialog("close"),!1}else if(i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,this._trigger("actionBegin",{data:i,requestType:"appointmentSave"}))return this._appointmentAddWindow.ejDialog("close"),!1;if(u=[],this._startTimezone!=this._endTimezone?i[this._appointmentSettings.endTime]=l.cloneEnddiffer:"",parId=this._currentAction==t.Schedule.Actions.Add?g:k[0].ParentId,!t.isNullOrUndefined(this.model.categorizeSettings)&&tt.length>0&&!t.isNullOrUndefined(tt[0][0])||this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources?u=this._getResCategorySaveData(tt,st,i,g,parId,ht,ct):(lt=this._addAppData(i,g,new Date(i[this._appointmentSettings.startTime]),new Date(i[this._appointmentSettings.endTime]),parId),this._currentAction==t.Schedule.Actions.EditOccurrence&&(lt[this._appointmentSettings.id]=lt.AppTaskId),u.push(lt)),this._currentAction==t.Schedule.Actions.Add&&this._trigger("beforeAppointmentCreate",{appointment:u}))return this._appointmentAddWindow.ejDialog("close"),!1;if(ut=this._checkAvailability(u[0]),u[this._appointmentSettings.startTime]>u[this._appointmentSettings.endTime]||ut.length>0)return this._showBlockAlert&&this._alertBlockError(),!1;if(this._currentAction==t.Schedule.Actions.Add||this._currentAction==t.Schedule.Actions.EditOccurrence){for(v=this,o=[],w=0;w<u.length;w++)at=u[w][this._appointmentSettings.startTimeZone],at!=this.model.timeZone?o.push(this._timeZoneAppointments(u[w],"")):o.push(u[w]),new t.DataManager(this._currentAppointmentData).update("AppTaskId",u[w]);for(f=[],this._currentAction==t.Schedule.Actions.EditOccurrence?(dt=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,this._parentId)),new t.DataManager(this._currentAppointmentData).update("AppTaskId",dt[0]),f.push(this._timeZoneAppointments(dt[0],""))):f=[],y=this.dataSource()instanceof t.DataManager?this._dataManager.saveChanges({added:o,changed:f,deleted:[]},this._appointmentSettings.id,this.model.appointmentSettings.query._fromTable):this._dataManager.saveChanges({added:o,changed:f,deleted:[]},"AppTaskId"),gt=[],s=0;s<o.length;s++)gt=at!=this.model.timeZone?this._timeZoneAppointments(o[s],"reverse"):o[s],new t.DataManager(this._currentAppointmentData).update("AppTaskId",gt);for(ni=[],s=0;s<f.length;s++)ni=at!=this.model.timeZone?this._timeZoneAppointments(f[s],"reverse"):f[s],new t.DataManager(this._currentAppointmentData).update("AppTaskId",ni);n.isFunction(y.promise)&&this.dataSource()instanceof t.DataManager?(y.done(function(n){v._processUrlBinding(n);v._trigger("appointmentCreated",{appointment:u[0],requestType:"appointmentSaved"});v._trigger("actionComplete",{data:u,requestType:"appointmentSave"})}),y.fail(function(){})):(this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll(),this._trigger("appointmentCreated",{appointment:u[0],requestType:"appointmentSaved"}),this._trigger("actionComplete",{data:u,requestType:"appointmentSave"}))}else if(this._currentAction==t.Schedule.Actions.Save||this._currentAction==t.Schedule.Actions.EditSeries){var ti=[],b=[],vt=[];for(a=0;a<u.length;a++)fi=this._currentAction==t.Schedule.Actions.Save?u[a].Guid:u[a][this._appointmentSettings.recurrenceId],ei=this._currentAction==t.Schedule.Actions.Save?"Guid":this._appointmentSettings.recurrenceId,f=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(ei,t.FilterOperators.equal,fi)),!t.isNullOrUndefined(f)&&f.length>0?b.push(u[a]):ti.push(u[a]);if(this._currentAction==t.Schedule.Actions.EditSeries)for(a=0;a<b.length;a++)wt=t.Query().where(t.Predicate(this._appointmentSettings.recurrenceRule,t.FilterOperators.contains,"RECUREDITID="+u[a][this._appointmentSettings.recurrenceId],!0)),oi=new t.DataManager(this._currentAppointmentData).executeLocal(wt),vt=vt.concat(oi),this._appointmentAddWindow.find(".recurbutton").click(),b[a][this._appointmentSettings.recurrenceRule]=nt._recRule,b[a][this._appointmentSettings.recurrenceExDate]=null;var v=this,y,et=[],ot=[];for(w=0;w<ti.length;w++)et.push(this._timeZoneAppointments(ti[w],""));for(yt=0;yt<b.length;yt++)ot.push(this._timeZoneAppointments(b[yt],""));for(y=this.dataSource()instanceof t.DataManager?this._dataManager.saveChanges({added:et,changed:ot,deleted:vt},this._appointmentSettings.id,this.model.appointmentSettings.query._fromTable):this._dataManager.saveChanges({added:et,changed:ot,deleted:vt},"AppTaskId"),s=0;s<et.length;s++)new t.DataManager(this._currentAppointmentData).update("AppTaskId",this._timeZoneAppointments(et[s],"reverse"));for(pt=0;pt<ot.length;pt++)new t.DataManager(this._currentAppointmentData).update("AppTaskId",this._timeZoneAppointments(ot[pt],"reverse"));b.length>0&&(v=this,n.isFunction(y.promise)&&this.dataSource()instanceof t.DataManager?(y.done(function(n){v._processUrlBinding(n);v._trigger("appointmentChanged",{appointment:b[0],requestType:"appointmentChanged",currentAction:rt});v._trigger("actionComplete",{data:b,requestType:"appointmentEdit",currentAction:rt})}),y.fail(function(){})):(this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll(),this._trigger("appointmentChanged",{appointment:b[0],requestType:"appointmentChanged",currentAction:rt}),this._trigger("actionComplete",{data:b,requestType:"appointmentEdit",currentAction:rt})))}this._clearFields();this._appointmentAddWindow.ejDialog("close")}this.element.find("div.e-draggableworkarea tr").find("td").hasClass("e-selectedCell")&&this._processFocus();this.model.orientation=="horizontal"&&this.currentView()!="agenda"&&this.element.find(".e-draggableworkarea").offset().top>this.element.find(".e-workcellstab").offset().top&&(si=this.element.find(".e-draggableworkarea").offset().top-this.element.find(".e-workcellstab").offset().top,this.element.find(".e-horires").css("top",-si+"px"));this._recRule=""},_alertCreateError:function(){n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert"));this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("CreateError"));this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok"));this._alertWindow.ejDialog("open")},_timeZoneSavingAppoint:function(n,i){var s,f,r,e;if(this.model.appointmentSettings.applyTimeOffset){if(this._startTimezone=n[this._appointmentSettings.startTimeZone],this._endTimezone=n[this._appointmentSettings.endTimeZone],!t.isNullOrUndefined(this._startTimezone)&&this._startTimezone!=""){var o=this._startTimezone.indexOf("UTC")!=-1?this._startTimezone.split(" ")[1].split(":"):this._startTimezone.split(":"),l=parseInt(o[0]),a=parseInt(o[1]),u=l*60+a;if(this.model.timeZone==null?(s=(new Date).getTimezoneOffset()-this._timeZoneOffset,r=this._minToHour(s+u)):(f=this.model.timeZone.indexOf("UTC")!=-1?this.model.timeZone.split(" ")[1].split(":"):this.model.timeZone.split(":"),r=this._minToHour(u),r.h=r.h-parseInt(f[0]),r.m=r.m-parseInt(f[1])),new Date(n[this._appointmentSettings.startTime].setHours(n[this._appointmentSettings.startTime].getHours()-r.h,n[this._appointmentSettings.startTime].getMinutes()-r.m)),this._startTimezone!=this._endTimezone&&this._publicMethodSave){this.startutcValue=null;this.tempValue=null;var h=this._endTimezone.indexOf("UTC")!=-1?this._endTimezone.split(" ")[1].split(":"):this._endTimezone.split(":"),v=parseInt(h[0]),y=parseInt(h[1]),p=v*60+y,w=u-p,b=new Date(i.StartDate),k=new Date(n[this._appointmentSettings.startTime]),c=new Date(i.EndDate);duration=new Date(c.setMinutes(c.getMinutes()+w));duration=new Date(duration.setMinutes(duration.getMinutes()-(r.h*60+r.m)));e=duration}else new Date(n[this._appointmentSettings.endTime].setHours(n[this._appointmentSettings.endTime].getHours()-r.h,n[this._appointmentSettings.endTime].getMinutes()-r.m))}return{obj:n,cloneEnddiffer:e}}return{obj:n,cloneEnddiffer:e}},_renderAllDayAppointments:function(){var h=this.cellwidth-20,f,r,o,e,i,u,n,s;if(this.level=0,f=this._dateRender,this._renderedAllDay=[],allDayCount=[],this.element.find(".e-alldayappointment").remove(),r=this._appointmentSort(this._processed),this.model.group||(this.res1=["0"]),this._resWorkWeek)for(o=0,e=0,i=0;i<this.res1.length;i++)for(o+=t.isNullOrUndefined(this.res1[i][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?this.model.workWeek.length:this.res1[i][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length,e;e<o;e++)for(n=0;n<r.length;n++)this._getMultipleResourceAlldayApp(f,e,i,n),t.isNullOrUndefined(this.allDayCount[0])?"":allDayCount.push(this.allDayCount[0]),this._app=this._filtered;else for(i=0;i<this.res1.length;i++)for(u=0;u<f.length;u++)for(n=0;n<r.length;n++)this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?(this._getMultipleResourceAlldayApp(f,u,i,n),t.isNullOrUndefined(this.allDayCount[0])?"":allDayCount.push(this.allDayCount[0])):(s=this._findAllDayApp(r[n]),t.format(new Date(f[u]),this._pattern.d)==t.format(new Date(r[n][this._appointmentSettings.startTime]),this._pattern.d)&&(r[n][this._appointmentSettings.allDay]===!0||s)&&(this._setAllDayPos(r[n],u,i),this._filtered.push(r[n]),allDayCount.push(n))),this._app=this._filtered;this.allDayLevel=allDayCount.length;allDayCount.length==0&&this.level==0&&(this._mediaQuery?this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd").attr("style","height:40px !important"):this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd").css("height","27px"),this.element.find(".e-alldaycells").first().css(this.model.enableRTL?"border-right":"border-left","none"));this._reRenderScroller()},_renderSingleApp:function(){this.element.find(".e-prevapp,.e-nextapp").css("display","none");this._dataProcessing(this._currentAppointmentData);this._renderAppointmentAll()},_timeFormat:function(n){var i=Number(n.match(/^(\d+)/)[1]),e=Number(n.match(/:(\d+)/)[1]),f,r,u;return t.isNullOrUndefined(n.split(" ")[1])||(f=n.match(/\s(.*)$/)[1],t.isNullOrUndefined(this._culture.calendar.AM)||t.isNullOrUndefined(this._culture.calendar.PM)||(f==this._culture.calendar.PM[0]&&i<12&&(i=i+12),f==this._culture.calendar.AM[0]&&i==12&&(i=i-12))),r=i.toString(),u=e.toString(),i<10&&(r="0"+r),e<10&&(u="0"+u),r+":"+u},_processEscapeKey:function(){t.isNullOrUndefined(this._quickAppointWindow)||this._quickAppointWindow.find(".e-error").remove();this._processFocus();this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")},_processFocus:function(){var s=this.element.find("div.e-selectedAppointment"),o,l;if(s.length!=0&&s.focus(),this.element.find("td.e-selectedCell").hasClass("e-workcells")){var r=this.element.find("div.e-draggableworkarea tr"),h=r.length-1,i,t,c,f,u,e=this.currentView(),a=this;this.element.find("td.e-selectedCell").each(function(o,s){var l=n(s).index(),a;if(l!=null&&!isNaN(l))if(i==null?(i=l,c=n(s).parent()[0].rowIndex):i<l?i=i:i!=l&&(i=l,c=n(s).parent()[0].rowIndex),t==null){if(t=l,e!="month")for(u=parseInt(t),a=0;a<=h;a++)n(r[a].cells[u]).hasClass("e-selectedCell")&&(f=a)}else if(t>l)t=t;else if(t!=l&&(t=l,e!="month"))for(u=parseInt(t),a=0;a<=h;a++)n(r[a].cells[u]).hasClass("e-selectedCell")&&(f=a)});e!="month"?n(r[f].cells[t]).attr("tabIndex",0).focus():(o=r.find("td.e-selectedCell"),l=parseInt(o.length)-1,n(o[l]).attr("tabIndex",0).focus())}else this.element.focus(),this.element.find("td.e-selectedCell").attr("tabIndex",0).focus(),this._appointmentAddWindow.ejDialog("isOpened")&&this._appointmentAddWindow.find(".subject").focus()},_clearFields:function(){this._appointmentAddWindow.find(".subject").val("");this._appointmentAddWindow.find(".id").val("");this._appointmentAddWindow.find(".e-description").val("").css("height","");this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",new Date);this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",new Date);this._appointmentAddWindow.find(".startendtime").ejTimePicker({enabled:!0});this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",t.format(new Date,this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",t.format(new Date,this._pattern.t));this._appointmentAddWindow.find(".recurrence,.weekdays").ejCheckBox({checked:!1,enabled:!0});this._appointmentAddWindow.find(".e-repeatlbl").removeClass("e-disable");this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!1});this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList("clearText");this._appointmentAddWindow.find("."+this._id+"summary").css("display","none");this._appointmentAddWindow.find(".e-recurFinalRule").html("");this._appointmentAddWindow.find(".e-recuredit").hide();this._appointmentAddWindow.find(".e-categorizevalue").ejAutocomplete("clearText")},_getNumericModel:function(){return numericModel={width:"100px",minValue:1,value:1,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,localize:this.model.locale}},_deleteApp:function(r){var y=this.level,h,l,e=this._actionType==t.Schedule.Actions.DeleteSeries?t.Schedule.Actions.DeleteSeries:t.Schedule.Actions.Delete,f,u,o,c,a,p,s,w,v,b;if(this._trigger("actionBegin",{id:r,requestType:"appointmentDelete",currentAction:e})||(f=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,r)),f.length==0)||(h={appointment:f[0]},this._trigger("beforeAppointmentRemove",{appointment:f[0],currentAction:e})))return!1;if(u=this._getAppointmentByParentId(r),f[0][this._appointmentSettings.recurrence]){var k=f[0][this._appointmentSettings.recurrenceId]==null?f[0].ParentId:f[0][this._appointmentSettings.recurrenceId],d=f[0][this._appointmentSettings.recurrenceId]==null?"ParentId":this._appointmentSettings.recurrenceId,g=(new t.Query).where(d,t.FilterOperators.equal,k);l=t.DataManager(this._currentAppointmentData).executeLocal(g);o=this.dataSource()instanceof t.DataManager?this._dataManager.saveChanges({added:[],changed:[],deleted:l},this._appointmentSettings.id,this.model.appointmentSettings.query._fromTable):this._dataManager.saveChanges({added:[],changed:[],deleted:l},"AppTaskId")}else o=this.dataSource()instanceof t.DataManager?this._dataManager.remove("Id",u[this._appointmentSettings.id],this.model.appointmentSettings.query._fromTable):this._dataManager.remove("AppTaskId",u.AppTaskId);if(this._refreshCellsHeight(),c=this,!t.isNullOrUndefined(o))if(n.isFunction(o.promise))o.done(function(n){c._processUrlBinding(n);c._trigger("appointmentRemoved",{appointment:u,requestType:"appointmentDeleted",currentAction:e});c._trigger("actionComplete",{data:u,requestType:"appointmentDelete",currentAction:e})}),o.fail(function(){});else{if(a=new Date(new Date(u[this._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(u[this._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(u[this._appointmentSettings.endTime]-u[this._appointmentSettings.startTime])/36e5<24&&u[this._appointmentSettings.allDay]!==!0&&u[this._appointmentSettings.recurrence]!=1,this.currentView()!="agenda")if(this._currentAppointmentData.length>0)this.model.timeScale.enable?u[this._appointmentSettings.recurrence]||a||(new Date(u[this._appointmentSettings.endTime])-new Date(u[this._appointmentSettings.startTime]))/36e5>24?(this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll()):(new t.DataManager(this._processed).remove("Guid",r),this.element.find("[guid="+r+"]").remove(),this.element.find("div[id=categorybar_"+r+"]").remove(),this.model.orientation=="vertical"&&this.currentView()!="month"&&!this._isCustomMonthView()&&f[0][this._appointmentSettings.allDay]==1?this._reRenderAllDayAppointments():this._renderAppointmentAll(),y=this.allDayLevel):u[this._appointmentSettings.recurrence]||a||(new Date(u[this._appointmentSettings.endTime])-new Date(u[this._appointmentSettings.startTime]))/36e5>24?this._dataProcessing(this._currentAppointmentData)&&this._renderAppointmentAll():new t.DataManager(this._processed).remove("Guid",r)&&this._renderAppointmentAll();else for(p=(new t.Query).where("ParentId",t.FilterOperators.equal,u.ParentId),s=new t.DataManager(this._processed).executeLocal(p),i=0;i<s.length;i++)this.element.find("[guid="+s[i].Guid+"]").remove(),this.element.find("div[id=categorybar_"+s[i].Guid+"]").remove(),new t.DataManager(this._processed).remove("Guid",s[i].Guid);else new t.DataManager(this._processed).remove("Guid",r),w=new t.DataManager(this._processed).executeLocal((new t.Query).where(t.Predicate("ParentId",t.FilterOperators.equal,f[0].ParentId))),new t.DataManager(this._processed).saveChanges({added:[],changed:[],deleted:w},"Guid"),this._renderAgendaContent();this._trigger("appointmentRemoved",{appointment:u,requestType:"appointmentDeleted",currentAction:e});this._trigger("actionComplete",{data:u,requestType:"appointmentDelete",currentAction:e});this.model.timeScale.enable&&((h.appointment[this._appointmentSettings.endTime]-h.appointment[this._appointmentSettings.startTime])/36e5>24||h.appointment[this._appointmentSettings.allDay])&&this.currentView()!="month"&&!this._isCustomMonthView()&&this.currentView()!="agenda"&&y==0&&(this._mediaQuery?this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd").attr("style","height:40px !important"):this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd").css("height","27px"),this.element.find(".e-alldaycells").first().css(this.model.enableRTL?"border-right":"border-left","none"),this._reRenderScroller())}v=this._appointmentCount();v.length<1&&this.model.showAppointmentNavigator&&this._nextPrevButton(v);this.model.showOverflowButton||this.model.orientation!="horizontal"||this.currentView()=="agenda"||(b=this.element.find(".e-draggableworkarea").offset().top-this.element.find(".e-workcellstab").offset().top,this.element.find(".e-horires").css("top",-b+"px"));this._appUid=null;this._actionType=""},_appointmentCount:function(){var i=this._dateRender,n=this._processed;n=this._sortAppById(n);n=this._appointmentSort(n);var u=this.currentView()=="agenda"?new Date(new Date(this.currentDate()).setHours(0,0,0)):new Date(i[0]),f=this.currentView()=="agenda"?new Date(new Date(new Date(this.currentDate()).setDate(u.getDate()+(this.model.agendaViewSettings.daysInAgenda>0?this.model.agendaViewSettings.daysInAgenda-1:0))).setHours(23,59,59)):new Date(new Date(i[i.length-1]).setHours(23,59,59)),r=t.Predicate(this._appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,u);return r=r.and(this._appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,f),new t.DataManager(n).executeLocal((new t.Query).where(r))},_reRenderAllDayAppointments:function(){this._alldayLevel=this.level==1?!0:!1;this.model.showAllDayRow&&this.element.find("div.e-alldayappointment").remove()&&this._renderAllDayAppointments();this._unWireResizeEvents();this._wireResizeEvents();this._dragdropAppointments()},_appointmentResizeStart:function(i){if(this.model.enableAppointmentResize){this._appointdata=n(i.target).parent();var u=n(i.target).parent().attr("guid"),f=this._sortAppById(new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,u))),r={element:n(i.target).parent(),appointment:f[0]};if(this._trigger("actionBegin",{data:r,requestType:"appointmentResize"})||this._trigger("resizeStart",r))return!1;i.preventDefault();this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");this.resizeStart=!0;n(i.target).hasClass("e-lefthandle")||n(i.target).hasClass("e-righthandle")?(this.resize=i.pageX,this.appoint_width=n(i.target).parent().width(),this.appoint_left=parseInt(n(i.target).parent()[0].style.left),this._appointleft=parseInt(n(n(i.target).parent()[0]).offset().left),this._appointright=parseInt(n(n(i.target).parent()[0]).css("right")),this.model.orientation=="horizontal"&&this.model.enableRTL?n(i.target).hasClass("e-lefthandle")?this._rightResizing=!0:this._leftResizing=!0:n(i.target).hasClass("e-lefthandle")?this._leftResizing=!0:this._rightResizing=!0):(n(i.target).hasClass("e-tophandle")||n(i.target).hasClass("e-bottomhandle"))&&(this.resize=i.pageY,this.appoint_height=n(i.target).parent().height(),this.appoint_top=parseInt(n(i.target).parent()[0].style.top),n(i.target).hasClass("e-tophandle")?this._topResizing=!0:this._bottomResizing=!0);this._curElmt=n(i.target).parent();this.element.find(".e-workcells").removeClass("e-selectedCell,e-mousehover");n(document).on(t.eventType.mouseMove,n.proxy(this._appointmentResizing,this));n(document).on(t.eventType.mouseUp,n.proxy(this._appointmentResizeStop,this));if(n(i.target).hasClass("e-rowcursor")||n(i.target).hasClass("e-columncursor"))return!1}},_appointmentResizing:function(i){var e=n(i.target),o={element:e.parent()},r,u,f;if(t.isNullOrUndefined(this.element.data("ejTooltip"))||this.element.ejTooltip("hide"),r=n(i.target).hasClass("e-appointment")||n(i.target).hasClass("e-monthappointment")||n(i.target).hasClass("e-alldayappointment")?n(i.target):n(i.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),n(".e-scheduleAppGlassy").length==0&&(r.find(".e-schedulemouseclose").addClass("e-schedulemouseclosetemp").removeClass("e-schedulemouseclose e-icon"),r.clone().prop("id","cloneElement").appendTo(r.parent()),r.addClass("e-draggableAppointment e-scheduleAppGlassy").removeClass("e-schedulemouseclose").appendTo(r.parent()),this._topResizing||this._bottomResizing?(this.model.enableRTL?r.css("right","0"):r.css("left","0"),r.css("width","98%")):(this._rightResizing||this._leftResizing)&&(this.model.orientation!="horizontal"?this.currentView()==="month"||this._isCustomMonthView()?this._appointmentResizeHeight(r,-this.element.find(".e-monthheader").height(),"e-monthcells"):this.model.timeScale.enable?(r.css("top",this.element.find(".e-headerarearow").height()-this.element.find(".e-alldaycells").height()-2),r.css("height",this.element.find(".e-alldaycells").height()-2)):r.css("height",this.element.find(".e-monthcells").height()-2):this._appointmentResizeHeight(r,0,"e-workcells"))),r=n(i.target).hasClass("e-appointment")||n(i.target).hasClass("e-monthappointment")||n(i.target).hasClass("e-workcells")||n(i.target).hasClass("e-monthcells")||n(i.target).hasClass("e-alldayappointment")||n(i.target).hasClass("e-alldaycells")?n(i.target):n(i.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),u=this.element.find(".e-workcells").height(),f=n(r[0]).height()/u,this._trigger("resize",o))return!1;this._topResizing?f>0&&!n(i.target).hasClass("e-alldaycells")&&!n(i.target).hasClass("e-apptext")&&(this._curElmt.height(this.appoint_height+this.resize-i.pageY+3),this._curElmt.css("top",this.appoint_top-(this.resize-i.pageY)-3)):this._bottomResizing?this._curElmt.height(this.appoint_height+(i.pageY-this.resize)+2):this._rightResizing?this.model.orientation=="horizontal"&&this.model.enableRTL?(this._curElmt.width(this.appoint_width+this.resize-i.pageX+3),this._curElmt.css("left",this.appoint_left-(this.resize-i.pageX)-3)):(this._curElmt.width(this.appoint_width+(i.pageX-this.resize)+2),this._curElmt.css("right",this._appointright-(i.pageX-this.resize)-2)):this._leftResizing&&(this.model.orientation=="horizontal"&&this.model.enableRTL?(this._curElmt.width(this.appoint_width+(i.pageX-this.resize)+2),this._curElmt.css("right",this._appointright-(i.pageX-this.resize)-2)):(this._curElmt.width(this.appoint_width+this.resize-i.pageX+3),this._curElmt.css("left",this.appoint_left-(this.resize-i.pageX)-3)));this._curElmt.hasClass("e-appointment")&&this._appointmentCurrentTimeUpdate()},_appointmentResizeHeight:function(t,i,r){var u,f;this.model.showOverflowButton||(u=document.elementsFromPoint(t.offset().left,t.offset().top));f=this.model.showOverflowButton?this.element.find("."+r):n.grep(u,function(t){if(n(t).hasClass(r))return t});t.css("top",i).css("height",n(f).height()-2)},_appointmentCurrentTimeUpdate:function(){var v=new t.DataManager(this._processed).executeLocal((new t.Query).where("AppTaskId",t.FilterOperators.equal,parseInt(this._curElmt.attr("id").split("_")[1])))[0],i=new Date(v[this._appointmentSettings.startTime]),r=new Date(v[this._appointmentSettings.endTime]),s=this.element.find(".e-workcells").height(),h=parseInt(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount),b,o,k,l,g,f;if(this.currentView()!=="month"&&!this._isCustomMonthView())var u=this.element.find(".e-draggableworkarea"),it=n(this._curElmt[0]).offset().top,y=u.height()+u.scrollTop(),rt=n(this._curElmt[0]).outerHeight(),p=it-u.offset().top+u.scrollTop(),w=p-s/this.model.timeScale.minorSlotCount<y?p:y-rt;if(this._topResizing)o=w*this.model.timeScale.majorSlot/(this.model.timeScale.minorSlotCount*(s+1)),i.setHours(parseInt(this.model.startHour)+parseInt(o/60)),i.setMinutes(parseInt(o%60)),h>=10?i.setMinutes(Math.round(i.getMinutes()/10)*10):i.setMinutes(i.getMinutes()*1);else if(this._bottomResizing)b=n(this._curElmt[0]).outerHeight()/s,o=(w+b*s)*this.model.timeScale.majorSlot/(this.model.timeScale.minorSlotCount*(s+1)),r.setHours(parseInt(this.model.startHour)+parseInt(o/60)),r.setMinutes(o%60),h>=10?r.setMinutes(Math.round(r.getMinutes()/10)*10):r.setMinutes(r.getMinutes()*1);else if(this._rightResizing){if(k=this.model.endHour-this.model.startHour==24?this._curElmt.width()-this.appoint_width:this._curElmt.width(),f=k*60/(this.element.find(".e-workcells").width()*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)+1),this.model.endHour-this.model.startHour==24?(r.setHours(new Date(r).getHours()+parseInt(f/60)),r.setMinutes(new Date(r).getMinutes()+parseInt(f%60))):(r.setHours(new Date(i).getHours()+parseInt(this._curElmt.width()/this.element.find(".e-workcells").width())/(this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))),r.setMinutes(new Date(i).getMinutes()+parseInt(f%60))),h>=10?r.setMinutes(Math.round(r.getMinutes()/10)*10):r.setMinutes(r.getMinutes()*1),r>new Date(new Date(this._dateRender[this._dateRender.length-1]).setHours(23,59,59))&&(r=new Date(new Date(this._dateRender[this._dateRender.length-1]).setHours(23,59,59))),this.model.endHour-this.model.startHour!=24){var ut=parseInt((this._curElmt.offset().left+(u.scrollLeft()-u.offset().left)+this._curElmt.width())/this.element.find(".e-workcells").width())-1,c=parseInt(ut/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))),ft=new Date(i),d=new Date(r).getHours()>=this.model.endHour?(this._dateRender[c]-new Date(new Date(new Date(i).setHours(0,0,0,0))).getTime())/864e5:0,et=this.currentView()=="workweek"?(d-1)*(this.model.endHour-this.model.startHour):0,e=new Date(r).getHours()>=this.model.endHour?new Date(new Date(ft).setHours(new Date(i).getHours()+et+parseInt(n(this._curElmt).width()/this.element.find(".e-workcells").width())/(this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))+d*(24-this.model.endHour+this.model.startHour))):r;new Date(r).getHours()>=this.model.endHour&&e.setMinutes(new Date(i).getMinutes()+parseInt(f%60));new Date(new Date(e).setHours(0,0,0,0)).getTime()!=new Date(this._dateRender[c]).getTime()&&(e=new Date(this._dateRender[c]).setHours(new Date(e).getHours(),new Date(e).getMinutes(),new Date(e).getSeconds(),new Date(e).getMilliseconds()));r=new Date(e)}}else if(this._leftResizing&&(l=n(this.element.find(".e-workcells.e-childworkcell")[0]).offset().left<n(this._curElmt).offset().left?this._curElmt.offset().left-this._appointleft:n(this.element.find(".e-workcells.e-childworkcell")[0]).offset().left-this._appointleft,this.model.enableRTL&&(g=this._curElmt.width()-this.appoint_width,l=-g),f=l*60/(this.element.find(".e-workcells").width()*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)+1),i.setHours(parseInt(new Date(i).getHours())+parseInt(f/60)),i.setMinutes(new Date(i).getMinutes()+parseInt(f%60)),h>=10?i.setMinutes(Math.round(i.getMinutes()/10)*10):i.setMinutes(i.getMinutes()*1),i<new Date(this._dateRender[0])&&(i=new Date(this._dateRender[0])),this.model.endHour-this.model.startHour!=24)){var ot=u.scrollLeft()==0?u.offset().left:u.scrollLeft()-u.offset().left,nt=(this._curElmt.offset().left+ot)/this.element.find(".e-workcells").width()-1,st=parseInt(parseInt(nt)/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))),a=new Date(this._dateRender[st]),ht=nt%((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)),tt=this.model.startHour+ht/(this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))-.2;a.setHours(tt);a.setMinutes(tt*60%60);i=new Date(a)}this.model.enableRTL?(this._curElmt.find(".e-apptext").html(t.format(new Date(i),this._timeMode=="12"?this._pattern.t:"HH:mm")).css("font-size","12px").css("white-space","normal"),this._curElmt.find(".e-apptime").html(t.format(new Date(r),this._timeMode=="12"?this._pattern.t:"HH:mm")).css("font-size","12px").css("white-space","normal").css("float","left").css("margin-top",this._curElmt.height()-(this._curElmt.find(".e-apptime").height()+this._curElmt.find(".e-apptext").height())+"px")):(this._curElmt.find(".e-apptext").html(t.format(new Date(i),this._timeMode=="12"?this._pattern.t:"HH:mm")).css("font-size","12px").css("white-space","normal"),this._curElmt.find(".e-apptime").html(t.format(new Date(r),this._timeMode=="12"?this._pattern.t:"HH:mm")).css("font-size","12px").css("white-space","normal").css("float","right").css("margin-top",this._curElmt.height()-(this._curElmt.find(".e-apptime").height()+this._curElmt.find(".e-apptext").height())+"px"));this._resizeNewStartTime=i;this._resizeNewEndTime=r},_leftRightResize:function(t,i,r,u,f,e){var o=this._leftResizing?f:e,h=this._leftResizing?e:f,c,a,l,v,w,s;if(this._resWorkWeek)var y=this._leftResizing?t.elementsFromPoint(i.offset().left,i.offset().top):t.elementsFromPoint(i.offset().left+i.width(),i.offset().top),p=n.grep(y,function(t){if(n(t).hasClass("e-alldaycells"))return t}),c=n(p[0]).index();else c=this._leftResizing?r*u:r==this.res1.length-1?(r+1)*u-1:(r+1)*u;if(this.model.enableRTL)if(this._resWorkWeek){v=n.extend(!0,[],this._dateRender);v.reverse();var y=this._rightResizing?t.elementsFromPoint(i.offset().left,i.offset().top):t.elementsFromPoint(i.offset().left+i.width(),i.offset().top),p=n.grep(y,function(t){if(n(t).hasClass("e-alldaycells"))return t}),c=n(".e-alldaycells").length-1-n(p[0]).index();newEndTime=new Date(v[c]);newEndTime.setHours(new Date(h).getHours(),new Date(h).getMinutes(),new Date(h).getSeconds())}else w=n(i[0]).width()-this.appoint_width,s=Math.round(w/this.element.find(".e-alldaycells").width()),newEndTime=this._rightResizing?new Date(h):new Date(o),this._rightResizing?newEndTime.setDate(new Date(newEndTime).getDate()-s):newEndTime.setDate(new Date(newEndTime).getDate()+s),newEndTime.setHours(new Date(h).getHours(),new Date(h).getMinutes());else this._rightResizing?(l=i[0].offsetLeft+n(i[0]).width(),this._resWorkWeek||(s=Math.floor(l/this.element.find(".e-alldaycells").width())-r*u),a=r==this.res1.length-1?n(this.element.find(".e-alldaycells")[c]).offset().left+this.element.find(".e-alldaycells").width():n(this.element.find(".e-alldaycells")[c]).offset().left):(l=n(this.element.find(".e-alldaycells")[c]).offset().left,a=n(i[0]).offset().left),a>=l?(newStartTime=new Date(this._dateRender[0]),!this._resWorkWeek&&this._leftResizing&&(l=n(i[0]).offset().left-n(this.element.find(".e-alldaycells")[r*u]).offset().left,s=Math.round(l/(this.element.find(".e-alldaycells").width()+1))),this.model.workWeek.length>0?this._resWorkWeek?(newStartTime=new Date(this._dateRender[c]),newStartTime.setHours(new Date(o).getHours(),new Date(o).getMinutes(),new Date(o).getSeconds())):(newStartTime=new Date(this._dateRender[0]),newStartTime.setDate(new Date(this._dateRender[s]).getDate()),newStartTime.setMonth(new Date(this._dateRender[s]).getMonth()),newStartTime.setHours(new Date(o).getHours(),new Date(o).getMinutes(),new Date(o).getSeconds())):(newStartTime=new Date(this._dateRender[0]),newStartTime.setDate(new Date(newStartTime).getDate()+(s>=u?s-1:s)),newStartTime.setHours(new Date(o).getHours(),new Date(o).getMinutes(),new Date(o).getSeconds()))):(this._rightResizing?this._rightResizing=!1:this._leftResizing=!1,this.model.enableRTL?newEndTime=e:newStartTime=f);return this.model.enableRTL?newEndTime:newStartTime},_appointmentResizeStop:function(i){var et,ni,vt,yt,di,gi,pt,ui,lt,ct,wt,b,fi,at,bt,w,oi,kt,si,hi,dt,gt,tt,l,ut,c,e,ft,k,p,ci,it,li;try{et=this.element.find(".e-draggableworkarea");this.resizeStart=!1;n(document).off(t.eventType.mouseMove,n.proxy(this._appointmentResizing,this));n(document).off(t.eventType.mouseUp,n.proxy(this._appointmentResizeStop,this));var u=this._appointmentSettings,ai=this.element.find(".e-workcellstab"),vi=ai.find("tr").length*this.element.find(".e-workcells").height(),s=n(i.target).hasClass("e-appointment")||n(i.target).hasClass("e-monthappointment")||n(i.target).hasClass("e-alldayappointment")?n(i.target):n(i.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment");s.length==0&&(s=this._appointdata);s.attr("guid")!=this._appointdata.attr("guid")&&(s=this._appointdata);this._appUid=s.attr("guid");var a=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),ot=a.length>1?!0:!1,v=a[0][u.recurrence]&&a[0][u.recurrenceRule].toString().indexOf("RECUREDITID")==-1?this._getAppointmentByParentId(this._appUid):a[0][u.recurrence]?a[0]:this._getAppointmentByParentId(this._appUid),y=this.currentView()==="week"||this.currentView()==="month"||this._isCustomMonthView()?7:this.currentView()==="workweek"&&this.model.workWeek.length>0?this.model.workWeek.length:1;if(y=this.currentView()=="customview"&&this._renderDays<=7?this._renderDays:y,this._resWorkWeek&&(vt=new t.DataManager(this.res1).executeLocal((new t.Query).where(this._tempResource[this._tempResource.length-1].resourceSettings.id,t.FilterOperators.equal,a[0][this._appointmentSettings.resourceFields.split(",")[this._appointmentSettings.resourceFields.split(",").length-1]])),ni=t.isNullOrUndefined(vt[0][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?this.model.workWeek:vt[0][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek],y=ni.length),v!=null||v!==r){var ur=v[this._appointmentSettings.startTime].getDate()<new Date(v[this._appointmentSettings.endTime]).getDate()?!0:!1,o=new Date(v[this._appointmentSettings.startTime]),f=new Date(v[this._appointmentSettings.endTime]);ot&&a[0][u.recurrence]?(yt=this._sortAppById(new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,a[0].Guid))),o=new Date(yt[0][this._appointmentSettings.startTime]),f=new Date(yt[1][this._appointmentSettings.endTime])):a[0][u.recurrence]&&(o=new Date(a[0][this._appointmentSettings.startTime]),f=new Date(a[0][this._appointmentSettings.endTime]));this.element.find("[guid="+a[0].Guid+"]").removeClass("e-selectedAppointment");var d=v[this._appointmentSettings.startTime],g=v[this._appointmentSettings.endTime],ti=n(s[0]).outerHeight(),ht=this.element.find(".e-workcells").height();if(this.currentView()!=="month"&&!this._isCustomMonthView())var yi=n(s[0]).offset().top,ii=et.height()+et.scrollTop(),ri=yi-et.offset().top+et.scrollTop(),rt=ri-ht/this.model.timeScale.minorSlotCount<ii?ri:ii-ti;rt=t.isNullOrUndefined(rt)?0:rt;var pi=n(s[0]).outerHeight()/ht,wi=(rt+pi*ht)*this.model.timeScale.majorSlot/(this.model.timeScale.minorSlotCount*(ht+1))/30,bi=ti-parseInt(wi),ki=rt+bi;if(this._topResizing?(di=this._topResizing,rt>0?o=this._resizeNewStartTime:o.setHours(0,0,0),this._topResizing=!1):this._bottomResizing?(gi=this._bottomResizing,rt>=0&&ki<vi?f=this._resizeNewEndTime:f.setHours(23,59,59),this._bottomResizing=!1):this._leftResizing?(this.model.orientation=="vertical"?(e=this.model.group?this._findResourceIndex(this.res1,this._tempResource[this._tempResource.length-1].resourceSettings.id,v[this._appointmentSettings.resourceFields.split(",")[this._tempResource.length-1].trim()]):0,this.currentView()!=="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable?this.model.enableRTL?f=this._leftRightResize(document,s,e,y,d,g):o=this._leftRightResize(document,s,e,y,d,g):(ct=this.model.enableRTL?n(this.element.find(".e-monthcells")[(e+1)*y-1]).offset().left:n(this.element.find(".e-monthcells")[e*y]).offset().left,n(s[0]).offset().left>ct&&(this.model.enableRTL?(b=Math.round((n(s[0]).width()-this.appoint_width)/this.element.find(".e-monthcells").width()),f.setDate(new Date(f).getDate()+b),f.setHours(new Date(g).getHours(),new Date(g).getMinutes())):(this._resize=!0,o=new Date(this._firstweekdate(new Date(a[0][u.startTime]))),this._resize=!1,b=Math.round((n(s[0]).offset().left-n(this.element.find(".e-monthcells")[e*y]).offset().left)/this.element.find(".e-monthcells").width()),o.setDate(o.getDate()+b),o.setHours(new Date(d).getHours(),new Date(d).getMinutes()))))):(pt=n(this.element.find(".e-workcells.e-childworkcell")[0]).offset().left<n(s[0]).offset().left?n(s[0]).offset().left-this._appointleft:n(this.element.find(".e-workcells.e-childworkcell")[0]).offset().left-this._appointleft,this.model.enableRTL&&(ui=n(s[0]).width()-this.appoint_width,pt=-ui),this.currentView()=="month"||this._isCustomMonthView()||!this.model.timeScale.enable?(b=Math.round(pt/(this.element.find(".e-workcells").width()+1)),o.setDate(new Date(o).getDate()+b)):o=this._resizeNewStartTime),this._leftResizing=!1):this._rightResizing&&(this.model.orientation=="vertical"?(e=this.model.group?this._findResourceIndex(this.res1,this._tempResource[this._tempResource.length-1].resourceSettings.id,v[this._appointmentSettings.resourceFields.split(",")[this._tempResource.length-1].trim()]):0,this.currentView()!=="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable?this.model.enableRTL?o=this._leftRightResize(document,s,e,y,d,g):f=this._leftRightResize(document,s,e,y,d,g):(lt=this.element.find(".e-monthcells").width(),ct=this.model.enableRTL?n(this.element.find(".e-monthcells")[e*y]).offset().left+lt:e==this.res1.length-1?n(this.element.find(".e-monthcells")[(e+1)*y-1]).offset().left+lt:n(this.element.find(".e-monthcells")[(e+1)*y]).offset().left,ct>=n(s[0]).offset().left+n(s[0]).width()&&(b=Math.round((n(s[0]).width()-this.appoint_width)/lt),this.model.enableRTL?(o.setDate(new Date(o).getDate()-b),o.setHours(new Date(d).getHours(),new Date(d).getMinutes())):(f.setDate(new Date(f).getDate()+b),f.setHours(new Date(g).getHours(),new Date(g).getMinutes()))))):(wt=this.model.endHour-this.model.startHour==24?n(s[0]).width()-this.appoint_width:n(s[0]).width(),this.currentView()=="month"||this._isCustomMonthView()||!this.model.timeScale.enable?(wt=n(s[0]).width()-this.appoint_width,b=Math.round(wt/(this.element.find(".e-workcells").width()+1)),f.setDate(new Date(f).getDate()+b)):f=this._resizeNewEndTime),this._rightResizing=!1),(o>=f||n(s[0]).width()==0)&&(o=a[0][u.startTime],f=a[0][u.endTime]),o.getTime()==a[0][u.startTime].getTime()&&f.getTime()==a[0][u.endTime].getTime())return this.element.find("#cloneElement").length>0&&(fi=this.element.find(".e-monthappointment").length>1?this.element.find("#cloneElement").outerHeight():this.element.find("#cloneElement").height(),this._curElmt.removeClass("e-draggableAppointment e-scheduleAppGlassy").css({width:this.element.find("#cloneElement").width(),height:fi,top:this.element.find("#cloneElement").css("top"),left:this.element.find("#cloneElement").css("left")}),this._curElmt.find(".e-apptext").replaceWith(this.element.find("#cloneElement").find(".e-apptext")).prop("style",!1),this._curElmt.find(".e-apptime").html(this.element.find("#cloneElement").find(".e-apptime").text()).prop("style",!1),at=Math.ceil((new Date(new Date(f).setHours(23,59,59))-new Date(new Date(o).setHours(0,0,0)))/864e5),bt=this.model.orientation=="vertical"&&this.currentView()=="month"||this._isCustomMonthView()?this.element.find(".e-monthcells").width():this.element.find(".e-workcells").width(),this._curElmt.outerWidth(this.model.cellWidth==""?bt*at:bt*at+at),this.element.find("#cloneElement").remove(),n(s[0]).find(".e-schedulemouseclosetemp").addClass("e-schedulemouseclose e-icon").removeClass("e-schedulemouseclosetemp")),this._trigger("resizeStop",{appointment:a[0],target:i}),!1;this.element.find("#cloneElement").length>0&&this.element.find("#cloneElement").remove();w=!0;this._refreshCellsHeight();var ei=new Date(new Date(this.currentDate()).getFullYear(),new Date(this.currentDate()).getMonth(),1),nr=new Date(new Date(this.model.maxDate).getTime()).setHours(23,59,59),tr=!this.model.showNextPrevMonth&&this.model.orientation=="vertical"&&this.currentView()=="month"?ei.getTime()!=new Date(o.getFullYear(),o.getMonth(),1).getTime()||ei.getTime()!=new Date(f.getFullYear(),f.getMonth(),1).getTime():!1;if(!tr&&f>=new Date(this.model.minDate)&&f<=nr)if(v[u.recurrence]==1&&v[u.recurrenceRule].toString().indexOf("RECUREDITID")==-1){var h={},nt=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],kt=nt[this._appointmentSettings.recurrenceId]==null?nt.ParentId:nt[this._appointmentSettings.recurrenceId],ir=nt[this._appointmentSettings.recurrenceId]==null?"ParentId":this._appointmentSettings.recurrenceId,c=new t.DataManager(this._processed).executeLocal((new t.Query).where(ir,t.FilterOperators.equal,kt));ot&&(c=this._recurrenceAppSort(c));c=this._appointmentRecurrenceSort(c);n.extend(h,a[0]);this.model.enableRecurrenceValidation&&h[u.recurrence]&&(e=this._recuCollectionIndex(c,nt));!this.model.enableRecurrenceValidation||!h[u.recurrence]||(e==0?t.isNullOrUndefined(c[e+1])?!0:new Date(new Date(c[e+1][u.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(f).setHours(0,0,0,0)).getTime():e==c.length-1?new Date(new Date(c[e-1][u.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(o).setHours(0,0,0,0)).getTime():new Date(new Date(c[e-1][u.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(o).setHours(0,0,0,0)).getTime()&&new Date(new Date(c[e+1][u.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(f).setHours(0,0,0,0)).getTime())?(prvStartTime=h[u.startTime],prvEndTime=h[u.endTime],h[u.startTime]=new Date(o),h[u.endTime]=new Date(f),ft=this._checkAvailability(h),this._trigger("resizeStop",{appointment:h,target:i})||ft.length>0?(this._showBlockAlert&&ft.length>0&&this._alertBlockError(),h[u.startTime]=new Date(prvStartTime),h[u.endTime]=new Date(prvEndTime),w=!0):(oi=this.model.enableLoadOnDemand?this._dataCount:this._appMainId+1,kt=h[u.recurrenceId]==null?h.ParentId:h[u.recurrenceId],this._deleteOcurrence(kt,new Date(nt[u.startTime])),h[u.recurrenceRule]=a[0][u.recurrenceRule]+";RECUREDITID="+h.ParentId,h[u.id]=h.AppTaskId=oi,w=!1)):(h[u.startTime]=nt[u.startTime],h[u.endTime]=nt[u.endTime],this._alertDragResizeError(),w=!0);var rr={data:h},k=[],st=[];for(k.push(this._timeZoneAppointments(rr.data,"")),si=h[this._appointmentSettings.recurrenceId]==null?h.ParentId:h[this._appointmentSettings.recurrenceId],hi=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,si)),st.push(this._timeZoneAppointments(hi[0],"")),this.dataSource()instanceof t.DataManager?w||(p=this._dataManager.saveChanges({added:k,changed:st,deleted:[]},this._appointmentSettings.id,this.model.appointmentSettings.query._fromTable)):w||(p=this._dataManager.saveChanges({added:k,changed:st,deleted:[]},"AppTaskId")),dt=[],tt=0;tt<k.length;tt++)dt=this._timeZoneAppointments(k[tt],"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",dt);for(gt=[],tt=0;tt<st.length;tt++)gt=this._timeZoneAppointments(st[tt],"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",gt);it=this;!t.isNullOrUndefined(p)&&n.isFunction(p.promise)&&this.dataSource()instanceof t.DataManager?(p.done(function(n){it._processUrlBinding(n);it._trigger("actionComplete",{data:h,requestType:"appointmentResize"})}),p.fail(function(){it._renderAppointmentAll()})):(w||this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll(),this._trigger("actionComplete",{data:h,requestType:"appointmentResize"}))}else ot?(l={},ut=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,v.Guid))):(l={},ut=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,v.Guid))),c=new t.DataManager(this._processed).executeLocal((new t.Query).where("ParentId",t.FilterOperators.equal,ut[0].ParentId)),ot&&(c=this._recurrenceAppSort(c)),c=this._appointmentRecurrenceSort(c),n.extend(l,ut),this.model.enableRecurrenceValidation&&l[0][u.recurrence]&&(e=this._recuCollectionIndex(c,ut[0])),!this.model.enableRecurrenceValidation||!l[0][u.recurrence]||(e==0?t.isNullOrUndefined(c[e+1])?!0:new Date(new Date(c[e+1][u.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(f).setHours(0,0,0,0)).getTime():e==c.length-1?new Date(new Date(c[e-1][u.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(o).setHours(0,0,0,0)).getTime():new Date(new Date(c[e-1][u.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(o).setHours(0,0,0,0)).getTime()&&new Date(new Date(c[e+1][u.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(f).setHours(0,0,0,0)).getTime())?(prevStartTime=l[0][u.startTime],prevEndTime=l[0][u.endTime],l[0][u.startTime]=o,l[0][u.endTime]=f,ft=this._checkAvailability(l[0]),this._trigger("resizeStop",{appointment:l[0],target:i})||ft.length>0?(this._showBlockAlert&&ft.length>0&&this._alertBlockError(),l[0][u.startTime]=prevStartTime,l[0][u.endTime]=prevEndTime,w=!0):w=!1):(l[0][u.startTime]=ut[0][u.startTime],l[0][u.endTime]=ut[0][u.endTime],this._alertDragResizeError(),w=!0),k=this._timeZoneAppointments(l[0],""),this.dataSource()instanceof t.DataManager?w||(p=this._dataManager.update(this._appointmentSettings.id,k,this.model.appointmentSettings.query._fromTable)):w||(p=this._dataManager.update("AppTaskId",k)),ci=this._timeZoneAppointments(k,"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",ci),it=this,!t.isNullOrUndefined(p)&&p&&n.isFunction(p.promise)&&this.dataSource()instanceof t.DataManager?(p.done(function(n){it._processUrlBinding(n);it._trigger("actionComplete",{data:l,requestType:"appointmentResize"})}),p.fail(function(){it._renderAppointmentAll()})):(ot?(li=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,l[0].Guid)),new t.DataManager(this._processed).saveChanges({added:[],changed:[],deleted:li},"Guid"),this._appointmentProcessing(l[0])):new t.DataManager(this._processed).update("Guid",l[0]),this._renderAppointmentAll(),this._trigger("actionComplete",{data:l,requestType:"appointmentResize"}),this._appMainId=this._sortAppById(this._processed)[this._processed.length-1].AppTaskId);else this._renderAppointmentAll()}this.element.find("div.e-tophandle,div.e-bottomhandle").removeClass("e-rowcursor");this.element.find("div.e-lefthandle,div.e-righthandle").removeClass("e-columncursor")}catch(i){}},_dragdropAppointments:function(){var r,i,u;if(this.model.readOnly)return!1;this._topResizing=!1;this._bottomResizing=!1;this._leftResizing=!1;this._rightResizing=!1;this.model.allowDragAndDrop&&(i=this,u=this.element.find(".e-appointment"),u.ejDraggable({handle:".e-appointment",dragArea:i.model.appointmentDragArea==""?i.element.find("div.e-draggableworkarea",".e-headrealldaytable tr"[!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this._grouping.length+1:1]):n(i.model.appointmentDragArea),cursorAt:i.model.appointmentDragArea==""?{top:0,left:0}:{top:-40,left:-40},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){return r=n(t.sender.target).hasClass("e-appointment")?n(t.sender.target):n(t.sender.target).parents(".e-appointment"),i._appointElement(r,i)}}),u=this.element.find(".e-alldayappointment"),u.ejDraggable({handle:".e-alldayappointment",dragArea:i.model.appointmentDragArea==""?i.element:n(i.model.appointmentDragArea),cursorAt:{top:17,left:0},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){return r=n(t.sender.target).hasClass("e-alldayappointment")?n(t.sender.target):n(t.sender.target).parents(".e-alldayappointment"),i._appointElement(r,i)}}),u=this.element.find(".e-monthappointment"),u.ejDraggable({handle:".e-monthappointment",dragArea:i.model.appointmentDragArea==""?i.element.find("div.e-draggableworkarea"):n(i.model.appointmentDragArea),cursorAt:i.model.appointmentDragArea==""?{top:0,left:0}:{top:-20,left:10},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){return r=n(t.sender.target).hasClass("e-monthappointment")?n(t.sender.target):n(t.sender.target).parents(".e-monthappointment"),i._appointElement(r,i)}}))},_appointElement:function(t,i){var r=i.model.orientation=="vertical"&&t.hasClass("e-appointment")&&this.currentView()!="day"?t.closest("td").width()*.85:t.width();return t.find(".e-schedulemouseclose").removeClass("e-schedulemouseclose e-icon"),t.find(".e-tophandle").removeClass("e-tophandle e-appointresizer-top e-icon e-nsexpand"),t.find(".e-bottomhandle").removeClass("e-bottomhandle e-appointresizer-bottom e-icon e-nsexpand"),t.find(".e-lefthandle").removeClass("e-lefthandle e-appointresizer-left e-icon e-ewexpand"),t.find(".e-righthandle").removeClass("e-righthandle e-appointresizer-right e-icon e-ewexpand"),t.clone().prop("id","cloneElement").appendTo(t.parent()),t.css("cursor","move"),i.model.appointmentDragArea==""?t.addClass("e-draggableAppointment e-scheduleAppGlassy").removeClass("e-schedulemouseclose e-tophandle e-bottomhandle").css("width",r+"px").appendTo(i.element):t.addClass("e-draggableAppointment e-scheduleAppGlassy").removeClass("e-schedulemouseclose e-tophandle e-bottomhandle").css("width",r+"px").appendTo(n(document.body))},_dragStart:function(i){var s,f,e,u,r,o;if(n(i.element[0]).hasClass("e-appointment")||n(i.element[0]).hasClass("e-monthappointment")||n(i.element[0]).hasClass("e-alldayappointment")){if((s=i.element,f=this._appointmentSettings,this._appUid=n(i.element[0]).attr("guid"),u=this._sortAppById(new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))),u.length>1?(r=n.extend(!0,[],u),r[0][f.endTime]=r[r.length-1][f.endTime],e=r[0]):e=u[0],o={target:s,appointment:e},this._trigger("actionBegin",{data:o,requestType:"appointmentDrag"}))||this._trigger("dragStart",o))return i.cancel=!0,this._renderAppointmentAll(),!1}else i.cancel=!0;this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close")},_dragOver:function(i){var h=n(i.element),c={target:h},o,s,u,f;if(t.isNullOrUndefined(this.element.data("ejTooltip"))||this.element.ejTooltip("hide"),this.element.find(".e-workcells").removeClass("e-selectedCell").removeClass("e-mousehover"),this.currentView()!="month"&&!this._isCustomMonthView()&&(n(i.element[0]).hasClass("e-appointment")||i.target.className.indexOf("e-workcells")>-1)&&this._dragAppointmentCurrentTime(i),this._trigger("drag",c),this.model.orientation=="horizontal"&&this._tempResource.length!=0&&this._grouping.length!=0){if(i.element.css("pointer-events","none"),this.model.group.resources.length>1){var l=document.elementFromPoint(i.element.offset().left,i.element.offset().top),e=n(l).closest(".e-workcells").parent().index(),r=n(this.element.find(".e-resourceheadertable tr")[e]).children();if(r.hasClass("e-parentnode")&&n(r.children()[0]).hasClass("e-resourceexpand")){for(n(r.children()[0]).removeClass("e-resourceexpand").addClass("e-resourcecollapse"),o=n(r.children()[0]).attr("id").split("_")[0],s=new t.DataManager(this.res1).executeLocal((new t.Query).where(this._tempResource[this._tempResource.length-1].resourceSettings.groupId,t.FilterOperators.equal,o)),u=0;u<s.length;u++)f=e+u+1,n(this.element.find(".e-resourceheadertable tr")[f]).is(":hidden")&&(n(this.element.find(".e-resourceheadertable tr")[f]).toggle(),n(this.element.find(".e-workcellstab tr")[f]).toggle());this.element.find(".e-horires").height(this.element.find(".e-draggableworkarea").height());this._horizontalRender();this.model.cellHeight!="20px"&&this._reRenderScroller();this._horizontalResIcon()}}i.element.css("pointer-events","")}},_dragStop:function(i){var u,nt,st,ht,ri,e,w,c,d,ft,ct,lt,bt,ui,fi,ei,oi,kt,ut,si,gt,hi,et,ni,o,p,tt,at,ci,li,k,ai,v,wi,vt,h,ti,yt,vi,it,dt,s,l,a,ot,f,g,b,ii,yi,pi;this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close");var rt=this,r=this._appointmentSettings,y=this.element.find(".e-draggableworkarea");if(this._appUid=i.element.attr("guid"),u=this._sortAppById(new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))),u.length>1&&!u[0][r.recurrence]?(nt=!0,f=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0]):(nt=u.length>1?!0:!1,st=n.extend(!0,[],u),st[0][r.endTime]=st[st.length-1][r.endTime],f=u[0][r.recurrence]&&u[0][r.recurrenceRule].toString().indexOf("RECUREDITID")==-1?this._getAppointmentByParentId(this._appUid):u[0][r.recurrence]?u.length>1?st[0]:u[0]:this._getAppointmentByParentId(this._appUid)),(t.isNullOrUndefined(this._dragNewStartTime)||t.isNullOrUndefined(this._dragNewEndTime))&&u.length!=0&&(this._dragNewStartTime=new Date(u[0][this._appointmentSettings.startTime]),this._dragNewEndTime=new Date(u[u.length-1][this._appointmentSettings.endTime])),ht=n.extend(!0,{},f),ri=Math.ceil((ht[r.endTime]-ht[r.startTime])/36e5)<24&&ht[r.endTime].getDay()!=ht[r.startTime].getDay()?!0:!1,this.model.orientation=="vertical")if(n(i.element[0]).hasClass("e-appointment"))e=c=this._dragNewStartTime,w=d=this._dragNewEndTime,(i.target.className.indexOf("e-alldaycells")>-1||Math.ceil((this._dragNewEndTime.getTime()-this._dragNewStartTime.getTime())/36e5)>=24)&&(ft=!0,c=new Date(c.setHours(0,0,0,0)),d=new Date(d.setHours(23,59,59,59))),o=Math.round((n(i.element[0]).offset().left+y.scrollLeft()-y.offset().left)/this.element.find(".e-workcells").width());else if(n(i.element[0]).hasClass("e-alldayappointment"))if(i.target.className.indexOf("e-workcells")>-1)o=i.target.cellIndex,c=this._dragNewStartTime,d=this._dragNewEndTime,ft=!1;else{e=f[r.startTime];w=f[r.endTime];u[0][r.recurrence]&&u[0][r.recurrenceRule].toString().indexOf("RECUREDITID")==-1&&(e=u[0][r.startTime],w=u[0][r.endTime]);ct=n(i.element[0]).offset().left+y.scrollLeft()-this.element.find(".e-alldaycells").offset().left-1;ct=this.model.enableRTL?Math.abs(ct):ct;var o=Math.round(ct/(this.element.find(".e-alldaycells").width()+1)),nr=Math.round(n(i.element[0]).width()/(this.element.find(".e-alldaycells").width()+1)),tr=Math.ceil((w-e)/864e5),ir=Math.round(n(i.element[0]).width()/(this.element.find(".e-alldaycells").width()+1)),wt=this.currentView()==="week"?7:this.currentView()==="workweek"?this.model.workWeek.length:this.currentView()=="customview"?this._renderDays:1;e=new Date(this._dateRender[o]);w=new Date(this._dateRender[o]);w.setHours(f[r.endTime].getHours(),f[r.endTime].getMinutes(),f[r.endTime].getSeconds());o<0?e<=new Date(this._dateRender[0])?(c=new Date(e),c.setDate(c.getDate()+o),c.setHours(new Date(f[r.startTime]).getHours(),new Date(f[r.startTime]).getMinutes()),c=new Date(c)):(lt=new Date(this._dateRender[0]),lt.setDate(lt.getDate()+o),lt.setHours(new Date(f[r.startTime]).getHours(),new Date(f[r.startTime]).getMinutes()),c=new Date(lt)):e<new Date(this._dateRender[0])?(bt=o>wt-1?o%wt:o,this._resWorkWeek?e=new Date(new Date(this._dateRender[o])):e.setDate(new Date(f[rt._appointmentSettings.startTime]).getDate()+bt),e.setHours(new Date(f[r.startTime]).getHours(),new Date(f[r.startTime]).getMinutes()),c=new Date(e)):(bt=o>wt-1?o%wt:o,c=new Date(new Date(this._dateRender[bt])),c.setHours(new Date(f[r.startTime]).getHours(),new Date(f[r.startTime]).getMinutes()));ui=new Date(c);fi=new Date(f[r.endTime]).getTime()-new Date(f[r.startTime]).getTime();d=new Date(new Date(ui).setMilliseconds(fi))}else n(i.element[0]).hasClass("e-monthappointment")&&(p=f[r.startTime],tt=f[r.endTime],u[0][r.recurrence]&&u[0][r.recurrenceRule].toString().indexOf("RECUREDITID")==-1&&(p=u[0][r.startTime],tt=u[u.length-1][r.endTime]),e=new Date(new Date(this.model.currentDate).getFullYear(),new Date(this.model.currentDate).getMonth(),1),ei=e.getDay(),e.setDate(e.getDate()-ei),this.currentView()!="month"&&(this.currentView()!="customview"||this._oneWeek)?(oi=t.isNullOrUndefined(this.model.group)?this._dateRender.length:this._dateRender.length*this.res1.length,o=parseInt((n(i.element[0]).offset().left-y.offset().left)/Math.round(y.width()/oi))):(o=parseInt((n(i.element[0]).offset().left+y.scrollLeft()-y.offset().left)/this.element.find(".e-monthcells").width()),o=this.model.enableRTL?6-o:o),ri&&parseInt(i.element.attr("id").split("_")[1])==u[u.length-1].AppTaskId&&(o-=1),kt=parseInt((n(i.element[0]).offset().top+y.scrollTop()-y.offset().top)/this.element.find(".e-monthcells").outerHeight()),this.model.showOverflowButton||(kt=this._findRowIndex(i)),ut=this.currentView()=="month"||this._isCustomMonthView()&&!this._oneWeek?7:this._dateRender.length,a=this.model.enableRTL?kt*ut+(o-Math.floor(o/ut)*ut)-(tt.getDay()-p.getDay()):kt*ut+(o-Math.floor(o/ut)*ut),e=new Date(new Date(this._dateRender[a]).setHours(p.getHours(),p.getMinutes(),p.getSeconds())),Math.ceil((f[r.endTime]-f[r.startTime])/36e5)>24?(si=new t.DataManager(this._processed).executeLocal((new t.Query).where("AppTaskId",t.FilterOperators.equal,parseInt(i.element.attr("id").split("_")[1]))),gt=new Date(si[0][r.startTime])-new Date(u[0][r.startTime]),c=new Date(e-gt),at=e.getTime()-new Date(p).getTime()-new Date(gt).getTime()):(c=new Date(e),at=e.getTime()-new Date(p).getTime()),w=new Date(new Date(tt).getTime()+at),d=new Date(w));else if(this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal){var c=this._dragNewStartTime,d=this._dragNewEndTime,e=this._dragNewStartTime,w=this._dragNewEndTime;hi=this.model.enableRTL?document.elementFromPoint(n(i.element[0]).offset().left,n(i.element[0]).offset().top-1).cellIndex-Math.round(n(i.element[0]).width()/30-1):Math.round((n(i.element[0]).offset().left+y.scrollLeft()-y.offset().left)/this.element.find(".e-workcells").width());et=parseInt((n(i.element[0]).offset().top+y.scrollTop()-y.offset().top)/this.element.find(".e-workcells").outerHeight());this.model.showOverflowButton||(et=this._findRowIndex(i));this.element.find(".e-resourceheadertable .e-resourceexpand").length>0&&(et+=n(this.element.find(".e-resourceheadertable").find("tr").filter(function(){return n(this).css("display")!=="none"})[et]).prevUntil("table.e-resourceheadertable").filter(function(){return n(this).css("display")=="none"}).length);ni=n(this.element.find(".e-workcellstab tr")[et]).find("td")[hi];n(ni).hasClass("e-resourceheadercells")||t.isNullOrUndefined(ni)||(this._cellIndex=this.model.enableRTL?this.element.find(".e-workcells").length-Math.round(n(i.element[0]).offset().left/this.element.find(".e-workcells").width()):Math.round((n(i.element[0]).offset().left+y.scrollLeft()-y.offset().left)/this.element.find(".e-workcells").width()),o=et,n(i.element[0]).hasClass("e-monthappointment")&&(p=new Date(f[r.startTime]),tt=new Date(f[r.endTime]),u[0][r.recurrence]&&u[0][r.recurrenceRule].toString().indexOf("RECUREDITID")==-1?(p=u[0][r.startTime],tt=u[0][r.endTime]):u[0][r.recurrence]&&u[0][r.recurrenceRule].toString().indexOf("RECUREDITID")>0&&(f=u[0],p=u[0][r.startTime],tt=u[0][r.endTime]),e=new Date(this.monthDays[this._cellIndex]),e.setHours(p.getHours(),p.getMinutes(),p.getSeconds()),c=new Date(e),at=e.getTime()-new Date(p).getTime(),w=new Date(new Date(tt).getTime()+at),d=new Date(w)))}if(ci=new Date(new Date(this.model.maxDate).getTime()).setHours(23,59,59),li=!this.model.showNextPrevMonth&&this.model.orientation=="vertical"&&this.currentView()=="month"?new Date(new Date(this.currentDate()).getFullYear(),new Date(this.currentDate()).getMonth(),1).getTime()!=new Date(c.getFullYear(),c.getMonth(),1).getTime():!1,!li&&d>=new Date(this.model.minDate)&&d<=ci)if(this._refreshCellsHeight(),k=!0,f[r.recurrence]==1&&f[r.recurrenceRule].indexOf("RECUREDITID")==-1){ai=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid);v=this._sortAppById(new t.DataManager(this._processed).executeLocal(ai));nt&&(wi=n.extend(!0,[],v));v.length>1&&(vt=n.extend(!0,[],v),vt[0][r.endTime]=vt[vt.length-1][r.endTime]);v=v.length>1?vt[0]:v[0];var yt=v[r.recurrenceId]==null?v.ParentId:v[r.recurrenceId],bi=v[r.recurrenceId]==null?"ParentId":r.recurrenceId,l=new t.DataManager(this._processed).executeLocal((new t.Query).where(bi,t.FilterOperators.equal,yt));nt&&(l=this._recurrenceAppSort(l));l=this._appointmentRecurrenceSort(l);h={};n.extend(h,u[0]);this.model.enableRecurrenceValidation&&h[r.recurrence]&&(a=this._recuCollectionIndex(l,v));!this.model.enableRecurrenceValidation||!h[r.recurrence]||(a==0?t.isNullOrUndefined(l[a+1])?!0:new Date(new Date(l[a+1][r.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(w).setHours(0,0,0,0)).getTime():a==l.length-1?new Date(new Date(l[a-1][r.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(e).setHours(0,0,0,0)).getTime():new Date(new Date(l[a-1][r.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(e).setHours(0,0,0,0)).getTime()&&new Date(new Date(l[a+1][r.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(w).setHours(0,0,0,0)).getTime())?(dt=n.extend(!0,[],v),h[r.startTime]=c,h[r.endTime]=d,!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources&&(h=this._getDragDropResourceData(this,o,h)),t.isNullOrUndefined(ft)||(h[r.allDay]=ft),ot=this._checkAvailability(h),this._trigger("dragStop",{appointment:h,event:i})||ot.length>0?(this._showBlockAlert&&ot.length>0&&this._alertBlockError(),h=n.extend(!0,[],dt),k=!0):(k=!1,this._processed=this._sortAppById(this._processed),ti=this.model.enableLoadOnDemand?this._dataCount:this._appMainId+1,this._appMainId=ti,yt=f[r.recurrenceId]==null?f.ParentId:f[r.recurrenceId],this._deleteOcurrence(yt,v[r.startTime]),h[r.recurrenceRule]=f[r.recurrenceRule]+";RECUREDITID="+h.ParentId,h[r.recurrenceExDate]=f[r.recurrenceExDate],h[r.id]=h.AppTaskId=ti)):(h[r.startTime]=v[r.startTime],h[r.endTime]=v[r.endTime],this._alertDragResizeError(),k=!0);var ki={data:h},g=[],pt=[];for(g.push(this._timeZoneAppointments(ki.data,"")),yt=h[r.recurrenceId]==null?f.ParentId:h[r.recurrenceId],vi=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,yt)),pt.push(this._timeZoneAppointments(vi[0],"")),this.dataSource()instanceof t.DataManager?k||(b=this._dataManager.saveChanges({added:g,changed:pt,deleted:[]},r.id,this.model.appointmentSettings.query._fromTable)):k||(b=this._dataManager.saveChanges({added:g,changed:pt,deleted:[]},"AppTaskId")),it=0;it<g.length;it++)new t.DataManager(this._currentAppointmentData).update("AppTaskId",this._timeZoneAppointments(g[it],"reverse"));for(it=0;it<pt.length;it++)new t.DataManager(this._currentAppointmentData).update("AppTaskId",this._timeZoneAppointments(pt[it],"reverse"));!t.isNullOrUndefined(b)&&n.isFunction(b.promise)&&this.dataSource()instanceof t.DataManager?(b.done(function(n){rt._processUrlBinding(n);rt._trigger("actionComplete",{appointment:h,requestType:"appointmentDrag"})}),b.fail(function(){rt._renderAppointmentAll()})):(k||this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll(),this._trigger("actionComplete",{appointment:h,requestType:"appointmentDrag"}))}else{dt={};s=nt?new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,u[0].Guid)):new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,u[0].Guid));var dt=n.extend(!0,[],s[0]),di=s[0][r.startTime],gi=s[0][r.endTime],l=new t.DataManager(this._processed).executeLocal((new t.Query).where("ParentId",t.FilterOperators.equal,s[0].ParentId));if(nt&&(l=this._recurrenceAppSort(l)),l=this._appointmentRecurrenceSort(l),s[0][r.startTime]=c,s[0][r.endTime]=d,this.model.enableRecurrenceValidation&&(a=this._recuCollectionIndex(l,s[0])),!this.model.enableRecurrenceValidation||!s[0][r.recurrence]||(a==0?t.isNullOrUndefined(l[a+1])?!0:new Date(new Date(l[a+1][r.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(w).setHours(0,0,0,0)).getTime():a==l.length-1?new Date(new Date(l[a-1][r.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(e).setHours(0,0,0,0)).getTime():new Date(new Date(l[a-1][r.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(e).setHours(0,0,0,0)).getTime()&&new Date(new Date(l[a+1][r.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(w).setHours(0,0,0,0)).getTime())?(!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0&&this._tempResource[0].resourceSettings.dataSource.length!=0&&t.scheduleFeatures.resources&&(s[0]=this._getDragDropResourceData(this,o,s[0])),t.isNullOrUndefined(ft)||(s[0][r.allDay]=ft),ot=this._checkAvailability(s[0]),this._trigger("dragStop",{appointment:s[0],event:i})||ot.length>0?(this._showBlockAlert&&ot.length>0&&this._alertBlockError(),s[0]=n.extend(!0,[],dt),k=!0):k=!1):(s[0][r.startTime]=di,s[0][r.endTime]=gi,this._alertDragResizeError(),k=!0),this.model.appointmentDragArea!=""&&(f=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),f.length==0))return!1;g=this._timeZoneAppointments(s[0],"");this.dataSource()instanceof t.DataManager?k||(b=this._dataManager.update(r.id,g,this.model.appointmentSettings.query._fromTable)):k||(b=this._dataManager.update("AppTaskId",g));ii=this._timeZoneAppointments(g,"reverse");nt?new t.DataManager(this._currentAppointmentData).update("Guid",ii):new t.DataManager(this._currentAppointmentData).update("AppTaskId",ii);!t.isNullOrUndefined(b)&&b&&n.isFunction(b.promise)&&this.dataSource()instanceof t.DataManager?(b.done(function(n){rt._processUrlBinding(n);rt._trigger("actionComplete",{appointment:s[0],requestType:"appointmentDrag"})}),b.fail(function(){rt._renderAppointmentAll()})):(yi=new Date(new Date(s[0][r.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(s[0][r.endTime]).setHours(0,0,0,0)).getTime(),yi||nt?(pi=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,s[0].Guid)),new t.DataManager(this._processed).saveChanges({added:[],changed:[],deleted:pi},"Guid"),this._appointmentProcessing(s[0])):new t.DataManager(this._processed).update("AppTaskId",s[0]),this._renderAppointmentAll(),this._trigger("actionComplete",{appointment:s[0],requestType:"appointmentDrag"}),this._appMainId=this._sortAppById(this._processed)[this._processed.length-1].AppTaskId)}else this._renderAppointmentAll(),this._trigger("dragStop",{appointment:u[0],event:i});n(document.body).find(".e-scheduleAppGlassy").length>0&&n(document.body).find(".e-scheduleAppGlassy").remove();this.element.find("#cloneElement").length>0&&this.element.find("#cloneElement").remove()},_findRowIndex:function(t){var i=n(document.elementsFromPoint(n(t.element[0]).offset().left,n(t.element[0]).offset().top-1)),r=this.model.orientation=="horizontal"?n.grep(i,function(t){if(n(t).hasClass("e-workcells"))return t}):n.grep(i,function(t){if(n(t).hasClass("e-monthcells"))return t});return rowIndex=n(r).parent().index()},_alertDragResizeError:function(){n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert"));this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("DragResizeError"));this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok"));this._alertWindow.ejDialog("open")},_processUrlBinding:function(i){if(this.model.enableLoadOnDemand||this.dataSource()instanceof t.DataManager&&this.dataSource().adaptor instanceof t.ODataAdaptor)this._initDataSource("refresh");else{var r=t.isNullOrUndefined(i.record)?i:i.record;this._currentAppointmentData.length=0;this._dateFormat(r);this._bindAppointments=!0;this._currentAppointmentData=n.merge(this._currentAppointmentData,r);this._dataProcessing(r);this._renderAppointmentAll()}},_refreshCellsHeight:function(){if(this.currentView()=="agenda")return!1;this.model.orientation!="horizontal"||this.model.showOverflowButton||(this._horizontalRender(),this._reRenderScroller());this.model.orientation!="vertical"||this.model.showOverflowButton||this.currentView()!="month"||(this._monthCellsRender(),this._reRenderScroller())},_dragAppointmentCurrentTime:function(i){var w=this._sortAppById(new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,i.element.attr("guid")))),e=this.element.find(".e-draggableworkarea"),ft=parseInt(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount),u=this,c=u._appointmentSettings,b,f,y,st,g,ht,ct,vt,h,a,it,l,v,p,nt,rt,r,s,yt,wt,ut,bt,kt,tt,dt;if(w[0][c.recurrence]?(b=n.extend(!0,[],w),b[0][c.endTime]=b[b.length-1][c.endTime],f=w[0][c.recurrence]&&w[0][c.recurrenceRule].toString().indexOf("RECUREDITID")==1?this._getAppointmentByParentId(this._appUid):w[0][c.recurrence]?b[0]:this._getAppointmentByParentId(this._appUid)):f=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],this.model.orientation=="vertical"&&(n(i.element[0]).hasClass("e-appointment")||i.target.className.indexOf("e-workcells")>-1)){var et=e.height()+e.scrollTop(),gt=i.element[0].offsetHeight,k=this.element.find(".e-workcells").height(),ot=n(i.element[0]).offset().top-e.offset().top+e.scrollTop(),d=ot-k/(60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))<et?ot:et-gt,r,o,l,v;if(n(i.element[0]).hasClass("e-alldayappointment"))a=i.target.cellIndex,r=new Date(this.dateRender[a]),y=d>0?d*60/(60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*(k+1)):60/(60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*(k+1)),r.setHours(parseInt(this.model.startHour)+Math.round(y/60)),r.setMinutes(parseInt(y%60)),r=new Date(r).getMinutes()>=30?new Date(new Date(r).setHours(new Date(r).getHours()-1)):new Date(r),r.setMinutes(Math.round(r.getMinutes()/10)*10),l=new Date(r),o=new Date(r).setMinutes(r.getMinutes()+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount),v=new Date(o);else if((d>0||!this.model.showAllDayRow)&&i.target.className.indexOf("e-alldaycells")!=1){if(y=d>0?d*60/(60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*(k+1)):60/(60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*(k+1)),st=new Date(new Date(f[u._appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(f[u._appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()?!0:!1,u.currentView()==="month"||u._isCustomMonthView()?(r=f[c.startTime],o=new Date(r)):(g=new Date(u._firstweekdate(u.currentDate())),(u.currentView()==="workweek"||u.currentView()=="customview"&&u._renderDays==5)&&(ht=new Date(g).getDay(),ct=ht==0?1:0,g.setDate(g.getDate()+ct)),r=g,h=u.currentView()==="week"?7:u.currentView()==="workweek"?this.model.workWeek.length:u.currentView()=="customview"?u._renderDays:1,h=t.isNullOrUndefined(u.model.group)?h:h*u.res1.length,a=Math.round((n(i.element[0]).offset().left+e.scrollLeft()-e.offset().left)/this.element.find(".e-workcells").width()),r=this.model.enableRTL?new Date(this.dateRender[h-a-1]):new Date(this.dateRender[a]),o=r),st)r=this._getNewStartTime(y,r),l=new Date(r);else{var lt=(y%60).toFixed(1),at=lt.toString().split("."),ni=t.isNullOrUndefined(at[1])?0:at[1]/1;r.setHours(parseInt(this.model.startHour)+Math.round(y/60),parseInt(lt.toString().split(".")[0]),ni,0);r=new Date(r).getMinutes()>=30?new Date(new Date(r).setHours(new Date(r).getHours()-1)):new Date(r);ft>=10?r.setMinutes(Math.round(r.getMinutes()/10)*10):r.setMinutes(r.getMinutes()*1);l=new Date(r)}vt=new Date(f[c.endTime]).getTime()-new Date(f[c.startTime]).getTime();v=new Date(new Date(r).setMilliseconds(vt))}else h=this.currentView()==="week"?7:this.currentView()==="workweek"?this.model.workWeek.length:this.currentView()=="customview"?this._renderDays:1,h=t.isNullOrUndefined(this.model.group)?h:h*this.res1.length,a=Math.round((n(i.element[0]).offset().left+e.scrollLeft()-e.offset().left)/this.element.find(".e-workcells").width()),r=this.model.enableRTL?new Date(this.dateRender[h-a-1]):new Date(this.dateRender[a]),l=new Date(r.setHours(0,0,0)),v=new Date(r.setHours(23,59,59))}else if(this.model.orientation=="horizontal"&&n(i.element[0]).hasClass("e-appointment")&&(l=new Date(f[u._appointmentSettings.startTime]),v=new Date(f[u._appointmentSettings.endTime]),p=this.model.enableRTL?document.elementFromPoint(n(i.element[0]).offset().left,n(i.element[0]).offset().top-1).cellIndex-Math.round(n(i.element[0]).width()/30-1):Math.round((n(i.element[0]).offset().left+e.scrollLeft()-e.offset().left)/this.element.find(".e-workcells").width()),nt=parseInt((n(i.element[0]).offset().top+e.scrollTop()-e.offset().top)/this.element.find(".e-workcells").outerHeight()),this.model.showOverflowButton||(nt=this._findRowIndex(i)),this.element.find(".e-resourceheadertable .e-resourceexpand").length>0&&(nt+=n(this.element.find(".e-resourceheadertable").find("tr").filter(function(){return n(this).css("display")!=="none"})[nt]).prevUntil("table.e-resourceheadertable").filter(function(){return n(this).css("display")=="none"}).length),rt=n(this.element.find(".e-workcellstab tr")[nt]).find("td")[p],!n(rt).hasClass("e-resourceheadercells")&&!t.isNullOrUndefined(rt))){r=new Date(this._dateRender[0]);it=this.model.enableRTL?p*30:(n(i.element[0]).offset().left+e.scrollLeft()-e.offset().left)*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)/n(this.element.find(".e-workcells")[1]).outerWidth();s=this.model.startHour+p*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)/60;yt=parseInt(p/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)));s=s>=this.model.endHour?Math.round(it/60)+yt*(24-this.model.endHour+this.model.startHour):Math.round(it/60);r.setHours(parseInt(u.model.startHour)+s);r.setMinutes(parseInt(it%60));r=new Date(r).getMinutes()>=30?new Date(new Date(r).setHours(new Date(r).getHours()-1)):new Date(r);ft>=10?r.setMinutes(Math.round(r.getMinutes()/10)*10):r.setMinutes(r.getMinutes()*1);l=new Date(r);var ti=f[u._appointmentSettings.startTime],ii=f[u._appointmentSettings.endTime],pt=(ii-ti)/1e3,ut=Math.floor(pt/3600),ri=parseInt(i.element.width()/this.element.find(".e-workcells").width())/this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot);this.currentView()=="workweek"&&this.model.workWeek!=5&&new Date(f.StartTime).getDay()!=new Date(f.EndTime).getDay()&&(wt=new Date(f.EndTime).getDay()-new Date(f.StartTime).getDay(),ut=ut-(wt-1)*(this.model.endHour-this.model.startHour));bt=Math.floor(pt%3600/60);o=u._getNewEndTime(r,ri,bt);new Date(f.StartTime).getDay()==new Date(f.EndTime).getDay()&&this.currentView()=="workweek"&&this.model.workWeek.length!=5&&(totalhrs=r.getHours()+ut,totalhrs>24&&(kt=n.inArray(new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime(),this._dateRender)+1,o.setDate(new Date(this._dateRender[kt]).getDate())));tt=parseInt(p)+parseInt(n(i.element[0]).width()/this.element.find(".e-workcells").width())-1;tt=parseInt(tt/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)));dt=new Date(o).getHours()>=this.model.endHour?parseInt(parseInt((new Date(o)-new Date(new Date(new Date(r).setHours(0,0,0,0)).setHours(this.model.endHour)))/36e5)/(this.model.endHour-this.model.startHour))+1:0;s=new Date(o).getHours()>=this.model.endHour?new Date(new Date(o).setHours(new Date(o).getHours()+dt*(24-this.model.endHour+this.model.startHour))):o;this.model.endHour-this.model.startHour!=24&&new Date(new Date(s).setHours(0,0,0,0)).getTime()!=new Date(this._dateRender[tt]).getTime()&&(s=new Date(this._dateRender[tt]).setHours(new Date(s).getHours(),new Date(s).getMinutes(),new Date(s).getSeconds(),new Date(s).getMilliseconds()));v=new Date(s);this._cellIndex=this.model.enableRTL?this.element.find(".e-workcells").length-Math.round(n(i.element[0]).offset().left/this.element.find(".e-workcells").width()):Math.round((n(i.element[0]).offset().left+e.scrollLeft()-e.offset().left)/this.element.find(".e-workcells").width())}i.element.find(".e-apptime").html(t.format(l,this._timeMode=="12"?this._pattern.t:"HH:mm")+" - "+t.format(v,this._timeMode=="12"?this._pattern.t:"HH:mm")).insertBefore(i.element.find(".e-apptext")).css("font-size","12px").css("white-space","normal");this._dragNewStartTime=l;this._dragNewEndTime=v},_unWireDragDrop:function(){var n=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment");n.ejDraggable("destroy")},_getAppointmentByParentId:function(i){var f=this._currentAppointmentData,u=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,i)),r=new t.DataManager(f).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,u[0].ParentId));return n.isEmptyObject(r)?r:r[0]},_renderAppointmentAll:function(){var i,r;if(this.element.children().length==0)return!1;this.currentView()=="agenda"?this._renderAgendaContent():(t.preferredCulture(this.model.locale),this.element.find("div.e-appointwrapper,.e-alldayappointment").remove(),!t.isNullOrUndefined(this.model.group)&&this._grouping.length>1&&this.model.orientation=="horizontal"&&(this.resHeaderHeight=this.element.find(".e-resourceheadercells").height()),this.currentView()!="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable?(this._renderAppointments(),this.model.showAppointmentNavigator&&(this.model.orientation=="vertical"&&this.element.find(".e-vscroll").length>0&&!this._mediaQuery&&this._renderUpDownIconPosition(),this._nextPrevButton(this._filtered))):this._renderMonthAppointment(),this._wireResizeEvents(),this._dragdropAppointments(),this.model.showOverflowButton||this.model.orientation!="horizontal"||(i=this.element.find(".e-draggableworkarea").offset().top-this.element.find(".e-workcellstab").offset().top,this.element.find(".e-horires").css("top",-i+"px")));r=n.map(this._processed,function(n){n.Index!=null&&delete n.Index});this.model.timeScale.enable&&this.model.orientation=="vertical"&&this.element.find(".e-alldayappointment").length==0&&this._reRenderScroller()},_renderBlockAppointments:function(){var i,u,f,s,e,o,r;if(this.element.find(".e-blocktimewrapper").remove(),this.model.blockoutSettings.enable&&(t.isNullOrUndefined(this.model.blockoutSettings)||!(this.model.blockoutSettings.dataSource instanceof t.DataManager))&&this.currentView()!="agenda")for(this._processBlockApps(),i=this.model.orientation=="horizontal"&&this.currentView()=="month"?n.extend(!0,[],this.monthDays):n.extend(!0,[],this._dateRender),this.model.group||(this.res1=["0"]),u=0;u<this.res1.length;u++){if(f=0,e=i.length,new Date(i[0])<this.model.minDate&&(f=Math.floor((new Date(this.model.minDate)-new Date(i[0]))/864e5)),new Date(i[i.length-1])>this.model.maxDate&&(s=Math.floor((new Date(i[i.length-1])-new Date(this.model.maxDate))/864e5),e=i.length-s),this._resWorkWeek)for(e=0,f=0,o=0,r=0;r<u+1;r++)if(t.isNullOrUndefined(this.res1[r][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek])?(e+=this.model.workWeek.length,r==u&&(o+=this.model.workWeek.length)):(e+=this.res1[r][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length,r==u&&(o+=this.res1[r][this._tempResource[this._tempResource.length-1].resourceSettings.workWeek].length)),r==u){f=e-o;break}for(f;f<e;f++)this._getBlockIntervals(f,u,i)}},_processBlockApps:function(){var i,t;for(this._processedIntervals=[],i=n.extend(!0,[],this.model.blockoutSettings.dataSource),t=0;t<i.length;t++)(i[t]=this._processtimeZone(i[t]),(this.currentView()=="month"||this._isCustomMonthView())&&Math.round((new Date(i[t][this.model.blockoutSettings.endTime])-new Date(i[t][this.model.blockoutSettings.startTime]))/36e5)<24)||(new Date(new Date(i[t][this.model.blockoutSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[t][this.model.blockoutSettings.endTime]).setHours(0,0,0,0)).getTime()?this._blockTimeSplit(i[t],new Date(i[t][this.model.blockoutSettings.startTime]),new Date(i[t][this.model.blockoutSettings.endTime])):this._processedIntervals.push(i[t]))},_blockTimeSplit:function(t,i,r){for(var u=new Date(this._dateRender[0])<=i?i:new Date(this._dateRender[0]),l=new Date(new Date(r).getFullYear(),new Date(r).getMonth(),new Date(r).getDate(),23,59,59),c=0,o,s,f,e,h;u<=l;)if(o=0,f=u,(this.currentView()=="month"||this._isCustomMonthView()||this.currentView()!="agenda"&&this.currentView()!="day"&&this.model.orientation=="horizontal")&&(this.model.orientation=="horizontal"&&this.currentView()=="month"?o=new Date(f.getFullYear(),f.getMonth()+1,0).getDate()-f.getDate():this.currentView()=="customview"&&(this._renderDays<=7||this.model.orientation=="horizontal")?(u=new Date(new Date(f).getFullYear(),new Date(f).getMonth(),new Date(f).getDate()),o=this._dateRender.indexOf(u.getTime())!=-1?this._dateRender.length-1-this._dateRender.indexOf(u.getTime()):u.getTime()<new Date(this._dateRender[0]).getTime()?(new Date(new Date(this._dateRender[0]).setDate(new Date(this._dateRender[0]).getDate()-1)).getTime()-new Date(u).setHours(0,0,0,0))/864e5:u.getTime()>new Date(this._dateRender[this._dateRender.length-1]).setHours(23,59,59)?this._dateRender.length-1:0):(o=this.model.showNextPrevMonth||this.currentView()!="month"||new Date(new Date(this.currentDate()).getFullYear(),new Date(this.currentDate()).getMonth(),1).getTime()==new Date(u.getFullYear(),u.getMonth(),1).getTime()?6-f.getDay()+this._firstdayofweek:new Date(f.getFullYear(),f.getMonth()+1,0).getDate()-f.getDate(),this._firstdayofweek>f.getDay()&&(o=6-f.getDay()-(7-this._firstdayofweek)))),s=new Date(new Date(u).getFullYear(),new Date(u).getMonth(),new Date(u).getDate()+o),e=new Date(s).getDate()==new Date(r).getDate()?new Date(new Date(s).setHours(r.getHours(),r.getMinutes(),r.getSeconds())):new Date(new Date(s).setHours(23,59,59)),e>=new Date(r)&&(e=t[this.model.blockoutSettings.endTime]),this.model.showNextPrevMonth||this.currentView()!="month"||new Date(u.getFullYear(),u.getMonth(),1).getTime()==new Date(e.getFullYear(),e.getMonth(),1).getTime()||(e=new Date(u.getFullYear(),u.getMonth()+1,0,e.getHours(),e.getMinutes(),e.getSeconds())),h={},h[this.model.blockoutSettings.startTime]=f,h[this.model.blockoutSettings.endTime]=e,this._processedIntervals.push(n.extend({},t,h)),c=this.model.orientation=="horizontal"&&this.currentView()=="workweek"&&new Date(this._dateRender[0]).getDay()==1&&new Date(this._dateRender[this._dateRender.length-1]).getDay()==5?3:1,u=new Date(new Date(e).getFullYear(),new Date(e).getMonth(),new Date(e).getDate()+c),new Date(this._dateRender[this._dateRender.length-1])<u)break},_getBlockIntervals:function(n,i,r){var u=this._processedIntervals,o=t.Predicate(this.model.blockoutSettings.endTime,t.FilterOperators.greaterThanOrEqual,new Date(r[n])).and(this.model.blockoutSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(r[n]).setHours(23,59,59))),s=t.Predicate(this.model.blockoutSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(r[n])).and(this.model.blockoutSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(r[n]).setHours(23,59,59))),e=o.or(s),f;for(e=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?e.and(this.model.blockoutSettings.resourceId,t.FilterOperators.equal,this.res1[i][this._tempResource[this._tempResource.length-1].resourceSettings.id]):e,u=new t.DataManager(u).executeLocal((new t.Query).where(e)),f=0;f<u.length;f++)new Date(new Date(r[n]).setHours(0,0,0,0)).getTime()==new Date(new Date(u[f][this.model.blockoutSettings.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(r[n]).setHours(0,0,0,0)).getTime()<=new Date(new Date(u[f][this.model.blockoutSettings.endTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(u[f][this.model.blockoutSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(u[f][this.model.blockoutSettings.endTime]).setHours(0,0,0,0)).getTime()&&(this.currentView()=="month"||this._isCustomMonthView()||!this.model.timeScale.enable?this._renderMonthBlockTime(u[f],n,i):this._renderBlockTime(u[f],n,i))},_renderBlockTime:function(i,r,u){var b=this.element.find(".e-workcells").outerHeight(),h=parseInt(this.model.startHour)<parseInt(this.model.endHour)?parseInt(this.model.startHour):0,p=parseInt(this.model.startHour)<parseInt(this.model.endHour)?parseInt(this.model.endHour):24,l=this._getDateCount(u),f=i[this.model.blockoutSettings.startTime],e=i[this.model.blockoutSettings.endTime],c,s,k,d,a,ft,et,ot,g,o,nt,v;if(f=new Date(f).getHours()<h?new Date(new Date(f).setHours(h,f.getMinutes(),f.getSeconds())):f,e=p<=e.getHours()?new Date(new Date(e).setHours(p,00,00)):e,c=new Date(f).getHours()<h?new Date(f).getHours()+-new Date(f).getHours()+-new Date(f).getMinutes():new Date(f).getHours()+-h,f<=e&&new Date(l[0]).getTime()<=f.getTime()&&new Date(new Date(l[l.length-1]).setHours(23,59,59))>=f.getTime())if(this.model.orientation=="vertical")s="100%",a=0,k=parseFloat(new Date(new Date(e).getTime())-new Date(new Date(f).getTime()))/6e4*b*this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot-1,d=(parseFloat(new Date(f).getHours()*60+new Date(f).getMinutes()+new Date(f).getSeconds()/60)-parseInt(c*60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-this.model.startHour*60)*b*(this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot),v=this._generateBlockElement(i,s,k,d,a),this._resWorkWeek?n(this.element.find("td.e-workcells")[c*this.model.timeScale.minorSlotCount*this.element.find(".e-headercells").length+r]).append(v):n(this.element.find("td.e-workcells")[parseInt(c*60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*l.length*this.res1.length+r+l.length*u]).append(v);else{var ct=this._horiGroupCollection(),k=b,s,d=0,a,ut=0;if(!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1&&(ft=new t.DataManager(this.res1).executeLocal((new t.Query).where(this._tempResource[this._tempResource.length-1].resourceSettings.id,t.FilterOperators.equal,i[this.model.blockoutSettings.resourceId])),ut=this._findResourceIndex(ct,this._tempResource[this._tempResource.length-2].resourceSettings.id,ft[0][this._tempResource[this._tempResource.length-1].resourceSettings.groupId])+1),et=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this._tempResource)?this._findResourceIndex(this.res1,this._tempResource[this._tempResource.length-1].resourceSettings.id,i[this.model.blockoutSettings.resourceId])+1:1,new Date(new Date(new Date(i[this.model.blockoutSettings.startTime]).setHours(0,0,0,0)).getTime())<new Date(new Date(new Date(i[this.model.blockoutSettings.endTime]).setHours(0,0,0,0)).getTime())){var st=new Date(e)<new Date(new Date(e).setHours(this.model.endHour,0,0))&&new Date(e)<new Date(new Date(e).setHours(this.model.startHour,0,0))?this.model.endHour*30:new Date(e).getHours()*60+new Date(e).getMinutes(),ht=new Date(f)>new Date(new Date(e).setHours(this.model.startHour,0,0))?this.model.startHour*60:new Date(f).getHours()*60+new Date(f).getMinutes(),w=1,tt,y,it,rt,ot;if(tt=this._dateRender.indexOf(new Date(e).setHours(0,0,0,0)),y=this._dateRender.indexOf(new Date(f).setHours(0,0,0,0)),tt==-1)while(w<7)if(new Date(this._dateRender[this._dateRender.length-w]).getTime()<new Date(e).setHours(0,0,0,0)){it=this._dateRender.length-w;st=this.model.endHour*60;break}else w++;else it=tt;y==-1?(rt=r,ht=this.model.startHour*60):rt=y;ot=it-rt;o=ot*(p-h)*60-ht+st;nt=(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)*r+(y==-1?0:c*this.model.timeScale.minorSlotCount)*(60/this.model.timeScale.majorSlot);s=this.element.find(".e-workcells").outerWidth()/30*o+(o/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-2);g>this._dateRender.length&&(g=new Date(this._dateRender[this._dateRender.length-1]).getDay()+1-new Date(f).getDay(),o=g*(p-h)*60,s=o/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*this.element.find(".e-workcells").width()+(o/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-3));a=y==-1?0:parseFloat(new Date(f).getMinutes())*this.element.find(".e-workcells")[0].offsetWidth*this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot}else a=parseFloat(new Date(f).getMinutes()+new Date(f).getMilliseconds()/60)*n(this.element.find(".e-workcells")[1]).width()*this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot-1,o=new Date(e).getHours()*60+new Date(e).getMinutes()-(new Date(f).getHours()*60+new Date(f).getMinutes())+1,s=o/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*this.element.find(".e-workcells").width()+(o/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-2)+1,nt=(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)*r+c*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot);s=s+"px";v=this._generateBlockElement(i,s,k,d,a);n(n(this.element.find(".e-workcellstab tr")[et+ut-1]).find("td.e-workcells")[nt]).append(v)}},_generateBlockElement:function(i,r,u,f,e){var o=this.model.blockoutSettings.templateId?!0:!1,h=o?this._getUserTemplate(this.model.blockoutSettings.templateId,i):"",c=i[this.model.blockoutSettings.isBlockAppointment]?"e-blockenable":"",s=n(this.blockTimeTemplate.render({id:i[this.model.blockoutSettings.id],subject:i[this.model.blockoutSettings.subject],appWidth:r,appHeight:u,left:e,top:f,blockClass:c,customStyle:i[this.model.blockoutSettings.customStyle],userTempId:o,userTemplate:h}));return t.isNullOrUndefined(this.model.queryCellInfo)||this._renderQueryCellInfo("blockAppointment",i,s),s},_renderMonthBlockTime:function(i,r){var b=this.model.orientation=="vertical"?this._dateRender:this.monthDays,u=new Date(i[this.model.blockoutSettings.startTime]),h=new Date(i[this.model.blockoutSettings.endTime]),k,d,l,it=this.model.orientation=="vertical"?this.element.find(".e-monthcells").width():this.element.find(".e-workcells").width(),f=new Date(u),g=new Date(new Date(b[b.length-1]).setHours(23,59,59)),a=new Date(h)>g?g:new Date(h),o=f.getHours()==0&&a.getHours()==0?Math.ceil((new Date(a)-new Date(f))/864e5):Math.ceil((new Date(a).setHours(23,59,59)-new Date(f).setHours(0,0,0))/864e5),v,y,p,e,nt,s,tt,w,c;u<=h&&(this.model.orientation=="vertical"&&(v=this._firstdayofweek==0?7-new Date(f).getDay():7-new Date(f).getDay()+this._firstdayofweek,o=o>=v?v:o,y=Math.ceil((r+1)/7)),k=o*it+"px",p=this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this._findResourceIndex(this.res1,this._tempResource[this._tempResource.length-1].resourceSettings.id,i[this.model.blockoutSettings.resourceId]):0,e=this.model.orientation=="vertical"?p*7+(new Date(u).getDay()+1)+(y-1)*this.res1.length*7-this._firstdayofweek:r+1,this.model.orientation=="vertical"&&this._firstdayofweek!=0&&new Date(u).getDay()<this._firstdayofweek&&(e=p*7+(new Date(u).getDay()+1)+(y-1)*this.res1.length*7-this._firstdayofweek+7),this.model.orientation=="vertical"?l=n(this.element.find("td.e-monthcells")[e-1]).closest("tr").find(".e-monthcells").outerHeight():(nt=this._horiGroupCollection(),s=0,!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1&&(tt=new t.DataManager(this.res1).executeLocal((new t.Query).where(this._tempResource[this._tempResource.length-1].resourceSettings.id,t.FilterOperators.equal,i[this.model.blockoutSettings.resourceId])),s=this._findResourceIndex(nt,this._tempResource[this._tempResource.length-2].resourceSettings.id,tt[0][this._tempResource[this._tempResource.length-1].resourceSettings.groupId])+1),w=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this._tempResource)?this._findResourceIndex(this.res1,this._tempResource[this._tempResource.length-1].resourceSettings.id,i[this.model.blockoutSettings.resourceId])+1:1,l=n(this.element.find(".e-workcellstab tr")[w+s-1]).find(".e-workcells").height()),d=l-this.element.find(".e-monthheader").height(),c=this._generateBlockElement(i,k,d,0,0),this.model.orientation=="vertical"?n(this.element.find("td.e-monthcells")[e-1]).append(c):this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&n(n(this.element.find(".e-workcellstab tr")[w+s-1]).find("td.e-workcells")[e-1]).append(c))},_checkAvailability:function(n){if(this.model.blockoutSettings.enable){var r=new Date(n[this._appointmentSettings.startTime]),f=new Date(n[this._appointmentSettings.endTime]),u;!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&(u=n[this._appointmentSettings.resourceFields.toString().split(",")[this._tempResource.length-1].trim()]);var e=t.Predicate(this.model.blockoutSettings.startTime,t.FilterOperators.greaterThanOrEqual,r).and(this.model.blockoutSettings.endTime,t.FilterOperators.greaterThanOrEqual,r).and(this.model.blockoutSettings.startTime,t.FilterOperators.lessThan,f),o=t.Predicate(this.model.blockoutSettings.startTime,t.FilterOperators.lessThanOrEqual,r).and(this.model.blockoutSettings.endTime,t.FilterOperators.greaterThan,r),i=e.or(o);return i=!t.isNullOrUndefined(u)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?i.and(this.model.blockoutSettings.resourceId,t.FilterOperators.equal,u):i,i=i.and(this.model.blockoutSettings.isBlockAppointment,t.FilterOperators.equal,!0),new t.DataManager(this._processedIntervals).executeLocal((new t.Query).where(i))}return[]},_alertBlockError:function(){n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("BlockIntervalAlertTitle"));this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("BlockIntervalError"));this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok"));this._alertWindow.ejDialog("open")},_getNewEndTime:function(n,t,i){var r=new Date(n);return r.setHours(r.getHours()+t),r.setMinutes(r.getMinutes()+i),r},_getNewStartTime:function(n,t){return t.setHours(t.getHours()+parseInt(this.model.startHour)+parseInt(n/60)),t.setMinutes(t.getMinutes()+parseInt(n%60)),t.setMinutes(Math.round(t.getMinutes()/10)*10),t},_createTemplate:function(t,i){var r=document.createElement("script");return r.id=this._id+i+"_Template",r.type="text/x-jsrender",r.text=t,n("body").append(r),r},_documentOnKeyDown:function(n){if(this.model.allowKeyboardNavigation){var t=n.target||document.activeElement||n.srcElement;n.which==27?this._processEscapeKey():n.which==13?this._processEnterKey(t):n.shiftKey==!1&&n.which==9&&this._processWindowTab(t)}},_processWindowTab:function(t){n(t).hasClass("qAppDone")?this._quickAppointWindow.find(".subject").focus():n(t).hasClass("e-appointcancel")||n(t).hasClass("e-cancelrecur")?this._appointmentAddWindow.find(".subject").focus():n(t).hasClass("e-editseries")&&this.model.showQuickWindow&&this._quickAppDetailsWindow.focus()},_onKeyDown:function(t){var r,i,u,e,o,f,c;if(this.model.allowKeyboardNavigation){if(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),r=this.element.find("div.e-draggableworkarea tr"),i=t.target||document.activeElement||t.srcElement,n(i).hasClass("e-alldaycells")&&(r=this.element.find(".e-alldaycells").parent()),this._trigger("keyDown",{event:t}))return!1;if(n(i).hasClass("e-workcells")||n(i).hasClass("e-alldaycells")||n(i).hasClass("e-monthcells"))this._getDateByElement(n(i)),u=this.curDate,t.which==39&&u.setDate(u.getDate()+1),t.which==37&&u.setDate(u.getDate()-1),u>=this.model.minDate&&u<=this.model.maxDate&&(this.element.find("#"+this._id+"_navigator").ejDatePicker("hide"),(n(i).hasClass("e-workcells")||n(i).hasClass("e-alldaycells")||n(i).hasClass("e-monthcells"))&&n(i).addClass("e-selectedCell"),t.shiftKey==!1&&t.which==38?(this._stopDefaultAction(t),this._processUpArrow(i,r)):t.shiftKey==!1&&t.which==40?(this._stopDefaultAction(t),this._processDown(i,r)):t.ctrlKey==!1&&t.shiftKey==!1&&t.which==39?(this._stopDefaultAction(t),this._processRight(i,r)):t.ctrlKey==!1&&t.shiftKey==!1&&t.which==37?(this._stopDefaultAction(t),this._processLeft(i,r)):t.shiftKey==!0&&t.which==38?(this._stopDefaultAction(t),this._processShiftUp(i,t,r)):t.shiftKey==!0&&t.which==40?(this._stopDefaultAction(t),this._processShiftDown(i,t,r)):t.shiftKey==!0&&t.which==37?(this._stopDefaultAction(t),this._processShiftLeft(i,t,r)):t.shiftKey==!0&&t.which==39&&(this._stopDefaultAction(t),this._processShiftRight(i,t,r)));else if(this.currentView()=="agenda"&&n(i).hasClass("e-agendacells")&&(this._stopDefaultAction(t),t.which==38||t.which==40)){this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment");var l=r.length-1,s=this.element.find(".e-selectedCell").parent().index(),h=t.which==38?parseInt(s)-1:parseInt(s)+1;h>=0&&h<=l&&s!="undefined"&&(n(r).find(".e-eventcolumn,.e-timecolumn").removeClass("e-selectedCell"),n(r[h]).find(".e-eventcolumn,.e-timecolumn").addClass("e-selectedCell").attr("tabIndex",0).focus())}t.altKey==!0&&t.which==67?(this._stopDefaultAction(t),this.element.find(".e-datedisplay").click()):t.ctrlKey==!0&&t.which==37?(this._stopDefaultAction(t),this.element.find("div.e-navigateprevious").click(),this.element.find("div.e-navigateprevious").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):t.ctrlKey==!0&&t.which==39?(this._stopDefaultAction(t),this.element.find("div.e-navigatenext").click(),this.element.find("div.e-navigatenext").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):t.altKey==!0&&t.which==107||t.altKey==!0&&t.which==187||t.altKey==!0&&t.which==61?(this._stopDefaultAction(t),this._navigateToolbarRight(t)):t.altKey==!0&&t.which==189||t.altKey==!0&&t.which==109||t.altKey==!0&&t.which==45||t.altKey==!0&&t.which==173?(this._stopDefaultAction(t),this._navigateToolbarLeft(t)):t.ctrlKey==!0&&t.which==67?(this._stopDefaultAction(t),this._cancel()):t.which==32?n(document.activeElement)[0]===this.element.find("div.e-navigateprevious")[0]?(this._stopDefaultAction(t),this.element.find("div.e-navigateprevious").click(),this.element.find("div.e-navigateprevious").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):n(document.activeElement)[0]===this.element.find("div.e-navigatenext")[0]&&(this._stopDefaultAction(t),this.element.find("div.e-navigatenext").click(),this.element.find("div.e-navigatenext").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):t.altKey==!0&&t.which==78?(this._stopDefaultAction(t),this.currentView()!="agenda"&&this._newAppWindow(i,r),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")):t.ctrlKey==!0&&t.which==69?(this._stopDefaultAction(t),e=this.element.find(".e-selectedAppointment"),this.currentView()=="agenda"&&this.element.find(".e-selectedCell").length>0&&(f=this.element.find(".e-selectedCell").parent().find(".e-agendaappointment"),f.hasClass("e-agendaappointment")&&(e=f)),e.length>0&&(this._editKey=!0,this._cellClick=!1,this._appointmentWindow(e),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide"))):t.which==46?(this._stopDefaultAction(t),o=this.element.find(".e-selectedAppointment"),this.currentView()=="agenda"&&this.element.find(".e-selectedCell").length>0&&(f=this.element.find(".e-selectedCell").parent().find(".e-agendaappointment"),f.hasClass("e-agendaappointment")&&(o=f)),o.length>0&&(this._appUid=o.attr("guid"),this._deleteAppoint())):t.shiftKey==!0&&t.which==9?(this._stopDefaultAction(t),this._reverseTab(i,t,r),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")):t.shiftKey==!1&&t.which==9&&(this._stopDefaultAction(t),this._processTab(i,t,r),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide"));c=this;this.currentView()!="agenda"&&this._moveScrollContent(i,c)}},_processShiftUp:function(t,i,r){var u,s,o;if(this.model.orientation=="horizontal")return!1;if(n(t).hasClass("e-workcells")){var h=r.length-1,e=n(t).parent()[0].rowIndex,f=n(t)[0].cellIndex;e>0&&e<=h&&e!="undefined"?(u=parseInt(e)-1,u>=0&&(n(r[u].cells[f]).hasClass("e-selectedCell")?(n(r[u].cells[f]).attr("tabIndex",0).focus(),n(r[e].cells[f]).removeClass("e-selectedCell")):(n(r[e].cells[f]).addClass("e-selectedCell"),n(r[u].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus())),this._currentRowIndex=u,this._currentColIndex=f):(n(r[e].cells[f]).attr("tabIndex",0).focus(),this._currentRowIndex=e,this._currentColIndex=f)}else if(n(t).hasClass("e-monthcells")){var c=Math.floor(n(t).index()/7),h=r.length-1,l=7*(c+1),a=7*parseInt(c),e=n(t).parent()[0].rowIndex,f=n(t)[0].cellIndex;if(e>0&&e<=h&&e!="undefined")if(u=parseInt(e)-1,u>=0)if(n(r[u].cells[f]).hasClass("e-selectedCell")){for(s=f;s>=a;s--)n(r[e].cells[s]).attr("tabIndex",0).focus(),n(r[e].cells[s]).removeClass("e-selectedCell");for(o=l-1;o>=f;o--)u>=0&&(n(r[u].cells[o]).attr("tabIndex",0).focus(),n(r[u].cells[o]).removeClass("e-selectedCell"));n(r[u].cells[f]).hasClass("e-othermonths")||n(r[u].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else{for(s=f;s>=a;s--)n(r[e].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus();for(o=l-1;o>=f;o--)u>=0&&(n(r[u].cells[o]).hasClass("e-othermonths")||n(r[u].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else n(r[u+1].cells[f]).attr("tabIndex",0).focus();else return!1}else return!1},_processShiftDown:function(t,i,r){var u,o,s;if(this.model.orientation=="horizontal")return!1;if(n(t).hasClass("e-workcells")){var h=r.length-1,f=n(t).parent()[0].rowIndex,e=n(t)[0].cellIndex;f>=0&&f<=h&&f!="undefined"&&(n(r[f].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus(),u=parseInt(f)+1,u<=h?(n(r[u].cells[e]).hasClass("e-selectedCell")?(n(r[u].cells[e]).attr("tabIndex",0).focus(),n(r[f].cells[e]).removeClass("e-selectedCell")):(n(r[f].cells[e]).addClass("e-selectedCell"),n(r[u].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()),this._currentRowIndex=u,this._currentColIndex=e):(n(r[f].cells[e]).attr("tabIndex",0).focus(),this._currentRowIndex=f,this._currentColIndex=e))}else if(n(t).hasClass("e-monthcells")){var c=Math.floor(n(t).index()/7),h=r.length-1,l=7*(c+1),a=7*parseInt(c),f=n(t).parent()[0].rowIndex,e=n(t)[0].cellIndex;if(f>=0&&f<=h&&f!="undefined")if(u=parseInt(f)+1,u<this._dateRender.length/7)if(n(r[u].cells[e]).hasClass("e-selectedCell")){for(o=e;o<=l-1;o++)n(r[f].cells[o]).attr("tabIndex",0).focus(),n(r[f].cells[o]).removeClass("e-selectedCell");for(s=a;s<=e;s++)u<this._dateRender.length/7&&(n(r[u].cells[s]).attr("tabIndex",0).focus(),n(r[u].cells[s]).removeClass("e-selectedCell"));n(r[u].cells[e]).hasClass("e-othermonths")||n(r[u].cells[e]).addClass("e-selectedCell")}else{for(o=e;o<=l-1;o++)n(r[f].cells[o]).hasClass("e-othermonths")||n(r[f].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();for(s=a;s<=e;s++)u<this._dateRender.length/7&&(n(r[u].cells[s]).hasClass("e-othermonths")||n(r[u].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else n(r[u-1].cells[e]).attr("tabIndex",0).focus();else return!1}else return!1},_processShiftLeft:function(t,i,r){var rt=r.length-1,c,l,h,v;if(n(t).hasClass("e-workcells")){var b=t,y=this.currentView()=="day"?1:this.currentView()=="workweek"?this.model.workWeek.length:7,d=this.model.orientation=="vertical"?y:this.currentView()=="month"?this.totdays.length:y*(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot),p=Math.floor(n(b).index()/d),g=d*p,o=n(b)[0].cellIndex,e=n(b).parent()[0].rowIndex,u=o-1,nt=this.model.orientation=="vertical"?0:e,tt=this.model.orientation=="vertical"?rt:e,it=this.model.orientation=="vertical"&&this.model.showAllDayRow?!0:!1,k=this.element.find(".e-alldaycells").parent();if(o>0&&u>parseInt(g)-1&&o!="undefined"){if(n(r[e].cells[u]).hasClass("e-selectedCell")){for(c=nt;c<=parseInt(e);c++)n(r[c].cells[o]).removeClass("e-selectedCell");for(l=tt;l>=parseInt(e);l--)n(r[l].cells[u]).removeClass("e-selectedCell");it&&n(k[0].cells[o]).removeClass("e-selectedCell").attr("tabIndex",0).focus();n(r[e].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else{for(c=nt;c<=parseInt(e);c++)n(r[c].cells[o]).addClass("e-selectedCell");for(l=tt;l>=parseInt(e);l--)n(r[l].cells[u]).addClass("e-selectedCell");it&&(n(k[0].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus(),n(k[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus());n(r[e].cells[u]).attr("tabIndex",0).focus()}this._currentRowIndex=e;this._currentColIndex=u}else n(r[e].cells[u+1]).attr("tabIndex",0).focus(),this._currentRowIndex=e,this._currentColIndex=u+1}else if(n(t).hasClass("e-monthcells")){var p=Math.floor(n(t).index()/7),rt=r.length-1,a=7*(parseInt(p)+1),w=7*parseInt(p),s=n(t).parent()[0].rowIndex,f=n(t)[0].cellIndex;if(f>=w&&f<=a&&f!="undefined")newcur=parseInt(f)-1,n(r[s].cells[newcur]).hasClass("e-selectedCell")?f==w&&s>=1?(h=parseInt(s)-1,v=parseInt(a)-1,h>=0&&(n(r[h].cells[v]).attr("tabIndex",0).focus(),n(r[h].cells[f]).removeClass("e-selectedCell"),n(r[s].cells[w]).removeClass("e-selectedClass"))):f<a&&(newcur=parseInt(f)-1,n(r[s].cells[newcur]).attr("tabIndex",0).focus(),n(r[s].cells[f]).removeClass("e-selectedCell")):f==w&&s>=0?(h=parseInt(s)-1,v=parseInt(a)-1,h>=0?n(r[h].cells[v]).hasClass("e-othermonths")||n(r[h].cells[v]).addClass("e-selectedCell").attr("tabIndex",0).focus():n(r[h+1].cells[f]).attr("tabIndex",0).focus()):f<a&&(newcur=parseInt(f)-1,n(r[s].cells[newcur]).hasClass("e-othermonths")||n(r[s].cells[newcur]).addClass("e-selectedCell").attr("tabIndex",0).focus());else return!1}else if(n(t).hasClass("e-alldaycells")){var y=this.currentView()=="day"?1:this.currentView()=="workweek"?this.model.workWeek.length:7,p=Math.floor(n(t).index()/y),g=y*p,o=n(t)[0].cellIndex,u=o-1;o>0&&u>parseInt(g)-1&&o!="undefined"?(n(r[0].cells[u]).hasClass("e-selectedCell")?(n(r[0].cells[o]).removeClass("e-selectedCell"),n(r[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(r[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus(),this._currentRowIndex=0,this._currentColIndex=u):(n(r[0].cells[u+1]).attr("tabIndex",0).focus(),this._currentRowIndex=0,this._currentColIndex=u+1)}else return!1},_processShiftRight:function(t,i,r){var s,h,o;if(n(t).hasClass("e-workcells")){var g=r.length-1,l=this.currentView()=="day"?1:this.currentView()=="workweek"?this.model.workWeek.length:7,p=this.model.orientation=="vertical"?l:this.currentView()=="month"?this.totdays.length:l*(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot),a=Math.floor(n(t).index()/p),c=p*(a+1),e=n(t).parent()[0].rowIndex,u=n(t)[0].cellIndex,f=parseInt(u)+1,w=this.model.orientation=="vertical"?0:e,b=this.model.orientation=="vertical"?g:e,y=this.element.find(".e-alldaycells").parent(),k=this.model.orientation=="vertical"&&this.model.showAllDayRow?!0:!1;if(u>=0&&u<parseInt(c)-1&&u!="undefined"){if(n(r[e].cells[f]).hasClass("e-selectedCell")){for(s=parseInt(e);s<=b;s++)n(r[s].cells[u]).removeClass("e-selectedCell");for(h=w;h<=e;h++)n(r[h].cells[f]).removeClass("e-selectedCell").attr("tabIndex",0).focus();k&&n(y[0].cells[u]).removeClass("e-selectedCell");n(r[e].cells[f]).addClass("e-selectedCell")}else{for(s=parseInt(e);s<=b;s++)n(r[s].cells[u]).addClass("e-selectedCell");for(h=w;h<=e;h++)n(r[h].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus();k&&(n(y[0].cells[f]).addClass("e-selectedCell"),n(y[0].cells[u]).addClass("e-selectedCell"))}this._currentRowIndex=e;this._currentColIndex=f}else n(r[e].cells[u]).attr("tabIndex",0).focus()}else if(n(t).hasClass("e-monthcells")){var a=Math.floor(n(t).index()/7),g=r.length-1,v=c=7*(parseInt(a)+1),d=7*parseInt(a),e=n(t).parent()[0].rowIndex,u=n(t)[0].cellIndex,f=parseInt(u)+1;if(u>=0&&u<=parseInt(c)-1&&u!="undefined")n(r[e].cells[f]).hasClass("e-selectedCell")?(f<v&&(n(r[e].cells[f]).attr("tabIndex",0).focus(),n(r[e].cells[u]).removeClass("e-selectedCell")),u==parseInt(c)-1&&e<this._dateRender.length/7&&(o=parseInt(e)+1,u=d,o<this._dateRender.length/7&&(n(r[o].cells[u]).hasClass("e-othermonths")||n(r[o].cells[u]).removeClass("e-selectedCell").attr("tabIndex",0).focus(),f<v&&(n(r[o].cells[f]).attr("tabIndex",0).focus(),n(r[o].cells[u]).removeClass("e-selectedCell"))))):(f<v&&(n(r[e].cells[f]).hasClass("e-othermonths")||n(r[e].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus()),u==parseInt(c)-1&&e<this._dateRender.length/7&&(o=parseInt(e)+1,u=d,o<this._dateRender.length/7?(n(r[o].cells[u]).hasClass("e-othermonths")&&n(r[o].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus(),f<v&&n(r[o].cells[f]).hasClass("e-othermonths")&&n(r[o].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(r[o-1].cells[f-1]).attr("tabIndex",0).focus()));else return!1}else if(n(t).hasClass("e-alldaycells")){var l=this.currentView()=="day"?1:this.currentView()=="workweek"?this.model.workWeek.length:7,a=Math.floor(n(t).index()/l),c=l*(a+1),u=n(t)[0].cellIndex,f=parseInt(u)+1;u>=0&&u<parseInt(c)-1&&u!="undefined"?(n(r[0].cells[f]).hasClass("e-selectedCell")?(n(r[0].cells[u]).removeClass("e-selectedCell"),n(r[0].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(r[0].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus(),this._currentRowIndex=0,this._currentColIndex=f):n(r[0].cells[u]).attr("tabIndex",0).focus()}else return!1},_processEnterKey:function(t){var u,f,r,i;n(t).hasClass("e-workcells")||n(t).hasClass("e-monthcells")||n(t).hasClass("e-alldaycells")?(u=this.element.find("td.e-selectedCell"),f=u.length-1,f==0?this._cellSelection(t):this._multipleCellAppointCreation(t)):n(t).hasClass("e-detailedapp e-detailedwindow")?this._appointmentWindow(t):n(t).parent().hasClass("e-allday")?(r=this._appointmentAddWindow.find("#"+this._id+"allday").ejCheckBox("option","checked"),i=r?!1:!0,this._appointmentAddWindow.find(".allday").ejCheckBox({checked:i})):n(t).parent().hasClass("e-recurrence")?(r=this._appointmentAddWindow.find("#"+this._id+"recurrence").ejCheckBox("option","checked"),i=r?!1:!0,this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:i}),this._recurChecked=i?!0:!1,this._repeat(t)):n(t).hasClass("e-scheduledelete")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-scheduledelete").click():n(t).hasClass("e-editevent")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-editevent").click():n(t).hasClass(".e-editseries")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-editseries").click():n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment")?this._cellSelection(t):n(t).parent().hasClass("e-weekday")&&(r=this._appointmentAddWindow.find("#"+n(t).children()[0].id).ejCheckBox("option","checked"),i=r?!1:!0,this._appointmentAddWindow.find("#"+n(t).children()[0].id).ejCheckBox({checked:i}))},_findMinMaxCellIndex:function(){var u=this.element.find("div.e-draggableworkarea tr"),o=u.length-1,i,t,f,s,e,r=this.currentView(),h=r=="day"?1:r=="workweek"?this.model.workWeek.length:7,c=this;return this.element.find("td.e-selectedCell").each(function(h,c){var a=n(c).index(),l;if(a!=null&&!isNaN(a)){if(i==null?(i=a,f=n(c).parent()[0].rowIndex):i<a?i=i:i!=a&&(i=a,f=n(c).parent()[0].rowIndex),r!="month")for(l=0;l<=o;l++)if(n(u[l].cells[i]).hasClass("e-selectedCell")){f=l;break}if(t==null){if(t=a,r!="month")for(e=parseInt(t),l=0;l<=o;l++)n(u[l].cells[e]).hasClass("e-selectedCell")&&(s=l)}else if(t>a)t=t;else if(t!=a&&(t=a,r!="month"))for(e=parseInt(t),l=0;l<=o;l++)n(u[l].cells[e]).hasClass("e-selectedCell")&&(s=l)}}),{rowInx:f,maxrowInx:s,omincolIndex:i,omaxcolIndex:t}},_multipleCellAppointCreation:function(i){var r=t.isNullOrUndefined(i.target)?n(i):n(i.target);if(this._multiple=!0,this._slotByCellSelect(r),this.model.showQuickWindow&&i.type!=="beforeOpen"){this._quickAppointWindow.find("#"+this._id+"_quickAppwindow").css("display","block");new Date(new Date(this.cur_StartTime).setHours(0,0,0,0)).getTime()==new Date(new Date(this.cur_EndTime).setHours(0,0,0,0)).getTime()?this._quickAppointWindow.find(".e-quickstartend").html(this._dayFullNames[new Date(this.cur_StartTime).getDay()]+", "+t.format(new Date(this.cur_StartTime),"MMMM")+" "+new Date(this.cur_StartTime).getDate()+", "+t.format(new Date(this.cur_StartTime),this._timeMode=="12"?this._pattern.t:"HH:mm")+" - "+t.format(new Date(this.cur_EndTime),this._timeMode=="12"?this._pattern.t:"HH:mm")):this._quickAppointWindow.find(".e-quickstartend").html(this._dayFullNames[new Date(this.cur_StartTime).getDay()]+", "+t.format(new Date(this.cur_StartTime),"MMMM")+" "+new Date(this.cur_StartTime).getDate()+", "+t.format(new Date(this.cur_StartTime),this._timeMode=="12"?this._pattern.t:"HH:mm")+" - "+this._dayFullNames[new Date(this.cur_EndTime).getDay()]+", "+t.format(new Date(this.cur_EndTime),"MMMM")+" "+new Date(this.cur_EndTime).getDate()+", "+t.format(new Date(this.cur_EndTime),this._timeMode=="12"?this._pattern.t:"HH:mm"));this._quickAppointWindow.find(".subject").val("");this.model.readOnly||this._quickAppointWindow.ejDialog("open");var f=n(r).offset().left-(this._quickAppointWindow.width()-n(r).width())/2+10,e=n(r).offset().top-this._quickAppointWindow.height()-10,u=this._quickWindowPosition(f,e,n(r),this._quickAppointWindow);this._quickAppointWindow.ejDialog({position:{X:u.X,Y:u.Y}});this._quickAppointWindow.find(".subject").focus();t.scheduleFeatures.resources&&this._tempResource.length!=0&&this._getResourceDetails(n(r))}this._cellClick=!0},_slotByCellSelect:function(t){var r,u;this._cellIndex=n(t).hasClass("e-workcells")?n(t).index():n(t).hasClass("e-alldaycells")?n(t).index():7-((parseInt(n(t).index()/7)+1)*7-n(t).index())+n(t).parent().index()*7;this.model.orientation=="horizontal"&&(this._cellIndex=this.currentView()!=="month"?Math.floor(this._cellIndex/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount)):this._cellIndex,this._workCellIndex=n(t).parent().index());var f=this._findMinMaxCellIndex(),e=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,o=f.omincolIndex,s=f.omaxcolIndex,y=f.rowInx,h=f.maxrowInx,r=e[o],u=e[s];if(this.model.orientation=="vertical")if(n(t).hasClass("e-workcells")){var c=this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,a=this.model.startHour*36e5+y*c*6e4,v=(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)-1==h?(this.model.startHour*this.model.timeScale.minorSlotCount+(h+1))*c*6e4-1:(this.model.startHour*this.model.timeScale.minorSlotCount+(h+1))*c*6e4;this.cur_StartTime=new Date(new Date(r).setMilliseconds(a));this.cur_EndTime=new Date(new Date(u).setMilliseconds(v))}else if(n(t).hasClass("e-monthcells")){var i=this.element.find("td.e-selectedCell"),l=i.length-1,p=n(i[0]).parent().index()*7+(n(i[0]).index()-Math.floor(n(i[0]).index()/7)*7),w=n(i[l]).parent().index()*7+(n(i[l]).index()-Math.floor(n(i[l]).index()/7)*7),b=new Date(this._dateRender[p]),k=new Date(this._dateRender[w]);this.cur_StartTime=new Date(b.setHours(0,0,0));this.cur_EndTime=new Date(k.setHours(23,59,59))}else n(t).hasClass("e-alldaycells")&&(this.cur_StartTime=new Date(r),this.cur_EndTime=new Date(new Date(u).setHours(23,59,59)));else if(this.currentView()!="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable){var r=e[parseInt(o/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)))],u=e[parseInt(s/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)))],d=o%((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)),a=this.model.startHour+d/(this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)),g=s%((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)),v=this.model.startHour+g/(this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot));this.cur_StartTime=new Date(r).setMinutes(a*60);this.cur_EndTime=new Date(u).setMinutes(v*60);this.cur_EndTime=new Date(new Date(this.cur_EndTime).setMinutes(new Date(this.cur_EndTime).getMinutes()+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))}else r=this.totdays[o],u=this.totdays[s],this.cur_StartTime=new Date(r),this.cur_EndTime=new Date(new Date(u).setHours(23,59,59))},_addCellSelection:function(t){var i=this.element.find("td.e-selectedCell"),r=i.length-1;r>0&&(this.element.find("td.e-selectedCell").removeClass("e-selectedCell"),n(t[this._currentRowIndex].cells[this._currentColIndex]).addClass("e-selectedCell").attr("tabIndex",0).focus())},_processUpArrow:function(t,i){var e,r,u;if(n(t).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(i[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(t).hasClass("e-selectedCell")&&this._addCellSelection(i),e=this.element.find(".e-alldaycells"),n(t).hasClass("e-workcells")){var o=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)-1;if(r>0&&r<=o&&r!="undefined"){if(n(i[r-1].cells[u]).hasClass("e-resourceheadercells"))return!1;n(i[r].cells[u]).removeClass("e-selectedCell").blur();n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else r==0&&(this.model.orientation=="vertical"?(r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(this.element).attr("tabIndex",0).focus(),n(e[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else{if(n(t).hasClass("e-alldaycells"))return!1;if(n(t).hasClass("e-monthcells")){var o=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)-1;if(r>=0&&r<=o&&r!="undefined")f>=0?(n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus(),this._selectCurrentMonth(i,r,u);else return!1}else return!1}},_processDown:function(t,i){var o,s;if(n(t).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(i[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(t).hasClass("e-selectedCell")&&this._addCellSelection(i),n(t).hasClass("e-workcells")){var e=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)+1;if(r>=0&&r<=e&&r!="undefined")if(f<=e){if(n(i[r+1].cells[u]).hasClass("e-resourceheadercells"))return!1;n(i[r].cells[u]).removeClass("e-selectedCell").blur();n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else n(i[r].cells[u]).attr("tabIndex",0).focus()}else if(n(t).hasClass("e-alldaycells"))o=this.element.find("td.e-selectedCell")[0].cellIndex,s=this.element.find(".e-alldaycells"),n(s[o]).removeClass("e-selectedCell").blur(),n(this.element.find(".e-workcells")[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(n(t).hasClass("e-monthcells")){var e=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)+1;r>=0&&r<e&&r!="undefined"&&(f<=7?(n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[f-1].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus());this._selectCurrentMonth(i,r,u)}else return!1},_processRight:function(i,r){var l,s,y,p,e,h;if(n(i).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i).hasClass("e-selectedCell")&&this._addCellSelection(r),n(i).hasClass("e-workcells")){var c=r[0].cells.length,f=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,o=parseInt(u)+1;if(u>=0&&u<parseInt(c)-1&&u!="undefined")n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(u==parseInt(c)-1)this.currentView()!="month"?(l=n(i).parent()[0].rowIndex,this.element.find("div.e-navigatenext").click(),n(r[l].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(this.element.find("div.e-navigatenext").click(),n(this.element.find("div.e-draggableworkarea tr")[f].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());else return!1}else if(n(i).hasClass("e-monthcells")){var a=Math.floor(n(i).index()/7),b=r.length-1,v=resmaxcolindex=7*(parseInt(a)+1),w=7*parseInt(a),f=n(i).parent()[0].rowIndex,u=n(i)[0].cellIndex,o=parseInt(u)+1;o<v&&(n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus());u==parseInt(resmaxcolindex)-1&&f<this._dateRender.length/7&&(n(r[f].cells[u]).removeClass("e-selectedCell").blur(),s=parseInt(f)+1,u=w,s<this._dateRender.length/7?(n(r[s].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus(),o<v&&n(r[s].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(y=u/7,this.element.find("div.e-navigatenext").click(),p=t.isNullOrUndefined(this.model.group)?0:y*7,n(this.element.find(".e-monthcells")[p]).addClass("e-selectedCell").attr("tabIndex",0).focus()));this._selectCurrentMonth(r,f,u)}else if(n(i).hasClass("e-alldaycells"))if(e=this.element.find("td.e-selectedCell")[0].cellIndex,h=parseInt(this.element.find(".e-alldaycells").length)-1,e>=0&&e<h)n(this.element.find(".e-alldaycells")[e]).removeClass("e-selectedCell").blur(),n(this.element.find(".e-alldaycells")[parseInt(e)+1]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(e==h)this.element.find("div.e-navigatenext").click(),n(this.element.find(".e-alldaycells")[0]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1;this._keyPressed=!0},_processLeft:function(i,r){var l,f,u,h,w,b,k,d,e,c;if(n(i).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i).hasClass("e-selectedCell")&&this._addCellSelection(r),n(i).hasClass("e-workcells")){var o=r[0].cells.length,f=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,s=parseInt(u)-1;if(u>0&&u<=parseInt(o)-1&&u!="undefined")n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(u==0)this.currentView()!="month"?(l=n(i).parent()[0].rowIndex,this.element.find("div.e-navigateprevious").click(),n(r[l].cells[o-1]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(this.element.find("div.e-navigateprevious").click(),n(this.element.find("div.e-draggableworkarea tr")[f].cells[this.totdays.length-1]).addClass("e-selectedCell").attr("tabIndex",0).focus());else return!1}else if(n(i).hasClass("e-monthcells")){var a=Math.floor(n(i).index()/7),nt=r.length-1,v=7*(parseInt(a)+1),g=7*parseInt(a),y=this.currentView()=="day"?1:this.currentView()=="workweek"?this.model.workWeek.length:7,p=this.model.orientation=="vertical"?y:this.currentView()=="month"?this.totdays.length:y*(this.model.endHour-this.model.startHour)*2;o=this._tempResource.length!=0&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&this.model.orientation=="vertical"?this.render_Resources[this.render_Resources.length-1].length*p:p;f=this.element.find("td.e-selectedCell").parent()[0].rowIndex;u=this.element.find("td.e-selectedCell")[0].cellIndex;u==g&&f>=0?(h=parseInt(f)-1,w=parseInt(v)-1,h>=0?(n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[h].cells[w]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(b=u/7,this.element.find("div.e-navigateprevious").click(),k=this._dateRender.length/7,d=t.isNullOrUndefined(this.model.group)?0:b*7,n(this.element.find("div.e-draggableworkarea tr")[k-1].cells[d+6]).addClass("e-selectedCell").attr("tabIndex",0).focus())):u<v&&(s=parseInt(u)-1,n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus());this._selectCurrentMonth(r,f,u)}else if(n(i).hasClass("e-alldaycells"))if(e=this.element.find("td.e-selectedCell")[0].cellIndex,c=parseInt(this.element.find(".e-alldaycells").length)-1,e>0&&e<=c)n(this.element.find(".e-alldaycells")[e]).removeClass("e-selectedCell").blur(),n(this.element.find(".e-alldaycells")[parseInt(e)-1]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(e==0)this.element.find("div.e-navigateprevious").click(),n(this.element.find(".e-alldaycells")[c]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1;this._keyPressed=!0},_selectCurrentMonth:function(t,i,r){t.find(".e-selectedCell").hasClass("e-othermonths")&&(t.find(".e-selectedCell").removeClass("e-selectedCell").blur(),n(t[i].cells[r]).addClass("e-selectedCell").attr("tabIndex",0).focus())},_navigateToolbarRight:function(n){var t=this.model.views,i=this.element.find(".e-commonviewbutton.e-"+this.currentView()).parent().index(),r;i<t.length-1&&(r=t[i+1].toLowerCase(),this._navView=!0,this._viewChange(n,this.currentView(),r),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}))},_navigateToolbarLeft:function(n){var t=this.element.find(".e-commonviewbutton.e-"+this.currentView()).parent().index(),i;t>0&&(i=this.model.views[t-1].toLowerCase(),this._navView=!0,this._viewChange(n,this.currentView(),i),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}))},_newAppWindow:function(i){var u,f,b,v,k,w;if(n(i).hasClass("e-selectedCell")){this._currentAction=t.Schedule.Actions.Add;var h=i==null?w:i,ut=n(h).parent().index(),ft=n(h).index(),r=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"||this.currentView()=="customview"&&this._dateRender.length<=7?this.dateRender:this._dateRender;if(r=this.model.orientation=="horizontal"&&this.currentView()=="customview"&&this._dateRender.length<=7?this._dateRender:r,u=parseInt(this.element.find("td.e-selectedCell").length)-1,_target=n(h),this._cellIndex=this.model.timeScale.enable?_target.hasClass("e-workcells")?_target.index():_target.hasClass("e-alldaycells")?_target.index():this._isCustomMonthView()&&this._oneWeek?_target.index():7-((parseInt(_target.index()/7)+1)*7-_target.index())+_target.parent().index()*7:this.model.orientation=="vertical"&&this.currentView()=="month"||this.currentView()=="customview"&&this._dateRender.length>=7?7-((parseInt(_target.index()/7)+1)*7-_target.index())+_target.parent().index()*7:_target.index(),this.model.orientation=="horizontal"&&(this._cellIndex=this.model.timeScale.enable?this.currentView()!=="month"&&!this._isCustomMonthView()?Math.floor(this._cellIndex/((this.model.endHour-this.model.startHour)*2)):this._cellIndex:_target.index(),this._workCellIndex=_target.parent().index()),u==0){if(f=new Date(r[this._cellIndex]),this.model.minDate>f||this.model.maxDate<f)return!1;_target.hasClass("e-workcells")&&this.model.timeScale.enable&&this.currentView()!=="month"&&!this._isCustomMonthView()?(b=this.model.orientation=="vertical"?this.model.startHour+_target.parent().index()/2:this.model.startHour+(_target.index()-(this.model.endHour-this.model.startHour)*2*this._cellIndex)/2,v=b.toString().split("."),startTime=new Date(f).setHours(parseInt(v[0]),parseInt(v[1])==5?30:00),k=parseInt(new Date(startTime).getHours())==23&&parseInt(new Date(startTime).getMinutes())==30?new Date(startTime).getMinutes()+29:new Date(startTime).getMinutes()+30,endTime=new Date(new Date(startTime).setMinutes(k)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!1})):(startTime=new Date(new Date(f).setHours(0,0,0)),endTime=new Date(new Date(f).setHours(23,59,59)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0}))}else if(u>0){var c=this._findMinMaxCellIndex(),l=c.omincolIndex,a=c.omaxcolIndex,d=c.rowInx,g=c.maxrowInx;if(this.model.orientation=="vertical")if(n(i).hasClass("e-workcells")){var y=r[l],p=r[a],e=(this.model.startHour+d/2).toString().split("."),o=(this.model.startHour+g/2).toString().split(".");startTime=new Date(new Date(y).setHours(parseInt(e[0]),parseInt(e[1])==5?30:00));endTime=new Date(p).setHours(parseInt(o[0]),parseInt(o[1])==5?30:00);endTime=new Date(new Date(endTime).setMinutes(new Date(endTime).getMinutes()+30))}else if(n(i).hasClass("e-monthcells")){var s=this.element.find("td.e-selectedCell"),nt=n(s[0]).parent().index()*7+(n(s[0]).index()-Math.floor(n(s[0]).index()/7)*7),tt=n(s[u]).parent().index()*7+(n(s[u]).index()-Math.floor(n(s[u]).index()/7)*7),it=new Date(this._dateRender[nt]),rt=new Date(this._dateRender[tt]);startTime=new Date(new Date(it).setHours(0,0,0));endTime=new Date(new Date(rt).setHours(23,59,59))}else n(i).hasClass("e-alldaycells")&&(startTime=new Date(new Date(r[l]).setHours(0,0,0)),endTime=new Date(new Date(r[a]).setHours(23,59,59)));else if(this.currentView()!="month"&&!this._isCustomMonthView()&&this.model.timeScale.enable){var y=r[0],p=r[0],e=(this.model.startHour+l/2).toString().split("."),o=(this.model.startHour+a/2).toString().split(".");startTime=new Date(new Date(y).setHours(parseInt(e[0]),parseInt(e[1])==5?30:00));endTime=new Date(p).setHours(parseInt(o[0]),parseInt(o[1])==5?30:00);endTime=new Date(new Date(endTime).setMinutes(new Date(endTime).getMinutes()+30))}else{var y=this.totdays[l],p=this.totdays[a],e=this.model.startHour.toString().split("."),o=this.model.startHour.toString().split(".");startTime=new Date(y).setHours(parseInt(e[0]),parseInt(e[1])==5?30:00);endTime=new Date(p).setHours(parseInt(o[0]),parseInt(o[1])==5?30:00);endTime=new Date(new Date(endTime).setMinutes(new Date(endTime).getMinutes()+30));endTime=new Date(new Date(endTime).setHours(23,59,59))}}if(w={startTime:new Date(startTime),endTime:new Date(endTime),target:_target,resources:(this.model.appointmentWindowOpen!=null||this.model.cellDoubleClick!=null)&&this._tempResource.length!=0?this._getResourceValue(_target):null},this._trigger("appointmentWindowOpen",w))return!1;t.scheduleFeatures.resources&&this._tempResource.length!=0&&this._renderResourceData(n(h),this._cellIndex);this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",new Date(startTime));this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",new Date(endTime));this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",t.format(new Date(startTime),this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",t.format(new Date(endTime),this._pattern.t));(n(i).hasClass("e-alldaycells")||this.currentView()=="month"||this._isCustomMonthView())&&this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0});this._timeZoneCollection(null);this._tempStart=this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value");this._tempEnd=this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value");this._alldayCheck();this.model.readOnly||(this._appointmentAddWindow.find(".e-appsave,#"+this._id+"donerecur").ejButton("enable",!0),this._mediaQuery&&this._appointmentAddWindow.find(".e-btndelete").css("display","none"),this._appointmentAddWindow.ejDialog("open"));this._appointmentAddWindow.find(".subject").focus();this._cellClick=!1}},_showToolTip:function(i){var i=i.event,u=this.element.data("ejTooltip"),r,f;if(n(i.target).hasClass("e-appup")||n(i.target).hasClass("e-appdown"))return u.setModel({content:this._getLocalizedLabels("AppointmentIndicator")}),!0;if(n(i.target).hasClass("e-appsoverflow"))return this._showAppCount(i);if(this.model.tooltipSettings.enable&&!t.isTouchDevice()){if(r=this._getAppDetails(i.currentTarget),r==!1)return!1;if(t.isNullOrUndefined(this.model.tooltipSettings.templateId))var e=this._timeMode=="12"?t.format(r[this._appointmentSettings.startTime],this._pattern.t):t.format(r[this._appointmentSettings.startTime],"HH:mm"),o=this._timeMode=="12"?t.format(r[this._appointmentSettings.endTime],this._pattern.t):t.format(r[this._appointmentSettings.endTime],"HH:mm"),s=r[this._appointmentSettings.subject]==""||t.isNullOrUndefined(r[this._appointmentSettings.subject])?this._getLocalizedLabels("NoTitle"):r[this._appointmentSettings.subject],f=s+":&nbsp;("+e+"-"+o+")";else f=n(this.model.tooltipSettings.templateId).render(r).trim();return u.setModel({content:f}),!0}return!1},_showAppCount:function(i){var f=i.target.id.split("_"),l=this.currentView()!="day"?new Date(parseInt(n(i.currentTarget).attr("cellinfo"))):new Date(n(i.currentTarget).attr("cellinfo")),a,r,s,h,u,c,b;if(t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)&&(a=this._resourceSort()[parseInt(f[f.length-2])].id),this.model.orientation=="horizontal"&&this.currentView()!="month")var k=parseInt(f[f.length-1]),v=new Date(l.setMilliseconds((this.model.startHour*60+k*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*6e4)),d=new Date(v.setMilliseconds(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount*6e4));if(r=n.templates(n(this.model.appointmentTemplateId).html()),s=this.element.find(".e-appsoverflow").height(),this.model.orientation=="vertical"){var y=this.element.find(".e-monthcells").outerHeight(),e=this.element.find(".e-monthappointment").outerHeight(),g=this.element.find(".e-monthheader").height();t.isNullOrUndefined(e)&&(e=this.model.appointmentTemplateId?n(r.markup).css("height")=="100%"?y-this.element.find(".e-monthheader").height()-15:n(r.markup).css("height")=="0px"?20:n(r.markup).height():19);var p=parseInt(n(i.currentTarget).attr("appcount")),w=p*e+g+s,o=Math.round((w-y)/e);o=o==0?1:o}else{h=this.element.find(".e-workcells").outerHeight();u=this.currentView()=="month"?u=this.element.find(".e-monthappointment").outerHeight():this.element.find(".e-appointment").height();t.isNullOrUndefined(u)&&(u=this.model.appointmentTemplateId?n(r.markup).css("height")=="100%"?h-15:n(r.markup).css("height")=="0px"?20:n(r.markup).height():20);var s=this.element.find(".e-appsoverflow").height(),p=parseInt(n(i.currentTarget).attr("appcount")),w=p*u+s,o=Math.ceil((w-h)/u)}return(c={Date:l,ResourceValue:a,StartTime:v,EndTime:d},this._overflowApp=c,b=this.element.data("ejTooltip"),this._trigger("overflowButtonHover",{event:i,datas:c}))?!1:(b.setModel({content:o+"&nbsp;"+this._getLocalizedLabels("OverFlowAppCount")}),!0)},_horizontalRender:function(){var u,i,r,n,f;t.isNullOrUndefined(this.model.group)||this._tempResource.length==0||this.element.find(".resemptytd").width(this.element.find(".e-horizontalrestd").width()<100?5:this.element.find(".e-horizontalrestd").width()>=100&&this.element.find(".e-horizontalrestd").width()<=150?10:25);this._mediaQuery?this.element.find(".e-parentnode,.e-childnode").height(this.element.find(".e-workcells").height()):(u=this._tempResource.length==0?this.res1.length:this._resourceSort().length,i=this.element.find("div#"+this._id+"_scroller").ejScroller("isHScroll")?this.element.find("div#"+this._id+"_scroller").find(".e-hscroll").outerHeight():0,i=t.isNullOrUndefined(i)?0:i,r=this.scHeight-(this.element.find(".e-scheduleheader").outerHeight()+this.element.find(".e-headerarearow").outerHeight()+i),t.isNullOrUndefined(this.model.group)||this._tempResource.length==0?this.element.find(".e-workcells").css("height",this.model.cellHeight!="20px"?parseInt(this.model.cellHeight):Math.round(r-2)+"px"):(n=Math.round(r/u)-1,this.model.cellWidth!=""&&this.currentView()=="month"&&(n=Math.round(r/u)-1),this.element.find(".e-workcells").css("height",this.model.cellHeight!="20px"||n<20?parseInt(this.model.cellHeight):n+"px"),this.element.find(".e-childnode").css("height",this.model.cellHeight!="20px"||n<20?parseInt(this.model.cellHeight):n+"px"),this.element.find(".e-parentnode").css("height",this.model.cellHeight!="20px"||n<20?parseInt(this.model.cellHeight):n+"px"),this.currentView()!="agenda"&&(f=this.element.find(".e-draggableworkarea").offset().top-this.element.find(".e-workcellstab").offset().top,this.element.find(".e-horires").css("top",-f+"px"))));this.element.find(".e-workcells").height()>r&&this.element.find("div#"+this._id+"_scroller").ejScroller("refresh");this.element.find("div#"+this._id+"_scroller").ejScroller("isVScroll")&&this._showScrollTd()},_monthCellsRender:function(){var t=this.element.find(".e-workcellstab tr").length,i=parseInt(this.element.find(".e-scheduleheader").outerHeight()),r=parseInt(this.element.find(".e-headerarearow").outerHeight()),n=parseInt(this.scHeight)-(i+r);this.element.find(".e-monthcells").css("height",this.model.cellHeight!="20px"||n<20?parseInt(this.model.cellHeight):Math.round(n/t-2)+"px");this.element.find(".e-timecells").height(this.element.find(".e-monthcells").height()+"px")},_processTab:function(t,i,r){var u=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-agendaappointment"),s,c,e,o,f,h;if((t.id==this._id||n(t).hasClass("e-datedisplay"))&&(u.length!=0?n(u[0]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()),n(t).hasClass("e-selectedCell")&&u.length!=0){if(s=this.element.find("td.e-selectedCell"),c=parseInt(s.length)-1,c>0)for(e=0;e<=c;e++)s[e].blur(),n(s[e]).removeClass("e-selectedCell");else n(t).removeClass("e-selectedCell").blur();n(u[0]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()}n(t).hasClass("e-navigateprevious")?this.element.find(".e-navigatenext").attr("tabIndex",0).focus():n(t).hasClass("e-navigatenext")&&(n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus(),n(r[0].cells[0]).hasClass("e-resourceheadercells")&&n(r[1].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());(n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment")||n(t).hasClass("e-agendaappointment"))&&(o=u.length,f=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-agendaappointment").index(this.element.find(".e-selectedAppointment")),f<o&&f>=0?(n(u[f]).removeClass("e-selectedAppointment").blur(),h=parseInt(f)+1,h<o?n(u[h]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():h==o&&this.element.find(".e-navigateprevious").attr("tabIndex",0).focus()):f==o&&this.element.find(".e-navigateprevious").attr("tabIndex",0).focus())},_reverseTab:function(t,i,r){var u=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-agendaappointment"),h,e,c,l,o,f,s;if((t.id==this._id||n(t).hasClass("e-datedisplay"))&&(e=parseInt(u.length)-1,u.length!=0&&n(u[e]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()),h=u.length,n(t).hasClass("e-selectedCell")&&(e=u.length-1,u.length!=0)){if(c=this.element.find("td.e-selectedCell"),l=parseInt(c.length)-1,l>0)for(o=0;o<=l;o++)n(c[o]).removeClass("e-selectedCell").blur();else n(t).removeClass("e-selectedCell").blur();n(u[e]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()}n(t).hasClass("e-navigatenext")?n(this.element).find(".e-navigateprevious").attr("tabIndex",0).focus():n(t).hasClass("e-navigateprevious")&&(n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus(),n(r[0].cells[0]).hasClass("e-resourceheadercells")&&n(r[1].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());(n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment")||n(t).hasClass("e-agendaappointment"))&&(f=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-agendaappointment").index(this.element.find(".e-selectedAppointment")),f<h&&f>0?(n(u[f]).removeClass("e-selectedAppointment").blur(),s=parseInt(f)-1,s<h&&f>=0?n(u[s]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():s==0&&n(this.element).find(".e-navigatenext").attr("tabIndex",0).focus()):f==0&&(n(u[f]).removeClass("e-selectedAppointment").blur(),n(this.element).find(".e-navigatenext").attr("tabIndex",0).focus()))},_stopDefaultAction:function(n){n.cancelBubble=!0;n.returnValue=!1;n.stopPropagation();n.preventDefault()},_getLocalizedLabels:function(n){return n=="Categorize"?t.isNullOrUndefined(this.model.categorizeSettings.title)?this._localizedLabels[n]===r?t.Schedule.Locale["en-US"][n]:this._localizedLabels[n]:this.model.categorizeSettings.title:n=="Priority"?t.isNullOrUndefined(this.model.prioritySettings.title)?this._localizedLabels[n]===r?t.Schedule.Locale["en-US"][n]:this._localizedLabels[n]:this.model.prioritySettings.title:this._localizedLabels[n]===r?t.Schedule.Locale["en-US"][n]:this._localizedLabels[n]},refreshAppointments:function(){t.isNullOrUndefined(this._appointmentSettings)||(this._dataManager=this.dataSource()instanceof t.DataManager?this.dataSource():this.dataSource()!=null?t.DataManager(this.dataSource()):null);this._bindAppointmentsData("Refresh")},refresh:function(){this._destroy();this._init()},getSlotByElement:function(i){var r=t.isNullOrUndefined(i)?n(this.element.find("td.e-selectedCell")):n(i);return t.isNullOrUndefined(r)||r.length==0||this.currentView()=="agenda"?!1:((r.hasClass("e-workcells")||r.hasClass("e-monthcells")||r.hasClass("e-alldaycells"))&&(r.length==1?this._slotByElement(r,""):this._slotByCellSelect(r)),{startTime:new Date(this.cur_StartTime),endTime:new Date(this.cur_EndTime),resources:!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this._getResourceValue(r):null})},saveAppointment:function(i){var d,yt,b,ct,w,l,r,nt,u,s,k,et,lt,at,o,g,vt,ht,p,e;if(!this.model.readOnly)if(d=this._appointmentAddWindow.find(".e-recurrenceeditor").data("ejRecurrenceEditor"),yt=this._sortAppById(this._processed),this._publicMethodSave=!1,this.model.appointmentSettings.applyTimeOffset&&(t.isNullOrUndefined(i[this._appointmentSettings.startTimeZone])&&(i[this._appointmentSettings.startTimeZone]=this.model.timeZone==null?"UTC "+this._timezoneStringValue():this.model.timeZone),t.isNullOrUndefined(i[this._appointmentSettings.endTimeZone])&&(i[this._appointmentSettings.endTimeZone]=this.model.timeZone==null?"UTC "+this._timezoneStringValue():this.model.timeZone)),ct=this._timeZoneSavingAppoint(i,""),i=ct.obj,t.isNullOrUndefined(i[this._appointmentSettings.id])&&!i[this._appointmentSettings.id]!=""||(w=new t.DataManager(this._processed).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,i[this._appointmentSettings.id])),t.isNullOrUndefined(w[0])||(i.Guid=w[0].Guid,i.AppTaskId=w[0].AppTaskId,i.RecurrenceId=w[0].recurrenceId,i.recurrenceExDate=w[0].recurrenceExDate,i.ParentId=w[0].ParentId)),l=this,b=t.isNullOrUndefined(this._appMainId)?1:this._appMainId+1,r=this._currentAction=="save"?"edit":this._currentAction,t.isNullOrUndefined(i.AppTaskId)||i.AppTaskId==""){if((i[this._appointmentSettings.id]=t.isNullOrUndefined(i[this._appointmentSettings.id])||i[this._appointmentSettings.id]==""?b:i[this._appointmentSettings.id],i.AppTaskId=i.ParentId=b,i.Guid=this._guidFormatGenerate(),this._trigger("actionBegin",{data:i,requestType:"appointmentSave",methodType:"public"}))||this._trigger("beforeAppointmentCreate",{appointment:i,methodType:"public"}))return!1;p=this._timeZoneAppointments(i,"");e=this._dataManager.insert(p,this.model.appointmentSettings.query._fromTable);new t.DataManager(this._currentAppointmentData).update("AppTaskId",this._timeZoneAppointments(p,"reverse"));!t.isNullOrUndefined(e)&&n.isFunction(e.promise)&&this.dataSource()instanceof t.DataManager?e.done(function(n){l._processUrlBinding(n);l._trigger("appointmentCreated",{appointment:p,requestType:"appointmentSaved",methodType:"public"});l._trigger("actionComplete",{data:p,requestType:"appointmentSave",methodType:"public"})}):(this._renderSingleApp(),this._appMainId=this._sortAppById(this._processed)[this._processed.length-1].AppTaskId,this._trigger("appointmentCreated",{appointment:i,requestType:"appointmentSaved",methodType:"public"}),this._trigger("actionComplete",{data:i,requestType:"appointmentSave",methodType:"public"}))}else if(this._currentAction=="editOccurrence"){if(this._trigger("actionBegin",{data:i,requestType:"appointmentEdit",currentAction:r})||this._trigger("beforeAppointmentChange",{appointment:i,currentAction:r}))return!1;var a=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],ft=a[this._appointmentSettings.recurrenceId]==null?a.ParentId:a[this._appointmentSettings.recurrenceId],nt=a[this._appointmentSettings.recurrenceId]==null?"ParentId":this._appointmentSettings.recurrenceId,h=this._appointmentRecurrenceSort(new t.DataManager(this._processed).executeLocal((new t.Query).where(nt,t.FilterOperators.equal,ft))),c=this._recuCollectionIndex(h,a),f=this._appointmentSettings;if(c==0?t.isNullOrUndefined(h[c+1])?!1:!(new Date(new Date(h[c+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[f.endTime]).setHours(0,0,0,0)).getTime()):c==h.length-1?!(new Date(new Date(h[c-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[f.startTime]).setHours(0,0,0,0)).getTime()):!(new Date(new Date(h[c-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[f.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(h[c+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[f.endTime]).setHours(0,0,0,0)).getTime()))return this._alertCreateError(),!1;o=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid));this._objDate=o;nt=this._objDate[0][this._appointmentSettings.recurrenceId]==null?"ParentId":this._appointmentSettings.recurrenceId;u=this._deleteOcurrence(this._objDate[0][nt],new Date(o[0][this._appointmentSettings.startTime]));i[this._appointmentSettings.recurrence]=1;i[this._appointmentSettings.recurrenceRule]=u[0][this._appointmentSettings.recurrenceRule]+";RECUREDITID="+u[0].ParentId;i[this._appointmentSettings.recurrenceId]=u[0][this._appointmentSettings.recurrenceId];i[this._appointmentSettings.recurrenceExDate]=u[0][this._appointmentSettings.recurrenceExdate];i.Guid=o[0].Guid;i[this._appointmentSettings.id]=o[0][this._appointmentSettings.id];s=[];k=this._addAppData(i,b,new Date(i[this._appointmentSettings.startTime]),new Date(i[this._appointmentSettings.endTime]),i[this._appointmentSettings.recurrenceId]);k[this._appointmentSettings.id]=k.AppTaskId;s.push(k);var v=[],u=[],tt=s[0][this._appointmentSettings.startTimeZone];tt!=this.model.timeZone?v.push(this._timeZoneAppointments(s[0],"")):v.push(s[0]);et=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,this._parentId));tt!=this.model.timeZone?u.push(this._timeZoneAppointments(et[0],"")):u.push(et[0]);e=this.dataSource()instanceof t.DataManager?this._dataManager.saveChanges({added:v,changed:u,deleted:[]},this._appointmentSettings.id,this.model.appointmentSettings.query._fromTable):this._dataManager.saveChanges({added:v,changed:u,deleted:[]},"AppTaskId");lt=tt!=this.model.timeZone?this._timeZoneAppointments(v[0],"reverse"):v[0];new t.DataManager(this._currentAppointmentData).update("AppTaskId",lt);at=tt!=this.model.timeZone?this._timeZoneAppointments(u[0],"reverse"):u[0];new t.DataManager(this._currentAppointmentData).update("AppTaskId",at);n.isFunction(e.promise)&&this.dataSource()instanceof t.DataManager?(e.done(function(n){l._processUrlBinding(n);l._trigger("appointmentChanged",{appointment:s[0],requestType:"appointmentChanged",currentAction:r,methodType:"public"});l._trigger("actionComplete",{data:s,requestType:"appointmentEdit",currentAction:r,methodType:"public"})}),e.fail(function(){})):(this._renderSingleApp(),this._trigger("appointmentChanged",{appointment:s[0],requestType:"appointmentChanged",currentAction:r,methodType:"public"}),this._trigger("actionComplete",{data:s,requestType:"appointmentEdit",currentAction:r,methodType:"public"}))}else if(this._currentAction=="save"&&i[this._appointmentSettings.recurrence]||this._currentAction==t.Schedule.Actions.EditSeries){if(this._trigger("actionBegin",{data:i,requestType:"appointmentEdit",currentAction:r})||this._trigger("beforeAppointmentChange",{appointment:i,currentAction:r}))return!1;if(g=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),o=new t.DataManager(this._processed).executeLocal(g),this._currentAction!=t.Schedule.Actions.EditSeries){t.isNullOrUndefined(o[0][this._appointmentSettings.recurrenceRule])||(i[this._appointmentSettings.recurrenceRule]=o[0][this._appointmentSettings.recurrenceRule]);var a=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],ft=a[this._appointmentSettings.recurrenceId]==null?a.ParentId:a[this._appointmentSettings.recurrenceId],nt=a[this._appointmentSettings.recurrenceId]==null?"ParentId":this._appointmentSettings.recurrenceId,h=this._appointmentRecurrenceSort(new t.DataManager(this._processed).executeLocal((new t.Query).where(nt,t.FilterOperators.equal,ft))),c=this._recuCollectionIndex(h,a),f=this._appointmentSettings;if(c==0?t.isNullOrUndefined(h[c+1])?!1:!(new Date(new Date(h[c+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[f.endTime]).setHours(0,0,0,0)).getTime()):c==h.length-1?!(new Date(new Date(h[c-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[f.startTime]).setHours(0,0,0,0)).getTime()):!(new Date(new Date(h[c-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[f.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(h[c+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[f.endTime]).setHours(0,0,0,0)).getTime()))return this._alertCreateError(),!1}else{var ft=o[0][this._appointmentSettings.recurrenceId]==null?o[0].ParentId:o[0][this._appointmentSettings.recurrenceId],g=(new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,ft),u=new t.DataManager(this._currentAppointmentData).executeLocal(g);b=i.AppTaskId=u[0].AppTaskId;i[this._appointmentSettings.id]=u[0][this._appointmentSettings.id];i[this._appointmentSettings.recurrenceId]=u[0][this._appointmentSettings.recurrenceId];i[this._appointmentSettings.recurrenceExDate]=u[0][this._appointmentSettings.recurrenceExate];i[this._appointmentSettings.recurrenceRule]=t.isNullOrUndefined(d._recRule)||d._recRule==""?u[0][this._appointmentSettings.recurrenceRule]:d._recRule}i.Guid=o[0].Guid;i[this._appointmentSettings.id]=this._currentAction!=t.Schedule.Actions.EditSeries?o[0][this._appointmentSettings.id]:i[this._appointmentSettings.id];var s=[],k,ot=this._currentAction==t.Schedule.Actions.EditOccurrence||!t.isNullOrUndefined(i[this._appointmentSettings.recurrenceRule])&&i[this._appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1?this._parentId:this._currentAction==t.Schedule.Actions.Save?o[0].AppTaskId:b,st=(new Date(i[this._appointmentSettings.endTime])-new Date(i[this._appointmentSettings.startTime]))/36e5>24&&this._currentAction!=t.Schedule.Actions.EditOccurrence&&i[this._appointmentSettings.allDay]==!0?ot:this._currentAction==t.Schedule.Actions.Save?o[0].AppTaskId:this._appMainId+1;st=this._currentAction==t.Schedule.Actions.EditSeries?ot:st;k=this._addAppData(i,st,new Date(i[this._appointmentSettings.startTime]),new Date(i[this._appointmentSettings.endTime]),ot);s.push(k);var v=[],y=[],it=[],pt=this._currentAction==t.Schedule.Actions.Save?s[0].Guid:s[0][this._appointmentSettings.recurrenceId],wt=this._currentAction==t.Schedule.Actions.Save?"Guid":this._appointmentSettings.recurrenceId,u=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(wt,t.FilterOperators.equal,pt));!t.isNullOrUndefined(u)&&u.length>0?y.push(s[0]):v.push(s[0]);this._currentAction==t.Schedule.Actions.EditSeries&&(g=t.Query().where(t.Predicate(this._appointmentSettings.recurrenceRule,t.FilterOperators.contains,"RECUREDITID="+s[0].ParentId,!0)),vt=new t.DataManager(this._currentAppointmentData).executeLocal(g),it=it.concat(vt),this._appointmentAddWindow.find(".recurbutton").click(),y[0][this._appointmentSettings.recurrenceRule]=d._recRule,y[0][this._appointmentSettings.recurrenceExDate]=null);var l=this,e,rt=[],ut=[];v.length>0&&rt.push(this._timeZoneAppointments(v[0],""));y.length>0&&ut.push(this._timeZoneAppointments(y[0],""));e=this.dataSource()instanceof t.DataManager?this._dataManager.saveChanges({added:rt,changed:ut,deleted:it},this._appointmentSettings.id,this.model.appointmentSettings.query._fromTable):this._dataManager.saveChanges({added:rt,changed:ut,deleted:it},"AppTaskId");y.length>0&&(ht=this._timeZoneAppointments(ut[0],"reverse"));v.length>0&&(ht=this._timeZoneAppointments(rt[0],"reverse"));new t.DataManager(this._currentAppointmentData).update("AppTaskId",ht);n.isFunction(e.promise)&&this.dataSource()instanceof t.DataManager?(e.done(function(n){l._processUrlBinding(n);l._trigger("appointmentChanged",{appointment:y[0],requestType:"appointmentChanged",currentAction:r,methodType:"public"});l._trigger("actionComplete",{data:y,requestType:"appointmentEdit",currentAction:r,methodType:"public"})}),e.fail(function(){})):(this._renderSingleApp(),this._trigger("appointmentChanged",{appointment:y[0],requestType:"appointmentChanged",currentAction:r,methodType:"public"}),this._trigger("actionComplete",{data:y,requestType:"appointmentEdit",currentAction:r,methodType:"public"}))}else{if(this._trigger("actionBegin",{data:i,requestType:"appointmentEdit",currentAction:r,methodType:"public"})||this._trigger("beforeAppointmentChange",{appointment:i,currentAction:r,methodType:"public"}))return!1;p=this._timeZoneAppointments(i,"");e=this.dataSource()instanceof t.DataManager?this._dataManager.update(this._appointmentSettings.id,p,this.model.appointmentSettings.query._fromTable):this._dataManager.update("AppTaskId",p);new t.DataManager(this._currentAppointmentData).update("AppTaskId",this._timeZoneAppointments(p,"reverse"));n.isFunction(e.promise)&&this.dataSource()instanceof t.DataManager?e.done(function(n){l._processUrlBinding(n);l._trigger("appointmentChanged",{appointment:i,requestType:"appointmentChanged",currentAction:r,methodType:"public"});l._trigger("actionComplete",{data:i,requestType:"appointmentEdit",currentAction:r,methodType:"public"})}):(this._renderSingleApp(),this._trigger("appointmentChanged",{appointment:i,requestType:"appointmentChanged",currentAction:r,methodType:"public"}),this._trigger("actionComplete",{data:i,requestType:"appointmentEdit",currentAction:r,methodType:"public"}))}},print:function(i){if(t.isNullOrUndefined(i)){var r=this.element.clone();this.currentView()=="agenda"?(r.width(this.element.find(".e-agendacellstab").width()),r.height(n("#"+this._id+" .e-headertr").height()+this.element.find(".e-agendacellstab").height()+n("#"+this._id+" .e-scheduleheader").height()+2),r.find(".e-scroller").ejScroller({width:this.element.find(".e-agendacellstab").width(),height:n("#"+this._id+" .e-agendacellstab").height()+2}),r.find(".e-commonviewbutton").css({"margin-top":"0px"}),r.find(".e-viewstable").css({"padding-top":"15px"})):(r.find(".e-upicon,.e-downicon").remove(),this.model.orientation=="vertical"?this.model.timeScale.enable?(this.currentView()=="month"||this._isCustomMonthView()&&this._renderDays>7?r.width(this.element.find(".e-workcellstab").width()+n(".e-monthleftindent").width()):r.width(this.element.find(".e-workcellstab").width()+n(".e-workleftindent").width()),r.height(n("#"+this._id+" .e-headertr").height()+n("#"+this._id+" .e-workcellstab").height()+n("#"+this._id+" .e-scheduleheader").height()+2),r.find(".e-scroller").ejScroller({width:n(".e-dateheader").width(),height:n("#"+this._id+" .e-workcellstab").height()+2}),r.find(".e-scrolltimecells").css({top:0}),r.find(".e-commonviewbutton").css({"margin-top":"0px"}),r.find(".e-viewstable").css({"padding-top":"15px"}),r.children().first().css({border:"0px solid #bbbcbb"}),r.css({border:"1px solid #bbbcbb"}),this.currentView()=="month"&&r.find(".e-draggableworkarea").css({height:this.element.find(".e-timecells").height()*this.element.find(".e-timecells").length+2})):(r.width(this.element.find(".e-workcellstab").width()+n(".e-workleftindent").width()),r.find(".e-workcellstab").css({left:-n("div#"+this._id+"_scroller").data("ejScroller").scrollLeft(),position:"absolute"})):this.currentView()=="month"||this._isCustomMonthView()&&this._renderDays>7?r.width(this.element.find(".e-workcellstab").width()):(r.find(".e-workcellstab").css({left:-n("div#"+this._id+"_scroller").data("ejScroller").scrollLeft(),position:"absolute"}),r.find(".e-horizontaltimecells tr:nth-child(2)").css("left",-n("div#"+this._id+"_scroller").data("ejScroller").scrollLeft()+"px")));t.print(r)}else this._printAppointment(i)},notifyChanges:function(i,r){var e,u,f;t.isNullOrUndefined(r)&&r.length==0||(e=t.isNullOrUndefined(r)?r[0]:r,u=n.extend(!0,{},e),u[this._appointmentSettings.startTime]=new Date(u[this._appointmentSettings.startTime]),u[this._appointmentSettings.endTime]=new Date(u[this._appointmentSettings.endTime]),i=="beforeAppointmentCreate"?(new t.DataManager(this._currentAppointmentData).insert(u),this._appointmentProcessing(u),this._renderAppointmentAll()):i=="beforeAppointmentChange"?(new t.DataManager(this._currentAppointmentData).update(this._appointmentSettings.id,u),new t.DataManager(this._processed).remove(this._appointmentSettings.id,u[this._appointmentSettings.id]),this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll()):i=="beforeAppointmentRemove"&&(f=new t.DataManager(this._processed).executeLocal((new t.Query).where(this._appointmentSettings.id,t.FilterOperators.equal,u[this._appointmentSettings.id])),new t.DataManager(this._currentAppointmentData).remove(this._appointmentSettings.id,f[0][this._appointmentSettings.id]),new t.DataManager(this._processed).remove(this._appointmentSettings.id,f[0][this._appointmentSettings.id]),this._renderAppointmentAll()))},deleteAppointment:function(n){var i;this.model.readOnly||(typeof n=="string"?(i=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,n)),i[0][this._appointmentSettings.recurrence]?(this._deleteUid=n,this._deletingAppointment()):this._deleteApp(n)):typeof n=="object"&&(this._deleteUid=n.Guid,t.isNullOrUndefined(this._deleteUid)&&(i=new t.DataManager(this._processed).executeLocal((new t.Query).where("ParentId",t.FilterOperators.equal,n.ParentId)),this._deleteUid=i[0].Guid),n[this._appointmentSettings.recurrence]?this._deletingAppointment():this._deleteApp(this._deleteUid)))},getAppointments:function(){return this.dataSource()},searchAppointments:function(n,i,r,u){var f=t.Query(),e,o=t.isNullOrUndefined(i)?this._getColumns(this._appointmentSettings):i;return r=t.isNullOrUndefined(r)?"contains":r,u=t.isNullOrUndefined(u)?!0:u,typeof n=="string"?n.length&&(f.search(n,o,r,u),e=this.dataSource()instanceof t.DataManager?f:this._dataManager.executeLocal(f)):typeof n=="object"&&(e=this.filterAppointments(n)),e},filterAppointments:function(n){var o,e=t.Query(),u,r,f,i;if(!t.isNullOrUndefined(n)){for(r=n[0],u=t.isNullOrUndefined(r.matchcase)?!0:r.matchcase,f=t.Predicate(r.field,r.operator,r.value,u),i=1;i<n.length;i++)u=t.isNullOrUndefined(n[i].matchcase)?!0:n[i].matchcase,f=f[n[i].predicate](n[i].field,n[i].operator,n[i].value,u);e.where(f);o=this.dataSource()instanceof t.DataManager?e:this._dataManager.executeLocal(e)}return o},refreshScroller:function(){var i=this.element.find("div#"+this._id+"_scroller").data("ejScroller"),f=this.model.orientation==="vertical"?this.element.width()-(this._mediaQuery&&(this.currentView()=="month"||this._isCustomMonthView())?1:this.element.find(".e-scrolltimecells").parent().outerWidth()):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this.element.width()-this.element.find(".e-resourceheadertable").width():this.element.width();if(i.model.width=parseInt(f)-2,i.model.height=this.scHeight-1-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),i.refresh(),this.model.orientation=="vertical"){if(this.model.cellWidth){var r=this.currentView()=="workweek"?this.model.workWeek.length:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,e=!t.isNullOrUndefined(this.model.group)&&this._tempResource.length!=0?this.res1.length*r:r,o=this._dateRender.length/7,u=parseInt(this.model.cellWidth)*e,s=parseInt(this.model.cellHeight)*o;this.element.find(".e-draggableworkarea").width(this.element.width()>u+this.element.find(".e-scrolltimecells").width()+18?u:i.model.width-18)}this._mediaQuery&&this.res1.length>1&&this.element.find(".e-draggableworkarea").width(this.element.find(".e-draggableworkarea").width()*this.res1.length);this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width());this.element.find(".e-datecommondiv").parent().width(parseInt(this.element.width())-2);this.element.find(".e-headrealldaytable").css("left",-this.element.find(".e-draggableworkarea").scrollLeft()+"px")}else n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-i.model.scrollLeft+"px"),this.element.find(".e-horizontresdiv").height(this.element.find(".e-draggableworkarea").height());this._reRenderHeaderBar();this.model.showAppointmentNavigator&&this._refreshAppNavigation();this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove();this._highlightCurrentTime(this.model.showCurrentTimeIndicator);this.currentView()=="month"&&this.model.orientation=="vertical"&&this._renderCurrentView();this._showScrollTd();this.element.find(".e-mobileNavigation").css(this.model.enableRTL?"right":"left",this.element.outerWidth()-36)},_refreshAppNavigation:function(){var n,u,i,r,f;this._browserInfo.name==="msie"&&this._browserInfo.version<9||(n=this.element.find("#"+this._id+"_scroller"),this.height=n.height(),this.width=n.width(),u=n.ejScroller("instance").isVScroll()?n.find(".e-vscroll").width():0,i=this.element.find(".e-scrolltimecells").width(),i=t.isNullOrUndefined(i)?this.model.orientation=="vertical"?56:0:i,r=this.height/2-75,f=this.model.showTimeScale&&this.currentView()!="agenda"?this.model.orientation=="vertical"?this.currentView()!="month"&&!this._isCustomMonthView()?-4:-10:-61:-61,this.width=this.model.showTimeScale&&this.currentView()!="agenda"?this.width:this.width-i,this.model.enableRTL?(this.element.find(".e-prevapp").css("top",r+40+"px").css("transform","rotate(-90deg)").css("right",f+"px"),this.element.find(".e-nextapp").css("top",r+40+"px").css("transform","rotate(90deg)").css("right",this.width-u-(this.model.orientation=="vertical"&&(this.currentView()=="month"||this._isCustomMonthView())?41:this.model.orientation=="vertical"?35:90)+"px")):(this.element.find(".e-prevapp").css("top",r+40+"px").css("transform","rotate(90deg)").css("left",f+"px"),this.element.find(".e-nextapp").css("top",r+40+"px").css("transform","rotate(-90deg)").css("left",this.width-u-(this.model.orientation=="vertical"&&(this.currentView()=="month"||this._isCustomMonthView())?41:this.model.orientation=="vertical"?35:90)+"px")))},getDifference:function(n){var t="";return n.toString().indexOf("-")!=-1?(t=n.toString().substring(n.toString().indexOf("-")+1,n.toString().indexOf("-")+5),-(parseInt(t.substring(0,2))*60)+parseInt(t.substring(2,4))):(t=n.toString().substring(n.toString().indexOf("+")+1,n.toString().indexOf("+")+5),parseInt(t.substring(0,2))*60+parseInt(t.substring(2,4)))},exportSchedule:function(i,r,u){var l={},e=[],o=[],h,y,a,v,f,w,b,k,d;for(n.extend(!0,l,this.model),n.extend(!0,e,this._processed),n.extend(!0,o,this._processedIntervals),f=0;f<e.length;f++)e[f][this._appointmentSettings.startTime]=new Date(e[f][this._appointmentSettings.startTime].getTime()+this.getDifference(e[f][this._appointmentSettings.startTime])*6e4),e[f][this._appointmentSettings.endTime]=new Date(e[f][this._appointmentSettings.endTime].getTime()+this.getDifference(e[f][this._appointmentSettings.endTime])*6e4);for(h=0;h<o.length;h++)o[h][this.model.blockoutSettings.startTime]=new Date(o[h][this.model.blockoutSettings.startTime].getTime()+this.getDifference(o[h][this.model.blockoutSettings.startTime])*6e4),o[h][this.model.blockoutSettings.endTime]=new Date(o[h][this.model.blockoutSettings.endTime].getTime()+this.getDifference(o[h][this.model.blockoutSettings.endTime])*6e4);y=new Date(new Date(this.currentDate()).setHours(0,0,0));l.currentDate=new Date(y.getTime()+this.getDifference(y)*6e4);a=JSON.parse(JSON.stringify(this._appointmentSettings));n.extend(!0,l.appointmentSettings,a);v=JSON.parse(JSON.stringify(this.model.blockoutSettings));n.extend(!0,l.blockoutSettings,v);var c=JSON.parse(JSON.stringify(l)),g={action:i,method:"post"},s=t.buildTag("form","",null,g),p=this.currentView()=="day"?"Day":this.currentView()=="month"?"Month":this.currentView()=="week"?"Week":this.currentView()=="agenda"?"Agenda":this.currentView()=="workweek"?"WorkWeek":"CustomView";if(this._ignoreFromAppointmentOnExport)for(f=0;f<this._ignoreFromAppointmentOnExport.length;f++)delete a[this._ignoreFromAppointmentOnExport[f]],delete v[this._ignoreFromAppointmentOnExport[f]];if(this._ignoreFromModelOnExport)for(f=0;f<this._ignoreFromModelOnExport.length;f++)delete c[this._ignoreFromModelOnExport[f]];if(delete c.appointmentSettings.dataSource,delete c.blockoutSettings.dataSource,t.raiseWebFormsServerEvents)w={model:c,originalEventType:r},b={appSetting:JSON.stringify(a),appId:u,processedApp:JSON.stringify(e),blockedApp:JSON.stringify(o),model:JSON.stringify(c),locale:this._getLocalizedLabels(p)+","+this._getLocalizedLabels("AllDay")+","+this._getLocalizedLabels("Date")+","+this._getLocalizedLabels("Time")+","+this._getLocalizedLabels("Event")},t.raiseWebFormsServerEvents(r,w,b);else{var nt={name:"ScheduleApps",type:"hidden",value:JSON.stringify(a)},tt=t.buildTag("input","",null,nt),it={name:"ScheduleBlockedApps",type:"hidden",value:JSON.stringify(v)},rt=t.buildTag("input","",null,it),ut={name:"ScheduleModel",type:"hidden",value:JSON.stringify(c)},ft=t.buildTag("input","",null,ut),e={name:"ScheduleProcesedApps",type:"hidden",value:JSON.stringify(e)},et=t.buildTag("input","",null,e),o={name:"ScheduleProcesedIntervalsApps",type:"hidden",value:JSON.stringify(o)},ot=t.buildTag("input","",null,o),st={name:"Locale",type:"hidden",value:this._getLocalizedLabels(p)+","+this._getLocalizedLabels("AllDay")+","+this._getLocalizedLabels("Date")+","+this._getLocalizedLabels("Time")+","+this._getLocalizedLabels("Event")},ht=t.buildTag("input","",null,st);s.append(ft);s.append(et);s.append(ot);s.append(ht);t.isNullOrUndefined(u)||(k={name:"AppointmentId",type:"hidden",value:u},d=t.buildTag("input","",null,k),s.append(d));s.append(tt);s.append(rt);s.append(this);n("body").append(s);s.submit()}return!0}});t.scheduleFeatures.resources&&n.extend(t.Schedule.prototype,t.scheduleFeatures.resources);t.scheduleFeatures.horizontal&&n.extend(t.Schedule.prototype,t.scheduleFeatures.horizontal);t.Schedule.Locale=t.Schedule.Locale||{};t.Schedule.Locale["default"]=t.Schedule.Locale["en-US"]={ReminderWindowTitle:"Reminder window",CreateAppointmentTitle:"Create Appointment",RecurrenceEditTitle:"Edit Repeat Appointment",RecurrenceEditMessage:"How would you like to change the appointment in the series?",RecurrenceEditOnly:"Only this appointment",RecurrenceEditSeries:"Entire series",PreviousAppointment:"Previous Appointment",NextAppointment:"Next Appointment",AppointmentSubject:"Subject",StartTime:"Start Time",EndTime:"End Time",AllDay:"All day",StartTimeZone:"Start TimeZone",EndTimeZone:"End TimeZone",Today:"Today",Recurrence:"Repeat",Done:"Done",Cancel:"Cancel",Ok:"OK",Repeat:"Repeat",RepeatBy:"Repeat by",RepeatEvery:"Repeat every",RepeatOn:"Repeat on",StartsOn:"Starts on",Ends:"Ends",Summary:"Summary",Daily:"Daily",Weekly:"Weekly",Monthly:"Monthly",Yearly:"Yearly",Every:"Every",EveryWeekDay:"Every weekday",Never:"Never",After:"After",Occurrence:"Occurrence(s)",On:"On",Edit:"Edit",RecurrenceDay:"Day(s)",RecurrenceWeek:"Week(s)",RecurrenceMonth:"Month(s)",RecurrenceYear:"Year(s)",The:"The",OfEvery:"of every",First:"First",Second:"Second",Third:"Third",Fourth:"Fourth",Last:"Last",WeekDay:"Weekday",WeekEndDay:"Weekendday",Subject:"Subject",Categorize:"Categories",DueIn:"Due In",DismissAll:"Dismiss All",Dismiss:"Dismiss",OpenItem:"Open Item",Snooze:"Snooze",Day:"Day",Week:"Week",WorkWeek:"Work Week",Month:"Month",AddEvent:"Add Event",CustomView:"Custom View",Agenda:"Agenda",Detailed:"Edit Appointment",EventBeginsin:"Appointment Begins in",Editevent:"Edit Appointment",Editseries:"Edit Series",Times:"times",Until:"until",Eventwas:"Appointment was",Hours:"hrs",Minutes:"mins",Overdue:"Overdue Appointment",Days:"day(s)",Event:"Event",Select:"select",Previous:"Previous",Next:"Next",Close:"Close",Delete:"Delete",Date:"Date",Showin:"Show in",Gotodate:"Go To Date",Resources:"RESOURCES",RecurrenceDeleteTitle:"Delete Repeat Appointment",Location:"Location",Priority:"Priority",RecurrenceAlert:"Alert",NoTitle:"No Title",OverFlowAppCount:"more appointment(s)",AppointmentIndicator:"Click for more appointments",WrongPattern:"The recurrence pattern is not valid",CreateError:"The duration of the appointment must be shorter than how frequently it occurs. Shorten the duration, or change the recurrence pattern in the Appointment Recurrence dialog box.",DragResizeError:"Cannot reschedule an occurrence of the recurring appointment if it skips over a later occurrence of the same appointment.",StartEndError:"End time should be greater than start time",MouseOverDeleteTitle:"Delete Appointment",DeleteConfirmation:"Are you sure you want to delete this appointment?",Time:"Time",EmptyResultText:"No suggestions",BlockIntervalAlertTitle:"Alert",BlockIntervalError:"The selected time interval has been blocked and is unavailable for selection."};t.Schedule.Actions={Add:"add",Save:"save",Delete:"delete",DeleteOccurrence:"deleteOccurrence",DeleteSeries:"deleteSeries",EditOccurrence:"editOccurrence",EditSeries:"editSeries"};t.Schedule.CurrentView={Day:"day",Week:"week",Workweek:"workweek",Month:"month",CustomView:"customview",Agenda:"agenda"};t.Schedule.TimeMode={Hour12:"12",Hour24:"24"};t.Schedule.Orientation={Vertical:"vertical",Horizontal:"horizontal"};t.Schedule.DayOfWeek={Sunday:"Sunday",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday"}}(jQuery,Syncfusion)});
