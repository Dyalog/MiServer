/*!
*  filename: ej.documenteditor.min.js
*  version : 14.3.0.49
*  Copyright Syncfusion Inc. 2001 - 2016. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min"],n):n()})(function(){var n=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};(function(t,i,r){var u=i.browserInfo().name=="msie"&&i.browserInfo().version<9,f;i.widget("ejDocumentEditor","ej.DocumentEditor",{_rootCSS:"e-document-editor",element:null,validTags:["div"],model:null,defaults:{documentChange:"",importExportSettings:{importUrl:""},selectionChange:"",zoomFactorChange:"",requestNavigate:""},_documentEditorHelper:null,_init:function(){this.element.css({"min-height":"200px","min-width":"200px"});u||(this._documentEditorHelper=new f.DocumentEditorHelper(this,i),this._documentEditorHelper.Document=this._createEmptyDocument())},_createEmptyDocument:function(){var n=new f.DocumentAdv(null),t=new f.SectionAdv(null),i=new f.ParagraphAdv(null);return t.Blocks.push(i),n.Sections.push(t),n},_loadDocument:function(n){this._documentEditorHelper.ParseDocument(n)},_raiseClientEvent:function(n,r){var e=this.model[n],s=[],o,u,h;if(s=r===null?"":r,e&&(typeof e=="string"&&(e=i.util.getObject(e,window)),t.isFunction(e))){if(n=="documentChange")o="";else if(n=="selectionChange")o="";else if(n=="zoomFactorChange")o="";else if(n=="requestNavigate"){u="";switch(s.Hyperlink.LinkType){case f.HyperlinkType.Bookmark:u="bookmark";break;case f.HyperlinkType.Email:u="email";break;case f.HyperlinkType.File:u="file";break;default:u="webpage"}h={navigationLink:s.Hyperlink.navigationLink,linkType:u};o={hyperlink:h}}this._trigger(n,o)}},load:function(n){var f,r;u||(f=this,this._documentEditorHelper.InitDocumentLoad(),t.ajaxSettings.type="POST",t.ajaxSettings.async=!0,i.browserInfo().name=="msie"&&i.browserInfo().version==9||(r=new FormData,r.append("files",n),t.ajaxSettings.data=r),t.ajaxSettings.processData=!1,t.ajaxSettings.contentType=!1,t.ajaxSettings.url=this.model.importExportSettings.importUrl,t.ajaxSettings.dataType="JSON",t.ajaxSettings.success=function(n){f._loadDocument(n)},t.ajax(t.ajaxSettings))},getCurrentPageNumber:function(){if(!u)return this._documentEditorHelper.CurrentPageNumber},getPageCount:function(){if(!u)return this._documentEditorHelper.PageCount},getZoomFactor:function(){if(!u)return this._documentEditorHelper.ZoomFactor},setZoomFactor:function(n){u||(this._documentEditorHelper.ZoomFactor=n)},print:function(){u||this._documentEditorHelper.Print()},find:function(n){u||n!=r&&n!=null&&n!=""&&this._documentEditorHelper.Find(n.toString(),0)}});u||function(i){var pi=function(){function n(){}return n.DocumentChange="documentChange",n.SelectionChange="selectionChange",n.ZoomFactorChange="zoomFactorChange",n.RequestNavigate="requestNavigate",n}(),p,du,b,h,yt,pt,tt,gu,o,dt,cu,it,gt,ut,kr,wi,rr,ur,fr,er,ri,or,sr,li,hr,lu,cr,lr,bi,at,c,ar,ki,w,ui,dr,ht,f,ai,k,ct,e,s,fi,a,au,gr,v,ei,rt,oi,vu,nu,tu,iu,yu,ft,pu,si,ti,ru,ii,di,ni,wt,gi,vr,l,et,vi,yr,yi,vt,hi,wu,pr,nr,bu,ku,uu,wr,g,bt,fu,eu,ci,lt,tr,d,kt,nt,nf,ou,u,tf,ot,su,st,y,hu,ir,br;i.DocumentEditorEvents=pi;p=function(){function n(){}return n.ContextMenuItem="ejDocumentEditor-ContextMenuItem",n.DisabledContextMenuItem="ejDocumentEditor-DisbledContextMenuItem",n.HiddenContextMenuItem="ejDocumentEditor-HiddenContextMenuIten",n.ContextMenuCopy="ejDocumentEditor-ContextMenu-Copy",n.ContextMenuCopyHyperlink="ejDocumentEditor-ContextMenu-CopyHyperlink",n.ContextMenuOpenHyperlink="ejDocumentEditro-ContextMenu-OpenHyperlink",n}();i.DocumentEditorThemeHelper=p;du=function(){function n(n,t){this.isDocumentLoaded=!0;this.currentPageNumber=1;this.pageCount=1;this.ej=null;this.DocumentEditor=n;this.ej=t;this.viewer=new ft(this);this.selection=new tu(this)}return Object.defineProperty(n.prototype,"DocumentEditorElement",{get:function(){return this.DocumentEditor.element[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ContainerId",{get:function(){return this.DocumentEditor._id},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CurrentPageNumber",{get:function(){return this.Viewer==null||this.Viewer.SelectionEndPage==null?1:this.Viewer.Pages.indexOf(this.Viewer.SelectionEndPage)+1},set:function(n){this.currentPageNumber=n;this.RaiseClientEvent(pi.SelectionChange,null)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"PageCount",{get:function(){return this.pageCount},set:function(n){this.pageCount=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ZoomFactor",{get:function(){return this.Viewer.ZoomFactor},set:function(n){this.Viewer.ZoomFactor=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Document",{get:function(){return this.document},set:function(n){this._onDocumentChanged(n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsDocumentLoaded",{get:function(){return this.isDocumentLoaded},set:function(n){n&&this.Document!=null&&this.Document.ClearUnlinkedFields();this.isDocumentLoaded=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Selection",{get:function(){return this.selection},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Viewer",{get:function(){return this.viewer},set:function(n){this.viewer=n},enumerable:!0,configurable:!0}),n.prototype.RaiseClientEvent=function(n,t){this.DocumentEditor._raiseClientEvent(n,t)},n.prototype.Print=function(){this.viewer.Print()},n.prototype.FireRequestNavigate=function(n){var t=new gr(n),i=new au(t);this.RaiseClientEvent(pi.RequestNavigate,i)},n.prototype._onDocumentChanged=function(n){this.document!=null&&this.document.Dispose();this.document=n;this.IsDocumentLoaded=!0;this.document!=null&&(this.document.OwnerControl=this,this.document.LayoutItems(this.viewer));this.PageCount=this.Viewer.Pages.Count>0?this.viewer.Pages.Count:1;this.RaiseClientEvent(pi.DocumentChange,null)},n.prototype.InitDocumentLoad=function(){this.IsDocumentLoaded=!1;this.viewer.ClearContainer()},n.prototype.ParseDocument=function(n){var t=new bi(null);n.BackgroundColor!=null&&n.BackgroundColor!=r&&(t.BackgroundColor=n.BackgroundColor);this._parseSections(n.Sections,t);this._parseAbstractList(n,t);this._parseList(n,t);this.Document=t;this.Selection.SelectRange(t.DocumentStart,t.DocumentStart,!0)},n.prototype._parseSections=function(n,t){for(var r,i=0;i<n.length;i++)r=new at(null),this._parseSectionFormat(n[i].SectionFormat,r.SectionFormat),this._parseHeaderFooter(n[i].HeaderFooters,r.HeaderFooters),this._parseTextBody(n[i].Blocks,r.Blocks),t.Sections.push(r)},n.prototype._parseSectionFormat=function(n,t){t.PageWidth=n.PageWidth;t.PageHeight=n.PageHeight;t.LeftMargin=n.LeftMargin;t.TopMargin=n.TopMargin;t.RightMargin=n.RightMargin;t.BottomMargin=n.BottomMargin;t.HeaderDistance=n.HeaderDistance;t.FooterDistance=n.FooterDistance;t.DifferentFirstPage=n.DifferentFirstPage;t.DifferentOddAndEvenPages=n.DifferentOddAndEvenPages},n.prototype._parseHeaderFooter=function(n,t){this._parseTextBody(n.Header.Blocks,t.Header.Blocks);this._parseTextBody(n.Footer.Blocks,t.Footer.Blocks);this._parseTextBody(n.EvenHeader.Blocks,t.EvenHeader.Blocks);this._parseTextBody(n.EvenFooter.Blocks,t.EvenFooter.Blocks);this._parseTextBody(n.FirstPageHeader.Blocks,t.FirstPageHeader.Blocks);this._parseTextBody(n.FirstPageFooter.Blocks,t.FirstPageFooter.Blocks)},n.prototype._parseTextBody=function(n,t){for(var i,r,u=0;u<n.length;u++)i=n[u],i.hasOwnProperty("Inlines")?(r=new f(null),i.hasOwnProperty("ParagraphFormat")&&this._parseParagraphFormat(i.ParagraphFormat,r.ParagraphFormat),i.hasOwnProperty("CharacterFormat")&&this._parseCharacterFormat(i.CharacterFormat,r.CharacterFormat),i.Inlines.length>0&&this._parseParagraph(i.Inlines,r),t.push(r)):i.hasOwnProperty("Rows")&&this._parseTable(i,t)},n.prototype._parseTable=function(n,t){var u=new w(null),i,r,f,e;for(this._parseTableFormat(n.TableFormat,u.TableFormat),u.Title=n.Title,u.Description=n.Description,i=0;i<n.Rows.length;i++)if(r=new ui(null),u.Rows.push(r),n.Rows[i].hasOwnProperty("RowFormat"))for(this._parseRowFormat(n.Rows[i].RowFormat,r.RowFormat),r.GridBefore=n.Rows[i].GridBefore,r.GridBeforeWidth=n.Rows[i].GridBeforeWidth,r.GridAfter=n.Rows[i].GridAfter,r.GridAfterWidth=n.Rows[i].GridAfterWidth,f=0;f<n.Rows[i].Cells.length;f++)e=new ht(null),r.Cells.push(e),n.Rows[i].Cells[f].hasOwnProperty("CellFormat")&&this._parseCellFormat(n.Rows[i].Cells[f].CellFormat,e.CellFormat),this._parseTextBody(n.Rows[i].Cells[f].Blocks,e.Blocks);u!=null&&t.push(u)},n.prototype._parseParagraph=function(n,t){for(var r,f,u,o,e,i=0;i<n.length;i++)r=n[i],r.hasOwnProperty("Text")?(f=new k(null),r.hasOwnProperty("CharacterFormat")&&this._parseCharacterFormat(r.CharacterFormat,f.CharacterFormat),f.Text=n[i].Text,t.Inlines.push(f)):r.hasOwnProperty("Imagestring")?(u=new ct(null,n[i].IsInlineImage,n[i].IsMetaFile),t.Inlines.push(u),u.ImageString=n[i].Imagestring,u.Width=n[i].Width,u.Height=n[i].Height,r.hasOwnProperty("CharacterFormat")&&this._parseCharacterFormat(r.CharacterFormat,u.CharacterFormat)):r.hasOwnProperty("HasFieldEnd")?(o=new s(null),o.HasFieldEnd=n[i].HasFieldEnd,t.Inlines.push(o)):r.hasOwnProperty("FieldCharacterType")&&(e=null,n[i].FieldCharacterType==1?e=new fi(null):n[i].FieldCharacterType==2&&(e=new a(null)),t.Inlines.push(e))},n.prototype._parseCharacterFormat=function(n,t){n.BaselineAlignment!=r&&n.BaselineAlignment!=null&&(t.BaselineAlignment=n.BaselineAlignment);n.Underline!=r&&n.Underline!=null&&(t.Underline=n.Underline);n.StrikeThrough!=r&&n.StrikeThrough!=null&&(t.StrikeThrough=n.StrikeThrough);n.FontSize!=r&&n.FontSize!=null&&(t.FontSize=n.FontSize);n.FontFamily!=r&&n.FontFamily!=null&&(t.FontFamily=n.FontFamily);n.Bold!=r&&n.Bold!=null&&(t.Bold=n.Bold);n.Italic!=r&&n.Italic!=null&&(t.Italic=n.Italic);n.HighlightColor!=r&&n.HighlightColor!=null&&(t.HighlightColor=n.HighlightColor);n.FontColor!=r&&n.FontColor!=null&&(t.FontColor=n.FontColor)},n.prototype._parseListCharacterFormat=function(n,t){n!=null&&(n.BaselineAlignment!=r&&n.BaselineAlignment!=null&&(t.BaselineAlignment=n.BaselineAlignment),n.Underline!=r&&n.Underline!=null&&(t.Underline=n.Underline),n.StrikeThrough!=r&&n.StrikeThrough!=null&&(t.StrikeThrough=n.StrikeThrough),n.FontSize!=r&&n.FontSize!=null&&(t.FontSize=n.FontSize),n.FontFamily!=r&&n.FontFamily!=null&&(t.FontFamily=n.FontFamily),n.Bold!=r&&n.Bold!=null&&(t.Bold=n.Bold),n.Italic!=r&&n.Italic!=null&&(t.Italic=n.Italic),n.HighlightColor!=r&&n.HighlightColor!=null&&(t.HighlightColor=n.HighlightColor),n.FontColor!=r&&n.FontColor!=null&&(t.FontColor=n.FontColor))},n.prototype._parseParagraphFormat=function(n,t){n.hasOwnProperty("ListFormat")&&this._parseListFormat(n,t.ListFormat);n.LeftIndent!=r&&n.LeftIndent!=null&&(t.LeftIndent=n.LeftIndent);n.RightIndent!=r&&n.RightIndent!=null&&(t.RightIndent=n.RightIndent);n.FirstLineIndent!=r&&n.FirstLineIndent!=null&&(t.FirstLineIndent=n.FirstLineIndent);n.LineSpacing!=r&&n.LineSpacing!=null&&(t.LineSpacing=n.LineSpacing);n.LineSpacingType!=r&&n.LineSpacingType!=null&&(t.LineSpacingType=n.LineSpacingType);n.BeforeSpacing!=r&&n.BeforeSpacing!=null&&(t.BeforeSpacing=n.BeforeSpacing);n.AfterSpacing!=r&&n.AfterSpacing!=null&&(t.AfterSpacing=n.AfterSpacing);n.TextAlignment!=r&&n.TextAlignment!=null&&(t.TextAlignment=n.TextAlignment)},n.prototype._parseListFormat=function(n,t){t.ListId=n.ListFormat.ListId;t.ListLevelNumber=n.ListFormat.ListLevelNumber},n.prototype._parseTableFormat=function(n,t){n.Borders!=r&&n.Borders!=null&&this._parseBorders(n.Borders,t.Borders);n.CellSpacing!=r&&n.CellSpacing!=null&&(t.CellSpacing=n.CellSpacing);n.LeftMargin!=r&&n.LeftMargin!=null&&(t.LeftMargin=n.LeftMargin);n.TopMargin!=r&&n.TopMargin!=null&&(t.TopMargin=n.TopMargin);n.RightMargin!=r&&n.RightMargin!=null&&(t.RightMargin=n.RightMargin);n.BottomMargin!=r&&n.BottomMargin!=null&&(t.BottomMargin=n.BottomMargin);n.LeftIndent!=r&&n.LeftIndent!=null&&(t.LeftIndent=n.LeftIndent);n.Shading!=r&&n.Shading!=null&&this._parseShading(n.Shading,t.Shading);n.TableAlignment!=r&&n.TableAlignment!=null&&(t.TableAlignment=n.TableAlignment);n.PreferredWidth!=r&&n.PreferredWidth!=null&&(t.PreferredWidth=n.PreferredWidth);n.PreferredWidthType!=r&&n.PreferredWidthType!=null&&(t.PreferredWidthType=n.PreferredWidthType)},n.prototype._parseShading=function(n,t){n.BackgroundColor!=null&&n.BackgroundColor!=r&&(t.BackgroundColor=n.BackgroundColor);n.ForegroundColor!=null&&n.ForegroundColor!=r&&(t.ForegroundColor=n.ForegroundColor);n.TextureStyle!=null&&n.TextureStyle!=r&&(t.TextureStyle=n.TextureStyle)},n.prototype._parseBorder=function(n,t){n.Color!=null&&n.Color!=r&&(t.Color=n.Color);n.LineStyle!=null&&n.LineStyle!=r&&(t.LineStyle=n.LineStyle);n.LineWidth!=null&&n.LineWidth!=r&&(t.LineWidth=n.LineWidth)},n.prototype._parseBorders=function(n,t){this._parseBorder(n.Left,t.Left);this._parseBorder(n.Right,t.Right);this._parseBorder(n.Top,t.Top);this._parseBorder(n.Bottom,t.Bottom);this._parseBorder(n.Vertical,t.Vertical);this._parseBorder(n.Horizontal,t.Horizontal);this._parseBorder(n.DiagonalDown,t.DiagonalDown);this._parseBorder(n.DiagonalUp,t.DiagonalUp)},n.prototype._parseCellFormat=function(n,t){n.Borders!=r&&n.Borders!=null&&this._parseBorders(n.Borders,t.Borders);n.IsSamePaddingAsTable?t.ClearMargins():this._parseCellMargin(n,t);n.CellWidth!=r&&n.CellWidth!=null&&(t.CellWidth=n.CellWidth);n.ColumnSpan!=r&&n.ColumnSpan!=null&&(t.ColumnSpan=n.ColumnSpan);n.RowSpan!=r&&n.RowSpan!=null&&(t.RowSpan=n.RowSpan);n.Shading!=r&&n.Shading!=null&&this._parseShading(n.Shading,t.Shading);n.VerticalAlignment!=r&&n.VerticalAlignment!=null&&(t.VerticalAlignment=n.VerticalAlignment);n.PreferredWidthType!=r&&n.PreferredWidthType!=null&&(t.PrefferedWidthType=n.PreferredWidthType);n.PreferredWidth!=r&&n.PreferredWidth!=null&&(t.PrefferedWidth=n.PreferredWidth)},n.prototype._parseCellMargin=function(n,t){n.LeftMargin!=r&&n.LeftMargin!=null&&(t.LeftMargin=n.LeftMargin);n.RightMargin!=r&&n.RightMargin!=null&&(t.RightMargin=n.RightMargin);n.TopMargin!=r&&n.TopMargin!=null&&(t.TopMargin=n.TopMargin);n.BottomMargin!=r&&n.BottomMargin!=null&&(t.BottomMargin=n.BottomMargin)},n.prototype._parseRowFormat=function(n,t){n.AllowBreakAcrossPages!=r&&n.AllowBreakAcrossPages!=null&&(t.AllowBreakAcrossPages=n.AllowBreakAcrossPages);n.IsHeader!=r&&n.IsHeader!=null&&(t.IsHeader=n.IsHeader);n.Height!=r&&n.Height!=null&&(t.Height=n.Height);n.HeightType!=r&&n.HeightType!=null&&(t.HeightType=n.HeightType);n.Borders!=r&&n.Borders!=null&&this._parseBorders(n.Borders,t.Borders)},n.prototype._parseAbstractList=function(n,t){for(var r,u,f,i=0;i<n.AbstractLists.length;i++)for(r=new yi(null),t.AbstractLists.push(r),r.AbstractListId=n.AbstractLists[i].AbstractListId,u=0;u<n.AbstractLists[i].Levels.length;u++)f=this._parseListLevel(n.AbstractLists[i].Levels[u]),r.Levels.push(f)},n.prototype._parseList=function(n,t){for(var r,i=0;i<n.Lists.length;i++)r=new yr(null),r.AbstractListId=n.Lists[i].AbstractListId,t.Lists.push(r),r.ListId=t.Lists.length-1,n.Lists[i].hasOwnProperty("LevelOverrides")!=null&&this._parseLevelOverride(n.Lists[i].LevelOverrides,r)},n.prototype._parseLevelOverride=function(n,t){for(var r,u,i=0;i<n.length;i++)r=new hi(null),u=n[i],r.StartAt=u.StartAt,r.LevelNumber=u.LevelNumber,n[i].OverrideListLevel!=null&&(r.OverrideListLevel=this._parseListLevel(u.OverrideListLevel)),t.LevelOverrides.push(r)},n.prototype._parseListLevel=function(n){var t=new vt(null);return n.ListLevelPattern==y.Bullet?(t.ListLevelPattern=y.Bullet,t.NumberFormat=n.NumberFormat):(t.ListLevelPattern=n.ListLevelPattern,t.StartAt=n.StartAt,t.NumberFormat=n.NumberFormat,t.RestartLevel=n.RestartLevel>=0?n.RestartLevel:n.LevelNumber),t.FollowCharacter=n.FollowCharacter,this._parseListCharacterFormat(n.CharacterFormat,t.CharacterFormat),this._parseParagraphFormat(n.ParagraphFormat,t.ParagraphFormat),t},n.prototype.Find=function(n,t){var i=yt.StringToRegex(n,t);return this.Document==null||!this.isDocumentLoaded?!1:this.Document.Find(i,t,!0,this)},n}();i.DocumentEditorHelper=du;b=function(){function n(){}return n.Round=function(n,t){for(var i=n,r=0;r<t;r++)i=i*10;for(i=Math.round(i),r=0;r<t;r++)i=i/10;return i},n}();i.MathHelper=b;h=function(){function n(){}return Object.defineProperty(n,"ParagraphMark",{get:function(){return"¶"},enumerable:!0,configurable:!0}),n.GetParagraphMarkSize=function(t){var r=n.GetWidth(this.ParagraphMark,t),i=n.GetHeight(t);return{Width:r,Height:i.Height,BaselineOffset:i.BaselineOffset}},n.GetTextSize=function(t,i){t.Width=n.GetWidth(t.Text,i);var r=n.GetHeight(i);t.Height=r.Height;t.BaselineOffset=r.BaselineOffset},n.UpdateTextSize=function(t){var i=t.ListLevel.CharacterFormat,u=t.Paragraph.CharacterFormat,r;i.FontSize=i.FontSize==11?u.FontSize:i.FontSize;i.FontFamily=i.FontFamily=="verdana"?u.FontFamily:i.FontFamily;t.Width=n.GetWidth(t.Text,i);r=n.GetHeight(i);t.Height=r.Height;t.BaselineOffset=r.BaselineOffset},n.MeasureText=function(t,i){var u=n.GetWidth(t,i),r=n.GetHeight(i);return{Width:u,Height:r.Height,BaselineOffset:r.BaselineOffset}},n.MeasureTextExcludIngSpaceAtEnd=function(t,i){var u=n.GetWidth(t.replace(/\s\s*$/,""),i),r=n.GetHeight(i);return{Width:u,Height:r.Height,BaselineOffset:r.BaselineOffset}},n.GetHeight=function(t){var e=0,o=0,i=document.createElement("span"),f,r,u,s,h;return i.id="tempSpan",i.style.whiteSpace="nowrap",i.innerText="m",n.ApplyStyle(i,t),f=document.getElementsByTagName("body"),f!=null&&f.length>0&&(r=document.createElement("div"),r.style.display="inline-block",u=document.createElement("div"),u.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),r.appendChild(i),r.appendChild(u),document.body.appendChild(r),e=i.getBoundingClientRect().height,s=i.getBoundingClientRect().top,h=u.getBoundingClientRect().top,o=h-s,document.body.removeChild(r)),{Height:e,BaselineOffset:o}},n.GetWidth=function(n,t){var o=document.createElement("canvas"),i=o.getContext("2d"),r="",u="",f="",e=11;return r=t.Bold?"bold":"",u=t.Italic?"italic":"",f=t.FontFamily,e=t.FontSize==0?.5:t.FontSize/(t.BaselineAlignment==lt.Normal?1:1.5),i.font=r+" "+u+" "+e+"px "+f,i.measureText(n).width},n.ApplyStyle=function(n,t){if(n!=r&&n!=null&&t!=r&&t!=null){t.Bold&&(n.style.fontWeight="bold");t.Italic&&(n.style.fontStyle="italic");t.FontFamily!=""&&(n.style.fontFamily=t.FontFamily);var i=t.FontSize;i<=.5&&(i=.5);n.style.fontSize=i.toString()+"px"}},n}();i.TextHelper=h;yt=function(){function n(){}return n.StringToRegex=function(n,t){return(t==br.WholeWord||t==br.CaseSensitiveWholeWord)&&(n=this.WORD_BEFORE+n+this.WORD_AFTER),new RegExp(n,t==br.CaseSensitive||t==br.CaseSensitiveWholeWord?"g":"ig")},n.IsPatternEmpty=function(n){var i=this.WORD_BEFORE+this.WORD_AFTER,t=n.toString();return t.length==0||t==i},n.AddCssStyle=function(n){var t=document.createElement("style");t.style.cssText?t.style.cssText=n:t.appendChild(document.createTextNode(n));document.getElementsByTagName("head")[0].appendChild(t)},n.IsVeryDark=function(n){n=n.substring(1);var t=parseInt(n.substr(0,2),16),i=parseInt(n.substr(2,2),16),r=parseInt(n.substr(4,2),16),u=(t*299+i*587+r*114)/1e3;return u<=60},n.GetHighlightColorCode=function(n){var t="#ffffff";switch(n){case d.Yellow:t="#ffff00";break;case d.BrightGreen:t="#00ff00";break;case d.Turquoise:t="#00ffff";break;case d.Pink:t="#ff00ff";break;case d.Blue:t="#0000ff";break;case d.Red:t="#ff0000";break;case d.DarkBlue:t="#000080";break;case d.Teal:t="#008080";break;case d.Green:t="#008000";break;case d.Violet:t="#800080";break;case d.DarkRed:t="#800000";break;case d.DarkYellow:t="#808000";break;case d.Gray50:t="#808080";break;case d.Gray25:t="#c0c0c0";break;case d.Black:t="#000000"}return t},n.GetHtmlTextAlign=function(n){switch(n){case nt.Center:return"center";case nt.Right:return"right";case nt.Justify:return"justify";default:return"left"}},n.WORD_BEFORE="(?<=^|W|\t)",n.WORD_AFTER="(?=$|W|\t)",n}();i.HelperMethods=yt;pt=function(){function n(){}return Object.defineProperty(n,"Maroon",{get:function(){return"maroon"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Red",{get:function(){return"red"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Orange",{get:function(){return"orange"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Yellow",{get:function(){return"yellow"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Olive",{get:function(){return"olive"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Fuchsia",{get:function(){return"fuchsia"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Lime",{get:function(){return"lime"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"White",{get:function(){return"white"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Green",{get:function(){return"green"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Navy",{get:function(){return"navy"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Blue",{get:function(){return"blue"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Aqua",{get:function(){return"aqua"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Teal",{get:function(){return"teal"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Black",{get:function(){return"black"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Silver",{get:function(){return"silver"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Gray",{get:function(){return"gray"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Purple",{get:function(){return"purple"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"XXSmall",{get:function(){return"xx-small"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"XSmall",{get:function(){return"x-small"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Medium",{get:function(){return"medium"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"XLarge",{get:function(){return"x-large"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"XXLarge",{get:function(){return"xx-large"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Small",{get:function(){return"small"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Smaller",{get:function(){return"smaller"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Larger",{get:function(){return"bigger"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Large",{get:function(){return"large"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Underline",{get:function(){return"underline"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LineThrough",{get:function(){return"line-through"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LineHeight",{get:function(){return"line-height"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SubScript",{get:function(){return"sub"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SuperScript",{get:function(){return"super"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Font",{get:function(){return"font"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LeftIndent",{get:function(){return"left-indent"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"TextIndent",{get:function(){return"text-indent"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FontFamily",{get:function(){return"font-family"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FontSize",{get:function(){return"font-size"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FontStyle",{get:function(){return"font-style"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FontWeight",{get:function(){return"font-weight"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"TextDecoration",{get:function(){return"text-decoration"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"TextAlign",{get:function(){return"text-align"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SubSuperScripts",{get:function(){return"vertical-align"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Background",{get:function(){return"background-color"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Color",{get:function(){return"color"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"HyperlinkColor",{get:function(){return"hyperlinkcolor"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Baseline",{get:function(){return"baseline"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ListType",{get:function(){return"listType"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Margin",{get:function(){return"margin"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Border",{get:function(){return"border"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"BgColor",{get:function(){return"bgcolor"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Align",{get:function(){return"align"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Cm",{get:function(){return"cm"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Mm",{get:function(){return"mm"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Px",{get:function(){return"px"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"In",{get:function(){return"in"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Ex",{get:function(){return"ex"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Em",{get:function(){return"em"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Pt",{get:function(){return"pt"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Pc",{get:function(){return"pc"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Percentage",{get:function(){return"%"},enumerable:!0,configurable:!0}),n}();i.CssConstants=pt;tt=function(){function n(){}return Object.defineProperty(n,"Dot",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(n,"OpenBrace",{get:function(){return"{"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CloseBrace",{get:function(){return"}"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Colon",{get:function(){return":"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SemiColon",{get:function(){return";"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Equal",{get:function(){return"="},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Quotes",{get:function(){return'"'},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LessthanSymbol",{get:function(){return"<"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"GreaterthanSymbol",{get:function(){return">"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Endslash",{get:function(){return"/"},enumerable:!0,configurable:!0}),n}();i.HTMLOperators=tt;gu=function(){function n(){}return Object.defineProperty(n,"HtmlAsciiCodeTable",{get:function(){return n.htmlAsciiCodeTable==null&&(n.htmlAsciiCodeTable=new dt,n.htmlNameTable=new dt,n.AddHtmlAsciiSymbols(),n.AddHtmlNames()),n.htmlAsciiCodeTable},enumerable:!0,configurable:!0}),Object.defineProperty(n,"HtmlNameTable",{get:function(){return n.htmlNameTable==null&&(n.htmlAsciiCodeTable=new dt,n.htmlNameTable=new dt,n.AddHtmlAsciiSymbols(),n.AddHtmlNames()),n.htmlNameTable},enumerable:!0,configurable:!0}),n.AddHtmlAsciiSymbols=function(){var r=[],i,t;for(r=[" ",'""',"!","#","$","%","&","'","(",")","*"," +",", "," - ",".","/ ","0","1","2","3","4","5","6","7","8","9",":",";"," < ","="," > "," ? ","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[",'"',"]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~"," ","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","","­®","¯","°","±","²","³","´","µ","¶","•","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","×","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ","Œ","œ","Š","š","Ÿ","ƒ","–","—","‘","’","‚","“","”","„","†","‡","•","…","‰","€","™"],i=-1,t=32;t<=8482;t++)if(t>126&&t<160||t>255&&t<338||t>339&&t<352||t>353&&t<376||t>376&&t<402||t>402&&t<8211||t>8212&&t<8216||t==8219||t==8223||t>8226&&t<8230||t>8230&&t<8240||t>8240&&t<8364||t>8364&&t<8482)continue;else i++,i<r.length&&n.HtmlAsciiCodeTable.Add("&#"+t+";",r[i])},n.AddHtmlNames=function(){n.HtmlNameTable.Add("&nbsp;"," ");n.HtmlNameTable.Add("&emsp;","\t");n.HtmlNameTable.Add("&#160;"," ");n.HtmlNameTable.Add("&lt;","<");n.HtmlNameTable.Add("&gt;",">");n.HtmlNameTable.Add("&amp;","&");n.HtmlNameTable.Add("&quot;",'"');n.HtmlNameTable.Add("&iexcl;","¡");n.HtmlNameTable.Add("&cent;","¢");n.HtmlNameTable.Add("&pound;","£");n.HtmlNameTable.Add("&curren;","¤");n.HtmlNameTable.Add("&yen;","¥");n.HtmlNameTable.Add("&brvbar;","¦");n.HtmlNameTable.Add("&sect;","§");n.HtmlNameTable.Add("&uml;","¨");n.HtmlNameTable.Add("&copy;","©");n.HtmlNameTable.Add("&ordf;","ª");n.HtmlNameTable.Add("&laquo;","«");n.HtmlNameTable.Add("&not;","¬");n.HtmlNameTable.Add("&reg;","­®");n.HtmlNameTable.Add("&macr;","¯");n.HtmlNameTable.Add("&deg;","°");n.HtmlNameTable.Add("&plusmn;","±");n.HtmlNameTable.Add("&sup2;","²");n.HtmlNameTable.Add("&sup3;","³");n.HtmlNameTable.Add("&acute;","´");n.HtmlNameTable.Add("&micro;","µ");n.HtmlNameTable.Add("&para;","¶");n.HtmlNameTable.Add("&middot;","·");n.HtmlNameTable.Add("&cedil;","¸");n.HtmlNameTable.Add("&sup1;","¹");n.HtmlNameTable.Add("&ordm;","º");n.HtmlNameTable.Add("&raquo;","»");n.HtmlNameTable.Add("&frac14;","¼");n.HtmlNameTable.Add("&frac12;","½");n.HtmlNameTable.Add("&frac34;","¾");n.HtmlNameTable.Add("&iquest;","¿");n.HtmlNameTable.Add("&Agrave;","À");n.HtmlNameTable.Add("&Aacute;","Á");n.HtmlNameTable.Add("&Acirc;","Â");n.HtmlNameTable.Add("&Atilde;","Ã");n.HtmlNameTable.Add("&Auml;","Ä");n.HtmlNameTable.Add("&Aring;","Å");n.HtmlNameTable.Add("&AElig;","Æ");n.HtmlNameTable.Add("&Ccedil;","Ç");n.HtmlNameTable.Add("&Egrave;","È");n.HtmlNameTable.Add("&Eacute;","É");n.HtmlNameTable.Add("&Ecirc;","Ê");n.HtmlNameTable.Add("&Euml;","Ë");n.HtmlNameTable.Add("&Igrave;","Ì");n.HtmlNameTable.Add("&Iacute;","Í");n.HtmlNameTable.Add("&Icirc;","Î");n.HtmlNameTable.Add("&Iuml;","Ï");n.HtmlNameTable.Add("&ETH;","Ð");n.HtmlNameTable.Add("&Ntilde;","Ñ");n.HtmlNameTable.Add("&Ograve;","Ò");n.HtmlNameTable.Add("&Oacute;","Ó");n.HtmlNameTable.Add("&Ocirc;","Ô");n.HtmlNameTable.Add("&Otilde;","Õ");n.HtmlNameTable.Add("&Ouml;","Ö");n.HtmlNameTable.Add("&times;","×");n.HtmlNameTable.Add("&Oslash;","Ø");n.HtmlNameTable.Add("&Ugrave;","Ù");n.HtmlNameTable.Add("&Uacute;","Ú");n.HtmlNameTable.Add("&Ucirc;","Û");n.HtmlNameTable.Add("&Uuml;","Ü");n.HtmlNameTable.Add("&Yacute;","Ý");n.HtmlNameTable.Add("&THORN;","Þ");n.HtmlNameTable.Add("&szlig;","ß");n.HtmlNameTable.Add("&agrave;","à");n.HtmlNameTable.Add("&aacute;","á");n.HtmlNameTable.Add("&acirc;","â");n.HtmlNameTable.Add("&atilde;","ã");n.HtmlNameTable.Add("&auml;","ä");n.HtmlNameTable.Add("&aring;","å");n.HtmlNameTable.Add("&aelig;","æ");n.HtmlNameTable.Add("&ccedil;","ç");n.HtmlNameTable.Add("&egrave;","è");n.HtmlNameTable.Add("&eacute;","é");n.HtmlNameTable.Add("&ecirc;","ê");n.HtmlNameTable.Add("&euml;","ë");n.HtmlNameTable.Add("&igrave;","ì");n.HtmlNameTable.Add("&iacute;","í");n.HtmlNameTable.Add("&icirc;","î");n.HtmlNameTable.Add("&iuml;","ï");n.HtmlNameTable.Add("&eth;","ð");n.HtmlNameTable.Add("&ntilde;","ñ");n.HtmlNameTable.Add("&ograve;","ò");n.HtmlNameTable.Add("&oacute;","ó");n.HtmlNameTable.Add("&ocirc;","ô");n.HtmlNameTable.Add("&otilde;","õ");n.HtmlNameTable.Add("&ouml;","ö");n.HtmlNameTable.Add("&divide;","÷");n.HtmlNameTable.Add("&oslash;","ø");n.HtmlNameTable.Add("&ugrave;","ù");n.HtmlNameTable.Add("&uacute;","ú");n.HtmlNameTable.Add("&ucirc;","û");n.HtmlNameTable.Add("&uuml;","ü");n.HtmlNameTable.Add("&yacute;","ý");n.HtmlNameTable.Add("&thorn;","þ");n.HtmlNameTable.Add("&yuml;","ÿ");n.HtmlNameTable.Add("&OElig;","Œ");n.HtmlNameTable.Add("&oelig;","œ");n.HtmlNameTable.Add("&Scaron;","Š");n.HtmlNameTable.Add("&scaron;","š");n.HtmlNameTable.Add("&Yuml;","Ÿ");n.HtmlNameTable.Add("&fnof;","ƒ");n.HtmlNameTable.Add("&ndash;","–");n.HtmlNameTable.Add("&mdash;","—");n.HtmlNameTable.Add("&lsquo;","‘");n.HtmlNameTable.Add("&rsquo;","’");n.HtmlNameTable.Add("&ldquo;","“");n.HtmlNameTable.Add("&rdquo;","”");n.HtmlNameTable.Add("&bdquo;","„");n.HtmlNameTable.Add("&dagger;","†");n.HtmlNameTable.Add("&ddagger;","‡");n.HtmlNameTable.Add("&bullet;","•");n.HtmlNameTable.Add("&hellip;","…");n.HtmlNameTable.Add("&permil;","‰");n.HtmlNameTable.Add("&trade;","™");n.HtmlNameTable.Add("&euro;","€")},n.htmlAsciiCodeTable=null,n.htmlNameTable=null,n}();i.HtmlAsciiCodesInfo=gu;o=function(t){function i(){t.apply(this,arguments)}return n(i,t),Object.defineProperty(i.prototype,"Count",{get:function(){return this.length!=r&&this.length!=null?this.length:0},enumerable:!0,configurable:!0}),i.prototype.Add=function(n){if(1)return t.prototype.push.call(this,n),1},i.prototype.Insert=function(n,t){if(n==this.length){this.Add(t);return}n>-1&&n<this.length&&(this.shiftItems(n,!0),this[n]=t,this.length=this.length+1)},i.prototype.Remove=function(n){var i=this.indexOf(n);return i>-1&&i<this.length?(this.shiftItems(i,!1),t.prototype.pop.call(this),!0):!1},i.prototype.RemoveAt=function(n){if(n>-1&&n<this.length){var i=this[n];return this.shiftItems(n,!1),t.prototype.pop.call(this),!0}return!1},i.prototype.Contains=function(n){var t=this.indexOf(n);return t>-1&&t<this.length},i.prototype.Clear=function(){for(var n=this.length;n>0;n--)this.RemoveAt(n-1)},i.prototype.ToList=function(){for(var t=new i,n=0;n<this.length;n++)t.Add(this[n]);return t},i.prototype.IndexOf=function(n){return this.indexOf(n)},i.prototype.First=function(){return this.length>0?this[0]:null},i.prototype.Last=function(){return this.length>0?this[this.length-1]:null},i.prototype.shiftItems=function(n,t){var i;if(t)for(i=this.length;i>n;i--)this[i]=this[i-1];else for(i=n;i<this.length-1;i++)this[i]=this[i+1]},i.prototype.Sort=function(){t.prototype.sort.call(this,function(n,t){return n-t})},i}(Array);i.List=o;dt=function(){function n(){this.keys=new o;this.values=new o}return Object.defineProperty(n.prototype,"Count",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Keys",{get:function(){return this.keys.ToList()},enumerable:!0,configurable:!0}),n.prototype.Add=function(n,t){if(n==r||n==null||t==r||t==null)throw new ReferenceError("Provided key or value is not valid.");var i=this.keys.indexOf(n);if(i<0||i>this.keys.length-1)return this.keys.Add(n),this.values.Add(t),1;throw new RangeError("An item with the same key has already been added.");},n.prototype.Get=function(n){if(n==r||n==null)throw new ReferenceError("Provided key is not valid.");var t=this.keys.indexOf(n);if(t<0||t>this.keys.length-1)throw new RangeError("No item with the specified key has been added.");else return this.values[t]},n.prototype.Set=function(n,t){if(n==r||n==null)throw new ReferenceError("Provided key is not valid.");var i=this.keys.indexOf(n);if(i<0||i>this.keys.length-1)throw new RangeError("No item with the specified key has been added.");else this.values[i]=t},n.prototype.Remove=function(n){if(n==r||n==null)throw new ReferenceError("Provided key is not valid.");var t=this.keys.indexOf(n);if(t<0||t>this.keys.length-1)throw new RangeError("No item with the specified key has been added.");else return this.keys.RemoveAt(t),this.values.RemoveAt(t),!0},n.prototype.ContainsKey=function(n){if(n==r||n==null)throw new ReferenceError("Provided key is not valid.");var t=this.keys.indexOf(n);return t<0||t>this.keys.length-1?!1:!0},n.prototype.Clear=function(){this.keys.Clear();this.values.Clear()},n}();i.Dictionary=dt;cu=function(t){function i(){t.apply(this,arguments);this.maxBaseLineOffset=0;this.maxTextElementHeight=Number.NaN;this.maxTextElementBaselineOffset=0;this.SkipClipImage=!1}return n(i,t),Object.defineProperty(i.prototype,"MaxBaselineOffset",{get:function(){return this.maxBaseLineOffset},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"MaxTextElementHeight",{get:function(){return this.maxTextElementHeight},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"MaxTextElementBaselineOffset",{get:function(){return this.maxTextElementBaselineOffset},enumerable:!0,configurable:!0}),i.prototype.push=function(n){return this.Add(n)},i.prototype.Add=function(n){if(n!=r&&n!=null)return t.prototype.push.call(this,n),this.UpdateMaxElementHeight(n),1},i.prototype.Insert=function(n,t){if(n==this.length){this.Add(t);return}n>-1&&n<this.length&&(this.shiftItems(n,!0),this[n]=t,this.length=this.length+1,this.UpdateMaxElementHeight(t))},i.prototype.Remove=function(n){var i=this.indexOf(n);return i>-1&&i<this.length?(this.shiftItems(i,!1),t.prototype.pop.call(this),!0):!1},i.prototype.RemoveAt=function(n){if(n>-1&&n<this.length){var i=this[n];return this.shiftItems(n,!1),t.prototype.pop.call(this),!0}return!1},i.prototype.Contains=function(n){var t=this.indexOf(n);return t>-1&&t<this.length},i.prototype.ToList=function(){for(var t=new o,n=0;n<this.length;n++)t.Add(this[n]);return t},i.prototype.Clear=function(){t.prototype.Clear.call(this);this.maxBaseLineOffset=0;this.maxTextElementHeight=Number.NaN;this.maxTextElementBaselineOffset=0;this.SkipClipImage=!1},i.prototype.UpdateMaxElement=function(){this.maxBaseLineOffset=0;this.maxTextElementHeight=Number.NaN;this.maxTextElementBaselineOffset=0;for(var n=0;n<this.Count;n++)this.UpdateMaxElementHeight(this[n])},i.prototype.UpdateMaxElementHeight=function(n){n instanceof l||n instanceof et?(isNaN(this.maxTextElementHeight)&&(this.maxTextElementHeight=0),this.maxTextElementHeight<n.Height&&(this.maxTextElementHeight=n.Height,this.maxTextElementBaselineOffset=n instanceof l?n.BaselineOffset:n.BaselineOffset),this.maxBaseLineOffset<this.maxTextElementBaselineOffset&&(this.maxBaseLineOffset=this.maxTextElementBaselineOffset)):this.maxBaseLineOffset<n.Height&&(this.maxBaseLineOffset=n.Height)},i}(o);i.ElementCollection=cu;it=function(){function n(n){this.ownerBase=n}return Object.defineProperty(n.prototype,"OwnerBase",{get:function(){return this.ownerBase},enumerable:!0,configurable:!0}),n.prototype.SetOwner=function(n){this.ownerBase=n},n.prototype.SetOwnerBase=function(n){this.ownerBase=n},n}();i.BaseNode=it;gt=function(t){function i(n){t.call(this,n)}return n(i,t),Object.defineProperty(i.prototype,"Owner",{get:function(){return this.OwnerBase},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"NextNode",{get:function(){return this.Owner instanceof ut?this.Owner.ChildNodes.GetNextNode(this):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PreviousNode",{get:function(){return this.Owner instanceof ut?this.Owner.ChildNodes.GetPreviousNode(this):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsComposite",{get:function(){return this instanceof ut},enumerable:!0,configurable:!0}),i.prototype.SetOwner=function(n){if(this.OwnerBase!=n&&this.OwnerBase instanceof ut){if(this instanceof e){var t=this;t.IsLinkedFieldCharacter()&&t.UnlinkFieldCharacter("",!1);this.OwnerBase.RemoveFieldCharacter(t);t.CheckUnlinkFieldCharacter("",!1)}this.OwnerBase.ChildNodes.Contains(this)&&this.OwnerBase.ChildNodes.Remove(this)}this.SetOwnerBase(n);n instanceof ut&&this instanceof e&&n.AttachFieldCharacter(this)},i.prototype.GetIndexInOwnerCollection=function(){var n=this.Owner;return n!=null?n.ChildNodes.indexOf(this):-1},i.prototype.GetTopLevelOwner=function(){for(var n=this;n.Owner instanceof i;)if(n=n.Owner,n instanceof bi)break;return n},i.prototype.GetOwnerDocument=function(){return this.GetTopLevelOwner()},i}(it);i.Node=gt;ut=function(t){function i(n){t.call(this,n);this.Fields=new o;this.FieldCharacter=new o}return n(i,t),i.prototype.SetOwner=function(n){this.OwnerBase!=n&&this.OwnerBase instanceof i&&(this.Fields.Count>0&&this.OwnerBase.RemoveFields(this),this.FieldCharacter.Count>0&&this.OwnerBase.RemoveFieldCharacter(this),this.OwnerBase.ChildNodes.Contains(this)&&this.OwnerBase.ChildNodes.Remove(this));this.SetOwnerBase(n);n instanceof i&&(this.FieldCharacter.Count>0&&this.Owner.AttachFieldCharacter(this),this.Fields.Count>0&&n.AddFields(this))},i.prototype.RemoveField=function(n){this.Fields.Remove(n);this.Owner instanceof i&&!(this instanceof c)&&this.Owner.RemoveField(n)},i.prototype.RemoveFields=function(n){var r,t,i,u;if(!(n instanceof c))for(r=n.GetHierarchicalIndex(""),t=0;t<n.Fields.Count;t++)i=n.Fields[t],u=n.Fields.Count,i.IsUnlinkFieldCharacters(r)&&i.UnlinkFieldCharacter(r,!0),this.RemoveField(i),u>n.Fields.Count&&(t-=u-n.Fields.Count),t<-1&&(t=-1)},i.prototype.ClearUnlinkedFields=function(){var i=this.GetOwnerDocument(),n,t;if(i!=null)for(n=0;n<this.FieldCharacter.Count;n++)t=this.FieldCharacter[n],t.OwnerParagraph.Inlines.Remove(t),this.FieldCharacter.Remove(t),n--},i.prototype.AttachFieldCharacter=function(n){var t,r,u;if(n instanceof e)this.LinkFieldCharacters(n,n)||this.AddFieldCharacter(n);else if(n instanceof i){if(n instanceof c)return;for(t=0;t<n.FieldCharacter.Count;t++)r=n.FieldCharacter.Count,u=n.FieldCharacter[t],this.LinkFieldCharacters(u,n)?(r>n.FieldCharacter.Count&&(t-=r-n.FieldCharacter.Count),t<-1&&(t=-1)):this.AddFieldCharacter(u)}},i.prototype.LinkFieldCharacters=function(n,t){var f={nestingLevel:0},r,i,u;if(n instanceof s){if(r=n,r.fieldEnd==null&&this.LinkFieldTraversingForward(r,f,t),r.fieldEnd!=null)return r.AddToLinkedFields(),!0}else if(n instanceof fi){if(i=n,i.fieldBegin==null&&this.LinkFieldTraversingBackward(i,f,t),i.fieldBegin!=null&&(i.fieldEnd==null&&this.LinkFieldTraversingForward(i.fieldBegin,f,t)&&(i.fieldEnd=i.fieldBegin.fieldEnd),i.fieldEnd!=null))return i.fieldBegin.AddToLinkedFields(),!0}else if(n instanceof a&&(u=n,u.fieldBegin==null&&this.LinkFieldTraversingBackward(u,f,t),u.fieldBegin!=null))return u.fieldBegin.AddToLinkedFields(),!0;return!1},i.prototype.LinkFieldTraversingForward=function(n,t,r){var o=0,f,u,h;for(this.ChildNodes.indexOf(r)!=-1&&(o=this.ChildNodes.indexOf(r)+1),f=o;f<this.ChildNodes.length;f++)if(u=this.ChildNodes[f],u instanceof i){if(h=u.LinkFieldTraversingForward(n,t,null),n.fieldEnd!=null||h)return!0}else if(u instanceof e)if(u instanceof s&&n!=u&&t.nestingLevel++,u instanceof a){if(t.nestingLevel==0)return u.fieldBegin==null&&(n.fieldEnd=u),n.fieldEnd!=null;t.nestingLevel--}else if(t.nestingLevel==0&&n.fieldSeparator==null&&u instanceof fi)if(u.fieldBegin==null){if(n.fieldSeparator=u,u.fieldEnd!=null)return n.fieldEnd=u.fieldEnd,!0}else return!1;return this.Owner instanceof i&&!(this instanceof c)?this.Owner.LinkFieldTraversingForward(n,t,this):!0},i.prototype.LinkFieldTraversingBackward=function(n,t,r){var f,l,h,o,u,v;if(n instanceof a){for(f=n,h=this.ChildNodes.length-1,this.ChildNodes.indexOf(r)!=-1&&(h=this.ChildNodes.indexOf(r)-1),o=h;o>=0;o--)if(u=this.ChildNodes[o],u instanceof i){if(v=u.LinkFieldTraversingBackward(f,t,null),f.fieldBegin!=null||v)return!0}else if(u instanceof e)if(u instanceof a&&f!=u&&t.nestingLevel++,u instanceof s){if(t.nestingLevel==0)return u.fieldEnd==null&&(f.fieldBegin=u),f.fieldBegin!=null;t.nestingLevel--}else if(t.nestingLevel==0)if(u.fieldEnd==null){if(f.fieldSeparator=u,u.fieldBegin!=null)return f.fieldBegin=u.fieldBegin,!0}else return!1;return this.Owner instanceof i&&!(this instanceof c)?this.Owner.LinkFieldTraversingBackward(f,t,this):!0}if(n instanceof fi){for(l=n,h=this.ChildNodes.length-1,this.ChildNodes.indexOf(r)!=-1&&(h=this.ChildNodes.indexOf(r)-1),o=h;o>=0;o--)if(u=this.ChildNodes[o],u instanceof i){if(v=u.LinkFieldTraversingBackward(l,t,null),l.fieldBegin!=null||v)return!0}else if(u instanceof e)if(u instanceof a&&t.nestingLevel++,u instanceof s){if(t.nestingLevel==0)return u.fieldSeparator==null&&(l.fieldBegin=u),l.fieldBegin!=null;t.nestingLevel--}else if(t.nestingLevel==0)return!1;return this.Owner instanceof i&&!(this instanceof c)?this.Owner.LinkFieldTraversingBackward(l,t,this):!0}},i.prototype.AddFields=function(n){if(n instanceof s)this.Fields.Add(n),this.Owner instanceof i&&!(this instanceof c)&&this.Owner.AddFields(n);else if(n instanceof i){if(n instanceof c)return;for(var t=0;t<n.Fields.Count;t++)this.AddFields(n.Fields[t])}},i.prototype.AddFieldCharacter=function(n){if(n instanceof e)this.FieldCharacter.Add(n),this.Owner instanceof i&&!(this instanceof c)&&this.Owner.AttachFieldCharacter(n);else if(n instanceof i){if(n instanceof c)return;for(var t=0;t<n.FieldCharacter.Count;t++)this.AddFieldCharacter(n.FieldCharacter[t])}},i.prototype.RemoveFieldCharacter=function(n){var f,t,r,u;if(n instanceof e)this.FieldCharacter.Contains(n)&&(this.FieldCharacter.Remove(n),this.Owner instanceof i&&!(this instanceof c)&&this.Owner.RemoveFieldCharacter(n));else if(n instanceof i){if(n instanceof c)return;for(f=n.GetHierarchicalIndex(""),t=0;t<n.FieldCharacter.Count;t++)r=n.FieldCharacter[t],u=n.FieldCharacter.Count,r.CheckUnlinkFieldCharacter(f,!0),this.RemoveFieldCharacter(r),u>n.FieldCharacter.Count&&(t-=u-n.FieldCharacter.Count),t<-1&&(t=-1)}},i.prototype.GetHierarchicalIndex=function(n){return this.Owner instanceof i&&(n=this instanceof ar?"HF;"+n:this.GetIndexInOwnerCollection()+";"+n,!(this.Owner instanceof bi))?this.Owner.GetHierarchicalIndex(n):n},i.prototype.GetFieldCode=function(n,t,r,u){var o="",l=0,h,f;for(this.ChildNodes.Contains(u)&&(l=this.ChildNodes.IndexOf(u)+1),h=l;h<this.ChildNodes.Count;h++)if(f=this.ChildNodes[h],f instanceof i){if(o+=f.GetFieldCode(n,t,r,null),r)return o}else if(f instanceof e){if(f instanceof s&&(t=n.fieldEnd!=null&&n!=f),f instanceof a){if(n.fieldEnd==f)return r=!0,o;t=!1}else if(f instanceof fi){if(n.fieldSeparator==f)return r=!0,o;t=!1}}else f instanceof k&&!t&&(o+=f.Text);return this.Owner instanceof i&&!(this instanceof c)&&(o+=this.Owner.GetFieldCode(n,t,r,this)),o},i.prototype.GetHyperlinkField=function(n,t){for(var u,r=0;r<this.Fields.length;r++){if(t.Contains(this.Fields[r])||this.Fields[r].fieldSeparator==null)continue;else t.Add(this.Fields[r]);if(u=this.Fields[r].GetFieldCode(),u=u.trim().toLowerCase(),u.match("hyperlink ")&&this.Fields[r].InlineIsInFieldResult(n))return this.Fields[r]}return this.Owner instanceof i&&!(this instanceof c)?this.Owner.GetHyperlinkField(n,t):null},i.prototype.GetHyperlinkFields=function(n,t){for(var u,r=0;r<this.Fields.length;r++){if(t.Contains(this.Fields[r])||this.Fields[r].fieldSeparator==null)continue;else t.Add(this.Fields[r]);if(u=this.Fields[r].GetFieldCode(),u=u.trim().toLowerCase(),u.match("hyperlink ")&&this.Fields[r].ParagraphIsInFieldResult(n))return this.Fields[r]}return this.Owner instanceof i&&!(this instanceof c)?this.Owner.GetHyperlinkFields(n,t):null},i.prototype.GetParagraph=function(n){var u,s;if(n.Index==null||n.Index==r)return null;var l=this,t=n.Index.indexOf(";"),e="0";if(t>=0&&(e=n.Index.substring(0,t),n.Index=n.Index.substring(t).replace(";","")),this instanceof at&&e=="HF")return l.HeaderFooters.GetParagraph(n);if(t=parseInt(e),this instanceof ui&&t>=this.ChildNodes.Count&&(n.Index="0;0",t=this.ChildNodes.Count-1),t>=0&&t<this.ChildNodes.Count){if(u=this.ChildNodes[t],u instanceof f){if(n.Index.indexOf("C;")>0){s=u;t=n.Index.indexOf(";");e=n.Index.substring(0,t);n.Index=n.Index.substring(t+2).replace(";","");var h=0,c=s.GetInline(parseFloat(e),h),o=c.inline;t=c.index;h==o.Length&&(o=o.NextNode)}return n.Index.indexOf(";")>0&&(n.Index="0"),u}if(u instanceof i)return n.Index.indexOf(";")>0?u.GetParagraph(n):u instanceof w?u.GetFirstParagraphInFirstCell():null}else if(this.NextNode instanceof i)return(n="0",this.NextNode instanceof w)?this.NextNode.GetFirstParagraphInFirstCell():this.NextNode;return null},i}(gt);i.CompositeNode=ut;kr=function(t){function i(){t.apply(this,arguments);this.notifyCollectionChanged=!1}return n(i,t),Object.defineProperty(i.prototype,"NotifyCollectionChanged",{get:function(){return this.notifyCollectionChanged},set:function(n){this.notifyCollectionChanged=n},enumerable:!0,configurable:!0}),i.prototype.push=function(n){return n!=null&&n!=r?(t.prototype.push.call(this,n),this.NotifyCollectionChanged&&this.CollectionChanged(n,!0),1):0},i.prototype.Add=function(n){return n!=null&&n!=r&&t.prototype.push.call(this,n),this.NotifyCollectionChanged&&this.CollectionChanged(n,!0),1},i.prototype.Insert=function(n,t){if(n==this.length){this.Add(t);return}n>-1&&n<this.length&&(this.shiftItems(n,!0),this[n]=t,this.length=this.length+1,this.CollectionChanged&&this.CollectionChanged(t,!0))},i.prototype.Remove=function(n){var i=this.indexOf(n);return i>-1&&i<this.length?(this.shiftItems(i,!1),t.prototype.pop.call(this),this.CollectionChanged&&this.CollectionChanged(n,!1),!0):!1},i.prototype.RemoveAt=function(n){if(n>-1&&n<this.length){var i=this[n];return this.shiftItems(n,!1),t.prototype.pop.call(this),this.CollectionChanged&&this.CollectionChanged(i,!1),!0}return!1},i}(o);i.ObservableCollection=kr;wi=function(t){function i(n){t.call(this);this.ownerBase=n;this.NotifyCollectionChanged=!0}return n(i,t),Object.defineProperty(i.prototype,"OwnerBase",{get:function(){return this.ownerBase},enumerable:!0,configurable:!0}),i.prototype.push=function(n){return this instanceof rr&&n instanceof yr||this instanceof ur&&n instanceof yi||this instanceof fr&&n instanceof vt||this instanceof er&&n instanceof hi?(t.prototype.push.call(this,n),1):0},i.prototype.Add=function(n){return this instanceof rr&&n instanceof yr||this instanceof ur&&n instanceof yi||this instanceof fr&&n instanceof vt||this instanceof er&&n instanceof hi?(t.prototype.push.call(this,n),1):0},i.prototype.CollectionChanged=function(n,t){t?n.SetOwnerBase(this.ownerBase):n instanceof it&&n.SetOwnerBase(null)},i.prototype.Dispose=function(){this.ownerBase=null;this.NotifyCollectionChanged=!1},i}(kr);i.BaseNodeCollection=wi;rr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i}(wi);i.ListAdvCollection=rr;ur=function(t){function i(){t.apply(this,arguments)}return n(i,t),i}(wi);i.AbstractListAdvCollection=ur;fr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i}(wi);i.ListLevelAdvCollection=fr;er=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.Get=function(n){for(var i,t=0;t<this.length;t++)if(this[t]instanceof hi&&(i=this[t],i.LevelNumber==n))return i;return null},i}(wi);i.LevelOverrideAdvCollection=er;ri=function(t){function i(n){t.call(this);this.ownerNode=n;this.NotifyCollectionChanged=!0}return n(i,t),Object.defineProperty(i.prototype,"OwnerNode",{get:function(){return this.ownerNode},enumerable:!0,configurable:!0}),i.prototype.push=function(n){if(this instanceof or&&n instanceof c||this instanceof sr&&n instanceof at||this instanceof li&&n instanceof ki||this instanceof hr&&n instanceof ai||this instanceof cr&&n instanceof ui||this instanceof lr&&n instanceof ht)return t.prototype.push.call(this,n),1},i.prototype.Add=function(n){return this instanceof or&&n instanceof c||this instanceof sr&&n instanceof at||this instanceof li&&n instanceof ki||this instanceof hr&&n instanceof ai||this instanceof cr&&n instanceof ui||this instanceof lr&&n instanceof ht?(t.prototype.push.call(this,n),1):0},i.prototype.SetOwnerToNode=function(n,t){if(n.Owner instanceof ut){var i=n.Owner;this.indexOf(n)>-1?(this.NotifyCollectionChanged=!1,this.RemoveAt(t),i==this.OwnerNode&&(this.NotifyCollectionChanged=!0),i.ChildNodes.Remove(n),i==this.OwnerNode&&(this.NotifyCollectionChanged=!1),this.Insert(t,n),this.NotifyCollectionChanged=!0):i.ChildNodes.Remove(n)}n.SetOwner(this.OwnerNode)},i.prototype.GetNextNode=function(n){var t=this.indexOf(n);return t<0||t>this.length-2?null:this[t+1]},i.prototype.GetPreviousNode=function(n){var t=this.indexOf(n);return t<1||t>this.length-1?null:this[t-1]},i.prototype.Dispose=function(){this.ownerNode=null;this.NotifyCollectionChanged=!1},i}(kr);i.NodeCollection=ri;or=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){if(t){var i=this.indexOf(n);this.SetOwnerToNode(n,i)}else n instanceof gt&&n.SetOwner(null)},i}(ri);i.HeaderFooterCollection=or;sr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){if(t){var i=this.indexOf(n);this.SetOwnerToNode(n,i)}else n instanceof gt&&n.SetOwner(null)},i}(ri);i.SectionAdvCollection=sr;li=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){if(t){var i=this.indexOf(n);this.SetOwnerToNode(n,i)}else n instanceof gt&&n.SetOwner(null)},i}(ri);i.BlockAdvCollection=li;hr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){var r,i;t?(r=this.indexOf(n),this.SetOwnerToNode(n,r),n instanceof k&&n.OwnerParagraph!=null&&(i=n,i.Text!="\t"&&i.Text!="\v"&&i.Text.length>=1&&n.SplitByTabOrLineBreakCharacter(r))):n instanceof gt&&n.SetOwner(null)},i}(ri);i.InlineCollection=hr;lu=function(t){function i(){t.apply(this,arguments)}return n(i,t),i}(o);i.TableColumnAdvCollection=lu;cr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){if(t){var i=this.indexOf(n);this.SetOwnerToNode(n,i)}else n instanceof gt&&n.SetOwner(null)},i}(ri);i.TableRowAdvCollection=cr;lr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){if(t){var i=this.indexOf(n);this.SetOwnerToNode(n,i)}else n instanceof gt&&n.SetOwner(null)},i}(ri);i.TableCellAdvCollection=lr;bi=function(t){function i(n){t.call(this,n);this.defaultTabWidth=48;this.backgroundColor="#FFFFFF";this.ChildNodes=new sr(this);this.lists=new rr(this);this.abstractLists=new ur(this);this.renderedListLevels=new o;this.renderedLevelOverrides=new o;this.renderedLists=new dt}return n(i,t),Object.defineProperty(i.prototype,"Sections",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Lists",{get:function(){return this.lists},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AbstractLists",{get:function(){return this.abstractLists},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerControl",{get:function(){return this.ownerControl},set:function(n){this.ownerControl=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DefaultTabWidth",{get:function(){return this.defaultTabWidth},set:function(n){this.defaultTabWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DocumentStart",{get:function(){return this.GetDocumentStart()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DocumentEnd",{get:function(){return this.GetDocumentEnd()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BackgroundColor",{get:function(){return this.backgroundColor},set:function(n){this.backgroundColor=n},enumerable:!0,configurable:!0}),i.prototype.LayoutItems=function(n){for(var i,t=0;t<this.Sections.length;t++)i=this.Sections[t],i.LayoutItems(n);n.UpdateScrollBars()},i.prototype.Dispose=function(){var t,i,n,r;if(this.ownerControl!=null&&(this.ownerControl=null),this.ChildNodes!=null)for(this.ChildNodes.Dispose(),n=0;n<this.Sections.Count;n++)t=this.Sections[n],t.Dispose(),this.Sections.Remove(t),n--;if(this.renderedListLevels!=null&&(this.renderedListLevels.Clear(),this.renderedListLevels=null),this.renderedLists!=null&&(this.renderedLists.Clear(),this.renderedLists=null),this.Lists!=null){for(n=0;n<this.Lists.Count;n++)i=this.Lists[n],i.Dispose(),this.lists.Remove(i),n--;this.lists.Dispose();this.lists=null}if(this.AbstractLists!=null){for(n=0;n<this.AbstractLists.Count;n++)r=this.AbstractLists[n],r.Dispose(),this.abstractLists.Remove(r),n--;this.abstractLists.Dispose();this.abstractLists=null}this.Fields=null;this.FieldCharacter=null},i.prototype.GetListByID=function(n){if(this.Lists==null)return null;for(var t=0;t<this.Lists.length;t++)if(this.Lists[t]!=null&&this.Lists[t].ListId==n)return this.Lists[t];return null},i.prototype.GetAbstractListAdvByID=function(n){if(this.AbstractLists==null)return null;for(var t=0;t<this.AbstractLists.length;t++)if(this.AbstractLists[t]!=null&&this.AbstractLists[t].AbstractListId==n)return this.AbstractLists[t];return null},i.prototype.AddListLevel=function(n){for(var t,r,i=n.Levels.Count;i<9;i++)t=new vt(n),r=i%3,n.Levels[0].ListLevelPattern==y.Bullet?(t.ListLevelPattern=y.Bullet,t.NumberFormat=r==0?vt.DOTBULLET:r==1?vt.SQUAREBULLET:vt.ARROWBULLET,t.CharacterFormat.FontFamily=t.NumberFormat==vt.SQUAREBULLET?"Wingdings":"Symbol"):(t.ListLevelPattern=r,t.NumberFormat="%"+(i+1).toString()+".",t.StartAt=1,t.RestartLevel=i),t.ParagraphFormat=new nr(t),t.ParagraphFormat.LeftIndent=48*(i+1),t.ParagraphFormat.FirstLineIndent=-24,n.Levels.Add(t)},i.prototype.GetListNumber=function(n){var t=n.List,i=n.ListLevelNumber,r=n.ListLevel,u=t.LevelOverrides!=null?t.LevelOverrides.Get(i):null,f;return u==null||this.renderedLevelOverrides.Contains(u)||u.OverrideListLevel!=null||(this.renderedLevelOverrides.Add(t.LevelOverrides[i]),this.renderedListLevels.Contains(r)&&this.renderedListLevels.Remove(r),this.renderedLists.ContainsKey(t.AbstractList)&&(f=this.renderedLists.Get(t.AbstractList),f.ContainsKey(i)&&f.Remove(i))),this.UpdateListValues(t,i),this.GetListText(t,i,r)},i.prototype.UpdateListValues=function(n,t){var o,f,u,i,r,e;if(this.renderedLists.ContainsKey(n.AbstractList))if(u=this.renderedLists.Get(n.AbstractList),u.ContainsKey(t))for(e=u.Get(t),u.Set(t,e+1),i=t+1;i<n.AbstractList.Levels.Count;)r=n.GetListLevel(i),r!=null&&u.ContainsKey(i)&&r.RestartLevel>t&&(u.Remove(i),this.renderedListLevels.Contains(r)&&this.renderedListLevels.Remove(r)),i++;else{for(i=t;!u.ContainsKey(i-1)&&i>0;)r=n.GetListLevel(i-1),r!=null&&(u.Add(i-1,n.GetListStartValue(i-1)),this.renderedListLevels.Contains(r)||this.renderedListLevels.Add(r)),i--;e=n.GetListStartValue(t);u.Add(t,e)}else for(o=new dt,this.renderedLists.Add(n.AbstractList,o),r=n.GetListLevel(t),f=0;f<=t;f++)o.Add(f,n.GetListStartValue(f))},i.prototype.GetListText=function(n,t,i){var r=i.NumberFormat,f,o,e;if(this.renderedLists.ContainsKey(n.AbstractList))for(f=this.renderedLists.Get(n.AbstractList),o=f.Keys,e=0;e<o.length;e++){var u=o[e],s="%"+(u+1).toString(),h=n.GetListLevel(u);if(r.match(s)){if(u>t)return"";r=f.ContainsKey(u)&&h!=null?r.replace(s,h.GetListText(f.Get(u))):r.replace(s,"0")}}return r},i.prototype.GetDocumentStart=function(){if(this.Sections.length==0||this.Sections[0].Blocks.length==0)return null;var t=null,n=this.Sections[0].Blocks[0];return n=n instanceof w?n.GetFirstParagraphInFirstCell():this.Sections[0].Blocks[0],n instanceof f&&(t=new oi(this.OwnerControl),t.SetPosition(n,!0)),t},i.prototype.GetDocumentEnd=function(){var i=null,r=this.DocumentStart,n,t,u;return r!=null&&this.Sections.Count>0&&(n=this.Sections.Last().Blocks.Last(),t=n,this.OwnerControl.IsDocumentLoaded||(t!=null&&(t=n.PreviousBlock),t==null&&this.Sections.Count>1&&(t=this.Sections[this.Sections.Count-2].Blocks.Last())),t!=null&&(n=t),n instanceof w&&(n=n.GetLastParagraphInLastCell()),n instanceof f?(u=t==null?0:n.GetEndOffset(),i=new oi(this.OwnerControl),i.SetPositionParagraph(n,u)):(i=new oi(this.OwnerControl),i.SetPositionParagraph(r.Paragraph,r.Paragraph.GetEndOffset()))),i},i.prototype.Find=function(n,t,i,r){var o,h,c,u,l,f,a;if(this.Sections.Count!=0&&!yt.IsPatternEmpty(n)){var s=null,e=null;if(this.OwnerControl.Selection!=null&&this.OwnerControl.Selection.End!=null&&(e=this.OwnerControl.Selection.End),i&&e!=null&&e.Paragraph!=null&&(o=0,h=e.Paragraph.GetInline(this.OwnerControl.Selection.End.Offset,o),s=h.inline,o=h.index,s!=null&&(c=s.Find(n,t,o,i,e,r),c)))return!0;for(u=this.Sections[0];u!=null&&u.Blocks.Count==0;)u=u.NextNode;if(u!=null&&u.Blocks.Count!=0){for(l=u.Blocks[0],f=l.GetFirstParagraph();f!=null&&f.Inlines.Count==0;)f=f.GetNextParagraph();if(f!=null&&f.Inlines.Count!=0)return a=f.Inlines[0],a.Find(n,t,0,i,e,r)}}},i}(ut);i.DocumentAdv=bi;at=function(t){function i(n){t.call(this,n);this.BodyWidgets=new o;this.ChildNodes=new li(this);this.headerFooters=new ar(this);this.sectionformat=new wu(this)}return n(i,t),Object.defineProperty(i.prototype,"Blocks",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"HeaderFooters",{get:function(){return this.headerFooters},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"SectionFormat",{get:function(){return this.sectionformat},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Document",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),i.prototype.AddBodyWidget=function(n){var t=new ti(this);return t.Width=n.Width,t.X=n.X,t.Y=n.Y,this.BodyWidgets.push(t),t},i.prototype.LayoutItems=function(n){var t,i;for(n.CreateNewPage(this),t=0;t<this.Blocks.length;t++)i=this.Blocks[t],n.UpdateClientAreaForBlock(i,!0),i.LayoutItems(n),n.UpdateClientAreaForBlock(i,!1)},i.prototype.GetCurrentHeaderFooter=function(n){return this.HeaderFooters.ChildNodes[n].Blocks.length==0&&this.PreviousNode!=null?this.PreviousNode.GetCurrentHeaderFooter(n):this.HeaderFooters.ChildNodes[n]},i.prototype.GetPreviousParagraph=function(){if(this.PreviousNode instanceof i){var n=this.PreviousNode.Blocks[this.PreviousNode.Blocks.Count-1];return n instanceof f?n:n.GetLastParagraphInLastCell()}return null},i.prototype.GetNextParagraph=function(){if(this.NextNode instanceof i){var n=this.NextNode.Blocks[0];return n instanceof f?n:n.GetFirstParagraphInFirstCell()}return null},i.prototype.GetPreviousBlock=function(){return this.PreviousNode instanceof i?this.PreviousNode.Blocks[this.PreviousNode.Blocks.Count-1]:null},i.prototype.GetNextSelection=function(n){if(this.NextNode instanceof i){var t=this.NextNode.Blocks[0];return t instanceof f?t:n.IsEmpty||n.IsForward?t.GetLastParagraphInFirstRow():t.Rows[0].GetNextParagraphSelection(n)}return null},i.prototype.GetPreviousSelection=function(n){if(this.PreviousNode instanceof i){var t=this.PreviousNode.Blocks[this.PreviousNode.Blocks.Count-1];return t instanceof f?t:n.IsForward?t.Rows[t.Rows.Count-1].GetPreviousParagraphSelection(n):t.GetFirstParagraphInLastRow()}return null},i.prototype.Dispose=function(){var t,n,i;if(this.SectionFormat.Dispose(),this.HeaderFooters.Dispose(),this.SetOwner(null),this.BodyWidgets!=null){for(n=0;n<this.BodyWidgets.Count;n++)t=this.BodyWidgets[n],t.Dispose(),this.BodyWidgets.Remove(t),n--;this.BodyWidgets=null}if(this.Blocks!=null){for(this.Blocks.Dispose(),n=0;n<this.Blocks.Count;n++)i=this.Blocks[n],i.Dispose(),this.Blocks.Remove(i),n--;this.Blocks=null}this.Fields=null;this.FieldCharacter=null},i}(ut);i.SectionAdv=at;c=function(t){function i(n){t.call(this,n);this.ChildNodes=new li(this);this.LayoutedWidgets=new o}return n(i,t),Object.defineProperty(i.prototype,"Blocks",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Type",{get:function(){return this.type},set:function(n){this.type=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Document",{get:function(){return this.Section==null?null:this.Section.Document},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Section",{get:function(){return this.Owner instanceof ar?this.Owner.Section:null},enumerable:!0,configurable:!0}),i.prototype.LayoutItems=function(n){var t=new ru(this),r,i;for(t.Page=n.CurrentRenderingPage,this.LayoutedWidgets.push(t),t.UpdateClientAreaLocation(n.ClientActiveArea),r=0;r<this.Blocks.length;r++)i=this.Blocks[r],i instanceof w&&i.TableWidgets.Clear(),n.UpdateClientAreaForBlock(i,!0),i.LayoutItems(n),n.UpdateClientAreaForBlock(i,!1);return t.Height=n.ClientActiveArea.Top-n.ClientArea.Top,(this.type==st.OddFooter||this.type==st.EvenFooter||this.type==st.FirstPageFooter)&&t.ShiftChildLocation(n.ClientArea.Top-n.ClientActiveArea.Top),t},i.prototype.ClearWidgets=function(){for(var t,n=0;n<this.LayoutedWidgets.Count;n++)t=this.LayoutedWidgets[n],t.Dispose(),this.LayoutedWidgets.Remove(t),n--},i.prototype.Dispose=function(){var n,t;if(this.SetOwner(null),this.Blocks!=null){for(this.Blocks.Dispose(),n=0;n<this.Blocks.Count;n++)t=this.Blocks[n],t.Dispose(),this.Blocks.Remove(t),n--;this.Blocks=null}this.Fields=null;this.FieldCharacter=null;this.LayoutedWidgets!=null&&(this.ClearWidgets(),this.LayoutedWidgets=null)},i}(ut);i.HeaderFooter=c;ar=function(t){function i(n){var i,r,u,f,e,o;t.call(this,n);this.ChildNodes=new or(this);i=new c(null);i.Type=st.EvenHeader;this.ChildNodes.push(i);r=new c(null);r.Type=st.OddHeader;this.ChildNodes.push(r);u=new c(null);u.Type=st.EvenFooter;this.ChildNodes.push(u);f=new c(null);f.Type=st.OddFooter;this.ChildNodes.push(f);e=new c(null);e.Type=st.FirstPageHeader;this.ChildNodes.push(e);o=new c(null);o.Type=st.FirstPageFooter;this.ChildNodes.push(o)}return n(i,t),Object.defineProperty(i.prototype,"EvenHeader",{get:function(){return this.ChildNodes[0]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Header",{get:function(){return this.ChildNodes[1]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"EvenFooter",{get:function(){return this.ChildNodes[2]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Footer",{get:function(){return this.ChildNodes[3]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FirstPageHeader",{get:function(){return this.ChildNodes[4]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FirstPageFooter",{get:function(){return this.ChildNodes[5]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Document",{get:function(){return this.Section==null?null:this.Section.Document},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Section",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){var n,t;if(this.SetOwner(null),this.ChildNodes!=null){for(this.ChildNodes.Dispose(),n=0;n<this.ChildNodes.Count;n++)t=this.ChildNodes[n],t.Dispose(),this.ChildNodes.Remove(t),n--;this.ChildNodes=null}this.Fields=null;this.FieldCharacter=null},i}(ut);i.HeaderFooters=ar;ki=function(t){function i(){t.apply(this,arguments)}return n(i,t),Object.defineProperty(i.prototype,"PreviousBlock",{get:function(){return this.PreviousNode},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"NextBlock",{get:function(){return this.NextNode},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Section",{get:function(){return this.Owner instanceof ht?this.Owner.Section:this.Owner instanceof c?this.Owner.Section:this.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsInsideTable",{get:function(){return this.Owner instanceof ht},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AssociatedCell",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Document",{get:function(){return this.Section!=null?this.Section.Document:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftIndent",{get:function(){var n=this;return n instanceof f?n.ParagraphFormat.LeftIndent:n instanceof w?n.TableFormat.LeftIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightIndent",{get:function(){var n=this;return n instanceof f?n.ParagraphFormat.RightIndent:0},enumerable:!0,configurable:!0}),i.prototype._UpdateWidgetsToBody=function(n,t){var s=this,u,r,h,i,o,e,c,l;n.CurrentHeaderFooter==null?(t.ContainerWidget!=null&&t.ContainerWidget.ChildWidgets.Contains(t)&&(t.ContainerWidget.ChildWidgets.Remove(t),t.ContainerWidget.Height-=t.Height),u=null,r=null,r=this.Section.BodyWidgets,h=s instanceof f?s.ParagraphWidgets:s.TableWidgets,h.Count>1?(i=h[h.Count-2].ContainerWidget,e=r.IndexOf(i),u=e+1<r.Count?r[e+1]:r[r.Count-1],u.ChildWidgets.Insert(0,t),t.ContainerWidget=u,u.Height+=t.Height):(i=null,o=0,this.PreviousBlock instanceof f?(i=this.PreviousBlock.ParagraphWidgets[this.PreviousBlock.ParagraphWidgets.Count-1].ContainerWidget,o=i.ChildWidgets.IndexOf(this.PreviousBlock.ParagraphWidgets[this.PreviousBlock.ParagraphWidgets.Count-1])):this.PreviousBlock instanceof w&&(i=this.PreviousBlock.TableWidgets[this.PreviousBlock.TableWidgets.Count-1].ContainerWidget,o=i.ChildWidgets.IndexOf(this.PreviousBlock.TableWidgets[this.PreviousBlock.TableWidgets.Count-1])),i!=null&&b.Round(t.Y,2)==b.Round(i.ChildWidgets[o].Y+i.ChildWidgets[o].Height,2)?(i.ChildWidgets.Insert(o+1,t),t.ContainerWidget=i,i.Height+=t.Height):(e=0,c=this.Document.DocumentStart,(c==null||c.Paragraph.IsInsideTable&&this instanceof w&&s.Contains(c.Paragraph.AssociatedCell))&&(e=-1),i!=null&&(e=r.IndexOf(i)),u=e+1<r.Count?r[e+1]:r[r.Count-1],u.ChildWidgets.Insert(0,t),t.ContainerWidget=u,u.Height+=t.Height))):(l=n.CurrentHeaderFooter.LayoutedWidgets[n.CurrentHeaderFooter.LayoutedWidgets.Count-1],l.ChildWidgets.Add(t),t.ContainerWidget=l)},i.prototype.GetContainerTable=function(){var n=this;return this.IsInsideTable&&(n=this.AssociatedCell.OwnerTable.IsInsideTable?this.AssociatedCell.OwnerTable.GetContainerTable():this.AssociatedCell.OwnerTable),n},i.prototype.IsExistBefore=function(n){var i,t,r,u;return this.IsInsideTable?(i=this.AssociatedCell,n.IsInsideTable?(t=n.AssociatedCell,i==t)?i.Blocks.IndexOf(this)<i.Blocks.IndexOf(n):i.OwnerRow==t.OwnerRow?i.CellIndex<t.CellIndex:i.OwnerTable==t.OwnerTable?i.OwnerRow.RowIndex<t.OwnerRow.RowIndex:(r=i.GetContainerCellOf(t),r.OwnerTable.Contains(t))?(i=i.GetSelectedCell(r),t=t.GetSelectedCell(r),i==r)?this.IsExistBefore(t.OwnerTable):t==r?i.OwnerTable.IsExistBefore(n):r.OwnerRow==t.OwnerRow?r.CellIndex<t.CellIndex:r.OwnerTable==t.OwnerTable?r.OwnerRow.RowIndex<t.OwnerRow.RowIndex:i.OwnerTable.IsExistBefore(t.OwnerTable):r.OwnerTable.IsExistBefore(t.OwnerTable.GetContainerTable()):(u=this.GetContainerTable(),u.IsExistBefore(n))):n.IsInsideTable?(u=n.GetContainerTable(),this.IsExistBefore(u)):this.Owner instanceof c?this.Owner.Blocks.indexOf(this)<n.Owner.Blocks.indexOf(n):this.Section==n.Section?this.Section.Blocks.indexOf(this)<this.Section.Blocks.indexOf(n):this.Document.Sections.indexOf(this.Section)<this.Document.Sections.indexOf(n.Section)},i.prototype.IsExistAfter=function(n){var i,t,r,u;return this.IsInsideTable?(i=this.AssociatedCell,n.IsInsideTable?(t=n.AssociatedCell,i==t)?i.Blocks.IndexOf(this)>i.Blocks.IndexOf(n):i.OwnerRow==t.OwnerRow?i.CellIndex>t.CellIndex:i.OwnerTable==t.OwnerTable?i.OwnerRow.RowIndex>t.OwnerRow.RowIndex:(r=i.GetContainerCellOf(t),r.OwnerTable.Contains(t))?(i=i.GetSelectedCell(r),t=t.GetSelectedCell(r),i==r)?this.IsExistAfter(t.OwnerTable):t==r?i.OwnerTable.IsExistAfter(n):r.OwnerRow==t.OwnerRow?r.CellIndex>t.CellIndex:r.OwnerTable==t.OwnerTable?r.OwnerRow.RowIndex>t.OwnerRow.RowIndex:i.OwnerTable.IsExistAfter(t.OwnerTable):r.OwnerTable.IsExistAfter(t.OwnerTable.GetContainerTable()):(u=this.GetContainerTable(),u.IsExistAfter(n))):n.IsInsideTable?(u=n.GetContainerTable(),this.IsExistAfter(u)):this.Owner instanceof c?this.Owner.Blocks.IndexOf(this)>n.Owner.Blocks.IndexOf(n):this.Section==n.Section?this.Section.Blocks.IndexOf(this)>this.Section.Blocks.IndexOf(n):this.Document.Sections.IndexOf(this.Section)>this.Document.Sections.IndexOf(n.Section)},i.prototype.GetNextParagraph=function(){return this.NextBlock instanceof f?this.NextBlock:this.NextBlock instanceof w?this.NextBlock.GetFirstParagraphInFirstCell():this.Owner instanceof ht?this.Owner.GetNextParagraph():this.Owner instanceof at?this.Owner.GetNextParagraph():null},i.prototype.GetFirstParagraph=function(){var n=this;return n instanceof f?n:n instanceof w?n.GetFirstParagraphInFirstCell():null},i.prototype.GetLastParagraph=function(){var n=this;return n instanceof f?n:n instanceof w?n.GetLastParagraphInLastCell():null},i.prototype.GetPreviousParagraph=function(){return this.PreviousBlock instanceof f?this.PreviousBlock:this.PreviousBlock instanceof w?this.PreviousBlock.GetLastParagraphInLastCell():this.Owner instanceof ht?this.Owner.GetPreviousParagraph():this.Owner instanceof at?this.Owner.GetPreviousParagraph():null},i.prototype.GetPreviousBlock=function(){if(this.PreviousBlock==null){if(this.Owner instanceof ht)return this.Owner.OwnerTable.GetPreviousBlock();if(this.Owner instanceof at)return this.Owner.GetPreviousBlock()}return this.PreviousBlock},i.prototype.GetNextRenderedBlock=function(){return this.NextBlock==null&&this.Owner instanceof at&&this.Owner.NextNode!=null?this.Owner.NextNode.Blocks[0]:this.NextBlock},i.prototype.GetPreviousSelection=function(n){return this.PreviousBlock instanceof f?this.PreviousBlock:this.PreviousBlock instanceof w?n.IsForward?this.PreviousBlock.Rows[this.PreviousBlock.Rows.Count-1].GetPreviousParagraphSelection(n):this.PreviousBlock.GetFirstParagraphInLastRow():this.Owner instanceof ht?this.Owner.GetPreviousSelection(n):this.Owner instanceof at?this.Owner.GetPreviousSelection(n):null},i.prototype.GetNextSelection=function(n){return this.NextBlock instanceof f?this.NextBlock:this.NextBlock instanceof w?n.IsEmpty||n.IsForward?this.NextBlock.GetLastParagraphInFirstRow():this.NextBlock.Rows[0].GetNextParagraphSelection(n):this.Owner instanceof ht?this.Owner.GetNextSelection(n):this.Owner instanceof at?this.Owner.GetNextSelection(n):null},i}(ut);i.BlockAdv=ki;w=function(t){function i(n){t.call(this,n);this.flags=0;this.headerHeight=0;this.tableholder=null;this.ChildNodes=new cr(this);this.TableFormat=new bt(this);this.TableHolder=new ku;this.SpannedRowCollection=new dt;this.TableWidgets=new o}return n(i,t),Object.defineProperty(i.prototype,"TableHolder",{get:function(){return this.tableholder},set:function(n){this.tableholder=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Rows",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Title",{get:function(){return this.title},set:function(n){this.title=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Description",{get:function(){return this.description},set:function(n){this.description=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TableWidth",{get:function(){return this.Rows==null?0:this.GetTableWidth()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ContinueHeader",{get:function(){return(this.flags&2)>>1!=0},set:function(n){this.flags=this.flags&253|(n?1:0)<<1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Header",{get:function(){return(this.flags&1)!=0},set:function(n){this.flags=this.flags&254|(n?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"HeaderHeight",{get:function(){return this.headerHeight},set:function(n){this.headerHeight=n},enumerable:!0,configurable:!0}),i.prototype.LayoutItems=function(n){var t,i;for(this.TableWidgets!=null&&this.TableWidgets.length>0&&this.TableWidgets.Clear(),this.AddColumns(),this.AddTableWidget(n.ClientActiveArea),n.UpdateClientAreaTopOrLeft(this.TableWidgets[this.TableWidgets.Count-1],!0),this.Rows.Count>0&&this.Rows[0].RowFormat.IsHeader?(this.Header=!0,this.ContinueHeader=!0,this.HeaderHeight=0):(this.Header=!1,this.ContinueHeader=!1,this.HeaderHeight=0),t=0;t<this.Rows.length;t++)i=this.Rows[t],i.LayoutItems(n);this.UpdateWidgetsToPage(n)},i.prototype.GetHeader=function(){for(var t,i=null,r=!0,n=0;n<this.Rows.length;n++)if(t=this.Rows[n],t.RowFormat.IsHeader?i=t:r=!1,!r)break;return i},i.prototype.GetTableWidth=function(){for(var u,n,t,f,i=0,r=0;r<this.Rows.length;r++){for(u=this.Rows[r],n=0,t=0;t<u.Cells.length;t++)f=u.Cells[t],n+=f.CellFormat.CellWidth;i<n&&(i=n)}return i},i.prototype.AddTableWidget=function(n){var t=new ii(this);t.Width=n.Width;t.X=n.X;t.Y=n.Y;this.TableWidgets.Add(t);this.IsInsideTable||(t.Width=this.GetTableWidth());this.TableFormat.CellSpacing>0&&(t.Height=t.Height+this.TableFormat.CellSpacing,t.LeftBorderWidth=this.TableFormat.Borders.GetTableLeftBorder().GetLineWidth(),t.RightBorderWidth=this.TableFormat.Borders.GetTableRightBorder().GetLineWidth(),t.TopBorderWidth=this.TableFormat.Borders.GetTableTopBorder().GetLineWidth(),t.BottomBorderWidth=this.TableFormat.Borders.GetTableBottomBorder().GetLineWidth(),t.X+=t.LeftBorderWidth,t.Y+=t.TopBorderWidth,t.Width-=t.LeftBorderWidth,t.Width-=t.RightBorderWidth)},i.prototype.AddColumns=function(){var y,h,s,r,p,l,a,w,u,c;this.TableHolder.Columns.Clear();var t=new o,v=0,n=new o;for(u=0;u<this.Rows.length;u++){var f=this.Rows[u],i=f.GridBefore,e=0;for(t.Contains(e)||t.Add(e),e+=f.GridBeforeWidth*15,y=Math.round(e),t.Contains(y)||t.Add(y),h=0;h<f.Cells.length;h++){for(s=f.Cells[h],n.length==0&&(s.ColumnIndex=i),r=0;r<n.length;r++){if(n[r].ColumnIndex<i){s.ColumnIndex=i;continue}p=1;l=!0;p=n[r].CellFormat.RowSpan;n[r].ColumnIndex>i?(s.ColumnIndex=i,l=!1,h==f.Cells.length-1&&f.GridAfter>0&&(e+=n[r].CellFormat.CellWidth*15)):(s.ColumnIndex=i=this.TableHolder.Columns.indexOf(n[r].OwnerColumn)+n[r].CellFormat.ColumnSpan,e+=n[r].CellFormat.CellWidth*15);l||h!=f.Cells.length-1||(l=!0);l&&u-n[r].OwnerRow.RowIndex==p-1&&(n.RemoveAt(r),r--)}if(s.CellFormat.RowSpan>1)if(n.length==0||n[n.length-1].ColumnIndex<=i)n.Add(s);else for(a=n.length;a>0;a--)n[a-1].ColumnIndex>i&&n.Insert(a-1,s);if(i+=s.CellFormat.ColumnSpan,e+=s.CellFormat.CellWidth*15,w=Math.round(e),t.Contains(w)||t.Add(w),h==f.Cells.length-1&&f.GridAfterWidth>0&&(e+=f.GridAfterWidth*15,t.Contains(Math.round(e))||t.Add(Math.round(e)),i+=f.GridAfter),v=Math.max(v,i-1),this.TableHolder.Columns.length<i)for(c=new dr,this.TableHolder.Columns.Add(c);this.TableHolder.Columns.length<i;)c=new dr,this.TableHolder.Columns.Add(c)}}for(t.Sort(),u=0;u<t.length-1;u++)c=this.TableHolder.Columns[u],c.PreferredWidth=(t[u+1]-t[u])/15;for(t.Clear();v+1<this.TableHolder.Columns.length;)this.TableHolder.Columns.RemoveAt(this.TableHolder.Columns.length-1)},i.prototype.UpdateWidgetsToPage=function(n){var t=this.TableWidgets[this.TableWidgets.length-1];this.IsInsideTable?(this.AssociatedCell.TableCellWidgets[this.AssociatedCell.TableCellWidgets.length-1].ChildWidgets.push(t),t.ContainerWidget=this.AssociatedCell.TableCellWidgets[this.AssociatedCell.TableCellWidgets.length-1],this.AssociatedCell.TableCellWidgets[this.AssociatedCell.TableCellWidgets.Count-1].Height=this.AssociatedCell.TableCellWidgets[this.AssociatedCell.TableCellWidgets.Count-1].Height+t.Height):(this._UpdateWidgetsToBody(n,t),t.UpdateHeight(n),t.ChildWidgets.Count>0&&t.Y!=t.ChildWidgets[0].Y&&(t.Y=t.ChildWidgets[0].Y));this.TableFormat.CellSpacing>0&&(t.Y+t.Height+this.TableFormat.CellSpacing>n.ClientArea.Bottom&&n instanceof ft&&(t.Height=t.Height-this.TableFormat.CellSpacing/2),n.CutFromTop(t.Y+t.Height))},i.prototype.GetLastBlockInLastCell=function(){var n=this,t,i;return n.Rows.Count>0?(t=n.Rows[n.Rows.Count-1],i=t.Cells[t.Cells.Count-1],i.Blocks[i.Blocks.Count-1]):null},i.prototype.GetLastParagraphInFirstRow=function(){var t=this;if(t.Rows.Count>0){var i=t.Rows[0],r=i.Cells[i.Cells.Count-1],n=r.Blocks[r.Blocks.Count-1];return n instanceof f?n:n.GetLastParagraphInLastCell()}return null},i.prototype.GetLastParagraphInLastCell=function(){var n=this;if(n.Rows.Count>0){var i=n.Rows[n.Rows.Count-1],r=i.Cells[i.Cells.Count-1],t=r.Blocks[r.Blocks.Count-1];return t instanceof f?t:t.GetLastParagraphInLastCell()}return null},i.prototype.GetFirstParagraphInFirstCell=function(){var r=this,t,i,n;return r.Rows.length>0&&(t=r.Rows[0],t.Cells.length>0&&(i=t.Cells[0],i.Blocks.length>0))?(n=i.Blocks[0],n instanceof f?n:n.GetFirstParagraphInFirstCell()):null},i.prototype.GetFirstBlockInFirstCell=function(){var i=this,n,t;return i.Rows.length>0&&(n=i.Rows[0],n.Cells.Count>0)?(t=n.Cells[0],t.Blocks.Count==0)?null:t.Blocks[0]:null},i.prototype.Contains=function(n){if(this==n.OwnerTable)return!0;while(n.OwnerTable.IsInsideTable){if(this==n.OwnerTable)return!0;n=n.OwnerTable.AssociatedCell}return this==n.OwnerTable},i.prototype.HighlightCells=function(n,t,i,r){var u=i.OwnerRow.GetCellLeft(i),f=u+i.CellFormat.CellWidth,o=r.OwnerRow.GetCellLeft(r),s=o+r.CellFormat.CellWidth,h,e;for(u>o&&(u=o),f<s&&(f=s),u>n.UpDownSelectionLength&&(u=n.UpDownSelectionLength),f<n.UpDownSelectionLength&&(f=n.UpDownSelectionLength),h=this.Rows.IndexOf(r.OwnerRow),e=this.Rows.IndexOf(i.OwnerRow);e<=h;e++)this.Rows[e].Highlight(n,t,u,f)},i.prototype.Highlight=function(n,t,i,r){if(this.Rows[0].HighlightInternal(n,t,i,r),!r.Paragraph.IsInsideTable||!this.Contains(r.Paragraph.AssociatedCell)){var u=this.GetNextRenderedBlock();u.Highlight(n,t,i,r)}},i.prototype.GetSelectedContentAsHtml=function(n,t,i){var r="<table ",u;return r+=this.TableFormat.GetAsHtmlStyle(),r+=">",r+=this.Rows[0].GetSelectedContentAsHtml(n,t,i),r+="<\/table>",i.Paragraph.IsInsideTable&&this.Contains(i.Paragraph.AssociatedCell)||(u=this.GetNextRenderedBlock(),r+=u.GetSelectedContentAsHtml(n,t,i)),r},i.prototype.GetSelectedContentAsHtmlInternal=function(n,t,i){var r=t.OwnerRow.GetCellLeft(t),u=r+t.CellFormat.CellWidth,e=i.OwnerRow.GetCellLeft(i),s=e+i.CellFormat.CellWidth,h,o,f;for(r>e&&(r=e),u<s&&(u=s),r>n.UpDownSelectionLength&&(r=n.UpDownSelectionLength),u<n.UpDownSelectionLength&&(u=n.UpDownSelectionLength),h=this.Rows.IndexOf(i.OwnerRow),o="",f=this.Rows.IndexOf(t.OwnerRow);f<=h;f++)o+=this.Rows[f].GetSelectedContentAsHtmlInternal(n,r,u);return o},i.prototype.GetContentAsHtml=function(){var n="<table ",t;for(n+=this.TableFormat.GetAsHtmlStyle(),n+=">",t=0;t<this.Rows.length;t++)n+=this.Rows[t].GetContentAsHtml();return n+"<\/table>"},i.prototype.GetFirstParagraphInLastRow=function(){if(this.Rows.Count>0){var t=this.Rows[this.Rows.Count-1],i=t.Cells[0],n=i.Blocks[0];return n instanceof f?n:n.GetFirstParagraphInFirstCell()}return null},i.prototype.GetCellInTable=function(n){while(n.OwnerTable.IsInsideTable){if(this==n.OwnerTable)return n;n=n.OwnerTable.AssociatedCell}return n},i.prototype.ClearWidgets=function(){var n,t;if(this.TableWidgets!=null&&this.TableWidgets.Count>0)for(n=0;n<this.TableWidgets.Count;n++)t=this.TableWidgets[n],t.Dispose(),this.TableWidgets.Remove(t),n--},i.prototype.Dispose=function(){var n,t;if(this.SpannedRowCollection!=null&&(this.SpannedRowCollection.Clear(),this.SpannedRowCollection=null),this.SetOwner(null),this.TableFormat.Dispose(),this.tableholder!=null&&(this.tableholder.Dispose(),this.tableholder=null),this.TableWidgets!=null&&(this.ClearWidgets(),this.TableWidgets=null),this.Rows!=null){for(this.Rows.Dispose(),n=0;n<this.Rows.Count;n++)t=this.Rows[n],t.Dispose(),this.Rows.Remove(t),n--;this.Rows=null}this.Fields=null;this.FieldCharacter=null},i}(ki);i.TableAdv=w;ui=function(t){function i(n){t.call(this,n);this.gridBefore=0;this.gridBeforeWidth=0;this.gridAfter=0;this.gridAfterWidth=0;this.ChildNodes=new lr(this);this.RowFormat=new fu(this);this.TableRowWidgets=new o}return n(i,t),Object.defineProperty(i.prototype,"OwnerTable",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RowIndex",{get:function(){return this.OwnerTable!=null?this.OwnerTable.Rows.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"GridBefore",{get:function(){return this.gridBefore},set:function(n){this.gridBefore=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"GridBeforeWidth",{get:function(){return this.gridBeforeWidth},set:function(n){this.gridBeforeWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"GridAfter",{get:function(){return this.gridAfter},set:function(n){this.gridAfter=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"GridAfterWidth",{get:function(){return this.gridAfterWidth},set:function(n){this.gridAfterWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Cells",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),i.prototype.LayoutItems=function(n){var t,i;for(this.TableRowWidgets!=null&&this.TableRowWidgets.length>0&&this.TableRowWidgets.Clear(),this.AddTableRowWidget(n.ClientActiveArea),n.UpdateClientAreaForRow(this,!0),t=0;t<this.Cells.length;t++)i=this.Cells[t],i.LayoutItems(n,this.GetMaxTopOrBottomCellMargin(0)+this.TableRowWidgets[this.TableRowWidgets.Count-1].TopBorderWidth,this.GetMaxTopOrBottomCellMargin(1)+this.TableRowWidgets[this.TableRowWidgets.Count-1].BottomBorderWidth);n.UpdateClientAreaForRow(this,!1);this.UpdateWidgetsToTable(n)},i.prototype.AddTableRowWidget=function(n){var u=new di(this),i,f,t,r;if(u.X=n.X+this.GridBeforeWidth,u.Y=n.Y,u.Width=n.Width,this.TableRowWidgets.Add(u),i=0,this.OwnerTable.TableFormat.CellSpacing>0){for(u.Height=u.Height+this.OwnerTable.TableFormat.CellSpacing,t=0;t<this.Cells.Count;t++)this.Cells[t].CellFormat!=null&&this.Cells[t].CellFormat.Borders!=null&&(r=this.Cells[t].CellFormat.Borders.GetCellBottomBorder(this.Cells[t]).GetLineWidth(),r>i&&(i=r));if(u.BottomBorderWidth=i,this.RowIndex>0&&this.PreviousNode!=null){for(f=this.PreviousNode,i=0,t=0;t<f.Cells.Count;t++)f.Cells[t].CellFormat!=null&&f.Cells[t].CellFormat.Borders!=null&&(r=f.Cells[t].CellFormat.Borders.GetCellBottomBorder(f.Cells[t]).GetLineWidth(),r>i&&(i=r));u.TopBorderWidth=i}}for(t=0;t<this.Cells.Count;t++)this.Cells[t].CellFormat!=null&&this.Cells[t].CellFormat.Borders!=null&&(r=this.Cells[t].CellFormat.Borders.GetCellTopBorder(this.Cells[t]).GetLineWidth(),r>i&&(i=r));if(u.TopBorderWidth=i,this.OwnerTable.TableFormat.CellSpacing<=0&&this.RowIndex==this.OwnerTable.Rows.Count-1){for(t=0;t<this.Cells.Count;t++)this.Cells[t].CellFormat!=null&&this.Cells[t].CellFormat.Borders!=null&&(r=this.Cells[t].CellFormat.Borders.GetCellBottomBorder(this.Cells[t]).GetLineWidth(),r>i&&(i=r));u.BottomBorderWidth=i}},i.prototype.GetHeaderHeight=function(n){var i=0,t,r;if(this.OwnerTable.Rows.Count>0&&n.Rows[0].RowFormat.IsHeader)for(t=0;t<n.Rows.Count;t++)if(r=n.Rows[t],r.RowFormat.IsHeader)i=i+r.GetRowHeight();else break;return i},i.prototype.GetRowHeight=function(){var n=0,t;if(this.RowFormat.HeightType==ot.Exactly)n=this.RowFormat.Height;else if(this.TableRowWidgets.Count>0){for(t=0;t<this.TableRowWidgets.Count;t++)n=this.TableRowWidgets[t].Height+n;n=Math.max(n,this.RowFormat.Height)}return n},i.prototype.IsVerticalMergedCellContinue=function(){for(var i,n=0,t=0;t<this.Cells.Count;t++){if(i=this.Cells[t],n<i.ColumnIndex)return!0;n+=i.CellFormat.ColumnSpan}return n<this.OwnerTable.TableHolder.Columns.Count},i.prototype.UpdateWidgetsToTable=function(n){var tt=this.GetRowHeight(),h=!1,c=!0,o=ot.Auto,y=0,p=this.TableRowWidgets.length-1,t=this.TableRowWidgets[p],it,r,l,rt,d,ut,k,a,u,et,g,nt,s,e;for(h=this.RowFormat.IsHeader,c=this.RowFormat.AllowBreakAcrossPages,o=this.RowFormat.HeightType,this.OwnerTable.ContinueHeader&&!h&&(this.OwnerTable.ContinueHeader=!1),y=this.OwnerTable.TableFormat.CellSpacing;p<this.TableRowWidgets.length;){if(p=this.TableRowWidgets.length,this.OwnerTable.IsInsideTable||n.SplittedCellWidgets.length==0&&t.Y+t.Height+y<=n.ClientArea.Bottom)this.AddWidgetToTable(n,t);else{if(n.SplittedCellWidgets.length>0&&t.Y+t.Height<=n.ClientArea.Bottom&&(it=this.IsRowSpanEnd(n),!it)){this.AddWidgetToTable(n,t);continue}if(r=t,l=this.OwnerTable.TableWidgets[this.OwnerTable.TableWidgets.Count-1],tt+t.Y>n.ClientArea.Bottom)if(!c||h&&this.OwnerTable.ContinueHeader||o==ot.Atleast&&this.RowFormat.Height<n.ClientArea.Bottom)if(tt+t.Y>n.ClientArea.Bottom){if((o==ot.Atleast&&this.RowFormat.Height<n.ClientActiveArea.Height&&c||o!=ot.Exactly&&t.Y==n.ClientArea.Y||o==ot.Auto&&c)&&(r=this.SplitWidgets(t,n,r)),o==ot.Exactly&&t.Y==n.ClientArea.Y&&(this.AddWidgetToTable(n,t),p++),h&&this.OwnerTable.ContinueHeader)for(this.OwnerTable.Header=!1,this.OwnerTable.ContinueHeader=!1,this.OwnerTable.HeaderHeight=0,s=n.Pages,e=0;e<s.Count;e++)s[e].RepeatHeaderRowTableWidget&&(s[e].RepeatHeaderRowTableWidget=!1)}else h&&this.OwnerTable.ContinueHeader?(this.AddWidgetToTable(n,t),this.OwnerTable.Header=!0):c||(this.AddWidgetToTable(n,t),this.OwnerTable.Header&&t.Height+this.OwnerTable.HeaderHeight<n.ClientArea.Bottom&&this.RowFormat.Height<n.ClientActiveArea.Bottom&&(t.X=t.X,t.Y=l.Y+this.OwnerTable.HeaderHeight,t.UpdateChildLocation(t.Y+this.OwnerTable.HeaderHeight)));else(o==ot.Auto||o==ot.Atleast)&&c?this.RowFormat.Height>n.ClientArea.Bottom&&t.Y!=n.ClientArea.Y||(r=this.SplitWidgets(t,n,r)):o==ot.Exactly&&t.Y==n.ClientArea.Y&&(this.AddWidgetToTable(n,t),p++);else this.IsVerticalMergedCellContinue()&&c&&(r=this.SplitWidgets(t,n,r));r!=null&&(r!=t?(this.AddWidgetToTable(n,t),this.OwnerTable.UpdateWidgetsToPage(n),rt=this.OwnerTable.TableWidgets.IndexOf(t.ContainerWidget),rt+1>=this.OwnerTable.TableWidgets.length&&this.OwnerTable.AddTableWidget(n.ClientActiveArea),t=r):(this.RowIndex>0&&(this.OwnerTable.UpdateWidgetsToPage(n),this.PreviousNode instanceof i&&this.PreviousNode.TableRowWidgets.length>0?(d=this.PreviousNode.TableRowWidgets[this.PreviousNode.TableRowWidgets.length-1],b.Round(t.Y,2)==b.Round(d.Y+d.Height,2)?(ut=this.OwnerTable.TableWidgets.IndexOf(d.ContainerWidget),ut+1>=this.OwnerTable.TableWidgets.length&&this.OwnerTable.AddTableWidget(n.ClientActiveArea)):this.OwnerTable.AddTableWidget(n.ClientActiveArea)):this.OwnerTable.AddTableWidget(n.ClientActiveArea)),p--),l=this.OwnerTable.TableWidgets[this.OwnerTable.TableWidgets.Count-1],k=null,this.OwnerTable.TableWidgets.length>1?k=this.OwnerTable.TableWidgets[this.OwnerTable.TableWidgets.length-2].ContainerWidget:(a=this.OwnerTable.PreviousBlock,a instanceof f?k=a.ParagraphWidgets[a.ParagraphWidgets.length-1].ContainerWidget:a instanceof w&&(k=a.TableWidgets[a.TableWidgets.length-1].ContainerWidget)),u=0,k!=null&&(u=n.Pages.indexOf(k.Page)),u==n.Pages.length-1||n.Pages[u+1].Section!=this.OwnerTable.Section?(et=n.CreateNewPage(this.OwnerTable.Section),n.Pages[u+1].Section!=this.OwnerTable.Section&&n.InsertPage(u+1,et)):(n.Pages[u+1].BoundingRectangle=new v(n.Pages[u+1].BoundingRectangle.X,n.Pages[u].BoundingRectangle.Bottom+20,n.Pages[u+1].BoundingRectangle.Width,n.Pages[u+1].BoundingRectangle.Height),n.UpdateClientArea(this.OwnerTable.Section[0].SectionFormat)),this.OwnerTable.Header&&t.Height<n.ClientArea.Bottom?(n instanceof ft&&(n.CurrentRenderingPage.RepeatHeaderRowTableWidget=!0),n.UpdateClientAreaForBlock(this.OwnerTable,!0),r.X=r.X,r.Y=l.Y+this.OwnerTable.HeaderHeight,g=n instanceof ft?y/2:y,r.UpdateChildLocation(l.Y+this.OwnerTable.HeaderHeight-g)):(n.UpdateClientAreaForBlock(this.OwnerTable,!0),r.X=r.X,r.Y=l.Y,g=n instanceof ft?y/2:y,r.UpdateChildLocation(l.Y-g)))}if(h&&this.OwnerTable.ContinueHeader&&(this.OwnerTable.Header=!0,this.OwnerTable.HeaderHeight=tt+this.OwnerTable.HeaderHeight),h&&this.OwnerTable.GetHeader()!=null&&this.RowIndex==this.OwnerTable.GetHeader().RowIndex&&(nt=this.GetHeaderHeight(this.OwnerTable),(nt>this.OwnerTable.HeaderHeight||nt>this.OwnerTable.HeaderHeight)&&(this.OwnerTable.HeaderHeight=nt),this.OwnerTable.HeaderHeight>n.ClientArea.Height))for(this.OwnerTable.Header=!1,this.OwnerTable.ContinueHeader=!1,this.OwnerTable.HeaderHeight=0,s=n.Pages,e=0;e<s.Count;e++)s[e].RepeatHeaderRowTableWidget&&(s[e].RepeatHeaderRowTableWidget=!1);this.OwnerTable.TableWidgets.Count>2&&this.OwnerTable.Header&&t.Height<n.ClientActiveArea.Bottom&&!n.CurrentRenderingPage.RepeatHeaderRowTableWidget&&n instanceof ft&&(n.CurrentRenderingPage.RepeatHeaderRowTableWidget=!0)}},i.prototype.SplitWidgets=function(n,t,i){return n.IsFirstLineFit(t.ClientArea.Bottom)?(i=n.GetSplittedWidget(t.ClientArea.Bottom),(t.SplittedCellWidgets.length>0||i!=n)&&i.InsertSplittedCellWidgets(t)):i.InsertSplittedCellWidgets(t),i},i.prototype.AddWidgetToTable=function(n,t){var r=this.OwnerTable.TableWidgets[0],u=r.ChildWidgets.length,f=null,o=this.TableRowWidgets.indexOf(t),e,h,s;if(o>0?f=this.TableRowWidgets[o-1]:this.PreviousNode instanceof i&&this.PreviousNode.TableRowWidgets.length>0&&(f=this.PreviousNode.TableRowWidgets[this.PreviousNode.TableRowWidgets.length-1]),f==null){if(u>0){for(e=r.ChildWidgets.length-1;e>=0;e--)if(h=r.ChildWidgets[e],h.TableRow.RowIndex<t.TableRow.RowIndex){u=e+1;break}else u=e;u==0&&r.UpdateWidgetLocation(t)}}else r=f.ContainerWidget,u=r.ChildWidgets.length,r.ChildWidgets.IndexOf(f)>=0&&(u=r.ChildWidgets.IndexOf(f)+1),Math.round(t.Y)!=Math.round(f.Y+f.Height)&&(s=this.OwnerTable.TableWidgets.IndexOf(r),s+1>=this.OwnerTable.TableWidgets.length&&this.OwnerTable.AddTableWidget(n.ClientActiveArea),r=this.OwnerTable.TableWidgets[s+1],u=r.ChildWidgets.length),o>0&&(u=0);this.UpdateRowHeightBySpannedCell(r,t,u);this.UpdateRowHeightByCellSpacing(t,n);r.ChildWidgets.Insert(u,t);t.ContainerWidget=r;r.Height=r.Height+t.Height;r.ContainerWidget!=null&&r.ContainerWidget.ChildWidgets.IndexOf(r)>=0&&(r.ContainerWidget.Height+=t.Height);t.UpdateHeight(n,!1);n.CutFromTop(t.Y+t.Height)},i.prototype.UpdateRowHeightBySpannedCell=function(n,t,i){var u=1,e,r,f,o;if(n.ChildWidgets.length==0||i==0){this.UpdateRowHeight(t,t);return}for(r=0;r<t.ChildWidgets.length;r++)e=t.ChildWidgets[r],u=e.TableCell.CellFormat.RowSpan,u>1&&this.OwnerTable!=null&&(this.OwnerTable.SpannedRowCollection.ContainsKey(this.RowIndex+u-1)||this.OwnerTable.SpannedRowCollection.Add(this.RowIndex+u-1,this.RowIndex));if(this.OwnerTable!=null)for(r=0;r<this.OwnerTable.SpannedRowCollection.Count;r++)if(this.OwnerTable.SpannedRowCollection.Keys[r]==this.RowIndex){for(f=0;f<i;f++)o=n.ChildWidgets[f],this.UpdateRowHeight(o,t);this.OwnerTable.SpannedRowCollection.Remove(this.OwnerTable.SpannedRowCollection.Keys[r]);break}},i.prototype.UpdateRowHeight=function(n,t){for(var i,u,e=this.RowIndex,f=1,r=0;r<n.ChildWidgets.length;r++)i=n.ChildWidgets[r],f=i.TableCell.CellFormat.RowSpan,e-i.TableCell.OwnerRow.RowIndex==f-1&&(u=i.Y+i.Height+i.Margin.Bottom-t.Y,t.Height<u&&(t.Height=u))},i.prototype.UpdateRowHeightByCellSpacing=function(n,t){this.OwnerTable.TableFormat.CellSpacing>0&&this.OwnerTable.TableWidgets.Count>1&&n.Y==this.OwnerTable.Document.OwnerControl.Viewer.ClientArea.Top&&t instanceof ft&&(n.Height=n.Height-this.OwnerTable.TableFormat.CellSpacing/2)},i.prototype.IsRowSpanEnd=function(n){for(var i,u=this.RowIndex,r=1,t=0;t<n.SplittedCellWidgets.length;t++)if(i=n.SplittedCellWidgets[t],r=i.TableCell.CellFormat.RowSpan,u-i.TableCell.OwnerRow.RowIndex==r-1)return!0;return!1},i.prototype.GetMaxTopOrBottomCellMargin=function(n){for(var i,r,t=0,u=0;u<this.Cells.Count;u++)i=this.Cells[u].CellFormat,i.ContainsMargins()?n==0&&i.TopMargin>t?t=i.TopMargin:n==1&&i.BottomMargin>t&&(t=i.BottomMargin):(r=this.Cells[u].OwnerTable.TableFormat,n==0&&r.TopMargin>t?t=r.TopMargin:n==1&&r.BottomMargin>t&&(t=r.BottomMargin));return t},i.prototype.GetNextParagraph=function(){var t=this,i,n;return t.NextNode!=null?(i=t.NextNode.Cells[0],n=i.Blocks[0],n instanceof f?n:n.GetFirstParagraphInFirstCell()):this.OwnerTable.GetNextParagraph()},i.prototype.GetPreviousParagraph=function(){var t=this,i,n;return t.PreviousNode!=null?(i=t.PreviousNode.Cells[t.PreviousNode.Cells.Count-1],n=i.Blocks[i.Blocks.Count-1],n instanceof f?n:n.GetLastParagraphInLastCell()):this.OwnerTable.GetPreviousParagraph()},i.prototype.Contains=function(n){if(this.Cells.Contains(n))return!0;while(n.OwnerTable.IsInsideTable){if(this.Cells.Contains(n))return!0;n=n.OwnerTable.AssociatedCell}return this.Cells.Contains(n)},i.prototype.Highlight=function(n,t,i,r){for(var f,u=0;u<this.Cells.Count;u++)f=this.GetCellLeft(this.Cells[u]),b.Round(i,2)<=b.Round(f,2)&&b.Round(f,2)<b.Round(r,2)&&this.Cells[u].HighlightInternal(n,t)},i.prototype.HighlightInternal=function(n,t,r,u){for(var f=0;f<this.Cells.Count;f++)this.Cells[f].HighlightInternal(n,t);u.Paragraph.IsInsideTable&&this.Contains(u.Paragraph.AssociatedCell)||this.NextNode instanceof i&&this.NextNode.HighlightInternal(n,t,r,u)},i.prototype.GetCellLeft=function(n){var t=0;return n.TableCellWidgets.Count>0&&(t+=n.TableCellWidgets[0].X-n.TableCellWidgets[0].Margin.Left),t},i.prototype.GetSelectedContentAsHtmlInternal=function(n,t,i){var u="<tr ",r,f;for(u+=this.RowFormat.GetAsHtmlStyle(),u+=">",r=0;r<this.Cells.Count;r++)f=this.GetCellLeft(this.Cells[r]),b.Round(t,2)<=b.Round(f,2)&&b.Round(f,2)<b.Round(i,2)&&(u+=this.Cells[r].GetContentAsHtml());return u+"<\/tr>"},i.prototype.GetSelectedContentAsHtml=function(n,t,r){var u="<tr ",f;for(u+=this.RowFormat.GetAsHtmlStyle(),u+=">",f=0;f<this.Cells.Count;f++)u+=this.Cells[f].GetContentAsHtml();return(u+="<\/tr>",r.Paragraph.IsInsideTable&&this.Contains(r.Paragraph.AssociatedCell))?u:this.NextNode instanceof i?u+this.NextNode.GetSelectedContentAsHtml(n,t,r):u},i.prototype.GetContentAsHtml=function(){var n="<tr ",t;for(n+=this.RowFormat.GetAsHtmlStyle(),n+=">",t=0;t<this.Cells.Count;t++)n+=this.Cells[t].GetContentAsHtml();return n+"<\/tr>"},i.prototype.GetPreviousParagraphSelection=function(n){var i=this.Cells[this.Cells.Count-1],r,t;return n.Start.Paragraph.IsInsideTable&&this.OwnerTable.Contains(n.Start.Paragraph.AssociatedCell)&&(r=this.OwnerTable.GetCellInTable(n.Start.Paragraph.AssociatedCell),i=this.GetLastCellInRegion(r,n.UpDownSelectionLength,!0)),t=i.Blocks[i.Blocks.Count-1],t instanceof f?t:t.GetLastParagraphInLastCell()},i.prototype.GetNextParagraphSelection=function(n){var i=this.Cells[0],r,t;return n.Start.Paragraph.IsInsideTable&&this.OwnerTable.Contains(n.Start.Paragraph.AssociatedCell)&&(r=this.OwnerTable.GetCellInTable(n.Start.Paragraph.AssociatedCell),i=this.GetFirstCellInRegion(r,n.UpDownSelectionLength,!1)),t=i.Blocks[0],t instanceof f?t:t.GetFirstParagraphInFirstCell()},i.prototype.GetFirstCellInRegion=function(n,t,i){var f=n.OwnerRow.GetCellLeft(n),o=f+n.CellFormat.CellWidth,e=!0,r,u;if(f<=t&&t<o){for(r=0;r<this.Cells.Count;r++)if(u=this.GetCellLeft(this.Cells[r]),b.Round(f,2)<=b.Round(u,2)&&b.Round(u,2)<b.Round(o,2))return e=!1,this.Cells[r]}else for(r=0;r<this.Cells.Count;r++)if(u=this.GetCellLeft(this.Cells[r]),u<=t&&u+this.Cells[r].CellFormat.CellWidth>t)return e=!1,this.Cells[r];if(e){if(this.PreviousNode!=null&&i)return this.PreviousNode.GetFirstCellInRegion(n,t,i);if(this.NextNode!=null&&!i)return this.NextNode.GetFirstCellInRegion(n,t,i)}return this.Cells[0]},i.prototype.GetLastCellInRegion=function(n,t,i){var f=n.OwnerRow.GetCellLeft(n),o=f+n.CellFormat.CellWidth,e=!0,r,u;if(f<=t&&t<o){for(r=this.Cells.Count-1;r>=0;r--)if(u=this.GetCellLeft(this.Cells[r]),b.Round(f,2)<=b.Round(u,2)&&b.Round(u,2)<b.Round(o,2))return e=!1,this.Cells[r]}else for(r=this.Cells.Count-1;r>=0;r--)if(u=this.GetCellLeft(this.Cells[r]),u<=t&&u+this.Cells[r].CellFormat.CellWidth>t)return e=!1,this.Cells[r];if(e){if(this.PreviousNode!=null&&i)return this.PreviousNode.GetLastCellInRegion(n,t,i);if(this.NextNode!=null&&!i)return this.NextNode.GetLastCellInRegion(n,t,i)}return this.Cells[this.Cells.Count-1]},i.prototype.GetNextSelection=function(n){var r,i,t;return this.NextNode!=null?(r=n.IsEmpty||n.IsForward,r?(i=this.NextNode.Cells[this.NextNode.Cells.Count-1],t=i.Blocks[i.Blocks.Count-1],t instanceof f?t:t.GetLastParagraphInLastCell()):this.NextNode.GetNextParagraphSelection(n)):this.OwnerTable.GetNextSelection(n)},i.prototype.GetPreviousSelection=function(n){if(this.PreviousNode!=null){if(n.IsForward)return this.PreviousNode.GetPreviousParagraphSelection(n);var i=this.PreviousNode.Cells[0],t=i.Blocks[0];return t instanceof f?t:t.GetFirstParagraphInFirstCell()}return this.OwnerTable.GetPreviousSelection(n)},i.prototype.ClearWidgets=function(){var n,t;if(this.TableRowWidgets!=null&&this.TableRowWidgets.Count>0)for(n=0;n<this.TableRowWidgets.Count;n++)t=this.TableRowWidgets[n],t.Dispose(),this.TableRowWidgets.Remove(t),n--},i.prototype.Dispose=function(){var n,t;if(this.SetOwner(null),this.TableRowWidgets!=null&&(this.ClearWidgets(),this.TableRowWidgets=null),this.Cells!=null){for(this.Cells.Dispose(),n=0;n<this.Cells.Count;n++)t=this.Cells[n],t.Dispose(),this.Cells.Remove(t),n--;this.Cells=null}this.Fields=null;this.FieldCharacter=null},i}(ut);i.TableRowAdv=ui;dr=function(){function n(){this.preferredwidth=0;this.minwidth=0;this.maxwidth=0}return Object.defineProperty(n.prototype,"PreferredWidth",{get:function(){return this.preferredwidth},set:function(n){this.preferredwidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"MinWidth",{get:function(){return this.minwidth},set:function(n){this.minwidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"MaxWidth",{get:function(){return this.maxwidth},set:function(n){this.maxwidth=n},enumerable:!0,configurable:!0}),n}();i.TableColumnAdv=dr;ht=function(t){function i(n){t.call(this,n);this.colIndex=0;this.ChildNodes=new li(this);this.CellFormat=new eu(this);this.TableCellWidgets=new o}return n(i,t),Object.defineProperty(i.prototype,"Blocks",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftMargin",{get:function(){return this.CellFormat.ContainsMargins()?this.CellFormat.LeftMargin:this.OwnerTable!=null&&this.OwnerTable.TableFormat!=null?this.OwnerTable.TableFormat.LeftMargin:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopMargin",{get:function(){return this.CellFormat.ContainsMargins()?this.CellFormat.TopMargin:this.OwnerTable!=null&&this.OwnerTable.TableFormat!=null?this.OwnerTable.TableFormat.TopMargin:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightMargin",{get:function(){return this.CellFormat.ContainsMargins()?this.CellFormat.RightMargin:this.OwnerTable!=null&&this.OwnerTable.TableFormat!=null?this.OwnerTable.TableFormat.RightMargin:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BottomMargin",{get:function(){return this.CellFormat.ContainsMargins()?this.CellFormat.BottomMargin:this.OwnerTable!=null&&this.OwnerTable.TableFormat!=null?this.OwnerTable.TableFormat.BottomMargin:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerRow",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerTable",{get:function(){return this.OwnerRow!=null?this.OwnerRow.OwnerTable:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ColumnIndex",{get:function(){return this.colIndex},set:function(n){this.colIndex=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerColumn",{get:function(){return this.OwnerTable.TableHolder.Columns[this.ColumnIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Section",{get:function(){return this.OwnerTable!=null?this.OwnerTable.Section:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"CellIndex",{get:function(){return this.OwnerRow!=null?this.OwnerRow.Cells.IndexOf(this):-1},enumerable:!0,configurable:!0}),i.prototype.LayoutItems=function(n,t,i){var e,r,u;for(this.TableCellWidgets!=null&&this.TableCellWidgets.length>0&&this.TableCellWidgets.Clear(),this.AddTableCellWidget(n.ClientActiveArea,t,i),n.UpdateClientAreaForCell(this,!0),this.Blocks.length==0&&(e=null,e=new f(this),this.Blocks.Add(e)),r=0;r<this.Blocks.length;r++)u=this.Blocks[r],n.UpdateClientAreaForBlock(u,!0),u.LayoutItems(n),n.UpdateClientAreaForBlock(u,!1);this.UpdateWidgetToRow(n);n.UpdateClientAreaForCell(this,!1)},i.prototype.AddTableCellWidget=function(n,t,i){var r=new ni(this),e=0,u=0,o=0,h=t,s=0,c=i,f;this.CellFormat.ContainsMargins()?(o=this.CellFormat.LeftMargin,s=this.CellFormat.RightMargin):(o=this.OwnerTable.TableFormat.LeftMargin,s=this.OwnerTable.TableFormat.RightMargin);r.Margin=new ei(o,h,s,c);r.Width=this.CellFormat.CellWidth;this.PreviousNode!=null&&(e=this.PreviousNode.ColumnIndex+this.PreviousNode.CellFormat.ColumnSpan);u=this.OwnerTable.TableFormat.CellSpacing;this.TableCellWidgets.Add(r);f=0;e<this.ColumnIndex&&(f=this.OwnerTable.TableHolder.GetPreviousSpannedCellWidth(e,this.ColumnIndex),e==0&&(f=f-u/2));r.X=n.X+f+r.Margin.Left;r.Y=n.Y+r.Margin.Top+u;r.Width=r.Width-r.Margin.Left-r.Margin.Right;u>0&&(r.X+=u,r.Width-=this.OwnerTable.TableHolder.Columns.Count==1?u*2:this.ColumnIndex==0||this.ColumnIndex==this.OwnerTable.TableHolder.Columns.Count-1?u*2-u/2:u,r.RightBorderWidth=this.CellFormat.Borders.GetCellRightBorder(this).GetLineWidth(),r.Width-=r.RightBorderWidth);r.LeftBorderWidth=this.CellFormat.Borders.GetCellLeftBorder(this).GetLineWidth();r.X+=r.LeftBorderWidth;r.Width-=r.LeftBorderWidth;this.CellIndex==this.OwnerRow.Cells.Count-1&&(r.RightBorderWidth=this.CellFormat.Borders.GetCellRightBorder(this).GetLineWidth(),r.Width-=r.RightBorderWidth);r.Margin.Left=r.Margin.Left+r.LeftBorderWidth;r.Margin.Right=r.Margin.Right+r.RightBorderWidth},i.prototype.UpdateWidgetToRow=function(){var t=this.TableCellWidgets[this.TableCellWidgets.length-1],n=this.OwnerRow.TableRowWidgets[this.OwnerRow.TableRowWidgets.length-1],u=n.X,i,r;n.ChildWidgets.length>0&&(i=n.ChildWidgets[n.ChildWidgets.length-1],u=i.X+i.Width+i.Margin.Right);n.ChildWidgets.Add(t);t.ContainerWidget=n;this.OwnerRow.RowFormat.HeightType!=ot.Exactly&&this.OwnerRow.RowFormat.Height>0&&this.CellIndex==0&&(n.Height=n.Height+this.OwnerRow.RowFormat.Height);this.CellFormat.RowSpan==1&&(r=t.Height+t.Margin.Top+t.Margin.Bottom,n.Height-this.OwnerTable.TableFormat.CellSpacing<r&&(n.Height=r+this.OwnerTable.TableFormat.CellSpacing))},i.prototype.GetNextParagraph=function(){if(this.NextNode!=null){var n=this.NextNode.Blocks[0];return n instanceof f?n:n.GetFirstParagraphInFirstCell()}return this.OwnerRow.GetNextParagraph()},i.prototype.GetPreviousParagraph=function(){if(this.PreviousNode!=null){var n=this.PreviousNode.Blocks[this.PreviousNode.Blocks.Count-1];return n instanceof f?n:n.GetLastParagraphInLastCell()}return this.OwnerRow.GetPreviousParagraph()},i.prototype.GetFirstParagraph=function(){var n=this.Blocks[0];return n instanceof f?n:n.GetFirstParagraphInFirstCell()},i.prototype.GetFirstBlock=function(){return this.Blocks.Count>0?this.Blocks[0]:null},i.prototype.GetLastParagraph=function(){var n=this.Blocks[this.Blocks.Count-1];return n instanceof f?n:n.GetLastParagraphInLastCell()},i.prototype.Contains=function(n){if(this==n)return!0;while(n.OwnerTable.IsInsideTable){if(this==n.OwnerTable.AssociatedCell)return!0;n=n.OwnerTable.AssociatedCell}return!1},i.prototype.GetContainerCell=function(){for(var n=this;n.OwnerTable!=null&&n.OwnerTable.IsInsideTable;)n=n.OwnerTable.AssociatedCell;return n},i.prototype.GetContainerCellOf=function(n){for(var t=this;t.OwnerTable.IsInsideTable;){if(t.OwnerTable.Contains(n))return t;t=t.OwnerTable.AssociatedCell}return t},i.prototype.GetSelectedCell=function(n){var t=this;if(t.OwnerTable==n.OwnerTable)return t;while(t.OwnerTable.IsInsideTable){if(t.OwnerTable.AssociatedCell==n)return t;t=t.OwnerTable.AssociatedCell}return t},i.prototype.IsCellSelected=function(n,t){var i=this.GetLastParagraph(),r=i==t.Paragraph&&t.Offset==i.GetLength()+1;return r||!this.Contains(n.Paragraph.AssociatedCell)||!this.Contains(t.Paragraph.AssociatedCell)},i.prototype.Highlight=function(n,t,i,r){var u,f,e,o;if(r.Paragraph.IsInsideTable)if(u=this.GetContainerCellOf(r.Paragraph.AssociatedCell),u.OwnerTable.Contains(r.Paragraph.AssociatedCell))if(f=this.GetSelectedCell(u),e=r.Paragraph.AssociatedCell.GetSelectedCell(u),u.Contains(r.Paragraph.AssociatedCell))u.IsCellSelected(i,r)?u.HighlightInternal(n,t):f==u?i.Paragraph.Highlight(n,t,i,r):f.HighlightContainer(n,t,i,r);else if(u.HighlightInternal(n,t),u.OwnerRow==e.OwnerRow){for(f=u;f.NextNode!=null;)if(f=f.NextNode,f.HighlightInternal(n,t),f==e)break}else u.OwnerTable.HighlightCells(n,t,u,e);else u.HighlightContainer(n,t,i,r);else o=this.GetContainerCell(),o.HighlightContainer(n,t,i,r)},i.prototype.HighlightInternal=function(n,t){for(var i=0;i<this.TableCellWidgets.Count;i++)this.TableCellWidgets[i].Highlight(n,t)},i.prototype.HighlightContainer=function(n,t,i,r){this.OwnerRow.HighlightInternal(n,t,i,r);var u=this.OwnerTable.GetNextRenderedBlock();u.Highlight(n,t,i,r)},i.prototype.GetCellLeft=function(n){var t=0;return n.TableCellWidgets.Count>0&&(t+=n.TableCellWidgets[0].X-n.TableCellWidgets[0].Margin.Left),t},i.prototype.GetSelectedContentAsHtmlInternal=function(n,t,i){var r="",u,f,e,o;if(i.Paragraph.IsInsideTable)if(u=this.GetContainerCellOf(i.Paragraph.AssociatedCell),u.OwnerTable.Contains(i.Paragraph.AssociatedCell)){if(r+="<table ",r+=u.OwnerTable.TableFormat.GetAsHtmlStyle(),r+=">",f=this.GetSelectedCell(u),e=i.Paragraph.AssociatedCell.GetSelectedCell(u),u.Contains(i.Paragraph.AssociatedCell))u.IsCellSelected(t,i)?(r+="<tr ",r+=u.OwnerRow.RowFormat.GetAsHtmlStyle(),r+=">",r+=u.GetContentAsHtml(),r+="<\/tr>"):r=f==u?t.Paragraph.GetSelectedContentAsHtml(n,t,i):f.GetSelectedContentAsHtml(n,t,i);else if(u.OwnerRow==e.OwnerRow){for(r+="<tr ",r+=u.OwnerRow.RowFormat.GetAsHtmlStyle(),r+=">",r+=u.GetContentAsHtml(),f=u;f.NextNode!=null;)if(f=f.NextNode,r+=f.GetContentAsHtml(),f==e)break;r+="<\/tr>"}else r+=u.OwnerTable.GetSelectedContentAsHtmlInternal(n,u,e);r+="<\/table>"}else r+=u.GetSelectedContentAsHtml(n,t,i);else o=this.GetContainerCell(),r+=o.GetSelectedContentAsHtml(n,t,i);return r},i.prototype.GetSelectedContentAsHtml=function(n,t,i){var r="",u;return r+="<table ",r+=this.OwnerTable.TableFormat.GetAsHtmlStyle(),r+=">",r+=this.OwnerRow.GetSelectedContentAsHtml(n,t,i),r+="<\/table>",u=this.OwnerTable.GetNextRenderedBlock(),r+u.GetSelectedContentAsHtml(n,t,i)},i.prototype.GetContentAsHtml=function(){var n="<td ",t;for(n+=this.CellFormat.GetAsHtmlStyle(),n+=">",t=0;t<this.Blocks.Count;t++)n+=this.Blocks[t].GetContentAsHtml();return n+"<\/td>"},i.prototype.GetNextSelection=function(n){var t;return this.NextNode!=null?n.IsEmpty||n.IsForward?(t=this.NextNode.Blocks[this.NextNode.Blocks.Count-1],t instanceof f?t:t.GetLastParagraphInLastCell()):(t=this.NextNode.Blocks[0],t instanceof f?t:t.Rows[0].GetNextParagraphSelection(n)):this.OwnerRow.GetNextSelection(n)},i.prototype.GetPreviousSelection=function(n){var t;return this.PreviousNode!=null?n.IsForward?(t=this.PreviousNode.Blocks[this.PreviousNode.Blocks.Count-1],t instanceof f?t:t.Rows[t.Rows.Count-1].GetPreviousParagraphSelection(n)):(t=this.PreviousNode.Blocks[0],t instanceof f?t:t.GetFirstParagraphInLastRow()):this.OwnerRow.GetPreviousSelection(n)},i.prototype.ClearWidgets=function(){var n,t;if(this.TableCellWidgets!=null&&this.TableCellWidgets.Count>0)for(n=0;n<this.TableCellWidgets.Count;n++)t=this.TableCellWidgets[n],t.Dispose(),this.TableCellWidgets.Remove(t),n--},i.prototype.Dispose=function(){var n,t;if(this.SetOwner(null),this.CellFormat.Dispose(),this.TableCellWidgets!=null&&(this.ClearWidgets(),this.TableCellWidgets=null),this.Blocks!=null){for(this.Blocks.Dispose(),n=0;n<this.Blocks.Count;n++)t=this.Blocks[n],t.Dispose(),this.Blocks.Remove(t),n--;this.Blocks=null}this.Fields=null;this.FieldCharacter=null},i}(ut);i.TableCellAdv=ht;f=function(t){function i(n){t.call(this,n);this.ChildNodes=new hr(this);this.CharacterFormat=new pr(this);this.ParagraphFormat=new nr(this);this.paragraphWidgets=new o}return n(i,t),Object.defineProperty(i.prototype,"Inlines",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ParagraphWidgets",{get:function(){return this.paragraphWidgets},enumerable:!0,configurable:!0}),i.prototype.IsEmpty=function(){return this.Inlines.length==0?!0:!1},i.prototype.GetTabWidth=function(n){var i,t;if(n.ClientActiveArea.X<n.ClientArea.X)return n.ClientArea.X-n.ClientActiveArea.X;if(i=n.ClientActiveArea.X-(n.ClientArea.X-this.LeftIndent),t=this.Document.DefaultTabWidth,i==0||t==0)return t;var u=Math.round(i)*100%(Math.round(t)*100)/100,f=(Math.round(i)-u)/Math.round(t),r=(f+1)*t;return r-i>0?r-i:t},i.prototype.AddParagraphWidget=function(n){var t=new wt(this);if(this.IsEmpty()&&(this.ParagraphFormat.TextAlignment==nt.Center||this.ParagraphFormat.TextAlignment==nt.Right)){var i=this.GetParagraphMarkSize(0,0),f=i.TopMargin,e=i.BottomMargin,r=i.Width,u=n.Left;u+=this.ParagraphFormat.TextAlignment==nt.Center?(n.Width-r)/2:n.Width-r;t.Width=r;t.X=n.X;t.Y=n.Y}else t.Width=n.Width,t.X=n.X,t.Y=n.Y;this.ParagraphWidgets.push(t)},i.prototype.LayoutItems=function(n){var t,i;if(this.paragraphWidgets!=null&&this.paragraphWidgets.Count>0&&this.paragraphWidgets.Clear(),this.AddParagraphWidget(n.ClientActiveArea),n.IsFieldCode||this.ParagraphFormat.ListFormat!=null&&this.ParagraphFormat.ListFormat.List!=null&&this.ParagraphFormat.ListFormat.ListLevelNumber>=0&&this.ParagraphFormat.ListFormat.ListLevelNumber<9&&this.LayoutList(n),this.IsEmpty())this.LayoutEmptyLineWidget(n);else for(t=0;t<this.Inlines.length;t++)t==0&&n.UpdateClientWidth(-this.ParagraphFormat.FirstLineIndent),i=this.Inlines[t],i.LayoutItems(n);this.UpdateWidgetToPage(n)},i.prototype.LayoutList=function(n){var r,i,t;(n.UpdateClientWidth(-this.ParagraphFormat.FirstLineIndent),r=this.Document,i=this.ParagraphFormat.ListFormat.ListLevel,i!=null)&&(t=new et(this,i,!1),t.Text=i.ListLevelPattern==y.Bullet?i.NumberFormat:r.GetListNumber(this.ParagraphFormat.ListFormat),h.UpdateTextSize(t),n.CutFromLeft(n.ClientActiveArea.X+t.Width),n.LineElements.Add(t),i.FollowCharacter!=hu.None)&&(t=new et(this,i,!0),i.FollowCharacter==hu.Tab?(t.Text="\t",t.Width=this.GetTabWidth(n)):(t.Text=" ",h.UpdateTextSize(t)),n.CutFromLeft(n.ClientActiveArea.X+t.Width),n.LineElements.Add(t),n.UpdateClientWidth(this.ParagraphFormat.FirstLineIndent))},i.prototype.LayoutEmptyLineWidget=function(n){var p=h.GetParagraphMarkSize(this.CharacterFormat),r=p.Height,w=r-p.BaselineOffset,l,v,y,c;!isNaN(n.LineElements.MaxTextElementHeight)&&r<n.LineElements.MaxTextElementHeight&&(r=n.LineElements.MaxTextElementHeight,w=r-n.LineElements.MaxTextElementBaselineOffset);l=this.GetBeforeSpacing();n.CurrentHeaderFooter==null&&n.ClientActiveArea.Height<l+r&&n.ClientActiveArea.Y!=n.ClientArea.Y&&this.MoveToNextPage(n);var o=this.GetLineSpacing(r),f=this.AddLineWidget(),i=0,u=0,s=0,e=r,a=0,t=null;n.LineElements.Count>0&&(t=n.LineElements[0]);t!=null&&(v=t.BaselineOffset,i=n.LineElements.MaxBaselineOffset-v,t.Height<r?a=r-w-(t.Height-(t.Height-v)):e=t.Height);y=this.ParagraphFormat.LineSpacingType;y==kt.Multiple?o>r?u+=o-r:i+=o-r:y==kt.Exactly?i+=o-(i+e+u):o>i+e+u&&(i+=o-(i+e+u));i+=l;u+=this.ParagraphFormat.AfterSpacing;t!=null&&(c=this.ParagraphFormat.TextAlignment,c==nt.Right?s=n.ClientArea.Width-t.Width:c==nt.Center&&(s=(n.ClientArea.Width-t.Width)/2),t.Margin=new ei(s,a+i,0,u),t.CurrentLineWidget=f,f.Height=i+e+u,f.Children.Add(t));n.LineElements.Count>1&&n.LineElements[1]instanceof et&&(t=n.LineElements[1],c=this.ParagraphFormat.TextAlignment,c==nt.Right?s=n.ClientArea.Width-t.Width:c==nt.Center&&(s=(n.ClientArea.Width-t.Width)/2),t.Margin=new ei(s,a+i,0,u),t.CurrentLineWidget=f,f.Height=i+e+u,f.Children.Add(t));f.Height=i+e+u;n.CutFromTop(n.ClientActiveArea.Y+f.Height);n.LineElements.Clear()},i.prototype.MoveToNextPage=function(n){var u=this.ParagraphWidgets[this.ParagraphWidgets.length-1],f=null,r,t,h,o,e,s;if(n.LineElements.length>0&&(f=n.LineElements.ToList(),n.LineElements.Clear()),r=null,u.ChildWidgets.Count>0?(this.UpdateWidgetToPage(n),r=u.ContainerWidget):this.PreviousBlock instanceof i?r=this.PreviousBlock.ParagraphWidgets[this.PreviousBlock.ParagraphWidgets.Count-1].ContainerWidget:this.PreviousBlock instanceof w&&(r=this.PreviousBlock.TableWidgets[this.PreviousBlock.TableWidgets.Count-1].ContainerWidget),t=0,r!=null&&(t=n.Pages.IndexOf(r.Page)),t==n.Pages.Count-1||n.Pages[t+1].Section!=this.Section?(h=n.CreateNewPage(this.Section),n.Pages[t+1].Section!=this.Section&&n.InsertPage(t+1,h)):(n.Pages[t+1].BoundingRectangle=new v(n.Pages[t+1].BoundingRectangle.X,n.Pages[t].BoundingRectangle.Bottom+20,n.Pages[t+1].BoundingRectangle.Width,n.Pages[t+1].BoundingRectangle.Height),n.UpdateClientArea(this.Section.SectionFormat)),n.UpdateClientAreaForBlock(this,!0),u.ChildWidgets.Count>0?this.AddParagraphWidget(n.ClientActiveArea):u.UpdateClientAreaLocation(n.ClientActiveArea),f!=null&&n.LineElements.Count==0){for(o=n.ClientActiveArea.X,e=0;e<f.Count;e++)s=f[e],o+=s.Width,n.LineElements.Add(s);n.CutFromLeft(o)}},i.prototype.UpdateWidgetToPage=function(n){var t=this.ParagraphWidgets[this.ParagraphWidgets.length-1],i;this.IsInsideTable?(i=this.AssociatedCell.TableCellWidgets[this.AssociatedCell.TableCellWidgets.length-1],t.Height=n.ClientActiveArea.Y-t.Y,i.Height=n instanceof ft?this.AssociatedCell.OwnerRow.RowFormat.HeightType==ot.Exactly?this.AssociatedCell.OwnerRow.RowFormat.Height:this.AssociatedCell.TableCellWidgets.Count<=1&&this.AssociatedCell.OwnerRow.RowFormat.HeightType==ot.Atleast?Math.max(this.AssociatedCell.OwnerRow.RowFormat.Height,i.Height+t.Height):i.Height+t.Height:i.Height+t.Height,i.ChildWidgets.Add(t),t.ContainerWidget=i):(t.Height=n.ClientActiveArea.Y-t.Y,this._UpdateWidgetsToBody(n,t))},i.prototype.GetBeforeSpacing=function(){var n=0;return this.PreviousBlock instanceof i?this.PreviousBlock.ParagraphFormat.AfterSpacing<this.ParagraphFormat.BeforeSpacing&&(n=this.ParagraphFormat.BeforeSpacing-this.PreviousBlock.ParagraphFormat.AfterSpacing):n=this.ParagraphFormat.BeforeSpacing,n},i.prototype.GetLineSpacing=function(n){var t=0;switch(this.ParagraphFormat.LineSpacingType){case kt.AtLeast:case kt.Exactly:t=this.ParagraphFormat.LineSpacing;break;default:t=this.ParagraphFormat.LineSpacing*n}return t},i.prototype.GetParagraphMarkSize=function(n,t){var i=h.GetParagraphMarkSize(this.CharacterFormat),e=i.BaselineOffset,r=i.Height,o=e,f,u,c,s;return this.paragraphWidgets.Count>0&&this.paragraphWidgets[0].ChildWidgets.Count>0&&(f=this.paragraphWidgets[0].ChildWidgets[0],f.Children.Count>0&&f.Children[0]instanceof et&&r<f.Children[0].Height&&(r=f.Children[0].Height,o=f.Children[0].BaselineOffset)),u=this.GetLineSpacing(r),c=this.GetBeforeSpacing(),n=o-e,t=r-o-(i.Height-e),s=this.ParagraphFormat.LineSpacingType,s==kt.Multiple?u>r?t+=u-r:n+=u-r:s==kt.Exactly?n+=u-(n+i.Height+t):u>n+i.Height+t&&(n+=u-(n+i.Height+t)),n+=c,t+=this.ParagraphFormat.AfterSpacing,{Width:i.Width,Height:i.Height,TopMargin:n,BottomMargin:t}},i.prototype.AddLineWidget=function(){var n=null,t;return t=this.ParagraphWidgets[this.ParagraphWidgets.length-1],n=new gi(t),n.Width=t.Width,t.ChildWidgets.push(n),n.CurrentParagraphWidget=t,n},i.prototype.GetStartOffset=function(){for(var n,t=0,i=0;i<this.Inlines.length;i++)if(n=this.Inlines[i],n.Length!=0){if(n instanceof k||n instanceof ct||n instanceof e&&n.IsLinkedFieldCharacter())return t;t+=n.Length}return t},i.prototype.GetLength=function(){for(var t=0,n=0;n<this.Inlines.length;n++)t+=this.Inlines[n].Length;return t},i.prototype.GetOffset=function(n,t){var r,i;if(n==null)return t;for(r=t,i=0;i<this.Inlines.length;i++){if(n==this.Inlines[i])break;r+=this.Inlines[i].Length}return r},i.prototype.GetLineWidget=function(n){var t=null;if(this.IsEmpty())this.paragraphWidgets.Count>0&&this.paragraphWidgets[0].ChildWidgets.Count>0&&(t=this.paragraphWidgets[0].ChildWidgets[0]);else{var i=0,r=this.GetInline(n,i),u=r.inline;i=r.index;t=u.GetLineWidget(i)}return t},i.prototype.GetLineWidgetInternal=function(n,t){var i=null;if(this.IsEmpty())this.paragraphWidgets.Count>0&&this.paragraphWidgets[0].ChildWidgets.Count>0&&(i=this.paragraphWidgets[0].ChildWidgets[0]);else{var r=0,u=this.GetInline(n,r),f=u.inline;r=u.index;i=f.GetLineWidgetInternal(r,t)}return i},i.prototype.GetPhysicalPosition=function(n){return this.GetPhysicalPositionInternal(n,!0)},i.prototype.GetPhysicalPositionInternal=function(n,t){var u,f;if(this.IsEmpty()){u=this.paragraphWidgets[0].X;this.paragraphWidgets[0].ChildWidgets.length>0&&(f=this.paragraphWidgets[0].ChildWidgets[0],u=f.GetLeft());var e=0,s=this.GetParagraphMarkSize(e,0);return n>0&&(u+=s.Width),new rt(u,this.paragraphWidgets[0].Y+e)}var r=0,o=this.GetInline(n,r),i=o.inline;return r=o.index,i.Length==r&&i.NextNode!=null&&i.Elements.Count>0&&i.NextNode.Elements.Count>0&&i.Elements[i.Elements.Count-1].CurrentLineWidget!=i.NextNode.Elements[0].CurrentLineWidget&&(i=i.NextNode,r=0),i.GetPhysicalPosition(r,t)},i.prototype.GetEndPosition=function(){var n=this.paragraphWidgets[this.paragraphWidgets.Count-1],i=n.X,r=n.Y,t=null;n.ChildWidgets.Count>0&&(t=n.ChildWidgets[n.ChildWidgets.Count-1],i+=t.GetWidth(!1));t!=null&&(r=t.GetTop());var u=this.GetParagraphMarkSize(0,0);return new rt(i,r+u.TopMargin)},i.prototype.GetInline=function(n,t){for(var i=null,r=0,u=!1,f=0;f<this.Inlines.length;f++){if(i=this.Inlines[f],!u&&(i instanceof k||i instanceof ct||i instanceof e&&i.IsLinkedFieldCharacter())&&(u=!0),u&&n<=r+i.Length)return t=n-r,t<0&&(t=0),{inline:i,index:t};r+=i.Length}return n>r&&(t=i==null?n:i.Length),{inline:i,index:t}},i.prototype.HighlightSelectedContent=function(n,t,i,r){var u,o,c,p,l,v,h,y,b;if(i.Paragraph.IsInsideTable&&(!r.Paragraph.IsInsideTable||i.Paragraph.AssociatedCell!=r.Paragraph.AssociatedCell||i.Paragraph.AssociatedCell.IsCellSelected(i,r)))i.Paragraph.AssociatedCell.Highlight(n,t,i,r);else{if(u=null,o=0,this==r.Paragraph)if(i.Offset+1==r.Offset)c=this.GetInline(r.Offset,o),u=c.inline,o=c.index,u instanceof ct&&(p=this.GetOffset(u,0),p!=i.Offset&&(u=null));else{var f=0,w=i.Paragraph.GetInline(i.Offset,f),e=w.inline;f=w.index;f==e.Length&&(e=e.GetNextRenderedInline(f));l=r.Paragraph.GetInline(r.Offset,f);v=l.inline;f=l.index;e instanceof s&&v instanceof a&&e.fieldSeparator!=null&&(h=e.fieldSeparator.NextNode,h instanceof ct&&h.NextNode==v&&(u=h))}u instanceof ct&&n.OwnerControl.IsDocumentLoaded?(y=u.GetElementBoxInternal(o),b=y.element,o=y.index):this.Highlight(n,t,i,r)}},i.prototype.Highlight=function(n,t,i,r){var y=0,h=0,p=null,c=null,w=this.GetStartLineWidget(i,p,y),u=w.lineWidget,l,s,a,e,d,f,v,b,o,k;if(p=w.startElement,y=w.lineIndex,l=this.GetEndLineWidget(r,c,h),s=l.lineWidget,c=l.endElement,h=l.lineIndex,a=0,e=0,u!=null&&(a=u.GetTop(),e=u.GetLeftInternal(p,y)),u!=null&&u==s)d=s.GetLeftInternal(c,h),n.CreateHighlightBorder(t,u,d-e,e,a);else{if(f=this,u!=null)for(f!=u.CurrentParagraphWidget.CurrentNode&&(f=u.CurrentParagraphWidget.CurrentNode),n.CreateHighlightBorder(t,u,u.GetWidth(!0)-(e-u.CurrentParagraphWidget.X),e,a),v=u.CurrentParagraphWidget.ChildWidgets.IndexOf(u),b=f.ParagraphWidgets.IndexOf(u.CurrentParagraphWidget),o=b;o<f.ParagraphWidgets.Count;o++){if(o==b&&(v+=1),f.ParagraphWidgets[o].Highlight(n,t,v,s,c,h),f.ParagraphWidgets[o]==s.CurrentParagraphWidget)return;v=0}k=f.GetNextRenderedBlock();k!=null&&k.Highlight(n,t,i,r)}},i.prototype.GetStartLineWidget=function(n,t,i){var s=this==n.Paragraph?n.Offset:this.GetStartOffset(),h=this.GetInline(s,i),r=h.inline,u,f,o;return i=h.index,r instanceof e&&(u=r.GetRenderedInline(i),r=u.Inline,i=u.InlineIndex),s==this.GetLength()+1&&i++,r==null?this.ParagraphWidgets.Count>0?(f=this.ParagraphWidgets[0],{lineWidget:f.ChildWidgets.Count>0?f.ChildWidgets[0]:null,lineIndex:i,startElement:t}):null:(o=r.GetElementBoxInternal(i),t=o.element,i=o.index,t==null)?r.GetLineWidget(i):{lineWidget:t.CurrentLineWidget,lineIndex:i,startElement:t}},i.prototype.GetEndLineWidget=function(n,t,i){var s=n.Paragraph.GetInline(n.Offset,i),r=s.inline,f,u,o;return i=s.index,r instanceof e&&(f=r.GetRenderedInline(i),r=f.Inline,i=f.InlineIndex),r==null?(n.Offset==n.Paragraph.GetLength()+1&&(i=1),n.Paragraph.ParagraphWidgets.Count>0?(u=n.Paragraph.ParagraphWidgets[n.Paragraph.ParagraphWidgets.Count-1],{lineWidget:u.ChildWidgets.Count>0?u.ChildWidgets[u.ChildWidgets.Count-1]:null,lineIndex:i,endElement:t}):null):(n.Offset==n.Paragraph.GetLength()+1&&(i=r.Length+1),o=r.GetElementBoxInternal(i),t=o.element,i=o.index,t==null)?{lineWidget:r.GetLineWidget(i),lineIndex:i,endElement:t}:{lineWidget:t.CurrentLineWidget,lineIndex:i,endElement:t}},i.prototype.HasValidInline=function(n,t){for(var i,r=this.Inlines.IndexOf(n);r<this.Inlines.Count;r++)if(i=this.Inlines[r],i.Length!=0){if(i==t)return!1;if(i instanceof k||i instanceof ct||i instanceof e&&i.IsLinkedFieldCharacter())return!0}return!1},i.prototype.GetPreviousValidOffset=function(n){var r,i,u,t;if(n==0)return 0;for(r=0,i=0,u=0;u<this.Inlines.Count;u++)if(t=this.Inlines[u],t.Length!=0){if(n<=i+t.Length)return n-1==i?r:n-1;(t instanceof k||t instanceof ct||t instanceof e&&t.IsLinkedFieldCharacter())&&(r=i+t.Length);i+=t.Length}return n-1==i?r:n-1},i.prototype.GetEndOffset=function(){for(var n,i=0,r=0,t=0;t<this.Inlines.Count;t++)(n=this.Inlines[t],this.Inlines.length!=0)&&((n instanceof k||n instanceof ct||n instanceof e&&n.IsLinkedFieldCharacter())&&(i=r+n.Length),r+=n.Length);return i},i.prototype.GetNextStartInline=function(n){var i=0,u=this.GetInline(n,i),t=u.inline,r;return i=u.index,t!=null&&i==t.Length&&t.NextNode instanceof e&&(r=t.NextNode.GetNextValidInline(),r instanceof s&&(t=r)),t},i.prototype.GetNextValidOffset=function(n){for(var t,i=0,r=0;r<this.Inlines.Count;r++)if(t=this.Inlines[r],t.Length!=0){if(n<i+t.Length&&(t instanceof k||t instanceof ct||t instanceof e&&t.IsLinkedFieldCharacter()))return(n>i?n:i)+1;i+=t.Length}return n},i.prototype.GetSelectedContent=function(n,t,i){return t.Paragraph.IsInsideTable&&(!i.Paragraph.IsInsideTable||t.Paragraph.AssociatedCell!=i.Paragraph.AssociatedCell||t.Paragraph.AssociatedCell.IsCellSelected(t,i))?t.Paragraph.AssociatedCell.GetSelectedContentAsHtmlInternal(n,t,i):this.GetSelectedContentAsHtml(n,t,i)},i.prototype.GetSelectedContentAsHtml=function(n,t,i){var r="",u=null,h=null,c=null,l=0,v=0,f=null,e,y,w;if(this.ParagraphFormat.ListFormat!=null&&(f=this.ParagraphFormat.ListFormat.ListLevel),i.Paragraph==this){if(i.Paragraph.IsEmpty())return(i.Offset=this.GetStartOffset())?"":(f!=null?(r+=this.GetHtmlList(f,t),r+="<li "):r+="<p ",r+=this.ParagraphFormat.GetAsHtmlStyle()+"/>",r.indexOf("<ul")>-1?r+="<\/ul>":r.indexOf("<ol")>-1&&(r+="<\/ol>"),r);e=this.GetInline(i.Offset,0);c=e.inline;v=e.index}for(t.Paragraph==this?t.Offset==this.GetLength()+1||(f!=null?(r+=this.GetHtmlList(f,t),r+="<li "):r+="<p ",r+=this.ParagraphFormat.GetAsHtmlStyle()+">",this.IsEmpty()||(e=this.GetInline(t.Offset,0),u=h=e.inline,l=e.index)):(f!=null?(r+=this.GetHtmlList(f,t),r+="<li "):r+="<p ",r+=this.ParagraphFormat.GetAsHtmlStyle()+">",this.Inlines.Count>0&&(u=this.Inlines[0])),y=this,u==null&&r!=null&&(r+="&nbsp;");u!=null;){if(u instanceof k)r+="<span ",r+=u.CharacterFormat.GetAsHtmlStyle(),r+=">",r+=c==u?c==h?this.DecodeHtmlNames(u.Text.substring(l,v)):this.DecodeHtmlNames(u.Text.substring(0,v)):h==u?this.DecodeHtmlNames(u.Text.substring(l,h.Length)):this.DecodeHtmlNames(u.Text),r+="<\/span>";else if(u instanceof ct)r+="<img ",r+='width="'+u.Width+'" ',r+='height="'+u.Height+'" ',r+='src="'+u.ImageString+'" ',r+=u.CharacterFormat.GetAsHtmlStyle(),r+="/>";else if(u instanceof s&&u.IsLinkedFieldCharacter()){var o=u.GetFieldCode(),b=o.toLowerCase(),p=b.indexOf("hyperlink");p>-1&&(o=o.substr(p+9).trim(),r+="<a href="+o+">");u=u.fieldSeparator}else if(u instanceof a&&u.IsLinkedFieldCharacter()){var o=u.FieldBegin.GetFieldCode(),b=o.toLowerCase(),p=b.indexOf("hyperlink");p>-1&&(r+="<\/a>")}if(y=u.OwnerParagraph,u==c)break;u=u.NextNode}return r!=""&&(f!=null?(r+="<\/li>",r.indexOf("<ul")>-1?r+="<\/ul>":r.indexOf("<ol")>-1&&(r+="<\/ol>")):r+="<\/p>"),i.Paragraph!=y&&(w=this.GetNextRenderedBlock(),w!=null&&(r+=w.GetSelectedContentAsHtml(n,t,i))),r},i.prototype.GetContentAsHtml=function(){var i=null,n,r,t;for(this.ParagraphFormat.ListFormat!=null&&(i=this.ParagraphFormat.ListFormat.ListLevel),n="",i!=null?(n+=this.GetHtmlList(i,null),n+="<li "):n+="<p ",n+=this.ParagraphFormat.GetAsHtmlStyle(),n+=">",this.Inlines.length==0&&(n+="&nbsp;"),r=0;r<this.Inlines.length;r++)t=this.Inlines[r],t instanceof k?(n+="<span ",n+=t.CharacterFormat.GetAsHtmlStyle(),n+=">",n+=this.DecodeHtmlNames(t.Text),n+="<\/span>"):t instanceof ct&&(n+="<img ",n+='width="'+t.Width+'" ',n+='height="'+t.Height+'" ',n+='src="'+t.ImageString+'" ',n+=t.CharacterFormat.GetAsHtmlStyle(),n+="/>");return i!=null?(n+="<\/li>",n.indexOf("<ul")>-1?n+="<\/ul>":n.indexOf("<ol")>-1&&(n+="<\/ol>")):n+="<\/p>",n},i.prototype.GetHtmlList=function(n){var t="";if(n.ListLevelPattern==y.Bullet){t+='<ul type="';switch(n.NumberFormat){case vt.SQUAREBULLET:n.CharacterFormat.FontFamily!=null&&n.CharacterFormat.FontFamily=="Wingdings"&&(t+="square");break;case vt.DOTBULLET:n.CharacterFormat.FontFamily!=null&&n.CharacterFormat.FontFamily=="Symbol"&&(t+="disc");break;case vt.CIRCLEBULLET:n.CharacterFormat.FontFamily!=null&&n.CharacterFormat.FontFamily=="Symbol"&&(t+="circle")}t+='">'}else{t+='<ol type="';switch(n.ListLevelPattern){case y.Number:case y.Arabic:case y.Ordinal:t+="1";break;case y.LowLetter:t+="a";break;case y.UpLetter:t+="A";break;case y.LowRoman:t+="i";break;case y.UpRoman:t+="I"}t+='" start="'+n.StartAt.toString()+'">'}return t},i.prototype.ClearWidgets=function(){var n,t;if(this.paragraphWidgets!=null&&this.paragraphWidgets.Count>0)for(n=0;n<this.paragraphWidgets.Count;n++)t=this.paragraphWidgets[n],t.Dispose(),this.paragraphWidgets.Remove(t),n--},i.prototype.Dispose=function(){var n,t;if(this.CharacterFormat.Dispose(),this.ParagraphFormat.Dispose(),this.SetOwner(null),this.paragraphWidgets!=null&&(this.ClearWidgets(),this.paragraphWidgets=null),this.Inlines!=null){for(this.Inlines.Dispose(),n=0;n<this.Inlines.Count;n++)t=this.Inlines[n],t.Dispose(),this.Inlines.Remove(t),n--;this.Inlines=null}this.Fields=null;this.FieldCharacter=null},i.prototype.DecodeHtmlNames=function(n){var t,i,r;if(n=="\t")return"&emsp;";if(t=n.split(" "),i="",t.length>0)for(i=t[0],r=0;r<t.length-1;r++)i+="&nbsp;"+t[r+1];return i},i}(ki);i.ParagraphAdv=f;ai=function(t){function i(n){t.call(this,n);this.characterFormat=new pr(this);this.Elements=new o}return n(i,t),Object.defineProperty(i.prototype,"CharacterFormat",{get:function(){return this.characterFormat},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerParagraph",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Length",{get:function(){return 1},enumerable:!0,configurable:!0}),i.prototype.LayoutFieldCharacter=function(n){var i,t,r;this instanceof s?(t=this,!n.IsFieldCode&&(t.fieldEnd!=null||t.HasFieldEnd)&&(n.FieldStack.push(t),n.IsFieldCode=!0)):n.FieldStack.Count>0&&(this instanceof fi?(t=n.FieldStack.Last(),i=this,t.fieldSeparator==i&&(t.fieldEnd!=null||t.HasFieldEnd)&&(n.IsFieldCode=!1)):(t=n.FieldStack.Last(),r=this,t.fieldEnd==r&&(n.FieldStack.RemoveAt(n.FieldStack.length-1),n.IsFieldCode=!1,t.HasFieldEnd&&(t.HasFieldEnd=!1))))},i.prototype.LayoutItems=function(n){var o,u;if(this instanceof e){this.LayoutFieldCharacter(n);this.NextNode!=null||n.IsFieldCode||n.LineElements.length!=0&&this.MoveToNextLine(n);return}if(!n.IsFieldCode){this.Elements!=null&&this.Elements.Count>0&&this.Elements.Clear();this.AddElementBox(n);var t=this.Elements[0],f="",r=0;for(this instanceof k&&(o=this,f=o.Text);r<this.Elements.Count;)t=this.Elements[r],t instanceof l&&t==this.Elements[0]&&(h.GetTextSize(t,this.CharacterFormat),f=="\t"&&(t.Width=this.OwnerParagraph.GetTabWidth(n))),n.CurrentHeaderFooter==null&&n.ClientActiveArea.Height<t.Height&&n.ClientActiveArea.Y!=n.ClientArea.Y&&this.OwnerParagraph.MoveToNextPage(n),u=this.PreviousNode instanceof i?this.PreviousNode:null,u!=null&&u instanceof k&&u.Text=="\v"&&(this.MoveToNextLine(n),t.Width=t.Width),t.Width<n.ClientActiveArea.Width?this.AddElementToline(n,t):t instanceof l?t.Text=="\t"?(this.MoveToNextLine(n),t.Width=this.OwnerParagraph.GetTabWidth(n),this.AddElementToline(n,t)):this.SplitTextForClientArea(n,t,t.Text,t.Width,this.CharacterFormat):this.SplitElementForClientArea(t,n),r=this.Elements.IndexOf(t)+1,r>=this.Elements.Count&&this.NextNode==null&&this.MoveToNextLine(n)}},i.prototype.GetSubWidth=function(n,t,i,r){for(var e,s,v,o,f=0,c=!0,u="",a=n.LineElements.length-1;a>=0;a--)e=n.LineElements[a],e instanceof l?(s=e.Text,u=s+u,c&&s.trim()!=""?(/ $/.test(s)?(v=s.replace(/\s\s*$/,""),f+=h.MeasureTextExcludIngSpaceAtEnd(v,this.CharacterFormat).Width):f+=e.Width,c=!1):c||(f+=e.Width)):(u="a"+u,c=!1,f+=e.Width),t||(f=Math.round(f));return u=u.trim(),i=u.length-u.replace(/\s/g,"").length,o=n.ClientArea.Width-r-f,o<=0||i==0&&t?(i=0,o=0):t&&(o=o/i),{subWidth:o,spaceCount:i}},i.prototype.IsParagraphFirstLine=function(n){if(n.ParagraphWidgets.length==1){var t=n.ParagraphWidgets[0];return t.ChildWidgets==null||t.ChildWidgets.length==0}return!1},i.prototype.IsParagraphLastLine=function(n,t){var i=t.Inlines[t.Inlines.length-1];return this==i?i.Elements.Count==0||n.LineElements.Contains(i.Elements[i.Elements.Count-1]):!1},i.prototype.AlignLineElements=function(n,t,i,r,u,f,e,o,s,c){var y,p,w,a,v;return t instanceof l||t instanceof et?(y=t,p=t instanceof l?y.BaselineOffset:t.BaselineOffset,i+=n.LineElements.MaxBaselineOffset-p,r+=u-(t.Height-p),y!=null&&o==nt.Justify&&s>0&&(w=y.Width,a=y.Text,f||(a=a.replace(/^\s\s*/,""),f=a.length>0),f&&(v=a.length-a.replace(/\s/g,"").length,c&&(v-=a.length-a.replace(/\s\s*$/,"").length),s<v&&(w=h.MeasureTextExcludIngSpaceAtEnd(a,this.CharacterFormat).Width,v=s),v>0&&(y.Width=w+e*v,s-=v)))):(f=!0,i+=n.LineElements.MaxBaselineOffset-t.Height,r+=u),{topMargin:i,bottomMargin:r,addSubWidth:f,whiteSpaceCount:s}},i.prototype.MoveToNextLine=function(n){var e=this.Owner,l=e.ParagraphFormat,ft=this.IsParagraphFirstLine(e),g=this.IsParagraphLastLine(n,e),o=0,tt=0,w=0,i=0,it=0,r,b,k,c;ft&&(w=e.GetBeforeSpacing(),it=l.FirstLineIndent);g&&(tt=l.AfterSpacing);r=0;isNaN(n.LineElements.MaxTextElementHeight)?(b=h.MeasureText("a",e.CharacterFormat),r=b.Height,o=r-b.BaselineOffset):(r=n.LineElements.MaxTextElementHeight,o=r-n.LineElements.MaxTextElementBaselineOffset);n.CurrentHeaderFooter==null&&n.ClientActiveArea.Height<w+n.LineElements.MaxBaselineOffset+o&&n.ClientActiveArea.Y!=n.ClientArea.Y&&e.MoveToNextPage(n);i=e.GetLineSpacing(r);l.LineSpacingType==kt.Exactly&&i<o+n.LineElements.MaxBaselineOffset&&(i=o+n.LineElements.MaxBaselineOffset);var a=0,v=0,s=l.TextAlignment;s==nt.Left||s==nt.Justify&&g||(k=this.GetSubWidth(n,s==nt.Justify,v,it),a=k.subWidth,v=k.spaceCount);var y=this.OwnerParagraph.AddLineWidget(),rt=!1,ut=l.LineSpacingType;for(c=0;c<n.LineElements.length;c++){var t=0,u=0,d=0,f=n.LineElements[c],p=this.AlignLineElements(n,f,t,u,o,rt,a,s,v,c==n.LineElements.length-1);t=p.topMargin;u=p.bottomMargin;rt=p.addSubWidth;v=p.whiteSpaceCount;ut==kt.Multiple?i>r?u+=i-r:t+=i-r:ut==kt.Exactly?t+=i-(t+f.Height+u):i>t+f.Height+u&&(t+=i-(t+f.Height+u));t+=w;u+=tt;c==0&&(y.Height=t+f.Height+u,s==nt.Right?d=a:s==nt.Center&&(d=a/2));f.Margin=new ei(d,t,0,u);f.CurrentLineWidget=y;y.Children.Add(f)}n.CutFromTop(n.ClientActiveArea.Y+y.Height);n.LineElements.Clear()},i.prototype.AddElementToline=function(n,t){var i=this;n.CutFromLeft(n.ClientActiveArea.X+t.Width);this.OwnerParagraph.ParagraphFormat.TextAlignment==nt.Justify&&t instanceof l&&this.SplitTextElementWordByWord(t,n);this instanceof ct&&(n.LineElements.SkipClipImage=!i.IsInlineImage);n.LineElements.push(t)},i.prototype.CheckPreviousElement=function(n,t){for(var f,c,a,r,u,v,s=!1,e=0,i=n.LineElements.length-1;i>=0;i--)if(n.LineElements[i]instanceof l){if(f=n.LineElements[i],c=f.Text,e=i,/ $/.test(c)){if(i==n.LineElements.length-1)return this.MoveToNextLine(n),!0;s=!0;break}else if(c.indexOf(" ")>=0){s=!0;a=c.lastIndexOf(" ")+1;r=new l(f.Inline);r.Index=f.Index+a;r.Length=f.Length-a;f.Length-=r.Length;this.Elements.Add(r);h.GetTextSize(r,t);f.Width-=r.Width;f.Height=r.Height;n.LineElements.splice(i+1,0,r);break}}else{e=i;s=!0;break}if(s){while(e<n.LineElements.length-1)e++;if(e++,u=new o,e<n.LineElements.Count){for(v=0,i=e;i<n.LineElements.Count;i++)v+=n.LineElements[i].Width,u.Add(n.LineElements[i]),n.LineElements.splice(i,1),i--;n.UpdateClientWidth(v)}for(this.MoveToNextLine(n),u.length>0&&u[0]instanceof l&&u[0].Text=="\t"&&(u[0].Width=this.OwnerParagraph.GetTabWidth(n)),i=0;i<u.length;i++)this.AddElementToline(n,u[i]);u.Clear()}return s},i.prototype.SplitTextForClientArea=function(n,t,i,r,u){var f=!0,e=-1,o;i.substring(0,1)==" "?e=1:(o=r,(e=i.replace(/\s\s*$/,"").indexOf(" ")+1)>0&&(o=h.MeasureTextExcludIngSpaceAtEnd(i.slice(0,e),u).Width),n.ClientActiveArea.Width<o&&(f=this.CheckPreviousElement(n,u),f&&(f=o<=n.ClientActiveArea.Width)));r<=n.ClientActiveArea.Width?this.AddElementToline(n,t):f&&(e>0||i.indexOf(" ")>0)?this.SplitByWord(n,t,i,r,u):this.SplitByCharacter(n,t,i,r,u)},i.prototype.SplitByWord=function(n,t,i,r,u){var e=this.GetSplitIndexByWord(n.ClientActiveArea.Width,i,r,u),f,o;e>0&&e<t.Length&&(f=new l(t.Inline),i=i.substring(e),i[0]==" "&&(o=i.length,i=i.replace(/^\s\s*/,""),e+=o-i.Length),f.Index=t.Index+e,f.Length=t.Length-e,t.Length-=f.Length,this.Elements.Add(f),h.GetTextSize(f,u),t.Width-=f.Width,t.Height=f.Height,this.AddElementToline(n,t),this.MoveToNextLine(n))},i.prototype.GetSplitIndexByWord=function(n,t,i,r){for(var f=0,e=t.length,u,o;f<e;)if(u=this.GetTextIndexAfterSpace(t,f),(u==0||u==e)&&(u=e-1),o=i,(u<e-1||u==e-1&&t[u-1]==" ")&&f!=u&&(o=h.MeasureTextExcludIngSpaceAtEnd(t.slice(0,u),r).Width),o<=n)f=u;else{f==0&&t[0]==" "&&(f=this.GetTextIndexAfterSpace(t,0));break}return f},i.prototype.GetTextIndexAfterSpace=function(n,t){var r=n.length,i=n.indexOf(" ",t)+1;if(i==0||i==r)return i;while(n[i]==" ")if(i++,i==r)break;return i},i.prototype.SplitByCharacter=function(n,t,i,r,u){var e=this.GetTextSplitIndexByCharacter(n.ClientArea.Width,n.ClientActiveArea.Width,i,r,u),o=0,f;e<t.Length&&(o=h.MeasureTextExcludIngSpaceAtEnd(i.substring(0,e),u).Width,i=i.substring(e));o>n.ClientActiveArea.Width&&n.LineElements.length>0&&this.MoveToNextLine(n);e<t.Length?(f=new l(t.Inline),f.Index=t.Index+e,f.Length=t.Length-e,t.Length-=f.Length,this.Elements.Add(f),h.GetTextSize(f,u),t.Width-=f.Width,t.Height=f.Height,this.AddElementToline(n,t),this.MoveToNextLine(n)):this.AddElementToline(n,t)},i.prototype.GetTextSplitIndexByCharacter=function(n,t,i,r,u){for(var e,o=i.length,f=0;f<o;f++)if(e=r,f+1<o&&(e=h.MeasureTextExcludIngSpaceAtEnd(i.substring(0,f+1),u).Width),e>t)return f==0&&e>n?o>1&&i[1]==" "?this.GetTextIndexAfterSpace(i,1):1:f;return 0},i.prototype.SplitTextElementWordByWord=function(n,t){var r=n.Text,f,u,e;if(r.trim().indexOf(" ")>=0){f=this.CharacterFormat;for(var o=f.FontSize,s=f.BaselineAlignment,c=f.Bold,a=f.Italic,i=n.Length-r.replace(/^\s\s*/,"").length;i<n.Length;){if(i=this.GetTextIndexAfterSpace(r,i),i==0||i==n.Length)break;i<n.Length&&(u=new l(n.Inline),e=r.substring(0,i),r=r.substring(i),r.substring(0,1)==" "&&(i+=r.length-r.replace(/^\s\s*/,"").length),u.Index=n.Index,u.Length=i,this.Elements.splice(this.Elements.indexOf(n),0,u),h.GetTextSize(u,f),t.LineElements.push(u),n.Index+=i,n.Length-=i,n.Width-=u.Width,i=0)}}},i.prototype.SplitElementForClientArea=function(n,t){t.LineElements.length>0&&this.MoveToNextLine(t);t.LineElements.length==0&&this.AddElementToline(t,n)},i.prototype.GetPhysicalPosition=function(n,t){var l=this.GetElementBox(n,t),i=l.element,r,f,u,o,s,a,c;return(n=l.index,i==null||i.CurrentLineWidget==null)?this instanceof e?this.GetFieldCharacterPosition():new rt(0,0):(r=0,f=0,r=i.CurrentLineWidget.GetTop(),i instanceof vi?(u=this.OwnerParagraph.CharacterFormat,o=this.GetPreviousTextInline(),o!=null?u=o.CharacterFormat:(s=this.GetNextTextInline(),s!=null&&(u=s.CharacterFormat)),a=h.MeasureText("a",u),c=a.BaselineOffset,i.Margin.Top+i.Height-c>0&&(r+=i.Margin.Top+i.Height-c)):r+=i.Margin.Top>0?i.Margin.Top:0,f=i.CurrentLineWidget.GetLeftInternal(i,n),new rt(f,r))},i.prototype.GetFieldCharacterPosition=function(){var n=this,t,i;return this instanceof s&&n.IsLinkedFieldCharacter()&&(n=n.fieldSeparator==null?n.fieldEnd:n.fieldSeparator),t=null,n.NextNode!=null&&(t=n.NextNode.GetNextValidInline()),t==null?(i=n.OwnerParagraph,i.GetEndPosition()):t.GetPhysicalPosition(0,!0)},i.prototype.GetText=function(n,t,i,r){var f="",u=this,o,e;do{if(u==t)return u instanceof k&&(o=u,o.Text==null||o.Text==""||(f=o.Text.length<i?f+o.Text:f+o.Text.substring(0,i))),f;if(u instanceof k?f=f+u.Text:u instanceof s&&u.fieldEnd!=null&&(u=u.fieldSeparator!=null?u.fieldSeparator:u.fieldEnd),u.NextNode==null)break;u=u.NextNode}while(1);if(n==this.OwnerParagraph)return f;for(e=this.OwnerParagraph.GetNextParagraph();e!=null&&e.IsEmpty();){if(f=f+"\r",e==n)return f;e=e.GetNextParagraph()}return e==null||e.IsEmpty()||(f=f+"\r"+e.Inlines[0].GetText(n,t,i,r)),f},i.prototype.GetElementBox=function(n,t){var r=null,i,u;if(this.Elements.Count>0&&(r=this.Elements[this.Elements.Count-1]),r instanceof l)for(i=0;i<this.Elements.Count;i++){if(u=this.Elements[i]instanceof l?this.Elements[i].Length:1,u>=n||u+1==n&&i==this.Elements.Count-1){r=this.Elements[i];t&&n==u&&i<this.Elements.Count-1&&r.CurrentLineWidget!=this.Elements[i+1].CurrentLineWidget&&(r=this.Elements[i+1],n=0);break}n-=u}return{index:n,element:r}},i.prototype.GetElementBoxInternal=function(n){var i=null,t,r;if(this.Elements.Count>0&&(i=this.Elements[this.Elements.Count-1]),i instanceof l)for(t=0;t<this.Elements.Count;t++){if(r=this.Elements[t]instanceof l?this.Elements[t].Length:1,r>=n||r+1==n&&t==this.Elements.Count-1){i=this.Elements[t];break}n-=r}return{element:i,index:n}},i.prototype.GetPreviousTextInline=function(){return this.PreviousNode instanceof k?this.PreviousNode:this.PreviousNode!=null?this.PreviousNode.GetPreviousTextInline():null},i.prototype.GetNextTextInline=function(){return this.NextNode instanceof k?this.NextNode:this.NextNode!=null?this.NextNode.GetNextTextInline():null},i.prototype.GetLineWidget=function(n){return this.GetLineWidgetInternal(n,!0)},i.prototype.GetLineWidgetInternal=function(n,t){var o=this.GetElementBox(n,t),h=o.element,i,r,u,e,f;return(n=o.index,h!=null)?h.CurrentLineWidget:(i=this,this instanceof s&&i.IsLinkedFieldCharacter()&&(i=i.fieldSeparator==null?i.fieldEnd:i.fieldSeparator),r=null,i.NextNode!=null&&(r=i.NextNode.GetNextValidInline()),r==null?(u=i.OwnerParagraph,e=null,u.ParagraphWidgets.Count>0&&(f=u.ParagraphWidgets[u.ParagraphWidgets.Count-1],f.ChildWidgets.Count>0&&(e=f.ChildWidgets[f.ChildWidgets.Count-1])),e):r.GetLineWidget(0))},i.prototype.GetCaretHeight=function(n,t,i,r,u){var w=this.GetElementBox(n,!1),f,v,o,s,c,p,l,a;if(n=w.index,f=w.element,v=this,f==null)return v instanceof e?v.GetFieldCharacterHeight(t,i,r,u):{Height:h.MeasureText("a",t).Height,TopMargin:r,IsItalic:u};if(o=0,f instanceof vi)if(s=this.GetPreviousTextInline(),c=this.GetNextTextInline(),s==null&&c==null){var b=0,k=0,y=this.OwnerParagraph.GetParagraphMarkSize(b,k);b=y.TopMargin;k=y.BottomMargin;o=y.Height;u=this.OwnerParagraph.CharacterFormat.Italic;i||(o+=this.OwnerParagraph.ParagraphFormat.AfterSpacing)}else{if(s==null)return u=c.CharacterFormat.Italic,c.GetCaretHeight(0,c.CharacterFormat,i,r,u);if(c!=null&&f instanceof vi){var d=h.MeasureText("a",f.Inline.CharacterFormat),g=d.Height,nt=d.BaselineOffset;o=f.Margin.Top<0&&nt>f.Margin.Top+f.Height?f.Margin.Top+f.Height+g-nt:g;i||(o+=f.Margin.Bottom)}else return u=s.CharacterFormat.Italic,s.GetCaretHeight(s.Length,s.CharacterFormat,i,r,u)}else p=t.BaselineAlignment,l=f.Height,p!=lt.Normal&&i&&(l=l/1.5,p==lt.Subscript&&(r=f.Height-l)),o=(f.Margin.Top<0?f.Margin.Top:0)+l,i||(o+=f.Margin.Bottom);return i?(a=h.MeasureText("a",t).Height,a>o&&(a=o),{Height:a,TopMargin:r,IsItalic:u}):{Height:o,TopMargin:r,IsItalic:u}},i.prototype.GetFieldCharacterHeight=function(n,t,i,r){var u=this,f;if(u instanceof s&&u.IsLinkedFieldCharacter()&&(u=u.fieldSeparator==null?u.fieldEnd:u.fieldSeparator),f=null,u.NextNode!=null&&(f=u.NextNode.GetNextValidInline()),f==null){var v=u.OwnerParagraph,o=h.GetParagraphMarkSize(n).Height,a=0,c=0,l=v.GetParagraphMarkSize(a,c),e=l.Height;return(a=l.TopMargin,c=l.BottomMargin,!t)?(e+=c,{Height:e,TopMargin:i,IsItalic:r}):(o>e&&(o=e),{Height:o,TopMargin:i,IsItalic:r})}return f.GetCaretHeight(0,n,t,i,r)},i.prototype.GetPreviousValidInline=function(){var t=this,n=null;return n==null?t:n},i.prototype.ValidateTextPosition=function(n){var t=this,i,r;return t.Length==n&&t.NextNode instanceof e?(i=t.NextNode.GetNextValidInline(),i instanceof a&&(t=i,n=1)):n==0&&t.PreviousNode instanceof e&&(r=t.PreviousNode.GetPreviousValidInline(),t=r,n=t instanceof e?0:t.Length,t instanceof a&&n++),{inline:t,index:n}},i.prototype.GetNextValidInline=function(){for(var n=this,t=null;n instanceof e;){if(n instanceof s&&n.fieldEnd!=null)return t==null?n:t;n instanceof a&&n.FieldBegin!=null&&(t=n);n=n.NextNode}return t==null?n:t},i.prototype.IsLastRenderedInline=function(n){for(var t=this,r,i,u;n==t.Length&&t.NextNode instanceof e;)if(r=t.NextNode.GetNextValidInline(),n=0,r instanceof s&&(t=r),t instanceof s&&t.fieldEnd!=null)if(i=t,i.fieldSeparator==null)t=i.fieldEnd,n=1;else if(t=i.fieldSeparator,u=t.OwnerParagraph,n=1,u!=i.fieldEnd.OwnerParagraph||u.HasValidInline(t,i.fieldEnd))break;else t=i.fieldEnd;return n==t.Length&&t.NextNode==null},i.prototype.GetNextRenderedInline=function(n){var t=this,r,i;if(t instanceof s){if(i=t,t=i.GetRenderedField(),i==t)return i;n=1}while(n==t.Length&&t.NextNode instanceof e)if(r=t.NextNode.GetNextValidInline(),r instanceof s){if(i=r,t=i.GetRenderedField(),i==t)return i;n=1}else t=r;return t},i.prototype.IsExistAfter=function(n){return this.OwnerParagraph==n.OwnerParagraph?this.OwnerParagraph.Inlines.IndexOf(this)>this.OwnerParagraph.Inlines.IndexOf(n):this.OwnerParagraph.Owner==n.OwnerParagraph.Owner?this.OwnerParagraph.IsInsideTable?this.OwnerParagraph.AssociatedCell.Blocks.IndexOf(this.OwnerParagraph)>n.OwnerParagraph.AssociatedCell.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.Owner instanceof c?this.OwnerParagraph.Owner.Blocks.IndexOf(this.OwnerParagraph)>n.OwnerParagraph.Owner.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.Section.Blocks.IndexOf(this.OwnerParagraph)>n.OwnerParagraph.Section.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.IsExistAfter(n.OwnerParagraph)},i.prototype.IsExistBefore=function(n){return this.OwnerParagraph==n.OwnerParagraph?this.OwnerParagraph.Inlines.IndexOf(this)<this.OwnerParagraph.Inlines.IndexOf(n):this.OwnerParagraph.Owner==n.OwnerParagraph.Owner?this.OwnerParagraph.IsInsideTable?this.OwnerParagraph.AssociatedCell.Blocks.IndexOf(this.OwnerParagraph)<n.OwnerParagraph.AssociatedCell.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.Owner instanceof c?this.OwnerParagraph.Owner.Blocks.IndexOf(this.OwnerParagraph)<n.OwnerParagraph.Owner.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.Section.Blocks.IndexOf(this.OwnerParagraph)<n.OwnerParagraph.Section.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.IsExistBefore(n.OwnerParagraph)},i.prototype.Find=function(n,t,i,r,u,f){var e=this,a=new String,nt=new dt,v,rt,y,ut,p,b,l,g,h,et;do{if(e instanceof k&&e.Text!=null&&e.Text!=""?(nt.Add(e,a.length),a=e==this?a+e.Text.substring(i):a+e.Text):e instanceof s&&(v=e,v.fieldEnd!=null&&(e=v.fieldSeparator==null?v.fieldEnd:v.fieldSeparator)),e.NextNode==null)break;e=e.NextNode}while(1);for(rt=a.toString(),y=[];(ut=n.exec(rt))!=null;)y.push(ut);for(p=0;p<y.length;p++){var c=y[p],ft=nt.Keys,w=new oi(f),tt=new oi(f);for(b=0;b<ft.Count;b++){var o=ft[b],d=nt.Get(o),it=o.Length;if(o==this&&(it-=i),w.Paragraph==null&&c.index<=d+it&&(l=c.index-d,o==this&&(l+=i),g=o.OwnerParagraph.GetOffset(o,l),w.SetPositionParagraph(o.OwnerParagraph,g)),c.index+c[0].length<=d+it){l=c.index+c[0].length-d;o==this&&(l+=i);g=o.OwnerParagraph.GetOffset(o,l);tt.SetPositionParagraph(o.OwnerParagraph,g);break}}if(tt.UpdateTextPositionOnFieldCharacter(w),r)return f.Selection.SelectRange(w,tt,!0),!0}for(h=e.OwnerParagraph.GetNextParagraph();h!=null&&h.Inlines.Count==0;)h=h.GetNextParagraph();return h!=null&&h.Inlines.Count>0?(et=h.Inlines[0],et.Find(n,t,0,r,u,f)):!1},i.prototype.ClearElements=function(n){var t,i;if(this.Elements!=null)for(t=0;t<this.Elements.Count;t++)i=this.Elements[t],this.Elements.Remove(i),t--;n&&this.Elements.Clear()},i}(gt);i.Inline=ai;k=function(t){function i(n){t.call(this,n);this.text=""}return n(i,t),Object.defineProperty(i.prototype,"Text",{get:function(){return this.text},set:function(n){this.text=n;this.OnTextChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Length",{get:function(){return this.text.length},enumerable:!0,configurable:!0}),i.prototype.OnTextChanged=function(){if(this.OwnerParagraph instanceof f){var n=this.OwnerParagraph.Inlines.indexOf(this);n>-1&&this.Text!="\t"&&this.Text!="\v"&&this.Text.length>=1&&this.SplitByTabOrLineBreakCharacter(n)}},i.prototype.AddElementBox=function(){var n=new l(this);n.Index=0;n.Length=this.Text.length;this.Elements.Add(n)},i.prototype.SplitByTabOrLineBreakCharacter=function(n){var r=this.Text,u=r.indexOf("\t"),e=r.indexOf("\v"),t=-1,o,f;t=u>-1&&e>-1?u<e?u:e:u>-1?u:e;t>-1&&(o=r.substring(t+1),f=new i(null),f.CharacterFormat.CopyFormat(this.CharacterFormat),this.OwnerParagraph.Inlines.Insert(n+1,f),t>0?(f.Text=r.substring(t),this.Text=r.substring(0,t)):o!=""&&(f.Text=o,this.Text=r.substring(t,t+1)))},i.prototype.Dispose=function(){this.CharacterFormat.Dispose();this.Text="";this.SetOwner(null)},i}(ai);i.SpanAdv=k;ct=function(t){function i(n,i,r){t.call(this,n);this.imageString="";this.width=0;this.height=0;this.isInlineImage=!0;this.isMetaFile=!1;this.isInlineImage=i;this.isMetaFile=r}return n(i,t),Object.defineProperty(i.prototype,"ImageString",{get:function(){return this.imageString},set:function(n){this.imageString=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Width",{get:function(){return this.width},set:function(n){this.width=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Height",{get:function(){return this.height},set:function(n){this.height=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsInlineImage",{get:function(){return this.isInlineImage},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsMetaFile",{get:function(){return this.isMetaFile},enumerable:!0,configurable:!0}),i.prototype.AddElementBox=function(){var n=new vi(this);n.Height=this.Height;n.Width=this.Width;this.Elements.Add(n)},i.prototype.Dispose=function(){this.CharacterFormat.Dispose();this.ImageString="";this.SetOwner(null);this.ClearElements(!0)},i}(ai);i.ImageAdv=ct;e=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.AddElementBox=function(){},i.prototype.GetRenderedInline=function(n){for(var r=this.GetPreviousValidInline(),t;r instanceof i;)r=r.GetPreviousTextInline(),r instanceof i&&(r=r.PreviousNode);if(r!=null)return n=r.Length,{Inline:r,InlineIndex:n};if(n=0,t=this.GetNextRenderedInline(0),t instanceof s)for(t=t.fieldSeparator,t=t.NextNode;t instanceof i;)t instanceof s&&t.IsLinkedFieldCharacter()&&(t=t.fieldSeparator==null?t.fieldEnd:t.fieldSeparator),t=t.NextNode;return{Inline:r,InlineIndex:n}},i.prototype.Dispose=function(){this.CharacterFormat.Dispose();this.SetOwner(null);this.ClearElements(!0)},i}(ai);i.FieldCharacterAdv=e;s=function(t){function i(n){t.call(this,n);this.FieldSeparator=null;this.FieldEnd=null}return n(i,t),Object.defineProperty(i.prototype,"fieldSeparator",{get:function(){return this.FieldSeparator},set:function(n){if(this.FieldSeparator!=n){var t=this.fieldSeparator;this.FieldSeparator=n;t!=null&&(t.fieldBegin=null,t=null);this.fieldSeparator!=null&&(this.fieldSeparator.fieldBegin=this)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fieldEnd",{get:function(){return this.FieldEnd},set:function(n){if(this.FieldEnd!=n){var t=this.fieldEnd;this.FieldEnd=n;t!=null&&(t.fieldBegin=null,t=null);this.fieldEnd!=null&&(this.fieldEnd.fieldBegin=this)}},enumerable:!0,configurable:!0}),i.prototype.IsLinkedFieldCharacter=function(){return!0},i.prototype.CheckUnlinkFieldCharacter=function(n,t){if(this.fieldSeparator!=null){if(t){var i=this.fieldSeparator.OwnerParagraph.GetHierarchicalIndex("");if(i.indexOf(n)>=0)return}this.fieldSeparator.fieldBegin=null;this.fieldSeparator=null}},i.prototype.AddToLinkedFields=function(){var n=this;n.RemoveAfterLinking(n);n.FieldSeparator!=null&&n.RemoveAfterLinking(n.FieldSeparator);n.RemoveAfterLinking(n.FieldEnd);this.Owner.AddFields(this)},i.prototype.IsUnlinkFieldCharacters=function(){if(this.fieldEnd==null)return!1;var n=this.fieldEnd.OwnerParagraph.GetHierarchicalIndex("");return!(n.indexOf(n)>=0)},i.prototype.UnlinkFieldCharacter=function(n,t){var i,r;this.fieldSeparator!=null&&(i=!0,t&&(r=this.fieldSeparator.OwnerParagraph.GetHierarchicalIndex(""),r.indexOf(n)>=0&&(i=!1)),i?(this.fieldSeparator.Owner.AddFieldCharacter(this.fieldSeparator),this.fieldSeparator.fieldBegin=null,this.fieldSeparator=null):this.fieldSeparator.Owner.AddFieldCharacter(this.fieldSeparator));this.fieldEnd!=null&&(this.fieldEnd.Owner.AddFieldCharacter(this.fieldEnd),this.fieldEnd.fieldBegin=null,this.fieldEnd=null);this.Owner.Fields.Contains(this)&&this.Owner.Fields.Remove(this);t&&this.Owner.AddFieldCharacter(this)},i.prototype.RemoveAfterLinking=function(n){this.Owner.RemoveFieldCharacter(n)},i.prototype.GetRenderedField=function(){var n=this,t;if(this.FieldSeparator==null)n=this.FieldEnd;else{if(n=this.FieldSeparator,t=n.OwnerParagraph,t!=this.FieldEnd.OwnerParagraph||t.HasValidInline(n,this.FieldEnd))return this;n=this.FieldEnd}return n},i.prototype.GetFieldCode=function(){if(this.fieldEnd==null||this.OwnerParagraph==null)return"";return this.OwnerParagraph.GetFieldCode(this,!1,!1,this)},i.prototype.InlineIsInFieldResult=function(n){return this.fieldEnd!=null&&this.fieldSeparator!=null&&this.fieldSeparator.IsExistBefore(n)?this.fieldEnd.IsExistAfter(n):!1},i.prototype.ParagraphIsInFieldResult=function(n){return this.fieldEnd!=null&&this.fieldSeparator!=null&&(this.fieldSeparator.Owner==n||this.fieldSeparator.OwnerParagraph.IsExistBefore(n))?this.fieldEnd.Owner!=n&&this.fieldEnd.OwnerParagraph.IsExistAfter(n):!1},i}(e);i.FieldBeginAdv=s;fi=function(t){function i(n){t.call(this,n);this.FieldBegin=null;this.FieldEnd=null}return n(i,t),Object.defineProperty(i.prototype,"fieldBegin",{get:function(){return this.FieldBegin},set:function(n){if(this.FieldBegin!=n){var t=this.FieldBegin;this.FieldBegin=n;t!=null&&(t.fieldSeparator=null,t=null);this.fieldBegin!=null&&(this.fieldBegin.fieldSeparator=this)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fieldEnd",{get:function(){return this.FieldEnd},set:function(n){if(this.FieldEnd!=n){var t=this.FieldEnd;this.FieldEnd=n;t!=null&&(t.fieldSeparator=null,t=null);this.fieldEnd!=null&&(this.fieldEnd.fieldSeparator=this)}},enumerable:!0,configurable:!0}),i.prototype.IsLinkedFieldCharacter=function(){return this.fieldBegin!=null&&this.fieldEnd!=null},i.prototype.UnlinkFieldCharacter=function(n,t){var i,r;this.fieldBegin!=null&&(i=!0,t&&(r=this.fieldBegin.OwnerParagraph.GetHierarchicalIndex(""),r.indexOf(n)>=0&&(i=!1)),this.fieldEnd!=null,i?(this.fieldBegin.Owner.AddFieldCharacter(this.fieldBegin),this.fieldBegin.fieldSeparator=null,this.fieldBegin=null):this.fieldBegin.Owner.AddFieldCharacter(this.fieldBegin));this.fieldEnd!=null&&(i=!0,t&&(r=this.fieldEnd.OwnerParagraph.GetHierarchicalIndex(""),r.indexOf(n)>0&&(i=!1)),i?(this.fieldEnd.Owner.AddFieldCharacter(this.fieldEnd),this.fieldEnd.fieldSeparator=null,this.fieldEnd=null):this.fieldEnd.Owner.AddFieldCharacter(this.fieldEnd));t&&this.Owner.AddFieldCharacter(this)},i.prototype.CheckUnlinkFieldCharacter=function(n,t){var i;if(this.fieldBegin!=null){if(t&&(i=this.fieldBegin.OwnerParagraph.GetHierarchicalIndex(""),i.indexOf(n)>=0))return;this.fieldBegin.fieldSeparator=null;this.fieldBegin=null}if(this.fieldEnd!=null){if(t&&(i=this.fieldEnd.OwnerParagraph.GetHierarchicalIndex(""),i.indexOf(n)>=0))return;this.fieldEnd.fieldSeparator=null;this.fieldEnd=null}},i}(e);i.FieldSeparatorAdv=fi;a=function(t){function i(n){t.call(this,n);this.FieldBegin=null;this.FieldSeparator=null}return n(i,t),Object.defineProperty(i.prototype,"fieldBegin",{get:function(){return this.FieldBegin},set:function(n){if(this.FieldBegin!=n){var t=this.FieldBegin;this.FieldBegin=n;t!=null&&(t.fieldEnd=null,t=null);this.fieldBegin!=null&&(this.fieldBegin.fieldEnd=this)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fieldSeparator",{get:function(){return this.FieldSeparator},set:function(n){if(this.FieldSeparator!=n){var t=this.FieldSeparator;this.FieldSeparator=n;t!=null&&(t.fieldEnd=null,t=null);this.fieldSeparator!=null&&(this.fieldSeparator.fieldEnd=this)}},enumerable:!0,configurable:!0}),i.prototype.IsLinkedFieldCharacter=function(){return this.fieldBegin!=null},i.prototype.CheckUnlinkFieldCharacter=function(n,t){if(this.fieldSeparator!=null){if(t){var i=this.fieldSeparator.OwnerParagraph.GetHierarchicalIndex("");if(i.indexOf(n)>=0)return}this.fieldSeparator.fieldEnd=null;this.fieldSeparator=null}},i.prototype.UnlinkFieldCharacter=function(n,t){var i,r;this.fieldBegin.Owner.Fields.Contains(this.fieldBegin)&&this.fieldBegin.Owner.Fields.Remove(this.fieldBegin);this.fieldBegin.Owner.AddFieldCharacter(this.fieldBegin);this.fieldBegin.fieldEnd=null;this.fieldBegin=null;this.fieldSeparator!=null&&(i=!0,t&&(r=this.fieldSeparator.OwnerParagraph.GetHierarchicalIndex(""),r.indexOf(n)>0&&(i=!1)),i?(this.fieldSeparator.Owner.AddFieldCharacter(this.fieldSeparator),this.fieldSeparator.fieldEnd=null,this.fieldSeparator=null):this.fieldSeparator.Owner.AddFieldCharacter(this.fieldSeparator));t&&this.Owner.AddFieldCharacter(this)},i}(e);i.FieldEndAdv=a;au=function(){function n(n){this.hyperLink=n}return Object.defineProperty(n.prototype,"Hyperlink",{get:function(){return this.hyperLink},enumerable:!0,configurable:!0}),n}();i.RequestNavigateEventArgs=au;gr=function(){function n(n){var t=n.GetFieldCode(),i=t.toLowerCase();t=t.substring(i.indexOf("hyperlink")+9);this.ParseFieldValues(t.trim())}return Object.defineProperty(n.prototype,"NavigationLink",{get:function(){return this.navigationLink},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LinkType",{get:function(){return this.linkType},enumerable:!0,configurable:!0}),n.prototype.ParseFieldValue=function(n,t,i){n.string=n.string.substring(1);var r=n.string.indexOf(i);r==-1?r=n.string.length:this.navigationLink==null&&(this.navigationLink=n.string.substring(0,r));n.string=n.string.substring(r+1).trim()},n.prototype.ParseFieldValues=function(n){for(var t={string:n},i=0,r;t.string.length>0;){r=t.string.substring(0,1);switch(r){case'"':this.ParseFieldValue(t,i,'"');i=0;break;case"\\l":case"\\t":n=n.substring(2);default:this.ParseFieldValue(t,i," ");i=0}t.string=t.string.trim()}this.navigationLink=this.navigationLink.trim();this.navigationLink.match("http://")||this.navigationLink.match("https://")?this.linkType=ir.Webpage:this.navigationLink.match("mailto:")?this.linkType=ir.Email:this.navigationLink.match("www.")?(this.navigationLink="http://"+this.navigationLink,this.linkType=ir.Webpage):this.navigationLink.match("@")?(this.navigationLink="mailto:"+this.navigationLink,this.linkType=ir.Email):this.linkType=ir.File},n}();i.HyperLink=gr;v=function(){function n(n,t,i,r){this.X=this._left=n;this.Y=this._top=t;this._right=n+i;this._bottom=t+r;this.Width=i;this.Height=r}return Object.defineProperty(n.prototype,"Left",{get:function(){return this.X},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Right",{get:function(){return this._right},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Top",{get:function(){return this.Y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Bottom",{get:function(){return this._bottom},enumerable:!0,configurable:!0}),n}();i.Rect=v;ei=function(){function n(n,t,i,r){this.left=n;this.top=t;this.right=i;this.bottom=r}return Object.defineProperty(n.prototype,"Left",{get:function(){return this.left},set:function(n){this.left=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Top",{get:function(){return this.top},set:function(n){this.top=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Right",{get:function(){return this.right},set:function(n){this.right=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Bottom",{get:function(){return this.bottom},set:function(n){this.bottom=n},enumerable:!0,configurable:!0}),n}();i.Margin=ei;rt=function(){function n(n,t){this.x=0;this.y=0;this.x=n;this.y=t}return Object.defineProperty(n.prototype,"X",{get:function(){return this.x},set:function(n){this.x=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Y",{get:function(){return this.y},set:function(n){this.y=n},enumerable:!0,configurable:!0}),n}();i.Point=rt;oi=function(){function n(n){this.currentParagraph=null;this.offset=0;this.location=new rt(0,0);this.ownerControl=n}return Object.defineProperty(n.prototype,"OwnerControl",{get:function(){return this.ownerControl},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Document",{get:function(){return this.OwnerControl.Document},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Paragraph",{get:function(){return this.currentParagraph},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Offset",{get:function(){return this.offset},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Location",{get:function(){return this.location},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsAtParagraphStart",{get:function(){return this.offset==this.Paragraph.GetStartOffset()},enumerable:!0,configurable:!0}),n.prototype.SetPosition=function(n,t){this.currentParagraph=n;this.offset=t?n.GetStartOffset():n.GetLength()+1;this.UpdatePhysicalPosition()},n.prototype.SetPositionInternal=function(n){this.currentParagraph=n.currentParagraph;this.offset=n.offset;this.location=n.location},n.prototype.SetPositionForCurrentIndex=function(n){var t={Index:n},i=this.OwnerControl.Document.GetParagraph(t);this.offset=parseFloat(t.Index);this.SetPositionParagraph(i,this.offset)},n.prototype.SetPositionParagraph=function(n,t){this.currentParagraph=n;this.offset=t;this.UpdatePhysicalPosition()},n.prototype.UpdatePhysicalPosition=function(){this.currentParagraph.ParagraphWidgets.Count>0&&(this.location=this.currentParagraph.GetPhysicalPosition(this.offset))},n.prototype.UpdatePhysicalPositionInternal=function(n){this.currentParagraph.ParagraphWidgets.Count>0&&(this.location=this.currentParagraph.GetPhysicalPositionInternal(this.offset,n))},n.prototype.SetPositionForSelection=function(n,t,i,r){var u=!1;t==null?this.currentParagraph=n:(this.currentParagraph=t.OwnerParagraph,t.NextNode instanceof e&&i>t.Length&&(u=t.IsLastRenderedInline(t.Length)));this.location=r;this.offset=u?this.currentParagraph.GetLength()+1:this.currentParagraph.GetOffset(t,i)},n.prototype.ValidateBackwardFieldSelection=function(t,i){var u=new n(this.OwnerControl),e,f,h,c,v,y;for(u.SetPositionForCurrentIndex(t),e=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal();t!=i&&n.IsForwardSelection(i,t);){var o=0,l=u.Paragraph.GetInline(u.Offset,o),r=l.inline;if(o=l.index,r!=null&&(f=r.GetNextRenderedInline(o),f instanceof s&&(h=f.fieldEnd.OwnerParagraph.GetOffset(f.fieldEnd,1),c=f.fieldEnd.OwnerParagraph.GetHierarchicalIndex(h.toString()),n.IsForwardSelection(c,e)||(this.OwnerControl.Selection.Start.SetPositionParagraph(f.fieldEnd.OwnerParagraph,h),e=c))),r instanceof a&&r.FieldBegin!=null){if(v=r.FieldBegin.OwnerParagraph.GetOffset(r.FieldBegin,0),y=r.FieldBegin.OwnerParagraph.GetHierarchicalIndex(v.toString()),!n.IsForwardSelection(i,y)){this.MoveToInline(r.FieldBegin,0);return}u.MoveToInline(r.FieldBegin,0)}else u.MovePreviousPosition();t=u.GetHierarchicalIndexInternal()}},n.prototype.ValidateForwardFieldSelection=function(t,i){var u=new n(this.OwnerControl),e,h,l,o,v,y,p;for(u.SetPositionForCurrentIndex(t),e=!1;t!=i&&n.IsForwardSelection(t,i);){if(!e&&(u.MoveNextPosition(),h=u.GetHierarchicalIndexInternal(),t==h))break;var f=0,c=u.Paragraph.GetInline(u.Offset,f),r=c.inline;if(f=c.index,r!=null){if(l=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),f==r.Length&&r instanceof a){if(r.OwnerParagraph.GetOffset(r,0)==this.offset)return;o=r.FieldBegin.OwnerParagraph.GetOffset(r.FieldBegin,0);v=r.FieldBegin.OwnerParagraph.GetHierarchicalIndex(o.toString());n.IsForwardSelection(l,v)||this.OwnerControl.Selection.Start.SetPositionParagraph(r.FieldBegin.OwnerParagraph,o)}r=r.GetNextRenderedInline(f)}if(e=r instanceof s&&r.fieldEnd!=null){if(r.OwnerParagraph.GetOffset(r,0)==this.offset)return;if(y=r.fieldEnd.OwnerParagraph.GetOffset(r.fieldEnd,1),p=r.fieldEnd.OwnerParagraph.GetHierarchicalIndex(y.toString()),!n.IsForwardSelection(p,i)){this.MoveToInline(r.fieldEnd,1);return}u.MoveToInline(r.fieldEnd,1)}t=u.GetHierarchicalIndexInternal()}},n.prototype.MoveToInline=function(n,t){this.currentParagraph=n.OwnerParagraph;this.offset=this.currentParagraph.GetOffset(n,t);this.UpdatePhysicalPosition()},n.prototype.MovePreviousPosition=function(){var t=0,i=this.currentParagraph.GetInline(this.offset,t),n=i.inline,u,r,f;t=i.index;n instanceof a&&n.FieldBegin!=null&&this.MovePreviousPositionInternal(n);u=this.currentParagraph.GetPreviousValidOffset(this.offset);this.offset>u?this.offset=u:(r=this.currentParagraph.GetPreviousParagraph(),r!=null&&(this.currentParagraph=r,this.offset=r.GetEndOffset()));t=0;i=this.currentParagraph.GetInline(this.offset,t);n=i.inline;t=i.index;n instanceof e&&(f=n.GetPreviousValidInline(),f!=null&&(n=f,this.currentParagraph=n.OwnerParagraph,this.offset=this.currentParagraph.GetOffset(n,n.Length),n instanceof s&&this.offset--));this.UpdatePhysicalPosition()},n.prototype.MoveNextPosition=function(){var n=this.currentParagraph.GetNextStartInline(this.offset),r,t,u,f,i;if(n instanceof s&&n.fieldEnd!=null){this.MoveNextPositionInternal(n);this.MoveNextPosition();return}r=this.currentParagraph.GetNextValidOffset(this.offset);t=0;r>this.offset?(this.offset=r,i=this.currentParagraph.GetInline(this.offset,t),n=i.inline,t=i.index,n!=null&&t==n.Length&&n.NextNode instanceof e&&(u=n.NextNode.GetNextValidInline(),u instanceof a&&(n=u,this.offset=this.currentParagraph.GetOffset(n,1)))):(f=this.currentParagraph.GetNextParagraph(),f!=null&&(this.currentParagraph=f,this.offset=this.currentParagraph.GetStartOffset()),i=this.currentParagraph.GetInline(this.offset,t),n=i.inline,t=i.index,n instanceof a&&this.offset++);this.UpdatePhysicalPosition()},n.prototype.MoveNextPositionInternal=function(n){var t;n.fieldSeparator==null?t=n.fieldEnd:(t=n.fieldSeparator,this.currentParagraph=t.OwnerParagraph,this.currentParagraph!=n.fieldEnd.OwnerParagraph||this.currentParagraph.HasValidInline(t,n.fieldEnd)||(t=n.fieldEnd));this.currentParagraph=t.OwnerParagraph;this.offset=this.currentParagraph.GetOffset(t,1)},n.prototype.MovePreviousPositionInternal=function(n){var t;t=n.FieldSeparator==null?n.FieldBegin.GetPreviousValidInline():n.GetPreviousValidInline();this.currentParagraph=t.OwnerParagraph;this.offset=this.currentParagraph.GetOffset(t,t instanceof e?0:t.Length)},n.prototype.UpdateTextPositionOnFieldCharacter=function(t){var r=new n(this.OwnerControl),c,v,o,y,p,w;r.SetPositionInternal(t);for(var u=t.GetHierarchicalIndexInternal(),e=this.GetHierarchicalIndexInternal(),h=!1;u!=e&&n.IsForwardSelection(u,e);){if(!h&&(r.MoveNextPosition(),c=r.GetHierarchicalIndexInternal(),u==c))break;var f=0,l=r.Paragraph.GetInline(r.Offset,f),i=l.inline;if(f=l.index,i!=null){if(v=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),f==i.Length&&i instanceof a){if(i.OwnerParagraph.GetOffset(i,0)==this.offset)return;o=i.FieldBegin.OwnerParagraph.GetOffset(i.FieldBegin,0);y=i.FieldBegin.OwnerParagraph.GetHierarchicalIndex(o.toString());n.IsForwardSelection(v,y)||t.SetPositionParagraph(i.FieldBegin.OwnerParagraph,o)}i=i.GetNextRenderedInline(f)}if(h=i instanceof s&&i.fieldEnd!=null){if(i.OwnerParagraph.GetOffset(i,0)==this.offset)return;if(p=i.fieldEnd.OwnerParagraph.GetOffset(i.fieldEnd,1),w=i.fieldEnd.OwnerParagraph.GetHierarchicalIndex(p.toString()),!n.IsForwardSelection(w,e)){this.MoveToInline(i.fieldEnd,1);return}r.MoveToInline(i.fieldEnd,1)}u=r.GetHierarchicalIndexInternal()}},n.prototype.MoveForward=function(){var i=0,y=this.currentParagraph.GetInline(this.offset,i),t=y.inline,b,u,h,c,l,r,f,k,v;if(i=y.index,t!=null){if(!this.OwnerControl.Selection.IsEmpty&&i==t.Length&&t instanceof a){var d=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),p=t.FieldBegin.OwnerParagraph.GetOffset(t.FieldBegin,0),g=t.FieldBegin.OwnerParagraph.GetHierarchicalIndex(p.toString());if(!n.IsForwardSelection(d,g)){this.OwnerControl.Selection.Start.SetPositionParagraph(t.FieldBegin.OwnerParagraph,p);return}}t=t.GetNextRenderedInline(i)}if(t instanceof s&&t.fieldEnd!=null){var nt=this.OwnerControl.Selection.Start.Paragraph,o=0,w=nt.GetInline(this.OwnerControl.Selection.Start.Offset,o),tt=w.inline;if(o=w.index,b=tt.GetNextRenderedInline(o),b==t)this.MoveNextPositionInternal(t);else{t=t.fieldEnd;this.currentParagraph=t.OwnerParagraph;this.offset=this.currentParagraph.GetOffset(t,1);this.UpdatePhysicalPosition();return}}else(t instanceof s||t instanceof a)&&(this.currentParagraph=t.OwnerParagraph,this.offset=this.currentParagraph.GetOffset(t,1));i=0;u=this.currentParagraph.GetNextValidOffset(this.offset);h=this.currentParagraph.GetLength();this.offset<=u&&this.offset<h+1?this.offset==u?this.offset=h+1:(this.offset=u,c=this.currentParagraph.GetInline(this.offset,i),t=c.inline,i=c.index,t!=null&&i==t.Length&&t.NextNode instanceof e&&(l=t.NextNode.GetNextValidInline(),l instanceof a&&(t=l,this.offset=this.currentParagraph.GetOffset(t,1)))):(r=this.currentParagraph.GetNextSelection(this.OwnerControl.Selection),r!=null&&(f=!1,r.Owner instanceof ht&&(this.OwnerControl.Selection.Start.Paragraph.IsInsideTable?(k=this.OwnerControl.Selection.Start.Paragraph.AssociatedCell.GetContainerCellOf(r.AssociatedCell),f=!k.Contains(r.AssociatedCell)):f=!0),this.currentParagraph=r,this.offset=f?this.currentParagraph.GetLength()+1:1),v=this.currentParagraph.GetInline(this.offset,i),t=v.inline,i=v.index,t instanceof a&&this.offset++);this.UpdatePhysicalPosition()},n.prototype.MoveBackward=function(){var i=0,f=this.currentParagraph.GetInline(this.offset,i),t=f.inline,r,p,c,u,o,w,l;if(i=f.index,!this.OwnerControl.Selection.IsEmpty&&t!=null&&(r=t.GetNextRenderedInline(i),r instanceof s)){var v=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),h=r.fieldEnd.OwnerParagraph.GetOffset(r.fieldEnd,1),y=r.fieldEnd.OwnerParagraph.GetHierarchicalIndex(h.toString());if(!n.IsForwardSelection(y,v)){this.OwnerControl.Selection.Start.SetPositionParagraph(r.fieldEnd.OwnerParagraph,h);return}}if(t instanceof a&&t.FieldBegin!=null){var v=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),h=t.OwnerParagraph.GetOffset(t,1),y=t.OwnerParagraph.GetHierarchicalIndex(h.toString());if(!n.IsForwardSelection(v,y)){p=t.FieldBegin.OwnerParagraph.GetOffset(t.FieldBegin,0);this.currentParagraph=t.FieldBegin.OwnerParagraph;this.offset=p;this.UpdatePhysicalPosition();return}this.MovePreviousPositionInternal(t)}c=this.currentParagraph.GetPreviousValidOffset(this.offset);this.offset>c?this.offset=c:(u=this.currentParagraph.GetPreviousSelection(this.OwnerControl.Selection),u!=null&&(o=!1,u.Owner instanceof ht&&(this.OwnerControl.Selection.Start.Paragraph.IsInsideTable?(w=this.OwnerControl.Selection.Start.Paragraph.AssociatedCell.GetContainerCellOf(u.AssociatedCell),o=!w.Contains(u.AssociatedCell)):o=!0),this.currentParagraph=u,this.offset=o?this.currentParagraph.GetStartOffset():this.currentParagraph.GetEndOffset()));i=0;f=this.currentParagraph.GetInline(this.offset,i);t=f.inline;i=f.index;t instanceof e&&(l=t.GetPreviousValidInline(),l!=null&&(t=l,this.currentParagraph=t.OwnerParagraph,this.offset=this.currentParagraph.GetOffset(t,t instanceof s?0:t.Length)));this.UpdatePhysicalPosition()},n.prototype.IsInSameDocument=function(n){if(n==null)throw new RangeError("The textPosition cannot be null.");return this.Document==n.Document},n.prototype.IsAtSamePosition=function(n){return this.currentParagraph==n.currentParagraph&&this.offset==n.offset},n.prototype.IsExistBefore=function(n){if(n==null)throw new Error("textPosition is null.");if(!this.IsInSameDocument(n))throw new Error("textPosition is not in the same document.");return this.currentParagraph==n.currentParagraph?this.offset<n.offset:this.currentParagraph.Owner==n.currentParagraph.Owner?this.currentParagraph.IsInsideTable?this.currentParagraph.AssociatedCell.Blocks.IndexOf(this.currentParagraph)<n.currentParagraph.AssociatedCell.Blocks.IndexOf(n.currentParagraph):this.currentParagraph.Owner instanceof c?this.currentParagraph.Owner.Blocks.indexOf(this.currentParagraph)<n.currentParagraph.Owner.Blocks.indexOf(n.currentParagraph):this.currentParagraph.Section.Blocks.indexOf(this.currentParagraph)<n.currentParagraph.Section.Blocks.indexOf(n.currentParagraph):this.currentParagraph.IsExistBefore(n.currentParagraph)},n.prototype.IsExistAfter=function(n){if(n==null)throw new Error("textPosition is null.");if(!this.IsInSameDocument(n))throw new Error("textPosition is not in the same document.");return this.currentParagraph==n.currentParagraph?this.offset>n.offset:this.currentParagraph.Owner==n.currentParagraph.Owner?this.currentParagraph.IsInsideTable?this.currentParagraph.AssociatedCell.Blocks.IndexOf(this.currentParagraph)>n.currentParagraph.AssociatedCell.Blocks.IndexOf(n.currentParagraph):this.currentParagraph.Owner instanceof c?this.currentParagraph.Owner.Blocks.IndexOf(this.currentParagraph)>n.currentParagraph.Owner.Blocks.IndexOf(n.currentParagraph):this.currentParagraph.Section.Blocks.IndexOf(this.currentParagraph)>n.currentParagraph.Section.Blocks.IndexOf(n.currentParagraph):this.currentParagraph.IsExistAfter(n.currentParagraph)},n.prototype.Clone=function(){var t=new n(this.OwnerControl);return t.currentParagraph=this.currentParagraph,t.offset=this.offset,t.location=this.location,t},n.prototype.GetHierarchicalIndexInternal=function(){return this.Paragraph.GetHierarchicalIndex(this.Offset.toString())},n.prototype.Dispose=function(){this.currentParagraph=null;this.location=null},n.IsForwardSelection=function(n,t){var i,f,e;if(n==t)return!0;n=n.replace(/C;/g,"");t=t.replace(/C;/g,"");var o=n.split(";"),r=t.split(";"),u=o.length;for(u>r.length&&(u=r.length-1),i=0;i<u;i++)if(f=parseFloat(o[i]),e=parseFloat(r[i]),f!=e)return f<e;return!1},n}();i.TextPosition=oi;vu=function(){function n(n){this.SelectedWidgets=null;this.ownerControl=n;this.SelectedWidgets=new dt}return Object.defineProperty(n.prototype,"Start",{get:function(){return this.start==null&&this.ownerControl!=null&&this.ownerControl.Document!=null&&(this.start=this.ownerControl.Document.DocumentStart),this.start},set:function(n){this.start=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"End",{get:function(){return this.end==null&&this.Start!=null&&(this.end=this.Start.Clone()),this.end},set:function(n){this.end=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsEmpty",{get:function(){return this.Start==null?!0:this.Start.IsAtSamePosition(this.End)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsForward",{get:function(){return this.Start.IsExistBefore(this.End)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"OwnerControl",{get:function(){return this.ownerControl},enumerable:!0,configurable:!0}),n.prototype.ClearSelectionHighlight=function(){for(var t=this.SelectedWidgets.Keys,n=0;n<t.Count;n++)this.RemoveSelectionHighlight(t[n]);this.SelectedWidgets.Clear()},n.prototype.ClearSelectionHighlightInternal=function(n){this.RemoveSelectionHighlight(n);this.SelectedWidgets.Remove(n)},n.prototype.RemoveSelectionHighlight=function(n){var u=0,f=0,e=0,o=0,t=null,r,h,i,s,c;if(n instanceof gi){if(r=n,t=r.CurrentParagraphWidget.GetPage(),t==null)return;i=this.SelectedWidgets.Get(n);e=i.Width;u=i.Left;f=r.GetTop();o=r.Height}if(n instanceof ni){if(h=n,t=h.GetPage(),t==null)return;i=this.SelectedWidgets.Get(n);e=i.Width;u=i.Left;f=n.Y;o=n.Height}t!=null&&(s=document.getElementById(t.Id+"_selection"),s!=null)&&(c=s.getContext("2d"),c.clearRect(u,f,e,o))},n.prototype.AddSelectionHighlight=function(n,t,i){if(this.SelectedWidgets.ContainsKey(t)){var u=t.Height,r=this.SelectedWidgets.Get(t),f=r.Width,e=r.Left;n.fillStyle="gray";n.globalAlpha=.4;n.fillRect(e,i,f,u)}},n.prototype.AddSelectionHighlightTable=function(n,t){if(this.SelectedWidgets.ContainsKey(t)){var i=this.SelectedWidgets.Get(t),r=i.Left,u=t.Y,f=i.Width,e=t.Height;n.fillStyle="gray";n.globalAlpha=.4;n.fillRect(r,u,f,e)}},n.prototype.GetSelectedContentAsHTML=function(){return this.IsForward?this.Start.Paragraph.GetSelectedContent(this.OwnerControl.Selection,this.Start,this.End):this.End.Paragraph.GetSelectedContent(this.OwnerControl.Selection,this.End,this.Start)},n.prototype.Dispose=function(){this.start!=null&&(this.start.Dispose(),this.start=null);this.end!=null&&(this.end.Dispose(),this.end=null);this.ClearSelectionHighlight();this.ownerControl=null},n}();i.SelectionRange=vu;nu=function(){function n(n){this.ranges=new o;this.ownerControl=n}return Object.defineProperty(n.prototype,"Count",{get:function(){return this.ranges!=null?this.ranges.length:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"OwnerControl",{get:function(){return this.ownerControl},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"First",{get:function(){return this.ranges!=null&&this.ranges.Count>0?this.ranges[0]:null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Last",{get:function(){return this.ranges!=null&&this.ranges.Count>0?this.ranges[this.ranges.length-1]:null},enumerable:!0,configurable:!0}),n.prototype.Get=function(n){return n>-1&&n<this.ranges.length?this.ranges[n]:null},n.prototype.Clear=function(){this.ranges!=null&&this.ranges.Count>0&&(this.ownerControl.Viewer.ClearSelectionHighlight(),this.ranges.Clear())},n.prototype.Contains=function(n){if(n==null)throw new ReferenceError("SelectionRange cannot be null.");return this.ranges==null?!1:this.ranges.Contains(n)},n.prototype.Remove=function(n){if(n==null)throw new ReferenceError("SelectionRange cannot be null.");return this.ranges!=null&&this.ranges.Contains(n)?(n.ClearSelectionHighlight(),this.ranges.Remove(n),!0):!1},n.prototype.AddSelection=function(n,t){this.ranges==null&&(this.ranges=new o);var i=new vu(this.ownerControl);i.Start.SetPositionInternal(n);i.End.SetPositionInternal(t);i.IsEmpty||(i.IsForward?i.End.UpdateTextPositionOnFieldCharacter(i.Start):i.Start.UpdateTextPositionOnFieldCharacter(i.End),this.CheckSelectionRangesIsExist(i.Start,i.End));this.ranges.Add(i)},n.prototype.CheckSelectionRangesIsExist=function(n,t){var r=n,u=t,f;if(!r.IsAtSamePosition(u))for(n.IsExistBefore(t)||(r=t,u=n),f=0;f<this.ranges.Count-1;f++){var i=this.ranges[f],e=i.Start,o=i.End;i.Start.IsExistBefore(i.End)||(e=i.End,o=i.Start);(r.IsAtSamePosition(e)||u.IsAtSamePosition(o)||r.IsExistBefore(e)&&u.IsExistAfter(e)||r.IsExistBefore(o)&&u.IsExistAfter(o)||r.IsExistAfter(e)&&u.IsExistBefore(o))&&(this.Remove(i),f--)}},n.prototype.UpdateSelectionRange=function(){var i=this.Last,r=i.Start,u=i.End,o,n;for(i.Start.IsExistBefore(i.End)||(r=i.End,u=i.Start),o=!r.IsAtSamePosition(u),n=0;n<this.ranges.Count-1;n++){var t=this.ranges[n],f=t.Start,e=t.End;f.IsAtSamePosition(e)?(this.ranges.RemoveAt(n),n--):o&&(t.Start.IsExistBefore(t.End)||(f=t.End,e=t.Start),(r.IsAtSamePosition(f)||u.IsAtSamePosition(e)||r.IsExistBefore(f)&&u.IsExistAfter(f)||r.IsExistBefore(e)&&u.IsExistAfter(e)||r.IsExistAfter(f)&&u.IsExistBefore(e))&&(this.Remove(t),n--))}o||this.ranges.RemoveAt(this.ranges.Count-1)},n.prototype.ClearSelection=function(){if(this.ranges!=null&&this.ranges.Count>0){this.ownerControl.Viewer.ClearSelectionHighlight();for(var n=0;n<this.ranges.Count-1;n++)this.ranges[n].Dispose(),this.ranges.RemoveAt(n),n--}},n.prototype.ClearMultiSelection=function(){if(this.ranges!=null&&this.ranges.length>1){this.ownerControl.Viewer.ClearSelectionHighlight();for(var n=0;n<this.ranges.Count-1;n++)this.ranges[n].Dispose(),this.ranges.RemoveAt(n),n--}},n.prototype.Dispose=function(){if(this.ranges!=null&&this.ranges.Count>0){for(var n=0;n<this.ranges.Count-1;n++)this.ranges[n].Dispose(),n--;this.ranges.Clear();this.ranges=null}this.ownerControl=null},n.prototype.RemoveSelectionHighlight=function(n){if(this.ranges!=null)for(var t=0;t<this.ranges.Count;t++)this.ranges[t].SelectedWidgets.ContainsKey(n)&&this.ranges[t].RemoveSelectionHighlight(n)},n.prototype.ClearSelectionHighlightInternal=function(n){if(this.ranges!=null)for(var t=0;t<this.ranges.Count;t++)this.ranges[t].SelectedWidgets.ContainsKey(n)&&this.ranges[t].ClearSelectionHighlightInternal(n)},n.prototype.ClearSelectionHighlight=function(){if(this.ranges!=null)for(var n=0;n<this.ranges.Count;n++)this.ranges[n].ClearSelectionHighlight()},n.prototype.AddSelectionHighlight=function(n,t,i){if(this.ranges!=null)for(var r=0;r<this.ranges.Count;r++)this.ranges[r].AddSelectionHighlight(n,t,i)},n.prototype.AddSelectionHighlightTable=function(n,t){if(this.ranges!=null)for(var i=0;i<this.ranges.Count;i++)this.ranges[i].AddSelectionHighlightTable(n,t)},n}();i.SelectionRangeCollection=nu;tu=function(){function n(n){this.ownerControl=null;this.UpDownSelectionLength=0;this.ownerControl=n;this.selectionRanges=new nu(n)}return Object.defineProperty(n.prototype,"SelectionRanges",{get:function(){return this.selectionRanges},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"OwnerControl",{get:function(){return this.ownerControl},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Start",{get:function(){if(this.OwnerControl!=null&&this.OwnerControl.Document!=null){if(this.SelectionRanges==null&&(this.SelectionRanges=new nu(this.OwnerControl)),this.OwnerControl.Selection.SelectionRanges.Count==0){var n=this.ownerControl.Document.DocumentStart;this.OwnerControl.Selection.SelectionRanges.AddSelection(n,n)}if(this.OwnerControl.Selection.SelectionRanges.Count>0)return this.OwnerControl.Selection.SelectionRanges.Get(this.OwnerControl.Selection.SelectionRanges.Count-1).Start}return null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"End",{get:function(){return this.OwnerControl.Selection.SelectionRanges!=null&&this.OwnerControl.Selection.SelectionRanges.Count>0?this.OwnerControl.Selection.SelectionRanges.Get(this.OwnerControl.Selection.SelectionRanges.Count-1).End:null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsEmpty",{get:function(){return this.Start==null?!0:this.Start.IsAtSamePosition(this.End)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsForward",{get:function(){return this.Start.IsExistBefore(this.End)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CurrentSelectionRange",{get:function(){return this.OwnerControl.IsDocumentLoaded&&this.OwnerControl.Selection.SelectionRanges!=null&&this.OwnerControl.Selection.SelectionRanges.Count>0?this.OwnerControl.Selection.SelectionRanges.Get(this.OwnerControl.Selection.SelectionRanges.Count-1):null},enumerable:!0,configurable:!0}),n.prototype.ExtendBackward=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveBackward(),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.ExtendForward=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveForward(),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.Select=function(n,t,i,r,u){u&&this.SelectionRanges.ClearMultiSelection();this.Start.SetPositionForSelection(n,t,i,r);this.End.SetPositionInternal(this.Start);this.UpDownSelectionLength=r.X;this.FireSelectionChanged(!0)},n.prototype.SelectRange=function(n,t,i){i&&this.SelectionRanges.ClearMultiSelection();this.Start.SetPositionInternal(n);this.End.SetPositionInternal(t);this.UpDownSelectionLength=this.End.Location.X;this.FireSelectionChanged(!0)},n.prototype.FireSelectionChanged=function(n){this.IsEmpty||(this.IsForward?(this.Start.UpdatePhysicalPositionInternal(!0),this.End.UpdatePhysicalPositionInternal(!1)):(this.Start.UpdatePhysicalPositionInternal(!1),this.End.UpdatePhysicalPositionInternal(!0)));this.ownerControl.Viewer.ClearSelectionHighlight();this.HighlightSelection(n);n&&this.OwnerControl.RaiseClientEvent(pi.SelectionChange,null)},n.prototype.HighlightSelection=function(n){var i,t;if(!this.IsEmpty)if(this.SelectionRanges.Count>0)for(i=0;i<this.SelectionRanges.Count;i++)t=this.SelectionRanges.Get(i),t.IsForward?t.Start.Paragraph.HighlightSelectedContent(this,t,t.Start,t.End):t.End.Paragraph.HighlightSelectedContent(this,t,t.End,t.Start);else this.IsForward?this.Start.Paragraph.HighlightSelectedContent(this,this.CurrentSelectionRange,this.Start,this.End):this.End.Paragraph.HighlightSelectedContent(this,this.CurrentSelectionRange,this.End,this.Start);n&&this.OwnerControl.Viewer.ScrollToPosition(this.Start,this.End)},n.prototype.CreateHighlightBorder=function(n,t,i,r,u){var o=t.CurrentParagraphWidget.GetPage(),s=t.Height,h=new iu(r,i),e,f;n.SelectedWidgets.Add(t,h);e=document.getElementById(o.Id+"_selection");e!=null&&(f=e.getContext("2d"),f.fillStyle="gray",f.globalAlpha=.4,f.fillRect(r,u,i,s))},n.prototype.CreateHighlightBorderInsideTable=function(n,t,i){var c=n.GetPage(),f=document.getElementById(c.Id+"_selection"),u=null,e=n.X-n.Margin.Left+n.LeftBorderWidth,o=n.Width+n.Margin.Left+n.Margin.Right-n.LeftBorderWidth-n.RightBorderWidth,s=n.Y,h=n.Height,r;i.SelectedWidgets.ContainsKey(n)?(u=i.SelectedWidgets.Get(n),f!=null&&(r=f.getContext("2d"),r.clearRect(u.Left,s,u.Width,h))):(u=new iu(e,o),i.SelectedWidgets.Add(n,u));f!=null&&(r=f.getContext("2d"),r.fillStyle="gray",r.globalAlpha=.4,r.fillRect(e,s,o,h))},n.prototype.MoveTextPosition=function(n,t,i){var s,h,c,l,f,o;if(this.Start!=null){if(t&&this.selectionRanges.ClearMultiSelection(),s=this.OwnerControl.Viewer.GetLineWidgetInternal(n,!0),s!=null&&s.UpdateTextPositionWidget(this.OwnerControl,n,i,!0),this.UpDownSelectionLength=i.Location.X,h=i.Paragraph.GetLength(),!this.IsEmpty&&!this.IsForward&&i.Offset>h){var u=0,v=i.Paragraph.GetInline(h,u),r=v.inline;u=v.index;c=i.Paragraph;l=0;r!=null&&(r=r.GetPreviousValidInline(),u=r instanceof e?0:r.Length,r instanceof a&&u++,l=r.OwnerParagraph.GetOffset(r,u),c=r.OwnerParagraph);i.SetPositionParagraph(c,l)}f=this.Start.GetHierarchicalIndexInternal();o=this.End.GetHierarchicalIndexInternal();f!=o&&(oi.IsForwardSelection(f,o)?i.ValidateForwardFieldSelection(f,o):i.ValidateBackwardFieldSelection(f,o));this.FireSelectionChanged(!0)}},n.prototype.Copy=function(){this.IsEmpty||this.CopySelectedContent(!1)},n.prototype.CopySelectedContent=function(){for(var t="",n=0;n<this.SelectionRanges.Count;n++)t+=this.SelectionRanges.Get(n).GetSelectedContentAsHTML();this.CopyToClipboard(t)},n.prototype.CopyToClipboard=function(n){var i=window.getSelection(),t,r,u;i.removeAllRanges();t=document.createElement("div");t.innerHTML=n;document.body.appendChild(t);r=document.createRange();r.selectNodeContents(t);i.addRange(r);u=!1;try{u=document.execCommand("copy")}catch(f){}finally{i.removeAllRanges();t.parentNode.removeChild(t)}return u},n.prototype.GetHyperlinkField=function(){var t,i;if(this.End==null)return null;t=0;i=this.End.Paragraph.GetInline(this.End.Offset,t);t=i.index;var r=i.inline,n=new o,u=null;return u=r==null?this.End.Paragraph.GetHyperlinkFields(this.End.Paragraph,n):r.OwnerParagraph.GetHyperlinkField(r,n),n.Clear(),n=null,u},n}();i.SelectionAdv=tu;iu=function(){function n(n,t){this.left=0;this.width=0;this.left=n;this.width=t}return Object.defineProperty(n.prototype,"Left",{get:function(){return this.left},set:function(n){this.left=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Width",{get:function(){return this.width},set:function(n){this.width=n},enumerable:!0,configurable:!0}),n}();i.SelectionWidgetInfo=iu;yu=function(){function n(n){var i,r,u,f;if(this.CurrentPage=null,this.tableLeft=[],this.Pages=new o,this.selectionStartPage=null,this.selectionEndPage=null,this.zoomFactor=1,this.touchStart=null,this.touchEnd=null,this.IsTouchInput=!1,this.IsFieldCode=!1,this.CurrentHeaderFooter=null,this.SplittedCellWidgets=null,this.isMousedown=!1,this.isSelectionChangedOnMouseMoved=!1,this.HorizontalScrollBar=null,this.VerticalScrollBar=null,this.preZoomFactor=0,this.preDifference=-1,this.PointerCount=0,this.Pointers=[],this.ScrollStartX=-1,this.ScrollStartY=-1,this.LineElements=new cu,this.FieldStack=new o,n!=null){if(this.Pages=new o,this.SplittedCellWidgets=new o,this.OwnerControl=n,i=this,this.OwnerControl.DocumentEditorElement==null)return;this.ViewerContatiner=document.createElement("div");this.ViewerContatiner.style.touchAction="pan-x pan-y";this.OwnerControl.DocumentEditorElement.appendChild(this.ViewerContatiner);this.Container=document.createElement("div");this.Container.setAttribute("id",this.OwnerControl.ContainerId+"_viewerContainer");this.Container.style.overflow="hidden";this.Container.style.cssFloat="left";this.Container.style.position="relative";this.Container.style.pointerEvents="none";this.Container.style.backgroundColor="#EEEEEE";this.ViewerContatiner.appendChild(this.Container);this.ViewerContatiner.tabIndex=0;this.ViewerContatiner.style.outline="none";r=this.OwnerControl.ej.buildTag("div","",{display:"none",float:"right"},{id:this.OwnerControl.ContainerId+"_verticalScrollBar"});r.ejScrollBar({orientation:"vertical",minimum:0,width:18,height:0,infiniteScrolling:!1,scroll:t.proxy(this.VerticalScrollBar_ValueChanged,this)});this.VerticalScrollBar=r.data("ejScrollBar");this.ViewerContatiner.appendChild(r[0]);u=this.OwnerControl.ej.buildTag("div","",{display:"none"},{id:this.OwnerControl.ContainerId+"_horizontalScrollBar"});u.ejScrollBar({orientation:"horizontal",minimum:0,width:0,height:18,infiniteScrolling:!1,scroll:t.proxy(this.HorizontalScrollBar_ValueChanged,this)});this.HorizontalScrollBar=u.data("ejScrollBar");this.ViewerContatiner.appendChild(u[0]);this.UpdateViewerSize();this.InitContextMenu();f=0;window.addEventListener("resize",function(){f&&clearTimeout(f);f=setTimeout(function(){i.UpdateViewerSizeOnWindowResize()},100)});this.ViewerContatiner.addEventListener("mousedown",function(n){i.OnMouseDownInternal(n)});this.ViewerContatiner.addEventListener("mousemove",function(n){i.OnMouseMoveInternal(n)});this.ViewerContatiner.addEventListener("mouseup",function(n){i.OnMouseUpInternal(n)});this.ViewerContatiner.addEventListener("mousewheel",function(n){i.OnMouseWheelInternal(n)});navigator.userAgent.match("Firefox")&&this.ViewerContatiner.addEventListener("DOMMouseScroll",function(n){i.OnMouseWheelInternal(n)});this.ViewerContatiner.addEventListener("contextmenu",function(n){i.OnContextMenuInternal(n)});this.ViewerContatiner.addEventListener("keydown",function(n){var t=n.which||n.keyCode,r=n.ctrlKey?n.ctrlKey:t===17?!0:!1;t==67&&r?i.OwnerControl.Selection.Copy():t==65&&r&&i.OwnerControl.Selection.SelectRange(i.OwnerControl.Document.DocumentStart,i.OwnerControl.Document.DocumentEnd,!0)});window.addEventListener("mousedown",function(){i.HideContextMenu()});window.addEventListener("keyup",function(n){n.keyCode==27&&i.HideContextMenu()});i.InitTouchEvents()}}return Object.defineProperty(n.prototype,"VisibleBounds",{get:function(){return this.visibleBounds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CurrentRenderingPage",{get:function(){return this.Pages.length==0?null:this.Pages[this.Pages.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"SelectionStartPage",{get:function(){return this.selectionStartPage},set:function(n){this.selectionStartPage=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"SelectionEndPage",{get:function(){return this.selectionEndPage},set:function(n){this.selectionEndPage=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ZoomFactor",{get:function(){return this.zoomFactor},set:function(n){this.zoomFactor=n;this.OnZoomFactorChanged()},enumerable:!0,configurable:!0}),n.prototype.InitContextMenu=function(){var n,u,t,o,f,i,s,e,r,h;yt.AddCssStyle("."+p.ContextMenuItem+":hover{ background-color: #86CBEA }");yt.AddCssStyle("."+p.ContextMenuItem+"{display:block}");yt.AddCssStyle("."+p.DisabledContextMenuItem+"{opacity:0.5;}");yt.AddCssStyle("."+p.HiddenContextMenuItem+"{display:none;}");this.ContextMenu=document.createElement("nav");this.ContextMenu.style.zIndex="10";this.ContextMenu.style.display="none";this.ContextMenu.style.position="absolute";this.ContextMenu.style.width="260px";this.ContextMenu.style.background="#FFFFFF";this.ContextMenu.style.border="1px solid #D3D3D3";this.ContextMenu.style.padding="4px 0px";this.ViewerContatiner.appendChild(this.ContextMenu);n=document.createElement("ul");n.style.listStyle="none";n.style.margin="0px";n.style.padding="0px";this.ContextMenu.appendChild(n);u=document.createElement("li");u.style.display="block";n.appendChild(u);t=document.createElement("a");t.className=p.ContextMenuItem;t.id=p.ContextMenuCopy;this.SetStyleToContextMenuItem(t);u.appendChild(t);o=document.createElement("span");o.innerText="Copy";t.appendChild(o);f=document.createElement("li");f.style.display="block";n.appendChild(f);i=document.createElement("a");i.className=p.ContextMenuItem;i.id=p.ContextMenuOpenHyperlink;this.SetStyleToContextMenuItem(i);f.appendChild(i);s=document.createElement("span");s.innerText="Open link";i.appendChild(s);e=document.createElement("li");e.style.display="block";n.appendChild(e);r=document.createElement("a");r.className=p.ContextMenuItem;r.id=p.ContextMenuCopyHyperlink;this.SetStyleToContextMenuItem(r);e.appendChild(r);h=document.createElement("span");h.innerText="Copy link address";r.appendChild(h)},n.prototype.SetStyleToContextMenuItem=function(n){n.style.color="#333333";n.style.textDecoration="none";n.style.fontSize="12px";n.style.fontFamily="Segoe UI";n.style.cursor="default";n.style.position="relative";n.style.lineHeight="27px";n.style.padding="4px 20px"},n.prototype.OnContextMenuInternal=function(n){(n.preventDefault(),n.target==this.ViewerContatiner)&&this.OwnerControl.ej.browserInfo().name!="webkit"&&(this.AddContextMenuItems(),this.ShowContextMenu(),this.PositionContextMenu(n))},n.prototype.AddContextMenuItems=function(){var r=document.getElementById(p.ContextMenuCopy),n=document.getElementById(p.ContextMenuOpenHyperlink),t=document.getElementById(p.ContextMenuCopyHyperlink),i;r.className=this.OwnerControl.Selection.IsEmpty?p.DisabledContextMenuItem:p.ContextMenuItem;i=this.OwnerControl.Selection.GetHyperlinkField();i==null?(n.className=p.HiddenContextMenuItem,t.className=p.HiddenContextMenuItem):(n.className=p.ContextMenuItem,t.className=p.ContextMenuItem)},n.prototype.ShowContextMenu=function(){this.ContextMenu.style.display=="none"&&(this.ContextMenu.style.display="block")},n.prototype.HideContextMenu=function(){this.ContextMenu.style.display!="none"&&(this.ContextMenu.style.display="none")},n.prototype.PositionContextMenu=function(n){var t=this.GetContextMenuPosition(n),i=t.X,r=t.Y,u=this.ContextMenu.offsetWidth+4,f=this.ContextMenu.offsetHeight+4,e=window.innerWidth,o=window.innerHeight;this.ContextMenu.style.left=e-i<u?e-u+"px":i+"px";this.ContextMenu.style.top=o-r<f?o-f+"px":r+"px"},n.prototype.GetContextMenuPosition=function(n){var t=0,i=0;return n||(n=window.event),n.pageX||n.pageY?(t=n.pageX,i=n.pageY):(n.clientX||n.clientY)&&(t=n.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=n.clientY+document.body.scrollTop+document.documentElement.scrollTop),new rt(t,i)},n.prototype.GetContextMenuItem=function(n,t){var i=n.srcElement||n.target;if(i.classList.contains(t))return i;while((i=i.parentNode)!=null)if(i.classList&&i.classList.contains(t))return i;return null},n.prototype.HandleContextMenuItem=function(n){var t;switch(n){case p.ContextMenuCopy:this.OwnerControl.Selection.Copy();break;case p.ContextMenuOpenHyperlink:t=this.OwnerControl.Selection.GetHyperlinkField();this.OwnerControl.FireRequestNavigate(t);break;case p.ContextMenuCopyHyperlink:var i=this.OwnerControl.Selection.GetHyperlinkField(),r=new gr(i),u=new tu(null);u.CopyToClipboard(r.NavigationLink)}},n.prototype.UpdateViewerSizeOnWindowResize=function(){var n=this,t=this.OwnerControl.DocumentEditorElement;n.UpdateViewerSize();n.UpdateScrollBars()},n.prototype.UpdateViewerSize=function(){var r=this.OwnerControl.DocumentEditorElement,n=r.getBoundingClientRect(),t=0,i=0;i=n.height>0?n.height:200;t=n.width>0?n.width:200;this.ViewerContatiner.style.height=i.toString()+"px";this.ViewerContatiner.style.width=t.toString()+"px";this.Container.style.height=i.toString()+"px";this.Container.style.width=t.toString()+"px";this.visibleBounds=new v(0,0,t,i)},n.prototype.ValidateFocus=function(){this.ViewerContatiner.focus()},n.prototype.InitTouchEvents=function(){var n=this;navigator.userAgent.match("Edge")||navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET")?(this.ViewerContatiner.addEventListener("pointerdown",function(t){n.OnPointerDownInternal(t)}),this.ViewerContatiner.addEventListener("pointermove",function(t){n.OnPointerMoveInternal(t)}),this.ViewerContatiner.addEventListener("pointerup",function(t){n.OnPointerUpInternal(t)}),this.ViewerContatiner.addEventListener("pointerleave",function(t){n.OnPointerUpInternal(t)})):(navigator.userAgent.match("Chrome")||navigator.userAgent.match("FireFox")||navigator.userAgent.match("Safari"))&&(this.ViewerContatiner.addEventListener("touchstart",function(t){n.OnTouchStartInternal(t)}),this.ViewerContatiner.addEventListener("touchmove",function(t){n.OnTouchMoveInternal(t)}),this.ViewerContatiner.addEventListener("touchend",function(t){n.OnTouchEndInternal(t)}),this.ViewerContatiner.addEventListener("touchcancel",function(t){n.OnTouchEndInternal(t)}))},n.prototype.InitTouchEllipse=function(){this.touchStart=document.createElement("div");this.touchStart.style.backgroundColor="transparent";this.touchStart.style.borderStyle="solid";this.touchStart.style.borderColor="black";this.touchStart.style.borderWidth="1px";this.touchStart.style.borderRadius="50%";this.touchStart.style.width="12px";this.touchStart.style.height="13px";this.touchStart.style.position="relative";this.touchStart.style.display="none";this.Container.appendChild(this.touchStart);this.touchEnd=document.createElement("div");this.touchEnd.style.backgroundColor="transparent";this.touchEnd.style.borderStyle="solid";this.touchEnd.style.borderColor="black";this.touchEnd.style.borderWidth="1px";this.touchEnd.style.borderRadius="50%";this.touchEnd.style.width="12px";this.touchEnd.style.height="13px";this.touchEnd.style.position="relative";this.touchEnd.style.display="none";this.Container.appendChild(this.touchEnd)},n.prototype.OnPointerDownInternal=function(n){n.pointerType=="touch"&&(this.PointerCount=this.PointerCount+1,this.PointerCount<=2&&(n.preventDefault(),this.Pointers.push(n),this.PointerCount==2&&(this.PointerCount=0),this.ScrollStartX==-1&&this.ScrollStartY==-1&&(navigator.userAgent.match("Edge")||navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET"))&&(this.ScrollStartY=n.pageY,this.ScrollStartX=n.pageX)),this.IsTouchInput=!1)},n.prototype.OnPointerMoveInternal=function(n){var r,u,f,i,t,e;if(n.pointerType=="touch"&&(this.PointerCount==1&&(r=n.pageX-this.ViewerContatiner.offsetLeft,f=n.pageY-this.ViewerContatiner.offsetTop,r<this.Container.clientWidth&&f<this.Container.clientHeight&&this.ScrollContainer(n)),this.Pointers.length==2&&(r=this.Pointers[0].pageX-this.ViewerContatiner.offsetLeft,u=this.Pointers[1].pageX-this.ViewerContatiner.offsetLeft,r<this.Container.offsetWidth&&u<this.Container.offsetWidth))){for(i=0;i<this.Pointers.length;i++)if(n.pointerId==this.Pointers[i].pointerId){this.Pointers[i]=n;break}t=Math.sqrt(Math.pow(this.Pointers[0].clientX-this.Pointers[1].clientX,2)+Math.pow(this.Pointers[0].clientY-this.Pointers[1].clientY,2));this.preDifference>-1&&(t>this.preDifference?this.OnPinchOutInternal(n):t<this.preDifference&&this.OnPinchInInternal(n));e=this.VerticalScrollBar.value;e==0||(t>this.preDifference?this.OnPinchOutInternal(n):t<this.preDifference&&this.OnPinchInInternal(n));this.preDifference=t}},n.prototype.OnPointerUpInternal=function(n){n.pointerType=="touch"&&(this.Pointers=[],this.PointerCount=0,this.preDifference=-1,this.IsTouchInput=!1,this.ScrollStartX=-1,this.ScrollStartY=-1)},n.prototype.OnTouchStartInternal=function(n){this.IsTouchInput=!0;var t=n.touches;t.length==1;this.ScrollStartX==-1&&this.ScrollStartY==-1&&(this.ScrollStartY=t[0].pageY,this.ScrollStartX=t[0].pageX);n.preventDefault()},n.prototype.OnTouchMoveInternal=function(n){var t=n.touches,r,u,i;t.length==1&&(r=t[0].pageX-this.ViewerContatiner.offsetLeft,u=t[0].pageY-this.ViewerContatiner.offsetTop,r<this.Container.clientWidth&&u<this.Container.clientHeight&&this.ScrollContainer(n));t.length>1&&(i=Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2)),this.preDifference>-1?i>this.preDifference?this.OnPinchOutInternal(n):i<this.preDifference&&this.OnPinchInInternal(n):this.ZoomFactor<2?this.preDifference!=-1&&i>this.preDifference&&this.OnPinchInInternal(n):this.preDifference==-1&&this.ZoomFactor>2&&i>this.preDifference&&this.OnPinchInInternal(n),this.preDifference=i);n.preventDefault()},n.prototype.OnTouchEndInternal=function(n){n.touches.length==1;this.ScrollStartX=-1;this.ScrollStartY=-1;this.preDifference=-1;this.IsTouchInput=!1;n.preventDefault()},n.prototype.OnPinchInInternal=function(){if(this.preZoomFactor=this.ZoomFactor,this.ZoomFactor=this.ZoomFactor-.01,this.ZoomFactor<5&&this.ZoomFactor>2&&(this.ZoomFactor=this.ZoomFactor-.01),this.ZoomFactor<.1&&(this.ZoomFactor=.1),this.ZoomFactor>=.1){var n=this.VerticalScrollBar.model.value/this.preZoomFactor*this.ZoomFactor;this.VerticalScrollBar.scroll(n)}},n.prototype.OnPinchOutInternal=function(){if(this.preZoomFactor=this.ZoomFactor,this.ZoomFactor=this.ZoomFactor+.01,this.ZoomFactor>2&&(this.ZoomFactor=this.ZoomFactor+.01),this.ZoomFactor>5&&(this.ZoomFactor=5),this.ZoomFactor<=5){var n=this.VerticalScrollBar.model.value/this.preZoomFactor*this.ZoomFactor;this.VerticalScrollBar.scroll(n)}},n.prototype.ScrollContainer=function(n){var t,i;navigator.userAgent.match("Edge")||navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET")?(t=this.ScrollStartX-n.pageX,i=this.ScrollStartY-n.pageY):(t=this.ScrollStartX-n.touches[0].pageX,i=this.ScrollStartY-n.touches[0].pageY);t<0&&(t=-t);i<0&&(i=-i);t>i?this.ScrollHorizontal(n):this.ScrollVertical(n)},n.prototype.ScrollHorizontal=function(n){var t=this.HorizontalScrollBar.model.value,i;navigator.userAgent.match("Edge")||navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET")?(n.preventDefault(),i=n.pageX,this.preDifference!=-1&&(t=this.preDifference>i?t+10:t-10),this.preDifference=i):n instanceof TouchEvent&&(n.preventDefault(),i=n.touches[0].pageX,this.preDifference!=-1&&(t=this.preDifference>i?t+10:t-10),this.preDifference=i);t<0&&(t=0);t>this.HorizontalScrollBar.model.maximum&&(t=this.HorizontalScrollBar.model.maximum);this.HorizontalScrollBar.scroll(t)},n.prototype.ScrollVertical=function(n){var t=this.VerticalScrollBar.model.value,i;navigator.userAgent.match("Edge")||navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET")?(n.preventDefault(),i=n.pageY,this.preDifference!=-1&&(t=this.preDifference>i?t+10:t-10),this.preDifference=i):n instanceof TouchEvent&&(n.preventDefault(),i=n.touches[0].pageY,this.preDifference!=-1&&(t=this.preDifference>i?t+10:t-10),this.preDifference=i);t<0&&(t=0);t>this.VerticalScrollBar.model.maximum&&(t=this.VerticalScrollBar.model.maximum);this.VerticalScrollBar.scroll(t)},n.prototype.OnMouseDownInternal=function(n){var i,t,r;if(this.IsTouchInput){n.preventDefault();return}if(i=this.GetContextMenuItem(n,p.ContextMenuItem),i!=null){this.HandleContextMenuItem(i.id);return}if(n.target==this.ViewerContatiner&&(this.ValidateFocus(),t=new rt(n.offsetX,n.offsetY),!(t.X>this.Container.clientWidth))&&!(t.Y>this.Container.clientHeight)){if(r=this.FindFocusedPage(t),n.which==3&&!this.OwnerControl.Selection.IsEmpty&&!this.UpdateCursorPosition(r)){n.preventDefault();return}this.isMousedown=!0;this.isSelectionChangedOnMouseMoved=!1;n.preventDefault()}},n.prototype.OnMouseMoveInternal=function(n){var i,t,r,u;if(this.IsTouchInput){n.preventDefault();return}if(this.isMousedown){if(i=new rt(n.offsetX,n.offsetY),t=this.FindFocusedPage(i),this.CurrentPage!=null&&(r=t.X,u=t.Y,this.isSelectionChangedOnMouseMoved||this.UpdateTextPosition(t,!0),this.IsLeftButtonPressed(n))){n.preventDefault();var f=u,e=this.OwnerControl.Selection.End,o=new rt(r,f);this.OwnerControl.Selection.MoveTextPosition(o,!0,e,this);this.isSelectionChangedOnMouseMoved=!0}this.CheckForCursorVisibility(!1)}this.UpdateCursor(n)},n.prototype.OnMouseUpInternal=function(n){if(this.IsTouchInput){n.preventDefault();return}var i=new rt(n.offsetX,n.offsetY),t=this.FindFocusedPage(i);this.isMousedown&&!this.isSelectionChangedOnMouseMoved&&this.CurrentPage!=null&&this.OwnerControl.Selection.Start!=null&&(this.UpdateTextPosition(t,!0),this.CheckForCursorVisibility(!1));this.CurrentPage!=null&&this.OwnerControl.Selection.Start!=null&&this.OwnerControl.Selection.IsEmpty&&n.ctrlKey==!0&&this.NavigateHyperlink(t);this.isMousedown=!1;this.isSelectionChangedOnMouseMoved=!1;this.IsTouchInput=!1;n.preventDefault()},n.prototype.OnMouseWheelInternal=function(n){var i,r,t,u;n.ctrlKey==!0?(n.preventDefault(),i=n.pageX-this.ViewerContatiner.offsetLeft,i<this.Container.offsetWidth&&(this.preZoomFactor=this.ZoomFactor,navigator.userAgent.match("Firefox")?n.detail<0?this.ZoomFactor<=4.9&&(this.ZoomFactor=this.ZoomFactor+.1):this.ZoomFactor>=.2&&(this.ZoomFactor=this.ZoomFactor-.1):this.ZoomFactor=n.wheelDelta>0?this.ZoomFactor<=4.9?this.ZoomFactor+.1:5:this.ZoomFactor>=.2?this.ZoomFactor-.1:.1,r=this.VerticalScrollBar.model.value/this.preZoomFactor*this.ZoomFactor,this.VerticalScrollBar.scroll(r))):(u=navigator.userAgent.match("Edge")||navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET")?n.wheelDelta:n.wheelDeltaY,t=navigator.userAgent.match("Firefox")?this.VerticalScrollBar.model.value+n.detail*40:this.VerticalScrollBar.model.value-u,t>=0&&t<=this.VerticalScrollBar.model.maximum?(this.VerticalScrollBar.scroll(t),n.preventDefault()):t>this.VerticalScrollBar.model.maximum?this.VerticalScrollBar.scroll(this.VerticalScrollBar.model.maximum):this.VerticalScrollBar.scroll(0))},n.prototype.IsLeftButtonPressed=function(n){if(n=n||window.event,"buttons"in n)return n.buttons==1;var t=n.which||n.button;return t==1},n.prototype.GetCurrentPoint=function(n,t){var i=new rt(0,0);return i.X=n-this.ViewerContatiner.offsetLeft,i.Y=t-this.ViewerContatiner.offsetTop,i},n.prototype.UpdateCursorPosition=function(n){var i=this.GetLineWidget(n),s=null,e,o,r,l,a;i!=null&&i.CurrentParagraphWidget!=null&&i.CurrentParagraphWidget.ContainerWidget instanceof ni&&(s=i.CurrentParagraphWidget.ContainerWidget);var f=0,h=null,y=null;if(this.OwnerControl.Selection.SelectionRanges.Count>0)for(e=0;e<this.OwnerControl.Selection.SelectionRanges.Count;e++){var t=this.OwnerControl.Selection.SelectionRanges.Get(e),c=t.IsForward?t.Start:t.End,p=t.IsForward?t.End:t.Start,v=c.Location,w=p.Location,u=t.SelectedWidgets.Keys;for(o=0;o<u.Count;o++){if(r=u[o],l=t.SelectedWidgets.Get(r),r instanceof gi&&r==i)return h=u[u.length-1],y=t.SelectedWidgets.Get(h),n.X<=this.CurrentPage.Viewer.ClientArea.X?u[0]==i?!c.IsAtParagraphStart:!1:u[0]==i?(f=v.X+l.Width,c.IsAtParagraphStart?!(f>n.X):!(f>n.X&&v.X<n.X)):h==i?(f=l.Width,!(w.X>n.X&&this.CurrentPage.Viewer.ClientArea.X<n.X)):!1;if(r instanceof ni&&s!=null&&s==r&&(a=r,a.X+a.Width>n.X))return!1}}return!0},n.prototype.OnZoomFactorChanged=function(){this.zoomFactor>5?this.zoomFactor=5:this.zoomFactor<.1&&(this.zoomFactor=.1);this.Zoom();this.OwnerControl.RaiseClientEvent(pi.ZoomFactorChange,null)},n.prototype.UpdateHFClientArea=function(n,t){var i=n.SectionFormat.PageWidth-n.SectionFormat.LeftMargin-n.SectionFormat.RightMargin;i<0&&(i=0);this.ClientArea=t?new v(n.SectionFormat.LeftMargin,n.SectionFormat.HeaderDistance,i,n.SectionFormat.PageHeight-n.SectionFormat.HeaderDistance):new v(n.SectionFormat.LeftMargin,n.SectionFormat.PageHeight-n.SectionFormat.FooterDistance,i,n.SectionFormat.PageHeight-n.SectionFormat.FooterDistance);this.ClientActiveArea=new v(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height)},n.prototype.UpdateClientArea=function(n){var i=n.TopMargin,r,t;this.CurrentRenderingPage.HeaderWidget!=null&&(i=Math.max(n.HeaderDistance+this.CurrentRenderingPage.HeaderWidget.Height,n.TopMargin));r=.667+n.BottomMargin;this.CurrentRenderingPage.FooterWidget!=null&&(r=.667+Math.max(n.FooterDistance+this.CurrentRenderingPage.FooterWidget.Height,n.BottomMargin));t=n.PageWidth-n.LeftMargin-n.RightMargin;t<0&&(t=0);this.ClientArea=new v(n.LeftMargin,i,t,n.PageHeight-i-r);this.ClientActiveArea=new v(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height)},n.prototype.UpdateClientAreaForBlock=function(n,t){var i,r,f,u;t?n instanceof w&&n.TableWidgets.length>0?(r=n.TableWidgets[0],this.ClientActiveArea.X=this.ClientArea.X=r.X,this.ClientActiveArea.Width=this.ClientArea.Width=r.Width,r=n.TableWidgets[n.TableWidgets.length-1],r.X=this.ClientActiveArea.X,r.Y=this.ClientActiveArea.Y,this.ClientArea=new v(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new v(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height)):(n instanceof w&&n.TableFormat.TableAlignment!=ou.Left?(f=n.GetTableWidth(),i=n.TableFormat.TableAlignment==ou.Center?(this.ClientArea.Width-f)/2:this.ClientArea.Width-f,this.tableLeft.push(i)):i=n.LeftIndent,this.ClientActiveArea.X=this.ClientArea.X=this.ClientArea.X+i,u=this.ClientArea.Width-(i+n.RightIndent),this.ClientActiveArea.Width=this.ClientArea.Width=u>0?u:0,this.ClientArea=new v(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new v(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height)):(i=n instanceof w&&n.TableFormat.TableAlignment!=ou.Left&&this.tableLeft.length>0?this.tableLeft.pop():n.LeftIndent,this.ClientActiveArea.X=this.ClientArea.X=this.ClientArea.X-i,u=this.ClientArea.Width+i+n.RightIndent,this.ClientActiveArea.Width=this.ClientArea.Width=u>0?u:0,this.ClientArea=new v(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new v(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height))},n.prototype.UpdateClientAreaForRow=function(n,t){var i=n.OwnerTable.TableWidgets[n.OwnerTable.TableWidgets.length-1];t||(this.ClientActiveArea.X=this.ClientArea.X=i.X,this.ClientActiveArea.Width=this.ClientArea.Width=i.Width,this.ClientArea=new v(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new v(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height))},n.prototype.UpdateClientAreaForCell=function(n,t){var r=n.OwnerRow.TableRowWidgets[n.OwnerRow.TableRowWidgets.length-1],i=n.TableCellWidgets[n.TableCellWidgets.length-1];t?(this.ClientActiveArea.X=this.ClientArea.X=i.X,this.ClientActiveArea.Y=i.Y,this.ClientActiveArea.Width=this.ClientArea.Width=i.Width>0?i.Width:0,this instanceof ft&&(this.ClientActiveArea.Height=Number.POSITIVE_INFINITY),this.ClientArea=new v(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new v(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height)):(this.ClientActiveArea.X=this.ClientArea.X=i.X+i.Width+i.Margin.Right,this.ClientActiveArea.Width=r.X+r.Width-this.ClientArea.X<0?this.ClientArea.Width=0:this.ClientArea.Width=r.X+r.Width-this.ClientArea.X,this.ClientActiveArea.Y=i.Y-i.Margin.Top-n.OwnerTable.TableFormat.CellSpacing,n.OwnerTable.IsInsideTable||(this.ClientActiveArea.Height=this.ClientArea.Bottom-r.Y>0?this.ClientArea.Bottom-r.Y:0),this.ClientArea=new v(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new v(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height))},n.prototype.UpdateClientWidth=function(n){this.ClientActiveArea.X-=n;this.ClientActiveArea.Width+n>0?this.ClientActiveArea.Width+=n:this.ClientActiveArea.Width=0},n.prototype.CutFromLeft=function(n){n<this.ClientActiveArea.Left&&(n=this.ClientActiveArea.Left);n>this.ClientActiveArea.Right&&(n=this.ClientActiveArea.Right);this.ClientActiveArea.Width=this.ClientActiveArea.Right>n?this.ClientActiveArea.Right-n:0;this.ClientActiveArea.X=n},n.prototype.CutFromTop=function(n){n<this.ClientActiveArea.Top&&(n=this.ClientActiveArea.Top);n>this.ClientActiveArea.Bottom&&(n=this.ClientActiveArea.Bottom);this.ClientActiveArea.Height=this.ClientActiveArea.Bottom-n;this.ClientActiveArea.X=this.ClientArea.X;this.ClientActiveArea.Width=this.ClientArea.Width;this.ClientActiveArea.Y=n},n.prototype.ClearContainer=function(){this.RemoveRenderedPages();this.Pages.Clear();this.VerticalScrollBar.scroll(0);this.HorizontalScrollBar.scroll(0)},n.prototype.InsertPage=function(n,t){var i,r;for(this.Pages.Remove(t),this.Pages.Insert(n,t),i=20,n>0&&(i+=this.Pages[n-1].BoundingRectangle.Bottom),r=n;r<this.Pages.Count;r++)t=this.Pages[r],t.BoundingRectangle=new v(t.BoundingRectangle.X,i,t.BoundingRectangle.Width,t.BoundingRectangle.Height),i=t.BoundingRectangle.Bottom+20},n.prototype.UpdateClientAreaTopOrLeft=function(n,t){t&&(this.ClientActiveArea.Y=this.ClientActiveArea.Y+n.TopBorderWidth,this.ClientActiveArea.X=this.ClientActiveArea.X+n.LeftBorderWidth)},n.prototype.UpdateTextPosition=function(n,t){var i=this.GetLineWidget(n);i!=null&&i.UpdateTextPosition(this.OwnerControl,n,t)},n.prototype.GetLineWidget=function(n){return this.GetLineWidgetInternal(n,!1)},n.prototype.GetLineWidgetInternal=function(n){var i=null,t,r;if(this.CurrentPage!=null)for(t=0;t<this.CurrentPage.BodyWidgets.length;t++)if(r=this.CurrentPage.BodyWidgets[t],i=r.GetLineWidget(n),i!=null)break;return i},n.prototype.ClearSelectionHighlight=function(){var i=this,t,r,n,u;if(i instanceof ft)for(t=0;t<i.VisiblePages.Count;t++)r=i.VisiblePages[t],n=document.getElementById(r.Id+"_selection"),n!=null&&(u=n.getContext("2d"),u.clearRect(0,0,n.width,n.height));this.OwnerControl.Selection.SelectionRanges.Count>0&&this.OwnerControl.Selection.SelectionRanges.ClearSelectionHighlight()},n.prototype.NavigateHyperlink=function(n){var i=this.GetLineWidget(n),t;i!=null&&(t=i.GetHyperlinkField(this.OwnerControl,n),t!=null&&(this.UpdateTextPosition(n,!0),this.OwnerControl.FireRequestNavigate(t)))},n.prototype.ScrollToPosition=function(n,t){var f=t.Paragraph.GetLineWidgetInternal(t.Offset,!0),p=f.GetTop(),e,l,v;this.isMousedown&&(e=t.Paragraph.GetLineWidgetInternal(t.Offset,!1),l=e.GetTop(),e!=f&&t.Location.Y>=l&&(f=e));var a=f.Height,o=f.CurrentParagraphWidget.GetPage(),i=0,u=0,r=this,s=0;r instanceof ft&&(s=parseFloat(r.PageContainer.style.width.replace("px","")),v=o.BoundingRectangle.Width,i=(this.VisibleBounds.Width-v*this.ZoomFactor)/2,i<30&&(i=30),u=o.BoundingRectangle.Top*this.ZoomFactor+(this.Pages.IndexOf(o)+1)*r.PageGap*(1-this.ZoomFactor));i+=t.Location.X*this.ZoomFactor;u+=t.Location.Y*this.ZoomFactor;var h=0,c=0,y=parseFloat(this.Container.style.height.replace("px",""));r instanceof ft&&(r.PageContainer.style.left.indexOf("px")>-1&&(c=-parseFloat(r.PageContainer.style.left.replace("px",""))),r.PageContainer.style.top.indexOf("px")>-1&&(h=-parseFloat(r.PageContainer.style.top.replace("px",""))));h>u?this.VerticalScrollBar.scroll(u-10):h+y<u+a&&this.VerticalScrollBar.scroll(u+a-y+10);this.UpdateCaretToPage(n,o);c>i?this.HorizontalScrollBar.scroll(i-10):c+this.VisibleBounds.Width<i&&(i>=s-this.VisibleBounds.Width?this.HorizontalScrollBar.scroll(s-this.VisibleBounds.Width):this.HorizontalScrollBar.scroll(i))},n.prototype.RemovePage=function(n){this.CurrentPage==n&&(this.CurrentPage=null);this.SelectionStartPage==n&&(this.SelectionStartPage=null);this.SelectionEndPage==n&&(this.SelectionEndPage=null);var t=this.Pages.IndexOf(n);this.Pages.Remove(n);this.RemoveRenderedPages();this.UpdateScrollBars()},n.prototype.UpdateCaretToPage=function(n,t){if(t!=null)if(this.SelectionEndPage=t,this.OwnerControl.Selection.IsEmpty)this.SelectionStartPage=t;else{var r=n.Paragraph.GetLineWidget(n.Offset),i=r.CurrentParagraphWidget.GetPage();i!=null&&(this.SelectionStartPage=i)}},n.prototype.CheckForCursorVisibility=function(){},n.prototype.ShowCaret=function(n){n?(this.touchStart.style.display="block",this.touchEnd.style.display="block"):(this.touchStart.style.display="none",this.touchEnd.style.display="none")},n.prototype.HideCaret=function(){this.touchStart.style.display="none";this.touchEnd.style.display="none"},n.prototype.UpdateCaretPosition=function(){},n.prototype.UpdateTouchMarkPosition=function(){var n=this.GetCaretBottom(this.OwnerControl.Selection.Start,!1);this.touchStart.style.left=Math.round(this.OwnerControl.Selection.Start.Location.X-6)+"px";this.touchStart.style.top=n+"px";n=this.GetCaretBottom(this.OwnerControl.Selection.End,!1);this.touchEnd.style.left=Math.round(this.OwnerControl.Selection.End.Location.X-6)+"px";this.touchEnd.style.top=n+"px"},n.prototype.GetCaretBottom=function(n,t){var i=n.Location.Y;if(n.Paragraph.IsEmpty()){var l=n.Paragraph,r=0,u=0,f=l.GetParagraphMarkSize(r,u);r=f.TopMargin;u=f.BottomMargin;i+=f.Height;i+=r;t||(i+=u)}else{var e=0,s=n.Paragraph.GetInline(n.Offset,e),h=s.inline;e=s.index;var r=0,c=!1,o=h.GetCaretHeight(e,h.CharacterFormat,!1,r,c);r=o.TopMargin;c=o.IsItalic;i+=o.Height;t&&(i-=n.Paragraph.ParagraphFormat.AfterSpacing)}return i},n}();i.LayoutViewer=yu;ft=function(t){function i(n){t.call(this,n);this.PageGap=20;this.PageLeft=30;this.GetCurrentPageHeaderFooter=function(n,t){var i;return i=t?st.OddHeader:st.OddFooter,n.SectionFormat.DifferentFirstPage&&(this.Pages.length==1||this.Pages[this.Pages.length-1].Section!=n)?i=t?st.FirstPageHeader:st.FirstPageFooter:n.SectionFormat.DifferentOddAndEvenPages&&this.Pages.length%2==0&&(i=t?st.EvenHeader:st.EvenFooter),n.GetCurrentHeaderFooter(i)};this.PageContainer=document.createElement("div");this.PageContainer.setAttribute("id",this.OwnerControl.ContainerId+"_pageContainer");this.PageContainer.style.position="relative";this.Container.appendChild(this.PageContainer);this.VisiblePages=new o}return n(i,t),i.prototype.FindFocusedPage=function(n){var t=new rt(n.X,n.Y),r;for(this.PageContainer.style.left.indexOf("px")>-1&&(t.X-=parseFloat(this.PageContainer.style.left.replace("px",""))),this.PageContainer.style.top.indexOf("px")>-1&&(t.Y-=parseFloat(this.PageContainer.style.top.replace("px",""))),r=0;r<this.Pages.length;r++){var i=this.Pages[r],u=(i.BoundingRectangle.Top-this.PageGap*(r+1))*this.ZoomFactor+this.PageGap*(r+1),e=i.BoundingRectangle.Height*this.ZoomFactor,f=i.BoundingRectangle.Left,o=i.BoundingRectangle.Right;if(u<=t.Y&&u+e>=t.Y)return this.CurrentPage=i,t.Y=(t.Y-u)/this.ZoomFactor,t.X=t.X>o?i.BoundingRectangle.Right:t.X<f?i.BoundingRectangle.Left:(t.X-f)/this.ZoomFactor,t}return t},i.prototype.UpdateCursor=function(n){var t=null,f=new rt(n.offsetX,n.offsetY),i=this.FindFocusedPage(f),r=this.GetLineWidget(i),u;r!=null&&(t=r.GetHyperlinkField(this.OwnerControl,i));u=this.ViewerContatiner;u.style.cursor=t!=null&&n.ctrlKey==!0?"pointer":"default"},i.prototype.CreateNewPage=function(n){var r=this.PageGap,t;this.Pages.length>0&&(r=this.Pages[this.Pages.length-1].BoundingRectangle.Bottom+this.PageGap);t=new pu;t.Viewer=this;t.Section=n;var u=n.SectionFormat.PageWidth,f=n.SectionFormat.PageHeight,i=(this.VisibleBounds.Width-u*this.ZoomFactor)/2;return i<this.PageLeft&&(i=this.PageLeft),t.BoundingRectangle=new v(i,r,u,f),this.Pages.push(t),this.LayoutHeaderFooter(n),this.UpdateClientArea(n.SectionFormat),t.BodyWidgets.push(n.AddBodyWidget(this.ClientActiveArea)),t.BodyWidgets[t.BodyWidgets.length-1].Page=t,t},i.prototype.LayoutHeaderFooter=function(n){this.CurrentHeaderFooter=this.GetCurrentPageHeaderFooter(n,!0);this.CurrentHeaderFooter.Blocks.length>0&&(this.UpdateHFClientArea(n,!0),this.CurrentRenderingPage.HeaderWidget=this.CurrentHeaderFooter.LayoutItems(this));this.CurrentHeaderFooter=this.GetCurrentPageHeaderFooter(n,!1);this.CurrentHeaderFooter.Blocks.length>0&&(this.UpdateHFClientArea(n,!1),this.CurrentRenderingPage.FooterWidget=this.CurrentHeaderFooter.LayoutItems(this));this.CurrentHeaderFooter=null},i.prototype.Zoom=function(){this.UpdateScrollBars()},i.prototype.UpdateScrollBars=function(){for(var r,s,h,c,o,u=0,n=0;n<this.Pages.length;n++)u=u+this.Pages[n].BoundingRectangle.Height;for(r=0,n=0;n<this.Pages.length;n++)r<this.Pages[n].BoundingRectangle.Width&&(r=this.Pages[n].BoundingRectangle.Width);var f=r*this.ZoomFactor+this.PageLeft*2,e=u*this.ZoomFactor+(this.Pages.length+1)*this.PageGap,t=this.VisibleBounds.Width,i=this.VisibleBounds.Height;for(e>i&&(t-=this.VerticalScrollBar.model.width),f>t&&(i-=this.HorizontalScrollBar.model.height),r=f>t?f:t,u=e>i?e:i,this.Container.style.width=t.toString()+"px",this.Container.style.height=i.toString()+"px",this.PageContainer.style.width=r.toString()+"px",this.PageContainer.style.height=u.toString()+"px",n=0;n<this.Pages.length;n++)s=(r-this.Pages[n].BoundingRectangle.Width*this.ZoomFactor)/2,this.Pages[n].BoundingRectangle=s>this.PageLeft?new v(s,this.Pages[n].BoundingRectangle.Top,this.Pages[n].BoundingRectangle.Width,this.Pages[n].BoundingRectangle.Height):new v(this.PageLeft,this.Pages[n].BoundingRectangle.Top,this.Pages[n].BoundingRectangle.Width,this.Pages[n].BoundingRectangle.Height);h=this.HorizontalScrollBar.element[0];f>t?(o=this.HorizontalScrollBar.model.value,h.style.display="block",this.HorizontalScrollBar.option("maximum",r-t),this.HorizontalScrollBar.option("viewportsize",t),this.HorizontalScrollBar.option("width",t),this.HorizontalScrollBar._scrollData.handleSpace=t-2*this.HorizontalScrollBar.model.buttonSize,this.HorizontalScrollBar._scrollData.handle=Math.floor((t-18)/r*this.HorizontalScrollBar._scrollData.handleSpace),this.HorizontalScrollBar._scrollData.handle<15&&(this.HorizontalScrollBar._scrollData.handle=15),this.HorizontalScrollBar._scrollData.scrollable=this.HorizontalScrollBar.model.maximum,this.HorizontalScrollBar._scrollData.onePx=this.HorizontalScrollBar._scrollData.scrollable/(this.HorizontalScrollBar._scrollData.handleSpace-this.HorizontalScrollBar._scrollData.handle),this.HorizontalScrollBar["e-hhandle"].width(this.HorizontalScrollBar._scrollData.handle),this.HorizontalScrollBar.scroll(o)):(h.style.display="none",this.HorizontalScrollBar.scroll(0));c=this.VerticalScrollBar.element[0];e>i?(o=this.VerticalScrollBar.model.value,c.style.display="block",this.VerticalScrollBar.option("maximum",u-i),this.VerticalScrollBar.option("viewportsize",i),this.VerticalScrollBar.option("height",i),this.VerticalScrollBar._scrollData.handleSpace=i-2*this.VerticalScrollBar.model.buttonSize,this.VerticalScrollBar._scrollData.handle=Math.floor((i-18)/u*this.VerticalScrollBar._scrollData.handleSpace),this.VerticalScrollBar._scrollData.handle<15&&(this.VerticalScrollBar._scrollData.handle=15),this.VerticalScrollBar._scrollData.scrollable=this.VerticalScrollBar.model.maximum,this.VerticalScrollBar._scrollData.onePx=this.VerticalScrollBar._scrollData.scrollable/(this.VerticalScrollBar._scrollData.handleSpace-this.VerticalScrollBar._scrollData.handle),this.VerticalScrollBar["e-vhandle"].height(this.VerticalScrollBar._scrollData.handle),this.VerticalScrollBar.scroll(o)):(c.style.display="none",this.VerticalScrollBar.scroll(0))},i.prototype.VerticalScrollBar_ValueChanged=function(n){var t=n.scrollTop,i=parseFloat(this.Container.style.height),r=parseFloat(this.PageContainer.style.height);t>r-i&&(t=r-i);this.PageContainer.style.top=(-t).toString()+"px";this.UpdateVisiblePages(!0)},i.prototype.HorizontalScrollBar_ValueChanged=function(n){var t=n.scrollLeft,i=parseFloat(this.Container.style.width),r=parseFloat(this.PageContainer.style.width);t>r-i&&(t=r-i);this.PageContainer.style.left=(-t).toString()+"px"},i.prototype.UpdateVisiblePages=function(){for(var n=0;n<this.PageContainer.childNodes.length;n++)this.PageContainer.removeChild(this.PageContainer.childNodes[n]),n--;this.ClearVisiblePages();var e=this.PageGap,u=this.VisibleBounds.Height,t=-parseFloat(this.PageContainer.style.top),o=!0;for(n=0;n<this.Pages.length;n++){var r=this.Pages[n],i=(r.BoundingRectangle.Top-this.PageGap*(n+1))*this.ZoomFactor+this.PageGap*(n+1),f=r.BoundingRectangle.Height*this.ZoomFactor,s=r.BoundingRectangle.Left;(i>=t&&i<=t+u||i<=t&&i+f>=t+u||i+f>=t&&i+f<=t+u)&&(this.AddVisiblePage(r,s,e,!1),o=!1);e+=this.PageGap+r.BoundingRectangle.Height*this.ZoomFactor}},i.prototype.AddVisiblePage=function(n,t,i){var e=n.BoundingRectangle.Height*this.ZoomFactor,o=n.BoundingRectangle.Width*this.ZoomFactor,r,u,f;n.Id=this.OwnerControl.ContainerId+"_page_"+Math.random().toString();r=document.createElement("canvas");r.style.position="absolute";r.style.top=i.toString()+"px";r.style.left=t.toString()+"px";r.style.borderWidth="1px";r.style.borderColor="#D9DCDD";r.style.borderStyle="solid";r.style.backgroundColor=this.OwnerControl.Document.BackgroundColor;r.height=e;r.width=o;r.style.zIndex="0";r.id=n.Id+"_background";this.PageContainer.appendChild(r);u=document.createElement("canvas");u.style.position="absolute";u.style.top=i.toString()+"px";u.style.left=t.toString()+"px";u.style.borderWidth="0px";u.height=e;u.width=o;u.style.zIndex="1";u.id=n.Id+"_foreground";this.PageContainer.appendChild(u);f=document.createElement("canvas");f.style.position="absolute";f.style.top=i.toString()+"px";f.style.left=t.toString()+"px";f.style.borderWidth="0px";f.height=e;f.width=o;f.style.zIndex="2";f.id=n.Id+"_selection";this.PageContainer.appendChild(f);this.VisiblePages.Add(n);n.RenderWidgets()},i.prototype.ClearVisiblePages=function(){for(var i,t,n=0;n<this.VisiblePages.length;n++)i=this.VisiblePages[n],t=document.getElementById(i.Id),t!=null&&t.parentElement.removeChild(t),this.VisiblePages.RemoveAt(n),i.RemoveWidgets(this)},i.prototype.Print=function(){for(var r,i,n,e,u=0,t=0;t<this.Pages.length;t++)u=u+this.Pages[t].BoundingRectangle.Height;for(r=0,t=0;t<this.Pages.length;t++)r<this.Pages[t].BoundingRectangle.Width&&(r=this.Pages[t].BoundingRectangle.Width);for(i=navigator.userAgent,n=document.createElement("iframe"),n.style.position="absolute",document.body.appendChild(n),n.contentDocument.open(),i.indexOf("Chrome")!=-1||i.indexOf("Safari")!=-1||i.indexOf("Firefox")!=-1?(e=r<u?"portrait":"landscape",n.contentDocument.write("<!DOCTYPE html>"),n.contentDocument.write("<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100%; } img { height: 100%; width: 100%; display: block;}@media print{ body { margin: 0cm;}img { box-sizing: border-box; }br, button { display: none; }} @page{margin:0cm; size:"+e+";} <\/style><\/head><body><center>")):n.contentDocument.write("<html><head><style>@page{margin:0;size:"+r.toString()+"px "+u.toString()+"px;}<\/style><\/head><body><center>"),t=0;t<this.Pages.length;t++){var f=this.Pages[t],o=f.BoundingRectangle.Height,s=f.BoundingRectangle.Width,h=f.RenderCanvas().toDataURL();i.indexOf("Chrome")!=-1||i.indexOf("Safari")!=-1||i.indexOf("Firefox")!=-1?n.contentDocument.write('<div><img src="'+h+'" style="margin:0px;display:block;width:'+s.toString()+"px;height:"+o.toString()+'px; "/><\/div><br/>'):n.contentDocument.write('<img src="'+h+'" style="width:'+s.toString()+"px;height:"+o.toString()+';margin:0px;"/><br />')}n.contentDocument.write("<\/center><\/body><\/html>");n.contentDocument.write("<\/body><\/html>");navigator.userAgent.match("Firefox")?n.contentWindow.close():n.contentDocument.close();i.indexOf("Chrome")!=-1||i.indexOf("Safari")!=-1||i.indexOf("Firefox")!=-1?(n.contentWindow.focus(),n.contentWindow.print(),document.body.removeChild(n)):n.contentWindow.document.execCommand("print",!1,null)},i.prototype.RenderVisiblePages=function(){for(var t,n=0;n<this.Pages.length;n++)t=this.Pages[n],t.RemoveWidgets(this),t.RenderWidgets()},i.prototype.RemoveRenderedPages=function(){for(var t,i,n=0;n<this.Pages.length;n++)t=this.Pages[n],i=document.getElementById(t.Id),i!=null&&i.remove(),t.RemoveWidgets(this)},i.prototype.SetPageCount=function(){this.OwnerControl.PageCount=this.Pages.Count>0?this.Pages.Count:1},i}(yu);i.PageLayoutViewer=ft;pu=function(){function n(){this.RepeatHeaderRowTableWidget=!1;this.HeaderWidget=null;this.FooterWidget=null;this.BodyWidgets=new o}return n.prototype.RenderWidgets=function(){var t=document.getElementById(this.Id+"_background").getContext("2d"),i=document.getElementById(this.Id+"_selection").getContext("2d"),r=document.getElementById(this.Id+"_foreground").getContext("2d"),n;for(this.SetZoomTransform(t,r,i,this),this.HeaderWidget!=null&&this.HeaderWidget._render(this),this.FooterWidget!=null&&this.FooterWidget._render(this),n=0;n<this.BodyWidgets.length;n++)this.BodyWidgets[n]._render(this)},n.prototype.RemoveWidgets=function(n){if(this.HeaderWidget!=null&&this.HeaderWidget.RemoveWidget(n),this.FooterWidget!=null&&this.FooterWidget.RemoveWidget(n),this.BodyWidgets!=null)for(var t=0;t<this.BodyWidgets.Count;t++)this.BodyWidgets[t].RemoveWidget(n)},n.prototype.RenderCanvas=function(){var n=document.createElement("canvas"),t;for(n.style.position="absolute",n.style.borderStyle="solid",n.style.borderWidth="1px",n.setAttribute("width",this.BoundingRectangle.Width.toString()),n.setAttribute("height",this.BoundingRectangle.Height.toString()),this.HeaderWidget!=null&&this.HeaderWidget._renderCanvas(n),this.FooterWidget!=null&&this.FooterWidget._renderCanvas(n),t=0;t<this.BodyWidgets.length;t++)this.BodyWidgets[t]._renderCanvas(n);return n},n.prototype.SetZoomTransform=function(n,t,i,r){n.setTransform(r.Viewer.ZoomFactor,0,0,r.Viewer.ZoomFactor,1,1);t.setTransform(r.Viewer.ZoomFactor,0,0,r.Viewer.ZoomFactor,1,1);i.setTransform(r.Viewer.ZoomFactor,0,0,r.Viewer.ZoomFactor,1,1)},n.prototype.ClearTransform=function(n,t,i){n.setTransform(1,0,0,1,0,0);t.setTransform(1,0,0,1,0,0);i.setTransform(1,0,0,1,0,0)},n.prototype.Dispose=function(){this.HeaderWidget=null;this.FooterWidget=null;this.Section=null;this.RemoveWidgets(this.Viewer);this.BodyWidgets!=null&&(this.BodyWidgets.Clear(),this.BodyWidgets=null);this.Viewer!=null&&(this.Viewer.Pages!=null&&this.Viewer.RemovePage(this),this.Viewer=null)},n}();i.Page=pu;si=function(){function n(){this.X=0;this.Y=0;this.Width=0;this.Height=0;this.ChildWidgets=new o}return n.prototype.UpdateClientAreaLocation=function(n){this.X=n.X;this.Y=n.Y;this.Width=n.Width},n.prototype.UpdateWidgetLocation=function(n){this.X=n.X;this.Y=n.Y;this.Width=n.Width},n.prototype.GetPage=function(){var n=null,t;return this.ContainerWidget instanceof ti?(t=this.ContainerWidget,n=this.ContainerWidget.Page):this.ContainerWidget!=null&&(n=this.ContainerWidget.GetPage()),n},n.prototype.RenderSingleBorder=function(n,t,i,r,u,f,e){n.beginPath();n.moveTo(i,r);n.lineTo(u,f);n.lineWidth=e;n.strokeStyle=t.Color?t.Color:"#000000";e>0&&n.stroke();n.closePath()},n.prototype.ClearChildSelectionHighlight=function(t){for(var i=0;i<this.ChildWidgets.Count;i++)this.ChildWidgets[i]instanceof gi?this.ChildWidgets[i].ClearSelectionHighlight(t):this.ChildWidgets[i]instanceof ni?this.ChildWidgets[i].ClearSelectionHighlight(t):this.ChildWidgets[i]instanceof n&&this.ChildWidgets[i].ClearChildSelectionHighlight(t)},n}();i.Widget=si;ti=function(t){function i(n){t.call(this);this.CurrentNode=n}return n(i,t),i.prototype._getHTML=function(){for(var r,t="",n=0,i=this.ChildWidgets;n<i.length;n++)r=i[n],t+=r._getHTML();return t},i.prototype._render=function(n){var i=document.getElementById(n.Id+"_foreground"),r,t,u;if(i!=null)for(r=i.getContext("2d"),r.globalAlpha=1,t=0;t<this.ChildWidgets.length;t++)u=this.ChildWidgets[t],u._render(n)},i.prototype._renderCanvas=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._renderCanvas(n)},i.prototype.ShiftChildLocation=function(n){this.Y+=n;for(var t=0;t<this.ChildWidgets.length;t++)this.ChildWidgets[t]instanceof wt?(this.ChildWidgets[t].X=this.ChildWidgets[t].X,this.ChildWidgets[t].Y=this.ChildWidgets[t].Y+n):this.ChildWidgets[t].ShiftChildLocation(n)},i.prototype.GetLineWidget=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)if(this.ChildWidgets[t].Y<=n.Y&&this.ChildWidgets[t].Y+this.ChildWidgets[t].Height>=n.Y)return this.ChildWidgets[t].GetLineWidget(n);return i=null,this.ChildWidgets.length>0&&(i=this.ChildWidgets[0].Y<=n.Y?this.ChildWidgets[this.ChildWidgets.length-1].GetLineWidget(n):this.ChildWidgets[0].GetLineWidget(n)),i},i.prototype.RemoveWidget=function(n){if(n!=null)for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].RemoveWidget(n)},i.prototype.Dispose=function(){var i=this.Height,t,n;if(this.ChildWidgets!=null){for(t=0;t<this.ChildWidgets.Count;t++){if(n=this.ChildWidgets[t],n instanceof wt?n.Dispose():n instanceof di?n.Dispose():n.Dispose(),this.ChildWidgets==null)break;this.ChildWidgets.Remove(n);t--}this.ChildWidgets=null}this.ContainerWidget!=null&&(this.ContainerWidget.ChildWidgets!=null&&(this.ContainerWidget.ChildWidgets.Remove(this),this.ContainerWidget.Height-=i),this.ContainerWidget=null);this instanceof ru&&this.CurrentNode!=null?(this.CurrentNode.LayoutedWidgets!=null&&this.CurrentNode.LayoutedWidgets.Remove(this),this.CurrentNode=null):gt instanceof at&&(this.CurrentNode.BodyWidgets!=null&&this.CurrentNode.BodyWidgets.Remove(this),this.CurrentNode=null);this.Page!=null&&(this.Page.BodyWidgets!=null&&this.Page.BodyWidgets.Contains(this)?(this.Page.BodyWidgets.Remove(this),this.Page.BodyWidgets.Count==0&&this.Page.Dispose()):this.Page.HeaderWidget==this?this.Page.HeaderWidget=null:this.Page.FooterWidget==this&&(this.Page.FooterWidget=null),this.Page=null)},i}(si);i.BodyWidget=ti;ru=function(t){function i(n){t.call(this,n)}return n(i,t),i.prototype._getHTML=function(){for(var r,t="",n=0,i=this.ChildWidgets;n<i.length;n++)r=i[n],t+=r._getHTML();return t},i.prototype._render=function(n){var i=document.getElementById(n.Id+"_foreground"),r,t,u;if(i!=null)for(r=i.getContext("2d"),r.globalAlpha=.75,t=0;t<this.ChildWidgets.length;t++)u=this.ChildWidgets[t],u._render(n)},i.prototype._renderCanvas=function(n){var i,t,r;if(n!=null)for(i=n.getContext("2d"),i.globalAlpha=.75,t=0;t<this.ChildWidgets.length;t++)r=this.ChildWidgets[t],r._renderCanvas(n)},i.prototype.GetLineWidget=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)if(this.ChildWidgets[t].Y<=n.Y&&this.ChildWidgets[t].Y+this.ChildWidgets[t].Height>=n.Y)return this.ChildWidgets[t].GetLineWidget(n);return i=null,this.ChildWidgets.length>0&&(i=this.ChildWidgets[0].Y<=n.Y?this.ChildWidgets[this.ChildWidgets.length-1].GetLineWidget(n):this.ChildWidgets[0].GetLineWidget(n)),i},i}(ti);i.HeaderFooterWidget=ru;ii=function(t){function i(n){t.call(this);this.leftMargin=0;this.topMargin=0;this.rightMargin=0;this.bottomMargin=0;this.CurrentNode=n;this.Table=n;this.Margin=new ei(this.leftMargin,this.topMargin,this.rightMargin,this.bottomMargin);this.LeftBorderWidth=0;this.RightBorderWidth=0;this.TopBorderWidth=0;this.BottomBorderWidth=0}return n(i,t),i.prototype._getHTML=function(){for(var r,t="",n=0,i=this.ChildWidgets;n<i.length;n++)r=i[n],t+=r._getHTML();return t},i.prototype._render=function(n){var u=document.getElementById(n.Id+"_background"),i,t,r;for(this.CurrentNode.TableFormat.CellSpacing>0&&(i=u.getContext("2d"),this.RenderTableOutline(i)),t=0;t<this.ChildWidgets.length;t++)r=this.ChildWidgets[t],r._render(n)},i.prototype._renderCanvas=function(n){var i,t,r;for(this.CurrentNode.TableFormat.CellSpacing>0&&(i=n.getContext("2d"),this.RenderTableOutline(i)),t=0;t<this.ChildWidgets.length;t++)r=this.ChildWidgets[t],r._renderCanvas(n)},i.prototype.UpdateHeight=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i.UpdateHeight(n,!0)},i.prototype.ShiftChildLocation=function(n){this.Y=this.Y+n;for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].ShiftChildLocation(n)},i.prototype.GetSplittedWidget=function(n){for(var u,e,r,o=this.Y,t=null,f=0;f<this.ChildWidgets.length;f++){if(u=this.ChildWidgets[f],e=u.Height,(n<o+e||t!=null)&&(r=t==null&&u.IsFirstLineFit(n)?u.GetSplittedWidget(n):u,r!=null)){if(f==0&&r==u)return this;this.ChildWidgets.Contains(r)?(this.ChildWidgets.RemoveAt(this.ChildWidgets.indexOf(r)),f--,this.Height-=r.Height):this.Height-=e-u.Height;t==null?(t=new i(this.Table),t.UpdateWidgetLocation(this),this.Table.TableWidgets.push(t),t.Height=r.Height):t.Height+=r.Height;t.ChildWidgets.push(r);r.ContainerWidget=t}o+=u.Height}return t},i.prototype.IsFirstLineFit=function(n){return this.ChildWidgets[0].IsFirstLineFit(n)},i.prototype.UpdateChildLocation=function(n){for(var t,i=0;i<this.ChildWidgets.length;i++)t=this.ChildWidgets[i],t.X=t.X,t.Y=n,t.UpdateChildLocation(n),n+=t.Height},i.prototype.GetLineWidget=function(n){for(var t,r,f,l,e,i=null,u=0;u<this.ChildWidgets.Count;u++)if(this.ChildWidgets[u].Y<=n.Y){i=this.ChildWidgets[u].GetLineWidget(n);t=null;i!=null&&(t=i.CurrentParagraphWidget.ContainerWidget);r=0;f=0;t!=null&&(r=t.TableCell.OwnerTable.TableFormat.CellSpacing,f=t.TableCell.CellFormat.RowSpan);var o=0,s=0,h=0,c=0;if(r>0&&(o=t.TableCell.CellIndex==0?r:r/2,s=t.TableCell.CellIndex==t.TableCell.OwnerRow.Cells.Count-1?r:r/2,l=t.ContainerWidget,e=t.ContainerWidget.ContainerWidget,l!=null&&e!=null&&e.Table.TableWidgets.Count>0&&(h=t.TableCell.OwnerRow.RowIndex==0?r:r/2,c=t.TableCell.OwnerRow.RowIndex+f==t.TableCell.OwnerTable.Rows.Count?r:r/2)),i!=null&&i.CurrentParagraphWidget.X<=n.X&&i.CurrentParagraphWidget.X+i.Width>=n.X&&i.CurrentParagraphWidget.Y<=n.Y&&i.GetTop()+i.Height>=n.Y||t!=null&&t.X-t.Margin.Left-o<=n.X&&t.X+t.Width+t.Margin.Right+s>=n.X&&t.Y-t.Margin.Top-h<=n.Y&&t.Y+t.Height+t.Margin.Bottom+c>=n.Y)break}return i},i.prototype.RenderTableOutline=function(n){var r=this.CurrentNode,i=r.TableFormat.Borders.GetTableTopBorder(),t=0;i!=null&&(t=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-this.Margin.Left-t/2,this.Y,this.X-this.Margin.Left-t/2,this.Y+this.Height,t));i=r.TableFormat.Borders.GetTableTopBorder();t=0;i!=null&&(t=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-this.Margin.Left-t,this.Y-t/2,this.X+this.Width+t+this.Margin.Right,this.Y-t/2,t));i=r.TableFormat.Borders.GetTableRightBorder();t=0;i!=null&&(t=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X+this.Width+this.Margin.Right+t/2,this.Y,this.X+this.Width+this.Margin.Right+t/2,this.Y+this.Height,t));i=r.TableFormat.Borders.GetTableBottomBorder();t=0;i!=null&&(t=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-this.Margin.Left-t,this.Y+this.Height-t/2,this.X+this.Width+t+this.Margin.Right,this.Y+this.Height-t/2,t))},i.prototype.RemoveWidget=function(n){for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].RemoveWidget(n)},i.prototype.Dispose=function(){var i=this.Height,n,t;if(this.ChildWidgets!=null){for(n=0;n<this.ChildWidgets.Count;n++){if(t=this.ChildWidgets[n],t.Dispose(),this.ChildWidgets==null)break;this.ChildWidgets.Remove(t);n--}this.ChildWidgets=null}this.Table!=null&&(this.Table.TableWidgets!=null&&this.Table.TableWidgets.Remove(this),this.Table=null);this.ContainerWidget!=null&&(this.ContainerWidget.ChildWidgets!=null&&(this.ContainerWidget.ChildWidgets.Remove(this),this.ContainerWidget.Height-=i,(this.ContainerWidget.ChildWidgets==null||this.ContainerWidget.ChildWidgets.Count==0)&&this.ContainerWidget instanceof ti&&this.ContainerWidget.Dispose()),this.ContainerWidget=null)},i}(si);i.TableWidget=ii;di=function(t){function i(n){t.call(this);this.CurrentNode=n;this.TableRow=n;this.TopBorderWidth=0;this.BottomBorderWidth=0}return n(i,t),i.prototype._getHTML=function(){for(var r,t="",n=0,i=this.ChildWidgets;n<i.length;n++)r=i[n],t+=r._getHTML();return t},i.prototype._render=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._render(n)},i.prototype._renderCanvas=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._renderCanvas(n)},i.prototype.splitSpannedCellWidget=function(n,t){var i=n.GetSplittedWidget(t.ClientArea.Bottom,!1);i!=null&&t.SplittedCellWidgets.push(i)},i.prototype.UpdateHeight=function(n,t){for(var c,e,r,o,u,l,s=0;s<this.ChildWidgets.length;s++){var f=0,i=this.ChildWidgets[s],h=1;for(h=i.TableCell.CellFormat.RowSpan,f=i.TableCell.OwnerTable.TableFormat.CellSpacing,h>1?(c=this.ContainerWidget.ChildWidgets.indexOf(this),e=c+h-1-(this.TableRow.RowIndex-i.TableCell.OwnerRow.RowIndex),(n.ClientArea.Bottom<i.Y+i.Height+i.Margin.Bottom||e>=c+1)&&this.splitSpannedCellWidget(i,n),r=this,e>0&&(r=e<this.ContainerWidget.ChildWidgets.length?this.ContainerWidget.ChildWidgets[e]:this.ContainerWidget.ChildWidgets[this.ContainerWidget.ChildWidgets.length-1]),i.Y+i.Height+i.Margin.Bottom<r.Y+r.Height?i.Height=r.Y+r.Height-i.Y-i.Margin.Bottom:this.ContainerWidget.ContainerWidget!=null&&i.Y+i.Height+i.Margin.Bottom>r.Y+r.Height&&(r.Height=i.Y+i.Height+i.Margin.Bottom-r.Y,this==r&&this.TableRow.NextNode instanceof ui&&(o=this.TableRow.NextNode,o.TableRowWidgets.length>0&&(o.TableRowWidgets[0].X=o.TableRowWidgets[0].X,o.TableRowWidgets[0].Y=this.Y+this.Height)))):(f>0&&this.TableRow.OwnerTable.TableWidgets.Count>1&&this.Y==this.TableRow.OwnerTable.Document.OwnerControl.Viewer.ClientArea.Y&&n instanceof ft&&(f=f/2),i.Height=this.Height-i.Margin.Top-i.Margin.Bottom-f),i.UpdateHeight(n),u=this.ContainerWidget;u.ContainerWidget instanceof si;)u=u.ContainerWidget;l=null;u instanceof ti&&(l=u.Page);(n instanceof ft&&n.VisiblePages.Contains(l)||t)&&i.UpdateCellVerticalPosition(!1,!1)}},i.prototype.GetSplittedWidget=function(n){for(var u,t,e,r=null,o=this.TableRow.RowIndex,f=0;f<this.ChildWidgets.length;f++)if(u=this.ChildWidgets[f],t=u.GetSplittedWidget(n,!0),t!=null){if(t==u)return this;this.ChildWidgets.Contains(t)&&this.ChildWidgets.Remove(t);(f==0||this.Height<u.Height+u.Margin.Top+u.Margin.Bottom)&&(this.Height=u.Height+u.Margin.Top+u.Margin.Bottom);r==null&&(r=new i(this.TableRow),r.UpdateWidgetLocation(this),this.TableRow.TableRowWidgets.push(r),r.Height=0);e=1;e=t.TableCell.CellFormat.RowSpan;o-t.TableCell.OwnerRow.RowIndex==e-1&&r.Height<t.Height+t.Margin.Top+t.Margin.Bottom&&(r.Height=t.Height+t.Margin.Top+t.Margin.Bottom);r.ChildWidgets.Add(t);t.ContainerWidget=r}return r},i.prototype.IsFirstLineFit=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)if(i=this.ChildWidgets[t],!i.IsFirstLineFit(n))return!1;return!0},i.prototype.InsertSplittedCellWidgets=function(n){for(var t=this.X,o=0,u,r,f,e,o=this.TableRow.OwnerTable.TableWidth,i=0;i<this.ChildWidgets.length;i++){if(u=this.ChildWidgets[i],Math.round(t)<Math.round(u.X-u.Margin.Left)){if(this.InsertRowSpannedWidget(n,t,i)){i--;continue}if(e=this.ChildWidgets.length,this.InsertEmptySplittedCellWidget(t,i),e<this.ChildWidgets.length){i--;continue}}if(t+=u.Margin.Left+u.Width+u.Margin.Right,i==this.ChildWidgets.length-1&&Math.round(t)<Math.round(this.X+o)){if(this.InsertRowSpannedWidget(n,t,i+1))continue;this.InsertEmptySplittedCellWidget(t,i+1);continue}if((this.ChildWidgets==null||this.ChildWidgets.Count==0)&&n.SplittedCellWidgets.Count>0)for(r=0;r<n.SplittedCellWidgets.Count;r++){if(f=n.SplittedCellWidgets[r],Math.round(t)<=Math.round(f.X-f.Margin.Left)){if(this.InsertRowSpannedWidget(n,t,r)){r--;continue}if(e=this.ChildWidgets.Count,this.InsertEmptySplittedCellWidget(t,r),e<this.ChildWidgets.Count){r--;continue}}if(t+=f.Margin.Left+f.Width+f.Margin.Right,r==this.ChildWidgets.Count-1&&Math.round(t)<Math.round(this.X+o)){if(this.InsertRowSpannedWidget(n,t,r+1))continue;this.InsertEmptySplittedCellWidget(t,r+1);continue}}n.SplittedCellWidgets.Count>0&&n.SplittedCellWidgets.Clear()}},i.prototype.InsertRowSpannedWidget=function(n,t,i){for(var r,u=0;u<n.SplittedCellWidgets.length;u++)if(r=n.SplittedCellWidgets[u],Math.round(t)==Math.round(r.X-r.Margin.Left))return this.ChildWidgets.Insert(i,r),r.ContainerWidget=this,n.SplittedCellWidgets.Remove(r),!0;return!1},i.prototype.InsertEmptySplittedCellWidget=function(n,t){for(var r,e,u,o,i,s,h=this.TableRow.OwnerTable.TableWidgets[this.TableRow.OwnerTable.TableWidgets.length-1],f=h.ChildWidgets.length-1;f>=0;f--)for(r=h.ChildWidgets[f],e=r.X,u=0;u<r.ChildWidgets.length;u++){if(o=1,i=r.ChildWidgets[u],Math.round(n)==Math.round(e)){o=i.TableCell.CellFormat.RowSpan;o>1&&(s=i.CreateCellWidget(),this.ChildWidgets.Insert(t,s),s.ContainerWidget=this);return}e+=i.Margin.Left+i.Width+i.Margin.Right}},i.prototype.UpdateChildLocation=function(n){var r=0,i,t;for(this.TableRow.OwnerTable.TableFormat.CellSpacing>0&&(r=this.TableRow.OwnerTable.TableFormat.CellSpacing),i=0;i<this.ChildWidgets.length;i++)t=this.ChildWidgets[i],t.X=t.X,t.Y=n+t.Margin.Top+r,t.UpdateChildLocation(t.Y)},i.prototype.ShiftChildLocation=function(n){this.Y=this.Y+n;for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].ShiftChildLocation(n)},i.prototype.GetLineWidget=function(n){for(var i,r,u,f,t=0;t<this.ChildWidgets.length;t++)if(i=0,i=this.TableRow.OwnerTable.TableFormat.CellSpacing,r=0,u=0,i>0&&(r=this.ChildWidgets[t].TableCell.ColumnIndex==0?i:i/2,u=this.ChildWidgets[t].TableCell.CellIndex==this.ChildWidgets[t].TableCell.OwnerRow.Cells.Count-1?i:i/2),this.ChildWidgets[t].X-this.ChildWidgets[t].Margin.Left-r<=n.X&&this.ChildWidgets[t].X+this.ChildWidgets[t].Width+this.ChildWidgets[t].Margin.Right+u>=n.X)return this.ChildWidgets[t].GetLineWidget(n);return f=null,this.ChildWidgets.length>0&&(f=this.ChildWidgets[0].X<=n.X?this.ChildWidgets[this.ChildWidgets.length-1].GetLineWidget(n):this.ChildWidgets[0].GetLineWidget(n)),f},i.prototype.RemoveWidget=function(n){for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].RemoveWidget(n)},i.prototype.Dispose=function(){var i=this.Height,n,t;if(this.ChildWidgets!=null){for(n=0;n<this.ChildWidgets.Count;n++){if(t=this.ChildWidgets[n],t.Dispose(),this.ChildWidgets==null)break;this.ChildWidgets.Remove(t);n--}this.ChildWidgets=null}this.TableRow!=null&&(this.TableRow.TableRowWidgets!=null&&this.TableRow.TableRowWidgets.Remove(this),this.TableRow=null);this.ContainerWidget!=null&&(this.ContainerWidget.ChildWidgets!=null&&(this.ContainerWidget.ChildWidgets.Remove(this),(this.ContainerWidget.ChildWidgets==null||this.ContainerWidget.ChildWidgets.Count==0)&&this.ContainerWidget instanceof ii?this.ContainerWidget.Dispose():this.ContainerWidget.ContainerWidget instanceof ti&&(this.ContainerWidget.ContainerWidget.Height-=i),this.ContainerWidget.Height-=i),this.ContainerWidget=null)},i}(si);i.TableRowWidget=di;ni=function(t){function i(n){t.call(this);this.leftMargin=0;this.topMargin=0;this.rightMargin=0;this.bottomMargin=0;this.TableCell=n;this.CurrentNode=n;this.Margin=new ei(this.leftMargin,this.topMargin,this.rightMargin,this.bottomMargin);this.LeftBorderWidth=0;this.RightBorderWidth=0}return n(i,t),i.prototype._getHTML=function(){for(var r,t="",n=0,i=this.ChildWidgets;n<i.length;n++)r=i[n],t+=r._getHTML();return t},i.prototype._render=function(n){var f=document.getElementById(n.Id+"_background"),e=f.getContext("2d"),i,r,t,u;for(this.RenderTableCellOutline(e),i=document.getElementById(n.Id+"_selection"),r=i.getContext("2d"),n.Viewer.OwnerControl.Selection.SelectionRanges.Count>0&&n.Viewer.OwnerControl.Selection.SelectionRanges.AddSelectionHighlightTable(r,this),t=0;t<this.ChildWidgets.length;t++)u=this.ChildWidgets[t],u._render(n)},i.prototype._renderCanvas=function(n){var r=n.getContext("2d"),t,i;for(this.RenderTableCellOutline(r),t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._renderCanvas(n)},i.prototype.ShiftChildLocation=function(n){this.Y=this.Y+n;for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t]instanceof wt?(this.ChildWidgets[t].X=this.ChildWidgets[t].X,this.ChildWidgets[t].Y=this.ChildWidgets[t].Y+n):this.ChildWidgets[t].ShiftChildLocation(n)},i.prototype.GetSplittedWidget=function(n,t){var i=null,r,o,u,e,s,f;if(this.Y+this.Height>n-this.Margin.Bottom)for(r=0;r<this.ChildWidgets.length;r++)if(this.ChildWidgets[r]instanceof wt){if(o=this.ChildWidgets[r],u=o.GetSplittedWidget(n-this.Margin.Bottom),u!=null){if(r==0&&u==o)return this;this.ChildWidgets.Contains(u)&&(this.ChildWidgets.Remove(u),r--);this.Height-=u.Height;i==null&&(i=this.CreateCellWidget());i.Height+=u.Height;i.ChildWidgets.Add(u);u.ContainerWidget=i}}else if(e=this.ChildWidgets[r],n-this.Margin.Bottom<e.Y+e.Height&&(s=e.Height,f=e.GetSplittedWidget(n-this.Margin.Bottom),f!=null)){if(r==0&&f==e)return this;this.ChildWidgets.Contains(f)?(this.ChildWidgets.Remove(f),r--,this.Height-=f.Height):this.Height-=s-e.Height;i==null&&(i=this.CreateCellWidget());i.Height+=f.Height;i.ChildWidgets.push(f);f.ContainerWidget=i}return i==null&&t&&(this.ChildWidgets.length==0&&(this.Height=0),i=this.CreateCellWidget()),i},i.prototype.CreateCellWidget=function(){var n=new i(this.TableCell);return n.UpdateWidgetLocation(this),this.TableCell.TableCellWidgets.push(n),n.Margin=this.Margin,n.LeftBorderWidth=this.LeftBorderWidth,n.RightBorderWidth=this.RightBorderWidth,n},i.prototype.IsFirstLineFit=function(n){var t,i;return this.ChildWidgets.length==0?!0:this.ChildWidgets[0]instanceof wt?(t=this.ChildWidgets[0],t.IsFirstLineFit(n-this.Margin.Bottom)):(i=this.ChildWidgets[0],i.IsFirstLineFit(n-this.Margin.Bottom))},i.prototype.UpdateHeight=function(n){for(var t=0;t<this.ChildWidgets.length;t++)this.ChildWidgets[t]instanceof ii&&this.ChildWidgets[t].UpdateHeight(n)},i.prototype.UpdateChildLocation=function(n){for(var t=0;t<this.ChildWidgets.length;t++)this.ChildWidgets[t].X=this.ChildWidgets[t].X,this.ChildWidgets[t].Y=n,this.ChildWidgets[t]instanceof ii&&this.ChildWidgets[t].UpdateChildLocation(n),n+=this.ChildWidgets[t].Height},i.prototype.GetLineWidget=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)if(this.ChildWidgets[t].Y<=n.Y&&this.ChildWidgets[t].Y+this.ChildWidgets[t].Height>=n.Y)return this.ChildWidgets[t].GetLineWidget(n);return i=null,this.ChildWidgets.length>0&&(i=this.ChildWidgets[0].Y<=n.Y?this.ChildWidgets[this.ChildWidgets.length-1].GetLineWidget(n):this.ChildWidgets[0].GetLineWidget(n)),i},i.prototype.UpdateCellVerticalPosition=function(n,t){if(this.TableCell.OwnerTable.Owner instanceof at||t){var i=this.GetDisplacement(n);this.UpdateCellContentVerticalPosition(i,n)}},i.prototype.GetDisplacement=function(n){var i=0,u=this.ContainerWidget,f=this.Margin.Top+this.Margin.Bottom,r,t;return i=this.TableCell.CellFormat.RowSpan>1?this.Height:u.Height-f,r=this.GetCellContentHeight(),t=0,i>r&&(t=i-r,this.TableCell.CellFormat.VerticalAlignment==su.Center?t=t/2:(this.TableCell.CellFormat.VerticalAlignment==su.Top||n)&&(t=0)),t},i.prototype.GetCellContentHeight=function(){for(var t=0,n=0;n<this.ChildWidgets.Count;n++)this.ChildWidgets[n]instanceof wt?t+=this.ChildWidgets[n].Height:this.ChildWidgets[n]instanceof ii&&(t+=this.ChildWidgets[n].Height);return t},i.prototype.UpdateCellContentVerticalPosition=function(n,t){var r,i;if(n!=0)for(r=this.Y+n,i=0;i<this.ChildWidgets.Count;i++)this.ChildWidgets[i]instanceof wt?this.ChildWidgets[i].Y=r:this.ChildWidgets[i]instanceof ii&&(r=this.UpdateTableWidgetLocation(this.ChildWidgets[i],r,t)),r=r+this.ChildWidgets[i].Height},i.prototype.UpdateTableWidgetLocation=function(n,t,i){var o,u,r,f,e;for(n.Y=t=t+n.TopBorderWidth,o=0,u=0;u<n.ChildWidgets.Count;u++){for(r=n.ChildWidgets[u],r.Y=t,f=0;f<r.ChildWidgets.Count;f++)e=r.ChildWidgets[f],e.Y=t,e.UpdateCellVerticalPosition(i,!0);t=t+r.Height}return t},i.prototype.RenderTableCellOutline=function(n){var f=null,t=this.TableCell,e=0,u=0,o=0,c=0,a=0,i,r,s,l,h;f=t.CellFormat.Borders;u=t.BottomMargin;e=t.TopMargin;o=t.LeftMargin;c=t.RightMargin;a=t.OwnerRow!=null&&t.OwnerRow.RowFormat.HeightType==ot.Exactly?t.OwnerRow.RowFormat.Height+e+u:t.OwnerRow!=null&&t.OwnerRow.TableRowWidgets.Count<=1?Math.max(t.OwnerRow.RowFormat.Height,this.Height)+e+u:this.Height+e+u;i=f.GetCellLeftBorder(t);r=0;i!=null&&(r=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-o-r/2,this.Y-e,this.X-o-r/2,this.Y+this.Height+u,r));i=f.GetCellTopBorder(t);i!=null&&(r=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-this.Margin.Left,this.Y-this.Margin.Top+r/2,this.X+this.Width+this.Margin.Right,this.Y-this.Margin.Top+r/2,r));(t.OwnerTable.TableFormat.CellSpacing>0||t.CellIndex==t.OwnerRow.Cells.Count-1)&&(i=f.GetCellRightBorder(t),i!=null&&(r=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X+this.Width+this.Margin.Right-r/2,this.Y-e,this.X+this.Width+this.Margin.Right-r/2,this.Y+this.Height+u,r)));s=t.OwnerRow.NextNode;l=!1;s!=null&&(h=null,s.TableRowWidgets!=null&&s.TableRowWidgets.Count>0&&(h=s.TableRowWidgets[0]),h instanceof di&&this.ContainerWidget instanceof di&&this.ContainerWidget instanceof ii&&(l=this.ContainerWidget.ChildWidgets.Contains(h)));(t.OwnerTable.TableFormat.CellSpacing>0||t.OwnerRow.RowIndex==t.OwnerTable.Rows.Count-1||t.CellFormat.RowSpan>1&&t.OwnerRow.RowIndex+t.CellFormat.RowSpan==t.OwnerTable.Rows.Count||!l)&&(i=t.CellFormat.RowSpan>1&&t.OwnerRow.RowIndex+t.CellFormat.RowSpan==t.OwnerTable.Rows.Count?f.GetBorderBasedOnPriority(t.CellFormat.Borders.Bottom,t.OwnerTable.TableFormat.Borders.GetCellBottomBorder(t)):f.GetCellBottomBorder(t),i!=null&&(r=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-this.Margin.Left,this.Y+this.Height+u+r/2,this.X+this.Width+this.Margin.Right,this.Y+this.Height+u+r/2,r)));i=f.GetCellDiagonalUpBorder(t);i!=null&&(r=i.GetLineWidth(),r>0&&this.RenderSingleBorder(n,i,this.X-o,this.Y+this.Height+u,this.X+this.Width+c,this.Y-e,r));i=f.GetCellDiagonalDownBorder(t);i!=null&&(r=i.GetLineWidth(),r>0&&this.RenderSingleBorder(n,i,this.X-o,this.Y-e,this.X+this.Width+c,this.Y+this.Height+u,r));this.RenderCellBackground(n,a)},i.prototype.RenderCellBackground=function(n,t){var r=this.CurrentNode.CellFormat,i=r.Shading.BackgroundColor;i&&(n.fillStyle=i,n.fillRect(this.X-this.Margin.Left+this.LeftBorderWidth,this.Y-this.TableCell.TopMargin,this.Width+this.Margin.Left+this.Margin.Right-this.LeftBorderWidth-this.RightBorderWidth,t),n.fill())},i.prototype.Highlight=function(n,t){this.ClearChildSelectionHighlight(n.OwnerControl.Viewer);n.CreateHighlightBorderInsideTable(this,n,t)},i.prototype.ClearSelectionHighlight=function(n){n!=null&&n.OwnerControl!=null&&n.OwnerControl.Selection.SelectionRanges.Count>0&&n.OwnerControl.Selection.SelectionRanges.ClearSelectionHighlightInternal(this)},i.prototype.RemoveWidget=function(n){n.OwnerControl!=null&&n.OwnerControl.Selection.SelectionRanges.Count>0&&n.OwnerControl.Selection.SelectionRanges.RemoveSelectionHighlight(this);for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].RemoveWidget(n)},i.prototype.Dispose=function(){var i=null,r=this.GetPage(),n,t;if(r!=null&&(i=r.Viewer),this.ChildWidgets!=null){for(n=0;n<this.ChildWidgets.Count;n++){if(t=this.ChildWidgets[n],t instanceof wt?t.Dispose():t.Dispose(),this.ChildWidgets==null)break;this.ChildWidgets.Remove(t);n--}this.ChildWidgets=null}this.ClearSelectionHighlight(i);this.ContainerWidget!=null&&(this.ContainerWidget.ChildWidgets!=null&&this.ContainerWidget.ChildWidgets.Remove(this),this.ContainerWidget=null);this.TableCell!=null&&(this.TableCell.TableCellWidgets!=null&&this.TableCell.TableCellWidgets.Remove(this),this.TableCell=null)},i}(si);i.TableCellWidget=ni;wt=function(t){function i(n){t.call(this);this.CurrentNode=n}return n(i,t),i.prototype._getHTML=function(){var n="<p ",t,i,r;for(n+='style="',n+="white-space:pre-wrap;line-height:100%;",n+="margin:0px;",n+='"',n+=">",t=0,i=this.ChildWidgets;t<i.length;t++)r=i[t],n+=r._getHTML();return n+"<\/p>"},i.prototype._render=function(n){for(var i,r=this.Y,u=this.X,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._render(n,u,r),r+=i.Height},i.prototype._renderCanvas=function(n){for(var i,r=this.Y,u=this.X,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._renderCanvas(n,u,r),r+=i.Height},i.prototype.IsFirstLineFit=function(n){var t=this.ChildWidgets[0],r,i;return t.CurrentParagraphWidget.ContainerWidget instanceof ni&&(r=t.CurrentParagraphWidget.ContainerWidget,i=null,t.CurrentParagraphWidget.CurrentNode!=null&&r.ContainerWidget!=null&&(i=t.CurrentParagraphWidget.CurrentNode.GetOwnerDocument()),i!=null&&i.OwnerControl!=null&&r.ContainerWidget.Y==i.OwnerControl.Viewer.ClientArea.Y&&this.Y+t.Height>=n)?!0:this.Y+t.Height<=n},i.prototype.GetSplittedWidget=function(n){for(var t,e,f=this.Y,r=null,u=0;u<this.ChildWidgets.length;u++){if(t=this.ChildWidgets[u],n<f+t.Height){if(u==0){if(t.CurrentParagraphWidget.ContainerWidget instanceof ni&&t.CurrentParagraphWidget.ContainerWidget.Y==this.Y){f+=t.Height;continue}r=this;break}this.ChildWidgets.Contains(t)&&(this.ChildWidgets.Remove(t),u--);this.Height-=t.Height;r==null?(r=new i(this.CurrentNode),r.UpdateWidgetLocation(this),e=this.CurrentNode,e.ParagraphWidgets.push(r),r.Height=t.Height):r.Height+=t.Height;r.ChildWidgets.push(t);t.CurrentParagraphWidget=r}f+=t.Height}return r},i.prototype.GetLineWidget=function(n){for(var r,i=this.Y,t=0;t<this.ChildWidgets.length;t++){if(i<=n.Y&&i+this.ChildWidgets[t].Height>=n.Y)return this.ChildWidgets[t];i+=this.ChildWidgets[t].Height}return r=null,this.ChildWidgets.length>0&&(r=this.Y<=n.Y?this.ChildWidgets[this.ChildWidgets.length-1]:this.ChildWidgets[0]),r},i.prototype.Highlight=function(n,t,i,r,u,f){for(var e,o,c,s=0,h=i;h<this.ChildWidgets.length;h++){if(e=this.ChildWidgets[h],h==i&&(s=e.GetTop()),o=e.GetLeft(),e==r){c=r.GetLeftInternal(u,f);n.CreateHighlightBorder(t,e,c-o,o,s);return}n.CreateHighlightBorder(t,e,e.GetWidth(!0)-(o-this.X),o,s);s+=e.Height}},i.prototype.RemoveWidget=function(n){for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].RemoveWidget(n)},i.prototype.Dispose=function(){var i=this.Height,n,t;if(this.ChildWidgets!=null){for(n=0;n<this.ChildWidgets.Count;n++){if(t=this.ChildWidgets[n],t.Dispose(),this.ChildWidgets==null)break;this.ChildWidgets.Remove(t);n--}this.ChildWidgets=null}this.CurrentNode!=null&&(this.CurrentNode.ParagraphWidgets!=null&&this.CurrentNode.ParagraphWidgets.Remove(this),this.CurrentNode=null);this.ContainerWidget!=null&&(this.ContainerWidget.ChildWidgets.Remove(this),this.ContainerWidget.Height-=i,(this.ContainerWidget.ChildWidgets==null||this.ContainerWidget.ChildWidgets.Count==0)&&this.ContainerWidget instanceof ti&&this.ContainerWidget.Dispose(),this.ContainerWidget=null)},i}(si);i.ParagraphWidget=wt;gi=function(){function n(n){this.X=0;this.Y=0;this.Width=0;this.Height=0;this.Children=null;this.CurrentParagraphWidget=n;this.Children=new o}return n.prototype._getHTML=function(){for(var r,t="",n=0,i=this.Children;n<i.length;n++)r=i[n],t+=r._getHTML();return t},n.prototype._IsParagraphFirstLine=function(){return this==this.CurrentParagraphWidget.ChildWidgets[0]?!0:!1},n.prototype._render=function(n,t,i){var f=document.getElementById(n.Id+"_background"),o=document.getElementById(n.Id+"_foreground"),s=document.getElementById(n.Id+"_selection"),r,u,e;if(f!=null){var h=f.getContext("2d"),c=o.getContext("2d"),l=s.getContext("2d");for(n.Viewer.OwnerControl.Selection.SelectionRanges.Count>0&&n.Viewer.OwnerControl.Selection.SelectionRanges.AddSelectionHighlight(l,this,i),this._IsParagraphFirstLine()&&(t+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),r=0;r<this.Children.Count;r++)u=this.Children[r],e=this.getUnderlineYposition(),u._render(c,h,t,i,e),t+=u.Width+u.Margin.Left}},n.prototype._renderCanvas=function(n,t,i){var f,r,u,e;if(n!=null)for(this._IsParagraphFirstLine()&&(t+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),f=n.getContext("2d"),r=0;r<this.Children.Count;r++)u=this.Children[r],e=this.getUnderlineYposition(),u._render(f,f,t,i,e),t+=u.Width+u.Margin.Left},n.prototype.getUnderlineYposition=function(){var t=0,i=0,n;if(this.Children.Count==0||this.Children.Count==1&&this.Children[0]instanceof et||this.Children.Count==2&&this.Children[0]instanceof et&&this.Children[1]instanceof et)return 0;for(n=0;n<this.Children.Count;n++)t<this.Children[n].Height&&(t=this.Children[0].Margin.Top+this.Children[0].Height,i=this.Children[0].Height/20);return t-2*i},n.prototype.GetLeft=function(){var i=this.CurrentParagraphWidget.X,t,n;for(this._IsParagraphFirstLine()&&(i+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),t=0;t<this.Children.Count;t++)if(n=this.Children[t],n instanceof et)i+=t==0?n.Margin.Left+n.Width:n.Width;else{i+=n.Margin.Left;break}return i},n.prototype.GetLeftInternal=function(n,t){var i=this.CurrentParagraphWidget.X,u,r;for(this._IsParagraphFirstLine()&&(i+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),u=this.Children.IndexOf(n),r=0;r<u;r++)i+=this.Children[r].Margin.Left+this.Children[r].Width;return n!=null&&(i+=n.Margin.Left),n instanceof l?i+=t==n.Length?n.Width:t>n.Length?n.Width+h.GetParagraphMarkSize(n.Inline.OwnerParagraph.CharacterFormat).Width:h.MeasureText(n.Text.substr(0,t),n.Inline.CharacterFormat).Width:t>0&&(n!=null?(i+=n.Width,t==2&&(i+=h.GetParagraphMarkSize(n.Inline.OwnerParagraph.CharacterFormat).Width)):i+=h.GetParagraphMarkSize(this.CurrentParagraphWidget.CurrentNode.CharacterFormat).Width),i},n.prototype.GetLineStartLeft=function(){var n=this.CurrentParagraphWidget.X;return this._IsParagraphFirstLine()&&(n+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),this.Children.Count>0&&(n+=this.Children[0].Margin.Left),n},n.prototype.GetTop=function(){for(var t=this.CurrentParagraphWidget.Y,i=this.CurrentParagraphWidget.ChildWidgets.IndexOf(this),n=0;n<i;n++)t+=this.CurrentParagraphWidget.ChildWidgets[n].Height;return t},n.prototype.UpdateTextPosition=function(n,t,i){var f=t,e=null,r=0,o=!1,u=this.UpdateTextPositionInternal(n,e,r,f,!1);u!=null&&(e=u.inline,r=u.index,f=u.caretPosition,o=u.isImageSelected);o?(n.Selection.Select(this.CurrentParagraphWidget.CurrentNode,e,r,f,!0),r==0?n.Selection.ExtendForward(!1):n.Selection.ExtendBackward(!1)):n.Selection.Select(this.CurrentParagraphWidget.CurrentNode,e,r,f,i)},n.prototype.UpdateTextPositionInternal=function(n,t,i,r,u){var k=!1,v=this.GetTop(),o=this.CurrentParagraphWidget.X,tt=this.GetFirstElement(o),f=tt.element,d,y,p,s,ut,a,g,nt,c;if(o=tt.left,f==null){var w=0,it=0,b=this.CurrentParagraphWidget.CurrentNode.GetParagraphMarkSize(w,it);w=b.TopMargin;it=b.BottomMargin;u&&r.X>o+b.Width/2&&(o+=b.Width,this.CurrentParagraphWidget.CurrentNode.Inlines.Count>0&&(t=this.CurrentParagraphWidget.CurrentNode.Inlines[this.CurrentParagraphWidget.CurrentNode.Inlines.Count-1],i=t.Length),i++);r=new rt(o,w>0?v+w:v)}else if(f!=null){if(r.X>o+f.Margin.Left){for(s=this.Children.IndexOf(f);s<this.Children.Count;s++){if(f=this.Children[s],r.X<o+f.Margin.Left+f.Width||s==this.Children.Count-1)break;o+=f.Margin.Left+f.Width}if(r.X>o+f.Margin.Left+f.Width)i=f instanceof l?this.GetTextLength(f)+f.Length:1,o+=f.Margin.Left+f.Width;else if(f instanceof l){for(d=r.X-o-f.Margin.Left,o+=f.Margin.Left,y=0,p=0,s=1;s<=f.Length;s++){if(c=0,c=s==f.Length?f.Width:h.MeasureText(f.Text.substr(0,s),f.Inline.CharacterFormat).Width,d<c||s==f.Length){ut=c-y;d-y>ut/2?(o+=c,p=s):(o+=y,p=s-1,s==1&&f!=this.Children[0]&&(a=this.Children.IndexOf(f),this.Children[a-1]instanceof et||(f=this.Children[a-1],p=f instanceof l?f.Length:1)));break}y=c}i=this.GetTextLength(f)+p}else k=f instanceof vi,r.X-o-f.Margin.Left>f.Width/2?(i=1,o+=f.Margin.Left+f.Width):f==this.Children[0]||k||(a=this.Children.IndexOf(f),this.Children[a-1]instanceof et||(f=this.Children[a-1],i=f instanceof l?this.GetTextLength(f)+f.Length:1))}else o+=f.Margin.Left,i=this.GetTextLength(f);if(f instanceof l)v+=f.Margin.Top>0?f.Margin.Top:0;else{var ft=h.MeasureText("a",f.Inline.CharacterFormat),st=ft.Height,ot=ft.BaselineOffset;v+=f.Margin.Top+f.Height-ot}t=f.Inline;g=t.ValidateTextPosition(i);t=g.inline;i=g.index;nt=t.NextNode==null&&i==t.Length;u&&t.NextNode instanceof e&&i==t.Length&&(nt=t.IsLastRenderedInline(i));u&&nt&&(c=h.GetParagraphMarkSize(t.OwnerParagraph.CharacterFormat).Width,r.X>o+c/2&&(o+=c,i=t.Length+1));r=new rt(o,v)}return{inline:t,index:i,caretPosition:r,isImageSelected:k}},n.prototype.GetTextLength=function(n){for(var i=0,r=n.Inline.Elements.IndexOf(n),t=0;t<r;t++)i+=n.Inline.Elements[t].Length;return i},n.prototype.GetFirstElement=function(n){var r=0,t,i;for(this._IsParagraphFirstLine()&&(r=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),n+=r,t=null,i=0;i<this.Children.Count;i++)if(t=this.Children[i],t instanceof et)n+=t.Margin.Left+t.Width,t=null;else break;return{element:t,left:n}},n.prototype.GetWidth=function(n){var i=0,t;for(this._IsParagraphFirstLine()&&(i+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),t=0;t<this.Children.Count;t++)i+=this.Children[t].Margin.Left+this.Children[t].Width;return n&&this.CurrentParagraphWidget.CurrentNode.ParagraphWidgets.indexOf(this.CurrentParagraphWidget)==this.CurrentParagraphWidget.CurrentNode.ParagraphWidgets.Count-1&&this.CurrentParagraphWidget.ChildWidgets.IndexOf(this)==this.CurrentParagraphWidget.ChildWidgets.Count-1&&(i+=h.GetParagraphMarkSize(this.CurrentParagraphWidget.CurrentNode.CharacterFormat).Width),i},n.prototype.UpdateTextPositionWidget=function(n,t,i,r){var f=t,e=null,o=0,u=this.UpdateTextPositionInternal(n,e,o,f,r);u!=null&&(e=u.inline,o=u.index,f=u.caretPosition);i.SetPositionForSelection(this.CurrentParagraphWidget.CurrentNode,e,o,f)},n.prototype.GetHyperlinkField=function(n,t){var u=null,v=this.GetTop(),c=this.GetLineStartLeft(),f,a,i,s,e,r,l;if(t.Y<v||t.Y>v+this.Height||t.X<c||t.X>c+this.Width)return null;if(f=this.CurrentParagraphWidget.X,a=this.GetFirstElement(f),f=a.left,i=a.element,i==null){if(e=h.GetParagraphMarkSize(this.CurrentParagraphWidget.CurrentNode.CharacterFormat).Width,t.X<=c+e||t.X>=c+e)return r=new o,l=this.CurrentParagraphWidget.CurrentNode.GetHyperlinkFields(this.CurrentParagraphWidget.CurrentNode,r),r.Clear(),r=null,l}else{if(t.X>f+i.Margin.Left)for(s=this.Children.IndexOf(i);s<this.Children.Count;s++){if(i=this.Children[s],t.X<f+i.Margin.Left+i.Width||s==this.Children.Count-1)break;f+=i.Margin.Left+i.Width}if(u=i.Inline,e=i.Margin.Left+i.Width,u.NextNode==null&&i==u.Elements[u.Elements.Count-1]&&(e+=h.GetParagraphMarkSize(u.OwnerParagraph.CharacterFormat).Width),t.X<=f+e)return r=new o,l=u.OwnerParagraph.GetHyperlinkField(u,r),r.Clear(),r=null,l}return null},n.prototype.ClearSelectionHighlight=function(n){n!=null&&n.OwnerControl!=null&&n.OwnerControl.Selection.SelectionRanges.Count>0&&n.OwnerControl.Selection.SelectionRanges.ClearSelectionHighlightInternal(this)},n.prototype.RemoveWidget=function(n){n.OwnerControl!=null&&n.OwnerControl.Selection.SelectionRanges.Count>0&&n.OwnerControl.Selection.SelectionRanges.RemoveSelectionHighlight(this)},n.prototype.Dispose=function(){var n=null;this.CurrentParagraphWidget!=null&&this.CurrentParagraphWidget.GetPage()!=null&&(n=this.CurrentParagraphWidget.GetPage().Viewer);this.DisposeInternal(n)},n.prototype.DisposeInternal=function(n){var t,i;if(this.ClearSelectionHighlight(n),this.Children!=null){for(t=0;t<this.Children.Count;t++)i=this.Children[t],i.Dispose(n),this.Children.Remove(i),t--;this.Children=null}this.CurrentParagraphWidget!=null&&(this.CurrentParagraphWidget.ChildWidgets!=null&&(this.CurrentParagraphWidget.ChildWidgets.Remove(this),this.CurrentParagraphWidget.Height-=this.Height),this.CurrentParagraphWidget=null)},n}();i.LineWidget=gi;vr=function(){function n(n){this.X=0;this.Y=0;this.Width=0;this.Height=0;this.BaseNode=n}return Object.defineProperty(n.prototype,"Inline",{get:function(){return this.BaseNode},enumerable:!0,configurable:!0}),n.prototype._renderUnderline=function(n,t,i,r,u,f,e){var s=this.Height/(e==lt.Normal?1:1.5),h=this.Margin.Top,c=s/20,o=0;e==lt.Subscript||this instanceof et?(o=s-2*c+i,h+=this.Height-s,o+=h>0?h:0):o=r+i;n.fillRect(t,o,this.Width,c)},n.prototype._renderStrikeThrough=function(n,t,i,r,u,f){var o=this.Height/(f==lt.Normal?1:1.5),s=this.Margin.Top;f==lt.Subscript&&(s+=this.Height-o);i+=s>0?s:0;var e=o/20,h=o/2+.5*e,c=0;for(r==ci.DoubleStrike&&(h-=e);c<(r==ci.DoubleStrike?2:1);)c++,n.fillRect(t+this.Margin.Left,h+i,this.Width,e),h+=2*e},n.prototype.ClipRect=function(n,t,i,r,u){n.beginPath();n.save();n.rect(t,i,r,u);n.clip()},n}();i.ElementBox=vr;l=function(t){function i(n){t.call(this,n);this.BaselineOffset=0;this.Index=0;this.Length=0}return n(i,t),Object.defineProperty(i.prototype,"Text",{get:function(){return this.Inline instanceof k?this.Inline.Text.substr(this.Index,this.Length):""},enumerable:!0,configurable:!0}),i.prototype._getHTML=function(){var n="<span ";return n+=">",n+=this.Inline.Text.substr(this.Index,this.Length),n+"<\/span>"},i.prototype._render=function(n,t,i,r,u){var c=!1,e=this.CurrentLineWidget.CurrentParagraphWidget.ContainerWidget,s,h,f,o,y;e instanceof ni&&(c=e.CurrentNode.OwnerRow.RowFormat.HeightType==ot.Exactly);s=this.Margin.Top;h=this.Margin.Left;c&&this.ClipRect(n,e.X,e.Y,e.Width,e.Height);f=this.Inline.CharacterFormat;o=f.FontColor;n.textBaseline="top";var l="",a="",v=11;l=f.Bold?"bold":"";a=f.Italic?"italic":"";v=f.FontSize==0?.5:f.FontSize/(f.BaselineAlignment==lt.Normal?1:1.5);n.font=l+" "+a+" "+v+"px "+f.FontFamily;f.BaselineAlignment==lt.Subscript&&(s+=this.Height-this.Height/1.5);f.HighlightColor!=d.NoColor&&(t.fillStyle=yt.GetHighlightColorCode(f.HighlightColor),t.fillRect(i+h,r+s,this.Width,this.Height));o=="empty"&&(y=this.Inline.OwnerParagraph.Document,o=this.Inline.CharacterFormat.GetDefaultFontColor(y));n.fillStyle=o;n.fillText(this.Text,i+h,r+s,this.Width);n.restore();f.Underline!=tr.None&&this._renderUnderline(n,i,r,u,o,f.Underline,f.BaselineAlignment);f.StrikeThrough!=ci.None&&this._renderStrikeThrough(n,i,r,f.StrikeThrough,o,f.BaselineAlignment)},i.prototype.Dispose=function(){var n=null;this.CurrentLineWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget.GetPage()!=null&&(n=this.CurrentLineWidget.CurrentParagraphWidget.GetPage().Viewer);this.DisposeInternal(n)},i.prototype.DisposeInternal=function(){this.CurrentLineWidget!=null&&(this.CurrentLineWidget.Children.Contains(this)&&this.CurrentLineWidget.Children.Remove(this),this.CurrentLineWidget=null);this.Inline!=null&&(this.Inline.Elements!=null&&this.Inline.Elements.Contains(this)&&this.Inline.Elements.Remove(this),this.BaseNode=null)},i}(vr);i.TextElementBox=l;et=function(t){function i(n,i,r){t.call(this,n);this.BaselineOffset=0;this.index=0;this.isFollowCharacter=!1;this.ListLevel=i;this.isFollowCharacter=r}return n(i,t),Object.defineProperty(i.prototype,"Paragraph",{get:function(){return this.BaseNode},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Text",{get:function(){return this.text},set:function(n){this.text=n},enumerable:!0,configurable:!0}),i.prototype._getHTML=function(){return},i.prototype._render=function(n,t,i,r,u){var h=this.Margin.Top,l=this.Margin.Left,f=this.ListLevel.CharacterFormat,c=this.Paragraph.CharacterFormat,e=f.FontColor,y;n.textBaseline="top";var a="",v="",p=f.FontFamily=="verdana"?c.FontFamily:f.FontFamily,o=f.FontSize==11?c.FontSize:f.FontSize,s=f.BaselineAlignment==0?c.BaselineAlignment:f.BaselineAlignment;a=f.Bold?"bold":"";v=f.Italic?"italic":"";o=o==0?.5:o/(s==lt.Normal?1:1.5);n.font=a+" "+v+" "+o+"px "+p;s==lt.Subscript&&(h+=this.Height-this.Height/1.5);f.HighlightColor!=d.NoColor&&(t.fillStyle=yt.GetHighlightColorCode(f.HighlightColor),t.fillRect(i+l,r+h,this.Width,this.Height));e=="empty"&&(y=this.Paragraph.Document,e=this.ListLevel.CharacterFormat.GetDefaultFontColor(y));n.fillStyle=e;n.fillText(this.Text,i+l,r+h);f.Underline!=tr.None&&this._renderUnderline(n,i,r,u,e,f.Underline,s);f.StrikeThrough!=ci.None&&this._renderStrikeThrough(n,i,r,f.StrikeThrough,e,s)},i.prototype.Dispose=function(){var n=null;this.CurrentLineWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget.GetPage()!=null&&(n=this.CurrentLineWidget.CurrentParagraphWidget.GetPage().Viewer);this.DisposeInternal(n)},i.prototype.DisposeInternal=function(){this.CurrentLineWidget!=null&&(this.CurrentLineWidget.Children.Contains(this)&&this.CurrentLineWidget.Children.Remove(this),this.CurrentLineWidget=null);this.BaseNode=null;this.ListLevel=null},i}(vr);i.ListTextElementBox=et;vi=function(t){function i(n){t.call(this,n)}return n(i,t),i.prototype._getHTML=function(){var n="<img ";return n+='width="'+this.Inline.Width+'" ',n+='height="'+this.Inline.Height+'" ',n+='src="'+this.Inline.ImageString+'" ',n+">"},i.prototype._render=function(n,t,i,r,u){var o=this.Margin.Top,l=this.Margin.Left,s=0,e=this.Inline.CharacterFormat,a="black",h,f,c,v;n.textBaseline="top";h=document.createElement("img");h.src=this.Inline.ImageString;n.save();(o<0||this.CurrentLineWidget.Width<this.Width)&&(f=this.CurrentLineWidget.CurrentParagraphWidget.ContainerWidget,f instanceof ti?s=f.Width+f.X:f instanceof ni&&(c=0,f.ChildWidgets[0]instanceof wt&&(v=f.ChildWidgets[0].CurrentNode,c=v.ParagraphFormat.LeftIndent),s=f.Width+f.Margin.Left-f.LeftBorderWidth-c),this.ClipRect(n,i+l,r+o,s,f.Height));this.Inline.IsMetaFile||n.drawImage(h,i+l,r+o,this.Width,this.Height);n.restore();e.Underline!=tr.None&&this._renderUnderline(n,i,r,u,a,e.Underline,e.BaselineAlignment);e.StrikeThrough!=ci.None&&this._renderStrikeThrough(n,i,r,e.StrikeThrough,a,e.BaselineAlignment)},i.prototype.Dispose=function(){var n=null;this.CurrentLineWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget.GetPage()!=null&&(n=this.CurrentLineWidget.CurrentParagraphWidget.GetPage().Viewer);this.DisposeInternal(n)},i.prototype.DisposeInternal=function(){this.CurrentLineWidget!=null&&(this.CurrentLineWidget.Children.Contains(this)&&this.CurrentLineWidget.Children.Remove(this),this.CurrentLineWidget=null);this.Inline!=null&&(this.Inline.Elements!=null&&this.Inline.Elements.Contains(this)&&this.Inline.Elements.Remove(this),this.BaseNode=null)},i}(vr);i.ImageElementBox=vi;yr=function(t){function i(n){t.call(this,n);this.listId=-1;this.abstractListId=-1;this.levelOverrides=new er(this)}return n(i,t),Object.defineProperty(i.prototype,"OwnerDocument",{get:function(){return this.OwnerBase},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AbstractList",{get:function(){var n=null;return this.OwnerDocument!=null&&(n=this.OwnerDocument.GetAbstractListAdvByID(this.AbstractListId)),n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListId",{get:function(){return this.listId},set:function(n){this.listId=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AbstractListId",{get:function(){return this.abstractListId},set:function(n){this.abstractListId=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LevelOverrides",{get:function(){return this.levelOverrides},set:function(n){this.levelOverrides=n},enumerable:!0,configurable:!0}),i.prototype.GetListLevel=function(n){this.AbstractList!=null&&this.AbstractList.Levels.Count<=n&&n>=0&&n<9&&this.OwnerDocument.AddListLevel(this.AbstractList);var t=null;return this.LevelOverrides!=null&&(t=this.LevelOverrides.Get(n))!=null&&t.OverrideListLevel!=null?t.OverrideListLevel:this.AbstractList!=null&&n>=0&&n<this.AbstractList.Levels.Count?this.AbstractList.Levels[n]:null},i.prototype.GetListStartValue=function(n){var t=this.LevelOverrides!=null?this.LevelOverrides.Get(n):null,i;return t!=null&&t.OverrideListLevel==null?t.StartAt:(i=this.GetListLevel(n),i==null?0:i.StartAt)},i.prototype.Dispose=function(){this.SetOwner(null);this.LevelOverrides!=null&&this.LevelOverrides.Dispose();this.levelOverrides=null},i}(it);i.ListAdv=yr;yi=function(t){function i(n){t.call(this,n);this.abstractListId=-1;this.levels=new fr(this)}return n(i,t),Object.defineProperty(i.prototype,"OwnerDocument",{get:function(){return this.OwnerBase},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AbstractListId",{get:function(){return this.abstractListId},set:function(n){this.abstractListId=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Levels",{get:function(){return this.levels},set:function(n){this.levels=n},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){var n,t;if(this.SetOwner(null),this.levels!=null)for(n=0;n<this.levels.length;n++)t=this.levels[n],this.levels.Dispose,this.levels.Remove(t),n--},i}(it);i.AbstractListAdv=yi;vt=function(t){function i(n){t.call(this,n);this.listLevelPattern=y.Arabic;this.startAt=0;this.numberFormat="";this.followCharacter=hu.Tab;this.levelNumber=0;this.paragraphFormat=null;this.characterFormat=null;this.restartLevel=0;this.CharacterFormat=new pr(this);this.ParagraphFormat=new nr(this)}return n(i,t),Object.defineProperty(i.prototype,"OwnerDocument",{get:function(){return this.OwnerBase instanceof yi!=null?this.OwnerBase.OwnerDocument:this.OwnerBase instanceof hi!=null?this.OwnerBase.OwnerList.OwnerDocument:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListLevelPattern",{get:function(){return this.listLevelPattern},set:function(n){this.listLevelPattern=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FollowCharacter",{get:function(){return this.followCharacter},set:function(n){this.followCharacter=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"StartAt",{get:function(){return this.startAt},set:function(n){this.startAt=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"NumberFormat",{get:function(){return this.numberFormat},set:function(n){this.numberFormat=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RestartLevel",{get:function(){return this.restartLevel},set:function(n){this.restartLevel=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LevelNumber",{get:function(){return this.OwnerBase instanceof hi?this.OwnerBase.LevelNumber:this.OwnerBase instanceof yi&&this.OwnerBase.Levels!=null?this.OwnerBase.Levels.IndexOf(this):-1},set:function(n){this.levelNumber=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"CharacterFormat",{get:function(){return this.characterFormat},set:function(n){this.characterFormat=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ParagraphFormat",{get:function(){return this.paragraphFormat},set:function(n){this.paragraphFormat=n},enumerable:!0,configurable:!0}),i.prototype.GetListText=function(n){switch(this.ListLevelPattern){case y.UpRoman:return this.GetAsRoman(n).toUpperCase();case y.LowRoman:return this.GetAsRoman(n).toLowerCase();case y.UpLetter:return this.GetAsLetter(n).toUpperCase();case y.LowLetter:return this.GetAsLetter(n).toLowerCase();case y.Arabic:return n.toString();case y.LeadingZero:return n<10?"0"+n.toString():n.toString();case y.Number:return n.toString();case y.OrdinalText:return n.toString();case y.Ordinal:return n.toString();case y.FarEast:return n.toString();case y.Special:return n.toString();default:return""}},i.prototype.GetAsRoman=function(n){var t="",i={number:n};return t+=this.GenerateNumber(i,1e3,"M"),t+=this.GenerateNumber(i,900,"CM"),t+=this.GenerateNumber(i,500,"D"),t+=this.GenerateNumber(i,400,"CD"),t+=this.GenerateNumber(i,100,"C"),t+=this.GenerateNumber(i,90,"XC"),t+=this.GenerateNumber(i,50,"L"),t+=this.GenerateNumber(i,40,"XL"),t+=this.GenerateNumber(i,10,"X"),t+=this.GenerateNumber(i,9,"IX"),t+=this.GenerateNumber(i,5,"V"),t+=this.GenerateNumber(i,4,"IV"),t+=this.GenerateNumber(i,1,"I"),t.toString()},i.prototype.GenerateNumber=function(n,t,i){for(var r="";n.number>=t;)n.number-=t,r+=i;return r.toString()},i.prototype.GetAsLetter=function(n){var t,i,r,u;if(n<=0)return"";for(t=n/26,i=n%26,i==0&&(i=26,t--),r=String.fromCharCode(64+i),u=r.toString();t>0;)u=r.toString(),t--;return u},i.DOTBULLET="",i.SQUAREBULLET="",i.ARROWBULLET="➤",i.CIRCLEBULLET=" ",i}(it);i.ListLevelAdv=vt;hi=function(t){function i(n){t.call(this,n)}return n(i,t),Object.defineProperty(i.prototype,"OwnerList",{get:function(){return this.OwnerBase},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"StartAt",{get:function(){return this.startAt},set:function(n){this.startAt=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LevelNumber",{get:function(){return this.levelNumber},set:function(n){this.levelNumber=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OverrideListLevel",{get:function(){return this.overrideListLevel},set:function(n){this.overrideListLevel=n},enumerable:!0,configurable:!0}),i}(it);i.LevelOverrideAdv=hi;wu=function(t){function i(n){t.call(this,n);this.headerdistance=48;this.footerdistance=48;this.differentfirstpage=!1;this.differentoddandevenpages=!1;this.pagewidth=816;this.pageheight=1056;this.leftmargin=96;this.topmargin=96;this.rightmargin=96;this.bottommargin=96}return n(i,t),Object.defineProperty(i.prototype,"HeaderDistance",{get:function(){return this.headerdistance},set:function(n){this.headerdistance=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FooterDistance",{get:function(){return this.footerdistance},set:function(n){this.footerdistance=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DifferentFirstPage",{get:function(){return this.differentfirstpage},set:function(n){this.differentfirstpage=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DifferentOddAndEvenPages",{get:function(){return this.differentoddandevenpages},set:function(n){this.differentoddandevenpages=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PageWidth",{get:function(){return this.pagewidth},set:function(n){this.pagewidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PageHeight",{get:function(){return this.pageheight},set:function(n){this.pageheight=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftMargin",{get:function(){return this.leftmargin},set:function(n){this.leftmargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopMargin",{get:function(){return this.topmargin},set:function(n){this.topmargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightMargin",{get:function(){return this.rightmargin},set:function(n){this.rightmargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BottomMargin",{get:function(){return this.bottommargin},set:function(n){this.bottommargin=n},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){this.SetOwner(null)},i}(ut);i.SectionFormat=wu;pr=function(t){function i(n){t.call(this,n);this.bold=!1;this.italic=!1;this.fontSize=11;this.underline=tr.None;this.strikeThrough=ci.None;this.baselineAlignment=lt.Normal;this.highlightColor=d.NoColor;this.fontColor="empty";this.fontFamily="verdana"}return n(i,t),Object.defineProperty(i.prototype,"Bold",{get:function(){return this.bold},set:function(n){this.bold=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Italic",{get:function(){return this.italic},set:function(n){this.italic=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FontSize",{get:function(){return this.fontSize},set:function(n){this.fontSize=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FontFamily",{get:function(){return this.fontFamily},set:function(n){this.fontFamily=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Underline",{get:function(){return this.underline},set:function(n){this.underline=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"StrikeThrough",{get:function(){return this.strikeThrough},set:function(n){this.strikeThrough=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BaselineAlignment",{get:function(){return this.baselineAlignment},set:function(n){this.baselineAlignment=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"HighlightColor",{get:function(){return this.highlightColor},set:function(n){this.highlightColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FontColor",{get:function(){return this.fontColor},set:function(n){this.fontColor=n},enumerable:!0,configurable:!0}),i.prototype.CopyFormat=function(n){n.BaselineAlignment!=r&&n.BaselineAlignment!=null&&(this.Bold=n.Bold);n.Underline!=r&&n.Underline!=null&&(this.Underline=n.Underline);n.StrikeThrough!=r&&n.StrikeThrough!=null&&(this.StrikeThrough=n.StrikeThrough);n.FontSize!=r&&n.FontSize!=null&&(this.FontSize=n.FontSize);n.FontFamily!=r&&n.FontFamily!=null&&(this.FontFamily=n.FontFamily);n.Bold!=r&&n.Bold!=null&&(this.Bold=n.Bold);n.Italic!=r&&n.Italic!=null&&(this.Italic=n.Italic);n.HighlightColor!=r&&n.HighlightColor!=null&&(this.HighlightColor=n.HighlightColor);n.FontColor!=r&&n.FontColor!=null&&(this.FontColor=n.FontColor)},i.prototype.GetAsHtmlStyle=function(){var n='style="';return this.Bold&&(n+="font-weight:bold; "),this.Italic&&(n+="font-style:italic; "),this.Underline!=tr.None&&(n+="text-decoration:underline; "),this.StrikeThrough!=ci.None&&(n+="text-decoration:line-through; "),this.BaselineAlignment==lt.Subscript?n+="vertical-align:sub;":this.BaselineAlignment==lt.Superscript&&(n+="vertical-align:super;"),n+="color:"+this.FontColor+"; font-family:"+this.FontFamily+"; font-size:"+this.FontSize+"px; ",this.HighlightColor!=d.NoColor&&(n+="background:"+yt.GetHighlightColorCode(this.HighlightColor)),n+'" '},i.prototype.GetDefaultFontColor=function(n){var t=n.BackgroundColor;return yt.IsVeryDark(t)?"#FFFFFF":"#000000"},i.prototype.Dispose=function(){this.SetOwner(null)},i}(it);i.CharacterFormat=pr;nr=function(t){function i(n){t.call(this,n);this.leftIndent=0;this.rightIndent=0;this.firstLineIndent=0;this.afterSpacing=0;this.beforeSpacing=0;this.lineSpacing=1;this.lineSpacingType=kt.Multiple;this.ListFormat=new bu(this)}return n(i,t),Object.defineProperty(i.prototype,"Document",{get:function(){return this.OwnerBase instanceof f&&this.OwnerBase.Document!=null?this.OwnerBase.Document:this.OwnerBase instanceof vt?this.OwnerBase.OwnerDocument:this.OwnerBase instanceof bi?this.OwnerBase:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftIndent",{get:function(){return this.leftIndent},set:function(n){this.leftIndent=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightIndent",{get:function(){return this.rightIndent},set:function(n){this.rightIndent=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FirstLineIndent",{get:function(){return this.firstLineIndent},set:function(n){this.firstLineIndent=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BeforeSpacing",{get:function(){return this.beforeSpacing},set:function(n){this.beforeSpacing=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AfterSpacing",{get:function(){return this.afterSpacing},set:function(n){this.afterSpacing=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LineSpacing",{get:function(){return this.lineSpacing},set:function(n){this.lineSpacing=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LineSpacingType",{get:function(){return this.lineSpacingType},set:function(n){this.lineSpacingType=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TextAlignment",{get:function(){return this.textalignment},set:function(n){this.textalignment=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListFormat",{get:function(){return this.listFormat},set:function(n){this.listFormat=n},enumerable:!0,configurable:!0}),i.prototype.GetAsHtmlStyle=function(){var n='style="',i,t;return n+=pt.TextAlign+tt.Colon+yt.GetHtmlTextAlign(this.TextAlignment)+tt.SemiColon,i=this.LeftIndent,t=this.FirstLineIndent,this.ListFormat.ListLevel!=null&&(i-=48,t+=24),n+=pt.Margin+tt.Colon+this.BeforeSpacing.toString()+"px "+this.RightIndent.toString()+"px "+this.AfterSpacing.toString()+"px "+i.toString()+"px;",t!=0&&(n+=pt.TextIndent+tt.Colon+t.toString()+pt.Px+tt.SemiColon),n+=this.LineSpacingType==kt.Multiple?pt.LineHeight+tt.Colon+(this.LineSpacing*100).toString()+pt.Percentage+tt.SemiColon:pt.LineHeight+tt.Colon+this.LineSpacing.toString()+pt.Px+tt.SemiColon,n+'" '},i.prototype.Dispose=function(){this.SetOwner(null)},i}(it);i.ParagraphFormat=nr;bu=function(t){function i(n){t.call(this,n);this.listId=-1;this.listLevelNumber=0}return n(i,t),Object.defineProperty(i.prototype,"Document",{get:function(){return this.OwnerBase instanceof nr?this.OwnerBase.Document:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListId",{get:function(){return this.listId},set:function(n){this.listId=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListLevelNumber",{get:function(){return this.listLevelNumber},set:function(n){this.listLevelNumber=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListLevel",{get:function(){return this.List!=null?this.List.GetListLevel(this.ListLevelNumber):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"List",{get:function(){if(this.Document!=null)return this.Document.GetListByID(this.ListId)},enumerable:!0,configurable:!0}),i}(it);i.ListFormat=bu;ku=function(){function n(){this.tableColumns=new lu}return Object.defineProperty(n.prototype,"Columns",{get:function(){return this.tableColumns},enumerable:!0,configurable:!0}),n.prototype.GetPreviousSpannedCellWidth=function(n,t){for(var r=0,i=n;i<t;i++)r+=this.tableColumns[i].PreferredWidth;return r},n.prototype.Dispose=function(){this.tableColumns!=null&&(this.tableColumns.Clear(),this.tableColumns=null)},n}();i.TableHolder=ku;uu=function(t){function i(n){t.call(this,n)}return n(i,t),Object.defineProperty(i.prototype,"BackgroundColor",{get:function(){return this.backgroundColor},set:function(n){this.backgroundColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ForegroundColor",{get:function(){return this.foregroundColor},set:function(n){this.foregroundColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TextureStyle",{get:function(){return this.textureStyle},set:function(n){this.textureStyle=n},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){this.SetOwner(null)},i}(it);i.Shading=uu;wr=function(t){function i(n){t.call(this,n);this.Left=new g(this);this.Right=new g(this);this.Top=new g(this);this.Bottom=new g(this);this.DiagonalUp=new g(this);this.DiagonalDown=new g(this);this.Horizontal=new g(this);this.Vertical=new g(this)}return n(i,t),Object.defineProperty(i.prototype,"Left",{get:function(){return this.left},set:function(n){this.left=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Right",{get:function(){return this.right},set:function(n){this.right=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Top",{get:function(){return this.top},set:function(n){this.top=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Bottom",{get:function(){return this.bottom},set:function(n){this.bottom=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Horizontal",{get:function(){return this.horizontal},set:function(n){this.horizontal=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Vertical",{get:function(){return this.vertical},set:function(n){this.vertical=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DiagonalUp",{get:function(){return this.diagonalUp},set:function(n){this.diagonalUp=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DiagonalDown",{get:function(){return this.diagonalDown},set:function(n){this.diagonalDown=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LineStyle",{set:function(n){this.Left!=null&&(this.Left.LineStyle=n);this.Right!=null&&(this.Right.LineStyle=n);this.Top!=null&&(this.Top.LineStyle=n);this.Bottom!=null&&(this.Bottom.LineStyle=n);this.Horizontal!=null&&(this.Horizontal.LineStyle=n);this.Vertical!=null&&(this.Vertical.LineStyle=n);this.DiagonalUp!=null&&(this.DiagonalUp.LineStyle=n);this.DiagonalDown!=null&&(this.DiagonalDown.LineStyle=n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LineWidth",{set:function(n){this.Left!=null&&(this.Left.LineWidth=n);this.Right!=null&&(this.Right.LineWidth=n);this.Top!=null&&(this.Top.LineWidth=n);this.Bottom!=null&&(this.Bottom.LineWidth=n);this.Horizontal!=null&&(this.Horizontal.LineWidth=n);this.Vertical!=null&&(this.Vertical.LineWidth=n);this.DiagonalUp!=null&&(this.DiagonalUp.LineWidth=n);this.DiagonalDown!=null&&(this.DiagonalDown.LineWidth=n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Color",{set:function(n){this.Left!=null&&(this.Left.Color=n);this.Right!=null&&(this.Right.Color=n);this.Top!=null&&(this.Top.Color=n);this.Bottom!=null&&(this.Bottom.Color=n);this.Horizontal!=null&&(this.Horizontal.Color=n);this.Vertical!=null&&(this.Vertical.Color=n);this.DiagonalUp!=null&&(this.DiagonalUp.Color=n);this.DiagonalDown!=null&&(this.DiagonalDown.Color=n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerCell",{get:function(){return this.OwnerBase instanceof eu&&this.OwnerBase.OwnerBase instanceof ht?this.OwnerBase.OwnerBase:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerRow",{get:function(){return this.OwnerCell!=null?this.OwnerCell.OwnerRow:this.OwnerBase instanceof fu&&this.OwnerBase.OwnerBase instanceof ui?this.OwnerBase.OwnerBase:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerTable",{get:function(){return this.OwnerRow!=null?this.OwnerRow.OwnerTable:this.OwnerBase instanceof bt&&this.OwnerBase.OwnerBase instanceof w?this.OwnerBase.OwnerBase:null},enumerable:!0,configurable:!0}),i.prototype.GetTableLeftBorder=function(){if(this.Left!=null)return this.Left;var n=new g(this);return n.LineStyle=u.Single,n.LineWidth=.66,n},i.prototype.GetTableRightBorder=function(){if(this.Right!=null)return this.Right;var n=new g(this);return n.LineStyle=u.Single,n.LineWidth=.66,n},i.prototype.GetTableTopBorder=function(){if(this.Top!=null)return this.Top;var n=new g(this);return n.LineStyle=u.Single,n.LineWidth=.66,n},i.prototype.GetTableBottomBorder=function(){if(this.Bottom!=null)return this.Bottom;var n=new g(this);return n.LineStyle=u.Single,n.LineWidth=.66,n},i.prototype.GetCellLeftBorder=function(n){var t=null,r=n.CellFormat.Borders,u=n.OwnerRow!=null?n.OwnerRow.RowFormat.Borders:null,f=n.OwnerTable!=null?n.OwnerTable.TableFormat.Borders:null,i;return r.Left!=null&&(t=r.Left),t==null&&(t=this.GetLeftBorderToRenderByHierarchy(t,u,f)),n.OwnerTable.TableFormat.CellSpacing>0?t=this.GetLeftBorderToRenderByHierarchy(t,u,f):(i=null,n.PreviousNode!=null&&(i=n.PreviousNode),t=this.GetPrevCellLeftBorder(t,i)),t==null&&(t=new g(this)),t},i.prototype.GetPrevCellLeftBorder=function(n,t){if(t!=null&&(n==null||n.LineStyle!=u.None||n.HasNoneStyle)){var r,i=null;if(t.CellFormat.Borders!=null&&t.CellFormat.Borders.Right!=null&&t.CellFormat.Borders.Right.LineStyle!=u.None&&(i=t.CellFormat.Borders.Right),i!=null&&i.LineStyle!=u.None)r=this.GetBorderBasedOnPriority(i,n);else if(n!=null&&!(n.OwnerBase.OwnerBase instanceof bt))return this.GetLeftBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders)}else if(n!=null&&!(n.OwnerBase.OwnerBase instanceof bt))return this.GetLeftBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders);return n},i.prototype.GetLeftBorderToRenderByHierarchy=function(n,t,r){return n!=null&&(n.LineStyle!=u.None||n.HasNoneStyle)?n:n!=null&&n.OwnerBase instanceof i&&n.OwnerBase.OwnerCell.ColumnIndex==0?(r!=null&&r.Left!=null&&(n=r.Left),n):t!=null&&t.Vertical!=null&&t.Vertical.LineStyle!=u.None?t.Vertical:r!=null&&r.Vertical!=null&&r.Vertical.LineStyle!=u.None?r.Vertical:n},i.prototype.GetCellDiagonalUpBorder=function(n){var i=null,t=null;return t=n.CellFormat.Borders,t.DiagonalUp!=null&&(i=t.DiagonalUp),i},i.prototype.GetCellDiagonalDownBorder=function(n){var i=null,t=null;return t=n.CellFormat.Borders,t.DiagonalDown!=null&&(i=t.DiagonalDown),i},i.prototype.GetCellRightBorder=function(n){var t=null,r=n.CellFormat.Borders,u=n.OwnerRow!=null?n.OwnerRow.RowFormat.Borders:null,f=n.OwnerTable!=null?n.OwnerTable.TableFormat.Borders:null,i;return r.Right!=null&&(t=r.Right),t==null&&(t=this.GetRightBorderToRenderByHierarchy(t,u,f)),n.OwnerTable.TableFormat.CellSpacing>0?t=this.GetRightBorderToRenderByHierarchy(t,u,f):(i=null,n.NextNode!=null&&(i=n.NextNode),t=this.GetAdjacentCellRightBorder(t,i)),t==null&&(t=new g(this)),t},i.prototype.GetAdjacentCellRightBorder=function(n,t){if(t!=null&&(n==null||n.LineStyle!=u.None||n.HasNoneStyle)){var i=null;if(t.CellFormat.Borders!=null&&t.CellFormat.Borders.Left!=null&&t.CellFormat.Borders.Left.LineStyle!=u.None&&(i=t.CellFormat.Borders.Left),i!=null&&i.LineStyle!=u.None)return this.GetBorderBasedOnPriority(n,i);if(n!=null&&!(n.OwnerBase.OwnerBase instanceof bt))return this.GetRightBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders)}else if(n!=null&&!(n.OwnerBase.OwnerBase instanceof bt))return this.GetRightBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders);return n},i.prototype.GetRightBorderToRenderByHierarchy=function(n,t,r){return n!=null&&(n.LineStyle!=u.None||n.HasNoneStyle)?n:n!=null&&n.OwnerBase instanceof i&&n.OwnerBase.OwnerCell.ColumnIndex==n.OwnerBase.OwnerCell.OwnerRow.Cells.Count-1?(r!=null&&r.Right!=null&&(n=r.Right),n):t!=null&&t.Vertical!=null&&t.Vertical.LineStyle!=u.None?t.Vertical:r!=null&&r.Vertical!=null&&r.Vertical.LineStyle!=u.None?r.Vertical:n},i.prototype.GetCellTopBorder=function(n){var t=null,u=n.CellFormat.Borders,f=n.OwnerRow!=null?n.OwnerRow.RowFormat.Borders:null,e=n.OwnerTable!=null?n.OwnerTable.TableFormat.Borders:null,r,i;return u.Top!=null&&(t=u.Top),t==null&&(t=this.GetTopBorderToRenderByHierarchy(t,f,e)),n.OwnerTable.TableFormat.CellSpacing>0?t=this.GetTopBorderToRenderByHierarchy(t,f,e):(r=null,i=n.OwnerRow.PreviousNode,i!=null&&n.ColumnIndex<i.Cells.Count&&(r=i.Cells[n.ColumnIndex]),t=this.GetPrevCellTopBorder(t,r)),t==null&&(t=new g(this)),t},i.prototype.GetPrevCellTopBorder=function(n,t){if(t!=null&&(n==null||n.LineStyle!=u.None||n.HasNoneStyle)){var i=null;if(t.CellFormat.Borders!=null&&t.CellFormat.Borders.Bottom!=null&&t.CellFormat.Borders.Bottom.LineStyle!=u.None&&(i=t.CellFormat.Borders.Left),i!=null&&i.LineStyle!=u.None)return this.GetBorderBasedOnPriority(n,i);if(n!=null&&!(n.OwnerBase.OwnerBase instanceof bt))return this.GetTopBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders)}else if(n!=null&&!(n.OwnerBase.OwnerBase instanceof bt))return this.GetTopBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders);return n},i.prototype.GetTopBorderToRenderByHierarchy=function(n,t,r){return n!=null&&(n.LineStyle!=u.None||n.HasNoneStyle)?n:n!=null&&n.OwnerBase instanceof i&&n.OwnerBase.OwnerCell.OwnerRow.RowIndex==0?(r!=null&&r.Top!=null&&(n=r.Top),n):t!=null&&t.Horizontal!=null&&t.Horizontal.LineStyle!=u.None?t.Horizontal:r!=null&&r.Horizontal!=null&&r.Horizontal.LineStyle!=u.None?r.Horizontal:n},i.prototype.GetCellBottomBorder=function(n){var t=null,u=n.CellFormat.Borders,f=n.OwnerRow!=null?n.OwnerRow.RowFormat.Borders:null,e=n.OwnerTable!=null?n.OwnerTable.TableFormat.Borders:null,r,i;return u.Bottom!=null&&(t=u.Bottom),t==null&&(t=this.GetBottomBorderToRenderByHierarchy(t,f,e)),n.OwnerTable.TableFormat.CellSpacing>0?t=this.GetBottomBorderToRenderByHierarchy(t,f,e):(r=null,i=n.OwnerRow.NextNode,i!=null&&n.ColumnIndex<i.Cells.Count&&(r=i.Cells[n.ColumnIndex]),t=this.GetAdjacentCellBottomBorder(t,r)),t==null&&(t=new g(this)),t},i.prototype.GetAdjacentCellBottomBorder=function(n,t){if(t!=null&&(n==null||n.LineStyle!=u.None||n.HasNoneStyle)){var i=null;if(t.CellFormat.Borders!=null&&t.CellFormat.Borders.Top!=null&&t.CellFormat.Borders.Top.LineStyle!=u.None&&(i=t.CellFormat.Borders.Top),i!=null&&i.LineStyle!=u.None)return this.GetBorderBasedOnPriority(n,i);if(n!=null&&!(n.OwnerBase.OwnerBase instanceof bt))return this.GetBottomBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders)}else if(n!=null&&!(n.OwnerBase.OwnerBase instanceof bt))return this.GetBottomBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders);return n},i.prototype.GetBottomBorderToRenderByHierarchy=function(n,t,r){return n!=null&&(n.LineStyle!=u.None||n.HasNoneStyle)?n:n!=null&&n.OwnerBase instanceof i&&n.OwnerBase.OwnerCell.OwnerRow.RowIndex+n.OwnerBase.OwnerCell.CellFormat.RowSpan==n.OwnerBase.OwnerCell.OwnerTable.Rows.Count?(r!=null&&r.Bottom!=null&&(n=r.Bottom),n):t!=null&&t.Horizontal!=null&&t.Horizontal.LineStyle!=u.None?t.Horizontal:r!=null&&r.Horizontal!=null&&r.Horizontal.LineStyle!=u.None?r.Horizontal:n},i.prototype.GetBorderBasedOnPriority=function(n,t){var e,o,s,h;if(n==null)return t;if(t==null)return n;if(e=n.GetBorderWeight(),o=t.GetBorderWeight(),e==o){if(s=n.GetPrecedence(),h=t.GetPrecedence(),s==h){var c=this.ConvertHexToRGB(n.Color),y=c.R,u=c.G,a=c.B,l=this.ConvertHexToRGB(t.Color),p=l.R,f=l.G,v=l.B,i=y+a+2*u,r=p+v+2*f;return i==r?(i=a+2*u,r=v+2*f,i==r?u==f?n:u>f?t:n:i>r?t:n):i>r?t:n}return s>h?n:t}return e>o?n:t},i.prototype.ConvertHexToRGB=function(n){if(n){n=n.replace(/[^0-9A-â€Œâ€‹F]/gi,"");var t=parseInt(n,16),i=t>>16&255,r=t>>8&255,u=t&255;return{R:i,G:r,B:u}}},i.prototype.GetAsHtmlStyle=function(){var t="",n=null;return n=this.OwnerCell!=null?this.GetCellLeftBorder(this.OwnerCell):this.GetTableLeftBorder(),n!=null&&n.LineStyle!=u.None?t+=n.GetAsHtmlStyle("left"):n!=null&&n.HasNoneStyle&&(t+="border-left-style:none;"),n=this.OwnerCell!=null?this.GetCellRightBorder(this.OwnerCell):this.GetTableRightBorder(),n!=null&&n.LineStyle!=u.None?t+=n.GetAsHtmlStyle("right"):n!=null&&n.HasNoneStyle&&(t+="border-right-style:none;"),n=this.OwnerCell!=null?this.GetCellTopBorder(this.OwnerCell):this.GetTableTopBorder(),n!=null&&n.LineStyle!=u.None?t+=n.GetAsHtmlStyle("top"):n!=null&&n.HasNoneStyle&&(t+="border-top-style:none;"),n=this.OwnerCell!=null?this.GetCellBottomBorder(this.OwnerCell):this.GetTableBottomBorder(),n!=null&&n.LineStyle!=u.None?t+=n.GetAsHtmlStyle("bottom"):n!=null&&n.HasNoneStyle&&(t+="border-bottom-style:none;"),t},i.prototype.Dispose=function(){this.SetOwner(null)},i}(it);i.Borders=wr;g=function(t){function i(n){t.call(this,n);this.color="#000000";this.lineStyle=u.Single;this.lineWidth=0}return n(i,t),Object.defineProperty(i.prototype,"Color",{get:function(){return this.color},set:function(n){this.color=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LineStyle",{get:function(){return this.lineStyle},set:function(n){this.lineStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LineWidth",{get:function(){return this.lineWidth},set:function(n){this.lineWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Shadow",{get:function(){return this.shadow},set:function(n){this.shadow=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Space",{get:function(){return this.space},set:function(n){this.space=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"HasNoneStyle",{get:function(){return this.hasNoneStyle},set:function(n){this.hasNoneStyle=n},enumerable:!0,configurable:!0}),i.prototype.GetPrecedence=function(){var n=0;switch(this.LineStyle){case u.Single:n=1;break;case u.Thick:n=2;break;case u.Double:n=3;break;case u.Dot:n=4;break;case u.DashLargeGap:n=5;break;case u.DashDot:n=6;break;case u.DashDotDot:n=7;break;case u.Triple:n=8;break;case u.ThinThickSmallGap:n=9;break;case u.ThickThinSmallGap:n=10;break;case u.ThinThickThinSmallGap:n=11;break;case u.ThinThickMediumGap:n=12;break;case u.ThickThinMediumGap:n=13;break;case u.ThinThickThinMediumGap:n=14;break;case u.ThinThickLargeGap:n=15;break;case u.ThickThinLargeGap:n=16;break;case u.ThinThickThinLargeGap:n=17;break;case u.SingleWavy:n=18;break;case u.DoubleWavy:n=19;break;case u.DashSmallGap:n=20;break;case u.DashDotStroked:n=21;break;case u.Emboss3D:n=22;break;case u.Engrave3D:n=23;break;case u.Outset:n=24;break;case u.Inset:n=25}return n},i.prototype.GetBorderWeight=function(){var n=0,t=this.GetNumberOfLines(),i=this.GetBorderNumber();switch(this.LineStyle){case u.Single:case u.DashSmallGap:case u.DashDot:case u.DashDotDot:case u.Double:case u.Triple:case u.ThinThickSmallGap:case u.ThickThinSmallGap:case u.ThinThickThinSmallGap:case u.ThinThickMediumGap:case u.ThickThinMediumGap:case u.ThinThickThinMediumGap:case u.ThinThickLargeGap:case u.ThickThinLargeGap:case u.ThinThickThinLargeGap:case u.SingleWavy:case u.DoubleWavy:case u.DashDotStroked:case u.Emboss3D:case u.Engrave3D:case u.Outset:case u.Inset:case u.Thick:n=t*i;break;case u.Dot:case u.DashLargeGap:n=1}return n},i.prototype.GetBorderNumber=function(){var n=0;switch(this.LineStyle){case u.Single:n=1;break;case u.Thick:n=2;break;case u.Double:n=3;break;case u.Dot:n=4;break;case u.DashLargeGap:n=5;break;case u.DashDot:n=6;break;case u.DashDotDot:n=7;break;case u.Triple:n=8;break;case u.ThinThickSmallGap:n=9;break;case u.ThickThinSmallGap:n=10;break;case u.ThinThickThinSmallGap:n=11;break;case u.ThinThickMediumGap:n=12;break;case u.ThickThinMediumGap:n=13;break;case u.ThinThickThinMediumGap:n=14;break;case u.ThinThickLargeGap:n=15;break;case u.ThickThinLargeGap:n=16;break;case u.ThinThickThinLargeGap:n=17;break;case u.SingleWavy:n=18;break;case u.DoubleWavy:n=19;break;case u.DashSmallGap:n=20;break;case u.DashDotStroked:n=21;break;case u.Emboss3D:n=22;break;case u.Engrave3D:n=23;break;case u.Outset:n=24;break;case u.Inset:n=25}return n},i.prototype.GetNumberOfLines=function(){var n=0;switch(this.LineStyle){case u.Single:case u.Dot:case u.DashSmallGap:case u.DashLargeGap:case u.DashDot:case u.DashDotDot:n=1;break;case u.Double:n=3;break;case u.Triple:n=5;break;case u.ThinThickSmallGap:n=3;break;case u.ThickThinSmallGap:n=3;break;case u.ThinThickThinSmallGap:n=5;break;case u.ThinThickMediumGap:n=3;break;case u.ThickThinMediumGap:n=3;break;case u.ThinThickThinMediumGap:n=5;break;case u.ThinThickLargeGap:n=3;break;case u.ThickThinLargeGap:n=3;break;case u.ThinThickThinLargeGap:n=5;break;case u.SingleWavy:n=1;break;case u.DoubleWavy:n=2;break;case u.DashDotStroked:n=1;break;case u.Emboss3D:case u.Engrave3D:n=3;break;case u.Outset:case u.Inset:case u.Thick:n=1}return n},i.prototype.GetLineWidth=function(){var t,i,n;switch(this.LineStyle){case u.None:return 0;case u.Triple:case u.Double:case u.ThinThickSmallGap:case u.ThickThinSmallGap:case u.ThinThickThinSmallGap:case u.ThinThickMediumGap:case u.ThickThinMediumGap:case u.ThinThickThinMediumGap:case u.ThinThickLargeGap:case u.ThickThinLargeGap:case u.ThinThickThinLargeGap:case u.Emboss3D:case u.Engrave3D:for(t=this.GetBorderLineWidthArray(u,this.LineWidth),i=0,n=0;n<t.length;n++)i+=t[n];return i;case u.Single:case u.DashLargeGap:case u.DashSmallGap:case u.Dot:case u.DashDot:case u.DashDotDot:case u.Thick:return this.LineWidth;case u.SingleWavy:return this.LineWidth==1.5?3:2.5;case u.DoubleWavy:return 6.75;case u.DashDotStroked:case u.Outset:return this.LineWidth}return this.LineWidth},i.prototype.GetBorderLineWidthArray=function(n,t){var i=[t],r;switch(this.LineStyle){case n.Double:i=[1,1,1];break;case n.ThinThickSmallGap:i=[1,-.75,-.75];break;case n.ThickThinSmallGap:i=[-.75,-.75,1];break;case n.ThinThickMediumGap:i=[1,.5,.5];break;case n.ThickThinMediumGap:i=[.5,.5,1];break;case n.ThinThickLargeGap:i=[-1.5,1,-.75];break;case n.ThickThinLargeGap:i=[-.75,1,-1.5];break;case n.Triple:i=[1,1,1,1,1];break;case n.ThinThickThinSmallGap:i=[-.75,-.75,1,-.75,-.75];break;case n.ThinThickThinMediumGap:i=[.5,.5,1,.5,.5];break;case n.ThinThickThinLargeGap:i=[-.75,1,-1.5,1,-.75];break;case n.Emboss3D:case n.Engrave3D:i=[.25,0,1,0,.25]}if(i.length==1)return[t];for(r=0;r<i.length;r++)i[r]=i[r]>=0?i[r]*t:Math.abs(i[r]);return i},i.prototype.GetAsHtmlStyle=function(n){var t="";return t+="border-"+n+"-style:"+this.GetHtmlLineStyle(),t+=tt.SemiColon,this.LineWidth>0&&(t+="border-"+n+"-width:"+this.LineWidth.toString()+"px;"),this.Color!="#000000"&&(t+="border-"+n+"-color:"+this.Color+tt.SemiColon),t},i.prototype.GetHtmlLineStyle=function(){switch(this.LineStyle){case u.None:return"none";case u.Single:return"solid";case u.Dot:return"dotted";case u.DashSmallGap:case u.DashLargeGap:case u.DashDot:case u.DashDotDot:return"dashed";case u.Double:case u.Triple:case u.ThinThickSmallGap:case u.ThickThinSmallGap:case u.ThinThickThinSmallGap:case u.ThinThickMediumGap:case u.ThickThinMediumGap:case u.ThinThickThinMediumGap:case u.ThinThickLargeGap:case u.ThickThinLargeGap:case u.ThinThickThinLargeGap:return"double";case u.SingleWavy:return"solid";case u.DoubleWavy:return"double";case u.DashDotStroked:return"solid";case u.Emboss3D:return"ridge";case u.Engrave3D:return"groove";case u.Outset:return"outset";case u.Inset:return"inset";default:return"solid"}},i}(it);i.Border=g;bt=function(t){function i(n){t.call(this,n);this.leftMargin=7.2;this.topMargin=0;this.bottomMargin=0;this.rightMargin=7.2;this.Borders=new wr(this);this.Shading=new uu(this)}return n(i,t),Object.defineProperty(i.prototype,"Borders",{get:function(){return this.borders},set:function(n){this.borders=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"CellSpacing",{get:function(){return this.cellSpacing},set:function(n){this.cellSpacing=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftMargin",{get:function(){return this.leftMargin},set:function(n){this.leftMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopMargin",{get:function(){return this.topMargin},set:function(n){this.topMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightMargin",{get:function(){return this.rightMargin},set:function(n){this.rightMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BottomMargin",{get:function(){return this.bottomMargin},set:function(n){this.bottomMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftIndent",{get:function(){return this.leftIndent},set:function(n){this.leftIndent=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Shading",{get:function(){return this.shading},set:function(n){this.shading=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TableAlignment",{get:function(){return this.tableAlignment},set:function(n){this.tableAlignment=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PreferredWidth",{get:function(){return this.prefferedWidth},set:function(n){this.prefferedWidth=n},enumerable:!0,configurable:!0}),i.prototype.GetAsHtmlStyle=function(){var t="",n;return this.Shading!=r&&this.Shading!=null&&this.Shading.BackgroundColor!=r&&this.Shading.BackgroundColor!=null&&(t+=" "+pt.BgColor+tt.Equal+'"'+this.Shading.BackgroundColor+'"'),t+=' border="1"',t+=' cellpadding="0"',n=' style="',this.LeftIndent!=r&&this.LeftIndent!=0&&(n+=pt.LeftIndent+tt.Colon+this.LeftIndent.toString()+"px;"),n+=this.CellSpacing!=r&&this.CellSpacing>0?"cellspacing:"+(this.CellSpacing*72/48).toString()+tt.SemiColon:"border-collapse:collapse;",this.Borders!=r&&this.Borders!=null&&(n+=this.Borders.GetAsHtmlStyle()),n+='" ',t+n},i.prototype.Dispose=function(){this.SetOwner(null);this.Borders.Dispose();this.Shading.Dispose()},i}(it);i.TableFormat=bt;fu=function(t){function i(n){t.call(this,n);this.Borders=new wr(this)}return n(i,t),Object.defineProperty(i.prototype,"AllowBreakAcrossPages",{get:function(){return this.allowBreakAcrossPages},set:function(n){this.allowBreakAcrossPages=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsHeader",{get:function(){return this.isHeader},set:function(n){this.isHeader=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Height",{get:function(){return this.height},set:function(n){this.height=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"HeightType",{get:function(){return this.heightType},set:function(n){this.heightType=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Borders",{get:function(){return this.borders},set:function(n){this.borders=n},enumerable:!0,configurable:!0}),i.prototype.GetAsHtmlStyle=function(){var n="";return this.Height!=r&&this.Height>0&&(n='style ="height:'+this.Height.toString()+'px;"'),n},i}(it);i.RowFormat=fu;eu=function(t){function i(n){t.call(this,n);this.leftMargin=0;this.topMargin=0;this.rightMargin=0;this.bottomMargin=0;this.Borders=new wr(this);this.Shading=new uu(this)}return n(i,t),Object.defineProperty(i.prototype,"Borders",{get:function(){return this.borders},set:function(n){this.borders=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftMargin",{get:function(){return this.leftMargin},set:function(n){this.leftMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopMargin",{get:function(){return this.topMargin},set:function(n){this.topMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BottomMargin",{get:function(){return this.bottomMargin},set:function(n){this.bottomMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightMargin",{get:function(){return this.rightMargin},set:function(n){this.rightMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"CellWidth",{get:function(){return this.cellWidth},set:function(n){this.cellWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ColumnSpan",{get:function(){return this.colSpan},set:function(n){this.colSpan=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RowSpan",{get:function(){return this.rowSpan},set:function(n){this.rowSpan=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PrefferedWidth",{get:function(){return this.prefferedWidth},set:function(n){this.prefferedWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PrefferedWidthType",{get:function(){return this.prefferedWidthtype},set:function(n){this.prefferedWidthtype=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Shading",{get:function(){return this.shading},set:function(n){this.shading=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"VerticalAlignment",{get:function(){return this.verticalAlignment},set:function(n){this.verticalAlignment=n},enumerable:!0,configurable:!0}),i.prototype.ContainsMargins=function(){return this.LeftMargin!=null&&this.LeftMargin!=r||this.RightMargin!=null&&this.RightMargin!=r||this.TopMargin!=null&&this.TopMargin!=r||this.BottomMargin!=null&&this.BottomMargin!=r},i.prototype.ClearMargins=function(){this.LeftMargin=this.RightMargin=this.TopMargin=this.BottomMargin=r},i.prototype.GetAsHtmlStyle=function(){var t="",n;return t+=" rowspan="+this.RowSpan.toString(),t+=" colspan="+this.ColumnSpan.toString(),this.Shading!=r&&this.Shading!=null&&this.Shading.BackgroundColor!=r&&this.Shading.BackgroundColor!=null&&(t+=" "+pt.BgColor+tt.Equal+'"'+this.Shading.BackgroundColor+'"'),this.CellWidth!=r&&this.CellWidth>0&&(t+=" width="+this.CellWidth.toString()),n=' style="',this.VerticalAlignment!=su.Top&&(n+="valign:"+this.VerticalAlignment.toString().toLowerCase()),this.ContainsMargins()&&(this.LeftMargin!=r&&this.LeftMargin!=0&&(n+="padding-left:"+this.LeftMargin.toString()+"px;"),this.RightMargin!=r&&this.RightMargin!=0&&(n+="padding-right:"+this.RightMargin.toString()+"px;"),this.TopMargin!=r&&this.TopMargin!=0&&(n+="padding-top:"+this.TopMargin.toString()+"px;"),this.BottomMargin!=r&&this.BottomMargin!=0&&(n+="padding-bottom:"+this.BottomMargin.toString()+"px;")),this.Borders!=r&&this.Borders!=null&&(n+=this.Borders.GetAsHtmlStyle()),n+='" ',t+n},i.prototype.Dispose=function(){this.SetOwner(null)},i}(it);i.CellFormat=eu,function(n){n[n.None=0]="None";n[n.SingleStrike=1]="SingleStrike";n[n.DoubleStrike=2]="DoubleStrike"}(i.StrikeThrough||(i.StrikeThrough={}));ci=i.StrikeThrough,function(n){n[n.Normal=0]="Normal";n[n.Superscript=1]="Superscript";n[n.Subscript=2]="Subscript"}(i.BaselineAlignment||(i.BaselineAlignment={}));lt=i.BaselineAlignment,function(n){n[n.None=0]="None";n[n.Single=1]="Single";n[n.Words=2]="Words";n[n.Double=3]="Double";n[n.Dotted=4]="Dotted";n[n.Thick=6]="Thick";n[n.Dash=7]="Dash";n[n.DashLong=39]="DashLong";n[n.DotDash=9]="DotDash";n[n.DotDotDash=10]="DotDotDash";n[n.Wavy=11]="Wavy";n[n.DottedHeavy=20]="DottedHeavy";n[n.DashHeavy=23]="DashHeavy";n[n.DashLongHeavy=55]="DashLongHeavy";n[n.DotDashHeavy=25]="DotDashHeavy";n[n.DotDotDashHeavy=26]="DotDotDashHeavy";n[n.WavyHeavy=27]="WavyHeavy";n[n.WavyDouble=43]="WavyDouble"}(i.Underline||(i.Underline={}));tr=i.Underline,function(n){n[n.NoColor=0]="NoColor";n[n.Yellow=1]="Yellow";n[n.BrightGreen=2]="BrightGreen";n[n.Turquoise=3]="Turquoise";n[n.Pink=4]="Pink";n[n.Blue=5]="Blue";n[n.Red=6]="Red";n[n.DarkBlue=7]="DarkBlue";n[n.Teal=8]="Teal";n[n.Green=9]="Green";n[n.Violet=10]="Violet";n[n.DarkRed=11]="DarkRed";n[n.DarkYellow=12]="DarkYellow";n[n.Gray50=13]="Gray50";n[n.Gray25=14]="Gray25";n[n.Black=15]="Black"}(i.HighlightColor||(i.HighlightColor={}));d=i.HighlightColor,function(n){n[n.AtLeast=0]="AtLeast";n[n.Exactly=1]="Exactly";n[n.Multiple=2]="Multiple"}(i.LineSpacingType||(i.LineSpacingType={}));kt=i.LineSpacingType,function(n){n[n.Center=0]="Center";n[n.Left=1]="Left";n[n.Right=2]="Right";n[n.Justify=3]="Justify"}(i.TextAlignment||(i.TextAlignment={}));nt=i.TextAlignment,function(n){n[n.Auto=0]="Auto";n[n.Percent=1]="Percent";n[n.Pixel=2]="Pixel"}(i.WidthType||(i.WidthType={}));nf=i.WidthType,function(n){n[n.Left=0]="Left";n[n.Center=1]="Center";n[n.Right=2]="Right"}(i.TableAlignment||(i.TableAlignment={}));ou=i.TableAlignment,function(n){n[n.None=0]="None";n[n.Single=1]="Single";n[n.Dot=2]="Dot";n[n.DashSmallGap=3]="DashSmallGap";n[n.DashLargeGap=4]="DashLargeGap";n[n.DashDot=5]="DashDot";n[n.DashDotDot=6]="DashDotDot";n[n.Double=7]="Double";n[n.Triple=8]="Triple";n[n.ThinThickSmallGap=9]="ThinThickSmallGap";n[n.ThickThinSmallGap=10]="ThickThinSmallGap";n[n.ThinThickThinSmallGap=11]="ThinThickThinSmallGap";n[n.ThinThickMediumGap=12]="ThinThickMediumGap";n[n.ThickThinMediumGap=13]="ThickThinMediumGap";n[n.ThinThickThinMediumGap=14]="ThinThickThinMediumGap";n[n.ThinThickLargeGap=15]="ThinThickLargeGap";n[n.ThickThinLargeGap=16]="ThickThinLargeGap";n[n.ThinThickThinLargeGap=17]="ThinThickThinLargeGap";n[n.SingleWavy=18]="SingleWavy";n[n.DoubleWavy=19]="DoubleWavy";n[n.DashDotStroked=20]="DashDotStroked";n[n.Emboss3D=21]="Emboss3D";n[n.Engrave3D=22]="Engrave3D";n[n.Outset=23]="Outset";n[n.Inset=24]="Inset";n[n.Thick=25]="Thick"}(i.LineStyle||(i.LineStyle={}));u=i.LineStyle,function(n){n[n.TextureNone=0]="TextureNone";n[n.Texture2Pt5Percent=35]="Texture2Pt5Percent";n[n.Texture5Percent=2]="Texture5Percent";n[n.Texture7Pt5Percent=36]="Texture7Pt5Percent";n[n.Texture10Percent=3]="Texture10Percent";n[n.Texture12Pt5Percent=37]="Texture12Pt5Percent";n[n.Texture15Percent=26]="Texture15Percent";n[n.Texture17Pt5Percent=39]="Texture17Pt5Percent";n[n.Texture20Percent=4]="Texture20Percent";n[n.Texture22Pt5Percent=40]="Texture22Pt5Percent";n[n.Texture25Percent=5]="Texture25Percent";n[n.Texture27Pt5Percent=41]="Texture27Pt5Percent";n[n.Texture30Percent=6]="Texture30Percent";n[n.Texture32Pt5Percent=42]="Texture32Pt5Percent";n[n.Texture35Percent=43]="Texture35Percent";n[n.Texture37Pt5Percent=44]="Texture37Pt5Percent";n[n.Texture40Percent=7]="Texture40Percent";n[n.Texture42Pt5Percent=45]="Texture42Pt5Percent";n[n.Texture45Percent=46]="Texture45Percent";n[n.Texture47Pt5Percent=47]="Texture47Pt5Percent";n[n.Texture50Percent=8]="Texture50Percent";n[n.Texture52Pt5Percent=48]="Texture52Pt5Percent";n[n.Texture55Percent=49]="Texture55Percent";n[n.Texture57Pt5Percent=50]="Texture57Pt5Percent";n[n.Texture60Percent=9]="Texture60Percent";n[n.Texture62Pt5Percent=51]="Texture62Pt5Percent";n[n.Texture65Percent=52]="Texture65Percent";n[n.Texture67Pt5Percent=53]="Texture67Pt5Percent";n[n.Texture70Percent=10]="Texture70Percent";n[n.Texture72Pt5Percent=54]="Texture72Pt5Percent";n[n.Texture75Percent=11]="Texture75Percent";n[n.Texture77Pt5Percent=55]="Texture77Pt5Percent";n[n.Texture80Percent=12]="Texture80Percent";n[n.Texture82Pt5Percent=56]="Texture82Pt5Percent";n[n.Texture85Percent=57]="Texture85Percent";n[n.Texture87Pt5Percent=58]="Texture87Pt5Percent";n[n.Texture90Percent=13]="Texture90Percent";n[n.Texture92Pt5Percent=59]="Texture92Pt5Percent";n[n.Texture95Percent=60]="Texture95Percent";n[n.Texture97Pt5Percent=61]="Texture97Pt5Percent";n[n.TextureSolid=1]="TextureSolid";n[n.TextureDarkHorizontal=14]="TextureDarkHorizontal";n[n.TextureDarkVertical=15]="TextureDarkVertical";n[n.TextureDarkDiagonalDown=16]="TextureDarkDiagonalDown";n[n.TextureDarkDiagonalUp=17]="TextureDarkDiagonalUp";n[n.TextureDarkCross=18]="TextureDarkCross";n[n.TextureDarkDiagonalCross=19]="TextureDarkDiagonalCross";n[n.TextureHorizontal=20]="TextureHorizontal";n[n.TextureVertical=21]="TextureVertical";n[n.TextureDiagonalDown=22]="TextureDiagonalDown";n[n.TextureDiagonalUp=23]="TextureDiagonalUp";n[n.TextureCross=24]="TextureCross";n[n.TextureDiagonalCross=25]="TextureDiagonalCross"}(i.TextureStyle||(i.TextureStyle={}));tf=i.TextureStyle,function(n){n[n.Auto=0]="Auto";n[n.Atleast=1]="Atleast";n[n.Exactly=2]="Exactly"}(i.HeightType||(i.HeightType={}));ot=i.HeightType,function(n){n[n.Top=0]="Top";n[n.Center=1]="Center";n[n.Bottom=2]="Bottom"}(i.CellVerticalAlignment||(i.CellVerticalAlignment={}));su=i.CellVerticalAlignment,function(n){n[n.EvenHeader=0]="EvenHeader";n[n.OddHeader=1]="OddHeader";n[n.EvenFooter=2]="EvenFooter";n[n.OddFooter=3]="OddFooter";n[n.FirstPageHeader=4]="FirstPageHeader";n[n.FirstPageFooter=5]="FirstPageFooter"}(i.HeaderFooterType||(i.HeaderFooterType={}));st=i.HeaderFooterType,function(n){n[n.Arabic=0]="Arabic";n[n.UpRoman=1]="UpRoman";n[n.LowRoman=2]="LowRoman";n[n.UpLetter=3]="UpLetter";n[n.LowLetter=4]="LowLetter";n[n.Ordinal=5]="Ordinal";n[n.Number=6]="Number";n[n.OrdinalText=7]="OrdinalText";n[n.LeadingZero=22]="LeadingZero";n[n.Bullet=23]="Bullet";n[n.FarEast=20]="FarEast";n[n.Special=58]="Special";n[n.None=255]="None"}(i.ListLevelPattern||(i.ListLevelPattern={}));y=i.ListLevelPattern,function(n){n[n.Tab=0]="Tab";n[n.Space=1]="Space";n[n.None=2]="None"}(i.FollowCharacterType||(i.FollowCharacterType={}));hu=i.FollowCharacterType,function(n){n[n.File=0]="File";n[n.Webpage=1]="Webpage";n[n.Email=2]="Email";n[n.Bookmark=3]="Bookmark"}(i.HyperlinkType||(i.HyperlinkType={}));ir=i.HyperlinkType,function(n){n[n.None=0]="None";n[n.WholeWord=1]="WholeWord";n[n.CaseSensitive=2]="CaseSensitive";n[n.CaseSensitiveWholeWord=3]="CaseSensitiveWholeWord"}(i.FindOptions||(i.FindOptions={}));br=i.FindOptions}(f||(f={}))})(jQuery,Syncfusion)});
