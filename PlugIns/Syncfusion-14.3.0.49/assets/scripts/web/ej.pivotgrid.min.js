/*!
*  filename: ej.pivotgrid.min.js
*  version : 14.3.0.49
*  Copyright Syncfusion Inc. 2001 - 2016. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.touch.min","./ej.button.min","./ej.waitingpopup.min","./ej.pivotpager.min","./ej.pivotanalysis.base.min","./ej.treeview.min","./ej.olap.base.min","./ej.pivot.common.min"],n):n()})(function(){(function(n,t,r){t.olap=t.olap||{};t.widget("ejPivotGrid","ej.PivotGrid",{_rootCSS:"e-pivotgrid",element:null,model:null,_requiresID:!0,validTags:["div","span"],defaults:{url:"",cssClass:"",jsonRecords:"",currentReport:"",layout:"normal",analysisMode:"olap",operationalMode:"clientmode",filterType:"filterType",enablePivotFieldList:!0,enableGroupingBar:!1,enableDeferUpdate:!1,enableJSONRendering:!1,enableVirtualScrolling:!1,enablePaging:!1,enableColumnResizing:!1,enableCellContext:!1,enableRTL:!1,enableToolTip:!0,enableToolTipAnimation:!0,enableCellSelection:!1,enableConditionalFormatting:!1,enableColumnGrandTotal:!0,enableRowGrandTotal:!0,enableGrandTotal:!0,enableCollapseByDefault:!1,enableCellDoubleClick:!1,enableDrillThrough:!1,isResponsive:!1,editCellsInfo:{},hyperlinkSettings:{enableValueCellHyperlink:!1,enableRowHeaderHyperlink:!1,enableColumnHeaderHyperlink:!1,enableSummaryCellHyperlink:!1},frozenHeaderSettings:{enableFrozenRowHeaders:!1,enableFrozenColumnHeaders:!1,enableFrozenHeaders:!1},serviceMethodSettings:{initialize:"InitializeGrid",drillDown:"DrillGrid",exportPivotGrid:"Export",paging:"Paging",fetchMembers:"FetchMembers",nodeStateModified:"NodeStateModified",nodeDropped:"NodeDropped",filtering:"Filtering",sorting:"Sorting",deferUpdate:"DeferUpdate",memberExpand:"MemberExpanded",writeBack:"WriteBack",cellEditing:"CellEditing",saveReport:"SaveReport",loadReport:"LoadReportFromDB",calculatedField:"CalculatedField",drillThroughHierarchies:"DrillThroughHierarchies",drillThroughDataTable:"DrillThroughDataTable"},customObject:{},locale:"en-US",dataSource:{data:null,enableAdvancedFilter:!1,reportName:"Default",columns:[],cube:"",catalog:"",rows:[],values:[],filters:[],pagerOptions:{categoricalPageSize:0,seriesPageSize:0,categoricalCurrentPage:0,seriesCurrentPage:0}},collapsedMembers:null,cellSelection:null,valueCellHyperlinkClick:null,rowHeaderHyperlinkClick:null,columnHeaderHyperlinkClick:null,summaryCellHyperlinkClick:null,beforeServiceInvoke:null,afterServiceInvoke:null,drillThrough:null,drillSuccess:null,cellContext:null,load:null,renderComplete:null,renderFailure:null,renderSuccess:null,cellDoubleClick:null,applyFieldCaption:null,beforeExport:null,beforePivotEnginePopulate:null,saveReport:null,loadReport:null,cellEdit:null},dataTypes:{serviceMethodSettings:"data",customObject:"data"},observables:["layout","enableCellContext","hyperlinkSettings.enableValueCellHyperlink","hyperlinkSettings.enableRowHeaderHyperlink","hyperlinkSettings.enableColumnHeaderHyperlink","hyperlinkSettings.enableSummaryCellHyperlink"],layout:t.util.valueFunction("layout"),enableCellContext:t.util.valueFunction("enableCellContext"),enableValueCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableValueCellHyperlink"),enableRowHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableRowHeaderHyperlink"),enableColumnHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableColumnHeaderHyperlink"),enableSummaryCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableSummaryCellHyperlink"),locale:t.util.valueFunction("locale"),getOlapReport:function(){return this._olapReport},setOlapReport:function(n){this._olapReport=n},getJSONRecords:function(){return this._JSONRecords},setJSONRecords:function(t){this._JSONRecords=n.parseJSON(t)},_init:function(){this._initPrivateProperties();this._load()},_destroy:function(){n(this.element).next().length>0&&n(this.element).next()[0].className=="pGridTooltip"&&n(this.element).next().remove();this.element.empty().removeClass("e-pivotgrid"+this.model.cssClass);this._waitingPopup!=r&&this._waitingPopup._destroy()},_initPrivateProperties:function(){this._id=this.element.attr("id");this._olapReport="";this._JSONRecords=null;this._excelLikeJSONRecords=null;this._drillCaption="";this._drillAction="";this._startDrilldown=!1;this._pagerObj=null;this._seriesPageCount=null;this._categPageCount=null;this._seriesCurrentPage=1;this._categCurrentPage=1;this._drillHeaders=[];this._collapsedRowHeaders=[];this._isDragging=!1;this._droppedClass="";this._dataModel="";this._ascdes="";this._filterUpdate=[];this._pivotRow=[];this._pivotColumn=[];this._pivotCalculation=[];this._pivotFilter=[];this._pivotTableFields=[];this._schemaData=null;this._waitingPopup=null;this._oriX=null;this._oriY=null;this._startPosCell=null;this._maxViewLoading=null;this._list=[];this._list.push(this._getLocalizedLabels("AddNew"));this._rowCount=0;this._excelRowCount=0;this._dialogTitle="";this._selectedField="";this._selectedAxis="";this._isUpdateRequired=!1;this._isMembersFiltered=!1;this._selectedCell=null;this._onholdKey="";this._primaryCellPos="";this._currentReportItems=[];this._rowHeader=[];this._colHeader=[];this._cellInfo=[];this._editorFlag=!0;this._isSubTotalHide=!1;this._isSubTotalhidden=!1;this._dimension;this._calculatedField=[];this._isFormatApply=!1;this._cFormat=[];this._curFocus={cell:null,tab:null,tree:null,cformat:null,grp:null,selection:null,filter:null,field:null,formula:null};this._index={index:0,grp:1,cell:1,dialog:1,paging:1,cformat:1,filter:0,field:0,formula:0};this._dataSet=[];this._currentCell=-1;this._target=null;this._orgX=null;this._orgY=null;this._expand=!1;this._pagingSavedObjects={drillEngine:[],savedHdrEngine:[],curDrilledItem:{}}},_load:function(){var u={element:this.element,customObject:this.model.customObject},i,r;this._trigger("load",u);this.element.addClass(this.model.cssClass);n(this.element).parents(".e-pivotclient").length>0?(i=n(this.element).parents(".e-pivotclient").data("ejPivotClient"),n("#"+i._id+"_maxView")[0]&&n("#"+i._id+"_maxView").ejWaitingPopup({showOnInit:!0}),t.isNullOrUndefined(this._waitingPopup)&&!t.isNullOrUndefined(i._waitingPopup)&&(this._waitingPopup=i._waitingPopup),this._waitingPopup.show()):t.isNullOrUndefined(this._waitingPopup)&&(n("#"+this._id).ejWaitingPopup({showOnInit:!0}),this._waitingPopup=n("#"+this._id).data("ejWaitingPopup"));this._waitingPopup.show();this.model.enableJSONRendering?(this.setJSONRecords(this.model.jsonRecords),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON()):t.isNullOrUndefined(this.model.dataSource.data)&&this.model.url==""&&typeof oclientProxy=="undefined"?(this.renderControlFromJSON(),this._waitingPopup.hide()):this.model.dataSource.data==null&&this.model.url!=""||this.model.dataSource.data!=null&&this.model.url!=""&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(this.model.operationalMode=t.Pivot.OperationalMode.ServerMode,t.isNullOrUndefined(this.model.beforeServiceInvoke)||this._trigger("beforeServiceInvoke",{action:"initialize",element:this.element,customObject:this.model.customObject}),r=JSON.stringify(this.model.customObject),this.model.enableVirtualScrolling&&(this.model.layout=t.PivotGrid.Layout.NoSummaries),this.element[0]!=null&&this.element.parents().find(".controlPanel").length>0&&this.layout()!=""&&this.layout()!=t.PivotGrid.Layout.Normal?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",currentReport:this.model.currentReport,gridLayout:this.layout(),customObject:r}),this._renderControlSuccess):this.element[0]!=null&&this.element.parents().find(".controlPanel").length>0?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:this.model.enableCellDoubleClick?"initializeGrid:getDataSet":"initializeGrid",currentReport:this.model.currentReport,customObject:r}),this._renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:this.model.enableCellDoubleClick?"initializeGrid:getDataSet":"initializeGrid",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,customObject:r}),this._renderControlSuccess)):(this.model.operationalMode=t.Pivot.OperationalMode.ClientMode,this.model.dataSource.cube!=""?(this.model.analysisMode=t.Pivot.AnalysisMode.Olap,this._trigger("beforePivotEnginePopulate",{pivotGridObj:this}),t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)):this.model.dataSource.data!=null&&(this.model.analysisMode=t.Pivot.AnalysisMode.Pivot,t.PivotAnalysis.setFieldCaptions(this.model.dataSource),this._populatePivotGrid()))},refreshControl:function(){if(this.model.enableGroupingBar&&this._createGroupingBar(this.model.dataSource),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){var n=t.PivotAnalysis.pivotEnginePopulate(this.model);this.setJSONRecords(JSON.stringify(n.json));this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(n.json):this.renderControlFromJSON(n.json)}else t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)},_setCaptions:function(){n.each(this.model.dataSource.rows,function(n,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)});n.each(this.model.dataSource.columns,function(n,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)});n.each(this.model.dataSource.filters,function(n,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)});n.each(this.model.dataSource.values,function(n,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)})},refreshFieldCaption:function(n,t,i){var r;if(i.indexOf("row")>=0)for(r=0;r<this.model.dataSource.rows.length;r++)n==this.model.dataSource.rows[r].fieldName&&(this.model.dataSource.rows[r].fieldCaption=t);else if(i.indexOf("calc")>=0)for(r=0;r<this.model.dataSource.values.length;r++)n==this.model.dataSource.values[r].fieldName&&(this.model.dataSource.values[r].fieldCaption=t);else if(i.indexOf("col")>=0)for(r=0;r<this.model.dataSource.columns.length;r++)n==this.model.dataSource.columns[r].fieldName&&(this.model.dataSource.columns[r].fieldCaption=t);else for(r=0;r<this.model.dataSource.filters.length;r++)n==this.model.dataSource.filters[r].fieldName&&(this.model.dataSource.filters[r].fieldCaption=t);for(r=0;r<this._pivotTableFields.length;r++)n==this._pivotTableFields[r].name&&(this._pivotTableFields[r].caption=t)},refreshPivotGrid:function(){this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(this.getOlapReport()&&(this.model.dataSource.rows&&(this.model.dataSource.rows=this.getOlapReport().rows),this.model.dataSource.columns&&(this.model.dataSource.columns=this.getOlapReport().columns),this.model.dataSource.filters&&(this.model.dataSource.filters=this.getOlapReport().filters),this.model.dataSource.values&&(this.model.dataSource.values=this.getOlapReport().values)),this.model.editCellsInfo={},this._populatePivotGrid()):(this._trigger("beforePivotEnginePopulate",{olapObject:this}),t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)):this._load()},_populatePivotGrid:function(){var u,r,i,f;for(this._trigger("beforePivotEnginePopulate",{pivotObject:this}),u=n.grep(this.model.dataSource.values,function(n){return n.isCalculatedField==!0}),this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1}),r=0;r<u.length;r++)i=u[r].formula,n.grep(this._calculatedField,function(n){return n.name==u[r].fieldName}).length==0&&(i=i.replace(/\s+|\s+$/gm,""),i=this._parenthesisAsterisk(i),i=i.replace(/[-+/^%*]/g,function(n){return" "+n+" "}),this._calculatedField.push({name:u[r].fieldName,formula:i})),u[r].formula=i,this.model.dataSource.values.push(u[r]);f=t.PivotAnalysis.pivotEnginePopulate(this.model);this.setJSONRecords(JSON.stringify(f.json));this._createGroupingBar(this.model.dataSource);this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(f.json):this.renderControlFromJSON();this._waitingPopup.hide();this._trigger("renderSuccess",this);this._schemaData!=null&&(pschemaDesignerWaitingPopup.hide(),this._calculatedField.length>0&&this._schemaCalculatedField())},_setFirst:!0,_setModel:function(n){for(var t in n)switch(t){case"OlapReport":this.setOlapReport(n[t]);break;case"JsonData":this.setOlapReport(n[t]);break;case"RefreshOlapGrid":this.element.renderControlFromJSON(n[t]);break;case"layout":this._load();break;case"customObject":this.model.customObject=n[t];break;case"enableCellContext":this._load();break;case"enableValueCellHyperlink":this._load();break;case"enableRowHeaderHyperlink":this._load();break;case"enableColumnHeaderHyperlink":this._load();break;case"enableSummaryCellHyperlink":this._load();break;case"locale":this._load()}},_wireEvents:function(){if(this._on(this.element,"mouseover",".value,.rowheader,.colheader,.summary",t.proxy(function(t){if(!n(t.target).hasClass("cellValue")&&!n(t.target).children().hasClass("cellValue")){var i=n(t.target).contents().filter(function(){return this.nodeType==3});i.text()!=0&&(n(t.target).contents().filter(function(){return this.nodeType==3}).remove(),n(t.target).append("<span class='cellValue'>"+i.text()+"<\/span>"))}})),this._on(n(document),"keydown",this._keyDownPress),this._on(n(document),"keyup",this._keyUpPress),this.model.enableCellSelection&&(this._on(this.element,"mousedown touchstart",".value",this._initCellSelection),this._on(this.element,"click",".colheader,.rowheader",this._headerClickCellSelection)),this.enableCellContext()==!0&&(document.addEventListener?(document.removeEventListener("contextmenu",this._cellContext,!1),document.addEventListener("contextmenu",this._cellContext,!1)):(document.detachEvent("oncontextmenu",this._cellContext),document.attachEvent("oncontextmenu",this._cellContext))),this._on(this.element,"mouseover",".pivotButton",t.proxy(function(i){this._isDragging&&(this.element.append(t.buildTag("span.dropIndicator dropIndicatorActive")[0].outerHTML),i.target.className.indexOf("pivotButton")>=0?this.element.find(".dropIndicator").css("top",n(i.target).position().top-20).css("left",n(i.target).position().left-3):this.element.find(".dropIndicator").css("top",n(i.target).parents(".pivotButton").position().top-20).css("left",n(i.target).parents(".pivotButton").position().left-3))},this)),this._on(this.element,"mouseleave",".pivotButton",t.proxy(function(){this._isDragging&&this.element.find(".dropIndicator").removeClass("dropIndicatorActive")},this)),this.model.enableCellEditing&&this._on(this.element,"mousedown",".value",this._initCellEditing),this.drillDownHandler=n.proxy(this._drillDown,this),this.addHyperlinkHandler=n.proxy(this._addHyperlink,this),this.removeHyperlinkHandler=n.proxy(this._removeHyperlink,this),this.model.enableCellSelection){n(document).on("click",this._clearSelection);n(document).on("keyup",this._endCellSelection);n(document).on("keydown",this._startCellSelection)}this._on(this.element,"mouseover",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",this.addHyperlinkHandler);this._on(this.element,"mouseleave",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",this.removeHyperlinkHandler);this._on(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",function(i){if(i.target.className.indexOf("hyperlink")!=-1){var r=this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?n(i.target.parentElement).attr("i"):n(i.target.parentElement).attr("p"),f=this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelLikeJSONRecords[parseInt(parseInt(r.split(",")[0])*this._rowCount+parseInt(r.split(",")[1]))].Info:this.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*this._excelRowCount+parseInt(r.split(",")[1]))].Info,u={cellValue:i.target.innerHTML,cellPosition:r,cellType:i.target.parentElement.className.split(" ")[0],uniqueName:f.split("::")[0],args:i,rawdata:f};this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&i.target.parentElement.className.indexOf("summary")>=0||i.target.parentElement.className.indexOf("summary value")>=0?this._trigger("summaryCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:u}):i.target.parentElement.className.indexOf("value")>=0?this._trigger("valueCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:u}):i.target.parentElement.className.indexOf("rowheader")>=0?this._trigger("rowHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:u}):i.target.parentElement.className.indexOf("colheader")>=0&&this._trigger("columnHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:u});i.target.parentElement.className.indexOf("value")>=0&&this.model.enableDrillThrough&&this._drillThroughCellClick(i)}});this._on(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?".rowheader, .colheader, .summary":".rowheader, .colheader",function(i){var r,e,s,o,h,u,c,f;if(this.model.enableCellSelection&&!(n(i.target).hasClass("cellValue")&&n(i.target).hasClass("hyperlinkHeaderCell")))if(r=n(i.target).hasClass("cellValue")?i.target.parentElement:i.target,i.shiftKey){if(window.getSelection().removeAllRanges(),n(this.element).find(".selected").removeClass("selected"),e=n(this._selectedCell).attr("p"),s=n(r).attr("p"),(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader")&&(n(this._selectedCell).hasClass("rowheader")||n(this._selectedCell).attr("role")=="rowheader"))for(u=Math.min(e.split(",")[1],s.split(",")[1]);u<=Math.max(e.split(",")[1],s.split(",")[1]);u++)this.element.find("[p='"+e.split(",")[0]+","+u+"']").addClass("selected");if((n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(n(this._selectedCell).hasClass("colheader")||n(this._selectedCell).attr("role")=="columnheader"))for(u=Math.min(e.split(",")[0],s.split(",")[0]);u<=Math.max(e.split(",")[0],s.split(",")[0]);u++)this.element.find("[p='"+u+","+e.split(",")[1]+"']").addClass("selected");if(o=n(this.element).find(".selected"),o.length>0){for(h=[],u=0;u<o.length;u++)c=n(o[u]).attr("p"),f=this.getJSONRecords()[parseInt(parseInt(c.split(",")[0])*this._rowCount+parseInt(c.split(",")[1]))],f.Value=n(o[u]).text().trim(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(f.Field=this._getFieldName(o[u])),h.push(f);this._trigger("cellSelection",{JSONRecords:h})}}else i.ctrlKey||n(this.element).find(".selected").removeClass("selected"),(n(r).hasClass("colheader")||n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).attr("role")=="columnheader")&&(i.ctrlKey?n(r).toggleClass("selected"):n(r).addClass("selected"),this._selectedCell=r,this._primaryCellPos=n(r).attr("p"),f=this.getJSONRecords()[parseInt(parseInt(this._primaryCellPos.split(",")[0])*this._rowCount+parseInt(this._primaryCellPos.split(",")[1]))],f.Value=n(r).text().trim(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(f.Field=this._getFieldName(r)),i.ctrlKey||this._trigger("cellSelection",{JSONRecords:[f]}))});typeof oclientProxy!="undefined"?oclientProxy.model.enableDeferUpdate||this._on(this.element,"click",".expand, .collapse",t.proxy(this._drillDown,this)):this._on(this.element,"click",".expand, .collapse",t.proxy(this._drillDown,this));this._on(this.element,"mouseover",".colheader, .rowheader, .expand, .collapse",function(t){if(t.target.className.indexOf("expand")>-1&&!n(t.target).hasClass("header-hover-expand"))n(t.target).addClass("header-hover-expand");else if(t.target.className.indexOf("collapse")>-1&&!n(t.target).hasClass("header-hover-collapse"))n(t.target).addClass("header-hover-collapse");else if((t.target.className.indexOf("expand")<0||t.target.className.indexOf("collapse")<0)&&n(t.target).children("span").length>0){var i=n(t.target).children("span")[0];!n(i).hasClass("header-hover-expand")&&i.className.indexOf("expand")>-1?n(i).addClass("header-hover-expand"):!n(i).hasClass("header-hover-collapse")&&i.className.indexOf("collapse")>-1&&n(i).addClass("header-hover-collapse")}});this._on(this.element,"mouseleave",".colheader, .rowheader, .expand, .collapse",function(){this.element.find(".expand, .collapse").removeClass("header-hover-expand header-hover-collapse")});this.model.enableToolTip&&(this._on(this.element,"mouseover",".value",this._applyToolTip),this._on(this.element,"mouseleave",".value",function(){this.model.enableToolTipAnimation?n("#"+this._id+"_gridTooltip").hide("slow"):n("#"+this._id+"_gridTooltip").hide()}));this.model.enableDrillThrough&&n.proxy(this._addHyperlink,this);this._on(this.element,"click",".filter",t.proxy(this._filterBtnClick,this));this._on(this.element,"click",".sorting",t.proxy(this._sortBtnClick,this));this._on(this.element,"click",".removeBtn",t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._removePvtBtn:this._clientRemovePvtBtn,this));this._on(this.element,"click",".ascOrder, .descOrder",t.proxy(this._sortDimensionElement,this));this._on(this.element,"mouseover",".pvtBtn",function(t){n(t.target.parentElement).addClass("e-btn e-select")});this._on(this.element,"mouseleave",".pvtBtn",function(t){n(t.target.parentElement).removeClass("e-btn e-select");n(t.target).removeClass("hoverBtn")});this._on(this.element,"mouseover",".pivotButton",function(t){t.target.title=t.target.textContent;n(t.target).find("button").addClass("hoverBtn")});this._on(this.element,"mouseleave",".pivotButton",function(t){n(t.target).find("button").removeClass("hoverBtn")});this._on(this.element,"mouseover",".filter,.sorting,.removeBtn",function(t){n(t.target.parentElement).find("button").addClass("hoverBtn")});this._on(this.element,"mouseleave",".filter,.sorting,.removeBtn",function(t){n(t.target.parentElement).find("button").removeClass("hoverBtn")});this._on(this.element,"mouseleave",".value,.rowheader,.colheader,.summary",t.proxy(function(t){var i=n(t.target).find(".cellValue").contents().filter(function(){return this.nodeType==3});i.text()!=0&&(n(t.target).find(".cellValue").remove(),n(t.target).append(i.text()))}));this.model.enableColumnResizing&&(this._on(this.element,"mousemove",t.proxy(function(n){this._colResizing(n)})),this._on(this.element,"mousedown","thead,.pivotGridFrozenTable,.pivotGridColValueTable",t.proxy(function(n){this._startColResizing(n)})),this._on(this.element,"mouseup",t.proxy(function(n){this._endColResizing(n)})))},_keyUpPress:function(n){n.which===16&&this.model.enableCellSelection&&(this._completeCellSelection(n),this.element.find(".value").removeClass("hoverCell"),this._startPosCell=null,_startPosCell=null)},_keyDownPress:function(i){var c,f,u,o,r,s,e,v,a,l;if(n(".e-pivotpager[targetcontrolid='"+this._id+"']:visible").length>0&&((document.activeElement.id=="Pager_CategCurrentPage"||document.activeElement.id=="Pager_SeriesCurrentPage")&&(i.which===35?(i.preventDefault(),document.activeElement.id=="Pager_CategCurrentPage"?n(".e-pivotpager[targetcontrolid='"+this._id+"'] .moveLast").first().trigger("click"):document.activeElement.id=="Pager_SeriesCurrentPage"&&n(".e-pivotpager[targetcontrolid='"+this._id+"'] .moveLast").last().trigger("click")):i.which==36&&(i.preventDefault(),document.activeElement.id=="Pager_CategCurrentPage"?n(".e-pivotpager[targetcontrolid='"+this._id+"'] .moveFirst").first().trigger("click"):document.activeElement.id=="Pager_SeriesCurrentPage"&&n(".e-pivotpager[targetcontrolid='"+this._id+"'] .moveFirst").last().trigger("click")),i.which===39?document.activeElement.id=="Pager_CategCurrentPage"?n(".e-pivotpager[targetcontrolid='"+this._id+"'] .moveNext").first().trigger("click"):document.activeElement.id=="Pager_SeriesCurrentPage"&&n(".e-pivotpager[targetcontrolid='"+this._id+"'] .moveNext").last().trigger("click"):i.which===37&&(document.activeElement.id=="Pager_CategCurrentPage"?n(".e-pivotpager[targetcontrolid='"+this._id+"'] .movePrevious").first().trigger("click"):document.activeElement.id=="Pager_SeriesCurrentPage"&&n(".e-pivotpager[targetcontrolid='"+this._id+"'] .movePrevious").last().trigger("click"))),i.stopImmediatePropagation()),i.which!==27||t.isNullOrUndefined(this._curFocus.grp)&&(t.isNullOrUndefined(this._curFocus.tab)||!this._curFocus.tab.hasClass("pivotButton"))?i.which===27&&(this._index.dialog=0):(this._curFocus.tab.mouseleave().removeClass("hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("pivotButton")&&(l=this._curFocus.tab.attr("tag"),a=this._curFocus.tab=this.element.find("[tag='"+l+"']")):(l=this._curFocus.grp.attr("tag"),a=this._curFocus.grp=this.element.find("[tag='"+l+"']")),a.mouseover().addClass("hoverCell").focus(),this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._index.field=0),i.which===70&&i.ctrlKey&&(i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".filter").click():this._curFocus.grp.find(".filter").click()),i.which===83&&i.ctrlKey&&(i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(this._curFocus.tab.find(".sorting").click(),l=this._curFocus.tab.attr("tag"),a=this._curFocus.tab=this.element.find("[tag='"+l+"']")):(this._curFocus.grp.find(".sorting").click(),l=this._curFocus.grp.attr("tag"),a=this._curFocus.grp=this.element.find("[tag='"+l+"']")),a.mouseover().addClass("hoverCell").focus()),(i.which===46||i.which===82&&i.ctrlKey)&&(i.which!=46&&i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".removeBtn").click():this._curFocus.grp.find(".removeBtn").click()),i.shiftKey&&t.isNullOrUndefined(this._startPosCell)&&(_startPosCell=i.target.getAttribute("p"),this._startPosCell=i.target.getAttribute("p")),i.which===39&&this.element.find(".e-dialog .hoverCell").length>0?this.element.find(".e-dialog .hoverCell").parent().find(".e-plus").click():i.which===37&&this.element.find(".e-dialog .hoverCell").length>0&&this.element.find(".e-dialog .hoverCell").parent().find(".e-minus").click(),(i.which===40||i.which===39||i.which===38||i.which===37)&&i.shiftKey&&this.model.enableCellSelection){if(this.element.find(".hoverCell").removeClass("hoverCell"),t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.attr("tabindex","0"),c=n(i.target),i.which=="40")for(f=c.attr("p"),u=parseInt(f.split(",")[1])+Number(c.attr("rowspan"));t.isNullOrUndefined(o)&&u<this._rowCount;)r=n(this.element).find("[p='"+f.split(",")[0]+","+u+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r),this._curFocus.selection=n(o),u++;else if(i.which=="38")for(f=c.attr("p"),u=parseInt(f.split(",")[1])-1;t.isNullOrUndefined(o)&&u>=0;)r=n(this.element).find("[p='"+f.split(",")[0]+","+u+"']")[0],t.isNullOrUndefined(r)&&(r=n(this.element).find("[p='"+(parseInt(f.split(",")[0])-1)+","+u+"']")[0]),!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r),this._curFocus.selection=n(o),u--;else if(i.which=="39")for(f=c.attr("p"),u=parseInt(f.split(",")[0])+Number(c.attr("colspan"));t.isNullOrUndefined(o)&&u<Math.ceil(this.getJSONRecords().length/this._rowCount);)r=n(this.element).find("[p='"+u+","+f.split(",")[1]+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r),this._curFocus.selection=n(o),u++;else if(i.which=="37"){for(var f=c.attr("p"),u=parseInt(f.split(",")[0])-1,o=n(this.element).find("[p='"+(parseInt(f.split(",")[0])-1)+","+f.split(",")[1]+"']")[0];t.isNullOrUndefined(o)&&u>=0;)r=n(this.element).find("[p='"+u+","+f.split(",")[1]+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r),u--;this._curFocus.selection=n(o)}if(this._curFocus.selection.attr("tabindex","-1").focus().addClass("hoverCell"),Number(_startPosCell.split(",")[0])<=Number(this._curFocus.selection.attr("p").split(",")[0])&&Number(_startPosCell.split(",")[1])<=Number(this._curFocus.selection.attr("p").split(",")[1]))for(u=Number(_startPosCell.split(",")[0]);u<=Number(this._curFocus.selection.attr("p").split(",")[0]);u++)for(h=Number(_startPosCell.split(",")[1]);h<=Number(this._curFocus.selection.attr("p").split(",")[1]);h++)this.element.find("[p='"+u+","+h+"']").hasClass("value")&&this.element.find("[p='"+u+","+h+"']").addClass("hoverCell");else if(Number(_startPosCell.split(",")[0])>=Number(this._curFocus.selection.attr("p").split(",")[0])&&Number(_startPosCell.split(",")[1])>=Number(this._curFocus.selection.attr("p").split(",")[1]))for(u=Number(_startPosCell.split(",")[0]);u>=Number(this._curFocus.selection.attr("p").split(",")[0]);u--)for(h=Number(_startPosCell.split(",")[1]);h>=Number(this._curFocus.selection.attr("p").split(",")[1]);h--)this.element.find("[p='"+u+","+h+"']").hasClass("value")&&this.element.find("[p='"+u+","+h+"']").addClass("hoverCell");else if(Number(_startPosCell.split(",")[0])<=Number(this._curFocus.selection.attr("p").split(",")[0])&&Number(_startPosCell.split(",")[1])>=Number(this._curFocus.selection.attr("p").split(",")[1]))for(u=Number(_startPosCell.split(",")[0]);u<=Number(this._curFocus.selection.attr("p").split(",")[0]);u++)for(h=Number(_startPosCell.split(",")[1]);h>=Number(this._curFocus.selection.attr("p").split(",")[1]);h--)this.element.find("[p='"+u+","+h+"']").hasClass("value")&&this.element.find("[p='"+u+","+h+"']").addClass("hoverCell");else if(Number(_startPosCell.split(",")[0])>=Number(this._curFocus.selection.attr("p").split(",")[0])&&Number(_startPosCell.split(",")[1])<=Number(this._curFocus.selection.attr("p").split(",")[1]))for(u=Number(_startPosCell.split(",")[0]);u>=Number(this._curFocus.selection.attr("p").split(",")[0]);u--)for(h=Number(_startPosCell.split(",")[1]);h<=Number(this._curFocus.selection.attr("p").split(",")[1]);h++)this.element.find("[p='"+u+","+h+"']").hasClass("value")&&this.element.find("[p='"+u+","+h+"']").addClass("hoverCell")}else if((i.which===40||i.which===38||i.which===37||i.which===39)&&this.element.find(".calcFormulaDiv:visible").length>0)i.preventDefault(),s=this.element.find(".calcFormulaDiv td:visible"),t.isNullOrUndefined(this._curFocus.formula)?(this._index.formula=i.which==39?0:i.which==37?s.length-1:0,this._curFocus.formula=s.eq(this._index.formula).addClass("hoverCell").mouseover()):(this._curFocus.formula.removeClass("hoverCell").mouseleave(),i.which===39?this._index.formula=this._index.formula+1>s.length-1?0:this._index.formula+1:i.which===37?this._index.formula=this._index.formula-1<0?s.length-1:this._index.formula-1:i.which===40?this._index.formula=this._index.formula+4>s.length-1?(this._index.formula+4)%10:this._index.formula+4:i.which===38&&(this._index.formula=this._index.formula-4<0?this._index.formula- -16:this._index.formula-4),this._curFocus.formula=s.eq(this._index.formula).addClass("hoverCell").mouseover());else if((i.keyCode===40||i.which===38)&&this.element.find(".e-dialog:visible").length>0&&!t.isNullOrUndefined(this.element.find(".e-dialog .e-text"))&&n(".e-dialog .e-text").hasClass("hoverCell"))this.element.find(".e-dialog .hoverCell").removeClass("hoverCell"),i.preventDefault(),s=this.element.find(".e-dialog .e-text:visible"),t.isNullOrUndefined(this._curFocus.filter)?(this._index.filter=i.which==40?1:i.which==38?s.length-1:0,this._curFocus.filter=s.eq(this._index.filter).attr("tabindex","-1")):(this._curFocus.filter.attr("tabindex","0").removeClass("hoverCell"),i.which===40?this._index.filter=this._index.filter+1>s.length-1?0:this._index.filter+1:i.which===38&&(this._index.filter=this._index.filter-1<0?s.length-1:this._index.filter-1),this._curFocus.filter=s.eq(this._index.filter).attr("tabindex","-1")),this._curFocus.filter.focus().addClass("hoverCell"),n(".e-node-focus").removeClass("e-node-focus");else if((i.which===40||i.which===38||i.which===37||i.which===39)&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("pivotButton")&&!n(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&!this.element.find(".e-dialog:visible").length>0)i.preventDefault(),t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().attr("tabindex","0").removeClass("hoverCell"),s=this.element.find(".pivotButton"),t.isNullOrUndefined(this._curFocus.grp)?i.which===40||i.which===39?this._curFocus.grp=s.eq(1).attr("tabindex","-1"):(i.which===38||i.which===37)&&(this._curFocus.grp=s.eq(s.length-1).attr("tabindex","-1")):(this._curFocus.grp.attr("tabindex","0").removeClass("hoverCell").mouseleave(),i.which===40||i.which===39?this._index.grp=this._index.grp+1>s.length-1?0:this._index.grp+1:(i.which===38||i.which===37)&&(this._index.grp=this._index.grp-1<0?s.length-1:this._index.grp-1),this._curFocus.grp=s.eq(this._index.grp)),this._curFocus.grp.addClass("hoverCell").mouseover().focus();else if((i.which===40||i.which===38||i.which===37||i.which===39)&&!n(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&(document.activeElement.getAttribute("role")=="columnheader"||document.activeElement.getAttribute("role")=="rowheader"||document.activeElement.getAttribute("role")=="gridcell")){if(t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.attr("tabindex","0"),t.isNullOrUndefined(this._curFocus.cell)||(this._curFocus.cell.attr("tabindex","0").removeClass("hoverCell"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&this._curFocus.cell.find("span").mouseleave()),this._index.menu=0,this._curFocus.cmenu=null,c=n(i.target),i.which=="40")for(f=c.attr("p"),u=parseInt(f.split(",")[1])+Number(c.attr("rowspan"));t.isNullOrUndefined(o)&&u<=this._rowCount;){if(r=n("#"+this._id).find("[p='"+f.split(",")[0]+","+u+"']")[0],t.isNullOrUndefined(r))for(k=parseInt(f.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[p='"+k+","+u+"']")[0]);!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r);t.isNullOrUndefined(o)||(this._curFocus.cell=n(o));u++}else if(i.which=="38")for(var f=c.attr("p"),u=parseInt(f.split(",")[1])-1,o,h=parseInt(f.split(",")[0]);t.isNullOrUndefined(o)&&u>=0;){if(r=n("#"+this._id).find("[p='"+f.split(",")[0]+","+u+"']")[0],t.isNullOrUndefined(r)&&(c.attr("role")=="gridcell"||c.hasClass("summary")&&c.hasClass("calc")))for(k=parseInt(f.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[p='"+h+","+k+"']")[0]);if(t.isNullOrUndefined(r))for(k=parseInt(f.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[p='"+k+","+u+"']")[0]);!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r);t.isNullOrUndefined(o)||n(o).hasClass("grpRow")||(this._curFocus.cell=n(o));u--;h--}else if(i.which=="39")for(f=c.attr("p"),u=parseInt(f.split(",")[0])+Number(c.attr("colspan"));t.isNullOrUndefined(o)&&u<=Math.ceil((Number(this.element.find(".pivotGridTable td:last").attr("p").split(",")[0])+1)*(Number(this.element.find(".pivotGridTable td:last").attr("p").split(",")[1])+1)/this._rowCount);){if(r=n("#"+this._id).find("[p='"+u+","+f.split(",")[1]+"']")[0],t.isNullOrUndefined(r))for(k=parseInt(f.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[p='"+u+","+k+"']")[0]);!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r);t.isNullOrUndefined(o)||(this._curFocus.cell=n(o));u++}else if(i.which=="37"){for(var f=c.attr("p"),u=parseInt(f.split(",")[0])-1,o=n("#"+this._id).find("[p='"+(parseInt(f.split(",")[0])-1)+","+f.split(",")[1]+"']")[0],h=parseInt(f.split(",")[1]);t.isNullOrUndefined(o)&&u>=0;){if(r=n("#"+this._id).find("[p='"+u+","+f.split(",")[1]+"']")[0],t.isNullOrUndefined(r)&&c.attr("role")=="gridcell")for(k=parseInt(f.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[p='"+k+","+h+"']")[0]);if(t.isNullOrUndefined(r))for(k=parseInt(f.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[p='"+u+","+k+"']")[0]);!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r);u--;h--}t.isNullOrUndefined(o)||n(o).hasClass("grpRow")||(this._curFocus.cell=n(o))}t.isNullOrUndefined(this._curFocus.cell)||(n(".hoverCell").removeClass("hoverCell"),this._curFocus.cell.attr("tabindex","-1").focus().addClass("hoverCell"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&(this._curFocus.cell.mouseover(),this._curFocus.cell.find("span").mouseover()))}i.which===9&&this.element.find(".colheader.hoverCell")&&(this._curFocus.cell=this.element.find(".colheader.hoverCell"));(i.which===9&&i.shiftKey||i.which===9)&&this.element.find("#"+this._id+"_clientDlg_wrapper :visible").length>0?(i.preventDefault(),s=n("#"+this._id+"_editCon_hidden").hasClass("e-disable")||n("#"+this._id+"_conTo").attr("disabled")=="disabled"?n("#"+this._id+"_conTo").attr("disabled")!="disabled"?this.element.find("#"+this._id+"_conType_wrapper,#"+this._id+"_conFrom,#"+this._id+"_conTo,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):n("#"+this._id+"_editCon_hidden").hasClass("e-disable")?this.element.find("#"+this._id+"_conType_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):this.element.find("#"+this._id+"_conType_wrapper,#"+this._id+"_editCon_wrapper,#"+this._id+"_removeBtn,#"+this._id+"_conFrom,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):this.element.find("#"+this._id+"_conType_wrapper,#"+this._id+"_editCon_wrapper,#"+this._id+"_removeBtn,#"+this._id+"_conFrom,#"+this._id+"_conTo,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"),t.isNullOrUndefined(this._curFocus.cformat)?(this._index.cformat=1,this._curFocus.cformat=s.eq(this._index.cformat).attr("tabindex","-1")):(this._curFocus.cformat.attr("tabindex","0").removeClass("hoverCell"),i.which===9&&i.shiftKey?this._index.cformat=this._index.cformat-1<0?s.length-1:this._index.cformat-1:i.which===9&&(this._index.cformat=this._index.cformat+1>s.length-1?0:this._index.cformat+1),this._curFocus.cformat=s.eq(this._index.cformat).attr("tabindex","-1")),this._curFocus.cformat.focus().addClass("hoverCell")):(i.which===9&&i.shiftKey||i.which===9)&&n("#"+this._id).find(".dlgCalculatedField:visible").length>0?(i.preventDefault(),n("#"+this._id).find(".calcFormulaDiv:visible").length>0&&n("#"+this._id).find(".calcFormulaDiv").css("display","none"),e=[],e.push(n("#"+this._id).find("#"+this._id+"_calculateFieldName:visible")),e.push(n("#"+this._id).find("#"+this._id+"_calculateFieldList_dropdown:visible")),e.push(n("#"+this._id).find(".calculatorFields:visible")),e.push(n("#"+this._id).find(".editFormula:visible")),e.push(n("#"+this._id).find("#"+this._id+"_fieldCollection_container:visible")),n("#"+this._id).find("#"+this._id+"_btnInsert:visible:not([aria-disabled='true'])").length>0&&e.push(n("#"+this._id).find("#"+this._id+"_btnInsert:visible:not([aria-disabled='true'])")),e.push(n("#"+this._id).find("#"+this._id+"_btnAdd:visible")),e.push(n("#"+this._id).find("#"+this._id+"_btnDelete:visible")),e.push(n("#"+this._id).find("#"+this._id+"_btnOk:visible")),e.push(n("#"+this._id).find("#"+this._id+"_btnCancel:visible")),t.isNullOrUndefined(this._curFocus.field)?(this._index.field=e.length>5?6:0,this._curFocus.field=e[this._index.field].attr("tabindex","-1")):(this._curFocus.field.attr("tabindex","0").removeClass("hoverCell").blur(),i.which===9&&i.shiftKey?this._index.field=this._index.field-1<0?e.length-1:this._index.field-1:i.which===9&&(this._index.field=this._index.field+1>e.length-1?0:this._index.field+1),this._curFocus.field=e[this._index.field].attr("tabindex","-1")),this._curFocus.field.focus().addClass("hoverCell")):(i.which===9&&i.shiftKey||i.which===9)&&this.element.find(".e-dialog:visible").length>0?(i.preventDefault(),this.element.find(".e-dialog .hoverCell").removeClass("hoverCell"),this._curFocus.filter=null,this._index.filter=0,e=n("#"+this._id).find(".dialogOKBtn:visible:not([aria-disabled='true']),.dialogCancelBtn:visible,.e-close:visible,#GroupLabelDrop_wrapper:visible,.ascOrder:visible,.descOrder:visible,.clearSorting:visible:not([disabled='disabled']),.clearAllFilters:visible:not([disabled='disabled']),#labelFilterBtn:visible,#valueFilterBtn:visible,.e-dialog .e-text:visible:first,.filterValues:visible,#filterMeasures_wrapper:visible,#filterOptions_wrapper:visible,#filterValue1:visible,#filterValue2:visible"),t.isNullOrUndefined(this._curFocus.tree)?(this._index.dialog=this.model.dataSource.enableAdvancedFilter?1:2,this._curFocus.tree=e.eq(this._index.dialog).attr("tabindex","-1").focus()):(this._curFocus.tree.attr("tabindex","0").removeClass("hoverCell"),i.which===9&&i.shiftKey?this._index.dialog=this._index.dialog-1<0?e.length-1:this._index.dialog-1:i.which===9&&(this._index.dialog=this._index.dialog+1>e.length-1?0:this._index.dialog+1),this._curFocus.tree=e.eq(this._index.dialog).attr("tabindex","-1").focus()),this._curFocus.tree.hasClass("filterElementTag")?this._curFocus.tree.find(".e-list:visible").addClass("hoverCell"):this._curFocus.tree.addClass("hoverCell")):(i.which===9&&i.shiftKey||i.which===9)&&!n(".e-dialog:visible").length>0&&typeof oclientProxy=="undefined"&&(i.preventDefault(),n("#"+this._id).find(".hoverCell").removeClass("hoverCell"),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".hoverCell").removeClass("hoverCell"),t.isNullOrUndefined(this._curFocus.grp)||this._curFocus.grp.mouseleave(),this._index.field=0,this._index.grp=1,this._index.cell=1,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,t.isNullOrUndefined(this._schemaData)||t.isNullOrUndefined(this._schemaData._curFocus)||(this._schemaData._curFocus.tree=null,this._schemaData._curFocus.node=null,this._schemaData._curFocus.button=null),this._curFocus.field=null,this._curFocus.cell=null,this._curFocus.grp=null,this._curFocus.tree=null,this._curFocus.cmenu=null,this._curFocus.cformat=null,this._curFocus.selection=null,e=[],this.model.enableGroupingBar&&this.element.find(".pivotButton:visible").first().length>0&&e.push(this.element.find(".pivotButton:visible").first()),n(".e-pivotpager[targetcontrolid='"+this._id+"']:visible").length>0&&n("[role='columnheader']:visible:not([p='0,0'])").first().length>0?e.push(n("[role='columnheader']:visible:not([p='0,0'])").first()):n("#"+this._id).find("[role='columnheader']:visible").first().length>0&&e.push(n("[role='columnheader']:not('.grpRow'):visible:first")),!t.isNullOrUndefined(this._schemaData)&&this._schemaData.element.find(".e-text:visible").first().length>0&&e.push(this._schemaData.element.find(".e-text:visible").first()),!t.isNullOrUndefined(this._schemaData)&&this._schemaData.element.find(".pvtBtn:visible").first().length>0&&e.push(this._schemaData.element.find(".pvtBtn:visible").first()),n(".e-pivotpager[targetcontrolid='"+this._id+"']:visible").length>0&&n("#Pager_CategCurrentPage:visible").length>0&&e.push(n("#Pager_CategCurrentPage:visible")),n(".e-pivotpager[targetcontrolid='"+this._id+"']:visible").length>0&&n("#Pager_SeriesCurrentPage:visible").length>0&&e.push(n("#Pager_SeriesCurrentPage:visible")),t.isNullOrUndefined(this._curFocus.tab)?this._curFocus.tab=e[0].attr("tabindex","-1"):(this._curFocus.tab.attr("tabindex","0").removeClass("hoverCell"),this._curFocus.tab.hasClass("e-active")&&this._curFocus.tab.removeClass("e-active"),t.isNullOrUndefined(this._schemaData)||(this._schemaData.element.find(".e-active").removeClass("e-active"),this._schemaData.element.find(".e-node-hover").removeClass("e-node-hover"),this._schemaData.element.find(".e-node-focus").removeClass("e-node-focus")),this._curFocus.tab.hasClass("e-node-hover")&&this._curFocus.tab.removeClass("e-node-hover"),this._curFocus.tab.mouseleave(),i.which===9&&i.shiftKey?this._index.index=this._index.index-1<0?e.length-1:this._index.index-1:i.which===9&&(this._index.index=this._index.index+1>e.length-1?0:this._index.index+1),this._curFocus.tab=e[this._index.index].attr("tabindex","-1")),this._curFocus.tab.focus().addClass("hoverCell").mouseover(),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&(this._curFocus.tab.mouseover(),this._curFocus.tab.find("span").mouseover()),n(".e-node-focus").removeClass("e-node-focus"),i.stopImmediatePropagation());i.which===93&&!n(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&this.model.enableGroupingBar&&(!t.isNullOrUndefined(this._curFocus.grp)||!t.isNullOrUndefined(this._curFocus.tab))&&(i.preventDefault(),document.activeElement.className.startsWith("pivotButton")&&(t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(v={x:n(this._curFocus.tab).offset().left+n(this._curFocus.tab).outerWidth(),y:n(this._curFocus.tab).offset().top+n(this._curFocus.tab).outerHeight()},this._curFocus.tab.find("button").trigger({type:"mouseup",which:3,clientX:v.x,clientY:v.y,pageX:v.x,pageY:v.y})):(v={x:n(this._curFocus.grp).offset().left+n(this._curFocus.grp).outerWidth(),y:n(this._curFocus.grp).offset().top+n(this._curFocus.grp).outerHeight()},this._curFocus.grp.find("button").trigger({type:"mouseup",which:3,clientX:v.x,clientY:v.y,pageX:v.x,pageY:v.y}))));i.which===13&&this.model.hyperlinkSettings.enableColumnHeaderHyperlink?t.isNullOrUndefined(this._curFocus.cell)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".cellValue").click():this._curFocus.cell.find(".cellValue").click():i.which==13&&!n(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&(this.element.find(".e-dialog .hoverCell").length>0&&this.element.find(".e-dialog .hoverCell").hasClass("e-text")?this.element.find(".e-dialog .hoverCell").parent().find(".e-chkbox-small").click():document.activeElement.className.startsWith("pivotGridTable")||document.activeElement.getAttribute("role")=="rowheader"||document.activeElement.getAttribute("role")=="columnheader"?t.isNullOrUndefined(this._curFocus.cell)?t.isNullOrUndefined(this._curFocus.tab)||(this._curFocus.tab.find(".expand").length>0?this._curFocus.tab.find(".expand").click():this._curFocus.tab.find(".collapse").length>0&&this._curFocus.tab.find(".collapse").click(),this._curFocus.tab=this.element.find("[role='"+this._curFocus.tab.attr("role")+"']:contains('"+this._curFocus.tab.text()+"'):visible").first(),this._curFocus.tab.attr("tabindex","-1").focus().addClass("hoverCell")):(this._curFocus.cell.find(".expand").length>0?this._curFocus.cell.find(".expand").click():this._curFocus.cell.find(".collapse").length>0&&this._curFocus.cell.find(".collapse").click(),this._curFocus.cell.removeClass("hoverCell").attr("tabindex","0"),this._curFocus.cell=this.element.find("[role='"+this._curFocus.cell.attr("role")+"']:contains('"+this._curFocus.cell.text()+"'):visible").first(),this._curFocus.cell.attr("tabindex","-1").focus().addClass("hoverCell")):t.isNullOrUndefined(this._curFocus.tree)&&t.isNullOrUndefined(this._curFocus.formula)&&(t.isNullOrUndefined(this._curFocus.field)||!this._curFocus.field.hasClass("editFormula"))||n("#"+this._id).find(".e-dialog .hoverCell:visible").length>0&&(n("#"+this._id).find(".e-dialog .hoverCell:visible").click(),this._index.tree=1),n(".e-pivotpager[targetcontrolid='"+this._id+"']:visible").length>0&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.attr("tabindex","-1").focus());i.keyCode==79&&this.element.find(".e-dialog").length>0&&i.ctrlKey&&(i.preventDefault(),this.element.find(".dialogOKBtn:visible").click(),this._index.field=0,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._curFocus.tree=null,t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().removeClass("hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(l=this._curFocus.tab.attr("tag"),a=this._curFocus.tab=this.element.find("[tag='"+l+"']")):(l=this._curFocus.grp.attr("tag"),a=this._curFocus.grp=this.element.find("[tag='"+l+"']")),t.isNullOrUndefined(a)||a.mouseover().addClass("hoverCell").focus());i.keyCode==67&&this.element.find(".e-dialog:visible").length>0&&i.ctrlKey&&(i.preventDefault(),this.element.find(".dialogCancelBtn:visible").click(),this._index.field=0,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._curFocus.tree=null,t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().removeClass("hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(l=this._curFocus.tab.attr("tag"),a=this._curFocus.tab=this.element.find("[tag='"+l+"']")):(l=this._curFocus.grp.attr("tag"),a=this._curFocus.grp=this.element.find("[tag='"+l+"']")),t.isNullOrUndefined(a)||a.mouseover().addClass("hoverCell").focus())},_unWireEvents:function(){this._off(n(document),"keydown",this._keyDownPress);this._off(n(document),"keyup",this._keyUpPress);this._off(this.element,"click",".expand, .collapse");this._off(this.element,"dblclick",".value, .summary");this._off(this.element,"mouseover",".colheader, .rowheader, .expand, .collapse");this._off(this.element,"mouseleave",".colheader, .rowheader, .expand, .collapse");this._off(this.element,"mouseover",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary",this.addHyperlinkHandler);this._off(this.element,"mouseleave",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary",this.removeHyperlinkHandler);this._off(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary");this._off(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue");this._off(this.element,"mouseover",".value");this._off(this.element,"mouseleave",".value");this._off(this.element,"mousedown touchstart",".value");this._off(this.element,"mouseup touchend",".value");this._off(this.element,"click",".filter");this._off(this.element,"click",".sorting");this._off(this.element,"click",".removeBtn");this._off(this.element,"mouseover",".pvtBtn");this._off(this.element,"mouseleave",".pvtBtn");n(document).off("keyup",this._endCellSelection);n(document).off("keydown",this._startCellSelection);n(document).off("click",this._clearSelection);this._off(this.element,"click",".calculatedFieldPopup .menuItem ");this._off(this.element,"contextmenu",".values .pivotButton");this._off(this.element,"click",".filter",t.proxy(this._filterBtnClick,this));this._off(this.element,"click",".sorting",t.proxy(this._sortBtnClick,this));this._off(this.element,"click",".removeBtn",t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._removePvtBtn:this._clientRemovePvtBtn,this));this._off(this.element,"click",".ascOrder, .descOrder");this._off(this.element,"click",".clearAllFilters, .clearSorting")},_getFieldName:function(i){var f;if(n(i).hasClass("colheader")||n(i).attr("role")=="columnheader"){var r=parseInt(n(i).attr("p").split(",")[1]),u=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns:JSON.parse(this.getOlapReport()).PivotColumns,e=i.textContent.replace("expanded","");return r<u.length?this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?u[r].fieldName:u[r].FieldName:e}if(n(i).hasClass("rowheader")||n(i).attr("role")=="rowheader")return f=parseInt(n(i).attr("p").split(",")[0]),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?t.isNullOrUndefined(this.model.dataSource.rows)?this.model.dataSource.rows[f].fieldName:"":JSON.parse(this.getOlapReport()).PivotRows[f].FieldName},_colResizing:function(t){var r,i,f,u;if(this._expand)x=t.clientX,y=t.clientY,_hedBound=this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable").first()[0].getBoundingClientRect(),_hedBound.left+document.documentElement.scrollLeft+_hedBound.width<x||x<_hedBound.left+document.documentElement.scrollLeft?this.element.find(".e-reSizeColbg").remove():this._currentCell!=-1&&this.element.find(".e-reSizeColbg").css({left:x,top:this._tableY});else{if(this.element.find(".e-reSizeColbg").is(":visible"))return;n(t.target).attr("role")=="columnheader"?(r=this.resCell=t.target,i=r.getBoundingClientRect(),x=t.clientX,y=t.clientY,f=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(".pivotGridFrozenTable,.pivotGridColValueTable").width()+n(".pivotGridFrozenTable,.pivotGridColValueTable").find("tr").offset().left:n(this.element).find("thead").width()+n(this.element).find("thead tr").offset().left,(x>=i.left+document.documentElement.scrollLeft+r.offsetWidth-5||x<=i.left+3)&&x<f&&x>=i.left&&y<=i.top+document.documentElement.scrollTop+t.target.offsetHeight?(x>i.left+3?(u=n(t.target).find("span"),this._currentCell=t.target):(u=n(t.target).prevAll("th:visible:first").find("span"),this._currentCell=n(t.target).prev()),u.length&&n(t.target).parents("tr").css("cursor","col-resize")):(n(t.target).parent("tr").css("cursor","pointer"),this._currentCell=null)):(this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable tr").css("cursor","pointer"),this._currentCell=null)}},_startColResizing:function(t){var e,u;if(n(t.target).closest("tr").css("cursor")=="col-resize"&&(x=t.clientX,y=t.clientY,this._target=t.target,this._orgX=x,x+=document.documentElement.scrollLeft,t.button!=2))if(e=n(this._target).parent("tr").find("[role='columnheader']"),this._currentCell!=null&&(u=n(this._currentCell)[0].getBoundingClientRect()),_top=this._tableY=u.top+document.documentElement.scrollTop,n(this._target).closest("tr").css("cursor")=="col-resize"){var f=n(document.createElement("div")),r=this.model.enableGroupingBar?this.element.height()-this.element.find(".groupingBarPivot").height():this.element.height(),o=this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable").find("tr[role='row']"),s=n(this._target).parent("tr")[0].rowIndex;for(i=0;i<s;i++)r=r-n(o[i]).height();f.addClass("e-reSizeColbg").appendTo(this.element).attr("unselectable","on").css("visibility","hidden");f.css({visibility:"visible",height:r+"px",cursor:"col-resize",left:x,top:_top,position:"fixed"});this._orgX=x;this._orgY=y;this._expand=!0}else this._currentCell=null},_endColResizing:function(t){var u,f,c;if(this._expand&&(x=t.clientX,y=t.clientY),this.element.find(".e-reSizeColbg").remove(),x+=document.documentElement.scrollLeft,u=n(this._target).parents("thead,.pivotGridFrozenTable,.pivotGridColValueTable"),this._currentCell!=null&&this._expand){f=30;this._expand=!1;var i=this._currentCell,l=n(i)[0].offsetWidth,r=x-this._orgX;if(parseInt(r)+parseInt(l)>f&&r!=0){u.css("cursor","default");var e=parseInt(n(this._currentCell).attr("colspan")),o=(this.model.frozenHeaderSettings.enableFrozenHeaders||!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&this._JSONRecords[0].CSS=="none"?parseInt(n(i).attr("p").split(",")[0])-this._JSONRecords[0].ColSpan:parseInt(n(i).attr("p").split(",")[0]),a=Math.round(r/e),v=this.element.find("col:eq("+o+")").width()+a;if(this._setWidthColResize(o,e,v),n(i).next().length){var s=parseInt(n(i).next().attr("colspan")),h=this.model.frozenHeaderSettings.enableFrozenHeaders||!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders?parseInt(n(i).next().attr("p").split(",")[0])-this._JSONRecords[0].ColSpan:parseInt(n(i).next().attr("p").split(",")[0]),p=Math.round(r/s),w=this.element.find("col:eq("+h+")").width()-p;this._setWidthColResize(h,s,w);this.element.find("tr").css("cursor","default")}}}this.model.enableGroupingBar&&this._createFields(null,n("#"+this._id).find(".pivotGridTable").width(),n("#"+this._id).find(".pivotGridTable th").outerWidth());(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&this._refreshScroller();!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders&&(c=this.element.find(".e-scroller").data("ejScroller"),c.model.enableTouchScroll=!1);this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.element.find("#coltable").width()<this.element.find("#rowvaluecontent").width()&&this.element.find("#coltable").width(this.element.find("#rowvaluecontent").width());this._target=null;this.element.find(".e-reSizeColbg").remove();this._expand=!1;this._currentCell=null},_setWidthColResize:function(n,t,i){for(var u=30,f=i>u?i:u,r=n;r<n+t;r++)this.element.find("colgroup").find("col:eq("+r+")").outerWidth(f)},_direction:function(n){return this.model.enableRTL&&n.indexOf("-")>-1?n.split("-").reverse().join("-"):n},_clearSelection:function(t){n(t.target).parents(".pivotGridTable").length==0&&n(this.element).find(".selected").removeClass("selected")},_startCellSelection:function(i){var f,e,u,o,r;if(this._onholdKey!="Control"&&!t.isNullOrUndefined(this._selectedCell))if(i.preventDefault(),this._onholdKey==""&&(this._onholdKey=i.which.toString()=="16"?"Shift":i.which.toString()=="17"?"Control":""),i.which=="40"){for(f=n(this._selectedCell).attr("p"),e=parseInt(f.split(",")[1])+this._selectedCell.rowSpan;t.isNullOrUndefined(u)&&e<this._rowCount;)r=n(this.element).find("[p='"+f.split(",")[0]+","+e+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(u=r),e++;t.isNullOrUndefined(u)||this._selectCells("Down",u)}else if(i.which=="38"){for(f=n(this._selectedCell).attr("p"),e=parseInt(f.split(",")[1])-1;t.isNullOrUndefined(u)&&e>=0;)r=n(this.element).find("[p='"+f.split(",")[0]+","+e+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(u=r),e--;if(t.isNullOrUndefined(u)&&this._onholdKey!="Shift"&&(n(this._selectedCell).hasClass("colheader")||n(this._selectedCell).attr("role")=="columnheader"))for(column=parseInt(f.split(",")[0])-1;column>0&&t.isNullOrUndefined(u);column--)for(row=parseInt(f.split(",")[1]-1);row>=0&&t.isNullOrUndefined(u);row--)r=n(this.element).find("[p='"+column+","+row+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(u=r);t.isNullOrUndefined(u)||this._selectCells("Up",u)}else if(i.which=="39"){for(f=n(this._selectedCell).attr("p"),e=parseInt(f.split(",")[0])+this._selectedCell.colSpan;t.isNullOrUndefined(u)&&e<Math.ceil(this.getJSONRecords().length/this._rowCount);)r=n(this.element).find("[p='"+e+","+f.split(",")[1]+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(u=r),e++;t.isNullOrUndefined(u)||this._selectCells("Right",u)}else if(i.which=="37"){for(var f=n(this._selectedCell).attr("p"),e=parseInt(f.split(",")[0])-1,u=n(this.element).find("[p='"+(parseInt(f.split(",")[0])-1)+","+f.split(",")[1]+"']")[0];t.isNullOrUndefined(u)&&e>=0;)r=n(this.element).find("[p='"+e+","+f.split(",")[1]+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(u=r),e--;if(t.isNullOrUndefined(u)&&this._onholdKey!="Shift"&&(n(this._selectedCell).hasClass("rowheader")||n(this._selectedCell).attr("role")=="rowheader"))for(o=parseInt(f.split(",")[1])-1;t.isNullOrUndefined(u)&&o>0;)r=n(this.element).find("[p='"+parseInt(f.split(",")[0]-1)+","+o+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader")&&(u=r),o--;t.isNullOrUndefined(u)||this._selectCells("Left",u)}},_endCellSelection:function(i){var r,e,u,o,f;if(!t.isNullOrUndefined(this._selectedCell)&&(i.preventDefault(),(i.which==16||i.which==17)&&(this._onholdKey="",r=n(this.element).find(".selected"),r.length>0))){for(e=[],u=0;u<r.length;u++)o=n(r[u]).attr("p"),f=this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))],f.Value=n(r[u]).text().trim(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(f.Field=this._getFieldName(r[u])),e.push(f);this._trigger("cellSelection",{JSONRecords:e})}},_selectCells:function(i,r){var e,u,s,f,h,o,c;if(this._onholdKey=="Shift")((i=="Up"||i=="Down")&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader")||(i=="Right"||i=="Left")&&(n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"))&&(e=i=="Up"||i=="Down"?1:0,(i=="Up"||i=="Left")&&parseInt(n(r).attr("p").split(",")[e])>=parseInt(this._primaryCellPos.split(",")[e])||(i=="Right"||i=="Down")&&parseInt(n(r).attr("p").split(",")[e])<=parseInt(this._primaryCellPos.split(",")[e])?n(this._selectedCell).removeClass("selected"):n(r).attr("p")!="0,0"&&n(r).addClass("selected"));else if(n(r).attr("p")!="0,0"&&(this.element.find(".selected").removeClass("selected"),n(r).addClass("selected"),this._primaryCellPos=n(r).attr("p"),u=n(this.element).find(".selected"),u.length>0)){for(s=[],f=0;f<u.length;f++)h=n(u[f]).attr("p"),o=this.getJSONRecords()[parseInt(parseInt(h.split(",")[0])*this._rowCount+parseInt(h.split(",")[1]))],o.Value=n(u[f]).text().trim(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(o.Field=this._getFieldName(u[f])),s.push(o);this._trigger("cellSelection",{JSONRecords:s})}c=i=="Up"||i=="Down"?!n(this._selectedCell).hasClass("colheader")&&n(this._selectedCell).attr("role")!="columnheader":!n(this._selectedCell).hasClass("rowheader")&&n(this._selectedCell).attr("role")!="rowheader";n(r).attr("p")!="0,0"&&(this._onholdKey!="Shift"||c)&&(this._selectedCell=r)},_sortBtnClick:function(i){var s,h,f,r,u,o,e,c;if(this._isUpdateRequired=!0,n(i.delegateTarget).attr("id")==this._id&&(n(i.target).toggleClass("descending"),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".pivotButton[tag='"+n(i.target).parent().attr("tag")+"']").find(".sorting").toggleClass("descending")),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)s=n(i.target).siblings(".pvtBtn").attr("fieldName"),h=t.Pivot.getReportItemByFieldName(s,this.model.dataSource).item,h.sortOrder=i.target.className.indexOf("descending")>=0?t.PivotAnalysis.SortOrder.Descending:t.PivotAnalysis.SortOrder.Ascending,this.refreshControl();else{for(f=this._ascdes.split("##"),r=0,u=0;u<f.length;u++)f[u]==n(n(i.target).siblings(".pvtBtn")).text()&&(r=1);classNames=i.target.className;isDescending=new RegExp("descending");isDescending.test(classNames)?r==0&&(this._ascdes+=n(n(i.target).siblings(".pvtBtn")).text()+"##"):r==1&&(this._ascdes=this._ascdes.replace(n(n(i.target).siblings(".pvtBtn")).text()+"##",""));e=JSON.stringify(this.model.customObject);try{o=JSON.parse(this.getOlapReport()).Report}catch(l){o=this.getOlapReport()}this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject});e=JSON.stringify(this.model.customObject);c=JSON.stringify({action:"sorting",sortedHeaders:this._ascdes,currentReport:o,customObject:e});this._waitingPopup=this.element.data("ejWaitingPopup");t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();this.model.enableDeferUpdate?t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide():this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.sorting,c,this._sortingSuccess)}},calculateCellWidths:function(){var f={rowHeight:0,columnWidths:[]},r,i,u,t;if(r=this._excelLikeJSONRecords!=null?this._excelLikeJSONRecords.length/this._excelRowCount:this.getJSONRecords()!=null?this.getJSONRecords().length/this._rowCount:0,i=1,u=!1,r>0)for(f.rowHeight=this.element.find("tbody tr:visible").length>0?this.element.find("tbody tr:visible").outerHeight():0,t=0;t<r&&i<=r;t++)n(this._excelLikeJSONRecords!=null?this.element.find("th[i^="+t+"]:visible"):this.element.find("th[p^="+t+"]:visible")).each(function(){if(n(this).length>0&&n(this).attr("colspan")==i&&(n(this).attr("i")!=null?n(this).attr("i").split(",")[0]==t:n(this).attr("p").split(",")[0]==t))return f.columnWidths.push(n(this).outerWidth()),t+=i-1,i=1,u=!0,!1;u=!1}),u||i==r?i=1:(t--,i++);return f},_deferUpdate:function(){var i,r,n,u,f;if(!this._isUpdateRequired)return!1;this._isUpdateRequired=!1;try{i=JSON.parse(this.getOlapReport()).Report}catch(e){i=this.getOlapReport()}for(r="",n=0;n<this._filterUpdate.length;n++)r+=this._filterUpdate[n]+"%%";u=JSON.stringify(this.model.customObject);f=JSON.stringify({action:"deferUpdate",sortedHeaders:this._ascdes,filterParams:r,currentReport:i,customObject:u});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.deferUpdate,f,this._renderControlSuccess);this._filterUpdate=[];this._waitingPopup=this.element.data("ejWaitingPopup");t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show()},_dialogBtnClick:function(i){var o,p,w,b,s,l,u,nt,a,g,tt,v,it;if(this._preventPanelClose(),this.element.find(".e-dialog, .clientDialog").hide(),i.model.text.toLowerCase()=="cancel"||!this._isMembersFiltered)return t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style"),!1;if(this._isUpdateRequired=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)o=[],p=[],this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(jQuery.each(this._memberTreeObj.element.find(":input.nodecheckbox:checked"),function(n,t){t.value!="All"&&o.push(t.value)}),jQuery.each(this._memberTreeObj.element.find(":input.nodecheckbox:not(:checked)"),function(n,t){p.push(t.value=t.value=="(blank)"?"":t.value)}),this._pivotFilterItems(o,p),this.model.editCellsInfo={},this._populatePivotGrid()):(this._waitingPopup.show(),w=this._selectedField.toLocaleLowerCase(),this._currentReportItems=n.grep(this._currentReportItems,function(n){if(n.fieldName!=r&&n.fieldName.toLocaleLowerCase()!=w)return n}),this._memberTreeObj=t.Pivot.updateTreeView(this),b=t.Pivot.getNodesState(this._memberTreeObj),this._schemaData!=null&&(this._schemaData._memberTreeObj=this._memberTreeObj),this._currentReportItems.push({filterItems:this._memberTreeObj.dataSource(),fieldName:this._selectedField}),o=n.map(b.selectedNodes.split("::"),function(n){return{Id:n.split("||")[0],tag:n.split("||")[1],parentId:n.split("||")[2]}}),s=t.Pivot.getReportItemByFieldName(w,this.model.dataSource).item,t.isNullOrUndefined(s)||(b.unSelectedNodes!=""?(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"filtering"},this),s.advancedFilter=[],s.filterItems={filterType:"include",values:this._removeSelectedNodes(o)},this.element.find(".pivotButton:contains('"+this._selectedField+"') .filter").addClass("filtered"),this._schemaData!=null&&this._schemaData._tableTreeObj.element.find("li[tag='"+this._selectedField+"'] .filter").length==0&&(this._schemaData._tableTreeObj.element.find("li[tag='"+this._selectedField+"'] div:first .e-text").after(t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML),this._schemaData.element.find(".pvtBtn[fieldname='"+this._selectedField+"']").parent().find(".filter").addClass("filtered"))):(delete s.filterItems,this._schemaData!=null&&(this._schemaData._tableTreeObj.element.find("li[tag='"+this._selectedField+"'] .filter").remove(),this._schemaData.element.find(".pvtBtn[fieldname='"+this._selectedField+"']").parent().find(".filter").removeClass("filtered")))),this.getJSONData({action:"filtering"},this.model.dataSource,this));else{var rt="",k,h=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?rt=this._getUnSelectedNodes()+"FILTERED"+this._getSelectedNodes(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._curFilteredAxis=="Slicers"?!0:!1:this._curFilteredAxis=="Filter"?!0:!1):this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:not(:checked)"),y=!1,f=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?h:this._curFilteredAxis+"::"+this._curFilteredText+"::FILTERED",e=this._curFilteredText,d=[],c={};if(k=this._getUnSelectedNodes()!=""?!0:!1,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){for(u=0;u<h.length;u++)d.push(n(h[u].parentElement).siblings("a").text());for(c[e]=d,t.isNullOrUndefined(this._tempFilterData)&&(this._tempFilterData=[]),u=0;u<this._tempFilterData.length;u++)t.isNullOrUndefined(this._tempFilterData[u][e])||(this._tempFilterData[u][e]=d,y=!0);if(y||this._tempFilterData.push(c),this._schemaData!=null&&(this._schemaData._tempFilterData=this._tempFilterData),t.isNullOrUndefined(this._curFilteredAxis)||this._curFilteredAxis!="")for(u=0;u<h.length;u++)f+="##"+n(h[u].parentElement).siblings("a").text()}else{for(c[this._curFilteredText.split(":")[1]]=f,t.isNullOrUndefined(this._tempFilterData)&&(this._tempFilterData=[]),u=0;u<this._tempFilterData.length;u++)t.isNullOrUndefined(this._tempFilterData[u][this._curFilteredText.split(":")[1]])||(this._tempFilterData[u]=c,y=!0);y||this._tempFilterData.push(c)}if(filteredBtn=this.model.layout=="excel"?this.element.find(".schemaFieldTree li:contains('"+this._curFilteredText+"')"):this.element.find("."+this._curFilteredAxis+" .pivotButton:contains("+this._curFilteredText+") .filterBtn"),l=this._curFilteredText,this.model.layout==t.PivotGrid.Layout.Normal&&this._schemaData!=null){for(u=0;u<this._schemaData.element.find(".fieldTable").find("li").length;u++)this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._curFilteredText.split(":")[1]==n(this._schemaData.element.find(".fieldTable").find("li")[u]).attr("tag").replace(/\]/g,"").replace(/\[/g,"")&&(this._schemaData._selectedTreeNode=this._schemaData.element.find(".fieldTable").find("li")[u],l=this._curFilteredText.split(":")[1].split(".")[1]):this._curFilteredText==this._schemaData.element.find(".fieldTable").find("li")[u].id&&(this._schemaData._selectedTreeNode=this._schemaData.element.find(".fieldTable").find("li")[u],l=this._curFilteredText);if(n(this._schemaData._selectedTreeNode).parents("li:eq(0)").children().children("span").hasClass("hierarchyCDB")&&(this._schemaData._selectedTreeNode=n(n(this._schemaData._selectedTreeNode).parents("li:eq(0)"))),k&&n(n(this._schemaData._selectedTreeNode)).find(".filter").length<=0?(nt=t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML,n(n(this._schemaData._selectedTreeNode).find(".e-text")[0]).after(nt),this._schemaData.element.find(".pvtBtn:contains('"+l+"')").parent().find(".filter").addClass("filtered")):k||(n(this._schemaData._selectedTreeNode).find(".filter").remove(),this._schemaData.element.find(".pvtBtn:contains('"+l+"')").parent().find(".filter").removeClass("filtered")),this._curFilteredAxis=="")return!1}try{a=JSON.parse(this.getOlapReport()).Report}catch(ut){a=this.getOlapReport()}if(this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject}),g=JSON.stringify(this.model.customObject),tt=this.model.customObject!={}&&f!=""?JSON.stringify({action:"filtering",filterParams:f,sortedHeaders:this._ascdes,currentReport:a,customObject:g,gridLayout:this.model.layout}):this.model.customObject!={}?JSON.stringify({action:"filtering",currentReport:a,customObject:g,gridLayout:this.model.layout}):f!=""?JSON.stringify({action:"filtering",filterParams:f,sortedHeaders:this._ascdes,currentReport:a,gridLayout:this.model.layout}):JSON.stringify({action:"filtering"}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(n(this._schemaData.element).width()).height(n(this._schemaData.element).height()).css({top:n(this._schemaData.element).offset().top,left:n(this._schemaData.element).offset().left}),this.model.enableDeferUpdate){if(this._filterUpdate.push(f),!t.isNullOrUndefined(this._tempFilterData))for(v=0;v<this._tempFilterData.length;v++)for(it in this._tempFilterData[v])it==e&&this._tempFilterData[v][e].length>0&&this.element.find("#pivotButton"+e).next().addClass("filtered");t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide();t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")}else this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,tt,this._filterElementSuccess)}},_removeSelectedNodes:function(t){for(var i,u=n.extend([],t),f=0;f<t.length;f++)for(i=0;i<u.length;i++)u[i].Id==t[f].parentId&&u.splice(i,1);return n.map(u,function(n){if(n.tag!=""&&n.tag!=r)return n.tag.replace(/\&/g,"&amp;")})},_pivotFilterItems:function(i,r){var s=this.model.dataSource[this._selectedAxis=="Slicers"?"filters":this._selectedAxis.toLowerCase()],f=t.PivotAnalysis.getMembers(this._selectedField),u,o;jQuery.each(f,function(n,t){t!=null&&t.toString().replace(/^\s+|\s+$/gm,"")||jQuery.each(r,function(n,i){i.toString().replace(/^\s+|\s+$/gm,"")||(r[n]=t)})});var h=this._selectedField,c=this._dialogTitle,e=n.grep(s,function(n){return n.fieldName==h});for(u=0;u<e.length;u++)e[u].filterItems=i.length==f.length?null:{filterType:t.PivotAnalysis.FilterType.Exclude,values:r};this._schemaData!=null&&(r.length>0&&this._schemaData.element.find(".schemaFieldTree li[id='"+this._selectedField+"']").find(".filter").length<=0?(o=t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML,this._schemaData.element.find(".schemaFieldTree li[id='"+this._selectedField+"']").find(".e-text").after(o),this._schemaData.element.find(".pvtBtn[fieldname='"+this._selectedField+"']").parent().find(".filter").addClass("filtered")):r.length==0&&(this._schemaData.element.find(".schemaFieldTree li[id='"+this._selectedField+"']").find(".filter").remove(),this._schemaData.element.find(".pvtBtn[fieldname='"+this._selectedField+"']").parent().find(".filter").removeClass("filtered")))},_getUnSelectedNodes:function(){var e=this.element.find(".editorTreeView")[0],f="",r=n(e).find(":input.nodecheckbox:not(:checked)"),i,u;if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)for(i=0;i<r.length;i++)n(r[i].parentElement).find("span:nth-child(1)").attr("class").indexOf("e-chk-act")>-1||n(r[i].parentElement).attr("aria-checked")=="mixed"||(u=n(r[i]).parents("li:eq(0)"),f+="::"+u[0].id+"||"+n(u).attr("tag"));return f},_getSelectedNodes:function(i){var o,e,f,h,c,s,u,r;if(i){for(this.element.find(".editorTreeView").length>0?o=this.element.find(".editorTreeView")[0].childNodes[0]:t.isNullOrUndefined(this._schemaData)||(o=this._memberTreeObj.element[0].childNodes[0]),e=[],f=n(o).children(),u=0;u<f.length;u++){if(r=f[u],h={caption:n(r.firstChild).find("a").text(),parentId:r.parentElement.parentElement.className.indexOf("editorTreeView")>-1?"None":n(r).parents()[1].id,id:r.id,checked:n(r).find(":input.nodecheckbox")[0].checked||n(r).find("span:nth-child(1)").attr("class").indexOf("e-chk-indeter")>-1,expanded:n(r.firstChild).find(".e-minus").length>0?!0:!1,childNodes:[],tag:n(r).attr("tag")},n(r).find("ul:first").children().length>0)for(c=n(r).find("ul:first").children(),s=0;s<c.length;s++)h.childNodes.push(this._getNodeInfo(c[s]));e.push(h)}return JSON.stringify(e)}var o=n(".editorTreeView"),e="",f=n(o).find(":input.nodecheckbox");for(u=0;u<f.length;u++)(f[u].checked||n(f[u].parentElement).attr("aria-checked")=="mixed")&&(r=n(f[u]).parents("li:eq(0)"),e+="::"+r[0].id+"||"+n(r).attr("tag"));return e},_getNodeInfo:function(t){var u={caption:n(t.firstChild).find("a").text(),parentId:t.parentElement.parentElement.className.indexOf("editorTreeView")>-1?"None":n(t).parents()[1].id,id:t.id,checked:n(t).find(":input.nodecheckbox")[0].checked||n(t).find("span:nth-child(1)").attr("class").indexOf("e-chk-indeter")>-1,expanded:n(t.firstChild).find(".e-minus").length>0?!0:!1,childNodes:[],tag:n(t).attr("tag")},r,i;if(n(t).find("ul:first").children().length>0)for(r=n(t).find("ul:first").children(),i=0;i<r.length;i++)u.childNodes.push(this._getNodeInfo(r[i]));return u},_getLevelInfo:function(t,i){var r=n.map(n(i).find("row"),function(i){if(parseInt(n(i).children("LEVEL_TYPE").text())!="1"&&n(i).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase()!="[measures]"&&n(i).find("HIERARCHY_UNIQUE_NAME").text()==t.hierarchy)return{value:n(i).find("LEVEL_UNIQUE_NAME").text(),text:n(i).find("LEVEL_CAPTION").text()}});this.olapCtrlObj._currentReportItems.push({fieldName:t.hierarchy,dropdownData:r})},_sortDimensionElement:function(i){if(this.element.find(".e-dialog, .clientDialog").remove(),this._preventPanelClose(),t.olap.base._clearDrilledCellSet(),n(i.target).find(".selectedSort").length==0){var r=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item;r.sortOrder=n(i.target).hasClass("descOrder")?t.olap.SortOrder.Descending:t.olap.SortOrder.Ascending;this._waitingPopup.show();t.olap.base.getJSONData({action:"sorting"},this.model.dataSource,this)}},_createDialog:function(i,r){var o=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.dataSource.enableAdvancedFilter&&t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).axis!="filters"&&t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item?!0:!1,f,l,a,nt,c,s,v,y,u,tt,it,rt,ut,ft,p;this.element.find(".e-dialog, .clientDialog").remove();var h,e,w="",b="",k="",d="",g="";h=this._selectedField;l=n(document).height();o&&(e=n.map(this._currentReportItems,function(n){if(n.fieldName==h)return n.dropdownData}),e.length==0&&(a=this._getConnectionInfo(this.model.dataSource.data),nt='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_LEVELS<\/RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+this.model.dataSource.catalog+"<\/CATALOG_NAME><CUBE_NAME>"+this.model.dataSource.cube+"<\/CUBE_NAME><\/RestrictionList><\/Restrictions><Properties><PropertyList><Catalog>"+this.model.dataSource.catalog+"<\/Catalog> <LocaleIdentifier>"+a.LCID+"<\/LocaleIdentifier> <\/PropertyList><\/Properties><\/Discover><\/Body><\/Envelope>",this.doAjaxPost("POST",a.url,{XMLA:nt},this._getLevelInfo,null,{pvtGridObj:this,action:"loadFieldElements",hierarchy:this._selectedField}),e=n.map(this._currentReportItems,function(n){if(n.fieldName==h)return n.dropdownData})),b=t.Pivot.createAdvanceFilterTag({action:"sort",fieldName:h},this),k=t.buildTag("div.ddlGroupWrap","Select field:"+t.buildTag("input#GroupLabelDrop.groupLabelDrop").attr("type","text")[0].outerHTML,{})[0].outerHTML,d=t.Pivot.createAdvanceFilterTag({action:"valueFiltering"},this),g=t.Pivot.createAdvanceFilterTag({action:"labelFiltering"},this),w=t.Pivot.createAdvanceFilterTag({action:"clearFilter",selectedLevel:e.length>0?e[0]:""},this));var et=t.buildTag("div#EditorDiv.editorDiv",k+b+w+t.buildTag("div",g+d+t.buildTag("div.memberEditorDiv",t.buildTag("div#editorTreeView.editorTreeView")[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML+"<\/br>",ot=t.buildTag("div",t.buildTag("button#OKBtn.dialogOKBtn",this._getLocalizedLabels("OK"))[0].outerHTML+t.buildTag("button#CancelBtn.dialogCancelBtn",this._getLocalizedLabels("Cancel"))[0].outerHTML,{float:"right",margin:"-5px "+(o?" 15px ":" 0px ")+(o?" 11px ":" 6px ")+"  0px"})[0].outerHTML,st=t.buildTag("div#clientDialog.clientDialog",et+ot,{opacity:"1"}).attr("title",i)[0].outerHTML,r=JSON.parse(r);for(u=0;u<r.length;u++)r[u].name!=null&&r[u].name.toString().replace(/^\s+|\s+$/gm,"")||(r[u].name="(blank)",r[u].id="(blank)");if(!t.isNullOrUndefined(this._tempFilterData)){for(u=0;u<this._tempFilterData.length;u++)t.isNullOrUndefined(this._tempFilterData[u][i])||(c=this._tempFilterData[u][i]);if(!t.isNullOrUndefined(c))for(u=0;u<c.length;u++)for(s=0;s<r.length;s++)c[u]==r[s].name&&(r[s].checkedStatus=!1)}for(n(st).appendTo("#"+this._id),this.element.find(".editorTreeView").ejTreeView({showCheckbox:!0,loadOnDemand:!0,enableRTL:this.model.enableRTL,beforeDelete:function(){return!1},height:n(".memberEditorDiv").height(),fields:{id:"id",text:"name",isChecked:"checkedStatus",hasChild:"hasChildren",dataSource:r}}),o&&(f=this.element.find("[tag*='"+this._selectedField+"']").offset(),this.element.find(".filterElementTag").ejMenu({menuType:t.MenuType.NormalMenu,enableRTL:this.model.enableRTL,width:"96%",orientation:t.Orientation.Vertical,click:t.proxy(this._filterElementClick,this)}),this.element.find(".groupLabelDrop").ejDropDownList({width:"99%",enableRTL:this.model.enableRTL,dataSource:e,fields:{id:"id",text:"text",value:"value"},change:t.proxy(this._groupLabelChange,this)}),v=this.element.find(".groupLabelDrop").data("ejDropDownList"),v.selectItemByText(v.model.dataSource[0].text),this.element.find(".memberEditorDiv").addClass("advancedFilter"),this.element.find(".clearAllFilters").click(t.proxy(this._clearAllFilters,this)),this.element.find(".clearSorting").click(t.proxy(this._clearSorting,this))),y=this.element.find(".editorTreeView").find("li"),u=0;u<y.length;u++)y[u].setAttribute("tag",r[u].tag);this.element.find(".dialogOKBtn, .dialogCancelBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(this._dialogBtnClick,this)});this._dialogOKBtnObj=this.element.find(".dialogOKBtn").data("ejButton");this._memberTreeObj=this.element.find(".editorTreeView").data("ejTreeView");tt=this.element.find(".editorTreeView li:gt(0)");it=n(tt).find(":input.nodecheckbox:not(:checked)");it.length>0&&(rt=n(this._memberTreeObj.element.find("li:first")).find("div .e-chkbox-small > span > span:eq(0)"),n(rt).removeClass("e-checkmark").addClass("e-stop"));this.element.find(".clientDialog").ejDialog({width:265,target:"#"+this._id,enableResize:!1,enableRTL:this.model.enableRTL,close:this._preventPanelClose});this.element.find("#clientDialog_wrapper").height()+this.element[0].offsetTop>l&&(ut=this.element.find("#clientDialog_wrapper").height()+this.element[0].offsetTop-l,ft=this.element.find("#clientDialog_wrapper").position().top-ut,this.element.find("#clientDialog_wrapper").css("top",ft));o&&(p=n(".cols-sample-area").position(),p.left>0?this.element.find("#clientDialog_wrapper").css({left:f.left+50-p.left,top:f.top}):t.isNullOrUndefined(f)||this.element.find("#clientDialog_wrapper").css({left:f.left+50,top:f.top}),this.element.find(".clientDialog").css("padding","0px").parents().find(".e-titlebar").remove());this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this);this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this);this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this._memberTreeObj.model.beforeExpand=t.proxy(this._beforeNodeExpand,this):this._memberTreeObj.model.nodeClick=t.proxy(this._nodeExpand,this));this._memberTreeObj.element.find(".e-plus").length==0&&this._memberTreeObj.element.find(".e-item").css("padding","0px");this._isMembersFiltered=!1;this._unWireEvents();this._wireEvents();this.element.find(".e-dialog .e-close").attr("title",this._getLocalizedLabels("Close"));this.element.find(".e-dialog .e-close").click(function(){var i=n(this).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(i._schemaData)||i._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")})},_clearSorting:function(t){if(n(t.target).parent().attr("disabled")=="disabled")return!1;this._preventPanelClose();var u=this.model.dataSource,f=this._selectedField.toLowerCase(),i=n.map(u.columns,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==f)return n});i.length==0&&(i=n.map(u.rows,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==f)return n}));i.length>0&&delete i[0].sortOrder;this.model.dataSource=u;this.element.find(".e-dialog").remove();this.element.find("#preventDiv").remove();this._schemaData!=null&&this._schemaData.element.find(".e-dialog").remove();this._waitingPopup.show();this.getJSONData({action:"clearSorting"},this.model.dataSource,this)},_clearAllFilters:function(t){var u;if(n(t.target).parent().attr("disabled")=="disabled")return!1;this._preventPanelClose();var f=this.model.dataSource,e=this._selectedField.toLowerCase(),i=n.map(f.columns,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==e)return n});i.length==0&&(i=n.map(f.rows,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==e)return n}));i.length>0&&(u=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):this._schemaData==null?null:this._schemaData.element.find(".groupLabelDrop").data("ejDropDownList"),u!=null?(i[0].advancedFilter&&(i[0].advancedFilter=n.map(i[0].advancedFilter,function(n){if(n.name!=r&&n.name.toLowerCase()!=u.getSelectedValue().toLowerCase())return n})),this._schemaData!=null&&(i[0].advancedFilter.length==0&&this._schemaData._tableTreeObj.element.find("li[tag ='"+i[0].fileName+"'] div:eq(0) .filter").remove(),this._schemaData._tableTreeObj.element.find("li[tag='"+u.getSelectedValue()+"'] div:eq(0) .filter").remove())):delete i[0].advancedFilter,delete i[0].filterItems);this._currentReportItems=n.grep(this._currentReportItems,function(n){if(n.fieldName!=r&&n.fieldName.toLocaleLowerCase()!=e)return n});this.model.dataSource=f;this.element.find(".e-dialog").remove();this.element.find("#preventDiv").remove();this._schemaData!=null&&(this._schemaData._tableTreeObj.element.find("li[tag ='"+this._selectedField+"'] .filter").remove(),this._schemaData.element.find(".e-dialog").remove());this._waitingPopup.show();this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this)},_groupLabelChange:function(n){var i=this.element.hasClass("e-pivotschemadesigner")?this.model.pivotControl:this,l=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):[],u=i._getAdvancedFiltervalue(i._selectedField,l.getSelectedValue()),o=this.element.find("#valueFilterBtn").data("ejMenu"),s=this.element.find("#labelFilterBtn").data("ejMenu"),h=t.Pivot.getReportItemByFieldName(i._selectedField,i.model.dataSource).item,f=t.buildTag("span.filterState").addClass("e-icon").attr("aria-label","filter state")[0].outerHTML,c=t.buildTag("span.activeFilter").addClass("e-icon")[0].outerHTML,r,e;o.disableItem("Clear Filter");s.disableItem("Clear Filter");r=t.Pivot.getReportItemByFieldName(i._selectedField,i.model.dataSource).item;r&&(r.sortOrder&&r.sortOrder!=t.olap.SortOrder.None?(e=r&&r.sortOrder==t.olap.SortOrder.Descending?"desc":"asc",t.isNullOrUndefined(e)||e=="asc"?this.element.find(".clientDialog .ascImage").addClass("selectedSort"):this.element.find(".clientDialog .descImage").addClass("selectedSort")):this.element.find(".clearSorting").css("opacity","0.5").attr("disabled","disabled"));this.element.find(".clearAllFilters").css("opacity","0.5").attr("disabled","disabled");this.element.find(".filterState,.activeFilter").remove();this.element.find(".clearFltrText").text(this._getLocalizedLabels("ClearFilter")+' from "'+n.text+'"');u.length>0?(u[0].advancedFilterType==t.olap.AdvancedFilterType.LabelFilter?(this.element.find("#labelFilterBtn a:eq(0)").append(f),this.element.find("#labelFilterBtn .clearFilter").css("opacity","1").removeAttr("disabled"),this.element.find("#labelFilterBtn ."+u[0].labelFilterOperator+" a").append(c),s.enableItem("Clear Filter")):(this.element.find("#valueFilterBtn a:eq(0)").append(f),this.element.find("#valueFilterBtn .clearFilter").css("opacity","1").removeAttr("disabled"),this.element.find("#valueFilterBtn ."+u[0].valueFilterOperator+" a").append(c),o.enableItem("Clear Filter")),this.element.find(".clearAllFilters").css("opacity","1").removeAttr("disabled")):h&&h.filterItems&&(this.element.find(".memberEditorDiv").before(f),this.element.find(".filterState").css({position:"absolute"},{float:"left"}),this.element.find(".clearAllFilters").css("opacity","1").removeAttr("disabled"))},_getAdvancedFiltervalue:function(i,u){var f=t.Pivot.getReportItemByFieldName(i,this.model.dataSource).item,e=[];return f&&f.advancedFilter&&(e=n.map(f.advancedFilter,function(n){if(n.name!=r&&n.name.toLocaleLowerCase()==u.toLowerCase())return n})),e},_filterElementClick:function(i,u){var o,v,l,p,w,s,a,b,k,d,nt;if(!n(i.element).parent().hasClass("filterElementTag")){if(o=this._selectedField,this._filterAction=t.isNullOrUndefined(i.element)?i.menuId=="valueFilterBtn"?"valueFiltering":i.menuId=="labelFilterBtn"?"labelFiltering":"":n(i.element).parents(".filterElementTag")[0].textContent.indexOf("Label Filters")>-1?"labelFiltering":"valueFiltering",v=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):u.element.find(".groupLabelDrop").data("ejDropDownList"),this._selectedLevelUniqueName=v.getSelectedValue(),this.element.find(".e-dialog, .filterDialog, #preventDiv").remove(),this._schemaData!=null&&this._schemaData.element.find(".e-dialog").remove(),n.trim(i.text)==n.trim(this._getLocalizedLabels("ClearFilter"))){this._preventPanelClose();var g=this._selectedLevelUniqueName.toLowerCase(),y=[],f=n.map(this.model.dataSource.columns,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==o.toLowerCase())return n});return f.length==0&&(f=n.map(this.model.dataSource.rows,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==o.toLowerCase())return n})),f.length>0&&(f[0].advancedFilter&&(y=n.map(f[0].advancedFilter,function(n){if(n.name!=r&&n.name.toLowerCase()!=g)return n})),f[0].advancedFilter=y,this._schemaData&&(f[0].advancedFilter.length==0&&this._schemaData._tableTreeObj.element.find("li[tag ='"+o+"'] div:eq(0) .filter").remove(),this._schemaData._tableTreeObj.element.find("li[tag='"+this._selectedLevelUniqueName+"'] div:eq(0) .filter").remove())),this._waitingPopup.show(),this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this),!1}var h,c,e=this._getAdvancedFiltervalue(o,this._selectedLevelUniqueName);if(e=n(i.element).find(".activeFilter").length>0&&e.length>0?e[0].values:[""],this._filterAction=="labelFiltering")h=t.buildTag("table.labelfilter",t.buildTag("tr",t.buildTag("td",this._getLocalizedLabels("LabelFilterLabel")).attr("colspan","2")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions' style='width:220px'/>")[0].outerHTML+t.buildTag("td.filterValuesTd","<input type='text' id='filterValue1' value='"+e[0]+"' style='display:inline; width:190px; height:19px;' class='filterValues'/><\/br>")[0].outerHTML)[0].outerHTML)[0].outerHTML,c=[{option:"equals",value:this._getLocalizedLabels("Equals")},{option:"not equals",value:this._getLocalizedLabels("NotEquals")},{option:"begins with",value:this._getLocalizedLabels("BeginsWith")},{option:"not begins with",value:this._getLocalizedLabels("NotBeginsWith")},{option:"ends with",value:this._getLocalizedLabels("EndsWith")},{option:"not ends with",value:this._getLocalizedLabels("NotEndsWith")},{option:"contains",value:this._getLocalizedLabels("Contains")},{option:"notcontains",value:this._getLocalizedLabels("NotContains")},{option:"greater than",value:this._getLocalizedLabels("GreaterThan")},{option:"greater than or equal to",value:this._getLocalizedLabels("GreaterThanOrEqualTo")},{option:"less than",value:this._getLocalizedLabels("LessThan")},{option:"less than or equal to",value:this._getLocalizedLabels("LessThanOrEqualTo")},];else if(this._filterAction=="valueFiltering"){for(l=[],w=n(i.element).hasClass("between")||n(i.element).hasClass("notbetween")?"4":"3",s=0;s<this.model.dataSource.values[0].measures.length;s++)a=this.model.dataSource.values[0].measures[s],l.push({option:a.fieldCaption,value:a.fieldName});p=t.buildTag("td","<input type='text' id='filterMeasures' class='filterMeasures' />").attr("width","180px")[0].outerHTML+t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions'/>").attr("width","180px")[0].outerHTML+t.buildTag("td.filterValuesTd","<input type='text' id='filterValue1' value='"+e[0]+"' style='display:inline; width:190px; height:19px;' class='filterValues'/>"+(w=="4"?"<span> and <\/span><input type='text' id='filterValue2' value='"+(e[1]!=r?e[1]:"")+"' style='display:inline; width:190px; height:19px;' class='filterValues'/> <\/br>":"<\/br>"))[0].outerHTML;h=t.buildTag("table.valuefilter",t.buildTag("tr",t.buildTag("td",this._getLocalizedLabels("ValueFilterLabel")).attr("colspan",i.text=="Between"?"4":"3")[0].outerHTML)[0].outerHTML+t.buildTag("tr",p)[0].outerHTML)[0].outerHTML;c=[{option:"equals",value:this._getLocalizedLabels("Equals")},{option:"not equals",value:this._getLocalizedLabels("NotEquals")},{option:"greater than",value:this._getLocalizedLabels("GreaterThan")},{option:"greater than or equal to",value:this._getLocalizedLabels("GreaterThanOrEqualTo")},{option:"less than",value:this._getLocalizedLabels("LessThan")},{option:"less than or equal to",value:this._getLocalizedLabels("LessThanOrEqualTo")},{option:"between",value:this._getLocalizedLabels("Between")},{option:"not between",value:this._getLocalizedLabels("NotBetween")}]}b=t.buildTag("div",t.buildTag("button#filterDlgOKBtn.dialogOKBtn","OK")[0].outerHTML+t.buildTag("button#filterDlgCancelBtn.dialogCancelBtn","Cancel")[0].outerHTML,{float:"right",margin:"8px 0 6px"})[0].outerHTML;k=t.buildTag("div#filterDialog.filterDialog",h+b,{opacity:"1"}).attr("title",(this._filterAction=="labelFiltering"?"Label Filter(":"Value Filter(")+this._selectedLevelUniqueName.split(".")[2].replace(/\[/g,"").replace(/\]/g,"")+")").attr("tag",this._dialogTitle)[0].outerHTML;n(k).appendTo("#"+this._id);this.element.find(".filterDialog").ejDialog({enableResize:!1,width:"auto",content:"#"+this._id,close:this._preventPanelClose});this.element.find(".filterOptions").ejDropDownList({dataSource:c,width:this._filterAction=="labelFiltering"?"220px":"180px",height:"25px",fields:{text:"value",value:"option"},change:t.proxy(this._filterOptionChanged,this)});d=this.element.find(".filterOptions").data("ejDropDownList");d.setSelectedText(i.text);this._filterAction=="valueFiltering"&&(this.element.find(".filterMeasures").ejDropDownList({dataSource:l,width:"180px",height:"25px",fields:{text:"option",value:"value"}}),this._measureDDL=this.element.find(".filterMeasures").data("ejDropDownList"),this.model.dataSource.values[0].measures.length>0&&this._measureDDL.setSelectedText(this.model.dataSource.values[0].measures[0].fieldCaption));nt=this.element.find("#filterDialog").data("ejDialog");this.element.find("#filterDlgOKBtn").ejButton({click:t.proxy(this._filterElementOkBtnClick,this)});this.element.find("#filterDlgCancelBtn").ejButton({type:t.ButtonType.Button,click:function(){n(".e-dialog").hide();var t=n(this.element).parents(".e-pivotgrid").data("ejPivotGrid");t._preventPanelClose()}})}},_filterOptionChanged:function(i){var r=this._getAdvancedFiltervalue(this._selectedField,this._selectedLevelUniqueName),u;r=r.length>0?r[0].advancedFilterType=="label"&&i.value.replace(/ /g,"")==r[0].labelFilterOperator?r[0].values:r[0].advancedFilterType=="value"&&i.value.replace(/ /g,"")==r[0].valueFilterOperator?r[0].values:[""]:[""];u=this.element.find(".filterValuesTd")[0];i.value.toLowerCase().indexOf("between")>=0&&n(u).html("<input type='text' id='filterValue1' class='filterValues' value='"+r[0]+"' style='display:inline'/> <span>and<\/span> <input type='text' id='filterValue2' value='"+(t.isNullOrUndefined(r[1])?"":r[1])+"' class='filterValues' style='display:inline' /> <\/br>");i.value.toLowerCase().indexOf("between")<0&&n(u).html("<input type='text' id='filterValue1' class='filterValues' value='"+r[0]+"' style='display:inline'/>")},_filterElementOkBtnClick:function(){var a,i;this._preventPanelClose();var s=this.element.find(".filterOptions")[0].value,u=[this.element.find("#filterValue1")[0].value],o,f=[],e=this._selectedField;if(this._filterAction=="valueFiltering"){if(o=this._measureDDL.getSelectedValue(),!(!isNaN(parseFloat(u[0]))&&isFinite(u[0]))||o=="")return;this.element.find("#filterValue2")[0]!=r?","+u.push(this.element.find("#filterValue2")[0].value):u}if(this.element.find(".e-dialog").remove(),this._schemaData){var h=t.buildTag("span.filter").addClass("e-icon")[0].outerHTML,c=this._schemaData._tableTreeObj.element.find("li[tag='"+this._selectedLevelUniqueName+"'] div:eq(0)"),l=this._schemaData._tableTreeObj.element.find("li[tag ='"+e+"'] div:eq(0)");c.find(".filter").length==0&&c.append(h);l.find(".filter").length===0&&l.append(h)}a=this._selectedLevelUniqueName.toLowerCase();i=n.map(this.model.dataSource.columns,function(n){if(n.fieldName!=r&&n.fieldName.toLocaleLowerCase()==e.toLowerCase())return n});i.length==0&&(i=n.map(this.model.dataSource.rows,function(n){if(n.fieldName!=r&&n.fieldName.toLocaleLowerCase()==e.toLowerCase())return n}));i.length>0&&(delete i[0].filterItems,i[0].advancedFilter&&(f=n.map(i[0].advancedFilter,function(n){if(n.name!=r&&n.name.toLocaleLowerCase()!=a)return n})),this._filterAction.toLowerCase()=="labelfiltering"?f.push({name:this._selectedLevelUniqueName,labelFilterOperator:s.replace(/ /g,""),advancedFilterType:t.olap.AdvancedFilterType.LabelFilter,values:u}):f.push({name:this._selectedLevelUniqueName,valueFilterOperator:s.replace(/ /g,""),advancedFilterType:t.olap.AdvancedFilterType.ValueFilter,values:u,measure:o}),this._currentReportItems=n.grep(this._currentReportItems,function(n){if(n.fieldName!=e)return n}),i[0].advancedFilter=f);this._waitingPopup.show();this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this)},_nodeCheckChanges:function(i){if(this._isMembersFiltered=!0,(i.value=="(All)"||i.value=="All")&&i.type=="nodeUncheck")this._memberTreeObj.model.nodeCheck="",this._memberTreeObj.model.nodeUncheck="",this.element.find(".editorTreeView").ejTreeView("unCheckAll"),this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this),this._dialogOKBtnObj.disable();else if((i.value=="(All)"||i.value=="All")&&i.type=="nodeCheck")this._memberTreeObj.model.nodeCheck="",this._memberTreeObj.model.nodeUncheck="",this.element.find(".editorTreeView").ejTreeView("checkAll"),n(this._memberTreeObj.element.find("li:first")).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-stop"),this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this),this._dialogOKBtnObj.enable();else if(i.value!="(All)"){var r=this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:not(:checked)"),u=n(this._memberTreeObj.element.find("li:first")).find("div .e-chkbox-small > span > span:eq(0)");r.length==0||r.length==1&&r[0].id[r[0].id.length-1]==0?(n(u).parent().removeClass("e-chk-inact").removeClass("e-chk-ind").addClass("e-chk-act"),u.removeClass("e-stop").addClass("e-checkmark")):i.type=="nodeCheck"&&r.length==1&&r[0].id[r[0].id.length-1]==0?u.removeClass("e-stop").addClass("e-checkmark"):r.length>0&&u.removeClass("e-checkmark").addClass("e-stop");this._dialogOKBtnObj.enable();i.type=="nodeUncheck"&&r.length+1==this._memberTreeObj.element.find("li").length&&(u.removeClass("e-checkmark").removeClass("e-stop"),this._dialogOKBtnObj.disable())}},_fetchMemberSuccess:function(n){n[0]!=r&&n.length>0?(this._currentMembers=n[0].Value,n[1]!=null&&n[1]!=r&&(this.model.customObject=n[1].Value)):n.d!=r&&n.d.length>0?(this._currentMembers=n.d[0].Value,n.d[1]!=null&&n.d[1]!=r&&(this.model.customObject=n.d[1].Value)):n!=r&&n.length>0?(this._currentMembers=n.EditorTreeInfo,n!=null&&n!=r&&(this.model.customObject=n.customObject)):n!=r&&(this._currentMembers=n.EditorTreeInfo);this._createDialog(this._dialogHead,this._currentMembers);this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"fetchMembers",element:this.element,customObject:this.model.customObject});this.model.dataSource.enableAdvancedFilter?this.element.find(".e-dialog #GroupLabelDrop_wrapper:visible").first().attr("tabindex","-1").focus().addClass("hoverCell"):t.isNullOrUndefined(this.element.find(".e-dialog .e-text:visible").first())||this.element.find(".e-dialog .e-text:visible").first().attr("tabindex","-1").focus().addClass("hoverCell");this._waitingPopup.hide()},_filterElementSuccess:function(n){n[0]!=r?n[2]!=null&&n[2]!=r&&(this.model.customObject=n[2].Value):n.d!=r?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):n.customObject!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject});this._renderControlSuccess(n)},_sortingSuccess:function(n){n[0]!=r?n[2]!=r&&n.length>0&&(this.model.customObject=n[2].Value):n.d!=r&&n.d.length>0?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):n!=r&&n.length>0&&n.customObject!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject});this._renderControlSuccess(n)},_nodeExpand:function(i){var u=i.event.originalEvent!=r&&i.event.originalEvent.target!=r?i.event.originalEvent.target:i.event.target,o="",v=n(u).parents("li").first().children().find("li").length,l,s,c,e,h,f,a;if(u!=r&&u.className!=r&&u.className!=""&&u.className.indexOf("e-plus")>-1&&v==0){n(u).removeClass("e-plus").addClass("e-load");l=n(u).parent().find("input.e-checkbox").prop("checked");c=n(u).parents("li").first().attr("tag");this.pNode=u;try{s=JSON.parse(this.model.pivotControl!=r?this.model.pivotControl.getOlapReport():this.getOlapReport()).Report}catch(y){s=this.model.pivotControl!=r?this.model.pivotControl.getOlapReport():this.getOlapReport()}for(e=this.element.find(".pivotButton"),f=0;f<e.length>0;f++)n(e[f]).attr("tag").indexOf(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?"":this._schemaData._curFilteredText:this._curFilteredText)>-1&&n(e[f]).attr("tag").split(":")[1].length==(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?0:this._schemaData._curFilteredText.length:this._curFilteredText.length)?o=n(e[f]).attr("tag"):n(e[f]).attr("tag").indexOf(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?"":this._schemaData._curFilteredText:this._curFilteredText)>-1&&(h=n(e[f]).attr("tag"));o=o==""?t.isNullOrUndefined(h)?t.isNullOrUndefined(this._curFilteredText)?this._schemaData._curFilteredText:this._curFilteredText:h.split(":")[1]:o.split(":")[1];this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"memberExpanded",element:this.element,customObject:this.model.customObject});a=JSON.stringify(this.model.customObject);this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.memberExpand,JSON.stringify({action:"memberExpanded",checkedStatus:l,parentNode:n(u).parents("li")[0].id,tag:c,cubeName:JSON.parse(this._olapReport).CurrentCube+"##"+o,currentReport:s,customObject:a}),this._fetchChildNodeSuccess)}},_fetchChildNodeSuccess:function(i){var u,f,e;i.length>1&&i[0]!=r?(u=JSON.parse(i[0].Value),i[1]!=null&&i[1]!=r&&(this.model.customObject=i[1].Value)):i.d!=r?(u=JSON.parse(i.d[0].Value),i.d[1]!=null&&i.d[1]!=r&&(this.model.customObject=i.d[1].Value)):(u=JSON.parse(i.ChildNodes),i.customObject!=null&&i.customObject!=r&&(this.model.customObject=i.customObject));e={id:"id",parentId:"pid",hasChild:"hasChildren",text:"name",isChecked:"checkedStatus"};f=n(this.pNode).parents("li").length>1?n(this.pNode).parents("li").first():n(this.pNode).parents("li");n(n(f).find("input.nodecheckbox")[0]).ejCheckBox({checked:!1});!t.isNullOrUndefined(this._memberTreeObj)&&this._editorFlag?this._memberTreeObj._createSubNodesWhenLoadOnDemand(u,this.pNode,e):t.isNullOrUndefined(this._schemaData._memberTreeObj)||this._schemaData._memberTreeObj._createSubNodesWhenLoadOnDemand(u,this.pNode,e);n.each(n(f).children().find("li"),function(n,t){t.setAttribute("tag",u[n].tag)});this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"memberExpanded",element:this.element,customObject:this.model.customObject});t.isNullOrUndefined(this._schemaData)||this.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")},_beforeNodeExpand:function(n){t.Pivot.getChildNodes(n,this._selectedField,this._currentReportItems,this.model.dataSource,this)},_generateMembers:function(i,r){var o=n(r).find("Axis:eq(0) Tuple"),f=[],s={},u,e,h;for(f.push({id:"All",name:"All",checkedStatus:!0,tag:""}),u=0;u<o.length;u++)e=n(n(r).find("Axis:eq(0) Tuple:eq("+u+")").children().children()[0]).text(),h=n(n(r).find("Axis:eq(0) Tuple:eq("+u+")").children().children()[1]).text(),s={hasChildren:n(o[u]).find("CHILDREN_CARDINALITY").text()!="0",checkedStatus:!0,id:e.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-"),name:h,tag:e},f.push(s);t.isNullOrUndefined(this.olapCtrlObj)||(this.olapCtrlObj._waitingPopup.hide(),this.olapCtrlObj._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(f)}))},_filterBtnClick:function(i){var e,u,o;if(this._editorFlag=!0,this.model.operationalMode==t.Pivot.OperationalMode.ClientMode)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap){var f=this._selectedField=n(i.currentTarget.parentNode).attr("tag").split(":")[1],r=[];this._dialogHead=n(i.currentTarget.parentNode).text();r=n.map(this._currentReportItems,function(n){if(n.fieldName==f)return n.filterItems});r.length>0?this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(r)}):(t.olap._mdxParser.getMembers(this.model.dataSource,f,this),this._waitingPopup.show())}else this._selectedField=n(i.target).siblings(".pvtBtn").attr("fieldName"),this._dialogHead=n(i.target).siblings(".pvtBtn").text(),this._selectedAxis=n(i.target).siblings(".pvtBtn").attr("axis"),e=this._getTreeViewData(this._selectedField,this._selectedAxis),this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(e)});else{this._curFilteredAxis=i.target.parentElement.attributes.tag.value.split(":")[0];this._curFilteredText=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?i.target.parentElement.attributes.tag.value:n(n(i.target).siblings()[1]).attr("fieldname");this._dialogTitle=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?i.target.parentElement.attributes.tag.value:n(n(i.target).siblings()[1]).attr("fieldname");this._dialogHead=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?i.target.parentElement.title:n(n(i.target).siblings()[1]).text();try{u=JSON.parse(this.getOlapReport()).Report}catch(s){u=this.getOlapReport()}this._waitingPopup.show();t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(n(this._schemaData.element).width()).height(n(this._schemaData.element).height()).css({top:n(this._schemaData.element).offset().top,left:n(this._schemaData.element).offset().left});this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"fetchMembers",element:this.element,customObject:this.model.customObject});o=JSON.stringify(this.model.customObject);eventArgs=JSON.stringify({action:"fetchMembers",headerTag:this._dialogTitle,sortedHeaders:this._ascdes,currentReport:u,customObject:o});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchMembers,eventArgs,this._fetchMemberSuccess)}},_getTreeViewData:function(i){var e=t.Pivot.getReportItemByFieldName(i,this.model.dataSource).item,f=t.PivotAnalysis.getMembers(i),o=[{id:"All",name:"All",checkedStatus:!0}],u;if(e.filterItems!=null&&e.filterItems!=r)for(u=0;u<f.length;u++)o.push({id:f[u],name:f[u],checkedStatus:e.filterItems.filterType==t.PivotAnalysis.FilterType.Include?n.inArray(f[u]!=null?f[u].toString():f[u],e.filterItems.values)>=0:n.inArray(f[u]!=null?f[u].toString():f[u],e.filterItems.values)<0});else for(u=0;u<f.length;u++)o.push({id:f[u],name:f[u],checkedStatus:!0});return o},_applyToolTip:function(i){var h,o,u,e="",f,b,c,p,v,l,s,a,y,w;if(valueCell="",f=n(i.target).hasClass("cellValue")?i.target.parentElement:i.target,n(f).find("input").length==0&&!n(f).hasClass("curInput")&&!t.isNullOrUndefined(n(f).attr("role"))){if(u=this.element.find(".summary[role!='gridcell'][p$=',"+n(f).attr("p").split(",")[1]+"'] , .rowheader[role!='gridcell'][p$=',"+n(f).attr("p").split(",")[1]+"']").last().attr("p"),u==null&&(u=this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?n(f).parent("tr").find(".summary,.rowheader").attr("p"):n(f).parent("tr").find(".summary").attr("p")),u!=null)if(u[0]==0&&parseInt(u.split(",")[0])!=null)u==this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Index&&(o=this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Value);else while(u[0]>=0)u==this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Index&&(h=this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Value,u=parseInt(u.split(",")[0])-1+","+parseInt(u.split(",")[1])),o=o?h+"-"+o:h;for(b=this.element.find('tr:has(".colheader")').length-1,c=n(f).attr("p"),c!=r&&c==this.getJSONRecords()[parseInt(parseInt(c.split(",")[0])*this._rowCount+parseInt(c.split(",")[1]))].Index&&(p=parseInt(c.split(",")[0])),v=0;v<=b;v++)l=p+","+v,p!=null&&l==this.getJSONRecords()[parseInt(parseInt(l.split(",")[0])*this._rowCount+parseInt(l.split(",")[1]))].Index&&(h=this.getJSONRecords()[parseInt(parseInt(l.split(",")[0])*this._rowCount+parseInt(l.split(",")[1]))].Value,e==""?e=h:h!=""&&(e=e+"-"+h));n("#"+this._id+"_gridTooltip").remove();this.element.find("span#celval").remove();s=n(f).position();(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(s.left=s.left+(this.model.frozenHeaderSettings.enableFrozenHeaders?this.element.find(".rowhead").width():this.model.frozenHeaderSettings.enableFrozenRowHeaders?this.element.find("#coltable").width():0));n("#"+this._id).append('<div id="'+this._id+'_gridTooltip" class="pGridTooltip" role=\'tooltip\'><\/div>');n(f).append("<span id='celval' style='display:none'>row- "+o+": column- "+e+"<\/span>");n(f).find("span.cellValue").attr("aria-describedby","span#celval");a=n(f).find("span.cellValue:not('#celval')").text();this.model.enableRTL?(n("#"+this._id+"_gridTooltip").append('<p id="value" class="tooltipText">'+(a?a:this._getLocalizedLabels("NoValue"))+":"+this._getLocalizedLabels("ToolTipValue")+"<\/p>"),n("#"+this._id+"_gridTooltip").append('<p id="row" class="tooltipText">'+(o==r||this._rowCount==1?this._getLocalizedLabels("NoValue"):this._direction(o))+":"+this._getLocalizedLabels("ToolTipRow")+"<\/p>"),n("#"+this._id+"_gridTooltip").append('<p id="column" class="tooltipText">'+(e==r||e==""?this._getLocalizedLabels("NoValue"):this._direction(e))+":"+this._getLocalizedLabels("ToolTipColumn")+"<\/p>")):(n("#"+this._id+"_gridTooltip").append('<p id="value" class="tooltipText">'+this._getLocalizedLabels("ToolTipValue")+": "+(a?a:this._getLocalizedLabels("NoValue"))+"<\/p>"),n("#"+this._id+"_gridTooltip").append('<p id="row" class="tooltipText">'+this._getLocalizedLabels("ToolTipRow")+": "+(o==r||this._rowCount==1?this._getLocalizedLabels("NoValue"):o)+"<\/p>"),n("#"+this._id+"_gridTooltip").append('<p id="column" class="tooltipText">'+this._getLocalizedLabels("ToolTipColumn")+": "+(e==r||e==""?this._getLocalizedLabels("NoValue"):e)+"<\/p>"));y=0;y=typeof oclientProxy!="undefined"?n("#"+this._id).parent().position().left+oclientProxy.element.find(".gridContainer").width():n("#"+this._id).parent().position().left+n("#"+this._id).parent().width();w=s.left+n("#"+this._id+"_gridTooltip").width();n("#"+this._id+"_gridTooltip").css({left:(s.left>0?s.left:0)+(y-w<0?y-w-20:5),top:n(this.element).height()-s.top<100?s.top-n("#"+this._id+"_gridTooltip").outerHeight()-2:s.top+40});this.model.enableToolTipAnimation?n("#"+this._id+"_gridTooltip").show("fast"):n("#"+this._id+"_gridTooltip").show();typeof oclientProxy!="undefined"&&oclientProxy.controlPlacement()=="tile"&&n("#"+this._id+"_gridTooltip").css("position","absolute")}},_applyVScrolling:function(){var v,h=typeof oclientProxy!="undefined"&&oclientProxy.model.enableVirtualScrolling,y=h?oclientProxy.element.find(".e-pivotgrid"):n(this.element).find(".virtualScrollGrid"),r=h?oclientProxy:this,i=h&&!t.isNullOrUndefined(oclientProxy._pivotGrid)?oclientProxy._pivotGrid:this,s,l,e,c,f,a,u,o;if(i._seriesPageCount>1){s=function(){return Math.round(r.element.find(".vScrollPanel").position().top)+1};l=n(r.element).find(".vScrollPanel");l.height(h?parseInt(oclientProxy._gridHeight):n(y).height());l.html(t.buildTag("div.vScrollThumb")[0].outerHTML);e=l.find(".vScrollThumb");e.height(Math.max(Math.ceil((h?parseInt(oclientProxy._gridHeight):n(y).height())/i._seriesPageCount),15));c=l.height()-e.height()-2;e.offset({top:s()+(i._seriesCurrentPage-1)*(c/(i._seriesPageCount-1))});n(".vScrollPanel").on("mousewheel DOMMouseScroll",function(t){var u,f;n("body").on("mousewheel DOMMouseScroll",function(n){return n.preventDefault(),n.stopPropagation(),!1});initThumbPos=e.position().top-s();u=i._seriesCurrentPage;movedDistance=t.originalEvent.wheelDelta<0||t.originalEvent.detail>0?t.target.offsetParent.offsetTop+10:-t.target.offsetParent.offsetTop-10;r.element.find(".seriesPageIndicator").removeClass("inActive").css({top:e.position().top,left:e.position().left+20});u=i._seriesCurrentPage;window.navigator.userAgent.indexOf("MSIE ")>-1?n(document).on("selectstart",function(n){n.preventDefault()}):window.getSelection().removeAllRanges();movedDistance>0&&initThumbPos+movedDistance<=c||movedDistance<0&&initThumbPos+movedDistance>=0?f=initThumbPos+movedDistance+s():initThumbPos+movedDistance>c?f=s()+c:initThumbPos+movedDistance<0?f=s():"";e.offset({top:f});u=Math.ceil((e.position().top-s())/(c/i._seriesPageCount))==0?1:Math.ceil((e.position().top-s())/(c/i._seriesPageCount));u>i._seriesPageCount&&(u=i._seriesPageCount);r.element.find(".seriesPageIndicator").css({top:e.position().top});r.element.find(".series_CurrentPage").html(u);u!=i._seriesCurrentPage&&(i._seriesCurrentPage=u,clearTimeout(v),v=setTimeout(function(){h?oclientProxy.refreshPagedPivotClient("series",i._seriesCurrentPage):i.refreshPagedPivotGrid("series",i._seriesCurrentPage)},250))});n(e).on("mousedown touchstart",function(t){var o,u,f;n(this).addClass("dragging");o=t.pageY-s();u=e.position().top-s();r.element.find(".seriesPageIndicator").removeClass("inActive").css({top:e.position().top,left:e.position().left+20});f=i._seriesCurrentPage;n(document).on("mousemove touchmove",function(t){if(window.navigator.userAgent.indexOf("Trident")>-1)n(document).on("selectstart",function(n){n.preventDefault()});else window.getSelection().removeAllRanges();var h=t.pageY-s()-o;h>0&&u+h<=c?e.offset({top:u+h+s()}):h<0&&u+h>=0?e.offset({top:u+h+s()}):u+h>c?e.offset({top:s()+c}):u+h<0&&e.offset({top:s()});f=Math.floor((Math.round(e.position().top)-s())/(c/i._seriesPageCount))==0?1:Math.floor((Math.round(e.position().top)-s())/(c/i._seriesPageCount));r.element.find(".seriesPageIndicator").css({top:e.position().top});r.element.find(".series_CurrentPage").html(f);r.element.find(".vScrollThumb").attr("title",r.element.find(".seriesPageIndicator").text())});n(document).on("mouseup touchend",function(){n(document).off("selectstart");n(this).off("mousemove touchmove").off("mouseup touchend");n(e).removeClass("dragging");f!=i._seriesCurrentPage?(i._seriesCurrentPage=f,h?oclientProxy.refreshPagedPivotClient("series",i._seriesCurrentPage):i.refreshPagedPivotGrid("series",i._seriesCurrentPage)):r.element.find(".seriesPageIndicator").addClass("inActive")})})}if(i._categPageCount>1){f=function(){return Math.round(r.element.find(".hScrollPanel").position().left)+1};a=n(r.element).find(".hScrollPanel");a.width(h?parseInt(oclientProxy._gridWidth):n(y).width());a.html(t.buildTag("div.hScrollThumb")[0].outerHTML);u=a.find(".hScrollThumb");u.width(Math.max(Math.ceil((h?parseInt(oclientProxy._gridWidth):n(y).width())/i._categPageCount),15));o=a.width()-u.width()-2;this.model.enableRTL?u.css({right:(i._categCurrentPage-1)*(o/(i._categPageCount-1))}):u.offset({left:f()+(i._categCurrentPage-1)*(o/(i._categPageCount-1))});n(".hScrollPanel").on("mousewheel DOMMouseScroll",function(t){n("body").on("mousewheel DOMMouseScroll",function(n){return n.preventDefault(),n.stopPropagation(),!1});initThumbPos=r.model.enableRTL?r.element.find(".hScrollPanel").width()-(u.position().left+16-f()):u.position().left-f();currentPage=i._categCurrentPage;movedDistance=t.originalEvent.wheelDelta<0||t.originalEvent.detail>0?h?t.target.offsetParent.children[1].offsetLeft+10:t.target.offsetParent.offsetLeft+10:h?-t.target.offsetParent.children[1].offsetLeft-10:-t.target.offsetParent.offsetLeft-10;movedDistance=r.model.enableRTL?-movedDistance:movedDistance;r.element.find(".categPageIndicator").removeClass("inActive").css({left:u.position().left,top:u.position().top+20});window.navigator.userAgent.indexOf("MSIE ")>-1?n(document).on("selectstart",function(n){n.preventDefault()}):window.getSelection().removeAllRanges();var e;r.model.enableRTL?movedDistance>0&&initThumbPos+movedDistance<=o||movedDistance<0&&initThumbPos+movedDistance>=0?e=initThumbPos+movedDistance:initThumbPos+movedDistance>o?e=o:initThumbPos+movedDistance<0?e=0:"":movedDistance>0&&initThumbPos+movedDistance<=o||movedDistance<0&&initThumbPos+movedDistance>=0?e=initThumbPos+movedDistance+f():initThumbPos+movedDistance>o?e=f()+o:initThumbPos+movedDistance<0?e=f():"";r.model.enableRTL?u.css("right",e):u.offset({left:e});currentPage=r.model.enableRTL?Math.floor((r.element.find(".hScrollPanel").width()-(u.position().left+16-f()))/(o/i._categPageCount))==0?1:Math.floor((r.element.find(".hScrollPanel").width()-(u.position().left+16-f()))/(o/i._categPageCount)):Math.floor((Math.round(u.position().left)-f())/(o/i._categPageCount))==0?1:Math.floor((Math.round(u.position().left)-f())/(o/i._categPageCount));currentPage=currentPage>i._categPageCount?i._categPageCount:currentPage<1?1:currentPage;r.element.find(".categPageIndicator").css({left:u.position().left});r.element.find(".categ_CurrentPage").html(currentPage);currentPage!=i._categCurrentPage&&(i._categCurrentPage=currentPage,clearTimeout(v),v=setTimeout(function(){h?oclientProxy.refreshPagedPivotClient("categ",i._categCurrentPage):i.refreshPagedPivotGrid("categ",i._categCurrentPage)},250))});n(u).on("mousedown touchstart",function(t){var c,e,s;n(this).addClass("dragging");c=r.model.enableRTL?r.element.find(".hScrollPanel").width()-(t.pageX-f()):t.pageX-f();e=r.model.enableRTL?r.element.find(".hScrollPanel").width()-(u.position().left+16-f()):u.position().left-f();r.element.find(".categPageIndicator").removeClass("inActive").css({left:u.position().left,top:u.position().top+20});s=i._categCurrentPage;n(document).on("mousemove touchmove",function(t){if(window.navigator.userAgent.indexOf("Trident")>-1)n(document).on("selectstart",function(n){n.preventDefault()});else window.getSelection().removeAllRanges();var h=r.model.enableRTL?r.element.find(".hScrollPanel").width()-(t.pageX-f())-c:t.pageX-f()-c;h>0&&e+h<=o?r.model.enableRTL?u.css({right:e+h}):u.offset({left:e+h+f()}):h<0&&e+h>=0?r.model.enableRTL?u.css({right:e+h}):u.offset({left:e+h+f()}):e+h>o?r.model.enableRTL?u.css({right:o}):u.offset({left:f()+o}):e+h<0&&(r.model.enableRTL?u.css({right:"0px"}):u.offset({left:f()}));s=r.model.enableRTL?Math.floor((r.element.find(".hScrollPanel").width()-(u.position().left+16-f()))/(o/i._categPageCount))==0?1:Math.floor((r.element.find(".hScrollPanel").width()-(u.position().left+16-f()))/(o/i._categPageCount)):Math.floor((Math.round(u.position().left)-f())/(o/i._categPageCount))==0?1:Math.floor((Math.round(u.position().left)-f())/(o/i._categPageCount));s=s>i._categPageCount?i._categPageCount:s<1?1:s;r.element.find(".categPageIndicator").css({left:u.position().left});r.element.find(".categ_CurrentPage").html(s);r.element.find(".hScrollThumb").attr("title",r.element.find(".categPageIndicator").text())});n(document).on("mouseup touchend",function(){n(document).off("selectstart");n(this).off("mousemove touchmove").off("mouseup touchend");n(u).removeClass("dragging");s!=i._categCurrentPage?(i._categCurrentPage=s,h?oclientProxy.refreshPagedPivotClient("categ",i._categCurrentPage):i.refreshPagedPivotGrid("categ",i._categCurrentPage)):r.element.find(".categPageIndicator").addClass("inActive")})})}n("body").off("mousewheel DOMMouseScroll")},_getLocalizedLabels:function(n){return t.PivotGrid.Locale[this.locale()][n]===r?t.PivotGrid.Locale["en-US"][n]:t.PivotGrid.Locale[this.locale()][n]},_drillDown:function(i){var v,h,u,y,r,p,a,w,c,k,s;if(this._drillCaption=n(i.target).parent().find(".cellValue").text(),u=i.target.className,this._startDrilldown=!0,u=u.split(" "),n(i.target).hasClass("expand")?this._drillAction="drilldown":n(i.target).hasClass("collapse")&&(this._drillAction="drillup"),v=n(n(i.target).parent()).hasClass("rowheader")||n(n(i.target).parent()).attr("role")=="rowheader"?"rowheader":"colheader",this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){this._waitingPopup.show();for(var l=n(i.target).parent().attr("p"),f=this.getJSONRecords()[parseInt(parseInt(l.split(",")[0])*this._rowCount+parseInt(l.split(",")[1]))].Info,b=f.replace(/&/g,"&amp;"),e=parseInt(l.split(",")[0]),o=parseInt(l.split(",")[1]);e>0;){for(e--,s=this.getJSONRecords()[e*this._rowCount+o].Info;s==""&&o>0;)o--,s=this.getJSONRecords()[e*this._rowCount+o].Info;f=s+">#>"+f}return this.element.parents(".e-pivotclient").length>0?(h=this.element.parents(".e-pivotclient").data("ejPivotClient"),v=="rowheader"&&h.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(h._drillInfo=f,h.setChartDrillParams(f,this._drillAction))):h=this,h._pivotRecords={records:this.getJSONRecords(),rowCount:this._rowCount},n(i.target).hasClass("collapse")?this.updateDrilledReport({uniqueName:b,index:l,action:"collapse"},v,h):this.updateDrilledReport({uniqueName:b,index:l},v,h),!1}if(this.element.find(".e-dialog").remove(),!this.model.enableDeferUpdate){this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this._off(this.element,"click",".expand, .collapse");this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.element.find(".colheader, .rowheader, .value").removeClass("e-droppable");u=i.target.className;this._startDrilldown=!0;u=u.split(" ");u[0]=="expand"?this._drillAction="drilldown":u[0]=="collapse"&&(this._drillAction="drillup");this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"drillDown",element:this.element,customObject:this.model.customObject});y=JSON.stringify(this.model.customObject);r=n(i.target).parent().attr("p");this._drillCaption=n(i.target).parent().find(".cellValue").text();typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?n("#"+oclientProxy._id+"_maxView")[0]?(n("#"+oclientProxy._id+"_maxView").ejWaitingPopup({showOnInit:!0}),this._maxViewLoading=n("#"+oclientProxy._id+"_maxView").data("ejWaitingPopup")):oclientWaitingPopup.show():this._waitingPopup.show();p=this.model.analysisMode=="relational"?this._drillHeaders.join("||"):this.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*this._rowCount+parseInt(r.split(",")[1]))].Info;try{a=JSON.parse(this.getOlapReport()).Report}catch(d){a=this.getOlapReport()}if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){w=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(this.element).find("pivotGridTable"):n(this.element).find("table").detach();c=this._getFieldName(n(i.target).parent()[0]);n(i.target).hasClass("collapse")?(t.isNullOrUndefined(this.model.collapsedMembers)&&(this.model.collapsedMembers={}),t.isNullOrUndefined(this.model.collapsedMembers[c])?this.model.collapsedMembers[c]=[n(i.target).parent()[0].textContent]:this.model.collapsedMembers[c].push(n(n(i.target).parent()[0]).clone().children().remove().end().text())):n(i.target).hasClass("expand")&&(this.model.collapsedMembers[c]=n.grep(this.model.collapsedMembers[c],function(t){return t!=n(i.target).parent()[0].textContent}));k=n(n(i.target).parent()).hasClass("rowheader")||n(n(i.target).parent()).attr("role")=="rowheader"?"rowheader":n(n(i.target).parent()).hasClass("colheader")||n(n(i.target).parent()).attr("role")=="columnheader"?"columnheader":"";this._collapseMember(w,i.target);this.element.append(w);(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&this._applyFrozenHeaderWidth(this._JSONRecords,this._drillAction);this._hideGrandTotal(w);this.model.enableGroupingBar&&(tableWidth=n("#"+this._id).find(".pivotGridTable").width(),this.element.find(".groupingBarPivot .drag").width(tableWidth-5),cellWidth=n("#"+this._id).find(".pivotGridTable").find("th").width(),this.element.find(".groupingBarPivot .values").width(cellWidth-2),this.element.find(".groupingBarPivot .columns").width(tableWidth-cellWidth),this.element.find(".groupingBarPivot .valueColumn").width(tableWidth));this.element.find(".colheader, .rowheader, .value").addClass("e-droppable");this._waitingPopup.hide();var g=i,e=parseInt(r.split(",")[0]),o=parseInt(r.split(",")[1]),f=this._drillCaption;if(k=="rowheader")while(e>0){for(e--,s=this.getJSONRecords()[this._rowCount*e+o].Value;s==""&&o>0;)o--,s=this.getJSONRecords()[this._rowCount*e+o].Value;f=s+">#>"+f}this._trigger("drillSuccess",{gridObj:this,drillAction:this._drillAction,drilledMember:f,fieldName:c,axis:v,cellPosition:r});this.model.enableGroupingBar&&this._createFields("drilldown",n("#"+this._id).find(".pivotGridTable").width(),n("#"+this._id).find(".pivotGridTable th").outerWidth());this._unWireEvents();this._wireEvents();this._drillAction=""}else this.layout()!=""||this.layout()!="normal"?typeof oclientProxy!="undefined"?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:r,currentReport:a,clientReports:oclientProxy.reports,headerInfo:p,layout:this.layout(),customObject:y}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:r,currentReport:a,headerInfo:p,layout:this.layout(),customObject:y}),this._drillDownSuccess):typeof oclientProxy!="undefined"?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:r,currentReport:a,clientReports:oclientProxy.reports,headerInfo:p,customObject:y}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:r,currentReport:a,headerInfo:p,customObject:y}),this._drillDownSuccess)}},_collapseMember:function(i,u){var o=n(u).parent()[0],y=n(o).attr("p"),ht=n(u).attr("tag")!=r?parseInt(n(u).attr("tag"))+o.rowSpan:o.rowSpan,at=n(u).attr("tag")!=r?parseInt(n(u).attr("tag"))+o.colSpan:o.colSpan,f=n(u).closest("tr")[0],gt=null,ni=null,et="false",yt=0,vt,wt,it,ot,tt,k,v,ii,c,p,s,w,fi,st,a,ut,l,ft,ct,nt,h,lt,b,e;if(o.className.indexOf("rowheader")>=0||o.className.indexOf("summary")>=0&&n(o).attr("role")=="rowheader"){if(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout){var ui=this.getJSONRecords()[1].Index=="0,0"?1:0,ht=this.getJSONRecords()[parseInt(y.split(",")[0])*this._rowCount+parseInt(y.split(",")[1])+ui].RowSpan,pt=f;for(n(u).attr("class").indexOf("expand")>-1&&n(f).removeAttr("tag"),s=0;s<ht;s++)n(u).attr("class").indexOf("collapse")>-1&&(n(n(f).next()).attr("tag")==r&&n(n(f).next()).attr("tag",y),n(n(f).next()).css("display","none"),(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&this.element.find(".valueCell td[i$=',"+n(n(f).next()).find("td").attr("i").split(",")[1]+"']").css("display","none")),n(u).attr("class").indexOf("expand")>-1&&(n(n(f).next()).attr("tag")==r||n(n(f).next()).attr("tag")==y)&&(n(n(f).next()).css("display","table-row"),n(n(f).next()).removeAttr("tag"),(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&this.element.find(".valueCell td[i$=',"+n(n(f).next()).find("td").attr("i").split(",")[1]+"']").css("display","")),f=n(f).next();vt=this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders?"td":"th";wt=n(pt).find(vt+" span:not(.cellValue)").css("margin-left");n(pt).find(vt+" span:not(.cellValue)").remove();n(pt).find(vt).prepend(n(u).attr("class").indexOf("collapse")>-1?'<span style="margin-left:'+wt+'" class="expand e-icon" aria-describedby=\'expansion\' title="'+this._getLocalizedLabels("Expand")+"\">&nbsp;<p id='expansion' style='display:none'>collapsed<\/p><\/span>":'<span style="margin-left:'+wt+'" class="collapse e-icon" aria-describedby=\'collapsing\' title="'+this._getLocalizedLabels("Collapse")+"\">&nbsp;<p id='collapsing' style='display:none'>expanded<\/p><\/span>");return}var ti=!n(o).index()>0,bt=isLeafHide=!1;if(n(u).attr("class").indexOf("collapse")>-1){for(s=0;s<ht;s++){if(gt=n(f).next(),ti)n(f).find(".stot,.rstot").length>=1&&s==1&&n(n(f).find(".stot,.rstot")).find(".expand").length>=1&&(isLeafHide=!0),(n(n(f).find(".stot,.rstot")).find(".expand").length>=1||n(f).css("display")=="none")&&(bt=!0),n(f).css("display","none"),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(this.element.find(".valueCell td[p$=',"+n(f).find("td").attr("p").split(",")[1]+"']").css("display","none"),this.element.find(".valueCell td[p$=',"+n(f).find("td").attr("p").split(",")[1]+"']").attr("tag",n(f).attr("tag")!=r?parseInt(n(f).attr("tag"))+1:1)),n(f).attr("tag",n(f).attr("tag")!=r?parseInt(n(f).attr("tag"))+1:1);else{for(v=o,b=0;b<=n(o).nextAll().length;b++)n(v).css("display","none").attr("hc",n(v).attr("hc")==r?1:parseInt(n(v).attr("hc"))+1),v=n(v).next();isTdSubSameRow=!1;et="true"}f=gt;ti=!0}for(it=et=="true"?o.rowSpan-1:o.rowSpan,n(f).css("display")!="none"&&isLeafHide&&(ot=n(u).attr("subTag")!=r?parseInt(n(u).attr("subTag"))==-1?o.rowSpan+1:parseInt(n(u).attr("subTag"))+o.rowSpan:o.rowSpan),n(f).css("display")=="none"&&(n(f).css("display",""),bt=!0,it=it-1),bt&&t.isNullOrUndefined(ot)&&(ot=n(u).attr("subTag")!=r?parseInt(n(u).attr("subTag"))==-1?o.rowSpan:parseInt(n(u).attr("subTag"))+o.rowSpan:o.rowSpan),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&this.element.find(".valueCell").length>0?(n(f).find("td").text(n(f).find("td").text().replace(" Total","")),n(f).find("td span:not(.cellValue)").remove(),n(f).find("td").prepend('<span class="expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" tag="'+ht+":"+et+'">&nbsp;<\/span>')):(n(f).find("th").text(n(f).find("th").text().replace(" Total","")),n(f).find("th span:not(.cellValue)").remove(),n(f).find("th").prepend('<span class="expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" tag="'+ht+":"+et+(t.isNullOrUndefined(ot)?"":n(u).attr("isChildSubNode")=="true"?'" subTag="'+ot+":"+et+'" isChildSubNode="true':'" subTag="'+ot+":"+et)+'">&nbsp;<\/span>')),c=n(f).prevAll().find("th:has(span):not(.summary)"),s=0;s<c.length;s++)parseInt(n(c[s]).attr("p").split(",")[0])<parseInt(y.split(",")[0])&&parseInt(n(c[s]).attr("p").split(",")[1])+c[s].rowSpan+(n(c[s]).find("span").attr("tag")!=r?parseInt(n(c[s]).find("span").attr("tag")):0)>=parseInt(y.split(",")[1])+ht&&(c[s].rowSpan-=it,n(c[s]).find("span").attr("tag")==r&&n(c[s]).find("span").attr("isChildSubNode",!0),n(c[s]).find("span").attr("tag",n(c[s]).find("span").attr("tag")!=r?parseInt(n(c[s]).find("span").attr("tag"))+it:it),n(c[s]).find("span").attr("subTag",n(c[s]).find("span").attr("subTag")!=r?parseInt(n(c[s]).find("span").attr("subTag"))+it:it))}else if(n(u).attr("class").indexOf("expand")>-1){for(tt=removeSubSpan=this._isSubTotalhidden=!1,k=0,s=parseInt(n(u).attr("tag").split(":")[0]);s>=0;s--)ni=n(f).prev(),n(f).attr("tag")==r||parseInt(n(f).attr("tag"))<=1?(this._hideSubTotal(n(f),k,n(u)),this._isSubTotalHide?(tt=!0,this._isSubTotalHide=!1,n(f).css("display","none")):(n(f).css("display","table-row"),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&this.element.find(".valueCell td[p$=',"+n(f).find("td").attr("p").split(",")[1]+"']").css("display",""))):yt++,k=k==0?1:k,n(f).attr("tag")!=r&&(parseInt(n(f).attr("tag")-1)==0?n(f).removeAttr("tag"):n(f).attr("tag",parseInt(n(f).attr("tag"))-1)),f=ni;if(n(u).attr("tag").split(":")[1]=="true")for(v=n(i).find("th[p='"+parseInt(n(o).attr("p").split(",")[0])+","+(parseInt(n(o).attr("p").split(",")[1])-parseInt(n(u).attr("tag").split(":")[0]))+"']"),ii=n(v).nextAll().length,b=0;b<=ii;b++)n(v).attr("hc")==r||parseInt(n(v).attr("hc"))<=1?(n(v).removeAttr("hc"),n(v).attr("ch")==r&&n(v).css("display","")):n(v).attr("hc",parseInt(n(v).attr("hc"))-1),v=n(v).next();for(c=n(n(u).closest("tr")[0]).prevAll().find("th:has(span):not(.summary)"),p=n(u).attr("subTag")!=r&&tt?n(u).attr("subTag").split(":")[1]=="true"?parseInt(n(u).attr("subTag").split(":")[0])-1:parseInt(n(u).attr("subTag").split(":")[0]):(n(u).attr("tag").split(":")[1]=="true"?parseInt(n(u).attr("tag").split(":")[0])-1:parseInt(n(u).attr("tag").split(":")[0]))-yt,tt&&(p=n(u).attr("subTag")!=r?parseInt(n(u).attr("subTag").split(":")[0])==-1?p:p-1:p-1),s=0;s<c.length;s++)parseInt(n(c[s]).attr("p").split(",")[0])<parseInt(y.split(",")[0])&&parseInt(n(c[s]).attr("p").split(",")[1])+c[s].rowSpan+(n(c[s]).find("span").attr("tag")!=r?parseInt(n(c[s]).find("span").attr("tag")):0)>=parseInt(y.split(",")[1])&&(tt&&(tt=!1,p=n(n(c[s]).find("span")[0]).attr("subTag")!=r?parseInt(n(n(c[s]).find("span")[0]).attr("subTag").split(":")[0])<=p?p:p+1:p,n(u).attr("isChildSubNode")=="true"&&(p=p-yt,n(u).removeAttr("isChildSubNode"))),c[s].rowSpan+=p,n(c[s]).find("span").attr("tag")!=r&&n(c[s]).find("span").attr("tag",parseInt(n(c[s]).find("span").attr("tag"))-p),parseInt(n(c[s]).find("span").attr("tag"))==0&&n(c[s]).find("span").removeAttr("tag"),n(c[s]).find("span").attr("subTag")!=r&&n(c[s]).find("span").attr("subTag",parseInt(n(c[s]).find("span").attr("subTag"))-p),parseInt(n(c[s]).find("span").attr("subTag"))==0&&n(c[s]).find("span").removeAttr("subTag"));n(o).find(".cellValue").text(n.trim(n(o).find(".cellValue").text())+" Total");n(o).find(".expand").remove();n(o).prepend("<span style='margin-left:10px'><\/span>")}}if(o.className.indexOf("colheader")>=0||o.className.indexOf("summary")>=0&&n(o).attr("role")=="columnheader")if(w=parseInt(y.split(",")[0]),fi=n(i).find("tr"),n(u).attr("class").indexOf("collapse")>-1){if(ut=o.colSpan,n(o).next().css("display")=="none"){var kt=n(o).next().attr("p"),d=parseInt(kt.split(",")[0]),ei=n(i).find("tr"),g=parseInt(n(o).next().attr("colspan"));if(n(o).next().attr("class").indexOf("stot","cstot")>-1)for(e=0;e<g;e++){for(l=n(f).nextAll().find("th[p^='"+(e+d)+",']"),h=0;h<n(l).length;h++)n(l[h]).css("display","");if(n(l[h]).attr("hc")==r||parseInt(n(l[h]).attr("hc"))<1)for(n(i).find("td[p^='"+(e+d)+",']").css("display",""),st=0;st<n(i).find("td[p^='"+(e+d)+",']").length;st++)(n(n(i).find("td[p^='"+(e+d)+",']")[st]).attr("hc")!=r||n(n(i).find("td[p^='"+(e+d)+",']")[st]).attr("hc")>-1)&&n(n(i).find("td[p^='"+(e+d)+",']")[st]).css("display","none")}n(o).next().css("display","");ut=o.colSpan-g}for(e=0;e<at;e++){for(l=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(f).nextAll().find("td[p^='"+(e+w)+",']"):n(f).nextAll().find("th[p^='"+(e+w)+",']"),h=0;h<n(l).length;h++)n(l[h]).attr("hc",n(l[h]).attr("hc")!=r?parseInt(n(l[h]).attr("hc"))+1:1).css("display","none");(n(l[h]).attr("hc")==r||parseInt(n(l[h]).attr("hc"))<1)&&(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?(this.element.find(".valueCell").find("td[p^='"+(e+w)+",']").css("display","none"),this.element.find(".valueCell").find("td[p^='0,']:not(.summary)").parent().find("td[p^='"+(e+w)+",']").attr("ch",1)):(n(i).find("td[p^='"+(e+w)+",']").css("display","none"),n(i).find("th[p^='0,']:not(.summary)").parent().find("td[p^='"+(e+w)+",']").attr("ch",1)))}for(n(o).attr("hc",1).css("display","none"),n(o).next().text(n(o).next().text().replace(" Total","")),n(o).next().find("span:not(.cellValue)").remove(),n(o).next().prepend('<span class="expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" tag="'+at+'">&nbsp;<\/span>'),a=n(f).prevAll().find("th:has(span):not(.summary)"),e=0;e<a.length;e++)parseInt(n(a[e]).attr("p").split(",")[1])<parseInt(y.split(",")[1])&&parseInt(n(a[e]).attr("p").split(",")[0])<=parseInt(y.split(",")[0])&&parseInt(n(a[e]).attr("p").split(",")[0])+a[e].colSpan+(n(a[e]).find("span").attr("tag")!=r?parseInt(n(a[e]).find("span").attr("tag")):0)>=parseInt(y.split(",")[0])+at&&(a[e].colSpan-=ut,n(a[e]).find("span").attr("tag",n(a[e]).find("span").attr("tag")!=r?parseInt(n(a[e]).find("span").attr("tag"))+ut:ut))}else if(n(u).attr("class").indexOf("expand")>-1){var dt=0,tt=removeCell=this._isSubTotalhidden=!1,k=0,g=parseInt(n(o).attr("colspan"));if(this._hideSubTotal(n(f),k,n(u)),this._isSubTotalHide){removeCell=tt=!0;this._isSubTotalHide=!1;var kt=n(o).attr("p"),d=parseInt(kt.split(",")[0]),ei=n(i).find("tr");if(n(o).attr("class").indexOf("stot","cstot")>-1)for(e=0;e<g;e++){for(nt=n(f).nextAll().find("th[p^='"+(e+d)+",']"),h=0;h<n(nt).length;h++)n(nt[h]).css("display","none");(n(nt[h]).attr("hc")==r||parseInt(n(nt[h]).attr("hc"))<1)&&n(i).find("td[p^='"+(e+d)+",']").css("display","none")}n(o).css("display","none")}for(ut=at-(g-1),e=1;e<ut;e++){for(l=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(f).nextAll().find("td[p^='"+(w-e)+",']"):n(f).nextAll().find("th[p^='"+(w-e)+",']"),h=0;h<n(l).length;h++){for(removeCell=!1,ft=0;ft<n(l[h]).length;ft++)(n(n(l[h])[ft]).hasClass("stot")||n(n(l[h])[ft]).hasClass("cstot"))&&!n(n(l[h])[ft]).hasClass("calc")&&this._hideSubTotal(n(n(l[h])[ft]),k,n(u));if(this._isSubTotalHide){removeCell=!0;this._isSubTotalHide=!1;var kt=n(l[h]).attr("p"),d=parseInt(kt.split(",")[0]),ei=n(i).find("tr"),g=parseInt(n(l[h]).attr("colspan"));if(n(l[h]).attr("class").indexOf("stot","cstot")>-1)for(ct=0;ct<g;ct++){for(nt=n(f).nextAll().find("th[p^='"+(ct+d)+",']"),h=0;h<n(nt).length;h++)n(nt[h]).css("display","none");n(nt[h]).attr("hc")==r||parseInt(n(nt[h]).attr("hc"))<1?n(i).find("td[p^='"+(ct+d)+",']").css("display","none"):dt++}n(l[h]).css("display","none")}else n(l[h]).attr("hc")==r||parseInt(n(l[h]).attr("hc"))==1?(n(l[h]).css("display",""),n(l[h]).removeAttr("hc")):parseInt(n(l[h]).attr("hc"))-1==0?n(l[h]).removeAttr("hc"):n(l[h]).attr("hc",parseInt(n(l[h]).attr("hc"))-1)}if(k=k==0?1:k,!removeCell)if(n(l).last().attr("hc")==r)for(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this.element.find(".valueCell").find("td[p^='"+(w-e)+",']").css("display",""):n(i).find("td[p^='"+(w-e)+",']").css("display",""),lt=n(i).find("th[p^='0,']:not(.summary)").parent().find("td[p^='"+(w-e)+",']"),n(lt).removeAttr("ch"),b=0;b<=n(lt).length;b++)n(lt[b]).attr("hc")!=r&&n(lt[b]).css("display","none");else dt++}n(o).prev().removeAttr("hc").css("display","");var ri=parseInt(n(o).prev().attr("colspan")),rt=parseInt(n(u).attr("tag"))-dt,a=n(f).prevAll().find("th:has(span):not(.summary)");for(tt&&(tt=!1,t.isNullOrUndefined(n(o).prev().find(".collapse").attr("tag"))||(rt=rt==parseInt(n(o).prev().find(".collapse").attr("tag"))?rt:rt-parseInt(n(o).prev().find(".collapse").attr("tag"))),g=ri==g?g:ri-g,rt=rt-g),e=0;e<a.length;e++)parseInt(n(a[e]).attr("p").split(",")[1])<parseInt(y.split(",")[1])&&parseInt(n(a[e]).attr("p").split(",")[0])<parseInt(y.split(",")[0])&&parseInt(n(a[e]).attr("p").split(",")[0])+a[e].colSpan+(n(a[e]).find("span").attr("tag")!=r?parseInt(n(a[e]).find("span").attr("tag")):0)>=parseInt(y.split(",")[0])&&(a[e].colSpan+=rt,n(a[e]).find("span").attr("tag")!=r&&n(a[e]).find("span").attr("tag",parseInt(n(a[e]).find("span").attr("tag"))-rt),parseInt(n(a[e]).find("span").attr("tag"))==0&&n(a[e]).find("span").removeAttr("tag"));n(o).find(".cellValue").text(n.trim(n(o).find(".cellValue").text())+" Total");n(o).find(".expand").remove();n(o).prepend("<span style='margin-left:10px'><\/span>")}},_drillThroughCellClick:function(r){var o,u=n(r.currentTarget.parentElement).attr("p"),h,f,c,e,s,l;if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)this._ogridWaitingPopup.show(),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillThroughHierarchies,JSON.stringify({currentReport:JSON.parse(this.getOlapReport()).Report,layout:this.model.layout,cellPos:u,customObject:JSON.stringify(this.model.customObject)}),this._createDrillThroughDialog);else{for(h=n("#"+this._id).find("tbody").find("tr:first").find("th").length,i=0;i<h;i++)f=this.getJSONRecords()[parseInt(i*this._rowCount+parseInt(u.split(",")[1]))].Info.split("::")[0],f.indexOf("Measures")!=-1&&(o=f),this._rowHeader[i]=f;for(c=n("#"+this._id).find("tbody").find('[p="'+parseInt(u.split(",")[0])+","+parseInt(u.split(",")[1])+'"]').closest("tbody").prev().children("tr").length,i=0;i<c;i++)e=this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+i)].Info.split("::")[0],e.indexOf("Measures")!=-1&&(o=e),this._colHeader[i]=e;for(j=0;j<this._fieldData.measures.length;j++)o==this._fieldData.measures[j].id&&(this.measureGrp=this._fieldData.measures[j].pid);s=this._getConnectionInfo(this.model.dataSource.data);l='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_MEASUREGROUP_DIMENSIONS<\/RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+this.model.dataSource.catalog+"<\/CATALOG_NAME><CUBE_NAME>"+this.model.dataSource.cube+"<\/CUBE_NAME><MEASUREGROUP_NAME>"+this.measureGrp+"<\/MEASUREGROUP_NAME><\/RestrictionList><\/Restrictions><Properties><PropertyList><Catalog>"+this.model.dataSource.catalog+"<\/Catalog> <LocaleIdentifier>"+s.LCID+"<\/LocaleIdentifier><\/PropertyList><\/Properties><\/Discover><\/Body><\/Envelope>";this.doAjaxPost("POST",s.url,{XMLA:l},this._loadDimensionElements,null,{pvtGridObj:this,action:"loadMeasureElements"})}},_generateTreeViewData:function(){var n={catalog:this.model.dataSource.catalog,cube:this.model.dataSource.cube,url:this.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"};this._getTreeData(n,this._loadDimensionElements,{pvtGridObj:this,action:"loadFieldElements"})},_dimensionsDetails:function(t,i){t.pvtGridObj._dimension=n(i).find("row")},_loadDimensionElements:function(t,i){var y,s,h,c,u,f,e;t.pvtGridObj._waitingPopup.show();var o,l={},a={},v=t.pvtGridObj._getConnectionInfo(t.pvtGridObj.model.dataSource.data);for(t.pvtGridObj.schemaTreeView=[],t.pvtGridObj.reportItemNames=[],y='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_DIMENSIONS<\/RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+t.pvtGridObj.model.dataSource.catalog+"<\/CATALOG_NAME><CUBE_NAME>"+t.pvtGridObj.model.dataSource.cube+"<\/CUBE_NAME><\/RestrictionList><\/Restrictions><Properties><PropertyList><Catalog>"+t.pvtGridObj.model.dataSource.catalog+"<\/Catalog> <LocaleIdentifier>"+v.LCID+"<\/LocaleIdentifier><\/PropertyList><\/Properties><\/Discover><\/Body><\/Envelope>",t.pvtGridObj.doAjaxPost("POST",v.url,{XMLA:y},t.pvtGridObj._dimensionsDetails,null,{pvtGridObj:t.pvtGridObj,action:"loadFieldElements"}),s=t.pvtGridObj._dimension,h=0;h<n(i).find("row").length;h++){if(c=n(n(i).find("row")[h]),u=c.find("DIMENSION_UNIQUE_NAME").text(),t.pvtGridObj.model.enableDrillThrough)for(f=0;f<s.length;f++)u==n(s[f]).find("DIMENSION_UNIQUE_NAME").text()&&(o=n(s[f]).find("DIMENSION_CAPTION").text());else o=c.find("DIMENSION_CAPTION").text();u.toLowerCase()=="[measures]"?a={hasChildren:!0,isSelected:!1,id:u,name:o,spriteCssClass:u.toLowerCase()=="[measures]"?"folderCDB e-icon":"dimensionCDB e-icon",tag:u}:!n(n(i).find("row")[0]).find("HIERARCHY_CAPTION").length>0&&(l={hasChildren:!0,isSelected:!1,id:u,name:o,spriteCssClass:"dimensionCDB e-icon",tag:u},t.pvtGridObj.schemaTreeView.push(l))}t.pvtGridObj.schemaTreeView.splice(0,0,a);e={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"};!t.pvtGridObj.model.enableDrillThrough||t.pvtGridObj._schemaData!=r&&t.pvtGridObj._schemaData.model.olap.showNamedSets?(e.request="MDSCHEMA_SETS",t.pvtGridObj._getTreeData(e,t.pvtGridObj._loadNamedSetElements,t)):(e.request="MDSCHEMA_HIERARCHIES",t.pvtGridObj._fieldData.hierarchySuccess==r?t.pvtGridObj._getTreeData(e,t.pvtGridObj._loadHierarchyElements,t):t.pvtGridObj._loadHierarchyElements(t,t.pvtGridObj._fieldData.hierarchySuccess))},_loadNamedSetElements:function(t,i){var f,u;t.pvtGridObj._waitingPopup.show();var s={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},e=t.pvtGridObj.model.dataSource,o=n.map(e.rows,function(n){if(n.fieldName!=r)return n.fieldName});for(n.merge(o,n.map(e.columns,function(n){if(n.fieldName!=r)return n.fieldName})),n.merge(o,n.map(e.filters,function(n){if(n.fieldName!=r)return n.fieldName})),measureGroupItems=[],f=0;f<n(i).find("row").length;f++)u=n(n(i).find("row")[f]),n.inArray(u.find("DIMENSIONS").text().split(".")[0],measureGroupItems)>=0||(treeNodeElement={hasChildren:!0,isSelected:!1,pid:u.find("DIMENSIONS").text().split(".")[0],id:u.find("SET_DISPLAY_FOLDER").text()+"_"+u.find("DIMENSIONS").text().split(".")[0],name:u.find("SET_DISPLAY_FOLDER").text(),spriteCssClass:"folderCDB e-icon namedSets"},t.pvtGridObj.schemaTreeView.push(treeNodeElement),measureGroupItems.push(u.find("DIMENSIONS").text().split(".")[0])),treeNodeElement={hasChildren:!0,isSelected:n.inArray("["+n.trim(u.children("SET_NAME").text())+"]",o)>=0,pid:u.find("SET_DISPLAY_FOLDER").text()+"_"+u.find("DIMENSIONS").text().split(".")[0],id:"["+n.trim(u.children("SET_NAME").text()).replace(/\&/g,"&amp;")+"]",name:u.children("SET_CAPTION").text(),spriteCssClass:"namedSetCDB e-icon",tag:u.find("EXPRESSION").text()},t.pvtGridObj.schemaTreeView.push(treeNodeElement);s.request="MDSCHEMA_HIERARCHIES";t.pvtGridObj._fieldData.hierarchySuccess==r?t.pvtGridObj._getTreeData(s,t.pvtGridObj._loadHierarchyElements,t):t.pvtGridObj._loadHierarchyElements(t,t.pvtGridObj._fieldData.hierarchySuccess)},_loadHierarchyElements:function(t,i){var h,a,f;t.pvtGridObj._waitingPopup.show();var l={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},o=t.pvtGridObj.model.dataSource,s=n.map(o.rows,function(n){if(n.fieldName!=r)return n.fieldName});for(n.merge(s,n.map(o.columns,function(n){if(n.fieldName!=r)return n.fieldName})),n.merge(s,n.map(o.filters,function(n){if(n.fieldName!=r)return n.fieldName})),h={},a="",f=0;f<n(i).find("row").length;f++){var u=n(n(i).find("row")[f]),c=u.find("DIMENSION_UNIQUE_NAME").text(),e=u.find("HIERARCHY_UNIQUE_NAME").text(),v=n(t.pvtGridObj.schemaTreeView).filter(function(n,t){return t.tag==c}).map(function(n,t){return t});v.length>0&&c!=e&&(h={hasChildren:!0,isSelected:n.inArray(e,s)>=0,pid:c,id:e,name:u.find("HIERARCHY_CAPTION").text(),spriteCssClass:u.find("HIERARCHY_ORIGIN").text()!="2"&&u.find("HIERARCHY_ORIGIN").text()!="6"?"hierarchyCDB e-icon":"attributeCDB e-icon",tag:e},t.pvtGridObj.schemaTreeView.push(h))}l.request="MDSCHEMA_LEVELS";t.pvtGridObj._getTreeData(l,t.pvtGridObj._loadLevelElements,t)},_loadLevelElements:function(t,i){var r,i;t.pvtGridObj._waitingPopup.show();r=n.map(n(i).find("row"),function(t){if(parseInt(n(t).children("LEVEL_TYPE").text())!="1"&&n(t).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase()!="[measures]")return treeNodeElement={hasChildren:!1,isChecked:!1,id:n(t).find("LEVEL_UNIQUE_NAME").text(),pid:n(t).find("HIERARCHY_UNIQUE_NAME").text(),name:n(t).find("LEVEL_CAPTION").text(),spriteCssClass:"level"+parseInt(n(t).children("LEVEL_NUMBER").text())+" e-icon",tag:n(t).find("LEVEL_UNIQUE_NAME").text()}});n.merge(t.pvtGridObj.schemaTreeView,r);!t.pvtGridObj.model.enableDrillThrough||t.pvtGridObj._fieldData.measureSuccess?t.pvtGridObj._fieldData.measureSuccess?t.pvtGridObj._loadMeasureElements(t,t.pvtGridObj._fieldData.measureSuccess):(i={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_MEASURES"},t.pvtGridObj._getTreeData(i,t.pvtGridObj._loadMeasureElements,t)):t.pvtGridObj._createDrillThroughDialog(t.pvtGridObj,t.pvtGridObj.schemaTreeView)},_loadMeasureGroups:function(t,i){t.pvtGridObj._fieldData.measuresGroups=n(i).find("row")},_loadMeasureElements:function(t,i){var e={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},a=t.pvtGridObj.model.dataSource,v=n.map(a.values,function(n){if(n.measures!=r)return n.measures}),s,y,h,o,l;for(this.reportItemNames=n.map(v,function(n){if(n.fieldName!=r)return n.fieldName}),s=[],y="",t.pvtGridObj.model.locale!="en-US"&&(e={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_MEASUREGROUPS"},t.pvtGridObj._getTreeData(e,this._loadMeasureGroups,{pvtGridObj:this,action:"loadFieldElements"})),o=0;o<n(i).find("row").length;o++){var c=n(n(i).find("row")[o]),u=c.children("MEASUREGROUP_NAME").text(),f=c.find("MEASURE_UNIQUE_NAME").text();n.inArray(u,s)>=0||(t.pvtGridObj.model.locale!="en-US"?(l=n.map(t.pvtGridObj._fieldData.measuresGroups,function(t){if(n(t).children("MEASUREGROUP_NAME").text()==u)return n(t).children("MEASUREGROUP_CAPTION").text()}),h=l.length>0?l[0]:u):h=u,treeNodeElement={hasChildren:!0,isChecked:!1,pid:"[Measures]",id:u,name:h,spriteCssClass:"measureGroupCDB e-icon",tag:u},t.pvtGridObj.schemaTreeView.push(treeNodeElement),s.push(u));treeNodeElement={hasChildren:!0,isSelected:n.inArray(f,this.reportItemNames)>=0,id:f,pid:u,name:c.children("MEASURE_CAPTION").text(),spriteCssClass:"measure",tag:f};t.pvtGridObj.schemaTreeView.push(treeNodeElement);n.inArray(f,t.pvtGridObj.reportItemNames)>=0&&t.pvtGridObj.reportItemNames.splice(t.pvtGridObj.reportItemNames.indexOf(f),1)}t.pvtGridObj._schemaData.model.olap.showKpi?(treeNodeElement={hasChildren:!0,isChecked:!1,id:"folderStruct",name:"KPI",spriteCssClass:"KPICDB folderCDB e-icon",tag:""},t.pvtGridObj.schemaTreeView.splice(1,0,treeNodeElement),e.request="MDSCHEMA_KPIS",t.pvtGridObj._getTreeData(e,t.pvtGridObj._loadKPIElements,t)):t.pvtGridObj._schemaData._createTreeView(this,t.pvtGridObj.schemaTreeView)},_loadKPIElements:function(t,i){for(var a=t.pvtGridObj.model.dataSource,f=this.reportItemNames,l=[],e=0;e<n(i).find("row").length;e++){var u=n(n(i).find("row")[e]),r=u.children("KPI_CAPTION").text(),o=u.children("KPI_goal").text(),s=u.children("KPI_STATUS").text(),h=u.children("KPI_TREND").text(),c=u.find("KPI_VALUE").text();n.inArray(u.children("KPI_NAME").text(),l)>=0||(treeNodeElement={hasChildren:!0,isChecked:!1,pid:"folderStruct",id:r,name:r,spriteCssClass:"measureGroupCDB e-icon",tag:r},t.pvtGridObj.schemaTreeView.push(treeNodeElement),l.push(r));treeNodeElement={hasChildren:!0,isSelected:n.inArray(o,f)>=0,id:o,pid:r,name:t.pvtGridObj._getLocalizedLabels("Goal"),spriteCssClass:"kpiGoal e-icon",tag:o};t.pvtGridObj.schemaTreeView.push(treeNodeElement);treeNodeElement={hasChildren:!0,isSelected:n.inArray(s,f)>=0,id:s,pid:r,name:t.pvtGridObj._getLocalizedLabels("Status"),spriteCssClass:"kpiStatus e-icon",tag:s};t.pvtGridObj.schemaTreeView.push(treeNodeElement);treeNodeElement={hasChildren:!0,isSelected:n.inArray(h,f)>=0,id:h,pid:r,name:t.pvtGridObj._getLocalizedLabels("Trend"),spriteCssClass:"kpiTrend e-icon",tag:h};t.pvtGridObj.schemaTreeView.push(treeNodeElement);treeNodeElement={hasChildren:!0,isSelected:n.inArray(c,f)>=0,id:c,pid:r,name:t.pvtGridObj._getLocalizedLabels("Value"),spriteCssClass:"kpiValue e-icon",tag:c};t.pvtGridObj.schemaTreeView.push(treeNodeElement)}t.pvtGridObj._schemaData._createTreeView(this,t.pvtGridObj.schemaTreeView);delete t.pvtGridObj.reportItemNames;delete t.pvtGridObj.schemaTreeView},_createDrillThroughDialog:function(i,r){var e,u,o,f;this.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&r.shift();this.element.find(".e-dialog, .clientDialog").remove();var s=t.buildTag("label#",this._getLocalizedLabels("SelectHierarchy"))[0].outerHTML,h="<div class=cubeTable style='width:250px; overflow:auto'><div valign=\"bottom\">"+this._createHierarchyBrowser()+"<\/div><\/div>",c=t.buildTag("div#dropDlg.dropDlg",'<table class="outerTable"><tr><td>'+h+"<\/td><td>"+s+"<br><textarea id='hrSel' style='width:300px; height:300px; resize:none; margin:0px 5px 0 5px'><\/textarea><\/br><br><\/td><\/tr><\/table>")[0].outerHTML+"<\/br>",l=t.buildTag("div",t.buildTag("button#btnOK.dialogBtnOK",this._getLocalizedLabels("OK"))[0].outerHTML+t.buildTag("button#btnCancel.dialogBtnCancel",this._getLocalizedLabels("Cancel"))[0].outerHTML,{float:"right",margin:"-5px 0 6px"})[0].outerHTML,a=t.buildTag("div#clientDialog.clientDialog",c+l,{opacity:"1"}).attr("title","Hierarchy Selector")[0].outerHTML;for(n(a).appendTo("#"+this._id),n("#"+this._id+"_btnOK,#"+this._id+"_btnCancel").ejButton(),n("#"+this._id+"_btnOK,#"+this._id+"_btnCancel").css({margin:"0 0 0 10px",width:"30px"}),this.element.find(".clientDialog").ejDialog({width:600,target:"#"+this._id,enableResize:!1,enableRTL:this.model.enableRTL,close:this._preventPanelClose}),this.element.find(".cubeTreeViewHierarchy").ejTreeView({showCheckbox:!0,fields:{id:"id",parentId:"pid",text:"name",isChecked:"isSelected",spriteCssClass:"spriteCssClass",dataSource:this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.parseJSON(i.d):r},allowDragAndDrop:!0,allowDropChild:!1,allowDropSibling:!1,enableRTL:this.model.enableRTL?!0:!1,beforeDelete:function(){return!1},dragAndDropAcrossControl:!0,nodeDropped:t.proxy(this._hierarchyNodeDropped,this)}),this._tableTreeObj=this.element.find(".cubeTreeViewHierarchy").data("ejTreeView"),this._tableTreeObj.element.find(".e-ul").css({width:"100%",height:"100%"}),this._tableTreeObj.element.find(".e-chkbox-wrap").remove(),e=this._tableTreeObj.element.find("li"),u=0;u<e.length;u++)o=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.parseJSON(i.d)[u].tag:r[u].tag,e[u].setAttribute("tag",o);this._tableTreeObj&&this._tableTreeObj.element.find("li").mouseover(t.proxy(function(t){n(t.target).parent().find(".measureGroupCDB, .dimensionCDB, .folderCDB").length>0&&n(t.target).css("cursor","default")},this));f=this;n("#btnOK").click(function(){var t=n("#hrSel").val();n(".e-dialog, .clientDialog, .drilltableDialog").remove();f._waitingPopup.show();f._createDrillThroughQuery(t);f._waitingPopup.hide()});n("#btnCancel").click(function(){n(".e-dialog, .clientDialog").remove();f._waitingPopup.hide()});this.model.enableRTL&&(n(".e-dialog").addClass("e-rtl"),n(".dialogBtnCancel").css("margin","0 -70px 0 0"))},_createHierarchyBrowser:function(){return t.buildTag("div.cdbHrHeader",t.buildTag("span",this._getLocalizedLabels("CubeDimensionBrowser"),{"padding-left":"5px","font-weight":"700"})[0].outerHTML,{width:"200px",height:"30px"})[0].outerHTML+t.buildTag("div.cubeBrowserHierarchy",t.buildTag("div.cubeTreeViewHierarchy")[0].outerHTML,{width:"200px",height:"300px",overflow:"auto"})[0].outerHTML},_hierarchyNodeDropped:function(t){var i,u,r;if(t.dropTarget[0].id=="hrSel"){for(i=t.droppedElementData.id,i=i.replace("[","[$"),u=0;u<n("#hrSel").val().split(",").length;u++)if(i==n("#hrSel").val().split(",")[u])return!1;r=this.element.find("#hrSel").val();r.length!=0?(r=r+","+i,this.element.find("#hrSel").val(r)):this.element.find("#hrSel").val(i)}},_generateDrillData:function(t,i){for(var e=n(i).find("row").children(),r=n.map(e,function(n){var t=parseFloat(n.textContent),i=n.tagName.replace(/_x005B_/g,"[").replace(/_x0020_/g," ").replace(/_x005D_/g,"]").replace(/_x0024_/g,"$").replace("].[","]-[");return'"'+i+'":'+t}),o=r[0],f="",u=0;u<r.length;u++){if(r[u]==o){f+=f==""?"[{"+r[u]:"}, {"+r[u];continue}f+=","+r[u]}f+="}]";t.pvtGridObj._trigger("drillThrough",{element:t.pvtGridObj.element,data:f})},_getTreeData:function(n,i,r){var u=t.olap.base._getConnectionInfo(n.url),f='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+n.request+"<\/RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+n.catalog+"<\/CATALOG_NAME><CUBE_NAME>"+n.cube+"<\/CUBE_NAME><\/RestrictionList><\/Restrictions><Properties><PropertyList><Catalog>"+n.catalog+"<\/Catalog><LocaleIdentifier>"+u.LCID+"<\/LocaleIdentifier> <\/PropertyList><\/Properties><\/Discover><\/Body><\/Envelope>";this.doAjaxPost("POST",u.url,{XMLA:f},i,null,r)},_addHyperlink:function(i){if(n(".hyperlinkValueCell")[0]&&n(n(".hyperlinkValueCell")[0]).removeClass("hyperlinkValueCell"),n(".hyperlinkHeaderCell")[0]&&n(n(".hyperlinkHeaderCell")[0]).removeClass("hyperlinkHeaderCell"),n(i.target).text()==""||n(i.target).text()==null)return!1;i.target.parentElement.className.replace(/^\s+/,"").split(" ")[0]=="value"&&(this.enableValueCellHyperlink()||this.model.enableDrillThrough)?n(i.target).addClass("hyperlinkValueCell"):n(i.target.parentElement).hasClass("summary value")&&this.enableSummaryCellHyperlink()?n(i.target).addClass("hyperlinkValueCell"):i.target.parentElement.className.split(" ")[0]=="rowheader"||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&n(i.target.parentElement).attr("role")=="rowheader"?this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enableDeferUpdate||n(this.element).parents(".e-pivotclient").length!=0?this.enableRowHeaderHyperlink()&&n(i.target).addClass("hyperlinkHeaderCell"):(fieldIndex=n(i.target.parentElement).attr("p").split(",")[0],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&JSON.parse(this.getOlapReport()).PivotRows[fieldIndex].EnableHyperlink?n(i.target).addClass("hyperlinkHeaderCell"):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.dataSource.rows.length>0&&!t.isNullOrUndefined(this.model.dataSource.rows[fieldIndex].enableHyperlink)&&this.model.dataSource.rows[fieldIndex].enableHyperlink?n(i.target).addClass("hyperlinkHeaderCell"):this.enableRowHeaderHyperlink()&&n(i.target).addClass("hyperlinkHeaderCell")):(i.target.parentElement.className.split(" ")[0]=="colheader"||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&n(i.target.parentElement).attr("role")=="columnheader")&&(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enableDeferUpdate||n(this.element).parents(".e-pivotclient").length!=0?this.enableColumnHeaderHyperlink()&&n(i.target).addClass("hyperlinkHeaderCell"):n(i.target.parentElement).hasClass("calc")||n(i.target.parentElement).hasClass("cgtot")||n(i.target.parentElement).hasClass("gtot")||(fieldIndex=n(i.target.parentElement).attr("p").split(",")[1],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&JSON.parse(this.getOlapReport()).PivotColumns[fieldIndex].EnableHyperlink?n(i.target).addClass("hyperlinkHeaderCell"):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&!t.isNullOrUndefined(this.model.dataSource.columns[fieldIndex].enableHyperlink)&&this.model.dataSource.columns[fieldIndex].enableHyperlink?n(i.target).addClass("hyperlinkHeaderCell"):this.enableColumnHeaderHyperlink()&&n(i.target).addClass("hyperlinkHeaderCell")))},_removeHyperlink:function(t){n(t.target).removeClass("hyperlinkValueCell").removeClass("hyperlinkHeaderCell")},_cellContext:function(i){var r=n(i.target).parents(".e-pivotgrid").data("ejPivotGrid"),u=(n(i.target).hasClass("cellValue")?n(i.target).parent()[0]:i.target)||(n(i.srcElement).hasClass("cellValue")?n(i.srcElement).parent()[0]:i.srcElement),f;if(r.enableCellContext()==!0&&n(u).parents("#"+r._id)[0]&&(f=n(u).attr("p"),f)){var f=r._excelLikeJSONRecords!=null&&r.model.layout.toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?n(u).attr("i"):n(u).attr("p"),e=r._excelLikeJSONRecords!=null&&r.model.layout.toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?r._excelLikeJSONRecords[parseInt(parseInt(f.split(",")[0])*r._excelRowCount+parseInt(f.split(",")[1]))].Info:r.getJSONRecords()[parseInt(parseInt(f.split(",")[0])*r._rowCount+parseInt(f.split(",")[1]))].Info,o={cellValue:u.innerHTML,cellPosition:f,cellType:u.className.split(" ")[0]!=""?u.className.split(" ")[0]:u.className.split(" ")[1],role:n(u).attr("role"),uniqueName:e.split("::")[0],args:i,rawdata:e};o.cellType!=""&&r._trigger("cellContext",{args:o});i.target?i.preventDefault():window.event.returnValue=!1}},_initCellSelection:function(i){var r,u;n("#"+this._id+" td,th").removeClass("highlighted");this._on(this.element,"mouseup touchend",".value",this._completeCellSelection);_oriX=i.pageX;_oriY=i.pageY;r=i.target||window.event.srcElement;n(r).hasClass("cellValue")&&(r=r.parentElement);n(".value").addClass("selection");n("#"+this._id).append(t.buildTag("div.cellSelection#"+this._id+"_cellSelection","",{}));_startPosCell=n(r)[0].attributes.getNamedItem("p").value;this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(u=this._excelLikeJSONRecords[0*this._rowCount+parseInt(n(r)[0].attributes.getNamedItem("i").value.split(",")[1])].Index,_startPosCell=this.getJSONRecords()[parseInt(n(r)[0].attributes.getNamedItem("p").value.split(",")[0])*this._rowCount+parseInt(u.split(",")[1])].Index);this._on(this.element,"mousemove touchmove",".value, .cellSelection",this._cellSelection)},_headerClickCellSelection:function(i){var r=n(i.target).attr("class").indexOf("colheader")&&n(i.target).attr("class").indexOf("rowheader")==-1?n(i.target).attr("class").indexOf("cellValue")!=-1?n(i.target).parent():null:n(i.target),s,o,h;if(r!=null){n("#"+this._id+" td,th").removeClass("highlighted");var f,e,u;for(f=r.attr("role"),u=f=="columnheader"?r.attr("p").split(",")[0]:r.attr("p").split(",")[1],e=f=="columnheader"?r.attr("colspan"):r.attr("rowspan"),this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(s=parseInt(r.attr("p").split(",")[0])*this._rowCount+parseInt(r.attr("p").split(",")[1]),e=f=="columnheader"?this._excelLikeJSONRecords[parseInt(r.attr("i").split(",")[0])*this._rowCount+parseInt(r.attr("i").split(",")[1])].ColSpan:this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.getJSONRecords()[s+this._rowCount]!=null&&this.getJSONRecords()[s+this._rowCount].CSS.indexOf("value")==-1?this.getJSONRecords()[s].RowSpan+1:this.getJSONRecords()[s].RowSpan),o=0;o<e;o++)f=="columnheader"?(n("#"+this._id+" [p^='"+(parseInt(o)+parseInt(u))+",']").addClass("highlighted"),n("#"+this._id+" [p^='"+(parseInt(o)+parseInt(u))+",'][role='columnheader']").each(function(t,i){(parseInt(i.attributes.p.value.split(",")[1])<=parseInt(r.attr("p").split(",")[1])||parseInt(i.attributes.colspan.value)>parseInt(r.attr("colspan")))&&n(i).removeClass("highlighted")})):(n("#"+this._id+" [p$=',"+(parseInt(o)+parseInt(u))+"']").addClass("highlighted"),n("#"+this._id+" [p$=',"+(parseInt(o)+parseInt(u))+"'][role='rowheader']").each(function(t,i){(parseInt(i.attributes.p.value.split(",")[0])<=parseInt(r.attr("p").split(",")[0])||parseInt(i.attributes.rowspan.value)>parseInt(r.attr("rowspan")))&&n(i).removeClass("highlighted")}));_startPosCell=f=="columnheader"?n("#"+this._id+" [p^='"+(0+parseInt(u))+",'].value").eq(0).attr("p"):n("#"+this._id+" [p$=',"+(0+parseInt(u))+"'].value").eq(0).attr("p");this._excelLikeJSONRecords==null||this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout||this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||(_startPosCell=f=="columnheader"?n("#"+this._id+" [p^='"+(0+parseInt(u))+",'].value:not(.summary)").eq(0).attr("p"):n("#"+this._id+" [p$=',"+(0+parseInt(u))+"'].value:not(.summary)").eq(0).attr("p"));h=f=="columnheader"?n("#"+this._id+" [p^='"+(parseInt(e)-1+parseInt(u))+",']").eq(n("#"+this._id+" [p^='"+(parseInt(e)-1+parseInt(u))+",']").length-1):n("#"+this._id+" [p$=',"+(parseInt(e)-1+parseInt(u))+"']").eq(n("#"+this._id+" [p$=',"+(parseInt(e)-1+parseInt(u))+"']").length-1);this._completeCellSelection(h)}},_cellSelection:function(i){n("#"+this._id+"_gridTooltip").hide();i.pageX<_oriX?n("#"+this._id+"_cellSelection").css({left:i.pageX+2,width:_oriX-i.pageX}):n("#"+this._id+"_cellSelection").css({left:_oriX-6,width:i.pageX-_oriX});i.pageY<_oriY?n("#"+this._id+"_cellSelection").css({top:i.pageY,height:_oriY-i.pageY-7}):n("#"+this._id+"_cellSelection").css({top:_oriY+7,height:i.pageY-_oriY-11});n(".pivotGridTable").mouseleave(function(i){var r=n(i.target).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(i.toElement)||t.isNullOrUndefined(i.toElement.classList)||i.toElement.classList[0]!="e-pivotgrid"||(n("#"+r._id+"_cellSelection").remove(),n(".value").removeClass("selection"),r._off(r.element,"mouseup mouseend",".value"))})},_completeCellSelection:function(i){var h,e,k=[],tt=[],u,it=[],c,ot,v,o,l,y,a,ut,p,s,b,g,ft,nt,et;for(this._off(this.element,"mousemove touchmove",".value"),n(".value").removeClass("selection"),h=n(i).hasClass("value")?i:i.target||window.event.srcElement,n(h).hasClass("cellValue")&&(h=h.parentElement),e=n(h)[0].attributes.getNamedItem("p").value,this._excelLikeJSONRecords==null||this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout||n(i).hasClass("value")||(ot=this._excelLikeJSONRecords[0*this._rowCount+parseInt(n(h)[0].attributes.getNamedItem("i").value.split(",")[1])].Index,e=this.getJSONRecords()[parseInt(n(h)[0].attributes.getNamedItem("p").value.split(",")[0])*this._rowCount+parseInt(ot.split(",")[1])].Index),v=0,o=parseInt(_startPosCell.split(",")[1])<parseInt(e.split(",")[1])?parseInt(_startPosCell.split(",")[1]):parseInt(e.split(",")[1]);o<=(parseInt(_startPosCell.split(",")[1])>parseInt(e.split(",")[1])?parseInt(_startPosCell.split(",")[1]):parseInt(e.split(",")[1]));o++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||n("#"+this._id).find("td[p*=',"+o+"']").parent().is(":visible"))for(l=parseInt(_startPosCell.split(",")[0])<parseInt(e.split(",")[0])?parseInt(_startPosCell.split(",")[0]):parseInt(e.split(",")[0]);l<=(parseInt(_startPosCell.split(",")[0])>parseInt(e.split(",")[0])?parseInt(_startPosCell.split(",")[0]):parseInt(e.split(",")[0]));l++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||n("#"+this._id).find("[p*='"+l+",']").last("th").is(":Visible")){k[v]=this.getJSONRecords()[l*this._rowCount+o];var f,w="",rt,st,d=0,ht=0;if(u=this.element.find(".summary[role!='gridcell'][p$=',"+o+"'] , .rowheader[role!='gridcell'][p$=',"+o+"']").last().attr("p"),u==r&&(u=n("#"+this._id).find("tbody").find('[p="'+l+","+o+'"]').parent("tr").find(".summary").first().attr("p")),rt=u,u!=null){while(u[0]>=0)u==this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Index&&(f=this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Value,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(f=n("#"+this._id).find("td[p*='"+l+","+o+"']").prevAll("th").children(".expand").length>0?f.replace("Total",""):f),u=parseInt(u.split(",")[0])-1+","+parseInt(u.split(",")[1])),w&&f!=""?w=f+"##"+w:f!=""&&(w=f);tt[v]=w}for(y="",ut=this.element.find('tr:has(".colheader")').length-1,st=ut,c=k[v].Index,c!=r&&c==this.getJSONRecords()[parseInt(parseInt(c.split(",")[0])*this._rowCount+parseInt(c.split(",")[1]))].Index&&(p=parseInt(c.split(",")[0])),s=0;s<=ut;s++){if(p!=null&&p+","+s==this.getJSONRecords()[parseInt(parseInt(p)*this._rowCount+s)].Index){if(a=this.getJSONRecords()[parseInt(parseInt(p)*this._rowCount+s)].Value,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(b=p;b>=0;b--)if(n("#"+this._id).find("th[p*='"+b+","+s+"']").length>0){a=n("#"+this._id).find("th[p*='"+b+","+s+"']").find(".expand").length>0?a.replace("Total",""):a;break}y==""?y=a:a!=""&&(y=y+"##"+a)}it[v]=y}v++}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap){for(g=this.getJSONRecords()[parseInt(parseInt(rt.split(",")[0])*this._rowCount+parseInt(rt.split(",")[1]))].Info;g[0]>=0;)f=this.getJSONRecords()[parseInt(parseInt(g.split(",")[0])*this._rowCount+parseInt(g.split(",")[1]))].Info,(f.split("::")[0].indexOf("Measures")>0||f.split("::")[0].indexOf("MEASURES")>0)&&d++,u=parseInt(u.split(",")[0])-1+","+parseInt(u.split(",")[1]);if(ft=parseInt(c.split(",")[0]),d==0)for(nt=0;nt<=st;nt++)ft!=null&&(et=this.getJSONRecords()[parseInt(parseInt(ft)*this._rowCount+nt)].Info),(et.split("::")[0].indexOf("Measures")>0||et.split("::")[0].indexOf("MEASURES")>0)&&ht++}else measureCount=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotCalculations.length:this.model.dataSource.values.length;args={JSONRecords:k,rowHeader:tt,columnHeader:it,measureCount:d>0?"Row:"+d:"Column:"+ht};this._trigger("cellSelection",args);k=tt=it=[];n("#"+this._id+"_cellSelection").remove();this.model.enableToolTip&&this._on(this.element,"mousemove touchmove",".value",this._applyToolTip);this._off(this.element,"mouseup touchend",".value")},exportPivotGrid:function(i,u){var s={url:"",fileName:"PivotGrid"},h,c,o,e,f;if(this._trigger("beforeExport",s),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode||this._excelLikeJSONRecords!=null||n.trim(s.url)=="")f={args:JSON.stringify({pGridData:this.exportRecords!=null&&this.exportRecords!=""?this.exportRecords:null,rowCount:this._excelLikeJSONRecords!=null?this._excelRowCount:this._rowCount,columnCount:this._excelLikeJSONRecords!=null?Math.floor(this._excelLikeJSONRecords.length/this._excelRowCount):this.getJSONRecords()!=null?Math.floor(this.getJSONRecords().length/this._rowCount):0,fileName:t.isNullOrUndefined(u)?"":u,Formatting:this._cFormat,customObject:JSON.stringify(this.model.customObject)})},t.raiseWebFormsServerEvents&&i.indexOf("api")==-1?(h={model:this.model,originalEventType:i},c=f,t.raiseWebFormsServerEvents(i,h,c),setTimeout(function(){t.isOnWebForms=!0},1e3)):this.doPostBack(i,f);else{try{o=JSON.parse(this.getOlapReport()).Report}catch(l){o=this.getOlapReport()}this.element.find(".summary").length>0?e={valueCellColor:this.element.find(".value").css("color")==null?"rgb(51, 51, 51)":this.element.find(".value").css("color"),valueCellBGColor:this.element.find(".value").css("background-color")==null?"rgb(255, 255, 255)":this.element.find(".value").css("background-color"),summaryCellColor:this.element.find(".summary").css("color"),summaryCellBGColor:this.element.find(".summary").css("background-color")}:this.element.find(".value").length>0&&(e={valueCellColor:this.element.find(".value").css("color")==null?"rgb(51, 51, 51)":this.element.find(".value").css("color"),valueCellBGColor:this.element.find(".value").css("background-color")==null?"rgb(255, 255, 255)":this.element.find(".value").css("background-color")});f={args:JSON.stringify({exportOption:i,currentReport:o,layout:this.layout(),colorSettings:e!=r?JSON.stringify(e):"",customObject:JSON.stringify(this.model.customObject)})};this.doPostBack(this.model.url+"/"+this.model.serviceMethodSettings.exportPivotGrid,f)}},_createCalculatedField:function(){var i,r;this.element.find(".calculatedFieldPopup",".clientDialog",".e-dialog").remove();dialogTitle=this._getLocalizedLabels("CalculatedField");var u=t.buildTag("label#"+this._id+"_lblCalFieldName",this._getLocalizedLabels("Name"))[0].outerHTML,f=t.buildTag("span.fieldDropDown",t.buildTag("input#"+this._id+"_calculateFieldList","",{},{type:"text"})[0].outerHTML+t.buildTag("input#"+this._id+"_calculateFieldName.calculateFieldName","",{"margin-left":this.model.enableRTL?"56px":"2px",outline:"none"},{type:"text"})[0].outerHTML,{})[0].outerHTML,e=t.buildTag("button#"+this._id+"_btnAdd",this._getLocalizedLabels("Add"),{"margin-top":"-5px"},{name:this._getLocalizedLabels("Add")})[0].outerHTML,o=t.buildTag("label#"+this._id+"_lblCalFieldFormula",this._getLocalizedLabels("Formula"))[0].outerHTML,s=t.buildTag("input.calculatedFieldFormula#"+this._id+"_calculatedFieldFormula","",{width:"192px",height:"27px"},{type:"text",disabled:"disabled"})[0].outerHTML,h=t.buildTag("button#"+this._id+"_btnDelete",this._getLocalizedLabels("Delete"),{"margin-top":"-24px"},{name:this._getLocalizedLabels("Delete")})[0].outerHTML,c=t.buildTag("label#"+this._id+"_pivotGridValueFields",this._getLocalizedLabels("Fields"))[0].outerHTML,l=t.buildTag("ul#"+this._id+"_fieldCollection","")[0].outerHTML,a=t.buildTag("button.calculatorFields","",{"margin-left":this.model.enableRTL?"0px":"10px","margin-right":this.model.enableRTL?"10px":"0px"})[0].outerHTML,v=t.buildTag("span.editFormula e-icon e-cancel","",{padding:"3px","margin-left":"-54px","margin-right":this.model.enableRTL?"-54px":"0px",position:"relative"}).attr("aria-label","cancel")[0].outerHTML,y=t.buildTag("span",t.buildTag("button#"+this._id+"_btnInsert",this._getLocalizedLabels("InsertField"),{},{name:this._getLocalizedLabels("InsertField")})[0].outerHTML,{"margin-right":"150px","margin-left":"150px"})[0].outerHTML,p=t.buildTag("button#"+this._id+"_btnOk",this._getLocalizedLabels("OK"),{"margin-left":"10px"},{name:this._getLocalizedLabels("OK")})[0].outerHTML,w=t.buildTag("button#"+this._id+"_btnCancel",this._getLocalizedLabels("Cancel"),{"margin-left":this.model.enableRTL?"0px":"10px"},{name:this._getLocalizedLabels("Cancel")})[0].outerHTML;dialogFooter=t.buildTag("div",p+w,{float:this.model.enableRTL?"left":"right","margin-bottom":"15px","margin-top":"4px"})[0].outerHTML;var b=t.buildTag("div.calcFormulaDiv",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td","+")[0].outerHTML+t.buildTag("td","-")[0].outerHTML+t.buildTag("td","*")[0].outerHTML+t.buildTag("td","/")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","7")[0].outerHTML+t.buildTag("td","8")[0].outerHTML+t.buildTag("td","9")[0].outerHTML+t.buildTag("td","%")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","4")[0].outerHTML+t.buildTag("td","5")[0].outerHTML+t.buildTag("td","6")[0].outerHTML+t.buildTag("td","^")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","1")[0].outerHTML+t.buildTag("td","2")[0].outerHTML+t.buildTag("td","3")[0].outerHTML+t.buildTag("td","(")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",".")[0].outerHTML+t.buildTag("td","0")[0].outerHTML+t.buildTag("td","C")[0].outerHTML+t.buildTag("td",")")[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,{display:"none"})[0].outerHTML,k=t.buildTag("div#calculatedField.dlgCalculatedField",'<table class="outerTable"><tr><td>'+u+"<\/td><td>"+f+"<\/td><td>"+e+"<\/td><\/tr><tr><td>"+o+"<\/td><td>"+s+a+v+"<\/td><td>"+h+'<\/td><\/tr><\/table><p class="borderLine"><\/p><table class="fieldTable"><tr><td>'+c+"<\/td><\/tr><tr><td>"+l+"<\/td><\/tr><tr><td>"+y+"<\/td><\/tr><\/table>")[0].outerHTML,d=t.buildTag("div#clientDialog.clientDialog",k+dialogFooter+b,{opacity:"1"}).attr("title",dialogTitle)[0].outerHTML;n(d).appendTo("#"+this._id);this.element.find(".clientDialog").ejDialog({width:"auto",target:"#"+this._id,enableRTL:this.model.enableRTL,enableResize:!1,close:this._preventPanelClose});n("#"+this._id+"_btnAdd,#"+this._id+"_btnDelete,#"+this._id+"_btnOk,#"+this._id+"_btnCancel").ejButton({type:t.ButtonType.Button,width:"80",enableRTL:this.model.enableRTL});n("#"+this._id+"_btnInsert").ejButton({type:t.ButtonType.Button,enabled:!1,width:"100",enableRTL:this.model.enableRTL});n(".calculatorFields").ejButton({type:t.ButtonType.Button,contentType:"imageonly",prefixIcon:"e-icon e-sigma",htmlAttributes:{title:"Click Me"},enableRTL:this.model.enableRTL});n("#"+this._id+"_calculateFieldList").ejDropDownList({width:"230px",enableRTL:this.model.enableRTL,dataSource:this._calculatedField,fields:{text:"name",value:"name"},select:t.proxy(this._calculatedFieldListChange,this)});i=[];this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n(JSON.parse(this.getOlapReport()).PivotCalculations).each(function(){this.CalculationType!=8&&this.CalculationType!="Formula"&&i.push({fields:this.FieldName})}):n(n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1})).each(function(){i.push({fields:this.fieldName})});r=n("#"+this._id+"_btnInsert").data("ejButton");this._calculatedField.length==0&&(n("#"+this._id+"_btnOk").ejButton("disable"),n("#"+this._id+"_btnOk").attr("disabled","disabled"));n("#"+this._id+"_fieldCollection").ejListBox({dataSource:i,enableRTL:this.model.enableRTL,select:function(){r.enable()},height:"130",width:"400"});this.element.find(".e-dialog .e-close").attr("title",this._getLocalizedLabels("Close"));n(".calculatorFields").click(function(){n("div.calcFormulaDiv").removeAttr("style")});n(".editFormula").click(function(){var t=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),i=n("#"+t._id+"_calculatedFieldFormula").val().lastIndexOf(" ");n("#"+t._id+"_calculatedFieldFormula").val()!==""&&i>0?i+1==n("#"+t._id+"_calculatedFieldFormula").val().length?n("#"+t._id+"_calculatedFieldFormula").val(n("#"+t._id+"_calculatedFieldFormula").val().substring(0,i-2)):n("#"+t._id+"_calculatedFieldFormula").val(n("#"+t._id+"_calculatedFieldFormula").val().substring(0,i)+" "):n("#"+t._id+"_calculatedFieldFormula").val("")});n(document).click(function(t){n(t.target).hasClass("calculatorFields")||n(t.target).hasClass("e-sigma")||n(t.target).parents(".calcFormulaDiv").length>0||n("div.calcFormulaDiv").css("display","none")});n("div.calcFormulaDiv").on("click","td",function(){var t=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),i=this.textContent=="C"?n("#"+t._id+"_calculatedFieldFormula").val(""):n("#"+t._id+"_calculatedFieldFormula").val(n("#"+t._id+"_calculatedFieldFormula").val()+("+-/%^*".indexOf(this.textContent)>-1?" "+this.textContent+" ":this.textContent))});n("#"+this._id+"_btnInsert").click(function(){var t=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),i=n("#"+t._id+"_fieldCollection").data("ejListBox");n("#"+t._id+"_calculatedFieldFormula").val(n("#"+t._id+"_calculatedFieldFormula").val()+i.value())});n("#"+this._id+"_btnAdd").click(function(){var i=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),r=n("#"+i._id+"_calculatedFieldFormula").val().split(" "),o=-1,f,s,e,u;if(n("#"+i._id+"_calculateFieldName").val()==""||n("#"+i._id+"_calculatedFieldFormula").val()==""){t.Pivot._createErrorDialog(i._getLocalizedLabels("EmptyField"),i._getLocalizedLabels("Warning"),i);return}for(u=0;u<r.length;u++){if(o="+-/%^*".indexOf(r[u])>-1?u:-1,o>-1&&r.length>0&&(r[0]==""||r[0]=="."||r[r.length-1]==""||r[r.length-1]=="."||r[o+1]==""||r[o+1]==".")){t.Pivot._createErrorDialog(i._getLocalizedLabels("NotValid"),i._getLocalizedLabels("Warning"),i);return}if(r[u].indexOf("(")==r[u].length-1||r[u].indexOf(")")==0||n("#"+i._id+"_calculatedFieldFormula").val().replace(/[^\(_]/g,"").length!=n("#"+i._id+"_calculatedFieldFormula").val().replace(/[^\)_]/g,"").length){t.Pivot._createErrorDialog(i._getLocalizedLabels("NotValid"),i._getLocalizedLabels("Warning"),i);return}}for(f=[],i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n(JSON.parse(i.getOlapReport()).PivotCalculations).each(function(){this.CalculationType!=8&&this.CalculationType!="Formula"&&f.push({fields:this.FieldName})}):n(i.model.dataSource.values).each(function(){f.push({fields:this.fieldName})}),r=n("#"+i._id+"_calculatedFieldFormula").val().replace(/\(|\)/g," ").split(" "),u=0;u<r.length;u++){for(s=!1,e=0;e<f.length;e++)if(r[u].indexOf(f[e].fields)>-1&&r[u]!=f[e].fields)s=!0;else if(r[u]==f[e].fields){s=!1;break}if(s){t.Pivot._createErrorDialog(i._getLocalizedLabels("NotPresent"),i._getLocalizedLabels("Warning"),i);return}}for(u=0;u<i._calculatedField.length;u++)if(i._calculatedField[u].name==n("#"+i._id+"_calculateFieldName").val()){if(confirm(i._getLocalizedLabels("Confirm"))){i._calculatedField[u].formula=n("#"+i._id+"_calculatedFieldFormula").val();n("#"+i._id+"_calculatedFieldFormula").val("");n("#"+i._id+"_calculateFieldName").val("");n("#"+i._id+"_calculateFieldList").ejDropDownList({dataSource:i._calculatedField,fields:{text:"name",value:"name"},enableRTL:i.model.enableRTL});return}return}i._calculatedField.push({name:n("#"+i._id+"_calculateFieldName").val(),formula:n("#"+i._id+"_calculatedFieldFormula").val()});n("#"+i._id+"_calculatedFieldFormula").val("");n("#"+i._id+"_calculateFieldName").val("");n("#"+i._id+"_calculateFieldList").ejDropDownList({dataSource:i._calculatedField,fields:{text:"name",value:"name"},enableRTL:i.model.enableRTL});i._calculatedField.length>0&&(n("#"+i._id+"_btnOk").ejButton("enable"),n("#"+i._id+"_btnOk").removeAttr("disabled"))});n("#"+this._id+"_btnDelete").click(function(){var i=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),r;if(i._calculatedField.length==0){t.Pivot._createErrorDialog(i._getLocalizedLabels("CalculatedFieldNameNotFound"),i._getLocalizedLabels("Warning"),i);return}for(r=0;r<i._calculatedField.length;r++)if(i._calculatedField[r].name==n("#"+i._id+"_calculateFieldName").val()){i._calculatedField.splice(r,1);break}else if(r==i._calculatedField.length-1){t.Pivot._createErrorDialog(i._getLocalizedLabels("CalculatedFieldNameNotFound"),i._getLocalizedLabels("Warning"),i);return}n("#"+i._id+"_calculatedFieldFormula").val("");n("#"+i._id+"_calculateFieldName").val("");n("#"+i._id+"_calculateFieldList").ejDropDownList({dataSource:i._calculatedField,fields:{text:"name",value:"name"},enableRTL:i.model.enableRTL})});n("#"+this._id+"_btnOk").click(function(){var i=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),r,f,u,o,e,s;for(i.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(i.model.dataSource.values=n.grep(i.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1})),r=0;r<i._calculatedField.length;r++){for(f=i._calculatedField[r].formula.replace(/\(|\)/g," ").replace(/[-+*/^%]/g," ").split(" "),u=0;u<f.length;u++)if(!n.isNumeric(f[u])&&f[u].replace(/\s+|\s+$/gm,"")!=""&&(o=i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.grep(JSON.parse(i.getOlapReport()).PivotCalculations,function(n){return n.FieldName==f[u]}).length:n.grep(i.model.dataSource.values,function(n){return n.fieldName==f[u]}).length,o==0)){t.Pivot._createErrorDialog(i._getLocalizedLabels("NotPresent"),i._getLocalizedLabels("Warning"),i);return}e=i._calculatedField[r].formula.replace(/\s+|\s+$/gm,"");e=i._parenthesisAsterisk(e);i.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&n.grep(i.model.dataSource.values,function(n){return n.fieldName==i._calculatedField[r].name&&(n.formula=i._calculatedField[r].formula),n.fieldName==i._calculatedField[r].name}).length==0&&(i.model.dataSource.values.push({fieldName:i._calculatedField[r].name,fieldCaption:i._calculatedField[r].name,isCalculatedField:!0,formula:e}),i._schemaData!=null&&i._schemaData._tableTreeObj.element.find("li[id='"+i._calculatedField[r].name+"']").find(".e-chk-inact").length>0&&i._schemaData._tableTreeObj.checkNode(i._calculatedField[r].name))}if(i.element.find(".e-dialog, .clientDialog").remove(),i._preventPanelClose(),i.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode)i._populatePivotGrid();else{t.isNullOrUndefined(i._waitingPopup)||i._waitingPopup.show();try{report=JSON.parse(i.getOlapReport()).Report}catch(h){report=i.getOlapReport()}i.model.beforeServiceInvoke!=null&&i._trigger("beforeServiceInvoke",{action:"calculatedField",element:i.element,customObject:i.model.customObject});s=JSON.stringify(i.model.customObject);eventArgs=JSON.stringify({action:"calculatedField",headerTag:JSON.stringify(i._calculatedField),currentReport:report,customObject:s});i.model.enableDeferUpdate?(t.isNullOrUndefined(i._waitingPopup)||i._waitingPopup.hide(),i.doAjaxPost("POST",i.model.url+"/"+i.model.serviceMethodSettings.calculatedField,eventArgs.replace("calculatedField","calculatedFieldDeferUpdate"),i._schemaData==null?i._renderControlSuccess:i._schemaCalculatedField)):i.doAjaxPost("POST",i.model.url+"/"+i.model.serviceMethodSettings.calculatedField,eventArgs,i._schemaData==null?i._renderControlSuccess:i._schemaCalculatedField)}});n("#"+this._id+"_btnCancel").click(function(){var t=n(this).parents(".e-pivotgrid").data("ejPivotGrid");t.element.find(".e-dialog, .clientDialog").remove();t._preventPanelClose()});this._curFocus.field=this.element.find(".e-dialog .calculateFieldName").attr("tabindex","-1").focus().addClass("hoverCell")},_schemaCalculatedField:function(i){var f,u,r;for(this._schemaData._tableTreeObj.model.nodeCheck=null,this._schemaData._tableTreeObj.model.nodeUncheck=null,r=0;r<this._calculatedField.length;r++)f=this._schemaData.element.find(".schemaFieldTree").data("ejTreeView"),this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").length==0?(u=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?{id:this._calculatedField[r].name,name:this._calculatedField[r].name,caption:this._calculatedField[r].name,isSelected:!0,spriteCssClass:""}:{id:this._calculatedField[r].name,name:this._calculatedField[r].name,isSelected:!0,calculationType:8,formula:this._calculatedField[r].formula,summaryType:6,format:null,allowRunTimeGroupByField:"false",pivotType:"PivotComputationInfo",spriteCssClass:""},this._pivotTableFields.push(u),this._schemaData._setTableFields(this._pivotTableFields),f.addNode(u),this._schemaData._tableTreeObj.element.find(".e-item").css("padding","0px")):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._schemaData!=null&&this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").find(".e-chk-inact").length>0?this._schemaData._tableTreeObj.checkNode(this._calculatedField[r].name):this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").removeClass("filter").find(".treeDrop , .filter").remove();if(this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style"),this._schemaData._tableTreeObj.model.nodeCheck=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.proxy(this._schemaData._checkedStateModified,this._schemaData):t.proxy(this._schemaData._pivotCheckedStateModified,this._schemaData),this._schemaData._tableTreeObj.model.nodeUncheck=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.proxy(this._schemaData._checkedStateModified,this._schemaData):t.proxy(this._schemaData._pivotCheckedStateModified,this._schemaData),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(this.model.enableDeferUpdate?(this._isUpdateRequired=!0,this._deferUpdateSuccess(i)):this._renderControlSuccess(i)),n(this._schemaData.element.find(".schemaValue .pivotButton")).each(function(){n(this).remove()}),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(report=JSON.parse(this.getOlapReport()),r=0;r<report.PivotCalculations.length;r++)this._schemaData._createPivotButton(report.PivotCalculations[r].FieldHeader,"value","","","");else for(r=0;r<this.model.dataSource.values.length;r++)this._schemaData._createPivotButton(this.model.dataSource.values[r],"value","","","");this._schemaData._setPivotBtnWidth()},_calculatedFieldListChange:function(t){n("#"+this._id+"_calculateFieldName").val(t.selectedText);for(var i=0;i<this._calculatedField.length;i++)this._calculatedField[i].name==t.selectedText&&n("#"+this._id+"_calculatedFieldFormula").val(this._calculatedField[i].formula)},_parenthesisAsterisk:function(n){for(var t=1;t<n.length-1;t++)n[t]=="("&&"+-/%^*(".indexOf(n[t-1])==-1&&(n=n.substring(0,t)+"*"+n.substring(t),t--),n[t]==")"&&"+-/%^*)".indexOf(n[t+1])==-1&&(n=n.substring(0,t+1)+"*"+n.substring(t+1),t--);return n},_calcFieldNodeDrop:function(t){for(var r=n.grep(this.model.dataSource.values,function(n){return n.isCalculatedField==!0&&n.formula.indexOf(t.fieldName)>-1}),i=0;i<r.length;i++)this._schemaData._tableTreeObj.uncheckNode(r[i].fieldName)},_schemaButtonCreate:function(){if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){n(this._schemaData.element.find(".schemaValue .pivotButton")).each(function(){n(this).remove()});report=JSON.parse(this.getOlapReport());for(var i=0;i<report.PivotCalculations.length;i++)this._schemaData._createPivotButton(report.PivotCalculations[i].FieldHeader,"value","","","")}this._schemaData._setPivotBtnWidth()},_calculatedFieldNodeRemove:function(i){for(var u=n.grep(JSON.parse(this.getOlapReport()).PivotCalculations,function(n){return n.CalculationType==8&&n.Formula.indexOf(i.id)>-1}),r=0;r<u.length;r++)this._schemaData._tableTreeObj.model.nodeUncheck=null,this._schemaData._tableTreeObj.uncheckNode(u[r].FieldName),this._schemaData._tableTreeObj.element.find("li[id='"+u[r].FieldName+"']").removeClass("filter").find(".treeDrop").remove(),this._schemaData._tableTreeObj.model.nodeUncheck=t.proxy(this._schemaData._checkedStateModified,this._schemaData)},createConditionalDialog:function(){var o,s,h,y,c,l,a,v,i,r,e,u,f;this.element.find(".e-dialog").remove();o=t.buildTag("div#"+this._id+"_clientDlg.clientDialog",{opacity:"1"})[0].outerHTML;h=this._getLocalizedLabels("ConditionalFormatting");var p=t.buildTag("label#"+this._id+"_conLbl.conditionLbl",this._getLocalizedLabels("Condition"))[0].outerHTML,w=t.buildTag("input#"+this._id+"_conType.conditionType","",{},{type:"text",tabindex:0,accesskey:"f"})[0].outerHTML,b=t.buildTag("label#"+this._id+"_editcond.editcondition",this._getLocalizedLabels("Editcondtion"))[0].outerHTML,k=t.buildTag("label#"+this._id+"_value1.value1",this._getLocalizedLabels("Value1"))[0].outerHTML,d=t.buildTag("label#"+this._id+"_value2.value2",this._getLocalizedLabels("Value2"))[0].outerHTML,g=t.buildTag("label#"+this._id+"_backcolorLbl.backcolorLbl",this._getLocalizedLabels("Backcolor"))[0].outerHTML,nt=t.buildTag("label#"+this._id+"_bordercolorLbl.bordercolorLbl",this._getLocalizedLabels("Bordercolor"))[0].outerHTML,tt=t.buildTag("label#"+this._id+"_borderrangeLbl.borderrangeLbl",this._getLocalizedLabels("Borderrange"))[0].outerHTML,it=t.buildTag("label#"+this._id+"_borderstyleLbl.borderstyleLbl",this._getLocalizedLabels("Borderstyle"))[0].outerHTML,rt=t.buildTag("label#"+this._id+"_fStyleLbl.fStyleLbl",this._getLocalizedLabels("Fontstyle"))[0].outerHTML,ut=t.buildTag("label#"+this._id+"_fSizeLbl.fSizeLbl",this._getLocalizedLabels("Fontsize"))[0].outerHTML,ft=t.buildTag("label#"+this._id+"_fValueLbl.fValueLbl",this._getLocalizedLabels("Measures"))[0].outerHTML,et=t.buildTag("input#"+this._id+"_editCon.editconditionDropDown","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,y=t.buildTag("button#"+this._id+"_removeBtn.dialogremoveBtn e-icon","",{},{name:this._getLocalizedLabels("Remove")}).attr("role","button").attr("aria-label","remove")[0].outerHTML,ot=t.buildTag("input#"+this._id+"_conFrom.conditionFrom","",{},{name:"inputVal",type:t.isMobile()?"number":"text",inputmode:t.isMobile()?"numeric":"",pattern:t.isMobile()?"[0-9]*":"",tabindex:2})[0].outerHTML,st=t.buildTag("input#"+this._id+"_conTo.conditionTo","",{},{name:"inputVal",type:t.isMobile()?"number":"text",inputmode:t.isMobile()?"numeric":"",pattern:t.isMobile()?"[0-9]*":"",tabindex:3})[0].outerHTML,ht=t.buildTag("input#"+this._id+"_backcolor.backcolor","",{},{type:"text",tabindex:4,accesskey:"b"})[0].outerHTML,ct=t.buildTag("input#"+this._id+"_bordercolor.bordercolor","",{},{type:"text",tabindex:5,accesskey:"c"})[0].outerHTML,lt=t.buildTag("input#"+this._id+"_borderrange.borderrange","",{},{type:"text",tabindex:6,accesskey:"r"})[0].outerHTML,at=t.buildTag("input#"+this._id+"_borderstyle.borderstyle","",{},{type:"text",tabindex:7,accesskey:"s"})[0].outerHTML,vt=t.buildTag("input#"+this._id+"_fStyle.fStyle","",{},{type:"text",tabindex:8,accesskey:"o"})[0].outerHTML,yt=t.buildTag("input#"+this._id+"_fSize.fSize","",{},{type:"text",tabindex:9,accesskey:"l"})[0].outerHTML,pt=t.buildTag("input#"+this._id+"_fValue.fValue","",{},{type:"text",tabindex:10,accesskey:"v"})[0].outerHTML,wt=t.buildTag("div#"+this._id+"_conditionDlg.conditionDlg","<table class='conditionformatTbl'><tr><td>"+p+"<\/td><td>"+w+"<\/td><td>"+b+"<\/td><td>"+et+"<\/td><td>"+y+"<\/td><\/tr><tr><td>"+k+"<\/td><td>"+ot+"<\/td><td>"+d+"<\/td><td>"+st+"<\/td><\/tr><tr><td>"+g+"<\/td><td>"+ht+"<\/td><td>"+tt+"<\/td><td>"+lt+"<\/td><\/tr><tr><td>"+nt+"<\/td><td>"+ct+"<\/td><td>"+it+"<\/td><td>"+at+"<\/td><\/tr><tr><td>"+rt+"<\/td><td>"+vt+"<\/td><td>"+ut+"<\/td><td>"+yt+"<\/td><\/tr><tr><td>"+ft+"<\/td><td>"+pt+"<\/td><\/tr><\/table>")[0].outerHTML;if(s=wt,a=t.buildTag("button#"+this._id+"_OKBtn.dialogOKBtn","",{},{name:this._getLocalizedLabels("OK")})[0].outerHTML,v=t.buildTag("button#"+this._id+"_CancelBtn.dialogCancelBtn","",{},{name:this._getLocalizedLabels("Cancel")})[0].outerHTML,dialogFooter=t.buildTag("div",a+v,{float:this.model.enableRTL?"left":"right",margin:"20px 39px 6px"})[0].outerHTML,n("#"+this._id).after(o),n("#"+this._id+"_clientDlg").append(s+dialogFooter),n("#"+this._id+"_clientDlg").ejDialog({width:"auto",target:"#"+this._id,enableResize:!1,enableRTL:this.model.enableRTL,close:this._preventPanelClose}),n(".e-titlebar").prepend(t.buildTag("div",h,{display:"inline"})[0].outerHTML)[0],n("#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,#"+this._id+"_removeBtn").ejButton({type:t.ButtonType.Button}),n("#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn").css({margin:"0 0 0 10px",width:"67px"}),n("#"+this._id+"_removeBtn").css({width:"29px",height:"29px"}),n("#"+this._id+"_conFrom,#"+this._id+"_conTo").css({width:"200px",height:"26px"}),n("#"+this._id+"_conditionDlg").css({margin:"13px 0 0 0"}),n("#"+this._id+"_editcond,#"+this._id+"_value2,#"+this._id+"_borderrangeLbl,#"+this._id+"_borderstyleLbl,#"+this._id+"_fSizeLbl").css({margin:"0 0 0 15px"}),n("#"+this._id+"_conTo").attr("disabled","disabled"),this.removeBtn=n("#"+this._id+"_removeBtn").data("ejButton"),c=n("#"+this._id+"_OKBtn").data("ejButton"),l=n("#"+this._id+"_CancelBtn").data("ejButton"),this.removeBtn.setModel({enabled:!1}),c.setModel({text:this._getLocalizedLabels("OK")}),l.setModel({text:this._getLocalizedLabels("Cancel")}),n("#"+this._id+"_conType").ejDropDownList({change:"_activeConditionChange",dataSource:[{option:"Less Than",value:this._getLocalizedLabels("LessThan")},{option:"Less Than Or Equal To",value:this._getLocalizedLabels("LessThanOrEqualTo")},{option:"Greater Than",value:this._getLocalizedLabels("GreaterThan")},{option:"Greater Than Or Equal To",value:this._getLocalizedLabels("GreaterThanOrEqualTo")},{option:"Equals",value:this._getLocalizedLabels("Equals")},{option:"Not Equals",value:this._getLocalizedLabels("NotEquals")},{option:"Between",value:this._getLocalizedLabels("Between")},{option:"Not Between",value:this._getLocalizedLabels("NotBetween")},],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px"}),n("#"+this._id+"_editCon").ejDropDownList({change:"_editConditionChange",dataSource:this._list,selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px"}),n("#"+this._id+"_backcolor").ejDropDownList({dataSource:[{option:"AliceBlue",value:this._getLocalizedLabels("AliceBlue")},{option:"Black",value:this._getLocalizedLabels("Black")},{option:"Blue",value:this._getLocalizedLabels("Blue")},{option:"Brown",value:this._getLocalizedLabels("Brown")},{option:"Gold",value:this._getLocalizedLabels("Gold")},{option:"Green",value:this._getLocalizedLabels("Green")},{option:"Lime",value:this._getLocalizedLabels("Lime")},{option:"Maroon",value:this._getLocalizedLabels("Maroon")},{option:"Orange",value:this._getLocalizedLabels("Orange")},{option:"Pink",value:this._getLocalizedLabels("Pink")},{option:"Red",value:this._getLocalizedLabels("Red")},{option:"Violet",value:this._getLocalizedLabels("Violet")},{option:"White",value:this._getLocalizedLabels("White")},{option:"Yellow",value:this._getLocalizedLabels("Yellow")},],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px"}),n("#"+this._id+"_bordercolor").ejDropDownList({dataSource:[{option:"AliceBlue",value:this._getLocalizedLabels("AliceBlue")},{option:"Black",value:this._getLocalizedLabels("Black")},{option:"Blue",value:this._getLocalizedLabels("Blue")},{option:"Brown",value:this._getLocalizedLabels("Brown")},{option:"Gold",value:this._getLocalizedLabels("Gold")},{option:"Green",value:this._getLocalizedLabels("Green")},{option:"Lime",value:this._getLocalizedLabels("Lime")},{option:"Maroon",value:this._getLocalizedLabels("Maroon")},{option:"Orange",value:this._getLocalizedLabels("Orange")},{option:"Pink",value:this._getLocalizedLabels("Pink")},{option:"Red",value:this._getLocalizedLabels("Red")},{option:"Violet",value:this._getLocalizedLabels("Violet")},{option:"White",value:this._getLocalizedLabels("White")},{option:"Yellow",value:this._getLocalizedLabels("Yellow")},],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px"}),n("#"+this._id+"_borderrange").ejDropDownList({dataSource:["1","2","3","4","5","6","7","8","9"],selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px"}),n("#"+this._id+"_borderstyle").ejDropDownList({dataSource:[{option:"Solid",value:this._getLocalizedLabels("Solid")},{option:"Dashed",value:this._getLocalizedLabels("Dashed")},{option:"Dotted",value:this._getLocalizedLabels("Dotted")},{option:"Double",value:this._getLocalizedLabels("Double")},{option:"Groove",value:this._getLocalizedLabels("Groove")},{option:"Inset",value:this._getLocalizedLabels("Inset")},{option:"Outset",value:this._getLocalizedLabels("Outset")},{option:"Ridge",value:this._getLocalizedLabels("Ridge")},{option:"None",value:this._getLocalizedLabels("None")},],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px"}),n("#"+this._id+"_fStyle").ejDropDownList({dataSource:[{option:"Algerian",value:this._getLocalizedLabels("Algerian")},{option:"Arial",value:this._getLocalizedLabels("Arial")},{option:"Bodoni MT",value:this._getLocalizedLabels("BodoniMT")},{option:"Britannic Bold",value:this._getLocalizedLabels("BritannicBold")},{option:"Cambria",value:this._getLocalizedLabels("Cambria")},{option:"Calibri",value:this._getLocalizedLabels("Calibri")},{option:"Courier New",value:this._getLocalizedLabels("CourierNew")},{option:"DejaVu Sans",value:this._getLocalizedLabels("DejaVuSans")},{option:"Forte",value:this._getLocalizedLabels("Forte")},{option:"Gerogia",value:this._getLocalizedLabels("Gerogia")},{option:"Impact",value:this._getLocalizedLabels("Impact")},{option:"Segoe UI",value:this._getLocalizedLabels("SegoeUI")},{option:"Tahoma",value:this._getLocalizedLabels("Tahoma")},{option:"Times New Roman",value:this._getLocalizedLabels("TimesNewRoman")},{option:"Verdana",value:this._getLocalizedLabels("Verdana")},{option:"None",value:this._getLocalizedLabels("None")},],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px"}),n("#"+this._id+"_fSize").ejDropDownList({dataSource:["12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px"}),i=[],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)r=JSON.parse(this.getOlapReport()).PivotCalculations,e="FieldHeader";else if(e="fieldCaption",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)r=this.model.dataSource.values;else for(u=0;u<this.model.dataSource.values.length;u++)r=this.model.dataSource.values[u].measures;for(i=r.length>0?["All"]:i,f=0;f<r.length;f++)i.push(r[f][e]);return i=i.length>0?i:["No Measure"],n("#"+this._id+"_fValue").ejDropDownList({dataSource:i,selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px"}),this.element.find("#"+this._id+"_conType").ejDropDownList("option","change",t.proxy(this._activeConditionChange,this)),this.element.find("#"+this._id+"_editCon").ejDropDownList("option","change",t.proxy(this._editConditionChange,this)),this.isNewFormat=!0,this.ddlEditCondition=n("#"+this._id+"_editCon").data("ejDropDownList"),this.ddlConditionType=n("#"+this._id+"_conType").data("ejDropDownList"),this.ddlFont=n("#"+this._id+"_fStyle").data("ejDropDownList"),this.ddlFontSize=n("#"+this._id+"_fSize").data("ejDropDownList"),this.ddlBackColor=n("#"+this._id+"_backcolor").data("ejDropDownList"),this.ddlBorderColor=n("#"+this._id+"_bordercolor").data("ejDropDownList"),this.ddlBorderStyle=n("#"+this._id+"_borderstyle").data("ejDropDownList"),this.ddlBorderWidth=n("#"+this._id+"_borderrange").data("ejDropDownList"),this.ddlFieldValue=n("#"+this._id+"_fValue").data("ejDropDownList"),this.element.find("#"+this._id+"_conFrom,#"+this._id+"_conTo").keypress(function(t){return t.which==8||t.which==0?!0:t.which<45||t.which==45&&(t.target.value!=""||t.target.value.indexOf("-")>-1)||t.which>58?!1:t.which==46&&n(this).val().indexOf(".")!=-1||t.which==47?!1:void 0}),n("#"+this._id+"_OKBtn").click(function(){var i=n(this).parents(".e-pivotgrid").data("ejPivotGrid");this.ddlEditCondition=n("#"+i._id+"_editCon").data("ejDropDownList");n("#"+i._id+"_conFrom").val()==""?t.Pivot._createErrorDialog(i._getLocalizedLabels("EnterOperand1"),i._getLocalizedLabels("Warning"),i):n("#"+i._id+"_conTo").attr("disabled")||n("#"+i._id+"_conTo").val()!=""?n("#"+i._id+"_fValue").attr("disabled")&&n("#"+i._id+"_fValue").val()=="No Measure"?t.Pivot._createErrorDialog(i._getLocalizedLabels("NoMeasure"),i._getLocalizedLabels("Warning"),i):(i._applyFormatting(),i._preventPanelClose()):t.Pivot._createErrorDialog(i._getLocalizedLabels("EnterOperand2"),i._getLocalizedLabels("Warning"),i)}),this.ddlEditCondition.getListData().length>1?n("#"+this._id+"_editCon").ejDropDownList("enable"):(n("#"+this._id+"_editCon").ejDropDownList("disable"),n("#"+this._id+"_editcond").css("color","#cbcbcb")),this.ddlFieldValue.getListData().length==1&&this.ddlFieldValue._selectedValue=="No Measure"?(n("#"+this._id+"_fValue").ejDropDownList("disable"),n("#"+this._id+"_fValueLbl").css("color","#cbcbcb")):n("#"+this._id+"_fValue").ejDropDownList("enable"),this._cFormat.length>0&&(this.ddlEditCondition.selectItemByValue(this._cFormat[this._cFormat.length-1].split(",")[0]),this._editConditionChange()),n("#"+this._id+"_removeBtn").click(function(){var t=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),i,r;t.removeBtn.option("enabled")&&(i=confirm(t._getLocalizedLabels("ConditionalFormattingConformMsg")),i==!0&&(r=t.ddlEditCondition._selectedIndices[0],t._removeCellFormatting(r,i)))}),n("#"+this._id+"_CancelBtn").click(function(){var t=n(this).parents(".e-pivotgrid").data("ejPivotGrid");t.element.find(".e-dialog, .clientDialog").remove();t._preventPanelClose()}),!1},_preventPanelClose:function(i){this.element.find("#preventDiv").remove();!n(".e-pivotgrid").data("ejWaitingPopup")||!t.isNullOrUndefined(i)&&(n(i.target).hasClass("pivotTree")||n(i.target).hasClass("pivotTreeContext")||n(i.target).hasClass("pivotTreeContextMenu"))||n(".e-pivotgrid").data("ejWaitingPopup").hide()},_activeConditionChange:function(t){t.selectedValue=="Between"||t.selectedValue=="Not Between"?n("#"+this._id+"_conTo").removeAttr("disabled"):(n("#"+this._id+"_conTo").attr("disabled","disabled"),n("#"+this._id+"_conTo").val(""))},_editConditionChange:function(){if(this.ddlEditCondition._selectedIndices[0]>0){var i=this.ddlEditCondition._selectedIndices[0]-1,t=this._cFormat[i].split(",");this.ddlConditionType.selectItemByValue(t[1]);n("#"+this._id+"_conFrom").val(t[8]);t[9]!="undefined"&&n("#"+this._id+"_conTo").val(t[9]);this.ddlBackColor.selectItemByValue(t[2]);this.ddlBorderColor.selectItemByValue(t[3]);this.ddlBorderStyle.selectItemByValue(t[7]);this.ddlBorderWidth.selectItemByValue(t[4]);this.ddlFont.selectItemByValue(t[5]);this.ddlFontSize.selectItemByValue(t[6]);this.ddlFieldValue.selectItemByValue(t[10]);this.removeBtn.option("enabled",!0);this._conditionTypeChange()}else this.removeBtn.option("enabled",!1),this._clearWindow()},_clearWindow:function(){n("#"+this._id+"_clientDlg").find("#"+this._id+"_conFrom,#"+this._id+"_conTo").val("");n("#"+this._id+"_conTo").disabled=!0},_conditionTypeChange:function(){n("#"+this._id+"_conTo").disabled=!(this.ddlConditionType._selectedIndices[0]==4||this.ddlConditionType._selectedIndices[0]==5)},_removeCellFormatting:function(n,t){for(var i,u=n,r=0;r<this._cFormat.length&&n;r++)for(t&&(r=n-1,n=0),i=0;i<this._JSONRecords.length;i++)this._JSONRecords[i].CSS=this._JSONRecords[i].CSS.replace(" "+this._cFormat[r].split(",")[0],"");t?(this._cFormat.splice(u-1,1),this._list.splice(u,1)):(this._cFormat=[],this._list=[]);this.renderControlFromJSON()},_applyStyle:function(t,i,r,u,f,e,o,s,h){var v=i.CSS,a=!1,l=t=="rows"?i.Index.split(",")[1]:t=="columns"?i.Index.split(",")[0]:null,c;(i.Value==r||r=="All")&&(n.inArray(Number(l),u)==-1?u.push(Number(l)):u);c=n.isNumeric(i.Value)==!0?i.Value:i.Value.replace(/[^\d.]/g,"");a=n.inArray(Number(l),u)!=-1?!0:!1;this._getResult(Number(f),Number(e),c,o)&&c!=""&&n.isNumeric(c)&&a&&i.CSS.indexOf("value")!=-1&&(i.CSS=v+" "+h)},_refreshCellFormatting:function(n){for(var u,t,i,f=this._getAxis(),r=0;r<this._cFormat.length;r++)for(u=[],t=this._cFormat[r].split(","),i=0;i<n.length;i++)n[i].CSS.indexOf(t[0])===-1&&this._applyStyle(f,n[i],t[10],u,t[8],t[9],t[1],i,this._cFormat[r].split(",")[0]);return n},_createDynamicRule:function(n,t,i,r,u,f,e){var o=function(){var n=document.createElement("style");return n.appendChild(document.createTextNode("")),document.head.appendChild(n),n.sheet}(),s="background-color: "+n+" !important;border:"+t+" "+i+"px "+r+" !important;font:"+u+"px "+f+" !important;";o.insertRule("."+e+"{"+s+"}",0)},_getAxis:function(){var u,i,n;if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){for(u=null,this.getOlapReport()!=r&&this.getOlapReport()!=""&&JSON.parse(this.getOlapReport()).PivotCalculations.length>0&&(u=JSON.parse(this.getOlapReport()).PivotCalculations[0].FieldHeader),n=0;n<this._JSONRecords.length;n++)if(this._JSONRecords[n].Value==u){i=this._JSONRecords[n].CSS=="colheader"?"columns":this._JSONRecords[n].CSS=="rowheader"?"rows":"";break}}else if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)i="columns";else for(n=0;n<this.getOlapReport().values.length;n++)i=this.getOlapReport().values[n].axis;return i},_applyCodeBehindFormatting:function(i){var o,s,r,f,e,h,u,c;if(this._isFormatApply=!0,s=this._getAxis(),!t.isNullOrUndefined(this.model.conditionalFormatSettings))for(r=0;r<this.model.conditionalFormatSettings.length;r++)if(f=[],f=this.model.conditionalFormatSettings[r].measures.split(","),n.inArray(this.model.conditionalFormatSettings[r].name,this._list)==-1){for(e=0;e<f.length;e++)for(h=[],o=f[e],u=0;u<i.length;u++)this._applyStyle(s,i[u],o,h,this.model.conditionalFormatSettings[r].value.split(",")[0],this.model.conditionalFormatSettings[r].value.split(",")[1],this.model.conditionalFormatSettings[r].condition,u,this.model.conditionalFormatSettings[r].name);c=this.model.conditionalFormatSettings[r].name+","+this.model.conditionalFormatSettings[r].condition+","+this.model.conditionalFormatSettings[r].style.backgroundcolor+","+this.model.conditionalFormatSettings[r].style.bordercolor+","+this.model.conditionalFormatSettings[r].style.borderwidth+","+this.model.conditionalFormatSettings[r].style.fontstyle+","+this.model.conditionalFormatSettings[r].style.fontsize+","+this.model.conditionalFormatSettings[r].style.borderstyle+","+this.model.conditionalFormatSettings[r].value.split(",")[0]+","+this.model.conditionalFormatSettings[r].value.split(",")[1]+","+o;this._cFormat.push(c);this._list.push(this.model.conditionalFormatSettings[r].name);this._createDynamicRule(this.model.conditionalFormatSettings[r].style.backgroundcolor,this.model.conditionalFormatSettings[r].style.borderstyle,this.model.conditionalFormatSettings[r].style.borderwidth,this.model.conditionalFormatSettings[r].style.bordercolor,this.model.conditionalFormatSettings[r].style.fontsize,this.model.conditionalFormatSettings[r].style.fontstyle,this.model.conditionalFormatSettings[r].name)}return this._JSONRecords=i,i},_applyFormatting:function(){var o,u,s,f,c=[],h,e,i;if(t.isNullOrUndefined(n("#"+this._id+"_conFrom").val())||(this._formatValue1=n("#"+this._id+"_conFrom").val(),this._formatValue2=n("#"+this._id+"_conTo").val(),cdnTxt=this.ddlConditionType._selectedValue,color=this.ddlBackColor._selectedValue,bordercolor=this.ddlBorderColor._selectedValue,borderrange=this.ddlBorderWidth._selectedValue,fStyle=this.ddlFont._selectedValue,fSize=this.ddlFontSize._selectedValue,borderstyle=this.ddlBorderStyle._selectedValue,editCdn=this.ddlEditCondition._selectedValue),f=this.ddlFieldValue._selectedValue!=r?this.ddlFieldValue._selectedValue:"",h=this._getAxis(),n("#"+this._id+"_editCon").val()==this._getLocalizedLabels("AddNew")){for(i=this._cFormat.length;i<this._cFormat.length+1;i++)for(u="Format"+i,e=i;n.inArray(u,this._list)!=-1;e++)u="Format"+e;o=u+","+this.ddlConditionType._selectedValue+","+color+","+bordercolor+","+borderrange+","+fStyle+","+fSize+","+borderstyle+","+this._formatValue1+","+this._formatValue2+","+f;this._cFormat.push(o);this._list.push(u)}else for(u=this.ddlEditCondition._selectedValue,s=this.ddlEditCondition._selectedIndices[0]-1,this._cFormat[s]=u+","+this.ddlConditionType._selectedValue+","+color+","+bordercolor+","+borderrange+","+fStyle+","+fSize+","+borderstyle+","+this._formatValue1+","+this._formatValue2+","+f,i=0;i<this._JSONRecords.length;i++)this._JSONRecords[i].CSS=this._JSONRecords[i].CSS.replace(" "+u,"");for(i=0;i<this._JSONRecords.length;i++)this._applyStyle(h,this._JSONRecords[i],f,c,this._formatValue1,this._formatValue2,this.ddlConditionType._selectedValue,i,u);this._createDynamicRule(color,borderstyle,borderrange,bordercolor,fSize,fStyle,u);this.renderControlFromJSON();this.element.find(".e-dialog, .clientDialog").remove()},_getResult:function(n,t,i,r){switch(r){case"Less Than":return i<n;case"Less Than Or Equal To":if(i<=n)return i;break;case"Greater Than":return i>n;case"Greater Than Or Equal To":if(i>=n)return i;break;case"Equals":if(i==n)return i;break;case"Not Equals":return i!=n;case"Between":return n<t&&i>n&&i<t||n>t&&i<n&&i>t||i==n&&i==t;case"Not Between":return!(n<t&&i>n&&i<t||n>t&&i<n&&i>t||i==n&&i==t)}},_updatePageSettings:function(t,i){var r=n.map(t,function(n){if(n.Key=="PageSettings")return n}),u=n.map(t,function(n){if(n.Key=="HeaderCounts")return n});r.length>0&&i._pagerObj!=null&&(i._pagerObj.element.css("opacity","1"),i._pagerObj.element.find(".pagerTextBox").removeAttr("disabled"),i._pagerObj._unwireEvents(),i._pagerObj._wireEvents(),i._pagerObj.initPagerProperties(JSON.parse(u[0].Value),JSON.parse(r[0].Value)))},_renderControlSuccess:function(i){var f,e,o,u,s;try{if(i[0]!=r&&i.length>0?(this.setJSONRecords(i[0].Value),this.setOlapReport(i[1].Value),i[2]!=null&&i[2]!=r&&i[2].Key=="PageSettings"&&(this.model.enableVirtualScrolling||typeof oclientProxy!="undefined"&&oclientProxy.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i[3].Value).Column/JSON.parse(i[2].Value).CategorialPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i[3].Value).Row/JSON.parse(i[2].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i[2].Value).CategorialCurrentPage,this._seriesCurrentPage=JSON.parse(i[2].Value).SeriesPageSize):n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&this._pagerObj!=null&&this._pagerObj.initPagerProperties(JSON.parse(i[3].Value),JSON.parse(i[2].Value)),t.isNullOrUndefined(i[4])||(i[4].Key=="DataSet"?(this._dataSet=i[4].Value,t.isNullOrUndefined(i[5])||(this.model.customObject=i[5].Value)):this.model.customObject=i[4].Value)),t.isNullOrUndefined(i[2])||i[2].Key=="PageSettings"||(i[2].Key=="DataSet"?(this._dataSet=i[2].Value,t.isNullOrUndefined([3])||(this.model.customObject=i[3].Value)):this.model.customObject=i[2].Value),typeof oclientProxy!="undefined"&&oclientProxy._pagerObj!=null&&this._updatePageSettings(i,oclientProxy)):i.d!=r&&i.d.length>0?(this.setJSONRecords(i.d[0].Value),this.setOlapReport(i.d[1].Value),i.d[2]!=null&&i.d[2]!=r&&i.d[2].Key=="PageSettings"?(this.model.enableVirtualScrolling||typeof oclientProxy!="undefined"&&oclientProxy.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.d[3].Value).Column/JSON.parse(i.d[2].Value).CategorialPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.d[3].Value).Row/JSON.parse(i.d[2].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i.d[2].Value).CategorialCurrentPage,this._seriesCurrentPage=JSON.parse(i.d[2].Value).SeriesCurrentPage):this._pagerObj!=null&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&this._pagerObj.initPagerProperties(JSON.parse(i.d[3].Value),JSON.parse(i.d[2].Value)),t.isNullOrUndefined(i.d[4])||(i.d[4].Key=="DataSet"?(this._dataSet=i.d[4].Value,t.isNullOrUndefined(i.d[5])||(this.model.customObject=i.d[5].Value)):this.model.customObject=i.d[4].Value),typeof oclientProxy!="undefined"&&oclientProxy._pagerObj!=null&&this._updatePageSettings(i.d,oclientProxy)):typeof oclientProxy!="undefined"&&oclientProxy._pagerObj!=null&&i.d.length==2&&(oclientProxy._pagerObj.element.css("opacity","0.5"),oclientProxy._pagerObj.element.find(".pagerTextBox").attr("disabled","disabled"),oclientProxy._pagerObj._unwireEvents()),t.isNullOrUndefined(i[2])||i.d[2].Key=="PageSettings"||(i.d[2].Key=="DataSet"?(this._dataSet=i.d[2].Value,t.isNullOrUndefined([3])||(this.model.customObject=i.d[3].Value)):this.model.customObject=i.d[2].Value)):!t.isNullOrUndefined(i)&&t.isNullOrUndefined(i.d)&&(i.PivotRecords!=r?(this.setJSONRecords(i.PivotRecords),this.setOlapReport(i.OlapReport),i.HeaderCounts!=r&&(this.model.enableVirtualScrolling||typeof oclientProxy!="undefined"&&oclientProxy.model.enableVirtualScrolling)?(this._categPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Column/JSON.parse(i.PageSettings).CategorialPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Row/JSON.parse(i.PageSettings).SeriesPageSize),this._categCurrentPage=JSON.parse(i.PageSettings).CategorialCurrentPage,this._seriesCurrentPage=JSON.parse(i.PageSettings).SeriesCurrentPage):i.HeaderCounts!=r&&this._pagerObj!=null&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r?this._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings)):i.HeaderCounts!=r&&typeof oclientProxy!="undefined"&&oclientProxy._pagerObj!=null&&oclientProxy._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))):i.JsonRecords!=r&&this.model.enableJSONRendering==!0?(this.setJSONRecords(JSON.stringify(i.JsonRecords)),this.setOlapReport(JSON.stringify(i.PivotReport)),i.DataSet!=null&&(this._dataSet=i.DataSet)):i.JsonRecords!=r?(this.setJSONRecords(i.JsonRecords),this.setOlapReport(i.PivotReport),i.DataSet!=null&&(this._dataSet=i.DataSet)):i.JsonRecords==r&&(this.setJSONRecords(null),i.PivotReport&&this.setOlapReport(i.PivotReport),i.OlapReport&&this.setOlapReport(i.OlapReport)),i.customObject!=null&&i.customObject!=r&&(this.model.customObject=i.customObject)),(this.model.enableVirtualScrolling||n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r)&&this.layout("nosummaries"),this.getOlapReport()!=r&&this.getOlapReport()!=""&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)try{t.isNullOrUndefined(JSON.parse(this.getOlapReport()).DataModel)||(this.model.analysisMode=JSON.parse(this.getOlapReport()).DataModel=="Olap"?t.Pivot.AnalysisMode.Olap:t.Pivot.AnalysisMode.Pivot)}catch(h){}if(this.model.enableGroupingBar==!0&&(report=JSON.parse(this.getOlapReport()),f=JSON.parse(report.ItemsProperties),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(e=report.PivotRows.concat(report.PivotColumns,report.PivotCalculations,report.Filters),o=n.grep(f,function(t){return n.grep(e,function(n){t.id==(n.FieldHeader||n.DimensionHeader)&&(t.id=n.FieldName||n.DimensionName)}),t}),this._pivotTableFields=o):this._pivotTableFields=f,this._createGroupingBar(report)),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(report=JSON.parse(this.getOlapReport()),u=0;u<report.PivotCalculations.length;u++)(report.PivotCalculations[u].CalculationType==8||report.PivotCalculations[u].CalculationType=="Formula")&&n.grep(this._calculatedField,function(n){return n.name==report.PivotCalculations[u].FieldName}).length==0&&this._calculatedField.push({name:report.PivotCalculations[u].FieldName,formula:report.PivotCalculations[u].Formula});this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"initialize",element:this.element,customObject:this.model.customObject});this.getJSONRecords()!=null&&this.getJSONRecords().length>0?this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&this.model.enableVirtualScrolling==!1&&n(".e-pivotpager")[0]==null?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON(this.getJSONRecords()):this.renderControlFromJSON("");typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?n("#"+oclientProxy._id+"_maxView")[0]&&this._maxViewLoading?this._maxViewLoading.hide():oclientWaitingPopup.hide():this._waitingPopup.hide();t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")}catch(h){}this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._schemaData!=null&&this._schemaButtonCreate();s={action:"initialize",customObject:this.model.customObject,element:this.element};this._trigger("renderSuccess",s);t.isNullOrUndefined(i.Exception)||t.Pivot._createErrorDialog(i,"Exception",this)},_hideGrandTotal:function(u){var v,c,e,o,w,g,y,s,a,h,d,p,b,l,f;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(this.model.enableRowGrandTotal&&this.model.enableGrandTotal||((this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&u.find(".rowhead tr:last").hide(),u.find("tr:last").hide()),u.find("tr:first th.summary").attr("p")!=r&&(!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(v=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?u.find("th.gtot[role^='columnheader']"):u.find("th.cgtot[role^='columnheader']"),cLen=0;cLen<v.length;cLen++)u.find('[p^="'+parseInt(n(v[cLen]).attr("p").split(",")[0])+',"]').hide(),u.find('[p^="'+parseInt(n(v[cLen]).attr("p").split(",")[0])+',"]').hide()}else if(this.model.layout=="normal"&&(c=!0,e=0,this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||this.model.analysisMode==t.Pivot.AnalysisMode.Olap)){if((!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)&&(rwLen=n(u).find("thead tr").length,rwLen>1||rwLen==1&&n(u).find("th[p$=',"+e+"']").attr("class")=="summary")){while(c)o=n(u).find("th.summary[p$=',"+e+"']"),o.length&&(c=!1),e++;for(s=0;s<o.length;s++){var a=e,h=o[s];for(selectedCellPos=n(h).attr("p"),i=parseInt(selectedCellPos.split(",")[1])-1,w=n(h).attr("colspan"),g=n(u).find("thead tr").length+n(u).find("tbody tr").length,y=0;y<parseInt(w);y++)n(u).find(" [p^='"+(parseInt(selectedCellPos.split(",")[0])+y)+",']").css("display","none");if(i>=0)for(l=n(u).find(" [p^='"+selectedCellPos.split(",")[0]+","+i+"']")[0];a>1;){if(t.isNullOrUndefined(l))for(i=parseInt(selectedCellPos.split(",")[1])-1;i>=0;i--){if(f=n(u).find("[p='"+selectedCellPos.split(",")[0]+","+i+"']")[0],t.isNullOrUndefined(f))for(k=parseInt(selectedCellPos.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(f)&&(f=n(u).find("[p='"+k+","+i+"']")[0]);!t.isNullOrUndefined(f)&&n(f).css("display")!="none"&&n(n(f).parents("tr")[0]).css("display")!="none"&&(n(f).hasClass("rowheader")||n(f).attr("role")=="rowheader"||n(f).hasClass("colheader")||n(f).attr("role")=="columnheader"||n(f).hasClass("value")||n(f).attr("role")=="gridcell")&&(l=f);set_spn=parseInt(n(f).attr("colspan"))-parseInt(w);n(f).attr("colspan",set_spn)}t.isNullOrUndefined(f)||a--}}}if(c=!0,e=0,o="",!this.model.enableRowGrandTotal||!this.model.enableGrandTotal){if(rwLen=n(u).find("tbody tr").length,rwLen>1||rwLen==1&&n(u).find("th[p^='"+e+",']")=="summary")for(rwLen=n(u).find("tbody tr").length;c;)o=n(u).find("th.summary[p^='"+e+",']"),o.length&&(c=!1),e++;if(rwLen>0)for(s=0;s<o.length;s++){for(a=e,h=o[s],selectedCellPos=n(h).attr("p"),i=parseInt(selectedCellPos.split(",")[0])-1,d=n(h).attr("rowspan"),p=n(h).parent(),b=0;b<h.rowSpan;b++)n(p).css("display","none"),p=n(p).next();if(i>=0)for(l=n(u).find(" [p^='"+i+","+selectedCellPos.split(",")[1]+"']")[0];a>1;){if(t.isNullOrUndefined(l))for(i=parseInt(selectedCellPos.split(",")[0])-1;i>=0;i--){if(f=n(u).find("[p='"+i+","+selectedCellPos.split(",")[1]+"']")[0],t.isNullOrUndefined(f))for(k=parseInt(selectedCellPos.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(f)&&(f=n(u).find("[p='"+i+","+k+"']")[0]);!t.isNullOrUndefined(f)&&n(f).css("display")!="none"&&n(n(f).parents("tr")[0]).css("display")!="none"&&(n(f).hasClass("rowheader")||n(f).attr("role")=="rowheader"||n(f).hasClass("colheader")||n(f).attr("role")=="columnheader"||n(f).hasClass("value")||n(f).attr("role")=="gridcell")&&(l=f);set_spn=parseInt(n(f).attr("rowspan"))-parseInt(d);n(f).attr("rowspan",set_spn)}t.isNullOrUndefined(f)||a--}}}}},_hideSubTotal:function(i,u){var k,h,d,nt,g,l,e,p,a,s,v,b,y,c,f;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(k=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.rows:JSON.parse(this.getOlapReport()).PivotRows,d=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns:JSON.parse(this.getOlapReport()).PivotColumns,!t.isNullOrUndefined(k))for(e=0;e<k.length;e++)if(k[e].showSubTotal==!1)if(nt=e.toString(),n(i).attr("role")=="row"&&n(i).parent().is("tbody")){if(n(i).find(".stot,.rstot").length==0||this._isSubTotalhidden&&n(i).find(".stot,.rstot").find(".expand").length>=1||n(i).find(".stot,.rstot").attr("p").split(",")[0]==nt&&u==1&&n(i).find(".stot,.rstot").find(".expand").length>=1)break;else if(n(i).find(".stot,.rstot").attr("p").split(",")[0]==nt){this._isSubTotalhidden=this._isSubTotalHide=!0;break}}else if(n(i).find("tbody").length>0&&(h=i.find('.summary.stot,.rstot[p^="'+e+',"]'),h.length>0))for(g=0;g<h.length;g++){var tt=n(h[g]).closest("tr"),o=n(tt).find(".stot,.rstot").attr("p"),c=parseInt(o.split(",")[0])-1,ut=parseInt(n(tt).find(".stot,.rstot").attr("rowspan"));for(n(tt).css("display","none"),n(i).find(".valueCell td[p$=',"+o.split(",")[1]+"']").css("display","none"),l=parseInt(o.split(",")[1]);c>=0;){for(f=null;t.isNullOrUndefined(f)&&l>=0;){if(f=n(i).find("[p='"+c+","+l+"']")[0],!t.isNullOrUndefined(f)&&n(n(f).closest("tr")[0]).css("display")!="none"&&n(f).hasClass("rowheader")&&n(f).attr("role")=="rowheader"&&parseInt(n(f).attr("p").split(",")[0])<parseInt(o.split(",")[0])&&parseInt(n(f).attr("p").split(",")[1])+f.rowSpan+(n(f).find("span").attr("tag")!=r?parseInt(n(f).find("span").attr("tag")):0)>=parseInt(o.split(",")[1])+ut){f.rowSpan-=1;n(f).find("span").attr("tag",n(f).find("span").attr("tag")!=r?parseInt(n(f).find("span").attr("tag"))+1:1);break}l--}c--}}if(!t.isNullOrUndefined(d))for(e=0;e<d.length;e++)if(d[e].showSubTotal==!1)if(p=e.toString(),(n(i).hasClass("stot")||n(i).hasClass("cstot"))&&n(i).attr("role")=="columnheader"){if(this._isSubTotalhidden&&n(i).find(".stot,.cstot").find(".expand").length>=1||n(i).attr("p").split(",")[1]==p&&u==1&&n(i).find(".expand").length>=1)break;else if(n(i).attr("p").split(",")[1]==p){this._isSubTotalhidden=this._isSubTotalHide=!0;break}}else if(n(i).attr("role")=="row"&&n(i).parent().is("thead")){if(n(i).find(".stot,.cstot").length==0||this._isSubTotalhidden&&n(i).find(".stot,.cstot").find(".expand").length>=1||n(i).find(".stot,.cstot").attr("p").split(",")[1]==p&&u==1&&n(i).find(".stot,.cstot").find(".expand").length>=1)break;else if(n(i).find(".stot,.cstot").attr("p").split(",")[1]==p){this._isSubTotalhidden=this._isSubTotalHide=!0;break}}else if((n(i).find("thead").length>0||n(i).find(".colhead").length>0)&&(h=i.find('.summary.stot,.cstot[p$=",'+e+'"]'),h.length>0))for(a=h,s=0;s<a.length;s++){var ft=n(a[s]),rt=n(i),o=n(a[s]).attr("p"),et=n(a[s]).closest("tr")[0],it=parseInt(o.split(",")[0]),ut=parseInt(n(a[s]).attr("rowspan")),w=parseInt(n(a[s]).attr("colspan")),l=parseInt(o.split(",")[1])-1;for(v=0;v<w;v++){for(b=n(et).nextAll().find("[p^='"+(v+it)+",']"),y=0;y<n(b).length;y++)n(b[y]).css("display","none");(n(b[y]).attr("hc")==r||parseInt(n(b[y]).attr("hc"))<1)&&(n(rt).find("[p^='"+(v+it)+",']").css("display","none"),n(rt).find("[p^='0,']:not(.summary)").parent().find("td[p^='"+(v+it)+",']").attr("ch",1))}for(n(ft).css("display","none"),c=parseInt(o.split(",")[0]);l>=0;){for(f=null;t.isNullOrUndefined(f)&&c>=0;){if(f=n(i).find("[p='"+c+","+l+"']")[0],!t.isNullOrUndefined(f)&&n(n(f).closest("tr")[0]).css("display")!="none"&&n(f).hasClass("colheader")&&n(f).attr("role")=="columnheader"&&parseInt(n(f).attr("p").split(",")[1])<parseInt(o.split(",")[1])&&parseInt(n(f).attr("p").split(",")[0])<=parseInt(o.split(",")[0])&&parseInt(n(f).attr("p").split(",")[0])+f.colSpan+(n(f).find("span").attr("tag")!=r?parseInt(n(f).find("span").attr("tag")):0)>=parseInt(o.split(",")[0])+w){f.colSpan-=w;n(f).find("span").attr("tag",n(f).find("span").attr("tag")!=r?parseInt(n(f).find("span").attr("tag"))+w:w);break}c--}l--}}}},_filterReport:function(n){for(var r,i=0;i<n.Filters.length;i++)if(n.PivotColumns.length>=1)for(r=0;r<n.PivotColumns.length;r++)n.Filters.length==0||t.isNullOrUndefined(n.Filters[i])||n.Filters[i].Tag!=n.PivotColumns[r].FieldName||(n.Filters.splice(i,1),i=-1);for(i=0;i<n.Filters.length;i++)if(n.PivotRows.length>=1)for(r=0;r<n.PivotRows.length;r++)n.Filters.length==0||t.isNullOrUndefined(n.Filters[i])||n.Filters[i].Tag!=n.PivotRows[r].FieldName||(n.Filters.splice(i,1),i=-1);for(i=0;i<n.Filters.length;i++)if(n.PivotCalculations.length>=1)for(r=0;r<n.PivotCalculations.length;r++)n.Filters.length==0||t.isNullOrUndefined(n.Filters[i])||n.Filters[i].Tag!=n.PivotCalculations[r].FieldName||(n.Filters.splice(i,1),i=-1);return n},_createGroupingBar:function(n){this._pivotFilter=this._getLocalizedLabels("DragFieldHere");this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(n=this._filterReport(n),filterTag=this._createPivotButtons(this._pivotFilter!=null&&n.Filters.length>1&&n.Filters[0].Tag==n.Filters[1].Tag?n.Filters.slice(1):n.Filters,"filter")):filterTag=this._createPivotButtons(this._pivotFilter!=null&&n.filters.length>0?n.filters:"","filter");this._pivotFilter=filterTag;this._pivotRow=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.PivotRows:n.rows,"row");this._pivotColumn=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.PivotColumns:n.columns,"column");this._pivotCalculation=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.PivotCalculations:n.values,"values");this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&n.values.length>0&&n.values[0].measures&&(n.values[0].axis=="columns"&&n.values[0].measures.length>0?this._pivotColumn=this._pivotColumn+this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.PivotColumns:[{fieldName:"Measures",fieldCaption:this._getLocalizedLabels("Measures")}],"column"):n.values[0].axis=="rows"&&n.values[0].measures.length>0&&(this._pivotRow=this._pivotRow+this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.PivotColumns:[{fieldName:"Measures",fieldCaption:this._getLocalizedLabels("Measures")}],"row")))},_contextOpen:function(n){t.Pivot._contextMenuOpen(n,this)},_pivotContextClick:function(i){var e,o;if(i.text!=this._getLocalizedLabels("CalculatedField"))if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var r=i.text==this._getLocalizedLabels("AddToColumn")?"column":i.text==this._getLocalizedLabels("AddToRow")?"row":i.text==this._getLocalizedLabels("AddToValues")?"value":i.text==this._getLocalizedLabels("AddToFilter")?"filter":"",u=n(this._selectedMember).attr("fieldName"),s=n(this._selectedMember).text(),f={droppedFieldName:u,droppedFieldCaption:s,droppedClass:r,droppedPosition:"",isMeasuresDropped:u.toLocaleLowerCase().indexOf("measures")==0};this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&r!="values"&&(this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1||n.isCalculatedField==!0&&n.formula.indexOf(f.droppedFieldName)==-1}));t.Pivot.addReportItem(this.model.dataSource,f);this.refreshControl();t.isNullOrUndefined(this._schemaData)||this._schemaData.refreshControl()}else e=i.text==this._getLocalizedLabels("AddToColumn")?this.element.find(".columns"):i.text==this._getLocalizedLabels("AddToRow")?this.element.find(".grpRow"):i.text==this._getLocalizedLabels("AddToValues")?this.element.find(".values"):i.text==this._getLocalizedLabels("AddToFilter")?this.element.find(".drag"):"",o={element:this._selectedMember,target:e,cancel:!1},this._pvtBtnDropped(o);else this._createCalculatedField()},_createPivotButtons:function(i,u){var s=this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?!0:!1,c,o,v,f,a,y,e,p,w;if(!t.isNullOrUndefined(i)){if(c="",o=u=="column"?"Columns":u=="row"?"Rows":u=="filter"?"Slicers":"Values",this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)for(o=u=="column"?"Columns":u=="row"?"Rows":u=="filter"?"filters":"values",o=="values"&&s&&(i=n.map(i,function(n){return n.measures})),f=0;f<i.length;f++){var b=s?"":t.PivotAnalysis.getMembers(i[f].fieldName),h=s?i[f].filterItems!=null&&i[f].filterItems.values.length>0||!t.isNullOrUndefined(i[f].advancedFilter)&&i[f].advancedFilter.length>0?"filtered":"":i[f].filterItems!=null&&(i[f].filterItems.values.indexOf("All")>=0?i[f].filterItems.values.length-1:i[f].filterItems.values.length)<b.length?"filtered":"",l=s?"":i[f].sortOrder==t.PivotAnalysis.SortOrder.Descending?"descending":"";c+=t.buildTag("span.pivotButton",t.buildTag("button.pvtBtn#pivotButton_"+i[f].fieldName||i[f],i[f].fieldCaption==r?i[f].fieldName:i[f].fieldCaption||i[f],{},{fieldName:i[f].fieldName,axis:o})[0].outerHTML+(s&&(i[f].fieldName.toLowerCase()=="measures"||!t.isNullOrUndefined(i[f].isNamedSet)&&!i[f].isNamedSet)?"":t.buildTag("span.filter e-icon "+h).attr("role","button").attr("aria-label","filter")[0].outerHTML)+(s?" ":t.buildTag("span.sorting e-icon "+l).attr("role","button").attr("aria-label","sort").attr("aria-expanded","false")[0].outerHTML)+t.buildTag("span.removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("tag",o+":"+i[f].fieldName||i[f])[0].outerHTML}else for(o=="Values"&&u=="values"&&(v=this.element.find(".pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").length>0?this.element.find(".pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").parent()[0].className.split(" ")[0]:"schemaColumn",this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(o=v=="schemaColumn"||v=="columns"?"Columns":"Rows")),f=0;f<i.length;f++){for(a=this._ascdes.split("##"),y=0,l="",h="",e=0;e<a.length;e++)(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&a[e]==i[f].Tag||this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&a[e]==i[f])&&(y=1);if(y==1&&(l="descending"),!t.isNullOrUndefined(this._tempFilterData))for(e=0;e<this._tempFilterData.length;e++)for(p in this._tempFilterData[e])this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?p==(i[f].FieldName||i[f].DimensionName)&&this._tempFilterData[e][i[f].FieldName||i[f].DimensionName]!=""&&(h="filtered"):this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&p==(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?i[f].Tag:i[f])&&this._tempFilterData[e][i[f].Tag].indexOf("FILTERED")!=0&&(h="filtered");this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(i[f].FieldHeader=i[f].FieldHeader=="Measures"?this._getLocalizedLabels("Measures"):i[f].FieldHeader,w=i[f].FieldHeader=="Measures"||i[f].Tag=="Measures"?"":t.buildTag("span.filter e-icon "+h).attr("role","button").attr("aria-label","filter")[0].outerHTML,c+=t.buildTag("span.pivotButton",t.buildTag("span.dropIndicator")[0].outerHTML+t.buildTag("button.pvtBtn#pivotButton"+i[f].FieldHeader||i[f].FieldName||i[f].Name||i[f].DimensionHeader||i[f].DimensionName,i[f].FieldHeader||i[f].FieldName||i[f].Name||i[f].DimensionHeader||i[f].DimensionName,{},this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?{fieldname:i[f].FieldName||i[f].DimensionName||i[f].FieldHeader||i[f].DimensionHeader}:{})[0].outerHTML+w+t.buildTag("span.sorting e-icon "+l).attr("role","button").attr("aria-label","sort")[0].outerHTML+t.buildTag("span.removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("tag",o+":"+i[f].Tag)[0].outerHTML):c+=t.buildTag("span.pivotButton",t.buildTag("span.dropIndicator")[0].outerHTML+t.buildTag("button.pvtBtn#pivotButton"+i[f],i[f])[0].outerHTML+t.buildTag("span.filter e-icon "+h).attr("role","button").attr("aria-label","filter")[0].outerHTML+t.buildTag("span.sorting e-icon "+l).attr("role","button").attr("aria-label","sort").attr("aria-expanded","false")[0].outerHTML+t.buildTag("span.removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("tag",o+":"+i[f])[0].outerHTML}return c}},_createFields:function(){var l,e,a,u,v,h,c,o,i,s,f,r,y,p;if(this.element.find(".groupingBarPivot").remove(),this.element.prepend(t.buildTag("div#groupingBarPivot.groupingBarPivot")[0].outerHTML),this.element.find(".groupingBarPivot").prepend(t.buildTag("div.valueColumn",t.buildTag("span.values",t.buildTag("span#grpvalue","values",{display:"none"})[0].outerHTML).attr("aria-describedby","grpvalue")[0].outerHTML+t.buildTag("span.columns",t.buildTag("span#grpcol","column",{display:"none"})[0].outerHTML).attr("aria-describedby","grpcol")[0].outerHTML,{width:"100%"})),this.element.find(".groupingBarPivot").prepend(t.buildTag("div.drag",t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+t.buildTag("span#grpdrag","filter",{display:"none"})[0].outerHTML+this._getLocalizedLabels("DragFieldHere"),{width:"100%"})[0].outerHTML).attr("aria-describedby","grpdrag"),this._pivotFilter!=""&&this._pivotFilter!=null&&this.element.find(".drag").text("").append("<span id='grpdrag' style='display:none'>filter<\/span>"),this.element.find(".drag").append(this._pivotFilter),this.element.find(".values").append(this._pivotCalculation),this.element.find(".columns").append(this._pivotColumn),this.element.find(".values .pivotButton").length==0&&this.element.find(".values").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("ValueArea")),this.element.find(".columns .pivotButton").length==0&&this.element.find(".columns").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("ColumnArea")),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.element.find(".rows").length==0&&!t.isNullOrUndefined(this.getJSONRecords())&&this.getJSONRecords().length>0&&this.getJSONRecords()[0].CSS=="colheader"?(this.element.find(".pivotGridTable thead tr:first").prepend(t.buildTag("th.grpRow",t.buildTag("div.rows",t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("RowArea"))[0].outerHTML,{},{rowspan:this.element.find("thead tr").length})[0].outerHTML),this.element.find(".pivotGridTable tbody tr:first").prepend(t.buildTag("td.rowheader","Total")[0].outerHTML)):this.element.find(".rows .pivotButton").length==0&&(this.element.find(".rows").text("").children("span").remove(),this.element.find(".rows").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("RowArea"))),(this.element.find(".rowheader").length==0&&this.element.find(".colheader").length==0&&this.element.find(".values .pivotButton").length==0||this.element.find(".pivotGridTable th").length==0)&&(l=t.buildTag("div.emptyRows",t.buildTag("span.rows",this._pivotRow!=""?this._pivotRow:this._getLocalizedLabels("RowArea"),{width:"5px"})[0].outerHTML,{width:140})[0].outerHTML,this.element.find(".rows").length==0?this.element.find(".groupingBarPivot").append(l):"",this.model.enableDeferUpdate&&this._pivotRow!=""&&(this.element.find(".rows").text(""),this.element.find(".rows").append(this._pivotRow)),this.element.find(".emptyRows,.rows").ejDroppable({})),this.element.find(".values").find(".filter").remove(),this.element.find(".values").find(".sorting").remove(),this.element.find(".drag").find(".sorting").remove(),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.element.find(".pivotButton").find(".sorting").remove(),this.element.find(".pivotButton .pvtBtn").ejButton({size:"normal",type:t.ButtonType.Button}).ejDraggable({handle:"button",clone:!0,cursorAt:{left:-5,top:-5},dragStart:t.proxy(function(){this._isDragging=!0},this),dragStop:t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this._clientPvtBtnDropped:this._pvtBtnDropped,this),helper:t.proxy(function(t){return n(t.element).parent().addClass("dragHover"),n(t.element).addClass("dragHover"),t.sender.target.className.indexOf("e-btn")>-1?n(t.sender.target).clone().addClass("dragClone").appendTo(this.element):!1},this)}),this.element.find(".drag, .values, .columns, .grpRow, .rows").ejDroppable({}),this.element.find(".pivotGridTable").find("thead th:eq(1)").length>0)this.element.find(".groupingBarPivot").width(this.element.find(".pivotGridTable").width());else if(this.element.find(".pivotGridTable").find("thead").length>0)this.model.isResponsive||this.element.find(".groupingBarPivot").width(this.element.find(".rows").width()+150);else if(this.element.find(".columns .pivotButton").length==0||this.element.find(".values .pivotButton").length==0&&this.element.find(".columns .pivotButton").length==1)this.element.find(".groupingBarPivot").width(300);else{for(e=0,r=0;r<n(this.element.find(".columns .pivotButton")).length;r++)e=Math.max(n(this.element.find(".columns .pivotButton")[r]).width(),e);a=e*n(this.element.find(".columns .pivotButton")).length+this.element.find(".values").width();this.element.find(".groupingBarPivot").width(a)}for((this.element.find(".rows").width()>140||this.model.enableDeferUpdate&&this.element.find(".rows").width()<this.element.find(".grpRow").width()&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)&&(this.enableDeferUpdate?this.element.find(".rows").width(this.element.find(".colheader").length==0?this.element.find(".grpRow").width()-140:this.element.find(".grpRow").width()):this.model.isResponsive||this.element.find(".rows").width(this.model.enableDeferUpdate?this.element.find(".grpRow").width()-8:this.element.find(".grpRow").width())),(this.element.find(".pivotGridTable thead").length>0||this.model.enableDeferUpdate&&this.element.find(".pivotGridTable thead").length==0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this.model.isResponsive&&this.element.find(".values .pivotButton").length==0&&this.element.find(".columns .pivotButton").length==0?this.element.find(".values").width(140):this.element.find(".values").width(this.element.find(".grpRow").length>0?this.model.enableDeferUpdate&&this.element.find(".colheader").length==0?this.element.find(".grpRow").width():this.element.find(".grpRow").width()+4:140),this.model.enableDeferUpdate&&this.element.find(".colheader").length==0&&this.element.find(".pivotGridTable .rowheader").length!=0&&(f=this.element.find(".groupingBarPivot").width()-this.element.find(".values").width(),f<140&&this.element.find(".groupingBarPivot").width(this.element.find(".groupingBarPivot").width()+140)),this.element.find(".pivotGridTable").find("thead th:eq(1)").length>0||this.model.enableDeferUpdate&&this.element.find(".columns .pivotButton").length==0||this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?(u=this.element.find(".pivotGridTable").width()-this.element.find(".values").width()-4,this.element.find(".pivotGridTable").find("thead th:eq(2)").length==0?(this.element.find(".columns").css("min-width",u>=30&&this.element.find(".pivotGridTable .colheader").length==0?140:u),(this.element.find(".columns .pivotButton").length==0||this.model.enableDeferUpdate&&this.element.find(".pivotGridTable .colheader").length==0)&&(this.element.find(".columns .pivotButton").length==0&&(u=this.element.find(".groupingBarPivot").width()-this.element.find(".values").width()-5,this.element.find(".columns").width(u),u<140&&(n(".groupingBarPivot .values .pivotButton").length==1||n(".groupingBarPivot .values .pivotButton").length==0&&this.model.enableDeferUpdate)&&this.element.find(".columns").css("min-width",u+"px")),this.element.find(".columns").addClass("widthSetter"))):u<140?this.element.find(".columns").css("min-width",u).addClass("widthSetter"):this.element.find(".columns").width(u)):this.element.find(".pivotGridTable").find("thead th:eq(1)").length!=0||this.model.enableDeferUpdate||(v=this.element.find(".columns .pivotButton").length<1?1:this.element.find(".columns .pivotButton").length,this.element.find(".columns").addClass("widthSetter"),this.element.find(".columns").css("min-width",(this.element.find(".groupingBarPivot").width()-this.element.find(".values").width()-7)/v))),this.model.dataSource.data!=null&&this.model.url==""&&(h=0,n(".columns .pivotButton").each(function(){h+=parseInt(n(this).width()+10)}),n(".valueColumn").height()>30&&this.element.find(".values button").length==0&&this.element.find(".columns").width()<h&&(c=this.element.find(".columns .pivotButton").length,i=(this.element.find(".valueColumn").width()-this.element.find(".values").width())/(c==0?1:c)-70,this.element.find(".columns .pvtBtn").width(i).css({"text-overflow":"ellipsis"}))),this.element.find(".columns").height()>30?(i=this.model.isResponsive?this.element.find(".columns").width()/this.element.find(".columns .pivotButton").length-5:this.element.find(".columns").width()/2-60,this.element.find(".columns .pvtBtn").width(i).css({"text-overflow":"ellipsis"})):this.element.find(".columns .pivotButton").width()>this.element.find(".columns").width()&&(i=this.element.find(".columns").width()-60,this.element.find(".columns .pvtBtn").width(i).css({"text-overflow":"ellipsis"})),this.element.find(".drag").height()>30&&(i=this.element.find(".groupingBarPivot").width()/4-35,this.element.find(".drag .pvtBtn").width(i).css({"text-overflow":"ellipsis"})),this.element.find(".values").height()>30?(i=this.model.isResponsive?this.element.find(".values").width()/this.element.find(".values .pivotButton").length-5:this.element.find(".values").width()/2-40,this.element.find(".values .pvtBtn").width(i).css({"text-overflow":"ellipsis"})):(this.element.find(".values .pivotButton").width()>this.element.find(".values").width()||this.element.find(".pivotGridTable").find("thead th:eq(1)").length==0&&this.element.find(".values .pivotButton").length>0)&&(i=this.element.find(".values").width()-40,this.element.find(".values .pvtBtn").width(i).css({"text-overflow":"ellipsis"})),o=0,r=0;r<this.element.find(".rows .pivotButton").length;r++)o=o+this.element.find(".rows .pivotButton:eq("+r+")").width();if(o>this.element.find(".rows").width()&&(i=this.element.find(".rows").width()/2-40,this.element.find(".rows .pvtBtn").width(i).css({"text-overflow":"ellipsis"})),this.model.enableDeferUpdate&&this.element.find(".columns .pivotButton").length!=0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){for(s=0,f=0,r=0;this.element.find(".columns .pivotButton").length>r;r++)s=this.element.find(".columns .pivotButton:eq("+r+")").width()+s+7;if(this.element.find(".pivotGridTable .colheader,.pivotGridTable tr:eq(0) .summary").each(function(){f=f+n(this).width()}),s>=f){var w=this.element.find(".pivotGridTable .colheader").length>0?1:0,u=w==0?140:f,i=u/(this.model.enableDeferUpdate?this.element.find(".columns .pivotButton").length:3)-15;this.model.enableDeferUpdate?this.element.find(".columns .pvtBtn").width(30).css({"text-overflow":"ellipsis"}):this.element.find(".columns .pvtBtn").width(i).css({"text-overflow":"ellipsis"})}}(this.element.find(".values").height()>this.element.find(".columns").height()||this.element.find(".columns").height()>this.element.find(".values").height())&&(this.element.find(".values").height()>this.element.find(".columns").height()?this.element.find(".columns").height(this.element.find(".values").height()):this.element.find(".values").height(this.element.find(".columns").height()));this.element.find(".colheader, .rowheader, .value").addClass("e-droppable");this.element.find(".summary").removeClass("e-droppable");this.model.enableGroupingBar&&(y=this.element.find(".pvtBtn"),p=t.buildTag("ul.pivotTree#pivotTree",(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?t.buildTag("li.calculatedFieldMenuItem",t.buildTag("a.menuItem",this._getLocalizedLabels("CalculatedField"))[0].outerHTML)[0].outerHTML:" ")+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToFilter"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToRow"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToColumn"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToValues"))[0].outerHTML)[0].outerHTML)[0].outerHTML,n(this.element).append(p),n("#pivotTree").ejMenu({menuType:t.MenuType.ContextMenu,openOnClick:!1,contextMenuTarget:y,click:t.proxy(this._pivotContextClick,this),beforeOpen:t.proxy(this._contextOpen,this),close:t.proxy(this._preventPanelClose,this)}))},_clientPvtBtnDropped:function(i){var e,f;this._isDragging=!1;i.element.removeClass("dragHover").css("background-color","inherit");i.element.parent().removeClass("dragHover");this.element.find(".dragClone").remove();this.element.find(".dropIndicator").removeClass("dropIndicatorHover");this.element.find(".dragClone,.dropIndicator").remove();var r=n(i.target).hasClass("columns")||n(i.target).parents(".columns").length>0?"column":n(i.target).hasClass("grpRow")||n(i.target).parents(".grpRow").length>0||n(i.target).hasClass("rows")?"row":n(i.target).hasClass("values")||n(i.target).parents(".values").length>0?"value":n(i.target).hasClass("drag")||n(i.target).parents(".drag").length>0?"filter":"",o=i.element.text(),u=n(i.element).attr("fieldName");if(r!=""&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(u.toLowerCase().indexOf("[measures]")>=0&&r!="value"||u==this._getLocalizedLabels("Measures")&&r!="row"&&r!="column"||u.toLowerCase().indexOf("[measures]")<0&&r=="value")){t.Pivot._createErrorDialog(this._getLocalizedLabels("GroupingBarAlertMsg"),this._getLocalizedLabels("Warning"),this);return}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&r!="values"&&n.grep(this._calculatedField,function(n){return n.name==u}).length>0){t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this);this.element.find(".dragClone,.dropIndicator").remove();return}e=r==""?"":this._setSplitBtnTargetPos(i.event,r,"drop");f={droppedFieldName:u,droppedFieldCaption:o,droppedClass:r,droppedPosition:e,isMeasuresDropped:u.toLocaleLowerCase().indexOf("measures")==0};this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&r!="values"?this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1||n.isCalculatedField==!0&&n.formula.indexOf(f.droppedFieldName)==-1}):this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this));t.Pivot.addReportItem(this.model.dataSource,f);this.refreshControl();t.isNullOrUndefined(this._schemaData)||this._schemaData.refreshControl()},_pvtBtnDropped:function(i){var p,o,r,a,v,w,y,b;for(n(i.element).parent().removeClass("dragHover"),n(i.element).removeClass("dragHover"),this._isUpdateRequired=!0,p=n(i.target).parents(),o=0;o<p.length;o++)if(p[o].className.split(" ")[0]=="e-pivotschemadesigner"){this.element.find(".dragClone").remove();return}this._isDragging=!1;this.element.find(".dropIndicator").removeClass("dropIndicatorHover");var h=null,s="",e="",f,c=!1,l=!1;if(droppedClass=t.isNullOrUndefined(i.target.className)?n(i.target).hasClass("columns")?"columns":n(i.target).hasClass("grpRow")?"rows":n(i.target).hasClass("values")?"values":n(i.target).hasClass("drag")?"drag":"":i.target.className.indexOf("e-droppable")>=0?i.target.className.split(" ")[0]:"",droppedClass=droppedClass=="grpRow"?"rows":droppedClass,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(n(i.target).hasClass("pvtBtn")&&this.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&(droppedClass=n(i.target).attr("axis").toLowerCase()),f=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?i.element.attr("fieldName"):i.element.text(),c=i.element.find("~ .filterIndicator").length>0?!0:!1,l=i.element.find("~ span:eq(0) span.descending").length>0?!0:!1,droppedClass==""&&(i.target.tagName=="BUTTON"||i.target.tagName=="SPAN")&&(droppedClass=i.target.parentNode.parentElement.className.split(" ")[0]),o=0;o<this._pivotTableFields.length;o++)this._pivotTableFields[o].name==f&&(this._pivotTableFields[o].isSelected=!0,e=this._pivotTableFields[o]);else t.isNullOrUndefined(i.target.className)?(h=n(i.target),s=n(i.target).hasClass("columns")?"Categorical":n(i.target).hasClass("grpRow")?"Series":n(i.target).hasClass("drag")?"Slicer":"",droppedClass=n(i.target).hasClass("columns")?"columns":n(i.target).hasClass("grpRow")?"rows":n(i.target).hasClass("values")?"values":n(i.target).hasClass("drag")?"drag":""):(h=i.target.className.indexOf("pvtBtn")>-1?n(i.target).parents(".e-droppable")[0]:i.target.className.indexOf("e-droppable")?i.target:i.target[0].tagName.toLowerCase()=="td"?i.target.children(":last")[0]:i.target,s=h.className.split(" ")[0]=="columns"?"Categorical":h.className.split(" ")[0]=="rows"||h.className.split(" ")[0]=="grpRow"?"Series":h.className.split(" ")[0]=="filters"?"Slicer":"",droppedClass=h.className.split(" ")[0]),s==""&&i.element.parent().attr("tag").indexOf("[Measures]")>-1&&(s=this.element.find(".schemaRow .pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").length>0?"Series":"Categorical"),e=n(i.element.parent()[0]).attr("tag"),droppedClass=droppedClass=="grpRow"?"rows":droppedClass,s=s=="grpRow"?"Series":s,f=i.element.text();if(this.element.find(".dragClone").remove(),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(e.split(":")[1].toLocaleUpperCase()=="MEASURES"&&(droppedClass!="columns"||droppedClass!="rows")&&(droppedClass=="drag"||droppedClass=="values")||e.toUpperCase().indexOf("[MEASURES]")>-1&&droppedClass!="values"&&(droppedClass=="rows"||droppedClass=="columns"||droppedClass=="drag")||e.toUpperCase().indexOf("[MEASURES]")==-1&&droppedClass=="values"))return t.Pivot._createErrorDialog(this._getLocalizedLabels("GroupingBarAlertMsg"),this._getLocalizedLabels("Error"),this),this.element.find(".dragClone,.dropIndicator").remove(),i.element.parent().removeAttr("style"),i.element.css("background-color","inherit"),!1;if(droppedClass=="rows"||droppedClass=="columns"||droppedClass=="values"||droppedClass=="drag"){if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&droppedClass!="values"&&(n.grep(this._calculatedField,function(n){return n.name==f}).length>0||n.grep(JSON.parse(this.getOlapReport()).PivotCalculations,function(n){return n.FieldHeader==f&&n.CalculationType==8}).length>0)){t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this);i.element.parent().removeAttr("style");i.element.css("background-color","inherit");return}r=this._setSplitBtnTargetPos(i,droppedClass,"drop");a=this._setSplitBtnTargetPos(i,droppedClass,"original");droppedClass=="drag"&&this.element.find(".drag").text("").append("<span id='grpdrag' style='display:none'>filter<\/span>");try{report=JSON.parse(this.getOlapReport()).Report}catch(d){report=this.getOlapReport()}if(n(i.element.parent()).remove(),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)v=i.element.parents(".pivotButton").attr("tag").split(":")[0],this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),n.isNumeric(r)&&droppedClass==v.toLowerCase()&&r>a&&(r=r-1),this._schemaData!=null&&(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(this._schemaData.element.find("#pivotButton"+f).parent().parent().remove(),this._schemaData._createPivotButton(f,droppedClass=="rows"?"row":droppedClass=="columns"?"column":droppedClass=="drag"?"filter":droppedClass=="values"?"value":"",c,l,r)):(w=this._schemaData.element.find("div[tag ^='"+e+"']:first").text(),this._schemaData.element.find("div[tag ^='"+e+"']:first").remove(),this._schemaData._createPivotButton({fieldName:e.split(":")[1],fieldCaption:w},droppedClass=="rows"?"row":droppedClass=="columns"?"column":droppedClass=="drag"?"filter":droppedClass=="values"?"value":"",c,l,r))),droppedClass=droppedClass=="rows"?"schemaRow":droppedClass=="columns"?"schemaColumn":droppedClass=="drag"?"schemaFilter":droppedClass=="values"?"schemaValue":"",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(params=JSON.parse(this._olapReport).CurrentCube+"--"+e+"--"+s+"--"+r,this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),y=JSON.stringify(this.model.customObject),eventArgs=JSON.stringify({action:"nodeDropped",dropType:"SplitButton",nodeInfo:params,currentReport:report,gridLayout:this.model.layout,customObject:y}),this.model.enableDeferUpdate?(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide(),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,eventArgs.replace("nodeDropped","nodeDroppedDeferUpdate"),this._pvtBtnDroppedSuccess)):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,eventArgs,this._pvtBtnDroppedSuccess)):(this._calculatedField.length>0&&droppedClass!="schemaValue"&&this._schemaData!=null&&this._calculatedFieldNodeRemove(e),this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),y=JSON.stringify(this.model.customObject),b=t.Pivot._getFilterParams(droppedClass,this._tempFilterData,f),eventArgs=JSON.stringify({action:"nodeDropped",dropAxis:droppedClass+"::"+r,headerTag:JSON.stringify(e),sortedHeaders:this._ascdes,filterParams:b,currentReport:report,customObject:y}),successMethod=this._renderControlSuccess,this.model.enableDeferUpdate?(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide(),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,eventArgs.replace("nodeDropped","nodeDroppedDeferUpdate"),this._pvtBtnDroppedSuccess)):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,eventArgs,this._pvtBtnDroppedSuccess));else{if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&droppedClass!="values"&&n.grep(this._calculatedField,function(n){return n.name==f}).length>0){t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this);this.model.editCellsInfo={};this._populatePivotGrid();return}var u=this._getDroppedItem(f),k={fieldName:u[0].fieldName,fieldCaption:u[0].fieldCaption},v=i.element.parents(".pivotButton").attr("tag").split(":")[0];this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&u.length>0&&droppedClass=="drag"&&(u[0].advancedFilter=[]);n.isNumeric(r)?droppedClass==v.toLowerCase()&&r>a?droppedClass=="rows"?this.model.dataSource.rows.splice(r-1,0,u[0]):droppedClass=="columns"?this.model.dataSource.columns.splice(r-1,0,u[0]):droppedClass=="values"?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.splice(r-1,0,u[0]):this.model.dataSource.values.splice(r,0,u[0]):this.model.dataSource.filters.splice(r,0,u[0]):droppedClass=="rows"?this.model.dataSource.rows.splice(r,0,u[0]):droppedClass=="columns"?this.model.dataSource.columns.splice(r,0,u[0]):droppedClass=="values"?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.splice(r,0,u[0]):this.model.dataSource.values.splice(r,0,u[0]):this.model.dataSource.filters.splice(r,0,u[0]):droppedClass=="rows"?this.model.dataSource.rows.push(u[0]):droppedClass=="columns"?this.model.dataSource.columns.push(u[0]):droppedClass=="values"?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.push(u[0]):this.model.dataSource.values.push(u[0]):this.model.dataSource.filters.push(u[0]);this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&droppedClass!="values"&&(this._schemaData!=null&&this._calcFieldNodeDrop(u[0]),this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1||n.isCalculatedField==!0&&n.formula.indexOf(u[0].fieldName)==-1}));this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this));this._schemaData!=null&&(droppedClass==v&&r>a&&(r=r-1),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._schemaData.element.find("button[fieldName='"+f+"']").remove():this._schemaData.element.find("#pivotButton"+f).parent().remove(),this._schemaData._createPivotButton(k,droppedClass=="rows"?"row":droppedClass=="columns"?"column":droppedClass=="drag"?"filter":droppedClass=="values"?"value":"",c,l,r));this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.getJSONData({action:"pvtBtnDropped"},this.model.dataSource,this)):(this.model.editCellsInfo={},this._populatePivotGrid())}}else this._removePvtBtn(i);t.isNullOrUndefined(this._schemaData)||this._schemaData._setPivotBtnWidth()},_getDroppedItem1:function(i){var f=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?!0:!1,r=n.grep(this.model.dataSource.columns,function(n){return n.fieldName==i}),u;return r.length>0?this.model.dataSource.columns=n.grep(this.model.dataSource.columns,function(n){return n.fieldName!=i}):(r=n.grep(this.model.dataSource.rows,function(n){return n.fieldName==i}),r.length>0?this.model.dataSource.rows=n.grep(this.model.dataSource.rows,function(n){return n.fieldName!=i}):(u=this.model.dataSource.values,this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(u=this.model.dataSource.values[0].measures),r=n.grep(u,function(n){return n.fieldName==i}),r.length>0?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures=n.grep(u,function(n){return n.fieldName!=i}):this.model.dataSource.values=n.grep(u,function(n){return n.fieldName!=i}):(r=n.grep(this.model.dataSource.filters,function(n){return n.fieldName==i}),r.length>0&&(this.model.dataSource.filters=n.grep(this.model.dataSource.filters,function(n){return n.fieldName!=i}))))),r},_clearCollapsedItems:function(t,i,u){return t=="rowheader"?u.rows=n.map(u.rows,function(t){return t.drilledItems!=r&&t.drilledItems.length&&(t.drilledItems=n.map(t.drilledItems,function(n){if(n.join("").indexOf(i.repItms.replace(/&/g,"&amp;"))<0)return[n]})),t}):t=="colheader"&&(u.columns=n.map(u.columns,function(t){return t.drilledItems!=r&&t.drilledItems.length&&(t.drilledItems=n.map(t.drilledItems,function(n){if(n.join("").indexOf(i.repItms.replace(/&/g,"&amp;"))<0)return[n]})),t})),u},_setSplitBtnTargetPos:function(t,i,r){var e="",f,o,u;for(o=r=="drop"?n(t.target).parents(".pivotButton"):n(t.element).parents(".pivotButton"),i=i=="column"?"columns":i=="row"?"rows":i=="filter"?"drag":i=="value"?"values":i,f=this.element.find("."+i).children(".pivotButton"),u=0;u<f.length;u++)n(f[u]).attr("tag")==n(o).attr("tag")&&(e=u);return e},_pvtBtnDroppedSuccess:function(n){!t.isNullOrUndefined(n[0])&&n.length>0?n[2]!=null&&n[2]!=r&&(this.model.customObject=n[2].Value):!t.isNullOrUndefined(n.d)&&n.d.length>0?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):t.isNullOrUndefined(n)||t.isNullOrUndefined(n.OlapReport)||n!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject});this.model.enableDeferUpdate?this._deferUpdateSuccess(n):this._renderControlSuccess(n)},_deferUpdateSuccess:function(i){t.isNullOrUndefined(i.PivotReport)&&t.isNullOrUndefined(i.OlapReport)?(this.setOlapReport(i.d[0].Value),n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&this.model.pivotControl._pagerObj.initPagerProperties(JSON.parse(i.d[2].Value),JSON.parse(i.d[1].Value))):(t.isNullOrUndefined(i.PivotReport)?this.setOlapReport(i.OlapReport):this.setOlapReport(i.PivotReport),i.HeaderCounts!=r&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&this.model.pivotControl._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings)));this.model.enableGroupingBar&&(report=JSON.parse(this.getOlapReport()),this._pivotTableFields=JSON.parse(report.ItemsProperties),this._createGroupingBar(report),this.element.find(".grpRow .rows").text(""),this.element.find(".grpRow .rows").children().remove(),this.element.find(".grpRow .rows").append(this._pivotRow),this._createFields(null,n("#"+this._id).find(".pivotGridTable").width(),n("#"+this._id).find(".pivotGridTable th").outerWidth()));this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._schemaData!=null&&this._schemaButtonCreate();this._waitingPopup&&this._waitingPopup.hide()},_clientRemovePvtBtn:function(i){t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();var r=n(n(i.target).siblings()[0]).attr("fieldName");this._calculatedField.length>0&&n.grep(this.model.dataSource.values,function(n){return n.fieldName==r}).length>0?this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return(n.isCalculatedField==null||n.isCalculatedField==!1||n.formula.indexOf(r)==-1)&&n.fieldName!=r}):t.Pivot.removeReportItem(this.model.dataSource,r,r.toLocaleLowerCase().indexOf("measures")==0);this.refreshControl();t.isNullOrUndefined(this._schemaData)||this._schemaData.refreshControl()},_removePvtBtn:function(i){var a,h,f,u,s,r,v,o,l,c;if(this._isUpdateRequired=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){if(i.type=="click"){var f=n(n(i.target).siblings()[0]).attr("fieldName"),e="",s="";a=n(n(i.target).siblings()[0]).text()}else{var f=i.element.attr("fieldName"),e="",s="";a=i.element.text()}for(r=0;r<this.element.find(".pivotButton").length;r++)s=n(this.element.find(".pivotButton")[r]).find("button").attr("fieldName"),s==f&&(e=n(this.element.find(".pivotButton")[r]));if(n(e).remove(),this._schemaData!=null){if(l=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._schemaData._tableTreeObj.element.find("li [tag='"+f+"']"):this._schemaData._tableTreeObj.element.find("li[id='"+f+"']"),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.length==0&&f.toLowerCase()=="measures"){for(this._schemaData.element.find("div[tag='"+e.attr("tag")+"']").remove(),r=0;r<this.model.dataSource.values[0].measures.length;r++)this._schemaData._nodeCheck=!0,selectedTreeNode=this._schemaData._tableTreeObj.element.find("li[tag='"+this.model.dataSource.values[0].measures[r].fieldName+"']"),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode),this.element.find("div[tag='values:"+this.model.dataSource.values[0].measures[r].fieldName+"']").remove(),this._schemaData.element.find("div[tag='values:"+this.model.dataSource.values[0].measures[r].fieldName+"']").remove();this.model.dataSource.values[0].measures=[];t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();this.getJSONData({action:"removeBtn"},this.model.dataSource,this)}this._schemaData._tableTreeObj.uncheckNode(l)}else this.model.dataSource.columns=n.grep(this.model.dataSource.columns,function(n){return n.fieldName!=f}),this.model.dataSource.rows=n.grep(this.model.dataSource.rows,function(n){return n.fieldName!=f}),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?e.attr("tag").split(":")[1].toLowerCase()=="measures"?this.model.dataSource.values[0].measures=[]:this._getItemPosition(this.model.dataSource.values[0].measures,e.attr("tag").split(":")[1]).length>0&&this.model.dataSource.values[0].measures.splice(this._getItemPosition(this.model.dataSource.values[0].measures,e.attr("tag").split(":")[1])[0],1):this.model.dataSource.values=this._calculatedField.length>0?n.grep(this.model.dataSource.values,function(n){return(n.isCalculatedField==null||n.isCalculatedField==!1||n.formula.indexOf(f)==-1)&&n.fieldName!=f}):n.grep(this.model.dataSource.values,function(n){return n.fieldName!=f}),this.model.dataSource.filters=n.grep(this.model.dataSource.filters,function(n){return n.fieldName!=f}),this.model.analysisMode!=t.Pivot.AnalysisMode.Olap&&this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode?(this.model.editCellsInfo={},this._populatePivotGrid()):(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"removeButton"},this),this.getJSONData({action:"removeButton"},this.model.dataSource,this))}else{for(i.type=="click"?f=n(n(i.target).siblings()[1]).text():(f=i.element.text(),u=i.element.parent().attr("tag")),filterTag="",filterItems="",e="",u="",s="",h="",e=this.element.find(".pivotButton:contains("+f+")"),r=0;r<this._pivotTableFields.length;r++)this._pivotTableFields[r].name==f&&(this._pivotTableFields[r].isSelected=!1,u=this._pivotTableFields[r]);try{h=JSON.parse(this.getOlapReport()).Report}catch(y){h=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)if(u=n(e).attr("tag"),s=u.indexOf("[Measures]")>-1||u.indexOf("[")>-1?u.split(":")[1]:this._getNodeUniqueName(u),s=="[Measures]"){if(e.remove(),!t.isNullOrUndefined(this._schemaData)){for(this._schemaData.element.find(".pivotButton:contains("+f+")").remove(),r=0;r<this._schemaData.model.pivotCalculations.length&&u.indexOf("Measures")>-1;r++)s=this._schemaData.model.pivotCalculations[r].Tag,this._schemaData._isMeasureBtnRemove=!0,selectedTreeNode=this._getNodeByUniqueName(s),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);this._schemaData.element.find(".schemaNoClick").addClass("freeze")}this._waitingPopup.show();this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"removeButton",element:this.element,customObject:this.model.customObject});c=JSON.stringify(this.model.customObject);o=JSON.stringify({action:"removeButton",headerInfo:u,currentReport:h,gridLayout:this.model.layout,customObject:c});!t.isNullOrUndefined(this._schemaData)&&u.indexOf("[Measures]")<0&&u.indexOf("Measures")>=0&&this._schemaData.element.find(".schemaValue .pivotButton").remove();this.model.enableDeferUpdate&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(this._removeButtonDeferUpdate=!0,this.doAjaxPost("POST",this.model.url+"/RemoveButton",o.replace("removeButton","removeButtonDeferUpdate"),this._pvtBtnDroppedSuccess),this.element.find(".schemaNoClick").removeClass("freeze"),this._waitingPopup.hide()):this.doAjaxPost("POST",this.model.url+"/RemoveButton",o,this._pvtBtnDroppedSuccess)}else if(t.isNullOrUndefined(this._schemaData)){if(c=JSON.stringify(this.model.customObject),o=JSON.stringify({action:"removeButton",headerInfo:u,currentReport:h,gridLayout:this.model.layout,customObject:c}),t.isNullOrUndefined(u))return!1;t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,o.replace("removeButton","removeButtonDeferUpdate"),this._pvtBtnDroppedSuccess):this.doAjaxPost("POST",this.model.url+"/RemoveButton",o,this._pvtBtnDroppedSuccess)}else selectedTreeNode=this._getNodeByUniqueName(s),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);else filterTag="schemaRow::"+u.id+"::FILTERED"+filterItems,v=this._droppedClass!=""?this._droppedClass:u.pivotType=="PivotItem"?"schemaRow":"schemaValue",this._droppedClass="",n(e).remove(),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this._schemaData!=null?(l=this._schemaData._tableTreeObj.element.find("li:contains('"+f+"')"),this._schemaData._tableTreeObj.uncheckNode(l)):(this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeStateModified",element:this.element,customObject:this.model.customObject}),c=JSON.stringify(this.model.customObject),o=JSON.stringify({action:"nodeStateModified",headerTag:JSON.stringify(u),dropAxis:v+"::",sortedHeaders:this._ascdes,filterParams:filterTag,currentReport:h,customObject:c}),this.model.enableDeferUpdate?(this.doAjaxPost("POST",this.model.url+"/nodeStateModified",o.replace("nodeStateModified","nodeStateModifiedDeferUpdate"),this._nodeStateModifiedSuccess),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide()):this.doAjaxPost("POST",this.model.url+"/nodeStateModified",o,this._nodeStateModifiedSuccess))}},_getNodeUniqueName:function(n){for(var t="",i=0;i<n.split(":")[1].split(".").length;i++)t!=""&&(t+="."),t+="["+n.split(":")[1].split(".")[i]+"]";return t},_getNodeByUniqueName:function(t){for(var r=null,i=0;i<n(this._schemaData._tableTreeObj.element.find("li")).length;i++)n(this._schemaData._tableTreeObj.element.find("li")[i]).attr("tag").toLowerCase()==t.toLowerCase()&&(r=n(this._schemaData._tableTreeObj.element.find("li")[i]));return r},_nodeStateModifiedSuccess:function(n){n[0]!=r?n[2]!=null&&n[2]!=r&&(this.model.customObject=n[2].Value):n.d!=r?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):n.customObject!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"nodeStateModified",element:this.element,customObject:this.model.customObject});this.model.enableDeferUpdate?this._deferUpdateSuccess(n):this._renderControlSuccess(n)},_drillDownSuccess:function(i){i[0]!=r?(this.setJSONRecords(i[0].Value),this.setOlapReport(i[1].Value),typeof oclientProxy!="undefined"&&(oclientProxy.currentReport=JSON.parse(i[1].Value).Report,i[2].Value!=r&&i[2].Value!="undefined"&&(oclientProxy.reports=i[2].Value)),i[3]!=null&&i[3]!=r&&i[3].Key=="PageSettings"&&(this.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i[4].Value).Column/JSON.parse(i[3].Value).CategorialPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i[4].Value).Row/JSON.parse(i[3].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i[3].Value).CategorialCurrentPage,this._seriesCurrentPage=JSON.parse(i[3].Value).SeriesPageSize):this._pagerObj!=null&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r?this._pagerObj.initPagerProperties(JSON.parse(i[4].Value),JSON.parse(i[3].Value)):typeof oclientProxy!="undefined"&&oclientProxy._pagerObj!=null&&oclientProxy._pagerObj.initPagerProperties(JSON.parse(i[4].Value),JSON.parse(i[3].Value)),i[5]!=null&&i[5]!=r&&(this.model.customObject=i[5].Value)),i[3]!=null&&i[3]!=r&&i[3].Key!="PageSettings"&&(this.model.customObject=i[3].Value)):i.d!=r?(this.setJSONRecords(i.d[0].Value),this.setOlapReport(i.d[1].Value),typeof oclientProxy!="undefined"&&(oclientProxy.currentReport=JSON.parse(i.d[1].Value).Report,i.d[2].Value!=r&&i.d[2].Value!="undefined"&&(oclientProxy.reports=i.d[2].Value),this._updatePageSettings(i.d,oclientProxy)),i.d[3]!=null&&i.d[3]!=r&&i.d[3].Key=="PageSettings"&&(this.model.enableVirtualScrolling||typeof oclientProxy!="undefined"&&oclientProxy.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.d[4].Value).Column/JSON.parse(i.d[3].Value).CategorialPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.d[4].Value).Row/JSON.parse(i.d[3].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i.d[3].Value).CategorialCurrentPage,this._seriesCurrentPage=JSON.parse(i.d[3].Value).SeriesCurrentPage):this._pagerObj!=null&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r?this._pagerObj.initPagerProperties(JSON.parse(i.d[4].Value),JSON.parse(i.d[3].Value)):typeof oclientProxy!="undefined"&&oclientProxy._pagerObj!=null&&oclientProxy._pagerObj.initPagerProperties(JSON.parse(i.d[4].Value),JSON.parse(i.d[3].Value)),i.d[5]!=null&&i.d[5]!=r&&(this.model.customObject=i.d[5].Value)),i.d[3]!=null&&i.d[3]!=r&&i.d[3].Key!="PageSettings"&&(this.model.customObject=i.d[3].Value)):(this.setJSONRecords(i.PivotRecords),this.setOlapReport(i.OlapReport),typeof oclientProxy!="undefined"&&(oclientProxy.currentReport=JSON.parse(i.OlapReport).Report,i.ClientReports!=r&&i.ClientReports!="undefined"&&(oclientProxy.reports=i.ClientReports),i.PageSettings!=r&&i.PageSettings!=null&&oclientProxy._pagerObj!=null&&oclientProxy._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))),i.PageSettings!=r&&i.PageSettings!=null&&(this.model.enableVirtualScrolling||typeof oclientProxy!="undefined"&&oclientProxy.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Column/JSON.parse(i.PageSettings).CategorialPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Row/JSON.parse(i.PageSettings).SeriesPageSize),this._categCurrentPage=JSON.parse(i.PageSettings).CategorialCurrentPage,this._seriesCurrentPage=JSON.parse(i.PageSettings).SeriesCurrentPage):this._pagerObj&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&this._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))),i.customObject!=null&&i.customObject!=r&&(this.model.customObject=i.customObject));this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"drillDown",element:this.element,customObject:this.model.customObject});this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&this.model.enableVirtualScrolling==!1&&n(".e-pivotpager")[0]==null?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON(this.getJSONRecords());try{this.model.currentReport=JSON.parse(this.getOlapReport()).Report}catch(f){this.model.currentReport=this.getOlapReport()}this._trigger("drillSuccess",this.element);typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?n("#"+oclientProxy._id+"_maxView")[0]&&this._maxViewLoading?(this._maxViewLoading.hide(),oclientWaitingPopup.hide()):oclientProxy.model.displaySettings.mode=="gridOnly"&&oclientWaitingPopup.hide():typeof oclientProxy!="undefined"?(!oclientProxy||oclientProxy._pivotGrid._startDrilldown||oclientProxy._pivotChart._startDrilldown)&&oclientProxy.model.displaySettings.mode!="gridOnly"||oclientProxy._waitingPopup.hide():typeof oclientWaitingPopup=="undefined"&&(this._waitingPopup=n("#"+this._id).data("ejWaitingPopup"),this._waitingPopup.hide());typeof oclientProxy!="undefined"?oclientProxy._pivotGrid._startDrilldown=!1:this._waitingPopup.hide();var u={action:this._drillAction,customObject:this.model.customObject,element:this.element};this._trigger("renderSuccess",u)},saveReport:function(n,i,r){var u,f;i.toLowerCase()=="local"?this._trigger("saveReport",{report:this.model.dataSource}):(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(report=JSON.stringify(this.model.dataSource),u="clientMode"):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(report=JSON.parse(this.getOlapReport()).Report,u="serverMode"),this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"saveReport",element:this.element,customObject:this.model.customObject}),f=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",r+"/"+this.model.serviceMethodSettings.saveReport,JSON.stringify({reportName:n,clientReports:report,operationalMode:u,customObject:f})))},loadReport:function(n,i,r){var e,u,f;this._waitingPopup.show();i.toLowerCase()=="local"?(this._trigger("loadReport",{targetControl:this,dataModel:this.model.analysisMode}),this.refreshPivotGrid()):(this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"loadReport",element:this.element,customObject:this.model.customObject}),f=JSON.stringify(this.model.customObject),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(u="clientMode",this.doAjaxPost("POST",r+"/"+this.model.serviceMethodSettings.loadReport,JSON.stringify({action:"loadReport",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:n,operationalMode:u,customObject:f}),this._loadReportSuccess)):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(u="serverMode",e=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?JSON.stringify({action:"loadReport",reportName:n,gridLayout:this.model.layout,enablePivotFieldList:this.model.enablePivotFieldList,operationalMode:u,customObject:f}):JSON.stringify({action:"loadReport",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:n,operationalMode:u}),this.doAjaxPost("POST",r+"/"+this.model.serviceMethodSettings.loadReport,e,this._renderControlSuccess)))},_loadReportSuccess:function(n){n.d!=r&&n.d.length>0?this.setOlapReport(JSON.parse(n.d[0].Value)):this.setOlapReport(JSON.parse(n.report));this.model.dataSource=this.getOlapReport();this.refreshPivotGrid();this._unWireEvents();this._wireEvents()},doAjaxPost:function(i,u,f,e,o,s){t.isNullOrUndefined(f.XMLA)&&JSON.parse(f).action!="cellEditing"&&(this.model.editCellsInfo={});var h,c,l,a=!0;f.XMLA==r?(h="application/json; charset=utf-8",c="json",l=n.proxy(e,this)):(h="text/xml",c="xml",f=f.XMLA,l=n.proxy(e,t.olap.base,s),a=t.browserInfo().name=="msie"&&t.browserInfo().version<=9?!1:!t.isNullOrUndefined(s)&&s.action!="loadFieldElements"?!0:!1);n.ajax({type:i,url:u,contentType:h,async:a,dataType:c,data:f,success:l,complete:t.proxy(function(t){n.proxy(t,this);var i={action:this._currentAction,customObject:this.model.customObject,element:this.element};this._trigger("renderComplete",i)},this),error:t.proxy(function(n){typeof this._waitingPopup!="undefined"&&this._waitingPopup!=null&&this._waitingPopup.hide();typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null&&oclientWaitingPopup.hide();var i={action:this._drillAction!=""?this._drillAction:"initialize",customObject:this.model.customObject,element:this.element,Message:n};this._trigger("renderFailure",i);this.renderControlFromJSON("");this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&t.Pivot._createErrorDialog(n.statusText,this._getLocalizedLabels("Error"),this);n.statusText},this)})},doPostBack:function(t,i){var r=n("<form>").attr({action:t,method:"POST",name:"export"}),f=function(t,i){var u=n('<input type="hidden" title="params">').attr({id:t,name:t,value:i}).appendTo(r)};for(var u in i)f(u,i[u]);r.appendTo(document.body).submit().remove()},refreshPagedPivotGrid:function(i,r){if(this._isUpdateRequired=!0,typeof oclientWaitingPopup=="undefined"&&(this._waitingPopup=n("#"+this._id).data("ejWaitingPopup"),this._waitingPopup.show()),i=i.indexOf("categ")!=-1?"categorical":"series",this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)i=="categorical"?this._categCurrentPage=parseInt(r):this._seriesCurrentPage=parseInt(r),t.olap.base.getJSONData({action:"navPaging"},this.model.dataSource,this);else{var u;try{u=JSON.parse(this.getOlapReport()).Report}catch(f){u=this.getOlapReport()}this.model.enableDeferUpdate?(this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"pagingDeferUpdate",pagingInfo:i+":"+r,currentReport:u,layout:this.layout(),customObject:JSON.stringify(this.model.customObject)}),this._deferUpdateSuccess),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide()):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"paging",pagingInfo:i+":"+r,currentReport:u,layout:this.layout(),customObject:JSON.stringify(this.model.customObject)}),this._renderControlSuccess)}},excelLikeLayout:function(i){var v,g,it,k,d,a,l,s,h,u,e,c;for(this._excelRowCount=0,u=0;u<i.length;u++)if(parseInt(i[u].Index.split(",")[0])==0)this._excelRowCount++;else break;this._rowCount=this._excelRowCount;var r=jQuery.extend(!0,[],i),f=[],w=[],o=null,y=0;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.dataSource.rows.length==0&&this.model.dataSource.data!=null||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.getOlapReport()!==""&&JSON.parse(this.getOlapReport()).PivotRows.length==0)){this._excelLikeJSONRecords=null;this.renderControlFromJSON();this._excelRowCount=0;return}if(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&r!=null&&r!=""){for(v=null,s=r[0].CSS!="colheader"?r[0].ColSpan*this._excelRowCount:0;s<r.length;s++){if(r[s].Info.toLowerCase().indexOf("[measure")>-1&&(v=parseInt(r[s].Index.split(",")[1])),r[s].CSS.indexOf("value")>-1)break;g=parseInt(r[s].Index.split(",")[1])}for(v!=null&&v!=g&&v!=0&&this._columnExcelLikeLayout(r,v,g),it=r.length/this._excelRowCount,k=0;k<it&&k<r.length;k++)for(d=0;d<=g&&d<r.length;d++)if(u=k*this._excelRowCount+d,r[u].CSS=="colheader"&&r[u].Span!="Block"&&(r[u].Info.toLowerCase().indexOf("[measure")==-1||r[u].Info.toLowerCase().indexOf("[measure")>-1&&v!=null&&v==0)&&r[u].ColSpan>1){for(e=u;e<u+r[u].RowSpan;e++){for(c=e+this._excelRowCount;c<e+r[u].ColSpan*this._excelRowCount;c=c+this._excelRowCount)r[c].Span="Block";e!=u&&(r[e].Span="Block")}if(a=u+(r[u].RowSpan-1)+(r[u].ColSpan-1)*this._excelRowCount+1,l=null,r[a].CSS.indexOf("summary")>-1&&r[a].Value=="Total"&&r[a-this._excelRowCount].CSS.indexOf("summary")==-1)l=a;else if(r[a].CSS.indexOf("summary")>-1&&r[a-this._excelRowCount].CSS.indexOf("summary")>-1)for(e=a-this._excelRowCount;e>=0&&e<r.length;e=e-this._excelRowCount)if(r[e].ColSpan>1||r[e-this._excelRowCount].CSS.indexOf("summary")==-1&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){l=e;break}l!=null&&(r[l].ColSpan=this.model.operationalMode!=t.PivotGrid.OperationalMode.ClientMode?r[l].ColSpan:parseInt(r[a].Index.split(",")[0])-parseInt(r[l].Index.split(",")[0])+1,r[u].ColSpan=r[u].ColSpan-r[l].ColSpan,r[u+r[u].ColSpan*this._excelRowCount]=n.extend(!0,{},r[l]),r[u+r[u].ColSpan*this._excelRowCount].RowSpan=r[l].RowSpan+r[u].RowSpan,r[u+r[u].ColSpan*this._excelRowCount].Value=r[u].Value+" Total")}}if(r!=null&&r!=""&&r[0].CSS!="colheader"&&!(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)){if(r[0].Index=="0,0"&&r[0].CSS!="colheader")for(y=r[0].ColSpan,r[0].RowSpan==0&&(r[0].RowSpan=1),e=0;e<r[0].RowSpan&&e<r.length;e++)f.push(r[e]),r[e].Level=1,r[e].Span="Block";for(s=r[0].RowSpan;s<r.length&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.dataSource.rows.length>0;s=s+this._excelRowCount)if(r[s].Info.toLowerCase().indexOf("[measure")>-1){o=parseInt(r[s].Index.split(",")[0]);break}for(u=0;u<r.length&&u<this._excelRowCount;u++)if(r[u].CSS=="rowheader"&&parseInt(r[u].Index.split(",")[0])==0&&r[u].Span!="Block"){for(r[u].Level=1,r[u+this._excelRowCount]!=null&&r[u+this._excelRowCount].CSS.indexOf("value")==-1&&(r[u].itemIndex=r[u+r[u].RowSpan-(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?1:0)].Index),f.push(r[u]),o!=null&&o==0&&r[u].Info.toLowerCase().indexOf("[measure")>-1&&w.push(r[u]),e=u+1;e<u+r[u].RowSpan;e++)(r[e].Info.toLowerCase().indexOf("[measure")==-1||o!=null&&o!=y-1)&&(r[e].Span="Block");this._rowExcelLikeLayout(u,r,f,2,o,w,y)}else(r[u].CSS=="summary rgtot"||r[u].CSS=="summary gtot"||r[u].CSS=="summary calc gtot"||r[u].CSS=="colheader"&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||(r[u].CSS=="summary"&&r[u].Value.indexOf("Total")>-1||r[u].CSS=="summary row")&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot)&&parseInt(r[u].Index.split(",")[0])==0&&(o!=null&&o==y-1&&(r[u].Value+=" "+r[u+this._excelRowCount*parseInt(r[u].ColSpan)].Value),r[u].Value=r[u].Value=="Total"?"Grand Total":r[u].Value,f.push(r[u]),r[u].Level=1);if(o!=null&&o==0){for(u=0;u<w.length;u++)f.push(n.extend(!0,{},w[u])),f[f.length-1].CSS="summary",f[f.length-1].Value="Total "+f[f.length-1].Value;w.splice(0,w.length)}var p=f.length,b=0,nt,rt,tt=!1;for(u=0;u<p;u++){for(b=b+u,nt=f[u].itemIndex!=null?f[u].itemIndex:f[u].Index,rt=parseInt(nt.split(",")[0])*this._excelRowCount+parseInt(nt.split(",")[1]),h=rt;h<r.length;h=h+this._excelRowCount)(r[h].CSS.indexOf("value")>-1||r[h].CSS.indexOf("colheader")>-1||r[h].CSS.indexOf("calc")>-1||r[h].CSS.indexOf("cstot")>-1||r[h].CSS.indexOf("cgtot")>-1||r[h].CSS.indexOf("none")>-1)&&parseInt(r[h].Index.split(",")[0])>=y&&(tt=!0),tt&&(b=b+(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?parseInt(p):this._excelRowCount),f[b]=n.extend(!0,{},r[h]));b=0;tt=!1}for(u=0;u<p;u++)f[u]!=null&&(f[u].Span="none",isNaN(f[u].Level)&&(f[u].Level=1),f[u].Index=="0,0"&&f[u].CSS!="colheader"&&u==0||(f[u].RowSpan=1),f[u].ColSpan=o!=null&&o==y-1&&f[u].CSS=="rowheader"&&f[u].Info.toLowerCase().indexOf("[measure")==-1?f.length/p:o!=null&&o==0&&f[u].Info.toLowerCase().indexOf("[measure")>-1&&f[u].CSS=="rowheader"?f.length/p:o!=null&&o!=y-1&&o!=0&&(f[u].Info.toLowerCase().indexOf("[measure")>-1||f[u].CSS=="rowheader"&&parseInt(f[u].Index.split(",")[0])<o)?f.length/p:1);this._excelRowCount=p}for(r!=null&&f.length==0&&(f=r),e=0;e<f.length/this._excelRowCount;e++)for(c=0;c<this._excelRowCount;c++)f[e*this._excelRowCount+c].i=""+e+","+c+"",f[e*this._excelRowCount+c].Span="none";this._excelLikeJSONRecords=f;this.renderControlFromJSON()},_rowExcelLikeLayout:function(n,i,r,u,f,e,o){for(var v,c,h,l=!1,s=n+(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?i[n].ColSpan*this._excelRowCount:this._excelRowCount),a=0;a<i[n].RowSpan&&s<i.length&&i[s].CSS.indexOf("value")==-1;s++,a++){if(f!=null&&f!=o-1&&f!=0&&i[s].Info.toLowerCase().indexOf("[measure")>-1&&i[s].Span!="Block"&&(l=!0),v=f!=null&&f==o-1?i[s].CSS=="summary row"&&(i[s+this._excelRowCount].CSS=="summary row"||i[s+this._excelRowCount].CSS=="none"||i[s+this._excelRowCount].Info.toLowerCase().indexOf("[measure")>-1):f!=null&&f!=o-1&&f!=0?i[s].CSS=="summary"&&(i[s+this._excelRowCount].CSS=="summary"||i[s+this._excelRowCount].CSS=="none"||i[s+this._excelRowCount].Info.toLowerCase().indexOf("[measure")>-1||parseInt(i[s].Index.split(",")[0])-1<=f):!1,(i[s].CSS=="rowheader"||i[s].CSS=="none"||v)&&i[s].Span!="Block"){for(h=s+1;h<s+i[s].RowSpan;h++)(i[h].Info.toLowerCase().indexOf("[measure")==-1||f!=null&&f!=o-1)&&(i[h].Span="Block");if(i[s].Level=u,i[s].CSS!="none")if(i[s+this._excelRowCount]!=null&&i[s+this._excelRowCount].CSS.indexOf("value")==-1&&(i[s].itemIndex=i[s+i[s].RowSpan-(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?1:0)].Index),v){for(c=s-i[n].ColSpan*this._excelRowCount;c>=0&&c<i.length;c--)if(i[c].Value!=""){i[s].Value=i[c].Value;i[s].Level=i[n].Level;break}f!=null&&f!=o-1&&f!=0&&parseInt(i[s].Index.split(",")[0])-1==f?e.push(i[s]):(i[s].Value+=" "+i[s+this._excelRowCount*parseInt(i[s].ColSpan)].Value,r.push(i[s]))}else r.push(i[s]);i[s].Span="Block";i[s].CSS!="summary row"&&i[s].CSS!="summary"&&this._rowExcelLikeLayout(s,i,r,u+1,f,e,o)}if(l&&a+1==i[n].RowSpan){for(l=!1,h=0;h<e.length;h++)e[h].Value=i[n].Value+" "+e[h].Value,r.push(e[h]);e.splice(0,e.length)}}},_columnExcelLikeLayout:function(t,i,r){for(var l,u,o,s,f,c,y,e,v,h,p=t.length/this._excelRowCount,a=0;a<p&&a<t.length;a++)for(l=0;l<=r&&l<t.length;l++)if(u=a*this._excelRowCount+l,t[u].CSS=="colheader"&&t[u].Span!="Block"&&t[u].Info.toLowerCase().indexOf("[measure")==-1&&t[u].ColSpan>1){for(f=u;f<u+t[u].RowSpan;f++){for(e=f+this._excelRowCount;e<f+t[u].ColSpan*this._excelRowCount;e=e+this._excelRowCount)t[e].Span="Block";f!=u&&(t[f].Span="Block")}if(o=u+(t[u].RowSpan-1)+(t[u].ColSpan-1)*this._excelRowCount+1,t[o].Info.toLowerCase().indexOf("[measure")>-1&&JSON.parse(this.getOlapReport()).PivotCalculations.length>1&&i!=null&&i!=r&&i!=0){for(s=[],f=u+t[u].RowSpan;f<=o;f=f+(t[f].ColSpan+1)*this._excelRowCount)if(c=f+(t[f].RowSpan-1)+(t[f].ColSpan-1)*this._excelRowCount+1,t[c].CSS.indexOf("summary")>-1){for(t[c-1].RowSpan=t[c-1].RowSpan+t[c].RowSpan,y=parseInt(t[c].Index.split(",")[0])*this._excelRowCount,e=0;e<this._excelRowCount;e++)t.splice(parseInt(t[o].Index.split(",")[0])*this._excelRowCount+this._excelRowCount+e+s.length*this._excelRowCount,0,n.extend(!0,{},t[y+e]));s.push(y);t[f].ColSpan=t[f].ColSpan-1}for(v=s.length-1;v>=0;v--)t.splice(parseInt(t[s[v]].Index.split(",")[0])*this._excelRowCount,this._excelRowCount);s.length>0&&(t[u].ColSpan=t[u].ColSpan-s.length,h=u+t[u].ColSpan*this._excelRowCount,t[h].ColSpan=s.length,t[h].RowSpan=t[u].RowSpan,t[h].Value=t[u].Value+" Total",t[h].CSS="summary",t[h].Span="none",t[h].State=0)}else t[o].Info.toLowerCase().indexOf("[measure")>-1&&t[o+1].CSS.indexOf("summary")>-1&&JSON.parse(this.getOlapReport()).PivotCalculations.length==1&&i!=null&&i!=r&&i!=0&&(t[u].ColSpan=t[u].ColSpan-1,t[u+t[u].ColSpan*this._excelRowCount]=n.extend(!0,{},t[o+1]),t[o+1].Value="",t[u+t[u].ColSpan*this._excelRowCount].Value=t[u].Value+" Total",t[u+t[u].ColSpan*this._excelRowCount].RowSpan=t[u].RowSpan)}},renderControlFromJSON:function(){var i=this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelLikeJSONRecords:this.getJSONRecords(),e,ft,et,ot,pt,rt,h,r,ut,st,ht,ct,lt,at,b,k,w,l,s,v,a,y,d,g,u,f,c,o,vt,yt;if(this.model.enableConditionalFormatting&&this._isFormatApply&&(i=this._refreshCellFormatting(i)),this.model.enableConditionalFormatting&&!this._isFormatApply&&(i=this._applyCodeBehindFormatting(i)),e=n('<table class="pivotGridTable" cellspacing="0" cellpadding="0" role=\'grid\'  aria-readonly=\'true\'><\/table>'),this.model.isResponsive&&e.addClass("e-table"),i!=null&&i!=""||this.model.enableGroupingBar){if(i!=null&&i!=""){ot=this._rowCount;this._rowCount=0;pt=this;this._rowCount=parseInt(i[i.length-1].Index.split(",")[1])+1;this._rowCount=this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelRowCount:this._rowCount;var nt=n("<thead><\/thead>"),tt=n("<tbody><\/tbody>"),it=!0,p=0;if(i[0].CSS=="none"?p=i[0].RowSpan-1:(jQuery.each(i,function(n){return p+=i[n].RowSpan,i[n].CSS=="colheader"}),p=p-2),this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders)this._renderFrozenGridTable(it,p,i,e);else{for(rt=!1,s=0;s<i.length;s++)if(s<this._rowCount)if(it){for(it=s>=p?!1:!0,h="<tr role='row'>",this.model.enableGroupingBar&&i[s].Index=="0,0"&&i[s].CSS=="colheader"&&(h=h+"<th class='grpRow' p='-1,-1' colspan= 1 rowspan="+(this._rowCount-1)+"> <div class=rows>"+this._getLocalizedLabels("DragFieldHere")+"<\/div><\/th>",rt=!0),r=s;r<i.length;r=r+this._rowCount)if(i[r].Span!="Block")if(h=i[r].Index=="0,0"&&i[r].CSS!="colheader"&&this.model.enableGroupingBar?h+"<th class=grpRow p="+i[r].Index+" colspan="+i[r].ColSpan+" rowspan="+i[r].RowSpan+" role='columnheader' aria-describedby='row'"+(i[r].i==null?"":"i="+i[r].i)+">"+t.buildTag("span#row","rows",{display:"none"})[0].outerHTML+(i[r].State==0?'<span style="margin-left: 0px"><\/span>':i[r].State==2?'<span class="expand e-icon" aria-describedby=\'expansion\' title="'+this._getLocalizedLabels("Expand")+"\">&nbsp;<p id='expansion' style='display:none'>collapsed<\/p><\/span>":i[r].State==1?'<span class="collapse e-icon" aria-describedby=\'collapsing\' title="'+this._getLocalizedLabels("Collapse")+"\">&nbsp;<p id='collapsing' style='display:none'>expanded<\/p><\/span>":"")+i[r].Value+t.buildTag("div.rows",this._pivotRow,{})[0].outerHTML+"<\/th>":h+"<th"+(i[r].CSS=="none"?"":' class="'+i[r].CSS)+(i[r].CSS=="none"?" p="+i[r].Index:'" p='+i[r].Index)+" colspan="+i[r].ColSpan+" rowspan="+i[r].RowSpan+" role='columnheader'"+(i[r].i==null?"":"i="+i[r].i)+">"+(i[r].State==0?'<span style="margin-left: 10px"><\/span>':i[r].State==2?'<span class="expand e-icon" aria-describedby=\'expansion\' title="'+this._getLocalizedLabels("Expand")+"\">&nbsp;<p id='expansion' style='display:none'>collapsed<\/p><\/span>":i[r].State==1?'<span class="collapse e-icon" aria-describedby=\'collapsing\' title=" '+this._getLocalizedLabels("Collapse")+"\">&nbsp;<p id='collapsing' style='display:none'>expanded<\/p><\/span>":"")+i[r].Value+"<\/th>",i[r].RowSpan>1&&i[r].ColSpan<=1)for(u=r+1;u<r+i[r].RowSpan;u++)i[u].Span="Block";else if(i[r].ColSpan>1&&i[r].RowSpan<=1)for(u=r+this._rowCount;u<r+i[r].ColSpan*this._rowCount;u=u+this._rowCount)i[u].Span="Block";else if(i[r].ColSpan>1&&i[r].RowSpan>1)for(u=r;u<r+i[r].RowSpan;u++){for(o=u+this._rowCount;o<u+i[r].ColSpan*this._rowCount;o=o+this._rowCount)i[o].Span="Block";u!=r&&(i[u].Span="Block")}h+="<\/tr>";n(h).children().length>0&&n(nt).append(h)}else{for(h="<tr role='row'>",parseInt(i[s].Index.split(",")[0])==0&&parseInt(i[s].Index.split(",")[1])==this._rowCount-1&&rt&&(h=h+"<td class='rowheader' p='-1,-2' colspan=1 rowspan=1>Grant total<\/td>"),r=s;r<i.length;r=r+this._rowCount)if(i[r].Span!="Block")if(h=i[r].CSS=="rowheader"||i[r].CSS=="summary"||i[r].CSS.indexOf("summary rstot")>-1||i[r].CSS.indexOf("summary stot")>-1||i[r].CSS=="summary row"?this.layout().toLowerCase()=="excellikelayout"?h+"<th"+(i[r].CSS=="none"?"":' class="'+i[r].CSS)+'" p='+i[r].Index+" colspan="+i[r].ColSpan+" rowspan="+i[r].RowSpan+" role='rowheader'"+(i[r].i==null?"":"i="+i[r].i)+">"+(i[r].State==2?'<span style="margin-left:'+i[r].Level*10+'px" class="expand e-icon" aria-describedby=\'expansion\' title="'+this._getLocalizedLabels("Expand")+"\">&nbsp;<p id='expansion' style='display:none'>collapsed<\/p><\/span>":i[r].State==1?'<span style="margin-left:'+i[r].Level*10+'px" class="collapse e-icon" aria-describedby=\'collapsing\' title="'+this._getLocalizedLabels("Collapse")+"\">&nbsp;<p id='collapsing' style='display:none'>expanded<\/p><\/span>":'<span style="margin-left:'+(this._excelLikeJSONRecords!=null&&i[r].CSS=="summary row"?i[r].Level*10:(i[r].Level==1?1:i[r].Level+2)*10)+'px">&nbsp;<\/span>')+i[r].Value+"<\/th>":h+"<th"+(i[r].CSS=="none"?"":' class="'+i[r].CSS)+'" p='+i[r].Index+" colspan="+i[r].ColSpan+" rowspan="+i[r].RowSpan+" role='rowheader'>"+(i[r].State==0?'<span style="margin-left: 10px"><\/span>':i[r].State==2?'<span class="expand e-icon" aria-describedby=\'expansion\' title="'+this._getLocalizedLabels("Expand")+"\">&nbsp;<p id='expansion' style='display:none'>collapsed<\/p><\/span>":i[r].State==1?'<span class="collapse e-icon" aria-describedby=\'collapsing\' title="'+this._getLocalizedLabels("Collapse")+"\">&nbsp;<p id='collapsing' style='display:none'>expanded<\/p><\/span>":"")+i[r].Value+"<\/th>":h+"<td"+(i[r].CSS=="none"?"":' class="'+i[r].CSS)+'" p='+i[r].Index+" colspan="+i[r].ColSpan+" rowspan="+i[r].RowSpan+" role='gridcell'"+(i[r].i==null?"":"i="+i[r].i)+">"+(i[r].State==2?'<span class="expand e-icon" title="'+this._getLocalizedLabels("Expand")+'">&nbsp;<\/span>':i[r].State==1?'<span class="collapse e-icon" title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;<\/span>':"")+i[r].Value+"<\/td>",i[r].RowSpan>1&&i[r].ColSpan<=1)for(u=r+1;u<r+i[r].RowSpan;u++)i[u].Span="Block";else if(i[r].ColSpan>1&&i[r].RowSpan<=1)for(u=r+this._rowCount;u<r+i[r].ColSpan*this._rowCount;u=u+this._rowCount)i[u].Span="Block";else if(i[r].ColSpan>1&&i[r].RowSpan>1)for(u=r;u<r+i[r].RowSpan;u++){for(o=u+this._rowCount;o<u+i[r].ColSpan*this._rowCount;o=o+this._rowCount)i[o].Span="Block";u!=r&&(i[u].Span="Block")}h+="<\/tr>";n(tt).append(h)}if(this.model.enableColumnResizing&&(!this.model.frozenHeaderSettings.enableFrozenColumnHeaders||!this.model.frozenHeaderSettings.enableFrozenRowHeaders||!this.model.frozenHeaderSettings.enableFrozenHeaders))for(ut=n("<colgroup><\/colgroup>"),u=0;u<i.length/this._rowCount;u++)st="<col style='width:160px'><\/col>",ut.append(st),n(e).append(ut);this.model.frozenHeaderSettings.enableFrozenColumnHeaders?(ht=t.buildTag("div#scrollContent")[0].outerHTML,ct=t.buildTag("div#rowvaluecontent")[0].outerHTML,n(e).append(n(ht).append(n("<div><\/div>").append(n("<div id='coltable'><\/div>").append(n("<table class='pivotGridColValueTable' style='width: 100%'><\/table>").append(nt)),n(ct).append(n("<div><\/div>").append(n("<table class='pivotGridRowValueTable' style='width: 100%'><\/table>").append(tt))))))):(n(e).append(nt),n(e).append(tt))}}}else ft=t.buildTag("tr",t.buildTag("th","",{width:"70px"})[0].outerHTML+t.buildTag("th","",{width:"70px"})[0].outerHTML+t.buildTag("th","",{width:"70px"})[0].outerHTML),et=t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML,n(e).append(ft),n(e).append(et),this._rowCount=0;if(this._unWireEvents(),this._wireEvents(),this.model.enableVirtualScrolling||!(n(e).find("tr:last > td").length>0)||n(e).find("tr:last").find("td").text()!=""||this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||this._pagerObj!=null||n(e).find("tr:last").hide(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.enableCollapseByDefault&&this.model.collapsedMembers==null&&!t.isNullOrUndefined(i))if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.enableCollapseByDefault&&this.model.collapsedMembers==null){for(lt=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.rows.length:JSON.parse(this.getOlapReport()).PivotRows.length,at=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns.length:JSON.parse(this.getOlapReport()).PivotColumns.length,this.model.collapsedMembers={},b=lt;b>=0;b--)for(thRList=n(e).find("th[p^='"+b+",']:has('span.collapse')[class^='rowheader']"),w=this._getFieldName(thRList[0]),this.model.collapsedMembers[w]=[],l=0;l<thRList.length;l++)this.model.collapsedMembers[w].push(n(thRList[l]).clone().children().remove().end().text()),this._collapseMember(e,n(thRList[l]).find(".collapse"));for(k=at;k>=0;k--)for(thCList=n(e).find("th[p$=',"+k+"']:has('span.collapse')[class$='colheader']"),w=this._getFieldName(thCList[0]),this.model.collapsedMembers[w]=[],l=0;l<thCList.length;l++)this.model.collapsedMembers[w].push(n(thRList[l]).clone().children().remove().end().text()),this._collapseMember(e,n(thCList[l]).find(".collapse"))}else if(!t.isNullOrUndefined(this.model.collapsedMembers))for(s=0;s<this.model.collapsedMembers.length;s++)if(v=this.model.collapsedMembers[s],this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){for(u=0;u<this.model.dataSource.rows.length;u++)this.model.dataSource.rows[u].fieldName==s&&(a=u,y="row");for(u=0;u<this.model.dataSource.columns.length;u++)this.model.dataSource.columns[u].fieldName==s&&(a=u,y="column");if(!t.isNullOrUndefined(a))if(y=="row")for(u=this.model.dataSource.columns.length+1;u<this._rowCount;u+=t.isNullOrUndefined(f)?1:f.rowSpan){for(f=n(e).find("tBody th[p='"+a+","+u+"']")[0],c=!1,o=0;o<v.length;o++)if(n(f).text().trim()==v[o].toString().trim()){c=!0;break}!t.isNullOrUndefined(f)&&(n(f).hasClass("rowheader")||n(f).attr("role")=="rowheader")&&c&&n(f).find(".collapse").length>0&&this._collapseMember(e,n(f).find(".collapse"))}else if(y=="column")for(u=this.model.dataSource.rows.length;u<Math.ceil(this.getJSONRecords().length/this._rowCount);u+=t.isNullOrUndefined(f)?1:f.colSpan){for(f=n(e).find("thead th[p='"+u+","+a+"']")[0],c=!1,o=0;o<v.length;o++)if(n(f).text().trim()==v[o].toString().trim()){c=!0;break}!t.isNullOrUndefined(f)&&(n(f).hasClass("colheader")||n(f).attr("role")=="columnheader")&&c&&n(f).find(".collapse").length>0&&this._collapseMember(e,n(f).find(".collapse"))}}else{for(d=JSON.parse(this.getOlapReport()).PivotRows,g=JSON.parse(this.getOlapReport()).PivotColumns,u=0;u<d.length;u++)d[u].FieldName==s&&(a=u,y="row");for(u=0;u<g.length;u++)g[u].FieldName==s&&(a=u,y="column");if(!t.isNullOrUndefined(a))if(y=="row")for(u=g.length+1;u<this._rowCount;u+=t.isNullOrUndefined(f)?1:f.rowSpan){for(f=n(e).find("tBody th[p='"+a+","+u+"']")[0],c=!1,o=0;o<v.length;o++)if(n(f).text().trim()==v[o].toString().trim()){c=!0;break}!t.isNullOrUndefined(f)&&(n(f).hasClass("rowheader")||n(f).attr("role")=="rowheader")&&c&&n(f).find(".collapse").length>0&&this._collapseMember(e,n(f).find(".collapse"))}else if(y=="column")for(u=d.length;u<Math.ceil(this.getJSONRecords().length/this._rowCount);u+=t.isNullOrUndefined(f)?1:f.colSpan){for(f=n(e).find("thead th[p='"+u+","+a+"']")[0],c=!1,o=0;o<v.length;o++)if(n(f).text().trim()==v[o].toString().trim()){c=!0;break}!t.isNullOrUndefined(f)&&(n(f).hasClass("colheader")||n(f).attr("role")=="columnheader")&&c&&n(f).find(".collapse").length>0&&this._collapseMember(e,n(f).find(".collapse"))}}this.element.html("");this._hideGrandTotal(e);this._hideSubTotal(e);this.model.enableVirtualScrolling?(this._createVirtualPivotGrid(e),this.model.enableRTL&&this.element.addClass("e-rtl"),this._applyVScrolling()):this.model.enableGroupingBar?(this.element.append(e),(this._JSONRecords==null||this._JSONRecords.length==0)&&this.element.append(t.buildTag("span","No records to display.",{display:"inline-block",padding:"10px 0px 0px 0px","font-family":"Segoe UI"})[0].outerHTML),this.model.enableRTL&&this.element.addClass("e-rtl"),this._createFields(e,n("#"+this._id).find(".pivotGridTable").width(),n("#"+this._id).find(".pivotGridTable th").outerWidth())):this.element.append(e);typeof oclientProxy!="undefined"&&oclientProxy.model.enableVirtualScrolling&&!oclientProxy.model.enablePaging&&(oclientProxy.element.find(".categPageIndicator, .seriesPageIndicator , .vScrollThumb, .hScrollThumb").remove(),vt=t.buildTag("div.seriesPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("SeriesPage")+" : ")[0].outerHTML+t.buildTag("span.series_CurrentPage",this._seriesCurrentPage)[0].outerHTML+" / "+t.buildTag("span.series_pageCount",this._seriesPageCount)[0].outerHTML)[0].outerHTML,this._seriesPageCount>1?(oclientProxy.element.find(".vScrollPanel").width()!=12&&oclientProxy.element.width(oclientProxy.element.width()+12),oclientProxy.element.find(".vScrollPanel").width(12),oclientProxy.element.find(".virtualScrolling").append(vt),oclientProxy.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&oclientProxy.model.displaySettings.mode==t.PivotClient.DisplayMode.ChartAndGrid?oclientProxy.element.find(".virtualScrolling").css("padding-top","35px"):oclientProxy.element.find(".virtualScrolling").css("padding-left","2px")):oclientProxy.element.find(".vScrollPanel").width()==12&&(oclientProxy.element.width(oclientProxy.element.width()-12),oclientProxy.element.find(".vScrollPanel").width(0)),yt=t.buildTag("div.categPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("CategoricalPage")+" : ")[0].outerHTML+t.buildTag("span.categ_CurrentPage",this._categCurrentPage)[0].outerHTML+" / "+t.buildTag("span.categ_pageCount",this._categPageCount)[0].outerHTML)[0].outerHTML,this._categPageCount>1?(oclientProxy.element.find(".hScrollPanel").height()!=12&&(oclientProxy.element.find(".hScrollPanel").height(12),oclientProxy.element.find(".cubeBrowser").height(oclientProxy.element.find(".cubeBrowser").height()+20),oclientProxy.element.find(".categoricalAxis, .rowAxis,.slicerAxis").height(oclientProxy.element.find(".categoricalAxis, .rowAxis,.slicerAxis").height()+6)),oclientProxy.controlPlacement()==t.PivotClient.ControlPlacement.title&&oclientProxy.element.find(".hsVirtualScrolling").css("margin-top","3px"),oclientProxy.element.find(".hsVirtualScrolling").append(yt)):oclientProxy.element.find(".hScrollPanel").height()==12&&(oclientProxy.model.isResponsive?oclientProxy.element.find(".categoricalAxis, .rowAxis,.slicerAxis").height(oclientProxy.element.find(".categoricalAxis, .rowAxis,.slicerAxis").height()-6):oclientProxy.element.find(".categoricalAxis, .rowAxis,.slicerAxis").height(150),oclientProxy.element.find(".cubeBrowser").height(oclientProxy.element.find(".cubeBrowser").height()-20),oclientProxy.element.find(".hScrollPanel").height(0)),this._applyVScrolling());this.model.enableColumnResizing&&this.element.addClass("column-resize");(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&this._applyFrozenHeaderWidth(i);this.model.enableCellDoubleClick&&this._on(this.element,"dblclick",".value, .summary",this._cellRangeInfo);this.model.enableRTL?(this.element.addClass("e-rtl"),this.element.find(".groupingBarPivot").addClass("e-rtl"),this.element.find(".groupingBarPivot").width(n(".pivotGridTable").width()),this.element.find("table .rowheader,.colheader,.summary, .groupingBarPivot, .grpRow").css("text-align","right")):(this.element.removeClass("e-rtl"),this.element.find(".groupingBarPivot").removeClass("e-rtl"),this.element.find("table .rowheader,.colheader,.summary, .grpRow, .groupingBarPivot ").css("text-align","left"));this._schemaData!=null&&this.element.find(".colheader, .rowheader, .value").addClass("e-droppable");this.exportRecords=i;this._preventPanelClose();this._waitingPopup&&this._waitingPopup.hide();this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(this._rowCount=ot)},_renderFrozenGridTable:function(i,r,u,f){var it=n("<table class=\"pivotGridFrozenTable\" style='width: 100%' ><\/table>"),ut,b,k,p,h,d,g,s,e,nt,l,o,c,rt;for(ut=b=n("<tbody><\/tbody>"),k=n("<tbody><\/tbody>"),h=s="<tr role='row'>",d=n("<table class=\"pivotGridRowTable\" style='table-layout: fixed' ><\/table>"),p=n("<tbody><\/tbody>"),g=n("<table class=\"pivotGridValueTable\" style='width: 100%' ><\/table>"),index=0;index<u.length;index++)if(index<this._rowCount)if(i){for(i=index>=r?!1:!0,s="<tr role='row'>",e=index;e<u.length;e=e+this._rowCount)if(u[e].Span!="Block")if(u[e].Index=="0,0"&&u[e].CSS!="colheader"&&this.model.enableGroupingBar?h=h+"<td class=grpRow p="+u[e].Index+" colspan="+u[e].ColSpan+" rowspan="+u[e].RowSpan+" role='columnheader'"+(u[e].i==null?"":"i="+u[e].i)+">"+(u[e].State==0?'<span style="margin-left: 0px"><\/span>':u[e].State==2?'<span class="expand e-icon">&nbsp;<\/span>':u[e].State==1?'<span class="collapse e-icon" title="Collapsed">&nbsp;<\/span>':"")+u[e].Value+t.buildTag("div.rows",this._pivotRow,{})[0].outerHTML+"<\/td>":u[e].Index=="0,0"&&u[e].Value==""?h=h+"<td"+(u[e].CSS=="none"?"":' class="'+u[e].CSS)+(u[e].CSS=="none"?" p="+u[e].Index:'" p='+u[e].Index)+" colspan= 1 rowspan= 1 role='columnheader'"+(u[e].i==null?"":"i="+u[e].i)+">"+(u[e].State==0?'<span style="margin-left: 10px"><\/span>':u[e].State==2?'<span class="expand e-icon">&nbsp;<\/span>':u[e].State==1?'<span class="collapse e-icon" title="Collapsed">&nbsp;<\/span>':"")+t.buildTag("span.cellValue",u[e].Value)[0].outerHTML+"<\/td>":s=s+"<td"+(u[e].CSS=="none"?"":' class="'+u[e].CSS)+(u[e].CSS=="none"?" p="+u[e].Index:'" p='+u[e].Index)+" colspan="+u[e].ColSpan+" rowspan="+u[e].RowSpan+" role='columnheader'"+(u[e].i==null?"":"i="+u[e].i)+">"+(u[e].State==0?'<span style="margin-left: 10px"><\/span>':u[e].State==2?'<span class="expand e-icon">&nbsp;<\/span>':u[e].State==1?'<span class="collapse e-icon" title="Collapsed">&nbsp;<\/span>':"")+t.buildTag("span.cellValue",u[e].Value)[0].outerHTML+"<\/td>",u[e].RowSpan>1&&u[e].ColSpan<=1){for(o=e+1;o<e+u[e].RowSpan;o++)u[o].Span="Block";h+="<\/tr>"}else if(u[e].ColSpan>1&&u[e].RowSpan<=1)for(o=e+this._rowCount;o<e+u[e].ColSpan*this._rowCount;o=o+this._rowCount)u[o].Span="Block";else if(u[e].ColSpan>1&&u[e].RowSpan>1)for(o=e;o<e+u[e].RowSpan;o++){for(c=o+this._rowCount;c<o+u[e].ColSpan*this._rowCount;c=c+this._rowCount)u[c].Span="Block";o!=e&&(u[o].Span="Block")}s+="<\/tr>";n(b).append(s)}else{for(s="<tr role='row'>",e=index;e<u.length;e=e+this._rowCount)if(u[e].Span!="Block")if(u[e].CSS=="rowheader"||u[e].CSS=="summary row"||u[e].CSS=="summary rstot"||u[e].CSS=="summary rgtot"||u[e].CSS=="summary stot"||u[e].CSS=="summary gtot"||u[e].CSS=="summary"?(s=this.layout().toLowerCase()=="excellikelayout"?s+"<td"+(u[e].CSS=="none"?"":' class="'+u[e].CSS)+'" p='+u[e].Index+" colspan="+u[e].ColSpan+" rowspan="+u[e].RowSpan+" role='rowheader'"+(u[e].i==null?"":"i="+u[e].i)+">"+(u[e].State==2?'<span style="margin-left:'+u[e].Level*10+'px" class="expand e-icon">&nbsp;<\/span>':u[e].State==1?'<span style="margin-left:'+u[e].Level*10+'px" class="collapse e-icon">&nbsp;<\/span>':'<span style="margin-left:'+(this._excelLikeJSONRecords!=null&&u[e].CSS=="summary row"?u[e].Level*10:(u[e].Level+=u[e].Level==1?0:2)*10)+'px">&nbsp;<\/span>')+t.buildTag("span.cellValue",u[e].Value)[0].outerHTML+"<\/td>":s+"<td"+(u[e].CSS=="none"?"":' class="'+u[e].CSS)+'" p='+u[e].Index+" colspan="+u[e].ColSpan+" rowspan="+u[e].RowSpan+" role='rowheader'>"+(u[e].State==0?'<span style="margin-left: 10px"><\/span>':u[e].State==2?'<span class="expand e-icon">&nbsp;<\/span>':u[e].State==1?'<span class="collapse e-icon">&nbsp;<\/span>':"")+t.buildTag("span.cellValue",u[e].Value)[0].outerHTML+"<\/td>",(u[e+this._rowCount].CSS!="rowheader"&&u[e+this._rowCount].CSS!="none"||u[e+this._rowCount].RowSpan<=1&&u[e].Value!=u[e+1].Value&&(u[e].Expander!=1||u[e+1].CSS!="summary rstot"))&&(s+="<\/tr>",n(k).append(s),s="<tr role='row'>"),(u[e+1].CSS=="colheader"||(u[e].CSS=="summary row"||u[e].CSS=="summary rstot"||u[e].CSS=="summary stot"||u[e].CSS=="summary")&&u[e].ColSpan>1||u[e+1].CSS=="rowheader"&&(u[e+1].Span=="Block"||u[0].ColSpan==1))&&(nt=n("<td style='padding: 0px'><\/td>"),l=n("<div class='rowhead' style='position: relative; float: left;display: inline-block'>"),n(d).append(k),n(l).append(d),n(nt).append(l),s="<tr>")):u[e].CSS!="colheader"&&(s=s+"<td"+(u[e].CSS=="none"?"":' class="'+u[e].CSS)+'" p='+u[e].Index+" colspan="+u[e].ColSpan+" rowspan="+u[e].RowSpan+" role='gridcell'"+(u[e].i==null?"":"i="+u[e].i)+">"+(u[e].State==2?'<span class="expand e-icon">&nbsp;<\/span>':u[e].State==1?'<span class="collapse e-icon">&nbsp;<\/span>':"")+t.buildTag("span.cellValue",u[e].Value)[0].outerHTML+"<\/td>",u.length-1>e&&u[e+1].CSS=="colheader"&&u[e-1].CSS!="colheader"&&u[e-1].CSS!="none"&&u[e].CSS!="summary value"&&u[0].Value==""&&(s+="<\/tr>",n(p).append(s),s="<tr role='row'>")),u[e].RowSpan>1&&u[e].ColSpan<=1)for(o=e+1;o<e+u[e].RowSpan;o++)u[o].Span="Block";else if(u[e].ColSpan>1&&u[e].RowSpan<=1)for(o=e+this._rowCount;o<e+u[e].ColSpan*this._rowCount;o=o+this._rowCount)u[o].Span="Block";else if(u[e].ColSpan>1&&u[e].RowSpan>1)for(o=e;o<e+u[e].RowSpan;o++){for(c=o+this._rowCount;c<o+u[e].ColSpan*this._rowCount;c=c+this._rowCount)u[c].Span="Block";o!=e&&(u[o].Span="Block")}s+="<\/tr>";n(p).append(s)}var ft=n("<td style='padding: 0px' colspan="+u.length/this._rowCount+" ><\/td>"),tt=n(t.buildTag("div.colhead").css({position:"relative",overflow:"hidden"})[0].outerHTML),st=n("<colgroup><\/colgroup>");n(it).append(b);n(tt).append(it);n(ft).append(tt);var a=n(t.buildTag("div#colmovable").css({float:"left"})[0].outerHTML),v=n(t.buildTag("div#colfreeze").css({float:"left"})[0].outerHTML),et=n("<table><\/table>");n(h).children().length==0&&(h=n("<tr role='row'><\/tr>"));n(h).length>0&&(n(a).append(tt),n(v).append(n("<table id='colfretable'><\/table>").append(h)));h=n("<tr role='Row' id='row1'><\/tr>");var ot=n("<td style='padding: 0px'><\/td>"),w=n(t.buildTag("div#rowvaluecontent")[0].outerHTML),y=n(t.buildTag("div.valueCell").css({position:"relative",float:"left"})[0].outerHTML);n(g).append(p);n(y).append(g);n(et).append(n(h).append(nt,ot));rt=n(t.buildTag("div#scrollContent")[0].outerHTML);this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders?n(f).append(n(rt).append(n("<div><\/div>").append(this.model.enableRTL?n("<div id='coltable'><\/div>").append(a,y):n("<div id='coltable'><\/div>").append(v,l),this.model.enableRTL?n(w).append(n("<div><\/div>").append(v,l)):n(w).append(a,y)))):n(f).append(this.model.enableRTL?n("<div id='coltable'><\/div>").append(a,v):n("<div id='coltable'><\/div>").append(v,a),this.model.enableRTL?n(w).append(n("<div><\/div>").append(y,l)):n(w).append(n("<div><\/div>").append(l,y)))},_applyFrozenHeaderWidth:function(i,u){var e=n("<colgroup><\/colgroup>"),f,o;if(!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders){for(this.element.find("#coltable").width(this.element.width()).css("overflow","hidden"),f=0;f<n("#rowvaluecontent").find("tr:first").find("td, th").length;f++)o="<col style='width:"+Math.max(this.element.find(".pivotGridColValueTable").find("[p^='"+f+"']").length>0?parseInt(this.element.find(".pivotGridColValueTable").find("[p^='"+f+"']").attr("colspan"))>1&&f!=0?this.element.find(".pivotGridColValueTable").find("[p^='"+f+"']").eq(-2)[0].offsetWidth:this.element.find(".pivotGridColValueTable").find("[p^='"+f+"']")[0].offsetWidth:0,this.element.find(".pivotGridRowValueTable").find("[p^='"+f+"']")[0].offsetWidth)+"px'><\/col>",e.append(o);this.element.find(".pivotGridRowValueTable, .pivotGridColValueTable").append(e).css({"table-layout":"fixed"});this.element.find("#coltable").find("tr:first").find("th:first").width(this.element.find("#rowvaluecontent").find("tr:first").find("th:eq(0)").width()*parseInt(this.element.find("#coltable").find("tr:first").find("th:first").attr("colspan")))}else{for(f=this.layout().toLowerCase()!="excellikelayout"?i[0].ColSpan:this.getJSONRecords()[0].ColSpan;f<(this.layout().toLowerCase()!="excellikelayout"||this._excelLikeJSONRecords==null||this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?i.length/this._rowCount:this._excelLikeJSONRecords.length/this._rowCount+this.getJSONRecords()[0].ColSpan-1);f++)o="<col style='width:"+(Math.max(this.element.find(".pivotGridValueTable").find("[p^='"+f+"']")[0].offsetWidth,parseInt(n(this.element.find(".pivotGridFrozenTable").find("[p^='"+f+"']")[0]).attr("colspan"))>1?parseInt(n(this.element.find(".pivotGridFrozenTable").find("[p^='"+f+"']").last()).attr("colspan"))>1?n(this.element.find(".pivotGridFrozenTable").find("[p^='"+f+"']")).eq(-2)[0].offsetWidth:this.element.find(".pivotGridFrozenTable").find("[p^='"+f+"']").last()[0].offsetWidth:this.element.find(".pivotGridFrozenTable").find("[p^='"+f+"']")[0].offsetWidth)+10)+"px'><\/col>",e.append(o);this.element.find(".pivotGridValueTable, .pivotGridFrozenTable").append(e).css({"table-layout":"fixed"});this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&(this.element.find("#colfreeze").removeAttr("style"),this.element.find("#coltable").css("float","left"),this.element.find("#rowvaluecontent").css({float:"left",width:this.element.width()-this.element.find("#coltable").width()-1}));this.element.find(".rowhead").height(this.element.find(".pivotGridValueTable").height()>this.element.height()-this.element.find(".colhead").height()?this.element.height()-this.element.find(".colhead").height():this.element.find(".pivotGridValueTable").height());this.element.find(".colhead").width(this.element.width()-this.element.find(".rowhead").width()-1);this.element.find(".valueCell").width(this.element.width()-this.element.find(".rowhead").width()-3);this.element.find("#colfretable").css({width:this.element.find(".rowhead").width(),height:this.element.find(".colhead").height()+1});this.model.enableRTL&&(this.element.find(".pivotGridRowTable, .rowhead").width(this.element.find("#colfretable").width()+3),this.element.find(".rowhead").css("float","none"))}this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&u!=r&&(this.element.find(".valueCell").removeAttr("style").css({position:"relative",overflow:"hidden"}),this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&(this.element.find(".valueCell").width(this.element.width()-this.element.find(".rowhead").width()-1),this.element.find(".colhead").width(this.element.width()-this.element.find(".rowhead").width()-1)));this.model.enableGroupingBar&&(this.element.find(".groupingBarPivot, .columns").css({width:"","min-width":""}),this.element.find("#rowvaluecontent").width(n(".groupingBarPivot").width()),this.element.find(".values").width(this.element.find(".rowhead").width()>this.element.find(".grpRow")[0].offsetWidth?this.element.find(".rowhead").width():this.element.find(".grpRow")[0].offsetWidth),this.element.find(".colhead, .valueCell").width(this.element.find(".valueColumn").width()-this.element.find(".values").width()-2),this.element.find(".rowhead, .pivotGridRowTable").width(this.element.find(".grpRow")[0].offsetWidth),this._dataModel=="XMLA"&&this.element.find("#colfretable").width(this.element.find(".grpRow")!=[]?this.element.find(".grpRow")[0].offsetWidth:this.element.find(".emptyRows")[0].offsetWidth),this.element.find(".colhead, .pivotGridFrozenTable").height(this.element.find(".grpRow")[0].offsetHeight));this._refreshScroller()},_refreshScroller:function(){!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders?this.element.find("#rowvaluecontent").ejScroller({height:this.element.height()-this.element.find("#coltable").height(),width:this.element.width(),targetControl:this,scroll:this._applyScroll,autoHide:!0,enableRTL:this.model.enableRTL}):this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders?this.element.find("#scrollContent").ejScroller({height:this.element.height(),width:this.element.width(),targetControl:this,scroll:this._applyScroll,autoHide:!0,enableRTL:this.model.enableRTL}):this.element.find("#rowvaluecontent").ejScroller({width:this.element.find("#rowvaluecontent").width(),height:this.element.find(".rowhead").height(),targetControl:this,scroll:this._applyScroll,autoHide:!0,enableRTL:this.model.enableRTL});scrollerObj=n(".e-scroller").ejScroller("instance");scrollerObj.refresh()},_applyScroll:function(n){n.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!n.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&n.scrollData.position=="Left"?n.model.targetControl.element.find("#coltable").scrollLeft(n.scrollLeft):n.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&!n.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders&&n.scrollData.position=="Left"?(n.model.targetControl.element.find(".valueCell").css("overflow","hidden"),n.model.targetPane=".valueCell",n.model.targetControl.element.find(".colhead").scrollLeft(n.scrollLeft)):(n.model.targetControl.element.find(".valueCell").css("overflow","hidden"),n.model.targetPane=".valueCell",n.model.targetControl.element.find(".colhead").scrollLeft(n.scrollLeft))},_cellRangeInfo:function(i){var w,c,l,f,s,e,r,p;n(i.target).hasClass("cellValue")&&(i.target=i.target.parentElement);var b=n("thead tr").length,h=[],a=0,u=n.grep(this.getJSONRecords(),function(t){return(t.CSS=="colheader"||t.CSS=="summary"||t.CSS==" calc")&&t.Index.split(",")[0]==n(i.target).attr("p").split(",")[0]}),o=n.grep(this.getJSONRecords(),function(t){return(t.CSS=="rowheader"||t.CSS=="summary"||t.CSS=="summary rstot")&&t.Index.split(",")[1]==n(i.target).attr("p").split(",")[1]});if(o.length==1&&u.length==1&&(o[0].Value.indexOf("Grand")>=0||u[0].Value.indexOf("Grand")>=0||u[0].CSS==" calc"))if(w=[],(u[0].Value.indexOf("Grand")>=0||u[0].CSS==" calc")&&o[0].Value.indexOf("Grand")>=0)for(r=0;r<this.model.dataSource.data.length;r++)h[r]=this.model.dataSource.data[r];else for(o[0].Value.indexOf("Grand")>=0?c=u[0].Value.indexOf("Total")>=0?u[0].Value.replace(" Total",""):u[0].Value:(u[0].Value.indexOf("Total")>=0||u[0].CSS==" calc")&&(c=o[0].Value.indexOf("Total")>=0?o[0].Value.replace(" Total",""):o[0].Value),r=0;r<this.model.dataSource.data.length;r++)n.each(this.model.dataSource.data[r],function(n,t){t==c&&(h[a]=this.model.dataSource.data[r],a++)});else if(o.length>=1&&u.length>=1&&(o[0].Value.indexOf("Total")>=0||u[0].Value.indexOf("Total")>=0)){for(o[0].Value.indexOf("Total")>=0?(c=u,l=o):u[0].Value.indexOf("Total")>=0&&(c=o,l=u),f=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.data:JSON.parse(this._dataSet),s=c.length-1;s>=0;s--){for(e=[],r=0;r<f.length;r++)n.each(f[r],function(n,t){t==c[s].Value&&e.push(f[r])});f=e}if(h=e,l[0].Value.indexOf("Grand")<=0)for(e=[],r=0;r<f.length;r++)n.each(f[r],function(n,t){t==l[0].Value.replace(" Total","")&&(h=[],e.push(f[r]))});h=h.length==0?e:h}else{var v=o,y=u,f=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.data:JSON.parse(this._dataSet);for(s=v.length-1;s>=0;s--){for(e=[],r=0;r<f.length;r++)n.each(f[r],function(n,t){t==v[s].Value&&e.push(f[r])});f=e}for(s=y.length-1;s>=0;s--){for(e=[],r=0;r<f.length;r++)n.each(f[r],function(n,t){t==y[s].Value&&e.push(f[r])});f=e}h=h.length==0?e:h}this.model.cellDoubleClick!=null&&(p={selectedData:h,element:this.element,customObject:this.model.customObject},this._trigger("cellDoubleClick",p))},_initCellEditing:function(i){if(i.target.tagName=="INPUT"||n(i.target).hasClass("summary")||n(i.target).parent().hasClass("summary"))this._off(this.element,"mouseup",".value",this._completeCellEditing);else{this._on(this.element,"mouseup",".value",this._completeCellEditing);var r;_oriX=i.pageX;_oriY=i.pageY;r=i.target||window.event.srcElement;n(r).hasClass("cellValue")&&(r=n(r).parent()[0]);n(".value").addClass("selection");n("#"+this._id).append(t.buildTag("div.cellSelection#"+this._id+"_cellSelection","",{}));_startPosCell=n(r)[0].attributes.getNamedItem("p").value;this._on(this.element,"mousemove",".value, .cellSelection",this._cellSelection)}},_completeCellEditing:function(i){var a,l,b=[],s,y,h,ut,e,o,g,p,nt,it,w,v,f,c,u,tt,rt;if(i.target.tagName!="INPUT"){if(this._off(this.element,"mousemove",".value"),n(".value").removeClass("selection"),a=i.target||window.event.srcElement,n(a).hasClass("cellValue")&&(a=n(a).parent()[0]),l=n(a)[0].attributes.getNamedItem("p").value,h=0,ut=this.element.find(".curInput"),ut.length>0)return n(a).find(".curInput").length==0&&this._updateTableCell(),n("#"+this._id+"_cellSelection").remove(),this.model.enableToolTip&&this._on(this.element,"mousemove",".value",this._applyToolTip),this._off(this.element,"mouseup",".value"),!1;for(e=parseInt(_startPosCell.split(",")[1])<parseInt(l.split(",")[1])?parseInt(_startPosCell.split(",")[1]):parseInt(l.split(",")[1]);e<=(parseInt(_startPosCell.split(",")[1])>parseInt(l.split(",")[1])?parseInt(_startPosCell.split(",")[1]):parseInt(l.split(",")[1]));e++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||n("#"+this._id).find("td[p*=',"+e+"']").parent().is(":visible"))for(o=parseInt(_startPosCell.split(",")[0])<parseInt(l.split(",")[0])?parseInt(_startPosCell.split(",")[0]):parseInt(l.split(",")[0]);o<=(parseInt(_startPosCell.split(",")[0])>parseInt(l.split(",")[0])?parseInt(_startPosCell.split(",")[0]):parseInt(l.split(",")[0]));o++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||n("#"+this._id).find("[p*='"+o+",']").last("th").is(":Visible")){b[h]=this.getJSONRecords()[o*this._rowCount+e];n("[p='"+o+","+e+"']").hasClass("summary")||(n("[p='"+o+","+e+"'] span.cellValue").length>0?(g=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?n("[p='"+o+","+e+"'] span.cellValue").text()!=""?n("[p='"+o+","+e+"'] span.cellValue").text():n(".curInput").val():n("[p='"+o+","+e+"'] span.cellValue").text(),n("[p='"+o+","+e+"'] span.cellValue").html("<input type='text' class='curInput' value='"+g+"' />")):n("[p='"+o+","+e+"']").children().length>0?n("[p='"+o+","+e+"']").append("<input type='text' class='curInput' value='' />"):(g=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?n("[p='"+o+","+e+"']").text()!=""?n("[p='"+o+","+e+"']").text():n(".curInput").val():n("[p='"+o+","+e+"']").text(),n("[p='"+o+","+e+"']").html("<input type='text' class='curInput' value='"+g+"' />")));var k,d="",et,ot,ft=0;if(s=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this.element.find(".summary[role!='gridcell'][p$=',"+n(a).attr("p").split(",")[1]+"'] , .rowheader[role!='gridcell'][p$=',"+n(a).attr("p").split(",")[1]+"']").last().attr("p"):this.element.find(".summary[role!='gridcell'][p$=',"+e+"'] , .rowheader[role!='gridcell'][p$=',"+e+"']").last().attr("p"),s==r&&(s=n("#"+this._id).find("tbody").find('[p="'+o+","+e+'"]').parent("tr").find(".summary").first().attr("p")),et=s,s!=null){while(s[0]>=0)s==this.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*this._rowCount+parseInt(s.split(",")[1]))].Index&&(k=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*this._rowCount+parseInt(s.split(",")[1]))].Info.split("::")[0]:this.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*this._rowCount+parseInt(s.split(",")[1]))].Value,s=parseInt(s.split(",")[0])-1+","+parseInt(s.split(",")[1])),d&&k!=""?d=k+"#"+d:k!=""&&(d=k);if(this._rowHeader[h]=d,f=this._rowHeader[h].toString().split("#"),f.length>1){for(u=0;u<f.length-1;u++)for(c=0;c<f[u].split(".").length;c++)if(f[u].split(".")[c]==f[u+1].split(".")[c]&&f[u].split(".")[c+1]==f[u+1].split(".")[c+1]){f.splice(u,1);break}for(this._rowHeader[h]="",u=0;u<f.length;u++)this._rowHeader[h]+=this._rowHeader[h]==""?f[u]:"#"+f[u]}}for(p="",it=this.element.find('tr:has(".colheader")').length-1,ot=it,y=b[h].Index,y!=r&&y==this.getJSONRecords()[parseInt(parseInt(y.split(",")[0])*this._rowCount+parseInt(y.split(",")[1]))].Index&&(w=parseInt(y.split(",")[0])),v=0;v<=it;v++)w!=null&&w+","+v==this.getJSONRecords()[parseInt(parseInt(w)*this._rowCount+v)].Index&&(nt=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.getJSONRecords()[parseInt(parseInt(w)*this._rowCount+v)].Info.split("::")[0]:this.getJSONRecords()[parseInt(parseInt(w)*this._rowCount+v)].Value,p==""?p=nt:nt!=""&&(p=p+"#"+nt)),this._colHeader[h]=p;if(f=this._colHeader[h].split("#"),f.length>1){for(u=0;u<f.length-1;u++)for(c=0;c<f[u].split(".").length;c++)if(f[u].split(".")[c]==f[u+1].split(".")[c]&&f[u].split(".")[c+1]==f[u+1].split(".")[c+1]){f.splice(u,1);break}for(this._colHeader[h]="",u=0;u<f.length;u++)this._colHeader[h]+=this._colHeader[h]==""?f[u]:"#"+f[u]}h++}for(this._originalValue="",this._cellInfo=b,tt=0;tt<this.element.find(".curInput").length;tt++)rt=this.element.find(".curInput")[tt],this._originalValue+=this._originalValue==""?rt.value:"#"+rt.value;args={JSONRecords:b,rowHeader:this._rowHeader,columnHeader:this._colHeader,measureCount:ft>0?"Row:"+ft:"Column:0"};this._trigger("cellSelection",args);b=rowHeader=colHeader=[];n("#"+this._id+"_cellSelection").remove();this.model.enableToolTip&&this._on(this.element,"mousemove",".value",this._applyToolTip);this._off(this.element,"mouseup",".value")}n(".curInput").keypress(function(t){if(t.which==13){var i=n(t.target).parents(".e-pivotgrid").data("ejPivotGrid");i._updateTableCell()}})},_updateTableCell:function(){var r="",f="",e=n(".curInput"),u,l,k,s,y,i;n.each(e,function(n,t){r+=r==""?t.value:"#"+t.value});var p=[],h=this._rowHeader,c=this._colHeader;for(f=r.split("#"),u=f.length-1;u>=0;u--)f[u]==this._originalValue.split("#")[u]?(h.splice(u,1),c.splice(u,1),f.splice(u,1),this._cellInfo.splice(u,1)):(p.push(this._originalValue.split("#")[u]),this._cellInfo[u].Value=f[u]=f[u]==""?"0":f[u]);for(p=p.reverse(),r="",i=0;i<f.length;i++)r+=r==""?f[i]:"#"+f[i];if(r.length==0){for(i=e.length-1;i>=0;i--)n(e[i]).closest("td").text(n(".curInput")[i].value);return!1}if(this._waitingPopup.show(),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)try{l=JSON.parse(this.getOlapReport()).Report}catch(g){l=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){(t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)||this.model.editCellsInfo.JSONRecords.length==0)&&(this.model.editCellsInfo={JSONRecords:[],rowHeader:[],columnHeader:[]});var d=this.model.editCellsInfo.rowHeader,o=this.model.editCellsInfo.columnHeader,w=this.model.editCellsInfo.JSONRecords,b=this._cellInfo;for(uV=0;uV<b.length;uV++){for(k=0,s=0;s<w.length;s++)if(d[s]==h[uV]&&o[s]==c[uV]){w[s].Value=b[uV].Value;k++;break}k==0&&(d.push(h[uV]),o.push(c[uV]),w.push(b[uV]))}if(this._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}),!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0)if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){var r="",a="",v="";for(n.each(this.model.editCellsInfo.JSONRecords,function(n,t){r=r==""?t.Value:r+":"+t.Value;a=a==""?t.Index:a+":"+t.Index;v=v==""?o[n].toString().split("#")[o[n].toString().split("#").length-1]:v+":"+o[n].toString().split("#")[o[n].toString().split("#").length-1]}),y=JSON.stringify({action:"cellEditing",index:a,valueHeaders:v,summaryValues:r,currentReport:l,customObject:JSON.stringify(this.model.customObject)}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.cellEditing,y,this._renderControlSuccess),i=e.length-1;i>=0;i--)n(e[i]).closest("td").text(n(e[i]).val())}else this._populatePivotGrid();else{for(i=e.length-1;i>=0;i--)n(e[i]).closest("td").text(t.isNullOrUndefined(this._originalValue.split("#")[i])?"":this._originalValue.split("#")[i]);this._ogridWaitingPopup.hide()}}else if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)if(this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"writeBack",element:this.element}),this.model.editCellsInfo.JSONRecords=this._cellInfo,this.model.editCellsInfo.rowHeader=h,this.model.editCellsInfo.columnHeader=c,this._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}),r="",!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0&&n.each(this.model.editCellsInfo.JSONRecords,function(n,t){r=r==""?t.Value:r+":"+t.Value}),y=JSON.stringify({action:"writeBack",value:r,rowUniqueName:JSON.stringify(this.model.editCellsInfo.rowHeader),columnUniqueName:JSON.stringify(this.model.editCellsInfo.columnHeader),currentReport:l,customObject:JSON.stringify(this.model.customObject)}),!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0)this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.writeBack,y,this._renderControlSuccess);else{for(i=e.length-1;i>=0;i--)n(e[i]).closest("td").text(t.isNullOrUndefined(this._originalValue.split("#")[i])?"":this._originalValue.split("#")[i]);this._ogridWaitingPopup.hide()}this._rowHeader=[];this._colHeader=[]},_createVirtualPivotGrid:function(n){var u=this._seriesPageCount>1?t.buildTag("div.vScrollPanel")[0].outerHTML:"",f=this._categPageCount>1?t.buildTag("div.hScrollPanel")[0].outerHTML:"",e=t.buildTag("td.virtualScrollGrid",n[0].outerHTML)[0],o=t.buildTag("td.virtualScrollElement",u),s=t.buildTag("td.virtualScrollElement",f),h=t.buildTag("tr.virtualScrollElement",e.outerHTML+o[0].outerHTML),c=t.buildTag("tr.virtualScrollElement",s[0].outerHTML+t.buildTag("td.virtualScrollElement")[0].outerHTML),l=t.buildTag("tbody.oGridOuterDiv.virtualScrollElement",h[0].outerHTML+c[0].outerHTML),i,r;this.element.html(t.buildTag("table.virtualScrollElement",l[0].outerHTML));i=t.buildTag("div.seriesPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("SeriesPage"))[0].outerHTML+t.buildTag("span.series_CurrentPage",this._seriesCurrentPage)[0].outerHTML+" / "+t.buildTag("span.series_pageCount",this._seriesPageCount)[0].outerHTML)[0].outerHTML;this._seriesPageCount>1&&this.element.append(i);r=t.buildTag("div.categPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("CategoricalPage"))[0].outerHTML+t.buildTag("span.categ_CurrentPage",this._categCurrentPage)[0].outerHTML+" / "+t.buildTag("span.categ_pageCount",this._categPageCount)[0].outerHTML)[0].outerHTML;this._categPageCount>1&&this.element.append(r)}});t.PivotGrid.Layout={Normal:"normal",NormalTopSummary:"normaltopsummary",NoSummaries:"nosummaries",ExcelLikeLayout:"excellikelayout"};t.PivotGrid.Locale={};t.PivotGrid.Locale["en-US"]={Sort:"Sort",SelectField:"select Field",LabelFilterLabel:"Show the items for which the label",ValueFilterLabel:"Show the items for which",LabelFilters:"Label Filters  ",BeginsWith:"Begins With",NotBeginsWith:"Not Begins With",EndsWith:"Ends With",NotEndsWith:"Not Ends With",Contains:"Contains",NotContains:"Not Contains",ValueFilters:"Value Filters",ClearFilter:"Clear Filter",Equals:"Equals",NotEquals:"Not Equals",GreaterThan:"Greater Than ",GreaterThanOrEqualTo:"Greater Than Or Equal To ",LessThan:"Less Than ",LessThanOrEqualTo:"Less Than Or Equal To ",Between:"Between",NotBetween:"Not Between",AddToFilter:"Add to Filter",AddToRow:"Add to Row",AddToColumn:"Add to Column",AddToValues:"Add to Values",Warning:"Warning",Error:"Error",GroupingBarAlertMsg:"The field you are moving cannot be placed in that area of the report",Measures:"Measures",Expand:"Expand",Collapse:"Collapse",ToolTipRow:"Row",ToolTipColumn:"Column",ToolTipValue:"Value",NoValue:"No value",SeriesPage:"Series Page",CategoricalPage:"Categorical Page",DragFieldHere:"Drag field here",ColumnArea:"Drop column here",RowArea:"Drop row here",ValueArea:"Drop values here",Close:"Close",OK:"OK",Cancel:"Cancel",Remove:"Remove",Goal:"Goal",Status:"Status",Trend:"Trend",Value:"value",ConditionalFormattingErrorMsg:"The given value is not matched",ConditionalFormattingConformMsg:"Are you sure you want to remove the selected format?",EnterOperand1:"Enter Operand1",EnterOperand2:"Enter Operand2",ConditionalFormatting:"Conditional Formatting",Condition:"Conditional Type",Value1:"Value1",Value2:"Value2",Editcondtion:"Edit Condition",AddNew:"Add New",Format:"Format",Backcolor:"Back Color",Borderrange:"Border Range",Borderstyle:"Border Style",Fontsize:"Font Size",Fontstyle:"Font Style",Bordercolor:"Border Color",NoMeasure:"Please add any measure",AliceBlue:"AliceBlue",Black:"Black",Blue:"Blue",Brown:"Brown",Gold:"Gold",Green:"Green",Lime:"Lime",Maroon:"Maroon",Orange:"Orange",Pink:"Pink",Red:"Red",Violet:"Violet",White:"White",Yellow:"Yellow",Solid:"Solid",Dashed:"Dashed",Dotted:"Dotted",Double:"Double",Groove:"Groove",Inset:"Inset",Outset:"Outset",Ridge:"Ridge",None:"None",Algerian:"Algerian",Arial:"Arial",BodoniMT:"Bodoni MT",BritannicBold:"Britannic Bold",Cambria:"Cambria",Calibri:"Calibri",CourierNew:"Courier New",DejaVuSans:"DejaVu Sans",Forte:"Forte",Gerogia:"Gerogia",Impact:"Impact",SegoeUI:"Segoe UI",Tahoma:"Tahoma",TimesNewRoman:"Times New Roman",Verdana:"Verdana",CubeDimensionBrowser:"Cube Dimension Browser",SelectHierarchy:"Select Hierarchy",CalculatedField:"Calculated Field",Name:"Name:",Add:"Add",Formula:"Formula:",Delete:"Delete",Fields:"Fields:",CalculatedFieldNameNotFound:"Given CalculatedField name is not found",InsertField:"Insert Field",EmptyField:"Please enter Calculated field name or formula",NotValid:"Given formula is not valid",NotPresent:"Value field used in any of the Calculated Field formula is not present in the PivotGrid",Confirm:"Calculated field with the same name already exists. Due to want to Replace ?",CalcValue:"Calculated field can be inserted only in value area field"};t.PivotGrid.ExportOptions={Excel:"excel",Word:"word",PDF:"pdf",CSV:"csv"};t.PivotGrid.ConditionalOptions={Equals:"Equals",NotEquals:"Not Equals",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between"};t.PivotGrid.AnalysisMode={Olap:"olap",Relational:"relational"};t.PivotGrid.OperationalMode={ClientMode:"clientmode",ServerMode:"servermode"};t.olap.base&&n.extend(t.PivotGrid.prototype,t.olap.base);t.olap._mdxParser&&n.extend(t.PivotGrid.prototype,t.olap._mdxParser)})(jQuery,Syncfusion)});
