/*!
*  filename: ej.treemap.min.js
*  version : 13.2.0.34
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min"],n):n()})(function(){(function(n,t,i){var r;t.widget({ejTreeMap:"ej.datavisualization.TreeMap"},{validTags:["div"],defaults:{leafItemSettings:{borderThickness:1,borderBrush:"white",showLabels:!1,labelPath:null,itemTemplate:null,labelPosition:"topleft",labelVisibilityMode:"visible"},dataSource:null,groupColorMapping:[],enableDrillDown:!1,drillDownHeaderColor:null,drillDownSelectionColor:"#000000",colorValuePath:null,weightValuePath:null,treeMapItems:[],showLegend:!1,borderBrush:"white",borderThickness:1,enableResize:!0,itemsLayoutMode:"squarified",levels:[],legendSettings:{template:"",iconHeight:15,iconWidth:15,height:30,width:100,dockPosition:"top"},rangeColorMapping:[],uniColorMapping:{color:null},desaturationColorMapping:{from:0,to:0,color:"",rangeMinimum:0,rangeMaximum:0},paletteColorMapping:{colors:[]},highlightOnSelection:!1,highlightGroupOnSelection:!1,showTooltip:!1,tooltipTemplate:null,highlightBorderThickness:5,highlightGroupBorderThickness:4,highlightBorderBrush:"gray",highlightGroupBorderBrush:"gray"},dataTypes:{dataSource:"data",treeMapItems:"array",levels:"array",rangeColorMapping:"array",paletteColorMapping:"object",groupColorMapping:"array"},observables:["dataSource","colorValuePath","weightValuePath","showLegend","enableResize","highlightOnSelection","highlightGroupOnSelection","enableDrillDown","drillDownHeaderColor","drillDownSelectionColor","showTooltip","highlightBorderThickness","highlightBorderBrush","itemsLayoutMode","leafItemSettings.borderThickness","leafItemSettings.borderBrush","leafItemSettings.showLabels","leafItemSettings.labelPath","legendSettings.iconWidth","legendSettings.iconHeight","legendSettings.dockPosition","legendSettings.height","legendSettings.width","uniColorMapping.color","desaturationColorMapping.from","desaturationColorMapping.to","desaturationColorMapping.color","desaturationColorMapping.rangeMinimum","desaturationColorMapping.rangeMaximum"],_tags:[{tag:"levels",attr:["groupPath","groupGap","headerHeight","showHeader","groupPadding","groupBackground","groupBorderColor","groupBorderThickness"],singular:"level"},{tag:"rangeColorMapping",attr:["color","legendLabel","from","to"],singular:"rangeColor"},{tag:"groupColorMapping",attr:["groupID",{tag:"groupColorMapping.rangeColorMapping",attr:["color","legendLabel","from","to"],singular:"groupRangeColor"},"uniColorMapping.color","desaturationColorMapping.from","desaturationColorMapping.to","desaturationColorMapping.color","desaturationColorMapping.rangeMinimum","desaturationColorMapping.rangeMaximum"],singular:"groupColor"}],dataSource:t.util.valueFunction("dataSource"),colorValuePath:t.util.valueFunction("colorValuePath"),weightValuePath:t.util.valueFunction("weightValuePath"),showLegend:t.util.valueFunction("showLegend"),enableResize:t.util.valueFunction("enableResize"),highlightOnSelection:t.util.valueFunction("highlightOnSelection"),highlightGroupOnSelection:t.util.valueFunction("highlightGroupOnSelection"),enableDrillDown:t.util.valueFunction("enableDrillDown"),drillDownHeaderColor:t.util.valueFunction("drillDownHeaderColor"),drillDownSelectionColor:t.util.valueFunction("drillDownSelectionColor"),showTooltip:t.util.valueFunction("showTooltip"),highlightBorderThickness:t.util.valueFunction("highlightBorderThickness"),itemsLayoutMode:t.util.valueFunction("itemsLayoutMode"),highlightBorderBrush:t.util.valueFunction("highlightBorderBrush"),borderThickness:t.util.valueFunction("leafItemSettings.borderThickness"),borderBrush:t.util.valueFunction("leafItemSettings.borderBrush"),showLabels:t.util.valueFunction("leafItemSettings.showLabels"),labelPath:t.util.valueFunction("leafItemSettings.labelPath"),iconWidth:t.util.valueFunction("legendSettings.iconWidth"),iconHeight:t.util.valueFunction("legendSettings.iconHeight"),dockPosition:t.util.valueFunction("legendSettings.dockPosition"),legendheight:t.util.valueFunction("legendSettings.height"),legendwidth:t.util.valueFunction("legendSettings.width"),itemTemplate:t.util.valueFunction("leafItemSettings.itemTemplate"),uniColor:t.util.valueFunction("uniColorMapping.color"),_color:t.util.valueFunction("desaturationColorMapping.color"),_from:t.util.valueFunction("desaturationColorMapping.from"),_to:t.util.valueFunction("desaturationColorMapping.to"),_rangeMinimum:t.util.valueFunction("desaturationColorMapping.rangeMinimum"),_rangeMaximum:t.util.valueFunction("desaturationColorMapping.rangeMaximum"),_initPrivateProperties:function(){this._svgDocument=null;this._templateDiv=null;this._legenddiv=null;this._drillHeaderDiv=null;this._drillHoverDiv=null;this._legendHeight=0;this._backgroundTile=null;this._tooltipSize={height:0,width:0};this._height=500;this._margintop=null;this._marginleft=null;this._initDiv=null;this._width=500;this._svgns="http://www.w3.org/2000/svg";this._prevSelectedItems=[];this._prevSelectedHeaders=[];this._isLevelColors;this.selectedItems==null&&(this.selectedItems=[]);this.treeMapItemSelected=null;this.treeMapGroupSelected=null;this._browser=null;this._header=null;this._toolTipElement=null;this._rootTreeMapItems=[];this.treemapgroups=[];this._drillHeader=null;this._drilldownItem=null;this._drilldownItems=[];this._treeMapHeaders=[];this._drillDownItemSelected=null;this._treeMapLabels=[];this._labelTemplateElements=[];this._itemGroups=[];this._prevSelectedGroupDatas=[]},_setModel:function(n){for(var t in n)switch(t){case"itemsLayoutMode":this.itemsLayoutMode(n[t]);this.refresh()}},_levels:function(){this.refresh()},_rangeColorMapping:function(){this._setColorMappings(this._rootTreeMapItems,this.model)},_groupColorMapping:function(){this._setColorMappings(this._rootTreeMapItems,this.model)},_groupColorMapping_rangeColorMapping:function(){this._setColorMappings(this._rootTreeMapItems,this.model)},_init:function(){this._initPrivateProperties();var t=n("<style>.drillGroupRect:hover{ background-color:"+this.drillDownSelectionColor()+";}<\/style>");n("html > head").append(t);this._levelInitialize();this.refresh()},_destroy:function(){n(this.element).removeClass("e-treemap e-js").find().remove(".tooltipelement");n(this.element).empty()},_levelInitialize:function(){var t=this;this.model.levels!=null?n.each(this.model.levels,function(i,u){u=t._checkArrayObject(u,i);var f=new r;n.extend(f,u);n.extend(u,f)}):this.levels.treeMapLevel=new r;n(document).click({treeMap:this},this._docClickFunction)},_checkArrayObject:function(t,i){var u=this;return n.each(t,function(n,t){if(t instanceof Array)u._checkArrayObject(t,n);else if(t!=null&&typeof t=="object"){var f=new r;u._loadIndividualDefaultValues(t,f,typeof n=="number"?i:n)}}),t},_loadIndividualDefaultValues:function(t,i,r){var u=null,f=this;return n.each(i,function(n,t){if(r==n){u=t;return}}),u instanceof Array&&(u=u[0]),n.each(t,function(n,t){t instanceof Array?f._checkArrayObject(t,r):t!=null&&typeof t=="object"&&f._loadIndividualDefaultValues(t,t,typeof n=="number"?r:n)}),n.extend(u,t),n.extend(t,u),t},refresh:function(){var i;this._drilldownItems.length==0&&this._initPrivateProperties();n(this.element).empty();this._svgDocument!=null&&n(this._svgDocument).empty();this._height=this.element.height();this._width=this.element.width();this._height==0&&(this._height=this.element[0].parentElement.clientHeight!=0?this.element[0].parentElement.clientHeight:n(document).height());this._width==0&&(this._width=this.element[0].parentElement.clientWidth!=0?this.element[0].parentElement.clientWidth:n(document).width());this.showLegend()&&this._sizeCalculation();var r=jQuery.uaMatch(navigator.userAgent),u=r.browser.toLowerCase(),f=!!navigator.userAgent.match(/Trident\/7\./);if(this._browser=u,n(this.element).css({position:"relative"}),this._height!=0&&this._width!=0){if(this._templateDiv=n("<div class='_templateDiv'><\/div>"),this._templateDiv.css({"pointer-events":"none",overflow:"hidden",float:"left","z-index":"2",height:this._height,width:this._width,"margin-top":this._margintop,"margin-left":this._marginleft,position:"absolute",left:"0",top:"0"}),this.enableDrillDown()&&this._drilldownItems.length==0&&(this._drillHeaderDiv=n("<div class='_drillHeaderDiv'><\/div>"),this._drillHeaderDiv.css({overflow:"hidden",float:"left","z-index":"3",position:"absolute",left:"0",top:"0"}),this._drillHoverDiv=n("<div class='_drillHoverDiv'><\/div>"),this._drillHoverDiv.css({overflow:"hidden",float:"left","z-index":"3",height:this._height-30,width:this._width,position:"absolute",left:"0",top:"30px"})),this._backgroundTile=n('<div id="backgroundTile" style="overflow:hidden;z-index:0;"><\/div>'),this.showLegend()&&this.model.legendSettings!=null&&this._renderLegend(),this.dataSource()!=null)if(this._drilldownItems.length>0){if(this.enableDrillDown()&&this.model.levels.length>=1&&(this._drilldownItem!=null||this._drilldownItem==null)){for(i=0;i<this._drillHeaderDiv[0].children[0].children.length;i++)this._drillHeaderDiv[0].children[0].children[i].className=="e-drilldownlabel"&&(header=this._drillHeaderDiv[0].children[0].children[i].innerHTML);this._backgroundTile[0].innerHTML="";this._drillHeaderDiv[0].innerHTML="";this._templateDiv[0].innerHTML="";this._drillHoverDiv[0].innerHTML="";this._drillDownHeader(header,!0);this._groupdrillDownLevels(this._drilldownItems[this._drilldownItems.length-1],this._drilldownItems.length)}this.showLegend()&&this._generateLegend();this._generateToolTip()}else this.model.dataSource instanceof t.DataManager?this._processOData(this):this._renderTreeMap(this.dataSource());this.enableResize()&&this._on(n(window),"resize",this._treeMapResize)}this._selectItemResize()},_renderTreeMap:function(n){this._groupLevels(n);this.showLegend()&&this._generateLegend();this._generateToolTip();this._renderLabels()},_renderLegend:function(){this._legenddiv=n("<div class='LegendDiv'/>");this._legenddiv.appendTo(this.element);this.dockPosition()==t.datavisualization.TreeMap.DockPosition.Bottom?this._legenddiv.css({"pointer-events":"none",overflow:"hidden",position:"absolute","z-index":"2",height:this.legendheight(),width:this.legendwidth(),"margin-top":this._height}):this.dockPosition()==t.datavisualization.TreeMap.DockPosition.Top?this._legenddiv.css({"pointer-events":"none",overflow:"hidden",position:"absolute","z-index":"2",height:this.legendheight(),width:this.legendwidth()}):this.dockPosition()==t.datavisualization.TreeMap.DockPosition.Left?this._legenddiv.css({"pointer-events":"none",overflow:"hidden",position:"absolute","z-index":"2",height:this.legendheight(),width:this.legendwidth()}):this.dockPosition()==t.datavisualization.TreeMap.DockPosition.Right?this._legenddiv.css({"pointer-events":"none",overflow:"hidden",position:"absolute","z-index":"2",height:this.legendheight(),width:this.legendwidth(),"margin-left":this._width}):this._legenddiv.css({"pointer-events":"none",overflow:"hidden",position:"absolute","z-index":"2",height:this.legendheight(),width:this.legendwidth()})},_processOData:function(n){var t=this,i=n.model.dataSource.executeQuery(n.model.query);i.done(function(n){n.result!=null&&t._renderTreeMap(n.result)})},_treeMapResize:function(n){n.preventDefault();n.stopPropagation();var t=this;this.resizeTO&&clearTimeout(this.resizeTO);this.resizeTO=setTimeout(function(){t.refresh()},500)},_groupLevels:function(n){var i=null,u,r,t,o,f,e;if(this.enableDrillDown()&&this._drillDownHeader(this.model.levels[0].groupPath,!1),u=this._getTopGroupitem(this.labelPath(),n,0),i=u,this.model.levels.length==0&&(t=this.model.leafItemSettings,this._rootTreeMapItems=u,this._getTopLevels(u[0].innerItems,t),this._generateTreeMapItems(u[0].innerItems,"gray",this.colorValuePath()),this.showLabels()&&this._generateLabels(u[0].innerItems,t)),this.model.levels.length>0)for(r=0;r<=this.model.levels.length;r++)if(t=this.model.levels[r],r!=0){if(o=i,f=this.model.levels[r-1],i=[],t==null&&(t=this.model.leafItemSettings),this._generateSubItems(o,t,i,f),this._rootTreeMapItems=i,this.enableDrillDown()){if(r==1)return this._generateTreeMapItems(i,"gray",f.DisplayPath),!1}else r==this.model.levels.length&&this._generateTreeMapItems(i,"gray",f.DisplayPath);this.showLabels()&&r==this.model.levels.length&&this._generateLabels(i,t)}else e=this._getGroupitem(t.groupPath,u[0].Data,t.headerHeight),this._rootTreeMapItems=e,this._getTopLevels(e,t),i=e},_groupdrillDownLevels:function(n,t){var u=null,o,i,r,s,f,e;if(t==this.model.levels.length-1?this._drillHoverDiv.css("pointer-events","none"):this._drillHoverDiv.css("pointer-events","auto"),this.model.levels.length>0)for(o=!1,i=0;i<this.model.levels.length;i++)r=this.model.levels[i],i!=0?(s=u,f=this.model.levels[i-1],u=[],r==null&&(r=this.model.leafItemSettings),i==t+1?this._generateSubItems(s,r,u,f,null,t+1!=i):this._generateSubItems(s,r,u,f,!0,t+1!=i),this._rootTreeMapItems=u,i!=t+1&&i!=this.model.levels.length-1||o||(this._generateTreeMapItems(u,"gray",f.DisplayPath),o=!0),t==this.model.levels.length-1&&i==t&&r.showLabels&&this._generateLabels(u,r)):(e=this._getGroupitem(r.groupPath,n.Data,r.headerHeight),this._rootTreeMapItems=e,this._getTopLevels(e,r),u=e);this.showLegend()&&this._generateLegend();this._renderLabels();this._trigger("drillDownItemSelected",{level:t,header:this._header,prevLevel:t-1})},_getTopLevels:function(n,i){var f=i.groupGap!=null?i.groupGap:0,e=this.itemsLayoutMode(),r=0,u=0;this.enableDrillDown()&&(u=30);this.showLegend()&&this.model.legendSettings!=null&&(r=r);this._legendHeight=r;this.enableDrillDown()&&(this._drillHeaderDiv.css({top:r}),this._drillHoverDiv.css({top:30+r}));e==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceHorizontal?this._calculateSliceAndDiceItemSize(n,0,r,this._width,this._height,f,u,!0,r):e==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceVertical?this._calculateSliceAndDiceItemSize(n,0,r,this._width,this._height,f,u,!1,r):e==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceAuto?this._calculateSliceAndDiceItemSize(n,0,r,this._width,this._height,f,u,null,r):this._calculateSquarifiedItemSize(n,0,r,this._width,this._height,f,u,r)},_generateSubItems:function(n,r,u,f,e,o){var h=f.groupPadding,s,c,l,v,p,y;h==""&&(h=0);var d=this.itemsLayoutMode(),g=n.length,w=r.groupPath;w==null&&(w=this.labelPath());w==null&&(w=this.weightValuePath());var b=r.groupGap!=null?r.groupGap:r.gap!=null?r.gap:0,k=(f.showHeader||f.showHeader==null)&&!this.enableDrillDown()?f.headerHeight:0,a=0;for(s=0;s<g;s++){if(c=this._getGroupitem(w,n[s].Data,r.headerHeight),d==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceHorizontal?this._calculateSliceAndDiceItemSize(c,n[s].LeftPosition+parseFloat(h),n[s].TopPosition+parseFloat(h),n[s].ItemWidth-(f.groupBorderThickness+2*parseFloat(h)),n[s].ItemHeight-(f.groupBorderThickness+2*parseFloat(h)),parseFloat(b),k,!0,0):d==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceVertical?this._calculateSliceAndDiceItemSize(c,n[s].LeftPosition+parseFloat(h),n[s].TopPosition+parseFloat(h),n[s].ItemWidth-(f.groupBorderThickness+2*parseFloat(h)),n[s].ItemHeight-(f.groupBorderThickness+2*parseFloat(h)),parseFloat(b),k,!1,0):d==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceAuto?this._calculateSliceAndDiceItemSize(c,n[s].LeftPosition+parseFloat(h),n[s].TopPosition+parseFloat(h),n[s].ItemWidth-(f.groupBorderThickness+2*parseFloat(h)),n[s].ItemHeight-(f.groupBorderThickness+2*parseFloat(h)),parseFloat(b),k,null,0):this._calculateSquarifiedItemSize(c,n[s].LeftPosition+parseFloat(h),n[s].TopPosition+parseFloat(h),n[s].ItemWidth-(f.groupBorderThickness+2*parseFloat(h)),n[s].ItemHeight-(f.groupBorderThickness+2*parseFloat(h)),parseFloat(b),k,0),l=this._rootTreeMapItems[s],l.headerHeight=f.headerHeight,l.showHeader=f.showHeader,l.headerWidth=n[s].ItemWidth,l.headerTemplate=f.headerTemplate,l.headerLeftPosition=n[s].LeftPosition,l.headerTopPosition=n[s].TopPosition,this.enableDrillDown()&&this._createBackGround(l,f,n[s],o),(f.showHeader||f.showHeader==null)&&(this.enableDrillDown()||(this._createBackGround(l,f,n[s]),this._generateHeaders(l,f))),n[s].ChildtreeMapItems=c,n[s].GroupingLevel=this.model.levels.indexOf(f)+1,this.model.levels.indexOf(f)==0){if(this.model.groupColorMapping!=null&&this.model.groupColorMapping.length>0)for(this._isLevelColors=!0,v=0;v<this.model.groupColorMapping.length;v++)p=this.model.groupColorMapping[v],p.groupID==l.header&&this._setColorMappings(c,p)}else if(this.model.levels.indexOf(f)>0&&this.model.groupColorMapping!=null&&this.model.groupColorMapping.length>0)for(v=0;v<this.model.groupColorMapping.length;v++)p=this.model.groupColorMapping[v],p.groupID==n[s].ParentHeader&&this._setColorMappings(c,p);for(y=0;y<c.length;y++)u[a]=c[y],c[y].backgroundColor==null&&(c[y].backgroundColor=n[s].backgroundColor),c[y].backgroundOpacity==null&&(c[y].backgroundOpacity=n[s].backgroundOpacity),(this.enableDrillDown()||u[a].ItemHeight<l.ItemHeight-l.headerHeight)&&(u[a].ParentHeader=l.header,u[a].ItemHeight-=h,u[a].ItemWidth-=h,u[a].LeftPosition+=f.groupBorderThickness,u[a].TopPosition+=f.groupBorderThickness),a++}e==i&&f.showLabels&&this._generateLabels(n,f)},_createBackGround:function(t,i,r,u){var f=n("<div />"),o=t.showHeader||t.showHeader==null||this.enableDrillDown()?t.ItemHeight-2*i.groupBorderThickness:0,h=t.showHeader||t.showHeader==null||this.enableDrillDown()?t.TopPosition:0,e,s;f.css({height:o+"px",width:t.ItemWidth-2*i.groupBorderThickness+"px",left:t.LeftPosition+"px",top:h+"px","border-style":"solid","border-width":i.groupBorderThickness+"px",position:"absolute"});i.groupBorderColor!=null&&f.css("border-color",i.groupBorderColor);i.groupBackground!=null&&f.css("background-color",i.groupBackground);this.treemapgroups.push(f);f.appendTo(this._backgroundTile);o=parseFloat(f[0].style.top)-30-this._legendHeight+"px";this.enableDrillDown()&&!u&&(e=n("<div class='drillGroupRect'/>"),e.css({height:f[0].style.height,width:f[0].style.width,left:f[0].style.left,top:o,position:"absolute",opacity:.2,display:"block"}),this._drillHoverDiv.append(e),n(e).mousedown({treemap:this,level:i,param1:r},this._headerClickFunction),n(e).mouseleave({treemap:this,param1:t.header},this._mouseLeaveFunction),s={data:t.Data,label:t.header,header:t.header},n(e).mousemove({treemap:this,hoverItem:s},this._mouseRectHoverFunction));n(f).mousedown({treemap:this,level:i,param1:r},this._headerClickFunction);n(f).mousemove({treemap:this,hoverItem:t.Data},this._mouseRectHoverFunction)},_mouseRectHoverFunction:function(t){var r=t.data.treemap,h=t.data.hoverItem,i,f,e,o,s,u;r.showTooltip()&&(i=r._toolTipElement,f=r.model.tooltipTemplate,i!=null&&f!=null&&(n(i).css({left:t.pageX+10,top:t.pageY+10,display:"block"}),e=n("#"+f).render(h),n(i).html(e),o=i[0]!=null?i[0].clientHeight:i.clientHeight,s=i[0]!=null?i[0].clientWidth:i.clientWidth,r._tooltipSize={height:o,width:s}),u=r._tooltipSize,u.width+t.pageX>=r._width&&(t.pageX-=u.width),u.height+t.pageY>=r._height&&(t.pageY-=u.height),i!=null&&n(i).css({left:t.pageX+10,top:t.pageY+10,display:"none"}))},_mouseLeaveFunction:function(t){var i=t.data.treemap;i.showTooltip()&&i._toolTipElement!=null&&n(i._toolTipElement).css("display","none")},_headerClickFunction:function(t){var f=t.data.level,r=t.data.param1,c=t.ctrlKey,i=t.data.treemap,h,o,e,s,u;if(i.highlightGroupOnSelection())if(i._browser!="msie"&&(h=i._backgroundTile[0].children[i._backgroundTile[0].children.length-0],i._backgroundTile[0].insertBefore(this,h)),c)n.inArray(this,i._prevSelectedHeaders)==-1?(n(this).css({"border-width":i.model.highlightGroupBorderThickness,"border-color":i.highlightBorderBrush()}),i._prevSelectedHeaders.push(this),i._prevSelectedGroupDatas.push(t.data.Param1)):(n(this).css({"border-width":f.groupBorderThickness,"border-color":f.groupBorderColor}),o=i._prevSelectedHeaders.indexOf(this),i._prevSelectedHeaders.splice(o,1),i._prevSelectedGroupDatas.splice(o,1));else{for(e=0;e<i._prevSelectedHeaders.length;e++)n(i._prevSelectedHeaders[e]).css({"border-width":f.groupBorderThickness,"border-color":f.groupBorderColor});n.inArray(this,i._prevSelectedHeaders)==-1?(n(this).css({"border-width":i.model.highlightGroupBorderThickness,"border-color":i.highlightBorderBrush()}),i._prevSelectedHeaders=[],i._prevSelectedHeaders.push(this)):i._prevSelectedHeaders=[];i._prevSelectedGroupDatas.push(t.data.Param1)}if(i.enableDrillDown()&&i.model.levels.length>1&&(i._drilldownItem!=null&&i._drilldownItem.header!=r.header||i._drilldownItem==null)){for(s="",u=0;u<i._drillHeaderDiv[0].children[0].children.length;u++)i._drillHeaderDiv[0].children[0].children[u].className=="e-drilldownlabel"&&(s=i._drillHeaderDiv[0].children[0].children[u].innerHTML);return i._backgroundTile[0].innerHTML="",i._labelTemplateElements=[],i._drillHeaderDiv[0].innerHTML="",i._templateDiv[0].innerHTML="",i._drillHoverDiv[0].innerHTML="",i._drillDownHeader(s+"."+r.header,!0),i._drilldownItem=r,i._drilldownItems.push(r),i._groupdrillDownLevels(r,i._drilldownItems.length),!1}},rectClick:function(t){var i=t.data.treemap,f=i.model.levels[0],h=t.ctrlKey,e,r,u,s,o;if(i.highlightGroupOnSelection()){for(e=0;e<i.treemapgroups.length;e++)if(r=i.treemapgroups[e],u=r[0].getBoundingClientRect(),u.left<t.clientX&&u.left+u.width>t.clientX&&u.top<t.clientY&&u.top+u.height>t.clientY){n(r).css({"border-width":i.model.highlightGroupBorderThickness,"border-color":i.highlightBorderBrush(),"box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"});break}if(h)n.inArray(r,i._prevSelectedHeaders)==-1?(n(r).css({"border-width":i.model.highlightGroupBorderThickness,"border-color":i.highlightBorderBrush()}),i._prevSelectedHeaders.push(r),i._prevSelectedGroupDatas.push(t.data.Param1)):(n(r).css({"border-width":f.groupBorderThickness,"border-color":f.groupBorderColor}),s=i._prevSelectedHeaders.indexOf(r),i._prevSelectedHeaders.splice(s,1),i._prevSelectedGroupDatas.splice(s,1));else{for(o=0;o<i._prevSelectedHeaders.length;o++)n(i._prevSelectedHeaders[o]).css({"border-width":f.groupBorderThickness,"border-color":f.groupBorderColor});n.inArray(r,i._prevSelectedHeaders)==-1?(n(r).css({"border-width":i.model.highlightGroupBorderThickness,"border-color":i.highlightBorderBrush()}),i._prevSelectedHeaders=[],i._prevSelectedHeaders.push(r)):i._prevSelectedHeaders=[];i._prevSelectedGroupDatas.push(t.data.Param1)}}i._trigger("treeMapGroupSelected",{selectedGroups:i._prevSelectedHeaders,orginalEvent:t})},_generateLabels:function(r,u){for(var f,b,y,tt,l,c,p,d,it,a,g,nt,v=0;v<r.length;v++){if(f=r[v],u.labelTemplate==null){var o=8,s=5,e=n('<label style="font-size:14px;font-weight:normal;font-family:Segoe UI;">'+f.label+"<\/label>");this.enableDrillDown()?n(e).css({position:"absolute",color:"black",overflow:"hidden",left:f.LeftPosition+o+"px",top:f.TopPosition+s+"px","font-weight":"normal","pointer-events":"none"}):n(e).css({position:"absolute",color:"white",overflow:"hidden",left:f.LeftPosition+o+"px",top:f.TopPosition+s+"px","font-weight":"normal","pointer-events":"none"});this._treeMapLabels.push(e);this._templateDiv.append(e);b=0;y=0;u.groupPadding!=i&&(b=u.groupPadding);u.groupBorderThickness!=i&&(y=u.groupBorderThickness);var k=e[0].getBoundingClientRect().width>0?e[0].getBoundingClientRect().width+b+y+2:f.label.length*8,k=k>f.ItemWidth-o/2?f.ItemWidth-o/2:k,h=e[0].getBoundingClientRect().height;if(h==0&&f.ItemHeight>18?h=18:h>0&&h>f.ItemHeight&&(h=f.ItemHeight-s),n(e).css({width:k+"px",height:h+"px"}),f.labelPosition=u.labelPosition,f.labelVisibilityMode=y,f.groupPadding=u.groupPadding,f.groupBorderThickness=u.groupBorderThickness,e[0].data=f,this._labelTemplateElements.push(e),tt=u.labelVisibilityMode,tt==t.datavisualization.TreeMap.VisibilityMode.HideOnExceededLength){l=n("<span>"+e[0].innerHTML+"<\/span>");n(document.body).append(l);c=l.outerWidth();p=l.outerHeight();l.remove();d=c>f.ItemWidth?c/f.ItemWidth:f.ItemWidth/c;var rt=d*p+2*o*d,ut=f.ItemHeight-2*s,w=!1;c>f.ItemWidth-o&&p<f.ItemHeight-s?rt<ut?n(e).css({display:"block","word-wrap":"break-word"}):w=!0:p>f.ItemHeight-2*s?w=!0:c>f.ItemWidth-o&&(w=!0);w&&n(e).css({display:"none"})}}u.labelTemplate!=null&&(it=n("#"+u.labelTemplate),a=n("<div style='overflow:hidden;display:block;position:absolute;pointer-events: none;'><\/div>"),a[0].data=f,f.labelPosition=u.labelPosition,f.labelVisibilityMode=u.labelVisibilityMode,g=n.templates(it.html()),nt="",nt=f.Data instanceof Array?g.render({data:f.Data}):g.render(f.Data),n(a).html(nt),this._templateDiv.append(a),this._labelTemplateElements.push(a))}},_generateToolTip:function(){var t,i,r;this.showTooltip()&&(t=document.documentMode==8?document.querySelectorAll("tooltipelement"):document.getElementsByClassName("tooltipelement"),t!=null&&t.length==0?(i=n("<div class='tooltipelement' style='display:none;position:absolute;z-index:1000;pointer-events:none;'><\/div>"),n(document.body).append(i),this._toolTipElement=i):this._toolTipElement=t[0],this.model.tooltipTemplate==null&&(r=this.labelPath()!=null?this.labelPath():this.weightValuePath(),r!=null&&(this.model.tooltipTemplate="defaultTooltip",this.element.append(n('<div id="defaultTooltip" style="display:none;"><div style="margin-left:10px;margin-top:-25px;"><div class="defaultToolTip"><p style="margin-top:-4px"><label  style="color:rgb(27, 20, 20);font-size:14px;font-weight:normal;font-family:Segoe UI">{{:#data["'+r+'"]}}<\/label><\/p><\/div><\/div><\/div>')))))},_generateLegend:function(){var i,o,r,s;if(this.model.rangeColorMapping!=null){var u=this.model.rangeColorMapping,t=10,f=10,e=this.model.legendSettings,h=e.template,c=n("<div/>");for(i=0;i<u.length;i++)o=h=="Ellipse"?this._getEllipseLegend(e,t,f):this._getRectLegend(e,t,f),n(o).css("background-color",u[i].color),o.appendTo(this._legenddiv),t+=this.iconWidth()+5,r=n("<div/>"),r.css({left:t+"px",top:f+"px",position:"absolute"}),n(r).css({"font-size":"15px"}),r[0].innerHTML=u[i].legendLabel,r.appendTo(this._legenddiv),s=this._calcWidth(u[i].legendLabel),t+=s+18,t+150>=this.legendwidth()&&(t=10,f+=40)}},_calcWidth:function(t){var i=n("<span>"+t+"<\/span>"),r;return n("body").append(i),r=i.width(),i.remove(),r},_getEllipseLegend:function(t,i,r){var u=n("<div class='e-mapLegend'/>");return u.css({height:this.iconHeight()+"px",width:this.iconWidth()+"px","border-radius":this.iconHeight()/2+"px",left:i+"px",top:r+"px",position:"absolute"}),u},_getRectLegend:function(t,i,r){var u=n("<div />");return u.css({height:this.iconHeight()+"px",width:this.iconWidth()+"px",left:i+"px",top:r+"px",position:"absolute"}),u},_getPositionFromParent:function(n,t){var i=n.getBoundingClientRect(),r=t.getBoundingClientRect(),u=window.SVGSVGElement?i.width:i.right-i.left,f=window.SVGSVGElement?i.height:i.bottom-i.top;return{left:i.left-r.left,top:i.top-r.top,height:f,width:u}},_renderLabels:function(){for(var r=0;r<this._labelTemplateElements.length;r++){var u=this._labelTemplateElements[r],f=this._getPositionFromParent(u[0],this._templateDiv[0]),i=u[0].data,e=this._getDockPositionPoint({left:i.LeftPosition,top:i.TopPosition,width:i.ItemWidth,height:i.ItemHeight},f,i);n(u).css({left:e.x,top:e.y,"pointer-events":"none",overflow:"hidden"});i.labelVisibilityMode==t.datavisualization.TreeMap.VisibilityMode.HideOnExceededLength&&(f.height>i.ItemHeight||f.width>i.ItemWidth)&&n(u).css("display","none")}},_generateHeaders:function(i,r){var a=r.headerVisibilityMode,e=!1,s=2,h=2,u,c,o,f,arguments,l;a==t.datavisualization.TreeMap.VisibilityMode.HideOnExceededLength?(u=n("<span>"+i.header+"<\/span>"),n(document.body).append(u),c=u.outerWidth(),u.remove(),i.headerHeight<i.ItemHeight-2*s&&c<i.ItemWidth-2*h&&(e=!0)):i.headerHeight<i.ItemHeight&&(e=!0);e&&(i.headerTemplate==null?(o=n('<div style="display:block;position:absolute;pointer-events: stroke;overflow: hidden;"><label style="font-size:15px;font-weight:normal;font-family:Segoe UI;">'+i.header+"<\/label><\/div>"),n(o).css({left:i.headerLeftPosition+s,top:i.headerTopPosition+h,width:i.headerWidth-r.groupPadding,height:i.headerHeight,"margin-left":r.groupPadding}),this._templateDiv.append(o)):(f=n("<div style='display:block;position:absolute;pointer-events: none;overflow: hidden;'><\/div>"),this._templateDiv.append(f),n(f).css({left:i.headerLeftPosition,width:i.headerWidth,top:i.headerTopPosition,height:i.headerHeight}),arguments={header:i.header,data:i.Data},l=n("#"+i.headerTemplate).render(arguments),n(f).html(l)))},_drillDownHeader:function(t,i){var r=n("<div class='e-drilldownHeader' style='display:block;overflow: hidden;'><div class='e-drilldownlabel' style='height:30px;position:absolute;margin-top: 5px;top: 0px;'>"+t+"<\/div><\/div>");i&&(r=n("<div class='e-drilldownHeader' style='display:block;overflow: hidden;'><svg class='e-drilldownarrow' style='width:15px;height:15px;margin-top: 10px;'><polyline points='8,0 8,10 0,5 8,0'/><\/svg><div class='e-drilldownlabel'  style='left:17px;position:absolute;height:30px;position:absolute;margin-top: 5px;top: 0px;'>"+t+"<\/div><\/div>"));n(r).css({left:"0px",width:this._width+"px",top:0,height:"30px",cursor:"pointer"});this.drillDownHeaderColor()!=null&&n(r).css("background-color",this.drillDownHeaderColor());this._drillHeaderDiv.append(r);n(r).mousedown({treemap:this},this._drilldownfunction);this._header=t},_drilldownfunction:function(n){var t=n.data.treemap,f,i,u,r;if(t._drilldownItems.length>0){if(t._drilldownItems.length==1)t._drilldownItems=[],t.refresh();else{for(f="",i=0;i<t._drillHeaderDiv[0].children[0].children.length;i++)t._drillHeaderDiv[0].children[0].children[i].className=="e-drilldownlabel"&&(f=t._drillHeaderDiv[0].children[0].children[i].innerHTML);for(u=f.split("."),t._drillHeaderDiv[0].innerHTML="",t._backgroundTile[0].innerHTML="",r="",i=0;i<u.length-1;i++)r=r+u[i],i!=u.length-2&&(r=r+".");t._labelTemplateElements=[];t._drillDownHeader(r,!0);t._drilldownItem=t._drilldownItems[t._drilldownItems.length-2];t._drilldownItems.pop(t._drilldownItems[t._drilldownItems.length-1]);t._templateDiv[0].innerHTML="";t._groupdrillDownLevels(t._drilldownItem,t._drilldownItems.length)}t._trigger("drillDownItemSelected",{level:t._drilldownItems.length,header:t._header,prevLevel:t._drilldownItems.length-1})}},_sizeCalculation:function(){this.model.legendSettings!=null&&(this.dockPosition()==t.datavisualization.TreeMap.DockPosition.Bottom?this._height=this._height-parseFloat(this.legendheight()):this.dockPosition()==t.datavisualization.TreeMap.DockPosition.Top?(this._height=this._height-parseFloat(this.legendheight()),this._width=this._width,this._margintop=parseFloat(this.legendheight())):this.dockPosition()==t.datavisualization.TreeMap.DockPosition.Left?(this._height=this._height,this._width=this._width-parseFloat(this.legendwidth()),this._marginleft=parseFloat(this.legendwidth())):this.dockPosition()==t.datavisualization.TreeMap.DockPosition.Right?(this._height=this._height,this._width=this._width-parseFloat(this.legendwidth())):(this._height=this._height,this._width=this._width))},_getDockPositionPoint:function(n,r,u){var o=u.labelPosition,e=2,f=2;return u.groupPadding!=i&&u.groupBorderThickness!=i&&(e=u.groupPadding+u.groupBorderThickness+e,f=u.groupPadding+u.groupBorderThickness+f),u.showHeader&&!this.enableDrillDown()&&(f=f+u.headerHeight),o==t.datavisualization.TreeMap.Position.TopCenter?e=n.width/2-r.width/2:o==t.datavisualization.TreeMap.Position.TopRight?e=n.width-r.width-e:o==t.datavisualization.TreeMap.Position.CenterLeft?f=n.height/2-r.height/2:o==t.datavisualization.TreeMap.Position.Center||o==null?(e=n.width/2-r.width/2,f=n.height/2-r.height/2):o==t.datavisualization.TreeMap.Position.CenterRight?(e=n.width-r.width-e,f=n.height/2-r.height/2):o==t.datavisualization.TreeMap.Position.BottomLeft?f=n.height-r.height-f:o==t.datavisualization.TreeMap.Position.BottomCenter?(e=n.width/2-r.width/2,f=n.height-r.height-f):o==t.datavisualization.TreeMap.Position.BottomRight&&(e=n.width-r.width-e,f=n.height-r.height-f),{x:n.left+e,y:n.top+f}},_generateTreeMapItems:function(t){var u,i,r;if(this._rootTreeMapItems=t,this._getTreeMapItemTemplate(t),t!=null){for(this._isLevelColors||this._setColorMappings(t,this.model),u=0;u<t.length;u++)i=t[u],r=i.rectangle,i.Data!=null&&i.Data.length>0&&(i.Data=i.Data[0]),i.Rectangle=r,i.backgroundColor!=null?n(r).css("background-color",i.backgroundColor):n(r).css("background-color","#E5E5E5"),i.backgroundOpacity!=null&&n(r).css("opacity",i.backgroundOpacity),this._wireEventForTreeMapItem(i,r);this.model.rangeColorMapping.length==0&&this.uniColor()==null&&this._color()!=""?this._setDesaturationColor(t,this.model.desaturationColorMapping):this.model.PaletteColorMapping!=null&&this._setPaletteColor(t,this.model.PaletteColorMapping)}},_wireEventForTreeMapItem:function(i,r){n(r).mouseenter({Param1:i,Param2:this},this._rectMouseEnter);n(r).mousemove({Param1:i,Param2:this},this._rectMouseMove);n(r).mouseleave({treeMap:this},this._rectMouseLeave);n(r).mouseup({treeMap:this},this._docClickFunction);this._on(n(r),t.eventType.mouseDown,{Param1:i.Data,rect:r},this._rectClickFunction)},_getTreeMapItemTemplate:function(t){for(var i,f,e,o,u="",r=0;r<t.length;r++)i=t[r],this.model.leafItemSettings.itemTemplate==null?u+='<div style="border-style:solid;position:absolute;left:'+i.LeftPosition+"px;top:"+i.TopPosition+"px;height:"+i.ItemHeight+"px;width:"+i.ItemWidth+"px;border-width:"+this.borderThickness()+"px;border-color:"+this.borderBrush()+'"><\/div>':(f=n("#"+this.model.leafItemSettings.itemTemplate),i.Data!=null&&i.Data.length==1&&(i.Data=i.Data[0]),e=n.templates(f.html()),o="<div style='overflow:hidden;position:absolute;left:"+i.LeftPosition+"px;top:"+i.TopPosition+"px;height:"+i.ItemHeight+"px;width:"+i.ItemWidth+"px'>"+e.render(i)+"<\/div>",u+=o);for(this._svgDocument!=null&&this.enableDrillDown()&&(this._svgDocument[0].innerHTML=""),this._svgDocument=n('<div style= "overflow:hidden;z-index:1;"id="svgDocument">'+u+"<\/div>"),this._backgroundTile.appendTo(this.element),this._svgDocument.appendTo(this.element),this._svgDocument.css({height:this._height+"px",width:this._width+"px","margin-top":this._margintop+"px","margin-left":this._marginleft,overflow:"hidden","z-index":1,position:"absolute",left:"0",top:"0"}),n(this._backgroundTile).css({height:this._height+"px",width:this._width+"px","margin-top":this._margintop+"px","margin-left":this._marginleft,overflow:"hidden","z-index":0,position:"absolute",left:"0",top:"0"}),this._templateDiv.appendTo(this.element),n(this._templateDiv).mousemove({Param2:this},this._rectMouseMove),n(this.element).mousedown({treemap:this},this.rectClick),this.enableDrillDown()&&(this._drillHeaderDiv.appendTo(this.element),this._drillHoverDiv.appendTo(this.element)),r=0;r<t.length;r++)t[r].rectangle=this._svgDocument[0].childNodes[r]},selectItem:function(t){var r,i,u,f;if(this._rootTreeMapItems!=null)for(r=0;r<this._rootTreeMapItems.length;r++)i=this._rootTreeMapItems[r],u=i.rectangle,i.Data!=null&&i.Data.length>0&&(i.Data=i.Data[0]),t==i.Data&&this.highlightOnSelection()&&(n(u).css({"border-width":this.highlightBorderThickness(),"border-color":this.highlightBorderBrush()}),this._browser!="msie"&&(f=this._svgDocument[0].children[this._svgDocument[0].children.length-1],this._svgDocument[0].insertBefore(u,f)),this._prevSelectedItems.push(u),this.selectedItems.push(t))},_selectTreemapItem:function(t){var r,i,u,f;if(this._rootTreeMapItems!=null)for(r=0;r<this._rootTreeMapItems.length;r++)i=this._rootTreeMapItems[r],u=i.rectangle,i.Data!=null&&i.Data.length>0&&(i.Data=i.Data[0]),t!=i.Data||this._contains(this.selectedItems,t)||this.highlightOnSelection()&&(n(u).css({"border-width":this.highlightBorderThickness(),"border-color":this.highlightBorderBrush()}),this._browser!="msie"&&(f=this._svgDocument[0].children[this._svgDocument[0].children.length-1],this._svgDocument[0].insertBefore(u,f)),this._prevSelectedItems=[],this.selectedItems=[],this._prevSelectedItems.push(u),this.selectedItems.push(t))},_selectItemResize:function(){for(var n,i,t=0;t<this._rootTreeMapItems.length;t++)n=this._rootTreeMapItems[t],i=n.rectangle,n.Data!=null&&n.Data.length>0&&(n.Data=n.Data[0]),this._contains(this.selectedItems,n.Data)&&this.selectItem(n.Data)},selectItemByPath:function(n,t,i){for(var e,c,l,s,f,o=n.split(i),a=t.split(i),n,t,u=this._rootTreeMapItems,r=0;r<o.length;r++){var n=o[r],t=a[r],h=[];for(e=0;e<u.length;e++){for(f=u[e],c=f.Data,s=0;s<o.length;s++)l=this._reflection(c,n);t==l&&h.push(f)}u=h}for(r=0;r<u.length;r++)f=u[r],this.selectItem(f.Data)},_contains:function(n,t){var i=n.length;if(i>0)while(i--)if(n[i]===t)return!0;return!1},_rectClickFunction:function(t){var a=t.ctrlKey,i=this,r=t.data.rect,s,h,e,o,u,f,c,l;if(i.highlightOnSelection())if(i._browser!="msie"&&(s=i._svgDocument[0].children[i._svgDocument[0].children.length-1],i._svgDocument[0].insertBefore(r,s)),a)n.inArray(r,i._prevSelectedItems)==-1?(n(r).css({"border-width":i.highlightBorderThickness(),"border-color":i.highlightBorderBrush()}),i._prevSelectedItems.push(r),i.selectedItems.push(t.data.Param1)):(n(r).css({"border-width":i.borderThickness(),"border-color":i.borderBrush()}),h=i._prevSelectedItems.indexOf(r),i._prevSelectedItems.splice(h,1),i.selectedItems=[]);else{for(e=0;e<i._prevSelectedItems.length;e++)n(i._prevSelectedItems[e]).css({"border-width":i.borderThickness(),"border-color":i.borderBrush()});n.inArray(r,i._prevSelectedItems)==-1?(n(r).css({"border-width":i.highlightBorderThickness(),"border-color":i.highlightBorderBrush()}),i._prevSelectedItems=[],i.selectedItems=[],i._prevSelectedItems.push(r),i.selectedItems.push(t.data.Param1)):(i._prevSelectedItems=[],i.selectedItems=[])}o=i._toolTipElement;t.type=="mousedown"?u={x:t.pageX,y:t.pageY}:t.type=="touchstart"?u={x:t.originalEvent.changedTouches[0].pageX,y:t.originalEvent.changedTouches[0].pageY}:t.type=="MSPointerDown"&&(u={x:t.originalEvent.pageX,y:t.originalEvent.pageY});f=i._tooltipSize;f.width+u.x>=i._width&&(u.x-=f.width);f.height+u.y>=i._height&&(u.y-=f.height);o!=null&&t.data.Param1!=null&&(c=i.model.tooltipTemplate,n(o).css({left:u.x+10,top:u.y+10,display:"block"}),l=n("#"+c).render(t.data.Param1),n(o).html(l));i._trigger("treeMapItemSelected",{selectedItems:i.selectedItems,originalEvent:t})},_rectMouseEnter:function(t){var u=t.data.Param1.Data,i,r,f,e,o;u!=null&&(i=t.data.Param2._toolTipElement,r=t.data.Param2.model.tooltipTemplate,i!=null&&r!=null&&(n(i).css({left:t.pageX+10,top:t.pageY+10,display:"block"}),f=n("#"+r).render(u),n(i).html(f),e=i[0]!=null?i[0].clientHeight:i.clientHeight,o=i[0]!=null?i[0].clientWidth:i.clientWidth,t.data.Param2._tooltipSize={height:e,width:o}))},_rectMouseMove:function(t){var u=t.data.Param2,r=u._toolTipElement,l=!0,s,e,h,a,v,y,o,f,c;if(t.data.Param1==i&&r!=null){for(f=0;f<u._rootTreeMapItems.length;f++)if(e=u._rootTreeMapItems[f],e.rectangle.offsetLeft<t.offsetX&&e.rectangle.offsetLeft+e.rectangle.offsetWidth>t.offsetX&&e.rectangle.offsetTop<t.offsetY&&e.rectangle.offsetTop+e.rectangle.offsetHeight>t.offsetY){s=e.Data;break}s!=null?(h=t.data.Param2.model.tooltipTemplate,r!=null&&h!=null&&(n(r).css({left:t.pageX+10,top:t.pageY+10,display:"block"}),a=n("#"+h).render(s),n(r).html(a),v=r[0]!=null?r[0].clientHeight:r.clientHeight,y=r[0]!=null?r[0].clientWidth:r.clientWidth,u._tooltipSize={height:v,width:y})):r!=null&&(l=!1,n(r).css("display","none"))}if(l){if(o=u._tooltipSize,o.width+t.pageX>=u._width&&(t.pageX-=o.width),o.height+t.pageY>=u._height&&(t.pageY-=o.height),u.enableDrillDown()&&u._browser!="msie")for(f=0;f<u._drillHoverDiv[0].children.length;f++)c=u._drillHoverDiv[0].children[f],c.className==t.data.Param1.ParentHeader&&n(c).css({display:"block"});r!=null&&n(r).css({left:t.pageX+10,top:t.pageY+10,display:"block"})}},_rectMouseLeave:function(t){var i=t.data.treeMap._toolTipElement;i!=null&&n(i).css("display","none")},_docClickFunction:function(t){var i=t.data.treeMap._toolTipElement;i!=null&&n(i).delay(200).queue(function(t){n(this).css("display","none");t()})},_setColorMappings:function(n,t){for(var r,i=0;i<n.length;i++)t.rangeColorMapping!=null&&t.rangeColorMapping.length>0||t.uniColorMapping!=null&&(t.uniColorMapping.color!=null||this.uniColor()!=null)?(r=n[i]._generateColorMappings(t,this),n[i].backgroundColor=r):t.desaturationColorMapping!=null&&(t.desaturationColorMapping.color!=""||this._color()!="")?this._setDesaturationColor(n,t.desaturationColorMapping):t.paletteColorMapping!=null&&this._setPaletteColor(n,t.paletteColorMapping)},_setDesaturationColor:function(n,t){var f,r;n=n.sort(this._orderBycolorWeight);var i=typeof t.from=="number"?t.from:this._from(),u=typeof t.to=="number"?t.to:this._to(),e=typeof t.rangeMinimum=="number"?t.rangeMinimum:this._rangeMinimum(),o=typeof t.rangeMaximum=="number"?t.rangeMaximum:this._rangeMaximum();for((i<0||i>1)&&(i=1),(u>1||u<0)&&(u=0),f=(i-u)/n.length,r=0;r<n.length;r++)n[r].backgroundColor=typeof t.color=="string"?t.color:this._color(),n[r].colorWeight>=e&&n[r].colorWeight<=o&&(n[r].backgroundOpacity=i,i=i-f)},_setPaletteColor:function(n,t){n=n.sort(this._orderBycolorWeight);for(var i=0;i<n.length;i++)t.colors!=null&&t.colors.length>0&&(n[i].backgroundColor=t.colors[i%t.colors.length])},_orderBycolorWeight:function(n,t){return n.colorWeight==t.colorWeight?0:n.colorWeight<t.colorWeight?1:-1},_orderByAreaWight:function(n,t){return n.AreaByWeight==t.AreaByWeight?0:n.AreaByWeight<t.AreaByWeight?1:-1},_calculateSliceAndDiceItemSize:function(n,t,r,u,f,e,o,s,h){var a,g,l,p,nt,b,v,tt,d,c,k,y;e==""&&(e=0);a=e;g=this._getTotalWeight(n);s==i&&(s=u>f?!0:!1);l={Width:u,Height:f-h};p=o<l.Height?o:0;l.Height=l.Height-p;var rt={X:t,Y:r+p,Width:l.Width,Height:l.Height},it=l.Height*l.Width,w=n.length;if(s)for(nt=l.Height,b=0,c=0;c<w;c++)k=it/g*n[c].weight,v=k/nt,e=v>a?a:0,b<=l.Width&&(n[c].ItemWidth=c!=w-1?v-parseFloat(e):v,n[c].ItemHeight=nt,n[c].LeftPosition=b+t,n[c].TopPosition=r+o,b+=v);else for(tt=l.Width,d=0,c=0;c<w;c++)k=it/g*n[c].weight,y=k/tt,e=y>a?a:0,d<=l.Height&&(n[c].ItemWidth=tt,n[c].ItemHeight=c!=w-1?y-parseFloat(e):y,n[c].LeftPosition=t,n[c].TopPosition=d+r+p,d+=y)},_calculateSquarifiedItemSize:function(n,t,i,r,u,f,e,o){var a,tt,it,s,v,y,l,g,c;f==""&&(f=0);var rt=this._getTotalWeight(n),p={Width:r,Height:u-o},nt=e<p.Height?e:0;for(p.Height=p.Height-nt,a=n.length-1;a>=0;a--)l=n[a],l.AreaByWeight=p.Height*p.Width*l.weight/rt,l.headerTopPosition=i;var h={X:t,Y:i+nt,Width:p.Width,Height:p.Height},b=n.sort(this._orderByAreaWight),k=0,d=0,w=0;for(a=0;a<n.length;a=w)for(tt=b[a],weightObject=this._getGroupTotalWeight(tt,b,h,a),it=weightObject.totalWeight,w=weightObject.index,s={},v=h.Width>h.Height?!0:!1,y=a;y<w;y++)l=b[y],g=it,y==a&&(s.X=h.X,s.Y=h.Y,v?(s.Width=g/h.Height,s.Height=h.Height,h.X+=s.Width,h.Width=Math.max(0,h.Width-s.Width)):(s.Width=h.Width,s.Height=g/h.Width,h.Y+=s.Height,h.Height=Math.max(0,h.Height-s.Height)),k=s.X,d=s.Y),c={},b.indexOf(l)!=b.length-1?(c.X=0,c.Y=0,c.Width=v?s.Width-parseFloat(f):l.AreaByWeight/s.Height,c.Height=v?l.AreaByWeight/s.Width:s.Height-parseFloat(f),w-y!=1&&(v?c.Height-=parseFloat(f):c.Width-=parseFloat(f))):(c.Width=v?s.Width:l.AreaByWeight/s.Height,c.Height=v?l.AreaByWeight/s.Width:s.Height),l.ItemWidth=c.Width,l.ItemHeight=c.Height,l.LeftPosition=k,l.TopPosition=d,v?d+=w-y!=1?c.Height+parseFloat(f):c.Height:k+=w-y!=1?c.Width+parseFloat(f):c.Width},_getGroupTotalWeight:function(n,t,i,r){for(var f=0,o=0,s,e,h;r<t.length;r++){s=this._getShortersideLength(i.Width,i.Height);e=t[r];f+=e.AreaByWeight;var u=f/s,c=n.AreaByWeight/u,l=e.AreaByWeight/u;if(r==0&&(o=this._aspectRatio(u,s)),h=Math.max(this._aspectRatio(c,u),this._aspectRatio(l,u)),f==e.AreaByWeight||h<o)o=h;else{f-=e.AreaByWeight;u=f/s;o=Math.max(this._aspectRatio(c,u),this._aspectRatio(l,u));break}}return{totalWeight:f,index:r}},_aspectRatio:function(n,t){return n>t?n/t:t/n},_getShortersideLength:function(n,t){return n>t?t:n},_getTotalWeight:function(n){for(var i=0,t=0;t<n.length;t++)i+=parseFloat(n[t].weight);return i},_getGroupitem:function(t,i,r){var c=[],a,e,l,f,h,s,y,k;if(i!=null&&this.weightValuePath()!=null){for(e in i)f=i[e],(f!=null&&f.hasOwnProperty(t)?!0:this._containsProperty(f,t))&&(h=this._reflection(f,t),n.inArray(h,c)==-1&&c.push(h));for(a=[],e=0;e<c.length;e++){var o={},p=[],w=c[e],b=0,v=0,d=0;for(l=0;l<i.length;l++)f=i[l],h=this._reflection(f,t),h==w&&(s=this._reflection(f,this.weightValuePath()),s<0&&(s=-1*s),y=this._reflection(f,this.colorValuePath()),p.push(f),d++,s!=null&&(v+=parseFloat(s)),y!=null&&(b+=parseFloat(y)));o.header=w;o.data=p;o.weight=v;o.colorWeight=b;o.headerHeight=r;v>0&&(k=new u(o),a.push(k))}return a}return null},_getTopGroupitem:function(n,t){var o,s,y,h,p;n==null&&(n=this.labelPath());n==null&&(n=this.weightValuePath());var i={},c=0,l=0,a=[],v=[];for(o=0;o<t.length;o++){var f=t[o],w=this._reflection(f,n),e={},r=this._reflection(f,this.weightValuePath());r<0&&(r=-1*r);s=this._reflection(f,this.colorValuePath());r!=null&&(c+=parseFloat(r));s!=null&&(l+=parseFloat(s));v.push(f);e.weight=r;e.data=f;e.header=w;e.colorWeight=s;y=new u(e);a.push(y)}return i.header="",i.data=v,i.weight=c,i.innerItem=a,i.colorWeight=l,h=[],p=new u(i),h.push(p),h},_containsProperty:function(n,t){for(var i in n)if(i==t)return!0;return!1},_reflection:function(t,i){var f=t,r,u,e;if(i!=null&&t!=null){for(r=i.split("."),r.push(i),u=0;u<r.length;u++)e=f.hasOwnProperty(r[u])?!0:this._containsProperty(f,r[u]),e&&n.each(f,function(n,t){if(n==r[u])return f=t,!1});return f}return null}});r=function(){this.groupBackground=null;this.groupBorderColor=null;this.groupBorderThickness=1;this.groupPadding=4;this.groupPath=null;this.groupGap=1;this.headerHeight=20;this.showHeader=!0;this.showLabels=!1;this.headerTemplate=null;this.labelTemplate=null;this.labelPosition="center";labelVisibilityMode="visible";headerVisibilityMode="visible";this.treeMapItems=[]};r.prototype={};var f=function(){this.groupID=null;this.rangeColorMapping=[];this.desaturationColorMapping={from:0,to:0,color:"",rangeMinimum:0,rangeMaximum:0};this.uniColorMapping={color:null};this.paletteColorMapping={colors:[]}},e=function(){this.from=-1;this.to=-1;this.legendlabel=null;this.color=null},u=function(n){this.weight=n.weight;this.colorWeight=n.colorWeight;this.Data=n.data;this.headerHeight=n.headerHeight;this.header=n.header;this.label=n.header;this.headerLeftPosition=0;this.headerTopPosition=0;this.innerItems=n.innerItem;this.headerWidth=0;this.headerTemplate=null};u.prototype={_generateColorMappings:function(n,t){return n.rangeColorMapping!=null&&n.rangeColorMapping.length>0?this._getRangeBrushColor(n.rangeColorMapping):t.uniColor()!=null&&n.uniColorMapping!=null?t.uniColor():n.uniColorMapping.color!=null&&n.uniColorMapping!=null?this._getUniColor(n.uniColorMapping):void 0},_getUniColor:function(n){return n.color},_getRangeBrushColor:function(n){for(var i,t=0;t<n.length;t++)if(i=n[t],this.colorWeight>=i.from&&this.colorWeight<=i.to)return i.color}};t.datavisualization.TreeMap.ItemsLayoutMode={Squarified:"squarified",SliceAndDiceHorizontal:"sliceanddicehorizontal",SliceAndDiceVertical:"sliceanddicevertical",SliceAndDiceAuto:"sliceanddiceauto"};t.datavisualization.TreeMap.DockPosition={Top:"top",Bottom:"bottom",Right:"right",Left:"left"};t.datavisualization.TreeMap.Position={TopLeft:"topleft",TopCenter:"topcenter",TopRight:"topright",CenterLeft:"centerleft",Center:"center",CenterRight:"centerright",BottomLeft:"bottomleft",BottomCenter:"bottomcenter",BottomRight:"bottomright"};t.datavisualization.TreeMap.VisibilityMode={Visible:"visible",HideOnExceededLength:"hideonexceededlength"}})(jQuery,Syncfusion)});