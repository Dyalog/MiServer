/*!
*  filename: ej.treemap.min.js
*  version : 12.3
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min"],n):n()})(function(){(function(n,t,i){var r,u;t.widget({ejTreeMap:"ej.datavisualization.TreeMap"},{validTags:["div"],defaults:{leafItemSettings:{borderThickness:1,borderBrush:"white",showLabels:!1,labelPath:null,itemTemplate:null},dataSource:null,enableDrillDown:!1,drillDownHeaderColor:"#0478c3",drillDownSelectionColor:"#000000",groupSelectionMode:"default",colorValuePath:null,weightValuePath:null,treeMapItems:[],showLegend:!1,borderBrush:"white",borderThickness:1,enableResize:!0,itemsLayoutMode:"squarified",levels:[],legendSettings:{template:null,iconHeight:15,iconWidth:25},rangeColorMapping:[],uniColorMapping:{color:null},desaturationColorMapping:{from:0,to:0,color:null,rangeMinimum:0,rangeMaximum:0},paletteColorMapping:null,highlightOnSelection:!1,highlightGroupOnSelection:!1,showTooltip:!1,tooltipTemplate:null,highlightBorderThickness:5,highlightGroupBorderThickness:4,highlightBorderBrush:"gray",highlightGroupBorderBrush:"gray"},dataTypes:{dataSource:"data",treeMapItems:"array",levels:"array",rangeColorMapping:"array",paletteColorMapping:"array"},observables:["dataSource","colorValuePath","weightValuePath"],dataSource:t.util.valueFunction("dataSource"),colorValuePath:t.util.valueFunction("colorValuePath"),weightValuePath:t.util.valueFunction("weightValuePath"),_initPrivateProperties:function(){this._svgDocument=null;this._templateDiv=null;this._drillHeaderDiv=null;this._drillHoverDiv=null;this._backgroundTile=null;this._height=500;this._initDiv=null;this._width=500;this._svgns="http://www.w3.org/2000/svg";this._prevSelectedItems=[];this._prevSelectedHeaders=[];this.treeMapItemSelected=null;this.treeMapGroupSelected=null;this._browser=null;this._toolTipElement=null;this._rootTreeMapItems=[];this._drillHeader=null;this._drilldownItem=null;this._drilldownItems=[];this._treeMapHeaders=[];this._treeMapLabels=[];this._labelTemplateElements=[];this._itemGroups=[];this._prevSelectedItemDatas=[];this._prevSelectedGroupDatas=[]},_setModel:function(n){for(var t in n)switch(t){case"itemsLayoutMode":this.model.itemsLayoutMode=n[t];this.refresh()}},_init:function(){this._initPrivateProperties();this._levelInitialize();this.refresh()},_destroy:function(){},_levelInitialize:function(){var t=this;this.model.levels!=null?n.each(this.model.levels,function(i,u){u=t._checkArrayObject(u,i);var f=new r;n.extend(f,u);n.extend(u,f)}):this.levels.treeMapLevel=new r;n(document).click({Param1:this},this._docClickFunction)},_checkArrayObject:function(t,i){var u=this;return n.each(t,function(n,t){if(t instanceof Array)u._checkArrayObject(t,n);else if(t!=null&&typeof t=="object"){var f=new r;u._loadIndividualDefaultValues(t,f,typeof n=="number"?i:n)}}),t},_loadIndividualDefaultValues:function(t,i,r){var u=null,f=this;return n.each(i,function(n,t){if(r==n){u=t;return}}),u instanceof Array&&(u=u[0]),n.each(t,function(n,t){t instanceof Array?f._checkArrayObject(t,r):t!=null&&typeof t=="object"&&f._loadIndividualDefaultValues(t,t,typeof n=="number"?r:n)}),n.extend(u,t),n.extend(t,u),t},refresh:function(){this._initPrivateProperties();n(this.element).empty();this._svgDocument!=null&&n(this._svgDocument).empty();this._height=this.element.height();this._width=this.element.width();this._height==0&&(this._height=this.element[0].parentElement.clientHeight!=0?this.element[0].parentElement.clientHeight:n(document).height());this._width==0&&(this._width=this.element[0].parentElement.clientWidth!=0?this.element[0].parentElement.clientWidth:n(document).width());var i=jQuery.uaMatch(navigator.userAgent),r=i.browser.toLowerCase(),u=!!navigator.userAgent.match(/Trident\/7\./);this._browser=r;n(this.element).css({position:"relative"});this._height!=0&&this._width!=0&&(this._templateDiv=n("<div class='_templateDiv'><\/div>"),this._templateDiv.css({"pointer-events":"none",overflow:"hidden",float:"left","z-index":"2",height:this._height,width:this._width}),this._drillHeaderDiv=n("<div class='_drillHeaderDiv'><\/div>"),this._drillHeaderDiv.css({overflow:"hidden",float:"left","z-index":"3",height:this._height,width:this._width}),this._drillHoverDiv=n("<div class='_drillHoverDiv'><\/div>"),this._drillHoverDiv.css({overflow:"hidden",float:"left","z-index":"3",height:this._height,width:this._width}),this._backgroundTile=n('<div id="backgroundTile" style="overflow:hidden;z-index:0;"><\/div>'),this.model.dataSource!=null&&(this.model.dataSource instanceof t.DataManager?this._processOData(this):this._renderTreeMap(this.dataSource())),this.model.enableResize&&this._on(n(window),"resize",this._treeMapResize))},_renderTreeMap:function(n){this._groupLevels(n);this.model.showLegend&&this._generateLegend();this._generateToolTip();this._renderLabels()},_processOData:function(n){var t=this,i=n.model.dataSource.executeQuery(n.model.query);i.done(function(n){n.result!=null&&t._renderTreeMap(n.result)})},_treeMapResize:function(n){n.preventDefault();n.stopPropagation();var t=this;this.resizeTO&&clearTimeout(this.resizeTO);this.resizeTO=setTimeout(function(){t.refresh()},500)},_groupLevels:function(n){var i=null,u,r,t,o,f,e;if(this.model.enableDrillDown&&this._drillDownHeader(this.model.levels[0].groupPath,!1),u=this._getTopGroupitem(this.model.leafItemSettings.labelPath,n,0),i=u,this.model.levels.length==0&&(t=this.model.leafItemSettings,this._rootTreeMapItems=u,this._getTopLevels(u[0].innerItems,t),this._generateTreeMapItems(u[0].innerItems,"gray",this.colorValuePath()),this._generateLabels(u[0].innerItems,null,t.itemTemplate,t.showLabels)),this.model.levels.length>0)for(r=0;r<=this.model.levels.length;r++)if(t=this.model.levels[r],r!=0){if(o=i,f=this.model.levels[r-1],i=[],t==null&&(t=this.model.leafItemSettings),this._generateSubItems(o,t,i,f),this._rootTreeMapItems=i,this.model.enableDrillDown){if(r==1)return this._generateTreeMapItems(i,"gray",f.DisplayPath),!1}else r==this.model.levels.length&&this._generateTreeMapItems(i,"gray",f.DisplayPath);this._generateLabels(i,null,t.itemTemplate,t.showLabels)}else e=this._getGroupitem(t.groupPath,u[0].Data,t.headerHeight),this._rootTreeMapItems=e,this._getTopLevels(e,t),i=e},_groupdrillDownLevels:function(n,t){var u=null,i,r,o,e,f;if(this.model.levels.length>0)for(i=0;i<this.model.levels.length;i++)r=this.model.levels[i],i!=0?(o=u,e=this.model.levels[i-1],u=[],r==null&&(r=this.model.leafItemSettings),this._generateSubItems(o,r,u,e,!0,t+1!=i),this._rootTreeMapItems=u,(i==t+1||i==this.model.levels.length-1)&&this._generateTreeMapItems(u,"gray",e.DisplayPath),i==t&&this._generateLabels(u,null,r.itemTemplate,r.showLabels)):(f=this._getGroupitem(r.groupPath,n.Data,r.headerHeight),this._rootTreeMapItems=f,this._getTopLevels(f,r),u=f)},_getTopLevels:function(n,i){var f=i.groupGap!=null?i.groupGap:0,e=this.model.itemsLayoutMode,r=0,u=0;this.model.enableDrillDown&&(u=30);this.model.showLegend&&this.model.legendSettings!=null&&(r=this.model.legendSettings.iconHeight+20);e==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceHorizontal?this._calculateSliceAndDiceItemSize(n,0,r,this._width,this._height,f,u,!0,r):e==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceVertical?this._calculateSliceAndDiceItemSize(n,0,r,this._width,this._height,f,u,!1,r):e==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceAuto?this._calculateSliceAndDiceItemSize(n,0,r,this._width,this._height,f,u,null,r):this._calculateSquarifiedItemSize(n,0,r,this._width,this._height,f,u,r)},_generateSubItems:function(n,r,u,f,e,o){var w=this.model.itemsLayoutMode,b=n.length,a=r.groupPath,s,c,h,p;a==null&&(a=this.model.leafItemSettings.labelPath);a==null&&(a=this.weightValuePath());var v=r.groupGap!=null?r.groupGap:0,y=(f.showHeader||f.showHeader==null)&&!this.model.enableDrillDown?f.headerHeight:0,l=0;for(s=0;s<b;s++)for(c=this._getGroupitem(a,n[s].Data,r.headerHeight),w==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceHorizontal?this._calculateSliceAndDiceItemSize(c,n[s].LeftPosition+f.groupPadding,n[s].TopPosition+f.groupPadding,n[s].ItemWidth-(f.groupBorderThickness+2*f.groupPadding),n[s].ItemHeight-(f.groupBorderThickness+2*f.groupPadding),v,y,!0,0):w==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceVertical?this._calculateSliceAndDiceItemSize(c,n[s].LeftPosition+f.groupPadding,n[s].TopPosition+f.groupPadding,n[s].ItemWidth-(f.groupBorderThickness+2*f.groupPadding),n[s].ItemHeight-(f.groupBorderThickness+2*f.groupPadding),v,y,!1,0):w==t.datavisualization.TreeMap.ItemsLayoutMode.SliceAndDiceAuto?this._calculateSliceAndDiceItemSize(c,n[s].LeftPosition+f.groupPadding,n[s].TopPosition+f.groupPadding,n[s].ItemWidth-(f.groupBorderThickness+2*f.groupPadding),n[s].ItemHeight-(f.groupBorderThickness+2*f.groupPadding),v,y,null,0):this._calculateSquarifiedItemSize(c,n[s].LeftPosition+f.groupPadding,n[s].TopPosition+f.groupPadding,n[s].ItemWidth-(f.groupBorderThickness+2*f.groupPadding),n[s].ItemHeight-(f.groupBorderThickness+2*f.groupPadding),v,y,0),h=this._rootTreeMapItems[s],h.headerHeight=f.headerHeight,h.showHeader=f.showHeader,h.headerWidth=n[s].ItemWidth,h.headerTemplate=f.headerTemplate,h.headerLeftPosition=n[s].LeftPosition,h.headerTopPosition=n[s].TopPosition,(f.showHeader||f.showHeader==null)&&(this.model.enableDrillDown?this._createBackGround(h,f,n[s],o):(this._createBackGround(h,f),this._generateHeaders(h,f))),n[s].ChildtreeMapItems=c,n[s].GroupingLevel=this.model.levels.indexOf(f)+1,p=0;p<c.length;p++)u[l]=c[p],u[l].ParentHeader=h.header,u[l].ItemHeight-=f.groupPadding,u[l].ItemWidth-=f.groupPadding,u[l].LeftPosition+=f.groupBorderThickness,u[l].TopPosition+=f.groupBorderThickness,l++;e==i&&this._generateLabels(n,f.labelTemplate,null,f.showLabels)},_createBackGround:function(t,i,r,u){var f=n("<div />"),o=t.showHeader||t.showHeader==null?t.ItemHeight-2*i.groupBorderThickness:0,s=t.showHeader||t.showHeader==null?t.TopPosition:0,e;f.css({height:o+"px",width:t.ItemWidth-2*i.groupBorderThickness+"px",left:t.LeftPosition+"px",top:s+"px","border-style":"solid","border-width":i.groupBorderThickness+"px","border-color":i.groupBorderColor,position:"absolute","background-color":i.groupBackground});f.appendTo(this._backgroundTile);this.model.enableDrillDown&&!u&&(e=n("<div/>"),e[0].className=t.header,e.css({height:f[0].style.height,width:f[0].style.width,left:f[0].style.left,top:f[0].style.top,position:"absolute","background-color":this.model.drillDownSelectionColor,opacity:.2,display:"none"}),this._drillHoverDiv.append(e),n(e).mouseenter({treemap:this,param1:t.header},this._mouseEnterFunction),n(e).mousedown({treemap:this,level:i,param1:r},this._headerClickFunction),n(e).mouseleave({treemap:this,param1:t.header},this._mouseLeaveFunction));n(f).mousedown({treemap:this,level:i,param1:r},this._headerClickFunction);n(f).mousemove({treemap:this,param1:t.header},this._mouseHoverFunction)},_mouseHoverFunction:function(t){var r=t.data.treemap,i,u;if(r.model.enableDrillDown)for(i=0;i<r._drillHoverDiv[0].children.length;i++)u=r._drillHoverDiv[0].children[i],u.className==t.data.param1&&n(u).css({display:"block"})},_mouseEnterFunction:function(t){for(var r,u=t.data.treemap,i=0;i<u._drillHoverDiv[0].children.length;i++)r=u._drillHoverDiv[0].children[i],r.className!=t.data.param1&&n(r).css({display:"none"})},_mouseLeaveFunction:function(t){for(var u,r=t.data.treemap,i=0;i<r._drillHoverDiv[0].children.length;i++)u=r._drillHoverDiv[0].children[i],n(u).css({display:"none"})},_headerClickFunction:function(t){var f=t.data.level,r=t.data.param1,c=t.ctrlKey,i=t.data.treemap,h,o,e,s,u;if(i.model.highlightGroupOnSelection)if(i._browser!="msie"&&(h=i._backgroundTile[0].children[i._backgroundTile[0].children.length-0],i._backgroundTile[0].insertBefore(this,h)),c)n.inArray(this,i._prevSelectedHeaders)==-1?(n(this).css({"border-width":i.model.highlightGroupBorderThickness,"border-color":i.model.highlightBorderBrush}),i._prevSelectedHeaders.push(this),i._prevSelectedGroupDatas.push(t.data.Param1)):(n(this).css({"border-width":f.groupBorderThickness,"border-color":f.groupBorderColor}),o=i._prevSelectedHeaders.indexOf(this),i._prevSelectedHeaders.splice(o,1),i._prevSelectedGroupDatas.splice(o,1));else{for(e=0;e<i._prevSelectedHeaders.length;e++)n(i._prevSelectedHeaders[e]).css({"border-width":f.groupBorderThickness,"border-color":f.groupBorderColor});n.inArray(this,i._prevSelectedHeaders)==-1?(n(this).css({"border-width":i.model.highlightGroupBorderThickness,"border-color":i.model.highlightBorderBrush}),i._prevSelectedHeaders=[],i._prevSelectedHeaders.push(this)):i._prevSelectedHeaders=[];i._prevSelectedGroupDatas.push(t.data.Param1)}if(i.model.enableDrillDown&&i.model.levels.length>1&&(i._drilldownItem!=null&&i._drilldownItem.header!=r.header||i._drilldownItem==null)){for(s="",u=0;u<i._drillHeaderDiv[0].children[0].children.length;u++)i._drillHeaderDiv[0].children[0].children[u].className=="header"&&(s=i._drillHeaderDiv[0].children[0].children[u].innerHTML);return i._drillHeaderDiv[0].innerHTML="",i._templateDiv[0].innerHTML="",i._drillHoverDiv[0].innerHTML="",i._drillDownHeader(s+"."+r.header,!0),i._drilldownItem=r,i._drilldownItems.push(r),i._groupdrillDownLevels(r,i._drilldownItems.length),!1}i._trigger("treeMapGroupSelected",{selectedGroups:i._prevSelectedHeaders,orginalEvent:t})},_generateLabels:function(t,i,r,u){for(var f,o,h,e,c,l,s=0;s<t.length;s++)f=t[s],r!=null&&(h=n("#"+r),e=n("<div style='overflow:hidden;display:block;position:absolute;pointer-events: none;'><\/div>"),e[0].data=f,c=n.templates(h.html()),l=c.render(f),n(e).html(l),n(e).css({left:f.LeftPosition+10+"px",top:f.TopPosition+5+"px"}),this._templateDiv.append(e),this._labelTemplateElements.push(e)),u&&i==null&&(o=n('<label style="font-size:14px;font-weight:normal;font-family:Segoe UI;">'+f.label+"<\/label>"),this.model.enableDrillDown?n(o).css({position:"absolute",color:"black",overflow:"hidden",width:f.ItemWidth-10+"px",left:f.LeftPosition+10+"px",top:f.TopPosition+5+"px",height:f.ItemHeight-10,"font-weight":"normal","pointer-events":"none"}):n(o).css({position:"absolute",color:"white",overflow:"hidden",width:f.ItemWidth-10+"px",left:f.LeftPosition+10+"px",top:f.TopPosition+5+"px",height:f.ItemHeight-10,"font-weight":"normal","pointer-events":"none"}),this._treeMapLabels.push(o),this._templateDiv.append(o)),i!=null&&u&&(h=n("#"+i),e=n("<div style='overflow:hidden;display:block;position:absolute;pointer-events: none;'><\/div>"),e[0].data=f,c=n.templates(h.html()),l=c.render(f),n(e).html(l),n(e).css({left:f.LeftPosition+f.ItemWidth/2,top:f.TopPosition+f.ItemHeight/2}),this._templateDiv.append(e),this._labelTemplateElements.push(e))},_generateToolTip:function(){var t,i;this.model.showTooltip&&(t=n("<div class='tooltipelement' style='display:none;position:absolute;z-index:1000;pointer-events:none;'><\/div>"),n(document.body).append(t),this._toolTipElement=t,this.model.tooltipTemplate==null&&(i=this.model.leafItemSettings.labelPath!=null?this.model.leafItemSettings.labelPath:this.weightValuePath(),i!=null&&(this.model.tooltipTemplate="defaultTooltip",this.element.append(n('<div id="defaultTooltip" style="display:none;"><div style="margin-left:10px;margin-top:-25px;"><div class="defaultToolTip"><p style="margin-top:-4px"><label  style="color:rgb(27, 20, 20);font-size:14px;font-weight:normal;font-family:Segoe UI">{{:'+i+"}}<\/label><\/p><\/div><\/div><\/div>")))))},_generateLegend:function(){var r,s,t,f,h;if(this.model.rangeColorMapping!=null){var e=this.model.rangeColorMapping,i=0,o=0,u=this.model.legendSettings,c=u.template;for(r=0;r<e.length;r++)s=c=="Ellipse"?this._getEllipseLegend(u,i,o):this._getRectLegend(u,i,o),n(s).css("background-color",e[r].color),s.appendTo(this._svgDocument),i+=u.iconWidth+5,t=n("<div/>"),t.css({left:i+"px",top:o+"px",position:"absolute"}),n(t).css({"font-size":"15px",color:"gray"}),t[0].innerHTML=e[r].legendLabel,t.appendTo(this._svgDocument),f=t[0].getBoundingClientRect(),h=window.SVGSVGElement?f.width:f.right-f.left,i+=h+18}},_getEllipseLegend:function(t,i,r){var u=n("<div class='e-mapLegend'/>");return u.css({height:this.model.legendSettings.iconHeight+"px",width:this.model.legendSettings.iconWidth+"px","border-radius":this.model.legendSettings.iconHeight/2+"px",left:i+"px",top:r+"px",position:"absolute"}),u},_getRectLegend:function(t,i,r){var u=n("<div />");return u.css({height:this.model.legendSettings.iconHeight+"px",width:this.model.legendSettings.iconWidth+"px",left:i+"px",top:r+"px",position:"absolute"}),u},_getPositionFromParent:function(n,t){var i=n.getBoundingClientRect(),r=t.getBoundingClientRect(),u=window.SVGSVGElement?i.width:i.right-i.left,f=window.SVGSVGElement?i.height:i.bottom-i.top;return{left:i.left-r.left,top:i.top-r.top,height:f,width:u}},_renderLabels:function(){for(var i=0;i<this._labelTemplateElements.length;i++){var t=this._labelTemplateElements[i],r=this._getPositionFromParent(t[0],this._templateDiv[0]),e=t[0].data,u=n(t).css("left"),f=n(t).css("top");n(t).css({left:parseInt(u)-r.width/2,top:parseInt(f)-r.height/2,"pointer-events":"none"})}},_generateHeaders:function(t,i){var u,r,f;t.headerTemplate==null?(u=n('<div style="display:block;position:absolute;pointer-events: stroke;overflow: hidden;"><label style="color:#262626;font-size:15px;font-weight:normal;font-family:Segoe UI;">'+t.header+"<\/label><\/div>"),n(u).css({left:t.headerLeftPosition+2,top:t.headerTopPosition+2,width:t.headerWidth-i.groupPadding,height:t.headerHeight,"margin-left":i.groupPadding}),this._templateDiv.append(u)):(r=n("<div style='display:block;position:absolute;pointer-events: none;overflow: hidden;'><\/div>"),this._templateDiv.append(r),n(r).css({left:t.headerLeftPosition,width:t.headerWidth,top:t.headerTopPosition,height:t.headerHeight}),f=n("#"+t.headerTemplate).render(t),n(r).html(f))},_drillDownHeader:function(t,i){var r=n("<div style='display:block;position:absolute;overflow: hidden;'><div class='header' style='margin-top:5px;height:30px;position:absolute;background-color: transparent'>"+t+"<\/div><\/div>");i&&(r=n("<div style='display:block;position:absolute;overflow: hidden;'><svg style='margin-top:10px;width:15px;height:15px'><polyline points='8,0 8,10 0,5 8,0' style='fill:white;stroke:white'/><\/svg><div class='header' style='left:17px;top:0px;position:absolute;margin-top:6px;height:30px;position:absolute;background-color: transparent'  '>"+t+"<\/div><\/div>"));n(r).css({left:"0px",width:this._width+"px","background-color":this.model.drillDownHeaderColor,top:0,height:"30px",color:"white","font-size":"15px","text-indent":"10px",cursor:"pointer"});this._drillHeaderDiv.append(r);n(r).mousedown({treemap:this},this._drilldownfunction)},_drilldownfunction:function(n){var t=n.data.treemap,f,i,u,r;if(t._drilldownItems.length>0)if(t._drilldownItems.length==1)t.refresh(),t._drilldownItems=[];else{for(f="",i=0;i<t._drillHeaderDiv[0].children[0].children.length;i++)t._drillHeaderDiv[0].children[0].children[i].className=="header"&&(f=t._drillHeaderDiv[0].children[0].children[i].innerHTML);for(u=f.split("."),t._drillHeaderDiv[0].innerHTML="",r="",i=0;i<u.length-1;i++)r=r+u[i],i!=u.length-2&&(r=r+".");t._drillDownHeader(r,!0);t._drilldownItem=t._drilldownItems[t._drilldownItems.length-2];t._drilldownItems.pop(t._drilldownItems[t._drilldownItems.length-1]);t._templateDiv[0].innerHTML="";t._groupdrillDownLevels(t._drilldownItem,t._drilldownItems.length)}},_generateTreeMapItems:function(t){var u;if(this._getTreeMapItemTemplate(t),t!=null){for(u=0;u<t.length;u++){var i=t[u],r=this._svgDocument[0].childNodes[u],f=i._generateColorMappings(this.model);f!=null?n(r).css("background-color",f):n(r).css("background-color","#e5e5e5");i.Data!=null&&i.Data.length>0&&(i.Data=i.Data[0]);i.Rectangle=r;n(r).mouseenter({Param1:i,Param2:this},this._rectMouseEnter);n(r).mousemove({Param1:i,Param2:this},this._rectMouseMove);n(r).mouseleave({Param1:i,Param2:this},this._rectMouseLeave);n(r).mouseup({Param1:i,Param2:this},this._rectMouseLeave);n(r).mousedown({Param1:i.Data,treemap:this},this._rectClickFunction)}this.model.rangeColorMapping.length==0&&this.model.uniColorMapping.color==null&&this.model.desaturationColorMapping.color!=null?this._setDesaturationColor(t,this.model.desaturationColorMapping):this.model.PaletteColorMapping!=null&&this._setPaletteColor(t,this.model.PaletteColorMapping)}},_getTreeMapItemTemplate:function(t){for(var i,u="",r=0;r<t.length;r++)i=t[r],u+='<div style="border-style:solid;position:absolute;left:'+i.LeftPosition+"px;top:"+i.TopPosition+"px;height:"+i.ItemHeight+"px;width:"+i.ItemWidth+"px;border-width:"+this.model.leafItemSettings.borderThickness+"px;border-color:"+this.model.leafItemSettings.borderBrush+'"><\/div>';this._svgDocument!=null&&this.model.enableDrillDown&&(this._svgDocument[0].innerHTML="");this._svgDocument=n('<div style= "overflow:hidden;z-index:1;"id="svgDocument">'+u+"<\/div>");this._backgroundTile.appendTo(this.element);this._svgDocument.appendTo(this.element);this._svgDocument.css({height:this._height+"px",width:this._width+"px",overflow:"hidden","z-index":1});n(this._backgroundTile).css({height:this._height+"px",width:this._width+"px",overflow:"hidden","z-index":0});this._templateDiv.appendTo(this.element);this._drillHeaderDiv.appendTo(this.element);this._drillHoverDiv.appendTo(this.element)},_rectClickFunction:function(t){var e=t.ctrlKey,i=t.data.treemap,f,u,r;if(i.model.highlightOnSelection)if(i._browser!="msie"&&(f=i._svgDocument[0].children[i._svgDocument[0].children.length-1],i._svgDocument[0].insertBefore(this,f)),e)n.inArray(this,i._prevSelectedItems)==-1?(n(this).css({"border-width":i.model.highlightBorderThickness,"border-color":i.model.highlightBorderBrush}),i._prevSelectedItems.push(this),i._prevSelectedItemDatas.push(t.data.Param1)):(n(this).css({"border-width":i.model.leafItemSettings.borderThickness,"border-color":i.model.leafItemSettings.borderBrush}),u=i._prevSelectedItems.indexOf(this),i._prevSelectedItems.splice(u,1),i._prevSelectedItemDatas.splice(u,1));else{for(r=0;r<i._prevSelectedItems.length;r++)n(i._prevSelectedItems[r]).css({"border-width":i.model.leafItemSettings.borderThickness,"border-color":i.model.leafItemSettings.borderBrush});n.inArray(this,i._prevSelectedItems)==-1?(n(this).css({"border-width":i.model.highlightBorderThickness,"border-color":i.model.highlightBorderBrush}),i._prevSelectedItems=[],i._prevSelectedItems.push(this)):i._prevSelectedItems=[];i._prevSelectedItems.push(t.data.Param1)}i._trigger("treeMapItemSelected",{selectedItems:i._prevSelectedItems,originalEvent:t})},_rectMouseEnter:function(t){var u=t.data.Param1.Data,i,r,f;u!=null&&(i=t.data.Param2._toolTipElement,r=t.data.Param2.model.tooltipTemplate,i!=null&&r!=null&&(n(i).css({left:t.pageX+10,top:t.pageY+10,display:"block"}),f=n("#"+r).render(u),n(i).html(f)))},_rectMouseMove:function(t){var f=t.data.Param2._toolTipElement,i=t.data.Param2,r,u;if(i.model.enableDrillDown&&i._browser!="msie")for(r=0;r<i._drillHoverDiv[0].children.length;r++)u=i._drillHoverDiv[0].children[r],u.className==t.data.Param1.ParentHeader&&n(u).css({display:"block"});f!=null&&n(f).css({left:t.pageX+10,top:t.pageY+10,display:"block"})},_rectMouseLeave:function(t){var i=t.data.Param2._toolTipElement;i!=null&&n(i).css("display","none")},_docClickFunction:function(t){var i=t.data.Param1._toolTipElement;i!=null&&n(i).css("display","none")},_setDesaturationColor:function(t,i){var r,f,e,u;for(t=t.sort(this._orderBycolorWeight),r=i.from,f=i.to,(r<0||r>1)&&(r=1),(f>1||f<0)&&(f=0),e=(r-f)/t.length,u=0;u<t.length;u++)n(t[u].Rectangle).css("background-color",i.color),t[u].colorWeight>=i.rangeMinimum&&t[u].colorWeight<=i.rangeMaximum&&(n(t[u].Rectangle).css("opacity",r),r=r-e)},_setPaletteColor:function(n,t){n=n.sort(this._orderBycolorWeight);for(var i=0;i<n.length;i++)t.colors.length>0&&n[i].Rectangle.setAttribute("fill",t.Colors[i%t.colors.length])},_orderBycolorWeight:function(n,t){return n.colorWeight==t.colorWeight?0:n.colorWeight<t.colorWeight?1:-1},_orderByAreaWight:function(n,t){return n.AreaByWeight==t.AreaByWeight?0:n.AreaByWeight<t.AreaByWeight?1:-1},_calculateSliceAndDiceItemSize:function(n,t,r,u,f,e,o,s,h){var y=e,tt=this._getTotalWeight(n),l,p,g,b,a,nt,d,c,k,v;s==i&&(s=u>f?!0:!1);l={Width:u,Height:f-h};p=o<l.Height?o:0;l.Height=l.Height-p;var rt={X:t,Y:r+p,Width:l.Width,Height:l.Height},it=l.Height*l.Width,w=n.length;if(s)for(g=l.Height,b=0,c=0;c<w;c++)k=it/tt*n[c].weight,a=k/g,e=a>y?y:0,b<=l.Width&&(n[c].ItemWidth=c!=w-1?a-e:a,n[c].ItemHeight=g,n[c].LeftPosition=b+t,n[c].TopPosition=r+o,b+=a);else for(nt=l.Width,d=0,c=0;c<w;c++)k=it/tt*n[c].weight,v=k/nt,e=v>y?y:0,d<=l.Height&&(n[c].ItemWidth=nt,n[c].ItemHeight=c!=w-1?v-e:v,n[c].LeftPosition=t,n[c].TopPosition=d+r+p,d+=v)},_calculateSquarifiedItemSize:function(n,t,i,r,u,f,e,o){var rt=this._getTotalWeight(n),p={Width:r,Height:u-o},nt=e<p.Height?e:0,a,tt,it,s,v,y,l,g,c;for(p.Height=p.Height-nt,a=n.length-1;a>=0;a--)l=n[a],l.AreaByWeight=p.Height*p.Width*l.weight/rt,l.headerTopPosition=i;var h={X:t,Y:i+nt,Width:p.Width,Height:p.Height},b=n.sort(this._orderByAreaWight),k=0,d=0,w=0;for(a=0;a<n.length;a=w)for(tt=b[a],weightObject=this._getGroupTotalWeight(tt,b,h,a),it=weightObject.totalWeight,w=weightObject.index,s={},v=h.Width>h.Height?!0:!1,y=a;y<w;y++)l=b[y],g=it,y==a&&(s.X=h.X,s.Y=h.Y,v?(s.Width=g/h.Height,s.Height=h.Height,h.X+=s.Width,h.Width=Math.max(0,h.Width-s.Width)):(s.Width=h.Width,s.Height=g/h.Width,h.Y+=s.Height,h.Height=Math.max(0,h.Height-s.Height)),k=s.X,d=s.Y),c={},b.indexOf(l)!=b.length-1?(c.X=0,c.Y=0,c.Width=v?s.Width-f:l.AreaByWeight/s.Height,c.Height=v?l.AreaByWeight/s.Width:s.Height-f,w-y!=1&&(v?c.Height-=f:c.Width-=f)):(c.Width=v?s.Width:l.AreaByWeight/s.Height,c.Height=v?l.AreaByWeight/s.Width:s.Height),l.ItemWidth=c.Width,l.ItemHeight=c.Height,l.LeftPosition=k,l.TopPosition=d,v?d+=w-y!=1?c.Height+f:c.Height:k+=w-y!=1?c.Width+f:c.Width},_getGroupTotalWeight:function(n,t,i,r){for(var f=0,o=0,s,e,h;r<t.length;r++){s=this._getShortersideLength(i.Width,i.Height);e=t[r];f+=e.AreaByWeight;var u=f/s,c=n.AreaByWeight/u,l=e.AreaByWeight/u;if(r==0&&(o=this._aspectRatio(u,s)),h=Math.max(this._aspectRatio(c,u),this._aspectRatio(l,u)),f==e.AreaByWeight||h<o)o=h;else{f-=e.AreaByWeight;u=f/s;o=Math.max(this._aspectRatio(c,u),this._aspectRatio(l,u));break}}return{totalWeight:f,index:r}},_aspectRatio:function(n,t){return n>t?n/t:t/n},_getShortersideLength:function(n,t){return n>t?t:n},_getTotalWeight:function(n){for(var i=0,t=0;t<n.length;t++)i+=parseFloat(n[t].weight);return i},_getGroupitem:function(t,i,r){var h=[],l,e,c,f,s,v,y,k;if(i!=null&&this.weightValuePath()!=null){for(e in i)f=i[e],(f.hasOwnProperty(t)?!0:this._containsProperty(f,t))&&(s=this._reflection(f,t),n.inArray(s,h)==-1&&h.push(s));for(l=[],e=0;e<h.length;e++){var o={},p=[],w=h[e],b=0,a=0,d=0;for(c=0;c<i.length;c++)f=i[c],s=this._reflection(f,t),s==w&&(v=this._reflection(f,this.weightValuePath()),y=this._reflection(f,this.colorValuePath()),p.push(f),d++,v!=null&&(a+=parseFloat(v)),y!=null&&(b+=parseFloat(y)));o.header=w;o.data=p;o.weight=a;o.colorWeight=b;o.headerHeight=r;a>0&&(k=new u(o),l.push(k))}return l}return null},_getTopGroupitem:function(n,t){var e,y,h,p;n==null&&(n=this.model.leafItemSettings.labelPath);n==null&&(n=this.weightValuePath());var i={},c=0,l=0,a=[],v=[];for(e=0;e<t.length;e++){var r=t[e],w=this._reflection(r,n),f={},o=this._reflection(r,this.weightValuePath()),s=this._reflection(r,this.colorValuePath());o!=null&&(c+=parseFloat(o));s!=null&&(l+=parseFloat(s));v.push(r);f.weight=o;f.data=r;f.header=w;f.colorWeight=s;y=new u(f);a.push(y)}return i.header="",i.data=v,i.weight=c,i.innerItem=a,i.colorWeight=l,h=[],p=new u(i),h.push(p),h},_containsProperty:function(n,t){for(var i in n)if(i==t)return!0;return!1},_reflection:function(t,i){var u=t,f,r,e;if(i!=null&&t!=null){for(f=i.split("."),r=0;r<f.length;r++)e=u.hasOwnProperty(f[r])?!0:this._containsProperty(u,f[r]),e&&n.each(u,function(n,t){if(n==f[r])return u=t,!1});return u}return null}});r=function(){this.groupBackground="white";this.groupBorderColor="#58585B";this.groupBorderThickness=1;this.groupPadding=4;this.groupPath=null;this.groupGap=1;this.headerHeight=20;this.showHeader=!0;this.showLabels=!1;this.headerTemplate=null;this.labelTemplate=null;this.treeMapItems=[]};r.prototype={};u=function(n){this.weight=n.weight;this.colorWeight=n.colorWeight;this.Data=n.data;this.headerHeight=n.headerHeight;this.header=n.header;this.label=n.header;this.headerLeftPosition=0;this.headerTopPosition=0;this.innerItems=n.innerItem;this.headerWidth=0;this.headerTemplate=null};u.prototype={_generateColorMappings:function(n){return n.rangeColorMapping.length>0?this._getRangeBrushColor(n.rangeColorMapping):n.uniColorMapping.color!=null?this._getUniColor(n.uniColorMapping):void 0},_getUniColor:function(n){return n.color},_getRangeBrushColor:function(n){for(var i,t=0;t<n.length;t++)if(i=n[t],this.colorWeight>=i.from&&this.colorWeight<=i.to)return i.color}};t.datavisualization.TreeMap.ItemsLayoutMode={Squarified:"squarified",SliceAndDiceHorizontal:"sliceanddicehorizontal",SliceAndDiceVertical:"sliceanddicevertical",SliceAndDiceAuto:"sliceanddiceauto"};t.datavisualization.TreeMap.SelectionMode={Default:"default",Multiple:"multiple"};t.datavisualization.TreeMap.GroupSelectionMode={Default:"default",Multiple:"multiple"}})(jQuery,Syncfusion)})