/*!
*  filename: ej.map.min.js
*  version : 12.3
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../web/ej.slider.min"],n):n()})(function(){(function(t,i,r){i.widget({ejMap:"ej.datavisualization.Map"},{validTags:["div"],_initPrivateProperties:function(){this._rootgroup=null;this._bubblegroup=null;this._scale=1;this._prevDistance=0;this._tileTranslatePoint={x:0,y:0};this._translatePoint={x:0,y:0};this._prevPoint=null;this._Tiles=[];this._prevScale=0;this._tileDiv=null;this._containerWidth=500;this._containerHeight=400;this._baseTranslatePoint={x:0,y:0};this._isDragging=!1;this._prevLevel=1;this._browser=null;this._baseScale=0;this._mapBounds=null;this._svgns="http://www.w3.org/2000/svg";this._ispanning=!1;this._dragStartX=0;this._isNavigationPressed=!1;this._iskeyboardKeysPressed=!1;this._isPolygonSelected=!1;this._dragStartY=0;this._width=500;this._height=500;this._svgDocument=null;this._tooltipElement=null;this._templateDiv=null;this._mapContainer=null;this._isSVG=!0;this._VMLPathFractionCount=0;this._sliderControl=null;this._isTileMap=!1;this._isRendered=!1;this._urlTemplate=null;this._polylineCount=0;this._pointscount=0;this._isPinching=!1;this._groupSize=null;this._groupBorder={x:0,y:0}},defaults:{background:"white",zoomSettings:{minValue:1,maxValue:100,factor:1,level:1,enableZoomOnSelection:!1,enableZoom:!0},centerPosition:[0,0],enableResize:!0,enableAnimation:!1,navigationControl:null,enableLayerChangeAnimation:!1,enablePan:!0,baseMapIndex:0,shapeSelected:"",markerSelected:"",zoomedIn:"",onRenderComplete:"",panned:"",zoomedOut:"",mouseover:"",mouseleave:"",layers:[]},observables:["dataSource","baseMapIndex"],enableZoom:i.util.valueFunction("zoomSettings.enableZoom"),enableZoomOnSelection:i.util.valueFunction("zoomSettings.enableZoomOnSelection"),zoomLevel:i.util.valueFunction("zoomSettings.level"),minZoom:i.util.valueFunction("zoomSettings.minValue"),zoomFactor:i.util.valueFunction("zoomSettings.factor"),maxZoom:i.util.valueFunction("zoomSettings.maxValue"),baseMapIndex:i.util.valueFunction("baseMapIndex"),dataTypes:{layers:"array"},_destroy:function(){this._unWireEvents();_isSVG?t(this.element).removeClass("e-map e-js").find("#svgDocument").remove():t(this.element).removeClass("e-map e-js").find("#rootGroup").remove()},_setModel:function(n){var i,r;for(i in n)switch(i){case"zoomSettings.level":this.enableZoom()&&this.zoom(n[i]);break;case"baseMapIndex":this.baseMapIndex(n[i]);r=this;this.model.enableAnimation?(this.model.enableLayerChangeAnimation=!0,t(this._mapContainer).animate({opacity:0},500,function(){r.refresh()})):this.refresh();break;case"minZoom":this.minZoom(n[i]);this.zoomLevel()<this.minZoom()&&this.zoom(this.minZoom());break;case"maxZoom":this.maxZoom(n[i]);this.zoomLevel()>this.maxZoom()&&this.zoom(this.maxZoom());break;case"background":this.model.background=n[i];t(this._mapContainer).css("background-image",this.model.background)}},_init:function(){var i=this,n;this._initPrivateProperties();t.each(this.model.layers,function(n){i._layerInitialize(n)});this._mapContainer=this.element;t(this._mapContainer).css({overflow:"hidden"});n=t("<style>.labelLegend {padding:3px;font-weight: normal;color:black;width:auto;height:20px;text-align:center;font-size: 14px;font-family:Segoe UI;}.labelLegend:hover{cursor:pointer;}<\/style>");t("html > head").append(n);this.refresh();this._trigger("onRenderComplete");this._isRendered=!0;_isSVG&&t(this._svgDocument).pinchZoom(this._rootgroup,this)},_layerInitialize:function(n){var i=this;this.model.layers[n]!=null?t.each(this.model.layers,function(n,r){r=i._checkArrayObject(r,n);var f=new u;t.extend(f,r);t.extend(r,f);t.each(r.subLayers,function(n,r){r=i._checkArrayObject(r,n);var f=new u;t.extend(f,r);t.extend(r,f)})}):this.layers[0]=new u},_checkArrayObject:function(n,i){var r=this;return t.each(n,function(n,t){if(t instanceof Array)r._checkArrayObject(t,n);else if(t!=null&&typeof t=="object"){var f=new u;r._loadIndividualDefaultValues(t,f,typeof n=="number"?i:n)}}),n},_loadIndividualDefaultValues:function(n,i,r){var u=null,f=this;return t.each(i,function(n,t){if(r==n){u=t;return}}),u instanceof Array&&(u=u[0]),t.each(n,function(n,t){t instanceof Array?f._checkArrayObject(t,r):t!=null&&typeof t=="object"&&f._loadIndividualDefaultValues(t,t,typeof n=="number"?r:n)}),t.extend(u,n),t.extend(n,u),n},_refreshWithAnimation:function(){this.model.layers[this.baseMapIndex()]._setMapItemsPositionWithAnimation(this);for(var n=0;n<this.model.layers[this.baseMapIndex()].subLayers.length;n++)this.model.layers[this.baseMapIndex()].subLayers[n]._setMapItemsPositionWithAnimation(this)},_resizeShape:function(){this.model.layers[this.baseMapIndex()]._resizeShapes(this);for(var n=0;n<this.model.layers[this.baseMapIndex()].subLayers.length;n++)this.model.layers[this.baseMapIndex()].subLayers[n]._resizeShapes(this)},_refrshLayers:function(){this.model.layers[this.baseMapIndex()]._setMapItemsPosition(this);for(var n=0;n<this.model.layers[this.baseMapIndex()].subLayers.length;n++)this.model.layers[this.baseMapIndex()].subLayers[n]._setMapItemsPosition(this)},_panTileMap:function(n,t,i){var u=Math.pow(2,this.zoomLevel())*256,r;this._tileTranslatePoint.x=n/2-u/2;this._tileTranslatePoint.y=t/2-u/2;r=this._convertTileLatLongtoPoint(i[0],i[1]);this._tileTranslatePoint.x-=r.x-n/2;this._tileTranslatePoint.y-=r.y-t/2},_generateTiles:function(n){var w=navigator.language||navigator.userLanguage,b,k,e,o,s,h,r,p,c,u,l,a,v;this.Tiles=[];b=k=Math.pow(2,n);var y=this.model.layers[this.baseMapIndex()],d=Math.min(k,(-this._tileTranslatePoint.y+this._height)/256+1),g=Math.min(b,(-this._tileTranslatePoint.x+this._width)/256+1),nt=-(this._tileTranslatePoint.x+256)/256,tt=-(this._tileTranslatePoint.y+256)/256;for(e=Math.round(nt);e<Math.round(g);e++)for(o=Math.round(tt);o<Math.round(d);o++)s=256*e+this._tileTranslatePoint.x,h=256*o+this._tileTranslatePoint.y,s>-256&&s<=this._width&&h>-256&&h<this._height&&e>=0&&o>=0&&(r=new f(e,o),r.left=s,r.top=h,r.src=y.layerType==i.datavisualization.Map.LayerType.Bing?this._getBingMap(r,y.key,y.bingMapType,w):this._urlTemplate.replace("level",this.zoomLevel()).replace("tileX",r.X).replace("tileY",r.Y),this.Tiles.push(r));for(p=t.extend(!0,[],this.Tiles),c=0;c<this.model.layers[this.baseMapIndex()].subLayers.length;c++)if(u=this.model.layers[this.baseMapIndex()].subLayers[c],u.layerType==i.datavisualization.Map.LayerType.OSM||u.layerType==i.datavisualization.Map.LayerType.Bing)for(l=0;l<p.length;l++)a=p[l],v=t.extend(!0,{},a),v.src=u.layerType==i.datavisualization.Map.LayerType.Bing?this._getBingMap(v,u.key,u.bingMapType,w):u.urlTemplate.replace("level",this.zoomLevel()).replace("tileX",a.X).replace("tileY",a.Y),this.Tiles.push(v);this._arrangeTiles()},_getBingMap:function(n,t,r,u){for(var f,s,h,e="",o=this.zoomLevel();o>0;o--)f=0,s=1<<o-1,(n.X&s)!=0&&f++,(n.Y&s)!=0&&(f+=2),e=e+""+f;return h=r==i.datavisualization.Map.BingMapType.Aerial?"A,G":r==i.datavisualization.Map.BingMapType.AerialWithLabel?"A,G,L":"G,VE,BX,L,LA","http://ak.dynamic.t2.tiles.virtualearth.net/comp/ch/"+e+"?mkt="+u+"&ur=IN&it="+h+"&shading=hill&og=45&n=z&Key="+t},_arrangeTiles:function(){var n=t.templates("<div><div style='position:absolute;left:{{:left}}px;top:{{:top}}px;height:{{:height}}px;width:{{:width}}px;'><img src={{:src}}><\/img><\/div><\/div>"),i=n.render(this.Tiles),r=this._mapContainer[0].children[0];this._tileDiv.html(i)},_generatePath:function(){var n=this.model.layers[this.baseMapIndex()],f="",u,e,o;for(this._polylineCount=0,this._pointscount=0,_isSVG=window.SVGSVGElement?!0:!1,n.layerType==i.datavisualization.Map.LayerType.Geometry?n!=r&&n.shapeData!=null&&(n._isBaseLayer=!0,this._isTileMap=!1,this._scale=this.zoomLevel(),f=this._readShapeData(n)):(this._isTileMap=!0,this._scale=Math.pow(2,this.zoomLevel()-1)),u=0;u<n.subLayers.length;u++)n.subLayers[u].layerType==i.datavisualization.Map.LayerType.Geometry&&n.subLayers[u].shapeData!=null&&(n.subLayers[u]._isBaseLayer=!1,f+=this._readShapeData(n.subLayers[u]));_isSVG?(e='<div style="position:relative;" id="tileDiv"/><svg xmlns="http://www.w3.org/2000/svg" style= "overflow:hidden;z-index:0;float:left;left:0,top:0"id="svgDocument"> <g id="rootGroup">'+f+"<\/g><\/svg>",this._mapContainer.html(e),this._svgDocument=this.element.find("#svgDocument")[0],this._tileDiv=this.element.find("#tileDiv"),t(this._svgDocument).css({height:this._height,width:this._width})):(document.createStyleSheet().addRule(".vml","behavior:url(#default#VML);display:inline-block"),document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),o='<div id="tileDiv"/><v:group   id = "rootGroup" style="position:absolute; width:'+this._width+"px;height:"+this._height+'px;" coordorigin = "0 0" coordsize="'+this._width+" "+this._height+'">'+f+"<\/v:group>",this._mapContainer.html(o),this._tileDiv=this.element.find("#tileDiv"),this._bubblegroup=this._createGroup(!1,"bubbleGroup"),this._bubblegroup.style.position="absolute",this.element.append(this._bubblegroup));(n.layerType==i.datavisualization.Map.LayerType.OSM||n.layerType==i.datavisualization.Map.LayerType.Bing)&&(this._urlTemplate=n.urlTemplate,this._panTileMap(this._width,this._height,this.model.centerPosition),this._generateTiles(this.zoomLevel()),_isSVG&&t(this._svgDocument).css("position","relative"));_isSVG&&t(this._mapContainer).css("position","absolute");this._rootgroup=this.element.find("#rootGroup")[0]},_calculateBBox:function(n,t,i){var f=maxLatitude=minLongitude=maxLongitude=0,o=!1,l,c,r,h,e,s,u;if(n!=null&&n.length>0)for(e=0;e<n.length;e++)for(h=n[e],coords=h.geometry!=null?h.geometry.coordinates:h.coordinates,l=coords.length,c=0;c<l;c++)if(r="",l>1?(r=coords[c][0],r.length<=2&&(r=coords[c])):r=coords[c],r.length>2)for(u=0;u<r.length;u++)o?(f=Math.min(f,r[u][1]),maxLatitude=Math.max(maxLatitude,r[u][1]),minLongitude=Math.min(minLongitude,r[u][0]),maxLongitude=Math.max(maxLongitude,r[u][0])):(f=maxLatitude=r[u][1],minLongitude=maxLongitude=r[u][0],o=!0);else o?(f=Math.min(f,r[1]),maxLatitude=Math.max(maxLatitude,r[1]),minLongitude=Math.min(minLongitude,r[0]),maxLongitude=Math.max(maxLongitude,r[0])):(f=maxLatitude=r[1],minLongitude=maxLongitude=r[0],o=!0);if(i!=null&&i.length>0)for(e=0;e<i.length;e++)h=i[e],r=h.geometry.coordinates,o?(f=Math.min(f,r[1]),maxLatitude=Math.max(maxLatitude,r[1]),minLongitude=Math.min(minLongitude,r[0]),maxLongitude=Math.max(maxLongitude,r[0])):(f=maxLatitude=r[1],minLongitude=maxLongitude=r[0],o=!0);if(t!=null&&t.length>0)for(e=0;e<t.length;e++)for(s=t[e].geometry.coordinates,u=0;u<s.length;u++)o?(f=Math.min(f,s[u][1]),maxLatitude=Math.max(maxLatitude,s[u][1]),minLongitude=Math.min(minLongitude,s[u][0]),maxLongitude=Math.max(maxLongitude,s[u][0])):(f=maxLatitude=s[u][1],minLongitude=maxLongitude=s[u][0],o=!0);return[[minLongitude,f],[maxLongitude,maxLatitude]]},_readShapeData:function(n){var u=this,t,r;if(n.shapeData!=null)if(typeof n.shapeData=="string")t=new i.DataManager(n.shapeData),r=i.Query().from(n),t.executeQuery(r).done(function(t){if(t.result!=null)return u._getPathCollection(t.result,n)});else return this._getPathCollection(n.shapeData,n)},_getPathCollection:function(n,r){var ct="",y="",p="",rt,ti,pt,ut,ft,et,ot,lt,k,at,vt,a,st,ht,g,h,v,s,n,u,d,o,nt,f,e,tt,it,c,yt,wt;if(n.features!=null?(p=new i.DataManager(n.features),y="geometry.type",r._isBaseLayer&&(this._mapBounds=n.bbox)):n.geometries!=null&&(p=new i.DataManager(n.geometries),y="type",r._isBaseLayer&&n.bbox!=null&&(this._mapBounds=[[n.bbox[0],n.bbox[1]],[n.bbox[2],n.bbox[3]]])),n.geometries!=null||n.features!=null){var bt=i.Query().from(r).where(y,i.FilterOperators.equal,"LineString"),kt=i.Query().from(r).where(y,i.FilterOperators.equal,"Polygon"),dt=i.Query().from(r).where(y,i.FilterOperators.equal,"MultiPolygon"),w=p.executeLocal(bt),l=p.executeLocal(kt),gt=i.Query().from(r).where(y,i.FilterOperators.equal,"Point"),b=p.executeLocal(gt),ni=p.executeLocal(dt);if(this._polylineCount=this._polylineCount+w.length,this._pointscount=this._pointscount+b.length,t.merge(l,ni),this._mapBounds==null&&r._isBaseLayer&&(this._mapBounds=this._calculateBBox(l,w,b)),r._newBounds=[],rt="",b.length>0)for(e=0;e<b.length;e++)k=b[e],ti="",s=k.geometry.coordinates,n=[],u=[],n.push({lat:parseFloat(s[1]),lng:parseFloat(s[0])}),d=0,o=n[0],latitude=o.lat,longitude=o.lng,f=this._convertTileLatLongtoPointForShapes(latitude,longitude,this._mapBounds),_isSVG?u.push({x:f.x,y:f.y,lat:o.lat,lng:o.lng}):u.push({x:f.x-5/this._scale,y:f.y-5/this._scale,lat:o.lat,lng:o.lng}),_isSVG?rt+='<circle cx="'+u[0].x+'" cy="'+u[0].y+'" r="'+5/this._scale+'" stroke="'+r.shapeSettings.stroke+'" stroke-width="'+r.shapeSettings.strokeThickness+'0" fill="'+r.shapeSettings.fill+'" />':(pt='<v:oval display="block" fill="'+r.shapeSettings.fill+'" style="position:absolute;top: '+u[0].y+"px;left:"+u[0].x+"px;width:"+10/this._scale+"px;height:"+10/this._scale+"px;stroke-width:"+r.shapeSettings.strokeThickness+'px;"><\/v:oval>',rt+=pt);if(l.length>0){for(lt=!0,e=0;e<l.length;e++){if(k=l[e],at=0,a=k.geometry!=null?k.geometry.coordinates:k.coordinates,vt=a[0][0].length,st=a.length,st>1)for(ht=a,g=0;g<ht.length;g++)vt<ht[g][0].length&&(vt=ht[g][0].length,at=g);for(h="",v=0;v<st;v++){if(s="",st>1?(s=a[v][0],s.length<=2&&(s=a[v])):s=a[v],n=[],u=[],s.length>2)for(c=0;c<s.length;c++)n.push({lat:parseFloat(s[c][1]),lng:parseFloat(s[c][0])});else n.push({lat:parseFloat(s[1]),lng:parseFloat(s[0])});for(d=0;d<n.length-1||n.length==1&&d==0;d++)o=n[d],latitude=o.lat,longitude=o.lng,nt=this._mapBounds,(this._isTileMap||longitude>=nt[0][0]&&longitude<=nt[1][0]&&latitude>=nt[0][1]&&latitude<=nt[1][1])&&(f=this._convertTileLatLongtoPointForShapes(latitude,longitude,nt),lt?(ut=ft=f.x,et=ot=f.y,lt=!1):(ut=Math.min(ut,f.x),ft=Math.max(ft,f.x),et=Math.min(et,f.y),ot=Math.max(ot,f.y)),_isSVG?u.push({x:f.x,y:f.y,lat:o.lat,lng:o.lng}):u.push({x:f.x,y:f.y,lat:o.lat,lng:o.lng}));if(v==at&&r._newBounds.push(this._findMidPointofPoylgon(u)),u.length>0)if(_isSVG){for(h+="M"+u[0].x+","+u[0].y,m=1;m<u.length;m++)h+=","+u[m].x+","+u[m].y;h+="Z"}else{for(h+="m"+parseInt(u[0].x)+","+parseInt(u[0].y),h+=" l"+parseInt(u[0].x)+","+parseInt(u[0].y),m=1;m<u.length;m++)h+=","+parseInt(u[m].x)+","+parseInt(u[m].y);h+=" e"}}h!=""?ct+=_isSVG?'<path class="mapShape" stroke='+r.shapeSettings.stroke+" stroke-width="+r.shapeSettings.strokeThickness/this._scale+" fill= "+r.shapeSettings.fill+' d="'+h+'"  stroke-linejoin= round stroke-linecap= square><\/path>':'<v:shape  style="width:'+this._width+"px;height:"+this._height+'px;"  coordsize="'+this._width+" "+this._height+'" coordorigin="0 0" strokecolor='+r.shapeSettings.stroke+" stroke-width="+r.shapeSettings.strokeThickness/this._scale+'px" fillcolor= '+r.shapeSettings.fill+' path="'+h+'"><\/v:shape>':(l.splice(e,1),e--)}this._groupSize={minX:ut,maxX:ft,minY:et,maxY:ot}}if(w.length>0)for(e=0;e<w.length;e++){for(tt=w[e].geometry.coordinates,it="",c=0;c<tt.length;c++)yt=this._convertTileLatLongtoPointForShapes(tt[c][1],tt[c][0],this._mapBounds),it+=yt.x+","+yt.y,c!=tt.length-1&&(it+=",");ct+=_isSVG?"<polyline stroke="+r.shapeSettings.stroke+" stroke-width="+r.shapeSettings.strokeThickness/this._scale+' fill="transparent" stroke-width="1" points="'+it+'" ><\/polyline>':'<v:polyline coordsize="'+this._width+","+this._height+'" coordorigin="0 0" strokecolor='+r.shapeSettings.stroke+" strokeweight="+r.shapeSettings.strokeThickness/this._scale+'px" fillcolor='+r.shapeSettings.fill+'  points="'+it+'"/>'}return wt=[].concat(l,w),r._polygonData=t.merge(wt,b),ct+rt}return r._polygonData=[],null},_createGroup:function(n,t){var i;return i=document.createElement("<v:group class="+t+">"),i.style.width=this._width+"px",i.style.height=this._height+"px",i.coordorigin="0 0",i.coordsize=this._width+" "+this._height,n&&(this._rootgroup=i,i.style.left="20px",i.style.top="20px"),i},_generatePaletteColorsForShape:function(n,t,i,r){r!=null&&(t.shapeSettings.highlightColor=r.highlightColor,t.shapeSettings.highlightStroke=r.highlightStroke,t.shapeSettings.highlightBorderWidth=r.highlightBorderWidth,t.shapeSettings.selectionColor=r.SelectionColor,t.shapeSettings.selectionStroke=r.SelectionStroke,t.shapeSettings.selectionStrokeWidth=r.SelectionStrokeWidth);_isSVG?n.setAttribute("fill",i[t._prevPaletteIndex]):n.fillcolor=i[t._prevPaletteIndex];t._prevPaletteIndex=t._prevPaletteIndex+1;t._prevPaletteIndex>i.length-1&&(t._prevPaletteIndex=0)},_renderLayers:function(n,u){var b,p,nt,ct,lt,at,v,l,et,ot,w,yt,tt,it,pt,wt,s,st,bt,rt,k,ht,ut,y,a;n._initializeLocalValues();var dt=this._rootgroup,kt=this._svgDocument,o=this,f=n;f.legendSettings!=null&&f.shapeSettings.colorMappings!=null&&(f.legendSettings.type==r||f.legendSettings.type==i.datavisualization.Map.LegendType.Layers)&&f._generateLegends(this);f.legendSettings!=null&&f.bubbleSettings.colorMappings!=null&&f.legendSettings.type==i.datavisualization.Map.LegendType.Bubbles&&f._generateBubbleLegends(this);f.shapeSettings.colorMappings!=null&&f.shapeSettings.colorMappings.rangeColorMapping!=null&&f.shapeSettings.colorMappings.rangeColorMapping.sort(this._orderByNameAscending);f.bubbleSettings.colorMappings!=null&&f.bubbleSettings.colorMappings.rangeColorMapping!=null&&f.bubbleSettings.colorMappings.rangeColorMapping.sort(this._orderByNameAscending);var d=0,g=0;if(f.dataSource!=null&&f.bubbleSettings!=null)for(f.bubbleSettings.colorValuePath==null&&(f.bubbleSettings.colorValuePath=f.bubbleSettings.valuePath),b=0;b<f.dataSource.length;b++)p=parseFloat(this._reflection(f.dataSource[b],f.bubbleSettings.valuePath)),b!=0?p>g?g=p:p<d&&(d=p):d=g=p;if(this._generateTooltipForLayers(f),f.shapeData!=null){nt=[];for(ct in f.dataSource)lt=f.dataSource[ct],at=o._reflection(lt,f.shapeDataPath),nt.push(at);for(v=0;v<f._polygonData.length;v++){var vt=f._polygonData[v].properties,ft=o._reflection(vt,f.shapePropertyPath),e=this._rootgroup.childNodes[v+u],h={},c=f._newBounds[v];if(f.shapeSettings.autoFill)switch(f.shapeSettings.colorPalette){case i.datavisualization.Map.ColorPalette.Palette1:this._generatePaletteColorsForShape(e,f,f.colorPalettes.Palette1,f._colorPaletteSettings.Palette1);break;case i.datavisualization.Map.ColorPalette.Palette2:this._generatePaletteColorsForShape(e,f,f.colorPalettes.Palette2,f._colorPaletteSettings.Palette2);break;case i.datavisualization.Map.ColorPalette.Palette3:this._generatePaletteColorsForShape(e,f,f.colorPalettes.Palette3,f._colorPaletteSettings.Palette3);break;case i.datavisualization.Map.ColorPalette.CustomPalette:this._generatePaletteColorsForShape(e,f,f.shapeSettings.customPalette,null)}nt.indexOf(ft)!=-1&&(l=f.dataSource[nt.indexOf(ft)],et=ft,l!=null&&(e!=null&&(ot=et),n._bounds.push(c),f.showMapItems&&(w=t("<div class='mapItems' style='display:block;position:absolute;pointer-events: none;'><\/div>"),w[0].className=et,o._templateDiv.append(w),t(w).css({left:c.x,top:c.y}),yt=f.mapItemsTemplate==null?t(" <div><label>{{:"+f.shapeSettings.valuePath+"}}<\/label><\/div>").render(l):t("#"+f.mapItemsTemplate).render(l),t(w).html(yt),n._mapItems.push(w)),f.shapeSettings.colorMappings!=null?(f.shapeSettings.colorValuePath==null&&(f.shapeSettings.colorValuePath=f.shapeSettings.valuePath),tt=o._reflection(l,f.shapeSettings.colorValuePath),tt==null||f.shapeSettings.autoFill||((f.legendSettings!=null&&f.legendSettings.mode==i.datavisualization.Map.LegendMode.Interactive||f.shapeSettings.enableGradient)&&f.shapeSettings.colorMappings.rangeColorMapping!=null?(h.legendrect=f._updateLegendRange(tt,f,e),it=f.shapeSettings.fill,h.legendrect!=r&&(it=h.legendrect.color),_isSVG?e.setAttribute("fill",it):e.fillcolor=it):f._fillColors(tt,f.shapeSettings.colorMappings,e))):f.shapeSettings.autoFill||(_isSVG?e.setAttribute("fill",f.shapeSettings.fill):(e.fillcolor=f.shapeSettings.fill,e.strokecolor=f.shapeSettings.stroke)),f.bubbleSettings!=null&&f.bubbleSettings.valuePath!=null&&(_isSVG?s=document.createElementNS(o._svgns,"circle"):(pt="bubble_"+ot,wt='<v:oval class="mapBubble" id='+pt+' display="block" style="position:absolute;top: 0px;left:0px;width:100px;height:100px;stroke-width:0px;"><v:fill opacity="0.9"/><\/v:oval>',this._bubblegroup.innerHTML=this._bubblegroup.innerHTML+wt,s=document.getElementById("bubble_"+ot)),st=o._reflection(l,f.bubbleSettings.valuePath),bt=o._reflection(l,f.bubbleSettings.colorValuePath),f.bubbleSettings.colorMappings!=null?f._fillColors(bt,f.bubbleSettings.colorMappings,s):_isSVG?s.setAttribute("fill",f.bubbleSettings.color):(s.strokecolor=f.bubbleSettings.color,s.fillcolor=f.bubbleSettings.color),rt=o._getRatioOfBubble(f.bubbleSettings.minValue,f.bubbleSettings.maxValue,st,d,g),_isSVG?(t(s).attr({cx:c.x,cy:c.y,"fill-opacity":"0.9",r:rt,"class":"mapBubble"}),o.model.enableAnimation&&t(s).css("display","none")):t(s).css({height:2*rt+"px",width:2*rt+"px"}),f.bubbleSettings.showTooltip==!0?(k=t("<div class='bubbleToolTip'  style='position:absolute;display:none;z-index:9999'/>"),ht=null,f.bubbleSettings.tooltipTemplate!=null?ht=f.bubbleSettings.tooltipTemplate:t(k).append('<div class="bubbleToolTip"  style="margin-left:10px;margin-top:-25px;"><div class="defaultToolTip"><p style="margin-top:-4px"><label  style="color:rgb(27, 20, 20);font-size:14px;font-weight:normal;font-family:Segoe UI">'+st+"<\/label><\/p><\/div><\/div>"),t(s).mouseenter({htmlobj:k,templateID:ht,itemsrc:l},o._bubbleEnterFunction),t(s).mousemove({htmlobj:k},o._bubbleOverFunction),t(s).mouseleave({htmlobj:k},o._bubbleleaveFunction)):t(s).css("pointer-events","none"),_isSVG?(kt.appendChild(s),n._bubbles.push(s)):n._bubbles.push(s)),h.data=l));n.labelSettings!=null&&n.labelSettings.showLabels&&n.labelSettings.labelPath!=null&&(ut=o._reflection(vt,n.labelSettings.labelPath),ut!=null&&(c==null,y=t("<div class='labelStyle' style='font-family:Segoe UI;font-size:14px;white-space: nowrap;position:absolute;pointer-events:stroke;'><\/div>"),y[0].innerHTML=ut,this._templateDiv.append(y),t(y).css({left:c.x,top:c.y}),o._on(t(y),i.eventType.mouseDown,{Param1:null,Param2:n,Param3:e},o._polyClickFunction),o._on(t(y),i.eventType.mouseLeave,{Param1:n,map:this},o._polyLeaveFunction),n._labelCollection.push(y),n._labelBounds.push(c),n._labelData.push(ut)));h.shape=e;h.shapeData=n._polygonData[v];e!=null&&(a=null,_isSVG?(a=e.getAttribute("fill"),a=="undefined"&&(a=n.shapeSettings.fill),e.setAttribute("nodeValue",a)):(a=e.fillcolor.value,a=="undefined"&&(a=n.shapeSettings.fill),e.style.behavior=a));o.enableZoomOnSelection()&&t(e).hover(function(){t(this).css("cursor","pointer")},function(){t(this).css("cursor","auto")});n._mapShapes.push(h);t(e).mouseenter({Param1:f,Param2:h,map:o},o._polyEnterFunction);this._on(t(e),i.eventType.mouseDown,{Param1:h,Param2:f,Param3:e},o._polyClickFunction);this._on(t(e),i.eventType.mouseMove,{Param1:f,Param2:h},o._polyMoveFunction);this._on(t(e),i.eventType.mouseLeave,{Param1:f,Param2:h,map:this},o._polyLeaveFunction);this._on(t(e),i.eventType.mouseUp,{Param1:h,Param2:f,Param3:e},o._polyUpFunction)}}},_zooming:function(n,t){var i=this._getCurrentPoint(t);n>=120?this._zoomingIn(i.x,i.y,t):this._zoomingOut(i.x,i.y,t)},_zoomingIn:function(n,t,i,u){var f=this,o,s,e;f.enableZoom()&&f.zoomLevel()>=f.minZoom()&&f.zoomLevel()<=f.maxZoom()&&(o=f._scale,s={x:n,y:t},f._prevScale=o,this._isTileMap?(this._tileZoom(f.zoomLevel()-1,f.zoomLevel(),s),e=f.zoomLevel(),f.zoomLevel(f.zoomLevel()+1),this._generateTiles(this.zoomLevel()),f._translatePoint.x=(f._tileTranslatePoint.x-.5*Math.pow(2,e))/Math.pow(2,e),f._translatePoint.y=(f._tileTranslatePoint.y-.5*Math.pow(2,e))/Math.pow(2,e),f._scale=Math.pow(2,e)):(f._prevPoint={x:f._translatePoint.x,y:f._translatePoint.y},f._translatePoint.x-=(f._width/f._scale-f._width/(f._scale+f.zoomFactor()))/(f._width/n),f._translatePoint.y-=(f._height/f._scale-f._height/(f._scale+f.zoomFactor()))/(f._height/t),f._scale=o+f.zoomFactor(),f.zoomLevel(f.zoomLevel()+1)),u!=r&&u&&!this._isTileMap?f._animate(600):(f._trigger("zoomedIn",{originalEvent:i,zoomLevel:f.zoomLevel()}),f._applyTransform(f._scale,f._translatePoint),f._refrshLayers(),f._resizeShape()),f._updateSliderValue())},_zoomingOut:function(n,t,i,u){var f=this,e,o,s;this.enableZoom()&&(this.zoomLevel()>this.minZoom()?(e=f._scale,o={x:n,y:t},f._prevScale=e,this._isTileMap?(this._tileZoom(f.zoomLevel()+1,f.zoomLevel(),o),s=f.zoomLevel(),f.zoomLevel(f.zoomLevel()-1),this._generateTiles(this.zoomLevel()),f._translatePoint.x=(f._tileTranslatePoint.x-.5*Math.pow(2,this.zoomLevel()-1))/Math.pow(2,this.zoomLevel()-1),f._translatePoint.y=(f._tileTranslatePoint.y-.5*Math.pow(2,this.zoomLevel()-1))/Math.pow(2,this.zoomLevel()-1),f._scale=Math.pow(2,this.zoomLevel()-1)):(f._prevPoint={x:f._translatePoint.x,y:f._translatePoint.y},f._translatePoint.x-=(f._width/f._scale-f._width/(f._scale-f.zoomFactor()))/(f._width/n),f._translatePoint.y-=(f._height/f._scale-f._height/(f._scale-f.zoomFactor()))/(f._height/t),f._scale=f._scale-f.zoomFactor(),f.zoomLevel(f.zoomLevel()-1)),u!=r&&u&&!this._isTileMap?f._animate(600):(f._applyTransform(f._scale,f._translatePoint),f._refrshLayers(),f._resizeShape()),f._updateSliderValue()):this.zoom(this.minZoom(),!1),f._trigger("zoomedOut",{originalEvent:i,zoomLevel:f.zoomLevel()}))},_getRatioOfBubble:function(n,t,i,r,u){var f=100/(u-r)*(i-r);return(parseFloat(t)-parseFloat(n))/100*f+parseFloat(n)},_reflection:function(n,i){var f=n,e,u,o;if(i!=null&&n!=null){for(e=i.split("."),u=0;u<e.length;u++)n!=r&&(o=f.hasOwnProperty(e[u]),o&&t.each(f,function(n,t){if(n==e[u])return f=t,!1}));return f}return null},clearShapeSelection:function(){var t=this.baseMapIndex(),n;for(this.model.layers[t]._clearShapeWidth(this._scale),n=0;n<this.model.layers[t].subLayers.length;n++)this.model.layers[t].subLayers[n]._clearShapeWidth(this._scale)},refreshMarkers:function(){var t=this.baseMapIndex(),n;for(this.model.layers[t]._generateMarkerForLayers(this),n=0;n<this.model.layers[t].subLayers.length;n++)this.model.layers[t].subLayers[n]._generateMarkerForLayers(this)},_generateTooltipForLayers:function(n){var i,r;n.showTooltip&&(i=t(".tooltipTemplateDiv"),i=t("<div class='shapeToolTip' style='z-index:1000;display:none;position:absolute;pointer-events:none;'><\/div>"),t(document.body).append(i),n._tooltipElement=i,n.tooltipTemplate==null&&(r=n.shapeSettings.valuePath,r!=null&&(n.tooltipTemplate="defaultTooltip",this._mapContainer.append(t('<div  id="defaultTooltip" style="display:none;"><div style="margin-left:10px;margin-top:-25px;"><div class="defaultToolTip"><p style="margin-top:-4px"><label  style="color:rgb(27, 20, 20);font-size:14px;font-weight:normal;font-family:Segoe UI">{{:'+r+"}}<\/label><\/p><\/div><\/div><\/div>")))))},_orderByNameAscending:function(n,t){return n.Range==t.Range?0:n.Range>t.Range?1:-1},_resizingContainer:function(){this._scale=this._isTileMap?Math.pow(2,this.zoomLevel()-1):this.zoomLevel();this._isTileMap?(this._translatePoint.x=this._tileTranslatePoint.x/this._scale,this._translatePoint.y=this._tileTranslatePoint.y/this._scale):(this._translatePoint.x=this._tileTranslatePoint.x/this._scale,this._translatePoint.y=this._tileTranslatePoint.y/this._scale);this._applyTransform(this._scale,this._translatePoint);this._baseScale=this._scale;this._baseTranslatePoint={x:this._translatePoint.x*2,y:this._translatePoint.y*2}},_calculateMarginConditions:function(){var n=this._calculateMinMax();this._translatePoint.y>n.maxY?this._translatePoint.y=n.maxY:this._translatePoint.y<n.minY&&(this._translatePoint.y=n.minY);this._translatePoint.x>n.maxX?this._translatePoint.x=n.maxX:this._translatePoint.x<n.minX&&(this._translatePoint.x=n.minX)},_calculateMinMax:function(){var n=this._groupBorder,t,i,r,u;return this._containerHeight*this._scale<=this._height?(i=(this._height-this._containerHeight*this._scale)/(2*this._scale)-n.y,u=(this._height-this._containerHeight*this._scale)/(2*this._scale)-n.y):(i=0,u=(this._height-this._containerHeight*this._scale)/this._scale-n.y),this._containerWidth*this._scale<=this._width?(t=(this._width-this._containerWidth*this._scale)/(2*this._scale)-n.x,r=(this._width-this._containerWidth*this._scale)/(2*this._scale)-n.x):(t=0,r=(this._width-this._containerWidth*this._scale)/this._scale-n.x),{minX:r,maxX:t,minY:u,maxY:i}},_findMidPointofPoylgon:function(n){for(var c,l,a=n.length,t=n[0],v=t.x,y=t.x,p=t.y,w=t.y,f,e,i,r,u=0,o=0,s=0,h=0;h<=a-1;h++)c=n[h],f=c.x,e=c.y,h==a-1?(i=t.x,r=t.y):(l=n[h+1],i=l.x,r=l.y),u=u+Math.abs(f*r-i*e),o=o+Math.abs((f+i)*(f*r-i*e)),s=s+Math.abs((e+r)*(f*r-i*e));return u=.5*u,o=1/(4*u)*o,s=1/(4*u)*s,{x:o,y:s}},_convertTileLatLongtoPointForShapes:function(n,t,i,r){var f,o,e,s,u;i==null&&(i=[[-180,-85],[180,85]]);this._isTileMap?f=Math.pow(2,1)*256:(this._height<this._width?(e=(i[1][1]-i[0][1])/170*100,o=this._height/(e*this._height/100)):(e=(i[1][0]-i[0][0])/360*100,o=this._width/(e*this._width/100)),f=Math.min(this._height,this._width)*o);s=(t+180)/360;u=Math.sin(n*Math.PI/179.5);u==-1&&(u=-.5);var l=.5-Math.log((1+u)/(1-u))/(4*Math.PI),h=s*f+.5,c=l*f+.5;return r!=null&&(h-=r.x,c-=r.y),{x:h,y:c}},_convertTileLatLongtoPoint:function(n,t){var i=Math.pow(2,this.zoomLevel())*256,u=(t+180)/360,r=Math.sin(n*Math.PI/180),f=.5-Math.log((1+r)/(1-r))/(4*Math.PI),e=u*i+.5+this._tileTranslatePoint.x,o=f*i+.5+this._tileTranslatePoint.y;return{x:e,y:o}},_convertLatLongtoPointforMarker:function(n,t){var i=this._convertTileLatLongtoPointForShapes(n,t,this._mapBounds);return{x:(i.x+this._translatePoint.x)*this._scale,y:(i.y+this._translatePoint.y)*this._scale}},_animate:function(n){function s(n,t){return n[0]==t[0]?null:(t[1]-n[1])/(t[0]-n[0])}function h(n,t){return t===null?n[0]:n[1]-t*n[0]}this._calculateMarginConditions();t(this._rootgroup).stop(!0,!1);this._sliderControl!=null&&t(this._sliderControl).stop(!0,!1);var i=this,e={x:this._translatePoint.x,y:this._translatePoint.y},r=[this._prevPoint.x,this._prevPoint.y],u=[this._translatePoint.x,this._translatePoint.y];var f=s(r,u),c=h(r,f),l=u[0]-r[0],a=u[1]-r[1],v=this._scale-this._prevScale,o=this._scale;this._updateSliderValue();t(this._rootgroup).animate({count:10},{duration:n,step:function(n,t){var u=i._prevScale+n*(v/t.end),e=r[0]+n*(l/t.end)/(u/o),s;s=f==null?r[1]+n*(a/t.end):f*e+c;_isSVG?i._rootgroup.setAttribute("transform","scale("+u+") translate("+e+", "+s+")"):(i._rootgroup.coordorigin=-e+","+-s,i._rootgroup.coordsize=i._width/u+","+i._height/u);i._translatePoint.x=e;i._translatePoint.y=s;i._scale=u;i._refrshLayers();i._resizeShape()},complete:function(){i._translatePoint.x=e.x;i._translatePoint.y=e.y;i._scale=o;this.count=0}})},_applyTransform:function(n,t){this._scale=n;this._translatePoint=t;this._isTileMap||this._calculateMarginConditions();_isSVG?this._rootgroup.setAttribute("transform","scale("+this._scale+") translate("+this._translatePoint.x+", "+this._translatePoint.y+")"):(this._rootgroup.coordorigin=-this._translatePoint.x+","+-this._translatePoint.y,this._rootgroup.coordsize=this._width/n+","+this._height/n)},_mouseMove:function(n){var t,i,f,e,r,u;n.type=="touchmove"&&n.originalEvent.touches.length>1?this._isPinching=!0:(t=this,t.ispanning&&t.model.enablePan&&(n.preventDefault(),n.type=="mousemove"?i={x:n.pageX,y:n.pageY}:n.type=="touchmove"?i={x:n.originalEvent.changedTouches[0].pageX,y:n.originalEvent.changedTouches[0].pageY}:n.type=="MSPointerMove"&&(i={x:n.originalEvent.pageX,y:n.originalEvent.pageY}),this._isTileMap&&(f=this._tileTranslatePoint.x-(this._dragStartX-i.x),e=this._tileTranslatePoint.y-(this._dragStartY-i.y),this._tileTranslatePoint.x=f,this._tileTranslatePoint.y=e,this._generateTiles(this.zoomLevel())),r=t._translatePoint.x-(t._dragStartX-i.x)/t._scale,u=t._translatePoint.y-(t._dragStartY-i.y)/t._scale,(r!=t._translatePoint.x||u!=t._translatePoint.y)&&(t._isDragging=!0),this._translatePoint.x=r,this._translatePoint.y=u,t._applyTransform(t._scale,t._translatePoint),t._dragStartX=i.x,t._dragStartY=i.y,t._refrshLayers()))},_svgMouseLeave:function(){var n=this;n.ispanning=!1},_mouseWheel:function(n){this.model.enableAnimation&&t(this._rootgroup).stop(!0,!1);var i=n.originalEvent,r=n;_isSVG||(i=n);i.preventDefault?i.preventDefault():r.preventDefault();_isSVG?this._zooming(n.originalEvent.wheelDelta,n.originalEvent):this._zooming(n.originalEvent.wheelDelta,i)},_mouseButtonUp:function(n){var t=this;t.ispanning&&t._trigger("panned",{originalEvent:n});t.ispanning=!1},_mouseUp:function(){this.ispanning=!1;this._isDragging=!1},_mouseButtonDown:function(n){var i,r;this._isPinching=!1;n.target.className!="e-vhandle"&&(this._isNavigationPressed=!1,this.model.enableAnimation&&(t(this._rootgroup).stop(!0,!1),this._sliderControl!=null&&t(this._sliderControl).stop(!0,!1)),n.type=="touchstart"&&n.originalEvent.touches.length>1||(n.preventDefault(),n.type=="mousedown"?i={x:n.pageX,y:n.pageY}:n.type=="touchstart"?i={x:n.originalEvent.changedTouches[0].pageX,y:n.originalEvent.changedTouches[0].pageY}:n.type=="MSPointerDown"&&(i={x:n.originalEvent.pageX,y:n.originalEvent.pageY}),r=this,r.ispanning=!0,r._dragStartX=i.x,r._dragStartY=i.y))},_getCurrentPoint:function(n){var t=this._mapContainer,i=n.pageX-t[0].offsetLeft,r=n.pageY-t[0].offsetTop;return{x:i,y:r}},_doubleClick:function(n){var t=this,r,u,i;this._isNavigationPressed||n.target.className.toString().indexOf("e-icon1")!=-1||(r=this._getCurrentPoint(n),t.enableZoom()&&t.zoomLevel()+1>=t.minZoom()&&t.zoomLevel()+1<=t.maxZoom()&&(u=t._scale,t._prevScale=u,this._isTileMap?(this._tileZoom(t.zoomLevel()-1,t.zoomLevel(),r),i=t.zoomLevel(),t.zoomLevel(t.zoomLevel()+1),this._generateTiles(this.zoomLevel()),t._translatePoint.x=(t._tileTranslatePoint.x-.5*Math.pow(2,i))/Math.pow(2,i),t._translatePoint.y=(t._tileTranslatePoint.y-.5*Math.pow(2,i))/Math.pow(2,i),t._scale=Math.pow(2,i)):(t._prevPoint={x:t._translatePoint.x,y:t._translatePoint.y},t._translatePoint.x-=(t._width/t._scale-t._width/(t._scale+t.zoomFactor()))/(t._width/r.x),t._translatePoint.y-=(t._height/t._scale-t._height/(t._scale+t.zoomFactor()))/(t._height/r.y),t._scale=u+t.zoomFactor(),t.zoomLevel(t.zoomLevel()+1)),t.model.enableAnimation&&!this._isTileMap?t._animate(600):(t._applyTransform(t._scale,t._translatePoint),t._refrshLayers(),t._resizeShape()),t._updateSliderValue()))},_tileZoom:function(n,t,i){var c=this,u;if(t>0&&t<20){this._tileDiv.html("");u=Math.pow(2,n)*256;i==r&&(i={x:this._width/2,y:this._height/2});var f=Math.pow(2,t)*256,e=(i.x-this._tileTranslatePoint.x)/u*100,o=(i.y-this._tileTranslatePoint.y)/u*100,s=e*f/100,h=o*f/100;this._tileTranslatePoint.x=i.x-s;this._tileTranslatePoint.y=i.y-h}},_bubbleEnterFunction:function(n){if(n.data.templateID!=null){var i=t("#"+n.data.templateID).render(n.data.itemsrc);t(n.data.htmlobj).html(i)}return t(document.body).append(n.data.htmlobj),t(n.data.htmlobj).css("display","block").css({left:n.pageX+8+"px",top:n.pageY+6+"px"})},_bubbleleaveFunction:function(n){return t(n.data.htmlobj).remove(),t(n.data.htmlobj).css("display","none")},_bubbleOverFunction:function(n){return t(n.data.htmlobj).css("display","block").css({left:n.pageX+8+"px",top:n.pageY+6+"px"})},_polyEnterFunction:function(n){var u=n.data.Param1,f=n.data.Param2.shape,e=n.data.map,o,s,y,c,l,p,w,a,h,v,b;if(e!=null&&u.enableMouseHover&&e._browser!="msie"&&e._rootgroup.insertBefore(f,e._rootgroup.childNodes[e._rootgroup.childNodes.length-(e._polylineCount+e._pointscount)-1]),o=jQuery.grep(u._smartLabels,function(n){return n.shape==f}),u.enableMouseHover){if(u._clearShapeWidth(e._scale),u._prevHoverdLegend==null||u._contains(u._prevSelectedLegends,u._prevHoverdLegend)||u._prevHoverdLegend.css("background-color",_isSVG?u._prevHoveredShape.getAttribute("fill"):u._prevHoveredShape.fillcolor.value),_isSVG?(f.setAttribute("stroke-width",u.shapeSettings.highlightBorderWidth/e._scale),f.setAttribute("stroke",u.shapeSettings.highlightStroke)):(f.strokeweight=u.shapeSettings.highlightBorderWidth,f.strokecolor=u.shapeSettings.highlightStroke/e._scale),u.shapeSettings.highlightColor!=null&&(u.shapeSettings.highlightColor=="transparent"||u._contains(u._prevSelectedShapes,f)||(_isSVG?(u.shapeSettings.highlightColor!="none"&&f.setAttribute("fill",u.shapeSettings.highlightColor),f.setAttribute("stroke-width",u.shapeSettings.highlightBorderWidth/e._scale),f.setAttribute("stroke",u.shapeSettings.highlightStroke)):f.fillcolor=u.shapeSettings.highlightColor),o.length>0&&!u._contains(u._prevSelectedLegends,o[0].legend)&&(o[0].legend.css("background-color",u.shapeSettings.highlightColor),u._prevHoverdLegend=o[0].legend),u._prevHoveredShape=f),u.legendSettings!=null&&u.legendSettings.mode==i.datavisualization.Map.LegendMode.Interactive&&u.shapeSettings.colorMappings!=null&&u.shapeSettings.colorMappings.rangeColorMapping!=null&&!u.shapeSettings.autoFill&&(u.legendSettings.showLegend==r||u.legendSettings.showLegend))for(s=0;s<u._mapShapes.length;s++)if(y=u._mapShapes[s].shape,y==f){c=null;u.shapeSettings.colorMappings.rangeColorMapping!=r&&(c=u.shapeSettings.colorMappings.rangeColorMapping);l=u.legendSettings.width;u.legendSettings.width==r&&(l=150);p=l/c.length/10;w=u._mapShapes[s].legendrect.marginLeft;t(u._interactiveArrow).css({"margin-left":w+Math.ceil(p)-u._interactiveArrow.width()/2,display:"block"});break}e._trigger("mouseover",{originalEvent:n.data.Param2})}a=n.data.Param2;a.hasOwnProperty("data")&&u.showTooltip&&(h=u._tooltipElement,v=u.tooltipTemplate,h!=null&&v!=null&&(t(h).css({left:n.pageX,top:n.pageY,display:"block"}),b=t("#"+v).render(a.data),t(h).html(b)))},_updateShapeRect:function(n){for(var i,t=0;t<n._mapShapes.length;t++)i=n._mapShapes[t],i.left==null&&(i.left=n._mapShapes[t].shape.getBoundingClientRect().left,i.right=n._mapShapes[t].shape.getBoundingClientRect().right,i.top=n._mapShapes[t].shape.getBoundingClientRect().top,i.bottom=n._mapShapes[t].shape.getBoundingClientRect().bottom,n._mapShapes[t]=i)},_polyUpFunction:function(n){var t=n.data.Param2,r=n.data.Param3,u,i;if(this.enableZoomOnSelection()&&!this._isDragging&&!this._isTileMap&&!this._isPinching){if(_isSVG)u=r.getBBox(),this._zoomOnSelection(u);else for(this._updateShapeRect(t),i=0;i<t._mapShapes.length;i++)if(r==t._mapShapes[i].shape){var f=t._mapShapes[i].left,e=t._mapShapes[i].top,o=t._mapShapes[i].right,s=t._mapShapes[i].bottom,h={x:f,y:e,width:o-f,height:s-e};this._zoomOnSelection(h);break}this.ispanning=!1}this._updateSelection(t,r,n.data.Param1)},_markerPressed:function(n){this._trigger("markerSelected",{originalEvent:n.data})},_polyClickFunction:function(n){var h=n.ctrlKey,t=n.data.Param2,u=this,f=n.data.Param3,e=jQuery.grep(t._smartLabels,function(n){return n.shape==f}),o,s,r,c;if(t.enableSelection&&u._browser!="msie"&&u._rootgroup.insertBefore(f,u._rootgroup.childNodes[u._rootgroup.childNodes.length-(u._polylineCount+u._pointscount)-1]),u._isPolygonSelected=!0,t._prevSelectedLegends.length!=0&&t._prevSelectedShapes.length!=0)for(o=0;o<e.length;o++)t._prevSelectedLegends[o].css("background-color",t._prevSelectedShapes[o].getAttribute("nodeValue"));if(h||t._prevSelectedLegends.length>0&&t._prevSelectedLegends.pop(),e.length>0)for(s=0;s<e.length;s++)t.shapeSettings.selectionColor!="none"&&e[s].legend.css("background-color",t.shapeSettings.selectionColor),t._prevSelectedLegends.push(e[s].legend);if(t._prevSelectedShapes.length!=0&&!h&&(t.enableSelection||t.selectionMode==i.datavisualization.Map.SelectionMode.Multiple))for(r=0;r<t._prevSelectedShapes.length;r++)_isSVG?(t._prevSelectedShapes[r].setAttribute("fill",t._prevSelectedShapes[r].getAttribute("nodeValue")),t._prevSelectedShapes[r].setAttribute("stroke",t.shapeSettings.stroke),t._prevSelectedShapes[r].setAttribute("stroke-width",t.shapeSettings.strokeThickness/this._scale)):(t._prevSelectedShapes[r].fillcolor=t._prevSelectedShapes[r].style.behavior,t._prevSelectedShapes[r].strokecolor=t.shapeSettings.stroke,t._prevSelectedShapes[r].strokeweight=t.shapeSettings.strokeThickness/this._scale);c=!1;h||t.selectionMode!=i.datavisualization.Map.SelectionMode.Multiple||t._prevSelectedShapes.length>0&&(t._prevSelectedShapes.pop(),c=!0);(t.enableSelection||h&&t.selectionMode==i.datavisualization.Map.SelectionMode.Multiple||c)&&(_isSVG?(t.shapeSettings.selectionColor!="none"&&f.setAttribute("fill",t.shapeSettings.selectionColor),f.setAttribute("stroke",t.shapeSettings.selectionStroke),f.setAttribute("stroke-width",t.shapeSettings.selectionStrokeWidth/u._scale)):(t.shapeSettings.selectionColor!="none"&&(f.fillcolor=t.shapeSettings.selectionColor),f.strokecolor=t.shapeSettings.selectionStroke,f.strokeweight=t.shapeSettings.selectionStrokeWidth/u._scale),this._updateSelection(t,f,n.data.Param1),u._trigger("shapeSelected",{originalEvent:t._prevSelectedShapeDatas}))},_updateSelection:function(n,t,r){n.enableSelection&&(n.selectionMode!=i.datavisualization.Map.SelectionMode.Multiple&&(n._prevSelectedShapes.pop(),n._prevSelectedShapeDatas.pop()),n._prevSelectedShapes.push(t),n._prevSelectedShapeDatas.push(r))},_zoomOnSelection:function(n){var u,t,i,r;_isSVG||(n.x=n.x-this._baseTranslatePoint.x/2-n.width/2,n.y=n.y-this._baseTranslatePoint.y/2-n.height/2);t=n.width;i=n.height;u=(this._width-100)/(this._height-100)>t/i?(this._height-100)/i:(this._width-100)/t;this._prevScale=this._scale;this._scale=u;this._prevPoint={x:this._translatePoint.x,y:this._translatePoint.y};this.zoomLevel(this._scale-this._baseScale+1);r=this.zoomLevel();r>this.minZoom()&&r<this.maxZoom()||(this.zoomLevel(r>(this.maxZoom()-this.minZoom())/2+this.minZoom()?this.maxZoom():this.minZoom()),this._scale=this.zoomLevel()+this._baseScale-1);var f=this._width/2-t*this._scale/2,e=f/this._scale,o=this._height/2-i*this._scale/2,s=o/this._scale;this._translatePoint.x=-n.x+e;this._translatePoint.y=-n.y+s;this.model.enableAnimation&&!this._isTileMap?this._animate(1200):(this._applyTransform(this._scale,this._translatePoint),this._updateSliderValue())},_polyMoveFunction:function(n){var i=n.data.Param1._tooltipElement,r=n.data.Param2;i!=null&&n.data.Param1.showTooltip&&r.hasOwnProperty("data")&&t(i).css({display:"block",left:n.pageX+10,top:n.pageY+10})},_polyLeaveFunction:function(n){var r=n.data.Param1,u=n.data.map,f=r._tooltipElement;f!=null&&t(f).css("display","none");r.legendSettings!=null&&r.legendSettings.mode==i.datavisualization.Map.LegendMode.Interactive&&r._interactiveArrow!=null&&t(r._interactiveArrow).css("display","none");r._clearShapeWidth(u._scale);u._trigger("mouseleave",{originalEvent:n.data.Param2})},_wireEvents:function(){function o(i){n.model.enableAnimation&&t(n._rootgroup).stop(!0,!1);i.preventDefault(i);n._zooming(-40*i.detail,i)}var e=jQuery.uaMatch(navigator.userAgent),r=e.browser.toLowerCase(),f,n,u;this._on(t(this._mapContainer),i.eventType.mouseDown,this._mouseButtonDown);t(document).keydown({className:"home",map:this},this._keyboardKeysPressed);this._on(t(this._mapContainer),i.eventType.mouseMove,this._mouseMove);this._on(t(document),i.eventType.mouseUp,this._mouseUp);f=!!navigator.userAgent.match(/Trident\/7\./);f&&(r="msie");window.navigator.msPointerEnabled?(this._on(t(this._mapContainer),"MSPointerUp",this._mouseButtonUp),t(this._mapContainer).css("-ms-touch-action","none")):this._on(t(this._mapContainer),"mouseup",this._mouseButtonUp);n=this;this._browser=r;r!="mozilla"?this._on(t(this._mapContainer),"mousewheel",this._mouseWheel):(u=this._svgDocument,u.addEventListener&&u.addEventListener("DOMMouseScroll",o,!1));this._on(t(this._mapContainer),"dblclick",this._doubleClick);this.model.enableResize&&(this._isDevice()?this._on(t(window),"orientationchange",this._mapResize):this._on(t(window),"resize",this._mapResize))},_mapResize:function(n){n.preventDefault();n.stopPropagation();var t=this;this.resizeTO&&clearTimeout(this.resizeTO);this.resizeTO=setTimeout(function(){t.refresh()},500)},_isDevice:function(){return/mobile|tablet|android|kindle/i.test(navigator.userAgent.toLowerCase())},_unWireEvents:function(){var u=jQuery.uaMatch(navigator.userAgent),n=u.browser.toLowerCase(),r;this._on(t(document),i.eventType.mouseUp,this._mouseUp);r=!!navigator.userAgent.match(/Trident\/7\./);r&&(n="msie");window.navigator.msPointerEnabled?(this._off(t(this._mapContainer),"MSPointerDown",this._mouseButtonDown),this._off(t(this._mapContainer),"MSPointerMove",this._mouseMove),this._off(t(this._mapContainer),"MSPointerUp",this._mouseButtonUp),t(this._mapContainer).css("-ms-touch-action","none")):n=="webkit"||n=="chrome"||n=="mozilla"?(this._off(t(this._mapContainer),"mousedown",this._mouseButtonDown),this._off(t(this._mapContainer),"mousemove",this._mouseMove),this._off(t(this._mapContainer),"mouseup",this._mouseButtonUp)):(this._off(t(this._mapContainer),"mousedown",this._mouseButtonDown),this._off(t(this._mapContainer),"mousemove",this._mouseMove),this._off(t(this._mapContainer),"mouseup",this._mouseButtonUp));this._off(t(this._mapContainer),"dblclick",this._doubleClick)},navigateTo:function(n,t,i){var u,f,e;i=parseFloat(i);i==r&&(i=this.zoomLevel());i>this.minZoom()&&i<this.maxZoom()?this.zoomLevel(i):this.zoomLevel(i>(this.maxZoom()-this.minZoom())/2+this.minZoom()?this.maxZoom():this.minZoom());u=this._convertTileLatLongtoPointForShapes(n,t,this._mapBounds);this._prevPoint={x:this._translatePoint.x,y:this._translatePoint.y};this._prevScale=this._scale;this._scale=this._baseScale+(i-1)*this.zoomFactor();f=(this._containerWidth+this._baseTranslatePoint.x)/2/this._scale;e=(this._containerHeight+this._baseTranslatePoint.y)/2/this._scale;this._translatePoint.x=-u.x+f;this._translatePoint.y=-u.y+e;this.model.enableAnimation&&!this._isTileMap?this._animate(1200):this._applyTransform(this._scale,this._translatePoint);this._updateSliderValue();this._refrshLayers()},selectShape:function(n,t,r){var e,f,u;if(n!=null)for(t==null&&(t=this.model.layers[this.baseMapIndex()]),u=0;u<t._mapShapes.length;u++)if(e=t._mapShapes[u].data,f=t._mapShapes[u].shape,e!=null&&n==this._reflection(e,t.shapeSettings.valuePath)){if(t._prevSelectedShapes.length!=0&&t.selectionMode!=i.datavisualization.Map.SelectionMode.Multiple)for(u=0;u<t._prevSelectedShapes.length;u++)_isSVG?(t._prevSelectedShapes[u].setAttribute("fill",t._prevSelectedShapes[u].getAttribute("nodeValue")),t._prevSelectedShapes[u].setAttribute("stroke",t.shapeSettings.stroke),t._prevSelectedShapes[u].setAttribute("stroke-width",t.shapeSettings.strokeThickness/this._scale)):(t._prevSelectedShapes[u].fillcolor=t._prevSelectedShapes[u].style.behavior,t._prevSelectedShapes[u].strokecolor=t.shapeSettings.stroke,t._prevSelectedShapes[u].strokeweight=t.shapeSettings.strokeThickness/this._scale);t.enableSelection&&(_isSVG?(t.shapeSettings.selectionColor!="none"&&f.setAttribute("fill",t.shapeSettings.selectionColor),f.setAttribute("stroke",t.shapeSettings.selectionStroke),f.setAttribute("stroke-width",t.shapeSettings.selectionStrokeWidth/this._scale)):(t.shapeSettings.selectionColor!="none"&&(f.fillcolor=t.shapeSettings.selectionColor),f.strokecolor=t.shapeSettings.selectionStroke,f.strokeweight=t.shapeSettings.selectionStrokeWidth/this._scale),this._updateSelection(t,f,n),this._trigger("shapeSelected",{originalEvent:t._prevSelectedShapeDatas}));r&&this.enableZoomOnSelection()&&this._zoomOnSelection(f.getBBox());u=t._mapShapes.length}},_getIntersectedElements:function(n,i){var r,u;if(n.width+=5,n.height+=5,_isSVG&&this._browser!="mozilla"&&this._browser!="webkit")return r=this._svgDocument.createSVGRect(),r.x=n.left,r.y=n.top,r.width=n.width,r.height=n.height,this._svgDocument.getIntersectionList(r,null);var o=[],s=t(this._mapContainer).offset(),h=s.left,c=s.top;for(u=0;u<i.length;u++){var f=i[u].shape,e=f.getBoundingClientRect(),l=t(f).offset().left-h,a=t(f).offset().top-c;if(this._isIntersect(n,{left:l,top:a,height:e.bottom-e.top,width:e.right-e.left}))return o.push(f),o}return o},_isIntersect:function(n,t){return n.left>=t.left+t.width||n.left+n.width<=t.left||n.top>=t.top+t.height||n.top+n.height<=t.top?!1:!0},pan:function(t){var i=this,r=0,u=0,f,e,o,s;if(this.zoomLevel()!=1){switch(t){case"right":r=this._width/7;u=0;break;case"top":r=0;u=-(this._height/7);break;case"left":r=-(this._width/7);u=0;break;case"bottom":r=0;u=this._height/7}i.model.enablePan&&(this._isTileMap&&(f=this._tileTranslatePoint.x-r/i._scale,e=this._tileTranslatePoint.y-u/i._scale,this._tileTranslatePoint.x=f,this._tileTranslatePoint.y=e,this._generateTiles(this.zoomLevel())),o=i._translatePoint.x-r/i._scale,i._prevScale=i._scale,s=i._translatePoint.y-u/i._scale,i._prevPoint={x:this._translatePoint.x,y:this._translatePoint.y},this._translatePoint.x=o,this._translatePoint.y=s,i.model.enableAnimation&&!this._isTileMap?i._animate(600):i._applyTransform(i._scale,i._translatePoint),i._refrshLayers())}},zoom:function(n,t){var i=this,r,u;n<=this.maxZoom()&&n>=this.minZoom()?(this._isTileMap?(this._tileZoom(i.zoomLevel(),n,{x:this._width/2,y:this._height/2}),r=i.zoomLevel(),i.zoomLevel(n),this._generateTiles(this.zoomLevel()),i._translatePoint.x=(i._tileTranslatePoint.x-.5*Math.pow(2,r))/Math.pow(2,r),i._translatePoint.y=(i._tileTranslatePoint.y-.5*Math.pow(2,r))/Math.pow(2,r),i._scale=Math.pow(2,r)):(u=i._baseScale+(n-1)*i.zoomFactor(),i._prevPoint={x:i._translatePoint.x,y:i._translatePoint.y},i._prevScale=i._scale,i._translatePoint.x-=(i._width/i._scale-i._width/u)/2,i._translatePoint.y-=(i._height/i._scale-i._height/u)/2,i._scale=u,i.zoomLevel(n),i.model.enableAnimation&&t&&i._animate(600)),i.model.enableAnimation&&t||(i._applyTransform(i._scale,i._translatePoint),i._refrshLayers(),i._resizeShape()),i._updateSliderValue()):n<=this.minZoom()?(this.zoomLevel(this.minZoom()),this.zoom(this.zoomLevel())):n>=this.maxZoom()&&(this.zoomLevel(this.maxZoom()),this.zoom(this.zoomLevel()))},refresh:function(){this._unWireEvents();t(this._svgDocument).empty();this._svgDocument!=null&&(this._svgDocument=null);t(this._mapContainer).empty();this._scale=1;this._translatePoint={x:0,y:0};this._height=this._mapContainer.height();this._width=this._mapContainer.width();this._height==0&&(this._height=this._mapContainer[0].parentElement.clientHeight!=0?this._mapContainer[0].parentElement.clientHeight:t(document).height());this._width==0&&(this._width=this._mapContainer[0].parentElement.clientWidth!=0?this._mapContainer[0].parentElement.clientWidth:t(document).width());this.baseMapIndex()>=this.model.layers.length&&this.baseMapIndex(0);this._generatePath();this._groupSize!=null&&(this._containerHeight=this._groupSize.maxY-this._groupSize.minY,this._containerWidth=this._groupSize.maxX-this._groupSize.minX,this._groupBorder={x:this._groupSize.minX,y:this._groupSize.minY});this._resizingContainer();this._renderMapElements();this.model.enableLayerChangeAnimation&&t(this._mapContainer).animate({opacity:1},500)},_updateSliderValue:function(n){var t=this._sliderControl,i;n==r&&(n=this.model.enableAnimation);t!=null&&(i=t.data("ejSlider"),i.option("value",this.zoomLevel()))},_createDivElement:function(n,t,r,u){var f=n,e=t;e.appendTo(f);f.appendTo(r);this._on(e,i.eventType.mouseDown,{className:u,map:this},this._navigationControlPressed)},_navigationControlPressed:function(n){n.stopPropagation();this._isNavigationPressed=!0;var t=n.data.map,i=t.model.enableAnimation;n.data.className=="zoomIn"?(t.zoom(t.zoomLevel()+1,!0),i||t._updateSliderValue()):n.data.className=="zoomOut"?(t.zoom(t.zoomLevel()-1,!0),i||t._updateSliderValue()):n.data.className=="panLeft"?t.pan("left"):n.data.className=="panRight"?t.pan("right"):n.data.className=="panTop"?t.pan("top"):n.data.className=="panBottom"?t.pan("bottom"):n.data.className=="home"&&(t.zoom(1,!0),i||t._updateSliderValue())},_keyboardKeysPressed:function(n){this._iskeyboardKeysPressed=!0;var t=n.data.map,i=t.model.enableAnimation;n.ctrlKey&&n.keyCode==38?t._zoomingIn(t._width/2,t._height/2,n,i):n.ctrlKey&&n.keyCode==40?t._zoomingOut(t._width/2,t._height/2,n,i):n.keyCode==37?t.pan("left"):n.keyCode==39?t.pan("right"):n.keyCode==38?t.pan("top"):n.keyCode==40&&t.pan("bottom")},refreshNavigationControl:function(n){function k(n){u!=null&&u._isRendered&&u.zoomLevel()!=n.value&&u.zoom(n.value,!1)}function d(n){u!=null&&u._isRendered&&u.zoomLevel()!=n.value&&u.zoom(n.value,!1)}var v=this._mapContainer.find("#ejNavigation"),f,s,o,u,a;if(v.length>0&&this._mapContainer[0].removeChild(v[0]),this.model.navigationControl!=null&&this.model.navigationControl.enableNavigation){n==r&&(n=this.model.navigationControl);var h=i.Orientation.Vertical,c,y=150,p=12;c={width:90,height:350};f=t("<div id='ejNavigation' class='e-map-navigation e-orientation-vert'/>");s=t("<div style='height:150px;width:10px;margin-top:-197px;margin-left: 34px;' />");n.orientation=="horizontal"&&(h=i.Orientation.Horizontal,y=12,p=150,c={width:350,height:90},f=t("<div id='ejNavigation' class='e-map-navigation e-orientation-horz' />"),s=t("<div style='height:10px;width:150px;margin-top:-18px;margin-left: 137px;' />"));var e=t("<div class='e-panContainer'/>"),w=h=="horizontal"?"Horz":"Vert",l=t("<div/>"),b=t("<div  />");e.appendTo(f);l.appendTo(f);s.appendTo(b);b.appendTo(f);this._sliderControl=s;o={x:0,y:0};n.dockPosition==null||n.dockPosition==i.datavisualization.Map.DockPosition.None?(o.x=this._width*n.absolutePosition.x/100,o.y=this._height*n.absolutePosition.y/100):o=this._getDockPosition(n.dockPosition,c);f.css({"margin-left":o.x+"px","margin-top":o.y+"px"});u=this;t(s).ejSlider({orientation:h,sliderType:i.SliderType.MinRange,value:1,animationSpeed:1200,minValue:this.minZoom(),showTooltip:!0,enableAnimation:!1,maxValue:this.maxZoom(),incrementStep:this.zoomFactor(),slide:d,change:k,height:y,width:p});f.appendTo(this._mapContainer);this._createDivElement(t("<div class='e-icon1 e-incrementButton  icon_margin1' />"),t("<div class='e-icon1 nav-inc-"+w+"  e-innerIncrement'/>"),l,"zoomIn");this._createDivElement(t("<div class='e-icon1 e-incrementButton icon_margin2'/>"),t("<div class='e-icon1 nav-dec-"+w+" e-innerDecrement'/>"),l,"zoomOut");this._createDivElement(t("<div class='e-icon1 e-radialTop'/>"),t("<div class='e-icon1 e-arrowUp'/>"),e,"panTop");this._createDivElement(t("<div class='e-icon1 e-radialLeft'/>"),t("<div class='e-icon1 e-arrowLeft'/>"),e,"panLeft");this._createDivElement(t("<div class='e-icon1 e-radialRight'/>"),t("<div class='e-icon1 e-arrowRight'/>"),e,"panRight");this._createDivElement(t("<div class='e-icon1 e-radialBottom'/>"),t("<div class='e-icon1 e-arrowDown'/>"),e,"panBottom");a=t("<div class='e-icon1 e-home-bg'><div class='e-icon1 e-map-home'><\/div>");a.appendTo(e);a.mousedown({className:"home",map:this},this._navigationControlPressed)}},_getDockPosition:function(n,t){var r={x:0,y:0};switch(n){case i.datavisualization.Map.DockPosition.TopCenter:r.x=this._width/2-t.width/2;break;case i.datavisualization.Map.DockPosition.TopRight:r.x=this._width-t.width;break;case i.datavisualization.Map.DockPosition.CenterLeft:r.y=this._height/2-t.height/2;break;case i.datavisualization.Map.DockPosition.Center:r.x=this._width/2-t.width/2;r.y=this._height/2-t.height/2;break;case i.datavisualization.Map.DockPosition.CenterRight:r.x=this._width-t.width;r.y=this._height/2-t.height/2;break;case i.datavisualization.Map.DockPosition.BottomLeft:r.y=this._height-t.height;break;case i.datavisualization.Map.DockPosition.BottomCenter:r.x=this._width/2-t.width/2;r.y=this._height-t.height;break;case i.datavisualization.Map.DockPosition.BottomRight:r.x=this._width-t.width;r.y=this._height-t.height}return r},_renderMapElements:function(){this._templateDiv=t("<div class='TemplateDiv'/>");this._templateDiv.appendTo(this._mapContainer);this._templateDiv.css({"pointer-events":"none",overflow:"hidden",position:"absolute","z-index":"1",height:this._height,width:this._width});this._wireEvents();this.refreshLayers();this.refreshNavigationControl(this.model.navigationControl)},_renderMapLayers:function(){var u,n,e,f,r;for(t(this._templateDiv).empty(),u=0,n=this.model.layers[this.baseMapIndex()],n.layerType==i.datavisualization.Map.LayerType.Geometry?(this._renderLayers(n,u),n.shapeData!=null&&(u=n._polygonData.length)):(n._initializeLocalValues(),e=t("<div class='map-contribution'>"),e[0].innerHTML=n.contribution,this._mapContainer.append(e)),f=0;f<this.model.layers[this.baseMapIndex()].subLayers.length;f++)r=this.model.layers[this.baseMapIndex()].subLayers[f],r._isBaseLayer=!1,r.layerType==i.datavisualization.Map.LayerType.Geometry&&r.shapeData!=null?(this._renderLayers(r,u),u+=r._polygonData.length):r._initializeLocalValues();this.refreshMarkers();_isSVG&&this.model.enableAnimation&&!this._isTileMap?this._refreshWithAnimation():this._refrshLayers()},refreshLayers:function(){var n=this.model.layers[this.baseMapIndex()];this._processOData(n,this)},_processOData:function(n,t){if(n.dataSource!=null)if(n.dataSource instanceof i.DataManager){var r=n.dataSource.executeQuery(n.query);r.done(function(i){i.result!=null&&(n.dataSource=i.result,t._renderMapLayers())})}else t._renderMapLayers();else t._renderMapLayers()}});var f=function(n,t){this.X=n;this.Y=t;this.left=0;this.top=0;this.height=256;this.width=256;this.src=null},u=function(){this.enableSelection=!0;this.selectionMode="default";this.key=null;this.bingMapType="aerial";this.enableMouseHover=!1;this.shapeData=null;this.markers=[];this.dataSource=null;this.urlTemplate="http://a.tile.openstreetmap.org/level/tileX/tileY.png";this.showTooltip=!1;this.tooltipTemplate=null;this.mapItemsTemplate=null;this.enableAnimation=!1;this.legendSettings=null;this.labelSettings=null;this.markerTemplate=null;this.showMapItems=!1;this.layerType="geometry";this._colorPaletteSettings={Palette1:{highlightColor:"#F7CD1C",highlightStroke:"white",highlightBorderWidth:"1",SelectionColor:"#F96C0D",SelectionStroke:"white",SelectionStrokeWidth:"2.5"},Palette2:{highlightColor:"#68A3EA",highlightStroke:"White",highlightBorderWidth:"1",SelectionColor:"#116EF4",SelectionStroke:"White",SelectionStrokeWidth:"2.5"},Palette3:{highlightColor:"#CCCCCC",highlightStroke:"white",highlightBorderWidth:"1",SelectionColor:"#4D4D4D",SelectionStroke:"white",SelectionStrokeWidth:"2.5"}};this.colorPalettes={Palette1:["#4A3825","#736F3D","#F2DABD","#BF9D7E","#7F6039","#7F715F","#70845D","#CC995C","#736F3D","#89541B"],Palette2:["#E51400","#730202","#EF6535","#C63477","#BF004D","#F0A30B","#CE1B1B","#97993D","#D6BF38","#835A2C"],Palette3:["#A4C400","#008B00","#1BA0E2","#0050EF","#AA00FF","#D90073","#E51400","#F96800","#E3C800","#A20026"]};this._prevPaletteIndex=0;this._newBounds=[];this.subLayers=[];this.shapeSettings={highlightColor:"gray",highlightBorderWidth:1,selectionColor:"gray",fill:"#E5E5E5",strokeThickness:"0.2",stroke:"#C1C1C1",colorPalette:"palette1",highlightStroke:"#C1C1C1",selectionStroke:"#C1C1C1",selectionStrokeWidth:1,colorValuePath:null,valuePath:null,enableGradient:!1,colorMappings:null,autoFill:!1};this.bubbleSettings={minValue:"10",maxValue:"20",color:"gray",colorValuePath:null,valuePath:null,colorMappings:null,showTooltip:!1,tooltipTemplate:null}};u.prototype={dataTypes:{dataSource:"data",markers:"array",subLayers:"array",shapeSettings:{colorMappings:"array"},bubbleSettings:{colorMappings:"array"}},_initializeLocalValues:function(){this._svgns="http://www.w3.org/2000/svg";this._bounds=[];this._prevSelectedShapes=[];this._prevSelectedShapeDatas=[];this._prevSelectedLegends=[];this._isBaseLayer=!0;this._prevHoverdLegend=null;this._prevHoveredShape=null;this._labelCollection=[];this._scrollBar=null;this._mapShapes=[];this._bubbles=[];this._labelBounds=[];this._bubbleCount=0;this._mapItems=[];this._mapMarkers=[];this._smartLabels=[];this._labelData=[];this._interactiveArrow=null;this._legendRects=[]},_generateMarkerForLayers:function(n){var s,h,e,f,r,o,u;for(this._mapMarkers=[],s=n._rootgroup.getBoundingClientRect().top,h=n._rootgroup.getBoundingClientRect().left,e=0;e<this.markers.length;e++)f=this.markers[e],this.markerTemplate!=null?(r=t(".markerTemplateDiv"),r=t("<div class='mapMarker' style='display:block;position:absolute;pointer-events: stroke;'><\/div>"),n._templateDiv.append(r),o=t("#"+this.markerTemplate).render(f),t(r).html(o),n._on(t(r),i.eventType.mouseDown,{marker:t(r),data:f},n._markerPressed),this._mapMarkers.push(r)):(u=t(' <div class="mapMarker" style="display:block;position:absolute;pointer-events: stroke;"><label>'+f.label+"<\/label><\/div>"),_isSVG?n._templateDiv.append(u):u.appendTo(n._templateDiv),n._on(t(u),i.eventType.mouseDown,{marker:t(u),data:f},n._markerPressed),this._mapMarkers.push(u))},_contains:function(n,t){var i=n.length;if(i>0)while(i--)if(n[i]===t)return!0;return!1},_clearShapeWidth:function(n){var i,t;for(n==null&&(n=1),i=0;i<this._mapShapes.length;i++)t=this._mapShapes[i],this._contains(this._prevSelectedShapes,t.shape)||(_isSVG?(t.shape.setAttribute("fill",t.shape.getAttribute("nodeValue")),t.shape.setAttribute("stroke-width",this.shapeSettings.strokeThickness/n),t.shape.setAttribute("stroke",this.shapeSettings.stroke)):(t.shape.fillcolor=t.shape.style.behavior,t.shape.strokeweight=this.shapeSettings.strokeThickness,t.shape.strokecolor=this.shapeSettings.stroke))},_rgbToHex:function(n,t,i){return"#"+this._toHex(n)+this._toHex(t)+this._toHex(i)},_toHex:function(n){var t="0123456789ABCDEF";return(n=parseInt(n,10),isNaN(n))?"00":(n=Math.max(0,Math.min(n,255)),t.charAt((n-n%16)/16)+t.charAt(n%16))},_hexToR:function(n){return parseInt(this._cropHex(n).substring(0,2),16)},_hexToG:function(n){return parseInt(this._cropHex(n).substring(2,4),16)},_hexToB:function(n){return parseInt(this._cropHex(n).substring(4,6),16)},_cropHex:function(n){return n.charAt(0)=="#"?n.substring(1,7):n},_getRangeColorValues:function(n,t,i){var u=[],f,r;if(u.push(t),t>i)for(f=(t-i)/(n-1),r=n;r>2;r--)t=t-f,u.push(t);else for(f=(i-t)/(n-1),r=2;r<n;r++)t=t+f,u.push(t+f);return u.push(i),u},_generateGradientCollection:function(n){for(var f=[],r=n[0],u=n[n.length-1],e=this._hexToR(r),o=this._hexToG(r),s=this._hexToB(r),h=this._hexToR(u),c=this._hexToG(u),l=this._hexToB(u),i=10,a=this._getRangeColorValues(i,e,h),v=this._getRangeColorValues(i,o,c),y=this._getRangeColorValues(i,s,l),t=0;t<i;t++)f.push(this._rgbToHex(a[t],v[t],y[t]));return f},_createLabel:function(n,i,r){var u=t("<div><\/div>");return u[0].innerHTML=n,u.css({"font-family":"Segoe UI","pointer-events":"none","text-align":"center","margin-left":i+"px","margin-top":r+"px",position:"absolute"}),u},_createInteractiveArrow:function(n,i){var r=t("<div class='e-icon1 e-interactiveArrow'><\/div>");return r[0].innerHTML="&#9650",r.css({"margin-left":n+"px","margin-top":i+"px",position:"absolute",color:"#444444"}),r},_generateLegends:function(n){var rt,ut,ft,et,p,a,u,w,g,ht,vt,ct,v,c,tt,o,pt,wt;if((this.legendSettings.showLegend==r||this.legendSettings.showLegend)&&!this.shapeSettings.autoFill){var e=10,s=10,y=this.legendSettings.height,l=this.legendSettings.width,f=t("<div/>");_isSVG?f.appendTo(n._templateDiv):n._templateDiv.append(f);var d=0,it=0,at=!0,h=null;if(this.shapeSettings.colorMappings.rangeColorMapping!=r?h=this.shapeSettings.colorMappings.rangeColorMapping:this.shapeSettings.colorMappings.equalColorMapping!=r&&(h=this.shapeSettings.colorMappings.equalColorMapping,at=!1),(this.legendSettings.type==r||this.legendSettings.type==i.datavisualization.Map.LegendType.Layers)&&this.shapeSettings.colorMappings!=null&&(this.legendSettings.mode==r||this.legendSettings.mode==i.datavisualization.Map.LegendMode.Default||this.legendSettings.mode==i.datavisualization.Map.LegendMode.Interactive&&this.shapeSettings.colorMappings.equalColorMapping!=null)){for(this.legendSettings.height==r&&(y=20),this.legendSettings.width==r&&(l=20),a=0;a<h.length;a++)u=h[a],u.hideLegend||(v=t("<div class='e-mapLegend'/>"),v.css({height:y+"px",width:l+"px","background-color":u.color,"margin-left":e+"px","margin-top":s+"px",position:"absolute"}),o=this._createLabel(u.legendLabel,e+l+5,s),u.legendLabel!=null?o[0].innerText=u.legendLabel:u.legendLabel=o[0].innerText=at?u.from:u.value,_isSVG?(v.appendTo(f),o.appendTo(f)):(f.append(v),f.append(o)),d<o[0].innerText.length*10+l&&(d=o[0].innerText.length*10+l),rt=o.height(),ut=v.height(),s+=rt>ut?rt+5:ut+5);it=s}else if((this.legendSettings.type==r||this.legendSettings.type==i.datavisualization.Map.LegendType.Layers)&&this.legendSettings.mode==i.datavisualization.Map.LegendMode.Interactive&&this.shapeSettings.colorMappings!=null){for(o="",this.legendSettings.height==r&&(y=18),this.legendSettings.width==r&&(l=150),this.legendSettings.leftLabel==null&&(this.legendSettings.leftLabel=""),this.legendSettings.title!=null&&(ft=e,this.legendSettings.showLabels||(ft=e+this.legendSettings.leftLabel.length*10),o=this._createLabel(this.legendSettings.title,ft,s),_isSVG?o.appendTo(f):f.append(o),s+=25),this.legendSettings.showLabels&&(s+=25),this.legendSettings.leftLabel==null||this.legendSettings.showLabels||(o=this._createLabel(this.legendSettings.leftLabel,e,s-3),_isSVG?o.appendTo(f):f.append(o),e=e+this.legendSettings.leftLabel.length*10),et=this._createInteractiveArrow(e,s+y),et.appendTo(f),this._interactiveArrow=et,p=null,!_isSVG&&this.shapeSettings.enableGradient&&(p=n._createGroup(!1,"legendGroup"),p.style.left="0px",p.style.top="0px",p.style.position="relative",f.append(p)),a=0;a<h.length;a++)if(u=h[a],!u.hideLegend){if(w=[],this.shapeSettings.enableGradient&&(w=this._generateGradientCollection(u.gradientColors)),g={},this.shapeSettings.enableGradient)if(_isSVG){var ot=t("<canvas/>"),st=ot[0].getContext("2d"),b=st.createLinearGradient(0,0,300,0),k=0;for(c=0;c<10;c++)k=k+1/10,c==0?(b.addColorStop(0,u.gradientColors[0]),b.addColorStop(k,w[c])):c==w.length-1?(b.addColorStop(k-1/10,w[c]),b.addColorStop(k,u.gradientColors[1])):(b.addColorStop(k-1/10,w[c]),b.addColorStop(k,w[c+1]));st.fillStyle=b;st.fillRect(0,0,300,300);ot.css({height:y+"px",width:l/h.length+"px","margin-left":e+"px","margin-top":s+"px",opacity:"0.9",filter:"alpha(opacity=90)",position:"absolute"});ot.appendTo(f)}else ht="legend"+a,vt="<v:rect id="+ht+' display="block" style="position:absolute;top: '+(s-2)+"px;left:"+e+"px;width:"+l/h.length+"px;height:"+y+'px;"><v:fill opacity="0.9px" type="gradient" method="linear sigma" angle="270"/><v:stroke opacity="0px"/><\/v:rect>',p.innerHTML=p.innerHTML+vt,ct=document.getElementById(ht),ct.fillcolor=u.gradientColors[0],ct.fill.color2=u.gradientColors[1];else v=t("<div/>"),v.css({height:y+"px",width:l/h.length+"px","background-color":u.color,"margin-left":e+"px","margin-top":s+"px",opacity:"0.9",filter:"alpha(opacity=90)",position:"absolute"}),_isSVG?v.appendTo(f):f.append(v);for(c=0;c<10;c++)g={},g.marginLeft=e,this._legendRects.push(g),e=e+l/h.length/10;if(this.legendSettings.showLabels){var nt=e-l/h.length,lt=s-25,yt=this._createLabel(u.from,nt,lt);nt=e;tt=this._createLabel(u.to,nt,lt);u.legendLabel!=r&&(tt=this._createLabel(u.legendLabel,nt-u.legendLabel.length*5,lt));_isSVG?(u==h[0]&&yt.appendTo(f),tt.appendTo(f)):(u==h[0]&&f.append(yt),f.append(tt))}}this.legendSettings.rightLabel==null||this.legendSettings.showLabels||(o=this._createLabel(this.legendSettings.rightLabel,e+10,s-3),_isSVG?o.appendTo(f):f.append(o),e=e+this.legendSettings.rightLabel.length*10);d=e+10;it=s+y+this._interactiveArrow.height()+10}if(this.legendSettings.position=="none")pt=n._width*this.legendSettings.PositionX/100,wt=n._height*this.legendSettings.PositionY/100,f.css({"margin-left":pt+"px","margin-top":wt+"px"});else{var kt=this.legendSettings.position==r?"topleft":this.legendSettings.position,dt={width:d,height:it},bt=n._getDockPosition(kt,dt);f.css({"margin-left":bt.x+"px","margin-top":bt.y+"px"})}}},_generateBubbleLegends:function(n){var l,u,s,e,v,y,d,g;if(this.legendSettings.showLegend==r||this.legendSettings.showLegend){var p=10,h=10,w=this.legendSettings.height,o=this.legendSettings.width,f=t("<div/>");_isSVG?f.appendTo(n._templateDiv):n._templateDiv.append(f);var a=0,b=0,k=!0,c=null;if(this.bubbleSettings.colorMappings.rangeColorMapping!=r?c=this.bubbleSettings.colorMappings.rangeColorMapping:this.bubbleSettings.colorMappings.equalColorMapping!=r&&(c=this.bubbleSettings.colorMappings.equalColorMapping,k=!1),this.legendSettings.type==i.datavisualization.Map.LegendType.Bubbles&&this.bubbleSettings.colorMappings!=null&&(this.legendSettings.mode==r||this.legendSettings.mode==i.datavisualization.Map.LegendMode.Default||this.legendSettings.mode==i.datavisualization.Map.LegendMode.Interactive&&this.bubbleSettings.colorMappings.equalColorMapping!=null)){for(this.legendSettings.height==r&&(w=20),this.legendSettings.width==r&&(o=20),l=0;l<c.length;l++)u=c[l],u.hideLegend||(s=t("<div class='e-mapBubbleLegend'/>"),s.css({height:w+"px",width:o+"px","background-color":u.color,"margin-left":p+"px","margin-top":h+"px",position:"absolute"}),e=this._createLabel(u.legendLabel,p+o+5,h),u.legendLabel!=null?e[0].innerText=u.legendLabel:u.legendLabel=e[0].innerText=k?u.from:u.value,_isSVG?(s.appendTo(f),e.appendTo(f)):(f.append(s),f.append(e)),a<e[0].innerText.length*10+o&&(a=e[0].innerText.length*10+o),v=e.height(),y=s.height(),h+=v>y?v+5:y+5);b=h}if(this.legendSettings.position=="none")d=n._width*this.legendSettings.PositionX/100,g=n._height*this.legendSettings.PositionY/100,f.css({"margin-left":d+"px","margin-top":g+"px"});else{var tt=this.legendSettings.position==r?"topleft":this.legendSettings.position,it={width:a,height:b},nt=n._getDockPosition(tt,it);f.css({"margin-left":nt.x+"px","margin-top":nt.y+"px"})}}},_animateBubble:function(n,i){var e=n.getAttribute("r"),f,u=t(n),r=this;u.delay(i).each(function(){}).animate({r:e},{duration:700,step:function(n){f=n;_isSVG&&(u.attr("style","display:block;pointer-events:stroke;"),u[0].setAttribute("r",f))},complete:function(){r._bubbleCount++;r._bubbleCount==r._bubbles.length&&r._setMapElements()}})},_setMapElements:function(){for(var i,n=0;n<this._mapItems.length;n++)i=this._mapItems[n],t(i).css({display:"block"})},_setMapItemsPositionWithAnimation:function(n){for(var s,o,e,r,u,i=0;i<this._bubbles.length;i++){var h=this._bubbles[i],u=this._bounds[i],o=(u.x+n._translatePoint.x)*n._scale,e=(u.y+n._translatePoint.y)*n._scale,c=0,l=Math.floor(Math.random()*(20-c)+c),a=parseInt(l*50);_isSVG&&t(h).attr({cx:o,cy:e});this._animateBubble(h,a)}for(i=0;i<this._mapMarkers.length;i++)r=this._mapMarkers[i],this.markers.length>0&&(s=this.markers[i]),u=n._isTileMap?n._convertTileLatLongtoPoint(s.latitude,s.longitude):n._convertLatLongtoPointforMarker(s.latitude,s.longitude),o=_isSVG?u.x:(u.x+n._transformX)*n._scale,e=u.y,t(r).css({display:"block",left:o,top:e-100}),t(r).delay(500).each(function(){}).animate({top:e},500);for(i=0;i<this._mapItems.length;i++){var r=this._mapItems[i],u=this._bounds[i],f=r[0].getBoundingClientRect(),o=(u.x+n._translatePoint.x)*n._scale-f.width/2,e=(u.y+n._translatePoint.y)*n._scale-f.height/4;this._bubbles.length>0?t(r).css({left:o,top:e,display:"none"}):t(r).css({left:o,top:e,display:"block"})}for(i=0;i<this._labelCollection.length;i++){r=this._labelCollection[i];u=this._labelBounds[i];t(r).css("display","block");var f=r[0].getBoundingClientRect(),v=_isSVG?f.width:f.right-f.left,y=_isSVG?f.height:f.bottom-f.top,o=(u.x+n._translatePoint.x)*n._scale-v/2,e=(u.y+n._translatePoint.y)*n._scale-y/2;(r[0].className="labelLegend")&&(r[0].className="labelStyle");r[0].innerHTML=this._labelData[i];t(r).css({left:o,top:e})}this.labelSettings!=null&&this.labelSettings.showLabels&&this._validateSmartLabel(n)},_resizeShapes:function(n){for(var t,r=this.shapeSettings.strokeThickness/n._scale,i=0;i<this._mapShapes.length;i++)t=this._mapShapes[i].shape,_isSVG?t.localName=="circle"?t.setAttribute("r",5/n._scale):this._contains(this._prevSelectedShapes,t)?t.setAttribute("stroke-width",this.shapeSettings.selectionStrokeWidth/n._scale):t.setAttribute("stroke-width",r):t.nodeName=="oval"||(t.strokeweight=this._contains(this._prevSelectedShapes,t)?this.shapeSettings.selectionStrokeWidth/n._scale:r)},_setMapItemsPosition:function(n){for(var e,h,o,s,u,r,i=0;i<this._mapItems.length;i++){var u=this._mapItems[i],r=this._bounds[i],f=u[0].getBoundingClientRect(),c=_isSVG?f.width:f.right-f.left,l=_isSVG?f.height:f.bottom-f.top,o=(r.x+n._translatePoint.x)*n._scale-c/2,s=(r.y+n._translatePoint.y)*n._scale-l/4;t(u).css({left:o,top:s})}for(i=0;i<this._bubbles.length;i++)if(e=this._bubbles[i],r=this._bounds[i],_isSVG)o=(r.x+n._translatePoint.x)*n._scale,s=(r.y+n._translatePoint.y)*n._scale,t(e).attr({cx:o,cy:s});else{e=document.getElementById(e.id);var o=(r.x+n._translatePoint.x)*n._scale,s=(r.y+n._translatePoint.y)*n._scale,a=s-(e.getBoundingClientRect().bottom-e.getBoundingClientRect().top)/2,v=o-(e.getBoundingClientRect().right-e.getBoundingClientRect().left)/2;t(e).css({left:v,top:a})}for(i=0;i<this._mapMarkers.length;i++)u=this._mapMarkers[i],this.markers.length>0&&(h=this.markers[i]),r=n._isTileMap?n._convertTileLatLongtoPoint(h.latitude,h.longitude):n._convertLatLongtoPointforMarker(h.latitude,h.longitude),o=r.x,s=r.y,t(u).css({left:o,top:s});for(i=0;i<this._labelCollection.length;i++){u=this._labelCollection[i];r=this._labelBounds[i];t(u).css("display","block");var f=u[0].getBoundingClientRect(),c=_isSVG?f.width:f.right-f.left,l=_isSVG?f.height:f.bottom-f.top,o=(r.x+n._translatePoint.x)*n._scale-c/2,s=(r.y+n._translatePoint.y)*n._scale-l/2;(u[0].className="labelLegend")&&(u[0].className="labelStyle",t(u[0]).css("background-color","transparent"));u[0].innerHTML=this._labelData[i];t(u).css({left:o,top:s})}this.labelSettings!=null&&this.labelSettings.showLabels&&this._validateSmartLabel(n)},_validateSmartLabel:function(n){function rt(n){var i=[],t;for(i.push(0),t=10;t<=n;t+=20)i.push(-t),i.push(t);return i}function ut(n){for(var t=0;t<p.length;t++)if(ft(n,p[t]))return!1;return!0}function ft(n,t){return n.left-2>=t.left+t.width||n.left-2+n.width<=t.left-2||n.top-2>=t.top+t.height||n.top+n.height<=t.top-2?!1:!0}var p,f,v,y,b,nt,k;if(this._smartLabels=[],p=[],this._labelCollection.length>0)for(f=0;f<this._mapShapes.length;f++){var tt=this._labelBounds[f],r={x:(tt.x+n._translatePoint.x)*n._scale,y:(tt.y+n._translatePoint.y)*n._scale},u=this._labelCollection[f];if(r.x>0&&r.x<n._width&&r.y>0&&r.y<n._height){var w=this._mapShapes[f].shape,s=w.getBoundingClientRect(),d=!1,a=u[0].getBoundingClientRect(),h=a.height+2,c=a.width+2;_isSVG||(s={width:s.right*n._scale-s.left*n._scale,height:s.bottom*n._scale-s.top*n._scale},h=a.bottom-a.top,c=a.right-a.left);var e=0,o=0,g=20,l=[],it=[];if(h>s.height||c>s.width)if(this.labelSettings.enableSmartLabel)for(this.labelSettings.smartLabelSize==i.datavisualization.Map.LabelSize.Fixed?(h=25,c=15*this.labelSettings.labelLength):(c*=1.3,h=25);!d;){for(g>400&&(d=!0),l=rt(g),it=l,v=0;v<l.length;v++)for(y=0;y<l.length;y++)e=it[y],o=l[v],r.x+e+c>n._width&&r.x<n._width&&(e-=r.x+e+c-n._width),r.x+e<0&&(e=0),r.y+o<0&&(o=0),r.y+o+h>n._height&&r.y<n._height&&(o-=r.y+o+h-n._height),b={left:r.x+e,top:r.y+o,height:h,width:c},ut(b)&&(nt=n._getIntersectedElements(b,this._mapShapes),nt!=null&&nt.length==0&&(d=!0,v=l.length,y=l.length,u[0].className="labelLegend",this.labelSettings.smartLabelSize==i.datavisualization.Map.LabelSize.Fixed&&(u[0].innerHTML=u[0].innerHTML.substring(0,this.labelSettings.labelLength)),u.mouseenter({Param1:this,Param2:this._mapShapes[f],map:n},n._polyEnterFunction),u.mousemove({Param1:this,Param2:this._mapShapes[f]},n._polyMoveFunction),t(u).css({left:r.x+e,top:r.y+o,"background-color":_isSVG?w.getAttribute("fill"):w.fillcolor.value}),p.push(b),k={},k.shape=w,k.legend=u,this._smartLabels.push(k)));g+=10}else u.css("display","none")}}},_fillColors:function(n,t,i){t.rangeColorMapping!=null?this._fillRangeColors(n,t.rangeColorMapping,i):t.equalColorMapping!=null&&this._fillEqualColors(n,t,i)},_fillEqualColors:function(n,i,r){t.each(i.equalColorMapping,function(t,i){i.value==n&&(_isSVG?r.setAttribute("fill",i.color):r.fillcolor=i.color)})},_updateLegendRange:function(n,t){for(var o,i,s,c,e,f,h,l=t.shapeSettings.colorMappings.rangeColorMapping,u=0;u<l.length;u++)if(o=null,i=l[u],t.shapeSettings.enableGradient&&(o=this._generateGradientCollection(i.gradientColors)),n>=i.from&&n<=i.to)for(s=u,u!=0&&(s=u*10),c=i.from,e=i.from+(i.to-i.from)/10,f=s;f<s+10;f++){if(n>=c&&n<=e)return h={},t._legendRects[f]!=r&&(h=t._legendRects[f]),h.color=t.shapeSettings.enableGradient?u!=0?o[f-u*10]:o[f]:i.color,h;c=e;e=e+(i.to-i.from)/10}},_fillRangeColors:function(n,i,r){for(var u,e,f=0;f<i.length;f++)u=i[f],n>=u.from&&n<=u.to&&(e=this._getColorRatio(.7,1,n,u.from,u.to),_isSVG?r.setAttribute("fill",u.color):r.fillcolor=u.color,t(r).css({opacity:e}))},_getColorRatio:function(n,t,i,r,u){var f=100/(u-r)*(i-r);return(parseFloat(t)-parseFloat(n))/100*f+parseFloat(n)}};t.fn.pinchZoom=function(n,i){var f,u,e=this[0],r=[],o=function(n){var t=e.createSVGPoint(),r=n.targetTouches,u,f,i;return r.length&&(i=r[0],u=i.pageX,f=i.pageY),t.x=u,t.y=f,t};handleTouchStart=function(i){var y=n,e,s,c,l,h,a,v;if(u=y.getCTM().inverse(),f=o(i).matrixTransform(u),e=i.touches,e.length>=2)for(s=0;s<e.length;s++){for(c=e[s],l=!1,h=0;h<r.length;h++)if(a=r[h],c.identifier===a.identifier){l=!0;break}l||(v=t.extend({},c),r.push(v))}i.preventDefault()};getDistance=function(n,t){var i=t.pageX-n.pageX,r=t.pageY-n.pageY;return Math.sqrt(i*i+r*r)};setCTM=function(n,t){var r=null,u="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";t.a>i._baseScale&&i.enableZoom()&&i.model.enablePan&&(t.a>i._scale?r=!0:t.a<i._scale&&(r=!1),i._scale=t.a,i._translatePoint.x=t.e/t.a,i._translatePoint.y=t.f/t.a,i._applyTransform(i._scale,i._translatePoint),i.zoomLevel(i._scale-i._baseScale+1),r!=null&&r?(i._trigger("zoomedIn",{originalEvent:null,zoomLevel:i.zoomLevel()}),i._updateSliderValue(!1),i._resizeShape()):r!=null&&(i._trigger("zoomedOut",{originalEvent:null,zoomLevel:i.zoomLevel()}),i._updateSliderValue(!1),i._resizeShape()),i._isDragging=!0,i._refrshLayers())};handleTouchEnd=function(n){for(var e,t,u,o,f=n.changedTouches,i=0;i<f.length;i++)for(e=f[i],t=0;t<r.length;t++)u=r[t],u.identifier===e.identifier&&(o=r.indexOf(u),r.splice(o,1));n.preventDefault()};updateTouch=function(n,t){n.pageX=t.pageX;n.pageY=t.pageY};handleTouchMove=function(t){var s,h,v,i,a;if(t.preventDefault(),s=n,h=t.touches,h.length>=2){var c=h[0],l=h[1],y=r[0],p=r[1];v=getDistance(c,l)/getDistance(y,p);i=e.createSVGPoint();i.x=(c.pageX+l.pageX)/2;i.y=(c.pageY+l.pageY)/2;i=i.matrixTransform(s.getCTM().inverse());a=e.createSVGMatrix().translate(i.x,i.y).scale(v).translate(-i.x,-i.y);setCTM(s,s.getCTM().multiply(a));typeof u=="undefined"&&(u=s.getCTM().inverse());u=u.multiply(a.inverse());updateTouch(y,c);updateTouch(p,l)}else r.length||(i=o(t).matrixTransform(u),setCTM(s,u.inverse().translate(i.x-f.x,i.y-f.y)))};this[0].addEventListener("touchstart",handleTouchStart,!1);this[0].addEventListener("touchend",handleTouchEnd,!1);this[0].addEventListener("touchmove",handleTouchMove,!1)};jQuery.uaMatch=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}};i.datavisualization.Map.LayerType={Geometry:"geometry",OSM:"osm",Bing:"bing"};i.datavisualization.Map.LegendIcons={Rectangle:"rectangle",Circle:"circle"};i.datavisualization.Map.LabelSize={Fixed:"fixed",Default:"default"};i.datavisualization.Map.LegendMode={Default:"default",Interactive:"interactive"};i.datavisualization.Map.BingMapType={Aerial:"aerial",AerialWithLabel:"aerialwithlabel",Road:"road"};i.datavisualization.Map.SelectionMode={Default:"default",Multiple:"multiple"};i.datavisualization.Map.ColorPalette={Palette1:"palette1",Palette2:"palette2",Palette3:"palette3",CustomPalette:"custompalette"};i.datavisualization.Map.LegendType={Layers:"layers",Bubbles:"bubbles"};i.datavisualization.Map.DockPosition={None:"none",TopLeft:"topleft",TopCenter:"topcenter",TopRight:"topright",CenterLeft:"centerleft",Center:"center",CenterRight:"centerright",BottomLeft:"bottomleft",BottomCenter:"bottomcenter",BottomRight:"bottomright"}})(jQuery,Syncfusion)})