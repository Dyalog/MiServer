/*!
*  filename: ej.diagram.min.js
*  version : 12.2.0.36
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n,t,i){"use strict";t.widget("ejDiagram","ej.datavisualization.Diagram",{element:null,model:null,validTags:["div"],defaults:{width:null,height:null,nodes:[],connectors:[],dataSource:null,connectorDefaults:null,nodeDefaults:null,nodeTemplate:null,dataSourceSchema:{model:{children:"children"}},snapSettings:{horizontalGridLines:{linesInterval:[1.25,18.75,.25,19.75,.25,19.75,.25,19.75,.25,19.75],snapInterval:[20],lineDashArray:"0",lineColor:"lightgray"},verticalGridLines:{linesInterval:[1.25,18.75,.25,19.75,.25,19.75,.25,19.75,.25,19.75],snapInterval:[20],lineDashArray:"0",lineColor:"lightgray"},snapConstraints:15,enableSnapToObject:!0,snapAngle:5,snapObjectDistance:5},pageSettings:{pageWidth:null,pageHeight:null,multiplePage:!1,pageBorderWidth:0,pageBackgroundColor:"#ffffff",pageBorderColor:"#565656",pageMargin:24,showPageBreak:!1,pageOrientation:"portrait"},contextMenu:{items:[],click:null,beforeOpen:null,showCustomMenuItemsOnly:!1},enableContextMenu:!0,enableAutoScroll:!0,showTooltip:!0,tooltipTemplateId:"",autoScrollMargin:20,layout:{type:"none",orientation:"toptobottom",horizontalSpacing:30,verticalSpacing:30,marginX:0,marginY:0,fixedNode:""},userHandles:[],drawingTools:{},backgroundImage:null,selectorConstraints:14,zoomFactor:1,nodeCollectionChange:null,connectorCollectionChange:null,selectionChange:null,mouseLeave:null,mouseEnter:null,mouseOver:null,click:null,doubleClick:null,drop:null,drag:null,textChange:null,sizeChange:null,connectionChange:null,rotationChange:null},dataTypes:{nodes:"array",connectors:"array",dataSource:"data",enableContextMenu:"boolean",enableAutoScroll:"boolean",showTooltip:"boolean",autoScrollMargin:"number",userHandles:"array",zoomFactor:"number",contextMenu:{items:"array",showCustomMenuItemsOnly:"boolean"},layout:{type:"enum",orientation:"enum",horizontalSpacing:"number",verticalSpacing:"number",marginX:"number",marginY:"number"},pageSettings:{multiplePage:"boolean",pageBorderWidth:"number",pageMargin:"number",showPageBreak:"boolean",pageOrientation:"enum"},snapSettings:{horizontalGridLines:{linesInterval:"array",snapInterval:"array"},verticalGridLines:{linesInterval:"array",snapInterval:"array"},enableSnapToObject:"boolean",snapAngle:"number",snapObjectDistance:"number"}},_canvas:null,_svg:null,_toolToActivate:null,_inAction:!1,_isEditing:!1,_nodeToHit:null,_currentCursor:null,_pasteIndex:null,_page:null,_view:null,_currentLabel:null,_zOrder:0,_clipboardData:null,_historyList:{currentEntry:{next:null,previous:null},canUndo:!1,canRedo:!1},_defaultContextMenuItems:[{name:"cut",text:"Cut"},{name:"copy",text:"Copy"},{name:"paste",text:"Paste"},{name:"undo",text:"Undo"},{name:"redo",text:"Redo"},{name:"selectAll",text:"Select All"},{name:"grouping",text:"Grouping",subItems:[{name:"group",text:"Group"},{name:"ungroup",text:"Ungroup"}]},{name:"order",text:"Order",subItems:[{name:"bringToFront",text:"Bring To Front"},{name:"moveForward",text:"Move Forward"},{name:"sendToBack",text:"Send To Back"},{name:"sendBackward",text:"Send Backward"}]}],_hScrollOffset:0,_vScrollOffset:0,_scrollPixel:30,activeTool:null,selectionList:[],tools:null,nameTable:{},_updateScrollOffset:function(n,i,r){this._hScrollOffset=n;this._vScrollOffset=i;t.datavisualization.Diagram.ScrollUtil._transform(this,n,i,r)},_init:function(){this._spatialSearch=t.datavisualization.Diagram.SpatialSearch();this._initDefaults();this._initData();this._doLayout();this._initCanvas();this._initVisualGuide();this._wireEvents();this._initHandles();this._initContextMenu();this._drawingTool=!1;this._isDropped=!1},_setModel:function(i){for(var r in i)switch(r){case"nodes":this.model.nodes=i[r];this._initNodeCollection();this.element.remove(".ej-d-node");this.element.remove(".ej-d-group");this._renderNodes();break;case"connectors":this.model.connectors=i[r];this._initConnectorCollection();this.element.remove(".ej-d-connector");this._renderConnectors();break;case"contextMenu":this.model.contextMenu=i[r];this._initContextMenu();break;case"snapSettings":n.extend(!0,this.model.snapSettings,{},i[r]);this._renderGrid();break;case"selectorConstraints":this._setSelectorConstraints(i[r]);break;case"userHandles":this.model.userHandles=i[r];this._initHandles();break;case"drawingTools":this.model.drawingTools=i[r];this._registerDrawingTools();break;case"backgroundImage":this.model.backgroundImage=i[r];this._renderBackground();break;case"enableAutoScroll":this.model.enableAutoScroll=i[r];break;case"autoScrollMargin":this.model.autoScrollMargin=i[r];break;case"layout":this.model.layout=n.extend(!0,{},this.model.layout,i[r]);this._setLayout(i[r]);break;case"pageSettings":n.extend(!0,this.model.pageSettings,{},i[r]);t.datavisualization.Diagram.PageUtil._updatePageSize(this)}},_initData:function(){var n=this.model.dataSource;n&&n.length>0?this._initDataSource(n):(this._initNodeCollection(),this._initConnectorCollection())},_initDataSource:function(n,i){for(var s,h,r,u,f=null,e=null,a,o=this.model.dataSourceSchema.model.children,l,c=0,v=n.length;c<v;c++)if(s=n[c],this.model.nodeDefaults?(r=t.datavisualization.Diagram.Node(this.model.nodeDefaults),r.name+=t.datavisualization.Diagram.Util.randomId(),this._add(r),f=this.nameTable[r.name]):(r=this.model.nodeTemplate.call(this,s),r.group&&r.children?(this._add(r.children),this._add(r.group),f=this.nameTable[r.group.name]):(this._add(r),f=this.nameTable[r.name])),i&&this._addConnection(i,f),s[o]&&s[o].length>0)for(a=s[o],l=0;l<a.length;l++)h=a[l],this.model.nodeDefaults?(u=t.datavisualization.Diagram.Node(this.model.nodeDefaults),u.name+=t.datavisualization.Diagram.Util.randomId(),this._add(u),e=this.nameTable[u.name]):(u=this.model.nodeTemplate.call(this,h),u.group&&u.children?(this._add(u.children),this._add(u.group),e=this.nameTable[u.group.name]):(this._add(u),e=this.nameTable[u.name])),f&&e&&this._addConnection(f,e),h[o]&&h[o].length>0&&this._initDataSource(h[o],e)},_addConnection:function(i,r){var u=n.extend(!0,{},this.model.connectorDefaults,{sourceNode:i.name,targetNode:r.name});u=t.datavisualization.Diagram.Connector(u);u.name+=t.datavisualization.Diagram.Util.randomId();this._add(u)},_initNodeCollection:function(){for(var i=this.model.nodes,n=0,r=i.length;n<r;n++)i[n].isGroup?(i[n]=t.datavisualization.Diagram.Group(i[n]),this.nameTable[i[n].name]=i[n]):(i[n]=t.datavisualization.Diagram.Node(i[n]),this.nameTable[i[n].name]=i[n],t.datavisualization.Diagram.SpatialUtil._updateQuad(this,this._spatialSearch,i[n])),this.nameTable[i[n].name]=i[n]},_initConnectorCollection:function(){for(var r=this.model.connectors,n,i=0,u=r.length;i<u;i++)n=r[i]=t.datavisualization.Diagram.Connector(r[i]),this.nameTable[n.name]=n,t.datavisualization.Diagram.SpatialUtil._updateQuad(this,this._spatialSearch,n),this._dock(n,this.nameTable),this._updateEdges(n)},_initDefaults:function(){this._initTools()},_initCanvas:function(){this._renderCanvas()},_initVisualGuide:function(){if(this.model.showTooltip&&!this.model.tooltipTemplateId){var n=document.createElement("script"),i={id:this.element[0].id+"_defaultTooltip",type:"text/x-jsrender"};t.datavisualization.Diagram.Util.attr(n,i);n.innerHTML='<span class="e-diagram-tooltipLabel-default"> {{:type}}{{:x}}{{:type1}}{{:y}}<\/span>';this._canvas.appendChild(n)}else this.element.remove("#"+this.element[0].id+"_defaultTooltip")},_initTools:function(){this.tools={select:new t.datavisualization.Diagram.SelectTool(this),move:new t.datavisualization.Diagram.MoveTool(this),resize:new t.datavisualization.Diagram.ResizeTool(this),rotate:new t.datavisualization.Diagram.RotateTool(this),endPoint:new t.datavisualization.Diagram.EndPointTool(this),panTool:new t.datavisualization.Diagram.PanTool(this),straightLine:new t.datavisualization.Diagram.StraightLineTool(this),orthogonalLine:new t.datavisualization.Diagram.OrthogonalLineTool(this)};this._toolToActivate="select";this.activeTool=this.tools[this._toolToActivate];this._registerDrawingTools()},_initHandles:function(){var i=this.model.userHandles,n;if(i)for(n=0;n<i.length;n++)i[n]=t.datavisualization.Diagram.UserHandle(i[n]),i[n].tool&&(i[n].tool.diagram=this,this.tools[i[n].name]=i[n].tool)},_destroy:function(){this.element.ejScroller("destroy");this.element.empty().removeClass("e-datavisualization-diagram")},updateNode:function(n,r){var u,f;n&&(u=this._findNode(n),u&&(r.offsetX&&this._translate(u,r.offsetX-u.offsetX,0,this.nameTable),r.offsetY&&this._translate(u,0,r.offsetY-u.offsetY,this.nameTable),r.rotateAngle&&this._rotate(u,r.rotateAngle-u.rotateAngle,this.nameTable),r.width&&(u.width=u.width?u.width:1,this._scale(u,r.width/u.width,1,new t.datavisualization.Diagram.Point(u.offsetX,u.offsetY),this.nameTable)),r.height&&(u.height=u.height?u.height:1,this._scale(u,1,r.height/u.height,new t.datavisualization.Diagram.Point(u.offsetX,u.offsetY),this.nameTable)),r.constraints&&(u.constraints=r.constraints,this.selectionList[0]&&this.selectionList[0].name===u.name&&(t.datavisualization.Diagram.SvgContext.clearSelector(this._svg,this._adornerLayer),t.datavisualization.Diagram.SvgContext.renderSelector(this.selectionList[0],this._svg,this._adornerLayer,this.model.zoomFactor,this.model.selectorConstraints),this.model.selectorConstraints&t.datavisualization.Diagram.SelectorConstraints.UserHandles&&t.datavisualization.Diagram.SvgContext.renderUserHandles(this.model.userHandles,this.selectionList[0],this._svg,this.selectionList[0].isPseudoGroup,this.model.zoomFactor,this._adornerLayer))),u.isGroup||(r.fillColor&&(u.fillColor=r.fillColor),r.borderColor&&(u.borderColor=r.borderColor),r.borderWidth&&(u.borderWidth=r.borderWidth),r.borderDashArray&&(u.borderDashArray=r.borderDashArray),r.gradient!==i&&(u.gradient=r.gradient)),t.datavisualization.Diagram.SvgContext.update(u,this),r.shape&&(t.browserInfo().name==="msie"&&u.shape&&u.shape.html&&(f=document.getElementById(u.name+"_parentdiv"),f.parentNode.removeChild(f)),u.shape=t.datavisualization.Diagram.Shape(r.shape),t.datavisualization.Diagram.SvgContext.setNodeShape(u,this._svg)),this.selectionList[0]&&this.selectionList[0].name===u.name&&t.datavisualization.Diagram.SvgContext.updateSelector(u,this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)))},updateConnector:function(i,r){var u,f;i&&(u=this._findConnector(i),u&&(r.constraints&&(u.constraints=r.constraints),r.lineColor&&(u.lineColor=r.lineColor),r.lineWidth&&(u.lineWidth=r.lineWidth),r.lineDashArray&&(u.lineDashArray=r.lineDashArray),t.datavisualization.Diagram.SvgContext.update(u,this),r.line&&(u.line=t.datavisualization.Diagram.Line(r.line),this._dock(u,this.nameTable),this._updateQuad(this,u),t.datavisualization.Diagram.SvgContext.setLine(u,this._svg)),r.targetDecorator&&(f=u.targetDecorator?n.extend(!0,{},u.targetDecorator,r.targetDecorator):t.datavisualization.Diagram.Decorator(r.targetDecorator),u.targetDecorator=f),r.sourceDecorator&&(f=u.sourceDecorator?n.extend(!0,{},u.sourceDecorator,r.sourceDecorator):t.datavisualization.Diagram.Decorator(r.sourceDecorator),u.sourceDecorator=f),(r.sourceDecorator||r.targetDecorator)&&(t.datavisualization.Diagram.SvgContext.clearDecorators(u,this._svg),t.datavisualization.Diagram.SvgContext.renderDecorators(u,this._svg)),this.selectionList[0]&&this.selectionList[0].name===u.name&&t.datavisualization.Diagram.SvgContext.updateSelector(u,this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)))},bringToCenter:function(n){var i=this.model.zoomFactor,f=t.datavisualization.Diagram.ScrollUtil._viewPort(this),r=n.x+n.width/2-f.width/2,u=n.y+n.height/2-f.height/2;r=Math.max(0,r)*i;u=Math.max(0,u)*i;t.datavisualization.Diagram.ZoomUtil._applyTransform(this,i,t.datavisualization.Diagram.Point(-r,-u),null)},bringIntoView:function(n){var r=0,u=0;rect.right=rect.right?rect.right:rect.x+rect.width;rect.bottom=rect.bottom?rect.bottom:rect.y+rect.height;var f=this._hScrollOffset,e=this._vScrollOffset,i=t.datavisualization.Diagram.ScrollUtil._viewPort(this);n.right>-f+i.width&&(r=n.right-i.width);n.x<-f&&(r=n.x);n.bottom>-e+i.height&&(u=n.bottom-i.height);n.y<-e&&(u=n.y);t.datavisualization.Diagram.ZoomUtil._applyTransform(this,this.model.zoomFactor,t.datavisualization.Diagram.Point(-r,-u),null)},save:function(){var i=this.model.drawingTools,r=this.model.userHandles,n;return this.model.drawingTools=null,this.model.userHandles=null,this.nameTable.multipleSelection&&t.datavisualization.Diagram.Util.removeItem(this.model.nodes,this.nameTable.multipleSelection),n=jQuery.extend(!0,{},this.model),this.model.drawingTools=i,this.model.userHandles=r,n},load:function(t){this.clear();var i={nodes:t.nodes,connectors:t.connectors,contextMenu:t.contextMenu,snapSettings:t.snapSettings,backgroundImage:t.backgroundImage,enableAutoScroll:t.enableAutoScroll,autoScrollMargin:t.autoScrollMargin,layout:t.layout,pageSettings:t.pageSettings,click:t.click,connectionChange:t.connectionChange,connectorDefaults:t.connectorDefaults,dataSource:t.dataSource,dataSourceSchema:t.dataSourceSchema,doubleClick:t.doubleClick,enableContextMenu:t.enableContextMenu,showTooltip:t.showTooltip,handles:t.handles,height:t.height,mouseEnter:t.mouseEnter,mouseOver:t.mouseOver,mouseLeave:t.mouseLeave,nodeDefaults:t.nodeDefaults,nodeTemplate:t.nodeTemplate,rotationChange:t.rotationChange,selectorConstraints:t.selectorConstraints,tooltipTemplateId:t.tooltipTemplateId,width:t.width,zoomFactor:t.zoomFactor};n("#"+this._id).ejDiagram(i)},layout:function(){this._setLayout()},_setLayout:function(){this._doLayout();t.datavisualization.Diagram.PageUtil._updatePageSize(this);this._clearSelection();this._updateNodes();this._updateConnectors()},addSelection:function(n){this._addSelection(n)},updateSelection:function(n){this._updateSelectionHandle(n)},activateTool:function(n,r){this.tools[n]&&(this.activeTool instanceof t.datavisualization.Diagram.LineTool&&this.activeTool._showAllPorts(!0),this._toolToActivate=n,this.activeTool=this.tools[this._toolToActivate],r!=i&&(this.activeTool.singleAction=r));this.activeTool instanceof t.datavisualization.Diagram.ImageTool&&this.activeTool.autoOpenUpload&&this.activeTool._showPopup();this.activeTool instanceof t.datavisualization.Diagram.PanTool&&(this._currentCursor="pointer");this.activeTool instanceof t.datavisualization.Diagram.LineTool&&this.activeTool._showAllPorts();this._drawingTool=!0},deactivateTool:function(){this.activeTool instanceof t.datavisualization.Diagram.LineTool&&this.activeTool._showAllPorts(!0);this._toolToActivate="select";this.activeTool=this.tools[this._toolToActivate];this._drawingTool=!1},setLabelStyle:function(n,i,r){var u,f;if(n&&(u=this._findNode(n),u||(u=this._findConnector(n)),(!r.name||i.name==r.name)&&u)){for(f in r)i.hasOwnProperty(f)&&(i[f]=r[f]);u.line||u.shape&&u.shape.type!=="text"?(t.datavisualization.Diagram.SvgContext.updateLabelStyle(u,i,this._svg),t.datavisualization.Diagram.SvgContext.updateLabel(u,i,this._svg)):u.shape&&u.shape.type==="text"&&t.datavisualization.Diagram.SvgContext.updateTextBlock(u,i,this._svg)}},startLabelEdit:function(n,i){var u,r,f;if(n){for(u=0;u<this.selectionList.length;u++)if(r=this.selectionList[u],r!==n&&typeof r.labels.length!="undefined")for(f=0;f<r.labels.length;f++)r.labels[f].mode=t.datavisualization.Diagram.LabelEditMode.View;this._setLabelEditing(i)?this._startEdit(n):this._endEdit()}},_setSelectorConstraints:function(n){this.model.selectorConstraints=n;this.selectionList[0]&&(t.datavisualization.Diagram.SvgContext.clearSelector(this._svg,this._adornerLayer),t.datavisualization.Diagram.SvgContext.renderSelector(this.selectionList[0],this._svg,this._adornerLayer,this.model.zoomFactor,n),this.model.selectorConstraints&t.datavisualization.Diagram.SelectorConstraints.UserHandles&&t.datavisualization.Diagram.SvgContext.renderUserHandles(this.model.userHandles,this.selectionList[0],this._svg,this.selectionList[0].isPseudoGroup,this.model.zoomFactor,this._adornerLayer))},group:function(){var i,n,r,f,u,e;if(this.selectionList[0]&&this.selectionList[0].isPseudoGroup){for(i=[],n=0;n<this.selectionList[0].children.length;n++)i.push(this.nameTable[this.selectionList[0].children[n]]);for(this._sortByZIndex(i,!0),f=t.datavisualization.Diagram.Util.randomId(),u=new t.datavisualization.Diagram.Group({name:f}),this._clearSelection(),n=0;n<i.length;n++)this._isUndo=!0,u.children.push(i[n].name),i[n].parent=f,t.datavisualization.Diagram.Util.removeItem(this.selectionList,i[n].name),t.browserInfo().name==="msie"&&(i[n].shape&&i[n].shape.type=="html"?(r=document.getElementById(i[n].name+"_parentdiv"),r.parentNode.removeChild(r)):i[n].isGroup&&this._checkForHtmlNode(i[n])),r=document.getElementById(i[n].name),r.parentNode.removeChild(r);t.datavisualization.Diagram.Util.clear(this.selectionList);this.add(u);this._addSelection(u);e={type:"groupchanged",object:u,actionType:"group"};this.addHistoryEntry(e);this._isUndo=!1}},_checkForHtmlNode:function(n){for(var t,r,i=0;i<n.children.length;i++)t=this.nameTable[n.children[i]],t.isGroup?this._checkForHtmlNode(t):t.shape&&t.shape.type=="html"&&(r=document.getElementById(t.name+"_parentdiv"),r.parentNode.removeChild(r))},_removeChildren:function(n){for(var i,r=0;r<n.children.length;r++)i=this.nameTable[n.children[r]],t.datavisualization.Diagram.Util.removeItem(this.model.nodes,i),i.isGroup?this._removeChildren(i):(t.datavisualization.Diagram.SpatialUtil._removeFromaQuad(this._spatialSearch,this._spatialSearch.quadTable[i.name],i),t.datavisualization.Diagram.SpatialUtil._updateBounds(this,this._spatialSearch,i),delete this.nameTable[i.name])},ungroup:function(){var u,r,e,i,f,o;if(this.selectionList[0]&&this.selectionList[0].isGroup){for(this._isUndo=!0,u=this.selectionList[0].children,e=this.selectionList[0],n("#"+this.selectionList[0].name)[0].parentNode.removeChild(n("#"+this.selectionList[0].name)[0]),t.browserInfo().name==="msie"&&this._checkForHtmlNode(this.selectionList[0]),this._clearSelection(),t.datavisualization.Diagram.Util.clear(this.selectionList),r=0;r<u.length;r++)u[r].parent=null,f=this.nameTable[u[r]],f.line?(i=f,i.parent="",this._updateEdges(i),this._dock(i,this.nameTable),t.datavisualization.Diagram.SvgContext.renderConnector(i,this._svg,this._diagramLayer,this)):(i=f,i.parent="",i.isGroup?(this._updateChildrenEdges(i),t.datavisualization.Diagram.SvgContext.renderGroup(i,this._svg,this._diagramLayer,this.nameTable)):t.datavisualization.Diagram.SvgContext.renderNode(i,this._svg,this._diagramLayer,this));t.datavisualization.Diagram.Util.removeItem(this.model.nodes,this._findNode(e.name));o={type:"groupchanged",object:e,actionType:"ungroup"};this.addHistoryEntry(o);this._isUndo=!1}},nudge:function(n){var t={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}}[n];t&&this.selectionList[0]&&this._nudge(this.selectionList[0],t.x,t.y)},selectAll:function(){var i,r,n,f,u;for(this._clearSelection(),i=t.datavisualization.Diagram.Group({isPseudoGroup:!0,name:"multipleSelection"}),r=this.model.nodes,n=0,f=r.length;n<f;n++)t.datavisualization.Diagram.Util.canSelect(r[n])&&r[n].parent==""&&i.children.push(r[n].name);for(u=this.model.connectors,n=0,f=u.length;n<f;n++)t.datavisualization.Diagram.Util.canSelect(u[n])&&u[n].parent==""&&i.children.push(u[n].name);t.datavisualization.Diagram.Util._updateGroupBounds(i,this.nameTable);this.model.nodes.push(i);this.nameTable[i.name]=i;i.children.length>0&&this._addSelection(i)},align:function(n){var s,u,i,o,r,h,f,e;if(this.selectionList[0]&&this.selectionList[0].isPseudoGroup&&this.selectionList[0].children&&this.selectionList[0].children.length>0&&(s=this.nameTable[this.selectionList[0].name].children,n==="left"?u=this._findCornerNodes().left:n==="right"?u=this._findCornerNodes().right:n==="top"?u=this._findCornerNodes().top:n==="bottom"&&(u=this._findCornerNodes().bottom),u?i=t.datavisualization.Diagram.Util.bounds(u):(n==="center"||n==="middle")&&(i=t.datavisualization.Diagram.Util.bounds(this.selectionList[0])),i)){for(f=0,e=0,o=0;o<s.length;o++)h=this.nameTable[s[o]],r=t.datavisualization.Diagram.Util.bounds(h),n==="left"?f=-(r.x-i.x):n==="right"?f=-(r.x+r.width-(i.x+i.width)):n==="top"?e=-(r.y-i.y):n==="bottom"?e=-(r.y+r.height-(i.y+i.height)):n==="center"?f=-(r.x+r.width/2-(i.x+i.width/2)):n==="middle"&&(e=-(r.y+r.height/2-(i.y+i.height/2))),this._moveNode(f,e,h);t.datavisualization.Diagram.Util._updateGroupBounds(this.selectionList[0],this.nameTable);t.datavisualization.Diagram.SvgContext.updateSelector(this.selectionList[0],this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)}},sameSize:function(){var i,n;if(this.selectionList[0]&&this.selectionList[0].isPseudoGroup&&this.selectionList[0].children&&this.selectionList[0].children.length>0){var r=this.nameTable[this.selectionList[0].name].children,f=this.nameTable[this.selectionList[0].children[0]],u=t.datavisualization.Diagram.Util.bounds(f);for(i=0;i<r.length;i++)n=this.nameTable[r[i]],n.line||(n.height=u.height,n.width=u.width,this._updateQuad(this,n),t.datavisualization.Diagram.SvgContext.update(n,this));t.datavisualization.Diagram.Util._updateGroupBounds(this.selectionList[0],this.nameTable);t.datavisualization.Diagram.SvgContext.updateSelector(this.selectionList[0],this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)}},sameHeight:function(){var i,n;if(this.selectionList[0]&&this.selectionList[0].isPseudoGroup&&this.selectionList[0].children&&this.selectionList[0].children.length>0){var r=this.nameTable[this.selectionList[0].name].children,u=this.nameTable[this.selectionList[0].children[0]],f=t.datavisualization.Diagram.Util.bounds(u);for(i=0;i<r.length;i++)n=this.nameTable[r[i]],n.line||(n.height=f.height,this._updateQuad(this,n),t.datavisualization.Diagram.SvgContext.update(n,this));t.datavisualization.Diagram.Util._updateGroupBounds(this.selectionList[0],this.nameTable);t.datavisualization.Diagram.SvgContext.updateSelector(this.selectionList[0],this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)}},sameWidth:function(){var i,n;if(this.selectionList[0]&&this.selectionList[0].isPseudoGroup&&this.selectionList[0].children&&this.selectionList[0].children.length>0){var r=this.nameTable[this.selectionList[0].name].children,u=this.nameTable[this.selectionList[0].children[0]],f=t.datavisualization.Diagram.Util.bounds(u);for(i=0;i<r.length;i++)n=this.nameTable[r[i]],n.line||(n.width=f.width,this._updateQuad(this,n),t.datavisualization.Diagram.SvgContext.update(n,this));t.datavisualization.Diagram.Util._updateGroupBounds(this.selectionList[0],this.nameTable);t.datavisualization.Diagram.SvgContext.updateSelector(this.selectionList[0],this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)}},spaceDown:function(){var i,u,h,o,l,s,r,n;if(this.selectionList[0]&&this.selectionList[0].isPseudoGroup&&(i=this.selectionList[0].children,this._sortByYvalue(this.selectionList[0].children),u=i.length,i&&u>2)){var c=this._findCornerNodes(),f=c.top,e=c.bottom;if(f&&e)for(o=t.datavisualization.Diagram.Util.bounds(f),l=t.datavisualization.Diagram.Util.bounds(e),h=(l.y-o.y)/(u-1),s=1,r=0;r<i.length;r++)n=this.nameTable[i[r]],n!==f&&n!==e&&(n.offsetY=o.y+s*h+n.height/2,this._updateQuad(this,n),s+=1,t.datavisualization.Diagram.SvgContext.update(n,this))}},spaceAcross:function(){var i,u,h,o,l,s,r,n;if(this.selectionList[0]&&this.selectionList[0].isPseudoGroup&&(i=this.selectionList[0].children,this._sortByXvalue(this.selectionList[0].children),u=i.length,i&&u>2)){var c=this._findCornerNodes(),f=c.left,e=c.right;if(f&&e)for(o=t.datavisualization.Diagram.Util.bounds(f),l=t.datavisualization.Diagram.Util.bounds(e),h=(l.x-o.x)/(u-1),s=1,r=0;r<i.length;r++)n=this.nameTable[i[r]],n!==f&&n!==e&&(n.offsetX=o.x+s*h+n.width/2,this._updateQuad(this,n),s+=1,t.datavisualization.Diagram.SvgContext.update(n,this))}},sendBackward:function(){var i,u,f,n,r,o,e;if(this.selectionList[0]&&!this.selectionList[0].isPseudoGroup&&(n=this.selectionList[0],n)){for(i=this._findOverlapNode(n),this._sortByZIndex(i),r=0;r<i.length;r++)if(n.zOrder>i[r].zOrder&&i[r].parent==""){f=i[r];break}if(o=n.zOrder,f){for(e=f.zOrder,u=e;u<o;u++)n.parent!=""?this._findObjectByIndex(u,!0).zOrder+=1:this._findObjectByIndex(u).zOrder+=1;n.parent!=""?this._findChildren(n.parent,n.name).zOrder=e:this._findObjectByName(n.name).zOrder=e;this._svg.getElementById(f.name).parentNode.insertBefore(this._svg.getElementById(n.name),this._svg.getElementById(f.name));t.datavisualization.Diagram.SvgContext.renderSelector(n,this._svg,this._adornerLayer,this.model.zoomFactor,this.model.selectorConstraints)}}},moveForward:function(){var i,u,f,n,r,o,e;if(this.selectionList[0]&&!this.selectionList[0].isPseudoGroup&&(n=this.selectionList[0],n)){for(i=this._findOverlapNode(n),this._sortByZIndex(i),r=i.length-1;r>=0;r--)if(n.zOrder<i[r].zOrder&&i[r].parent==""){f=i[r];break}if(o=n.zOrder,f){for(e=f.zOrder,u=e;u>o;u--)n.parent!=""?this._findObjectByIndex(u,!0).zOrder-=1:this._findObjectByIndex(u).zOrder-=1;n.parent!=""?this._findChildren(n.parent,n.name).zOrder=e:this._findObjectByName(n.name).zOrder=e;this._svg.getElementById(f.name).parentNode.insertBefore(this._svg.getElementById(n.name),this._svg.getElementById(f.name).nextSibling);t.datavisualization.Diagram.SvgContext.renderSelector(n,this._svg,this._adornerLayer,this.model.zoomFactor,this.model.selectorConstraints)}}},sendToBack:function(){var n=this.selectionList[0],f,i;if(n&&!n.isPseudoGroup){var e=this._findOverlapNode(n),r=this._sortByZIndex(e),o=n.zOrder,u=n.zOrder;for(i=0;i<r.length;i++)r[i].zOrder<u&&r[i].parent==""&&(u=r[i].zOrder,f=r[i]);if(f){for(i=u;i<o;i++)n.parent!=""?this._findObjectByIndex(i,!0).zOrder+=1:this._findObjectByIndex(i).zOrder+=1;n.parent!=""?this._findChildren(n.parent,n.name).zOrder=u:this._findObjectByName(n.name).zOrder=u;this._svg.getElementById(f.name).parentNode.insertBefore(this._svg.getElementById(n.name),this._svg.getElementById(f.name));t.datavisualization.Diagram.SvgContext.renderSelector(n,this._svg,this._adornerLayer,this.model.zoomFactor,this.model.selectorConstraints)}}},bringToFront:function(){var i=this.selectionList[0],u,n;if(i&&!i.isPseudoGroup){var e=this._findOverlapNode(i),r=this._sortByZIndex(e),o=i.zOrder,f=i.zOrder;for(n=0;n<r.length;n++)r[n].zOrder>f&&r[n].parent==""&&(f=r[n].zOrder,u=r[n]);if(u){for(n=0;n<r.length;n++)r[n].zOrder>o&&(r[n].zOrder-=1);i.parent?this._findChildren(i.parent,i.name).zOrder=f:this._findObjectByName(i.name).zOrder=f;this._svg.getElementById(u.name).parentNode.insertBefore(this._svg.getElementById(i.name),this._svg.getElementById(u.name).nextSibling);t.datavisualization.Diagram.SvgContext.renderSelector(i,this._svg,this._adornerLayer,this.model.zoomFactor,this.model.selectorConstraints)}}},undo:function(){var t,n;this._isUndo=!0;n=this.getUndoEntry();switch(n&&n.type){case"positionchanged":t={object:n.undoObject,isMultipleNode:n.isMultipleNode};this._recordPinPointChanged(t);break;case"rotationchanged":t={object:n.undoObject,isMultipleNode:n.isMultipleNode};this._recordRotationChanged(t);break;case"sizechanged":t={object:n.undoObject,isMultipleNode:n.isMultipleNode};this._recordSizeChanged(t);break;case"endpointchanged":t={undoObject:n.undoObject,redoObject:n.redoObject,isMultipleNode:n.isMultipleNode,_isUndo:!0};this._recordEndPointChanged(t);break;case"collectionchanged":t={changeType:n.changeType,childTable:n.childTable,isUndo:!0,sourcePorts:n.sourcePorts,targetPorts:n.targetPorts};t.object=jQuery.extend(!0,{},n.object);this._recordCollectionChanged(t);break;case"labelchanged":t={object:n.shape,label:n.previousLabelValue};this._recordLabelChanged(t);break;case"groupchanged":t={object:n.object,isUndo:!0,actionType:n.actionType};this._recordGroupChanged(t)}this._isUndo=!1},redo:function(){var n,t;this._isUndo=!0;n=this.getRedoEntry();switch(n&&n.type){case"positionchanged":t={object:n.redoObject,isMultipleNode:n.isMultipleNode};this._recordPinPointChanged(t);break;case"rotationchanged":t={object:n.redoObject,isMultipleNode:n.isMultipleNode};this._recordRotationChanged(t);break;case"sizechanged":t={object:n.redoObject,isMultipleNode:n.isMultipleNode};this._recordSizeChanged(t);break;case"endpointchanged":t={undoObject:n.undoObject,redoObject:n.redoObject,isMultipleNode:n.isMultipleNode,_isUndo:!1};this._recordEndPointChanged(t);case"collectionchanged":t={changeType:n.changeType,childTable:n.childTable,isUndo:!1};t.object=jQuery.extend(!0,{},n.object);this._recordCollectionChanged(t);break;case"labelchanged":t={object:n.shape,label:n.updatedLabelValue};this._recordLabelChanged(t);break;case"groupchanged":t={object:n.object,actionType:n.actionType,isUndo:!1};this._recordGroupChanged(t)}this._isUndo=!1},addHistoryEntry:function(n){var t,i;this._historyList.currentEntry!=null&&(t=this._historyList.currentEntry,t.next?t.previous&&(i=t.next,i.previous=null,t.next=n,n.previous=t):(t.next=n,n.previous=t));this._historyList.currentEntry=n;this._historyList.canUndo=!0;this._historyList.canRedo=!1},clearHistory:function(){var n=this._historyList;n.currentEntry=null;n.canUndo=!1;n.canRedo=!1},getUndoEntry:function(){var i=null,t,n=this._historyList;return n.canUndo&&(i=n.currentEntry,t=n.currentEntry.previous,t?(n.currentEntry=t,n.canRedo||(n.canRedo=!0)):(n.canRedo=!0,n.canUndo=!1)),i},getRedoEntry:function(){var i=null,t,n=this._historyList;return n.canRedo&&(t=n.currentEntry.previous||n.canUndo?n.currentEntry.next:n.currentEntry,t&&(n.currentEntry=t,n.canUndo||(n.canUndo=!0),t.next||(n.canRedo=!1,n.canUndo=!0)),i=n.currentEntry),i},cut:function(){this._pasteIndex=0;this._setClipboard();this._delete()},copy:function(){this._pasteIndex=1;this._setClipboard()},paste:function(){this._paste()},_setClipboard:function(){var i,t,f,o,r,u,s,h,e;if(this.selectionList.length>0){if(t=this.selectionList[0],f={},t.isGroup||t.isPseudoGroup){for(r=0;r<t.children.length;r++)for(u=r+1;u<t.children.length;u++)s=this.nameTable[t.children[r]],h=this.nameTable[t.children[u]],h.zOrder<s.zOrder&&(o=t.children[r],t.children[r]=t.children[u],t.children[u]=o);f=this._getChildTable(t,f)}if(i=n.extend(!0,{},{childTable:f,node:t}),this._preserveHtmlContent(t,i.node),i.node.children&&i.node.children.length>0)for(e in i.childTable)this._preserveHtmlContent(f[e],i.childTable[e]);this._clipboardData=i}},_preserveHtmlContent:function(n,t){n.shape&&(t.shape.type==="html"?typeof n.shape.html=="string"||(t.shape.html=n.shape.html.cloneNode(!0)):t.shape.type==="native"&&(t.shape.content=n.shape.content.cloneNode(!0)))},_getChildTable:function(t,i){var r,u,o,f,e;if(u=t.children,u)for(f=0;f<u.length;f++)o=u[f],r=this.nameTable[o],r&&(r.parent===t.name||t.isPseudoGroup)&&(e=i[r.name]=n.extend(!0,{},r),(e.isGroup||e.isPseudoGroup)&&(i=this._getChildTable(e,i)));return i},_paste:function(){var i,e,r,u,c,f,s,o,h,l;if(this._clipboardData){if(i=this._clipboardData,i=n.extend(!0,{},{childTable:i.childTable,node:i.node}),this._preserveHtmlContent(this._clipboardData.node,i.node),i.node.children&&i.node.children.length>0)for(r in i.childTable)this._preserveHtmlContent(this._clipboardData.childTable[r],i.childTable[r]);if(u=i.node,u.isPseudoGroup){for(c=u.children,f=t.datavisualization.Diagram.Group({isPseudoGroup:!0,name:"multipleSelection"}),this._isUndo=!0,s=0;s<c.length;s++)o=c[s],r=i.childTable[o],r&&(o=o+t.datavisualization.Diagram.Util.randomId(),delete i.childTable[r.name],r.name=o,r.parent="",i.childTable[r.name]=r,this._preserveConnection(i.childTable,r),f.children.push(o),r.isGroup&&this._pasteChildren(i.childTable,r),e=this._pasteIndex*10,this._translate(r,e,e,this.nameTable),this.add(r));this._clearSelection();this.model.nodes.push(f);this.nameTable[f.name]=f;t.datavisualization.Diagram.Util._updateGroupBounds(f,this.nameTable);this._addSelection(f);h={};h=this._getChildTable(this.selectionList[0],h);l={type:"collectionchanged",object:jQuery.extend(!0,{},this.selectionList[0]),childTable:jQuery.extend(!0,{},h),changeType:"insert"};this.addHistoryEntry(l);this._isUndo=!1}else u.name=u.name+t.datavisualization.Diagram.Util.randomId(),u.parent="",u.isGroup?this._pasteChildren(i.childTable,u):u.line||u.line||(u.inEdges=[],u.outEdges=[]),e=this._pasteIndex*10,this._translate(u,e,e,this.nameTable),this.add(u),this._clearSelection(),this._addSelection(u);this._pasteIndex++}},_pasteChildren:function(n,i){for(var r,u,o=[],e=i.children,f=0;f<e.length;f++)u=e[f],r=n[u],r&&(u=u+t.datavisualization.Diagram.Util.randomId(),delete n[r.name],r.name=u,n[r.name]=r,this._preserveConnection(n,r),r.parent=i.name,o.push(u),r.isGroup&&this._pasteChildren(n,r),this.add(r));i.children=o;this._preserveConnection(n,i)},_preserveConnections:function(n,t){for(var i,u=t.children,r=0;r<u.length;r++)i=n[u[r]],i&&(this._preserveConnection(n,i),i.isGroup&&this._preserveConnections(n,t))},_preserveConnection:function(n,t){var i,r,f,u;if(t.line)t.targetNode&&(u=n[t.targetNode],u&&u.inEdges.push(t.name)),t.sourceNode&&(u=n[t.sourceNode],u&&u.outEdges.push(t.name));else{if(f=t.inEdges.length,f>0){for(i=0;i<f;i++)r=n[t.inEdges[i]],r&&(r.targetNode=t.name);t.inEdges=[]}if(f=t.outEdges.length,f>0){for(i=0;i<t.outEdges.length;i++)r=n[t.outEdges[i]],r&&(r.sourceNode=t.name);t.outEdges=[]}}},zoomTo:function(n){n||(n=new t.datavisualization.Diagram.Zoom);n.zoomCommand&t.datavisualization.Diagram.ZoomCommand.ZoomIn?(this.model.zoomFactor>30&&(this.model.zoomFactor=30/this.model.zoomFactor),t.datavisualization.Diagram.ZoomUtil.zoomPan(this,1+n.zoomFactor,0,0,n.focusPoint,!0)):(this.model.zoomFactor<.25&&(this.model.zoomFactor=.25/this.model.zoomFactor),t.datavisualization.Diagram.ZoomUtil.zoomPan(this,1-n.zoomFactor,0,0,n.focusPoint,!0))},remove:function(n){n&&this.nameTable[n.name]?this._remove(n):this._delete()},clear:function(){this._clearSelection();for(var n=this.model.nodes.length-1;n>=0;n--)this._remove(this.model.nodes[n]);for(n=this.model.connectors.length-1;n>=0;n--)this._remove(this.model.connectors[n]);this.clearHistory()},_add:function(n,i){var r=!1,u,o,e,f,s;if(n.length>0)for(u=0;u<n.length;u++)this.add(n[u]);else o=n.line?"connector":"node",e={changeType:"insert",element:n,cancel:!1},this._raiseEvent(o+"CollectionChange",e),e.cancel||(this._setZorder(n),n.line?(n=t.datavisualization.Diagram.Connector(n),r=this.model.connectors.push(n),r&&(t.datavisualization.Diagram.SpatialUtil._updateQuad(this,this._spatialSearch,n),this._updateEdges(n),this._dock(n,this.nameTable),n.parent||i&&t.datavisualization.Diagram.SvgContext.renderConnector(n,this._svg,this._diagramLayer,this),this.nameTable[n.name]=n,i&&(this._clearSelection(),this._addSelection(n)))):(n=n.isGroup?t.datavisualization.Diagram.Group(n):t.datavisualization.Diagram.Node(n),r=this.model.nodes.push(n),this.nameTable[n.name]=n,r&&(n.isGroup?(t.datavisualization.Diagram.Util._updateGroupBounds(n,this.nameTable),this._updateChildrenEdges(n),i&&t.datavisualization.Diagram.SvgContext.renderGroup(n,this._svg,this._diagramLayer,this.nameTable)):(t.datavisualization.Diagram.SpatialUtil._updateQuad(this,this._spatialSearch,n),i&&!n.parent&&t.datavisualization.Diagram.SvgContext.renderNode(n,this._svg,this._diagramLayer,this)),this.nameTable[n.name]=n,i&&(this._clearSelection(),this._addSelection(n)))));return this._isUndo||n.parent==""&&(f={},this.selectionList&&this.selectionList.length>0&&(f=this._getChildTable(this.selectionList[0],f)),s={type:"collectionchanged",object:jQuery.extend(!0,{},n),childTable:jQuery.extend(!0,{},f),changeType:"insert"},this.addHistoryEntry(s)),r},add:function(n){return this._add(n,!0)},updateUserHandles:function(n){t.datavisualization.Diagram.SvgContext.updateUserHandles(this.model.userHandles,n,this._svg,!1,!1,this.model.zoomFactor)},scrollToNode:function(n){var f,e,r=this.model.zoomFactor,u=this.element[0].getBoundingClientRect(),i=t.datavisualization.Diagram.Util.bounds(n),o,s;f=(i.x+i.width/2)*r;e=(i.y+i.height/2)*r;o=this._hScrollOffset;s=this._vScrollOffset;u.width+this._hScrollOffset<f+i.width/2&&(o=f+i.width*r-u.width);u.height+this._vScrollOffset<e+i.height/2&&(s=e+i.height*r-u.height);this._updateScrollOffset(o,s)},_registerDrawingTools:function(){var t,n;for(t in this.model.drawingTools)n=this.model.drawingTools[t],n.diagram=this,this.tools[n.name]=n},_sortByXvalue:function(n){for(var u,r,f,e,o,s,i=0;i<n.length;i++)for(r=i+1;r<n.length;r++)o=this.nameTable[n[i]],s=this.nameTable[n[r]],f=t.datavisualization.Diagram.Util.bounds(o),e=t.datavisualization.Diagram.Util.bounds(s),f.x>e.x&&(u=n[i],n[i]=n[r],n[r]=u);return n},_sortByYvalue:function(n){for(var u,r,f,e,o,s,i=0;i<n.length;i++)for(r=i+1;r<n.length;r++)o=this.nameTable[n[i]],s=this.nameTable[n[r]],f=t.datavisualization.Diagram.Util.bounds(o),e=t.datavisualization.Diagram.Util.bounds(s),f.y>e.y&&(u=n[i],n[i]=n[r],n[r]=u);return n},_sortByZIndex:function(n,t){var u,i,r;if(t)for(i=0;i<n.length;i++)for(r=i+1;r<n.length;r++)n[i].zOrder>n[r].zOrder&&(u=n[i],n[i]=n[r],n[r]=u);else for(i=0;i<n.length;i++)for(r=i+1;r<n.length;r++)n[i].zOrder<n[r].zOrder&&(u=n[i],n[i]=n[r],n[r]=u);return n},_findCornerNodes:function(){var r,u,f,e,o,n,h=this.selectionList[0].children,s=this.nameTable[this.selectionList[0].children[0]],i,c,l,a,v;if(r=s,u=s,f=s,e=s,h.length>1)for(o=0;o<h.length;o++)i=this.nameTable[h[o]],n=t.datavisualization.Diagram.Util.bounds(i),c=t.datavisualization.Diagram.Util.bounds(u),n.x+n.width>c.x+c.width&&(u=i),l=t.datavisualization.Diagram.Util.bounds(e),n.y+n.height>l.y+l.height&&(e=i),a=t.datavisualization.Diagram.Util.bounds(r),n.x<a.x&&(r=i),v=t.datavisualization.Diagram.Util.bounds(f),n.y<v.y&&(f=i);return{left:r,right:u,top:f,bottom:e}},_moveNode:function(n,i,r){this._translate(r,n,i,this.nameTable);t.datavisualization.Diagram.SvgContext.update(r,this)},_nudge:function(n,i,r){this._translate(n,i,r,this.nameTable);t.datavisualization.Diagram.SvgContext.update(n,this);t.datavisualization.Diagram.SvgContext.updateSelector(n,this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)},_findObjectByName:function(n){var t=null;return this._findNode(n)&&(t=this._findNode(n)),this._findConnector(n)&&(t=this._findConnector(n)),t},_findObjectByIndex:function(n,t){var f,e=null,i,r,u;if(t)for(f=this.selectionList[0].parent.children,u=0;u<f.length;u++)i=this.nameTable[f[u]],i.zOrder===n&&(e=f[u]);else{for(r=0;r<this.model.nodes.length;r++)i=this.model.nodes[r],i.zOrder===n&&(e=i);for(r=0;r<this.model.connectors.length;r++)i=this.model.connectors[r],i.zOrder===n&&(e=i)}return e},_findOverlapNode:function(n){var r=[],i,u,f=[],e,o;if(n.parent)for(i=0;i<n.parent.children.length;i++)n.parent.children[i]!==n.name&&f.push(n.parent.children[i]);else{for(i=0;i<this.model.nodes.length;i++)r.push(this.model.nodes[i]);for(i=0;i<this.model.connectors.length;i++)r.push(this.model.connectors[i]);if(e=t.datavisualization.Diagram.Util.bounds(n),n)for(u=0;u<r.length;u++)o=t.datavisualization.Diagram.Util.bounds(r[u]),n.name!==r[u].name&&this._intersect(e,o)&&f.push(r[u])}return f},_intersect:function(n,t){return n.x<=t.x+t.width&&t.x<=n.x+n.width&&n.y<=t.y+t.height&&t.y<=n.y+n.height},_createTooltipDiv:function(){var n=document.createElement("div"),i={id:this.element[0].id+"_tooltipDiv","class":"e-diagram-tooltip-default",style:"padding-top:3px; height: 24px;"};return t.datavisualization.Diagram.Util.attr(n,i),this._canvas.appendChild(n),n},_renderTooltip:function(i){var r,e,f,o,u;this.model.showTooltip&&n.templates&&(r=n("#"+this.element[0].id+"_tooltipDiv")[0],r||(r=this._createTooltipDiv()),u=this.model.zoomFactor,this.model.tooltipTemplateId?(r.style.top=-this._vScrollOffset+(i.offsetY*u-i.height/2*u+i.height*u+15)+"px",r.style.left=-this._hScrollOffset+(i.offsetX*u-i.width/2*u)+(i.width/2*u-n(r).width()/2)+"px",e=n.templates("#"+this.model.tooltipTemplateId),f=[{name:this.activeTool.selectedObject.name,x:i.offsetX-i.width/2+"px",y:i.offsetY-i.height/2+"px",width:i.width+"px",height:i.height+"px",rotationAngle:i.rotateAngle}],o=e.render(f),n(r).html(o)):(e=n.templates("#"+this.element[0].id+"_defaultTooltip"),this.activeTool instanceof t.datavisualization.Diagram.MoveTool?(r.style.width="150px",f=[{type:"X : ",type1:"Y : ",x:Math.round(i.offsetX-i.width/2)+"px  ",y:Math.round(i.offsetY-i.height/2)+"px"}]):this.activeTool instanceof t.datavisualization.Diagram.ResizeTool?(r.style.width="150px",f=[{type:"W : ",type1:"H : ",x:Math.round(i.width)+"px  ",y:Math.round(i.height)+"px"}]):this.activeTool instanceof t.datavisualization.Diagram.RotateTool&&(r.style.width="50px",f=[{type:"",type1:"",x:Math.round(i.rotateAngle)+"&deg; ",y:""}]),f?(r.style.top=-this._vScrollOffset+(i.offsetY*u-i.height/2*u+i.height*u+15)+"px",r.style.left=-this._hScrollOffset+(i.offsetX*u-i.width/2*u)+(i.width/2*u-n(r).width()/2)+"px",o=e.render(f),n(r).html(o)):this._removeTooltip()))},_removeTooltip:function(){var n=document.getElementById(this.element[0].id+"_tooltipDiv");n&&n.parentNode.removeChild(n)},_renderCanvas:function(){this._canvas=document.createElement("div");this._canvas.setAttribute("id",this.element[0].id+"_canvas");this._canvas.setAttribute("class","drawing");this._canvas.setAttribute("style","position:relative; height:"+this.model.height+"; width:"+this.model.width+";");this.element.css({overflow:"hidden",outline:"none",display:"block",height:this.model.height,width:this.model.width});this.element[0].setAttribute("tabindex",0);this.element.append(this._canvas);this._renderDiagram();t.datavisualization.Diagram.PageUtil._updatePageSize(this)},_getDigramBounds:function(){var n,i,u,f,r;return n=Math.max(0,this._spatialSearch.pageLeft),i=Math.max(0,this._spatialSearch.pageTop),this.model.pageSettings.pageWidth||(u=this._spatialSearch.pageRight),this.model.pageSettings.pageHeight||(f=this._spatialSearch.pageBottom),this.model.pageSettings&&this.model.pageSettings.multiplePage?(n=Math.max(0,this._spatialSearch.pageLeft),i=Math.max(0,this._spatialSearch.pageTop),this.model.pageSettings.pageWidth&&(n=Math.floor(n/this.model.pageSettings.pageWidth)*this.model.pageSettings.pageWidth,u=Math.ceil(this._spatialSearch.pageRight/this.model.pageSettings.pageWidth)*this.model.pageSettings.pageWidth),this.model.pageSettings.pageHeight&&(i=Math.floor(i/this.model.pageSettings.pageHeight)*this.model.pageSettings.pageHeight,f=Math.ceil(this._spatialSearch.pageBottom/this.model.pageSettings.pageHeight)*this.model.pageSettings.pageHeight),this._spatialSearch.pageRight===null&&this.model.pageSettings.pageWidth!==0&&(u=this.model.pageSettings.pageWidth),this._spatialSearch.pageBottom===null&&this.model.pageSettings.pageHeight!==0&&(f=this.model.pageSettings.pageHeight)):(this.model.pageSettings.pageWidth&&(n=Math.min(0,this._spatialSearch.pageLeft),u=this.model.pageSettings.pageWidth),this.model.pageSettings.pageHeight&&(i=Math.min(0,this._spatialSearch.pageTop),f=this.model.pageSettings.pageHeight)),r=new t.datavisualization.Diagram.Rectangle,r.x=n,r.y=i,r.width=u,r.height=f,r},_initContextMenu:function(){this.model.contextMenu.showCustomMenuItemsOnly||(this.model.contextMenu.items=n.extend([],this._defaultContextMenuItems,this.model.contextMenu.items));this.model.enableContextMenu?this._renderContextMenu():this.element.remove("#"+this.element[0].id+"_contextMenu")},_renderContextMenuItem:function(n){var r=document.createElement("li"),f=document.createElement("a"),t,u,i,e;if(f.innerHTML=n.text,r.setAttribute("id",this.element[0].id+"_contextMenu_"+n.name),t=document.createElement("span"),t.setAttribute("id",n.text+"_image"),t.setAttribute("style","margin-top:-5px;"),t.setAttribute("class","sf-d-menuitem "+n.name),f.appendChild(t),n.subItems&&n.subItems.length>0){for(u=document.createElement("ul"),i=0,i;i<n.subItems.length;i++)e=this._renderContextMenuItem(n.subItems[i],u),u.appendChild(e);r.appendChild(u)}return r.appendChild(f),r},_renderContextMenu:function(){var u=this.model.contextMenu.items,i=0,f,e,r=document.createElement("ul");for(r.setAttribute("id",this.element[0].id+"_contextMenu"),i;i<u.length;i++)f=u[i],e=this._renderContextMenuItem(f,r),r.appendChild(e);this._canvas.appendChild(r);n("#"+this.element[0].id+"_contextMenu").ejMenu({menuType:t.MenuType.ContextMenu,contextMenuTargetID:this.element[0].id+"_canvas_svg",click:n.proxy(this._onMenuItemClick,this),beforeOpen:n.proxy(this._onContextMenuOpen,this),mouseover:n.proxy(this._onMenuItemMouseOver,this),mouseout:n.proxy(this._onMenuItemMouseOut,this),close:n.proxy(this._onContextMenuClose,this)})},_onContextMenuClose:function(){this.element[0].focus()},_onContextMenuOpen:function(n){var t=this.element[0].id,i;this.model.enableContextMenu&&(document.getElementById(t+"_contextMenu_cut").style.display="block",document.getElementById(t+"_contextMenu_copy").style.display="block",document.getElementById(t+"_contextMenu_paste").style.display="block",document.getElementById(t+"_contextMenu_undo").style.display="block",document.getElementById(t+"_contextMenu_redo").style.display="block",document.getElementById(t+"_contextMenu_selectAll").style.display="block",document.getElementById(t+"_contextMenu_cut").style.display="block",document.getElementById(t+"_contextMenu_grouping").style.display="block",document.getElementById(t+"_contextMenu_order").style.display="block",this.selectionList.length==0&&(document.getElementById(t+"_contextMenu_cut").style.display="none",document.getElementById(t+"_contextMenu_copy").style.display="none",document.getElementById(t+"_contextMenu_cut").style.display="none",document.getElementById(t+"_contextMenu_grouping").style.display="none",document.getElementById(t+"_contextMenu_order").style.display="none"));i={diagram:this,contextmenu:n};this._trigger(this.model.contextMenu.beforeOpen,i)},_onMenuItemClick:function(n){var t=n.events.text;switch(t){case"Cut":this.cut();break;case"Copy":this.copy();break;case"Paste":this.paste();break;case"Undo":this.undo();break;case"Redo":this.redo();break;case"Select All":this.selectAll();break;case"Group":this.group();break;case"Ungroup":this.ungroup();break;case"Bring To Front":this.bringToFront();break;case"Send To Back":this.sendToBack();break;case"Move Forward":this.moveForward();break;case"Send Backward":this.sendBackward()}this._trigger(this.model.contextMenu.click,n)},_onMenuItemMouseOver:function(t){var i=t.events.element.lastChild.childNodes[1];n(i).addClass("hover")},_onMenuItemMouseOut:function(t){var i=t.events.element.lastChild.childNodes[1];n(i).removeClass("hover")},_renderDiagram:function(){if(window.SVGSVGElement){var n={id:this._canvas.id+"_svg",version:"1.1",xlink:"http://www.w3.org/1999/xlink",style:"position:absolute"};this.model.width&&(n.width=this.model.width);this.model.height&&(n.width=this.model.height);this._svg=new t.datavisualization.Diagram.Svg(n);this._canvas.appendChild(this._svg.document);this._createScroller(this._canvas);t.datavisualization.Diagram.ScrollUtil._initScroller(this);this._renderView();this._renderPage();this._renderHtmlLayer();this._renderBackground();this._renderBackgroundLayer();this._renderGrid();this._renderDiagramLayer();this._renderAdornerLayer();this._renderNodes();this._renderConnectors()}},_createScroller:function(n){var i=document.createElement("div"),t,r;i.setAttribute("id",n.id+"_scroller");t=document.createElement("div");t.setAttribute("id",n.id+"_contentHolder");i.appendChild(t);r=document.createElement("div");r.setAttribute("id",t.id+"_content");t.appendChild(r);n.appendChild(i)},_doLayout:function(){this.model.layout&&this.model.layout.type!==t.datavisualization.Diagram.LayoutTypes.None&&(this._updateEdgeCollection(),t.datavisualization.Diagram.Layout.doLayout(this))},_updateNodes:function(){for(var i=this.model.nodes,n=0;n<i.length;n++)t.datavisualization.Diagram.SvgContext.update(i[n],this)},_updateConnectors:function(){for(var i=this.model.connectors,n=0;n<i.length;n++)t.datavisualization.Diagram.SvgContext.update(i[n],this)},_updateEdgeCollection:function(){for(var n=0;n<this.model.connectors.length;n++)this._updateEdges(this.model.connectors[n])},updateViewPort:function(){t.datavisualization.Diagram.ScrollUtil._updateScroller(this);t.datavisualization.Diagram.PageUtil._updatePageSize(this)},_renderView:function(){var n=this._svg,t={id:this._canvas.id+"_view"};this._view=n.g(t);this._svg.appendChild(this._view)},_renderHtmlLayer:function(){var n=document.createElement("div"),i={id:this._canvas.id+"_htmlLayer","class":"htmlLayer"};t.datavisualization.Diagram.Util.attr(n,i);this._htmlLayer=n;n.style.pointerEvents="none";this._canvas.appendChild(this._htmlLayer)},_renderPage:function(){var n=this._svg,t={id:this._canvas.id+"_page","class":"page"};this._page=n.g(t);this._view.appendChild(this._page)},_renderDiagramLayer:function(){var n=this._svg,t={id:this._canvas.id+"_diagramLayer","class":"DiagramLayer"};this._diagramLayer=n.g(t);this._page.appendChild(this._diagramLayer)},_renderAdornerLayer:function(){var n=this._svg,t={id:this._canvas.id+"_adornerLayer","class":"AdornerLayer"};this._adornerLayer=n.g(t);this._page.appendChild(this._adornerLayer)},_renderBackgroundLayer:function(){var n=this._svg,t={id:this._canvas.id+"_pageBackground","class":"PageBackgroundLayer"};this._pageBackgroundLayer=n.g(t);this._page.appendChild(this._pageBackgroundLayer)},_renderBackground:function(){var n=this._svg,r,t,i;n.document.style.msTouchAction="none";n.document.style.display="block";n.document.style.backgroundColor="white";r={id:this._canvas.id+"_backgroundLayer"};t=n.g(r);r={id:this._canvas.id+"_background",x:"0",y:"0",width:"100%",height:"100%",preserveAspectRatio:"none","pointer-events":"none"};i=n.image(r);this.model.backgroundImage?(i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.model.backgroundImage),this._svg.getElementById(this._canvas.id+"_background")||t.appendChild(i)):this._svg.getElementById(i.id)&&t.removeChild(this._svg.getElementById(i.id));this._svg.getElementById(t.id)||this._page.appendChild(t)},_renderGrid:function(){var f=this._svg,h=f.defs({id:this._canvas.id+"patterndefinition"}),r,u,c,n,e,o,s,i;f.appendChild(h);this.model.snapSettings.snapConstraints&t.datavisualization.Diagram.SnapConstraints.ShowHorizontalLines||this.model.snapSettings.snapConstraints&t.datavisualization.Diagram.SnapConstraints.ShowVerticalLines?(u=document.getElementById(this._canvas.id+"_grid"),c=document.getElementById(this._canvas.id+"pattern_gridline"),n=document.getElementById(this._canvas.id+"pattern_grid"),n&&h.removeChild(n),e={id:this._canvas.id+"_grid","pointer-events":"none"},r=f.g(e),o=0,this.model.snapSettings.horizontalGridLines.linesInterval&&this.model.snapSettings.horizontalGridLines.linesInterval.forEach(function(n){o+=n}),s=0,this.model.snapSettings.verticalGridLines.linesInterval&&this.model.snapSettings.verticalGridLines.linesInterval.forEach(function(n){s+=n}),i=this.model.zoomFactor,e={id:this._canvas.id+"pattern_grid",x:0,y:0,width:o*i,height:s*i,patternUnits:"userSpaceOnUse"},n=this._svg.pattern(e),i=this._scaleSnapInterval(i),this._renderHorizontalGridlines(i,n,o),this._renderVerticalGridlines(i,n,s),h.appendChild(n),c=f.rect({id:this._canvas.id+"pattern_gridline",x:0,y:0,width:"100%",height:"100%",fill:"url(#"+this._canvas.id+"pattern_grid)"}),r.appendChild(c),u||this._page.appendChild(r)):(r=document.getElementById(this._canvas.id+"_grid"),r&&(u=document.getElementById(this._canvas.id+"pattern_gridline"),u&&r.removeChild(u)))},_updateGrid:function(n,t,i){var c=document.getElementById(this._canvas.id+"pattern_gridline"),r,u,f,e,s,o,h;if(c){if(u=document.getElementById(this._canvas.id+"pattern_grid"),f=0,this.model.snapSettings.horizontalGridLines.linesInterval)for(r=0;r<this.model.snapSettings.horizontalGridLines.linesInterval.length;r++)f+=this.model.snapSettings.horizontalGridLines.linesInterval[r];if(e=0,this.model.snapSettings.verticalGridLines.linesInterval)for(r=0;r<this.model.snapSettings.verticalGridLines.linesInterval.length;r++)e+=this.model.snapSettings.verticalGridLines.linesInterval[r];i=this._scaleSnapInterval(i);s=this._svg;o=s.defs({id:this._canvas.id+"patterndefinition"});u&&o.removeChild(u);h={id:this._canvas.id+"pattern_grid",x:0,y:0,width:f*i,height:e*i,patternUnits:"userSpaceOnUse"};u=this._svg.pattern(h);this._renderHorizontalGridlines(i,u,f);this._renderVerticalGridlines(i,u,e);o.appendChild(u)}},_scaleSnapInterval:function(n){if(n>=2)while(n>=2)n/=2;else if(n<=.5)while(n<=.5)n*=2;var t;if(n!==1){for(this.model.snapSettings.horizontalGridLines.snapInterval=[],t=0;t<this.model.snapSettings.horizontalGridLines.snapInterval.length;t++)this.model.snapSettings.horizontalGridLines.snapInterval[t]=this.model.snapSettings.horizontalGridLines.snapInterval[t]*n;for(this.model.snapSettings.verticalGridLines.snapInterval=[],t=0;t<this.model.snapSettings.verticalGridLines.snapInterval.length;t++)this.model.snapSettings.verticalGridLines.snapInterval[t]=this.model.snapSettings.verticalGridLines.snapInterval[t]*n}return n},_renderHorizontalGridlines:function(n,i,r){var u=this.model.snapSettings,e,s,f,o,h;if(u.snapConstraints&t.datavisualization.Diagram.SnapConstraints.ShowHorizontalLines)for(e=0,s=0,f=0;f<u.horizontalGridLines.linesInterval.length;f=f+2)o=u.horizontalGridLines.linesInterval[f],h=this._svg.line({x1:0,y1:e*n,x2:r*n,y2:e*n,stroke:u.horizontalGridLines.lineColor,"stroke-width":o,"stroke-dasharray":u.horizontalGridLines.lineDashArray}),e+=u.horizontalGridLines.linesInterval[f+1]+o,i.appendChild(h),s++},_renderVerticalGridlines:function(n,i,r){var f=this.model.snapSettings,e,s,u,o,h;if(f.snapConstraints&t.datavisualization.Diagram.SnapConstraints.ShowVerticalLines)for(e=0,s=0,u=0;u<f.verticalGridLines.linesInterval.length;u=u+2)o=this.model.snapSettings.verticalGridLines.linesInterval[u],h=this._svg.line({x1:e*n,y1:0,x2:e*n,y2:r*n,stroke:f.verticalGridLines.lineColor,"stroke-width":o,"stroke-dasharray":f.verticalGridLines.lineDashArray}),e+=f.verticalGridLines.linesInterval[u+1]+o,i.appendChild(h),s++},_setZorder:function(n){if(n&&(n.zOrder=this._zOrder,this._zOrder++,n.isGroup)){var t=0;for(t;t<n.children.length;t++)this.nameTable[n.children[t]].zOrder=t}},_renderNodes:function(){var r,i,u,n;if(this.model.nodes)for(r=this.model.nodes,i=0,u=r.length;i<u;++i)n=r[i],this._setZorder(n),n.isGroup?(this._updateChildBounds(n,this.nameTable),t.datavisualization.Diagram.Util._updateGroupBounds(n,this.nameTable),t.datavisualization.Diagram.SvgContext.renderGroup(n,this._svg,this._diagramLayer,this.nameTable)):n.parent||t.datavisualization.Diagram.SvgContext.renderNode(n,this._svg,this._diagramLayer,this)},_renderConnectors:function(){for(var i=this.model.connectors,n=0,r=i.length;n<r;++n)i[n].parent||(this._setZorder(i[n]),t.datavisualization.Diagram.SvgContext.renderConnector(i[n],this._svg,this._diagramLayer,this))},_wireEvents:function(){var i=n(this._canvas),r;this._on(i,t.eventType.mouseDown,this._mousedown);this._on(i,t.eventType.mouseMove,this._mousemove);this._on(i,t.eventType.mouseUp,this._mouseup);this._on(i,t.eventType.mouseLeave,this._documentmouseup);this._on(i,"dblclick",this._doubleclick);this._on(i,"doubletap",this._doubleclick);this._on(this.element,"keydown",this._keydown);this._on(i,"pinchin",this._pinchin);this._on(i,"pinchout",this._pinchout);this._on(this.element,"touchstart",this._handleTouchStart);t.browserInfo().name==="mozilla"?this._on(this.element,"DOMMouseScroll",this._handleMouseWheel):this._on(this.element,"mousewheel",this._handleMouseWheel);this._on(n(document),"mouseup",this._documentmouseup);window&&this._on(n(window),"resize",this.updateViewPort);r=this;n(i).ejDroppable({drop:function(n,t){r._svgdrop(n,t);r._isDropped=!0}})},_mousePosition:function(n,i){var f=this._isTouchEvent(n),o=this._canvas.scrollLeft,s=this._canvas.scrollTop,e=this._canvas.getBoundingClientRect(),r=f.clientX+o-e.left,u=s+f.clientY-e.top;return i||(r=(r+this._hScrollOffset)/this.model.zoomFactor,u=(u+this._vScrollOffset)/this.model.zoomFactor),new t.datavisualization.Diagram.Point(r,u)},_contextmenu:function(n){n.preventDefault();n.stopPropagation()},_pinchin:function(n){n.preventDefault()},_pinchout:function(n){n.preventDefault()},_handleTouchStart:function(n){n.preventDefault()},_mousedown:function(t){if(this._invoke(t)&&(this._isForeignObject(t.originalEvent.target)||t.preventDefault(),this.model.contextMenu&&n("#"+this.element[0].id+"_contextMenu").css("display")!=="none"&&(t.cancel=!0),this._isEditing&&this._endEdit(),t.which===1||t.which===0&&t.originalEvent.changedTouches)){if(t.which===0&&t.originalEvent.changedTouches){var i=null,r=this._mousePosition(t),u=this._isUserHandle(t);this._isInternalTool(this.activeTool)&&!this.activeTool.inAction&&(u||(i=this._findNodeUnderMouse(t),this._raiseMouseEvents(i)),!i&&this.selectionList[0]&&(i=this.selectionList[0]),this._checkToolToActivate(t,i,r))}this.activateTool(this._toolToActivate);this.activeTool.mousedown(t)}},_invoke:function(n){var t=n.originalEvent.target.className;return n.originalEvent.target&&(t=="edit"||t=="editBox"||t=="e-hhandle"||t=="e-hhandlespace"||t=="e-vhandle"||t=="e-vhandlespace")?!1:!0},_handleMouseWheel:function(i){var u,r,o,s;if(i.originalEvent.preventDefault&&i.originalEvent.preventDefault(),u=new t.datavisualization.Diagram.Point(0,0),i.ctrlKey)u.x=(i.originalEvent.layerX+this._hScrollOffset)/this.model.zoomFactor,u.y=(i.originalEvent.layerY+this._vScrollOffset)/this.model.zoomFactor,i.originalEvent.wheelDelta>0||-40*i.originalEvent.detail>0?t.datavisualization.Diagram.ZoomUtil.zoomPan(this,1+.2,0,0,u,!0):t.datavisualization.Diagram.ZoomUtil.zoomPan(this,1-.2,0,0,u,!0);else{if(r=0,i.originalEvent.wheelDelta>0||-40*i.originalEvent.detail>0)this._vScrollOffset-this._scrollPixel>=0?(this._updateScrollOffset(this._hScrollOffset,this._vScrollOffset-this._scrollPixel),r=-this._scrollPixel):(this._updateScrollOffset(this._hScrollOffset,0),r=0);else if(document.getElementById(this.element[0].id).getElementsByClassName("e-vhandle").length>0){var h=n("#"+this._canvas.id+"_contentHolder_content"),f=h.height(),e=t.datavisualization.Diagram.ScrollUtil._viewPort(this);f-e.height>=this._vScrollOffset+this._scrollPixel?(this._updateScrollOffset(this._hScrollOffset,this._vScrollOffset+this._scrollPixel),r=this._scrollPixel):f-e.height>=this._vScrollOffset&&(o=f-e.height,s=this._vScrollOffset,this._updateScrollOffset(this._hScrollOffset,this._vScrollOffset+(o-s)),r=0)}this._updateEditBox(0,r)}},_mousemove:function(n){var i=null,f=this._mousePosition(n),e=this._isUserHandle(n),u,r;this._isInternalTool(this.activeTool)&&!this.activeTool.inAction?(e||(i=this._findNodeUnderMouse(n),this._raiseMouseEvents(i)),!i&&this.selectionList[0]&&(i=this.selectionList[0]),this._checkToolToActivate(n,i,f)):(this.activeTool.inAction||this.activeTool.singleAction||(this._toolToActivate=this.activeTool.name,this._currentCursor=this.activeTool.cursor),i=this._findNodeUnderMouse(n),this._raiseMouseEvents(i));this._updateCursor();this.activeTool.mousemove(n);this.activeTool.inAction&&this.model.enableAutoScroll&&(u=t.datavisualization.Diagram.ScrollUtil._viewPort(this),r=this._mousePosition(n,!0),r.x+15>=u.width-15?(this._beginAutoScroll("right",n),this._canAutoScroll=!0):r.x<=15&&this._hScrollOffset>0?(this._beginAutoScroll("left",n),this._canAutoScroll=!0):r.y+15>=u.height-15?(this._beginAutoScroll("bottom",n),this._canAutoScroll=!0):r.y<=15&&this._vScrollOffset>0?(this._beginAutoScroll("top",n),this._canAutoScroll=!0):this._canAutoScroll=!1)},_setActiveTool:function(t){var r=this._mousePosition(t),i,u,f;this.activeTool.inAction||!this._isUserHandleActive(this.activeTool.name)&&this.model.userHandles&&this.model.userHandles.length||(this._isInternalTool(this.activeTool)||this.activeTool.singleAction)&&(u=!1,this.selectionList[0]&&(i=this.selectionList[0],u=this._checkToolToActivate(t,i,r)),u||(i=this._findNodeUnderMouse(t),this._isUserHandle(t)?(f=n(t.target).parents("g").first().context.id.split("_")[0],this._checkToolToActivate(t,i,r,f),this.activeTool=this.tools[this._toolToActivate]):(this._checkToolToActivate(t,i,r),this._raiseMouseEvents(i),this._isUserHandleActive(this.activateTool.name)&&!this._drawingTool&&(this.activeTool=this.tools[this._toolToActivate]))))},_beginAutoScroll:function(i,r){var s=this,u=0,f=0,e=n("#"+this._canvas.id+"_contentHolder_content"),h=e.width(),c=e.height(),o=t.datavisualization.Diagram.ScrollUtil._viewPort(this);if(this._canAutoScroll){switch(i){case"right":this._hScrollOffset+o.width<h&&(u=10);break;case"left":this._hScrollOffset-10>=0&&(u=-10);break;case"bottom":this._vScrollOffset+o.height<c&&(f=10);break;case"top":this._vScrollOffset-10>=0&&(f=-10)}setTimeout(function(){s._updateScrollBar(u,f,i,r)},100)}},_updateScrollBar:function(n,t,i,r){if(n===0&&t===0)this._canAutoScroll=!1;else if(this.activeTool.inAction&&!this._drawingTool&&this._enableAutoScroll(n,t)){var u=this._hScrollOffset+n*this.model.zoomFactor,f=this._vScrollOffset+t*this.model.zoomFactor;this._updateSelectionOnScroll(n,t);this._updateScrollOffset(u,f);this._beginAutoScroll(i,r)}},_enableAutoScroll:function(i,r){var u=!0,f=n("#"+this._canvas.id+"_contentHolder_content"),o=f.width(),s=f.height(),e=t.datavisualization.Diagram.ScrollUtil._viewPort(this);return i<0&&this._hScrollOffset+i<0&&(u=!1),r<0&&this._vScrollOffset+r<0&&(u=!1),this.activeTool.name==="select"&&this._vScrollOffset+e.height+r>s&&(u=!1),this.activeTool.name==="select"&&this._hScrollOffset+e.width+i>o&&(u=!1),this.activeTool.name==="endPoint"&&(u=!1),u},_updateSelectionOnScroll:function(n,i){var r=this.activeTool,u;r.name==="select"?(r.currentPoint=new t.datavisualization.Diagram.Point(r.currentPoint.x+n,r.currentPoint.y+i),r._updateHelper()):this.selectionList.length>0&&(u=this.selectionList[0],r.currentPoint.x=r.currentPoint.x+n,r.currentPoint.y=r.currentPoint.y+i,r.name==="move"?this._translate(u,n,i,this.nameTable):r.name==="resize"&&(t.datavisualization.Diagram.SnapUtil._removeGuidelines(diagram),r._updateSize(u,r.previousPoint,r.currentPoint,n,i)),t.datavisualization.Diagram.SvgContext.update(u,this),this._updateSelectionHandle(),this._renderTooltip(u))},_isUserHandle:function(n){return n.target.parentNode.className.animVal==="userHandle"?!0:!1},_isUserHandleActive:function(n){var i=!1,t,r;if(this.model.userHandles&&this.model.userHandles.length>0)for(t=0,r=this.model.userHandles.length,t;t<r;t++)if(this.model.userHandles[t].name===n){i=!0;break}else i=!0;return i},_raiseMouseEvents:function(n){!n&&this._nodeToHit&&this._trigger("mouseLeave",{element:this._nodeToHit});n?this._nodeToHit!==n&&(this._nodeToHit=n,this._trigger("mouseEnter",{element:n})):this._nodeToHit=null;n&&this._trigger("mouseOver",{diagram:n})},_isHandle:function(t){var i=n(t.target).parent("g.handle");return i.length>0?!0:!1},_findNodeUnderMouse:function(t){var u=null,i,r=n(t.target).parents(".ej-d-node,.ej-d-connector");return r&&(i=r.attr("class"),i==="ej-d-node"||i==="ej-d-group"?u=this._findNode(r.attr("id")):i==="ej-d-connector"&&(u=this._findConnector(r.attr("id")))),u},_isForeignObject:function(n){var t=n.parentNode;if(t)while(t.parentNode!=null){if(t.className==="foreignObject")return t;t=t.parentNode}return null},_mouseup:function(n){if(this._invoke(n)){var i=this._isForeignObject(n.originalEvent.target);i||n.preventDefault();n.target.id===this._id+"_canvas_svg"&&this._trigger("click",{element:this});this.activeTool.mouseup(n);this.activeTool instanceof t.datavisualization.Diagram.PanTool&&(document.onmousemove=null,document.onmouseup=null);this.activeTool instanceof t.datavisualization.Diagram.PolygonTool||this.activeTool instanceof t.datavisualization.Diagram.TextTool||!document.activeElement||document.activeElement.id===this.element[0].id||this._isEditing||i||this.element[0].focus();this._currentCursor=this.activeTool.cursor;this._updateCursor()}},_doubleclick:function(n){var r,i;!this.activeTool.inAction&&this.selectionList.length>0?(r=this._trigger("doubleClick",{element:this.selectionList[0],cancel:!1}),i=this.selectionList[0],i.isPseudoGroup||r.cancel||(!this._isEditing&&i.shape&&i.shape.type==="text"&&this._setLabelEditing(i.shape.textBlock)?(this.scrollToNode(i),this._startEdit(i)):!this._isEditing&&(i.labels.length===0||typeof i.labels.length=="undefined"||i.labels.length>0&&this._setLabelEditing(i.labels[0]))&&(this.scrollToNode(i),this._startEdit(i)))):this.activeTool instanceof t.datavisualization.Diagram.PolygonTool&&this.activeTool.doubleclick(n)},_keydown:function(n){var t=n.keyCode?n.keyCode:n.which,i;t===113?this.selectionList.length>0&&(i=this.selectionList[0],i.isPseudoGroup||(i.shape.type==="text"&&this._setLabelEditing(i.shape.textBlock)?this._startEdit(i):i.labels.length>0&&this._setLabelEditing(i.labels[0])&&this._startEdit(i))):this._isEditing&&t===27?this._endEdit():this._isEditing||t!==46?!this._isEditing&&n.ctrlKey&&t===88?this.cut():!this._isEditing&&n.ctrlKey&&t===67?this.copy():!this._isEditing&&n.ctrlKey&&t===86?this.paste():n.ctrlKey&&t===65?(this._isEditing&&this._endEdit(),n.preventDefault(),this.selectAll()):!this._isEditing&&n.ctrlKey&&t===89?this.redo():!this._isEditing&&n.ctrlKey&&t===90&&this.undo():this._delete();this._isEditing||t!==37&&t!==38&&t!==39&&t!==40||(n.preventDefault(),t===37?this.nudge("left"):t===38?this.nudge("up"):t===39?this.nudge("right"):t===40&&this.nudge("down"));this.activeTool.keydown(n)},_registerHistoryEvents:function(){this.historyManager.addEventHandler("collectionchanged",n.proxy(this._recordCollectionChanged,this));this.historyManager.addEventHandler("positionchanged",n.proxy(this._recordPinPointChanged,this));this.historyManager.addEventHandler("sizechanged",n.proxy(this._recordResizeChanged,this));this.historyManager.addEventHandler("rotationchanged",n.proxy(this._recordRotationChanged,this));this.historyManager.addEventHandler("endpointchanged",n.proxy(this._recordEndPointChanged,this));this.historyManager.addEventHandler("labelchanged",n.proxy(this._recordLabelChanged,this));this.historyManager.addEventHandler("groupingchanged",n.proxy(this._recordGroupChanged,this))},_updatePoints:function(n,i,r,u){var f=new t.datavisualization.Diagram.Point(r.x-i.x,r.y-i.y);t.datavisualization.Diagram.Geometry.isEmptyPoint(f)||n._updateEndPoint(f.x,f.y,u)},_recordCollectionChanged:function(n){var i,o,e,r,f,u;if(this._clearSelection(),this._isUndo=!0,o=n.changeType,n.isUndo&&(o=n.changeType=="insert"?"remove":"insert"),o=="insert")if(n.object.isPseudoGroup){for(delete this.nameTable.multipleSelection,u=t.datavisualization.Diagram.Group({name:"multipleSelection",isPseudoGroup:!0}),i=0;i<n.object.children.length;i++)u.children.push(n.object.children[i]),r=n.childTable[n.object.children[i]],r.parent="",r.isGroup&&this._addChildren(r,n.childTable),this.add(n.childTable[n.object.children[i]]);for(i=0;i<u.children.length;i++)if(r=this.nameTable[u.children[i]],!r.line){if(r.inEdges.length>0)for(f=0;f<r.inEdges.length;f++)this.nameTable[r.inEdges[f]].targetNode=r.name;if(r.outEdges.length>0)for(f=0;f<r.outEdges.length;f++)this.nameTable[r.outEdges[f]].sourceNode=r.name}this._clearSelection();this.model.nodes.push(u);u.offsetX=n.object.offsetX;u.offsetY=n.object.offsetY;u.height=n.object.height;u.width=n.object.width;u.rotateAngle=n.object.rotateAngle;this.addSelection(u);this.nameTable[u.name]=u}else{if(!n.object.line){if(e=null,n.object.inEdges.length>0)for(i=0;i<n.object.inEdges.length;i++)this.nameTable[n.object.inEdges[i]].targetNode=n.object.name,e=n.targetPorts[n.object.inEdges[i]],e&&(this.nameTable[n.object.inEdges[i]].targetPort=e);if(n.object.outEdges.length>0)for(i=0;i<n.object.outEdges.length;i++)this.nameTable[n.object.outEdges[i]].sourceNode=n.object.name,e=n.sourcePorts[n.object.outEdges[i]],e&&(this.nameTable[n.object.outEdges[i]].sourcePort=e)}n.object.isGroup&&this._addChildren(n.object,n.childTable);this.add(n.object);this.addSelection(n.object)}else if(o=="remove")if(n.object.isPseudoGroup)for(i=0;i<n.object.children.length;i++)this._remove(this.nameTable[n.object.children[i]]);else this._remove(n.object);this._isUndo=!1},_addChildren:function(n,t){for(var r,i=0;i<n.children.length;i++)r=t[n.children[i]],r.isGroup?this._addChildren(r,t):this.nameTable[n.children[i]]=r},_updateRecordPinPoint:function(n,i,r){var u,o,f,h,s,c,e;if(n.isPseudoGroup){for(s=n,o=0;o<n.children.length;o++)f=this.nameTable[n.children[o]],h=i[n.children[o]],h&&(f.line?(c=i[f.name],f.line.startPoint=c.line.startPoint,f.line.endPoint=c.line.endPoint,f.line.points=c.line.points):this._translate(f,h.offsetX-f.offsetX,h.offsetY-f.offsetY,this.nameTable),t.datavisualization.Diagram.SvgContext.update(f,this));this.selectionList[0]&&this.selectionList[0].name===s.name&&(this.selectionList[0].offsetX=s.offsetX,this.selectionList[0].offsetY=s.offsetY);t.datavisualization.Diagram.SvgContext.updateSelector(s,this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)}else n.line?r?(u=i[n.name],n.line.startPoint=u.line.startPoint,n.line.endPoint=u.line.endPoint,n.line.points=u.line.points,t.datavisualization.Diagram.SvgContext.update(n,this)):(this._clearSelection(),u=this._findConnector(n.name),n.targetNode&&(e=this.nameTable[n.targetNode],t.datavisualization.Diagram.Util.removeItem(e.inEdges,n)),n.sourceNode&&(e=this.nameTable[n.sourceNode],t.datavisualization.Diagram.Util.removeItem(e.outEdges,n)),n.targetNode&&(e=this.nameTable[n.targetNode],e.inEdges.push(n.name)),n.sourceNode&&(e=this.nameTable[n.sourceNode],e.outEdges.push(n.name)),u.targetNode=n.targetNode,u.sourceNode=n.sourceNode,u.targetPort=n.targetPort,u.sourcePort=n.sourcePort,u.line.startPoint=n.line.startPoint,u.line.endPoint=n.line.endPoint,u.line.points=n.line.points,t.datavisualization.Diagram.SvgContext.update(u,this),t.datavisualization.Diagram.SvgContext.updateSelector(n,this._svg,this.model.zoomFactor,this,this.model.selectorConstraints),this.addSelection(n)):r?(u=i[n.name],this._translate(n,u.offsetX-n.offsetX,u.offsetY-n.offsetY,i),t.datavisualization.Diagram.SvgContext.update(u,this)):(this._clearSelection(),u=this._findNode(n.name),this._translate(u,n.offsetX-u.offsetX,n.offsetY-u.offsetY,this.nameTable),n.parent&&t.datavisualization.Diagram.Util._updateGroupBounds(this.nameTable[u.parent],this.nameTable),t.datavisualization.Diagram.SvgContext.update(u,this),this.addSelection(u))},_recordPinPointChanged:function(n){var t=n.object.node,i=n.object.childTable;this._updateRecordPinPoint(t,i)},_updateRecordRotation:function(n,i){var u,f,r,e,o,s;if(n.isPseudoGroup){for(u=this.nameTable[n.name],f=0;f<n.children.length;f++)r=this.nameTable[n.children[f]],e=i[n.children[f]],r&&(r.line?(o=i[r.name],r.line.startPoint=o.line.startPoint,r.line.endPoint=o.line.endPoint,r.line.points=o.line.points):e&&(this._translate(r,e.offsetX-r.offsetX,e.offsetY-r.offsetY,this.nameTable),this._rotate(r,e.rotateAngle-r.rotateAngle,this.nameTable)),t.datavisualization.Diagram.SvgContext.update(r,this));u&&(s=n.rotateAngle-u.rotateAngle,u.rotateAngle+=s,this.selectionList[0]&&(this.selectionList[0].rotateAngle=u.rotateAngle));t.datavisualization.Diagram.SvgContext.updateSelector(n,this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)}else n&&(this._clearSelection(),u=this._findNode(n.name),this._rotate(u,n.rotateAngle-u.rotateAngle,this.nameTable),t.datavisualization.Diagram.SvgContext.update(u,this),this.addSelection(u))},_recordSizeChanged:function(n){var t=n.object.node,i=n.object.childTable;this._updateRecordSize(t,i)},_updateRecordSize:function(n,i){var r,e,f,u,o;if(n.isGroup||n.isPseudoGroup){for(n.isPseudoGroup&&(this.nameTable[n.name]=n),r=this._findNode(n.name),e=0;e<r.children.length;e++)u=this.nameTable[n.children[e]],f=i[n.children[e]],f&&(u.line?(o=i[u.name],u.line.startPoint=o.line.startPoint,u.line.endPoint=o.line.endPoint,u.line.points=o.line.points,t.datavisualization.Diagram.SvgContext.update(u,this)):(this._translate(u,f.offsetX-u.offsetX,f.offsetY-u.offsetY,this.nameTable),this._scale(u,f.width/u.width,f.height/u.height,t.datavisualization.Diagram.Point(u.offsetX,u.offsetY),this.nameTable),t.datavisualization.Diagram.SvgContext.update(u,this)));r.offsetX=n.offsetX;r.offsetY=n.offsetY;r.width=n.width;r.height=n.height;t.datavisualization.Diagram.SvgContext.updateSelector(r,this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)}else n.line||(r=this._findNode(n.name),this._translate(r,n.offsetX-r.offsetX,n.offsetY-r.offsetY,this.nameTable),this._scale(r,n.width/r.width,n.height/r.height,t.datavisualization.Diagram.Point(r.offsetX,r.offsetY),this.nameTable),t.datavisualization.Diagram.SvgContext.update(r,this),t.datavisualization.Diagram.SvgContext.updateSelector(r,this._svg,this.model.zoomFactor,this,this.model.selectorConstraints))},_recordRotationChanged:function(n){var t=n.object.node,i=n.object.childTable;this._updateRecordRotation(t,i)},_recordEndPointChanged:function(n){var i,r,u,f;n._isUndo?(i=r=n.undoObject,u=n.redoObject):(i=r=n.redoObject,u=n.undoObject);i=i.parent?this._findChildren(i.parent,i.name):this._findConnector(i.name);u.targetNode&&(f=this.nameTable[u.targetNode],t.datavisualization.Diagram.Util.removeItem(f.inEdges,u));u.sourceNode&&(f=this.nameTable[u.sourceNode],t.datavisualization.Diagram.Util.removeItem(f.outEdges,u));r.targetNode&&(f=this.nameTable[r.targetNode],f.inEdges.push(r.name));r.sourceNode&&(f=this.nameTable[r.sourceNode],f.outEdges.push(r.name));i.targetNode=r.targetNode;i.sourceNode=r.sourceNode;i.targetPort=r.targetPort;i.sourcePort=r.sourcePort;i.line.startPoint=r.line.startPoint;i.line.endPoint=r.line.endPoint;i.line.points=r.line.points;i.line.type==="bezier"&&(i.line._point1=r.line._point1,i.line._point2=r.line._point2);this._updateEdges(i);this._dock(i,this.nameTable);t.datavisualization.Diagram.SvgContext.update(i,this);this._updateSelectionHandle();t.datavisualization.Diagram.SvgContext.updateSelector(i,this._svg,this.model.zoomFactor,this,this.model.selectorConstraints)},_recordLabelChanged:function(n){var i=this.nameTable[n.object.name];n.object.shape&&n.object.shape.type==="text"?(i.shape.textBlock.text=n.label,t.datavisualization.Diagram.SvgContext.updateTextBlock(i,i.shape.textBlock,this._svg)):(i.labels[0].text=n.label,t.datavisualization.Diagram.SvgContext.updateLabel(i,i.labels[0],this._svg))},_recordGroupChanged:function(i){var s,e,o,r,u,f;if(this._clearSelection(),s=i.actionType,i.isUndo&&(i.actionType==="group"&&(s="ungroup"),i.actionType==="ungroup"&&(s="group")),e=i.object.children,s==="group"){for(o=new t.datavisualization.Diagram.Group({name:i.object.name}),r=0;r<e.length;r++)o.children.push(e[r]),this.nameTable[e[r]].parent=o.name,n("#"+e[r])[0].parentNode.removeChild(n("#"+e[r])[0]);this.add(o);this._addSelection(o)}else{for(u=i.object,n("#"+u.name)[0]&&n("#"+u.name)[0].parentNode.removeChild(n("#"+u.name)[0]),r=0;r<u.children.length;r++)f=this.nameTable[u.children[r]],f.parent="",this._isUndo=!0,f.line?t.datavisualization.Diagram.SvgContext.renderConnector(f,this._svg,this._diagramLayer):f.isGroup?t.datavisualization.Diagram.SvgContext.renderGroup(f,this._svg,this._diagramLayer,this.nameTable):t.datavisualization.Diagram.SvgContext.renderNode(f,this._svg,this._diagramLayer),this._isUndo=!1;t.datavisualization.Diagram.Util.removeItem(this.model.nodes,this._findNode(u.name))}},_svgdrop:function(i,r){var o={},v=i.originalEvent,u,c,s,b,e,ut,h,k,ft,l,f,d;v.preventDefault?v.preventDefault():v.returnValue=!1;var a=this.model.zoomFactor,g=n("#"+this.element[0].id).offset(),y=this._isTouchEvent(i),p,w;y?(p=y.pageX,w=y.pageY):(p=i.pageX,w=i.pageY);var nt=p+this._hScrollOffset-g.left,tt=w+this._vScrollOffset-g.top,it=r.helper[0].getAttribute("paletteId"),rt=n("#"+it).ejSymbolPalette("instance");if(it){if(u=n.extend(!0,{},rt.selectedItem),u.name+=t.datavisualization.Diagram.Util.randomId(),u.line){if(c=u,c.line.points)for(s=c.line.points,b=t.datavisualization.Diagram.Geometry.rect(s),e=0,ut=s.length;e<ut;++e)h=t.datavisualization.Diagram.Geometry.translate(s[e],-b.x,-b.y),h=t.datavisualization.Diagram.Geometry.translate(h,nt,tt),s[e]=h,k=new t.datavisualization.Diagram.Point(h.x/a,h.y/a),e===0&&this._setEndPoint(c,k,!1),e===s.length-1&&this._setEndPoint(c,k,!0);o={element:u};this._raiseDropEvent(o);this.add(u)}else{if(ft=n.extend(!0,{},rt.nameTable),u.offsetX=nt/a,u.offsetY=tt/a,u.isGroup){for(l=0;l<u.children.length;l++)f=n.extend(!0,{},ft[u.children[l]]),f.parent=u.name,f.name=u.name+f.name,u.children[l]=f.name,this.nameTable[f.name]=f,this.model.nodes.push(f),t.datavisualization.Diagram.SpatialUtil._updateQuad(this,this._spatialSearch,f);u.height=u.width=0;this._updateChildBounds(u,this.nameTable)}o={element:u};this._raiseDropEvent(o);this.add(u)}this.scrollToNode(u);u.labels.length>0&&u.labels[0].mode==="edit"?(this._isEditing=!0,this.startLabelEdit(u,u.labels[0])):this.element[0].focus()}else d=null,d=this._findNodeUnderMouse(i),o={element:r.helper,e:i,draggable:r.draggable,targetNode:d},this._raiseDropEvent(o)},_isTouchEvent:function(n){return n.type=="touchmove"||n.type=="touchstart"||n.type=="touchend"?n.originalEvent.changedTouches[0]:n},_raiseDropEvent:function(n){this._trigger("drop",n)},_documentmouseup:function(n){!this.activeTool||!this.activeTool.inAction||this.activeTool instanceof t.datavisualization.Diagram.PolygonTool||this.activeTool instanceof t.datavisualization.Diagram.TextTool||this.activeTool.mouseup(n)},_updateEdges:function(n){var i;t.datavisualization.Diagram.Util.isTargetConnected(n)&&(i=this.nameTable[n.targetNode],i&&i.inEdges.indexOf(n.name)==-1&&i.inEdges.push(n.name));t.datavisualization.Diagram.Util.isSourceConnected(n)&&(i=this.nameTable[n.sourceNode],i&&i.outEdges.indexOf(n.name)==-1&&i.outEdges.push(n.name))},_updateChildrenEdges:function(n){for(var t,i=0;i<n.children.length;i++)t=n.children[i],t.line?(this._updateEdges(t),this._dock(t,this.nameTable)):t.isGroup&&this._updateChildrenEdges(t)},_findPortAtPoint:function(n,i){var e,r,h,o,u,c,l,a,s,f,v;if(i)for(a=t.datavisualization.Diagram.Util.bounds(i,!0),e=i.ports,f=0,v=e.length;f<v;++f)if(r=e[f],o=t.datavisualization.Diagram.Size(r.size,r.size),u=t.datavisualization.Diagram.Util._getPortPosition(r,a),s=t.Matrix.identity(),t.Matrix.rotate(s,i.rotateAngle,i.offsetX,i.offsetY),u=t.Matrix.transform(s,u),c=u.x-r.size/2,l=u.y-r.size/2,h=t.datavisualization.Diagram.Rectangle(c,l,o.width,o.height),t.datavisualization.Diagram.Geometry.containsPoint(h,n))return r;return null},_findLabelAtPoint:function(n,i){var e,f=null,l,o,r,a,v,y,p,u,s,h,c,w;if(i&&(u=t.datavisualization.Diagram.Util.bounds(i),e=i.labels,e.length>0))for(f=e[0],c=0,w=e.length;c<w;c++)if(f=e[c],s=this._svg.getElementById(i.name+"_"+f.name).getBBox(),y=s.width==0?u.width:s.width,p=s.height==0?f.fontSize:s.height,o=t.datavisualization.Diagram.Size(y,p),r=t.datavisualization.Diagram.Util._getLabelPosition(f,u),r.x=u.x+r.x,r.y=u.y+r.y,h=t.Matrix.identity(),i.line?t.Matrix.rotate(h,0,u.x+u.width/2,u.y+u.height/2):t.Matrix.rotate(h,i.rotateAngle,i.offsetX,i.offsetY),r=t.Matrix.transform(h,r),a=r.x-o.width/2,v=r.y-o.height/2,l=t.datavisualization.Diagram.Rectangle(a,v,o.width,o.height),t.datavisualization.Diagram.Geometry.containsPoint(l,n))break;return f},_findNode:function(n){return this.nameTable[n]},_findPort:function(n,t){for(var r=n.ports,i=0,u=r.length;i<u;i++)if(r[i].name===t)return r[i];return null},_findConnector:function(n){return this.nameTable[n]},_findChildren:function(n,t){for(var i,r,u=0;u<n.children.length;u++){if(i=this.nameTable[n.children[u]],t==i.name)return i;if(i.isGroup&&(r=this._findChildren(i,t),r))return r}return null},_delete:function(){var i,f,e,t,r,s,u,o,n;if(this.selectionList[0]){if(i={},i=this._getChildTable(this.selectionList[0],i),!this._isUndo){if(f={},e={},!this.selectionList[0].line){if(this.selectionList[0].outEdges.length>0)for(r=this.selectionList[0].outEdges.length,n=0;n<r;n++)t=this.nameTable[this.selectionList[0].outEdges[n]],t.sourcePort&&(f[t.name]=t.sourcePort);if(this.selectionList[0].inEdges.length>0)for(r=this.selectionList[0].inEdges.length,n=0;n<r;n++)t=this.nameTable[this.selectionList[0].inEdges[n]],t.targetPort&&(e[t.name]=t.targetPort)}s={type:"collectionchanged",object:jQuery.extend(!0,{},this.selectionList[0]),childTable:jQuery.extend(!0,{},i),sourcePorts:f,targetPorts:e,changeType:"remove"};this.addHistoryEntry(s)}if(this.selectionList.length>0)if(u=this.selectionList[0],u.isPseudoGroup){for(o=u.children,n=o.length-1;n>=0;n--)this._remove(this.nameTable[o[n]]),this._isUndo=!0;this._isUndo=!1}else this._remove(u);this._clearSelection()}},_remove:function(n){var e,u,o,i,r,f;n&&(e=n.line?"connector":"node",u={changeType:"remove",element:n,cancel:!1},this._raiseEvent(e+"CollectionChange",u),u.cancel||t.datavisualization.Diagram.Util.canDelete(n)&&(o=n.name,n.line?(this._removeEdges(n),n.sourceNode=n.sourcePort=n.targetNode=n.targetPort=null,t.datavisualization.Diagram.Util.removeItem(this.model.connectors,this.nameTable[n.name])):(this._disConnect(n),t.datavisualization.Diagram.Util.removeItem(this.model.nodes,this.nameTable[n.name])),(n.shape||n.line)&&(t.datavisualization.Diagram.SpatialUtil._removeFromaQuad(this._spatialSearch,this._spatialSearch.quadTable[n.name],n),t.datavisualization.Diagram.SpatialUtil._updateBounds(this,this._spatialSearch,n)),n.parent&&(i=this.nameTable[n.parent],i&&i.isGroup&&(t.datavisualization.Diagram.Util.removeItem(i.children,n.name),t.datavisualization.Diagram.Util._updateGroupBounds(i,this.nameTable))),delete this.nameTable[o],r=this._svg.getElementById(n.name),t.browserInfo().name==="msie"&&(n.shape&&n.shape.html&&r?(f=document.getElementById(n.name+"_parentdiv"),f.parentNode.removeChild(f)):n.isGroup&&this._checkForHtmlNode(n)),n.isGroup&&!n.isPseudoGroup&&this._removeChildren(n),r&&r.parentNode.removeChild(r),this.selectionList[0]&&this._clearSelection()))},_disConnect:function(n){var i,r,t,u;if(n.inEdges.length>0)for(i=n.inEdges,t=0,u=i.length;t<u;t++)r=this.nameTable[i[t]],r.targetNode=null,r.targetPort=null;if(n.outEdges.length>0)for(i=n.outEdges,t=0,u=i.length;t<u;t++)r=this.nameTable[i[t]],r.sourceNode=null,r.sourcePort=null},_removeEdges:function(n){n.targetNode&&t.datavisualization.Diagram.Util.removeItem(this.nameTable[n.targetNode].inEdges,n.name);n.sourceNode&&t.datavisualization.Diagram.Util.removeItem(this.nameTable[n.sourceNode].outEdges,n.name)},_selectionContains:function(n){if(this._hasSelection())for(var t=0;t<this.selectionList.length;t++)if(n.name===this.selectionList[t].name)return!0;return!1},_addSelection:function(n){var i,r;n&&t.datavisualization.Diagram.Util.canSelect(n)&&(this._selectionContains(n)||(this.selectionList.push(n),i={changeType:"insert",element:n,cancel:!1},this._raiseEvent("selectionChange",i),i.cancel?t.datavisualization.Diagram.Util.removeItem(this.selectionList,n):(t.datavisualization.Diagram.SvgContext.renderSelector(n,this._svg,this._adornerLayer,this.model.zoomFactor,this.model.selectorConstraints),this.model.userHandles!==null&&this.model.userHandles.length>0&&(r=!1,n.isPseudoGroup&&(r=!0),this.model.selectorConstraints&t.datavisualization.Diagram.SelectorConstraints.UserHandles&&t.datavisualization.Diagram.SvgContext.renderUserHandles(this.model.userHandles,n,this._svg,r,this.model.zoomFactor,this._adornerLayer)))))},_raiseEvent:function(n,t){return this._trigger(n,t),t},_clearSelection:function(){this._isEditing&&this.selectionList.length>0&&this._endEdit();var n={changeType:"remove",element:this.selectionList,cancel:!1};this._raiseEvent("selectionChange",n);n.cancel||(this.selectionList[0]&&this.selectionList[0].isPseudoGroup&&(t.datavisualization.Diagram.Util.removeItem(this.model.nodes,this.selectionList[0]),delete this.nameTable[this.selectionList[0].name]),t.datavisualization.Diagram.Util.clear(this.selectionList),t.datavisualization.Diagram.SvgContext.clearSelector(this._svg,this._adornerLayer))},_updateSelectionHandle:function(n){var i,r;this.selectionList.length>0&&(i=this.nameTable[this.selectionList[0].name],t.datavisualization.Diagram.SvgContext.updateSelector(i,this._svg,this.model.zoomFactor,this,this.model.selectorConstraints),this.model.userHandles!==null&&this.model.userHandles.length>0&&(r=!1,i.isPseudoGroup&&(r=!0),this.model.selectorConstraints&t.datavisualization.Diagram.SelectorConstraints.UserHandles&&t.datavisualization.Diagram.SvgContext.updateUserHandles(this.model.userHandles,i,this._svg,r,n,this.model.zoomFactor)))},_hasSelection:function(){return this.selectionList.length>0},_checkToolToActivate:function(n,t,i){var r=!1;return t&&(this._selectionContains(t)?(t.line?r=this._canActivateEndPointTool(n,t,i):(r=this._canActivateResizeTool(n,t,i),r||(r=this._canActivateRotateTool(n,t,i))),r||(r=this._canActivateUserHandle(n,t,i)),r||(r=this._canActivateMoveTool(n,t,i))):r=this._canActivateMoveTool(n,t,i)),r||(this._toolToActivate="select",this._currentCursor="default"),this._toolToActivate!="rotate"&&this._svg.document.removeAttribute("class"),r},_canActivateUserHandle:function(t){if(this._isUserHandle(t)){var i=n(t.target).parents("g").first().context.id.split("_")[0];return this._toolToActivate=i,this._currentCursor=this.tools[this._toolToActivate].cursor,!0}return!1},_canActivateEndPointTool:function(n,i){if(i){var r=n.target.getAttribute("class");if(r==="targetEndPoint"&&t.datavisualization.Diagram.Util.canDragTargetEnd(i)||r==="sourceEndPoint"&&t.datavisualization.Diagram.Util.canDragSourceEnd(i)||(r==="bezierpoint1"||r==="bezierpoint2")&&t.datavisualization.Diagram.Util.canDragSegmentThumbs(i))return this._toolToActivate="endPoint",this._currentCursor="move",!0}return!1},_canActivateResizeTool:function(n,i){if(t.datavisualization.Diagram.Util.canResize(i)&&this.model.selectorConstraints&t.datavisualization.Diagram.SelectorConstraints.Resizer){var r=n.target.getAttribute("class");if(r==="nw-resize"||r==="n-resize"||r==="ne-resize"||r==="w-resize"||r==="e-resize"||r==="sw-resize"||r==="s-resize"||r==="se-resize")return this._toolToActivate="resize",this._currentCursor=r,!0}return!1},_canActivateMoveTool:function(n,i){var r=this._findNodeUnderMouse(n);return r&&r.name===i.name&&t.datavisualization.Diagram.Util.canMove(i)?(this._toolToActivate="move",this._currentCursor=this.selectionList.length>0&&(this._selectionContains(i)||this.selectionList[0].children&&this._findChildren(this.selectionList[0],i.name))?"move":"default",!0):!1},_canActivateRotateTool:function(n,i){if(t.datavisualization.Diagram.Util.canRotate(i)&&this.model.selectorConstraints&t.datavisualization.Diagram.SelectorConstraints.Rotator){var r=n.target.getAttribute("class");if(r==="rotate")return this._toolToActivate="rotate",this._svg.document.setAttribute("class","svg-rotate"),this._currentCursor="",!0}return!1},_canActivatePivotTool:function(n){var t=n.target.getAttribute("class");return t==="pivot"?(this._toolToActivate="pivot",this._currentCursor="default",!0):!1},_updateCursor:function(){this._svg.document.style.cursor=this._currentCursor},_getResizeCursor:function(n){var t="default";switch(n){case"topleft":t="nw-resize";break;case"topcenter":t="n-resize";break;case"topright":t="ne-resize";break;case"middleleft":t="w-resize";break;case"middleright":t="e-resize";break;case"bottomleft":t="sw-resize";break;case"bottomcenter":t="s-resize";break;case"bottomright":t="se-resize"}return t},_startEdit:function(n){var r,o,s,f,e,i,u,h,c;n.shape&&n.shape.type==="text"?(f=this._svg.getElementById(n.name+"_shape")!==null?this._svg.getElementById(n.name+"_shape").getBBox():{x:n.offsetX-n.width/2,y:n.offsetY-n.height/2,width:n.width,height:n.height},r=n.shape.textBlock,r&&(e=t.datavisualization.Diagram.Util.bounds(n),i=new t.datavisualization.Diagram.Rectangle(f.x-r.fontSize,f.y-r.fontSize,f.width+r.fontSize/2,f.height+r.fontSize/2),u=this.model.zoomFactor,o=n.offsetX,s=n.offsetY,f.width===0||f.height===0?(f=t.datavisualization.Diagram.Util.bounds(n),i.width=f.width==0?50:e.width*u,i.x=o*u-i.width/2*u-this._hScrollOffset,i.height=r.fontSize,i.y=s*u-i.height/2*u-this._vScrollOffset):(i.width=50,i.height=r.fontSize,i.x=o*u-i.width/2*u-this._hScrollOffset,i.y=s*u-i.height/2*u-this._vScrollOffset),this._boundingBox=i,this._createEditBox(r,i.x,i.y,i.width,i.height,n),this._isEditing=!0)):(n.labels.length>0?this.activeTool.name==="textTool"?(r=this.activeTool.getLabelUnderMouse(),r&&(r=n.labels[0])):r=n.labels[0]:(h=this._findNode(n.name),r=new t.datavisualization.Diagram.Label({name:"label"+t.datavisualization.Diagram.Util.randomId()}),n.labels.push(r),c=h!==n?h:null,t.datavisualization.Diagram.SvgContext.addNodeLabel(n,r,this._svg,c),this.activeTool.name==="textTool"&&(this.activateTool.activeLabel=r)),r&&!r.readOnly&&(f=this._svg.getElementById(n.name+"_"+r.name).getBBox(),e=t.datavisualization.Diagram.Util.bounds(n),i=new t.datavisualization.Diagram.Rectangle(f.x,f.y,f.width,f.height),u=this.model.zoomFactor,n.line?(o=e.x+e.width/2,s=e.y+e.height/2):(o=n.offsetX,s=n.offsetY),f.width===0||f.height===0?(f=t.datavisualization.Diagram.Util.bounds(n),n.shape?(i.width=f.width<50?50:e.width*u,i.x=o*u-i.width/2-this._hScrollOffset):(i.width=f.width<50?50:e.width*u,i.x=o*u-i.width/2*u-this._hScrollOffset),i.height=r.fontSize,i.y=s*u-i.height/2*u-this._vScrollOffset):(i.x=o*u-i.width/2*u-this._hScrollOffset,i.y=s*u-i.height/2*u-this._vScrollOffset),this._boundingBox=i,this._createEditBox(r,i.x,i.y,i.width,i.height,n),this._isEditing=!0))},_createEditBox:function(i,r,u,f,e,o){var c=t.datavisualization.Diagram.Util.bounds(o),h=document.createElement("div"),l={id:this.element[0].id+"_editBoxDiv","class":"edit",style:"top:"+u+"px;left:"+r+"px;width:"+f+"px;height:"+e+"px;font-family:"+i.fontFamily+";font-size:"+i.fontSize+"px;min-width: 50px;min-height:"+i.fontSize+"px;"},s;t.datavisualization.Diagram.Util.attr(h,l);s=document.createElement("textarea");l={id:this.element[0].id+"_editBox","class":"editBox",style:"font-size:"+i.fontSize+"px;font-family:"+i.fontFamily+";min-height:"+i.fontSize+"px;line-height:"+i.fontSize+"px;",nodeWidth:c.width,nodeHeight:c.height,fontSize:i.fontSize,nodeOffsetX:o.offsetX,nodeOffsetY:o.offsetY,containerName:o.name};t.datavisualization.Diagram.Util.attr(s,l);s.value=i.text;h.appendChild(s);n(this._canvas).append(h);i.text!==""&&this._updateEditor(null,h,s,c.width,i.fontSize);this._on(n(s),"focusout",this._editboxfocusout);this._on(n(s),"keyup",this._editBoxKeyUp);this._on(n(s),"input",this._editBoxTextChange);s.focus();s.select()},_editBoxKeyUp:function(n){this._updateLabelPosition(n)},_editBoxTextChange:function(n){this._updateLabelPosition(n)},_updateEditBox:function(n,t){var i=document.getElementById(this.element[0].id+"_editBoxDiv");i&&(i.style.left=i.offsetLeft-n+"px",i.style.top=i.offsetTop-t+"px")},_editboxfocusout:function(){this._endEdit()},_updateLabelPosition:function(n){var t=50,o=this.model.zoomFactor,i=this._boundingBox,e=Number(n.target.getAttribute("fontSize")),f=Number(n.target.getAttribute("nodeWidth")),s=i.x+i.width/2,h=i.y+i.height/2,u=this._textLength(n),r;u.width===0?(r=i.width<t?t:i.width,n.target.parentNode.style.width=r+"px",n.target.parentNode.style.left=s-r/2+"px"):(r=u.width<=f*o?u.width<t?t:u.width:f<t?t:f*o,n.target.parentNode.style.width=r+"px",n.target.parentNode.style.left=s-r/2+"px");u.height===0?(n.target.style.height=e+"px",n.target.parentNode.style.top=h-e/2+"px"):this._updateEditor(n,n.target.parentNode,n.target,f,e)},_updateEditor:function(n,i,r,u,f){var h,c,e,l=this._textLength(n),o=this.model.zoomFactor,a=50,v=this._boundingBox.x,y=this._boundingBox.y,p=this._boundingBox.width,w=this._boundingBox.height,k=r.value,d=k.split("\n"),b=u*o<l.width?u*o:l.width,s=b<a?a:b;i.style.width=s+"px";h=n?(s-p)/2:(s-p*o)/2;i.style.left=v-h+"px";d.length>1||l.width>=u?(e=t.browserInfo().name==="mozilla"?r.scrollHeight:r.scrollHeight-4,r.style.height="auto"):e=f;r.style.height=e+"px";c=n?(e-w)/2:(e-w*o)/2;this._boundingBox=new t.datavisualization.Diagram.Rectangle(v-h,y-c,s,e);i.style.top=y-c+"px"},_textLength:function(n){var i=document.createElement("div"),r=document.getElementById(this.element[0].id+"_editBox"),f={id:this.element[0].id+"_editBoxHiddenDiv",style:"position:absolute; width:"+r.width+"px;height:"+r.height+"px;font-size:"+r.style.fontSize+"px;font-family:"+r.style.fontFamily+";padding: 4px;word-wrap: break-word;white-space:pre-wrap;"},u;return t.datavisualization.Diagram.Util.attr(i,f),i.innerHTML=n?n.target.value:r.value,document.body.appendChild(i),u=i.getBoundingClientRect(),document.body.removeChild(i),u},_endEdit:function(){var l,o,u=document.getElementById(this.element[0].id+"_editBox"),r,e,s,a,h,f,c;if(u){if(r=this._findNode(u.getAttribute("containerName")),this.activeTool.name==="textTool")r=this.activeTool.selectedObject;else if(!r)for(e=0;e<this.selectionList.length;e++)s=this.selectionList[e],typeof s.labels.length!="undefined"&&s.labels.length>0&&s.labels[0].mode===t.datavisualization.Diagram.LabelEditMode.Edit&&(r=this.selectionList[e]);r&&(this._isEditing=!1,l=this._trigger("textChange",{element:r,value:u.value}),l||(r&&r.shape!==i&&r.shape.type==="text"?(a=r.shape.textBlock.text,r.shape.textBlock.text=u.value,r.shape.textBlock.mode=t.datavisualization.Diagram.LabelEditMode.View,this._findNode(r.name)?(t.datavisualization.Diagram.SvgContext.update(r,this),o={type:"labelchanged",shape:r,previousLabelValue:a,updatedLabelValue:u.value},this.addHistoryEntry(o)):(u.value!==""&&(h=Number(u.style.height.substring(0,u.style.height.length-2)),r.height<h&&(r.offsetY=r.offsetY-r.height/2+h/2,r.height=h),this.selectionList.length>0&&this._clearSelection(),this.add(r)),this.activeTool.selectedObject=null)):r==i||r.isPseudoGroup||(f=this.activeTool.name==="textTool"?this.activeTool.getLabelUnderMouse():r.labels[0],f!=i?(f.text!=u.value&&(o={type:"labelchanged",shape:r,previousLabelValue:f.text,updatedLabelValue:u.value},this.addHistoryEntry(o)),f.text=u.value,f.mode=t.datavisualization.Diagram.LabelEditMode.View,t.datavisualization.Diagram.SvgContext.updateLabel(r,f,this._svg)):r.labels.length==0&&(f=t.datavisualization.Diagram.Label(),f.text=u.value,f.mode=t.datavisualization.Diagram.LabelEditMode.View,r.labels.push(f),t.datavisualization.Diagram.SvgContext.addNodeLabel(r,f,this._svg,null)))));this._off(n(u),"focusout",this._editboxfocusout);this._off(n(u),"keyup",this._editBoxKeyUp);this._off(n(u),"input",this._editBoxTextChange);c=n("#"+this.element[0].id+"_editBoxDiv")[0];c&&c.parentNode.removeChild(c)}},_setLabelEditing:function(n){var i;return n.readOnly?(n.mode=t.datavisualization.Diagram.LabelEditMode.View,i=!1):(this._currentLabel&&(this._currentLabel.mode=t.datavisualization.Diagram.LabelEditMode.View),n.mode=t.datavisualization.Diagram.LabelEditMode.Edit,this._currentLabel=n,i=!0),i},_isInternalTool:function(n){return n instanceof t.datavisualization.Diagram.SelectTool||n instanceof t.datavisualization.Diagram.EndPointTool||n instanceof t.datavisualization.Diagram.MoveTool||n instanceof t.datavisualization.Diagram.ResizeTool||n instanceof t.datavisualization.Diagram.RotateTool||n instanceof t.datavisualization.Diagram.PivotTool?!0:!1},_translate:function(n,i,r,u){var o,f,e;if(t.datavisualization.Diagram.Util.canMove(n)){if(n.line)t.datavisualization.Diagram.Util._translateLine(n.line,i,r,n),this._dock(n,u);else{if(n.offsetX+=i,n.offsetY+=r,n.isGroup){for(o=n.children,e=0;e<o.length;e++)f=u[o[e]],this._translate(f,i,r,u),f.parent&&f.parent!=n.name&&!n.isPseudoGroup&&t.datavisualization.Diagram.Util._updateGroupBounds(u[f.parent],u);t.datavisualization.Diagram.Util._updateGroupBounds(n,u)}this._updateAssociatedConnectorEnds(n,u)}this._updateQuad(n)}},_rotate:function(n,i,r){var f,u,o,s,h,e,c;if(t.datavisualization.Diagram.Util.canRotate(n)&&!n.line){if(n.rotateAngle+=i,n.rotateAngle%=360,n.rotateAngle<0&&(n.rotateAngle+=360),n.isGroup){for(f=t.Matrix.identity(),t.Matrix.rotate(f,i,n.offsetX,n.offsetY),h=n.children,e=0;e<h.length;e++)u=r[h[e]],u.line?(u.sourceNode||this._setEndPoint(u,t.Matrix.transform(f,u.line.startPoint),!1),u.targetNode||this._setEndPoint(u,t.Matrix.transform(f,u.line.endPoint),!0)):(this._rotate(u,i,r),o=u.offsetX,s=u.offsetY,c=t.Matrix.transform(f,t.datavisualization.Diagram.Point(o,s)),this._translate(u,c.x-o,c.y-s,r),this._updateAssociatedConnectorEnds(u,r)),u.parent&&u.parent!=n.name&&!n.isPseudoGroup&&t.datavisualization.Diagram.Util._updateGroupBounds(r[u.parent],r);t.datavisualization.Diagram.Util._updateGroupBounds(n,r)}this._updateQuad(n);this._updateAssociatedConnectorEnds(n,r)}},_scale:function(n,i,r,u,f){var e=t.Matrix.identity(),h,o,s;if(n.line)t.Matrix.scale(e,i,r,u.x,u.y),n.sourceNode||t.datavisualization.Diagram.Util._setLineEndPoint(n,t.Matrix.transform(e,n.line.startPoint),!1),n.targetNode||t.datavisualization.Diagram.Util._setLineEndPoint(n,t.Matrix.transform(e,n.line.endPoint),!0),(n.sourceNode||n.targetNode)&&this._dock(n,f);else{if(n.isGroup){for(h=n.children,s=0;s<h.length;s++)o=f[h[s]],o&&(this._scale(o,i,r,u,f),o.parent&&o.parent!=n.name&&!n.isPseudoGroup&&t.datavisualization.Diagram.Util._updateGroupBounds(f[o.parent],f));t.datavisualization.Diagram.Util._updateGroupBounds(n,f)}else{t.Matrix.rotate(e,-n.rotateAngle,u.x,u.y);t.Matrix.scale(e,i,r,u.x,u.y);t.Matrix.rotate(e,n.rotateAngle,u.x,u.y);var c=t.Matrix.transform(e,t.datavisualization.Diagram.Point(n.offsetX,n.offsetY)),l=n.width*i,a=n.height*r;l>1&&(n.width=l,n.offsetX=c.x);a>1&&(n.height=a,n.offsetY=c.y)}this._updateAssociatedConnectorEnds(n,f)}this._updateQuad(n)},_dock:function(n,i){t.datavisualization.Diagram.Util.dock(n,i);this._updateQuad(n)},_setEndPoint:function(n,i,r){t.datavisualization.Diagram.Util._setLineEndPoint(n,i,r);this._updateQuad(n)},_updateAssociatedConnectorEnds:function(n,t){for(var r,i=0,u=n.inEdges.length;i<u;i++)r=t[n.inEdges[i]],r&&this._dock(r,t);for(i=0,u=n.outEdges.length;i<u;i++)r=t[n.outEdges[i]],r&&this._dock(r,t)},_updateChildBounds:function(n,i){var u,f,r,e,o,s,h;n.width==0&&n.height==0?(u=n.offsetX,f=n.offsetY,t.datavisualization.Diagram.Util._updateGroupBounds(n,i),this._translate(n,u-n.offsetX,f-n.offsetY,i)):(u=n.offsetX,f=n.offsetY,r=t.datavisualization.Diagram.Util._getChildrenBounds(n,i),n.offsetX=r.x+r.width/2,n.offsetY=r.y+r.height/2,e=u-n.offsetX,o=u-n.offsetY,this._translate(n,e,o,i),s=n.width/r.width,h=n.height/r.height,this._scale(n,s,h,n.pivot,i),this._translate(n,u-n.offsetX,f-n.offsetY,i))},_updateQuad:function(n){this._spatialSearch&&this._spatialSearch.quadTable[n.name]&&(n.line||n.shape)&&t.datavisualization.Diagram.SpatialUtil._updateQuad(this,this._spatialSearch,n)}})})(jQuery,Syncfusion),function(n,t){"use strict";t.MatrixTypes={Identity:0,Translation:1,Scaling:2,Unknown:4};t.MatrixDefaults={m11:1,m12:0,m21:0,m22:1,offsetX:0,offsetY:0,type:t.MatrixTypes.Identity};t.Matrix={identity:function(){return n.extend(!0,{},t.MatrixDefaults)},multiply:function(n,i){var u=n.type,f=i.type,e,r,o,s;if(f!=t.MatrixTypes.Identity){if(u==t.MatrixTypes.Identity){n.m11=i.m11;n.m12=i.m12;n.m21=i.m21;n.m22=i.m22;n.offsetX=i.offsetX;n.offsetY=i.offsetY;n.type=i.type;return}if(f==t.MatrixTypes.Translation){n.offsetX+=i.offsetX;n.offsetY+=i.offsetY;u!=t.MatrixTypes.Unknown&&(n.type|=t.MatrixTypes.Translation);return}if(u!=t.MatrixTypes.Translation){e=u<<4|f;switch(e){case 34:n.m11*=i.m11;n.m22*=i.m22;return;case 35:n.m11*=i.m11;n.m22*=i.m22;n.offsetX=i.offsetX;n.offsetY=i.offsetY;n.type=t.MatrixTypes.Translation|t.MatrixTypes.Scaling;return;case 36:break;default:switch(e){case 50:n.m11*=i.m11;n.m22*=i.m22;n.offsetX*=i.m11;n.offsetY*=i.m22;return;case 51:n.m11*=i.m11;n.m22*=i.m22;n.offsetX=i.m11*n.offsetX+i.offsetX;n.offsetY=i.m22*n.offsetY+i.offsetY;return;case 52:break;default:switch(e){case 66:case 67:case 68:break;default:return}}}r=this.identity();this._setMatrix(r,n.m11*i.m11+n.m12*i.m21,n.m11*i.m12+n.m12*i.m22,n.m21*i.m11+n.m22*i.m21,n.m21*i.m12+n.m22*i.m22,n.offsetX*i.m11+n.offsetY*i.m21+i.offsetX,n.offsetX*i.m12+n.offsetY*i.m22+i.offsetY);r.m21||r.m12?r.type=t.MatrixTypes.Unknown:((r.m11&&r.m11!=1||r.m22&&r.m22!=1)&&(r.type=t.MatrixTypes.Scaling),(r.offsetX||r.offsetY)&&(r.type|=t.MatrixTypes.Translation),(r.type&(t.MatrixTypes.Translation|t.MatrixTypes.Scaling))==t.MatrixTypes.Identity&&(r.type=t.MatrixTypes.Identity));n.m11=r.m11;n.m12=r.m12;n.m21=r.m21;n.m22=r.m22;n.offsetX=r.offsetX;n.offsetY=r.offsetY;n.type=r.type;return}if(o=n.offsetX,s=n.offsetY,n.m11=i.m11,n.m12=i.m12,n.m21=i.m21,n.m22=i.m22,n.offsetX=i.offsetX,n.offsetY=i.offsetY,n.type=i.type,n.offsetX=o*i.m11+s*i.m21+i.offsetX,n.offsetY=o*i.m12+s*i.m22+i.offsetY,f==t.MatrixTypes.Unknown){n.type=t.MatrixTypes.Unknown;return}n.type=t.MatrixTypes.Translation|t.MatrixTypes.Scaling}},transform:function(n,t){return this._multiplyPoint(n,t.x,t.y)},rotate:function(n,t,i,r){t%=360;this.multiply(n,this._createRotationRadians(t*.017453292519943295,i?i:0,r?r:0))},scale:function(n,t,i,r,u){this.multiply(n,this._createScaling(t,i,r?r:0,u?u:0))},translate:function(n,i,r){if(n.type&t.MatrixTypes.Identity){this._setMatrix(n,1,0,0,1,i,r,t.MatrixTypes.Translation);return}if(n.type&t.MatrixTypes.Unknown){n.offsetX+=i;n.offsetY+=r;return}n.offsetX+=i;n.offsetY+=r;n.type|=t.MatrixTypes.Translation},_createScaling:function(n,i,r,u){var f=this.identity();return this._setMatrix(f,n,0,0,i,r-n*r,u-i*u,(r||u)?t.MatrixTypes.Scaling|t.MatrixTypes.Translation:t.MatrixTypes.Scaling),f},_createRotationRadians:function(n,i,r){var e=this.identity(),u=Math.sin(n),f=Math.cos(n),o=i*(1-f)+r*u,s=r*(1-f)-i*u;return this._setMatrix(e,f,u,-u,f,o,s,t.MatrixTypes.Unknown),e},_multiplyPoint:function(n,i,r){switch(n.type){case t.MatrixTypes.Identity:break;case t.MatrixTypes.Translation:i+=n.offsetX;r+=n.offsetY;break;case t.MatrixTypes.Scaling:i*=n.m11;r*=n.m22;break;case t.MatrixTypes.Translation|t.MatrixTypes.Scaling:i*=n.m11;i+=n.offsetX;r*=n.m22;r+=n.offsetY;break;default:var u=r*n.m21+n.offsetX,f=i*n.m12+n.offsetY;i*=n.m11;i+=u;r*=n.m22;r+=f}return{x:i,y:r}},_setMatrix:function(n,i,r,u,f,e,o,s){n.m11=i;n.m12=r;n.m21=u;n.m22=f;n.offsetX=e;n.offsetY=o;n.type=s||t.MatrixTypes.Identity}}}(jQuery,Syncfusion),function(n,t){"use strict";t.datavisualization.Diagram.HitTesting={_getResizeHandleCenter:function(n,i,r){var f,u;r||(r=1);f=this.bounds(n);u=t.datavisualization.Diagram.Point(0,0);switch(i){case"topleft":u=f.topLeft;break;case"topcenter":u=f.top;break;case"topright":u=f.topRight;break;case"middleleft":u=f.left;break;case"middleright":u=f.right;break;case"bottomleft":u=f.bottomLeft;break;case"bottomcenter":u=f.bottom;break;case"bottomright":u=f.bottomRight;break;case"pivot":u=t.datavisualization.Diagram.Point(n.offsetX,n.offsetY);break;case"rotate":var o=20/r,s=t.datavisualization.Diagram.Point(n.offsetX,n.offsetY-n.height*n.pivot.y-10-o),e=t.Matrix.identity();t.Matrix.rotate(e,n.rotateAngle,n.offsetX,n.offsetY);u=t.Matrix.transform(e,s)}return u},findResizeHandleAtPoint:function(n,i){var e=null,u,o,f,r,s;if(n)for(f=["topleft","topcenter","topright","middleleft","middleright","bottomleft","bottomcenter","bottomright"],r=0,s=f.length;r<s;r++)if(u=this._getResizeHandleCenter(n,f[r]),u!==t.datavisualization.Diagram.Point(0,0)&&(o=t.datavisualization.Diagram.Geometry.checkPointOnCircle(i,t.datavisualization.Diagram.Point(u.x,u.y),7),o)){e=f[r];break}return e},findRotationHandleAtPoint:function(n,i,r){var u=this.xxx_getResizeHandleCenter(n,"rotate",r),f=t.datavisualization.Diagram.Geometry.checkPointOnCircle(i,t.datavisualization.Diagram.Point(u.x,u.y),10);return f?!0:!1},findPivotHandleAtPoint:function(n,i){var r=this._getResizeHandleCenter(n,"pivot"),u=t.datavisualization.Diagram.Geometry.checkPointOnCircle(i,t.datavisualization.Diagram.Point(r.x,r.y),7);return u?!0:!1},findEndPointHandleAtPoint:function(n,i){var f=null,r,e,u,o;return n&&(e=n.line.points,u=e[e.length-1],r=t.datavisualization.Diagram.Geometry.checkPointOnCircle(i,t.datavisualization.Diagram.Point(u.x,u.y),7),r&&(f="targetEndPoint"),r||(u=e[0],r=t.datavisualization.Diagram.Geometry.checkPointOnCircle(i,t.datavisualization.Diagram.Point(u.x,u.y),7),r&&(f="sourceEndPoint")),r||n.line.type!=="bezier"||(u=n.line._point1,r=t.datavisualization.Diagram.Geometry.checkPointOnCircle(i,t.datavisualization.Diagram.Point(u.x,u.y),7),r&&(f="bezierpoint1"),r||(o=n.line._point2,r=t.datavisualization.Diagram.Geometry.checkPointOnCircle(i,t.datavisualization.Diagram.Point(o.x,o.y),7),r&&(f="bezierpoint2")))),f}};t.datavisualization.Diagram.Util={findPortByName:function(n,t){var r,i,u;if(n.ports)for(i=0,u=n.ports.length;i<u;i++)if(r=n.ports[i],r.name===t)return r;return null},attr:function(n,t){for(var i in t)n.setAttribute(i.toString(),t[i])},removeItem:function(n,t){var i=n.indexOf(t);i>=0&&n.splice(i,1)},clear:function(n){while(n.length>0)n.pop()},randomId:function(){for(var n,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",i="",r=0;r<4;r++)n=Math.floor(Math.random()*t.length),i+=t.substring(n,n+1);return i},htmlEncode:function(n){return n.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'")},canMove:function(n){return n.line?n.constraints&t.datavisualization.Diagram.ConnectorConstraints.Drag:n.constraints&t.datavisualization.Diagram.NodeConstraints.Drag},canRotate:function(n){return n.line?n.constraints&t.datavisualization.Diagram.ConnectorConstraints.Rotate:n.constraints&t.datavisualization.Diagram.NodeConstraints.Rotate},canSelect:function(n){return n.line?n.constraints&t.datavisualization.Diagram.ConnectorConstraints.Select:n.constraints&t.datavisualization.Diagram.NodeConstraints.Select},canDelete:function(n){return n.line?n.constraints&t.datavisualization.Diagram.ConnectorConstraints.Delete:n.constraints&t.datavisualization.Diagram.NodeConstraints.Delete},canDragSourceEnd:function(n){return n.constraints&t.datavisualization.Diagram.ConnectorConstraints.DragSourceEnd},canDragTargetEnd:function(n){return n.constraints&t.datavisualization.Diagram.ConnectorConstraints.DragTargetEnd},canDragSegmentThumbs:function(n){return n.constraints&t.datavisualization.Diagram.ConnectorConstraints.DragSegmentThumb},isTargetConnected:function(n){return n.targetNode?!0:!1},isSourceConnected:function(n){return n.sourceNode?!0:!1},bounds:function(n,i){var u,r,f,e;return(u=n.line?t.datavisualization.Diagram.Geometry.rect(n.line.points):n.shape||n.isGroup?t.datavisualization.Diagram.Rectangle(n.offsetX-n.width*n.pivot.x,n.offsetY-n.height*n.pivot.y,n.width,n.height):n,u)?(r={},r.width=u.width,r.height=u.height,r.x=r.left=u.x,r.right=u.x+u.width,r.y=r.top=u.y,r.bottom=u.y+u.height,r.center=t.datavisualization.Diagram.Point(u.x+u.width/2,u.y+u.height/2),r.topLeft=t.datavisualization.Diagram.Point(u.x,u.y),r.topCenter=t.datavisualization.Diagram.Point(u.x+u.width/2,u.y),r.topRight=t.datavisualization.Diagram.Point(u.x+u.width,u.y),r.middleLeft=t.datavisualization.Diagram.Point(u.x,u.y+u.height/2),r.middleRight=t.datavisualization.Diagram.Point(u.x+u.width,u.y+u.height/2),r.bottomLeft=t.datavisualization.Diagram.Point(u.x,u.y+u.height),r.bottomCenter=t.datavisualization.Diagram.Point(u.x+u.width/2,u.y+u.height),r.bottomRight=t.datavisualization.Diagram.Point(u.x+u.width,u.y+u.height),n.rotateAngle&&n.rotateAngle!==0&&!i&&(f=t.Matrix.identity(),t.Matrix.rotate(f,n.rotateAngle,n.offsetX,n.offsetY),r.topLeft=t.Matrix.transform(f,r.topLeft),r.topCenter=t.Matrix.transform(f,r.topCenter),r.topRight=t.Matrix.transform(f,r.topRight),r.middleLeft=t.Matrix.transform(f,r.middleLeft),r.middleRight=t.Matrix.transform(f,r.middleRight),r.bottomLeft=t.Matrix.transform(f,r.bottomLeft),r.bottomCenter=t.Matrix.transform(f,r.bottomCenter),r.bottomRight=t.Matrix.transform(f,r.bottomRight),e=t.datavisualization.Diagram.Geometry.rect([r.topLeft,r.topRight,r.bottomRight,r.bottomLeft]),r.x=e.x,r.y=e.y,r.center=t.datavisualization.Diagram.Point(e.x+e.width/2,e.y+e.height/2)),r.points=[r.topLeft,r.topRight,r.bottomRight,r.bottomLeft],r):u},canResize:function(n){return n.constraints&t.datavisualization.Diagram.NodeConstraints.Resize},canConnect:function(n,i){var r=null;return i?r=n.constraints&t.datavisualization.Diagram.PortConstraints.Connect:n.line||(r=n.constraints&t.datavisualization.Diagram.NodeConstraints.Connect),r},dock:function(n,t){var i,e=null,r,o=null,u,f;i=t[n.targetNode];i&&(e=this.findPortByName(i,n.targetPort));r=t[n.sourceNode];r&&(o=this.findPortByName(r,n.sourcePort));u=this.isSourceConnected(n);f=this.isTargetConnected(n);f&&u&&e&&o?this._dockPortToPort(n,i,e,r,o):f&&e?u?n.line.type!=="orthogonal"?(this._dockPortToNode(n,i,e,r,o,!1),this._dockNode(n,r,null,f,u)):(this._dockNode(n,r,null,f,u),this._dockPortToNode(n,i,e,r,o,!1)):this._dockPortToPoint(n,i,e,!0):u&&o?f?n.line.type!=="orthogonal"?(this._dockPortToNode(n,r,o,i,e,!0),this._dockNode(n,i,null,f,u)):(this._dockNode(n,i,null,f,u),this._dockPortToNode(n,r,o,i,e,!0)):this._dockPortToPoint(n,r,o,!1):f&&u?this._dockNode(n,i,r,f,u):f?this._dockNode(n,i,null,f,u):u&&this._dockNode(n,r,null,f,u)},_dockPortToPort:function(n,i,r,u,f){var o,s,h,e;if(i&&(s=this.bounds(i,!0)),u&&(h=this.bounds(u,!0)),n.line.type!=="orthogonal")r&&(o=this._getPortPosition(r,s),e=t.Matrix.identity(),t.Matrix.rotate(e,i.rotateAngle,i.offsetX,i.offsetY),o=t.Matrix.transform(e,o),this._setLineEndPoint(n,o,!0)),f&&(o=this._getPortPosition(f,h),e=t.Matrix.identity(),t.Matrix.rotate(e,u.rotateAngle,u.offsetX,u.offsetY),o=t.Matrix.transform(e,o),this._setLineEndPoint(n,o,!1)),n.line.type==="bezier"&&this._updateBezierPoints(n.line,i,r,s,u,f,h);else{var c=this._getPortPosition(r,s),l=this._getPortPosition(f,h),a=this._swapDirection(i.rotateAngle,this._getDirection(s,c)),v=this._swapDirection(u.rotateAngle,this._getDirection(h,l));e=t.Matrix.identity();t.Matrix.rotate(e,u.rotateAngle,u.offsetX,u.offsetY);l=t.Matrix.transform(e,l);e=t.Matrix.identity();t.Matrix.rotate(e,i.rotateAngle,i.offsetX,i.offsetY);c=t.Matrix.transform(e,c);s=this.bounds(i);h=this.bounds(u);this._constructSegements(n,s,c,a,h,l,v)}},_dockPortToNode:function(n,i,r,u,f,e){var o,c,s,l,h,y,a,v;i&&(o=this.bounds(i,!0));u&&(c=this.bounds(u,!0));n.line.type!=="orthogonal"?(l=this._getPortPosition(r,o),s=t.Matrix.identity(),t.Matrix.rotate(s,i.rotateAngle,i.offsetX,i.offsetY),l=t.Matrix.transform(s,l),this._setLineEndPoint(n,l,e)):(h=this._getPortPosition(r,o),y=this._swapDirection(i.rotateAngle,this._getDirection(o,h)),s=t.Matrix.identity(),t.Matrix.rotate(s,i.rotateAngle,i.offsetX,i.offsetY),h=t.Matrix.transform(s,h),a=e?n.line.endPoint:n.line.startPoint,v=this._swapDirection(u.rotateAngle,this._getDirection(c,a)),v&&(o=this.bounds(i),c=this.bounds(u),e?this._constructSegements(n,c,a,v,o,h,y):this._constructSegements(n,o,h,y,c,a,v)))},_constructSegements:function(n,t,i,r,u,f,e){var o,s,h,c;this._setLineEndPoint(n,i,!0);this._setLineEndPoint(n,f,!1);e==="right"&&(r==="left"?o=this._rightToLeft(t,i,u,f):r==="right"?o=this._rightToRight(t,i,u,f):r==="top"?o=this._rightToTop(t,i,u,f):r==="bottom"&&(o=this._rightToBottom(t,i,u,f)));e==="left"&&(r==="right"&&(o=this._rightToLeft(u,f,t,i),s=!0),r==="left"&&(o=this._leftToLeft(t,i,u,f)),r==="top"&&(o=this._leftToTop(t,i,u,f)),r==="bottom"&&(o=this._leftToBottom(t,i,u,f)));e==="top"&&(r==="left"&&(o=this._leftToTop(u,f,t,i),s=!0),r==="right"&&(o=this._rightToTop(u,f,t,i),s=!0),r==="top"&&(o=this._topToTop(t,i,u,f)),r==="bottom"&&(o=this._topToBottom(t,i,u,f)));e==="bottom"&&(r==="left"&&(o=this._leftToBottom(u,f,t,i),s=!0),r==="right"&&(o=this._rightToBottom(u,f,t,i),s=!0),r==="top"&&(o=this._topToBottom(u,f,t,i),s=!0),r==="bottom"&&(o=this._bottomToBottom(t,i,u,f)));s&&o.reverse();h=o[o.length-1];c=o[o.length-2];h.x==c.x&&h.y==c.y&&o.splice(o.length-1,1);h=o[0];c=o[1];h.x==c.x&&h.y==c.y&&o.splice(0,1);this._setPoints(n.line,o)},_dockPortToPoint:function(n,i,r,u){var o,s,h;if(n.line.type!=="orthogonal")this._dockPortToNode(n,i,r,null,null,u);else{var f=this.bounds(i,!0),e=this._getPortPosition(r,f),c=this._swapDirection(i.rotateAngle,this._getDirection(f,e)),l=t.Matrix.identity();t.Matrix.rotate(l,i.rotateAngle,i.offsetX,i.offsetY);e=t.Matrix.transform(l,e);o=u?n.line.startPoint:n.line.endPoint;s=this.bounds(t.datavisualization.Diagram.Rectangle(o.x,o.y,0,0));f=this.bounds(i);h="top";u?this._constructSegements(n,f,e,c,s,o,h):this._constructSegements(n,s,o,h,f,e,c)}},_dockNode:function(n,t,i,r,u){r&&u&&!n.targetPort&&!n.sourcePort?(this._dock(n,t,i,!0),this._dock(n,i,t,!1)):r&&!n.targetPort?this._dock(n,t,i,!0):u&&!n.sourcePort&&this._dock(n,t,i,!1)},_dock:function(n,i,r,u){var h,l,o,f=n.line,a,v,c,e,s,y;f.type!=="orthogonal"?i&&(h=this.bounds(i),r&&(l=this.bounds(r),this._setLineEndPoint(n,l.center,!u),this._setLineEndPoint(n,h.center,u),this._dockBounds(n,l,!u)),this._setLineEndPoint(n,h.center,u),this._dockBounds(n,h,u)):(this._updateOrthogonalPoints(f),i&&(h=this.bounds(i),r&&(l=this.bounds(r),this._setLineEndPoint(n,l.center,!u),this._setLineEndPoint(n,h.center,u),c=this._getDockSegment(n,r.rotateAngle,l),c&&(this._setLineEndPoint(n,c.dockPoint,!u),s=c.direction)),this._setLineEndPoint(n,h.center,u),c=this._getDockSegment(n,i.rotateAngle,h),c&&(this._setLineEndPoint(n,c.dockPoint,u),e=c.direction)),!u&&s&&(y=e,e=s,s=y),e&&s?(e==="left"||e==="right")&&(s==="right"||s==="left")?this._updateOrthogonalPoints(f,!0):(e==="top"||e==="bottom")&&(s==="bottom"||s==="top")?this._updateOrthogonalPoints(f,!1):(o=[],o.push(f.startPoint),(e==="top"||e==="bottom")&&(s==="right"||s==="left")?o.push(t.datavisualization.Diagram.Point(f.endPoint.x,f.startPoint.y)):o.push(t.datavisualization.Diagram.Point(f.startPoint.x,f.endPoint.y)),o.push(f.endPoint),this._setPoints(f,o)):e&&(o=[],o.push(f.startPoint),u?e==="left"||e==="right"?(a=f.startPoint.x,v=f.endPoint.y):(a=f.endPoint.x,v=f.startPoint.y):e==="left"||e==="right"?(a=f.endPoint.x,v=f.startPoint.y):(a=f.startPoint.x,v=f.endPoint.y),o.push(t.datavisualization.Diagram.Point(a,v)),o.push(f.endPoint),this._setPoints(f,o)))},_getDockSegment:function(n,i,r){var f="",e,o,s=n.line,u=this._getEdges(i,r);return(o=t.datavisualization.Diagram.Segment(s.startPoint,s.endPoint),t.datavisualization.Diagram.Geometry.intersectSegment(o,u.left)?(e=u.left,f="left"):t.datavisualization.Diagram.Geometry.intersectSegment(o,u.top)?(e=u.top,f="top"):t.datavisualization.Diagram.Geometry.intersectSegment(o,u.right)?(e=u.right,f="right"):t.datavisualization.Diagram.Geometry.intersectSegment(o,u.bottom)&&(e=u.bottom,f="bottom"),f=this._swapDirection(i,f),e)?{dockPoint:t.datavisualization.Diagram.Geometry.midPoint(e),direction:f}:null},_getEdges:function(n,i){var u=i.points,r={},e=n%360,f;return r.left=t.datavisualization.Diagram.Segment(u[3],u[0]),r.top=t.datavisualization.Diagram.Segment(u[0],u[1]),r.right=t.datavisualization.Diagram.Segment(u[1],u[2]),r.bottom=t.datavisualization.Diagram.Segment(u[2],u[3]),e<0&&(e+=360),e>315||e<45||(e<135?(f=r.top,r.top=r.left,r.left=r.bottom,r.bottom=r.right,r.right=f):e<225?(f=r.top,r.top=r.bottom,r.bottom=f,f=r.left,r.left=r.right,r.right=f):(f=r.bottom,r.bottom=r.left,r.left=r.top,r.top=r.right,r.right=f)),r},_swapDirection:function(n,t){var u,i=n%360,r;return i<0&&(i+=360),i>315||i<45?u=t:i<135?(r={left:"top",top:"right",right:"bottom",bottom:"left"},u=r[t]):i<225?(r={left:"right",top:"bottom",right:"left",bottom:"top"},u=r[t]):(r={left:"bottom",top:"left",right:"top",bottom:"right"},u=r[t]),u},_dockBounds:function(n,i,r){var u=n.line,f=i.points,h=u.type==="straight"?t.datavisualization.Diagram.Segment(u.startPoint,u.endPoint):r?u.point2?t.datavisualization.Diagram.Segment(u._point2,u.endPoint):t.datavisualization.Diagram.Segment(u.startPoint,u.endPoint):u.point1?t.datavisualization.Diagram.Segment(u.startPoint,u._point1):t.datavisualization.Diagram.Segment(u.startPoint,u.endPoint);var e,c=f.length,s=t.datavisualization.Diagram.Segment(f[c-1],f[0]),o=t.datavisualization.Diagram.Geometry.intersectSegment(h,s);if(!o)for(e=0;e<c-1;e++)if(s=t.datavisualization.Diagram.Segment(f[e],f[e+1]),o=t.datavisualization.Diagram.Geometry.intersectSegment(h,s),o)break;o&&(this._setLineEndPoint(n,o,r),u.type==="straight"&&this._updateBezierPoints(u))},_rightToLeft:function(n,i,r,u){var o=[],e,f;return o.push(u),i.x>u.x?u.x+5>=n.left?(e=r.right+15,f=u.y,o.push(t.datavisualization.Diagram.Point(e,f)),f=i.y>r.top?i.y:n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f)),i.y<=r.top&&(e=n.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.top-15,o.push(t.datavisualization.Diagram.Point(e,f)),e=i.x,o.push(t.datavisualization.Diagram.Point(e,f)))):(e=r.right+(n.left-r.right)/2,f=u.y,o.push(t.datavisualization.Diagram.Point(e,f)),f=i.y,o.push(t.datavisualization.Diagram.Point(e,f))):(Math.abs(n.top-r.bottom)<30||Math.abs(n.bottom-r.top)<30?u.x+15>n.right?(e=u.x+15,f=u.y):(e=n.right+15,f=u.y):(e=r.right+15,f=u.y),o.push(t.datavisualization.Diagram.Point(e,f)),n.top-r.bottom>=30?(f=n.top-15,o.push(t.datavisualization.Diagram.Point(e,f))):u.y>i.y?(f=r.top-n.bottom<30?n.top-15:n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):(f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))),e=n.left-15,o.push(t.datavisualization.Diagram.Point(e,f)),f=i.y,o.push(t.datavisualization.Diagram.Point(e,f))),o.push(i),o},_rightToRight:function(n,i,r,u){var e=[],f,o;return e.push(u),o=u.y,n.right>=r.left?u.y>=n.top&&u.y<=n.bottom?(f=u.x+15,e.push(t.datavisualization.Diagram.Point(f,o)),u.y>=n.center.y?(o=u.x>n.left?u.y>i.y?n.bottom+15:n.top-15:n.top-15,e.push(t.datavisualization.Diagram.Point(f,o)),f=n.right+15,e.push(t.datavisualization.Diagram.Point(f,o))):(o=n.bottom+15,e.push(t.datavisualization.Diagram.Point(f,o)),f=n.right+15,e.push(t.datavisualization.Diagram.Point(f,o)))):n.right<r.right?(f=r.right+15,e.push(t.datavisualization.Diagram.Point(f,o)),e.push(t.datavisualization.Diagram.Point(f,i.y))):(f=i.x+15,e.push(t.datavisualization.Diagram.Point(f,o)),e.push(t.datavisualization.Diagram.Point(f,i.y))):(f=u.x+15,e.push(t.datavisualization.Diagram.Point(f,o)),i.y>=r.top&&i.y<=r.bottom&&(i.y<=r.center.y?(o=r.top-15,e.push(t.datavisualization.Diagram.Point(f,o)),f=n.right+15,e.push(t.datavisualization.Diagram.Point(f,o))):(o=r.bottom+15,e.push(t.datavisualization.Diagram.Point(f,o)),f=n.right+15,e.push(t.datavisualization.Diagram.Point(f,o))))),e.push(t.datavisualization.Diagram.Point(f,i.y)),e.push(i),e},_rightToTop:function(n,i,r,u){var e=[],o,f;return e.push(u),f=u.y,i.x>=u.x?u.y+15>=i.y&&n.height!==0&&(o=n.left<=r.right?n.right+15:n.left-r.right>30?r.right+15:r.right+(n.left-r.right)/2,e.push(t.datavisualization.Diagram.Point(o,f)),f=n.top-15,e.push(t.datavisualization.Diagram.Point(o,f))):r.bottom>=n.top?(o=u.x+15<=n.right?n.right+15:r.right+15,e.push(t.datavisualization.Diagram.Point(o,f)),f=r.top>=n.top?n.height!==0?n.top-15:i.y:r.top-15,e.push(t.datavisualization.Diagram.Point(o,f))):(o=u.x+15,e.push(t.datavisualization.Diagram.Point(o,f)),n.top-r.bottom<30&&n.height!==0?r.left-n.right>=30?(f=r.bottom+15,e.push(t.datavisualization.Diagram.Point(o,f)),o=r.left-15,e.push(t.datavisualization.Diagram.Point(o,f)),f=n.top-15,e.push(t.datavisualization.Diagram.Point(o,f))):(f=n.top-(n.top-r.bottom)/2,e.push(t.datavisualization.Diagram.Point(o,f))):(f=n.height!==0?n.top-15:i.y,e.push(t.datavisualization.Diagram.Point(o,f)))),e.push(t.datavisualization.Diagram.Point(i.x,f)),e.push(i),e},_rightToBottom:function(n,i,r,u){var o=[],e,f;return o.push(u),f=u.y,i.x>=u.x?u.y<=n.bottom?n.left>r.right+15?(e=u.x+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):(e=n.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):r.right+15>i.x?(e=u.x+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=r.top-n.bottom>30?n.bottom+15:n.bottom+(r.top-n.bottom)/2,o.push(t.datavisualization.Diagram.Point(e,f))):f=u.y:u.y<=n.bottom?(e=r.right+15>n.right?r.right+15:n.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.bottom+15,f<=r.bottom+15&&(f=r.bottom+15),o.push(t.datavisualization.Diagram.Point(e,f))):n.bottom<r.top?(e=r.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=r.top-n.bottom<30?n.bottom+(r.top-n.bottom)/2:n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):(e=r.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=r.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))),o.push(t.datavisualization.Diagram.Point(i.x,f)),o.push(i),o},_leftToLeft:function(n,i,r,u){var o=[],f,e;return o.push(u),e=u.y,i.x>=u.x?(f=r.left-15,o.push(t.datavisualization.Diagram.Point(f,e)),u.y>i.y?i.y+15>=r.top?(e=r.top-15,o.push(t.datavisualization.Diagram.Point(f,e)),f=n.left-r.right>30?n.left-15:r.right+(n.left-r.right)/2,o.push(t.datavisualization.Diagram.Point(f,e))):(e=i.y,o.push(t.datavisualization.Diagram.Point(f,e)),f=i.x):r.bottom+15<i.y?(e=i.y,o.push(t.datavisualization.Diagram.Point(f,e)),f=i.x):(e=r.bottom+15,o.push(t.datavisualization.Diagram.Point(f,e)),f=n.left-r.right>30?n.left-15:r.right+(n.left-r.right)/2,o.push(t.datavisualization.Diagram.Point(f,e)))):(i.y>u.y?u.y>n.top-15&&(f=r.left-n.right<30?n.right+(r.left-n.right)/2:r.left-15,o.push(t.datavisualization.Diagram.Point(f,e)),e=n.top-15,o.push(t.datavisualization.Diagram.Point(f,e))):n.bottom+15>=u.y&&(f=r.left-n.right<30?n.right+(r.left-n.right)/2:r.left-15,o.push(t.datavisualization.Diagram.Point(f,e)),e=n.bottom+15,o.push(t.datavisualization.Diagram.Point(f,e)),f=n.left-15,o.push(t.datavisualization.Diagram.Point(f,e))),f=n.left-15,o.push(t.datavisualization.Diagram.Point(f,e))),o.push(t.datavisualization.Diagram.Point(f,i.y)),o.push(i),o},_leftToTop:function(n,i,r,u){var f=[],o,e;return f.push(u),e=u.y,u.x<=i.x?(o=u.y>i.y&&n.left<=r.left?n.left-15:r.left-15,f.push(t.datavisualization.Diagram.Point(o,e)),e=r.bottom<=n.top?r.bottom+15<n.top?n.height!==0?n.top-15:i.y:i.x<r.right?r.bottom+(n.top-r.bottom)/2:r.top-15:r.top>=n.top?n.height!==0?n.top-15:i.y:r.top-15,f.push(t.datavisualization.Diagram.Point(o,e))):i.y<=u.y+15&&n.height!==0&&(o=r.left-n.right>30?r.left-15:n.right>=r.left?n.left-15:n.right+(r.left-n.right)/2,f.push(t.datavisualization.Diagram.Point(o,e)),e=n.top-15,f.push(t.datavisualization.Diagram.Point(o,e))),f.push(t.datavisualization.Diagram.Point(i.x,e)),f.push(i),f},_leftToBottom:function(n,i,r,u){var e=[],o,f;return e.push(u),f=u.y,u.x<=i.x?(o=n.left<=u.x&&u.y<=n.top?n.left-15:r.left-15,e.push(t.datavisualization.Diagram.Point(o,f)),n.bottom<r.top?(f=r.top-n.bottom<30?n.bottom+(r.top-n.bottom)/2:n.bottom+15,e.push(t.datavisualization.Diagram.Point(o,f))):(f=n.bottom<r.bottom?r.bottom+15:n.bottom+15,e.push(t.datavisualization.Diagram.Point(o,f)))):u.y>i.y||(o=n.right>=r.left?n.left-15:r.left-n.right<30?r.left-(r.left-n.right)/2:r.left-15,e.push(t.datavisualization.Diagram.Point(o,f)),f=n.bottom+15,e.push(t.datavisualization.Diagram.Point(o,f))),e.push(t.datavisualization.Diagram.Point(i.x,f)),e.push(i),e},_topToTop:function(n,i,r,u){var o=[],e,f;return o.push(u),e=u.x,i.x>=u.x?i.y>=u.y?(f=r.top-15,o.push(t.datavisualization.Diagram.Point(e,f)),i.x<=r.right&&(e=r.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.height!==0?n.top-r.bottom>30?n.top-15:r.bottom+(n.top-r.bottom)/2:i.y,o.push(t.datavisualization.Diagram.Point(e,f)))):n.left<=u.x?(f=r.top-n.bottom>30?r.top-15:n.bottom+(r.top-n.bottom)/2,o.push(t.datavisualization.Diagram.Point(e,f)),e=n.left-15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.top-15,o.push(t.datavisualization.Diagram.Point(e,f))):(f=n.height!==0?n.top-15:i.y,o.push(t.datavisualization.Diagram.Point(e,f))):i.y>=u.y?(f=r.top-15,o.push(t.datavisualization.Diagram.Point(e,f)),i.x>=r.left&&(e=r.left-15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.height!==0?n.top-r.bottom>30?n.top-15:r.bottom+(n.top-r.bottom)/2:i.y,o.push(t.datavisualization.Diagram.Point(e,f)))):n.right>=u.x?(f=r.top-n.bottom>30?r.top-15:n.bottom+(r.top-n.bottom)/2,o.push(t.datavisualization.Diagram.Point(e,f)),e=n.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.top-15,o.push(t.datavisualization.Diagram.Point(e,f))):(f=n.height!==0?n.top-15:i.y,o.push(t.datavisualization.Diagram.Point(e,f))),e=i.x,o.push(t.datavisualization.Diagram.Point(e,f)),o.push(i),o},_topToBottom:function(n,i,r,u){var o=[],e,f;return o.push(u),e=u.x,i.x>=u.x?r.top>=n.bottom?r.top-n.bottom>=30?(f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):(f=n.bottom+(r.top-n.bottom)/2,o.push(t.datavisualization.Diagram.Point(e,f)),e=n.left-r.right>=30?r.right+15:r.right+(n.left-r.right)/2,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):(f=n.top<r.top?n.left>=r.right+15?r.top-15:n.top-15:r.top-15,o.push(t.datavisualization.Diagram.Point(e,f)),e=n.left>=r.right+15?r.right+15:n.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):r.top>=n.bottom?r.top-n.bottom>30?(f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):(f=n.bottom+(r.top-n.bottom)/2,o.push(t.datavisualization.Diagram.Point(e,f)),e=r.left-n.right>=30?r.left-15:n.right+(r.left-n.right)/2,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):(f=r.left>=n.right+15?r.top-15:r.top-15,o.push(t.datavisualization.Diagram.Point(e,f)),e=r.left>=n.right+15?n.right+15:r.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=r.left>=n.right+15?n.bottom+15:n.bottom<=r.bottom?r.bottom+15:n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))),o.push(t.datavisualization.Diagram.Point(i.x,f)),o.push(i),o},_bottomToBottom:function(n,i,r,u){var o=[],e,f;return o.push(u),e=u.x,i.x>=u.x?r.bottom>=n.bottom?(f=r.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f)),i.x<r.right&&(e=r.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=r.top>=n.bottom?r.top-n.bottom>=30?n.bottom+15:n.bottom+(r.top-n.bottom)/2:n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f)))):u.x>n.left?(f=n.bottom-r.bottom>=30?r.bottom+15:r.bottom+(n.bottom-r.bottom)/2,o.push(t.datavisualization.Diagram.Point(e,f)),e=n.left-15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):(f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):r.bottom>=n.bottom?(f=r.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f)),i.x>r.left&&(e=r.left-15,o.push(t.datavisualization.Diagram.Point(e,f)),f=r.top>=n.bottom?r.top-n.bottom>=30?n.bottom+15:n.bottom+(r.top-n.bottom)/2:n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f)))):u.x<n.right?(f=n.bottom-r.bottom>=30?r.bottom+15:r.bottom+(n.bottom-r.bottom)/2,o.push(t.datavisualization.Diagram.Point(e,f)),e=n.right+15,o.push(t.datavisualization.Diagram.Point(e,f)),f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))):(f=n.bottom+15,o.push(t.datavisualization.Diagram.Point(e,f))),o.push(t.datavisualization.Diagram.Point(i.x,f)),o.push(i),o},_addOrthogonalPoints:function(n,t,i){var r=this._constructOrthogonalPoints(t,i);n.push(r[0]);n.push(r[1])},_constructOrthogonalPoints:function(n,i,r){var f=!1,s,h,u,e,o;return r!=undefined?f=r:(s=Math.abs(n.x-i.x),h=Math.abs(n.y-i.y),s>h&&(f=!0)),u=[],f?(e=t.datavisualization.Diagram.Point(n.x+(i.x-n.x)/2,n.y),o=t.datavisualization.Diagram.Point(n.x+(i.x-n.x)/2,i.y)):(e=t.datavisualization.Diagram.Point(n.x,n.y+(i.y-n.y)/2),o=t.datavisualization.Diagram.Point(i.x,n.y+(i.y-n.y)/2)),u.push(e),u.push(o),u},_updateOrthogonalPoints:function(n,t){var i=[],r;i.push(n.startPoint);r=this._constructOrthogonalPoints(n.startPoint,n.endPoint,t);i.push(r[0]);i.push(r[1]);i.push(n.endPoint);n.points=i},_resetOrthogonalPoints:function(n){var t=[],i;t.push(n.startPoint);t.push(n.endPoint);n.points=[];n.startPoint=t[0];n.points.push(t[0]);i=this._constructOrthogonalPoints(t[0],t[1]);n.points.push(i[0]);n.points.push(i[1]);n.endPoint=t[1];n.points.push(t[1])},_updateBezierPoints:function(n,i,r,u,f,e,o){var c,v={right:0,left:180,top:270,bottom:90},s,h,l,a;(n.point1==null||n.point2==null)&&(s=n.endPoint,h=n.startPoint,e?(c=o,h=this._getPortPosition(e,c),f.rotateAngle!==0&&(a=t.Matrix.identity(),t.Matrix.rotate(a,f.rotateAngle,f.offsetX,f.offsetY),h=t.Matrix.transform(a,h)),l=this._getDirection(c,h)):l=this._getBezierDirection(h,s),n._point1=n.point1||this._getBezierAdjPoint(v[l],n.startPoint,n.endPoint),r?(c=u,s=this._getPortPosition(r,c),i.rotateAngle!==0&&(a=t.Matrix.identity(),t.Matrix.rotate(a,i.rotateAngle,i.offsetX,i.offsetY),s=t.Matrix.transform(a,s)),l=this._getDirection(c,s)):l=this._getBezierDirection(s,h),n._point2=n.point2||this._getBezierAdjPoint(v[l],n.endPoint,n.startPoint))},_getBezierDirection:function(n,t){return Math.abs(t.x-n.x)>Math.abs(t.y-n.y)?n.x<t.x?"right":"left":n.y<t.y?"bottom":"top"},_getDirection:function(n,i){var u=n.points,r=n.center,f=t.datavisualization.Diagram.Geometry.findAngle(i,r);return f>t.datavisualization.Diagram.Geometry.findAngle(u[0],r)&&f<=t.datavisualization.Diagram.Geometry.findAngle(u[1],r)?"top":f>=t.datavisualization.Diagram.Geometry.findAngle(u[1],r)&&f<=t.datavisualization.Diagram.Geometry.findAngle(u[2],r)?"right":f>=t.datavisualization.Diagram.Geometry.findAngle(u[3],r)||f<t.datavisualization.Diagram.Geometry.findAngle(u[0],r)?"left":f>=t.datavisualization.Diagram.Geometry.findAngle(u[2],r)&&f<=t.datavisualization.Diagram.Geometry.findAngle(u[3],r)?"bottom":"right"},_getBezierAdjPoint:function(n,i,r){var u=60,f=t.datavisualization.Diagram.Point(0,0),e=n>45&&n<135?"Bottom":n>135&&n<225?"Left":n>225&&n<315?"Top":"Right";switch(e){case"Right":u=Math.min(Math.abs(i.x-r.x)*.45,u);f=t.datavisualization.Diagram.Point(i.x+u,i.y);break;case"Bottom":u=Math.min(Math.abs(i.y-r.y)*.45,u);f=t.datavisualization.Diagram.Point(i.x,i.y+u);break;case"Left":u=Math.min(Math.abs(i.x-r.x)*.45,u);f=t.datavisualization.Diagram.Point(i.x-u,i.y);break;case"Top":u=Math.min(Math.abs(i.y-r.y)*.45,u);f=t.datavisualization.Diagram.Point(i.x,i.y-u)}return f},_setLineEndPoint:function(n,t,i,r){var u=n.line;u.type==="orthogonal"&&(this.isTargetConnected(n)&&this.isSourceConnected(n)||this._resetOrthogonalPoints(u));i?u.endPoint=u.points[u.points.length-1]=t:u.startPoint=u.points[0]=t;u.type==="orthogonal"?this._updateOrthogonalPoints(u,r):u.type==="bezier"&&this._updateBezierPoints(u)},_setBezierPoint:function(n,t,i){var r=n.line;i==="bezierpoint1"?r.point1=r._point1=t:r.point2=r._point2=t},_setPoints:function(n,t){n.startPoint=n.points[0]=t[0];n.endPoint=n.points[n.points.length-1]=t[t.length-1];n.points=t;n.type==="bezier"&&(n.point1=t[2]||n.point1,n.point2=t[3]||n.point2,n.point1||(n._point1=n.point1),n.point2||(n._point2=n.point2),this._updateBezierPoints(n))},_translateLine:function(n,i,r,u){var f,e,o;for(n.type===t.datavisualization.Diagram.Lines.Orthogonal&&u&&(this.isTargetConnected(u)&&this.isSourceConnected(u)||this._resetOrthogonalPoints(n)),f=n.points,e=0,o=f.length;e<o;++e)f[e]=t.datavisualization.Diagram.Geometry.translate(f[e],i,r);n.startPoint=f[0];n.endPoint=f[f.length-1];n.type===t.datavisualization.Diagram.Lines.Bezier&&(n._point1=t.datavisualization.Diagram.Geometry.translate(n._point1,i,r),n._point2=t.datavisualization.Diagram.Geometry.translate(n._point2,i,r),n.point1&&(n.point1=n._point1),n.point2&&(n.point2=n._point2))},_getLabelPosition:function(n,i){var r=i.width*n.offset.x,u=i.height*n.offset.y;return t.datavisualization.Diagram.Point(r,u)},_getPortPosition:function(n,i,r){if(r)return t.datavisualization.Diagram.Point(i.width*n.offset.x,i.height*n.offset.y);var u=i.x+i.width*n.offset.x,f=i.y+i.height*n.offset.y;return t.datavisualization.Diagram.Point(u,f)},_updateGroupBounds:function(n,i){var u;if(n&&n.isGroup&&n.children.length>0){this._updateRotateAngle(n,i);var r=this._getChildrenBounds(n,i),e=r.x+r.width*n.pivot.x,o=r.y+r.height*n.pivot.y,f=t.Matrix.identity();t.Matrix.rotate(f,n.rotateAngle);u=t.Matrix.transform(f,{x:e,y:o});r&&(n.offsetX=u.x,n.offsetY=u.y,n.width=r.width,n.height=r.height)}},_getChildrenBounds:function(n,i){var u=n.children,f,e=null,r,o,s;for(u.length>0&&(r=i[u[0]],e=this._rotateChildBounds(r,n)),o=1,s=u.length;o<s;o++)r=i[u[o]],r.isGroup?(this._updateGroupBounds(r,i),f=this._rotateChildBounds(r,n)):f=this._rotateChildBounds(r,n),f&&(e=t.datavisualization.Diagram.Geometry.union(e,f));return e},_updateRotateAngle:function(n,t){var i,r;if(n.offsetX==0&&n.offsetY==0&&n.width==0&&n.height==0)for(i=0;i<n.children.length;i++)if(r=t[n.children[i]],!r.line&&!n.rotateAngle){n.rotateAngle=r.rotateAngle;return}},_rotateChildBounds:function(n,i){var r=t.Matrix.identity();t.Matrix.rotate(r,-i.rotateAngle);var u=this.bounds(n),f=t.Matrix.transform(r,u.topLeft),e=t.Matrix.transform(r,u.topRight),o=t.Matrix.transform(r,u.bottomLeft),s=t.Matrix.transform(r,u.bottomRight),h=Math.min(f.x,e.x,o.x,s.x),c=Math.min(f.y,e.y,o.y,s.y);return{x:h,width:Math.max(f.x,e.x,o.x,s.x)-h,y:c,height:Math.max(f.y,e.y,o.y,s.y)-c}}};t.datavisualization.Diagram.Geometry={checkPointOnCircle:function(n,t,i){var r=Math.pow(i,2),u=Math.pow(n.x-t.x,2),f=Math.pow(n.y-t.y,2);return u+f<=r?!0:!1},rect:function(n){var c=t.datavisualization.Diagram.Rectangle(),e,i,r,h;if(arguments.length===1){var o=Number.MAX_VALUE,s=Number.MAX_VALUE,l=Number.MIN_VALUE,a=Number.MIN_VALUE,v=n.length,u,f;for(e=0;e<v;e++)u=n[e].x,f=n[e].y,u<o&&(o=u),u>l&&(l=u),f<s&&(s=f),f>a&&(a=f);c=t.datavisualization.Diagram.Rectangle(o,s,l-o,a-s)}else arguments.length===2&&(i=t.datavisualization.Diagram.Point(arguments[0]),r=t.datavisualization.Diagram.Point(arguments[1]),i.x>r.x&&(h=i.x,i.x=r.x,r.x=h),i.y>r.y&&(h=i.y,i.y=r.y,r.y=h),c=t.datavisualization.Diagram.Rectangle(i.x,i.y,r.x-i.x,r.y-i.y));return c},union:function(n,i){var r=Math.min(n.x,i.x),u=Math.min(n.y,i.y),f=Math.max(n.x+n.width,i.x+i.width),e=Math.max(n.y+n.height,i.y+i.height);return t.datavisualization.Diagram.Rectangle(r,u,f-r,e-u)},distance:function(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))},translate:function(n,i,r){return t.datavisualization.Diagram.Point(n.x+i,n.y+r)},intersectsRect:function(n,t){return t.x<n.x+n.width&&n.x<t.x+t.width&&t.y<n.y+n.height&&n.y<t.y+t.height},findAngle:function(n,t){var i=Math.atan2(t.y-n.y,t.x-n.x);return i=180*i/Math.PI,i%=360,i<0&&(i+=360),i},intersectSegment:function(n,i){var a=n.point1.x,v=n.point1.y,y=n.point2.x,p=n.point2.y,w=i.point1.x,b=i.point1.y,k=i.point2.x,d=i.point2.y,f,e,o,s,h,c,rt,ut,g,nt,tt,it,r,l,u;return(f=p-v,o=a-y,h=y*v-a*p,tt=f*w+o*b+h,it=f*k+o*d+h,tt!==0&&it!==0&&this.sameSign(tt,it))?null:(e=d-b,s=w-k,c=k*b-w*d,g=e*a+s*v+c,nt=e*y+s*p+c,g!==0&&nt!==0&&this.sameSign(g,nt))?null:(r=f*s-e*o,r===0)?null:(l=r<0?-r/2:r/2,u=o*c-s*h,rt=u<0?(u-l)/r:(u+l)/r,u=e*h-f*c,ut=u<0?(u-l)/r:(u+l)/r,t.datavisualization.Diagram.Point(rt,ut))},sameSign:function(n,t){return n*t>=0},containsPoint:function(n,t){return n.x<=t.x&&t.x<n.x+n.width&&n.y<=t.y&&t.y<n.y+n.height},containsRect:function(n,t){return n.x<=t.x&&t.x+t.width<=n.x+n.width&&n.y<=t.y&&t.y+t.height<=n.y+n.height},inflate:function(n,t,i){n.x-=t;n.y-=i;n.width+=2*t;n.height+=2*i},isEmptyRect:function(n){return n.x===0&&n.y===0&&n.width===0&&n.height===0},isEmptyPoint:function(n){return n.x===0&&n.y===0},isEmptySize:function(n){return n.width===0&&n.height===0},length:function(n){return t.datavisualization.Diagram.Geometry.distance(n.point1,n.point2)},midPoint:function(n){return t.datavisualization.Diagram.Point((n.point1.x+n.point2.x)/2,(n.point1.y+n.point2.y)/2)}};t.datavisualization.Diagram.Segment=function(n,t){return{point1:n,point2:t}};t.datavisualization.Diagram.Point=function(n,t){return{x:Number(n)||0,y:Number(t)||0}};t.datavisualization.Diagram.Size=function(n,t){return{width:Number(n)||0,height:Number(t)||0}};t.datavisualization.Diagram.Rectangle=function(n,t,i,r){return{x:Number(n)||0,y:Number(t)||0,width:Number(i)||0,height:Number(r)||0}};t.datavisualization.Diagram.DecoratorShapes={None:"none",Arrow:"arrow",OpenArrow:"openarrow",Circle:"circle",Diamond:"diamond",Path:"path"};t.datavisualization.Diagram.PortShapes={X:"x",Circle:"circle",Square:"square",Path:"path"};t.datavisualization.Diagram.PortVisibility={Visible:1,Hidden:2,Hover:4,Connection:8,Default:12};t.datavisualization.Diagram.TextAlign={Left:"left",Center:"center",Right:"right"};t.datavisualization.Diagram.HorizontalAlignment={Left:"left",Center:"center",Right:"right"};t.datavisualization.Diagram.LabelEditMode={Edit:"edit",View:"view"};t.datavisualization.Diagram.VerticalAlignment={Top:"top",Center:"center",Bottom:"bottom"};t.datavisualization.Diagram.TextDecorations={Underline:"underline",Overline:"overline",LineThrough:"line-through",None:"none"};t.datavisualization.Diagram.NodeConstraints={None:1,Select:2,Delete:4,Resize:8,Drag:16,Rotate:32,Connect:64,Default:126};t.datavisualization.Diagram.ConnectorConstraints={None:1,Select:2,Delete:4,Drag:8,DragSourceEnd:16,DragTargetEnd:32,DragSegmentThumb:64,Default:126};t.datavisualization.Diagram.PortConstraints={None:1,Connect:2};t.datavisualization.Diagram.SelectorConstraints={None:1,Rotator:2,Resizer:4,UserHandles:8,All:14};t.datavisualization.Diagram.UserHandlePositions={TopLeft:"topleft",TopCenter:"topcenter",TopRight:"topright",MiddleLeft:"middleleft",MiddleRight:"middleright",BottomLeft:"bottomleft",BottomCenter:"bottomcenter",BottomRight:"bottomright"};t.datavisualization.Diagram.SnapConstraints={None:0,SnapToHorizontalLines:1,SnapToVerticalLines:2,SnapToLines:3,ShowHorizontalLines:4,ShowVerticalLines:8,ShowLines:12,All:15};t.datavisualization.Diagram.PageOrientations={Landscape:"landscape",Portrait:"portrait"};t.datavisualization.Diagram.LayoutOrientations={TopToBottom:"toptobottom",BottomToTop:"bottomtotop",LeftToRight:"lefttoright",RightToLeft:"righttoleft"};t.datavisualization.Diagram.PaletteDefaults={name:"",expanded:!1,subControlId:null,items:[]};t.datavisualization.Diagram.Palette=function(i){if(i.items)for(var r=0;r<i.items.length;r++)i.items[r]=i.items[r].line?t.datavisualization.Diagram.Connector(i.items[r]):i.items[r].isGroup?t.datavisualization.Diagram.Group(i.items[r]):t.datavisualization.Diagram.Node(i.items[r]);return n.extend(!0,{},t.datavisualization.Diagram.PaletteDefaults,i)};t.datavisualization.Diagram.Shapes={Rectangle:"rectangle",Ellipse:"ellipse",Image:"image",Text:"text",Path:"path",Polygon:"polygon",Html:"html",Native:"native"};t.datavisualization.Diagram.ShapeDefaults={type:t.datavisualization.Diagram.Shapes.Rectangle,cornerRadius:0,src:"",pathData:"",textBlock:null,points:[],html:"",content:null};t.datavisualization.Diagram.Shape=function(i){return i&&i.textBlock&&(i.textBlock=t.datavisualization.Diagram.TextBlock(i.textBlock)),n.extend(!0,{},t.datavisualization.Diagram.ShapeDefaults,i)};t.datavisualization.Diagram.Lines={Straight:"straight",Orthogonal:"orthogonal",Bezier:"bezier"};t.datavisualization.Diagram.LineDefaults={type:t.datavisualization.Diagram.Lines.Straight,startPoint:t.datavisualization.Diagram.Point(),endPoint:t.datavisualization.Diagram.Point(),points:[],point1:null,point2:null,_point1:t.datavisualization.Diagram.Point(),_point2:t.datavisualization.Diagram.Point()};t.datavisualization.Diagram.Line=function(i){var r=n.extend(!0,{},t.datavisualization.Diagram.LineDefaults,i),u=[];return u.push(r.startPoint),r.type===t.datavisualization.Diagram.Lines.Orthogonal&&t.datavisualization.Diagram.Util._addOrthogonalPoints(u,r.startPoint,r.endPoint),u.push(r.endPoint),r.points=u,r.type===t.datavisualization.Diagram.Lines.Bezier&&t.datavisualization.Diagram.Util._updateBezierPoints(r),r};t.datavisualization.Diagram.MarginDefaults={top:0,left:0,right:0,bottom:0};t.datavisualization.Diagram.Margin=function(i){return n.extend(!0,{},t.datavisualization.Diagram.MarginDefaults,i)};t.datavisualization.Diagram.Path=function(){this._path=""};t.datavisualization.Diagram.Path.prototype={moveTo:function(n,t){return this._path+="M"+n+","+t,this},lineTo:function(n,t){return this._path+="L"+n+","+t,this},cubicBezierTo:function(n,t){return this._path+=t?"S":"C",this._addPoints(n),this},quadraticBezierTo:function(n,t){return this._path+=t?"T":"Q",this._addPoints(n),this},ellipticalArcTo:function(n,t,i,r,u,f,e){return this._path+="A"+n+","+t+" "+i+" "+r+","+u+" "+f+","+e,this},close:function(){return this._path+="Z",this},toString:function(){return this._path},_addPoints:function(n){for(var i,t=0;t<n.length;t++)i=n[t],this._path+=i.x+", "+i.y,t!==n.length-1&&(this._path+=" ")}};t.datavisualization.Diagram.DecoratorDefaults={shape:t.datavisualization.Diagram.DecoratorShapes.Arrow,width:8,height:8,borderColor:"black",fillColor:"black",pathData:""};t.datavisualization.Diagram.Decorator=function(i){return n.extend(!0,{},t.datavisualization.Diagram.DecoratorDefaults,i)};t.datavisualization.Diagram.TextBlockDefaults={readOnly:!1,bold:!1,italic:!1,text:"",textDecoration:t.datavisualization.Diagram.TextDecorations.None,fontSize:12,fontFamily:"Arial",fontColor:"black",offset:t.datavisualization.Diagram.Point(.5,.5),textAlign:t.datavisualization.Diagram.TextAlign.Center,horizontalAlignment:t.datavisualization.Diagram.HorizontalAlignment.Center,verticalAlignment:t.datavisualization.Diagram.VerticalAlignment.Center,wrapText:!0,margin:t.datavisualization.Diagram.Margin(),mode:t.datavisualization.Diagram.LabelEditMode.Edit,width:50};t.datavisualization.Diagram.TextBlock=function(i){return n.extend(!0,{},t.datavisualization.Diagram.TextBlockDefaults,i)};t.datavisualization.Diagram.LabelDefaults=n.extend(!0,{},t.datavisualization.Diagram.TextBlockDefaults,{name:"",visible:!0,borderColor:"transparent",borderWidth:0,fillColor:"transparent"});t.datavisualization.Diagram.Label=function(i){return n.extend(!0,{},t.datavisualization.Diagram.LabelDefaults,i)};t.datavisualization.Diagram.PortDefaults={name:"",visibility:t.datavisualization.Diagram.PortVisibility.Default,constraints:t.datavisualization.Diagram.PortConstraints.Connect,size:8,offset:t.datavisualization.Diagram.Point(0,0),borderColor:"#1a1a1a",borderWidth:1,fillColor:"white",shape:t.datavisualization.Diagram.PortShapes.Square,pathData:""};t.datavisualization.Diagram.Port=function(i){return n.extend(!0,{},t.datavisualization.Diagram.PortDefaults,i)};t.datavisualization.Diagram.StopDefaults={color:"",offset:0,opacity:1};t.datavisualization.Diagram.Stop=function(i){return n.extend(!0,{},t.datavisualization.Diagram.StopDefaults,i)};t.datavisualization.Diagram.LinearGradientDefaults={type:"linear",x1:0,x2:0,y1:0,y2:0,stops:[]};t.datavisualization.Diagram.LinearGradient=function(i){for(var r=0;r<i.stops.length;r++)i.stops[r]=t.datavisualization.Diagram.Stop(i.stops[r]);return n.extend(!0,{},t.datavisualization.Diagram.LinearGradientDefaults,i)};t.datavisualization.Diagram.RadialGradientDefaults={type:"radial",cx:0,cy:0,fx:0,fy:0,stops:[]};t.datavisualization.Diagram.RadialGradient=function(i){for(var r=0;r<i.stops.length;r++)i.stops[r]=t.datavisualization.Diagram.Stop(i.stops[r]);return n.extend(!0,{},t.datavisualization.Diagram.RadialGradientDefaults,i)};t.datavisualization.Diagram.NodeBaseDefaults={name:"",width:0,height:0,offsetX:0,offsetY:0,visible:!0,zOrder:0,excludeFromLayout:!1,constraints:t.datavisualization.Diagram.NodeConstraints.Default,parent:"",labels:[],ports:[],inEdges:[],outEdges:[],rotateAngle:0,pivot:t.datavisualization.Diagram.Point(.5,.5),addInfo:{}};t.datavisualization.Diagram.NodeBase=function(i){var r;if(i.labels)for(r=0;r<i.labels.length;r++)i.labels[r]=t.datavisualization.Diagram.Label(i.labels[r]);if(i.ports)for(r=0;r<i.ports.length;r++)i.ports[r]=t.datavisualization.Diagram.Port(i.ports[r]);return n.extend(!0,{},t.datavisualization.Diagram.NodeBaseDefaults,i)};t.datavisualization.Diagram.NodeDefaults={fillColor:"white",borderColor:"black",borderWidth:1,borderDashArray:"",opacity:1,gradient:null,shape:t.datavisualization.Diagram.Shape()};t.datavisualization.Diagram.Node=function(i){return i.gradient&&(i.gradient.type==="linear"?i.gradient=t.datavisualization.Diagram.LinearGradient(i.gradient):i.gradient.type==="radial"&&(i.gradient=t.datavisualization.Diagram.RadialGradient(i.gradient))),i.shape&&(i.shape=t.datavisualization.Diagram.Shape(i.shape)),n.extend(!0,{},t.datavisualization.Diagram.NodeDefaults,t.datavisualization.Diagram.NodeBase(i))};t.datavisualization.Diagram.ConnectorDefaults={name:"",visible:!0,lineDashArray:"",targetDecorator:null,sourceDecorator:null,line:t.datavisualization.Diagram.Line({startPoint:t.datavisualization.Diagram.Point(),endPoint:t.datavisualization.Diagram.Point()}),lineColor:"black",lineWidth:1,constraints:t.datavisualization.Diagram.ConnectorConstraints.Default,opacity:1,parent:"",labels:[],zOrder:0,lineHitPadding:10,addInfo:{},targetNode:null,targetPort:null,sourceNode:null,sourcePort:null};t.datavisualization.Diagram.Connector=function(i){if(i.targetDecorator=t.datavisualization.Diagram.Decorator(i.targetDecorator||{}),i.sourceDecorator=t.datavisualization.Diagram.Decorator(i.sourceDecorator||{shape:t.datavisualization.Diagram.DecoratorShapes.None}),i.line&&(i.line=t.datavisualization.Diagram.Line(i.line)),i.labels)for(var r=0;r<i.labels.length;r++)i.labels[r]=t.datavisualization.Diagram.Label(i.labels[r]);return n.extend(!0,{},t.datavisualization.Diagram.ConnectorDefaults,i)};t.datavisualization.Diagram.GroupDefaults={isGroup:!0,children:[],canUngroup:!0};t.datavisualization.Diagram.Group=function(i){return n.extend(!0,{},t.datavisualization.Diagram.GroupDefaults,t.datavisualization.Diagram.NodeBase(i))};t.datavisualization.Diagram.ZoomCommand={ZoomIn:1,ZoomOut:2};t.datavisualization.Diagram.Zoom=function(i){return n.extend(!0,{},{zoomFactor:.2,focusPoint:null,zoomCommand:t.datavisualization.Diagram.ZoomCommand.ZoomIn},i)};t.datavisualization.Diagram.UserHandleDefaults={name:"",pathData:"",borderColor:"",backgroundColor:"#2382c3",position:t.datavisualization.Diagram.UserHandlePositions.BottomCenter,pathColor:"white",tool:"",size:20,visible:!0,enableMultiSelection:!1};t.datavisualization.Diagram.UserHandle=function(i){return n.extend(!0,{},t.datavisualization.Diagram.UserHandleDefaults,i)}}(jQuery,Syncfusion),function(n,t){"use strict";var i=function(){function n(n){return this.xmlns="http://www.w3.org/2000/svg",this.document=document.createElementNS(this.xmlns,"svg"),this.id=n.id,n&&t.datavisualization.Diagram.Util.attr(this.document,n),this}return n.prototype.element=function(n,i){var r;return n&&n.id&&(r=this.document.getElementById(n.id)),r||(r=document.createElementNS(this.xmlns,i)),n&&t.datavisualization.Diagram.Util.attr(r,n),r},n.prototype.g=function(n){return this.element(n,"g")},n.prototype.defs=function(n){return this.element(n,"defs")},n.prototype.image=function(n){return this.element(n,"image")},n.prototype.path=function(n){return this.element(n,"path")},n.prototype.text=function(n){return this.element(n,"text")},n.prototype.textPath=function(n){return this.element(n,"textPath")},n.prototype.tspan=function(n){return this.element(n,"tspan")},n.prototype.rect=function(n){return this.element(n,"rect")},n.prototype.ellipse=function(n){return this.element(n,"ellipse")},n.prototype.circle=function(n){return this.element(n,"circle")},n.prototype.line=function(n){return this.element(n,"line")},n.prototype.polyline=function(n){return this.element(n,"polyline")},n.prototype.polygon=function(n){return this.element(n,"polygon")},n.prototype.foreignObject=function(n){return this.element(n,"foreignObject")},n.prototype.linearGradient=function(n){return this.element(n,"linearGradient")},n.prototype.radialGradient=function(n){return this.element(n,"radialGradient")},n.prototype.stop=function(n){return this.element(n,"stop")},n.prototype.pattern=function(n){return this.element(n,"pattern")},n.prototype.appendChild=function(n){this.document.appendChild(n)},n.prototype.removeChild=function(n,t){t?t.removeChild(n):this.document.removeChild(n)},n.prototype.getElementById=function(n){return this.document.getElementById(n)},n.prototype.getElementsByClassName=function(n){return this.document.getElementsByClassName(n)},n.prototype.getElementsByTagName=function(n){return this.document.getElementsByTagName(n)},n.prototype.pathBounds=function(n){var r={d:n},t=this.path(r),i;return this.document.appendChild(t),i=t.getBBox(),this.document.removeChild(t),i},n.prototype.textBounds=function(n,t,i){var u=null,r;return n&&t?(r=this.text(t),r.appendChild(document.createTextNode(n)),this.document.appendChild(r),u=r.getBBox(),this.document.removeChild(r)):i&&(this.document.appendChild(i),u=i.getBBox(),this.document.removeChild(i)),u},n.prototype.absolutePath=function(n){for(var t,e,l,a,o,s,h,c,f=n.pathSegList,i=0,r=0,u=0,v=f.numberOfItems;u<v;++u){if(t=f.getItem(u),e=t.pathSegTypeAsLetter,/[MLHVCSQTA]/.test(e))"x"in t&&(i=t.x),"y"in t&&(r=t.y);else{"x1"in t&&(o=i+t.x1);"x2"in t&&(h=i+t.x2);"y1"in t&&(s=r+t.y1);"y2"in t&&(c=r+t.y2);"x"in t&&(i+=t.x);"y"in t&&(r+=t.y);switch(e){case"m":f.replaceItem(n.createSVGPathSegMovetoAbs(i,r),u);break;case"l":f.replaceItem(n.createSVGPathSegLinetoAbs(i,r),u);break;case"h":f.replaceItem(n.createSVGPathSegLinetoHorizontalAbs(i),u);break;case"v":f.replaceItem(n.createSVGPathSegLinetoVerticalAbs(r),u);break;case"c":f.replaceItem(n.createSVGPathSegCurvetoCubicAbs(i,r,o,s,h,c),u);break;case"s":f.replaceItem(n.createSVGPathSegCurvetoCubicSmoothAbs(i,r,h,c),u);break;case"q":f.replaceItem(n.createSVGPathSegCurvetoQuadraticAbs(i,r,o,s),u);break;case"t":f.replaceItem(n.createSVGPathSegCurvetoQuadraticSmoothAbs(i,r),u);break;case"a":f.replaceItem(n.createSVGPathSegArcAbs(i,r,t.r1,t.r2,t.angle,t.largeArcFlag,t.sweepFlag),u);break;case"z":case"Z":i=l;r=a}}(e==="M"||e==="m")&&(l=i,a=r)}return n},n}();t.datavisualization.Diagram.Svg=i;t.datavisualization.Diagram.SvgContext={transformView:function(n,i,r){var u=n._view,f={transform:"translate("+i+","+r+")"};t.datavisualization.Diagram.Util.attr(u,f);t.browserInfo().name==="msie"&&n._htmlLayer&&n._htmlLayer.children.length>0&&(n._htmlLayer.style.left=i+"px",n._htmlLayer.style.top=r+"px",n._htmlLayer.style.position="absolute")},scaleContent:function(n,i){var u=n._diagramLayer,r;t.datavisualization.Diagram.Util.attr(u,{transform:"scale("+i+")"});t.browserInfo().name==="msie"&&n._htmlLayer&&n._htmlLayer.children.length>0&&(n._htmlLayer.style.transform="scale("+i+")");n.selectionList.length>0&&this.updateSelector(n.selectionList[0],n._svg,i,n,n.model.selectorConstraints);n.selectionList[0]&&n.model.userHandles&&n.model.userHandles.length>0&&(r=!1,n.selectionList[0].isPseudoGroup&&(r=!0),n.model.selectorConstraints&t.datavisualization.Diagram.SelectorConstraints.UserHandles&&t.datavisualization.Diagram.SvgContext.updateUserHandles(n.model.userHandles,n.selectionList[0],n._svg,r,!1,i))},setSize:function(n,i,r){t.datavisualization.Diagram.Util.attr(n.document,{width:i+"px",height:r+"px"})},_findIndex:function(t,i){var r,f=1,e,u;return u=i.parent?n("#"+i.parent.name).find(">.node,>.connector,>.group"):n("#DiagramContent_canvas_svg").find(">.node,>.connector,>.group"),i.name!="helper"&&(r=u[u.length-1],r&&r.id=="helper"&&(r=u[u.length-2]),r&&(e=0,r.className.animVal=="ej-d-node"||r.className.animVal=="ej-d-group"?f=e+1:r.className.animVal=="ej-d-connector"&&(f=e+1))),f},renderNode:function(n,t,i){var r,u=n.name,f=n.visible?"visible":"hidden",e=n.offsetX-n.width*n.pivot.x,o=n.offsetY-n.height*n.pivot.y;return r=t.g({id:u,"class":"ej-d-node",transform:"rotate("+n.rotateAngle+","+n.offsetX+","+n.offsetY+"),translate("+e+","+o+")",visibility:f}),i?i.appendChild(r):t.appendChild(r),this._renderNode(n,t,r),r},_renderNode:function(n,t,i){this._renderShape(n,t,i);this._renderLabels(n,t,i);this._renderPorts(n,t,i)},renderGroup:function(n,t,i,r){var u,h=n.visible?"visible":"hidden",o,e,s,f;for(u=t.g({id:n.name,"class":"ej-d-group",visibility:h}),i?i.appendChild(u):t.appendChild(u),o=n.children,e=0,s=o.length;e<s;e++)f=r[o[e]],f.isGroup?this.renderGroup(f,t,u,r):f.line?this.renderConnector(f,t,u):this.renderNode(f,t,u);return this._renderLabels(n,t,u),this._renderPorts(n,t,u),u},_renderGradient:function(n,t,i){var u,r;return t.type==="linear"?(r=this._renderLinearGradient(n,t,i),u="url(#"+r+")"):t.type==="radial"&&(r=this._renderRadialGradient(n,t,i),u="url(#"+r+")"),u},_renderLinearGradient:function(n,t,i){var u=i.getElementsByTagName("defs")[0],f,r;return u?(f={id:n+"_gradient",x1:t.x1+"%",y1:t.y1+"%",x2:t.x2+"%",y2:t.y2+"%"},r=i.linearGradient(f),this._renderStops(t,i,r),u.appendChild(r),r.id):null},_renderRadialGradient:function(n,t,i){var u=i.getElementsByTagName("defs")[0],f,r;return u?(f={id:n+"_gradient",cx:t.cx+"%",cy:t.cy+"%",fx:t.fx+"%",fy:t.fy+"%",r:t.r+"%"},r=i.radialGradient(f),this._renderStops(t,i,r),u.appendChild(r),r.id):null},_renderStops:function(n,t,i){var f,r,u,e;if(t.getElementById(i.getAttribute("id"))===i)while(i.firstChild)i.removeChild(i.firstChild);for(f=n.stops,u=0,e=f.length;u<e;u++)r=f[u],i.appendChild(t.stop({offset:r.offset+"%","stop-color":r.color,"stop-opacity":r.opacity}))},_renderShape:function(n,t,i){switch(n.shape.type){case"rectangle":this._renderRect(n,t,i);break;case"ellipse":this._renderEllipse(n,t,i);break;case"image":this._renderImage(n,t,i);break;case"path":this._renderPath(n,t,i);break;case"polygon":this._renderPolygon(n,t,i);break;case"text":this._renderTextElement(n,t,i);break;case"html":this._renderHtmlElement(n,t,i);break;case"native":this._rendercontent(n,t,i)}},_rendercontent:function(n,t,i){var u;if(n.shape.content){typeof n.shape.content=="string"&&(u=document.getElementById(n.shape.content),n.shape.content=u.cloneNode(!0));n.shape.content instanceof SVGElement&&(n.shape.content=n.shape.content.cloneNode(!0));n.shape.content.setAttribute("preserveAspectRatio","none");i.appendChild(n.shape.content);var r=n.shape.content.getBBox(),f=r.width?n.width/r.width:1,e=r.height?n.height/r.height:1;n.shape.content.setAttribute("transform","scale("+f+","+e+")");n.shape.content.setAttribute("id",n.name+"_shape")}},_fill:function(n,t){var i;return n.gradient&&(i=this._renderGradient(n.name,n.gradient,t)),i||(i=n.fillColor),i},_renderRect:function(n,t,i){var r=this._fill(n,t),u={id:n.name+"_shape",rx:n.shape.cornerRadius,ry:n.shape.cornerRadius,width:n.width,height:n.height,fill:r,stroke:n.borderColor,"stroke-width":n.borderWidth,opacity:n.opacity,"stroke-dasharray":n.borderDashArray};i.appendChild(t.rect(u))},_renderEllipse:function(n,t,i){var r=this._fill(n,t),u={id:n.name+"_shape",rx:n.width/2,ry:n.height/2,cx:n.width/2,cy:n.height/2,fill:r,stroke:n.borderColor,"stroke-width":n.borderWidth,opacity:n.opacity,"stroke-dasharray":n.borderDashArray};i.appendChild(t.ellipse(u))},_renderImage:function(n,t,i){var f=this._renderBackgroundRect(n,t),u,r;i.appendChild(f);u={id:n.name+"_shape",width:n.width,height:n.height,opacity:n.opacity,preserveAspectRatio:"none"};r=t.image(u);r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n.shape.src);i.appendChild(r)},_renderPolygon:function(n,t,i){var f=this._fill(n,t),r,u;this._updatePolygonPoints(n);r=this._convertToSVGPoints(n.shape.points);u={id:n.name+"_shape",fill:f,stroke:n.borderColor,"stroke-width":n.borderWidth,opacity:n.opacity,"stroke-dasharray":n.borderDashArray,points:r};i.appendChild(t.polygon(u))},_renderPath:function(n,t,i){var r=this._fill(n,t),u=this._updatePath(0,0,n.width,n.height,n.shape.pathData,t),f={id:n.name+"_shape",width:n.width,height:n.height,d:u,opacity:n.opacity,"stroke-dasharray":n.borderDashArray,stroke:n.borderColor,"stroke-width":n.borderWidth,fill:r};i.appendChild(t.path(f))},_renderHtmlElement:function(n,i,r){var l=this._renderBackgroundRect(n,i),f,e,c,o,s;if(r.appendChild(l),n.shape.html){var a=n.offsetX-n.width*n.pivot.x,v=n.offsetY-n.height*n.pivot.y,u=document.createElement("div"),h="width:"+n.width+"px;height:"+n.height+"px;padding:1px; opacity:"+n.opacity+";left:"+a+"px; top:"+v+"px; ";t.browserInfo().name==="msie"&&(h+="display: block; position: absolute; border:0px;");f={id:n.name+"_html","class":"foreignObject",style:h};t.datavisualization.Diagram.Util.attr(u,f);n.shape.html instanceof HTMLElement?u.appendChild(n.shape.html):u.innerHTML=n.shape.html.toString();t.browserInfo().name==="msie"?(e=document.createElement("div"),c={id:n.name+"_parentdiv","class":"ej-d-node"},t.datavisualization.Diagram.Util.attr(e,c),e.appendChild(u),o=i.document.parentNode.getElementsByClassName("htmlLayer")[0],o?o.appendChild(e):i.document.parentNode.appendChild(u)):(f={id:n.name+"_shape",width:n.width,height:n.height,style:"pointer-events:none"},s=i.foreignObject(f),s.appendChild(u),r.appendChild(s))}},_initializeGuidelines:function(n,t,i){var r=n.g(t);return i.appendChild(r),r},_renderSideAlignmentLines:function(n,t,i,r,u){var f=r.line({x1:n.x*u,y1:n.y*u,x2:t.x*u,y2:t.y*u,stroke:"#07EDE1","stroke-width":1});i.appendChild(f)},_renderCenterAlignmentLines:function(n,t,i,r,u){var f=r.line({x1:n.x*u,y1:n.y*u,x2:t.x*u,y2:t.y*u,stroke:"#07EDE1","stroke-width":1});i.appendChild(f)},_renderSpacingLines:function(n,t,i,r,u){var e,o,f=r.g({}),s;n.x==t.x?(e="M"+(n.x*u-5)+" "+(n.y*u+5)+" L"+n.x*u+" "+n.y*u+" L"+(n.x*u+5)+" "+(n.y*u+5)+"z",o="M"+(t.x*u-5)+" "+(t.y*u-5)+" L"+t.x*u+" "+t.y*u+" L"+(t.x*u+5)+" "+(t.y*u-5)+"z",f.appendChild(r.line({x1:n.x*u-8,x2:n.x*u+8,y1:n.y*u-1,y2:n.y*u-1,stroke:"#07EDE1","stroke-width":1})),f.appendChild(r.line({x1:t.x*u-8,x2:t.x*u+8,y1:t.y*u+1,y2:t.y*u+1,stroke:"#07EDE1","stroke-width":1}))):(e="M"+(n.x*u+5)+" "+(n.y*u+5)+" L"+n.x*u+" "+n.y*u+" L"+(n.x*u+5)+" "+(n.y*u-5)+"z",o="M"+(t.x*u-5)+" "+(t.y*u-5)+" L"+t.x*u+" "+t.y*u+" L"+(t.x*u-5)+" "+(t.y*u+5)+"z",f.appendChild(r.line({x1:n.x*u-1,x2:n.x*u-1,y1:n.y*u-8,y2:n.y*u+8,stroke:"#07EDE1","stroke-width":1})),f.appendChild(r.line({x1:t.x*u+1,x2:t.x*u+1,y1:t.y*u-8,y2:t.y*u+8,stroke:"#07EDE1","stroke-width":1})));f.appendChild(r.path({d:e,fill:"#07EDE1"}));s=r.line({x1:n.x*u,y1:n.y*u,x2:t.x*u,y2:t.y*u,stroke:"#07EDE1","stroke-width":.6,fill:"#07EDE1"});f.appendChild(s);f.appendChild(r.path({d:o,fill:"#07EDE1"}));i.appendChild(f)},_removeGuidelines:function(n,t){t!=null&&n.removeChild(t)},update:function(n,t){n.isGroup?this.updateGroup(n,t):n.line?this.updateConnector(n,t):this.updateNode(n,t)},updateGroup:function(n,t){var u=t._svg,f=n.children,o=n.visible?"visible":"hidden",r,e,i;for(u.g({id:n.name,visibility:o}),r=0,e=f.length;r<e;r++)i=t.nameTable[f[r]],i.isGroup?this.updateGroup(i,t):i.line?this.updateConnector(i,t):this.updateNode(i,t);this._updateAssociatedConnector(n,t);this._updateLabels(n,u);this._updatePorts(n,u)},updateLabelStyle:function(n,i,r){var u={};n&&r&&i&&(u["font-weight"]=i.bold?"bold":"",u["font-style"]=i.italic?"italic":"",i.textDecoration&&(u["text-decoration"]=i.textDecoration),u["font-family"]=i.fontFamily,u["font-size"]=i.fontSize,u.fill=i.fontColor);t.datavisualization.Diagram.Util.attr(r.getElementById(n.name+"_"+i.name),u)},_updateNodeStyle:function(n,i){var r,u;n&&i&&(r={},r.fill=n.fillColor,r.stroke=n.borderColor,r["stroke-width"]=n.borderWidth,r["stroke-dasharray"]=n.borderDashArray,n.gradient&&(r.fill=this._renderGradient(n.name,n.gradient,i)),u=n.shape.type=="text"?"_backRect":"_shape",t.browserInfo().name==="msie"&&n.shape&&n.shape.type=="html"||t.datavisualization.Diagram.Util.attr(i.getElementById(n.name+u),r))},_updateConnectorStyle:function(n,i){if(n&&i){var r={};r.stroke=n.lineColor;r["stroke-width"]=n.lineWidth;r["stroke-dasharray"]=n.lineDashArray;t.datavisualization.Diagram.Util.attr(i.getElementById(n.name).firstChild,r)}},updateTargetDecoratorStyle:function(n,i){if(i){var r={};r.stroke=n.targetDecorator.borderColor;r.fill=n.targetDecorator.fillColor;t.datavisualization.Diagram.Util.attr(i.getElementById(n.name+"_targetDecorator"),r)}},updateSourceDecoratorStyle:function(n,i){if(i){var r={};r.stroke=n.sourceDecorator.borderColor;r.fill=n.sourceDecorator.fillColor;t.datavisualization.Diagram.Util.attr(i.getElementById(n.name+"_sourceDecorator"),r)}},updateNode:function(n,i){var r,f,u=i._svg;n.shape.type==="html"&&t.browserInfo().name==="msie"?(r=document.getElementById(n.name+"_html").getBoundingClientRect(),f={x:r.left,y:r.top,width:r.width,height:r.height}):(r=u.getElementById(n.name+"_shape"),f=r.getBBox());this._updateNode(n,u);this._updateNodeStyle(n,u);this._updateAssociatedConnector(n,i);i.activeTool.inAction&&(i.activeTool.name==="move"||i.activeTool.name==="rotate")||(this._updateLabels(n,u),(f.width!=n.width||f.height!=n.height)&&this._updatePorts(n,u))},updateTextBlock:function(n,i,r){var u={},i=n.shape.textBlock;n.shape.textBlock=i;n&&r&&i&&(u["font-weight"]=i.bold?"bold":"",u["font-style"]=i.italic?"italic":"",i.textDecoration&&(u["text-decoration"]=i.textDecoration),u["font-family"]=i.fontFamily,u["font-size"]=i.fontSize,u.fill=i.fontColor);t.datavisualization.Diagram.Util.attr(r.getElementById(n.name+"_shape"),u);this._updateTextElement(n,r)},_updateAssociatedConnector:function(n,t){for(var i=0,r=n.inEdges.length;i<r;i++)this.updateConnector(t.nameTable[n.inEdges[i]],t);for(i=0,r=n.outEdges.length;i<r;i++)this.updateConnector(t.nameTable[n.outEdges[i]],t)},_updateNode:function(n,i){var e=n.offsetX-n.width*n.pivot.x,o=n.offsetY-n.height*n.pivot.y,s=n.rotateAngle,u=t.datavisualization.Diagram.Point(n.offsetX,n.offsetY),h=n.visible?"visible":"hidden",c={id:n.name,transform:"rotate("+s+","+u.x+","+u.y+"),translate("+e+","+o+")",visibility:h},f;i.g(c);switch(n.shape.type){case"rectangle":i.rect({id:n.name+"_shape",width:n.width,height:n.height});break;case"ellipse":i.ellipse({id:n.name+"_shape",rx:n.width/2,ry:n.height/2,cx:n.width/2,cy:n.height/2});break;case"image":this._updateBackgroundRect(n,i);i.image({id:n.name+"_shape",width:n.width,height:n.height});break;case"path":f=this._updatePath(0,0,n.width,n.height,n.shape.pathData,i);i.path({id:n.name+"_shape",d:f});break;case"polygon":this._updatePolygon(n,i);break;case"text":this._updateTextElement(n,i);break;case"html":this._updateHtmlElement(n,i);break;case"native":var r=n.shape.content.getBBox(),l=r.width?n.width/r.width:1,a=r.height?n.height/r.height:1;i.g({id:n.name+"_shape",width:n.width,height:n.height,transform:"scale("+l+","+a+")"})}},_updateHtmlElement:function(n,i){var r,u,f;this._updateBackgroundRect(n,i);t.browserInfo().name==="msie"?(u=n.offsetX-n.width*n.pivot.x,f=n.offsetY-n.height*n.pivot.y,r=document.getElementById(n.name+"_html"),r.style.left=u+"px",r.style.top=f+"px",r.style.transform="rotate("+n.rotateAngle+"deg)"):(r=i.getElementById(n.name+"_shape"),i.foreignObject({id:n.name,width:n.width,height:n.height}));r.style.width=n.width.toString()+"px";r.style.height=n.height.toString()+"px"},_updatePolygon:function(n,t){this._updatePolygonPoints(n);t.polygon({id:n.name+"_shape",points:this._convertToSVGPoints(n.shape.points)})},_updatePolygonPoints:function(n){var i,f,r,e,u;if(n.shape.points)for(i=n.shape.points,this._scalePoints(i,n),f=t.datavisualization.Diagram.Geometry.rect(i),r=0,e=i.length;r<e;++r)u=t.datavisualization.Diagram.Geometry.translate(i[r],-f.x,-f.y),u=t.datavisualization.Diagram.Geometry.translate(u,0,0),i[r]=u},_convertToSVGPoints:function(n){for(var i="",t=0,r=n.length;t<r;t++)i+=n[t].x+","+n[t].y+" ";return i.trim()},_scalePoints:function(n,i){var u=t.datavisualization.Diagram.Geometry.rect(n),f,e,r,o;if(u.width>0&&u.height>0)for(f=i.width/u.width,e=i.height/u.height,r=0,o=n.length;r<o;++r)n[r].x=n[r].x*f,n[r].y=n[r].y*e},_renderTextElement:function(n,i,r){var u=n.shape.textBlock,s,e,f,o;u&&(s=this._renderBackgroundRect(n,i),r.appendChild(s),e={id:n.name+"_shape","class":"ej-d-label","font-family":u.fontFamily,"font-size":u.fontSize,fill:u.fontColor,"text-decoration":u.textDecoration,opacity:n.opacity,"alignment-baseline":"middle"},u.bold&&(e["font-weight"]="bold"),u.italic&&(e["font-style"]="italic"),f=i.text(e),f.appendChild(document.createTextNode(u.text)),r.appendChild(f),o=t.datavisualization.Diagram.Util.bounds(n),this._wrapText(n,o,f,n.shape.textBlock,i),this._alignTextOnLabel(n,o,f,n.shape.textBlock,i))},_updateTextElement:function(n,i){this._updateBackgroundRect(n,i);var r=i.getElementById(n.name+"_shape"),u=t.datavisualization.Diagram.Util.bounds(n);this._wrapText(n,u,r,n.shape.textBlock,i);this._alignTextOnLabel(n,u,r,n.shape.textBlock,i)},_renderBackgroundRect:function(n,t){var i=this._fill(n,t),r={id:n.name+"_backRect","class":"backrect",x:0,y:0,width:n.width,height:n.height,fill:i,stroke:n.borderColor,"stroke-width":n.borderWidth,opacity:n.opacity,"stroke-dasharray":n.borderDashArray};return t.rect(r)},_updateBackgroundRect:function(n,t){var i={id:n.name+"_backRect",x:0,y:0,width:n.width,height:n.height};t.rect(i)},_updatePath:function(n,t,i,r,u,f){var e;e=f.pathBounds(u);var o=0,s=0,h=!1;return(n.toString()!==e.x||t.toString()!==e.y)&&(o=n-Number(e.x),s=t-Number(e.y)),(i!==e.width||r!==e.height)&&(o=i/Number(e.width),s=r/Number(e.height),h=!0),this._processPathData(u,o,s,h,e.x,e.y,n,t,!0,f)},_processPathData:function(n,t,i,r,u,f,e,o,s,h){var v=document.createElementNS("http://www.w3.org/2000/svg","path"),it,rt,w,b,k,d,y,c,g,nt,tt;v.setAttribute("d",n);s&&(n=h.absolutePath(v).getAttribute("d"),v.setAttribute("d",n));y=v.pathSegList;for(var l=0,a=0,p=0,ut=y.numberOfItems;p<ut;++p){c=y.getItem(p);g=c.pathSegTypeAsLetter;"x1"in c&&(w=c.x1);"x2"in c&&(k=c.x2);"y1"in c&&(b=c.y1);"y2"in c&&(d=c.y2);"x"in c&&(l=c.x);"y"in c&&(a=c.y);r?(l!=undefined&&(l=this._scalePathData(l,t,u,e)),a!=undefined&&(a=this._scalePathData(a,i,f,o)),w!=undefined&&(w=this._scalePathData(w,t,u,e)),b!=undefined&&(b=this._scalePathData(b,i,f,o)),k!=undefined&&(k=this._scalePathData(k,t,u,e)),d!=undefined&&(d=this._scalePathData(d,i,f,o))):(l!=undefined&&(l=l+t),a!=undefined&&(a=a+i),w!=undefined&&(w=w+t),b!=undefined&&(b=b+i),k!=undefined&&(k=k+t),d!=undefined&&(d=d+i));switch(g){case"M":y.replaceItem(v.createSVGPathSegMovetoAbs(l,a),p);break;case"L":y.replaceItem(v.createSVGPathSegLinetoAbs(l,a),p);break;case"H":y.replaceItem(v.createSVGPathSegLinetoHorizontalAbs(l),p);break;case"V":y.replaceItem(v.createSVGPathSegLinetoVerticalAbs(a),p);break;case"C":y.replaceItem(v.createSVGPathSegCurvetoCubicAbs(l,a,w,b,k,d),p);break;case"S":y.replaceItem(v.createSVGPathSegCurvetoCubicSmoothAbs(l,a,k,d),p);break;case"Q":y.replaceItem(v.createSVGPathSegCurvetoQuadraticAbs(l,a,w,b),p);break;case"T":y.replaceItem(v.createSVGPathSegCurvetoQuadraticSmoothAbs(l,a),p);break;case"A":nt=c.r1;tt=c.r2;r&&(nt=nt*t,tt=tt*i);y.replaceItem(v.createSVGPathSegArcAbs(l,a,nt,tt,c.angle,c.largeArcFlag,c.sweepFlag),p);break;case"Z":l=it;a=rt}(g==="M"||g==="m")&&(it=l,rt=a)}return v.getAttribute("d")},_scalePathData:function(n,t,i,r){return n!==i?n=r!==i?n*t-(Number(i)*t-Number(i))+(r-Number(i)):Number(n)*t-(Number(i)*t-Number(i)):r!==i&&(n=r),n},setNodeShape:function(t,i,r){var u,f;r?(f=i.getElementById(r.name),u=n(f).find("#"+t.name)[0]):u=i.getElementById(t.name);n(u).empty();this._renderNode(t,i,u)},setLine:function(t,i,r){var u,f;r?(f=i.getElementById(r.name),u=n(f).find("#"+t.name)[0]):u=i.getElementById(t.name);n(u).empty();this.renderConnector(t,i,u)},addNodeLabel:function(t,i,r,u){var f,e;u?(e=r.getElementById(u.name),f=n(e).find("#"+t.name)[0]):f=r.getElementById(t.name);this._renderLabel(t,i,r,f)},renderConnector:function(n,t,i){var u,e,h=n.visible?"visible":"hidden",r,s,f,o;return u=t.g({id:n.name,"class":"ej-d-connector",visibility:h}),i?i.id!==u.id&&i.appendChild(u):t.appendChild(u),r={id:n.name+"_line",fill:"none",stroke:n.lineColor,"stroke-width":n.lineWidth,"stroke-dasharray":n.lineDashArray,opacity:n.opacity},n.line.type!="bezier"?(s=this._clipDecorators(n),r.points=this._convertToSVGPoints(s),e=t.polyline(r),u.appendChild(e),r={id:r.id+"_hitTest","stroke-width":n.lineHitPadding,points:r.points,"pointer-events":"stroke",visibility:"hidden"},e=t.polyline(r),u.appendChild(e)):(f=n.line,o="M"+f.startPoint.x+" "+f.startPoint.y+" C"+f._point1.x+" "+f._point1.y+" "+f._point2.x+" "+f._point2.y+" "+f.endPoint.x+" "+f.endPoint.y,r={id:n.name+"_line",d:o,fill:"none",stroke:n.lineColor,"stroke-width":n.lineWidth,"stroke-dasharray":n.lineDashArray,opacity:n.opacity},e=t.path(r),u.appendChild(e),r={id:r.id+"_hitTest","stroke-width":n.lineHitPadding,d:o,"pointer-events":"stroke",visibility:"hidden"},e=t.path(r),u.appendChild(e)),this._renderLabels(n,t,u),this._renderDecorators(n,t,u),u},_clipDecorators:function(i){var r,e,f=n.extend(!0,[],i.line.points),u,s,o;return i.targetDecorator&&i.targetDecorator.shape!==t.datavisualization.Diagram.DecoratorShapes.None&&(r=f[f.length-1],e=f[f.length-2],u=t.datavisualization.Diagram.Geometry.distance(r,e),u=u==0?1:u,s=i.targetDecorator.width,o=t.datavisualization.Diagram.Point(),o.x=r.x+s*(e.x-r.x)/u,o.y=r.y+s*(e.y-r.y)/u,f[f.length-1]=o),i.sourceDecorator&&i.sourceDecorator.shape!==t.datavisualization.Diagram.DecoratorShapes.None&&(r=f[0],e=f[1],u=t.datavisualization.Diagram.Geometry.distance(r,e),u=u==0?1:u,s=i.sourceDecorator.width,o=t.datavisualization.Diagram.Point(),o.x=r.x+s*(e.x-r.x)/u,o.y=r.y+s*(e.y-r.y)/u,f[0]=o),f},_updateConnector:function(n,t){var r,i,u;n.line.type!="bezier"?(r=this._clipDecorators(n),t.polyline({id:n.name+"_line",points:this._convertToSVGPoints(r)}),t.polyline({id:n.name+"_line_hitTest",points:this._convertToSVGPoints(r)})):(i=n.line,u="M"+i.startPoint.x+" "+i.startPoint.y+" C"+i._point1.x+" "+i._point1.y+" "+i._point2.x+" "+i._point2.y+" "+i.endPoint.x+" "+i.endPoint.y,t.path({id:n.name+"_line",d:u}),t.path({id:n.name+"_line_hitTest",d:u}));this._updateConnectorStyle(n,t)},updateConnector:function(n,t){var i=t._svg,r=n.visible?"visible":"hidden";i.g({id:n.name,visibility:r});this._updateConnector(n,i);this._updateLabels(n,i);this._updateDecorators(n,i)},renderDecorators:function(n,t){var i=t.getElementById(n.name);this._renderDecorators(n,t,i)},clearDecorators:function(n,t){this._updateConnector(n,t);var r=t.getElementById(n.name),i=t.getElementById(n.name+"_targetDecorator");i&&t.removeChild(i,r);i=t.getElementById(n.name+"_sourceDecorator");i&&t.removeChild(i,r)},_renderDecorators:function(n,t,i){var r,u;n.targetDecorator&&n.targetDecorator.shape&&(r=n.line.points[n.line.points.length-2],u=n.line.endPoint,n.line.type=="bezier"&&(r=n.line._point2),this._renderDecorator(n.name+"_targetDecorator",u,r,n.targetDecorator,t,i));n.sourceDecorator&&n.sourceDecorator.shape&&(r=n.line.startPoint,u=n.line.points[1],n.line.type=="bezier"&&(u=n.line._point1),this._renderDecorator(n.name+"_sourceDecorator",r,u,n.sourceDecorator,t,i))},_renderDecorator:function(n,i,r,u,f,e){var h,s,c,o=t.datavisualization.Diagram.Size(u.width,u.height),l,a;switch(u.shape){case"arrow":c=this._constructArrow(i,o);s={id:n,"class":"decorator",d:c,fill:u.fillColor,stroke:u.borderColor};h=f.path(s);break;case"openarrow":c=this._constructArrow(i,o,!0);s={id:n,"class":"decorator",d:c,fill:"transparent",stroke:u.borderColor};h=f.path(s);break;case"circle":l=o.width/2;a=o.height/2;s={id:n,"class":"decorator",rx:l,ry:a,cx:i.x+o.width/2,cy:i.y,fill:u.fillColor,stroke:u.borderColor};h=f.ellipse(s);break;case"diamond":c=this._constructDiamond(i,o,f);s={id:n,"class":"decorator",x:i.x,y:i.y,width:o.width,height:o.height,d:c,fill:u.fillColor,stroke:u.borderColor};h=f.path(s);break;case"path":c=this._updatePath(i.x,i.y-o.height/2,o.width,o.height,u.pathData,f);s={id:n,"class":"decorator",x:i.x,y:i.y,width:o.width,height:o.height,d:c,fill:u.fillColor,stroke:u.borderColor};h=f.path(s)}h&&(h.setAttribute("transform","rotate("+t.datavisualization.Diagram.Geometry.findAngle(i,r)+" "+i.x+" "+i.y+")"),e.appendChild(h))},_updateDecorators:function(n,i){var r,u;n.targetDecorator&&n.targetDecorator.shape!==t.datavisualization.Diagram.DecoratorShapes.None&&(r=n.line.points[n.line.points.length-2],u=n.line.endPoint,n.line.type=="bezier"&&(r=n.line._point2),this._updateDecorator(n.name+"_targetDecorator",u,r,n.targetDecorator,i));n.sourceDecorator&&n.sourceDecorator.shape!==t.datavisualization.Diagram.DecoratorShapes.None&&(r=n.line.startPoint,u=n.line.points[1],n.line.type=="bezier"&&(u=n.line._point1),this._updateDecorator(n.name+"_sourceDecorator",r,u,n.sourceDecorator,i))},_updateDecorator:function(n,i,r,u,f){var h,o,s,e=t.datavisualization.Diagram.Size(u.width,u.height),c,l;switch(u.shape){case"arrow":s=this._constructArrow(i,e);o={id:n,d:s};h=f.path(o);break;case"openarrow":s=this._constructArrow(i,e,!0);o={id:n,d:s};h=f.path(o);break;case"circle":c=e.width/2;l=e.height/2;o={id:n,rx:c,ry:l,cx:i.x+e.width/2,cy:i.y};h=f.ellipse(o);break;case"diamond":s=this._constructDiamond(i,e,f);o={id:n,x:i.x,y:i.y,width:e.width,height:e.height,d:s};h=f.path(o);break;case"path":s=this._updatePath(i.x,i.y-e.height/2,e.width,e.height,u.pathData,f);o={id:n,x:i.x,y:i.y,width:e.width,height:e.height,d:s};h=f.path(o)}h&&h.setAttribute("transform","rotate("+t.datavisualization.Diagram.Geometry.findAngle(i,r)+" "+i.x+" "+i.y+")")},_constructArrow:function(n,i,r){var u=new t.datavisualization.Diagram.Path;return u.moveTo(n.x+i.width,n.y+i.height/2),u.lineTo(n.x,n.y),u.lineTo(n.x+i.width,n.y-i.height/2),r||u.close(),u.toString()},_constructDiamond:function(n,i){var r=new t.datavisualization.Diagram.Path;return r.moveTo(n.x+i.width,n.y),r.lineTo(n.x+i.width/2,n.y+i.height/2),r.lineTo(n.x,n.y),r.lineTo(n.x+i.width/2,n.y-i.height/2),r.lineTo(n.x+i.width,n.y),r.toString()},_renderLabels:function(n,t,i){for(var u=n.labels,r=0,f=u.length;r<f;++r)this._renderLabel(n,u[r],t,i)},_renderLabelBackground:function(n,i,r,u){var f,e;return f=t.browserInfo().name==="mozilla"?r.getBoundingClientRect():r.getBBox(),e={id:i.name+"_"+n.name+"_lblbg",width:f.width,height:f.height,fill:n.fillColor,stroke:n.borderColor,"stroke-width":n.borderWidth,transform:"translate(0,0)"},u.rect(e)},_renderLabel:function(n,i,r,u){var e={id:n.name+"_"+i.name,"class":"ej-d-label","font-family":i.fontFamily,"font-size":i.fontSize,fill:i.fontColor,"text-decoration":i.textDecoration,"dominant-baseline":"middle","pointer-events":"none"},f,s,o;i.bold&&(e["font-weight"]="bold");i.italic&&(e["font-style"]="italic");f=r.text(e);f.textContent=i.text;u.appendChild(f);s=this._renderLabelBackground(i,n,f,r);u.insertBefore(s,f);o=t.datavisualization.Diagram.Util.bounds(n);this._wrapText(n,o,f,i,r);this._alignTextOnLabel(n,o,f,i,r)},_updateLabels:function(n,i){for(var r,u,e,o=n.labels,f=0,s=o.length;f<s;++f)r=o[f],u=i.getElementById(n.name+"_"+r.name),u.setAttribute("fill",r.fontColor),e=t.datavisualization.Diagram.Util.bounds(n),this._wrapText(n,e,u,r,i),this._alignTextOnLabel(n,e,u,r,i)},updateLabel:function(n,i,r){var u=r.getElementById(n.name+"_"+i.name),f;u.setAttribute("fill",i.fontColor);u.textContent=i.text;f=t.datavisualization.Diagram.Util.bounds(n);this._wrapText(n,f,u,i,r);this._alignTextOnLabel(n,f,u,i,r)},_alignTextOnLabel:function(n,i,r,u,f){var s=r.getBBox(),o=t.datavisualization.Diagram.Util._getLabelPosition(u,i),e={x:0,y:0},h=0,c,l,a;h=u.verticalAlignment==t.datavisualization.Diagram.VerticalAlignment.Top?u.margin.top+o.y:u.verticalAlignment==t.datavisualization.Diagram.VerticalAlignment.Center?o.y-s.height/2:o.y-s.height-u.margin.bottom;e.y=h;switch(u.horizontalAlignment){case t.datavisualization.Diagram.HorizontalAlignment.Left:switch(u.textAlign){case t.datavisualization.Diagram.TextAlign.Left:e.x=o.x+u.margin.left;break;case t.datavisualization.Diagram.TextAlign.Center:e.x=o.x+s.width/2+u.margin.left;break;case t.datavisualization.Diagram.TextAlign.Right:e.x=o.x+s.width+u.margin.left}break;case t.datavisualization.Diagram.HorizontalAlignment.Center:switch(u.textAlign){case t.datavisualization.Diagram.TextAlign.Left:e.x=o.x-s.width/2;break;case t.datavisualization.Diagram.TextAlign.Center:e.x=o.x;break;case t.datavisualization.Diagram.TextAlign.Right:e.x=o.x+s.width/2}break;case t.datavisualization.Diagram.HorizontalAlignment.Right:switch(u.textAlign){case t.datavisualization.Diagram.TextAlign.Left:e.x=o.x-s.width-u.margin.right;break;case t.datavisualization.Diagram.TextAlign.Center:e.x=o.x-s.width/2-u.margin.right;break;case t.datavisualization.Diagram.TextAlign.Right:e.x=o.x-u.margin.right}}(n.line||n.isGroup)&&(e.x=e.x+i.x,e.y=e.y+i.y);r.setAttribute("transform","translate("+e.x+","+e.y+")");c=f.getElementById(n.name+"_"+u.name+"_lblbg");c&&(l=e.x+s.x,h=e.y,t.browserInfo().name==="mozilla"&&(h=e.y+u.fontSize/2),a={width:s.width,height:s.height,transform:"translate("+l+","+h+")",fill:u.fillColor,stroke:u.borderColor,"stroke-width":u.borderWidth},t.datavisualization.Diagram.Util.attr(c,a))},_wrapText:function(n,t,i,r,u){for(var v=r.text,h,a,o,f,e,y,p,c,l,s;i.hasChildNodes();)i.removeChild(i.lastChild);for(n.line?(h=t.width,a=t.height):(h=t.width-r.margin.left-r.margin.right,a=t.height-r.margin.top-r.margin.bottom),h=h<r.width?r.width:h,o=v.split("\n"),y="",c=u.getElementById(i.id).childNodes,e=0;e<o.length;e++)for(f=u.tspan(),f.style.fontSize=r.fontSize,i.appendChild(f),s=0;s<o[e].length;s++)l=c[c.length-1].getComputedTextLength(),r.wrapText?l>=h-r.fontSize?(f.textContent+=o[e][s],p=-l,s==o[e].length-1||(f=u.tspan(),i.appendChild(f))):f.textContent+=o[e][s]:f.textContent+=o[e][s];this._wrapTextAlign(i,c,r.fontSize,r.textAlign)},_wrapTextAlign:function(n,i,r,u){for(var f,o,s,e=0;e<i.length;e++){f=i[e].getComputedTextLength();switch(u){case"left":f=0;break;case"center":f=-f/2;break;case"right":f=-f}o={x:Number(f),dy:r};s=i[e];t.datavisualization.Diagram.Util.attr(s,o)}},_renderPorts:function(n,i,r){for(var e,o=n.ports,u,f=0,s=o.length;f<s;++f)u=o[f],e=this._renderPort(n,u,i),r.appendChild(e),(u.visibility&t.datavisualization.Diagram.PortVisibility.Hidden||u.visibility&t.datavisualization.Diagram.PortVisibility.Hover||u.visibility&t.datavisualization.Diagram.PortVisibility.Connect)&&e.setAttribute("visibility","hidden")},_renderPort:function(n,i,r){var e,u,o=t.datavisualization.Diagram.Size(i.size,i.size),f=t.datavisualization.Diagram.Util._getPortPosition(i,t.datavisualization.Diagram.Util.bounds(n,!0),!0),s,h,c;switch(i.shape){case"x":s=this._constructX(f,i.size);u={id:n.name+"_"+i.name,"class":"ej-d-port",fill:i.fillColor,stroke:i.borderColor,"stroke-width":i.borderWidth,d:s};e=r.path(u);break;case"circle":h=o.width/2;c=o.height/2;u={id:n.name+"_"+i.name,"class":"ej-d-port",rx:h,ry:c,cx:f.x,cy:f.y,fill:i.fillColor,stroke:i.borderColor,"stroke-width":i.borderWidth};e=r.ellipse(u);break;case"square":u={id:n.name+"_"+i.name,"class":"ej-d-port",x:f.x-i.size/2,y:f.y-i.size/2,width:o.width,height:o.height,fill:i.fillColor,stroke:i.borderColor,"stroke-width":i.borderWidth};e=r.rect(u)}return e},_updatePort:function(n,i,r){var e=t.datavisualization.Diagram.Size(i.size,i.size),u=t.datavisualization.Diagram.Util._getPortPosition(i,t.datavisualization.Diagram.Util.bounds(n,!0),!0),f=n.name+"_"+i.name,o,s,h;switch(i.shape){case"x":o=this._constructX(u,i.size);r.path({id:f,d:o});break;case"circle":s=e.width/2;h=e.height/2;r.ellipse({id:f,rx:s,ry:h,cx:u.x,cy:u.y});break;case"square":r.rect({id:f,x:u.x-i.size/2,y:u.y-i.size/2})}},_updatePorts:function(n,t){for(var u,r=n.ports,i=0,f=r.length;i<f;++i)u=r[i],this._updatePort(n,u,t)},_constructX:function(n,i){var r=new t.datavisualization.Diagram.Path;return r.moveTo(n.x-i/2,n.y-i/2),r.lineTo(n.x+i/2,n.y+i/2),r.moveTo(n.x+i/2,n.y-i/2),r.lineTo(n.x-i/2,n.y+i/2),r.toString()},_drawPortHighlighter:function(n,i,r,u,f){var l,o,e,h,c,a,s,v="#8CC63F",w="#1A1A1A",b=.5,y,p,k;return n?(o=t.datavisualization.Diagram.Size(n.size*2,n.size*2),e=t.datavisualization.Diagram.Util._getPortPosition(n,t.datavisualization.Diagram.Util.bounds(i,!0)),p=t.Matrix.identity(),t.Matrix.rotate(p,i.rotateAngle,i.offsetX,i.offsetY),e=t.Matrix.transform(p,e),h=(e.x-n.size)*f,c=(e.y-n.size)*f,a="rotate(0,"+(h+o.width/2)+","+(c+o.height/2)+")"):(s=t.datavisualization.Diagram.Util.bounds(i,!0),o=t.datavisualization.Diagram.Size(s.width,s.height),e=t.datavisualization.Diagram.Point(s.x,s.y),h=e.x*f,c=e.y*f,w=v,v="transparent",b=2,y=t.datavisualization.Diagram.Point(i.offsetX-i.width*i.pivot.x+i.width/2,i.offsetY-i.height*i.pivot.y+i.height/2),a="rotate("+i.rotateAngle+","+y.x*f+","+y.y*f+")"),k={id:"portHighlighter","class":"ej-d-port",x:h,y:c,width:o.width*f,height:o.height*f,fill:v,stroke:w,"stroke-width":b,"pointer-events":"none",transform:a},l=r.rect(k),u.appendChild(l),l},_removePortHighlighter:function(n,t){var i=n.getElementById("portHighlighter");i&&n.removeChild(i,t)},renderSelector:function(n,t,i,r,u){var f;n.line?(f=t.g({id:t.document.id+"handle_g","class":"handle"}),i.appendChild(f),this._renderEndPointHandle(n,t,r)):(f=t.g({id:t.document.id+"handle_g","class":"handle",transform:"translate("+(n.offsetX-n.width/2)*r+","+(n.offsetY-n.height/2)*r+"),rotate("+n.rotateAngle+","+n.width/2*r+","+n.height/2*r+")"}),i.appendChild(f),this._renderResizeHandle(n,t,r,u))},_renderResizeHandle:function(n,i,r,u){var f=t.datavisualization.Diagram.Point(n.width/2,-20/r);u&t.datavisualization.Diagram.SelectorConstraints.Rotator&&(this._renderPivotLine(n,i,r),this._renderRotateThumb("rotate",n,f.x,f.y,r,i));u&t.datavisualization.Diagram.SelectorConstraints.Resizer&&(this._renderResizeBorder("resizeBorder",n,i,r),this._renderResizeCorner("nw-resize",n,0,0,i),this._renderResizeCorner("n-resize",n,n.width/2*r,0,i),this._renderResizeCorner("ne-resize",n,n.width*r,0,i),this._renderResizeCorner("w-resize",n,0,n.height/2*r,i),this._renderResizeCorner("e-resize",n,n.width*r,n.height/2*r,i),this._renderResizeCorner("sw-resize",n,0,n.height*r,i),this._renderResizeCorner("s-resize",n,n.width/2*r,n.height*r,i),this._renderResizeCorner("se-resize",n,n.width*r,n.height*r,i))},renderUserHandles:function(n,t,i,r,u,f){for(var e=0;e<n.length;e++)(r&&n[e].enableMultiSelection||!r)&&n[e].visible&&this._renderUserHandle(n[e],t,i,u,f)},_renderUserHandle:function(n,t,i,r,u){var e=i.g({id:i.document.id+"userHandle_g","class":"userHandle"});u.appendChild(e);var f=this._getHandlePosition(n,t,r),o=this._updatePath(f.x*r-n.size/4,f.y*r-n.size/4,n.size/2,n.size/2,n.pathData,i),s=this._getHandleShape(n,f.x*r,f.y*r),h=this._getHandleIcon(n,o,f.x,f.y);e.appendChild(i.circle(s));e.appendChild(i.path(h))},_getHandleIcon:function(n,t){return{id:n.name+"_icon","class":"userHandle-icon",d:t,fill:n.pathColor}},_getHandlePosition:function(n,i,r){var f=t.datavisualization.Diagram.Point(),e=t.datavisualization.Diagram.Util.bounds(i),h=n.position,o=10,s=t.Matrix.identity(),u;i.rotateAngle&&t.Matrix.rotate(s,i.rotateAngle);u=new t.datavisualization.Diagram.Point;switch(h){case"topleft":u=t.Matrix.transform(s,t.datavisualization.Diagram.Point(o+n.size/2,o+n.size/2));f.x=e.topLeft.x-u.x/r;f.y=e.topLeft.y-u.y/r;break;case"topcenter":u=t.Matrix.transform(s,t.datavisualization.Diagram.Point(0,o+n.size/2));f.x=e.topCenter.x-u.x/r;f.y=e.topCenter.y-u.y/r;break;case"topright":u=t.Matrix.transform(s,t.datavisualization.Diagram.Point(o+n.size/2,o/2-n.size));f.x=e.topRight.x+u.x/r;f.y=e.topRight.y+u.y/r;break;case"middleleft":u=t.Matrix.transform(s,t.datavisualization.Diagram.Point(-(o+n.size/2),0));f.x=e.middleLeft.x+u.x/r;f.y=e.middleLeft.y+u.y/r;break;case"middleright":u=t.Matrix.transform(s,t.datavisualization.Diagram.Point(o+n.size/2,0));f.x=e.middleRight.x+u.x/r;f.y=e.middleRight.y+u.y/r;break;case"bottomleft":u=t.Matrix.transform(s,t.datavisualization.Diagram.Point(-(o+n.size/2),o+n.size/2));f.x=e.bottomLeft.x+u.x/r;f.y=e.bottomLeft.y+u.y/r;break;case"bottomcenter":u=t.Matrix.transform(s,t.datavisualization.Diagram.Point(0,o/2-n.size));f.x=e.bottomCenter.x-u.x/r;f.y=e.bottomCenter.y-u.y/r;break;case"bottomright":u=t.Matrix.transform(s,t.datavisualization.Diagram.Point(o+n.size/2,o+n.size/2));f.x=e.bottomRight.x+u.x/r;f.y=e.bottomRight.y+u.y/r}return f},_getHandleShape:function(n,t,i){return{id:n.name+"_shape","class":"userHandle",cx:t,cy:i,r:n.size/2,fill:n.backgroundColor,stroke:n.borderColor,"stroke-width":n.borderWidth,title:n.name}},_updateHandleShape:function(n,t,i,r){var u={id:n.name+"_shape",cx:t,cy:i};r.circle(u)},_updateHanleIcon:function(n,t,i){var r={id:n.name+"_icon",d:t};i.path(r)},_getHanleIcon:function(n,t){return{id:n.name,d:t,stroke:n.borderColor,"stroke-width":n.borderWidth,fill:n.fillColor}},renderPivotPoint:function(n,i,r){r.getElementById("pivot")||(t.datavisualization.Diagram.SvgContext._renderResizeCorner("pivot",n,n.offsetX*i,n.offsetY*i,r),this._updatePivotLine(n,r,i))},_renderPivotLine:function(n,i,r){var u=t.datavisualization.Diagram.Point(n.width/2,-20/r),f=t.datavisualization.Diagram.Point(n.width/2,0),e=i.getElementById(i.document.id+"handle_g"),o=i.line({id:"pivotLine",x1:u.x*r,y1:u.y*r,x2:f.x*r,y2:f.y*r,stroke:"black","stroke-width":1,"stroke-dasharray":"2,3",fill:"none"});e.appendChild(o)},_renderResizeBorder:function(n,t,i,r){var u=i.getElementById(i.document.id+"handle_g"),f=i.rect({id:n,width:t.width*r,height:t.height*r,stroke:"#097F7F","stroke-width":.6,"stroke-dasharray":"6,3",fill:"none"});u.appendChild(f)},_renderResizeCorner:function(n,i,r,u,f){var o=f.getElementById(f.document.id+"handle_g"),s="white",e;t.datavisualization.Diagram.Util.canResize(i)||(s="darkgray");e={id:n,fill:s,stroke:"black","stroke-width":1,cx:r,cy:u,r:7};o.appendChild(f.circle(e));e={id:n+"_transparent","class":n,fill:"transparent",cx:r,cy:u,r:10};o.appendChild(f.circle(e))},_renderRotateThumb:function(n,i,r,u,f,e){var h=e.getElementById(e.document.id+"handle_g"),c="#231f20";t.datavisualization.Diagram.Util.canRotate(i)||(c="darkgray");var o=20,s=20,l={id:"rotatehandle","class":n,fill:c,stroke:"black","stroke-width":.5,width:o,height:s,d:"M 16.856 10.239 L 18 3.438 l -2.189 0.817 c -0.974 -1.694 -2.482 -2.995 -4.326 -3.696 C 9.375 -0.245 7.071-0.18 5.01 0.744 C 2.942 1.668 1.365 3.342 0.558 5.453 c -0.803 2.115 -0.738 4.414 0.185 6.478 c 0.925 2.064 2.6 3.645 4.714 4.45 c 0.969 0.371 1.993 0.554 3.013 0.554 c 1.345 0 2.685 -0.317 3.897 -0.948 l -1.016 -1.962 c -1.584 0.822-3.445 0.929 -5.114 0.293 c -1.56 -0.596 -2.793 -1.762 -3.479 -3.289 C 2.078 9.502 2.031 7.803 2.622 6.244 C 3.216 4.68 4.387 3.443 5.914 2.761 C 7.437 2.079 9.137 2.03 10.7 2.626 c 1.246 0.475 2.271 1.328 2.986 2.424 L 11.54 5.851 L 16.856 10.239 Z",transform:"translate("+(r*f-o/2)+","+(u*f-s)+")"},a=e.path(l),v=e.circle({id:"rotate","class":n,fill:"transparent",stroke:"none",cx:o/2,cy:s/2,r:13,transform:"translate("+(r*f-o/2)+","+(u*f-s)+")"});h.appendChild(a);h.appendChild(v)},_renderEndPointHandle:function(n,i,r){var f,e,u;n.line.type=="bezier"&&(f=n.line,e=t.datavisualization.Diagram.Util.canDragSegmentThumbs(n),this._renderBezierLine("bezierline1",n.line.startPoint,n.line._point1,r,i),this._renderBezierLine("bezierline2",n.line.endPoint,n.line._point2,r,i),this._renderEndPointCorner("bezierpoint1",f._point1.x*r,f._point1.y*r,!1,i,e),this._renderEndPointCorner("bezierpoint2",f._point2.x*r,f._point2.y*r,!1,i,e));u=n.line.points;this._renderEndPointCorner("targetEndPoint",u[u.length-1].x*r,u[u.length-1].y*r,t.datavisualization.Diagram.Util.isTargetConnected(n),i,t.datavisualization.Diagram.Util.canDragTargetEnd(n));this._renderEndPointCorner("sourceEndPoint",u[0].x*r,u[0].y*r,t.datavisualization.Diagram.Util.isSourceConnected(n),i,t.datavisualization.Diagram.Util.canDragSourceEnd(n))},_renderEndPointCorner:function(n,t,i,r,u,f){var s=u.getElementById(u.document.id+"handle_g"),e=r?"#8CC63F":"white",o;f||(e="darkgray");o={id:n,"class":n,fill:e,stroke:"black","stroke-width":2,cx:t,cy:i,r:7};s.appendChild(u.circle(o))},_renderBezierLine:function(n,t,i,r,u){var f=u.line({id:n,x1:t.x*r,y1:t.y*r,x2:i.x*r,y2:i.y*r,stroke:"black","stroke-width":1,"stroke-dasharray":"3,3",fill:"none"}),e=u.getElementById(u.document.id+"handle_g");e.appendChild(f)},_renderControlPointCorner:function(n,t,i,r){var u=r.g({"class":n}),f;r.getElementById(r.document.id+"handle_g").appendChild(u);f={id:n+"_"+i,fill:"white",stroke:"black","stroke-width":2,cx:t.x,cy:t.y,r:5};u.appendChild(r.circle(f))},_removePivotPoint:function(n,t,i){var r=t.getElementById(t.document.id+"handle_g");r!=null&&t.getElementById("pivot")&&(r.removeChild(t.getElementById("pivot")),this._updatePivotLine(n,t,i))},updateSelector:function(n,i,r,u,f){var o,e;n.line?(this._updateEndPointHandle(n,i,r),f&t.datavisualization.Diagram.SelectorConstraints.UserHandles&&this.updateUserHandles(u.model.userHandles,n,i,!1,!1,r)):(o=i.g({id:i.document.id+"handle_g",transform:"translate("+(n.offsetX-n.width/2)*r+","+(n.offsetY-n.height/2)*r+"),rotate("+n.rotateAngle+","+n.width/2*r+","+n.height/2*r+")"}),this._updateResizeHandle(n,i,r,f),u.model.userHandles&&u.model.userHandles.length>0&&(e=!1,u.selectionList[0]&&u.selectionList[0].name=="multipleSelection"&&(e=!0),f&t.datavisualization.Diagram.SelectorConstraints.UserHandles&&this.updateUserHandles(u.model.userHandles,n,i,e,!1,r)))},_updateResizeHandle:function(n,i,r,u){var e=n._corners,f=t.datavisualization.Diagram.Point(n.width/2,-20/r);u&t.datavisualization.Diagram.SelectorConstraints.Rotator&&(this._updateRotateHandle("rotate",f.x,f.y,r,i,n),this._updatePivotLine(n,i,r));u&t.datavisualization.Diagram.SelectorConstraints.Resizer&&(this._updateResizeCorner("nw-resize",0,0,i),this._updateResizeCorner("n-resize",n.width/2*r,0,i),this._updateResizeCorner("ne-resize",n.width*r,0,i),this._updateResizeCorner("w-resize",0,n.height/2*r,i),this._updateResizeCorner("e-resize",n.width*r,n.height/2*r,i),this._updateResizeCorner("sw-resize",0,n.height*r,i),this._updateResizeCorner("s-resize",n.width/2*r,n.height*r,i),this._updateResizeCorner("se-resize",n.width*r,n.height*r,i),this._updateResizeBorder("resizeBorder",n,i,r))},_updateRotateHandle:function(n,t,i,r,u){var f=20,e=20,o={id:"rotatehandle",transform:"translate("+(t*r-f/2)+","+(i*r-e)+")"};u.path(o);u.circle({id:"rotate",transform:"translate("+(t*r-f/2)+","+(i*r-e)+")"})},_updatePivotLine:function(n,i,r){var u=t.datavisualization.Diagram.Point(n.width/2,-20/r),f=t.datavisualization.Diagram.Point(n.width/2,0),e=i.line({id:"pivotLine",x1:u.x*r,y1:u.y*r,x2:f.x*r,y2:f.y*r})},_updateResizeBorder:function(n,t,i,r){i.rect({id:n,width:t.width*r,height:t.height*r})},_updateResizeCorner:function(n,t,i,r){var u={id:n,cx:t,cy:i};r.circle(u);u={id:n+"_transparent",cx:t,cy:i};r.circle(u)},_updateEndPointHandle:function(n,i,r){var u=n.line.points,f,e;this._updateEndPointCorner("targetEndPoint",u[u.length-1].x*r,u[u.length-1].y*r,t.datavisualization.Diagram.Util.isTargetConnected(n),i,t.datavisualization.Diagram.Util.canDragTargetEnd(n));this._updateEndPointCorner("sourceEndPoint",u[0].x*r,u[0].y*r,t.datavisualization.Diagram.Util.isSourceConnected(n),i,t.datavisualization.Diagram.Util.canDragSourceEnd(n));n.line.type=="bezier"&&(f=n.line,e=t.datavisualization.Diagram.Util.canDragSegmentThumbs(n),this._updateEndPointCorner("bezierpoint1",f._point1.x*r,f._point1.y*r,!1,i,e),this._updateEndPointCorner("bezierpoint2",f._point2.x*r,f._point2.y*r,!1,i,e),this._updateBezierLine("bezierline1",n.line.startPoint,n.line._point1,r,i),this._updateBezierLine("bezierline2",n.line.endPoint,n.line._point2,r,i))},_updateEndPointCorner:function(n,t,i,r,u,f){var e=r?"#8CC63F":"white",o;f||(e="darkgray");o={id:n,fill:e,cx:t,cy:i};u.circle(o)},_updateBezierLine:function(n,t,i,r,u){var f=u.line({id:n,x1:t.x*r,y1:t.y*r,x2:i.x*r,y2:i.y*r})},_updateControlPointCorner:function(n,t,i,r){r.circle({id:n+"_"+i,cx:t.x,cy:t.y})},updateUserHandles:function(n,t,i,r,u,f){if(n&&n.length>0)for(var e=0;e<n.length;e++)(r&&n[e].enableMultiSelection||!r)&&this._updateHandle(n[e],t,i,u,f)},_updateHandle:function(n,t,i,r,u){var f=this._getHandlePosition(n,t,u),e;!r&&n.visible?(e=this._updatePath(f.x*u-n.size/4,f.y*u-n.size/4,n.size/2,n.size/2,n.pathData,i),this._updateHandleShape(n,f.x*u,f.y*u,i),this._updateHanleIcon(n,e,i),i.getElementById(n.name+"_shape")&&n.visible&&(i.getElementById(n.name+"_shape").style.display="block",i.getElementById(n.name+"_icon").style.display="block")):i.getElementById(n.name+"_shape")&&(i.getElementById(n.name+"_shape").style.display="none",i.getElementById(n.name+"_icon").style.display="none")},clearSelector:function(n,t){var i=n.getElementById(n.document.id+"handle_g");i&&t.removeChild(i);i=n.getElementById(n.document.id+"userHandle_g");i&&t.removeChild(i)},_initializePageBreaks:function(n,t,i){var r=n.g(t);return i.appendChild(r),r},_renderVPageBreakLine:function(n,t,i,r){var u=i.line({x1:n.x,y1:n.y,x2:t.x,y2:t.y,style:"stroke:#aaaaaa;stroke-width:1;stroke-dasharray:10,10 "});r.appendChild(u)},_renderPageSettingsRect:function(n,t,i,r,u,f,e){var o=i.rect({id:"pageback",x:n.x,y:n.y,width:t.x,height:t.y,style:"fill:"+f+";stroke:"+u+";stroke-width:"+e+""});r.appendChild(o)},_updatePageBakground:function(n,i){var r=document.getElementById("pageback"),u={x:n.x,y:n.y,width:i.x,height:i.y};r&&t.datavisualization.Diagram.Util.attr(r,u)},_renderHPageBreakLine:function(n,t,i,r){var u=i.line({x1:n.x,y1:n.y,x2:t.x,y2:t.y,style:"stroke:#aaaaaa;stroke-width:1;stroke-dasharray:10,10 "});r.appendChild(u)},_removePageBreaks:function(n,t,i){t!=null&&i!=null&&i.removeChild(t)}}}(jQuery,Syncfusion),function(n,t){"use strict";t.widget("ejSymbolPalette","ej.datavisualization.SymbolPalette",{element:null,model:null,nameTable:{},defaults:{width:250,height:400,paletteItemWidth:50,paletteItemHeight:50,previewWidth:100,previewHeight:100,previewOffset:{x:102,y:102},diagramId:null,headerHeight:30,selectedPaletteName:0,cssClass:"e-datavisualization-symbolpalette",showPaletteItemText:!0,allowDrag:!0,palettes:[]},dataTypes:{paletteItemWidth:"number",paletteItemHeight:"number",previewWidth:"number",previewHeight:"number",headerHeight:"number",showPaletteItemText:"boolean",allowDrag:"boolean",palettes:"array"},_canvas:null,_init:function(){this.selectedItem=null;this.activePalette=null;this._selectedElement=null;this._renderSymbolPalette();this._wireEvents();this.updateScrollerViewport()},_setModel:function(n){for(var t in n)switch(t){case"width":this._setWidth(n[t]);break;case"height":this._setHeight(n[t]);break;case"paletteItemWidth":this.model.paletteItemWidth=n[t];this._redrawContent();break;case"paletteItemHeight":this.model.paletteItemHeight=n[t];this._redrawContent();break;case"headerHeight":this._setHeaderHeight(n[t]);break;case"cssClass":this._setCssClass(n[t]);break;case"showPaletteItemText":this._showItemText(n[t])}},_destroy:function(){this.element.empty().removeClass(this.model.cssClass)},_renderSymbolPalette:function(){var n,i,r;if(this._canvas=document.createElement("div"),this._canvas.setAttribute("class","e-scanvas"),this._canvas.setAttribute("id",this.element[0].id+"_canvas"),this.element[0].setAttribute("style","height:"+this.model.height+"; width:"+this.model.width+";"),this.element.append(this._canvas),this.element.ejScroller({width:this._setViewPortWidth(),height:this._setViewPortHeight()}),n=this.model.palettes,n)for(i=0,r=n.length;i<r;i++)n[i]=t.datavisualization.Diagram.Palette(n[i]),this._renderPalette(n[i])},_setViewPortWidth:function(){this.element[0].setAttribute("style","width:"+this.model.width+";");var n=this.element.width(),t=this.element[0].offsetLeft;return Math.abs(n-t)},_setViewPortHeight:function(){this.element[0].setAttribute("style","height:"+this.model.height+";");var n=this.element.height(),t=this.element[0].offsetTop;return Math.abs(n-t)},_renderPalette:function(n){this._renderHeader(n);this._renderContent(n);this._collapse(n)},_renderHeader:function(i){var r=document.createElement("div"),u={id:i.name+"_header","class":"e-header",style:"height:"+this.model.headerHeight+"px;"};t.datavisualization.Diagram.Util.attr(r,u);this._renderHeaderArrow(r,i.expanded,i.name);this._renderHeaderText(r,i.name);this._addExpandedClass(r,i.expanded);this.model.selectedPaletteName===i.name&&(n(r).addClass("selected"),this.activePalette=i);this._canvas.appendChild(r)},_renderHeaderText:function(n,t){var i=document.createElement("span");i.setAttribute("class","e-header-text");i.innerHTML=t;n.appendChild(i)},_renderHeaderArrow:function(t,i){var r=document.createElement("span");r.setAttribute("class","e-header-arrow e-icon");r.setAttribute("style","top:"+(this.model.headerHeight-16)/2+"px;");this._addExpandedClass(r,i);this.model.selectedPaletteName===name&&n(r).addClass("selected");t.appendChild(r)},_renderContent:function(n){var r=document.createElement("div"),t,i,u;if(r.setAttribute("id",n.name+"_content"),r.setAttribute("class","e-scontent"),this.model.palettes.length-1===this.model.palettes.indexOf(n)&&r.setAttribute("style","border-bottom-width: 0px;"),this._canvas.appendChild(r),t=n.items,t&&t.length>0)for(i=0,u=t.length;i<u;i++)t[i].parent?this.nameTable[t[i].name]=t[i]:this._renderItem(t[i],r)},_renderItem:function(n,t){var i=this._renderItemContainer(n.name,t);n.line?this._renderConnector(n,i):n.isGroup?this._renderGroup(n,i):this._renderNode(n,i)},_renderItemContainer:function(i,r,u){var e=document.createElement("div"),s={id:i+"_paletteItem",draggable:"true",height:this.model.paletteItemHeight+"px",width:this.model.paletteItemWidth+"px","class":"e-paletteItem",style:"-ms-touch-action: none;touch-action: none;"},o,f;return t.datavisualization.Diagram.Util.attr(e,s),r.appendChild(e),o=this.element[0].id,f=this,u||n(e).ejDraggable({clone:!0,cursorAt:{top:f.model.previewOffset.y,left:f.model.previewOffset.x},helper:function(){var o,s,r,i,e;if(o=f.model.paletteItemWidth,s=f.model.paletteItemHeight,f.model.paletteItemWidth=f.model.previewWidth,f.model.paletteItemHeight=f.model.previewHeight,r=f._renderItemContainer(f.selectedItem.name+"_clone",document.body,!0),r.document.setAttribute("drag","true"),i=n.extend(!0,{},f.selectedItem),f.selectedItem.line){var u=t.datavisualization.Diagram.Util.bounds(i),c=(f.model.previewWidth-10)/u.width,l=(f.model.previewHeight-10)/u.height,h=n("#"+f.model.diagramId).ejDiagram("instance");h._scale(f.selectedItem,c,l,u.topLeft,h.nameTable);f._renderConnector(f.selectedItem,r)}else i.width=f.model.previewWidth-10,i.height=f.model.previewHeight-10,i.offsetX=i.width/2+5,i.offsetY=i.height/2+5,i.isGroup?f._renderGroup(i,r):f._renderNode(i,r);return e=document.getElementById(f.selectedItem.name+"_clone_paletteItem"),n(e).addClass("dragClone"),f.model.paletteItemWidth=o,f.model.paletteItemHeight=s,n(e)},drag:function(){var i=this,t=n(".dragClone")[0];t&&t.setAttribute("paletteId",o)},dragStop:function(){n(".dragClone").remove()}}),this._renderAnchor(e,i)},_renderAnchor:function(n,i){var r=document.createElement("div"),f={id:i+"_anchor",height:this.model.paletteItemHeight+"px",width:this.model.paletteItemWidth+"px","class":"e-anchor"},u;return t.datavisualization.Diagram.Util.attr(r,f),n.appendChild(r),u=this._renderSvg(r,i),this._renderText(r,i),u},_renderSvg:function(n,i){var r=document.createElement("div"),u={id:i+"_svgWrapper",width:this.model.paletteItemWidth+"px;",height:+this.model.paletteItemHeight+"px;","class":"e-svg-container"},f;return t.datavisualization.Diagram.Util.attr(r,u),u={id:i+"_svg",width:this.model.paletteItemWidth,height:this.model.paletteItemHeight,version:"1.1",xlink:"http://www.w3.org/1999/xlink"},f=new t.datavisualization.Diagram.Svg(u),r.appendChild(f.document),n.appendChild(r),f},_renderText:function(n,t){var i=document.createElement("div"),r;i.setAttribute("class","e-text-container");i.setAttribute("style","width:"+this.model.paletteItemWidth+"px;");r=document.createElement("span");r.setAttribute("class","e-paletteItemText");r.innerHTML=t;i.appendChild(r);this.model.showPaletteItemText||(i.style.display="none");n.appendChild(i)},_renderNode:function(n,i){var u=t.datavisualization.Diagram.SvgContext.renderNode(n,i),r=!1;i.document.getAttribute("drag")!=null&&(r=!0);this._transformItem(u,n.width,n.height,n,r)},_renderGroup:function(n,i){var u=t.datavisualization.Diagram.Util._getChildrenBounds(n,this.nameTable),f,r;n.width=u.width;n.height=u.height;f=t.datavisualization.Diagram.SvgContext.renderGroup(n,i,null,this.nameTable);r=!1;i.document.getAttribute("drag")!=null&&(r=!0);this._transformItem(f,n.width,n.height,n,r)},_renderConnector:function(n,i){var f=t.datavisualization.Diagram.SvgContext.renderConnector(n,i),r=t.datavisualization.Diagram.Geometry.rect(n.line.points),u=!1;i.document.getAttribute("drag")!=null&&(u=!0);this._transformItem(f,r.width,r.height,null,u)},_wireEvents:function(){this._on(this.element,t.eventType.click,".e-header",this._headerClick);this._on(this.element,t.eventType.mouseDown,".e-header",this._headerMouseDown);this._on(this.element,"mouseover",".e-header",this._headerMouseOver);this._on(this.element,"mouseout",".e-header",this._headerMouseOut);this._on(this.element,t.eventType.mouseDown,".e-paletteItem",this._itemMouseDown);this._on(this.element,"mouseover",".e-paletteItem",this._itemMouseOver);this._on(this.element,"mouseout",".e-paletteItem",this._itemMouseOut);this._on(this.element,t.eventType.click,".e-anchor",this._itemClick)},_headerClick:function(t){var r=this,i;n(t.currentTarget).next(".e-scontent").slideToggle(200,function(){r._refresh()});this._updateHeaderState(t.currentTarget);i=this._getActivePalette(t.currentTarget.id);i&&i!==this.activePalette&&(this.activePalette=i)},_headerMouseDown:function(n){n.preventDefault();n.stopPropagation()},_headerMouseOver:function(t){n(t.currentTarget).addClass("hover");n(t.currentTarget).find(".e-header-arrow").addClass("hover")},_headerMouseOut:function(t){n(t.currentTarget).removeClass("hover");n(t.currentTarget).find(".e-header-arrow").removeClass("hover")},_itemMouseDown:function(i){var r,u,s,e,f,h,o;if(this.model.diagramId&&(r=n("#"+this.model.diagramId).ejDiagram("instance"),r.activeTool instanceof t.datavisualization.Diagram.LineTool&&(r.activeTool._showAllPorts(!0),r.deactivateTool())),this.model.allowDrag||(i.preventDefault(),i.stopPropagation()),this._selectedElement?this._selectedElement!==i.currentTarget&&(n(this._selectedElement).removeClass("selected"),this._selectedElement=i.currentTarget):this._selectedElement=i.currentTarget,n(i.currentTarget).hasClass("selected")||n(i.currentTarget).addClass("selected"),u=this._getActivePalette(i.currentTarget.parentElement.id),u&&u!==this.activePalette&&(this._clearHeaderSelection(),this._updateHeaderSelection(n(i.currentTarget.parentElement).prev()),this.activePalette=u),this.activePalette&&this._selectedElement)for(s=this._selectedElement.id.slice(0,this._selectedElement.id.lastIndexOf("_")),e=this.activePalette.items,f=0,h=e.length;f<h;f++)o=e[f],o.name===s&&(this.selectedItem=o)},_itemMouseOver:function(t){n(t.currentTarget).addClass("hover")},_itemMouseOut:function(t){n(t.currentTarget).removeClass("hover")},_itemDraStart:function(n){var t=n.originalEvent.dataTransfer;t.setData("Text",this.element[0].id);t.effectAllowed="copy"},_itemClick:function(i){var f,r,e,u;if(this.model.diagramId&&(i.type==="click"||i.type==="touchend"&&!n(".dragClone")[0])){if(f=n("#"+this.model.diagramId).ejDiagram("instance"),r=n.extend(!0,{},this.selectedItem),r.name+=t.datavisualization.Diagram.Util.randomId(),r.isGroup){for(e=0;e<r.children.length;e++)u=n.extend(!0,{},this.nameTable[r.children[e]]),u.parent=r.name,u.name=r.name+u.name,r.children[e]=u.name,f.nameTable[u.name]=u,f.model.nodes.push(u),t.datavisualization.Diagram.SpatialUtil._updateQuad(f,f._spatialSearch,u);r.height=r.width=0;f._updateChildBounds(r,f.nameTable)}f.add(r)}},_collectionChanged:function(n){var t,i,r;n.changeType=="insert"?this._renderPalette(n.element):n.changeType=="remove"&&(t=n.element,t!=null&&(i=document.getElementById(t.name+"_header"),i&&i.parentNode.removeChild(i),r=document.getElementById(t.name+"_content"),r&&r.parentNode.removeChild(r)))},addPaletteItem:function(n,t){for(var u,i,r=0;r<this.model.palettes.length;r++)i=this.model.palettes[r],i.name===n&&(i.items.push(t),u=document.getElementById(n+"_content"),this._renderItem(t,u))},removePaletteItem:function(n,i){for(var r,u,f=0;f<this.model.palettes.length;f++)u=this.model.palettes[f],u.name===n&&(t.datavisualization.Diagram.Util.removeItem(u.items,i),r=document.getElementById(n+"_content"),r.removeChild(r.getElementsByClassName("e-paletteItem e-draggable e-js").item(i.name+"_paletteItem")),this.selectedItem=null)},addPalette:function(n){this.model.palettes.push(n);this._renderPalette(n)},removePalette:function(n){for(var r,u,i,f=0;f<this.model.palettes.length;f++)i=this.model.palettes[f],i.name===n&&(t.datavisualization.Diagram.Util.removeItem(this.model.palettes,i),r=document.getElementById(i.name+"_header"),r&&r.parentNode.removeChild(r),u=document.getElementById(i.name+"_content"),u&&u.parentNode.removeChild(u))},setWidth:function(n){this.model.width=n;this._setWidth(n)},setHeight:function(n){this.model.height=n;this._setHeight(n)},setPaletteItemWidth:function(n){this.model.paletteItemWidth=n;this._redrawContent()},setPaletteItemHeight:function(n){this.model.paletteItemHeight=n;this._redrawContent()},setHeaderHeight:function(n){this.model.headerHeight=n;this._setHeaderHeight(n)},setCssClass:function(n){this._setCssClass(n);this.model.cssClass=n},showPaletteItemText:function(n){this._showItemText(n);this.model.showPaletteItemText=n},searchPalette:function(n,i){var r=new t.datavisualization.Diagram.Collection;return i!=""&&(n=this._getSearchPaletteItems(i),r.add(n)),r},_getSearchPaletteItems:function(n){for(var f=new t.datavisualization.Diagram.Palette,u=this.model.palettes,r,i=0;i<u.length;i++)if(u[i].name.toLocaleLowerCase().search(n.toLocaleLowerCase())>=0)for(r=0;r<u[i].items.length;r++)this.element.find("#"+u[i].items[r].name+"_paletteItem")[0].style.display="block";else for(r=0;r<u[i].items.length;r++)this.element.find("#"+u[i].items[r].name+"_paletteItem")[0].style.display=u[i].items[r].name.toLocaleLowerCase().search(n.toLocaleLowerCase())>=0?"block":"none";return f},_addExpandedClass:function(t,i){i?n(t).addClass("expanded"):n(t).addClass("collapsed")},_collapse:function(t){t.expanded||n(document.getElementById(t.name+"_header")).next(".e-scontent").slideToggle(10)},_transformItem:function(n,i,r,u,f){var h;if(!f){var e=this._getScaleFactor(i,r),s=this._getTranslateFactor(i,r),o="";o+="translate("+s+","+s+")";o+="scale("+e+","+e+")";n.setAttribute("transform",o)}u&&t.browserInfo().name==="msie"&&(u.isGroup||u.shape.type!=="html"||(h=document.getElementById(u.name+"_html"),h.setAttribute("style","zoom:"+e+";")))},_getScaleFactor:function(n,t){var u=30*this.model.paletteItemWidth/100,f=30*this.model.paletteItemHeight/100,i=(this.model.paletteItemWidth-u)/n,r=(this.model.paletteItemHeight-f)/t;return i=i>1?1:i,r=r>1?1:r,Math.min(i,r)},_getTranslateFactor:function(){var n=15/100*this.model.paletteItemWidth,t=15/100*this.model.paletteItemHeight;return Math.min(n,t)},_setWidth:function(n){this.element.css("width",n)},_setHeight:function(n){this.element.css("height",n)},_setHeaderHeight:function(n){this.element.find(".e-header").css("height",n);this.element.find(".e-header-arrow").css("top",(n-16)/2)},_setCssClass:function(n){this.element.removeClass(this.model.cssClass).addClass(n)},_showItemText:function(n){n!==this.model.showPaletteItemText&&(n?this.element.find(".e-text-container").show():this.element.find(".e-text-container").hide())},_redrawContent:function(){for(var u,e,t,r,o,f=this.element.find(".e-scontent"),i=0,s=f.length;i<s;++i)if(u=f[i],n(u).empty(),e=this.model.palettes[i],t=e.items,t&&t.length>0)for(r=0,o=t.length;r<o;r++)this._renderItem(t[r],u)},_getActivePalette:function(n){for(var t,u=n.slice(0,n.lastIndexOf("_")),r=this.model.palettes,i=0,f=r.length;i<f;i++)if(t=r[i],t.name===u&&t!==this.activePalette)return t;return null},_updateHeaderState:function(n){this._clearHeaderSelection();this._updateExpandState(n);this._updateHeaderSelection(n)},_updateExpandState:function(t){n(t).hasClass("expanded")?(n(t).removeClass("expanded").addClass("collapsed"),n(t).find(".e-header-arrow").removeClass("expanded").addClass("collapsed")):(n(t).removeClass("collapsed").addClass("expanded"),n(t).find(".e-header-arrow").removeClass("collapsed").addClass("expanded"))},_updateHeaderSelection:function(t){n(t).hasClass("selected")||(n(t).addClass("selected"),n(t).find(".e-header-arrow").addClass("selected"))},_clearHeaderSelection:function(){this.element.find(".e-header").removeClass("selected");this.element.find(".e-header-arrow").removeClass("selected")},_addItem:function(n,t){var i=document.getElementById(n.name+"_content");this._renderItem(t,i)},_removeItem:function(n,t){var i=document.getElementById(n.name+"_content");i.removeChild(document.getElementById(t.name+"_paletteItem"));t===this._selectedElement&&(this._selectedElement=null)},updateScrollerViewport:function(){var n=this.element.ejScroller("instance");n.model.touchScroll=!1;n.model.width=this._setViewPortWidth();n.model.height=this._setViewPortHeight();this._refresh()},_refresh:function(){this.element.ejScroller("refresh")}})}(jQuery,Syncfusion),function(n,t){"use strict";var i,u,f,e,o,r,s,h,c,l,a,v,y,p,w,b,k,d,g,nt;t.datavisualization.Diagram.extend=function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r};i=function(){function i(n,i){this.name=n;this.diagram=i;this.helper=null;this.inAction=!1;this.selectedObject=null;this.startPoint=t.datavisualization.Diagram.Point(0,0);this.currentPoint=t.datavisualization.Diagram.Point(0,0);this.previousPoint=t.datavisualization.Diagram.Point(0,0);this.cursor="default";this._currentPossibleConnection=null;this._previousPossibleConnection=null;this._possibleConnectionPort=null;this.singleAction=!1;this.svgHelper=null;this.single=null;this._centralPoint=t.datavisualization.Diagram.Point(0,0);this._enableAutoNode=null;this._prevTool=null}return i.prototype.abort=function(){this._endAction();t.datavisualization.Diagram.SvgContext.updateSelector(this.diagram.selectionList[0],this.diagram._svg,this.diagram.model.zoomFactor,this.diagram,this.diagram.model.selectorConstraints);this.diagram._removeTooltip()},i.prototype.keydown=function(n){var t=n.keyCode?n.keyCode:n.which;t===27&&this.inAction?this.abort():this.inAction||t!=27||this.diagram._clearSelection()},i.prototype._findNodeUnderMouse=function(t,i){var u,r=n(t.target).parents("g"),e,o,c,s,h,f;if(r.length>3)if(e=this.diagram.selectionList,e.length>0)if(o=r.length-3,o>1&&r[o-1].getAttribute("class")=="ej-d-group"&&!e[0].isPseudoGroup){if(c=r[o-1].getAttribute("id"),c!==this.diagram._svg.document.id+"handle_g")if(f=this._findObj(r[o-1]),i)if(u=f,e[0].isPseudoGroup||this.diagram._selectionContains(f))u=e[0];else for(s=o-2;s>=0;s--){if(f.isGroup)if(h=this._findObj(r[s],f),this.diagram._selectionContains(h)){u=e[0];break}else this.diagram._findChildren(f,e[0].name)&&(u=h);f=h}else if(this.diagram._selectionContains(f)||this.diagram._findChildren(f,e[0].name))for(s=o-2;s>=0;s--)if(h=this._findObj(r[s],f),this.diagram._selectionContains(h)){if(!h.isGroup){u=f;break}}else{u=h;break}else u=f}else e[0].isPseudoGroup?(u=this._findObj(r[o-1],e[0]),u||(u=this._findObj(r[r.length-4]))):u=this._findObj(r[r.length-4]);else u=this._findObj(r[r.length-4]);return u},i.prototype._processCtrlKey=function(n){var i,e,r,o,f,u;return this.diagram.selectionList.length>0?(f=this.diagram.selectionList,f[0].isPseudoGroup?(e=!0,i=this._findNodeUnderMouse(n)):i=this._findNodeUnderMouse(n,!0),i&&!this.diagram._selectionContains(i)?e?(r=f[0],this.diagram._findChildren(r,i.name)?(t.datavisualization.Diagram.Util.removeItem(r.children,i.name),r.children.length==1?(o=this.diagram.nameTable[r.children[0]],this.selectedObject=o,t.datavisualization.Diagram.Util._updateGroupBounds(r,this.diagram.nameTable),t.datavisualization.Diagram.SvgContext.updateSelector(this.selectedObject,this.diagram._svg,this.diagram.model.zoomFactor,this.diagram,this.diagram.model.selectorConstraints)):(this.selectedObject=f[0],t.datavisualization.Diagram.Util._updateGroupBounds(r,this.diagram.nameTable),t.datavisualization.Diagram.SvgContext.updateSelector(this.selectedObject,this.diagram._svg,this.diagram.model.zoomFactor,this.diagram,this.diagram.model.selectorConstraints))):(r.children.push(i.name),t.datavisualization.Diagram.Util._updateGroupBounds(r,this.diagram.nameTable),this.selectedObject=f[0],t.datavisualization.Diagram.SvgContext.updateSelector(this.selectedObject,this.diagram._svg,this.diagram.model.zoomFactor,this.diagram,this.diagram.model.selectorConstraints))):(f=this.diagram.selectionList[0],this.diagram._hasSelection()&&this.diagram._clearSelection(),u=t.datavisualization.Diagram.Group({isPseudoGroup:!0,name:"multipleSelection"}),u.children.push(f.name),u.children.push(i.name),this.diagram.model.nodes.push(u),this.diagram.nameTable[u.name]=u,t.datavisualization.Diagram.Util._updateGroupBounds(u,this.diagram.nameTable),this.selectedObject=u,this.diagram._addSelection(this.selectedObject)):this.selectedObject=i):(i=this._findNodeUnderMouse(n),this.selectedObject=i),i},i.prototype._findObj=function(n,t){var r,u=n.getAttribute("id"),i;return t?r=this.diagram._findChildren(t,u):(i=n.getAttribute("class"),i&&(i==="ej-d-node"||i==="ej-d-group"?r=this.diagram._findNode(u):i==="ej-d-connector"&&(r=this.diagram._findConnector(u)))),r},i.prototype.mousedown=function(n){this.startPoint=this.mousePosition(n);this.previousPoint=this.startPoint},i.prototype.mousemove=function(n){this.currentPoint=this.mousePosition(n)},i.prototype.mouseup=function(){this._endAction();this.singleAction&&this.diagram.activateTool("select")},i.prototype.mousePosition=function(n){return this.diagram._mousePosition(n)},i.prototype.updateCursor=function(n){this.diagram._currentCursor=n;this.diagram._updateCursor()},i.prototype.nearestGridPoint=function(n){var i=t.datavisualization.Diagram.Point();if(this.diagram.model.snap&t.datavisualization.Diagram.Snap.Grid){var o=this.diagram.model.magnification/100,r=this.diagram.model.grid.horizontalSpacing*o,u=this.diagram.model.grid.verticalSpacing*o,f=n.x%r,e=n.y%u;i.x=f>=r/2?n.x+r-f:n.x-f;i.y=e>=u/2?n.y+u-e:n.y-e}return i},i.prototype.snap=function(n){var i=this.diagram.model.snapSettings,r=this.diagram.model.zoomFactor;return i.snapConstraints&t.datavisualization.Diagram.SnapConstraints.SnapToVerticalLines&&(n.x=t.datavisualization.Diagram.SnapUtil._round(n.x,i.verticalGridLines.snapInterval,r)),i.snapConstraints&t.datavisualization.Diagram.SnapConstraints.SnapToHorizontalLines&&(n.y=t.datavisualization.Diagram.SnapUtil._round(n.y,i.horizontalGridLines.snapInterval,r)),n},i.prototype._endAction=function(){var n,i,u,r,f;if(this.inAction=!1,this.svgHelper)if(n=this.helper,i=this.diagram._spatialSearch,n.isGroup)for(u=this.helper.children.length-1,r=u;r>=0;r--)t.datavisualization.Diagram.SpatialUtil._removeFromaQuad(i,i.quadTable[n.children[r].name],n.children[r]);else t.datavisualization.Diagram.SpatialUtil._removeFromaQuad(i,i.quadTable[n.name],n);this.helper&&(this.svgHelper&&this.diagram._svg.removeChild(this.svgHelper,this.diagram._diagramLayer),this.helper.gradient&&(f=this.diagram._svg.getElementsByTagName("defs")[0],f.removeChild(this.diagram._svg.getElementById(this.helper.name+"_gradient"))));this._previousPossibleConnection&&(this._previousPossibleConnection=null,t.datavisualization.Diagram.SvgContext._removePortHighlighter(this.diagram._svg,this.diagram._adornerLayer));this._currentPossibleConnection=null;this._possibleConnectionPort=null;this.helper=null;this.svgHelper=null;this.selectedObject=null;this.startPoint=t.datavisualization.Diagram.Point(0,0);this.currentPoint=t.datavisualization.Diagram.Point(0,0);this.previousPoint=t.datavisualization.Diagram.Point(0,0)},i.prototype._isResizeCorner=function(n){var t=!1;switch(n){case"n-resize":case"e-resize":case"w-resize":case"s-resize":case"ne-resize":case"nw-resize":case"se-resize":case"sw-resize":case"targetEndPoint":case"sourceEndPoint":t=!0}return t},i.prototype._initHelper=function(){this.selectedObject&&(this.helper=n.extend(!0,{},this.selectedObject),this._updateHelperName(this.helper))},i.prototype._updateHelperName=function(n,t){var u,i,r,f,e;for(t?n.name+="helper":n.name="helper",n.opacity=.5,u=n.labels,i=0,r=u.length;i<r;++i)u[i].name+="helper";if(n.ports)for(f=n.ports,i=0,r=f.length;i<r;++i)f[i].name+="helper";if(n.isGroup)for(e=n.children,i=0,r=e.length;i<r;i++)this._updateHelperName(e[i],!0)},i.prototype._raiseEvent=function(n,t){return this.diagram._trigger(n,t),t},i.prototype._findPort=function(n,t){var f=this.diagram._findPortAtPoint(n,t),r,u,i;if(!f&&t.isGroup)for(u=0;u<t.children.length;u++)if(i=this.diagram.nameTable[t.children[u]],i&&!i.line)if(r=this._findPort(n,i),r&&!i.isGroup)this._currentPossibleConnection=i,f=r;else if(r)return r;return f},i.prototype._checkConnectionPossible=function(n){var i=null,o=t.datavisualization.Diagram.Point(this.currentPoint.x,this.currentPoint.y),r=this.diagram._findNodeUnderMouse(n);if(r&&!r.line?r.isPseudoGroup||(this._showPorts(r),this._currentPossibleConnection=r,(this._previousPossibleConnection==null||this._previousPossibleConnection.name!==this._currentPossibleConnection.name)&&(this._previousPossibleConnection=this._currentPossibleConnection)):(this._showPorts(),this._currentPossibleConnection=null,this._possibleConnectionPort=null),this._currentPossibleConnection){if(i=this._findPort(o,this._currentPossibleConnection),i&&t.datavisualization.Diagram.Util.canConnect(i,!0)||t.datavisualization.Diagram.Util.canConnect(this._currentPossibleConnection)?t.datavisualization.Diagram.SvgContext._drawPortHighlighter(i,this._currentPossibleConnection,this.diagram._svg,this.diagram._adornerLayer,this.diagram.model.zoomFactor):t.datavisualization.Diagram.SvgContext._removePortHighlighter(this.diagram._svg,this.diagram._adornerLayer),this._possibleConnectionPort=i,i&&t.datavisualization.Diagram.Util.canConnect(i,!0)){var u=this._currentPossibleConnection,f=t.datavisualization.Diagram.Util._getPortPosition(this._possibleConnectionPort,t.datavisualization.Diagram.Util.bounds(u,!0)),e=t.Matrix.identity();t.Matrix.rotate(e,u.rotateAngle,u.offsetX,u.offsetY);f=t.Matrix.transform(e,f);this.currentPoint=f}}else this._previousPossibleConnection&&(this._previousPossibleConnection=null,t.datavisualization.Diagram.SvgContext._removePortHighlighter(this.diagram._svg,this.diagram._adornerLayer),this._possibleConnectionPort=null)},i.prototype._showPorts=function(n){n?(this._currentPossibleConnection&&this._currentPossibleConnection.name!==n.name&&this._showPort(this._currentPossibleConnection,!0),this._showPort(n)):this._currentPossibleConnection!=null&&this._showPort(this._currentPossibleConnection,!0)},i.prototype._showPort=function(n,i){var f,r,e,u,o;if(i)for(f=n.ports,u=0,o=f.length;u<o;++u)r=f[u],(r.visibility&t.datavisualization.Diagram.PortVisibility.Hover||r.visibility&t.datavisualization.Diagram.PortVisibility.Connect)&&(e=this.diagram._svg.getElementById(n.name+"_"+r.name),e.setAttribute("visibility","hidden"));else for(f=n.ports,u=0,o=f.length;u<o;++u)r=f[u],(r.visibility&t.datavisualization.Diagram.PortVisibility.Hover||r.visibility&t.datavisualization.Diagram.PortVisibility.Connect)&&(e=this.diagram._svg.getElementById(n.name+"_"+r.name),e.setAttribute("visibility","visible"))},i.prototype._showAllPorts=function(n){var t,i,r=this.diagram.model.nodes;if(n)for(t=0,i=r.length;t<i;t++)this._showPort(r[t],n);else for(t=0,i=r.length;t<i;++t)this._showPort(r[t])},i.prototype._disconnect=function(n){var r,i=this.diagram.nameTable[n.targetNode],u=null;i&&(u=t.datavisualization.Diagram.Util.findPortByName(i,n.targetPort),r=this._raiseEvent("connectionChange",{element:n,connection:i,port:u,cancel:!1}),r.cancel||(t.datavisualization.Diagram.Util.removeItem(i.inEdges,n.name),n.targetNode=null,n.targetPort=null));i=this.diagram.nameTable[n.sourceNode];i&&(u=t.datavisualization.Diagram.Util.findPortByName(i,n.sourcePort),r=this._raiseEvent("connectionChange",{element:n,connection:i,port:u,cancel:!1}),r.cancel||(t.datavisualization.Diagram.Util.removeItem(i.outEdges,n.name),n.sourceNode=null,n.sourcePort=null))},i}();t.datavisualization.Diagram.Tool=i;u=function(n){function i(t){n.call(this,"select",t);this.cursor="default";this._svgHelper=null}return t.datavisualization.Diagram.extend(i,n),i.prototype.mousedown=function(t){n.prototype.mousedown.call(this,t);var i=this._findNodeUnderMouse(t);i&&(this.selectedObject=i)},i.prototype.mousemove=function(i){n.prototype.mousemove.call(this,i);t.datavisualization.Diagram.Geometry.isEmptyPoint(this.startPoint)||(this.inAction||this.startPoint.x==this.currentPoint.x&&this.startPoint.y==this.currentPoint.y||(this.inAction=!0,this._initHelper()),this._updateHelper())},i.prototype.mouseup=function(i){var u,o,r,f,v,e,y,h,l,c,s;if(this.inAction){this.currentPoint=this.mousePosition(i);var p=Math.abs(this.startPoint.x-this.currentPoint.x),w=Math.abs(this.startPoint.y-this.currentPoint.y),b=this.startPoint.x>this.currentPoint.x?this.currentPoint.x:this.startPoint.x,k=this.startPoint.y>this.currentPoint.y?this.currentPoint.y:this.startPoint.y,a=t.datavisualization.Diagram.Rectangle(b,k,p,w);if(p!==0||w!==0){for(f=[],v=this.diagram.model.nodes,u=0,o=v.length;u<o;u++)e=v[u],r=t.datavisualization.Diagram.Util.bounds(e),r=t.datavisualization.Diagram.Geometry.rect([r.topLeft,r.topRight,r.bottomRight,r.bottomLeft]),t.datavisualization.Diagram.Util.canSelect(e)&&(t.datavisualization.Diagram.Geometry.containsRect(a,r)?e.parent===""&&f.push(e):e.isGroup&&this._checkGroupChildren(f,e,a));for(y=this.diagram.model.connectors,u=0,o=y.length;u<o;u++)h=y[u],r=t.datavisualization.Diagram.Util.bounds(h),r=t.datavisualization.Diagram.Geometry.rect([r.topLeft,r.topRight,r.bottomRight,r.bottomLeft]),t.datavisualization.Diagram.Util.canSelect(h)&&t.datavisualization.Diagram.Geometry.containsRect(a,r)&&h.parent===""&&f.push(h);if(this.diagram._hasSelection()&&this.diagram._clearSelection(),f.length>0){if(l=f,l.length>1){for(s=t.datavisualization.Diagram.Group({isPseudoGroup:!0,name:"multipleSelection"}),u=0,o=l.length;u<o;u++)s.children.push(l[u].name);this.diagram.model.nodes.push(s);this.diagram.nameTable[s.name]=s;c=s}else c=f[0];c.isGroup&&t.datavisualization.Diagram.Util._updateGroupBounds(c,this.diagram.nameTable);this.diagram._addSelection(c)}}else this.diagram._hasSelection()&&!this.diagram._isDropped&&this.diagram._clearSelection()}else this.selectedObject||this.diagram._hasSelection()?(i.ctrlKey||i.shiftKey?this._processCtrlKey(i):this.diagram._hasSelection()&&this.diagram._clearSelection(),this.diagram._addSelection(this.selectedObject)):this.diagram._hasSelection()&&!this.diagram._isDropped&&this.diagram._clearSelection();this.diagram._isDropped=!1;n.prototype.mouseup.call(this,i)},i.prototype._endAction=function(){this._svgHelper&&(this.diagram._adornerLayer.removeChild(this._svgHelper),this.selectedObject=null,this._svgHelper=null);n.prototype._endAction.apply(this)},i.prototype._initHelper=function(){var n,t,i;this._svgHelper||(n=this.diagram._svg.g(),this.diagram._adornerLayer.appendChild(n),t=this.diagram.model.zoomFactor,i=this.diagram._svg.rect({id:"helper",x:this.startPoint.x*t,y:this.startPoint.y*t,fill:"transparent",stroke:"gray","stroke-dasharray":"2 2","shape-rendering":"crispEdges"}),n.appendChild(i),n.setAttribute("pointer-events","none"),this._svgHelper=n)},i.prototype._updateHelper=function(){var t=this.diagram._svg.getElementById("helper"),i=Math.abs(this.startPoint.x-this.currentPoint.x),r=Math.abs(this.startPoint.y-this.currentPoint.y),n=this.diagram.model.zoomFactor,u=(this.startPoint.x>this.currentPoint.x?this.currentPoint.x:this.startPoint.x)*n,f=(this.startPoint.y>this.currentPoint.y?this.currentPoint.y:this.startPoint.y)*n;t&&this.diagram._svg.rect({id:t.id,x:u,y:f,width:i*n,height:r*n})},i.prototype._checkGroupChildren=function(n,i,r){for(var u,e,f=0;f<i.children.length;f++)u=i.children[f],e=t.datavisualization.Diagram.Util.bounds(u),t.datavisualization.Diagram.Geometry.containsRect(r,e)?n.push(u):u.isGroup&&this._checkGroupChildren(n,u,r)},i}(i);t.datavisualization.Diagram.SelectTool=u;f=function(i){function r(n){i.call(this,"move",n);this.cursor="move";this._isMouseDown=!1;this.diffx=0;this.diffy=0;this.undoObject=[]}return t.datavisualization.Diagram.extend(r,i),r.prototype.mousedown=function(n){t.datavisualization.Diagram.SnapUtil._removeGuidelines(this.diagram);this.diffx=0;this.diffy=0;i.prototype.mousedown.call(this,n);this._isMouseDown=!0;this.updateCursor(this.cursor)},r.prototype.mousemove=function(r){var u,s,f,h,e,c,o,l;if(i.prototype.mousemove.call(this,r),t.datavisualization.Diagram.SnapUtil._removeGuidelines(this.diagram),this._isMouseDown&&!this.inAction&&(this.startPoint.x!=this.currentPoint.x||this.startPoint.y!=this.currentPoint.y)&&(this.selectedObject||(u=this.diagram.selectionList.length>0?this._findNodeUnderMouse(r,!0):this._findNodeUnderMouse(r),u&&(this.diagram.selectionList[0]&&this.diagram.selectionList[0].isPseudoGroup?this.diagram._findChildren(this.diagram.selectionList[0],u.name)?this.selectedObject=this.diagram.selectionList[0]:(this.selectedObject=u,this.diagram._clearSelection()):this.diagram.selectionList[0]!=u?(this.diagram._clearSelection(),this.selectedObject=this.diagram.nameTable[u.name]):this.selectedObject=this.diagram.nameTable[this.diagram.selectionList[0].name],f={},(this.selectedObject.isGroup||this.selectedObject.isPseudoGroup)&&(f=this.diagram._getChildTable(this.selectedObject,f)),h={childTable:f,node:this.selectedObject},s=n.extend(!0,{},h),this.undoObject=jQuery.extend(!0,{},s)))),this.selectedObject&&t.datavisualization.Diagram.Util.canSelect(this.selectedObject)){if(this.inAction||(this.inAction=!0,this.updateCursor("move"),this._updateSelection()),this._updateXY(this.selectedObject,this.previousPoint,this.currentPoint),this.selectedObject.line&&(e=this.selectedObject,(t.datavisualization.Diagram.Util.isTargetConnected(e)||t.datavisualization.Diagram.Util.isSourceConnected(e))&&this._disconnect(e)),this.selectedObject.isPseudoGroup)for(o=0,l=this.selectedObject.children.length;o<l;o++)c=this.diagram.nameTable[this.selectedObject.children[o]],t.datavisualization.Diagram.SvgContext.update(c,this.diagram);else this.selectedObject.parent&&t.datavisualization.Diagram.Util._updateGroupBounds(this.diagram.nameTable[this.selectedObject.parent],this.diagram.nameTable),t.datavisualization.Diagram.SvgContext.update(this.selectedObject,this.diagram);this.diagram._renderTooltip(this.selectedObject);this._updateSelection();this.diagram._updateSelectionHandle(!0)}this.previousPoint=this.currentPoint},r.prototype.mouseup=function(r){var u,e,f,o,s;this._isMouseDown=!1;t.datavisualization.Diagram.SnapUtil._removeGuidelines(this.diagram);this.inAction?(this.inAction=!1,this._updateXY(this.selectedObject,this.previousPoint,this.currentPoint),this._updateObject(),f={},(this.selectedObject.isGroup||this.selectedObject.isPseudoGroup)&&(f=this.diagram._getChildTable(this.selectedObject,f)),o={childTable:f,node:this.selectedObject},e=n.extend(!0,{},o),s={type:"positionchanged",undoObject:this.undoObject,redoObject:jQuery.extend(!0,{},e),isMultipleNode:this.selectedObject.isGroup?!0:!1},this.diagram.addHistoryEntry(s),this.diagram._updateSelectionHandle(),u=this.selectedObject):this.selectedObject?u=this._findNodeUnderMouse(r):r.which==3?this.diagram.selectionList&&!this.diagram.selectionList[0].isPseudoGroup&&(this.diagram.selectionList.length>0?(this.selectedObject=this._findNodeUnderMouse(r,!0),u=this.selectedObject):(this.selectedObject=this._findNodeUnderMouse(r),u=this.selectedObject),this.selectedObject&&!this.diagram._selectionContains(this.selectedObject)&&this.diagram._clearSelection()):(r.ctrlKey||r.shiftKey?u=this._processCtrlKey(r):(this.selectedObject=this._findNodeUnderMouse(r),u=this.selectedObject),this.selectedObject&&!this.diagram._selectionContains(this.selectedObject)&&this.diagram._clearSelection());this.selectedObject&&this._updateSelection();this.diagram._removeTooltip();this.diagram._endEdit();u&&this._raiseEvent("click",{element:u});i.prototype.mouseup.call(this,r)},r.prototype._updateObject=function(){var i,n,r;if(this.selectedObject.isPseudoGroup)for(n=0,r=this.selectedObject.children.length;n<r;n++)i=this.diagram.nameTable[this.selectedObject.children[n]],t.datavisualization.Diagram.SvgContext.update(i,this.diagram);else t.datavisualization.Diagram.SvgContext.update(this.selectedObject,this.diagram)},r.prototype._endAction=function(){i.prototype._endAction.apply(this);this._isMouseDown=!1;this._mouseOffset=t.datavisualization.Diagram.Size(0,0)},r.prototype._renderHelper=function(){this.svgHelper||(this.svgHelper=this.helper.line?t.datavisualization.Diagram.SvgContext.renderConnector(this.helper,this.diagram._svg,this.diagram._diagramLayer):this.helper.isGroup?t.datavisualization.Diagram.SvgContext.renderGroup(this.helper,this.diagram._svg,this.diagram._diagramLayer):t.datavisualization.Diagram.SvgContext.renderNode(this.helper,this.diagram._svg,this.diagram._diagramLayer),this.svgHelper.setAttribute("pointer-events","none"))},r.prototype._updateHelper=function(){this._updateXY(this.helper,this.previousPoint,this.currentPoint);t.datavisualization.Diagram.SvgContext.update(this.helper,this.diagram)},r.prototype._updateXY=function(n,i,r){var s=r.x<i.x,h=r.y<i.y,f=this.diffx+(r.x-i.x),e=this.diffy+(r.y-i.y),u,o;(this.diagram.model.snapSettings.snapConstraints&t.datavisualization.Diagram.SnapConstraints.SnapToHorizontalLines||this.diagram.model.snapSettings.snapConstraints&t.datavisualization.Diagram.SnapConstraints.SnapToVerticalLines||this.diagram.model.snapSettings.enableSnapToObject)&&(u=t.datavisualization.Diagram.SnapUtil._snapPoint(this.diagram,this.selectedObject,s,h,t.datavisualization.Diagram.Point(f,e),r,i));u||(u=t.datavisualization.Diagram.Point(f,e));this.diffx=f-u.x;this.diffy=e-u.y;t.datavisualization.Diagram.Geometry.isEmptyPoint(u)||(o=this._raiseEvent("drag",{element:this.selectedObject,offset:u,cancel:!1}),o.cancel||(this.diagram._translate(n,u.x,u.y,this.diagram.nameTable),this._updateParent(n),n.isGroup&&t.datavisualization.Diagram.Util._updateGroupBounds(n,this.diagram.nameTable)))},r.prototype._updateParent=function(n){var i,r;if(n.isPseudoGroup)for(r=0;r<n.children.length;r++)i=this.diagram.nameTable[n.children[r]],i&&i.parent&&(t.datavisualization.Diagram.Util._updateGroupBounds(this.diagram.nameTable[i.parent],this.diagram.nameTable),t.datavisualization.Diagram.SvgContext.update(this.diagram.nameTable[i.parent],this.diagram),this.diagram._updateAssociatedConnectorEnds(this.diagram.nameTable[i.parent],this.diagram.nameTable));else n&&n.parent&&(t.datavisualization.Diagram.Util._updateGroupBounds(this.diagram.nameTable[n.parent],this.diagram.nameTable),t.datavisualization.Diagram.SvgContext.update(this.diagram.nameTable[n.parent],this.diagram),this.diagram._updateAssociatedConnectorEnds(this.diagram.nameTable[n.parent],this.diagram.nameTable))},r.prototype._updateSelection=function(){this.diagram._selectionContains(this.selectedObject)||this.diagram._addSelection(this.selectedObject)},r}(i);t.datavisualization.Diagram.MoveTool=f;e=function(i){function r(n){i.call(this,"resize",n);this.cursor="default";this._resizeDirection=null;this._mouseOffset=t.datavisualization.Diagram.Size(0,0);this.diffx=0;this.diffy=0;this.undoObject=null}return t.datavisualization.Diagram.extend(r,i),r.prototype.mousedown=function(r){var f,u,e;t.datavisualization.Diagram.SnapUtil._removeGuidelines(this.diagram);i.prototype.mousedown.call(this,r);this.selectedObject=this.diagram.nameTable[this.diagram.selectionList[0].name];u={};(this.selectedObject.isGroup||this.selectedObject.isPseudoGroup)&&(u=this.diagram._getChildTable(this.selectedObject,u));e={childTable:u,node:this.selectedObject};f=n.extend(!0,{},e);this.undoObject=jQuery.extend(!0,{},f);this._resizeDirection=r.target.getAttribute("class");this.diffx=0;this.diffy=0},r.prototype.mousemove=function(n){i.prototype.mousemove.call(this,n);t.datavisualization.Diagram.SnapUtil._removeGuidelines(this.diagram);this.selectedObject&&(this.inAction||(t.datavisualization.Diagram.SvgContext._removePivotPoint(this.selectedObject,this.diagram._svg,this.diagram.model.zoomFactor),this.inAction=!0),this._updateSize(this.selectedObject,this.previousPoint,this.currentPoint),t.datavisualization.Diagram.SvgContext.update(this.selectedObject,this.diagram),this.diagram._renderTooltip(this.selectedObject),this.diagram._updateSelectionHandle(!0));this.previousPoint=this.currentPoint},r.prototype.mouseup=function(r){var f,u,e,o;this.inAction&&(t.datavisualization.Diagram.SnapUtil._removeGuidelines(this.diagram),this.inAction=!1,this._updateSize(this.selectedObject,this.previousPoint,this.currentPoint),this.selectedObject.parent&&t.datavisualization.Diagram.Util._updateGroupBounds(this.diagram.nameTable[this.selectedObject.parent],this.diagram.nameTable),t.datavisualization.Diagram.SvgContext.update(this.selectedObject,this.diagram),this.diagram._updateSelectionHandle(),u={},(this.selectedObject.isGroup||this.selectedObject.isPseudoGroup)&&(u=this.diagram._getChildTable(this.selectedObject,u)),e={childTable:u,node:this.selectedObject},f=n.extend(!0,{},e),o={type:"sizechanged",undoObject:this.undoObject,redoObject:jQuery.extend(!0,{},f),isMultipleNode:this.selectedObject.isGroup?!0:!1},this.diagram.addHistoryEntry(o),this.diagram._removeTooltip());i.prototype.mouseup.call(this,r)},r.prototype._updateSize=function(n,i,r,u,f){var k=t.Matrix.identity(),g,nt,s,p,w,tt,rt;t.Matrix.rotate(k,-n.rotateAngle);var h={snapped:!1,offset:0,left:!1,right:!1},c={snapped:!1,offset:0,top:!1,bottom:!1},e=(u?u:r.x-i.x)+this.diffx,o=(f?f:r.y-i.y)+this.diffy,l=o,a=e;this.diffx=0;this.diffy=0;var b=t.datavisualization.Diagram.Point(0,0),d=t.Matrix.identity(),it=n.pivot,v=n.offsetX,y=n.offsetY;t.Matrix.rotate(d,n.rotateAngle,v,y);g=n.width;nt=n.height;v=v-g*it.x;y=y-nt*it.y;switch(this._resizeDirection){case"n-resize":b=t.Matrix.transform(d,t.datavisualization.Diagram.Point(v+g/2,y+nt));p=1;o=this._snapTop(h,c,a,l,n,r==i);s=t.Matrix.transform(k,t.datavisualization.Diagram.Point(e,o));e=s.x;o=s.y;w=(n.height-o)/n.height;break;case"e-resize":b=t.Matrix.transform(d,t.datavisualization.Diagram.Point(v,y+nt/2));e=this._snapRight(h,c,a,l,n,r==i);s=t.Matrix.transform(k,t.datavisualization.Diagram.Point(e,o));e=s.x;o=s.y;p=(n.width+e)/n.width;w=1;break;case"w-resize":b=t.Matrix.transform(d,t.datavisualization.Diagram.Point(v+g,y+nt/2));e=this._snapLeft(h,c,a,l,n,r==i);s=t.Matrix.transform(k,t.datavisualization.Diagram.Point(e,o));e=s.x;o=s.y;p=(n.width-e)/n.width;w=1;break;case"s-resize":b=t.Matrix.transform(d,t.datavisualization.Diagram.Point(v+g/2,y));p=1;o=this._snapBottom(h,c,a,l,n,r==i);s=t.Matrix.transform(k,t.datavisualization.Diagram.Point(e,o));e=s.x;o=s.y;w=(n.height+o)/n.height;break;case"ne-resize":o=this._snapTop(h,c,a,l,n,r==i);b=t.Matrix.transform(d,t.datavisualization.Diagram.Point(v,y+nt));e=this._snapRight(h,c,a,l,n,r==i);s=t.Matrix.transform(k,t.datavisualization.Diagram.Point(e,o));e=s.x;o=s.y;p=(n.width+e)/n.width;w=(n.height-o)/n.height;break;case"nw-resize":o=this._snapTop(h,c,a,l,n,r==i);b=t.Matrix.transform(d,t.datavisualization.Diagram.Point(v+g,y+nt));e=this._snapLeft(h,c,a,l,n,r==i);s=t.Matrix.transform(k,t.datavisualization.Diagram.Point(e,o));e=s.x;o=s.y;p=(n.width-e)/n.width;w=(n.height-o)/n.height;break;case"se-resize":b=t.Matrix.transform(d,t.datavisualization.Diagram.Point(v,y));o=this._snapBottom(h,c,a,l,n,r==i);e=this._snapRight(h,c,a,l,n,r==i);s=t.Matrix.transform(k,t.datavisualization.Diagram.Point(e,o));e=s.x;o=s.y;p=(n.width+e)/n.width;w=(n.height+o)/n.height;break;case"sw-resize":b=t.Matrix.transform(d,t.datavisualization.Diagram.Point(v+g,y));o=this._snapBottom(h,c,a,l,n,r==i);e=this._snapLeft(h,c,a,l,n,r==i);s=t.Matrix.transform(k,t.datavisualization.Diagram.Point(e,o));e=s.x;o=s.y;p=(n.width-e)/n.width;w=(n.height+o)/n.height}tt=t.datavisualization.Diagram.Size();tt.width=p;tt.height=w;t.datavisualization.Diagram.Geometry.isEmptySize(tt)||(this.diagram._scale(n,p,w,b,this.diagram.nameTable),rt=this._raiseEvent("sizeChange",{element:this.selectedObject,offset:tt,cancel:!1}),rt.cancel&&this.diagram._scale(n,-p,-w,b,this.diagram.nameTable),n.isGroup&&t.datavisualization.Diagram.Util._updateGroupBounds(n,this.diagram.nameTable))},r.prototype._snapTop=function(n,i,r,u,f,e){var o=u,s,a,h,c,l;return i.top=!0,s=this.diagram.model.snapSettings,a=this.diagram.model.zoomFactor,s.enableSnapToObject&&t.datavisualization.Diagram.SnapUtil._snapSize(this.diagram,n,i,r,u,this.selectedObject,e),h=t.datavisualization.Diagram.Util.bounds(f),i.snapped?(this.diffy=o-i.offset,o=i.offset):s.snapConstraints&t.datavisualization.Diagram.SnapConstraints.SnapToHorizontalLines&&(c=h.top+u,l=t.datavisualization.Diagram.SnapUtil._round(c,s.horizontalGridLines.snapInterval,a),o=l-h.top,this.diffy=c-l),o},r.prototype._snapBottom=function(n,i,r,u,f,e){var o=u,s,a,h,c,l;return i.bottom=!0,s=this.diagram.model.snapSettings,a=this.diagram.model.zoomFactor,s.enableSnapToObject&&t.datavisualization.Diagram.SnapUtil._snapSize(this.diagram,n,i,r,u,this.selectedObject,e),h=t.datavisualization.Diagram.Util.bounds(f),i.snapped?(this.diffy=o-i.offset,o=i.offset):s.snapConstraints&t.datavisualization.Diagram.SnapConstraints.SnapToHorizontalLines&&(c=h.bottom+u,l=t.datavisualization.Diagram.SnapUtil._round(c,s.horizontalGridLines.snapInterval,a),o=l-h.bottom,this.diffy=c-l),o},r.prototype._snapLeft=function(n,i,r,u,f,e){var o=r,s,a,h,c,l;return n.left=!0,s=this.diagram.model.snapSettings,a=this.diagram.model.zoomFactor,s.enableSnapToObject&&t.datavisualization.Diagram.SnapUtil._snapSize(this.diagram,n,i,r,u,this.selectedObject,e),h=t.datavisualization.Diagram.Util.bounds(f),n.snapped?(this.diffx=o-n.offset,o=n.offset):s.snapConstraints&t.datavisualization.Diagram.SnapConstraints.SnapToVerticalLines&&(c=h.left+r,l=t.datavisualization.Diagram.SnapUtil._round(c,s.verticalGridLines.snapInterval,a),o=l-h.left,this.diffx=c-l),o},r.prototype._snapRight=function(n,i,r,u,f,e){var o=r,s,a,h,c,l;return n.right=!0,s=this.diagram.model.snapSettings,a=this.diagram.model.zoomFactor,s.enableSnapToObject&&t.datavisualization.Diagram.SnapUtil._snapSize(this.diagram,n,i,r,u,this.selectedObject,e),h=t.datavisualization.Diagram.Util.bounds(f),n.snapped?(this.diffx=o-n.offset,o=n.offset):s.snapConstraints&t.datavisualization.Diagram.SnapConstraints.SnapToVerticalLines&&(c=h.right+r,l=t.datavisualization.Diagram.SnapUtil._round(c,s.verticalGridLines.snapInterval,a),o=l-h.right,this.diffx=c-l),o},r}(i);t.datavisualization.Diagram.ResizeTool=e;o=function(i){function r(n){i.call(this,"endPoint",n);this.cursor="move";this._endPoint=null;this._undoObject=null}return t.datavisualization.Diagram.extend(r,i),r.prototype.mousedown=function(n){i.prototype.mousedown.call(this,n);this.selectedObject=this.diagram.nameTable[this.diagram.selectionList[0].name];this.undoObject=this._getClonedObject(this.selectedObject);this._endPoint=n.target.getAttribute("class")},r.prototype.mousemove=function(r){i.prototype.mousemove.call(this,r);this.selectedObject&&(this.inAction||this.startPoint.x==this.currentPoint.x&&this.startPoint.y==this.currentPoint.y?((this._endPoint=="targetEndPoint"||this._endPoint=="sourceEndPoint")&&this._checkConnectionPossible(r),this._updatePoints(this.selectedObject),this._disconnect(this.selectedObject),this._updateConnection(this.selectedObject),t.datavisualization.Diagram.SvgContext.update(this.selectedObject,this.diagram),this.diagram._updateSelectionHandle(!0)):(this.inAction=!0,n(this.diagram._svg.getElementById(this.selectedObject.name)).attr("pointer-events","none"),n(this.diagram._svg.getElementById(this.selectedObject.name+"_line_hitTest")).attr("pointer-events","none"),n("#"+this.diagram._svg.document.id+"handle_g").attr("pointer-events","none"),this.undoObject=this._getClonedObject(this.selectedObject)));this.previousPoint=this.currentPoint},r.prototype.mouseup=function(r){var u;this.inAction&&(this.inAction=!1,this._updatePoints(this.selectedObject),this._disconnect(this.selectedObject),this._currentPossibleConnection&&!this.inAction?this._updateConnection(this.selectedObject):(this.selectedObject.sourceNode||this.selectedObject.targetNode)&&this._updateConnection(this.selectedObject),t.datavisualization.Diagram.SvgContext.update(this.selectedObject,this.diagram),u={type:"endpointchanged",undoObject:this.undoObject,redoObject:this._getClonedObject(this.selectedObject),isMultipleNode:this.selectedObject.isGroup?!0:!1},this.diagram.addHistoryEntry(u),this.selectedObject.parent&&t.datavisualization.Diagram.Util._updateGroupBounds(this.diagram.nameTable[this.selectedObject.parent],this.diagram.nameTable),this.diagram._updateSelectionHandle());this.selectedObject&&(n(this.diagram._svg.getElementById(this.selectedObject.name)).removeAttr("pointer-events"),n(this.diagram._svg.getElementById(this.selectedObject.name+"_line_hitTest")).attr("pointer-events","stroke"));n("#"+this.diagram._svg.document.id+"handle_g").removeAttr("pointer-events");i.prototype.mouseup.call(this,r)},r.prototype._getClonedObject=function(t){var i=n.extend(!0,{},t);return i.targetNode=t.targetNode,i.sourceNode=t.sourceNode,i.targetPort=t.targetPort,i.sourcePort=t.sourcePort,i},r.prototype._updateConnection=function(n){var i;this._currentPossibleConnection&&(this._endPoint=="targetEndPoint"?this._possibleConnectionPort&&t.datavisualization.Diagram.Util.canConnect(this._possibleConnectionPort,!0)?(i=this._raiseEvent("connectionChange",{element:this.selectedObject,endPoint:this._endPoint,connection:this._currentPossibleConnection,port:this._possibleConnectionPort,cancel:!1}),i.cancel||(n.targetNode=this._currentPossibleConnection.name,n.targetPort=this._possibleConnectionPort.name,this._currentPossibleConnection.inEdges.push(n.name))):t.datavisualization.Diagram.Util.canConnect(this._currentPossibleConnection)&&(i=this._raiseEvent("connectionChange",{element:this.selectedObject,endPoint:this._endPoint,connection:this._currentPossibleConnection,port:this._possibleConnectionPort,cancel:!1}),i.cancel||(n.targetNode=this._currentPossibleConnection.name,this._currentPossibleConnection.inEdges.push(n.name))):this._possibleConnectionPort&&t.datavisualization.Diagram.Util.canConnect(this._possibleConnectionPort,!0)?(i=this._raiseEvent("connectionChange",{element:this.selectedObject,endPoint:this._endPoint,connection:this._currentPossibleConnection,port:this._possibleConnectionPort,cancel:!1}),i.cancel||(n.sourceNode=this._currentPossibleConnection.name,n.sourcePort=this._possibleConnectionPort.name,this._currentPossibleConnection.outEdges.push(n.name))):t.datavisualization.Diagram.Util.canConnect(this._currentPossibleConnection)&&(i=this._raiseEvent("connectionChange",{element:this.selectedObject,endPoint:this._endPoint,connection:this._currentPossibleConnection,port:this._possibleConnectionPort,cancel:!1}),i.cancel||(n.sourceNode=this._currentPossibleConnection.name,this._currentPossibleConnection.outEdges.push(n.name))));this.diagram._dock(n,this.diagram.nameTable)},r.prototype._disconnect=function(n){var r,i=this.diagram.nameTable[n.targetNode],u=null;this._endPoint=="targetEndPoint"&&i&&(u=t.datavisualization.Diagram.Util.findPortByName(i,n.targetPort),r=this._raiseEvent("connectionChange",{element:n,endPoint:this._endPoint,connection:i,port:u,cancel:!1}),r.cancel||(t.datavisualization.Diagram.Util.removeItem(i.inEdges,n.name),n.targetNode=null,n.targetPort=null));i=this.diagram.nameTable[n.sourceNode];this._endPoint=="sourceEndPoint"&&i&&(u=t.datavisualization.Diagram.Util.findPortByName(i,n.sourcePort),r=this._raiseEvent("connectionChange",{element:n,endPoint:this._endPoint,connection:i,port:u,cancel:!1}),r.cancel||(t.datavisualization.Diagram.Util.removeItem(i.outEdges,n.name),n.sourceNode=null,n.sourcePort=null))},r.prototype._initHelper=function(){i.prototype._initHelper.call(this);this.helper.targetNode=this.selectedObject.targetNode;this.helper.targetPort=this.selectedObject.targetPort;this.helper.sourceNode=this.selectedObject.sourceNode;this.helper.sourcePort=this.selectedObject.sourcePort},r.prototype._endAction=function(){this._showPorts();var n;this._currentPossibleConnection&&!this._possibleConnectionPort&&(n=this._currentPossibleConnection);i.prototype._endAction.apply(this);this._endPoint&&(this._endPoint=null,n&&(this.diagram._checkToolToActivate(n,this.currentPoint),this.diagram._updateCursor()))},r.prototype._renderHelper=function(){this.svgHelper||(this.svgHelper=t.datavisualization.Diagram.SvgContext.renderConnector(this.helper,this.diagram._svg,this.diagram._diagramLayer),this.svgHelper.setAttribute("pointer-events","none"))},r.prototype._updateHelper=function(){},r.prototype._updatePoints=function(n){var f=this._endPoint=="targetEndPoint"?!0:!1,o=this._endPoint=="sourceEndPoint"?!0:!1,r,i,s,e,h,u;if(this._endPoint){switch(this._endPoint){case"targetEndPoint":r=n.line.endPoint;break;case"sourceEndPoint":r=n.line.startPoint;break;case"bezierpoint1":r=n.line._point1;break;case"bezierpoint2":r=n.line._point2}i=this.currentPoint;this._possibleConnectionPort==null&&(i=this.snap(i));s=t.datavisualization.Diagram.Point(r.x-i.x,r.y-i.y);t.datavisualization.Diagram.Geometry.isEmptyPoint(s)||(e=!1,u=null,this.inAction||(f?u="target":o&&(u="source"),h=this._raiseEvent("drag",{end:u,element:this.selectedObject,cancel:!1}),e=h.cancel),e||(f||o?this.diagram._setEndPoint(n,t.datavisualization.Diagram.Point(i.x,i.y),f):t.datavisualization.Diagram.Util._setBezierPoint(n,t.datavisualization.Diagram.Point(i.x,i.y),this._endPoint)))}},r}(i);t.datavisualization.Diagram.EndPointTool=o;r=function(i){function r(n,t){i.call(this,n,t);this.cursor="crosshair";this._isMouseDown=!1;this._targetPossibleConnection=null;this._sourcePossibleConnection=null;this._targetPort=null;this._sourcePort=null}return t.datavisualization.Diagram.extend(r,i),r.prototype.mousedown=function(n){i.prototype.mousedown.call(this,n);this._isMouseDown=!0;this.diagram._hasSelection()&&this.diagram._clearSelection();this._currentPossibleConnection&&(this._sourcePossibleConnection=this._currentPossibleConnection,this._sourcePort=this._possibleConnectionPort)},r.prototype.mousemove=function(n){i.prototype.mousemove.call(this,n);this._checkConnectionPossible(n);this._isMouseDown&&(this.inAction?(this._targetPossibleConnection=this._currentPossibleConnection,this._targetPort=this._possibleConnectionPort,this._updateHelper()):(this.inAction=!0,this._initHelper(),this._renderHelper()));this.previousPoint=this.currentPoint},r.prototype.mouseup=function(n){var r,u;if(this._isMouseDown=!1,this.inAction){this.inAction=!1;var f=this._getStartPoint(),e=this._getCurrentPoint(),o=t.datavisualization.Diagram.Geometry.distance(f,e);o>0&&(r=this.createConnector(f,e),r.name="connector"+t.datavisualization.Diagram.Util.randomId(),this._sourcePossibleConnection&&(this._sourcePort&&t.datavisualization.Diagram.Util.canConnect(this._sourcePort,!0)?(u=this._raiseEvent("connectionChange",{element:r,connection:this._sourcePossibleConnection,port:this._sourcePort,cancel:!1}),u.cancel||(r.sourceNode=this._sourcePossibleConnection.name,r.sourcePort=this._sourcePort.name,t.datavisualization.Diagram.Util.removeItem(this._sourcePossibleConnection.outEdges,this.helper.name))):t.datavisualization.Diagram.Util.canConnect(this._sourcePossibleConnection)&&(u=this._raiseEvent("connectionChange",{element:r,connection:this._sourcePossibleConnection,port:this._sourcePort,cancel:!1}),u.cancel||(r.sourceNode=this._sourcePossibleConnection.name,t.datavisualization.Diagram.Util.removeItem(this._sourcePossibleConnection.outEdges,this.helper.name)))),this._targetPossibleConnection&&(this._targetPort&&t.datavisualization.Diagram.Util.canConnect(this._targetPort,!0)?(u=this._raiseEvent("connectionChange",{element:r,connection:this._targetPossibleConnection,port:this._targetPort,cancel:!1}),u.cancel||(r.targetNode=this._targetPossibleConnection.name,r.targetPort=this._targetPort.name,t.datavisualization.Diagram.Util.removeItem(this._targetPossibleConnection.inEdges,this.helper.name))):t.datavisualization.Diagram.Util.canConnect(this._targetPossibleConnection)&&(u=this._raiseEvent("connectionChange",{element:r,connection:this._targetPossibleConnection,port:this._targetPort,cancel:!1}),u.cancel||(r.targetNode=this._targetPossibleConnection.name,t.datavisualization.Diagram.Util.removeItem(this._targetPossibleConnection.inEdges,this.helper.name)))),this.diagram.add(r))}this.singleAction&&this.diagram.deactivateTool();this._prevTool&&(this._prevTool.inAction=!1);this._showPorts();i.prototype.mouseup.call(this,n)},r.prototype._getStartPoint=function(){return this._sourcePossibleConnection&&this._sourcePort?t.datavisualization.Diagram.Util._getPortPosition(this._sourcePort,t.datavisualization.Diagram.Util.bounds(this._sourcePossibleConnection)):this.snap(this.startPoint)},r.prototype._getCurrentPoint=function(){return this._targetPossibleConnection&&this._targetPort?t.datavisualization.Diagram.Util._getPortPosition(this._targetPort,t.datavisualization.Diagram.Util.bounds(this._targetPossibleConnection)):this.snap(this.currentPoint)},r.prototype._initHelper=function(){this.helper=this.createConnector(t.datavisualization.Diagram.Point(0,0),t.datavisualization.Diagram.Point(0,0));this.helper.name="helper"},r.prototype.createConnector=function(){return null},r.prototype._renderHelper=function(){this.svgHelper||(this.svgHelper=t.datavisualization.Diagram.SvgContext.renderConnector(this.helper,this.diagram._svg,this.diagram._diagramLayer),this.svgHelper.setAttribute("pointer-events","none"),n(this.diagram._svg.getElementById(this.svgHelper.id)).attr("pointer-events","none"),n(this.diagram._svg.getElementById(this.svgHelper.id+"_line_hitTest")).attr("pointer-events","none"))},r.prototype._updateHelper=function(){var n=[],i=this._getStartPoint(),r=this._getCurrentPoint();n.push(i);n.push(r);this.diagram._setEndPoint(this.helper,i,!1);this.diagram._setEndPoint(this.helper,r,!0);this._disconnect(this.helper);this._sourcePossibleConnection&&(this._sourcePort&&t.datavisualization.Diagram.Util.canConnect(this._sourcePort,!0)?(this.helper.sourceNode=this._sourcePossibleConnection.name,this.helper.sourcePort=this._sourcePort.name,this._sourcePossibleConnection.outEdges.push(this.helper.name)):t.datavisualization.Diagram.Util.canConnect(this._sourcePossibleConnection)&&(this.helper.sourceNode=this._sourcePossibleConnection.name,this._sourcePossibleConnection.outEdges.push(this.helper.name)));this._targetPossibleConnection&&(this._targetPort&&t.datavisualization.Diagram.Util.canConnect(this._targetPort,!0)?(this.helper.targetNode=this._targetPossibleConnection.name,this.helper.targetPort=this._targetPort.name,this._targetPossibleConnection.inEdges.push(this.helper.name)):t.datavisualization.Diagram.Util.canConnect(this._targetPossibleConnection)&&(this.helper.targetNode=this._targetPossibleConnection.name,this._targetPossibleConnection.inEdges.push(this.helper.name)));this.diagram._dock(this.helper,this.diagram.nameTable);t.datavisualization.Diagram.SvgContext.update(this.helper,this.diagram)},r.prototype._endAction=function(){i.prototype._endAction.apply(this);this._targetPossibleConnection=null;this._sourcePossibleConnection=null;this._targetPort=null;this._sourcePort=null;this._isMouseDown=!1},r.prototype._showPorts=function(){},r.prototype._showAllPorts=function(n){i.prototype._showAllPorts.call(this,n)},r}(i);t.datavisualization.Diagram.LineTool=r;s=function(n){function i(t){n.call(this,"straightLine",t)}return t.datavisualization.Diagram.extend(i,n),i.prototype.createConnector=function(n,i){return t.datavisualization.Diagram.Connector({line:{type:"straight",startPoint:n,endPoint:i}})},i}(r);t.datavisualization.Diagram.StraightLineTool=s;h=function(n){function i(t){n.call(this,"orthogonalLine",t)}return t.datavisualization.Diagram.extend(i,n),i.prototype.createConnector=function(n,i){return t.datavisualization.Diagram.Connector({line:{type:"orthogonal",startPoint:n,endPoint:i}})},i}(r);t.datavisualization.Diagram.OrthogonalLineTool=h;c=function(i){function r(n){i.call(this,"rotatetool",n);this._mouseOffset=t.datavisualization.Diagram.Size(0,0);this.undoObject=null}return t.datavisualization.Diagram.extend(r,i),r.prototype.mousedown=function(t){var u,r,f,e;i.prototype.mousedown.call(this,t);this.selectedObject=this.diagram.selectionList[0];r={};(this.selectedObject.isGroup||this.selectedObject.isPseudoGroup)&&(r=this.diagram._getChildTable(this.selectedObject,r));f={childTable:r,node:this.selectedObject};u=n.extend(!0,{},f);this.undoObject=jQuery.extend(!0,{},u);e=this.diagram.model.zoomFactor},r.prototype.mousemove=function(n){i.prototype.mousemove.call(this,n);this.selectedObject&&(this.inAction?(this._rotate(this.selectedObject),this.selectedObject.parent&&t.datavisualization.Diagram.Util._updateGroupBounds(this.diagram.nameTable[this.selectedObject.parent],this.diagram.nameTable),t.datavisualization.Diagram.SvgContext.update(this.selectedObject,this.diagram),this.diagram._updateSelectionHandle(!0),this.diagram._renderTooltip(this.selectedObject)):this.inAction=!0);this.previousPoint=this.currentPoint},r.prototype._rotate=function(n){var r=!1,u;if(this.inAction||(u=this._raiseEvent("rotationChange",{element:n,cancel:!1}),r=u.cancel),!r){var f=t.datavisualization.Diagram.Point(n.offsetX,n.offsetY),e=this.currentPoint,i=t.datavisualization.Diagram.Geometry.findAngle(t.datavisualization.Diagram.Point(f.x,f.y),e)+90;i=t.datavisualization.Diagram.SnapUtil._snapAngle(this.diagram,i);this.diagram._rotate(n,i-n.rotateAngle,this.diagram.nameTable)}},r.prototype.mouseup=function(r){var f,u,e,o;this.inAction&&(this.inAction=!1,this._rotate(this.selectedObject),t.datavisualization.Diagram.SvgContext.update(this.selectedObject,this.diagram),u={},(this.selectedObject.isGroup||this.selectedObject.isPseudoGroup)&&(u=this.diagram._getChildTable(this.selectedObject,u)),e={childTable:u,node:this.selectedObject},f=n.extend(!0,{},e),o={type:"rotationchanged",undoObject:this.undoObject,redoObject:jQuery.extend(!0,{},f),isMultipleNode:this.selectedObject.isGroup?!0:!1},this.diagram.addHistoryEntry(o),this.diagram._updateSelectionHandle(),this.diagram._removeTooltip());i.prototype.mouseup.call(this,r)},r}(i);t.datavisualization.Diagram.RotateTool=c;l=function(n){function i(i){n.call(this,"PivotTool",i);this._mouseOffset=t.datavisualization.Diagram.Size(0,0)}return t.datavisualization.Diagram.extend(i,n),i.prototype.mousedown=function(t){n.prototype.mousedown.call(this,t);this.selectedObject=this.diagram.selectionList[0]},i.prototype.mousemove=function(i){if(n.prototype.mousemove.call(this,i),this.selectedObject)if(this.inAction){var r=this.currentPoint.x-this.previousPoint.x,u=this.currentPoint.y-this.previousPoint.y,f=t.Matrix.identity();t.Matrix.rotate(f,-this.selectedObject.rotateAngle);var e=t.Matrix.transform(f,t.datavisualization.Diagram.Point(r,u)),o=(this.selectedObject.width*this.selectedObject.pivot.x+e.x)/this.selectedObject.width,s=(this.selectedObject.height*this.selectedObject.pivot.y+e.y)/this.selectedObject.height;this.selectedObject.pivot.x=o;this.selectedObject.pivot.y=s;this.selectedObject.offsetX+=r;this.selectedObject.offsetY+=u;this.diagram._updateSelectionHandle()}else this.inAction=!0;this.previousPoint=this.currentPoint},i.prototype._rotate=function(n){var i=t.datavisualization.Diagram.Point(n.offsetX,n.offsetY),r=this.currentPoint,u=this.FindAngle(i,r);this.diagram._rotate(n,u-n.rotateAngle,i,this.diagram.nameTable)},i.prototype.mouseup=function(t){this.inAction&&(this.inAction=!1,this.diagram._updateSelectionHandle());n.prototype.mouseup.call(this,t)},i}(i);t.datavisualization.Diagram.PivotTool=l;a=function(n){function i(t){n.call(this,"panTool",t);this.diagram=t;this._isMouseDown=!1;this.cursor="pointer"}return t.datavisualization.Diagram.extend(i,n),i.prototype.mousedown=function(i){var u,r,f;return n.prototype.mousedown.call(this,i),this.diagram.activeTool instanceof t.datavisualization.Diagram.PanTool?(u=this.diagram._svg.document,r=this.diagram._svg.document.createSVGPoint(),r.x=i.clientX,r.y=i.clientY,f=r.matrixTransform(this.diagram._svg.document.getScreenCTM().inverse()),u.lastMouseX=f.x,u.lastMouseY=f.y,this._isMouseDown=!0,!1):void 0},i.prototype.mousemove=function(i){var r,u;if(n.prototype.mousemove.call(this,i),this.diagram.activeTool instanceof t.datavisualization.Diagram.PanTool&&this._isMouseDown){this.inAction=!0;r=this.diagram._svg.document;u=this.diagram._svg.document.createSVGPoint();u.x=i.clientX;u.y=i.clientY;var h=u.matrixTransform(this.diagram._svg.document.getScreenCTM().inverse()),f=h.x,e=h.y,o,s;return o=f-r.lastMouseX,s=e-r.lastMouseY,document.getElementById(this.diagram.element[0].id).getElementsByClassName("e-hhandle").length>0||(o=0),document.getElementById(this.diagram.element[0].id).getElementsByClassName("e-vhandle").length>0||(s=0),t.datavisualization.Diagram.ZoomUtil.zoomPan(this.diagram,1,o,s,t.datavisualization.Diagram.Point(f,e)),r.lastMouseX=f,r.lastMouseY=e,!1}},i.prototype.mouseup=function(i){this.diagram.activeTool instanceof t.datavisualization.Diagram.PanTool&&(this.inAction=!1,document.onmousemove=null,document.onmouseup=null,this._isMouseDown=!1);n.prototype.mouseup.call(this,i)},i}(i);t.datavisualization.Diagram.PanTool=a;v=function(n){function i(t,i){n.call(this,t,i);this.cursor="crosshair"}return t.datavisualization.Diagram.extend(i,n),i.prototype.mousedown=function(t){n.prototype.mousedown.call(this,t);this.selectedObject=this.createNode()},i.prototype.createNode=function(){},i.prototype.mousemove=function(t){n.prototype.mousemove.call(this,t);this.selectedObject&&(this.inAction?this._updateHelper():(this.inAction=!0,this._initHelper(),this._renderHelper(),this._calcOffset()))},i.prototype.mouseup=function(t){this.inAction&&(this.inAction=!1,this.diagram.model.snapSettings.snapConstraints.snapToLines&&this._calcOffset(),this._updateSize(this.selectedObject,this.startPoint,this.currentPoint),this.diagram.add(this.selectedObject),this.diagram._clearSelection(),this.diagram._addSelection(this.selectedObject));this.diagram._toolToActivate="selectTool";this.diagram._drawingTool=!1;n.prototype.mouseup.call(this,t)},i.prototype._calcOffset=function(){var r=this.diagram.model.magnification/100,n=t.datavisualization.Diagram.Util.bounds(this.helper),i=n.topLeft;i=t.datavisualization.Diagram.Point(n.x+n.width,n.y+n.height);var u=i.x*r,f=i.y*r,e=t.datavisualization.Diagram.Point(u,f),o=this.snap(t.datavisualization.Diagram.Point(u,f));this._mouseOffset=t.datavisualization.Diagram.Size(e.x-o.x,e.y-o.y)},i.prototype.getBoundingRect=function(){var u=Math.abs(this.startPoint.x-this.currentPoint.x),f=Math.abs(this.startPoint.y-this.currentPoint.y),n=t.datavisualization.Diagram.Size(u,f),i,r;return this.diagram.model.snapSettings.snapConstraints.snapToVerticalLines&&this._mouseOffset.width!=0&&(n.width-=this._mouseOffset.width,this._mouseOffset.width=0),this.diagram.model.snapSettings.snapConstraints.snapToHorizontalLines&&this._mouseOffset.height!=0&&(n.height-=this._mouseOffset.height,this._mouseOffset.height=0),i=this.startPoint.x>this.currentPoint.x?this.currentPoint.x:this.startPoint.x,r=this.startPoint.y>this.currentPoint.y?this.currentPoint.y:this.startPoint.y,{size:n,offset:t.datavisualization.Diagram.Point(i,r)}},i.prototype._renderHelper=function(){this.svgHelper||(this.svgHelper=t.datavisualization.Diagram.SvgContext.renderNode(this.helper,this.diagram._svg,this.diagram._diagramLayer),this.svgHelper.setAttribute("pointer-events","none"))},i.prototype._updateHelper=function(){this._updateSize(this.helper,this.startPoint,this.currentPoint);t.datavisualization.Diagram.SvgContext.update(this.helper,this.diagram)},i.prototype._updateSize=function(n,i,r){var f=this.getBoundingRect(i,r),u=f.size,e=f.offset;t.datavisualization.Diagram.Geometry.isEmptySize(u)||(n.offsetX=e.x+u.width/2,n.offsetY=e.y+u.height/2,n.width=u.width,n.height=u.height)},i}(t.datavisualization.Diagram.Tool);t.datavisualization.Diagram.RectangleToolBase=v;y=function(n){function i(t,i){n.call(this,t,i);this.cursor="crosshair"}return t.datavisualization.Diagram.extend(i,n),i.prototype.createNode=function(){},i.prototype.mousedown=function(t){n.prototype.mousedown.call(this,t)},i.prototype.mousemove=function(t){n.prototype.mousemove.call(this,t);this.selectedObject&&(this.inAction?this._updateHelper(this.snap(this.currentPoint)):(this.inAction=!0,this._initHelper(),this._renderHelper(),this._calcOffset()))},i.prototype.mouseup=function(){if(this.selectedObject)this.inAction&&this.helper.shape.points.push(t.datavisualization.Diagram.Point(this.currentPoint.x,this.currentPoint.y));else if(this.startPoint){this.selectedObject=this.createNode();var n=this.snap(this.startPoint),i=this.snap(this.currentPoint);this.selectedObject.shape.points.push(t.datavisualization.Diagram.Point(n.x,n.y));this.selectedObject.shape.points.push(t.datavisualization.Diagram.Point(i.x,i.y))}},i.prototype._calcOffset=function(){var r=this.diagram.model.magnification/100,n=t.datavisualization.Diagram.Util.bounds(this.helper),i=n.topLeft;i=t.datavisualization.Diagram.Point(n.x+n.width,n.y+n.height);var u=i.x*r,f=i.y*r,e=t.datavisualization.Diagram.Point(u,f),o=this.snap(t.datavisualization.Diagram.Point(u,f));this._mouseOffset=t.datavisualization.Diagram.Size(e.x-o.x,e.y-o.y)},i.prototype._renderHelper=function(){if(!this.svgHelper){var n=t.datavisualization.Diagram.Geometry.rect(this.helper.shape.points);this.helper.offsetX=n.x+n.width/2;this.helper.offsetY=n.y+n.height/2;this.helper.width=n.width;this.helper.height=n.height;this.svgHelper=t.datavisualization.Diagram.SvgContext.renderNode(this.helper,this.diagram._svg,this.diagram._diagramLayer);this.svgHelper.setAttribute("pointer-events","none")}},i.prototype.doubleclick=function(){if(this.selectedObject){t.datavisualization.Diagram.Util.removeItem(this.helper.shape.points,this.helper.shape.points[this.helper.shape.points.length-2]);t.datavisualization.Diagram.Util.removeItem(this.helper.shape.points,this.helper.shape.points[this.helper.shape.points.length-1]);this.selectedObject.shape.points=this.helper.shape.points;var n=t.datavisualization.Diagram.Geometry.rect(this.helper.shape.points);this.selectedObject.offsetX=n.x+n.width/2;this.selectedObject.offsetY=n.y+n.height/2;this.selectedObject.width=n.width;this.selectedObject.height=n.height;this.diagram.model.nodes.push(this.selectedObject);this.diagram.nameTable[this.selectedObject.name]=this.selectedObject;t.datavisualization.Diagram.SvgContext.renderNode(this.selectedObject,this.diagram._svg,this.diagram._diagramLayer);this.diagram._clearSelection();this.diagram._addSelection(this.selectedObject)}this._svgHelper&&(this.diagram._svg.removeChild(this._svgHelper),this._svgHelper=null);this._endAction();this.diagram._drawingTool=!1;this.diagram._toolToActivate="selectTool";this._mouseOffset=t.datavisualization.Diagram.Size(0,0)},i.prototype._updateHelper=function(n){this.helper.shape.points[this.helper.shape.points.length-1]=t.datavisualization.Diagram.Point(n.x,n.y);var i=t.datavisualization.Diagram.Geometry.rect(this.helper.shape.points);this.helper.offsetX=i.x+i.width/2;this.helper.offsetY=i.y+i.height/2;this.helper.width=i.width;this.helper.height=i.height;t.datavisualization.Diagram.SvgContext.update(this.helper,this.diagram)},i}(t.datavisualization.Diagram.Tool);t.datavisualization.Diagram.PolygonToolBase=y;p=function(i){function r(n,r){i.call(this,n,r);this.boundingRect=t.datavisualization.Diagram.Rectangle();this.activeLabel=null;this.cursor="crosshair"}return t.datavisualization.Diagram.extend(r,i),r.prototype.mousedown=function(n){i.prototype.mousedown.call(this,n);this.diagram._isEditing&&this.diagram._endEdit()},r.prototype.createNode=function(){},r.prototype.mousemove=function(n){i.prototype.mousemove.call(this,n);this.selectedObject||t.datavisualization.Diagram.Geometry.isEmptyPoint(this.startPoint)||this.diagram._isEditing||(this.inAction?this._updateHelper():(this.inAction=!0,this._initHelper()))},r.prototype.mouseup=function(n){var r,u,i;this.activeLabel=null;r=12;this.inAction?(i=this.getBoundingRect(this.startPoint,this.currentPoint),this._endAction(),t.browserInfo().name==="chrome"&&(i.width===0||i.height===0)&&(i.width=90,i.height=r),this.selectedObject=this.createNode(i.x+i.width/2,i.y+i.height/2,i.width,i.height),this.diagram._startEdit(this.selectedObject)):(u=this._findNodeUnderMouse(n),u!=null?(this.selectedObject=u,this.diagram._startEdit(this.selectedObject)):(i=t.datavisualization.Diagram.Rectangle(this.currentPoint.x-45,this.currentPoint.y-r/2,90,r),this._endAction(),this.selectedObject=this.createNode(i.x+i.width/2,i.y+i.height/2,i.width,r),this.diagram._startEdit(this.selectedObject)))},r.prototype.getBoundingRect=function(){var n=Math.abs(this.startPoint.x-this.currentPoint.x),t=Math.abs(this.startPoint.y-this.currentPoint.y),i=this.startPoint.x>this.currentPoint.x?this.currentPoint.x:this.startPoint.x,r=this.startPoint.y>this.currentPoint.y?this.currentPoint.y:this.startPoint.y;return{x:i,y:r,width:n,height:t}},r.prototype._initHelper=function(){var n,t,i;this._svgHelper||(n=this.diagram._svg.g(),this.diagram._adornerLayer.appendChild(n),t=this.diagram.model.zoomFactor,i=this.diagram._svg.rect({id:"helper",x:this.startPoint.x*t,y:this.startPoint.y*t,fill:"transparent",stroke:"gray","stroke-dasharray":"2 2","shape-rendering":"crispEdges"}),n.appendChild(i),n.setAttribute("pointer-events","none"),this._svgHelper=n)},r.prototype._updateHelper=function(){var t=this.diagram._svg.getElementById("helper"),i=Math.abs(this.startPoint.x-this.currentPoint.x),r=Math.abs(this.startPoint.y-this.currentPoint.y),n=this.diagram.model.zoomFactor,u=(this.startPoint.x>this.currentPoint.x?this.currentPoint.x:this.startPoint.x)*n,f=(this.startPoint.y>this.currentPoint.y?this.currentPoint.y:this.startPoint.y)*n;t&&this.diagram._svg.rect({id:t.id,x:u,y:f,width:i*n,height:r*n})},r.prototype._endAction=function(){this._svgHelper&&(this.diagram._adornerLayer.removeChild(this._svgHelper),this._svgHelper=null);i.prototype._endAction.apply(this)},r.prototype._findNodeUnderMouse=function(t){var i,r=n(t.target).parents("text")[0],o,s,u,e;if(r!=null)r.getAttribute("class")=="ej-d-label"&&(o=n(r).parents("g")[0],i=this._findObj(o),i.shape.type!="text"&&(s=r.id.split("_"),this.activeLabel=i.labels.find(s[1])));else if(u=n(t.target).parents("g"),u.length>3){var h=u[u.length-4],c=h.getAttribute("id"),f=h.getAttribute("class");f&&(f==="ej-d-node"||f==="ej-d-group"?(i=this.diagram._findNode(c),e=this.diagram._findLabelAtPoint(this.currentPoint,i),this.activeLabel=e):f==="ej-d-connector"&&(i=this.diagram._findConnector(c),e=this.diagram._findLabelAtPoint(this.currentPoint,i),this.activeLabel=e))}return i},r.prototype.getLabelUnderMouse=function(){return this.activeLabel},r}(t.datavisualization.Diagram.Tool);t.datavisualization.Diagram.TextToolBase=p;w=function(n){function i(t){n.call(this,"rectangleTool",t)}return t.datavisualization.Diagram.extend(i,n),i.prototype.createNode=function(){var n=t.datavisualization.Diagram.Node({name:"rectangle"+t.datavisualization.Diagram.Util.randomId()});return n.offsetX=0,n.offsetY=0,n.width=0,n.height=0,n},i}(t.datavisualization.Diagram.RectangleToolBase);t.datavisualization.Diagram.RectangleTool=function(n){return new w(n)};b=function(n){function i(t){n.call(this,"ellipseTool",t)}return t.datavisualization.Diagram.extend(i,n),i.prototype.createNode=function(){var n=t.datavisualization.Diagram.Node({name:"ellipse"+t.datavisualization.Diagram.Util.randomId()});return n.shape.type=t.datavisualization.Diagram.Shapes.Ellipse,n.fillColor="white",n.offsetX=0,n.offsetY=0,n.width=0,n.height=0,n},i}(t.datavisualization.Diagram.RectangleToolBase);t.datavisualization.Diagram.EllipseTool=function(n){return new b(n)};k=function(n){function i(t){n.call(this,"roundRectTool",t)}return t.datavisualization.Diagram.extend(i,n),i.prototype.createNode=function(){var n=t.datavisualization.Diagram.Node({name:"roundrect"+t.datavisualization.Diagram.Util.randomId()});return n.shape.type=t.datavisualization.Diagram.Shapes.Rectangle,n.shape.cornerRadius=15,n.offsetX=0,n.offsetY=0,n.width=0,n.height=0,n},i}(t.datavisualization.Diagram.RectangleToolBase);t.datavisualization.Diagram.RoundRectTool=function(n){return new k(n)};d=function(n){function i(t){n.call(this,"textTool",t)}return t.datavisualization.Diagram.extend(i,n),i.prototype.createNode=function(n,i,r,u){var f=t.datavisualization.Diagram.Node({name:"text"+t.datavisualization.Diagram.Util.randomId()});return f.shape.type=t.datavisualization.Diagram.Shapes.Text,f.shape.textBlock=t.datavisualization.Diagram.TextBlock(),f.offsetX=n,f.offsetY=i,f.width=r,f.height=u,f.borderColor="transparent",f.fillColor="transparent",f},i}(t.datavisualization.Diagram.TextToolBase);t.datavisualization.Diagram.TextTool=function(n){return new d(n)};g=function(n){function i(t){n.call(this,"polygonTool",t)}return t.datavisualization.Diagram.extend(i,n),i.prototype.createNode=function(){var n=t.datavisualization.Diagram.Node({name:"polygon"+t.datavisualization.Diagram.Util.randomId()});return n.shape.type=t.datavisualization.Diagram.Shapes.Polygon,n.offsetX=0,n.offsetY=0,n.width=0,n.height=0,n},i}(t.datavisualization.Diagram.PolygonToolBase);t.datavisualization.Diagram.PolygonTool=function(n){return new g(n)};nt=function(i){function r(n,r,u,f,e){i.call(this,"imageTool",e);this.saveUrl=n;this.removeUrl=r;this.uploadfileUrl=u;this.autoOpenUpload=f;this.bounds=t.datavisualization.Diagram.Rectangle(0,0,0,0);this.cursor="crosshair"}return t.datavisualization.Diagram.extend(r,i),r.prototype.createNode=function(n){var i=t.datavisualization.Diagram.Node();return i.name="image"+t.datavisualization.Diagram.Util.randomId(),i.shape=t.datavisualization.Diagram.Shapes.Image(n),i.borderDashArray="5,5",i.offsetX=0,i.offsetY=0,i.width=0,i.height=0,i},r.prototype.mouseup=function(){this.inAction&&(this.bounds=this.getBoundingRect(this.snap(this.startPoint),this.snap(this.currentPoint)));this._renderDialogControl();this.diagram._toolToActivate="selectTool";this.diagram._drawingTool=!1;this._endAction()},r.prototype._showPopup=function(){this._renderDialogControl();this.diagram._toolToActivate="selectTool";this.diagram._drawingTool=!1;this._endAction()},r.prototype._renderDialogControl=function(){var v=document.createElement("div"),i={id:"basicDialog",title:"Insert Image",style:"display:none"},y,o,h,c,u,s,l,a;t.datavisualization.Diagram.Util.attr(v,i);document.body.appendChild(v);y=document.createElement("div");i={id:"UploadDefault",style:"padding-Left:15px; float:left"};t.datavisualization.Diagram.Util.attr(y,i);var e=document.createElement("table"),f=document.createElement("tr"),r=document.createElement("td");i={align:"left",style:"padding-Top:10px"};t.datavisualization.Diagram.Util.attr(r,i);o=document.createElement("div");o.style.cssFloat="left";h=document.createElement("input");i={type:"radio",name:"uploadOption",id:"rdoComputer",checked:"true"};t.datavisualization.Diagram.Util.attr(h,i);h.onchange=n.proxy(this._rdoChanged,this);o.appendChild(h);u=document.createElement("label");u.innerHTML="My Computer";u.className="dialogLabel";i={style:"font-weight:normal; padding-left:5px; vertical-align: top;"};t.datavisualization.Diagram.Util.attr(u,i);u.onclick=n.proxy(this._labelClick,this);o.appendChild(u);r.style.paddingBottom="5px";r.appendChild(o);r.appendChild(y);u=document.createElement("label");i={id:"lblComputerUrl",style:"font-weight:normal;padding-left:10px; vertical-align: top;color:red;"};t.datavisualization.Diagram.Util.attr(u,i);r.appendChild(u);f.appendChild(r);e.appendChild(f);f=document.createElement("tr");r=document.createElement("td");c=document.createElement("input");i={id:"rdoWebUrl",type:"radio",name:"uploadOption"};t.datavisualization.Diagram.Util.attr(c,i);c.onchange=n.proxy(this._rdoChanged,this);r.appendChild(c);u=document.createElement("label");u.innerHTML="Web URL";u.className="dialogLabel";i={style:"font-weight:normal; padding-left:5px; vertical-align: top;"};t.datavisualization.Diagram.Util.attr(u,i);u.onclick=n.proxy(this._labelClick,this);r.appendChild(u);u=document.createElement("label");i={id:"lblWebUrl",style:"font-weight:normal;padding-left:25px; vertical-align: top;color:red;"};t.datavisualization.Diagram.Util.attr(u,i);r.appendChild(u);f.appendChild(r);e.appendChild(f);f=document.createElement("tr");r=document.createElement("td");i={style:"padding-Top:5px;padding-Bottom:15px"};t.datavisualization.Diagram.Util.attr(r,i);s=document.createElement("input");i={id:"txtImageUrl",type:"text",placeholder:"Image URL",style:"width:460px;height:20px"};t.datavisualization.Diagram.Util.attr(s,i);s.onfocus=n.proxy(this._textFocus,this);s.onfocusout=n.proxy(this._textFocusOut,this);r.appendChild(s);f.appendChild(r);e.appendChild(f);f=document.createElement("tr");r=document.createElement("td");l=document.createElement("input");i={value:"Ok",type:"button",id:"btnOk",style:"width : 100px; height: 30px; margin-Right: 5px; border: 1px solid #F7952E; color : white; font-Family:Segoe UI;font-weight:bold"};t.datavisualization.Diagram.Util.attr(l,i);l.onclick=n.proxy(this._uploadClick,this);r.appendChild(l);a=document.createElement("input");i={value:"Cancel",type:"button",id:"btnCancel",style:"width : 100px; height: 30px; border: 1px solid #DFDFDE; font-Family:Segoe UI;font-weight:bold"};t.datavisualization.Diagram.Util.attr(a,i);a.onclick=n.proxy(this._closeDialog,this);r.appendChild(a);i={align:"right"};t.datavisualization.Diagram.Util.attr(r,i);f.appendChild(r);e.appendChild(f);v.appendChild(e);n("#UploadDefault").ejUploadbox({saveUrl:this.saveUrl,removeUrl:this.removeUrl,complete:n.proxy(this.fileuploadComplete,this)});n("#basicDialog").ejDialog({height:230,width:500,modal:!0});n("#basicDialog").ejDialog("open")},r.prototype.fileuploadComplete=function(n){var t=this.uploadfileUrl+"/"+n.files.name;this._renderImageNode(t);this._closeDialog()},r.prototype._uploadClick=function(){var i=document.getElementById("txtImageUrl").value,n,t;/^(http:\/\/www\.|https:\/\/www\.)[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/.test(i)?(this._renderImageNode(i),this._closeDialog()):document.getElementById("rdoComputer").checked===!0?(n=document.getElementById("lblComputerUrl"),t=document.getElementById("lblWebUrl"),n.innerHTML="Browse any image to insert",t.innerHTML=""):(n=document.getElementById("lblComputerUrl"),t=document.getElementById("lblWebUrl"),n.innerHTML="",t.innerHTML="Invalid Url",document.getElementById("txtImageUrl").focus())},r.prototype._rdoChanged=function(){var n=document.getElementById("lblComputerUrl"),t=document.getElementById("lblWebUrl");n.innerHTML="";t.innerHTML=""},r.prototype._closeDialog=function(){n("#basicDialog").ejDialog("close");var t=document.getElementById("basicDialog");t.parentNode.removeChild(t)},r.prototype._labelClick=function(n){var t;n.target.innerHTML=="My Computer"?(t=document.getElementById("rdoComputer"),t.checked=!0):(t=document.getElementById("rdoWebUrl"),t.checked=!0);this._rdoChanged()},r.prototype._textFocus=function(){var n=document.getElementById("rdoWebUrl");n.checked=!0},r.prototype._renderImageNode=function(n){var i=this.createNode(n);this.bounds.size.width==undefined||t.datavisualization.Diagram.Geometry.isEmptySize(this.bounds.size)?(i.offsetX=150,i.offsetY=150,i.width=100,i.height=100):(i.offsetX=this.bounds.offset.x+this.bounds.size.width/2,i.offsetY=this.bounds.offset.y+this.bounds.size.height/2,i.width=this.bounds.size.width,i.height=this.bounds.size.height);i.borderDashArray="";this.diagram.model.nodes.push(i);t.datavisualization.Diagram.SvgContext.renderNode(i,this.diagram._svg,this.diagram._diagramLayer);this.diagram._clearSelection();this.diagram._addSelection(i)},r}(t.datavisualization.Diagram.RectangleToolBase);t.datavisualization.Diagram.ImageTool=function(n,t,i,r,u){return new nt(n,t,i,r,u)}}(jQuery,Syncfusion),function(n,t){"use strict";t.datavisualization.Diagram.LayoutTypes={None:"none",HierarchicalTree:"hierarchicaltree"};t.datavisualization.Diagram.GraphNode=function(n){return{visited:!1,children:[],parents:[],distance:0,node:n,added:!1}};t.datavisualization.Diagram.Layout={doLayout:function(n){n.model.layout.type==="hierarchicaltree"&&t.datavisualization.Diagram.HierarchicalLayout.doLayout(n)}};t.datavisualization.Diagram.HierarchicalLayout={doLayout:function(i){var u=i.model,r={passedNodes:[],passedNodesList:[],graph:null,firstRankOrdered:[],fictitiousNodes:[],biggestDimensions:[],fX:0,fY:0,yBorder:0,xBorder:0,visitedNodes:0,fixedNode:null,diagram:i},o,f,s,e;if(r=n.extend(!0,{},r,u.layout),r.visitedNodes=0,o=null,u.nodes.length>0){while(u.nodes.length>r.visitedNodes)(this._getNodesToPosition(r,u.nodes),r.graph)&&(r.fixedNode&&(f=i.nameTable[r.fixedNode],f&&(o=t.datavisualization.Diagram.Point(f.offsetX,f.offsetY),r.fixedNode=f)),r.graph&&this._makeLayout(r,r.graph),this._updateOrientation(r),this._arrangeNodesToLeftMost(r,o));for(s=u.connectors,e=0;e<s.length;e++)i._dock(s[e],i.nameTable);i._pageBackgroundLayer&&t.datavisualization.Diagram.PageUtil._updatePageSize(i)}},_getNodesToPosition:function(n,t){for(var i,r=0;r<t.length;r++)if(i=t[r],n.passedNodes[i.name]!=null||i.excludeFromLayout)i.excludeFromLayout&&n.visitedNodes++;else{this._selectNodes(n,i);break}},_selectNodes:function(n,t){if(t!=null&&this._addNodeInCollection(n,t)&&this._isConnectedToAnotherNode(n,t)){n.graph={improvePerformance:!1,graphNodes:[],typeOrdered:[]};this._selectConnectedNodes(n,t);var i=this._setTypeOrdered(n);n.graph.typeOrdered=i}},_addNodeInCollection:function(n,t){var i=!1;return t&&(n.passedNodes[t.name]==null&&(n.passedNodes[t.name]=t,n.passedNodesList.push(t),n.visitedNodes++),t.visible&&(i=!0)),i},_isConnectedToAnotherNode:function(n,t){var i=!1;return t.inEdges&&t.inEdges.length>0&&(i=this._searchEdgeCollection(n,t.inEdges,"fromNode")),!i&&t.outEdges&&t.outEdges.length>0&&(i=this._searchEdgeCollection(n,t.outEdges,"toNode")),i},_searchEdgeCollection:function(n,t,i){for(var s=!1,u=n.diagram,r,f,e,o=0;o<t.length;o++)if((r=u._findNode(t[o]),this._addNodeInCollection(n,r))&&(f=u._findNode(r.sourceNode),e=u._findNode(r.targetNode),i=="fromNode"&&f!=null&&!f.excludeFromLayout||i=="toNode"&&e!=null&&!e.excludeFromLayout)){s=!0;break}return s},_selectConnectedNodes:function(n,t){var r=n.graph,i,u;r&&t&&this._addNodeInCollection(n,t)&&(u=t.name,r.graphNodes[u]==null?(i=this._addGraphNode(n,t),this._getConnectedRelatives(n,i),this._exploreRelative(n,t)):(i=r.graphNodes[u],i.added&&(i.added=!1,this._getConnectedRelatives(n,i),this._exploreRelative(n,t))))},_addGraphNode:function(n,i){var r=n.graph,u=t.datavisualization.Diagram.GraphNode(i);return r!=null&&(r.graphNodes[i.name]=u),u},_getConnectedRelatives:function(n,t){this._getConnectedParents(n,t);this._getConnectedChildren(n,t)},_getConnectedParents:function(n,t){var f=n.graph,o,r,i,s=n.diagram,e,u;if(f)for(e=t.node,u=0;u<e.inEdges.length;u++)o=s._findNode(e.inEdges[u]),i=s._findNode(o.sourceNode),i&&!i.excludeFromLayout&&i.visible&&(f.graphNodes[i.name]==null?(r=this._addGraphNode(n,i),r.added=!0):r=f.graphNodes[i.name],this._setNode(r.children,t),this._findNode(t.parents,r.node.name)<0&&t.parents.push(r))},_getConnectedChildren:function(n,t){var f=n.graph,o,i,r,s=n.diagram,e,u;if(f!=null)for(e=t.node,u=0;u<e.outEdges.length;u++)o=s._findNode(e.outEdges[u]),i=s._findNode(o.targetNode),i&&!i.excludeFromLayout&&i.visible&&(f.graphNodes[i.name]==null?(r=this._addGraphNode(n,i),r.added=!0):r=f.graphNodes[i.name],this._setNode(r.parents,t),this._findNode(t.children,r.node.name)<0&&t.children.push(r))},_findNode:function(n,t){var u=-1,r,i,f;if(n!=null&&t!="")for(i=0,f=n.length;i<f;i++)if(r=n[i].node,r&&r.name==t){u=i;break}return u},_setNode:function(n,t){var i=this._findNode(n,t.node.name);i>=0&&i<n.length?n[i]=t:n.push(t)},_exploreRelative:function(n,t){this._exploreRelatives(n,t,"parents");this._exploreRelatives(n,t,"children")},_exploreRelatives:function(n,t,i){var r,u,f,e,s=n.diagram,o;if(i=="parents"&&(r=t.inEdges),i=="children"&&(r=t.outEdges),r)for(o=0;o<r.length;o++)u=s._findNode(r[o]),this._addNodeInCollection(n,u)&&(f=s._findNode(u.sourceNode),e=s._findNode(u.targetNode),i!="parents"||f==null||f.excludeFromLayout?i!="children"||e==null||e.excludeFromLayout||this._selectConnectedNodes(n,e):this._selectConnectedNodes(n,f))},_setTypeOrdered:function(n){var i=n.graph.graphNodes,t,r=!0;for(var u in i)if(t=i[u],t&&t.parents&&(t.parents.length==0&&(r=!1),t.parents.length>1&&!r))break;return this._rankGraphNodeInitialization(n),n.firstRankOrdered.length>0&&(this._addFictitiousNodes(n),n.graph.improvePerformance||this._optimizeGraph(n),this._checkRankDimensions(n)),n.firstRankOrdered},_rankGraphNodeInitialization:function(n){var f=this._getGraphFirstTopNode(n),u,i,r;for(this._rankGraphNodes(n,f,0),u=[],i=0;i<n.firstRankOrdered.length;i++)r=n.firstRankOrdered[i],r.length==0&&u.push(r);for(i=0;i<u.length;i++)r=u[i],t.datavisualization.Diagram.Util.removeItem(n.firstRankOrdered,r)},_getGraphFirstTopNode:function(n){var t,i=n.graph.graphNodes;for(var r in i)if(t=i[r],t.parents&&t.parents.length==0)return t;return null},_rankGraphNodes:function(n,i,r){var f,e,u,o,s;if(i){if(f=this._getGraphNodeRank(n,i),f>=0){if(this._checkRankPosition(n,i,f)||r===f)return r;e=n.firstRankOrdered[f];t.datavisualization.Diagram.Util.removeItem(e,i)}for(r=this._addNodeInTypeOrederd(n,i,r),u=0;u<i.children.length;u++)o=i.children[u],this._rankGraphNodes(n,o,r+1);if(!n.graph.improvePerformance)for(u=0;u<i.parents.length;u++)s=i.parents[u],this._rankGraphNodes(n,s,r-1)}return r},_getGraphNodeRank:function(n,t){for(var r,f=-1,e=!1,i,o,u=0;u<n.firstRankOrdered.length;u++){if(i=n.firstRankOrdered[u],e)break;for(r=0;r<i.length;r++)if(o=i[r],o.node.name==t.node.name){f=n.firstRankOrdered.indexOf(i);e=!0;break}}return f},_checkRankPosition:function(n,t,i){for(var f,s=!0,e=Number.MIN_VALUE,o,h,u=Number.MAX_VALUE,c,l,r=0;r<t.parents.length;r++)c=t.parents[r],o=this._getGraphNodeRank(n,c),o<0&&(o=0),e=Math.max(e,o);for(r=0;r<t.children.length;r++)l=t.children[r],h=this._getGraphNodeRank(n,l),u=Math.min(u,h);return e!=Number.MIN_VALUE?(f=e+1,s=i>=f):u!=Number.MAX_VALUE&&u!=0&&(f=u-1,s=i==f),s},_addNodeInTypeOrederd:function(n,t,i){for(var r=n.firstRankOrdered.length,u;i<0;)n.firstRankOrdered.splice(0,0,[]),i++;while(i>=r)n.firstRankOrdered.push([]),r++;return u=n.firstRankOrdered[i],u.push(t),i},_addFictitiousNodes:function(n){for(var e,o,y,s,h,i,r,c,u,a,v,l=n.firstRankOrdered,f=0,p=l.length-1;f<p;f++)for(s=l[f],h=l[f+1],e=0;e<s.length;e++)for(u=s[e],c=u.children,o=0,y=c.length;o<y;o++)r=c[o],h.indexOf(r)==-1&&(i=t.datavisualization.Diagram.GraphNode(null),v=u.children.indexOf(r),a=r.parents.indexOf(u),u.children[v]=i,r.parents[a]=i,i.parents.push(u),i.children.push(r),h.push(i),n.fictitiousNodes.push(i))},_optimizeGraph:function(n){var t=this._getInterceptionCount(n),u=this._getAlwaysInterceptionCount(n),f=this._getListOrderedClone(n),r,i;u<t&&this._sortRankNodes(n);this._optimizeTopRank(n);r=this._getInterception(n);i=r.length;i<t&&(f=this._getListOrderedClone(n),t=i);u<t&&this._removeInterceptions(r);i=this._getInterceptionCount(n);i>t&&(n.firstRankOrdered=f)},_getInterceptionCount:function(n){return this._getInterception(n).length},_getInterception:function(n){for(var h,c,l,a,v,o=[],y,u,b=-1,p=-1,w=-1,i,r,f,e,t,k=!0,s=0,d=n.firstRankOrdered.length-1;s<d;s++)for(y=n.firstRankOrdered[s],u=n.firstRankOrdered[s+1],h=0;h<u.length;h++)for(i=u[h],b=u.indexOf(i),c=0;c<i.parents.length;c++)for(f=i.parents[c],p=y.indexOf(f),l=0;l<u.length;l++)if(r=u[l],i!=r&&!(b>=u.indexOf(r)))for(a=0;a<r.parents.length;a++)if(e=r.parents[a],w=y.indexOf(e),w>=0&&p>=0&&w<p){for(v=0;v<o.length;v++)if(t=o[v],t.leftParent==e&&t.rightParent==f&&t.leftChild==i&&t.rightChild==r||t.leftParent==f&&t.rightParent==e&&t.leftChild==r&&t.rightChild==i){k=!1;break}k&&o.push(this._interception(e,r,f,i))}return o},_interception:function(n,t,i,r){var u={leftChild:r,leftParent:n,rightChild:t,rightParent:i,canFixed:!1},f=this._xCrossCondition(u);return f||(f=!this._parentParentCondition(u)),u.canFixed=!f,u},_xCrossCondition:function(n){var t=n.leftChild.parents,i=n.rightChild.parents;return t.indexOf(n.leftParent)!=-1&&i.indexOf(n.rightParent)!=-1},_parentParentCondition:function(n){var t=!1;return n.leftParent.parents.length==1&&n.rightParent.parents.length==1&&(t=n.leftParent.parents[0]==n.rightParent.parents[0]),t},_getAlwaysInterceptionCount:function(n){for(var l,a,v,y,p,g,nt,w,ft,tt=0,it=0,rt=[],ut=[],u=[],b,f,i,e,k,d,o,s,r,h,c=0,et=n.firstRankOrdered.length-1;c<et;c++){for(b=n.firstRankOrdered[c],f=n.firstRankOrdered[c+1],r=0,h=b.length;r<h;r++)for(i=b[r],ut.push(i),l=0;l<i.children.length;l++)if(o=i.children[l],f.indexOf(o)!=-1)for(a=0;a<o.parents.length;a++)if(e=o.parents[a],e!=i&&ut.indexOf(e)==-1)for(v=0;v<e.children.length;v++)if((s=e.children[v],f.indexOf(s)!=-1)&&s!=o)for(y=0;y<s.parents.length;y++)k=s.parents[y],k==i&&(it++,rt.push(k));for(r=0,h=f.length;r<h;r++){for(d=f[r],p=0;p<d.parents.length;p++){if(i=d.parents[p],rt.indexOf(i)!=-1){t.datavisualization.Diagram.Util.clear(u);break}g=i.children.length;g>1&&u.push(g)}if(u.length>2)for(nt=u,w=0,ft=nt.length-2;w<ft;w++)tt+=nt[w]-1;u=[]}}return tt+it/2},_getListOrderedClone:function(t){for(var r=[],u,i=0;i<t.firstRankOrdered.length;i++)u=t.firstRankOrdered[i],r.push(n.extend({},n.extend(u)[0]));return r},_sortRankNodes:function(n){for(var i,r,t=0,u=n.firstRankOrdered.length-1;t<u;t++)i=n.firstRankOrdered[t],r=n.firstRankOrdered[t+1],t==0&&(n.firstRankOrdered[t+1]=this._sortChildrenRankNodes(i,r),r=n.firstRankOrdered[t+1],n.firstRankOrdered[t]=this.sortParentRankNodes(i,r),i=n.firstRankOrdered[t],this._optimizeTopRank(n)),n.firstRankOrdered[t+1]=this._sortChildrenRankNodes(i,r)},_sortChildrenRankNodes:function(n,t){for(var r=t,s=r.length,h=[],c=[],u,f,l,a,v,e,o,i=0;i<s;i++)u=t[i],h[i]=u.parents.length;for(Array.sort(h,r),i=0;i<s;i++)u=r[i],e=n.length,o=t.length,o>0&&e>0&&(l=this._getCentralNode(u.parents,n),f=this._getParentIndexInChildList(l,o,e),a=this._compareChilds(u,n),v=this._compareChilds(r[f],n),a>0&&v<0&&f++,c[i]=f);return Array.sort(c,r),new Array(r)},_optimizeTopRank:function(n){var i,u,t,f,e,r;if(n.firstRankOrdered.length>0)for(i=n.firstRankOrdered[0],u=i,r=0;r<u.length;r++)t=u[r],t.parents.length==0&&t.children.length==1&&(f=t.children[0],e=this._getCentralNode(f.parents,i),this._moveNode(i,t,e))},_moveNode:function(n,i,r){var u=n.indexOf(i);u!=r&&(r>u&&r--,r>=0?(t.datavisualization.Diagram.Util.removeItem(n,i),n.splice(r,0,i)):r==n.Count&&n.push(i))},_getCentralNode:function(n,t){for(var u=0,f=0,e,i,r=0;r<n.length;r++)e=n[r],i=t.indexOf(e),i>=0&&(f+=i+.5);return n.length>0&&(u=f/n.length),u},_checkRankDimensions:function(n){for(var i,r,u,t=0;t<n.firstRankOrdered.length;t++)for(r=n.firstRankOrdered[t],i=0;i<r.length;i++)u=r[i],this._checkDimensions(n,u.node,t)},_checkDimensions:function(n,i,r){var f=n.biggestDimensions.length,u;if(f>r&&r>=0)u=n.biggestDimensions[r],this._isCurrentNodeDimensionBigger(u,i,"width")&&this._update(u,i,"width"),this._isCurrentNodeDimensionBigger(u,i,"height")&&this._update(u,i,"height");else{while(r>=f)n.biggestDimensions.push(t.datavisualization.Diagram.Size()),f++;while(r<0)n.biggestDimensions.splice(0,0,t.datavisualization.Diagram.Size()),r++;u=t.datavisualization.Diagram.Size();u.width=i.width;u.height=i.height}n.biggestDimensions[r]=u},_isCurrentNodeDimensionBigger:function(n,t,i){var r=!1;switch(i){case"width":t.width>n.width&&(r=!0);break;case"height":t.height>n.height&&(r=!0)}return r},_update:function(n,t,i){switch(i){case"width":n.width=t.width;break;case"height":n.height=t.height}},_makeLayout:function(n,t){this._doInitXLayout(n,t);this._placeParentsRelativeToChildren(n,t.typeOrdered)},_doInitXLayout:function(n,t){for(var r=t.typeOrdered,u=0,f,i=0;i<r.length;i++)f=r[i],this._makeLayoutByRank(n,f,u,t),u++},_makeLayoutByRank:function(n,t,i,r){var f,u,e,o;if(n.orientation=="toptobottom"||n.orientation=="bottomtotop"){for(n.fX=0,f=0;f<t.length;f++)u=t[f],u!=null&&this._xCoordinateRoutine(n,u,n.fX);e=this._calcRankPositionVerticalLayout(n,i,r);this._yCoordinateRoutine(t,e)}else{for(n.fY=0,f=0;f<t.length;f++)u=t[f],u!=null&&(u.node.offsetY=n.fY+u.node.height/2,n.fY=u.node.offsetY+u.node.height/2+n.horizontalSpacing);o=this._calcRankPositionHorizontalLayout(n,i,r);this._xCoordinateRoutineforhLayouts(t,o)}},_xCoordinateRoutine:function(n,t){t.node.offsetX=n.fX+t.node.width/2;n.fX+=t.node.width/2+n.horizontalSpacing},_yCoordinateRoutine:function(n,t){for(var i,r=0;r<n.length;r++)i=n[r],i.node.offsetY=t+i.node.height/2},_xCoordinateRoutineforhLayouts:function(n,t){for(var i,r=0;r<n.length;r++)i=n[r],i.node.offsetX=t+i.node.width/2},_calcRankPositionHorizontalLayout:function(n,t){var i,r;return t==0?i=0:(r=this._getSubGraphDimension(n,0,t,"width"),i=r),i+n.xBorder},_getSubGraphDimension:function(n,t,i,r){var u=0,f=t,o=1,e;if(t>i&&(o=-o),n.orientation=="toptobottom"||n.orientation=="bottomtotop")while(f!=i){e=n.biggestDimensions[f];switch(r){case"height":u+=e.height;u+=n.verticalSpacing;break;case"width":u+=e.width;u+=n.horizontalSpacing}f+=o}else while(f!=i){e=n.biggestDimensions[f];switch(r){case"height":u+=e.height;u+=n.horizontalSpacing;break;case"width":u+=e.width;u+=n.verticalSpacing}f+=o}return u},_calcRankPositionVerticalLayout:function(n,t){var i,r;return t==0?i=0:(r=this._getSubGraphDimension(n,0,t,"height"),i=r),i+n.yBorder},_placeParentsRelativeToChildren:function(n,t){var f,i,u,r;if(t.length>1)for(i=t.length-2;i>=0;i--)for(f=t[i+1],this._placeRelativeToChildren(n,f),this._normalizeNodes(n,t[i]),u=i+1;u<=t.length-1;){for(r=u;r>=i;)this._normalizeNodes(n,t[r]),this._placeRelativeToChildren(n,t[r]),r--;u++}},_placeRelativeToChildren:function(n,t){for(var f,o,e=[],s,u,r,h,c,i,l,a,v=0;v<t.length;v++)for(s=t[v],i=0;i<s.parents.length;i++)u=s.parents[i],e.indexOf(u)==-1&&e.push(u);if(n.orientation=="toptobottom"||n.orientation=="bottomtotop")for(i=0;i<e.length;i++)u=e[i],r=u.children,r.length>0&&(h=r[0].node,c=r[r.length-1].node,f=h.offsetX-h.width/2,o=c.offsetX+c.width/2,u.node.offsetX=f+(o-f)/2);else for(i=0;i<e.length;i++)u=e[i],r=u.children,r.length>0&&(l=r[0].node,a=r[r.length-1].node,f=l.offsetY-l.height/2,o=a.offsetY+a.height/2,u.node.offsetY=f+(o-f)/2)},_normalizeNodes:function(n,t){var o=!1,r,u,f,i,e;if(n.orientation=="toptobottom"||n.orientation=="bottomtotop")for(r=0;r<t.length-1;r++)f=t[r].node,i=t[r+1].node,u=f.offsetX+f.width/2+n.horizontalSpacing,u>i.offsetX-i.width/2&&(e=u+i.width/2-i.offsetX,i.offsetX=u+i.width/2,o=!0,this._moveChildren(n,t[r+1],e));else for(r=0;r<t.length-1;r++)f=t[r].node,i=t[r+1].node,u=f.offsetY+f.height/2+n.horizontalSpacing,u>i.offsetY-i.height/2&&(e=u+i.height/2-i.offsetY,i.offsetY=u+i.height/2,o=!0,this._moveChildrenVertically(n,t[r+1],e));return o},_moveChildren:function(n,t,i){var u,r;if(!t.line)for(r=0;r<t.children.length;r++)u=t.children[r],u.node.offsetX+=i,this._moveChildren(n,u,i)},_moveChildrenVertically:function(n,t,i){var u,r;if(!t.line)for(r=0;r<t.children.length;r++)u=t.children[r],u.node.offsetY+=i,this._moveChildrenVertically(n,u,i)},_updateOrientation:function(n){if(n.orientation!="toptobottom"||n.orientation!="lefttoright"){var r=n.diagram.model.nodes,t,e=this._getMaxXNode(r),o=this._getMaxYNode(r),u=e.offsetX,f=o.offsetY,i;if(n.orientation=="bottomtotop")for(i=0;i<r.length;i++)t=r[i],t.excludeFromLayout||(t.offsetX=u-t.offsetX,t.offsetY=f-t.offsetY);else if(n.orientation=="righttoleft")for(i=0;i<r.length;i++)t=r[i],t.excludeFromLayout||(t.offsetX=u-t.offsetX,t.offsetY=f-t.offsetY)}},_getMaxXNode:function(n){for(var r=n[0].offsetX,t,u=0,i=0;i<n.length;i++)t=n[i],t.excludeFromLayout||t.offsetX>r&&(r=t.offsetX,u=i);return n[u]},_getMaxYNode:function(n){for(var r=n[0].offsetY,t,u=0,i=0;i<n.length;i++)t=n[i],t.excludeFromLayout||t.offsetY>r&&(r=t.offsetY,u=i);return n[u]},_arrangeNodesToLeftMost:function(n,i){var f=n.diagram.model.nodes,r,u,e,o;if(f.length>0)if(i)for(e=i.x-n.fixedNode.offsetX,o=i.y-n.fixedNode.offsetY,u=0;u<f.length;u++)r=f[u],r.excludeFromLayout||(r.offsetX=r.offsetX+e,r.offsetY=r.offsetY+o),t.datavisualization.Diagram.SpatialUtil._updateQuad(n.diagram,n.diagram._spatialSearch,r,!0);else for(u=0;u<f.length;u++)r=f[u],this._adjustMargin(n,r),t.datavisualization.Diagram.SpatialUtil._updateQuad(n.diagram,n.diagram._spatialSearch,r,!0)},_adjustMargin:function(n,t){t.offsetX=n.marginX+t.offsetX;t.offsetY=n.marginY+t.offsetY}}}(jQuery,Syncfusion),function(n,t){"use strict";t.datavisualization.Diagram.ZoomUtil={zoomPan:function(i,r,u,f,e,o){var h=t.Matrix.identity(),c,l,a,s;t.Matrix.scale(h,i.model.zoomFactor,i.model.zoomFactor);t.Matrix.translate(h,-i._hScrollOffset,-i._vScrollOffset);c=i.model.zoomFactor*r;c>30?r=30/i.model.zoomFactor:c<.25&&(r=.25/i.model.zoomFactor);l=t.Matrix.identity();a=e?t.Matrix.transform(h,e):t.datavisualization.Diagram.Point(n(i.element).width()/2,n(i.element).height()/2);t.Matrix.scale(l,r,r,a.x,a.y);c=i.model.zoomFactor*r;t.Matrix.translate(l,u,f);t.Matrix.multiply(h,l);s=t.Matrix.transform(h,t.datavisualization.Diagram.Point(0,0));o||(s.x>0&&(s.x=0),s.y>0&&(s.y=0));this._applyTransform(i,c,s,o)},_applyTransform:function(t,i,r,u){var f;t.model.zoomFactor=i;var e=t._getDigramBounds(),o=0,s=0;r.x*-1>0&&(e.width*i<n(t.element).width()||(o=r.x*-1));r.y*-1>0&&(e.height*i<n(t.element).height()||(s=r.y*-1));u||(f=n("#"+t._canvas.id+"_scroller").ejScroller("instance").model,r.x*-1>0&&r.x*-1+(f.width-f.buttonSize)>e.width*i&&(o=e.width*i-(f.width-f.buttonSize)),r.y*-1>0&&r.y*-1+(f.height-f.buttonSize)>e.height*i&&(s=e.height*i-(f.height-f.buttonSize)));t._updateScrollOffset(o,s,!0)}};t.datavisualization.Diagram.PageUtil={_createPageBreaks:function(n){this._removePageBreaks(n);var i={id:n._canvas.id+"pagebreaks","pointer-events":"none"},r=t.datavisualization.Diagram.SvgContext._initializePageBreaks(n._svg,i,n._pageBackgroundLayer);this._updatePageBreaks(r,n)},_removePageBreaks:function(n){var i=n._svg.getElementById(n._canvas.id+"pagebreaks");i&&t.datavisualization.Diagram.SvgContext._removePageBreaks(n._svg,i,n._pageBackgroundLayer)},_updatePageBreaks:function(n,i){var l=i._getDigramBounds(),y=i.model.pageSettings,r=l.x,b=l.width,u=l.y,k=l.height,f=i.model.zoomFactor,a=y.pageHeight,v=y.pageWidth,e=y.pageMargin,p=parseInt(Math.ceil((b-r)/v)),w=parseInt(Math.ceil((k-u)/a)),o,s,h,c;for(r=-i._canvas.clientLeft+(e+r)*f,u=-i._canvas.clientTop+(e+u)*f,o=(v*p-e*2)*f,s=(a*w-e*2)*f,t.datavisualization.Diagram.SvgContext._renderVPageBreakLine(t.datavisualization.Diagram.Point(r,u),t.datavisualization.Diagram.Point(r+o,u),i._svg,n),t.datavisualization.Diagram.SvgContext._renderHPageBreakLine(t.datavisualization.Diagram.Point(r,u),t.datavisualization.Diagram.Point(r,u+s),i._svg,n),h=1;h<p;h++)t.datavisualization.Diagram.SvgContext._renderVPageBreakLine(t.datavisualization.Diagram.Point(r+(v*h-e)*f,u),t.datavisualization.Diagram.Point(r+(v*h-e)*f,u+s),i._svg,n);for(c=1;c<w;c++)t.datavisualization.Diagram.SvgContext._renderHPageBreakLine(t.datavisualization.Diagram.Point(r,u+(a*c-e)*f),t.datavisualization.Diagram.Point(r+o,u+(a*c-e)*f),i._svg,n);t.datavisualization.Diagram.SvgContext._renderVPageBreakLine(t.datavisualization.Diagram.Point(r+o,u),t.datavisualization.Diagram.Point(r+o,u+s),i._svg,n);t.datavisualization.Diagram.SvgContext._renderHPageBreakLine(t.datavisualization.Diagram.Point(r,u+s),t.datavisualization.Diagram.Point(r+o,u+s),i._svg,n)},_updatePageSize:function(n){var r=n._getDigramBounds(),u=n.model.zoomFactor,s=r.x*u,h=r.y*u,f=(r.width-r.x)*u,e=(r.height-r.y)*u,i=n.model.pageSettings,o,c,l;n._pageBackgroundLayer&&n._pageBackgroundLayer.firstChild?t.datavisualization.Diagram.SvgContext._updatePageBakground(t.datavisualization.Diagram.Point(s,h),t.datavisualization.Diagram.Point(f,e)):t.datavisualization.Diagram.SvgContext._renderPageSettingsRect(t.datavisualization.Diagram.Point(s,h),t.datavisualization.Diagram.Point(f,e),n._svg,n._pageBackgroundLayer,i.pageBorderColor,i.pageBackgroundColor,i.pageBorderWidth);o=!1;i.pageOrientation==t.datavisualization.Diagram.PageOrientations.Landscape?i.pageHeight>i.pageWidth&&(o=!0):i.pageWidth>i.pageHeight&&(o=!0);o&&(c=i.pageWidth,i.pageWidth=i.pageHeight,i.pageHeight=c);f=r.width*u;e=r.height*u;n._svg.document.style.left=0;n._svg.document.style.top=0;l=!1;n.model.pageSettings.pageWidth||n.model.pageSettings.pageHeight||(l=!0);var a=t.datavisualization.Diagram.ScrollUtil._viewPort(n),v=a.width+n._hScrollOffset,y=a.height+n._vScrollOffset;f<v&&(f=v);e<y&&(e=y);i.pageWidth&&i.pageHeight&&i.showPageBreak&&this._createPageBreaks(n);t.datavisualization.Diagram.ScrollUtil._setScrollContentSize(n,f,e)}};t.datavisualization.Diagram.ScrollUtil={_transform:function(i,r,u,f){var e=document.getElementById(i._canvas.id+"_scroller");n(e).ejScroller("scrollX",r,!0);n(e).ejScroller("scrollY",u,!0);t.datavisualization.Diagram.SvgContext.transformView(i,-r,-u);f&&t.datavisualization.Diagram.SvgContext.scaleContent(i,i.model.zoomFactor);t.datavisualization.Diagram.PageUtil._updatePageSize(i);i._updateGrid(0,0,i.model.zoomFactor)},_viewPort:function(i){var f=i.element[0],r=n(f).width(),u=n(f).height(),e=i.element[0].getBoundingClientRect(),s=window.screenX<0?window.screenX*-1:window.screenX,o;return r===0&&(r=Math.floor(window.innerWidth-s-Math.floor(e.left))),o=window.screenY<0?window.screenY*-1:window.screenY,u===0&&(u=Math.floor(window.innerHeight-o-Math.floor(e.top))),t.datavisualization.Diagram.Size(r,u)},_updateScroller:function(t){var i=this._viewPort(t);n("#"+t._canvas.id+"_scroller").ejScroller({width:i.width,height:i.height})},_setScrollContentSize:function(i,r,u){var f=i._canvas.id;n("#"+f+"_contentHolder_content").css({width:r+"px",height:u+"px"});t.datavisualization.Diagram.SvgContext.setSize(i._svg,r,u);n("#"+f+"_scroller").ejScroller("refresh")},_initScroller:function(t){var u=t._canvas,i=document.getElementById(u.id+"_scroller"),r=this._viewPort(t);n(i).ejScroller({height:r.height,width:r.width});n(i).ejScroller({scroll:function(i){if(i.source!=null&&(i.source=="thumb"||i.source=="button"||i.source=="key")&&i.scrollData!=null){var r=n("#"+t._canvas.id+"_contentHolder_content");i.scrollData.clientXy=="pageX"?i.model.scrollLeft+i.model.width<=r.width()&&t._updateScrollOffset(i.model.scrollLeft,i.model.scrollTop):i.scrollData.clientXy=="pageY"&&i.model.scrollTop+i.model.height<=r.height()&&t._updateScrollOffset(i.model.scrollLeft,i.model.scrollTop)}}});n("#"+t._canvas.id+"_contentHolder_content").css({width:n(t._svg.document).width()+"px",height:n(t._svg.document).height()+"px"});n(i).ejScroller("refresh")}};t.datavisualization.Diagram.SnapUtil={_canConsider:function(n,t,i){var r=!1;return t.isGroup?r=!this._contains(n,t,i):t.line||(r=!(t==i)),r},_contains:function(n,t,i){var u=i.name,r=null;if(t.children.indexOf(u)>=0&&(r=n[u]),r&&!r.line){if(r.isGroup)return this._contains(n,r,i);if(r==i)return!0}return!1},_round:function(n,t,i){for(var e=0,r=0;r<t.length;r++)e+=t[r];e/=i;var o=Math.floor(Math.abs(n)/e),u=n%e,f=o*e;if(n>=0)for(r=0;r<t.length;r++){if(u<=t[r]/i)return f+(u<t[r]/(2*i)?0:t[r]/i);f+=t[r]/i;u-=t[r]/i}else for(f=f*-1,r=t.length-1;r>=0;r--){if(Math.abs(u)<=t[r]/i)return f-(Math.abs(u)<t[r]/(2*i)?0:t[r]/i);f-=t[r]/i;u+=t[r]/i}return n},_findNodes:function(n,i,r,u,f){for(var s,h=[],o,e,c,a=t.datavisualization.Diagram.SpatialUtil.findQuads(n,u),v=t.datavisualization.Diagram.Util.bounds(r),l=0;l<a.length;l++)if(o=a[l],o.objects.length>0)for(s=0;s<o.objects.length;s++)e=o.objects[s],e.line||(c=t.datavisualization.Diagram.Util.bounds(e),h.indexOf(e)==-1&&t.datavisualization.Diagram.Geometry.intersectsRect(v,c)&&h.push(e),f&&f.indexOf(e)&&t.datavisualization.Diagram.Geometry.intersectsRect(u,c)&&f.push(e));return h},_snapAngle:function(n,t){var i=n.model.snapSettings.snapAngle,r=t%i;return r>=i/2?t+i-r:t-r},_snapPoint:function(n,i,r,u,f,e,o){var h=n.model.snapSettings,l=n.model.zoomFactor,c=t.datavisualization.Diagram.Point(),s=t.datavisualization.Diagram.Util.bounds(i),k={snapped:!1,offset:0},d={snapped:!1,offset:0};h.enableSnapToObject&&this._snapObject(n,i,k,d,f,o==e);var g=s.x+f.x,nt=s.y+f.y,tt=s.x+s.width+f.x,it=s.y+s.height+f.y,a=this._round(tt,h.verticalGridLines.snapInterval,l),v=this._round(g,h.verticalGridLines.snapInterval,l),y=this._round(nt,h.horizontalGridLines.snapInterval,l),p=this._round(it,h.horizontalGridLines.snapInterval,l),w=s.x+s.width,b=s.y+s.height;return k.snapped?c.x=h.enableSnapToObject?k.offset:e.x-o.x:h.snapConstraints&t.datavisualization.Diagram.SnapConstraints.SnapToVerticalLines?Math.abs(f.x)>=1&&(c.x+=r?Math.abs(a-w)>Math.abs(v-s.x)?v-s.x:a-w:Math.abs(a-w)<Math.abs(v-s.x)?a-w:v-s.x):c.x=e.x-o.x,d.snapped?c.y=d.offset:h.snapConstraints&t.datavisualization.Diagram.SnapConstraints.SnapToHorizontalLines?Math.abs(f.y)>=1&&(c.y+=u?Math.abs(p-b)>Math.abs(y-s.y)?y-s.y:p-b:Math.abs(p-b)<Math.abs(y-s.y)?p-b:y-s.y):c.y=e.y-o.y,c},_snapObject:function(n,i,r,u,f,e){var v=null,y=null,w,b,d=[],g=[],it=[],rt=[],o=t.datavisualization.Diagram.Util.bounds(i),l=n.model.zoomFactor,ut=n._hScrollOffset,ft=n._vScrollOffset,h=n.model.snapSettings.snapObjectDistance,p=t.datavisualization.Diagram.ScrollUtil._viewPort(n),et=t.datavisualization.Diagram.Rectangle(ut/l,o.y-5,p.width/l,o.height+10),ot=t.datavisualization.Diagram.Rectangle(o.x-5,ft/l,o.width+10,p.height/l),k,a,c,s,nt,tt;for(p=t.datavisualization.Diagram.Rectangle(ut/l,ft/l,p.width/l,p.height/l),k=this._findNodes(n._spatialSearch,i,ot,p),nt=n.nameTable,a=0;a<k.length;a++)c=k[a],!c.line&&this._canConsider(nt,i,c)&&(s=t.datavisualization.Diagram.Util.bounds(c),s.y+s.height<o.y+f.y?it.push({object:c,distance:Math.abs(o.y+f.y-s.y-s.height)}):s.y>o.y+f.y+o.height&&rt.push({object:c,distance:Math.abs(o.y+f.y+o.height-s.y)}),(v==null||v>Math.abs(s.y-o.y-f.y))&&(Math.abs(s.x+s.width/2-(o.x+o.width/2+f.x))<=h?(w=this._createSnapObject(s,o,"centerX"),v=Math.abs(s.y-o.y)):Math.abs(s.x-(o.x+f.x))<=h?(w=this._createSnapObject(s,o,"left"),v=Math.abs(s.y-o.y)):Math.abs(s.x+s.width-(o.x+o.width+f.x))<=h?(w=this._createSnapObject(s,o,"right"),v=Math.abs(s.y-o.y)):Math.abs(s.x+s.width-(o.x+f.x))<=h?(w=this._createSnapObject(s,o,"leftRight"),v=Math.abs(s.y-o.y)):Math.abs(s.x-(o.x+o.width+f.x))<=h&&(w=this._createSnapObject(s,o,"rightLeft"),v=Math.abs(s.y-o.y))));for(k=this._findNodes(n._spatialSearch,i,et,p),a=0;a<k.length;a++)c=k[a],!c.line&&this._canConsider(nt,i,c)&&(s=t.datavisualization.Diagram.Util.bounds(c),s.x+s.width<o.x+f.x&&(d[d.length]={object:c,distance:Math.abs(o.x+f.x-s.x-s.width)}),s.x>o.x+f.x+o.width&&(g[g.length]={object:c,distance:Math.abs(o.x+f.x+o.width-s.x)}),(y==null||y>Math.abs(s.x-o.x-f.x))&&(Math.abs(s.y+s.height/2-(o.y+o.height/2+f.y))<=h?(b=this._createSnapObject(s,o,"centerY"),y=Math.abs(s.x-o.x)):Math.abs(s.y-o.y-f.y)<=h?(b=this._createSnapObject(s,o,"top"),y=Math.abs(s.x-o.x)):Math.abs(s.y+s.height-(o.y+o.height+f.y))<=h?(b=this._createSnapObject(s,o,"bottom"),y=Math.abs(s.x-o.x)):Math.abs(s.y+s.height-o.y-f.y)<=h?(b=this._createSnapObject(s,o,"topBottom"),y=Math.abs(s.x-o.x)):Math.abs(s.y-(o.y+o.height+f.y))<=h&&(b=this._createSnapObject(s,o,"bottomTop"),y=Math.abs(s.x-o.x))));tt=this._createGuidelines(n,w,b,r,u,e);r.snapped||this._createHSpacingLines(n,i,d,g,r,u,e,tt,f,h);u.snapped||this._createVSpacingLines(n,i,it,rt,r,u,e,tt,f,h)},_snapSize:function(n,i,r,u,f,e,o){var p=null,w=null,d,g,s=t.datavisualization.Diagram.Util.bounds(e),ut=n.nameTable,nt=[],tt=[],l=n.model.zoomFactor,st=n._hScrollOffset,ht=n._vScrollOffset,v=n.model.snapSettings.snapObjectDistance,y=t.datavisualization.Diagram.ScrollUtil._viewPort(n),lt=t.datavisualization.Diagram.Rectangle(st/l,(s.y-5)/l,y.width/l,(s.height+10)/l),at=t.datavisualization.Diagram.Rectangle((s.x-5)/l,ht/l,(s.width+10)/l,y.height/l),it,b,a,c,h,et,ot;for(y=t.datavisualization.Diagram.Rectangle(st/l,ht/l,y.width/l,y.height/l),it=[],b=this._findNodes(n._spatialSearch,e,at,y,it),a=0;a<b.length;a++)c=b[a],this._canConsider(ut,e,c)&&!c.line&&(h=t.datavisualization.Diagram.Util.bounds(c),(p==null||p>Math.abs(h.y-s.y))&&(i.left?Math.abs(s.x+u-h.x)<=v?(d=this._createSnapObject(h,s,"left"),p=Math.abs(h.y-s.y)):Math.abs(s.x+u-h.x-h.width)<=v&&(d=this._createSnapObject(h,s,"leftRight"),p=Math.abs(h.y-s.y)):i.right&&(Math.abs(s.x+u+s.width-h.x-h.width)<=v?(d=this._createSnapObject(h,s,"right"),p=Math.abs(h.y-s.y)):Math.abs(s.x+u+s.width-h.x)<=v&&(d=this._createSnapObject(h,s,"rightLeft"),p=Math.abs(h.y-s.y)))));for(b=this._findNodes(n._spatialSearch,e,lt,y),a=0;a<b.length;a++)c=b[a],this._canConsider(ut,e,c)&&!c.line&&(h=t.datavisualization.Diagram.Util.bounds(c),(w==null||w>Math.abs(h.x-s.x))&&(r.top?Math.abs(s.y+f-h.y)<=v?(g=this._createSnapObject(h,s,"top"),w=Math.abs(h.x-s.x)):Math.abs(s.y+f-h.y-h.height)<=v&&(g=this._createSnapObject(h,s,"topBottom"),w=Math.abs(h.x-s.x)):r.bottom&&(Math.abs(s.y+s.height+f-h.y-h.height)<=v?(g=this._createSnapObject(h,s,"bottom"),w=Math.abs(h.x-s.x)):Math.abs(s.y+s.height+f-h.y)<=v&&(g=this._createSnapObject(h,s,"bottomTop"),w=Math.abs(h.x-s.x)))));for(a=0;a<it.length;a++)if(c=it[a],this._canConsider(ut,e,c)){var k=t.datavisualization.Diagram.Util.bounds(c),ft=i.left?-u:u,ct=Math.abs(s.width+ft-k.width),rt;ct<=v&&(rt=i.left?-k.width+s.width:k.width-s.width,nt[nt.length]={source:c,diff:ct,offset:rt});ft=r.top?-f:f;et=Math.abs(s.height+ft-k.height);et<=v&&(rt=r.top?-k.height+s.height:k.height-s.height,tt[tt.length]={source:c,diff:et,offset:rt})}ot=this._createGuidelines(n,d,g,i,r,o);!i.snapped&&nt.length>0&&(i.left||i.right)&&this._addSameWidthLines(n,nt,i,o,ot,e);!r.snapped&&tt.length>0&&(r.top||r.bottom)&&this._addSameHeightLines(n,tt,r,o,ot,e)},_createSnapObject:function(n,i,r){var u;switch(r){case"left":u={start:t.datavisualization.Diagram.Point(n.x,Math.min(n.y,i.y)),end:t.datavisualization.Diagram.Point(n.x,Math.max(n.y+n.height,i.y+i.height)),offsetX:n.x-i.x,offsetY:0,type:"sideAlign"};break;case"right":u={start:t.datavisualization.Diagram.Point(n.x+n.width,Math.min(n.y,i.y)),end:t.datavisualization.Diagram.Point(n.x+n.width,Math.max(n.y+n.height,i.y+i.height)),offsetX:n.x+n.width-i.x-i.width,offsetY:0,type:"sideAlign"};break;case"top":u={start:t.datavisualization.Diagram.Point(Math.min(n.x,i.x),n.y),end:t.datavisualization.Diagram.Point(Math.max(n.x+n.width,i.x+i.width),n.y),offsetY:n.y-i.y,offsetX:0,type:"sideAlign"};break;case"bottom":u={start:t.datavisualization.Diagram.Point(Math.min(n.x,i.x),n.y+n.height),end:t.datavisualization.Diagram.Point(Math.max(n.x+n.width,i.x+i.width),n.y+n.height),offsetY:n.y+n.height-i.y-i.height,offsetX:0,type:"sideAlign"};break;case"topBottom":u={start:t.datavisualization.Diagram.Point(Math.min(n.x,i.x),n.y+n.height),end:t.datavisualization.Diagram.Point(Math.max(n.x+n.width,i.x+i.width),n.y+n.height),offsetY:n.y+n.height-i.y,offsetX:0,type:"sideAlign"};break;case"bottomTop":u={start:t.datavisualization.Diagram.Point(Math.min(n.x,i.x),n.y),end:t.datavisualization.Diagram.Point(Math.max(n.x+n.width,i.x+i.width),n.y),offsetY:n.y-i.y-i.height,offsetX:0,type:"sideAlign"};break;case"leftRight":u={start:t.datavisualization.Diagram.Point(n.x+n.width,Math.min(n.y,i.y)),end:t.datavisualization.Diagram.Point(n.x+n.width,Math.max(n.y+n.height,i.y+i.height)),offsetX:n.x+n.width-i.x,offsetY:0,type:"sideAlign"};break;case"rightLeft":u={start:t.datavisualization.Diagram.Point(n.x,Math.min(n.y,i.y)),end:t.datavisualization.Diagram.Point(n.x,Math.max(n.y+n.height,i.y+i.height)),offsetX:n.x-i.x-i.width,offsetY:0,type:"sideAlign"};break;case"centerX":u={start:t.datavisualization.Diagram.Point(n.x+n.width/2,Math.min(n.y,i.y)),end:t.datavisualization.Diagram.Point(n.x+n.width/2,Math.max(n.y+n.height,i.y+i.height)),offsetX:n.x+n.width/2-(i.x+i.width/2),offsetY:0,type:"centerAlign"};break;case"centerY":u={start:t.datavisualization.Diagram.Point(Math.min(n.x,i.x),n.y+n.height/2),end:t.datavisualization.Diagram.Point(Math.max(n.x+n.width,i.x+i.width),n.y+n.height/2),offsetY:n.y+n.height/2-(i.y+i.height/2),offsetX:0,type:"centerAlign"}}return u},_createGuidelines:function(n,i,r,u,f,e){var l={id:n._canvas.id+"guideline","pointer-events":"none"},o=t.datavisualization.Diagram.SvgContext._initializeGuidelines(n._svg,l,n._adornerLayer),s=n.model.zoomFactor,h=n._hScrollOffset,c=n._vScrollOffset;return i&&(u.offset=i.offsetX,u.snapped=!0,e||(i.type=="sideAlign"?t.datavisualization.Diagram.SvgContext._renderSideAlignmentLines(i.start,i.end,o,n._svg,s,h,c):i.type=="centerAlign"&&t.datavisualization.Diagram.SvgContext._renderCenterAlignmentLines(i.start,i.end,o,n._svg,s,h,c))),r&&(f.offset=r.offsetY,f.snapped=!0,e||(r.type=="sideAlign"?t.datavisualization.Diagram.SvgContext._renderSideAlignmentLines(r.start,r.end,o,n._svg,s,h,c):r.type=="centerAlign"&&t.datavisualization.Diagram.SvgContext._renderCenterAlignmentLines(r.start,r.end,o,n._svg,s,h,c))),o},_removeGuidelines:function(n){var i=n._svg.getElementById(n._canvas.id+"guideline");i!=null&&t.datavisualization.Diagram.SvgContext._removeGuidelines(n._adornerLayer,i)},_createHSpacingLines:function(n,i,r,u,f,e,o,s,h,c){var a=null,l,w,p,y,b,v,d,g,k;r.sort(function(n,t){return n.distance-t.distance});u.sort(function(n,t){return n.distance-t.distance});l=[];w=t.datavisualization.Diagram.Util.bounds(i);r.length>0&&(l[l.length]=r[0],p=t.datavisualization.Diagram.Util.bounds(r[0].object),a=p.y,r.length>1?(b=t.datavisualization.Diagram.Util.bounds(r[1].object),v=p.x-b.x-b.width,Math.abs(v-r[0].distance)<=c?a=this._findEquallySpacedNodesAtLeft(r,v,a,l):v=r[0].distance):v=r[0].distance);l.sort(function(n,t){return t.distance-n.distance});l[l.length]={object:i,distance:0};a=w.y<a||!a?w.y:a;u.length>0&&(y=t.datavisualization.Diagram.Util.bounds(u[0].object),a=y.y<a?y.y:a,u.length>1&&(b=t.datavisualization.Diagram.Util.bounds(u[1].object),d=b.x-y.x-y.width),r.length>0?Math.abs(u[0].distance-r[0].distance)<=c?(g=Math.abs(u[0].distance-r[0].distance)/2,u[0].distance<r[0].distance?v-=g:v+=g,l[l.length]=u[0]):r.length==1&&(p=undefined,l.splice(0,1),l[l.length]=u[0],v=d):(v=d,l[l.length]=u[0]),u.length>1&&y.x+y.width<b.x&&(a=this._findEquallySpacedNodesAtRight(u,d,a,l,c)));l.length>2&&(this._addHSpacingLines(n,l,o,s,a),k=0,o&&(k=h.x),p?f.offset=v-Math.abs(w.x+k-p.x-p.width)+k:y&&(f.offset=Math.abs(w.x+w.width+k-y.x)-v+k),f.snapped=!0)},_createVSpacingLines:function(n,i,r,u,f,e,o,s,h,c){var a=null,l,p,w,v,b,y,d,g,k;r.sort(function(n,t){return n.distance-t.distance});u.sort(function(n,t){return n.distance-t.distance});l=[];p=t.datavisualization.Diagram.Util.bounds(i);r.length>0&&(l[l.length]=r[0],w=t.datavisualization.Diagram.Util.bounds(r[0].object),a=w.x+w.width,r.length>1?(b=t.datavisualization.Diagram.Util.bounds(r[1].object),y=w.y-b.y-b.height,Math.abs(y-r[0].distance)<=c?a=this._findEquallySpacedNodesAtTop(r,y,a,l):y=r[0].distance):y=r[0].distance);l.sort(function(n,t){return t.distance-n.distance});l[l.length]={object:i,distance:0};a=p.x+p.width>a||!a?p.x+p.width:a;u.length>0&&(v=t.datavisualization.Diagram.Util.bounds(u[0].object),a=v.x+v.width>a?v.x+v.width:a,u.length>1&&(b=t.datavisualization.Diagram.Util.bounds(u[1].object),d=b.y-v.y-v.height),r.length>0?Math.abs(u[0].distance-r[0].distance)<=c?(g=Math.abs(u[0].distance-r[0].distance)/2,u[0].distance<r[0].distance?y-=g:y+=g,l[l.length]=u[0]):r.length==1&&(w=undefined,l.splice(0,1),l[l.length]=u[0],y=d):(y=d,l[l.length]=u[0]),u.length>1&&b.y>v.y+v.height&&(a=this._findEquallySpacedNodesAtBottom(u,d,a,l,c)));l.length>2&&(this._addVSpacingLine(n,l,o,s,a),k=0,o&&(k=h.y),w?e.offset=y-Math.abs(p.y+k-w.y-w.height)+k:v&&(e.offset=Math.abs(p.y+p.height+k-v.y)-y+k),e.snapped=!0)},_addHSpacingLines:function(n,i,r,u,f){var h=n.model.zoomFactor,c=n._hScrollOffset,l=n._vScrollOffset,e,o,s;if(i.length>2&&!r)for(e=0;e<i.length-1;e++)o=t.datavisualization.Diagram.Util.bounds(i[e].object),s=t.datavisualization.Diagram.Util.bounds(i[e+1].object),t.datavisualization.Diagram.SvgContext._renderSpacingLines(t.datavisualization.Diagram.Point(o.x+o.width,f-15),t.datavisualization.Diagram.Point(s.x,f-15),u,n._svg,h,c,l)},_addVSpacingLine:function(n,i,r,u,f){var h=n.model.zoomFactor,c=n._hScrollOffset,l=n._vScrollOffset,o,s,e;if(i.length>2&&!r)for(e=0;e<i.length-1;e++)o=t.datavisualization.Diagram.Util.bounds(i[e].object),s=t.datavisualization.Diagram.Util.bounds(i[e+1].object),t.datavisualization.Diagram.SvgContext._renderSpacingLines(t.datavisualization.Diagram.Point(f+15,o.y+o.height),t.datavisualization.Diagram.Point(f+15,s.y),u,n._svg,h,c,l)},_addSameWidthLines:function(n,i,r,u,f,e){var l=n.model.zoomFactor,a=n._hScrollOffset,v=n._vScrollOffset,s,y;i.sort(function(n,t){return n.offset-t.offset});var o=t.datavisualization.Diagram.Util.bounds(e),c=i[0],p=t.datavisualization.Diagram.Util.bounds(c.source),h=[];for(h.push(i[0]),s=1;s<i.length;s++)y=t.datavisualization.Diagram.Util.bounds(i[s].source),y.width==p.width&&h.push(i[s]);if(h.length>0&&!u)for(t.datavisualization.Diagram.SvgContext._renderSpacingLines(t.datavisualization.Diagram.Point(o.x+c.offset,o.y-15),t.datavisualization.Diagram.Point(o.x+o.width+c.offset,o.y-15),f,n._svg,l,a,v),s=0;s<h.length;s++)o=t.datavisualization.Diagram.Util.bounds(h[s].source),t.datavisualization.Diagram.SvgContext._renderSpacingLines(t.datavisualization.Diagram.Point(o.x,o.y-15),t.datavisualization.Diagram.Point(o.x+o.width,o.y-15),f,n._svg,l,a,v);r.offset=c.offset;r.snapped=!0},_addSameHeightLines:function(n,i,r,u,f,e){var l=n.model.zoomFactor,a=n._hScrollOffset,v=n._vScrollOffset,s,y;i.sort(function(n,t){return n.offset-t.offset});var o=t.datavisualization.Diagram.Util.bounds(e),c=i[0],p=t.datavisualization.Diagram.Util.bounds(c.source),h=[];for(h.push(i[0]),s=0;s<i.length;s++)y=t.datavisualization.Diagram.Util.bounds(i[s].source),y.height==p.height&&h.push(i[s]);if(h.length>0){if(!u)for(t.datavisualization.Diagram.SvgContext._renderSpacingLines(t.datavisualization.Diagram.Point(o.x+o.width+15,o.y+c.offset),t.datavisualization.Diagram.Point(o.x+o.width+15,o.y+o.height+c.offset),f,n._svg,l,a,v),s=0;s<h.length;s++)o=t.datavisualization.Diagram.Util.bounds(h[s].source),t.datavisualization.Diagram.SvgContext._renderSpacingLines(t.datavisualization.Diagram.Point(o.x+o.width+15,o.y),t.datavisualization.Diagram.Point(o.x+o.width+15,o.y+o.height),f,n._svg,l,a,v);r.offset=c.offset;r.snapped=!0}},_findEquallySpacedNodesAtLeft:function(n,i,r,u){for(var o,f,s,e=1;e<n.length;e++)if(o=t.datavisualization.Diagram.Util.bounds(n[e-1].object),f=t.datavisualization.Diagram.Util.bounds(n[e].object),s=o.x-f.x-f.width,Math.abs(s-i)<=1)u[u.length]=n[e],f.y<r&&(r=f.y);else break;return r},_findEquallySpacedNodesAtRight:function(n,i,r,u,f){var l=n[0].distance,s,h,o,c,e;if(Math.abs(i-l)<=f)for(e=0;e<n.length-1;e++)if(s=n[e].object,h=t.datavisualization.Diagram.Util.bounds(n[e+1].object),o=t.datavisualization.Diagram.Util.bounds(s),c=h.x-o.x-o.width,Math.abs(c-i)<=1)u[u.length]=n[e+1],o.y<r&&(r=o.y);else break;return r},_findEquallySpacedNodesAtTop:function(n,i,r,u){for(var o,f,s,e=1;e<n.length;e++)if(o=t.datavisualization.Diagram.Util.bounds(n[e-1].object),f=t.datavisualization.Diagram.Util.bounds(n[e].object),s=o.y-f.y-f.height,Math.abs(s-i)<=1)u[u.length]=n[e],f.x+f.width>r&&(r=f.x+f.width);else break;return r},_findEquallySpacedNodesAtBottom:function(n,i,r,u,f){var l=n[0].distance,s,h,e,c,o;if(Math.abs(i-l)<=f)for(o=0;o<n.length-1;o++)if(s=n[o].object,h=t.datavisualization.Diagram.Util.bounds(n[o+1].object),e=t.datavisualization.Diagram.Util.bounds(s),c=h.y-e.y-e.height,Math.abs(c-i)<=1)u[u.length]=n[o+1],e.x+e.width>r&&(r=e.x+e.width);else break;return r}};t.datavisualization.Diagram.SpatialUtil={findQuads:function(n,t){n.quads=[];var i=n.parentQuad;return this._findQuads(n,i,t),n.quads},_addIntoAQuad:function(n){for(var t=!1;!t;)t=this._add(n,n.parentQuad)},_setCurrentNode:function(n,i){n.childnode=i;var r=t.datavisualization.Diagram.Util.bounds(i);n.childLeft=r.left;n.childTop=r.top;n.childRight=r.right;n.childBottom=r.bottom},_add:function(n,i){if(this._isContained(n,i))return this._selectQuad(n,i),!0;var r,u=!i.objects.length&&i.first==null&&i.second==null&&i.third==null&&i.fourth==null;return n.childLeft<i.left?n.childTop<i.top?(r=t.datavisualization.Diagram.Quad(i.left-i.width,i.top-i.height,i.width*2,i.height*2),u||(r.fourth=i)):(r=t.datavisualization.Diagram.Quad(i.left-i.width,i.top,i.width*2,i.height*2),u||(r.second=i)):n.childTop<i.top?(r=t.datavisualization.Diagram.Quad(i.left,i.top-i.height,i.width*2,i.height*2),u||(r.third=i)):(r=t.datavisualization.Diagram.Quad(i.left,i.top,i.width*2,i.height*2),u||(r.first=i)),i.parent=r,n.parentQuad=r,!1},_isContained:function(n,t){return n.childLeft>=t.left&&n.childRight<=t.left+t.width&&n.childTop>=t.top&&n.childBottom<=t.top+t.height?!0:!1},_selectQuad:function(n,t){for(var i=t;i!==null;)i=this._getQuad(n,i)},_getQuad:function(n,i){var u=i.width/2,f=i.height/2,e,r;if(u>=100&&f>=100)if(e=i.left+u,r=i.top+f,n.childRight<=e){if(n.childBottom<=r)return i.first?i.first:i.first=t.datavisualization.Diagram.Quad(i.left,i.top,u,f,i);if(n.childTop>=r)return i.third?i.third:i.third=t.datavisualization.Diagram.Quad(i.left,r,u,f,i)}else if(n.childLeft>=e){if(n.childBottom<=r)return i.second?i.second:i.second=t.datavisualization.Diagram.Quad(e,i.top,u,f,i);if(n.childTop>=r)return i.fourth?i.fourth:i.fourth=t.datavisualization.Diagram.Quad(e,r,u,f,i)}return i.objects.push(n.childnode),n.quadTable[n.childnode.name]=i,null},_findQuads:function(n,t,i){t.first&&this._isIntersect(t.first,i)&&this._findQuads(n,t.first,i);t.second&&this._isIntersect(t.second,i)&&this._findQuads(n,t.second,i);t.third&&this._isIntersect(t.third,i)&&this._findQuads(n,t.third,i);t.fourth&&this._isIntersect(t.fourth,i)&&this._findQuads(n,t.fourth,i);t.objects.length>0&&n.quads.push(t)},_isIntersect:function(n,t){return n.left+n.width<t.left||n.top+n.height<t.top||n.left>t.right||n.top>t.bottom?!1:!0},_update:function(n){if(n.parent!=null&&n.objects.length==0&&n.first==null&&n.second==null&&n.third==null&&n.fourth==null){var t=n.parent;t.first==n?t.first=null:t.second==n?t.second=null:t.third==n?t.third=null:t.fourth==n&&(t.fourth=null);this._update(n.parent)}else return},_isWithinPageBounds:function(n,t){return t.left>=n.pageLeft&&t.right<=n.pageRight&&t.top>=n.pageTop&&t.bottom<=n.pageBottom?!0:!1},_updateBounds:function(n,i,r){var u=!1;r.name==i.topElement.name&&(u=!0,i.pageTop=null,this._findQuadElement(i,i.parentQuad,"top"));r.name==i.leftElement.name&&(u=!0,i.pageLeft=null,this._findQuadElement(i,i.parentQuad,"left"));r.name==i.rightElement.name&&(u=!0,i.pageRight=null,this._findQuadElement(i,i.parentQuad,"right"));r.name==i.bottomElement.name&&(u=!0,i.pageBottom=null,this._findQuadElement(i,i.parentQuad,"bottom"));u&&n._pageBackgroundLayer&&t.datavisualization.Diagram.PageUtil._updatePageSize(n)},_findQuadElement:function(n,i,r){var u,f;switch(r){case"bottom":i.third!=null||i.fourth!=null?(i.third!=null&&this._findQuadElement(n,i.third,r),i.fourth!=null&&this._findQuadElement(n,i.fourth,r)):(i.first!=null&&this._findQuadElement(n,i.first,r),i.second!=null&&this._findQuadElement(n,i.second,r));break;case"top":i.first!=null||i.second!=null?(i.first!=null&&this._findQuadElement(n,i.first,r),i.second!=null&&this._findQuadElement(n,i.second,r)):(i.third!=null&&this._findQuadElement(n,i.third,r),i.fourth!=null&&this._findQuadElement(n,i.fourth,r));break;case"left":i.first!=null||i.third!=null?(i.first!=null&&this._findQuadElement(n,i.first,r),i.third!=null&&this._findQuadElement(n,i.third,r)):(i.second!=null&&this._findQuadElement(n,i.second,r),i.fourth!=null&&this._findQuadElement(n,i.fourth,r));break;case"right":i.second!=null||i.fourth!=null?(i.second!=null&&this._findQuadElement(n,i.second,r),i.fourth!=null&&this._findQuadElement(n,i.fourth,r)):(i.third!=null&&this._findQuadElement(n,i.third,r),i.first!=null&&this._findQuadElement(n,i.first,r))}for(f=0;f<i.objects.length;f++)u=t.datavisualization.Diagram.Util.bounds(i.objects[f]),r==="bottom"&&(n.pageBottom<=u.bottom||n.pageBottom==null)?(n.pageBottom=u.bottom,n.bottomElement=i.objects[f]):r==="top"&&(n.pageTop>=u.top||n.pageTop==null)?(n.pageTop=u.top,n.topElement=i.objects[f]):r==="left"&&(n.pageLeft>=u.left||n.pageLeft==null)?(n.pageLeft=u.left,n.leftElement=i.objects[f]):r==="right"&&(n.pageRight<=u.right||n.pageRight==null)&&(n.pageRight=u.right,n.rightElement=i.objects[f])},_initializeNodes:function(n,t){for(var r,u=n.model.nodes,i=0;i<u.length;i++)r=u[i],r.isGroup||this._updateQuad(n,t,r)},_initializeConnectors:function(n,t){for(var r=n.model.connectors,i=0;i<r.length;i++)this._updateQuad(n,t,r[i])},_updateQuad:function(n,i,r,u){var o,e,f;this._setCurrentNode(i,r);o=t.datavisualization.Diagram.Util.bounds(r);e=i.quadTable[r.name];e?r.line?(this._removeFromaQuad(i,e,r),this._addIntoAQuad(i)):this._isContained(i,e)||(this._removeFromaQuad(i,e,r),this._addIntoAQuad(i)):(i.parentQuad||(i.parentQuad=t.datavisualization.Diagram.Quad(0,0,200,200)),this._addIntoAQuad(i));this._isWithinPageBounds(i,o)&&i.leftElement!=r&&i.topElement!=r&&i.rightElement!=r&&i.bottomElement!=r||(f=!1,i.pageLeft>=i.childLeft||i.pageLeft==null?(i.pageLeft=i.childLeft,i.leftElement=r,f=!0):r==i.leftElement&&(i.pageLeft=null,this._findQuadElement(i,i.parentQuad,"left"),f=!0),i.pageTop>=i.childTop||i.pageTop==null?(i.pageTop=i.childTop,i.topElement=r,f=!0):r==i.topElement&&(i.pageTop=null,this._findQuadElement(i,i.parentQuad,"top"),f=!0),i.pageBottom<=i.childBottom||i.pageBottom==null?(f=!0,i.pageBottom=i.childBottom,i.bottomElement=r):r==i.bottomElement&&(i.pageBottom=null,this._findQuadElement(i,i.parentQuad,"bottom"),f=!0),i.pageRight<=i.childRight||i.pageRight==null?(i.pageRight=i.childRight,i.rightElement=r,f=!0):r==i.rightElement&&(i.pageRight=null,this._findQuadElement(i,i.parentQuad,"right"),f=!0));!u&&f&&n._pageBackgroundLayer&&t.datavisualization.Diagram.PageUtil._updatePageSize(n)},_removeFromaQuad:function(n,t,i){if(t){var r=t.objects.indexOf(i);t.objects.splice(r,1);this._update(t);delete n.quadTable[i.name]}}};t.datavisualization.Diagram.Quad=function(n,t,i,r,u){return{left:n,top:t,width:i,height:r,parent:u,first:null,second:null,third:null,fourth:null,objects:[]}};t.datavisualization.Diagram.SpatialSearch=function(){return{pageLeft:null,pageRight:null,pageTop:null,pageBottom:null,topElement:null,bottomElement:null,rightElement:null,leftElement:null,childLeft:null,childTop:null,childRight:null,childBottom:null,childNode:null,quads:null,parentQuad:t.datavisualization.Diagram.Quad(0,0,200,200),quadTable:{}}}}(jQuery,Syncfusion)