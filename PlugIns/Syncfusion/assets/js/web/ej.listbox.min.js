/*!
*  filename: ej.listbox.min.js
*  version : 12.4.0.24
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n,t){t.widget("ejListBox","ej.ListBox",{element:null,model:null,itemRequest:null,validTags:["ul"],_setFirst:!1,_rootCSS:"e-listbox",defaults:{itemsCount:0,dataSource:null,query:null,itemRequest:null,fields:{id:null,text:null,imageUrl:null,imageAttributes:null,spriteCssClass:null,htmlAttributes:null,toolTipText:null,selected:null,category:null,tableName:null},height:"272",width:"200",template:null,text:"",selectedItemIndex:null,selectedItems:[],checkedItems:[],checkedItemlist:[],selectedItemlist:[],cascadeTo:null,value:"",cssClass:"",showRoundedCorner:!1,enableRTL:!1,enableTooltip:!1,enabled:!0,showCheckbox:!1,allowGrouping:!1,checkAll:!1,unCheckAll:!1,enableLoadOnDemand:!1,enableVirtualScrolling:!1,enablePersistence:!1,allowMultiSelection:!1,allowDragAndDrop:!1,create:null,selectIndexChanged:null,selected:null,itemDragStart:null,itemDrag:null,itemDragStop:null,itemDropped:null,checkChange:null,destroy:null},dataTypes:{cssClass:"string",itemsCount:"number",allowDragAndDrop:"boolean",height:"string",width:"string",template:"string",selectedItemIndex:"number",cascadeTo:"string",showRoundedCorner:"boolean",enableRTL:"boolean",enableTooltip:"boolean",enablePersistence:"boolean",enabled:"boolean",allowMultiSelection:"boolean",dataSource:"data",selectedItems:"data",checkedItems:"data",checkedItemlist:"data",selectedItemlist:"data"},observables:["value"],value:t.util.valueFunction("value"),enable:function(){this.listContainer.hasClass("e-disable")&&(this.target.disabled=!1,this.model.enabled=!0,this.listContainer.removeClass("e-disable"),this.model.allowMultiSelection&&this.listContainer.removeClass("e-disable"),this.scrollerObj.enable())},disable:function(){this.listContainer.hasClass("e-disable")||(this.target.disabled=!0,this.model.enabled=!1,this.listContainer.addClass("e-disable"),this.model.allowMultiSelection&&this.listContainer.addClass("e-disable"),this.scrollerObj.disable())},selectItemByIndex:function(t){if(t=parseInt(t),!this.model.enabled)return!1;if(t!=null){this._activeItem=t;this._activeItem<=0?this._activeItem=0:this._activeItem==this._listSize-1&&(this._activeItem=this._listSize-1);var i=n(this.element.children("li")[this._activeItem]);this._activeItem!=this._aselectedItem&&(this.element.children("li").removeClass("e-hover"),i.addClass("e-select"))}},selectAll:function(){this.element.children("li").addClass("e-hover");this.element.children("li").addClass("e-select")},unSelectAll:function(){this._removeListHover()},selectItemsByIndex:function(t){var r,i,u,f;if(!this.model.enabled)return!1;for(r=t.split(","),i=0;i<r.length;i++)r[i]!=null&&(u=parseInt(r[i]),this._activeItem=u,this._activeItem<0?this._activeItem=0:this._activeItem==this._listSize-1&&(this._activeItem=this._listSize-1),f=n(this.element.children("li")[this._activeItem]),this._activeItem!=this._aselectedItem&&(this.element.children("li").removeClass("e-hover"),f.addClass("e-select")))},unselectItemsByIndex:function(t){var r,i,u,f;if(!this.model.enabled)return!1;for(r=t.split(","),i=0;i<r.length;i++)r[i]!=null&&(u=parseInt(r[i]),f=n(this.element.children("li")[u]),this._activeItem=u,f.removeClass("e-active"),f.removeClass("e-select"))},unselectItemByIndex:function(t){if(t=parseInt(t),!this.model.enabled)return!1;var i=n(this.element.children("li")[t]);i.hasClass("e-select")&&(i.removeClass("e-active"),i.removeClass("e-select"))},getSelectedItem:function(){return this.model._aselectedItem},getSelectedItems:function(){return this.model.selectedItems},getCheckedItems:function(){return this.model.checkedItems},removeItem:function(){this.model.enabled&&(this._getItem(this._selectedItemindex()).remove(),this._refreshItems())},disableItem:function(){this._getItem(this._selectedItemindex()).addClass("e-disable")},moveUp:function(){var n=this._getItem(this._selectedItemindex()).prev(),t=this._getItem(this._selectedItemindex()),i=this._selectedItemindex()-1,r=this._selectedItemindex();this._addListHover();n.insertAfter(t);this._trigger("indexchange",{data:this.model})},moveDown:function(){var n=this._getItem(this._selectedItemindex()).next(),t=this._getItem(this._selectedItemindex()),i=this._selectedItemindex()+1,r=this._selectedItemindex();this._addListHover();n.insertBefore(t);this._trigger("indexchange",{data:this.model})},checkAll:function(){if(!this.model.enabled)return!1;for(i=0;i<this.listitems.length;i++)n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("isChecked")||(n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this.model.checkedItems.push(this.listitems[i]))},checkitems:function(){var t;if(!this.model.enabled)return!1;if(this.model.showCheckbox)for(i=0;i<this.model.checkedItemlist.length;i++)t=this.model.checkedItemlist[i],n(this.listitems[t].firstChild).find(".listcheckbox").ejCheckBox("isChecked")||(n(this.listitems[t].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this.model.checkedItems.push(this.listitems[t]));else if(this.model.allowMultiSelection)for(i=0;i<this.model.selectedItemlist.length;i++)t=this.model.selectedItemlist[i],n(this.listitem[t]).hasClass("e-select")?(n(this.listitem[t]).removeClass("e-select"),this.model.selectedItems.pop(n(this.listitem[t]))):(n(this.listitem[t]).addClass("e-select"),this.model.selectedItems.push(n(this.listitem[t])));else this.unSelectAll(),n(this.listitem[this.model.selectedItemIndex]).hasClass("e-select")||n(this.listitem[this.model.selectedItemIndex]).addClass("e-select"),this.model.selectedItems.push(n(this.listitem[this.model.selectedItemIndex]))},unCheckAll:function(){if(!this.model.enabled)return!1;for(i=0;i<this.listitems.length;i++)n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("isChecked")&&n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!1),this.model.checkedItems.pop(this.listitems[i])},addItem:function(n){this.model.enabled&&(this.listitem=this.listContainer.find("ul").append('<li role="option">'+n+"<\/li>"),this._refreshItems())},_checkContains:function(n){var r=n,i=this.element[0].value.split(","),t;for(this.contains=!1,t=0;t<i.length;t++)i[t]==r&&(this.contains=!0);return this.contains},_init:function(){this._id=this.element[0].id;this._initialize();this._render();this._enabled(this.model.enabled);this._wireEvents();this._initValue=!1},_changeSkin:function(n){this.model.cssClass!=n&&this.listContainer.removeClass(this.model.cssClass).addClass(n)},_setRTL:function(){this.listContainer.addClass("e-rtl")},_setText:function(t){var r=this.listitems.length;for(i=0;i<r;i++)n(this.element.children("li")[i]).text()==t&&(this.unSelectAll(),this.selectItemByIndex(i))},_setModel:function(n){if(!this.model.enabled&&t.isNullOrUndefined(n.enabled))return!1;for(var i in n)switch(i){case"dataSource":this._checkModelDataBinding(n[i]);break;case"query":this._queryCheck(n[i]);break;case"fields":this.model.fields=n[i];this._checkModelDataBinding(this.model.dataSource);break;case"template":this.model.template=n[i];this._checkModelDataBinding(this.model.dataSource);break;case"value":this._setText(t.util.getVal(n[i]));break;case"enableRTL":this._setRTL(n[i]);break;case"enabled":this._enabled(n[i]);break;case"height":this.model.Height=n[i];this._setListHeight(n[i]);break;case"width":this.model.Width=n[i];this._setListWidth();break;case"cssClass":this._changeSkin(n[i]);break;case"showCheckbox":this.checkboxHideShow(n[i]);break;case"checkAll":this._setCheckAll(n[i]);break;case"uncheckAll":this._setUncheckAll(n[i]);break;case"showRoundedCorner":this._roundedCorner(n[i]);this.model.showRoundedCorner=n[i];break;case"selectedItemIndex":this.selectItemByIndex(n[i]);break;case"selectedItems":this._selectCheckedItem(n[i]);this.model.selectedItems=n[i];break;case"checkedItems":this._selectCheckedItem(n[i]);this.model.checkedItems=n[i];break;case"checkedItemlist":this.model.checkedItemlist=n[i];break;case"selectedItemlist":this.model.selectedItemlist=n[i];break;case"allowMultiSelection":this.model.allowMultiSelection=n[i];n[i]?this._renderBoxModel():this._destroyBoxModel();break;case"allowDragAndDrop":n[key]&&this._enableDargDrop()}},_destroy:function(){this.element[0].value="";var t=n(this.element.parents()[2]);this.element.removeClass("e-listbox e-js e-ul");this.model.dataSource!=null?(this.element.children().remove(),t.append(this.element.parents().first().html()),this.listContainer.remove()):(t.append(this.element.parents().first().html()),this.listContainer.remove());n(window).unbind("resize",n.proxy(this._OnWindowResize,this))},_finalize:function(){this.model.selectedItemIndex!=null?this.selectItemByIndex(this.model.selectedItemIndex):this.model.showCheckbox==!0&&this.model.selectedItems.length>0&&this._selectCheckedItem(this.model.selectedItems)},_initialize:function(){this.target=this.element[0];this._queryString=null;this._itemId=null;this.checkedStatus=!1;this._incqueryString="";this._activeItem=null;this._initValue=!0},_render:function(){this._renderContainer();this._initDataSource(this.model.dataSource);this._showFullList();this._addDragableClass();this._finalize()},_queryCheck:function(n){this.model.query=n;this._checkModelDataBinding(this.model.dataSource)},_checkModelDataBinding:function(n){this.model.dataSource=n;n!=null?t.DataManager&&n instanceof t.DataManager?this._initDataSource(n):this._showFullList():this.element.empty()},_initDataSource:function(n){var i=this,r;t.DataManager&&n instanceof t.DataManager&&(query=this.model.query.take(11),i.listitems=i.model.dataSource,i._addLoadingClass(),r=n.executeQuery(query),r.done(function(n){i.listitems=n.result;i._removeLoadingClass();i._showFullList()}).fail(function(){i.model.dataSource=null;i._addLoadingClass()}))},_getQuery:function(){var u;if(t.isNullOrUndefined(this.model.query)){var r=[],i=t.Query(),n=this.model.fields;for(u in n)u!=="tableName"&&r.push(n[u]);r.length>0&&i.select(r);this.model.dataSource.dataSource.url.match(n.tableName+"$")||t.isNullOrUndefined(n.tableName)||i.from(n.tableName)}else i=this.model.query;return i},_addDragableClass:function(){this.model.allowDragAndDrop&&(this.element.css("cursor","pointer"),this.listContainer.addClass("e-droppable"),this.listBoxScroller.addClass("e-droppable"),this.element.children("li").each(function(){n(this).addClass("e-draggable e-droppable")}))},_enableDargDrop:function(){this.model.allowDragAndDrop&&this._drag()},_addLoadingClass:function(){this.listContainer.addClass("e-load")},_removeLoadingClass:function(){this.listContainer.removeClass("e-load")},_checkNameAttr:function(){this.element.attr("name")?this._hiddenInput.attr("name",this.element.attr("name")):(this._hiddenInput.attr("name",this._id),this.element.attr("name",this._id))},_renderContainer:function(){this.listContainer=t.buildTag("div.e-ddl-popup e-box e-popup e-widget "+this.model.cssClass+"#"+this._id+"_container","",{visibility:"hidden"},{tabIndex:0});this.listBoxScroller=t.buildTag("div");this.ultag=t.buildTag("ul.e-ul","",{},{role:"listbox"});this.element=this.element.addClass("e-ul");this.listContainer.append(this.listBoxScroller);this.listContainer.insertAfter(this.element);this.listBoxScroller.append(this.element);this.element.attr("unselectable","on");this.element.css("user-select","none");this.element.on("selectstart",!1)},_renderlistContainer:function(){var e,i,c,l,u,f,s,a,r,o,h;if(this.hold=!1,this.item="",this.touchhold=!1,this.startime=0,e=this.listitems,i=this.model.fields,this.lastScrollTop=0,this.dummyUl=n(),this.model.enableRTL&&this.listContainer.addClass("e-rtl"),this.model.dataSource==null||this.model.dataSource.length<1)c=this.element.parents().last(),this.docbdy=this.model.targetID?c.find("#"+this.model.targetID):c.find("#"+this._id),this.itemsContainer=this.docbdy,this.itemsContainer.children("ol,ul").remove(),this.items=this.itemsContainer.children("li"),this.items.children("img").addClass("e-align"),this.items.children("div").addClass("e-align"),this.element.append(this.itemsContainer.children());else if(this.model.dataSource==null||typeof e[0]=="object")if(this.mapFld={_id:null,_imageUrl:null,_imageAttributes:null,_toolTipText:null,_spriteCSS:null,_text:null,_value:null,_htmlAttributes:null,_selected:null},this.mapFld._id=i&&i.id?i.id:"id",this.mapFld._imageUrl=i&&i.imageUrl?i.imageUrl:"imageUrl",this.mapFld._toolTipText=i&&i.toolTipText?i.toolTipText:"toolTipText",this.mapFld._imageAttributes=i&&i.imageAttributes?i.imageAttributes:"imageAttributes",this.mapFld._spriteCSS=i&&i.spriteCssClass?i.spriteCssClass:"spriteCssClass",this.mapFld._text=i&&i.text?i.text:"text",this.mapFld._value=i&&i.value?i.value:"value",this.mapFld._htmlAttributes=i&&i.htmlAttributes?i.htmlAttributes:"htmlAttributes",this.mapFld._selected=i&&i.selected?i.selected:"selected",l=i&&i.category?i.category:"category",f=t.Query(),this.model.enableLoadOnDemand){if(!this.model.enableVirtualScrolling){for(f=t.Query().take(11),this.realUllength=0,query=this.model.query.take(11),s=this,t.DataManager&&this.model.dataSource instanceof t.DataManager&&(s.listitems=s.model.dataSource,a=this.model.dataSource.executeQuery(query),a.done(function(n){s.listitems=n.result})),r=0;r<this.model.itemsCount;r++)o=t.buildTag("li",e[r]),o.css("height","20px"),this.dummyUl.push(o[0]);for(this.displayeditem=2,this.element.append(this.dummyUl),r=0;r<this.listitems.length;r++)o=t.buildTag("li"),o.css("height","20px"),this.dummyUl.push(o[0]);this.element.append(this.dummyUl)}this.realUllength=0;f=f.range(0,11);this.displayeditem=2;u=t.DataManager(e).executeLocal(f);this._loadlist(u)}else if(this.model.enableVirtualScrolling)this.realUllength=0,f=f.range(0,11),this.displayeditem=2,u=t.DataManager(e).executeLocal(f),this._loadlist(u);else if(u=t.DataManager(e).executeLocal(f),u.length>0)if(this.model.template!=null){for(r=0;r<e.length;r++)o=t.buildTag("li",e[r]),this.model.template&&o.append(this._getTemplatedString(e[r])),this.dummyUl.push(o[0]);this.element.append(this.dummyUl)}else if(f=t.Query().group(l),u=t.DataManager(e).executeLocal(f),this.model.allowGrouping)for(r=0;r<u.length;r++)h=t.buildTag("span"),h.append(u[r].key),h.addClass("e-ghead"),this.dummyUl.push(h[0]),this._loadlist(u[r].items);else this.realUllength=0,this._loadlist(u[0].items);this.element.children("li").attr({role:"option"}).css("list-style","none");this._setListWidth();this._setListHeight();this._setListPosition();this.listContainer.css("height","");this.listBoxScroller.css({height:"",width:""});this.listContainer.ejScroller({height:this.listContainer.height(),width:0,scrollerSize:20});this.scrollerObj=this.listContainer.ejScroller("instance");this._setListHeight();this.listContainer.css({display:"none",visibility:"visible"});this.checkboxHideShow(this.model.showCheckbox);this._setCheckAll(this.model.checkAll);this._setUncheckAll(this.model.uncheckAll);this.checkitems();this._showResult()},_loadlist:function(i){var r;if(this.element!=null){for(r=0;r<i.length;r++){var a=this._getField(i[r],this.mapFld._id),e=this._getField(i[r],this.mapFld._imageUrl),o=this._getField(i[r],this.mapFld._imageAttributes),s=this._getField(i[r],this.mapFld._spriteCSS),u=this._getField(i[r],this.mapFld._text),h=this._getField(i[r],this.mapFld._value),c=this._getField(i[r],this.mapFld._htmlAttributes),v=this._getField(i[r],this.mapFld._selected),l=this._getField(i[r],this.mapFld._toolTipText),f=this.realUllength;litag=h&&h!=""?t.buildTag("li","",{},{value:h}):t.buildTag("li");a&&litag.attr("id",a);e&&e!=""&&(imgtag=t.buildTag("img.e-align","",{},{src:e,alt:u}),o&&o!=""&&imgtag.attr(o),litag.append(imgtag));s&&s!=""&&(divtag=t.buildTag("div.e-align "+s+" sprite-image"),litag.append(divtag));u&&u!=""&&litag.append(u);c&&c!=""&&litag.attr(c);l&&l!=""&&this.model.enableTooltip&&litag.attr("title",l);v&&litag.addClass("chkselect");this.element.children()[f]!=null&&this.model.enableLoadOnDemand&&n(this.element.children()[f]).text()==""?n(this.element.children()[f]).replaceWith(litag[0]):this.dummyUl.push(litag[0]);this.realUllength+=1}this.model.enableLoadOnDemand||this.element.children().remove();this.element.children()[f]==null&&(!this.model.enableLoadOnDemand||this.model.enableVirtualScrolling)&&this.element.append(this.dummyUl)}},_getField:function(n,i){return t.pvt.getObject(i,n)},_getTemplatedString:function(n){for(var t=this.model.template,i=t.indexOf("${"),r=t.indexOf("}"),u,f;i!=-1&&r!=-1;)u=t.substring(i,r+1),f=u.replace("${","").replace("}",""),t=t.replace(u,this._getField(n,f)),i=t.indexOf("${"),r=t.indexOf("}");return t},checkboxHideShow:function(n){n?this._createCheckbox():this._removeCheckbox();this.model.showCheckbox=n},_createCheckbox:function(){var i,r,u=this;if(this.listitems=this.listContainer.find("ol,ul").children("li"),r=this.listitems.find("input[type=checkbox]"),r.length==0){for(i=0;i<this.listitems.length;i++)$checkbox=t.buildTag("input.listcheckbox e-align#popuplist"+i+"_"+this._id,"",{},{type:"checkbox",name:"list"+i}),n(this.listitems[i]).prepend($checkbox);for(this.listContainer.find(".listcheckbox").ejCheckBox({cssClass:this.model.cssClass,change:n.proxy(this._OnClickCheckList,this)}),i=0;i<this.listitems.length;i++)n(this.listitems[i]).hasClass("chkselect")&&(n(this.listitems[i]).find(".listcheckbox").ejCheckBox({checked:!0}),this._activeItem=i,this.checkedStatus=!0,this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model}),n(this.listitems[i]).removeClass("chkselect"))}},_removeCheckbox:function(){var n;this.listitem=this.listContainer.find("ol,ul").children("li");n=this.listitem.find(".listcheckbox");n.length>0&&(this.listitem.find(".listcheckbox").ejCheckBox("destroy"),this.listitem.find("input[type=checkbox]").remove(),this.model.checkedItems=[])},_setCheckAll:function(n){this.model.showCheckbox&&n&&this.checkAll()},_setUncheckAll:function(n){this.model.showCheckbox&&n&&this.unCheckAll()},_selectCheckedItem:function(n){if(n.length>0)for(i=0;i<n.length;i++)this.model.selectedItems.push(n[i])},_refreshScroller:function(){if(this.model.enableVirtualScrolling)this.listContainer.find(".e-content, .e-vhandle").removeAttr("style"),this.listContainer.find(".e-vhandle div").removeAttr("style"),this.listContainer.css({display:"block"}),this.scrollerObj.model.height=this.listContainer.height(),this.scrollerObj.refresh(),this.scrollerObj.option("scrollTop",0);else{this.listContainer.find(".e-vhandle div").removeAttr("style");var n=this.listBoxScroller.height();this.listContainer.css({display:"block"});this.scrollerObj.model.height=this.listContainer.height();this.scrollerObj.refresh();this.listBoxScroller.css("height","");this.listBoxScroller.css("height","100%")}},_setListWidth:function(){var n=this.model.width;this.listContainer.css({width:n})},_setListHeight:function(){var n=this.model.height;this.listContainer.css({height:n})},_refreshContainer:function(){this.listContainer.css({width:this.model.width});this._setListPosition();this._setListHeight();this._roundedCorner();this._refreshScroller()},_setListPosition:function(){this.listContainer.css({position:"relative"})},_drag:function(){var t=this,r=!1,i=null;this._listitem=this.element.parent();n(this._listitem).find("li").not(".e-js").ejDraggable({dragArea:null,clone:!0,dragStart:function(r){var f=this.element.parent()[0].id,e=n("#"+f).data("ejListBox"),u;return e._refreshItems(),u={target:r.target,event:r.event},t._onDragStarts(u)?(r.cancel=!0,i&&i.remove(),!1):void 0},drag:function(i){var r=i.target,u={target:r,event:i.event};if(t._onDrag(u))return!1;(n(r).hasClass("e-droppable")||n(r).parent().hasClass("e-droppable"))&&(document.body.style.cursor="",n(r).addClass("allowDrop"))},dragStop:function(u){var e;u.element.dropped||(i&&i.remove(),document.body.style.cursor="");var f=u.target,s=t,o=r?"Before":"After",e={target:f,position:o,event:u.event};if(t._onDragStop(e)||(n(u.element).removeClass("e-active"),f.nodeName=="UL"&&(f=n(f).children()[0]),f.nodeName!="LI"&&(f=n(f).parent(".e-droppable")[0]||n(f).parent()),f.nodeName=="LI"&&n(f).hasClass("e-droppable")?t._dropItem(f,u.element,r,u.event):n(f).hasClass("e-droppable")&&t._dropItemContainer(f,u.element,r,u.event),n(".allowDrop").removeClass("allowDrop"),e={target:f,event:u.event,dropedElement:u.element},t._onDropped(e)))return!1;document.body.style.cursor=""},helper:function(t){return i=n(t.sender.target).clone().addClass("dragClone dragClonelist"),i.appendTo(n("body"))}})},_dropItem:function(t,i,r){var u=n(i),f,e;r?n(u).insertBefore(t):n(u).insertAfter(t);this._refreshItems();f=n(t).parents("div")[1].id.replace("_container","");e=n("#"+f).data("ejListBox");e._refreshItems()},_dropItemContainer:function(t,i){var r=n(i),u,f;n(r).insertAfter(n(n(t).find("li")).last());n(t).find("ul").append(n(r));this._refreshItems();u=n(t)[0].id.replace("_container","");f=n("#"+u).data("ejListBox");f._refreshItems()},_showResult:function(){var i=this,t;this._refreshContainer();this.element.attr({"aria-expanded":!0});t=this.element.children("li");this._listSize=t.size();t.unbind("contextmenu",n.proxy(this._OnMouseContext,this));t.unbind("mouseup",n.proxy(this._OnMouseClick,this));t.unbind("touchstart mouseenter",n.proxy(this._OnMouseEnter,this));t.unbind("touchend mouseleave",n.proxy(this._OnMouseLeave,this));n(window).unbind("resize",n.proxy(this._OnWindowResize,this));this._off(n(this.listContainer),"DOMMouseScroll",this._onScroll);this._on(n(this.listContainer),"DOMMouseScroll",this._onScroll);t.bind("touchstart mouseenter",n.proxy(this._OnMouseEnter,this));t.bind("touchend mouseleave",n.proxy(this._OnMouseLeave,this));t.bind("mouseup",n.proxy(this._OnMouseClick,this));t.bind("contextmenu",n.proxy(this._OnMouseContext,this));n(window).bind("resize",n.proxy(this._OnWindowResize,this))},_OnWindowResize:function(){this._refreshContainer();this.listContainer.css("display","block")},_removeActive:function(){this._ulBox.children("li").removeClass("e-active")},_removeListHover:function(){this.model.selectedItems=[];this.element.children("li").removeClass("e-hover");this.element.children("li").removeClass("e-select")},_addListHover:function(){var n=this._getItem(this._selectedItem);n.addClass("e-select");n.addClass("e-hover");this.scrollerObj.setModel({scrollTop:this._calcScrollTop()});n.focus();this._OnListSelect(this.prevselectedItem,this._selectedItem)},_calcScrollTop:function(){var u=this.element.outerHeight(),i=this.element.find("li"),r=0,n,t;for(n=this.element.find("li.e-select").index(),this.model.enableVirtualScrolling&&(n=this.displayeditem),t=0;t<n;t++)r+=i.eq(t).outerHeight();return r-(this.listContainer.outerHeight()-i.eq(n).outerHeight())/2},_refreshItems:function(){this.listBoxScroller.append(this.element);this.listContainer.append(this.listBoxScroller);this._refreshContainer();this._showResult()},_selectedItemindex:function(){var t;return this.element.children("li").each(function(i){if(n(this).hasClass("e-select"))return t=i,!1}),this._selectedItem=t,t},_getActiveItem:function(){return n(this.element.children("li")[this._activeItem])},_getItem:function(t){return n(this.element.children("li")[t])},_roundedCorner:function(){this.model.showRoundedCorner&&this.listContainer.addClass("e-corner-all")},_enabled:function(n){n?this.enable():this.disable()},_showFullList:function(){this.model.dataSource!=null&&(t.DataManager&&this.model.dataSource instanceof t.DataManager||(this.listitems=this.model.dataSource));this._renderlistContainer();this._addDragableClass();this._enableDargDrop()},_cascadeAction:function(){this.model.cascadeTo&&(this._currentValue=this._getField(this.listitems[this._activeItem],this.mapFld._value),this.selectDropObj=n("#"+this.model.cascadeTo).ejListBox("instance"),t.isNullOrUndefined(this._dSource)&&(this._dSource=this.selectDropObj.model.dataSource),this._performJsonDataInit())},_performJsonDataInit:function(){this._changedSource=t.DataManager(this._dSource).executeLocal(t.Query().where(this.mapFld._value,"==",this._currentValue));this.selectDropObj.setModel({dataSource:this._changedSource,enabled:!0,value:""})},_OnMouseContext:function(n){return this.touchhold=!0,n.preventDefault(),!1},_OnMouseEnter:function(t){var r,i,u;this.startime=0;this.item="";t.type=="touchstart"&&(this.item=n(t.target).text(),this.startime=(new Date).getTime());this.model.enabled&&(this.element.children("li").removeClass("e-hover"),n(t.target).is("li")?n(t.target).addClass("e-hover"):t.target.tagName!="li"&&(r=n(t.target).parents("li"),n(r).addClass("e-hover")),i=0,u=0,this.element.children("li").each(function(t){if(n(this).hasClass("e-hover"))return i=t,!1}),this._activeItem=i)},_OnMouseLeave:function(t){this.element.children("li").removeClass("e-hover");this.endtime=(new Date).getTime();(this.endtime-this.startime)/200>2&&this.item==n(t.target).text()&&(this.hold=(this.endtime-this.startime)/200>2)},_OnMouseClick:function(t){var i,e,o,r,u,s,f,h;if(t.which==3&&(this.hold=!0),this.endtime=(new Date).getTime(),(this.endtime-this.startime)/200>2&&(this.item!=n(t.target).text()||this.hold||(this.hold=(this.endtime-this.startime)/200>2)),this.model.enabled){if(this.model.showCheckbox){if(n(t.currentTarget).is("li")&&n(t.target).is("li"))n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("isChecked")?(n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("option","checked",!1),f=this.model.checkedItems.indexOf(t.currentTarget),this.model.checkedItems.splice(f,1),this.model.checkedItemlist.pop(this._selectedItem)):(n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this.model.checkedItems.push(t.currentTarget),this.model.checkedItemlist.push(this._activeItem));else if(n(t.currentTarget).is("li"))n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("isChecked")?(f=this.model.checkedItems.indexOf(t.currentTarget),this.model.checkedItems.splice(f,1),this.model.checkedItemlist.pop(this._activeItem)):(this.model.checkedItems.push(t.currentTarget),this.model.checkedItemlist.push(this._activeItem));else return!1;this.element.hasClass("e-disable")||(h={status:this.model.enabled},this._trigger("checkChange",h))}else{if(this.prevselectedItem=this._selectedItemindex(),i=n(this.element.children("li")[this._activeItem]),this.model.allowMultiSelection&&(t.ctrlKey||this.touchhold||this.hold||t.shiftKey)||this._removeListHover(),this.element.children("li").removeClass("e-hover"),i.hasClass("e-select"))i.removeClass("e-select"),this.model.selectedItems.pop(i),this.model.selectedItemlist.pop(this._activeItem);else if(i.addClass("e-select"),this.model.selectedItems.push(i),this.model.selectedItemlist.push(this._activeItem),t.shiftKey&&this.model.allowMultiSelection)for(this.prevselectedItem<this._activeItem?(e=this.prevselectedItem,o=this._activeItem):(e=this._activeItem,o=this.prevselectedItem),r=e;r<=o;r++)i=n(this.element.children("li")[r]),i.hasClass("e-select")||i.addClass("e-select"),this.model.selectedItems.push(i),this.model.selectedItemlist.push(this._activeItem);this._selectedItem=this._selectedItemindex();this._cascadeAction();u=n(this.element.children("li")[this._selectedItem]);n(u).text()!=""&&(this.element.val(n(u).text()),this.value(n(u).text()),this.element.attr({value:"this.element.val()"}));this.model.selectedText=i.text();s={selectedText:this.model.selectedText,args:(this.model.selectedItemIndex,this.model.selectedItems,this.model.selectedItemlist,this.model.checkedItemlist)};this.model.selectedItemIndex=this._selectedItem;this._trigger("selected",s)}this._OnListSelect(this.prevselectedItem,this._activeItem)}},_OnClickCheckList:function(n){this.checkedStatus=n.isChecked?!0:!1;this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model})},_OnListSelect:function(n,t){n!=t&&this._trigger("selectIndexChanged",{data:this.model})},_OnKeyDown:function(t){var r,i;if(this.model.enabled){if(!this.model.enabled)return!1;this._itemId=null;r=this.element.children("li");this._listSize=this.element.children("li").size();switch(t.keyCode){case 38:return this.prevselectedItem=this._selectedItemindex(),(t.ctrlKey||t.shiftKey)&&this.model.allowMultiSelection||this._removeListHover(),this.element.children("li").removeClass("e-active"),this._selectedItem<=0||this._selectedItem==null||this._selectedItem>this._listSize-1?this._selectedItem=this._listSize-1:this._selectedItem-=1,this._addListHover(),t.preventDefault(),!1;case 40:return this.prevselectedItem=this._selectedItemindex(),i=0,this.element.children("li").each(function(t){n(this).hasClass("e-select")&&(i=t)}),(t.ctrlKey||t.shiftKey)&&this.model.allowMultiSelection||this._removeListHover(),this.element.children("li").removeClass("e-active"),this._selectedItem=i,this._selectedItem>=this._listSize-1||this._selectedItem==null||this._selectedItem<0?this._selectedItem=0:this._selectedItem+=1,this._addListHover(),t.preventDefault(),this.model.enableLoadOnDemand&&(this._onScroll(),this.element.focus()),!1;case 37:return this.prevselectedItem=this._selectedItemindex(),(t.ctrlKey||t.shiftKey)&&this.model.allowMultiSelection||this._removeListHover(),this.element.children("li").removeClass("e-active"),this._selectedItem<=0||this._selectedItem==null||this._selectedItem>this._listSize-1?this._selectedItem=this._listSize-1:this._selectedItem-=1,this._addListHover(),t.preventDefault(),!1;case 39:return this.prevselectedItem=this._selectedItemindex(),i=0,this.element.children("li").each(function(t){n(this).hasClass("e-select")&&(i=t)}),(t.ctrlKey||t.shiftKey)&&this.model.allowMultiSelection||this._removeListHover(),this.element.children("li").removeClass("e-active"),this._selectedItem=i,this.element.children("li").removeClass("e-active"),this._selectedItem>=this._listSize-1||this._selectedItem==null||this._selectedItem<0?this._selectedItem=0:this._selectedItem+=1,this._addListHover(),t.preventDefault(),this.model.enableLoadOnDemand&&(this._onScroll(),this.element.focus()),!1;case 8:return this.model.allowMultiSelection==!0&&this.model.showCheckbox&&this._deleteLastBox(),t.preventDefault(),!1;case 35:return this.prevselectedItem=this._selectedItemindex(),this._removeListHover(),this.element.children("li").removeClass("e-active"),this._selectedItem=this._listSize-1,this._addListHover(),t.preventDefault(),!1;case 13:t.preventDefault();this._OnMouseClick(t);break;case 36:return this.prevselectedItem=this._selectedItemindex(),this._removeListHover(),this.element.children("li").removeClass("e-active"),this._selectedItem=0,this._addListHover(),t.preventDefault(),!1;case 32:return t.preventDefault(),!1}}},_onmousedown:function(){this._on(n(document),"mouseup",this._onScroll)},_onScroll:function(){var f,o,i,u;if(this.model.enableLoadOnDemand&&!this.model.enableVirtualScrolling){if(this.scrollerObj.scrollTop()>0){var e=n(this.element.find("li")[0]).outerHeight(),s=parseInt(this.scrollerObj.scrollTop()/e+20),r=parseInt(this.scrollerObj.scrollTop()/e);this.realUllength=r;this.realUllength=r;f={start:r};this._trigger("itemRequest",f);t.DataManager&&this.model.dataSource instanceof t.DataManager&&(i=this,i._addLoadingClass(),u=this.model.dataSource.executeQuery(this.model.query),u.done(function(n){i.realUllength=r;i._loadlist(n.result);i._removeLoadingClass()}))}}else if(this.model.enableVirtualScrolling){if(this.scrollerObj.model.height+this.scrollerObj.scrollTop()==this.scrollerObj._v.sScrollDim){if(o=this.scrollerObj.scrollTop(),o>this.lastScrollTop){var h=this.model.query,s=this.element.children().length+10,r=this.element.children().length,f={start:r};this._trigger("itemRequest",f);arguments[0].originalEvent.detail<0?this.displayeditem-=this.model.itemsCount-1:this.displayeditem+=this.model.itemsCount-1;t.DataManager&&this.model.dataSource instanceof t.DataManager&&(i=this,i._addLoadingClass(),u=this.model.dataSource.executeQuery(this.model.query),u.done(function(n){i.realUllength=r;i._loadlist(n.result);i._removeLoadingClass();i.scrollerObj.option("scrollTop",i._calcScrollTop());i.scrollerObj.refresh()}))}this.lastScrollTop=this.scrollerObj.scrollTop()}this._refreshItems();this.listContainer.css("height","auto");this.listContainer.css({display:"block"});this.scrollerObj.model.height=this.listContainer.height();this.scrollerObj.refresh();this.scrollerObj.option("scrollTop",this._calcScrollTop());this.listContainer.css("height","auto");this.listContainer.css({display:"block"});this.scrollerObj.model.height=this.listContainer.height();this.scrollerObj.refresh()}this._off(n(document),"mouseup",this._onScroll)},_onDragStarts:function(n){return this._trigger("itemDragStart",n)},_onDrag:function(n){return this._trigger("itemDrag",n)},_onDragStop:function(n){return this._trigger("itemDragStop",n)},_onDropped:function(n){return this._trigger("itemDropped",n)},_wireEvents:function(){this._on(this.listContainer,"keydown",this._OnKeyDown);this._on(this.listContainer,"DOMMouseScroll",this._onScroll);this._on(this.listContainer,"mousedown",this._onmousedown);this._on(n(".e-vhandle"),"mousedown",this._onmousedown);this._on(n(".e-vhandlespace"),"mousedown",this._onmousedown);this._on(this.listContainer,"mousewheel",this._onScroll);this._enableDargDrop()}})})(jQuery,Syncfusion)