/*!
*  filename: ej.maskedit.min.js
*  version : 12.3
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min"],n):n()})(function(){(function(n,t,i){t.widget("ejMaskEdit","ej.MaskEdit",{element:null,model:null,validTags:["input"],_setFirst:!1,type:"editor",defaults:{maskFormat:"",value:"",watermarkText:"",height:"",width:"",showError:!1,cssClass:"",customCharacter:null,inputMode:"text",readOnly:!1,textAlign:t.TextAlign.Left,hidePromptOnLeave:!1,showRoundedCorner:!1,enablePersistence:!1,enabled:!0,keydown:null,keyup:null,keyPress:null,change:null,mouseover:null,mouseout:null,focusIn:null,focusOut:null,create:null,destroy:null},dataTypes:{maskFormat:"string",showError:"boolean",enabled:"boolean",customCharacter:"string",cssClass:"string",watermarkText:"string",showRoundedCorner:"boolean",inputMode:"enum",textAlign:"enum",hidePromptOnLeave:"boolean",readOnly:"boolean"},_setModel:function(n){if(!this.model.enabled&&t.isNullOrUndefined(n.enabled))return!1;for(var i in n)switch(i){case"value":this._setValue(n[i]);n[i]=this.get_StrippedValue();break;case"width":this._setWidth(n[i]);break;case"height":this._setHeight(n[i]);break;case"watermarkText":this.model.watermarkText=n[i];this._setWaterMark();break;case"showRoundedCorner":this._roundedCorner(n[i]);break;case"textAlign":this._setTextAlign(n[i]);break;case"inputMode":this._setInputMode(n[i]);break;case"maskFormat":this._setMask(n[i]);break;case"cssClass":this._setSkin(n[i]);break;case"readOnly":this._setReadOnly(n[i]);break;case"enabled":this.model.enabled=n[i];this._controlStatus(n[i])}},observables:["value"],_destroy:function(){this.model.name&&this.element.removeAttr("name");this.element.insertAfter(this.wrapper);this.wrapper.remove();this.model.textAlign&&this.element.css("text-align","");this.element.val("").removeClass(" e-mask e-input e-corner-all e-disable e-watermark").empty()},_init:function(){if(this.element.is("input")&&(this.element.is("input[type=text]")||!this.element.attr("type")))this._setValues(),this._renderControl(),this._initObjects(),this._wireEvents();else return this._destroy(),!1},_controlStatus:function(n){n!=!0?this.disable():this.enable()},_setValues:function(){this._tempMask=null;this._unStrippedMask=null;this._charMap={"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]",A:"[A-Za-z]",N:"[0-9]","<":"",">":"",C:"","?":"(.)",$:"[A-Za-z ]"}},_renderControl:function(){this.model.name=this.element.attr("name")!=null?this.element.attr("name"):this.model.name!=null?this.model.name:this.element[0].id;this.element.attr("name")==null&&this.element.attr({name:this.model.name});this.wrapper=t.buildTag("span.e-mask e-widget "+this.model.cssClass);this.innerWrapper=t.buildTag("span.e-in-wrap e-box");this.wrapper.append(this.innerWrapper).insertBefore(this.element);this.innerWrapper.append(this.element);this._hiddenInput=t.buildTag("input#"+this._id+"_hidden","",{},{type:"hidden"}).insertBefore(this.element);this._hiddenInput.attr("name",this.model.name);this.model.value=this.model.value===""?this.element[0].value:this.model.value;this.element.attr({"aria-invalid":!1,value:this.model.value}).addClass("e-input");this._setInputMode(this.model.inputMode);this._setWidth(this.model.width);this._setHeight(this.model.height);this._roundedCorner(this.model.showRoundedCorner);this._setTextAlign(this.model.textAlign);this._setReadOnly(this.model.readOnly);this._controlStatus(this.model.enabled);this.previousValue=this.model.value},_initObjects:function(){this._textbox=this.element[0];this._keypressFlag=0;this._selectedTextKeyDown=0;this._keydownFlag=0;this._maskLength=this.model.maskFormat.length;this._maskModel=this.model.maskFormat.replace(/[9?$CANa*]/g,"_");this._validatedValue=this._maskModel;this.model.inputMode!="password"&&(this._setValue(this.model.value),this._setWaterMark());this.model.showError&&this.element.addClass("e-error").attr("aria-invalid","true")},_setWidth:function(n){this.wrapper.width(n)},_setHeight:function(n){this.wrapper.height(n)},_roundedCorner:function(n){n?this.wrapper.removeClass("e-corner-all").addClass("e-corner-all"):this.wrapper.hasClass("e-corner-all")&&this.wrapper.removeClass("e-corner-all")},_setTextAlign:function(n){n=="right"?this.wrapper.addClass("e-rtl"):this.wrapper.removeClass("e-rtl")},_setInputMode:function(n){this.element.attr("type",n)},_setReadOnly:function(n){n?this.element.attr("readonly",!0):this.element.removeAttr("readonly")},_setSkin:function(n){this.wrapper.removeClass(this.model.cssClass);this.wrapper.addClass(n)},_setWaterMark:function(){this._maskModel=this.model.maskFormat.replace(/[9?$CANa*]/g,"_");this.model.watermarkText&&(this.model.value==""||this.model.value==this._maskModel)?(this._textbox.value=this.model.watermarkText,this.element.addClass("e-watermark")):this.model.value==""&&this._maskModel!=""&&(this._textbox.value=this._maskModel)},_removeWaterMark:function(){this.element.hasClass("e-watermark")&&(this._textbox.value=this._maskModel,this.element.removeClass("e-watermark"))},_showAlert:function(){var t=this;this.element.addClass("e-error").attr("aria-invalid","true").animate({Opacity:1},700,null,function(){n(t._textbox).removeClass("e-error").attr("aria-invalid","false")})},_validateValue:function(){var i=this.model.value,t=this._maskModel,r=-1,f,n,e,o,u;if(this._maskLength==0)return this.element.hasClass("e-watermark")&&this.element.removeClass("e-watermark"),this._textbox.value=i,!0;for(f=this.model.value.toString(),i=this.model.value=f.replace(/[\(\)-]/g,""),n=0;n<this._maskLength;n++)this._charMap[this.model.maskFormat.charAt(n)]&&(r++,e=i.charCodeAt(r),this._validateChars(e,n)&&(o=t.substring(0,n),u=t.substring(n),t=o+i.charAt(r)+u.substr(1,u.length)));this.element.hasClass("e-watermark")?this.model.value?(this.element.removeClass("e-watermark"),this._textbox.value=t):this._setWaterMark():this._textbox.value=this.model.value?t:this.model.maskFormat.replace(/[9?$CANa*]/g,"_")},_selectionText:function(n,t){var i=this._maskModel.substring(n,t);return(this._textbox.value=this._textbox.value.substring(0,n)+i+this._textbox.value.substring(t),this._keydownFlag==1)?(this._setCaretPosition(n),n):this._keydownFlag==2?(this._setCaretPosition(t),t):n},_caretPosition:function(n){var t=0,i,r;return document.selection?(i=document.selection.createRange(),r=i.text.length,i.moveStart("character",-n.value.length),t=i.text.length-r,r!=0&&(t=this._selectionText(t,i.text.length),this._selectedTextKeyDown=1)):(n.selectionStart||n.selectionStart=="0")&&(t=n.selectionStart,n.selectionStart!=n.selectionEnd&&(this._keydownFlag&&(t=this._selectionText(n.selectionStart,n.selectionEnd)),this._selectedTextKeyDown=1)),t},_setCaretPosition:function(n){var t=this._textbox,i;window.navigator.appName=="Microsoft Internet Explorer"?t.createTextRange&&(i=t.createTextRange(),i.move("character",n),i.select()):t.selectionStart||t.selectionStart=="0"?(t.focus(),t.setSelectionRange(n,n)):t.focus()},_validateChars:function(t,i){var f=this._charMap,r=!1,e=this.model.maskFormat.substr(i,1),u=this.model.customCharacter,o=String.fromCharCode(t);return n.each(f,function(n,t){e==n&&(u!=null&&(n=="C"?t="["+u+"]":(n=="A"||n=="N")&&(t=t.replace("]","")+u+"]")),r=o.match(new RegExp(t))?!0:!1)}),r},_seekNext:function(){for(var n=this._caretPosition(this._textbox),t=n,i=!0;i;){if(n>=0&&n<this._maskLength&&(this.model.maskFormat.charAt(n)!="C"&&(this._charMap[this.model.maskFormat.charAt(n)]||(this._setCaretPosition(n),n++)),n!=t)){t=n;continue}i=!1}return n},_seekBefore:function(){var n=this._caretPosition(this._textbox),i=--n,t=!0;for(this._selectedTextKeyDown==1&&(t=!1);t;){if(n>=0&&n<this._maskLength&&(this._charMap[this.model.maskFormat.charAt(n)]||this._setCaretPosition(--n),n!=i)){i=n;continue}t=!1}return n},_writeBuffer:function(n,t){var r,u,e,f;t<=this._maskLength&&(r=this._textbox.value,this._tempMask!=null&&(u=this._updateCasing(n,t)),n=u==i?n:u,e=r.substring(0,t),f=r.substring(t),this._textbox.value=e+n+f.substr(1,f.length),this._setCaretPosition(t+1),this._raiseEvents("change"))},_updateCasing:function(n,t){for(var r,i=0;i<t+1;i++)(this._tempMask.substr(i,1)=="<"||this._tempMask.substr(i,1)==">")&&t++;for(r=t;r>-1;r--){if(this._tempMask.substr(r,1)=="<")return n.toLowerCase();if(this._tempMask.substr(r,1)==">")return n.toUpperCase()}},get_StrippedValue:function(){var i,r,u=this.model.maskFormat,f="",n,t;if(r=this.element.hasClass("e-watermark")?this._maskModel:this._textbox.value,u.length==0)return r;for(i in u)n=u[i],t=null,"9?$a*".indexOf(n)!=-1?t=this._charMap[n]:n=="A"||n=="N"?t=this._charMap[n].replace("]","")+this.model.customCharacter+"]":n=="C"&&(t="["+this.model.customCharacter+"]"),t&&r[i]&&r[i].match(new RegExp(t))&&(f+=r[i]);return f},get_UnstrippedValue:function(){var n=this.element.hasClass("e-watermark")?this._maskModel:this._textbox.value,t="";return this.model.maskFormat.length==0?n:(n!=i&&(t=n.replace(/[_]/g," ")),t)},_setValue:function(n){t.isNullOrUndefined(n)&&(n="");this.model.value=n;t.isNullOrUndefined(this.model.maskFormat)||this.model.maskFormat==""?this._textbox.value=n:this._validateValue();this.model.value=this.get_StrippedValue();this._hiddenInput.val(this.model.value)},_setMask:function(n){this._maskLength=n.length;this.model.maskFormat=n;this._maskModel=n.replace(/[9?$CANa*]/g,"_");this._validateValue()},enable:function(){this.element.disabled=!1;this.element.removeAttr("disabled").removeClass("e-disable").attr({"aria-disabled":!1});this.model.enabled=!0},disable:function(){this.element.disabled=!0;this.element.attr("disabled","disabled").addClass("e-disable").attr({"aria-disabled":!0});this.model.enabled=!1},clear:function(){this.model.enabled&&(this._textbox.value=this.model.maskFormat.replace(/[9?$aCAN*]/g,"_"))},_wireEvents:function(){this._on(this.element,"focus",this._OnFocusHandler);this._on(this.element,"blur",this._OnBlurHandler);this._on(this.element,"keydown",this._OnKeyDownHandler);this._on(this.element,"keypress",this._OnKeyPressHandler);this._on(this.element,"keyup",this._OnKeyUpHandler);this._on(this.element,"mouseover",this._OnMouseOverHandler);this._on(this.element,"mouseout",this._OnMouseOutHandler);this._on(this.element,"paste",this._OnPasteHandler);this._on(this.element,"cut",this._OnCutHandler)},_OnCutHandler:function(){var t=this._maskModel.substring(this._textbox.selectionStart,this._textbox.selectionEnd),i=this._textbox.value.substring(0,this._textbox.selectionStart),r=this._textbox.value.substring(this._textbox.selectionEnd),u=this._textbox.selectionStart,n=this;setTimeout(function(){n._textbox.value=i+t+r;n._setCaretPosition(u);n._raiseEvents("change")},0)},_OnPasteHandler:function(){var t=this;return setTimeout(function(){var i=n(t._textbox).val();t._setValue(i);t._raiseEvents("change")},0),!0},_OnFocusHandler:function(){(this.element.addClass("e-focus"),this._removeWaterMark(),this.model.readOnly)||((this._textbox.value.indexOf("<")>=0||this._textbox.value.indexOf(">")>=0)&&(this._textbox.value=this._textbox.value.replace(/[<>]/g,""),this._maskModel=this._textbox.value,this._tempMask=this.model.maskFormat,this.model.maskFormat=this.model.maskFormat.replace(/[<>]/g,"")),this._textbox.value!=this._maskModel&&this._unStrippedMask!=null&&this.model.hidePromptOnLeave&&(this._textbox.value=this._unStrippedMask),n.fn.selectRange=function(n,t){return this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(n,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",n);i.select()}})},this.model.maskFormat&&this.element.selectRange(0,0),this._raiseEvents("focusIn"))},_OnBlurHandler:function(){this.element.removeClass("e-focus");this.model.value=this.get_StrippedValue();this._textbox.value!=i&&this.model.hidePromptOnLeave&&(this._unStrippedMask=this._textbox.value,this._textbox.value=this.get_UnstrippedValue());this.model.inputMode!="password"&&this._setWaterMark();this._raiseEvents("focusOut")},_OnKeyDownHandler:function(n){var i,r,t;if(!this.model.readOnly){if(this._keypressFlag=0,this._raiseEvents("onKeyDown"),this.element.removeClass("error"),this._maskLength==0)return!0;if(i=n.keyCode?n.keyCode:n.charCode,r=String.fromCharCode(i),i>=35&&i<=41&&(window.navigator.appCodeName=="Mozilla"||window.navigator.appCodeName=="opera")&&(this._keypressFlag=1),n.shiftKey&&(n.keyCode==35||n.keyCode==36||n.keyCode==37||n.keyCode==39||n.keyCode==46||n.keyCode==127)||n.ctrlKey&&(n.keyCode==86||n.keyCode==65||n.keyCode==67||n.keyCode==88)){this._keypressFlag=1;return}return i==8?this.model.inputMode!="password"?(this._keydownFlag=1,t=this._seekBefore(),this._raiseEvents("change"),this._selectedTextKeyDown||(t>=0&&t<this._maskLength&&this._writeBuffer("_",t),this._setCaretPosition(t)),this._keydownFlag=0,this._selectedTextKeyDown=0,n.preventDefault(),!1):(this._keypressFlag=1,!0):n.keyCode==46||n.keyCode==127?this.model.inputMode!="password"?(this._keydownFlag=2,t=this._seekNext(),this._raiseEvents("change"),this._selectedTextKeyDown||t>=0&&t<this._maskLength&&this._writeBuffer("_",t),this._keydownFlag=0,this._selectedTextKeyDown=0,n.preventDefault(),!1):(this._keypressFlag=1,!0):void 0}},_OnKeyPressHandler:function(n){if(!this.model.readOnly){if(this._raiseEvents("keyPress"),this._maskLength==0)return!0;var i=n.keyCode?n.keyCode:n.charCode,f=String.fromCharCode(i),u=this._seekNext(),r=t.browserInfo().name;if(this._validateChars(i,u)?(r=="mozilla"||r=="opera")&&(n.keyCode==35||n.keyCode==36||n.keyCode==37||n.keyCode==39)||(r=="mozilla"||r=="opera")&&n.ctrlKey&&(i==97||i==99||i==118||i==120)||this._writeBuffer(f,u):(r=="mozilla"||r=="opera")&&(n.keyCode==35||n.keyCode==36||n.keyCode==37||n.keyCode==39)||(r=="mozilla"||r=="opera")&&n.ctrlKey&&(i==97||i==99||i==118||i==120)||this._showAlert(),!this._keypressFlag&&i!=9)return this._keypressFlag=0,n.preventDefault(),!1;this._keypressFlag=0}},_OnKeyUpHandler:function(){this._maskLength==0&&this._raiseEvents("change");this._raiseEvents("keyUp")},_OnMouseOverHandler:function(){this._raiseEvents("mouseOver")},_OnMouseOutHandler:function(){this._raiseEvents("mouseOut")},_raiseEvents:function(n){var t,i=this.get_StrippedValue(),r=this.get_UnstrippedValue();if(this.model.value=r,n=="change"){if(this.previousValue!=this.model.value)this.previousValue=this.model.value;else return!1;this._hiddenInput.val(i)}this.model[n]&&(t={value:r,unmaskedValue:i},this._trigger(n,t))},_OnValueChange:function(){this._textbox.value==""&&this._maskModel!=""&&(this._textbox.value=this._maskModel);this._setValue(this._textbox.value)}});t.InputMode={Password:"password",Text:"text"}})(jQuery,Syncfusion)})