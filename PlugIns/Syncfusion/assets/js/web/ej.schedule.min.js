/*!
*  filename: ej.schedule.min.js
*  version : 12.2.0.36
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n,t,i){var r=function(){return this._monthCellsTemplate="<table class='e-table e-workcellstab' cellpadding='0px' cellspacing='0px'><tbody>{{for cellrows ~cols1=cols1}}<tr>{{for ~cols1}}<td class='e-monthcells'><div class='e-monthheader'><\/div><div class='e-appointwrapper'><\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._monthCellsTemplate},u=function(){return this._appTemplate="<div class='{{:appClass}} {{:appointCustomcss}}' id='Appointment_{{:id}}' role='presentation' style='{{if rtl == true}}right{{else}}left{{/if}}: {{:left}}; width: {{:appWidth}}; background: {{:appointData}}; height: {{:appHeight}}px; top: {{:top}}px;' >{{if appClass == 'e-appointment'}}<div class='e-tophandle'><\/div><div class='e-bottomhandle'><\/div>{{else}}<div class='e-lefthandle'><\/div><div class='e-righthandle'><\/div>{{/if}}{{if userAppTemplId == false}}<div class='e-appointinnertext'><div class='e-apptext'>{{:subject}} <\/div><div class='e-apptime'> {{:startTime}} - {{:endTime}}<\/div><\/div>{{else}}{{:userTemplate}}{{/if}}<\/div>",this._appTemplate},f=function(){return this._headerTemplate="{{for cols ~view=view ~colspan=colspan}}{{for ~index=#index}} {{if ~index == '0' }} {{if ~view == 'month'}} <td class='e-monthleftcells'> {{else}} <td class='e-settingsindent'> {{/if}} {{else}} <td class='e-headercells' colspan='{{:~colspan}}'> {{/if}} {{/for}}{{if #index == '0' && ~view !='month'}}{{else}}{{if ~view == 'day' }}<div class='e-dateheadercell e-dayheadercell'> <span class='e-headerdaydisplay'>{{:currentDay}}<\/span><\/div> {{else}} <div class='e-dateheadercell'> <span class='e-headerdaydisplay'>{{:currentDay}}<\/span><\/div>{{/if}} {{/if}}<\/td>{{/for}}<td class='e-emptytd'><\/td>",this._headerTemplate},e=function(){return this._resHeadTemplate="<td style='width: {{:leftWidth}}px;'><div class='e-headerresourcecells' style='height:27px;'><\/div><\/td>{{for resourceName}}{{for ~cols=colspan}}<td class='e-resourcecells' colspan='{{:~cols}}'>{{for ~resource=resourceNam}}<div align='center'>{{:~resource}}<\/div>{{/for}}<\/td>{{/for}}{{/for}}<td class='e-emptytd e-headerresourcecells'><\/td>",this._resHeadTemplate},o=function(){return this._alldayTemplate="{{for cols ~colspan=colspan}}{{for ~index=#index}} {{if ~index == '0'}} <td class='e-leftindent'> {{else}} <td class='e-alldaycells' colspan='{{:~colspan}}'> {{/if}} {{/for}}{{if #index == '0'}} <div class='e-schedulesettings e-textellipsis'> <\/div> {{else}}  {{/if}}<\/td>{{/for}}<td class='e-emptyalldaytd'><\/td>",this._alldayTemplate},s=function(){return this._workCellsTemplate="<table class='e-table e-workcellstab' height='100%' cellpadding='0px' cellspacing='0px'><tbody>{{for cellrows ~cols1=cols1}}<tr>{{for ~cols1 ~index=#index}}{{if (~index+1) % 2 == 0 }}<td class='e-workcells'>{{else}}<td class='e-workcells e-alternatecells'>{{/if}}<div class='e-appointwrapper'><\/div><\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._workCellsTemplate},h=function(){return this._timeCellsTemplate="<div class='e-scrolltimecells'><table class='e-table e-timecelltable' cellpadding='0px' cellspacing='0px'><tbody>{{for timerows ~cols1=cols1 ~view1=viewclass}}<tr>{{for ~name=time ~id=id ~view=~view1 }} {{if ~view == 0}}<td class='e-timecells'><div class='e-timecelldivs'>{{:~name.slice(0,2)}}<\/div><\/td> <td class='e-timecells' rowspan='1'>{{for ~cols1}}{{if (#index+1)%2 ==0}}<div class='e-ampmdisplay'><\/div>{{else}}<div id='{{:~id}}' class='e-ampmdisplay e-ampmstyle'>{{:~name.slice(3,5)}}<\/div> {{/if}}{{/for}} <\/td>{{else}}<td class='e-timecells' style='width:50px;'><div class='e-timecelldivs'><\/div><\/td>{{/if}}{{/for}}<\/tr>{{/for}}<\/tbody><\/table><\/div>",this._timeCellsTemplate};t.widget("ejSchedule","ej.Schedule",{_rootCSS:"e-schedule",element:null,validTags:["div"],model:null,defaults:{timezoneCollection:[{text:"UTC -12:00",value:"UTC -12:00"},{text:"UTC -11:00",value:"UTC -11:00"},{text:"UTC -10:00",value:"UTC -10:00"},{text:"UTC -09:00",value:"UTC -09:00"},{text:"UTC -08:00",value:"UTC -08:00"},{text:"UTC -07:00",value:"UTC -07:00"},{text:"UTC -06:00",value:"UTC -06:00"},{text:"UTC -05:00",value:"UTC -05:00"},{text:"UTC -04:30",value:"UTC -04:30"},{text:"UTC -04:00",value:"UTC -04:00"},{text:"UTC -03:30",value:"UTC -03:30"},{text:"UTC -03:00",value:"UTC -03:00"},{text:"UTC -02:00",value:"UTC -02:00"},{text:"UTC -01:00",value:"UTC -01:00"},{text:"UTC +00:00",value:"UTC +00:00"},{text:"UTC +01:00",value:"UTC +01:00"},{text:"UTC +02:00",value:"UTC +02:00"},{text:"UTC +03:00",value:"UTC +03:00"},{text:"UTC +03:30",value:"UTC +03:30"},{text:"UTC +04:00",value:"UTC +04:00"},{text:"UTC +04:30",value:"UTC +04:30"},{text:"UTC +05:00",value:"UTC +05:00"},{text:"UTC +05:30",value:"UTC +05:30"},{text:"UTC +05:45",value:"UTC +05:45"},{text:"UTC +06:00",value:"UTC +06:00"},{text:"UTC +06:30",value:"UTC +06:30"},{text:"UTC +07:00",value:"UTC +07:00"},{text:"UTC +08:00",value:"UTC +08:00"},{text:"UTC +09:00",value:"UTC +09:00"},{text:"UTC +09:30",value:"UTC +09:30"},{text:"UTC +10:00",value:"UTC +10:00"},{text:"UTC +11:00",value:"UTC +11:00"},{text:"UTC +12:00",value:"UTC +12:00"},{text:"UTC +13:00",value:"UTC +13:00"},],views:["Day","Week","WorkWeek","Month"],currentView:"week",timeMode:"12",timeZone:null,startHour:0,endHour:24,highlightBusinessHours:!0,showQuickWindow:!0,businessStartHour:9,businessEndHour:18,width:"800px",height:"800px",currentDate:new Date,cssClass:"",locale:"en-US",enableResize:!1,enableRTL:!1,enableAppointmentNavigation:!0,appointmentTemplateId:null,allowDragDrop:!0,enableAppointmentResize:!0,showCurrentTimeIndicator:!0,reminderSettings:{enable:!1,alertBefore:5},contextMenuSettings:{enable:!1,menuItems:{appointment:[{id:"open",text:"Open Appointment"},{id:"delete",text:"Delete Appointment"}],cells:[{id:"new",text:"New Appointment"},{id:"recurrence",text:"New Recurring Appointment"},{id:"today",text:"Today"},{id:"gotodate",text:"Go to date"},{id:"settings",text:"Settings"},{id:"view",text:"View",parentId:"settings"},{id:"timemode",text:"TimeMode",parentId:"settings"},{id:"view_Day",text:"Day",parentId:"view"},{id:"view_Week",text:"Week",parentId:"view"},{id:"view_Workweek",text:"Workweek",parentId:"view"},{id:"view_Month",text:"Month",parentId:"view"},{id:"timemode_Hour12",text:"12 Hours",parentId:"timemode"},{id:"timemode_Hour24",text:"24 Hours",parentId:"timemode"},{id:"businesshours",text:"Business Hours",parentId:"settings"}]}},group:null,resources:null,allowKeyboardNavigation:!0,appointmentSettings:{dataSource:null,query:null,tableName:null,id:null,subject:null,description:null,startTime:null,endTime:null,recurrence:null,recurrenceRule:null,allDay:null,resourceFields:null},cellClick:null,appointmentClick:null,cellDoubleClick:null,appointmentWindowOpen:null,appointmentSaved:null,appointmentEdited:null,appointmentDeleted:null,navigation:null,dragStart:null,dragOver:null,dragDrop:null,resizeStart:null,resizing:null,resizeStop:null,menuItemClick:null,beforeContextMenuOpen:null,reminder:null},observables:["appointmentSettings.dataSource","currentView","currentDate"],currentView:t.util.valueFunction("currentView"),currentDate:t.util.valueFunction("currentDate"),dataSource:t.util.valueFunction("appointmentSettings.dataSource"),_init:function(){this._trigger("load");this.element.addClass("e-schedule");this.model.cssClass!=null&&this.element.addClass(this.model.cssClass);this._initPrivateProperties();this._bindResourcesData();this._renderInitSchedule();this._wireEvents();this._bindAppointmentsData();t.isNullOrUndefined(this.model.appointmentSettings)||(this._dataManager=this.dataSource()instanceof t.DataManager?this.dataSource():this.dataSource()!=null?t.DataManager(this.dataSource()):null);this.model.enableRTL&&this.element.addClass("e-rtl");this.model.reminderSettings.enable&&(this._checkReminders(),this._reminderInterval=window.setInterval(n.proxy(this._checkReminders,this),6e4))},_setModel:function(i){var u=!1,r,e,o,f;for(r in i)switch(r){case"views":this.hTD.find("table.e-viewstable").remove();this.hTD.find("div.e-viewsdiv").append(this._renderViewNavigation(i[r]));break;case"currentView":this._navView=!0;this._viewChange(null,null,t.util.getVal(i[r]));break;case"currentDate":this._setCurrentDate=!0;this._navigateClick(null);break;case"timeMode":this.model.timeMode=i[r];this.currentView()!=="month"&&(e=this.currentView()=="month"?1:0,o=this.timeCellTemplate.render({timerows:this._getStartEndTime(),cols1:[1,2],viewclass:e}),this.$TimeCellTD.children().remove(),this.$TimeCellTD.append(o),this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove(),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this._renderAppointmentAll());break;case"timeZone":this.model.timeZone=i[r];this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment").remove();this._bindAppointmentsData();break;case"startHour":this.model.startHour=i[r];this._setNewStartEndHours();break;case"endHour":this.model.endHour=i[r];this._setNewStartEndHours();break;case"highlightBusinessHours":this.model.highlightBusinessHours=i[r];this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells")&&this.element.find(".e-monthcells").removeClass("e-monthcellhighlight");break;case"businessStartHour":this.model.businessStartHour=i[r];this.currentView()!=="month"?this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"):this.element.find(".e-monthcells").removeClass("e-monthcellhighlight");this._highlightBusinessHours();break;case"businessEndHour":this.model.businessEndHour=i[r];this.currentView()!=="month"?this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"):this.element.find(".e-monthcells").removeClass("e-monthcellhighlight");this._highlightBusinessHours();break;case"height":this.model.height=i[r];this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove();u=!0;break;case"width":this.model.width=i[r];this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove();u=!0;break;case"cssClass":this.element.removeClass(this.model.cssClass).addClass(i[r]);break;case"locale":this.model.locale=i[r];f=this.model;this.element.ejSchedule("destroy").ejSchedule(f);break;case"enableResize":this.model.enableResize=i[r];this.model.enableResize&&(this._isDevice()?this._on(n(window),"orientationchange",this._scheduleResize):this._on(n(window),"resize",this._scheduleResize),this._wireResizeEvents());break;case"showCurrentTimeIndicator":this.model.showCurrentTimeIndicator=i[r];this._highlightCurrentTime(this.model.showCurrentTimeIndicator);this.model.showCurrentTimeIndicator||(this.currentView()!=="month"?n(".e-highlightcurrenttimeline").remove():n(this.element.find(".e-monthcells")).removeClass("e-monthcurrenttime"));break;case"enableRTL":i[r]?this.element.addClass("e-rtl"):this.element.removeClass("e-rtl");this.model.enableRTL=i[r];f=this.model;this.element.ejSchedule("destroy").ejSchedule(f);break;case"appointmentTemplateId":this.model.appointmentTemplateId=i[r];this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment").remove();this._renderAppointmentAll();break;case"allowKeyboardNavigation":this.model.allowKeyboardNavigation=i[r];this.model.allowKeyboardNavigation?(this._on(this.element,"keydown",n.proxy(this._onKeyDown,this)),this._on(n(document),"keydown",n.proxy(this._documentOnKeyDown,this))):(this._off(this.element,"keydown"),this._off(n(document),"keydown"));break;case"appointmentSettings":n.extend(this.model.appointmentSettings,i[r]);this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-appsoverflow").remove();this._bindAppointmentsData();break;case"contextMenuSettings":n.extend(this.model.contextMenuSettings,i[r]);this.model.contextMenuSettings.enable&&t.isNullOrUndefined(this._contextMenu)&&this._showContextMenu(this.model.contextMenuSettings.enable);break;case"reminderSettings":i[r].enable?this._checkReminders()&&(this._reminderInterval=window.setInterval(n.proxy(this._checkReminders,this),6e4)):window.clearInterval(this._reminderInterval);break;case"enableAppointmentNavigation":this.model.enableAppointmentNavigation=i[r];this.model.enableAppointmentNavigation?(this._nextPrevAppointment(this.model.enableAppointmentNavigation),this._renderAppointmentAll()):this.element.find(".e-prev,.e-next").remove();break;case"resources":n.extend(this.model.resources,i[r]);u=!0;break;case"group":t.isNullOrUndefined(this.model.resources)||(n.extend(this.model.group,i[r]),u=!0)}u&&(this.element.empty(),this._renderInitSchedule(),this._renderAppointmentAll())},_touchSchedule:function(n){var t;switch(n.type){case"swipeleft":t={currentTarget:this.element.find(".e-navigatenext")};this._navigateClick(t);break;case"swiperight":t={currentTarget:this.element.find(".e-navigateprevious")};this._navigateClick(t)}},_initPrivateProperties:function(){this._appId=0;this._parentId=0;this._currentAction="";this._reminderClose=!1;this._currentAppointmentData=null;this._processed=[];this._dateRender=[];this._rRule={};this._dayNames=["SU","MO","TU","WE","TH","FR","SA"];var n=Globalize.culture(this.model.locale);this._dayShortNames=n.calendar.days.namesAbbr;this._dayFullNames=n.calendar.days.names;this._monthNames=n.calendar.months.names;this._pattern=n.calendar.patterns;this._navView=!1;this._editKey=!1;this._cellClick=!1;this._gotoDate=!0;this._recurChecked=!1;this._currentRowIndex=0;this._currentColIndex=0;this._setCurrentDate=!1;this._browserInfo=t.browserInfo();this._leftResizing=!1;this._rightResizing=!1;this._topResizing=!1;this._bottomResizing=!1},_destroy:function(){this._destorySubControls(n("#"+this._id+"_AddEditForm"));this._destorySubControls(n("#"+this._id+"_RecurForm"));this.element.find("#"+this._id+"_navigator").ejDatePicker("destroy");window.clearInterval(this._intervalID);n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"AppointmentQuickWindow_wrapper,#"+this._id+"AppDetailsWindow_wrapper").remove();n("#"+this._id+"_WorkCells_Template,#"+this._id+"_MonthCells_Template,#"+this._id+"_TimeCells_Template,#"+this._id+"_HeaderDate_Template,#"+this._id+"_Appointment_Template,#"+this._id+"_AlldayCells_Template").remove();this.element.empty().removeClass("e-schedule")},_destorySubControls:function(t){$formEle=t.find(".e-timepicker,.e-datepicker,.e-dropdownlist,.e-autocomplete");for(var i=0;i<$formEle.length;i++)$element=n($formEle[i]),$element.hasClass("e-timepicker")?$element.ejTimePicker("destroy"):$element.hasClass("e-datepicker")?$element.ejDatePicker("destroy"):$element.hasClass("e-dropdownlist")?$element.ejDropDownList("destroy"):$element.hasClass("e-autocomplete")&&$element.ejAutocomplete("destroy")},_wireEvents:function(){this._on((this.element,n(window)),"mousedown",n.proxy(this._onScheduleMouseDown,this));this._on(this.element,"click","div.e-navigateprevious,div.e-navigatenext",n.proxy(this._navigateClick,this));this._on(this.element,"click",".e-commonviewbutton",n.proxy(this._viewChange,this));this._on(this.element,"click",".e-datedisplay",n.proxy(this._viewCalendar,this));this._on(this.element,"click","div.e-appsoverflow",n.proxy(this._appOverflowClick,this));this._on(this.element,"click",".e-prev.enable,.e-next.enable",n.proxy(this._nextPrev,this));this._on(this.element,"click",".e-headercells,.e-timecells,td.e-monthcells div.e-monthheader",n.proxy(this._navigateView,this));this._on(this.element,"mouseover","td.e-workcells,td.e-monthcells",n.proxy(this._onCellMouseOver,this));this._on(this.element,"mouseout","td.e-workcells,td.e-monthcells",n.proxy(this._onCellMouseOver,this));this._on(this.element,n.isFunction(n.fn.tap)?"tap":"click",".e-workcells,.e-alldaycells,.e-alldayappointment,.e-monthcells,div.e-monthappointment",n.proxy(this._cellSelection,this));this._on(this.element,"dblclick",".e-workcells,.e-alldaycells,.e-alldayappointment,div.e-monthappointment,.e-monthcells",n.proxy(this._appointmentWindow,this));this._on(this.element,"mouseover",".e-appointment,.e-alldayappointment,.e-monthappointment",n.proxy(this._onAppointMouseOver,this));this._on(this.element,"mouseout",".e-appointment,.e-alldayappointment,.e-monthappointment",n.proxy(this._onAppointMouseOver,this));this.model.allowKeyboardNavigation&&(this._on(this.element,"keydown",n.proxy(this._onKeyDown,this)),this._on(n(document),"keydown",n.proxy(this._documentOnKeyDown,this)));this._on(this.element,"swipeleft swiperight",".e-contentarearow .e-workcellstab",n.proxy(this._touchSchedule,this));this.model.enableResize&&(this._isDevice()?this._on(n(window),"orientationchange",this._scheduleResize):this._on(n(window),"resize",this._scheduleResize))},_onScheduleMouseDown:function(t){var i=n(t.target),r=i.hasClass("e-appointment,e-alldayappointment,e-monthappointment")?i:i.parents(".e-appointment,.e-alldayappointment,.e-monthappointment");i.hasClass("e-workcells")||r.hasClass("e-appointment")||r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment")||i.hasClass("e-alldaycells")||i.hasClass("e-monthcells")||i.parents(".e-scheduledialog").hasClass("e-scheduledialog")||(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),this.element.find(".e-workcells").removeClass("e-mousehover"))},_onCellMouseOver:function(t){var i=n(t.currentTarget);t.type==="mouseover"?(this.element.find(".e-mousehover").removeClass("e-mousehover"),(i.hasClass("e-workcells")||i.hasClass("e-monthcells"))&&i.addClass("e-mousehover")):t.type==="mouseout"&&(i.hasClass("e-workcells")||i.hasClass("e-monthcells"))&&i.removeClass("e-mousehover")},_onAppointMouseOver:function(t){if(this.model.enableAppointmentResize){var i=n(t.target).hasClass("e-appointment,e-alldayappointment,e-monthappointment")?n(t.target):n(t.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment");i.hasClass("e-appointment")?t.type==="mouseover"?(i.find(".e-bottomhandle,.e-tophandle").addClass("e-icon e-nsexpand"),i.find(".e-bottomhandle").addClass("e-appointresizer-bottom"),i.find(".e-tophandle").addClass("e-appointresizer-top")):t.type==="mouseout"&&i.find(".e-bottomhandle,.e-tophandle").removeClass("e-icon e-nsexpand"):t.type==="mouseover"?(i.find(".e-lefthandle,.e-righthandle").addClass("e-icon e-ewexpand"),i.find(".e-lefthandle").addClass("e-appointresizer-left"),i.find(".e-righthandle").addClass("e-appointresizer-right")):t.type==="mouseout"&&i.find(".e-lefthandle,.e-righthandle").removeClass("e-icon e-ewexpand")}},_cellSelection:function(i){var l,r,e,k,a,v,d,g,nt,f,tt,h,u,s,ut,ft,et,ot;if(this.element.find("e.workcells,e.alldaycells,.e-monthcells").removeClass("e-mousehover"),this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell"),this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),l=Globalize.culture(this.model.locale),r=t.isNullOrUndefined(i.target)?n(i):n(i.target),r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells")){if(this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close"),this._cellIndex=r.hasClass("e-workcells")?r.index():r.hasClass("e-alldaycells")?r.index()-1:7-((parseInt(r.index()/7)+1)*7-r.index())+r.parent().index()*7,e=new Date(this.dateRender[this._cellIndex]),r.hasClass("e-workcells")?(k=this.model.startHour+r.parent().index()/2,a=k.toString().split("."),this.cur_StartTime=new Date(e).setHours(parseInt(a[0]),parseInt(a[1])==5?30:00),this.cur_EndTime=new Date(new Date(this.cur_StartTime).setMinutes(new Date(this.cur_StartTime).getMinutes()+30)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!1})):(this.cur_StartTime=new Date(new Date(e).setHours(0,0)),this.cur_EndTime=new Date(new Date(e).setHours(23,59)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0})),this.model.showQuickWindow&&(this._quickAppointWindow.find("#"+this._id+"_quickAppwindow").css("display","block"),this._quickAppointWindow.find(".e-quickstartend").html(l.calendar.days.names[new Date(e).getDay()]+", "+Globalize.format(new Date(e),"MMMM")+" "+new Date(e).getDate()+", "+Globalize.format(new Date(this.cur_StartTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")+" - "+Globalize.format(new Date(this.cur_EndTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")),v=n(i).hasClass("e-workcells")||n(i).hasClass("e-alldaycells")||n(i).hasClass("e-monthcells")?n(i):n(i.target),i.type!="beforeContextMenuOpen"?this._quickAppointWindow.ejDialog("open"):"",this._quickAppointWindow.find(".subject").val(""),d=this.currentView()==="day"?this.cellwidth/2-this.element.find(".e-leftindent").width():v.offset().left-this.element.find(".e-scrolltimecells").width(),g=v.offset().top-this._quickAppointWindow.height()-10,this._quickAppointWindow.ejDialog({position:{X:d,Y:g}}),this._getResourceDetails(r)),nt={startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,target:i},this._trigger("cellClick",nt))return!1;r.addClass("e-selectedCell").attr("tabIndex",0).focus();this.model.showQuickWindow&&this._quickAppointWindow.find(".subject").focus();this._cellClick=!0;this._appointmentAddWindow.ejDialog({title:this._getLocalizedLabels("CreateAppointmentTitle")})}else{if(this._cellClick=!1,this._quickAppDetailsWindow&&this._quickAppDetailsWindow.find("#"+this._id+"_quickAppDetailswindow").css("display","block"),this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close"),f=r.hasClass("e-appointment")||r.hasClass("e-monthappointment")||r.hasClass("e-alldayappointment")?r:r.parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),f.length<=0)return!1;if(f.attr("tabIndex",0).focus(),f.addClass("e-selectedAppointment"),this._appId=parseInt(f[0].id.split("_")[1]),tt=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),h=new t.DataManager(this._processed).executeLocal(tt),this._quickAppDetailsWindow&&this._quickAppDetailsWindow.find(".e-quicksubject").html(h[0][this.model.appointmentSettings.subject]),u=n.extend({},h[0]),this.model.timeZone!=null){var it=this.model.timeZone.split(" ")[1].split(":"),st=parseInt(it[0]),ht=parseInt(it[1]);dateMinutes=(new Date).getTimezoneOffset();var c=this._minToHour(dateMinutes+(st*60+ht)),y=new Date(u.StartTime),p=new Date(u.EndTime);u.StartTime=new Date(y.setHours(y.getHours()+c.h,y.getMinutes()+c.m));u.EndTime=new Date(p.setHours(p.getHours()+c.h,p.getMinutes()+c.m))}var ct=this.model.timeMode=="12"?Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),this._pattern.t):Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"HH:mm"),lt=this.model.timeMode=="12"?Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),this._pattern.t):Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),"HH:mm"),w=(new Date).getTime()-new Date(u[this.model.appointmentSettings.startTime]).getTime(),b=6e4,at=60*b,vt=24*at,rt=Math.abs(new Date-new Date(u[this.model.appointmentSettings.startTime])),o=Math.floor(rt/36e5);if(o=o<=9?"0"+o:o,s=new Date(rt).getUTCMinutes(),s=s<=9?"0"+s:s,ut=Math.ceil(w/b-1)<0&&o<24?this._getLocalizedLabels("EventBeginsin")+" "+o+" "+this._getLocalizedLabels("Hours")+" "+s+" "+this._getLocalizedLabels("Minutes"):Math.ceil(w/b-1)<0&&o>=24?this._getLocalizedLabels("EventBeginsin")+" "+Math.abs(Math.ceil(w/vt))+" "+this._getLocalizedLabels("Days"):this._getLocalizedLabels("Overdue"),this.model.showQuickWindow){if(this._quickAppDetailsWindow.find(".e-rightfields").html(ut),this._quickAppDetailsWindow.find(".e-quickstartendtime").html(l.calendar.days.names[new Date(u[this.model.appointmentSettings.startTime]).getDay()]+", "+Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"MMMM")+" "+new Date(u[this.model.appointmentSettings.startTime]).getDate()+", "+ct+" - "+lt),u[this.model.appointmentSettings.recurrence]==1)this._quickAppDetailsWindow.find(".e-editseries").removeClass("e-disable").on("click",n.proxy(this._editClick,this));else this._quickAppDetailsWindow.find(".e-editseries").addClass("e-disable").off("click");i.type!="beforeContextMenuOpen"?this._quickAppDetailsWindow.ejDialog("open"):"";ft=this.currentView()==="day"?n(f).width()/2:n(f).offset().left-this.element.find(".e-scrolltimecells").width();et=this.currentView()==="month"?n(f).offset().top-this._quickAppDetailsWindow.height()-10:n(f).parent().offset().top-this._quickAppDetailsWindow.height()-10;this._quickAppDetailsWindow.ejDialog({position:{X:ft,Y:et}});this._quickAppDetailsWindow.focus()}if(ot={appointment:h[0]},this._trigger("appointmentClick",ot))return!1;this._appointmentAddWindow.ejDialog({title:this._getLocalizedLabels("Editevent")})}n(r).hasClass("e-monthcells")||this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")},_checkReminders:function(){var n,t;for(this._todayAppointments=[],n=0;n<this._processed.length;n++)Globalize.format(new Date(this._processed[n][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date,this._pattern.d)&&this._todayAppointments.push(this._processed[n]);t=this;jQuery.each(this._todayAppointments,function(n,i){var r=t.model.reminderSettings.alertBefore,e=new Date(i[t.model.appointmentSettings.startTime]),f,u;r!=-1&&r!=null&&(f=(new Date).getTime(),u=(f-new Date(e).getTime())/6e4,Math.round(u)==r*-1&&u<=0&&t._trigger("reminder",{reminderAppointment:i}))})},_showContextMenu:function(i){var r=!1,u=this.model.contextMenuSettings.menuItems.cells,f;if(i&&(this._contextMenu=t.buildTag("ul#"+this._id+"contextMenu"),this.element.append(this._contextMenu),this._contextMenu.ejMenu({fields:{id:"id",text:"text",parentId:"parentId"},menuType:t.MenuType.ContextMenu,openOnClick:!1,contextMenuTargetID:this._id,width:"auto",click:n.proxy(this._onMenuSelect,this),beforeOpen:n.proxy(this._beforeopen,this)}),this._gotoDate&&this.model.contextMenuSettings.enable)){for(f in u)if(u[f].id=="gotodate"){r=!0;break}r&&(this._renderGotoWindow(),this._gotoDate=!1)}},_beforeopen:function(t){var i,u,r,f;if(this.model.contextMenuSettings.enable){if(this._trigger("beforeContextMenuOpen",{events:t}))return!1;i=n(t.target);r=this._contextMenu.data("ejMenu");t.cancel=i.hasClass("e-workcells")||i.hasClass("e-alldaycells")||i.hasClass("e-appointinnertext")||i.hasClass("e-monthcells")||i.hasClass("e-apptime")||i.hasClass("e-apptext")?!1:!0;u=i.hasClass("e-appointinnertext")||i.hasClass("e-apptime")||i.hasClass("e-apptext")?!1:!0;u?r.option("fields.dataSource",this.model.contextMenuSettings.menuItems.cells):r.option("fields.dataSource",this.model.contextMenuSettings.menuItems.appointment);this._cellSelection(t);this._target=t;this._quickAppointWindow.ejDialog("close");this._quickAppDetailsWindow.ejDialog("close")}else return f=this._contextMenu.data("ejMenu"),f.hide(),!1},_onMenuSelect:function(t){var i,r,u;if(this._trigger("menuItemClick",{events:t}))return!1;i=t.events.ID.split("_");switch(i[0]){case"new":this._appointmentWindow(this._target);break;case"recurrence":this._appointmentWindow(this._target);this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0});this._repeat(t={isChecked:!0});break;case"open":this._appointmentWindow(this._target);break;case"today":this._navigateClick(this.currentDate(new Date));break;case"view":this.currentView(i[1].toLowerCase());this._renderCurrentView();break;case"timemode":this.model.timeMode=i[1]=="Hour12"?"12":"24";this.currentView()!=="month"&&(r=this.currentView()=="month"?1:0,u=this.timeCellTemplate.render({timerows:this._getStartEndTime(),cols1:[1,2],viewclass:r}),this.$TimeCellTD.children().remove(),this.$TimeCellTD.append(u),this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove(),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this._renderAppointmentAll());break;case"businesshours":this.model.highlightBusinessHours=this.model.highlightBusinessHours?!1:!0;this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells")&&this.element.find(".e-monthcells").removeClass("e-monthcellhighlight");break;case"gotodate":this._gotoWindow.ejDialog("open");break;case"delete":this._deleteAppoint()}},_gotoOk:function(t){if(n(t.currentTarget).hasClass("e-gotoOk")){var i=this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker("option","value"),r=this._gotoWindow.find("#"+this._id+"show").ejDropDownList("option","itemValue");this.currentDate(new Date(i));this.currentView(r.toLowerCase());this._renderCurrentView()}this._gotoCancel()},_gotoCancel:function(){this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker({value:new Date});this._gotoWindow.find("#"+this._id+"show").ejDropDownList({value:"Day"});this._gotoWindow.ejDialog("close")},_renderGoto:function(){this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker({enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,cssClass:this.model.cssClass});this._gotoWindow.find("#"+this._id+"show").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:[{text:this._getLocalizedLabels("Day"),value:"day"},{text:this._getLocalizedLabels("Week"),value:"week"},{text:this._getLocalizedLabels("WorkWeek"),value:"workweek"},{text:this._getLocalizedLabels("Month"),value:"month"}],width:"100%",selectedItemIndex:0,cssClass:this.model.cssClass});this._gotoWindow.find(".e-gotobutton").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"60px",cssClass:this.model.cssClass})},_renderGotoWindow:function(){this._gotoWindow=t.buildTag("div.e-gotodialog#"+this._id+"gotoWindow");var i="<div><table width='100%' cellpadding='5'><tbody><tr><td>"+this._getLocalizedLabels("Date")+":<\/td><td><input id='"+this._id+"gotodate' type='text' value='' /><\/td><\/tr><tr><td>"+this._getLocalizedLabels("Showin")+":<\/td><td><input type='text' id='"+this._id+"show' /><\/td><\/tr><\/tbody><\/table>";i+="<div class='e-floatright'><table><tr><td><div><button id='"+this._id+"gotook' class='e-gotobutton e-gotoOk'>"+this._getLocalizedLabels("Ok")+"<\/button><\/div><\/td><td><div><button id='"+this._id+"gotocancel' class='e-gotobutton e-gotoCancel'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div><\/div>";this._on(this._gotoWindow,"click",".e-gotobutton",n.proxy(this._gotoOk,this));this._gotoWindow.append(i);this.element.append(this._gotoWindow);this._renderGoto();this._gotoWindow.ejDialog({width:300,cssClass:this.model.cssClass,showOnInit:!1,enableRTL:this.model.enableRTL,enableModal:!0,title:this._getLocalizedLabels("Gotodate"),content:"#"+this._id,enableResize:!1,allowKeyboardNavigation:!1,close:n.proxy(this._gotoCancel,this)});n("#"+this._id+"gotoWindow_wrapper").addClass("e-scheduledialog").find(".e-titlebar").addClass("e-dialogheader")},_highlightCurrentTime:function(i){var e,f,c,l,r;if(i){for(e=!1,f=0,r=0;r<this._dateRender.length;r++)Globalize.format(new Date(this._dateRender[r]),this._pattern.d)===Globalize.format(new Date,this._pattern.d)&&(e=!0,f=this.model.enableRTL==!0?this._dateRender.length-1-r:r);if(this.currentView()!=="month")if(e){var u=this,s=this.currentView()==="week"?7:this.currentView()==="workweek"?5:1,o=this.element.find(".e-draggableworkarea")[0].offsetWidth/(s*this.res1.length);if((new Date).getHours()>=u.model.startHour&&(new Date).getHours()<=u.model.endHour)for(r=0;r<this.res1.length;r++)this.element.find(".e-draggableworkarea").append('<div id="'+this._id+r+'_HighlightCurrentTimeline" class="e-highlightcurrenttimeline"><\/div>'),n("#"+this._id+r+"_HighlightCurrentTimeline").append('<div class="e-currenttime"><\/div>').append(t.buildTag("div.e-icon e-timeidicatorcircle e-lefttimeindicator")).append(t.buildTag("div.e-icon e-timeidicatorcircle e-righttimeindicator")),n("#"+this._id+r+"_HighlightCurrentTimeline").css("width",o+"px").css("left",(f+s*r)*o+"px"),n("#"+this._id+r+"_HighlightCurrentTimeline").find(".e-righttimeindicator").css("margin-left",o-3+"px");function h(){var i=new Date,r,f,t;if(i.setMinutes(i.getMinutes()),i.getHours()>=u.model.startHour&&i.getHours()<=u.model.endHour){for(r=((i.getHours()-u.model.startHour)*60+i.getMinutes())*(u.element.find(".e-workcells").height()+1)/30,t=0;t<u.res1.length;t++)n("#"+u._id+t+"_HighlightCurrentTimeline").css("top",r-1);for(f=u.model.timeMode=="12"?Globalize.format(new Date,"hh:mm tt"):Globalize.format(new Date,"HH:mm"),t=0;t<u.res1.length;t++)n("#"+u._id+t+"_HighlightCurrentTimeline").find(".e-currenttime").html(f),u.model.timeMode=="12"&&n("#"+u._id+t+"_HighlightCurrentTimeline").find(".e-currenttime").addClass("e-timewidth")}}h();this._intervalID=window.setInterval(h,6e4)}else clearInterval(this._intervalID),n(".e-highlightcurrenttimeline").remove();else if(e)for(c=Math.ceil((f+1)/7),this.model.group||(this.res1=["0"]),r=0;r<this.res1.length;r++)l=r*7+(new Date(this._dateRender[f]).getDay()+1)+(c-1)*this.res1.length*7,n(this.element.find(".e-monthcells")[Math.floor(l)-1]).addClass("e-monthcurrenttime");else this.element.find(".e-monthcells").removeClass("e-monthcurrenttime")}},_getPreviousNextAppointment:function(){var i=this._dateRender,t=this._processed,n;for(this._previousList=[],this._nextList=[],this.appointment,n=0;n<t.length;n++)new Date(t[n][this.model.appointmentSettings.startTime])<new Date(i[0])&&new Date(t[n][this.model.appointmentSettings.endTime])<new Date(i[0])?this._previousList.push(t[n]):new Date(t[n][this.model.appointmentSettings.startTime])>new Date(i[i.length-1])&&new Date(t[n][this.model.appointmentSettings.endTime])>new Date(i[i.length-1])&&this._nextList.push(t[n]);this.appointment={previous:this._previousList,next:this._nextList}},_nextPrevAppointment:function(n){var i;if(n){i=this.element.find("#"+this._id+"_scroller");this.height=i.height();this.width=i.width();var o=this.element.find(".e-vscroll").width(),s=this.element.find(".e-scrolltimecells").width(),r=this.height/2-75,u,f=t.buildTag("div.e-prev enable",this._getLocalizedLabels("PreviousAppointment"),{},{}),e=t.buildTag("div.e-next enable",this._getLocalizedLabels("NextAppointment"),{},{});u=this.currentView()!="month"?-4:-10;this.model.enableRTL?(e.css("top",r+40+"px").css("transform","rotate(90deg)").css("left",u-(this.currentView()!="month"?39:51)+"px"),f.css("top",r+40+"px").css("transform","rotate(-90deg)").css("left",this.width-s-(this.currentView()!="month"?31:41)+"px")):(f.css("top",r+40+"px").css("transform","rotate(90deg)").css("left",u+"px"),e.css("top",r+40+"px").css("transform","rotate(-90deg)").css("left",this.width-o-35+"px"));i.append(f).append(e)}},_nextPrev:function(t){n(t.currentTarget).hasClass("e-prev")?(this.appointment.previous.sort(function(n,t){return new Date(t.StartTime)-new Date(n.StartTime)}),this._navigateClick(this.currentDate(new Date(this.appointment.previous[0].StartTime)))):n(t.currentTarget).hasClass("e-next")&&(this.appointment.next.sort(function(n,t){return new Date(n.StartTime)-new Date(t.StartTime)}),this._navigateClick(this.currentDate(new Date(this.appointment.next[0].StartTime))))},_nextPrevButton:function(n){n.length!=0?this.element.find(".e-prev,.e-next").css("display","none"):(this._getPreviousNextAppointment(),this.element.find(".e-prev,.e-next").css("display","block"),this.appointment.previous.length==0?this.element.find(".e-prev").removeClass("enable").css("opacity","0.4"):this.element.find(".e-prev").addClass("enable").css("opacity","1"),this.appointment.next.length==0?this.element.find(".e-next").removeClass("enable").css("opacity","0.4"):this.element.find(".e-next").addClass("enable").css("opacity","1"))},_navigateView:function(t){var r,e=this.currentView(),i=n(t.target),f,u;if(this.currentView()==="month"){if(i.hasClass("e-monthheader")){if(this.model.views.indexOf("Day")==-1)return!1;this.currentDate(this._getRenderDates()[i.parent().parent().index()*7+i.parent().index()]);r="day"}else if(i.hasClass("e-timecells")){if(f=i.hasClass("e-timecells")?i:i.parent(),this.model.views.indexOf("Week")==-1)return!1;this.currentDate(this._getRenderDates()[f.parent().index()*7]);r="week"}}else if(this.currentView()==="week"||this.currentView()==="workweek"){if(u=i.hasClass("e-headercells")?i:i.parent().hasClass("e-headercells")?i.parent():i.parent().parent(),this.model.views.indexOf("Day")==-1||!u.hasClass("e-headercells"))return!1;this.currentDate(this._getRenderDates()[u.index()-1]);r="day"}this._navView=!0;this._viewChange(t,e,r)},_appOverflowClick:function(t){if(this.model.views.indexOf("Day")!==-1){var i=n(t.target)[0].id.toString().split("_");this.currentDate(new Date(i[3],i[1]-1,i[2]));this._navView=!0;this._viewChange(t,this.currentView(),"day")}else return!1},_viewCalendar:function(){var i=this.element.find("#"+this._id+"_navigator").data("ejDatePicker"),t;i&&(i.show(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}),t=this.element.position(),this.model.enableRTL?n("div.e-datepicker").css("top",t.top+47+"px").css("left",t.left+this.element.width()-280+"px"):n("div.e-datepicker").css("top",t.top+47+"px").css("left",t.left+55+"px"));this.element.find(".e-workcells").removeClass("e-selectedCell");this.element.find(".e-workcells").removeClass("e-mousehover");this.element.find(".e-appointment,.e-alldayappointment,.e-monthappointment").removeClass("e-selectedAppointment")},_viewChange:function(t,i,r){var u=!0,f;return i===r&&(i||r)||(this._navView?this.currentView(r):(u=this.currentView()==t.currentTarget.className.split("e-")[2].split(" ")[0]?!1:!0,this.currentView(n(t.currentTarget).hasClass("e-activeview")?this.currentView():t.currentTarget.className.split("e-")[2].split(" ")[0])),u&&this._renderCurrentView()),f={prevView:i,currentView:this.currentView(),Date:new Date(this.currentDate()),target:t,type:"Scheduleview"},this._trigger("navigation",f)?!1:void 0},_renderCurrentView:function(){this.element.find(".e-commonviewbutton").blur();this.element.find(".e-commonviewbutton").removeClass("e-activeview");this.element.find(".e-headerdaydisplay,.e-datedisplay,.e-headrealldaytable").children().remove();this.wTR.children().remove();this.aTR.children().remove();this._getRenderDates();this.element.find(".e-"+this.currentView()).addClass("e-activeview").attr("tabIndex",0).focus();this._renderHeaderAllDayTemplate();this._renderContentAreaTemplate();this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay"));this._renderScroller();this._renderHeaderDays();this.element.find(".e-ampmstyle").height(this.element.find(".e-workcells").height());this._dataProcessing(this._currentAppointmentData);this._renderAppointmentAll();this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");this._highlightCurrentTime(this.model.showCurrentTimeIndicator);this._navView=!1},_renderHeaderDays:function(){var f,i,r,e,u,o,n;for(this.dateRender=[],f=this._getRenderDates(),this.res1=t.isNullOrUndefined(this.model.group)?[0]:this.res1,n=0;n<this.res1.length;n++)for(i=0;i<f.length;i++)this.dateRender.push(new Date(f[i]));if(r=Globalize.culture(this.model.locale),e=this._getCurrentDateHeaderValue(),this.element.find("div.e-datedisplay")[0].innerHTML=e,this.currentView()!=="month"){for(n=0;n<this.dateRender.length;n++)u=this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?r.calendar.days.names[new Date(this.dateRender[n]).getDay()]:r.calendar.days.names[new Date(this.dateRender[n]).getDay()].slice(0,3):r.calendar.days.names[new Date(this.dateRender[n]).getDay()].slice(0,3),o=this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?u+" "+Globalize.format(new Date(this.dateRender[n]),"dd MMMM yyyy"):u+" "+Globalize.format(new Date(this.dateRender[n]),"dd MMM yy"):u+" "+new Date(this.dateRender[n]).getDate(),this.element.find(".e-headerdaydisplay")[n].innerHTML=o;this.element.find(".e-alldaycells").css("height","27px");this.element.find(".e-headercells").addClass("e-dateheaderselect")}else this._renderMonthTimeCells()},_renderMonthTimeCells:function(){for(var r,o=0,u=this._dateRender,e=0,f=t.isNullOrUndefined(this.model.group)?7:this.res1.length*7,i=0;i<u.length;i++){for(r=e;r<f;r=r+7)n(this.element.find("div.e-monthheader"))[r].innerHTML=Globalize.format(u[i],"dd").toString();e++;(i+1)%7==0&&(e=f,f=f+(t.isNullOrUndefined(this.model.group)?1:this.res1.length)*7,start=Globalize.format(u[i-6],"MMM dd"),end=Globalize.format(u[i],"MMM dd"),n(this.element.find(".e-timecelldivs"))[o].innerHTML=start+" - "+end,o++);new Date(u[i]).getMonth()!==new Date(this.currentDate()).getMonth()?n(this.element.find("div.e-monthheader")[i]).addClass("e-monthdateshighlight"):n(this.element.find("div.e-monthheader")[i]).removeClass("e-monthdateshighlight")}this.element.find(".e-timecells").addClass("e-dateheaderselect").height(this.element.find(".e-monthcells").height());r!=6&&this.element.find(".e-timecells").addClass("e-timecellpadding")},_navigateClick:function(t){var u,i,r;if(t!=null&&!this._setCurrentDate&&(i=new Date(this.currentDate()),r=this.currentView()==="day"?1:7,n(t.currentTarget).hasClass("e-navigateprevious")?(this.currentDate(this.currentView()==="month"?new Date(i.setMonth(new Date(this.currentDate()).getMonth()-1)):new Date(i.setDate(new Date(this.currentDate()).getDate()-r))),this.element.find(".e-navigateprevious").attr("tabIndex",0).focus()):n(t.currentTarget).hasClass("e-navigatenext")&&(this.currentDate(this.currentView()==="month"?new Date(i.setMonth(new Date(this.currentDate()).getMonth()+1)):new Date(i.setDate(new Date(this.currentDate()).getDate()+r))),this.element.find(".e-navigatenext").attr("tabIndex",0).focus()),(n(t.currentTarget).hasClass("e-navigateprevious")||n(t.currentTarget).hasClass("e-navigatenext"))&&(u={prevDate:new Date(i.getDate()-1),currentDate:i,target:t,type:"navigatedate"}),this._trigger("navigation",u)))return!1;this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell");this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment");this.element.find(".e-appsoverflow").remove();this.element.find(".e-monthcells").removeClass("e-monthcurrenttime");this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove();this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");this.currentView()==="month"?this._renderCurrentView():(this._renderHeaderDays(),this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll(),this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator));this._setCurrentDate=!1},_isDevice:function(){return/mobile|tablet|android|kindle/i.test(navigator.userAgent.toLowerCase())},_scheduleResize:function(){if(this.model.showQuickWindow&&(this._quickAppDetailsWindow.ejDialog("close")||this._quickAppointWindow.ejDialog("close")),this.model.enableResize){var t=this;this.resizeTO&&clearTimeout(this.resizeTO);this.resizeTO=setTimeout(function(){if(t._isDevice())t._scHeight=t.element.height(),t._scWidth=t.element.width();else{var i=n(n(t.element.find("div")[0]).parent()).width()+20,r=n(n(t.element.find("div")[0]).parent()).height();i>n(this).width()?t._scWidth=n(this).width()-20:i<n(this).width()&&(t._scWidth=t.model.width);r>n(this).height()?t._scHeight=n(this).height()-20:r<n(this).height()&&(t._scHeight=t.model.height)}t.element.find(".e-highlightcurrenttimeline").remove();t.element.children().remove();t._renderInitSchedule();t._renderAppointmentAll()},500)}},_renderTemplates:function(){this.workcellTemp=n.templates(this._createTemplate(s(),"_WorkCells"));this.monthcellTemp=n.templates(this._createTemplate(r(),"_MonthCells"));this.timeCellTemplate=n.templates(this._createTemplate(h(),"_TimeCells"));this.headTemplate=n.templates(this._createTemplate(f(),"_HeaderDate"));this.appTemplate=n.templates(this._createTemplate(u(),"_Appointment"));this.alldayTemp=n.templates(this._createTemplate(o(),"_AlldayCells"));this.resourceHeadTemplate=n.templates(this._createTemplate(e(),"_ResourceHeader"));t.isNullOrUndefined(this.model.resources)||(this.resourceTemplate="<div class='e-resourcediv' style='height:15px; margin-right:5px; margin-top:3px; float:left; width:15px; background-color: ${color}'><\/div> <div>${text}<\/div>")},_setNewStartEndHours:function(){this.currentView()!=="month"&&(this.wTR.children().remove(),this._renderContentAreaTemplate(),this._renderScroller(),this.element.find(".e-ampmstyle").height(this.element.find(".e-workcells").height()),this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").addClass("e-businesshighlightworkcells"),this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove(),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this._renderAppointmentAll())},_renderInitSchedule:function(){this.model.width=this.model.width?this.element.width(this.model.width).width():this.element.width();this.model.height=this.model.height?this.element.height(this.model.height).height():this.element.height();this.scWidth=this._scWidth?parseInt(this._scWidth):parseInt(this.model.width);this.scHeight=this._scHeight?parseInt(this._scHeight):parseInt(this.model.height);this.element.addClass("e-scheduleouter").height(this.scHeight).width(this.scWidth).attr("role","presentation");n(this.element).attr("tabIndex",1);var i=t.buildTag("div","",{},{height:this.scHeight,width:this.scWidth}),u=t.buildTag("table.e-table","",{},{cellpadding:"0px",cellspacing:"0px"}).addClass("e-scheduleoutertable"),f=t.buildTag("tbody"),r=t.buildTag("tr.e-scheduleheader");this.aTR=t.buildTag("tr");this._getRenderDates();this.wTR=t.buildTag("tr.e-contentarearow");this._renderTemplates();this._renderHeaderBar(r);this._renderHeaderAllDayTemplate();this._renderContentAreaTemplate();i.append(u.append(f.append(r).append(this.aTR).append(this.wTR)));this.element.append(i);this.element.find(".e-"+this.currentView()).addClass("e-activeview");this.element.find("#"+this._id+"_navigator").ejDatePicker({enableRTL:this.model.enableRTL,buttonText:this._getLocalizedLabels("Today"),select:n.proxy(this._onselect,this),locale:this.model.locale,cssClass:this.model.cssClass});this.element.find("span.e-datewidget").css("display","none");this.currentView()==="month"?this._renderMonthTimeCells():this.element.find(".e-headercells").addClass("e-dateheaderselect");this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");this._renderAppointmentWindow();this._renderRecurEditWindow();this.model.showQuickWindow&&(this._renderQuickAppWindow()||this._renderQuickAppDetailsView());this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay"));this._renderScroller();this.element.find(".e-ampmstyle").height(n(this.element.find(".e-workcells")).height());this._highlightCurrentTime(this.model.showCurrentTimeIndicator);this._showContextMenu(this.model.contextMenuSettings.enable)},_renderScroller:function(){var r=this.element.find(".e-scheduleheader").height()+this.element.find(".e-headrealldaytable").height(),t=this,u=this.currentView()==="month"?0:4,i=n("div#"+this._id+"_scroller");i.ejScroller({enableRTL:this.model.enableRTL,height:this.scHeight-r,width:this.scWidth-this.element.find(".e-scrolltimecells").width()+u,cssClass:this.model.cssClass,thumbStart:function(t){if(n(t.originalEvent.target).parents(".e-appointment").hasClass("e-appointment"))return!1},scroll:function(i){var r,u;t.element.find(".e-scrolltimecells").css("top",-i.scrollTop+"px");t.model.timeMode==="12"&&t.currentView()!=="month"&&(r=i.scrollTop/(t.element.find(".e-workcells").height()*2),r=Math.round(r)<r?Math.round(r)+1:Math.round(r),u=Globalize.culture(t.model.locale).calendar,u.AM&&u.PM&&t.element.find(".e-ampmstyle").each(function(t,i){t==r?parseInt(n(i)[0].id)<12?n(i).text(u.AM[0]):n(i).text(u.PM[0]):(n(i).text()==u.AM[0]&&t>0||n(i).text()==u.PM[0]&&parseInt(n(i)[0].id)>12)&&n(i).text("00")}))}});i.ejScroller("isVScroll")?this.element.find(".e-emptytd,.e-emptyalldaytd").show():this.element.find(".e-emptytd,.e-emptyalldaytd").hide()&&this.element.find(".e-draggableworkarea").css("height","100%");this._nextPrevAppointment(this.model.enableAppointmentNavigation)},_highlightBusinessHours:function(){var e,r,f,u,i;if(this.currentView()!=="month"){this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");var o=this.dateRender,u=this.element.find(".e-workcells"),h=this.model.businessStartHour>=this.model.startHour?this.model.businessStartHour-this.model.startHour:0,c=this.model.businessEndHour<=this.model.endHour?this.model.businessEndHour-this.model.startHour:this.model.endHour-this.model.startHour,s=2;for(this.res1=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1:[0],e=this.currentView()==="week"?7*this.res1.length:this.currentView()==="workweek"?5*this.res1.length:1*this.res1.length,i=h*s;i<c*s;i++)for(r=0;r<e;r++)new Date(o[r]).getDay()!==0&&new Date(o[r]).getDay()!==6&&n(u[i*e+r]).addClass("e-businesshighlightworkcells")}else for(f=this.dateRender,u=this.element.find(".e-monthcells"),u.removeClass("e-monthcellhighlight"),i=0;i<f.length;i++)new Date(f[i]).getDay()!==0&&new Date(f[i]).getDay()!==6&&n(u[i]).addClass("e-monthcellhighlight")},_onselect:function(n){var i=this,r=new Date(this.currentDate()),u=new Date(n.value),t;if(this.currentDate(u),t={prevDate:r,currentDate:this.currentDate(),target:n},this._trigger("navigation",t))return!1;i._navigateClick(n)},_renderHeaderBar:function(n){this.hTD=t.buildTag("td","",{},{});var i=t.buildTag("div.e-datecommondiv").append(t.buildTag("div.e-icon e-navigateprevious","",{},{title:this._getLocalizedLabels("Previous")})).append(t.buildTag("div","",{},{"aria-live":"assertive",tabindex:0}).html(this._getCurrentDateHeaderValue()).addClass("e-datedisplay")).append(t.buildTag("input#"+this._id+"_navigator").css("display","none").addClass("dateCalendar")).append(t.buildTag("div.e-icon e-navigatenext","",{},{title:this._getLocalizedLabels("Next")})),r=t.buildTag("div.e-viewsdiv");n.append(this.hTD.append(i).append(r.append(this._renderViewNavigation(this.model.views))))},_renderViewNavigation:function(n){for(var u=t.buildTag("table.e-table e-viewstable","",{},{cellspacing:"0px",cellpadding:"0px"}),o=t.buildTag("tbody"),f=t.buildTag("tr"),r=n,e,i=0;i<r.length;i++)e=r.length==1?"e-"+r[i].toLowerCase()+" e-singleview":i==0?"e-"+r[i].toLowerCase()+" e-firstview":i==r.length-1?"e-"+r[i].toLowerCase()+" e-lastview":"e-"+r[i].toLowerCase(),f.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels(r[i]),{},{}).addClass("e-commonviewbutton").addClass(e)));return u.append(o.append(f)),u},_recurrenceWindow:function(){var v=["Daily","Weekly","Monthly","Yearly","EveryWeekDay"],y=Globalize.culture(this.model.locale),i=this._dayShortNames,r=this._dayFullNames,u=this._monthNames,f=["First","Second","Third","Fourth","Last"],n="<div class='e-recurwindow e-windowmargin' style='display:none'><form id='"+this._id+"_RecurForm'><table class='e-table' width='100%' cellpadding='7'><tbody>",e,t,o,s,h,c,l,a;for(n+="<tr><td width='16%' class='e-textlabel'>"+this._getLocalizedLabels("Recurrence")+":<\/td><td><input class='recurtype' id='recurtype' type='text' name='RecurrenceType' value='"+this._getLocalizedLabels(v[0])+"' /><div id='recurtypelist'><ul>",e=0;e<v.length;e++)n+="<li>"+this._getLocalizedLabels(v[e])+"<\/li>";for(n+="<\/ul><\/div><\/td><\/tr>",n+="<tr id='"+this._id+"repeatEvery'><td class='e-textlabel'>"+this._getLocalizedLabels("Every")+":<\/td><td><table><tr><td><div class='e-floatleft'><input id='recurevery' class='e-recurevery' type='text' /><\/div><\/td><td><div id='"+this._id+"recurtypes' class='e-appcheckbox'>"+this._getLocalizedLabels("RecurrenceDay")+"<\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"weeklyrecur' style='display:none'><td id='recurweek' class='e-textlabel'><div>"+this._getLocalizedLabels("RepeatOn")+":<\/div><\/td><td id='recurweekcount'><table class='e-table' cellpadding='3'><tr>",t=0;t<i.length;t++)n+="<td><div class='e-weekday e-_"+i[t]+"'><input id='"+i[t]+"' class='weekdays e-weekly"+this._dayNames[t]+"'name='weekdays' type='checkbox'/><label class='e-textmargin' for='"+i[t]+"'>"+i[t]+"<\/label><\/div><\/td>";for(n+="<\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"monthlyrecur' style='display:none'><td id='recurmonthtext' class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("RepeatBy")+":<\/div><\/td><td id='recurmonthcount'><table class='e-table' cellpadding='3'><tr><td><div><input id='"+this._id+"monthday' class='e-monthdaytype' name='monthday' type='radio'/><label class='e-textmargin' for='"+this._id+"monthday'>"+this._getLocalizedLabels("Day")+"<\/label><\/div><\/td><td><div><input id='monthdate' class='e-monthdate' type='text'/><\/div><\/td><\/tr><tr><td><div><input id='"+this._id+"monthon' class='e-monthposition' name='monthday' type='radio'/><label class='e-textmargin' for='"+this._id+"monthon'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div><input id='monthsrt' class='monthsrt' type='text' name='monthsrt' value=''/><div id='monthsrtlist'><ul>",o=0;o<f.length;o++)n+="<li>"+this._getLocalizedLabels(f[o])+"<\/li>";for(n+="<\/div><\/div><\/td>",n+="<td><div class='e-appcheckbox'><input id='monthsrtday' class='e-monthsrtday' type='text' name='monthsrtday' value=''/><div id='monthsrtdaylist'><ul>",s=0;s<r.length;s++)n+="<li>"+r[s]+"<\/li>";for(n+="<\/div><\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"yearlyrecur' style='display:none'><td id='recuryeartext' class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("RepeatBy")+":<\/div><\/td><td id='recuryearcount' ><table class='e-table' cellpadding='3'><tr><td><div><input id='"+this._id+"yearday' class='e-yearrecurday' name='yearday' type='radio'/><label class='e-textmargin' for='"+this._id+"yearday'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div class='e-controlalign'><input id='yearmonth' class='yearmonth' type='text' name='yearmonth' value=''/><\/div><\/td><div id='yearmonthlist'><ul>",h=0;h<u.length-1;h++)n+="<li>"+u[h]+"<\/li>";for(n+="<\/ul><\/div><td><input id='yeardate' class='yeardate' text='text'/><\/td><\/tr><tr><td><div><input id='"+this._id+"yearother' class='e-yearrecurposi' name='yearday' type='radio'/><label class='e-textmargin' for='"+this._id+"yearother'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div><input id='yearsrt' class='yearsrt' type='text' name='yearsrt' value=''/><div id='yearsrtlist'><ul>",c=0;c<f.length;c++)n+="<li>"+this._getLocalizedLabels(f[c])+"<\/li>";for(n+="<\/ul><\/div><\/div><\/td><td><div class='e-controlalign'><input id='yearsrtday' class='yearsrtday' type='text' name='yearsrtday' value=''/><div id='yearsrtdaylist'><ul>",l=0;l<r.length;l++)n+="<li>"+r[l]+"<\/li>";for(n+="<\/ul><\/div><\/div><\/td><td><div><span>"+this._getLocalizedLabels("OfEvery").split(" ")[0]+"<\/span><\/div><\/td><td><div><input id='yearsrtmonth' class='yearsrtmonth' type='text' name='yearsrtmonth' value=''/><div id='yearsrtmonthlist'><ul>",a=0;a<u.length-1;a++)n+="<li>"+u[a]+"<\/li>";return n+="<\/ul><\/div><\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr><td class='e-textlabel'>"+this._getLocalizedLabels("StartsOn")+":<\/td><td><input id='recurstartdate' class='recurstartdate' type='text' name='RecurStartDate' value=''/><\/td><\/tr>",n+="<tr><td class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("Ends")+":<\/div><\/td><td><table class='e-table' cellpadding='3'><tr><td><div><input id='repeatendnever' class='recurends e-recurnoend' type='radio' name='repeatend' value='Never'/><label class='e-textmargin' for='repeatendnever'>"+this._getLocalizedLabels("Never")+"<\/label><\/div><\/td><\/tr><tr><td><div><input id='"+this._id+"repeatendafter' class='recurends e-recurafter' type='radio' name='repeatend'/><label class='e-textmargin' for='"+this._id+"repeatendafter'>"+this._getLocalizedLabels("After")+"<\/label><\/div><\/td><td><div><input id='dailyoccurance' class='e-recurcount' type='text'/><\/div><\/td><td><span style='margin-left: -80px;'>"+this._getLocalizedLabels("Occurence")+"<\/span><\/td><\/tr><td><div><input id='"+this._id+"repeatendon' class='recurends e-recuruntil' type='radio' name='repeatend'/><label class='e-textmargin' for='"+this._id+"repeatendon'>"+this._getLocalizedLabels("On")+"<\/label><\/div><\/td><td><input id='daily' class='e-until' type='text' name='daily' value=''/><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr style='display:none'><td><span class='e-textlabel'>"+this._getLocalizedLabels("Summary")+":<\/span><\/td><td><span class=e-recurRule><\/span><\/td><\/tr><\/tbody><\/table><\/form>",n+("<div class='e-floatright'><table class='e-table' cellpadding='5'><tr><td><div class='e-btnmargin e-floatleft'><button id='donerecur' class='recurbutton'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div class='e-btnmargin e-floatleft'><button id='cancelrecur' class='e-cancelrecur recurbutton'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/tabled><\/div><\/div>")},_renderAppointmentWindow:function(){var i,r;if(this._appointmentAddWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppointmentAddEditWindow"),i="<div class='e-appwindow e-windowmargin'><form id='"+this._id+"_AddEditForm'><table class='e-table' width='100%' cellpadding='7'><tbody>",i+="<tr><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("AppointmentSubject")+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"subject' tabIndex='0' class='subject e-inputtext' name='"+this.model.appointmentSettings.subject+"' type='text' /><input id='id' type='text' name='"+this.model.appointmentSettings.id+"' value='' style='display: none'/><\/td><\/tr>",i+="<tr><td class='e-textlabel'>"+this._getLocalizedLabels("StartTime")+":<\/td><td width='25%'><input id='"+this._id+"startdate' class='startenddate' type='text' name='StartDate' value='' /><\/td><td width=22%'><input type='text' id='"+this._id+"starttime' class='startendtime' name='StartTime'/><\/td><td width='28%'><input id='startutc' class='startutc' type='text' value=''/><div id='Timezoneliststr'><\/div><\/td><\/tr>",i+="<tr><td class='e-textlabel'>"+this._getLocalizedLabels("EndTime")+":<\/td><td><input id='"+this._id+"enddate' class='startenddate' type='text' name='EndDate' value='' /><\/td><td><input type=''text' id='"+this._id+"endtime' class='startendtime' name='EndTime'/><\/td><td><input id='endutc' class='endutc' type='text' value=''/><div id='Timezonelistend'><\/div><\/td><\/tr>",i+="<tr><td colspan='4'><table class='e-table' cellpadding='3'><tr><td><div class='e-allday e-checkboxmargin'><input id='"+this._id+"allday' tabIndex='0' class='allday' type='checkbox' name='"+this.model.appointmentSettings.allDay+"'/><\/div><\/td><td><div class='e-alldaytext'><label for='"+this._id+"allday'>"+this._getLocalizedLabels("AllDay")+"<\/label><\/div><\/td><td><div class='e-checkboxmargin e-recurrence'><input id='"+this._id+"recurrence' tabIndex='0' class='recurrence' type='checkbox' name='"+this.model.appointmentSettings.recurrence+"' value='recurrence'/><\/div><\/td><td><label class='e-repeatlbl' for='"+this._id+"recurrence'>"+this._getLocalizedLabels("Recurrence")+"<\/label><\/td><\/tr><\/table><\/td><\/tr>",i+="<tr id='"+this._id+"summary' style='display:none'><td class='e-textlabel'><label>"+this._getLocalizedLabels("Summary")+":<\/label><\/td><td colspan='3'><table><tr><td><label class='e-recurFinalRule'><\/label><\/td><td><div class='e-recuredit'><a class='e-recuredit' href='#'>"+this._getLocalizedLabels("Edit")+"<\/a><span class='e-icon e-scheduleedit'><\/span><\/div><\/td><\/tr><\/table><\/td><\/tr>",i+="<tr><td colspan='4'><textarea class='e-description e-inputtext' id='description' name='"+this.model.appointmentSettings.description+"'><\/textarea><\/td><\/tr>",!t.isNullOrUndefined(this.model.resources)&&this.model.resources.length>0)for(r=0;r<this.model.resources.length;r++)i+="<tr><td class='e-leftfields e-textlabel'>"+this.model.resources[r].title+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"_ownerfield_"+r+"'  class='owner_"+r+"' type='text' value=''/><div id='ownerlist'><\/div><\/td><\/tr>";i+="<\/tbody><\/table><\/form>";i+="<div class='e-floatright'><table class='e-table' cellpadding='5'><tr><td><div class='e-btnmargin e-floatleft'><button id='done' class='e-btndone e-appsave'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div class='e-btnmargin e-floatleft'><button id='cancel' class='e-appointcancel cancel'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div><\/div>";this._appointmentAddWindow.append(i).append(this._recurrenceWindow());this.element.append(this._appointmentAddWindow);this._renderControls();this._appointmentAddWindow.ejDialog({width:600,cssClass:this.model.cssClass,showOnInit:!1,enableRTL:this.model.enableRTL,enableModal:!0,title:this._getLocalizedLabels("CreateAppointmentTitle"),content:"#"+this._id,enableResize:!1,allowKeyboardNavigation:!1,close:n.proxy(this._onclose,this)});n("#"+this._id+"AppointmentAddEditWindow_wrapper").appendTo("body").addClass("e-scheduledialog").find(".e-titlebar").addClass("e-dialogheader");this._on(this._appointmentAddWindow,"click","a.e-recuredit",n.proxy(this._editRecurrence,this))},_renderQuickAppWindow:function(){var i,r;this._quickAppointWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppointmentQuickWindow");i="<div id='"+this._id+"_quickAppwindow' class='e-tableAppoint'><table cellpadding='7' class='e-qappwindow'><tbody>";i+="<tr><td colspan='2'><div class='e-quickstartend'><\/div> <div title='"+this._getLocalizedLabels("Close")+"'class='e-icon e-scheduleclose e-schedclosemargin e-pointercursor'><\/div><\/td><\/tr><tr><td class='e-subjectlabel'>"+this._getLocalizedLabels("Event")+":<\/td><td colspan='2' class='e-rightfields'><input id='"+this._id+"subject' class='subject e-inputtext' style='height:22px;' type='text' /><\/td><\/tr><\/tbody><\/table>";i+="<div style='margin-top:5px; padding-bottom: 30px;'><div tabIndex='0' class='e-detailedapp e-detailedwindow'> "+this._getLocalizedLabels("Detailed")+" >><\/div><div style='margin-right:-3px;' class='e-floatright'><div class='e-quickAppDone'><button id='done' class='e-btndone qAppDone' style='font-size:12px !important;'>"+this._getLocalizedLabels("CreateAppointmentTitle")+"<\/button><\/div><\/div><\/div><\/div>";this._quickAppointWindow.append(i);this.element.append(this._quickAppointWindow);this._quickAppointWindow.append(t.buildTag("div.e-quickarrow").append("<div class='e-outerarrowline'><\/div>").append("<div class='e-innerarrow'><\/div>"));r=this._quickAppointWindow;r.find(".e-btndone").ejButton({showRoundedCorner:!0,width:"130px",click:n.proxy(this._saveAppointment,this),cssClass:this.model.cssClass,enableRTL:this.model.enableRTL});this._on(r.find(".e-scheduleclose"),"click",n.proxy(this._quickWindowClose,this));this._on(r.find(".e-detailedapp"),"click",n.proxy(this._appointmentWindow,this));this._quickAppointWindow.ejDialog({width:330,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,showOnInit:!1,enableResize:!1,allowDraggable:!1,showHeader:!1,allowKeyboardNavigation:!1});n("#"+this._id+"AppointmentQuickWindow_wrapper").addClass("e-scheduledialog").find("#"+this._id+"AppointmentQuickWindow").addClass("e-dialogouter")},_renderQuickAppDetailsView:function(){this._quickAppDetailsWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppDetailsWindow");var i="<div id='"+this._id+"_quickAppDetailswindow' class='e-tableAppoint'><table cellpadding='1' class='e-qappwindow'><tbody>";i+="<tr><td colspan='2'><div class='e-quicksubject' style='float:left;'><\/div> <div title='"+this._getLocalizedLabels("Close")+"' class='e-icon e-scheduleclose e-schedclosemargin e-pointercursor'><\/div><\/td><\/tr><tr><td colspan='2' class='e-rightfields'><\/td><\/tr><tr><td colspan='2'><div class='e-quickstartendtime'><\/div><\/td><\/tr><\/tbody><\/table>";i+="<div style='margin-top:5px;'><div title='"+this._getLocalizedLabels("Delete")+"' class='e-icon e-scheduledelete e-pointercursor' tabIndex='0'><\/div><div style='margin-right:-15px;' class='e-floatright'><div class='e-editevents'><div class='e-editevent' tabIndex='0'>"+this._getLocalizedLabels("Editevent")+" | <\/div><div class='e-editseries' tabIndex='0'>"+this._getLocalizedLabels("Editseries")+" >><\/div> <\/div><\/div><\/div><\/div>";this._quickAppDetailsWindow.append(i);this.element.append(this._quickAppDetailsWindow);this._quickAppDetailsWindow.append(t.buildTag("div.e-quickarrow").append("<div class='e-outerarrowline'><\/div>").append("<div class='e-innerarrow'><\/div>"));this._on(this._quickAppDetailsWindow.find(".e-scheduleclose"),"click",n.proxy(this._quickAppDetailWindowClose,this));this._on(this._quickAppDetailsWindow.find(".e-scheduledelete"),"click",n.proxy(this._deleteAppoint,this));this._on(this._quickAppDetailsWindow.find(".e-editevent,.e-editseries"),"click",n.proxy(this._editClick,this));this._quickAppDetailsWindow.ejDialog({width:270,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,showOnInit:!1,enableResize:!1,allowDraggable:!1,showHeader:!1,allowKeyboardNavigation:!1});n("#"+this._id+"AppDetailsWindow_wrapper").addClass("e-scheduledialog").find("#"+this._id+"AppDetailsWindow").addClass("e-dialogouter")},_editClick:function(i){var u=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),r=new t.DataManager(this._processed).executeLocal(u);n(i.target).hasClass("e-editevent")?r[0][this.model.appointmentSettings.recurrence]==1?(this._parentId=r[0].ParentId,this._currentAction=t.Schedule.Actions.EditOcurrence,this._showAppointmentDetails(this._appId,!0)):(this._currentAction=t.Schedule.Actions.Save,this._showAppointmentDetails(this._appId)):n(i.target).hasClass("e-editseries")&&r[0][this.model.appointmentSettings.recurrence]==1&&(this._parentId=r[0].ParentId,this._currentAction=t.Schedule.Actions.EditSeries,this._showAppointmentDetails(this._parentId));this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close")},_deleteAppoint:function(){if(this._appId){this._currentAction=t.Schedule.Actions.Delete;var n=this._getAppointmentByParentId(this._appId);t.isNullOrUndefined(n[this.model.appointmentSettings.recurrenceRule])?this._deleteApp(parseInt(this._appId)):(this._parentId=parseInt(n[this.model.appointmentSettings.id]),this._recurEditWindow.find(".e-editonly").ejRadioButton({checked:!0}),this._recurEditWindow.ejDialog("open"),this._recurEditWindow.focus())}this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close")},_quickAppDetailWindowClose:function(){this._quickAppDetailsWindow.ejDialog("close");this._processFocus()},_alldayCheck:function(){this._appointmentAddWindow.find(".allday").data("ejCheckBox").isChecked?(this._appointmentAddWindow.find(".startendtime").ejTimePicker({enabled:!1}),this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList({enabled:!1})):(this._appointmentAddWindow.find(".startendtime").ejTimePicker({enabled:!0}),this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList({enabled:!0}))},_renderRecurEditWindow:function(){var i;this._recurEditWindow=t.buildTag("div.e-scheduledialog#"+this._id+"RecurrenceEdit");i=t.buildTag("div.e-recurtitle",this._getLocalizedLabels("RecurrenceEditTitle"));i.append(t.buildTag("div.e-icon e-scheduleclose e-schedclosemargin e-pointercursor","",{},{title:this._getLocalizedLabels("Close")}));this._recurEditWindow.append(i);var u=t.buildTag("div.e-recureditmsg",this._getLocalizedLabels("RecurrenceEditMessage")),f=t.buildTag("div.e-recureditopt").append(t.buildTag("input.e-editonly","",{},{type:"radio",name:"recurEdit",id:this._id+"_editOnly"})).append(t.buildTag("label.e-recureditlbl",this._getLocalizedLabels("RecurrenceEditOnly"),{},{"for":this._id+"_editOnly"})),e=t.buildTag("div.e-recureditopt").append(t.buildTag("input.e-editseries","",{},{type:"radio",name:"recurEdit",id:this._id+"_editSeries"})).append(t.buildTag("label.e-recureditlbl",this._getLocalizedLabels("RecurrenceEditSeries"),{},{"for":this._id+"_editSeries"})),r=t.buildTag("div.e-recureditbtns").append(t.buildTag("button.e-recurdone",this._getLocalizedLabels("Done"),{},{name:"done",value:this._getLocalizedLabels("Done")})).append(t.buildTag("button.e-recurcancel",this._getLocalizedLabels("Cancel"),{},{name:"cancel",value:this._getLocalizedLabels("Cancel")}));this._recurEditWindow.append(u).append(f).append(e).append(r);this._recurEditWindow.find(".e-editonly,.e-editseries").ejRadioButton({cssClass:this.model.cssClass});r.find(".e-recurdone,.e-recurcancel").ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL});this._on(this._recurEditWindow,"click",".e-recurdone,.e-recurcancel",n.proxy(this._recurBtnClick,this));this._on(this._recurEditWindow,"click","div.e-scheduleclose",n.proxy(this._recrConformClose,this));this._recurEditWindow.appendTo(this.element);this._recurEditWindow.ejDialog({width:360,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,showOnInit:!1,enableModal:!0,enableResize:!1,showHeader:!1,content:"#"+this._id,allowKeyboardNavigation:!1,close:n.proxy(this._processFocus,this)});n("#"+this._id+"RecurrenceEdit_wrapper").appendTo("body")},_recrConformClose:function(){this._recurEditWindow.ejDialog("close");this._processFocus()},_recurBtnClick:function(i){var u,o;if(n(i.target).hasClass("e-recurdone"))if(this._recurEditWindow.find(".e-editonly").ejRadioButton("option","checked"))if(this._currentAction==t.Schedule.Actions.Delete)if(u=new t.DataManager(this._processed).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,parseInt(this._appId)))[0],u[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1)this._deleteApp(parseInt(this._appId));else{var e=this._deleteOcurrence(this._parentId,u[this.model.appointmentSettings.startTime]),f=this._dataManager.update(this.model.appointmentSettings.id,e),r=this;f&&n.isFunction(f.promise)&&this.dataSource()instanceof t.DataManager?(f.done(function(){new t.DataManager(r._processed).remove(r.model.appointmentSettings.id,parseInt(r._appId));r.element.find("#Appointment_"+r._appId).remove();r._trigger("appointmentDeleted",{appointment:u})}),f.fail(function(){})):(o=new t.DataManager(this._processed).remove(this.model.appointmentSettings.id,parseInt(this._appId)),this.element.find("#Appointment_"+this._appId).remove(),this._trigger("appointmentDeleted",{appointment:u}))}else this._currentAction=t.Schedule.Actions.EditOcurrence,this._showAppointmentDetails(this._appId,!0);else this._currentAction==t.Schedule.Actions.Delete?this._deleteApp(parseInt(this._parentId)):(this._currentAction=t.Schedule.Actions.EditSeries,this._showAppointmentDetails(this._parentId));this._recurEditWindow.ejDialog("close")},_repeat:function(n){if(n.isChecked||this._recurChecked)if(this._currentAction==t.Schedule.Actions.EditSeries||this._appointmentAddWindow.find(".e-recurFinalRule").html()!="")this._appointmentAddWindow.find("#"+this._id+"summary").css("display","table-row");else{this._appointmentAddWindow.find(".e-appwindow").toggle();this._appointmentAddWindow.find(".e-recurwindow").css("margin-left",700).toggle().animate({"margin-left":10},400);this._recurClearFields();var i=new Date(this._appointmentAddWindow.find(".startenddate").ejDatePicker("option","value"));this._appointmentAddWindow.find(".recurtype").ejDropDownList({selectedItemIndex:0});this._appointmentAddWindow.find(".recurtype").ejDropDownList({selectedItemIndex:1});this._appointmentAddWindow.find(".recurstartdate").ejDatePicker({value:i});this._appointmentAddWindow.find(".e-until").ejDatePicker({value:new Date(i.setDate(i.getDate()+70))});this._appointmentAddWindow.find(".e-recurnoend").ejRadioButton({checked:!0})}else(this._currentAction==t.Schedule.Actions.EditSeries||this._appointmentAddWindow.find(".e-recurFinalRule").html()!="")&&this._appointmentAddWindow.find("#"+this._id+"summary").css("display","none");this._recurChecked=!1},_recurtype:function(n){var i,t,r;this._rRuleFreq="";i="";t=new Date(this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value"));n.itemId!=null&&(this._appointmentAddWindow.find("#"+this._id+"repeatEvery").css("display","table-row"),n.itemId==0?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceDay"),this._appointmentAddWindow.find("#"+this._id+"weeklyrecur,#"+this._id+"monthlyrecur,#"+this._id+"yearlyrecur").css("display","none"),this._appointmentAddWindow.find("#"+this._id+"dailyrecur").css("display","table-row"),this._rRuleFreq="DAILY",i=this._getLocalizedLabels("RecurrenceDay").toLowerCase()):n.itemId==1?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceWeek"),r=this._dayNames[t.getDay()],this._appointmentAddWindow.find(".e-weekly"+r).ejCheckBox({checked:!0}),i=this._getLocalizedLabels("RecurrenceWeek").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._dayFullNames[t.getDay()],this._rRuleFreq="WEEKLY",this._appointmentAddWindow.find("#"+this._id+"monthlyrecur,#"+this._id+"yearlyrecur,#"+this._id+"dailyrecur").css("display","none"),this._appointmentAddWindow.find("#"+this._id+"weeklyrecur").css("display","table-row")):n.itemId==2?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceMonth"),this._appointmentAddWindow.find("#"+this._id+"weeklyrecur,#"+this._id+"yearlyrecur,#"+this._id+"dailyrecur").css("display","none"),this._appointmentAddWindow.find("#"+this._id+"monthlyrecur").css("display","table-row"),this._appointmentAddWindow.find(".e-monthdate").ejNumericTextbox({value:t.getDate()}),this._appointmentAddWindow.find(".e-monthsrtday").ejDropDownList({selectedItemIndex:t.getDay()}),this._appointmentAddWindow.find(".monthsrt").ejDropDownList({selectedItemIndex:this._getWeekIndex(t)}),this._appointmentAddWindow.find(".e-monthdaytype").ejRadioButton({checked:!0}),this._rRuleFreq="MONTHLY",i=this._getLocalizedLabels("RecurrenceMonth").toLowerCase()):n.itemId==3?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceYear"),this._appointmentAddWindow.find("#"+this._id+"weeklyrecur,#"+this._id+"monthlyrecur,#"+this._id+"dailyrecur").css("display","none"),this._appointmentAddWindow.find("#"+this._id+"yearlyrecur").css("display","table-row"),this._appointmentAddWindow.find(".yearmonth").ejDropDownList({selectedItemIndex:t.getMonth()}),this._appointmentAddWindow.find(".yeardate").ejNumericTextbox({value:t.getDate()}),this._appointmentAddWindow.find(".yearsrtday").ejDropDownList({selectedItemIndex:t.getDay()}),this._appointmentAddWindow.find(".yearsrtmonth").ejDropDownList({selectedItemIndex:t.getMonth()}),this._appointmentAddWindow.find(".yearsrt").ejDropDownList({selectedItemIndex:this._getWeekIndex(t)}),this._appointmentAddWindow.find(".e-yearrecurday").ejRadioButton({checked:!0}),this._rRuleFreq="YEARLY",i=this._getLocalizedLabels("RecurrenceYear").toLowerCase()):n.itemId==4&&(this._rRuleFreq="WEEKDAYS",this._appointmentAddWindow.find("#"+this._id+"weeklyrecur,#"+this._id+"yearlyrecur,#"+this._id+"dailyrecur,#"+this._id+"repeatEvery,#"+this._id+"monthlyrecur").css("display","none"),i=n.text),this._appointmentAddWindow.find(".e-recurRule").html(i))},_getRenderDates:function(){var i,n,t;if(this._dateRender=[],this.currentView()==="week"||this.currentView()==="workweek"){for(i=this._firstweekdate(),t=0;t<7;t++)n=new Date(i),n.setDate(i.getDate()+t),this._dateRender.push(new Date(n.getFullYear(),n.getMonth(),n.getDate()).getTime());this.currentView()==="workweek"&&(this._dateRender=this._dateRender.slice(1,6))}else this.currentView()==="month"?this._dateRender=this._monthdates():this._dateRender.push(this.currentDate());return this._dateRender},_getCurrentDateHeaderValue:function(){var i=Globalize.culture(this.model.locale),t,n=this._dateRender;return this.currentView()==="day"?t=i.calendar.days.names[new Date(n[0]).getDay()].slice(0,3)+" "+new Date(n[0]).getDate()+" "+Globalize.format(new Date(n[0]),"MMM")+" "+new Date(n[0]).getFullYear():this.currentView()==="week"||this.currentView()==="workweek"?new Date(n[0]).getYear()===new Date(n[n.length-1]).getYear()?new Date(n[0]).getMonth()===new Date(n[n.length-1]).getMonth()?t=Globalize.format(new Date(n[0]),"dd")+" - "+Globalize.format(new Date(n[n.length-1]),"dd MMM yyyy"):new Date(n[0]).getMonth()!==new Date(n[n.length-1]).getMonth()&&(t=this.model.enableRTL?Globalize.format(new Date(n[n.length-1]),"MMM dd")+" - "+Globalize.format(new Date(n[0]),"dd MMM yyyy"):Globalize.format(new Date(n[0]),"dd MMM")+" - "+Globalize.format(new Date(n[n.length-1]),"dd MMM yyyy")):t=Globalize.format(new Date(n[0]),"MMM dd yyyy")+" - "+Globalize.format(new Date(n[n.length-1]),"MMM dd yyyy"):t=Globalize.format(new Date(this.currentDate()),"MMM yyyy"),t},_firstweekdate:function(){var n=new Date(this.currentDate()),t=n.getDay();return t!=0&&n.setDate(n.getDate()-t),n},_getHeaderAllDayCellsCount:function(){var y=Globalize.culture(this.model.locale),w,h,p,c=1,u,b,r,f,l,a,k,e,o,v,s,i,n;if(this.dateRender=[],p=[1],h=this._getColumnCount().length,!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)){if(this.model.group.resources.length===1){for(n=0;n<this.model.group.resources.length;n++)b=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[n]);c=this._resourceInfo[b].dataSource.length}else{for(r=this._getResourceCollection(),f=[],i=0;i<r.length;i++)if(f=[],i==0)for(n=0;n<r[i].dataSource.length;n++)f.push({resourceNam:r[i].dataSource[n][r[i].text]});else for(i>1&&(r[i-1].dataSource=[],r[i-1].dataSource=this.res),this.res=[],l=t.group(r[i].dataSource,r[i].groupId),a=t.group(r[i-1].dataSource,r[i-1].id),this._resourceManager1=l instanceof t.DataManager?l:t.DataManager(l),o=0;o<a.length;o++)for(v=0;v<a[o].items.length;v++)if(k=(new t.Query).where("key",t.FilterOperators.equal,a[o].items[v][r[i].id]),e=this._resourceManager1.executeLocal(k),e.length>0)for(s=0;s<e[0].items.length;s++)f.push({resourceNam:e[0].items[s][r[i].text]}),this.res.push(e[0].items[s]);c=f.length}h=h*c}for(n=0;n<c;n++)for(i=0;i<this._dateRender.length;i++)this.dateRender.push(this._dateRender[i]);for(n=0;n<h;n++)u=this.currentView()==="month"||this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?y.calendar.days.names[new Date(this.dateRender[n]).getDay()]:y.calendar.days.names[new Date(this.dateRender[n]).getDay()].slice(0,3):y.calendar.days.names[new Date(this.dateRender[n]).getDay()].slice(0,3),w=this.currentView()==="month"?{currentDay:u}:this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?{currentDay:u+" "+Globalize.format(new Date(this.dateRender[n]),"dd MMMM yyyy")}:{currentDay:u+" "+Globalize.format(new Date(this.dateRender[n]),"dd MMM yy")}:{currentDay:u+" "+new Date(this.dateRender[n]).getDate()},p.push(w);return p},_findResourceIndex:function(n,t,i){for(var r=0;r<n.length;r++)if(n[r][t]===i)return r},_getResourceCollection:function(){var i=[],f,n,u,r;if(!t.isNullOrUndefined(this.model.resources)){if(t.isNullOrUndefined(this.model.group))for(n=0;n<this.model.resources.length;n++)i.push({index:n});else{for(n=0;n<this.model.group.resources.length;n++)f=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[n]),i.push({index:f,name:this.model.resources[n].name});i=i.sort(function(n,t){var i=n.index,r=t.index;return i<r?-1:i>r?1:0})}for(u=[],r=0;r<i.length;r++)u.push(this._resourceInfo[i[r].index]);return u}},_renderHeaderAllDayTemplate:function(){var it=t.buildTag("div","",{},{height:"100%",width:"100%"}).css("position","relative"),rt=t.buildTag("table.e-table e-headrealldaytable","",{},{cellspacing:"0px",cellpadding:"0px"}),l=t.buildTag("tbody"),ut=t.buildTag("tr.e-dateheader"),h=this.currentView(),a=h=="day"?1:h=="week"||h=="month"?7:5,v=this._getHeaderAllDayCellsCount(),ft=this.headTemplate.render({cols:v,view:h,colspan:1}),c,e,y,i,b,f,n,k,nt,tt;if(!t.isNullOrUndefined(this.model.resources))if(this.res1=[],this.render_Resources=[],t.isNullOrUndefined(this.model.group))for(k=0;k<this.model.resources.length;k++)this.render_Resources.push(this.model.resources[k].resourceSettings.dataSource);else if(this.model.group.resources.length===1){for(n=0;n<this.model.group.resources.length;n++)c=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[n]);for(e=[],n=0;n<this._resourceInfo[c].dataSource.length;n++)e.push({resourceNam:this._resourceInfo[c].dataSource[n][this._resourceInfo[c].text],colspan:a}),this.res1.push(this._resourceInfo[c].dataSource[n]);this.render_Resources.push(this.res1);y=this.resourceHeadTemplate.render({cols:v,resourceName:e});l.append(t.buildTag("tr.e-headerbar").append(y))}else{var r=this._getResourceCollection(),d=[],e=[],p,o,u,s=[],w,g,y;for(i=0;i<r.length;i++){if(e=[],this.level_Resources=[],i>=0&&i<r.length-1)for(p=t.group(r[i+1].dataSource,"groupId"),this._resourceManager1=p instanceof t.DataManager?p:t.DataManager(p),n=0;n<r[i].dataSource.length;n++){if(o=(new t.Query).where("key",t.FilterOperators.equal,r[i].dataSource[n][r[i].id]),u=this._resourceManager1.executeLocal(o),u.length>0)for(f=0;f<u[0].items.length;f++)r[i].dataSource[n].id==u[0].items[f].groupId&&(d.push(u[0].items[f]),i==r.length-2?this.res1.push(u[0].items[f]):this.res1=[]);for(s=[],m=i+1;m<r.length;m++)if(w=t.group(r[m].dataSource,"groupId"),this._resourceData=w instanceof t.DataManager?w:t.DataManager(w),m>i+1){for(this.tres=[],b=0;b<s.length;b++)if(o=(new t.Query).where("key",t.FilterOperators.equal,s[b].id),u=this._resourceData.executeLocal(o),u.length>0)for(f=0;f<u[0].items.length;f++)this.tres.push(u[0].items[f])}else if(o=(new t.Query).where("key",t.FilterOperators.equal,r[m-1].dataSource[n].id),u=this._resourceData.executeLocal(o),u.length>0)for(f=0;f<u[0].items.length;f++)s.push(u[0].items[f]);s.length>0&&(i!=0||t.isNullOrUndefined(this.tres)?e.push({resourceNam:r[i].dataSource[n][r[i].text],colspan:s.length*a}):e.push({resourceNam:r[i].dataSource[n][r[i].text],colspan:this.tres.length*a}),this.level_Resources.push(r[i].dataSource[n]));d=[]}else for(n=0;n<this.res1.length;n++)e.push({resourceNam:this.res1[n][r[i].text],colspan:a}),this.level_Resources.push(this.res1[n]);g=h=="month"?50:56;y=this.resourceHeadTemplate.render({cols:v,resourceName:e,leftWidth:g});this.render_Resources.push(this.level_Resources);l.append(t.buildTag("tr.e-headerbar").append(y))}}this.aTR.append(t.buildTag("td").append(it.append(rt.append(l.append(ut.append(ft))))));this.currentView()!=="month"&&(nt=t.buildTag("tr"),tt=this.alldayTemp.render({cols:v,colspan:1}),l.append(nt.append(tt)))},_monthdates:function(){var t=new Date(this.currentDate()),n=new Date(t.getFullYear(),t.getMonth(),1),i=n.getDay()+1,u;n.setDate(n.getDate()-i);var r=new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),e=(i+r)%7!=0?7-(i+r)%7:0,o=parseInt((i+r+e)/7),f=[];for(u=0;u<o*7;u++)f.push(new Date(n.setDate(n.getDate()+1)));return f},_getStartEndTime:function(){var t=[],i,r=Globalize.culture(this.model.locale).calendar,u,n;if(this.currentView()!=="month")for(n=this.model.startHour;n<this.model.endHour;n++)this.model.timeMode==="12"?(i=(n===this.model.startHour||n===12)&&r.AM&&r.PM?Globalize.format(new Date((new Date).setHours(n)),"hh tt"):Globalize.format(new Date((new Date).setHours(n)),"hh 00"),t.push({time:i,id:n})):t.push({time:(n<=9?"0"+n:n)+" 00"});else for(u=this._dateRender.length,n=0;n<u/7;n++)t.push(n);return t},_getWorkCellsCount:function(){var t=[],i,r,n;if(this.currentView()!=="month")for(i=this._getStartEndTime(),n=0;n<2*i.length;n++)t.push(n);else for(r=this._dateRender.length,n=0;n<r/7;n++)t.push(n);return t},_renderContentAreaTemplate:function(){var c=t.buildTag("div.e-workareadiv"),l=t.buildTag("table.e-table e-worktable","",{},{height:"100%",cellpadding:"0px",cellspacing:"0px",width:"100%"}),a=t.buildTag("tbody"),v=t.buildTag("tr"),y=this.currentView()==="month"?"e-monthleftindent":"e-workleftindent",f,n,e,o,s,h;this.$TimeCellTD=t.buildTag("td","",{},{}).addClass(y);var p=t.buildTag("td"),r=[],u,i=this.currentView()==="day"?1:this.currentView()==="week"||this.currentView()==="month"?7:5;if(!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group))if(this.model.group.resources.length===1){for(n=0;n<this.model.group.resources.length;n++)u=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[n]);this._resourceInfo[u].dataSource.length>0&&(i=i*this._resourceInfo[u].dataSource.length)}else f=this._getResourceCollection(),f[f.length-1].dataSource.length>0&&(i=i*this.res1.length);for(n=0;n<i;n++)r.push(n);o=this.currentView()=="month"?1:0;e=this.timeCellTemplate.render({timerows:this._getStartEndTime(),cols1:[1,2],viewclass:o});s=t.buildTag("div#"+this._id+"_scroller");this.$WorkCellDiv=t.buildTag("div").css("position","relative").attr("class","e-draggableworkarea").css("height","100%");h=this.currentView()!=="month"?this.workcellTemp.render({cellrows:this._getWorkCellsCount(),cols1:r}):this.monthcellTemp.render({cellrows:this._getWorkCellsCount(),cols1:r});this.wTR.append(t.buildTag("td").append(c.append(l.append(a.append(v.append(this.$TimeCellTD.append(e)).append(p.append(s.append(this.$WorkCellDiv.append(h)))))))))},_getColumnCount:function(){for(var t=[],i=this.currentView()==="week"||this.currentView()==="month"?7:this.currentView()==="workweek"?5:1,n=0;n<i;n++)t.push(n);return t},_bindResourcesData:function(){if(!t.isNullOrUndefined(this.model.resources)){this._resourceInfo=[];for(var n=0;n<this.model.resources.length;n++)t.isNullOrUndefined(this.model.resources[n].resourceSettings)||(this.model.resources[n].resourceSettings.dataSource instanceof t.DataManager?this._initResourceData(this.model.resources[n].resourceSettings,n):this._resourceInfo.push(this.model.resources[n].resourceSettings))}},_bindAppointmentsData:function(){t.isNullOrUndefined(this.model.appointmentSettings)||this.dataSource()==null||(this.dataSource()instanceof t.DataManager&&!this.dataSource().dataSource.offline?this._initDataSource():(this._currentAppointmentData=this.dataSource(),!t.isNullOrUndefined(this.dataSource().dataSource)&&this.dataSource().dataSource.json&&(this._currentAppointmentData=this.dataSource().dataSource.json),this._dataCount=this._currentAppointmentData.length,this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll()))},_initResourceData:function(n){var t=this._columnToSelect(n),i=this,r=this.dataSource().executeQuery(t);r.done(function(t){n.dataSource=t.result;i._resourceInfo.push(n)})},_initDataSource:function(){var t=this._columnToSelect(this.model.appointmentSettings),n=this,i=this.dataSource().executeQuery(t);i.done(function(t){var u,f,e,i,r;for(e=(new Date).getTimezoneOffset(),i=n._minToHour(e),r=0;r<t.result.length;r++)u=t.result[r].StartTime,f=t.result[r].EndTime,u.setHours(u.getHours()-i.h,u.getMinutes()-i.m),f.setHours(f.getHours()-i.h,f.getMinutes()-i.m);n._currentAppointmentData=t.result;n._dataCount=t.result.length;n._overlapList=[];n._dataProcessing(t.result);n._renderAppointmentAll()})},_columnToSelect:function(n){var u=[],r=t.Query(),i;if(t.isNullOrUndefined(n.query)){for(i in n)i!=="tableName"&&i!=="query"&&i!=="dataSource"&&u.push(n[i]);u.length>0&&r.select(u);this.dataSource().dataSource.url.match(n.tableName+"$")||t.isNullOrUndefined(n.tableName)||r.from(n.tableName)}else r=n.query;return r},_sortAppById:function(n){var t=this;return n.sort(function(n,i){var r=n[t.model.appointmentSettings.id],u=i[t.model.appointmentSettings.id];return r<u?-1:r>u?1:0}),n},_dataProcessing:function(n){var i,t;if(this._processed=[],n.length>0){for(i=this._sortAppById(n),this._maxId=i[i.length-1][this.model.appointmentSettings.id]+1,t=0;t<n.length;t++)this._appointmentProcessing(n[t]);return this._processed=this._sortAppById(this._processed),this._processed}},_appointmentProcessing:function(i){var r=new Date(i[this.model.appointmentSettings.startTime]),f,u,s,h,o,a;if(this._rRule={},_count=0,_lastDay=!1,t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])||this.recurrenceRuleSplit(i[this.model.appointmentSettings.recurrenceRule]),i[this.model.appointmentSettings.recurrence]==1&&t.isNullOrUndefined(this._rRule.recurEditId)){if(f="",u=t.isNullOrUndefined(this._rRule.interval)?1:this._rRule.interval,t.isNullOrUndefined(this._rRule.weekDays)||(f=this._rRule.weekDays.split(",")),t.isNullOrUndefined(this._rRule.until))if(t.isNullOrUndefined(this._rRule.count))recurEndDate=new Date(new Date(this.currentDate()).setDate(r.getDate()+42*u));else switch(this._rRule.freq){case"DAILY":recurEndDate=new Date(new Date(r).setDate(r.getDate()+this._rRule.count*u));break;case"WEEKLY":s=r.getDate()+this._rRule.count/f.length*7*u;recurEndDate=new Date(new Date(r).setDate(Math.round(s)<s?s+1:s));break;case"MONTHLY":recurEndDate=new Date(new Date(r).setMonth(r.getMonth()+this._rRule.count*u));break;case"YEARLY":recurEndDate=new Date(new Date(r).setFullYear(r.getFullYear()+this._rRule.count*u))}else recurEndDate=new Date(this._rRule.until),recurEndDate.setDate(recurEndDate.getDate()+1);switch(this._rRule.freq){case"WEEKLY":f=this._rRule.weekDays.split(",");f.indexOf(this._dayNames[new Date(r).getDay()])==-1&&(r=this._weeklyDayFind(r,f));break;case"MONTHLY":if(t.isNullOrUndefined(this._rRule.monthDay))r=new Date(this._getWeekIndex(r)+1>this._rRule.setPositions&&this._rRule.setPositions!=-1?new Date(r.getFullYear(),r.getMonth()+1,1):r);else for(_lastDay=new Date(r).getDate()==new Date(r.getFullYear(),r.getMonth()+1,0).getDate()?!0:!1;new Date(r).getDate()!=this._rRule.monthDay;)r=new Date(r.setDate(r.getDate()+1));break;case"YEARLY":t.isNullOrUndefined(this._rRule.monthDay)?t.isNullOrUndefined(this._rRule.setPositions)||(r=new Date(r.getFullYear(),this._rRule.month-1,r.getDate()),r=new Date(this._getWeekIndex(r)+1>this._rRule.setPositions?new Date(r.getFullYear(),r.getMonth()+1,1):r)):r=r.getMonth()+1>=this._rRule.month&&r.getDate()>this._rRule.monthDay?new Date(r.getFullYear()+1,this._rRule.month-1,this._rRule.monthDay):new Date(r.getFullYear(),this._rRule.month-1,this._rRule.monthDay)}while(r<=recurEndDate){var c=new Date(i[this.model.appointmentSettings.startTime]),e={},l=new Date(i[this.model.appointmentSettings.endTime]);this._rRule.freq!="MONTHLY"&&this._rRule.freq!="YEARLY"||t.isNullOrUndefined(this._rRule.setPositions)||(r=this._dayOfWeekInMonth(r,this._rRule.weekDays,this._rRule.setPositions));h=new Date(r.getFullYear(),r.getMonth(),r.getDate(),c.getHours(),c.getMinutes(),0);o=new Date(r.getFullYear(),r.getMonth(),r.getDate(),l.getHours(),l.getMinutes(),0);t.isNullOrUndefined(this._rRule.exDate)?e=this._addAppData(i,this._maxId,h,o,i[this.model.appointmentSettings.id]):this._rRule.exDate.indexOf(Globalize.format(new Date(r),this._pattern.d))==-1&&(e=this._addAppData(i,this._maxId,h,o,i[this.model.appointmentSettings.id]));switch(this._rRule.freq){case"DAILY":r=new Date(r.setDate(r.getDate()+u));break;case"WEEKLY":a=this._dayNames[new Date(r).getDay()];f.length-1!=f.indexOf(a)?r=this._weeklyDayFind(r,f):(r=new Date(r.setDate(r.getDate()+r.getDay()*-1)),r=new Date(r.setDate(r.getDate()+u*7-1)),r=this._weeklyDayFind(r,f));break;case"MONTHLY":r=_lastDay?new Date(r.getFullYear(),r.getMonth()+u+1,0):t.isNullOrUndefined(this._rRule.setPositions)?new Date(r.setMonth(r.getMonth()+u)):new Date(r.getFullYear(),r.getMonth()+u,1);break;case"YEARLY":r=new Date(r.setFullYear(r.getFullYear()+u))}if(Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),this._pattern.d)<Globalize.format(new Date(i[this.model.appointmentSettings.endTime]),this._pattern.d)&&(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/36e5<24&&i[this.model.appointmentSettings.allDay]!==!0?(o.setDate(o.getDate()+1),this._multipleDayApp(e,this._maxId,new Date(e[this.model.appointmentSettings.startTime]),o)):n.isEmptyObject(e)||this._processed.push(e),this._maxId++,_count++,!t.isNullOrUndefined(this._rRule.count)&&_count==this._rRule.count)break}}Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),this._pattern.d)<Globalize.format(new Date(i[this.model.appointmentSettings.endTime]),this._pattern.d)&&(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/36e5<24&&i[this.model.appointmentSettings.allDay]!==!0&&i[this.model.appointmentSettings.recurrence]!=1?this._multipleDayApp(i,this._maxId,new Date(i[this.model.appointmentSettings.startTime]),new Date(i[this.model.appointmentSettings.endTime])):i[this.model.appointmentSettings.recurrence]!=0&&t.isNullOrUndefined(this._rRule.recurEditId)||(t.isNullOrUndefined(i.ParentId)&&(i.ParentId=i[this.model.appointmentSettings.id]),this._processed.push(i))},_multipleDayApp:function(n,t,i,r){for(var f=new Date(i),e=new Date(new Date(i).getFullYear(),new Date(i).getMonth(),new Date(i).getDate()),u=new Date(new Date(e).setHours(new Date(e).getHours()+24)),u=new Date(new Date(u).setMinutes(new Date(u).getMinutes()-1));f>=new Date(i)&&f<=u&&u<=new Date(r);)appointment=this._addAppData(n,t,f,u,n[this.model.appointmentSettings.id]),this._processed.push(appointment),f=new Date(new Date(u).setMinutes(new Date(u).getMinutes()+1)),u=new Date(n[this.model.appointmentSettings.endTime]),t++,this._maxId=t},_deleteOcurrence:function(n,i){var s=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,n),u=new t.DataManager(this._currentAppointmentData).executeLocal(s),e,f,r,o;if(!t.isNullOrUndefined(u)&&!t.isNullOrUndefined(u[0][this.model.appointmentSettings.recurrenceRule])){if(e=u[0][this.model.appointmentSettings.recurrenceRule],this.recurrenceRuleSplit(e),t.isNullOrUndefined(this._rRule.exDate))u[0][this.model.appointmentSettings.recurrenceRule]=e+";EXDATE="+Globalize.format(new Date(i),this._pattern.d);else{for(f=e.split(";"),recurRule="",r=0;r<f.length;r++)recurRule!=""&&(recurRule+=";"),o=f[r].replace(/ /g,"").split("="),o[0]=="EXDATE"&&(f[r]=f[r]+","+Globalize.format(new Date(i),this._pattern.d)),recurRule+=f[r];u[0][this.model.appointmentSettings.recurrenceRule]=recurRule}return u}},_getWeekIndex:function(n){var i=0,t=new Date(n.getFullYear(),n.getMonth(),1),r=n.getDay();if(r!=t.getDay())do t=new Date(t.setDate(t.getDate()+1));while(r!=t.getDay());while(t.getDate()!=n.getDate())t=new Date(t.setDate(t.getDate()+7)),i++;return i},_addAppData:function(n,i,r,u,f){var o={},e,s;for(e in this.model.appointmentSettings)if(e!="dataSource"&&e!="query"&&e!="tableName"&&e!="resourceFields"&&(o[this.model.appointmentSettings[e]]=n[this.model.appointmentSettings[e]]),e=="resourceFields")for(s in!t.isNullOrUndefined(this.model.appointmentSettings.resourceFields)&&this.model.appointmentSettings.resourceFields.split(","))o[this.model.appointmentSettings.resourceFields.split(",")[s]]=n[this.model.appointmentSettings.resourceFields.split(",")[s]];return t.isNullOrUndefined(i)||(o[this.model.appointmentSettings.id]=i),t.isNullOrUndefined(r)||(o[this.model.appointmentSettings.startTime]=r),t.isNullOrUndefined(u)||(o[this.model.appointmentSettings.endTime]=u),t.isNullOrUndefined(f)||(o.ParentId=f),o},_dayOfWeekInMonth:function(n,t,i){for(var u=this._dayNames.indexOf(t),r=i==-1?new Date(n.getFullYear(),n.getMonth()+1,0):new Date(n.getFullYear(),n.getMonth(),1);r.getDay()!=u;)r=new Date(i==-1?r.setDate(r.getDate()-1):r.setDate(r.getDate()+1));return new Date(i==1||i==-1?r:r.setDate(r.getDate()+(i-1)*7))},_weeklyDayFind:function(n,t){var i=n;do i=new Date(i.setDate(i.getDate()+1)),curDay=this._dayNames[new Date(i).getDay()];while(t.indexOf(curDay)==-1);return i},_renderAppointments:function(){var h=this._dateRender,e,t,f,a,o,i,r,u;if(this._tempapp=[],this.cellwidth=this.element.find(".e-workcells")[0].offsetWidth,e=this._currentAppointmentData,this.leftPosition=0,this.model.timeZone!=null){var s=this.model.timeZone.split(" ")[1].split(":"),c=parseInt(s[0]),l=parseInt(s[1]);for(dateMinutes=(new Date).getTimezoneOffset(),t=this._minToHour(dateMinutes+(c*60+l)),f=0;f<e.length;f++)temp=n.extend({},e[f]),sHour=new Date(temp.StartTime),eHour=new Date(temp.EndTime),temp.StartTime=new Date(sHour.setHours(sHour.getHours()+t.h,sHour.getMinutes()+t.m)),temp.EndTime=new Date(eHour.setHours(eHour.getHours()+t.h,eHour.getMinutes()+t.m)),this._tempapp.push(temp);this._dataProcessing(this._tempapp)}for(a=this._processed,o=[],this.model.group||(this.res1=["0"]),i=0;i<this.res1.length;i++){for(r=0;r<h.length;r++)for(this._getDayAppointments(r,i),u=0;u<this._appList.length;u++)this._renderApp(this._appList[u],r,i),o.push(this._appList[u]);this.model.enableAppointmentNavigation&&this._nextPrevButton(o)}},_getDayAppointments:function(n,i){var f,u,r;for(this._appList=[],f=this._dateRender,u=this._processed,r=0;r<u.length;r++)t.isNullOrUndefined(this.model.group)?Globalize.format(new Date(u[r][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(f[n]),this._pattern.d)&&Globalize.format(new Date(u[r][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(f[n]),this._pattern.d)&&Globalize.format(new Date(u[r][this.model.appointmentSettings.startTime]),this._pattern.d)==Globalize.format(new Date(u[r][this.model.appointmentSettings.endTime]),this._pattern.d)&&u[r][this.model.appointmentSettings.allDay]===!1&&Globalize.format(new Date(u[r][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(u[r][this.model.appointmentSettings.endTime]),this._pattern.d)&&this._appList.push(u[r]):Globalize.format(new Date(u[r][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(f[n]),this._pattern.d)&&u[r][this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]==this.res1[i].id&&Globalize.format(new Date(u[r][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(f[n]),this._pattern.d)&&Globalize.format(new Date(u[r][this.model.appointmentSettings.startTime]),this._pattern.d)==Globalize.format(new Date(u[r][this.model.appointmentSettings.endTime]),this._pattern.d)&&u[r][this.model.appointmentSettings.allDay]===!1&&Globalize.format(new Date(u[r][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(u[r][this.model.appointmentSettings.endTime]),this._pattern.d)&&this._appList.push(u[r])},_utc:function(t){this.element.hasClass("startutc")?n(".endutc").val(t.text):n(".startutc").val(t.text)},_rowHandlesOver:function(t){n(t.target).addClass("e-rowcursor")},_colHandlesOver:function(t){n(t.target).addClass("e-columncursor")},_renderApp:function(i,r,u){var a=this.element.find(".e-workcells")[0].offsetHeight,v=2,c=parseInt(this.model.startHour)<parseInt(this.model.endHour)?parseInt(this.model.startHour):0,h=parseInt(this.model.startHour)<parseInt(this.model.endHour)?parseInt(this.model.endHour):24,b=this._dateRender,o,y,f=new Date(i[this.model.appointmentSettings.startTime]),e=new Date(i[this.model.appointmentSettings.endTime]),k,l,p,d,s,w,g;if(f<=e&&(k=new Date(f).getHours()<c?new Date(f).getHours()+-new Date(f).getHours()+-new Date(f).getMinutes():new Date(f).getHours()+-c,l=new Date(e).getHours()>h?new Date(e).getHours()+(-new Date(e).getHours()+(h-c))+-new Date(e).getMinutes():new Date(e).getHours()+-c,l=new Date(e).getHours()==h?new Date(l).getMinutes()+-new Date(e).getMinutes():l,h<=e.getHours()?(p=new Date(e.setHours(h,00,00)),y=parseFloat(new Date(p).getHours()*60+new Date(p).getMinutes()-(new Date(f).getHours()*60+new Date(f).getMinutes()))*a*v/60-3):y=parseFloat(new Date(e).getHours()*60+new Date(e).getMinutes()-(new Date(f).getHours()*60+new Date(f).getMinutes()))*a*v/60-2,d=parseFloat(new Date(f).getMinutes())*a*v/60,this.model.startHour<=new Date(f).getHours())){s=this._overlapApp(i[this.model.appointmentSettings.id],i[this.model.appointmentSettings.startTime],i[this.model.appointmentSettings.endTime]);w=this;s.length>1?(s.sort(function(n,t){var i=new Date(n[w.model.appointmentSettings.startTime]),r=new Date(t[w.model.appointmentSettings.startTime]);return i-r}),g=s.indexOf(i),o=100/s.length+2,this.currentView()==="day"?o-=7:o,this.leftPosition=100/s.length*g+"%"):(this.leftPosition="0",o=95);o=this.currentView()==="week"||this.currentView()==="workweek"?o-10+"%":o+"%";var nt=t.isNullOrUndefined(this.model.resources)?{appointData:"",appointCustomcss:""}:this._getResourceColor(i),tt=this.model.appointmentTemplateId?!0:!1,it=this._getUserAppointmentTemplate(i),rt=this.model.timeMode=="12"?Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),this._pattern.t):Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"HH:mm"),ut=this.model.timeMode=="12"?Globalize.format(new Date(i[this.model.appointmentSettings.endTime]),this._pattern.t):Globalize.format(new Date(i[this.model.appointmentSettings.endTime]),"HH:mm"),ft=this.appTemplate.render({id:i[this.model.appointmentSettings.id],appHeight:y,rtl:this.model.enableRTL,subject:i[this.model.appointmentSettings.subject],startTime:rt,endTime:ut,left:this.leftPosition,top:d,appWidth:o,userAppTemplId:tt,userTemplate:it,appClass:"e-appointment",appointData:nt.appointData,appointCustomcss:nt.appointCustomcss});n(this.element.find("div.e-appointwrapper")[k*2*b.length*this.res1.length+r+b.length*u]).append(ft)}},_getUserAppointmentTemplate:function(t){var i=n.templates(n(this.model.appointmentTemplateId).html());return i.render(t)},_overlapApp:function(n,t,i){this.overlapList=[];for(var r=0;r<this._appList.length;r++)new Date(this._appList[r][this.model.appointmentSettings.endTime])>new Date(t)&&new Date(this._appList[r][this.model.appointmentSettings.startTime])<new Date(i)&&Globalize.format(new Date(this._appList[r][this.model.appointmentSettings.startTime]),this._pattern.d)===Globalize.format(new Date(t),this._pattern.d)&&this.overlapList.push(this._appList[r]);return this.overlapList},_renderAllDayAppointments:function(){var f=this.cellwidth-20,u=this._dateRender,r,i,n;for(this.level=0,this.model.group||(this.res1=["0"]),r=0;r<this.res1.length;r++)for(i=0;i<u.length;i++)for(n=0;n<this._processed.length;n++)t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)?Globalize.format(new Date(u[i]),this._pattern.d)==Globalize.format(new Date(this._processed[n][this.model.appointmentSettings.startTime]),this._pattern.d)&&(this._processed[n][this.model.appointmentSettings.allDay]===!0||Globalize.format(new Date(this._processed[n][this.model.appointmentSettings.startTime]),this._pattern.d)<Globalize.format(new Date(this._processed[n][this.model.appointmentSettings.endTime]),this._pattern.d))&&this._setAllDayPos(this._processed[n],i,r):Globalize.format(new Date(u[i]),this._pattern.d)==Globalize.format(new Date(this._processed[n][this.model.appointmentSettings.startTime]),this._pattern.d)&&this._processed[n][this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]==this.res1[r].id&&(this._processed[n][this.model.appointmentSettings.allDay]===!0||Globalize.format(new Date(this._processed[n][this.model.appointmentSettings.startTime]),this._pattern.d)<Globalize.format(new Date(this._processed[n][this.model.appointmentSettings.endTime]),this._pattern.d))&&this._setAllDayPos(this._processed[n],i,r)},_getOverlapCount:function(n,t,i){for(var e,o,s=i.length,u=this._processed,f=[],r=0;r<u.length;r++)Globalize.format(new Date(u[r][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(i[t]),this._pattern.d)&&Globalize.format(new Date(u[r][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(i[t]),this._pattern.d)&&(u[r][this.model.appointmentSettings.allDay]==!0||Globalize.format(new Date(u[r][this.model.appointmentSettings.startTime]),this._pattern.d)<Globalize.format(new Date(u[r][this.model.appointmentSettings.endTime]),this._pattern.d))&&Globalize.format(new Date(u[r][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(u[r][this.model.appointmentSettings.endTime]),this._pattern.d)&&f.push(u[r]);return e=this,f.sort(function(n,t){var i=new Date(n[e.model.appointmentSettings.startTime]),r=new Date(t[e.model.appointmentSettings.startTime]);return i-r}),o=f.length>0?f.indexOf(n):0,o==-1?0:o},_setAllDayPos:function(i,r,u){var f=this._getOverlapCount(i,r,this._dateRender),e=Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),this._pattern.d),o=Globalize.format(new Date(i[this.model.appointmentSettings.endTime]),this._pattern.d),w;if(new Date(e)<=new Date(o)){var s=this._dateRender,c,b=0,h=15,l=15,k=Globalize.format(new Date(s[0]),this._pattern.d),a=Globalize.format(new Date(s[s.length-1]),this._pattern.d);o=new Date(o)>new Date(a)?a:o;var ut=Math.ceil((new Date(e)-new Date(k))/864e5),v=Math.ceil((new Date(o)-new Date(e))/864e5)+1,y=this.element.find(".e-alldaycells").width(),d=this.model.currentView==="week"?7:this.model.currentView==="workweek"?5:1,g=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.model.group.resources.length:0,nt=this.model.currentView==="day"?0:this.model.currentView==="workweek"?new Date(e).getDay()-1:new Date(e).getDay(),b=this.element.find(".e-alldaycells")[nt+u*d].offsetLeft;c=v*y-v*y*(20/100);h=f*h+3*(f+1)+this.element.find(".e-headercells").height()+3+g*n(n(".e-headerbar")[0]).height();var p=t.isNullOrUndefined(this.model.resources)?{appointData:"",appointCustomcss:""}:this._getResourceColor(i),tt=this.model.appointmentTemplateId?!0:!1,it=this._getUserAppointmentTemplate(i),rt=this.appTemplate.render({id:i[this.model.appointmentSettings.id],top:h,appHeight:l,rtl:this.model.enableRTL,subject:i[this.model.appointmentSettings.subject],startTime:Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),this._pattern.t),endTime:Globalize.format(new Date(i[this.model.appointmentSettings.endTime]),this._pattern.t),appWidth:c+"px",allday:!0,left:b+"px",userAppTemplId:tt,userTemplate:it,appClass:"e-alldayappointment",appointData:p.appointData,appointCustomcss:p.appointCustomcss});this.level<f&&(w=(f+1)*(l+3)+3,this.element.find(".e-alldaycells").css("height",w+"px"));this.element.find(".e-headrealldaytable").parent().append(rt);this.level=this.level<f?f:this.level}},_renderMonthAppointment:function(){var u=[],s=[],f=this._dateRender,i=this._processed,e,r,n,o;for(this.model.group||(this.res1=["0"]),e=0;e<this.res1.length;e++)for(r=0;r<f.length;r++){for(u=[],n=0;n<i.length;n++)t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)?Globalize.format(new Date(f[r]),this._pattern.d)==Globalize.format(new Date(i[n][this.model.appointmentSettings.startTime]),this._pattern.d)&&Globalize.format(new Date(f[r]),this._pattern.d)<=Globalize.format(new Date(i[n][this.model.appointmentSettings.endTime]),this._pattern.d)&&Globalize.format(new Date(i[n][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(i[n][this.model.appointmentSettings.endTime]),this._pattern.d)&&u.push(i[n]):Globalize.format(new Date(f[r]),this._pattern.d)==Globalize.format(new Date(i[n][this.model.appointmentSettings.startTime]),this._pattern.d)&&i[n][this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]==this.res1[e].id&&Globalize.format(new Date(f[r]),this._pattern.d)<=Globalize.format(new Date(i[n][this.model.appointmentSettings.endTime]),this._pattern.d)&&Globalize.format(new Date(i[n][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(i[n][this.model.appointmentSettings.endTime]),this._pattern.d)&&u.push(i[n]);for(o=0;o<u.length;o++)this._renderAppointmentMonth(u[o],r,e),s.push(u[o])}this.model.enableAppointmentNavigation&&this._nextPrevButton(s)},_wireResizeEvents:function(){this.model.enableAppointmentResize&&(this._on(this.element.find("div.e-lefthandle,div.e-righthandle,div.e-tophandle,div.e-bottomhandle"),"mousedown",n.proxy(this._appointmentResizeStart,this)),this._on(this.element.find("div.e-lefthandle,div.e-righthandle"),"mouseover",n.proxy(this._colHandlesOver,this)),this._on(this.element.find("div.e-tophandle,div.e-bottomhandle"),"mouseover",n.proxy(this._rowHandlesOver,this)))},_unWireResizeEvents:function(){this.model.enableAppointmentResize&&(this._off(this.element.find("div.e-lefthandle,div.e-righthandle,div.e-tophandle,div.e-bottomhandle"),"mousedown",n.proxy(this._appointmentResizeStart,this)),this._off(this.element.find("div.e-lefthandle,div.e-righthandle"),"mouseover",n.proxy(this._colHandlesOver,this)),this._off(this.element.find("div.e-tophandle,div.e-bottomhandle"),"mouseover",n.proxy(this._rowHandlesOver,this)))},_getIndex:function(n,t,i,r){var e=this,o,f,u;for(r.sort(function(n,t){var i=new Date(n[e.model.appointmentSettings.startTime]),r=new Date(t[e.model.appointmentSettings.startTime]);return i-r}),o=i.length,f=[],u=0;u<r.length;u++)Globalize.format(new Date(r[u][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(i[n]),this._pattern.d)&&Globalize.format(new Date(r[u][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(i[n]),this._pattern.d)&&Globalize.format(new Date(r[u][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(r[u][this.model.appointmentSettings.endTime]),this._pattern.d)&&f.push(r[u]);return this.overlapList=f,f.length>0?f.indexOf(t):0},_renderAppointmentMonth:function(i,r){var o=this._dateRender,y=this._getIndex(r,i,o,this._processed),s=new Date(i[this.model.appointmentSettings.startTime]),c=new Date(i[this.model.appointmentSettings.endTime]),e,l,u,p,a,f,k,v;if(s<=c){if(e=18,u=0,this.leftPosition=0,this.CellWidth=this.element.find(".e-monthcells").width(),this.CellHeight=this.element.find(".e-monthcells").height(),p=Math.ceil((r+1)/7),Globalize.format(s,this._pattern.d)!=Globalize.format(c,this._pattern.d)){var it=new Date(o[0]),w=new Date(o[o.length-1]),b=Globalize.format(s,this._pattern.d),h=Globalize.format(c,this._pattern.d);h=new Date(h)>new Date(w)?w:h;a=7-new Date(b).getDay();f=Math.ceil((new Date(h)-new Date(b))/864e5)+1;f=f>=a?a:f;l=f*this.CellWidth-15-f}else l=this.CellWidth*6/7;if(k=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?this._findResourceIndex(this.res1,"id",i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):0,v=k*7+(new Date(s).getDay()+1)+(p-1)*this.res1.length*7,u=y*e,this.leftPosition=0,y*(e+21)<this.CellHeight){e-=2;u>1&&(u-=1);this.leftPosition>1&&(this.leftPosition-=1);var d=t.isNullOrUndefined(this.model.resources)?{appointData:"",appointCustomcss:""}:this._getResourceColor(i),nt=this.model.appointmentTemplateId?!0:!1,tt=this._getUserAppointmentTemplate(i),g=this.appTemplate.render({id:i[this.model.appointmentSettings.id],appHeight:e,rtl:this.model.enableRTL,subject:i[this.model.appointmentSettings.subject],startTime:Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),this._pattern.t),endTime:Globalize.format(new Date(i[this.model.appointmentSettings.endTime]),this._pattern.t),left:this.leftPosition+"px",top:u,appWidth:l+"px",userAppTemplId:nt,userTemplate:tt,appClass:"e-monthappointment",appointData:d.appointData,appointCustomcss:d.appointCustomcss});n(this.element.find("div.e-appointwrapper")[v-1]).append(g);g=""}else n("#"+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")).length==0&&(n(this.element.find("div.e-appointwrapper")[v-1]).append('<div id="'+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+'" class="e-icon e-appsoverflow"><\/div>'),this.element.find("#"+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")).css(this.model.enableRTL?"right":"left",this.CellWidth+this.leftPosition-25+"px").css("top",u+"px"))}},_getResourceColor:function(n){var i,r="",u="";return t.isNullOrUndefined(this.model.group)?(i=this._findResourceIndex(this.render_Resources[this.render_Resources.length-1],"id",n[this.model.appointmentSettings.resourceFields.split(",")[this.model.appointmentSettings.resourceFields.split(",").length-1]]),t.isNullOrUndefined(i)||(r=t.isNullOrUndefined(this.render_Resources[this.render_Resources.length-1][i].color)?r:this.render_Resources[this.render_Resources.length-1][i].color,u=t.isNullOrUndefined(this.render_Resources[this.render_Resources.length-1][i].appointmentClass)?u:this.render_Resources[this.render_Resources.length-1][i].appointmentClass)):(i=this._findResourceIndex(this.render_Resources[0],"id",n[this.model.appointmentSettings.resourceFields.split(",")[0]]),t.isNullOrUndefined(i)||(r=t.isNullOrUndefined(this.render_Resources[0][i].color)?r:this.render_Resources[0][i].color,u=t.isNullOrUndefined(this.render_Resources[0][i].appointmentClass)?u:this.render_Resources[0][i].appointmentClass)),{appointData:r,appointCustomcss:u}},_quickWindowClose:function(){this._quickAppointWindow.ejDialog("close");this._processFocus()},_appointmentWindow:function(i){var c={startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,target:i},u,f,r,e,l,o,s,a,h;if(this._trigger("cellDoubleClick",c))return!1;if(r=t.isNullOrUndefined(i.target)?n(i):n(i.target),r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells")||this._cellClick||r.hasClass("e-detailedapp")){if(this._currentAction=t.Schedule.Actions.Add,this._appointmentAddWindow.find(".e-recurwindow").css("display","none"),this._appointmentAddWindow.find(".e-appwindow").css("display","block"),e=r.hasClass("e-workcells")?r.index():r.hasClass("e-alldaycells")?r.index()-1:7-((parseInt(r.index()/7)+1)*7-r.index())+r.parent().index()*7,this._cellClick?(u=new Date(this.cur_StartTime),f=new Date(this.cur_EndTime)):(this.currentDate(new Date(this.dateRender[e])),r.hasClass("e-workcells")?(l=this.model.startHour+r.parent().index()/2,o=l.toString().split("."),u=new Date(this.currentDate()).setHours(parseInt(o[0]),parseInt(o[1])==5?30:00),f=new Date(new Date(u).setMinutes(new Date(u).getMinutes()+30))):r.hasClass("e-monthcells")?(u=new Date(new Date(this.currentDate()).setHours(9)),u=new Date(u).setMinutes(00),f=new Date(new Date(u).setMinutes(30))):(u=new Date(this.currentDate()),f=new Date(u),this._appointmentAddWindow.find(".allday ").ejCheckBox({checked:!0}))),this._trigger("appointmentWindowOpen",c))return!1;this._appointmentAddWindow.find("#"+this._id+"subject").val(this.model.showQuickWindow?this._quickAppointWindow.find(".subject").val():"");this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",Globalize.format(new Date(u),this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",Globalize.format(new Date(u),this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(new Date(u),this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(new Date(f),this._pattern.t));(n(i.currentTarget).hasClass("e-alldaycells")||this.currentView()=="month")&&this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0});this._alldayCheck();this.model.timeZone==null?(document.getElementById("startutc").value="UTC "+Globalize.format(new Date,"zzz"),document.getElementById("endutc").value="UTC "+Globalize.format(new Date,"zzz")):(document.getElementById("startutc").value=this.model.timeZone,document.getElementById("endutc").value=this.model.timeZone);this._renderResourceData(r,e);this._appointmentAddWindow.ejDialog("open");this._appointmentAddWindow.find(".subject").focus();this._cellClick=!1}else s=this._editKey?n(i):r.hasClass("e-appointment")||r.hasClass("e-monthappointment")||r.hasClass("e-alldayappointment")?r:r.parents(".e-monthappointment,.e-appointment,.e-alldayappointment"),t.isNullOrUndefined(s[0].id)||(this._currentAction=t.Schedule.Actions.Save,this._appId=parseInt(s[0].id.split("_")[1]),a=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),h=new t.DataManager(this._processed).executeLocal(a),h[0][this.model.appointmentSettings.recurrence]==1?(this._parentId=h[0].ParentId,this._recurEditWindow.find(".e-editonly").ejRadioButton({checked:!0}),this._recurEditWindow.ejDialog("open"),this._recurEditWindow.focus()):this._showAppointmentDetails(this._appId),this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close")),this._editKey=!1;this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")},_editRecurrence:function(){this._appointmentAddWindow.find(".e-appwindow").toggle();this._appointmentAddWindow.find(".e-recurwindow").css("margin-left",700).toggle().animate({"margin-left":10},300)},_showAppointmentDetails:function(i,r){var v=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,parseInt(i)),d=r==!0?this._processed:this._currentAppointmentData,f=new t.DataManager(d).executeLocal(v),u,b,c,a,s,e,h,o,k;if(this._appointmentAddWindow.find(".subject").val(f[0][this.model.appointmentSettings.subject]),this._appointmentAddWindow.find(".id").val(f[0][this.model.appointmentSettings.id]),this._appointmentAddWindow.find(".e-description").val(f[0][this.model.appointmentSettings.description]?f[0][this.model.appointmentSettings.description]:""),u=n.extend({},f[0]),this.model.timeZone!=null&&!r){var w=this.model.timeZone.split(" ")[1].split(":"),g=parseInt(w[0]),nt=parseInt(w[1]);dateMinutes=(new Date).getTimezoneOffset();var l=this._minToHour(dateMinutes+(g*60+nt)),y=new Date(u.StartTime),p=new Date(u.EndTime);u.StartTime=new Date(y.setHours(y.getHours()+l.h,y.getMinutes()+l.m));u.EndTime=new Date(p.setHours(p.getHours()+l.h,p.getMinutes()+l.m))}if(this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),this._pattern.d)),this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),this._pattern.d)),this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),this._pattern.t)),this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),this._pattern.t)),this.model.timeZone==null?(this._appointmentAddWindow.find("#startutc").val("UTC "+Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"zzz")),this._appointmentAddWindow.find("#endutc").val("UTC "+Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),"zzz"))):(this._appointmentAddWindow.find("#startutc").val(this.model.timeZone),this._appointmentAddWindow.find("#endutc").val(this.model.timeZone)),f[0][this.model.appointmentSettings.allDay]==1&&this._appointmentAddWindow.find(".allday ").ejCheckBox({checked:!0}),f[0][this.model.appointmentSettings.recurrence]==1&&(r==!0?(t.isNullOrUndefined(f[0][this.model.appointmentSettings.recurrenceRule])||f[0][this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")==-1||(this._currentAction=t.Schedule.Actions.Save),this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0,enabled:!1}),this._appointmentAddWindow.find(".e-repeatlbl").addClass("e-disable"),this._appointmentAddWindow.find("#"+this._id+"summary").css("display","none"),this._appointmentAddWindow.find(".e-recurFinalRule").html(""),this._recRule=f[0][this.model.appointmentSettings.recurrenceRule]):(this.recurrenceRuleSplit(f[0][this.model.appointmentSettings.recurrenceRule]),this._appointmentAddWindow.find(".recurstartdate").ejDatePicker({value:Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),this._pattern.d)}),this._appointmentAddWindow.find("#"+this._id+"summary").css("display","table-row"),this._appointmentAddWindow.find(".e-recurFinalRule").html(this._showRecurrenceFields(i)),this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0}),this._appointmentAddWindow.find(".e-recuredit").css("display","inline"))),!t.isNullOrUndefined(this.model.resources)&&(a=[],this.model.resources.length>0)){for(s=this._getResourceCollection(),o=0;o<s.length;o++)this._appointmentAddWindow.find(".owner_"+o).ejAutocomplete("clearText");for(e=0;e<this.render_Resources.length-1;e++){for(b=this.render_Resources[e+1]instanceof t.DataManager?this.render_Resources[e+1]:t.DataManager(this.render_Resources[e+1]),v=(new t.Query).where("groupId",t.FilterOperators.equal,u[this.model.appointmentSettings.resourceFields.toString().split(",")[e]]),c=b.executeLocal(v),a=[],h=0;h<c.length;h++)a.push({text:c[h][s[e+1].text],value:c[h][s[e+1].id],color:c[h][s[e+1].color]});this._appointmentAddWindow.find(".owner_"+(e+1)).ejAutocomplete("clearText");this._appointmentAddWindow.find(".owner_"+(e+1)).ejAutocomplete("option","dataSource",a)}for(o=0;o<s.length;o++)this._appointmentAddWindow.find(".owner_"+o).data("ejAutocomplete").selectValueByKey(u[this.model.appointmentSettings.resourceFields.toString().split(",")[o]])}if(k={appointment:f[0],edit:r},this._trigger("appointmentWindowOpen",k))return!1;this._alldayCheck();this._appointmentAddWindow.ejDialog("open");this._appointmentAddWindow.find(".subject").focus()},_showRecurrenceFields:function(){var n="",i="",f=this._appointmentAddWindow.find(".recurtype"),u,r;n=t.isNullOrUndefined(this._rRule.interval)?this._getLocalizedLabels("Every")+" ":this._getLocalizedLabels("Every")+" "+this._rRule.interval+" ";switch(this._rRule.freq){case"DAILY":f.ejDropDownList({selectedItemIndex:0});n+=this._getLocalizedLabels("RecurrenceDay").toLowerCase();break;case"WEEKLY":for(f.ejDropDownList({selectedItemIndex:1}),this._appointmentAddWindow.find(".weekdays").ejCheckBox({checked:!1}),u=this._rRule.weekDays.split(","),r=0;r<u.length;r++)this._appointmentAddWindow.find(".e-weekly"+u[r]).ejCheckBox({checked:!0}),i+=this._dayShortNames[this._dayNames.indexOf(u[r])]+(r==u.length-1?"":", ");n+=this._getLocalizedLabels("RecurrenceWeek").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+i;break;case"MONTHLY":f.ejDropDownList({selectedItemIndex:2});t.isNullOrUndefined(this._rRule.monthDay)?(this._appointmentAddWindow.find(".e-monthposition").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-monthsrtday").ejDropDownList({selectedItemIndex:this._dayNames.indexOf(this._rRule.weekDays)}),this._appointmentAddWindow.find(".monthsrt").ejDropDownList({selectedItemIndex:this._rRule.setPositions-1}),i=this._appointmentAddWindow.find(".monthsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[this._dayNames.indexOf(this._rRule.weekDays)]):(this._appointmentAddWindow.find(".e-monthdaytype").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-monthdate").ejNumericTextbox({value:parseInt(this._rRule.monthDay)}),i=parseInt(this._rRule.monthDay));n+=this._getLocalizedLabels("RecurrenceMonth").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+i;break;case"YEARLY":f.ejDropDownList({selectedItemIndex:3});t.isNullOrUndefined(this._rRule.monthDay)?(this._appointmentAddWindow.find(".e-yearrecurposi").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".yearsrtday").ejDropDownList({selectedItemIndex:this._dayNames.indexOf(this._rRule.weekDays)}),this._appointmentAddWindow.find(".yearsrtmonth").ejDropDownList({selectedItemIndex:this._rRule.month-1}),this._appointmentAddWindow.find(".yearsrt").ejDropDownList({selectedItemIndex:this._rRule.setPositions-1}),i=this._appointmentAddWindow.find(".yearsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[this._dayNames.indexOf(this._rRule.weekDays)]+" "+this._monthNames[this._rRule.month-1]):(this._appointmentAddWindow.find(".e-yearrecurday").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".yearmonth").ejDropDownList({selectedItemIndex:this._rRule.month-1}),this._appointmentAddWindow.find(".yeardate").ejNumericTextbox({value:parseInt(this._rRule.monthDay)}),i=this._monthNames[this._rRule.month-1]+" "+parseInt(this._rRule.monthDay));n+=this._getLocalizedLabels("RecurrenceYear").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+i}return this._appointmentAddWindow.find(".e-recurevery").ejNumericTextbox({value:t.isNullOrUndefined(this._rRule.interval)?1:this._rRule.interval}),t.isNullOrUndefined(this._rRule.count)?t.isNullOrUndefined(this._rRule.until)?this._appointmentAddWindow.find(".e-recurnoend").ejRadioButton({checked:!0}):(this._appointmentAddWindow.find(".e-recuruntil").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-until").ejDatePicker({value:new Date(this._rRule.until)}),n+=" "+this._getLocalizedLabels("Until").toLowerCase()+" "+Globalize.format(new Date(this._rRule.until),this._pattern.d)):(this._appointmentAddWindow.find(".e-recurafter").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-recurcount").ejNumericTextbox({value:this._rRule.count}),n+=", "+this._rRule.count+this._getLocalizedLabels("Times").toLowerCase()),n},_closerecur:function(t){var i,c,s,u,f,w,r,e,o,y,h,p,b,k;if(t.model.text=="Cancel")this._appointmentAddWindow.find(".e-recurFinalRule").html()==""&&this._appointmentAddWindow.find("#"+this._id+"recurrence").ejCheckBox({checked:!1});else{s="";u="";i=this._findInterval(this._appointmentAddWindow.find(".e-recurevery"));switch(this._rRuleFreq){case"DAILY":this._recRule="FREQ="+this._rRuleFreq+";INTERVAL="+i;break;case"WEEKDAYS":this._recRule="FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR";break;case"WEEKLY":var l=this._appointmentAddWindow.find("input[name='weekdays']"),a="",v="";for(f=0;f<l.length;f++)n(l[f]).ejCheckBox("option","checked")==!0?a+=(a!=""?",":"")+this._dayNames[f].toUpperCase():"",n(l[f]).ejCheckBox("option","checked")==!0?v+=(v!=""?", ":"")+this._dayShortNames[f]:"";w=this._getLocalizedLabels("RecurrenceWeek").toLowerCase()+" on "+v;this._appointmentAddWindow.find(".e-recurRule").html(w);this._recRule="FREQ="+this._rRuleFreq+";INTERVAL="+i+";BYDAY="+a;break;case"MONTHLY":this._appointmentAddWindow.find(".e-monthdaytype").ejRadioButton("option","checked")?(c=this._appointmentAddWindow.find(".e-monthdate").ejNumericTextbox("option","value"),this._recRule="FREQ="+this._rRuleFreq+";BYMONTHDAY="+c+";INTERVAL="+i,u=" "+this._getLocalizedLabels("On").toLowerCase()+" "+c):(r=this._appointmentAddWindow.find(".monthsrt").ejDropDownList("option","selectedItemIndex"),e=this._appointmentAddWindow.find(".e-monthsrtday").ejDropDownList("option","selectedItemIndex"),r=r<4?r+1:-1,this._recRule="FREQ="+this._rRuleFreq+";BYDAY="+this._dayNames[e]+";BYSETPOS="+r+";INTERVAL="+i,u=" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._appointmentAddWindow.find(".monthsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[e]);break;case"YEARLY":if(this._appointmentAddWindow.find("#"+this._id+"yearday").ejRadioButton("option","checked"))o=this._appointmentAddWindow.find(".yearmonth").ejDropDownList("option","selectedItemIndex"),y=this._findInterval(this._appointmentAddWindow.find(".yeardate")),this._recRule="FREQ="+this._rRuleFreq+";BYMONTHDAY="+y+";BYMONTH="+(o+1)+";INTERVAL="+i,u=" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._monthNames[o]+" "+y;else{var r=this._appointmentAddWindow.find(".yearsrt").ejDropDownList("option","selectedItemIndex"),o=this._appointmentAddWindow.find(".yearsrtmonth").ejDropDownList("option","selectedItemIndex"),e=this._appointmentAddWindow.find(".yearsrtday").ejDropDownList("option","selectedItemIndex");r=r<4?r+1:-1;this._recRule="FREQ="+this._rRuleFreq+";BYDAY="+this._dayNames[e]+";BYMONTH="+(o+1)+";BYSETPOS="+r+";INTERVAL="+i;u=" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._appointmentAddWindow.find(".yearsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[e]+" "+this._monthNames[o]}}this._appointmentAddWindow.find(".e-recurafter").ejRadioButton("option","checked")?(h=this._findInterval(this._appointmentAddWindow.find(".e-recurcount")),this._recRule+=";COUNT="+h,s=h?", "+h+" "+this._getLocalizedLabels("Times"):", "):this._appointmentAddWindow.find(".e-recuruntil").ejRadioButton("option","checked")&&(p=Globalize.format(new Date(this._appointmentAddWindow.find(".e-until").ejDatePicker("option","value")),this._pattern.d),this._recRule+=";UNTIL="+p,s=" "+this._getLocalizedLabels("Until").toLowerCase()+" "+p);b=(this._rRuleFreq!="WEEKDAYS"?this._getLocalizedLabels("Every"):"")+" "+(i>1?i+" ":"");k=b+this._appointmentAddWindow.find(".e-recurRule").html()+u+s;this._appointmentAddWindow.find("#"+this._id+"summary").css("display","table-row");this._appointmentAddWindow.find(".e-recurFinalRule").html(k);this._appointmentAddWindow.find(".e-recuredit").css("display","inline");u=""}this._appointmentAddWindow.find(".e-recurwindow").toggle();this._appointmentAddWindow.find(".e-appwindow").css("margin-left",700).toggle().animate({"margin-left":10},300);this._appointmentAddWindow.find(".done").focus()},_recurDateChange:function(n){this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",n.value);this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",n.value)},_findInterval:function(n){var i;return i=n.ejNumericTextbox("option","value"),t.isNullOrUndefined(i)?0:i},_cancel:function(){this._appointmentAddWindow.ejDialog("close")},_timeChange:function(i){var r,u;if(this._currentAction!=t.Schedule.Actions.Add)return!1;r=this._appointmentAddWindow.find("#"+this._id+"starttime").data("ejTimePicker");r.showDropdown&&r._id==this._id+"starttime"&&(u=n("#"+this._id+"starttime_popup").find("li.e-active").next("li").html(),document.getElementById(this._id+"endtime").value=t.isNullOrUndefined(u)?i.value:u)},_renderControls:function(){var i=this._appointmentAddWindow,f,e,r,u;if(i.find(".allday").ejCheckBox({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass,change:n.proxy(this._alldayCheck,this)}),i.find(".startenddate").ejDatePicker({enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,cssClass:this.model.cssClass}),i.find(".startendtime").ejTimePicker({enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,change:n.proxy(this._timeChange,this),cssClass:this.model.cssClass}),i.find(".startutc").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:this.model.timezoneCollection,fields:{text:"text",value:"value"},width:"100%",change:this._utc,cssClass:this.model.cssClass}),i.find(".endutc").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:this.model.timezoneCollection,fields:{text:"text",value:"value"},width:"100%",change:this._utc,cssClass:this.model.cssClass}),!t.isNullOrUndefined(this.model.resources))for(f=this._getResourceCollection(),e=[],r=0;r<f.length;r++){for(e=[],u=0;u<this.render_Resources[r].length;u++)e.push({text:this.render_Resources[r][u][f[r].text],value:this.render_Resources[r][u][f[r].id],color:this.render_Resources[r][u][f[r].color]});this.model.resources[r].allowMultiple?i.find(".owner_"+r).ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:"visualmode",dataSource:e,fields:{text:"text",key:"value"},change:this._onResourceChange,template:this.resourceTemplate}):i.find(".owner_"+r).ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"275px",cssClass:this.model.cssClass,multiSelectMode:"none",dataSource:e,fields:{text:"text",key:"value"},change:this._onResourceChange,template:this.resourceTemplate})}i.find(".recurrence").ejCheckBox({enableRTL:this.model.enableRTL,change:n.proxy(this._repeat,this),cssClass:this.model.cssClass});i.find(".e-btndone").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._saveAppointment,this),cssClass:this.model.cssClass});i.find(".cancel").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._cancel,this),cssClass:this.model.cssClass});i.find(".recurtype").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"recurtypelist",width:"100%",select:n.proxy(this._recurtype,this),cssClass:this.model.cssClass});i.find(".dailyrecurtype").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-dailyeveryday").ejRadioButton({enableRTL:this.model.enableRTL,checked:!0,cssClass:this.model.cssClass});i.find(".everydaycount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"everydaycount",minValue:1,value:1,width:"100px",float:"left",cssClass:this.model.cssClass});i.find(".recurends").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-recurcount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"dailyoccurance",minValue:1,value:10,width:"65px",cssClass:this.model.cssClass,change:n.proxy(this._endAfterChange,this)});i.find(".weekcount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"weekcount",minValue:1,value:1,width:"100px",cssClass:this.model.cssClass});i.find(".e-recurevery").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"recurevery",minValue:1,value:1,width:"100px",cssClass:this.model.cssClass});i.find(".weekdays").ejCheckBox({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-monthposition").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-monthdaytype").ejRadioButton({enableRTL:this.model.enableRTL,checked:!0,cssClass:this.model.cssClass});i.find(".e-monthdate").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"monthdate",minValue:1,maxValue:31,value:1,width:"70px",cssClass:this.model.cssClass,change:n.proxy(this._monthDateChange,this)});i.find(".monthnumber").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"monthnumber",minValue:1,value:1,width:"70px",cssClass:this.model.cssClass});i.find(".yearcount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"yearcount",minValue:1,value:1,width:"50px",cssClass:this.model.cssClass});i.find(".e-yearrecurposi,.e-yearrecurday").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".yeardate").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"yeardate",minValue:1,maxValue:31,value:1,width:"70px",cssClass:this.model.cssClass,change:n.proxy(this._yearDateChange,this)});i.find(".recurbutton").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._closerecur,this),cssClass:this.model.cssClass});i.find(".monthsrt").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"monthsrtlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._monthDayChange,this)});i.find(".e-monthsrtday").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"monthsrtdaylist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._monthDayChange,this)});i.find(".yearsrt").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearsrtlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDayChange,this)});i.find(".yearmonth").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearmonthlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDateChange,this)});i.find(".yearsrtday").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearsrtdaylist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDayChange,this)});i.find(".yearsrtmonth").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearsrtmonthlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDayChange,this)});i.find(".recurstartdate").ejDatePicker({enableRTL:this.model.enableRTL,locale:this.model.locale,cssClass:this.model.cssClass,change:n.proxy(this._recurDateChange,this)});i.find(".e-until").ejDatePicker({enableRTL:this.model.enableRTL,locale:this.model.locale,cssClass:this.model.cssClass,change:n.proxy(this._endOnChange,this)})},_onResourceChange:function(i){var nt=n("#"+this._id.toString().split("_")[0]),u=nt.ejSchedule("instance"),p=parseInt(this._id.toString().split("_")[2]),tt=u._appointmentAddWindow.find(".owner_"+p).ejAutocomplete("option","multiSelectMode"),s=this.getSelectedItems(),f=u._getResourceCollection(),d,g,b,v,l,c,y,h,o;if(p<u.render_Resources.length-1&&s.length>0){var r=p+1,w=u.render_Resources[r-1]instanceof t.DataManager?u.render_Resources[r-1]:t.DataManager(u.render_Resources[r-1]),k=u.render_Resources[r]instanceof t.DataManager?u.render_Resources[r]:t.DataManager(u.render_Resources[r]);if(tt=="none"){if(t.isNullOrUndefined(i.value)||(d=(new t.Query).where("text",t.FilterOperators.equal,i.value),g=w.executeLocal(d)),b=!i.value||t.isNullOrUndefined(i.value)||g.length<=0?s[0].value:s[1].value,!t.isNullOrUndefined(b)){var l=(new t.Query).where("id",t.FilterOperators.equal,b),c=w.executeLocal(l),l=(new t.Query).where("groupId",t.FilterOperators.equal,c[0][f[r-1].id]),e=k.executeLocal(l),a=[];for(o=0;o<e.length;o++)a.push({text:e[o][f[r].text],value:e[o][f[r].id],color:e[o][f[r].color]});u._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");u._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",a);u._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(e[0][f[r].id]);s=e[0][f[r].id]}}else{for(v=t.Predicate("id",t.FilterOperators.equal,s[0].value),h=1;h<s.length;h++)v=v.or("id",t.FilterOperators.equal,s[h].value);if(l=(new t.Query).where(v),c=w.executeLocal(l),c.length>0){for(y=t.Predicate("groupId",t.FilterOperators.equal,c[0][f[r-1].id]),h=1;h<c.length;h++)y=y.or("groupId",t.FilterOperators.equal,c[h][f[r-1].id]);var l=(new t.Query).where(y),e=k.executeLocal(l),a=[];for(o=0;o<e.length;o++)a.push({text:e[o][f[r].text],value:e[o][f[r].id],color:e[o][f[r].color]});u._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");u._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",a);u._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(e[0][f[r].id]);s.push(e[0][f[r].id])}}}},_yearDateChange:function(){this._appointmentAddWindow.find("#"+this._id+"yearday").ejRadioButton("option","checked",!0)},_yearDayChange:function(){this._appointmentAddWindow.find("#"+this._id+"yearother").ejRadioButton("option","checked",!0)},_monthDateChange:function(){this._appointmentAddWindow.find("#"+this._id+"monthday").ejRadioButton("option","checked",!0)},_monthDayChange:function(){this._appointmentAddWindow.find("#"+this._id+"monthon").ejRadioButton("option","checked",!0)},_endAfterChange:function(){this._appointmentAddWindow.find("#"+this._id+"repeatendafter").ejRadioButton("option","checked",!0)},_endOnChange:function(){this._appointmentAddWindow.find("#"+this._id+"repeatendon").ejRadioButton("option","checked",!0)},_minToHour:function(n){var t=parseInt(n/60),n=n%60;return{h:t,m:n}},_onclose:function(){this._clearFields();this._processFocus()},_getResourceDetails:function(n){var u,f,e,s,h,o,i,r;if(!t.isNullOrUndefined(this.model.resources)&&this.model.resources.length>0){for(u=this.model.currentView==="week"||this.model.currentView==="month"?7:this.model.currentView==="workweek"?5:1,f=this.model.currentView==="month"?n.index():this._cellIndex,this._resourceCollection=[],i=this._getResourceCollection(),r=i.length-1;r>=0;r--)r==i.length-1?t.isNullOrUndefined(this.model.group)?(this._resourceCollection.push({id:i[i.length-1].dataSource[parseInt(f/u)][i[i.length-1].id]}),e=i[i.length-1].dataSource[parseInt(f/u)][i[i.length-1].groupId]):(this._resourceCollection.push({id:this.res1[parseInt(f/u)][i[r].id]}),e=this.res1[parseInt(f/u)][i[r].groupId]):(s=i[r].dataSource instanceof t.DataManager?i[r].dataSource:t.DataManager(i[r].dataSource),h=(new t.Query).where("id",t.FilterOperators.equal,e),o=s.executeLocal(h),this._resourceCollection.push({id:o[0][i[r].id]}),e=o[0][i[r].groupId]);return this._resourceCollection}},_saveAppointment:function(){var it=this._sortAppById(this._processed),l,et,ot,st,wt=this._getResourceCollection(),u,y,b,a,s,k,p,g,nt,d,v,o,rt,ct,lt,tt,w,ft,at,c,e,h,f,r;if(this._cellClick&&this.model.showQuickWindow){if(u={},l=it.length>0?it[it.length-1][this.model.appointmentSettings.id]+1:1,u[this.model.appointmentSettings.id]=l,u[this.model.appointmentSettings.subject]=this._quickAppointWindow.find(".subject").val(),u[this.model.appointmentSettings.startTime]=new Date(this.cur_StartTime),u[this.model.appointmentSettings.endTime]=new Date(this.cur_EndTime),u[this.model.appointmentSettings.allDay]=this.currentView()==="month"||new Date(this.cur_StartTime).getHours()==0&&new Date(this.cur_EndTime).getHours()==23&&new Date(this.cur_EndTime).getMinutes()==59?!0:!1,u[this.model.appointmentSettings.recurrence]=!1,!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources))for(w=0,r=this._resourceCollection.length-1;w<this._resourceCollection.length;w++,r--)u[this.model.appointmentSettings.resourceFields.split(",")[w]]=this._resourceCollection[r].id;if(o={appointment:u},this._trigger("appointmentSaved",o))return this._quickAppointWindow.ejDialog("close"),!1;this._currentAction==t.Schedule.Actions.Add;h=this._dataManager.insert(o.appointment);f=this;n.isFunction(h.promise)&&this.dataSource()instanceof t.DataManager?(h.done(function(){f._processed.push(o.appointment);f._renderSingleApp(u,o.appointment);f._currentAppointmentData.push(o.appointment)}),h.fail(function(){})):(this._processed.push(o.appointment),this._renderSingleApp(u,o.appointment));this._cellClick=!1;this._quickAppointWindow.ejDialog("close")}else{for(u={},temp={},l=(this._currentAction==t.Schedule.Actions.Add||this._currentAction==t.Schedule.Actions.EditOcurrence)&&it.length>0?it[it.length-1][this.model.appointmentSettings.id]+1:parseInt(this._appId),y=n("#"+this._id+"AppointmentAddEditWindow").find("#"+this._id+"_AddEditForm").get(0),b=[],a=0;a<y.length;a++)s=y[a].name,k=n(y[a]),s!=i&&(s==""&&(s=y[a].id.replace(this._id,"")),s!=""&&u[s]==null?(p=y[a].value,s=="Id"&&(p=p==""?parseInt(l):parseInt(p)),n(y[a]).hasClass("e-datepicker")?p=k.ejDatePicker("option","value"):n(y[a]).hasClass("e-datepicker")?p=k.ejTimePicker("option","value"):k.data("ejDropDownList")?p=k.ejDropDownList("model.value"):k.data("ejAutocomplete")&&b.push(k.data("ejAutocomplete").getSelectedItems()),s!="StartDate"&&s!="EndDate"&&s!="StartTime"&&s!="EndTime"?u[s]=y[a].type!="checkbox"?p:n(y[a]).is(":checked"):temp[s]=s=="StartDate"||s=="EndDate"?new Date(p):p):k.data("ejAutocomplete")&&b.push(k.data("ejAutocomplete").getSelectedItems()));if(g=this._timeFormat(temp.StartTime).split(":"),nt=this._timeFormat(temp.EndTime).split(":"),u[this.model.appointmentSettings.startTime]=new Date(temp.StartDate.setHours(parseInt(g[0]),parseInt(g[1]))),u[this.model.appointmentSettings.endTime]=new Date(temp.EndDate.setHours(parseInt(nt[0]),parseInt(nt[1]))),u[this.model.appointmentSettings.recurrence]&&(u[this.model.appointmentSettings.recurrenceRule]=this._recRule),u.startutc!=""){var ht=u.startutc.split(" ")[1].split(":"),vt=parseInt(ht[0]),yt=parseInt(ht[1]),pt=(new Date).getTimezoneOffset(),ut=this._minToHour(pt+(vt*60+yt));new Date(u.StartTime.setHours(u.StartTime.getHours()+ut.h,u.StartTime.getMinutes()+ut.m));new Date(u.EndTime.setHours(u.EndTime.getHours()+ut.h,u.EndTime.getMinutes()+ut.m))}if(this._currentAction==t.Schedule.Actions.EditOcurrence?(v=this._deleteOcurrence(this._parentId,new Date(temp.StartDate)),new t.DataManager(this._processed).remove(this.model.appointmentSettings.id,this._appId),u[this.model.appointmentSettings.recurrence]=1,u[this.model.appointmentSettings.recurrenceRule]=v[0][this.model.appointmentSettings.recurrenceRule]+";RECUREDITID="+v[0][this.model.appointmentSettings.id]):this._currentAction==t.Schedule.Actions.EditSeries&&(d=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._parentId),v=new t.DataManager(this._currentAppointmentData).executeLocal(d),u[this.model.appointmentSettings.id]=v[0][this.model.appointmentSettings.id],l=v[0][this.model.appointmentSettings.id],u[this.model.appointmentSettings.recurrenceRule]=this._recRule==""?v[0][this.model.appointmentSettings.recurrenceRule]:this._recRule),this._currentAction!=t.Schedule.Actions.Add){if(this._trigger("appointmentEdited",{appointment:u}))return this._appointmentAddWindow.ejDialog("close"),!1}else if(this._trigger("appointmentSaved",{appointment:u}))return this._appointmentAddWindow.ejDialog("close"),!1;if(o=[],t.isNullOrUndefined(this.model.resources))at=this._currentAction==t.Schedule.Actions.EditOcurrence||!t.isNullOrUndefined(u[this.model.appointmentSettings.recurrenceRule])&&u[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1?this._parentId:l,rt=this._addAppData(u,l,new Date(temp.StartDate.setHours(parseInt(g[0]),parseInt(g[1]))),new Date(temp.EndDate.setHours(parseInt(nt[0]),parseInt(nt[1]))),at),o.push(rt);else for(tt=this.model.appointmentSettings.resourceFields.toString().split(","),w=0;w<b[b.length-1].length;w++){for(rt=this._addAppData(u,l,new Date(temp.StartDate.setHours(parseInt(g[0]),parseInt(g[1]))),new Date(temp.EndDate.setHours(parseInt(nt[0]),parseInt(nt[1]))),l),b[b.length-1].length>1&&(u[this.model.appointmentSettings.id]=l,l++),rt[tt[tt.length-1]]=b[tt.length-1][w].value,ft=b[tt.length-1][w].value,r=tt.length-1;r>0;r--)ct=this.render_Resources[r]instanceof t.DataManager?this.render_Resources[r]:t.DataManager(this.render_Resources[r]),d=(new t.Query).where("id",t.FilterOperators.equal,ft),ot=ct.executeLocal(d),lt=this.render_Resources[r-1]instanceof t.DataManager?this.render_Resources[r-1]:t.DataManager(this.render_Resources[r-1]),et=(new t.Query).where("id",t.FilterOperators.equal,ot[0].groupId),st=lt.executeLocal(et),ft=st[0].id,rt[tt[r-1]]=ft;o.push(rt)}if(this._currentAction==t.Schedule.Actions.Add||this._currentAction==t.Schedule.Actions.EditOcurrence)if(f=this,h=this._dataManager.saveChanges({added:o,changed:[],deleted:[]}),n.isFunction(h.promise)&&this.dataSource()instanceof t.DataManager)h.done(function(){for(var n=0;n<o.length;n++)f._appointmentProcessing(o[n]),f._renderSingleApp(u,o[n]),f._currentAppointmentData.push(o[n])}),h.fail(function(){});else for(r=0;r<o.length;r++)this._appointmentProcessing(o[r]),this.dataSource()instanceof t.DataManager||this._renderSingleApp(u,o[r]);else if(this._currentAction==t.Schedule.Actions.Save||this._currentAction==t.Schedule.Actions.EditSeries){for(c=[],e=[],r=0;r<o.length;r++)d=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,o[r][this.model.appointmentSettings.id]),v=this._dataManager instanceof t.DataManager?t.DataManager(this._processed).executeLocal(d):this._dataManager.executeLocal(d),!t.isNullOrUndefined(v)&&v.length>0?e.push(o[r]):c.push(o[r]);if(h=this._dataManager.saveChanges({added:c,changed:e,deleted:[]},this.model.appointmentSettings.id),e.length>0)if(f=this,n.isFunction(h.promise)&&this.dataSource()instanceof t.DataManager)h.done(function(){for(var n=0;n<e.length;n++)e[n][f.model.appointmentSettings.recurrence]||Globalize.format(new Date(e[n][f.model.appointmentSettings.startTime]),f._pattern.d)<Globalize.format(new Date(e[n][f.model.appointmentSettings.endTime]),f._pattern.d)&&(new Date(e[n][f.model.appointmentSettings.endTime])-new Date(e[n][f.model.appointmentSettings.startTime]))/36e5<24&&e[n][f.model.appointmentSettings.allDay]!==!0?f._dataProcessing(f._currentAppointmentData):new t.DataManager(f._processed).update(f.model.appointmentSettings.id,e[n])&&f.element.find("#Appointment_"+f._appId).remove(),f._renderSingleApp(e[n],e[n])}),h.fail(function(){});else for(r=0;r<e.length;r++)e[r][this.model.appointmentSettings.recurrence]||Globalize.format(new Date(e[r][this.model.appointmentSettings.startTime]),this._pattern.d)<Globalize.format(new Date(e[r][this.model.appointmentSettings.endTime]),this._pattern.d)&&(new Date(e[r][this.model.appointmentSettings.endTime])-new Date(e[r][this.model.appointmentSettings.startTime]))/36e5<24&&e[r][this.model.appointmentSettings.allDay]!==!0?this._dataProcessing(this._currentAppointmentData):new t.DataManager(this._processed).update(this.model.appointmentSettings.id,e[r])&&this.element.find("#Appointment_"+this._appId).remove(),f._renderSingleApp(e[r],e[r]);if(c.length>0)if(n.isFunction(h.promise)&&this.dataSource()instanceof t.DataManager)h.done(function(){for(var n=0;n<c.length;n++)f._appointmentProcessing(c[n]),f._renderSingleApp(c[n],c[n])}),h.fail(function(){});else for(r=0;r<c.length;r++)this._appointmentProcessing(c[r]),this.dataSource()instanceof t.DataManager||this._renderSingleApp(c[r],c[r])}}this._clearFields();this._appointmentAddWindow.ejDialog("close");this.element.find("div.e-draggableworkarea tr").find("td").hasClass("e-selectedCell")&&this._processFocus();this._recRule=""},_renderSingleApp:function(i,r){var u;if(this.element.find(".e-prev,.e-next").css("display","none"),i[this.model.appointmentSettings.recurrence]||new Date(i[this.model.appointmentSettings.startTime]).getDay()!==new Date(i[this.model.appointmentSettings.endTime]).getDay())this._renderAppointmentAll();else{var o=new Date(i[this.model.appointmentSettings.startTime]),f=this.currentView()==="day"?0:n.inArray(new Date(o.getFullYear(),o.getMonth(),o.getDate()).getTime(),this._dateRender),e=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?this._findResourceIndex(this.res1,"id",r[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):0;if(this._getDayAppointments(f,e),this.currentView()!=="month"?f>=0&&i[this.model.appointmentSettings.allDay]?this._setAllDayPos(r,f,e):this._renderApp(r,f,e):this._renderAppointmentMonth(r,this._cellIndex),this.overlapList.length>0)for(u=0;u<this.overlapList.length;u++)this.element.find("#Appointment_"+this.overlapList[u][this.model.appointmentSettings.id]).remove(),this.currentView()=="month"?this._renderAppointmentMonth(this.overlapList[u],this._cellIndex):this._renderApp(this.overlapList[u],f,e);this._unWireResizeEvents();this._wireResizeEvents();this._dragdropAppointments()}},_timeFormat:function(n){var e=Globalize.culture(this.model.locale),i=Number(n.match(/^(\d+)/)[1]),o=Number(n.match(/:(\d+)/)[1]),f,r,u;return t.isNullOrUndefined(n.split(" ")[1])||(f=n.match(/\s(.*)$/)[1],f==e.calendar.PM[0]&&i<12&&(i=i+12),f==e.calendar.AM[0]&&i==12&&(i=i-12)),r=i.toString(),u=o.toString(),i<10&&(r="0"+r),o<10&&(u="0"+u),r+":"+u},_processEscapeKey:function(){this._processFocus();this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")},_processFocus:function(){var s=this.element.find("div.e-selectedAppointment"),o,l;if(s.length!=0&&s.focus(),this.element.find("td.e-selectedCell").hasClass("e-workcells")){var r=this.element.find("div.e-draggableworkarea tr"),h=r.length-1,i,t,c,f,u,e=this.currentView(),a=this;this.element.find("td.e-selectedCell").each(function(o,s){var l=n(s).index(),a;if(l!=null&&!isNaN(l))if(i==null?(i=l,c=n(s).parent()[0].rowIndex):i<l?i=i:i!=l&&(i=l,c=n(s).parent()[0].rowIndex),t==null){if(t=l,e!="month")for(u=parseInt(t),a=0;a<=h;a++)n(r[a].cells[u]).hasClass("e-selectedCell")&&(f=a)}else if(t>l)t=t;else if(t!=l&&(t=l,e!="month"))for(u=parseInt(t),a=0;a<=h;a++)n(r[a].cells[u]).hasClass("e-selectedCell")&&(f=a)});e!="month"?n(r[f].cells[t]).attr("tabIndex",0).focus():(o=r.find("td.e-selectedCell"),l=parseInt(o.length)-1,n(o[l]).attr("tabIndex",0).focus())}else this.element.focus(),this.element.find("td.e-selectedCell").attr("tabIndex",0).focus()},_clearFields:function(){this._appointmentAddWindow.find(".subject").val("");this._appointmentAddWindow.find(".e-description").val("");this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",Globalize.format(new Date,this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",Globalize.format(new Date,this._pattern.d));this._appointmentAddWindow.find(".startendtime").ejTimePicker({enabled:!0});this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(new Date,this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(new Date,this._pattern.t));this._appointmentAddWindow.find(".recurrence,.weekdays").ejCheckBox({checked:!1,enabled:!0});this._appointmentAddWindow.find(".e-repeatlbl").removeClass("e-disable");this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!1});this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList("clearText");this._appointmentAddWindow.find("#"+this._id+"summary").css("display","none");this._appointmentAddWindow.find(".e-recurFinalRule").html("");this._appointmentAddWindow.find(".e-recuredit").hide()},_getNumericModel:function(){return numericModel={width:"100px",minValue:1,value:1,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,localize:this.model.locale}},_recurClearFields:function(){for(var i=this._appointmentAddWindow.find("input[name='weekdays']"),t=0;t<i.length;t++)n(i[t]).ejCheckBox({checked:!1});this._appointmentAddWindow.find(".e-recurevery").ejNumericTextbox({value:1});this._appointmentAddWindow.find(".e-recurcount").ejNumericTextbox({value:10});this._appointmentAddWindow.find(".e-recurRule").html("")},_deleteApp:function(i){var f,o=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,i),e=t.DataManager(this._processed).executeLocal(o),u=this._dataManager.remove(this.model.appointmentSettings.id,i),r=this;n.isFunction(u.promise)?(u.done(function(){e[0][r.model.appointmentSettings.recurrence]&&r._deleteRecurrence(i);new t.DataManager(r._currentAppointmentData).remove(r.model.appointmentSettings.id,i);e[0][r.model.appointmentSettings.recurrence]?r._dataProcessing(r._currentAppointmentData)&&r._renderAppointmentAll():new t.DataManager(r._processed).remove(r.model.appointmentSettings.id,i)&&r.element.find("#Appointment_"+i).remove()}),u.fail(function(){})):(u[0][this.model.appointmentSettings.recurrence]&&this._deleteRecurrence(i),u[0][this.model.appointmentSettings.recurrence]?this._dataProcessing(this._currentAppointmentData)&&this._renderAppointmentAll():new t.DataManager(this._processed).remove(this.model.appointmentSettings.id,i)&&this.element.find("#Appointment_"+i).remove());f={appointment:u};this._trigger("appointmentDeleted",f)},_deleteRecurrence:function(n){for(var u=t.Query().where(t.Predicate(this.model.appointmentSettings.recurrenceRule,t.FilterOperators.contains,"RECUREDITID="+n,!0)),r=new t.DataManager(this._processed).executeLocal(u),i=0;i<r.length;i++)this._deleteApp(r[i][this.model.appointmentSettings.id]),this.element.find("#Appointment_"+n).remove()},_appointmentResizeStart:function(i){if(this.model.enableAppointmentResize){var r={element:n(i.target).parent()};if(this._trigger("resizeStart",r)||(i.preventDefault(),this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),this.resizeStart=!0,n(i.target).hasClass("e-lefthandle")||n(i.target).hasClass("e-righthandle")?(this.resize=i.pageX,this.appoint_width=n(i.target).parent().width(),this.appoint_left=parseInt(n(i.target).parent()[0].style.left),n(i.target).hasClass("e-lefthandle")?this._leftResizing=!0:this._rightResizing=!0):(n(i.target).hasClass("e-tophandle")||n(i.target).hasClass("e-bottomhandle"))&&(this.resize=i.pageY,this.appoint_height=n(i.target).parent().height(),this.appoint_top=parseInt(n(i.target).parent()[0].style.top),n(i.target).hasClass("e-tophandle")?this._topResizing=!0:this._bottomResizing=!0),this._curElmt=n(i.target).parent(),this.element.find(".e-workcells").removeClass("e-selectedCell"),this.element.find(".e-workcells").removeClass("e-mousehover"),this._on(n(document),t.eventType.mouseMove,n.proxy(this._appointmentResizing,this)),this._on(n(document),t.eventType.mouseUp,n.proxy(this._appointmentResizeStop,this)),n(i.target).hasClass("e-rowcursor")||n(i.target).hasClass("e-columncursor")))return!1}},_appointmentResizing:function(t){var i=n(t.target),r={element:i.parent()};if(this._trigger("resizing",r))return!1;this._topResizing?(this._curElmt.height(this.appoint_height+this.resize-t.pageY+3),this._curElmt.css("top",this.appoint_top-(this.resize-t.pageY)-3)):this._bottomResizing?this._curElmt.height(this.appoint_height+(t.pageY-this.resize)+2):this._rightResizing?this._curElmt.width(this.appoint_width+(t.pageX-this.resize)+2):this._leftResizing&&(this._curElmt.width(this.appoint_width+this.resize-t.pageX+3),this._curElmt.css("left",this.appoint_left-(this.resize-t.pageX)-3))},_appointmentResizeStop:function(r){var p,et,k,v,ot,st,a,w,ct,tt,c,lt;try{this.resizeStart=!1;n(document).unbind(t.eventType.mouseMove);n(document).unbind(t.eventType.mouseUp);var s=this.model.appointmentSettings,gt=this._currentAppointmentData,o=n(r.target).hasClass("e-appointment")||n(r.target).hasClass("e-monthappointment")||n(r.target).hasClass("e-alldayappointment")?n(r.target):n(r.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),w=o[0].id.split("_")[1],it=new t.DataManager(this._processed).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,w)),f=it[0][s.recurrence]&&it[0][s.recurrenceRule].toString().indexOf("RECUREDITID")==-1?this._getAppointmentByParentId(w):it[0],y=this.model.currentView==="week"||this.model.currentView==="month"?7:this.model.currentView==="workweek"?5:1;if(f!=null||f!==i){var ni=new Date(f[this.model.appointmentSettings.startTime]).getDate()<new Date(f[this.model.appointmentSettings.endTime]).getDate()?!0:!1,u=new Date(f[this.model.appointmentSettings.startTime]),h=new Date(f[this.model.appointmentSettings.endTime]),at=n(o[0]).height();if(this.currentView()!=="month")var vt=n(o[0]).offset().top,d=this.element.find(".e-draggableworkarea"),b=this.element.find(".e-workcells").height(),ut=d.height()+d.scrollTop(),ft=vt-d.offset().top+d.scrollTop(),g=ft-b/2<ut?ft:ut-at;if(this._topResizing)g>0&&(p=g*60/(2*(b+1)),u.setHours(parseInt(this.model.startHour)+parseInt(p/60)),u.setMinutes(parseInt(p%60)),u.setMinutes(Math.round(u.getMinutes()/10)*10));else if(this._bottomResizing)g>0&&(et=n(o[0]).height()/b,p=(g+et*b)*60/(2*(b+1)),h.setHours(parseInt(this.model.startHour)+parseInt(p/60)),h.setMinutes(parseInt(p%60)),h.setMinutes(Math.round(h.getMinutes()/10)*10));else if(this._leftResizing)a=this._findResourceIndex(this.res1,"id",f[this.model.appointmentSettings.resourceFields.split(",")[this.model.resources.length-1]]),this.currentView()!=="month"?n(o[0]).offset().left>n(n(".e-alldaycells")[a*y]).offset().left&&(u=new Date(this._dateRender[0]),k=n(o[0]).offset().left-n(this.element.find(".e-alldaycells")[a*y]).offset().left,v=Math.round(k/(this.element.find(".e-alldaycells").width()+1)),u.setDate(new Date(u).getDate()+v)):n(o[0]).offset().left>n(n(".e-monthcells")[a*y]).offset().left&&(u=new Date(new Date(this.model.currentDate).getFullYear(),new Date(this.model.currentDate).getMonth(),1),ot=u.getDay(),u.setDate(u.getDate()-ot),v=Math.round(n(o[0]).offset().left/this.element.find(".e-monthcells").width()-1),v=v%7-2,u.setDate(u.getDate()+parseInt(v)),st=n(o[0]).offset().top/this.element.find(".e-monthcells").height()-2,u.setDate(u.getDate()+parseInt(st-1)*7));else if(this._rightResizing)if(a=this._findResourceIndex(this.res1,"id",f[this.model.appointmentSettings.resourceFields.split(",")[this.model.resources.length-1]]),this.currentView()!=="month"){var k=o[0].offsetLeft+n(o[0]).width(),v=Math.floor(k/this.element.find(".e-alldaycells").width())-1-a*y,yt=a==this.res1.length-1?n(this.element.find(".e-alldaycells")[(a+1)*y-1]).offset().left+this.element.find(".e-alldaycells").width():n(this.element.find(".e-alldaycells")[(a+1)*y]).offset().left;yt>=k&&(h=new Date(this._dateRender[0]),h.setDate(new Date(h).getDate()+v))}else{var pt=n(o[0]).offset().left+n(o[0]).width(),wt=n(o[0]).width()-this.appoint_width,v=Math.round(wt/this.element.find(".e-monthcells").width()),k=n(this.element.find(".e-monthcells")[(a+1)*y]).offset().left;pt<k&&h.setDate(new Date(h).getDate()+v)}if(f[s.recurrence]==1&&f[s.recurrenceRule].toString().indexOf("RECUREDITID")==-1){var e={},ht=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,w),e=new t.DataManager(this._processed).executeLocal(ht)[0],nt=new Date(e[s.startTime]),rt=new Date(e[s.endTime]),bt=new Date(nt.getFullYear(),nt.getMonth(),nt.getDate()).setHours(u.getHours(),u.getMinutes(),u.getMilliseconds()),kt=new Date(rt.getFullYear(),rt.getMonth(),rt.getDate()).setHours(h.getHours(),h.getMinutes(),h.getMilliseconds());n.extend(e,f);w=parseInt(f[s.id]);this._deleteOcurrence(w,nt);ct=this._maxId;e[s.recurrenceRule]=f[s.recurrenceRule]+";RECUREDITID="+e[s.id];e[s.startTime]=new Date(bt);e[s.endTime]=new Date(kt);e[s.id]=ct;tt={data:e};promise=this._dataManager.insert(tt.data);c=this;n.isFunction(promise.promise)&&this.dataSource()instanceof t.DataManager?(promise.done(function(){c._processed.splice(c._processed.indexOf(e),1);c._processed.push(tt.data);c._renderSingleApp(e,e)}),promise.fail(function(){c._renderAppointmentAll()})):(this._processed.splice(this._processed.indexOf(e),1),this._processed.push(tt.data),this._renderSingleApp(e,e))}else{var ht=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,f[this.model.appointmentSettings.id]),l={},dt=new t.DataManager(this._processed).executeLocal(ht);n.extend(l,dt);l[0][this.model.appointmentSettings.startTime]=u;l[0][this.model.appointmentSettings.endTime]=h;promise=this._dataManager.update(this.model.appointmentSettings.id,l);c=this;promise&&n.isFunction(promise.promise)&&this.dataSource()instanceof t.DataManager?(promise.done(function(){new t.DataManager(c._processed).update(c.model.appointmentSettings.id,l);c.element.find("#Appointment_"+l[0][c.model.appointmentSettings.id]).remove();c._renderSingleApp(l[0],l[0])}),promise.fail(function(){c._renderAppointmentAll()})):(new t.DataManager(this._processed).update(this.model.appointmentSettings.id,l),this.element.find("#Appointment_"+l[0][this.model.appointmentSettings.id]).remove(),this._renderSingleApp(l[0],l[0]))}if(lt={appointment:f,target:r},this._trigger("resizeStop",lt))return!1;this._topResizing=!1;this._bottomResizing=!1;this._leftResizing=!1;this._rightResizing=!1}this.element.find("div.e-tophandle,div.e-bottomhandle").removeClass("e-rowcursor");this.element.find("div.e-lefthandle,div.e-righthandle").removeClass("e-columncursor")}catch(r){}},recurrenceRuleSplit:function(t){for(var f,r,i,e=t.split(";"),u=0;u<e.length;u++){i=e[u].split("=");switch(n.trim(i[0]).toUpperCase()){case"FREQ":this._rRule.freq=n.trim(i[1]).toUpperCase();break;case"INTERVAL":this._rRule.interval=parseInt(i[1],10);break;case"COUNT":this._rRule.count=parseInt(i[1],10);break;case"UNTIL":this._rRule.until=new Date(i[1]);break;case"BYDAY":this._rRule.weekDays=i[1];break;case"BYMONTHDAY":this._rRule.monthDay=parseInt(i[1],10);break;case"BYMONTH":this._rRule.month=parseInt(i[1],10);break;case"BYSETPOS":this._rRule.setPositions=parseInt(i[1],10);break;case"WKST":this._rRule.weekStart=i[1];break;case"EXDATE":for(f=i[1].split(","),this._rRule.exDate=[],r=0;r<f.length;r++)this._rRule.exDate[r]=Globalize.format(new Date(f[r]),this._pattern.d);break;case"RECUREDITID":this._rRule.recurEditId=parseInt(i[1])}}return this._rRule},_dragdropAppointments:function(){var i,r;this.model.allowDragDrop&&(i=this,r=this.element.find(".e-appointment"),r.ejDraggable({handle:".e-appointment",dragArea:i.element.find("div.e-draggableworkarea"),cursorAt:{top:20,left:0},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){var r=n(t.sender.target).hasClass("e-appointment")?n(t.sender.target):n(t.sender.target).parents(".e-appointment");if(r.hasClass("e-appointment"))return r.addClass("e-draggableAppointment").css("width",r[0].offsetWidth+"px").appendTo(i.element)}}),r=this.element.find(".e-alldayappointment"),r.ejDraggable({handle:".e-alldayappointment",dragArea:i.element.find(".e-headrealldaytable tr")[!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.model.group.resources.length+1:2],cursorAt:{top:17,left:0},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){var r=n(t.sender.target).hasClass("e-alldayappointment")?n(t.sender.target):n(t.sender.target).parents(".e-alldayappointment");if(r.hasClass("e-alldayappointment"))return r.addClass("e-draggableAppointment").css("width",r[0].offsetWidth+"px").appendTo(i.element)}}),r=this.element.find(".e-monthappointment"),r.ejDraggable({handle:".e-monthappointment",dragArea:i.element.find(".e-workareadiv"),cursorAt:{top:17,left:0},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){var r=n(t.sender.target).hasClass("e-monthappointment")?n(t.sender.target):n(t.sender.target).parents(".e-monthappointment");if(r.hasClass("e-monthappointment"))return r.addClass("e-draggableAppointment").css("width",r[0].offsetWidth+"px").appendTo(i.element)}}))},_dragStart:function(n){var t=n.element,i={target:t};this._trigger("dragStart",i);this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close")},_dragOver:function(t){var i=n(t.element),r={target:i};this._trigger("dragOver",r);this.element.find(".e-workcells").removeClass("e-selectedCell");this.element.find(".e-workcells").removeClass("e-mousehover")},_dragStop:function(i){var r=this,o=r.model.appointmentSettings,v=r.element.find(".e-draggableworkarea"),nt=i.element[0].id.split("_")[1],tt=new t.DataManager(this._processed).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,nt)),f=tt[0][o.recurrence]&&tt[0][o.recurrenceRule].toString().indexOf("RECUREDITID")==-1?this._getAppointmentByParentId(nt):tt[0],oi=this._currentAppointmentData,k,w,ct,lt,at,it,vt,c,yt,b,pt,wt,d,bt,kt,dt,g,rt,h,l,p;if(n(i.element[0]).hasClass("e-appointment")){var ft=v.height()+v.scrollTop(),gt=i.element[0].offsetHeight,et=this.element.find(".e-workcells").height(),ot=n(i.element[0]).offset().top-v.offset().top+v.scrollTop(),st=ot-et/2<ft?ot:ft-gt;if(st>0){k=st*60/(2*(et+1));var ni=new Date(f[r.model.appointmentSettings.startTime]).getDate()<new Date(f[r.model.appointmentSettings.endTime]).getDate()?!0:!1,ti=new Date(f[r.model.appointmentSettings.startTime]),ii=new Date(f[r.model.appointmentSettings.endTime]),ht=(ii-ti)/1e3,ri=Math.floor(ht/3600),ui=Math.floor(ht%3600/60),u,e,a,y;if(r.model.currentView!=="month"){w=new Date(r._firstweekdate());r.model.currentView==="workweek"&&(ct=new Date(w).getDay(),lt=ct==0?1:0,w.setDate(w.getDate()+lt));u=w;at=v.width();l=r.model.currentView==="week"?7:r.model.currentView==="workweek"?5:1;l=t.isNullOrUndefined(r.model.group)?l:l*r.res1.length;var fi=Math.round(at/l),ei=i.element[0].offsetLeft-v.offset().left,c=Math.round(ei/fi);u=new Date(this.dateRender[c]);e=u}else u=new Date(f[r.model.appointmentSettings.startTime]),e=new Date(u);ni?(u=r._getNewStartTime(k,u),a=new Date(u),e=r._getNewEndTime(u,ri,ui),y=new Date(e)):(u.setHours(parseInt(r.model.startHour)+Math.round(k/60)),u.setMinutes(parseInt(k%60)),u=new Date(u).getMinutes()>=30?new Date(new Date(u).setHours(new Date(u).getHours()-1)):new Date(u),u.setMinutes(Math.round(u.getMinutes()/10)*10),a=new Date(u),it=new Date(f[r.model.appointmentSettings.endTime]).getHours()*60+new Date(f[r.model.appointmentSettings.endTime]).getMinutes()-(new Date(f[r.model.appointmentSettings.startTime]).getHours()*60+new Date(f[r.model.appointmentSettings.startTime]).getMinutes()),e.setHours(new Date(u).getHours()+parseInt(it/60)),e.setMinutes(new Date(u).getMinutes()+parseInt(it%60)),e.setMinutes(Math.round(e.getMinutes()/10)*10),y=new Date(e))}}else n(i.element[0]).hasClass("e-alldayappointment")?(u=new Date(r._dateRender[0]),e=u,vt=i.element[0].offsetLeft-this.element.find(".e-alldaycells").offset().left,c=Math.round(vt/(this.element.find(".e-alldaycells").width()+1)),a=r.dateRender[c],yt=Math.round(n(i.element[0]).width()/(this.element.find(".e-alldaycells").width()+1)),e.setDate(new Date(a).getDate()+yt-1),y=new Date(e)):n(i.element[0]).hasClass("e-monthappointment")&&(b=new Date(f[r.model.appointmentSettings.startTime]),pt=new Date(f[r.model.appointmentSettings.endTime]),u=new Date(new Date(r.model.currentDate).getFullYear(),new Date(r.model.currentDate).getMonth(),1),wt=u.getDay(),u.setDate(u.getDate()-wt),c=Math.floor(n(i.element[0]).offset().left/this.element.find(".e-monthcells").width()),d=Math.floor(n(i.element[0]).offset().top/this.element.find(".e-monthcells").height()-1),t.isNullOrUndefined(this.model.group)||(c=c-1,d=d-2),bt=d*7+(c-Math.floor(c/7)*7),u=new Date(r._dateRender[bt]),u.setHours(b.getHours(),b.getMinutes(),b.getSeconds()),a=new Date(u),kt=u.getTime()-new Date(b).getTime(),e=new Date(new Date(pt).getTime()+kt),y=new Date(e));if(f[o.recurrence]==1&&f[o.recurrenceRule].indexOf("RECUREDITID")==-1){var rt=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,nt),ut=new t.DataManager(this._processed).executeLocal(rt)[0],s={};n.extend(s,f);r._deleteOcurrence(parseInt(f[o.id]),ut[o.startTime]);dt=this._processed.length>0?this._processed[this._processed.length-1][o.id]+1:1;s[o.recurrenceRule]=f[o.recurrenceRule]+";RECUREDITID="+s[o.id];s[o.startTime]=a;s[o.endTime]=y;s[o.id]=dt;t.isNullOrUndefined(this.model.group)||(l=r.model.currentView==="week"?7:r.model.currentView==="workweek"?5:1,p=r.res1[Math.floor(c/l)],s[r.model.appointmentSettings.resourceFields.split(",")[r.model.appointmentSettings.resourceFields.split(",").length-1]]=p.id,s[r.model.appointmentSettings.resourceFields.split(",")[r.model.appointmentSettings.resourceFields.split(",").length-2]]=p.groupId);g={data:s};promise=r._dataManager.insert(g.data);n.isFunction(promise.promise)&&r.dataSource()instanceof t.DataManager?(promise.done(function(){r._processed.splice(r._processed.indexOf(ut),1);r._appointmentProcessing(s);r._renderSingleApp(s,g.data)}),promise.fail(function(){r._renderAppointmentAll()})):(r._processed.splice(r._processed.indexOf(ut),1),this._appointmentProcessing(s),this._renderSingleApp(s,g.data))}else rt=(new t.Query).where(r.model.appointmentSettings.id,t.FilterOperators.equal,f[r.model.appointmentSettings.id]),h=new t.DataManager(this._processed).executeLocal(rt),h[0][r.model.appointmentSettings.startTime]=a,h[0][r.model.appointmentSettings.endTime]=y,t.isNullOrUndefined(this.model.group)||(l=r.model.currentView==="week"||r.model.currentView==="month"?7:r.model.currentView==="workweek"?5:1,p=r.res1[Math.floor(c/l)],h[0][r.model.appointmentSettings.resourceFields.split(",")[r.model.appointmentSettings.resourceFields.split(",").length-1]]=p.id,h[0][r.model.appointmentSettings.resourceFields.split(",")[r.model.appointmentSettings.resourceFields.split(",").length-2]]=p.groupId),promise=r._dataManager.update(r.model.appointmentSettings.id,h[0]),promise&&n.isFunction(promise.promise)&&r.dataSource()instanceof t.DataManager?(promise.done(function(){new t.DataManager(r._processed).update(r.model.appointmentSettings.id,h);r._renderSingleApp(h[0],h[0])}),promise.fail(function(){r._renderAppointmentAll()})):(new t.DataManager(r._processed).update(r.model.appointmentSettings.id,h),r._renderSingleApp(h[0],h[0]));n(i.element[0]).remove();r._trigger("dragDrop",{appointment:h})},_getAppointmentByParentId:function(i){var f=this._currentAppointmentData,u=new t.DataManager(this._processed).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,i)),r=new t.DataManager(f).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,parseInt(u[0].ParentId)));return n.isEmptyObject(r)?r:r[0]},_renderAppointmentAll:function(){this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment").remove();this.currentView()!=="month"?(this._renderAppointments(),this._renderAllDayAppointments()):this._renderMonthAppointment();this._wireResizeEvents();this._dragdropAppointments()},_getNewEndTime:function(n,t,i){var r=new Date(n);return r.setHours(r.getHours()+t),r.setMinutes(r.getMinutes()+i),r},_getNewStartTime:function(n,t){return t.setHours(t.getHours()+parseInt(this.model.startHour)+parseInt(n/60)),t.setMinutes(t.getMinutes()+parseInt(n%60)),t.setMinutes(Math.round(t.getMinutes()/10)*10),t},_createTemplate:function(t,i){var r=document.createElement("script");return r.id=this._id+i+"_Template",r.type="text/x-jsrender",r.text=t,n("body").append(r),r},_documentOnKeyDown:function(n){if(this.model.allowKeyboardNavigation){var t=n.target||document.activeElement||n.srcElement;n.which==27?this._processEscapeKey():n.which==13?this._processEnterKey(t):n.shiftKey==!1&&n.which==9&&this._processWindowTab(t)}},_processWindowTab:function(t){n(t).hasClass("qAppDone")?this._quickAppointWindow.find(".subject").focus():n(t).hasClass("e-appointcancel")||n(t).hasClass("e-cancelrecur")?this._appointmentAddWindow.find(".subject").focus():n(t).hasClass("e-editseries")&&this.model.showQuickWindow&&this._quickAppDetailsWindow.focus()},_onKeyDown:function(i){var u,r,f;if(this.model.allowKeyboardNavigation){if(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),u=this.element.find("div.e-draggableworkarea tr"),r=i.target||document.activeElement||i.srcElement,i.shiftKey==!1&&i.which==38)this._stopDefaultAction(i),this._processUpArrow(r,u);else if(i.shiftKey==!1&&i.which==40)this._stopDefaultAction(i),this._processDown(r,u);else if(i.ctrlKey==!1&&i.shiftKey==!1&&i.which==39)this._stopDefaultAction(i),this._processRight(r,u);else if(i.ctrlKey==!1&&i.shiftKey==!1&&i.which==37)this._stopDefaultAction(i),this._processLeft(r,u);else if(i.altKey==!0&&i.which==67)this._stopDefaultAction(i),this.element.find(".e-datedisplay").click();else if(i.ctrlKey==!0&&i.which==37)this._stopDefaultAction(i),this.element.find("div.e-navigateprevious").click(),this.element.find("div.e-navigateprevious").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())});else if(i.ctrlKey==!0&&i.which==39)this._stopDefaultAction(i),this.element.find("div.e-navigatenext").click(),this.element.find("div.e-navigatenext").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())});else if(i.altKey==!0&&i.which==107||i.altKey==!0&&i.which==187||i.altKey==!0&&i.which==61)this._stopDefaultAction(i),this._navigateToolbarRight(i);else if(i.altKey==!0&&i.which==189||i.altKey==!0&&i.which==109||i.altKey==!0&&i.which==45||i.altKey==!0&&i.which==173)this._stopDefaultAction(i),this._navigateToolbarLeft(i);else if(i.ctrlKey==!0&&i.which==67)this._stopDefaultAction(i),this._cancel();else if(i.which==32)this._stopDefaultAction(i),n(document.activeElement)[0]===this.element.find("div.e-navigateprevious")[0]?(this.element.find("div.e-navigateprevious").click(),this.element.find("div.e-navigateprevious").attr("tabIndex",0).focus()):n(document.activeElement)[0]===this.element.find("div.e-navigatenext")[0]&&(this.element.find("div.e-navigatenext").click(),this.element.find("div.e-navigatenext").attr("tabIndex",0).focus()),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())});else if(i.altKey==!0&&i.which==78)this._stopDefaultAction(i),this._newAppWindow(r,u),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide");else if(i.ctrlKey==!0&&i.which==69)this._stopDefaultAction(i),f=this.element.find(".e-selectedAppointment"),this._editKey=!0,this._cellClick=!1,this._appointmentWindow(f),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide");else if(i.which==46){this._stopDefaultAction(i);var e=this.element.find(".e-selectedAppointment"),o=e[0].id.split("_")[1],s=this._getAppointmentByParentId(o);e.length!=0&&t.isNullOrUndefined(s[this.model.appointmentSettings.recurrenceRule])?this._deleteApp(parseInt(o)):this._deleteApp(parseInt(s[this.model.appointmentSettings.id]))}else i.shiftKey==!0&&i.which==9?(this._stopDefaultAction(i),this._reverseTab(r,i,u),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")):i.shiftKey==!1&&i.which==9?(this._stopDefaultAction(i),this._processTab(r,i,u),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")):i.shiftKey==!0&&i.which==38?(this._stopDefaultAction(i),this._processShiftUp(r,i,u)):i.shiftKey==!0&&i.which==40?(this._stopDefaultAction(i),this._processShiftDown(r,i,u)):i.shiftKey==!0&&i.which==37?(this._stopDefaultAction(i),this._processShiftLeft(r,i,u)):i.shiftKey==!0&&i.which==39&&(this._stopDefaultAction(i),this._processShiftRight(r,i,u));n(r).hasClass("e-monthcells")||this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")}},_processShiftUp:function(t,i,r){var u,o,s;if(n(t).hasClass("e-workcells")){var h=r.length-1,f=n(t).parent()[0].rowIndex,e=n(t)[0].cellIndex;f>0&&f<=h&&f!="undefined"?(u=parseInt(f)-1,u>=0&&(n(r[u].cells[e]).hasClass("e-selectedCell")?(n(r[u].cells[e]).attr("tabIndex",0).focus(),n(r[f].cells[e]).removeClass("e-selectedCell")):(n(r[f].cells[e]).addClass("e-selectedCell"),n(r[u].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus())),this._currentRowIndex=u,this._currentColIndex=e):(n(r[f].cells[e]).attr("tabIndex",0).focus(),this._currentRowIndex=f,this._currentColIndex=e)}else if(n(t).hasClass("e-monthcells")){var c=Math.floor(n(t).index()/7),h=r.length-1,l=7*(c+1),a=7*parseInt(c),f=n(t).parent()[0].rowIndex,e=n(t)[0].cellIndex;if(f>0&&f<=h&&f!="undefined")if(u=parseInt(f)-1,u>=0)if(n(r[u].cells[e]).hasClass("e-selectedCell")){for(o=e;o>=a;o--)n(r[f].cells[o]).attr("tabIndex",0).focus(),n(r[f].cells[o]).removeClass("e-selectedCell");for(s=l-1;s>=e;s--)u>=0&&(n(r[u].cells[s]).attr("tabIndex",0).focus(),n(r[u].cells[s]).removeClass("e-selectedCell"));n(r[u].cells[e]).addClass("e-selectedCell")}else{for(o=e;o>=a;o--)n(r[f].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();for(s=l-1;s>=e;s--)u>=0&&n(r[u].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else n(r[u+1].cells[e]).attr("tabIndex",0).focus();else return!1}else return!1},_processShiftDown:function(t,i,r){var e,o,s;if(n(t).hasClass("e-workcells")){var h=r.length-1,u=n(t).parent()[0].rowIndex,f=n(t)[0].cellIndex;u>=0&&u<=h&&u!="undefined"&&(n(r[u].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus(),e=parseInt(u)+1,e<=h?(n(r[e].cells[f]).hasClass("e-selectedCell")?(n(r[e].cells[f]).attr("tabIndex",0).focus(),n(r[u].cells[f]).removeClass("e-selectedCell")):(n(r[u].cells[f]).addClass("e-selectedCell"),n(r[e].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus()),this._currentRowIndex=e,this._currentColIndex=f):(n(r[u].cells[f]).attr("tabIndex",0).focus(),this._currentRowIndex=u,this._currentColIndex=f))}else if(n(t).hasClass("e-monthcells")){var c=Math.floor(n(t).index()/7),h=r.length-1,l=7*(c+1),a=7*parseInt(c),u=n(t).parent()[0].rowIndex,f=n(t)[0].cellIndex;if(u>=0&&u<=h&&u!="undefined")if(e=parseInt(u)+1,e<this._dateRender.length/7)if(n(r[e].cells[f]).hasClass("e-selectedCell")){for(o=f;o<=l-1;o++)n(r[u].cells[o]).attr("tabIndex",0).focus(),n(r[u].cells[o]).removeClass("e-selectedCell");for(s=a;s<=f;s++)e<this._dateRender.length/7&&(n(r[e].cells[s]).attr("tabIndex",0).focus(),n(r[e].cells[s]).removeClass("e-selectedCell"));n(r[e].cells[f]).addClass("e-selectedCell")}else{for(o=f;o<=l-1;o++)n(r[u].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();for(s=a;s<=f;s++)e<this._dateRender.length/7&&n(r[e].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else n(r[e-1].cells[f]).attr("tabIndex",0).focus();else return!1}else return!1},_processShiftLeft:function(t,i,r){var b=r.length-1,s,h,c,y;if(n(t).hasClass("e-workcells")){var p=t,k=this.model.currentView=="day"?1:this.model.currentView=="workweek"?5:7,w=Math.floor(n(p).index()/k),d=k*w,l=n(p)[0].cellIndex,f=n(p).parent()[0].rowIndex,e=l-1;if(l>0&&e>parseInt(d)-1&&l!="undefined"){if(n(r[f].cells[e]).hasClass("e-selectedCell")){for(s=0;s<=parseInt(f);s++)n(r[s].cells[l]).removeClass("e-selectedCell");for(h=b;h>=parseInt(f);h--)n(r[h].cells[e]).removeClass("e-selectedCell");n(r[f].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else{for(s=0;s<=parseInt(f);s++)n(r[s].cells[l]).addClass("e-selectedCell");for(h=b;h>=parseInt(f);h--)n(r[h].cells[e]).addClass("e-selectedCell");n(r[f].cells[e]).attr("tabIndex",0).focus()}this._currentRowIndex=f;this._currentColIndex=e}else n(r[f].cells[e+1]).attr("tabIndex",0).focus(),this._currentRowIndex=f,this._currentColIndex=e+1}else if(n(t).hasClass("e-monthcells")){var w=Math.floor(n(t).index()/7),b=r.length-1,a=7*(parseInt(w)+1),v=7*parseInt(w),o=n(t).parent()[0].rowIndex,u=n(t)[0].cellIndex;if(u>=v&&u<=a&&u!="undefined")newcur=parseInt(u)-1,n(r[o].cells[newcur]).hasClass("e-selectedCell")?u==v&&o>=1?(c=parseInt(o)-1,y=parseInt(a)-1,c>=0&&(n(r[c].cells[y]).attr("tabIndex",0).focus(),n(r[c].cells[u]).removeClass("e-selectedCell"),n(r[o].cells[v]).removeClass("e-selectedClass"))):u<a&&(newcur=parseInt(u)-1,n(r[o].cells[newcur]).attr("tabIndex",0).focus(),n(r[o].cells[u]).removeClass("e-selectedCell")):u==v&&o>=0?(c=parseInt(o)-1,y=parseInt(a)-1,c>=0?n(r[c].cells[y]).addClass("e-selectedCell").attr("tabIndex",0).focus():n(r[c+1].cells[u]).attr("tabIndex",0).focus()):u<a&&(newcur=parseInt(u)-1,n(r[o].cells[newcur]).addClass("e-selectedCell").attr("tabIndex",0).focus());else return}else return!1},_processShiftRight:function(t,i,r){var s,h,o;if(n(t).hasClass("e-workcells")){var v=r.length-1,y=this.model.currentView=="day"?1:this.model.currentView=="workweek"?5:7,a=Math.floor(n(t).index()/y),c=y*(a+1),f=n(t).parent()[0].rowIndex,u=n(t)[0].cellIndex,e=parseInt(u)+1;if(u>=0&&u<parseInt(c)-1&&u!="undefined"){if(n(r[f].cells[e]).hasClass("e-selectedCell")){for(s=parseInt(f);s<=v;s++)n(r[s].cells[u]).removeClass("e-selectedCell");for(h=0;h<=f;h++)n(r[h].cells[e]).removeClass("e-selectedCell").attr("tabIndex",0).focus();n(r[f].cells[e]).addClass("e-selectedCell")}else{for(s=parseInt(f);s<=v;s++)n(r[s].cells[u]).addClass("e-selectedCell");for(h=0;h<=f;h++)n(r[h].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()}this._currentRowIndex=f;this._currentColIndex=e}else n(r[f].cells[u]).attr("tabIndex",0).focus()}else if(n(t).hasClass("e-monthcells")){var a=Math.floor(n(t).index()/7),v=r.length-1,l=c=7*(parseInt(a)+1),p=7*parseInt(a),f=n(t).parent()[0].rowIndex,u=n(t)[0].cellIndex,e=parseInt(u)+1;if(u>=0&&u<=parseInt(c)-1&&u!="undefined")n(r[f].cells[e]).hasClass("e-selectedCell")?(e<l&&(n(r[f].cells[e]).attr("tabIndex",0).focus(),n(r[f].cells[u]).removeClass("e-selectedCell")),u==parseInt(c)-1&&f<this._dateRender.length/7&&(o=parseInt(f)+1,u=p,o<this._dateRender.length/7&&(n(r[o].cells[u]).removeClass("e-selectedCell").attr("tabIndex",0).focus(),e<l&&(n(r[o].cells[e]).attr("tabIndex",0).focus(),n(r[o].cells[u]).removeClass("e-selectedCell"))))):(e<l&&n(r[f].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus(),u==parseInt(c)-1&&f<this._dateRender.length/7&&(o=parseInt(f)+1,u=p,o<this._dateRender.length/7?(n(r[o].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus(),e<l&&n(r[o].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(r[o-1].cells[e-1]).attr("tabIndex",0).focus()));else return!1}else return!1},_processEnterKey:function(t){var u,f,r,i;n(t).hasClass("e-workcells")||n(t).hasClass("e-monthcells")||n(t).hasClass("e-alldaycells")?(u=this.element.find("td.e-selectedCell"),f=u.length-1,f==0?this._cellSelection(t):this._multipleCellAppointCreation(t)):n(t).hasClass("e-detailedapp e-detailedwindow")?this._appointmentWindow(t):n(t).parent().hasClass("e-allday")?(r=this._appointmentAddWindow.find("#"+this._id+"allday").data("ejCheckBox"),i=r.isChecked?!1:!0,this._appointmentAddWindow.find(".allday").ejCheckBox({checked:i})):n(t).parent().hasClass("e-recurrence")?(r=this._appointmentAddWindow.find("#"+this._id+"recurrence").data("ejCheckBox"),i=r.isChecked?!1:!0,this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:i}),this._recurChecked=i?!0:!1,this._repeat(t)):n(t).hasClass("e-scheduledelete")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-scheduledelete").click():n(t).hasClass("e-editevent")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-editevent").click():n(t).hasClass(".e-editseries")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-editseries").click():n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment")?this._cellSelection(t):n(t).parent().hasClass("e-weekday")&&(r=this._appointmentAddWindow.find("#"+n(t).children()[0].id).data("ejCheckBox"),i=r.isChecked?!1:!0,this._appointmentAddWindow.find("#"+n(t).children()[0].id).ejCheckBox({checked:i}))},_findMinMaxCellIndex:function(){var f=this.element.find("div.e-draggableworkarea tr"),s=f.length-1,i,t,e,o,r,u=this.currentView(),h=u=="day"?1:u=="workweek"?5:7,c=this;return this.element.find("td.e-selectedCell").each(function(h,c){var l=n(c).index(),a;if(l!=null&&!isNaN(l))if(i==null?(i=l,e=n(c).parent()[0].rowIndex):i<l?i=i:i!=l&&(i=l,e=n(c).parent()[0].rowIndex),t==null){if(t=l,u!="month")for(r=parseInt(t),a=0;a<=s;a++)n(f[a].cells[r]).hasClass("e-selectedCell")&&(o=a)}else if(t>l)t=t;else if(t!=l&&(t=l,u!="month"))for(r=parseInt(t),a=0;a<=s;a++)n(f[a].cells[r]).hasClass("e-selectedCell")&&(o=a)}),{rowInx:e,maxrowInx:o,omincolIndex:i,omaxcolIndex:t}},_multipleCellAppointCreation:function(t){var r=this._findMinMaxCellIndex(),s=this.dateRender,l=r.omincolIndex,a=r.omaxcolIndex,v=r.rowInx,y=r.maxrowInx,p=s[l],w=s[a],u=Globalize.culture(this.model.locale),f,e,h,c;if(n(t).hasClass("e-workcells"))f=(this.model.startHour+v/2).toString().split("."),e=(this.model.startHour+y/2).toString().split("."),this.cur_StartTime=new Date(p).setHours(parseInt(f[0]),parseInt(f[1])==5?30:00),this.cur_EndTime=new Date(w).setHours(parseInt(e[0]),parseInt(e[1])==5?30:00),this.cur_EndTime=new Date(new Date(this.cur_EndTime).setMinutes(new Date(this.cur_EndTime).getMinutes()+30));else if(n(t).hasClass("e-monthcells")){var i=this.element.find("td.e-selectedCell"),o=i.length-1,b=n(i[0]).parent().index()*7+(n(i[0]).index()-Math.floor(n(i[0]).index()/7)*7),k=n(i[o]).parent().index()*7+(n(i[o]).index()-Math.floor(n(i[o]).index()/7)*7),d=new Date(this._dateRender[b]),g=new Date(this._dateRender[k]);this.cur_StartTime=new Date(new Date(d).setHours(9));this.cur_StartTime=new Date(this.cur_StartTime).setMinutes(00);this.cur_EndTime=new Date(new Date(g).setHours(9));this.cur_EndTime=new Date(new Date(this.cur_EndTime).setMinutes(30))}this.model.showQuickWindow&&(this._quickAppointWindow.find("#"+this._id+"_quickAppwindow").css("display","block"),(new Date(this.cur_EndTime)-new Date(this.cur_StartTime))/36e5<24?this._quickAppointWindow.find(".e-quickstartend").html(u.calendar.days.names[new Date(this.cur_StartTime).getDay()]+", "+Globalize.format(new Date(this.cur_StartTime),"MMMM")+" "+new Date(this.cur_StartTime).getDate()+", "+Globalize.format(new Date(this.cur_StartTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")+" - "+Globalize.format(new Date(this.cur_EndTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")):this._quickAppointWindow.find(".e-quickstartend").html(u.calendar.days.names[new Date(this.cur_StartTime).getDay()]+", "+Globalize.format(new Date(this.cur_StartTime),"MMMM")+" "+new Date(this.cur_StartTime).getDate()+", "+Globalize.format(new Date(this.cur_StartTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")+" - "+u.calendar.days.names[new Date(this.cur_EndTime).getDay()]+", "+Globalize.format(new Date(this.cur_EndTime),"MMMM")+" "+new Date(this.cur_EndTime).getDate()+", "+Globalize.format(new Date(this.cur_EndTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")),this._quickAppointWindow.find(".subject").val(""),h=t.offsetLeft,c=t.offsetTop,this._quickAppointWindow.ejDialog({position:{X:h,Y:c}}),this._quickAppointWindow.ejDialog("open"),this._quickAppointWindow.find(".subject").focus());this._cellClick=!0},_addCellSelection:function(t){var i=this.element.find("td.e-selectedCell"),r=i.length-1;r>0&&(this.element.find("td.e-selectedCell").removeClass("e-selectedCell"),n(t[this._currentRowIndex].cells[this._currentColIndex]).addClass("e-selectedCell").attr("tabIndex",0).focus())},_processUpArrow:function(t,i){var e,r,u;if(n(t).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(i[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(t).hasClass("e-selectedCell")&&this._addCellSelection(i),e=this.element.find(".e-alldaycells"),n(t).hasClass("e-workcells")){var o=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)-1;r>0&&r<=o&&r!="undefined"?(n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):r==0&&(r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(this.element).attr("tabIndex",0).focus(),n(e[u]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else{if(n(t).hasClass("e-alldaycells"))return!1;if(n(t).hasClass("e-monthcells")){var o=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)-1;if(r>=0&&r<=o&&r!="undefined")f>=0?(n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1}else return!1}},_processDown:function(t,i){var o,s;if(n(t).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(i[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(t).hasClass("e-selectedCell")&&this._addCellSelection(i),n(t).hasClass("e-workcells")){var e=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)+1;r>=0&&r<=e&&r!="undefined"&&(f<=e?(n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[r].cells[u]).attr("tabIndex",0).focus())}else if(n(t).hasClass("e-alldaycells"))o=this.element.find("td.e-selectedCell")[0].cellIndex-1,s=this.element.find(".e-alldaycells"),n(s[o]).removeClass("e-selectedCell").blur(),n(i[0].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(n(t).hasClass("e-monthcells")){var e=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)+1;r>=0&&r<e&&r!="undefined"&&(f<=7?(n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[f-1].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else return!1},_processRight:function(i,r){var o,h;if(n(i).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i).hasClass("e-selectedCell")&&this._addCellSelection(r),n(i).hasClass("e-workcells")||n(i).hasClass("e-monthcells")){o=this.currentView()=="day"?1:this.currentView()=="workweek"?5:7;maxcolindex=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?this.render_Resources[this.render_Resources.length-1].length*o:o;var s=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,l=parseInt(u)+1;if(u>=0&&u<parseInt(maxcolindex)-1&&u!="undefined")n(r[s].cells[u]).removeClass("e-selectedCell").blur(),n(r[s].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(u==parseInt(maxcolindex)-1)h=n(i).parent()[0].rowIndex,this.element.find("div.e-navigatenext").click(),n(r[h].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1}else if(n(i).hasClass("e-alldaycells")){var f=this.element.find("td.e-selectedCell")[0].cellIndex-1,e=this.element.find(".e-alldaycells"),c=parseInt(e.length)-1,a=parseInt(f)+1;if(f>=0&&f<c)n(e[f]).removeClass("e-selectedCell").blur(),n(e[a]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(f==c)this.element.find("div.e-navigatenext").click(),n(e[0]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1}},_processLeft:function(i,r){var s,c;if(n(i).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i).hasClass("e-selectedCell")&&this._addCellSelection(r),n(i).hasClass("e-workcells")||n(i).hasClass("e-monthcells")){s=this.currentView()=="day"?1:this.currentView()=="workweek"?5:7;e=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?this.render_Resources[this.render_Resources.length-1].length*s:s;var h=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,l=parseInt(u)-1;if(u>0&&u<=parseInt(e)-1&&u!="undefined")n(r[h].cells[u]).removeClass("e-selectedCell").blur(),n(r[h].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(u==0)c=n(i).parent()[0].rowIndex,this.element.find("div.e-navigateprevious").click(),n(r[c].cells[e-1]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1}else if(n(i).hasClass("e-alldaycells")){var e=this.currentView()=="day"?1:this.currentView()=="workweek"?5:7,f=this.element.find("td.e-selectedCell")[0].cellIndex-1,o=this.element.find(".e-alldaycells"),a=parseInt(o.length)-1,v=parseInt(f)-1;if(f>0&&f<=a)n(o[f]).removeClass("e-selectedCell").blur(),n(o[v]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(f==0)this.element.find("div.e-navigateprevious").click(),n(o[e-1]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1}},_navigateToolbarRight:function(n){var t=this.model.views,i=this.element.find(".e-"+this.currentView()).parent().index(),r;i<t.length-1&&(r=t[i+1].toLowerCase(),this._navView=!0,this._viewChange(n,this.currentView(),r),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}))},_navigateToolbarLeft:function(n){var t=this.element.find(".e-"+this.currentView()).parent().index(),i;t>0&&(i=this.model.views[t-1].toLowerCase(),this._navView=!0,this._viewChange(n,this.currentView(),i),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}))},_renderResourceData:function(n,i){var o,l,y,a,h,p,c,v,u,r,s,f,e;if(!t.isNullOrUndefined(this.model.resources)&&this.model.resources.length>0){for(o=this.model.currentView==="week"||this.model.currentView==="month"?7:this.model.currentView==="workweek"?5:1,i=this.model.currentView==="month"?n.index():i,v=[],this._resIdCollection=[],u=this._getResourceCollection(),r=0;r<u.length;r++)this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");for(this.resourceId=[],r=u.length-1;r>=0;r--)r==u.length-1?t.isNullOrUndefined(this.model.group)?(this.resourceId.push({id:this.render_Resources[r][parseInt(i/o)][u[r].id],value:this.render_Resources[r][parseInt(i/o)][u[r].text]}),l=this.render_Resources[r][parseInt(i/o)][u[r].groupId]):(this.resourceId.push({id:this.res1[parseInt(i/o)][u[r].id],value:this.res1[parseInt(i/o)][u[r].text]}),l=this.res1[parseInt(i/o)][u[r].groupId]):(y=u[r].dataSource instanceof t.DataManager?u[r].dataSource:t.DataManager(u[r].dataSource),a=(new t.Query).where("id",t.FilterOperators.equal,l),h=y.executeLocal(a),this._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByText(h[0][u[r].text]),this.resourceId.push({id:h[0][u[r].id],value:h[0][u[r].text]}),l=h[0][u[r].groupId]);for(f=0,e=this.render_Resources.length-1;f<this.render_Resources.length-1;f++,e--){for(p=this.render_Resources[f+1]instanceof t.DataManager?this.render_Resources[f+1]:t.DataManager(this.render_Resources[f+1]),a=(new t.Query).where("groupId",t.FilterOperators.equal,this.resourceId[e][u[e].id]),c=p.executeLocal(a),v=[],s=0;s<c.length;s++)v.push({text:c[s][u[f+1].text],value:c[s][u[f+1].id],color:c[s][u[f+1].color]});this._appointmentAddWindow.find(".owner_"+(f+1)).ejAutocomplete("clearText");this._appointmentAddWindow.find(".owner_"+(f+1)).ejAutocomplete("option","dataSource",v)}for(f=0,e=this.render_Resources.length-1;f<this.render_Resources.length-1;f++,e--)this._appointmentAddWindow.find(".owner_"+(f+1)).data("ejAutocomplete").selectValueByKey(this.resourceId[e-1][u[e-1].id])}},_newAppWindow:function(i){var l,o;if(n(i).hasClass("e-selectedCell")){this._currentAction=t.Schedule.Actions.Add;var r=i==null?event:i,y=n(r).parent().index(),ft=n(r).index(),e=this.dateRender,p=this.element.find("td.e-selectedCell"),h=parseInt(p.length)-1,c=n(r).hasClass("e-workcells")?n(r).index():n(r).hasClass("e-alldaycells")?n(r).index()-1:n(r).parent().index()*7+(n(r).index()-Math.floor(n(r).index()/7)*7);if(h==0)startdate=new Date(e[c]),n(r).hasClass("e-workcells")?(l=this.model.startHour+y/2,o=l.toString().split("."),startTime=new Date(startdate).setHours(parseInt(o[0]),parseInt(o[1])==5?30:00),endTime=new Date(new Date(startTime).setMinutes(new Date(startTime).getMinutes()+30))):n(r).hasClass("e-alldaycells")?(startTime=new Date(startdate.setHours(0,0)),endTime=new Date(startTime.setHours(0,0)),this._appointmentAddWindow.find(".allday ").ejCheckBox({checked:!0})):n(r).hasClass("e-monthcells")&&(startTime=new Date(new Date(startdate).setHours(9)),startTime=new Date(startTime).setMinutes(00),endTime=new Date(new Date(startTime).setMinutes(30)));else if(h>0){var f=this._findMinMaxCellIndex(),w=f.omincolIndex,b=f.omaxcolIndex,k=f.rowInx,d=f.maxrowInx;if(n(i).hasClass("e-workcells")){var g=e[w],nt=e[b],a=(this.model.startHour+k/2).toString().split("."),v=(this.model.startHour+d/2).toString().split(".");startTime=new Date(new Date(g).setHours(parseInt(a[0]),parseInt(a[1])==5?30:00));endTime=new Date(nt).setHours(parseInt(v[0]),parseInt(v[1])==5?30:00);endTime=new Date(new Date(endTime).setMinutes(new Date(endTime).getMinutes()+30))}else if(n(i).hasClass("e-monthcells")){var u=this.element.find("td.e-selectedCell"),s=u.length-1,tt=n(u[0]).parent().index()*7+(n(u[0]).index()-Math.floor(n(u[0]).index()/7)*7),it=n(u[s]).parent().index()*7+(n(u[s]).index()-Math.floor(n(u[s]).index()/7)*7),rt=new Date(this._dateRender[tt]),ut=new Date(this._dateRender[it]);startTime=new Date(new Date(rt).setHours(9));startTime=new Date(new Date(startTime).setMinutes(00));endTime=new Date(new Date(ut).setHours(9));endTime=new Date(new Date(endTime).setMinutes(30))}}this._renderResourceData(n(r),c);this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",Globalize.format(new Date(startTime),this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",Globalize.format(new Date(endTime),this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(new Date(startTime),this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(new Date(endTime),this._pattern.t));(n(i).hasClass("e-alldaycells")||this.currentView()=="month")&&this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0});this._alldayCheck();this.model.timeZone==null?(this._appointmentAddWindow.find("#startutc").val("UTC "+Globalize.format(new Date(startTime),"zzz")),this._appointmentAddWindow.find("#endutc").val("UTC "+Globalize.format(new Date(endTime),"zzz"))):(this._appointmentAddWindow.find("#startutc").val(this.model.timeZone),this._appointmentAddWindow.find("#endutc").val(this.model.timeZone));this._appointmentAddWindow.ejDialog("open");this._appointmentAddWindow.find(".subject").focus();this._cellClick=!1}},_processTab:function(t,i,r){var u=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment"),s,c,e,o,f,h;if((t.id==this._id||n(t).hasClass("e-datedisplay"))&&(u.length!=0?n(u[0]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()),n(t).hasClass("e-selectedCell")&&u.length!=0){if(s=this.element.find("td.e-selectedCell"),c=parseInt(s.length)-1,c>0)for(e=0;e<=c;e++)s[e].blur(),n(s[e]).removeClass("e-selectedCell");else n(t).removeClass("e-selectedCell").blur();n(u[0]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()}n(t).hasClass("e-navigateprevious")?this.element.find(".e-navigatenext").attr("tabIndex",0).focus():n(t).hasClass("e-navigatenext")&&n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus();(n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment"))&&(o=u.length,f=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment").index(n(".e-selectedAppointment")),f<o&&f>=0?(n(u[f]).removeClass("e-selectedAppointment").blur(),h=parseInt(f)+1,h<o?n(u[h]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():h==o&&this.element.find(".e-navigateprevious").attr("tabIndex",0).focus()):f==o&&this.element.find(".e-navigateprevious").attr("tabIndex",0).focus())},_reverseTab:function(t,i,r){var u=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment"),h,e,c,l,o,f,s;if((t.id==this._id||n(t).hasClass("e-datedisplay"))&&(e=parseInt(u.length)-1,u.length!=0&&n(u[e]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()),h=u.length,n(t).hasClass("e-selectedCell")&&(e=u.length-1,u.length!=0)){if(c=this.element.find("td.e-selectedCell"),l=parseInt(c.length)-1,l>0)for(o=0;o<=l;o++)n(c[o]).removeClass("e-selectedCell").blur();else n(t).removeClass("e-selectedCell").blur();n(u[e]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()}n(t).hasClass("e-navigatenext")?n(this.element).find(".e-navigateprevious").attr("tabIndex",0).focus():n(t).hasClass("e-navigateprevious")&&n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus();(n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment"))&&(f=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment").index(n(".e-selectedAppointment")),f<h&&f>0?(n(u[f]).removeClass("e-selectedAppointment").blur(),s=parseInt(f)-1,s<h&&f>=0?n(u[s]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():s==0&&n(this.element).find(".e-navigatenext").attr("tabIndex",0).focus()):f==0&&(n(u[f]).removeClass("e-selectedAppointment").blur(),n(this.element).find(".e-navigatenext").attr("tabIndex",0).focus()))},_stopDefaultAction:function(n){n.cancelBubble=!0;n.returnValue=!1;n.stopPropagation();n.preventDefault()},_getLocalizedLabels:function(n){return t.Schedule.Locale[this.model.locale][n]===i?t.Schedule.Locale["en-US"][n]:t.Schedule.Locale[this.model.locale][n]},saveAppointment:function(n){var i=this._sortAppById(this._processed),r;r=i.length>0?i[i.length-1][this.model.appointmentSettings.id]+1:1;t.isNullOrUndefined(n[this.model.appointmentSettings.id])||n[this.model.appointmentSettings.id]==""?(n[this.model.appointmentSettings.id]=r,this._dataManager.insert(n),this._appointmentProcessing(n)):(this._dataManager.update(this.model.appointmentSettings.id,n),n[this.model.appointmentSettings.recurrence]?this._dataProcessing(this._currentAppointmentData):new t.DataManager(this._processed).update(this.model.appointmentSettings.id,n));this._renderAppointmentAll()},deleteAppointment:function(n){this._deleteApp(n)},getAppointments:function(){return this.dataSource()}});t.Schedule.Locale={};t.Schedule.Locale["en-US"]={ReminderWindowTitle:"Reminder window",CreateAppointmentTitle:"Create Appointment",RecurrenceEditTitle:"Edit repeat appointment",RecurrenceEditMessage:"How would you like to change the event in the series?",RecurrenceEditOnly:"Only this appointment",RecurrenceEditSeries:"Entire series",PreviousAppointment:"Previous Appointment",NextAppointment:"Next Appointment",AppointmentSubject:"Subject",StartTime:"Start Time",EndTime:"End Time",AllDay:"All day",Today:"Today",Recurrence:"Repeat",Done:"Done",Cancel:"Cancel",Ok:"Ok",RepeatBy:"Repeat by",RepeatEvery:"Repeat every",RepeatOn:"Repeat on",StartsOn:"Starts on",Ends:"Ends",Summary:"Summary",Daily:"Daily",Weekly:"Weekly",Monthly:"Monthly",Yearly:"Yearly",Every:"Every",EveryWeekDay:"Every weekday",Never:"Never",After:"After",Occurence:"Occurrence(s)",On:"On",Edit:"Edit",RecurrenceDay:"Day(s)",RecurrenceWeek:"Week(s)",RecurrenceMonth:"Month(s)",RecurrenceYear:"Year(s)",The:"The",OfEvery:"of every",First:"First",Second:"Second",Third:"Third",Fourth:"Fourth",Last:"Last",WeekDay:"Weekday",WeekEndDay:"Weekendday",Subject:"Subject",DueIn:"Due In",DismissAll:"Dismiss All",Dismiss:"Dismiss",OpenItem:"Open Item",Snooze:"Snooze",Day:"Day",Week:"Week",WorkWeek:"Work Week",Month:"Month",Agenda:"Agenda",Detailed:"Detailed",EventBeginsin:"Appointment Begins in",Editevent:"Edit Appointment",Editseries:"Edit series",Times:"times",Until:"until",Eventwas:"Appointment was",Hours:"hrs",Minutes:"mins",Overdue:"Overdue Appointment",Days:"day(s)",Event:"Subject",Select:"select",Previous:"prev",Next:"next",Close:"close",Delete:"delete",Date:"Date",Showin:"Show in",Gotodate:"Go To Date"};t.Schedule.Actions={Add:"add",Save:"save",Delete:"delete",EditOcurrence:"editOcurrence",EditSeries:"editSeries"};t.Schedule.CurrentView={Day:"day",Week:"week",Workweek:"workweek",Month:"month"};t.Schedule.TimeMode={Hour12:"12",Hour24:"24"}})(jQuery,Syncfusion)