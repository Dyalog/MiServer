/*!
*  filename: ej.schedule.min.js
*  version : 12.4.0.24
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.touch.min","./../common/ej.draggable.min","./../common/ej.scroller.min","./ej.button.min","./ej.checkbox.min","./ej.autocomplete.min","./ej.datepicker.min","./ej.dialog.min","./ej.dropdownlist.min","./ej.togglebutton.min","./ej.radiobutton.min","./ej.timepicker.min","./ej.editor.min"],n):n()})(function(){(function(n,t){t.scheduleFeatures=t.scheduleFeatures||{};var i=function(){return this._horiDateHeader="{{if multiRes == true}}<td class = 'e-horizontalheader'><div class='e-horizontalresheader'>RESOURCES<\/div><\/td>{{else}}<td><\/td>{{/if}}<td class='e-horizontaldaterender' style='height:100%;'><div class='e-horizontaltimecells' style='height:{{:height}}px;'><div class='e-headerdays' style='position:absolute;'><table class ='e-table' cellpadding='0px' cellspacing='0px' style='width:100%;border-collapse:separate;'><tbody>{{if view !== 'month'}}<tr style='width:100%;'> <td>{{if view === 'day'}}<table style='width:100%;'>{{else}}<table cellspacing='0px'>{{/if}}<tbody><tr> {{for cols ~headercellWidth = headercellWidth}}<td class='e-headercells {{:cellToday}} e-horizontalheadertddate'><div class='{{:currentDateClass}} e-horizontalheaderdiv'>{{:currentDay}}<\/div><\/td>{{/for}} <\/tr><\/tbody><\/table><\/td> <\/tr><tr style='width:100%;position:absolute;'> <td><table class ='e-horizontaltabletimecell' cellspacing='0px' style='border-collapse:collapse;'><tbody><tr> {{for timeTdCount }}{{for ~name=time ~dayend=timecellclass}}<td class='e-horizontaltimetd {{:~dayend}}'><div style='width:{{:cellWidth}}'><span class ='e-horizontaltimespan'>{{:~name.slice(0,2)}}<\/span><div class ='e-horizontaltimespandiv'>{{:~name.slice(3,5)}}<\/div><\/div><\/td><td class='e-horizontalalternatetd'><div style='width:{{:cellWidth}}'><\/div><\/td>{{/for}}{{/for}}  <\/tr><\/tbody><\/table><\/td> <\/tr>{{/if}}{{if view == 'month'}}<tr>{{for cols}}<td class='e-headercells e-horizontmonthheaderdatetd {{:cellToday}}'><div class='e-dateheadercell e-horizontmonthdatealign'>{{:currentDate}}<\/div><\/td>{{/for}}<\/tr><tr>{{for cols}}<td class ='e-horizontmonthheaderdaytd'><div class='e-dateheadercell e-horizontmonthdatealign' style='width:{{:cellWidth}}'>{{:currentDay}}<\/div><\/td>{{/for}}<\/tr>{{/if}}<\/tbody><\/table><\/div><\/div><\/td>",this._horiDateHeader},r=function(){return this._horizontalResHeader="<div class ='e-horizontresdiv'><div class='e-horires' style='height:100%'><table class='e-table e-resourceheadertable' height='100%' width='100%' cellpadding='0px' cellspacing='0px'><tbody>{{for trs}}<tr>{{for ~resname=name ~marginleft=marginleft }}{{if classname == 'e-parentnode'}}<td class='{{:classname}}' style='width:25px;height:{{:cellHeight}}'><\/td>{{else}}<td style='width:25px;height:{{:cellHeight}}'><\/td>{{/if}}<td class='{{:classname}}' style='vertical-align:middle;height:{{:cellHeight}}'><div style='text-align:left;margin-left:{{:~marginleft}};'>{{if userResTemplId == true}}{{:userResHeader}}{{else}}{{:~resname}}{{/if}}<\/div><\/td>{{if classname == 'e-parentnode'}}<td id={{:idnum}} class='{{:classname}} {{:classname}}category e-resourceicon e-resourcecollapse' style='width:25px;vertical-align:middle;height:{{:cellHeight}}'><\/td>{{else}}<td class='{{:classname}} {{:classname}}category' style='width:25px;height:{{:cellHeight}}'><\/td>{{/if}}{{/for}}<\/tr>{{/for}}<\/tbody><\/table><\/div><\/div><div class='e-resfootertr' style='height:18px;'><\/div>",this._horizontalResHeader},u=function(){return this._cellsTemplate="<table class='e-table e-workcellstab' height='100%' cellpadding='0px' cellspacing='0px'><tbody>{{for cellrows ~cols=cols ~view=view ~classname=classname ~tdWidth=tdWidth}}{{if classname == 'e-parentnode'}} <tr style='width:100%'>{{for ~cols ~tdWidth=tdWidth}}{{if #index % 24 == 0 && #index != 0 && ~view !== 'month' }}<td class='e-resourceheadercells e-workcells e-parentworkcell e-dayend' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{else}}<td class='e-resourceheadercells e-workcells e-parentworkcell' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{/if}}<div class='e-appointwrapper'><\/div><\/td>{{if ~view !== 'month'}}<td class='e-resourceheadercells e-workcells e-parentworkcell e-alternateworkcell' style='width:{{:cellWidth}};height:{{:cellHeight}}'><div class='e-appointwrapper'><\/div><\/td>{{/if}}{{/for}}<\/tr>{{else}}<tr style='width:100%'>{{for ~cols ~tdWidth=tdWidth}}{{if #index % 24 == 0 && #index != 0 && ~view !== 'month' }}<td class='e-workcells e-childworkcell e-dayend' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{else}}<td class='e-workcells e-childworkcell' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{/if}}<div class='e-appointwrapper'><\/div><\/td>{{if ~view !== 'month'}}<td class='e-workcells e-childworkcell e-alternateworkcell' style='width:{{:cellWidth}};height:{{:cellHeight}}'><div class='e-appointwrapper'><\/div><\/td>{{/if}}{{/for}}<\/tr>{{/if}}{{/for}}<\/tbody><\/table>",this._cellsTemplate};t.scheduleFeatures.horizontal={_renderHorizontalTemplates:function(){this.horizontalHeader=n.templates(this._createTemplate(i(),"_HorizontalHeader"));this.cellTemplate=n.templates(this._createTemplate(u(),"_HorizontalCells"));this.horizontalResHeader=n.templates(this._createTemplate(r(),"_HorizontalResources"))},_horizontalViewNavigation:function(i){var e,f,u,o,r;if(i.type=="click"){if(this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7){if(this.element.find(".e-headercells").children().removeClass("e-activeview"),f=i.currentTarget.cellIndex,r=this._getRenderDates()[f],this.model.minDate<=r&&this.model.maxDate>=r)n(i.currentTarget).children().addClass("e-activeview"),this.currentDate(r);else return!1;this.model.highlightBusinessHours!=!0||t.isNullOrUndefined(this.model.businessStartHour)?(e=this.element.find(".e-workcells")[f*48].offsetLeft,n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-e+"px"),n("div#"+this._id+"_scroller").ejScroller({scrollLeft:e})):this._businessHourScroller()}else if(this.currentView()=="month"||this._isCustomView()){if(f=i.currentTarget.cellIndex,this.model.views.indexOf("Day")==-1)return!1;if(r=this.monthDays[f],this.model.minDate<=r&&this.model.maxDate>=r)this.currentDate(r);else return!1;newView="day";this._navView=!0;this._viewChange(i,this.currentView(),newView)}}else if(i.type=="dblclick"&&(this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7)){if(u=n(i.target),o=u.hasClass("e-headercells")?u:u.parent().hasClass("e-headercells")?u.parent():u.parent().parent(),this.model.views.indexOf("Day")==-1||!o.hasClass("e-headercells"))return!1;if(r=this._getRenderDates()[o.index()],this.model.minDate<=r&&this.model.maxDate>=r)this.currentDate(r);else return!1;newView="day";this._navView=!0;this._viewChange(i,this.currentView(),newView)}},_renderHorizontalHeaderDays:function(i){var u,f,r;if(this.currentView()!=="month"&&!this._isCustomView())for(r=0;r<this._dateRender.length;r++)u=this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?i.calendar.days.names[new Date(this._dateRender[r]).getDay()]:i.calendar.days.names[new Date(this._dateRender[r]).getDay()].slice(0,3):i.calendar.days.names[new Date(this._dateRender[r]).getDay()].slice(0,3),f=this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?u+" "+Globalize.format(new Date(this._dateRender[r]),"dd MMMM yyyy"):u+" "+Globalize.format(new Date(this._dateRender[r]),"dd MMM yy"):u+" "+new Date(this._dateRender[r]).getDate(),n(this.element.find(".e-headercells")[r]).find("div")[0].innerHTML=f},_horizontalScroll:function(t,i){if(i.currentView()=="week"||i.currentView()=="workweek"||this.currentView()==="customview"&&this._renderDays<=7){var u=n(i.element.find(".e-headercells").find(".e-activeview").parent()).index(),r=Math.floor(t.scrollLeft/(i.element.find(".e-workcells").width()+1)/48);u!==r&&i.element.find(".e-headercells").children().removeClass("e-activeview");n(i.element.find(".e-headercells")[r]).children().addClass("e-activeview")}},_getHorizontalheaderCellCount:function(n){for(var r,u=[],i=0;i<this._dateRender.length;i++)curday=this.currentView()==="month"||this.currentView()==="day"||this._isCustomView()?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?n.calendar.days.names[new Date(this._dateRender[i]).getDay()]:n.calendar.days.names[new Date(this._dateRender[i]).getDay()].slice(0,3):n.calendar.days.names[new Date(this._dateRender[i]).getDay()].slice(0,3),r=Globalize.format(new Date(this._dateRender[i]),this._pattern.d)===Globalize.format(new Date,this._pattern.d)?"e-headerToday":"",temp=this.currentView()==="month"||this._isCustomView()?{currentDay:curday,currentDateClass:"",cellToday:r,cellWidth:this.model.cellWidth}:this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?{currentDay:curday+" "+Globalize.format(new Date(this._dateRender[i]),"dd MMMM yyyy"),currentDateClass:"",cellToday:r,cellWidth:this.model.cellWidth}:{currentDay:curday+" "+Globalize.format(new Date(this._dateRender[i]),"dd MMM yy"),currentDateClass:"",cellToday:r,cellWidth:this.model.cellWidth}:{currentDay:curday+" "+new Date(this._dateRender[i]).getDate(),currentDateClass:new Date(this._dateRender[i]).getDate()===new Date(this.currentDate()).getDate()?"e-activeview":"",cellToday:r,cellWidth:this.model.cellWidth},u.push(temp);return u},_getHoriStartEndTime:function(n){for(var t,r=[],u=this.currentView()=="week"?7:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:5,i=0;i<u;i++)for(t=this.model.startHour;t<this.model.endHour;t++)this.model.timeMode==="12"?(timelist=(t===this.model.startHour||t===12)&&n.AM&&n.PM?Globalize.format(new Date((new Date).setHours(t)),"hh tt"):Globalize.format(new Date((new Date).setHours(t)),"hh 00"),r.push({time:timelist,id:t,timecellclass:t%48==0&&i!=0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight})):r.push({time:(t<=9?"0"+t:t)+" 00",timecellclass:t%48==0&&i!=0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight});return r},_getHorizontalDayAppointments:function(n,i,r,u){for(var f=0;f<n.length;f++)!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?Globalize.format(new Date(i[r]),this._pattern.d)==Globalize.format(new Date(n[f][this.model.appointmentSettings.startTime]),this._pattern.d)&&Globalize.format(new Date(i[r]),this._pattern.d)<=Globalize.format(new Date(n[f][this.model.appointmentSettings.endTime]),this._pattern.d)&&n[f][this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]==this.res1[u].id&&Globalize.format(new Date(n[f][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(n[f][this.model.appointmentSettings.endTime]),this._pattern.d)&&this._appList.push(n[f]):Globalize.format(new Date(i[r]),this._pattern.d)==Globalize.format(new Date(n[f][this.model.appointmentSettings.startTime]),this._pattern.d)&&Globalize.format(new Date(i[r]),this._pattern.d)<=Globalize.format(new Date(n[f][this.model.appointmentSettings.endTime]),this._pattern.d)&&Globalize.format(new Date(n[f][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(n[f][this.model.appointmentSettings.endTime]),this._pattern.d)&&this._appList.push(n[f])},_renderHorizontalApp:function(i,r,u,f,e,o,s,h){var k=this.element.find(".e-workcellstab tr"),rt=this._getResourceCollection(),d,l,y,a,tt,g,it,c,p,w,nt;if(i<=r&&(tt=new Date(i).getHours()<s?new Date(i).getHours()+-new Date(i).getHours()+-new Date(i).getMinutes():new Date(i).getHours()+-s,g=new Date(r).getHours()>h?new Date(r).getHours()+(-new Date(r).getHours()+(h-s))+-new Date(r).getMinutes():new Date(r).getHours()+-s,g=new Date(r).getHours()==h?new Date(g).getMinutes()+-new Date(r).getMinutes():g,d=20,y=0,it=0,this.model.startHour<=new Date(i).getHours())){var v=!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1?this._findResourceIndex(rt[0].dataSource,"id",u[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-2]])+1:0,b=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this._findResourceIndex(this.level_Resources,"id",u[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]])+1:1,ht=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?this._overlapApp(u[this.model.appointmentSettings.id],u[this.model.appointmentSettings.startTime],u[this.model.appointmentSettings.endTime],u[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):this._overlapApp(u[this.model.appointmentSettings.id],u[this.model.appointmentSettings.startTime],u[this.model.appointmentSettings.endTime],null),ct=this,it=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?this._getOverlapCount(u,f,this._dateRender,u[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):this._getOverlapCount(u,f,this._dateRender,null);if(y=y+it*d,u[this.model.appointmentSettings.allDay]?(diffTime=new Date(Globalize.format(new Date(r),this._pattern.d))-new Date(Globalize.format(new Date(i),this._pattern.d)),c=Math.round(diffTime/864e5)+1,c>this._dateRender.length&&(c=new Date(this._dateRender[this._dateRender.length-1]).getDay()+1-new Date(i).getDay()),diffMinutes=c*1440,cellIndex=(this.model.endHour-this.model.startHour)*o*f,l=this.element.find(".e-workcells").outerWidth()/30*diffMinutes,a="0"):new Date(Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),this._pattern.d))<new Date(Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),this._pattern.d))?(diffTime=new Date(Globalize.format(new Date(r),this._pattern.d))-new Date(Globalize.format(new Date(i),this._pattern.d)),c=Math.round(diffTime/864e5),diffMinutes=c*1440-new Date(i).getHours()*60+new Date(i).getMinutes()+(new Date(r).getHours()*60+new Date(r).getMinutes()),cellIndex=(this.model.endHour-this.model.startHour)*o*f+tt*o,l=this.element.find(".e-workcells").outerWidth()/30*diffMinutes,c>this._dateRender.length&&(c=new Date(this._dateRender[this._dateRender.length-1]).getDay()+1-new Date(i).getDay(),diffMinutes=c*1440,l=this.element.find(".e-workcells").outerWidth()/30*diffMinutes-cellIndex*25+10),a=parseFloat(new Date(i).getMinutes())*this.element.find(".e-workcells")[0].offsetWidth*o/60):(a=parseFloat(new Date(i).getMinutes())*this.element.find(".e-workcells")[0].offsetWidth*o/60,diffInMinutes=new Date(r).getHours()*60+new Date(r).getMinutes()-(new Date(i).getHours()*60+new Date(i).getMinutes()),l=this.element.find(".e-workcells").width()/30*diffInMinutes+(new Date(r).getHours()-new Date(i).getHours())*o-2,cellIndex=(this.model.endHour-this.model.startHour)*o*f+tt*o),p=this._appointmentColor(u),y+d<e){var ut=this.model.appointmentTemplateId?!0:!1,ft=this._getUserAppointmentTemplate(u),et=this.model.timeMode=="12"?Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),this._pattern.t):Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"HH:mm"),ot=this.model.timeMode=="12"?Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),this._pattern.t):Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),"HH:mm"),st=this.appTemplate.render({id:u[this.model.appointmentSettings.id],appHeight:d,rtl:this.model.enableRTL,subject:u[this.model.appointmentSettings.subject],startTime:et,endTime:ot,left:a+"px",top:y,appWidth:l+"px",userAppTemplId:ut,userTemplate:ft,appClass:"e-appointment",appointData:p.appointColor.appointData,appointCustomcss:p.appointColor.appointCustomcss,appointtextcolor:p.appointColor.appointtextcolor,value:p.value,multiDiv:p.multiDiv,orientation:this.model.orientation});n(n(k[b+v-1]).find("div.e-appointwrapper")[cellIndex]).append(st);!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1&&(w=this._getResourceColor(u),nt=w.appointData==""?"e-categorycolor":"",n(n(n(k.find("td.e-resourceheadercells")).parent()[v-1]).find("div.e-appointwrapper")[cellIndex]).append("<div class='e-categorybar "+nt+"' id='categorybar_"+u[this.model.appointmentSettings.id]+"' style='position:absolute;height:"+(e-3)+"px;background:"+w.appointData+";width:"+(l+1)+"px;left:"+a+"px;'><\/div>"))}else n("#"+this._id+"_"+Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(b+v-1)+"_"+cellIndex).length==0&&(n(n(k[b+v-1]).find("div.e-appointwrapper")[cellIndex]).append('<div id="'+this._id+"_"+Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(b+v-1)+"_"+cellIndex+'" class="e-icon e-appsoverflow"><\/div>'),!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1&&(w=this._getResourceColor(u),nt=w.appointData==""?"e-categorycolor":"",n(n(n(k.find("td.e-resourceheadercells")).parent()[v-1]).find("div.e-appointwrapper")[cellIndex]).append("<div class='e-categorybar "+nt+"' id='categorybar_"+u[this.model.appointmentSettings.id]+"' style='position:absolute;height:"+(e-3)+"px;background:"+w.appointData+";width:"+(l+1)+"px;left:"+a+"px;'><\/div>")),this.element.find("#"+this._id+"_"+Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(b+v-1)+"_"+cellIndex).css(this.model.enableRTL?"right":"left",this.element.find(".e-workcells").width()+a-25+"px").css("top",y+"px"))}},_renderCategory:function(i,r,u,f,e,o,s,h,c,l){var w,v,y,p,b,a;u[this.model.appointmentSettings.allDay]?(w=new Date(Globalize.format(new Date(o),this._pattern.d))-new Date(Globalize.format(new Date(e),this._pattern.d)),a=Math.round(w/864e5)+1,a>this.dateRender.length&&(a=new Date(this.dateRender[this.dateRender.length-1]).getDay()+1-new Date(e).getDay()),v=a*1440,y=(this.model.endHour-this.model.startHour)*h*c,p=this.element.find(".e-workcells").width()/(30-1.1)*v+3,b="0"):new Date(Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),this._pattern.d))<new Date(Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),this._pattern.d))?(w=new Date(Globalize.format(new Date(o),this._pattern.d))-new Date(Globalize.format(new Date(e),this._pattern.d)),a=Math.round(w/864e5)+1,v=(a-1)*1440,y=(this.model.endHour-this.model.startHour)*h*c+l*h,p=this.element.find(".e-workcells").width()/(30-1.1)*v+new Date(o).getMinutes()*this.element.find(".e-workcells")[0].offsetWidth*h/60+(new Date(o).getHours()-this.model.startHour)*h,a>this.dateRender.length&&(a=new Date(this.dateRender[this.dateRender.length-1]).getDay()+1-new Date(e).getDay(),v=a*1440,p=this.element.find(".e-workcells").width()/(30-1.1)*v-y*25+10),b=parseFloat(new Date(e).getMinutes())*this.element.find(".e-workcells")[0].offsetWidth*h/60):(b=parseFloat(new Date(e).getMinutes())*this.element.find(".e-workcells")[0].offsetWidth*h/60,diffInMinutes=new Date(o).getHours()*60+new Date(o).getMinutes()-(new Date(e).getHours()*60+new Date(e).getMinutes()),p=this.element.find(".e-workcells").width()/30*diffInMinutes+(new Date(o).getHours()-new Date(e).getHours())*h-2,y=(this.model.endHour-this.model.startHour)*h*c+l*h);!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1&&n(n(n(i.find("td.e-resourceheadercells")).parent()[r-1]).find("div.e-appointwrapper")[y]).append("<div class='e-categorybar' style='position:absolute;height:"+(f-3)+"px;background:"+s.appointData+";width:"+(p+1)+"px;left:"+b+"px;'><\/div>")},_getHorizontalOverlapCount:function(n,i,r,u,f){for(var o=[],e=0;e<n.length;e++)!t.scheduleFeatures.resources||t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)?Globalize.format(new Date(n[e][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(i[r]),this._pattern.d)&&Globalize.format(new Date(n[e][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(i[r]),this._pattern.d)&&(new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.endTime])>=new Date(n[e][this.model.appointmentSettings.startTime])||new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.endTime])&&new Date(u[this.model.appointmentSettings.endTime])>new Date(n[e][this.model.appointmentSettings.endTime])||new Date(u[this.model.appointmentSettings.startTime])>=new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.endTime])||new Date(u[this.model.appointmentSettings.endTime])>new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.endTime])<new Date(n[e][this.model.appointmentSettings.endTime]))&&o.push(n[e]):Globalize.format(new Date(n[e][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(i[r]),this._pattern.d)&&Globalize.format(new Date(n[e][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(i[r]),this._pattern.d)&&(new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.endTime])>=new Date(n[e][this.model.appointmentSettings.startTime])||new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.endTime])&&new Date(u[this.model.appointmentSettings.endTime])>new Date(n[e][this.model.appointmentSettings.endTime])||new Date(u[this.model.appointmentSettings.startTime])>=new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.endTime])||new Date(u[this.model.appointmentSettings.endTime])>new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.endTime])<new Date(n[e][this.model.appointmentSettings.endTime]))&&(f!=null?f==n[e][this.model.resources[this.model.resources.length-1].field]:f==null)&&o.push(n[e]);return o},_moveScroller:function(){if((this.currentView()=="week"||this.currentView()=="workweek"||this.currentView()==="customview"&&this._renderDays<=7)&&this.element.find(".e-headercells").children().hasClass("e-activeview")){var i=n(this.element.find(".e-headercells").find(".e-activeview").parent()).index(),t=this.element.find(".e-workcells")[i*48].offsetLeft;n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-t+"px");n("div#"+this._id+"_scroller").ejScroller({scrollLeft:t})}},_renderHorizontalHeaderBar:function(){var i=this._isCustomView()?"month":this.currentView(),r=Globalize.culture(this.model.locale),o=i=="day"?1:i=="week"?7:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:5,u,n,f,e;if(this.datesColumn=this._getHeaderAllDayCellsCount(),i==="month"||this._isCustomView()){for(this.datesColumn=[],this.monthDays=[],this.totdays=[],n=0;n<this._dateRender.length;n++)this.currentView()==="month"?new Date(this.currentDate()).getMonth()===new Date(this._dateRender[n]).getMonth()&&this.totdays.push(new Date(this._dateRender[n])):this.totdays.push(new Date(this._dateRender[n]));for(u=this.totdays.length,n=0;n<u;n++)curday=r.calendar.days.names[new Date(this.totdays[n]).getDay()],temp={currentDate:Globalize.format(new Date(this.totdays[n]),"dd"),currentDateClass:"",currentDay:r.calendar.days.names[new Date(this.totdays[n]).getDay()].toString().slice(0,1),cellWidth:!this.model.cellWidth&&this.currentView()!="month"&&!this._isCustomView()?"30px":this.model.cellWidth,cellHeight:this.model.cellHeight},this.datesColumn.push(temp),this.monthDays.push(new Date(this.totdays[n]))}f=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?!0:!1;e=this.horizontalHeader.render({cols:this.datesColumn,multiRes:f,view:i,timeTdCount:this._getStartEndTime(),colspan:i=="month"?1:this._getStartEndTime().length/o*2,height:i=="month"?63:59,width:this.model.width,headercellWidth:i=="day"?"100%":"55px"});this.aTR.append(e)},_renderHorizontalContent:function(n,i,r,u,f,e){var o,s,h,c;t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)?(h=this.currentView()=="month"||this._isCustomView()?"24px":"25px",s="",o=[{classname:"e-childnode",tdWidth:h}]):(s=this._renderHorizontalResources(),o=this._horiResources);c=this.cellTemplate.render({cellrows:o,view:this._isCustomView()?"month":this.currentView(),cols:this.currentView()=="month"||this._isCustomView()?this.datesColumn:this._getStartEndTime()});this.wTR.append(t.buildTag("td").append(s)).append(t.buildTag("td").append(n.append(i.append(r.append(u.append(f.append(e.append(this.$WorkCellDiv.append(c)))))))))},_getResourceHeadTemplate:function(t){var i=n.templates(n(this.model.resourceHeaderTemplateId).html());return i.render(t)},_renderHorizontalResources:function(){var u,r,f,e,n;this._resCollect=[];this._horizontalResRender=[];this._horiResources=[];this._renderMultipleResourceHeaderTemplate(null,null);var c=this.currentView(),a=c=="day"?1:c=="week"||c=="month"||this._isCustomView()?7:5,s=this.currentView()=="month"||this._isCustomView()?"24px":"25px",h=this.model.resourceHeaderTemplateId?!0:!1;if(t.isNullOrUndefined(this.model.group))for(n=0;n<this.model.resources.length;n++)this._horizontalResRender.push(this.model.resources[n].resourceSettings.dataSource),this._resCollect.push(this.model.resources[n].resourceSettings.dataSource);else if(this.model.group.resources.length===1){for(r=0;r<this.model.group.resources.length;r++)u=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[r]);for(r=0;r<this._resourceInfo[u].dataSource.length;r++)this._horiResources.push({cellHeight:this.model.cellHeight,name:this._resourceInfo[u].dataSource[r][this._resourceInfo[u].text],idnum:this._resourceInfo[u].dataSource[r][this._resourceInfo[u].id],classname:"e-childnode",marginleft:"20px",width:"10px",backgroundcolor:"",border:"1px solid #bbbcbb",bordertop:"",tdWidth:s,userResHeader:this._getResourceHeadTemplate({name:this._resourceInfo[u].dataSource[r][this._resourceInfo[u].text],classname:"e-childnode",id:this._resourceInfo[u].dataSource[r][this._resourceInfo[u].id],color:this._resourceInfo[u].dataSource[r][this._resourceInfo[u].color]}),userResTemplId:h}),this._resCollect.push(this._resourceInfo[u].dataSource[r]);this._horizontalResRender.push(this._resCollect)}else{var i=this._getResourceCollection(),o=0,n=0,l=[];for(f=0;f<i[o].dataSource.length;f++){for(this._horiResources.push({cellHeight:this.model.cellHeight,name:i[o].dataSource[f].text,idnum:i[o].dataSource[f].id,classname:"e-parentnode",marginleft:"20px",width:"10px",backgroundcolor:"#bbbcbb",border:"1px solid #bbbcbb",bordertop:"1px solid #bbbcbb",tdWidth:s,userResHeader:this._getResourceHeadTemplate({name:i[o].dataSource[f].text,classname:"e-parentnode",id:i[o].dataSource[f].id,color:i[o].dataSource[f].color}),userResTemplId:h}),this._resCollect.push(i[o].dataSource[f]),n++,r=0;r<i[n].dataSource.length;r++){if(p=n,i[n-1].dataSource[f].id==i[n].dataSource[r].groupId)for(l.push(i[n].dataSource[r]),this._horiResources.push({cellHeight:this.model.cellHeight,name:i[n].dataSource[r].text,idnum:i[n].dataSource[r].id+"_"+i[n].dataSource[r].groupId,classname:"e-childnode",marginleft:"45px",width:"20px",backgroundcolor:"",border:"1px dotted #bbbcbb",bordertop:"",tdWidth:s,userResHeader:this._getResourceHeadTemplate({name:i[n].dataSource[r].text,classname:"e-childnode",id:i[n].dataSource[r].id,color:i[n].dataSource[r].color}),userResTemplId:h}),this._resCollect.push(i[n].dataSource[r]);n<i.length-1;){for(e=0;e<i[n+1].dataSource.length;e++)i[n].dataSource[r].id==i[n+1].dataSource[e].groupId&&(l.push(i[n+1].dataSource[e]),this._horiResources.push({cellHeight:this.model.cellHeight,name:i[n+1].dataSource[e].text,classname:"e-childnode",marginleft:"55px",width:"20px",backgroundcolor:"",border:"1px dotted #bbbcbb",bordertop:"",tdWidth:s,userResHeader:this._getResourceHeadTemplate({name:i[n+1].dataSource[e].text,classname:"e-childnode",id:i[n+1].dataSource[e].id,color:i[n+1].dataSource[e].color}),userResTemplId:h}),this._resCollect.push(i[n+1].dataSource[e]));n++}n=p}n=0}this._horizontalResRender.push(this._resCollect)}return this.horizontalResHeader.render({trs:this._horiResources})},_renderHorizontalCurrentTime:function(){var r,t,u,i;if(this.currentView()==="month"||this._isCustomView()){for(r=[],t=0;t<this._dateRender.length;t++)new Date(this.currentDate()).getMonth()===new Date(this._dateRender[t]).getMonth()&&r.push(new Date(this._dateRender[t]));for(u=this.element.find(".e-workcells"),i=0;i<r.length;i++)Globalize.format(new Date(r[i]),this._pattern.d)===Globalize.format(new Date,this._pattern.d)&&n(u[i]).addClass("e-monthcurrenttime")}else this.element.find("td.e-headerToday").length>0&&(this.element.find(".e-horizontaltabletimecell").append('<div id="'+this._id+'_HighlightCurrentTimeline" class="e-highlightcurrenttimeline" style="height: 92%; width: 2px; position: absolute; background-color: red; "><\/div>'),n("#"+this._id+"_HighlightCurrentTimeline").css("top",this.element.find(".e-headerdays tr")[1].offsetTop))},_horizontalTimePosition:function(t,i){if(t.element.find("td.e-headerToday").length>0){var r=t.element.find("td.e-headerToday")[0].cellIndex,u=i.getHours()-t.model.startHour,f=(t.model.endHour-t.model.startHour)*2*r+u*2,e=parseFloat(i.getMinutes())*t.element.find(".e-workcells")[0].offsetWidth/30;n("#"+t._id+"_HighlightCurrentTimeline").css("left",f*t.element.find(".e-workcells")[0].offsetWidth+e)}},_horizontalBusinessHighlight:function(i,r,u,f,e){var l=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)?this._horiResources.length:1,h,c,e,s,o;if(this.currentView()==="month"||this._isCustomView())for(c=this.monthDays,e=this.element.find(".e-workcells"),e.removeClass("e-monthcellhighlight"),s=0;s<l;s++)for(o=0;o<c.length;o++)new Date(c[o]).getDay()!==0&&new Date(c[o]).getDay()!==6&&n(n(this.element.find(".e-workcellstab tr")[s]).find(".e-workcells")[o]).addClass("e-monthcellhighlight");else{for(s=0;s<l;s++)for(h=0;h<i.length;h++)for(o=r*f;o<u*f;o++)new Date(i[h]).getDay()!==0&&new Date(i[h]).getDay()!==6&&n(n(this.element.find(".e-workcellstab tr")[s]).find(".e-workcells")[o+(this.model.endHour-this.model.startHour)*f*h]).addClass("e-businesshighlightworkcells");this._businessHourScroller()}},_onResourceClick:function(i){var r=n(i.currentTarget),u;r.hasClass("e-resourceicon e-resourcecollapse")?(r.removeClass("e-resourceicon e-resourcecollapse"),r.addClass("e-resourceicon e-resourceexpand")):(r.removeClass("e-resourceicon e-resourceexpand"),r.addClass("e-resourceicon e-resourcecollapse"));var f=n(i.currentTarget).parent().index(),e=this._getResourceCollection(),o=(new t.Query).where("groupId",t.FilterOperators.equal,parseInt(i.currentTarget.id)),s=new t.DataManager(e[e.length-1].dataSource).executeLocal(o);for(u=f+1;u<=s.length+f;u++)n(this.element.find(".e-resourceheadertable").find("tr")[u]).toggle(),n(this.element.find(".e-workcellstab").find("tr")[u]).toggle();this._renderScroller();this.element.find("div.e-prev").remove();this.element.find("div.e-next").remove();this.element.find(".e-horires").css("top","0px");this._businessHourScroller()}}})(jQuery,Syncfusion),function(n,t){t.scheduleFeatures=t.scheduleFeatures||{};var i=function(){return this._resHeadTemplate="{{for resourceName}}{{for ~cols=colspan}}<td class='e-resourcecells 'style='height:27px;' colspan='{{:~cols}}'> {{for ~resource=resourceNam}}<div align='center'>{{if userResTemplId == true}}{{:userResHeader}}{{else}}{{:~resource}}{{/if}}<\/div>{{/for}}  <\/td>{{/for}}{{/for}}",this._resHeadTemplate};t.scheduleFeatures.resources={__getMultipleResourceCellsCount:function(n){var a,r,f,h,c,v,e,i,u,o,l,s;if(this.model.group.resources.length===1){for(u=0;u<this.model.group.resources.length;u++)a=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[u]);resCount=this._resourceInfo[a].dataSource.length}else{for(r=this._getResourceCollection(),f=[],i=0;i<r.length;i++)if(f=[],i==0)for(u=0;u<r[i].dataSource.length;u++)f.push({resourceNam:r[i].dataSource[u][r[i].text]});else for(i>1&&(r[i-1].dataSource=[],r[i-1].dataSource=this.res),this.res=[],h=t.group(r[i].dataSource,r[i].groupId),c=t.group(r[i-1].dataSource,r[i-1].id),this._resourceManager1=h instanceof t.DataManager?h:t.DataManager(h),o=0;o<c.length;o++)for(l=0;l<c[o].items.length;l++)if(v=(new t.Query).where("key",t.FilterOperators.equal,c[o].items[l][r[i].id]),e=this._resourceManager1.executeLocal(v),e.length>0)for(s=0;s<e[0].items.length;s++)f.push({resourceNam:e[0].items[s][r[i].text]}),this.res.push(e[0].items[s]);resCount=f.length}return n=n*resCount,{resCount:resCount,count:n}},_initResourceData:function(n,t){var r=this._columnToSelect(n),i=this,u=n.dataSource.executeQuery(r);u.done(function(r){n.dataSource=r.result;i._resourceInfo.push(n);t==i.model.resources.length-1&&i._renderInitSchedule()})},_showMultipleResourceDetails:function(n){var s,h,e,o=[],u,i,f,r;if(this.model.resources.length>0){for(u=this._getResourceCollection(),r=0;r<u.length;r++)this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");for(i=0;i<this.render_Resources.length-1;i++){for(s=this.render_Resources[i+1]instanceof t.DataManager?this.render_Resources[i+1]:t.DataManager(this.render_Resources[i+1]),h=(new t.Query).where(u[i+1].groupId,t.FilterOperators.equal,n[this.model.appointmentSettings.resourceFields.toString().split(",")[i]]),e=s.executeLocal(h),o=[],f=0;f<e.length;f++)o.push({text:e[f][u[i+1].text],value:e[f][u[i+1].id],color:e[f][u[i+1].color]});this._appointmentAddWindow.find(".owner_"+(i+1)).ejAutocomplete("clearText");this._appointmentAddWindow.find(".owner_"+(i+1)).ejAutocomplete("option","dataSource",o)}for(r=0;r<u.length;r++)this._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(n[this.model.appointmentSettings.resourceFields.toString().split(",")[r]])}},_renderAppWindowResources:function(n){for(var i,r=this._getResourceCollection(),u=[],t=0;t<r.length;t++){for(u=[],i=0;i<this.render_Resources[t].length;i++)u.push({text:this.render_Resources[t][i][r[t].text],value:this.render_Resources[t][i][r[t].id],color:this.render_Resources[t][i][r[t].color]});this.model.resources[t].allowMultiple?n.find(".owner_"+t).ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:"visualmode",dataSource:u,fields:{text:"text",key:"value"},change:this._onResourceChange,template:this.resourceTemplate}):n.find(".owner_"+t).ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:"none",dataSource:u,fields:{text:"text",key:"value"},change:this._onResourceChange,template:this.resourceTemplate})}},_onResourceChange:function(i){var nt=n("#"+this._id.toString().split("_")[0]),f=nt.ejSchedule("instance"),p=parseInt(this._id.toString().split("_")[2]),tt=f._appointmentAddWindow.find(".owner_"+p).ejAutocomplete("option","multiSelectMode"),s=this.getSelectedItems(),u=f._getResourceCollection(),d,g,b,v,l,c,y,h,o;if(p<f.render_Resources.length-1&&s.length>0){var r=p+1,w=f.render_Resources[r-1]instanceof t.DataManager?f.render_Resources[r-1]:t.DataManager(f.render_Resources[r-1]),k=f.render_Resources[r]instanceof t.DataManager?f.render_Resources[r]:t.DataManager(f.render_Resources[r]);if(tt=="none"){if(t.isNullOrUndefined(i.value)||(d=(new t.Query).where(u[r-1].text,t.FilterOperators.equal,i.value),g=w.executeLocal(d)),b=!i.value||t.isNullOrUndefined(i.value)||g.length<=0?s[0].value:s[1].value,!t.isNullOrUndefined(b)){var l=(new t.Query).where(u[r-1].id,t.FilterOperators.equal,b),c=w.executeLocal(l),l=(new t.Query).where(u[r].groupId,t.FilterOperators.equal,c[0][u[r-1].id]),e=k.executeLocal(l),a=[];for(o=0;o<e.length;o++)a.push({text:e[o][u[r].text],value:e[o][u[r].id],color:e[o][u[r].color]});f._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");f._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",a);f._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(e[0][u[r].id]);s=e[0][u[r].id]}}else{for(v=t.Predicate(u[r-1].id,t.FilterOperators.equal,s[0].value),h=1;h<s.length;h++)v=v.or(u[r-1].id,t.FilterOperators.equal,s[h].value);if(l=(new t.Query).where(v),c=w.executeLocal(l),c.length>0){for(y=t.Predicate(u[r].groupId,t.FilterOperators.equal,c[0][u[r-1].id]),h=1;h<c.length;h++)y=y.or(u[r].groupId,t.FilterOperators.equal,c[h][u[r-1].id]);var l=(new t.Query).where(y),e=k.executeLocal(l),a=[];for(o=0;o<e.length;o++)a.push({text:e[o][u[r].text],value:e[o][u[r].id],color:e[o][u[r].color]});f._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");f._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",a);f._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(e[0][u[r].id]);s.push(e[0][u[r].id])}}}},_getResourceCollection:function(){var i=[],f,n,u,r;if(!t.isNullOrUndefined(this.model.resources)){if(t.isNullOrUndefined(this.model.group))for(n=0;n<this.model.resources.length;n++)i.push({index:n});else{for(n=0;n<this.model.group.resources.length;n++)f=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[n]),i.push({index:f,name:this.model.resources[n].name});i=i.sort(function(n,t){var i=n.index,r=t.index;return i<r?-1:i>r?1:0})}for(u=[],r=0;r<i.length;r++)u.push(this._resourceInfo[i[r].index]);return u}},_renderMultipleResourceHeaderTemplate:function(n,i){var c,v,y,s,h,p,u,d,o,r,g;if(this.res1=[],this.render_Resources=[],this.level_Resources=[],c=this.currentView(),v=c=="day"?1:c=="week"||c=="month"?7:5,t.isNullOrUndefined(this.model.group))for(g=0;g<this.model.resources.length;g++)this.render_Resources.push(this.model.resources[g].resourceSettings.dataSource);else if(y=this.model.resourceHeaderTemplateId?!0:!1,this.model.group.resources.length===1){for(r=0;r<this.model.group.resources.length;r++)s=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[r]);for(h=[],r=0;r<this._resourceInfo[s].dataSource.length;r++)h.push({resourceNam:this._resourceInfo[s].dataSource[r][this._resourceInfo[s].text],colspan:v,userResHeader:this._getResourceHeadTemplate({name:this._resourceInfo[s].dataSource[r][this._resourceInfo[s].text],classname:"e-childnode",id:this._resourceInfo[s].dataSource[r][this._resourceInfo[s].id],color:this._resourceInfo[s].dataSource[r][this._resourceInfo[s].color]}),userResTemplId:y}),this.res1.push(this._resourceInfo[s].dataSource[r]),this.level_Resources.push(this.res1[r]);this.render_Resources.push(this.res1);this.model.orientation=="vertical"&&n!==null&&i!=null&&(k=c=="month"?50:56,p=this.resourceHeadTemplate.render({cols:i,resourceName:h,leftWidth:k}),n.append(t.buildTag("tr.e-headerbar").append(p)))}else{var f=this._getResourceCollection(),nt=[],h=[],w,l,e,a=[],b,k,p;for(u=0;u<f.length;u++){if(h=[],this.level_Resources=[],u>=0&&u<f.length-1)for(w=t.group(f[u+1].dataSource,f[u+1].groupId),this._resourceManager1=w instanceof t.DataManager?w:t.DataManager(w),r=0;r<f[u].dataSource.length;r++){if(l=(new t.Query).where("key",t.FilterOperators.equal,f[u].dataSource[r][f[u].id]),e=this._resourceManager1.executeLocal(l),e.length>0)for(o=0;o<e[0].items.length;o++)f[u].dataSource[r].id==e[0].items[o].groupId&&(nt.push(e[0].items[o]),u==f.length-2?this.res1.push(e[0].items[o]):this.res1=[]);for(a=[],m=u+1;m<f.length;m++)if(b=t.group(f[m].dataSource,f[m].groupId),this._resourceData=b instanceof t.DataManager?b:t.DataManager(b),m>u+1){for(this.tres=[],d=0;d<a.length;d++)if(l=(new t.Query).where("key",t.FilterOperators.equal,a[d].id),e=this._resourceData.executeLocal(l),e.length>0)for(o=0;o<e[0].items.length;o++)this.tres.push(e[0].items[o])}else if(l=(new t.Query).where("key",t.FilterOperators.equal,f[m-1].dataSource[r].id),e=this._resourceData.executeLocal(l),e.length>0)for(o=0;o<e[0].items.length;o++)a.push(e[0].items[o]);a.length>0&&(u!=0||t.isNullOrUndefined(this.tres)?h.push({resourceNam:f[u].dataSource[r][f[u].text],colspan:a.length*v,userResHeader:this._getResourceHeadTemplate({name:f[u].dataSource[r][f[u].text],classname:"e-parentnode",id:f[u].dataSource[r][f[u].id],color:f[u].dataSource[r][f[u].color]}),userResTemplId:y}):h.push({resourceNam:f[u].dataSource[r][f[u].text],colspan:this.tres.length*v,userResHeader:this._getResourceHeadTemplate({name:f[u].dataSource[r][f[u].text],classname:"e-childnode",id:f[u].dataSource[r][f[u].id],color:f[u].dataSource[r][f[u].color]}),userResTemplId:y}),this.level_Resources.push(f[u].dataSource[r]));nt=[]}else for(r=0;r<this.res1.length;r++)h.push({resourceNam:this.res1[r][f[u].text],colspan:v,userResHeader:this._getResourceHeadTemplate({name:this.res1[r][f[u].text],classname:"e-childnode",id:this.res1[r][f[u].id],color:this.res1[r][f[u].color]}),userResTemplId:y}),this.level_Resources.push(this.res1[r]);this.render_Resources.push(this.level_Resources);this.model.orientation=="vertical"&&n!==null&&i!=null&&(k=c=="month"?50:56,p=this.resourceHeadTemplate.render({cols:i,resourceName:h,leftWidth:k}),n.append(t.buildTag("tr.e-headerbar").append(p)))}}return n},_getMultipleResourceColsCount:function(n){var t,i;if(this.model.group.resources.length===1){for(t=0;t<this.model.group.resources.length;t++)index=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[t]);this._resourceInfo[index].dataSource.length>0&&(n=n*this._resourceInfo[index].dataSource.length)}else i=this._getResourceCollection(),i[i.length-1].dataSource.length>0&&(n=n*this.res1.length);return n},_getMultipleResourceAppList:function(n,i,r,u,f){if(Globalize.format(new Date(r[n][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(i[f]),this._pattern.d)&&r[n][this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]==this.res1[u][this.model.resources[this.model.resources.length-1].resourceSettings.id]&&Globalize.format(new Date(r[n][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(i[f]),this._pattern.d)&&Globalize.format(new Date(r[n][this.model.appointmentSettings.startTime]),this._pattern.d)==Globalize.format(new Date(r[n][this.model.appointmentSettings.endTime]),this._pattern.d)&&r[n][this.model.appointmentSettings.allDay]===!1&&Globalize.format(new Date(r[n][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(r[n][this.model.appointmentSettings.endTime]),this._pattern.d)){var o=this._processed[n].ParentId,s=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,parseInt(o)),h=this._currentAppointmentData,e=new t.DataManager(h).executeLocal(s);this.currentView()=="day"?(new Date(e[0][this.model.appointmentSettings.endTime])-new Date(e[0][this.model.appointmentSettings.startTime]))/36e5>24?this._setAllDayPos(r[n],f,u):this._appList.push(r[n]):this._appList.push(r[n])}},_getMultipleResourceAlldayApp:function(n,t,i,r){Globalize.format(new Date(n[t]),this._pattern.d)==Globalize.format(new Date(this._processed[r][this.model.appointmentSettings.startTime]),this._pattern.d)&&this._processed[r][this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]==this.res1[i][this.model.resources[this.model.resources.length-1].resourceSettings.id]&&(this._processed[r][this.model.appointmentSettings.allDay]===!0||(new Date(this._processed[r][this.model.appointmentSettings.endTime])-new Date(this._processed[r][this.model.appointmentSettings.startTime]))/36e5>24)&&(this._setAllDayPos(this._processed[r],t,i),this._filtered.push(this._processed[r]))},_getMonthAppList:function(n,t,i,r,u){return i[r][this.model.appointmentSettings.allDay]==!0||(new Date(i[r][this.model.appointmentSettings.endTime])-new Date(i[r][this.model.appointmentSettings.startTime]))/36e5>24?Globalize.format(new Date(n[t]),this._pattern.d)==Globalize.format(new Date(i[r][this.model.appointmentSettings.startTime]),this._pattern.d)&&Globalize.format(new Date(n[t]),this._pattern.S)<=Globalize.format(new Date(i[r][this.model.appointmentSettings.endTime]),this._pattern.S)&&i[r][this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]==this.res1[u][this.model.resources[this.model.resources.length-1].resourceSettings.id]&&Globalize.format(new Date(i[r][this.model.appointmentSettings.startTime]),this._pattern.S)<=Globalize.format(new Date(i[r][this.model.appointmentSettings.endTime]),this._pattern.S)&&this.filterData.push(i[r]):Globalize.format(new Date(n[t]),this._pattern.d)==Globalize.format(new Date(i[r][this.model.appointmentSettings.startTime]),this._pattern.d)&&Globalize.format(new Date(n[t]),this._pattern.d)<=Globalize.format(new Date(i[r][this.model.appointmentSettings.endTime]),this._pattern.d)&&i[r][this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]==this.res1[u][this.model.resources[this.model.resources.length-1].resourceSettings.id]&&Globalize.format(new Date(i[r][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(i[r][this.model.appointmentSettings.endTime]),this._pattern.d)&&this.filterData.push(i[r]),this.filterData},_getResourceColor:function(n){var i=this._getResourceCollection(),r,u="",f="";return t.isNullOrUndefined(this.model.group)?(r=this._findResourceIndex(this.render_Resources[this.render_Resources.length-1],i[i.length-1].id,n[this.model.appointmentSettings.resourceFields.split(",")[this.model.appointmentSettings.resourceFields.split(",").length-1]]),t.isNullOrUndefined(r)||(u=t.isNullOrUndefined(this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].color])?u:this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].color],f=t.isNullOrUndefined(this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].appointmentClass])?f:this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].appointmentClass])):(r=this._findResourceIndex(this.render_Resources[0],i[0].id,n[this.model.appointmentSettings.resourceFields.split(",")[0]]),t.isNullOrUndefined(r)||(u=t.isNullOrUndefined(this.render_Resources[0][r][i[0].color])?u:this.render_Resources[0][r][i[0].color],f=t.isNullOrUndefined(this.render_Resources[0][r][i[0].appointmentClass])?f:this.render_Resources[0][r][i[0].appointmentClass])),{appointData:u,appointCustomcss:f}},_getResourceDetails:function(n){var s,u,e,f,h,c,o,i,r;if(!t.isNullOrUndefined(this.model.resources)&&this.model.resources.length>0){for(s=this.model.currentView==="week"||this.model.currentView==="month"?7:this.model.currentView==="workweek"?5:1,u=this.model.currentView==="month"?n.index():this._cellIndex,u=this.model.orientation=="vertical"?parseInt(u/s):this._workCellIndex,e=this.model.orientation=="vertical"?this.res1:this._resCollect,this._resourceCollection=[],i=this._getResourceCollection(),r=i.length-1;r>=0;r--)r==i.length-1?t.isNullOrUndefined(this.model.group)?(this._resourceCollection.push({id:i[i.length-1].dataSource[u][i[i.length-1].id]}),f=i[i.length-1].dataSource[u][i[i.length-1].groupId]):(this._resourceCollection.push({id:e[u][i[r].id]}),f=e[u][i[r].groupId]):(h=i[r].dataSource instanceof t.DataManager?i[r].dataSource:t.DataManager(i[r].dataSource),c=(new t.Query).where(i[r].id,t.FilterOperators.equal,f),o=h.executeLocal(c),this._resourceCollection.push({id:o[0][i[r].id]}),f=o[0][i[r].groupId]);return this._resourceCollection}},_getResourceFields:function(n){if(t.isNullOrUndefined(this.model.group))n[this.model.appointmentSettings.resourceFields.split(",")[0]]=this._resourceCollection[0].id;else for(var i=0,r=this._resourceCollection.length-1;i<this._resourceCollection.length;i++,r--)n[this.model.appointmentSettings.resourceFields.split(",")[i]]=this._resourceCollection[r].id;return n},_getDragDropResourceData:function(n,i,r){if(!t.isNullOrUndefined(i)){var f=n.model.currentView==="week"||n.model.currentView==="month"?7:n.model.currentView==="workweek"?5:1,u=n.model.orientation=="vertical"?n.res1[Math.floor(i/f)]:n._resCollect[i];r[n.model.appointmentSettings.resourceFields.split(",")[n.model.appointmentSettings.resourceFields.split(",").length-1]]=u.id;r[n.model.appointmentSettings.resourceFields.split(",")[n.model.appointmentSettings.resourceFields.split(",").length-2]]=u.groupId}return r},_renderResourceData:function(n,i){var y,c,l,p,a,s,w,h,v,u,r,o,f,e;if(!t.isNullOrUndefined(this.model.resources)&&this.model.resources.length>0){for(y=this.model.currentView==="week"||this.model.currentView==="month"?7:this.model.currentView==="workweek"?5:1,i=this.model.currentView==="month"?n.index():i,i=this.model.orientation=="vertical"?parseInt(i/y):this._workCellIndex,c=this.model.orientation=="vertical"?this.res1:this._resCollect,v=[],this._resIdCollection=[],u=this._getResourceCollection(),r=0;r<u.length;r++)this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");for(this.resourceId=[],r=u.length-1;r>=0;r--)r==u.length-1?(t.isNullOrUndefined(this.model.group)?(this.resourceId.push({id:this.render_Resources[r][i][u[r].id],value:this.render_Resources[r][i][u[r].text]}),l=this.render_Resources[r][i][u[r].groupId]):(this.resourceId.push({id:c[i][u[r].id],value:c[i][u[r].text]}),l=c[i][u[r].groupId]),this.model.resources.length==1&&this._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByText(this.resourceId[0].value)):(p=u[r].dataSource instanceof t.DataManager?u[r].dataSource:t.DataManager(u[r].dataSource),a=(new t.Query).where(u[r].id,t.FilterOperators.equal,l),s=p.executeLocal(a),this._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByText(s[0][u[r].text]),this.resourceId.push({id:s[0][u[r].id],value:s[0][u[r].text]}),l=s[0][u[r].groupId]);if(this.model.resources.length>1){for(f=0,e=this.render_Resources.length-1;f<this.render_Resources.length-1;f++,e--){for(w=this.render_Resources[f+1]instanceof t.DataManager?this.render_Resources[f+1]:t.DataManager(this.render_Resources[f+1]),a=(new t.Query).where(u[f+1].groupId,t.FilterOperators.equal,this.resourceId[e][u[e].id]),h=w.executeLocal(a),v=[],o=0;o<h.length;o++)v.push({text:h[o][u[f+1].text],value:h[o][u[f+1].id],color:h[o][u[f+1].color]});this._appointmentAddWindow.find(".owner_"+(f+1)).ejAutocomplete("clearText");this._appointmentAddWindow.find(".owner_"+(f+1)).ejAutocomplete("option","dataSource",v)}for(f=0,e=this.render_Resources.length-1;f<this.render_Resources.length-1;f++,e--)this._appointmentAddWindow.find(".owner_"+(f+1)).data("ejAutocomplete").selectValueByKey(this.resourceId[e-1][u[e-1].id])}}},_bindResourcesData:function(){var i,n;if(!t.isNullOrUndefined(this.model.resources)){for(this._resourceInfo=[],i=!1,n=0;n<this.model.resources.length;n++)t.isNullOrUndefined(this.model.resources[n].resourceSettings)||(this.model.resources[n].resourceSettings.dataSource instanceof t.DataManager?this._initResourceData(this.model.resources[n].resourceSettings,n):(this._resourceInfo.push(this.model.resources[n].resourceSettings),i=!0));i&&this._renderInitSchedule()}},_renderResourceElements:function(n){for(var t=0;t<this.model.resources.length;t++)n+="<tr><td class='e-leftfields e-textlabel'>"+this.model.resources[t].title+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"_ownerfield_"+t+"'  class='owner_"+t+"' type='text' value=''/><div id='ownerlist'><\/div><\/td><\/tr>";return n},_renderResourcesTemplate:function(){this.model.orientation=="vertical"&&(this.resourceHeadTemplate=n.templates(this._createTemplate(i(),"_ResourceHeader")));t.isNullOrUndefined(this.model.resources)||(this.resourceTemplate="<div class='e-resourcediv' style='height:15px; margin-right:5px; margin-top:3px; float:left; width:15px; background-color: ${color}'><\/div> <div>${text}<\/div>")}}}(jQuery,Syncfusion),function(n,t,r){t.scheduleFeatures=t.scheduleFeatures||{};var u=function(){return this._monthCellsTemplate="<table class='e-table e-workcellstab'  height='100%'width='100%' cellpadding='0px' cellspacing='0px'><tbody>{{for cellrows ~cols1=cols1}}<tr>{{for ~cwidth=cwidth ~cheight=cheight ~cols1}}<td class='e-monthcells' width='{{:~cwidth}}' height='{{:~cheight}}'><div class='e-monthheader'><\/div><div class='e-appointwrapper'><\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._monthCellsTemplate},f=function(){return this._appTemplate="<div class='{{:appClass}} {{:appointCustomcss}}' id='Appointment_{{:id}}' role='presentation' style='{{if rtl == true}}right{{else}}left{{/if}}: {{:left}}; width: {{:appWidth}}; background: {{:appointData}};  color:{{:appointtextcolor}}; height: {{:appHeight}}px; top: {{:top}}px;' >{{if appClass == 'e-appointment'}}{{if orientation == 'vertical'}}<div class='e-tophandle'><\/div><div class='e-bottomhandle'><\/div>{{else}}<div class='e-lefthandle'><\/div><div class='e-righthandle'><\/div>{{/if}}{{else}}<div class='e-lefthandle'><\/div><div class='e-righthandle'><\/div>{{/if}}{{if userAppTemplId == false}}<div class='e-appointinnertext'><div class='e-apptext'>{{:subject}} <\/div><div class='e-apptime'> {{:startTime}} - {{:endTime}}<\/div>{{if value == true}}<div class='e-multipleCategory'>{{:multiDiv}}<\/div>{{/if}}<\/div>{{else}}{{:userTemplate}}{{/if}}<\/div>",this._appTemplate},e=function(){return this._categorizeMultipleTemplate="{{for renderData }}<div style='background:{{:value}};height:11px;width:6px;float:left'><\/div>{{/for}}",this._categorizeMultipleTemplate},o=function(){return this._headerTemplate="{{for cols ~view=view ~colspan=colspan}}<td class='e-headercells' colspan='{{:~colspan}}'><div class='e-dateheadercell'> <span class='e-headerdaydisplay'>{{:currentDay}}<\/span><\/div><\/td>{{/for}}",this._headerTemplate},s=function(){return this._leftIndent="<table class='e-table e-leftindenttable' width='{{:cswidth}}' cellpadding='0px' cellspacing='0px'><tbody> {{for trs ~tdClass=tdClass ~divClass=divClass}} <tr>{{for ~tdClass=tdClass ~divClass=divClass}} <td class='{{:~tdClass}}'style='height:27px;'> <div class='{{:~divClass}}'><\/div><\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._leftIndent},h=function(){return this._alldayTemplate="{{for cols ~colspan=colspan}} <td class='e-alldaycells' style='height:27px;' colspan='{{:~colspan}}'> <\/td>{{/for}}",this._alldayTemplate},c=function(){return this._workCellsTemplate="<table class='e-table e-workcellstab' height='100%'width='100%' cellpadding='0px' cellspacing='0px'><tbody >{{for cellrows ~cols1=cols1}}<tr>{{for ~index=#index ~cwidth=cwidth ~cheight=cheight ~cols1 }}{{if (~index+1) % 2 == 0 }}<td class='e-workcells' width='{{:~cwidth}}' height='{{:~cheight}}'>{{else}}<td class='e-workcells e-alternatecells'width='{{:~cwidth}}' height='{{:~cheight}}'>{{/if}}<div class='e-appointwrapper'><\/div><\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._workCellsTemplate},l=function(){return this._timeCellsTemplate="<div class='e-scrolltimecells'><table class='e-table e-timecelltable' cellpadding='0px' cellspacing='0px'><tbody>{{for timerows ~cols1=cols1 ~view1=viewclass}}<tr>{{for ~name=time ~id=id ~view=~view1 }} {{if ~view == 0}}<td class='e-timecells'><div class='e-timecelldivs'>{{:~name.slice(0,2)}}<\/div><\/td> <td class='e-timecells' rowspan='1'>{{for ~cols1}}{{if (#index+1)%2 ==0}}<div class='e-ampmdisplay'><\/div>{{else}}<div id='{{:~id}}' class='e-ampmdisplay e-ampmstyle'>{{:~name.slice(3,5)}}<\/div> {{/if}}{{/for}} <\/td>{{else}}<td class='e-timecells' style='width:51px;'><div class='e-timecelldivs'><\/div><\/td>{{/if}}{{/for}}<\/tr>{{/for}}<\/tbody><\/table><\/div>",this._timeCellsTemplate};t.widget("ejSchedule","ej.Schedule",{_rootCSS:"e-schedule",element:null,validTags:["div"],model:null,defaults:{timezoneCollection:[{text:"UTC -12:00",value:"UTC -12:00"},{text:"UTC -11:00",value:"UTC -11:00"},{text:"UTC -10:00",value:"UTC -10:00"},{text:"UTC -09:00",value:"UTC -09:00"},{text:"UTC -08:00",value:"UTC -08:00"},{text:"UTC -07:00",value:"UTC -07:00"},{text:"UTC -06:00",value:"UTC -06:00"},{text:"UTC -05:00",value:"UTC -05:00"},{text:"UTC -04:30",value:"UTC -04:30"},{text:"UTC -04:00",value:"UTC -04:00"},{text:"UTC -03:30",value:"UTC -03:30"},{text:"UTC -03:00",value:"UTC -03:00"},{text:"UTC -02:00",value:"UTC -02:00"},{text:"UTC -01:00",value:"UTC -01:00"},{text:"UTC +00:00",value:"UTC +00:00"},{text:"UTC +01:00",value:"UTC +01:00"},{text:"UTC +02:00",value:"UTC +02:00"},{text:"UTC +03:00",value:"UTC +03:00"},{text:"UTC +03:30",value:"UTC +03:30"},{text:"UTC +04:00",value:"UTC +04:00"},{text:"UTC +04:30",value:"UTC +04:30"},{text:"UTC +05:00",value:"UTC +05:00"},{text:"UTC +05:30",value:"UTC +05:30"},{text:"UTC +05:45",value:"UTC +05:45"},{text:"UTC +06:00",value:"UTC +06:00"},{text:"UTC +06:30",value:"UTC +06:30"},{text:"UTC +07:00",value:"UTC +07:00"},{text:"UTC +08:00",value:"UTC +08:00"},{text:"UTC +09:00",value:"UTC +09:00"},{text:"UTC +09:30",value:"UTC +09:30"},{text:"UTC +10:00",value:"UTC +10:00"},{text:"UTC +11:00",value:"UTC +11:00"},{text:"UTC +12:00",value:"UTC +12:00"},{text:"UTC +13:00",value:"UTC +13:00"},],views:["Day","Week","WorkWeek","Month"],currentView:"week",timeMode:"12",dateFormat:"MM/dd/yyyy",timeZone:null,startHour:0,endHour:24,highlightBusinessHours:!0,enablePersistence:!1,showQuickWindow:!0,businessStartHour:9,businessEndHour:18,width:"800px",height:"800px",cellHeight:"20px",cellWidth:"",currentDate:new Date,minDate:new Date(1900,01,01),maxDate:new Date(2099,12,31),cssClass:"",locale:"en-US",enableResize:!1,readOnly:!1,enableRTL:!1,enableAppointmentNavigation:!0,appointmentTemplateId:null,resourceHeaderTemplateId:null,allowDragDrop:!0,enableAppointmentResize:!0,showCurrentTimeIndicator:!0,reminderSettings:{enable:!1,alertBefore:5},contextMenuSettings:{enable:!1,menuItems:{appointment:[{id:"open",text:"Open Appointment"},{id:"delete",text:"Delete Appointment"}],cells:[{id:"new",text:"New Appointment"},{id:"recurrence",text:"New Recurring Appointment"},{id:"today",text:"Today"},{id:"gotodate",text:"Go to date"},{id:"settings",text:"Settings"},{id:"view",text:"View",parentId:"settings"},{id:"timemode",text:"TimeMode",parentId:"settings"},{id:"view_Day",text:"Day",parentId:"view"},{id:"view_Week",text:"Week",parentId:"view"},{id:"view_Workweek",text:"Workweek",parentId:"view"},{id:"view_Month",text:"Month",parentId:"view"},{id:"timemode_Hour12",text:"12 Hours",parentId:"timemode"},{id:"timemode_Hour24",text:"24 Hours",parentId:"timemode"},{id:"businesshours",text:"Business Hours",parentId:"settings"}]}},group:null,resources:null,allowKeyboardNavigation:!0,appointmentSettings:{dataSource:null,query:null,tableName:null,id:null,subject:null,description:null,startTime:null,endTime:null,recurrence:null,recurrenceRule:null,allDay:null,resourceFields:null,categorize:null},renderDates:null,orientation:"vertical",categorizeSettings:{enable:!1,allowMultiple:!1,dataSource:[{text:"Blue Category",id:1,color:"#7499e1",fontColor:"green"},{text:"Green Category",id:2,color:"#7cce6e",fontColor:"green"},{text:"Orange Category",id:3,color:"#f19d5a",fontColor:"green"},{text:"Purple Category",id:4,color:"#937bd1",fontColor:"green"},{text:"Red Category",id:5,color:"#d98889",fontColor:"green"},{text:"Yellow Category",id:6,color:"#f8f264",fontColor:"green"}],text:"text",id:"id",color:"color",fontColor:"fontColor"},cellClick:null,appointmentClick:null,cellDoubleClick:null,appointmentWindowOpen:null,appointmentSaved:null,appointmentEdited:null,appointmentDeleted:null,navigation:null,dragStart:null,drag:null,dragStop:null,resizeStart:null,resize:null,resizeStop:null,menuItemClick:null,beforeContextMenuOpen:null,reminder:null,actionBegin:null,actionComplete:null},dataTypes:{views:"array",timezoneCollection:"array",renderDates:"data",enablePersistence:"boolean",resources:"array",resources:{resourceSettings:"arary"},group:{resources:"array"},appointmentSettings:{dataSource:"data",query:"data"},contextMenuSettings:{menuItems:{appointment:"array",cells:"array"}}},_ignoreOnPersist:["appointmentSettings.query","appointmentSettings.dataSource","allowKeyboardNavigation","showQuickWindow","cssClass","locale","enableResize","readOnly","enableRTL","enableAppointmentNavigation","appointmentTemplateId","resourceHeaderTemplateId","allowDragDrop","enableAppointmentResize","showCurrentTimeIndicator","reminderSettings.enable","contextMenuSettings.enable","group.resources","categorizeSettings.enable","categorizeSettings.dataSource","cellClick","appointmentClick","cellDoubleClick","appointmentWindowOpen","appointmentSaved","appointmentEdited","appointmentDeleted","navigation","dragStart","dragStop","resizeStart","resize","resizeStop","menuItemClick","beforeContextMenuOpen","reminder"],_ignoreFromAppointmentOnExport:["dataSource","query","tableName","resourceFields"],_resources:function(){this.element.empty();this._bindResourcesData();t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll()},observables:["appointmentSettings.dataSource","currentView","currentDate"],_tags:[{tag:"timezoneCollection",attr:[],singular:"timezoneCollection"},{tag:"appointmentSettings.dataSource",attr:[],singular:"dataSource"},{tag:"resources",attr:["allowMultiple","resourcesetting.text","resourcesetting.id","resourcesetting.groupId","resourcesetting.color",[{tag:"resourceSettings.dataSource",attr:[]}]]},{tag:"contextMenuSettings.menuItems.appointment",attr:["id","text","parentId"],singular:"appointment"},{tag:"contextMenuSettings.menuItems.cells",attr:["id","text","parentId"]},{tag:"categorizeSettings.dataSource",attr:["text","id","color","fontColor"]}],currentView:t.util.valueFunction("currentView"),currentDate:t.util.valueFunction("currentDate"),dataSource:t.util.valueFunction("appointmentSettings.dataSource"),_init:function(){this._currentDateFormat(this.model.dateFormat);this._trigger("load");this.element.addClass("e-schedule");!t.isNullOrUndefined(this.model.appointmentSettings.query)&&this.model.appointmentSettings.query instanceof t.Query||(this.model.appointmentSettings.query=t.Query());this.model.cssClass!=null&&this.element.addClass(this.model.cssClass);this._initPrivateProperties();t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)?this._bindResourcesData():this._renderInitSchedule();this._wireEvents();t.isNullOrUndefined(this.model.appointmentSettings)||(this._dataManager=this.dataSource()instanceof t.DataManager?this.dataSource():this.dataSource()!=null?t.DataManager(this.dataSource()):null);this._bindAppointmentsData();this.model.enableRTL&&this.element.addClass("e-rtl");this.model.reminderSettings.enable&&(this._checkReminders(),this._reminderInterval=window.setInterval(n.proxy(this._checkReminders,this),6e4));this._businessHourScroller()},_setModel:function(i){var u=!1,e=!1,r,s,h,f,c,o,l;for(r in i)switch(r){case"views":this.hTD.find("table.e-viewstable").remove();this.hTD.find("div.e-viewsdiv").append(this._renderViewNavigation(i[r]));break;case"currentView":this._navView=!0;this._viewChange(null,null,t.util.getVal(i[r]));break;case"currentDate":this._setCurrentDate=!0;n.type(i[r])=="string"&&this._currentDateFormat(this.model.dateFormat);this.currentDate()<this.model.minDate&&this.currentDate(this.model.minDate);this.currentDate()>this.model.maxDate&&this.currentDate(this.model.maxDate);this._navigateClick(null);break;case"minDate":this._currentDateFormat(this.model.dateFormat);u=!0;break;case"maxDate":this._currentDateFormat(this.model.dateFormat);u=!0;break;case"timeMode":this.model.timeMode=i[r];this._appointmentAddWindow.find(".startendtime").ejTimePicker({timeFormat:this.model.timeMode=="12"?this._pattern.t:"HH:mm"});this.currentView()==="month"||this._isCustomView()||(s=this.currentView()=="month"?1:0,h=this.timeCellTemplate.render({timerows:this._getStartEndTime(),cols1:[1,2],viewclass:s}),this.$TimeCellTD.children().remove(),this.$TimeCellTD.append(h),this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove(),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll());break;case"timeZone":this.model.timeZone=i[r];this.element.find("div.e-categorybar").remove();this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment").remove();this._bindAppointmentsData();break;case"startHour":this.model.startHour=i[r];this._setNewStartEndHours();break;case"endHour":this.model.endHour=i[r];this._setNewStartEndHours();break;case"highlightBusinessHours":this.model.highlightBusinessHours=i[r];this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells")&&this.element.find(".e-monthcells").removeClass("e-monthcellhighlight");this.model.highlightBusinessHours==!1?this._businessHourScroller():"";break;case"businessStartHour":this.model.businessStartHour=i[r];this.currentView()!=="month"&&!this._isCustomView()?this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"):this.element.find(".e-monthcells").removeClass("e-monthcellhighlight");this.model.highlightBusinessHours&&this._highlightBusinessHours();break;case"businessEndHour":this.model.businessEndHour=i[r];this.currentView()!=="month"&&!this._isCustomView()?this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"):this.element.find(".e-monthcells").removeClass("e-monthcellhighlight");this.model.highlightBusinessHours&&this._highlightBusinessHours();break;case"height":this.model.height=i[r];this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove();u=!0;break;case"width":this.model.width=i[r];this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove();u=!0;break;case"cssClass":this.element.removeClass(this.model.cssClass).addClass(i[r]);break;case"locale":this.model.locale=i[r];f=this.model;this.element.ejSchedule("destroy").ejSchedule(f);break;case"dateFormat":this._appointmentAddWindow.find(".startenddate").ejDatePicker({dateFormat:i[r]});this._appointmentAddWindow.find(".recurstartdate").ejDatePicker({dateFormat:i[r]});this._appointmentAddWindow.find(".e-until").ejDatePicker({dateFormat:i[r]});this._currentDateFormat(i[r]);break;case"enableResize":this.model.enableResize=i[r];this.model.enableResize&&(t.isTouchDevice()?this._on(n(window),"orientationchange",this._scheduleResize):this._on(n(window),"resize",this._scheduleResize),this._wireResizeEvents());break;case"readOnly":this.model.readOnly=i[r];this._renderAppointmentAll();break;case"showCurrentTimeIndicator":this.model.showCurrentTimeIndicator=i[r];this._highlightCurrentTime(this.model.showCurrentTimeIndicator);this.model.showCurrentTimeIndicator||(this.currentView()!=="month"&&!this._isCustomView()?n(".e-highlightcurrenttimeline").remove():n(this.element.find(".e-monthcells")).removeClass("e-monthcurrenttime"));break;case"enableRTL":i[r]?this.element.addClass("e-rtl"):this.element.removeClass("e-rtl");this.model.enableRTL=i[r];f=this.model;this.element.ejSchedule("destroy").ejSchedule(f);break;case"appointmentTemplateId":this.model.appointmentTemplateId=i[r];this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment").remove();this.element.find("div.e-categorybar").remove();t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll();break;case"allowKeyboardNavigation":this.model.allowKeyboardNavigation=i[r];this.model.allowKeyboardNavigation?(this._on(this.element,"keydown",n.proxy(this._onKeyDown,this)),this._on(n(document),"keydown",n.proxy(this._documentOnKeyDown,this))):(this._off(this.element,"keydown"),this._off(n(document),"keydown"));break;case"renderDates":n.extend(this.model.renderDates,i[r]);this._navView=!0;this._navigate=!1;this._viewChange(null,null,"customview");break;case"appointmentSettings":n.extend(this.model.appointmentSettings,i[r]);this.element.find("div.e-categorybar").remove();this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-appsoverflow").remove();this._bindAppointmentsData();break;case"contextMenuSettings":n.extend(this.model.contextMenuSettings,i[r]);this.model.contextMenuSettings.enable&&t.isNullOrUndefined(this._contextMenu)&&this._showContextMenu(this.model.contextMenuSettings.enable);break;case"reminderSettings":i[r].enable?this._checkReminders()&&(this._reminderInterval=window.setInterval(n.proxy(this._checkReminders,this),6e4)):window.clearInterval(this._reminderInterval);break;case"enableAppointmentNavigation":this.model.enableAppointmentNavigation=i[r];this.model.enableAppointmentNavigation?(this._nextPrevAppointment(this.model.enableAppointmentNavigation),t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll()):this.element.find(".e-prev,.e-next").remove();break;case"resources":t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&(n.extend(this.model.resources,i[r]),u=!0,e=!0);break;case"categorizeSettings":n.extend(this.model.categorizeSettings,i[r]);t.isNullOrUndefined(this.model.categorizeSettings)||(this._appointmentAddWindow.find(".e-categorizevalue").length==0&&($appWindow="<tr><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Categorize")+":<\/td><td colspan='3' class='e-rightfields'><input id= '"+this._id+"_categorize' class='e-categorizevalue' type='text' value=''/><div id='ownerlist'><\/div><\/td><\/tr>",this._appointmentAddWindow.find("#"+this._id+"summary").after($appWindow),this._renderTemplates(),c=this._appointmentAddWindow,this._renderCategoryItems(c)),this._showContextMenu(this.model.contextMenuSettings.enable),t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll());break;case"group":t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&(n.extend(this.model.group,i[r]),u=!0,e=!0);break;case"cellWidth":this.model.cellWidth=i[r];this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove();u=!0;break;case"cellHeight":this.model.cellHeight=i[r];this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove();u=!0;break;case"orientation":this.model.orientation=i[r];u=!0;break;case"resourceHeaderTemplateId":this.model.resourceHeaderTemplateId=i[r];!t.scheduleFeatures.resources||t.isNullOrUndefined(this.model.group)||t.isNullOrUndefined(this.model.resources)||(this.model.orientation=="horizontal"?(o=n(this.wTR.find("td")[0]),o.find("div.e-horizontresdiv").remove(),l=this._renderHorizontalResources(),o.html(l)):(this.aTR.empty(),this._renderHeaderAllDayTemplate(),this._headerbarWidth(),this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay")),this._renderAllDayAppointments()))}u&&(this.element.empty(),this.model.width=this.scrollWidth,this.model.height=this.scrollHeight,n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"AppointmentQuickWindow_wrapper,#"+this._id+"AppDetailsWindow_wrapper").remove(),e?this._bindResourcesData():this._renderInitSchedule(),this.model.highlightBusinessHours==!0?this._businessHourScroller():"",t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll())},_touchSchedule:function(t){if(n(t.target).is(".e-appointment,.e-alldayappointment,.e-monthappointment")||n(t.target).parents().is(".e-appointment,.e-alldayappointment,.e-monthappointment"))return!1;var i;switch(t.type){case"swipeleft":i={currentTarget:this.element.find(".e-navigatenext")};this._navigateClick(i);break;case"swiperight":i={currentTarget:this.element.find(".e-navigateprevious")};this._navigateClick(i)}},_initPrivateProperties:function(){this._appId=0;this._parentId=0;this._currentAction="";this._reminderClose=!1;this._currentAppointmentData=null;this._processed=[];this._dateRender=[];this._rRule={};this._dayNames=["SU","MO","TU","WE","TH","FR","SA"];var n=Globalize.culture(this.model.locale);this._dayShortNames=n.calendar.days.namesAbbr;this._dayFullNames=n.calendar.days.names;this._monthNames=n.calendar.months.names;this._pattern=n.calendar.patterns;this._navView=!1;this._editKey=!1;this._cellClick=!1;this._gotoDate=!0;this._recurChecked=!1;this._currentRowIndex=0;this._currentColIndex=0;this._setCurrentDate=!1;this._browserInfo=t.browserInfo();this._leftResizing=!1;this._rightResizing=!1;this._topResizing=!1;this._bottomResizing=!1;this._focused=null;this._navigate=!1},_destroy:function(){this._destorySubControls(n("#"+this._id+"_AddEditForm"));this._destorySubControls(n("#"+this._id+"_RecurForm"));this.element.find("#"+this._id+"_navigator").ejDatePicker("destroy");window.clearInterval(this._intervalID);n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"AppointmentQuickWindow_wrapper,#"+this._id+"AppDetailsWindow_wrapper").remove();n("#"+this._id+"_WorkCells_Template,#"+this._id+"_MonthCells_Template,#"+this._id+"_TimeCells_Template,#"+this._id+"_HeaderDate_Template,#"+this._id+"_Appointment_Template,#"+this._id+"_AlldayCells_Template").remove();this.element.empty().removeClass("e-schedule")},_destorySubControls:function(t){$formEle=t.find(".e-timepicker,.e-datepicker,.e-dropdownlist,.e-autocomplete");for(var i=0;i<$formEle.length;i++)$element=n($formEle[i]),$element.hasClass("e-timepicker")?$element.ejTimePicker("destroy"):$element.hasClass("e-datepicker")?$element.ejDatePicker("destroy"):$element.hasClass("e-dropdownlist")?$element.ejDropDownList("destroy"):$element.hasClass("e-autocomplete")&&$element.ejAutocomplete("destroy")},_wireEvents:function(){this._on((this.element,n(window)),"mousedown",n.proxy(this._onScheduleMouseDown,this));this._on(this.element,"click","div.e-navigateprevious,div.e-navigatenext",n.proxy(this._navigateClick,this));this._on(n(window),"resize",n.proxy(this._onScheduleResize,this));this._on(this.element,"click",".e-commonviewbutton",n.proxy(this._viewChange,this));this._on(this.element,"click",".e-datedisplay",n.proxy(this._viewCalendar,this));this._on(this.element,"click","div.e-appsoverflow",n.proxy(this._appOverflowClick,this));this._on(this.element,"click",".e-prev.enable,.e-next.enable",n.proxy(this._nextPrev,this));this._on(this.element,"dblclick",".e-headercells",n.proxy(this._navigateView,this));this._on(this.element,"click",".e-headercells,.e-timecells,td.e-monthcells div.e-monthheader",n.proxy(this._navigateView,this));this._on(this.element,"mouseover","td.e-workcells,td.e-monthcells",n.proxy(this._onCellMouseOver,this));this._on(this.element,"mouseout","td.e-workcells,td.e-monthcells",n.proxy(this._onCellMouseOver,this));this._on(this.element,n.isFunction(n.fn.tap)?"tap":"click",".e-workcells,.e-alldaycells,.e-alldayappointment,.e-monthcells,div.e-monthappointment",n.proxy(this._cellSelection,this));this._on(this.element,t.eventType.mouseDown,"td.e-workcells,td.e-monthcells",n.proxy(this._mouseButtonClick,this));this._on(this.element,"keydown click","td.e-workcells,td.e-monthcells",n.proxy(this._shiftSelection,this));this._on(this.element,"dblclick",".e-workcells,.e-alldaycells,.e-alldayappointment,div.e-monthappointment,.e-monthcells",n.proxy(this._appointmentWindow,this));this._on(this.element,"mouseover",".e-appointment,.e-alldayappointment,.e-monthappointment",n.proxy(this._onAppointMouseOver,this));this._on(this.element,"mouseout",".e-appointment,.e-alldayappointment,.e-monthappointment",n.proxy(this._onAppointMouseOver,this));this.model.allowKeyboardNavigation&&(this._on(this.element,"keydown",n.proxy(this._onKeyDown,this)),this._on(n(document),"keydown",n.proxy(this._documentOnKeyDown,this)));this.model.orientation=="horizontal"&&this._on(this.element,"click","td.e-parentnodecategory",n.proxy(this._onResourceClick,this));this._on(this.element,"swipeleft swiperight",".e-contentarearow .e-workcellstab",n.proxy(this._touchSchedule,this));this.model.enableResize&&(t.isTouchDevice()?this._on(n(window),"orientationchange",this._scheduleResize):this._on(n(window),"resize",this._scheduleResize))},_mouseButtonClick:function(n){if(!n.altKey&&!n.shiftKey&&!n.ctrlKey&&n.which!=3&&(n.which==1||n.type=="touchstart")){var t=n.target||document.activeElement||n.srcElement;this._mouseSelect(n,t)}},_shiftSelection:function(t){var d,f,h,u,g,l,c;if(t.shiftKey==!0&&t.which==1){d=this._focused;this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");this.element.find("e.workcells,e.alldaycells,.e-monthcells").removeClass("e-mousehover");this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell");this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment");f=this.element.find("div.e-draggableworkarea tr");h=n(d).parent()[0].rowIndex;u=n(d)[0].cellIndex;var y=this.currentView(),b=f.length-1,e,o,i,s=n(t.target).parent()[0].rowIndex,r=n(t.target)[0].cellIndex,it=this.model.orientation=="horizontal"&&this.model.currentView=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,rt=this.model.orientation,ut=(this.model.endHour-this.model.startHour)*2,k=n(t.target).hasClass("e-workcells")?n(t.target).index():n(t.target).hasClass("e-alldaycells")?n(t.target).index():7-((parseInt(n(t.target).index()/7)+1)*7-n(t.target).index())+n(t.target).parent().index()*7;if(rt=="horizontal"&&(k=y!=="month"?Math.floor(k/ut):k),g=new Date(it[k]),g>=this.model.minDate&&g<=this.model.maxDate)if(n(t.target).hasClass("e-workcells"))if(this.model.orientation=="vertical"){var a=y=="day"?1:y=="workweek"?5:7,v=Math.floor(n(t.target).index()/a),nt=a*(v+1),tt=a*v;if(u>=parseInt(tt)&&u<=parseInt(nt)-1&&r!="undefined"){if(u==r)if(s>h)for(i=parseInt(h);i<=s;i++)n(f[i].cells[u]).addClass("e-selectedCell");else if(s<h)for(i=parseInt(h);i>=s;i--)n(f[i].cells[u]).addClass("e-selectedCell");else n(f[s].cells[r]).addClass("e-selectedCell");else if(r>u){for(c=r-u,e=parseInt(h);e<=b;e++)n(f[e].cells[u]).addClass("e-selectedCell");if(c>1)for(i=1;i<=c-1;i++)for(l=0;l<=b;l++)n(f[l].cells[r-i]).addClass("e-selectedCell");for(o=0;o<=s;o++)n(f[o].cells[r]).addClass("e-selectedCell")}else if(r<u){for(c=u-r,e=parseInt(h);e>=0;e--)n(f[e].cells[u]).addClass("e-selectedCell");if(c>1)for(i=1;i<=c-1;i++)for(l=0;l<=b;l++)n(f[l].cells[[r+i]]).addClass("e-selectedCell");for(o=parseInt(s);o<=b;o++)n(f[o].cells[r]).addClass("e-selectedCell")}this._currentRowIndex=s;this._currentColIndex=r;n(f[s].cells[r]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1}else{var ft=y=="day"?1:y=="workweek"?5:7,a=this.model.currentView=="month"?this.totdays.length:ft*(this.model.endHour-this.model.startHour)*2,v=Math.floor(n(t.target).index()/a),nt=a*(v+1),tt=a*v;if(h==s&&u>=parseInt(tt)&&u<=parseInt(nt)-1&&r!="undefined"){if(r>u)for(o=u;o<=r;o++)n(f[s].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(r<=u)for(o=u;o>=r;o--)n(f[s].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1}else if(n(t.target).hasClass("e-monthcells")){var v=Math.floor(n(t.target).index()/7),p=7*parseInt(v),w=7*(v+1);if(u>=parseInt(p)&&u<=parseInt(w)-1&&r!="undefined"){if(s==h)if(r<u)for(i=u;i>=r;i--)n(f[s].cells[i]).addClass("e-selectedCell");else if(r>u)for(i=u;i<=r;i++)n(f[s].cells[i]).addClass("e-selectedCell");else r==u&&n(f[s].cells[r]).addClass("e-selectedCell");else if(s>h){for(c=s-h,e=u;e<w;e++)n(f[h].cells[e]).addClass("e-selectedCell");if(c>1)for(i=1;i<=c-1;i++)for(e=p;e<w;e++)n(f[h+i].cells[e]).addClass("e-selectedCell");for(o=p;o<=r;o++)n(f[s].cells[o]).addClass("e-selectedCell")}else if(s<h){for(c=h-s,e=u;e>=p;e--)n(f[h].cells[e]).addClass("e-selectedCell");if(c>1)for(i=1;i<=c-1;i++)for(e=p;e<w;e++)n(f[h-i].cells[e]).addClass("e-selectedCell");for(o=w-1;o>=r;o--)n(f[s].cells[o]).addClass("e-selectedCell")}this._currentRowIndex=s;this._currentColIndex=r;n(f[s].cells[r]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1}}},_mouseSelect:function(i,r){var u,f,e,h,s,k,c,o,y;this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");u=this.element.find("div.e-draggableworkarea tr");n(r).hasClass("e-selectedAppointment")&&(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(u[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());k=this.element.find("div.e-draggableworkarea");f=n(r).parent()[0].rowIndex;e=n(r)[0].cellIndex;c=this.currentView();o=u.length-1;this._currentRowIndex=f;this._currentColIndex=e;var a=this.model.orientation,v=(this.model.endHour-this.model.startHour)*2,p=this.model.minDate,w=this.model.maxDate,b=this.model.orientation=="horizontal"&&this.model.currentView=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,l=n(i.target).hasClass("e-workcells")?n(i.target).index():n(i.target).hasClass("e-alldaycells")?n(i.target).index():7-((parseInt(n(i.target).index()/7)+1)*7-n(i.target).index())+n(i.target).parent().index()*7;a=="horizontal"&&(l=c!=="month"?Math.floor(l/v):l);y=new Date(b[l]);y>=p&&y<=w&&(n(r).hasClass("e-workcells")||n(r).hasClass("e-monthcells"))&&(u.bind(t.eventType.mouseMove,function(t){var g,st,et,ht,i,y,k,r,l,it,nt,tt;if(t.preventDefault(),g=t.target,t.type=="touchmove"&&(st=t.originalEvent.changedTouches[0],g=document.elementFromPoint(st.pageX,st.pageY)),et=n(g).hasClass("e-workcells")?n(g).index():n(g).hasClass("e-alldaycells")?n(g).index():7-((parseInt(n(g).index()/7)+1)*7-n(g).index())+n(g).parent().index()*7,a=="horizontal"&&(et=c!=="month"?Math.floor(et/v):et),ht=new Date(b[et]),ht>=p&&ht<=w&&(n(g).hasClass("e-workcells")||n(g).hasClass("e-monthcells")))if(r=n(g).parent()[0].rowIndex,l=n(g)[0].cellIndex,a=="vertical"){if(n(g).hasClass("e-workcells")){var rt=c=="day"?1:c=="workweek"?5:7,ut=Math.floor(n(g).index()/rt),ot=rt*(ut+1),ct=rt*ut;if(e>=parseInt(ct)&&e<=parseInt(ot)-1&&l!="undefined"){if(e==l&&(r<=f||r>=f)){if(n(u[r].cells[l]).hasClass("e-selectedCell")){if(l>s){for(i=o;i>=0;i--)n(u[i].cells[l-1]).removeClass("e-selectedCell");if(r>f)for(i=0;i<=o;i++)n(u[i].cells[l]).removeClass("e-selectedCell");else if(r<f)for(i=0;i<r;i++)n(u[i].cells[l]).removeClass("e-selectedCell");else if(r==f)for(i=0;i<=o;i++)i!=f&&n(u[i].cells[l]).removeClass("e-selectedCell")}else if(l<s){for(i=o;i>=0;i--)n(u[i].cells[l+1]).removeClass("e-selectedCell");if(r>f)for(i=o;i>r;i--)n(u[i].cells[l]).removeClass("e-selectedCell");else if(r<f)for(i=o;i>f;i--)n(u[i].cells[l]).removeClass("e-selectedCell");else if(r==f)for(i=0;i<=o;i++)i!=f&&n(u[i].cells[l]).removeClass("e-selectedCell")}else if(l==s)if(r>f)for(i=o;i>r;i--)n(u[i].cells[l]).removeClass("e-selectedCell");else if(r<f)for(i=0;i<r;i++)n(u[i].cells[l]).removeClass("e-selectedCell");else if(r==f)for(i=0;i<=o;i++)i!=f&&n(u[i].cells[l]).removeClass("e-selectedCell")}else if(r>f){for(i=0;i<=o;i++)n(u[i].cells[s]).removeClass("e-selectedCell");for(y=0;y<f;y++)n(u[y].cells[e]).removeClass("e-selectedCell");for(k=parseInt(f);k<=r;k++)n(u[k].cells[e]).addClass("e-selectedCell")}else if(r<f){for(i=0;i<o;i++)n(u[i].cells[s]).removeClass("e-selectedCell");for(y=o;y>f;y--)n(u[y].cells[e]).removeClass("e-selectedCell");for(k=parseInt(f);k>=r;k--)n(u[k].cells[e]).addClass("e-selectedCell")}n(u[r].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else if(l>e)if(n(u[r].cells[l]).hasClass("e-selectedCell")){if(l<s){for(i=o;i>=0;i--)n(u[i].cells[s]).removeClass("e-selectedCell");for(y=o;y>r;y--)n(u[y].cells[l]).removeClass("e-selectedCell")}else if(l==s)for(i=o;i>r;i--)n(u[i].cells[l]).removeClass("e-selectedCell");n(u[r].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else{for(nt=0;nt<f;nt++)n(u[nt].cells[e]).removeClass("e-selectedCell");for(tt=l-e,i=parseInt(f);i<=o;i++)n(u[i].cells[e]).addClass("e-selectedCell");if(tt>1)for(k=1;k<=tt-1;k++)for(it=0;it<=o;it++)n(u[it].cells[l-k]).addClass("e-selectedCell");for(y=0;y<=r;y++)n(u[y].cells[l]).addClass("e-selectedCell");n(u[r].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else if(l<e)if(n(u[r].cells[l]).hasClass("e-selectedCell")){if(l>s){for(i=o;i>=0;i--)n(u[i].cells[s]).removeClass("e-selectedCell");for(y=0;y<r;y++)n(u[y].cells[l]).removeClass("e-selectedCell")}else if(l==s)for(i=0;i<r;i++)n(u[i].cells[l]).removeClass("e-selectedCell");n(u[r].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else{for(nt=o;nt>f;nt--)n(u[nt].cells[e]).removeClass("e-selectedCell");for(tt=e-l,i=parseInt(f);i>=0;i--)n(u[i].cells[e]).addClass("e-selectedCell");if(tt>1)for(k=1;k<=tt-1;k++)for(it=0;it<=o;it++)n(u[it].cells[[l+k]]).addClass("e-selectedCell");for(y=o;y>=parseInt(r);y--)n(u[y].cells[l]).addClass("e-selectedCell");n(u[r].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus()}}else return!1}else if(n(g).hasClass("e-monthcells")){var ut=Math.floor(n(g).index()/7),ft=7*parseInt(ut),d=7*(ut+1);if(e>=parseInt(ft)&&e<=parseInt(d)-1&&l!="undefined")if(n(u[r].cells[l]).hasClass("e-selectedCell")){if(r==f){if(r<h){for(i=d;i>l;i--)n(u[r].cells[i]).removeClass("e-selectedCell");for(y=d;y>=0;y--)n(u[r+1].cells[y]).removeClass("e-selectedCell")}else if(r>h){for(i=l;i<d;i++)n(u[r-1].cells[i]).removeClass("e-selectedCell");for(y=0;y<l;y++)n(u[r].cells[y]).removeClass("e-selectedCell")}else if(r==h){if(l>e)for(i=d;i>l;i--)n(u[r].cells[i]).removeClass("e-selectedCell");else if(l<e)for(i=0;i<l;i++)n(u[r].cells[i]).removeClass("e-selectedCell");if(l==e)for(i=0;i<=d;i++)i!=e&&n(u[r].cells[i]).removeClass("e-selectedCell")}}else if(r>f){if(r<h){for(i=d;i>l;i--)n(u[r].cells[i]).removeClass("e-selectedCell");for(y=d;y>=0;y--)n(u[r+1].cells[y]).removeClass("e-selectedCell")}else if(r==h)for(y=d;y>l;y--)n(u[r].cells[y]).removeClass("e-selectedCell")}else if(r<f)if(r>h){for(i=l;i<d;i++)n(u[r-1].cells[i]).removeClass("e-selectedCell");for(y=0;y<l;y++)n(u[r].cells[y]).removeClass("e-selectedCell")}else if(r==h)for(y=0;y<l;y++)n(u[r].cells[y]).removeClass("e-selectedCell");n(u[r].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else{if(r==f)if(l<e){for(i=d;i>=0;i--)n(u[r+1].cells[i]).removeClass("e-selectedCell");for(y=d;y>l;y--)n(u[r].cells[y]).removeClass("e-selectedCell");for(k=e;k>=l;k--)n(u[r].cells[k]).addClass("e-selectedCell")}else if(l>e){for(i=0;i<d;i++)r!=0&&n(u[r-1].cells[i]).removeClass("e-selectedCell");for(y=0;y<e;y++)n(u[r].cells[y]).removeClass("e-selectedCell");for(k=e;k<=l;k++)n(u[r].cells[k]).addClass("e-selectedCell")}else l==e&&n(u[r].cells[l]).addClass("e-selectedCell");else if(r>f){for(nt=ft;nt<e;nt++)n(u[f].cells[nt]).removeClass("e-selectedCell");for(tt=r-f,i=e;i<d;i++)n(u[f].cells[i]).addClass("e-selectedCell");if(tt>1)for(k=1;k<=tt;k++)for(i=ft;i<d;i++)n(u[f+k].cells[i]).addClass("e-selectedCell");for(y=ft;y<=l;y++)n(u[r].cells[y]).addClass("e-selectedCell")}else if(r<f){for(nt=d;nt>e;nt--)n(u[f].cells[nt]).removeClass("e-selectedCell");for(tt=f-r,i=e;i>=ft;i--)n(u[f].cells[i]).addClass("e-selectedCell");if(tt>1)for(k=1;k<=tt;k++)for(i=ft;i<d;i++)n(u[f-k].cells[i]).addClass("e-selectedCell");for(y=d-1;y>=l;y--)n(u[r].cells[y]).addClass("e-selectedCell")}n(u[r].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1}h=r;s=l}else{var lt=c=="day"?1:c=="workweek"?5:7,rt=c=="month"?31:lt*v,ut=Math.floor(n(t.target).index()/rt),ot=rt*(ut+1),ct=rt*ut;if(f==r&&e>=parseInt(ct)&&e<=parseInt(ot)-1&&l!="undefined"){if(n(u[r].cells[l]).hasClass("e-selectedCell")){if(l>e)for(i=ot;i>l;i--)n(u[r].cells[i]).removeClass("e-selectedCell");else if(l<e)for(i=0;i<l;i++)n(u[r].cells[i]).removeClass("e-selectedCell");else if(l==e)for(i=0;i<=ot;i++)n(u[r].cells[i]).removeClass("e-selectedCell");n(u[r].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else if(l>e)for(y=e;y<=l;y++)n(u[r].cells[y]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(l<=e)for(y=e;y>=l;y--)n(u[r].cells[y]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1}}),u.bind(t.eventType.mouseUp,function(){u.unbind(t.eventType.mouseMove)}),this.element.find("e.workcells,e.alldaycells,.e-monthcells").removeClass("e-mousehover"),this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell"),this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"))},_onScheduleMouseDown:function(t){var i=n(t.target),r=i.hasClass("e-appointment,e-alldayappointment,e-monthappointment")?i:i.parents(".e-appointment,.e-alldayappointment,.e-monthappointment");i.hasClass("e-workcells")||r.hasClass("e-appointment")||r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment")||i.hasClass("e-alldaycells")||i.hasClass("e-monthcells")||i.parents(".e-scheduledialog").hasClass("e-scheduledialog")||(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),this.element.find(".e-workcells").removeClass("e-mousehover"))},_onCellMouseOver:function(t){var i=n(t.currentTarget),r=n(t.target).hasClass("e-workcells")?n(t.target).index():n(t.target).hasClass("e-alldaycells")?n(t.target).index():7-((parseInt(n(t.target).index()/7)+1)*7-n(t.target).index())+n(t.target).parent().index()*7,f,u;if(this.model.orientation=="horizontal"&&(r=this.model.currentView!=="month"?Math.floor(r/((this.model.endHour-this.model.startHour)*2)):r),f=this.model.orientation=="horizontal"&&this.model.currentView=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,u=new Date(f[r]),u>=this.model.minDate&&u<=this.model.maxDate)t.type==="mouseover"?(this.element.find(".e-mousehover").removeClass("e-mousehover"),(i.hasClass("e-workcells")||i.hasClass("e-monthcells"))&&!i.hasClass("e-resourceheadercells")&&i.addClass("e-mousehover")):t.type==="mouseout"&&(i.hasClass("e-workcells")||i.hasClass("e-monthcells"))&&i.removeClass("e-mousehover");else return!1},_onAppointMouseOver:function(t){if(this.model.enableAppointmentResize&&!this.model.readOnly){var i=n(t.target).hasClass("e-appointment,e-alldayappointment,e-monthappointment")?n(t.target):n(t.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment");i.hasClass("e-appointment")&&this.model.orientation=="vertical"?t.type==="mouseover"?(i.find(".e-bottomhandle,.e-tophandle").addClass("e-icon e-nsexpand"),i.find(".e-bottomhandle").addClass("e-appointresizer-bottom"),i.find(".e-tophandle").addClass("e-appointresizer-top")):t.type==="mouseout"&&i.find(".e-bottomhandle,.e-tophandle").removeClass("e-icon e-nsexpand"):((i.hasClass("e-alldayappointment")||i.hasClass("e-monthappointment"))&&this.model.orientation=="vertical"||this.model.orientation=="horizontal")&&(t.type==="mouseover"?(i.find(".e-lefthandle,.e-righthandle").addClass("e-icon e-ewexpand"),i.find(".e-lefthandle").addClass("e-appointresizer-left"),i.find(".e-righthandle").addClass("e-appointresizer-right")):t.type==="mouseout"&&i.find(".e-lefthandle,.e-righthandle").removeClass("e-icon e-ewexpand"))}},_cellSelection:function(i){var c,r,p,f,w,a,l,b,k,d,e,h,it,rt,ut,ft,et,ot;if(i.shiftKey)return!1;if(this.element.find("e.workcells,e.alldaycells,.e-monthcells").removeClass("e-mousehover"),this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell"),this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),c=Globalize.culture(this.model.locale),r=t.isNullOrUndefined(i.target)?n(i):n(i.target),(r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells"))&&!r.hasClass("e-resourceheadercells")){if((this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close"),this._cellIndex=r.hasClass("e-workcells")?r.index():r.hasClass("e-alldaycells")?r.index():7-((parseInt(r.index()/7)+1)*7-r.index())+r.parent().index()*7,this.model.orientation=="horizontal"&&(this._cellIndex=this.model.currentView!=="month"?Math.floor(this._cellIndex/((this.model.endHour-this.model.startHour)*2)):this._cellIndex,this._workCellIndex=r.parent().index()),p=this.model.orientation=="horizontal"&&this.model.currentView=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,f=new Date(p[this._cellIndex]),this.model.minDate>f||this.model.maxDate<f)||(r.hasClass("e-workcells")&&this.model.currentView!=="month"?(w=this.model.orientation=="vertical"?this.model.startHour+r.parent().index()/2:this.model.startHour+(r.index()-(this.model.endHour-this.model.startHour)*2*this._cellIndex)/2,a=w.toString().split("."),this.cur_StartTime=new Date(f).setHours(parseInt(a[0]),parseInt(a[1])==5?30:00),this.cur_EndTime=new Date(new Date(this.cur_StartTime).setMinutes(new Date(this.cur_StartTime).getMinutes()+30)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!1})):r.hasClass("e-workcells")&&this.model.orientation=="horizontal"&&this.model.currentView=="month"?(this.cur_StartTime=new Date(new Date(f).setHours(0,0)),this.cur_EndTime=new Date(new Date(f).setHours(23,59)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0})):(this.cur_StartTime=new Date(new Date(f).setHours(0,0)),this.cur_EndTime=new Date(new Date(f).setHours(23,59)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0})),this.model.showQuickWindow&&(this._quickAppointWindow.find("#"+this._id+"_quickAppwindow").css("display","block"),this._quickAppointWindow.find(".e-quickstartend").html(c.calendar.days.names[new Date(f).getDay()]+", "+Globalize.format(new Date(f),"MMMM")+" "+new Date(f).getDate()+", "+Globalize.format(new Date(this.cur_StartTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")+" - "+Globalize.format(new Date(this.cur_EndTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")),l=n(i).hasClass("e-workcells")||n(i).hasClass("e-alldaycells")||n(i).hasClass("e-monthcells")?n(i):n(i.target),i.type!="beforeOpen"&&!this.model.readOnly?this._quickAppointWindow.ejDialog("open"):"",this._quickAppointWindow.find(".subject").val(""),b=l.offset().left-(this._quickAppointWindow.width()-l.width())/2+10,k=l.offset().top-this._quickAppointWindow.height()-10,this._quickAppointWindow.ejDialog({position:{X:b,Y:k}}),t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._getResourceDetails(r)),d={startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,target:i},this._trigger("cellClick",d)))return!1;r.addClass("e-selectedCell").attr("tabIndex",0).focus();this._focused=n(":focus");this.model.showQuickWindow&&this._quickAppointWindow.find(".subject").focus();this._cellClick=!0;this._appointmentAddWindow.ejDialog({title:this._getLocalizedLabels("CreateAppointmentTitle")})}else if(!r.hasClass("e-resourceheadercells")){if(this._cellClick=!1,this._quickAppDetailsWindow&&this._quickAppDetailsWindow.find("#"+this._id+"_quickAppDetailswindow").css("display","block"),this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close"),e=r.hasClass("e-appointment")||r.hasClass("e-monthappointment")||r.hasClass("e-alldayappointment")?r:r.parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),e.length<=0)return!1;e.attr("tabIndex",0).focus();e.addClass("e-selectedAppointment");this._appId=parseInt(e[0].id.split("_")[1]);var st=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),s=new t.DataManager(this._processed).executeLocal(st),lt=(s[0][this.model.appointmentSettings.endTime]-s[0][this.model.appointmentSettings.startTime])/36e5>24?this._getAppointmentByParentId(this._appId):s[0];this._quickAppDetailsWindow&&this._quickAppDetailsWindow.find(".e-quicksubject").html(s[0][this.model.appointmentSettings.subject]);var u=s[0],g=this.model.timeMode=="12"?Globalize.format(u[this.model.appointmentSettings.startTime],this._pattern.t):Globalize.format(u[this.model.appointmentSettings.startTime],"HH:mm"),nt=this.model.timeMode=="12"?Globalize.format(u[this.model.appointmentSettings.endTime],this._pattern.t):Globalize.format(u[this.model.appointmentSettings.endTime],"HH:mm"),v=(new Date).getTime()-u[this.model.appointmentSettings.startTime].getTime(),y=6e4,ht=60*y,ct=24*ht,tt=Math.abs(new Date-u[this.model.appointmentSettings.startTime]),o=Math.floor(tt/36e5);if(o=o<=9?"0"+o:o,h=new Date(tt).getUTCMinutes(),h=h<=9?"0"+h:h,it=Math.ceil(v/y-1)<0&&o<24?this._getLocalizedLabels("EventBeginsin")+" "+o+" "+this._getLocalizedLabels("Hours")+" "+h+" "+this._getLocalizedLabels("Minutes"):Math.ceil(v/y-1)<0&&o>=24?this._getLocalizedLabels("EventBeginsin")+" "+Math.abs(Math.ceil(v/ct))+" "+this._getLocalizedLabels("Days"):this._getLocalizedLabels("Overdue"),this.model.showQuickWindow){if(this._quickAppDetailsWindow.find(".e-rightfields").html(it),rt=c.calendar.days.names[u[this.model.appointmentSettings.startTime].getDay()]+", "+Globalize.format(u[this.model.appointmentSettings.startTime],"MMMM")+" "+u[this.model.appointmentSettings.startTime].getDate()+", "+g+" - "+nt,ut=c.calendar.days.names[u[this.model.appointmentSettings.startTime].getDay()]+", "+Globalize.format(u[this.model.appointmentSettings.startTime],"MMMM")+" "+u[this.model.appointmentSettings.startTime].getDate()+" - "+c.calendar.days.names[u[this.model.appointmentSettings.endTime].getDay()]+", "+Globalize.format(u[this.model.appointmentSettings.endTime],"MMMM")+" "+u[this.model.appointmentSettings.endTime].getDate()+", "+g+" - "+nt,(u[this.model.appointmentSettings.endTime]-u[this.model.appointmentSettings.startTime])/36e5<24?this._quickAppDetailsWindow.find(".e-quickstartendtime").html(rt):this._quickAppDetailsWindow.find(".e-quickstartendtime").html(ut),u[this.model.appointmentSettings.recurrence]==1)this._quickAppDetailsWindow.find(".e-editseries").removeClass("e-disable").on("click",n.proxy(this._editClick,this));else this._quickAppDetailsWindow.find(".e-editseries").addClass("e-disable").off("click");i.type!="beforeOpen"?this._quickAppDetailsWindow.ejDialog("open"):"";this.model.readOnly?this._quickAppDetailsWindow.find(".e-scheduledelete").addClass("e-disable"):this._quickAppDetailsWindow.find(".e-scheduledelete").removeClass("e-disable");ft=n(e).offset().left-((this._quickAppDetailsWindow.width()-n(e).width())/2-4);et=n(e).offset().top-this._quickAppDetailsWindow.height()-10;this._quickAppDetailsWindow.ejDialog({position:{X:ft,Y:et}});this._quickAppDetailsWindow.focus()}if(ot={appointment:s[0]},this._trigger("appointmentClick",ot))return!1;this._appointmentAddWindow.ejDialog({title:this._getLocalizedLabels("Editevent")})}n(r).hasClass("e-monthcells")||this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")},_checkReminders:function(){var n,t;for(this._todayAppointments=[],n=0;n<this._processed.length;n++)Globalize.format(new Date(this._processed[n][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date,this._pattern.d)&&this._todayAppointments.push(this._processed[n]);t=this;jQuery.each(this._todayAppointments,function(n,i){var r=t.model.reminderSettings.alertBefore,e=i[t.model.appointmentSettings.startTime],u,f;r!=-1&&r!=null&&(u=(new Date).getTime(),f=(u-new Date(e).getTime())/6e4,Math.round(f)==r*-1&&t._trigger("reminder",{reminderAppointment:i}))})},_showContextMenu:function(i){var e=!1,o=this.model.contextMenuSettings.menuItems.cells,f,s,h,r,u,c;if(i){if(this._contextMenu=t.buildTag("ul#"+this._id+"contextMenu"),this.element.append(this._contextMenu),this._contextMenu.ejMenu({fields:{id:"id",text:"text",parentId:"parentId"},menuType:t.MenuType.ContextMenu,openOnClick:!1,contextMenuTarget:"#"+this._id,width:"auto",click:n.proxy(this._onMenuSelect,this),beforeOpen:n.proxy(this._beforeopen,this)}),this.model.categorizeSettings.enable&&this.model.contextMenuSettings.menuItems.appointment){for(f=this.model.contextMenuSettings.menuItems.appointment,s=this.model.categorizeSettings.dataSource.length,r=0;r<f.length;r++)if(f[r].id=="categorize"){h=r;break}for(r=0;r<s;r++)u=this.model.categorizeSettings,this.model.contextMenuSettings.menuItems.appointment.push({text:u.dataSource[r][u.text],id:"categorize_"+u.dataSource[r][u.id],fontColor:u.dataSource[r][u.fontColor],color:u.dataSource[r][u.color],parentId:this.model.contextMenuSettings.menuItems.appointment[h].id.toString()})}if(this._gotoDate&&this.model.contextMenuSettings.enable){for(c in o)if(o[c].id=="gotodate"){e=!0;break}e&&(this._renderGotoWindow(),this._gotoDate=!1)}}},_beforeopen:function(i){var u,o,f,h,c,s,e,r,l,a;if(this.model.contextMenuSettings.enable){if(n(document).unbind(t.eventType.mouseMove),u=n(i.target),this._baseTarget=u,this._trigger("beforeContextMenuOpen",{events:i}))return!1;if(f=this._contextMenu.data("ejMenu"),i.cancel=u.hasClass("e-workcells")||u.hasClass("e-alldaycells")||u.hasClass("e-appointinnertext")||u.hasClass("e-monthcells")||u.hasClass("e-apptime")||u.hasClass("e-apptext")?!1:!0,o=u.hasClass("e-appointinnertext")||u.hasClass("e-apptime")||u.hasClass("e-apptext")?!1:!0,o?f.option("fields.dataSource",this.model.contextMenuSettings.menuItems.cells):f.option("fields.dataSource",this.model.contextMenuSettings.menuItems.appointment),this.model.readOnly?(f.disableItemByID("new"),f.disableItemByID("recurrence"),f.disableItemByID("delete"),f.disableItemByID("categorize")):(f.enableItemByID("new"),f.enableItemByID("recurrence"),f.enableItemByID("delete"),f.enableItemByID("categorize")),this._cellSelection(i),this._target=i,this._quickAppointWindow.ejDialog("close"),this._quickAppDetailsWindow.ejDialog("close"),this.model.categorizeSettings.enable&&o==!1){if(h=this._contextMenu.find("li#categorize").find("li").children(),h.find("div").length==0)for(r=0;r<this.model.categorizeSettings.dataSource.length;r++)this._contextMenu.find("li#categorize").find("li#categorize_"+this.model.categorizeSettings.dataSource[r].id).children().append('<div><div style="border: 1px solid black;height: 12px;margin-left: 2px;margin-top: 2px;width: 12px;background-color:'+this.model.categorizeSettings.dataSource[r].color+'"><\/div><\/div>');for(r=1;r<=this.model.categorizeSettings.dataSource.length;r++)this._contextMenu.find("li#categorize").find("li#categorize_"+r).children().find("div:first-child.e-categorizeMenuSelected")&&this._contextMenu.find("li#categorize").find("li#categorize_"+r).children().find("div:first-child").removeClass("e-categorizeMenuSelected");if(c=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),s=t.DataManager(this._processed).executeLocal(c),s[0][this.model.appointmentSettings.categorize])if(e=s[0][this.model.appointmentSettings.categorize].split(","),this.model.categorizeSettings.allowMultiple){if(e[0].length>0)for(r=0;r<e.length;r++)this._contextMenu.find("li#categorize").find("li#categorize_"+e[r]).children().find("div:first-child").addClass("e-categorizeMenuSelected")}else e[0].length>0&&(l=e.length-1,this._contextMenu.find("li#categorize").find("li#categorize_"+e[l]).children().find("div:first-child").addClass("e-categorizeMenuSelected"))}else this._contextMenu.find("li#categorize")&&this._contextMenu.find("li#categorize").css("display","none")}else return a=this._contextMenu.data("ejMenu"),a.hide(),!1},_onMenuSelect:function(i){var o=i.events.ID.split("_"),c="",l=this._baseTarget,a,y,p,r,w,u,s,h;if(l.parents(".e-appointment").hasClass("e-appointment")||l.parents(".e-monthappointment").hasClass("e-monthappointment")?(s=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),a=t.DataManager(this._processed).executeLocal(s),c=a[0][this.model.appointmentSettings.recurrence]?this._getAppointmentByParentId(this._appId):a[0]):c={startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,resourceInfo:this._getResourceDetails(l)},this._trigger("menuItemClick",{events:i,targetInfo:c}))return!1;switch(o[0]){case"new":this._appointmentWindow(this._target);break;case"recurrence":this._appointmentWindow(this._target);this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0});this._repeat(i={isChecked:!0});break;case"open":this._appointmentWindow(this._target);break;case"today":this._navigateClick(this.currentDate(new Date));break;case"view":this.currentView(o[1].toLowerCase());this._renderCurrentView();break;case"timemode":this.model.timeMode=o[1]=="Hour12"?"12":"24";this._appointmentAddWindow.find(".startendtime").ejTimePicker({timeFormat:this.model.timeMode=="12"?this._pattern.t:"HH:mm"});this.currentView()==="month"||this._isCustomView()||(y=this.currentView()=="month"?1:0,p=this.timeCellTemplate.render({timerows:this._getStartEndTime(),cols1:[1,2],viewclass:y}),this.$TimeCellTD.children().remove(),this.$TimeCellTD.append(p),this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove(),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this._renderAppointmentAll());break;case"businesshours":this.model.highlightBusinessHours=this.model.highlightBusinessHours?!1:!0;this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells")&&this.element.find(".e-monthcells").removeClass("e-monthcellhighlight");break;case"gotodate":this._gotoWindow.ejDialog("open");break;case"delete":this._deleteAppoint();break;case"print":this._printAppointment();break;case"categorize":if(t.isNullOrUndefined(o[1]))this.element.find(".e-appointment,.e-alldayappointment,.e-monthappointment").removeClass("e-selectedAppointment");else if(this.model.categorizeSettings.enable){var e=parseInt(o[1]),f="",s=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),v=t.DataManager(this._processed).executeLocal(s);if(v[0][this.model.appointmentSettings.categorize])if(r=v[0][this.model.appointmentSettings.categorize].split(","),this.model.categorizeSettings.allowMultiple){if(r[0].length>0){for(u=0;u<r.length;u++)if(r[u]==e){w=!0;break}if(w==!0)for(u=0;u<r.length;u++)r[r.length-1]!=e?r[u]!=e&&(f=r.length-1!=u?f+r[u]+",":f+r[u]):r[u]!=e&&(f=r.length-2!=u?f+r[u]+",":f+r[u]);else f=v[0][this.model.appointmentSettings.categorize]+","+e}}else f=r[r.length-1]==e?"":e.toString();else f=e.toString();s=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId);h=new t.DataManager(this._processed).executeLocal(s)[0];h[this.model.appointmentSettings.categorize]=f;this.element.find("#Appointment_"+this._appId).remove();new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,h);this._renderSingleApp(h,h);break}}},_gotoOk:function(t){if(n(t.currentTarget).hasClass("e-gotoOk")){var i=this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker("option","value"),r=this._gotoWindow.find("#"+this._id+"show").ejDropDownList("option","itemValue");this.currentDate(new Date(i));this.currentView(r.toLowerCase());this._renderCurrentView()}this._gotoCancel()},_gotoCancel:function(){this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker({value:new Date});this._gotoWindow.find("#"+this._id+"show").ejDropDownList({value:"Day"});this._gotoWindow.ejDialog("close")},_renderGoto:function(){this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker({enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,cssClass:this.model.cssClass});this._gotoWindow.find("#"+this._id+"show").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:[{text:this._getLocalizedLabels("Day"),value:"day"},{text:this._getLocalizedLabels("Week"),value:"week"},{text:this._getLocalizedLabels("WorkWeek"),value:"workweek"},{text:this._getLocalizedLabels("Month"),value:"month"}],width:"100%",selectedItemIndex:0,cssClass:this.model.cssClass});this._gotoWindow.find(".e-gotobutton").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"60px",cssClass:this.model.cssClass})},_renderGotoWindow:function(){this._gotoWindow=t.buildTag("div.e-gotodialog#"+this._id+"gotoWindow");var i="<div><table width='100%' cellpadding='5'><tbody><tr><td>"+this._getLocalizedLabels("Date")+":<\/td><td><input id='"+this._id+"gotodate' type='text' value='' /><\/td><\/tr><tr><td>"+this._getLocalizedLabels("Showin")+":<\/td><td><input type='text' id='"+this._id+"show' /><\/td><\/tr><\/tbody><\/table>";i+="<div class='e-floatright'><table><tr><td><div><button id='"+this._id+"gotook' class='e-gotobutton e-gotoOk'>"+this._getLocalizedLabels("Ok")+"<\/button><\/div><\/td><td><div><button id='"+this._id+"gotocancel' class='e-gotobutton e-gotoCancel'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div><\/div>";this._on(this._gotoWindow,"click",".e-gotobutton",n.proxy(this._gotoOk,this));this._gotoWindow.append(i);this.element.append(this._gotoWindow);this._renderGoto();this._gotoWindow.ejDialog({width:300,cssClass:this.model.cssClass,showOnInit:!1,enableRTL:this.model.enableRTL,enableModal:!0,title:this._getLocalizedLabels("Gotodate"),content:"#"+this._id,enableResize:!1,allowKeyboardNavigation:!1,close:n.proxy(this._gotoCancel,this)});n("#"+this._id+"gotoWindow_wrapper").addClass("e-scheduledialog").find(".e-titlebar").addClass("e-dialogheader")},_highlightCurrentTime:function(i){var e,f,c,l,r;if(i){for(e=!1,f=0,r=0;r<this._dateRender.length;r++)Globalize.format(new Date(this._dateRender[r]),this._pattern.d)===Globalize.format(new Date,this._pattern.d)&&(e=!0,f=this.currentView()!=="month"&&!this._isCustomView()&&this.model.enableRTL==!0?this._dateRender.length-1-r:r);if(this.currentView()==="month"||this._isCustomView())if(e)if(this.model.orientation=="vertical")for(c=Math.ceil((f+1)/7),this.model.group||(this.res1=["0"]),r=0;r<this.res1.length;r++)l=r*7+(new Date(this._dateRender[f]).getDay()+1)+(c-1)*this.res1.length*7,n(this.element.find(".e-monthcells")[Math.floor(l)-1]).addClass("e-monthcurrenttime");else this._renderHorizontalCurrentTime();else this.model.orientation=="vertical"?this.element.find(".e-monthcells").removeClass("e-monthcurrenttime"):this.element.find(".e-workcells").removeClass("e-monthcurrenttime");else if(e){var u=this,s=this.currentView()==="week"?7:this.currentView()==="workweek"?5:this.currentView()=="customview"?this._dateRender.length:1,o=this.model.cellWidth?parseInt(this.model.cellWidth):this.element.find(".e-draggableworkarea")[0].offsetWidth/(s*this.res1.length);if((new Date).getHours()>=u.model.startHour&&(new Date).getHours()<=u.model.endHour)if(u.model.orientation=="vertical")for(r=0;r<this.res1.length;r++)this.element.find(".e-draggableworkarea").append('<div id="'+this._id+r+'_HighlightCurrentTimeline" class="e-highlightcurrenttimeline"><\/div>'),n("#"+this._id+r+"_HighlightCurrentTimeline").append('<div class="e-currenttime"><\/div>').append(t.buildTag("div.e-icon e-timeidicatorcircle e-lefttimeindicator")).append(t.buildTag("div.e-icon e-timeidicatorcircle e-righttimeindicator")),n("#"+this._id+r+"_HighlightCurrentTimeline").css("width",o+"px").css("left",(f+s*r)*o+"px"),n("#"+this._id+r+"_HighlightCurrentTimeline").find(".e-righttimeindicator").css("margin-left",o-3+"px");else this._renderHorizontalCurrentTime();function h(){var i=new Date,r,f,t;if(i.setMinutes(i.getMinutes()),i.getHours()>=u.model.startHour&&i.getHours()<=u.model.endHour)if(u.model.orientation=="vertical"){for(r=((i.getHours()-u.model.startHour)*60+i.getMinutes())*(u.element.find(".e-workcells").height()+1)/30,t=0;t<u.res1.length;t++)n("#"+u._id+t+"_HighlightCurrentTimeline").css("top",r-1);for(f=u.model.timeMode=="12"?Globalize.format(new Date,"hh:mm tt"):Globalize.format(new Date,"HH:mm"),t=0;t<u.res1.length;t++)n("#"+u._id+t+"_HighlightCurrentTimeline").find(".e-currenttime").html(f),u.model.timeMode=="12"&&n("#"+u._id+t+"_HighlightCurrentTimeline").find(".e-currenttime").addClass("e-timewidth")}else u._horizontalTimePosition(u,i)}h();this._intervalID=window.setInterval(h,6e4)}else clearInterval(this._intervalID),n(".e-highlightcurrenttimeline").remove()}},_filter:function(){for(var t=[],n=0;n<this._processed.length;n++)new Date(this._processed[n].EndTime)>=this.model.minDate&&new Date(this._processed[n].EndTime)<=this.model.maxDate&&t.push(this._processed[n]);return t},_getPreviousNextAppointment:function(){var i=this._dateRender,t=this._filter(),n;for(this._previousList=[],this._nextList=[],this.appointment,n=0;n<t.length;n++)new Date(t[n][this.model.appointmentSettings.startTime])<new Date(i[0])&&new Date(t[n][this.model.appointmentSettings.endTime])<new Date(i[0])?this._previousList.push(t[n]):new Date(t[n][this.model.appointmentSettings.startTime])>new Date(i[i.length-1])&&new Date(t[n][this.model.appointmentSettings.endTime])>new Date(i[i.length-1])&&this._nextList.push(t[n]);this.appointment={previous:this._previousList,next:this._nextList}},_nextPrevAppointment:function(n){var i;if(n&&!(this._browserInfo.name==="msie"&&this._browserInfo.version<9)){i=this.element.find("#"+this._id+"_scroller");this.height=i.height();this.width=i.width();var o=this.element.find(".e-vscroll").width(),s=this.element.find(".e-scrolltimecells").width(),r=this.height/2-75,u,f=t.buildTag("div.e-prev enable",this._getLocalizedLabels("PreviousAppointment"),{},{}),e=t.buildTag("div.e-next enable",this._getLocalizedLabels("NextAppointment"),{},{});u=this.model.orientation=="vertical"?this.currentView()!="month"&&!this._isCustomView()?-4:-10:-60;this.model.enableRTL?(e.css("top",r+40+"px").css("transform","rotate(90deg)").css("left",u-(this.currentView()!="month"&&!this._isCustomView()?39:51)+"px"),f.css("top",r+40+"px").css("transform","rotate(-90deg)").css("left",this.width-s-(this.currentView()!="month"&&!this._isCustomView()?31:41)+"px")):(f.css("top",r+40+"px").css("transform","rotate(90deg)").css("left",u+"px"),e.css("top",r+40+"px").css("transform","rotate(-90deg)").css("left",this.width-o-(this.model.orientation=="vertical"?35:90)+"px"));i.append(f).append(e)}},_nextPrev:function(t){n(t.currentTarget).hasClass("e-prev")?(this.appointment.previous.sort(function(n,t){return new Date(t.StartTime)-new Date(n.StartTime)}),this._navigateClick(this.currentDate(new Date(this.appointment.previous[0].StartTime)))):n(t.currentTarget).hasClass("e-next")&&(this.appointment.next.sort(function(n,t){return new Date(n.StartTime)-new Date(t.StartTime)}),this._navigateClick(this.currentDate(new Date(this.appointment.next[0].StartTime))))},_nextPrevButton:function(n){n.length!=0?this.element.find(".e-prev,.e-next").css("display","none"):(this._getPreviousNextAppointment(),this.element.find(".e-prev,.e-next").css("display","block"),this.appointment.previous.length==0?this.element.find(".e-prev").removeClass("enable").css("opacity","0.4"):this.element.find(".e-prev").addClass("enable").css("opacity","1"),this.appointment.next.length==0?this.element.find(".e-next").removeClass("enable").css("opacity","0.4"):this.element.find(".e-next").addClass("enable").css("opacity","1"))},_navigateView:function(i){var e,l=this.currentView(),r=n(i.target),h,u,o;if(this.model.orientation=="vertical"){if(this.currentView()==="month"||this._isCustomView()){if(r.hasClass("e-monthheader")){if(this.model.views.indexOf("Day")==-1)return!1;var f=r.parent().index(),s=f>6?f%7:f,u=this._getRenderDates()[r.parent().parent().index()*7+s];if(this.model.minDate<=u&&this.model.maxDate>=u)this.currentDate(u);else return!1;e="day"}else if(r.hasClass("e-timecells")||r.hasClass("e-timecelldivs")){if(h=r.hasClass("e-timecells")?r:r.parent(),this.model.views.indexOf("Week")==-1)return!1;if(u=this._getRenderDates()[h.parent().index()*7],this.model.minDate<=u&&this.model.maxDate>=u)this.currentDate(u);else return!1;e="week"}}else if(this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7){if(o=r.hasClass("e-headercells")?r:r.parent().hasClass("e-headercells")?r.parent():r.parent().parent(),this.model.views.indexOf("Day")==-1||!o.hasClass("e-headercells"))return!1;var f=o.index(),c=this.currentView()==="workweek"?5:this.currentView()==="customview"?this._dateRender.length:7,s=f>c-1?f%c:f,u=this._getRenderDates()[s];if(this.model.minDate<=u&&this.model.maxDate>=u)this.currentDate(u);else return!1;e="day"}this._navView=!0;this._viewChange(i,l,e);this._businessHourScroller()}else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._horizontalViewNavigation(i)},_appOverflowClick:function(t){if(this.model.views.indexOf("Day")!==-1){var i=n(t.target)[0].id.toString().split("_");this.currentDate(new Date(i[3],i[1]-1,i[2]));this._navView=!0;this._viewChange(t,this.currentView(),"day")}else return!1},_viewCalendar:function(){var i=this.element.find("#"+this._id+"_navigator").data("ejDatePicker"),t;i&&(i.show(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate()),minDate:this.model.minDate,maxDate:this.model.maxDate}),t=this.element.position(),this.model.enableRTL?n("div.e-datepicker").css("top",t.top+47+"px").css("left",t.left+this.element.width()-280+"px"):n("div.e-datepicker").css("top",t.top+47+"px").css("left",t.left+55+"px"));this.element.find(".e-workcells").removeClass("e-selectedCell");this.element.find(".e-workcells").removeClass("e-mousehover");this.element.find(".e-appointment,.e-alldayappointment,.e-monthappointment").removeClass("e-selectedAppointment")},_viewChange:function(t,i,r){var f=!0,u;if((u={currentview:this.currentView(),Date:new Date(this.currentDate()),target:t,requestType:"viewNavigate"},this._trigger("actionBegin",u))||(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),i===r&&(i||r)||(this._navView?this.currentView(r):(f=this.currentView()==t.currentTarget.className.split("e-")[2].split(" ")[0]?!1:!0,this.currentView(n(t.currentTarget).hasClass("e-activeview")?this.currentView():t.currentTarget.className.split("e-")[2].split(" ")[0])),f&&this._renderCurrentView()),u={prevView:i,currentView:this.currentView(),Date:new Date(this.currentDate()),target:t,type:"Scheduleview"},this._trigger("navigation",u)))return!1;this._trigger("actionComplete",{data:u,requestType:"viewNavigate"})},_renderCurrentView:function(){this.element.find(".e-commonviewbutton").blur();this.element.find(".e-commonviewbutton").removeClass("e-activeview");this.model.orientation=="vertical"&&this.element.find(".e-headerdaydisplay,.e-datedisplay,.e-headrealldaytable").children().remove();this.wTR.children().remove();this.aTR.children().remove();this._calculateCustomDays();this._getRenderDates();this.element.find(".e-"+this.currentView()).addClass("e-activeview").attr("tabIndex",0).focus();this._renderHeaderAllDayTemplate();this._renderContentAreaTemplate();this._renderScroller();this.model.orientation=="vertical"?(this._headerbarWidth(),this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay")),this.element.find(".e-ampmdisplay").height(this.element.find(".e-workcells").height())):this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._moveScroller();this._renderHeaderDays();t.isNullOrUndefined(this.dataSource())||(this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll());this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");this._highlightCurrentTime(this.model.showCurrentTimeIndicator);this._validateMinMaxDate();this._navView=!1;this._dateRender.length>60||parseInt(this.model.cellHeight)<35&&this.model.cellHeight!=="20px"?this.element.find("td.e-timecells .e-timecelldivs").addClass("e-timedivcells"):""},_renderHeaderDays:function(){var f,r,i,e,u,o,n;for(this.dateRender=[],f=this._getRenderDates(),this.res1=t.isNullOrUndefined(this.model.group)?[0]:this.res1,n=0;n<this.res1.length;n++)for(r=0;r<f.length;r++)this.dateRender.push(new Date(f[r]));if(i=Globalize.culture(this.model.locale),e=this._getCurrentDateHeaderValue(),this.element.find("div.e-datedisplay")[0].innerHTML=e,this.model.orientation=="vertical")if(this.currentView()==="month"||this._isCustomView())this._renderMonthTimeCells();else{for(n=0;n<this.dateRender.length;n++)u=this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?i.calendar.days.names[new Date(this.dateRender[n]).getDay()]:i.calendar.days.names[new Date(this.dateRender[n]).getDay()].slice(0,3):i.calendar.days.names[new Date(this.dateRender[n]).getDay()].slice(0,3),o=this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?u+" "+Globalize.format(new Date(this.dateRender[n]),"dd MMMM yyyy"):u+" "+Globalize.format(new Date(this.dateRender[n]),"dd MMM yy"):u+" "+new Date(this.dateRender[n]).getDate(),this.element.find(".e-headerdaydisplay")[n].innerHTML=o;this.element.find(".e-alldaycells").css("height","27px");this.element.find(".e-emptyalldaytd").css("height","27px");this.element.find(".e-headercells").addClass("e-dateheaderselect")}else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._renderHorizontalHeaderDays(i)},_renderMonthTimeCells:function(){for(var r,o=0,u=this._dateRender,e=0,f=t.isNullOrUndefined(this.model.group)?7:this.res1.length*7,i=0;i<u.length;i++){for(r=e;r<f;r=r+7)n(this.element.find("div.e-monthheader"))[r].innerHTML=Globalize.format(new Date(u[i]),"dd").toString();e++;(i+1)%7==0&&(e=f,f=f+(t.isNullOrUndefined(this.model.group)?1:this.res1.length)*7,start=Globalize.format(new Date(u[i-6]),"MMM dd"),end=Globalize.format(new Date(u[i]),"MMM dd"),n(this.element.find(".e-timecelldivs"))[o].innerHTML=start+" - "+end,o++);this.currentView()!=="customview"&&(new Date(u[i]).getMonth()!==new Date(this.currentDate()).getMonth()?n(this.element.find("div.e-monthheader")[i]).addClass("e-monthdateshighlight"):n(this.element.find("div.e-monthheader")[i]).removeClass("e-monthdateshighlight"))}this.element.find(".e-timecells").addClass("e-dateheaderselect").height(this.element.find(".e-monthcells").height());r!=6&&this.element.find(".e-timecells").addClass("e-timecellpadding")},_navigateClick:function(i){var f,s=new Date(this.currentDate()),r,o,e,u;if(f={currentDate:new Date(this.currentDate()),target:i,requestType:"dateNavigate"},this._trigger("actionBegin",f))return!1;if(i!=null&&!this._setCurrentDate){if(n(i.currentTarget).hasClass("e-disable"))return!1;r=new Date(this.currentDate());o=this.currentView()==="day"?1:this.currentView()==="customview"?this._dateRender.length:7;n(i.currentTarget).hasClass("e-navigateprevious")?(this._isCustomView()?(e=new Date(this._dateRender[0]),u=new Date(this._dateRender[0]),u.setTime(e.getTime()-this._dateRender.length*864e5),this.currentDate(new Date(u))):this.currentDate(this.currentView()==="month"?new Date(r.setMonth(new Date(this.currentDate()).getMonth()-1)):new Date(r.setDate(new Date(this.currentDate()).getDate()-o))),this.element.find(".e-navigateprevious").attr("tabIndex",0).focus()):n(i.currentTarget).hasClass("e-navigatenext")&&(this._isCustomView()?(e=new Date(this._dateRender[0]),u=new Date(this._dateRender[0]),u.setTime(e.getTime()+this._dateRender.length*864e5),this.currentDate(new Date(u))):this.currentDate(this.currentView()==="month"?new Date(r.setMonth(new Date(this.currentDate()).getMonth()+1)):new Date(r.setDate(new Date(this.currentDate()).getDate()+o))),this.element.find(".e-navigatenext").attr("tabIndex",0).focus())}if(this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell"),this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),this.element.find(".e-appsoverflow").remove(),this.element.find(".e-monthcells").removeClass("e-monthcurrenttime"),this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove(),this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),this.currentView()==="month"||this._isCustomView()?(this._navigate=!0,this._renderCurrentView()):(this._renderHeaderDays(),t.isNullOrUndefined(this.dataSource())||(this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll()),this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator)),i!=null&&(n(i.currentTarget).hasClass("e-navigateprevious")||n(i.currentTarget).hasClass("e-navigatenext"))&&(f={prevDate:s,currentDate:r,target:i,type:"navigatedate"}),this._trigger("navigation",f))return!1;this._validateMinMaxDate();this._setCurrentDate=!1;this._trigger("actionComplete",{data:f,requestType:"dateNavigate"})},_validateMinMaxDate:function(){this.element.find(".e-navigateprevious").removeClass("e-disable");this.element.find(".e-navigatenext").removeClass("e-disable");var n=new Date(this.currentDate()),r=this.model.orientation=="horizontal"&&this.model.currentView=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,t=new Date(r[0]),i=new Date(r[r.length-1]);this.currentView()=="workweek"&&(t=t.setDate(t.getDate()-1),i=i.setDate(i.getDate()+1));n=t;n<=this.model.minDate?this.element.find(".e-navigateprevious").addClass("e-disable"):this.element.find(".e-navigateprevious").removeClass("e-disable");n=i;n>=this.model.maxDate?this.element.find(".e-navigatenext").addClass("e-disable"):this.element.find(".e-navigatenext").removeClass("e-disable")},_onScheduleResize:function(){var i=this.element.find(".e-scroller").data("ejScroller"),r=this.currentView()=="workweek"?5:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,f=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1.length*r:r,u=parseInt(this.model.cellWidth)*f;i.model.width=this.model.orientation==="vertical"&&!this.model.enableRTL?this.element.outerWidth()-(this.element.find(".e-draggableworkarea").offset().left-this.element.offset().left):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)&&!this.model.enableRTL?this.element.width()-this.element.find(".e-resourceheadertable").width():this.model.enableRTL?this.element.width()-this.element.find(".e-scrolltimecells").parent().width():this.element.width();i.model.height=this.scHeight-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top);i.refresh();this.model.orientation=="vertical"?(this.model.cellWidth&&this.element.find(".e-draggableworkarea").width(this.element.width()>u+this.element.find(".e-scrolltimecells").parent().width()+18?u:i.model.width-18),this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width()),this.element.find(".e-datecommondiv").parent().width(this.element.width()),this.element.find(".e-headrealldaytable").css("left",-this.element.find(".e-draggableworkarea").scrollLeft()+"px")):n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-i.model.scrollLeft+"px");this.currentView()=="month"||this._isCustomView()||this.model.orientation!="vertical"?this._renderCurrentView():(this.element.find("div.e-alldayappointment").remove(),this._renderAllDayAppointments(),this._unWireResizeEvents(),this._wireResizeEvents(),this._dragdropAppointments());this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove();this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px");this._highlightCurrentTime(this.model.showCurrentTimeIndicator)},_renderTemplates:function(){this.model.orientation=="vertical"&&(this.workcellTemp=n.templates(this._createTemplate(c(),"_WorkCells")),this.monthcellTemp=n.templates(this._createTemplate(u(),"_MonthCells")),this.timeCellTemplate=n.templates(this._createTemplate(l(),"_TimeCells")),this.headTemplate=n.templates(this._createTemplate(o(),"_HeaderDate")),this.alldayTemp=n.templates(this._createTemplate(h(),"_AlldayCells")),this.leftIndent=n.templates(this._createTemplate(s(),"_LeftIndentCells")));t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._renderResourcesTemplate();this.appTemplate=n.templates(this._createTemplate(f(),"_Appointment"));t.scheduleFeatures.horizontal&&this.model.orientation==="horizontal"&&this._renderHorizontalTemplates();!t.isNullOrUndefined(this.model.categorizeSettings)&&this.model.categorizeSettings.enable&&(this._renderCategorizeTemplate(),this._categorizeMultipleTemplate=n.templates(this._createTemplate(e(),"_CategorizeMultiple")))},_setNewStartEndHours:function(){this.currentView()==="month"||this._isCustomView()||(this.wTR.children().remove(),this._renderContentAreaTemplate(),this._renderScroller(),this.element.find(".e-ampmdisplay").height(this.element.find(".e-workcells").height()),this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").addClass("e-businesshighlightworkcells"),this.model.showCurrentTimeIndicator&&n(".e-highlightcurrenttimeline").remove(),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this._renderAppointmentAll())},_renderInitSchedule:function(){this.scrollWidth=this.model.width;this.scrollHeight=this.model.height;this.model.width=this.model.width?this.element.width(this.model.width).width():this.element.width();this.model.height=this.model.height?this.element.height(this.model.height).height():this.element.height();this.scWidth=this._scWidth?parseInt(this._scWidth):parseInt(this.model.width);this.scHeight=this._scHeight?parseInt(this._scHeight):parseInt(this.model.height);this.currentDate()<this.model.minDate&&this.currentDate(this.model.minDate);this.currentDate()>this.model.maxDate&&this.currentDate(this.model.maxDate);this.element.addClass("e-scheduleouter").height(this.scrollHeight).width(this.scrollWidth).attr("role","presentation");n(this.element).attr("tabIndex",1);var i=t.buildTag("div","",{},{height:this.scHeight,width:this.scWidth}),u=t.buildTag("table.e-table","",{},{cellpadding:"0px",cellspacing:"0px"}).addClass("e-scheduleoutertable"),f=t.buildTag("tbody"),r=t.buildTag("tr.e-scheduleheader");this.aTR=t.buildTag("tr");this.model.views.toString().toLowerCase().split(",").indexOf(this.currentView())==-1&&this.currentView(this.model.views[0].toLowerCase());this._calculateCustomDays();this._getRenderDates();this.wTR=t.buildTag("tr.e-contentarearow");this._renderTemplates();this._renderHeaderBar(r);this._renderHeaderAllDayTemplate();this._renderContentAreaTemplate();i.append(u.append(f.append(r).append(this.aTR).append(this.wTR)));this.element.append(i);this.element.find(".e-"+this.currentView()).addClass("e-activeview");this.element.find("#"+this._id+"_navigator").ejDatePicker({enableRTL:this.model.enableRTL,buttonText:this._getLocalizedLabels("Today"),select:n.proxy(this._onselect,this),locale:this.model.locale,cssClass:this.model.cssClass});this.element.find("span.e-datewidget").css("display","none");this.model.orientation=="vertical"&&(this._headerbarWidth(),(this.currentView()==="month"||this._isCustomView())&&this._renderMonthTimeCells());this.element.find(".e-headercells").addClass("e-dateheaderselect");this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");this._renderAppointmentWindow();this._renderRecurEditWindow();this.model.showQuickWindow&&(this._renderQuickAppWindow()||this._renderQuickAppDetailsView());this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay"));this._renderScroller();this.model.currentView=="month"||this._isCustomView()?this.element.find(".e-timecells").height(n(this.element.find(".e-monthcells")).height()):this.element.find(".e-ampmdisplay").height(n(this.element.find(".e-workcells")).height());this._highlightCurrentTime(this.model.showCurrentTimeIndicator);this._validateMinMaxDate();this._showContextMenu(this.model.contextMenuSettings.enable);this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._moveScroller()},_calculateCustomDays:function(){var r,u;if(!t.isNullOrUndefined(this.model.renderDates)&&this.currentView()=="customview"&&!this._navigate&&(r=n.type(this.model.renderDates.start)!="date"?Globalize.parseDate(this.model.renderDates.start,this._datepattern()):new Date(this.model.renderDates.start),u=n.type(this.model.renderDates.end)!="date"?Globalize.parseDate(this.model.renderDates.end,this._datepattern()):new Date(this.model.renderDates.end),this._renderStart=new Date(r.getFullYear(),r.getMonth(),r.getDate()),this._renderEnd=new Date(u.getFullYear(),u.getMonth(),u.getDate()),this.currentDate(new Date(this._renderStart)),this._renderDays=Math.floor((this._renderEnd-this._renderStart)/864e5)+1,this._renderDays>7)){var e=this.model.orientation=="vertical"?new Date(this._firstweekdate(this._renderStart)):new Date(this._renderStart),i=new Date(this._renderEnd),f=i.getDay();f!=6&&i.setDate(new Date(this._renderEnd).getDate()+(6-f));i=this.model.orientation=="vertical"?i:new Date(this._renderEnd);this._numDays=Math.floor((i-e)/864e5)+1}},_isCustomView:function(){if(this.currentView()=="customview"&&this._renderDays>7)return!0},_headerbarWidth:function(){var n=this.currentView()=="workweek"?5:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,i=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1.length*n:n;this.element.find(".e-headrealldaytable").width(this.model.cellWidth?parseInt(this.model.cellWidth)*i+i:"100%")},_renderScroller:function(){var r=n("div#"+this._id+"_scroller"),u=this.scHeight-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),i=this,e=this.currentView()==="month"?0:4,f=this.model.orientation==="vertical"&&!this.model.enableRTL?this.element.outerWidth()-(this.element.find(".e-draggableworkarea").offset().left-this.element.offset().left):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)&&!this.model.enableRTL?this.element.width()-this.element.find(".e-resourceheadertable").width():this.model.enableRTL?this.element.width()-this.element.find(".e-scrolltimecells").parent().width():this.element.width();r.ejScroller({enableRTL:this.model.enableRTL,height:u,width:f,cssClass:this.model.cssClass,thumbStart:function(t){var i=n(t.originalEvent.target);if(i.hasClass("e-workcells")||i.parents(".e-appointment").hasClass("e-appointment")||i.parents(".e-monthappointment").hasClass("e-monthappointment")||i.hasClass("e-categorybar"))return!1},scroll:function(r){var u,f;i.model.orientation==="vertical"?i.element.find(".e-scrolltimecells").css("top",-r.scrollTop+"px"):i.currentView()!=="month"&&!i._isCustomView()?n(i.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-r.scrollLeft+"px"):i.element.find(".e-headerdays").css("left",-r.scrollLeft+"px");i.element.find(".e-vhandle").length==1&&i.element.find(".e-horires").css("top",-r.scrollTop+"px");i.model.orientation=="vertical"?(i.element.find(".e-headrealldaytable").css("left",-r.scrollLeft+"px"),i.model.timeMode!=="12"||i.currentView()==="month"||i._isCustomView()||(u=r.scrollTop/(i.element.find(".e-workcells").height()*2),u=Math.round(u)<u?Math.round(u)+1:Math.round(u),f=Globalize.culture(i.model.locale).calendar,f.AM&&f.PM&&i.element.find(".e-ampmstyle").each(function(t,i){t==u?parseInt(n(i)[0].id)<12?n(i).text(f.AM[0]):n(i).text(f.PM[0]):(n(i).text()==f.AM[0]&&t>0||n(i).text()==f.PM[0]&&parseInt(n(i)[0].id)>12)&&n(i).text("00")}))):t.scheduleFeatures.horizontal&&i.model.orientation=="horizontal"&&i._horizontalScroll(r,i)}});this._nextPrevAppointment(this.model.enableAppointmentNavigation);this._renderHoriVerticalScroll()},_renderHoriVerticalScroll:function(){var i=n("div#"+this._id+"_scroller"),s=this.currentView()==="month"?0:4,r=this.model.orientation==="vertical"&&!this.model.enableRTL?this.element.outerWidth()-(this.element.find(".e-draggableworkarea").offset().left-this.element.offset().left):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)&&!this.model.enableRTL?this.element.width()-this.element.find(".e-resourceheadertable").width():this.model.enableRTL?this.element.width()-this.element.find(".e-scrolltimecells").parent().width():this.element.width(),f=this.scHeight-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),e=this.currentView()=="workweek"?5:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,h=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1.length*e:e;if(this.model.orientation=="vertical")if(i.ejScroller("isVScroll")?this.element.find(".e-emptytd,.e-emptyalldaytd").show():this.element.find(".e-emptytd,.e-emptyalldaytd").hide(),this.model.cellWidth){this.currentView()=="day"&&this.element.find(".e-headerdaydisplay").css("width",this.model.cellWidth);var c=this._dateRender.length/7,u=parseInt(this.model.cellWidth)*h,l=parseInt(this.model.cellHeight)*c,a=this.scWidth-this.element.find(".e-scrolltimecells").width()+s,o=f;this.currentView()=="month"||this._isCustomView()?(this.element.find(".e-draggableworkarea").width(this.element.width()>u+this.element.find(".e-scrolltimecells").width()+18?u:i.ejScroller("isVScroll")?r-18:r),this.element.find(".e-draggableworkarea").height(this.model.cellHeight!="20px"?l:i.ejScroller("isHScroll")?o-18:o),this.element.find(".e-emptytd").show()):this.element.find(".e-draggableworkarea").width(this.element.width()>u+this.element.find(".e-scrolltimecells").width()+18?u:r-18);this.model.cellWidth&&this.element.find(".e-datecommondiv").parent().width(this.element.width());this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width())}else this.element.find(".e-draggableworkarea").height(f),i.ejScroller("isVScroll")?this.element.find(".e-draggableworkarea").width(r-18):(this.currentView()=="month"||this._isCustomView())&&this.element.find(".e-draggableworkarea").width(r),this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width()),this.element.find(".e-scrolltimecells").height(this.element.find(".e-draggableworkarea").height());else i.ejScroller("isHScroll")?"":this.element.find(".e-draggableworkarea").css("height","100%")&&this.element.find(".e-resfootertr").css("height","0px"),i.ejScroller("isVScroll")?"":this.element.find(".e-draggableworkarea").css("height",f-18),this.currentView()!="month"||i.ejScroller("isHScroll")||i.ejScroller("isVScroll")||this.element.find(".e-draggableworkarea").css("height","100%"),this.element.find(".e-horizontresdiv").height(this.element.find(".e-draggableworkarea").height())},_highlightBusinessHours:function(){var o,r,u,f,i;if(this.currentView()==="month"||this._isCustomView())if(this.model.orientation=="vertical")for(f=this.dateRender,u=this.element.find(".e-monthcells"),u.removeClass("e-monthcellhighlight"),i=0;i<f.length;i++)new Date(f[i]).getDay()!==0&&new Date(f[i]).getDay()!==6&&n(u[i]).addClass("e-monthcellhighlight");else this._horizontalBusinessHighlight(null,null,null,null,null);else{this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");var s=this.dateRender,u=this.element.find(".e-workcells"),h=this.model.businessStartHour>=this.model.startHour?this.model.businessStartHour-this.model.startHour:0,c=this.model.businessEndHour<=this.model.endHour?this.model.businessEndHour-this.model.startHour:this.model.endHour-this.model.startHour,e=2;if(this.res1=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1:[0],o=this.currentView()==="week"?7*this.res1.length:this.currentView()==="workweek"?5*this.res1.length:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length*this.res1.length:1*this.res1.length,this.model.orientation=="vertical"){for(i=h*e;i<c*e;i++)for(r=0;r<o;r++)new Date(s[r]).getDay()!==0&&new Date(s[r]).getDay()!==6&&n(u[i*o+r]).addClass("e-businesshighlightworkcells");this._businessHourScroller()}else this._horizontalBusinessHighlight(this._dateRender,h,c,e,u)}},_onselect:function(n){var u=this,t,i,r;if((t={currentDate:new Date(this.currentDate()),target:n,requestType:"dateNavigate"},this._trigger("actionBegin",t))||(i=new Date(this.currentDate()),r=Globalize.parseDate(n.value,this._pattern.d),this.currentDate(r),t={prevDate:i,currentDate:this.currentDate(),target:n},this._trigger("navigation",t)))return!1;u._navigateClick(n);this._trigger("actionComplete",{data:t,requestType:"dateNavigate"})},_renderHeaderBar:function(n){var u=this.model.orientation=="vertical"?1:2,i,r;this.hTD=t.buildTag("td","",{},{colspan:u});i=t.buildTag("div.e-datecommondiv").append(t.buildTag("div.e-icon e-navigateprevious","",{},{title:this._getLocalizedLabels("Previous")})).append(t.buildTag("div","",{},{"aria-live":"assertive",tabindex:0}).html(this._getCurrentDateHeaderValue()).addClass("e-datedisplay")).append(t.buildTag("input#"+this._id+"_navigator").css("display","none").addClass("dateCalendar")).append(t.buildTag("div.e-icon e-navigatenext","",{},{title:this._getLocalizedLabels("Next")}));r=t.buildTag("div.e-viewsdiv");n.append(this.hTD.append(t.buildTag("div").css("width","100%").append(i).append(r.append(this._renderViewNavigation(this.model.views)))))},_renderViewNavigation:function(n){for(var u=t.buildTag("table.e-table e-viewstable","",{},{cellspacing:"0px",cellpadding:"0px"}),o=t.buildTag("tbody"),f=t.buildTag("tr"),r=n,e,i=0;i<r.length;i++)e=r.length==1?"e-"+r[i].toLowerCase()+" e-singleview":i==0?"e-"+r[i].toLowerCase()+" e-firstview":i==r.length-1?"e-"+r[i].toLowerCase()+" e-lastview":"e-"+r[i].toLowerCase(),f.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels(r[i]),{},{}).addClass("e-commonviewbutton").addClass(e)));return u.append(o.append(f)),u},_emptyCell:function(){var r=n("div#"+this._id+"_scroller"),i;return this.currentView()=="month"||this._isCustomView()?(this.currentView()=="month"||this._isCustomView())&&r.ejScroller("isVScroll")&&(i="<td class='e-emptytd' style='height:29px'><\/td>"):(i="<table cellspacing='0' cellpadding='0'><tbody>",t.isNullOrUndefined(this.model.resources)||(i+="<tr><td class='e-emptytd e-headerresourcecells' style='height: 27px'><\/td><\/tr>"),!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1&&(i+="<tr><td class='e-emptytd e-headerresourcecells' style='height: 27px'><\/td><\/tr>"),i+="<tr><td class='e-emptytd' style='height:29px'><\/td><\/tr><tr><td class='e-emptyalldaytd' style='height:27px'><\/td><\/tr><\/tbody><\/table>"),i},_recurrenceWindow:function(){var v=["Daily","Weekly","Monthly","Yearly","EveryWeekDay"],y=Globalize.culture(this.model.locale),i=this._dayShortNames,r=this._dayFullNames,u=this._monthNames,f=["First","Second","Third","Fourth","Last"],n="<div class='e-recurwindow e-windowmargin' style='display:none'><form id='"+this._id+"_RecurForm'><table class='e-table' width='100%' cellpadding='7'><tbody>",e,t,o,s,h,c,l,a;for(n+="<tr><td width='16%' class='e-textlabel'>"+this._getLocalizedLabels("Recurrence")+":<\/td><td><input class='recurtype' id='recurtype' type='text' name='RecurrenceType' value='"+this._getLocalizedLabels(v[0])+"' /><div id='recurtypelist'><ul>",e=0;e<v.length;e++)n+="<li>"+this._getLocalizedLabels(v[e])+"<\/li>";for(n+="<\/ul><\/div><\/td><\/tr>",n+="<tr id='"+this._id+"repeatEvery'><td class='e-textlabel'>"+this._getLocalizedLabels("Every")+":<\/td><td><table><tr><td><div class='e-floatleft'><input id='recurevery' class='e-recurevery' type='text' /><\/div><\/td><td><div id='"+this._id+"recurtypes' class='e-appcheckbox'>"+this._getLocalizedLabels("RecurrenceDay")+"<\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"weeklyrecur' style='display:none'><td id='recurweek' class='e-textlabel'><div>"+this._getLocalizedLabels("RepeatOn")+":<\/div><\/td><td id='recurweekcount'><table class='e-table' cellpadding='3'><tr>",t=0;t<i.length;t++)n+="<td><div class='e-weekday e-_"+i[t]+"'><input id='"+i[t]+"' class='weekdays e-weekly"+this._dayNames[t]+"'name='weekdays' type='checkbox'/><label class='e-textmargin' for='"+i[t]+"'>"+i[t]+"<\/label><\/div><\/td>";for(n+="<\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"monthlyrecur' style='display:none'><td id='recurmonthtext' class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("RepeatBy")+":<\/div><\/td><td id='recurmonthcount'><table class='e-table' cellpadding='3'><tr><td><div><input id='"+this._id+"monthday' class='e-monthdaytype' name='monthday' type='radio'/><label class='e-textmargin' for='"+this._id+"monthday'>"+this._getLocalizedLabels("Day")+"<\/label><\/div><\/td><td><div><input id='monthdate' class='e-monthdate' type='text'/><\/div><\/td><\/tr><tr><td><div><input id='"+this._id+"monthon' class='e-monthposition' name='monthday' type='radio'/><label class='e-textmargin' for='"+this._id+"monthon'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div><input id='monthsrt' class='monthsrt' type='text' name='monthsrt' value=''/><div id='monthsrtlist'><ul>",o=0;o<f.length;o++)n+="<li>"+this._getLocalizedLabels(f[o])+"<\/li>";for(n+="<\/div><\/div><\/td>",n+="<td><div class='e-appcheckbox'><input id='monthsrtday' class='e-monthsrtday' type='text' name='monthsrtday' value=''/><div id='monthsrtdaylist'><ul>",s=0;s<r.length;s++)n+="<li>"+r[s]+"<\/li>";for(n+="<\/div><\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"yearlyrecur' style='display:none'><td id='recuryeartext' class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("RepeatBy")+":<\/div><\/td><td id='recuryearcount' ><table class='e-table' cellpadding='3'><tr><td><div><input id='"+this._id+"yearday' class='e-yearrecurday' name='yearday' type='radio'/><label class='e-textmargin' for='"+this._id+"yearday'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div class='e-controlalign'><input id='yearmonth' class='yearmonth' type='text' name='yearmonth' value=''/><\/div><\/td><div id='yearmonthlist'><ul>",h=0;h<u.length-1;h++)n+="<li>"+u[h]+"<\/li>";for(n+="<\/ul><\/div><td><input id='yeardate' class='yeardate' text='text'/><\/td><\/tr><tr><td><div><input id='"+this._id+"yearother' class='e-yearrecurposi' name='yearday' type='radio'/><label class='e-textmargin' for='"+this._id+"yearother'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div><input id='yearsrt' class='yearsrt' type='text' name='yearsrt' value=''/><div id='yearsrtlist'><ul>",c=0;c<f.length;c++)n+="<li>"+this._getLocalizedLabels(f[c])+"<\/li>";for(n+="<\/ul><\/div><\/div><\/td><td><div class='e-controlalign'><input id='yearsrtday' class='yearsrtday' type='text' name='yearsrtday' value=''/><div id='yearsrtdaylist'><ul>",l=0;l<r.length;l++)n+="<li>"+r[l]+"<\/li>";for(n+="<\/ul><\/div><\/div><\/td><td><div><span>"+this._getLocalizedLabels("OfEvery").split(" ")[0]+"<\/span><\/div><\/td><td><div><input id='yearsrtmonth' class='yearsrtmonth' type='text' name='yearsrtmonth' value=''/><div id='yearsrtmonthlist'><ul>",a=0;a<u.length-1;a++)n+="<li>"+u[a]+"<\/li>";return n+="<\/ul><\/div><\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr><td class='e-textlabel'>"+this._getLocalizedLabels("StartsOn")+":<\/td><td><input id='recurstartdate' class='recurstartdate' type='text' name='RecurStartDate' value=''/><\/td><\/tr>",n+="<tr><td class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("Ends")+":<\/div><\/td><td><table class='e-table' cellpadding='3'><tr><td><div><input id='repeatendnever' class='recurends e-recurnoend' type='radio' name='repeatend' value='Never'/><label class='e-textmargin' for='repeatendnever'>"+this._getLocalizedLabels("Never")+"<\/label><\/div><\/td><\/tr><tr><td><div><input id='"+this._id+"repeatendafter' class='recurends e-recurafter' type='radio' name='repeatend'/><label class='e-textmargin' for='"+this._id+"repeatendafter'>"+this._getLocalizedLabels("After")+"<\/label><\/div><\/td><td><div><input id='dailyoccurance' class='e-recurcount' type='text'/><\/div><\/td><td><span style='margin-left: -80px;'>"+this._getLocalizedLabels("Occurence")+"<\/span><\/td><\/tr><td><div><input id='"+this._id+"repeatendon' class='recurends e-recuruntil' type='radio' name='repeatend'/><label class='e-textmargin' for='"+this._id+"repeatendon'>"+this._getLocalizedLabels("On")+"<\/label><\/div><\/td><td><input id='daily' class='e-until' type='text' name='daily' value=''/><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr style='display:none'><td><span class='e-textlabel'>"+this._getLocalizedLabels("Summary")+":<\/span><\/td><td><span class=e-recurRule><\/span><\/td><\/tr><\/tbody><\/table><\/form>",n+("<div class='e-floatright'><table class='e-table' cellpadding='5'><tr><td><div class='e-btnmargin e-floatleft'><button id='donerecur' class='recurbutton'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div class='e-btnmargin e-floatleft'><button id='cancelrecur' class='e-cancelrecur recurbutton'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/tabled><\/div><\/div>")},_renderAppointmentWindow:function(){this._appointmentAddWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppointmentAddEditWindow");var i="<div class='e-appwindow e-windowmargin'><form id='"+this._id+"_AddEditForm'><table class='e-table' width='100%' cellpadding='7'><tbody>";i+="<tr><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("AppointmentSubject")+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"subject' tabIndex='0' class='subject e-inputtext' name='"+this.model.appointmentSettings.subject+"' type='text' /><input id='id' class='id' type='text' name='"+this.model.appointmentSettings.id+"' value='' style='display: none'/><\/td><\/tr>";i+="<tr><td class='e-textlabel'>"+this._getLocalizedLabels("StartTime")+":<\/td><td width='25%'><input id='"+this._id+"startdate' class='startenddate' type='text' name='StartDate' value='' /><\/td><td width=22%'><input type='text' id='"+this._id+"starttime' class='startendtime' name='StartTime'/><\/td><td width='28%'><input id='startutc' class='startutc' type='text' value=''/><div id='Timezoneliststr'><\/div><\/td><\/tr>";i+="<tr><td class='e-textlabel'>"+this._getLocalizedLabels("EndTime")+":<\/td><td><input id='"+this._id+"enddate' class='startenddate' type='text' name='EndDate' value='' /><\/td><td><input type=''text' id='"+this._id+"endtime' class='startendtime' name='EndTime'/><\/td><td><input id='endutc' class='endutc' type='text' value=''/><div id='Timezonelistend'><\/div><\/td><\/tr>";i+="<tr><td colspan='4'><table class='e-table' cellpadding='3'><tr><td><div class='e-allday e-checkboxmargin'><input id='"+this._id+"allday' tabIndex='0' class='allday' type='checkbox' name='"+this.model.appointmentSettings.allDay+"'/><\/div><\/td><td><div class='e-alldaytext'><label for='"+this._id+"allday'>"+this._getLocalizedLabels("AllDay")+"<\/label><\/div><\/td><td><div class='e-checkboxmargin e-recurrence'><input id='"+this._id+"recurrence' tabIndex='0' class='recurrence' type='checkbox' name='"+this.model.appointmentSettings.recurrence+"' value='recurrence'/><\/div><\/td><td><label class='e-repeatlbl' for='"+this._id+"recurrence'>"+this._getLocalizedLabels("Recurrence")+"<\/label><\/td><\/tr><\/table><\/td><\/tr>";i+="<tr id='"+this._id+"summary' style='display:none'><td class='e-textlabel'><label>"+this._getLocalizedLabels("Summary")+":<\/label><\/td><td colspan='3'><table><tr><td><label class='e-recurFinalRule'><\/label><\/td><td><div class='e-recuredit'><a class='e-recuredit' href='#'>"+this._getLocalizedLabels("Edit")+"<\/a><span class='e-icon e-scheduleedit'><\/span><\/div><\/td><\/tr><\/table><\/td><\/tr>";this.model.categorizeSettings.enable&&(i+="<tr><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Categorize")+":<\/td><td colspan='3' class='e-rightfields'><input id= '"+this._id+"_categorize' class='e-categorizevalue' type='text' value=''/><div id='ownerlist'><\/div><\/td><\/tr>");!t.isNullOrUndefined(this.model.resources)&&this.model.resources.length>0&&t.scheduleFeatures.resources&&(i=this._renderResourceElements(i));i+="<tr><td colspan='4'><textarea class='e-description e-inputtext' id='description' name='"+this.model.appointmentSettings.description+"'><\/textarea><\/td><\/tr>";i+="<\/tbody><\/table><\/form>";i+="<div class='e-floatright'><table class='e-table' cellpadding='5'><tr><td><div class='e-btnmargin e-floatleft'><button id='done' class='e-btndone e-appsave'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div class='e-btnmargin e-floatleft'><button id='cancel' class='e-appointcancel cancel'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div><\/div>";this._appointmentAddWindow.append(i).append(this._recurrenceWindow());this.element.append(this._appointmentAddWindow);this._renderControls();this._appointmentAddWindow.ejDialog({width:600,cssClass:this.model.cssClass,showOnInit:!1,enableRTL:this.model.enableRTL,enableModal:!0,title:this._getLocalizedLabels("CreateAppointmentTitle"),content:"#"+this._id,enableResize:!1,allowKeyboardNavigation:!1,close:n.proxy(this._onclose,this)});n("#"+this._id+"AppointmentAddEditWindow_wrapper").appendTo("body").addClass("e-scheduledialog").find(".e-titlebar").addClass("e-dialogheader");this._on(this._appointmentAddWindow,"click","a.e-recuredit",n.proxy(this._editRecurrence,this))},_renderQuickAppWindow:function(){var i,r;this._quickAppointWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppointmentQuickWindow");i="<div id='"+this._id+"_quickAppwindow' class='e-tableAppoint'><table cellpadding='7' class='e-qappwindow'><tbody>";i+="<tr><td colspan='2'><div class='e-quickstartend'><\/div> <div title='"+this._getLocalizedLabels("Close")+"'class='e-icon e-scheduleclose e-schedclosemargin e-pointercursor'><\/div><\/td><\/tr><tr><td class='e-subjectlabel'>"+this._getLocalizedLabels("Event")+":<\/td><td colspan='2' class='e-rightfields'><input id='"+this._id+"subject' class='subject e-inputtext' style='height:22px;' type='text' /><\/td><\/tr><\/tbody><\/table>";i+="<div style='margin-top:5px; padding-bottom: 30px;'><div tabIndex='0' class='e-detailedapp e-detailedwindow'> "+this._getLocalizedLabels("Detailed")+" >><\/div><div style='margin-right:-3px;' class='e-floatright'><div class='e-quickAppDone'><button id='done' class='e-btndone qAppDone' style='font-size:12px !important;'>"+this._getLocalizedLabels("CreateAppointmentTitle")+"<\/button><\/div><\/div><\/div><\/div>";this._quickAppointWindow.append(i);this.element.append(this._quickAppointWindow);this._quickAppointWindow.append(t.buildTag("div.e-quickarrow").append("<div class='e-outerarrowline'><\/div>").append("<div class='e-innerarrow'><\/div>"));r=this._quickAppointWindow;r.find(".e-btndone").ejButton({showRoundedCorner:!0,width:"130px",click:n.proxy(this._saveAppointment,this),cssClass:this.model.cssClass,enableRTL:this.model.enableRTL});this._on(r.find(".e-scheduleclose"),"click",n.proxy(this._quickWindowClose,this));this._on(r.find(".e-detailedapp"),"click",n.proxy(this._appointmentWindow,this));this._quickAppointWindow.ejDialog({width:330,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,showOnInit:!1,enableResize:!1,allowDraggable:!1,showHeader:!1,allowKeyboardNavigation:!1});n("#"+this._id+"AppointmentQuickWindow_wrapper").addClass("e-scheduledialog").find("#"+this._id+"AppointmentQuickWindow").addClass("e-dialogouter")},_renderQuickAppDetailsView:function(){this._quickAppDetailsWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppDetailsWindow");var i="<div id='"+this._id+"_quickAppDetailswindow' class='e-tableAppoint e-appdetails'><table cellpadding='1' class='e-qappwindow'><tbody>";i+="<tr><td colspan='2'><div class='e-quicksubject'><\/div> <div title='"+this._getLocalizedLabels("Close")+"' class='e-icon e-scheduleclose e-schedclosemargin e-pointercursor'><\/div><\/td><\/tr><tr><td colspan='2' class='e-rightfields'><\/td><\/tr><tr><td colspan='2'><div class='e-quickstartendtime'><\/div><\/td><\/tr><\/tbody><\/table>";i+="<div style='margin-top:5px;'><div title='"+this._getLocalizedLabels("Delete")+"' class='e-icon e-scheduledelete e-pointercursor' tabIndex='0'><\/div><div style='margin-right:-15px;' class='e-floatright'><div class='e-editevents'><div class='e-editevent' tabIndex='0'>"+this._getLocalizedLabels("Editevent")+" | <\/div><div class='e-editseries' tabIndex='0'>"+this._getLocalizedLabels("Editseries")+" >><\/div> <\/div><\/div><\/div><\/div>";this._quickAppDetailsWindow.append(i);this.element.append(this._quickAppDetailsWindow);this._quickAppDetailsWindow.append(t.buildTag("div.e-quickarrow").append("<div class='e-outerarrowline'><\/div>").append("<div class='e-innerarrow'><\/div>"));this._on(this._quickAppDetailsWindow.find(".e-scheduleclose"),"click",n.proxy(this._quickAppDetailWindowClose,this));this._on(this._quickAppDetailsWindow.find(".e-scheduledelete"),"click",n.proxy(this._deleteAppoint,this));this._on(this._quickAppDetailsWindow.find(".e-editevent,.e-editseries"),"click",n.proxy(this._editClick,this));this._quickAppDetailsWindow.ejDialog({width:270,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,showOnInit:!1,enableResize:!1,allowDraggable:!1,showHeader:!1,allowKeyboardNavigation:!1});n("#"+this._id+"AppDetailsWindow_wrapper").addClass("e-scheduledialog").find("#"+this._id+"AppDetailsWindow").addClass("e-dialogouter")},_editClick:function(i){var u=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),r=new t.DataManager(this._processed).executeLocal(u);n(i.target).hasClass("e-editevent")?r[0][this.model.appointmentSettings.recurrence]==1?(this._parentId=r[0].ParentId,this._currentAction=t.Schedule.Actions.EditOcurrence,this._showAppointmentDetails(this._appId,!0)):t.isNullOrUndefined(r[0][this.model.appointmentSettings.recurrence])?(this._currentAction=t.Schedule.Actions.Save,this._showAppointmentDetails(this._appId,!1)):(this._currentAction=t.Schedule.Actions.Save,this._showAppointmentDetails(r[0].ParentId)):n(i.target).hasClass("e-editseries")&&r[0][this.model.appointmentSettings.recurrence]==1&&(this._parentId=r[0].ParentId,this._currentAction=t.Schedule.Actions.EditSeries,this._showAppointmentDetails(this._parentId));this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close")},_deleteAppoint:function(){if(!this.model.readOnly){if(this._appId){this._currentAction=t.Schedule.Actions.Delete;var n=this._getAppointmentByParentId(this._appId);t.isNullOrUndefined(n[this.model.appointmentSettings.recurrenceRule])?this._deleteApp(parseInt(this._appId)):(this._parentId=parseInt(n[this.model.appointmentSettings.id]),this._recurEditWindow.find(".e-editonly").ejRadioButton({checked:!0}),this._recurEditWindow.ejDialog("open"),this._recurEditWindow.focus())}this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close")}},_quickAppDetailWindowClose:function(){this._quickAppDetailsWindow.ejDialog("close");this._processFocus()},_alldayCheck:function(){this._appointmentAddWindow.find(".allday").ejCheckBox("option","checked")?(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker({value:this.model.timeMode=="12"?"12:00 AM":"00:00",enabled:!1}),this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker({value:this.model.timeMode=="12"?"11:59 PM":"23:30",enabled:!1}),this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList({enabled:!1})):(this._appointmentAddWindow.find(".startendtime").ejTimePicker({enabled:!0}),this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList({enabled:!0}))},_renderRecurEditWindow:function(){var i;this._recurEditWindow=t.buildTag("div.e-scheduledialog#"+this._id+"RecurrenceEdit");i=t.buildTag("div.e-recurtitle",this._getLocalizedLabels("RecurrenceEditTitle"));i.append(t.buildTag("div.e-icon e-scheduleclose e-schedclosemargin e-pointercursor","",{},{title:this._getLocalizedLabels("Close")}));this._recurEditWindow.append(i);var u=t.buildTag("div.e-recureditmsg",this._getLocalizedLabels("RecurrenceEditMessage")),f=t.buildTag("div.e-recureditopt").append(t.buildTag("input.e-editonly","",{},{type:"radio",name:"recurEdit",id:this._id+"_editOnly"})).append(t.buildTag("label.e-recureditlbl",this._getLocalizedLabels("RecurrenceEditOnly"),{},{"for":this._id+"_editOnly"})),e=t.buildTag("div.e-recureditopt").append(t.buildTag("input.e-editseries","",{},{type:"radio",name:"recurEdit",id:this._id+"_editSeries"})).append(t.buildTag("label.e-recureditlbl",this._getLocalizedLabels("RecurrenceEditSeries"),{},{"for":this._id+"_editSeries"})),r=t.buildTag("div.e-recureditbtns").append(t.buildTag("button.e-recurdone",this._getLocalizedLabels("Done"),{},{name:"done",value:this._getLocalizedLabels("Done")})).append(t.buildTag("button.e-recurcancel",this._getLocalizedLabels("Cancel"),{},{name:"cancel",value:this._getLocalizedLabels("Cancel")}));this._recurEditWindow.append(u).append(f).append(e).append(r);this._recurEditWindow.find(".e-editonly,.e-editseries").ejRadioButton({cssClass:this.model.cssClass});r.find(".e-recurdone,.e-recurcancel").ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL});this._on(this._recurEditWindow,"click",".e-recurdone,.e-recurcancel",n.proxy(this._recurBtnClick,this));this._on(this._recurEditWindow,"click","div.e-scheduleclose",n.proxy(this._recrConformClose,this));this._recurEditWindow.appendTo(this.element);this._recurEditWindow.ejDialog({width:360,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,showOnInit:!1,enableModal:!0,enableResize:!1,showHeader:!1,content:"#"+this._id,allowKeyboardNavigation:!1,close:n.proxy(this._processFocus,this)});n("#"+this._id+"RecurrenceEdit_wrapper").appendTo("body")},_recrConformClose:function(){this._recurEditWindow.ejDialog("close");this._processFocus()},_recurBtnClick:function(i){var u,r,h;if(n(i.target).hasClass("e-recurdone"))if(this._recurEditWindow.find(".e-editonly").ejRadioButton("option","checked"))if(this._currentAction==t.Schedule.Actions.Delete)if(u=new t.DataManager(this._processed).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,parseInt(this._appId)))[0],u[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1)this._deleteApp(parseInt(this._appId));else{var o=this._deleteOcurrence(this._parentId,u[this.model.appointmentSettings.startTime]),e=this._timeZoneConversion(o),f=this._dataManager.update(this.model.appointmentSettings.id,e),s=this._reverseTimeZoneConversion(e);if(new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,s),r=this,f&&n.isFunction(f.promise)&&this.dataSource()instanceof t.DataManager)f.done(function(){if(r._trigger("actionBegin",{id:r._appId,requestType:"appointmentDelete"}))return!1;new t.DataManager(r._processed).remove(r.model.appointmentSettings.id,parseInt(r._appId));r.element.find("#Appointment_"+r._appId).remove();r.element.find("#categorybar_"+r._appId).remove();r._trigger("appointmentDeleted",{appointment:u});r._trigger("actionComplete",{appointment:u,requestType:"appointmentDelete"})}),f.fail(function(){});else{if(this._trigger("actionBegin",{id:this._appId,requestType:"appointmentDelete"}))return!1;h=new t.DataManager(this._processed).remove(this.model.appointmentSettings.id,parseInt(this._appId));this.element.find("#Appointment_"+this._appId).remove();this.element.find("#categorybar_"+this._appId).remove();this._trigger("appointmentDeleted",{appointment:u});this._trigger("actionComplete",{appointment:u,requestType:"appointmentDelete"})}this._getApps();this._app.length<1&&this.model.enableAppointmentNavigation&&this._nextPrevButton(this._app)}else this._currentAction=t.Schedule.Actions.EditOcurrence,this._showAppointmentDetails(this._appId,!0);else this._currentAction==t.Schedule.Actions.Delete?this._deleteApp(parseInt(this._parentId)):(this._currentAction=t.Schedule.Actions.EditSeries,this._showAppointmentDetails(this._parentId));this._recurEditWindow.ejDialog("close")},_repeat:function(n){if(n.isChecked||this._recurChecked)if(this._currentAction==t.Schedule.Actions.EditSeries||this._appointmentAddWindow.find(".e-recurFinalRule").html()!="")this._appointmentAddWindow.find("#"+this._id+"summary").css("display","table-row");else{this._appointmentAddWindow.find(".e-appwindow").toggle();this._appointmentAddWindow.find(".e-recurwindow").css("margin-left",700).toggle().animate({"margin-left":10},400);this._recurClearFields();var i=new Date(this._appointmentAddWindow.find(".startenddate").ejDatePicker("option","value"));this._appointmentAddWindow.find(".recurtype").ejDropDownList({selectedItemIndex:0});this._appointmentAddWindow.find(".recurtype").ejDropDownList({selectedItemIndex:1});this._appointmentAddWindow.find(".recurstartdate").ejDatePicker({value:i});this._appointmentAddWindow.find(".e-until").ejDatePicker({value:new Date(i.setDate(i.getDate()+70))});this._appointmentAddWindow.find(".e-recurnoend").ejRadioButton({checked:!0})}else(this._currentAction==t.Schedule.Actions.EditSeries||this._appointmentAddWindow.find(".e-recurFinalRule").html()!="")&&this._appointmentAddWindow.find("#"+this._id+"summary").css("display","none");this._recurChecked=!1},_recurtype:function(n){var i,t,r;this._rRuleFreq="";i="";t=new Date(this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value"));n.itemId!=null&&(this._appointmentAddWindow.find("#"+this._id+"repeatEvery").css("display","table-row"),n.itemId==0?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceDay"),this._appointmentAddWindow.find("#"+this._id+"weeklyrecur,#"+this._id+"monthlyrecur,#"+this._id+"yearlyrecur").css("display","none"),this._appointmentAddWindow.find("#"+this._id+"dailyrecur").css("display","table-row"),this._rRuleFreq="DAILY",i=this._getLocalizedLabels("RecurrenceDay").toLowerCase()):n.itemId==1?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceWeek"),r=this._dayNames[t.getDay()],this._appointmentAddWindow.find(".e-weekly"+r).ejCheckBox({checked:!0}),i=this._getLocalizedLabels("RecurrenceWeek").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._dayFullNames[t.getDay()],this._rRuleFreq="WEEKLY",this._appointmentAddWindow.find("#"+this._id+"monthlyrecur,#"+this._id+"yearlyrecur,#"+this._id+"dailyrecur").css("display","none"),this._appointmentAddWindow.find("#"+this._id+"weeklyrecur").css("display","table-row")):n.itemId==2?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceMonth"),this._appointmentAddWindow.find("#"+this._id+"weeklyrecur,#"+this._id+"yearlyrecur,#"+this._id+"dailyrecur").css("display","none"),this._appointmentAddWindow.find("#"+this._id+"monthlyrecur").css("display","table-row"),this._appointmentAddWindow.find(".e-monthdate").ejNumericTextbox({value:t.getDate()}),this._appointmentAddWindow.find(".e-monthsrtday").ejDropDownList({selectedItemIndex:t.getDay()}),this._appointmentAddWindow.find(".monthsrt").ejDropDownList({selectedItemIndex:this._getWeekIndex(t)}),this._appointmentAddWindow.find(".e-monthdaytype").ejRadioButton({checked:!0}),this._rRuleFreq="MONTHLY",i=this._getLocalizedLabels("RecurrenceMonth").toLowerCase()):n.itemId==3?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceYear"),this._appointmentAddWindow.find("#"+this._id+"weeklyrecur,#"+this._id+"monthlyrecur,#"+this._id+"dailyrecur").css("display","none"),this._appointmentAddWindow.find("#"+this._id+"yearlyrecur").css("display","table-row"),this._appointmentAddWindow.find(".yearmonth").ejDropDownList({selectedItemIndex:t.getMonth()}),this._appointmentAddWindow.find(".yeardate").ejNumericTextbox({value:t.getDate()}),this._appointmentAddWindow.find(".yearsrtday").ejDropDownList({selectedItemIndex:t.getDay()}),this._appointmentAddWindow.find(".yearsrtmonth").ejDropDownList({selectedItemIndex:t.getMonth()}),this._appointmentAddWindow.find(".yearsrt").ejDropDownList({selectedItemIndex:this._getWeekIndex(t)}),this._appointmentAddWindow.find(".e-yearrecurday").ejRadioButton({checked:!0}),this._rRuleFreq="YEARLY",i=this._getLocalizedLabels("RecurrenceYear").toLowerCase()):n.itemId==4&&(this._rRuleFreq="WEEKDAYS",this._appointmentAddWindow.find("#"+this._id+"weeklyrecur,#"+this._id+"yearlyrecur,#"+this._id+"dailyrecur,#"+this._id+"repeatEvery,#"+this._id+"monthlyrecur").css("display","none"),i=n.text),this._appointmentAddWindow.find(".e-recurRule").html(i))},_getRenderDates:function(){var n,r,i,t;if(this._dateRender=[],this.currentView()==="week"||this.currentView()==="workweek"){for(i=this._firstweekdate(this.currentDate()),t=0;t<7;t++)n=new Date(i),n.setDate(i.getDate()+t),this._dateRender.push(new Date(n.getFullYear(),n.getMonth(),n.getDate()).getTime());this.currentView()==="workweek"&&(this._dateRender=this._dateRender.slice(1,6))}else if(this.currentView()==="month")this._dateRender=this._monthdates();else if(this.currentView()==="customview")for(r=this._renderDays<=7?this._renderDays:this._numDays,i=this._renderDays<=7?new Date(this.currentDate()):this.model.orientation=="vertical"?this._firstweekdate(this.currentDate()):new Date(this.currentDate()),t=0;t<r;t++)n=new Date(this.currentDate()),n.setDate(i.getDate()+t),this._dateRender.push(new Date(n.getFullYear(),n.getMonth(),n.getDate()).getTime());else this._dateRender.push(this.currentDate());return this._dateRender},_getCurrentDateHeaderValue:function(){var i=Globalize.culture(this.model.locale),t,n=this._dateRender;return this.currentView()==="day"?t=i.calendar.days.names[new Date(n[0]).getDay()].slice(0,3)+" "+new Date(n[0]).getDate()+" "+Globalize.format(new Date(n[0]),"MMM")+" "+new Date(n[0]).getFullYear():this.currentView()==="week"||this.currentView()==="workweek"?new Date(n[0]).getYear()===new Date(n[n.length-1]).getYear()?new Date(n[0]).getMonth()===new Date(n[n.length-1]).getMonth()?t=Globalize.format(new Date(n[0]),"dd")+" - "+Globalize.format(new Date(n[n.length-1]),"dd MMM yyyy"):new Date(n[0]).getMonth()!==new Date(n[n.length-1]).getMonth()&&(t=this.model.enableRTL?Globalize.format(new Date(n[n.length-1]),"MMM dd")+" - "+Globalize.format(new Date(n[0]),"dd MMM yyyy"):Globalize.format(new Date(n[0]),"dd MMM")+" - "+Globalize.format(new Date(n[n.length-1]),"dd MMM yyyy")):t=Globalize.format(new Date(n[0]),"MMM dd yyyy")+" - "+Globalize.format(new Date(n[n.length-1]),"MMM dd yyyy"):this.currentView()==="customview"?n.length==1?t=i.calendar.days.names[new Date(n[0]).getDay()].slice(0,3)+" "+new Date(n[0]).getDate()+" "+Globalize.format(new Date(n[0]),"MMM")+" "+new Date(n[0]).getFullYear():n.length>1&&n.length<=7?new Date(n[0]).getYear()===new Date(n[n.length-1]).getYear()?new Date(n[0]).getMonth()===new Date(n[n.length-1]).getMonth()?t=Globalize.format(new Date(n[0]),"dd")+" - "+Globalize.format(new Date(n[n.length-1]),"dd MMM yyyy"):new Date(n[0]).getMonth()!==new Date(n[n.length-1]).getMonth()&&(t=this.model.enableRTL?Globalize.format(new Date(n[n.length-1]),"MMM dd")+" - "+Globalize.format(new Date(n[0]),"dd MMM yyyy"):Globalize.format(new Date(n[0]),"dd MMM")+" - "+Globalize.format(new Date(n[n.length-1]),"dd MMM yyyy")):t=Globalize.format(new Date(n[0]),"MMM dd yyyy")+" - "+Globalize.format(new Date(n[n.length-1]),"MMM dd yyyy"):t=new Date(n[0]).getFullYear()==new Date(n[n.length-1]).getFullYear()?new Date(n[0]).getMonth()==new Date(n[n.length-1]).getMonth()?Globalize.format(new Date(this.currentDate()),"MMM yyyy"):Globalize.format(new Date(n[0]),"MMM")+" - "+Globalize.format(new Date(n[n.length-1]),"MMM yyyy"):Globalize.format(new Date(n[0]),"MMM yyyy")+" - "+Globalize.format(new Date(n[n.length-1]),"MMM yyyy"):t=Globalize.format(new Date(this.currentDate()),"MMM yyyy"),t},_firstweekdate:function(n){var t=new Date(n),i=t.getDay();return i!=0&&t.setDate(t.getDate()-i),t},_getHeaderAllDayCellsCount:function(){var u=Globalize.culture(this.model.locale),h,f,e,c=1,i,s,o,n,r;if(this.dateRender=[],e=[],this.model.orientation=="vertical"){for(f=this._getColumnCount().length,t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)||!t.scheduleFeatures.resources||(s=this.__getMultipleResourceCellsCount(f),c=s.resCount,f=s.count),n=0;n<c;n++)for(o=0;o<this._dateRender.length;o++)this.dateRender.push(this._dateRender[o]);for(n=0;n<f;n++)i=this.currentView()==="month"||this.currentView()==="day"||this._isCustomView()?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?u.calendar.days.names[new Date(this.dateRender[n]).getDay()]:u.calendar.days.names[new Date(this.dateRender[n]).getDay()].slice(0,3):u.calendar.days.names[new Date(this.dateRender[n]).getDay()].slice(0,3),r=Globalize.format(new Date(this.dateRender[n]),this._pattern.d)===Globalize.format(new Date,this._pattern.d)?"e-headerToday":"",h=this.currentView()==="month"||this._isCustomView()?{currentDay:i,currentDateClass:"",cellToday:r}:this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?{currentDay:i+" "+Globalize.format(new Date(this.dateRender[n]),"dd MMMM yyyy"),currentDateClass:"",cellToday:r}:{currentDay:i+" "+Globalize.format(new Date(this.dateRender[n]),"dd MMM yy"),currentDateClass:"",cellToday:r}:{currentDay:i+" "+new Date(this.dateRender[n]).getDate(),currentDateClass:new Date(this.dateRender[n]).getDate()===new Date(this.currentDate()).getDate()?"e-activeview":"",cellToday:r},e.push(h)}else e=this._getHorizontalheaderCellCount(u);return e},_findResourceIndex:function(n,t,i){for(var r=0;r<n.length;r++)if(n[r][t]===i)return r},_renderHeaderAllDayTemplate:function(){var i,u,n,o,s,h,c;if(t.scheduleFeatures.horizontal&&this.model.orientation=="horizontal")!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources&&this._renderMultipleResourceHeaderTemplate(null,null),this._renderHorizontalHeaderBar();else{var l=t.buildTag("div","",{},{height:"100%"}).css("position","relative").css("overflow","hidden"),e=0,a=t.buildTag("table.e-table e-headrealldaytable","",{},{cellspacing:"0px",cellpadding:"0px"}),r=t.buildTag("tbody"),v=t.buildTag("tr.e-dateheader"),f=this._getHeaderAllDayCellsCount(),y=this.headTemplate.render({cols:f,view:this.currentView(),colspan:1});!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources&&(r=this._renderMultipleResourceHeaderTemplate(r,f),e=t.isNullOrUndefined(this.model.group)?0:this.model.group.resources.length);var p=t.buildTag("table.e-table e-headertable","",{},{cellspacing:"0px",cellpadding:"0px"}),w=t.buildTag("tbody"),b=t.buildTag("tr.e-headertr");for(headTrCount=this.currentView()=="month"||this._isCustomView()?1:2,i=e+headTrCount,u=[],n=0;n<i;n++)this.currentView()=="month"||this._isCustomView()?u.push({tdClass:n==i-1?"e-monthleftcells":"e-resourceheadercells",divClass:n==i-1?"e-dateheadercell":""}):u.push({tdClass:n==i-1?"e-leftindent":n==i-2?"e-settingsindent":"e-resourceheadercells",divClass:n==i-1?"e-schedulesettings e-textellipsis":n==i-2?"e-dateheadercell":""});o=this.currentView()=="month"||this._isCustomView()?"50px":"56px";s=this.leftIndent.render({trs:u,cswidth:o});this.aTR.append(t.buildTag("td").append(p.append(w.append(b.append(t.buildTag("td.empty","",{},{width:this.currentView()=="month"||this._isCustomView()?"50px":"56px"}).css("border-bottom",this.currentView()!="month"&&!this._isCustomView()?"1px solid #bbbcbb":"").append(s)).append(t.buildTag("td").append(l.append(a.append(r.append(v.append(y)))))).append(t.buildTag("td","",{},{width:this.currentView()=="month"||this._isCustomView()?"0px":"18px"}).append(this._emptyCell()))))));this.currentView()==="month"||this._isCustomView()||(h=t.buildTag("tr"),c=this.alldayTemp.render({cols:f,colspan:1}),r.append(h.append(c)))}},_monthdates:function(){var t=new Date(this.currentDate()),n=new Date(t.getFullYear(),t.getMonth(),1),i=n.getDay()+1,u;n.setDate(n.getDate()-i);var r=new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),e=(i+r)%7!=0?7-(i+r)%7:0,o=parseInt((i+r+e)/7),f=[];for(u=0;u<o*7;u++)f.push(new Date(n.setDate(n.getDate()+1)));return f},_getStartEndTime:function(){var i=[],u,r=Globalize.culture(this.model.locale).calendar,f,n;if(this.model.orientation==="vertical")if(this.currentView()=="month"||this._isCustomView())for(f=this._dateRender.length,n=0;n<f/7;n++)i.push(n);else for(n=this.model.startHour;n<this.model.endHour;n++)this.model.timeMode==="12"?(u=(n===this.model.startHour||n===12)&&r.AM&&r.PM?Globalize.format(new Date((new Date).setHours(n)),"hh tt"):Globalize.format(new Date((new Date).setHours(n)),"hh 00"),i.push({time:u,id:n})):i.push({time:(n<=9?"0"+n:n)+" 00"});else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(i=this._getHoriStartEndTime(r));return i},_getWorkCellsCount:function(){var t=[],i,r,n;if(this.currentView()=="month"||this._isCustomView())for(i=this._dateRender.length,n=0;n<i/7;n++)t.push({crow:n,cwidth:this.model.cellWidth,cheight:this.model.cellHeight});else for(r=this._getStartEndTime(),n=0;n<2*r.length;n++)t.push({crow:n,cwidth:this.model.cellWidth,cheight:this.model.cellHeight});return t},_renderContentAreaTemplate:function(){var u=t.buildTag("div.e-workareadiv"),f=t.buildTag("table.e-table e-worktable","",{},{height:"100%",cellpadding:"0px",cellspacing:"0px",width:"100%"}),e=t.buildTag("tbody"),o=t.buildTag("tr"),s=t.buildTag("td"),h=t.buildTag("div#"+this._id+"_scroller"),c,n,i,r,l,a,v;if(this.$WorkCellDiv=t.buildTag("div").css("position","relative").attr("class","e-draggableworkarea").css("height","100%"),t.scheduleFeatures.horizontal&&this.model.orientation=="horizontal")this._renderHorizontalContent(u,f,e,o,s,h);else{for(c=this.currentView()==="month"||this._isCustomView()?"e-monthleftindent":"e-workleftindent",this.$TimeCellTD=t.buildTag("td","",{},{}).addClass(c),n=[],i=this.currentView()==="month"||this._isCustomView()?7:this._getRenderDates().length,t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)||!t.scheduleFeatures.resources||(i=this._getMultipleResourceColsCount(i)),r=0;r<i;r++)n.push(r);a=this.currentView()=="month"||this._isCustomView()?1:0;l=this.timeCellTemplate.render({timerows:this._getStartEndTime(),cols1:[1,2],viewclass:a});v=this.currentView()==="month"||this._isCustomView()?this.monthcellTemp.render({cellrows:this._getWorkCellsCount(),cols1:n,orientation:this.model.orientation}):this.workcellTemp.render({cellrows:this._getWorkCellsCount(),cols1:n,orientation:this.model.orientation});this.wTR.append(t.buildTag("td").append(u.append(f.append(e.append(o.append(this.$TimeCellTD.append(l)).append(s.append(h.append(this.$WorkCellDiv.append(v)))))))))}},_getColumnCount:function(){for(var t=[],i=this.currentView()==="month"||this._isCustomView()?7:this._getRenderDates().length,n=0;n<i;n++)t.push(n);return t},_bindAppointmentsData:function(){var r,u,f,n,i;if(!t.isNullOrUndefined(this.model.appointmentSettings)&&this.dataSource()!=null)if(this.model.enablePersistence&&(this.model.appointmentSettings.query=new t.Query),!this.dataSource()instanceof t.DataManager&&this.dataSource().dataSource.offline&&this._dateFormat(this.dataSource()),this.dataSource()instanceof t.DataManager&&!this.dataSource().dataSource.offline)this._initDataSource();else{if(f=(new Date).getTimezoneOffset(),this.model.timeZone==null)n=this._minToHour(f);else if(t.isNullOrUndefined(this.model.timeZone.split(" ")[1]))n=this._minToHour(0);else{var e=this.model.timeZone.split(" ")[1].split(":"),o=parseInt(e[0]),s=parseInt(e[1]);n=this._minToHour(-(o*60)+s)}for(i=0;i<this.dataSource().length;i++)r=new Date(this.dataSource()[i].StartTime),u=new Date(this.dataSource()[i].EndTime),this.dataSource()[i].StartTime=new Date(r.setHours(r.getHours()-n.h,r.getMinutes()-n.m)),this.dataSource()[i].EndTime=new Date(u.setHours(u.getHours()-n.h,u.getMinutes()-n.m));this._currentAppointmentData=this.dataSource();!t.isNullOrUndefined(this.dataSource().dataSource)&&this.dataSource().dataSource.json&&(this._currentAppointmentData=this.dataSource().dataSource.json);this._dataCount=this._currentAppointmentData.length;this._dataProcessing(this._currentAppointmentData);this._renderAppointmentAll()}},_initDataSource:function(){var i=this._columnToSelect(this.model.appointmentSettings),n=this,r=this.dataSource().executeQuery(i);r.done(function(i){var f,e,o,r,u;if(o=(new Date).getTimezoneOffset(),n.model.timeZone==null)r=n._minToHour(o);else if(t.isNullOrUndefined(n.model.timeZone.split(" ")[1]))r=n._minToHour(0);else{var s=n.model.timeZone.split(" ")[1].split(":"),h=parseInt(s[0]),c=parseInt(s[1]);r=n._minToHour(-(h*60)+c)}for(u=0;u<i.result.length;u++)f=new Date(i.result[u].StartTime),e=new Date(i.result[u].EndTime),i.result[u].StartTime=new Date(f.setHours(f.getHours()-r.h,f.getMinutes()-r.m)),i.result[u].EndTime=new Date(e.setHours(e.getHours()-r.h,e.getMinutes()-r.m));n._currentAppointmentData=i.result;n._dataCount=i.result.length;n._overlapList=[];n._dataProcessing(i.result);n._renderAppointmentAll()})},_dateFormat:function(n){if(new Date(n[0][this.model.appointmentSettings.startTime]).toString()=="Invalid Date")for(var t=0;t<n.length;t++)n[t][this.model.appointmentSettings.startTime]=new Date(n[t][this.model.appointmentSettings.startTime]).toString()=="Invalid Date"||new Date(n[t][this.model.appointmentSettings.startTime]).toString()=="NaN"?new Date(parseInt(n[t][this.model.appointmentSettings.startTime].match(/\d+/).toString())):new Date(n[t][this.model.appointmentSettings.startTime]),n[t][this.model.appointmentSettings.endTime]=new Date(n[t][this.model.appointmentSettings.endTime]).toString()=="Invalid Date"?new Date(parseInt(n[t][this.model.appointmentSettings.endTime].match(/\d+/).toString())):new Date(n[t][this.model.appointmentSettings.endTime])},_timeZoneConversion:function(i){var u=n.extend(!0,{},i),f,e,o,r;if(o=(new Date).getTimezoneOffset(),this.model.timeZone==null)r=this._minToHour(o);else if(t.isNullOrUndefined(this.model.timeZone.split(" ")[1]))r=this._minToHour(0);else{var s=this.model.timeZone.split(" ")[1].split(":"),h=parseInt(s[0]),c=parseInt(s[1]);r=this._minToHour(-(h*60)+c)}return f=new Date(u.StartTime),e=new Date(u.EndTime),u.StartTime=new Date(f.setHours(f.getHours()+r.h,f.getMinutes()+r.m)),u.EndTime=new Date(e.setHours(e.getHours()+r.h,e.getMinutes()+r.m)),u},_reverseTimeZoneConversion:function(i){var u=n.extend(!0,{},i),f,e,o,r;if(o=(new Date).getTimezoneOffset(),this.model.timeZone==null)r=this._minToHour(o);else if(t.isNullOrUndefined(this.model.timeZone.split(" ")[1]))r=this._minToHour(0);else{var s=this.model.timeZone.split(" ")[1].split(":"),h=parseInt(s[0]),c=parseInt(s[1]);r=this._minToHour(-(h*60)+c)}return f=new Date(u.StartTime),e=new Date(u.EndTime),u.StartTime=new Date(f.setHours(f.getHours()-r.h,f.getMinutes()-r.m)),u.EndTime=new Date(e.setHours(e.getHours()-r.h,e.getMinutes()-r.m)),u},_columnToSelect:function(n){var r=[],i=t.Query();return t.isNullOrUndefined(n.query)?(r=this._getColumns(n),r.length>0&&i.select(r),t.isNullOrUndefined(this.dataSource())||this.dataSource().dataSource.url.match(n.tableName+"$")||t.isNullOrUndefined(n.tableName)||i.from(n.tableName)):i=n.query,i},_getColumns:function(n){var i=[];for(var t in n)t!=="tableName"&&t!=="query"&&t!=="dataSource"&&i.push(n[t]);return i},_sortAppById:function(n){var t=this;return n.sort(function(n,i){var r=n[t.model.appointmentSettings.id],u=i[t.model.appointmentSettings.id];return r<u?-1:r>u?1:0}),n},_dataProcessing:function(n){var i,t;if(this._processed=[],n.length>0){for(i=this._sortAppById(n),this._maxId=i[i.length-1][this.model.appointmentSettings.id]+1,t=0;t<n.length;t++)this._appointmentProcessing(n[t]);return this._processed=this._sortAppById(this._processed),this._processed}},_appointmentProcessing:function(i){var u=new Date(i[this.model.appointmentSettings.startTime]),a=(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/1e3,y=Math.floor(a/3600),p=Math.floor(a%3600/60),e,f,s,l,c,v;if(this._rRule={},_count=0,_lastDay=!1,t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])||this.recurrenceRuleSplit(i[this.model.appointmentSettings.recurrenceRule]),i[this.model.appointmentSettings.recurrence]==1&&t.isNullOrUndefined(this._rRule.recurEditId)){if(i.ParentId=i[this.model.appointmentSettings.id],e="",f=t.isNullOrUndefined(this._rRule.interval)?1:this._rRule.interval,t.isNullOrUndefined(this._rRule.weekDays)||(e=this._rRule.weekDays.split(",")),t.isNullOrUndefined(this._rRule.until))if(t.isNullOrUndefined(this._rRule.count))recurEndDate=new Date(new Date(this.currentDate()).setDate(u.getDate()+42*f));else switch(this._rRule.freq){case"DAILY":recurEndDate=new Date(new Date(u).setDate(u.getDate()+this._rRule.count*f));break;case"WEEKLY":s=u.getDate()+this._rRule.count/e.length*7*f;recurEndDate=new Date(new Date(u).setDate(Math.round(s)<s?s+1:s));break;case"MONTHLY":recurEndDate=new Date(new Date(u).setMonth(u.getMonth()+this._rRule.count*f));break;case"YEARLY":recurEndDate=new Date(new Date(u).setFullYear(u.getFullYear()+this._rRule.count*f))}else recurEndDate=new Date(this._rRule.until),recurEndDate.setDate(recurEndDate.getDate()+1);switch(this._rRule.freq){case"WEEKLY":e=this._rRule.weekDays.split(",");e.indexOf(this._dayNames[new Date(u).getDay()])==-1&&(u=this._weeklyDayFind(u,e));break;case"MONTHLY":if(t.isNullOrUndefined(this._rRule.monthDay))u=new Date(this._getWeekIndex(u)+1>this._rRule.setPositions&&this._rRule.setPositions!=-1?new Date(u.getFullYear(),u.getMonth()+1,1):u);else for(_lastDay=new Date(u).getDate()==new Date(u.getFullYear(),u.getMonth()+1,0).getDate()?!0:!1;new Date(u).getDate()!=this._rRule.monthDay;)u=new Date(u.setDate(u.getDate()+1));break;case"YEARLY":t.isNullOrUndefined(this._rRule.monthDay)?t.isNullOrUndefined(this._rRule.setPositions)||(u=new Date(u.getFullYear(),this._rRule.month-1,u.getDate()),u=new Date(this._getWeekIndex(u)+1>this._rRule.setPositions?new Date(u.getFullYear(),u.getMonth()+1,1):u)):u=u.getMonth()+1>=this._rRule.month&&u.getDate()>this._rRule.monthDay?new Date(u.getFullYear()+1,this._rRule.month-1,this._rRule.monthDay):new Date(u.getFullYear(),this._rRule.month-1,this._rRule.monthDay)}while(u<=recurEndDate){var h=i[this.model.appointmentSettings.startTime],o={},w=i[this.model.appointmentSettings.endTime];this._rRule.freq!="MONTHLY"&&this._rRule.freq!="YEARLY"||t.isNullOrUndefined(this._rRule.setPositions)||(u=this._dayOfWeekInMonth(u,this._rRule.weekDays,this._rRule.setPositions));l=new Date(u.getFullYear(),u.getMonth(),u.getDate(),h.getHours(),h.getMinutes(),0);c=new Date(u.getFullYear(),u.getMonth(),u.getDate(),h.getHours()+y,h.getMinutes()+p,0);t.isNullOrUndefined(this._rRule.exDate)?o=this._addAppData(i,this._maxId,l,c,i[this.model.appointmentSettings.id]):this._rRule.exDate.indexOf(Globalize.format(new Date(u),this._pattern.d))==-1&&(o=this._addAppData(i,this._maxId,l,c,i[this.model.appointmentSettings.id]));switch(this._rRule.freq){case"DAILY":u=new Date(u.setDate(u.getDate()+f));break;case"WEEKLY":v=this._dayNames[new Date(u).getDay()];e.length-1!=e.indexOf(v)?u=this._weeklyDayFind(u,e):(u=new Date(u.setDate(u.getDate()+u.getDay()*-1)),u=new Date(u.setDate(u.getDate()+f*7-1)),u=this._weeklyDayFind(u,e));break;case"MONTHLY":u=_lastDay?new Date(u.getFullYear(),u.getMonth()+f+1,0):t.isNullOrUndefined(this._rRule.setPositions)?new Date(u.setMonth(u.getMonth()+f)):new Date(u.getFullYear(),u.getMonth()+f,1);break;case"YEARLY":u=new Date(u.setFullYear(u.getFullYear()+f))}if(Globalize.format(i[this.model.appointmentSettings.startTime],this._pattern.d)<Globalize.format(i[this.model.appointmentSettings.endTime],this._pattern.d)&&(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5<24&&i[this.model.appointmentSettings.allDay]!==!0?this._multipleDayApp(o,this._maxId,o[this.model.appointmentSettings.startTime],c):n.isEmptyObject(o)||this._processed.push(o),this._maxId++,_count++,!t.isNullOrUndefined(this._rRule.count)&&_count==this._rRule.count)break}}Globalize.format(i[this.model.appointmentSettings.startTime],this._pattern.d)<Globalize.format(i[this.model.appointmentSettings.endTime],this._pattern.d)&&(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5<24&&i[this.model.appointmentSettings.allDay]!==!0&&i[this.model.appointmentSettings.recurrence]!=1?(t.isNullOrUndefined(i.ParentId)&&(i.ParentId=i[this.model.appointmentSettings.id]),this._multipleDayApp(i,this._maxId,i[this.model.appointmentSettings.startTime],i[this.model.appointmentSettings.endTime])):(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5>24&&t.isNullOrUndefined(this._rRule.recurEditId)?(i[this.model.appointmentSettings.allDay]===!0||i[this.model.appointmentSettings.allDay]!==!0&&(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5>24)&&i[this.model.appointmentSettings.recurrence]!=1&&(this.currentView()=="day"?this._multipleDaySplit(i,this._maxId,i[this.model.appointmentSettings.startTime],i[this.model.appointmentSettings.endTime]):this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays==5?this._multipleWorkWeekSplit(i,this._maxId,i[this.model.appointmentSettings.startTime],i[this.model.appointmentSettings.endTime]):this._multipleWeekSplit(i,this._maxId,i[this.model.appointmentSettings.startTime],i[this.model.appointmentSettings.endTime])):i[this.model.appointmentSettings.recurrence]!=0&&t.isNullOrUndefined(this._rRule.recurEditId)?(i[this.model.appointmentSettings.recurrence]==r||i[this.model.appointmentSettings.allDay]==r)&&this._processed.push(i):(t.isNullOrUndefined(i.ParentId)&&(i.ParentId=i[this.model.appointmentSettings.id]),t.isNullOrUndefined(this._rRule.recurEditId)||(i.ParentId=this._rRule.recurEditId),this._processed.push(i))},_multipleDayApp:function(n,t,i,r){for(var f=new Date(i),e=new Date(new Date(i).getFullYear(),new Date(i).getMonth(),new Date(i).getDate()),u=new Date(new Date(e).setHours(new Date(e).getHours()+24)),u=new Date(new Date(u).setMinutes(new Date(u).getMinutes()-1));f>=new Date(i)&&f<=u&&u<=new Date(r);)appointment=this._addAppData(n,t,f,u,n.ParentId),this._processed.push(appointment),f=new Date(new Date(u).setMinutes(new Date(u).getMinutes()+1)),u=n[this.model.appointmentSettings.endTime],t++,this._maxId=t},_multipleDaySplit:function(n,t,i,r){for(var u=new Date(i),e=new Date(new Date(i).getFullYear(),new Date(i).getMonth(),new Date(i).getDate()),f=new Date(new Date(e).setHours(new Date(r).getHours())),f=new Date(new Date(f).setMinutes(new Date(r.getMinutes())));u>=new Date(i)&&u<=f&&f<=new Date(r);)appointment=this._addAppData(n,t,u,f,n[this.model.appointmentSettings.id]),this._processed.push(appointment),u=new Date(new Date(u).setHours(new Date(i).getHours()+24)),u=new Date(new Date(u).setMinutes(new Date(i).getMinutes())),f=new Date(new Date(u).setHours(new Date(r).getHours())),f=new Date(new Date(f).setMinutes(new Date(r).getMinutes())),t++,this._maxId=t},_multipleWorkWeekSplit:function(n,t,i,r){var e=new Date(new Date(i).setDate(i.getDate()+1)),o=new Date(new Date(i).setDate(i.getDate()+2)),f=new Date(i).getDay()==0?e:new Date(i).getDay()==6?o:new Date(i),l=6-f.getDay(),a=new Date(new Date(i).getFullYear(),new Date(i).getMonth(),new Date(i).getDate()+l),u=new Date(new Date(a).setHours(new Date(r).getHours())),s,h,c;for(u=new Date(new Date(u).setMinutes(new Date(r.getMinutes()))),u>new Date(r)?u=n[this.model.appointmentSettings.endTime]:u.getDay()==6||u.getDay()==7?(e=new Date(new Date(u).setDate(u.getDate()-2)),o=new Date(new Date(u).setDate(u.getDate()-1)),u=new Date(u).getDay()==6?o:e):u=u;f>=new Date(i)&&f<=u&&u<=new Date(r);)appointment=this._addAppData(n,t,f,u,n[this.model.appointmentSettings.id]),this._processed.push(appointment),s=new Date(new Date(u).getFullYear(),new Date(u).getMonth(),new Date(u).getDate()+3),f=new Date(new Date(s).setHours(new Date(i).getHours())),f=new Date(new Date(f).setMinutes(new Date(i).getMinutes())),h=5-f.getDay(),c=new Date(new Date(f).getFullYear(),new Date(f).getMonth(),new Date(f).getDate()+h),u=new Date(new Date(c).setHours(new Date(r).getHours())),u=new Date(new Date(u).setMinutes(new Date(r).getMinutes())),u=u>new Date(r)?n[this.model.appointmentSettings.endTime]:u,t++,this._maxId=t},_multipleWeekSplit:function(n,t,i,r){for(var f=new Date(i),h=6-f.getDay(),c=new Date(new Date(i).getFullYear(),new Date(i).getMonth(),new Date(i).getDate()+h),u=new Date(new Date(c).setHours(new Date(r).getHours())),e,o,s,u=new Date(new Date(u).setMinutes(new Date(r.getMinutes()))),u=u>new Date(r)?n[this.model.appointmentSettings.endTime]:u;f>=new Date(i)&&f<=u&&u<=new Date(r);)appointment=this._addAppData(n,t,f,u,n[this.model.appointmentSettings.id]),this._processed.push(appointment),e=new Date(new Date(u).getFullYear(),new Date(u).getMonth(),new Date(u).getDate()+1),f=new Date(new Date(e).setHours(new Date(i).getHours())),f=new Date(new Date(f).setMinutes(new Date(i).getMinutes())),o=6-f.getDay(),s=new Date(new Date(f).getFullYear(),new Date(f).getMonth(),new Date(f).getDate()+o),u=new Date(new Date(s).setHours(new Date(r).getHours())),u=new Date(new Date(u).setMinutes(new Date(r).getMinutes())),u=u>new Date(r)?n[this.model.appointmentSettings.endTime]:u,t++,this._maxId=t},_deleteOcurrence:function(n,i){var s=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,n),u=new t.DataManager(this._currentAppointmentData).executeLocal(s),e,f,r,o;if(!t.isNullOrUndefined(u)&&!t.isNullOrUndefined(u[0][this.model.appointmentSettings.recurrenceRule])){if(e=u[0][this.model.appointmentSettings.recurrenceRule],this.recurrenceRuleSplit(e),t.isNullOrUndefined(this._rRule.exDate))u[0][this.model.appointmentSettings.recurrenceRule]=e+";EXDATE="+Globalize.format(new Date(i),this._pattern.d);else{for(f=e.split(";"),recurRule="",r=0;r<f.length;r++)recurRule!=""&&(recurRule+=";"),o=f[r].replace(/ /g,"").split("="),o[0]=="EXDATE"&&(f[r]=f[r]+","+Globalize.format(new Date(i),this._pattern.d)),recurRule+=f[r];u[0][this.model.appointmentSettings.recurrenceRule]=recurRule}return u}},_getWeekIndex:function(n){var i=0,t=new Date(n.getFullYear(),n.getMonth(),1),r=n.getDay();if(r!=t.getDay())do t=new Date(t.setDate(t.getDate()+1));while(r!=t.getDay());while(t.getDate()!=n.getDate())t=new Date(t.setDate(t.getDate()+7)),i++;return i},_addAppData:function(n,i,r,u,f){var o={},e,s;for(e in this.model.appointmentSettings)if(e!="dataSource"&&e!="query"&&e!="tableName"&&e!="resourceFields"&&(o[this.model.appointmentSettings[e]]=n[this.model.appointmentSettings[e]]),e=="resourceFields")for(s in!t.isNullOrUndefined(this.model.appointmentSettings.resourceFields)&&this.model.appointmentSettings.resourceFields.split(","))o[this.model.appointmentSettings.resourceFields.split(",")[s]]=n[this.model.appointmentSettings.resourceFields.split(",")[s]];return t.isNullOrUndefined(i)||(o[this.model.appointmentSettings.id]=i),t.isNullOrUndefined(r)||(o[this.model.appointmentSettings.startTime]=r),t.isNullOrUndefined(u)||(o[this.model.appointmentSettings.endTime]=u),t.isNullOrUndefined(f)||(o.ParentId=f),o},_dayOfWeekInMonth:function(n,t,i){for(var u=this._dayNames.indexOf(t),r=i==-1?new Date(n.getFullYear(),n.getMonth()+1,0):new Date(n.getFullYear(),n.getMonth(),1);r.getDay()!=u;)r=new Date(i==-1?r.setDate(r.getDate()-1):r.setDate(r.getDate()+1));return new Date(i==1||i==-1?r:r.setDate(r.getDate()+(i-1)*7))},_weeklyDayFind:function(n,t){var i=n;do i=new Date(i.setDate(i.getDate()+1)),curDay=this._dayNames[new Date(i).getDay()];while(t.indexOf(curDay)==-1);return i},_renderAppointments:function(){var f=this._dateRender,e,o,t,n,u,r,i;for(this._tempapp=[],this.cellwidth=this.element.find(".e-workcells").width(),e=this._currentAppointmentData,this.leftPosition=0,o=this._processed,this._filtered=[],this.model.group||(this.res1=["0"]),this.resIndex=0,t=0;t<this.res1.length;t++)for(n=0,r=f.length,new Date(this._dateRender[0])<this.model.minDate&&(n=Math.floor((new Date(this.model.minDate)-new Date(this._dateRender[0]))/864e5)),new Date(this._dateRender[this._dateRender.length-1])>this.model.maxDate&&(u=Math.floor((new Date(this._dateRender[this._dateRender.length-1])-new Date(this.model.maxDate))/864e5),r=this._dateRender.length-u),n;n<r;n++)for(this._getDayAppointments(n,t),i=0;i<this._appList.length;i++)this._renderApp(this._appList[i],n,t),this._filtered.push(this._appList[i])},_getDayAppointments:function(n,i){var o,f,u,e;if(this._appList=[],o=this._dateRender,f=this._processed,this.model.orientation=="vertical"){for(u=0;u<f.length;u++)if(!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources)this._getMultipleResourceAppList(u,o,f,i,n);else if(e=f[u][this.model.appointmentSettings.allDay],Globalize.format(new Date(f[u][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(o[n]),this._pattern.d)&&Globalize.format(new Date(f[u][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(o[n]),this._pattern.d)&&Globalize.format(new Date(f[u][this.model.appointmentSettings.startTime]),this._pattern.d)==Globalize.format(new Date(f[u][this.model.appointmentSettings.endTime]),this._pattern.d)&&(t.isNullOrUndefined(e)||e==""?!1:e===!0?!0:e.toLowerCase()==="false"?!1:e)===!1&&Globalize.format(new Date(f[u][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(f[u][this.model.appointmentSettings.endTime]),this._pattern.d)){var h=f[u][this.model.appointmentSettings.recurrence]==r||f[u].ParentId==r?this._processed[u].Id:this._processed[u].ParentId,c=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,parseInt(h)),l=this._currentAppointmentData,s=new t.DataManager(l).executeLocal(c);(new Date(s[0][this.model.appointmentSettings.endTime])-new Date(s[0][this.model.appointmentSettings.startTime]))/36e5>24?this._setAllDayPos(f[u],n,i):this._appList.push(f[u])}}else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._getHorizontalDayAppointments(f,o,n,i)},_utc:function(t){this.element.hasClass("startutc")?n(".endutc").val(t.text):n(".startutc").val(t.text)},_rowHandlesOver:function(t){n(t.target).addClass("e-rowcursor")},_colHandlesOver:function(t){n(t.target).addClass("e-columncursor")},_renderApp:function(i,r,u){var a=this.element.find(".e-workcells").height(),v=2,c=parseInt(this.model.startHour)<parseInt(this.model.endHour)?parseInt(this.model.startHour):0,s=parseInt(this.model.startHour)<parseInt(this.model.endHour)?parseInt(this.model.endHour):24,k=this._dateRender,f=i[this.model.appointmentSettings.startTime],e=i[this.model.appointmentSettings.endTime],o,p,d,y,w,g,h,b,nt;if(this.model.orientation=="vertical"){if(f<=e&&(d=new Date(f).getHours()<c?new Date(f).getHours()+-new Date(f).getHours()+-new Date(f).getMinutes():new Date(f).getHours()+-c,y=new Date(e).getHours()>s?new Date(e).getHours()+(-new Date(e).getHours()+(s-c))+-new Date(e).getMinutes():new Date(e).getHours()+-c,y=new Date(e).getHours()==s?new Date(y).getMinutes()+-new Date(e).getMinutes():y,s<=e.getHours()?(w=new Date(e.setHours(s,00,00)),p=parseFloat(new Date(w).getHours()*60+new Date(w).getMinutes()-(new Date(f).getHours()*60+new Date(f).getMinutes()))*a*v/60-3):p=parseFloat(new Date(e).getHours()*60+new Date(e).getMinutes()-(new Date(f).getHours()*60+new Date(f).getMinutes()))*a*v/60-2,g=parseFloat(new Date(f).getMinutes())*a*v/60,this.model.startHour<=new Date(f).getHours())){h=this._overlapApp(i[this.model.appointmentSettings.id],i[this.model.appointmentSettings.startTime],i[this.model.appointmentSettings.endTime],null);b=this;h.length>1?(h.sort(function(n,t){var i=n[b.model.appointmentSettings.startTime],r=t[b.model.appointmentSettings.startTime];return i-r}),nt=h.indexOf(i),o=100/h.length+2,this.currentView()==="day"||this.currentView()=="customview"&&this._renderDays==1?o-=7:o,this.leftPosition=100/h.length*nt+"%"):(this.leftPosition="0",o=95);o=this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()=="customview"&&this._renderDays<=7?o-10+"%":o+"%";var l=this._appointmentColor(i),tt=this.model.appointmentTemplateId?!0:!1,it=this._getUserAppointmentTemplate(i),rt=this.model.timeMode=="12"?Globalize.format(i[this.model.appointmentSettings.startTime],this._pattern.t):Globalize.format(i[this.model.appointmentSettings.startTime],"HH:mm"),ut=this.model.timeMode=="12"?Globalize.format(i[this.model.appointmentSettings.endTime],this._pattern.t):Globalize.format(i[this.model.appointmentSettings.endTime],"HH:mm"),ft=this.appTemplate.render({id:i[this.model.appointmentSettings.id],appHeight:p,rtl:this.model.enableRTL,subject:i[this.model.appointmentSettings.subject],startTime:rt,endTime:ut,left:this.leftPosition,top:g,appWidth:o,userAppTemplId:tt,userTemplate:it,appClass:"e-appointment",appointData:l.appointColor.appointData,appointCustomcss:l.appointColor.appointCustomcss,appointtextcolor:l.appointColor.appointtextcolor,value:l.value,multiDiv:l.multiDiv,orientation:this.model.orientation});n(this.element.find("div.e-appointwrapper")[d*2*k.length*this.res1.length+r+k.length*u]).append(ft)}}else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._renderHorizontalApp(f,e,i,r,a,v,c,s)},_getUserAppointmentTemplate:function(t){var i=n.templates(n(this.model.appointmentTemplateId).html());return i.render(t)},_overlapApp:function(n,i,r,u){var f;if(this.overlapList=[],this.model.orientation=="vertical")for(f=0;f<this._appList.length;f++)new Date(this._appList[f][this.model.appointmentSettings.endTime])>new Date(i)&&new Date(this._appList[f][this.model.appointmentSettings.startTime])<new Date(r)&&Globalize.format(new Date(this._appList[f][this.model.appointmentSettings.startTime]),this._pattern.d)===Globalize.format(new Date(i),this._pattern.d)&&this.overlapList.push(this._appList[f]);else if(this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal)for(f=0;f<this._appList.length;f++)t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)?new Date(this._appList[f][this.model.appointmentSettings.endTime])>new Date(i)&&new Date(this._appList[f][this.model.appointmentSettings.startTime])<new Date(r)&&this._appList[f][this.model.resources[this.model.resources.length-1].field]==u&&Globalize.format(new Date(this._appList[f][this.model.appointmentSettings.startTime]),this._pattern.d)===Globalize.format(new Date(i),this._pattern.d)&&this.overlapList.push(this._appList[f]):new Date(this._appList[f][this.model.appointmentSettings.endTime])>new Date(i)&&new Date(this._appList[f][this.model.appointmentSettings.startTime])<new Date(r)&&Globalize.format(new Date(this._appList[f][this.model.appointmentSettings.startTime]),this._pattern.d)===Globalize.format(new Date(i),this._pattern.d)&&this.overlapList.push(this._appList[f]);return this.overlapList},_renderAllDayAppointments:function(){var a=this.cellwidth-20,f=this._dateRender,u,i,o,e,n;for(this.level=0,this.model.group||(this.res1=["0"]),u=0;u<this.res1.length;u++)for(i=0,e=f.length,new Date(this._dateRender[0])<this.model.minDate&&(i=Math.floor((new Date(this.model.minDate)-new Date(this._dateRender[0]))/864e5)),new Date(this._dateRender[this._dateRender.length-1])>this.model.maxDate&&(o=Math.floor((new Date(this._dateRender[this._dateRender.length-1])-new Date(this.model.maxDate))/864e5),e=this._dateRender.length-o),i;i<e;i++)for(n=0;n<this._processed.length;n++)if(t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)||!t.scheduleFeatures.resources){if(Globalize.format(new Date(f[i]),this._pattern.d)==Globalize.format(new Date(this._processed[n][this.model.appointmentSettings.startTime]),this._pattern.d)&&(this._processed[n][this.model.appointmentSettings.allDay]===!0||(new Date(this._processed[n][this.model.appointmentSettings.endTime])-new Date(this._processed[n][this.model.appointmentSettings.startTime]))/36e5>24)){this._setAllDayPos(this._processed[n],i,u);this._filtered.push(this._processed[n]);var h=this._processed[n][this.model.appointmentSettings.recurrence]==r||this._processed[n].ParentId==r?this._processed[n].Id:this._processed[n].ParentId,c=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,parseInt(h)),l=this._currentAppointmentData,s=new t.DataManager(l).executeLocal(c);new Date(this._processed[n][this.model.appointmentSettings.endTime])<s[0][this.model.appointmentSettings.endTime]&&this.element.find(".e-alldayappointment").children(".e-righthandle").remove();new Date(this._processed[n][this.model.appointmentSettings.startTime])>s[0][this.model.appointmentSettings.startTime]&&this.element.find(".e-alldayappointment").children(".e-lefthandle").remove()}}else this._getMultipleResourceAlldayApp(f,i,u,n)},_getOverlapCount:function(n,i,r,u){var c=r.length,e=this._processed,o=[],f,s,h;if(this.model.orientation=="vertical")for(f=0;f<e.length;f++)Globalize.format(new Date(e[f][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(r[i]),this._pattern.d)&&Globalize.format(new Date(e[f][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(r[i]),this._pattern.d)&&(e[f][this.model.appointmentSettings.allDay]==!0||Globalize.format(new Date(e[f][this.model.appointmentSettings.startTime]),this._pattern.d)<Globalize.format(new Date(e[f][this.model.appointmentSettings.endTime]),this._pattern.d))&&Globalize.format(new Date(e[f][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(e[f][this.model.appointmentSettings.endTime]),this._pattern.d)&&o.push(e[f]);else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(o=this._getHorizontalOverlapCount(e,r,i,n,u));return s=this,o.sort(function(n,t){var i=n[s.model.appointmentSettings.startTime],r=t[s.model.appointmentSettings.startTime];return i-r}),h=o.length>0?o.indexOf(n):0,h==-1?0:h},_setAllDayPos:function(i,r,u){var f=this._getOverlapCount(i,r,this._dateRender,null),e=i[this.model.appointmentSettings.startTime],o=i[this.model.appointmentSettings.endTime],a;if(new Date(e)<=new Date(o)){var h=this._dateRender,v,y=0,c=15,p=15,g=new Date(h[0]),l=new Date(h[h.length-1]);l.setHours(23,59,59);o=new Date(o)>new Date(l)?l:o;var et=Math.ceil((new Date(e)-new Date(g))/864e5),w=Math.ceil((new Date(o)-new Date(e))/864e5),b=this.element.find(".e-alldaycells").width(),k=this.currentView()==="week"?7:this.currentView()==="workweek"?5:this.currentView()=="customview"&&this._renderDays<=7?this._renderDays:1,nt=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.model.group.resources.length:0,d=this.currentView()==="day"?0:this.currentView()==="workweek"?new Date(e).getDay()-1:new Date(e).getDay();y=this.model.enableRTL?this.element.find(".e-headrealldaytable").width()-this.element.find(".e-alldaycells")[d+u*k].offsetLeft-this.element.find(".e-alldaycells").width():this.element.find(".e-alldaycells")[d+u*k].offsetLeft;v=w*b-w*b*(4/100);c=f*c+3*(f+1)+this.element.find(".e-headercells").height()+3+nt*n(n(".e-headerbar")[0]).height();var s=this._appointmentColor(i),tt=this.model.appointmentTemplateId?!0:!1,it=this._getUserAppointmentTemplate(i),rt=this.model.timeMode=="12"?Globalize.format(i[this.model.appointmentSettings.startTime],this._pattern.t):Globalize.format(i[this.model.appointmentSettings.startTime],"HH:mm"),ut=this.model.timeMode=="12"?Globalize.format(i[this.model.appointmentSettings.endTime],this._pattern.t):Globalize.format(i[this.model.appointmentSettings.endTime],"HH:mm"),ft=this.appTemplate.render({id:i[this.model.appointmentSettings.id],top:c,appHeight:p,rtl:this.model.enableRTL,subject:i[this.model.appointmentSettings.subject],startTime:rt,endTime:ut,appWidth:v+"px",allday:!0,left:y+"px",userAppTemplId:tt,userTemplate:it,appClass:"e-alldayappointment",appointData:s.appointColor.appointData,appointCustomcss:s.appointColor.appointCustomcss,appointtextcolor:s.appointColor.appointtextcolor,value:s.value,multiDiv:s.multiDiv,orientation:this.model.orientation});this.level<f&&(a=(f+1)*(p+3)+3,this.element.find(".e-alldaycells").css("height",a+"px"),this.element.find(".e-emptyalldaytd").css("height",a+"px"));this.element.find(".e-headrealldaytable").append(ft);this.level=this.level<f?f:this.level}f>0&&this._reRenderScroller()},_reRenderScroller:function(){var n=this.element.find(".e-scroller").data("ejScroller");n.model.width=this.element.width()-this.element.find(".e-workleftindent").width();n.model.height=this.scHeight-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top);n.refresh();var u=this.currentView()==="month"||this._isCustomView()?0:4,i=this.currentView()=="workweek"?5:this.currentView()=="day"?1:this.currentView()=="customview"&&this._renderDays<=7?this._renderDays:7,r=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1.length*i:i;this.element.find(".e-draggableworkarea").width(this.scWidth>parseInt(this.model.cellWidth)*r+this.element.find(".e-scrolltimecells").width()+18?parseInt(this.model.cellWidth)*r:this.scWidth-this.element.find(".e-scrolltimecells").width()+u-18)},_renderMonthAppointment:function(){var f,u,h,o,n,e;this.filterData=[];var s=[],r=this.model.orientation=="vertical"?this._dateRender:this.monthDays,i=this._processed;for(this.model.group||(this.res1=["0"]),f=0;f<this.res1.length;f++)for(u=0,o=r.length,new Date(r[0])<this.model.minDate&&(u=Math.floor((new Date(this.model.minDate)-new Date(r[0]))/864e5)),new Date(r[r.length-1])>this.model.maxDate&&(h=Math.floor((new Date(r[r.length-1])-new Date(this.model.maxDate))/864e5),o=r.length-h),u;u<o;u++){for(this.filterData=[],n=0;n<i.length;n++)t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)||!t.scheduleFeatures.resources?i[n][this.model.appointmentSettings.allDay]==!0||(new Date(i[n][this.model.appointmentSettings.endTime])-new Date(i[n][this.model.appointmentSettings.startTime]))/36e5>24?Globalize.format(new Date(r[u]),this._pattern.d)==Globalize.format(new Date(i[n][this.model.appointmentSettings.startTime]),this._pattern.d)&&Globalize.format(new Date(r[u]),this._pattern.S)<=Globalize.format(new Date(i[n][this.model.appointmentSettings.endTime]),this._pattern.S)&&Globalize.format(new Date(i[n][this.model.appointmentSettings.startTime]),this._pattern.S)<=Globalize.format(new Date(i[n][this.model.appointmentSettings.endTime]),this._pattern.S)&&this.filterData.push(i[n]):Globalize.format(new Date(r[u]),this._pattern.d)==Globalize.format(new Date(i[n][this.model.appointmentSettings.startTime]),this._pattern.d)&&Globalize.format(new Date(r[u]),this._pattern.d)<=Globalize.format(new Date(i[n][this.model.appointmentSettings.endTime]),this._pattern.d)&&Globalize.format(new Date(i[n][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(i[n][this.model.appointmentSettings.endTime]),this._pattern.d)&&this.filterData.push(i[n]):this._getMonthAppList(r,u,i,n,f);for(e=0;e<this.filterData.length;e++)this._renderAppointmentMonth(this.filterData[e],u,f),s.push(this.filterData[e])}this.model.enableAppointmentNavigation&&this._nextPrevButton(s)},_wireResizeEvents:function(){this.model.enableAppointmentResize&&!this.model.readOnly&&(this._on(this.element.find("div.e-lefthandle,div.e-righthandle,div.e-tophandle,div.e-bottomhandle"),"mousedown",n.proxy(this._appointmentResizeStart,this)),this._on(this.element.find("div.e-lefthandle,div.e-righthandle"),"mouseover",n.proxy(this._colHandlesOver,this)),this._on(this.element.find("div.e-tophandle,div.e-bottomhandle"),"mouseover",n.proxy(this._rowHandlesOver,this)))},_unWireResizeEvents:function(){this.model.enableAppointmentResize&&(this._off(this.element.find("div.e-lefthandle,div.e-righthandle,div.e-tophandle,div.e-bottomhandle"),"mousedown",n.proxy(this._appointmentResizeStart,this)),this._off(this.element.find("div.e-lefthandle,div.e-righthandle"),"mouseover",n.proxy(this._colHandlesOver,this)),this._off(this.element.find("div.e-tophandle,div.e-bottomhandle"),"mouseover",n.proxy(this._rowHandlesOver,this)))},_getIndex:function(n,i,r,u,f){var s=this,h,o,e;for(u.sort(function(n,t){var i=n[s.model.appointmentSettings.startTime],r=t[s.model.appointmentSettings.startTime];return i-r}),h=r.length,o=[],e=0;e<u.length;e++)this.model.orientation=="horizontal"&&t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)?Globalize.format(new Date(u[e][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(r[n]),this._pattern.d)&&Globalize.format(new Date(u[e][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(r[n]),this._pattern.d)&&u[e][this.model.resources[this.model.resources.length-1].field]==f&&Globalize.format(new Date(u[e][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(u[e][this.model.appointmentSettings.endTime]),this._pattern.d)&&o.push(u[e]):Globalize.format(new Date(u[e][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(r[n]),this._pattern.d)&&Globalize.format(new Date(u[e][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(r[n]),this._pattern.d)&&Globalize.format(new Date(u[e][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(u[e][this.model.appointmentSettings.endTime]),this._pattern.d)&&o.push(u[e]);return this.overlapList=o,o.length>0?o.indexOf(i):0},_renderAppointmentMonth:function(i,r){var c=this.model.orientation=="vertical"?this._dateRender:this.monthDays,g=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this._getIndex(r,i,c,this._processed,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):this._getIndex(r,i,c,this._processed,null),l=new Date(i[this.model.appointmentSettings.startTime]),p=new Date(i[this.model.appointmentSettings.endTime]),a=18,v,s=0,w,f,it,rt,u,b,d,ut;this.leftPosition=0;this.CellWidth=this.model.orientation=="vertical"?this.element.find(".e-monthcells").width():this.element.find(".e-workcells").width();this.CellHeight=this.model.orientation=="vertical"?this.element.find(".e-monthcells").height():this.element.find(".e-workcells").height();var nt=Globalize.format(l,this._pattern.d),y=Globalize.format(p,this._pattern.d),tt=new Date(c[c.length-1]);if(y=new Date(y)>new Date(tt)?tt:y,w=7-new Date(nt).getDay(),f=Math.ceil((new Date(y)-new Date(nt))/864e5)+1,l<=p){this.model.orientation=="vertical"?(f=f>=w?w:f,it=Math.ceil((r+1)/7),v=Globalize.format(l,this._pattern.d)!=Globalize.format(p,this._pattern.d)?f*this.CellWidth-15-f:this.CellWidth*6/7):v=f*this.CellWidth;rt=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this._findResourceIndex(this.res1,this.model.resources[this.model.resources.length-1].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):0;u=this.model.orientation=="vertical"?rt*7+(new Date(l).getDay()+1)+(it-1)*this.res1.length*7:r+1;s=g*a;this.leftPosition=0;t.isNullOrUndefined(this.model.resources)||(b=this._getResourceCollection());var e=!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1?this._findResourceIndex(b[0].dataSource,b[0].id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-2]])+1:0,o=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this._findResourceIndex(this.level_Resources,this.model.resources[this.model.resources.length-1].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]])+1:1,h=this._appointmentColor(i);if(g*(a+21)<this.CellHeight){a-=2;s>1&&(s-=1);this.leftPosition>1&&(this.leftPosition-=1);var ft=this.model.appointmentTemplateId?!0:!1,et=this._getUserAppointmentTemplate(i),ot=this.model.timeMode=="12"?Globalize.format(i[this.model.appointmentSettings.startTime],this._pattern.t):Globalize.format(i[this.model.appointmentSettings.startTime],"HH:mm"),st=this.model.timeMode=="12"?Globalize.format(i[this.model.appointmentSettings.endTime],this._pattern.t):Globalize.format(i[this.model.appointmentSettings.endTime],"HH:mm"),k=this.appTemplate.render({id:i[this.model.appointmentSettings.id],appHeight:a,rtl:this.model.enableRTL,subject:i[this.model.appointmentSettings.subject],startTime:ot,endTime:st,left:this.leftPosition+"px",top:s,appWidth:v+"px",userAppTemplId:ft,userTemplate:et,appClass:"e-monthappointment",appointData:h.appointColor.appointData,appointCustomcss:h.appointColor.appointCustomcss,appointtextcolor:h.appointColor.appointtextcolor,value:h.value,multiDiv:h.multiDiv});this.model.orientation=="vertical"?n(this.element.find("div.e-appointwrapper")[u-1]).append(k):this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(n(n(this.element.find(".e-workcellstab tr")[o+e-1]).find("div.e-appointwrapper")[u-1]).append(k),!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>0&&(d=this._getResourceColor(i),ut=d.appointData==""?"e-categorycolor":"",n(n(n(this.element.find(".e-workcellstab tr").find("td.e-resourceheadercells")).parent()[e-1]).find("div.e-appointwrapper")[u-1]).append("<div class='e-categorybar "+ut+"' id='categorybar_'"+i[this.model.appointmentSettings.id]+" style='position:absolute;height:"+(this.CellHeight-3)+"px;background:"+d.appointData+";width:"+(v+1)+"px;left:"+this.leftPosition+"px;'><\/div>")));k=""}else n("#"+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(o+e-1)+"_"+(u-1)).length==0&&(this.model.orientation=="vertical"?n(this.element.find("div.e-appointwrapper")[u-1]).append('<div id="'+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(o+e-1)+"_"+(u-1)+'" class="e-icon e-appsoverflow"><\/div>'):n(n(this.element.find(".e-workcellstab tr")[o+e-1]).find("div.e-appointwrapper")[u-1]).append('<div id="'+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(o+e-1)+"_"+(u-1)+'" class="e-icon e-appsoverflow"><\/div>'),this.element.find("#"+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(o+e-1)+"_"+(u-1)).css(this.model.enableRTL?"right":"left",this.CellWidth+this.leftPosition-25+"px").css("top",s+"px"))}},_quickWindowClose:function(){this._quickAppointWindow.ejDialog("close");this._processFocus()},_appointmentWindow:function(i){var c={startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,target:i},u,f,r=t.isNullOrUndefined(i.target)?n(i):n(i.target),v,s,h,e,o,y;if(this._trigger("cellDoubleClick",c)||r.hasClass("e-categorybar"))return!1;if((r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells")||this._cellClick||r.hasClass("e-detailedapp"))&&!r.hasClass("e-resourceheadercells")){this._currentAction=t.Schedule.Actions.Add;this._appointmentAddWindow.find(".e-recurwindow").css("display","none");this._appointmentAddWindow.find(".e-appwindow").css("display","block");var l=this._cellIndex,p=this.model.orientation=="horizontal"&&this.model.currentView=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,a=new Date(p[l]);if(this.model.minDate>a||this.model.maxDate<a||(this._cellClick?(u=new Date(this.cur_StartTime),f=new Date(this.cur_EndTime)):(this.currentDate(new Date(this.dateRender[l])),r.hasClass("e-workcells")?(v=this.model.startHour+r.parent().index()/2,s=v.toString().split("."),u=new Date(this.currentDate()).setHours(parseInt(s[0]),parseInt(s[1])==5?30:00),f=new Date(new Date(u).setMinutes(new Date(u).getMinutes()+30))):r.hasClass("e-monthcells")?(u=new Date(new Date(this.currentDate()).setHours(9)),u=new Date(u).setMinutes(00),f=new Date(new Date(u).setMinutes(30))):(u=new Date(this.currentDate()),f=new Date(u),this._appointmentAddWindow.find(".allday ").ejCheckBox({checked:!0}))),this._trigger("appointmentWindowOpen",c)))return!1;this._appointmentAddWindow.find("#"+this._id+"subject").val(this.model.showQuickWindow?this._quickAppointWindow.find(".subject").val():"");this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option",{value:Globalize.format(new Date(u),this._datepattern()),minDate:this.model.minDate,maxDate:this.model.maxDate});this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option",{value:Globalize.format(new Date(f),this._datepattern()),minDate:this.model.minDate,maxDate:this.model.maxDate});this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(new Date(u),this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(new Date(f),this._pattern.t));(n(i.currentTarget).hasClass("e-alldaycells")||this.currentView()=="month"||this._isCustomView())&&this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0});this._alldayCheck();this.model.timeZone==null?(document.getElementById("startutc").value="UTC "+Globalize.format(new Date,"zzz"),document.getElementById("endutc").value="UTC "+Globalize.format(new Date,"zzz")):(document.getElementById("startutc").value=this.model.timeZone,document.getElementById("endutc").value=this.model.timeZone);t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._renderResourceData(r,this._cellIndex);this.model.readOnly||this._appointmentAddWindow.ejDialog("open");this._appointmentAddWindow.find(".subject").focus();this._cellClick=!1}else r.hasClass("e-resourceheadercells")||(h=this._editKey?n(i):r.hasClass("e-appointment")||r.hasClass("e-monthappointment")||r.hasClass("e-alldayappointment")?r:r.parents(".e-monthappointment,.e-appointment,.e-alldayappointment"),t.isNullOrUndefined(h[0].id)||(this._currentAction=t.Schedule.Actions.Save,this._appId=parseInt(h[0].id.split("_")[1]),o=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),e=new t.DataManager(this._processed).executeLocal(o),e[0][this.model.appointmentSettings.recurrence]==1?(this._parentId=e[0].ParentId,this._recurEditWindow.find(".e-editonly").ejRadioButton({checked:!0}),this._recurEditWindow.ejDialog("open"),this._recurEditWindow.focus()):((e[0][this.model.appointmentSettings.allDay]||(e[0][this.model.appointmentSettings.endTime]-e[0][this.model.appointmentSettings.startTime])/36e5>24)&&(o=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),y=new t.DataManager(this._processed).executeLocal(o),this._appId=y[0].ParentId),this._showAppointmentDetails(this._appId)),this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close")),this._editKey=!1);this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")},_editRecurrence:function(){this._appointmentAddWindow.find(".e-appwindow").toggle();this._appointmentAddWindow.find(".e-recurwindow").css("margin-left",700).toggle().animate({"margin-left":10},300)},_showAppointmentDetails:function(n,i){var o=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,parseInt(n)),s=i==!0?this._processed:this._currentAppointmentData,r=new t.DataManager(s).executeLocal(o),u,f,e;if(this._appointmentAddWindow.find(".subject").val(r[0][this.model.appointmentSettings.subject]),this._appointmentAddWindow.find(".id").val(r[0][this.model.appointmentSettings.id]),this._appointmentAddWindow.find(".e-description").val(r[0][this.model.appointmentSettings.description]?r[0][this.model.appointmentSettings.description]:""),u=r[0],this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",Globalize.format(u[this.model.appointmentSettings.startTime],this._datepattern())),this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",Globalize.format(u[this.model.appointmentSettings.endTime],this._datepattern())),this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(u[this.model.appointmentSettings.startTime],this._pattern.t)),this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(u[this.model.appointmentSettings.endTime],this._pattern.t)),this.model.timeZone==null?(this._appointmentAddWindow.find("#startutc").val("UTC "+Globalize.format(u[this.model.appointmentSettings.startTime],"zzz")),this._appointmentAddWindow.find("#endutc").val("UTC "+Globalize.format(u[this.model.appointmentSettings.endTime],"zzz"))):(this._appointmentAddWindow.find("#startutc").val(this.model.timeZone),this._appointmentAddWindow.find("#endutc").val(this.model.timeZone)),r[0][this.model.appointmentSettings.allDay]==1&&this._appointmentAddWindow.find(".allday ").ejCheckBox({checked:!0}),r[0][this.model.appointmentSettings.recurrence]==1&&(i==!0?(t.isNullOrUndefined(r[0][this.model.appointmentSettings.recurrenceRule])||r[0][this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")==-1||(this._currentAction=t.Schedule.Actions.Save),this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0,enabled:!1}),this._appointmentAddWindow.find(".e-repeatlbl").addClass("e-disable"),this._appointmentAddWindow.find("#"+this._id+"summary").css("display","none"),this._appointmentAddWindow.find(".e-recurFinalRule").html(""),this._recRule=r[0][this.model.appointmentSettings.recurrenceRule]):(this.recurrenceRuleSplit(r[0][this.model.appointmentSettings.recurrenceRule]),this._appointmentAddWindow.find(".recurstartdate").ejDatePicker({value:Globalize.format(u[this.model.appointmentSettings.startTime],this._datepattern())}),this._appointmentAddWindow.find("#"+this._id+"summary").css("display","table-row"),this._appointmentAddWindow.find(".e-recurFinalRule").html(this._showRecurrenceFields(n)),this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0}),this._appointmentAddWindow.find(".e-recuredit").css("display","inline"))),this.model.categorizeSettings.enable&&!t.isNullOrUndefined(u[this.model.appointmentSettings.categorize])&&this._showCategorizeDetails(u),!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources&&this._showMultipleResourceDetails(u),f={appointment:r[0],edit:i},this._trigger("appointmentWindowOpen",f))return!1;this._alldayCheck();e=this.model.readOnly?"disable":"enable";this._appointmentAddWindow.find(".e-appsave,#donerecur").ejButton(e,!0);this._appointmentAddWindow.ejDialog("open");this._appointmentAddWindow.find(".subject").focus()},_showRecurrenceFields:function(){var n="",i="",f=this._appointmentAddWindow.find(".recurtype"),u,r;n=t.isNullOrUndefined(this._rRule.interval)?this._getLocalizedLabels("Every")+" ":this._getLocalizedLabels("Every")+" "+this._rRule.interval+" ";switch(this._rRule.freq){case"DAILY":f.ejDropDownList({selectedItemIndex:0});n+=this._getLocalizedLabels("RecurrenceDay").toLowerCase();break;case"WEEKLY":for(f.ejDropDownList({selectedItemIndex:1}),this._appointmentAddWindow.find(".weekdays").ejCheckBox({checked:!1}),u=this._rRule.weekDays.split(","),r=0;r<u.length;r++)this._appointmentAddWindow.find(".e-weekly"+u[r]).ejCheckBox({checked:!0}),i+=this._dayShortNames[this._dayNames.indexOf(u[r])]+(r==u.length-1?"":", ");n+=this._getLocalizedLabels("RecurrenceWeek").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+i;break;case"MONTHLY":f.ejDropDownList({selectedItemIndex:2});t.isNullOrUndefined(this._rRule.monthDay)?(this._appointmentAddWindow.find(".e-monthposition").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-monthsrtday").ejDropDownList({selectedItemIndex:this._dayNames.indexOf(this._rRule.weekDays)}),this._appointmentAddWindow.find(".monthsrt").ejDropDownList({selectedItemIndex:this._rRule.setPositions-1}),i=this._appointmentAddWindow.find(".monthsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[this._dayNames.indexOf(this._rRule.weekDays)]):(this._appointmentAddWindow.find(".e-monthdaytype").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-monthdate").ejNumericTextbox({value:parseInt(this._rRule.monthDay)}),i=parseInt(this._rRule.monthDay));n+=this._getLocalizedLabels("RecurrenceMonth").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+i;break;case"YEARLY":f.ejDropDownList({selectedItemIndex:3});t.isNullOrUndefined(this._rRule.monthDay)?(this._appointmentAddWindow.find(".e-yearrecurposi").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".yearsrtday").ejDropDownList({selectedItemIndex:this._dayNames.indexOf(this._rRule.weekDays)}),this._appointmentAddWindow.find(".yearsrtmonth").ejDropDownList({selectedItemIndex:this._rRule.month-1}),this._appointmentAddWindow.find(".yearsrt").ejDropDownList({selectedItemIndex:this._rRule.setPositions-1}),i=this._appointmentAddWindow.find(".yearsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[this._dayNames.indexOf(this._rRule.weekDays)]+" "+this._monthNames[this._rRule.month-1]):(this._appointmentAddWindow.find(".e-yearrecurday").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".yearmonth").ejDropDownList({selectedItemIndex:this._rRule.month-1}),this._appointmentAddWindow.find(".yeardate").ejNumericTextbox({value:parseInt(this._rRule.monthDay)}),i=this._monthNames[this._rRule.month-1]+" "+parseInt(this._rRule.monthDay));n+=this._getLocalizedLabels("RecurrenceYear").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+i}return this._appointmentAddWindow.find(".e-recurevery").ejNumericTextbox({value:t.isNullOrUndefined(this._rRule.interval)?1:this._rRule.interval}),t.isNullOrUndefined(this._rRule.count)?t.isNullOrUndefined(this._rRule.until)?this._appointmentAddWindow.find(".e-recurnoend").ejRadioButton({checked:!0}):(this._appointmentAddWindow.find(".e-recuruntil").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-until").ejDatePicker({value:new Date(this._rRule.until)}),n+=" "+this._getLocalizedLabels("Until").toLowerCase()+" "+Globalize.format(new Date(this._rRule.until),this._datepattern())):(this._appointmentAddWindow.find(".e-recurafter").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-recurcount").ejNumericTextbox({value:this._rRule.count}),n+=", "+this._rRule.count+this._getLocalizedLabels("Times").toLowerCase()),n},_closerecur:function(t){var i,a,c,u,f,w,r,s,h,p,l,o,b,k;if(t.model.text=="Cancel")this._appointmentAddWindow.find(".e-recurFinalRule").html()==""&&this._appointmentAddWindow.find("#"+this._id+"recurrence").ejCheckBox({checked:!1});else{c="";u="";i=this._findInterval(this._appointmentAddWindow.find(".e-recurevery"));switch(this._rRuleFreq){case"DAILY":this._recRule="FREQ="+this._rRuleFreq+";INTERVAL="+i;break;case"WEEKDAYS":this._recRule="FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR";break;case"WEEKLY":var v=this._appointmentAddWindow.find("input[name='weekdays']"),e="",y="";for(f=0;f<v.length;f++)n(v[f]).ejCheckBox("option","checked")==!0?e+=(e!=""?",":"")+this._dayNames[f].toUpperCase():"",n(v[f]).ejCheckBox("option","checked")==!0?y+=(y!=""?", ":"")+this._dayShortNames[f]:"";e==""&&(o=this._appointmentAddWindow.find(".recurstartdate").ejDatePicker("option","value"),e=this._dayNames[o.getDay()].toUpperCase());w=this._getLocalizedLabels("RecurrenceWeek").toLowerCase()+" on "+y;this._appointmentAddWindow.find(".e-recurRule").html(w);this._recRule="FREQ="+this._rRuleFreq+";INTERVAL="+i+";BYDAY="+e;break;case"MONTHLY":this._appointmentAddWindow.find(".e-monthdaytype").ejRadioButton("option","checked")?(a=this._appointmentAddWindow.find(".e-monthdate").ejNumericTextbox("option","value"),this._recRule="FREQ="+this._rRuleFreq+";BYMONTHDAY="+a+";INTERVAL="+i,u=" "+this._getLocalizedLabels("On").toLowerCase()+" "+a):(r=this._appointmentAddWindow.find(".monthsrt").ejDropDownList("option","selectedItemIndex"),s=this._appointmentAddWindow.find(".e-monthsrtday").ejDropDownList("option","selectedItemIndex"),r=r<4?r+1:-1,this._recRule="FREQ="+this._rRuleFreq+";BYDAY="+this._dayNames[s]+";BYSETPOS="+r+";INTERVAL="+i,u=" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._appointmentAddWindow.find(".monthsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[s]);break;case"YEARLY":if(this._appointmentAddWindow.find("#"+this._id+"yearday").ejRadioButton("option","checked"))h=this._appointmentAddWindow.find(".yearmonth").ejDropDownList("option","selectedItemIndex"),p=this._findInterval(this._appointmentAddWindow.find(".yeardate")),this._recRule="FREQ="+this._rRuleFreq+";BYMONTHDAY="+p+";BYMONTH="+(h+1)+";INTERVAL="+i,u=" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._monthNames[h]+" "+p;else{var r=this._appointmentAddWindow.find(".yearsrt").ejDropDownList("option","selectedItemIndex"),h=this._appointmentAddWindow.find(".yearsrtmonth").ejDropDownList("option","selectedItemIndex"),s=this._appointmentAddWindow.find(".yearsrtday").ejDropDownList("option","selectedItemIndex");r=r<4?r+1:-1;this._recRule="FREQ="+this._rRuleFreq+";BYDAY="+this._dayNames[s]+";BYMONTH="+(h+1)+";BYSETPOS="+r+";INTERVAL="+i;u=" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._appointmentAddWindow.find(".yearsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[s]+" "+this._monthNames[h]}}this._appointmentAddWindow.find(".e-recurafter").ejRadioButton("option","checked")?(l=this._findInterval(this._appointmentAddWindow.find(".e-recurcount")),this._recRule+=";COUNT="+l,c=l?", "+l+" "+this._getLocalizedLabels("Times"):", "):this._appointmentAddWindow.find(".e-recuruntil").ejRadioButton("option","checked")&&(o=Globalize.format(new Date(this._appointmentAddWindow.find(".e-until").ejDatePicker("option","value")),this._pattern.d),this._recRule+=";UNTIL="+o,c=" "+this._getLocalizedLabels("Until").toLowerCase()+" "+o);b=(this._rRuleFreq!="WEEKDAYS"?this._getLocalizedLabels("Every"):"")+" "+(i>1?i+" ":"");k=b+this._appointmentAddWindow.find(".e-recurRule").html()+u+c;this._appointmentAddWindow.find("#"+this._id+"summary").css("display","table-row");this._appointmentAddWindow.find(".e-recurFinalRule").html(k);this._appointmentAddWindow.find(".e-recuredit").css("display","inline");u=""}this._appointmentAddWindow.find(".e-recurwindow").toggle();this._appointmentAddWindow.find(".e-appwindow").css("margin-left",700).toggle().animate({"margin-left":10},300);this._appointmentAddWindow.find(".done").focus()},_recurDateChange:function(n){this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",n.value);this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",n.value)},_findInterval:function(n){var i;return i=n.ejNumericTextbox("option","value"),t.isNullOrUndefined(i)?0:i},_cancel:function(){this._appointmentAddWindow.ejDialog("close")},_timeChange:function(i){var r,u;if(this._currentAction!=t.Schedule.Actions.Add)return!1;r=this._appointmentAddWindow.find("#"+this._id+"starttime").data("ejTimePicker");r.showDropdown&&r._id==this._id+"starttime"&&(u=n("#"+this._id+"starttime_popup").find("li.e-active").next("li").html(),document.getElementById(this._id+"endtime").value=t.isNullOrUndefined(u)?i.value:u)},_renderControls:function(){var i=this._appointmentAddWindow;i.find(".allday").ejCheckBox({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass,change:n.proxy(this._alldayCheck,this)});i.find(".startenddate").ejDatePicker({enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,dateFormat:this.model.dateFormat,cssClass:this.model.cssClass});i.find(".startendtime").ejTimePicker({enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,change:n.proxy(this._timeChange,this),cssClass:this.model.cssClass,timeFormat:this.model.timeMode=="12"?this._pattern.t:"HH:mm"});i.find(".startutc").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:this.model.timezoneCollection,fields:{text:"text",value:"value"},width:"100%",change:this._utc,cssClass:this.model.cssClass});i.find(".endutc").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:this.model.timezoneCollection,fields:{text:"text",value:"value"},width:"100%",change:this._utc,cssClass:this.model.cssClass});!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources&&this._renderAppWindowResources(i);this.model.categorizeSettings.enable&&this._renderCategoryItems(i);i.find(".recurrence").ejCheckBox({enableRTL:this.model.enableRTL,change:n.proxy(this._repeat,this),cssClass:this.model.cssClass});i.find(".e-btndone").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._saveAppointment,this),cssClass:this.model.cssClass});i.find(".cancel").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._cancel,this),cssClass:this.model.cssClass});i.find(".recurtype").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"recurtypelist",width:"100%",select:n.proxy(this._recurtype,this),cssClass:this.model.cssClass});i.find(".dailyrecurtype").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-dailyeveryday").ejRadioButton({enableRTL:this.model.enableRTL,checked:!0,cssClass:this.model.cssClass});i.find(".everydaycount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"everydaycount",minValue:1,value:1,width:"100px",float:"left",cssClass:this.model.cssClass});i.find(".recurends").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-recurcount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"dailyoccurance",minValue:1,value:10,width:"65px",cssClass:this.model.cssClass,change:n.proxy(this._endAfterChange,this)});i.find(".weekcount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"weekcount",minValue:1,value:1,width:"100px",cssClass:this.model.cssClass});i.find(".e-recurevery").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"recurevery",minValue:1,value:1,width:"100px",cssClass:this.model.cssClass});i.find(".weekdays").ejCheckBox({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-monthposition").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-monthdaytype").ejRadioButton({enableRTL:this.model.enableRTL,checked:!0,cssClass:this.model.cssClass});i.find(".e-monthdate").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"monthdate",minValue:1,maxValue:31,value:1,width:"70px",cssClass:this.model.cssClass,change:n.proxy(this._monthDateChange,this)});i.find(".monthnumber").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"monthnumber",minValue:1,value:1,width:"70px",cssClass:this.model.cssClass});i.find(".yearcount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"yearcount",minValue:1,value:1,width:"50px",cssClass:this.model.cssClass});i.find(".e-yearrecurposi,.e-yearrecurday").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".yeardate").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"yeardate",minValue:1,maxValue:31,value:1,width:"70px",cssClass:this.model.cssClass,change:n.proxy(this._yearDateChange,this)});i.find(".recurbutton").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._closerecur,this),cssClass:this.model.cssClass});i.find(".monthsrt").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"monthsrtlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._monthDayChange,this)});i.find(".e-monthsrtday").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"monthsrtdaylist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._monthDayChange,this)});i.find(".yearsrt").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearsrtlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDayChange,this)});i.find(".yearmonth").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearmonthlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDateChange,this)});i.find(".yearsrtday").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearsrtdaylist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDayChange,this)});i.find(".yearsrtmonth").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearsrtmonthlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDayChange,this)});i.find(".recurstartdate").ejDatePicker({enableRTL:this.model.enableRTL,locale:this.model.locale,cssClass:this.model.cssClass,dateFormat:this.model.dateFormat,change:n.proxy(this._recurDateChange,this)});i.find(".e-until").ejDatePicker({enableRTL:this.model.enableRTL,locale:this.model.locale,cssClass:this.model.cssClass,dateFormat:this.model.dateFormat,change:n.proxy(this._endOnChange,this)})},_renderCategoryItems:function(n){this.model.categorizeSettings.allowMultiple?n.find(".e-categorizevalue").ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:"visualmode",dataSource:this.model.categorizeSettings.dataSource,fields:{text:"text",value:"color",key:"id",fontColor:"fontColor"},template:this._categorizeTemplate}):n.find(".e-categorizevalue").ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:"none",dataSource:this.model.categorizeSettings.dataSource,fields:{text:"text",value:"color",key:"id",fontColor:"fontColor"},template:this._categorizeTemplate})},_appointmentColor:function(n){var i=this.model.categorizeSettings.enable&&!t.isNullOrUndefined(n[this.model.appointmentSettings.categorize])&&n[this.model.appointmentSettings.categorize]!=""?this._getCategorizeColor(n):!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources?this._getResourceColor(n):{appointData:"",appointCustomcss:"",appointtextcolor:""};if(this.model.categorizeSettings.enable&&this.model.categorizeSettings.allowMultiple&&!t.isNullOrUndefined(n[this.model.appointmentSettings.categorize]))var f=n[this.model.appointmentSettings.categorize].split(","),e=f.length,r=e>1?!0:!1,u=this._categorizeMultipleDiv(n,f,e);return!t.isNullOrUndefined(u)&&i.appointData.length>0&&this.model.categorizeSettings.allowMultiple?{appointColor:i,value:r,multiDiv:u}:i.appointData.length>0&&!this.model.categorizeSettings.allowMultiple||!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources?{appointColor:i}:(appointData="",appointCustomcss="",appointtextcolor="",r="",i="",{appointColor:i,value:r,multiDiv:u})},_categorizeMultipleDiv:function(n,r,u){var o=[],f,e;for(i=0;i<=u-1;i++)if(i!=u-1){if(f=this.model.categorizeSettings,e=this._findResourceIndex(f.dataSource,"id",parseInt(r[i])),t.isNullOrUndefined(e))return n[this.model.appointmentSettings.categorize]="",null;o.push({text:f.dataSource[e][f.text],value:f.dataSource[e][f.color],key:f.dataSource[e][f.id],fontColor:f.dataSource[e][f.fontColor]})}return this._categorizeMultipleTemplate.render({renderData:o})},_getResCategorySaveData:function(n,i,r,u,f,e,o){var v=[],h,k,d,w,l,b,a,p,s,c;if(h=this._addAppData(r,u,new Date(f.StartDate.setHours(parseInt(e[0]),parseInt(e[1]))),new Date(f.EndDate.setHours(parseInt(o[0]),parseInt(o[1]))),u),n.length>0){for(w=n[n.length-1].length-1,l="",s=0;s<=w;s++)b=n[n.length-1][s].id,l=s!=w?l+b.toString()+",":l+b.toString();h[this.model.appointmentSettings.categorize]=l}if(i.length>0){var g=h[this.model.appointmentSettings.categorize],c=this.model.appointmentSettings.resourceFields.toString().split(","),y=this._getResourceCollection();if(i[i.length-1].length>0)for(a=0;a<i[i.length-1].length;a++){for(h=this._addAppData(r,u,new Date(f.StartDate.setHours(parseInt(e[0]),parseInt(e[1]))),new Date(f.EndDate.setHours(parseInt(o[0]),parseInt(o[1]))),u),h[this.model.appointmentSettings.categorize]=g,i[i.length-1].length>1&&(r[this.model.appointmentSettings.id]=u,u++),h[c[c.length-1]]=i[c.length-1][a].value,p=i[c.length-1][a].value,s=c.length-1;s>0;s--)k=this.render_Resources[s]instanceof t.DataManager?this.render_Resources[s]:t.DataManager(this.render_Resources[s]),query=(new t.Query).where(y[s].id,t.FilterOperators.equal,p),appointId=k.executeLocal(query),d=this.render_Resources[s-1]instanceof t.DataManager?this.render_Resources[s-1]:t.DataManager(this.render_Resources[s-1]),query1=(new t.Query).where(y[s-1].id,t.FilterOperators.equal,appointId[0][y[s].groupId]),appointGroupId=d.executeLocal(query1),p=appointGroupId[0][y[s-1].id],h[c[s-1]]=p;v.push(h)}else{if(c=this.model.appointmentSettings.resourceFields.toString().split(","),h=this._addAppData(r,u,new Date(f.StartDate.setHours(parseInt(e[0]),parseInt(e[1]))),new Date(f.EndDate.setHours(parseInt(o[0]),parseInt(o[1]))),u),h[this.model.appointmentSettings.categorize]=g,c.length>1)for(s=0;s<c.length;s++)h[c[s]]=this.model.resources[s].resourceSettings.dataSource[0].id;else h[c[c.length-1]]=this.model.resources[0].resourceSettings.dataSource[0].id;v.push(h)}}return i.length==0&&n.length>0&&v.push(h),v},_showCategorizeDetails:function(n){var t=n[this.model.appointmentSettings.categorize].split(",");for(i=0;i<t.length;i++)this._appointmentAddWindow.find(".e-categorizevalue").data("ejAutocomplete").selectValueByKey(parseInt(t[i]))},_renderCategorizeTemplate:function(){t.isNullOrUndefined(this.model.categorizeSettings)||(this._categorizeTemplate="<div class='e-categorizeTemplate' style='height:15px;margin-right:5px;margin-top:3px;float:left;width:15px;background-color: ${color}'><\/div> <div>${text}<\/div>")},_getCategorizeColor:function(n){var r=null,u="",e="",f="",o=n[this.model.appointmentSettings.categorize].split(","),s=o.length-1,i=this.model.categorizeSettings;return(r=this._findResourceIndex(i.dataSource,"id",parseInt(o[s])),t.isNullOrUndefined(r))?(n[this.model.appointmentSettings.categorize]="",{appointData:u,appointCustomcss:e,appointtextcolor:f}):(u=t.isNullOrUndefined(i.dataSource[r][i.color])?u:i.dataSource[r][i.color],f=t.isNullOrUndefined(i.dataSource[r][i.fontColor])?f:i.dataSource[r][i.fontColor],{appointData:u,appointCustomcss:e,appointtextcolor:f})},_currentDateFormat:function(i){if(t.isNullOrUndefined(i)||n.type(this.currentDate())=="date"&&n.type(this.model.minDate)=="date"&&n.type(this.model.maxDate)=="date"){if(i=="MM/dd/yyyy"&&(n.type(this.currentDate())!="date"||n.type(this.model.minDate)!="date"||n.type(this.model.maxDate)!="date")){var e=Globalize.parseDate(this.currentDate()),r=Globalize.parseDate(this.model.minDate),u=Globalize.parseDate(this.model.maxDate);t.isNullOrUndefined(e)?this.currentDate(new Date):this.currentDate(e);this.model.minDate=t.isNullOrUndefined(r)?this.model.minDate:r;this.model.maxDate=t.isNullOrUndefined(u)?this.model.maxDate:u}}else{var f=Globalize.parseDate(this.currentDate(),this.model.dateFormat),r=Globalize.parseDate(this.model.minDate,this.model.dateFormat),u=Globalize.parseDate(this.model.maxDate,this.model.dateFormat);t.isNullOrUndefined(f)?this.currentDate():this.currentDate(f);this.model.minDate=t.isNullOrUndefined(r)?this.model.minDate:r;this.model.maxDate=t.isNullOrUndefined(u)?this.model.maxDate:u}},_datepattern:function(){return this.model.dateFormat!=""&&!t.isNullOrUndefined(this.model.dateFormat)?this.model.dateFormat:this._pattern.d},_businessHourScroller:function(){var i,r;this.model.orientation=="vertical"?(i=this.element.find(".e-businesshighlightworkcells").length!=0&&this.model.highlightBusinessHours==!0?this.element.find(".e-businesshighlightworkcells").first().parent()[0].rowIndex*this.element.find(".e-workcells").height():0,n("div#"+this._id+"_scroller").ejScroller({scrollTop:i}),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")):this.model.orientation=="horizontal"&&(this.element.find(".e-businesshighlightworkcells").length!=0&&this.model.highlightBusinessHours==!0&&this.currentView()!="month"?this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7?(r=this.element.find(".e-activeview.e-horizontalheaderdiv").parent().index(),!t.isNullOrUndefined(r)&&r>=0&&(this.currentDate(this._getRenderDates()[r]),dateRender=new Date(this._getRenderDates()[r]).getDay(),i=this.element.find(".e-workcells")[r*48].offsetLeft),this.currentView()==="week"&&[0,6].indexOf(dateRender)==-1?i=this.model.businessStartHour*2*this.element.find(".e-workcells").width()+(i-this.element.find(".e-workcells").width()):this.currentView()==="workweek"&&(i=this.model.businessStartHour*2*this.element.find(".e-workcells").width()+(i-this.element.find(".e-workcells").width()))):i=this.element.find(".e-businesshighlightworkcells")[0].cellIndex*this.element.find(".e-workcells").width():i=this.element.find(".e-activeview.e-horizontalheaderdiv").parent().index()!=-1?this.element.find(".e-workcells")[this.element.find(".e-activeview.e-horizontalheaderdiv").parent().index()*48].offsetLeft:0,n("div#"+this._id+"_scroller").ejScroller({scrollLeft:i}),n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-this.element.find(".e-draggableworkarea").scrollLeft()+"px"))},_yearDateChange:function(){this._appointmentAddWindow.find("#"+this._id+"yearday").ejRadioButton("option","checked",!0)},_yearDayChange:function(){this._appointmentAddWindow.find("#"+this._id+"yearother").ejRadioButton("option","checked",!0)},_monthDateChange:function(){this._appointmentAddWindow.find("#"+this._id+"monthday").ejRadioButton("option","checked",!0)},_monthDayChange:function(){this._appointmentAddWindow.find("#"+this._id+"monthon").ejRadioButton("option","checked",!0)},_endAfterChange:function(){this._appointmentAddWindow.find("#"+this._id+"repeatendafter").ejRadioButton("option","checked",!0)},_endOnChange:function(){this._appointmentAddWindow.find("#"+this._id+"repeatendon").ejRadioButton("option","checked",!0)},_minToHour:function(n){var t=parseInt(n/60),n=n%60;return{h:t,m:n}},_onclose:function(){this._clearFields();this._processFocus()},_printAppointment:function(){var e=t.buildTag("div"),c=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._appId),o=new t.DataManager(this._processed).executeLocal(c),r="<table align='center' style='margin-top:50px;margin-left:50;'>",u=this,i,f,s,h;return n.each(o[0],function(n,i){n=="ParentId"||t.isNullOrUndefined(i)||t.isNullOrUndefined(n)||n=="null"||((n==u.model.appointmentSettings.startTime||n==u.model.appointmentSettings.endTime)&&(i=i),r+="<tr style='height:30px'><td style='width:300px'><b>"+n+":<\/b><\/td><td  style='width:600px'>"+i+"<\/td><\/tr>")}),r+="<\/table>",i="",t.isNullOrUndefined(this.model.appointmentSettings.resourceFields)||this.model.appointmentSettings.resourceFields==""||(f=u.model.appointmentSettings.resourceFields.split(","),n.each(this.model.resources[this.model.resources.length-1].resourceSettings.dataSource,function(n,t){t.id==o[0][f[f.length-1]]&&(i=t.text)})),i=i==""?"Unknown":i,s="<font size='20' style='margin-top:50px;margin-left:50;font-family:Times New Roman'><b>"+i+"<\/b><\/font><\/br><hr style='margin-left:50' size='10'>",h=s+r,e.append(h),t.print(e),!1},_saveAppointment:function(){var tt=this._sortAppById(this._processed),y,i,p,ft,it,v,s,w,l,b,rt,ut,k,e,vt,yt,c,d,pt,g,nt,h,wt,ht,bt,ct,u,f;if(this._cellClick&&this.model.showQuickWindow){if((i={},y=tt.length>0?tt[tt.length-1][this.model.appointmentSettings.id]+1:1,i[this.model.appointmentSettings.id]=y,i.ParentId=y,i[this.model.appointmentSettings.subject]=this._quickAppointWindow.find(".subject").val(),i[this.model.appointmentSettings.startTime]=new Date(this.cur_StartTime),i[this.model.appointmentSettings.endTime]=new Date(this.cur_EndTime),i[this.model.appointmentSettings.allDay]=this.currentView()==="month"||new Date(this.cur_StartTime).getHours()==0&&new Date(this.cur_EndTime).getHours()==23&&new Date(this.cur_EndTime).getMinutes()==59||this._isCustomView()?!0:!1,i[this.model.appointmentSettings.recurrence]=!1,t.isNullOrUndefined(this.model.group)&&(t.isNullOrUndefined(this.model.resources)||!t.scheduleFeatures.resources)||(i=this._getResourceFields(i)),e={appointment:i},this._trigger("actionBegin",{data:e.appointment,requestType:"appointmentSave"}))||this._trigger("appointmentSaved",e))return this._quickAppointWindow.ejDialog("close"),!1;this._currentAction==t.Schedule.Actions.Add;c=this._timeZoneConversion(e.appointment);h=this._dataManager.insert(c);new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,e.appointment);u=this;n.isFunction(h.promise)&&this.dataSource()instanceof t.DataManager?(h.done(function(){u._processed.push(e.appointment);u._renderSingleApp(i,e.appointment);u._currentAppointmentData.push(e.appointment);u._trigger("actionComplete",{data:e.appointment,requestType:"appointmentSave"})}),h.fail(function(){})):(this._processed.push(e.appointment),this._renderSingleApp(i,e.appointment),this._trigger("actionComplete",{data:e.appointment,requestType:"appointmentSave"}));this._cellClick=!1;this._quickAppointWindow.ejDialog("close")}else{for(i={},c={},y=(this._currentAction==t.Schedule.Actions.Add||this._currentAction==t.Schedule.Actions.EditOcurrence)&&tt.length>0?tt[tt.length-1][this.model.appointmentSettings.id]+1:parseInt(this._appId),p=n("#"+this._id+"AppointmentAddEditWindow").find("#"+this._id+"_AddEditForm").get(0),ft=[],it=[],v=0;v<p.length;v++)s=p[v].name,w=n(p[v]),s!=r&&(s==""&&(s=p[v].id.replace(this._id,"")),s!=""&&i[s]==null?(l=p[v].value,s=="Id"&&(l=l==""?parseInt(y):parseInt(l)),n(p[v]).hasClass("e-datepicker")?l=w.ejDatePicker("option","value"):n(p[v]).hasClass("e-datepicker")?l=w.ejTimePicker("option","value"):w.data("ejDropDownList")?l=w.ejDropDownList("model.value"):w.data("ejAutocomplete")&&ft.push(w.data("ejAutocomplete").getSelectedItems()),s!="StartDate"&&s!="EndDate"&&s!="StartTime"&&s!="EndTime"?i[s]=p[v].type!="checkbox"?l:n(p[v]).is(":checked"):c[s]=s=="StartDate"||s=="EndDate"?new Date(l):l):w.data("ejAutocomplete")&&(s==this._id+"_categorize"?(it.push(w.data("ejAutocomplete").getSelectedItems()),this.model.categorizeSettings.allowMultiple||l.length!=0&&(b=this.model.categorizeSettings,categorizeDataIndex=this._findResourceIndex(b.dataSource,"text",l),it[0].push({text:b.dataSource[categorizeDataIndex][b.text],color:b.dataSource[categorizeDataIndex][b.color],id:b.dataSource[categorizeDataIndex][b.id],fontColor:b.dataSource[categorizeDataIndex][b.fontColor]}),it[0].shift())):ft.push(w.data("ejAutocomplete").getSelectedItems())));if(rt=this._timeFormat(c.StartTime).split(":"),ut=this._timeFormat(c.EndTime).split(":"),i[this.model.appointmentSettings.startTime]=new Date(c.StartDate.setHours(parseInt(rt[0]),parseInt(rt[1]))),i[this.model.appointmentSettings.endTime]=new Date(c.EndDate.setHours(parseInt(ut[0]),parseInt(ut[1]))),i[this.model.appointmentSettings.recurrence]&&(i[this.model.appointmentSettings.recurrenceRule]=this._recRule),i.startutc!=""){var at=i.startutc.split(" ")[1].split(":"),kt=parseInt(at[0]),dt=parseInt(at[1]),gt=(new Date).getTimezoneOffset(),et=this._minToHour(gt+(kt*60+dt));new Date(i.StartTime.setHours(i.StartTime.getHours()+et.h,i.StartTime.getMinutes()+et.m));new Date(i.EndTime.setHours(i.EndTime.getHours()+et.h,i.EndTime.getMinutes()+et.m))}if(this._currentAction==t.Schedule.Actions.EditOcurrence){var d=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,i.Id),ni=new t.DataManager(this._processed).executeLocal(d),k=this._deleteOcurrence(this._parentId,new Date(ni[0][this.model.appointmentSettings.startTime]));new t.DataManager(this._processed).remove(this.model.appointmentSettings.id,this._appId);i[this.model.appointmentSettings.recurrence]=1;i[this.model.appointmentSettings.recurrenceRule]=k[0][this.model.appointmentSettings.recurrenceRule]+";RECUREDITID="+k[0][this.model.appointmentSettings.id]}else this._currentAction==t.Schedule.Actions.EditSeries&&(d=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,this._parentId),k=new t.DataManager(this._currentAppointmentData).executeLocal(d),i[this.model.appointmentSettings.id]=k[0][this.model.appointmentSettings.id],y=k[0][this.model.appointmentSettings.id],i[this.model.appointmentSettings.recurrenceRule]=this._recRule==""?k[0][this.model.appointmentSettings.recurrenceRule]:this._recRule);if(this._currentAction!=t.Schedule.Actions.Add){if(this._trigger("actionBegin",{data:i,requestType:"appointmentEdit"})||this._trigger("appointmentEdited",{appointment:i}))return this._appointmentAddWindow.ejDialog("close"),!1}else if(this._trigger("actionBegin",{data:i,requestType:"appointmentSave"})||this._trigger("appointmentSaved",{appointment:i}))return this._appointmentAddWindow.ejDialog("close"),!1;if(e=[],!t.isNullOrUndefined(this.model.categorizeSettings)&&it.length>0||!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources?e=this._getResCategorySaveData(it,ft,i,y,c,rt,ut):(yt=this._currentAction==t.Schedule.Actions.EditOcurrence||!t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])&&i[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1?this._parentId:y,this._maxId=y,vt=this._addAppData(i,this._maxId,new Date(c.StartDate.setHours(parseInt(rt[0]),parseInt(rt[1]))),new Date(c.EndDate.setHours(parseInt(ut[0]),parseInt(ut[1]))),yt),e.push(vt)),this._currentAction==t.Schedule.Actions.Add||this._currentAction==t.Schedule.Actions.EditOcurrence){for(this._maxId=y,u=this,c=[],g=0;g<e.length;g++)c.push(this._timeZoneConversion(e[g]));for(h=this._dataManager.saveChanges({added:c,changed:[],deleted:[]}),nt=0;nt<e.length;nt++)new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,e[nt]);if(n.isFunction(h.promise)&&this.dataSource()instanceof t.DataManager)h.done(function(){for(var n=0;n<e.length;n++)u._processed.push(e[n]),u._renderSingleApp(i,e[n]),u._currentAppointmentData.push(e[n]);u._trigger("actionComplete",{data:e,requestType:"appointmentSave"})}),h.fail(function(){});else{for(f=0;f<e.length;f++)this._appointmentProcessing(e[f]),this.dataSource()instanceof t.DataManager||this._renderSingleApp(i,e[f]);this._trigger("actionComplete",{data:e,requestType:"appointmentSave"})}}else if(this._currentAction==t.Schedule.Actions.Save||this._currentAction==t.Schedule.Actions.EditSeries){var a=[],o=[],lt=[];for(f=0;f<e.length;f++)d=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,e[f].ParentId),k=this.dataSource()instanceof t.DataManager?t.DataManager(this._processed).executeLocal(d):this._dataManager.executeLocal(d),!t.isNullOrUndefined(k)&&k.length>0?o.push(e[f]):a.push(e[f]);if(this._currentAction==t.Schedule.Actions.EditSeries)for(f=0;f<o.length;f++)d=t.Query().where(t.Predicate(this.model.appointmentSettings.recurrenceRule,t.FilterOperators.contains,"RECUREDITID="+e[f].ParentId,!0)),pt=new t.DataManager(this._currentAppointmentData).executeLocal(d),lt=lt.concat(pt),this._appointmentAddWindow.find(".recurbutton").click(),o[f][this.model.appointmentSettings.recurrenceRule]=this._recRule;var u=this,h,ot=[],st=[];for(g=0;g<a.length;g++)ot.push(this._timeZoneConversion(a[g]));for(nt=0;nt<o.length;nt++)st.push(this._timeZoneConversion(o[nt]));for(h=this._dataManager.saveChanges({added:ot,changed:st,deleted:lt},this.model.appointmentSettings.id),ht=0;ht<ot.length;ht++)wt=this._reverseTimeZoneConversion(ot[ht]),new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,wt);for(ct=0;ct<st.length;ct++)bt=this._reverseTimeZoneConversion(st[ct]),new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,bt);if(o.length>0)if(u=this,n.isFunction(h.promise)&&this.dataSource()instanceof t.DataManager)h.done(function(){for(var n=0;n<o.length;n++)o[n][u.model.appointmentSettings.recurrence]||Globalize.format(new Date(o[n][u.model.appointmentSettings.startTime]),u._pattern.d)<Globalize.format(new Date(o[n][u.model.appointmentSettings.endTime]),u._pattern.d)&&(new Date(o[n][u.model.appointmentSettings.endTime])-new Date(o[n][u.model.appointmentSettings.startTime]))/36e5<24&&o[n][u.model.appointmentSettings.allDay]!==!0?u._dataProcessing(u._currentAppointmentData):new t.DataManager(u._processed).update(u.model.appointmentSettings.id,o[n])&&u.element.find("#Appointment_"+u._appId).remove()&&u.element.find("#categorybar_"+u._appId).remove(),u._renderSingleApp(o[n],o[n]);u._trigger("actionComplete",{data:o,requestType:"appointmentEdit"})}),h.fail(function(){});else{for(f=0;f<o.length;f++)o[f][this.model.appointmentSettings.recurrence]||Globalize.format(new Date(o[f][this.model.appointmentSettings.startTime]),this._pattern.d)<Globalize.format(new Date(o[f][this.model.appointmentSettings.endTime]),this._pattern.d)&&(new Date(o[f][this.model.appointmentSettings.endTime])-new Date(o[f][this.model.appointmentSettings.startTime]))/36e5<24&&o[f][this.model.appointmentSettings.allDay]!==!0?u._dataProcessing(u._currentAppointmentData):new t.DataManager(this._processed).update(this.model.appointmentSettings.id,o[f])&&this.element.find("#Appointment_"+this._appId).remove(),u.element.find("#categorybar_"+u._appId).remove(),u._renderSingleApp(o[f],o[f]);this._trigger("actionComplete",{data:o,requestType:"appointmentEdit"})}if(a.length>0)if(n.isFunction(h.promise)&&this.dataSource()instanceof t.DataManager)h.done(function(){for(var n=0;n<a.length;n++)u._processed.push(a[n]),u._renderSingleApp(a[n],a[n])}),h.fail(function(){});else for(f=0;f<a.length;f++)this._appointmentProcessing(a[f]),this.dataSource()instanceof t.DataManager||this._renderSingleApp(a[f],a[f])}}this._clearFields();this._appointmentAddWindow.ejDialog("close");this.element.find("div.e-draggableworkarea tr").find("td").hasClass("e-selectedCell")&&this._processFocus();this._recRule=""},_renderSingleApp:function(i,r){var s=Globalize.format(i[this.model.appointmentSettings.startTime],this._pattern.d)<Globalize.format(i[this.model.appointmentSettings.endTime],this._pattern.d)&&(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5<24&&i[this.model.appointmentSettings.allDay]!==!0&&i[this.model.appointmentSettings.recurrence]!=1,u;if(this.element.find(".e-prev,.e-next").css("display","none"),i[this.model.appointmentSettings.recurrence]||s||this.currentView()==="month"||this._isCustomView()||(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5>24)this._renderAppointmentAll();else{var o=i[this.model.appointmentSettings.startTime],f=this.currentView()==="day"?0:n.inArray(new Date(o.getFullYear(),o.getMonth(),o.getDate()).getTime(),this._dateRender),e=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this._findResourceIndex(this.res1,"id",r[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):0;if(this._getDayAppointments(f,e),this.currentView()!=="month"&&!this._isCustomView()?f>=0&&i[this.model.appointmentSettings.allDay]&&this.model.orientation=="vertical"?this._setAllDayPos(r,f,e):this._renderApp(r,f,e):this._renderAppointmentMonth(r,this._cellIndex),this.overlapList.length>1)for(u=0;u<this.overlapList.length;u++)this.element.find("#Appointment_"+this.overlapList[u][this.model.appointmentSettings.id]).remove(),this.element.find("#categorybar_"+this.overlapList[u][this.model.appointmentSettings.id]).remove(),this.currentView()=="month"||this._isCustomView()?this._renderAppointmentMonth(this.overlapList[u],this._cellIndex):this._renderApp(this.overlapList[u],f,e);this._unWireResizeEvents();this._wireResizeEvents();this._dragdropAppointments()}},_timeFormat:function(n){var e=Globalize.culture(this.model.locale),i=Number(n.match(/^(\d+)/)[1]),o=Number(n.match(/:(\d+)/)[1]),f,r,u;return t.isNullOrUndefined(n.split(" ")[1])||(f=n.match(/\s(.*)$/)[1],f==e.calendar.PM[0]&&i<12&&(i=i+12),f==e.calendar.AM[0]&&i==12&&(i=i-12)),r=i.toString(),u=o.toString(),i<10&&(r="0"+r),o<10&&(u="0"+u),r+":"+u},_processEscapeKey:function(){this._processFocus();this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")},_processFocus:function(){var s=this.element.find("div.e-selectedAppointment"),o,l;if(s.length!=0&&s.focus(),this.element.find("td.e-selectedCell").hasClass("e-workcells")){var r=this.element.find("div.e-draggableworkarea tr"),h=r.length-1,i,t,c,f,u,e=this.currentView(),a=this;this.element.find("td.e-selectedCell").each(function(o,s){var l=n(s).index(),a;if(l!=null&&!isNaN(l))if(i==null?(i=l,c=n(s).parent()[0].rowIndex):i<l?i=i:i!=l&&(i=l,c=n(s).parent()[0].rowIndex),t==null){if(t=l,e!="month")for(u=parseInt(t),a=0;a<=h;a++)n(r[a].cells[u]).hasClass("e-selectedCell")&&(f=a)}else if(t>l)t=t;else if(t!=l&&(t=l,e!="month"))for(u=parseInt(t),a=0;a<=h;a++)n(r[a].cells[u]).hasClass("e-selectedCell")&&(f=a)});e!="month"?n(r[f].cells[t]).attr("tabIndex",0).focus():(o=r.find("td.e-selectedCell"),l=parseInt(o.length)-1,n(o[l]).attr("tabIndex",0).focus())}else this.element.focus(),this.element.find("td.e-selectedCell").attr("tabIndex",0).focus()},_clearFields:function(){this._appointmentAddWindow.find(".subject").val("");this._appointmentAddWindow.find(".e-description").val("");this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",Globalize.format(new Date,this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",Globalize.format(new Date,this._pattern.d));this._appointmentAddWindow.find(".startendtime").ejTimePicker({enabled:!0});this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(new Date,this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(new Date,this._pattern.t));this._appointmentAddWindow.find(".recurrence,.weekdays").ejCheckBox({checked:!1,enabled:!0});this._appointmentAddWindow.find(".e-repeatlbl").removeClass("e-disable");this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!1});this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList("clearText");this._appointmentAddWindow.find("#"+this._id+"summary").css("display","none");this._appointmentAddWindow.find(".e-recurFinalRule").html("");this._appointmentAddWindow.find(".e-recuredit").hide();this._appointmentAddWindow.find(".e-categorizevalue").ejAutocomplete("clearText")},_getNumericModel:function(){return numericModel={width:"100px",minValue:1,value:1,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,localize:this.model.locale}},_recurClearFields:function(){for(var i=this._appointmentAddWindow.find("input[name='weekdays']"),t=0;t<i.length;t++)n(i[t]).ejCheckBox({checked:!1});this._appointmentAddWindow.find(".e-recurevery").ejNumericTextbox({value:1});this._appointmentAddWindow.find(".e-recurcount").ejNumericTextbox({value:10});this._appointmentAddWindow.find(".e-recurRule").html("")},_getApps:function(){var r=this._dateRender,t,u,i,n;for(this._app=[],t=this._processed,u=0;u<this.res1.length;u++)for(i=0;i<r.length;i++)for(n=0;n<t.length;n++)Globalize.format(new Date(t[n][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(r[i]),this._pattern.d)&&Globalize.format(new Date(t[n][this.model.appointmentSettings.endTime]),this._pattern.d)>=Globalize.format(new Date(r[i]),this._pattern.d)&&Globalize.format(new Date(t[n][this.model.appointmentSettings.startTime]),this._pattern.d)==Globalize.format(new Date(t[n][this.model.appointmentSettings.endTime]),this._pattern.d)&&Globalize.format(new Date(t[n][this.model.appointmentSettings.startTime]),this._pattern.d)<=Globalize.format(new Date(t[n][this.model.appointmentSettings.endTime]),this._pattern.d)&&this._app.push(t[n])},_deleteApp:function(i){var e,r;if(this._trigger("actionBegin",{id:i,requestType:"appointmentDelete"}))return!1;var o=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,i),f=t.DataManager(this._processed).executeLocal(o),s=f.length==0?i:this._getAppointmentByParentId(i),u=this._dataManager.remove(this.model.appointmentSettings.id,i);t.isNullOrUndefined(u)&&(u=this._dataManager.remove(this.model.appointmentSettings.id,s));r=this;t.isNullOrUndefined(u)||(n.isFunction(u.promise)?(u.done(function(n){f[0][r.model.appointmentSettings.recurrence]&&r._deleteRecurrence(i);new t.DataManager(r._currentAppointmentData).remove(r.model.appointmentSettings.id,i);f[0][r.model.appointmentSettings.recurrence]?r._dataProcessing(r._currentAppointmentData)&&r._renderAppointmentAll():new t.DataManager(r._processed).remove(r.model.appointmentSettings.id,i)&&r.element.find("#Appointment_"+i).remove()&&r.element.find("#categorybar_"+i).remove();r._trigger("actionComplete",{data:n,requestType:"appointmentDelete"})}),u.fail(function(){})):(u[0][this.model.appointmentSettings.recurrence]&&this._deleteRecurrence(i),u[0][this.model.appointmentSettings.recurrence]||(new Date(u[0][this.model.appointmentSettings.endTime])-new Date(u[0][this.model.appointmentSettings.startTime]))/36e5>24?this._dataProcessing(this._currentAppointmentData)&&this._renderAppointmentAll():new t.DataManager(this._processed).remove(this.model.appointmentSettings.id,i)&&this.element.find("#Appointment_"+i).remove()&&this.element.find("#categorybar_"+i).remove(),this._trigger("actionComplete",{data:f,requestType:"appointmentDelete"})));this._getApps();this._app.length<1&&this.model.enableAppointmentNavigation&&this._nextPrevButton(this._app);e={appointment:u};this._trigger("appointmentDeleted",e)},_deleteRecurrence:function(n){for(var u=t.Query().where(t.Predicate(this.model.appointmentSettings.recurrenceRule,t.FilterOperators.contains,"RECUREDITID="+n,!0)),r=new t.DataManager(this._processed).executeLocal(u),i=0;i<r.length;i++)this._deleteApp(r[i][this.model.appointmentSettings.id]),this.element.find("#Appointment_"+n).remove(),this.element.find("#categorybar_"+n).remove()},_appointmentResizeStart:function(i){if(this.model.enableAppointmentResize){var r={element:n(i.target).parent()};if(this._trigger("actionBegin",{data:r,requestType:"appointmentResize"})||this._trigger("resizeStart",r)||(i.preventDefault(),this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),this.resizeStart=!0,n(i.target).hasClass("e-lefthandle")||n(i.target).hasClass("e-righthandle")?(this.resize=i.pageX,this.appoint_width=n(i.target).parent().width(),this.appoint_left=parseInt(n(i.target).parent()[0].style.left),this._appointleft=parseInt(n(n(i.target).parent()[0]).offset().left),n(i.target).hasClass("e-lefthandle")?this._leftResizing=!0:this._rightResizing=!0):(n(i.target).hasClass("e-tophandle")||n(i.target).hasClass("e-bottomhandle"))&&(this.resize=i.pageY,this.appoint_height=n(i.target).parent().height(),this.appoint_top=parseInt(n(i.target).parent()[0].style.top),n(i.target).hasClass("e-tophandle")?this._topResizing=!0:this._bottomResizing=!0),this._curElmt=n(i.target).parent(),this.element.find(".e-workcells").removeClass("e-selectedCell"),this.element.find(".e-workcells").removeClass("e-mousehover"),this._on(n(document),t.eventType.mouseMove,n.proxy(this._appointmentResizing,this)),this._on(n(document),t.eventType.mouseUp,n.proxy(this._appointmentResizeStop,this)),n(i.target).hasClass("e-rowcursor")||n(i.target).hasClass("e-columncursor")))return!1}},_appointmentResizing:function(t){var i=n(t.target),r={element:i.parent()};if(this._trigger("resize",r))return!1;this._topResizing?(this._curElmt.height(this.appoint_height+this.resize-t.pageY+3),this._curElmt.css("top",this.appoint_top-(this.resize-t.pageY)-3)):this._bottomResizing?this._curElmt.height(this.appoint_height+(t.pageY-this.resize)+2):this._rightResizing?this._curElmt.width(this.appoint_width+(t.pageX-this.resize)+2):this._leftResizing&&(this._curElmt.width(this.appoint_width+this.resize-t.pageX+3),this._curElmt.css("left",this.appoint_left-(this.resize-t.pageX)-3))},_appointmentResizeStop:function(i){var g,b,wt,f,p,v,u,st,y,k,ht,ct,kt,ut,d,lt,ft,dt,o;try{g=this.element.find(".e-draggableworkarea");this.resizeStart=!1;n(document).unbind(t.eventType.mouseMove);n(document).unbind(t.eventType.mouseUp);var e=this.model.appointmentSettings,gt=this._currentAppointmentData,c=n(i.target).hasClass("e-appointment")||n(i.target).hasClass("e-monthappointment")||n(i.target).hasClass("e-alldayappointment")?n(i.target):n(i.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),nt=c[0].id.split("_")[1],s=new t.DataManager(this._processed).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,nt)),h=s[0][e.recurrence]&&s[0][e.recurrenceRule].toString().indexOf("RECUREDITID")==-1&&this.currentView()!="month"&&!this._isCustomView()?this._getAppointmentByParentId(nt):s[0],w=this.model.currentView==="week"||this.model.currentView==="month"?7:this.model.currentView==="workweek"?5:1;if(h!=null||h!==r){var fi=h[this.model.appointmentSettings.startTime].getDate()<new Date(h[this.model.appointmentSettings.endTime]).getDate()?!0:!1,f=new Date(h[this.model.appointmentSettings.startTime]),u=new Date(h[this.model.appointmentSettings.endTime]),et=h[this.model.appointmentSettings.startTime],tt=h[this.model.appointmentSettings.endTime],ni=n(c[0]).height();if(this.currentView()!=="month"&&!this._isCustomView())var ti=n(c[0]).offset().top,it=this.element.find(".e-workcells").height(),yt=g.height()+g.scrollTop(),pt=ti-g.offset().top+g.scrollTop(),ot=pt-it/2<yt?pt:yt-ni;if(this._topResizing)ot>0&&(b=ot*60/(2*(it+1)),f.setHours(parseInt(this.model.startHour)+parseInt(b/60)),f.setMinutes(parseInt(b%60)),f.setMinutes(Math.round(f.getMinutes()/10)*10)),this._topResizing=!1;else if(this._bottomResizing)ot>=0&&(wt=n(c[0]).height()/it,b=(ot+wt*it)*60/(2*(it+1)),u.setHours(parseInt(this.model.startHour)+parseInt(b/60)),u.setMinutes(parseInt(b%60)),u.setMinutes(Math.round(u.getMinutes()/10)*10)),this._bottomResizing=!1;else if(this._leftResizing)this.model.orientation=="vertical"?(v=this.model.group?this._findResourceIndex(this.res1,"id",h[this.model.appointmentSettings.resourceFields.split(",")[this.model.resources.length-1]]):0,this.currentView()==="month"||this._isCustomView()?n(c[0]).offset().left>n(n(".e-monthcells")[v*w]).offset().left&&(f=new Date(this._firstweekdate(new Date(s[0][e.startTime]))),u=new Date(s[0][e.endTime]),y=Math.round(n(c[0]).offset().left/(this.element.find(".e-monthcells").width()+1)),f.setDate(f.getDate()+parseInt(y)),f.setHours(new Date(et).getHours()),f.setMinutes(new Date(et).getMinutes())):n(c[0]).offset().left>n(n(".e-alldaycells")[v*w]).offset().left&&(f=new Date(this._dateRender[0]),p=n(c[0]).offset().left-n(this.element.find(".e-alldaycells")[v*w]).offset().left,y=Math.round(p/(this.element.find(".e-alldaycells").width()+1)),f.setDate(new Date(f).getDate()+y),f.setHours(new Date(et).getHours()),f.setMinutes(new Date(et).getMinutes()),u=new Date(s[0][e.endTime]))):(f=new Date(h[this.model.appointmentSettings.startTime]),p=n(c[0]).offset().left-this._appointleft,this.currentView()=="month"||this._isCustomView()?(f=new Date(s[0][e.startTime]),y=Math.round(p/(this.element.find(".e-workcells").width()+1)),f.setDate(new Date(f).getDate()+y),u=new Date(s[0][e.endTime])):(k=p*60/(this.element.find(".e-workcells").width()*2+1),f.setHours(parseInt(new Date(f).getHours())+parseInt(k/60)),f.setMinutes(new Date(f).getMinutes()+parseInt(k%60)),f.setMinutes(Math.round(f.getMinutes()/10)*10)),f=new Date(f)),this._leftResizing=!1;else if(this._rightResizing){if(this.model.orientation=="vertical")if(v=this.model.group?this._findResourceIndex(this.res1,"id",h[this.model.appointmentSettings.resourceFields.split(",")[this.model.resources.length-1]]):0,this.currentView()==="month"||this._isCustomView()){var ri=n(c[0]).offset().left+n(c[0]).width(),st=n(c[0]).width()-this.appoint_width,y=Math.round(st/this.element.find(".e-monthcells").width()),p=n(this.element.find(".e-monthcells")[(v+1)*w]).offset().left;f=new Date(s[0][e.startTime]);u=new Date(s[0][e.endTime]);ri>p&&u.setDate(new Date(u).getDate()+y);u.setHours(new Date(tt).getHours());u.setMinutes(new Date(tt).getMinutes())}else{var p=c[0].offsetLeft+n(c[0]).width(),y=Math.floor(p/this.element.find(".e-alldaycells").width())-v*w,ii=v==this.res1.length-1?n(this.element.find(".e-alldaycells")[(v+1)*w-1]).offset().left+this.element.find(".e-alldaycells").width():n(this.element.find(".e-alldaycells")[(v+1)*w]).offset().left;ii>=p&&(f=new Date(s[0][e.startTime]),u=new Date(this._dateRender[0]),u.setDate(new Date(u).getDate()+y),u.setHours(new Date(tt).getHours()),u.setMinutes(new Date(tt).getMinutes()))}else u=new Date(tt),st=n(c[0]).width()-this.appoint_width,this.currentView()=="month"||this._isCustomView()?(f=new Date(s[0][e.startTime]),u=new Date(s[0][e.endTime]),y=Math.round(st/(this.element.find(".e-workcells").width()+1)),u.setDate(new Date(u).getDate()+y)):(k=st*60/(this.element.find(".e-workcells").width()*2+1),u.setHours(new Date(u).getHours()+parseInt(k/60)),u.setMinutes(new Date(u).getMinutes()+parseInt(k%60)),u.setMinutes(Math.round(u.getMinutes()/10)*10)),u=new Date(u);this._rightResizing=!1}if(h[e.recurrence]==1&&h[e.recurrenceRule].toString().indexOf("RECUREDITID")==-1){var a={},at,vt,bt=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,nt),rt=new t.DataManager(this._processed).executeLocal(bt)[0];n.extend(a,h);d=new Date(new Date(this.model.maxDate).getTime());d.setHours(23,59,59);u>=new Date(this.model.minDate)&&u<=d?((s[0][e.endTime]-s[0][e.startTime])/36e5>24||this.currentView()=="month"||this._isCustomView()?(at=new Date(f),vt=new Date(u)):(ht=new Date(rt[e.startTime]),ct=new Date(rt[e.endTime]),at=new Date(ht.getFullYear(),ht.getMonth(),ht.getDate()).setHours(f.getHours(),f.getMinutes(),f.getMilliseconds()),vt=new Date(ct.getFullYear(),ct.getMonth(),ct.getDate()).setHours(u.getHours(),u.getMinutes(),u.getMilliseconds())),this._deleteOcurrence(parseInt(this._getAppointmentByParentId(nt)[e.id]),new Date(rt[e.startTime])),this._processed=this._sortAppById(this._processed),kt=this._processed.length>0?this._processed[this._processed.length-1][e.id]+1:1,a[e.recurrenceRule]=s[0][e.recurrenceRule]+";RECUREDITID="+a[e.id],lt={appointment:a,target:i},this._trigger("resizeStop",lt)||(a[e.startTime]=new Date(at),a[e.endTime]=new Date(vt)),a[e.id]=kt,ut={data:a},ft=this._timeZoneConversion(ut.data),promise=this._dataManager.insert(ft),new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,ut.data),o=this,n.isFunction(promise.promise)&&this.dataSource()instanceof t.DataManager?(promise.done(function(){o._processed.splice(o._processed.indexOf(rt),1);o._processed.push(ut.data);o._renderSingleApp(a,a);o._trigger("actionComplete",{data:a,requestType:"appointmentResize"})}),promise.fail(function(){o._renderAppointmentAll()})):(this._processed.splice(this._processed.indexOf(rt),1),this._processed.push(ut.data),this._renderSingleApp(a,a),this._trigger("actionComplete",{data:a,requestType:"appointmentResize"}))):this._renderAppointmentAll()}else{var bt=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,h[this.model.appointmentSettings.id]),l={},ui=new t.DataManager(this._currentAppointmentData).executeLocal(bt);n.extend(l,ui);d=new Date(new Date(this.model.maxDate).getTime());d.setHours(23,59,59);this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&this.element.find("#categorybar_"+h[this.model.appointmentSettings.id]).remove();u>=new Date(this.model.minDate)&&u<=d&&(lt={appointment:l[0],target:i},this._trigger("resizeStop",lt)||(l[0][this.model.appointmentSettings.startTime]=f,l[0][this.model.appointmentSettings.endTime]=u),ft=this._timeZoneConversion(l[0]),promise=this._dataManager.update(this.model.appointmentSettings.id,ft),dt=this._reverseTimeZoneConversion(ft),new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,dt));o=this;promise&&n.isFunction(promise.promise)&&this.dataSource()instanceof t.DataManager?(promise.done(function(){new t.DataManager(o._processed).update(o.model.appointmentSettings.id,l);o.element.find("#Appointment_"+l[0][o.model.appointmentSettings.id]).remove();o.element.find("#categorybar_"+l[0][o.model.appointmentSettings.id]).remove();o._renderSingleApp(l[0],l[0]);o._trigger("actionComplete",{data:l,requestType:"appointmentResize"})}),promise.fail(function(){o._renderAppointmentAll()})):(new t.DataManager(this._processed).update(o.model.appointmentSettings.id,l[0]),this.element.find("#Appointment_"+nt).remove(),(s[0][e.endTime]-s[0][e.startTime])/36e5>24&&o._dataProcessing(gt),o._renderSingleApp(l[0],l[0]),this._trigger("actionComplete",{data:l,requestType:"appointmentResize"}))}}this.element.find("div.e-tophandle,div.e-bottomhandle").removeClass("e-rowcursor");this.element.find("div.e-lefthandle,div.e-righthandle").removeClass("e-columncursor")}catch(i){}},recurrenceRuleSplit:function(t){for(var f,r,i,e=t.split(";"),u=0;u<e.length;u++){i=e[u].split("=");switch(n.trim(i[0]).toUpperCase()){case"FREQ":this._rRule.freq=n.trim(i[1]).toUpperCase();break;case"INTERVAL":this._rRule.interval=parseInt(i[1],10);break;case"COUNT":this._rRule.count=parseInt(i[1],10);break;case"UNTIL":this._rRule.until=new Date(i[1]);break;case"BYDAY":this._rRule.weekDays=i[1];break;case"BYMONTHDAY":this._rRule.monthDay=parseInt(i[1],10);break;case"BYMONTH":this._rRule.month=parseInt(i[1],10);break;case"BYSETPOS":this._rRule.setPositions=parseInt(i[1],10);break;case"WKST":this._rRule.weekStart=i[1];break;case"EXDATE":for(f=i[1].split(","),this._rRule.exDate=[],r=0;r<f.length;r++)this._rRule.exDate[r]=Globalize.format(new Date(f[r]),this._pattern.d);break;case"RECUREDITID":this._rRule.recurEditId=parseInt(i[1])}}return this._rRule},_dragdropAppointments:function(){var i,r;if(this.model.readOnly)return!1;this._topResizing=!1;this._bottomResizing=!1;this._leftResizing=!1;this._rightResizing=!1;this.model.allowDragDrop&&(i=this,r=this.element.find(".e-appointment"),r.ejDraggable({handle:".e-appointment",dragArea:i.element.find("div.e-draggableworkarea"),cursorAt:{top:20,left:0},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){var r=n(t.sender.target).hasClass("e-appointment")?n(t.sender.target):n(t.sender.target).parents(".e-appointment");if(r.hasClass("e-appointment"))return r.addClass("e-draggableAppointment").css("width",r[0].offsetWidth+"px").appendTo(i.element)}}),r=this.element.find(".e-alldayappointment"),r.ejDraggable({handle:".e-alldayappointment",dragArea:i.element.find(".e-headrealldaytable tr")[!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.model.group.resources.length+1:2],cursorAt:{top:17,left:0},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){var r=n(t.sender.target).hasClass("e-alldayappointment")?n(t.sender.target):n(t.sender.target).parents(".e-alldayappointment");if(r.hasClass("e-alldayappointment"))return r.addClass("e-draggableAppointment").css("width",r[0].offsetWidth+"px").appendTo(i.element)}}),r=this.element.find(".e-monthappointment"),r.ejDraggable({handle:".e-monthappointment",dragArea:i.element.find(".e-workareadiv"),cursorAt:{top:17,left:0},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){var r=n(t.sender.target).hasClass("e-monthappointment")?n(t.sender.target):n(t.sender.target).parents(".e-monthappointment");if(r.hasClass("e-monthappointment"))return r.addClass("e-draggableAppointment").css("width",r[0].offsetWidth+"px").appendTo(i.element)}}))},_dragStart:function(t){var i=n(t.target),u,r;if(i.parents(".e-appointment").hasClass("e-appointment")||i.parents(".e-monthappointment").hasClass("e-monthappointment")||i.parents(".e-alldayappointment").hasClass("e-alldayappointment")||i.hasClass("e-appointment")||i.hasClass("e-monthappointment")||i.hasClass("e-alldayappointment")){if((u=t.element,r={target:u},this._trigger("actionBegin",{data:r,requestType:"appointmentDrag"}))||this._trigger("dragStart",r))return!1}else t.cancel=!0;this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close")},_dragOver:function(t){var i=n(t.element),r={target:i};this._trigger("drag",r);this.element.find(".e-workcells").removeClass("e-selectedCell");this.element.find(".e-workcells").removeClass("e-mousehover")},_dragStop:function(i){var et,tt,ii,ri,at,st,w,it,f,rt,k,ct,d,ei,oi,si,u,h,y,b,lt,ut,ai,g,ft,vi;this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close");var r=this,e=r.model.appointmentSettings,a=r.element.find(".e-draggableworkarea"),nt=i.element[0].id.split("_")[1],o=new t.DataManager(this._processed).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,nt)),f=o[0][e.recurrence]&&o[0][e.recurrenceRule].toString().indexOf("RECUREDITID")==-1||(o[0][e.endTime]-o[0][e.startTime])/36e5>24?this._getAppointmentByParentId(nt):o[0],yi=this._currentAppointmentData;if(this.model.orientation=="vertical")if(n(i.element[0]).hasClass("e-appointment")){var pt=a.height()+a.scrollTop(),pi=i.element[0].offsetHeight,wt=this.element.find(".e-workcells").height(),bt=n(i.element[0]).offset().top-a.offset().top+a.scrollTop(),kt=bt-wt/2<pt?bt:pt-pi;if(kt>0){et=kt*60/(2*(wt+1));var wi=f[r.model.appointmentSettings.startTime].getDate()<f[r.model.appointmentSettings.endTime].getDate()?!0:!1,dt=f[r.model.appointmentSettings.startTime],gt=f[r.model.appointmentSettings.endTime],ot=(gt-dt)/1e3,ni=Math.floor(ot/3600),ti=Math.floor(ot%3600/60),u,s,c,p;if(r.currentView()==="month"||r._isCustomView())u=f[r.model.appointmentSettings.startTime],s=new Date(u);else{tt=new Date(r._firstweekdate(r.currentDate()));(r.currentView()==="workweek"||r.currentView()=="customview"&&r._renderDays==5)&&(ii=new Date(tt).getDay(),ri=ii==0?1:0,tt.setDate(tt.getDate()+ri));u=tt;st=a.width();w=r.currentView()==="week"?7:r.currentView()==="workweek"?5:r.currentView()=="customview"?r._renderDays:1;w=t.isNullOrUndefined(r.model.group)?w:w*r.res1.length;var ui=Math.round(st/w),fi=i.element[0].offsetLeft-a.offset().left,h=Math.round(fi/ui);u=this.model.enableRTL?new Date(this.dateRender[w-h-1]):new Date(this.dateRender[h]);s=u}wi?(u=r._getNewStartTime(et,u),c=new Date(u),s=r._getNewEndTime(u,ni,ti),p=new Date(s)):(u.setHours(parseInt(r.model.startHour)+Math.round(et/60)),u.setMinutes(parseInt(et%60)),u=new Date(u).getMinutes()>=30?new Date(new Date(u).setHours(new Date(u).getHours()-1)):new Date(u),u.setMinutes(Math.round(u.getMinutes()/10)*10),c=new Date(u),at=f[r.model.appointmentSettings.endTime].getHours()*60+f[r.model.appointmentSettings.endTime].getMinutes()-(f[r.model.appointmentSettings.startTime].getHours()*60+f[r.model.appointmentSettings.startTime].getMinutes()),s.setHours(new Date(u).getHours()+parseInt(at/60)),s.setMinutes(new Date(u).getMinutes()+parseInt(at%60)),s.setMinutes(Math.round(s.getMinutes()/10)*10),p=new Date(s))}else{st=a.width();w=r.currentView()==="week"?7:r.currentView()==="workweek"?5:r.currentView()=="customview"?r._renderDays:1;w=t.isNullOrUndefined(r.model.group)?w:w*r.res1.length;var ui=Math.round(st/w),fi=i.element[0].offsetLeft-a.offset().left,h=Math.round(fi/ui);u=this.model.enableRTL?new Date(this.dateRender[w-h-1]):new Date(this.dateRender[h]);u.setHours(0);u.setMinutes(0);c=new Date(u);s=u;s.setHours(23);s.setMinutes(59);p=new Date(s);it=!0}}else if(n(i.element[0]).hasClass("e-alldayappointment")){f=r._getAppointmentByParentId(nt);u=f[this.model.appointmentSettings.startTime];s=f[this.model.appointmentSettings.endTime];o[0][e.recurrence]&&o[0][e.recurrenceRule].toString().indexOf("RECUREDITID")==-1?(u=o[0][this.model.appointmentSettings.startTime],s=o[0][this.model.appointmentSettings.endTime]):o[0][e.recurrence]&&o[0][e.recurrenceRule].toString().indexOf("RECUREDITID")>0&&(f=o[0],u=o[0][this.model.appointmentSettings.startTime],s=o[0][this.model.appointmentSettings.endTime]);rt=i.element[0].offsetLeft-this.element.find(".e-alldaycells").offset().left-1;rt=this.model.enableRTL?Math.abs(rt):rt;var h=Math.round(rt/(this.element.find(".e-alldaycells").width()+1)),di=Math.round(n(i.element[0]).width()/(this.element.find(".e-alldaycells").width()+1)),bi=Math.ceil((s-u)/864e5),gi=Math.round(n(i.element[0]).width()/(this.element.find(".e-alldaycells").width()+1)),ht=r.currentView()==="week"?7:r.currentView()==="workweek"?5:r.currentView()=="customview"?r._renderDays:1;h<0?u<=new Date(this._dateRender[0])?(c=new Date(u),c.setDate(c.getDate()+h),c.setHours(new Date(f[r.model.appointmentSettings.startTime]).getHours()),c.setMinutes(new Date(f[r.model.appointmentSettings.startTime]).getMinutes()),c=new Date(c)):(k=new Date(r._dateRender[0]),k.setDate(k.getDate()+h),k.setHours(new Date(f[r.model.appointmentSettings.startTime]).getHours()),k.setMinutes(new Date(f[r.model.appointmentSettings.startTime]).getMinutes()),c=new Date(k)):u<new Date(this._dateRender[0])?(ct=h>ht-1?h%ht:h,u.setDate(new Date(f[r.model.appointmentSettings.startTime]).getDate()+ct),u.setHours(new Date(f[r.model.appointmentSettings.startTime]).getHours()),u.setMinutes(new Date(f[r.model.appointmentSettings.startTime]).getMinutes()),c=new Date(u)):(ct=h>ht-1?h%ht:h,c=new Date(new Date(this._dateRender[ct])),c.setHours(new Date(f[r.model.appointmentSettings.startTime]).getHours()),c.setMinutes(new Date(f[r.model.appointmentSettings.startTime]).getMinutes()));d=new Date(c);d.setDate(d.getDate()+bi-1);d.setHours(new Date(f[r.model.appointmentSettings.endTime]).getHours());d.setMinutes(new Date(f[r.model.appointmentSettings.endTime]).getMinutes());p=new Date(d)}else n(i.element[0]).hasClass("e-monthappointment")&&(y=f[r.model.appointmentSettings.startTime],b=f[r.model.appointmentSettings.endTime],o[0][e.recurrence]&&o[0][e.recurrenceRule].toString().indexOf("RECUREDITID")==-1?(y=o[0][this.model.appointmentSettings.startTime],b=o[0][this.model.appointmentSettings.endTime]):o[0][e.recurrence]&&o[0][e.recurrenceRule].toString().indexOf("RECUREDITID")>0&&(f=o[0],y=o[0][this.model.appointmentSettings.startTime],b=o[0][this.model.appointmentSettings.endTime]),u=new Date(new Date(r.model.currentDate).getFullYear(),new Date(r.model.currentDate).getMonth(),1),ei=u.getDay(),u.setDate(u.getDate()-ei),h=Math.floor((i.element[0].offsetLeft-a.offset().left)/this.element.find(".e-monthcells").width()),h=this.model.enableRTL?6-h:h,oi=Math.floor((i.element[0].offsetTop-a.offset().top)/this.element.find(".e-monthcells").outerHeight()),si=oi*7+(h-Math.floor(h/7)*7),u=new Date(r._dateRender[si]),u.setHours(y.getHours(),y.getMinutes(),y.getSeconds()),c=new Date(u),lt=u.getTime()-new Date(y).getTime(),s=new Date(new Date(b).getTime()+lt),p=new Date(s));else if(this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal){var vt,c=new Date(f[r.model.appointmentSettings.startTime]),p=new Date(f[r.model.appointmentSettings.endTime]),ki=Math.floor((i.element[0].offsetLeft+a.scrollLeft()-a.offset().left)/this.element.find(".e-workcells").width()),hi=Math.floor((i.element[0].offsetTop+a.scrollTop()-a.offset().top)/this.element.find(".e-workcells").outerHeight()),ci=n(this.element.find(".e-workcellstab tr")[hi]).find("td")[ki];if(!n(ci).hasClass("e-resourceheadercells")&&!t.isNullOrUndefined(ci)){u=new Date(this._dateRender[0]);vt=(i.element[0].offsetLeft+a.scrollLeft()-a.offset().left)*30/this.element.find(".e-workcells").outerWidth();u.setHours(parseInt(r.model.startHour)+Math.round(vt/60));u.setMinutes(parseInt(vt%60));u=new Date(u).getMinutes()>=30?new Date(new Date(u).setHours(new Date(u).getHours()-1)):new Date(u);u.setMinutes(Math.round(u.getMinutes()/10)*10);c=new Date(u);var dt=f[r.model.appointmentSettings.startTime],gt=f[r.model.appointmentSettings.endTime],ot=(gt-dt)/1e3,ni=Math.floor(ot/3600),ti=Math.floor(ot%3600/60);s=r._getNewEndTime(u,ni,ti);p=new Date(s);this._cellIndex=Math.floor((i.element[0].offsetLeft+a.scrollLeft()-a.offset().left)/this.element.find(".e-workcells").width());h=hi;n(i.element[0]).hasClass("e-monthappointment")&&(y=new Date(f[r.model.appointmentSettings.startTime]),b=new Date(f[r.model.appointmentSettings.endTime]),o[0][e.recurrence]&&o[0][e.recurrenceRule].toString().indexOf("RECUREDITID")==-1?(y=o[0][this.model.appointmentSettings.startTime],b=o[0][this.model.appointmentSettings.endTime]):o[0][e.recurrence]&&o[0][e.recurrenceRule].toString().indexOf("RECUREDITID")>0&&(f=o[0],y=o[0][this.model.appointmentSettings.startTime],b=o[0][this.model.appointmentSettings.endTime]),u=new Date(r.monthDays[this._cellIndex]),u.setHours(y.getHours(),y.getMinutes(),y.getSeconds()),c=new Date(u),lt=u.getTime()-new Date(y).getTime(),s=new Date(new Date(b).getTime()+lt),p=new Date(s))}}if(f[e.recurrence]==1&&f[e.recurrenceRule].indexOf("RECUREDITID")==-1){var li=(new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,nt),yt=new t.DataManager(this._processed).executeLocal(li)[0],v={};n.extend(v,f);ut=new Date(new Date(this.model.maxDate).getTime());ut.setHours(23,59,59);p>=new Date(this.model.minDate)&&p<=ut?(r._deleteOcurrence(parseInt(f[e.id]),yt[e.startTime]),this._processed=this._sortAppById(this._processed),ai=this._processed.length>0?this._processed[this._processed.length-1][e.id]+1:1,v[e.recurrenceRule]=f[e.recurrenceRule]+";RECUREDITID="+v[e.id],r._trigger("dragStop",{appointment:v})||(v[e.startTime]=c,v[e.endTime]=p),v[e.id]=ai,t.isNullOrUndefined(it)||(v[e.allDay]=it),!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&(v=this._getDragDropResourceData(r,h,v)),g={data:v},ft=this._timeZoneConversion(g.data),promise=r._dataManager.insert(ft),new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,g.data),n.isFunction(promise.promise)&&r.dataSource()instanceof t.DataManager?(promise.done(function(){r._processed.splice(r._processed.indexOf(yt),1);r._appointmentProcessing(v);r._renderSingleApp(v,g.data);r._trigger("actionComplete",{appointment:v,requestType:"appointmentDrag"})}),promise.fail(function(){r._renderAppointmentAll()})):(r._processed.splice(r._processed.indexOf(yt),1),this._processed.push(g.data),this._renderSingleApp(v,g.data),r._trigger("actionComplete",{appointment:v,requestType:"appointmentDrag"}))):this._renderAppointmentAll()}else{var li=(new t.Query).where(r.model.appointmentSettings.id,t.FilterOperators.equal,f[r.model.appointmentSettings.id]),l=new t.DataManager(this._currentAppointmentData).executeLocal(li),ut=new Date(new Date(this.model.maxDate).getTime());ut.setHours(23,59,59);p>=new Date(this.model.minDate)&&p<=ut&&(r._trigger("dragStop",{appointment:l[0]})||(l[0][r.model.appointmentSettings.startTime]=c,l[0][r.model.appointmentSettings.endTime]=p),t.isNullOrUndefined(it)||(l[0][r.model.appointmentSettings.allDay]=it));this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&r.element.find("#categorybar_"+f[r.model.appointmentSettings.id]).remove();!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&(l[0]=this._getDragDropResourceData(r,h,l[0]));ft=this._timeZoneConversion(l[0]);promise=r._dataManager.update(r.model.appointmentSettings.id,ft);vi=this._reverseTimeZoneConversion(ft);new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,vi);promise&&n.isFunction(promise.promise)&&r.dataSource()instanceof t.DataManager?(promise.done(function(){new t.DataManager(r._processed).update(r.model.appointmentSettings.id,l[0]);this.model.orientation=="vertical"&&this.currentView()!=="month"&&l[0][e.allDay]==1?(r.element.find("div.e-alldayappointment").remove(),r._renderAllDayAppointments(),r._unWireResizeEvents(),r._wireResizeEvents(),r._dragdropAppointments()):r._renderSingleApp(l[0],l[0]);r._trigger("actionComplete",{appointment:l,requestType:"appointmentDrag"})}),promise.fail(function(){r._renderAppointmentAll()})):(new t.DataManager(r._processed).update(r.model.appointmentSettings.id,l[0]),this.element.find("#Appointment_"+nt).remove(),(l[0][e.endTime]-l[0][e.startTime])/36e5>24&&r._dataProcessing(yi),this.model.orientation=="vertical"&&this.currentView()!=="month"&&l[0][e.allDay]==1?(r.element.find("div.e-alldayappointment").remove(),r._renderAllDayAppointments(),r._unWireResizeEvents(),r._wireResizeEvents(),r._dragdropAppointments()):r._renderSingleApp(l[0],l[0]),r._trigger("actionComplete",{appointment:l,requestType:"appointmentDrag"}));n(i.element[0]).remove()}},_getAppointmentByParentId:function(i){var f=this._currentAppointmentData,u=new t.DataManager(this._processed).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,i)),r=new t.DataManager(f).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,parseInt(u[0].ParentId)));return n.isEmptyObject(r)?r:r[0]},_renderAppointmentAll:function(){this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment").remove();this.element.find("div.e-categorybar").remove();this.currentView()=="month"||this._isCustomView()?this._renderMonthAppointment():(this._renderAppointments(),this.model.orientation=="vertical"&&this._renderAllDayAppointments(),this.model.enableAppointmentNavigation&&this._nextPrevButton(this._filtered));this._wireResizeEvents();this._dragdropAppointments()},_getNewEndTime:function(n,t,i){var r=new Date(n);return r.setHours(r.getHours()+t),r.setMinutes(r.getMinutes()+i),r},_getNewStartTime:function(n,t){return t.setHours(t.getHours()+parseInt(this.model.startHour)+parseInt(n/60)),t.setMinutes(t.getMinutes()+parseInt(n%60)),t.setMinutes(Math.round(t.getMinutes()/10)*10),t},_createTemplate:function(t,i){var r=document.createElement("script");return r.id=this._id+i+"_Template",r.type="text/x-jsrender",r.text=t,n("body").append(r),r},_documentOnKeyDown:function(n){if(this.model.allowKeyboardNavigation){var t=n.target||document.activeElement||n.srcElement;n.which==27?this._processEscapeKey():n.which==13?this._processEnterKey(t):n.shiftKey==!1&&n.which==9&&this._processWindowTab(t)}},_processWindowTab:function(t){n(t).hasClass("qAppDone")?this._quickAppointWindow.find(".subject").focus():n(t).hasClass("e-appointcancel")||n(t).hasClass("e-cancelrecur")?this._appointmentAddWindow.find(".subject").focus():n(t).hasClass("e-editseries")&&this.model.showQuickWindow&&this._quickAppDetailsWindow.focus()},_onKeyDown:function(i){var c,o,l,e,s,h,a,f;if(this.model.allowKeyboardNavigation){this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");var u=this.element.find("div.e-draggableworkarea tr"),r=i.target||document.activeElement||i.srcElement,f=n(r).hasClass("e-workcells")?n(r).index():n(r).hasClass("e-alldaycells")?n(r).index():7-((parseInt(n(r).index()/7)+1)*7-n(r).index())+n(r).parent().index()*7;this.model.orientation=="horizontal"&&(i.which==39&&(f=f+1),i.which==37&&(f=f-1),f=this.model.currentView!=="month"?Math.floor(f/((this.model.endHour-this.model.startHour)*2)):f);c=this.model.orientation=="horizontal"&&this.model.currentView=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender;o=new Date(c[f]);o>=this.model.minDate&&o<=this.model.maxDate&&(this.element.find("#"+this._id+"_navigator").ejDatePicker("hide"),(n(r).hasClass("e-workcells")||n(r).hasClass("e-alldaycells")||n(r).hasClass("e-monthcells"))&&n(r).addClass("e-selectedCell"),i.shiftKey==!1&&i.which==38?(this._stopDefaultAction(i),this._processUpArrow(r,u)):i.shiftKey==!1&&i.which==40?(this._stopDefaultAction(i),this._processDown(r,u)):i.ctrlKey==!1&&i.shiftKey==!1&&i.which==39?(this._stopDefaultAction(i),this._processRight(r,u)):i.ctrlKey==!1&&i.shiftKey==!1&&i.which==37?(this._stopDefaultAction(i),this._processLeft(r,u)):i.shiftKey==!0&&i.which==38?(this._stopDefaultAction(i),this._processShiftUp(r,i,u)):i.shiftKey==!0&&i.which==40?(this._stopDefaultAction(i),this._processShiftDown(r,i,u)):i.shiftKey==!0&&i.which==37?(this._stopDefaultAction(i),this._processShiftLeft(r,i,u)):i.shiftKey==!0&&i.which==39&&(this._stopDefaultAction(i),this._processShiftRight(r,i,u)));i.altKey==!0&&i.which==67?(this._stopDefaultAction(i),this.element.find(".e-datedisplay").click()):i.ctrlKey==!0&&i.which==37?(this._stopDefaultAction(i),this.element.find("div.e-navigateprevious").click(),this.element.find("div.e-navigateprevious").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):i.ctrlKey==!0&&i.which==39?(this._stopDefaultAction(i),this.element.find("div.e-navigatenext").click(),this.element.find("div.e-navigatenext").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):i.altKey==!0&&i.which==107||i.altKey==!0&&i.which==187||i.altKey==!0&&i.which==61?(this._stopDefaultAction(i),this._navigateToolbarRight(i)):i.altKey==!0&&i.which==189||i.altKey==!0&&i.which==109||i.altKey==!0&&i.which==45||i.altKey==!0&&i.which==173?(this._stopDefaultAction(i),this._navigateToolbarLeft(i)):i.ctrlKey==!0&&i.which==67?(this._stopDefaultAction(i),this._cancel()):i.which==32?(this._stopDefaultAction(i),n(document.activeElement)[0]===this.element.find("div.e-navigateprevious")[0]?(this.element.find("div.e-navigateprevious").click(),this.element.find("div.e-navigateprevious").attr("tabIndex",0).focus()):n(document.activeElement)[0]===this.element.find("div.e-navigatenext")[0]&&(this.element.find("div.e-navigatenext").click(),this.element.find("div.e-navigatenext").attr("tabIndex",0).focus()),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):i.altKey==!0&&i.which==78?(this._stopDefaultAction(i),this._newAppWindow(r,u),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")):i.ctrlKey==!0&&i.which==69&&this.element.find(".e-selectedAppointment").length>0?(this._stopDefaultAction(i),l=this.element.find(".e-selectedAppointment"),this._editKey=!0,this._cellClick=!1,this._appointmentWindow(l),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")):i.which==46?(this._stopDefaultAction(i),e=this.element.find(".e-selectedAppointment"),e.length>0&&(s=e[0].id.split("_")[1],h=this._getAppointmentByParentId(s),e.length!=0&&t.isNullOrUndefined(h[this.model.appointmentSettings.recurrenceRule])?this._deleteApp(parseInt(s)):this._deleteApp(parseInt(h[this.model.appointmentSettings.id])))):i.shiftKey==!0&&i.which==9?(this._stopDefaultAction(i),this._reverseTab(r,i,u),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")):i.shiftKey==!1&&i.which==9&&(this._stopDefaultAction(i),this._processTab(r,i,u),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide"));this.model.orientation==="horizontal"?(this.currentView()!="month"?n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-this.element.find(".e-draggableworkarea").scrollLeft()+"px"):this.element.find(".e-headerdays").css("left",-this.element.find(".e-draggableworkarea").scrollLeft()+"px"),this.currentView()!=="day"&&this.currentView()!=="month"&&(a=n(this.element.find(".e-headercells").find(".e-activeview").parent()).index(),f=Math.floor(this.element.find(".e-draggableworkarea").scrollLeft()/(this.element.find(".e-workcells").width()+1)/48),a!==f&&this.element.find(".e-headercells").children().removeClass("e-activeview"),n(this.element.find(".e-headercells")[f]).children().addClass("e-activeview"))):n(r).hasClass("e-monthcells")||this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")}},_processShiftUp:function(t,i,r){var u,o,s;if(this.model.orientation=="horizontal")return!1;if(n(t).hasClass("e-workcells")){var h=r.length-1,f=n(t).parent()[0].rowIndex,e=n(t)[0].cellIndex;f>0&&f<=h&&f!="undefined"?(u=parseInt(f)-1,u>=0&&(n(r[u].cells[e]).hasClass("e-selectedCell")?(n(r[u].cells[e]).attr("tabIndex",0).focus(),n(r[f].cells[e]).removeClass("e-selectedCell")):(n(r[f].cells[e]).addClass("e-selectedCell"),n(r[u].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus())),this._currentRowIndex=u,this._currentColIndex=e):(n(r[f].cells[e]).attr("tabIndex",0).focus(),this._currentRowIndex=f,this._currentColIndex=e)}else if(n(t).hasClass("e-monthcells")){var c=Math.floor(n(t).index()/7),h=r.length-1,l=7*(c+1),a=7*parseInt(c),f=n(t).parent()[0].rowIndex,e=n(t)[0].cellIndex;if(f>0&&f<=h&&f!="undefined")if(u=parseInt(f)-1,u>=0)if(n(r[u].cells[e]).hasClass("e-selectedCell")){for(o=e;o>=a;o--)n(r[f].cells[o]).attr("tabIndex",0).focus(),n(r[f].cells[o]).removeClass("e-selectedCell");for(s=l-1;s>=e;s--)u>=0&&(n(r[u].cells[s]).attr("tabIndex",0).focus(),n(r[u].cells[s]).removeClass("e-selectedCell"));n(r[u].cells[e]).addClass("e-selectedCell")}else{for(o=e;o>=a;o--)n(r[f].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();for(s=l-1;s>=e;s--)u>=0&&n(r[u].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else n(r[u+1].cells[e]).attr("tabIndex",0).focus();else return!1}else return!1},_processShiftDown:function(t,i,r){var e,o,s;if(this.model.orientation=="horizontal")return!1;if(n(t).hasClass("e-workcells")){var h=r.length-1,u=n(t).parent()[0].rowIndex,f=n(t)[0].cellIndex;u>=0&&u<=h&&u!="undefined"&&(n(r[u].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus(),e=parseInt(u)+1,e<=h?(n(r[e].cells[f]).hasClass("e-selectedCell")?(n(r[e].cells[f]).attr("tabIndex",0).focus(),n(r[u].cells[f]).removeClass("e-selectedCell")):(n(r[u].cells[f]).addClass("e-selectedCell"),n(r[e].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus()),this._currentRowIndex=e,this._currentColIndex=f):(n(r[u].cells[f]).attr("tabIndex",0).focus(),this._currentRowIndex=u,this._currentColIndex=f))}else if(n(t).hasClass("e-monthcells")){var c=Math.floor(n(t).index()/7),h=r.length-1,l=7*(c+1),a=7*parseInt(c),u=n(t).parent()[0].rowIndex,f=n(t)[0].cellIndex;if(u>=0&&u<=h&&u!="undefined")if(e=parseInt(u)+1,e<this._dateRender.length/7)if(n(r[e].cells[f]).hasClass("e-selectedCell")){for(o=f;o<=l-1;o++)n(r[u].cells[o]).attr("tabIndex",0).focus(),n(r[u].cells[o]).removeClass("e-selectedCell");for(s=a;s<=f;s++)e<this._dateRender.length/7&&(n(r[e].cells[s]).attr("tabIndex",0).focus(),n(r[e].cells[s]).removeClass("e-selectedCell"));n(r[e].cells[f]).addClass("e-selectedCell")}else{for(o=f;o<=l-1;o++)n(r[u].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();for(s=a;s<=f;s++)e<this._dateRender.length/7&&n(r[e].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else n(r[e-1].cells[f]).attr("tabIndex",0).focus();else return!1}else return!1},_processShiftLeft:function(t,i,r){var nt=r.length-1,s,h,c,y;if(n(t).hasClass("e-workcells")){var p=t,b=this.model.currentView=="day"?1:this.model.currentView=="workweek"?5:7,k=this.model.orientation=="vertical"?b:this.model.currentView=="month"?this.totdays.length:b*(this.model.endHour-this.model.startHour)*2,w=Math.floor(n(p).index()/k),tt=k*w,l=n(p)[0].cellIndex,f=n(p).parent()[0].rowIndex,e=l-1,d=this.model.orientation=="vertical"?0:f,g=this.model.orientation=="vertical"?nt:f;if(l>0&&e>parseInt(tt)-1&&l!="undefined"){if(n(r[f].cells[e]).hasClass("e-selectedCell")){for(s=d;s<=parseInt(f);s++)n(r[s].cells[l]).removeClass("e-selectedCell");for(h=g;h>=parseInt(f);h--)n(r[h].cells[e]).removeClass("e-selectedCell");n(r[f].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else{for(s=d;s<=parseInt(f);s++)n(r[s].cells[l]).addClass("e-selectedCell");for(h=g;h>=parseInt(f);h--)n(r[h].cells[e]).addClass("e-selectedCell");n(r[f].cells[e]).attr("tabIndex",0).focus()}this._currentRowIndex=f;this._currentColIndex=e}else n(r[f].cells[e+1]).attr("tabIndex",0).focus(),this._currentRowIndex=f,this._currentColIndex=e+1}else if(n(t).hasClass("e-monthcells")){var w=Math.floor(n(t).index()/7),nt=r.length-1,a=7*(parseInt(w)+1),v=7*parseInt(w),o=n(t).parent()[0].rowIndex,u=n(t)[0].cellIndex;if(u>=v&&u<=a&&u!="undefined")newcur=parseInt(u)-1,n(r[o].cells[newcur]).hasClass("e-selectedCell")?u==v&&o>=1?(c=parseInt(o)-1,y=parseInt(a)-1,c>=0&&(n(r[c].cells[y]).attr("tabIndex",0).focus(),n(r[c].cells[u]).removeClass("e-selectedCell"),n(r[o].cells[v]).removeClass("e-selectedClass"))):u<a&&(newcur=parseInt(u)-1,n(r[o].cells[newcur]).attr("tabIndex",0).focus(),n(r[o].cells[u]).removeClass("e-selectedCell")):u==v&&o>=0?(c=parseInt(o)-1,y=parseInt(a)-1,c>=0?n(r[c].cells[y]).addClass("e-selectedCell").attr("tabIndex",0).focus():n(r[c+1].cells[u]).attr("tabIndex",0).focus()):u<a&&(newcur=parseInt(u)-1,n(r[o].cells[newcur]).addClass("e-selectedCell").attr("tabIndex",0).focus());else return}else return!1},_processShiftRight:function(t,i,r){var s,h,o;if(n(t).hasClass("e-workcells")){var k=r.length-1,v=this.model.currentView=="day"?1:this.model.currentView=="workweek"?5:7,y=this.model.orientation=="vertical"?v:this.model.currentView=="month"?this.totdays.length:v*(this.model.endHour-this.model.startHour)*2,a=Math.floor(n(t).index()/y),c=y*(a+1),f=n(t).parent()[0].rowIndex,u=n(t)[0].cellIndex,e=parseInt(u)+1,p=this.model.orientation=="vertical"?0:f,w=this.model.orientation=="vertical"?k:f;if(u>=0&&u<parseInt(c)-1&&u!="undefined"){if(n(r[f].cells[e]).hasClass("e-selectedCell")){for(s=parseInt(f);s<=w;s++)n(r[s].cells[u]).removeClass("e-selectedCell");for(h=p;h<=f;h++)n(r[h].cells[e]).removeClass("e-selectedCell").attr("tabIndex",0).focus();n(r[f].cells[e]).addClass("e-selectedCell")}else{for(s=parseInt(f);s<=w;s++)n(r[s].cells[u]).addClass("e-selectedCell");for(h=p;h<=f;h++)n(r[h].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()}this._currentRowIndex=f;this._currentColIndex=e}else n(r[f].cells[u]).attr("tabIndex",0).focus()}else if(n(t).hasClass("e-monthcells")){var a=Math.floor(n(t).index()/7),k=r.length-1,l=c=7*(parseInt(a)+1),b=7*parseInt(a),f=n(t).parent()[0].rowIndex,u=n(t)[0].cellIndex,e=parseInt(u)+1;if(u>=0&&u<=parseInt(c)-1&&u!="undefined")n(r[f].cells[e]).hasClass("e-selectedCell")?(e<l&&(n(r[f].cells[e]).attr("tabIndex",0).focus(),n(r[f].cells[u]).removeClass("e-selectedCell")),u==parseInt(c)-1&&f<this._dateRender.length/7&&(o=parseInt(f)+1,u=b,o<this._dateRender.length/7&&(n(r[o].cells[u]).removeClass("e-selectedCell").attr("tabIndex",0).focus(),e<l&&(n(r[o].cells[e]).attr("tabIndex",0).focus(),n(r[o].cells[u]).removeClass("e-selectedCell"))))):(e<l&&n(r[f].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus(),u==parseInt(c)-1&&f<this._dateRender.length/7&&(o=parseInt(f)+1,u=b,o<this._dateRender.length/7?(n(r[o].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus(),e<l&&n(r[o].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(r[o-1].cells[e-1]).attr("tabIndex",0).focus()));else return!1}else return!1},_processEnterKey:function(t){var u,f,r,i;n(t).hasClass("e-workcells")||n(t).hasClass("e-monthcells")||n(t).hasClass("e-alldaycells")?(u=this.element.find("td.e-selectedCell"),f=u.length-1,f==0?this._cellSelection(t):this._multipleCellAppointCreation(t)):n(t).hasClass("e-detailedapp e-detailedwindow")?this._appointmentWindow(t):n(t).parent().hasClass("e-allday")?(r=this._appointmentAddWindow.find("#"+this._id+"allday").ejCheckBox("option","checked"),i=r?!1:!0,this._appointmentAddWindow.find(".allday").ejCheckBox({checked:i})):n(t).parent().hasClass("e-recurrence")?(r=this._appointmentAddWindow.find("#"+this._id+"recurrence").ejCheckBox("option","checked"),i=r?!1:!0,this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:i}),this._recurChecked=i?!0:!1,this._repeat(t)):n(t).hasClass("e-scheduledelete")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-scheduledelete").click():n(t).hasClass("e-editevent")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-editevent").click():n(t).hasClass(".e-editseries")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-editseries").click():n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment")?this._cellSelection(t):n(t).parent().hasClass("e-weekday")&&(r=this._appointmentAddWindow.find("#"+n(t).children()[0].id).ejCheckBox("option","checked"),i=r?!1:!0,this._appointmentAddWindow.find("#"+n(t).children()[0].id).ejCheckBox({checked:i}))},_findMinMaxCellIndex:function(){var f=this.element.find("div.e-draggableworkarea tr"),s=f.length-1,i,t,e,o,r,u=this.currentView(),h=u=="day"?1:u=="workweek"?5:7,c=this;return this.element.find("td.e-selectedCell").each(function(h,c){var l=n(c).index(),a;if(l!=null&&!isNaN(l))if(i==null?(i=l,e=n(c).parent()[0].rowIndex):i<l?i=i:i!=l&&(i=l,e=n(c).parent()[0].rowIndex),t==null){if(t=l,u!="month")for(r=parseInt(t),a=0;a<=s;a++)n(f[a].cells[r]).hasClass("e-selectedCell")&&(o=a)}else if(t>l)t=t;else if(t!=l&&(t=l,u!="month"))for(r=parseInt(t),a=0;a<=s;a++)n(f[a].cells[r]).hasClass("e-selectedCell")&&(o=a)}),{rowInx:e,maxrowInx:o,omincolIndex:i,omaxcolIndex:t}},_multipleCellAppointCreation:function(i){var r,u,y,p;this._cellIndex=n(i).hasClass("e-workcells")?n(i).index():n(i).hasClass("e-alldaycells")?n(i).index():7-((parseInt(n(i).index()/7)+1)*7-n(i).index())+n(i).parent().index()*7;this.model.orientation=="horizontal"&&(this._cellIndex=this.model.currentView!=="month"?Math.floor(this._cellIndex/((this.model.endHour-this.model.startHour)*2)):this._cellIndex,this._workCellIndex=n(i).parent().index());var e=this._findMinMaxCellIndex(),o=this.model.orientation=="horizontal"&&this.model.currentView=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,s=e.omincolIndex,h=e.omaxcolIndex,w=e.rowInx,b=e.maxrowInx,c=o[s],l=o[h],a=Globalize.culture(this.model.locale);if(this.model.orientation=="vertical"){if(n(i).hasClass("e-workcells"))r=(this.model.startHour+w/2).toString().split("."),u=(this.model.startHour+b/2).toString().split("."),this.cur_StartTime=new Date(c).setHours(parseInt(r[0]),parseInt(r[1])==5?30:00),this.cur_EndTime=new Date(l).setHours(parseInt(u[0]),parseInt(u[1])==5?30:00),this.cur_EndTime=new Date(new Date(this.cur_EndTime).setMinutes(new Date(this.cur_EndTime).getMinutes()+30));else if(n(i).hasClass("e-monthcells")){var f=this.element.find("td.e-selectedCell"),v=f.length-1,k=n(f[0]).parent().index()*7+(n(f[0]).index()-Math.floor(n(f[0]).index()/7)*7),d=n(f[v]).parent().index()*7+(n(f[v]).index()-Math.floor(n(f[v]).index()/7)*7),g=new Date(this._dateRender[k]),nt=new Date(this._dateRender[d]);this.cur_StartTime=new Date(new Date(g).setHours(9));this.cur_StartTime=new Date(this.cur_StartTime).setMinutes(00);this.cur_EndTime=new Date(new Date(nt).setHours(9));this.cur_EndTime=new Date(new Date(this.cur_EndTime).setMinutes(30))}}else if(this.currentView()!="month"){var c=o[0],l=o[0],r=(this.model.startHour+s/2).toString().split("."),u=(this.model.startHour+h/2).toString().split(".");this.cur_StartTime=new Date(c).setHours(parseInt(r[0]),parseInt(r[1])==5?30:00);this.cur_EndTime=new Date(l).setHours(parseInt(u[0]),parseInt(u[1])==5?30:00);this.cur_EndTime=new Date(new Date(this.cur_EndTime).setMinutes(new Date(this.cur_EndTime).getMinutes()+30))}else{var c=this.totdays[s],l=this.totdays[h],r=this.model.startHour.toString().split("."),u=this.model.startHour.toString().split(".");this.cur_StartTime=new Date(c).setHours(parseInt(r[0]),parseInt(r[1])==5?30:00);this.cur_EndTime=new Date(l).setHours(parseInt(u[0]),parseInt(u[1])==5?30:00);this.cur_EndTime=new Date(new Date(this.cur_EndTime).setMinutes(new Date(this.cur_EndTime).getMinutes()+30))}this.model.showQuickWindow&&(this._quickAppointWindow.find("#"+this._id+"_quickAppwindow").css("display","block"),(new Date(this.cur_EndTime)-new Date(this.cur_StartTime))/36e5<24?this._quickAppointWindow.find(".e-quickstartend").html(a.calendar.days.names[new Date(this.cur_StartTime).getDay()]+", "+Globalize.format(new Date(this.cur_StartTime),"MMMM")+" "+new Date(this.cur_StartTime).getDate()+", "+Globalize.format(new Date(this.cur_StartTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")+" - "+Globalize.format(new Date(this.cur_EndTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")):this._quickAppointWindow.find(".e-quickstartend").html(a.calendar.days.names[new Date(this.cur_StartTime).getDay()]+", "+Globalize.format(new Date(this.cur_StartTime),"MMMM")+" "+new Date(this.cur_StartTime).getDate()+", "+Globalize.format(new Date(this.cur_StartTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")+" - "+a.calendar.days.names[new Date(this.cur_EndTime).getDay()]+", "+Globalize.format(new Date(this.cur_EndTime),"MMMM")+" "+new Date(this.cur_EndTime).getDate()+", "+Globalize.format(new Date(this.cur_EndTime),this.model.timeMode=="12"?this._pattern.t:"HH:mm")),this._quickAppointWindow.find(".subject").val(""),this.model.readOnly||this._quickAppointWindow.ejDialog("open"),y=n(i).offset().left-(this._quickAppointWindow.width()-n(i).width())/2+10,p=n(i).offset().top-this._quickAppointWindow.height()-10,this._quickAppointWindow.ejDialog({position:{X:y,Y:p}}),this._quickAppointWindow.find(".subject").focus(),t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._getResourceDetails(n(i)));this._cellClick=!0},_addCellSelection:function(t){var i=this.element.find("td.e-selectedCell"),r=i.length-1;r>0&&(this.element.find("td.e-selectedCell").removeClass("e-selectedCell"),n(t[this._currentRowIndex].cells[this._currentColIndex]).addClass("e-selectedCell").attr("tabIndex",0).focus())},_processUpArrow:function(t,i){var e,r,u;if(n(t).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(i[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(t).hasClass("e-selectedCell")&&this._addCellSelection(i),e=this.element.find(".e-alldaycells"),n(t).hasClass("e-workcells")){var o=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)-1;if(r>0&&r<=o&&r!="undefined"){if(n(i[r-1].cells[u]).hasClass("e-resourceheadercells"))return!1;n(i[r].cells[u]).removeClass("e-selectedCell").blur();n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else r==0&&(this.model.orientation=="vertical"?(r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(this.element).attr("tabIndex",0).focus(),n(e[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else{if(n(t).hasClass("e-alldaycells"))return!1;if(n(t).hasClass("e-monthcells")){var o=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)-1;if(r>=0&&r<=o&&r!="undefined")f>=0?(n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1}else return!1}},_processDown:function(t,i){var o,s;if(n(t).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(i[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(t).hasClass("e-selectedCell")&&this._addCellSelection(i),n(t).hasClass("e-workcells")){var e=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)+1;if(r>=0&&r<=e&&r!="undefined")if(f<=e){if(n(i[r+1].cells[u]).hasClass("e-resourceheadercells"))return!1;n(i[r].cells[u]).removeClass("e-selectedCell").blur();n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else n(i[r].cells[u]).attr("tabIndex",0).focus()}else if(n(t).hasClass("e-alldaycells"))o=this.element.find("td.e-selectedCell")[0].cellIndex,s=this.element.find(".e-alldaycells"),n(s[o]).removeClass("e-selectedCell").blur(),n(i[0].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(n(t).hasClass("e-monthcells")){var e=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)+1;r>=0&&r<e&&r!="undefined"&&(f<=7?(n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[f-1].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else return!1},_processRight:function(i,r){var c,l,a,s,p,w;if(n(i).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i).hasClass("e-selectedCell")&&this._addCellSelection(r),n(i).hasClass("e-workcells")){c=this.model.currentView=="day"?1:this.model.currentView=="workweek"?5:7;l=this.model.orientation=="vertical"?c:this.model.currentView=="month"?this.totdays.length:c*(this.model.endHour-this.model.startHour)*2;maxcolindex=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&this.model.orientation=="vertical"?this.render_Resources[this.render_Resources.length-1].length*l:l;var f=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,e=parseInt(u)+1;if(u>=0&&u<parseInt(maxcolindex)-1&&u!="undefined")n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(u==parseInt(maxcolindex)-1)this.currentView()!="month"?(a=n(i).parent()[0].rowIndex,this.element.find("div.e-navigatenext").click(),n(r[a].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(this.element.find("div.e-navigatenext").click(),n(n(".e-workcellstab").find("tr")[f].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());else return!1}else if(n(i).hasClass("e-monthcells")){var v=Math.floor(n(i).index()/7),g=r.length-1,y=resmaxcolindex=7*(parseInt(v)+1),k=7*parseInt(v),f=n(i).parent()[0].rowIndex,u=n(i)[0].cellIndex,e=parseInt(u)+1;e<y&&(n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus());u==parseInt(resmaxcolindex)-1&&f<this._dateRender.length/7&&(n(r[f].cells[u]).removeClass("e-selectedCell").blur(),s=parseInt(f)+1,u=k,s<this._dateRender.length/7?(n(r[s].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus(),e<y&&n(r[s].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(p=u/7,this.element.find("div.e-navigatenext").click(),w=t.isNullOrUndefined(this.model.group)?0:p*7,n(n(".e-monthcells")[w]).addClass("e-selectedCell").attr("tabIndex",0).focus()))}else if(n(i).hasClass("e-alldaycells")){var o=this.element.find("td.e-selectedCell")[0].cellIndex,h=this.element.find(".e-alldaycells"),b=parseInt(h.length)-1,d=parseInt(o)+1;if(o>=0&&o<b)n(h[o]).removeClass("e-selectedCell").blur(),n(h[d]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(o==b)this.element.find("div.e-navigatenext").click(),n(h[0]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1}},_processLeft:function(i,r){var e,o,v,f,u,a,w,b,k,d;if(n(i).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i).hasClass("e-selectedCell")&&this._addCellSelection(r),n(i).hasClass("e-workcells")){e=this.model.currentView=="day"?1:this.model.currentView=="workweek"?5:7;o=this.model.orientation=="vertical"?e:this.model.currentView=="month"?this.totdays.length:e*(this.model.endHour-this.model.startHour)*2;s=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&this.model.orientation=="vertical"?this.render_Resources[this.render_Resources.length-1].length*o:o;var f=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,l=parseInt(u)-1;if(u>0&&u<=parseInt(s)-1&&u!="undefined")n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(u==0)this.currentView()!="month"?(v=n(i).parent()[0].rowIndex,this.element.find("div.e-navigateprevious").click(),n(r[v].cells[s-1]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(this.element.find("div.e-navigateprevious").click(),n(n(".e-workcellstab").find("tr")[f].cells[this.totdays.length-1]).addClass("e-selectedCell").attr("tabIndex",0).focus());else return!1}else if(n(i).hasClass("e-monthcells")){var y=Math.floor(n(i).index()/7),it=r.length-1,p=7*(parseInt(y)+1),g=7*parseInt(y),e=this.model.currentView=="day"?1:this.model.currentView=="workweek"?5:7,o=this.model.orientation=="vertical"?e:this.model.currentView=="month"?this.totdays.length:e*(this.model.endHour-this.model.startHour)*2;s=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&this.model.orientation=="vertical"?this.render_Resources[this.render_Resources.length-1].length*o:o;f=this.element.find("td.e-selectedCell").parent()[0].rowIndex;u=this.element.find("td.e-selectedCell")[0].cellIndex;u==g&&f>=0?(a=parseInt(f)-1,w=parseInt(p)-1,a>=0?(n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[a].cells[w]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(b=u/7,this.element.find("div.e-navigateprevious").click(),k=this._dateRender.length/7,d=t.isNullOrUndefined(this.model.group)?0:b*7,n(n(".e-workcellstab").find("tr")[k-1].cells[d+6]).addClass("e-selectedCell").attr("tabIndex",0).focus())):u<p&&(l=parseInt(u)-1,n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[l]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else if(n(i).hasClass("e-alldaycells")){var s=this.currentView()=="day"?1:this.currentView()=="workweek"?5:7,h=this.element.find("td.e-selectedCell")[0].cellIndex,c=this.element.find(".e-alldaycells"),nt=parseInt(c.length)-1,tt=parseInt(h)-1;if(h>0&&h<=nt)n(c[h]).removeClass("e-selectedCell").blur(),n(c[tt]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(h==0)this.element.find("div.e-navigateprevious").click(),n(c[s-1]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1}},_navigateToolbarRight:function(n){var t=this.model.views,i=this.element.find(".e-"+this.currentView()).parent().index(),r;i<t.length-1&&(r=t[i+1].toLowerCase(),this._navView=!0,this._viewChange(n,this.currentView(),r),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}))},_navigateToolbarLeft:function(n){var t=this.element.find(".e-"+this.currentView()).parent().index(),i;t>0&&(i=this.model.views[t-1].toLowerCase(),this._navView=!0,this._viewChange(n,this.currentView(),i),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}))},_newAppWindow:function(i){var b,c;if(n(i).hasClass("e-selectedCell")){this._currentAction=t.Schedule.Actions.Add;var r=i==null?event:i,k=n(r).parent().index(),ft=n(r).index(),o=this.model.orientation=="horizontal"&&this.model.currentView=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,d=this.element.find("td.e-selectedCell"),w=parseInt(d.length)-1,s=n(r).hasClass("e-workcells")?n(r).index():n(r).hasClass("e-alldaycells")?n(r).index()-1:n(r).parent().index()*7+(n(r).index()-Math.floor(n(r).index()/7)*7);if(this.model.orientation==="horizontal"&&this.model.currentView!=="month"&&(s=Math.floor(s/((this.model.endHour-this.model.startHour)*2))),this._workCellIndex=n(r).parent().index(),w==0)startdate=new Date(o[s]),n(r).hasClass("e-workcells")?(b=this.model.startHour+k/2,c=b.toString().split("."),startTime=new Date(startdate).setHours(parseInt(c[0]),parseInt(c[1])==5?30:00),endTime=new Date(new Date(startTime).setMinutes(new Date(startTime).getMinutes()+30))):n(r).hasClass("e-alldaycells")?(startTime=new Date(startdate.setHours(0,0)),endTime=new Date(startTime.setHours(0,0)),this._appointmentAddWindow.find(".allday ").ejCheckBox({checked:!0})):n(r).hasClass("e-monthcells")&&(startTime=new Date(new Date(startdate).setHours(9)),startTime=new Date(startTime).setMinutes(00),endTime=new Date(new Date(startTime).setMinutes(30)));else if(w>0){var h=this._findMinMaxCellIndex(),l=h.omincolIndex,a=h.omaxcolIndex,g=h.rowInx,nt=h.maxrowInx;if(this.model.orientation=="vertical"){if(n(i).hasClass("e-workcells")){var v=o[l],y=o[a],f=(this.model.startHour+g/2).toString().split("."),e=(this.model.startHour+nt/2).toString().split(".");startTime=new Date(new Date(v).setHours(parseInt(f[0]),parseInt(f[1])==5?30:00));endTime=new Date(y).setHours(parseInt(e[0]),parseInt(e[1])==5?30:00);endTime=new Date(new Date(endTime).setMinutes(new Date(endTime).getMinutes()+30))}else if(n(i).hasClass("e-monthcells")){var u=this.element.find("td.e-selectedCell"),p=u.length-1,tt=n(u[0]).parent().index()*7+(n(u[0]).index()-Math.floor(n(u[0]).index()/7)*7),it=n(u[p]).parent().index()*7+(n(u[p]).index()-Math.floor(n(u[p]).index()/7)*7),rt=new Date(this._dateRender[tt]),ut=new Date(this._dateRender[it]);startTime=new Date(new Date(rt).setHours(9));startTime=new Date(new Date(startTime).setMinutes(00));endTime=new Date(new Date(ut).setHours(9));endTime=new Date(new Date(endTime).setMinutes(30))}}else if(this.currentView()!="month"){var v=o[0],y=o[0],f=(this.model.startHour+l/2).toString().split("."),e=(this.model.startHour+a/2).toString().split(".");startTime=new Date(new Date(v).setHours(parseInt(f[0]),parseInt(f[1])==5?30:00));endTime=new Date(y).setHours(parseInt(e[0]),parseInt(e[1])==5?30:00);endTime=new Date(new Date(endTime).setMinutes(new Date(endTime).getMinutes()+30))}else{var v=this.totdays[l],y=this.totdays[a],f=this.model.startHour.toString().split("."),e=this.model.startHour.toString().split(".");startTime=new Date(v).setHours(parseInt(f[0]),parseInt(f[1])==5?30:00);endTime=new Date(y).setHours(parseInt(e[0]),parseInt(e[1])==5?30:00);endTime=new Date(new Date(endTime).setMinutes(new Date(endTime).getMinutes()+30))}}t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._renderResourceData(n(r),s);this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",Globalize.format(new Date(startTime),this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",Globalize.format(new Date(endTime),this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(new Date(startTime),this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(new Date(endTime),this._pattern.t));(n(i).hasClass("e-alldaycells")||this.currentView()=="month"||this._isCustomView())&&this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0});this._alldayCheck();this.model.timeZone==null?(this._appointmentAddWindow.find("#startutc").val("UTC "+Globalize.format(new Date(startTime),"zzz")),this._appointmentAddWindow.find("#endutc").val("UTC "+Globalize.format(new Date(endTime),"zzz"))):(this._appointmentAddWindow.find("#startutc").val(this.model.timeZone),this._appointmentAddWindow.find("#endutc").val(this.model.timeZone));this.model.readOnly||this._appointmentAddWindow.ejDialog("open");this._appointmentAddWindow.find(".subject").focus();this._cellClick=!1}},_processTab:function(t,i,r){var u=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment"),s,c,e,o,f,h;if((t.id==this._id||n(t).hasClass("e-datedisplay"))&&(u.length!=0?n(u[0]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()),n(t).hasClass("e-selectedCell")&&u.length!=0){if(s=this.element.find("td.e-selectedCell"),c=parseInt(s.length)-1,c>0)for(e=0;e<=c;e++)s[e].blur(),n(s[e]).removeClass("e-selectedCell");else n(t).removeClass("e-selectedCell").blur();n(u[0]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()}n(t).hasClass("e-navigateprevious")?this.element.find(".e-navigatenext").attr("tabIndex",0).focus():n(t).hasClass("e-navigatenext")&&(n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus(),n(r[0].cells[0]).hasClass("e-resourceheadercells")&&n(r[1].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());(n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment"))&&(o=u.length,f=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment").index(n(".e-selectedAppointment")),f<o&&f>=0?(n(u[f]).removeClass("e-selectedAppointment").blur(),h=parseInt(f)+1,h<o?n(u[h]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():h==o&&this.element.find(".e-navigateprevious").attr("tabIndex",0).focus()):f==o&&this.element.find(".e-navigateprevious").attr("tabIndex",0).focus())},_reverseTab:function(t,i,r){var u=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment"),h,e,c,l,o,f,s;if((t.id==this._id||n(t).hasClass("e-datedisplay"))&&(e=parseInt(u.length)-1,u.length!=0&&n(u[e]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()),h=u.length,n(t).hasClass("e-selectedCell")&&(e=u.length-1,u.length!=0)){if(c=this.element.find("td.e-selectedCell"),l=parseInt(c.length)-1,l>0)for(o=0;o<=l;o++)n(c[o]).removeClass("e-selectedCell").blur();else n(t).removeClass("e-selectedCell").blur();n(u[e]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()}n(t).hasClass("e-navigatenext")?n(this.element).find(".e-navigateprevious").attr("tabIndex",0).focus():n(t).hasClass("e-navigateprevious")&&(n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus(),n(r[0].cells[0]).hasClass("e-resourceheadercells")&&n(r[1].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());(n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment"))&&(f=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment").index(n(".e-selectedAppointment")),f<h&&f>0?(n(u[f]).removeClass("e-selectedAppointment").blur(),s=parseInt(f)-1,s<h&&f>=0?n(u[s]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():s==0&&n(this.element).find(".e-navigatenext").attr("tabIndex",0).focus()):f==0&&(n(u[f]).removeClass("e-selectedAppointment").blur(),n(this.element).find(".e-navigatenext").attr("tabIndex",0).focus()))},_stopDefaultAction:function(n){n.cancelBubble=!0;n.returnValue=!1;n.stopPropagation();n.preventDefault()},_getLocalizedLabels:function(n){return t.Schedule.Locale[this.model.locale][n]===r?t.Schedule.Locale["en-US"][n]:t.Schedule.Locale[this.model.locale][n]},saveAppointment:function(i){var r,s;if(!this.model.readOnly){var f=this._sortAppById(this._processed),e,u=this._timeZoneConversion(i),o=this;if(e=f.length>0?f[f.length-1][this.model.appointmentSettings.id]+1:1,t.isNullOrUndefined(i[this.model.appointmentSettings.id])||i[this.model.appointmentSettings.id]==""){if((u[this.model.appointmentSettings.id]=e,i[this.model.appointmentSettings.id]=e,this._trigger("actionBegin",{data:i,requestType:"appointmentSave"}))||this._trigger("appointmentSaved",i))return!1;r=this._dataManager.insert(u);n.isFunction(r.promise)&&this.dataSource()instanceof t.DataManager?r.done(function(){o._trigger("actionComplete",{data:u,requestType:"appointmentSave"})}):this._trigger("actionComplete",{data:i,requestType:"appointmentSave"});new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,i);this._appointmentProcessing(i)}else{if(this._trigger("actionBegin",{data:i,requestType:"appointmentEdit"})||this._trigger("appointmentEdited",i))return!1;r=this._dataManager.update(this.model.appointmentSettings.id,u);n.isFunction(r.promise)&&this.dataSource()instanceof t.DataManager?r.done(function(n){o._trigger("actionComplete",{data:n,requestType:"appointmentEdit"})}):this._trigger("actionComplete",{data:i,requestType:"appointmentEdit"});s=this._reverseTimeZoneConversion(u);new t.DataManager(this._currentAppointmentData).update(this.model.appointmentSettings.id,s);i[this.model.appointmentSettings.recurrence]?this._dataProcessing(this._currentAppointmentData):new t.DataManager(this._processed).update(this.model.appointmentSettings.id,i)}this._renderAppointmentAll()}},print:function(){t.print(this.element)},deleteAppointment:function(n){this.model.readOnly||this._deleteApp(n)},getAppointments:function(){return this.dataSource()},searchAppointments:function(n,i,r,u){var f=t.Query(),e,o=t.isNullOrUndefined(i)?this._getColumns(this.model.appointmentSettings):i;return r=t.isNullOrUndefined(r)?"contains":r,u=t.isNullOrUndefined(u)?!0:u,typeof n=="string"?n.length&&(f.search(n,o,r,u),e=this.dataSource()instanceof t.DataManager?f:this._dataManager.executeLocal(f)):typeof n=="object"&&(e=this.filterAppointments(n)),e},filterAppointments:function(n){var f,u=t.Query(),r,i;if(!t.isNullOrUndefined(n)){for(r=n[0],predicate=t.Predicate(r.field,r.operator,r.value,!r.matchcase),i=1;i<n.length;i++)predicate=predicate[n[i].predicate](n[i].field,n[i].operator,n[i].value,!n[i].matchcase);u.where(predicate);f=this.dataSource()instanceof t.DataManager?u:this._dataManager.executeLocal(u)}return f},exportSchedule:function(i,r,u){var y=JSON.parse(JSON.stringify(this.model)),o=JSON.parse(JSON.stringify(this.model.appointmentSettings)),p={action:i,method:"post"},f=t.buildTag("form","",null,p),e,s,h,c,l,a,v;if(this._ignoreFromAppointmentOnExport)for(e=0;e<this._ignoreFromAppointmentOnExport.length;e++)delete o[this._ignoreFromAppointmentOnExport[e]];return t.raiseWebFormsServerEvents?(s={model:y,originalEventType:r},h={model:JSON.stringify(o),appId:u},t.raiseWebFormsServerEvents(r,s,h)):(c={name:"ScheduleModel",type:"hidden",value:JSON.stringify(o)},l=t.buildTag("input","",null,c),t.isNullOrUndefined(u)||(a={name:"AppointmentId",type:"hidden",value:u},v=t.buildTag("input","",null,a),f.append(v)),f.append(l),f.append(this),n("body").append(f),f.submit()),!0}});t.scheduleFeatures.resources&&n.extend(t.Schedule.prototype,t.scheduleFeatures.resources);t.scheduleFeatures.horizontal&&n.extend(t.Schedule.prototype,t.scheduleFeatures.horizontal);t.Schedule.Locale={};t.Schedule.Locale["en-US"]={ReminderWindowTitle:"Reminder window",CreateAppointmentTitle:"Create Appointment",RecurrenceEditTitle:"Edit repeat appointment",RecurrenceEditMessage:"How would you like to change the event in the series?",RecurrenceEditOnly:"Only this appointment",RecurrenceEditSeries:"Entire series",PreviousAppointment:"Previous Appointment",NextAppointment:"Next Appointment",AppointmentSubject:"Subject",StartTime:"Start Time",EndTime:"End Time",AllDay:"All day",Today:"Today",Recurrence:"Repeat",Done:"Done",Cancel:"Cancel",Ok:"Ok",RepeatBy:"Repeat by",RepeatEvery:"Repeat every",RepeatOn:"Repeat on",StartsOn:"Starts on",Ends:"Ends",Summary:"Summary",Daily:"Daily",Weekly:"Weekly",Monthly:"Monthly",Yearly:"Yearly",Every:"Every",EveryWeekDay:"Every weekday",Never:"Never",After:"After",Occurence:"Occurrence(s)",On:"On",Edit:"Edit",RecurrenceDay:"Day(s)",RecurrenceWeek:"Week(s)",RecurrenceMonth:"Month(s)",RecurrenceYear:"Year(s)",The:"The",OfEvery:"of every",First:"First",Second:"Second",Third:"Third",Fourth:"Fourth",Last:"Last",WeekDay:"Weekday",WeekEndDay:"Weekendday",Subject:"Subject",Categorize:"Categories",DueIn:"Due In",DismissAll:"Dismiss All",Dismiss:"Dismiss",OpenItem:"Open Item",Snooze:"Snooze",Day:"Day",Week:"Week",WorkWeek:"Work Week",Month:"Month",CustomView:"Custom View",Agenda:"Agenda",Detailed:"Detailed",EventBeginsin:"Appointment Begins in",Editevent:"Edit Appointment",Editseries:"Edit series",Times:"times",Until:"until",Eventwas:"Appointment was",Hours:"hrs",Minutes:"mins",Overdue:"Overdue Appointment",Days:"day(s)",Event:"Subject",Select:"select",Previous:"prev",Next:"next",Close:"close",Delete:"delete",Date:"Date",Showin:"Show in",Gotodate:"Go To Date",RESOURCES:"RESOURCES"};t.Schedule.Actions={Add:"add",Save:"save",Delete:"delete",EditOcurrence:"editOcurrence",EditSeries:"editSeries"};t.Schedule.CurrentView={Day:"day",Week:"week",Workweek:"workweek",Month:"month",CustomView:"customview"};t.Schedule.TimeMode={Hour12:"12",Hour24:"24"};t.Schedule.Orientation={Vertical:"vertical",Horizontal:"horizontal"}}(jQuery,Syncfusion)})