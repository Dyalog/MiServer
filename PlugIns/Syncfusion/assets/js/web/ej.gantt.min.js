/*!
*  filename: ej.gantt.min.js
*  version : 12.4.0.24
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.draggable.min","./../common/ej.scroller.min","./ej.button.min","./ej.splitter.min","./ej.dialog.min","./ej.datepicker.min","./ej.checkbox.min","./ej.dropdownlist.min","./ej.editor.min","./ej.toolbar.min"],n):n()})(function(){(function(n,t,r){t.widget("ejGantt","ej.Gantt",{_rootCSS:"e-gantt",element:null,validTags:["div"],model:null,_tags:[{tag:"holidays",attr:["day","background","label"],content:"template"},{tag:"stripLines",attr:["day","label","lineStyle","lineColor","lineWidth"],content:"template"},{tag:"editDialogFields",attr:["field","editType"],content:"template"},{tag:"addDialogFields",attr:["field","editType"],content:"template"},{tag:"sortSettings.sortedColumns",attr:["field","direction"]}],_holidays:function(){n("div.e-secondary-canvas-holiday").remove();this._$ganttchartHelper.ejGanttChart("refreshHolidays");this._trigger("refresh")},_stripLines:function(){n("div.e-stripLines").remove();this._$ganttchartHelper.ejGanttChart("refreshStripLines");this._trigger("refresh")},_editDialogFields:function(){this._trigger("refresh")},_addDialogFields:function(){this._trigger("refresh")},defaults:{allowSorting:!1,allowColumnResize:!1,allowSelection:!0,dataSource:null,query:null,taskIdMapping:"",parentTaskIdMapping:"",taskNameMapping:"",startDateMapping:"",endDateMapping:"",baselineStartDateMapping:"",baselineEndDateMapping:"",childMapping:"",durationMapping:"",milestoneMapping:"",progressMapping:"Progress",predecessorMapping:"",resourceInfoMapping:"",resources:[],holidays:[],highlightWeekends:!0,scheduleStartDate:null,scheduleEndDate:null,enableProgressBarResizing:!0,rowHeight:30,includeWeekend:!0,toolbarSettings:{showToolbar:!1,toolbarItems:[]},stripLines:[],workingTimeScale:"TimeScale8Hours",roundOffDayworkingTime:!0,durationUnit:"day",scheduleHeaderSettings:{weekHeaderFormat:"MMM dd , yyyy",dayHeaderFormat:"ddd",yearHeaderFormat:"yyyy",monthHeaderFormat:"MMM",hourHeaderFormat:"HH",scheduleHeaderType:"week",weekendBackground:"#F2F2F2"},taskbarBackground:"",progressbarBackground:"",connectorLineBackground:"",parentTaskbarBackground:"",parentProgressbarBackground:"",connectorlineWidth:1,showTaskNames:!0,showGridCellTooltip:!1,showGridExpandCellTooltip:!1,showProgressStatus:!0,showResourceNames:!0,enableTaskbarDragTooltip:!0,enableTaskbarTooltip:!0,editSettings:{allowEditing:!1,allowAdding:!1,allowDeleting:!1,editMode:"normal"},ganttRecords:[],parentRecords:[],allowKeyboardNavigation:!0,cssClass:"",locale:"en-US",allowMultiSorting:!1,sortSettings:{sortedColumns:[]},enableAltRow:!0,enableVirtualization:!1,progressbarHeight:100,taskbarTooltipTemplate:null,progressbarTooltipTemplate:null,taskbarTooltipTemplateId:null,dateFormat:"",resourceIdMapping:"",resourceNameMapping:"",progressbarTooltipTemplateId:null,taskbarEditingTooltipTemplateId:null,taskbarEditingTooltipTemplate:null,selectedRowIndex:-1,allowGanttChartEditing:!0,sizeSettings:{height:null,width:null},selectedItem:null,weekendBackground:"#F2F2F2",baselineColor:"#fba41c",treeColumnIndex:0,editDialogFields:[],addDialogFields:[],renderBaseline:!1,enableContextMenu:!1,enableResize:!1,enableCollapseAll:!1,rowSelecting:null,rowSelected:null,queryCellInfo:null,queryTaskbarInfo:null,beginEdit:null,endEdit:null,rowDataBound:null,expanding:null,expanded:null,collapsing:null,collapsed:null,actionBegin:null,actionComplete:null,taskbarEditing:null,taskbarEdited:null,load:null,contextMenuOpen:null},dataTypes:{allowSorting:"boolean",allowColumnResize:"boolean",allowSelection:"boolean",taskIdMapping:"string",taskNameMapping:"string",startDateMapping:"string",endDateMapping:"string",baselineStartDateMapping:"string",baselineEndDateMapping:"string",childMapping:"string",durationMapping:"string",milestoneMapping:"string",progressMapping:"string",predecessorMapping:"string",resourceInfoMapping:"string",resources:"array",holidays:"array",highlightWeekends:"boolean",enableProgressBarResizing:"boolean",rowHeight:"number",includeWeekend:"boolean",toolbarSettings:{toolbarItems:"array"},stripLines:"array",scheduleHeaderSettings:"data",taskbarBackground:"string",progressbarBackground:"string",connectorLineBackground:"string",parentTaskbarBackground:"string",parentProgressbarBackground:"string",connectorlineWidth:"number",showTaskNames:"boolean",showProgressStatus:"boolean",showResourceNames:"boolean",enableTaskbarDragTooltip:"boolean",enableTaskbarTooltip:"boolean",editSettings:"data",ganttRecords:"array",parentRecords:"array",allowKeyboardNavigation:"boolean",cssClass:"string",locale:"string",allowMultiSorting:"boolean",showGridExpandCellTooltip:"boolean",sortSettings:{sortedColumns:"array"},enableAltRow:"boolean",enableVirtualization:"boolean",progressbarHeight:"number",dateFormat:"string",resourceIdMapping:"string",resourceNameMapping:"string",allowGanttChartEditing:"boolean",size:{height:"string",width:"string"},selectedItem:"data",weekendBackground:"string",baselineColor:"string",renderBaseline:"boolean",showGridCellTooltip:"boolean",treeColumnIndex:"number",editDialogFields:"array",enableResize:"boolean"},observables:["selectedItem","selectedRowIndex","dataSource"],selectedItem:t.util.valueFunction("selectedItem"),selectedRowIndex:t.util.valueFunction("selectedRowIndex"),dataSource:t.util.valueFunction("dataSource"),getColumns:function(){return this._columns},setColumns:function(n){this._columns=n},_init:function(){var t=this,n=t.model,i;t._initPrivateProperties();t._setCultureInfo();t.element.addClass("e-gantt-core");n.isdesignMode&&(n.taskIdMapping="Id",n.taskNameMapping="Name",n.startDateMapping="StartDate",n.durationMapping="Duration",n.progressMapping="Progress",n.scheduleStartDate="02/23/2014",n.scheduleEndDate="03/10/2014",this.dataSource([{Id:1,Name:"Task 1",StartDate:"02/23/2014",Duration:5,Progress:40},{Id:2,Name:"Task 2",StartDate:"02/24/2014",Duration:5,Progress:40},{Id:3,Name:"Task 3",StartDate:"02/25/2014",Duration:5,Progress:40}]));n.durationUnit=="hours"&&(n.durationUnit="hour");this.dataSource()!==null?this._checkDataBinding():(t.setColumns(t.createTreeGridColumns()),t._initialize());n.enableCollapseAll&&(this.selectedRowIndex()!=-1&&t._deSelectRowItem(),t._collapseAll());n.selectedRowIndex>=0&&n.selectedRowIndex<t._updatedGanttRecords.length&&(i={},i.target="ejTreeGrid",n.selectedItem=i.data=t._updatedGanttRecords[n.selectedRowIndex],i.recordIndex=n.selectedRowIndex,t.rowSelected(i),t._$treegrid.focus())},_deSelectRowItem:function(){var n=this,t=n.model;n._$ganttchartHelper.ejGanttChart("selectRows",-1);n._$treegridHelper.ejTreeGrid("selectRows",-1);this.selectedRowIndex(-1);t.selectedItem=null},_checkDataBinding:function(){var i=this,u=i.model,f,r;this.dataSource()instanceof t.DataManager?this._initDataSource():this.dataSource().length>0&&(u.taskIdMapping.length>0&&u.parentTaskIdMapping.length>0?(f=this.dataSource().slice(0),r=[],n.each(f,function(n,t){r.push(jQuery.extend(!0,{},t))}),i._reconstructDatasource(r),i._createGanttRecords(i.secondaryDatasource)):i._createGanttRecords(this.dataSource()),i._initialize())},_initDataSource:function(){var i=this,r=i.model,u=this._columnToSelect(),i=this,f=this.dataSource().executeQuery(u);f.done(t.proxy(function(t){if(i._retrivedData=i.dataSource().dataSource.offline?i.dataSource().dataSource.json:t.result,r.taskIdMapping.length>0&&r.parentTaskIdMapping.length>0){var f=t.result.slice(0),u=[];n.each(f,function(n,t){u.push(jQuery.extend(!0,{},t))});i._reconstructDatasource(u)}else i._reconstructDatasource(t.result);i._createGanttRecords(i.secondaryDatasource);i._initialize()}))},_columnToSelect:function(){var n=this,i=n.model,r=t.Query();return i.query},_reconstructDatasource:function(n){for(var r,f=this,u=f.model,e=[],i=0;i<n.length;i++)r={},r=t.DataManager(n).executeLocal(t.Query().where(u.parentTaskIdMapping,t.FilterOperators.equal,n[i][u.taskIdMapping])),(t.isNullOrUndefined(n[i][u.parentTaskIdMapping])||n[i][u.parentTaskIdMapping]==0)&&r.length>0?(n[i][u.childMapping]=r,f.secondaryDatasource.push(n[i])):!t.isNullOrUndefined(n[i][u.parentTaskIdMapping])||r&&r.length>0?r&&r.length>0&&!t.isNullOrUndefined(r[0][u.parentTaskIdMapping])?f._appendChildDataItems(f.secondaryDatasource,r):(t.isNullOrUndefined(n[i][u.parentTaskIdMapping])||n[i][u.parentTaskIdMapping]==0)&&r.length==0&&f.secondaryDatasource.push(n[i]):f.secondaryDatasource.push(n[i]),r&&r.length>0?(f._datasourceChildItems=f._reconstructDatasource(r),t.isNullOrUndefined(n[i][u.childMapping])&&(n[i][u.childMapping]=f._datasourceChildItems,f._getParentIndex(n)),f._datasourceChildItems=[]):t.isNullOrUndefined(n[i][u.parentTaskIdMapping])||e.push(n[i]);if(e&&e.length>0)return e},_appendChildDataItems:function(n,i){for(var f=this,r=f.model,u=0;u<n.length;u++)n[u][r.taskIdMapping]===i[0][r.parentTaskIdMapping]?n[u][r.childMapping]=i:!t.isNullOrUndefined(n[u][r.childMapping])&&n[u][r.childMapping].length>0&&f._appendChildDataItems(n[u],i);t.isNullOrUndefined(n.length)&&n&&(n[r.taskIdMapping]===i[0][r.parentTaskIdMapping]?n[r.childMapping]=i:!t.isNullOrUndefined(n[r.childMapping])&&n[r.childMapping].length>0&&f._appendChildDataItems(n[r.childMapping],i))},_getParentIndex:function(n){var o=this,r=o.model,f=o.secondaryDatasource,e=0,u,i;for(n.length>0&&(e=n[0][r.parentTaskIdMapping]),i=0;i<f.length;i++){if(f[i][r.taskIdMapping]==e&&t.isNullOrUndefined(f[i][r.childMapping]))return f[i][r.childMapping]=n,!0;if(u=f[i][r.childMapping],u)for(i=0;i<u.length;i++)if(u[i][r.taskIdMapping]==e&&t.isNullOrUndefined(u[i][r.childMapping]))return u[i][r.childMapping]=n,!0}},updateScheduleDates:function(t,i){var r=this,f=this.model,e,u;f.scheduleStartDate=t;f.scheduleEndDate=i;r._scheduleDays=[];r._scheduleMonths=[];r._scheduleWeeks=[];r._scheduleYears=[];r._calculateHeaderDates();e=n("#ejGanttChart"+r._id).ejGanttChart("instance");u=e.model;r._updateLeftValue();u.projectStartDate=r._getDateFromFormat(r._projectStartDate);u.projectEndDate=r._getDateFromFormat(r._projectEndDate);u.scheduleDays=r._scheduleDays;u.scheduleMonths=r._scheduleMonths;u.scheduleWeeks=r._scheduleWeeks;u.scheduleYears=r._scheduleYears;u.renderBaseline=f.renderBaseline;n("#ejGanttChart"+r._id).ejGanttChart("refreshChartHeader",r._getDateFromFormat(t),r._getDateFromFormat(i));n("#ejGanttChart"+r._id).ejGanttChart("refreshContainersWidth");r._$ganttchartHelper.ejGanttChart("refreshHelper",r._currentViewData,r._updatedGanttRecords,r._totalCollapseRecordCount);f.predecessorMapping&&(r._$ganttchartHelper.ejGanttChart("clearConnectorLines"),r._connectorlineIds=[],r._connectorLinesCollection=[],r._isValidationEnabled=!1,r._createConnectorLinesCollection(),r._isValidationEnabled=!0);e._$bodyContainer.ejScroller("refresh")},reRenderChart:function(i){var r=this,u=r.model,f=r._getDateFromFormat(u.scheduleStartDate),e=r._getDateFromFormat(u.scheduleEndDate);u.ganttRecords=[];u.parentRecords=[];n("#ejGanttChart"+r._id).empty();switch(i){case t.Gantt.ScheduleHeaderType.Week:u.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Week;r._perDayWidth=30;r._calculateWeekSplit(f,e);break;case t.Gantt.ScheduleHeaderType.Day:u.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Day;u.scheduleHeaderSettings.dayHeaderFormat="dd, MMM yy";r._perHourWidth=20;u.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours?r._perDayWidth=r._perHourWidth*24:u.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(r._perDayWidth=r._perHourWidth*24);r._calculateDaySplit(f,e);break;case t.Gantt.ScheduleHeaderType.Month:u.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Month;u.scheduleHeaderSettings.monthHeaderFormat="MMM yyyy";u.scheduleHeaderSettings.weekHeaderFormat="M/dd";r._perDayWidth=10;r._perWeekWidth=70;r._calculateMonthSplit(f,e);break;case t.Gantt.ScheduleHeaderType.Year:u.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Year;r._perDayWidth=3;r._perMonthWidth=90;r._calculateYearSplit(f,e)}r.element.ejGantt("destroy").ejGantt(u);r._isRenddered=!1},_updateGanttRecords:function(){for(var i=this,t=i.model,r=t.ganttRecords.length,n=0;n<r;n++)t.ganttRecords[n].left=t.ganttRecords[n].left/i._prevDayWidth*i._perDayWidth,t.ganttRecords[n].width=t.ganttRecords[n].width/i._prevDayWidth*i._perDayWidth,t.ganttRecords[n].width=t.ganttRecords[n].isMilestone==!0?26:t.ganttRecords[n].width,t.ganttRecords[n].progressWidth=t.ganttRecords[n]._calculateProgressWidth(t.ganttRecords[n].width,t.ganttRecords[n].status)},_initPrivateProperties:function(){var n=this;model=n.model;scheduleMode=model.scheduleHeaderSettings.scheduleHeaderType;n._isFromGantt=!0;n._disabledToolItems=[];n._id=n.element.attr("id");n._scheduleWeeks=[];n._duplicate=!1;n._wrongenddate=!1;n._scheduleYears=[];n._scheduleMonths=[];n._scheduleYears=[];n._scheduleDays=[];n._projectStartDate;n._projectEndDate;n._columns=[];n._rows=[];n._storedIndex=-1;n._perDayWidth;n._prevDayWidth=0;n._perMonthWidth;n._perWeekWidth;n._$treegridPane=null;n._$ganttchartPane=null;n._$treegrid=null;n._$ganttchart=null;n._$ejGantt=null;n._$treegridHelper=null;n._$ganttchartHelper=null;n._tdsOffsetWidth=[];n._ids=[];n._predecessorsCollection=[];n._connectorLinesCollection=[];n._updatedConnectorLineCollection=[];n._connectorlineIds=[];n._updatedGanttRecords=[];n._currentViewData=[];n._gridRows=null;n._collapsedRecordCount=0;n._expandedRecordsCount=0;n._totalCollapseRecordCount=0;n._isInExpandCollapse=!1;n._hiddenRecordCount=0;n.prevPredecessorTO=null;n.prevPredecessorFrom=null;n.prevPredecessorcount=0;n._isValidationEnabled=!0;n._isRenddered=!1;n._holidaysList=n._getHoliday();n._stringHolidays=n._getStringHolidays();n._isinBeginEdit=!1;n._isMileStoneEdited=!1;n._cellEditType=null;n._isinAddnewRecord=!1;n._contextMenuItems=n._getContextMenuItems();n._subContextMenuItems=n._getsubContextMenuItems();n._totalBorderWidth=2;n._totalBorderHeight=model.toolbarSettings.showToolbar?3:2;n._columnHeaderTexts=null;n._editDialogTexts=null;n._months=null;n._days=null;n._emptyRecordText=null;n._commonColumnWidth=150;n._searchString="";n._emptyDataColumns=[];n.secondaryDatasource=[];n._datasourceChildItems=[];n._$predecessorTable=null;n._mappingItems=[];n._editedDialogRecord=null;n._calculateDimensions();n._retrivedData=this.dataSource();scheduleMode=="week"?n._perDayWidth=30:scheduleMode=="year"?(n._perDayWidth=3,n._perMonthWidth=90):scheduleMode=="month"?(n._perDayWidth=10,n._perWeekWidth=70):scheduleMode=="day"&&(n._perHourWidth=20,model.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours?n._perDayWidth=n._perHourWidth*24:model.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(n._perDayWidth=n._perHourWidth*24))},_calculateDimensions:function(){var i=this,r=this.model.sizeSettings.height,u=this.model.sizeSettings.width,f=i.element[0].style.height,e=n(i.element).parent().height(),o=n(i.element).parent().width();i._ganttHeight=t.isNullOrUndefined(r)?f?i.element.height():"450px":r;i._ganttWidth=t.isNullOrUndefined(u)?i.element.width():u;i._ganttHeight=i._ganttHeight.toString().indexOf("%")!==-1?e*parseInt(i._ganttHeight)/100:parseInt(i._ganttHeight);i._ganttWidth=i._ganttWidth.toString().indexOf("%")!==-1?o*parseInt(i._ganttWidth)/100:parseInt(i._ganttWidth)},_setCultureInfo:function(){var i=this,r=i.model,n=r.locale;r.dateFormat=r.dateFormat?r.dateFormat:t.Gantt.localization[n]&&t.Gantt.localization[n].calendars&&t.Gantt.localization[n].calendars.standard.patterns?t.Gantt.localization[n].calendars.standard.patterns.d:Globalize.culture(n)?Globalize.culture(n).calendars.standard.patterns.d:t.Gantt.localization["en-US"].calendars.standard.patterns.d;i._emptyRecordText=t.Gantt.localization[n]?t.Gantt.localization[n].emptyRecord:t.Gantt.localization["en-US"].emptyRecord;i._columnHeaderTexts=t.Gantt.localization[n]?t.Gantt.localization[n].columnHeaderTexts:t.Gantt.localization["en-US"].columnHeaderTexts;i._editDialogTexts=t.Gantt.localization[n]?t.Gantt.localization[n].editDialogTexts:t.Gantt.localization["en-US"].editDialogTexts;i._months=t.Gantt.localization[n]&&t.Gantt.localization[n].calendars?t.Gantt.localization[n].calendars.standard.months.namesAbbr:Globalize.culture(n)?Globalize.culture(n).calendars.standard.months.namesAbbr:t.Gantt.localization["en-US"].calendars.standard.months.namesAbbr;i._days=t.Gantt.localization[n]&&t.Gantt.localization[n].calendars?t.Gantt.localization[n].calendars.standard.months.namesAbbr:Globalize.culture(n)?Globalize.culture(n).calendars.standard.days.namesAbbr:t.Gantt.localization["en-US"].calendars.standard.days.namesAbbr},_getMappingItems:function(){for(var n=this,u=n.model,i=[],r=n._columns.length,t=0;t<r;t++)i.push(n._columns[t].mappingName);return i},_getContextMenuItems:function(){return[{headerText:"Task Details...",eventHandler:null,isDefault:!0},{headerText:"Add New Task",eventHandler:null,isDefault:!0},{headerText:"Indent",eventHandler:null,isDefault:!0},{headerText:"Outdent",eventHandler:null,isDefault:!0},{headerText:"Delete",eventHandler:null,isDefault:!0}]},_getsubContextMenuItems:function(){return[{iconPath:null,headerText:"Above",eventHandler:null},{iconPath:null,headerText:"Below",eventHandler:null}]},_initialize:function(){var n=this,i=n.model;n._$treegridPane=t.buildTag("div.e-treegridPane");n._$ganttchartPane=t.buildTag("div.e-ganttchartPane");n._$ejGantt=t.buildTag("div.e-gantt-Spliter#e-ejSpliter"+n._id,"",{},{unselectable:"on"});n.setColumns(n.createTreeGridColumns());i.predecessorMapping&&n._updatePredecessors();n._trigger("load");n._render();n._updatedGanttRecords=n.getUpdatedRecords();n._currentViewData=n.getCurrentViewData();n._enableCreateCollection=!1;n._connectorLinesCollection=[];i.predecessorMapping&&n._createConnectorLinesCollection("Load");n._calculateScheduleDates();n._calculateHeaderDates();n._updateLeftValue();n._enableCreateCollection=!0;n._connectorLinesCollection=[];n._isValidationEnabled=!1;i.predecessorMapping&&n._createConnectorLinesCollection();n._isValidationEnabled=!0;n._renderGanttChart();i.predecessorMapping&&n._$ganttchartHelper&&n._$ganttchartHelper.ejGanttChart("renderConnectorLines",n._connectorLinesCollection);n._isRenddered=!0;n._gridRows=n.getRows();n._ganttChartRows=n.getGanttChartRows();n._createSubContextMenuTemplate();n._createContextMenuTemplate();n._wireEvents()},_render:function(){var n=this,i=n.element,r=n.model,u;n.model.toolbarSettings.showToolbar&&i.append(n._renderToolBar());n._ganttHeight=parseInt(n._ganttHeight)-n._getToolBarHeight()-n._totalBorderHeight;n._$treegrid=t.buildTag("div.ejTreeGrid#ejTreeGrid"+n._id,"",{height:n._ganttHeight},{});n._$ganttchart=t.buildTag("div.ejGanttChart#ejGanttChart"+n._id,"",{height:n._ganttHeight},{});n._$ganttchartPane.append(n._$ganttchart);n._$treegridPane.append(n._$treegrid);n._$ejGantt.append(n._$treegridPane);n._$ejGantt.append(n._$ganttchartPane);i.append(n._$ejGantt);n._renderGantt();n._renderTreeGrid();n._$treegridPane.css({overflow:"hidden"});(r.editSettings.allowEditing||r.editSettings.editMode=="normal"||r.editSettings.editMode=="dialogTemplate")&&(n.editDialogTemplate(),i.append(n._renderDialog()));r.editSettings.allowAdding&&(n.addDialogTemplate(),u=t.buildTag("div.e-dialog e-dialog-content e-shadow e-widget-content","",{display:"none"},{id:this._id+"_dialogAdd"}),i.append(u))},_renderDialog:function(){return t.buildTag("div.e-dialog e-dialog-content e-shadow e-widget-content","",{display:"none"},{id:this._id+"_dialogEdit"})},editDialogTemplate:function(){var i=this,f=i.model,u=i._columns,a=u.length,f=i.model,c,l,s,o,h,e,r;if(i._mappingItems=i._getMappingItems(),a!=0){if(f.editDialogFields.length>0){for(s=[],o=0;o<f.editDialogFields.length;o++)h=n.grep(i._columns,function(n){return n.mappingName===f.editDialogFields[o].field}),h.length&&s.push(h[0]);u=s}for(e=t.buildTag("div","",{},{unselectable:"on"}),$form=t.buildTag("form","",{height:"auto",width:"auto","font-family":"Segoe UI","font-size":"14px"},{id:i._id+"EditForm"}),$table=t.buildTag("table","",{width:"500px"},{unselectable:"on"}),$tr=t.buildTag("tr"),r=0;r<u.length;r++)n.inArray(u[r].mappingName,i._mappingItems)!=-1&&(u[r].mappingName!==f.predecessorMapping?$tr.children("td").length<2?($td=t.buildTag("td","",{"text-align":"left",padding:"5px 15px 0","font-weight":"normal",outline:"none"},{unselectable:"on"}),$innerTable=t.buildTag("table","",{outline:"none"},{unselectable:"on"}),$inTr=t.buildTag("tr"),$inTd=t.buildTag("td.editLabel","",{outline:"none"},{unselectable:"on"}),$inTd.append("<label for='"+u[r].field+"' style='font-weight:normal;'>"+i._columnHeaderTexts[u[r].field]+"<\/label>"),$inTr.append($inTd),$innerTable.append($inTr),$inTr2=t.buildTag("tr"),$inTd2=t.buildTag("td.e-editValue"),c=u[r],i.initCellEditType(c,$inTd2),$inTr2.append($inTd2),$innerTable.append($inTr2),$td.append($innerTable),$tr.append($td)):($table.append($tr),$tr=$tempTr=t.buildTag("tr"),r--):l=r);$table.append($tr);$tr=t.buildTag("tr");f.predecessorMapping&&l&&($td=t.buildTag("td","",{"text-align":"left",padding:"10px 15px 0","font-weight":"normal",outline:"none"},{colspan:2,unselectable:"on"}),$innerTable=t.buildTag("table#predecessoreditTable","",{width:"100%",outline:"none"},{unselectable:"on"}),$inTr=t.buildTag("tr"),$inTd=t.buildTag("td.editLabel","",{outline:"none"},{unselectable:"on"}),$inTd.append("<span class='e-addpre e-icon e-enable e-edit-dialog' style='cursor:pointer'>Add New<\/span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='e-deletepre e-icon e-disable e-edit-dialog' style='cursor:pointer'>&nbsp;&nbsp;Remove<\/span>"),$inTr.append($inTd),$innerTable.append($inTr),$inTr2=t.buildTag("tr"),$inTd2=t.buildTag("td.e-editValue"),$preDiv=t.buildTag("div#treegrid"+i._id+"predecessoredit","",{width:"100%",height:"150px"},{}),$inTd2.append($preDiv),$inTr2.append($inTd2),$innerTable.append($inTr2),$td.append($innerTable),$tr.append($td),$table.append($tr));$form.append($table);$form.appendTo(e);e=i.renderDiaglogButton($form,e);n.templates(i._id+"_JSONDialogEditingTemplate",e.html())}},addDialogTemplate:function(){var i=this,f=i.model,u=i._columns,a=u.length,f=i.model,c,l,s,o,h,e,r;if(i._mappingItems=i._getMappingItems(),a!=0){if(f.addDialogFields.length>0){for(s=[],o=0;o<f.addDialogFields.length;o++)h=n.grep(i._columns,function(n){return n.mappingName===f.addDialogFields[o].field}),h.length&&s.push(h[0]);u=s}for(e=t.buildTag("div","",{},{unselectable:"on"}),$form=t.buildTag("form","",{height:"auto",width:"auto","font-family":"Segoe UI","font-size":"14px"},{id:i._id+"AddForm"}),$table=t.buildTag("table","",{width:"500px"},{unselectable:"on"}),$tr=t.buildTag("tr"),r=0;r<u.length;r++)n.inArray(u[r].mappingName,i._mappingItems)!=-1&&(u[r].mappingName!==f.predecessorMapping?$tr.children("td").length<2?($td=t.buildTag("td","",{"text-align":"left",padding:"5px 15px 0","font-weight":"normal",outline:"none"},{unselectable:"on"}),$innerTable=t.buildTag("table","",{outline:"none"},{unselectable:"on"}),$inTr=t.buildTag("tr"),$inTd=t.buildTag("td.editLabel","",{outline:"none"},{unselectable:"on"}),$inTd.append("<label for='"+u[r].field+"' style='font-weight:normal;'>"+i._columnHeaderTexts[u[r].field]+"<\/label>"),$inTr.append($inTd),$innerTable.append($inTr),$inTr2=t.buildTag("tr"),$inTd2=t.buildTag("td.e-editValue"),c=u[r],i.initCellEditType(c,$inTd2,"Add"),$inTr2.append($inTd2),$innerTable.append($inTr2),$td.append($innerTable),$tr.append($td)):($table.append($tr),$tr=$tempTr=t.buildTag("tr"),r--):l=r);$table.append($tr);$tr=t.buildTag("tr");f.predecessorMapping&&l&&($td=t.buildTag("td","",{"text-align":"left",padding:"10px 15px 0","font-weight":"normal",outline:"none"},{colspan:2,unselectable:"on"}),$innerTable=t.buildTag("table#predecessoreditTable","",{width:"100%",outline:"none"},{unselectable:"on"}),$inTr=t.buildTag("tr"),$inTd=t.buildTag("td.editLabel","",{outline:"none"},{unselectable:"on"}),$inTd.append("<span class='e-addpre e-icon e-enable e-add-dialog' style='cursor:pointer'>Add New<\/span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='e-deletepre e-icon e-disable e-add-dialog' style='cursor:pointer'>&nbsp;&nbsp;Remove<\/span>"),$inTr.append($inTd),$innerTable.append($inTr),$inTr2=t.buildTag("tr"),$inTd2=t.buildTag("td.e-editValue"),$preDiv=t.buildTag("div#treegrid"+i._id+"predecessorAdd","",{width:"100%",height:"150px"},{}),$inTd2.append($preDiv),$inTr2.append($inTd2),$innerTable.append($inTr2),$td.append($innerTable),$tr.append($td),$table.append($tr));$form.append($table);$form.appendTo(e);e=i.renderDiaglogButton($form,e);n.templates(i._id+"_JSONDialogAddingTemplate",e.html())}},_clearContextMenu:function(){n(".e-contextmenu").remove();n(".e-innerContextmenu").remove()},_createContextMenuTemplate:function(){var i=this,t,u,r;helpers={getHeaderName:n.proxy(i._getHeaderName,i)};n.views.helpers(helpers);t="<li style='list-style-type:none;width:150px;height:25px;display:inline-block;'>";u="<div class='e-menuitem' id={{:headerText}}  style='left:0px;padding-top:3px;height:25px;width:150px;cursor:pointer;display:block;position:absolute;'  {{if !isDefault}}onClick='{{:eventHandler}}'{{/if}}><div class='e-icon' style='left:10px;top:4px;height:20px;position:absolute;background-image:{{:iconPath}};background-repeat:no-repeat;'/><div style='left:35px;position:absolute;'><span style='font-family:Segoe UI;font-size:12px;padding-left:5px;'>{{:headerText}}<\/span><\/div>{{if ~getHeaderName(#data)}}<span class='e-icon e-expander' style='height:16px;width:16px;right:5px;top:7px;position:absolute;'><\/span>{{/if}}";t+=u;t+="<\/div><\/li>";r={};r[i._id+"contextMenuTemplate"]=t;n.templates(r)},_getHeaderName:function(n){return n.headerText=="Add New Task"&&this._subContextMenuItems.length>0?!0:!1},_createSubContextMenuTemplate:function(){var r=this,f={getHeaderName:r._getHeaderName},t,u,i;n.views.helpers(f);t="<li style='list-style-type:none;width:120px;height:25px;display:inline-block;'>";u="<div class='e-menuitem' id={{:headerText}} style='left:0px;padding-top:3px;height:25px;width:120px;cursor: pointer;display:block;position:absolute;'><div style='left:10px;height:20px;width:16px;position:absolute;padding-top:5px;background-image:{{:iconPath}};background-repeat:no-repeat;'/><div style='left:10px;position:absolute;'><span style='font-family:Segoe UI;font-size:12px;padding-left:5px;'>{{:headerText}}<\/span><\/div><\/div>";t+=u;t+="<\/li>";i={};i[r._id+"subContextMenuTemplate"]=t;n.templates(i)},initCellEditType:function(i,r,u){var f=this,o=f.model,e,s={},h,c,l;e=u?u:"";t.isNullOrUndefined(i.editType)&&(i.editType="stringedit");switch(i.editType){case"stringedit":i.mappingName===o.predecessorMapping?(s["_"+f._id+"predecessor"]=f._getPredecessorsValue,n.views.helpers(s),r.html(t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+f._id+"predecessor('"+f._id+"Object','"+o.predecessorMapping+"','"+i.field+"')}}",id:f._id+i.field,name:i.field}))):r.html(t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:#data['"+i.field+"']}}",id:f._id+i.field+e,name:i.field,dialog:u}));break;case"booleanedit":r.html("{{if "+i.field+'}} <input class="e-field e-checkbox" type ="checkbox" id='+f._id+i.field+" name="+i.field+' checked="checked"><\/input>{{else}} <input class="e-field e-checkbox" type ="checkbox" id='+f._id+i.field+" name="+i.field+" > {{/if}}");break;case"numericedit":h=t.buildTag("input.e-numerictextbox e-field","",{},{type:"text",value:"{{:#data['"+i.field+"']}}",id:f._id+i.field+e,name:i.field,dialog:u});r.append(h);break;case"datepicker":case"datetimepicker":c=t.buildTag("input.e-"+i.editType+" e-field","",{},{type:"text",value:"{{:#data['"+i.field+"']}}",id:f._id+i.field+e,name:i.field,dialog:u});r.append(c);break;case"dropdownedit":l=t.buildTag("input.e-field e-dropdownlist e-field","",{},{type:"text",value:"{{:#data['"+i.field+"']}}",id:f._id+i.field+e,name:i.field,dialog:u});r.append(l)}},_getPredecessorsValue:function(n,t){return this.data.item?this.data.item[t]:""},_updateEditFormData:function(){var n=this},_onHoliDayCheckBefore:function(n){var i=this,r=i.model.holidays,e=i.model.includeWeekend,t,u,f;if(r&&r.length)for(t=0,u=r.length,t=0;t<u;t++)if(f=i._getDateFromFormat(r[t].day),f.getTime()==n.getTime())n.setDate(n.getDate()-1),this.model.includeWeekend===!1&&i._setBeforeWeekend(n);else return n;else return n},_onHoliDayCheck:function(n){var r=this,i=r.model.holidays,e=r.model.includeWeekend,t,u,f;if(i&&i.length){t=0;u=i.length;do for(t=0;t<u;t++)if(f=r._getDateFromFormat(i[t].day),f.getTime()==n.getTime())n.setDate(n.getDate()+1),this.model.includeWeekend===!1&&(n.getDay()==0?n.setDate(n.getDate()+1):n.getDay()==6&&n.setDate(n.getDate()+2));else return n;while(1)}else return n},_editStartDateChange:function(t,i){var o=this,s=o._id,v=o.model,y=t.attr("id"),h=this.model.holidays,nt=t.attr("dialog"),tt=this.selectedItem(),e=this._editedDialogRecord,w,c,k,f,b,g,l,u,a,d,p;if(nt==="Add"?(w="#"+s+"startDateAdd",c="#"+s+"endDateAdd",k="#"+s+"durationAdd"):(w="#"+s+"startDate",c="#"+s+"endDate",k="#"+s+"duration"),f=n(w).val(),endDate=n(c).val(),duration=parseInt(n(k).val()),f||(f=e?e.startDate:r),isNaN(duration)&&(duration=e?e.duration:r),endDate||(endDate=e?e.endDate:r),y===s+"startDate"||y===s+"startDateAdd"){if(f=o._getDateFromFormat(i.value),u=new Date,stratDate=o._onHoliDayCheck(f),this.model.includeWeekend===!1&&(f.getDay()===0?f.setDate(f.getDate()+1):f.getDay()===6&&f.setDate(f.getDate()+2)),u=f,f=Globalize.format(f,this.model.dateFormat),e&&(e.startDate=f),v.dateFormat.indexOf("hh")!=-1?n(w).ejDateTimePicker("option","value",f):n(w).ejDatePicker("option","value",f),!endDate||isNaN(duration))return;if(v.durationMapping){if(this.model.includeWeekend===!1)for(l=1;l<duration;l++)u.getDay()==0?u.setDate(u.getDate()+1):u.getDay()==6&&u.setDate(u.getDate()+2),u.setDate(u.getDate()+1);else u.setDate(u.getDate()+duration-1);if(this.model.includeWeekend===!1&&(u.getDay()==0?u.setDate(u.getDate()+1):u.getDay()==6&&u.setDate(u.getDate()+2)),h&&h.length)for(a=0,d=h.length,a=0;a<d;a++)p=new Date(h[a].day),p>=o._getDateFromFormat(new Date(f),this.model.dateFormat)&&p<=u&&(u.setDate(u.getDate()+1),this.model.includeWeekend===!1&&(u.getDay()==0?u.setDate(u.getDate()+1):u.getDay()==6&&u.setDate(u.getDate()+2)));this.model.includeWeekend===!1&&(u.getDay()==0?u.setDate(u.getDate()+1):u.getDay()==6&&u.setDate(u.getDate()+2));u=Globalize.format(u,this.model.dateFormat);e&&(e.endDate=u);v.dateFormat.indexOf("hh")!=-1?n(c).ejDateTimePicker("option","value",new Date(u)):n(c).ejDatePicker("option","value",new Date(u))}else b=o._daydiff(o._getDateFromFormat(this.selectedItem().startDate),o._getDateFromFormat(e.startDate)),e.duration-=b}else if(y===s+"endDate"||y===s+"endDateAdd"){if(endDate=o._getDateFromFormat(i.value),endDate=o._onHoliDayCheck(endDate),this.model.includeWeekend===!1&&(endDate.getDay()===0?endDate.setDate(endDate.getDate()-2):endDate.getDay()===6&&endDate.setDate(endDate.getDate()-1)),endDate=Globalize.format(endDate,this.model.dateFormat),e&&(e.endDate=endDate),v.dateFormat.indexOf("hh")!=-1?n(c).ejDateTimePicker("option","value",new Date(endDate)):n(c).ejDatePicker("option","value",new Date(endDate)),!f||isNaN(duration))return;if(f=o._getDateFromFormat(f),endDate=o._getDateFromFormat(endDate),f.getTime()<=endDate.getTime()){for(g=0,b=o._daydiff(o._getDateFromFormat(f),o._getDateFromFormat(endDate)),offset=this.model.includeWeekend===!1?o._calculateDateDifference(new Date(f),b)+1:b+1,l=0;l<h.length;l++)new Date(h[l].day)>=new Date(f)&&new Date(h[l].day)<=new Date(endDate)&&offset--;g=offset;e&&(e.duration=g);n(k).ejNumericTextbox("option","value",g)}else e&&(e.endDate=i.prevDate),v.dateFormat.indexOf("hh")!=-1?n(c).ejDateTimePicker("option","value",new Date(i.prevDate)):n(c).ejDatePicker("option","value",new Date(i.prevDate))}else if(y===s+"duration"||y===s+"durationAdd"){if(f=o._getDateFromFormat(f),u=new Date(f),!endDate||!f)return;if(duration=i.value,this.model.includeWeekend===!1)for(l=1;l<duration;l++)u.getDay()==0?u.setDate(u.getDate()+1):u.getDay()==6&&u.setDate(u.getDate()+2),u.setDate(u.getDate()+1);else u.setDate(u.getDate()+duration-1);if(this.model.includeWeekend===!1&&(u.getDay()==0?u.setDate(u.getDate()+1):u.getDay()==6&&u.setDate(u.getDate()+2)),h&&h.length)for(a=0,d=h.length,a=0;a<d;a++)p=new Date(h[a].day),p>=o._getDateFromFormat(f,this.model.dateFormat)&&p<=u&&(u.setDate(u.getDate()+1),this.model.includeWeekend===!1&&(u.getDay()==0?u.setDate(u.getDate()+1):u.getDay()==6&&u.setDate(u.getDate()+2)));this.model.includeWeekend===!1&&(u.getDay()==0?u.setDate(u.getDate()+1):u.getDay()==6&&u.setDate(u.getDate()+2));u=Globalize.format(u,this.model.dateFormat);e&&(e.endDate=u,e.duration=duration);v.dateFormat.indexOf("hh")!=-1?n(c).ejDateTimePicker("option","value",new Date(u)):n(c).ejDatePicker("option","value",new Date(u))}},_taskNameCollection:function(){for(var r,u=this,t=u._updatedGanttRecords,i=[],n=0;n<t.length;n++)r={id:t[n].taskId.toString(),text:t[n].taskId.toString()+"-"+t[n].taskName,value:t[n].taskName},i.push(r);return i},_idFromPredecessor:function(n){for(var u,i,r=n.split(","),f=[],t=0;t<r.length;t++){for(u=[],i=0;i<r[t].length;i++)if(isNaN(r[t].charAt(i)))break;else u.push(r[t].charAt(i));f.push(u.join(""))}return f},_preIdChangByName:function(){var i=this,r=n("#"+i._id+"PreEditForm");$targetTr=r.closest("tr");$val=r.find(".onEdit");var f=$val.val(),u=i._taskNameCollection(),t=n.map(u,function(n){if(n.text===$val.val())return n.id});t=t[0];$targetTr.find(".id").html(t)},_preBeginEdit:function(n){n.columnIndex===0&&(n.cancel=!0)},_preEndEdit:function(t,i){var f=this,r;if(i.columnName==="name"){var o=i.model.dataSource,e=f._taskNameCollection(),u=n.map(e,function(n){if(n.value===i.value)return n.id});u=u[0];i.model.selectedItem.id=u;r=i.model.dataSource.indexOf(i.model.selectedItem.item);r===-1&&(i.model.dataSource.push(i.model.selectedItem.item),r=i.model.dataSource.indexOf(i.model.selectedItem.item));i.model.dataSource[r].id=u;i.model.selectedItem.type||(i.model.selectedItem.type="Finish-Start",i.model.dataSource[r].type="Finish-Start");n(t).ejTreeGrid("refreshRow",i.model.selectedRowIndex);n(t).ejTreeGrid("selectRows",i.model.selectedRowIndex);f.enbleDisableAddPreButton("enable")}},_deleteDisableEnable:function(){var t=this;n(".e-deletepre").unbind("click",n.proxy(t._deletepredecessor,t));n(".e-deletepre").bind("click",n.proxy(t._deletepredecessor,t));n(".e-deletepre").removeClass("e-disable");n(".e-deletepre").addClass("e-enable")},_preDblClickHandler:function(i){var r=this,u;if($target=n(i.target),$sample=n("#"+r._id+"PreEditForm"),$sample.length===0){$form=t.buildTag("form.#"+r._id+"PreEditForm","",{},{});$form.submit(function(n){n.preventDefault()});var e=$target.attr("edittype"),f=$target.attr("field");switch(f){case"taskName":$attchelemet=t.buildTag("input.e-field e-dropdownlist e-field onEdit","",{},{type:"text",id:r._id+"taskNameEdit",value:i.target.innerHTML});$form.append($attchelemet);$target.empty().append($form);$target.addClass("onEdit");$attchelemet.ejDropDownList({dataSource:r._taskNameCollection(),width:"auto",change:n.proxy(r._preIdChangByName,r)});$attchelemet.focus();break;case"type":$attchelemet=t.buildTag("input.e-field e-dropdownlist e-field onEdit","",{},{type:"text",id:r._id+"TyepeEdit",value:i.target.innerHTML});$form.append($attchelemet);$target.empty().append($form);$target.addClass("onEdit");$attchelemet.ejDropDownList({dataSource:[{id:"SS",text:"Start-Start",value:"Start-Start"},{id:"SF",text:"Start-Finish",value:"Start-Finish"},{id:"FS",text:"Finish-Start",value:"Finish-Start"},{id:"FF",text:"Finish-Finish",value:"Finish-Finish"}],width:"auto"});$attchelemet.focus();break;case"offset":$attchelemet=t.buildTag("input.e-numerictextbox e-field onEdit","",{},{type:"text",id:r._id+"OffsetEdit"});u=isNaN(parseInt(i.target.innerHTML))?0:parseInt(i.target.innerHTML);$form.append($attchelemet);$target.empty().append($form);$target.addClass("onEdit");$attchelemet.ejNumericTextbox({width:"auto",showSpinButton:!0,value:u});$attchelemet.focus()}}},_predecessorEditCollection:function(){var o=this,l=o.model,w="#"+o._id+"predecessor",s=[{id:"SS",text:"Start-Start",value:"Start-Start"},{id:"SF",text:"Start-Finish",value:"Start-Finish"},{id:"FS",text:"Finish-Start",value:"Finish-Start"},{id:"FF",text:"Finish-Finish",value:"Finish-Finish"}],a=[],i=l.selectedItem,h=o._taskNameCollection(),r,n,e,v,y,c,u,f,p;if(!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(i.predecessor)&&!t.isNullOrUndefined(i.item[l.predecessorMapping]))for(r=i.predecessor,n=0;n<r.length;n++)if(e=r[n].from,i.taskId.toString()!==e.toString()){for(c=0,u=0;u<h.length;u++)if(h[u].id===e){v=h[u].text;break}for(f=0;f<s.length;f++)s[f].id==r[n].predecessorsType&&(y=s[f].text);c=r[n].offset;p={id:e,name:v,type:y,offset:c};a.push(p)}return a},_refreshEditForm:function(i){var f=this,rt=!1,b,y=0,k,ut,u,c="165px",o=f.model,l,e={},d,s,g,p,a,w,v,nt,tt,h,ft,it;for(selectedItem=o.selectedItem,i.requestType=="add"?(k=document.getElementById(f._id+"AddForm"),v="#treegrid"+f._id+"predecessorAdd"):(k=document.getElementById(f._id+"EditForm"),v="#treegrid"+f._id+"predecessoredit"),b=n(k).find("input,select"),ut=b.length,y;y<ut;y++){if(u=b.eq(y),e={},c=210,u.hasClass("e-numerictextbox"))l=c,d=u.val(),e.width=l,e.showSpinButton=!0,e.cssClass=o.cssClass,h=u[0].id,h=h.replace(f._id,""),selectedItem!==null&&selectedItem.hasChildRecords&&(h=="duration"||h=="status")&&(e.readOnly=!0),h=="status"?e.maxValue=100:(e.maxValue=1e5,e.change=n.proxy(f._editStartDateChange,f,u)),e.minValue=0,e.value=d.length?parseFloat(d):0,g=t.TreeGrid.getColumnByField(f._columns,u.prop("name")),t.isNullOrUndefined(g.editParams)||n.extend(e,g.editParams),u.ejNumericTextbox(e),u.prop("name",u.prop("name").replace(f._id,""));else if(u.hasClass("e-datepicker"))l=c,e.width=l,e.cssClass=o.cssClass,e.dateFormat=o.dateFormat,e.locale=o.locale,e.displayDefaultDate=!0,h=u[0].id,h=h.replace(f._id,""),selectedItem!==null&&selectedItem.hasChildRecords&&(h=="startDate"||h=="endDate")&&i.requestType!=="add"&&(e.readOnly=!0),e.select=n.proxy(f._editStartDateChange,f,u),e.value=u.val().length?f._getDateFromFormat(u.val()):f._getDateFromFormat(o.scheduleStartDate),s=t.TreeGrid.getColumnByField(f._columns,u.prop("name")),s.format!==r&&s.format.length>0&&(p=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),w=p.exec(s.format),e.dateFormat=w[2]),t.isNullOrUndefined(s.editParams)||n.extend(e,s.editParams),o.dateFormat.indexOf("hh")!=-1?u.ejDateTimePicker(e):u.ejDatePicker(e);else if(u.hasClass("e-datetimepicker"))l=c,e={width:l,rtl:o.rtl,locale:o.locale,cssClass:o.css,showButton:!1},e.value=u.val().length?f._getDateFromFormat(u.val()):new Date,s=t.TreeGrid.getColumnByField(f._columns,u.prop("name")),s.format!==r&&s.format.length>0&&(p=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),w=p.exec(s.format),e.dateTimeFormat=w[2]),t.isNullOrUndefined(s.editParams)||n.extend(e,s.editParams),o.dateFormat.indexOf("hh")!=-1?u.ejDateTimePicker(e):u.ejDatePicker(e);else if(u.hasClass("e-dropdownlist"))s=t.TreeGrid.getColumnByField(f._columns,u.prop("name")),nt=s.dropdownData,tt=!1,selectedItem!==null&&selectedItem.hasChildRecords&&i.requestType!=="add"&&(tt=!0),u.ejDropDownList({width:c,showCheckbox:!0,dataSource:nt,readOnly:tt,fields:{id:o.resourceIdMapping,text:o.resourceNameMapping,value:o.resourceNameMapping},selectedItems:f.getIndexofresourceInfo(nt,i.data)}),u.ejDropDownList("setSelectedValue",u.val());else switch(u.prop("tagName")){case"INPUT":u.attr("type")!="checkbox"?(u.attr("name")==="taskId"?i.requestType!=="add"?u.attr("readonly","readonly"):i.requestType==="add"&&(a=f._updatedGanttRecords.length,a=f._getNewTaskIdFordialogEdit(a),u.val(a)):u.attr("name")==="taskName"&&i.requestType==="add"&&u.val("New Task"+a),h=u[0].id,h=h.replace(f._id,""),u.css("text-align",u.attr("name")!=null&&t.TreeGrid.getColumnByField(f._columns,u.prop("name"))!=null?t.TreeGrid.getColumnByField(f._columns,u.attr("name")).textAlign:"center"),u.outerWidth(c).height(25)):u.width("165px");break;case"SELECT":u.width(c).height(23)}u.is(":disabled")||rt||u.is(":hidden")&&typeof u.data("ejDropDownList")!="object"||f._isEnterKeyPressed||(f._focusElements(u.closest("td")),rt=!0)}o.predecessorMapping&&n(v).length&&(ft=[{id:"SS",text:"Start-Start",value:"Start-Start"},{id:"SF",text:"Start-Finish",value:"Start-Finish"},{id:"FS",text:"Finish-Start",value:"Finish-Start"},{id:"FF",text:"Finish-Finish",value:"Finish-Finish"}],it=[],i.requestType!=="add"&&(it=f._predecessorEditCollection()),n(v).ejTreeGrid({dataSource:it,allowSorting:!1,allowAdding:!0,columns:[{headerText:"ID",field:"id",width:"50px",allowEditing:!1},{headerText:"TaskName",field:"name",editType:t.TreeGrid.EditingType.Dropdown,dropdownData:f._taskNameCollection(),width:"170px"},{headerText:"Type",field:"type",editType:t.TreeGrid.EditingType.Dropdown,dropdownData:ft,width:"80px"},{headerText:"Offset",field:"offset",editType:t.TreeGrid.EditingType.Numeric,width:"50px"}],enableAltRow:!0,editSettings:{allowAdding:!0,allowDeleting:!0,allowEditing:!0,editMode:"cellEditing"},endEdit:n.proxy(f._preEndEdit,f,v),beginEdit:n.proxy(f._preBeginEdit,f),rowSelected:n.proxy(f._deleteDisableEnable,f),treeColumnIndex:5}),o.selectedItem&&o.selectedItem.hasChildRecords&&i.requestType!=="add"?(f.enbleDisableDeletePreButton("disable"),f.enbleDisableAddPreButton("disable")):(f.enbleDisableDeletePreButton("disable"),f.enbleDisableAddPreButton("enable")))},enbleDisableDeletePreButton:function(t){var i=this;t==="enable"?(n(".e-deletepre").unbind("click",n.proxy(i._deletepredecessor,i)),n(".e-deletepre").bind("click",n.proxy(i._deletepredecessor,i)),n(".e-deletepre").addClass("e-enable"),n(".e-deletepre").removeClass("e-disable")):(n(".e-deletepre").unbind("click",n.proxy(i._deletepredecessor,i)),n(".e-deletepre").addClass("e-disable"),n(".e-deletepre").removeClass("e-enable"))},enbleDisableAddPreButton:function(t){var i=this;t==="enable"?(n(".e-addpre").unbind("click",n.proxy(i._addpredecessor,i)),n(".e-addpre").bind("click",n.proxy(i._addpredecessor,i)),n(".e-addpre").addClass("e-enable"),n(".e-addpre").removeClass("e-disable")):(n(".e-addpre").unbind("click",n.proxy(i._addpredecessor,i)),n(".e-addpre").addClass("e-disable"),n(".e-addpre").removeClass("e-enable"))},_disableAddButton:function(t){var u=this,f=n(t+"e-table"),e=!1,o=f[0].rows.length,i,r;for(u.enbleDisableAddPreButton("disable"),i=0;i<o;i++)r=f[0].rows[i],r.cells.length===4&&r.cells[1].innerText===""&&(e=!0);e||u.enbleDisableAddPreButton("enable")},_addpredecessor:function(i){var r=this,f={},u,e;f.requestType=t.TreeGrid.Actions.Save;f._cAddedRecord={item:{id:"",name:"",type:"",offset:""},hasChildRecords:!1,level:0};r.enbleDisableAddPreButton("disable");u=n(i.target).hasClass("e-edit-dialog")?"#treegrid"+r._id+"predecessoredit":"#treegrid"+r._id+"predecessorAdd";e=n(u).ejTreeGrid("option","selectedRowIndex");n(u).ejTreeGrid("clearSelection",e);n(u).ejTreeGrid("processBindings",f);r.enbleDisableDeletePreButton("disable")},_deletepredecessor:function(i){var r=this,u,f,e;u=n(i.target).hasClass("e-edit-dialog")?"#treegrid"+r._id+"predecessoredit":"#treegrid"+r._id+"predecessorAdd";f=n(u).ejTreeGrid("option","selectedRowIndex");e={};e.requestType=t.TreeGrid.Actions.Delete;f!==-1&&(n(u).ejTreeGrid("deleteRow"),r.enbleDisableDeletePreButton("disable"));r._disableAddButton(u)},getColumnIndexByField:function(n){var r=this,i=r.model.columns,u=i.length,t=0;for(t;t<u;t++)if(i[t].field==n)break;return t},getIndexofresourceInfo:function(n,t){var r=t.resourceInfo,i=0,f=r&&r.length,u=[];for(i;i<f;i++)u.push(n.indexOf(r[i]));return u},_focusElements:function(n){if(n.length){n.focus();var t=n.children();t[0].tagName.toLowerCase()=="select"||t[0].tagName.toLowerCase()=="input"?(t.focus().select(),t[0].focus()):t.find(".e-field.e-dropdownlist").length?t.find(".e-ddl").focus():t.find("input,select").select().focus()}},renderDiaglogButton:function(n,i){var e,r=this,f=r.model,o,c,l,s,h,u;return e=n[0].id===r._id+"EditForm"?"EditDialog_":"AddDialog_",o=t.buildTag("input","",{"border-radius":"3px"},{type:"button",id:e+r._id+"_Save"}),c=r._editDialogTexts.saveButton,o.ejButton({cssClass:f.cssClass,text:c,width:"70"}),l=r._editDialogTexts.cancelButton,s=t.buildTag("input","",{"margin-left":"20px","border-radius":"3px"},{type:"button",id:e+r._id+"_Cancel"}),s.ejButton({cssClass:f.cssClass,text:l,width:"70"}),h=t.buildTag("input","",{"margin-left":"20px","border-radius":"3px"},{type:"button",id:"EditDialog_"+r._id+"_Delete"}),h.ejButton({cssClass:f.cssClass,text:"Delete",width:"70"}),u=t.buildTag("div","",{"margin-top":"20px",float:"right","margin-bottom":"15px","margin-right":"15px"},{"class":"e-editform-btn"}),u.append(o),n[0].id===r._id+"EditForm"&&f.editSettings.allowDeleting&&u.append(h),u.append(s),n.appendTo(i),u.appendTo(i),i},_toolbarItemLeave:function(){},_renderToolBar:function(){var i=this,f=i.model,u=t.buildTag("div.e-gantttoolbar#e-gantttoolbar"+i._id,"",{height:"50px"},{id:i._id+"_toolbarItems"}),e=t.buildTag("ul","",{width:i._ganttWidth-i._totalBorderWidth},{}),o,r;return!t.isNullOrUndefined(f.toolbarSettings.toolbarItems)&&f.toolbarSettings.toolbarItems.length&&i._renderLi(e),u.append(e),o=t.buildTag("ul"),u.append(o),r={},r.click=i._toolBarClick,r.cssClass="",r.rtl=!1,r.itemSeparator=!1,r.itemLeave=i._toolbarItemLeave,r.width=i._ganttWidth-i._totalBorderWidth,r.fields={id:"",tooltipText:"",imageUrl:"",text:"",imageAttributes:"",spriteCSS:"",htmlAttributes:""},u.ejToolbar(r),u.ejToolbar("disableItem",i._disabledToolItems),i._disabledToolItems=n(),u},_renderLi:function(n){var f=this,r=f.model.toolbarSettings.toolbarItems,e=r.length,i=0,u;for(i;i<e;i++)u=t.buildTag("li","",{},{id:f._id+"_"+r[i],tabindex:"0"}),r[i]!=="search"&&u.css({width:"30px",height:"24px"}),f._renderLiContent(u,r[i]),n.append(u)},_renderLiContent:function(i,r){var f,u,e=this.model.selectedRowIndex,o=this.model.editSettings;switch(r){case"add":f=t.buildTag("span.e-addnewitem e-toolbaricons e-icon e-gantt-add","",{});i.attr("title","Add");this.model.editSettings.allowAdding||this._disabledToolItems.push(i.get(0));break;case"edit":f=t.buildTag("span.e-edititem e-toolbaricons e-icon e-gantt-edit","",{});i.attr("title","Edit");this.model.editSettings.allowEditing&&e!=-1||this._disabledToolItems.push(i.get(0));break;case"delete":i.attr("title","Delete");f=t.buildTag("span.e-deleteitem e-toolbaricons e-icon e-gantt-delete","",{});this.model.editSettings.allowDeleting&&e!=-1||this._disabledToolItems.push(i.get(0));break;case"update":i.attr("title","Update");f=t.buildTag("span.e-saveitem e-toolbaricons e-icon e-gantt-save e-disabletool","",{});this._disabledToolItems.push(i.get(0));break;case"cancel":i.attr("title","Cancel");f=t.buildTag("span.e-cancel e-toolbaricons e-icon e-gantt-cancel e-disabletool","",{});this._disabledToolItems.push(i.get(0));break;case"indent":i.attr("title","Indent");u=t.buildTag("span.e-indent e-toolbaricons e-icon e-disabletool e-gantt-indent","",{},{});i.append(u);this._disabledToolItems.push(i.get(0));break;case"outdent":i.attr("title","Outdent");u=t.buildTag("span.e-outdent e-toolbaricons e-icon e-disabletool e-gantt-outdent","",{},{});i.append(u);this._disabledToolItems.push(i.get(0));break;case"expandAll":i.attr("title","ExpandAll");u=t.buildTag("span.e-expandall e-toolbaricons e-icon e-gantt-expandall","",{},{});i.append(u);break;case"collapseAll":i.attr("title","CollapseAll");u=t.buildTag("span.e-collapseall e-toolbaricons e-icon e-gantt-collapseall","",{},{});i.append(u);break;case"prevTimeSpan":i.attr("title","Previous TimeSpan");u=t.buildTag("span.e-prevtimespan e-toolbaricons e-icon e-gantt-prevtimespan","",{},{});i.append(u);break;case"nextTimeSpan":i.attr("title","Next TimeSpan");u=t.buildTag("span.e-nexttimespan e-toolbaricons e-icon e-gantt-nexttimespan","",{},{});i.append(u);break;case"search":u=t.buildTag("input.e-ejinputtext","",{margin:"4px","text-indent":"4px"},{type:"text",placeholder:"Search"},{color:"#E8E9E9"});i.css({float:"right",padding:"2px"});i.attr("title","Search");i.addClass("e-search");i.append(u);this.model.allowSearching=!0;u.keydown(n.proxy(this._keyDown,this))}i.append(f)},_keyDown:function(n){n.which===13&&(this._searchString=n.currentTarget.value,this._toolbarOperation(this._id+"_search",n.currentTarget.value))},_updateToolbarOptions:function(t){var c=this,i=c.model,f=n(n(".e-addnewitem")[0]).parent(),e=n(n(".e-edititem")[0]).parent(),o=n(n(".e-deleteitem")[0]).parent(),s=n(n(".e-indent")[0]).parent(),h=n(n(".e-outdent")[0]).parent(),r,u;t.length?(r=[],i.editSettings.allowAdding&&f&&r.push(f.removeClass("e-disable")[0]),i.editSettings.allowEditing&&e&&r.push(e.removeClass("e-disable")[0]),i.editSettings.allowDeleting&&o&&r.push(o.removeClass("e-disable")[0]),s&&s.length&&s&&r.push(s.removeClass("e-disable")[0]),h&&h.length&&h&&r.push(h.removeClass("e-disable")[0]),n(".e-gantttoolbar").ejToolbar("disableItem",r)):(u=[],i.editSettings.allowAdding&&f&&u.push(f[0]),i.selectedItem&&(i.editSettings.allowEditing&&e&&u.push(e[0]),i.editSettings.allowDeleting&&o&&u.push(o[0]),c.updateIndentOutdentOption(i.selectedItem)),n(".e-gantttoolbar").ejToolbar("enableItem",u))},_renderGantt:function(){var i=this,r,u,f=parseInt(i._ganttWidth)-i._totalBorderWidth;r=(2*i._commonColumnWidth+3)/f*100;r=r<30?r:30;u=100-r-700/f;n("#e-ejSpliter"+i._id).ejSplitter({height:i._ganttHeight,width:i._ganttWidth-i._totalBorderWidth,orientation:t.Orientation.Horizontal,properties:[{paneSize:r+"%",collapsible:!1},{paneSize:u+"%",collapsible:!1}],enableAutoResize:!1,resize:n.proxy(i._onResize,i)})},_renderTreeGrid:function(){var i=this,t=i.model;i._$treegridHelper=n("#ejTreeGrid"+i._id).ejTreeGrid({enableAltRow:t.enableAltRow,allowColumnResize:t.allowColumnResize,enableVirtualization:t.enableVirtualization,allowSorting:t.allowSorting,allowMultiSorting:t.allowMultiSorting,sortSettings:t.sortSettings,allowSelection:t.allowSelection,selectionType:"single",selectedRowIndex:this.selectedRowIndex(),allowSearching:t.allowSearching,parentIdMapping:t.parentTaskIdMapping,allowKeyboardNavigation:t.allowKeyboardNavigation,cssClass:t.cssClass,locale:t.locale,editSettings:t.editSettings,toolbarSettings:t.toolbarSettings,rowTemplate:t.rowTemplate,rowDataBound:t.rowDataBound,queryCellInfo:t.queryCellInfo,dataSource:this.dataSource(),flatRecords:t.ganttRecords,parentRecords:t.parentRecords,records:i._rows,ids:i._ids,columns:i._columns,dateFormat:t.dateFormat,resourceInfoMapping:t.resourceInfoMapping,resourceNameMapping:t.resourceNameMapping,resourceIdMapping:t.resourceIdMapping,taskIdMapping:t.taskIdMapping,showGridCellTooltip:t.showGridCellTooltip,showGridExpandCellTooltip:t.showGridExpandCellTooltip,taskNameMapping:t.taskNameMapping,startDateMapping:t.startDateMapping,endDateMapping:t.endDateMapping,childMapping:t.childMapping,durationMapping:t.durationMapping,progressMapping:t.progressMapping,predecessorMapping:t.predecessorMapping,rowHeight:t.rowHeight,emptyRecordText:i._emptyRecordText,isFromGantt:i._isFromGantt,treeColumnIndex:t.treeColumnIndex,workingTimeScale:t.workingTimeScale})},_renderGanttChart:function(){var i=this,t=this.model;i._$ganttchartHelper=n("#ejGanttChart"+i._id).ejGanttChart({dataSource:this.dataSource(),scheduleStartDate:t.scheduleStartDate,scheduleEndDate:t.scheduleEndDate,startDateMapping:t.startDateMapping,endDateMapping:t.endDateMapping,progressMapping:t.progressMapping,durationMapping:t.durationMapping,childPropertyName:t.childMapping,predecessorMapping:t.predecessorMapping,enableVirtualization:t.enableVirtualization,highlightWeekends:t.highlightWeekends,milestoneMapping:t.milestoneMapping,enableRowHover:t.enableRowHover,perDayWidth:i._perDayWidth,workingTimeScale:t.workingTimeScale,roundOffDayworkingTime:t.roundOffDayworkingTime,durationUnit:t.durationUnit,perMonthWidth:i._perMonthWidth,perWeekWidth:i._perWeekWidth,perHourWidth:i._perHourWidth,includeWeekend:t.includeWeekend,connectorlineWidth:t.connectorlineWidth,scheduleHeaderSettings:t.scheduleHeaderSettings,taskbarBackground:t.taskbarBackground,progressbarBackground:t.progressbarBackground,connectorLineBackground:t.connectorLineBackground,parentTaskbarBackground:t.parentTaskbarBackground,parentProgressbarBackground:t.parentProgressbarBackground,holidays:t.holidays,dateFormat:t.dateFormat,locale:t.locale,enableTaskbarTooltip:t.enableTaskbarTooltip,enableTaskbarDragTooltip:t.enableTaskbarDragTooltip,ganttRecords:t.ganttRecords,parentRecords:t.parentRecords,rows:i._rows,scheduleWeeks:i._scheduleWeeks,projectStartDate:i._projectStartDate,projectEndDate:i._projectEndDate,scheduleYears:i._scheduleYears,scheduleMonths:i._scheduleMonths,scheduleDays:i._scheduleDays,progressbarHeight:t.progressbarHeight,tooltipTemplate:t.taskbarTooltipTemplate,tooltipTemplateId:t.taskbarTooltipTemplateId,progressbarTooltipTemplate:t.progressbarTooltipTemplate,progressbarTooltipTemplateId:t.progressbarTooltipTemplateId,queryTaskbarInfo:t.queryTaskbarInfo,showTaskNames:t.showTaskNames,showProgressStatus:t.showProgressStatus,showResourceNames:t.showResourceNames,resourceInfoMapping:t.resourceInfoMapping,resourceNameMapping:t.resourceNameMapping,enableProgressBarResizing:t.enableProgressBarResizing,allowGanttChartEditing:t.allowGanttChartEditing,taskbarEditingTooltipTemplateId:t.taskbarEditingTooltipTemplateId,taskbarEditingTooltipTemplate:t.taskbarEditingTooltipTemplate,_ids:i._ids,stripLines:t.stripLines,_predecessorCollection:i._predecessorsCollection,weekendBackground:t.weekendBackground,allowKeyboardNavigation:t.allowKeyboardNavigation,updatedGanttRecords:i._updatedGanttRecords,renderBaseline:t.renderBaseline,baselineColor:t.baselineColor,editSettings:t.editSettings,columnHeaderTexts:i._columnHeaderTexts,localizedDays:i._days,localizedMonths:i._months,rowHeight:t.rowHeight,allowSelection:t.allowSelection})},createTreeGridColumns:function(){var r=this,u=r.model,i,f=[],n=u.taskIdMapping;return n.length&&(i={field:"taskId",headerText:r._columnHeaderTexts.taskId,width:30,editType:t.Gantt.EditingType.String,mappingName:n},f.push(i)),n=u.taskNameMapping,n.length&&(i={field:"taskName",headerText:r._columnHeaderTexts.taskName,width:150,editType:t.Gantt.EditingType.String,mappingName:n},f.push(i)),n=u.startDateMapping,n.length&&(i={field:"startDate",headerText:r._columnHeaderTexts.startDate,width:150,editType:t.Gantt.EditingType.DatePicker,mappingName:n},f.push(i)),n=u.endDateMapping,n.length&&(i={field:"endDate",headerText:r._columnHeaderTexts.endDate,width:150,editType:t.Gantt.EditingType.DatePicker,mappingName:n},f.push(i)),n=u.resourceInfoMapping,n.length&&(i={field:"resourceInfo",headerText:r._columnHeaderTexts.resourceInfo,width:150,editType:t.Gantt.EditingType.Dropdown,mappingName:n,dropdownData:u.resources},f.push(i)),n=u.durationMapping,n.length&&(i={field:"duration",headerText:r._columnHeaderTexts.duration,width:150,editType:t.Gantt.EditingType.Numeric,mappingName:n},f.push(i)),n=u.progressMapping,n.length&&(i={field:"status",headerText:r._columnHeaderTexts.status,width:150,editType:t.Gantt.EditingType.Numeric,mappingName:n},f.push(i)),n=u.predecessorMapping,n.length&&(i={field:"predecessor",headerText:r._columnHeaderTexts.predecessor,width:150,editType:t.Gantt.EditingType.String,mappingName:n},f.push(i)),f},_createGanttRecords:function(n){var t=this,e=t.model,u=e.ganttRecords,s=n.length,o=0,f,h=e.parentRecords,a=e.allowSorting,v=e.enableAltRow,c=t._rows,l=t._ids,i;for(o;o<s;o++)f=t._createGanttRecord(n[o],0,null,r,"Load"),t._storedIndex++,f.isAltRow=t._storedIndex%2==0?!1:!0,f.index=t._storedIndex,c[t._storedIndex]=f,l[t._storedIndex]=f.taskId.toString(),u.push(f),h.push(f),f.childRecords&&t._addNestedGanttRecords(f.childRecords);for(i=0;i<u.length;i++)u[i].isMilestone&&(u[i].startDate=u[i].parentItem?u[i].parentItem.endDate:u[i-1].endDate),u[i].parentItem&&t._updateParentItem(u[i])},_updateLeftValue:function(){var t=this,i=this.model,r=i.ganttRecords;n.each(r,function(n,r){r.left=r._calculateLeft(t._projectStartDate,t._perDayWidth,t._holidaysList,i);i.renderBaseline&&r.baselineStartDate&&r.baselineEndDate&&(r.baselineLeft=r._calculateBaselineLeft(t._projectStartDate,t._perDayWidth,i.includeWeekend,i.dateFormat,i.endDateMapping,t._holidaysList))})},_calculateScheduleDates:function(t){var f=this,r,i,e,o,u=this.model,s=u.ganttRecords,h;(!u.scheduleEndDate||!u.scheduleStartDate)&&s.length>0||t?(n.each(s,function(n,t){e=f._getDateFromFormat(t.startDate);o=f._getDateFromFormat(t.endDate);baseLineStartDate=t.baselineStartDate?f._getDateFromFormat(t.baselineStartDate):null;baseLineEndDate=t.baselineEndDate?f._getDateFromFormat(t.baselineEndDate):null;r?(r.getTime()>=e.getTime()&&(r=e),baseLineStartDate&&u.renderBaseline&&r.getTime()>=baseLineStartDate.getTime()&&(r=baseLineStartDate)):r=baseLineStartDate&&u.renderBaseline&&e.getTime()>=baseLineStartDate.getTime()?baseLineStartDate:e;i?(i.getTime()<=o.getTime()&&(i=o),baseLineEndDate&&u.renderBaseline&&i.getTime()<=baseLineEndDate.getTime()&&(i=baseLineEndDate)):i=baseLineEndDate&&u.renderBaseline&&o.getTime()<=baseLineEndDate.getTime()?baseLineEndDate:o}),h=f._updateScheduleDatesByTaskLables(r,i),r=h.minStartDate,i=h.maxEndDate):u.scheduleEndDate&&u.scheduleStartDate||s.length!==0||(r=f._getDateFromFormat(new Date),i=f._getDateFromFormat(new Date(r)),i.setDate(i.getDate()+20));t?(t.minStartDate=r,t.maxEndDate=i):(u.scheduleStartDate=r?f.getFormatedDate(r):u.scheduleStartDate,u.scheduleEndDate=i?f.getFormatedDate(i):u.scheduleEndDate)},_updateScheduleDatesByTaskLables:function(i,r){var f=this,u=this.model,s=u.scheduleHeaderSettings.scheduleHeaderType,e=f._getResourceStringWidth(),o,c={},h=u.scheduleEndDate&&this._getDateFromFormat(u.scheduleEndDate);return s==t.Gantt.ScheduleHeaderType.Week&&(u.scheduleEndDate&&h.getTime()===r.getTime()||(o=e>0?e/f._perDayWidth+7:7,r.setDate(r.getDate()+o))),s==t.Gantt.ScheduleHeaderType.Year&&(u.scheduleEndDate&&h.getTime()===r.getTime()||(o=e>0?e/f._perMonthWidth+1:1,r.setMonth(r.getMonth()+o))),s==t.Gantt.ScheduleHeaderType.Month&&(u.scheduleEndDate&&h.getTime()===r.getTime()||(o=e>0?e/f._perDayWidth+7:7,r.setDate(r.getDate()+o))),s==t.Gantt.ScheduleHeaderType.Day&&(u.scheduleEndDate&&h.getTime()===r.getTime()||(o=e>0?e/f._perHourWidth+7:7,r.setHours(r.getHours()+o))),u.stripLines.length>0&&n.each(u.stripLines,function(n,t){var u=f._getDateFromFormat(t.day);u.getTime()>i.getTime()&&u.getTime()<r.getTime()||(u.getTime()<i.getTime()?i=u:r=u)}),f._holidaysList.length>0&&n.each(f._holidaysList,function(n,t){t.getTime()>i.getTime()&&t.getTime()<r.getTime()||(t.getTime()<i.getTime()?i=t:r=t)}),c.minStartDate=i,c.maxEndDate=r,c},_getResourceStringWidth:function(){var s=this,u=this.model,f=u.resources,e="",o,r,i;if(f.length>0&&u.showResourceNames){for(r=0;r<f.length;r++)e+=f[r][u.resourceNameMapping]+" ,";return i=t.buildTag("span","",{"font-family":"Segoe UI","font-size":"12px"},{}),i.text(e),n(document.body).append(i),o=i.width(),i.remove(),o}return 0},_calculateHeaderDates:function(){var n=this,i=this.model,r=n._getDateFromFormat(i.scheduleStartDate),u=n._getDateFromFormat(i.scheduleEndDate);i.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&n._calculateWeekSplit(r,u);i.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Year&&n._calculateYearSplit(r,u);i.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Month&&n._calculateMonthSplit(r,u);i.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&n._calculateDaySplit(r,u)},_addNestedGanttRecords:function(n){var t=this,o=t._rows,s=t._ids,h=t.model,c=h.ganttRecords,u=0,l=n.length,f=[],r,v=h.enableAltRow;for(u;u<l;u++)if(r=n[u],t._storedIndex++,r.isAltRow=t._storedIndex%2==0?!1:!0,r.index=t._storedIndex,o[t._storedIndex]=r,s[t._storedIndex]=r.taskId.toString(),c.push(r),f=r.childRecords,f){var e=0,a=f.length,i=null;for(e;e<a;e++)i=f[e],t._storedIndex++,i.isAltRow=t._storedIndex%2==0?!1:!0,i.index=t._storedIndex,o[t._storedIndex]=i,s[t._storedIndex]=i.taskId.toString(),c.push(i),i.childRecords&&t._addNestedGanttRecords(i.childRecords)}},_createGanttRecord:function(n,i,u,f,e){var h=this,o,s=h.model,y=n[s.childMapping],g=n[s.startDateMapping],nt=n[s.endDateMapping],a=n[s.durationMapping]?n[s.durationMapping]:0,b=n[s.progressMapping]?n[s.progressMapping]:0,v=h._getDateFromFormat(g),l=h._getDateFromFormat(nt),tt=n[s.resourceInfoMapping],w=n[s.predecessorMapping],it=n[s.baselineStartDateMapping],rt=h._getDateFromFormat(it,s.dateFormat),ut=n[s.baselineEndDateMapping],ft=h._getDateFromFormat(ut,s.dateFormat),k,d,c,p;if(resourceName=[],predecessorscol=[],k=v?new Date(v.getFullYear(),v.getMonth(),v.getDate()).getTime():null,d=l?new Date(l.getFullYear(),l.getMonth(),l.getDate()).getTime():null,o=new t.Gantt.GanttRecord,o.taskId=n[s.taskIdMapping],o.taskName=n[s.taskNameMapping],o.startDate=h.getFormatedDate(v),o.endDate=h.getFormatedDate(l),o.taskbarBackground=null,o.progressbarBackground=null,o.parentProgressbarBackground=null,o.parentTaskbarBackground=null,o.cellBackgroundColor=null,o.rowBackgroundColor=null,o.treeMappingName=[],o.baselineStartDate=h.getFormatedDate(rt),o.baselineEndDate=h.getFormatedDate(ft),o.duration=a,l&&(t.isNullOrUndefined(a)||k!=d)&&(o._calculateDuration(v,l,s.includeWeekend,s.holidays,n[s.milestoneMapping],s),a=o.duration),o.isMilestone=a==0?!0:n[s.milestoneMapping]?n[s.milestoneMapping]:!1,o.duration=o.isMilestone&&a!=0?0:a,o.status=b,o.predecessor=w&&o._calculatePredecessor(w),o.predecessor){for(c=0;c<o.predecessor.length;c++)predecessorscol[c]=o.predecessor[c].from.toString()+o.predecessor[c].predecessorsType.toString();o.predecessorsName=predecessorscol.join(" ")}if(o.resourceInfo=tt&&o._setResourceInfo(n[s.resourceInfoMapping],s.resourceIdMapping,s.resourceNameMapping,s.resources),o.resourceInfo){for(c=0;c<o.resourceInfo.length;c++)resourceName[c]=o.resourceInfo[c].resourceName;o.resourceNames=resourceName.join(" ")}return o.parentItem=u,s.parentTaskIdMapping&&e?(p=t.DataManager(h._retrivedData).executeLocal(t.Query().where(s.taskIdMapping,t.FilterOperators.equal,o.taskId)),o.item=p[0]):this.dataSource()instanceof t.DataManager&&this.dataSource().dataSource.json&&this.dataSource().dataSource.offline&&e?(p=t.DataManager(h._retrivedData).executeLocal(t.Query().where(s.taskIdMapping,t.FilterOperators.equal,o.taskId)),o.item=p.length>0?p[0]:n):o.item=n,o.isSelected=h.selectedItem()?h.selectedItem()[s.taskIdMapping?s.taskIdMapping:"Task Id"]==o.taskId?!0:!1:!1,o.level=i,o.endDate||o._calculateEndDate(s.includeWeekend,this._holidaysList,s,h._perDayWidth),o.width=o._calculateWidth(h._perDayWidth,h._holidaysList,s),o.width=o.width==0?26:o.width,o.progressWidth=o._calculateProgressWidth(o.width,b),o.childRecords=y&&h._createChildRecords(y,i+1,o),o.hasChildRecords=y?!0:!1,o.expanded=f!==r?f:y?y.length>0:!1,s.enableVirtualization===!1&&(o.isExpanded=!0),e||(o.left=o._calculateLeft(h._projectStartDate,h._perDayWidth,h._holidaysList,s),s.renderBaseline&&o.baselineStartDate&&o.baselineEndDate&&(o.baselineLeft=o._calculateBaselineLeft(h._projectStartDate,h._perDayWidth,s.includeWeekend,s.dateFormat,s.endDateMapping,h._holidaysList))),s.renderBaseline&&o.baselineStartDate&&o.baselineEndDate?o.baselineWidth=o._calculateBaseLineWidth(h._perDayWidth,s):s.renderBaseline=!1,w&&h._predecessorsCollection.push(o),o},_getHoliday:function(){var n;if(this.model.holidays!=null){var t=this.model.holidays,i=[],r=t.length;if(r>0){for(n=0;n<r;n++)i[n]=this.getDateType(t[n].day);return i}}return!1},_getStringHolidays:function(){var n;if(this._holidaysList!=null&&this._holidaysList.length>0){var t=this._holidaysList,i=[],r=t.length;if(r>0){for(n=0;n<r;n++)i[n]=Globalize.format(t[n],this.model.dateFormat);return i}}return!1},_createChildRecords:function(n,t,i){for(var f=[],o=this,u=0,s=n.length,e,u=0;u<s;u++)n[u]&&(e=o._createGanttRecord(n[u],t,i,r,"Load"),f.push(e));return f},_createResourceInfoCollection:function(n){var i=this,t=0,r=n.length;for(t;t<r;t++)i._resourceInfoCollection.push(i._createResourceInfo(n[t]))},_createResourceInfo:function(n){var i=this.model,t={};return t.resourceId=n[i.resourceIdMapping],t.resourceName=n[i.resourceNameMapping],t},_calculateWeekSplit:function(n,t){var i=this,r=n.getDay()==0?n.getDate()-7:n.getDate()-n.getDay();n.setDate(r);do i._scheduleWeeks.push(new Date(n)),n.setDate(n.getDate()+7);while(!(n>t));i._projectStartDate=new Date(i._scheduleWeeks[0]);i._projectEndDate=new Date(i._scheduleWeeks[i._scheduleWeeks.length-1])},_calculateYearSplit:function(n,t){var i=this,r,u;n.setMonth(0);do i._scheduleYears.push(new Date(n)),n.setMonth(n.getMonth()+12);while(!(n>=t));r=new Date(i._scheduleYears[0].getFullYear(),0,1);u=new Date(i._scheduleYears[i._scheduleYears.length-1].getFullYear(),11,31);i._projectStartDate=r;i._projectEndDate=u},_calculateDaySplit:function(n,t){var i=this;do i._scheduleDays.push(new Date(n)),n.setDate(n.getDate()+1);while(n<=t);i._projectStartDate=new Date(i._scheduleDays[0]);i._projectEndDate=new Date(i._scheduleDays[i._scheduleDays.length-1])},_calculateMonthSplit:function(n,t){var i=this,u,r;dt=new Date(n.getFullYear(),n.getMonth()-1,1);n=dt;do i._scheduleMonths.push(new Date(n)),n.getMonth()==0||n.getMonth()==2||n.getMonth()==4||n.getMonth()==6||n.getMonth()==7||n.getMonth()==9||n.getMonth()==11?n.setDate(n.getDate()+31):n.getMonth()==3||n.getMonth()==5||n.getMonth()==8||n.getMonth()==10?n.setDate(n.getDate()+30):n.getMonth()==1&&(n.getFullYear()%4==0?n.setDate(n.getDate()+29):n.setDate(n.getDate()+28));while(!(n>=t));u=new Date(i._scheduleMonths[0]);r=new Date(i._scheduleMonths[i._scheduleMonths.length-1]);r=new Date(r.getFullYear(),r.getMonth()+1,0);i._projectStartDate=u;i._projectEndDate=r},_updatePredecessors:function(){var u=this,i=0,f=u._predecessorsCollection,h=f.length,e,o,r=0,n,s,t;for(i;i<h;i++)for(e=f[i],o=e.predecessor,s=o.length,r=0;r<s;r++)t=o[r],n=u.model.ganttRecords[u._ids.indexOf(t.from)],t.to=e.taskId.toString(),n&&(n.predecessor?n.predecessor.push(t):(n.predecessor=[],n.predecessor.push(t),f.push(n)))},getDateType:function(n){if(n!=null){if(typeof n=="object")return n;var t=new RegExp("\\-","g"),i=new RegExp("\\.","g");return n=n.replace(t,"/"),n=n.replace(i,"/"),new Date(n)}return null},getFormatedDate:function(n){return Globalize.format(n,this.model.dateFormat)},_getProgressWidth:function(n,t){return n*t/100},_wireEvents:function(){var t=this,u=t.model,i=n("#ejTreeGrid"+t._id),r=n("#ejGanttChart"+t._id),f=t._$ejGantt;t._on(t.element,"click",t.clickHandler);t._on(t.element,"contextmenu",t._rightClick);u.enableResize&&t._on(n(window),"resize",t.windowResize);i.ejTreeGrid({rowSelecting:n.proxy(t.rowSelecting,t)});i.ejTreeGrid({rowSelected:n.proxy(t.rowSelected,t)});i.ejTreeGrid({actionBegin:n.proxy(t.actionBegin,t)});i.ejTreeGrid({actionComplete:n.proxy(t.actionComplete,t)});u.queryCellInfo&&i.ejTreeGrid({queryCellInfo:n.proxy(t._queryCellInfo,t)});u.rowDataBound&&i.ejTreeGrid({rowDataBound:n.proxy(t._rowDataBound,t)});i.ejTreeGrid({beginEdit:n.proxy(t._beginEdit,t)});i.ejTreeGrid({endEdit:n.proxy(t._endEdit,t)});i.ejTreeGrid({expanding:n.proxy(t.expanding,t)});i.ejTreeGrid({collapsing:n.proxy(t.collapsing,t)});i.ejTreeGrid({expanded:n.proxy(t.expanded,t)});i.ejTreeGrid({collapsed:n.proxy(t.collapsed,t)});i.ejTreeGrid({refreshRow:n.proxy(t.refreshRow,t)});i.ejTreeGrid({cancelEditCell:n.proxy(t.cancelEditCell,t)});r.ejGanttChart({rowSelecting:n.proxy(t.rowSelecting,t)});r.ejGanttChart({rowSelected:n.proxy(t.rowSelected,t)});r.ejGanttChart({rowHover:n.proxy(t._ganttChartRowHover,t)});r.ejGanttChart({actionBegin:n.proxy(t.actionBegin,t)});r.ejGanttChart({actionComplete:n.proxy(t.chartactionComplete,t)});r.ejGanttChart({refreshRow:n.proxy(t.refreshRowData,t)});r.ejGanttChart({zooming:n.proxy(t.zoomingChart,t)});r.ejGanttChart({queryTaskbarInfo:n.proxy(t.queryTaskbarInfo,t)});r.ejGanttChart({expanding:n.proxy(t.expanding,t)});r.ejGanttChart({collapsing:n.proxy(t.collapsing,t)});r.ejGanttChart({expanded:n.proxy(t.expanded,t)});r.ejGanttChart({collapsed:n.proxy(t.collapsed,t)});r.ejGanttChart({taskbarEditing:n.proxy(t.taskbarEditing,t)});r.ejGanttChart({taskbarEdited:n.proxy(t.taskbarEdited,t)});f.ejSplitter({allowResizing:n.proxy(t._onResize,t)});t._enableEditingEvents()},_onResize:function(n){var t=this;t._$treegridHelper.ejTreeGrid("refreshScroller",n.prevPane.size);t._$ganttchartHelper.ejGanttChart("refreshScroller",n.nextPane.size)},clickHandler:function(t){var r=this,i=n(t.target);(r._clearContextMenu(),t.toElement&&(t.toElement.tabIndex=0,t.toElement.focus()),i.hasClass("e-vhandle")||i.hasClass("e-vscroll")||i.hasClass("e-vup")||i.hasClass("e-vhandlespace")||i.hasClass("e-vdown"))||i.hasClass("e-hhandle")||i.hasClass("e-hscroll")||i.hasClass("e-hup")||i.hasClass("e-hdown")||i.hasClass("e-hhandlespace")||r._isinBeginEdit&&(i.closest("td").hasClass("e-editedcell")||i.hasClass("e-date")||i.hasClass("e-arrow")||i.hasClass("e-down-arrow")||i.closest("form#ejTreeGrid"+r._id+"EditForm").length!=0?!i.closest("td").hasClass("e-editedcell")||i.hasClass("e-date")||i.hasClass("e-arrow")||i.hasClass("e-down-arrow")||i.focus():(r._$treegridHelper.ejTreeGrid("cancelEditCell"),r._isinBeginEdit=!1))},windowResize:function(){var i=this,v="#e-ejSpliter"+this._id,o="#"+this._id+"_toolbarItems",w="#ejGanttChart"+this._id,ut="#ejTreeGrid"+this._id,s=".e-ganttviewerbodyContianer",b=".e-ganttviewerheaderContainer",ft="#ejTreeGrid"+this._id,h="#ejTreeGrid"+this._id+"e-gridcontent",c=i.model.sizeSettings.width,l=i.model.sizeSettings.height,k=i.element[0].style.height,d=i.element[0].style.width,r,u,f,g,nt,tt,it,a,rt,y,e,p;c&&c.indexOf("%")!=-1||d.indexOf("%")!=-1?(a=c?c:d,g=n(i.element).parent().width()?n(i.element).parent().width():n(i.element).width(),r=g/100*parseInt(a)):r=n(i.element).width();l&&l.indexOf("%")!=-1||k.indexOf("%")!=-1?(nt=l?l:k,tt=n(i.element).parent().height()?n(i.element).parent().height():n(i.element).height(),it=n(i.element).parent().height()?tt/100*parseInt(nt):n(i.element).height(),u=it):u=n(i.element).height();u=u-i._totalBorderHeight;r=r-i._totalBorderWidth;r=Math.round(r);n(v).width(r);n(v).height(u-n(o).height());n(v).ejSplitter("refresh");n(o).width(r);n(o).children(".e-ul:first-child").width(r);a=n(w).width();rt=n(ut).width();n(w).height(u-n(o).height());y=n(s).ejScroller("option","scrollTop");e=n(s).ejScroller("option","scrollLeft");n(s).ejScroller({width:a,height:u-n(o).height()-n(b).height()-i._totalBorderHeight});n(s).ejScroller("refresh");f=i._$ganttchartHelper.ejGanttChart("getMaxScrollWidth");e>f&&(e=f>0?f:0);n(s).ejScroller("option","scrollTop",y);n(s).ejScroller("option","scrollLeft",e);n(ft).height(u-n(o).height());n(h).height(u-n(o).height()-n(b).height()-i._totalBorderHeight);e=n(h).ejScroller("option","scrollLeft");n(h).ejScroller({width:rt});n(h).ejScroller("refresh");f=i._$treegridHelper.ejTreeGrid("getMaxScrollWidth");e>f&&(e=f>0?f:0);n(h).ejScroller("option","scrollLeft",e);i._$treegridHelper.ejTreeGrid("updateViewPortHeight");i._$ganttchartHelper.ejGanttChart("updateViewPortHeight");i.model.enableVirtualization&&(i._$treegridHelper.ejTreeGrid("processBindings"),p={},p.requestType=t.TreeGrid.Actions.Refresh,i._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",p),i._$ganttchartHelper.ejGanttChart("refreshHelper",i._currentViewData,i._updatedGanttRecords),i._$ganttchartHelper.ejGanttChart("onScrollHelper",y))},_rightClick:function(t){var i=this,o=n(t.target),s=o[0].parentNode,e,h,r,u,f={};i._$treegridHelper.ejTreeGrid("disableTooltip");n(s).hasClass("e-chartcell")||n(s).hasClass("e-ganttrowcell")?(e=i._$ganttchartHelper.ejGanttChart("getGanttChartRows"),f.target="ejTreeGrid"):(e=n(i._$treegridHelper.ejTreeGrid("getRows")),f.target="ejGanttChart");h=o.closest("tr");r=e.index(h);i._currentViewData=i.getCurrentViewData();u=i._currentViewData[r];r=i._updatedGanttRecords.indexOf(u);f.data=u;f.recordIndex=r;u&&i.model.enableContextMenu?(t.preventDefault(),i._contextMenuItems=[],i._contextMenuItems=i._getContextMenuItems(),i._subContextMenuItems=[],i._subContextMenuItems=i._getsubContextMenuItems(),i._updateIndentOutdentContextmenuOption(r,u),i._clearContextMenu(),i._contextMenuItems.length>0&&i._renderContextMenu(t,r,u),i.rowSelected(f),i._$treegridHelper.ejTreeGrid("selectRows",r),i._$ganttchartHelper.ejGanttChart("selectRows",r)):(i.dataSource()==null||i.dataSource().length==0)&&(i._contextMenuItems=[],i._subContextMenuItems=[],i._contextMenuItems=i._getContextMenuItems(),i._updateIndentOutdentContextmenuOption(r,u),i._clearContextMenu(),i._contextMenuItems.length>0&&i._renderContextMenu(t,r,u))},_updateIndentOutdentContextmenuOption:function(t,i){var r=this,f;t===0?r._contextMenuItems.splice(2,2):t>0?i.level===0?r._contextMenuItems.splice(3,1):(f=r._updatedGanttRecords[t-1],i.level-f.level==1&&r._contextMenuItems.splice(2,1),i.isMilestone&&r._contextMenuItems.splice(3,1),f.isMilestone&&r._contextMenuItems.splice(2,1)):t<0&&(r._contextMenuItems.splice(0,1),r._contextMenuItems.splice(1,3));var u=-1,o=-1,e=-1;model.editSettings.allowAdding||(n.each(r._contextMenuItems,function(n,t){t.headerText==="Add New Task"&&(u=n)}),u!==-1&&r._contextMenuItems.splice(u,1));model.editSettings.allowDeleting||(n.each(r._contextMenuItems,function(n,t){t.headerText==="Delete"&&(e=n)}),e!==-1&&r._contextMenuItems.splice(e,1));model.editSettings.allowEditing||(n.each(r._contextMenuItems,function(n,t){t.headerText==="Task Details..."&&(o=n)}),r._contextMenuItems.splice(o,1));r._searchString.length>0&&u!==-1&&r._contextMenuItems.splice(u,1)},queryTaskbarInfo:function(n){this._trigger("queryTaskbarInfo",n)},zoomingChart:function(n){var t=this;t.reRenderChart(n.delta)},refreshRowData:function(n){var t=this;t._$treegridHelper.ejTreeGrid("refreshRow",n.index)},expanding:function(n){var i=this,r;i._trigger("expanding",n)||(i.model.enableVirtualization?t.TreeGrid.sendExpandCollapseRequest(i,n):(i._isInExpandCollapse=!0,t.TreeGrid.sendExpandCollapseRequest(i,n),i._isInExpandCollapse=!1,r=i._expandedRecordsCount,i._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",r)))},collapsing:function(i){var r=this,f,u,e;r._trigger("collapsing",i)||(r.model.enableVirtualization?t.TreeGrid.sendExpandCollapseRequest(r,i):(r._gridRows=r.getRows(),r._isInExpandCollapse=!0,t.TreeGrid.sendExpandCollapseRequest(r,i),r._isInExpandCollapse=!1,f=r._collapsedRecordCount,r._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",-f)),u=r.selectedItem(),!i.expanded&&u&&(e=r.getExpandStatus(u),e||(r._deSelectRowItem(),r.model.toolbarSettings.showToolbar&&r.model.toolbarSettings.toolbarItems.indexOf("delete")!==-1&&(n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-deleteitem")[0]).parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("indent")!==-1&&n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-indent")[0]).parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("outdent")!==-1&&n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-outdent")[0]).parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("edit")!==-1&&n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-edititem")[0]).parent()[0])))))},expanded:function(n){var t=this;t._updatedGanttRecords=t.getUpdatedRecords();t._currentViewData=t.getCurrentViewData();t.model.enableVirtualization&&(t.model.predecessorMapping&&(t._isValidationEnabled=!1,t._$ganttchartHelper.ejGanttChart("clearConnectorLines"),t._connectorlineIds=[],t._connectorLinesCollection=[],t._createConnectorLinesCollection()),t._$ganttchartHelper.ejGanttChart("refreshHelper",t._currentViewData,t._updatedGanttRecords));t._trigger("expanded",n)},collapsed:function(n){var t=this;t._updatedGanttRecords=t.getUpdatedRecords();t._currentViewData=t.getCurrentViewData();t.model.enableVirtualization&&(t.model.predecessorMapping&&(t._isValidationEnabled=!1,t._connectorlineIds=[],t._connectorLinesCollection=[],t._$ganttchartHelper.ejGanttChart("clearConnectorLines"),t._createConnectorLinesCollection()),t._$ganttchartHelper.ejGanttChart("refreshHelper",t._currentViewData,t._updatedGanttRecords));t._trigger("collapsed",n)},refreshRow:function(n){var t=this;t._$ganttchartHelper.ejGanttChart("refreshRow",n.recordIndex)},_enableEditingEvents:function(){var t=this,i=t.model;(i.editSettings.allowEditing||i.editSettings.editMode=="dialogTemplate"||i.toolbarSettings.showToolbar&&(i.editSettings.allowAdding&&i.toolbarSettings.toolbarItems.indexOf("add")!==-1||i.editSettings.allowEditing&&i.toolbarSettings.toolbarItems.indexOf("index")!==-1))&&(t._on(n("#"+t._id+"_dialogEdit"),"click keypress","#EditDialog_"+t._id+"_Save ,#EditDialog_"+t._id+"_Cancel,#EditDialog_"+t._id+"_Delete",t._buttonClick),t._on(n("#"+t._id+"_dialogAdd"),"click keypress","#AddDialog_"+t._id+"_Save ,#AddDialog_"+t._id+"_Cancel",t._buttonClick))},cancelEditCell:function(){var t=this;t.model.toolbarSettings.toolbarItems.indexOf("cancel")!==-1&&t._disabledToolItems.push(n(n(".e-cancel")[0]).parent()[0]);t.model.toolbarSettings.toolbarItems.indexOf("save")!==-1&&t._disabledToolItems.push(n(n(".e-saveitem")[0]).parent()[0]);n(".e-gantttoolbar").ejToolbar("disableItem",t._disabledToolItems)},_keyPressed:function(){},_buttonClick:function(t){if(t.keyCode!==r&&t.keyCode!=13)return!0;var i=this,u=i.model;return u.editSettings.allowEditing||u.editSettings.editMode=="dialogTemplate"||u.toolbarSettings.showToolbar&&(u.editSettings.allowAdding&&u.toolbarSettings.toolbarItems.indexOf("add")!==-1||u.editSettings.allowEditing&&u.toolbarSettings.toolbarItems.indexOf("index")!==-1)?t.target.id=="EditDialog_"+i._id+"_Save"?i._sendSaveRequest("Edit")||n("#"+i._id+"_dialogEdit").ejDialog("close"):t.target.id=="EditDialog_"+i._id+"_Cancel"?n("#"+i._id+"_dialogEdit").ejDialog("close"):t.target.id=="EditDialog_"+i._id+"_Delete"?(i._$treegridHelper.ejTreeGrid("deleteRow"),n("#"+i._id+"_dialogEdit").ejDialog("close")):t.target.id=="AddDialog_"+i._id+"_Save"?i._sendSaveRequest("Add")||this._duplicate||this._wrongenddate||n("#"+i._id+"_dialogAdd").ejDialog("close"):t.target.id=="AddDialog_"+i._id+"_Cancel"&&n("#"+i._id+"_dialogAdd").ejDialog("close"):i._sendCancelRequest(),!1},rowSelecting:function(n){var t=this;return t.model.rowSelecting&&t._trigger("rowSelecting",n),!0},rowSelected:function(t){var i=this,u,r;t.target=="ejTreeGrid"&&i._$ganttchartHelper.ejGanttChart("selectRows",t.recordIndex);t.target=="ejGanttChart"&&i._$treegridHelper.ejTreeGrid("selectRows",t.recordIndex);u=t.recordIndex;this.selectedItem(t.data);this.selectedRowIndex(u);i.model.toolbarSettings.showToolbar&&((i.model.toolbarSettings.toolbarItems.indexOf("indent")!==-1||i.model.toolbarSettings.toolbarItems.indexOf("outdent")!==-1)&&i.updateIndentOutdentOption(t.data),r=[],i.model.editSettings.allowDeleting&&i.model.toolbarSettings.toolbarItems.indexOf("delete")!==-1&&r.push(n(n(".e-deleteitem")[0]).parent()[0]),i.model.editSettings.allowAdding&&i.model.toolbarSettings.toolbarItems.indexOf("add")!==-1&&r.push(n(n(".e-addnewitem")[0]).parent()[0]),i.model.editSettings.allowEditing&&i.model.toolbarSettings.toolbarItems.indexOf("edit")!==-1&&r.push(n(n(".e-edititem")[0]).parent()[0]),n(".e-gantttoolbar").ejToolbar("enableItem",r));i.model.rowSelected&&i._trigger("rowSelected",t)},_treeGridRowHover:function(n){var t=this;n.reason=="mouseenter"?t._$ganttchartHelper.ejGanttChart("addRowHover",n.index):n.reason=="mouseleave"&&t._$ganttchartHelper.ejGanttChart("removeRowHover")},updateIndentOutdentOption:function(t){var u=this;u._updatedGanttRecords=u.getUpdatedRecords();var f=u._updatedGanttRecords.indexOf(t),e,i=n(n(".e-indent")[0]).parent()[0],r=n(n(".e-outdent")[0]).parent()[0];f===0?(i&&n(".e-gantttoolbar").ejToolbar("disableItem",i),r&&n(".e-gantttoolbar").ejToolbar("disableItem",r),n(".e-gantttoolbar").ejToolbar("disableItem",[])):t.level===0?(i&&n(".e-gantttoolbar").ejToolbar("enableItem",i),r&&n(".e-gantttoolbar").ejToolbar("disableItem",r)):(e=u._updatedGanttRecords[f-1],t.level-e.level==1?(r&&n(".e-gantttoolbar").ejToolbar("enableItem",r),i&&n(".e-gantttoolbar").ejToolbar("disableItem",i)):(i&&n(".e-gantttoolbar").ejToolbar("enableItem",i),r&&n(".e-gantttoolbar").ejToolbar("enableItem",r)))},_ganttChartRowHover:function(n){var t=this;n.reason=="mouseenter"?t._$treegridHelper.ejTreeGrid("addRowHover",n.index):n.reason=="mouseleave"&&t._$treegridHelper.ejTreeGrid("removeRowHover")},_removeChildRecordsPredecessor:function(n){var i=this,r,t;if(n.hasChildRecords)for(r=n.childRecords.length,t=0,t;t<r;t++)n.childRecords[t].predecessor&&i._removePredecessor(n.childRecords[t].predecessor,n.childRecords[t]),n.childRecords[t].hasChildRecords&&i._removeChildRecordsPredecessor(n.childRecords[t])},getExpandedRecordCount:function(n,t){var i,u=this,r;if(!n.hasChildRecords)return 0;for(r=0;r<n.childRecords.length;r++)i=n.childRecords[r],u.getExpandStatus(i)&&t++,i.hasChildRecords&&(t=u.getExpandedRecordCount(i,t));return t},_updateExpandStatus:function(){for(var i=this,t=i._rows,r=t.length,u,n=0;n<r;n++)u=t[n].isExpanded,i.getExpandStatus(t[n])!==t[n].isExpanded&&(t[n].isExpanded=i.getExpandStatus(t[n]),t[n].isExpanded?i._totalCollapseRecordCount--:i._totalCollapseRecordCount++)},actionComplete:function(i){var r=this,f=r.model,l,o,e,h,s,u,c;if(r._updatedGanttRecords=r.getUpdatedRecords(),r._currentViewData=r.getCurrentViewData(),r._gridRows=r.getRows(),r._ganttChartRows=r.getGanttChartRows(),(i.requestType==="searching"||i.requestType==="sorting")&&(r._$ganttchartHelper.ejGanttChart("clearConnectorLines"),l=r._$ganttchartHelper.ejGanttChart("getVisibleRecordsCount"),f.enableVirtualization?r._$ganttchartHelper.ejGanttChart("refreshHelper",r._currentViewData,r._updatedGanttRecords):(r._updateExpandStatus(),u=0,u=r._currentViewData.filter(function(n){return r.getExpandStatus(n)===!1}),i.requestType==="searching"||r._searchString?(r._$ganttchartHelper.ejGanttChart("refreshHelper",r._currentViewData,r._updatedGanttRecords,u.length),r._$ganttchartHelper.ejGanttChart("refrehGridLinesTable",r._currentViewData.length-u.length)):(r._$ganttchartHelper.ejGanttChart("refreshHelper",r._currentViewData,r._updatedGanttRecords,u.length),r._$ganttchartHelper.ejGanttChart("refrehGridLinesTable",r._currentViewData.length-r._totalCollapseRecordCount)),r._$treegridHelper.ejTreeGrid("updateHeight",(r._updatedGanttRecords.length-u.length)*r.model.rowHeight),r._$ganttchart.ejGanttChart("setCollapsedRecordCount",u.length),r._$treegridHelper.ejTreeGrid("setCollapsedRecordCount",u.length)),r._isValidationEnabled=!1,r._connectorlineIds=[],r._connectorLinesCollection=[],r._createConnectorLinesCollection()),i.requestType==="delete"&&(this.dataSource(r._$treegridHelper.ejTreeGrid("getDataSource")),f.selectedItem=null,this.selectedRowIndex(-1),o=0,e=0,f.enableVirtualization||(i.data.hasChildRecords?(o=r._$treegridHelper.ejTreeGrid("getChildCount",i.data,0),e=r.getExpandedRecordCount(i.data,0),i.data.expanded?(r._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",-(e+1)),r._totalCollapseRecordCount-=o-e):(r._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",-1),r._totalCollapseRecordCount-=o-e)):r._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",-1)),f.parentRecords.indexOf(i.data)!==-1&&f.parentRecords.splice(f.parentRecords.indexOf(i.data),1),i.data.hasChildRecords&&r._removeChildRecordsPredecessor(i.data),i.data.predecessor&&r._removePredecessor(i.data.predecessor,i.data),i.data.parentItem&&(parentRecord=i.data.parentItem,i.data.parentItem.childRecords.length>0?r._updateParentItem(i.data):(parentRecord.expanded=!1,parentRecord.hasChildRecords=!1,r.refreshGanttRecord(parentRecord))),r._rows=r._$treegridHelper.ejTreeGrid("getFlatRecords"),r._ids=r._ids=r._$treegridHelper.ejTreeGrid("getUpdatedIds"),r._isValidationEnabled=!1,r.model.predecessorMapping&&(r._connectorlineIds=[],r._connectorLinesCollection=[],r._predecessorsCollection=[],r._$ganttchartHelper.ejGanttChart("clearConnectorLines"),r._createConnectorLinesCollection()),r._$ganttchartHelper.ejGanttChart("refreshHelper",r.getCurrentViewData(),r.getUpdatedRecords(),r._totalCollapseRecordCount),r.model.toolbarSettings.showToolbar&&r.model.toolbarSettings.toolbarItems.indexOf("delete")!==-1&&(n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-deleteitem")[0]).parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("indent")!==-1&&n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-indent")[0]).parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("outdent")!==-1&&n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-outdent")[0]).parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("edit")!==-1&&n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-edititem")[0]).parent()[0])),r.updateAltRow(r.getUpdatedRecords,0,1)),i.requestType==="selection"&&r._$ganttchartHelper.ejGanttChart("selectRows",i.recordIndex),i.requestType==="rowHover"&&r._$ganttchartHelper.ejGanttChart("addRowHover",i.index),i.requestType==="scroll"&&r._$ganttchartHelper.ejGanttChart("onScrollHelper",i.delta),i.requestType==="save"&&(i._cAddedRecord?(r._$treegridHelper.ejTreeGrid("renderRecord",i),treegridobj=r._$treegridHelper.ejTreeGrid("instance"),(treegridobj.model.sortSettings.sortedColumns.length>0||treegridobj.model.allowSearching&&treegridobj._searchString.length>0)&&(h={},r._$treegridHelper.ejTreeGrid("processBindings",h),s={},s.requestType=t.TreeGrid.Actions.Refresh,r._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",s)),this.dataSource(r._$treegridHelper.ejTreeGrid("getDataSource")),r._ids=r._$treegridHelper.ejTreeGrid("getUpdatedIds"),r.model.ganttRecords=r._$treegridHelper.ejTreeGrid("getFlatRecords"),r._updatedGanttRecords=r._$treegridHelper.ejTreeGrid("getUpdatedRecords"),r._rows=r._$treegridHelper.ejTreeGrid("getFlatRecords"),r._currentViewData=r._$treegridHelper.ejTreeGrid("getCurrentViewData"),r._$ganttchartHelper.ejGanttChart("setUpdatedRecords",r._currentViewData,r._updatedGanttRecords,r._rows,r._ids),treegridobj.model.sortSettings.sortedColumns.length>0||treegridobj.model.allowSearching&&treegridobj._searchString.length>0?(r._$ganttchartHelper.ejGanttChart("refreshHelper",r.getCurrentViewData(),r.getUpdatedRecords(),r._totalCollapseRecordCount),f.enableVirtualization||(u=0,u=r._updatedGanttRecords.filter(function(n){return r.getExpandStatus(n)===!1}),r._$ganttchartHelper.ejGanttChart("refrehGridLinesTable",r._currentViewData.length-u.length))):(r._$ganttchartHelper.ejGanttChart("renderRecord",i,r._totalCollapseRecordCount),r.model.selectedItem?!r.model.selectedItem.expanded&&r.model.selectedItem.childRecords?i.position?i.position=="Above"&&r._currentViewData.length!=1&&r._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",1):r._totalCollapseRecordCount++:r._currentViewData.length!=1&&r._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",1):r._currentViewData.length!=1&&r._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",1)),i._cAddedRecord.parentItem||f.parentRecords.splice(i._cAddedRecord.index,0,i._cAddedRecord)):i._cModifiedData&&(i._cModifiedData.left=i._cModifiedData._calculateLeft(r._projectStartDate,r._perDayWidth,r._holidaysList,f),i._cModifiedData.width=i._cModifiedData._calculateWidth(r._perDayWidth,r._holidaysList,f),i._cModifiedData.progressWidth=i._cModifiedData._getProgressWidth(i._cModifiedData.width,i._cModifiedData.status),r.refreshGanttRecord(i._cModifiedData),i._cModifiedData.parentItem&&r._updateParentItem(i._cModifiedData),i._cModifiedData.predecessor&&i.previousValue&&r._removeConnectorLine(i.previousValue,i._cModifiedData)),r.model.predecessorMapping&&(r._isValidationEnabled=i._cAddedRecord&&i._cAddedRecord.predecessor||i._cModifiedData&&i._cModifiedData.predecessor?!0:!1,i._cAddedRecord?(r._$ganttchartHelper.ejGanttChart("clearConnectorLines"),r._connectorlineIds=[],r._connectorLinesCollection=[],r._createConnectorLinesCollection(),r._addConnectorLine(i._cAddedRecord)):i._cModifiedData&&(i.previousValue&&r._removeConnectorLine(i.previousValue,i._cModifiedData),r._addConnectorLine(i._cModifiedData),i._cModifiedData.predecessor&&(r._isMileStoneEdited=i._cModifiedData.isMilestone,r._updatedConnectorLineCollection=[],r._connectorlineIds=[],r._validatePredecessor(i._cModifiedData),r._updatedConnectorLineCollection.length>0&&r._$ganttchartHelper.ejGanttChart("appendConnectorLine",r._updatedConnectorLineCollection)),i._cModifiedData.parentItem&&r._updateParentItem(i._cModifiedData)))),i.requestType==="validatePredecessor"){c=r._editedPredecessorValidation(i);i.result=c;return}r._ganttActionCompleteTrigger(i)},chartactionComplete:function(n){var t=this,u,i;t._updatedGanttRecords=t.getUpdatedRecords();t._currentViewData=t.getCurrentViewData();n.requestType==="updateConnectors"&&t.model.predecessorMapping&&(t._isValidationEnabled=!1,t._connectorlineIds=[],t._connectorLinesCollection=[],t._$ganttchartHelper.ejGanttChart("clearConnectorLines"),t._createConnectorLinesCollection());n.requestType==="rowHover"&&t._$treegridHelper.ejTreeGrid("addRowHover",n.index);n.requestType==="scroll"&&(t._isRenddered=!1,n.vscrollExsist&&n.delta!==r&&t._$treegridHelper.ejTreeGrid("onScrollHelper",n.delta),t._updatedGanttRecords=t.getUpdatedRecords(),t._currentViewData=t.getCurrentViewData(),t.model.enableVirtualization&&t.model.predecessorMapping&&(t._connectorLinesCollection.length>0&&t._$ganttchartHelper.ejGanttChart("clearConnectorLines"),t._isValidationEnabled=!1,t._connectorlineIds=[],t._connectorLinesCollection=[],t._createConnectorLinesCollection()),t._isRenddered=!0);n.requestType==="selection"&&t._$treegridHelper.ejTreeGrid("selectRows",n.recordIndex);n.requestType==="validatePredecessor"&&(n.data[this.model.taskIdMapping]=n.data.taskID,u=t._editedPredecessorValidation(n),n.predecessorValidation=u);n.requestType==="drawConnectorLine"&&(i=n.toItem._calculatePredecessor(n.predecessor),n.toItem.item[t.model.predecessorMapping]=n.predecessorString[0],n.fromItem.predecessor?n.fromItem.predecessor.push(i[0]):n.fromItem.predecessor=i,n.toItem.predecessor?n.toItem.predecessor.push(i[0]):(n.toItem.predecessor=[],n.toItem.predecessor.push(i[0])),t._isMileStoneEdited=n.toItem.isMilestone,t._updatedConnectorLineCollection=[],t._connectorlineIds=[],t._validatePredecessor(n.toItem),t._updatedConnectorLineCollection.length>0&&t._$ganttchartHelper.ejGanttChart("appendConnectorLine",t._updatedConnectorLineCollection));t._ganttActionCompleteTrigger(n)},_clearConnectorLines:function(){var n=this,t=0,h=n._connectorLinesCollection.length,f,e,o,i,s,r=0,u;for(t;t<h;t++)for(f=n._connectorLinesCollection[t],e=f&&f.ConnectorLineId.split("child")[1],o=n._rows[n._ids.indexOf(e)],i=o.predecessor,s=i&&i.length,r=0;r<s;r++)u=i[r],u.to===e&&u.isdrawn&&(u.isdrawn=!1);n._$ganttchartHelper.ejGanttChart("clearConnectorLines")},taskbarEditing:function(n){this._trigger("taskbarEditing",n)},_refreshParent:function(n){this.refreshGanttRecord(n);n.parentItem&&this._refreshParent(n.parentItem)},taskbarEdited:function(n){var u=this,i=n.data,r=u.model,f=new Date(u._projectStartDate),o,l,s=0,p,b,v,e,y,k,d,h,c;if(u._isValidationEnabled=!1,n.dragging)n.previousData.left!==i.left&&(o=i.left%u._perDayWidth,l=(i.left-o)/u._perDayWidth,s=0,o>0&&r.workingTimeScale!=t.Gantt.workingTimeScale.TimeScale24Hours&&(s=o>=u._perDayWidth/2?1:0),h=Math.round(o/(u._perDayWidth/24)),f.setDate(f.getDate()+l+s),r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day?f.setHours(h):r.dateFormat.indexOf("hh:")&&r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(h=Math.round(o/(u._perDayWidth/9)),f.setHours(8)),r.workingTimeScale!=t.Gantt.workingTimeScale.TimeScale24Hours&&(o>=u._perDayWidth/2?(i.left=i.left+u._perDayWidth,r.roundOffDayworkingTime&&(i.left-=o)):(i.left=i.left,r.roundOffDayworkingTime&&(i.left-=o))),this._stringHolidays&&this._stringHolidays.indexOf(i._getFormatedDate(f,r.dateFormat))!=-1&&(f.setDate(f.getDate()+1),i.left+=u._perDayWidth),this.model.includeWeekend==!1&&(f.getDay()===0?(f.setDate(f.getDate()+1),i.left+=u._perDayWidth):f.getDay()===6&&(f.setDate(f.getDate()+2),i.left+=2*u._perDayWidth)),this._stringHolidays&&this._stringHolidays.indexOf(i._getFormatedDate(f,r.dateFormat))!=-1&&(f.setDate(f.getDate()+1),i.left+=u._perDayWidth),i.startDate=i._getFormatedDate(f,r.dateFormat),r.startDateMapping&&(i.item[r.startDateMapping]=i.startDate),i._calculateEndDate(r.includeWeekend,this._holidaysList,r,u._perDayWidth),i.width=i._calculateTaskbarWidth(u._perDayWidth,r),i.progressWidth=i._getProgressWidth(i.width,i.status),u._isValidationEnabled=!0);else if(n.rightResizing){if(n.previousData.width!==i.width){l=i.width/u._perDayWidth;p=i.width%u._perDayWidth;s=0;p>0&&r.workingTimeScale!="TimeScale24Hours"&&(s=p>=u._perDayWidth/2?1:0);var w=i.left+i.width,g=w%u._perDayWidth,h=Math.round(g/(u._perDayWidth/24)),a=u._getDateFromFormat(i.startDate);if(r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&r.durationUnit==t.Gantt.DurationUnit.Hour?(v=i.left%u._perDayWidth/u._perHourWidth,b=Math.round(w/u._perHourWidth),b-=v,e=i._dateUpdate(a,0,b),a.setHours(v)):r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&r.dateFormat.indexOf("hh")!=-1?r.durationUnit==t.Gantt.DurationUnit.Hour&&(v=Math.round(i.left%u._perDayWidth/(u._perDayWidth/24)),c=Math.round(w/(u._perDayWidth/24)),c-=v,e=i._dateUpdate(a,0,c)):e=i._dateUpdate(a,l-1+s,0),r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day||r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&r.dateFormat.indexOf("hh")!=-1?e.setHours(Math.round(h)):r.dateFormat.indexOf("hh:")&&r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&e.setHours(Math.round(17)),r.holidays&&r.holidays.length)for(y=0,k=r.holidays.length,y=0;y<k;y++)d=new Date(this._holidaysList[y]),e===d&&e.setDate(e.getDate()-1);this.model.includeWeekend==!1&&(e.getDay()==0?e.setDate(e.getDate()-2):e.getDay()==6&&e.setDate(e.getDate()-1));this._stringHolidays&&this._stringHolidays.indexOf(i._getFormatedDate(e,r.dateFormat))!=-1&&(e.setDate(e.getDate()+1),e.getDay()==6&&e.setDate(e.getDate()+2));i.endDate=i._calculateFormatedDate(e,r.dateFormat);r.endDateMapping&&(i.item[r.endDateMapping]=i.endDate);i._calculateDuration(a,e,r.includeWeekend,r.holidays,i.isMilestone,r);i.width=i._calculateTaskbarWidth(u._perDayWidth,r);i.progressWidth=i._getProgressWidth(i.width,i.status);u._isValidationEnabled=!0}}else n.leftResizing?n.previousData.left!==i.left&&(o=i.left%u._perDayWidth,l=(i.left-o)/u._perDayWidth,s=0,o>0&&r.workingTimeScale!="TimeScale24Hours"&&(s=o>=u._perDayWidth/2?1:0),h=Math.round(o/(u._perDayWidth/24)),f.setDate(f.getDate()+l+s),r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day||r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&r.dateFormat.indexOf("hh")!=-1?r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(h>=17||r.durationUnit==t.Gantt.DurationUnit.Day)?f.setHours(8):f.setHours(h):r.dateFormat.indexOf("hh:")&&r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(h=Math.round(o/(u._perDayWidth/9)),f.setHours(8)),this._stringHolidays&&this._stringHolidays.indexOf(i._getFormatedDate(f,r.dateFormat))!=-1&&(f.setDate(f.getDate()+1),i.left+=u._perDayWidth),this.model.includeWeekend==!1&&(f.getDay()===0?(f.setDate(f.getDate()+1),i.left+=u._perDayWidth):f.getDay()===6&&(f.setDate(f.getDate()+2),i.left+=2*u._perDayWidth)),this._stringHolidays&&this._stringHolidays.indexOf(i._getFormatedDate(f,r.dateFormat))!=-1&&(f.setDate(f.getDate()+1),i.left+=u._perDayWidth),r.workingTimeScale!=t.Gantt.workingTimeScale.TimeScale24Hours&&r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&r.durationUnit!=t.Gantt.DurationUnit.Hour?o>=u._perDayWidth/2?(i.left=i.left+u._perDayWidth,r.roundOffDayworkingTime&&(i.left-=o)):(i.left=i.left,r.roundOffDayworkingTime&&(i.left-=o)):r.scheduleHeaderSettings.scheduleHeaderType!=t.Gantt.ScheduleHeaderType.Day&&r.dateFormat.indexOf("hh")==-1?o>=u._perDayWidth/2?(i.left=i.left+u._perDayWidth,r.roundOffDayworkingTime&&(i.left-=o)):(i.left=i.left,r.roundOffDayworkingTime&&(i.left-=o)):r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&(r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours||r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours||r.durationUnit==t.Gantt.DurationUnit.Hour)&&(c=i.left%u._perHourWidth,c>=u._perHourWidth/2?(i.left=i.left+u._perHourWidth,i.left-=c):i.left-=c),i.startDate=i._calculateFormatedDate(f,r.dateFormat),r.startDateMapping&&(i.item[r.startDateMapping]=i.startDate),i._calculateDuration(f,u._getDateFromFormat(i.endDate),r.includeWeekend,r.holidays,i.isMilestone,r),i.width=i._calculateTaskbarWidth(u._perDayWidth,r),i.progressWidth=i._getProgressWidth(i.width,i.status),u._isValidationEnabled=!0):n.progressResizing&&(i.status=i._getProgressPercent(i.width,i.progressWidth),i.parentItem&&i._updateParentProgress(i.parentItem,r.progressMapping),u._refreshParent(i));u._isValidationEnabled&&(u._updateEditedGanttRecord(i),i.predecessor&&(u._isMileStoneEdited=i.isMilestone,u._updatedConnectorLineCollection=[],u._connectorlineIds=[],u._editedTaskBarItem=i,u._validatePredecessor(i),u._updatedConnectorLineCollection.length>0&&u._$ganttchartHelper.ejGanttChart("appendConnectorLine",u._updatedConnectorLineCollection)),u._editedTaskBarItem=null,i.parentItem&&u._updateParentItem(i),u.refreshGanttRecord(i));u._trigger("taskbarEdited",n);!n.cancel&&(n.leftResizing||n.rightResizing||n.dragging)&&u._updateScheduleDatesOnEditing(n)},actionBegin:function(n){var t=this;t._trigger("actionBegin",n)||n.requestType==="beginedit"&&t._sendEditRequest()},_ganttActionCompleteTrigger:function(n){this._trigger("actionComplete",n);n.cancel||n.requestType!=="save"||(n._cModifiedData&&(n.data=n._cModifiedData),n._cAddedRecord&&(n.data=n._cAddedRecord),this._updateScheduleDatesOnEditing(n))},_queryCellInfo:function(n){this._trigger("queryCellInfo",n)},_beginEdit:function(t){var i=this,r;if(i._trigger("beginEdit",t),i._isinBeginEdit=!0,i.model.toolbarSettings.showToolbar){var u=[],f=n(n(".e-cancel")[0]).parent()[0],e=n(n(".e-saveitem")[0]).parent()[0];f&&u.push(f);e&&u.push(e);n(".e-gantttoolbar").ejToolbar("enableItem",u);r=[];i.model.editSettings.allowAdding&&i.model.toolbarSettings.toolbarItems.indexOf("add")!==-1&&r.push(n(n(".e-addnewitem")[0]).parent()[0]);i.model.editSettings.allowEditing&&i.model.toolbarSettings.toolbarItems.indexOf("edit")!==-1&&r.push(n(n(".e-edititem")[0]).parent()[0]);i.model.editSettings.allowDeleting&&i.model.toolbarSettings.toolbarItems.indexOf("delete")!==-1&&r.push(n(n(".e-deleteitem")[0]).parent()[0]);n(".e-gantttoolbar").ejToolbar("disableItem",r)}},_endEdit:function(t){var i=this,f=this.model,u,r;i._isinBeginEdit=!1;i._trigger("endEdit",t)?(u="",t.data[t.columnName]=t.previousValue,t.columnName==="predecessor"?(u=i._predecessorToString(t.data.predecessor,t.data),t.data.item[t.columnObject.mappingName]=u):t.data.item[t.columnObject.mappingName]=t.previousValue):t.isModified&&(i._currentViewData=i._$treegridHelper.ejTreeGrid("getCurrentViewData"),i._isValidationEnabled=!0,i._updateEditedGanttRecords(t));i.refreshGanttRecord(t.data);delete t.isModified;i.model.toolbarSettings.showToolbar&&(r=[],i.model.toolbarSettings.toolbarItems.indexOf("cancel")!==-1&&r.push(n(n(".e-cancel")[0]).parent()[0]),i.model.toolbarSettings.toolbarItems.indexOf("update")!==-1&&r.push(n(n(".e-saveitem")[0]).parent()[0]),n(".e-gantttoolbar").ejToolbar("disableItem",r));t.cancel||t.columnName!=="startDate"&&t.columnName!=="endDate"&&t.columnName!=="duration"||i._updateScheduleDatesOnEditing(t)},_updateScheduleDatesOnEditing:function(n){var t=this,i=this.model,u=t._getDateFromFormat(n.data.startDate),e=t._getDateFromFormat(n.data.endDate),f=t._projectStartDate,o=t._getDateFromFormat(i.scheduleEndDate),s,h,c=!1,a=i.scheduleStartDate,l,v=i.scheduleEndDate,r;t._calculateDatesForScheduleCheck(u);i.predecessorMapping?(r={},r.onEditing=!0,t._calculateScheduleDates(r),t._calculateDatesForScheduleCheck(r.minStartDate),(r.minStartDate.getTime()<f||r.maxEndDate.getTime()>o)&&t.updateScheduleDates(n.data._getFormatedDate(r.minStartDate,i.dateFormat),n.data._getFormatedDate(r.maxEndDate,i.dateFormat))):(u.getTime()>=f.getTime()&&u.getTime()<=o.getTime()||(u.getTime()<f.getTime()?(s=i.showTaskNames?t._getDateFromFormat(n.data.startDate):u,f=i.showTaskNames?t._getDateFromFormat(n.data.startDate):u):(h=t._getDateFromFormat(n.data.startDate),o=t._getDateFromFormat(n.data.startDate))),e.getTime()>=f.getTime()&&e.getTime()<=o.getTime()||(e.getTime()<f.getTime()?s=e:h=e),h&&(c=!0,v=n.data._getFormatedDate(h,i.dateFormat)),s&&(c=!0,a=n.data._getFormatedDate(s,i.dateFormat)),c&&(l=t._updateScheduleDatesByTaskLables(t._getDateFromFormat(a),t._getDateFromFormat(v)),t.updateScheduleDates(n.data._getFormatedDate(l.minStartDate,i.dateFormat),n.data._getFormatedDate(l.maxEndDate,i.dateFormat))))},_calculateDatesForScheduleCheck:function(n){var i=this;model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&n.setDate(n.getDate()-5);model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Year&&n.setDate(n.getDate()-20);model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Month&&n.setDate(n.getDate()-10);model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&n.setDate(n.getDate()-1)},_updateScheduleDatesByToolBar:function(n){var i=this,r=n==="prevTimeSpan"?i._projectStartDate:i._getDateFromFormat(i.model.scheduleStartDate);endDate=i._getDateFromFormat(i.model.scheduleEndDate);model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&(n==="prevTimeSpan"?r.setDate(r.getDate()-6):endDate.setDate(endDate.getDate()+7));model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Year&&(n==="prevTimeSpan"?r.setDate(r.getDate()-360):endDate.setDate(endDate.getDate()+365));model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Month&&(n==="prevTimeSpan"?r.setDate(r.getDate()):endDate.setDate(endDate.getDate()+30));model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&(n==="prevTimeSpan"?r.setDate(r.getDate()-1):endDate.setDate(endDate.getDate()+1));n==="prevTimeSpan"?i.updateScheduleDates(i._getFormatedDate(r,model.dateFormat),i._getFormatedDate(endDate,model.dateFormat)):n==="nextTimeSpan"&&i.updateScheduleDates(i._getFormatedDate(r,model.dateFormat),i._getFormatedDate(endDate,model.dateFormat))},_rowDataBound:function(n){this._trigger("rowDataBound",n)},_refreshToolBar:function(){var t=n("#"+this._id+"_toolbarItems");t.find("li").removeClass("e-hover")},_toolBarClick:function(t){var e=this,o=e.model,f=n(this.itemsContainer).closest(".e-gantt"),u=f.ejGantt("instance"),i=f.attr("id");if((u._clearContextMenu(),t.event==r&&t.target.tagName=="INPUT"&&t.currentTarget.id==i+"_search")||(u.model.dateFormat.indexOf("hh")!=-1?n.isFunction(n.fn.ejDateTimePicker)&&n("#"+i+"EditForm").find(".e-datepicker").ejDateTimePicker("hide"):n.isFunction(n.fn.ejDatePicker)&&n("#"+i+"EditForm").find(".e-datepicker").ejDatePicker("hide"),f.ejGantt("instance")._trigger("toolBarClick",t)))return!1;switch(t.currentTarget.id){case i+"_add":u._toolbarOperation(i+"_add");break;case i+"_edit":u._toolbarOperation(i+"_edit");break;case i+"_delete":u._toolbarOperation(i+"_delete");break;case i+"_update":u._toolbarOperation(i+"_update");break;case i+"_cancel":u._toolbarOperation(i+"_cancel");break;case i+"_search":u._toolbarOperation(i+"_search",n(t.currentTarget).find("input").val());break;case i+"_indent":u._toolbarOperation(i+"_indent");break;case i+"_outdent":u._toolbarOperation(i+"_outdent");break;case i+"_expandAll":u._toolbarOperation(i+"_expandAll");break;case i+"_collapseAll":u._toolbarOperation(i+"_collapseAll");break;case i+"_prevTimeSpan":u._toolbarOperation(i+"_prevTimeSpan");break;case i+"_nextTimeSpan":u._toolbarOperation(i+"_nextTimeSpan")}return!1},_toolbarOperation:function(t,i){var f=this.element,e=f.ejGantt("instance"),u=f.attr("id"),r=this,o=r.selectedRowIndex();switch(t){case u+"_add":r._sendAddRequest();break;case u+"_edit":r._sendEditRequest();break;case u+"_delete":r._$treegridHelper.ejTreeGrid("deleteRow");break;case u+"_update":r._$treegridHelper.ejTreeGrid("endEdit");r.model.toolbarSettings.toolbarItems.indexOf("cancel")!==-1&&r._disabledToolItems.push(n(n(".e-cancel")[0]).parent()[0]);r.model.toolbarSettings.toolbarItems.indexOf("update")!==-1&&r._disabledToolItems.push(n(n(".e-saveitem")[0]).parent()[0]);n(".e-gantttoolbar").ejToolbar("disableItem",r._disabledToolItems);r._disabledToolItems=[];break;case u+"_cancel":r._$treegridHelper.ejTreeGrid("cancelEditCell");break;case u+"_search":r._$treegridHelper.ejTreeGrid("search",i);r._searchString=i;r._updateToolbarOptions(i);break;case u+"_indent":r._sendIndentRequest();r._$treegrid.focus();break;case u+"_outdent":r._sendOutdentRequest();r._$treegrid.focus();break;case u+"_expandAll":r._expandAll();r._$treegrid.focus();break;case u+"_collapseAll":r._deSelectRowItem();r._collapseAll();r.model.toolbarSettings.showToolbar&&r.model.toolbarSettings.toolbarItems.indexOf("delete")!==-1&&(n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-deleteitem")[0]).parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("indent")!==-1&&n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-indent")[0]).parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("outdent")!==-1&&n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-outdent")[0]).parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("edit")!==-1&&n(".e-gantttoolbar").ejToolbar("disableItem",n(n(".e-edititem")[0]).parent()[0]));r._$treegrid.focus();break;case u+"_prevTimeSpan":r._updateScheduleDatesByToolBar("prevTimeSpan");break;case u+"_nextTimeSpan":r._updateScheduleDatesByToolBar("nextTimeSpan")}return r._refreshToolBar(),!1},_setModel:function(i){var r=this,u,f=r.model,e;for(u in i)switch(u){case"sortSettings":r._sendSortingRequest(i[u]);break;case"destroy":r.destroy();break;case"allowGanttChartEditing":r._ganttChartEditing(i[u]);break;case"enableProgressBarResizing":r._resizeProgressbar(i[u]);break;case"enableTaskbarTooltip":r._showTooltip(i[u]);break;case"enableTaskbarDragTooltip":r._showEditingTooltip(i[u]);break;case"enableAltRow":r._updateAltRow(i[u]);break;case"locale":f.ganttRecords=[];f.parentRecords=[];r._clearContextMenu();f.locale=i[u];r.element.ejGantt("destroy").ejGantt(f);break;case"allowSelection":r._updateRowSelection(i[u]);break;case"editSettings":n.extend(f.editSettings,i[u]);r._updateEditMode(i[u]);break;case"taskbarBackground":r._updateTaskbarBackground(i[u]);break;case"progressbarBackground":r._updateProgressbarBackground(i[u]);break;case"parentTaskbarBackground":r._updateParentTaskbarBackground(i[u]);break;case"parentProgressbarBackground":r._updateParentProgressbarBackground(i[u]);break;case"showTaskNames":r._updateRenderTaskNames(i[u]);break;case"showProgressStatus":r._updateRendeProgressStatus(i[u]);break;case"showResourceNames":r._updateRenderResourceNames(i[u]);break;case"progressbarHeight":r._updateProgressbarHeight(i[u]);break;case"baselineColor":r._updateBaselineColor(i[u]);break;case"renderBaseline":r._updateRenderBaseline(i[u]);break;case"allowColumnResize":r._updateAllowColumnResize(i[u]);break;case"allowKeyboardNavigation":r._updateAllowKeyboardNavigation(i[u]);break;case"selectedItem":r._updateSelectedItem(i[u]);break;case"dataSource":f.dataSource=[];f.ganttRecords=[];f.parentRecords=[];f.dataSource=i[u];r.element.ejGantt("destroy").ejGantt(f);break;case"showGridCellTooltip":r._updateShowGridCellTooltip(i[u]);break;case"showGridExpandCellTooltip":r._updateShowGridExpandCellTooltip(i[u]);break;case"highlightWeekends":r._updateHighlightWeekends(i[u]);break;case"connectorLineBackground":r._updateConnectorLineBackground(i[u]);break;case"connectorlineWidth":r._updateConnectorlineWidth(i[u]);break;case"weekendBackground":r._updateWeekendBackground(i[u]);break;case"enableContextMenu":r.model.enableContextMenu=i[u];break;case"enableResize":f.enableResize?(r.model.enableResize=i[u],r._on(n(window),"resize",r.windowResize)):r._off(n(window),"resize",r.windowResize);break;case"selectedRowIndex":this.selectedRowIndex()===-1||t.isNullOrUndefined(this.selectedRowIndex())?this.selectedRowIndex()===-1&&r._$treegridHelper.ejTreeGrid("clearSelection"):(e={},e.recordIndex=this.selectedRowIndex(),e.data=r.model.ganttRecords[e.recordIndex],e.target="ejTreeGrid",r.rowSelected(e),r._$treegridHelper.ejTreeGrid("selectRows",e.recordIndex),r._$ganttchartHelper.ejGanttChart("selectRows",e.recordIndex),r._$ganttchartHelper.ejGanttChart("updateSelectedItem",e.recordIndex))}},_updateWeekendBackground:function(n){var t=this;this.model.weekendBackground=n;t._$ganttchartHelper.ejGanttChart("updateWeekendBackground",n)},_updateConnectorlineWidth:function(n){var t=this;this.model.connectorlineWidth=n;t._$ganttchartHelper.ejGanttChart("updateConnectorlineWidth",n);t._$ganttchartHelper.ejGanttChart("clearConnectorLines");t._$ganttchartHelper.ejGanttChart("renderConnectorLines",t._connectorLinesCollection)},_updateConnectorLineBackground:function(n){var t=this;this.model.connectorLineBackground=n;t._$ganttchartHelper.ejGanttChart("updateConnectorLineBackground",n);t._$ganttchartHelper.ejGanttChart("clearConnectorLines");t._$ganttchartHelper.ejGanttChart("renderConnectorLines",t._connectorLinesCollection)},_updateHighlightWeekends:function(n){var t=this;this.model.highlightWeekends=n;t._$ganttchartHelper.ejGanttChart("updateHighlightWeekends",n)},_updateShowGridCellTooltip:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateShowGridCellTooltip",n)},_updateShowGridExpandCellTooltip:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateShowGridExpandCellTooltip",n)},_updateSelectedItem:function(n){var t=this,i={};n[t.model.taskIdMapping]!=null&&(i.recordIndex=t._ids.indexOf(n[t.model.taskIdMapping].toString()),i.item=t.model.ganttRecords[i.recordIndex],i.target="ejTreeGrid",t.rowSelected(i),t._$treegridHelper.ejTreeGrid("selectRows",i.recordIndex),t._$ganttchartHelper.ejGanttChart("selectRows",i.recordIndex),t._$ganttchartHelper.ejGanttChart("updateSelectedItem",i.recordIndex))},_updateAllowKeyboardNavigation:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateAllowKeyboardNavigation",n);t._$ganttchartHelper.ejGanttChart("updateAllowKeyboardNavigation",height)},_updateAllowColumnResize:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateAllowColumnResize",n)},_updateProgressbarHeight:function(n){var t=this;this.model.progressbarHeight=n;t._$ganttchartHelper.ejGanttChart("updateProgressbarHeight",n)},_updateBaselineColor:function(n){var t=this;this.model.baselineColor=n;t._$ganttchartHelper.ejGanttChart("updateBaselineColor",n)},_updateRenderBaseline:function(n){var t=this;this.model.renderBaseline=n;t._$ganttchartHelper.ejGanttChart("updateRenderBaseline",n);t._$ganttchartHelper.ejGanttChart("renderConnectorLines",t._connectorLinesCollection)},_updateRenderTaskNames:function(n){var t=this;this.model.showTaskNames=n;t._$ganttchartHelper.ejGanttChart("updateRenderTaskNames",n)},_updateRendeProgressStatus:function(n){var t=this;this.model.showProgressStatus=n;t._$ganttchartHelper.ejGanttChart("updateRendeProgressStatus",n)},_updateRenderResourceNames:function(n){var t=this;this.model.showResourceNames=n;t._$ganttchartHelper.ejGanttChart("updateRenderResourceNames",n)},_updateTaskbarBackground:function(n){var t=this;this.model.taskbarBackground=n;t._$ganttchartHelper.ejGanttChart("updateTaskbarBackground",n)},_updateProgressbarBackground:function(n){var t=this;this.model.progressbarBackground=n;t._$ganttchartHelper.ejGanttChart("updateProgressbarBackground",n)},_updateParentTaskbarBackground:function(n){var t=this;this.model.parentTaskbarBackground=n;t._$ganttchartHelper.ejGanttChart("updateParentTaskbarBackground",n)},_updateParentProgressbarBackground:function(n){var t=this;this.model.parentProgressbarBackground=n;t._$ganttchartHelper.ejGanttChart("updateParentProgressbarBackground",n)},_updateEditMode:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateEditMode",n)},_updateRowSelection:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateRowSelection",n)},_updateAltRow:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateAltRow",n)},openAddDialog:function(){this._sendAddRequest()},openEditDialog:function(){this._sendEditRequest()},searchItem:function(n){var t=this;t._$treegridHelper.ejTreeGrid("search",n)},deleteItem:function(){var n=this;n._$treegridHelper.ejTreeGrid("deleteRow")},expandAllItems:function(){this._expandAll()},collapseAllItems:function(){this._collapseAll()},indentItem:function(){this._sendIndentRequest()},outdentItem:function(){this._sendOutdentRequest()},cancelEdit:function(){this.sendCancelRequest()},expandCollapseRecord:function(n){var i=this,t={},r=i.model.ganttRecords[i._ids.indexOf(n)],u=r.expanded==!0?!1:!0;t.data=r;t.recordIndex=i._ids.indexOf(n);t.expanded=u;t.requestType="expandCollapse";i._$treegridHelper.ejTreeGrid("sendExpandCollapseRequest",t)},saveEdit:function(){var n=this;n._$treegridHelper.ejTreeGrid("endEdit")},_showTooltip:function(n){var t=this;this.model.enableTaskbarTooltip=n;t._$ganttchartHelper.ejGanttChart("showTooltip",n)},_showEditingTooltip:function(n){var t=this;this.model.enableTaskbarDragTooltip=n;t._$ganttchartHelper.ejGanttChart("showEditingTooltip",n)},_ganttChartEditing:function(n){var t=this;t.model.allowGanttChartEditing=n;t._$ganttchartHelper.ejGanttChart("ganttChartEditing",n)},_resizeProgressbar:function(n){var t=this;t.model.enableProgressBarResizing=n;t._$ganttchartHelper.ejGanttChart("resizeProgressbar",n)},_sendSortingRequest:function(n){var r=this,t,i;t=n.sortedColumns[0].field;i=n.sortedColumns[0].direction;r._$treegridHelper.ejTreeGrid("sortColumn",t,i)},sendCancelRequest:function(){var t=this;t._$treegridHelper.ejTreeGrid("cancelEditCell");t.model.toolbarSettings.toolbarItems.indexOf("cancel")!==-1&&t._disabledToolItems.push(n(n(".e-cancel")[0]).parent()[0]);t.model.toolbarSettings.toolbarItems.indexOf("save")!==-1&&t._disabledToolItems.push(n(n(".e-saveitem")[0]).parent()[0]);n(".e-gantttoolbar").ejToolbar("disableItem",t._disabledToolItems);t._disabledToolItems=[]},_sendAddRequest:function(){var t=this,r=t._columns,f=r.length,n=0,u={},i={};for(t._isinAddnewRecord=!0,n;n<f;n++)u[r[n].mappingName]="";i.data=u;i.requestType="add";t.renderedEditDialog(i)},_sendEditRequest:function(i){var r=this,e=r.model,u,f;t.isNullOrUndefined(i)?(r._currentTrIndex=this.selectedRowIndex(),r._$currentTr=n(r._$treegridHelper.ejTreeGrid("getRows")).eq(this.selectedRowIndex())):(r._currentTrIndex=i.index(),r._$currentTr=i);f=r.getUpdatedRecords()[this.selectedRowIndex()];u={rowElement:r._$currentTr,data:f};r._trigger("beginEdit",u);u.requestType="beginedit";u.data&&r.renderedEditDialog(u)},_updateAddData:function(n){var r=this,i=this.model,u,e,f;n[i.taskIdMapping]||(u=r._updatedGanttRecords.length,u=r._getNewTaskId(u),e=r._ids.indexOf(u.toString()),r._ids.splice(e,1),n[i.taskIdMapping]=u);i.taskNameMapping&&!n[i.taskNameMapping]&&(n[i.taskNameMapping]="New Task"+n[i.taskIdMapping]);n[i.startDateMapping]||(n[i.startDateMapping]=i.scheduleStartDate);i.durationMapping&&t.isNullOrUndefined(n[i.durationMapping])&&(n[i.endDateMapping]||(n[i.durationMapping]="5"));i.progressMapping&&(n[i.progressMapping]=n[i.progressMapping]>100?100:n[i.progressMapping]);!n[i.endDateMapping]&&i.endDateMapping&&(n[i.durationMapping]||(f=r._getDateFromFormat(i.scheduleStartDate),f.setDate(f.getDate()+4),n[i.endDateMapping]=Globalize.format(f,this.model.dateFormat)))},_sendSaveRequest:function(i){var f={},ht=document,r=this,u=r.model,c=0,s,tt,k,y,p,h,l,d,it,rt,ut,e,ot,o,a,v,st,w,b,at,vt;if(args={},i==="Add"?(s=ht.getElementById(r._id+"AddForm"),tt=s&&s.length,d="Add",it="#treegrid"+r._id+"predecessorAdd",p=n("#"+r._id+"taskId"+d),h=t.TreeGrid.getColumnByField(r._columns,"taskId"),r._cellEditType=h.editType,h&&p.length>0&&(l=r.getCurrentEditCellData(p,h.dropdownData)),r._ids.indexOf(l)!=-1&&l?this._duplicate=!0:l&&(this._duplicate=!1)):(s=ht.getElementById(r._id+"EditForm"),tt=s&&s.length,it="#treegrid"+r._id+"predecessoredit",d=""),k=n(s).closest("div"),!this.editFormValidate())return!0;if(this._duplicate)alert("Duplicate ID");else{for(c=0;c<tt;c++)y=s[c].name,p=n(s[c]),y&&(f[y]||(h=t.TreeGrid.getColumnByField(r._columns,y)),h&&s[c].id===r._id+y+d&&(r._cellEditType=h.editType,l=r.getCurrentEditCellData(p,h.dropdownData),r._isinAddnewRecord===!1&&h.mappingName===r.model.predecessorMapping&&(args.previousValue=r._updatePredecessorValue(f,l)),s[c].type!="checkbox"&&(f[h.mappingName]=l)));if(date1=r._getDateFromFormat(f[u.startDateMapping]),date2=r._getDateFromFormat(f[u.endDateMapping]),rt=0,date1&&date2&&(rt=date2.getTime()-date1.getTime()),this._wrongenddate=rt<0?!0:!1,this._wrongenddate)alert("Invalid End date");else{f[u.resourceIdMapping]&&k.hasClass("e-addedrow")&&(ut=[],n.each(f[u.resourceIdMapping],function(n,t){ut.push(t[u.resourceIdMapping])}),f[u.resourceIdMapping]=ut);f[u.taskIdMapping]||i!=="Edit"||(f[u.taskIdMapping]=r._editedDialogRecord.taskId);i==="Add"&&r._updateAddData(f);args.data=f;var ct=!1,ft=[],et=!1;if(u.predecessorMapping&&(i==="Edit"?(et=u.editDialogFields.length===0?!0:!1,ft=n.grep(u.editDialogFields,function(n){return n.field===u.predecessorMapping})):i==="Add"&&(et=u.addDialogFields.length===0?!0:!1,ft=n.grep(u.addDialogFields,function(n){return n.field===u.predecessorMapping}))),ft.length>0||et){if(e=[],ot=!0,e=n(it).ejTreeGrid("option","dataSource"),n.each(e,function(n,t){t.id.length>0&&t.name.length&&t.type.length||(ot=!1)}),ot){var yt=[],g=[],nt=[{id:"SS",text:"Start-Start",value:"Start-Start"},{id:"SF",text:"Start-Finish",value:"Start-Finish"},{id:"FS",text:"Finish-Start",value:"Finish-Start"},{id:"FF",text:"Finish-Finish",value:"Finish-Finish"}],lt;for(o=0;o<e.length;o++){for(a={},a.from=f.taskID,a.to=e[o].id,a.isdrawn=!1,a.offset=isNaN(parseInt(e[o].offset))?0:parseInt(e[o].offset),v=0;v<nt.length;v++)if(e[o].type==nt[v].text){a.predecessorType=nt[v].id;lt=nt[v].id;break}st=e[o].id+lt;e[o].offset=isNaN(parseInt(e[o].offset))?0:parseInt(e[o].offset);e[o].offset!==0&&(st+=e[o].offset<0?e[o].offset.toString():"+"+e[o].offset.toString());g.push(st);yt.push(a)}args.predecessorString=g;ct=r._editedPredecessorValidation(args)}else return alert("Fill all the columns in predecessor table"),!0;if(ct)r._isinAddnewRecord===!1&&(args.previousValue=r._updatePredecessorValue(f,g.join(","))),f[u.predecessorMapping]=g.join(",");else return alert("Cyclic Dependency Occured, Please Check The Predecessor"),!0}if(args.requestType=t.TreeGrid.Actions.Save,args.recordIndex=this.selectedRowIndex()!==-1?this.selectedRowIndex():-1,r._trigger("actionBegin",args))return!0;if(k.hasClass("e-editedrow"))args._cModifiedData=r._updateRecord(f),r._editedDialogRecord&&(args._cModifiedData.startDate||(args._cModifiedData.startDate=r._editedDialogRecord.startDate),args._cModifiedData.endDate||(args._cModifiedData.endDate=r._editedDialogRecord.endDate),args._cModifiedData.duration||(args._cModifiedData.duration=r._editedDialogRecord.duration),r._editedDialogRecord=null),args.data[u.endDateMapping]&&!args.data[u.durationMapping]&&args._cModifiedData._calculateDuration(r._getDateFromFormat(args._cModifiedData.startDate),r._getDateFromFormat(args._cModifiedData.endDate),u.includeWeekend,u.holidays,args._cModifiedData.isMilestone,u);else if(k.hasClass("e-addedrow")&&(b=0,u.selectedItem&&(u.selectedItem.hasChildRecords?(b=u.selectedItem.level+1,w=u.selectedItem,at=0):!u.selectedItem.hasChildRecords&&u.selectedItem.parentItem?(b=u.selectedItem.level,w=u.selectedItem.parentItem,at=w.childRecords.indexOf(u.selectedItem)+1):(b=0,w=null)),args._cAddedRecord=r._createGanttRecord(f,b,w,!1),u.predecessorMapping&&args._cAddedRecord.predecessor&&args._cAddedRecord.parentItem&&(vt=r._idFromPredecessor(args._cAddedRecord.item[u.predecessorMapping]),vt.indexOf(args._cAddedRecord.parentItem.taskId.toString())!==-1)))return alert("Cyclic Dependency Occured, Please Check The Predecessor"),!0;return args._cAddedRecord&&(args._cAddedRecord.taskId=args._cAddedRecord.taskId,args._cAddedRecord.index=args.recordIndex),r.actionComplete(args),r._cModifiedData=null,r._cAddedRecord=null,r._primaryKeyValues=[],r._isinAddnewRecord=!1,!1}}},_recordReturnerByID:function(n){for(var r=this,i=r._rows,t=0;t<i.length;t++)if(i[t].taskId.toString()===n.toString())return i[t];return null},_editedPredecessorValidation:function(i){var e=this,w=e._rows,s=i.data[this.model.taskIdMapping],c=i.predecessorString.join(","),r,u,o,h,v,f,y;if(c.length>0)for(r=e._idFromPredecessor(c),u=0;u<r.length;u++){if(o=e._recordReturnerByID(s),o&&o.parentItem&&r.indexOf(o.parentItem.taskId.toString())!==-1)return!1;var p=r.slice(0),l=[],a=!0;if(n.each(p,function(n,t){l.indexOf(t)===-1?l.push(t):a=!1}),a===!1)return!1;for(currentId=r[u],h=[],v=r.slice(0),v.splice(u,1);currentId!==null;)if(f=[],h.indexOf(currentId)===-1){if(currentRecord=e._recordReturnerByID(currentId),!t.isNullOrUndefined(currentRecord.predecessor)&&currentRecord.predecessor.length>0&&n.each(currentRecord.predecessor,function(n,t){currentRecord.taskId.toString()!==t.from&&f.push(t.from.toString())}),s.toString()===currentRecord.taskId.toString()||f.indexOf(s.toString())!==-1)return!1;if(h.push(currentId),!t.isNullOrUndefined(currentRecord.predecessor)&&currentRecord.predecessor.length>0){if(f.length>1?y=this._predecessorValidation(f,i):currentId=currentRecord.predecessor[0].from,y===!1)return!1}else break}else break}return!0},_predecessorValidation:function(i,r){for(var f,s,e,h=this,o=r.data[this.model.taskIdMapping],u=0;u<i.length;u++)for(currentId=i[u],f=[],s=i.slice(0),s.splice(u,1);currentId!==null;)if(e=[],f.indexOf(currentId)===-1){if(currentRecord=h._recordReturnerByID(currentId),!t.isNullOrUndefined(currentRecord.predecessor)&&currentRecord.predecessor.length>0&&n.each(currentRecord.predecessor,function(n,t){currentRecord.taskId.toString()!==t.from&&e.push(t.from.toString())}),o.toString()===currentRecord.taskId.toString()||e.indexOf(o.toString())!==-1)return!1;if(f.push(currentId),!t.isNullOrUndefined(currentRecord.predecessor)&&currentRecord.predecessor.length>0)currentId=currentRecord.predecessor[0].from;else break}else break;return!0},_sendCancelRequest:function(){var i=this,u=i.model,r={};u.dateFormat.indexOf("hh")!=-1?n("#"+i._id+"EditForm").find(".e-datepicker").ejDateTimePicker("destroy"):n("#"+i._id+"EditForm").find(".e-datepicker").ejDatePicker("destroy");r.requestType=t.TreeGrid.Actions.Cancel;i.processBindings(r);i._primaryKeyValues=[];i.model.currentData=null},_updatePredecessorValue:function(n,t){var i=this,r,f,c=0,o,s=[],e=0,u,h;for(r=i.selectedItem().predecessor,t.length>0&&(f=i.selectedItem()._calculatePredecessor(t)),f&&(c=f.length),u=0,h=0,r&&(h=r.length),u=0;u<h;u++)o=r[u],o.from===i.selectedItem().taskId.toString()&&s.push(o);for(e=0;e<c;e++)s.push(f[e]);return i.selectedItem().predecessor=s,i.model.predecessorMapping&&(i.selectedItem().item[i.model.predecessorMapping]=t),r},getCurrentEditCellData:function(i,r){var f=this,e=f.model,o,u;if(n("#"+f._id+"EditForm").length||n("#"+f._id+"AddForm").length){u="";switch(f._cellEditType){case t.TreeGrid.EditingType.String:u=i.val();break;case t.TreeGrid.EditingType.Numeric:u=i.ejNumericTextbox("getValue");i.ejNumericTextbox("getValue");break;case t.TreeGrid.EditingType.Dropdown:u=f._getSelectedItem(i.ejDropDownList("model.selectedItems"),r);break;case t.TreeGrid.EditingType.Boolean:u=i.is(":checked");break;case t.TreeGrid.EditingType.DatePicker:o=e.dateFormat.indexOf("hh")!=-1?i.ejDateTimePicker("model.value"):i.ejDatePicker("model.value");u=Globalize.format(o,e.dateFormat);break;case t.TreeGrid.EditingType.DateTimePicker:u=i.ejDateTimePicker("model.value")}return u}return null},_getSelectedItem:function(t,i){var r=0,f=t.length,u=[];if(i)for(r=0;r<f;r++)n.each(i,function(n,i){t[r]===n&&u.push(i)});return u},_updateRecord:function(t){var f=this,e=this.model,r=f._columns,c,i=0,o=f.getUpdatedRecords()[this.selectedRowIndex()],s,u,h;if(e.editDialogFields.length>0){for(s=[],u=0;u<e.editDialogFields.length;u++)h=n.grep(f._columns,function(n){return n.mappingName===e.editDialogFields[u].field}),h.length&&s.push(h[0]);r=s}for(c=r.length,i=0;i<c;i++)r[i].field.toString()!=="predecessor"&&(o[r[i].field]=t[r[i].mappingName],o.item[r[i].mappingName]=t[r[i].mappingName]);return o},_sendIndentRequest:function(){var r=this,u=r.model,n=r.getCurrentData(),f={},c={},v=r._$treegridHelper.ejTreeGrid("instance"),y=v.model.flatRecords,i,l,s,o,p,e,w,h,a,b;t.isNullOrUndefined(n)?alert("There is no gantt Record was not selected to perform the Indent "):(r._updatedGanttRecords=r.getUpdatedRecords(),i=r._updatedGanttRecords[this.selectedRowIndex()-1],f.data=n,f.requestType="beginedit",r._trigger("actionBegin",f)||(n.parentItem?(l=n.parentItem.childRecords.indexOf(n),n.parentItem.childRecords.splice(l,1),u.parentTaskIdMapping||n.parentItem.item[u.childMapping].splice(l,1)):this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json&&(s=this.dataSource().dataSource.json.indexOf(n.item),u.parentTaskIdMapping||this.dataSource().dataSource.json.splice(s,1)):(s=this.dataSource().indexOf(n.item),u.parentTaskIdMapping||this.dataSource().splice(s,1)),n.level===i.level?i.childRecords?i.expanded||(i.childRecords.splice(i.childRecords.length,0,n),n.parentItem=i,u.parentTaskIdMapping?n.item[u.parentTaskIdMapping]=i.taskId:i.item[u.childMapping].splice(i.childRecords.length,0,n.item)):(i.childRecords=[],i.childRecords.push(n),n.parentItem=i,i.item[u.childMapping]=[],u.parentTaskIdMapping?n.item[u.parentTaskIdMapping]=i.taskId:i.item[u.childMapping].push(n.item)):i.level-n.level==1?(i.parentItem.childRecords.splice(i.parentItem.childRecords.length,0,n),u.parentTaskIdMapping?n.item[u.parentTaskIdMapping]=i.parentItem.taskId:i.parentItem.item[u.childMapping].splice(i.parentItem.childRecords.length,0,n.item),n.parentItem=i.parentItem):i.level-n.level>1&&(o=r.getParentItem(i,n.level),o.childRecords.splice(o.childRecords.length,0,n),u.parentTaskIdMapping?n.item[u.parentTaskIdMapping]=o.taskId:o.item[u.childMapping].splice(o.childRecords.length,0,n.item),n.parentItem=o)),n.parentItem.isMilestone&&(n.parentItem.isMilestone=!1),i.hasChildRecords=i.childRecords?i.childRecords.length>0:!1,n.level+=1,r.updateLevel(n,1),r.refreshGanttRecord(n),r.updateIndentOutdentOption(n),i.level===0&&u.parentRecords.indexOf(i)===-1&&u.parentRecords.push(i),n.level>0&&u.parentRecords.indexOf(n)!==-1&&(p=u.parentRecords.indexOf(n),u.parentRecords.splice(p,1),v.model.parentRecords=u.parentRecords),n.parentItem&&r._updateParentItem(n),i.predecessor&&i.predecessor.length>0&&r.model.predecessorMapping&&i.hasChildRecords&&r._updatePredecessorOnIndentOutdent(i),r.refreshGanttRecord(i),r.getExpandStatus(n)||(e=r._$treegridHelper.ejTreeGrid("getChildCount",n,0),u.enableVirtualization?(w=y.indexOf(n),e>0&&!n.expanded&&(e=0),y.splice(w,e+1)):(e>0&&!n.expanded&&(e=0),r._totalCollapseRecordCount+=e+1,r._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",-(e+1))),h={},h.expanded=!0,h.data=n.parentItem,r.expanding(h)),r.model.predecessorMapping&&(r._isValidationEnabled=!1,r._connectorlineIds=[],r._connectorLinesCollection=[],r._$ganttchartHelper.ejGanttChart("clearConnectorLines"),r._createConnectorLinesCollection()),a=r._updatedGanttRecords.indexOf(n),b=r.getGanttChartRows(),f={rowElement:b.eq(a),data:r.model.selectedItem,recordIndex:a},r._$ganttchartHelper.ejGanttChart("selectRows",f.recordIndex),r._$treegridHelper.ejTreeGrid("selectRows",f.recordIndex),this.selectedItem(f.data),this.selectedRowIndex(f.recordIndex),c.data=n,c.requestType="endedit",this._trigger("actionComplete",c))},_updatePredecessorOnIndentOutdent:function(n){for(var s,r=this,h=n.predecessor.length,u=n.predecessor,f,t,e,o=[],i=0;i<h;i++)u[i].to===n.taskId.toString()?(t=r._rows[r._ids.indexOf(u[i].from)],f=t.predecessor.indexOf(u[i]),t.predecessor.splice(f,1),e="parent"+t.taskId+"child"+n.taskId,r._$ganttchartHelper.ejGanttChart("removeConnectorline",e)):u[i].from===n.taskId.toString()&&(t=r._rows[r._ids.indexOf(u[i].to)],n.childRecords.indexOf(t)!==-1?(f=t.predecessor.indexOf(u[i]),t.predecessor.splice(f,1),s=r._predecessorToString(t.predecessor,t),t.item[model.predecessorMapping]=s,e="parent"+n.taskId+"child"+t.taskId,r._$ganttchartHelper.ejGanttChart("removeConnectorline",e),r.refreshGanttRecord(t)):o.push(u[i]));n.predecessor=o;n.item[model.predecessorMapping]=""},_removePredecessor:function(n,t){var u=this,o=n.length,r=0,e=u.model,i,f;for(r;r<o;r++)n[r].from!==t.taskId.toString()?i=u._rows[u._ids.indexOf(n[r].from)]:n[r].to!==t.taskId.toString()&&(i=u._rows[u._ids.indexOf(n[r].to)]),i&&(f=i.predecessor.indexOf(n[r]),f!==-1&&i.predecessor.splice(f,1),i.item[e.predecessorMapping]&&(i.item[e.predecessorMapping]=u._predecessorToString(i.predecessor,i),u.refreshGanttRecord(i)))},_predecessorToString:function(n,t){var e=this,u=[],i=0,f=n.length,r;for(i;i<f;i++)t.taskId.toString()!==n[i].from&&(r=n[i].from+n[i].predecessorsType,n[i].offset=isNaN(n[i].offset)?0:n[i].offset,n[i].offset!==0&&(n[i].offset<0?r+=n[i].offset.toString():n[i].offset>0&&(r+="+"+n[i].offset.toString())),u.push(r));return u.join(",")},getParentItem:function(n,t){var i=this;return n.parentItem.level===t?n.parentItem:i.getParentItem(n.parentItem,t)},getSubChangeIndex:function(n,t,i){for(var u=this,f,r=0;r<u._updatedGanttRecords.length;r++)if(u._updatedGanttRecords[r].level==n&&u._updatedGanttRecords[r].index>t){i.parentItem&&u._updatedGanttRecords[r].parentItem.taskId==i.parentItem.taskId&&(f=u._updatedGanttRecords[r].index);break}return f},_nextSameLevelItem:function(n,t){var e=this,r=n.parentItem.level,f=t.indexOf(n),u;for(i=f;i<t.length;i++)if(r===t[i].level||r>t[i].level){u=t[i];break}return u},_sendOutdentRequest:function(){var n=this,u=n.model,r=n.getCurrentData(),e={},d={},et,v,h,o,g,nt,tt,c,it,y,l,p,rt,st,a,w,f,b=!1,k=!0,s=n._$treegridHelper.ejTreeGrid("instance"),ut,ft,ot;if(t.isNullOrUndefined(r))alert("There is no gantt Record was not selected to perform the Outdent ");else if(e.data=r,e.requestType="actionBegin",!n._trigger("actionBegin",e)){if(r.level===0)return;if(n._updatedGanttRecords=n.getUpdatedRecords(),et=n._nextSameLevelItem(r,n._updatedGanttRecords),v=n._nextSameLevelItem(r,n._rows),g=n._updatedGanttRecords.indexOf(r),nt=n._rows.indexOf(r),f=s.model.flatRecords,f!==n._updatedGanttRecords&&(rt=f.indexOf(r),st=n._nextSameLevelItem(r,f),b=!0),tt=r.parentItem.childRecords.indexOf(r),c=r.parentItem.parentItem,it=c&&r.parentItem.parentItem.childRecords.indexOf(v),r.parentItem.childRecords.splice(tt,1),u.parentTaskIdMapping||r.parentItem.item[u.childMapping].splice(tt,1),r.parentItem.childRecords.length==0?(r.parentItem.childRecords=null,r.parentItem.expanded=!1,r.parentItem.hasChildRecords=!1):n._updateParentItem(r.parentItem.childRecords[0]),c?(c.childRecords.splice(it,0,r),u.parentTaskIdMapping||c.item[u.childMapping].splice(it,0,r.item),r.parentItem=c):(this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json&&(u.parentTaskIdMapping||this.dataSource().dataSource.json.push(r.item)):u.parentTaskIdMapping||this.dataSource().push(r.item),r.parentItem=null),(s.model.sortSettings.sortedColumns.length>0||s.model.allowSearching&&s._searchString.length>0)&&(k=!1),y=n._$treegridHelper.ejTreeGrid("getChildCount",r,0),l=n._rows.splice(nt,y+1),splicedIds=n._ids.splice(nt,y+1),k&&(p=u.enableVirtualization&&r.expanded||!u.enableVirtualization?n._updatedGanttRecords.splice(g,y+1):n._updatedGanttRecords.splice(g,1)),b&&(w=u.enableVirtualization&&r.expanded||!u.enableVirtualization?f.splice(rt,y+1):f.splice(rt,1)),v?(h=n._updatedGanttRecords.indexOf(et),o=n._rows.indexOf(v),a=f.indexOf(v)):(h=n._updatedGanttRecords.length,o=n._rows.length,a=f.length),r.hasChildRecords&&r.childRecords.length>0){for(i=0;i<l.length;i++)n._rows.splice(o,0,l[i]),n._ids.splice(o,0,splicedIds[i]),l[i].level-=1,o++;if(k)if(u.enableVirtualization&&r.expanded||!u.enableVirtualization)for(i=0;i<p.length;i++)n._updatedGanttRecords.splice(h,0,p[i]),h++;else n._updatedGanttRecords.splice(h,0,r);if(b)if(u.enableVirtualization&&r.expanded||!u.enableVirtualization)for(i=0;i<w.length;i++)f.splice(a,0,w[i]),a++;else f.splice(a,0,r)}else n._rows.splice(o,0,l[0]),n._ids.splice(o,0,splicedIds[0]),l[0].level-=1,k&&n._updatedGanttRecords.splice(h,0,p[0]),b&&f.splice(a,0,w[0]);r.parentItem&&(r.parentItem.isMilestone&&(r.parentItem.isMilestone=!1),r.parentItem.hasChildRecords&&n._updateParentItem(r.parentItem.childRecords[0]));r.hasChildRecords&&(n._updateParentItem(r.childRecords[0]),r._updateParentProgress(r,u.progressMapping));r.level===0&&u.parentRecords.indexOf(r)===-1&&(u.parentRecords.push(r),s.model.parentRecords=u.parentRecords);r.predecessor&&r.predecessor.length>0&&n.model.predecessorMapping&&r.hasChildRecords&&n._updatePredecessorOnIndentOutdent(r);s.model.records=n._rows;s.model.ids=n._ids;e.requestType="outdent";n._$treegridHelper.ejTreeGrid("processBindings",e);ut={};ut.requestType=t.TreeGrid.Actions.Refresh;n._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",ut);n._updatedGanttRecords=n.getUpdatedRecords();n._currentViewData=n.getCurrentViewData();n.model.predecessorMapping&&(n._isValidationEnabled=!1,n._connectorlineIds=[],n._connectorLinesCollection=[],n._$ganttchartHelper.ejGanttChart("clearConnectorLines"),n._createConnectorLinesCollection());n._$ganttchartHelper.ejGanttChart("refreshHelper",n._currentViewData,n._updatedGanttRecords,n._totalCollapseRecordCount);n._$treegridHelper.ejTreeGrid("refreshHeight");n.updateAltRow(n._updatedGanttRecords,0,1);ft=n._updatedGanttRecords.indexOf(r);ot=n.getGanttChartRows();e={rowElement:ot.eq(ft),data:n.model.selectedItem,recordIndex:ft};n._$ganttchartHelper.ejGanttChart("selectRows",e.recordIndex);n._$treegridHelper.ejTreeGrid("selectRows",e.recordIndex);this.selectedItem(e.data);this.selectedRowIndex(e.recordIndex);n.updateIndentOutdentOption(r);d.data=r;d.requestType="actionComplete";this._trigger("actionComplete",d)}},_refreshChildLevel:function(n){for(var r=this,t=0,u=n.childRecords,f=u.length,i,t=0;t<f;t++)i=u[t],r.refreshGanttRecord(i),i.hasChildRecords&&r._refreshChildLevel(i)},_updateChildLevel:function(n){for(var u=this,i=0,r=n.childRecords,f=r.length,t,i=0;i<f;i++)t=r[i],t.level=t.level-1,t.hasChildRecords&&u._updateChildLevel(t)},_removeChildRecords:function(n,t){if(n.parentItem){var o=this,i=o.model,u=0,r,f=0,e=0;for(parentChildRecords=n.parentItem.childRecords,parentChildRecordsLength=parentChildRecords&&parentChildRecords.length,u=t;u<parentChildRecordsLength;u++)r=parentChildRecords[u],r&&(n.childRecords?(e=n.childRecords.length,n.childRecords.splice(e,0,r),i.parentTaskIdMapping?r.item[i.parentTaskIdMapping]=n.taskId:n.item[i.childMapping].splice(e,0,r.item)):(n.childRecords=[],n.item[i.childMapping]=[],n.childRecords.push(r),i.parentTaskIdMapping?r.item[i.parentTaskIdMapping]=n.taskId:n.item[i.childMapping].push(r.item)),r.parentItem=n,f++);n.parentItem.childRecords&&(n.parentItem.childRecords.splice(t,f),i.parentTaskIdMapping||n.parentItem.item[i.childMapping].splice(t,f),n.parentItem.childRecords.length==0&&(n.parentItem.childRecords=null,n.parentItem.expanded=!1,n.parentItem.hasChildRecords=!1,o.refreshGanttRecord(n.parentItem)))}},updateChildGanttRecordLevel:function(n,t){for(var r=0,u=this,f=u.model,e=n.parentItem&&n.parentItem.parentItem&&n.parentItem.parentItem.childRecords,o=e&&e.length,i,r=t;r<o;r++)i=e[r],i.childRecords?(i.childRecords.splice(i.childRecords.length,0,i),i.item[f.childMapping].splice(i.childRecords.length,0,i.item)):(i.childRecords=[],i.item[f.childMapping]=[],i&&(i.childRecords.push(i),i.item[f.childMapping].push(i.item))),u.refreshGanttRecord(n.parentItem),n.parentItem=i,++addedChildGanttRecordCount;n.parentItem.childRecords.splice(t,addedChildGanttRecordCount);n.parentItem.childRecords.length==0&&(n.parentItem.childRecords=null,n.parentItem.expanded=!1,n.parentItem.hasChildRecords=!1);u.refreshGanttRecord(n.parentItem)},updateLevel:function(n,t){var f=this,r=0,u=n.childRecords,e=u&&u.length,i;for(r;r<e;r++)i=u[r],i.level+=t,f.refreshGanttRecord(i),i.childRecords&&f.updateLevel(i,t)},addNewGanttRecord:function(){var t=this,n={},i;i=this.model.ganttRecords[this.model.ganttRecords.length].item;n.requestType="save";n._cAddedRecord=jQuery.extend(!0,{},i);n.recordIndex=index+1;t.subContextMenuAction(n);t._clearContextMenu()},getExpandStatus:function(n){var t=n.parentItem;return t!=null?t.expanded===!1?!1:t.parentItem?t.parentItem.expanded===!1?!1:this.getExpandStatus(t.parentItem):!0:!0},subContextMenuAction:function(n){var r=this,i={},u=r.model,f,e;r._updatedGanttRecords=r.getUpdatedRecords();r._currentViewData=r.getCurrentViewData();r._gridRows=r.getRows();r._ganttChartRows=r.getGanttChartRows();n.requestType==="save"&&n._cAddedRecord&&(i.selectedItem=u.selectedItem,n._cAddedRecord.predecessor=null,r.model.predecessorMapping&&(n._cAddedRecord.item[u.predecessorMapping]=null),i.data=n._cAddedRecord.item,i.data.duration===0&&(i.data.duration=1),i.requestType=t.TreeGrid.Actions.Save,i.recordIndex=n.recordIndex,i._cAddedRecord=r._createGanttRecord(i.data,n._cAddedRecord.level,null),i._cAddedRecord.taskId=r._getNewTaskId(i._cAddedRecord.taskId),e=r._ids.indexOf(i._cAddedRecord.taskId.toString()),r._ids.splice(e,1),u.taskIdMapping&&(i._cAddedRecord.item[u.taskIdMapping]=i._cAddedRecord.taskId),i._cAddedRecord.taskName="New Task "+i._cAddedRecord.taskId,u.taskNameMapping&&(i._cAddedRecord.item[u.taskNameMapping]="New Task "+i._cAddedRecord.taskId),i._cAddedRecord.item[u.childMapping]=null,n._cAddedRecord.hasChildRecords&&n.position==="Below"?(i._cAddedRecord.parentItem=u.selectedItem,i._cAddedRecord.level=u.selectedItem.level+1,i._cAddedRecord.expanded=!1):n._cAddedRecord.hasChildRecords&&n.position==="Above"?n._cAddedRecord.parentItem?(i._cAddedRecord.parentItem=n._cAddedRecord.parentItem,i._cAddedRecord.level=n._cAddedRecord.parentItem.level+1,i._cAddedRecord.expanded=!1):(i._cAddedRecord.parentItem=null,i._cAddedRecord.expanded=!1):!n._cAddedRecord.hasChildRecords&&n._cAddedRecord.parentItem?(i._cAddedRecord.parentItem=n._cAddedRecord.parentItem,i._cAddedRecord.level=n._cAddedRecord.parentItem.level+1,i._cAddedRecord.expanded=!1):i._cAddedRecord.parentItem=null,i._cAddedRecord.hasChildRecords=!1,i._cAddedRecord.childRecords=null,i._cAddedRecord.index=n.recordIndex,i._cAddedRecord.isAltRow=(i._cAddedRecord.index+1)%2==0?!1:!0,i.actionRequestType=t.TreeGrid.Actions.ContextMenuAdd,i.position=n.position,u.enableVirtualization||(i._cAddedRecord.isExpanded=r.getExpandStatus(i._cAddedRecord),i._cAddedRecord.isExpanded||(r._totalCollapseRecordCount+=1)),r.actionComplete(i));f=r._updatedGanttRecords.indexOf(u.selectedItem);r._$treegridHelper.ejTreeGrid("selectRows",f);r._$ganttchartHelper.ejGanttChart("selectRows",f)},_getNewTaskId:function(n){var t=this;return t._ids.indexOf(n.toString())==-1?(t._ids.push(n.toString()),n):(n++,t._getNewTaskId(n))},_getNewTaskIdFordialogEdit:function(n){var t=this;return t._ids.indexOf(n.toString())==-1?n==0?1:n:(n++,t._getNewTaskIdFordialogEdit(n))},_updateNewTaskId:function(){var t=this,i=t.model;t._ids=[];n.each(t._rows,function(n,i){i&&i.taskId&&t._ids.push(i.taskId.toString())})},contextMenuAction:function(n){var t=this;n.requestType=="contextMenuAdd"&&t._sendAddRequest();n.requestType=="contextMenuIndent"&&t._sendIndentRequest();n.requestType=="contextMenuOutdent"&&t._sendOutdentRequest();n.requestType=="contextMenuDelete"&&t._$treegridHelper.ejTreeGrid("deleteRow");n.requestType=="contextMenuTaskDetails"&&t._sendEditRequest()},_renderContextMenu:function(i,r,u){var f=this,e={},o={},s,c,h,l,v,a,y;i||(i=window.event);i.pageX||i.pageY?(c=s=i.pageX,h=i.pageY):(i.clientX||i.clientY)&&(c=s=i.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,h=i.clientY+document.body.scrollTop+document.documentElement.scrollTop);n(window).width()<s+150?(s=s-150,c=s-122):c=c+152;n(window).height()<h+25*f._contextMenuItems.length&&(h=h-25*f._contextMenuItems.length);o.requestType="ContextMenuOpen";o.contextMenuItems=f._contextMenuItems;o.innerContextMenuItems=f._subContextMenuItems;f._trigger("contextMenuOpen",o);l=t.buildTag("div.e-contextmenu","",{height:"auto",width:"150px",position:"absolute",left:s+"px",top:h+"px","background-color":"#F0F0F0",border:"1px solid #99bce8","z-index":"10"},{});v=t.buildTag("ul",n.render[f._id+"contextMenuTemplate"](o.contextMenuItems),{height:"auto",width:"auto",top:"0px",display:"inline"},{"data-icon":!1,type:"none","data-role":"list-divider"});a=t.buildTag("div.e-innerContextmenu","",{height:"auto",width:"120px",position:"absolute",left:c+"px",top:h+30+"px","background-color":"#F0F0F0",border:"1px solid #99bce8","z-index":"10",visibility:"hidden"},{});y=t.buildTag("ul",n.render[f._id+"subContextMenuTemplate"](o.innerContextMenuItems),{height:"auto",width:"auto",top:"0px",display:"inline"},{"data-icon":!1,type:"none","data-role":"list-divider"});l.append(v);n(document.body).append(l);o.innerContextMenuItems.length>0&&(a.append(y),n(document.body).append(a));n(l).css({height:"auto"});f._on(l,"contextmenu",function(n){n.preventDefault()});n(".e-menuitem").click(function(){var t=n(this).attr("id");switch(t){case"Task":e.requestType="contextMenuTaskDetails";f.contextMenuAction(e);f._clearContextMenu();break;case"Indent":e.requestType="contextMenuIndent";f.contextMenuAction(e);f._clearContextMenu();break;case"Outdent":e.requestType="contextMenuOutdent";f.contextMenuAction(e);f._clearContextMenu();break;case"Delete":e.requestType="contextMenuDelete";f.contextMenuAction(e);f._clearContextMenu();break;case"Above":e.requestType="save";e._cAddedRecord=jQuery.extend(!0,{},u);e.recordIndex=r==0?0:r;e.position="Above";f.subContextMenuAction(e);f._clearContextMenu();break;case"Below":e.requestType="save";e._cAddedRecord=jQuery.extend(!0,{},u);e.recordIndex=r;e.position="Below";f.subContextMenuAction(e);f._clearContextMenu();break;case"Open":e.requestType="contextMenuAdd";f.contextMenuAction(e);f._clearContextMenu();break;case"Add":f._setInitialData();break;default:f._clearContextMenu()}});n(".e-menuitem").mouseenter(function(){n(this).addClass("e-contextmenu-mouseover");n(this).attr("id")=="Add"||n(this).attr("id")=="Above"||n(this).attr("id")=="Below"||n(this).attr("id")=="Open"?(n(".e-innerContextmenu").css({visibility:"visible"}),n("#Add").addClass("e-contextmenu-mouseover")):n(".e-innerContextmenu").css({visibility:"hidden"})});n(".e-menuitem").mouseleave(function(){n(this).removeClass("e-contextmenu-mouseover")});i.preventDefault()},_setInitialData:function(){var r={},n=this,t=n.model,f=[],u,i={};n._ids=[];i[t.startDateMapping]=t.scheduleStartDate?t.scheduleStartDate:null;i[t.durationMapping]=5;i[t.taskNameMapping]="New Task 1";i[t.taskIdMapping]="1";f.push(i);(n.dataSource()==null||n.dataSource().length==0)&&(u=n._createGanttRecord(f[0],0,null),u.index=0,r.requestType="save",r._cAddedRecord=jQuery.extend(!0,{},u),r.recordIndex=0,n.actionComplete(r),n._clearContextMenu())},sendExpandCollapseRequest:function(t){var i=this,r=t.data,u=i.model,f=i._currentViewData.indexOf(r),e=n(n(i._gridRows)[f]),o=0,s=r.expanded!==t.expanded;t.expanded?(r.expanded=t.expanded,i._expandedRecordsCount=0,i.expandGanttRecord(r,t.expanded,t),s&&(i._totalCollapseRecordCount-=i._expandedRecordsCount),u.enableAltRow&&i.updateAltRow(r,f,1)):(i._collapsedRecordCount=0,i.collapseGanttRecord(r,t.expanded),s&&(i._totalCollapseRecordCount+=i._collapsedRecordCount),r.expanded=t.expanded,e.find(".e-treegridexpand").removeClass("e-treegridexpand").addClass("e-treegridcollapse"),e.removeClass("e-treegridrowexpand").addClass("e-treegridrowcollapse"),u.enableAltRow&&i.updateAltRow(r,f,i._collapsedRecordCount+1));o=(i._updatedGanttRecords.length-i._totalCollapseRecordCount)*u.rowHeight;i._$ganttchart.ejGanttChart("updateHeight",o);t.expanded?i._trigger("expanded",t):i._trigger("collapsed",t)},expandGanttRecord:function(t,i,r){var u=this,h=".gridrowtaskId"+t.taskId.toString()+"level"+(t.level+1).toString(),c=n(h),f=0,v=c.length,l,e,o=n(h),s=u._currentViewData.indexOf(t),a=n(n(u._gridRows)[s]);for(t.hasChildRecords&&t.childRecords.length>0&&(a.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),a.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand")),u._expandedRecordsCount+=o.length/2,o.length===0&&u.model.allowSearching&&u._searchString.length>0&&r&&u._$treegridHelper.ejTreeGrid("sendExpandCollapseRequest",r),o.css({display:"table-row"}),u.updateConnectorLines(o,i),f;f<v/2;f++)l=c[f],s=n(u._gridRows).index(l),s!==-1&&(e=u._updatedGanttRecords[s],e.isExpanded=!0,e.expanded&&u.expandGanttRecord(e,i))},updateConnectorLines:function(t,i){for(var r=this,s=t.length/2,u=0,e,f,o,u=0;u<s;u++)e=t[u],f=n(r._gridRows).index(e),f!==-1&&(o=r._currentViewData[f],o.isExpanded=i);r._connectorlineIds=[];r._connectorLinesCollection=[];r._$ganttchartHelper.ejGanttChart("clearConnectorLines");r._createConnectorLinesCollection()},collapseGanttRecord:function(t,i){var r=this,s=".gridrowtaskId"+t.taskId.toString()+"level"+(t.level+1).toString(),h=n(s),u=0,l=h.length,c,f,e,o=n(s);for(r._collapsedRecordCount+=o.length/2,o.css({display:"none"}),r.updateConnectorLines(o,i),u;u<l/2;u++)c=h[u],f=n(r._gridRows).index(c),f!==-1&&(e=r.getUpdatedRecords()[f],e.expanded&&r.collapseGanttRecord(e,i))},updateAltRow:function(t,i,r){for(var s=this,u=0,h=s._currentViewData,c=h.length,f=t.isAltRow,e,o=n(s._gridRows),u=i+r;u<c;u++)n(o[u]).css("display")!=="none"&&(e=h[u],e.isAltRow=!f,f=e.isAltRow,f?n(o[u]).addClass("e-alt-row"):n(o[u]).removeClass("e-alt-row"))},renderedEditDialog:function(i){var u=this,f,r,e;switch(i.requestType){case t.TreeGrid.Actions.Add:f=document.createElement("div");n(f).addClass("e-addedrow");f.innerHTML=n.render[u._id+"_JSONDialogAddingTemplate"](i.data);n("#"+u._id+"_dialogAdd").html(n(f));r={};r.cssClass=this.model.cssClass;r.enableModal=!0;r.width="auto";r.enableResize=!1;r.contentSelector="#"+u._id;r.rtl=u.model.rtl;r.allowKeyboardNavigation=!1;e=u._editDialogTexts.addFormTitle;r.title=e;n("#"+u._id+"_dialogAdd").ejDialog(r);n("#"+u._id+"_dialogAdd").ejDialog("open");u._editedDialogRecord=null;break;case t.TreeGrid.Actions.BeginEdit:f=document.createElement("div");n(f).addClass("e-editedrow");f.innerHTML=n.render[u._id+"_JSONDialogEditingTemplate"](i.data);n("#"+u._id+"_dialogEdit").html(n(f));r={};r.cssClass=u.model.cssClass;r.rtl=model.rtl;r.width="auto";r.enableResize=!1;r.contentSelector="#"+u._id;r.enableModal=!0;r.allowKeyboardNavigation=!1;e=u._editDialogTexts.editFormTitle+" "+u.selectedItem().taskName;r.title=e;n("#"+u._id+"_dialogEdit").ejDialog(r);n("#"+u._id+"_dialogEdit").ejDialog("open");u._editedDialogRecord=jQuery.extend(!0,{},this.selectedItem())}u._refreshEditForm(i)},editFormValidate:function(){return n.isFunction(n.validator)?n("#"+this._id+"EditForm").validate().form():!0},addFormValidate:function(){return n.isFunction(n.validator)?n("#"+this._id+"AddForm").validate().form():!0},getCurrentData:function(){var t=this,n=t.getUpdatedRecords();return n&&n[this.selectedRowIndex()]},getCurrentViewData:function(){return this._$treegridHelper.ejTreeGrid("getCurrentViewData")},getUpdatedCurrentViewData:function(){return this._$treegridHelper.ejTreeGrid("getUpdatedCurrentViewData")},getRows:function(){return this._$treegridHelper.ejTreeGrid("getRows")},getGanttChartRows:function(){return this._$ganttchartHelper.ejGanttChart("getGanttChartRows")},getUpdatedRecords:function(){return this._$treegridHelper.ejTreeGrid("getUpdatedRecords")},_getToolBarHeight:function(){var t=0;return this.model.toolbarSettings.showToolbar&&(t=n(".e-gantttoolbar").height()),t},_initValidator:function(){var i=this;n("#"+this._id+"EditForm").validate({errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(r,u){var e=u.closest("td"),f=n(r).addClass("e-error"),o=t.buildTag("div.e-errortail e-toparrow");e.find(".e-error").remove();u.hasClass("e-numerictextbox")?f.insertAfter(u.closest(".e-numeric")):f.insertAfter(u);f.prepend(o);i.model.editSettings.editMode!="normal"&&f.offset({left:u.offset().left});f.fadeIn("slow")}})},setValidation:function(){this._initValidator();for(var n=0;n<this._columns.length;n++)t.isNullOrUndefined(this._columns[n].validationRules)||this.setValidationToField(this._columns[n].field,this._columns[n].validationRules)},setValidationToField:function(i,r){var f=n("#"+this._id+i).length>0?n("#"+this._id+i):n("#"+i),u;f.rules("add",r);u=n("#"+this._id+"EditForm").validate();t.isNullOrUndefined(r.required)||(u.settings.messages.Name={},u.settings.messages.Name.required=t.TreeGrid.getColumnByField(proxy._columns,i).headerText+" is required")},_createConnectorLinesCollection:function(n){var t=this,f=t._currentViewData.length,r,u,i,o=t._predecessorsCollection,s=o.length,c=s/2,h=t.model.enableVirtualization,e;if(model.enableVirtualization&&n==="Load")for(f=t._updatedGanttRecords.length,r=0;r<f;r++)i=t._updatedGanttRecords[r],u=i.predecessor,u&&(e=i,t._addPredecessorsCollection(i,u));else for(r=0;r<f;r++)(i=t._currentViewData[r],h!==!1||i.isExpanded!==!1)&&t._currentViewData.indexOf(i)!==-1&&(u=i.predecessor,u&&(e=i,t._addPredecessorsCollection(i,u)));t._connectorLinesCollection.length>0&&t._$ganttchartHelper&&t._$ganttchartHelper.ejGanttChart("renderConnectorLines",t._connectorLinesCollection)},_addPredecessorsCollection:function(t,i){var r=this,c,s,u,o,f,l=r.model,e={},h,a;if(i){for(c=i.length,s=0;s<c;s++)(u=i[s],o=r._rows[r._ids.indexOf(u.from)],f=r._rows[r._ids.indexOf(u.to)],!l.enableVirtualization&&(o&&o.isExpanded===!1||f&&f.isExpanded===!1))||r._isValidationEnabled&&!r._isInExpandCollapse&&f&&r._validateChildGanttRecord(o,f,u);if(!r._enableCreateCollection)return;for(h=0,n.each(i,function(n,i){return i.to===t.taskId.toString()&&h++,h}),s=0;s<c;s++)(u=i[s],h>1&&(u.isdrawn=!1),o=r._rows[r._ids.indexOf(u.from)],f=r._rows[r._ids.indexOf(u.to)],r._updatedGanttRecords.indexOf(o)!==-1&&r._updatedGanttRecords.indexOf(f)!=-1)&&(l.enableVirtualization||o.isExpanded!==!1&&f.isExpanded!==!1)&&o&&f&&(e=r._createConnectorLineObject(o,f,u),e&&(r._connectorlineIds.length>0&&r._connectorlineIds.indexOf(e.ConnectorLineId)==-1?(r._connectorLinesCollection.push(e),r._connectorlineIds.push(e.ConnectorLineId)):r._connectorlineIds.length==0?(r._connectorLinesCollection.push(e),r._connectorlineIds.push(e.ConnectorLineId)):r._connectorlineIds.indexOf(e.ConnectorLineId)!=-1&&(a=r._connectorlineIds.indexOf(e.ConnectorLineId),r._connectorLinesCollection[a]=e),u.isdrawn=!0))}},_createConnectorLineObject:function(n,t,i){var r={},h=this,a=h.model,c,l,u=h._updatedGanttRecords.indexOf(n),f=h._updatedGanttRecords.indexOf(t),s=0,e=0,o;if(u!==-1&&f!==-1){if(!a.enableVirtualization)if(o=0,f>u){for(s=0;s<u;s++)h._updatedGanttRecords[s].isExpanded===!1&&++o;for(e=u,u-=o,e;e<f;e++)h._updatedGanttRecords[e].isExpanded===!1&&++o;f-=o}else if(u>f){for(s=0;s<f;s++)h._updatedGanttRecords[s].isExpanded===!1&&++o;for(e=f,f-=o,e;e<u;e++)h._updatedGanttRecords[e].isExpanded===!1&&++o;u-=o}if(u!=-1&&f!=-1)return c=u*a.rowHeight,l=f*a.rowHeight,r.ParentLeft=n.left,r.ChildLeft=t.left,r.ParentWidth=n.width==0?26:n.width,r.ChildWidth=t.width==0?26:t.width,r.ParentTop=c,r.ChildTop=l,r.Height=c>l?c-l:l-c,r.Type=i.predecessorsType,r.ConnectorLineId="parent"+n.taskId+"child"+t.taskId,r.milestoneParent=n.isMilestone?!0:!1,r.milestoneChild=t.isMilestone?!0:!1,r}},_validateChildGanttRecord:function(n,t,i){var r=this,u=r.model,p,o,w,e,a,h,l,f,s;if(predecessorOffset=0,predecessorOffset=i.offset?parseInt(i.offset):0,r._editedTaskBarItem!==t){switch(i.predecessorsType){case"SS":o=r._getDateFromFormat(n.startDate);p=r._getDateFromFormat(t.startDate);t.isMilestone&&o.setDate(o.getDate()-1);r.model.includeWeekend===!1&&r._setBeforeWeekend(o);predecessorOffset&&(o.setDate(o.getDate()+Math.floor(predecessorOffset)),r.model.includeWeekend===!1&&(predecessorOffset<0&&r._setBeforeWeekend(o),predecessorOffset>0&&r._setAfterWeekend(o)));r._stringHolidays&&r._stringHolidays.indexOf(t._getFormatedDate(o,u.dateFormat))!=-1&&o.setDate(o.getDate()+1);t.startDate=t._getFormatedDate(o,u.dateFormat);var y=t.taskId.toString(),v=t.predecessor,c=v.filter(function(n){return n.to===y});c.length>1&&(h=r._getPredecessorDate(t,c,i.predecessorsType),t.isMilestone&&h.setDate(h.getDate()-1),u.includeWeekend===!1&&r._setBeforeWeekend(h),t.startDate=t._getFormatedDate(h,u.dateFormat));t.left=t._calculateLeft(r._projectStartDate,r._perDayWidth,r._holidaysList,u);t.width=t._calculateWidth(r._perDayWidth,r._holidaysList,u);break;case"SF":if(o=r._getDateFromFormat(n.startDate),w=r._getDateFromFormat(t.endDate),o.setDate(o.getDate()-1),r.model.includeWeekend===!1&&r._setBeforeWeekend(o),predecessorOffset&&(o.setDate(o.getDate()+Math.floor(predecessorOffset)),r.model.includeWeekend===!1&&(predecessorOffset<0&&r._setBeforeWeekend(o),predecessorOffset>0&&r._setAfterWeekend(o))),r._stringHolidays&&r._stringHolidays.indexOf(t._getFormatedDate(o,u.dateFormat))!=-1&&o.setDate(o.getDate()+1),t.endDate=t._getFormatedDate(o,u.dateFormat),t.isMilestone)t.startDate=t._getFormatedDate(o,u.dateFormat);else{for(f=r._getDateFromFormat(t.endDate),s=0;s<t.duration-1;s++)f.setDate(f.getDate()-1),r.model.includeWeekend===!1&&predecessorOffset<0&&r._setBeforeWeekend(f),f=r._onHoliDayCheckBefore(f);t.startDate=t._getFormatedDate(f,u.dateFormat)}var y=t.taskId.toString(),v=t.predecessor,c=v.filter(function(n){return n.to===y});if(c.length>0)if(h=r._getPredecessorDate(t,c,i.predecessorsType),h.setDate(h.getDate()-1),r.model.includeWeekend===!1&&r._setBeforeWeekend(h),t.endDate=t._getFormatedDate(h,u.dateFormat),t.isMilestone)t.startDate=t._getFormatedDate(h,u.dateFormat);else{for(f=r._getDateFromFormat(t.endDate),s=0;s<t.duration-1;s++)f.setDate(f.getDate()-1),r.model.includeWeekend===!1&&predecessorOffset<0&&r._setBeforeWeekend(f),f=r._onHoliDayCheckBefore(f);t.startDate=t._getFormatedDate(f,u.dateFormat)}t.left=t._calculateLeft(r._projectStartDate,r._perDayWidth,r._holidaysList,u);t.width=t._calculateWidth(r._perDayWidth,r._holidaysList,u);break;case"FS":if(e=r._getDateFromFormat(n.endDate),p=r._getDateFromFormat(t.startDate),t.isMilestone||e.setDate(e.getDate()+1),predecessorOffset<0?(predecessorOffset*=-1,a=-1,u.includeWeekend===!1&&r._setBeforeWeekend(e)):(u.includeWeekend===!1&&r._setAfterWeekend(e),a=1),predecessorOffset){for(s=0;s<predecessorOffset;s++)r.model.includeWeekend===!1&&(a<0&&r._setBeforeWeekend(e),a>0&&r._setAfterWeekend(e)),e.setDate(e.getDate()+a);r.model.includeWeekend===!1&&r._setAfterWeekend(e)}if(r._stringHolidays&&r._stringHolidays.indexOf(t._getFormatedDate(e,u.dateFormat))!=-1&&e.setDate(e.getDate()+1),t.startDate=t._getFormatedDate(e,u.dateFormat),r._editedTaskBarItem!==t){var v=t.predecessor,y=t.taskId.toString(),c=v&&v.filter(function(n){return n.to===y});c&&c.length>1&&a>0&&(l=r._getPredecessorDate(t,c,i.predecessorsType),t.isMilestone||l.setDate(l.getDate()+1),u.includeWeekend===!1&&r._setAfterWeekend(l),t.startDate=t._getFormatedDate(l,u.dateFormat))}t.left=t._calculateLeft(r._projectStartDate,r._perDayWidth,r._holidaysList,u);t.width=t._calculateWidth(r._perDayWidth,r._holidaysList,u);break;case"FF":if(e=r._getDateFromFormat(n.endDate),w=r._getDateFromFormat(t.endDate),r.model.includeWeekend===!1&&r._setAfterWeekend(e),predecessorOffset&&(e.setDate(e.getDate()+Math.floor(predecessorOffset)),r.model.includeWeekend===!1&&(predecessorOffset<0&&r._setBeforeWeekend(e),predecessorOffset>0&&r._setAfterWeekend(e))),r._stringHolidays&&r._stringHolidays.indexOf(t._getFormatedDate(e,u.dateFormat))!=-1&&e.setDate(e.getDate()+1),t.endDate=t._getFormatedDate(e,u.dateFormat),t.isMilestone)t.startDate=t._getFormatedDate(e,u.dateFormat);else{for(f=r._getDateFromFormat(t.endDate),s=0;s<t.duration-1;s++)f.setDate(f.getDate()-1),r.model.includeWeekend===!1&&predecessorOffset<0&&r._setBeforeWeekend(f),f=r._onHoliDayCheckBefore(f);t.startDate=t._getFormatedDate(f,u.dateFormat)}var y=t.taskId.toString(),v=t.predecessor,c=v&&v.filter(function(n){return n.to===y});if(c&&c.length>1&&(l=r._getPredecessorDate(t,c,i.predecessorsType),u.includeWeekend===!1&&r._setAfterWeekend(l),predecessorOffset>=0&&l.getTime()!==e.getTime()))if(t.endDate=t._getFormatedDate(l,u.dateFormat),t.isMilestone)t.startDate=t._getFormatedDate(l,u.dateFormat);else{for(f=r._getDateFromFormat(t.endDate),s=0;s<t.duration-1;s++)f.setDate(f.getDate()-1),r.model.includeWeekend===!1&&r._setBeforeWeekend(f),f=r._onHoliDayCheckBefore(f);t.startDate=t._getFormatedDate(f,u.dateFormat)}t.left=t._calculateLeft(r._projectStartDate,r._perDayWidth,r._holidaysList,u);t.width=t._calculateWidth(r._perDayWidth,r._holidaysList,u)}t.parentItem&&r._updateParentItem(t);r._isRenddered&&r.refreshGanttRecord(t)}},_getPredecessorDate:function(n,t,i){var u=null,r=this,c=r.model,f=null,e=null,l,o,h=t.filter(function(t){return t.to===n.taskId.toString()}),s;if(h)for(l=h.length,o=0;o<l;o++)predecessor=h[o],parentGanttRecord=r._rows[r._ids.indexOf(predecessor.from)],childGanttRecord=r._rows[r._ids.indexOf(predecessor.to)],u===null&&(u=r._getDateFromFormat(parentGanttRecord.startDate),parseInt(predecessor.offset)&&u.setDate(u.getDate()+parseInt(predecessor.offset))),f===null&&(f=r._getDateFromFormat(parentGanttRecord.endDate),e=r._getDateFromFormat(parentGanttRecord.endDate)),r._getDateFromFormat(parentGanttRecord.startDate).getTime()<u.getTime()&&(u=r._getDateFromFormat(parentGanttRecord.startDate),parseInt(predecessor.offset)&&u.setDate(u.getDate()+parseInt(predecessor.offset))),r._getDateFromFormat(parentGanttRecord.endDate).getTime()>f.getTime()&&(f=r._getDateFromFormat(parentGanttRecord.endDate)),e.setDate(e.getDate()+parseInt(predecessor.offset)),s=r._getDateFromFormat(e),c.includeWeekend===!1&&s&&r._setAfterWeekend(s),parseInt(predecessor.offset)&&f.getTime()<s.getTime()&&f.setDate(f.getDate()+parseInt(predecessor.offset)),e.setDate(e.getDate()-parseInt(predecessor.offset)),c.includeWeekend===!1&&(r._setAfterWeekend(f),r._setAfterWeekend(e));return i=="FS"||i=="FF"?f:i=="SF"||i=="SS"?u:void 0},_renderPredecessor:function(){},_setBeforeWeekend:function(n){n.getDay()==0?n.setDate(n.getDate()-2):n.getDay()==6&&n.setDate(n.getDate()-1)},_setAfterWeekend:function(n){n.getDay()==0?n.setDate(n.getDate()+1):n.getDay()==6&&n.setDate(n.getDate()+2)},_updateEditedGanttRecords:function(n){var i=this,u=i.model,t=n.data,f=i._getDateFromFormat(t.startDate),e=!1,r;if(n.columnName==="startDate")this._stringHolidays&&this._stringHolidays.indexOf(t._getFormatedDate(f,u.dateFormat))!=-1&&f.setDate(f.getDate()+1),i.model.includeWeekend===!1&&(this._setAfterWeekend(f),this._stringHolidays&&this._stringHolidays.indexOf(t._getFormatedDate(f,u.dateFormat))!=-1&&f.setDate(f.getDate()+1)),t.startDate=i.getFormatedDate(f),t.left=t._calculateGanttRecordLeft(f,i._projectStartDate,i._perDayWidth),t.width=t._calculateWidth(i._perDayWidth,i._holidaysList,u),t.progressWidth=t._calculateProgressWidth(t.width,t.status),t.parentItem&&i._updateParentItem(t);else if(n.columnName==="endDate")r=i._getDateFromFormat(t.endDate),f.getTime()<=r.getTime()?(this._stringHolidays&&this._stringHolidays.indexOf(t._getFormatedDate(r,u.dateFormat))!=-1&&(r.setDate(r.getDate()+1),r.getDay()==6&&r.setDate(r.getDate()+2)),u.includeWeekend===!1&&(r.getDay()==0?r.setDate(r.getDate()-2):r.getDay()==6&&r.setDate(r.getDate()-1)),t.endDate=t._calculateFormatedDate(r,u.dateFormat),t._calculateDuration(f,r,u.includeWeekend,u.holidays,t.isMilestone,u),t.width=t._calculateTaskbarWidth(i._perDayWidth,u),t.progressWidth=t._calculateProgressWidth(t.width,t.status),t.parentItem&&i._updateParentItem(t)):(t.endDate=n.previousValue,t.item[u.endDateMapping]=n.previousValue),t.isMilestone=t.duration===0?!0:!1;else if(n.columnName=="duration"){var o=t.duration,h=o-n.previousValue,s=i._calculateUpdatedDate(i._getDateFromFormat(t.endDate),h);t.isMilestone=o===0?!0:!1;t.endDate=s;t.width=t._calculateWidth(i._perDayWidth,i.holidays,u);t.progressWidth=t._calculateProgressWidth(t.width,t.status);u.endDateMapping&&(t.item[u.endDateMapping]=s);t.parentItem&&i._updateParentItem(t)}else n.columnName=="predecessor"?(e=!0,n.previousValue&&i._removeConnectorLine(n.previousValue,t),i._addConnectorLine(t)):n.columnName=="status"&&(t.status=t.status>100?100:t.status,t.progressWidth=i._getProgressWidth(t.width,t.status),t.parentItem&&t.parentItem&&i._updateParentItem(t));t.predecessor&&(e||i._$ganttchartHelper.ejGanttChart("updateConnectorLineOffset",t),i._isMileStoneEdited=t.isMilestone,i._updatedConnectorLineCollection=[],i._connectorlineIds=[],i._validatePredecessor(t),i._updatedConnectorLineCollection.length>0&&i._$ganttchartHelper.ejGanttChart("appendConnectorLine",i._updatedConnectorLineCollection));i._isValidationEnabled=!1;i.refreshGanttRecord(t)},_removeConnectorLine:function(n,t){for(var r=this,o,u,f,i=0,s=n&&n.length,e=-1,i=0;i<s;i++)u=r._rows[r._ids.indexOf(n[i].from)],f=r._rows[r._ids.indexOf(n[i].to)],t.taskId.toString()===n[i].to.toString()&&(e=u.predecessor.indexOf(n[i]),e>=0&&u.predecessor.splice(e,1)),u&&f&&(o="parent"+u.taskId+"child"+f.taskId,r._$ganttchartHelper.ejGanttChart("removeConnectorline",o))},_addConnectorLine:function(n){var u=this,r=0,f=n.predecessor,e,i,t;if(f)for(e=f.length,r=0;r<e;r++)i=f[r],i.to===n.taskId.toString()&&(t=u._rows[u._ids.indexOf(i.from)]),t&&(t.predecessor?t.predecessor.push(i):(t.predecessor=[],t.predecessor.push(i),u._predecessorsCollection.push(t)))},_calculateUpdatedDate:function(n,i){var r=this,f=r.model,u=0,e;if(i>0)for(u;u<i;u++)f.durationUnit==t.Gantt.DurationUnit.Day?n=r.dateUpdate(n,1,0):f.durationUnit==t.Gantt.DurationUnit.Hour&&(n=r.dateUpdate(n,0,1)),n.getDay()==0?n.setDate(n.getDate()+1):n.getDay()==6&&n.setDate(n.getDate()+2);else for(e=-1*i,u=0;u<e;u++)f.durationUnit==t.Gantt.DurationUnit.Day?n=r.dateUpdate(n,-1,0):f.durationUnit==t.Gantt.DurationUnit.Hour&&(n=r.dateUpdate(n,0,-1)),n.getDay()==0?n.setDate(n.getDate()-2):n.getDay()==6&&n.setDate(n.getDate()-1);return r.getFormatedDate(n)},_updateEditedGanttRecord:function(n){var t=this;if(n.predecessor)for(var o=n.predecessor,u=0,h=o.length,r,f,e,s,i,u=0;u<h;u++)t._updatedConnectorLineCollection=[],t._connectorlineIds=[],r=o[u],r.to===n.taskId.toString()&&(f=t._rows[t._ids.indexOf(r.from)],e=t._rows[t._ids.indexOf(r.to)],f&&e&&(s="parent"+f.taskId+"child"+e.taskId,t._$ganttchartHelper.ejGanttChart("removeConnectorline",s),i=t._createConnectorLineObject(f,e,r),i&&(t._connectorlineIds.length>0&&t._connectorlineIds.indexOf(i.ConnectorLineId)==-1?(t._updatedConnectorLineCollection.push(i),t._connectorlineIds.push(i.ConnectorLineId)):t._connectorlineIds.length==0&&(t._updatedConnectorLineCollection.push(i),t._connectorlineIds.push(i.ConnectorLineId)),t._$ganttchartHelper.ejGanttChart("appendConnectorLine",t._updatedConnectorLineCollection))))},_updateGanttRecord:function(n){var t=this,i=t.model;n.left=n._calculateLeft(t._projectStartDate,t._perDayWidth,t.holidays,i);n.width=n._calculateWidth(t._perDayWidth,i.holidays,i);t.refreshGanttRecord(n);n.parentItem&&t._updateParentItem(n)},refreshGanttRecord:function(n){var t=this,i;t._currentViewData=t.getCurrentViewData();i=t._currentViewData.indexOf(n);t._$ganttchartHelper.ejGanttChart("refreshRow",i);t._$treegridHelper.ejTreeGrid("refreshRow",i)},_updateParentItem:function(n){var r=this,i=n.parentItem,u=r.model,p=r._getDateFromFormat(i.startDate),k=r._getDateFromFormat(n.startDate),c=r._getDateFromFormat(i.endDate),w=r._getDateFromFormat(n.endDate),b,y;k.getTime()<p.getTime()&&(i.startDate=n.startDate,u.startDateMapping&&(i.item[u.startDateMapping]=i.startDate));w.getTime()>c.getTime()&&(dateDiff=r._daydiff(c,w),i.endDate=n.endDate,u.endDateMapping&&(i.item[u.endDateMapping]=i.endDate));for(var s=0,l=i.childRecords,d=l&&l.length,f,e=null,o=null,a=0,g=0,h=0,v=0,s=0;s<d;s++)f=l[s],e===null&&(e=r._getDateFromFormat(f.startDate)),o===null&&(o=r._getDateFromFormat(f.endDate)),r._getDateFromFormat(f.endDate).getTime()>o.getTime()&&(o=r._getDateFromFormat(f.endDate)),r._getDateFromFormat(f.startDate).getTime()<e.getTime()&&(e=r._getDateFromFormat(f.startDate)),f.isMilestone?g++:u.durationUnit==t.Gantt.DurationUnit.Hour?(h+=f.duration*8,v+=f.duration*8*f.status/100):(h+=f.duration*24,v+=f.duration*24*f.status/100);p.getTime()!==e.getTime()&&(i.startDate=i._getFormatedDate(e,u.dateFormat),u.startDateMapping&&(i.item[u.startDateMapping]=i.startDate));c.getTime()!=o.getTime()&&(i.endDate=i._getFormatedDate(o,u.dateFormat),u.endDateMapping&&(i.item[u.endDateMapping]=i.endDate));u.endDateMapping.length==0&&u.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&u.durationUnit==t.Gantt.DurationUnit.Hour&&u.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day||i._calculateDuration(r._getDateFromFormat(i.startDate),r._getDateFromFormat(i.endDate),u.includeWeekend,u.holidays,i[u.milestoneMapping],u);(u.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours||u.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours)&&u.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day?(b=r._getDateFromFormat(i.startDate),y=(b-r._projectStartDate)/864e5):y=u.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&u.roundOffDayworkingTime?Math.round((r._getDateFromFormat(i.startDate)-r._projectStartDate)/864e5):Math.round((r._getDateFromFormat(i.startDate)-r._projectStartDate)/864e5);i.left=y*r._perDayWidth;i.width=i._calculateWidth(r._perDayWidth,r._holidaysList,u);a=h>0?v/h*100:0;i.progressWidth=r._getProgressWidth(i.width,a);i.status=Math.round(a);u.progressMapping&&(i.item[u.progressMapping]=i.status);r._isRenddered&&r.refreshGanttRecord(i);i.parentItem&&r._updateParentItem(i)},_validatePredecessor:function(n){var t=this,c=t.model,p,s;if(n.predecessor){for(var l=n.predecessor,e,u=null,o,r,i,a=n.taskId.toString(),h=l.filter(function(n){return n.to===a}),v=l.filter(function(n){return n.from===a}),y=h.length,f=0;f<y;f++)r=h[f],e=t._rows[t._ids.indexOf(r.from)],u=t._rows[t._ids.indexOf(r.to)],o="parent"+e.taskId+"child"+u.taskId,t._$ganttchartHelper&&t._$ganttchartHelper.ejGanttChart("removeConnectorline",o),n.taskId.toString()===r.to&&t._validateChildGanttRecord(e,u,r),n.taskId.toString()===r.from&&t._validateChildGanttRecord(e,u,r);for(f=0;f<y;f++)(r=h[f],e=t._rows[t._ids.indexOf(r.from)],u=t._rows[t._ids.indexOf(r.to)],c.enableVirtualization!==!1||e.isExpanded!==!1&&u.isExpanded!=!1)&&(i=t._createConnectorLineObject(e,u,r),i&&(t._connectorlineIds.length>0&&t._connectorlineIds.indexOf(i.ConnectorLineId)==-1?(t._updatedConnectorLineCollection.push(i),t._connectorlineIds.push(i.ConnectorLineId)):t._connectorlineIds.length==0?(t._updatedConnectorLineCollection.push(i),t._connectorlineIds.push(i.ConnectorLineId)):t._connectorlineIds.indexOf(i.ConnectorLineId)!=-1&&(s=t._connectorlineIds.indexOf(i.ConnectorLineId),t._updatedConnectorLineCollection[s]=i)));for(p=v.length,f=0;f<p;f++)(r=v[f],e=t._rows[t._ids.indexOf(r.from)],u=t._rows[t._ids.indexOf(r.to)],o="parent"+e.taskId+"child"+u.taskId,t._$ganttchartHelper&&t._$ganttchartHelper.ejGanttChart("removeConnectorline",o),t._validateChildGanttRecord(e,u,r),c.enableVirtualization!==!1||e.isExpanded!==!1&&u.isExpanded!=!1)&&(i=t._createConnectorLineObject(e,u,r),i&&(t._connectorlineIds.length>0&&t._connectorlineIds.indexOf(i.ConnectorLineId)==-1?(t._updatedConnectorLineCollection.push(i),t._connectorlineIds.push(i.ConnectorLineId)):t._connectorlineIds.length==0?(t._updatedConnectorLineCollection.push(i),t._connectorlineIds.push(i.ConnectorLineId)):t._connectorlineIds.indexOf(i.ConnectorLineId)!=-1&&(s=t._connectorlineIds.indexOf(i.ConnectorLineId),t._updatedConnectorLineCollection[s]=i)),u&&t._validatePredecessor(u))}},_calculateDateDifference:function(n,t){var i=t>=0?t:-1*t;return t>0?i-this._calculateWeekendCount(n,t):t+this._calculateWeekendCount(n,t)},_calculateWeekendCount:function(n,t){var u=t>=0?t:-1*t,r=0,i=0;if(t>0)for(i=0;i<t;i++)n.getDay()==0?(r++,n.setDate(n.getDate()+1)):n.getDay()==6?(r+=2,++i,n.setDate(n.getDate()+2)):n.setDate(n.getDate()+1);else for(i=0;i<u;i++)n.setDate(n.getDate()-1),(n.getDay()==0||n.getDay()==6)&&(r+=1);return r},_daydiff:function(n,t){return(new Date(t)-new Date(n))/864e5},dateUpdate:function(n,t,i){return new Date(n.getFullYear(),n.getMonth(),n.getDate()+t,n.getHours()+i,n.getMinutes(),n.getSeconds(),n.getMilliseconds())},_collapseAll:function(){var n=this,e=n.model,i=0,r,u={},o=e.enableVirtualization,s=n.getRows(),f;for(n._gridRows=s,n._isInExpandCollapse=!0,i=0;i<n.model.parentRecords.length;i++)n.model.parentRecords[i].expanded&&(r=n.model.parentRecords[i],u.data=r,u.recordIndex=i,u.expanded=!1,o?r.hasChildRecords&&r.expanded&&t.TreeGrid.sendExpandCollapseRequest(n,u):(r.hasChildRecords&&r.expanded?t.TreeGrid.sendExpandCollapseRequest(n,u):t.TreeGrid.sendExpandCollapseRequest(n,u),f=n._collapsedRecordCount,n._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",-f)));n._isInExpandCollapse=!1},_expandAll:function(){var n=this,e=n.model,r=0,i,u={},o=e.enableVirtualization,f;for(n._isInExpandCollapse=!0,r=0;r<n._updatedGanttRecords.length;r++)i=n._updatedGanttRecords[r],u.data=i,u.recordIndex=r,u.expanded=!0,o?i.hasChildRecords&&!i.expanded&&t.TreeGrid.sendExpandCollapseRequest(n,u):i.hasChildRecords&&!i.expanded&&(t.TreeGrid.sendExpandCollapseRequest(n,u),f=n._expandedRecordsCount,n._$ganttchartHelper.ejGanttChart("reRenderGanttGridLinesTable",f));n._isInExpandCollapse=!1},_getDateFromFormat:function(n){return typeof n=="object"?new Date(n):n?Globalize.parseDate(n,this.model.dateFormat)==null?new Date(n):Globalize.parseDate(n,this.model.dateFormat):void 0},_getFormatedDate:function(n,t){return Globalize.format(n,t)},_destroy:function(){var n=this;n.element.empty().removeClass("e-gantt-core e-gantt "+n.model.cssClass)}});t.Gantt.EditingType={String:"stringedit",Boolean:"booleanedit",Numeric:"numericedit",Dropdown:"dropdownedit",DatePicker:"datepicker",DateTimePicker:"datetimepicker"};t.Gantt.ToolbarItems={Add:"add",Edit:"edit",Delete:"delete",Update:"update",Cancel:"cancel",Search:"search",Indent:"indent",Outdent:"outdent",ExpandAll:"expandAll",CollapseAll:"collapseAll",PrevTimeSpan:"prevTimeSpan",NextTimeSpan:"nextTimeSpan"};t.Gantt.ScheduleHeaderType={Year:"year",Month:"month",Week:"week",Day:"day"};t.Gantt.DurationUnit={Day:"day",Hour:"hour"};t.Gantt.workingTimeScale={TimeScale8Hours:"TimeScale8Hours",TimeScale24Hours:"TimeScale24Hours"};t.Gantt.localization={};t.Gantt.localization["en-US"]={emptyRecord:"No records to display",columnHeaderTexts:{taskId:"ID",taskName:"Task Name",startDate:"Start Date",endDate:"End Date",resourceInfo:"Resources",duration:"Duration",status:"Progress",predecessor:"Predecessor",baselineStartDate:"Baseline Start Date",baselineEndDate:"Baseline End Date"},editDialogTexts:{addFormTitle:"New Task",editFormTitle:"Edit Task",saveButton:"Save",cancelButton:"Cancel"},calendars:{standard:{days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December"],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",F:"dddd, MMMM dd, yyyy h:mm:ss tt",g:"M/d/yyyy h:mm tt",G:"M/d/yyyy h:mm:ss tt",m:"MMMM dd",M:"MMMM dd",s:"yyyy'-'MM'-'ddTHH':'mm':'ss",t:"h:mm tt",T:"h:mm:ss tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",y:"MMMM, yyyy",Y:"MMMM, yyyy"}}}};t.Gantt.GanttRecord=function(){var n=this;n.taskId=null;n.taskName=null;n.startDate=null;n.endDate=null;n.duration=null;n.isMilestone=!1;n.status=null;n.predecessor=null;n.resourceInfo=null;n.parentItem=null;n.isSelected=!1;n.childRecords=null;n.hasChildRecords=!1;n.expanded=!1;n.level=0;n.left=0;n.width=0;n.progressWidth=0;n.item=null;n.baselineLeft=0;n.baselineWidth=0;n.baselineStartDate=null;n.baselineEndDate=null;n.isReadOnly=!1};t.Gantt.GanttRecord.prototype={_calculateLeft:function(n,i,r,u){var e=this,a,v=0,o=e._getDateFromFormat(e.startDate,u.dateFormat),f=e._getDateFromFormat(e.endDate,u.dateFormat),h=f&&f.getHours(),p=f&&f.getMinutes(),c=0,s=u.workingTimeScale,l,y;if(f&&(h=f.getHours(),p=f.getMinutes()),u.durationUnit==t.Gantt.DurationUnit.Hour?u.durationMapping&&(s==t.Gantt.workingTimeScale.TimeScale24Hours?(h=parseInt(e.duration%24)>0?parseInt(e.duration%24):0,c=h>0?parseInt(e.duration/24)+1:parseInt(e.duration/24)):s==t.Gantt.workingTimeScale.TimeScale8Hours&&(h=parseInt(e.duration%8)>0?parseInt(e.duration%8):0,c=h>0?parseInt(e.duration/8)+1:parseInt(e.duration/8))):c=parseInt(e.duration),f==null&&(f=e._getDateFromFormat(e.startDate,u.dateFormat),f.setDate(f.getDate()+c)),u.includeWeekend==!1){for(o.getDay()==0&&o.setDate(o.getDate()+1),o.getDay()==6&&o.setDate(o.getDate()-1),e._updateHoliday(o,r,u.includeWeekend),l=new Date(o),y=0;y<c;y++)l.getDay()==0?v++:l.getDay()==6&&(v+=2,l.setDate(l.getDate()+2)),l.setDate(l.getDate()+1);f=new Date(o);v=c===0?1:v;f.setDate(f.getDate()+(c+v-1));f.getDay()==0&&f.setDate(f.getDate()+1);f.getDay()==6&&f.setDate(f.getDate()+2)}else u.includeWeekend==!0&&(e._updateHoliday(o,r,u.includeWeekend),f=new Date(o),c>0&&f.setDate(f.getDate()+(c-1)));return h?s==t.Gantt.workingTimeScale.TimeScale8Hours&&u.durationUnit==t.Gantt.DurationUnit.Hour?h>0?f.setHours(8+h):f.setHours(17):f.setHours(h):s==t.Gantt.workingTimeScale.TimeScale8Hours&&u.durationUnit==t.Gantt.DurationUnit.Hour?f.setHours(17):(s==t.Gantt.workingTimeScale.TimeScale24Hours&&u.dateFormat.indexOf("hh")!=-1||s==t.Gantt.workingTimeScale.TimeScale24Hours&&u.durationUnit==t.Gantt.DurationUnit.Hour)&&f.setHours(24),e.startDate=e._getFormatedDate(o,u.dateFormat),e.endDate=e._getFormatedDate(f,u.dateFormat),u.endDateMapping&&(e.item[u.endDateMapping]=e.endDate),u.startDateMapping&&(e.item[u.startDateMapping]=e.startDate),a=Math.round((o-n)/864e5),s==t.Gantt.workingTimeScale.TimeScale24Hours&&u.scheduleHeaderSettings.scheduleHeaderType!=t.Gantt.ScheduleHeaderType.Day?a=(o-n)/864e5:s==t.Gantt.workingTimeScale.TimeScale8Hours&&u.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&u.dateFormat.indexOf("hh")==-1?a=(o-n)/864e5:(s==t.Gantt.workingTimeScale.TimeScale24Hours||s==t.Gantt.workingTimeScale.TimeScale8Hours)&&u.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&u.dateFormat.indexOf("hh")!=-1?a=(o-n)/864e5:s==t.Gantt.workingTimeScale.TimeScale8Hours&&u.roundOffDayworkingTime&&(a=Math.round((o-n)/864e5)),a*i},_calculateBaselineLeft:function(n,t,i,r){var e,f=this,o=Globalize.parseDate(f.baselineStartDate,r),s=parseInt(f.duration),u=f.endDate;return u==null&&(u=new Date(o),u.setDate(u.getDate()+s)),e=Math.ceil((o-n)/864e5),e*t},_updateHoliday:function(n,t,i){var r=0,u=t&&t.length;if(u>0){for(r=0;r<u;r++)t[r].getDate()==n.getDate()&&n.setDate(n.getDate()+1);i==!1&&n.getDay()==6&&n.setDate(n.getDate()+2)}},_calculateGanttRecordLeft:function(n,t,i){var r=this,u=r._daydiff(t,n);return u*i},_calculateReverseLeft:function(n,t,i,r){var c,u=this,o=0,f=u.startDate,s=u.duration&&parseInt(u.duration),e,h;if(f==null&&(f=u._getDateFromFormat(u.endDate),f.setDate(f.getDate()-s)),i==!1){for(e=u._getDateFromFormat(u.endDate,r),h=0;h<s;h++)e.getDay()==0?(o+=2,e.setDate(e.getDate()-2)):e.getDay()==6&&o++,e.setDate(e.getDate()-1);f=u._getDateFromFormat(u.endDate,r);o=s===0?1:o;f.setDate(f.getDate()-(s+o-1))}return u.startDate=u._getFormatedDate(f,r),c=Math.ceil((f-n)/864e5),c*t},_calculateReverseWidth:function(n,t,i,r){var u=this,s=0,a,f,h=0,e=u.startDate,c=u.duration&&parseInt(u.duration),o=u.endDate,l;if(e==null&&(e=u._getDateFromFormat(o,t),e.setDate(e.getDate()-c+1)),i==!1){for(f=u._getDateFromFormat(o,t),h=0;h<c;h++)f.getDay()==0?(s+=2,f.setDate(f.getDate()-2)):f.getDay()==6&&s++,f.setDate(f.getDate()-1);e=u._getDateFromFormat(o,t);e.setDate(e.getDate()-(c+s-1))}if(r!=null&&r.length>0){for(f=u._getDateFromFormat(e,t),h=0;h<c;h++){for(f.setDate(f.getDate()+1),l=0;l<r.length;l++)new Date(r[l].day).getDate()==f.getDate()&&s++;i==!1&&(f.getDay()==0||f.getDay()==6)&&s++}o=u._getDateFromFormat(u.startDate,t);o.setDate(o.getDate()+(c+s-1))}return a=Math.ceil((u._getDateFromFormat(o,t)-u._getDateFromFormat(u.startDate,t))/864e5)+1,a*n},_calculateWidth:function(n,i,r){var u=this,f,c=u.startDate,s=u.endDate,h=u.duration,e,o;return s==null&&(h=parseInt(h),s=u._getFormatedDate(c,r.dateFormat),s.setDate(s.getDate()+h-1)),u._calculateEndDate(r.includeWeekend,i,r,n),r.durationUnit==t.Gantt.DurationUnit.Hour?(r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours?f=r.durationUnit==t.Gantt.DurationUnit.Hour&&r.dateFormat.indexOf("hh")==-1?u.duration:u._hourdiff(u._getDateFromFormat(u.startDate,r.dateFormat),u._getDateFromFormat(u.endDate,r.dateFormat)):r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(f=r.durationUnit==t.Gantt.DurationUnit.Hour&&r.dateFormat.indexOf("hh")==-1?u.duration*3+u.duration%8:u._hourdiff(u._getDateFromFormat(u.startDate,r.dateFormat),u._getDateFromFormat(u.endDate,r.dateFormat))),f*(n/24)):(r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours&&r.scheduleHeaderSettings.scheduleHeaderType!=t.Gantt.ScheduleHeaderType.Day&&r.dateFormat.indexOf("hh:")!=-1?f=(u._getDateFromFormat(u.endDate,r.dateFormat)-u._getDateFromFormat(u.startDate,r.dateFormat))/864e5:r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours&&r.scheduleHeaderSettings.scheduleHeaderType!=t.Gantt.ScheduleHeaderType.Day&&r.dateFormat.indexOf("hh:")==-1?f=(u._getDateFromFormat(u.endDate,r.dateFormat)-u._getDateFromFormat(u.startDate,r.dateFormat))/864e5+1:r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&r.durationUnit!=t.Gantt.DurationUnit.Hour?(e=new Date(u.startDate),o=new Date(u.endDate),e.setHours(8),o.setHours(17),f=(o-e)/864e5):r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&r.durationUnit==t.Gantt.DurationUnit.Hour?(e=new Date(u.startDate),o=new Date(u.endDate),f=(o-e)/864e5):(r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours||r.roundOffDayworkingTime)&&(f=Math.round((u._getDateFromFormat(u.endDate,r.dateFormat)-u._getDateFromFormat(u.startDate,r.dateFormat))/864e5)+1),f*n)},_calculateTaskbarWidth:function(n,i){var r=this,f=0,u=i.dateFormat,e=i.workingTimeScale;return i.durationUnit==t.Gantt.DurationUnit.Hour?(i.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours?f=i.durationUnit==t.Gantt.DurationUnit.Hour&&i.dateFormat.indexOf("hh")==-1?r.duration:r._hourdiff(r._getDateFromFormat(r.startDate,u),r._getDateFromFormat(r.endDate,u)):i.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(f=i.durationUnit==t.Gantt.DurationUnit.Hour&&i.dateFormat.indexOf("hh")==-1?r.duration:r._hourdiff(r._getDateFromFormat(r.startDate,u),r._getDateFromFormat(r.endDate,u))),f*(n/24)):(f=e==t.Gantt.workingTimeScale.TimeScale24Hours&&i.scheduleHeaderSettings.scheduleHeaderType!=t.Gantt.ScheduleHeaderType.Day&&i.dateFormat.indexOf("hh")==-1?r._daydiff(r._getDateFromFormat(r.startDate,u),r._getDateFromFormat(r.endDate,u))+1:e==t.Gantt.workingTimeScale.TimeScale24Hours?r._daydiff(r._getDateFromFormat(r.startDate,u),r._getDateFromFormat(r.endDate,u)):e==t.Gantt.workingTimeScale.TimeScale8Hours?Math.round(r._daydiff(r._getDateFromFormat(r.startDate,u),r._getDateFromFormat(r.endDate,u))+1):r._daydiff(r._getDateFromFormat(r.startDate,u),r._getDateFromFormat(r.endDate,u)),f*n)},_calculateBaseLineWidth:function(n,i){var r=this,f=0,u=i.dateFormat,e=i.workingTimeScale;return i.durationUnit==t.Gantt.DurationUnit.Hour?(i.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours?f=i.durationUnit==t.Gantt.DurationUnit.Hour&&i.dateFormat.indexOf("hh")==-1?r.duration:r._hourdiff(r._getDateFromFormat(r.baselineStartDate,u),r._getDateFromFormat(r.baselineEndDate,u)):i.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(f=i.durationUnit==t.Gantt.DurationUnit.Hour&&i.dateFormat.indexOf("hh")==-1?r.duration:r._hourdiff(r._getDateFromFormat(r.baselineStartDate,u),r._getDateFromFormat(r.baselineEndDate,u))),f*(n/24)):(f=e==t.Gantt.workingTimeScale.TimeScale24Hours&&i.scheduleHeaderSettings.scheduleHeaderType!=t.Gantt.ScheduleHeaderType.Day&&i.dateFormat.indexOf("hh")==-1?r._daydiff(r._getDateFromFormat(r.baselineStartDate,u),r._getDateFromFormat(r.baselineEndDate,u))+1:e==t.Gantt.workingTimeScale.TimeScale24Hours?r._daydiff(r._getDateFromFormat(r.baselineStartDate,u),r._getDateFromFormat(r.baselineEndDate,u)):e==t.Gantt.workingTimeScale.TimeScale8Hours?Math.round(r._daydiff(r._getDateFromFormat(r.baselineStartDate,u),r._getDateFromFormat(r.baselineEndDate,u))+1):r._daydiff(r._getDateFromFormat(r.baselineStartDate,u),r._getDateFromFormat(r.baselineEndDate,u)),f*n)},_getFormatedDate:function(n,t){return Globalize.format(n,t)},_getDateFromFormat:function(n,t){if(n)return Globalize.parseDate(n,t)==null?new Date(n):Globalize.parseDate(n,t)},_calculateProgressWidth:function(n,t){return n*t/100},_setResourceInfo:function(n,t,i,r){var u=0,o=n.length,e=[],f;for(u;u<o;u++)f=r.filter(function(i){return n[u]===i[t]}),f.length&&e.push(f[0]);return e},_updateEndDate:function(n,t,i){var r=this,h=new Date(n),c=r._getDateFromFormat(r.startDate,i),o=r._daydiff(h,c),u=r._getDateFromFormat(r.endDate,i),s=0,f,e;if(t==!1)for(f=0,f;f<=o;f++)u.setDate(u.getDate()+1),(u.getDay()==0||u.getDay()==6)&&(s+=1);e=r._getDateFromFormat(r.endDate,i);e.setDate(e.getDate()+o+s);r.endDate=r._getFormatedDate(e,i)},_calculateFormatedDate:function(n,t){return Globalize.format(n,t)},_updateParentProgress:function(n,t){var r=0,e=n.childRecords&&n.childRecords.length,u=0,f=0,i;if(n.childRecords){for(i=0;i<e;i++)u+=n.childRecords[i].duration*24,f+=n.childRecords[i].duration*24*n.childRecords[i].status/100;r=f/u*100;isNaN(r)&&(r=0);n.progressWidth=this._getProgressWidth(n.width,r);n.status=Math.round(r);t&&(n.item[t]=n.status)}n.parentItem&&this._updateParentProgress(n.parentItem,t)},_getProgressWidth:function(n,t){return n*t/100},_calculatePredecessor:function(n){var u=[],i,f={},t,e=this.taskId.toString(),r;return n.split(",").forEach(function(n){t=n.split("+");r="+";n.indexOf("-")>=0&&(t=n.split("-"),r="-");i=t[0].match(/(\d+|[A-z]+)/g);f={from:i[0],predecessorsType:i.length>1?i[1].toUpperCase():"FS",offset:t.length>1?r+""+t[1]:"",isdrawn:!1,to:e};u.push(f)}),u},_updateGanttRecord:function(n,t,i,r,u,f,e,o){var s=this,h=s.left%f,c=(s.left-h)/f;startDate=new Date(u);startDate.setDate(u.getDate()+c);startDate.getDay()==0?startDate.setDate(startDate.getDate()+1):startDate.getDay()==6&&startDate.setDate(startDate.getDate()+2);s.startDate=s._getFormatedDate(startDate,e);s.left=s._calculateLeft(u,f,r,e,t);s.width=s._calculateWidth(f,r,o,e);s.parentItem&&s._updateParentItem(s,n,t,i,r,u,f,e,o)},_calculateUpdatedDate:function(n,t){var r=this,i=0,u;if(t>0)for(i;i<t;i++)n=r._dataSubtract(n,1),n.getDay()==0?n.setDate(n.getDate()+1):n.getDay()==6&&n.setDate(n.getDate()+2);else for(u=-1*t,i=0;i<u;i++)n=r._dataSubtract(n,-1),n.getDay()==0?n.setDate(n.getDate()-2):n.getDay()==6&&n.setDate(n.getDate()-1);return r._getFormatedDate(n)},_dataSubtract:function(n,t){return new Date(n.getFullYear(),n.getMonth(),n.getDate()+t,n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())},_calculateEndDate:function(n,i,r,u){var e=this,a=0,f=e._getDateFromFormat(e.startDate,r.dateFormat),s=e._getDateFromFormat(e.endDate,r.dateFormat),o=0,v=0,h=0,y=0,b,k,c,l,g,w;if(s&&(o=s.getHours(),v=s.getMinutes()),r.durationUnit==t.Gantt.DurationUnit.Hour){if(r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours)r.endDateMapping?s?(o=s.getHours(),v=s.getMinutes()):o=parseInt(e.duration%24)>0?parseInt(e.duration%24):0:(c=f.getHours()+e.duration,o=parseInt(c%24)>0?parseInt(c%24):0),h=o>0?parseInt((f.getHours()+e.duration)/24)+1:parseInt(f.getHours()+e.duration)/24;else if(r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours){r.endDateMapping?s?(o=s.getHours(),v=s.getMinutes()):o=e._calculateTimeScale8Hour(f.getHours(),e.duration)%24:(c=f.getHours()+e.duration,o=parseInt(c%8)>0?parseInt(c%8):0,o=e._calculateTimeScale8Hour(f.getHours(),e.duration)%24);var p=e._calculateTimeScale8Hour(f.getHours(),e.duration),d=parseInt(p/24)<1?1:parseInt(p/24),nt=e._dateUpdate(f,0,p-f.getHours());nt.getHours()>=8&&(d+=1);h=o>0?Math.round(d):parseInt(e.duration)/8}}else h=parseInt(e.duration);if(e.width>0&&(b=e.left+e.width,k=b%u,y=Math.round(k/(u/24))),h===0){e.endDate=e.startDate;return}if(n===!1)for(a=1;a<h;a++)f.getDay()==0?f.setDate(f.getDate()+1):f.getDay()==6&&f.setDate(f.getDate()+2),f.setDate(f.getDate()+1);else f.setDate(f.getDate()+h-1);if(n===!1&&(f.getDay()==0?f.setDate(f.getDate()+1):f.getDay()==6&&f.setDate(f.getDate()+2)),i&&i.length)for(l=0,g=i.length,l=0;l<g;l++)w=new Date(i[l]),w>=e._getDateFromFormat(e.startDate,r.dateFormat)&&w<=f&&(f.setDate(f.getDate()+1),n===!1&&(f.getDay()==0?f.setDate(f.getDate()+1):f.getDay()==6&&f.setDate(f.getDate()+2)));n===!1&&(f.getDay()==0?f.setDate(f.getDate()+1):f.getDay()==6&&f.setDate(f.getDate()+2));y>0&&f.setHours(y);o>0&&(r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&r.durationUnit==t.Gantt.DurationUnit.Hour?f.setHours(o):f.setHours(o));r.dateFormat.indexOf("hh:")&&r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&r.scheduleHeaderSettings.scheduleHeaderType!=t.Gantt.ScheduleHeaderType.Day?f.setHours(17):r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours&&r.durationUnit==t.Gantt.DurationUnit.Hour&&(o>0?f.setHours(o):f.setHours(24));e.endDate=e._calculateFormatedDate(f,r.dateFormat);r.endDateMapping&&(e.item[r.endDateMapping]=e.endDate)},_calculateTimeScale8Hour:function(n,t){var i=n;do n>=8&&n<13||n>13&&n<=17?(i++,t--,n=n==24?0:n+1):(n=n==24?0:n+1,i++);while(t>0);return i},_dateUpdate:function(n,t,i){return new Date(n.getFullYear(),n.getMonth(),n.getDate()+t,n.getHours()+i,n.getMinutes(),n.getSeconds(),n.getMilliseconds())},_calculateDuration:function(n,i,r,u,f,e){var h=this,o,s,c;for(e.durationUnit==t.Gantt.DurationUnit.Hour?(o=h._hourdiff(n,i),o<0,e.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours):o=h._daydiff(n,i),offset=r===!1?h._calculateDateDifference(new Date(n),o):e.durationUnit!=t.Gantt.DurationUnit.Hour?o+1:o,s=0;s<u.length;s++)new Date(u[s].day)>=n&&new Date(u[s].day)<=i&&(e.durationUnit==t.Gantt.DurationUnit.Hour?offset-=24:offset--);e.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours||e.durationUnit==t.Gantt.DurationUnit.Hour?(c=offset-parseInt(offset,10),c=c*10,offset=c==5?parseInt(offset,10)+.5:Math.round(offset)):offset=Math.round(offset);h.duration=t.isNullOrUndefined(f)?offset:offset==0&&f==!1?1:offset},_calculateDateDifference:function(n,t){var i=t>=0?t:-1*t;return t>0?i-this._calculateWeekendCount(n,t)+1:t+this._calculateWeekendCount(n,t)},_calculateWeekendCount:function(n,t){var u=t>=0?t:-1*t,r=0,i=0;if(t>0)for(i=0;i<t;i++)n.getDay()==0?(r++,n.setDate(n.getDate()+1)):n.getDay()==6?(r+=2,++i,n.setDate(n.getDate()+2)):n.setDate(n.getDate()+1);else for(i=0;i<u;i++)n.setDate(n.getDate()-1),(n.getDay()==0||n.getDay()==6)&&(r+=1);return r},_daydiff:function(n,t){return(t-n)/864e5},_hourdiff:function(n,t){return(t-n)/36e5},_getProgressPercent:function(n,t){return Math.ceil((t/n*100).toFixed(2))}};t.Gantt._getPredecessorsValue=function(n){return this.data.item?this.data.item[n]:""};t.Gantt._getCellValue=function(n){var t=this.data[n];return t?t:this.data.item&&this.data.item[n]}})(jQuery,Syncfusion),function(n,t,r){t.widget("ejTreeGrid","ej.TreeGrid",{_rootCSS:"e-treegrid",element:null,validTags:["div"],model:null,_tags:[{tag:"columns",attr:["field","headerText","allowSorting","editType","allowFiltering","filterEditType","width"],content:"template"},{tag:"sortSettings.sortedColumns",attr:["field","direction"]}],_columns:function(n,t,i){var r=this.element.find(".e-headercelldiv");r[n.columns].innerHTML=i;this._trigger("refresh")},keyConfigs:{focus:"e",editRecord:"113",saveRequest:"13",cancelRequest:"27",firstRowSelection:"36",lastRowSelection:"35",leftArrow:"37",upArrow:"38",rightArrow:"39",downArrow:"40",moveCellRight:"9",moveCellLeft:"shift+9",selectedRowExpand:"alt+40",totalRowExpand:"ctrl+40",selectedRowCollapse:"alt+38",totalRowCollapse:"ctrl+38"},defaults:{allowFiltering:!1,filterBarMode:"immediate",allowSorting:!1,allowColumnResize:!1,allowSelection:!0,dataSource:null,query:t.Query(),idMapping:"",parentIdMapping:"",showGridCellTooltip:!1,showGridExpandCellTooltip:!1,enableAltRow:!0,selectedItem:null,toolbarSettings:{showToolbar:!1,toolbarItems:[]},editSettings:{allowEditing:!1,allowAdding:!0,allowDeleting:!0,editMode:"cellEditing",rowPosition:"top"},enableVirtualization:!1,allowMultiSorting:!1,sortSettings:{sortedColumns:[]},selectionType:"single",selectedRowIndex:-1,allowKeyboardNavigation:!0,cssClass:"",locale:"en-US",isEdit:!1,allowScrolling:!1,groupSettings:{groupedColumns:[]},sizeSettings:{height:null,width:null},enableResize:!1,rowDataBound:null,load:null,queryCellInfo:null,rowSelecting:null,rowSelected:null,beginEdit:null,endEdit:null,expanding:null,expanded:null,collapsing:null,collapsed:null,currentViewData:[],flatRecords:[],parentRecords:[],records:[],columns:[],commonWidth:150,dateFormat:"MM/dd/yyyy",rowHeight:30,emptyRecordText:"No Records To Display",treeColumnIndex:0,workingTimeScale:"TimeScale8Hours",childMapping:"",enableCollapseAll:!1,rowTemplateID:"",altRowTemplateID:"",contextMenuSettings:{showContextMenu:!1,contextMenuItems:[]},contextMenuOpen:null},dataTypes:{columns:"array",sortSettings:{sortedColumns:"array"},currentViewData:"array",flatRecords:"array",parentRecords:"array",records:"array",contextMenuSettings:{contextMenuItems:"array"},toolbarSettings:{toolbarItems:"array"},selectedItem:"data"},observables:["selectedRowIndex","dataSource"],selectedItem:t.util.valueFunction("selectedItem"),selectedRowIndex:t.util.valueFunction("selectedRowIndex"),dataSource:t.util.valueFunction("dataSource"),getHeaderTable:function(){return this._$gridHeaderTable},setGridHeaderTable:function(n){this._$gridHeaderTable=n},getHeaderContent:function(){return this._$gridHeaderContent},setGridHeaderContent:function(n){this._$gridHeaderContent=n},getContentTable:function(){return this._$gridContentTable},getContent:function(){return this._$gridContent},setGridContentTable:function(n){this._$gridContentTable=n},getRows:function(){return this._$gridRows},setGridRows:function(n){this._$gridRows=n},getCurrentViewData:function(){return this.model.currentViewData},getUpdatedCurrentViewData:function(){return this._updateCurrentViewData(),this.model.currentViewData},getFlatRecords:function(){return this.model.records},setHeight:function(n){this._totalHeight=n},getUpdatedRecords:function(){return this._updatedRecords},getDataSource:function(){return this.dataSource()},getUpdatedIds:function(){return this.model.ids},getRecordsCount:function(){return this._recordsCount},setRecordsCount:function(n){this._recordsCount=n},getExpandCollapseRecordsCount:function(){return this._expandCollapseRecordCount},setCollapsedRecordCount:function(n){this._totalCollapseRecordCount=n},getCollapsedRecordCount:function(){return this._totalCollapseRecordCount},_colgroupRefresh:function(){var t=n(this.getHeaderTable()).find("colgroup")[0],i=n(this.getContentTable()).find("colgroup")[0],r=n(t).clone(),u=n(i).clone();n(i).remove();n(t).remove();n(r).prependTo(this.getHeaderTable());n(u).prependTo(this.getContentTable())},_init:function(){var t=this,r,i;if(t._trigger("load"),t._initPrivateProperties(),t.model.isdesignMode&&(t.element.css({height:"250px"}),t.model.columns.length===0&&(t.model.columns=[{field:"Column1",HeaderText:"Column1"},{field:"Column2",HeaderText:"Column2"},{field:"Column3",HeaderText:"Column3"}]),t.model.childMapping.length==0&&(t.model.childMapping="Children")),t._processEditing(),t._initDatasource(),t._createTooltipTemplate(),!t.model.isFromGantt&&t.model.enableCollapseAll&&t.collapseAll(),r=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),r&&!t.model.isFromGantt){if(treeGridHeader=t._$gridHeaderContent,treeGridContent=n("#"+t._id+"e-gridcontent"),sizeSettingsWidth=t.model.sizeSettings.width,elementStyleWidth=t.element[0].style.width,sizeSettingsWidth&&sizeSettingsWidth.indexOf("%")!=-1||elementStyleWidth.indexOf("%")!=-1){var u=sizeSettingsWidth?sizeSettingsWidth:elementStyleWidth,f=n(t.element).parent().width()?n(t.element).parent().width():n(t.element).width(),e=f/100*parseInt(u);i=e}else i=n(t.element).width();i=i-t._totalBorderWidth;t._updateScrollCss();n(treeGridHeader).hasClass("e-scrollcss")&&t._$gridContent.children(".e-vscroll").length>0?n(treeGridHeader).width(i-18):n(treeGridHeader).width(i)}},_setModel:function(i){var r=this,f=r.model;for(var u in i)switch(u){case"enableAltRow":f.enableAltRow=i[u];r._addInitTemplate();r.refreshContent();break;case"enableVirtualization":f.enableVirtualization=i[u];r.refreshContent();break;case"allowColumnResize":f.allowColumnResize=i[u];r._enableColumnResizeEvents();break;case"allowSorting":f.allowSorting=i[u];break;case"sortSettings":n.extend(f.sortSettings,i[u]);r.refreshContent();break;case"allowSelection":r.clearSelection();f.allowSelection=i[u];break;case"selectionType":r.clearSelection();f.selectionType=i[u];break;case"selectedRowIndex":this.selectedRowIndex()!=-1&&n.inArray(this.selectedRowIndex(),r._selctedRowsIndexes==-1)&&!t.isNullOrUndefined(this.selectedRowIndex())&&r.selectRows(this.selectedRowIndex());break;case"editSettings":n.extend(f.editSettings,i[u]);r._processEditing();r._enableEditingEvents();break;case"allowKeyboardNavigation":f.allowKeyboardNavigation=i[u];break;case"dataSource":r._refreshDataSource();break;case"columns":n.extend(f.columns,i[u]);r._addInitTemplate();r.refreshContent();break;case"rowHeight":f.rowHeight=i[u];r._addInitTemplate();r.refreshContent();break;case"treeColumnIndex":f.treeColumnIndex=i[u];r._addInitTemplate();r.refreshContent()}},_refreshDataSource:function(){var i=this,r=this.model,u,f;i.resetModelCollections();i._createdAt="load";this.dataSource()instanceof t.DataManager?(u=this.dataSource().executeQuery(r.query),u.done(t.proxy(function(u){if(i._retrivedData=i.dataSource().dataSource.offline?i.dataSource().dataSource.json:u.result,r.idMapping&&r.parentIdMapping){var e=u.result.slice(0),f=[];n.each(e,function(n,t){f.push(jQuery.extend(!0,{},t))});i._reconstructDatasource(f)}else i._reconstructDatasource(u.result);i._createRecords(i.secondaryDatasource);args={};args.requestType=t.TreeGrid.Actions.RefreshDataSource;i._ensureDataSource(args);i.selectedRowIndex()!==-1&&i.selectedRowIndex()<i.model.currentViewData.length&&i.selectRows(i.selectedRowIndex());this._$gridContent.hasClass("e-scroller")&&i._$gridContent.ejScroller("refresh");i._createdAt=null}))):this.dataSource()&&(r.idMapping&&r.parentIdMapping?r.idMapping.length>0&&r.parentIdMapping.length>0&&(f=this.dataSource().slice(0),i._reconstructDatasource(f),i._createRecords(i.secondaryDatasource)):r.flatRecords.length===0&&this.dataSource()!==null&&i._createRecords(this.dataSource()),args={},args.requestType=t.TreeGrid.Actions.RefreshDataSource,i._ensureDataSource(args),this.selectedRowIndex()!==-1&&this.selectedRowIndex()<i.model.currentViewData.length&&i.selectRows(this.selectedRowIndex()),this._$gridContent.hasClass("e-scroller")&&i._$gridContent.ejScroller("refresh"),i._createdAt=null);n(".e-tooltiptable").remove()},refreshContent:function(){var i=this,n={};n.requestType=t.TreeGrid.Actions.Refresh;i.processBindings(n)},resetModelCollections:function(){var t=this,n=t.model;n.currentViewData=[];n.flatRecords=[];n.parentRecords=[];n.records=[];t.secondaryDatasource=[]},_initPrivateProperties:function(){var i=this;i._id=i.element.attr("id");i._columnsWidthCollection=[];i._cSortedColumn=null;i._cSortedDirection=null;i._dataManager=null;i._disabledSortableColumns=[];i._filteredRecords=[];i._disabledToolItems=[];i._filteredColumns=[];proxy_currentFilterColumn=[];i._fieldColumnNames=[];i._multiSortRequest=null;i._$gridContainer=null;i._$gridContent=null;i._$gridContentTable=null;i._$gridHeaderTable=null;i._$gridHeaderContainer=null;i._recordsCount=null;i._$gridRows=null;i._gridRows=null;i._calculateDimensions();i._headerColumnNames=[];i._hiddenColumns=[];i._multiSelectCtrlRequest=!1;i._multiSelectShiftRequest=!1;i._offset=0;i._previousIndex=-1;i._prevRBottom=0;i._prevRTop=0;i._prevScrollTop=0;i._prevScrollLeft=0;i._prevVBottom=0;i._resizer=null;i._scrollTop=0;i._searchString="";i._fieldName="";i._selectedRowsIndexes=[];i._sortedRecords=[];i._storedIndex=-1;i._$tableContent=null;i._tempsortedrecords=[];i._totalHeight=0;i._viewPortHeight=0;i._recordIndexCount=0;i._visibleColumns=[];i._visibleRange=null;i._vScrollDir=1;i._vScrollDist=0;i._cellEditTemplate=n();i._totalBorderWidth=2;i._totalBorderHeight=1;i._cellEditingDetails={cellValue:null,rowIndex:-1,columnIndex:-1,fieldName:null,_data:null,cellEditType:"",cancelSave:!1,defaultData:null,insertedTrCollection:[],data:null};i._tdsOffsetWidth=[];i._isEnterKeyPressed=!1;i._updatedRecords=[];i._scrollBarHeight=18;i._expandCollapseRecordCount=0;i._removedCount=0;i._$gridHeaderContent=null;i._expandedRecordsCount=0;i._totalCollapseRecordCount=0;i._collapsedRecordCount=0;i.secondaryDatasource=[];i._contextMenuItems=i._getContextMenuItems();i._subContextMenuItems=i._getsubContextMenuItems();i._dropDownTemplate=i._compiledDropDownTemplate();i._createSubContextMenuTemplate();i._createContextMenuTemplate();i._retrivedData=this.dataSource();i._createdAt="load";i._dataManager=i.dataSource()instanceof t.DataManager?i.dataSource():i.dataSource()!=null?t.DataManager(i.dataSource()):null},_calculateDimensions:function(){var n=this,t=this.model;t.isFromGantt||(t.sizeSettings.width&&n.element.css("width",t.sizeSettings.width),t.sizeSettings.height?n.element.css("height",t.sizeSettings.height):n.element[0].style.height||n.element.height(350));n._gridHeight=n.element.height();n._gridWidth=n.element.width()},_checkDataBinding:function(){var t=this,i=t.model;t._createdAt=null;t.element.addClass("e-treegrid-core");t.element.attr("tabindex","0");t._renderToolbar();t._renderAfterColumnInitialize();t._viewPortHeight=t._getViewPortHeight();t._ensureDataSource();t._initGridRender();t._$gridContent=n("#"+t._id+"e-gridcontent");t._$gridContainer=n("#"+t._id+"e-gridcontainer");t._$tableContent=n("#"+t._id+"e-table");t._wireEvents();t.setWidthToColumns();t._renderScroller();t._resizeFilteringElements();i.isFromGantt&&t._addEmptyColumntoGrid()},_initDatasource:function(){var i=this,r=i.model,f,e,u;r.isFromGantt?i._checkDataBinding():this.dataSource()instanceof t.DataManager?(f=this.dataSource().executeQuery(r.query),f.done(t.proxy(function(t){if(i._retrivedData=i.dataSource().dataSource.offline?i.dataSource().dataSource.json:t.result,r.idMapping&&r.parentIdMapping){var f=t.result.slice(0),u=[];n.each(f,function(n,t){u.push(jQuery.extend(!0,{},t))});i._reconstructDatasource(u)}else i._reconstructDatasource(t.result);i._createRecords(i.secondaryDatasource);i._checkDataBinding()}))):this.dataSource()?(r.idMapping&&r.parentIdMapping?(e=this.dataSource().slice(0),u=[],n.each(e,function(n,t){u.push(jQuery.extend(!0,{},t))}),i._reconstructDatasource(u),i._createRecords(i.secondaryDatasource)):r.flatRecords.length===0&&this.dataSource()!==null&&i._createRecords(this.dataSource()),i._checkDataBinding()):i._checkDataBinding()},_reconstructDatasource:function(n){for(var r,f=this,u=f.model,e=[],i=0;i<n.length;i++)r={},r=t.DataManager(n).executeLocal(t.Query().where(u.parentIdMapping,t.FilterOperators.equal,n[i][u.idMapping])),(t.isNullOrUndefined(n[i][u.parentIdMapping])||n[i][u.parentIdMapping]==0)&&r.length>0?(n[i][u.childMapping]=r,f.secondaryDatasource.push(n[i])):!t.isNullOrUndefined(n[i][u.parentIdMapping])||r&&r.length>0?r&&r.length>0&&!t.isNullOrUndefined(r[0][u.parentIdMapping])?f._appendChildDataItems(f.secondaryDatasource,r):(t.isNullOrUndefined(n[i][u.parentIdMapping])||n[i][u.parentIdMapping]==0)&&r.length==0&&f.secondaryDatasource.push(n[i]):f.secondaryDatasource.push(n[i]),r&&r.length>0?(f._datasourceChildItems=f._reconstructDatasource(r),t.isNullOrUndefined(n[i][u.childMapping])&&(n[i][u.childMapping]=f._datasourceChildItems,f._getParentIndex(n)),f._datasourceChildItems=[]):t.isNullOrUndefined(n[i][u.parentIdMapping])||e.push(n[i]);if(e&&e.length>0)return e},_appendChildDataItems:function(n,i){for(var f=this,r=f.model,u=0;u<n.length;u++)n[u][r.idMapping]===i[0][r.parentIdMapping]?n[u][r.childMapping]=i:!t.isNullOrUndefined(n[u][r.childMapping])&&n[u][r.childMapping].length>0&&f._appendChildDataItems(n[u],i);t.isNullOrUndefined(n.length)&&n&&(n[r.idMapping]===i[0][r.parentIdMapping]?n[r.childMapping]=i:!t.isNullOrUndefined(n[r.childMapping])&&n[r.childMapping].length>0&&f._appendChildDataItems(n[r.childMapping],i))},_getParentIndex:function(n){var o=this,r=o.model,f=o.secondaryDatasource,e=0,u,i;for(n.length>0&&(e=n[0][r.parentIdMapping]),i=0;i<f.length;i++){if(f[i][r.idMapping]==e&&t.isNullOrUndefined(f[i][r.childMapping]))return f[i][r.childMapping]=n,!0;if(u=f[i][r.childMapping],u)for(i=0;i<u.length;i++)if(u[i][r.idMapping]==e&&t.isNullOrUndefined(u[i][r.childMapping]))return u[i][r.childMapping]=n,!0}},_windowResize:function(){var i=this,f=i._$gridHeaderContent,nt=n("#"+i._id+"e-gridcontent"),e=n("#"+i._id+"_toolbarItems"),o=i.model.sizeSettings.height,s=i.model.sizeSettings.width,v=i.element[0].style.width,y=i.element[0].style.height,r,u,p,w,b,c,l,a,h;if(s&&s.indexOf("%")!=-1||v.indexOf("%")!=-1){var k=s?s:v,d=n(i.element).parent().width()?n(i.element).parent().width():n(i.element).width(),g=d/100*parseInt(k);r=g}else r=n(i.element).width();o&&o.indexOf("%")!=-1||y.indexOf("%")!=-1?(p=o?o:y,w=n(i.element).parent().height()?n(i.element).parent().height():n(i.element).height(),b=n(i.element).parent().height()?w/100*parseInt(p):n(i.element).height(),u=b):u=n(i.element).height();u=u-i._totalBorderHeight;r=Math.round(r-i._totalBorderWidth);c=i._$gridContent.ejScroller("option","scrollTop");l=i._$gridContent.ejScroller("option","scrollLeft");i._$gridContent.ejScroller({width:r,height:u-n(f).outerHeight()-e.outerHeight()});i._updateScrollCss();n(f).hasClass("e-scrollcss")&&i._$gridContent.children(".e-vscroll").length>0?n(f).width(r-18):n(f).width(r);i.model.toolbarSettings.showToolbar&&e.length>0&&(e.width(r),e.children(".e-ul:first-child").width(r));i._$gridContent.ejScroller("refresh");i.updateViewPortHeight();i._$gridContent.ejScroller("option","scrollTop",c);i._$gridContent.ejScroller("option","scrollLeft",l);i._$gridHeaderContainer.scrollLeft(l);i.model.enableVirtualization&&(i.processBindings(),a={},a.requestType=t.TreeGrid.Actions.Refresh,i.sendDataRenderingRequest(a),i.model.currentViewData.length*i.model.rowHeight<i._viewPortHeight&&(h=c-(i._viewPortHeight-i.model.currentViewData.length*i.model.rowHeight),h<0&&(h=0),i._$gridContent.ejScroller("scrollY",h,!0)));i._resizeFilteringElements()},processBindings:function(n){var i=this,r=i.model;if(r.query=new t.Query,i._trigger("actionBegin",n))return!0;i._ensureDataSource(n)},_ensureDataSource:function(i){var r=this,u=r.model,tt=u.sortSettings.sortedColumns,h=!1,e,s,v,w,f,b,l,k,nt,d,g,a,y,c,o,p;if(u.query.requiresCount(),r._queryManagar=u.query,(u.editSettings.allowEditing||u.editSettings.allowAdding)&&i&&i.requestType==t.TreeGrid.Actions.Save&&(!t.isNullOrUndefined(i._cModifiedData)||!t.isNullOrUndefined(i._cAddedRecord))&&(t.isNullOrUndefined(i._cAddedRecord)?n.extend(u.flatRecords[n.inArray(u.selectedItem,u.flatRecords)],i._cModifiedData):(this.selectedRowIndex()===-1?(i._cAddedRecord.hasChildRecords=!1,u.flatRecords.unshift(i._cAddedRecord),u.records.unshift(i._cAddedRecord),this.dataSource().unshift(i._cAddedRecord.item),u.isFromGantt&&u.ids.unshift(i._cAddedRecord.taskId),i.recordIndex=0):(i._cAddedRecord.level=u.selectedItem.level,e=u.selectedItem?u.flatRecords.indexOf(u.selectedItem):0,i._cAddedRecord.level===0&&(e=e>0?e-1:e),i.actionRequestType!=t.TreeGrid.Actions.ContextMenuAdd&&(i.recordIndex=e>0?e-1:0),u.flatRecords.splice(e,0,i._cAddedRecord),w=u.records.indexOf(u.selectedItem),u.records.splice(w,0,i._cAddedRecord),u.isFromGantt&&u.ids.splice(w,0,i._cAddedRecord.taskId.toString()),i._cAddedRecord.level>0&&(v=u.selectedItem.parentItem,v&&(s=v.childRecords?v.childRecords.indexOf(u.selectedItem):-1,s!==-1&&(s=s===0?0:s-1),v.childRecords.splice(s,0,i._cAddedRecord))),r.setRecordsCount(u.flatRecords.length),r.setHeight(u.flatRecords.length*u.rowHeight),r.updateHeight(),h=!0),r._queryManagar.queries=[],u.isEdit=!1,r._updatedGanttRecords=u.flatRecords)),i&&i.requestType===t.TreeGrid.Actions.ExpandCollapse&&(h=!0,r._filteredRecords=[],r._expandCollapseRecordCount=0,r.updateExpandCollapseRecords(i.data,i.expanded),r.setRecordsCount(u.flatRecords.length),r.setHeight(u.flatRecords.length*u.rowHeight),r._updatedRecords=u.flatRecords,u.enableVirtualization||(u.allowSearching&&r._searchString.length&&(r._updateFilteredRecords(r._tempfilteredrecords),r.setRecordsCount(r._filteredRecords.length),r.setHeight(r._filteredRecords*u.rowHeight),r._updatedRecords=r._filteredRecords),u.allowSorting&&u.sortSettings.sortedColumns.length&&(r._updateExpandCollapseForSortedRecords(i.data,i.expanded),r.setHeight(r._sortedRecords*u.rowHeight),r._updatedRecords=r._sortedRecords)),r.updateHeight(),u.enableAltRow&&r._updateAltRow()),u.editSettings.allowDeleting&&i&&i.requestType===t.TreeGrid.Actions.Delete&&(f=i.data,r._removedCount=0,k=r._getFilteredChildRecordsCount(f),k+=1,r._removedCount=0,f.parentItem&&(nt=f.parentItem.childRecords,s=nt.indexOf(f),f.parentItem.childRecords.splice(s,1),u.parentIdMapping||f.parentItem.item[r.model.childMapping].splice(s,1)),d=u.parentRecords.indexOf(f),d!==-1&&u.parentRecords.splice(d,1),b=r.model.flatRecords.indexOf(f),b!==-1&&r.model.flatRecords.splice(b,k),r.setRecordsCount(u.flatRecords.length),r.setHeight((u.flatRecords.length-r._totalCollapseRecordCount)*u.rowHeight),h=!1,e=u.records.indexOf(f),g=r.getChildCount(f,0),u.records.splice(e,g+1),u.ids&&u.ids.splice(e,g+1),r._updatedRecords=u.flatRecords,u.parentIdMapping?(f.hasChildRecords&&f.childRecords.length>0&&r._removeChildItem(f),this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json&&(a=this.dataSource().dataSource.json.indexOf(f.item),a!==-1&&this.dataSource().dataSource.json.splice(a,1)):(a=this.dataSource().indexOf(f.item),a!==-1&&this.dataSource().splice(a,1))):this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json&&(l=this.dataSource().dataSource.json.indexOf(f.item),l!==-1&&r.dataSource().dataSource.json.splice(l,1)):(l=this.dataSource().indexOf(f.item),l!==-1&&r.dataSource().splice(l,1)),u.selectedItem=null,this.selectedRowIndex(-1),!u.isFromGantt&&f.parentItem&&f.parentItem.childRecords.length==0&&(f.parentItem.expanded=!1,f.parentItem.hasChildRecords=!1)),u.allowFiltering&&!u.isFromGantt&&this._filteredColumns.length){for(c=this._filteredColumns[0],y=c.isComplex?c:t.Predicate(c.field,c.operator,c.value,!c.matchcase),o=1;o<this._filteredColumns.length;o++)y=this._filteredColumns[o].isComplex?y.and(this._filteredColumns[o]):y[this._filteredColumns[o].predicate](this._filteredColumns[o].field,this._filteredColumns[o].operator,this._filteredColumns[o].value,!this._filteredColumns[o].matchcase);r._queryManagar.where(y);r._filteredRecords=u.records.filter(function(n){return n.hasChildRecords===!1});p=new t.DataManager(r._filteredRecords);r._tempfilteredrecords=p.executeLocal(r._queryManagar).result;r._updateFilteredRecords(r._tempfilteredrecords);r.setRecordsCount(r._filteredRecords.length);r._updatedRecords=r._filteredRecords;u.allowSorting&&u.sortSettings.sortedColumns.length>0&&r._sortingRecords();r.setHeight(r._updatedRecords.length*u.rowHeight);r.updateHeight();h=!0;u.enableAltRow&&r._updateAltRow()}u.allowSearching&&r._searchString.length||i&&i.requestType==="searching"?(r._queryManagar.search(r._searchString,r.getColumnFieldNames(),t.FilterOperators.contains,!0),r._filteredRecords=u.records.filter(function(n){return n.hasChildRecords===!1}),p=new t.DataManager(r._filteredRecords),r._tempfilteredrecords=p.executeLocal(r._queryManagar).result,r._updateFilteredRecords(r._tempfilteredrecords),r.setRecordsCount(r._filteredRecords.length),r._updatedRecords=r._filteredRecords,u.allowSorting&&u.sortSettings.sortedColumns.length>0&&r._sortingRecords(),r.setHeight(r._updatedRecords.length*u.rowHeight),r.updateHeight(),h=!0,u.enableAltRow&&r._updateAltRow()):u.allowSorting&&tt.length>0&&(h=r._sortingRecords());i&&i.requestType==="outdent"&&(i={},i.requestType=t.TreeGrid.Actions.Refresh,h=!0);h||(r.setRecordsCount(u.flatRecords.length),r.setHeight((u.flatRecords.length-r._totalCollapseRecordCount)*u.rowHeight),r._updatedRecords=u.flatRecords,r.updateHeight());i||(i={},i.requestType=t.TreeGrid.Actions.Refresh);r._updateCurrentViewData();(u.isFromGantt||i.requestType!=="save")&&i.requestType!=="sorting"&&i.requestType!=="searching"&&i.requestType!=="delete"&&i.requestType!=="refreshDataSource"&&i.requestType!="filtering"||(r.renderRecords(i),r._setScrollTop(),r._$gridContent.ejScroller("refresh"),r._updateScrollCss())},_removeChildItem:function(n){for(var r,i,f=this,u=0;u<n.childRecords.length;u++)i=n.childRecords[u],this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json&&(r=this.dataSource().dataSource.json.indexOf(i.item),r!==-1&&this.dataSource().dataSource.json.splice(r,1),i.hasChildRecords&&f._removeChildItem(i)):(r=this.dataSource().indexOf(i.item),r!==-1&&this.dataSource().splice(r,1),i.hasChildRecords&&f._removeChildItem(i))},_processEditing:function(){var t=this,n=t.model;(n.editSettings.allowEditing||n.editSettings.allowAdding)&&(n.editSettings.editMode==="cellEditing"||n.editSettings.editMode.toLowerCase()==="rowediting")&&t._addCellEditTemplate()},_toolBarClick:function(t){var e=this,o=e.model,f=n(this.itemsContainer).closest(".e-treegrid"),u=f.ejTreeGrid("instance"),i=f.attr("id");if(t.event==r&&t.target.tagName=="INPUT"&&t.currentTarget.id==i+"_search"||(u.model.dateFormat.indexOf("hh")!=-1?n.isFunction(n.fn.ejDateTimePicker)&&n("#"+i+"EditForm").find(".e-datepicker").ejDateTimePicker("hide"):n.isFunction(n.fn.ejDatePicker)&&n("#"+i+"EditForm").find(".e-datepicker").ejDatePicker("hide"),f.ejTreeGrid("instance")._trigger("toolBarClick",t)))return!1;switch(t.currentTarget.id){case i+"_add":u._toolbarOperation(i+"_add",t);break;case i+"_edit":u._toolbarOperation(i+"_edit",t);break;case i+"_delete":u._toolbarOperation(i+"_delete",t);break;case i+"_update":u._toolbarOperation(i+"_update",t);break;case i+"_cancel":u._toolbarOperation(i+"_cancel",t);break;case i+"_expandAll":u._toolbarOperation(i+"_expandAll",t);break;case i+"_collapseAll":u._toolbarOperation(i+"_collapseAll",t)}return!1},_toolbarOperation:function(n,t){var u=this.element,o=u.ejTreeGrid("instance"),r=u.attr("id"),i=this,s=this.selectedItem(),f=t.target,e=this.selectedRowIndex();switch(n){case r+"_add":i._startAdd(f);break;case r+"_edit":i._editRow(e);break;case r+"_delete":i.deleteRow();i._cancelSaveTools();break;case r+"_update":i._endEdit();i._cancelSaveTools();break;case r+"_cancel":i.cancelRowEditCell();i._cancelSaveTools();break;case r+"_expandAll":i._expandAll();break;case r+"_collapseAll":i.collapseAll()}return i._refreshToolBar(),!1},_createNewRowInstance:function(n){var t=[];for(var i in n)t.push(i);return t},_startAdd:function(){for(var e,a,t,f,v,i=this,h=this.selectedRowIndex(),o=i.model.editSettings.rowPosition,l=i.model.currentViewData.length,s,w=i._headerColumnNames,c={},p=i._createNewRowInstance(w),y=0;y<p.length;y++)c[p[y]]=null;if(l>0){h==-1&&o!="bottom"&&(o="top");o=="bottom"?(f=l,s=l-1):h!=-1&&o=="aboveSelectedRow"?(f=h,s=h):h!=-1&&o=="belowSelectedRow"?(f=h+1,s=h):(f=0,s=0);var u=i.model.currentViewData[s],b=i._createNewRowInstance(u),t={};(u.parentItem||o=="bottom")&&(t=i._createRecord(c),t.parentItem=u.parentItem,t.level=u.level,t.isAltRow=u.isAltRow,t.index=l+1,u.fromEmpty&&(t.fromEmpty=!0),u.hasChildRecords?o=="belowSelectedRow"?(t.parentItem=u,t.level=u.level+1,u.childRecords.splice(0,0,t)):o=="aboveSelectedRow"&&(e=i.model.currentViewData[s-1],e.hasChildRecords?(t.parentItem=u.parentItem,t.level=u.level,e.childRecords.splice(0,0,t)):(t.parentItem=e.parentItem,t.level=e.level,e.parentItem.childRecords.splice(f,0,t))):u.fromEmpty||(u.parentItem.childRecords.splice(f,0,t),u.parentItem[i.model.childMapping].splice(f,0,t.item)));u.parentItem||(s!=0&&o=="aboveSelectedRow"&&(t=i._createRecord(c),e=i.model.currentViewData[s-1],u.fromEmpty&&(t.fromEmpty=!0,e=i.model.currentViewData[0]),t.parentItem=e.parentItem,t.level=e.level,u.fromEmpty||(e.parentItem?(e.parentItem.childRecords.splice(f,0,t),e.parentItem[i.model.childMapping].splice(f,0,t.item)):i.model.parentRecords.splice(f,0,t))),o=="belowSelectedRow"&&(t=i._createRecord(c),refbelow=i.model.currentViewData[s+1],u.fromEmpty&&(t.fromEmpty=!0,refbelow=i.model.currentViewData[0]),t.parentItem=refbelow.parentItem,t.level=refbelow.level,!u.fromEmpty&&refbelow.parentItem&&(refbelow.parentItem.childRecords.splice(f,0,t),refbelow.parentItem[i.model.childMapping].splice(f,0,t.item))),s==0&&(o=="top"||o=="aboveSelectedRow")&&(t=i._createRecord(c),t.parentItem=u.parentItem,t.childRecords=r,t.level=0,t.index=0,i.model.parentRecords.splice(f,0,t)));a=i._previousIndex;i.clearSelection(a);a!=-1&&(i._updatedRecords[a].isSelected=!1);i.model.currentViewData.splice(f,0,t)}else t=i._createRecord(c),t.parentItem=null,t.level=0,t.index=0,t.fromEmpty=!0,f=t.index,i.model.currentViewData.push(t);t.fromEmpty&&(i.model.parentRecords.splice(f,0,t),v=[],n(n(".e-expandall")[0]).parent("li").hasClass("e-disable")||v.push(n(n(".e-expandall")[0]).parent()[0]),n(n(".e-collapseall")[0]).parent("li").hasClass("e-disable")||v.push(n(n(".e-collapseall")[0]).parent()[0]),n(".e-treegridtoolbar").ejToolbar("disableItem",v));i.selectRows(f);i.renderRecords();i._editRow(f,t)},_editAddTools:function(){var u=this,r=u.model.editSettings,t=[],i;r.allowAdding&&t.push(n(n(".e-addnew")[0]).parent()[0]);r.allowEditing&&!n(n(".e-edit")[0]).parent("li").hasClass("e-disable")&&t.push(n(n(".e-edit")[0]).parent()[0]);r.allowDeleting&&!n(n(".e-delete")[0]).parent("li").hasClass("e-disable")&&t.push(n(n(".e-delete")[0]).parent()[0]);n(".e-treegridtoolbar").ejToolbar("disableItem",t);i=[];i.push(n(n(".e-cancel")[0]).parent()[0]);i.push(n(n(".e-save")[0]).parent()[0]);n(".e-treegridtoolbar").ejToolbar("enableItem",i)},_cancelSaveTools:function(){var t=this,f=t.model,u=t.model.editSettings,i,r;f.isFromGantt?(i=[],u.allowAdding&&t.model.toolbarSettings.toolbarItems.indexOf("add")!==-1&&i.push(n(n(".e-addnewitem")[0]).parent()[0]),u.allowEditing&&t.model.toolbarSettings.toolbarItems.indexOf("edit")!==-1&&t.model.selectedRowIndex!=-1&&i.push(n(n(".e-edititem")[0]).parent()[0]),u.allowDeleting&&t.model.toolbarSettings.toolbarItems.indexOf("delete")!==-1&&t.model.selectedRowIndex!=-1&&i.push(n(n(".e-deleteitem")[0]).parent()[0]),n(".e-gantttoolbar").ejToolbar("enableItem",i),r=[],t.model.toolbarSettings.toolbarItems.indexOf("cancel")!==-1&&r.push(n(n(".e-cancel")[0]).parent()[0]),t.model.toolbarSettings.toolbarItems.indexOf("update")!==-1&&r.push(n(n(".e-saveitem")[0]).parent()[0]),n(".e-gantttoolbar").ejToolbar("disableItem",r)):(i=[],r=[],u.allowAdding&&t.model.toolbarSettings.toolbarItems.indexOf("add")!==-1&&i.push(n(n(".e-addnew")[0]).parent()[0]),u.allowEditing&&t.model.toolbarSettings.toolbarItems.indexOf("edit")!==-1&&(t.model.selectedRowIndex!=-1?i.push(n(n(".e-edit")[0]).parent()[0]):n(n(".e-delete")[0]).parent("li").hasClass("e-disable")||r.push(n(n(".e-edit")[0]).parent()[0])),u.allowDeleting&&t.model.toolbarSettings.toolbarItems.indexOf("delete")!==-1&&(t.model.selectedRowIndex!=-1?i.push(n(n(".e-delete")[0]).parent()[0]):n(n(".e-delete")[0]).parent("li").hasClass("e-disable")||r.push(n(n(".e-delete")[0]).parent()[0])),n(n(".e-cancel")[0]).parent("li").hasClass("e-disable")||r.push(n(n(".e-cancel")[0]).parent()[0]),n(n(".e-save")[0]).parent("li").hasClass("e-disable")||r.push(n(n(".e-save")[0]).parent()[0]),n(".e-treegridtoolbar").ejToolbar("disableItem",r),n(".e-treegridtoolbar").ejToolbar("enableItem",i))},_checkIsEmptyRow:function(n){var i,t;for(i in n)if(t=n[i],t!=" "&&t!=null&&t!="")return!1;return!0},_beginEdit:function(){var n=this;n._trigger("beginEdit",args);n._isinBeginEdit=!0},_endEdit:function(){var t=this,i,r;t._isinBeginEdit=!1;t._trigger("endEdit");i=this.selectedRowIndex();r=t._$gridRows[i];n("tr").hasClass("e-addedrow")||n("tr").hasClass("e-rowedit")?t._saveRow():t.saveCell();t.getUpdatedRecords(i)},_expandAll:function(){var n=this,f=n.model,r=0,i,u={},e=f.enableVirtualization;for(n._isInExpandCollapse=!0,r=0;r<n._updatedRecords.length;r++)i=n._updatedRecords[r],u.data=i,u.recordIndex=r,u.expanded=!0,e?i.hasChildRecords&&!i.expanded&&t.TreeGrid.sendExpandCollapseRequest(n,u):i.hasChildRecords&&!i.expanded&&t.TreeGrid.sendExpandCollapseRequest(n,u);n._isInExpandCollapse=!1;(n._isRowEdit||n.model.isEdit)&&(n.cancelRowEditCell(),n._cancelSaveTools())},_refreshToolBar:function(){var t=n("#"+this._id+"_toolbarItems");t.find("li").removeClass("e-hover")},_renderToolbar:function(){var n=this,i=n.model;if(!i.isFromGantt){var n=this,r=n.element,i=n.model;n.model.toolbarSettings.showToolbar&&(n.model.toolbarSettings.toolbarItems.length==0&&(n.model.toolbarSettings.toolbarItems=[t.TreeGrid.ToolbarItems.Add,t.TreeGrid.ToolbarItems.Edit,]),r.append(n._renderToolbarTemplate()))}},_renderToolbarTemplate:function(){var i=this,f=i.model,u=t.buildTag("div.e-treegridtoolbar#"+i._id+"_toolbarItems","",{height:"36px",border:"1px solid"},{}),e=t.buildTag("ul","",{width:i._gridWidth,"box-sizing":" "},{}),o,r;return!t.isNullOrUndefined(f.toolbarSettings.toolbarItems)&&f.toolbarSettings.toolbarItems.length&&i._renderLi(e),u.append(e),o=t.buildTag("ul"),u.append(o),r={},r.click=i._toolBarClick,r.cssClass="",r.rtl=!1,r.itemSeparator=!1,r.itemLeave=i._toolbarItemLeave,r.width=i._gridWidth,r.fields={id:"",tooltipText:"",imageUrl:"",text:"",imageAttributes:"",spriteCSS:"",htmlAttributes:""},u.ejToolbar(r),u.ejToolbar("disableItem",i._disabledToolItems),i._disabledToolItems=n(),u},_renderLi:function(n){var f=this,r=f.model.toolbarSettings.toolbarItems,e=r.length,i=0,u;for(i;i<e;i++)u=t.buildTag("li","",{},{id:f._id+"_"+r[i],tabindex:"0"}),r[i]!=="search"&&u.css({width:"30px",height:"24px"}),f._renderLiContent(u,r[i]),n.append(u)},_renderLiContent:function(n,i){var r,u,f=this.model.selectedRowIndex,e=this.model.editSettings;switch(i){case"add":r=t.buildTag("span.e-addnew e-toolbaricons e-icon e-treegrid-add","",{});n.attr("title","Add");this.model.editSettings.allowAdding||this._disabledToolItems.push(n.get(0));break;case"edit":r=t.buildTag("span.e-edit e-toolbaricons e-icon e-treegrid-edit","",{});n.attr("title","Edit");this.model.editSettings.allowEditing&&f!=-1||this._disabledToolItems.push(n.get(0));break;case"delete":n.attr("title","Delete");r=t.buildTag("span.e-delete e-toolbaricons e-icon e-treegrid-delete","",{});this.model.editSettings.allowDeleting&&f!=-1||this._disabledToolItems.push(n.get(0));break;case"update":n.attr("title","Update");r=t.buildTag("span.e-save e-toolbaricons e-icon e-treegrid-save e-disabletool","",{});this._disabledToolItems.push(n.get(0));break;case"cancel":n.attr("title","Cancel");r=t.buildTag("span.e-cancel e-toolbaricons e-icon e-treegrid-cancel e-disabletool","",{});this._disabledToolItems.push(n.get(0));break;case"expandAll":n.attr("title","ExpandAll");u=t.buildTag("span.e-expandall e-toolbaricons e-icon e-treegrid-expandall","",{},{});n.append(u);break;case"collapseAll":n.attr("title","CollapseAll");u=t.buildTag("span.e-collapseall e-toolbaricons e-icon e-treegrid-collapseall","",{},{});n.append(u)}n.append(r)},_renderAfterColumnInitialize:function(){var n=this;n.element.append(n._renderGridHeader())},filterEditType:function(n,i){var e=this,o=e.model,r,u,f;t.isNullOrUndefined(n.filterEditType)&&(n.filterEditType="stringedit");switch(n.filterEditType){case"stringedit":i.html(t.buildTag("input.e-ejinputtext e-filtertext e-field e-filterwidth","",{},{id:n.field+"_filterbarcell",name:n.field}));break;case"booleanedit":i.html('<input class="e-field e-checkbox e-filtertext" type ="checkbox" id='+n.field+"_filterbarcell name="+n.field+" />");break;case"numericedit":r=t.buildTag("input.e-numerictextbox e-field","",{width:n.width-15},{type:"text",id:n.field+"_filterbarcell",name:n.field});i.append(r);break;case"datepicker":case"datetimepicker":u=t.buildTag("input.e-"+n.filterEditType+" e-field","",{},{type:"text",id:n.field+"_filterbarcell",name:n.field});i.append(u);break;case"dropdownedit":f=t.buildTag("input.e-field .e-dropdownlist e-field","",{},{type:"text",id:n.field+"_filterbarcell",name:n.field});i.append(f)}},_filteringElements:function(i){var o=this,e=o.model,d=!1,p,l=0,g,nt,u,h,f={},w,a,v,y,s,c,b,k;for(selectedItem=e.selectedItem,i.requestType=="filtering"&&(g=document.getElementById(o._id+"_filterBar"+i.fieldname)),s=a=t.TreeGrid.getColumnByField(e.columns,i.fieldname),p=n(g).find("input,select"),nt=p.length,l;l<nt;l++){if(u=p.eq(l),f={},inputWidth=u.closest("div").width()-2,u.hasClass("e-numerictextbox"))h=inputWidth,w=u.val(),f.width=h,f.showSpinButton=!0,f.cssClass=e.cssClass,f.height=28,c=u[0].id,c=c.replace(o._id,""),e.filterBarMode=="immediate"&&(f.change=n.proxy(o._filterBarHandler,o,u)),f.value=w.length?parseFloat(w):null,a=t.TreeGrid.getColumnByField(o.model.columns,u.prop("name")),t.isNullOrUndefined(a.editParams)||n.extend(f,a.editParams),u.ejNumericTextbox(f),u.prop("name",u.prop("name").replace(o._id,""));else if(u.hasClass("e-datepicker"))h=inputWidth,f.width=h,f.cssClass=e.cssClass,f.dateFormat=e.dateFormat,f.locale=e.locale,f.displayDefaultDate=!0,f.height=28,c=u[0].id,c=c.replace(o._id,""),e.filterBarMode=="immediate"&&(f.select=n.proxy(o._filterBarHandler,o,u)),s=t.TreeGrid.getColumnByField(o.model.columns,u.prop("name")),s.format!==r&&s.format.length>0&&(v=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),y=v.exec(s.format),f.dateFormat=y[2]),t.isNullOrUndefined(s.editParams)||n.extend(f,s.editParams),e.dateFormat.indexOf("hh")!=-1?u.ejDateTimePicker(f):u.ejDatePicker(f);else if(u.hasClass("e-datetimepicker"))h=inputWidth,f={width:h,rtl:e.rtl,locale:e.locale,cssClass:e.cssClass,showButton:!1},f.height=28,s=t.TreeGrid.getColumnByField(o.model.columns,u.prop("name")),s.format!==r&&s.format.length>0&&(v=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),y=v.exec(s.format),f.dateTimeFormat=y[2]),t.isNullOrUndefined(s.editParams)||n.extend(f,s.editParams),e.dateFormat.indexOf("hh")!=-1?u.ejDateTimePicker(f):u.ejDatePicker(f);else if(u.hasClass("e-dropdownlist"))s=t.TreeGrid.getColumnByField(o.model.columns,u.prop("name")),b=s.dropdownData,k=!1,selectedItem!==null&&selectedItem.hasChildRecords&&i.requestType!=="add"&&(k=!0),u.ejDropDownList({width:inputWidth,showCheckbox:!0,dataSource:b,readOnly:k,height:28,fields:{id:e.resourceIdMapping,text:e.resourceNameMapping,value:e.resourceNameMapping},selectedItems:o.getIndexofresourceInfo(b,i.data)}),u.ejDropDownList("setSelectedValue",u.val());else switch(u.prop("tagName")){case"INPUT":u.width(inputWidth-4);break;case"SELECT":u.width(inputWidth).height(15)}u.is(":disabled")||d||u.is(":hidden")&&typeof u.data("ejDropDownList")!="object"||o._isEnterKeyPressed||(d=!0)}},_renderFiltering:function(){for(var r,e,u=this,i=this.model.columns,f=t.buildTag("tr.e-filterbar","",{},{}),n=0;n<this.model.columns.length;n++)if(u.model.allowFiltering)if(r=t.buildTag("th.e-filterbarcell .e-editValue","",{},{}),$div=t.buildTag("div.e-filterdiv","",{},{id:u._id+"_filterBar"+i[n].field}),f.append(r.append($div)),i[n].allowFiltering==!1)continue;else this.filterEditType(i[n],$div,n),e=t.buildTag("span.e-cancel e-icon e-hide e-spanstyle"),this.model.columns[n].visible===!1&&r.addClass("e-hide"),$div.append(e);return f},_renderGridHeader:function(){var f=this,e=f.model,s=document,h=t.buildTag("div.e-gridheadercontainer","",{overflow:"hidden"},{}),c=t.buildTag("table.e-table","",{},{cellspacing:"0px","border-spacing":"0px"}),p=t.buildTag("thead"),g=t.buildTag("tbody.e-hide"),l=t.buildTag("tr.e-columnheader"),w=n(s.createElement("colgroup")),k=n(s.createElement("tr")),i=0,u=e.columns,d=u.length,o,b,a,v,y=e.isFromGantt?t.buildTag("div.e-gridheader#"+f._id+"e-gridheader","",{},""):t.buildTag("div.e-gridheader#"+f._id+"e-gridheader","",{"border-top-style":"solid","border-left-style":"solid","border-right-style":"solid","border-top-width":"1px","border-left-width":"1px","border-right-width":"1px",width:f._gridWidth},"");for(f.setGridHeaderContent(y),f._$gridHeaderContainer=h,f._hiddenColumns=[],e.allowSorting&&l.css({cursor:"pointer"}),i;i<d;i++)u[i]&&(o=t.buildTag("th.e-headercell","",{height:"45px"},{}),b=s.createElement("td"),a=t.buildTag("div.e-headercelldiv",u[i].headerText==r?u[i].headerText=u[i].field:u[i].headerText,{},{unselectable:"on"}),o.append(a),v=s.createElement("col"),k.append(b),l.append(o),w.append(v),u[i].visible===!1?o.addClass("e-hide")&&n(v).css("display","none")&&f._hiddenColumns.push(u[i].headerText):(f._visibleColumns.push(u[i].headerText),u[i].visible=!0),u[i].allowSorting===!1&&(f._disabledSortableColumns.push(u[i].headerText),o.css({cursor:"normal"})),t.isNullOrUndefined(u[i].headerTemplateID)||a.html(n(u[i].headerTemplateID).hide().html()).parent().addClass("headertemplate"),u[i].width==r&&e.commonWidth!==r?f._columnsWidthCollection[i]=e.commonWidth:f._columnsWidthCollection.push(u[i].width),f._fieldColumnNames[u[i].headerText]=u[i].field,f._headerColumnNames[u[i].field]=u[i].headerText);return $filterHeader=t.buildTag("tr.e-filterbar"),this.model.allowFiltering&&!f.model.isFromGantt&&($filterHeader=this._renderFiltering()),p.append(l).append($filterHeader),c.append(w).append(p),h.html(c),y.html(h),f.setGridHeaderTable(c),y},_initGridRender:function(){var n=this;n._addInitTemplate();n._renderGrid();n.model.allowColumnResize&&(n._resizer=new t.Grid.gridResize(n))},_renderGrid:function(){var n=this;n._renderGridContent().insertAfter(n.element.children(".e-gridheader"));n._initialEndRendering()},_renderGridContent:function(){var i=this,o=document,r=i.model,s=n(o.createElement("tbody")),e=t.buildTag("div.e-gridcontent#"+i._id+"e-gridcontent","",{height:i._viewPortHeight},{unselectable:"on"}),f=t.buildTag("div.e-gridcontainer#"+i._id+"e-gridcontainer","",{},{}),u,h;return r.enableVirtualization&&f.css({height:i._totalHeight}),u=t.buildTag("table.e-table#"+i._id+"e-table","",{top:"0px"},{cellspacing:"0px"}),u.append(i.getHeaderTable().find("colgroup").clone()).append(s),f.html(u),e.html(f),i.setGridContentTable(u),this.dataSource()===null?(h=t.buildTag("td",r.emptyRecordText,{},{colSpan:r.columns.length}),s.append(n(o.createElement("tr")).append(h)),f.css("height",r.rowHeight)):i.renderRecords(),r.isFromGantt||e.css({"border-bottom-style":"solid","border-bottom-width":"1px","border-left-style":"solid","border-left-width":"1px","border-right-style":"solid","border-right-width":"1px",width:"auto",height:"auto"}),u.css({position:"relative"}),e},_initialEndRendering:function(){var n=this,t=n.selectedRowIndex();t!=-1&&n.model.allowSelection&&(n._rowSelectingEventTrigger()||(n.selectRows(t),n._rowSelectedEventTrigger(t)))},_addCellEditTemplate:function(){for(var i=this,e=i.model,r=e.columns,n=0,u=t.buildTag("div","",{display:"none"},{id:i._id+"_CellEditTemplate"}),f,o=r&&r.length,n=0;n<o;n++)r[n]&&(f=t.buildTag("div","",{},{id:r[n].field+"_CellEdit"}),t.TreeGrid._initCellEditType(i,f,i._id,n),u.append(f));u.children().length&&(i._cellEditTemplate=u)},_addInitTemplate:function(){var i=this,r=i.model,c=r.columns,e=0,ut=c.length,s,v,o={},f,a,y,u,b,k,p,nt,w,tt;if(c.length===0)return!1;if(o["_"+i._id+"rowClassName"]=t.TreeGrid._getrowClassName,o["_"+i._id+"expandStatus"]=n.proxy(i._getExpandStatusRecord,i),o["_"+i._id+"cellValue"]=i._getCellValue,o["_"+i._id+"getIndentWidth"]=n.proxy(i._getIndentWidth,i),o["_"+i._id+"checkColumn"]=n.proxy(i._getCellColumn,i),o._treeGridTemplating=t.proxy(i._gridTemplate,null,i),o["_"+i._id+"itemDetails"]=n.proxy(i._convertItemToString,i),n.views.helpers(o),r.rowTemplateID.length>0){var l=t.buildTag("tbody","",{},{}),h=t.buildTag("tbody","",{},{}),d="",g="",ft=r.altRowTemplateID.length>0?n("#"+r.altRowTemplateID)[0].innerHTML:n("#"+r.rowTemplateID)[0].innerHTML;if(n(l[0]).html(ft),n(h[0]).html(n("#"+r.rowTemplateID)[0].innerHTML),h[0].childNodes.length>0)for(f=0;f<h[0].childNodes.length;f++)if(h[0].childNodes[f].nodeName=="TR"&&(h[0].className=h[0].childNodes[f].className,h[0].style.cssText=h[0].childNodes[f].style.cssText,h[0].childNodes[f].childNodes.length>0))for(a=0,y=0;y<h[0].childNodes[f].childNodes.length;y++)u=h[0].childNodes[f].childNodes[y],u.nodeName=="TD"&&(b=u.innerHTML,n("#"+i._id+"RowTemplateElement"+a).remove(),w=this._createRowTemplateElement(b,a),u.innerHTML="{{:~_treeGridTemplating('"+w.id+"')}}",u.className+=" e-rowcell e-templatecell",a==r.treeColumnIndex?(k="<div  style='height:20px;' unselectable='on'><div class='intend' style='height:1px; float:left;width:{{:~_"+i._id+"getIndentWidth(#data)}}; display:inline-block;'><\/div><div class='{{if expanded}}e-treegridexpand e-icon{{else hasChildRecords}}e-treegridcollapse e-icon{{/if}}' style='height:20px;width:30px;margin:auto;float:left;margin-left:10px;style='float: left;display:inline-block; unselectable='on'><\/div><div class='e-cell' style='display:inline-block;width:100%' unselectable='on'>",d+="<td class='"+u.className+"{{if isSelected}}e-selectionbackground{{/if}}' style='"+u.style.cssText+"'>"+k+u.innerHTML+"<\/div><\/div><\/td>"):d+=u.outerHTML,a++);if(l[0].childNodes.length>0)for(f=0;f<l[0].childNodes.length;f++)if(l[0].childNodes[f].nodeName=="TR")for(l[0].className=l[0].childNodes[f].className,l[0].style.cssText=l[0].childNodes[f].style.cssText,a=0,y=0;y<l[0].childNodes[f].childNodes.length;y++)u=l[0].childNodes[f].childNodes[y],u.nodeName=="TD"&&(b=u.innerHTML,n("#"+i._id+"RowTemplateElement"+a).remove(),w=this._createRowTemplateElement(b,a),u.innerHTML="{{:~_treeGridTemplating('"+w.id+"')}}",u.className+=" e-rowcell e-templatecell",a==r.treeColumnIndex?(k="<div  style='height:20px;' unselectable='on'><div class='intend' style='height:1px; float:left;width:{{:~_"+i._id+"getIndentWidth(#data)}}; display:inline-block;'><\/div><div class='{{if expanded}}e-treegridexpand e-icon{{else hasChildRecords}}e-treegridcollapse e-icon{{/if}}' style='height:20px;width:30px;margin:auto;float:left;margin-left:10px;style='float: left;display:inline-block; unselectable='on'><\/div><div class='e-cell' style='display:inline-block;width:100%' unselectable='on'>",g+="<td class='"+u.className+"{{if isSelected}}e-selectionbackground{{/if}}' style='"+u.style.cssText+"'>"+k+u.innerHTML+"<\/div><\/div><\/td>"):g+=u.outerHTML,a++);p="{{if isAltRow}}<tr class='{{:~_"+i._id+"rowClassName()}} {{if expanded}}e-treegridrowexpand {{else hasChildRecords}} e-treegridrowcollapse {{/if}} e-templaterow"+l[0].className+"'  style='"+l[0].style.cssText+"'>"+g+"<\/tr>{{else}}<tr class='{{:~_"+i._id+"rowClassName()}} {{if expanded}}e-treegridrowexpand {{else hasChildRecords}} e-treegridrowcollapse {{/if}} e-templaterow"+h[0].className+"'  style='"+h[0].style.cssText+"'>"+d+"<\/tr>{{/if}}"}else{for(p="<tr class='e-treegridrows {{:~_"+i._id+"rowClassName()}} ",r.enableAltRow&&(p+="{{if isAltRow}}e-alt-row{{/if}} "),nt="",e=0;e<ut;e++)if(c[e]){if(s=c[e].field,c[e].isTemplateColumn){p+="e-templaterow ";var it=c[e].templateID,rt=c[e].template,et=c[e].angularTemplate;et?(n("#"+i._id+c[e].headerText+e+"_Template").remove(),w=this._createTemplateElement(c[e]),v="<td style=''class='{{if isSelected}}e-rowcell e-selectionbackground e-intend {{else}}e-rowcell e-intend {{/if}} e-templatecell'role='gridcell''tabindex='-1'>{{:~_treeGridTemplating('"+w.id+"')}}<\/td>"):it?v="<td style=''class='{{if isSelected}}e-rowcell e-selectionbackground e-intend {{else}}e-rowcell e-intend {{/if}} e-templatecell'role='gridcell''tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}}>"+n("#"+it)[0].innerHTML+"<\/td>":rt&&(v="<td class='{{if isSelected}}e-rowcell e-selectionbackground e-intend {{else}}e-rowcell e-intend {{/if}} e-templatecell'role='gridcell'tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}}>"+rt+"<\/td>")}else e===r.treeColumnIndex?v="<td class='{{if isSelected}}e-rowcell e-selectionbackground e-intend {{else}}e-rowcell e-intend {{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+i._id+"checkColumn('"+s+"',#data)=='"+s+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='gridcell'tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}}><div  style='height:20px;' unselectable='on'>{{if hasChildRecords}}<div class='intend'style='height:1px; float:left; width:{{:level*20}}px; display:inline-block;'><\/div>{{else !hasChildRecords}}<div class='intend'style='height:1px; float:left; width:{{:(level+1)*20}}px; display:inline-block;'><\/div>{{/if}}<div class='{{if expanded}}e-treegridexpand e-icon{{else hasChildRecords}}e-treegridcollapse e-icon{{/if}}'style='float: left;display:inline-block; font-size:10px; unselectable='on''><\/div><div class='e-cell'style='display:inline-block;width:100%;' unselectable='on'>{{:#data['"+s+"']}}<\/div><\/div><\/td>":r.isFromGantt&&c[e].mappingName===r.resourceInfoMapping?(o={},o["_"+i._id+"resourceName"]=i._getResourceName,n.views.helpers(o),v="<td  class='{{if isSelected}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+i._id+"checkColumn('"+s+"',#data)=='"+s+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='gridcell'tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}}>{{:~_"+i._id+"resourceName('"+i._id+"Object','"+r.resourceNameMapping+"','"+s+"')}}<\/td>"):r.isFromGantt&&c[e].mappingName===r.predecessorMapping?(o={},o["_"+i._id+"predecessor"]=i._getPredecessorsValue,n.views.helpers(o),v="<td class='{{if isSelected}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}}' style='background-color:{{if cellBackgroundColor && ~_"+i._id+"checkColumn('"+s+"',#data)=='"+s+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='gridcell'tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}}>{{:~_"+i._id+"predecessor('"+i._id+"Object','"+r.predecessorMapping+"','"+s+"')}}<\/td>"):v="<td class='{{if isSelected}}e-rowcell e-selectionbackground{{else}}e-rowcell{{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+i._id+"checkColumn('"+s+"',#data)=='"+s+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='gridcell'tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}} unselectable='on'>{{:~_"+i._id+"cellValue('"+s+"')}}<\/td>";nt+=v}p+="{{if expanded}}e-treegridrowexpand {{else hasChildRecords}} e-treegridrowcollapse {{/if}} 'style='background-color:{{if rowBackgroundColor }}{{:rowBackgroundColor}}{{else}}none{{/if}}; height:"+r.rowHeight+"px;display:{{:~_"+i._id+"expandStatus(#data)}}'role='row'>";p+=nt;r.isFromGantt&&(p+="<td class='e-extendcolumn'><\/td><\/tr>")}tt={};tt[i._id+"_Template"]=p;n.templates(tt)},_gridTemplate:function(n,t){return n._renderEjTemplate("#"+t,this.data,this.data.index)},_getIndentWidth:function(n){var t=n.level;return n.hasChildRecords?t*20+"px":(t+1)*20+"px"},_createRowTemplateElement:function(t,i){var r=document.createElement("script");return r.id=("treeGridRowTemplateElement"+i).split("").join(""),r.type="text/x-template",r.text=t,n("body").append(r),r},_createTemplateElement:function(t){var i=document.createElement("script");return i.id=("treeGrid"+t.headerText+n.inArray(t,this.model.columns)+"_Template").split(" ").join(""),i.type="text/x-template",i.text=n(t.angularTemplate).html(),n("body").append(i),i},_convertItemToString:function(n){for(var u,f="",i={},r=this.model.columns,t=0;t<r.length;t++)r[t]&&(i[r[t].field]=n.item[r[t].field]);for(u in i)i.hasOwnProperty(u)&&(f+=u+""+i[u]+"\n");return f},_getCellValue:function(n){var t=this.data[n];return t||t===0?t:this.data.item&&this.data.item[n]},_getCellColumn:function(n,t){var i=this;return t.treeMappingName.indexOf(n)!==-1?n:"none"},_getResourceName:function(n,t,i){var e=this,r=e.data[i],u=0,o=r&&r.length,f=[];if(r&&r.length>0)for(u;u<o;u++)f.push(r[u][t]);return f},_getPredecessorsValue:function(n,t){return this.data.item[t]},_getExpandStatusRecord:function(n){var t=this;return t.getExpandStatus(n)?"table-row":"none"},_createRecords:function(n){var i=this,u=i.model,f=u.flatRecords,e=n.length,r=0,t,o=u.parentRecords,s=u.records;for(r;r<e;r++)t=i._createRecord(n[r],0,null),i._storedIndex++,t.isAltRow=i._storedIndex%2==0?!1:!0,o.push(t),t.index=i._storedIndex,s[i._storedIndex]=t,f.push(t),t.childRecords&&i._addNestedRecords(t.childRecords)},_createRecord:function(i,u,f,e){var s=this,o,h=i[s.model.childMapping],c=this.model,l;return o=n.extend({},i),c.parentIdMapping&&s._createdAt==="load"?(l=t.DataManager(s._retrivedData).executeLocal(t.Query().where(c.idMapping,t.FilterOperators.equal,o[c.idMapping])),o.item=l[0]):this.dataSource()instanceof t.DataManager&&this.dataSource().dataSource.json&&this.dataSource().dataSource.offline&&s._createdAt==="load"?(l=t.DataManager(s._retrivedData).executeLocal(t.Query().where(c.idMapping,t.FilterOperators.equal,o[c.idMapping])),o.item=l.length>0?l[0]:i):o.item=i,o.parentItem=f,o.childRecords=h&&s._createChildRecords(h,u+1,o),o.hasChildRecords=h?!0:!1,o.expanded=e!==r?e:h?h.length>0:!1,o.isSelected=!1,o.level=u,o.cellBackgroundColor=null,o.rowBackgroundColor=null,o.treeMappingName=[],o},_createChildRecords:function(n,t,i){for(var o=this,f=[],r=0,s=n.length,u=null,e,r=0;r<s;r++)u=n[r],u&&(e=o._createRecord(u,t,i),f.push(e));return f},_addNestedRecords:function(n){for(var t=this,o=t.model,s=o.flatRecords,u=0,c=n.length,h=o.records,f=[],r,u=0;u<c;u++)if(r=n[u],t._storedIndex++,r.isAltRow=t._storedIndex%2==0?!1:!0,r.index=t._storedIndex,h[t._storedIndex]=r,s.push(r),f=r.childRecords,f)for(var e=0,l=f.length,i=null,e=0;e<l;e++)i=f[e],t._storedIndex++,i.index=t._storedIndex,i.isAltRow=t._storedIndex%2==0?!1:!0,h[t._storedIndex]=i,s.push(i),i.childRecords&&t._addNestedRecords(i.childRecords)},_wireEvents:function(){var i=this,r=i.model;i._$gridContent.bind("scroll",n.proxy(i._onScroll,i));i._on(i.element,"click",i._onClick);i._on(i.element,"click","#"+i._id+"e-gridheader",i._onHeaderClick);i._on(i.element,"mousedown","#"+i._id+"e-gridheader",i._headerMouseDown);r.filterBarMode=="immediate"&&(this._on(this.element,"keyup",".e-filterbarcell input",this._filterBarHandler),this._off(this.element,"click",".e-checkbox")._on(this.element,"click",".e-checkbox",this._filterBarHandler));this._on(this.element,"focus click",".e-filterbarcell input",this._filterBarClose);this._on(this.element,"click",".e-filterbarcell .e-cancel",this._filterBarClose);i.model.showGridCellTooltip&&!i.model.showGridExpandCellTooltip?t.browserInfo().name=="msie"?i._on(i.element,"mouseenter",".e-rowcell",i._mouseHover):i._on(i.element,"mousemove",".e-rowcell",i._mouseHover):i._on(i.element,"mouseenter",".e-rowcell",i._mouseHover);i._on(i.element,"mouseleave",".e-rowcell",i._cellMouseLeave);i._enableColumnResizeEvents();r.isFromGantt&&i._on(i.element,"mousewheel DOMMouseScroll",i._mouseWheel);r.enableResize&&!r.isFromGantt&&i._on(n(window),"resize",i._windowResize);i._enableEditingEvents();!i.model.isFromGantt&&r.contextMenuSettings.showContextMenu&&i._on(i.element,"contextmenu",i._rightClick)},_filterBarClose:function(t){var i=n(t.target),r;t.type=="click"&&i.hasClass("e-cancel")&&(r=i.prev(),r.focus().val(""),r.prop("checked",!1),r.trigger("keyup"),t.stopPropagation());t.type=="focusin"&&(i=n(t.target).next(),this.getHeaderTable().find(".e-cancel").addClass("e-hide"),i.removeClass("e-hide"))},_filterBarHandler:function(i){var u=this,e,o,h,c,s,f;if(u.clearSelection(u.selectedRowIndex),e=i.target==r?n(i):n(i.target),this.model.allowFiltering){for(o=u.model.columns,h=u._cellEditingDetails,c=u._queryManagar.queries[0],u._searchString=e.hasClass("e-checkbox")?e[0].checked:e.closest("input").val(),s=e[0].id.split("_"),u._fieldName=s[0],this._currentFilterColumn=o[f],f=0;f<o.length;f++)if(o[f].field==s[0]){this._currentFilterColumn=o[f];break}u._validateFilterValue(u._searchString);u.filterColumn(u._fieldName,this._operator,u._searchString,this._predicate);u.model.currentViewData.length>0&&t.TreeGrid.updateAltRow(u,u.model.currentViewData[0],0,0)}},_validateFilterValue:function(n){var i=this,u;this._predicate="and";switch(this._currentFilterColumn.filterEditType){case"numericedit":this._operator=t.FilterOperators.equal;break;case"datepicker":this._operator=t.FilterOperators.equal;u=this._currentFilterColumn.format==""||this._currentFilterColumn.format==r?Globalize.culture().calendar.patterns.d:this._currentFilterColumn.format.split(":")[1].replace("}","");this._currentFilterbarValue!=""&&(this._currentFilterbarValue=Globalize.format(n,u));break;case"datetimepicker":this._operator=t.FilterOperators.equal;u=this._currentFilterColumn.format==""?Globalize.culture().calendar.patterns.f:this._currentFilterColumn.format.split(":")[1].replace("}","");this._searchstring!=""&&(this._searchstring=Globalize.format(n,u));break;case"stringedit":this._operator=t.FilterOperators.startsWith;break;case"booleanedit":i._searchString==!0||i._searchString=="1"?i._searchString=!0:(i._searchString=="false"||i._searchString=="0")&&(i._searchString=!1);this._operator=t.FilterOperators.equal;break;default:this._operator=t.FilterOperators.equal}},_mouseHover:function(i){i.preventDefault();var u=n(i.target),r=this,f=0,e=0,l=r.getRows(),a=u.closest("tr"),s=u[0].parentNode,v=l.index(a),c=r.model.currentViewData[v],y,h,o;r._cellMouseLeave();i||(i=window.event);i.originalEvent.pageX||i.originalEvent.pageY?(f=i.originalEvent.pageX,e=i.originalEvent.pageY):(i.originalEvent.clientX||i.originalEvent.clientY)&&(f=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop);f+200>r._windowWidth&&(f-=f+200-r._windowWidth);e+150>r._windowHeight&&(e-=e+150-r._windowHeight);c&&(y={ttiptaskname:c.taskName},h=t.buildTag("table.e-tooltiptable","",{padding:"0"},{cellspacing:"1"}),r.model.showGridExpandCellTooltip==!1?u[0].firstChild&&u[0].firstChild.textContent?o=t.buildTag("tbody",u[0].firstChild.textContent,{},{}):s.childNodes.length>0&&s.childNodes[1]&&s.childNodes[1].textContent&&(o=t.buildTag("tbody",s.childNodes[1].textContent,{},{})):r.model.showGridExpandCellTooltip==!0&&u[0].firstChild&&u[0].firstChild.childNodes.length>0&&u[0].firstChild&&u[0].firstChild.textContent&&(o=t.buildTag("tbody",u[0].firstChild.textContent,{},{})),h.append(o),o&&(!r.model.showGridExpandCellTooltip&&r.model.showGridCellTooltip==!0&&u[0].firstChild||r.model.showGridExpandCellTooltip&&r.model.showGridCellTooltip==!0)&&(r._mouseOverTooltip=t.buildTag("div.e-tooltipgantt#tooltipgantt"+r._id+"",h,{top:e+10+"px",left:f+15+"px",position:"absolute","z-index":"5",padding:"0","border-radius":"3px"},{}),n(document.body).append(r._mouseOverTooltip)))},_cellMouseLeave:function(){var t=this;n("#tooltipgantt").remove();n(t._mouseOverTooltip).remove()},disableTooltip:function(){this._cellMouseLeave()},_createTooltipTemplate:function(){var i=this,u,e=i.model.columnHeaderTexts,f={_getTaskName:i._tooltipTaskName},t,r;n.views.helpers(f);t="<tr class='e-tooltip_rowcell'>";u="{{if ~_getTaskName()}}<td class='e-tooltiptaskname' style='height:auto;width:auto;font-weight:normal;'>{{:ttiptaskname}}<\/td>{{/if}}";t+=u;t+="<\/tr>";r={};r[i._id+"tooltipTemplate"]=t;n.templates(r)},_tooltipTaskName:function(){return this.data.ttiptaskname},_onScroll:function(n){var t=this,i;t._popupHide();t.model.showGridCellTooltip&&t._cellMouseLeave();n.scrollLeft!=r&&(t._scrollLeft=n.scrollLeft,i=Math.abs(t._scrollLeft-t._prevScrollLeft));i&&(t._$gridHeaderContainer.scrollLeft(t._scrollLeft),t._prevScrollLeft=t._scrollLeft);n.scrollTop!=r&&t.model.enableVirtualization&&(t._scrollTop=n.scrollTop,t._vScrollDir=t._prevScrollTop<=t._scrollTop?1:-1,t._vScrollDist=Math.abs(t._scrollTop-t._prevScrollTop),t._vScrollDist&&(t._updateCurrentViewData(),t._prevScrollTop=t._scrollTop))},_saveRow:function(){var r,f,u;for(proxy=this,form=n(document.getElementById(proxy._id+"EditForm")),formElement=n(form).find("td"),r=proxy.selectedRowIndex(),form.closest("tr").hasClass("e-addedrow")&&(r=form.closest("tr").index()),proxy._currentViewData=proxy.getCurrentViewData(),i=0;i<this.model.columns.length;i++)column=this.model.columns[i],value=proxy.getCurrentEditCellDataForRowEdit(column.field,column.editType,i),proxy._currentViewData[r][column.field]=proxy._currentViewData[r].item[column.field]=value;f=proxy._currentViewData[r].item;u=proxy._checkIsEmptyRow(f);u&&proxy.cancelRowEditCell();proxy.refreshRow(r);proxy._isRowEdit=!1;proxy.model.currentViewData.length>0&&t.TreeGrid.updateAltRow(proxy,proxy._currentViewData[0],0,0);proxy._cancelSaveTools();u||proxy.selectRows(r);proxy.refreshContent()},_onClick:function(r){var u=this,o=u.model,f=n(r.target),a,y,s,e;if(u._popupHide(),f.hasClass("e-icon")&&f.hasClass("e-down-arrow"))for(column=u.model.columns,object=null,i=0;i<column.length;i++)column[i].editType=="dropdownedit"&&(a=n("#"+u._id+column[i].field).data("ejDropDownList"),a&&(object=a.popupList),object&&object.hide()&&(n(object.show()),topposition=r.clientY+15,n(object).css({top:topposition})));for(y="",s=u.model.columns,n("#"+u._id+"EditForm").length==0&&u.element[0].focus(),u._clearContextMenu(),i=0;i<s.length;i++)s[i]&&(s[i].filterEditType=="datepicker"||s[i].filterEditType=="datetimepicker")&&(dateobj=n("#"+s[i].field+"_filterbarcell").data("ejDatePicker"),dateobj&&dateobj.length>0&&dateobj.hide());if(this.getHeaderTable().find(".e-cancel").addClass("e-hide"),f.hasClass("e-treegridexpand")||f.hasClass("e-treegridcollapse")){var c=f.closest("tr"),p=u.getRows(),w=p.index(c),h=o.currentViewData&&o.currentViewData[w],l=u._updatedRecords.indexOf(h),e={},v;e.data=h;e.recordIndex=l;e.expanded=c.hasClass("e-treegridrowexpand")?!1:!0;v=e.expanded?u._trigger("expanding",e):u._trigger("collapsing",e);v||o.isFromGantt||t.TreeGrid.sendExpandCollapseRequest(u,e)}else if(f.hasClass("e-rowcell")||f.parent().hasClass("e-rowcell")||f.closest("tr").hasClass("e-templaterow")||f.closest("td").hasClass("e-rowcell")&&f.hasClass("e-cell")){if(!o.allowSelection)return;o.selectionType==t.TreeGrid.SelectionType.Multiple&&(r.ctrlKey&&(u._multiSelectCtrlRequest=!0),r.shiftKey&&(u._multiSelectShiftRequest=!0,u.selectRows(u._previousIndex,u.getRows().index(f.closest("tr")))));u._multiSelectShiftRequest||n("#"+u._id+"EditForm").length!=0||(l=u.getRows().index(f.closest("tr")),l!=-1&&(h=o.currentViewData[l],e={rowElement:c,recordIndex:this.selectedRowIndex()},u._trigger("rowSelecting",e)||(o.selectedItem=h,this.selectedRowIndex(u._updatedRecords.indexOf(h)),u.selectRows(this.selectedRowIndex()),e={rowElement:c,data:u.model.selectedItem,target:"ejTreeGrid",recordIndex:this.selectedRowIndex()},u._cancelSaveTools(),u._trigger("rowSelected",e))));u._multiSelectShiftRequest=!1;u._isRowEdit&&(f.focus(),f.parents("form").length==0&&u._saveRow())}u._isRowEdit&&f.focus()},_onHeaderClick:function(i){var r=this,e=r.model,u,o,s,h,f;if(r._cellMouseLeave(),r._clearContextMenu(),n(i.target).is(".e-ascending, .e-descending")&&(i.target=i.target.parentNode),u=n(i.target),r.getHeaderTable().find(".e-columnheader").find(".e-headercellactive").removeClass("e-headercellactive"),u.hasClass("e-headercelldiv")){if(!e.allowSorting)return!1;r._isRowEdit=!1;o=n.trim(u.text());s=u.find("span").hasClass("e-ascending")?t.sortOrder.Descending:t.sortOrder.Ascending;e.allowMultiSorting&&i.ctrlKey&&(r._multiSortRequest=!0);r.sortColumn(o,s);h=r.selectedRowIndex();r.selectRows(h);r.model.isFromGantt&&this.selectedRowIndex()>=0&&(f={},f.data=r.model.selectedItem,f.target="ejTreeGrid",f.recordIndex=this.selectedRowIndex(),r._trigger("rowSelected",f))}return u.hasClass("e-checkbox")?!0:!1},_headerMouseDown:function(t){var i=this,r=i.model,u;i._cellMouseLeave();r.allowColumnResize&&i._resizer._mouseDown(t);n(t.target).hasClass("headercelldiv")&&n(t.target).hasClass("headercell")&&(u=n(t.target).hasClass("headercelldiv")?n(t.target).parent():n(t.target),r.headerEffects&&u.addClass("headercellactive"))},_enableColumnResizeEvents:function(){var n=this;n.model.allowColumnResize?(n._on(n.element,"mousemove",n._mouseMove),n._on(n.element,"mouseup",n._mouseUp)):(n._off(n.element,"mousemove",n._mouseMove),n._off(n.element,"mouseup",n._mouseUp))},_mouseMove:function(n){var t=this;t.model.allowColumnResize&&(t._resizer._mouseMove(n),t._$gridHeaderContainer.scrollLeft(t._$gridContent.ejScroller("option","scrollLeft")))},_mouseUp:function(t){var i=this;i.model.allowColumnResize&&((n(t.target).hasClass("e-headercelldiv")||n(t.target).hasClass("e-reSizeColbg"))&&(i.model.isEdit?i.saveCell():i._isRowEdit&&i._saveRow(),i.element.focus()),i._resizer._mouseUp(t),i._$gridHeaderContainer.scrollLeft(i._$gridContent.ejScroller("option","scrollLeft")),i._resizeFilteringElements())},_resizeFilteringElements:function(){var n=this,r;if(n.model.allowFiltering)for(r={},t.TreeGrid.Actions.Filter="filtering",r.requestType=t.TreeGrid.Actions.Filter,i=0;i<n.model.columns.length;i++)n.model.columns[i].width=n._columnsWidthCollection[i],r.fieldname=n.model.columns[i].field,this._filteringElements(r)},_enableEditingEvents:function(){var n=this,t=n.model;t.editSettings.allowEditing?((t.editSettings.editMode=="cellEditing"||t.editSettings.editMode.toLowerCase()=="rowediting")&&n._on(n.element,"mousedown",".e-gridcontent",n._saveCellHandler),n._on(this.element,"dblclick",".e-gridcontent",n._editdblClickHandler)):((t.editSettings.editMode=="cellEditing"||t.editSettings.editMode.toLowerCase()=="rowediting")&&n._off(n.element,"mousedown",".e-gridcontent",n._saveCellHandler),n._off(this.element,"dblclick",".e-gridcontent",n._editdblClickHandler))},_saveCellHandler:function(t){var i=n(t.target),r=this;i.hasClass("e-vhandle")||i.hasClass("e-vscroll")||i.hasClass("e-vup")||i.hasClass("e-vdown")||i.hasClass("e-vhandlespace")||i.hasClass("e-hhandle")||i.hasClass("e-hscroll")||i.hasClass("e-hup")||i.hasClass("e-hdown")||i.hasClass("e-hhandlespace")||(t.stopPropagation(),r._isRowEdit?i.closest("form#"+r._id+"EditForm").length==0&&r._saveRow():i.closest(".e-popup").length==0&&i.closest(".e-rowcell").find("#"+r._id+"EditForm").length==0&&r.saveCell())},_rightClick:function(t){var i=this,f=n(t.target),e=f[0].parentNode,o,s,r,u,h={};i._clearContextMenu();i.disableTooltip();(f.hasClass("e-cell")||f.hasClass("e-treegridexpand"))&&(e=f.closest("tr"));o=n(e).hasClass("e-treegridrows")||n(e).hasClass("e-rowcell")?i.getRows():n(i.getRows());s=f.closest("tr");r=o.index(s);i._currentViewData=i.getCurrentViewData();u=i._currentViewData[r];r=i._updatedRecords.indexOf(u);h.data=u;h.recordIndex=r;i.dataSource()==null||i.dataSource().length==0||f.closest("form#"+i._id+"EditForm").length>0?(i._contextMenuItems=[],i._contextMenuItems=i._getContextMenuItems(),i._subContextMenuItems=[],i._updateContextmenuOption(r,u),i._clearContextMenu(),i._contextMenuItems.length>0&&i._renderContextMenu(t,r,u)):u&&(t.preventDefault(),i._contextMenuItems=[],i._contextMenuItems=i._getContextMenuItems(),i._subContextMenuItems=[],i._subContextMenuItems=i._getsubContextMenuItems(),i._updateContextmenuOption(r,u),i._clearContextMenu(),i._contextMenuItems.length>0&&i._renderContextMenu(t,r,u),i.selectRows(r))},_editdblClickHandler:function(i){var r=this,f=r.model,e=n("#"+r._id+"EditForm"),o={},u=n(i.target);if(!u.hasClass("e-vhandle")&&!u.hasClass("e-vscroll")&&!u.hasClass("e-vup")&&!u.hasClass("e-vdown")&&!u.hasClass("e-vhandlespace")&&!u.hasClass("e-hhandle")&&!u.hasClass("e-hscroll")&&!u.hasClass("e-hup")&&!u.hasClass("e-hdown")&&!u.hasClass("e-hhandlespace")){if(f.editSettings.editMode==="normal"&&(o.requestType=t.TreeGrid.Actions.BeginEdit,r._trigger("actionBegin",o)),r._cellEditingDetails.cancelSave){r._cellEditingDetails.cancelSave=!1;return}e.length===0&&r.getRows()!==null&&(f.editSettings.editMode=="cellEditing"?(r.element.focus(),r._cellEditingDetails.columnIndex=r.getCellIndex(i),r._cellEditingDetails.rowIndex=r.getRowIndex(i),fieldName=r._cellEditingDetails.columnIndex>=0&&f.columns[r._cellEditingDetails.columnIndex].field,fieldName&&f.editSettings.allowEditing&&f.editSettings.editMode==t.TreeGrid.EditMode.CellEditing&&r.cellEdit(r._cellEditingDetails.rowIndex,fieldName)):f.editSettings.editMode.toLowerCase()=="rowediting"&&(r._currentViewData=r.getCurrentViewData(),r.getCellIndex(i)!=-1&&r.getRowIndex(i)!=-1&&r._editRow(r.getRowIndex(i))),e=n("#"+r._id+"EditForm"),e.length>0&&r._editAddTools());r._clearContextMenu()}},_popupHide:function(){var u=this,t=u.model.columns,r=null,f;for(i=0;i<t.length;i++)t[i]&&(t[i].editType=="datepicker"||t[i].editType=="datetimepicker"?r=n("#"+u._id+t[i].field).data("ejDatePicker"):t[i].editType=="dropdownedit"&&(f=n("#"+u._id+t[i].field).data("ejDropDownList"),f&&(r=f.popupList)),r&&r.hide())},_mouseWheel:function(n){var t=this,i=null,f=n;t._popupHide();n=n.originalEvent;try{n.preventDefault?n.preventDefault():f.preventDefault()}catch(o){}if(t._$gridContent.height()>t._$gridContainer.height()){t._$gridContent.ejScroller("scrollY",0,!0);return}if(n.wheelDelta?(i=-n.wheelDelta/120,window.opera&&parseFloat(window.opera.version,10)<10&&(i=-i)):n.detail&&(i=n.detail/3),!i)return!1;var e=t._$gridContent.ejScroller("option","scrollTop"),r=e+i*57,u=parseInt(t._updatedRecords.length*30)-(t._viewPortHeight-18);return r>u&&(r=u),r<0&&(r=0),t._updateScrollTop(r),!0},_getCollapsedParentItem:function(n){var t=n.parentItem;return t?t.expanded===!1?t:this._getCollapsedParentItem(t):null},_keyPressed:function(i,r,u){var f=this,ft=f.element,l=ft.ejTreeGrid("instance"),e=l.model,w,k,it,a,tt,rt,v,y,et,d,b,h;if(!e.allowKeyboardNavigation)return!1;w=!1;k=n(r);$form=n("#"+f._id+"EditForm");switch(i){case"saveRequest":f._isRowEdit?f._saveRow():e.editSettings.editMode=="cellEditing"&&$form.length>0&&l._moveCurrentCell("down");e.filterBarMode=="onEnter"&&e.allowFiltering&&f._filterBarHandler(r);break;case"cancelRequest":$form.length>0&&(e.editSettings.editMode=="cellEditing"?f._isRowEdit?f.cancelRowEditCell():l.cancelEditCell():e.editSettings.editMode.toLowerCase()=="rowediting"&&(f.refreshRow(f._editedRowIndex),f._isRowEdit=!1));break;case"editRecord":e.editSettings.allowEditing&&e.editSettings.editMode=="cellEditing"&&(l._cellEditingDetails.rowIndex=this.selectedRowIndex(),l._cellEditingDetails.columnIndex=f.getCellIndex(u,r),l._cellEditingDetails.columnIndex!==-1&&(fieldName=l.model.columns[l._cellEditingDetails.columnIndex].field,fieldName&&l.cellEdit(l._cellEditingDetails.rowIndex,fieldName)));break;case"firstRowSelection":if(f._isRowEdit||f.model.isEdit)return!0;f._rowSelectingEventTrigger()||(f.selectRows(0),c=f._updatedRecords.indexOf(e.selectedItem),s=c!==-1&&c*e.rowHeight,it=f._$gridContainer.height(),it>f._viewPortHeight&&(o={requestType:"scroll",delta:s},f._scrollTop=s,f._completeAction(o),f._$gridContent.children(".e-content").scrollTop(s)),e.enableVirtualization&&(f.selectRows(0),f.element[0].focus()),f._rowSelectedEventTrigger(0));break;case"lastRowSelection":if(f._isRowEdit||f.model.isEdit)return!0;f._rowSelectedEventTrigger()||(a=f._updatedRecords.length-1,v=f._updatedRecords[a],!e.enableVirtualization&&v.parentItem?(y=f._getCollapsedParentItem(v),y?(d=f.getChildCount(y,0),f.selectRows(a-d)):f.selectRows(a)):f.selectRows(a),c=e.selectedItem&&f._updatedRecords.indexOf(e.selectedItem),s=a!==-1&&c*e.rowHeight,s+f.model.rowHeight>=f._viewPortHeight&&(h=s+f.model.rowHeight-(f._viewPortHeight-f._scrollBarHeight)-f.getCollapsedRecordCount()*e.rowHeight,h>=0&&(o={requestType:"scroll",delta:h},f._scrollTop=h,f._completeAction(o)),e.enableVirtualization&&(f.selectRows(c),f.element[0].focus())),f._rowSelectedEventTrigger(c));break;case"moveCellLeft":f._isRowEdit?(previousElement=k.closest("td").prev("td"),previousElement.length&&f._focusElementsForRowEdit(previousElement)):e.editSettings.allowEditing&&e.editSettings.editMode=="cellEditing"&&$form.length>0&&(w=f._moveCurrentCell("left"));break;case"moveCellRight":f._isRowEdit?(nextElement=k.closest("td").next("td"),nextElement.length&&f._focusElementsForRowEdit(nextElement)):e.editSettings.allowEditing&&e.editSettings.editMode=="cellEditing"&&k&&$form.length>0&&(w=f._moveCurrentCell("right"));break;case"downArrow":if(f._isRowEdit||f.model.isEdit)return!1;if(!f._rowSelectingEventTrigger()&&(a=f._updatedRecords.length-1,f.selectedRowIndex()!=a)){e.enableVirtualization||e.selectedItem.expanded?f.selectRows(f.selectedRowIndex()+1):(tt=f.getChildCount(e.selectedItem,0),rt=f.selectedRowIndex()+tt+1,a>=rt&&f.selectRows(f.selectedRowIndex()+tt+1));e.selectedItem.isSelected=!0;var c=e.selectedItem&&f._updatedRecords.indexOf(e.selectedItem),s=a!==-1&&c*e.rowHeight,h,ut,b=f._$gridContent.children(".e-content").length;h=b?f._$gridContent.children(".e-content").scrollTop():f._$gridContent.scrollTop();ut=h+f._viewPortHeight-f._scrollBarHeight-e.rowHeight+f.getCollapsedRecordCount()*e.rowHeight;ut<s&&(o={requestType:"scroll",delta:h+e.rowHeight},f._completeAction(o),b?f._$gridContent.children(".e-content").scrollTop(h+e.rowHeight):f._$gridContent.scrollTop(h+e.rowHeight),e.enableVirtualization&&f.element[0].focus());f._rowSelectedEventTrigger(f.selectedRowIndex())}break;case"rightArrow":if(f._isRowEdit||f.model.isEdit)return!0;var g=f.selectedRowIndex(),p=f._updatedRecords[g],o={},nt;o.data=p;o.recordIndex=g;o.expanded=!0;f._rowSelectingEventTrigger()||!p.hasChildRecords||p.expanded||f.selectedRowIndex()>=0&&(nt=f._trigger("expanding",o),nt||e.isFromGantt||t.TreeGrid.sendExpandCollapseRequest(f,o));break;case"leftArrow":if(f._isRowEdit||f.model.isEdit)return!0;var g=f.selectedRowIndex(),p=f._updatedRecords[g],o={},nt;o.data=p;o.recordIndex=g;o.expanded=!1;!f._rowSelectingEventTrigger()&&p.hasChildRecords&&p.expanded&&f.selectedRowIndex()>=0&&(nt=f._trigger("collapsing",o),nt||e.isFromGantt||t.TreeGrid.sendExpandCollapseRequest(f,o));break;case"upArrow":if(f._isRowEdit||f.model.isEdit)return!1;f._rowSelectingEventTrigger()||f.selectedRowIndex()!==0&&(v=f._updatedRecords[f.selectedRowIndex()-1],!e.enableVirtualization&&v.parentItem?(y=f._getCollapsedParentItem(v),y?(d=f.getChildCount(y,0),f.selectRows(f.selectedRowIndex()-d-1)):f.selectRows(f.selectedRowIndex()-1)):f.selectRows(f.selectedRowIndex()-1),e.selectedItem.isSelected=!0,c=f._updatedRecords.indexOf(e.selectedItem),s=c!==-1&&c*e.rowHeight-f.getCollapsedRecordCount()*e.rowHeight,b=f._$gridContent.children(".e-content").length,h=b?f._$gridContent.children(".e-content").scrollTop():f._$gridContent.scrollTop(),h&&h>s&&(o=s>=0?{requestType:"scroll",delta:s}:{requestType:"scroll",delta:0},b?f._$gridContent.children(".e-content").scrollTop(o.delta):f._$gridContent.scrollTop(o.delta),f._completeAction(o),e.enableVirtualization&&(f.selectRows(f.selectedRowIndex()),f.element[0].focus())),f._rowSelectedEventTrigger(f.model.selectedRowIndex));break;default:w=!0}return w},filterColumn:function(i,r,u,f,e,o){var h,a,w,c,s,b,l,v,p;if(this.model.allowFiltering){for(h={},t.TreeGrid.Actions.Filter="filtering",h.requestType=t.TreeGrid.Actions.Filter,h.currentFilterObject=[],n.isArray(r)||(r=n.makeArray(r)),n.isArray(u)||(u=n.makeArray(u)),a=!1,w=this._filterCollection,t.util.isNullOrUndefined(this._currentFilterColumn)&&(this._currentFilterColumn=this.getColumnByField(i)),c=0;c<r.length;c++){if(s={field:i,operator:r[c],value:u[c],matchcase:e,predicate:f,actualFilterValue:o},this._$colType="string",this._filteredColumns.length==0&&s.value!=="")this._$colType=="date"&&(r=="equal"||r=="notequal")&&typeof s.value!="string"?this._setDateFilters(s):this._filteredColumns.push(s);else{if(b=this,!a){var k=t.DataManager(this._filteredColumns),d=(new t.Query).where("field",t.FilterOperators.equal,s.field),y=k.executeLocal(d);for(l=0;l<y.length;l++)v=n.inArray(y[l],this._filteredColumns),v!=-1&&this._filteredColumns.splice(v,1)}s.value!==""&&(this._$colType=="date"&&(r=="equal"||r=="notequal")&&typeof s.value!="string"?this._setDateFilters(s):this._filteredColumns.push(s))}a=!0;h.currentFilterObject.push(s)}h.filterCollection=this._filteredColumns;h.currentFilteringColumn=i;h.fieldName=i;p=this.processBindings(h);p&&(this._filteredColumns.reverse().splice(0,r.length),this._filteredColumns.reverse())}},_rowSelectingEventTrigger:function(){var t=this,n=t.model,r={},i,u;return n.currentViewData.length<=0&&this.selectedRowIndex(-1),this.selectedRowIndex()!==-1&&n.currentViewData.length>0&&(u=t.getRows(),i=n.currentViewData[this.selectedRowIndex()],n.selectedItem=i,r={rowElement:u.eq(this.selectedRowIndex()),data:i,recordIndex:this.selectedRowIndex()}),t._trigger("rowSelecting",r)},_rowSelectedEventTrigger:function(n){var t=this,r=t.model,i={},u=t.getRows();r.currentViewData.length>0&&(i={rowElement:u.eq(n),data:t.model.selectedItem,target:"ejTreeGrid",recordIndex:n},t._trigger("rowSelected",i))},_eventBindings:function(){var t=this,i=t.model,n=0,r=t._gridRows,u=r.length;if(i.queryCellInfo!=null||i.rowDataBound!=null)for(n;n<u;n++)t._rowEventTrigger(r[n],i.flatRecords[n])},_rowEventTrigger:function(t,i){var f=this;f._trigger("rowDataBound",{rowElement:t,data:i});var u=t.cells,o=n(t).find(".e-rowcell"),r=0,s=u.length,e,h=f.model.columns;for(r;r<s;r++)n(u[r]).hasClass("e-rowcell")&&(e=h[o.index(u[r])]),e&&f._cellEventTrigger(u[r],i,e)},_cellEventTrigger:function(n,t,i){var r={cellElement:n,data:t,column:i};r.cellValue=r.column&&t[r.column.field];this._trigger("queryCellInfo",r)},_completeAction:function(i){var r=this,f=r.model,e=f.sortSettings.sortedColumns,u,o;if(f.isEdit=!1,t.TreeGrid.Actions.Sorting==i.requestType&&f.allowSorting||t.TreeGrid.Actions.Refresh==i.requestType){if(f.allowSorting)for(r._multiSortRequest||(r.getHeaderTable().find(".e-columnheader").find(".e-headercelldiv").find(".e-ascending,.e-descending").remove(),r.getHeaderTable().find("[aria-sort]").removeAttr("aria-sort")),u=0;u<e.length;u++)r._addSortElementToColumn(e[u].field,e[u].direction);r._multiSortRequest=!1}else t.TreeGrid.Actions.BeginEdit==i.requestType||t.TreeGrid.Actions.Add==i.requestType?(o=n("#"+r._id+"EditForm"),r.model.isEdit=!0,r.setWidthToColumns(),t.TreeGrid.Actions.Add==i.requestType&&o.find(".e-field:disabled").not(".e-identity").removeAttr("disabled").removeClass("e-disable")):i.requestType==="scroll"&&(r._updateCurrentViewData(),!r.model.isFromGantt&&i.delta>=0&&r.isVScroll()&&r.model.enableVirtualization&&(!r._$gridContent.ejScroller("isHScroll")&&i.delta>=18&&(i.delta-=r._scrollBarHeight,r._scrollTop=i.delta),r._$gridContent.ejScroller("scrollY",i.delta,!0)));r._trigger("actionComplete",i)},sendDataRenderingRequest:function(i){var r=this,u,f;if(r.model.currentViewData.length)switch(i.requestType){case t.TreeGrid.Actions.Delete:case t.TreeGrid.Actions.Refresh:case t.TreeGrid.Actions.Save:case t.TreeGrid.Actions.Filter:case t.TreeGrid.Actions.Sorting:case t.TreeGrid.Actions.Searching:case t.TreeGrid.Actions.ExpandCollapse:case t.TreeGrid.Actions.RefreshDataSource:u=document.createElement("div");r.getContentTable().find("colgroup").first().replaceWith(r._getMetaColGroup());f=r.getContentTable().children("tbody");f.empty();u.innerHTML=["<table>",n.render[r._id+"_Template"](r.model.currentViewData),"<\/table>"].join("");r.getContentTable().get(0).replaceChild(u.firstChild.firstChild,r.getContentTable().get(0).lastChild);r._gridRows=r.getContentTable().get(0).rows;r.setGridRows(n(r.getContentTable().get(0).rows));r._eventBindings()}else r.getContentTable().find("tbody").empty().append(r._getEmptyTbody()),r._gridRows=null,r.setGridRows(null);r._completeAction(i)},sortColumn:function(i,u){var f=this,o=f.model,h=o.sortSettings.sortedColumns,s={},e=0,l=h.length,c;if(o.allowSorting&&n.inArray(i,f._disabledSortableColumns)==-1&&i.length!=0){for(f._multiSortRequest||(o.sortSettings.sortedColumns=[]),s.requestType=t.TreeGrid.Actions.Sorting,s.columnName=i,f._cSortedColumn=f.getFieldNameByHeaderText(i),f._cSortedDirection=s.columnSortDirection=u===r?t.sortOrder.Ascending:u,e;e<l;e++)if(h[e].field==f._cSortedColumn){h.splice(e,1);break}o.sortSettings.sortedColumns.push({field:f._cSortedColumn,direction:f._cSortedDirection});c=f.processBindings(s);c&&(f._cSortedDirection=f._cSortedColumn=null)}},deleteRow:function(n){var i=this,e,o,r={},f,u;for(length=i._selectedRowsIndexes.length,i._selectedRowsIndexes.sort(),f=0,u=0;u<length;u++){if(n=t.isNullOrUndefined(n)?i.getRowByIndex(i._selectedRowsIndexes[u]):i.getRowByIndex(i._selectedRowsIndexes[u]-f),e=i.getRows().index(n),o=i.model.currentViewData[e],r.tr=n,r.data=o,r.requestType=t.TreeGrid.Actions.Delete,i._trigger("actionBegin",r))return!0;i.processBindings(r);f++;i.model.currentViewData.length>0&&t.TreeGrid.updateAltRow(i,i.model.currentViewData[0],0,0)}i._selectedRowsIndexes=[];i._previousIndex=-1},search:function(n){var r=this,i={};i.requestType=t.TreeGrid.Actions.Searching;i.keyValue=n;r._searchString=n;r.processBindings(i)},endEdit:function(){var n=this;return n.model.editSettings.editMode=="cellEditing"&&!n._isRowEdit?n.saveCell():!0},getVisibleRange:function(){var n=this,r=n._scrollTop/n.model.rowHeight,u=r-Math.floor(r),t,i,f=n.model;return n._offset=u*f.rowHeight,t=Math.floor(r),i=n._getRowPosition(n._scrollTop+n._viewPortHeight),t=Math.max(0,t),i=Math.min(n.getRecordsCount(),i),n._visibleRange={top:t,bottom:i},n._visibleRange},setWidthToColumns:function(){var i=this,s=i.model,f=i.getContentTable().children("colgroup").find("col"),r=i.getHeaderTable().children("colgroup").find("col"),o=i._gridWidth,u=s.columns.length,n,e;for(f.length>u&&f.splice(0,f.length-u),r.length>u&&r.splice(0,r.length-u),n=0;n<r.length;n++)t.isNullOrUndefined(i._columnsWidthCollection[n])?(e=(o/u).toFixed(2)+"px",f.eq(n).css("width",e),r.eq(n).css("width",e),i._columnsWidthCollection[n]=(o/u).toFixed(2)):(f.eq(n).width(i._columnsWidthCollection[n]),r.eq(n).width(i._columnsWidthCollection[n]))},cellEdit:function(i,r){var u=this,o,s=u.model,f,e;return(u.model.showGridCellTooltip&&u._cellMouseLeave(),u.model.isEdit&&u.saveCell(),o=n("#"+u._id+"EditForm"),o.length>0)?!0:u.model.selectedItem?s.isFromGantt&&(r==="status"||r==="startDate"||r==="endDate"||r==="duration"||r==="predecessor")&&u.model.selectedItem.hasChildRecords||r==="baselineStartDate"||r==="baselineEndDate"||r==="taskId"?!1:u.getRows()[i]?(f=n(u.getRows()[i]),columnIndex=u.getColumnIndexByField(r),$targetTd=f.find(".e-rowcell").eq(columnIndex),column=u.model.columns[columnIndex],data=u.model.selectedItem,beginEditArgs={},args={validationRules:t.isNullOrUndefined(column.validationRules)?{}:n.extend(!0,{},column.validationRules),columnName:column.field,value:t.isNullOrUndefined(data[r])?data.item&&data.item[r]:data[r],data:data,columnObject:column,cell:$targetTd},isEditable=!0,s.isFromGantt&&args.columnName==="predecessor"&&(e=args.data.item[u.model.predecessorMapping],args.value=e?e:""),beginEditArgs.data=data,beginEditArgs.columnIndex=columnIndex,beginEditArgs.rowElement=f,beginEditArgs.cellElement=$targetTd,u._cellEventTrigger(f[0].cells[u._cellEditingDetails.columnIndex],data,args.columnObject),u._trigger("beginEdit",beginEditArgs))?!1:((n.inArray(r,u._primaryKeys)!=-1||args.columnObject.allowEditing===!1)&&(n.extend(u._cellEditingDetails,{cellValue:args.value,rowIndex:i,fieldName:r,data:args.data,columnIndex:columnIndex}),isEditable=!1),f.hasClass("e-insertedrow")&&!args.columnObject.isTemplateColumn&&(isEditable=!0),isEditable&&n.extend(u._cellEditingDetails,{rowIndex:i,cellValue:args.value,columnIndex:columnIndex,fieldName:r,cellEditType:args.columnObject.editType,data:data}),u._renderCellEditObject(args,$targetTd),f.hasClass("e-templaterow")||(f.addClass("e-editedrow"),args.cell&&args.cell.addClass("e-editedcell")),!0):void 0:!1},_validatePredecessorString:function(n){var i=this,t;if(n.length>0)n.split(",").forEach(function(n){values=n.split("+");offsetvalue="+";n.indexOf("-")>=0&&(values=n.split("-"),offsetvalue="-");match=values[0].match(/(\d+|[A-z]+)/g);i.model.ids.indexOf(match[0])!=-1?match[1]&&(match[1].toUpperCase()=="FS"||match[1].toUpperCase()=="FF"||match[1].toUpperCase()=="SF"||match[1].toUpperCase()=="SS"||(t=!1)):t=!1});else return!0;return t===r||t?!0:!1},saveCell:function(){var r=this,u=r.model,l,d,s,f,g,nt,e,rt;if(n("#"+r._id+"EditForm").length>0){if(!r.editFormValidate())return!0;if(r._cellEditingDetails.columnIndex>=0){var p=n("#"+r._id+"EditForm"),w=p.closest("tr"),ut=p.closest("td"),b,i={},o=u.columns[r._cellEditingDetails.columnIndex],c=n("#"+r._id+r._cellEditingDetails.fieldName),k;if(i={columnName:o.field,value:r.getCurrentEditCellData(),data:r._cellEditingDetails.data,previousValue:r._cellEditingDetails.cellValue,columnObject:o,cellElement:ut,rowElement:w},(r._cellEditingDetails.cellEditType=="datetimepicker"||r._cellEditingDetails.cellEditType=="dropdownedit"||r._cellEditingDetails.cellEditType=="datepicker")&&c.data("ejWidgets")&&c[c.data("ejWidgets")[0]]("destroy"),r._cellEditingDetails.cellEditType==="datepicker"&&(i.value=r.getFormatedDate(i.value)),t.isNullOrUndefined(o.format)?i.columnObject.type=="boolean"?(l={},l[i.columnObject.field]=i.value,i.cellElement.empty().html(n(n.templates.Grid_JSONTemplate.render(l))[0].cells[r._cellEditingDetails.columnIndex].innerHTML)):i.cellElement.empty().html(i.value):(b=r.formatting(o.format,i.value),i.cellElement.empty().html(b)),d=(r._cellEditingDetails.cellEditType=="datepicker"||r._cellEditingDetails.cellEditType=="datetimepicker")&&i.value instanceof Date&&i.previousValue instanceof Date?i.value.getTime()!==i.previousValue.getTime():i.value!==i.previousValue,u.isEdit=!1,s=r._cellEditingDetails.fieldName,u.isFromGantt&&s==="predecessor"){f={};g=r._validatePredecessorString(i.value);g?(f.predecessorString=i.value.split(","),f.data={},f.data[u.taskIdMapping]=i.data.taskId,f.requestType="validatePredecessor",r._trigger("actionComplete",f),nt=f.result,nt||(i.value=i.previousValue)):i.value=i.previousValue;i.value=i.value.toUpperCase();var a=[],tt=[],v=[],h=0,it,y;for(i.previousValue=i.data.predecessor,tt=i.previousValue,i.value.length>0&&(v=i.data._calculatePredecessor(i.value)),it=v.length,e=0,rt=i.previousValue&&i.previousValue.length,e=0;e<rt;e++)y=tt[e],y.from===i.data.taskId.toString()&&a.push(y);for(h=0;h<it;h++)a.push(v[h]);i.data[r._cellEditingDetails.fieldName]=a;i.data.item[u.predecessorMapping]=i.value}else if(d){if(u.isFromGantt)switch(s){case"taskId":i.data.item[u.taskIdMapping]=i.value;break;case"taskName":i.data.item[u.taskNameMapping]=i.value;break;case"startDate":i.data.item[u.startDateMapping]=i.value;break;case"endDate":i.data.item[u.endDateMapping]=i.value;break;case"resourceInfo":i.data.item[u.resourceInfoMapping]=r._getResourceId(i.value);break;case"duration":i.data.item[u.durationMapping]=i.value;break;case"status":i.data.item[u.progressMapping]=i.value;break;default:i.data.item[r._cellEditingDetails[s]]=i.value}else i.data.item[r._cellEditingDetails.fieldName]=i.value;i.data[r._cellEditingDetails.fieldName]=i.value}u.isFromGantt&&(i.columnName==="startDate"||i.columnName==="endDate"||i.columnName==="duration"||i.columnName==="predecessor"||i.columnName=="status")&&(i.isModified=!0);k=n(n.render[r._id+"_Template"](i.data))[0].cells[r._cellEditingDetails.columnIndex];i.cellElement.removeClass("e-editedcell").replaceWith(k);r._trigger("refresh");i.data.treeMappingName||(i.data.treeMappingName=[]);i.data.treeMappingName.push(i.columnName);r._trigger("endEdit",i)&&(i.data[i.columnName]=i.previousValue,i.data.item[i.columnObject.field]=i.previousValue,r.selectRows(this.selectedRowIndex()),r.refreshRow(this.selectedRowIndex()));r._cellEventTrigger(i.rowElement[0].cells[r._cellEditingDetails.columnIndex],i.data,i.columnObject);w.removeClass("e-editedrow")}}return r._cancelSaveTools(),!1},editFormValidate:function(){return n.isFunction(n.validator)?n("#"+this._id+"EditForm").validate({onsubmit:!1}).form():!0},getCurrentEditCellData:function(){var u=this,f=u.model,r,i;if(n("#"+u._id+"EditForm").length){r=n("#"+u._id+u._cellEditingDetails.fieldName);switch(u._cellEditingDetails.cellEditType){case t.TreeGrid.EditingType.String:i=r.val();break;case t.TreeGrid.EditingType.Numeric:i=r.ejNumericTextbox("getValue");r.ejNumericTextbox("getValue");break;case t.TreeGrid.EditingType.Dropdown:i=f.isFromGantt?u._getSelectedItem(r.ejDropDownList("model.selectedItems")):r.ejDropDownList("model.value");break;case t.TreeGrid.EditingType.Boolean:i=r.is(":checked");break;case t.TreeGrid.EditingType.DatePicker:i=f.dateFormat.indexOf("hh")==-1?r.ejDatePicker("model.value"):r.ejDateTimePicker("model.value");break;case t.TreeGrid.EditingType.DateTimePicker:i=Globalize.format(r.ejDateTimePicker("model.value"),"MM/dd/yyyy hh:mm tt")}return typeof i=="string"&&i.length&&f.columns[u._cellEditingDetails.columnIndex].type=="number"&&(i=parseFloat(i)),i}return null},getCurrentEditCellDataForRowEdit:function(i,r,u){var o=this,s=o.model,f,e;if(n("#"+o._id+"EditForm").length){f=n("#"+o._id+i);switch(r){case t.TreeGrid.EditingType.String:e=f.val();break;case t.TreeGrid.EditingType.Numeric:e=f.ejNumericTextbox("getValue");f.ejNumericTextbox("getValue");break;case t.TreeGrid.EditingType.Dropdown:e=f.ejDropDownList("model.value");f.data("ejWidgets")&&f[f.data("ejWidgets")[0]]("destroy");break;case t.TreeGrid.EditingType.Boolean:e=f.is(":checked");break;case t.TreeGrid.EditingType.DatePicker:e=Globalize.format(f.ejDatePicker("model.value"),this.model.dateFormat);f.data("ejWidgets")&&f[f.data("ejWidgets")[0]]("destroy");break;case t.TreeGrid.EditingType.DateTimePicker:e=Globalize.format(f.ejDateTimePicker("model.value"),"MM/dd/yyyy hh:mm tt");f.data("ejWidgets")&&f[f.data("ejWidgets")[0]]("destroy")}return typeof e=="string"&&e.length&&s.columns[u].type=="number"&&(e=parseFloat(e)),e}return null},_getResourceId:function(n){for(var i=[],t=0,r=n.length,t=0;t<r;t++)i.push(n[t][this.model.resourceIdMapping]);return i},_getSelectedItem:function(t){var r=this,i=0,e=t.length,u=r.model.columns[r._cellEditingDetails.columnIndex].dropdownData,f=[];if(u)for(i=0;i<e;i++)n.each(u,function(n,r){t[i]===n&&f.push(r)});return f},getFormatedDate:function(n){return Globalize.format(n,this.model.dateFormat)},formatting:function(t,i){var r,u,s,e,o,h,c,f;return t=t.replace(/%280/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">"),r=this,u=t,s=t.split("{0:"),h=t.split("}"),e=s[0],o=h[1],t.indexOf("{0:")!=-1?(c=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),f=c.exec(t),f!=null&&i!=null?e!=null&&o!=null?e+Globalize.format(i,f[2])+o:Globalize.format(i,f[2]):i!=null?i:""):r.data!=null&&r.data.Value==null?(n.each(r.data,function(n,t){u=u.replace(new RegExp("\\{"+n+"\\}","gm"),t)}),u):r.data.Value},getColumnIndexByField:function(n){var r=this,i=r.model.columns,u=i.length,t=0;for(t;t<u;t++)if(i[t].field==n)break;return t},getBrowserDetails:function(){var n=navigator.userAgent.match(/(firefox|chrome|opera|msie|safari)\s?\/?(\d+(.\d+)*)/i);return!navigator.userAgent.match(/Trident\/7\./)?{browser:n[1].toLowerCase(),version:n[2]}:{browser:"msie",version:jQuery.uaMatch(navigator.userAgent).version}},setValidation:function(){var r=this,i=r.model.columns,u=i.length,n=0;for(r._initValidator(),n;n<u;n++)t.isNullOrUndefined(i[n].validationRules)||r.setValidationToField(i[n].field,i[n].validationRules)},setValidationToField:function(i,r){var u=this,e=n("#"+u._id+i).length>0?n("#"+u._id+i):n("#"+i),f;e.rules("add",r);f=n("#"+u._id+"EditForm").validate({onsubmit:!1});t.isNullOrUndefined(r.required)||(f.settings.messages[i]={},f.settings.messages[i].required=t.TreeGrid.getColumnByField(u.model.columns,i).headerText+" is required")},getFieldNameByHeaderText:function(n){var i=this;return t.isNullOrUndefined(i._fieldColumnNames[n])?null:i._fieldColumnNames[n]},clearSelection:function(n){var r=this,c=r.model,e,n,o,l,s,f,h,u;if(this.selectedRowIndex()!=-1&&(e=r.getRows(),!t.isNullOrUndefined(n))){for(i=0;i<this._selectedRowsIndexes.length;i++)r.getRowByIndex(this._selectedRowsIndexes[i]).removeAttr("aria-selected").find(".e-selectionbackground").removeClass("e-selectionbackground").removeClass("e-active");if(o=c.flatRecords[n],o)o.isSelected=!1;else if(e&&e.removeAttr("aria-selected").find(".e-rowcell").removeClass("e-selectionbackground").removeClass("e-active"),l=new t.DataManager(c.flatRecords),s=new t.Query,s.search(!0,["isSelected"],t.FilterOperators.Equals,!0),f=l.executeLocal(s),h=f&&f.length,h>0)for(u=0,u=0;u<h;u++)f[u].isSelected=!1;r._selectedRowsIndexes.length||(r.selectedRowIndex(-1),r.model.selectedItem=null)}},updateExpandCollapseRecords:function(n,t){var i=this;n.expanded=t;i._removedCount=0;i._expandCollapseRecordCount=i.getChildRecordsCount(n);index=i.model.flatRecords.indexOf(n);t?(i._tempRecordIndex=i.model.records.indexOf(n),n.hasChildRecords&&i._addNestedExpandCollapseRecords(n.childRecords,n.level,n,index)):i.model.flatRecords.splice(index+1,i._expandCollapseRecordCount)},getChildRecordsCount:function(n){var r=this,i=n.childRecords,t=0,f=i?i.length:0,u;for(t;t<f;t++)r._filteredRecords.length>0?(u=r._filteredRecords.indexOf(i[t]),u!=-1&&(++r._removedCount,i[t].hasChildRecords&&i[t].expanded&&r.getChildRecordsCount(i[t]))):(++r._removedCount,i[t].hasChildRecords&&i[t].expanded&&r.getChildRecordsCount(i[t]));return r._removedCount},getExpandStatus:function(n){var t=n.parentItem;return t!=null?t.expanded===!1?!1:t.parentItem?t.parentItem.expanded===!1?!1:this.getExpandStatus(t.parentItem):!0:!0},getColumnFieldNames:function(){var i=[],t=this.model.columns,n=0,r=t.length;for(n;n<r;n++)t[n].field&&t[n].field!="resourceInfo"&&t[n].field!="predecessor"?i.push(t[n].field):t[n].field=="resourceInfo"?i.push("resourceNames"):t[n].field=="predecessor"&&i.push("predecessorsName");return i},renderRecords:function(n){var i=this;n||(n={},n.requestType=t.TreeGrid.Actions.Refresh);this.sendDataRenderingRequest(n)},selectRows:function(i,u){var f=this,e=f.model,c=f.getRows(),s;if((e.editSettings.allowEditing||e.editSettings.allowAdding)&&!f._isRowEdit&&n("#"+f._id+"EditForm").length>0&&f.endEdit()){c=f.getRows();return}if(t.isNullOrUndefined(u)||t.isNullOrUndefined(i)){i=t.isNullOrUndefined(i)?u:i;switch(e.selectionType){case t.TreeGrid.SelectionType.Multiple:if(f._multiSelectCtrlRequest){s=n.inArray(i,f._selectedRowsIndexes);s!=-1&&f.clearSelection(i)&&f._selectedRowsIndexes.splice(s,0);s==-1&&(f._selectedRowsIndexes.push(i),f.getRowByIndex(i).attr("aria-selected","true").find(".e-rowcell").addClass("e-selectionbackground e-active").attr("tabindex","0"));break}case t.TreeGrid.SelectionType.Single:f.clearSelection(f._previousIndex);e.selectedItem=null;i<=f._updatedRecords.length-1&&(f._selectedRowsIndexes=[],f._selectedRowsIndexes.push(i),f.getRowByIndex(i).attr("aria-selected","true").find(".e-rowcell").addClass("e-selectionbackground e-active").attr("tabindex",0),f._updatedRecords[i]&&(f._updatedRecords[i].isSelected=!0,e.selectedItem=f._updatedRecords[i]),f._updatedRecords[f._previousIndex]&&i!=f._previousIndex&&(f._updatedRecords[f._previousIndex].isSelected=!1))}}else if(e.selectionType==t.TreeGrid.SelectionType.Multiple){f.clearSelection();f._selectedRowsIndexes=[];var h=i-u<0?c.slice(i,u+1):c.slice(u,i+1),o=0,l=h.length;for(o;o<l;o++)f._selectedRowsIndexes.push(h[o].rowIndex),e.flatRecords[h[o].rowIndex].isSelected=!0;n(h).attr("aria-selected","true").find(".e-rowcell").addClass("e-selectionbackground e-active").attr("tabindex","0")}return f._previousIndex=f._selectedRowsIndexes.length?i:r,this.selectedRowIndex()!=i&&this.selectedRowIndex(i),f._multiSelectCtrlRequest=!1,!1},getCellIndex:function(t,i){var r=n(t.target),u;return(i&&(r=n(i)),r.prop("tagName")=="TD")?r.index():r.prop("tagName")=="DIV"&&r.hasClass("e-cell")||r.prop("tagName")=="DIV"&&n(r.closest("td")[0]).hasClass("e-templatecell")||n(r.closest("td")[0]).hasClass("e-templatecell")&&n(r.closest("tr")[0]).hasClass("e-templaterow")?(u=r.closest("td"),u.index()):-1},getRowIndex:function(t){var e=this,r=n(t.target),u=e.getRows(),i=u.index(r.parent()),f;return i==-1&&(f=r.closest("tr"),i=u.index(f)),i},getRowByIndex:function(i,r){var f,e;try{var u=this,o=u.getRows(),s=u._gridRows,h=n();return u.model.enableVirtualization&&(f=u._updatedRecords[i],i=u.model.currentViewData.indexOf(f)),t.isNullOrUndefined(r)?(u.model.enableVirtualization&&(e=u._updatedRecords[r],r=u.model.currentViewData.indexOf(e)),n(s[i])):n(o.slice(i,r))}catch(c){return n()}},cancelEditCell:function(){var t=this,i=t._gridRows[t.selectedRowIndex()],r;({})[t._cellEditingDetails.fieldName]=t._cellEditingDetails.cellValue;data=t.model.selectedItem;r=n(i).hasClass("e-insertedrow")?i.cells[t._cellEditingDetails.columnIndex]:i.cells[t._cellEditingDetails.columnIndex];n(r).removeClass("e-editedcell").empty().html(n(n.render[t._id+"_Template"](data))[0].cells[t._cellEditingDetails.columnIndex].innerHTML);t.element.focus();t.model.isEdit=!1;t._cancelSaveTools()},cancelRowEditCell:function(){var t=this,s=t.model.editSettings.allowDeleting,i,f,e,r,o,u;form=n(document.getElementById(t._id+"EditForm"));form.closest("tr").hasClass("e-addedrow")&&(i=form.closest("tr").index(),t._currentViewData=t.getCurrentViewData(),f=t._currentViewData[i].item,e=t._checkIsEmptyRow(f),e&&(t.model.editSettings.allowDeleting||(t.model.editSettings.allowDeleting=!0)));r=this.selectedRowIndex();form.closest("tr").hasClass("e-addedrow")&&(r=i);tr=t._gridRows[r];data=t.model.selectedItem;n(tr).hasClass("e-editedrow")?(n(tr).removeClass("e-editedrow").empty().html(n(n.render[t._id+"_Template"](data))[0].innerHTML),i=r):n(tr).hasClass("e-rowedit")?(n(tr).removeClass("e-rowedit").empty().html(n(n.render[t._id+"_Template"](data))[0].innerHTML),i=r):(o=t._$gridRows.length,u=t.model.editSettings.rowPosition,i=u=="bottom"?o-1:u=="top"?0:r,tr=t._gridRows[i],t.deleteRow(n(tr)));t.model.isEdit=t._isRowEdit=!1;(u=="bottom"||u=="belowSelectedRow")&&(i=i-1);t.selectRows(i);t.model.editSettings.allowDeleting=s;t._$gridRows==null&&t.selectRows(-1)},refreshRow:function(t){var i=this,r=i.model.currentViewData[t];r&&n(i._gridRows[t]).replaceWith(n(n.render[i._id+"_Template"](r)));i.setGridRows(n(i.getContentTable().get(0).rows))},renderRecord:function(i){var u=this,l=n.render[this._id+"_Template"](i._cAddedRecord),r=u.model,o,s,c,f,e,h,a,v,y,p,w;u._gridRows!=null&&u._gridRows.length>0?(c=r.currentViewData.indexOf(r.selectedItem),i.position?i.position=="Above"?u.getRows().eq(c).before(l):i.position=="Below"&&u.getRows().eq(c).after(l):c===-1?(i._cAddedRecord.index=0,u.getRows().eq(0).before(l)):u.getRows().eq(c).after(l),u.setGridRows(n(u.getContentTable().get(0).rows)),i._cAddedRecord.hasChildRecords=!1,i._cAddedRecord.expanded=!1,r.parentIdMapping&&(i._cAddedRecord.parentItem?i._cAddedRecord.item[r.parentIdMapping]=i._cAddedRecord.parentItem.taskId:delete i._cAddedRecord.item[r.parentIdMapping],this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json&&this.dataSource().dataSource.json.push(i._cAddedRecord.item):this.dataSource().push(i._cAddedRecord.item)),i._cAddedRecord.parentItem&&r.selectedItem?i._cAddedRecord.parentItem.hasChildRecords&&(i.position=="Below"||!i.position)?(f=r.flatRecords.indexOf(i._cAddedRecord.parentItem),e=r.flatRecords[f].childRecords.indexOf(r.selectedItem),e===-1?(r.flatRecords[f].childRecords.splice(0,0,i._cAddedRecord),r.parentIdMapping||r.flatRecords[f].item[r.childMapping].splice(0,0,i._cAddedRecord.item)):(r.flatRecords[f].childRecords.splice(e+1,0,i._cAddedRecord),r.parentIdMapping||r.flatRecords[f].item[r.childMapping].splice(e+1,0,i._cAddedRecord.item))):i._cAddedRecord.parentItem.hasChildRecords&&i.position=="Above"&&(f=r.flatRecords.indexOf(i._cAddedRecord.parentItem),e=r.flatRecords[f].childRecords.indexOf(r.selectedItem),e===-1?(r.flatRecords[f].childRecords.push(i._cAddedRecord),r.parentIdMapping||r.flatRecords[f].item[r.childMapping].push(i._cAddedRecord.item)):(r.flatRecords[f].childRecords.splice(e,0,i._cAddedRecord),r.parentIdMapping||r.flatRecords[f].item[r.childMapping].splice(e,0,i._cAddedRecord.item))):!i._cAddedRecord.parentItem&&r.selectedItem?(r.parentRecords.splice(i._cAddedRecord.index,0,i._cAddedRecord),this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json&&(h=this.dataSource().dataSource.json):h=this.dataSource(),h&&(a=h.indexOf(r.selectedItem.item),i.position=="Above"?r.parentIdMapping||h.splice(a,0,i._cAddedRecord.item):i.position!="Below"&&i.position||r.parentIdMapping||h.splice(a+1,0,i._cAddedRecord.item))):!r.selectedItem&&i._cAddedRecord&&(this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json&&(r.parentIdMapping||this.dataSource().dataSource.json.splice(0,0,i._cAddedRecord.item)):r.parentIdMapping||this.dataSource().splice(0,0,i._cAddedRecord.item)),r.selectedItem?(v=r.records.indexOf(r.selectedItem),y=r.flatRecords.indexOf(r.selectedItem),i.position=="Above"?(s=v,o=y):(s=v+1,o=y+1)):(s=0,o=0),u.getExpandStatus(i._cAddedRecord)&&r.enableVirtualization?o===r.flatRecords.length?r.flatRecords.push(i._cAddedRecord):(u._recordIndexCount=0,r.flatRecords.splice(o,0,i._cAddedRecord)):r.enableVirtualization||(o===r.flatRecords.length?r.flatRecords.push(i._cAddedRecord):(u._recordIndexCount=0,r.flatRecords.splice(o,0,i._cAddedRecord))),s===r.records.length?(r.records.push(i._cAddedRecord),r.isFromGantt&&r.ids.push(i._cAddedRecord.taskId.toString())):(r.records.splice(s,0,i._cAddedRecord),r.isFromGantt&&r.ids.splice(s,0,i._cAddedRecord.taskId.toString())),u.setRecordsCount(r.flatRecords.length),u.setHeight(r.flatRecords.length*r.rowHeight),r.allowSorting&&r.sortSettings.sortedColumns.length>0||(u._updatedRecords=r.flatRecords,u._updateCurrentViewData())):(u._gridRows==null||u._gridRows.length==0)&&(this.selectedRowIndex()===-1&&(i._cAddedRecord.hasChildRecords=!1,i.recordIndex=0),r.flatRecords.push(i._cAddedRecord),this.dataSource()==null&&this.dataSource([]),this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json&&this.dataSource().dataSource.json.push(i._cAddedRecord.item):this.dataSource().push(i._cAddedRecord.item),r.records.push(i._cAddedRecord),r.isFromGantt&&r.ids.push(i._cAddedRecord.taskId.toString()),u._updatedGanttRecords=r.flatRecords,u._updatedRecords=r.flatRecords,u.setRecordsCount(r.flatRecords.length),u.setHeight(r.flatRecords.length*r.rowHeight),u._updateCurrentViewData(),r.parentRecords.push(i._cAddedRecord),u.getContentTable().find("tbody").empty().append(u._getEmptyTbody()),p=document.createElement("div"),u.getContentTable().find("colgroup").first().replaceWith(u._getMetaColGroup()),w=u.getContentTable().children("tbody"),w.empty(),p.innerHTML=["<table>",n.render[u._id+"_Template"](u.model.currentViewData),"<\/table>"].join(""),u.getContentTable().get(0).replaceChild(p.firstChild.firstChild,u.getContentTable().get(0).lastChild),u._gridRows=u.getContentTable().get(0).rows,u.setGridRows(n(u.getContentTable().get(0).rows)),u._eventBindings())},onScrollHelper:function(n){var t=this,i;t._$gridContent.ejScroller("scrollY",n,!0);i=t._$gridContent.ejScroller("isHScroll");i||t._$gridContent.scrollTop(n)},isVScroll:function(){return this._$gridContent.hasClass("e-scroller")?this._$gridContent.ejScroller("isVScroll"):!1},refreshScroller:function(n){var t=this,u,i,r,f;t._$gridContent.removeClass("e-borderbox");u=t._$gridContent.ejScroller("option","scrollTop");i=t._$gridContent.ejScroller("option","scrollLeft");t._$gridContent.ejScroller("option",{persist:!0});t._$gridContent.ejScroller("option",{width:n});r=t.getMaxScrollWidth();i>r&&(i=r>0?r:0);t._$gridContent.css("height",t._viewPortHeight);t._$gridContent.ejScroller("refresh");f=t._$gridContent.ejScroller("isHScroll");t.model.isFromGantt&&(f?t._$gridContent.removeClass("e-borderbox"):t._$gridContent.addClass("e-borderbox"));t._$gridContent.ejScroller("option",{scrollTop:u});t._$gridContent.ejScroller("option",{scrollLeft:i});t._$gridHeaderContainer.scrollLeft(i);f||t._$gridContent.scrollTop(u)},getMaxScrollWidth:function(){var n=this;return n._$gridContent.children(".e-content").children(".e-gridcontainer").children(".e-table").width()-n._$gridContent.children(".e-content").width()},refreshHeight:function(){var n=this;n._$gridContent.ejScroller("refresh")},_getViewPortHeight:function(){var t=this,i=0,r=0;return r=t.model.isFromGantt?0:1,i=t.element.height()-t._$gridHeaderContent.height()-parseFloat(r)-parseFloat(t._$gridHeaderContent.css("border-bottom-width")),t.model.toolbarSettings.showToolbar&&(i-=n("#"+t._id+"_toolbarItems").outerHeight()),t.model.isFromGantt||(i-=1),i},updateViewPortHeight:function(){var n=this;n._viewPortHeight=n._getViewPortHeight()},_updateScrollCss:function(){var n=this,t;n.model.isFromGantt||(t=n.isVScroll(),t?n._$gridHeaderContent.addClass("e-scrollcss"):n._$gridHeaderContent.removeClass("e-scrollcss"),n._resizeFilteringElements())},_updateCurrentViewData:function(){var n=this,i=n.model,r={},u,f=!1;i.enableVirtualization?(n.getVisibleRange(),i.currentViewData=n._updatedRecords.slice(n._visibleRange.top,n._visibleRange.bottom),n._vScrollDist!==0&&(u=n._scrollTop-n._offset,(n._prevRTop-n._visibleRange.top!=0||n._prevRBottom-n._visibleRange.bottom!=0)&&(r.requestType=t.TreeGrid.Actions.Refresh,n.sendDataRenderingRequest(r),f=!0),n._$tableContent.css({top:u}),n._prevRTop=n._visibleRange.top,n._prevRBottom=n._visibleRange.bottom)):i.currentViewData=n._updatedRecords;n._isEnterKeyPressed&&(n._isEnterKeyPressed=!1,i.allowSelection&&i.editSettings.allowEditing&&(f||(n._cellEditingDetails.rowIndex+=1),n._rowSelectingEventTrigger()||(n.selectRows(n._cellEditingDetails.rowIndex),n._rowSelectedEventTrigger(n._cellEditingDetails.rowIndex)),n.cellEdit(n._cellEditingDetails.rowIndex,n.model.columns[n._cellEditingDetails.columnIndex].field)))},_getRowPosition:function(n){return Math.ceil(n/this.model.rowHeight)},_getMetaColGroup:function(){return this.getHeaderTable().find("colgroup").clone()},_getEmptyTbody:function(){var i=this,r=t.buildTag("td",i.model.emptyRecordText,{},{colSpan:i.model.columns.length});return n(document.createElement("tr")).append(r)},_addSortElementToColumn:function(i,r){var u=this,e=t.TreeGrid.getColumnByField(u.model.columns,i),o=n.inArray(e,u.model.columns),f=u.getHeaderTable().find("thead").find(".e-headercell").eq(o).find(".e-headercelldiv");f.find(".e-ascending,.e-descending").remove();f.append(u._createSortElement().addClass("e-"+r).addClass("e-icon"));f.parent().attr("aria-sort",r)},_createSortElement:function(){return t.buildTag("span","&nbsp;")},_renderCellEditObject:function(i,r){var u=this,e=t.buildTag("form.#"+u._id+"EditForm","",{},{}),h=u._cellEditTemplate,f,o,s={};s[i.columnObject.field]=i.value;columnIndex=u.getColumnIndexByField(i.columnObject.field);columnIndex===u.model.treeColumnIndex?r.find(".e-cell").empty():r.empty();o=h.find("#"+i.columnObject.field+"_CellEdit").html();f=i.columnObject.field==="predecessor"?n(n.templates(o).render(i.data)):n(n.templates(o).render(s));f.get(0).tagName=="SELECT"&&(f.val(s[i.columnObject.field]),f.val()==null&&f.val(f.find("option").first().val()));e.append(f);columnIndex===u.model.treeColumnIndex?r.find(".e-cell").append(e):r.append(e);u._setoffsetWidth();u._refreshEditForm();n.isFunction(n.validator)&&!n.isEmptyObject(i.validationRules)&&(u._initValidator(),u.setValidationToField(i.columnObject.field,i.validationRules));u.model.isEdit=!0},_setoffsetWidth:function(){var r=this,i,f=n("#"+r._id+"EditForm"),t=0,e,u;for(i=r.model.editSettings.editMode!="cellEditing"||r._isRowEdit?f.find("tr").find(".e-rowcell"):f.closest("td"),e=i.length,t;t<e;t++)u=n(i.children()[0]).children(),r._tdsOffsetWidth[t]=u.length>1?i.get(t).offsetWidth-u[0].offsetWidth-u[1].offsetWidth:i.get(t).offsetWidth},getIndexofresourceInfo:function(n){var u=this,f=u._cellEditingDetails.data,i=f.resourceInfo,t=0,e=i&&i.length,r=[];for(t;t<e;t++)r.push(n.indexOf(i[t]));return r},_refreshEditForm:function(){var e=this,nt=document.getElementById(e._id+"EditForm"),k=!1,d=n(nt).find("input,select"),g=86,h=0,tt=d.length,i,s,f=e.model,c,u={},w,o,l,y,p,a=e.model.rowHeight,v,b;for(h;h<tt;h++){if(i=d.eq(h),f.editSettings.editMode=="cellEditing"&&(g=95),s=e._isRowEdit&&i.attr("type")!="checkbox"?"100%":e._tdsOffsetWidth[h]*(g/100),i.hasClass("e-numerictextbox"))c=s,w=i.val(),u.width=c,u.height=a-5,u.showSpinButton=!0,u.cssClass=f.cssClass,w.length&&(u.value=parseFloat(w)),l=t.TreeGrid.getColumnByField(f.columns,i.prop("name")),f.isFromGantt&&(l.field==="duration"||l.field==="status")&&(u.minValue=0,l.field=="status"&&(u.maxValue=100)),t.isNullOrUndefined(l.editParams)||n.extend(u,l.editParams),i.ejNumericTextbox(u),i.prop("name",i.prop("name").replace(e._id,""));else if(i.hasClass("e-datepicker"))c=s,u.width=c,u.height=a-5,u.locale=f.locale,u.cssClass=f.cssClass,u.displayDefaultDate=!0,u.dateFormat=f.dateFormat,i.val().length&&(u.value=new Date(i.val())),o=t.TreeGrid.getColumnByField(f.columns,i.prop("name")),o.format!==r&&o.format.length>0&&(y=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),p=y.exec(o.format),u.dateFormat=p[2]),t.isNullOrUndefined(o.editParams)||n.extend(u,o.editParams),f.dateFormat.indexOf("hh")==-1?i.ejDatePicker(u):i.ejDateTimePicker(u);else if(i.hasClass("e-datetimepicker"))c=s,u={width:c,height:a-5,locale:f.locale,cssClass:f.cssClass,showButton:!1},i.val().length&&(u.value=new Date(i.val())),o=t.TreeGrid.getColumnByField(f.columns,i.prop("name")),o.format!==r&&o.format.length>0&&(y=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),p=y.exec(o.format),u.dateTimeFormat=p[2]),t.isNullOrUndefined(o.editParams)||n.extend(u,o.editParams),e.model.isFromGantt?f.dateFormat.indexOf("hh")==-1?i.ejDatePicker(u):i.ejDateTimePicker(u):i.ejDateTimePicker(u);else if(i.hasClass("e-dropdownlist"))e._isRowEdit?(v=f.columns[h].dropdownData,b=f.columns[h].field):(v=f.columns[e._cellEditingDetails.columnIndex].dropdownData,b=f.columns[e._cellEditingDetails.columnIndex].field),f.isFromGantt?i.ejDropDownList({width:s+"px",height:a-5,showCheckbox:!0,dataSource:v,popupWidth:"auto",fields:{id:f.resourceIdMapping,text:f.resourceNameMapping,value:f.resourceNameMapping},selectedItems:e.getIndexofresourceInfo(v)}):(i.css({position:"absolute","margin-top":"-13px"}),i.ejDropDownList({width:s,height:a-5,dataSource:v})),i.ejDropDownList("setSelectedValue",i.val()),n("#"+e._id+b+"_list").hide();else switch(i.prop("tagName")){case"INPUT":i.attr("type")!="checkbox"?(i.css("text-align",i.attr("name")!=null&&t.TreeGrid.getColumnByField(f.columns,i.attr("name"))!=null?t.TreeGrid.getColumnByField(f.columns,i.attr("name")).textAlign:"center"),i.outerWidth(s).height(f.rowHeight-9)):i.width(s>0?i.width()>s?s:i.width():1);break;case"SELECT":i.width(s).height(20)}i.is(":disabled")||k||i.is(":hidden")&&typeof i.data("ejDropDownList")!="object"||e._isEnterKeyPressed||(e._focusElements(i.closest("td")),k=!0)}},_initValidator:function(){var i=this;n("#"+i._id+"EditForm").validate({onclick:!1,onfocusout:!1,errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(r,u){var e=u.closest("td"),f=n(r).addClass("e-error"),o=t.buildTag("div.e-errortail e-toparrow");e.find(".e-error").remove();u.hasClass("e-numerictextbox")?f.insertAfter(u.closest(".e-numeric")):f.insertAfter(u);f.prepend(o);i.model.editSettings.editMode!="normal"&&f.offset({left:u.offset().left});f.fadeIn("slow")}})},_focusElements:function(n){var i=this,t;n.length&&(n.focus(),t=n.children(),t[0]&&(t[0].tagName.toLowerCase()=="select"||t[0].tagName.toLowerCase()=="input"?(t.focus().select(),t[0].focus()):t.find(".e-field.e-dropdownlist").length?t.find(".e-ddl").focus():t.find(".e-datewidget.e-widget").length?t.find(".e-datewidget.e-widget").focus():t.find("input,select").select().focus()));i._$gridHeaderContainer.scrollLeft(i._$gridContent.children(".e-content").scrollLeft())},_focusElementsForRowEdit:function(n){if(n.length){var t=n.children();t[0].tagName.toLowerCase()=="select"||t[0].tagName.toLowerCase()=="input"?(t.focus().select(),t[0].focus()):t.find(".e-field.e-dropdownlist").length?t[0].focus():t.find("input:visible,select").first().select().focus()}},updateHeight:function(n){var t=this;t._$gridContainer&&t._$gridContent&&(n?(t._$gridContainer.css({height:n+"px",width:"auto"}),t._$gridContent.ejScroller("refresh")):t._$gridContainer.css({height:t._totalHeight+"px"}),t._$gridContent.hasClass("e-scroller")&&(t._$gridContent.ejScroller("refresh"),t._updateScrollCss()))},_setScrollTop:function(){var n=this,i=this.model,r=n._scrollTop,t;i.enableVirtualization&&r!==0&&!i.isFromGantt&&n.model.currentViewData.length*n.model.rowHeight<n._viewPortHeight&&(t=r-(n._viewPortHeight-n.model.currentViewData.length*n.model.rowHeight),t<0&&(t=0),n._$gridContent.ejScroller("scrollY",t,!0))},_addNestedExpandCollapseRecords:function(t,i,r,u){var f=this,l=f.model,h=l.flatRecords,a=l.records,c=0,y=t.length,e,v,s,o;for(c;c<y;c++)if(u++,f._tempRecordIndex++,e=a[f._tempRecordIndex],n.inArray(e,h)===-1&&h.splice(u,0,e),e&&e.isExpanded===!1&&(e.isExpanded=!0),e.hasChildRecords)if(e.expanded)for(v=e.childRecords.length,s=0,s;s<v;s++)u++,f._tempRecordIndex++,o=a[f._tempRecordIndex],h.splice(u,0,o),o.hasChildRecords&&(o.expanded?u=f._addNestedExpandCollapseRecords(o.childRecords,i+1,o,u):f._tempRecordIndex+=f.getChildCount(o,0));else f._tempRecordIndex+=f.getChildCount(e,0);return u},getChildCount:function(n,t){var r,u=this,i;if(!n.hasChildRecords)return 0;for(i=0;i<n.childRecords.length;i++)r=n.childRecords[i],t++,r.hasChildRecords&&(t=u.getChildCount(r,t));return t},_updateFilteredRecords:function(t){var i=this,u=0,e=t.length,r,f=i.model.enableVirtualization;for(i._filteredRecords=[],i._filteredGanttRecords=[],u;u<e;u++)r=t[u],r.parentItem!=null?(i._addParentRecord(r.parentItem),n.inArray(r,i._filteredRecords)===-1&&(f?i.getExpandStatus(r)&&i._filteredRecords.push(r):i._filteredRecords.push(r))):n.inArray(r,i._filteredRecords)===-1&&(f?i.getExpandStatus(r)&&i._filteredRecords.push(r):i._filteredRecords.push(r))},_addParentRecord:function(t){var i=this,r=i.model.enableVirtualization;t.parentItem?(i._addParentRecord(t.parentItem),n.inArray(t,i._filteredRecords)===-1&&(r?i.getExpandStatus(t)&&i._filteredRecords.push(t):i._filteredRecords.push(t))):n.inArray(t,i._filteredRecords)===-1&&(r?i.getExpandStatus(t)&&i._filteredRecords.push(t):i._filteredRecords.push(t))},_updateExpandCollapseForSortedRecords:function(n,t){var i=this,r=0,o=i._sortedRecords.length,u,f=i._sortedRecords.indexOf(n),e;if(t)i._addNestedSortRecords(n,f);else{for(e=0,r=f+1;r<o;r++)if(u=i._sortedRecords[r],u.level===n.level)break;else i.getExpandStatus(u)||e++;i._sortedRecords.splice(f+1,e)}},_addNestedSortRecords:function(i,r){var u=this,c,o=u.model.sortSettings.sortedColumns,s,e,l,h,f;if(o.length)for(s=o.length-1,u._queryManagar.queries=[],e=s;e>=0;e--)u._queryManagar.sortBy(o[e].field,o[e].direction);if(i.hasChildRecords)for(l=t.DataManager(i.childRecords),c=l.executeLocal(u._queryManagar).result,s=c.length,h=0;h<s;h++)f=c[h],u._filteredRecords.length?n.inArray(f,u._filteredRecords)!==-1&&u._sortedRecords.splice(++r,0,f):u._sortedRecords.splice(++r,0,f),f.hasChildRecords&&f.expanded&&u._addNestedSortRecords(f,r)},_updateAltRow:function(){for(var r=this,n=0,t=r._updatedRecords,u=t.length,i,n=0;n<u;n++)i=t[n],i.isAltRow=n%2==0?!0:!1},_getFilteredChildRecordsCount:function(n){for(var t=this,u=t.model,f=n&&n.childRecords&&n.childRecords.length,i=0,r,i=0;i<f;i++)r=n.childRecords[i],u.enableVirtualization?t.getExpandStatus(r)&&t._removedCount++:t._removedCount++,r.childRecords&&t._getFilteredChildRecordsCount(r);return t._removedCount},_sortingRecords:function(){var n=this,u=n.model,r=u.sortSettings.sortedColumns,e,i,f,o,s,h,c;if(n._queryManagar.queries=[],r.length)for(e=r.length-1,i=e;i>=0;i--)u.isFromGantt&&(f=t.TreeGrid.getColumnByMappingName(u.columns,r[i].field)),f?(n._queryManagar.sortBy(f.field,r[i].direction),r[i].field=f.field):n._queryManagar.sortBy(r[i].field,r[i].direction);return o=new t.DataManager(u.parentRecords),s=o.executeLocal(n._queryManagar).result,n._sortedRecords=[],n._storedIndex=-1,n._createSortedRecords(s),n._tempsortedrecords=n._sortedRecords,n.setRecordsCount(n._sortedRecords.length),n.model.selectedRowIndex>=0&&(h=n._selectedRowsIndexes.indexOf(n.model.selectedRowIndex),c=n._updatedRecords[n.model.selectedRowIndex],n._previousIndex=n.model.selectedRowIndex=n._sortedRecords.indexOf(c),n._selectedRowsIndexes[h]=n._previousIndex),n._updatedRecords=n._sortedRecords,!0},_createSortedRecords:function(i){var r=this,u=r._sortedRecords,f,e=r.model.enableAltRow,o=this.model;n.each(i,function(n,i){if(r._searchString.length>0?r._filteredRecords.length>0&&r._filteredRecords.indexOf(i)!==-1&&(r._storedIndex++,e&&(i.isAltRow=r._storedIndex%2==0?!1:!0),u[r._storedIndex]=i):(r._storedIndex++,e&&(i.isAltRow=r._storedIndex%2==0?!1:!0),u[r._storedIndex]=i),i.hasChildRecords&&i.expanded){f=t.DataManager(i.childRecords);var s=f.executeLocal(r._queryManagar).result;r._createSortedRecords(s)}else!i.hasChildRecords||i.expanded||o.enableVirtualization||r._setChildRecords(i,u)})},_setChildRecords:function(n,i){var u=this,e=u.model.enableAltRow,o=n.childRecords.length,f,r;for(dataManager=t.DataManager(n.childRecords),f=dataManager.executeLocal(u._queryManagar).result,r=0;r<o;r++)u._filteredRecords.length>0?u._filteredRecords.length>0&&u._filteredRecords.indexOf(f[r])!==-1&&(u._storedIndex++,e&&(f[r].isAltRow=u._storedIndex%2==0?!1:!0),i[u._storedIndex]=f[r],f[r].hasChildRecords&&this._setChildRecords(f[r],i)):(u._storedIndex++,e&&(f[r].isAltRow=u._storedIndex%2==0?!1:!0),i[u._storedIndex]=f[r],f[r].hasChildRecords&&this._setChildRecords(f[r],i))},_updateSortedRecords:function(i){var u=this,f=0,s=i.length,r,h=this.model,e,o;for(f;f<s;f++)r=i[f],h.enableVirtualization||(u._filteredRecords.length>0?n.inArray(r,u._filteredRecords)!==-1&&n.inArray(r,u._sortedRecords)===-1&&u._sortedRecords.push(r):n.inArray(r,u._sortedRecords)===-1&&u._sortedRecords.push(r),r.hasChildRecords&&r.childRecords.length>0&&(e=t.DataManager(r.childRecords),o=e.executeLocal(u._queryManagar).result,u._updateSortedRecords(o)))},_removeSortElementFromColumn:function(i){var r=this,f=t.TreeGrid.getColumnByField(r.model.columns,i),e=n.inArray(f,r.model.columns),u=r.getHeaderTable().find("thead").find(".e-headercell").eq(e).find(".e-headercelldiv");u.find(".ascending,.descending").remove();u.parent().removeAttr("aria-sort")},_addEmptyColumntoGrid:function(){n(".e-gridheadercontainer table colgroup").append(t.buildTag("col","",{width:"auto"},{}));n(".e-gridheadercontainer table thead tr").append(t.buildTag("th.e-headercell"))},_updateScrollTop:function(n){var i={},t=this,r;i.requestType="scroll";i.delta=n;r=t._$gridContent.ejScroller("isHScroll");r?t._$gridContent.scrollTop(0):t._$gridContent.scrollTop(n);t._$gridContent.ejScroller("scrollY",n,!0);t._completeAction(i)},_moveCurrentCell:function(n){var t=this,i=t._cellEditingDetails.rowIndex,u=t._cellEditingDetails.columnIndex,r=t.model;if(i==-1&&u==-1)return!1;t.model.isEdit&&(t.saveCell(),t.model.isEdit=!1);switch(n){case"right":if(!t._rowSelectingEventTrigger()&&!t.selectRows(t._cellEditingDetails.rowIndex)){if(i==t._gridRows.length-1&&u==r.columns.length-1)return!0;u==r.columns.length-1?(t._cellEditingDetails.columnIndex=0,t._cellEditingDetails.rowIndex=i+1):t._cellEditingDetails.columnIndex=u+1;t.selectRows(t._cellEditingDetails.rowIndex);t.cellEdit(t._cellEditingDetails.rowIndex,r.columns[t._cellEditingDetails.columnIndex].field)}break;case"left":if(i==0&&u==0)return!0;u==0?(t._cellEditingDetails.columnIndex=r.columns.length-1,t._cellEditingDetails.rowIndex=i-1):t._cellEditingDetails.columnIndex=u-1;t.selectRows(t._cellEditingDetails.rowIndex);t.cellEdit(t._cellEditingDetails.rowIndex,r.columns[t._cellEditingDetails.columnIndex].field);break;case"up":if(i==0)return!0;t._cellEditingDetails.rowIndex=i-1;t.selectRows(t._cellEditingDetails.rowIndex);t._rowSelectedEventTrigger(t._cellEditingDetails.rowIndex);t.cellEdit(t._cellEditingDetails.rowIndex,r.columns[t._cellEditingDetails.columnIndex].field);break;case"down":i+1==t.getRows().length-1&&t.model.enableVirtualization&&(t._isEnterKeyPressed=!0,t._updateScrollTop(t._$gridContent.scrollTop()+r.rowHeight-t._offset));t._isEnterKeyPressed||t._updatedRecords.length>i+1&&(t.selectRows(i+1)||(t._rowSelectedEventTrigger(t._cellEditingDetails.rowIndex+1),t._cellEditingDetails.rowIndex=i+1,t.cellEdit(t._cellEditingDetails.rowIndex,r.columns[t._cellEditingDetails.columnIndex].field),args={},args.requestType="scroll",args.delta=t._$gridContent.children(".e-content").scrollTop(),t._trigger("actionComplete",args)))}return!1},_findColumnsWidth:function(){for(var t=this,i=t.model.columns.length,r=t.getHeaderTable().find("colgroup").find("col"),n=0;n<i;n++)t._columnsWidthCollection[n]=r.eq(n).width()},_calculateWidth:function(){for(var t=this.getHeaderTable().find("colgroup").find("col"),i=0,n=0;n<t.length;n++)i+=t.eq(n).width();return i},_compiledDropDownTemplate:function(){var i=t.buildTag("select"),r=t.buildTag("option","{{:text}}",{},{value:"{{:value}}"});return i.append(r),n.templates(i.html())},_updateElementHeight:function(){var n=this;n.element.height(450);n._calculateDimensions();n.updateViewPortHeight()},_renderScroller:function(){var i=this,r=i.model,s=r.flatRecords.length*r.rowHeight,u,e,f,o;!r.isFromGantt&&i._viewPortHeight<0&&i._updateElementHeight();u=i._viewPortHeight;i._$gridContent.css({height:u+"px"});i._$gridContainer.css({height:s+"px"});i._$gridContent.hasClass("e-scroller")?i._$gridContent.ejScroller("refresh"):($div=t.buildTag("div",{},{width:"auto",height:"auto"}),$div.append(i._$gridContainer),i._$gridContent.append($div),e=i._gridHeight?u:"auto",f=i.element.width(),i._$gridContent.ejScroller({height:i.model.isFromGantt?0:e,width:i.model.isFromGantt?f:f-i._totalBorderWidth,scroll:n.proxy(i._onScroll,i)}),i._$gridContent.ejScroller("refresh"));i._$gridContent.ejScroller("model.keyConfigs",{up:"",down:""});i._updateScrollCss();o=i._$gridContent.ejScroller("isHScroll");i.model.isFromGantt&&(o?i._$gridContent.removeClass("e-borderbox"):i._$gridContent.addClass("e-borderbox"))},_destroy:function(){var n=this;n.element.empty().removeClass("e-treegrid-core e-treegrid "+n.model.cssClass)},collapseAll:function(){var n=this,f=n.model,r=0,i,u={},e=f.enableVirtualization,o=n.getRows();for(n._gridRows=o,(n._isRowEdit||n.model.isEdit)&&(n.cancelRowEditCell(),n.selectRows(-1),n._cancelSaveTools()),r=0;r<n.model.parentRecords.length;r++)i=n.model.parentRecords[r],u.data=i,u.recordIndex=r,u.expanded=!1,e?i.hasChildRecords&&i.expanded&&t.TreeGrid.sendExpandCollapseRequest(n,u):i.hasChildRecords&&i.expanded&&t.TreeGrid.sendExpandCollapseRequest(n,u)},_getContextMenuItems:function(){return[{headerText:"Add Row",eventHandler:null,isDefault:!0,disable:!1},{iconClass:"e-edit",headerText:"Edit",eventHandler:null,isDefault:!0,isEdit:!0,disable:!1},{headerText:"Delete",eventHandler:null,isDefault:!0,disable:!1},{iconClass:"e-save",headerText:"Save",eventHandler:null,isDefault:!0,isEdit:!0,disable:!1},{iconClass:"e-cancel",headerText:"Cancel",eventHandler:null,isDefault:!0,isEdit:!0,disable:!1},]},_getsubContextMenuItems:function(){return[{iconPath:null,headerText:"Above",eventHandler:null},{iconPath:null,headerText:"Below",eventHandler:null}]},_clearContextMenu:function(){n(".e-contextmenu").remove();n(".e-innerContextmenu").remove()},_renderContextMenu:function(i,r,u){var f=this,o=f.model,p={},e={},s,h,c,l,v,a,y;i||(i=window.event);i.pageX||i.pageY?(c=s=i.pageX,h=i.pageY):(i.clientX||i.clientY)&&(c=s=i.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,h=i.clientY+document.body.scrollTop+document.documentElement.scrollTop);n(window).width()<s+130?(s=s-130,c=s-102):c=c+132;n(window).height()<h+25*f._contextMenuItems.length&&(h=h-25*f._contextMenuItems.length);e.targetElement=i;e.item=u;e.index=r;e.requestType="ContextMenuOpen";e.contextMenuItems=f._contextMenuItems;e.innerContextMenuItems=f._subContextMenuItems;f._trigger("contextMenuOpen",e);l=t.buildTag("div.e-contextmenu","",{height:"auto",width:"130px",position:"absolute",left:s+"px",top:h+"px","background-color":"#F0F0F0",border:"1px solid #99bce8","z-index":"10033"},{});v=t.buildTag("ul",n.render[f._id+"contextMenuTemplate"](e.contextMenuItems),{height:"auto",width:"auto",top:"0px",display:"inline"},{"data-icon":!1,type:"none","data-role":"list-divider"});a=t.buildTag("div.e-innerContextmenu","",{height:"auto",width:"100px",position:"absolute",left:c+"px",top:h+f._contextAddMenuIndex*30+"px","background-color":"#F0F0F0",border:"1px solid #99bce8","z-index":"10",visibility:"hidden"},{});y=t.buildTag("ul",n.render[f._id+"subContextMenuTemplate"](e.innerContextMenuItems),{height:"auto",width:"auto",top:"0px",display:"inline"},{"data-icon":!1,type:"none","data-role":"list-divider"});l.append(v);n(document.body).append(l);e.innerContextMenuItems.length>0&&(a.append(y),n(document.body).append(a));n(l).css({height:"auto"});f._on(l,"contextmenu",function(n){n.preventDefault()});n(".e-menuitem").click(function(){var s=n(this).attr("id");if(!n(this).hasClass("e-disable")){switch(s){case"Delete":p.requestType="contextMenuDelete";f.deleteRow();f._clearContextMenu();break;case"Above":f._subContextMenuAction(u,r,"Above");n(f.element).focus();break;case"Below":f._subContextMenuAction(u,r,"Below");n(f.element).focus();break;case"Add":f._setInitialData();f._clearContextMenu();break;case"Edit":o.editSettings.editMode=="cellEditing"?(f.element.focus(),f._cellEditingDetails.columnIndex=f.getCellIndex(i),f._editedRowIndex=f._cellEditingDetails.rowIndex=f.getRowIndex(i),fieldName=f._cellEditingDetails.columnIndex>=0&&o.columns[f._cellEditingDetails.columnIndex].field,fieldName&&(o.editSettings.allowEditing&&o.editSettings.editMode==t.TreeGrid.EditMode.CellEditing&&f.cellEdit(f._cellEditingDetails.rowIndex,fieldName),f._editAddTools())):o.editSettings.editMode.toLowerCase()=="rowediting"&&f._editRow(r);f._clearContextMenu();break;case"Save":o.editSettings.editMode=="cellEditing"?f._isRowEdit?f._endEdit():f.saveCell():o.editSettings.editMode.toLowerCase()=="rowediting"&&f._saveRow();f._cancelSaveTools();f._clearContextMenu();n(f.element).focus();break;case"Cancel":f.cancelRowEditCell();f._cancelSaveTools();f._clearContextMenu();n(f.element).focus();break;default:n.each(f._contextMenuItems,function(n,t){t.headerText===s&&(f.model.customEvent=t.eventHandler,f._trigger("customEvent",e))});f._clearContextMenu()}f.model.enableAltRow&&f._currentViewData[0]&&t.TreeGrid.updateAltRow(f,f._currentViewData[0],0,0);f.updateHeight()}});n(".e-menuitem").mouseenter(function(){n(this).hasClass("e-disable")||(n(".e-contextmenu-mouseover").removeClass("e-contextmenu-mouseover"),n(this).addClass("e-contextmenu-mouseover"),n(this).attr("id")=="Add"||n(this).attr("id")=="Above"||n(this).attr("id")=="Below"?(n(".e-innerContextmenu").css({visibility:"visible"}),n("#Add").addClass("e-contextmenu-mouseover")):n(".e-innerContextmenu").css({visibility:"hidden"}))});n(".e-menuitem").mouseleave(function(){n(this).removeClass("e-contextmenu-mouseover")});i.preventDefault()},_createContextMenuTemplate:function(){var i=this,t,u,r;helpers={getHeaderName:n.proxy(i._getHeaderName,i)};n.views.helpers(helpers);t="<li style='list-style-type:none;width:92px;height:25px;display:inline-block;'>";u="<div class='e-menuitem {{if disable}}e-disable{{/if}}' id={{:headerText}}  style='left:0px;padding-top:3px;height:25px;width:130px;cursor:{{if disable}}default{{else}}pointer{{/if}};display:block;position:absolute;'  {{if !isDefault}}onClick='{{:eventHandler}}'{{/if}}>{{if !isEdit}}<div class='e-icon' style='left:10px;top:4px;height:20px;position:absolute;background-image:{{:iconPath}};background-repeat:no-repeat;'/> {{else}}<span class='e-icon {{:iconClass}}' style='left:10px;top:7px;height:20px;position:absolute;opacity:0.5'/>{{/if}}<div style='left:35px;position:absolute;'><span style='font-family:Segoe UI;font-size:12px;padding-left:5px;'>{{:headerText}}<\/span><\/div>{{if ~getHeaderName(#data)}}<span class='e-icon e-expander' style='height:16px;width:16px;right:5px;top:7px;position:absolute;'><\/span>{{/if}}";t+=u;t+="<\/div><\/li>";r={};r[i._id+"contextMenuTemplate"]=t;n.templates(r)},_createSubContextMenuTemplate:function(){var r=this,f={getHeaderName:r._getHeaderName},t,u,i;n.views.helpers(f);t="<li style='list-style-type:none;width:100px;height:25px;display:inline-block;'>";u="<div class='e-menuitem' id={{:headerText}} style='left:0px;padding-top:3px;height:25px;width:100px;cursor: pointer;display:block;position:absolute;'><div style='left:10px;height:20px;width:16px;position:absolute;padding-top:5px;background-image:{{:iconPath}};background-repeat:no-repeat;'/><div style='left:10px;position:absolute;'><span style='font-family:Segoe UI;font-size:12px;padding-left:5px;'>{{:headerText}}<\/span><\/div><\/div>";t+=u;t+="<\/li>";i={};i[r._id+"subContextMenuTemplate"]=t;n.templates(i)},_getHeaderName:function(n){return n.headerText=="Add Row"&&this._subContextMenuItems.length>0?!0:!1},_updateContextmenuOption:function(t){var u,s;if(Array.prototype.clean=function(n){for(var t=0;t<this.length;t++)this[t]==n&&(this.splice(t,1),t--);return this},u=this,u._isRowEdit||u.model.isEdit)u._contextMenuItems.splice(0,3);else{u._contextMenuItems.splice(3,2);var e=u.model.editSettings,o=n.extend(!0,[],u._contextMenuItems),h=u.model.contextMenuSettings.contextMenuItems.clean("").clean(r),f=[];if(n.each(h,function(t,i){n.inArray(i.toLowerCase(),f)===-1&&f.push(i.toLowerCase())}),u._contextMenuItems=[],t==-1)(f.indexOf("add")!=-1||f.length==0)&&(u._contextMenuItems[0]=o[0]),e.allowAdding||(u._contextMenuItems[0].disable=!0),u._contextAddMenuIndex=0;else if(f.length==0)u._contextMenuItems[0]=o[0],e.allowAdding||(u._contextMenuItems[0].disable=!0),u._contextAddMenuIndex=0,u._contextMenuItems[1]=o[2],e.allowDeleting||(u._contextMenuItems[1].disable=!0);else for(i=0;i<f.length;i++){s=f[i];switch(s.toLowerCase()){case"add":u._contextMenuItems[i]=o[0];u._contextAddMenuIndex=i;e.allowAdding||(u._contextMenuItems[i].disable=!0);break;case"delete":u._contextMenuItems[i]=o[2];e.allowDeleting||(u._contextMenuItems[i].disable=!0);break;case"edit":u._contextMenuItems[i]=o[1];e.allowEditing||(u._contextMenuItems[i].disable=!0)}}}},_setInitialData:function(){var r={},u=this,e=u.model,o=[],f,t={},n;for(i=0;i<e.columns.length;i++){n=e.columns[i];switch(n.editType){case"booleanedit":t[n.field]=!1;break;case"stringedit":t[n.field]=null;break;case"datepicker":t[n.field]=Globalize.format(new Date,this.model.dateFormat);break;case"datetimepicker":today=new Date;t[n.field]=Globalize.format(new Date,"MM/dd/yyyy hh:mm tt");break;case"numericedit":t[n.field]=0;break;default:t[n.field]=null}}o.push(t);(u.dataSource()==null||u.dataSource().length==0)&&(f=u._createRecord(o[0],0,null),f.index=0,r._cAddedRecord=jQuery.extend(!0,{},f),r.data=r._cAddedRecord.item,r.requestType="save",r.actionRequestType="contextMenuAdd",u.renderRecord(r),u._clearContextMenu())},_subContextMenuAction:function(n,i,r){proxy=this;eventArgs={};eventArgs.requestType="save";newItem=jQuery.extend(!0,{},n.item);newItem[proxy.model.childMapping]=null;eventArgs._cAddedRecord=jQuery.extend({},n);eventArgs._cAddedRecord.isSelected=!1;eventArgs._cAddedRecord.hasChildRecords&&r=="Below"&&(eventArgs._cAddedRecord.parentItem=n,eventArgs._cAddedRecord.level+=1);eventArgs._cAddedRecord.hasChildRecords=!1;eventArgs._cAddedRecord.expanded=!1;eventArgs._cAddedRecord.childRecords=null;eventArgs._cAddedRecord.item=newItem;eventArgs.recordIndex=i==0?0:i;eventArgs.position=r;eventArgs.data=eventArgs._cAddedRecord.item;eventArgs.actionRequestType="contextMenuAdd";eventArgs.selectedItem=proxy.model.selectedItem;proxy.renderRecord(eventArgs);proxy._clearContextMenu();selectionIndex=proxy._currentViewData.indexOf(proxy.model.selectedItem);proxy.selectRows(selectionIndex);proxy.model.enableAltRow&&t.TreeGrid.updateAltRow(proxy,proxy._currentViewData[0],0,0)},_editRow:function(i,r){var o,f,c,s,u,e,h;for(proxy=this,proxy._editedRowIndex=i,o=proxy.model.rowHeight,$form=t.buildTag("form.#"+proxy._id+"EditForm","",{margin:"-1px"},{}),$table=t.buildTag("table.e-table","",{},{cellspacing:"0px",cellpadding:"0"}),$table.append(proxy.getHeaderTable().find("colgroup").clone()),f=n(proxy.getRows()[i]),f.empty(),r?f.addClass("e-addedrow"):f.addClass("e-rowedit"),$mainTd=t.buildTag("td","",{},{colspan:proxy.model.columns.length}),c=proxy.getHeaderTable(),s=t.buildTag("tr.e-treegridrows e-selectionbackground e-active",{height:o},{}),$tbody=t.buildTag("tbody"),$cellEditTemplate=proxy._cellEditTemplate,u=0;u<proxy.model.columns.length;u++)e={},htmlString=$cellEditTemplate.find("#"+proxy.model.columns[u].field+"_CellEdit").html(),e[proxy.model.columns[u].field]=proxy._updatedRecords[i][proxy.model.columns[u].field],$element=n(n.templates(htmlString).render(e)),h=t.buildTag("td.e-rowcell","",{height:o,"vertical-align":"middle;",overflow:"hidden"},{}),$element.get(0).tagName=="SELECT"&&($element.val(e[proxy.model.columns[u].field]),$element.val()==null&&$element.val($element.find("option").first().val())),s.append(h.append($element)),$tbody.append(s);$table.append($tbody);$form.append($table);$mainTd.append($form);f.append($mainTd);proxy._isRowEdit=!0;proxy._setoffsetWidth();proxy._editAddTools();proxy._refreshEditForm()}});t.TreeGrid.Actions={Sorting:"sorting",BeginEdit:"beginedit",Save:"save",Add:"add",Delete:"delete",Cancel:"cancel",Refresh:"refresh",Searching:"searching",ExpandCollapse:"expandcollapse",Selection:"selection",rowHover:"rowHover",Scroll:"scroll",ContextMenuAdd:"contextMenuAdd",RefreshDataSource:"refreshDataSource"};t.TreeGrid.SelectionType={Single:"single",Multiple:"multiple"};t.TreeGrid.EditMode={Normal:"normal",CellEditing:"cellEditing",RowEditing:"rowEditing"};t.TreeGrid.RowPosition={Top:"top",Bottom:"bottom",Above:"aboveSelectedRow",Below:"belowSelectedRow"};t.TreeGrid.EditingType={String:"stringedit",Boolean:"booleanedit",Numeric:"numericedit",Dropdown:"dropdownedit",DatePicker:"datepicker",DateTimePicker:"datetimepicker"};t.TreeGrid.ContextMenuItems={Add:"add",Edit:"edit",Delete:"delete"};t.TreeGrid=t.TreeGrid||{};t.TreeGrid._initCellEditType=function(i,r,u,f){var s=i,h=s.model,e=h.columns,o=e[f],c,l,a,v,y,p,w;t.isNullOrUndefined(e[f].editType)&&(o.editType="stringedit");switch(o.editType){case"stringedit":h.isFromGantt?(c={},c["_"+u+"cellValue"]=t.TreeGrid._getCellValue,o.field==="predecessor"&&(c["_"+u+"predecessorCell"]=t.Gantt._getPredecessorsValue),n.views.helpers(c),l=o.field==="predecessor"?t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+u+"predecessorCell('"+h.predecessorMapping+"')}}",id:u+o.field,name:o.field}):t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+s._id+"cellValue('"+e[f].field+"')}}",id:s._id+h.columns[f].field,name:h.columns[f].field})):l=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:#data['"+o.field+"']}}",id:u+o.field,name:o.field});r.html(l);break;case"booleanedit":r.html("{{if "+e[f].field+'}} <input class="e-field e-checkbox" type ="checkbox" id='+s._id+e[f].field+" name="+e[f].field+' checked="checked"><\/input> {{else}}  <input class="e-field e-checkbox" type ="checkbox"  id='+s._id+e[f].field+" name="+e[f].field+" >  {{/if}}");break;case"numericedit":a=t.buildTag("input.e-numerictextbox e-field","",{},{type:"text",value:"{{:#data['"+e[f].field+"']}}",id:s._id+e[f].field,name:e[f].field});r.append(a);break;case"datepicker":case"datetimepicker":v=t.buildTag("input.e-"+e[f].editType+" e-field","",{},{type:"text",value:"{{:#data['"+e[f].field+"']}}",id:u+e[f].field,name:e[f].field});r.append(v);break;case"dropdownedit":h.isFromGantt?(y=t.buildTag("input.e-field e-dropdownlist e-field","",{},{type:"text",value:"{{:#data['"+e[f].field+"']}}",id:u+e[f].field,name:e[f].field}),r.append(y)):t.isNullOrUndefined(o.dropdownData)||(p=o.dropdownData,w=s._compiledDropDownTemplate(),r.get(0).innerHTML=["<select>",w.render(p),"<\/select>"].join(""),r.find("select").prop({id:s._id+o.field,name:o.field}).addClass("e-field e-dropdownlist"))}};t.TreeGrid._getCellValue=function(n){var t=this.data[n];return t?t:this.data.item&&this.data.item[n]};t.TreeGrid.ToolbarItems={Add:"add",Edit:"edit",Delete:"delete",Update:"update",Cancel:"cancel",ExpandAll:"expandAll",CollapseAll:"collapseAll"};t.TreeGrid._getrowClassName=function(){var n="gridrowIndex",t=this;return t.data.parentItem&&(n+=t.data.parentItem.index.toString()),n+="level",n+t.data.level.toString()};t.TreeGrid.getColumnByField=function(n,t){var i=0;for(i;i<n.length;i++)if(n[i].field==t)break;return i==n.length?null:n[i]};t.TreeGrid.getColumnByMappingName=function(n,t){var i=0;for(i;i<n.length;i++)if(n[i].mappingName==t)break;return i==n.length?null:n[i]};t.TreeGrid.sendExpandCollapseRequest=function(i,r){var u=i,e=u.model,v,a,p,c,o;if(r.requestType=t.TreeGrid.Actions.ExpandCollapse,(u._isRowEdit||u.model.isEdit)&&(u.cancelRowEditCell(),u._cancelSaveTools()),e.enableVirtualization)u._isFromGantt?u._$treegridHelper.ejTreeGrid("processBindings",r):u.processBindings(r),r.expanded?u._trigger("expanded",r):u._trigger("collapsed",r),u._isFromGantt?(u._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",r),u._updatedGanttRecords=u.getUpdatedRecords(),u._currentViewData=u.getCurrentViewData(),u.model.enableVirtualization&&(u.model.predecessorMapping&&(u._isValidationEnabled=!1,u._connectorlineIds=[],u._connectorLinesCollection=[],u._$ganttchartHelper.ejGanttChart("clearConnectorLines"),u._createConnectorLinesCollection()),u._$ganttchartHelper.ejGanttChart("refreshHelper",u._currentViewData,u._updatedGanttRecords),u._$treegridHelper.ejTreeGrid("refreshHeight"))):(u.sendDataRenderingRequest(r),u._setScrollTop(),u._$gridContent.ejScroller("refresh"),u._updateScrollCss());else{var f=r.data,l,s,h=0,y=f.expanded!==r.expanded;l=u._isFromGantt?u._currentViewData.indexOf(f):u.model.currentViewData.indexOf(f);s=n(u.getRows()[l]);r.expanded?(f.expanded=r.expanded,u._expandedRecordsCount=0,t.TreeGrid.expandRecord(u,f,r.expanded,r),y&&(u._totalCollapseRecordCount-=u._expandedRecordsCount),s.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),s.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand"),e.enableAltRow&&t.TreeGrid.updateAltRow(u,f,l,1)):(u._collapsedRecordCount=0,t.TreeGrid.collapseRecord(u,f,r.expanded),y&&(u._totalCollapseRecordCount+=u._collapsedRecordCount),f.expanded=r.expanded,s.find(".e-treegridexpand").removeClass("e-treegridexpand").addClass("e-treegridcollapse"),s.removeClass("e-treegridrowexpand").addClass("e-treegridrowcollapse"),e.enableAltRow&&t.TreeGrid.updateAltRow(u,f,l,u._collapsedRecordCount+1));v=0;u._searchString?(v=u.getUpdatedRecords().filter(function(n){return u.getExpandStatus(n)===!1}),h=(u.getUpdatedRecords().length-v.length)*e.rowHeight):h=(u.getUpdatedRecords().length-u._totalCollapseRecordCount)*e.rowHeight;u._isFromGantt?(u._$treegridHelper.ejTreeGrid("updateHeight",h),u._$ganttchart.ejGanttChart("updateHeight",h),u._$ganttchart.ejGanttChart("setCollapsedRecordCount",u._totalCollapseRecordCount),u._$treegridHelper.ejTreeGrid("setCollapsedRecordCount",u._totalCollapseRecordCount)):u.updateHeight(h);r.expanded?u._trigger("expanded",r):u._trigger("collapsed",r)}if(u._isFromGantt){var w=u._$treegridHelper.ejTreeGrid("instance"),b=u._$ganttchart.ejGanttChart("instance"),k=w._$gridContent.ejScroller("option","scrollTop");b._$bodyContainer.ejScroller("option","scrollTop",k)}a=u.selectedItem();u._isFromGantt||r.expanded||!a||(p=u.getExpandStatus(a),p||(u.selectRows(-1),u.selectedRowIndex(-1),a.isSelected=!1,e.selectedItem=null,c=u.model.editSettings,o=[],c.allowEditing&&!n(n(".e-edit")[0]).parent("li").hasClass("e-disable")&&o.push(n(n(".e-edit")[0]).parent()[0]),c.allowDeleting&&!n(n(".e-delete")[0]).parent("li").hasClass("e-disable")&&o.push(n(n(".e-delete")[0]).parent()[0]),c.allowDeleting&&!n(n(".e-cancel")[0]).parent("li").hasClass("e-disable")&&o.push(n(n(".e-cancel")[0]).parent()[0]),c.allowDeleting&&!n(n(".e-save")[0]).parent("li").hasClass("e-disable")&&o.push(n(n(".e-save")[0]).parent()[0]),n(".e-treegridtoolbar").ejToolbar("disableItem",o)))};t.TreeGrid.expandRecord=function(i,r,u,f){var e=i,a=".gridrowIndex"+r.index.toString()+"level"+(r.level+1).toString(),v=n(a),h=0,l=v.length,y,c,b=e.model,s=n(a),o,p=e.getRows(),w=n(p[o]);for(o=e._isFromGantt?e._currentViewData.indexOf(r):b.currentViewData.indexOf(r),r.hasChildRecords&&r.childRecords.length>0&&(w.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),w.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand")),e._expandedRecordsCount+=e._isFromGantt?s.length/2:s.length,s.length===0&&e.model.allowSearching&&e._searchString&&e._searchString.length>0&&f&&t.TreeGrid.sendExpandCollapseRequest(e,f),s.css({display:"table-row"}),e._isFromGantt&&(l=l/2),h;h<l;h++)y=v[h],o=p.index(y),o!==-1&&(c=e._isFromGantt?e._updatedGanttRecords[o]:e._updatedRecords[o],c.isExpanded=!0,c.expanded&&t.TreeGrid.expandRecord(e,c,u));e._isFromGantt&&e.updateConnectorLines(s,u)};t.TreeGrid.collapseRecord=function(i,r,u){var f=i,p=f.model,l=".gridrowIndex"+r.index.toString()+"level"+(r.level+1).toString(),a=n(l),e=0,s=a.length,v,h,c,o=n(l),w=f.getRows(),y;for(f._collapsedRecordCount+=f._isFromGantt?o.length/2:o.length,o.css({display:"none"}),f._isFromGantt&&(f.updateConnectorLines(o,u),s=s/2),e;e<s;e++)v=a[e],y=f.getRows(),h=f.getRows().index(v),h!==-1&&(c=f.getUpdatedRecords()[h],c.expanded&&t.TreeGrid.collapseRecord(f,c,u))};t.TreeGrid.updateAltRow=function(t,i,r,u){for(var e=t,f=0,l=e.model,c=e._isFromGantt?e._currentViewData:l.currentViewData,a=c.length,o=i.isAltRow,s,h=e.getRows(),f=r+u;f<a;f++)n(h[f]).css("display")!=="none"&&(s=c[f],f!=0&&(s.isAltRow=!o),o=s.isAltRow,o?n(h[f]).addClass("e-alt-row"):n(h[f]).removeClass("e-alt-row"))};jQuery.uaMatch=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}}}(jQuery,Syncfusion),function(n,t,i){t.widget("ejGanttChart","ej.GanttChart",{element:null,model:null,_rootCSS:"e-ganttchart",keyConfigs:{focus:"e",insertRecord:"45",deleteRecord:"46",editRecord:"113",saveRequest:"13",cancelRequest:"27",firstRowSelection:"36",lastRowSelection:"35",upArrow:"38",downArrow:"40",moveCellRight:"9",moveCellLeft:"shift+9",selectedRowExpand:"alt+40",totalRowExpand:"ctrl+40",selectedRowCollapse:"alt+38",totalRowCollapse:"ctrl+38"},defaults:{childPropertyName:"",taskIdMapping:"",taskNameMapping:"",startDateMapping:"",endDateMapping:"",childMapping:"",finishDateMapping:"",durationMapping:"",milestoneMapping:"",progressMapping:"",predecessorMapping:"",resourceInfoMapping:"",resourceNameMapping:"",resourceCollection:[],holidays:[{day:null,label:null,background:null}],stripLines:[{day:null,label:null,lineStyle:"dotted",lineColor:"#169dd7",lineWidth:2}],enableTaskbarTooltip:!0,enableTaskbarDragTooltip:!0,highlightWeekends:!0,scheduleStartDate:null,scheduleEndDate:null,enableProgressBarResizing:!0,rowHeight:30,progressbarHeight:100,connectorlineWidth:1,dateFormat:"MM/dd/yyyy",locale:"en-US",taskbarBackground:"#DE8080",progressbarBackground:"#C44647",weekendBackground:"#F2F2F2",connectorLineBackground:"#383838",parentTaskbarBackground:"#383838",parentProgressbarBackground:"#1C1C1C",selectedItem:null,selectedRowIndex:-1,perDayWidth:null,perMonthWidth:null,perWeekWidth:null,perHourWidth:null,queryTaskbarInfo:null,taskbarTemplate:null,progressbarTemplate:null,parenttaskbarTemplate:null,parentprogressbarTemplate:null,rows:[],ganttRecords:[],scheduleWeeks:[],scheduleYears:[],scheduleMonths:[],scheduleDays:[],projectStartDate:null,projectEndDate:null,updatedGanttRecords:[],tooltipTemplate:null,tooltipTemplateId:null,progressbarTooltipTemplateId:null,taskbarEditingTooltipTemplateId:null,taskbarEditingTooltipTemplate:null,progressbarTooltipTemplate:null,showTaskNames:!0,showProgressStatus:!0,showResourceNames:!0,enableRowHover:!1,includeWeekend:!1,allowZooming:!1,allowGanttChartEditing:!0,allowKeyboardNavigation:!0,renderBaseline:!1,baselineColor:"#fba41c ",editSettings:{allowEditing:!1,allowAdding:!1,allowDeleting:!1,editMode:"normal",dialogEditorTemplateId:null},scheduleHeaderSettings:{weekHeaderFormat:"MMM dd , yyyy",dayHeaderFormat:"ddd",weekendBackground:"#F2F2F2",yearHeaderFormat:"yyyy",monthHeaderFormat:"MMM",hourHeaderFormat:"HH",scheduleHeaderType:"week"},workingTimeScale:"TimeScale8Hours",roundOffDayworkingTime:!0,durationUnit:"day",localizedDays:null,localizedMonths:null,columnHeaderTexts:null,enablePredecessorEditing:!0},updateHighlightWeekends:function(n){var t=this;t.model.highlightWeekends=n;t.model.highlightWeekends==!0?t._renderWeekends():t._$weekendContainer.remove()},updateWeekendBackground:function(n){var t=this;t.model.weekendBackground=n;t._$weekendContainer.remove();t._renderWeekends()},showTooltip:function(n){var t=this;t.model.enableTaskbarTooltip=n;t._createTaskbarTemplate();t._refresh()},showEditingTooltip:function(n){var t=this;t.model.enableTaskbarDragTooltip=n;t._createTaskbarTemplate();t._refresh()},updateConnectorLineBackground:function(n){var t=this;t.model.connectorLineBackground=n;t._createConnectorLineTemplate()},updateConnectorlineWidth:function(n){var t=this;t.model.connectorlineWidth=parseInt(n);t._createConnectorLineTemplate()},updateTaskbarBackground:function(n){var t=this;t.model.taskbarBackground=n;this._createTaskbarTemplate();this._refresh()},updateProgressbarBackground:function(n){this.model.progressbarBackground=n;this._createTaskbarTemplate();this._refresh()},updateParentTaskbarBackground:function(n){this.model.parentTaskbarBackground=n;this._createTaskbarTemplate();this._refresh()},updateParentProgressbarBackground:function(n){this.model.parentProgressbarBackground=n;this._createTaskbarTemplate();this._refresh()},updateRenderTaskNames:function(n){var t=this;t.model.showTaskNames=n;t._createTaskbarTemplate();t._refresh()},updateRendeProgressStatus:function(n){var t=this;t.model.showProgressStatus=n;t._createTaskbarTemplate();t._refresh()},updateRenderResourceNames:function(n){var t=this;t.model.showResourceNames=n;t._createTaskbarTemplate();t._refresh()},ganttChartEditing:function(n){var t=this;t.model.allowGanttChartEditing=n},resizeProgressbar:function(n){var t=this;t.model.enableProgressBarResizing=n},updateAllowKeyboardNavigation:function(n){this.model.allowKeyboardNavigation=n},updateProgressbarHeight:function(n){var t=this;this.model.progressbarHeight=n;t._createTaskbarTemplate();t._refresh()},updateBaselineColor:function(n){var t=this;this.model.baselineColor=n;t._createTaskbarTemplate();t._refresh()},updateRenderBaseline:function(n){var t=this;this.model.renderBaseline=n;t._createTaskbarTemplate();t._refresh();t._createConnectorLineTemplate()},_getYearWidth:function(){for(var i=this,n=0,t=0,n=0;n<this.model.scheduleYears.length;n++)t+=this._getTemplateYearWidth(this.model.scheduleYears[n]);return t},_getMonthWidth:function(){for(var t,e,i,o=this,s=o.model,r,f=s.scheduleMonths,n=0,u=0;u<f.length;u++)t=f[u],r=typeof t=="object"?new Date(t):Globalize.parseDate(t,"MM/dd/yyyy"),e=new Date(r.getFullYear(),r.getMonth()+1,0),i=e.getDate(),i==31?n+=this.model.perDayWidth*31:i==30?n+=this.model.perDayWidth*30:i==28&&(n+=this.model.perDayWidth*28);return n},_getWeekWidth:function(){return this.model.perDayWidth*7},_getNumberOftWeeks:function(n,t){var i=new Date(n),u=new Date(t),r=[];do r.push(new Date(i)),i.setDate(i.getDate()+7);while(!(i>u));return r},_getHeight:function(){return this._containerHeight},_setHeight:function(n){this._containerHeight=n},getGanttChartRows:function(){return this._ganttChartRows},getUpdatedRecords:function(){return this.model.ganttRecords},setUpdatedRecords:function(n,t,i,r){var u=this;u._currentViewData=n;u.model.updatedGanttRecords=t;u.model.ganttRecords=i;u.model.rows=i;u.model._ids=r},_getFormatedDate:function(n,t){return Globalize.format(n,t)},_getViewportHeight:function(){var n=this,t=n._$headerContainer;return n.element.height()-t.height()-parseFloat(t.css("border-bottom-width"))},updateViewPortHeight:function(){var n=this;n._viewportHeight=n._getViewportHeight()},_init:function(){var r=this,u=r.model,f=u.scheduleHeaderSettings.scheduleHeaderType,e,o;r.element.addClass("e-ganttchart-core");r.element.attr("tabindex","0");r._initPrivateProperties();r._initialize();r._renderGanttChart();r._$bodyContainer.append(r._$bodyContent);r._$ganttChartContainer.append(r._$bodyContainer);n(r._$bodyContainer).css({height:r._viewportHeight+"px"});r.model.enableVirtualization&&n(r._$bodyContent).css({height:u.rowHeight*u.updatedGanttRecords.length+"px"});f=="week"?n(r._$bodyContent).css({width:u.scheduleWeeks.length*r._scheduleWeekWidth+"px"}):f=="year"?n(r._$bodyContent).css({width:r._scheduleYearWidth+"px"}):f=="month"?n(r._$bodyContent).css({width:r._scheduleMonthWidth+"px"}):f=="day"&&n(r._$bodyContent).css({width:u.scheduleDays.length*r.model.perHourWidth*24+"px"});r.createGridLinesTable();r.renderGanttRecords();e=t.buildTag("div");e.append(r._$bodyContent);r._$bodyContainer.append(e);r._$bodyContainer.ejScroller({width:r.element.width(),enableTouchScroll:!1,height:r._getViewportHeight(),scroll:function(n){var t=n.scrollTop;if(n.requestType="scroll",n.delta=t,t!=i)r.onScrollHelper(t);else r._handleScroll(n)}});r._$bodyContainer.ejScroller("model.keyConfigs",{up:"",down:""});r._$bodyContainer.ejScroller("refresh");o=r._$bodyContainer.ejScroller("isHScroll");o?r._$bodyContainer.removeClass("e-borderbox"):r._$bodyContainer.addClass("e-borderbox");r._wireEvents()},reRenderGanttChart:function(t,i){var r=this,u=model.scheduleHeaderSettings.scheduleHeaderType;r._wireEvents();r.model.perDayWidth=t;r.model.ganttRecords=i;r._scheduleWeekWidth=r._getWeekWidth();r._scheduleYearWidth=r._getYearWidth();r._scheduleMonthWidth=r._getMonthWidth();n(r._$secondaryCanvas).empty();n(r._$headerContainer).empty();n(r._$scheduleDiv).empty();r._renderGanttChart();r._$bodyContainer.append(r._$bodyContent);r._$ganttChartContainer.append(r._$bodyContainer);u=="week"?n(r._$bodyContent).css({width:r.model.scheduleWeeks.length*r._scheduleWeekWidth+"px"}):u=="year"?n(r._$bodyContent).css({width:r._scheduleYearWidth+"px"}):u=="month"?n(r._$bodyContent).css({width:r._scheduleMonthWidth+"px"}):u=="day"&&n(r._$bodyContent).css({width:r.model.scheduleDays.length*r.model.perHourWidth*24+"px"})},_initPrivateProperties:function(){var t=this;t._viewportHeight=0;t._prevScrollTop=0;t._scrollTop=0;t._vScrollDir=1;t._$ganttChartContainer=null;t._$headerContainer=null;t._$bodyContainer=null;t._$bodyContent=null;t._$dependencyViewContainer=null;t._$secondaryCanvas=null;t._$ganttViewTable=null;t._$ganttViewTablebody=null;t._weekdays=[];t._rowMargin=0;t._renderedRange=null;t._visibleRange=null;t._vTop=null;t._vBottom=null;t._rTop=null;t._rBottom=null;t._vscrollDist=0;t._containerHeight=0;t._currentViewData=[];t._id=this.element.attr("id");t._ganttChartRows=null;t._filteredRecords=[];t._sortedRecords=[];t._tempSortedRecords=[];t._scheduleHours=[];t._updateScheduleWidth();t._totalMonthWidth=0;t._tempFilteredRecords=[];t._prevLeft=0;t._allowDragging=!1;t._leftResizing=!1;t._rightResizing=!1;t._progressResizing=!1;t._editingContainer=null;t._allowExpandCollapse=!0;t._leftResizer=null;t._taskbarItem=null;t._progressbarItem=null;t._progressResizer=null;t._rightResizer=null;t._tasknameContainer=null;t._mousePosX=0;t._currMousePosX=0;t._currMousePosY=0;t._prevItem={};t._mouseTarget=null;t._mouseDown=!1;t._$scheduleDiv=null;t._leftResizerGripper=null;t._rightResizerGripper=null;t._progressHandle=null;t._progressHandleChild=null;t._mouseOverTooltip=document.getElementById(this.model.tooltipTemplate);t._progressBarTooltipID=document.getElementById(this.model.progressbarTooltipTemplateId);t._taskbarEditingTooltipID=document.getElementById(this.model.taskbarEditingTooltipTemplateId);t._ids=null;t._scrollBarHeight=18;t._windowWidth=n(window).width();t._windowHeight=n(window).height();t._editingItem=null;t._editingTarget=null;t.tooltipState=null;t._visibleRecordsCount=0;t._$gridLinesTablebody=null;t._leftConnectorPoint=null;t._rightConnectorPoint=null;t._childLeftConnectorPoint=null;t._childRightConnectorPoint=null;t._editPredecessor=!1;t._connectorPointX=null;t._connectorPointY=null;t._predecessorTooltip=null;t._totalCollapsedRecord=0},_updateScheduleWidth:function(){var n=this;n._scheduleWeekWidth=n._getWeekWidth();n._numOfWeeks=n._getNumberOftWeeks(this.model.projectStartDate,this.model.projectEndDate);n._scheduleYearWidth=n._getYearWidth();n._scheduleMonthWidth=n._getMonthWidth();n._totalWeekWidth=n._scheduleWeekWidth*n._numOfWeeks.length;n._balanceWidth=n._totalWeekWidth-n._scheduleMonthWidth;n._scheduleMonthWidth+=n._balanceWidth},_initialize:function(){var n=this;n._$ganttChartContainer=t.buildTag("div.e-ganttviewercontainer#ganttviewercontainer"+n._id,"",{width:"100%"},{});n._$headerContainer=t.buildTag("div.e-ganttviewerheaderContainer#ganttviewerheaderContainer"+n._id,"",{},{});n._$bodyContainer=t.buildTag("div.e-ganttviewerbodyContianer#ganttviewerbodyContianer"+n._id,"",{"-ms-touch-action":"none","touch-action":"none"},{});n._$bodyContent=t.buildTag("div.e-ganttviewerbodyContent#ganttviewerbodyContent"+n._id,"",{},{});n._$dependencyViewContainer=t.buildTag("div.e-ganttviewerbodyContianer-dependencyViewContainer#dependencyViewContainer"+n._id,"",{"z-index":"4",position:"absolute"},{});n._$secondaryCanvas=t.buildTag("div.e-ganttviewerbodyContianer-secondaryCanvas","",{"z-index":"3",position:"absolute"},{});n._$weekendsContainer=t.buildTag("div.e-ganttviewerbodyContianer-weekendsContainer","",{"z-index":"1",position:"absolute"},{});n._$ganttViewTable=t.buildTag("table.e-ganttviewerbodyContianer-ganttViewTable#ganttViewTable"+n._id,"",{"z-index":"5",position:"absolute"},{cellspacing:"0px"});n._$scheduleDiv=t.buildTag("div.e-gantt-schedule-container#gantt-schedule"+n._id+"","",{},{})},_getScheduleLength:function(n){var t=this,i=t.model;switch(n){case"week":return i.scheduleWeeks.length*t._scheduleWeekWidth;case"year":return t._scheduleYearWidth;case"month":return t._scheduleMonthWidth;case"day":return i.scheduleDays.length*t.model.perHourWidth*24;default:return i.scheduleWeeks.length*t._scheduleWeekWidth}},_renderGanttChart:function(){var i=this,r=i.model,f,e,o=r.scheduleHeaderSettings.scheduleHeaderType,s,u;if(i._createSchedule(i._getDateType(r.scheduleStartDate),i._getDateType(r.scheduleEndDate)),i._viewportHeight=i._getViewportHeight(),i._$ganttViewTable.css("width",i._getScheduleLength(o)+"px"),f=t.buildTag("colgroup","",{},{}),e=n(document.createElement("col")),e.css("width",i._getScheduleLength(o)+"px"),f.append(e),i._$ganttViewTable.append(f),i._createTooltipTemplate(),i._createEditingTooltipTemplate(),i._createProgressbarTooltipTemplate(),i._createTaskbarTemplate(),i._createConnectorLineTemplate(),i._updateCurrentViewData(),i.model.highlightWeekends==!0&&r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&i._renderWeekends(),i.model.stripLines!=null&&this._renderStripLines(i.model.stripLines),i.model.holidays!=null)for(s=i.model.holidays.length,u=0;u<s;u++)i._renderHoliday(i.model.holidays[u])},renderConnectorLines:function(t){var i=this,r=n.render[i._id+"ConnectorLineTemplate"](t);n(i._$dependencyViewContainer).empty();i._$dependencyViewContainer.append(r);i._$bodyContent.append(i._$dependencyViewContainer)},clearConnectorLines:function(){n(this._$dependencyViewContainer).empty()},appendConnectorLine:function(t){var i=this,r=n.render[i._id+"ConnectorLineTemplate"](t);i._$dependencyViewContainer.append(r)},setCollapsedRecordCount:function(n){this._totalCollapsedRecord=n},getCollapsedRecordCount:function(){return this._totalCollapsedRecord},removeConnectorline:function(t){n("#ConnectorLine"+t).remove()},_wireEvents:function(){var t=this,i=jQuery.uaMatch(navigator.userAgent);t._on(t.element,"mouseenter",".e-gantt-milestone-container,.e-gantt-childtaskbar,.e-gantt-childtaskbar-progress,.e-gantt-parenttaskbar-innerdiv,.e-gantt-parenttaskbar-progress",this._mouseHover);t._on(t.element,"mouseleave",".e-gantt-milestone-container,.e-gantt-childtaskbar,.e-gantt-childtaskbar-progress,.e-gantt-parenttaskbar-innerdiv,.e-gantt-parenttaskbar-progress",this._mouseLeave);t._on(t.element,"click",t._cellClickHandler);t._on(t.element,"mouseenter",".taskbarresizer-left",t._resizerleftOver);t._on(t.element,"mouseleave",".taskbarresizer-left",t._resizerleftLeave);t._on(t.element,"mouseenter",".taskbarresizer-right",t._resizerrightOver);t._on(t.element,"mouseleave",".taskbarresizer-right",t._resizerrightLeave);t._on(t.element,"mouseenter",".progressbarresizer-right",t._progressresizerOver);t._on(t.element,"mouseleave",".progressbarresizer-right",t._progressresizerLeave);t._on(t.element,"mouseenter",".e-connectorpoint-left",t._dragLeftOver);t._on(t.element,"mouseleave",".e-connectorpoint-left",t._dragLeftLeave);t._on(t.element,"mouseenter",".e-connectorpoint-right",t._dragRightOver);t._on(t.element,"mouseleave",".e-connectorpoint-right",t._dragRightLeave);i.browser.toLowerCase()!="msie"?t._on(t.element,"mousedown",".e-tasklabel,.e-parentContainer,.e-childContainer,.e-gantt-milestone-container",t._mousedown):t._on(t.element,"mousedown",".e-tasklabel,.e-parentContainer,.e-childContainer,.e-gantt-milestone-container",t._mousedown);n(t._$bodyContainer).bind("mouseup",n.proxy(t._handleMouseUp,t));n(document).bind("mouseup",n.proxy(t._tooltipMouseup,t));i.browser.toLowerCase()=="chrome"&&(t._on(t.element,"touchstart",".e-tasklabel,.e-parentContainer,.e-childContainer,.e-gantt-milestone-container",t._mousedown),n(document.body).bind("touchmove",function(n){n.preventDefault()}),n(document.body).bind("touchmove",n.proxy(t.handleMouseMove,t)),t._on(t.element,"touchend",".e-tasklabel,.e-parentContainer,.e-childContainer,.e-gantt-milestone-container",t._handleMouseUp),t._on(t.element,"touchleave",".e-tasklabel,.e-parentContainer,.e-childContainer,.e-gantt-milestone-container",t._handleMouseUp),n(t._$bodyContainer).bind("touchend",n.proxy(t._handleMouseUp,t)),n(t._$bodyContainer).bind("touchleave",n.proxy(t._handleMouseUp,t)));t._on(t.element,"mouseenter",".e-stripline",t._stripLineMouseOver);t._on(t.element,"mouseleave",".e-stripline",t._stripLineMouseLeave);t._enableEditingEvents()},_enableEditingEvents:function(){var n=this,t=n.model;t.editSettings.allowEditing&&t.editSettings.editMode==="normal"&&n._on(this.element,"dblclick",".e-ganttviewerbodyContent",n._editdblClickHandler)},_editdblClickHandler:function(){var n=this,i={};n.model.editSettings.editMode==="normal"&&(i.requestType=t.TreeGrid.Actions.BeginEdit,n._trigger("actionBegin",i))},_enableRowHover:function(){var n=this;n.model.enableRowHover?n._on(n.element,"mouseleave mouseenter","#ganttviewerbodyContent,.e-ganttviewerbodyContent tr,.e-ganttviewerbodyContent"+n._id,n._rowHover):n._on(n.element,"mouseleave mouseenter","#ganttviewerbodyContent,.e-ganttviewerbodyContent tr,.e-ganttviewerbodyContent"+n._id)},_stripLineMouseLeave:function(){n(this._mouseOverTooltip).remove()},_stripLineMouseOver:function(i){var s,v;i.target.style.cursor="pointer";var r=this,u=r.model,h=n(i.target),l,c,f,a,e=0,o=0;l=h.hasClass("e-striplinespan")?h[0].parentNode:h[0];c=l.id.match(/(\d+|[A-z]+)/g);(i.type=="mouseenter"||i.type=="mousemove")&&(i||(i=window.event),i.originalEvent.pageX||i.originalEvent.pageY?(e=i.originalEvent.pageX,o=i.originalEvent.pageY):(i.originalEvent.clientX||i.originalEvent.clientY)&&(e=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop),f=t.buildTag("table.e-tooltiptable","",{width:"auto"},{cellspacing:"2px",cellpadding:"2px"}),a=t.buildTag("tbody","<tr><td>"+u.stripLines[c[1]].day+"<\/td><\/tr><tr><td>"+u.stripLines[c[1]].label+"<\/td><\/tr>",{},{}),f.append(a),u.tooltipTemplate==null?r._mouseOverTooltip=t.buildTag("div.e-tooltipgantt#tooltipgantt"+r._id+"",f,{top:o+"px",left:e+15+"px",position:"absolute","z-index":"6"},{}):(typeof u.tooltipTemplate!="object"?(s=n.parseHTML(u.tooltipTemplate),r._mouseOverTooltip=s[0]):(v=n(u.tooltipTemplate)[0].innerHTML,s=n.parseHTML(v),r._mouseOverTooltip=s[1]),n(r._mouseOverTooltip).css({left:e+15+"px",top:o+"px",position:"absolute"}),n(r._mouseOverTooltip).addClass("customTooltip"),r._mouseOverTooltip.innerHTML="<table>"+f[0].innerHTML+"<\/table>"),n(document.body).append(r._mouseOverTooltip))},_tooltipMouseup:function(){var n=this;n._mouseTarget!=null&&n._handleMouseUp(n._mouseTarget)},_clearTooltip:function(){var t=this;n(t._mouseOverTooltip).remove();n(t._taskbarEditingTooltipID).remove();n(t._progressBarTooltipID).remove();n(".e-editingtooltip").remove();n(".e-progressbartooltip").remove()},_mouseWheel:function(n){if(this.model.allowZooming){var r=this,i={},t=null;if(n=n.originalEvent,n.preventDefault(),n.wheelDelta?t=-n.wheelDelta/120:n.detail&&(t=n.detail/3),!t)return;i.requestType="scroll";i.delta=t;r._enbleZooming(i)}},_resizerrightOver:function(n){var t=this,i=n.target,r=i.parentNode;t.model.allowGanttChartEditing==!0&&(this._mouseDown==!1&&(n.target.style.cursor="w-resize"),t._setEditingElements(r))},_resizerrightLeave:function(){var n=this;n.model.allowGanttChartEditing==!0&&n._removeEditingElements()},_resizerleftOver:function(n){var t=this,i=n.target,r=i.parentNode;t.model.allowGanttChartEditing==!0&&(this._mouseDown==!1&&(n.target.style.cursor="e-resize"),t._setEditingElements(r))},_resizerleftLeave:function(){var n=this;n.model.allowGanttChartEditing==!0&&n._removeEditingElements()},_progressresizerOver:function(n){var t=this,i=n.target,r=i.parentNode;t.model.allowGanttChartEditing==!0&&(t._mouseDown==!1&&(i.style.cursor="col-resize"),t._setEditingElements(r))},_progressresizerLeave:function(){var n=this;n.model.allowGanttChartEditing==!0&&n._removeEditingElements()},_secondMouseOverConnectorPoint:function(t,i){var u=this,a,v,y,r,l;if(u._mouseDown&&u._falseLine||i&&u._falseLine){var e=n(t.target),p=u.getGanttChartRows(),a=e.closest("tr"),v=p.index(a),y=u._currentViewData[v],o=u._editingItem,s=y,f,c,h;if(u._prevItem.predecessorTarget==="Start"?f=o.taskId+"S":u._prevItem.predecessorTarget==="Finish"&&(f=o.taskId+"F"),e.hasClass("e-connectorpoint-left")?(f+="S",h="Start"):e.hasClass("e-connectorpoint-right")&&(f+="F",h="Finish"),$table=u._predecessorTooltip.find("table"),$td=$table.find("tbody").find("tr:eq(1)").find("td:eq(2)").text(s.taskName),$td=$table.find("tbody").find("tr:eq(1)").find("td:eq(3)").text(h),r={},r.requestType="validatePredecessor",r.fromItem=o,r.toItem=s,c=r.toItem.item[u.model.predecessorMapping]?r.toItem.item[u.model.predecessorMapping]+","+f:f,r.predecessor=f,r.data={},r.data.taskID=s.taskId,r.predecessorString=[],r.predecessorString.push(c),l=u._completeAction(r),$td=$table.find("tbody").find("tr:eq(0)").find("td:eq(0)"),l?($td.removeClass(),$td.addClass("e-predecessor-true")):($td.removeClass(),$td.addClass("e-predecessor-false")),i)return r}},_dragLeftOver:function(t){var i=this,r=t.target,u=r.parentNode;i.model.predecessorMapping&&i.model.allowGanttChartEditing&&i.model.enablePredecessorEditing&&(this._mouseDown==!1&&(r.style.cursor="pointer"),i._setEditingElements(u));n(u).hasClass("e-parentContainer")||i._secondMouseOverConnectorPoint(t)},_dragLeftLeave:function(){var n=this;n.model.allowGanttChartEditing==!0&&n.model.enablePredecessorEditing&&n._removeEditingElements()},_dragRightOver:function(t){var i=this,r=t.target,u=r.parentNode;i.model.predecessorMapping&&i.model.allowGanttChartEditing&&i.model.enablePredecessorEditing&&(this._mouseDown==!1&&(r.style.cursor="pointer"),i._setEditingElements(u));n(u).hasClass("e-parentContainer")||i._secondMouseOverConnectorPoint(t)},_dragRightLeave:function(){var n=this;n.model.allowGanttChartEditing==!0&&n.model.enablePredecessorEditing&&n._removeEditingElements()},_setEditingElements:function(t){var i=this,r;n(t).hasClass("e-childContainer")&&(i._leftResizerGripper=t.childNodes[1],i._rightResizerGripper=t.childNodes[5],r=t.childNodes[4],i._progressHandle=r.firstChild,i._progressHandleChild=r.childNodes[1],n(i._leftResizerGripper).addClass("gripper"),n(i._rightResizerGripper).addClass("gripper"),i.model.progressMapping&&(n(i._progressHandle).addClass("e-progresshandle"),n(i._progressHandleChild).addClass("e-progresshandleafter")));i.model.enablePredecessorEditing&&(n(t).hasClass("e-childContainer")&&i.model.predecessorMapping&&!i._falseLine?(i._leftConnectorPoint=t.childNodes[0],i._rightConnectorPoint=t.childNodes[6],n(i._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(i._rightConnectorPoint).addClass("e-connectorpoint-hover")):n(t).hasClass("e-gantt-milestone-container")&&i.model.predecessorMapping&&!i._falseLine?(i._leftConnectorPoint=t.childNodes[0],i._rightConnectorPoint=t.childNodes[2],n(i._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(i._rightConnectorPoint).addClass("e-connectorpoint-hover")):n(t).hasClass("e-childContainer")&&i.model.predecessorMapping&&i._falseLine?(i._childLeftConnectorPoint=t.childNodes[0],i._childRightConnectorPoint=t.childNodes[6],n(i._childLeftConnectorPoint).addClass("e-connectorpoint-hover"),n(i._childRightConnectorPoint).addClass("e-connectorpoint-hover")):n(t).hasClass("e-gantt-milestone-container")&&i.model.predecessorMapping&&i._falseLine?(i._childLeftConnectorPoint=t.childNodes[0],i._childRightConnectorPoint=t.childNodes[2],n(i._childLeftConnectorPoint).addClass("e-connectorpoint-hover"),n(i._childRightConnectorPoint).addClass("e-connectorpoint-hover")):n(t).hasClass("e-parentContainer")&&i.model.predecessorMapping&&!i._falseLine&&(i._leftConnectorPoint=t.childNodes[0],i._rightConnectorPoint=t.childNodes[3],n(i._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(i._rightConnectorPoint).addClass("e-connectorpoint-hover")))},_removeEditingElements:function(){var t=this;n(t._leftResizerGripper).removeClass("gripper");n(t._rightResizerGripper).removeClass("gripper");t.model.progressMapping&&(n(t._progressHandle).removeClass("e-progresshandle"),n(t._progressHandleChild).removeClass("e-progresshandleafter"));t.model.enablePredecessorEditing&&(t.model.predecessorMapping&&t._mouseDown==!1&&(n(t._leftConnectorPoint).removeClass("e-connectorpoint-hover"),n(t._rightConnectorPoint).removeClass("e-connectorpoint-hover"),t._leftConnectorPoint=null,t._rightConnectorPoint=null),(t.model.predecessorMapping&&t._leftConnectorPoint!==null&&t._mouseDown==!0||t._childLeftConnectorPoint)&&(n(t._childLeftConnectorPoint).removeClass("e-connectorpoint-hover"),n(t._childRightConnectorPoint).removeClass("e-connectorpoint-hover"),t._predecessorTooltip&&($table=t._predecessorTooltip.find("table"),$table.find("tbody").find("tr:eq(1)").find("td:eq(2)").text(""),$table.find("tbody").find("tr:eq(1)").find("td:eq(3)").text(""),$td=$table.find("tbody").find("tr:eq(0)").find("td:eq(0)").removeClass(),$td.addClass("e-predecessor-false"))))},refreshHeight:function(){var n=this;n._$bodyContainer.ejScroller("refresh")},_mousedown:function(i){var r=this;r._clearTooltip();r._mouseDown=!0;args={};var e=n(i.target),c=r.getGanttChartRows(),h=e.closest("tr"),s=c.index(h),f=r._currentViewData[s],u=e[0].parentNode,o=jQuery.uaMatch(navigator.userAgent);t.isNullOrUndefined(f)||(r._editingItem=f,r._editingTarget=e,(n(u).hasClass("e-gantt-childtaskbar-progress")||n(u).hasClass("progressbarresizer-right"))&&(u=u.parentNode),(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone")||n(u).hasClass("e-parentContainer")||n(u).hasClass("e-gantt-milestone-container"))&&(n(h).addClass("e-editmode"),r._mouseTarget=i),r.model.allowGanttChartEditing&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone")||n(u).hasClass("e-gantt-milestone-container")||n(u).hasClass("e-parentContainer"))&&((i.target.style.cursor=="e-resize"&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone"))||i.type=="touchstart"&&i.target.className=="taskbarresizer-left"&&o.browser.toLowerCase()=="chrome")&&(r._updateEditingType(),r._leftResizing=!0),(i.target.style.cursor=="w-resize"&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone"))||i.type=="touchstart"&&i.target.className=="taskbarresizer-right"&&o.browser.toLowerCase()=="chrome")&&(r._updateEditingType(),r._rightResizing=!0),(i.target.style.cursor=="col-resize"&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone"))||i.type=="touchstart"&&i.target.className=="progressbarresizer-right"&&o.browser.toLowerCase()=="chrome")&&(r._updateEditingType(),r._progressResizing=!0),i.target.style.cursor=="move"&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone"))&&(r._updateEditingType(),r._allowDragging=!0),i.target.style.cursor==""&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone"))&&(r._updateEditingType(),r._allowDragging=!0),r.model.enablePredecessorEditing&&i.target.style.cursor=="pointer"&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone")||n(u).hasClass("e-gantt-milestone-container")||n(u).hasClass("e-parentContainer"))&&(r._updateEditingType(),r._editPredecessor=!0,e.hasClass("e-connectorpoint-left")?r._prevItem.predecessorTarget="Start":e.hasClass("e-connectorpoint-right")&&(r._prevItem.predecessorTarget="Finish")),i||(i=window.event),t.browserInfo().name=="msie"&&t.browserInfo().version<9&&(i.originalEvent.pageX=i.originalEvent.screenX,i.originalEvent.pageY=i.originalEvent.screenY),i.originalEvent.pageX||i.originalEvent.pageY?(r._currMousePosX=i.originalEvent.pageX,r._currMousePosY=i.originalEvent.pageY,r.dragPosX=i.originalEvent.pageX):i.originalEvent.clientX||i.originalEvent.clientY?r.dragPosX=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft:i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches.length>0&&(r._currMousePosX=i.originalEvent.changedTouches[0].pageX,r._currMousePosY=i.originalEvent.changedTouches[0].pageY,r.dragPosX=i.originalEvent.changedTouches[0].pageX),r._prevItem.left=f.left,r._prevItem.status=f.status,r._prevItem.duration=f.duration,r._prevItem.startDate=f.startDate,r._prevItem.endDate=f.endDate,r._prevItem.width=f.width,r.model.enablePredecessorEditing&&(r._connectorPointX=r._currMousePosX-r._$bodyContent.offset().left,r._connectorPointY=r._currMousePosY-r._$bodyContent.offset().top),n(r._$bodyContainer).bind("mousemove",n.proxy(r.handleMouseMove,r)),o.browser.toLowerCase()=="chrome"&&(r._on(r.element,"touchend",".e-tasklabel,.e-parentContainer,.e-childContainer,.e-gantt-milestone-container",r._handleMouseUp),r._on(r.element,"touchleave",".e-tasklabel,.e-parentContainer,.e-childContainer,.e-gantt-milestone-container",r._handleMouseUp),n(r._$bodyContainer).bind("touchend",n.proxy(r._handleMouseUp,r)),n(r._$bodyContainer).bind("touchleave",n.proxy(r._handleMouseUp,r)),n(document.body).bind("touchend",n.proxy(r._handleMouseUp,r)),n(document.body).bind("touchleave",n.proxy(r._handleMouseUp,r)))),!n(u).hasClass("e-parentContainer")||e.hasClass("e-connectorpoint-left")||e.hasClass("e-connectorpoint-right")?r._appendTooltip(e,s):r._allowExpandCollapse&&f&&f.hasChildRecords&&(r.model.selectedRowIndex!==args.recordIndex&&model.allowSelection&&(args.target="ejGanttChart",args.data=f,r.model.selectedRowIndex=r.model.updatedGanttRecords.indexOf(args.data),r.selectRows(r.model.selectedRowIndex),args.recordIndex=r.model.selectedRowIndex,r._trigger("rowSelected",args),r.prevSelectedItem!=null&&(r.prevSelectedItem.isSelected=!1,r.model.updatedGanttRecords[r.model.selectedRowIndex].isSelected=!0),r.prevSelectedItem=args.data),r._expandCollapse(s)))},handleMouseMove:function(n){this._updateOnmouseMove(n)},_handleMouseUp:function(t){var i=this,r={},h=i.getGanttChartRows(),o,f,s=0,u,e;(n(t.target).hasClass("e-connectorpoint-left")||n(t.target).hasClass("e-connectorpoint-right"))&&i._falseLine&&!n(t.target).parent().hasClass("e-parentContainer")&&(e=i._secondMouseOverConnectorPoint(t,!0),e.predecessorValidation&&(e.requestType="drawConnectorLine",i._completeAction(e)));i._editingTarget!=null&&i._editingItem!=null&&(o=i._editingTarget,f=o.closest("tr"),s=h.index(f),u=i._editingItem,n(f).hasClass("e-editmode")&&(n(f).removeClass("e-editmode"),i._mouseTarget=null));i._editingTarget=null;i._editingItem=null;i._clearTooltip();i._$ganttChartContainer[0].style.cursor="auto";i._allowExpandCollapse=!0;u!=null&&i.updateConnectorLineOffset(u);u!=null&&(i._allowDragging||i._leftResizing||i._rightResizing||i._progressResizing)&&(r.editingFields={startdate:u.startDate,enddate:u.endDate,progress:u.status,duration:u.duration},r.data=u,r.previousData=i._prevItem,r.dragging=i._allowDragging,r.leftResizing=i._leftResizing,r.rightResizing=i._rightResizing,r.progressResizing=i._progressResizing,i._taskbarEdited(r));r.cancel&&(i._getPrevItem(u,s),i.model.predecessorMapping&&(r.requestType="updateConnectors",i._trigger("actionComplete",r)));n("#ganttviewerbodyContianer"+i._id).unbind("mousemove");i._updateEditingType();i._mouseDown=!1;i._falseLine&&i._falseLine.remove();i._falseLine=null;i._predecessorTooltip&&i._predecessorTooltip.remove();i._predecessorTooltip=null;n(i._leftConnectorPoint).removeClass("e-connectorpoint-hover");n(i._rightConnectorPoint).removeClass("e-connectorpoint-hover");n(i._childRightConnectorPoint).removeClass("e-connectorpoint-hover");n(i._childLeftConnectorPoint).removeClass("e-connectorpoint-hover");i._leftConnectorPoint=null;i._rightConnectorPoint=null;i._childRightConnectorPoint=null;i._childLeftConnectorPoint=null},getChildCount:function(n,t){var r,u=this,i;if(!n.hasChildRecords)return 0;for(i=0;i<n.childRecords.length;i++)r=n.childRecords[i],t++,r.hasChildRecords&&(t=u.getChildCount(r,t));return t},_getCollapsedParentItem:function(n){var t=n.parentItem;return t?t.expanded===!1?t:this._getCollapsedParentItem(t):null},_keyPressed:function(n,t,i,r){var u=this,k=u.element,d=k.ejGanttChart("instance"),f=d.model,s,v,p,l,a,h,w,y,b,c;if(r.stopImmediatePropagation(),r.preventDefault(),!f.allowKeyboardNavigation)return!0;switch(n){case"downArrow":if(!u._rowSelectingEventTrigger()&&(s=u.model.updatedGanttRecords.length-1,u.model.selectedRowIndex!=s)){f.enableVirtualization||f.selectedItem.expanded?u.selectRows(u.model.selectedRowIndex+1):(v=u.getChildCount(f.selectedItem,0),p=u.model.selectedRowIndex+v+1,s>=p&&u.selectRows(u.model.selectedRowIndex+v+1));f.selectedItem.isSelected=!0;var e=f.selectedItem&&u.model.updatedGanttRecords.indexOf(f.selectedItem),o=s!==-1&&e*f.rowHeight,h,w,y=u._$bodyContainer.children(".e-content").length;h=y?u._$bodyContainer.children(".e-content").scrollTop():u._$bodyContainer.scrollTop();w=h+u._viewportHeight-f.rowHeight-u._scrollBarHeight+u.getCollapsedRecordCount()*f.rowHeight;w<o&&u._$bodyContainer.ejScroller("scrollY",h+f.rowHeight,!0);f.enableVirtualization&&(u.element[0].focus(),u.selectRows(u.model.selectedRowIndex));u._rowSelectedEventTrigger(u.model.selectedRowIndex)}break;case"upArrow":u._rowSelectingEventTrigger()||u.model.selectedRowIndex!==0&&(c=u.model.updatedGanttRecords[u.model.selectedRowIndex-1],y=u._$bodyContainer.children(".e-content").length,!f.enableVirtualization&&c.parentItem?(l=u._getCollapsedParentItem(c),l?(a=u.getChildCount(l,0),u.selectRows(u.model.selectedRowIndex-a-1)):u.selectRows(u.model.selectedRowIndex-1)):u.selectRows(u.model.selectedRowIndex-1),e=u.model.updatedGanttRecords.indexOf(f.selectedItem),o=e!==-1&&e*f.rowHeight-u.getCollapsedRecordCount()*f.rowHeight,h=y?u._$bodyContainer.children(".e-content").scrollTop():u._$bodyContainer.scrollTop(),h&&h>o&&(o>=0?u._$bodyContainer.ejScroller("scrollY",o,!0):u._$bodyContainer.ejScroller("scrollY",0,!0),f.enableVirtualization&&(u.selectRows(e),u.element[0].focus())),u._rowSelectedEventTrigger(u.model.selectedRowIndex));break;case"firstRowSelection":u._rowSelectingEventTrigger()||(u.selectRows(0),e=f.updatedGanttRecords.indexOf(f.selectedItem),o=e!==-1&&e*f.rowHeight,b=u._$ganttViewTable.height(),b>u._viewportHeight-u._scrollBarHeight&&(args={requestType:"scroll",delta:o},u._$bodyContainer.ejScroller("scrollY",o,!0)),f.enableVirtualization&&(u.element[0].focus(),u.selectRows(0)),u._rowSelectedEventTrigger(0));break;case"lastRowSelection":u._rowSelectedEventTrigger()||(s=f.updatedGanttRecords.length-1,c=f.updatedGanttRecords[s],!f.enableVirtualization&&c.parentItem?(l=u._getCollapsedParentItem(c),l?(a=u.getChildCount(l,0),u.selectRows(s-a)):u.selectRows(s)):u.selectRows(s),e=f.selectedItem&&f.updatedGanttRecords.indexOf(f.selectedItem),o=s!==-1&&e*f.rowHeight,o+u.model.rowHeight>=u._viewportHeight&&(h=o+u.model.rowHeight-(u._viewportHeight-u._scrollBarHeight)-u.getCollapsedRecordCount()*f.rowHeight,h>=0&&(args={requestType:"scroll",delta:h},u._$bodyContainer.ejScroller("scrollY",h,!0)),f.enableVirtualization&&(u.element[0].focus(),u.selectRows(e))),u._rowSelectedEventTrigger(e))}return!0},_rowSelectingEventTrigger:function(){var t=this,n=t.model,r={},i,u;return n.selectedRowIndex!==-1&&(u=t.getGanttChartRows(),i=t.model.updatedGanttRecords[n.selectedRowIndex],n.selectedItem=i,r={rowElement:u.eq(n.selectedRowIndex),data:i,recordIndex:n.selectedRowIndex}),t._trigger("rowSelecting",r)},_rowSelectedEventTrigger:function(n){var t=this,i,r=t.getGanttChartRows();i={rowElement:r.eq(n),data:t.model.selectedItem,target:"ejGanttChart",recordIndex:n};t._trigger("rowSelected",i)},_updateEditingType:function(){var n=this;n._leftResizing=!1;n._allowDragging=!1;n._rightResizing=!1;n._progressResizing=!1;n._editPredecessor=!1},updateConnectorLineOffset:function(n){var f,o=this.model,i=n.predecessor,h=[],s,c,l,r,u,t,e;if(i){for(t=0;t<i.length;t++)i[t].to===n.taskId.toString()&&(f=o.rows[o._ids.indexOf(i[t].from)],r=o.rows[o._ids.indexOf(i[t].to)],s=new Date(f.startDate),c=new Date(f.endDate),i[t].predecessorsType=="FS"&&(r.left<f.left+f.width?(u=(f.left+f.width-r.left)/this.model.perDayWidth,u=r.isMilestone==!0?u-1:u,i[t].offset=Math.round(-u)):(u=(r.left-(f.left+f.width))/this.model.perDayWidth,u>=0&&(i[t].offset=Math.round(u))),o.includeWeekend===!1&&(i[t].offset>0?(e=this._calculateWeekendDays(c,new Date(r.startDate)),i[t].offset-=e):i[t].offset<0&&(e=this._calculateWeekendDays(new Date(r.startDate),c),i[t].offset+=e))),i[t].predecessorsType=="SS"&&(r.left<f.left?(u=(f.left-r.left)/this.model.perDayWidth,i[t].offset=Math.round(-u)):r.left>f.left&&(u=(r.left-f.left)/this.model.perDayWidth,i[t].offset=Math.round(u)),o.includeWeekend===!1&&(i[t].offset>0?(e=this._calculateWeekendDays(s,new Date(r.startDate)),i[t].offset-=e):i[t].offset<0&&(e=this._calculateWeekendDays(new Date(r.startDate),s),i[t].offset+=e))),i[t].predecessorsType=="SF"&&(s.getDay()==5&&(l=2*this.model.perDayWidth),r.left+r.width<f.left?(u=(f.left-(r.left+r.width))/this.model.perDayWidth,l&&this.model.includeWeekend==!1&&(u=u-l),u>0&&(i[t].offset=Math.round(-u))):r.left+r.width>f.left&&(u=(r.left+r.width-f.left)/this.model.perDayWidth,l&&this.model.includeWeekend==!1&&(u=u-l),u>0&&(i[t].offset=Math.round(u))),o.includeWeekend===!1&&(i[t].offset>0?(e=this._calculateWeekendDays(s,new Date(r.startDate)),i[t].offset-=e):i[t].offset<0&&(e=this._calculateWeekendDays(new Date(r.startDate),s),i[t].offset+=e))),i[t].predecessorsType=="FF"&&(r.left+r.width<f.left+f.width?(u=(f.left+f.width-(r.left+r.width))/this.model.perDayWidth,i[t].offset=Math.round(-u)):r.left+r.width>f.left+f.width&&(u=(r.left+r.width-(f.left+f.width))/this.model.perDayWidth,i[t].offset=Math.round(u)),o.includeWeekend===!1&&(i[t].offset>0?(e=this._calculateWeekendDays(c,new Date(r.endDate)),i[t].offset-=e):i[t].offset<0&&(e=this._calculateWeekendDays(new Date(r.endDate),c),i[t].offset+=e))),i[t].offset<0?h.push(i[t].from+""+i[t].predecessorsType+""+i[t].offset+"d"):i[t].offset>=1?h.push(i[t].from+""+i[t].predecessorsType+"+"+i[t].offset+"d"):h.push(i[t].from+""+i[t].predecessorsType));h.length>0&&(n.item[o.predecessorMapping]=h.join(","))}},_calculateWeekendDays:function(n,t){for(var i=0;n<t;)n.setDate(n.getDate()+1),(n.getDay()===0||n.getDay()==6)&&++i;return i},_getPrevItem:function(n,t){var i=this;n.left=i._prevItem.left;n.width=i._prevItem.width;n.startDate=i._prevItem.startDate;n.endDate=i._prevItem.endDate;n.duration=i._prevItem.duration;n.status=i._prevItem.status;n.progressWidth=this._getProgressWidth(n.width,n.status);this.refreshRow(t)},_enableLeftResizing:function(i,r){var u=this;i.target.style.cursor="e-resize";n(u._leftResizer).addClass("gripper");n(u._rightResizer).addClass("gripper");u.dragPosX>u._mousePosX?(u._mousePosX=u.dragPosX-u._mousePosX,r.left>0&&(r.left+30<r.left+r.width&&(r.left-=u._mousePosX),r.width+=u._mousePosX)):(u._mousePosX-=u.dragPosX,r.left+30<r.left+r.width&&(r.left+=u._mousePosX),r.width-=u._mousePosX);this.dragPosX=i.originalEvent.pageX==0?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX;r.width=model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day?r.width<u.model.perHourWidth?u.model.perHourWidth:r.width:r.width<u.model.perDayWidth?u.model.perDayWidth:r.width;r.progressWidth=u._getProgressWidth(r.width,r.status);u._setItemPosition(r);u._taskbarItem&&u._taskbarItem.childNodes.length>0&&u._taskbarItem.removeChild(u._taskbarItem.lastChild)},_enableProgressResizing:function(t,i){var r=this,u,f;t.target.style.cursor="col-resize";n(r._leftResizer).addClass("gripper");n(r._rightResizer).addClass("gripper");r._progressResizer&&(r._progressHandle=r._progressResizer.firstChild,r._progressHandleChild=r._progressResizer.childNodes[1]);r.dragPosX>r._mousePosX?(r._mousePosX=r.dragPosX-r._mousePosX,i.left>0&&(i.progressWidth-=r._mousePosX)):(r._mousePosX-=r.dragPosX,i.progressWidth+=r._mousePosX);this.dragPosX=t.originalEvent.pageX==0?t.originalEvent.targetTouches[0].pageX:t.originalEvent.pageX;i.progressWidth=i.progressWidth>i.width?i.width:i.progressWidth;i.progressWidth=i.progressWidth<0?0:i.progressWidth;u=i.width-i.progressWidth;f=u<=4?4-u:0;n(r._progressbarItem).css({width:i.progressWidth+"px",left:i.left+"px","border-top-right-radius":f+"px","border-bottom-right-radius":f+"px"});n(r._progressResizer).css({left:i.left+i.progressWidth-10+"px"});n(r._progressHandle).addClass("e-progresshandle");n(r._progressHandleChild).addClass("e-progresshandleafter")},_enableRightResizing:function(i,r){var u=this;i.target.style.cursor="w-resize";n(u._leftResizer).addClass("gripper");n(u._rightResizer).addClass("gripper");u.dragPosX>u._mousePosX?(u._mousePosX=u.dragPosX-u._mousePosX,r.left>0&&(r.width-=u._mousePosX)):(u._mousePosX-=u.dragPosX,r.width+=u._mousePosX);this.dragPosX=i.originalEvent.pageX==0?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX;r.width=model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day?r.width<u.model.perHourWidth?u.model.perHourWidth:r.width:r.width<u.model.perDayWidth?u.model.perDayWidth:r.width;r.progressWidth=u._getProgressWidth(r.width,r.status);n(u._taskbarItem).css({left:r.left+"px",width:r.width+"px"});n(u._progressbarItem).css({width:r.progressWidth+"px",left:r.left+"px"});n(u._rightResizer).css({left:r.left+r.width-12+"px"});n(u._progressResizer).css({left:r.left+r.progressWidth-10+"px"});n(u._tasknameContainer).css({left:r.left+"px",width:r.width+"px"});n(u._leftConnectorPoint).css({left:r.left-10+"px"});n(u._rightConnectorPoint).css({left:r.left+r.width+"px"});u._taskbarItem&&u._taskbarItem.childNodes.length>0&&u._taskbarItem.removeChild(u._taskbarItem.lastChild)},_enableDragging:function(t,i){var r=this;t.target.style.cursor="move";n(t.target.parentNode).hasClass("e-parentContainer")&&(r._allowExpandCollapse=!1);this.dragPosX>r._mousePosX?(r._mousePosX=r.dragPosX-r._mousePosX,i.left>0&&(i.left-=r._mousePosX)):(r._mousePosX-=r.dragPosX,i.left+=r._mousePosX);this.dragPosX=t.originalEvent.pageX==0?t.originalEvent.targetTouches[0].pageX:t.originalEvent.pageX;i.left=i.left<0?0:i.left;n(r._progressbarItem).css({left:i.left+"px"});n(r._taskbarItem).css({left:i.left+"px"});n(r._rightResizer).css({left:i.left+i.width-12+"px"});n(r._leftResizer).css({left:i.left+2+"px"});n(r._progressResizer).css({left:i.left+i.progressWidth-10+"px"});n(r._tasknameContainer).css({left:i.left+"px",width:i.width+"px"});n(r._leftConnectorPoint).css({left:i.left-10+"px"});n(r._rightConnectorPoint).css({left:i.left+i.width+"px"});r._taskbarItem&&r._taskbarItem.childNodes.length>0&&r._taskbarItem.removeChild(r._taskbarItem.lastChild)},_appendTooltip:function(i,r){var u=this,s,o,c=n(i),e=u._currentViewData[r],l=u.model.columnHeaderTexts,h,f;e!=null&&(u._currMousePosX+150>u._windowWidth&&(u._currMousePosX-=u._currMousePosX+150-u._windowWidth),h=c[0],(n(h).hasClass("e-parentContainer")||n(h).hasClass("e-childContainer"))&&(u._editingContainer=h,u._leftResizer=u._editingContainer.childNodes[0],u._taskbarItem=u._editingContainer.childNodes[1],u._progressbarItem=u._editingContainer.childNodes[2],u._progressResizer=u._editingContainer.childNodes[3],u._rightResizer=u._editingContainer.childNodes[4]),this.model.enableTaskbarDragTooltip&&!c.hasClass("e-parentContainer")&&(this._progressResizing==!0?(u._$ganttChartContainer[0].style.cursor="col-resize",o=t.buildTag("table.e-tooltiptable","",{},{cellspacing:"2px",cellpadding:"2px"}),f=t.buildTag("tbody","",{},{}),f[0].innerHTML="<tr><td>"+l.status+" : "+e.status+"%<\/td><\/tr>",o.append(f),u.model.progressbarTooltipTemplate?(u._progressBarTooltipID=t.buildTag("div.e-progressbartooltip#progressbartooltip"+u._id+"","",{top:u._currMousePosY-95+"px",left:u._currMousePosX+"px",position:"absolute","z-index":"6"},{}),f=t.buildTag("tbody",n.render[u._id+"progressbarTooltipTemplate"](e),{},{}),u._progressBarTooltipID[0].innerHTML="<table>"+f[0].innerHTML+"<\/table>"):u.model.progressbarTooltipTemplateId?(u._progressBarTooltipID=t.buildTag("div.e-progressbartooltip#progressbartooltip"+u._id+"","",{top:u._currMousePosY-95+"px",left:u._currMousePosX+"px",position:"absolute","z-index":"6"},{}),f=t.buildTag("tbody",n.render[u._id+"progressbarTooltipTemplate"](e),{},{}),u._progressBarTooltipID[0].innerHTML="<table>"+f[0].innerHTML+"<\/table>"):u._progressBarTooltipID=t.buildTag("div.e-progressbartooltip#progressbartooltip"+u._id+"",o,{top:u._currMousePosY-65+"px",left:u._currMousePosX+"px",position:"absolute","z-index":"6"},{onselectstart:"return false"}),u._progressBarTooltipID&&n(document.body).append(u._progressBarTooltipID)):this._editPredecessor===!0&&u.model.enablePredecessorEditing?u._predecessorTooltip===null&&(u._predecessorTooltip=t.buildTag("div.e-tooltipganttpredecessor#predecessortooltip"+u._id+"","",{top:u._currMousePosY+10+"px",left:u._currMousePosX+10+"px",position:"absolute","z-index":"6"},{onselectstart:"return false"}),o=t.buildTag("table.e-tooltiptable","",{},{cellspacing:"2px",cellpadding:"2px"}),f=t.buildTag("tbody","",{},{}),f[0].innerHTML="<tr><td class='e-predecessor-false'><\/td><td >From:<\/td><td class='e-tooltiptaskname'>"+e.taskName+"<\/td><td>"+u._prevItem.predecessorTarget+"<\/td> <\/tr><tr><td><\/td><td>To:<\/td><td class='e-tooltiptaskname'><\/td><td><\/td><\/tr>",o.append(f),u._predecessorTooltip.append(o),n(document.body).append(u._predecessorTooltip)):(u._leftResizing==!0||u._rightResizing==!0||u._allowDragging==!0)&&(u._leftResizing==!0?(u._$ganttChartContainer[0].style.cursor="e-resize",s={ttipstartDate:e.startDate,ttipduration:e.duration}):u._rightResizing==!0?(u._$ganttChartContainer[0].style.cursor="w-resize",s={ttipendDate:e.endDate,ttipduration:e.duration}):u._allowDragging==!0&&(u._$ganttChartContainer[0].style.cursor="move",s={ttipstartDate:e.startDate,ttipendDate:e.endDate}),o=t.buildTag("table.e-tooltiptable","",{},{cellspacing:"2px",cellpadding:"2px"}),u.model.taskbarEditingTooltipTemplate?(u._taskbarEditingTooltipID=t.buildTag("div.e-editingtooltip#editingtooltip"+u._id+"","",{top:u._currMousePosY-95+"px",left:u._currMousePosX+"px",position:"absolute","z-index":"6"},{}),u.tooltipState="editingTemplateID",f=t.buildTag("tbody",n.render[u._id+"editingTooltipTemplate"](e),{},{}),u._taskbarEditingTooltipID[0].innerHTML="<table>"+f[0].innerHTML+"<\/table>"):u.model.taskbarEditingTooltipTemplateId?(u._taskbarEditingTooltipID=t.buildTag("div.e-editingtooltip#editingtooltip"+u._id+"","",{top:u._currMousePosY-95+"px",left:u._currMousePosX+"px",position:"absolute","z-index":"6"},{}),u.tooltipState="editingTemplate",f=t.buildTag("tbody",n.render[u._id+"editingTooltipTemplate"](e),{},{}),u._taskbarEditingTooltipID[0].innerHTML="<table>"+f[0].innerHTML+"<\/table>"):(u.tooltipState="",s&&(f=t.buildTag("tbody",n.render[u._id+"editingTooltipTemplate"](s),{},{}),o.append(f)),u._taskbarEditingTooltipID=t.buildTag("div.e-editingtooltip#editingtooltip"+u._id+"",o,{top:u._currMousePosY-95+"px",left:u._currMousePosX+"px",position:"absolute","z-index":"6"},{})),u._taskbarEditingTooltipID&&n(document.body).append(u._taskbarEditingTooltipID))))},_setItemPosition:function(t){var i=this;n(i._leftResizer).css({left:t.left+2+"px"});n(i._rightResizer).css({left:t.left+t.width-12+"px"});n(i._taskbarItem).css({left:t.left+"px",width:t.width+"px"});n(i._progressbarItem).css({left:t.left+"px",width:t.progressWidth+"px"});n(i._progressResizer).css({left:t.left+t.progressWidth-10+"px"});n(i._tasknameContainer).css({left:t.left+"px",width:t.width+"px"});n(i._leftConnectorPoint).css({left:t.left-10+"px"});n(i._rightConnectorPoint).css({left:t.left+t.width+"px"})},_getTemplate:function(t){var i,r;return typeof t!="object"?(i=n.parseHTML(this.model.tooltipTemplate),i[0]):(r=n(t)[0].innerHTML,i=n.parseHTML(r),i[1])},_updateOnmouseMove:function(i){var r=this,o={},s,e=r._editingTarget?r._editingTarget:null,c=r.getGanttChartRows(),h=e?e.closest("tr"):null,l=c.index(h),u=r._editingItem,f=e?e[0].parentNode:null;(n(f).hasClass("progressbarresizer-right")||n(f).hasClass("e-gantt-childtaskbar-progress"))&&(f=f.parentNode);u!=null&&(o.editingFields={startdate:u.startDate,enddate:u.endDate,progress:u.status,duration:u.duration},o.rowData={rowData:u},r._taskbarEditing(o),o.cancel||(i||(i=window.event),t.browserInfo().name=="msie"&&t.browserInfo().version<9&&(i.originalEvent.pageX=i.originalEvent.screenX,i.originalEvent.pageY=i.originalEvent.screenY),i.originalEvent.pageX||i.originalEvent.pageY?(r._mousePosX=i.originalEvent.pageX,s=i.originalEvent.pageY):i.originalEvent.clientX||i.originalEvent.clientY?(r._mousePosX=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,s=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop):(i.originalEvent.touches[0].pageX||i.originalEvent.touches[0].pageY)&&(r._mousePosX=i.originalEvent.targetTouches[0].pageX,s=i.originalEvent.targetTouches[0].pageY),e.hasClass("e-gantt-milestone")?n(h).hasClass("e-editmode")&&this._editMilestone(i):(n(f).hasClass("e-childContainer")&&(r._editingContainer=f,r._leftResizer=r._editingContainer.childNodes[1],r._taskbarItem=r._editingContainer.childNodes[2],r._progressbarItem=r._editingContainer.childNodes[3],r._progressResizer=r._editingContainer.childNodes[4],r._rightResizer=r._editingContainer.childNodes[5],r._tasknameContainer=r._editingContainer.childNodes[5],r.model.predecessorMapping&&r.model.enablePredecessorEditing&&(r._leftConnectorPoint=f.childNodes[0],r._rightConnectorPoint=f.childNodes[6],n(r._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(r._rightConnectorPoint).addClass("e-connectorpoint-hover"))),n(h).hasClass("e-editmode")&&(n(f).hasClass("e-parentContainer")||n(f).hasClass("e-gantt-milestone-container")||n(f).hasClass("e-childContainer"))&&(r._leftResizing==!0?(r._enableLeftResizing(i,u),r._updateEditedItem(u,"leftResizing")):r._progressResizing==!0&&r.model.enableProgressBarResizing&&r.model.progressMapping?(r._enableProgressResizing(i,u),r._updateEditedItem(u,"progressResizing")):r._rightResizing==!0?(r._enableRightResizing(i,u),r._updateEditedItem(u,"rightResizing")):r._allowDragging==!0?(r._enableDragging(i,u),r._updateEditedItem(u,"dragging")):r._editPredecessor==!0&&r._drawFalseLine(i,u))),r._clearTooltip(),r._appendTooltip(e,l)))},_editMilestone:function(t){var i=this,u=i._editingTarget,f=u[0].parentNode,e=i.getGanttChartRows(),o=u.closest("tr"),s=e.index(o),r=i._editingItem;r!=null&&(t||(t=window.event),t.originalEvent.pageX||t.originalEvent.pageY?i._mousePosX=t.originalEvent.pageX:t.originalEvent.clientX||t.originalEvent.clientY?i._mousePosX=t.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft:(t.originalEvent.touches[0].pageX||t.originalEvent.touches[0].pageY)&&(i._mousePosX=t.originalEvent.targetTouches[0].pageX,posy=t.originalEvent.targetTouches[0].pageY),t.target.style.cursor="move",i.dragPosX>i._mousePosX?(i._mousePosX=i.dragPosX-i._mousePosX,r.left>0&&(r.left-=i._mousePosX)):(i._mousePosX-=i.dragPosX,r.left+=i._mousePosX),this.dragPosX=t.originalEvent.pageX==0?t.originalEvent.targetTouches[0].pageX:t.originalEvent.pageX,r.left=r.left<0?0:r.left,n(f).css({left:r.left+"px"}),n(i._leftConnectorPoint).css({left:r.left-10+"px"}),n(i._rightConnectorPoint).css({left:r.left+24+"px"}),i._updateEditedItem(r,"dragging"),i._appendTooltip(u,s))},_updateEditedItem:function(n,i){var k=this,r=k.model,f=n._getFormatedDate(r.projectStartDate,r.dateFormat),f=n._getDateFromFormat(f,r.dateFormat),nt=n._getDateFromFormat(n.startDate,r.dateFormat).getHours(),tt=n._getDateFromFormat(n.startDate,r.dateFormat).getMinutes(),e,h,o,p,c,u,y,a,l,s,v,d,g;switch(i){case"dragging":e=n.left%r.perDayWidth;h=(n.left-e)/r.perDayWidth;o=0;e>0&&r.workingTimeScale!=t.Gantt.workingTimeScale.TimeScale24Hours&&r.workingTimeScale!=t.Gantt.workingTimeScale.TimeScale24Hours&&(o=e>=r.perDayWidth/2?1:0);r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day||r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&r.dateFormat.indexOf("hh")!=-1?(s=Math.round(e/(r.perDayWidth/24)),f.setDate(f.getDate()+h+o),r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours?f.setHours(s):f.setHours(8)):r.dateFormat.indexOf("hh:")&&r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(s=Math.round(e/(r.perDayWidth/9)),f.setHours(8+s),f.setDate(f.getDate()+h+o));n.startDate=n._calculateFormatedDate(f,r.dateFormat);n._calculateEndDate(r.includeWeekend,r.holidays,r,r.perDayWidth);r.startDateMapping&&(n.item[r.startDateMapping]=n.startDate);r.endDateMapping&&(n.item[r.endDateMapping]=n.endDate);break;case"leftResizing":e=n.left%r.perDayWidth;h=(n.left-e)/r.perDayWidth;o=0;e>0&&r.workingTimeScale!=t.Gantt.workingTimeScale.TimeScale24Hours&&r.workingTimeScale!=t.Gantt.workingTimeScale.TimeScale24Hours&&(o=e>=r.perDayWidth/2?1:0);s=Math.round(e/(r.perDayWidth/24));f.setDate(f.getDate()+h+o);r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day||r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&r.dateFormat.indexOf("hh")!=-1?r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours?f.setHours(s):f.setHours(8):r.dateFormat.indexOf("hh:")&&r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(s=Math.round(e/(r.perDayWidth/9)),f.setHours(8+s));n.startDate=n._calculateFormatedDate(f,r.dateFormat);n._calculateDuration(f,new Date(n.endDate),r.includeWeekend,r.holidays,!1,r);Globalize.parseDate(n.startDate,this.model.dateFormat).getTime()==Globalize.parseDate(n.endDate,this.model.dateFormat).getTime()&&t.isNullOrUndefined(n.isMilestone)&&n.isMilestone==!1&&n.duration==0&&(n.duration=1);r.startDateMapping&&(n.item[r.startDateMapping]=n.startDate);r.durationMapping&&(n.item[r.durationMapping]=n.duration);break;case"rightResizing":h=n.width/r.perDayWidth;p=n.width%r.perDayWidth;c=new Date(n.startDate);o=0;p>0&&r.workingTimeScale!="TimeScale24Hours"&&r.workingTimeScale!="TimeScale24Hours"&&(o=p>=r.perDayWidth/2?1:0);var w=n.left+n.width,b=w%r.perDayWidth,s=Math.round(b/(r.perDayWidth/24));if(r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&r.dateFormat.indexOf("hh")==-1?(a=n.left%r.perDayWidth/r.perHourWidth,l=Math.round(b%r.perHourWidth),u=h<1?n._dateUpdate(c,0,l):n._dateUpdate(c,Math.ceil(h-1+o),l),c.setHours(a)):r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&r.dateFormat.indexOf("hh")!=-1?r.durationUnit==t.Gantt.DurationUnit.Hour?(a=Math.round(n.left%r.perDayWidth/(r.perDayWidth/24)),l=Math.round(w/(r.perDayWidth/24)),l-=a,u=n._dateUpdate(c,0,l)):(y=h-1+o,y=Math.round(y),u=n._dateUpdate(c,y,0)):r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&r.dateFormat.indexOf("hh")!=-1?(a=n.left%r.perDayWidth/r.perHourWidth,l=Math.round(w/r.perHourWidth),l-=a,u=n._dateUpdate(c,0,l),c.setHours(a)):u=n._dateUpdate(c,h-1+o,0),r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day||r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&r.dateFormat.indexOf("hh")!=-1?r.workingTimeScale!=t.Gantt.workingTimeScale.TimeScale24Hours&&(r.durationUnit==t.Gantt.DurationUnit.Hour?u.setHours(Math.round(s)):u.setHours(17)):r.dateFormat.indexOf("hh:")&&r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(s=Math.round(b/(r.perDayWidth/9)),u.setHours(Math.round(8+s))),n.endDate=n._calculateFormatedDate(u,r.dateFormat),r.holidays&&r.holidays.length)for(v=0,d=r.holidays.length,v=0;v<d;v++)g=new Date(r.holidays[v]),u===g&&u.setDate(u.getDate()-1);this.model.includeWeekend==!1&&(u.getDay()==0?u.setDate(u.getDate()-2):u.getDay()==6&&u.setDate(u.getDate()-1));n._calculateDuration(c,u,r.includeWeekend,r.holidays,!1,r);r.endDateMapping&&(n.item[r.endDateMapping]=n.endDate);r.durationMapping&&(n.item[r.durationMapping]=n.duration);break;case"progressResizing":n.status=k._getProgressPercent(n.width,n.progressWidth);r.progressMapping&&(n.item[r.progressMapping]=n.status)}},_drawFalseLine:function(n){var i=this,u=i._connectorPointX,f;y1=i._connectorPointY;x2=n.pageX-i._$bodyContent.offset().left;y2=n.pageY-i._$bodyContent.offset().top;var e=Math.sqrt((u-x2)*(u-x2)+(y1-y2)*(y1-y2)),o=Math.atan2(y2-y1,x2-u)*180/Math.PI,r="rotate("+o+"deg)";i._falseLine&&i._falseLine.remove();i._falseLine=t.buildTag("div.e-gantt-falseLine#ganttfalseline"+i._id,"",{},{});i._falseLine.css({"transform-origin":"0% 100%",right:"auto",position:"absolute",transform:r,"-ms-transform":r,"-moz-transform":r,"-webkit-transform":r,"-o-transform":r,"border-top-width":"2px","border-top-style":"dashed","z-index":"5"}).width(e-3).offset({left:u,top:y1});t.browserInfo().name=="msie"&&t.browserInfo().version<9||i._$bodyContent.append(i._falseLine);n.pageX+i._predecessorTooltip.width()+30>i._windowWidth?(f=n.pageX-i._predecessorTooltip.width()-10,i._predecessorTooltip.css("left",f+"px")):i._predecessorTooltip.css("left",n.pageX+10+"px");n.pageY+i._predecessorTooltip.height()+30>i._windowHeight?(f=n.pageY-i._predecessorTooltip.height()*2,i._predecessorTooltip.css("top",f+"px")):i._predecessorTooltip.css("top",n.pageY+10+"px")},_mouseOverTooltip:function(){n(proxy._mouseOverTooltip).remove();this._mouseDown==!1&&(n(proxy._leftResizerGripper).removeClass("gripper"),n(proxy._rightResizerGripper).removeClass("gripper"),proxy.model.progressMapping&&(n(proxy._progressHandle).removeClass("e-progresshandle"),n(proxy._progressHandleChild).removeClass("e-progresshandleafter")))},_mouseLeave:function(){var t=this;n(".e-tooltipgantt").remove();n(".progressbarresizer-right").css({"background-image":"none"});n(t._mouseOverTooltip).remove();this._mouseDown==!1&&(n(t._leftResizerGripper).removeClass("gripper"),n(t._rightResizerGripper).removeClass("gripper"),t.model.progressMapping&&(n(t._progressHandle).removeClass("e-progresshandle"),n(t._progressHandleChild).removeClass("e-progresshandleafter")),t.model.predecessorMapping&&t.model.enablePredecessorEditing&&(n(t._leftConnectorPoint).removeClass("e-connectorpoint-hover"),n(t._rightConnectorPoint).removeClass("e-connectorpoint-hover"),t._leftConnectorPoint=null,t._rightConnectorPoint=null))},_mouseHover:function(i){var h=n(i.target),r=this,u=0,f=0,w=r.getGanttChartRows(),b=h.closest("tr"),e=h[0].parentNode,l,k=w.index(b),o=r._currentViewData[k],v,c,a,s;if(r._rightResizing==!1&&r._leftResizing==!1&&r._progressResizing==!1&&r._mouseDown==!1&&(h.hasClass("e-gantt-parenttaskbar-innerdiv")||h.hasClass("e-gantt-parenttaskbar-progress")||r.model.allowGanttChartEditing&&(i.target.style.cursor="move"),(i.type=="mouseenter"||i.type=="mousemove")&&(i||(i=window.event),i.originalEvent.pageX||i.originalEvent.pageY?(u=i.originalEvent.pageX,f=i.originalEvent.pageY):(i.originalEvent.clientX||i.originalEvent.clientY)&&(u=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,f=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop),n(e).hasClass("e-childContainer")&&r.model.allowGanttChartEditing&&(r._leftResizerGripper=e.childNodes[1],r._rightResizerGripper=e.childNodes[5],l=e.childNodes[4],r._progressHandle=l.firstChild,r._progressHandleChild=l.childNodes[1],n(r._leftResizerGripper).addClass("gripper"),n(r._rightResizerGripper).addClass("gripper"),r.model.progressMapping&&(n(r._progressHandle).addClass("e-progresshandle"),n(r._progressHandleChild).addClass("e-progresshandleafter"))),n(e).hasClass("e-childContainer")&&r.model.predecessorMapping&&r.model.allowGanttChartEditing&&r.model.enablePredecessorEditing?(r._leftConnectorPoint=e.childNodes[0],r._rightConnectorPoint=e.childNodes[6],n(r._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(r._rightConnectorPoint).addClass("e-connectorpoint-hover")):n(e).hasClass("e-gantt-milestone")&&r.model.predecessorMapping&&r.model.allowGanttChartEditing&&r.model.enablePredecessorEditing&&(a=e.parentNode,r._leftConnectorPoint=a.childNodes[0],r._rightConnectorPoint=a.childNodes[2],n(r._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(r._rightConnectorPoint).addClass("e-connectorpoint-hover")),o&&r.model.enableTaskbarTooltip))){v={ttipstartDate:o.startDate,ttipendDate:o.endDate,ttipduration:o.duration,ttipprogress:o.status,ttiptaskname:o.taskName};c=t.buildTag("table.e-tooltiptable","",{},{cellspacing:"5"});r.model.tooltipTemplate==null&&r.model.tooltipTemplateId==null?(r.tooltipState="",s=t.buildTag("tbody",n.render[r._id+"tooltipTemplate"](v),{},{}),c.append(s),r._mouseOverTooltip=t.buildTag("div.e-tooltipgantt#tooltipgantt"+r._id+"",c,{top:f+10+"px",left:u+15+"px",position:"absolute","z-index":"6","border-radius":"5px"},{}),r._mouseOverTooltip.innerHTML="<table>"+c[0].innerHTML+"<\/table>",n(document.body).append(r._mouseOverTooltip)):r.model.tooltipTemplate?(r._mouseOverTooltip=t.buildTag("div.e-tooltipgantt#tooltipgantt"+r._id+"","",{top:f+10+"px",left:u+15+"px",position:"absolute","z-index":"6","border-radius":"5px"},{}),n(document.body).append(r._mouseOverTooltip),r.tooltipState="Template",s=t.buildTag("tbody",n.render[r._id+"tooltipTemplate"](o),{},{}),r._mouseOverTooltip[0].innerHTML="<table>"+s[0].innerHTML+"<\/table>"):r.model.tooltipTemplateId&&(r._mouseOverTooltip=t.buildTag("div.e-tooltipgantt#tooltipgantt"+r._id+"","",{top:f+10+"px",left:u+15+"px",position:"absolute","z-index":"6","border-radius":"5px"},{}),n(document.body).append(r._mouseOverTooltip),r.tooltipState="TemplateID",s=t.buildTag("tbody",n.render[r._id+"tooltipTemplate"](o),{},{}),r._mouseOverTooltip[0].innerHTML="<table>"+s[0].innerHTML+"<\/table>");var d=n(document).scrollTop(),y=n(r._mouseOverTooltip).width(),p=n(r._mouseOverTooltip).height(),g=n(window).height()+d;u+y+40>n(window).width()&&(u=u-(y+40));f+p+20>g&&(f=f-p);n(r._mouseOverTooltip).css({left:u+15+"px",top:f+"px",position:"absolute"});n(r._mouseOverTooltip).addClass("customTooltip")}},_createEditingTooltipTemplate:function(){var t=this,f,r=t.model.columnHeaderTexts,s={_getStartDate:t._tooltipStartDate,_getEndDate:t._tooltipEndDate,_getDuration:t._tooltipDuration,_getTaskName:t._tooltipTaskName,_getDurationUnit:n.proxy(t._getEditDurationUnits,t),_getProgress:t._tooltipProgress},e=t.model.taskbarEditingTooltipTemplateId,o=t.model.taskbarEditingTooltipTemplate,i,u;n.views.helpers(s);e?i=n("#"+e)[0].innerHTML:o?i=o:(i="<tr class='e-tooltip_rowcell'>",f="{{if ~_getTaskName()}}<td class='e-tooltiptaskname' style='width:40px;text-align:left;' colspan='3';>{{:ttiptaskname}}<\/td>{{/if}}<\/tr><tr>{{if ~_getStartDate()}}<td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.startDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipstartDate}}<\/td> {{/if}}<\/tr><tr>{{if ~_getEndDate()}}<td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.endDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipendDate}}<\/td>{{/if}}<\/tr><tr>{{if ~_getDuration()}}<td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.duration+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipduration}}  {{: ~_getDurationUnit(#data)}}<\/td>{{/if}}<\/tr><tr>{{if ~_getProgress()}}<td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.status+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipprogress}}%<\/td>{{/if}}",i+=f,i+="<\/tr>");u={};u[t._id+"editingTooltipTemplate"]=i;n.templates(u)},_getEditDurationUnits:function(){var n=this;return n.model.durationUnit==t.Gantt.DurationUnit.Hour?"hours":"days"},_createProgressbarTooltipTemplate:function(){var t=this,u=t.model.progressbarTooltipTemplateId,f=t.model.progressbarTooltipTemplate,i,r;u?i=n("#"+t.model.progressbarTooltipTemplateId)[0].innerHTML:t.model.progressbarTooltipTemplate&&(i=t.model.progressbarTooltipTemplate);r={};r[t._id+"progressbarTooltipTemplate"]=i;n.templates(r)},_createTooltipTemplate:function(){var t=this,f,r=t.model.columnHeaderTexts,e={_getStartDate:t._tooltipStartDate,_getEndDate:t._tooltipEndDate,_getDuration:t._tooltipDuration,_getTaskName:t._tooltipTaskName,_getProgress:t._tooltipProgress,_getDurationUnit:n.proxy(t._getDurationUnits,t)},o=t.model.tooltipTemplateId,s=t.model.tooltipTemplate,i,u;n.views.helpers(e);o?i=n("#"+t.model.tooltipTemplateId)[0].innerHTML:t.model.tooltipTemplate?i=t.model.tooltipTemplate:(i="<tr class='e-tooltip_rowcell'>",f="{{if ~_getTaskName()}}<td class='e-tooltiptaskname' style='width:40px;text-align:left;' colspan='3';>{{:ttiptaskname}}<\/td>{{/if}}<\/tr><tr>{{if ~_getStartDate()}}<td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.startDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipstartDate}}<\/td> {{/if}}<\/tr><tr>{{if ~_getEndDate()}}<td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.endDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipendDate}}<\/td>{{/if}}<\/tr><tr>{{if ~_getDuration()}}<td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.duration+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipduration}} {{: ~_getDurationUnit(#data)}}<\/td>{{/if}}<\/tr><tr>{{if ~_getProgress()}}<td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.status+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipprogress}}%<\/td>{{/if}}",i+=f,i+="<\/tr>");u={};u[t._id+"tooltipTemplate"]=i;n.templates(u)},_tooltipTaskName:function(){return this.data.ttiptaskname},_tooltipProgress:function(){return this.data.ttipprogress},_tooltipStartDate:function(){return this.data.ttipstartDate},_tooltipEndDate:function(){return this.data.ttipendDate},_tooltipDuration:function(){return this.data.ttipduration},_getDurationUnits:function(){var n=this;return n.model.durationUnit==t.Gantt.DurationUnit.Hour?"hours":"days"},_cellClickHandler:function(t){var e=n(t.target),o=e.closest("tr"),i=this,r={},u,f,s=i.getGanttChartRows();(i.model.selectedRowIndex!==-1&&(u=i.model.updatedGanttRecords&&i.model.updatedGanttRecords[i.model.selectedRowIndex],r={rowElement:o,recordIndex:i.model.selectedRowIndex}),i._trigger("rowSelecting",r))||(f=s.index(e.parent()),f==-1&&(f=s.index(o)),f!=-1&&i.model.allowSelection&&(u=i._currentViewData[f],i.model.selectedRowIndex=i.model.updatedGanttRecords.indexOf(u),i.selectRows(i.model.selectedRowIndex),r.target="ejGanttChart",r.data=u,r.recordIndex=i.model.selectedRowIndex,i._trigger("rowSelected",r),i.prevSelectedItem!=null&&(i.prevSelectedItem.isSelected=!1,i.model.updatedGanttRecords[i.model.selectedRowIndex].isSelected=!0),i.prevSelectedItem=u,i.element[0].focus()))},getRowByIndex:function(i,r){var e,o;try{var u=this,f=u.getGanttChartRows(),s=n(f),h=n();return u.model.enableVirtualization&&(e=u.model.updatedGanttRecords[i],i=u._currentViewData.indexOf(e)),t.isNullOrUndefined(r)?(u.model.enableVirtualization&&(o=u.model.updatedGanttRecords[r],r=u._currentViewData.indexOf(o)),n(f[i])):n(s.slice(i,r))}catch(c){return n()}},selectRows:function(n){var t=this,u=t.getGanttChartRows(),i,r;t.model.selectedItem&&(t.model.selectedItem.isSelected=!1);u.removeClass("e-gantt-mouseclick");r=t.getRowByIndex(n);r.addClass("e-gantt-mouseclick");t.model.selectedRowIndex=n;i=t.model.updatedGanttRecords[n];i&&(i.isSelected=!0);t.model.selectedItem=i},updateSelectedItem:function(t){var i=this,r=n(i.getGanttChartRows());r.removeClass("e-gantt-mouseclick");i.model.updatedGanttRecords[t].isSelected=!0;i.model.selectedItem=i.model.updatedGanttRecords[t];this._refresh();i._rowSelectedEventTrigger(t)},ganttrowHover:function(t){var r=this,i;r.model.enableRowHover&&(i=r.getGanttChartRows(),i.removeClass("e-gantt_mousehover").addClass("e-gantt_mouseleave"),n(i[t]).addClass("e-gantt_mousehover").removeClass("e-gantt_mouseleave"))},_rowHover:function(t){var i=this,e=n(t.target),f,u={},r,o;return i.model.enableRowHover?(f=n(i.getGanttChartRows()),r=f.index(e.parent()),r==-1&&(o=e.closest("tr"),r=f.index(o)),u.index=r,t.type=="mouseenter"?(u.reason="mouseenter",i.addRowHover(r)):(u.reason="mouseleave",i.removeRowHover()),i._trigger("rowHover",u),!1):!1},addRowHover:function(t){var i=this.getGanttChartRows();t!=null&&t!=-1&&n(i[t]).addClass("e-enablerowhover")},removeRowHover:function(){var n=this.getGanttChartRows();n.removeClass("e-enablerowhover")},updateHeight:function(t){var i=this,r=i.model;i._setScrollTop();r.stripLines&&n(".e-stripline,.e-stripLines").css({height:t+"px"});r.holidays&&n(".e-holidays,.e-holiday").css({height:t+"px"});n(".e-secondary_canvas").css({height:t+"px"});n(".e-weekends").css({height:t+"px"});t<i._viewportHeight?t<=r.rowHeight?n(".e-holiday-label").css({top:-t-30}):n(".e-holiday-label").css({top:t/2}):n(".e-holiday-label").css({top:i._viewportHeight/2});i._$bodyContainer.ejScroller("refresh")},_completeAction:function(n){var t=this;return n.vscrollExsist=t._$bodyContainer.ejScroller("isVScroll"),t._trigger("actionComplete",n),n.requestType==="validatePredecessor"?n.predecessorValidation:void 0},_taskbarEditing:function(n){var t=this;t._trigger("taskbarEditing",n)},_taskbarEdited:function(n){var t=this;t._trigger("taskbarEdited",n)},_queryTaskbarinfo:function(n){this._trigger("queryTaskbarInfo",n);this._updateTaskbarItems(n)},_refreshRow:function(n){var t=this;t._trigger("refreshRow",n)},_enbleZooming:function(n){var t=this;t._trigger("zooming",n)},_updateTaskbarItems:function(t){var s=this.getGanttChartRows(),h=this.model.rows.indexOf(t.data),r=s[h],i;if(r)if(i=r.childNodes.length>1?r.childNodes[1].firstChild:r.childNodes[0].firstChild,n(i).hasClass("e-parentContainer")){var c=i.firstChild,l=i.childNodes[1],u=c.style,f=l.style;u.backgroundColor!=t.parentTaskbarBackground&&(u.backgroundColor=t.parentTaskbarBackground);f.backgroundColor!=t.parentProgressbarBackground&&(f.backgroundColor=t.parentProgressbarBackground)}else if(n(i).hasClass("e-childContainer")){var a=i.childNodes[2],v=i.childNodes[3],e=a.style,o=v.style;e.backgroundColor!=t.taskbarBackground&&(e.backgroundColor=t.taskbarBackground);o.backgroundColor!=t.progressbarBackground&&(o.backgroundColor=t.progressbarBackground)}},_expandCollapse:function(n){var i=this,t={},r=i._currentViewData[n];t.data=r;t.recordIndex=i.model.updatedGanttRecords&&i.model.updatedGanttRecords.indexOf(r);t.source="ganttChart";t.expanded=!r.expanded;r&&(t.expanded?i._trigger("expanding",t):i._trigger("collapsing",t))},_getExpandStatus:function(n){var t=n.parentItem;return t!=null?t.expanded===!1?!1:t.parentItem?t.parentItem.expanded===!1?!1:this._getExpandStatus(t.parentItem):!0:!0},onScrollHelper:function(t){var i=this,f,r,u;if(!i._$bodyContainer.ejScroller("isVScroll")){t!=0&&i._$bodyContainer.ejScroller("scrollY",0,!0);return}i._mouseLeave();f=n("#ganttviewerbodyContianer"+this._id);n(".e-ganttviewerbodyContent").scrollTop(t);n(".e-ganttviewerbodyContent").parent(".e-content").scrollTop(t);r=parseInt(i.model.updatedGanttRecords.length*30)-(i._viewportHeight-18);t>r&&(t=r);t<0&&(t=0);u={scrollTop:t};i._handleScroll(u)},_handleScroll:function(n){var t=this,n=n||{},f=t._$headerContainer,o=t._$bodyContainer,r=t._prevLeft,u,e;n.scrollTop!==i&&(t._scrollTop=n.scrollTop);n.scrollLeft!==i&&(r=n.scrollLeft);u=r-t._prevLeft;e=t._scrollTop-t._prevScrollTop;u?f.scrollLeft(r):f.scrollLeft(t._prevLeft);t.model.enableVirtualization&&(t._vscrollDist=Math.abs(t._scrollTop-t._prevScrollTop),t._vscrollDist&&(t._vScrollDir=t._prevScrollTop<=t._scrollTop?1:-1,t._updateCurrentViewData(),t.renderGanttRecords(),t._prevScrollTop=t._scrollTop));n.requestType="scroll";n.delta=t._scrollTop;t._prevLeft=r;t._prevScrollTop=t._scrollTop;u===0&&e!==0&&t._completeAction(n)},refreshHelper:function(t,i,r){var u=this,f,e,o;u._currentViewData=t;u.model.updatedGanttRecords=i;i&&(u._refresh(),u._setHeight(i.length*u.model.rowHeight),u.model.enableVirtualization?(n("#ganttviewerbodyContent"+u._id+"").css({height:u._containerHeight+"px"}),u.updateHeight(u._containerHeight)):(f=0,f=r?(i.length-r)*u.model.rowHeight:i.length*u.model.rowHeight,u.updateHeight(f)),e=u._$bodyContainer.ejScroller("isVScroll"),o=u._$bodyContainer.ejScroller("isHScroll"),(e||o)&&u._$bodyContainer.ejScroller("refresh"))},_setScrollTop:function(){var n=this,r=this.model,i=n._scrollTop,t;r.enableVirtualization&&i!==0&&n._currentViewData.length*n.model.rowHeight<n._viewportHeight&&(t=i-(n._viewportHeight-n._currentViewData.length*n.model.rowHeight),t<0&&(t=0),n._$bodyContainer.ejScroller("scrollY",t,!0))},getVisibleRecordsCount:function(){return this._visibleRecordsCount},reRenderGanttGridLinesTable:function(n){var t=this;t._visibleRecordsCount=t._visibleRecordsCount+n<0?t._visibleRecordsCount:t._visibleRecordsCount+n;t._visibleRecordsCount>0&&(t._$gridLinesTablebody.empty().append(t._createGridLinesTableRow(t._visibleRecordsCount)),t._$bodyContainer.ejScroller("refresh"))},refrehGridLinesTable:function(n){var t=this;t._visibleRecordsCount>0&&(t._$gridLinesTablebody.empty().append(t._createGridLinesTableRow(n)),t._$bodyContainer.ejScroller("refresh"),t._visibleRecordsCount=n)},_refresh:function(){var i=this,u=i.model,r=n.render[i._id+"_CustomTemplate2"](i._currentViewData);i._$ganttViewTablebody=n("#ganttViewTablebody"+i._id+"");i._$ganttViewTablebody.empty().append(r);u.enableVirtualization?(i._visibleRecordsCount=i._currentViewData.length,i._$gridLinesTablebody.empty().append(i._createGridLinesTableRow(i._currentViewData.length))):((i._visibleRecordsCount==0||i._visibleRecordsCount>i._currentViewData.length)&&(i._visibleRecordsCount=i._currentViewData.length),i._$gridLinesTablebody.empty().append(i._createGridLinesTableRow(i._visibleRecordsCount)));i._$ganttViewTablebody[0]!=null?this._ganttChartRows=n(i._$ganttViewTablebody[0].childNodes):(i._$ganttViewTablebody=t.buildTag("tbody.e-gantt-viewer-ganttViewTablebody#ganttViewTablebody"+i._id+"",r,{},{}),i._ganttChartRows=n(i._$ganttViewTablebody[0].childNodes));i._eventBindings()},refreshRow:function(t){var i=this,u=n(i.getGanttChartRows()[t]),r=i._currentViewData[t];t!=-1&&r&&(u.replaceWith(n.render[i._id+"_CustomTemplate2"](r)),i._setGanttChartRows(n(i._$ganttViewTablebody[0].childNodes)))},refreshScroller:function(n){var t=this,r,u,i,f,e;t._$bodyContainer.removeClass("e-borderbox");u=t._$bodyContainer.ejScroller("option","scrollTop");i=t._$bodyContainer.ejScroller("option","scrollLeft");t._$bodyContainer.ejScroller("option",{width:n});t._$bodyContainer.ejScroller("refresh");r=t.getMaxScrollWidth();i>r&&(i=r>0?r:0);f=t._$bodyContainer.ejScroller("isHScroll");f?t._$bodyContainer.removeClass("e-borderbox"):t._$bodyContainer.addClass("e-borderbox");e=t._$bodyContainer.ejScroller("isVScroll");e&&t._$bodyContainer.ejScroller("scrollY",u,!0);t._$bodyContainer.ejScroller("option","scrollLeft",i);t._$headerContainer.scrollLeft(i)},getMaxScrollWidth:function(){var n=this;return n._$bodyContainer.children(".e-content").children().width()-n._$bodyContainer.children(".e-content").width()},refreshStripLines:function(){this._renderStripLines(this.model.stripLines)},refreshHolidays:function(){var n=this,i,t;if(n.model.holidays!=null)for(i=n.model.holidays.length,t=0;t<i;t++)n._renderHoliday(n.model.holidays[t])},renderRecord:function(t,i){var r=this,f=r.model,u;addedchartRow=n.render[this._id+"_CustomTemplate2"](t._cAddedRecord);r._ganttChartRows.length!=0&&(u=r._currentViewData.indexOf(f.selectedItem),t.position?t.position=="Above"?r.getGanttChartRows().eq(u-1).before(addedchartRow):t.position=="Below"&&r.getGanttChartRows().eq(u).after(addedchartRow):u==-1?r.getGanttChartRows().eq(0).before(addedchartRow):r.getGanttChartRows().eq(u).after(addedchartRow),r._setGanttChartRows(n(r._$ganttViewTablebody[0].childNodes)));r._ganttChartRows.length==0&&(r._updateCurrentViewData(),r._refresh(),r._setGanttChartRows(n(r._$ganttViewTablebody[0].childNodes)));f.enableVirtualization===!1?r._setHeight((r.model.updatedGanttRecords.length-i)*r.model.rowHeight):r._setHeight(r.model.updatedGanttRecords.length*r.model.rowHeight);r.updateHeight(r._containerHeight);r._$bodyContainer.ejScroller("refresh")},_setGanttChartRows:function(n){this._ganttChartRows=n},refreshChartHeader:function(i,r){var u=this,v=u.model,e=v.scheduleHeaderSettings.scheduleHeaderType,c,a,s,f,h,l,o;u._updateScheduleWidth();e=="month"&&u._createScheduleTopMonthTemplate();i=i==null?new Date:i;r=r==null?new Date(null):r;u._$scheduleDiv.empty();o=t.buildTag("table.e-schedule-headerrow-week","",{display:"block"},{"cell-spacing":"0"});c=t.buildTag("colgroup","",{},{});a=n(document.createElement("col"));a.css("width",u._getScheduleLength(e)+"px");c.append(a);s=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{});e=="week"?f=t.buildTag("tr",n.render[this._id+"ScheduleWeekTemplate"](u.model.scheduleWeeks),{},{}):e=="year"?f=t.buildTag("tr",n.render[this._id+"ScheduleYearTemplate"](u.model.scheduleYears),{},{}):e=="month"?f=t.buildTag("tr",n.render[this._id+"ScheduleTopMonthTemplate"](u.model.scheduleMonths),{},{}):e=="day"&&(f=t.buildTag("tr",n.render[this._id+"ScheduleTopDayTemplate"](u.model.scheduleDays),{},{}));h=t.buildTag("th.schedule","",{},{});l=t.buildTag("div.schedule","",{width:"20px"},{});h.append(l);f.append(h);s.append(f);o.append(c);o.append(s);u._$scheduleDiv.append(o);f=null;o=t.buildTag("table.e-schedule-headerrow-day","",{display:"block","border-collapse":"collapse"},{"cell-spacing":"0"});s=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{});e=="week"&&(f=t.buildTag("tr",n.render[this._id+"_CustomTemplate1"](u.model.scheduleWeeks),{},{}));e=="year"&&(f=t.buildTag("tr",n.render[this._id+"ScheduleMonthTemplate"](u.model.scheduleYears),{},{}));e=="month"&&(u._numOfWeeks=u._getNumberOftWeeks(this.model.projectStartDate,this.model.projectEndDate),f=t.buildTag("tr",n.render[this._id+"ScheduleBottomWeekTemplate"](u._numOfWeeks),{},{}));e=="day"&&(f=t.buildTag("tr",n.render[this._id+"scheduleHourTemplate"](u._getScheduleHours()),{},{}));h=t.buildTag("th.schedule","",{},{});l=t.buildTag("div.schedule","",{width:"20px"},{});h.append(l);f.append(h);s.append(f);o.append(c);o.append(s);u._$scheduleDiv.append(o)},refreshContainersWidth:function(){var t=this,i,u=model.scheduleHeaderSettings.scheduleHeaderType,f,r;if(i=t._getScheduleLength(u),$gridLineContainerTable=n("#ganttgridLinesTable"+t._id),t._$bodyContent.width(i),u==="week"&&t.refreshWeekEndContainer(),$gridLineContainerTable.width(i),$gridLineContainerTable.children("col").width(i),t._$ganttViewTable.width(i),t._$ganttViewTable.children("col").width(i),t._createTaskbarTemplate(),t._$secondaryCanvas.empty(),t.model.stripLines!=null&&this._renderStripLines(t.model.stripLines),t.model.holidays!=null)for(f=t.model.holidays.length,r=0;r<f;r++)t._renderHoliday(t.model.holidays[r])},refreshWeekEndContainer:function(){var n=this,i=0,f=n.model.perDayWidth+1,e=n.model.updatedGanttRecords.length*this.model.rowHeight,h=n.model.scheduleWeeks.length,o,s,r=n._$weekendsContainer.children(".e-secondary_canvas"),u;for(r.empty(),u=0;u<h;u++)o=t.buildTag("div.e-weekends","",{left:i+"px",width:f+"px",height:e+"px","background-color":this.model.weekendBackground},{}),s=t.buildTag("div.e-weekends","",{left:i+n.model.perDayWidth*6+"px",width:f+"px",height:e+"px","background-color":this.model.weekendBackground},{}),r.append(o),r.append(s),i=i+this._scheduleWeekWidth;n._$weekendsContainer.append(r)},deleteChartRows:function(n,t){for(var r=this,u=r.getGanttChartRows(),i=n;i<n+t;i++)u.splice(i,1)},_eventBindings:function(){var h=n(this.getGanttChartRows()),c=h.length,r,t={},f,e,o,s,i,u;if(c!=0)for(u=0;u<c;u++)r=h[u],n(r).hasClass("e-ganttrowcell")&&(i=r.childNodes.length>1?r.childNodes[1].firstChild:r.childNodes[0].firstChild,n(i).hasClass("e-parentContainer")?(s=i.firstChild,o=i.childNodes[1]):n(i).hasClass("e-childContainer")&&(e=i.childNodes[1],f=i.childNodes[2]),t.data=this.model.updatedGanttRecords[u],t.taskbar=r,t.taskbarBackground=e!=null?e.style.backgroundColor:null,t.progressbarBackground=f!=null?f.style.backgroundColor:null,t.parentTaskbarBackground=s!=null?s.style.backgroundColor:null,t.parentProgressbarBackground=o!=null?o.style.backgroundColor:null,this._queryTaskbarinfo(t))},_updateCurrentViewData:function(){var t=this,i=0;this.model.enableVirtualization?(this._getRenderedRowRange(),this._currentViewData=this.model.updatedGanttRecords.slice(t._renderedRange.top,t._renderedRange.bottom),t._vscrollDist!==0&&(i=t._scrollTop-t._rowMargin),n("#ganttViewTable"+t._id+"").css({top:i+"px"}),n("#ganttgridLinesTable"+t._id+"").css({top:i+"px"}),t._vTop=t._visibleRange.top,t._vBottom=t._visibleRange.bottom,t._rTop=t._renderedRange.top,t._rBottom=t._renderedRange.bottom):this._currentViewData=this.model.updatedGanttRecords},renderGanttRecords:function(){var n=this;n._refresh();n._$ganttViewTable.append(n._$ganttViewTablebody);n._$bodyContent.append(n._$ganttViewTable)},_getRenderedRowRange:function(){var n=this,t,i;return n._getVisibleRowRange(),t=n._visibleRange.top,i=n._visibleRange.bottom,n._renderedRange={top:t,bottom:i},n._renderedRange},_getVisibleRowRange:function(){var n=this,r=n._scrollTop/n.model.rowHeight,f=r-Math.floor(r),t,i,u;n._rowMargin=f*n.model.rowHeight;t=Math.floor(r);u=n.model.updatedGanttRecords.length;i=n._getrowposition(n._scrollTop+n._viewportHeight);t=Math.max(0,t);i=Math.min(u,i);n._visibleRange={top:t,bottom:i}},_getrowposition:function(n){return Math.ceil(n/this.model.rowHeight)},_getDateType:function(n){if(n!=null){if(typeof n=="object")return n;var t=new RegExp("\\-","g"),i=new RegExp("\\.","g");return n=n.replace(t,"/"),n=n.replace(i,"/"),new Date(n)}return null},_createScheduleTopDayTemplate:function(){var t=this,u=t.model,f=u.scheduleHeaderSettings.dayHeaderFormat,e={renderDayTop:n.proxy(t._getDaySplit,t)},i,r;n.views.helpers(e);i="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;'>";td="<div class='e-schedule-week-headercell-content'  style='width:"+(t.model.perHourWidth*24-1)+"px;margin:auto;white-space:nowrap;'>{{:~renderDayTop('"+f+"',#data)}}<\/div><\/div>";i+=td;i+="<\/th>";r={};r[t._id+"ScheduleTopDayTemplate"]=i;n.templates(r)},_getDaySplit:function(n,t){var i=new Date(t),r=this,u=r.model;return Globalize.format(i,n,u.locale)},_createScheduleTopMonthTemplate:function(){var t=this,u,f=t.model,e=f.scheduleHeaderSettings.monthHeaderFormat,o={renderMonthTop:n.proxy(t._getMonthsplit,t),setMonthWidth:n.proxy(t._setMonthWidth,t),isLastMonth:n.proxy(t._checkLastMonthWidth,t)},i,r;n.views.helpers(o);i="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;'>";u="<div class='e-schedule-week-headercell-content'  style='margin:auto;white-space:nowrap;width:{{:~setMonthWidth(#data)-1}}px;'>{{:~renderMonthTop('"+e+"',#data)}}<\/div>{{if ~isLastMonth(#data)}}<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;'><div class='e-schedule-week-headercell-content' style='margin:auto;white-space:nowrap;width:"+(t._balanceWidth-1)+"px;'><\/div><\/th>{{/if}}";i+=u;i+="<\/th>";r={};r[t._id+"ScheduleTopMonthTemplate"]=i;n.templates(r)},_setMonthWidth:function(n){var u=this,i,r,t;return(i=typeof n=="object"?new Date(n):Globalize.parseDate(n,"MM/dd/yyyy"),r=new Date(i.getFullYear(),i.getMonth()+1,0),t=r.getDate(),t==31)?this.model.perDayWidth*31:t==30?this.model.perDayWidth*30:t==28?this.model.perDayWidth*28:t==29?this.model.perDayWidth*29:void 0},_checkLastMonthWidth:function(n){var t=this;return n==t.model.scheduleMonths[t.model.scheduleMonths.length-1]&&t._balanceWidth>0?!0:!1},_getMonthsplit:function(n,t){var i=new Date(t),r=this,u=r.model;return Globalize.format(i,n,u.locale)},_createScheduleYearTemplate:function(){var t=this,u,f=t.model,e=f.scheduleHeaderSettings.yearHeaderFormat,o={renderYear:n.proxy(t._getYearsplit,t),getYearWidth:n.proxy(t._getTemplateYearWidth,t)},i,r;n.views.helpers(o);i="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;'>";u="<div class='e-schedule-week-headercell-content'  style='margin:auto;white-space:nowrap;width:{{:~getYearWidth(#data)-1}}px'>{{:~renderYear('"+e+"',#data)}}<\/div>";i+=u;i+="<\/th>";r={};r[t._id+"ScheduleYearTemplate"]=i;n.templates(r)},_getYearsplit:function(n,t){var i=new Date(t),r=this,u=r.model;return Globalize.format(i,n,u.locale)},_getTemplateYearWidth:function(n){var t=n.getFullYear();return new Date(t,1,29).getMonth()===1?366*this.model.perDayWidth:365*this.model.perDayWidth},_createScheduleWeekTemplate:function(){var t=this,u,f=t.model,e=f.scheduleHeaderSettings.weekHeaderFormat,o={renderWeek:n.proxy(t._getWeeksplit,t)},i,r;n.views.helpers(o);i="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;'>";u="<div class='e-schedule-week-headercell-content'  style='width:"+(t._scheduleWeekWidth-1)+"px;margin:auto;white-space:nowrap;'>{{:~renderWeek('"+e+"',#data)}}<\/div>";i+=u;i+="<\/th>";r={};r[t._id+"ScheduleWeekTemplate"]=i;n.templates(r)},_getWeeksplit:function(n,t){var r=new Date(t),u=this,f=u.model,i;return i=Globalize.format(r,n,f.locale),i.toLowerCase().replace(/(-(\w)|(^| )(\w)|:(\w)|,(\w)|\/(\w)|\.(\w))/g,function(n){return n.toUpperCase()})},_createScheduleHourTemplate:function(){var t=this,f=t.model,u,e=f.scheduleHeaderSettings.hourHeaderFormat,o={renderHour:n.proxy(t._getHourTemplate,t)},i,r;n.views.helpers(o);i="<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'>";u="<div class='e-schedule-day-headercell-content' style='width:"+(t.model.perHourWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~renderHour('"+e+"',#data)}}<\/div>";i+=u;i+="<\/th>";r={};r[t._id+"scheduleHourTemplate"]=i;n.templates(r)},_getHourTemplate:function(n,t){var i=new Date(t),r=this,u=r.model;return Globalize.format(i,n,u.locale)},_createScheduleBottomWeekTemplate:function(){var t=this,u,f=t.model,e=f.scheduleHeaderSettings.weekHeaderFormat,o={renderWeek:n.proxy(t._getMonthWeekTemplate,t)},i,r;n.views.helpers(o);i="<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'>";u="<div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;padding-left:2px;width:"+(t.model.perWeekWidth-1)+"px;'>{{:~renderWeek('"+e+"',#data)}}<\/div>";i+=u;i+="<\/th>";r={};r[t._id+"ScheduleBottomWeekTemplate"]=i;n.templates(r)},_getMonthWeekTemplate:function(n,t){var i=new Date(t),r=this,u=r.model;switch(n){case"d":case"dd":case"ddd":default:return Globalize.format(i,n,u.locale)}},_createScheduleMonthTemplate:function(){var i=this,f,e=i.model,t=e.scheduleHeaderSettings.monthHeaderFormat,o={renderMonth:n.proxy(i._getMonthTemplate,i),getMonthWidth:n.proxy(i._setMonthWidthYearMode,i)},r,u;n.views.helpers(o);r="<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'>";f="<div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(0,#data)-1}}px;'>{{:~renderMonth('"+t+"',0,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(1,#data)-1}}px;'>{{:~renderMonth('"+t+"',1,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(2,#data)-1}}px;'>{{:~renderMonth('"+t+"',2,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(3,#data)-1}}px;'>{{:~renderMonth('"+t+"',3,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(4,#data)-1}}px;'>{{:~renderMonth('"+t+"',4,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(5,#data)-1}}px;'>{{:~renderMonth('"+t+"',5,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(6,#data)-1}}px;'>{{:~renderMonth('"+t+"',6,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(7,#data)-1}}px;'>{{:~renderMonth('"+t+"',7,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(8,#data)-1}}px;'>{{:~renderMonth('"+t+"',8,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(9,#data)-1}}px;'>{{:~renderMonth('"+t+"',9,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(10,#data)-1}}px;'>{{:~renderMonth('"+t+"',10,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~getMonthWidth(11,#data)-1}}px;'>{{:~renderMonth('"+t+"',11,#data)}}<\/div>";r+=f;r+="<\/th>";u={};u[i._id+"ScheduleMonthTemplate"]=r;n.templates(u)},_getMonthTemplate:function(n,t,i){var r=new Date(i),f=this,u=f.model;r.setMonth(r.getMonth()+t);switch(n){case"M":case"m":return("0"+r.getDate()).slice(-2);case"MM":case"mm":return r.getDate();case"MMM":case"mmm":case"MMMM":case"mmmm":return Globalize.format(r,n,u.locale);default:return Globalize.format(r,n,u.locale)}},_setMonthWidthYearMode:function(n,t){var f=this,r=new Date(t),u,i;return(r.setMonth(r.getMonth()+n),u=new Date(r.getFullYear(),r.getMonth()+1,0),i=u.getDate(),i==31)?this.model.perDayWidth*31:i==30?this.model.perDayWidth*30:i==28?this.model.perDayWidth*28:i==29?this.model.perDayWidth*29:void 0},_createScheduleDayTemplate:function(){var t=this,f,e=t.model,i=e.scheduleHeaderSettings.dayHeaderFormat,o={renderDay:n.proxy(t._getDayTemplate,t)},r,u;n.views.helpers(o);r="<th  class='e-schedule-day-headercell  e-headercell-weekend' style='-moz-box-sizing:border-box;box-sizing:border-box;background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"'>";f="<div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~renderDay('"+i+"',0,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~renderDay('"+i+"',1,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~renderDay('"+i+"',2,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~renderDay('"+i+"',3,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~renderDay('"+i+"',4,#data)}}<\/div><th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~renderDay('"+i+"',5,#data)}}<\/div><th  class='e-schedule-day-headercell  e-headercell-weekend' style='-moz-box-sizing:border-box;box-sizing:border-box;background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~renderDay('"+i+"',6,#data)}}<\/div>";r+=f;r+="<\/th>";u={};u[t._id+"_CustomTemplate1"]=r;n.templates(u)},_getDayTemplate:function(n,t,i){var r=new Date(i),f=this,u=f.model;r.setDate(r.getDate()+t);switch(n){case"D":case"d":return("0"+r.getDate()).slice(-2);case"DD":case"dd":return r.getDate();case"DDD":case"ddd":case"DDDD":case"dddd":return Globalize.format(r,n,u.locale)[0].toUpperCase();default:return Globalize.format(r,n,u.locale)[0].toUpperCase()}},_createSchedule:function(i,r){var u=this,v=u.model,e=v.scheduleHeaderSettings.scheduleHeaderType,c,a,s,f,h,l,o;i=i==null?new Date:i;r=r==null?new Date(null):r;u._createScheduleWeekTemplate();u._createScheduleYearTemplate();u._createScheduleTopMonthTemplate();u._createScheduleTopDayTemplate();o=t.buildTag("table.e-schedule-headerrow-week","",{display:"block"},{"cell-spacing":"0"});c=t.buildTag("colgroup","",{},{});a=n(document.createElement("col"));a.css("width",u._getScheduleLength(e)+"px");c.append(a);s=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{});e=="week"?f=t.buildTag("tr",n.render[this._id+"ScheduleWeekTemplate"](u.model.scheduleWeeks),{},{}):e=="year"?f=t.buildTag("tr",n.render[this._id+"ScheduleYearTemplate"](u.model.scheduleYears),{},{}):e=="month"?f=t.buildTag("tr",n.render[this._id+"ScheduleTopMonthTemplate"](u.model.scheduleMonths),{},{}):e=="day"&&(f=t.buildTag("tr",n.render[this._id+"ScheduleTopDayTemplate"](u.model.scheduleDays),{},{}));h=t.buildTag("th.schedule","",{},{});l=t.buildTag("div.schedule","",{width:"20px"},{});h.append(l);f.append(h);s.append(f);o.append(c);o.append(s);u._$scheduleDiv.append(o);f=null;u._createScheduleDayTemplate();u._createScheduleMonthTemplate();u._createScheduleBottomWeekTemplate();u._createScheduleHourTemplate();o=t.buildTag("table.e-schedule-headerrow-day","",{display:"block","border-collapse":"collapse"},{"cell-spacing":"0"});s=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{});e=="week"&&(f=t.buildTag("tr",n.render[this._id+"_CustomTemplate1"](u.model.scheduleWeeks),{},{}));e=="year"&&(f=t.buildTag("tr",n.render[this._id+"ScheduleMonthTemplate"](u.model.scheduleYears),{},{}));e=="month"&&(f=t.buildTag("tr",n.render[this._id+"ScheduleBottomWeekTemplate"](u._numOfWeeks),{},{}));e=="day"&&(f=t.buildTag("tr",n.render[this._id+"scheduleHourTemplate"](u._getScheduleHours()),{},{}));h=t.buildTag("th.schedule","",{},{});l=t.buildTag("div.schedule","",{width:"20px"},{});h.append(l);f.append(h);s.append(f);o.append(c);o.append(s);u._$scheduleDiv.append(o);u._$headerContainer.append(u._$scheduleDiv);u._$ganttChartContainer.append(u._$headerContainer);n("#"+u._id).append(u._$ganttChartContainer)},_getScheduleHours:function(){var n=this,r=n.model,t=new Date(n.model.projectStartDate),i=new Date(r.projectEndDate);i.setHours(24);do n._scheduleHours.push(new Date(t)),t.setHours(t.getHours()+1);while(!(t.getTime()>=i.getTime()));return n._scheduleHours},createGridLinesTable:function(){var i=this,f=i.model,r,c=f.scheduleHeaderSettings.scheduleHeaderType,u,s,o,e,h;r=t.buildTag("table.e-ganttgridLinesTable#ganttgridLinesTable"+i._id,"",{"z-index":"2",position:"absolute"},{cellspacing:"0px"});o=t.buildTag("colgroup","",{},{});e=n(document.createElement("col"));switch(c){case"week":u=f.scheduleWeeks.length;r.css("width",u*i._scheduleWeekWidth+"px");e.css("width",u*this._scheduleWeekWidth+"px");break;case"year":u=f.scheduleYears.length;r.css("width",i._scheduleYearWidth+"px");e.css("width",this._scheduleYearWidth+"px");break;case"month":u=f.scheduleMonths.length;r.css("width",i._scheduleMonthWidth+"px");e.css("width",this._scheduleMonthWidth+"px");break;case"day":u=f.scheduleDays.length;r.css("width",u*i.model.perHourWidth*24+"px");e.css("width",u*i.model.perHourWidth*24+"px")}o.append(e);r.append(o);s=i._createGridLinesTableRow(f.updatedGanttRecords.length);h=t.buildTag("tbody.e-gantt-viewer-gridLinesTablebody#gridLinesTablebody"+i._id+"",s,{},{});i._$gridLinesTablebody=h;r.append(i._$gridLinesTablebody);i._$bodyContent.append(r)},_createGridLinesTableRow:function(n){for(var r=this,t="",i=0;i<n;i++)t+="<tr style='display:table-row;height:"+this.model.rowHeight+"px'><td class='e-ganttgridlines'><\/td><\/tr>";return t},_createTaskbarTemplate:function(){var i=this,u=i.model,f,o=u.scheduleHeaderSettings.scheduleHeaderType,v,c=4,r,l=0,s=u.baselineColor,y={_getType:i._getTypedata,_expander:i._addRecordExpandCollapse,_milestoneMapping:i._isMilestone,_resources:n.proxy(i._getResourceInfo,i),_rowClassName:t.TreeGrid._getrowClassName,_expandStatus:n.proxy(i._getExpandStatusRecord,i),_borderRadius:i._getBorderRadius},h,e,a;o=="week"?f=i.model.scheduleWeeks.length*i._scheduleWeekWidth:o=="year"?f=i._scheduleYearWidth:o=="month"?f=i._scheduleMonthWidth:o=="day"&&(f=i.model.scheduleDays.length*i.model.perHourWidth*24);u.renderBaseline?(r=u.rowHeight-c-5,l=0):r=u.rowHeight-10;n.views.helpers(y);u.progressMapping||(this.model.showProgressStatus=!1);u.resourceInfoMapping||(u.showResourceNames=!1);h="<tr class='{{:~_rowClassName()}}  {{if isSelected}}e-ganttrowcell {{:~_expander()}} e-gantt-mouseclick{{else}}e-ganttrowcell {{:~_expander()}}{{/if}}' id='chartrowcell"+i._id+"' style='display:{{:~_expandStatus(#data)}};background-color:{{if rowBGColor }}{{:rowBGColor}}{{else}} none{{/if}};'>";e="{{:~_borderRadius()}}";v="{{if ~_getType()}}{{if "+this.model.showTaskNames+"}}<td class='e-chartcell'><div class='e-tasknameContainer'  unselectable='on' style='left:-{{:width}}px;width:{{:left+width}}px;'><span class='e-taskbarname'  style='margin-top:"+this.model.rowHeight/2+"px;margin-right:30px;font-weight:bold'>{{:taskName}}<\/span><\/div><\/td>{{/if}}<td  class='e-chartcell' vertical-align='middle' style='width:"+f+"px;'><div class='e-parentContainer' unselectable='on' style='height:"+(this.model.rowHeight-1)+"px;z-index:3;'><div class='e-connectorpoint-left' style='left:{{:left-10}}px;width:10px;margin-top:10px;height:"+r/2+"px;'><\/div><div class='e-gantt-parenttaskbar-innerdiv {{:~_expander()}}' style='left:{{:left}}px;margin-top:5px;width:{{:width}}px;height:"+r+"px;background-color:{{if parentTaskbarBackground }}{{:parentTaskbarBackground}}{{else}} "+this.model.parentTaskbarBackground+"{{/if}} ;'><\/div><div  class='e-gantt-parenttaskbar-progress {{:~_expander()}}  progressbar' id='progressbar' style='margin-top:5px;border-style:{{if progressWidth}}solid{{else}}none{{/if}}; left:{{:left}}px;width:{{:progressWidth}}px;height:"+r+"px;position:absolute;background-color:{{if parentProgressbarBackground }}{{:parentProgressbarBackground}}{{else}} "+this.model.parentProgressbarBackground+"{{/if}};z-index:3;border-top-right-radius:"+e+"px;border-bottom-right-radius:"+e+"px;'><\/div><div class='e-connectorpoint-right' style='left:{{:left+width}}px;width:10px;margin-top:10px;height:"+r/2+"px;'><\/div><\/div>{{if "+this.model.renderBaseline+" }}<div  class='e-baselinebar' style='margin-top:-4px;left:{{:baselineLeft}}px;width:{{:baselineWidth}}px;height:"+c+"px;background-color: "+s+";position:absolute;z-index:3;box-sizing:border-box;-moz-box-sizing:border-box;'><\/div>{{/if}}<\/td>{{if "+this.model.showResourceNames+"}}<td class='e-chartcell' ><div class='e-resourceinfo'  unselectable='on' style='margin-top:5px;left:{{:left+width+30}}px;margin:0;margin-left:5px;margin-top:-9px;position:absolute;background-color:transparent;font-weight:bold'><span class='e-resourcename'  style='margin-top:"+this.model.rowHeight/2+"px;margin-right:30px;outline:none;'>{{:~_resources(#data)}}<\/span><\/div><\/td>{{/if}}{{else ~_milestoneMapping()}}{{if "+this.model.showTaskNames+"}}<td class='e-chartcell'><div class='e-tasknameContainer'  unselectable='on' style='left:-{{:width}}px;width:{{:left+width}}px;'><span class='e-taskbarname'  style='margin-top:"+this.model.rowHeight/2+"px;margin-right:30px;'>{{:taskName}}<\/span><\/div><\/td>{{/if}}<td class='e-chartcell' style='width:"+f+"px;'><div class='e-gantt-milestone-container' style=height:"+(this.model.rowHeight-1)+"px;><div class='e-connectorpoint-left' style='left:{{:left-10}}px;width:10px;margin-top:10px;height:"+r/2+"px;'><\/div><div class='e-gantt-milestone' style='position:absolute;left:{{:left}}px;'><div class='e-gantt-milestone milestone-top'  style='top:3px;'><\/div><div class='e-gantt-milestone milestone-bottom'  style='top:15px;'><\/div><\/div><div class='e-connectorpoint-right' style='left:{{:left+24}}px;width:10px;margin-top:10px;height:"+r/2+"px;'><\/div><\/div>{{if "+this.model.renderBaseline+" }}<div class='e-baseline-gantt-milestone-container' ><div class='e-baseline-gantt-milestone' style='position:absolute;left:{{:baselineLeft}}px;z-index:2;'><div class='e-baseline-gantt-milestone baseline-milestone-top'  style=' border-bottom-color: "+s+";z-index:2;top:-26px;'><\/div><div class='e-baseline-gantt-milestone baseline-milestone-bottom'  style=' border-top-color: "+s+";z-index:2;top:-14px;'><\/div><\/div><\/div>{{/if}}<\/td>{{if "+this.model.showResourceNames+"}}<td class='e-chartcell' ><div class='e-resourceinfo'  unselectable='on' style='margin-top:5px;left:{{:left+56}}px;margin:0;margin-left:5px;margin-top:-9px;position:absolute;background-color:transparent;'><span class='e-resourcename'  style='margin-top:"+this.model.rowHeight/2+"px;margin-right:30px;'>{{:~_resources(#data)}}<\/span><\/div><\/td>{{/if}}{{else}}{{if "+this.model.showTaskNames+"}}<td class='e-chartcell'><div class='e-tasknameContainer'  unselectable='on' style='left:-{{:width}}px;width:{{:left+width}}px;'><span class='e-taskbarname'  style='margin-top:"+this.model.rowHeight/2+"px;margin-right:30px;'>{{:taskName}}<\/span><\/div><\/td>{{/if}}<td class='e-chartcell' style='width:"+f+"px;'><div  class='e-childContainer'  unselectable='on' style='height:"+(this.model.rowHeight-1)+"px;'><div class='e-connectorpoint-left' style='left:{{:left-10}}px;width:10px;margin-top:10px;height:"+r/2+"px;'><\/div><div class='taskbarresizer-left e-icon' style='left:{{:left+2}}px;width:10px;margin-top:5px;height:"+r+"px;'><\/div><div  class='e-gantt-childtaskbar' style='left:{{:left}}px;width:{{:width}}px;height:"+r+"px;background-color:{{if taskbarBackground }}{{:taskbarBackground}}{{else}} "+this.model.taskbarBackground+"{{/if}};margin-top:5px;'><\/div><div  class='e-gantt-childtaskbar-progress  progressbar' id='progressbar' style='border-style:{{if progressWidth}}solid{{else}}none{{/if}}; left:{{:left}}px;width:{{:progressWidth}}px;text-align:right;line-height:"+r+"px;margin-top:5px;height:"+this.model.progressbarHeight*(r/100)+"px;position:absolute;background-color:{{if progressbarBackground }}{{:progressbarBackground}}{{else}} "+this.model.progressbarBackground+"{{/if}};border-top-right-radius:"+e+"px;border-bottom-right-radius:"+e+"px;'>{{if "+this.model.showProgressStatus+"}}<span class='e-tasklabel' style=''>{{:status}}%<\/span>{{/if}}<\/div><div class='progressbarresizer-right' style='left:{{:left+progressWidth-10}}px;width:20px;margin-top:5px;height:"+r+"px;position:absolute;z-index:4;'><div class='progressbarresizer-right' style='top:"+(22-l/2)+"px;margin-top:5px;position:absolute;'><div class='e-progresshandler-element'><\/div><\/div><div class='progressbarresizer-right' style='top:"+(17-l/2)+"px;margin-top:5px;position:absolute;'><div class='e-progresshandlerafter-element'><\/div><\/div><\/div><div class='taskbarresizer-right e-icon' style='left:{{:left+width-12}}px;width:10px;height:"+r+"px;position:absolute;z-index:2;margin-top:5px;'><\/div><div class='e-connectorpoint-right' style='left:{{:left+width}}px;width:10px;margin-top:10px;height:"+r/2+"px;'><\/div><\/div>{{if "+this.model.renderBaseline+" }}<div  class='e-baselinebar' style='margin-top:-4px;left:{{:baselineLeft}}px;width:{{:baselineWidth}}px;height:"+c+"px;background-color: "+s+";position:absolute;z-index:3;box-sizing:border-box;-moz-box-sizing:border-box;'><\/div>{{/if}}<\/td>{{if "+this.model.showResourceNames+"}}<td class='e-chartcell' ><div class='e-resourceinfo'  unselectable='on' style='left:{{:left+width+30}}px;margin:0;margin-left:5px;margin-top:-9px;position:absolute;text-align:left;background-color:transparent;'><span class='e-resourcename'  style='margin-top:"+this.model.rowHeight/2+"px;margin-right:30px;'>{{:~_resources(#data)}}<\/span><\/div><\/td>{{/if}}{{/if}}";h+=v;h+="<\/tr>";a={};a[this._id+"_CustomTemplate2"]=h;n.templates(a)},_getResourceInfo:function(n){var i=null,r,t;if(n.resourceInfo!=null){if(r=n.resourceInfo.length,r>0){for(t=0;t<r;t++)i==null?i=n.resourceInfo[t][this.model.resourceNameMapping]:i+=" , "+n.resourceInfo[t][this.model.resourceNameMapping];return i}return n.resourceInfo[0][this.model.resourceNameMapping]}return String.empty},_getrowClassName:function(){var n="gridrowtaskId",t=this;return t.data.parentItem&&(n+=t.data.parentItem.taskId.toString()),n+="level",n+t.data.level.toString()},_getExpandStatusRecord:function(n){var t=this;return t._getExpandStatus(n)?"table-row":"none"},_isMilestone:function(){return this.data.isMilestone?!0:!1},_addRecordExpandCollapse:function(){return this.data.expanded?"e-chartexpand":!this.data.expanded&&this.data.hasChildRecords?"e-chartcollapse":!1},_getTypedata:function(){return this.data.hasChildRecords},_getBorderRadius:function(){var n=this,t=n.data.width-n.data.progressWidth;return t<=4?4-t:0},_createConnectorLineTemplate:function(){var u=this,t=this.model.connectorlineWidth,o,r,i=this.model.connectorLineBackground,h={_getWidthVal:u._getWidth,_getTop:u._getPredecessorTop,_getPosition:u._getParentPosition,_setContainerWidthSSType2:u._getContainerWidthSSType2,_setInnerChildWidthSSType2:u._getInnerChildWidthSSType2,_setInnerElementLeftSSType2:u._getInnerElementLeftSSType2,_setInnerElementWidthSSType2:u._getInnerElementWidthSSType2,_isMilestone:u._isTaskMilestone,_isMilestoneParent:u._isMilestoneParent},f,s,e;u.model.renderBaseline?(o=0,r=this.model.rowHeight/2-o):r=this.model.rowHeight/2;n.views.helpers(h);f="<div  id='ConnectorLine{{:ConnectorLineId}}' style='background-color=black'>";s="{{if ~_getPosition()=='FSType1'}}<div style='left:{{:ParentLeft+ParentWidth}}px;top:{{:ParentTop+"+r+"}}px;width:{{:(ChildLeft - (ParentLeft + ParentWidth + 20))}}px;height:{{:Height}}px;position:absolute'><div class='e-line' style='left:{{if milestoneParent}}-7px{{else}}0px{{/if}};width:{{if milestoneParent}}{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+t+"-2}}px{{else}}{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+t+"-10}}px{{/if}};height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+t+"-10}}px;width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+t+"-10}}px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='connectorline-rightarrow' style='left:{{:(ChildLeft - (ParentLeft + ParentWidth + 10))}}px;border-left: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else  ~_getPosition()=='FSType2'}}<div style='left:{{:ParentLeft}}px;top:{{:ParentTop+"+r+"}}px;width:{{:~_getWidthVal()}}px;height:{{:Height}}px;position:absolute'><div class='e-line' style='left:{{if milestoneParent}}{{:ParentWidth-7}}px{{else}}{{:ParentWidth}}px{{/if}};width:{{if milestoneParent}}17px{{else}}10px{{/if}};height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:ParentWidth+10-"+t+"}}px;width:"+t+"px;height:{{:Height-14-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 20))}}px;width:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 30 )}}px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 20))}}px;width:"+t+"px;height:{{:14-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 20))}}px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='connectorline-rightarrow' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 10))}}px;border-left: 10px solid "+i+";border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;top:{{:-6-"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_getPosition()=='FSType3'}}<div style='left:{{:ChildLeft-20}}px;top:{{:ChildTop+"+r+"}}px;width:{{:ParentWidth+ChildWidth}}px;height:{{:Height}}px;position:absolute'><div class='connectorline-rightarrow' style='left:10px;border-left: 10px solid "+i+";border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;top:{{:-6-"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='width:10px;height:"+t+"px;background-color:"+i+";position:relative;top:-13px;'><\/div><div class='e-line' style='width:"+t+"px;height:{{:Height-14-"+t+"}}px;background-color:"+i+";position:relative;top:-13px;'><\/div><div class='e-line' style='width:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 30)}}px;height:"+t+"px;background-color:"+i+";position:relative;top:-13px;'><\/div><div class='e-line' style='left:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 30)}}px;width:"+t+"px;height:{{:12-"+t+"}}px;background-color:"+i+";position:relative;top:-13px;'><\/div><div class='e-line' style='left:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 20)}}px;width:10px;height:"+t+"px;background-color:"+i+";position:relative;top:-13px;'><\/div><\/div>{{else ~_getPosition()=='FSType4'}}<div style='left:{{:ParentLeft+ParentWidth}}px;top:{{:ChildTop+"+r+"}}px;width:{{:(ChildLeft - (ParentLeft + ParentWidth + 20))}}px;height:{{:Height}}px;position:absolute'><div class='connectorline-rightarrow' style='left:{{:(ChildLeft - (ParentLeft + ParentWidth + 10))}}px;border-left: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='left:{{:(ChildLeft - (ParentLeft + ParentWidth) - 20)}}px;top:-13px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='top:-13px;left:{{:(ChildLeft - (ParentLeft + ParentWidth) - 20)}}px;width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='{{if ~_isMilestoneParent()}}left:-6px;{{/if}}top:-13px;width:{{if ~_isMilestoneParent()}}{{:(ChildLeft-(ParentLeft + ParentWidth+20 )+ 6)+"+t+"}}px;{{else}}{{:(ChildLeft-(ParentLeft + ParentWidth + 20))+"+t+"}}px;{{/if}}height:"+t+"px;background-color:"+i+";position:relative'><\/div><\/div>{{else ~_getPosition()=='SSType4'}}<div  style='left:{{:ParentLeft-10}}px;top:{{:ChildTop+"+r+"}}px;width:{{:ChildLeft-ParentLeft}}px;height:{{:Height}}px;position:absolute'><div class='connectorline-rightarrow' style='left:{{:ChildLeft-ParentLeft}}px;border-left: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='top:-13px;width:{{:ChildLeft-ParentLeft}}px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='top:-13px;width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='top:-13px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><\/div>{{else ~_getPosition()=='SSType3'}}<div  style='left:{{:ChildLeft-20}}px;top:{{:ChildTop+"+r+"}}px;width:{{:ParentLeft-ChildLeft}}px;height:{{:Height}}px;position:absolute'><div class='connectorline-rightarrow' style='left:10px;border-left: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='top:-13px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='top:-13px;width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='top:-13px;width:{{:ParentLeft-ChildLeft+20}}px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><\/div>{{else ~_getPosition()=='SSType2'}}<div  style='left:{{:~_setInnerElementLeftSSType2()}}px;top:{{:ParentTop+"+r+"}}px;width:{{:~_setContainerWidthSSType2()}}px;height:{{:Height}}px;position:absolute'><div class='e-line' style='width:{{:~_setInnerChildWidthSSType2()}}px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='width:{{:~_setInnerElementWidthSSType2()}}px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='connectorline-rightarrow' style='left:{{:~_setInnerElementWidthSSType2()}}px;border-left: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_getPosition()=='SSType1'}}<div  style='left:{{:ChildLeft-20}}px;top:{{:ParentTop+"+r+"}}px;width:{{:ParentLeft-ChildLeft}}px;height:{{:Height}}px;position:absolute'><div class='e-line' style='width:{{:ParentLeft-ChildLeft+20}}px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='connectorline-rightarrow' style='left:10px;border-left: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_getPosition()=='FFType1'}}<div class='FFtype1' style='left:{{:ChildLeft+ChildWidth}}px;top:{{:ParentTop+"+r+"}}px;width:{{:((ChildLeft + ChildWidth)-(ParentLeft + ParentWidth))+30}}px;height:{{:Height}}px;position:absolute'><div class='e-line' style='left:{{if ~_isMilestoneParent()}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))-10}}px;{{else}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))}}px;{{/if}}width:{{if ~_isMilestoneParent()}}30px;{{else}}20px;{{/if}}height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{if ~_isMilestoneParent()}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;{{else}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;{{/if}}width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{if ~_isMilestone()}}4px;{{else}}10px;{{/if}}width:{{if ~_isMilestone()}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+16}}px;{{else}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+10}}px;{{/if}}height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='connectorline-leftarrow' style='{{if ~_isMilestone()}}left:-6px;{{/if}}border-right: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_getPosition()=='FFType2'}}<div style='left:{{:ParentLeft+ParentWidth}}px;top:{{:ParentTop+"+r+"}}px;width:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;height:{{:Height}}px;position:absolute'><div class='e-line' style='{{if ~_isMilestoneParent()}}left:-6px;{{/if}}width:{{if ~_isMilestoneParent()}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+26}}px;{{else}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;{{/if}}height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{if ~_isMilestone()}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+4}}px;{{else}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+10}}px;{{/if}}width:{{if ~_isMilestone()}}16px;{{else}}10px;{{/if}}height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='connectorline-leftarrow' style='left:{{if ~_isMilestone()}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))-6}}px;{{else}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))}}px;{{/if}}border-right: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_getPosition()=='FFType3'}}<div  style='left:{{:ChildLeft+ChildWidth}}px;top:{{:ChildTop+"+r+"}}px;width:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;height:{{:Height}}px;position:absolute'><div class='connectorline-leftarrow' style='top:-12.5px;border-right: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='width:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;top:-12.5px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;top:-12.5px;width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))}}px;top:-12.5px;width:20px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><\/div>{{else ~_getPosition()=='FFType4'}}<div  style='left:{{:ParentLeft+ParentWidth}}px;top:{{:ChildTop+"+r+"}}px;width:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;height:{{:Height}}px;position:absolute'><div  class='connectorline-leftarrow' style='left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))}}px;border-right: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+10}}px;top:-13px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;top:-13px;width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='width:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;top:-13px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><\/div>{{else  ~_getPosition()=='SFType4'}}<div style='left:{{:ParentLeft-10}}px;top:{{:ChildTop+"+r+"}}px;width:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+20}}px;height:{{:Height}}px;position:absolute'><div class='connectorline-leftarrow' style='left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+10}}px;top:-13px;border-right: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+20}}px;top:-13px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;top:-13px;width:"+t+"px;height:{{:Height-15-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='top:-13px;width:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='top:-13px;width:"+t+"px;height:{{:12-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='top:-13px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><\/div>{{else ~_getPosition()=='SFType3'}}<div style='left:{{:ChildLeft+ChildWidth}}px;top:{{:ChildTop+"+r+"}}px;width:{{:((ParentLeft)-(ChildLeft + ChildWidth))}}px;height:{{:Height}}px;position:absolute'><div class='connectorline-leftarrow' style='top:-13px;border-right: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='left:10px;top:-13px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:20px;top:-13px;width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:20px;top:-13px;width:{{:(ChildLeft-(ParentLeft + ParentWidth + 20))+"+t+"}}px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><\/div>{{else  ~_getPosition()=='SFType1'}}<div style='left:{{:ParentLeft-10}}px;top:{{:ParentTop+"+r+"}}px;width:{{:ChildLeft+ChildWidth+20}}px;height:{{:Height}}px;position:absolute'><div class='e-line' style='width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='width:"+t+"px;height:{{:Height-15-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='width:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;width:"+t+"px;height:{{:12-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+20}}px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='connectorline-leftarrow' style='left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+10}}px;border-right: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_getPosition()=='SFType2'}}<div  style='left:{{:ChildLeft+ChildWidth}}px;top:{{:ParentTop+"+r+"}}px;width:{{:((ParentLeft) - (ChildLeft + ChildWidth))}}px;height:{{:Height}}px;position:absolute'><div class='e-line' style='left:{{:((ParentLeft) - (ChildLeft + ChildWidth))-10}}px;width:10px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:{{:((ParentLeft) - (ChildLeft + ChildWidth))-10}}px;width:"+t+"px;height:{{:Height-"+t+"}}px;background-color:"+i+";position:relative'><\/div><div class='e-line' style='left:10px;width:{{:((ParentLeft) - (ChildLeft + ChildWidth))-20}}px;height:"+t+"px;background-color:"+i+";position:relative'><\/div><div class='connectorline-leftarrow' style='border-right: 10px solid "+i+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{/if}}";f+=s;f+="<\/div>";e={};e[this._id+"ConnectorLineTemplate"]=f;n.templates(e)},_isTaskMilestone:function(){return this.data.milestoneChild?!0:!1},_isMilestoneParent:function(){return this.data.milestoneParent?!0:!1},_getInnerChildWidthSSType2:function(){return this.data.ParentLeft+this.data.ParentWidth<this.data.ChildLeft?10:this.data.ParentLeft==this.data.ChildLeft?20:this.data.ChildLeft-this.data.ParentLeft},_getInnerElementLeftSSType2:function(){return this.data.ParentLeft==this.data.ChildLeft?this.data.ParentLeft-20:this.data.ParentLeft-10},_getInnerElementWidthSSType2:function(){return this.data.ParentLeft==this.data.ChildLeft?10:this.data.ChildLeft-this.data.ParentLeft},_getContainerWidthSSType2:function(){return this.data.ParentLeft==this.data.ChildLeft?20:this.data.ChildLeft-this.data.ParentLeft},_getPredecessorTop:function(){return this.data.ParentTop>this.data.ChildTop?!0:!1},_getParentPosition:function(){if(this.data.ParentTop<this.data.ChildTop){if(this.data.Type=="FF")return this.data.ChildLeft>=this.data.ParentLeft||this.data.ChildLeft+this.data.ChildWidth>=this.data.ParentLeft&&this.data.milestoneParent?"FFType2":"FFType1";if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft>this.data.ParentLeft+this.data.ParentWidth+25){if(this.data.Type=="FS")return"FSType1";if(this.data.Type=="SF")return"SFType1";if(this.data.Type=="SS")return"SSType2";if(this.data.Type=="FF")return"FFType2"}else if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft<this.data.ParentLeft+this.data.ParentWidth||this.data.ParentLeft==this.data.ChildLeft||this.data.ParentLeft>this.data.ChildLeft){if(this.data.ParentLeft>this.data.ChildLeft+this.data.ChildWidth+25&&this.data.Type=="SF")return"SFType2";if(this.data.ParentLeft>this.data.ChildLeft){if(this.data.Type=="SS")return"SSType1";if(this.data.Type=="SF")return"SFType1";if(this.data.Type=="FF")return"FFType1"}else if(this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth&&this.data.Type=="FF")return"FFType2";if(this.data.Type=="FS")return"FSType2";if(this.data.Type=="SS")return"SSType2";if(this.data.Type=="FF")return"FFType1";if(this.data.Type=="SF")return"SFType1"}else if(this.data.ParentLeft+25<this.data.ChildLeft){if(this.data.Type=="FS")return"FSType2";if(this.data.Type=="FF")return"FFType2";if(this.data.Type=="SS")return"SSType2"}}else if(this.data.ParentTop>this.data.ChildTop)if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft>this.data.ParentLeft+this.data.ParentWidth){if(this.data.Type=="FS")return"FSType4";if(this.data.ParentLeft<this.data.ChildLeft||this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth){if(this.data.Type=="SS")return"SSType4";if(this.data.Type=="FF")return"FFType4"}else if(this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth&&this.data.Type=="FF")return"FFType4"}else if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft<this.data.ParentLeft+this.data.ParentWidth||this.data.ParentLeft==this.data.ChildLeft||this.data.ParentLeft>this.data.ChildLeft){if(this.data.ChildLeft+this.data.ChildWidth<=this.data.ParentLeft+this.data.ParentWidth){if(this.data.Type=="FF")return"FFType3";if(this.data.Type=="SF")return"SFType3"}else if(this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth){if(this.data.Type=="FF")return"FFType4";if(this.data.Type=="SF")return"SFType4"}if(this.data.Type=="FS")return"FSType3";if(this.data.Type=="SS")return"SSType3"}else if(this.data.ParentLeft<this.data.ChildLeft){if(this.data.Type=="FS")return"FSType3";if(this.data.Type=="SS")return"SSType4"}return!1},_getWidth:function(){return this.data.ChildLeft+this.data.ChildWidth<this.data.ParentLeft+this.data.ParentWidth?this.data.ParentWidth:this.data.ChildWidth+this.data.ParentWidth},_renderWeekends:function(){for(var n=this,i=0,f=n.model.perDayWidth+1,r=n.model.updatedGanttRecords.length*this.model.rowHeight,h=n.model.scheduleWeeks.length,e,o,u=t.buildTag("div.e-secondary_canvas","",{height:r+"px"},{}),s=0;s<h;s++)e=t.buildTag("div.e-weekends","",{left:i+"px",width:f+"px",height:r+"px","background-color":this.model.weekendBackground},{}),o=t.buildTag("div.e-weekends","",{left:i+n.model.perDayWidth*6+"px",width:f+"px",height:r+"px","background-color":this.model.weekendBackground},{}),u.append(e),u.append(o),i=i+this._scheduleWeekWidth;n._$weekendsContainer.append(u);n._$bodyContent.append(n._$weekendsContainer)},_renderStripLines:function(n){for(var u,h,r=this,f=r.model.updatedGanttRecords.length*this.model.rowHeight,c=n.length,e,o,l=r.model.projectStartDate,a=this.model.perDayWidth,s=t.buildTag("div.e-stripLines","",{height:f+"px"},{}),i=0;i<c;i++)e=this._getDateType(n[i].day),o=(e-this._getDateType(l))/864e5*a,n[i].lineWidth=n[i].lineWidth>30?30:n[i].lineWidth,u=t.buildTag("div.e-stripline#stripline"+[i]+"","",{left:o+"px",width:"1px",height:f+"px","border-left-width":n[i].lineWidth+"px","border-left-color":n[i].lineColor,"border-left-style":n[i].lineStyle},{}),h=t.buildTag("span.e-striplinespan",n[i].label,{"background-color":n[i].lineColor},{}),n[i].day&&n[i].day.length>0&&(n[i].label&&n[i].label.length>0&&u.append(h),s.append(u));r._$secondaryCanvas.append(s);r._$bodyContent.append(r._$secondaryCanvas)},_getProgressWidth:function(n,t){return n*t/100},_getProgressPercent:function(n,t){return Math.ceil((t/n*100).toFixed(2))},_renderHoliday:function(n){var i=this,l=i.model.scheduleHeaderSettings.scheduleHeaderType,h=this._getDateType(n.day),a=i.model.scheduleWeeks.length,v=i.model.scheduleMonths.length,y=i.model.scheduleYears.length,p=i.model.scheduleDays.length,e=0,r,o,u,f,c=i.model.updatedGanttRecords.length,s;e=(h-this._getDateType(i.model.projectStartDate))/864e5*this.model.perDayWidth;s=c*this.model.rowHeight;r=n.label!=null?n.label.length:0;n.background==null&&(n.background="white");o=i.model.scheduleHeaderSettings.scheduleHeaderType!="day"?t.buildTag("div.e-holiday-label",n.label,{top:i._getHolidayLabelHeight(r)+"px"},{}):t.buildTag("div.e-holiday-label",n.label,{bottom:i._getHolidayLabelHeight(r)+"px"},{});u=t.buildTag("div.e-secondary-canvas-holiday");f=t.buildTag("div.e-holidays","",{left:e+"px",width:i.model.perDayWidth+"px",height:s+"px","background-color":n.background},{});n.label!=null&&f.append(o);u.append(f);i._$secondaryCanvas.append(u);i._$bodyContent.append(i._$secondaryCanvas)},_getHolidayLabelHeight:function(){var n=this,r=n.model,t=n._getHeight(),i=r.updatedGanttRecords.length*n.model.rowHeight;return t>0?t/2:n._viewportHeight<i?n._viewportHeight/2:i/2},_destroy:function(){var n=this;n.element.empty().removeClass("e-ganttchart-core e-ganttchart"+n.model.cssClass)}});t.GanttChart.contextMenuItem={taskDetails:"Task Details....",add:"Add new task",indent:"Indent",outdent:"Outdent",Delete:"Delete"};jQuery.uaMatch=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}}}(jQuery,Syncfusion),function(n,t){t.Grid=t.Grid||{};t.Grid.gridResize=function(t){this.$headerTable=t.getHeaderTable();this.gridInstance=t;this._colMinWidth=15;this._$visualElement=n();this._currentCell=-1;this._allowStart=!1;this._oldWidth=null;this._orgX=null;this._orgY=null;this._extra=null;this._expand=!1;this._target=null};t.Grid.gridResize.prototype={_mouseHover:function(t){var r,o;if(!this._$visualElement.is(":visible")&&(n(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),r=n(t.target),r.hasClass("e-headercell"))){var u=t.target,f=u.getBoundingClientRect(),i=0,e=0;(t.type="mousemove")?(i=t.clientX,e=t.clientY):(t.type="touchmove")?(i=evt.originalEvent.changedTouches[0].clientX,e=evt.originalEvent.changedTouches[0].clientY):(t.type="MSPointerMove")&&(i=t.originalEvent.clientX,e=t.originalEvent.clientY);o=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderContent().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left:this.gridInstance.getHeaderTable().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left;(i>=f.left+document.documentElement.scrollLeft+u.offsetWidth-5||i<=f.left+3)&&i<o&&i>=f.left&&e<=f.top+document.documentElement.scrollTop+t.target.offsetHeight?(this.gridInstance.model.showStackedHeader&&n(r.parents("thead")).find("tr").css("cursor","col-resize"),this.gridInstance.model.showStackedHeader||r.parent().css("cursor","col-resize"),this._currentCell=n(t.target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell:visible").index(u):this.gridInstance.getHeaderContent().find(".e-headercell:visible").not(".e-stackedHeaderCell").index(u),this._allowStart=!0):(r.parent().css("cursor","pointer"),this._allowStart=!1,this._currentCell=-1)}},_start:function(t,i){var e=this.gridInstance.getHeaderTable().find(".e-columnheader"),f,r,o,u;if(f=n(this._target).hasClass("e-stackedHeaderCell")?e.find(".e-headercell"):e.find(".e-headercell").not(".e-stackedHeaderCell"),this._currentCell!=-1&&this._currentCell<f.length&&(r=f[this._currentCell]),typeof r!="undefined")if(o=r.getBoundingClientRect(),this._tableY=o.top+parseInt(navigator.userAgent.indexOf("WebKit")!=-1?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart){if(this._$visualElement=n(document.createElement("div")),_height=this.gridInstance.element.find(".e-gridcontent").first().height()+this.gridInstance.element.find(".e-gridheader").height(),this.gridInstance.model.showStackedHeader&&this.gridInstance.model.stackedHeaderRows.length>0){var s=this.gridInstance.getHeaderTable().find("tr.e-columnheader"),c=s.length,h=n(this._target).parent("tr")[0].rowIndex;for(u=0;u<h;u++)_height=_height-n(s[u]).height()}this._$visualElement.addClass("e-reSizeColbg").appendTo(this.gridInstance.element).css({height:_height+"px",cursor:"col-resize"});this._$visualElement.css({left:t,top:this._tableY});this._oldWidth=r.offsetWidth;this._orgX=t;this._orgY=i;this._extra=t-this._orgX;this._expand=!0}else this._currentCell=-1},_mouseMove:function(n){if(this._expand){var t=0,i=0;(n.type="mousemove")?(t=n.clientX,i=n.clientY):(n.type="touchmove")?(t=evt.originalEvent.changedTouches[0].clientX,i=evt.originalEvent.changedTouches[0].clientY):(n.type="MSPointerMove")&&(t=n.originalEvent.clientX,i=n.originalEvent.clientY);navigator.userAgent.indexOf("WebKit")!=-1&&(t=n.pageX,i=n.pageY);t+=document.documentElement.scrollLeft;n.preventDefault();this._moveVisual(t)}else this._mouseHover(n)},_getCellIndex:function(t){var f=n(t._target),u=t._target,i=u.cellIndex,r=i;return t.gridInstance.model.groupSettings.groupedColumns.length&&(r=i-t.gridInstance.model.groupSettings.groupedColumns.length),r},_reSize:function(t){var p=this,r,o,e,h,i,s;if(this._initialTableWidth=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderTable().first().parent().width()+this.gridInstance.getHeaderTable().last().parent().width():this.gridInstance.getHeaderTable().parent().width(),this.gridInstance.model.enableRTL||this._getResizableCell(),o=n(this._target).closest("tr"),this._currentCell!=-1&&this._expand){this._expand=!1;var l=o.find(".e-headercell").filter(":visible"),a=l[this._currentCell],u=a.offsetWidth,f=t-this._orgX;if(parseInt(f)+parseInt(u)>this._colMinWidth&&(f!=0&&o.css("cursor","default"),this._resizeColumnUsingDiff(u,f),r=this.gridInstance.element.find(".e-gridcontent").first(),this.gridInstance.model.allowScrolling&&r.ejScroller("refresh"),e=this.gridInstance.getBrowserDetails(),e.browser=="msie"&&this.gridInstance.model.allowScrolling&&(h=this.gridInstance.getContentTable().width(),i=this.gridInstance._calculateWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns>0?(this.gridInstance.getHeaderTable().last().width(i-this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width()),this.gridInstance.getContentTable().last().width(i-this.gridInstance.getContent().find(".e-frozencontentdiv").width()),this.gridInstance.model.showSummary&&this.gridInstance.getFooterTable().last().width(i-this.gridInstance.getFooterContent().find(".e-frozenfootertdiv").width())):(this.gridInstance.getHeaderTable().width(i),this.gridInstance.model.showSummary&&this.gridInstance.getFooterTable().width(i)),parseInt(e.version,10)>8&&this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length&&(i>h?(this.gridInstance.getContentTable().width(i),this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",2e3/r.find("table").first().width()+"%")):(this.gridInstance.getContentTable().css("width","100%"),this.gridInstance._groupingAction(),this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",(this.gridInstance.getHeaderTable().find("colgroup").find("col").first().width()/r.find("table").first().width()*100).toFixed(2)+"%"))),this.gridInstance.getHeaderTable().parent().scrollLeft(r.find(".e-content").scrollLeft()-1)),this.gridInstance._colgroupRefresh(),this.gridInstance.model.groupSettings.groupedColumns.length&&this.gridInstance.model.groupSettings.showGroupedColumn&&this.gridInstance._recalculateIndentWidth(),e.browser=="msie"||!this.gridInstance.model.allowScrolling||this.gridInstance.model.scrollSettings.frozenColumns!=0||(s=this.gridInstance._calculateWidth(),this.gridInstance.getHeaderTable().width(s),this.gridInstance.getContentTable().width(s)),this.gridInstance.model.allowResizing&&this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor")=="default")){var c=this._getCellIndex(this),v=u+f,y={columnIndex:c,column:this.gridInstance.model.columns[c],oldWidth:u,newWidth:v};this.gridInstance._trigger("resized",y)}}this._target=null;this._$visualElement.remove();this._expand=!1;this._currentCell=-1;this._allowStart=!1},_getFrozenResizeWidth:function(){for(var t=this.gridInstance.getHeaderTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumn:0),i=0,n=0;n<t.length;n++)t.eq(n).css("display")!="none"&&(i+=parseInt(t[n].style.width.replace("px","")));return i},_diaplayFinder:function(){return n(this).css("display")!="none"},_resizeColumnUsingDiff:function(t,i){var ft=this,h=this._currntCe=this._currentCell,o,b,f,i,tt,ut,l,a,e,s,r,v,u,y;if(n(this._target).parent("tr").hasClass("e-stackedHeaderRow")){for(var p=0,w=n(this._target),et=n(w).attr("colspan"),it=n(w).parent("tr");h>0;)h--,b=n(it).children("th")[h],p+=parseInt(n(b).attr("colspan"));this._currentCell=p}var k=this.gridInstance.getHeaderTable().find("colgroup").find("col"),d=k.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell),c,g,ot=k.slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumns:0),nt=d[0].style.width,rt=t/parseInt(nt);if(o=i=i/rt,f=parseInt(i)+parseInt(nt),f>0&&i!=0){if(f<this._colMinWidth&&(f=this._colMinWidth),i=f-t,this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){if(this._currentCell>=0&&this._currentCell<this.gridInstance.model.scrollSettings.frozenColumns&&this._getFrozenResizeWidth()+i>this.gridInstance.element.find(".e-headercontent").first().width())return;c=this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder).eq(this._currentCell)}else c=this.gridInstance.getContentTable().find("colgroup").first().find("col").filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell);if(this.gridInstance.model.showSummary&&(g=this.gridInstance.getFooterTable().find("colgroup").find("col").filter(this._diaplayFinder).eq(this._currentCell),g.outerWidth(f)),n(this._target).parent("tr").hasClass("e-stackedHeaderRow")?this._resizeStackedHeaderColumn(n(this._target).parent("tr"),o,this._currntCe):d.outerWidth(f),this.gridInstance.model.isEdit&&(tt=this.gridInstance.getContentTable().find(".e-editedrow,.e-addedrow").find("table").find("colgroup"),n(tt[0].children[this._currentCell-this.gridInstance.model.groupSettings?this.gridInstance.model.groupSettings.groupedColumns.length:0]).width(f)),n(this._target).parent("tr").hasClass("e-stackedHeaderRow"))if(this.gridInstance.model.groupSettings.groupedColumns.length<1)for(ut=this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder).length,r=0;r<this._changedcell.length;r++)l=this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder)[this._changedcell[r]],u=parseInt(o)+parseInt(l.style.width),n(l).width(u);else for(a=this.gridInstance.getContentTable().find(".e-recordtable"),e=a.find("colgroup"),r=0;r<this._changedcell.length;r++)for(s=this._changedcell[r],r=0;r<e.length;r++)u=parseInt(o)+parseInt(n(e[r].children[s]).width()),n(e[r].children[s]).width(u);else if(this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length){var a=this.gridInstance.getContentTable().find(".e-recordtable"),e=a.find("colgroup"),s=this._currentCell+this.gridInstance._hiddenColumns.length;for(r=0;r<e.length;r++)n(e[r].children[s]).width(f)}else c.width(f);if(this.gridInstance._findColumnsWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){for(v=this.gridInstance.getContentTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings.frozenColumns),u=0,r=0;r<v.length;r++)u+=parseInt(v[r].style.width.replace("px",""));this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(u);y=this.gridInstance.model.enableRTL?"margin-right":"margin-left";this.gridInstance.getContent().find(".e-frozencontentdiv").width(u).next().css(y,u+"px");this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(u).next().css(y,u+"px");this.gridInstance.model.showSummary&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(u)}this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor","default")}},_resizeStackedHeaderColumn:function(t,i,r){var l,a,u,h,v,f,e;this._changedcell=[];this.gridInstance.model.groupSettings.showGroupedColumn&&this.gridInstance.model.groupSettings.groupedColumns.length>0&&(this._currentCell++,r++);var o=this._currentCell,c=n(t).find("th")[r],s=n(c).attr("colspan"),y=i/s,p=n(c).parent("tr");if(s>1)for(l=p.next(),a=o+parseInt(s),u=o;u<a;u++)h=n(n(l).find("th"))[u],v=n(h).attr("colspan"),v>1?this._resizeStackedHeaderColumn(n(h).parent("tr"),y,u):(f=this.gridInstance.getHeaderTable().find("col")[u],this._changedcell.push(u),e=parseInt(i)+parseInt(f.style.width),n(f).outerWidth(e));else f=this.gridInstance.getHeaderTable().find("col")[this._currentCell],e=parseInt(i)+parseInt(f.style.width),this._changedcell.push(o),n(f).outerWidth(e)},_triggerResizeEvents:function(t,i){var h=this.gridInstance.getHeaderTable().find(".e-columnheader"),c=h.find(".e-headercell").filter(":visible"),f=c[this._currentCell],e=f.offsetWidth,r=this._getCellIndex(this),o,s,u;t=="resizeStart"?(u={columnIndex:r,column:this.gridInstance.model.columns[r],target:n(f),oldWidth:e},this.gridInstance._trigger("resizeStart",u)):(o=i-this._orgX,s=e+o,this.gridInstance._colgroupRefresh(),u={columnIndex:r,column:this.gridInstance.model.columns[r],target:n(f),oldWidth:e,newWidth:s,extra:o},this.gridInstance._trigger("resizeEnd",u))},_mouseUp:function(n){if(this._expand){var t=n.clientX,i=n.clientY;navigator.userAgent.indexOf("WebKit")!=-1&&(t=n.pageX,i=n.pageY);this.gridInstance.model.allowResizing&&this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor")=="col-resize"&&this._triggerResizeEvents("resizeEnd",t);t+=document.documentElement.scrollLeft;this._reSize(t,i)}},_getResizableCell:function(){for(var i,r=this.gridInstance.getHeaderTable().find(".e-columnheader"),t=r.find(".e-headercell").not(".e-hide"),u=navigator.userAgent.indexOf("WebKit")!=-1?document.body.scrollLeft:document.documentElement.scrollLeft,n=0;n<t.length;n++)if(point=t[n].getBoundingClientRect(),i=point.left+u+5,i>this._orgX){this._currentCell=n-1;return}},_moveVisual:function(n){var t=this.gridInstance.getHeaderContent().find("div").first()[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<n||n<t.left+document.documentElement.scrollLeft?this._$visualElement.remove():this._currentCell!=-1&&this._$visualElement.css({left:n,top:this._tableY})},_mouseDown:function(t){var r,u,i;return this._allowStart&&n(t.target).closest("tr").css("cursor")=="col-resize"&&(this._target=t.target,r=t.clientX,u=t.clientY,navigator.userAgent.indexOf("WebKit")!=-1&&(r=t.pageX,u=t.pageY),this.gridInstance.model.allowResizing&&this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor")=="col-resize"&&(n(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),this._target=t.target,this._triggerResizeEvents("resizeStart",r)),i=this,r+=document.documentElement.scrollLeft,t.button!=2&&(this.gridInstance.model.allowResizing&&this.gridInstance.model.allowResizeToFit?(i.gridInstance._click++,setTimeout(function(){i.gridInstance._click==1?i._start(r,u):i.gridInstance._click==2&&i._columnResizeToFit(t);i.gridInstance._click=0},400)):this._start(r,u)),t.preventDefault()),!1},_columnResizeToFit:function(t){var f,a,o,e,v,s;if(this.gridInstance.model.allowResizeToFit&&this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor")=="col-resize"&&(n(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),f=n(t.target),this._target=f,f.hasClass("e-headercell"))){var h=t.target,u=h.cellIndex,i=u;this._orgX=t.pageX;this._getResizableCell();u!=this._currentCell&&(u=i=this._currentCell,h=t.target.previousSibling);a=n(h).children(".e-headercelldiv");this.gridInstance.model.groupSettings.groupedColumns.length&&(i=u-this.gridInstance.model.groupSettings.groupedColumns.length);var r=0,c=0,l=0;i!=-1&&(l=this._getContentWidth(i),c=this._getHeaderContentWidth(a),r=c>l?c:l,r=r+r*.2,o=this.gridInstance.getHeaderTable().find("col").eq(u).width(),e={columnIndex:i,column:this.gridInstance.model.columns[i],target:f,oldWidth:o},this.gridInstance._trigger("resizeStart",e),this.gridInstance.getHeaderTable().find("col").eq(u).width(r),this.gridInstance.model.groupSettings.groupedColumns.length?(v=this.gridInstance.getContentTable().find(".e-recordtable").find("colgroup"),n.each(v,function(t,u){n(u).find("col").eq(i).width(r)})):this.gridInstance.getContentTable().find("col").eq(i).width(r),s=this.gridInstance.getHeaderTable().find("col").eq(u).width(),this.gridInstance._colgroupRefresh(),e={columnIndex:i,column:this.gridInstance.model.columns[i],target:f,oldWidth:o,newWidth:s,extra:Math.abs(s-o)},this.gridInstance._trigger("resizeEnd",e),this.gridInstance._columnsWidthCollection[i]=r,this.gridInstance.model.columns[i].width=r,e={columnIndex:i,column:this.gridInstance.model.columns[i],target:f,oldWidth:o,newWidth:s},this.gridInstance._trigger("resized",e))}},_getContentWidth:function(i){var r=0,u=t.buildTag("span",{},{}),f=this.gridInstance,e;return n.each(f._gridRows,function(t,o){var s=n(o).find("td.e-rowcell").eq(i),h=n(s).html();f.model.columns[i].isUnbound?u.html(n(h).children()):u.html(h);n(s).html(u);e=s.find("span:first").width();e>r&&(r=e);n(s).html(h)}),f._refreshUnboundTemplate(this.gridInstance.getContentTable()),r},_getHeaderContentWidth:function(n){var i=0,r=t.buildTag("span",{},{}),u=n.html();return r.html(u),n.html(r),i=n.find("span:first").width(),n.html(u),i}}}(jQuery,Syncfusion)})