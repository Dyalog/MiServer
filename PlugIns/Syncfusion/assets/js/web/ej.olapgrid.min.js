/*!
*  filename: ej.olapgrid.min.js
*  version : 12.3
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.touch.min","./ej.button.min","./ej.waitingpopup.min","./ej.olappager.min"],n):n()})(function(){(function(n,t,i){t.widget("ejOlapGrid","ej.olap.OlapGrid",{_rootCSS:"e-olapgrid",element:null,model:null,validTags:["div","span"],defaults:{url:"",cssClass:"",currentReport:"",layout:"Normal",enableVirtualScrolling:!1,enableCellContext:!1,enableRTL:!1,enableToolTip:!0,hyperlinkSettings:{enableValueCellHyperlink:!1,enableRowHeaderHyperlink:!1,enableColumnHeaderHyperlink:!1,enableSummaryCellHyperlink:!1},progressMode:"infinite",serviceMethodSettings:{initialize:"InitializeGrid",drillDown:"DrillGrid",exportOptions:"ExportOptions",paging:"Paging"},customObject:{},locale:"en-US",valueCellHyperlinkClick:"",rowHeaderHyperlinkClick:"",columnHeaderHyperlinkClick:"",summaryCellHyperlinkClick:"",beforeServiceInvoke:null,afterServiceInvoke:null,drillSuccess:null,cellContext:"",load:null,renderComplete:null,renderFailure:null,renderSuccess:null},dataTypes:{serviceMethodSettings:"data",customObject:"data"},observables:["layout","enableCellContext","hyperlinkSettings.enableValueCellHyperlink","hyperlinkSettings.enableRowHeaderHyperlink","hyperlinkSettings.enableColumnHeaderHyperlink","hyperlinkSettings.enableSummaryCellHyperlink"],layout:t.util.valueFunction("layout"),enableCellContext:t.util.valueFunction("enableCellContext"),enableValueCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableValueCellHyperlink"),enableRowHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableRowHeaderHyperlink"),enableColumnHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableColumnHeaderHyperlink"),enableSummaryCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableSummaryCellHyperlink"),locale:t.util.valueFunction("locale"),getOlapReport:function(){return this._olapReport},setOlapReport:function(n){this._olapReport=n},getJSONRecords:function(){return this._JSONRecords},setJSONRecords:function(t){this._JSONRecords=n.parseJSON(t)},_init:function(){this._initPrivateProperties();this._load()},_destroy:function(){this.element.empty().removeClass("e-olapgrid"+this.model.cssClass);this.ogridWaitingPopup!=i&&this.ogridWaitingPopup._destroy()},_initPrivateProperties:function(){this._id=this.element.attr("id");this._olapReport="";this._JSONRecords=null;this._drillCaption="";this._drillAction="";this._startDrilldown=!1;this._pagerObj=null;this._seriesPageCount=null;this._categPageCount=null;this._seriesCurrentPage=1;this._categCurrentPage=1;ogridWaitingPopup=null;_proxy=this;ogridProgressBar=null;ogridprogressText=null;oGridTimer=null;this._maxViewLoading=null},_load:function(){var r={action:t.olap.OlapGrid.GridAction.Initialize,element:this.element,customObject:this.model.customObject},i;this._trigger("load",r);this.element.addClass(this.model.cssClass);typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?n("#"+oclientProxy._id+"_maxView")[0]?(n("#"+oclientProxy._id+"_maxView").ejWaitingPopup({showOnInit:!0}),this._maxViewLoading=("#"+oclientProxy._id+"_maxView").data("ejWaitingPopup")):oclientWaitingPopup.show():_proxy.model.progressMode=="infinite"&&typeof oclientWaitingPopup=="undefined"?(n("#"+this._id).ejWaitingPopup({showOnInit:!0}),ogridWaitingPopup=n("#"+this._id).data("ejWaitingPopup")):(n("#"+_proxy._id+"progressContainer").remove(),this._createProgressBar(),this._progressStatus(0,70,140));this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:t.olap.OlapGrid.GridAction.Initialize,element:this.element,customObject:this.model.customObject});this.model.currentReport!=""&&(this.model.customObject={currentReport:this.model.currentReport});i=JSON.stringify(this.model.customObject);_proxy.model.progressMode=="progress"&&(n("#"+_proxy._id+"progressText")[0].innerHTML=_proxy._getLocalizedLabels("PreparingAndExecutingMDXquery")+"...");this.element[0]!=null&&this.element.parents().find(".controlPanel").length>0&&this.layout()!=""&&this.layout()!=t.olap.OlapGrid.Layout.Normal?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",olapReport:this.model.olapReport,layout:this.layout(),customObject:i}),this._renderControlSuccess):this.element[0]!=null&&this.element.parents().find(".controlPanel").length>0?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",olapReport:this.model.olapReport,customObject:i}),this._renderControlSuccess):this.layout()!=""&&this.layout()!=t.olap.OlapGrid.Layout.Normal?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",layout:this.layout(),customObject:i}),this._renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",customObject:i}),this._renderControlSuccess)},_setFirst:!0,_setModel:function(n){for(var t in n)switch(t){case"OlapReport":this.setOlapReport(n[t]);break;case"JsonData":this.setOlapReport(n[t]);break;case"RefreshOlapGrid":this.element.renderControlFromJSON(n[t]);break;case"layout":this._load();break;case"customObject":this.model.customObject=n[t];break;case"enableCellContext":this._load();break;case"enableValueCellHyperlink":this._load();break;case"enableRowHeaderHyperlink":this._load();break;case"enableColumnHeaderHyperlink":this._load();break;case"enableSummaryCellHyperlink":this._load();break;case"locale":this._load()}},_wireEvents:function(){this.enableCellContext()==!0&&(document.addEventListener?(document.removeEventListener("contextmenu",_proxy._cellContext,!1),document.addEventListener("contextmenu",_proxy._cellContext,!1)):(document.detachEvent("oncontextmenu",_proxy._cellContext),document.attachEvent("oncontextmenu",_proxy._cellContext)));this.drillDownHandler=n.proxy(this._drillDown,this);this.addHyperlinkHandler=n.proxy(this._addHyperlink,this);this.removeHyperlinkHandler=n.proxy(this._removeHyperlink,this);this._on(this.element,"mouseover",".value, .rowheader, .colheader",this.addHyperlinkHandler);this._on(this.element,"mouseleave",".value, .rowheader, .colheader",this.removeHyperlinkHandler);this._on(this.element,"click",".value, .colheader, .rowheader",function(t){if(t.target.className.indexOf("hyperlink")!=-1){var i=n(t.target).attr("p"),r=this.getJSONRecords()[parseInt(parseInt(i.split(",")[0])*this.rowCount+parseInt(i.split(",")[1]))].Info,u={cellValue:t.target.innerHTML,cellPosition:i,cellType:t.target.className.split(" ")[0],uniqueName:r.split("::")[0],args:t,rawdata:r};this.enableSummaryCellHyperlink()&&t.target.className.indexOf("summary value")>=0?this._trigger("summaryCellHyperlinkClick",{element:this.element,customObject:this.model.customObject}):this.enableValueCellHyperlink()&&t.target.className.indexOf("value")>=0?this._trigger("valueCellHyperlinkClick",{args:i}):this.enableRowHeaderHyperlink()&&t.target.className.indexOf("rowheader")>=0?this._trigger("rowHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject}):this.enableColumnHeaderHyperlink()&&t.target.className.indexOf("colheader")>=0&&this._trigger("columnHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject})}});this._on(this.element,"click",".expand, .collapse",t.proxy(this._drillDown,this));this._on(this.element,"mouseover",".colheader, .rowheader, .expand, .collapse",function(t){if(t.target.className.indexOf("expand")>-1&&!n(t.target).hasClass("header-hover-expand"))n(t.target).addClass("header-hover-expand");else if(t.target.className.indexOf("collapse")>-1&&!n(t.target).hasClass("header-hover-collapse"))n(t.target).addClass("header-hover-collapse");else if((t.target.className.indexOf("expand")<0||t.target.className.indexOf("collapse")<0)&&n(t.target).children("span").length>0){var i=n(t.target).children("span")[0];!n(i).hasClass("header-hover-expand")&&i.className.indexOf("expand")>-1?n(i).addClass("header-hover-expand"):!n(i).hasClass("header-hover-collapse")&&i.className.indexOf("collapse")>-1&&n(i).addClass("header-hover-collapse")}});this._on(this.element,"mouseleave",".colheader, .rowheader, .expand, .collapse",function(){this.element.find(".expand, .collapse").removeClass("header-hover-expand header-hover-collapse")});this.model.enableToolTip&&(this._on(this.element,"mouseover",".value",this._applyToolTip),this._on(this.element,"mouseleave",".value",function(){this.element.find("#gridTooltip").hide("slow")}))},_unWireEvents:function(){this._off(this.element,"click",".expand, .collapse");this._off(this.element,"click",".value, .colheader, .rowheader");this._off(this.element,"mouseover",".colheader, .rowheader, .expand, .collapse");this._off(this.element,"mouseleave",".colheader, .rowheader, .expand, .collapse");this._off(this.element,"mouseover",".value, .rowheader, .colheader",this.addHyperlinkHandler);this._off(this.element,"mouseleave",".value, .rowheader, .colheader",this.removeHyperlinkHandler);this._off(this.element,"mouseover",".value");this._off(this.element,"mouseleave",".value")},_applyToolTip:function(t){var u,o,r,s="",a,f,c,h,e,l;if(valueCell="",r=n(t.target).hasClass("summary")?n(t.target).siblings("th").hasClass("rowheader")?n(t.target).parents("tr").find(".rowheader").last().attr("p"):n(t.target).parents("tr").find(".summary").attr("p"):n(t.target).parents("tr").find(".rowheader").last().attr("p"),r!=null)if(r[0]==0&&parseInt(r.split(",")[0])!=null)r==_proxy.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*_proxy.rowCount+parseInt(r.split(",")[1]))].Index&&(o=_proxy.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*_proxy.rowCount+parseInt(r.split(",")[1]))].Value);else while(r[0]>=0)r==_proxy.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*_proxy.rowCount+parseInt(r.split(",")[1]))].Index&&(u=_proxy.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*_proxy.rowCount+parseInt(r.split(",")[1]))].Value,r=parseInt(r.split(",")[0])-1+","+parseInt(r.split(",")[1])),o=o?u+"-"+o:u;for(a=n(t.target).closest("tbody").prev().children("tr:last").children("th").attr("p")[2],f=n(t.target).attr("p"),f!=i&&f==_proxy.getJSONRecords()[parseInt(parseInt(f.split(",")[0])*_proxy.rowCount+parseInt(f.split(",")[1]))].Index&&(c=parseInt(f.split(",")[0])),h=0;h<=a;h++)e=c+","+h,c!=null&&e==_proxy.getJSONRecords()[parseInt(parseInt(e.split(",")[0])*_proxy.rowCount+parseInt(e.split(",")[1]))].Index&&(u=_proxy.getJSONRecords()[parseInt(parseInt(e.split(",")[0])*_proxy.rowCount+parseInt(e.split(",")[1]))].Value,s==""?s=u:u!=""&&(s=s+"-"+u));this.element.find("#gridTooltip").remove();l=n(t.target).offset();n(t.target).append('<div id="gridTooltip" class="tooltip"><\/div>');this.element.find("#gridTooltip").css("left",l.left+30+"px","top",l.left+30+"px");this.element.find("#gridTooltip").append('<p id="value" class="tooltipText">Value : '+n(t.target).text()+"<\/p>");this.element.find("#gridTooltip").append('<p id="row" class="tooltipText">Row : '+o+"<\/p>");this.element.find("#gridTooltip").append('<p id="column" class="tooltipText">Column : '+s+"<\/p>");this.element.find("#gridTooltip").show("fast")},_applyVScrolling:function(){var i=this,l=n(this.element).find(".virtualScrollGrid"),f,h,r,o,e,c,u,s;this._seriesPageCount>1&&(f=function(){return i.element.find(".vScrollPanel").position().top+1},h=n(this.element).find(".vScrollPanel"),h.height(n(l).height()),h.html(t.buildTag("div.vScrollThumb")[0].outerHTML),r=h.find(".vScrollThumb"),r.height(Math.max(Math.ceil(n(l).height()/i._seriesPageCount),15)),o=h.height()-r.height()-2,r.offset({top:f()+(i._seriesCurrentPage-1)*(o/(i._seriesPageCount-1))}),n(r).bind("mousedown",function(t){var s,u,e;n(this).addClass("dragging");s=t.pageY-f();u=r.position().top-f();i.element.find(".seriesPageIndicator").removeClass("inActive").css({top:r.position().top,left:r.position().left+20});e=i._seriesCurrentPage;n(document).bind("mousemove",function(t){if(window.navigator.userAgent.indexOf("MSIE ")>-1)n(document).on("selectstart",function(n){n.preventDefault()});else window.getSelection().removeAllRanges();var h=t.pageY-f()-s;h>0&&u+h<=o?r.offset({top:u+h+f()}):h<0&&u+h>=0?r.offset({top:u+h+f()}):u+h>o?r.offset({top:f()+o}):u+h<0&&r.offset({top:f()});e=Math.ceil((r.position().top-f())/(o/i._seriesPageCount))==0?1:Math.ceil((r.position().top-f())/(o/i._seriesPageCount));i.element.find(".seriesPageIndicator").css({top:r.position().top});i.element.find(".series_CurrentPage").html(e)});n(document).bind("mouseup",function(){n(document).off("selectstart");n(this).unbind("mousemove").unbind("mouseup");n(r).removeClass("dragging");e!=i._seriesCurrentPage?(i._seriesCurrentPage=e,i.refreshPagedOlapGrid("series",i._seriesCurrentPage)):i.element.find(".seriesPageIndicator").addClass("inActive")})}));this._categPageCount>1&&(e=function(){return i.element.find(".hScrollPanel").position().left+1},c=n(this.element).find(".hScrollPanel"),c.width(n(l).width()),c.html(t.buildTag("div.hScrollThumb")[0].outerHTML),u=c.find(".hScrollThumb"),u.width(Math.max(Math.ceil(n(l).width()/i._categPageCount),15)),s=c.width()-u.width()-2,u.offset({left:e()+(i._categCurrentPage-1)*(s/(i._categPageCount-1))}),n(u).bind("mousedown",function(t){var o,r,f;n(this).addClass("dragging");o=t.pageX-e();r=u.position().left-e();i.element.find(".categPageIndicator").removeClass("inActive").css({left:u.position().left,top:u.position().top+20});f=i._categCurrentPage;n(document).bind("mousemove",function(t){if(window.navigator.userAgent.indexOf("MSIE ")>-1)n(document).on("selectstart",function(n){n.preventDefault()});else window.getSelection().removeAllRanges();var h=t.pageX-e()-o;h>0&&r+h<=s?u.offset({left:r+h+e()}):h<0&&r+h>=0?u.offset({left:r+h+e()}):r+h>s?u.offset({left:e()+s}):r+h<0&&u.offset({left:e()});f=Math.ceil((u.position().left-e())/(s/i._categPageCount))==0?1:Math.ceil((u.position().left-e())/(s/i._categPageCount));i.element.find(".categPageIndicator").css({left:u.position().left});i.element.find(".categ_CurrentPage").html(f)});n(document).bind("mouseup",function(){n(document).off("selectstart");n(this).unbind("mousemove").unbind("mouseup");n(u).removeClass("dragging");f!=i._categCurrentPage?(i._categCurrentPage=f,i.refreshPagedOlapGrid("categ",i._categCurrentPage)):i.element.find(".categPageIndicator").addClass("inActive")})}))},_getLocalizedLabels:function(n){return t.olap.OlapGrid.locale[this.locale()][n]===i?t.olap.OlapGrid.locale["en-US"][n]:t.olap.OlapGrid.locale[this.locale()][n]},_drillDown:function(i){var f,e,r,u;this._off(this.element,"click",".expand, .collapse");f=i.target.className;this._startDrilldown=!0;f=f.split(" ");f[0]=="expand"?this._drillAction="drilldown":f[0]=="collapse"&&(this._drillAction="drillup");this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:t.olap.OlapGrid.GridAction.DrillDown,element:this.element,customObject:this.model.customObject});e=JSON.stringify(this.model.customObject);r=n(i.target).parent().attr("p");this._drillCaption=n.trim(n(i.currentTarget).parent().text());typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?n("#"+oclientProxy._id+"_maxView")[0]?(n("#"+oclientProxy._id+"_maxView").ejWaitingPopup({showOnInit:!0}),this._maxViewLoading=n("#"+oclientProxy._id+"_maxView").data("ejWaitingPopup")):oclientWaitingPopup.show():_proxy.model.progressMode=="infinite"?ogridWaitingPopup.show():(this._progressStatus(0,70,140),_proxy.model.progressMode=="progress"&&(n("#"+_proxy._id+"progressText")[0].innerHTML=_proxy._getLocalizedLabels("PreparingAndExecutingMDXquery")+"..."));try{u=JSON.parse(this.getOlapReport()).Report}catch(o){u=this.getOlapReport()}this.layout()!=""||this.layout()!="normal"?typeof oclientProxy!="undefined"?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:r,currentReport:u,clientReports:oclientProxy.reports,headerInfo:this.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*this.rowCount+parseInt(r.split(",")[1]))].Info,layout:this.layout(),customObject:e}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:r,currentReport:u,headerInfo:this.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*this.rowCount+parseInt(r.split(",")[1]))].Info,layout:this.layout(),customObject:e}),this._drillDownSuccess):typeof oclientProxy!="undefined"?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:r,currentReport:u,clientReports:oclientProxy.reports,headerInfo:this.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*this.rowCount+parseInt(r.split(",")[1]))].Info,customObject:e}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:r,currentReport:u,headerInfo:this.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*this.rowCount+parseInt(r.split(",")[1]))].Info,customObject:e}),this._drillDownSuccess)},_addHyperlink:function(t){n(".hyperlinkValueCell")[0]&&n(n(".hyperlinkValueCell")[0]).removeClass("hyperlinkValueCell");n(".hyperlinkHeaderCell")[0]&&n(n(".hyperlinkHeaderCell")[0]).removeClass("hyperlinkHeaderCell");t.target.className=="value"&&this.enableValueCellHyperlink()?n(t.target).addClass("hyperlinkValueCell"):t.target.className=="summary value"&&this.enableSummaryCellHyperlink()?n(t.target).addClass("hyperlinkValueCell"):t.target.className=="rowheader"&&this.enableRowHeaderHyperlink()?n(t.target).addClass("hyperlinkHeaderCell"):t.target.className=="colheader"&&this.enableColumnHeaderHyperlink()&&n(t.target).addClass("hyperlinkHeaderCell")},_removeHyperlink:function(t){n(t.target).removeClass("hyperlinkValueCell").removeClass("hyperlinkHeaderCell")},_cellContext:function(t){var i=t.target||t.srcElement,r;if(_proxy.enableCellContext()==!0&&n(i).parents("#"+_proxy._id)[0]&&(r=n(i).attr("p"),r)){var r=n(i).attr("p"),f=_proxy.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*_proxy.rowCount+parseInt(r.split(",")[1]))].Info,u={cellValue:i.innerHTML,cellPosition:r,cellType:i.className.split(" ")[0],uniqueName:f.split("::")[0],args:t,rawdata:f};u.cellType!=""&&u.cellValue!=""&&_proxy._trigger("cellContext",{args:u});t.target?t.preventDefault():window.event.returnValue=!1}},exportToExcel:function(){var t,i;try{t=JSON.parse(this.getOlapReport()).Report}catch(r){t=this.getOlapReport()}i={currentReport:t,layout:_proxy.layout(),summaryCellColor:n(".summary").css("background-color")};this.doPostBack(_proxy.model.url+"/"+_proxy.model.serviceMethodSettings.exportOptions,i)},_createProgressBar:function(){var f=t.buildTag("div#"+this._id+"progressContainer.progressContainer","",{top:typeof oclientProxy!="undefined"?oclientProxy.model.displaySettings.controlPlacement=="tab"||oclientProxy.model.displaySettings.mode!="chartAndGrid"?oclientProxy.progressPos.top+300:oclientProxy.model.displaySettings.defaultView=="chart"?oclientProxy.progressPos.top+500:oclientProxy.progressPos.top+200:n("#"+this._id).position().top+n("#"+this._id).height()/2-30,left:typeof oclientProxy!="undefined"?oclientProxy.progressPos.left+550:n("#"+this._id).position().left+n("#"+this._id).width()/3-100})[0].outerHTML,i=t.buildTag("div#"+this._id+"progressBar.progressBar","")[0].outerHTML,r=t.buildTag("div#"+this._id+"blockDiv.blockDiv","",{width:typeof oclientProxy!="undefined"?n("#"+oclientProxy._id).width():n("#"+this._id).width(),display:"block",opacity:"0.3",backgroundColor:"#E9E9E9",height:typeof oclientProxy!="undefined"?n("#"+oclientProxy._id).height():n("#"+this._id).height(),position:"fixed",top:typeof oclientProxy!="undefined"?oclientProxy.progressPos.top:n("#"+this._id).position().top,left:typeof oclientProxy!="undefined"?oclientProxy.progressPos.left:n("#"+this._id).position().left})[0].outerHTML,u;n("#"+_proxy._id).after(f);_proxy.model.progressMode=="normal"?(n("#"+this._id+"progressContainer").css({width:0,height:0}),n("#"+_proxy._id+"progressContainer").append(i).append(r)):(u=t.buildTag("span#"+this._id+"progressText.progressText","OlapGrid initial loading...")[0].outerHTML,n("#"+_proxy._id+"progressContainer").append(i).append(u).append(r));n("#"+_proxy._id+"progressBar").ejProgressBar({value:0,text:"0 %",complete:"progressbarCompleted"});ogridProgressBar=n("#"+_proxy._id+"progressBar").data("ejProgressBar");ogridProgressText=n("#"+_proxy._id+"progressText")},_progressStatus:function(t,r,u){if(jQuery.type(r)==="string"){var f=r.split(":");f!=i&&(r=parseInt(f[0]))}ogridProgressBar.setModel({value:t,text:t+" %"});n("#"+_proxy._id+"progressContainer").show();n("#"+_proxy._id+"blockDiv").position=n("#"+_proxy._id).position();oGridTimer=window.setInterval(function(){ogridProgressBar.setModel({value:t,text:t+" %"});t++;t>=r&&(window.clearInterval(oGridTimer),f!=i&&ogridProgressBar.setModel({value:100,text:f[1]}))},u)},_renderControlSuccess:function(r){_proxy=this;_proxy.model.progressMode!="infinite"&&(_proxy.model.progressMode=="progress"&&(n("#"+_proxy._id+"progressText")[0].innerHTML=_proxy._getLocalizedLabels("MDXqueryExecutedSuccessfully")+"..."),window.clearInterval(oGridTimer));try{_proxy.model.progressMode!="infinite"?(_proxy.model.progressMode=="progress"&&(n("#"+_proxy._id+"progressText")[0].innerHTML=_proxy._getLocalizedLabels("RenderingStarted")+"..."),_proxy._progressStatus(70,85,50),window.setTimeout(function(){u()},300)):window.setTimeout(function(){u()},1);function u(){r[0]!=i&&r.length>0?(_proxy.setJSONRecords(r[0].Value),_proxy.setOlapReport(r[1].Value),r[2]!=null&&r[2]!=i&&r[2].Key=="PageSettings"&&(_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(r[3].Value).Column/JSON.parse(r[2].Value).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(r[3].Value).Row/JSON.parse(r[2].Value).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(r[2].Value).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(r[2].Value).SeriesPageSize):n(".e-olappager")[0]!=null&&n(".e-olappager")[0]!=i&&_proxy._pagerObj.initPagerProperties(JSON.parse(r[3].Value),JSON.parse(r[2].Value)),r[4]!=null&&r[4]!=i&&(_proxy.model.customObject=r[4].Value)),r[2]!=null&&r[2]!=i&&r[2].Key!="PageSettings"&&(_proxy.model.customObject=r[2].Value)):r.d!=i&&r.d.length>0?(_proxy.setJSONRecords(r.d[0].Value),_proxy.setOlapReport(r.d[1].Value),r.d[2]!=null&&r.d[2]!=i&&r.d[2].Key=="PageSettings"&&(_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(r.d[3].Value).Column/JSON.parse(r.d[2].Value).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(r.d[3].Value).Row/JSON.parse(r.d[2].Value).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(r.d[2].Value).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(r.d[2].Value).SeriesCurrentPage):n(".e-olappager")[0]!=null&&n(".e-olappager")[0]!=i&&_proxy._pagerObj.initPagerProperties(JSON.parse(r.d[3].Value),JSON.parse(r.d[2].Value)),r.d[4]!=null&&r.d[4]!=i&&(_proxy.model.customObject=r.d[4].Value)),r.d[2]!=null&&r.d[2]!=i&&r.d[2].Value=="PageSettings"&&(_proxy.model.customObject=r.d[2].Value)):!t.isNullOrUndefined(r)&&t.isNullOrUndefined(r.d)&&(r.PivotRecords!=i&&(_proxy.setJSONRecords(r.PivotRecords),_proxy.setOlapReport(r.OlapReport),r.HeaderCounts!=i&&_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(r.HeaderCounts).Column/JSON.parse(r.PageSettings).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(r.HeaderCounts).Row/JSON.parse(r.PageSettings).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(r.PageSettings).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(r.PageSettings).SeriesCurrentPage):r.HeaderCounts!=i&&n(".e-olappager")[0]!=null&&n(".e-olappager")[0]!=i&&_proxy._pagerObj.initPagerProperties(JSON.parse(r.HeaderCounts),JSON.parse(r.PageSettings))),r.customObject!=null&&r.customObject!=i&&(_proxy.model.customObject=r.customObject));_proxy.model.afterServiceInvoke!=null&&_proxy._trigger("afterServiceInvoke",{action:t.olap.OlapGrid.GridAction.DrillDown,element:_proxy.element,customObject:_proxy.model.customObject});_proxy.getJSONRecords()!=null&&_proxy.getJSONRecords().length>0&&_proxy.renderControlFromJSON(_proxy.getJSONRecords());_proxy.model.enableVirtualScrolling&&_proxy._applyVScrolling();_proxy.model.progressMode!="infinite"?_proxy._JSONRecords==null?n("#"+_proxy._id+"progressContainer").hide():_proxy.model.progressMode=="progress"&&(n("#"+_proxy._id+"progressText")[0].innerHTML=_proxy._getLocalizedLabels("RenderingSucceeded")+"..."):typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?n("#"+oclientProxy._id+"_maxView")[0]&&this._maxViewLoading?this._maxViewLoading.hide():oclientWaitingPopup.hide():ogridWaitingPopup.hide()}}catch(e){_proxy.model.progressMode!="infinite"&&(_proxy.model.progressMode=="progress"&&(n("#"+_proxy._id+"progressText")[0].innerHTML=_proxy._getLocalizedLabels("RenderingFailed")+"!!!"),window.clearInterval(oChartTimer),ogridProgressBar.setModel({value:70,text:" Failed"}))}var f={action:"initialize",customObject:this.model.customObject,element:this.element};this._trigger("renderSuccess",f)},_drillDownSuccess:function(r){_proxy=this;_proxy.model.progressMode=="progress"&&(n("#"+_proxy._id+"progressText")[0].innerHTML=_proxy._getLocalizedLabels("MDXqueryExecutedSuccessfully")+"...");r[0]!=i?(this.setJSONRecords(r[0].Value),this.setOlapReport(r[1].Value),typeof oclientProxy!="undefined"&&(oclientProxy.currentReport=r[1].Value,oclientProxy.reports=r[2].Value),r[3]!=null&&r[3]!=i&&r[3].Key=="PageSettings"&&(_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(r[4].Value).Column/JSON.parse(r[3].Value).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(r[4].Value).Row/JSON.parse(r[3].Value).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(r[3].Value).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(r[3].Value).SeriesPageSize):n(".e-olappager")[0]!=null&&n(".e-olappager")[0]!=i&&_proxy._pagerObj.initPagerProperties(JSON.parse(r[4].Value),JSON.parse(r[3].Value)),r[5]!=null&&r[5]!=i&&(_proxy.model.customObject=r[5].Value)),r[3]!=null&&r[3]!=i&&r[3].Key!="PageSettings"&&(_proxy.model.customObject=r[3].Value)):r.d!=i?(this.setJSONRecords(r.d[0].Value),this.setOlapReport(r.d[1].Value),typeof oclientProxy!="undefined"&&(oclientProxy.currentReport=r.d[1].Value,oclientProxy.reports=r.d[2].Value),r.d[3]!=null&&r.d[3]!=i&&r.d[3].Key=="PageSettings"&&(_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(r.d[4].Value).Column/JSON.parse(r.d[3].Value).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(r.d[4].Value).Row/JSON.parse(r.d[3].Value).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(r.d[3].Value).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(r.d[3].Value).SeriesCurrentPage):n(".e-olappager")[0]!=null&&n(".e-olappager")[0]!=i&&_proxy._pagerObj.initPagerProperties(JSON.parse(r.d[4].Value),JSON.parse(r.d[3].Value)),r.d[5]!=null&&r.d[5]!=i&&(_proxy.model.customObject=r.d[5].Value)),r.d[3]!=null&&r.d[3]!=i&&r.d[3].Key!="PageSettings"&&(_proxy.model.customObject=r.d[3].Value)):(this.setJSONRecords(r.PivotRecords),this.setOlapReport(r.OlapReport),typeof oclientProxy!="undefined"&&(oclientProxy.currentReport=r.OlapReport,oclientProxy.reports=r.reports),r.length>3&&(_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(r.HeaderCounts).Column/JSON.parse(r.PageSettings).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(r.HeaderCounts).Row/JSON.parse(r.PageSettings).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(r.PageSettings).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(r.PageSettings).SeriesCurrentPage):n(".e-olappager")[0]!=null&&n(".e-olappager")[0]!=i&&_proxy._pagerObj.initPagerProperties(JSON.parse(r.HeaderCounts),JSON.parse(r.PageSettings))),r.customObject!=null&&r.customObject!=i&&(_proxy.model.customObject=r.customObject));this.model.afterServiceInvoke!=null&&this._trigger("afterServiceInvoke",{action:t.olap.OlapGrid.GridAction.DrillDown,element:this.element,customObject:this.model.customObject});_proxy.model.progressMode=="progress"&&(n("#"+_proxy._id+"progressText")[0].innerHTML=_proxy._getLocalizedLabels("RenderingStarted")+"...");this.renderControlFromJSON(this.getJSONRecords());this.model.currentReport=this.getOlapReport();this._trigger("drillSuccess",this.element);_proxy.model.enableVirtualScrolling&&_proxy._applyVScrolling();typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?n("#"+oclientProxy._id+"_maxView")[0]&&this._maxViewLoading?(this._maxViewLoading.hide(),oclientWaitingPopup.hide()):oclientProxy.model.displaySettings.mode=="gridOnly"&&oclientWaitingPopup.hide():typeof oclientProxy!="undefined"?(!oclientProxy||oclientProxy.ogridObj._startDrilldown||oclientProxy.ochartObj._startDrilldown)&&oclientProxy.model.displaySettings.mode!="gridOnly"||oclientWaitingPopup.hide():_proxy.model.progressMode=="infinite"&&typeof oclientWaitingPopup=="undefined"&&(ogridWaitingPopup=n("#"+this._id).data("ejWaitingPopup"),ogridWaitingPopup.hide());typeof oclientProxy!="undefined"?oclientProxy.ogridObj._startDrilldown=!1:ogridWaitingPopup.hide();var u={action:this._drillAction,customObject:this.model.customObject,element:this.element};this._trigger("renderSuccess",u)},doAjaxPost:function(i,r,u,f){n.ajax({type:i,url:r,contentType:"application/json; charset=utf-8",dataType:"json",data:u,success:n.proxy(f,this),complete:t.proxy(function(t){n.proxy(t,this);var i={action:this._currentAction,customObject:this.model.customObject,element:this.element};this._trigger("renderComplete",i)},this),error:t.proxy(function(t,i,r){_proxy.model.progressMode!="infinite"?(window.clearInterval(oGridTimer),_proxy.model.progressMode=="progress"&&(n("#"+_proxy._id+"progressText")[0].innerHTML=_proxy._getLocalizedLabels("MDXqueryExecutionFailed")+"!!!"),n("#"+ogridProgressBar._id).show(),ogridProgressBar.setModel({value:0,text:r})):ogridWaitingPopup.hide();var u={action:this._drillAction!=""?this._drillAction:"initialize",customObject:this.model.customObject,element:this.element,Message:t};this._trigger("renderFailure",u)},this)})},doPostBack:function(t,i){var r=n("<form>").attr({action:t,method:"POST",name:"export"}),f=function(t,i){var u=n('<input type="hidden" title="params">').attr({id:t,name:t,value:i}).appendTo(r)};for(var u in i)f(u,i[u]);r.appendTo(document.body).submit().remove()},refreshPagedOlapGrid:function(t,i){_proxy.model.progressMode=="infinite"&&typeof oclientWaitingPopup=="undefined"?(ogridWaitingPopup=n("#"+this._id).data("ejWaitingPopup"),ogridWaitingPopup.show()):(this._progressStatus(0,70,140),_proxy.model.progressMode=="progress"&&(n("#"+_proxy._id+"progressText")[0].innerHTML="Preparing and executing MDX query..."));t=t.indexOf("categ")!=-1?"categorical":"series";var r;try{r=JSON.parse(this.getOlapReport()).Report}catch(u){r=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"Paging",pagingInfo:t+":"+i,currentReport:r,layout:this.layout(),customObject:null}),this._renderControlSuccess)},renderControlFromJSON:function(t){var i;if(_proxy=this,_proxy.model.progressMode!="infinite"&&window.clearInterval(oGridTimer),i=n("<table cellspacing=\"0\" cellpadding=\"0\" role='grid'  aria-readonly='true'><\/table>"),this.rowCount=0,t!=null){jQuery.each(t,function(){this.Index[0]==0&&_proxy.rowCount++});var u=n("<thead><\/thead>"),f=n("<tbody><\/tbody>"),e=!0,r=0;if(t[0].CSS=="none"?r=t[0].RowSpan-1:(jQuery.each(t,function(n){return r++,t[n].CSS=="colheader"}),r=r-2),jQuery.each(t,function(i){var h,o,s,c;if(i<_proxy.rowCount)if(e){for(e=i>=r?!1:!0,h="<tr role='row'>",o=i;o<t.length;o=o+_proxy.rowCount)if(t[o].Span!="Block")if(h=h+"<th"+(t[o].CSS=="none"?"":" class="+t[o].CSS)+" p="+t[o].Index+" colspan="+t[o].ColSpan+" rowspan="+t[o].RowSpan+" role='columnheader'>"+(t[o].State==2?'<span class="expand e-icon">&nbsp;<\/span>':t[o].State==1?'<span class="collapse e-icon" title="Collapsed">&nbsp;<\/span>':"")+t[o].Value+"<\/th>",t[o].RowSpan>1&&t[o].ColSpan<=1)for(s=o+1;s<o+t[o].RowSpan;s++)t[s].Span="Block";else if(t[o].ColSpan>1&&t[o].RowSpan<=1)for(s=o+_proxy.rowCount;s<o+t[o].ColSpan*_proxy.rowCount;s=s+_proxy.rowCount)t[s].Span="Block";else if(t[o].ColSpan>1&&t[o].RowSpan>1)for(s=o;s<o+t[o].RowSpan;s++){for(c=s+_proxy.rowCount;c<s+t[o].ColSpan*_proxy.rowCount;c=c+_proxy.rowCount)t[c].Span="Block";t[s].Span="Block"}h+="<\/tr>";n(u).append(h)}else{for(h="<tr role='row'>",o=i;o<t.length;o=o+_proxy.rowCount)if(t[o].Span!="Block")if(h=t[o].CSS=="rowheader"||t[o].CSS=="summary"||t[o].CSS=="summary"?_proxy.layout().toLowerCase()=="excellikelayout"?h+"<th"+(t[o].CSS=="none"?"":' class="'+t[o].CSS)+'" p='+t[o].Index+" colspan="+t[o].ColSpan+" rowspan="+t[o].RowSpan+" role='rowheader'>"+(t[o].State==2?'<span style="margin-left:'+t[o].Level*10+'px" class="expand e-icon">&nbsp;<\/span>':t[o].State==1?'<span style="margin-left:'+t[o].Level*10+'px" class="collapse e-icon">&nbsp;<\/span>':'<span style="margin-left:'+t[o].Level*10+'px">&nbsp;<\/span>')+t[o].Value+"<\/th>":h+"<th"+(t[o].CSS=="none"?"":' class="'+t[o].CSS)+'" p='+t[o].Index+" colspan="+t[o].ColSpan+" rowspan="+t[o].RowSpan+" role='rowheader'>"+(t[o].State==2?'<span class="expand e-icon">&nbsp;<\/span>':t[o].State==1?'<span class="collapse e-icon">&nbsp;<\/span>':"")+t[o].Value+"<\/th>":h+"<td"+(t[o].CSS=="none"?"":' class="'+t[o].CSS)+'" p='+t[o].Index+" colspan="+t[o].ColSpan+" rowspan="+t[o].RowSpan+" role='gridcell'>"+(t[o].State==2?'<span class="expand e-icon">&nbsp;<\/span>':t[o].State==1?'<span class="collapse e-icon">&nbsp;<\/span>':"")+t[o].Value+"<\/td>",t[o].RowSpan>1&&t[o].ColSpan<=1)for(s=o+1;s<o+t[o].RowSpan;s++)t[s].Span="Block";else if(t[o].ColSpan>1&&t[o].RowSpan<=1)for(s=o+_proxy.rowCount;s<o+t[o].ColSpan*_proxy.rowCount;s=s+_proxy.rowCount)t[s].Span="Block";else if(t[o].ColSpan>1&&t[o].RowSpan>1)for(s=o;s<o+t[o].RowSpan;s++){for(c=s+_proxy.rowCount;c<s+t[o].ColSpan*_proxy.rowCount;c=c+_proxy.rowCount)t[c].Span="Block";t[s].Span="Block"}h+="<\/tr>";n(f).append(h)}}),_proxy.model.progressMode!="infinite"){window.clearInterval(oGridTimer);this._progressStatus(85,90,80);window.setTimeout(function(){o()},400);function o(){n(i).append(u);n(i).append(f)}}else n(i).append(u),n(i).append(f)}if(_proxy.model.progressMode!="infinite"){window.clearInterval(oGridTimer);this._progressStatus(90,"101:100%",80);window.setTimeout(function(){s()},900);function s(){_proxy.element.html("");_proxy.model.enableVirtualScrolling?_proxy._createVirtualOlapGrid(i):_proxy.element.append(i);_proxy._unWireEvents();_proxy._wireEvents();n("#"+_proxy._id+"progressContainer").hide()}}else this.element.html(""),_proxy.model.enableVirtualScrolling?_proxy._createVirtualOlapGrid(i):this.element.append(i),_proxy.model.enableRTL?(this.element.find("table").addClass("e-rtl"),this.element.find("table .rowheader,.colheader,.summary").css("text-align","right")):(this.element.find("table").removeClass("e-rtl"),this.element.find("table .rowheader,.colheader,.summary").css("text-align","left")),this._unWireEvents(),this._wireEvents()},_createVirtualOlapGrid:function(n){var u=_proxy._seriesPageCount>1?t.buildTag("div.vScrollPanel")[0].outerHTML:"",f=_proxy._categPageCount>1?t.buildTag("div.hScrollPanel")[0].outerHTML:"",e=t.buildTag("td.virtualScrollGrid",n[0].outerHTML)[0],o=t.buildTag("td.virtualScrollElement",u),s=t.buildTag("td.virtualScrollElement",f),h=t.buildTag("tr.virtualScrollElement",e.outerHTML+o[0].outerHTML),c=t.buildTag("tr.virtualScrollElement",s[0].outerHTML+t.buildTag("td.virtualScrollElement")[0].outerHTML),l=t.buildTag("tbody.oGridOuterDiv.virtualScrollElement",h[0].outerHTML+c[0].outerHTML),i,r;this.element.html(t.buildTag("table.virtualScrollElement",l[0].outerHTML));i=t.buildTag("div.seriesPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("SeriesPage"))[0].outerHTML+t.buildTag("span.series_CurrentPage",_proxy._seriesCurrentPage)[0].outerHTML+" / "+t.buildTag("span.series_pageCount",_proxy._seriesPageCount)[0].outerHTML)[0].outerHTML;_proxy._seriesPageCount>1&&_proxy.element.append(i);r=t.buildTag("div.categPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("CategoricalPage"))[0].outerHTML+t.buildTag("span.categ_CurrentPage",_proxy._categCurrentPage)[0].outerHTML+" / "+t.buildTag("span.categ_pageCount",_proxy._categPageCount)[0].outerHTML)[0].outerHTML;_proxy._categPageCount>1&&_proxy.element.append(r)}});t.olap.OlapGrid.Layout={Normal:"normal",NormalTopSummary:"normaltopsummary",NoSummaries:"nosummaries",ExcelLikeLayout:"excellikelayout"};t.olap.OlapGrid.locale={};t.olap.OlapGrid.locale["en-US"]={SeriesPage:"Series Page",CategoricalPage:"Categorical Page",MDXqueryExecutionFailed:"MDX query execution failed",PreparingAndExecutingMDXquery:"Preparing and executing MDX query",MDXqueryExecutedSuccessfully:"MDX query executed successfully",RenderingStarted:"Rendering Started",RenderingSucceeded:"Rendering Succeeded",RenderingFailed:"Rendering failed"};t.olap.OlapGrid.GridAction={Initialize:"initialize",DrillDown:"drillDown"};t.olap.OlapGrid.ProgressMode={Infinite:"infinite",Normal:"normal",Progress:"progress"}})(jQuery,Syncfusion)})