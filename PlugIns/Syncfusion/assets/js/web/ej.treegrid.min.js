/*!
*  filename: ej.treegrid.min.js
*  version : 12.2.0.36
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n,t,i){t.widget("ejTreeGrid","ej.TreeGrid",{_rootCSS:"e-treegrid",element:null,element:null,validTags:["div"],model:null,keyConfigs:{focus:"e",insertRecord:"45",deleteRecord:"46",editRecord:"113",saveRequest:"13",cancelRequest:"27",firstRowSelection:"ctrl+36",lastRowSelection:"ctrl+35",upArrow:"38",downArrow:"40",moveCellRight:"9",moveCellLeft:"shift+9",selectedRowExpand:"alt+40",totalRowExpand:"ctrl+40",selectedRowCollapse:"alt+38",totalRowCollapse:"ctrl+38"},defaults:{enableAltRow:!0,allowColumnResize:!1,enableVirtualization:!1,allowSorting:!1,allowMultiSorting:!1,sortSettings:{sortedColumns:[]},allowSelection:!0,selectionType:"single",selectedRowIndex:-1,selectedItem:null,allowKeyboardNavigation:!0,cssClass:"",locale:"en-US",editSettings:{allowEditing:!1,allowAdding:!1,allowDeleting:!1,editMode:"normal"},isEdit:!1,rowDataBound:null,queryCellInfo:null,dataSource:null,currentViewData:[],flatRecords:[],parentRecords:[],records:[],columns:[],commonWidth:150,query:t.Query(),dateFormat:"MM/dd/yyyy",rowHeight:30,emptyRecordText:null,treeColumnIndex:0,childMapping:"",idMapping:"",parentIdMapping:"",showGridCellTooltip:!1,showGridExpandCellTooltip:!1},dataTypes:{columns:"array",sortSettings:{sortedColumns:"array"},dataSource:"data",currentViewData:"array",flatRecords:"array",parentRecords:"array",records:"array"},getHeaderTable:function(){return this._$gridHeaderTable},setGridHeaderTable:function(n){this._$gridHeaderTable=n},getHeaderContent:function(){return this._$gridHeaderContent},setGridHeaderContent:function(n){this._$gridHeaderContent=n},getContentTable:function(){return this._$gridContentTable},getContent:function(){return this._$gridContent},setGridContentTable:function(n){this._$gridContentTable=n},getRows:function(){return this._$gridRows},setGridRows:function(n){this._$gridRows=n},getCurrentViewData:function(){return this.model.currentViewData},getFlatRecords:function(){return this.model.records},setHeight:function(n){this._totalHeight=n},getUpdatedRecords:function(){return this._updatedRecords},getUpdatedIds:function(){return this.model.ids},getRecordsCount:function(){return this._recordsCount},setRecordsCount:function(n){this._recordsCount=n},getExpandCollapseRecordsCount:function(){return this._expandCollapseRecordCount},_init:function(){var n=this;n._initPrivateProperties();n.model.isdesignMode&&(n.element.css({height:"250px"}),n.model.columns.length===0&&(n.model.columns=[{field:"Column1",HeaderText:"Column1"},{field:"Column2",HeaderText:"Column2"},{field:"Column3",HeaderText:"Column3"}]),n.model.childMapping.length==0&&(n.model.childMapping="Children"));n._processEditing();n._checkDataBinding();n._createTooltipTemplate()},_setModel:function(t){var i=this,r=i.model;for(var u in t)switch(u){case"enableAltRow":r.enableAltRow=t[u];i._addInitTemplate();i.refreshContent();break;case"enableVirtualization":r.enableVirtualization=t[u];i.refreshContent();break;case"allowColumnResize":r.allowColumnResize=t[u];i._enableColumnResizeEvents();break;case"allowSorting":r.allowSorting=t[u];break;case"sortSettings":n.extend(r.sortSettings,t[u]);i.refreshContent();break;case"allowSelection":i.clearSelection();r.allowSelection=t[u];break;case"selectionType":i.clearSelection();r.selectionType=t[u];break;case"selectedRowIndex":r.selectedRowIndex!=-1&&n.inArray(r.selectedRowIndex,i._selctedRowsIndexes==-1)&&i.selectRows(r.selectedRowIndex);break;case"editSettings":n.extend(r.editSettings,t[u]);i._processEditing();i._enableEditingEvents();break;case"allowKeyboardNavigation":r.allowKeyboardNavigation=t[u];break;case"dataSource":i.resetModelCollections();i.element.ejTreeGrid("destroy").ejTreeGrid(r);break;case"columns":n.extend(r.columns,t[u]);i._addInitTemplate();i.refreshContent();break;case"rowHeight":r.rowHeight=t[u];i._addInitTemplate();i.refreshContent();break;case"treeColumnIndex":r.treeColumnIndex=t[u];i._addInitTemplate();i.refreshContent()}},refreshContent:function(){var i=this,n={};n.requestType=t.TreeGrid.Actions.Refresh;i.processBindings(n)},resetModelCollections:function(){var t=this,n=t.model;n.sortSettings.sortedColumns=[];n.currentViewData=[];n.flatRecords=[];n.parentRecords=[];n.records=[]},_initPrivateProperties:function(){var i=this;i._id=i.element.attr("id");i._columnsWidthCollection=[];i._cSortedColumn=null;i._cSortedDirection=null;i._dataManager=null;i._disabledSortableColumns=[];i._filteredRecords=[];i._fieldColumnNames=[];i._multiSortRequest=null;i._$gridContainer=null;i._$gridContent=null;i._$gridContentTable=null;i._$gridHeaderTable=null;i._$gridHeaderContainer=null;i._gridHeight=i.element.height();i._recordsCount=null;i._$gridRows=null;i._gridRows=null;i._gridWidth=i.element.width();i._headerColumnNames=[];i._hiddenColumns=[];i._multiSelectCtrlRequest=!1;i._multiSelectShiftRequest=!1;i._offset=0;i._previousIndex=-1;i._prevRBottom=0;i._prevRTop=0;i._prevScrollTop=0;i._prevScrollLeft=0;i._prevVBottom=0;i._resizer=null;i._scrollTop=0;i._searchString="";i._selectedRowsIndexes=[];i._sortedRecords=[];i._storedIndex=-1;i._$tableContent=null;i._tempsortedrecords=[];i._totalHeight=0;i._viewPortHeight=0;i._visibleColumns=[];i._visibleRange=null;i._vScrollDir=1;i._vScrollDist=0;i._cellEditTemplate=n();i._cellEditingDetails={cellValue:null,rowIndex:-1,columnIndex:-1,fieldName:null,_data:null,cellEditType:"",cancelSave:!1,defaultData:null,insertedTrCollection:[],data:null};i._tdsOffsetWidth=[];i._isEnterKeyPressed=!1;i._updatedRecords=[];i._scrollBarHeight=0;i._expandCollapseRecordCount=0;i._removedCount=0;i._$gridHeaderContent=null;i._expandedRecordsCount=0;i._totalCollapseRecordCount=0;i._collapsedRecordCount=0;i.secondaryDatasource=[];i._dropDownTemplate=i._compiledDropDownTemplate();i._dataManager=i.model.dataSource instanceof t.DataManager?i.model.dataSource:i.model.dataSource!=null?t.DataManager(i.model.dataSource):null},_checkDataBinding:function(){var t=this,i=t.model;t.element.addClass("e-treegrid-core");t._initDatasource();i.columns.length&&t._renderAfterColumnInitialize();t._viewPortHeight=t._getViewPortHeight();t._ensureDataSource();t._initGridRender();t._$gridContent=n("#"+t._id+"e-gridcontent");t._scrollBarHeight=t._$gridContent[0].offsetHeight-t._$gridContent[0].clientHeight;t._$gridContainer=n("#"+t._id+"e-gridcontainer");t._$tableContent=n("#"+t._id+"e-table");t._wireEvents();t.setWidthToColumns();t._renderScroller();i.isFromGantt&&t._addEmptyColumntoGrid()},_initDatasource:function(){var t=this,n=t.model,i;n.dataSource&&n.dataSource.length>0&&(n.idMapping&&n.parentIdMapping?n.idMapping.length>0&&n.parentIdMapping.length>0&&(i=n.dataSource.slice(0),t._reconstructDatasource(i),t._createRecords(t.secondaryDatasource)):n.flatRecords.length===0&&n.dataSource!==null&&t._createRecords(n.dataSource))},_reconstructDatasource:function(n){for(var i,u=this,f=u.model,e=[],r=0;r<n.length;r++)i={},i=t.DataManager(n).executeLocal(t.Query().where(f.parentIdMapping,t.FilterOperators.equal,n[r][f.idMapping])),(t.isNullOrUndefined(n[r][f.parentIdMapping])||n[r][f.parentIdMapping]==0)&&i.length>0?(n[r][f.childMapping]=i,u.secondaryDatasource.push(n[r])):!t.isNullOrUndefined(n[r][f.parentIdMapping])||i&&i.length>0?i&&i.length>0&&!t.isNullOrUndefined(i[0][f.parentIdMapping])&&u._appendChildDataItems(u.secondaryDatasource,i):u.secondaryDatasource.push(n[r]),i&&i.length>0?(u._datasourceChildItems=u._reconstructDatasource(i),t.isNullOrUndefined(n[r][f.childMapping])&&(n[r][f.childMapping]=u._datasourceChildItems,u._getParentIndex(n)),u._datasourceChildItems=[]):t.isNullOrUndefined(n[r][f.parentIdMapping])||e.push(n[r]);if(e&&e.length>0)return e},_appendChildDataItems:function(n,i){for(var f=this,r=f.model,u=0;u<n.length;u++)n[u][r.idMapping]===i[0][r.parentIdMapping]?n[u][r.childMapping]=i:!t.isNullOrUndefined(n[u][r.childMapping])&&n[u][r.childMapping].length>0&&f._appendChildDataItems(n[u],i);t.isNullOrUndefined(n.length)&&n&&(n[r.idMapping]===i[0][r.parentIdMapping]?n[r.childMapping]=i:!t.isNullOrUndefined(n[r.childMapping])&&n[r.childMapping].length>0&&f._appendChildDataItems(n[r.childMapping],i))},_getParentIndex:function(n){var o=this,r=o.model,f=o.secondaryDatasource,e=0,u,i;for(n.length>0&&(e=n[0][r.parentIdMapping]),i=0;i<f.length;i++){if(f[i][r.idMapping]==e&&t.isNullOrUndefined(f[i][r.childMapping]))return f[i][r.childMapping]=n,!0;if(u=f[i][r.childMapping],u)for(i=0;i<u.length;i++)if(u[i][r.idMapping]==e&&t.isNullOrUndefined(u[i][r.childMapping]))return u[i][r.childMapping]=n,!0}},processBindings:function(n){var i=this,r=i.model;if(r.query=new t.Query,i._trigger("actionBegin",n))return!0;i._ensureDataSource(n)},_ensureDataSource:function(i){var r=this,u=r.model,k=u.sortSettings.sortedColumns,s=!1,e,o,h,c,f,v,y,l,p,a,w,b;u.dataSource!=null&&(u.query.requiresCount(),r._queryManagar=u.query,(u.editSettings.allowEditing||u.editSettings.allowAdding)&&i&&i.requestType==t.TreeGrid.Actions.Save&&(!t.isNullOrUndefined(i._cModifiedData)||!t.isNullOrUndefined(i._cAddedRecord))&&(t.isNullOrUndefined(i._cAddedRecord)?n.extend(u.flatRecords[n.inArray(u.selectedItem,u.flatRecords)],i._cModifiedData):(u.selectedRowIndex===-1?(i._cAddedRecord.hasChildRecords=!1,u.flatRecords.unshift(i._cAddedRecord),u.records.unshift(i._cAddedRecord),u.dataSource.unshift(i._cAddedRecord.item),u.isFromGantt&&u.ids.unshift(i._cAddedRecord.taskId),i.recordIndex=0):(i._cAddedRecord.level=u.selectedItem.level,e=u.selectedItem?u.flatRecords.indexOf(u.selectedItem):0,i._cAddedRecord.level===0&&(e=e>0?e-1:e),i.actionRequestType!=t.TreeGrid.Actions.ContextMenuAdd&&(i.recordIndex=e>0?e-1:0),u.flatRecords.splice(e,0,i._cAddedRecord),c=u.records.indexOf(u.selectedItem),u.records.splice(c,0,i._cAddedRecord),u.isFromGantt&&u.ids.splice(c,0,i._cAddedRecord.taskId.toString()),i._cAddedRecord.level>0&&(h=u.selectedItem.parentItem,h&&(o=h.childRecords?h.childRecords.indexOf(u.selectedItem):-1,o!==-1&&(o=o===0?0:o-1),h.childRecords.splice(o,0,i._cAddedRecord))),r.setRecordsCount(u.flatRecords.length),r.setHeight(u.flatRecords.length*u.rowHeight),r.updateHeight(),s=!0),r._queryManagar.queries=[],u.isEdit=!1,r._updatedGanttRecords=u.flatRecords)),i&&i.requestType===t.TreeGrid.Actions.ExpandCollapse&&(s=!0,r.clearSelection(r.model.selectedRowIndex),r._filteredRecords=[],r._expandCollapseRecordCount=0,r.updateExpandCollapseRecords(i.data,i.expanded,i.recordIndex),r.setRecordsCount(u.flatRecords.length),r.setHeight(u.flatRecords.length*u.rowHeight),r._updatedRecords=u.flatRecords,u.allowSearching&&r._searchString.length&&(r._updateFilteredRecords(r._tempfilteredrecords),r.setRecordsCount(r._filteredRecords.length),r.setHeight(r._filteredRecords*u.rowHeight),r._updatedRecords=r._filteredRecords),u.allowSorting&&u.sortSettings.sortedColumns.length&&(r._updateExpandCollapseForSortedRecords(i.data,i.expanded),r.setHeight(r._sortedRecords*u.rowHeight),r._updatedRecords=r._sortedRecords),r.updateHeight(),u.enableAltRow&&r._updateAltRow()),u.editSettings.allowDeleting&&i&&i.requestType===t.TreeGrid.Actions.Delete&&(f=i.data,r._removedCount=0,l=r._getFilteredChildRecordsCount(f),l+=1,r._removedCount=0,f.parentItem&&(p=f.parentItem.childRecords,o=p.indexOf(f),f.parentItem.childRecords.splice(o,1),f.parentItem.item[r.model.childMapping].splice(o,1)),a=u.parentRecords.indexOf(f),a!==-1&&u.parentRecords.splice(a,1),v=r.model.flatRecords.indexOf(f),r.model.flatRecords.splice(v,l),r.setRecordsCount(u.flatRecords.length),r.setHeight(u.flatRecords.length*u.rowHeight),s=!0,e=u.records.indexOf(f),w=r.getChildCount(f,0),u.records.splice(e,w+1),r._updatedRecords=u.flatRecords,y=u.dataSource.indexOf(f.item),r.model.dataSource.splice(y,1),u.selectedItem=null,u.selectedRowIndex=-1),u.allowSearching&&r._searchString.length?(r._queryManagar.search(r._searchString,r.getColumnFieldNames(),t.FilterOperators.contains,!0),r._filteredRecords=u.records.filter(function(n){return n.hasChildRecords===!1}),b=new t.DataManager(r._filteredRecords),r._tempfilteredrecords=b.executeLocal(r._queryManagar).result,r._updateFilteredRecords(r._tempfilteredrecords),r.setRecordsCount(r._filteredRecords.length),r._updatedRecords=r._filteredRecords,u.allowSorting&&u.sortSettings.sortedColumns.length>0&&r._sortingRecords(),r.setHeight(r._updatedRecords.length*u.rowHeight),r.updateHeight(),s=!0,u.enableAltRow&&r._updateAltRow()):u.allowSorting&&k.length>0&&(s=r._sortingRecords()),s||(r.setRecordsCount(u.flatRecords.length),r.setHeight(u.flatRecords.length*u.rowHeight),r._updatedRecords=u.flatRecords,r.updateHeight()),i||(i={},i.requestType=t.TreeGrid.Actions.Refresh),r._updateCurrentViewData(),(u.isFromGantt||i.requestType!=="save")&&i.requestType!=="sorting"&&i.requestType!=="searching"&&i.requestType!=="delete"||r.renderRecords(i))},_processEditing:function(){var n=this,t=n.model;t.editSettings.allowEditing&&t.editSettings.editMode==="cellEditing"&&n._addCellEditTemplate()},_renderAfterColumnInitialize:function(){var n=this;n.element.append(n._renderGridHeader())},_renderGridHeader:function(){var f=this,e=f.model,s=document,h=t.buildTag("div.e-gridheadercontainer","",{overflow:"hidden"},{}),c=t.buildTag("table.e-table","",{},{cellspacing:"0px","border-spacing":"0px"}),p=t.buildTag("thead"),w=t.buildTag("tbody.e-hide"),l=t.buildTag("tr.e-columnheader"),b=n(s.createElement("colgroup")),k=n(s.createElement("tr")),r=0,u=e.columns,g=u.length,o,d,a,v,y=e.isFromGantt?t.buildTag("div.e-gridheader#"+f._id+"e-gridheader","",{},""):t.buildTag("div.e-gridheader#"+f._id+"e-gridheader","",{"border-top-style":"solid","border-left-style":"solid","border-right-style":"solid","border-top-width":"thin","border-left-width":"thin","border-right-width":"thin"},"");for(f.setGridHeaderContent(y),f._$gridHeaderContainer=h,f._hiddenColumns=[],e.allowSorting&&l.css({cursor:"pointer"}),r;r<g;r++)o=t.buildTag("th.e-headercell","",{height:"45px"},{}),d=s.createElement("td"),a=t.buildTag("div.e-headercelldiv",u[r].headerText==i?u[r].headerText=u[r].field:u[r].headerText,{},{unselectable:"on"}),o.append(a),v=s.createElement("col"),k.append(d),l.append(o),b.append(v),u[r].visible===!1?o.addClass("e-hide")&&n(v).css("display","none")&&f._hiddenColumns.push(u[r].headerText):(f._visibleColumns.push(u[r].headerText),u[r].visible=!0),u[r].allowSorting===!1&&(f._disabledSortableColumns.push(u[r].headerText),o.css({cursor:"normal"})),t.isNullOrUndefined(u[r].headerTemplateID)||a.html(n(u[r].headerTemplateID).hide().html()).parent().addClass("headertemplate"),u[r].width==i&&e.commonWidth!==i?f._columnsWidthCollection[r]=e.commonWidth:f._columnsWidthCollection.push(u[r].width),f._fieldColumnNames[u[r].headerText]=u[r].field,f._headerColumnNames[u[r].field]=u[r].headerText;return p.append(l),w.append(k),c.append(b).append(p).append(w),h.html(c),y.html(h),f.setGridHeaderTable(c),y},_initGridRender:function(){var n=this;n._addInitTemplate();n._renderGrid();n.model.allowColumnResize&&(n._resizer=new t.Grid.gridResize(n))},_renderGrid:function(){var n=this;n._renderGridContent().insertAfter(n.element.children(".e-gridheader"));n._initialEndRendering()},_renderGridContent:function(){var i=this,o=document,r=i.model,s=n(o.createElement("tbody")),f=t.buildTag("div.e-gridcontent#"+i._id+"e-gridcontent","",{height:i._viewPortHeight},{unselectable:"on"}),e=t.buildTag("div.e-gridcontainer#"+i._id+"e-gridcontainer","",{},{}),u,h;return r.enableVirtualization&&e.css({height:i._totalHeight}),u=t.buildTag("table.e-table#"+i._id+"e-table","",{top:"0px"},{cellspacing:"0px"}),u.append(i.getHeaderTable().find("colgroup").clone()).append(s),e.html(u),f.html(e),i.setGridContentTable(u),r.dataSource===null?(h=t.buildTag("td",r.emptyRecordText,{},{colSpan:r.columns.length}),s.append(n(o.createElement("tr")).append(h))):i.renderRecords(),r.isFromGantt||f.css({"border-bottom-style":"solid","border-bottom-width":"thin","border-left-style":"solid","border-left-width":"thin","border-right-style":"solid","border-right-width":"thin","-moz-box-sizing":"border-box",width:"auto",height:"auto"}),u.css({position:"relative"}),f},_initialEndRendering:function(){var n=this,t=n.model.selectedRowIndex;t!=-1&&(n._rowSelectingEventTrigger()||(n.selectRows(t),n._rowSelectedEventTrigger(t)))},_addCellEditTemplate:function(){for(var n=this,e=n.model,r=e.columns,i=0,u=t.buildTag("div","",{display:"none"},{id:n._id+"_CellEditTemplate"}),f,o=r&&r.length,i=0;i<o;i++)f=t.buildTag("div","",{},{id:r[i].field+"_CellEdit"}),t.TreeGrid._initCellEditType(n,f,n._id,i),u.append(f);u.children().length&&(n._cellEditTemplate=u)},_addInitTemplate:function(){var i=this,r=i.model,e=r.columns,f=0,v=e.length,h,o,u={},s,c,l,a;if(e.length===0)return!1;for(u["_"+i._id+"rowClassName"]=t.TreeGrid._getrowClassName,u["_"+i._id+"expandStatus"]=n.proxy(i._getExpandStatusRecord,i),u["_"+i._id+"cellValue"]=i._getCellValue,u["_"+i._id+"itemDetails"]=n.proxy(i._convertItemToString,i),n.views.helpers(u),s="<tr class='e-treegridrows {{:~_"+i._id+"rowClassName()}} ",r.enableAltRow&&(s+="{{if isAltRow}}e-alt-row{{/if}} "),s+="{{if expanded}}e-treegridrowexpand {{else hasChildRecords}} e-treegridrowcollapse {{/if}} 'style='display:{{:~_"+i._id+"expandStatus(#data)}}'role='row'>",f=0;f<v;f++)h=e[f].field,e[f].isTemplateColumn?(c=e[f].templateID,l=e[f].template,c?o="<td style='height:"+r.rowHeight+"px;'class='{{if isSelected}}e-rowcell e-selectionbackground e-intend {{else}}e-rowcell e-intend {{/if}}'role='gridcell''tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}}>"+n("#"+c)[0].innerHTML+"<\/td>":l&&(o="<td style='height:"+r.rowHeight+"px;class='{{if isSelected}}e-rowcell e-selectionbackground e-intend {{else}}e-rowcell e-intend {{/if}}'role='gridcell'tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}}>"+l+"<\/td>")):f===r.treeColumnIndex?o="<td style='height:"+r.rowHeight+"px;'class='{{if isSelected}}e-rowcell e-selectionbackground e-intend {{else}}e-rowcell e-intend {{/if}}'role='gridcell'tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}}><div  style='height:20px;' unselectable='on'>{{if hasChildRecords}}<div class='intend'style='height:1px; float:left; width:{{:level*20}}px; display:inline-block;'><\/div>{{else !hasChildRecords}}<div class='intend'style='height:1px; float:left; width:{{:(level+1)*20}}px; display:inline-block;'><\/div>{{/if}}<div class='{{if expanded}}e-treegridexpand e-icon{{else hasChildRecords}}e-treegridcollapse e-icon{{/if}}'style='float: left;display:inline-block; unselectable='on''><\/div><div class='e-cell'style='display:inline-block;width:100%' unselectable='on'>{{:#data['"+h+"']}}<\/div><\/div><\/td>":r.isFromGantt&&e[f].mappingName===r.resourceInfoMapping?(u={},u["_"+i._id+"resourceName"]=i._getResourceName,n.views.helpers(u),o="<td  style='height:"+r.rowHeight+"px;'class='{{if isSelected}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}}'role='gridcell'tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}}>{{:~_"+i._id+"resourceName('"+i._id+"Object','"+r.resourceNameMapping+"','"+h+"')}}<\/td>"):r.isFromGantt&&e[f].mappingName===r.predecessorMapping?(u={},u["_"+i._id+"predecessor"]=i._getPredecessorsValue,n.views.helpers(u),o="<td  style='height:"+r.rowHeight+"px;'class='{{if isSelected}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}}' role='gridcell'tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}}>{{:~_"+i._id+"predecessor('"+i._id+"Object','"+r.predecessorMapping+"','"+h+"')}}<\/td>"):o="<td  style='height:"+r.rowHeight+"px;'class='{{if isSelected}}e-rowcell e-selectionbackground{{else}}e-rowcell{{/if}}'role='gridcell'tabindex='-1'aria-label={{:~_"+i._id+"itemDetails(#data)}} unselectable='on'>{{:~_"+i._id+"cellValue('"+h+"')}}<\/td>",s+=o;r.isFromGantt&&(s+="<td class='e-extendcolumn'><\/td><\/tr>");a={};a[i._id+"_Template"]=s;n.templates(a)},_convertItemToString:function(n){for(var r,f="",t={},u=this.model.columns,i=0;i<u.length;i++)t[u[i].field]=n.item[u[i].field];for(r in t)t.hasOwnProperty(r)&&(f+=r+""+t[r]+"\n");return f},_getCellValue:function(n){var t=this.data[n];return t?t:this.data.item&&this.data.item[n]},_getResourceName:function(n,t,i){var e=this,r=e.data[i],u=0,o=r&&r.length,f=[];if(r&&r.length>0)for(u;u<o;u++)f.push(r[u][t]);return f},_getPredecessorsValue:function(n,t){return this.data.item[t]},_getExpandStatusRecord:function(n){var t=this;return t.getExpandStatus(n)?"table-row":"none"},_createRecords:function(n){var i=this,u=i.model,f=u.flatRecords,e=n.length,r=0,t,o=u.parentRecords,s=u.records;for(r;r<e;r++)t=i._createRecord(n[r],0,null),i._storedIndex++,t.isAltRow=i._storedIndex%2==0?!1:!0,o.push(t),t.index=i._storedIndex,s[i._storedIndex]=t,f.push(t),t.childRecords&&i._addNestedRecords(t.childRecords)},_createRecord:function(t,r,u,f){var s=this,e,o=t[s.model.childMapping];return e=n.extend({},t),e.parentItem=u,e.item=t,e.childRecords=o&&s._createChildRecords(o,r+1,e),e.hasChildRecords=o?!0:!1,e.expanded=f!==i?f:o?o.length>0:!1,e.isSelected=!1,e.level=r,e},_createChildRecords:function(n,t,i){for(var o=this,f=[],r=0,s=n.length,u=null,e,r=0;r<s;r++)u=n[r],u&&(e=o._createRecord(u,t,i),f.push(e));return f},_addNestedRecords:function(n){for(var t=this,o=t.model,s=o.flatRecords,u=0,c=n.length,h=o.records,f=[],r,u=0;u<c;u++)if(r=n[u],t._storedIndex++,r.isAltRow=t._storedIndex%2==0?!1:!0,r.index=t._storedIndex,h[t._storedIndex]=r,s.push(r),f=r.childRecords,f)for(var e=0,l=f.length,i=null,e=0;e<l;e++)i=f[e],t._storedIndex++,i.index=t._storedIndex,i.isAltRow=t._storedIndex%2==0?!1:!0,h[t._storedIndex]=i,s.push(i),i.childRecords&&t._addNestedRecords(i.childRecords)},_wireEvents:function(){var t=this,i=t.model;t._$gridContent.bind("scroll",n.proxy(t._onScroll,t));t._on(t.element,"click",t._onClick);t._on(t.element,"click","#"+t._id+"e-gridheader",t._onHeaderClick);t._on(t.element,"mousedown","#"+t._id+"e-gridheader",t._headerMouseDown);t.model.showGridCellTooltip&&(t._on(t.element,"mouseenter",".e-rowcell",t._mouseHover),t._on(t.element,"mouseleave",".e-rowcell",t._cellMouseLeave));t._enableColumnResizeEvents();i.isFromGantt&&t._on(t.element,"mousewheel DOMMouseScroll",t._mouseWheel);t._enableEditingEvents()},_mouseHover:function(i){i.preventDefault();var u=n(i.target),r=this,f=0,e=0,l=r.getRows(),a=u.closest("tr"),s=u[0].parentNode,v=l.index(a),c=r.model.currentViewData[v],y,h,o;r._cellMouseLeave();i||(i=window.event);i.originalEvent.pageX||i.originalEvent.pageY?(f=i.originalEvent.pageX,e=i.originalEvent.pageY):(i.originalEvent.clientX||i.originalEvent.clientY)&&(f=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop);f+200>r._windowWidth&&(f-=f+200-r._windowWidth);e+150>r._windowHeight&&(e-=e+150-r._windowHeight);c&&(y={ttiptaskname:c.taskName},h=t.buildTag("table.e-tooltiptable","",{padding:"0"},{cellspacing:"1"}),r.model.showGridExpandCellTooltip==!1?u[0].firstChild&&u[0].firstChild.textContent?o=t.buildTag("tbody",u[0].firstChild.textContent,{},{}):s.childNodes.length>0&&s.childNodes[1]&&s.childNodes[1].textContent&&(o=t.buildTag("tbody",s.childNodes[1].textContent,{},{})):r.model.showGridExpandCellTooltip==!0&&u[0].firstChild&&u[0].firstChild.childNodes.length>0&&u[0].firstChild&&u[0].firstChild.textContent&&(o=t.buildTag("tbody",u[0].firstChild.textContent,{},{})),h.append(o),o&&(!r.model.showGridExpandCellTooltip&&r.model.showGridCellTooltip==!0&&u[0].firstChild||r.model.showGridExpandCellTooltip&&r.model.showGridCellTooltip==!0)&&(r._mouseOverTooltip=t.buildTag("div.e-tooltipgantt#tooltipgantt"+r._id+"",h,{top:e+10+"px",left:f+15+"px",position:"absolute","z-index":"5",padding:"0","border-radius":"3px"},{}),n(document.body).append(r._mouseOverTooltip)))},_cellMouseLeave:function(){var t=this;n("#tooltipgantt").remove();n(t._mouseOverTooltip).remove()},disableTooltip:function(){this._cellMouseLeave()},_createTooltipTemplate:function(){var i=this,u,e=i.model.columnHeaderTexts,f={_getTaskName:i._tooltipTaskName},t,r;n.views.helpers(f);t="<tr class='e-tooltip_rowcell'>";u="{{if ~_getTaskName()}}<td class='e-tooltiptaskname' style='height:auto;width:auto;font-weight:normal;'>{{:ttiptaskname}}<\/td>{{/if}}";t+=u;t+="<\/tr>";r={};r[i._id+"tooltipTemplate"]=t;n.templates(r)},_tooltipTaskName:function(){return this.data.ttiptaskname},_onScroll:function(n){var t=this,r;t.model.showGridCellTooltip&&t._cellMouseLeave();n.scrollLeft!=i&&(t._scrollLeft=n.scrollLeft,r=Math.abs(t._scrollLeft-t._prevScrollLeft));r&&(t._$gridHeaderContainer.scrollLeft(t._scrollLeft),t._prevScrollLeft=t._scrollLeft);n.scrollTop!=i&&t.model.enableVirtualization&&(t._scrollTop=n.scrollTop,t._vScrollDir=t._prevScrollTop<=t._scrollTop?1:-1,t._vScrollDist=Math.abs(t._scrollTop-t._prevScrollTop),t._vScrollDist&&(t._updateCurrentViewData(),t._prevScrollTop=t._scrollTop))},_onClick:function(i){var r=this,u=r.model,e=n(i.target),f;if(u.enableVirtualization&&r.element[0].focus(),e.hasClass("e-treegridexpand")||e.hasClass("e-treegridcollapse")){var s=e.closest("tr"),l=r.getRows(),a=l.index(s),o=u.currentViewData&&u.currentViewData[a],h=r._updatedRecords.indexOf(o),f={},c;f.data=o;f.recordIndex=h;f.expanded=s.hasClass("e-treegridrowexpand")?!1:!0;c=f.expanded?r._trigger("expanding",f):r._trigger("collapsing",f);c||u.isFromGantt||t.TreeGrid.sendExpandCollapseRequest(r,f)}else if(e.hasClass("e-rowcell")||e.parent().hasClass("e-rowcell")||e.closest("td").hasClass("e-rowcell")&&e.hasClass("e-cell")){if(!u.allowSelection)return;u.selectionType==t.TreeGrid.SelectionType.Multiple&&(i.ctrlKey&&(r._multiSelectCtrlRequest=!0),i.shiftKey&&(r._multiSelectShiftRequest=!0,r.selectRows(r._previousIndex,r.getRows().index(e.closest("tr")))));r._multiSelectShiftRequest||(h=r.getRows().index(e.closest("tr")),h!=-1&&(o=u.currentViewData[h],f={rowElement:s,recordIndex:u.selectedRowIndex},r._trigger("rowSelecting",f)||(u.selectedItem=o,u.selectedRowIndex=r._updatedRecords.indexOf(o),r.selectRows(u.selectedRowIndex),f={rowElement:s,data:r.model.selectedItem,target:"ejTreeGrid",recordIndex:u.selectedRowIndex},r._trigger("rowSelected",f))));r._multiSelectShiftRequest=!1}},_onHeaderClick:function(i){var r=this,f=r.model,u,e,o;if(r._cellMouseLeave(),n(i.target).is(".e-ascending, .e-descending")&&(i.target=i.target.parentNode),u=n(i.target),r.getHeaderTable().find(".e-columnheader").find(".e-headercellactive").removeClass("e-headercellactive"),u.hasClass("e-headercelldiv")){if(!f.allowSorting)return!1;e=n.trim(u.text());o=u.find("span").hasClass("e-ascending")?t.sortOrder.Descending:t.sortOrder.Ascending;f.allowMultiSorting&&i.ctrlKey&&(r._multiSortRequest=!0);r.sortColumn(e,o)}return!1},_headerMouseDown:function(t){var i=this,r=i.model,u;i._cellMouseLeave();r.allowColumnResize&&i._resizer._mouseDown(t);n(t.target).hasClass("headercelldiv")&&n(t.target).hasClass("headercell")&&(u=n(t.target).hasClass("headercelldiv")?n(t.target).parent():n(t.target),r.headerEffects&&u.addClass("headercellactive"))},_enableColumnResizeEvents:function(){var n=this;n.model.allowColumnResize?(n._on(n.element,"mousemove",n._mouseMove),n._on(n.element,"mouseup",n._mouseUp)):(n._off(n.element,"mousemove",n._mouseMove),n._off(n.element,"mouseup",n._mouseUp))},_mouseMove:function(n){var t=this;t.model.allowColumnResize&&t._resizer._mouseMove(n)},_mouseUp:function(t){var i=this;i.model.allowColumnResize&&(i.model.isEdit&&n(t.target).hasClass("e-headercelldiv")&&i.saveCell(),i._resizer._mouseUp(t))},_enableEditingEvents:function(){var n=this,t=n.model;t.editSettings.allowEditing?(t.editSettings.editMode=="cellEditing"&&n._on(n.element,"mousedown",".e-gridcontent",n._saveCellHandler),n._on(this.element,"dblclick",".e-gridcontent",n._editdblClickHandler)):(t.editSettings.editMode=="cellEditing"&&n._off(n.element,"mousedown",".e-gridcontent",n._saveCellHandler),n._off(this.element,"dblclick",".e-gridcontent",n._editdblClickHandler))},_saveCellHandler:function(t){var i=n(t.target),r=this;t.stopPropagation();i.closest(".e-popup").length==0&&i.closest(".e-rowcell").find("#"+r._id+"EditForm").length==0&&r.saveCell()},_editdblClickHandler:function(i){var r=this,u=r.model,e=n("#"+r._id+"EditForm"),f={};if(u.editSettings.editMode==="normal"&&(f.requestType=t.TreeGrid.Actions.BeginEdit,r._trigger("actionBegin",f)),r._cellEditingDetails.cancelSave){r._cellEditingDetails.cancelSave=!1;return}e.length===0&&(u.editSettings.editMode=="cellEditing"&&r.element.focus(),r._cellEditingDetails.columnIndex=r.getCellIndex(i),r._cellEditingDetails.rowIndex=r.getRowIndex(i),fieldName=r._cellEditingDetails.columnIndex>=0&&u.columns[r._cellEditingDetails.columnIndex].field,fieldName&&u.editSettings.allowEditing&&u.editSettings.editMode==t.TreeGrid.EditMode.CellEditing&&r.cellEdit(r._cellEditingDetails.rowIndex,fieldName))},_mouseWheel:function(n){var t=this,i=null,f=n;n=n.originalEvent;try{n.preventDefault?n.preventDefault():f.preventDefault()}catch(o){}if(t._$gridContent.height()>t._$gridContainer.height()){t._$gridContent.ejScroller("scrollY",0,!0);return}if(n.wheelDelta?(i=-n.wheelDelta/120,window.opera&&parseFloat(window.opera.version,10)<10&&(i=-i)):n.detail&&(i=n.detail/3),!i)return!1;var e=t._$gridContent.ejScroller("option","scrollTop"),r=e+i*57,u=parseInt(t._updatedRecords.length*30)-(t._viewPortHeight-18);return r>u&&(r=u),r<0&&(r=0),t._updateScrollTop(r),!0},_keyPressed:function(t,i,r){var u=this,v=u.element,s=v.ejTreeGrid("instance"),f=s.model,l,a,c,h,e,o;if(!f.allowKeyboardNavigation||i.tagName=="INPUT"&&r.code!=40&&r.code!=38&&r.code!=13&&r.code!=27&&r.code!=9||r.code!=113&&i.tagName=="TD")return!0;l=!1;a=n(i);switch(t){case"saveRequest":f.editSettings.editMode=="cellEditing"&&s._moveCurrentCell("down");break;case"cancelRequest":f.editSettings.editMode=="cellEditing"&&s.cancelEditCell();break;case"editRecord":f.editSettings.allowEditing&&f.editSettings.editMode=="cellEditing"&&(s._cellEditingDetails.rowIndex=f.selectedRowIndex,s._cellEditingDetails.columnIndex=u.getCellIndex(r,i),s._cellEditingDetails.columnIndex!==-1&&(fieldName=s.model.columns[s._cellEditingDetails.columnIndex].field,fieldName&&s.cellEdit(s._cellEditingDetails.rowIndex,fieldName)));break;case"firstRowSelection":u._rowSelectingEventTrigger()||(u.selectRows(0),h=u._updatedRecords.indexOf(f.selectedItem),e=h!==-1&&h*f.rowHeight,o=u._$gridContent.scrollTop(),o>e&&(args={requestType:"scroll",delta:e},u._completeAction(args),u._$gridContent.scrollTop(e),f.enableVirtualization&&u.element[0].focus()),u._rowSelectedEventTrigger(0));break;case"lastRowSelection":u._rowSelectedEventTrigger()||(c=u._updatedRecords.length-1,u.selectRows(c),h=f.selectedItem&&u._updatedRecords.indexOf(f.selectedItem),e=c!==-1&&h*f.rowHeight,e+u.model.rowHeight>=u._viewPortHeight&&(o=e+u.model.rowHeight-(u._viewPortHeight-u._scrollBarHeight),args={requestType:"scroll",delta:o},u._completeAction(args),u._$gridContent.scrollTop(o),f.enableVirtualization&&u.element[0].focus()),u._rowSelectedEventTrigger(c));break;case"moveCellLeft":f.editSettings.allowEditing&&f.editSettings.editMode=="cellEditing"&&(l=u._moveCurrentCell("left"));break;case"moveCellRight":f.editSettings.allowEditing&&f.editSettings.editMode=="cellEditing"&&a&&(l=u._moveCurrentCell("right"));break;case"downArrow":c=u._updatedRecords.length-1;u.model.selectedRowIndex!=c&&(u.selectRows(u.model.selectedRowIndex+1),h=f.selectedItem&&u._updatedRecords.indexOf(f.selectedItem),e=c!==-1&&h*f.rowHeight,e+u.model.rowHeight>=u._viewPortHeight&&(o=e+u.model.rowHeight-(u._viewPortHeight-u._scrollBarHeight),u._$gridContent.height()<u._$gridContainer.height()&&(o+=18),args={requestType:"scroll",delta:o},u._completeAction(args),u._$gridContent.children(".e-content").scrollTop(o),f.enableVirtualization&&u.element[0].focus()),u._rowSelectedEventTrigger(u.model.selectedRowIndex));break;case"upArrow":u.model.selectedRowIndex!==0&&u.selectRows(u.model.selectedRowIndex-1);h=u._updatedRecords.indexOf(f.selectedItem);e=h!==-1&&h*f.rowHeight;o=u._$gridContent.children(".e-content").scrollTop();o>e&&(args={requestType:"scroll",delta:e},u._completeAction(args),u._$gridContent.scrollTop(e),f.enableVirtualization&&u.element[0].focus());u._rowSelectedEventTrigger(u.model.selectedRowIndex);break;default:l=!0}return l},_rowSelectingEventTrigger:function(){var t=this,n=t.model,r={},i,u;return n.currentViewData.length<=0&&(n.selectedRowIndex=-1),n.selectedRowIndex!==-1&&n.currentViewData.length>0&&(u=t.getRows(),i=n.currentViewData[n.selectedRowIndex],n.selectedItem=i,r={rowElement:u.eq(n.selectedRowIndex),data:i,recordIndex:n.selectedRowIndex}),t._trigger("rowSelecting",r)},_rowSelectedEventTrigger:function(n){var t=this,r=t.model,i={},u=t.getRows();r.currentViewData.length>0&&(i={rowElement:u.eq(n),data:t.model.selectedItem,target:"ejTreeGrid",recordIndex:n},t._trigger("rowSelected",i))},_eventBindings:function(){var t=this,i=t.model,n=0,r=t._gridRows,u=r.length;if(i.queryCellInfo!=null||i.rowDataBound!=null)for(n;n<u;n++)t._rowEventTrigger(r[n],i.flatRecords[n])},_rowEventTrigger:function(t,i){var f=this;f._trigger("rowDataBound",{rowElement:t,data:i});var u=t.cells,o=n(t).find(".e-rowcell"),r=0,s=u.length,e,h=f.model.columns;for(r;r<s;r++)n(u[r]).hasClass("e-rowcell")&&(e=h[o.index(u[r])]),e&&f._cellEventTrigger(u[r],i,e)},_cellEventTrigger:function(n,t,i){var r={cellElement:n,data:t,column:i};r.cellValue=r.column&&t[r.column.field];this._trigger("queryCellInfo",r)},_completeAction:function(i){var r=this,f=r.model,e=f.sortSettings.sortedColumns,u,o;if(f.isEdit=!1,t.TreeGrid.Actions.Sorting==i.requestType&&f.allowSorting||t.TreeGrid.Actions.Refresh==i.requestType){if(f.allowSorting)for(r._multiSortRequest||(r.getHeaderTable().find(".e-columnheader").find(".e-headercelldiv").find(".e-ascending,.e-descending").remove(),r.getHeaderTable().find("[aria-sort]").removeAttr("aria-sort")),u=0;u<e.length;u++)r._addSortElementToColumn(e[u].field,e[u].direction);r._multiSortRequest=!1}else(t.TreeGrid.Actions.BeginEdit==i.requestType||t.TreeGrid.Actions.Add==i.requestType)&&(o=n("#"+r._id+"EditForm"),r.model.isEdit=!0,r.setWidthToColumns(),t.TreeGrid.Actions.Add==i.requestType&&o.find(".e-field:disabled").not(".e-identity").removeAttr("disabled").removeClass("e-disable"));r._trigger("actionComplete",i)},sendDataRenderingRequest:function(i){var r=this,u,f;if(r.model.currentViewData.length)switch(i.requestType){case t.TreeGrid.Actions.Delete:case t.TreeGrid.Actions.Refresh:case t.TreeGrid.Actions.Save:case t.TreeGrid.Actions.Sorting:case t.TreeGrid.Actions.Searching:case t.TreeGrid.Actions.ExpandCollapse:u=document.createElement("div");r.getContentTable().find("colgroup").first().replaceWith(r._getMetaColGroup());f=r.getContentTable().children("tbody");f.empty();u.innerHTML=["<table>",n.render[r._id+"_Template"](r.model.currentViewData),"<\/table>"].join("");r.getContentTable().get(0).replaceChild(u.firstChild.firstChild,r.getContentTable().get(0).lastChild);r._gridRows=r.getContentTable().get(0).rows;r.setGridRows(n(r.getContentTable().get(0).rows));r._eventBindings()}else r.getContentTable().find("tbody").empty().append(r._getEmptyTbody()),r._gridRows=null,r.setGridRows(null);r._completeAction(i)},sortColumn:function(r,u){var f=this,o=f.model,h=o.sortSettings.sortedColumns,s={},e=0,l=h.length,c;if(o.allowSorting&&n.inArray(r,f._disabledSortableColumns)==-1&&r.length!=0){for(f._multiSortRequest||(o.sortSettings.sortedColumns=[]),s.requestType=t.TreeGrid.Actions.Sorting,s.columnName=r,f._cSortedColumn=f.getFieldNameByHeaderText(r),f._cSortedDirection=s.columnSortDirection=u===i?t.sortOrder.Ascending:u,e;e<l;e++)if(h[e].field==f._cSortedColumn){h.splice(e,1);break}o.sortSettings.sortedColumns.push({field:f._cSortedColumn,direction:f._cSortedDirection});c=f.processBindings(s);c&&(f._cSortedDirection=f._cSortedColumn=null)}},deleteRow:function(n){var i=this,u,f,r={};if(t.isNullOrUndefined(n)&&(n=i.getRowByIndex(i.model.selectedRowIndex)),u=i.getRows().index(n),f=i.model.currentViewData[u],r.tr=n,r.data=f,r.requestType=t.TreeGrid.Actions.Delete,i._trigger("actionBegin",r))return!0;i.processBindings(r)},search:function(n){var r=this,i={};i.requestType=t.TreeGrid.Actions.Searching;i.keyValue=n;r._searchString=n;r.processBindings(i)},endEdit:function(){var n=this;return n.model.editSettings.editMode=="cellEditing"?n.saveCell():!0},getVisibleRange:function(){var n=this,r=n._scrollTop/n.model.rowHeight,u=r-Math.floor(r),t,i,f=n.model;return n._offset=u*f.rowHeight,t=Math.floor(r),i=n._getRowPosition(n._scrollTop+n._viewPortHeight),t=Math.max(0,t),i=Math.min(n.getRecordsCount(),i),n._visibleRange={top:t,bottom:i},n._visibleRange},setWidthToColumns:function(){var i=this,s=i.model,f=i.getContentTable().children("colgroup").find("col"),r=i.getHeaderTable().children("colgroup").find("col"),o=i._gridWidth,u=s.columns.length,n,e;for(f.length>u&&f.splice(0,f.length-u),r.length>u&&r.splice(0,r.length-u),n=0;n<r.length;n++)t.isNullOrUndefined(i._columnsWidthCollection[n])?(e=(o/u).toFixed(2)+"px",f.eq(n).css("width",e),r.eq(n).css("width",e),i._columnsWidthCollection[n]=(o/u).toFixed(2)):(f.eq(n).width(i._columnsWidthCollection[n]),r.eq(n).width(i._columnsWidthCollection[n]))},cellEdit:function(i,r){var u=this,o,s=u.model,f,e;return(u.model.showGridCellTooltip&&u._cellMouseLeave(),u.model.isEdit&&u.saveCell(),o=n("#"+u._id+"EditForm"),o.length>0)?!0:u.model.selectedItem?s.isFromGantt&&(r==="status"||r==="startDate"||r==="endDate"||r==="duration"||r==="predecessor")&&u.model.selectedItem.hasChildRecords||r==="baselineStartDate"||r==="baselineEndDate"?!1:u.getRows()[i]?(f=n(u.getRows()[i]),columnIndex=u.getColumnIndexByField(r),$targetTd=f.find(".e-rowcell").eq(columnIndex),column=u.model.columns[columnIndex],data=u.model.selectedItem,beginEditArgs={},args={validationRules:t.isNullOrUndefined(column.validationRules)?{}:n.extend(!0,{},column.validationRules),columnName:column.field,value:data[r]?data[r]:data.item&&data.item[r],data:data,columnObject:column,cell:$targetTd},isEditable=!0,s.isFromGantt&&args.columnName==="predecessor"&&(e=args.data.item[u.model.predecessorMapping],args.value=e?e:""),beginEditArgs.data=data,beginEditArgs.columnIndex=columnIndex,beginEditArgs.rowElement=f,beginEditArgs.cellElement=$targetTd,u._cellEventTrigger(f[0].cells[u._cellEditingDetails.columnIndex],data,args.columnObject),u._trigger("beginEdit",beginEditArgs))?!1:((n.inArray(r,u._primaryKeys)!=-1||args.columnObject.allowEditing===!1)&&(n.extend(u._cellEditingDetails,{cellValue:args.value,rowIndex:i,fieldName:r,data:args.data,columnIndex:columnIndex}),isEditable=!1),f.hasClass("e-insertedrow")&&!args.columnObject.isTemplateColumn&&(isEditable=!0),isEditable&&n.extend(u._cellEditingDetails,{rowIndex:i,cellValue:args.value,columnIndex:columnIndex,fieldName:r,cellEditType:args.columnObject.editType,data:data}),u._renderCellEditObject(args,$targetTd),f.addClass("e-editedrow"),u._cellEditingDetails.columnIndex===0?args.cell&&args.cell.addClass("e-editedfirstcell"):args.cell&&args.cell.addClass("e-editedcell"),!0):void 0:!1},saveCell:function(){var r=this,u=r.model,l,k,s,f,nt;if(n("#"+r._id+"EditForm").length>0){if(!r.editFormValidate())return!0;if(r._cellEditingDetails.columnIndex>=0){var p=n("#"+r._id+"EditForm"),w=p.closest("tr"),tt=p.closest("td"),b,i={},e=u.columns[r._cellEditingDetails.columnIndex],c=n("#"+r._id+r._cellEditingDetails.fieldName),o;if(i={columnName:e.field,value:r.getCurrentEditCellData(),data:r._cellEditingDetails.data,previousValue:r._cellEditingDetails.cellValue,columnObject:e,cellElement:tt,rowElement:w},(r._cellEditingDetails.cellEditType=="datetimepicker"||r._cellEditingDetails.cellEditType=="dropdownedit"||r._cellEditingDetails.cellEditType=="datepicker")&&c.data("ejWidgets")&&c[c.data("ejWidgets")[0]]("destroy"),r._cellEditingDetails.cellEditType==="datepicker"&&(i.value=r.getFormatedDate(i.value)),t.isNullOrUndefined(e.format)?i.columnObject.type=="boolean"?(l={},l[i.columnObject.field]=i.value,i.cellElement.empty().html(n(n.templates.Grid_JSONTemplate.render(l))[0].cells[r._cellEditingDetails.columnIndex].innerHTML)):i.cellElement.empty().html(i.value):(b=r.formatting(e.format,i.value),i.cellElement.empty().html(b)),k=(r._cellEditingDetails.cellEditType=="datepicker"||r._cellEditingDetails.cellEditType=="datetimepicker")&&i.value instanceof Date&&i.previousValue instanceof Date?i.value.getTime()!==i.previousValue.getTime():i.value!==i.previousValue,u.isEdit=!1,s=r._cellEditingDetails.fieldName,u.isFromGantt&&s==="predecessor"){var a=[],d=[],v=[],h=0,g,y;for(i.previousValue=i.data.predecessor,d=i.previousValue,i.value.length>0&&(v=i.data._calculatePredecessor(i.value)),g=v.length,f=0,nt=i.previousValue&&i.previousValue.length,f=0;f<nt;f++)y=d[f],y.from===i.data.taskId.toString()&&a.push(y);for(h=0;h<g;h++)a.push(v[h]);i.data[r._cellEditingDetails.fieldName]=a;i.data.item[u.predecessorMapping]=i.value}else if(k){if(u.isFromGantt)switch(s){case"taskId":i.data.item[u.taskIdMapping]=i.value;break;case"taskName":i.data.item[u.taskNameMapping]=i.value;break;case"startDate":i.data.item[u.startDateMapping]=i.value;break;case"endDate":i.data.item[u.endDateMapping]=i.value;break;case"resourceInfo":i.data.item[u.resourceInfoMapping]=r._getResourceId(i.value);break;case"Duration":i.data.item[u.durationMapping]=i.value;break;case"Progress":i.data.item[u.progressMapping]=i.value;break;default:i.data.item[r._cellEditingDetails[s]]=i.value}else i.data.item[r._cellEditingDetails.fieldName]=i.value;i.data[r._cellEditingDetails.fieldName]=i.value}u.isFromGantt&&(i.columnName==="startDate"||i.columnName==="endDate"||i.columnName==="duration"||i.columnName==="predecessor"||i.columnName=="status")&&(i.isModified=!0);r._cellEditingDetails.columnIndex===0?(o=n(n.render[r._id+"_Template"](i.data))[0].cells[r._cellEditingDetails.columnIndex],i.cellElement.removeClass("e-editedcell").replaceWith(o)):(o=n(n.render[r._id+"_Template"](i.data))[0].cells[r._cellEditingDetails.columnIndex],i.cellElement.removeClass("e-editedcell").replaceWith(o));r._trigger("endEdit",i);r._cellEventTrigger(i.rowElement[0].cells[r._cellEditingDetails.columnIndex],i.data,i.columnObject);w.removeClass("e-editedrow")}}return!1},editFormValidate:function(){return n.isFunction(n.validator)?n("#"+this._id+"EditForm").validate({onsubmit:!1}).form():!0},getCurrentEditCellData:function(){var u=this,f=u.model,r,i;if(n("#"+u._id+"EditForm").length){r=n("#"+u._id+u._cellEditingDetails.fieldName);switch(u._cellEditingDetails.cellEditType){case t.TreeGrid.EditingType.String:i=r.val();break;case t.TreeGrid.EditingType.Numeric:i=r.ejNumericTextbox("getValue");r.ejNumericTextbox("getValue");break;case t.TreeGrid.EditingType.Dropdown:i=f.isFromGantt?u._getSelectedItem(r.ejDropDownList("model.selectedItems")):r.ejDropDownList("model.value");break;case t.TreeGrid.EditingType.Boolean:i=r.is(":checked");break;case t.TreeGrid.EditingType.DatePicker:i=r.ejDatePicker("model.value");break;case t.TreeGrid.EditingType.DateTimePicker:i=r.ejDateTimePicker("model.value")}return typeof i=="string"&&i.length&&f.columns[u._cellEditingDetails.columnIndex].type=="number"&&(i=parseFloat(i)),i}return null},_getResourceId:function(n){for(var i=[],t=0,r=n.length,t=0;t<r;t++)i.push(n[t][this.model.resourceIdMapping]);return i},_getSelectedItem:function(t){var r=this,i=0,e=t.length,u=r.model.columns[r._cellEditingDetails.columnIndex].dropdownData,f=[];if(u)for(i=0;i<e;i++)n.each(u,function(n,r){t[i]===n&&f.push(r)});return f},getFormatedDate:function(n){return Globalize.format(n,this.model.dateFormat)},formatting:function(t,i){var r,u,s,e,o,h,c,f;return t=t.replace(/%280/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">"),r=this,u=t,s=t.split("{0:"),h=t.split("}"),e=s[0],o=h[1],t.indexOf("{0:")!=-1?(c=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),f=c.exec(t),f!=null&&i!=null?e!=null&&o!=null?e+Globalize.format(i,f[2])+o:Globalize.format(i,f[2]):i!=null?i:""):r.data!=null&&r.data.Value==null?(n.each(r.data,function(n,t){u=u.replace(new RegExp("\\{"+n+"\\}","gm"),t)}),u):r.data.Value},getColumnIndexByField:function(n){var r=this,i=r.model.columns,u=i.length,t=0;for(t;t<u;t++)if(i[t].field==n)break;return t},getBrowserDetails:function(){var n=navigator.userAgent.match(/(firefox|chrome|opera|msie|safari)\s?\/?(\d+(.\d+)*)/i);return!navigator.userAgent.match(/Trident\/7\./)?{browser:n[1].toLowerCase(),version:n[2]}:{browser:"msie",version:jQuery.uaMatch(navigator.userAgent).version}},setValidation:function(){var r=this,i=r.model.columns,u=i.length,n=0;for(r._initValidator(),n;n<u;n++)t.isNullOrUndefined(i[n].validationRules)||r.setValidationToField(i[n].field,i[n].validationRules)},setValidationToField:function(i,r){var u=this,e=n("#"+u._id+i).length>0?n("#"+u._id+i):n("#"+i),f;e.rules("add",r);f=n("#"+u._id+"EditForm").validate({onsubmit:!1});t.isNullOrUndefined(r.required)||(f.settings.messages[i]={},f.settings.messages[i].required=t.TreeGrid.getColumnByField(u.model.columns,i).headerText+" is required")},getFieldNameByHeaderText:function(n){var i=this;return t.isNullOrUndefined(i._fieldColumnNames[n])?null:i._fieldColumnNames[n]},clearSelection:function(i){var r=this,e=r.model,o,i,s,h,a,c,f,l,u;if(e.selectedRowIndex!=-1&&(o=r.getRows(),!t.isNullOrUndefined(i))){if(r.getRowByIndex(i).removeAttr("aria-selected").find(".e-selectionbackground").removeClass("e-selectionbackground").removeClass("e-active"),s=n.inArray(i,this._selectedRowsIndexes),s!=-1&&this._selectedRowsIndexes.splice(s,1),h=e.flatRecords[i],h)h.isSelected=!1;else if(o&&o.removeAttr("aria-selected").find(".e-rowcell").removeClass("e-selectionbackground").removeClass("e-active"),a=new t.DataManager(e.flatRecords),c=new t.Query,c.search(!0,["isSelected"],t.FilterOperators.Equals,!0),f=a.executeLocal(c),l=f&&f.length,l>0)for(u=0,u=0;u<l;u++)f[u].isSelected=!1;r._selectedRowsIndexes.length||(r.model.selectedRowIndex=-1,r.model.selectedItem=null)}},updateExpandCollapseRecords:function(n,t,i){var r=this;n.expanded=t;r._removedCount=0;r._expandCollapseRecordCount=r.getChildRecordsCount(n);t?(r._tempRecordIndex=r.model.records.indexOf(n),n.hasChildRecords&&r._addNestedExpandCollapseRecords(n.childRecords,n.level,n,i)):r.model.flatRecords.splice(i+1,r._expandCollapseRecordCount)},getChildRecordsCount:function(n){var r=this,i=n.childRecords,t=0,f=i?i.length:0,u;for(t;t<f;t++)r._filteredRecords.length>0?(u=r._filteredRecords.indexOf(i[t]),u!=-1&&(++r._removedCount,i[t].hasChildRecords&&i[t].expanded&&r.getChildRecordsCount(i[t]))):(++r._removedCount,i[t].hasChildRecords&&i[t].expanded&&r.getChildRecordsCount(i[t]));return r._removedCount},getExpandStatus:function(n){var t=n.parentItem;return t!=null?t.expanded===!1?!1:t.parentItem?t.parentItem.expanded===!1?!1:this.getExpandStatus(t.parentItem):!0:!0},getColumnFieldNames:function(){var i=[],t=this.model.columns,n=0,r=t.length;for(n;n<r;n++)t[n].field&&i.push(t[n].field);return i},renderRecords:function(n){var i=this;n||(n={},n.requestType=t.TreeGrid.Actions.Refresh);this.sendDataRenderingRequest(n)},selectRows:function(r,u){var f=this,e=f.model,c=f.getRows(),s;if((e.editSettings.allowEditing||e.editSettings.allowAdding)&&n("#"+f._id+"EditForm").length>0&&f.endEdit()){c=f.getRows();return}if(t.isNullOrUndefined(u)||t.isNullOrUndefined(r)){r=t.isNullOrUndefined(r)?u:r;switch(e.selectionType){case t.TreeGrid.SelectionType.Multiple:if(f._multiSelectCtrlRequest){s=n.inArray(r,f._selectedRowsIndexes);s!=-1&&f.clearSelection(r)&&f._selectedRowsIndexes.splice(s,0);s==-1&&(f._selectedRowsIndexes.push(r),f.getRowByIndex(r).attr("aria-selected","true").find(".e-rowcell").addClass("e-selectionbackground e-active").attr("tabindex","0"));break}case t.TreeGrid.SelectionType.Single:f.clearSelection(f._previousIndex);r<=f._updatedRecords.length-1&&(f._selectedRowsIndexes=[],f._selectedRowsIndexes.push(r),f.getRowByIndex(r).attr("aria-selected","true").find(".e-rowcell").addClass("e-selectionbackground e-active").attr("tabindex",0),f._updatedRecords[r].isSelected=!0,e.selectedItem=f._updatedRecords[r])}}else if(e.selectionType==t.TreeGrid.SelectionType.Multiple){f.clearSelection();f._selectedRowsIndexes=[];var h=r-u<0?c.slice(r,u+1):c.slice(u,r+1),o=0,l=h.length;for(o;o<l;o++)f._selectedRowsIndexes.push(h[o].rowIndex),e.flatRecords[h[o].rowIndex].isSelected=!0;n(h).attr("aria-selected","true").find(".e-rowcell").addClass("e-selectionbackground e-active").attr("tabindex","0")}return f._previousIndex=f._selectedRowsIndexes.length?r:i,e.selectedRowIndex!=r&&(e.selectedRowIndex=r),f._multiSelectCtrlRequest=!1,!1},getCellIndex:function(t,i){var r=n(t.target),u;return(i&&(r=n(i)),r.prop("tagName")=="TD")?r.index():r.prop("tagName")=="DIV"&&r.hasClass("e-cell")?(u=r.closest("td"),u.index()):-1},getRowIndex:function(t){var e=this,r=n(t.target),u=e.getRows(),i=u.index(r.parent()),f;return i==-1&&(f=r.closest("tr"),i=u.index(f)),i},getRowByIndex:function(i,r){var f,e;try{var u=this,o=u.getRows(),s=u._gridRows,h=n();return u.model.enableVirtualization&&(f=u._updatedRecords[i],i=u.model.currentViewData.indexOf(f)),t.isNullOrUndefined(r)?(u.model.enableVirtualization&&(e=u._updatedRecords[r],r=u.model.currentViewData.indexOf(e)),n(s[i])):n(o.slice(i,r))}catch(c){return n()}},cancelEditCell:function(){var t=this,i=t._gridRows[t.model.selectedRowIndex],r;({})[t._cellEditingDetails.fieldName]=t._cellEditingDetails.cellValue;data=t.model.selectedItem;r=n(i).hasClass("e-insertedrow")?i.cells[t._cellEditingDetails.columnIndex]:i.cells[t._cellEditingDetails.columnIndex];n(r).removeClass("e-editedcell").empty().html(n(n.render[t._id+"_Template"](data))[0].cells[t._cellEditingDetails.columnIndex].innerHTML);t.element.focus();t._trigger("cancelEditCell")},refreshRow:function(t){var i=this,r=i.model.currentViewData[t];r&&n(i._gridRows[t]).replaceWith(n(n.render[i._id+"_Template"](r)));i.setGridRows(n(i.getContentTable().get(0).rows))},renderRecord:function(t){var r=this,h=n.render[this._id+"_Template"](t._cAddedRecord),i=r.model,u,e,s,f,o,c,l,a,v;r._gridRows!=null&&r._gridRows.length>0?(s=i.currentViewData.indexOf(i.selectedItem),t.position?t.position=="Above"?r.getRows().eq(s).before(h):t.position=="Below"&&r.getRows().eq(s).after(h):s===-1?(t._cAddedRecord.index=0,r.getRows().eq(0).before(h)):r.getRows().eq(s).after(h),i.isFromGantt&&(r.setGridRows(n(r.getContentTable().get(0).rows)),t._cAddedRecord.hasChildRecords=!1,t._cAddedRecord.expanded=!1,t._cAddedRecord.parentItem?t._cAddedRecord.parentItem.hasChildRecords&&t.position=="Below"?(f=i.flatRecords.indexOf(t._cAddedRecord.parentItem),o=i.flatRecords[f].childRecords.indexOf(t.selectedItem),o===-1?i.flatRecords[f].childRecords.splice(0,0,t._cAddedRecord):i.flatRecords[f].childRecords.splice(o+1,0,t._cAddedRecord)):t._cAddedRecord.parentItem.hasChildRecords&&t.position=="Above"&&(f=i.flatRecords.indexOf(t._cAddedRecord.parentItem),o=i.flatRecords[f].childRecords.indexOf(t.selectedItem),o===-1?i.flatRecords[f].childRecords.push(t._cAddedRecord):i.flatRecords[f].childRecords.splice(o,0,t._cAddedRecord)):i.parentRecords.splice(t._cAddedRecord.index,0,t._cAddedRecord),i.selectedItem?(c=i.records.indexOf(i.selectedItem),l=i.flatRecords.indexOf(i.selectedItem),t.position=="Above"?(e=c,u=l):(e=c+1,u=l+1)):(e=0,u=0),r.getExpandStatus(t._cAddedRecord)&&i.enableVirtualization?u===i.flatRecords.length?(i.flatRecords.push(t._cAddedRecord),i.dataSource.push(t._cAddedRecord.item)):(i.flatRecords.splice(u,0,t._cAddedRecord),i.dataSource.splice(u,0,t._cAddedRecord.item)):i.enableVirtualization||(u===i.flatRecords.length?(i.flatRecords.push(t._cAddedRecord),i.dataSource.push(t._cAddedRecord.item)):(i.flatRecords.splice(u,0,t._cAddedRecord),i.dataSource.splice(u,0,t._cAddedRecord.item))),e===i.records.length?(i.records.push(t._cAddedRecord),i.ids.push(t._cAddedRecord.taskId.toString())):(i.records.splice(e,0,t._cAddedRecord),i.ids.splice(e,0,t._cAddedRecord.taskId.toString())),r.setRecordsCount(i.flatRecords.length),r.setHeight(i.flatRecords.length*i.rowHeight),r._updatedRecords=i.flatRecords,r._updateCurrentViewData())):(r._gridRows==null||r._gridRows.length==0)&&(i.selectedRowIndex===-1&&(t._cAddedRecord.hasChildRecords=!1,t.recordIndex=0),i.flatRecords.push(t._cAddedRecord),i.dataSource==null&&(i.dataSource=[]),i.dataSource.push(t._cAddedRecord.item),i.records.push(t._cAddedRecord),i.ids.push(t._cAddedRecord.taskId.toString()),r._updatedGanttRecords=i.flatRecords,r._updatedRecords=i.flatRecords,r.setRecordsCount(i.flatRecords.length),r.setHeight(i.flatRecords.length*i.rowHeight),r._updateCurrentViewData(),r.getContentTable().find("tbody").empty().append(r._getEmptyTbody()),a=document.createElement("div"),r.getContentTable().find("colgroup").first().replaceWith(r._getMetaColGroup()),v=r.getContentTable().children("tbody"),v.empty(),a.innerHTML=["<table>",n.render[r._id+"_Template"](r.model.currentViewData),"<\/table>"].join(""),r.getContentTable().get(0).replaceChild(a.firstChild.firstChild,r.getContentTable().get(0).lastChild),r._gridRows=r.getContentTable().get(0).rows,r.setGridRows(n(r.getContentTable().get(0).rows)),r._eventBindings())},onScrollHelper:function(n){var t=this,i;t._$gridContent.ejScroller("scrollY",n,!0);i=t._$gridContent.ejScroller("isHScroll");i||t._$gridContent.scrollTop(n)},isVScroll:function(){return this._$gridContent.hasClass("e-scroller")?this._$gridContent.ejScroller("isVScroll"):!1},refreshScroller:function(n){var t=this,i,r;t._$gridContent.removeClass("e-borderbox");i=t._$gridContent.ejScroller("option","scrollTop");t._$gridContent.ejScroller("option",{persist:!0});t._$gridContent.ejScroller("option",{width:n});r=t._$gridContent.ejScroller("isHScroll");t.model.isFromGantt&&(r?t._$gridContent.removeClass("e-borderbox"):t._$gridContent.addClass("e-borderbox"));t._$gridContent.ejScroller("option",{scrollTop:i});r?t._$gridContent.scrollTop(0):t._$gridContent.scrollTop(i)},refreshHeight:function(){var n=this;n._$gridContent.ejScroller("refresh")},_getViewPortHeight:function(){var n=this;return n.element.height()-n._$gridHeaderContent.height()-parseFloat(n._$gridHeaderContent.css("border-top-width"))-parseFloat(n._$gridHeaderContent.css("border-bottom-width"))},_updateScrollCss:function(){var n=this,t;n.model.isFromGantt||(t=n.isVScroll(),t?n._$gridHeaderContent.addClass("e-scrollcss"):n._$gridHeaderContent.removeClass("e-scrollcss"))},_updateCurrentViewData:function(){var n=this,i=n.model,r={},u,f=!1;i.enableVirtualization?(n.getVisibleRange(),i.currentViewData=n._updatedRecords.slice(n._visibleRange.top,n._visibleRange.bottom),n._vScrollDist!==0&&(u=n._scrollTop-n._offset,(n._prevRTop-n._visibleRange.top!=0||n._prevRBottom-n._visibleRange.bottom!=0)&&(r.requestType=t.TreeGrid.Actions.Refresh,n.sendDataRenderingRequest(r),f=!0),n._$tableContent.css({top:u}),n._prevRTop=n._visibleRange.top,n._prevRBottom=n._visibleRange.bottom)):i.currentViewData=n._updatedRecords;n._isEnterKeyPressed&&(n._isEnterKeyPressed=!1,i.allowSelection&&i.editSettings.allowEditing&&(f||(n._cellEditingDetails.rowIndex+=1),n._rowSelectingEventTrigger()||(n.selectRows(n._cellEditingDetails.rowIndex),n._rowSelectedEventTrigger(n._cellEditingDetails.rowIndex)),n.cellEdit(n._cellEditingDetails.rowIndex,n.model.columns[n._cellEditingDetails.columnIndex].field)))},_getRowPosition:function(n){return Math.ceil(n/this.model.rowHeight)},_getMetaColGroup:function(){return this.getHeaderTable().find("colgroup").clone()},_getEmptyTbody:function(){var i=this,r=t.buildTag("td",i.model.emptyRecordText,{},{colSpan:i.model.columns.length});return n(document.createElement("tr")).append(r)},_addSortElementToColumn:function(i,r){var u=this,e=t.TreeGrid.getColumnByField(u.model.columns,i),o=n.inArray(e,u.model.columns),f=u.getHeaderTable().find("thead").find(".e-headercell").eq(o).find(".e-headercelldiv");f.find(".e-ascending,.e-descending").remove();f.append(u._createSortElement().addClass("e-"+r).addClass("e-icon"));f.parent().attr("aria-sort",r)},_createSortElement:function(){return t.buildTag("span","&nbsp;")},_renderCellEditObject:function(i,r){var u=this,e=t.buildTag("form.#"+u._id+"EditForm","",{},{}),h=u._cellEditTemplate,f,o,s={};s[i.columnObject.field]=i.value;columnIndex=u.getColumnIndexByField(i.columnObject.field);columnIndex===u.model.treeColumnIndex?r.find(".e-cell").empty():r.empty();o=h.find("#"+i.columnObject.field+"_CellEdit").html();f=i.columnObject.field==="predecessor"?n(n.templates(o).render(i.data)):n(n.templates(o).render(s));f.get(0).tagName=="SELECT"&&(f.val(s[i.columnObject.field]),f.val()==null&&f.val(f.find("option").first().val()));e.append(f);columnIndex===u.model.treeColumnIndex?r.find(".e-cell").append(e):r.append(e);u._setoffsetWidth();u._refreshEditForm();n.isFunction(n.validator)&&!n.isEmptyObject(i.validationRules)&&(u._initValidator(),u.setValidationToField(i.columnObject.field,i.validationRules));u.model.isEdit=!0},_setoffsetWidth:function(){var u=this,i,f=n("#"+u._id+"EditForm"),t=0,e,r;for(i=u.model.editSettings.editMode=="cellEditing"?f.closest("td"):f.find("tr").find(".e-rowcell"),e=i.length,t;t<e;t++)r=n(i.children()[0]).children(),u._tdsOffsetWidth[t]=r.length>1?i.get(t).offsetWidth-r[0].offsetWidth-r[1].offsetWidth:i.get(t).offsetWidth},getIndexofresourceInfo:function(n){var u=this,f=u._cellEditingDetails.data,i=f.resourceInfo,t=0,e=i&&i.length,r=[];for(t;t<e;t++)r.push(n.indexOf(i[t]));return r},_refreshEditForm:function(){var s=this,d=document.getElementById(s._id+"EditForm"),w=!1,b=n(d).find("input,select"),k=86,c=0,g=b.length,r,o,f=s.model,h,u={},y,e,p,l,a,v;for(c;c<g;c++){if(r=b.eq(c),f.editSettings.editMode=="cellEditing"&&(k=95),o=s._tdsOffsetWidth[c]*(k/100),r.hasClass("e-numerictextbox"))h=o,y=r.val(),u.width=h,u.height="21px",u.showSpinButton=!0,u.cssClass=f.cssClass,y.length&&(u.value=parseFloat(y)),p=t.TreeGrid.getColumnByField(f.columns,r.prop("name")),t.isNullOrUndefined(p.editParams)||n.extend(u,p.editParams),r.ejNumericTextbox(u),r.prop("name",r.prop("name").replace(s._id,""));else if(r.hasClass("e-datepicker"))h=o,u.width=h,u.height="21px",u.cssClass=f.cssClass,u.displayDefaultDate=!0,u.dateFormat=f.dateFormat,r.val().length&&(u.value=new Date(r.val())),e=t.TreeGrid.getColumnByField(f.columns,r.prop("name")),e.format!==i&&e.format.length>0&&(l=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),a=l.exec(e.format),u.dateFormat=a[2]),t.isNullOrUndefined(e.editParams)||n.extend(u,e.editParams),r.ejDatePicker(u);else if(r.hasClass("e-datetimepicker"))h=o,u={width:h,height:"21px",cssClass:f.css,showButton:!1},r.val().length&&(u.value=new Date(r.val())),e=t.TreeGrid.getColumnByField(f.columns,r.prop("name")),e.format!==i&&e.format.length>0&&(l=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),a=l.exec(e.format),u.dateTimeFormat=a[2]),t.isNullOrUndefined(e.editParams)||n.extend(u,e.editParams),r.ejDateTimePicker(u);else if(r.hasClass("e-dropdownlist"))v=f.columns[s._cellEditingDetails.columnIndex].dropdownData,f.isFromGantt?r.ejDropDownList({width:o+"px",height:21,showCheckbox:!0,dataSource:v,popupWidth:"auto",fields:{id:f.resourceIdMapping,text:f.resourceNameMapping,value:f.resourceNameMapping},selectedItems:s.getIndexofresourceInfo(v)}):(r.css({position:"absolute","margin-top":"-13px"}),r.ejDropDownList({width:o+"px",height:"21px",dataSource:v})),r.ejDropDownList("setSelectedValue",r.val());else switch(r.prop("tagName")){case"INPUT":r.attr("type")!="checkbox"?(r.css("text-align",r.attr("name")!=null&&t.TreeGrid.getColumnByField(f.columns,r.attr("name"))!=null?t.TreeGrid.getColumnByField(f.columns,r.attr("name")).textAlign:"center"),r.outerWidth(o).height(19)):r.width(o>0?r.width()>o?o:r.width():1);break;case"SELECT":r.width(o).height(20)}r.is(":disabled")||w||r.is(":hidden")&&typeof r.data("ejDropDownList")!="object"||s._isEnterKeyPressed||(s._focusElements(r.closest("td")),w=!0)}},_initValidator:function(){var i=this;n("#"+i._id+"EditForm").validate({onclick:!1,onfocusout:!1,errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(r,u){var e=u.closest("td"),f=n(r).addClass("e-error"),o=t.buildTag("div.e-errortail e-toparrow");e.find(".e-error").remove();u.hasClass("e-numerictextbox")?f.insertAfter(u.closest(".e-numeric")):f.insertAfter(u);f.prepend(o);i.model.editSettings.editMode!="normal"&&f.offset({left:u.offset().left});f.fadeIn("slow")}})},_focusElements:function(n){var i=this,t;n.length&&(n.focus(),t=n.children(),t[0]&&(t[0].tagName.toLowerCase()=="select"||t[0].tagName.toLowerCase()=="input"?(t.focus().select(),t[0].focus()):t.find(".e-field.e-dropdownlist").length?t.find(".e-ddl").focus():t.find("input,select").select().focus()));i._$gridHeaderContainer.scrollLeft(i._$gridContent.children(".e-content").scrollLeft())},updateHeight:function(n){var t=this;t._$gridContainer&&t._$gridContent&&(n?(t._$gridContainer.css({height:n+"px",width:"auto"}),t._$gridContent.ejScroller("refresh")):t._$gridContainer.css({height:t._totalHeight+"px"}),t._$gridContent.hasClass("e-scroller")&&(t._$gridContent.ejScroller("refresh"),t._updateScrollCss()))},_addNestedExpandCollapseRecords:function(t,i,r,u){var f=this,l=f.model,h=l.flatRecords,a=l.records,c=0,y=t.length,e,v,s,o;for(c;c<y;c++)if(u++,f._tempRecordIndex++,e=a[f._tempRecordIndex],n.inArray(e,h)===-1&&h.splice(u,0,e),e&&e.isExpanded===!1&&(e.isExpanded=!0),e.hasChildRecords)if(e.expanded)for(v=e.childRecords.length,s=0,s;s<v;s++)u++,f._tempRecordIndex++,o=a[f._tempRecordIndex],h.splice(u,0,o),o.hasChildRecords&&(o.expanded?u=f._addNestedExpandCollapseRecords(o.childRecords,i+1,o,u):f._tempRecordIndex+=f.getChildCount(o,0));else f._tempRecordIndex+=f.getChildCount(e,0);return u},getChildCount:function(n,t){var r,u=this,i;if(!n.hasChildRecords)return 0;for(i=0;i<n.childRecords.length;i++)r=n.childRecords[i],t++,r.hasChildRecords&&(t=u.getChildCount(r,t));return t},_updateFilteredRecords:function(t){var i=this,u=0,f=t.length,r;for(i._filteredRecords=[],i._filteredGanttRecords=[],u;u<f;u++)r=t[u],r.parentItem!=null?(i._addParentRecord(r.parentItem),n.inArray(r,i._filteredRecords)===-1&&i.getExpandStatus(r)&&i._filteredRecords.push(r)):n.inArray(r,i._filteredRecords)===-1&&i.getExpandStatus(r)&&i._filteredRecords.push(r)},_addParentRecord:function(t){var i=this;t.parentItem?(i._addParentRecord(t.parentItem),n.inArray(t,i._filteredRecords)===-1&&i.getExpandStatus(t)&&i._filteredRecords.push(t)):n.inArray(t,i._filteredRecords)===-1&&i.getExpandStatus(t)&&i._filteredRecords.push(t)},_updateExpandCollapseForSortedRecords:function(n,t){var i=this,r=0,o=i._sortedRecords.length,u,f=i._sortedRecords.indexOf(n),e;if(t)i._addNestedSortRecords(n,f);else{for(e=0,r=f+1;r<o;r++)if(u=i._sortedRecords[r],u.level===n.level)break;else i.getExpandStatus(u)||e++;i._sortedRecords.splice(f+1,e)}},_addNestedSortRecords:function(i,r){var u=this,c,o=u.model.sortSettings.sortedColumns,s,e,l,h,f;if(o.length)for(s=o.length-1,u._queryManagar.queries=[],e=s;e>=0;e--)u._queryManagar.sortBy(o[e].field,o[e].direction);if(i.hasChildRecords)for(l=t.DataManager(i.childRecords),c=l.executeLocal(u._queryManagar).result,s=c.length,h=0;h<s;h++)f=c[h],u._filteredRecords.length?n.inArray(f,u._filteredRecords)!==-1&&u._sortedRecords.splice(++r,0,f):u._sortedRecords.splice(++r,0,f),f.hasChildRecords&&f.expanded&&u._addNestedSortRecords(f,r)},_updateAltRow:function(){for(var r=this,n=0,t=r._updatedRecords,u=t.length,i,n=0;n<u;n++)i=t[n],i.isAltRow=n%2==0?!0:!1},_getFilteredChildRecordsCount:function(n){for(var t=this,u=t.model,f=n&&n.childRecords&&n.childRecords.length,i=0,r,i=0;i<f;i++)r=n.childRecords[i],u.enableVirtualization?t.getExpandStatus(r)&&t._removedCount++:t._removedCount++,r.childRecords&&t._getFilteredChildRecordsCount(r);return t._removedCount},_sortingRecords:function(){var n=this,u=n.model,r=u.sortSettings.sortedColumns,f,i,e,o;if(n._queryManagar.queries=[],r.length)for(f=r.length-1,i=f;i>=0;i--)n._queryManagar.sortBy(r[i].field,r[i].direction);return e=new t.DataManager(u.parentRecords),o=e.executeLocal(n._queryManagar).result,n._sortedRecords=[],n._storedIndex=-1,n._createSortedRecords(o),n._tempsortedrecords=n._sortedRecords,n._updateSortedRecords(n._tempsortedrecords),n.setRecordsCount(n._sortedRecords.length),n._updatedRecords=n._sortedRecords,!0},_createSortedRecords:function(i){var r=this,u=r._sortedRecords,f,e=r.model.enableAltRow;n.each(i,function(n,i){if(r._searchString.length>0?r._filteredRecords.length>0&&r._filteredRecords.indexOf(i)!==-1&&(r._storedIndex++,e&&(i.isAltRow=r._storedIndex%2==0?!1:!0),u[r._storedIndex]=i):(r._storedIndex++,e&&(i.isAltRow=r._storedIndex%2==0?!1:!0),u[r._storedIndex]=i),i.hasChildRecords&&i.expanded){f=t.DataManager(i.childRecords);var o=f.executeLocal(r._queryManagar).result;r._createSortedRecords(o)}})},_updateSortedRecords:function(i){var u=this,f=0,s=i.length,r,h=this.model,e,o;for(f;f<s;f++)r=i[f],(u.getExpandStatus(r)||!h.enableVirualization)&&(u._filteredRecords.length>0?n.inArray(r,u._filteredRecords)!==-1&&n.inArray(r,u._sortedRecords)===-1&&u._sortedRecords.push(r):n.inArray(r,u._sortedRecords)===-1&&u._sortedRecords.push(r),r.hasChildRecords&&r.childRecords.length>0&&r.expanded&&(e=t.DataManager(r.childRecords),o=e.executeLocal(u._queryManagar).result,u._updateSortedRecords(o)))},_removeSortElementFromColumn:function(i){var r=this,f=t.TreeGrid.getColumnByField(r.model.columns,i),e=n.inArray(f,r.model.columns),u=r.getHeaderTable().find("thead").find(".e-headercell").eq(e).find(".e-headercelldiv");u.find(".ascending,.descending").remove();u.parent().removeAttr("aria-sort")},_addEmptyColumntoGrid:function(){n(".e-gridheadercontainer table colgroup").append(t.buildTag("col","",{width:"auto"},{}));n(".e-gridheadercontainer table thead tr").append(t.buildTag("th.e-headercell"))},_updateScrollTop:function(n){var i={},t=this,r;i.requestType="scroll";i.delta=n;r=t._$gridContent.ejScroller("isHScroll");r?t._$gridContent.scrollTop(0):t._$gridContent.scrollTop(n);t._$gridContent.ejScroller("scrollY",n,!0);t._completeAction(i)},_moveCurrentCell:function(n){var t=this,i=t._cellEditingDetails.rowIndex,u=t._cellEditingDetails.columnIndex,r=t.model;if(i==-1&&u==-1)return!0;t.model.isEdit&&(t.saveCell(),t.model.isEdit=!1);switch(n){case"right":if(!t._rowSelectingEventTrigger()&&!t.selectRows(t._cellEditingDetails.rowIndex)){if(i==t._gridRows.length-1&&u==r.columns.length-1)return!0;u==r.columns.length-1?(t._cellEditingDetails.columnIndex=0,t._cellEditingDetails.rowIndex=i+1):t._cellEditingDetails.columnIndex=u+1;t.cellEdit(t._cellEditingDetails.rowIndex,r.columns[t._cellEditingDetails.columnIndex].field)}break;case"left":if(i==0&&u==0)return!0;u==0?(t._cellEditingDetails.columnIndex=r.columns.length-1,t._cellEditingDetails.rowIndex=i-1):t._cellEditingDetails.columnIndex=u-1;t.selectRows(t._cellEditingDetails.rowIndex);t.cellEdit(t._cellEditingDetails.rowIndex,r.columns[t._cellEditingDetails.columnIndex].field);break;case"up":if(i==0)return!0;t._cellEditingDetails.rowIndex=i-1;t.selectRows(t._cellEditingDetails.rowIndex);t._rowSelectedEventTrigger(t._cellEditingDetails.rowIndex);t.cellEdit(t._cellEditingDetails.rowIndex,r.columns[t._cellEditingDetails.columnIndex].field);break;case"down":i+1==t.getRows().length-1&&t.model.enableVirtualization&&(t._isEnterKeyPressed=!0,t._updateScrollTop(t._$gridContent.scrollTop()+r.rowHeight-t._offset));t._isEnterKeyPressed||t._updatedRecords.length>i+1&&(t.selectRows(i+1)||(t._rowSelectedEventTrigger(t._cellEditingDetails.rowIndex+1),t._cellEditingDetails.rowIndex=i+1,t.cellEdit(t._cellEditingDetails.rowIndex,r.columns[t._cellEditingDetails.columnIndex].field),args={},args.requestType="scroll",args.delta=t._$gridContent.children(".e-content").scrollTop(),t._trigger("actionComplete",args)))}return!1},_findColumnsWidth:function(){for(var t=this,i=t.model.columns.length,r=t.getHeaderTable().find("colgroup").find("col"),n=0;n<i;n++)t._columnsWidthCollection[n]=r.eq(n).width()},_calculateWidth:function(){for(var t=this.getHeaderTable().find("colgroup").find("col"),i=0,n=0;n<t.length;n++)i+=t.eq(n).width();return i},_compiledDropDownTemplate:function(){var i=t.buildTag("select"),r=t.buildTag("option","{{:text}}",{},{value:"{{:value}}"});return i.append(r),n.templates(i.html())},_renderScroller:function(){var i=this,r=i.model,u=r.flatRecords.length*r.rowHeight,f=i._viewPortHeight<0?u:i._viewPortHeight,e,o,s;i._$gridContent.css({height:f+"px"});i._$gridContainer.css({height:u+"px"});i._$gridContent.hasClass("e-scroller")?i._$gridContent.ejScroller("refresh"):($div=t.buildTag("div",{},{width:"auto",height:"auto"}),$div.append(i._$gridContainer),i._$gridContent.append($div),e=i._gridHeight?f:"auto",o=i.element.width()-2,i._$gridContent.ejScroller({height:i.model.isFromGantt?0:e,width:o,scroll:n.proxy(i._onScroll,i)}));i._updateScrollCss();s=i._$gridContent.ejScroller("isHScroll");i.model.isFromGantt&&(s?i._$gridContent.removeClass("borderbox"):i._$gridContent.addClass("borderbox"))},_destroy:function(){var n=this;n.element.empty().removeClass("e-treegrid-core e-treegrid "+n.model.cssClass)}});t.TreeGrid.Actions={Sorting:"sorting",BeginEdit:"beginedit",Save:"save",Add:"add",Delete:"delete",Cancel:"cancel",Refresh:"refresh",Searching:"searching",ExpandCollapse:"expandcollapse",Selection:"selection",rowHover:"rowHover",Scroll:"scroll",ContextMenuAdd:"contextMenuAdd"};t.TreeGrid.SelectionType={Single:"single",Multiple:"multiple"};t.TreeGrid.EditMode={Normal:"normal",CellEditing:"cellEditing"};t.TreeGrid.EditingType={String:"stringedit",Boolean:"booleanedit",Numeric:"numericedit",Dropdown:"dropdownedit",DatePicker:"datepicker"};t.TreeGrid=t.TreeGrid||{};t.TreeGrid._initCellEditType=function(i,r,u,f){var s=i,h=s.model,e=h.columns,o=e[f],c,l,a,v,y,p,w;t.isNullOrUndefined(e[f].editType)&&(o.editType="stringedit");switch(o.editType){case"stringedit":h.isFromGantt?(c={},c["_"+u+"cellValue"]=t.TreeGrid._getCellValue,o.field==="predecessor"&&(c["_"+u+"predecessorCell"]=t.Gantt._getPredecessorsValue),n.views.helpers(c),l=o.field==="predecessor"?t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+u+"predecessorCell('"+h.predecessorMapping+"')}}",id:u+o.field,name:o.field}):t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+s._id+"cellValue('"+e[f].field+"')}}",id:s._id+h.columns[f].field,name:h.columns[f].field})):l=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:#data['"+o.field+"']}}",id:u+o.field,name:o.field});r.html(l);break;case"booleanedit":r.html("{{if "+e[f].field+'}} <input class="e-field e-checkbox" type ="checkbox" id='+s._id+e[f].field+"name="+e[f].field+'checked="checked"><\/input>{{else}} <input class="e-field e-checkbox" type ="checkbox" id='+s._id+e[f].field+"name="+e[f].field+" > {{/if}}");break;case"numericedit":a=t.buildTag("input.e-numerictextbox e-field","",{},{type:"text",value:"{{:#data['"+e[f].field+"']}}",id:s._id+e[f].field,name:e[f].field});r.append(a);break;case"datepicker":case"datetimepicker":v=t.buildTag("input.e-"+e[f].editType+" e-field","",{},{type:"text",value:"{{:#data['"+e[f].field+"']}}",id:u+e[f].field,name:e[f].field});r.append(v);break;case"dropdownedit":h.isFromGantt?(y=t.buildTag("input.e-field e-dropdownlist e-field","",{},{type:"text",value:"{{:#data['"+e[f].field+"']}}",id:u+e[f].field,name:e[f].field}),r.append(y)):t.isNullOrUndefined(o.dropdownData)||(p=o.dropdownData,w=s._compiledDropDownTemplate(),r.get(0).innerHTML=["<select>",w.render(p),"<\/select>"].join(""),r.find("select").prop({id:s._id+o.field,name:o.field}).addClass("e-field e-dropdownlist"))}};t.TreeGrid._getCellValue=function(n){var t=this.data[n];return t?t:this.data.item&&this.data.item[n]};t.TreeGrid._getrowClassName=function(){var n="gridrowIndex",t=this;return t.data.parentItem&&(n+=t.data.parentItem.index.toString()),n+="level",n+t.data.level.toString()};t.TreeGrid.getColumnByField=function(n,t){var i=0;for(i;i<n.length;i++)if(n[i].field==t)break;return i==n.length?null:n[i]};t.TreeGrid.sendExpandCollapseRequest=function(i,r){var u=i,o=u.model;if(r.requestType=t.TreeGrid.Actions.ExpandCollapse,o.enableVirtualization)u._isFromGantt?u._$treegridHelper.ejTreeGrid("processBindings",r):u.processBindings(r),r.expanded?u._trigger("expanded",r):u._trigger("collapsed",r),u._isFromGantt?(u._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",r),u._updatedGanttRecords=u.getUpdatedRecords(),u._currentViewData=u.getCurrentViewData(),u.model.enableVirtualization&&(u.model.predecessorMapping&&(u._isValidationEnabled=!1,u._connectorlineIds=[],u._connectorLinesCollection=[],u._$ganttchartHelper.ejGanttChart("clearConnectorLines"),u._createConnectorLinesCollection()),u._$ganttchartHelper.ejGanttChart("refreshHelper",u._currentViewData,u._updatedGanttRecords),u._$treegridHelper.ejTreeGrid("refreshHeight"))):(u.sendDataRenderingRequest(r),u._$gridContent.ejScroller("refresh"));else{var f=r.data,s,e,h=0,c=f.expanded!==r.expanded;s=u._isFromGantt?u._currentViewData.indexOf(f):u.model.currentViewData.indexOf(f);e=n(u.getRows()[s]);r.expanded?(f.expanded=r.expanded,u._expandedRecordsCount=0,t.TreeGrid.expandRecord(u,f,r.expanded,r),c&&(u._totalCollapseRecordCount-=u._expandedRecordsCount),e.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),e.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand"),o.enableAltRow&&t.TreeGrid.updateAltRow(u,f,s,1)):(u._collapsedRecordCount=0,t.TreeGrid.collapseRecord(u,f,r.expanded),c&&(u._totalCollapseRecordCount+=u._collapsedRecordCount),f.expanded=r.expanded,e.find(".e-treegridexpand").removeClass("e-treegridexpand").addClass("e-treegridcollapse"),e.removeClass("e-treegridrowexpand").addClass("e-treegridrowcollapse"),o.enableAltRow&&t.TreeGrid.updateAltRow(u,f,s,u._collapsedRecordCount+1));h=(u.getUpdatedRecords().length-u._totalCollapseRecordCount)*o.rowHeight;u._isFromGantt?(u._$treegridHelper.ejTreeGrid("updateHeight",h),u._$ganttchart.ejGanttChart("updateHeight",h)):u.updateHeight(h);r.expanded?u._trigger("expanded",r):u._trigger("collapsed",r)}};t.TreeGrid.expandRecord=function(i,r,u,f){var e=i,a=".gridrowIndex"+r.index.toString()+"level"+(r.level+1).toString(),v=n(a),h=0,l=v.length,y,c,b=e.model,s=n(a),o,p=e.getRows(),w=n(p[o]);for(o=e._isFromGantt?e._currentViewData.indexOf(r):b.currentViewData.indexOf(r),r.hasChildRecords&&r.childRecords.length>0&&(w.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),w.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand")),e._expandedRecordsCount+=e._isFromGantt?s.length/2:s.length,s.length===0&&e.model.allowSearching&&e._seacrhString&&e._seacrhString.length>0&&f&&e._$treegridHelper.ejTreeGrid("sendExpandCollapseRequest",f),s.css({display:"table-row"}),e._isFromGantt&&(l=l/2),h;h<l;h++)y=v[h],o=p.index(y),o!==-1&&(c=e._isFromGantt?e._updatedGanttRecords[o]:e._updatedRecords[o],c.isExpanded=!0,c.expanded&&t.TreeGrid.expandRecord(e,c,u));e._isFromGantt&&e.updateConnectorLines(s,u)};t.TreeGrid.collapseRecord=function(i,r,u){var f=i,p=f.model,l=".gridrowIndex"+r.index.toString()+"level"+(r.level+1).toString(),a=n(l),e=0,s=a.length,v,h,c,o=n(l),w=f.getRows(),y;for(f._collapsedRecordCount+=f._isFromGantt?o.length/2:o.length,o.css({display:"none"}),f._isFromGantt&&(f.updateConnectorLines(o,u),s=s/2),e;e<s;e++)v=a[e],y=f.getRows(),h=f.getRows().index(v),h!==-1&&(c=f.getUpdatedRecords()[h],c.expanded&&t.TreeGrid.collapseRecord(f,c,u))};t.TreeGrid.updateAltRow=function(t,i,r,u){for(var e=t,f=0,l=e.model,c=e._isFromGantt?e._currentViewData:l.currentViewData,a=c.length,o=i.isAltRow,s,h=e.getRows(),f=r+u;f<a;f++)n(h[f]).css("display")!=="none"&&(s=c[f],s.isAltRow=!o,o=s.isAltRow,o?n(h[f]).addClass("e-alt-row"):n(h[f]).removeClass("e-alt-row"))};jQuery.uaMatch=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}}})(jQuery,Syncfusion),function(n,t){t.Grid=t.Grid||{};t.Grid.gridResize=function(t){this.$headerTable=t.getHeaderTable();this.gridInstance=t;this._colMinWidth=15;this._$visualElement=n();this._currentCell=-1;this._allowStart=!1;this._oldWidth=null;this._orgX=null;this._orgY=null;this._extra=null;this._expand=!1};t.Grid.gridResize.prototype={_mouseHover:function(t){var r,o;if(!this._$visualElement.is(":visible")&&(n(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),r=n(t.target),r.hasClass("e-headercell"))){var e=t.target,u=e.getBoundingClientRect(),i=0,f=0;(t.type="mousemove")?(i=t.clientX,f=t.clientY):(t.type="touchmove")?(i=evt.originalEvent.changedTouches[0].clientX,f=evt.originalEvent.changedTouches[0].clientY):(t.type="MSPointerMove")&&(i=t.originalEvent.clientX,f=t.originalEvent.clientY);o=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderContent().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left:this.gridInstance.getHeaderTable().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left;(i>=u.left+document.documentElement.scrollLeft+e.offsetWidth-5||i<=u.left+3)&&i<o&&i>=u.left&&f<=u.top+document.documentElement.scrollTop+t.target.offsetHeight?(r.parent().css("cursor","col-resize"),this._currentCell=this.gridInstance.getHeaderContent().find(".e-headercell").index(e),this._allowStart=!0):(r.parent().css("cursor","pointer"),this._allowStart=!1,this._currentCell=-1)}},_start:function(t,i){var e=this.gridInstance.getHeaderTable().find(".e-columnheader"),u=e.find(".e-headercell"),r,f;(this._currentCell!=-1&&this._currentCell<u.length&&(r=u[this._currentCell]),typeof r!="undefined")&&(f=r.getBoundingClientRect(),this._tableY=f.top+parseInt(navigator.userAgent.indexOf("WebKit")!=-1?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart?(this._$visualElement=n(document.createElement("div")),_height=this.gridInstance.element.find(".e-gridcontent").first().height()+this.gridInstance.element.find(".e-gridheader").height(),this._$visualElement.addClass("e-reSizeColbg").appendTo(this.gridInstance.element).css({height:_height+"px",cursor:"col-resize"}),this._$visualElement.css({left:t,top:this._tableY}),this._oldWidth=r.offsetWidth,this._orgX=t,this._orgY=i,this._extra=t-this._orgX,this._expand=!0):this._currentCell=-1)},_mouseMove:function(n){if(this._expand){var t=0,i=0;(n.type="mousemove")?(t=n.clientX,i=n.clientY):(n.type="touchmove")?(t=evt.originalEvent.changedTouches[0].clientX,i=evt.originalEvent.changedTouches[0].clientY):(n.type="MSPointerMove")&&(t=n.originalEvent.clientX,i=n.originalEvent.clientY);navigator.userAgent.indexOf("WebKit")!=-1&&(t=n.pageX,i=n.pageY);t+=document.documentElement.scrollLeft;n.preventDefault();this._moveVisual(t)}else this._mouseHover(n)},_reSize:function(n){var c=this,i,r,f,o,t;if(this._initialTableWidth=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderTable().first().parent().width()+this.gridInstance.getHeaderTable().last().parent().width():this.gridInstance.getHeaderTable().parent().width(),this.gridInstance.model.enableRTL||this._getResizableCell(),r=this.gridInstance.getHeaderTable().find(".e-columnheader"),this._currentCell!=-1&&this._expand){this._expand=!1;var s=r.find(".e-headercell").filter(":visible"),h=s[this._currentCell],e=h.offsetWidth,u=n-this._orgX;parseInt(u)+parseInt(e)>this._colMinWidth&&(u!=0&&r.css("cursor","default"),this._resizeColumnUsingDiff(e,u),i=this.gridInstance.element.find(".e-gridcontent").first(),this.gridInstance.model.allowScrolling&&i.ejScroller("refresh"),f=this.gridInstance.getBrowserDetails(),f.browser=="msie"&&(o=this.gridInstance.getContentTable().width(),t=this.gridInstance._calculateWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns>0?(this.gridInstance.getHeaderTable().last().width(t-this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width()),this.gridInstance.getContentTable().last().width(t-this.gridInstance.getContent().find(".e-frozencontentdiv").width()),this.gridInstance.model.showSummary&&this.gridInstance.getFooterTable().last().width(t-this.gridInstance.getFooterContent().find(".e-frozenfootertdiv").width())):(this.gridInstance.getHeaderTable().width(t),this.gridInstance.model.showSummary&&this.gridInstance.getFooterTable().width(t)),parseInt(f.version,10)>8&&this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length&&(t>o?(this.gridInstance.getContentTable().width(t),this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",2e3/i.find("table").first().width()+"%")):(this.gridInstance.getContentTable().css("width","100%"),this.gridInstance._groupingAction(),this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",(this.gridInstance.getHeaderTable().find("colgroup").find("col").first().width()/i.find("table").first().width()*100).toFixed(2)+"%"))),this.gridInstance.getHeaderTable().parent().scrollLeft(i.find(".e-content").scrollLeft()-1)))}this._$visualElement.remove();this._expand=!1;this._currentCell=-1;this._allowStart=!1},_getFrozenResizeWidth:function(){for(var t=this.gridInstance.getHeaderTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumn:0),i=0,n=0;n<t.length;n++)t.eq(n).css("display")!="none"&&(i+=parseInt(t[n].style.width.replace("px","")));return i},_diaplayFinder:function(){return n(this).css("display")!="none"},_resizeColumnUsingDiff:function(t,i){var p=this,r=parseInt(i)+parseInt(t),a,v,o,u,s,f,h;if(r>0&&i!=0){r<this._colMinWidth&&(r=this._colMinWidth);var i=r-t,c=this.gridInstance.getHeaderTable().find("colgroup").find("col"),y=c.filter(this._diaplayFinder).eq(this._currentCell),e,l,w=c.slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumns:0);if(this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){if(this._currentCell>=0&&this._currentCell<this.gridInstance.model.scrollSettings.frozenColumns&&this._getFrozenResizeWidth()+i>this.gridInstance.element.find(".e-headercontent").first().width())return;e=this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder).eq(this._currentCell)}else e=this.gridInstance.getContentTable().find("colgroup").first().find("col").filter(this._diaplayFinder).eq(this._currentCell);if(this.gridInstance.model.showSummary&&(l=this.gridInstance.getFooterTable().find("colgroup").find("col").filter(this._diaplayFinder).eq(this._currentCell),l.outerWidth(r)),y.outerWidth(r),this.gridInstance.model.isEdit&&(a=this.gridInstance.getContentTable().find(".e-editedrow,.e-addedrow").find("table").find("colgroup"),n(a[0].children[this._currentCell-this.gridInstance.model.groupSettings?this.gridInstance.model.groupSettings.groupedColumns.length:0]).width(r)),this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length)for(v=this.gridInstance.getContentTable().find(".e-recordtable"),o=v.find("colgroup"),u=0;u<o.length;u++)n(o[u].children[this._currentCell-this.gridInstance.model.groupSettings.groupedColumns.length]).width(r);if(e.width(r),this.gridInstance._findColumnsWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){for(s=this.gridInstance.getContentTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings.frozenColumns),f=0,u=0;u<s.length;u++)f+=parseInt(s[u].style.width.replace("px",""));this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(f);h=this.gridInstance.model.enableRTL?"margin-right":"margin-left";this.gridInstance.getContent().find(".e-frozencontentdiv").width(f).next().css(h,f+"px");this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(f).next().css(h,f+"px");this.gridInstance.model.showSummary&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(f)}this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor","default")}},_mouseUp:function(n){if(this._expand){var t=n.clientX,i=n.clientY;navigator.userAgent.indexOf("WebKit")!=-1&&(t=n.pageX,i=n.pageY);t+=document.documentElement.scrollLeft;this._reSize(t,i)}},_getResizableCell:function(){for(var i,r=this.gridInstance.getHeaderTable().find(".e-columnheader"),t=r.find(".e-headercell").not(".e-hide"),u=navigator.userAgent.indexOf("WebKit")!=-1?document.body.scrollLeft:document.documentElement.scrollLeft,n=0;n<t.length;n++)if(point=t[n].getBoundingClientRect(),i=point.left+u+5,i>this._orgX){this._currentCell=n-1;return}},_moveVisual:function(n){var t=this.gridInstance.getHeaderContent().find("div").first()[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<n||n<t.left+document.documentElement.scrollLeft?this._$visualElement.remove():this._currentCell!=-1&&this._$visualElement.css({left:n,top:this._tableY})},_mouseDown:function(t){if(this._allowStart&&n(t.target).closest("tr").css("cursor")=="col-resize"){var i=t.clientX,r=t.clientY;navigator.userAgent.indexOf("WebKit")!=-1&&(i=t.pageX,r=t.pageY);i+=document.documentElement.scrollLeft;t.button!=2&&this._start(i,r);t.preventDefault()}return!1}}}(jQuery,Syncfusion)