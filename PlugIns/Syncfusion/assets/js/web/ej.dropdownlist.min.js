/*!
*  filename: ej.dropdownlist.min.js
*  version : 13.2.0.34
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.scroller.min","./ej.checkbox.min"],n):n()})(function(){(function(n,t){t.widget("ejDropDownList","ej.DropDownList",{element:null,model:null,validTags:["select","input"],_ignoreOnPersist:["fields","dataSource","query","create","popupHide","popupShown","beforePopupShown","beforePopupHide","change","select","checkChange","destroy"],_setFirst:!1,_rootCSS:"e-dropdownlist",defaults:{cssClass:"",value:"",htmlAttributes:{},text:"",itemValue:"",itemsCount:0,dataSource:null,delimiterChar:",",query:null,fields:{id:"id",text:"text",value:"value",category:"category",imageUrl:"imageUrl",imageAttributes:"imageAttributes",spriteCssClass:"spriteCssClass",htmlAttributes:"htmlAttributes",selected:"selected",tableName:"tableName"},watermarkText:null,height:"",width:"",popupHeight:"152px",popupWidth:"auto",targetID:null,template:null,selectedItemIndex:null,disableItemsByIndex:null,enableItemsByIndex:null,selectedItems:[],cascadeTo:null,showRoundedCorner:!1,showPopupOnLoad:!1,enableRTL:!1,enabled:!0,caseSensitiveSearch:!1,showCheckbox:!1,checkAll:!1,uncheckAll:!1,enablePersistence:!1,enableIncrementalSearch:!1,readOnly:!1,enableAnimation:!1,allowMultiSelection:!1,multiSelectMode:"none",allowGrouping:!1,enableSorting:!1,validationRules:null,validationMessage:null,create:null,popupHide:null,popupShown:null,beforePopupShown:null,beforePopupHide:null,change:null,select:null,checkChange:null,destroy:null},dataTypes:{cssClass:"string",itemsCount:"number",watermarkText:"string",template:"string",selectedItemIndex:"number",disableItemsByIndex:"string",enableItemsByIndex:"string",cascadeTo:"string",delimiterChar:"string",showRoundedCorner:"boolean",showPopupOnLoad:"boolean",enableRTL:"boolean",enablePersistence:"boolean",enabled:"boolean",readOnly:"boolean",allowMultiSelection:"boolean",multiSelectMode:"enum",dataSource:"data",query:"data",fields:"data",selectedItems:"array",enableAnimation:"boolean",allowGrouping:"boolean",enableSorting:"boolean",validationRules:"data",validationMessage:"data",htmlAttributes:"data"},observables:["value"],value:t.util.valueFunction("value"),enable:function(){this.element.hasClass("e-disable")&&(this.target.disabled=!1,this.model.enabled=!0,this.element.removeClass("e-disable"),this.dropdownbutton.removeClass("e-disable"),this.container.bind("mousedown",n.proxy(this._OnDropdownClick,this)),(this.model.allowMultiSelection||this.model.multiSelectMode=="visualmode")&&this._ulBox.removeClass("e-disable"))},disable:function(){this.element.hasClass("e-disable")||(this.target.disabled=!0,this.model.enabled=!1,this.element.addClass("e-disable"),this.dropdownbutton.addClass("e-disable"),(this.model.allowMultiSelection||this.model.multiSelectMode=="visualmode")&&this._ulBox.addClass("e-disable"),this.container.unbind("mousedown",n.proxy(this._OnDropdownClick,this)))},getValue:function(){return this.target.value},_setValue:function(n){var i,r,t;if(n)if(this.model.showCheckbox){for(i=this.model.text.split(this.model.delimiterChar),t=0;t<i.length;t++)this.unselectItemByText(i[t]);for(r=n.split(this.model.delimiterChar),t=0;t<r.length;t++)this.setSelectedValue(r[t])}else this.setSelectedValue(n)},_setText:function(n){var i,r,t;if(n)if(this.model.showCheckbox||this.model.multiSelectMode!="none"){for(i=this.model.text.split(this.model.delimiterChar),t=0;t<i.length;t++)this.unselectItemByText(i[t]);for(r=n.split(this.model.delimiterChar),t=0;t<r.length;t++)this.setSelectedText(r[t])}else this.setSelectedText(n)},_setItemValue:function(n){this.model.itemValue=n},_changeWatermark:function(n){if(!this.model.enabled)return!1;this._isWatermark?this.element.attr("placeholder",n):this._hiddenSpan.text(n)},hidePopup:function(){if(!this.model.enabled)return!1;this.ultag.find("li").length>0&&this._hideResult()},showPopup:function(){if(!this.model.enabled)return!1;this.ultag.find("li").length>0&&this._showResult()},clearText:function(){var t,n;if(this.model.showCheckbox)for(t=this.model.text.split(this.model.delimiterChar),n=0;n<t.length;n++)this.unselectItemByText(t[n]);else this.element.val(""),this._hiddenInput.val(""),this.value(""),this.model.text="",this.ultag.children("li").removeClass("e-active");this._isWatermark||this._setWatermark()},selectItemByIndex:function(n){this._selectItemByIndex(n)},_selectItemByIndex:function(n){if(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),n!=null&&n>=0)for(var t=0;t<this.listitems.length;t++)t==n&&(this.selectedIndexValue=t,this._activeItem=n,this.model.template?this._templateValue():this._enterTextBoxValue());else this.model.showCheckbox||this.model.multiSelectMode!="none"?this.unselectItemByIndex(this._activeItem):this._clearTextboxValue()},unselectItemByIndex:function(n){var t;for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),t=0;t<this.listitems.length;t++)t==n&&(this.selectedIndexValue=t,this._activeItem=n,this._activeItem==this._aselectedItem&&(this._aselectedItem=null),this._removeTextBoxValue())},addItem:function(i){var r,u,e,f;if(!this.model.enabled)return!1;r=document.createElement("LI");n(r).attr({role:"option",unselectable:"on"});typeof i.image!="undefined"&&(u=document.createElement("img"),u.src=typeof i.image.src!="undefined"?i.image.src:"",u.width=typeof i.image.width!="undefined"?parseInt(i.image.width):"50",u.height=typeof i.image.height!="undefined"?parseInt(i.image.height):"50",u.alt=typeof i.image.alt!="undefined"?i.image.alt:"",typeof i.image.style!="undefined"&&n(u).attr("style",i.image.style),n(r).append(u));typeof i.value!="undefined"&&(e=document.createTextNode(i.value),n(r).append(e));typeof i.htmlAttributes!="undefined"&&(f=i.htmlAttributes.replace(/['"]/g,"").split("="),n(r).attr(f[0],f[1]));this.ultag.append(r);this.model.showCheckbox&&($checkbox=t.buildTag("input.listcheckbox e-align#popuplist"+this.popupListItems.length+"_"+this._id,"",{},{type:"checkbox",name:"list"+this.popupListItems.length,"data-role":"none"}),n(r).prepend($checkbox),this.popupList.find(".listcheckbox").ejCheckBox({cssClass:this.model.cssClass,change:n.proxy(this._OnClickCheckList,this)}),this.popupList.find("span.e-chkbox-wrap,div.e-chkbox-small,span.e-chk-inact,span.e-chk-image").attr("unselectable","on"),this.popupListItems.length++);this._isPopupShown()&&(this.hidePopup(),this.showPopup())},setSelectedValue:function(i){var r;if(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),t.isNullOrUndefined(i)||i==="")this._clearTextboxValue();else for(r=0;r<this.listitems.length;r++)if((this._getAttributeValue(this.listitems[r])||n(this.listitems[r]).text())&&(this._selectedValue=this._getAttributeValue(this.listitems[r])||n(this.listitems[r]).text(),this._selectedValue==i))return this._activeItem=r,this._aselectedItem=this._activeItem,this._enterTextBoxValue(),!1},unselectItemByValue:function(n){var t;for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),t=0;t<this.listitems.length;t++)if(this._getAttributeValue(this.listitems[t])&&(this._selectedValue=this._getAttributeValue(this.listitems[t]),this._selectedValue==n))return this._activeItem=t,this._activeItem==this._aselectedItem&&(this._aselectedItem=null),this._removeTextBoxValue(),!1},setSelectedText:function(i){var r;if(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),t.isNullOrUndefined(i)||i==="")this._clearTextboxValue();else for(r=0;r<this.listitems.length;r++)if(this.selectedTextValue=this.model.template?this._getField(this.popupListItems[r],this.mapFld._text):n(this.listitems[r]).text(),this.selectedTextValue==i)return this._activeItem=r,this._aselectedItem=this._activeItem,this._enterTextBoxValue(),!1},unselectItemByText:function(t){var i;for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),i=0;i<this.listitems.length;i++)if(this.unselectedTextValue=this.model.template?this._getField(this.popupListItems[i],this.mapFld._text):n(this.listitems[i]).text(),this.unselectedTextValue==t)return this._activeItem=i,this._activeItem==this._aselectedItem&&(this._aselectedItem=null),this._removeTextBoxValue(),!1},getSelectedItem:function(){return this.element.val()},getSelectedValue:function(){return this._hiddenInput.val()},disableItemByIndex:function(t){var i,r,u;if(!this.model.enabled)return!1;for(i=t.split(","),r=0;r<i.length;r++)i[r]!=null&&i.length>0&&!(n.inArray(i[r],this._disabledItems)>-1)&&(index=n.inArray(i[r],this._disabledItems),u=n(this.ultag.children("li")[parseInt(i[r])]).addClass("e-disable"),u.find(".listcheckbox").ejCheckBox("disable"),this._disabledItems.push(i[r]),this.model.disableItemsByIndex=String(this._disabledItems.join(",")))},enableItemByIndex:function(t){var r=t.split(","),u,i,f;for(this.model.enableItemsByIndex=t,i=0;i<r.length;i++)r.length>0&&n.inArray(r[i],this._disabledItems)>-1&&(u=n.inArray(r[i],this._disabledItems),f=n(this.ultag.children("li")[parseInt(r[i])]).removeClass("e-disable"),f.find(".listcheckbox").ejCheckBox("enable"),this._disabledItems.splice(u,1));this.model.enableItemsByIndex=null},_validateDelimiter:function(n){if(n.length==1)if(!/^[a-zA-Z0-9]+$/.test(n))return n;return","},getSelectedItemsID:function(){return this._selectedItemsID},_removeText:function(n){var t,i,u,r;t=this.element[0].value;i=this._hiddenInput[0].value;u=t.indexOf(n+this.model.delimiterChar);r=t.indexOf(n);u>=0?(t=t.replace(n+this.model.delimiterChar,""),i=i.replace(this._hiddenValue+this.model.delimiterChar,"")):t.length==r+n.length&&r==0?(t=t.replace(n,""),i=i.replace(this._hiddenValue,"")):(t=t.replace(this.model.delimiterChar+n,""),i=i.replace(this.model.delimiterChar+this._hiddenValue,""));this.element[0].value=t;this._hiddenInput[0].value=i},_addText:function(n){this._delimiterIndex=this.element[0].value.lastIndexOf(this.model.delimiterChar);this._hiddenDelimiterIndex=this._hiddenInput[0].value.lastIndexOf(this.model.delimiterChar);(this._delimiterIndex==-1||this._delimiterIndex!=this.element[0].value.length-1)&&this.element[0].value!=""&&(this.element.val(this.element[0].value+this.model.delimiterChar),this._hiddenInput.val(this._hiddenInput[0].value+this.model.delimiterChar),this._delimiterIndex=this.element[0].value.lastIndexOf(this.model.delimiterChar),this._hiddenDelimiterIndex=this._hiddenInput[0].value.lastIndexOf(this.model.delimiterChar));this._checkContains(n)||(this.element.val(this.element[0].value.substr(0,this._delimiterIndex+1)+n),this._hiddenInput.val(this._hiddenInput[0].value.substr(0,this._hiddenDelimiterIndex+1)+this._hiddenValue))},_checkContains:function(n){var r=n,i=this.element[0].value.split(this.model.delimiterChar),t;for(this.contains=!1,t=0;t<i.length;t++)i[t]==r&&(this.contains=!0);return this.contains},_init:function(){(this.element.is("input")&&(this.element.is("input[type=text]")||!this.element.attr("type"))||this.element.is("select"))&&(this._isWatermark="placeholder"in document.createElement("input"),this._id=this.element[0].id,this._initialize(),this._render(),this._addAttr(this.model.htmlAttributes),this._enabled(this.model.enabled),this._wireEvents(),this._initValue=!1,this._checkboxValue=!1,this.model.validationRules!=null&&(this._initValidator(),this._setValidation()))},_initValidator:function(){var t=this;this.element.closest("form").validate({ignore:".e-hidden",errorClass:"e-validation-error",errorElement:"span",errorPlacement:function(t,i){n(t).insertAfter(i.closest(".e-widget"))}})},_setValidation:function(){var u,i,r,f;if(this.element.closest("form").length!=0){this._hiddenInput.rules("add",this.model.validationRules);u=this.element.closest("form").validate();name=this._hiddenInput.attr("name");u.settings.messages[name]={};for(i in this.model.validationRules)if(r=null,!t.isNullOrUndefined(this.model.validationRules[i])){if(t.isNullOrUndefined(this.model.validationRules.messages&&this.model.validationRules.messages[i])){u.settings.messages[name][i]=n.validator.messages[i];for(f in this.model.validationMessage)i==f?r=this.model.validationMessage[i]:""}else r=this.model.validationRules.messages[i];u.settings.messages[name][i]=r!=null?r:n.validator.messages[i]}}},_setInitialPopup:function(n){n==!1?this._hideResult():this._showResult()},_changeSkin:function(n){this.model.cssClass!=n&&(this.wrapper.removeClass(this.model.cssClass).addClass(n),this.popupList.removeClass(this.model.cssClass).addClass(n))},_setRTL:function(n){this.model.enableRTL!=n&&(this.model.enableRTL=n,this._RightToLeft(),this._dropbtnRTL())},_changeHeight:function(n){this.wrapper.height(n);this._setListHeight()},_changeWidth:function(n){this.wrapper.width(n);this._setListWidth()},_setModel:function(n){var i,f,r,u;for(i in n)switch(i){case"dataSource":this._isEqualDataSource(n[i])||this._checkModelDataBinding(n[i]);break;case"query":this._queryCheck(n[i]);break;case"fields":this.model.fields=n[i];this._checkModelDataBinding(this.model.dataSource);break;case"itemsCount":this.model.itemsCount=n[i];this._setListHeight();break;case"template":this.model.template=n[i];this._checkModelDataBinding(this.model.dataSource);break;case"value":t.isNullOrUndefined(n[i])||n[i]===""?this._clearTextboxValue():(this._setValue(t.util.getVal(n[i])),n[i]=this.model.value);break;case"delimiterChar":f=this.model.delimiterChar;n[i]=this._validateDelimiter(n[i]);this.model.delimiterChar=n[i];this.element.val(this.model.text.replace(new RegExp(f,"g"),this.model.delimiterChar));this.model.text=this.element.val();break;case"text":t.isNullOrUndefined(n[i])||n[i]===""?this._clearTextboxValue():(this._setText(n[i]),n[i]=this.model.text);break;case"itemValue":this._setItemValue(n[i]);break;case"enableRTL":this._setRTL(n[i]);break;case"enabled":this._enabled(n[i]);break;case"height":this._changeHeight(n[i]);break;case"width":this._changeWidth(n[i]);break;case"popupHeight":this.model.popupHeight=n[i];this._setListHeight(n[i]);break;case"popupWidth":this.model.popupWidth=n[i];this._setListWidth();break;case"cssClass":this._changeSkin(n[i]);break;case"showCheckbox":this.model.showCheckbox=n[i];r=this.model.text;u=this.model.text.split(this.model.delimiterChar);this._clearTextboxValue();this._checkboxHideShow(n[i]);this.model.showCheckbox||this.model.multiSelectMode!="none"?((this.model.multiSelectMode=="visualmode"||this.model.allowMultiSelection)&&this._renderBoxModel(),this._setText(r)):this._setText(u[0]);this._isPopupShown()&&this._setListPosition();break;case"checkAll":this._setCheckAll(n[i]);break;case"uncheckAll":this._setUncheckAll(n[i]);break;case"watermarkText":this._changeWatermark(n[i]);break;case"validationRules":this.element.closest("form").length!=0&&(this.model.validationRules!=null&&(this._hiddenInput.rules("remove"),this.model.validationMessage=null),this.model.validationRules=n[i],this._setValidation());break;case"validationMessage":this.element.closest("form").length!=0&&(this.model.validationMessage=n[i],this._setValidation());break;case"showRoundedCorner":this._roundedCorner(n[i]);this.model.showRoundedCorner=n[i];break;case"showPopupOnLoad":this._setInitialPopup(n[i]);break;case"targetID":this.model.targetID=n[i];this._showFullList();break;case"selectedItemIndex":this._selectItemByIndex(n[i]);break;case"unselectItemByIndex":this.unselectItemByIndex(n[i]);break;case"disableItemsByIndex":this.disableItemByIndex(n[i]);break;case"enableItemsByIndex":this.enableItemByIndex(n[i]);break;case"selectedItems":this._selectCheckedItem(n[i]);n[i]=this.model.selectedItems;break;case"allowMultiSelection":this.model.allowMultiSelection=n[i];this.model.showCheckbox&&(n[i]?(this._renderBoxModel(),this._setText(this.model.text)):this._destroyBoxModel(),this._isPopupShown()&&this._setListPosition());break;case"multiSelectMode":this.model.multiSelectMode=n[i];r=this.model.text;u=this.model.text.split(this.model.delimiterChar);this._clearTextboxValue();this.model.showCheckbox||this.model.multiSelectMode!="none"?(this.model.multiSelectMode=="visualmode"&&this._renderBoxModel(),this._setText(r)):this._setText(u[0]);this._isPopupShown()&&this._setListPosition();break;case"allowGrouping":this.model.allowGrouping=n[i];this._setGrouping();break;case"htmlAttributes":this._addAttr(n[i])}},_clearTextboxValue:function(){this.element.val("");this._hiddenInput.val("");this.value("");this.model.text=this.selectedTextValue=this._selectedValue=this._hiddenValue="";this.selectedIndexValue=this._hiddenDelimiterIndex=this._activeItem=-1;this._selectedItemsID=[];this.model.selectedItems=[];this.model.selectedItemIndex=null;this.ultag.children("li").removeClass("e-hover").removeClass("e-active");this.model.showCheckbox&&this.ultag.children("li").find(".listcheckbox").ejCheckBox({checked:!1});this.wrapper.find("ul.e-ul.e-boxes").length!=0&&this._destroyBoxModel();this.showCheckbox||this.model.multiSelectMode!="none"||this.model.allowMultiSelection||(n("input:hidden[id^='#'][name="+this._id+"]").remove(),n(this._hiddenInput).attr("name",this._id))},_destroy:function(){this._destroyDropdown();this.element.removeClass("e-input "+this.model.cssClass);this.element.attr({accesskey:this.wrapper.attr("accesskey"),name:this._hiddenInput.attr("name")});this._isWatermark&&this.element.removeAttr("placeholder");this.element[0].value="";this.model.dataSource!=null?this.popupPanelWrapper.remove():(this.docbdy.append(this.ultag.html()),this.popupPanelWrapper.remove())},_finalize:function(){this.model.selectedItemIndex!=null?this._selectItemByIndex(this.model.selectedItemIndex):this.model.selectedItems.length>0&&this._selectCheckedItem(this.model.selectedItems);this.model.disableItemsByIndex!=null&&this.disableItemByIndex(this.model.disableItemsByIndex);this.model.enableItemsByIndex!=null&&this.enableItemByIndex(this.model.enableItemsByIndex)},_initialize:function(){this.element.is("select")&&(this.selectelement=!0,this._renderSelectToDropdown());this._selectedItemsID=[];this.target=this.element[0];this._disabledItems=[];this._queryString=null;this.suggLen=0;this._itemId=null;this.checkedStatus=!1;this._incqueryString="";this._activeItem=null;this.ddWidth=0;this._initValue=!0},_renderSelectToDropdown:function(){var i,r;for(this.inputElement=t.buildTag("input.e-dropdownlist#"+this._id+"_input","",{},{type:"text","data-role":"none"}),this.inputElement.insertAfter(this.element),this.optionDiv=t.buildTag("div#"+this._id+"_list"),this.optionDiv.insertAfter(this.inputElement),this.optionUl=t.buildTag("ul"),this.optionDiv.append(this.optionUl),this.element.attr("name")&&(this.inputElement.attr("name",this.element.attr("name")),this.element.removeAttr("name")),this.selectOptions=this.element,this.selectOptions.attr("id",this._id),this.selectOptionItems=this.element.children("option"),r=this.selectOptionItems.length,this.optionDummyUl=n(),i=0;i<r;i++)this.selectOptionItems[i].text!=null&&(this.optionLi=t.buildTag("li",this.selectOptionItems[i].innerHTML,{},{"data-value":this.selectOptionItems[i].value,unselectable:"on"}),this.optionDummyUl.push(this.optionLi[0]),n(this.selectOptionItems[i]).attr("selected")&&(this.model.showCheckbox?n.inArray(i,this.model.selectedItems)==-1&&this.model.selectedItems.push(i):t.isNullOrUndefined(this.model.selectedItemIndex)&&(this.model.selectedItemIndex=i)));this.optionUl.append(this.optionDummyUl);this.element.css("display","none");this.element=this.inputElement},_render:function(){this._renderDropdown();this._setWatermark();this._renderPopupPanelWrapper();this._initDataSource(this.model.dataSource);this._showFullList();this.model.text&&this.setSelectedText(this.model.text);this.value()==""&&this.element[0].value!==""&&this.value(this.element[0].value);this._setValue(this.value());this._roundedCorner(this.model.showRoundedCorner);t.DataManager&&this.model.dataSource instanceof t.DataManager||this._finalize();this._setCheckAll(this.model.checkAll)},_queryCheck:function(n){this.model.query=n;this._checkModelDataBinding(this.model.dataSource)},_isEqualDataSource:function(n){var i,t,r;if(!this.model.dataSource||!n)return!1;if(this.model.dataSource.length===n.length){for(i=!0,t=0,r=this.model.dataSource.length;t<r;t++)if(this.model.dataSource[t]!==n[t]){i=!1;break}return i}return!1},_checkModelDataBinding:function(n){this.element.val("");this._hiddenInput.val("");this.value("");this.model.text=this.selectedTextValue=this._selectedValue=this._hiddenValue="";this.selectedIndexValue=this._hiddenDelimiterIndex=this._activeItem=-1;this._selectedItemsID=[];this.model.selectedItems=[];(this.model.allowMultiSelection||this.model.multiSelectMode=="visualmode")&&this._destroyBoxModel();this.model.dataSource=n;n!=null?t.DataManager&&n instanceof t.DataManager?this._initDataSource(n):this._showFullList():this.ultag.empty()},_initDataSource:function(n){var i=this,r;t.DataManager&&n instanceof t.DataManager&&(i.popupListItems=i.model.dataSource,i._addLoadingClass(),r=n.executeQuery(this._getQuery()),r.done(function(n){i.popupListItems=n.result;i._removeLoadingClass();i._showFullList();i._finalize()}).fail(function(){i.model.dataSource=null;i._addLoadingClass()}))},_getQuery:function(){var r;if(t.isNullOrUndefined(this.model.query)){var u=[],i=t.Query(),n=this.model.fields;for(r in n)r!=="tableName"&&n[r]&&u.push(n[r]);u.length>0&&i.select(u);this.model.dataSource.dataSource.url.match(n.tableName+"$")||t.isNullOrUndefined(n.tableName)||i.from(n.tableName)}else i=this.model.query;return i},_addLoadingClass:function(){this.dropdownbutton.addClass("e-load");this.drpbtnspan.removeClass("e-icon e-down-arrow");this.model.readOnly=!0},_removeLoadingClass:function(){this.dropdownbutton.removeClass("e-load");this.drpbtnspan.addClass("e-icon e-down-arrow");this.model.readOnly=!1},_renderDropdown:function(){this.element.addClass("e-input "+this.model.cssClass);this.wrapper=t.buildTag("span.e-ddl e-widget "+this.model.cssClass+"#"+this._id+"_wrapper","",{},{tabindex:"0",accesskey:this.element.attr("accesskey")});this.container=t.buildTag("span.e-in-wrap e-box "+this.model.cssClass+"#"+this._id+"_container");this.element.removeAttr("accesskey");this.element.attr({readonly:!0,tabindex:-1,role:"combobox","aria-expanded":!1,"aria-autocomplete":"list","aria-haspopup":!0,"aria-owns":this._id+"_popup"});this.drpbtnspan=t.buildTag("span.e-icon e-down-arrow","",{},{"aria-label":"select",unselectable:"on"});this.dropdownbutton=t.buildTag("span.e-select#"+this._id+"_dropdown","",{},{role:"button",unselectable:"on"}).append(this.drpbtnspan);this.container.insertAfter(this.element);this.container.append(this.element);this.container.append(this.dropdownbutton);this.wrapper.insertBefore(this.container);this.wrapper.append(this.container);this.selectelement&&this.selectOptions.insertBefore(this.element);this._hiddenInput=t.buildTag("input#"+this._id+"_hidden","",{},{type:"hidden"}).insertBefore(this.element);this._isWatermark||(this._hiddenSpan=t.buildTag("span.e-input e-placeholder ").insertAfter(this.element),this._hiddenSpan.text(this.model.watermarkText),this._hiddenSpan.css("display","none"),this._hiddenSpan.bind("mousedown",n.proxy(this._OnDropdownClick,this)));this._checkNameAttr();this._setDimentions();this._RightToLeft();this.ddWidth=this.dropdownbutton.outerWidth()>0?this.dropdownbutton.outerWidth():24;this.container.bind("mousedown",n.proxy(this._OnDropdownClick,this))},_checkNameAttr:function(){this.element.attr("name")?(this._hiddenInput.attr("name",this.element.attr("name")),this.element.removeAttr("name")):this._hiddenInput.attr("name",this._id)},_addAttr:function(t){var i=this;n.map(t,function(n,t){t=="class"?i.wrapper.addClass(n):t=="required"?i.element.attr(t,n):t=="disabled"&&n=="disabled"?i.disable():t=="readOnly"&&n=="readOnly"?i.model.readOnly=!0:i.wrapper.attr(t,n)})},_renderBoxModel:function(){if(!this.model.allowMultiSelection&&this.model.multiSelectMode!="visualmode")return!1;this._ulBox=t.buildTag("ul.e-ul e-boxes");this.container.prepend(this._ulBox);this._ulBox.css("min-height","30px");this._ulBox.css("display","none");this._on(this.container,"click",function(t){if(!this.model.enabled)return!1;var i=n(t.target);i.hasClass("e-options")&&(!t.ctrlKey&&i.siblings().hasClass("e-active")&&this._removeActive(),i.hasClass("e-active")?i.removeClass("e-active"):i.addClass("e-active"));!t.ctrlKey&&i.hasClass("e-boxes")&&this._removeActive()})},_renderPopupPanelWrapper:function(){var i=n("#"+this.element.context.id+"_popup_wrapper").get(0);i&&n(i).remove();this.popupPanelWrapper=t.buildTag("div#"+this._id+"_popup_wrapper");n("body").append(this.popupPanelWrapper);this.popupList=t.buildTag("div.e-ddl-popup e-box e-popup e-widget "+this.model.cssClass+"#"+this._id+"_popup","",{visibility:"hidden"},{tabIndex:0});this.popup=this.popupList;this.popupScroller=t.buildTag("div");this.ultag=t.buildTag("ul.e-ul","",{},{role:"listbox"});this.popupScroller.append(this.ultag);this.popupList.append(this.popupScroller);this.popupPanelWrapper.append(this.popupList)},_setGrouping:function(){var t=this.model.text,n;if(this._destroy(),this.value(""),this.model.selectedItems=[],this._init(),this.model.showCheckbox)for(n=t.split(this.model.delimiterChar),i=0;i<n.length;i++)this.setSelectedText(n[i]);else this.setSelectedText(t)},_setSortingList:function(){var t=document.createElement("ul");if(n(t).append(this.docbdy.children("ol,ul").children()),this.model.allowGrouping)for(i=0;i<n(t).find("span").length;i++)sortitems=n(t).find("span").eq(0).first().nextUntil("span").get(),this._setSortList(t,sortitems);else n(t).children("span").remove(),sortitems=n(t).children("li").get(),this._setSortList(t,sortitems);this.docbdy.children("ol,ul").append(n(t).children())},_setSortList:function(t,i){i.sort(function(t,i){var r=n(t).text().toUpperCase(),u=n(i).text().toUpperCase();return r<u?-1:r>u?1:0});this.model.allowGrouping&&n(t).append(n(t).find("span").eq(0));n.each(i,function(i,r){n(t).append(r)})},_renderPopupList:function(){var u=this.popupListItems,r,e,s,i=this.model.fields,h,c,l,f,o;if(this.ultag.empty(),this.dummyUl=n(),this.model.enableRTL&&this.popupList.addClass("e-rtl"),this.model.dataSource==null||this.model.dataSource.length<1){if(h=this.element.parents().last(),this.model.targetID)this.docbdy=h.find("#"+this.model.targetID);else if(this.optionDiv)this.docbdy=this.optionDiv;else return!1;this.model.enableSorting&&this._setSortingList();this.itemsContainer=this.docbdy.children("ol,ul");this.itemsContainer.children("ol,ul").remove();this.popupListItems=this.items=this.itemsContainer.children("li");this.items.children("img").addClass("e-align");this.items.children("div").addClass("e-align");this.itemsContainer.children("span").addClass("e-ghead");this.ultag.append(this.itemsContainer.children());this.itemsContainer.empty();this.docbdy.css({display:"none"});this.itemsContainer.css({display:"none"})}else if(this.model.dataSource!=null&&typeof u[0]!="object"){if(this.model.enableSorting&&u.sort(),u.length>0){for(r=0;r<u.length;r++)s=t.buildTag("li",u[r],{},{"data-value":u[r],unselectable:"on"}),this.dummyUl.push(s[0]);this.ultag.append(this.dummyUl)}}else{if(this.mapFld={_id:null,_imageUrl:null,_imageAttributes:null,_spriteCSS:null,_text:null,_value:null,_htmlAttributes:null,_selected:null},this.mapFld._id=i&&i.id?i.id:"id",this.mapFld._imageUrl=i&&i.imageUrl?i.imageUrl:"imageUrl",this.mapFld._imageAttributes=i&&i.imageAttributes?i.imageAttributes:"imageAttributes",this.mapFld._spriteCSS=i&&i.spriteCssClass?i.spriteCssClass:"spriteCssClass",this.mapFld._text=i&&i.text?i.text:"text",this.mapFld._value=i&&i.value?i.value:"value",this.mapFld._htmlAttributes=i&&i.htmlAttributes?i.htmlAttributes:"htmlAttributes",this.mapFld._selected=i&&i.selected?i.selected:"selected",this.model.enableSorting&&(c=t.Query().sortBy(this.mapFld._text,null,!0),u=t.DataManager(u).executeLocal(c)),this.model.allowGrouping){for(this.popupList.addClass("e-atc-popup"),l=i&&i.category?i.category:"category",o=t.Query().group(l),this.model.enableSorting||o.queries.splice(0,1),f=t.DataManager(u).executeLocal(o),this._swapUnCategorized(f),this.popupListItems=[],r=0;r<f.length;r++)for(f[r].key&&this.dummyUl.push(t.buildTag("li.e-category",f[r].key).attr("role","option")[0]),this._generateLi(f[r].items,this.mapFld),e=0;e<f[r].items.length;e++)this.popupListItems.push(f[r].items[e]);this.model.dataSource=this.popupListItems}else this._generateLi(u,this.mapFld);this.ultag.append(this.dummyUl)}this.ultag.children("li").attr({role:"option",unselectable:"on"});this._setListWidth();this._setListHeight();this._setListPosition();this.popupList.css("height","");this.popupScroller.css({height:"",width:""});this.popupList.ejScroller({height:this.popupList.height(),width:0,scrollerSize:20});this.scrollerObj=this.popupList.ejScroller("instance");this.popupList.find("div.e-scrollbar div").attr("unselectable","on");this.popupList.css({display:"none",visibility:"visible"});this.model.showCheckbox&&this._checkboxHideShow(this.model.showCheckbox);this._renderBoxModel();this._setUncheckAll(this.model.uncheckAll);this.model.showPopupOnLoad&&this._showResult()},_generateLi:function(n,r){var u,a;if(this.mapFld=r,n.length>0)if(this.model.template!=null){for(i=0;i<n.length;i++){var f=this._getField(n[i],this.mapFld._value),e=this._getField(n[i],this.mapFld._htmlAttributes),o=this._getField(n[i],this.mapFld._id);u=!t.isNullOrUndefined(f)&&f.toString().length>0?t.buildTag("li","",{},{"data-value":f}):t.buildTag("li");e&&e!=""&&u.attr(e);o&&u.attr("id",o);this.model.template&&u.append(this._getTemplatedString(n[i]));this.dummyUl.push(u[0])}this.ultag.append(this.dummyUl)}else for(i=0;i<n.length;i++){var o=this._getField(n[i],this.mapFld._id),h=this._getField(n[i],this.mapFld._imageUrl),c=this._getField(n[i],this.mapFld._imageAttributes),l=this._getField(n[i],this.mapFld._spriteCSS),s=this._getField(n[i],this.mapFld._text),f=this._getField(n[i],this.mapFld._value),e=this._getField(n[i],this.mapFld._htmlAttributes),v=this._getField(n[i],this.mapFld._selected);u=!t.isNullOrUndefined(f)&&f.toString().length>0?t.buildTag("li","",{},{"data-value":f}):t.buildTag("li");o&&u.attr("id",o);h&&h!=""&&(imgtag=t.buildTag("img.e-align","",{},{src:h,alt:s}),c&&c!=""&&imgtag.attr(c),u.append(imgtag));l&&l!=""&&(divtag=t.buildTag("div.e-align "+l+" sprite-image"),u.append(divtag));s&&s!=""&&u.append(s);e&&e!=""&&(a=e.replace(/['"]/g,"").split("="),u.attr(a[0],a[1]));v&&u.addClass("chkselect");this.dummyUl.push(u[0])}},_swapUnCategorized:function(t){n(t).each(function(n,i){if(!i.key){for(var r=n;r>0;r--)t[r]=t[r-1];return t[r]=i,!1}})},_getField:function(n,i){return t.pvt.getObject(i,n)},_getTemplatedString:function(n){for(var t=this.model.template,i=t.indexOf("${"),r=t.indexOf("}"),u,f;i!=-1&&r!=-1;)u=t.substring(i,r+1),f=u.replace("${","").replace("}",""),t=t.replace(u,this._getField(n,f)),i=t.indexOf("${"),r=t.indexOf("}");return t},_setWatermark:function(){this.model.watermarkText!=null&&this.element.val()==""&&n.trim(this._hiddenInput.val())==""&&(this._isWatermark?this.element.attr("placeholder",this.model.watermarkText):this._hiddenSpan.css("display","block").text(this.model.watermarkText),(this.model.allowMultiSelection||this.model.multiSelectMode=="visualmode")&&this._ulBox&&this._ulBox.find("li").length==0&&this._swapUlandInput(!1))},_checkboxHideShow:function(n){n?this._createCheckbox():this._removeCheckbox();this.model.showCheckbox=n},_createCheckbox:function(){var i,r,u=this;if(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),r=this.listitems.find("input[type=checkbox]"),r.length==0){for(i=0;i<this.listitems.length;i++)$checkbox=t.buildTag("input.listcheckbox e-align#popuplist"+i+"_"+this._id,"",{},{type:"checkbox",name:"list"+i,"data-role":"none"}),n(this.listitems[i]).prepend($checkbox);for(this.popupList.find(".listcheckbox").ejCheckBox({cssClass:this.model.cssClass,change:n.proxy(this._OnClickCheckList,this)}),this.popupList.find("span.e-chkbox-wrap,div.e-chkbox-small,span.e-chk-inact,span.e-chk-image").attr("unselectable","on"),this.element.val(""),this._setWatermark(),i=0;i<this.listitems.length;i++)n(this.listitems[i]).hasClass("chkselect")&&(n(this.listitems[i]).find(".listcheckbox").ejCheckBox({checked:!0}),this._activeItem=i,this.checkedStatus=!0,this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model}),this._enterTextBoxValue(),n(this.listitems[i]).removeClass("chkselect"))}},_removeCheckbox:function(){var n;this.listitems=this.popupList.find("ol,ul").children("li");n=this.listitems.find(".listcheckbox");n.length>0&&(this.listitems.find(".listcheckbox").ejCheckBox("destroy"),this.listitems.find("input[type=checkbox]").remove())},_setCheckAll:function(n){(this.model.showCheckbox||!this.model.showCheckbox&&this.model.multiSelectMode!="none")&&n&&this.checkAll()},_setUncheckAll:function(n){(this.model.showCheckbox||!this.model.showCheckbox&&this.model.multiSelectMode!="none")&&n&&this.unCheckAll()},checkAll:function(){var r=this.model.selectedItems;for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),this._isWatermark||this._hiddenSpan.css("display","none"),i=0;i<this.listitems.length;i++)(n(this.listitems[i].firstChild).hasClass("e-disable")||n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("isChecked")!=!1)&&(this.model.showCheckbox||this.model.multiSelectMode=="none"||n(this.listitems[i]).hasClass("e-active"))||(n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this.currentValue=this.model.template?this._getField(this.popupListItems[i],this.mapFld._text):n.trim(n(this.listitems[i]).text()),this._itemID=n(this.listitems[i]).attr("id"),t.isNullOrUndefined(this._itemID)||this._itemID==""||this._selectedItemsID.push(this._itemID),this._hiddenValue=this._getAttributeValue(this.listitems[i])||this.currentValue,this.checkedStatus=!0,this._createListHidden(this._hiddenValue,i),(this.model.allowMultiSelection||this.model.multiSelectMode=="visualmode")&&(this._ulBox.append(this._createBox(this.currentValue)),this._isPopupShown()&&this._setListPosition()),this.model.showCheckbox||this.model.multiSelectMode=="none"||n(this.listitems[i]).addClass("e-active"),this._delimiterIndex=this.element[0].value.lastIndexOf(this.model.delimiterChar),this._hiddenDelimiterIndex=this._hiddenInput[0].value.lastIndexOf(this.model.delimiterChar),this._delimiterIndex>=-1&&this.element[0].value!=""&&this._delimiterIndex!=this.element[0].value.length-1?(this.element.val(this.element[0].value+this.model.delimiterChar),this._hiddenInput.val(this._hiddenInput[0].value+this.model.delimiterChar),this._delimiterIndex=this.element[0].value.lastIndexOf(this.model.delimiterChar),this._hiddenDelimiterIndex=this._hiddenInput[0].value.lastIndexOf(this.model.delimiterChar),this.element.val(this.element[0].value.substr(0,this._delimiterIndex+1)+this.currentValue),this._hiddenInput.val(this._hiddenInput[0].value.substr(0,this._hiddenDelimiterIndex+1)+this._hiddenValue)):(this.element.val(this.element[0].value.substr(0,this._delimiterIndex+1)+this.currentValue+this.model.delimiterChar),this._hiddenInput.val(this._hiddenInput[0].value.substr(0,this._hiddenDelimiterIndex+1)+this._hiddenValue+this.model.delimiterChar)),r=this.model.selectedItems,n.inArray(i,r)==-1&&this.model.selectedItems.push(i),this._selectedValue=this._getAttributeValue(this.listitems[i])||"",this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model}),args={text:this.element[0].value,selectedText:this.currentValue,itemId:i,value:this._selectedValue,isChecked:this.checkedStatus},this._initValue||this._trigger("change",args),this._cascadeAction());this.value(this._hiddenInput.val());this.model.text=this.element.val();this.model.itemValue=this._selectedValue;this._setWatermark()},_createListHidden:function(t,i){var r=document.createElement("input");r.setAttribute("type","hidden");r.setAttribute("name",this._id);r.setAttribute("value",t);r.setAttribute("id","#"+t+i);n("#"+this._id+"_container").append(r);n(this._hiddenInput).attr("name","hiddenEle")},_removeListHidden:function(t,i){var r=document.getElementById("#"+t+i);n(r).remove()},_getAttributeValue:function(n){return n.getAttribute("data-value")||n.getAttribute("value")},_selectSingleItem:function(t){this.currentValue=n.trim(n(this.listitems[t]).text());this._hiddenValue=this._getAttributeValue(this.listitems[t])||this.currentValue;this._addText(this.currentValue);this._selectedValue=this._getAttributeValue(this.listitems[t])||"";this.value(this._hiddenInput.val());this.model.itemValue=this._selectedValue;this.model.text=this.element.val();this.model.showCheckbox||n(this.listitems[t]).addClass("e-active")},_selectCheckedItem:function(t){if(t.length>0){for(this._isWatermark||this._hiddenSpan.css("display","none"),this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),i=0;i<t.length;i++)n(this.listitems[t[i]].firstChild).find(".listcheckbox").ejCheckBox("isChecked")!=!1&&(this.model.showCheckbox||this.model.multiSelectMode=="none"||n(this.listitems[t[i]]).hasClass("e-active"))||(n(this.listitems[t[i]].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this.checkedStatus=!0,this._selectSingleItem(t[i]),(this.model.allowMultiSelection||this.model.multiSelectMode=="visualmode")&&this._ulBox.append(this._createBox(this.currentValue)),this._createListHidden(this._hiddenValue,t[i]),n.inArray(t[i],this.model.selectedItems)==-1&&this.model.selectedItems.push(t[i]),this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model}),args={text:this.element[0].value,selectedText:this.currentValue,itemId:this.selectedIndexValue,value:this._selectedValue,isChecked:this.checkedStatus},this._initValue||this._trigger("change",args));this.model.showCheckbox||this.model.multiSelectMode!="none"||n(this.listitems[t[i]]).hasClass("e-active")||(this._selectSingleItem(t[0]),this.model.selectedItems[0]=t[0],args={text:this.element[0].value,selectedText:this.currentValue,itemId:this.selectedIndexValue,value:this._selectedValue},this._initValue||this._trigger("change",args));this._cascadeAction();this._setWatermark()}},unCheckAll:function(){for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),i=0;i<this.listitems.length;i++){(n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("isChecked")||!this.model.showCheckbox&&this.model.multiSelectMode!="none"&&n(this.listitems[i]).hasClass("e-active"))&&(n(this.listitems[i]).removeClass("e-active"),n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!1),this.currentValue=this.model.template?this._getField(this.popupListItems[i],this.mapFld._text):n.trim(n(this.listitems[i]).text()),this._hiddenValue=this._getAttributeValue(this.listitems[i])||this.currentValue,(this.model.allowMultiSelection||this.model.multiSelectMode=="visualmode")&&(this._deleteBoxCheck(this.currentValue),this._isPopupShown()&&this._setListPosition()),this.model.showCheckbox||this.model.multiSelectMode=="none"||n(this.listitems[i]).removeClass("e-active"),this._txtpos=this.element[0].value.lastIndexOf(this.currentValue),this._delimiterIndex=this.element[0].value.lastIndexOf(this.model.delimiterChar),this._txtpos==0&&this._delimiterIndex<=-1?(this.element.val(this.element[0].value.replace(this.currentValue,"")),this._hiddenInput.val(this._hiddenInput[0].value.replace(this._hiddenValue,""))):this._txtpos==0&&this._delimiterIndex>-1||this._txtpos>-1&&this._delimiterIndex>this._txtpos?this.element[0].value==this.currentValue||this.element[0].value.length==this._txtpos+this.currentValue.length?(this.element.val(this.element[0].value.replace(this.currentValue,"")),this._hiddenInput.val(this._hiddenInput[0].value.replace(this._hiddenValue,""))):(this.element.val(this.element[0].value.replace(this.currentValue+this.model.delimiterChar,"")),this._hiddenInput.val(this._hiddenInput[0].value.replace(this._hiddenValue+this.model.delimiterChar,""))):this._txtpos>-1&&this._delimiterIndex<this._txtpos?(this.element.val(this.element[0].value.replace(this.model.delimiterChar+this.currentValue,"")),this._hiddenInput.val(this._hiddenInput[0].value.replace(this.model.delimiterChar+this._hiddenValue,""))):this._txtpos>-1&&this._delimiterIndex<this._txtpos&&(this.element.val(this.element[0].value.replace(this.currentValue,"")),this._hiddenInput.val(this._hiddenInput[0].value.replace(this._hiddenValue,""))),this._removeListHidden(this._hiddenValue,i));this.checkedStatus=!1;var r=this.model.selectedItems;n.inArray(i,r)>-1&&this.model.selectedItems.splice(n.inArray(i,r),1);this._selectedValue=this._getAttributeValue(this.listitems[i])||"";this._itemID=n(this.listitems[i]).attr("id");t.isNullOrUndefined(this._itemID)||this._itemID==""||this._removeSelectedItemsID();this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model});args={text:this.element[0].value,selectedText:this.currentValue,itemId:i,value:this._selectedValue,isChecked:this.checkedStatus};this._initValue||this._trigger("change",args);this._cascadeAction()}this.value(this._hiddenInput.val());this.model.text=this.element.val();this.model.itemValue=this._selectedValue;this._setWatermark()},_removeSelectedItemsID:function(){var n;n=this._selectedItemsID.indexOf(this._itemID);this._selectedItemsID.splice(n,1);this._itemID=""},_refreshScroller:function(){this.popupList.css("height","auto");this.popupList.find(".e-content, .e-vhandle").removeAttr("style");this.popupList.find(".e-vhandle div").removeAttr("style");this.popupList.children(".e-content").removeClass("e-content");this.popupList.css({display:"block"});this.scrollerObj.model.height=this.popupList.outerHeight();this.scrollerObj.refresh();this.scrollerObj.option("scrollTop",0);this.popupList.css({height:"auto"});this.popupList.css({display:"none"})},_setListWidth:function(){var n=this.model.popupWidth;n!="auto"?this.popupList.css({width:n}):this.popupList.css({"min-width":this.wrapper.width()})},_setListHeight:function(){this.model.itemsCount>0?this.popupList.css({"max-height":this.model.itemsCount*30}):this.popupList.css({"max-height":this.model.popupHeight})},_refreshPopup:function(){this.model.popupWidth=="auto"&&this.popupList.css({"min-width":this.wrapper.width()});this._refreshScroller();this._setListPosition()},_setListPosition:function(){var t=this.wrapper,i=this._getOffset(t),f,h=n(document).scrollTop()+n(window).height()-(i.top+n(t).outerHeight()),c=i.top-n(document).scrollTop(),u=this.popupList.outerHeight(),e=this.popupList.outerWidth(),r=i.left,o=t.outerHeight(),l=(o-t.height())/2,a=this._getZindexPartial(),s=3,v=(u<h||u>c?i.top+o+s:i.top-u-s)-l;f=n(document).scrollLeft()+n(window).width()-r;(this.model.enableRTL||e>f&&e<r+t.outerWidth())&&(r-=this.popupList.outerWidth()-t.outerWidth());this.popupList.css({left:r+"px",top:v+"px","z-index":a})},_getOffset:function(n){return t.util.getOffset(n)},_getZindexPartial:function(){return t.util.getZindexPartial(this.element,this.popupList)},_showResult:function(){var i=this,r;this._trigger("beforePopupShown",{text:this.element[0].value,value:this._selectedValue})||(this._refreshPopup(),this.popupList.css("display","none"),n(this.popupList).slideDown(this.model.enableAnimation?200:1,"easeOutQuad",function(){n(document).bind("mousedown",n.proxy(i._OnDocumentClick,i));i._on(t.getScrollableParents(i.wrapper),"scroll",i._hideResult)}),this.element.attr({"aria-expanded":!0}),r=this.ultag.children("li:not('.e-category')"),this._listSize=r.size(),r.bind("mouseenter",n.proxy(this._OnMouseEnter,this)),r.bind("mouseleave",n.proxy(this._OnMouseLeave,this)),r.bind("click",n.proxy(this._OnMouseClick,this)),n(window).bind("resize",n.proxy(this._OnWindowResize,this)),this._trigger("popupShown",{text:this.element[0].value,value:this._selectedValue}))},_OnWindowResize:function(){t.isNullOrUndefined(this.model)||(this._refreshPopup(),this.popupList.css("display","block"))},_hideResult:function(){var r,i;if(this.model&&this._isPopupShown()){if(this._trigger("beforePopupHide",{text:this.element[0].value,value:this._selectedValue}))return;r=this;this.popupList.css("display","none");n(this.popupList).slideUp(this.model.enableAnimation?100:0,"easeOutQuad",function(){n(document).unbind("mousedown",n.proxy(r._OnDocumentClick,r))});this.element!=null&&this.element.attr({"aria-expanded":!1});i=this.ultag.children("li:not('.e-category')");n(window).unbind("resize",n.proxy(this._OnWindowResize,this));i.unbind("mouseenter",n.proxy(this._OnMouseEnter,this));i.unbind("mouseleave",n.proxy(this._OnMouseLeave,this));i.unbind("click",n.proxy(this._OnMouseClick,this));this._off(t.getScrollableParents(this.wrapper),"scroll",this._hideResult);this.element!=null&&this._trigger("popupHide",{text:this.element[0].value,value:this._selectedValue})}},_isPopupShown:function(){return this.popupList.css("display")=="block"?!0:!1},_enterTextBoxValue:function(){var t,i,r;this.removeID=!1;this._isWatermark||this._hiddenSpan.css("display","none");this._chooseSelectionType();t={text:this.currentValue,selectedText:this.currentValue,itemId:this.selectedIndexValue,value:this._selectedValue,isChecked:this.checkedStatus};this._initValue||this._trigger("select",t);!this.selectedIndexValue!=this._activeItem&&(this.model.multiSelectMode!="none"||this.model.showCheckbox?this._checkContains(this.currentValue)?(this._removeTextBoxValue(),this._removeListHidden(this._hiddenValue,this.selectedIndexValue),this.model.selectedItems!=null&&(r=this.model.selectedItems.indexOf(this.selectedIndexValue),this.model.selectedItems.splice(r,1))):(this.model.showCheckbox&&this.activeItem.find(".listcheckbox").ejCheckBox("isChecked")==!1&&(this.activeItem.find(".listcheckbox").ejCheckBox("option","checked",!0),this.checkedStatus=!0),(this.model.multiSelectMode=="visualmode"||this.model.allowMultiSelection)&&(this._ulBox.append(this._createBox(this.currentValue)),this._isPopupShown()&&this._setListPosition()),this.model.showCheckbox||this.activeItem.addClass("e-active"),this._maintainHiddenValue(),this._addText(this.currentValue),this._createListHidden(this._hiddenValue,this.selectedIndexValue),i=this.model.selectedItems,n.inArray(this.selectedIndexValue,i)==-1&&this.model.selectedItems.push(this.selectedIndexValue)):(this.ultag.children("li").removeClass("e-hover").removeClass("e-active"),this.activeItem.addClass("e-active"),this.element.val(this.currentValue),this._maintainHiddenValue(),this._hiddenInput.val(this._hiddenValue),this.model.selectedItemIndex=this.selectedIndexValue,this.model.selectedItems[0]=this.selectedIndexValue),t={text:this.element[0].value,selectedText:this.currentValue,itemId:this.selectedIndexValue,value:this._selectedValue,isChecked:this.checkedStatus},this._initValue||this._trigger("change",t),this._cascadeAction(),this.value(this._hiddenInput.val()),this.model.itemValue=this._selectedValue,this.model.text=this.element.val(),this.selectelement&&n("#"+this._id).children().length>this.selectedIndexValue&&(n("#"+this._id).children()[this.selectedIndexValue].selected=!0));this._setWatermark()},_chooseSelectionType:function(){this.activeItem=this._getActiveItem();this.selectedIndexValue=this._activeItem;this.model.dataSource!=null&&typeof this.model.dataSource[0]=="object"?(this.currentValue=n.trim(this._getField(this.popupListItems[this._activeItem],this.mapFld._text)),this.currentValue=this.currentValue==""?n.trim(this.activeItem.text()):this.currentValue,this.hidelement=this._getField(this.popupListItems[this._activeItem],this.mapFld._value),this._selectedValue=this.hidelement,this._itemID=this._getField(this.popupListItems[this._activeItem],this.mapFld._id)):(this.currentValue=n.trim(this.activeItem.text()),this._getAttributeValue(this.activeItem[0])?this._selectedValue=this._getAttributeValue(this.activeItem[0]):this.currentValue!=null?(this.activeItem[0].setAttribute("value",this.currentValue),this._selectedValue=this.currentValue):this._selectedValue="",this._itemID=n(this.activeItem).attr("id"));t.isNullOrUndefined(this._itemID)||this._itemID==""||(this.model.showCheckbox?this.removeID?this._removeSelectedItemsID():this._selectedItemsID.push(this._itemID):(this._selectedItemsID=[],this.removeID||this._selectedItemsID.push(this._itemID)));this.selectedTextValue=this.currentValue},_maintainHiddenValue:function(){this._hiddenValue=this._getAttributeValue(this.activeItem[0])||this.currentValue},_removeTextBoxValue:function(){if(this.removeID=!0,this._chooseSelectionType(),this._maintainHiddenValue(),this._removeText(this.currentValue),this._removeListHidden(this._hiddenValue,this.selectedIndexValue),this.activeItem.removeClass("e-active"),this.model.showCheckbox&&this.activeItem.find(".listcheckbox").ejCheckBox("isChecked")==!0&&(this.activeItem.find(".listcheckbox").ejCheckBox("option","checked",!1),this.checkedStatus=!1),this.model.multiSelectMode!="none"||this.model.showCheckbox){var t=this.model.selectedItems;n.inArray(this.selectedIndexValue,t)>-1&&this.model.selectedItems.splice(n.inArray(this.selectedIndexValue,t),1);(this.model.allowMultiSelection||this.model.multiSelectMode=="visualmode")&&(this._deleteBoxCheck(this.currentValue),this._isPopupShown()&&this._setListPosition())}this.model.cascadeTo!=null&&this.model.showCheckbox&&this._cascadeAction();args={text:this.currentValue,selectedText:this.currentValue,itemId:this.selectedIndexValue,value:this._selectedValue,isChecked:this.checkedStatus};this._initValue||this._trigger("select",args);args={text:this.element[0].value,selectedText:this.currentValue,itemId:this.selectedIndexValue,value:this._selectedValue,isChecked:this.checkedStatus};this._initValue||this._trigger("change",args);this.value(this._hiddenInput.val());this.model.itemValue=this._selectedValue;this.model.text=this.element.val();this._setWatermark()},_createBox:function(i){if(!this._checkContains(i)){this._ulBox.css("display")=="none"&&this.element.css("display")!="none"&&this._swapUlandInput(!0);var r=t.buildTag("span.e-icon e-close","",{},{unselectable:"on"}),u=t.buildTag("li.e-options",i).append(r);return this._on(r,"click",function(t){var i,r;if(!this.model.enabled)return!1;if(this._deleteBox(n(t.target).parent()),this._isFocused||this._isPopupShown()||this._setWatermark(),!this.model.showCheckbox){for(i=0;i<this.ultag.children("li").length;i++)this.ultag.children("li")[i].innerText==n(t.target).parent()[0].textContent&&n(this.ultag.children("li")[i]).removeClass("e-active").removeClass("e-hover");this._removeText(n(t.target).parent()[0].textContent)}this.model.multiSelectMode!="none"&&(r=this.model.selectedItems.indexOf(this.selectedIndexValue),this.model.selectedItems.splice(r,1))}),u}},_deleteBoxCheck:function(t){for(var r=this._ulBox.children("li"),i=0;i<r.length;i++)n(r[i]).text()==t&&n(r[i]).remove()},_deleteLastBox:function(){var t=this._ulBox.children("li:not(.e-search-box)"),n=t.last();n.hasClass("e-active")?this._deleteBox(n):(this._removeActive(),n.addClass("e-active"))},_deleteBox:function(t){for(var f,u,i,r=0;r<t.length;r++){for(f=n(t[r]),deltext=f.text(),u=this.ultag.children("li:not('.e-category')"),i=0;i<u.length;i++)n(u[i]).text()==deltext&&(this._activeItem=i,this._uncheckboxModel(this._activeItem),hidval=this._getAttributeValue(u[i])||deltext,this._removeListHidden(hidval,this._activeItem));f.remove()}},_swapUlandInput:function(n){n?(this.element.css("display","none"),this._ulBox.css("display","block"),this.wrapper.css({height:"auto"})):(this.element.css("display","block"),this._ulBox.css("display","none"),this.wrapper.css({height:this.model.height}))},_removeActive:function(){this._ulBox.children("li").removeClass("e-active")},_adjustWidth:function(){var n=t.buildTag("span",this.element.val());this.container.append(n);this.element.width(n.width()+30);n.remove()},_uncheckboxModel:function(t){var i=this.ultag.children("li:not('.e-category')");n(i[t].firstChild).find(".listcheckbox").ejCheckBox("isChecked")&&(n(i[t].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!1),this._removeTextBoxValue(),this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model}))},_destroyBoxModel:function(){this.container.prepend(this.element);this.element.css("display","block");this.wrapper.height(this.model.height);this._ulBox.remove();this._off(this.container,"click")},_removeListHover:function(){this.ultag.children("li").removeClass("e-hover")},_addListHover:function(){var n=this._getActiveItem();n.addClass("e-hover");this.scrollerObj.setModel({scrollTop:this._calcScrollTop()});n.focus()},_calcScrollTop:function(){for(var u=this.ultag.outerHeight(),i=this.ultag.find("li"),r=0,t=this.ultag.find("li.e-hover").index(),n=0;n<t;n++)r+=i.eq(n).outerHeight();return r-(this.popupList.outerHeight()-i.eq(t).outerHeight())/2},_getActiveItem:function(){return n(this.ultag.children("li:not('.e-category')")[this._activeItem])},_setDimentions:function(){this.model.height&&this.wrapper.height(this.model.height);this.model.width&&this.wrapper.width(this.model.width)},_roundedCorner:function(n){n?(this.container.addClass("e-corner"),this.popupList.addClass("e-corner")):(this.container.removeClass("e-corner"),this.popupList.removeClass("e-corner"))},_enabled:function(n){n?this.enable():this.disable()},_destroyDropdown:function(){this.element.insertAfter(this.wrapper);this.element.width(this.element.width()+this.dropdownbutton.outerWidth());this.wrapper.remove();this.container.remove();this.container.unbind("mousedown",n.proxy(this._OnDropdownClick,this))},_RightToLeft:function(){this.model.enableRTL?this.wrapper.addClass("e-rtl"):this.wrapper.removeClass("e-rtl")},_dropbtnRTL:function(){this.model.enableRTL?this.popupList.addClass("e-rtl"):this.popupList.removeClass("e-rtl")},_OnDropdownClick:function(t){if((t.preventDefault(),n(t.target).is("li")&&n(t.target).parent().hasClass("e-boxes")||n(t.target).parents("ul").hasClass("e-boxes")&&n(t.target).hasClass("e-icon e-close"))||this.model.readOnly)return!1;this.ultag.find("li").length>0&&this._OnPopupHideShow()},_OnPopupHideShow:function(){this._isPopupShown()?this._hideResult():(this._showResult(),this.wrapper.focus())},_showFullList:function(){this.model.dataSource!=null&&(t.DataManager&&this.model.dataSource instanceof t.DataManager||(this.popupListItems=this.model.dataSource));this._renderPopupList()},_cascadeAction:function(){if(this.model.cascadeTo){this._currentValue=this._getField(this.popupListItems[this._activeItem],this.mapFld._value);for(var r=this.model.cascadeTo.split(","),i=0;i<r.length;i++)if(n("#"+r[i]).hasClass("e-dropdownlist"))this.selectDropObj=n("#"+r[i]).ejDropDownList("instance"),t.isNullOrUndefined(this[r[i]])&&(this[r[i]]=this.selectDropObj.model.dataSource,this._setSelectedItem=!0),t.DataManager&&this[r[i]]instanceof t.DataManager?this._performOdataInit(this[r[i]]):this._performJsonDataInit(this.selectDropObj,this[r[i]],this.mapFld._value);else n("#"+r[i]).on("ejDropDownListcreate",{Obj:this},function(i){t.isNullOrUndefined(i.data.Obj.getValue())||i.data.Obj.getValue()==""||(this._currentValue=i.data.Obj._getField(i.data.Obj.popupListItems[i.data.Obj._activeItem],i.data.Obj.mapFld._value),this.selectDropObj=n("#"+this.id).ejDropDownList("instance"),i.data.Obj[this.id]=this.selectDropObj.model.dataSource,i.data.Obj._setSelectedItem=!0,i.data.Obj._performJsonDataInit(this.selectDropObj,i.data.Obj[this.id],i.data.Obj.mapFld._value))})}},_performOdataInit:function(n){var i=this,r,u;t.isNullOrUndefined(this._dQuery)&&(this._dQuery=this.selectDropObj.model.query.clone());u=this._dQuery.clone();i.selectDropObj._addLoadingClass();r=n.executeQuery(u.where(this.mapFld._value,"equal",this._currentValue));r.fail(function(){i._changedSource=null;i.selectDropObj.setModel({dataSource:i._changedSource,enabled:!1})}).done(function(n){i._changedSource=n.result;i.selectDropObj.setModel({dataSource:i._changedSource,enabled:!0});i.selectDropObj._removeLoadingClass()})},_performJsonDataInit:function(i,r,u){var f=t.DataManager(r).executeLocal(t.Query().where(u,"==",this._currentValue)),e;if(this.model.showCheckbox||this.model.multiSelectMode!="none")if(this.checkedStatus||this.activeItem.hasClass("e-active"))this._changedSource=t.isNullOrUndefined(this._changedSource)?f:this._changedSource.concat(f);else{for(e=0;e<f.length;e++)this._changedSource.splice(this._changedSource.indexOf(f[e]),1);i.setModel({dataSource:null})}else this._changedSource=f;i.setModel({dataSource:this._changedSource,enabled:!0});(i.model.showCheckbox||i.model.multiSelectMode!="none")&&n("input:hidden[id^='#'][name="+i._id+"]").remove();!t.isNullOrUndefined(i.model.selectedItemIndex)&&this._setSelectedItem&&i._selectItemByIndex(i.model.selectedItemIndex);this._setSelectedItem=!1},_OnMouseEnter:function(t){var i,r;this.ultag.children("li").removeClass("e-hover");n(t.target).is("li:not('.e-category')")&&n(t.target).addClass("e-hover");n(t.target).hasClass("e-disable")?n(t.target).removeClass("e-hover"):t.target.tagName!="li"&&(i=n(t.target).parents("li:not('.e-category')"),n(i).addClass("e-hover"));this.ultag.children("li:not('.e-category')").each(function(t){if(n(this).hasClass("e-hover"))return r=t,!1});this._activeItem=r},_OnMouseLeave:function(){this.ultag.children("li").removeClass("e-hover")},_OnMouseClick:function(t){if(n(t.target).is("li")&&!n(t.target).hasClass("e-disable")||!n(t.target).is("li")&&!n(t.target).closest("li").hasClass("e-disable"))if(this.model.showCheckbox){if(n(t.currentTarget).is("li")&&(n(t.target).is("li")||n(t.target.parentElement).is("li.e-hover"))&&n(t.currentTarget.firstChild).find(".listcheckbox")){n(t.target.parentElement).is("li.e-hover")&&(t.target=t.target.parentElement);var i=this.popupPanelWrapper.find(".e-popup").find("li:not('.e-category')");this._activeItem=n.inArray(t.target,i);n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("isChecked")?(n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("option","checked",!1),this.checkedStatus=!1,this._checkboxValue=!0,this._removeTextBoxValue()):(n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this.checkedStatus=!0,this._checkboxValue=!0,this._enterTextBoxValue())}!this._initValue&&this._checkboxValue&&this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model,text:this.currentValue,selectedText:this.currentValue,itemId:this.selectedIndexValue,value:this._selectedValue})}else this.model.template?this._templateValue():this._enterTextBoxValue(),this.model.multiSelectMode=="none"&&this._hideResult()},_OnClickCheckList:function(t){var i=this.popupPanelWrapper.find(".e-popup").find("li:not('.e-category')");this._activeItem=n.inArray(n(t.event.target).parents("li")[0],i);t.isChecked?(this.checkedStatus=!0,this._checkboxValue=!0,this._enterTextBoxValue()):(this.checkedStatus=!1,this._checkboxValue=!0,this._removeTextBoxValue())},_OnListSelect:function(t){t.preventDefault();activeItem=this._getActiveItem();n(activeItem).find(".listcheckbox").ejCheckBox("isChecked")?(n(activeItem).find(".listcheckbox").ejCheckBox("option","checked",!1),this.checkedStatus=!1,this._removeTextBoxValue()):(n(activeItem).find(".listcheckbox").ejCheckBox("option","checked",!0),this.checkedStatus=!0,this._enterTextBoxValue());this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model})},_OnDocumentClick:function(t){n(t.target).is(this.popupList)||n(t.target).parents(".e-ddl-popup").is(this.popupList)||n(t.target).is(this.element)||n(t.target).parents(".e-ddl").is(this.wrapper)?(n(t.target).is(this.popupList)||n(t.target).parents(".e-ddl-popup").is(this.popupList))&&t.preventDefault():this._hideResult()},_disableItemSelectUp:function(){var n=this.model.disableItemsByIndex.split(",").sort().reverse(),t;this._activeItem==0&&(this._activeItem=this._listSize);for(t in n)this._activeItem==parseInt(n[t])&&this._activeItem--},_disableItemSelectDown:function(){var n=this.model.disableItemsByIndex.split(",").sort(),t;this._listSize==this._activeItem&&(this._activeItem=0);for(t in n)this._activeItem==parseInt(n[t])&&this._activeItem++},_OnKeyDown:function(n){var f,r,u,i,t;if(!this.model.enabled||this.model.readOnly)return!1;this._itemId=null;f=this.ultag.children("li:not('.e-category')");this._listSize=this.ultag.children("li:not('.e-category')").size();u=this.popupList.height();r=this.ultag.children("li").outerHeight();i=Math.round(u/r);switch(n.keyCode){case 38:if(n.altKey){this.ultag.find("li").length>0&&this._hideResult();break}case 33:return t=n.keyCode==38?1:i,this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem<=0||this._activeItem==null||this._activeItem>this._listSize-1?this._activeItem=this._listSize-1:this._activeItem-=t,this.model.disableItemsByIndex!=null&&this._disableItemSelectUp(),this._addListHover(),this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem<=0||this._activeItem==null||this._activeItem>this._listSize-1?this._activeItem=this._listSize-1:this._activeItem-=t,this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()),n.preventDefault(),!1;case 40:if(n.altKey){this.ultag.find("li").length>0&&this._showResult();break}case 34:return t=n.keyCode==40?1:i,this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem>=this._listSize-1||this._activeItem==null||this._activeItem<0?this._activeItem=0:this._activeItem+=t,this.model.disableItemsByIndex!=null&&this._disableItemSelectDown(),this._addListHover(),this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem>=this._listSize-1||this._activeItem==null||this._activeItem<0?this._activeItem=0:this._activeItem+=t,this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()),n.preventDefault(),!1;case 37:return this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem<=0||this._activeItem==null||this._activeItem>this._listSize-1?this._activeItem=this._listSize-1:this._activeItem-=1,this.model.disableItemsByIndex!=null&&this._disableItemSelectUp(),this._addListHover(),this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem<=0||this._activeItem==null||this._activeItem>this._listSize-1?this._activeItem=this._listSize-1:this._activeItem-=1,this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()),n.preventDefault(),!1;case 39:return this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem>=this._listSize-1||this._activeItem==null||this._activeItem<0?this._activeItem=0:this._activeItem+=1,this.model.disableItemsByIndex!=null&&this._disableItemSelectDown(),this._addListHover(),this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem>=this._listSize-1||this._activeItem==null||this._activeItem<0?this._activeItem=0:this._activeItem+=1,this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()),n.preventDefault(),!1;case 8:return(this.model.multiSelectMode=="visualmode"||this.model.allowMultiSelection==!0&&this.model.showCheckbox)&&this._deleteLastBox(),n.preventDefault(),!1;case 9:this._hideResult();break;case 35:return this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem=this._listSize-1,this._addListHover(),this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem=this._listSize-1,this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()),n.preventDefault(),!1;case 36:return this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem=0,this._addListHover(),this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem=0,this.model.showCheckbox||this.model.template!=null||this._enterTextBoxValue()),n.preventDefault(),!1;case 27:this._hideResult();n.stopPropagation();break;case 32:return n.preventDefault(),!1}},_OnKeyUp:function(t){if(!this.model.enabled||this.model.readOnly)return!1;t.preventDefault();var i=t.target;if(n.trim(this.element.val())==""&&t.keyCode==38&&t.keyCode==40)return this._hideResult(),!1;switch(t.keyCode){case 13:return t.preventDefault(),this.model.showCheckbox?this._OnListSelect(t):this.model.template?(this._templateValue(),this._hideResult()):(this._enterTextBoxValue(),this._hideResult()),!1;case 32:return t.preventDefault(),this.model.showCheckbox?this._OnListSelect(t):this.model.template?(this._templateValue(),this._hideResult()):(this._enterTextBoxValue(),this._hideResult()),!1;case 8:this._hideResult();break;case 46:if(this.model.multiSelectMode=="visualmode"||this.model.allowMultiSelection==!0&&this.model.showCheckbox){this._deleteBox(this._ulBox.children("li.e-active"));break}}},_OnKeyPress:function(n){this.model.enableIncrementalSearch&&this._OnTextEnter(t.browserInfo().name=="mozilla"?n.charCode:n.keyCode)},_templateValue:function(){this._isWatermark||this._hiddenSpan.css("display","none");var t=n(this.ultag.children("li:not('.e-category')")[this._activeItem]);currentText=this._getField(this.popupListItems[this._activeItem],this.mapFld._text);currentValue=this._getField(this.popupListItems[this._activeItem],this.mapFld._value);this._hiddenValue=this._getAttributeValue(this.ultag.children("li")[this._activeItem])?currentValue:currentText;args={text:currentText,selectedText:currentText,itemId:this._activeItem,value:currentValue};this._initValue||this._trigger("select",args);this._activeItem!=this._aselectedItem&&(this.ultag.children("li").removeClass("e-hover").removeClass("e-active"),t.addClass("e-active"),this._aselectedItem=this._activeItem,this.element.val(currentText),this._hiddenInput.val(this._hiddenValue),args={text:this.element[0].value,selectedText:currentText,itemId:this._activeItem,value:currentValue},this._initValue||this._trigger("change",args),this.value(this._hiddenInput.val()),this.model.itemValue=currentValue,this.model.text=currentText);this._setWatermark()},_OnTextEnter:function(t){_proxy=this;this._incqueryString+=String.fromCharCode(t);this._incqueryString.length>0&&setTimeout(function(){_proxy._incqueryString=""},1e3);var f=this.popupList.find("ol,ul").children("li:not('.e-category')"),i,o=this.model.caseSensitiveSearch,h=this.model.fields,r,e=this._incqueryString,s=this._incqueryString.length,u=!1;for(o||(e=e.toLowerCase()),i=0;i<f.length;i++)if(r=n.trim(n(f[i]).text()),r=o?r:r.toLowerCase(),r.substr(0,s)==e?(this._isPopupShown()?(this._removeListHover(),this._activeItem=i,this.model.showCheckbox||this._enterTextBoxValue(),this._addListHover()):(this._activeItem=i,this.model.showCheckbox||this._enterTextBoxValue()),u=!0):i==f.length-1&&u==!1&&(this.model.itemValue==""&&(this._activeItem=null,this.model.showCheckbox||this.element.val("")),u=!0),u)break},_targetFocus:function(){this.model.enabled&&!this._isFocused&&(this._isWatermark||this._hiddenSpan.css("display","none"),this.wrapper.addClass("e-focus"),this._isFocused=!0,this._trigger("focusIn"))},_targetBlur:function(){this.model.enabled&&(this._isFocused=!1,this.wrapper.removeClass("e-focus"),this._setWatermark(),this._trigger("focusOut"))},_wireEvents:function(){this._on(this.wrapper,"focus",this._targetFocus);this._on(this.wrapper,"blur",this._targetBlur);this._on(this.wrapper,"keydown",this._OnKeyDown);this._on(this.popupList,"keydown",this._OnKeyDown);this._on(this.popupList,"keyup",this._OnKeyUp);this._on(this.wrapper,"keyup",this._OnKeyUp);this._on(this.popupList,"keypress",this._OnKeyPress);this._on(this.wrapper,"keypress",this._OnKeyPress)}});t.MultiSelectMode={None:"none",Delimiter:"delimiter",VisualMode:"visualmode"}})(jQuery,Syncfusion)});