/*!
*  filename: ej.spreadsheet.min.js
*  version : 13.2.0.39
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.scroller.min","./ej.datepicker.min","./ej.checkbox.min","./ej.dropdownlist.min","./ej.editor.min","./ej.pager.min","./ej.ribbon.min","./ej.calculate.min","./ej.excelfilter .min"],n):n()})(function(){(function(n,t,r){t.widget("ejSpreadsheet","ej.Spreadsheet",{_rootCSS:"e-spreadsheet",element:null,_excelFilter:null,validTags:["div"],model:null,defaults:{allowFreezing:!0,enableContextMenu:!0,allowEditing:!0,allowResizing:!0,allowMerging:!0,allowWrap:!0,allowUndoRedo:!0,allowClipboard:!0,allowDataValidation:!0,allowConditionalFormats:!0,allowSearching:!0,allowKeyboardNavigation:!0,allowAutoFill:!0,allowSelection:!0,allowSorting:!0,allowDragAndDrop:!0,allowCharts:!0,enablePersistence:!1,allowCellFormatting:!0,allowFormulaBar:!0,showRibbon:!0,allowComments:!0,allowFiltering:!0,allowInsert:!0,allowDelete:!0,allowFormatPainter:!0,allowHyperlink:!0,allowImport:!0,allowFormatAsTable:!0,allowAutoSum:!0,allowPivotTable:!1,columnCount:21,rowCount:20,rowHeight:20,columnWidth:60,sheetCount:1,undoredoStep:20,activeSheetIndex:1,apWidth:200,cssClass:"",userName:"",locale:"en-US",pageSize:"A4",sheets:[],nameManager:[],currentViewData:null,query:null,actionBegin:null,actionComplete:null,beforeCellFormat:null,beforeOpen:null,beforeDrop:null,drop:null,cellEdit:null,pagerClick:null,cellClick:null,_pivotPrint:null,onTabClick:null,onTabSelect:null,_createPivotTable:null,beforePanelOpen:null,onLoad:null,onLoadComplete:null,beforePrint:null,editRangeBegin:null,editRangeComplete:null,onCellHover:null,menuClick:null,contextMenuClick:null,ribbonClick:null,dragStart:null,drag:null,cellSave:null,beforeCellSelect:null,autoFillBegin:null,autoFillComplete:null,seriesRendering:null,onOpenFailure:null,scrollSettings:{width:600,height:300,allowScrolling:!0,scrollMode:"infinite",isResponsive:!1},pageSettings:{pageCount:10,currentPage:1,pagerHeight:26},exportSettings:{allowExporting:!0,excelUrl:null,csvUrl:null},pictureSettings:{allowPictures:!0,height:220,width:440},selectionSettings:{selectionType:"default",selectionUnit:"multirange",enableAnimation:!1,animationType:"easeOutQuart",animationTime:.001},chartSettings:{height:220,width:440},formatSettings:{allowFontFamily:!0,allowDecimalPlaces:!0,allowCellBorder:!0},autoFillSettings:{fillType:"fillseries",showFillOptions:!0},importSettings:{importMapper:"",importUrl:"",password:""},printSettings:{allowPageSetup:!0,allowPageSize:!1,allowPrinting:!0}},_dataSource:function(n){return this.getSheet(n).dataSource},getSheet:function(n){return this.model.sheets[n]},getSheetElement:function(n){return this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value)},getDataSource:function(n){return this.getSheet(n).dataSource},setDataSource:function(n,t){this.getSheet(n).dataSource=t},_getJSSheetHeader:function(n){return this._sheets[n]._sheetHeader},_setJSSheetHeader:function(n,t){this._sheets[t]._sheetHeader=n},_getInputBox:function(){return this._inputBox},_setInputBox:function(n){this._inputBox=n},_getIndexBox:function(){return this._indexBox},_setIndexBox:function(n){this._indexBox=n},_getJSSheetRowHeader:function(n){return this._sheets[n]._sheetRowHeader},_setJSSheetRowHeader:function(n,t){this._sheets[t]._sheetRowHeader=n},_getJSSheetRowHeaderContent:function(n){return this._sheets[n]._sheetRowHeaderContent},_setJSSheetRowHeaderContent:function(n,t){this._sheets[t]._sheetRowHeaderContent=n},_getJSSheetContent:function(n){return this._sheets[n]._sheetContent},_setJSSheetContent:function(n,t){this._sheets[t]._sheetContent=n},_getContent:function(n){return this._sheets[n]._content},_setContent:function(n,t){this._sheets[t]._content=n},getPager:function(){return this._spreadSheetPager},setPager:function(n){this._spreadSheetPager=n},getFooter:function(){return this._footer},setFooter:function(n){this._footer=n},getMainPanel:function(){return this._mainPanel},setMainPanel:function(n){this._mainPanel=n},getGroupPanel:function(){return this._groupPanel},setGroupPanel:function(n){this._groupPanel=n},getActivationPanel:function(){return this._activationPanel},setActivationPanel:function(n){this._activationPanel=n},getActiveSheetIndex:function(){return this.model.activeSheetIndex},setActiveSheetIndex:function(n){this.model.activeSheetIndex=n},getRows:function(n){return this._sheets[n]._Rows},setRows:function(n,t){this._sheets[t]._Rows=n},getFrozenRows:function(n){return this.getSheet(n)._frozenRows},setFrozenRows:function(n,t){this.getSheet(t)._frozenRows=n},getFrozenColumns:function(n){return this.getSheet(n)._frozenColumns},setFrozenColumns:function(n,t){this.getSheet(t)._frozenColumns=n},setFocusTopElem:function(n){this._focusTopElem=n},getFocusTopElem:function(){return this._focusTopElem},setFocusRightElem:function(n){this._focusRightElem=n},getFocusRightElem:function(){return this._focusRightElem},setFocusBottomElem:function(n){this._focusBottomElem=n},getFocusBottomElem:function(){return this._focusBottomElem},setFocusLeftElem:function(n){this._focusLeftElem=n},getFocusLeftElem:function(){return this._focusLeftElem},setAutoFillElem:function(n){this._autoFillElem=n},getAutoFillElem:function(){return this._autoFillElem},_setAutoFillOptElem:function(n){this._autoFillOptElem=n},_getAutoFillOptElem:function(){return this._autoFillOptElem},setActiveCell:function(n,i,r){var u=this.getSheet(r?r:this.getActiveSheetIndex());u._activeCell=t.isNullOrUndefined(n)&&t.isNullOrUndefined(i)?u._startCell:{rowIndex:n,colIndex:i}},getActiveCell:function(n){return this.getSheet(n?n:this.getActiveSheetIndex())._activeCell},_setFormulaSuggElem:function(n){this._formulaSuggElem=n},_getFormulaSuggElem:function(){return this._formulaSuggElem},_sheetSettings:function(n){var i={rowIndex:0,colIndex:0},t=this.getSheet(n),r=this._generateSheetName(this._newSIndex);this.model.sheets[n]={colCount:t&&t.colCount||this.model.columnCount,rowCount:t&&t.rowCount||this.model.rowCount,_formulaCollection:{},columnsWidthCollection:[],rowsHeightCollection:[],_spreadSheetPager:null,printHeader:!1,printGridlines:!1,showHeader:!0,showGridlines:!0,dataSource:this.isUndefined(t)?null:t.dataSource,columns:t&&t.columns?t.columns:[],_excelFilter:null,filterSettings:{filteredColumns:[],maxFilterChoices:1e3,filteredRange:[],range:"",tableRange:[]},_frozenRows:t&&t._frozenRows||0,_frozenColumns:t&&t._frozenColumns||0,_selectedRange:{},_selectedCellColors:[],columnWidth:this.model.columnWidth,_currentTopFrozenRow:0,_currentLeftFrozenColumn:0,_frozenHeight:0,_frozenWidth:0,_firstRow:{idx:0,value:0},_firstCol:{idx:0,value:0},_topRow:{idx:0,value:0},_leftCol:{idx:0,value:0},_selectedCells:[],selectedRange:[],_tableManager:{},_header:{},_selectedCellIndexes:[],_startCell:i,_endCell:i,_activeCell:i,_autoFillCell:i,rangeSettings:t&&t.rangeSettings||[],_sheetName:{text:r,value:this._getLocStr("Sheet")+this._newSIndex,isVisible:!0},_multipleFiltering:!1,_multifilterIdx:[],_filteredByColor:"",staticWidth:0,_fRow:0,_fCol:0,hideColsCollection:[],hideRowsCollection:[],filteredRowsCollection:[],_hiddenHeight:0,_hiddenWidth:0,_frHiddenHeight:0,_fpHiddenHeight:0,_fpHiddenWidth:0,_pTarget:{},_cSpan:1,_rSpan:1,_usedRange:{rowIndex:0,colIndex:0},_mergedCells:[],_shapeMngr:{picture:[],chart:[],sharedPics:[]},_nmValue:{},_nmEdit:!1,_importRendered:!1,_defRowCount:0,_defColCount:0,_wrapHtCollection:{}}},_generateSheetName:function(n){var i,u,t=this.model.sheets,f=1,r;if(r=this.isUndefined(t[n])||this.isUndefined(t[n].sheetName)?this._getLocStr("Sheet")+n:t[n].sheetName,!this.isUndefined(t))for(i=1,u=t.length;i<u;i++)this.isUndefined(t[i]._sheetName)||r!==t[i]._sheetName.text||(i=1,r=this.isUndefined(t[n])||this.isUndefined(t[n].sheetName)?this._getLocStr("Sheet")+ ++n:t[n].sheetName+f++);return r},_initPrivateProperties:function(){var n=1,i={rowIndex:0,colIndex:0},r=this._getLocStr("AutoFillOptions").split("/");for(this._dataContainer={sheets:{},hashCode:[],sharedData:[],cellType:[],valData:[],cFormatData:[],pictures:[]},this._newSIndex=1,this._sheets=this.importSheet?this._sheets:[];n<=this.model.sheetCount;)this._sheetSettings(n),this._dataContainer.sheets[n]={},this._sheets[n]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null,_calcEngine:null},this._newSIndex++,n++;this.XLCFormat=null;this.XLCellNav=null;this.XLClipboard=null;this.XLEdit=null;this.XLFormat=null;this.XLFndRp=null;this.XLChart=null;this.XLCMenu=null;this.XLComment=null;this.XLDragDrap=null;this.XLDragFill=null;this.XLExport=null;this.XLFilter=null;this.XLFreeze=null;this.XLPrint=null;this.XLResize=null;this.XLRibbon=null;this.XLScroll=null;this.XLSelection=null;this.XLSort=null;this.XLShape=null;this.XLValidate=null;this._detachTable=null;this._isPrint=!1;this._isSheetInsert=!1;this._isSheetRename=!1;this._sheetCopy={isSheetCopy:!1,sheetContent:null};this._id=this.element.attr("id");this._currentJsonData={};this._alertDialog={element:null,action:null};this._dataManager=this.getDataSource(this.getActiveSheetIndex())instanceof t.DataManager?this.getDataSource(this.getActiveSheetIndex()):this.getDataSource(this.getActiveSheetIndex())!=null?t.DataManager(this.getDataSource(this.getActiveSheetIndex())):null;this._isUndo=!1;this._undoCollection=[];this._redoCollection=[];this._hasComment=!1;this._customCellStyle={};this._customTableStyle={};this._tableLayout="";this._ctrlKeyCount=0;this._formulaRange=[];this._formulaHeight=36;this._isSort=!1;this._isPaste=!1;this._undoredoStep=20;this._isFAT=!1;this._isFATResize=!1;this._isDisplayHeader=!1;this._currencySymbol=Globalize.culture(this.model.locale).numberFormat.currency.symbol?Globalize.culture(this.model.locale).numberFormat.currency.symbol:"$";this._percentSymbol=Globalize.culture(this.model.locale).numberFormat.percent.symbol?Globalize.culture(this.model.locale).numberFormat.percent.symbol:"%";this.operators={"<":function(n,t){return n<t},">":function(n,t){return n>t},">=":function(n,t){return n>=t},"<=":function(n,t){return n<=t},"==":function(n,t){return n===t},"!=":function(n,t){return n!==t},"!":function(n){return!n},"=":function(n){return n}};this.parse={parseInt:function(n){return parseInt(n)},parseFloat:function(n){return parseFloat(n)},parseDate:function(n){return new Date(n).getTime()},parseTime:function(n){return new Date("01/01/1990 "+n).getTime()},length:function(n){return n.charAt(0)==="^"?parseInt(n.split("^")[1]):n.length}};this._selMergeCells=[];this._mergeType="merge-cells";this._delCells=[];this._isHLink=!1;this._deletedText=[];this._insDelStatus="";this.$headerTable=null;this._isUndoRedo=!1;this._indexBox=null;this._inputBox=null;this._focusTopElem=null;this._focusRightElem=null;this._focusBottomElem=null;this._focusLeftElem=null;this._dStartCell=i;this._dEndCell=i;this._pStartCell=i;this._pEndCell=i;this._pFillCell=i;this._borderFocus=["e-focusright","e-focusbottom"];this._cutFocus=["e-cutright","e-cutbottom"];this._autoFillFocus=["e-autofillright","e-autofillbottom"];this._formulaBorder=[["e-bborderright","e-bborderbottom"],["e-rborderright","e-rborderbottom"],["e-vborderright","e-vborderbottom"],["e-gborderright","e-gborderbottom"],["e-pborderright","e-pborderbottom"],["e-oborderright","e-oborderbottom"]];this._ctrlFormulaBorder=[["e-bctrlborderright","e-bctrlborderbottom"],["e-rctrlborderright","e-rctrlborderbottom"],["e-vctrlborderright","e-vctrlborderbottom"],["e-gctrlborderright","e-gctrlborderbottom"],["e-pctrlborderright","e-pctrlborderbottom"],["e-octrlborderright","e-octrlborderbottom"]];this._borderTypes=[{id:"bottomborder",text:this._getLocStr("BottomBorder"),parentId:null,sprite:"e-icon e-ss-bottomborder"},{id:"topborder",text:this._getLocStr("TopBorder"),parentId:null,sprite:"e-icon e-ss-topborder"},{id:"leftborder",text:this._getLocStr("LeftBorder"),parentId:null,sprite:"e-icon e-ss-leftborder"},{id:"rightborder",text:this._getLocStr("RightBorder"),parentId:null,sprite:"e-icon e-ss-rightborder"},{id:"noborder",text:this._getLocStr("NoBorder"),parentId:null,sprite:"e-icon e-ss-noborder"},{id:"allborder",text:this._getLocStr("AllBorder"),parentId:null,sprite:"e-icon e-ss-allborder"}];this._isApply=!1;this._datePattern=["year","month","day","hours","minutes","seconds"];this._styleColl={};this.importSheet=this.importSheet?!0:!1;this._borderStyle="solid";this._borderColor="#000000";this._borderStyles=["solid","dashed","dotted"];this._mergeCenter=!1;this._ddlCell=null;this._cOpt={};this._shapeChange=!1;this._isClearAll=!1;this._paste=!1;this._autoFillElem=null;this._autoFillOptElem=null;this._isAutoFillClass=!1;this._rowCount=this.model.rowCount;this._colCount=this.model.columnCount;this._isPrevCMenu=!1;this._fillOptionMenuData=[{id:"copycells",text:r[0],parentId:null,sprite:"e-icon e-ss-fillselect"},{id:"fillseries",text:r[1],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"fillformattingonly",text:r[2],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"fillwithoutformatting",text:r[3],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"flashfill",text:r[4],parentId:null,sprite:"e-icon e-ss-filloption"}];this._formulaSuggElem=null;this._isFormulaSuggestion=!1;this._ctrlKeyEnabled=!1;this._shiftKeyEnabled=!1;this._preventcutcopy=!1;this._rAlign="e-ralign";this._cAlign="e-calign";this._chartBorder=[["e-rcbright","e-rcbbottom"],["e-vcbright","e-vcbbottom"],["e-bcbright","e-bcbbottom"]];this._selectionBorder=["e-selecttop","e-selectright","e-selectbottom","e-selectleft"];this._autofillBorder=["e-autofilltop","e-autofillright","e-autofillbottom","e-autofillleft"];this._thinBorder=["e-thinright","e-thinbottom"];this._rcRegx=new RegExp("\\be-rc.*\\b","g");this._mcRegx=new RegExp("\\be-mc.*\\b","g");this._formatRegx=new RegExp("\\be-format.*?\\b","g");this._borderRegx=new RegExp("\\be-border.*?\\b","g");this._wrapRow=!1},_initCssRules:function(){var t,n;t=document.getElementById(this._id+"_sscustomformat");n=".e-spreadsheet .e-hide, .e-spreadsheet .e-mc-hide, .e-spreadsheet .e-fr-hide{ display: none}";n+=".e-spreadsheet .e-rowcell.e-redft { background-color: #FFC7CE; color: #9C0055;} .e-spreadsheet .e-rowcell.e-yellowft { background-color: #FFEB9C; color: #9C6500;}";n+=".e-spreadsheet .e-rowcell.e-greenft { background-color: #C6EFCE;   color: #006100;} .e-spreadsheet .e-rowcell.e-redf { background-color: #FFC7CE;} .e-spreadsheet .e-rowcell.e-redt { color: #9C0055;}";n+=".e-spreadsheet .e-rowcell.e-hlcell { background-color: #FFFF00; color: #FF0000;} .e-spreadsheet .e-rowcell.e-goto-blank { background-color: #C6C6C6;}";n+=".e-fc-hide {width: 0 !important;}";t.styleSheet?t.styleSheet.cssText+=n:t.appendChild(document.createTextNode(n))},_generateHeaderText:function(n,t){if(n)if(this.getSheet(n)._isTemplate){if(this.getSheet(n).columns[t]!=r)return this.getSheet(n).columns[t].field}else return t/26>1?this._generateHeaderText(n,t%26==0?t/26-1:Math.floor(t/26))+String.fromCharCode(t%26==0?"Z".charCodeAt("Z"):64+t%26):String.fromCharCode(64+t)},_generateColCount:function(n){var i=0,t;for(n=n.split("").reverse().join(""),t=n.length-1;t>=0;t--)i+=(n[t].charCodeAt(n[t])-64)*Math.pow(26,t);return i},_getSheetIndex:function(n){return n?n:this.getActiveSheetIndex()},_getSheetIdxFromName:function(n){for(var t=1,i=this.model.sheets,r=i.length-1;t<=r;){if(i[t]._sheetName.value===n)return t;t++}return-1},_getAlphaRange:function(n,t,i,r,u){return t=t+1,i=i+1,r=r+1,u=u+1,t===r&&i===u?this._generateHeaderText(n,i)+t:this._generateHeaderText(n,i)+t+":"+this._generateHeaderText(n,u)+r},_getProperAlphaRange:function(n,t,i,r,u){var f=this._getAlphaRange(n,t,i,r,u);return f.indexOf(":")===-1?f+":"+f:f},_getDollarAlphaRange:function(n,t){var i=this.getActiveSheetIndex();return t&&!this.isRange(n)?this.getSheet(i)._sheetName.value+"!$"+this._generateHeaderText(i,n[1]+1)+"$"+ ++n[0]:this.getSheet(i)._sheetName.value+"!$"+this._generateHeaderText(i,n[1]+1)+"$"+ ++n[0]+":$"+this._generateHeaderText(i,n[3]+1)+"$"+ ++n[2]},_getWorkbookMaxRowColCnt:function(n,t){for(var f,r,u,i,e=0,o=0,s=1,n=n?n:this.model.sheets,h=n.length;s<h;){if(i=n[s],t){if(!i.usedRange)continue;f=this.getRangeIndices(i.usedRange);r=f[2];u=f[3]}else r=i.rowCount,u=i.colCount;e<r&&(e=r);o<u&&(o=u);s++}return{rowCount:e,colCount:o}},_generateEJMenu:function(n,i,r){return{menuType:n==="normal"?t.MenuType.NormalMenu:t.MenuType.ContextMenu,orientation:i==="vertical"?t.Orientation.Vertical:t.orientation.Horizontal,cssClass:r}},_generateEJDD:function(t,i,r,u,f,e){return{dataSource:t,fields:i,selectedItemIndex:r,width:u,height:f,change:n.proxy(this.XLRibbon._frTypeChange,this,e)}},_renderHeaderCol:function(i,r,u){for(var l=t.buildTag("tr.e-columnheader"),a,s,v=n(document.createElement("colgroup")),y=n(document.createElement("tr")),h,p,c,w,e=[],o=this.getSheet(i).columnWidth,f=u;f<r;f++)this._sheetCopy.isSheetCopy&&(o=t.isNullOrUndefined(this.getSheet(i).columnsWidthCollection[f])?this.getSheet(i).columnWidth:this.getSheet(i).columnsWidthCollection[f]),h=t.buildTag("th.e-headercell","",{},{}),p=document.createElement("td"),c=this.getSheet(i)._isTemplate?t.buildTag("div.e-headercelldiv",this._generateHeaderText(i,f),{},{}):t.buildTag("div.e-headercelldiv",this._generateHeaderText(i,f+1),{},{}),h.append(c),a=c.text(),w=t.buildTag("col","",{width:o},{}),y.append(p),l.append(h),v.append(w),this.getSheet(i).columnsWidthCollection[f]=o,this.getSheet(i)._isTemplate||this.getSheet(i).columns.push({field:a,type:s!=null?s.getDay?"date":typeof s:null,width:o});return e.push(y),e.push(l),e.push(v),e},_renderHeaderColumns:function(i){var u=t.buildTag("table.e-table","",{},{cellspacing:"0.25px"}),f=n(document.createElement("thead")),e=t.buildTag("tbody.e-hide"),o,s,h,r;return r=this._renderHeaderCol(i,this.getSheet(i).colCount,0),s=r.pop(),o=r.pop(),h=r.pop(),f.append(o),e.append(h),u.append(s).append(f).append(e),u},_renderHeader:function(n){var i=t.buildTag("div.e-spreadsheetheader"),u=t.buildTag("div.e-spreadsheetcolumnheader e-icon e-ss-selectall","",{float:"left",width:"29px"},{}),r=t.buildTag("div.e-headercontent");return r.append(this._renderHeaderColumns(n)),this._setJSSheetHeader(i,n),i.append(u),i.append(r),i},_refreshWidthHeight:function(i,r,u){var s=0,h=0,e=this._getContent(i),o,f=this._getJSSheetRowHeader(i);o=this.model.allowFormulaBar?this._formulaHeight:0;t.isNullOrUndefined(u)&&(u=n("#"+this._id+"_Ribbon").height());this._alignFormulaBar(this.element.find(".e-formulabar").width());this.model.sheets[i].showHeader&&(s=this._getJSSheetHeader(i).height(),h=f.width());this.getGroupPanel().height(r.height-(u+o));this.getMainPanel().height(this.getGroupPanel().height());r.height=r.height-(s+1+this.model.pageSettings.pagerHeight+o+u);e.find("#hscrollBar").length>0&&(e.find("#hscrollBar").remove(),f.removeClass("e-scrollrowcss"),f.height(r.height),this._getJSSheetRowHeaderContent(i).height(r.height),this._getContent(i).find(".e-content").height(r.height));e.find("#vscrollBar").length>0&&(e.find("#vscrollBar").remove(),f.removeClass("e-scrollcss"),this._getContent(i).find(".e-content").width(r.width));this._getContent(i).height(r.height);f.height(r.height);this._getJSSheetContent(i).width(r.width);n(this.getFooter()).width(r.width);r.width=r.width-h},_setSheetWidthHeight:function(t,i,r,u){var o=!1,s=n(document),h=!1,f={},c,l,e={},a=this._getContent(t),v=this._getJSSheetRowHeader(t),y;this.model.scrollSettings.isResponsive?(c=i.height=i.height.toString().indexOf("%")>-1?this.element.parent().height():i.height,l=i.width=i.width.toString().indexOf("%")>-1?this.getMainPanel().width():i.width,u==="refresh"&&(y=this.getBrowserDetails(),y.browser.indexOf("msie")>-1&&(s=this.model.showRibbon?n(document):n("body"))),f.vertical=n(window).height()<s.height(),this._refreshWidthHeight(t,i,r),f.horizontal=n(window).width()<s.width(),e.vertical=n(window).height()<s.height(),e.horizontal=n(window).width()<s.width(),f.vertical&&!e.vertical?(i.width=l+17,h=!0):!f.vertical&&e.vertical&&(i.width=l-17,h=!0),f.horizontal&&!e.horizontal?(i.height=c+16,o=!0):!f.horizontal&&e.horizontal&&(i.height=c-16,o=!0),h&&!o&&(i.height=c),!h&&o&&(i.width=l),(o||h)&&this._refreshWidthHeight(t,i,r)):this._refreshWidthHeight(t,i,r);this.model.scrollSettings.allowScrolling&&this._renderScroller(t,i);a.find("#vscrollBar").length>0&&this._getJSSheetHeader(t).addClass("e-scrollcss");a.find("#hscrollBar").length>0&&(v.height(this._getContent(t).height()-18),this._getJSSheetRowHeaderContent(t).height(this._getContent(t).height()-18),v.addClass("e-scrollrowcss"))},setWidthToColumns:function(n){for(var r,u,f=0,i=this.getActiveSheetIndex(),t=0,e=n.length;t<e;t++)r=this._getContent(i).find("col")[n[t].cellIndex],u=this._getJSSheetHeader(i).find("col")[n[t].cellIndex],n[t].width===0&&(n[t].width=60),u.style.width=n[t].width+"px",r.style.width=n[t].width+"px",f+=n[t].width,this.getSheet(i).columnsWidthCollection[n[t].cellIndex]=n[t].width,this.getSheet(i).columns[n[t].cellIndex].width=n[t].width;this.model.sheets[i].staticWidth=f;this.model.sheets[i]._importRendered||(this.XLSelection._refreshBorder(),this.XLScroll._refreshScroller(i,"refresh","all"),this.XLDragFill.positionAutoFillElement())},_calculateRowAndColumnCount:function(t){var f=0,s=!1,h=!1,i,c=this.model.columnCount*this.model.columnWidth,l=this.model.rowCount*this.model.rowHeight,a=this.getSheet(t),e=this.element.find(".e-spreadsheetpanel").width()+2,o=this.element.parent().height(),r=0,u=0;this.model.showRibbon&&(r=n("#"+this._id+"_Ribbon").height());this.model.allowFormulaBar&&(u=this._formulaHeight);this.getActivationPanel().is(":visible")&&(f=this.getActivationPanel().width());e-f>c&&(i=(e-c)/this.model.columnWidth,this.model.columnCount+=Math.ceil(i)+5,s=!0);o-(r+u)>l&&(i=(o-(r+u)-l)/this.model.rowHeight,this.model.rowCount+=Math.ceil(i)+5,h=!0);s&&(this.model.columnCount>this.getSheet(t).colCount?this.getSheet(t).colCount=this.model.columnCount:this.model.columnCount=this.getSheet(t).colCount);h&&(this.model.rowCount>this.getSheet(t).rowCount?this.getSheet(t).rowCount=this.model.rowCount:this.model.rowCount=this.getSheet(t).rowCount);this.getSheet(t)._defRowCount=parseInt((o-(r+u))/this.model.rowHeight)+10;this.getSheet(t)._defColCount=parseInt((e-f)/this.model.columnWidth)+10},_addTemplate:function(i){var c={},l=t.buildTag("tbody"),e,a=t.buildTag("colgroup"),o,u,f=this.getSheet(i).columns,s,r,v,h,y;for(e=t.buildTag("tr","",{height:this.model.rowHeight+"px"}),r=0,v=this.getSheet(i).colCount;r<v;r++)o=document.createElement("col"),o.style.width=this.getSheet(i).columnWidth+"px",u=t.buildTag("td.e-rowcell"),f&&f[r]&&(f[r].template?(h={},h["_"+this._id+"ColumnTemplating"]=this._spreadsheetTemplate,n.views.helpers(h),y=this._createTemplateElement(i,f[r]),u.addClass("e-templatecell").html("{{:~_"+this._id+"ColumnTemplating('"+y.id+"')}}")):(s="{{:#data['"+this.getSheet(i).columns[r].field+"']}}",u.attr("data-value",s),u.html(s))),e.append(u),a.append(o);l.get(0).appendChild(e.get(0));c[this._id+"JSONTemplate"+i]=l.html();n.templates(c);this._sheets[i]._contentColGroup=a.get(0)},_addInitTemplate:function(){for(var t,n=1;n<=this.model.sheetCount;)t=this.getSheet(n),t.dataSource&&this._initColumns(n,t.dataSource[0]),n++},_renderData:function(t){var i=[],r;if(this.getSheet(t).dataSource)i=this.getSheet(t).dataSource;else for(r=0;r<this.getSheet(t).rowCount;r++)i.push({});return this.getSheet(t).dataSource=i,n.render[this._id+"JSONTemplate"+t](i)},_renderContent:function(i){var r=t.buildTag("div.e-spreadsheetcontent e-ss-cursor"),u,a=t.buildTag("div.e-spreadsheetrowheader","",{float:"left",width:"30px"},{}),v=t.buildTag("div.e-spreadsheetcontentcontainer"),f,e,o,s,y,p,h,c,l;for(this._setJSSheetContent(r,i),r.append(a),r.append(v),f=n(document.createElement("colgroup")),o="",e=document.createElement("col"),e.style.width="30px",f.append(e),s=this.getSheet(i).rowCount,y=this.getSheet(i).colCount,p=this.getSheet(i).columnWidth,this.getSheet(i).dataSource&&!this.importSheet&&(this.getSheet(i).rowCount=this.getSheet(i).dataSource.length),u=0;u<s;u++)h=this._renderTD("e-rowheader","",u+1),o+=this._renderTR(h,u,i);c=r.find(".e-spreadsheetcontentcontainer").get(0);l=r.find(".e-spreadsheetrowheader").get(0);l.innerHTML=["<div class='e-rowheadercontent'><table class='e-table'>"+f.get(0).outerHTML,"<tbody>",o,"<\/tbody><\/table><\/div>"].join("");c.innerHTML=this._sheetCopy.isSheetCopy?["<div class='e-content'>"+this._sheetCopy.sheetContent.outerHTML+"<\/div>"].join(""):["<div class='e-content'><table class='e-table'>"+this._sheets[i]._contentColGroup.outerHTML,"<tbody>",this._renderData(i),"<\/tbody>","<\/table><\/div>"].join("");this._setContent(r.find(".e-spreadsheetcontentcontainer"),i);this._setJSSheetRowHeader(r.find(".e-spreadsheetrowheader"),i);this._setJSSheetRowHeaderContent(r.find(".e-rowheadercontent"),i);var w=this._getContent(i).find(".e-table").get(0).rows,b=this._getJSSheetRowHeader(i).find(".e-table").get(0).rows,k=[b,w];return this.setRows(k,i),r},_renderTD:function(n,t,i){return String.format("<td class='{0}' style='{1}' >{2}<\/td>",n,t,i)},_renderDIV:function(n,t){return String.format("<div class='{0}' >{1}<\/div>",n,t)},_renderTR:function(n,t,i){var r=this._sheetCopy.isSheetCopy?this.getSheet(i).rowsHeightCollection[t]:this.model.rowHeight,u="height:"+r+"px;";return this._sheetCopy.isSheetCopy||this.getSheet(i).rowsHeightCollection.push(this.model.rowHeight),String.format("<tr style='{0}'>"+n+"<\/tr>",u)},_renderFooter:function(){var i=t.buildTag("div.e-spreadsheetfooter"),u=t.buildTag("table.e-table","",{},{}),f=n(document.createElement("tbody")),e=n(document.createElement("tr")),r=n(document.createElement("td"));r.append(this._renderSpreadSheetPager());r.find(".e-pagercontainer").append(t.buildTag("div.e-new e-icon e-default","",null,{title:"New Sheet"}));e.append(r);f.append(e);u.append(f);i.append(u);this.getMainPanel().append(i);i.width(this.model.scrollSettings.width);i.height(this.model.pageSettings.pagerHeight);this.setFooter(i);this._refreshSpreadSheetPager()},gotoPage:function(t,i){var u,r=this.model.sheets,s=this.getPager(),e="option",o="checked",f={reqType:"gotoSheet",gotoIndex:t,newSheet:i};this._trigActionBegin(f)||!i&&t>this.model.sheetCount||t<1||(this.setActiveSheetIndex(t),this.element.find(".e-sheet").hide(),i&&this._addSheet(t),this._isSheetInsert&&(u=s.ejPager("option","currentPage"),this._swapSheetDtCntr(r.length-1,u),this.model.activeSheetIndex=t=u,this._isSheetInsert=!1),this.element.find("#"+this._id+"_"+this.model.sheets[t]._sheetName.value).show(),r[t]._importRendered||this.model.enableContextMenu&&this.XLCMenu.hideCMenu(),this._refreshSpreadSheetPager(),r[t]._importRendered&&(this.showWaitingPopUp(),this._updateImportedSheets(t),this.XLScroll._refreshScroller(t,"refresh","all"),this.hideWaitingPopUp()),this._initializeSelection(),this._updateRibbonTab(this.getActiveCellElem(t)[0]),r[t]._importRendered=!1,this.model.showRibbon&&(!this.importSheet&&this.model.allowComments&&this.XLComment._updateCmntRibIcons(),n("#"+this._id+"_Ribbon_Vheading").ejCheckBox(e,o,r[t].showHeader),n("#"+this._id+"_Ribbon_Vgridlines").ejCheckBox(e,o,r[t].showGridlines)),f={activeSheet:this.getActiveSheetIndex(),reqType:"gotoSheet"},this._trigActionComplete(f))},insertSheet:function(){if(this.model.allowInsert){var n=this.getPager(),t=n.ejPager("option","totalRecordsCount")+1;n.ejPager("option",{totalRecordsCount:t});this._isSheetInsert=!0;this.gotoPage(t,!0);this.setSheetFocus()}},_renameSheet:function(){var i=n(".e-currentitem"),r=t.buildTag("input#"+this._id+"_Sheet_RenamePanel","",{width:i.width()+5+"px"},{type:"input",value:i.text(),maxlength:"31"});i.hide()&&r.insertAfter(i).select().focus()&&(this._isSheetRename=!0);this.model.showRibbon&&this.XLRibbon._disableRibbonIcons()},deleteSheet:function(t){var i=n("#"+this._id+"_alertdlg"),r=this._getSheetNames(!0).length;if(r>1)this.getObjectLength(this._dataContainer.sheets[t])?(this._renderAlertDlgContent(i,"",this._getLocStr("SheetDeleteAlert"),"sheetDeleteActn",470),this._alertDialog.element.ejDialog("open")&&i.focus()):this._removeSheet(t);else{this._renderAlertDlgContent(i,"Alert",this._getLocStr("SheetDeleteErrorAlert"),"sheetDeleteErrorActn",377);this._alertDialog.element.ejDialog("open")&&i.focus();return}},hideSheet:function(t){var f=this.getActiveSheetIndex(),i=n.isNumeric(t)?t:this._getSheetIndexByName(t)||f,r=this._getSheetNames(!0),e=this._getSheetNames(),u=n("#"+this._id+"_alertdlg");r.length>1?(e[i-1].isVisible=!1,this.gotoPage(this._getNxtVisibleSheet(i,null,r))):(this._renderAlertDlgContent(u,"Alert",this._getLocStr("SheetDeleteErrorAlert"),null,377),this._alertDialog.element.ejDialog("open")&&u.focus())},unhideSheet:function(t){var r=this._getSheetNames(),i=n.isNumeric(t)?t:this._getSheetIndexByName(t);r[i-1].isVisible||(r[i-1].isVisible=!0,this.gotoPage(i))},_getNxtVisibleSheet:function(n,t,i){var r=this._getSheetNames(),u=r.length,f="<=",e=1,o=this._getSheetNames(!0),s=r[n-1].value===(i&&i[i.length-1].value||o[o.length-1].value);for((t||s)&&(u=0,f=">=",e=-1);this.operators[f](n,u);){if(r[n-1].isVisible)return n;n=n+e}},_renderSpreadSheetPager:function(){var t=n(document.createElement("div")),i={};return this.model.pageSettings.click=this._spreadSheetPagerClickHandler,this.model.pageSettings.totalRecordsCount=this.model.sheetCount,this.model.pageSettings.locale=this.model.locale,n.extend(i,this.model.pageSettings),i.currentPage=this.model.activeSheetIndex,i.masterObject=this,i.pageSize=1,this.setPager(t),t.ejPager(i),t.ejPager("refreshPager"),t.find(".e-parentmsgbar").remove(),t.find("a.e-PP").appendTo(t.find(".e-pagercontainer")),t.find("#NumericContainer").appendTo(t.find(".e-pagercontainer")),t.find("a.e-NP").appendTo(t.find(".e-pagercontainer")),t},_getPageCount:function(){var i=this.getPager(),f=0,c=i.width()-(i.find(".e-pagercontainer").width()-i.find("#NumericContainer").width()),e=i.find(".e-currentitem"),l=i.find(".e-link.e-numericitem:visible").not(".e-PP, .e-NP"),o=this._getSheetNames(),u=n(l[0]).data("index"),a=t.buildTag("canvas"),s=a[0].getContext("2d"),r,h;for(s.font=e.css("font-size")+" "+e.css("font-family"),r=0,h=this.model.pageSettings.pageCount;r<h;r++)if(!this.isUndefined(o[u-1])){if(f+=s.measureText(o[u-1].text).width+25,c<=f)return r;u++}return r},_spreadSheetPagerClickHandler:function(i){var o,e,s=!1,u=this.model.masterObject,f;if(!(u.XLComment._isCommentEdit||u.XLEdit._isEdit)||!(i.event&&(n(i.event.target).hasClass("e-pager")||n(i.event.target).hasClass("e-new"))||u.element.find(".e-field-validation-error").length))return(u.XLComment._isCommentEdit&&u.XLComment._updateCurCmntVal(),u.XLEdit._isEdit&&u.XLEdit.saveCell(),!t.isNullOrUndefined(i.event)&&(n(i.event.target).hasClass("e-prevpage")||n(i.event.target).hasClass("e-nextpage"))&&(i.currentPage=u._getNxtVisibleSheet(i.currentPage,n(i.event.target).hasClass("e-prevpage"))),f={activeSheet:u.getActiveSheetIndex(),gotoSheet:i.currentPage,newSheet:i.event&&n(i.event.target).hasClass("e-new")},u._trigger("pagerClick",f))?void 0:(i.currentPage=f.gotoSheet,!t.isNullOrUndefined(i.event)&&i.event.target.id.indexOf("_Sheet_RenamePanel")>-1||this._prevPageNo===i.currentPage&&i.event===r||u._isSheetRename&&!u._updateSheetNames(null,!1))?void 0:(f.newSheet&&(o=u.getPager(),e=o.ejPager("option","totalRecordsCount")+1,o.ejPager("option",{totalRecordsCount:e,currentPage:e}),i.currentPage=e,s=!0),u.model.allowFiltering&&u._filterClose(),u.gotoPage(i.currentPage,s),u._completeAction({reqType:"paging",sheetIndex:f.activeSheet,nSheetIndex:i.currentPage}),!1)},_initColumns:function(n,i){for(var u,f,r,o,e;i.length>0;)i=i.items[0];if(this.getSheet(n).columns.length===0&&i)for(u in i)i.hasOwnProperty(u)&&(typeof i[u]!="object"||i[u]instanceof Date)&&(f=i[u],this.getSheet(n).columns.push({field:u,type:f!=null?f.getDay?"date":typeof f:null}));else for(r=0,o=this.getSheet(n).columns.length;r<o;r++)t.isNullOrUndefined(this.getSheet(n).columns[r].type)&&(e=t.isNullOrUndefined(this.getSheet(n).columns[r].field)?null:t.getObject(this.getSheet(n).columns[r].field,i),this.getSheet(n).columns[r].type=e!=null?e.getDay?"date":typeof e:null);this.getSheet(n).colCount=this.getSheet(n).columns.length},_spreadsheetTemplate:function(t){return n("#"+t).render(this.data)},_createTemplateElement:function(t,i){var r=document.createElement("script");return r.id=(this._id+t+i.field+n.inArray(i,this.getSheet(t).columns)+"_Template").split(" ").join(""),r.type="text/x-jsrender",r.text=i.templateContent?i.templateContent:n(i.templateID).html(),n("body").append(r),n(i.templateID).hide(),r},_refreshSpreadSheetPager:function(){var t=this.getPager(),n={};this.getPager()==null||this.importSheet?(n.currentPage=this.getActiveSheetIndex(),n.totalRecordsCount=this.model.sheetCount):n.currentPage=this.getActiveSheetIndex();n.pageCount=this._getPageCount();t.ejPager("option",n).ejPager("refreshPager");this._updatePageContainer(t.find(".e-link"))},_updatePageContainer:function(t){for(var r=t.filter(".e-link.e-numericitem:visible").not(".e-PP, .e-NP"),u=this.model.sheets,i=0,f=r.length;i<f;i++)n(r[i]).text(u[n(r[i]).data("index")]._sheetName.text),u[n(r[i]).data("index")]._sheetName.isVisible||n(r[i]).hide()},_updateSheetNames:function(i,r){var l=this.getPager(),u,h,f=l.find(".e-currentitem"),e=this.model.sheets,s=n("#"+this._id+"_Sheet_RenamePanel"),o=n("#"+this._id+"_alertdlg"),c=!0;if(t.isNullOrUndefined(i)&&(i=s.val().trim()),r){s.remove()&&f.show();this.model.showRibbon&&this.XLRibbon._enableRibbonIcons();this._isSheetRename=!1;return}if(!i){this._renderAlertDlgContent(o,"Alert",this._getLocStr("SheetRenameEmptyAlert"),"sheetRenameActn");this._alertDialog.element.ejDialog("open")&&o.find("#"+this._id+"_dialog_alertOk").focus();return}for(u=1,h=e.length;u<h;u++)f.text()!==e[u]._sheetName.text&&i===e[u]._sheetName.text&&(c=!1);if(c)(e[f.data("index")]._sheetName.text=i)&&s.remove()&&f.show()&&(this._isSheetRename=!1),this._refreshSpreadSheetPager(),this.model.showRibbon&&this.XLRibbon._enableRibbonIcons();else{this._renderAlertDlgContent(o,"Alert",this._getLocStr("SheetRenameAlert"),"sheetRenameActn");this._alertDialog.element.ejDialog("open")&&o.find("#"+this._id+"_dialog_alertOk").focus();return}return!0},_getSheetIndexByName:function(n){for(var i=this._getSheetNames(),t=0,r=i.length;t<r;t++)if(i[t].text===n)return t+1;return!1},_removeSheet:function(n){var t=this.model.sheetCount,i=this._dataContainer.sheets;t>1&&(this._getAutoFillOptElem().appendTo(this.element),this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value).remove(),this.setActiveSheetIndex(t===this.getActiveSheetIndex()?n-1:n),this._swapSheetDtCntr(n,t),t in i&&delete i[t],this._sheets.splice(t,1),this.model.sheets.splice(t,1),t=--this.model.sheetCount,this.getPager().ejPager("option",{totalRecordsCount:t,pageCount:t}),this.gotoPage(this.getActiveSheetIndex(),!1),this._getAutoFillOptElem().appendTo(this._getContent(this.getActiveSheetIndex()).find(".e-content")),this._rebindScrollEvnt())},_rebindScrollEvnt:function(){for(var n=1;n<=this.model.sheetCount;n++)this._getContent(n).find(".e-content").off("scroll"),this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value).find(".e-headercontent").off("scroll"),this._refreshScrollerEvent(n)},_getSheetNames:function(n){for(var r=[],i=this.model.sheets,t=1,u=i.length;t<u;t++)(this.isUndefined(n)||(!n||i[t]._sheetName.isVisible)&&(n||!i[t]._sheetName.isVisible))&&r.push(i[t]._sheetName);return r},_initMoveCopyDlg:function(){var n=this._id+"_moveCopyDlg",i,r,f,e,o,s,u;i=t.buildTag("div#"+n,"",{display:"none"});r=t.buildTag("div#"+n+"_sheetContent",t.buildTag("label",this._getLocStr("Beforesheet"),"",{display:"table"}),{"margin-top":5,"margin-left":-6});s=t.buildTag("ul#"+n+"_list");r.append(s);u=t.buildTag("input#"+n+"_createcopy");r.append(u);u.ejCheckBox();u.parent().append(t.buildTag("label").text(this._getLocStr("CreateaCopy")).css({"margin-left":"6px","padding-top":"7px"}));i.append(r);o=t.buildTag("div#"+n+"_btndiv.e-dlgbtndiv");f=t.buildTag("input#"+n+"_okbtn.e-conok");e=t.buildTag("input#"+n+"_cnlbtn.e-concancel");f.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._moveCopyBtnClick,this,"ok")});e.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._moveCopyBtnClick,this,"cancel"),showRoundedCorner:!0,width:60});o.append(f).append(e);i.append(o);this.element.append(i);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("MoveorCopy"),width:280,height:340,cssClass:"e-ss-dialog"});s.ejListBox({dataSource:this._getSheetNames(),height:"197px",width:"263px",fields:{text:"text",value:"value"}})},_renderMoveCopyDlg:function(){var r=n("#"+this._id+"_moveCopyDlg"),t=n("#"+this._id+"_moveCopyDlg_list").data("ejListBox"),i=this._getSheetNames();i.push({text:this._getLocStr("MoveToEnd"),value:this._getLocStr("MoveToEnd")});r.ejDialog("open");t.model.dataSource=i;t.option("fields",{dataSource:i});t.unSelectAll();t.selectItemByIndex(0)},_initUnhideDlg:function(){var n=this._id+"_UnhideDlg",i,r,u,f,e,o;i=t.buildTag("div#"+n,"",{display:"none"});r=t.buildTag("div#"+n+"_sheetContent",t.buildTag("label",this._getLocStr("UnhideDlgText"),"",{display:"table"}),{"margin-top":5,"margin-left":-6});o=t.buildTag("ul#"+n+"_list");r.append(o);i.append(r);e=t.buildTag("div#"+n+"_btndiv.e-dlgbtndiv","",{"margin-top":5});u=t.buildTag("input#"+n+"_okbtn.e-conok");f=t.buildTag("input#"+n+"_cnlbtn.e-concancel");u.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._unhideBtnClick,this,"ok")});f.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._unhideBtnClick,this,"cancel"),showRoundedCorner:!0,width:60});e.append(u).append(f);i.append(e);this.element.append(i);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("UnhideSheet"),width:280,height:306,cssClass:"e-ss-dialog"});o.ejListBox({dataSource:this._getSheetNames(),height:"197px",width:"263px",fields:{text:"text",value:"value"}})},_renderUnhideDlg:function(){var r=n("#"+this._id+"_UnhideDlg"),t=n("#"+this._id+"_UnhideDlg_list").data("ejListBox"),i=this._getSheetNames(!1);i.length>0&&(r.ejDialog("open"),t.model.dataSource=i,t.option("fields",{dataSource:i}),t.unSelectAll(),t.selectItemByIndex(0))},_moveCopyBtnClick:function(i){switch(i){case"ok":var r,u,v,f,y=!1,s=2,o,e=n(this.element).find(".e-currentitem"),h=n("#"+this._id+"_moveCopyDlg_list").data("ejListBox"),c=n("#"+this._id+"_moveCopyDlg_createcopy").data("ejCheckBox"),l=h._selectedItemindex(),a=this.model.sheets;if(!c.isChecked()&&h._getItem(h._selectedItemindex()).text()===e.text()){n("#"+this._id+"_moveCopyDlg").ejDialog("close");this.setSheetFocus();return}for(u=1;u<a.length;u++)h._getItem(h._selectedItemindex()).text()===a[u]._sheetName.text&&(r=u),e.text()===a[u]._sheetName.text&&(o=u);if(c.isChecked()){for(e.text().match(".*[ ]+[(]+[0-9]+[)]$")===null?f=e.text()+" ("+s+")":e.text().lastIndexOf(" ")!==-1&&(s=parseInt(e.text().substring(e.text().lastIndexOf("(")+1,e.text().lastIndexOf(")"))),f=e.text().substring(0,e.text().lastIndexOf(" "))+" ("+s+")");!y;){for(f=f.substring(0,f.lastIndexOf(" "))+" ("+s+")",u=1,v=a.length;u<v;u++)f===a[u]._sheetName.text&&s++;s===parseInt(f.substring(f.lastIndexOf("(")+1,f.lastIndexOf(")")))&&(y=!0)}this._copySheetProcess(o,f);o=this.model.sheetCount;t.isNullOrUndefined(r)&&(r=o)}else!t.isNullOrUndefined(r)&&r>o&&(r=r-1);if(t.isNullOrUndefined(r)&&(r=l),!c.isChecked()&&r===o){n("#"+this._id+"_moveCopyDlg").ejDialog("close");this.setSheetFocus();break}this._swapSheetDtCntr(o,r);n("#"+this._id+"_moveCopyDlg").ejDialog("close");r<=o&&(l=l+1);this.getPager().ejPager("option",{currentPage:l});this.gotoPage(l,!1);this._rebindScrollEvnt();c._unChecked();c._isChecked=!1;this.setSheetFocus();break;case"cancel":n("#"+this._id+"_moveCopyDlg").ejDialog("close")}},_unhideBtnClick:function(t){if(t==="ok"){var i=n("#"+this._id+"_UnhideDlg_list").data("ejListBox");this.unhideSheet(i.model.dataSource[i._selectedItemindex()].text)}n("#"+this._id+"_UnhideDlg").ejDialog("close")},_swapSheetDtCntr:function(n,t){var f=this._dataContainer.sheets,i=this.model.sheets,e=this._sheets,o=this._getLocStr("Sheet"),s=[{}],u,r,h;for(u in f)f.hasOwnProperty(u)&&(s[parseInt(i[u]._sheetName.value.replace(o,""))]=f[u]);for(i.splice(t,0,i.splice(n,1)[0]),e.splice(t,0,e.splice(n,1)[0]),r=1,h=i.length;r<h;r++)this._dataContainer.sheets[r]=s[parseInt(i[r]._sheetName.value.replace(o,""))]},_copySheetProcess:function(t,i){var s=this.getPager(),h=s.ejPager("option","totalRecordsCount")+1,u=this.model.sheets,r,e,o,f,c;for(s.ejPager("option",{totalRecordsCount:h,currentPage:h}),u.push(jQuery.extend(!0,{},u[t])),this._sheetCopy={isSheetCopy:!0,sheetContent:this._getContent(t).find(".e-table").clone(!0).get(0)},r=this.model.sheetCount+1,u[r]._sheetName.text=i,u[r]._sheetName.value=this._getLocStr("Sheet")+this._newSIndex,this._newSIndex++,this.setActiveSheetIndex(r),this._dataContainer.sheets[r]=n.extend(!0,{},this._dataContainer.sheets[t]),this._sheets[r]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null,_calcEngine:null},this._createSheets(r),this.model.sheetCount++,this._sheetCopy={isSheetCopy:!1,sheetContent:null},e=this._getContent(r).find(".e-commentcell"),f=0,c=e.length;f<c;f++)o=n(e[f]),o.removeClass("e-commentcell")&&this.XLComment.setComment(o,null,!1);this.XLSelection.selectRange(u[r]._startCell,u[r]._endCell)},_init:function(){if(t.support.stableSort=!1,this.element.attr("tabIndex",0),this.element.ejWaitingPopup(),this._renderPanel(),this._initialLoad=!0,this.model.allowImport&&this.model.importSettings.importUrl.length>0){var n=new FormData;n.append("Url",this.model.importSettings.importUrl);n.append("Password",this.model.importSettings.password);this["import"](n)}else this.model.sheets.splice(0,0,{}),this._renderSheets();this._initialLoad=!1;this._trigger("onLoadComplete",{model:this.model})},_renderPanel:function(){var i,n,r=this.model.scrollSettings;i=t.buildTag("div.e-spreadsheetpanel","",{height:r.height,width:r.width},{id:this._id+"GroupPanel"});this.setGroupPanel(i);n=t.buildTag("div.e-spreadsheetpanel","",{height:r.height,width:r.width},{id:this._id+"MainPanel"});i.append(n);this.setMainPanel(n);n=t.buildTag("div.e-spreadsheetactpanel","",{height:r.height,width:this.model.apWidth,display:"none"},{id:this._id+"ActivationPanel"});i.append(n);this.element.append(i);this.setActivationPanel(n)},displayActivationPanel:function(n){var f,i=this.getActiveSheetIndex(),t=this.getActivationPanel(),u=this.model.scrollSettings;if(n==r)t.is(":visible")&&t.hide()&&this._setSheetWidthHeight(i,{width:u.width,height:u.height},null,"resize");else if(f=this.getSheet(i).rangeSettings[n],f.showPanel){if(this._trigger("beforePanelOpen",{activationPanel:t,range:f,sheetIndex:i}))return;t.show();this._setSheetWidthHeight(i,{width:u.width-this.model.apWidth,height:u.height},null,"resize");t.width(this.model.apWidth).height(this.getMainPanel().height())}},_renderSheets:function(){var i=1,n=this.model;for(this.element.width(n.scrollSettings.width),this.element.height(n.scrollSettings.height),this._initPrivateProperties(),this._updateFormulaCollection(),this._updateCellType(),this.model.allowDragAndDrop&&(this.XLDragDrap=new t.spreadsheetFeatures.dragAndDrop(this)),this.model.allowKeyboardNavigation&&(this.XLCellNav=new t.spreadsheetFeatures.cellNavigation(this)),this.model.allowFiltering&&(this.XLFilter=new t.spreadsheetFeatures.filter(this)),this.model.allowAutoFill&&(this.XLDragFill=new t.spreadsheetFeatures.dragFill(this)),this.model.allowCellFormatting&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(this)),this.XLRibbon=new t.spreadsheetFeatures.ribbon(this),this.model.allowConditionalFormats&&(this.XLCFormat=new t.spreadsheetFeatures.cFormat(this)),this.XLClipboard=new t.spreadsheetFeatures.clipboard(this),this.model.allowEditing&&(this.XLEdit=new t.spreadsheetFeatures.editing(this)),this.model.allowSearching&&(this.XLFndRp=new t.spreadsheetFeatures.findnreplace(this)),this.model.allowCharts&&(this.XLChart=new t.spreadsheetFeatures.chart(this)),this.model.exportSettings.allowExporting&&(this.XLExport=new t.spreadsheetFeatures.exporting(this)),this.model.scrollSettings.allowScrolling&&(this.XLScroll=new t.spreadsheetFeatures.scroller(this)),this.XLPrint=new t.spreadsheetFeatures.print(this),this.model.allowSorting&&(this.XLSort=new t.spreadsheetFeatures.sorting(this)),this.model.allowFreezing&&(this.XLFreeze=new t.spreadsheetFeatures.freezepane(this)),this.model.allowComments&&(this.XLComment=new t.spreadsheetFeatures.comments(this)),this.model.allowSelection&&(this.XLSelection=new t.spreadsheetFeatures.selection(this)),(this.model.allowCharts||this.model.pictureSettings.allowPictures)&&(this.XLShape=new t.spreadsheetFeatures.shape(this)),this.model.allowResizing&&(this.XLResize=new t.spreadsheetFeatures.resizing(this)),this.model.enableContextMenu&&(this.XLCMenu=new t.spreadsheetFeatures.contextmenu(this)),this.model.allowDataValidation&&(this.XLValidate=new t.spreadsheetFeatures.validation(this)),this.importSheet||(this._extendSpreadsheet(),this._addInitTemplate(),this.getMainPanel().append(this._renderDIV("e-spreadsheet-list","")),this._renderFormulaBar(),this.XLRibbon._setButtonHeights()),this._initializeStyleTag(),this._initCssRules(),this.importSheet||(n.showRibbon&&this.XLRibbon._renderRibbon(),n.pictureSettings.allowPictures&&this.XLRibbon._renderFUpload()),this._hideOtherControls(),this._setFormulaBar();i<=n.sheetCount;)this._createSheets(i),i++;if(n.allowSelection&&(this._createFocusElement(),this._initializeSelection()),this._wireEvents(),!this.importSheet)for(this._renderFooter(),this.model.allowFiltering&&(this.XLFilter._renderExcelFilter(),this.XLFilter._renderFilterDialogs()),this.XLClipboard._initCopyPaste(),n.allowDataValidation&&this.XLRibbon._initValDialog(),n.allowDataValidation&&this.XLRibbon._renderValDialog(),n.allowConditionalFormats&&this.XLRibbon._initCFDialog(),this.XLRibbon._renderDialog(),this.XLRibbon._initHLDialog(),this.XLRibbon._renderHLDialog(),n.allowSearching&&(this.XLRibbon._initFRDialog(),this.XLRibbon._renderFRDialog(),this.XLRibbon._initGoToDialog(),this.XLRibbon._renderGoToDialog()),this._initMoveCopyDlg(),this._initUnhideDlg(),this._renderInsertDeleteDialog(),this._renderAlertdlg(),this.XLChart._renderChartRangeDialog(),n.enableContextMenu&&this.XLCMenu._initCMenuFooter(),i=1;i<=n.sheetCount;)n.sheets[i].rangeSettings.dataSource&&this.updateRange(i,n.sheets[i].rangeSettings),i++;this._alignFormulaBar(this.element.find(".e-formulabar").width());this.clearUndoRedo();this.XLRibbon._disableButtons(["clearfilter"],"ejButton")},_extendSpreadsheet:function(){var i=t.spreadsheetFeatures,r=t.Spreadsheet.prototype;i.math&&n.extend(r,i.math)},_createSheets:function(n){var r,e,c,o={},s=this.model,i=this.getSheet(n),u=s.scrollSettings,f=i._sheetName.value,h=this.element.find("#"+this._id+"_"+f);this._trigger("onLoad");this.model.rowCount=this.model.sheets[n].rowCount;this.model.columnCount=this.model.sheets[n].colCount;this._calculateRowAndColumnCount(n);this.model.sheets[n].rowCount=this.model.rowCount;this.model.sheets[n].colCount=this.model.columnCount;i.dataSource&&!this._sheetCopy.isSheetCopy&&(i._isTemplate=!0,this.importSheet||(i.rowCount=i.dataSource.length),i.columns.length*i.columnWidth<u.width&&(c=u.width/i.columns.length-1,i.columnWidth=c));this._sheetCopy.isSheetCopy||this._addTemplate(n);r=h.length===1?h:t.buildTag("div.e-sheet ","",{},{id:this._id+"_"+f});r.append(this._renderHeader(n));r.append(this._renderContent(n));h.length<1&&this.element.find(".e-spreadsheet-list").append(r);o.width=u.width;o.height=u.height;this._setSheetWidthHeight(n,o,null,"refresh");s.enableContextMenu&&this.XLCMenu._initContextMenu();s.allowEditing&&this.XLEdit._processEditing();n!==this.getActiveSheetIndex()&&r.hide();e=CalcEngine.createSheetFamilyID();this._sheets[n]._calcEngine=new CalcEngine(this,e);this._sheets[n]._calcEngine.setUseDependencies(!0);this._sheets[n]._calcEngine.registerGridAsSheet(f,f,e);this._initializePicture(n)},_hideOtherControls:function(){n("#"+this._id+"_Ribbon_CElement").hide();n("#"+this._id+"_Ribbon_Paste").hide();n("#"+this._id+"_Ribbon_Border").hide();n("#"+this._id+"_Ribbon_Merge").hide();n("#"+this._id+"_CFormat").hide();n("#"+this._id+"_formatastable").hide();n("#"+this._id+"_cellstyles").hide();n("#"+this._id+"_Ribbon_SortFilter").hide();n("#"+this._id+"_Ribbon_Clear").hide();n("#"+this._id+"_Ribbon_ColumnChart").hide();n("#"+this._id+"_Ribbon_BarChart").hide();n("#"+this._id+"_Ribbon_Validation").hide();n("#"+this._id+"_Ribbon_PageSize").hide();n("#"+this._id+"_Ribbon_FPane").hide();n("#"+this._id+"_Ribbon_Ins").hide();n("#"+this._id+"_Ribbon_Del").hide();n("#"+this._id+"_Ribbon_FindRep").hide();n("#"+this._id+"_Ribbon_PastePic").hide();n("#"+this._id+"_Ribbon_PictureBorder").hide();n("#"+this._id+"_ctxtmenu").hide();n("#"+this._id+"_Ribbon_AutoSum").hide();n("#"+this._id+"_Ribbon_ResetPic").hide();n("#"+this._id+"_Ribbon_PictureBorder").hide();n("#"+this._id+"_Ribbon_StockChart").hide();n("#"+this._id+"_Ribbon_LineChart").hide();n("#"+this._id+"_Ribbon_AreaChart").hide();n("#"+this._id+"_Ribbon_PieChart").hide();n("#"+this._id+"_Ribbon_ScatterChart").hide()},_addSheet:function(n){this._sheetSettings(n);this._sheets[n]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null};this._dataContainer.sheets[n]={};this._createSheets(n);this._newSIndex++;this.model.sheetCount++},addNewSheet:function(){this.element.find(".e-pager .e-new").click()},_createFocusElement:function(){this.setFocusTopElem(n("<div class='e-focustop e-hide' ><\/div>"));this.setFocusRightElem(n("<div class='e-focusright e-hide' ><\/div>"));this.setFocusBottomElem(n("<div class='e-focusbottom e-hide' ><\/div>"));this.setFocusLeftElem(n("<div class='e-focusleft e-hide' ><\/div>"))},_createAutoFillElement:function(){var i,r=this._getContent(this.getActiveSheetIndex()).find(".e-content");this.model.allowAutoFill&&(i=n("<div class='e-autofill e-hide'><\/div>"),r.append(i),this.setAutoFillElem(i));this.model.autoFillSettings.showFillOptions&&(this.element.append(t.buildTag("ul","",{width:"auto"},{id:this._id+"_ctxtmenu"})),i=n("<div class='e-splitspan e-hide' title='Auto Fill Options'><button id="+this._id+"_dragfilloptionbtn><\/button><\/div>"),r.append(i),this._setAutoFillOptElem(i));this._initializeSplitButton()},_initializeSplitButton:function(){n("#"+this._id+"_dragfilloptionbtn").ejSplitButton({size:"normal",contentType:"imageonly",targetID:this._id+"_ctxtmenu",prefixIcon:"e-uiLight e-login",isSeparator:!1,buttonMode:t.ButtonMode.Dropdown,imagePosition:t.ImagePosition.ImageLeft,arrowPosition:t.ArrowPosition.Right,fields:{dataSource:this._fillOptionMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},beforeOpen:n.proxy(this.XLDragFill._autoFillClick,this),itemSelected:n.proxy(this.XLDragFill._autoFillOptionClick,this)})},_renderFormulaBar:function(){this.element.prepend("<div id="+this._id+"_formulabar class='e-formulabar' ><div id="+this._id+"_indexbox class='e-indexbox' ><\/div><div class='e-inputbox' ><input id="+this._id+"_inputbox type='text' /><\/div><\/div>");this.XLEdit._renderAutoComplete(n("#"+this._id+"_inputbox"),"",24);this._alignFormulaBar(this.element.find(".e-formulabar").width());this.model.allowFormulaBar||this.hideFormulaBar()},_alignFormulaBar:function(n){n=parseInt(n);var i,r,t;i=n/10;r=n-(i+26);t=this.element.find(".e-inputbox");t.hide();t.width(Math.floor(r));this.element.find(".e-indexbox").width(Math.floor(i));t.show()},_setFormulaBar:function(){this._setInputBox(n("#"+this._id+"_inputbox"));this._setIndexBox(n("#"+this._id+"_indexbox"))},hideFormulaBar:function(){n("#"+this._id+"_formulabar").hide()},showFormulaBar:function(){this.model.allowFormulaBar&&n("#"+this._id+"_formulabar").show();this.updateFormulaBar()},updateFormulaBar:function(){var i,r,u=this.getActiveSheetIndex(),n=this.getSheet(u)._activeCell;r=this.getRangeData([n.rowIndex,n.colIndex,n.rowIndex,n.colIndex],!1,["value","value2"])[0];i=t.isNullOrUndefined(r.value)?"":r.value;this._isDateTime(i)&&(i=r.value2);this._getInputBox().val(i);this._getIndexBox().html(this._getAlphaRange(u,n.rowIndex,n.colIndex,n.rowIndex,n.colIndex))},_initializeSelection:function(){var u,i=this.model,f=this.getActiveSheetIndex(),n=this.getSheet(f),r=this._getContent(f).find(".e-content"),e=i.selectionSettings.selectionType,o=t.Spreadsheet.SelectionType;r.append(this.getFocusTopElem(),this.getFocusRightElem(),this.getFocusBottomElem(),this.getFocusLeftElem());!n._importRendered&&n._selectedCells.length?(this.XLSelection._refreshBorder(),u=this.getCell(n._activeCell.rowIndex,n._activeCell.colIndex),this._updateRibbonTab(u[0])):e===o.Row?this.XLSelection.selectRows(n._startCell.rowIndex,n._endCell.rowIndex):e===o.Column?this.XLSelection.selectColumns(n._startCell.colIndex,n._endCell.colIndex):this.XLSelection.selectRange(n._startCell,n._endCell);this.getAutoFillElem()||this._createAutoFillElement();i.allowAutoFill&&(this.getAutoFillElem().appendTo(r),this.XLDragFill.positionAutoFillElement());i.autoFillSettings.showFillOptions&&(this._getAutoFillOptElem().appendTo(r),this.XLDragFill.hideAutoFillOptions())},_updateRibbonTab:function(t){var i,f=t.className,u=this.element.find(".e-ribbon .e-contextul .e-active a"),r=u.length;if(r){for(i=n("#"+this._id+"_Ribbon").data("ejRibbon");r--;)i.hideTab(u[r].text);i.option({selectedItemIndex:1})}this._hasClass(t,"e-table")&&this.XLRibbon._designTabUpdate(this._getTableID(f),t)},_updateCellType:function(){var n,i=t.Spreadsheet.CellType;for(n in i)this._dataContainer.cellType.push(i[n])},_initializeStyleTag:function(){if(!document.getElementById(this._id+"_sscustomformat")){var r,n,i,t=0;for(i="b:#FFC7CE;c:#82012A;f:calibri;s:14px/b:#C6EED2;c:#0A7043;f:calibri;s:14px/b:#FEEC9B;c:#826717;f:calibri;s:14px/f:Calibri;s:14px;w:bold;v:top/f:calibri;s:18px/b:#DDE5F6;f:calibri;s:14px/b:#FDE0D2;f:calibri;s:14px/b:#EEEEEC;f:calibri;s:14px/b:#FEF4CD;f:calibri;s:14px/b:#9CC0E7;f:calibri;s:14px/b:#F9AD7B;f:calibri;s:14px/b:#C9C9C9;f:calibri;s:14px/b:#FED965;f:calibri;s:14px/b:#559AD9;c:#FFFFFF;f:calibri;s:14px/b:#EB7E2F;c:#FFFFFF;f:calibri;s:14px/b:#A5A5A5;c:#FFFFFF;f:calibri;s:14px/b:#FDBF01;c:#FFFFFF;f:calibri;s:14px".split("/"),r=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],n=document.createElement("style"),n.setAttribute("id",this._id+"_sscustomformat"),n.type="text/css",r.appendChild(n);t<i.length;)this.XLFormat._createFormatClass(this._getStyleAsJSON(i[t])),t=t+1}},_getStyleAsJSON:function(n){var t,i=0,r={},u={b:"background-color",c:"color",f:"font-family",s:"font-size",w:"font-weight",v:"vetical-align",bo:"border"};for(n=n.split(";");i<n.length;)t=n[i].split(":"),r[u[t[0]]]=t[0]==="bo"?this.XLRibbon._getBorderObj(t[1].split("-")[0],t[1].split("-")[1]):t[1],i=i+1;return r},_updateFormulaCollection:function(){var n,i=(new CalcEngine).getLibraryFunctions(),t=[];for(n in i.items)t.push({text:"="+n,display:n});this._formulaCollection=t},_renderScroller:function(n,t){this.model.sheets[n]._frozenRows>0&&this.XLScroll._getRowHeights(n);this.model.sheets[n]._frozenColumns>0&&this.XLScroll._getColWidths(n);this.XLScroll._createScroller(n,t);this._refreshScrollerEvent(n)},_refreshScrollerEvent:function(i){this._getContent(i).find(".e-content").scroll(t.proxy(function(t){this._getJSSheetHeader(i).find(".e-headercontent").scrollLeft(n(t.currentTarget).scrollLeft());this._getJSSheetRowHeaderContent(i).scrollTop(n(t.currentTarget).scrollTop())},this));this.element.find("#"+this._id+"_"+this.model.sheets[i]._sheetName.value).find(".e-headercontent").scroll(t.proxy(function(t){var r=n(t.currentTarget);this._getContent(i).find(".e-content").first().scrollLeft(r.scrollLeft())},this))},_rClickHandler:function(){t.isNullOrUndefined(this._excelFilter)||(this.XLFilter._isSearchEdit=!1,this._excelFilter.closeXFDialog())},_cellClick:function(i){var e,r=i.target,o=this.getActiveSheetIndex(),u,s,f;if(i.target.tagName==="TD"&&n(i.target).parents("div")[0].className==="e-content"){if(u=r.cellIndex,s=n.inArray(n(r).closest("tr").get(0),this.getRows(o)[1]),f=this.getSheet(o).columns[u],e={columnName:f.field,value:n(r).data("value"),columnIndex:u,rowIndex:s,columnObject:f,cell:r,eventArgs:i,event:i,target:i.target},this._trigger("cellClick",e))return}else if(!t.isNullOrUndefined(n(i.target).parents("div"))&&n(i.target).parents("div")[0].className==="e-content"&&(r=n(i.target).parents("td").get(0),!t.isNullOrUndefined(r)&&(u=r.cellIndex,s=n.inArray(n(r).closest("tr").get(0),this.getRows(o)[1]),f=this.getSheet(o).columns[u],e={columnName:f.field,value:n(r).data("value"),columnIndex:u,rowIndex:s,columnObject:f,cell:r,eventArgs:i,event:i,target:i.target},this._trigger("cellClick",e))))return},_wireEvents:function(){var r=this.element,i=t.eventType,u=this._id;this._on(r,i.mouseDown,".e-ribbon, .e-spreadsheetcontentcontainer .e-vscroll, .e-spreadsheetcontentcontainer .e-hscroll",this._rClickHandler);this._on(r,i.mouseDown,".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel",this._mouseDownHandler);this._on(r,"keydown",this._keyDownHandler);this._on(r,"click",".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel, .e-ss-object",this._cellClick);this._on(r,"dblclick",".e-spreadsheetcontentcontainer,.e-spreadsheetheader,.e-spreadsheetrowheader",this._recorddblClickHandler);this._on(r,i.mouseMove,this._mouseMove);this._on(r,i.mouseUp,this._sheetMouseUp);this.model.allowResizing&&this._on(r,i.mouseLeave,".e-spreadsheetrowheader,.e-spreadsheetheader",this._mouseLeave);this._on(r,i.click,".e-ssfiltered, .e-ssfilter, .e-ssfiltered-asc, .e-ssfilter-asc, .e-ssfiltered-dsc, .e-ssfilter-dsc",this._filterDownHandler);this._on(r,i.mouseDown,".e-ssddl",this._ddlopen);this._on(r,"mouseover",".e-rowcell",this._cellHoverHandler);this._on(this._getInputBox(),"input",this.XLEdit._formulaBoxInputChange);this._on(n("#"+u+"_cellstyles"),i.click,this._cellStyleClick);this._on(n("#"+u+"_formatastable"),i.click,this._formatAsTableClick);this._on(n("#"+u+"_nmuseinformula"),i.click,".e-nmuseinformularow",this._useInFormulaClick);this.element.find(".e-spreadsheet-list").bind("mousewheel DOMMouseScroll",n.proxy(this.XLScroll._spreadMouseWheel,this.XLScroll));this._on(n("#"+u+"picturecolor"),i.mouseMove,this.XLRibbon._pictureColorOpen);this._on(n("#"+u+"_Ribbon_PictureBorder").find(".picturecolor"),i.mouseMove,this.XLRibbon._pictureColorClose);this._on(n("#"+u+"_Ribbon_PictureColor_popup"),i.click,this.XLRibbon._pictureColorClose);this._on(n(".e-menu .e-chartcontent .e-chartcell"),i.click,this._chartClickHandler);this._on(n("#"+u+"_allchart").find(".e-chartimg"),i.click,this._allChartType);this.model.scrollSettings.isResponsive&&n(window).bind("resize",n.proxy(this._spreadsheetonresize,this))},_allChartType:function(t){n("#"+this._id+"_allchart").find(".e-chartimg").removeClass("e-chartselect");n(t.target).addClass("e-chartselect")},_spreadsheetonresize:function(){var t=this.getActiveSheetIndex(),n,i=this.getActivationPanel();this.element.find(".e-inputbox").hide();n={width:this.getMainPanel().width(),height:this.model.scrollSettings.height};n.width=i.is(":visible")?n.width-this.model.apWidth:n.width;this._setSheetWidthHeight(t,n,null,"resize");this.element.find(".e-inputbox").show();this.XLScroll._scrollSelectedPosition(t,this.getActiveCell())},_chartClickHandler:function(t){var i=n(t.target),r=n(t.target).data();i.parents().eq(1).hide();this.XLChart.createChart(null,r)},_useInFormulaClick:function(t){var i=this,u=i.getActiveSheetIndex(),r=i.getActiveCellElem(u)[0];i.XLEdit.editCell(r.parentNode.rowIndex,r.cellIndex,!0);n("#"+i._id+"_"+i.XLEdit._EditCellDetails.fieldName).val("="+t.target.textContent);n("#"+i._id+"_nmuseinformula").hide()},_formatAsTableClick:function(t){var u,i=this,r=t.target,f="open",o=n("#"+i._id+"_alertdlg"),s=i.getSheet(i.getActiveSheetIndex()),e=s._selectedCells;r.className.indexOf("e-customaction")>-1?(n("#"+i._id+"_custfatdlg").find("input").val(""),n("#"+i._id+"_custfatdlg").ejDialog(f),n("#"+i._id+"_formatastable").hide(),n("#"+i._id+"_custfattablename").focus().setInputPos(0)):r.parentNode.className==="e-formatastablecell"&&(u=i.getCell(e[0].rowIndex,e[0].colIndex)[0].className,u.indexOf("e-table")>-1?(i.XLFormat._formatAsTableStyle=n(r.parentNode).data(),i.XLFormat._createTable(i._getTableID(u),i.XLFormat._formatAsTableStyle)):e.length>1?(n("#"+i._id+"_fatnamedlg").ejDialog(f),document.getElementById(i._id+"_fatname").value="Table "+i.getObjectLength(s._tableManager),n("#"+i._id+"_fatname").focus().setInputPos(n("#"+i._id+"_fatname").val().length),i.XLFormat._formatAsTableStyle=n(r.parentNode).data()):(i._renderAlertDlgContent(o,"Alert",i._getLocStr("FormatAsTableAlert"),"",445),o.ejDialog(f)),n("#"+i._id+"_formatastable").hide())},_getTableID:function(n,t){var i,r=this.getSheet(this.getActiveSheetIndex())._tableManager;if(t){for(i in r)if(t===r[i].name)return Number(i)}else for(i in r)if(n.indexOf("e-table"+i)>-1)return Number(i)},_cellStyleClick:function(t){var u,i=t.target.className,f=this.XLFormat.getFormatClass(i),r={sheetIndex:this.getActiveSheetIndex(),reqType:"cell-styles",beforeFormat:this.XLFormat.getHashCodeClassAsArray()};i.indexOf("e-customaction")>-1?(u=document.getElementsByClassName("e-customcellstyleproperty"),[5,6,7].forEach(function(n){u[n].style.display="none"}),this.XLRibbon._resetCustomCellStyle(),n("#"+this._id+"_customcellstyledialog").ejDialog("open"),n("#"+this._id+"_customcellstylename").val("Style "+(n("#"+this._id+"_cellstyles").find("div.e-customcellstyle").children().length+1)),n("#"+this._id+"_customcellstylename").focus().setInputPos(n("#"+this._id+"_customcellstylename").val().length)):i.indexOf("e-cellstylecell")>-1&&(f.indexOf("e-format")>-1?this.XLFormat.updateUniqueFormat(f):this.XLFormat.clearFormat());r.afterFormat=this.XLFormat.getHashCodeClassAsArray();r.range=this.model.sheets[this.getActiveSheetIndex()].selectedRange;this.isUndoRedo||this._completeAction(r);n("#"+this._id+"_Ribbon_cellstyles").data("ejSplitButton")._hidePopup()},_cellHoverHandler:function(n){var t={target:n.target};this._trigger("onCellHover",t)},_filterDownHandler:function(t){t.target.className.indexOf("e-ssfilter")>-1&&(this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")?this._excelFilter.closeXFDialog():this.XLFilter._filterClickHandler(t))},_mouseDownHandler:function(i){var s,h="e-ss-object",r=i.target,e=n(r),f=this.getActiveSheetIndex(),c=this.getSheet(f),l,a=this,y=!0,v=n("#"+this._id+"_Ribbon").data("ejRibbon"),p=!0,u,o,w;if((this.XLChart._isChartBorderDrawn&&this.XLChart._clearChartRange(this._arrayAsString(this._chartBorder)),this._isPrevCMenu&&(this._isPrevCMenu=!1),(this.model.pictureSettings.allowPictures||this.model.allowCharts)&&(e.hasClass(h)||n(e).parents("."+h).length)?(e.hasClass(h)||(r=i.target=n(e).parents("."+h)[0]),this.XLShape._shapeMouseDown(i)):(this.XLRibbon._toggleFormatTab(),p=!1,this.XLShape._shapeROStart||this.XLShape._shapeRSStart||this._getContent(f).find(".e-ss-activeimg").removeClass("e-ss-activeimg e-ss-imgcresize e-ss-imgrresize")),s=r.className,this.model.showRibbon&&r.id.indexOf("chart")>-1?this.XLRibbon._chartDesignTabUpdate(n(r)):this.model.showRibbon&&v.model.selectedItemIndex===this.XLRibbon._getTabIndex("cdesign")&&this.XLRibbon._toggleChartDesignTab(),!this.XLEdit._isEdit||!(n(this.getCell(c._activeCell.rowIndex,c._activeCell.colIndex)).index(n(r).parents("td"))>-1))&&(this.model.allowSearching&&this.element.find(".e-goto-blank").length>0&&this.element.find(".e-goto-blank").removeClass("e-goto-blank"),this.model.allowDragAndDrop&&this.XLDragDrap._isDragAndDropStart&&s!=="e-autofill"&&this.XLDragDrap._dMouseDown(i),this.model.allowResizing&&!this.XLEdit._isEdit&&(n(r).hasClass("e-headercelldiv")||n(r).hasClass("e-headercell")?this.XLResize._headerMouseDown(i):n(r).hasClass("e-rowheader")?this.XLResize._rowMouseDown(i):n(r).hasClass("e-spreadsheetactpanel")&&this.XLResize._apMouseDown(i)),!(n(r).parents("div.e-spreadsheetactpanel").length>0))){if(y=this.XLEdit._isEdit?(this._isFormulaSuggestion||!this.XLEdit._isFormulaEdit)&&this.XLEdit.saveCell():!0,!y&&!this.XLEdit._isFormulaEdit)return!1;r.tagName==="A"?(u=e.parent("td")[0],o={rowIndex:u.parentNode.rowIndex,colIndex:u.cellIndex},c._activeCell=o,this.XLSelection.selectRange(o,o),i.which!==3&&this._hlClick(this.XLEdit.getPropertyValue(o.rowIndex,o.colIndex,"hyperlink",f))):(i.button!==2||i.which!==3||this.getSheetElement(f).find(".e-selected, .e-colselected .e-headercelldiv, .e-rowselected").index(r)===-1)&&(p||!t.isNullOrUndefined(this.XLDragDrap)&&this.XLDragDrap._allowDragAndDrop||this.XLResize._resizeStart||e.hasClass("e-comment-txtarea")||this.XLSelection._selectionMouseDownHandler(i));this.model.allowFiltering&&this._filterClose();this._setRowHdrHeight(f,this.model.sheets[f]._activeCell.rowIndex);r.tagName==="TD"&&n(r).parents("div")[0].className==="e-content"&&this.displayActivationPanel(this.XLEdit.getPropertyValueByElem(n(r),"range"));r.tagName==="TD"&&r.className.indexOf("e-rowheader")<0&&(w=n("#"+this._id+"ddl").val(),u=this._ddlCell,t.isNullOrUndefined(u)||(u.find("span#"+this._id+"ddl_wrapper").remove(),n("#"+this._id+"ddlspan").remove(),n("#"+this._id+"ddl").remove(),u.text(w),this.XLEdit.updateCell(u,u.text()),this._ddlCell=null));t.isNullOrUndefined(this.XLEdit.getPropertyValue(n(r).closest("tr").index(),n(r)[0].cellIndex,"rule",f))||this._setddlCell(i);this.model.allowComments&&!e.hasClass("e-pager")&&this.getSheetElement(f).find(".e-commentcell").length>0&&this.XLComment._commentMouseDownHandler(i);this._isSheetRename&&this._updateSheetNames(null,!1);this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup");s.indexOf("e-rowcell")>-1&&s.indexOf("e-table")>-1?(l=a._getTableID(s),a.isNumber(l)&&a.XLRibbon._designTabUpdate(l,r)):this.model.showRibbon&&(v.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||v.isVisible("Design"))&&this.XLRibbon._toggleDesignTab(r)}},_setddlCell:function(i){var w,a,v=[],b,l,o,y,s=this.getActiveSheetIndex(),k,e,r,c,f,u,p,h;if(t.isNullOrUndefined(i)||i.type!=="mousedown"?(o=this.getSheetElement(s).find(".e-activecell")[0],y=n("#"+this._id+"GroupPanel").find("div.e-content")[0]):(o=i.target,y=i.currentTarget),l=this.XLEdit.getPropertyValue(n(o).closest("tr").index(),o.cellIndex,"rule",s),l&&l.type==="list"){if(this._ddlCell=n(o),b=l.customVal.split("_"),e=b[0],f=[],e.startsWith("=")&&e.indexOf(",")<0){for(u=n.trim(e.replace("=","")),u.indexOf("!")>-1&&(p=u.split("!"),s=this._getSheetIndexByName(p[0]),u=p[1]),u.indexOf("$")>-1&&(u=u.split("$").join("")),u.indexOf(":")<0&&(u=u+":"+u),range=this.getRangeIndices(u),h=this.getRange(range[0],range[1],range[2],range[3]),r=0,c=h.length;r<c;r++)!t.isNullOrUndefined(n(h[r]))&&this.XLEdit.getPropertyValueByElem(n(h[r]),null,s)&&f.push(this.XLEdit.getPropertyValueByElem(n(h[r]),null,s));f.length||f.push(e)}else e.indexOf(",")>-1?f=e.split(","):(f=[],f.push(e));for(r=0,c=f.length;r<c;r++)v[r]={id:r+1,text:f[r].toString()},v[r].text===this._ddlCell.text()&&(w=r);u=this._ddlCell.text();this._ddlCell.text("");a={top:this._ddlCell[0].offsetTop,left:this._ddlCell[0].offsetLeft};k=this._ddlCell.height()-16;n(o).append('<input id="'+this._id+'ddl" type="text" style="line-height:0px;text-align:end;padding-left:0px;" value='+u+">");y.insertAdjacentHTML("beforeEnd","<span id='"+this._id+"ddlspan' class='e-icon e-ssddl e-spanddl e-ddlspan' role='button'><\/span>");n("#"+this._id+"ddlspan").css({top:a.top+k,left:a.left+this._ddlCell.width()+3});n("#"+this._id+"ddl").ejDropDownList({dataSource:v,fields:{id:"Types",text:"text",value:"text"},height:"17",width:"auto",beforePopupShown:n.proxy(this._drppopupshow,this),change:n.proxy(this._changeddl,this)});n("#"+this._id+"ddl").ejDropDownList("option","selectedItemIndex",w);n("#"+this._id+"ddl_dropdown").remove();n("#"+this._id+"ddl_container").removeClass("e-in-wrap e-box")}},_drppopupshow:function(){n("#"+this._id+"ddl_popup").css({width:this.getActiveCellElem().width()+20,"font-size":"11px"})},_ddlPosition:function(){var t={top:this._ddlCell[0].offsetTop,left:this._ddlCell[0].offsetLeft};n("#"+this._id+"ddlspan").css({top:t.top+this._ddlCell.height()-16,left:t.left+this._ddlCell.width()+3})},_changeddl:function(t){n("#"+this._id+"ddl").parents("td").value=t.selectedText},_ddlopen:function(i){var r=n("#"+this._id+"ddl").data("ejDropDownList");i.stopPropagation();t.isNullOrUndefined(r)||(r._isPopupShown()?r._hideResult():(r._showResult(),n("#"+this._id+"ddl_popup").css({width:this.getActiveCellElem().width()+20,"font-size":"11px"})))},_mouseMove:function(i){var r=n(i.target);this.model.allowResizing&&(this.XLResize._resizeType==="Col"||r.hasClass("e-headercelldiv")||r.hasClass("e-headercell")||r.hasClass("e-reSizeColbg"))&&!this.XLEdit._isEdit?this.XLResize._cMouseMove(i):this.model.allowResizing&&(this.XLResize._resizeType==="Row"||r.hasClass("e-rowheader")||r.hasClass("e-reSizeRowbg"))&&!this.XLEdit._isEdit?this.XLResize._rMouseMove(i):this.model.allowResizing&&(this.XLResize._resizeType==="AP"||r.hasClass("e-spreadsheetactpanel")||r.parents("e-spreadsheetactpanel").length>0)?this.XLResize._apMouseMove(i):(this.model.pictureSettings.allowPictures||this.model.allowCharts)&&(r.hasClass("e-ss-object")||r.parents(".e-ss-object").length||this.XLShape._shapeROStart||this.XLShape._shapeRSStart||r.hasClass("e-ss-imgvisual"))&&this.XLShape._imgMouseMove(i);this.model.allowDragAndDrop&&t.spreadsheetFeatures.dragAndDrop&&r.hasClass("e-rowcell")&&!this.XLEdit._isEdit&&this._getJSSheetHeader(this.getActiveSheetIndex())[0].querySelector(".e-spreadsheetcolumnheader").className.indexOf("e-sheetselected")===-1&&this.XLDragDrap._dMouseMove(i);this.model.allowComments&&!this.XLComment._isCommentEdit&&this.getSheetElement(this.getActiveSheetIndex()).find(".e-commentcell").length>0&&this.XLComment._commentMouseMove(i)},_mouseLeave:function(){n(".e-ss-colresize, .e-ss-rowresize").removeClass("e-ss-colresize e-ss-rowresize")},_sheetMouseUp:function(i){if(this.XLResize._resizeType==="Col"?this.XLResize._cMouseUp(i):this.XLResize._resizeType==="Row"?this.XLResize._rMouseUp(i):this.XLResize._resizeType==="AP"&&this.XLResize._apMouseUp(i),this.model.allowDragAndDrop&&this.XLDragDrap._allowDragAndDrop&&this.XLDragDrap._dMouseUp(i),this.model.allowEditing&&this.XLEdit._isEdit&&i.target.id!==this._id+"_inputbox"){var u=this.getSheet(this.getActiveSheetIndex())._activeCell,r=this.getCell(u.rowIndex,u.colIndex).find(".e-ss-input");i.target.id===r[0].id||t.isNullOrUndefined(r)||r.focus().setInputPos(r.val().length)}this.model.allowComments&&this.XLComment._isCommentEdit&&this.getActiveCellElem().find("textarea").focus();this._isSheetRename&&n("#"+this._id+"_Sheet_RenamePanel").focus();this.model.pictureSettings.allowPictures&&this.XLShape._shapeMouseUp(i)},_keyDownHandler:function(i){var c=!0,e=!1,l=this.getActiveSheetIndex(),r,o,f,a=n("#"+this._id+"_Ribbon").data("ejRibbon"),s;if(this._getContent(l).find(".e-ss-activeimg").length&&(e=!0,s=document.activeElement.id,s.indexOf(this._id+"_pictureheight")<0&&s.indexOf(this._id+"_picturewidth")<0&&this.XLShape._imgKeyDown(i)),i.target.id.indexOf("_Custom")<0){if((i.stopImmediatePropagation(),this.model.allowFiltering&&this.XLFilter._isSearchEdit&&i.keyCode!==27)||(this._isSheetRename||this.XLEdit._isEdit||this.XLClipboard._copyPasteHandler(i),!e&&!this._isSheetRename&&!this.XLComment._isCommentEdit?this.model.allowEditing&&document.activeElement.id.indexOf("_inputbox")===-1&&this.XLEdit._editingHandler(i):this.XLCellNav._isNavigate=!1,this.model.allowSearching&&this.XLFndRp._fRKeyDownHandler(i),this._isFormulaSuggestion&&(i.keyCode===39||i.keyCode===37||i.keyCode===13)?this.XLEdit.saveCell():this.XLEdit._isFormulaEdit||i.keyCode!==9&&i.keyCode!==13&&i.keyCode!==37&&i.keyCode!==38&&i.keyCode!==39&&i.keyCode!==40||(c=this.XLEdit._isEdit&&this.XLCellNav._isNavigate?this.XLEdit.saveCell():!0),n(i.target).hasClass("e-field-validation-error")||i.target.id==this._id+"_Ribbon_font-family_wrapper"||i.target.id==this._id+"_Ribbon_cellformat_wrapper"||i.target.id==this._id+"_Ribbon_fontsize_wrapper"))return!0;if(!c&&!this.XLEdit._isFormulaEdit)return!1;this.model.allowKeyboardNavigation&&(e||this.XLComment._isCommentEdit||n(i.target).parents(".e-formulabar").length&&i.keyCode!==9&&i.keyCode!==13||this.XLCellNav._selectionKeyDownHandler(i),this._keyboardShortCuts(i));this._undoRedoOperation(i);this.XLEdit._isFormulaEdit&&i.keyCode===9&&!this.XLCellNav._canKeyBoardNavigate&&(this.XLCellNav._canKeyBoardNavigate=!0)}if(i.target.tagName==="DIV"&&!this.XLEdit._isEdit){var h=this.element.find("#"+this._id+"ddl"),v=h.val(),u=this._ddlCell;t.isNullOrUndefined(u)||(h.ejDropDownList("hidePopup"),u.find("span#"+this._id+"ddl_wrapper").remove(),this.element.find("#"+this._id+"ddlspan").remove(),h.remove(),u.text(v),this.XLEdit.updateCell(u,u.text()),this._ddlCell=null)}r=this.getActiveCellElem();f=!t.isNullOrUndefined(r)&&r.length?r[0].className:"";f.indexOf("e-rowcell")>-1&&f.indexOf("e-table")>-1?(o=this._getTableID(f),this.isNumber(o)&&this.XLRibbon._designTabUpdate(o,i.target)):this.model.showRibbon&&(a.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||a.isVisible("Design"))&&this.XLRibbon._toggleDesignTab(i.target);!r.length||this.XLEdit._isEdit||t.isNullOrUndefined(this.XLEdit.getPropertyValue(r.closest("tr").index(),r[0].cellIndex,"rule",l))||this._setddlCell(i);this._isSheetRename&&(i.keyCode===13||i.keyCode===9||i.keyCode===27)&&this._updateSheetNames(null,i.keyCode===27)},_recorddblClickHandler:function(t){var r,i;if(this.model.allowEditing){if(this.XLSelection._isOutsideBordering||this.XLSelection._isGridBordering)return r=this._getContent(this.getActiveSheetIndex()),r.addClass("e-ss-cursor"),r.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor"),this.XLSelection._isOutsideBordering=this.XLSelection._isGridBordering=!1,!1;if(!this.XLEdit._isEdit&&n(t.target).hasClass("e-rowcell")&&!n(t.target).hasClass("e-readonly")){if(n(".e-cdata").length&&n(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),i=n(t.target),i.closest("#"+this._id+"EditForm").length)return;this.XLEdit.editCell(n.inArray(i.closest("tr").get(0),this.getRows(this.getActiveSheetIndex())[1]),i.index(),!0);this.XLCellNav._isNavigate=!1}if((n(t.target).hasClass("e-headercell")||n(t.target).hasClass("e-headercelldiv"))&&this.XLResize._resizeToFitWidth(t),n(t.target).hasClass("e-rowheader")&&this.XLResize._resizeToFitHeight(t),this.XLSelection._isOutsideBordering||this.XLSelection._isGridBordering)return r=this._getContent(this.getActiveSheetIndex()),r.addClass("e-ss-cursor"),r.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor"),this.XLSelection._isOutsideBordering=this.XLSelection._isGridBordering=!1,!1;if(!this.XLEdit._isEdit&&n(t.target).hasClass("e-rowcell")&&!n(t.target).hasClass("e-readonly")){if(this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),i=n(t.target),i.closest("#"+this._id+"EditForm").length)return;this.XLEdit.editCell(n.inArray(i.closest("tr").get(0),this.getRows(this.getActiveSheetIndex())[1]),i.index(),!0);this._isNavigate=!1}}},_keyboardShortCuts:function(t){var i,o,r,u,f,s,e,h,c,l,a;if(this.XLEdit._isEdit)return!1;if(e=this.XLFormat,t.ctrlKey){switch(t.keyCode){case 65:t.preventDefault();i=this.getActiveSheetIndex();o=this.model.sheets[i];r=this.getActiveCellElem();u={rowIndex:0,colIndex:0};f={rowIndex:o.rowCount-1,colIndex:o.colCount-1};this.XLSelection.selectRange(u,f);this.getSheet(i)._startCell=u;this.getSheet(i)._endCell=f;this.XLCellNav._updateActiveCell(n(r[0]).closest("tr").index(),r[0].cellIndex);this.XLDragFill.positionAutoFillElement();break;case 66:t.preventDefault();this._toggleFontPrpty("bold");break;case 73:t.preventDefault();this._toggleFontPrpty("italic");break;case 75:t.preventDefault();this.model.allowHyperlink&&this._hlDlgOpen();break;case 85:t.preventDefault();this._toggleFontPrpty("underline");break;case 80:t.preventDefault();this.XLPrint.printSheet();break;case 79:t.preventDefault();this.XLEdit._isSheetsDirty()?(alertdlg=n("#"+this._id+"_alertdlg"),this._renderAlertDlgContent(alertdlg,"",this._getLocStr("ImportAlert"),"Open",470),this._alertDialog.element.ejDialog("open")&&alertdlg.focus()):n("#"+this._id+"_file .e-uploadinput").click();break;case 83:t.preventDefault();this.XLExport["export"]("Excel");break;case 112:t.preventDefault();h=n("#"+this._id+"_Ribbon").data("ejRibbon");this.model.showRibbon&&h.element.find(".e-rarrowup-2x").length?h.collapse():h.expand();break;case 32:t.preventDefault();i=this.getActiveSheetIndex();o=this.model.sheets[i];r=this.getActiveCellElem();c=r[0].cellIndex;u={rowIndex:0,colIndex:c};f={rowIndex:o.rowCount-1,colIndex:c};this.XLSelection.selectRange(u,f);this.getSheet(i)._startCell=u;this.getSheet(i)._endCell=f;this.XLCellNav._updateActiveCell(n(r[0]).closest("tr").index(),c);this.XLDragFill.positionAutoFillElement();break;case 49:t.preventDefault();n("#"+this._id+"_numberdlg_numbertab").ejTab("option","selectedItemIndex",0);this.XLRibbon._initFormatDialog();break;case 53:t.preventDefault();this._toggleFontPrpty("line-through");break;case 173:t.preventDefault();this._renderDeleteDialog();break;case 56:t.shiftKey||(t.preventDefault(),i=this.getActiveSheetIndex(),s=this.getSheet(i),this.hideColumn(s._startCell.colIndex,s._endCell.colIndex));break;case 57:t.shiftKey||(t.preventDefault(),i=this.getActiveSheetIndex(),s=this.getSheet(i),this.hideRow(s._startCell.rowIndex,s._endCell.rowIndex));break;case 220:t.shiftKey||(t.preventDefault(),this.XLFndRp._applyGotoRowDiff());break;case 90:t.preventDefault();break;case 89:t.preventDefault()}if(t.shiftKey)switch(t.keyCode){case 192:t.preventDefault();e.format({type:"general"});break;case 52:t.preventDefault();e.format({type:"currency"});break;case 53:t.preventDefault();e.format({type:"percentage"});break;case 54:t.preventDefault();e.format({type:"scientific"});break;case 51:t.preventDefault();e.format({type:"shortdate"});break;case 50:t.preventDefault();e.format({type:"time"});break;case 49:t.preventDefault();e.format({type:"number"});break;case 55:t.preventDefault();this.XLFormat.applyBorder({top:"1px solid #000000",right:"1px solid #000000",bottom:"1px solid #000000",left:"1px solid #000000"});break;case 173:t.preventDefault();this.XLFormat.applyBorder("noborder");break;case 61:t.preventDefault();this._renderInsertDialog();break;case 56:t.preventDefault();this.showColumn(this.getActiveSheetIndex(),this.getActiveCellElem()[0].cellIndex+1);break;case 57:t.preventDefault();this.showRow(n(this.getActiveCellElem()).closest("tr").index()+1);break;case 79:t.preventDefault();this.XLFndRp._applyGotoComments();break;case 220:t.preventDefault();this.XLFndRp._applyGotoColDiff()}}else if(t.shiftKey)t.keyCode===32?(t.preventDefault(),i=this.getActiveSheetIndex(),o=this.model.sheets[i],r=this.getActiveCellElem(),l=n(r[0]).closest("tr").index(),u={rowIndex:l,colIndex:0},f={rowIndex:l,colIndex:o.colCount-1},this.XLSelection.selectRange(u,f),this.getSheet(i)._startCell=u,this.getSheet(i)._endCell=f,this.XLCellNav._updateActiveCell(l,r[0].cellIndex),this.XLDragFill.positionAutoFillElement()):t.keyCode===113?(t.preventDefault(),this.XLComment.setComment()):t.keyCode===122&&(t.preventDefault(),this.addNewSheet());else if(t.keyCode===27){if(this.XLComment._isCommentEdit&&(this.XLComment._updateCurCmntVal(),this.XLComment._updateCmntRibIcons()),this.model.allowFiltering&&this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")){if(a=this._excelFilter._menuWrap.data("ejMenu"),a.element.find(".e-mhover li:visible").length){a._isContextMenuOpen||a._closeMenu();return}this.XLFilter._isSearchEdit=!1;this._excelFilter.closeXFDialog()}this.setSheetFocus()}},_triggerTBtnClick:function(t){var i=n("#"+t).data("ejToggleButton");i.buttontag.click()},_toggleFontPrpty:function(n){var u=this.getActiveCell(),f=this.XLFormat,t={style:{}},r,i,e;r=this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"format");e=!this.isUndefined(r)&&this.XLFormat.getFormatFromHashCode(r);i=n==="bold"?"font-weight":n==="italic"?"font-style":"text-decoration";e[i]===n?(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_"+n).ejToggleButton("option","toggleState",!1),t.style[i]="none",f.format(t)):(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_"+n).ejToggleButton("option","toggleState",!0),t.style[i]=n,f.format(t))},_getLocStr:function(n){return t.Spreadsheet.locale[this.model.locale]===r||t.Spreadsheet.locale[this.model.locale][n]===r?t.Spreadsheet.locale["en-US"][n]:t.Spreadsheet.locale[this.model.locale][n]},_textFormatting:function(n){switch(n){case"wrapText":this.setWrapText(null,"")}},setWrapText:function(i,r){var u,e,s=this.getActiveSheetIndex(),v=this.getSheet(s),o=0,y,g=this.getRows(s)[1],h=this.getRows(s)[0],p,l,w=v.rowsHeightCollection,a=0,b=this.getSheet(s)._wrapHtCollection,c,f,k,d;for(t.isNullOrUndefined(i)?u=v._selectedCells:(c=this.getRangeIndices(i),u=this.XLSelection._getSelectedRange({rowIndex:c[0],colIndex:c[1]},{rowIndex:c[2],colIndex:c[3]})),p=u.length>1?this._getProperAlphaRange(s,u[0].rowIndex,u[0].colIndex,u[u.length-1].rowIndex,u[u.length-1].colIndex):this._getAlphaRange(s,u[0].rowIndex,u[0].colIndex,u[u.length-1].rowIndex,u[u.length-1].colIndex),f=0,k=u.length;f<k;f++){if(e=this.getCell(u[f].rowIndex,u[f].colIndex),e.hasClass("e-sswraptext")||r==="unwrap")e.removeClass("e-sswraptext"),n(h[u[f].rowIndex]).removeClass("e-sswraprow"),r="unwrap",o=b[u[f].rowIndex],this.XLEdit._updateDataContainer(e[0],{wrap:!1});else{if(r="wrap",e.is(":visible")){if(e.addClass("e-sswraptext"),n(h[u[f].rowIndex]).hasClass("e-sswraprow")||n(h[u[f].rowIndex]).addClass("e-sswraprow"),e[0].rowSpan>1)for(l=u[f].rowIndex;l<u[f].rowIndex+e[0].rowSpan;l++)a=a+w[l];o=e[0].offsetHeight;o<=a&&(o=a-o)}b[u[f].rowIndex]=n(h[u[f].rowIndex]).height();this.XLEdit._updateDataContainer(e[0],{wrap:!0})}o>0&&(n(h[u[f].rowIndex]).height(o),n(g[u[f].rowIndex]).height(o),w[u[f].rowIndex]=o);o=0;e.find(".e-filterspan").length>0&&(y=e.find(".e-filterspan"),this.XLFilter._applyFilterIcon(e,y))}this.XLComment._updateCmntArrowPos();v._importRendered||(d={sheetIndex:s,selectedCells:u,reqType:"textwrap",operation:r,range:p},this.XLScroll._refreshScroller(s,"refresh","all"),this.XLSelection._refreshBorder(),this._isUndoRedo||this._isClearAll||this._completeAction(d))},_setWrapTextForImport:function(n,t,i,r){var u,f=this.getSheet(n)._wrapHtCollection;u=r[t];this.addClass(u.cells[i],"e-sswraptext");f[t]=20;this._wrapRow=!0},_setWrapHeight:function(t,i,r,u,f,e){var h=r[i],s=this.getSheet(t),v=s.hideRowsCollection,c=!1,l=s.rowsHeightCollection,a,o;c=v.indexOf(i)>-1;l[i]>0?o=l[i]:c&&e!=="visible"||(a=n(r[i].outerHTML).attr("id","ss"),f[0].insertBefore(a[0],f[0].childNodes[0]),o=f[0].rows[0].getBoundingClientRect().height,f[0].rows[0].parentNode.removeChild(f[0].rows[0]));o=o<20?20:o;parseInt(h.style.height)<o&&(h.style.height=o+"px",n(u[i])[0].style.height=o+"px",s.rowsHeightCollection[i]=o)},_setRowHdrHeightResize:function(t,i){for(var r,f=this.getRows(t),e=f[0],o=f[1],u=0,s=o.length;u<s;u++)(r=this.getCell(u,i),r[0].className.indexOf("e-rc")>0||r.prop("rowspan")>1||r.prop("colspan")>1)||n(e[u]).height(r[0].offsetHeight)},_setRowHdrHeight:function(t,i){n(this.getRows(t)[0][i]).height(n(this.getRows(t)[1][i]).height());this.XLDragFill.positionAutoFillElement()},_renderAlertdlg:function(){var i=this._id+"_alertdlg";if(!n(i).length){var r=t.buildTag("div#"+i+".e-alertdlg","",{display:"none"}),s=t.buildTag("div#"+i+"_dlgcontent .e-alertdlgcontent"),u=t.buildTag("div#"+i+"_dlgbtncontent","",{float:"right"}),h=t.buildTag("div#"+i+"_condiv","",{display:"table",margin:"0 auto",float:"right"}),c=t.buildTag("div#"+i+"_alertdiv","",{display:"table",margin:"-5px auto 6px",float:"right"});r.append(s);var f=t.buildTag("input#"+this._id+"_dialog_Ok"),e=t.buildTag("input#"+this._id+"_dialog_Can.e-dlgcan"),o=t.buildTag("input#"+this._id+"_dialog_alertOk");f.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertOkClick,this),enabled:!0});e.ejButton({text:this._getLocStr("Cancel"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertCanClick,this)});o.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertOkClick,this),enabled:!0});u.append(h.append(f,e));u.append(c.append(o));r.append(u);this.element.append(r)}},_renderAlertDlgContent:function(n,t,i,r,u,f,e){var o=n.find("#"+this._id+"_alertdlg_dlgcontent"),s=n.find("#"+this._id+"_alertdlg_condiv"),h=n.find("#"+this._id+"_alertdlg_alertdiv");this.isUndefined(u)&&(u=400);this.isUndefined(f)&&(f="auto");this.isUndefined(e)&&(e="");t==="Alert"?(s.hide(),h.show()):(s.show(),h.hide());o.text("");o.text(i);n.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("Title"),width:u,height:f,cssClass:"e-ss-dialog "+e});this._alertDialog={element:n,action:r}},_alertOkClick:function(){var t=this.getActiveSheetIndex(),i;this._alertDialog.element.ejDialog("close");switch(this._alertDialog.action){case"findPrevComment":this.gotoPage(this.model.sheetCount,!1);i=this.model.sheets[this.model.sheetCount];this.XLComment._updateCurrentCell(i.rowCount-1,i.colCount-1);this.XLComment.findPrevComment();this._alertDialog.action=null;break;case"findNextComment":this.gotoPage(1,!1);this.XLComment._updateCurrentCell(0,0);this.XLComment.findNextComment();this._alertDialog.action=null;break;case"sheetRenameActn":n("#"+this._id+"_Sheet_RenamePanel").select().focus();break;case"sheetDeleteActn":this._removeSheet(t);this._alertDialog.action=null;break;case"New":this._destroy();this.importSheet=!0;this.model.sheetCount=1;this.model.activeSheetIndex=1;this.model.sheets.splice(0,0,{});this._renderSheets();this.XLRibbon._toggleFormatTab();this.XLRibbon._toggleChartDesignTab();this._refreshSpreadSheetPager();this.importSheet=!1;break;case"Open":n("#"+this._id+"_file .e-uploadinput").click();break;case"MissingParenthesis":this.XLEdit._focusElements(this.getActiveCellElem(t));break;case"MergeCells":this._mergeCells(t,this.model.sheets[t]._selectedCells,{},[]);this._alertDialog.action=null;break;case"MergeAcrossCells":this._mergeAcrossCells(t,this.model.sheets[t]._selectedCells);this._alertDialog.action=null;break;case"CtrlKeyCopyErrorAction":this.setSheetFocus()}},_alertCanClick:function(){(this._alertDialog.action=="findNextComment"||this._alertDialog.action=="findPrevComment")&&n(this.getActiveCellElem()).find(".e-comment-txtarea").css("display","inline-table");this._alertDialog.element.ejDialog("close");this.hideWaitingPopUp()},_showAlertDlg:function(t){var i=n("#"+this._id+"_alertdlg");this._renderAlertDlgContent(i,"Alert",this._getLocStr(t));i.ejDialog("open")},getCell:function(t,i,r){return r=this._getSheetIndex(r),(this.importSheet||this.model.sheets[r]._importRendered||this._isPrint)&&this._detachTable?n(this._detachTable[0].tBodies[0].rows[t].cells[i]):n(this._getContent(r).find(".e-table")[0].tBodies[0].rows[t].cells[i])},getRange:function(i,r,u,f,e){var o,c,h,l,a,s;for(o=(this.importSheet||this.model.sheets[this._getSheetIndex(e)]._importRendered)&&this._detachTable?n(this._detachTable[0].rows):n(this._getContent(this._getSheetIndex(e)).find(".e-table")[0].rows),i>u&&(h=i,i=u,u=h),r>f&&(h=r,r=f,f=h),o=u!==i?o.slice(i,u+1):o.eq(u),c=[],l=o.length,s=0;s<l;s++)a=f!==r?n(o[s].cells).slice(r,f+1):n(o[s].cells).eq(f),t.merge(c,a);return n(c)},getRangeIndices:function(n){n=n.indexOf(":")===-1?n+":"+n:n;var r=n.split(":"),t,i=[];return t=r[0].split(/[A-Z]/i),i.push(parseInt(t[t.length-1])-1),i.push(this._generateColCount(r[0].split(/[0-9]/)[0].toUpperCase())-1),t=r[1].split(/[A-Z]/i),i.push(parseInt(t[t.length-1])-1),i.push(this._generateColCount(r[1].split(/[0-9]/)[0].toUpperCase())-1),this.swapRange(i),i},swapRange:function(n){return n[0]>n[2]&&t.dataUtil.swap(n,0,2),n[1]>n[3]&&t.dataUtil.swap(n,1,3),n},updateRange:function(t,i){var f=i.dataSource,c,l,u=[],a=[],h,y=f.length,p=this.getObjectLength(f[0]),e,v,s,o;if(l=i.startCell,c=l.split(/[A-Z]/i),u.push(parseInt(c[c.length-1])-1),u.push(this._generateColCount(l[0].split(/[0-9]/)[0].toUpperCase())-1),u.push(u[0]+y-(i.showHeader?0:1)),u.push(u[1]+p-1),e=this.getRange(u[0],u[1],u[2],u[3],t),v=this._getContent(t).find(".e-content >table"),v.detach(),i.showHeader)for(h in f[0])a.push(h);for(s=0;s<y;s++)if(f[s]!=r)for(h in f[0])a.push(f[s][h]);for(o=0;o<e.length;o++)this.XLEdit.updateCell(n(e[o]),a[o],t),i.showHeader&&o<p&&(u=i.startCell+":"+(this._generateHeaderText(t,e[e.length-1].cellIndex+1)+(n(e[0]).parent().index()+1)),i.headerStyles&&this.XLFormat.format({style:i.headerStyles},u));this._getContent(t).find(".e-content").append(v)},editRange:function(t,i){var f=this.getSheet(this.getActiveSheetIndex()).rangeSettings[t],u,r,o,s,l,e=this.getRangeIndices(f.range),h=this.getRange(e[0],e[1],e[2],e[3]),c;for(this._trigger("editRangeBegin",{range:f,sheetIndex:this.getActiveSheetIndex()}),f.cssClass&&h.addClass(f.cssClass),f.readOnly&&h.addClass("e-readonly"),c=this._getContent(this.getActiveSheetIndex()).find(".e-content >table"),c.detach(),o=0,l=h.length;o<l;o++)u=h[o],n.trim(t).length&&this.XLEdit._updateDataContainer(u,{range:t}),r=i(u,u.cellIndex,o),typeof r=="string"?this.XLEdit.updateCell(n(u),r):typeof r=="object"&&(r.Value.indexOf("=")!==0?this.XLEdit.updateCell(n(u),r.Value):this.XLEdit.updateCellValue(n(u),r.Value),n(u).data("value2",r.Value2),n(u).data("type",r.NumberFormat),r.StyleIndex>1&&n(u).addClass(this._styleColl[r.StyleIndex]));for(this._getContent(this.getActiveSheetIndex()).find(".e-content").append(c),s=e[0];s<e[2]+1;s++)this._setRowHdrHeight(this.getActiveSheetIndex(),s);this._trigger("editRangeComplete",{range:f,sheetIndex:this.getActiveSheetIndex()})},removeRange:function(n){this.clearRange(n);delete this.getSheet(this.getActiveSheetIndex()).rangeSettings[n]},clearRange:function(n){var t=this.getSheet(this.getActiveSheetIndex()).rangeSettings[n],i=this.getRangeIndices(t.range),r=this.getRange(i[0],i[1],i[2],i[3]);t.cssClass&&r.removeClass(t.cssClass);t.readOnly&&r.removeClass("e-readonly");this.clearRangeData(null,["range","value","type","value2"],r);r.empty()},getObjectLength:function(n){var t,i=0;if(n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{},Object.keys)return Object.keys(n).length;for(t in n)n.hasOwnProperty(t)&&i++;return i},getObjectKeys:function(n){var t,i=[];if(n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{},Object.keys)return Object.keys(n);for(t in n)n.hasOwnProperty(t)&&i.push(t);return i},toArrayLowerCase:function(n){for(var t=0;t<n.length;t++)n[t]=n[t].toString().toLowerCase();return n},_isValueAlreadyExist:function(n,t,i){for(var r=0,u=n.length;r<u;){if(n[r][t]===i)return!0;r++}return!1},addClass:function(n,t){if(n){var i=n.className;i.indexOf(t)===-1&&(n.className=i+" "+t)}},_removeClass:function(n,t){n&&(n.className=n.className.replace(new RegExp(t,"g"),"").replace(/ +/g," "))},_hasClass:function(n,t){if(n)return n.className.indexOf(t)>-1},isUndefined:function(n){return n===r},_isObject:function(n){return Object.prototype.toString.call(n)==="[object Object]"},_isBool:function(n){return n=n+"",n=n.toUpperCase(),n==="TRUE"||n==="FALSE"},isRange:function(n){return n[0]!==n[2]||n[1]!==n[3]},inRange:function(n,t,i){return t>=n[0]&&t<=n[2]&&i>=n[1]&&i<=n[3]},_isUniqueRange:function(n,t){return n.toString()===t.toString()},hasSpan:function(n){return n>1},_arrayAsString:function(n){return n.join(" ").replace(/,/g," ")},_toArrayString:function(n){for(var t=n.length;t--;)n[t]=n[t].toString();return n},_rangeHasData:function(n){var t,i;for(n=this.swapRange(n),t=this.getRange(n[0],n[1],n[2],n[3]),i=t.length;i--;)if(t[i].innerHTML.length)return!0;return!1},getRangeDataAsObject:function(n,i){var u,o,f,p=t.Spreadsheet.CellType,e=this._dataContainer,s=e.sheets[this.getActiveSheetIndex()],r,h,c,l,w=[],b=[],a=[],v,y;for(n.rowIndex>i.rowIndex?(r=i.rowIndex,h=n.rowIndex):(r=n.rowIndex,h=i.rowIndex),n.colIndex>i.colIndex?(c=i.colIndex,l=n.colIndex):(c=n.colIndex,l=i.colIndex);r<=h;){for(v={},y={},u=c;u<=l;u++)o=this.getSheet(this.getActiveSheetIndex()).columns[u].field,r in s&&u in s[r]&&(f=s[r][u],v[o]=e.sharedData[f.value],y[o]=[p.General,p.Text].indexOf(e.cellType[f.type])===-1?f.value2:e.sharedData[f.value2]);w.push(v);b.push(y);r++}return a.push(w),a.push(b),a},_getColorFromFormat:function(n){var i=[],t,r,u;return t=n.replace("e-format","").toLowerCase(),r=t.startsWith("6n")?"#"+t.substr(2,6):"#"+t.substr(6,6),u="#"+t.substr(0,6),i.push(u),i.push(r),i},getRangeData:function(n,t,i,r,u){r=r?r:this.getActiveSheetIndex();i=i?i:["value","value2","type","formatStr","decimalPlaces","thousandSeparator","range","format","border","comment","hyperlink","picture","cFormatRule","rule","chart"];var c,h,y,f,l,s=[],a="value",p=this._dataContainer,o=p.sheets[r],w=p.sharedData;n=n?this.swapRange(n):this.getSheet(r).selectedRange;for(var e=n[0],b=n[2],v=n[3];e<=b;){if(f=n[1],e in o)if(t)while(f<=v)s.push(f in o[e]&&a in o[e][f]?u&&this._isDateTime(w[o[e][f][a]])?this.XLEdit.getPropertyValue(e,f,"value2"):w[o[e][f][a]]:""),f++;else while(f<=v){if(f in o[e]){for(c=i.length,l={},y=o[e][f];c--;)h=i[c],this.isUndefined(y[h])||(l[h]=this.XLEdit.getPropertyValue(e,f,h,r));s.push(l)}else s.push({});f++}else while(f<=v)t?s.push(""):s.push({}),f++;e++}return s},_processBindings:function(n){if(this.model.query=new t.Query,this._trigger("actionBegin",n))return!0;this._ensureDataSource(n);n.action==="sorting"&&this.XLSort._sortComplete(n);n.action==="sorting"?this._isUndoRedo||this._completeAction(n):this._completeAction(n)},_ensureDataSource:function(n){var f=this.getActiveSheetIndex(),i,u=this.model.query,e,s,h,c,l,o,v,y,a;if(n.action==="filtering"||n.action==="clearFiltering"||n.requestType==="filterbycell"){for(i=this.model.sheets[f].filterSettings.filteredRange==null?this._dataSource(f):this.model.sheets[f].filterSettings.filteredRange,l=this.model.sheets[f].filterSettings.tableRange,o=0,v=l.length;o<v;o++)if(l[o].tableID===n.tableID){l[o].filteredRange=i;break}if(this._dataManager=t.DataManager(i),i==null&&!(i instanceof t.DataManager))return;if(this.model.query.requiresCount(),u=this.model.query,n.filteredcolumns.length){s=this._excelFilter._predicates[f];y=i[0];for(a in s)y.hasOwnProperty(a)&&(h=s[a]),h=s[a],e=e!=r?e.and(h):h;t.isNullOrUndefined(e)||u.where(e);i instanceof t.DataManager||(this._filteredRecordsCount=this._dataManager.executeLocal(u).count,c=this._dataManager.executeLocal(u),this.model.currentViewData=c.result)}}else n.requestType==="sorting"&&(this._dataManager=t.DataManager(n.rangeData),n.rangeData instanceof t.DataManager||(this.model.currentViewData=n.rangeData),u.sortBy(n.columnName,n.sortDirection),n.rangeData instanceof t.DataManager||(c=this._dataManager.executeLocal(u),this.model.currentViewData=c))},_toArrayData:function(t){for(var r=[],i=0;i<t.length;i++)n.each(t[i],function(n,t){r.push(t)});return r},updateRangeData:function(n,i,r){var f=this.XLSelection._getSelectedRange(i.startCell,i.endCell),o=this._toArrayData(r),u,e;if(o.length===f.length)for(u=0;u<f.length;u++)if(!t.isNullOrUndefined(o[u])&&(this.XLEdit.updateCellValue(this.getCell(f[u].rowIndex,f[u].colIndex),o[u]),!t.isNullOrUndefined(n.filterIcon)))for(e=0;e<n.filterIcon.length;e++)if(n.filterIcon[e].rowIndex===f[u].rowIndex&&n.filterIcon[e].colIndex===f[u].colIndex){this.getCell(f[u].rowIndex,f[u].colIndex).append(n.filterIcon[e].filterIcon);break}},updateData:function(i,r){r=r?this.swapRange(r):this.getSheet(this.getActiveSheetIndex()).selectedRange;var f,u,o,e,s,h=n.makeArray(this.getRange(r[0],r[1],r[2],r[3])).reverse();if(i.length===h.length)for(u=i.length,i=i.reverse();u--;)f=h[u],this.XLEdit._updateDataContainer(f,i[u]),"hyperlink"in i[u]&&(e=i[u].hyperlink,s=n(f),this.isUndefined(e)||(e.webAdr?s.html(t.buildTag("a",i[u].value2,"",{href:e.webAdr,target:"_blank","class":"e-hyperlinks"})):s.html(t.buildTag("a",i[u].value2,"",{href:"#","class":"e-hyperlinks"})))),"comment"in i[u]&&this.XLComment.setComment(f,null,!1),"value"in i[u]&&(o=i[u].value,this.XLEdit._refreshCalcEngine(f.parentNode.rowIndex,f.cellIndex,this.isFormula(o),o))},updateUniqueData:function(n,t,i){i||(t=t?this.swapRange(t):this.getSheet(this.getActiveSheetIndex()).selectedRange,i=this.getRange(t[0],t[1],t[2],t[3]));for(var r=i.length;r--;)this.XLEdit._updateDataContainer(i[r],n)},clearRangeData:function(n,t,i){var e,s,o,h,c=this.getActiveSheetIndex(),u=this._dataContainer.sheets[c],r,f;for(t=t?t:["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink"],i||(n=n?this.swapRange(n):this.getSheet(this.getActiveSheetIndex()).selectedRange,i=this.getRange(n[0],n[1],n[2],n[3])),t.indexOf("value2")>-1&&i.html(""),e=i.length;e--;)if(r=i[e].parentNode.rowIndex,f=i[e].cellIndex,r in u&&f in u[r]){for(o=this.XLEdit.getPropertyValue(r,f,"value"),this.isFormula(o)?(h=!0,o=""):h=!1,s=t.length;s--;)delete u[r][f][t[s]];this.getObjectLength(u[r][f])||delete u[r][f];this.getObjectLength(u[r])||delete u[r];t.indexOf("value")>-1&&this.XLEdit._refreshCalcEngine(r,f,h,o)}},_getArrayRangeCells:function(n){return n?(n=this.swapRange(n),this.getRange(n[0],n[1],n[2],n[3])):this._getContent(this.getActiveSheetIndex()).find(".e-selected")},_getAlphaRangeCells:function(n){return n?(n=this.getRangeIndices(n),this.getRange(n[0],n[1],n[2],n[3])):this._getContent(this.getActiveSheetIndex()).find(".e-selected")},_completeAction:function(n){var r=this.getActiveSheetIndex(),i,f,e,u;n.reqType==="filter"?i=n.operation!=="apply-filter"?{sheetIndex:r,range:this.model.sheets[r]._selectedRange,currentViewData:n.model.currentViewData,fieldName:n.currentFilteringColumn,ejpredicate:n.ejpredicate,activeCell:n.activeCell,filteredValue:n.filteredValue,filterCollection:n.filteredcolumns,requestType:n.requestType,reqType:n.reqType,selCells:n.selCells,action:n.action,operation:"filter",selectedDataSource:this.model.sheets[r].selectedDataSource,tableID:n.tableID}:{sheetIndex:this.getActiveSheetIndex(),filteredCells:n.filteredCells,reqType:"filter",operation:"apply-filter",tableID:n.tableID}:n.requestType===t.Spreadsheet.Actions.Sorting?(u=this.getCell(n.filterIcon.length>0?n.range[0]-1:n.range[0],this.XLEdit.getColumnIndexByField(n.columnName)).find(".e-filterspan"),f=u[0]?u[0].className.indexOf("-asc")>-1?"-asc":u[0].className.indexOf("-dsc")>-1?"-dsc":"":"",e=n.sortDirection==="ascending"?"-asc":"-dsc",i={sheetIndex:r,prevIcon:f,currIcon:e,range:n.range,columnName:n.columnName,rangeData:n.rangeData,reqType:"sort",direction:n.sortDirection,operation:"unsort"}):n.requestType==="sortbycolor"||n.requestType==="filterbycolor"?(i={sheetIndex:r,operation:n.operation,requestType:n.requestType,action:n.action,bgcolor:n.bgcolor,fgcolor:n.fgcolor,tableID:n.tableID,reqType:n.requestType},i.columnName=n.requestType==="sortbycolor"?n.sortColumn:n.filterColumn):i=n;i.requestType==="sortbycolor"||this._updateUndoRedoCollection(i);n.operation!=="apply-filter"&&this.sendDataRenderingRequest(i,this.getActiveSheetIndex());this.XLDragFill.positionAutoFillElement();this._updateUndoRedoIcons();this._trigger("actionComplete",n)},_updateUndoRedoCollection:function(n){this._isUndoRedo||(this._undoCollection.push(n),this._redoCollection=[]);this._undoCollection.length>this._undoredoStep&&this._undoCollection.splice(0,1)},_trigActionBegin:function(n){return this._trigger("actionBegin",n)},_trigActionComplete:function(n){return this._trigger("actionComplete",n)},_updateUndoRedoIcons:function(){if(this.model.showRibbon&&this.model.allowUndoRedo){var t,i=n("#"+this._id+"_Ribbon_undo").data("ejButton"),r=n("#"+this._id+"_Ribbon_redo").data("ejButton");this._undoCollection.length?i.enable():i.disable();this._redoCollection.length?r.enable():r.disable();this.setSheetFocus();t={reqType:"picture",action:"add"};this._trigActionComplete(t)}},_filterMergeCells:function(n,t){var u,f=this._rcRegx,r,i;u=n[0].className;r=u.match(f)[0].replace("e-rc-","").split(":");i=this.getCell(r[0],r[1])[0];i.rowSpan=t==="incr"?i.rowSpan+1:i.rowSpan-1},sendDataRenderingRequest:function(i,u){for(var l,f,vt,gt,ni=this._rAlign,bi=this._rcRegx,hi=this.getRows(u),st=hi[0],s=hi[1],nt=this.getSheet(u),h=nt._selectedRange,y,ci="",ti,yt=[],ht,ki,pt,v,a=nt.filteredRowsCollection,li=nt.hideRowsCollection,et,ii,ri=0,it,tt=nt.filterSettings.tableRange,wt=this._formatRegx,c=[],ui,ct,w=[],rt,o,ai,bt,fi,lt=nt.rowCount,kt=0,vi=nt._defRowCount,p=nt._frHiddenHeight,b,si,ot,dt,g,yi,pi,wi,e=0,d=tt.length;e<d;e++)if(tt[e].tableID==i.tableID){it=e;break}if(t.isNullOrUndefined(i)||i.reqType!="filter"){if(!t.isNullOrUndefined(i)&&(i.requestType==="sortbycolor"||i.requestType==="filterbycolor")){var di=h.startRow,ut=[],at,ei=[],y=this._generateColCount(i.columnName)-1,k,ft,oi;if(v=this.getCell(h.startRow-1,y),i.prev={},i.cur={},v.find(".e-ssfilter, .e-ssfilter-asc, .e-ssfilter-dsc").length>0&&i.requestType==="filterbycolor"?(v.removeClass(ni),this.XLFilter._changeFilterIcon(v,"filter")):v.find(".e-ssfilter-dsc, .e-ssfilter, .e-ssfiltered, .e-ssfiltered-dsc").length>0&&(i.prev.icon=v.find(".e-filterspan")[0].className.split(" ")[3],this.XLFilter._changeSortIcon(v,"ascending"),i.cur.icon=v.find(".e-filterspan")[0].className.split(" ")[3]),i.requestType==="sortbycolor"){for(k=[h.startRow,y,h.endRow,y],ft=this.getRangeData(k),e=0;e<ft.length;e++)t.isNullOrUndefined(ft[e].format)||t.isNullOrUndefined(ft[e].format.match(wt))||(at=this._getColorFromFormat(ft[e].format.match(wt)[0]),i.operation==="sortbgcolor"||i.operation==="filterbgcolor"?i.bgcolor===at[0].toLowerCase()&&ut.push(e):i.fgcolor===at[1].toLowerCase()&&ut.push(e));for(i.prev.data=n.extend(!0,[],ft),k.colIndex=y,i.range=k,si=[],dt=ut.length-1;dt>=0;dt--)si.push(ft.splice(ut[dt],1)[0]);for(ot=si.reverse().concat(ft),this.clearRangeData(k),this.updateData(ot,k),ot=ot.reverse(),oi=this.getRange(k[0],k[1],k[2],k[3]),e=oi.length,this.XLFormat.clearFormat(k,"format");e--;)ci=t.isNullOrUndefined(ot[e].format)?"":ot[e].format,this.XLFormat._updateFormatClass(oi[e],ci);i.cur.data=ot;this._updateUndoRedoCollection(i)}else{for(e=h.endRow;e>=h.startRow;e--)et=this.getCell(e,y),t.isNullOrUndefined(et[0].className.match(wt))||(at=this._getColorFromFormat(et[0].className.match(wt)[0]),i.operation==="filterbgcolor"?i.bgcolor===at[0].toLowerCase()&&ut.push(e):i.fgcolor===at[1].toLowerCase()&&ut.push(e));for(ei=[],c=[],f=h.startRow;f<=h.endRow;f++){for(rt=!1,l=0,vt=ut.length;l<vt;l++)ut[l]==f&&(rt=!0);rt&&(ui={field:i.columnName,value:n(s[f].cells[y]).text(),predicate:"or",operator:"equal",matchcase:!1},ct=t.Predicate(i.columnName,"equal",n(s[f].cells[y]).text()),o=n(s[f].cells[y]),o.hasClass("e-hide")&&(n(s[f]).removeClass("e-hide"),n(st[f]).removeClass("e-hide"),o.removeClass("e-hide"),o.hasClass("e-mc-hide")&&this._filterMergeCells(o,"incr"),c.indexOf(f)&&c.splice(c.indexOf(f),1),a.indexOf(f)&&a.splice(a.indexOf(f),1),p=p-n(s[f]).height()),ei.push(ui),w.push(ui));rt||(n(s[f]).hasClass("e-hide")||(o=n(s[f].cells[y]),o.addClass("e-hide"),o.hasClass("e-mc-hide")&&this._filterMergeCells(o,"decr")),n(s[f]).addClass("e-hide"),n(st[f]).addClass("e-hide"),c.indexOf(f)===-1&&c.push(f),a.indexOf(f)===-1&&a.push(f),hiddenRowColl=a.length+li.length,kt=hiddenRowColl>lt?hiddenRowColl-lt:lt-hiddenRowColl,p=p+n(s[f]).height(),vi>=kt&&this.XLScroll._createNewRow(u,-1,-1,"insert"))}if(et=this.getCell(h.startRow-1,y),this.XLFilter._changeFilterIcon(et,"filter"),g=w[0],yi=g.from,!t.isNullOrUndefined(value)){for(ct=g.ejpredicate?g.ejpredicate:t.Predicate(g.field,g.operator,g.value,!g.matchcase),l=1;l<w.length;l++)ct=w[l].ejpredicate!=r?ct[w[l].predicate](w[l].ejpredicate):ct[w[l].predicate](w[l].field,w[l].operator,w[l].value,!w[l].matchcase);t.isNullOrUndefined(tt[it].predicate[i.columnName])&&(tt[it].predicate[i.columnName]={});tt[it].filteredColumns=ei;tt[it].predicate[i.columnName]=yi?{from:g.from,take:g.take}:ct;tt[it].hiddenIdx=n.extend(!0,[],c);c=[]}}}}else{for(ti=i.currentViewData,ht=this._generateColCount(i.fieldName)-1,h=i.range,gt=nt._multifilterIdx,c=tt[it].hiddenIdx,e=0,d=gt.length;e<d;e++)et=this.getCell(h.startRow-1,gt[e]),et.find(".e-ssfiltered, .e-ssfiltered-asc, .e-ssfiltered-dsc").length>0&&(ri=ri+1);if((i.requestType.indexOf("filtering")>-1||i.requestType.indexOf("filterbycell")>-1)&&i.action.indexOf("clearFiltering")===-1||ri>1&&i.action.indexOf("clearFiltering")!=-1){for(e=0,d=ti.length;e<d;e++)yt=this.XLFilter._findRowIndexByKey(nt.filterSettings.filteredRange,i.fieldName,ti[e][i.fieldName],h,yt);if(i.action!="clearFiltering")for(f=h.startRow;f<=h.endRow;f++){for(rt=!1,l=0,vt=yt.length;l<vt;l++)yt[l]==f&&(rt=!0);rt&&(o=n(s[f].cells[ht]),o.hasClass("e-hide")&&(n(s[f]).removeClass("e-hide"),n(st[f]).removeClass("e-hide"),o.removeClass("e-hide"),p=p-n(s[f]).height(),o.hasClass("e-mc-hide")&&this._filterMergeCells(o,"incr"),c.indexOf(f)&&c.splice(c.indexOf(f),1),a.indexOf(f)&&a.splice(a.indexOf(f),1)));rt||(n(s[f]).hasClass("e-hide")||(o=n(s[f].cells[ht]),o.hasClass("e-mc-hide")&&this._filterMergeCells(o,"decr"),o.addClass("e-hide")),n(s[f]).addClass("e-hide"),n(st[f]).addClass("e-hide"),c.indexOf(f)===-1&&c.push(f),a.indexOf(f)===-1&&a.push(f),p=p+n(s[f]).height(),hiddenRowColl=a.length+li.length,kt=hiddenRowColl>lt?hiddenRowColl-lt:lt-hiddenRowColl,vi>=kt&&this.XLScroll._createNewRow(u,-1,-1,"insert"))}else for(f=h.startRow;f<=h.endRow;f++)n(s[f].cells[ht]).hasClass("e-hide")&&(n(s[f]).removeClass("e-hide"),n(st[f]).removeClass("e-hide"),n(s[f].cells[ht]).removeClass("e-hide"),o=n(s[f].cells[ht]),o.removeClass("e-hide"),o.hasClass("e-mc-hide")&&this._filterMergeCells(o,"incr"),c.indexOf(f)&&c.splice(c.indexOf(f),1),a.indexOf(f)&&a.splice(a.indexOf(f),1),p=p-n(s[f]).height());ki=this.model.sheets[u].columns}else if(i.action=="clearFiltering"){for(pt=!1,bt=!1,b=h.startRow;b<=h.endRow;b++){for(ii=this.model.sheets[u]._multifilterIdx,e=0,d=ii.length;e<d;e++)o=n(s[b].cells[ii[e]]),o.hasClass("e-hide")&&(o.removeClass("e-hide"),o.hasClass("e-mc-hide")&&(ai=o[0].className,rc=ai.match(bi)[0].replace("e-rc-","").split(":"),bt=!0));for(bt&&(fi=this.getCell(rc[0],rc[1])[0],fi.rowSpan=fi.rowSpan+1,bt=!1),e=0,d=n(s[b].cells).length;e<d;e++)if(n(s[b].cells[e]).hasClass("e-hide")){pt=!1;break}else pt=!0;pt&&(n(s[b]).removeClass("e-hide"),n(st[b]).removeClass("e-hide"),c=[],a.indexOf(b)&&a.splice(a.indexOf(b),1),p=p-n(s[b]).height())}this.model.sheets[u]._filteredByColor=-1;this._excelFilter.closeXFDialog()}for(y=this._generateColCount(i.fieldName)-1,e=h.startRow-1;e<=h.startRow;e++)if(v=this.getCell(e,y),v.find(".e-filterspan").length){v.find(".e-ssfilter, .e-ssfilter-asc, .e-ssfilter-dsc").length>0&&i.action!="clearFiltering"?(v.removeClass(ni),this.XLFilter._changeFilterIcon(v,"filter")):v.find(".e-ssfiltered, .e-ssfiltered-asc, .e-ssfiltered-dsc").length>0&&(i.action=="clearFiltering"||n('span[id $="SelectAll"]').find("span.e-chk-act").length>0)&&(v.removeClass(ni),this.XLFilter._changeFilterIcon(v,"filtered"));break}tt[it].hiddenIdx=n.extend(!0,[],c);c=[]}this.model.showRibbon&&this.model.allowFiltering&&(pi=n("#"+this._id+"_Ribbon_clearfilter").data("ejButton"),wi=this.getCell(this.getActiveCell().rowIndex,this.getActiveCell().colIndex)[0],this.XLRibbon._changeClrFltrStatus(pi,"button",wi));this.XLScroll._refreshScroller(u,"refresh","vertical","filter")},_filterClose:function(){this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")&&(this.XLFilter._isSearchEdit=!1,this._excelFilter.closeXFDialog())},_setallowformatpainter:function(n){n?this.XLRibbon._enableButtons(["formatpainter"],"ejButton"):this.XLRibbon._disableButtons(["formatpainter"],"ejButton")},_setallowhyperlink:function(n){n?this.XLRibbon._enableButtons(["hyperlink"],"ejButton"):this.XLRibbon._disableButtons(["hyperlink"],"ejButton")},_setModel:function(i){var r,o,f=this.getActiveSheetIndex(),u,s,e,h;for(r in i)switch(r){case"activeSheetIndex":this.gotoPage(i[r],!1);break;case"pageSettings":this.isUndefined(i.pageSettings.currentPage)||this.gotoPage(i.pageSettings.currentPage,!1);this.isUndefined(i.pageSettings.pageCount)||(this.getPager().ejPager("option","pageCount",i.pageSettings.pageCount),this._refreshSpreadSheetPager());break;case"allowComments":this._setAllowComments(i[r]);break;case"allowFormatPainter":this._setallowformatpainter(i[r]);break;case"allowHyperlink":this.model.allowHyperlink=i[r];this._setallowhyperlink(i[r]);break;case"locale":this.model.locale=i[r];break;case"enableContextMenu":this.model.enableContextMenu=i[r];break;case"allowEditing":this.model.allowEditing=i[r];break;case"allowResizing":this.model.allowResizing=i[r];break;case"allowDataValidation":this.model.allowDataValidation=i[r];i[r]?(this.XLRibbon._enableButtons(["validationbtn"],"ejButton"),this.XLRibbon._enableButtons(["validationsbtn"],"ejSplitButton")):(this.XLRibbon._disableButtons(["validationbtn"],"ejButton"),this.XLRibbon._disableButtons(["validationsbtn"],"ejSplitButton"));break;case"allowConditionalFormats":this.model.allowConditionalFormats=i[r];i[r]?this.XLRibbon._enableButtons(["cFormat"],"ejSplitButton"):this.XLRibbon._disableButtons(["cFormat"],"ejSplitButton");break;case"allowSearching":this.model.allowSearching=i[r];i[r]?this.XLRibbon._enableButtons(["find"],"ejSplitButton"):this.XLRibbon._disableButtons(["find"],"ejSplitButton");break;case"pictureSettings":for(s in i[r])switch(s){case"allowPictures":this.model.pictureSettings.allowPictures=i[r][s];i[r][s]?this.XLRibbon._enableButtons(["pictures"],"ejButton"):this.XLRibbon._disableButtons(["pictures"],"ejButton")}break;case"showRibbon":this.model.showRibbon=i[r];i[r]?n("#"+this._id+"_Ribbon").show():n("#"+this._id+"_Ribbon").hide();break;case"exportSettings":for(o in i[r])switch(o){case"allowExporting":this.model.exportSettings.allowExporting=i[r][o];break;case"excelUrl":this.model.exportSettings.excelUrl=i[r][o];break;case"csvUrl":this.model.exportSettings.csvUrl=i[r][o]}break;case"allowKeyboardNavigation":case"allowAutoFill":case"allowSelection":case"allowDragAndDrop":case"allowCellFormatting":case"importmapper":this.model[r]=i[r];break;case"allowSorting":this.model.allowSorting=i[r];i[r]?this.XLRibbon._enableButtons(["sortAtoZ","sortZtoA"],"ejButton"):this.XLRibbon._disableButtons(["sortAtoZ","sortZtoA"],"ejButton");break;case"formatSettings":for(e in i[r])switch(e){case"allowFontFamily":this.model.formatSettings.allowFontFamily=i[r][e];i[r][e]?this.XLRibbon._enableButtons(["font-family"],"ejDropDownList"):this.XLRibbon._disableButtons(["font-family"],"ejDropDownList");break;case"allowDecimalPlaces":this.model.formatSettings.allowDecimalPlaces=i[r][e];i[r][e]?this.XLRibbon._enableButtons(["increment","decrement"],"ejButton"):this.XLRibbon._disableButtons(["increment","decrement"],"ejButton");break;case"allowCellBorder":this.model.formatSettings.allowCellBorder=i[r][e];i[r][e]?this.XLRibbon._enableButtons(["border"],"ejSplitButton"):this.XLRibbon._disableButtons(["border"],"ejSplitButton")}break;case"allowFormulaBar":this.model.allowFormulaBar=i[r];this.model.allowFormulaBar?this.showFormulaBar():this.hideFormulaBar();break;case"printHeader":this.model.sheets[f].printHeader=i[r];this.model.showRibbon&&(u=this.element.find("#"+this._id+"_Ribbon_Pheading").data("ejCheckBox"),i[r]?u._checked():u._unChecked());break;case"printGridlines":this.model.sheets[f].printGridlines=i[r];this.model.showRibbon&&(u=this.element.find("#"+this._id+"_Ribbon_Pgridlines").data("ejCheckBox"),i[r]?u._checked():u._unChecked());break;case"showHeader":this.model.showRibbon&&(u=this.element.find("#"+this._id+"_Ribbon_Vheading").data("ejCheckBox"),i[r]?u._checked():u._unChecked());this.showHeaders(i[r]);break;case"showGridlines":this.model.showRibbon&&(u=this.element.find("#"+this._id+"_Ribbon_Vgridlines").data("ejCheckBox"),i[r]?u._checked():u._unChecked());this.showGridlines(i[r]);break;case"scrollSettings":h={};t.isNullOrUndefined(i.scrollSettings)||(t.isNullOrUndefined(i.scrollSettings.allowScrolling)||(this.model.scrollSettings.allowScrolling=i.scrollSettings.allowScrolling),t.isNullOrUndefined(i.scrollSettings.scrollMode)||(this.model.scrollSettings.scrollMode=i.scrollSettings.scrollMode==="normal"?t.Spreadsheet.scrollMode.Normal:t.Spreadsheet.scrollMode.Infinite),t.isNullOrUndefined(i.scrollSettings.width)||(this.model.scrollSettings.width=i.scrollSettings.width),t.isNullOrUndefined(i.scrollSettings.height)||(this.model.scrollSettings.height=i.scrollSettings.height));n.extend(!0,h,this.model.scrollSettings);this._setSheetWidthHeight(f,h);break;case"allowFiltering":this._setFiltering(i[r]);break;case"allowInsert":this._setInsert(i[r]);break;case"allowDelete":this._setDelete(i[r]);break;case"allowFreezing":this._setFreeze(i[r]);break;case"freezeTopRow":this.XLFreeze.freezeTopRow(f);this.XLFreeze._updateFPaneMenu("freeze");break;case"freezeFirstColumn":this.XLFreeze.freezeFirstColumn(f);this.XLFreeze._updateFPaneMenu("freeze");break;case"freezeRows":this.XLFreeze.freezeRows(f,i[r]);this.XLFreeze._updateFPaneMenu("freeze");break;case"freezeColumns":this.XLFreeze.freezeColumns(f,i[r]);this.XLFreeze._updateFPaneMenu("freeze");break;case"freezePanes":this.XLFreeze.freezePanes(f,i[r]);this.XLFreeze._updateFPaneMenu("freeze");break;case"unfreezePanes":this.XLFreeze.unfreezePanes(f);this.XLFreeze._updateFPaneMenu("unfreeze");break;case"allowSortandFilter":this.model.allowSorting=i[r];this.model.allowFiltering=i[r];i[r]?this.XLRibbon._enableButtons(["sortfilter"],"ejSplitButton"):this.XLRibbon._disableButtons(["sortfilter"],"ejSplitButton")}},_setAllowComments:function(i){i&&t.spreadsheetFeatures.comments&&n.extend(t.Spreadsheet.prototype,t.spreadsheetFeatures.comments);i?this.XLComment._updateCmntRibIcons():(this.XLRibbon._disableButtons(["newComment","deleteComment","previousComment","nextComment","showHideComment"],"ejButton"),this.XLRibbon._disableButtons(["showAllComments"],"ejToggleButton"))},_setFreeze:function(n){n?this.XLRibbon._enableButtons(["fPane"],"ejSplitButton"):this.XLRibbon._disableButtons(["fPane"],"ejSplitButton")},_setFiltering:function(n){n?(this.XLRibbon._enableButtons(["sortfilter"],"ejSplitButton"),this.XLRibbon._enableButtons(["filter","clearfilter"],"ejButton")):(this.XLRibbon._disableButtons(["sortfilter"],"ejSplitButton"),this.XLRibbon._disableButtons(["filter","clearfilter"],"ejButton"))},_setInsert:function(n){n?(this.XLRibbon._enableButtons(["insbtn"],"ejButton"),this.XLRibbon._enableButtons(["inssbtn"],"ejSplitButton")):(this.XLRibbon._disableButtons(["insbtn"],"ejButton"),this.XLRibbon._disableButtons(["inssbtn"],"ejSplitButton"))},_setDelete:function(n){n?(this.XLRibbon._enableButtons(["delbtn"],"ejButton"),this.XLRibbon._enableButtons(["delsbtn"],"ejSplitButton")):(this.XLRibbon._disableButtons(["delbtn"],"ejButton"),this.XLRibbon._disableButtons(["delsbtn"],"ejSplitButton"))},"import":function(t){if(this.model.allowImport){var i=this;i.importSheet=i._initialLoad?!1:!0;i.showWaitingPopUp();n.ajax({type:"POST",data:t,processData:!1,contentType:!1,async:!1,url:i.model.importSettings.importMapper,success:function(n){i.importSuccess(n);i.importSheet=!1},error:function(n,t){i._importFailed({type:t,xhr:{status:n.status,statusText:n.statusText}})}});i.hideWaitingPopUp()}},importSuccess:function(n){if(this.model.allowImport){var e,s,h,c,l,t=this,f=1,u,o=["UnsupportedFile","IncorrectPassword","InvalidUrl"],i,r;switch(n){case o[0]:case o[1]:case o[2]:t._showAlertDlg(n);break;default:if(n=JSON.parse(n),e=t._getWorkbookMaxRowColCnt(n.model.sheets,!0),n.dataContainer.sharedData.length<50001&&e.rowCount<10001&&e.colCount<126){for(this._rowCount=this.model.rowCount,this._colCount=this.model.columnCount,h=n.dataContainer.hashCode,c=n.dataContainer.cFormatData,l=n.dataContainer.valData,this._initialLoad||t._destroy(),t.model.sheetCount=n.model.sheetCount,t._updateImportedSheetModel(n.model),t.model.sheets.splice(0,0,{}),t.model.activeSheetIndex=n.model.activeSheetIndex,t._renderSheets(),n.dataContainer.hashCode=t._dataContainer.hashCode,n.dataContainer.cFormatData=[],n.dataContainer.valData=[],t._dataContainer=n.dataContainer,t.XLFormat._formatAsTableStyle=t.XLFormat._getTableLayoutFromName("TableStyleLight1"),t._updateImportedStyles(h),t._updateNameManager(n.model.nameManager),f=n.model.sheets.length;f--;)if(i=n.model.sheets[f],r=this.getSheet(f),i.usedRange){for(r._importRendered=!0,u=0;u<i.columnsWidthCollection.length;u++)t.isUndefined(i.columnsWidthCollection[u])||(r.columnsWidthCollection[u]=i.columnsWidthCollection[u]);for(u=0;u<i.rowsHeightCollection.length;u++)t.isUndefined(i.rowsHeightCollection[u])||(r.rowsHeightCollection[u]=i.rowsHeightCollection[u]);r._shapeMngr=i._shapeMngr;i._mergedCells&&(r._mergedCells=i._mergedCells);r._usedRange=i.usedRange;i._tableManager&&(r._tableManager=i._tableManager);i.filterSettings.range&&(r.filterSettings.range=i.filterSettings.range);r.hideRowsCollection=i.hideRowsCollection;r.hideColsCollection=i.hideColsCollection;(i._frozenRows||i._frozenColumns)&&(r._frozenRows=i._frozenRows,r._frozenColumns=i._frozenColumns);i.showHeader||(r.showHeader=i.showHeader);i.showGridlines||(r.showGridlines=i.showGridlines)}t._updateDataValidation(l);t._updateConditionalFormats(c);t.gotoPage(t.model.activeSheetIndex,!1);s=t.getCell(t.getActiveCell().rowIndex,t.getActiveCell().colIndex)[0];t.XLRibbon._toggleDesignTab(s);t.model.showRibbon&&t.XLRibbon._enableRibbonIcons();t.XLComment._isCommentEdit=!1;t.clearUndoRedo();this._trigger("onLoadComplete",{model:t.model});this._detachTable=null;this.model.rowCount=this._rowCount;this.model.columnCount=this._colCount}else t._showAlertDlg("HugeDataAlert")}}},_importFailed:function(n){var t={failureType:n.type};n.xhr?(t.status=n.xhr.status,t.statusText=n.xhr.statusText):t.statusText=n.error;this.hideWaitingPopUp();this._trigger("onOpenFailure",t)},_updateImportedSheets:function(n){var i,u,t=this.getSheet(n),r={rowIndex:0,colIndex:0};this._setRowColumnSize(t);i=this.getRangeIndices(t._usedRange);u=this.getRangeData(i,!1,["value","value2","format","hyperlink","comment","border","picture","wrap","isMerge","mRange","isCenterAlign"]);this._updateImportedData(u,i);this._updateImportedChart(t._shapeMngr.chart);this._updateImportedTable(t._tableManager);t.filterSettings.range.length&&this.XLFilter._filterCellRange(n,t.filterSettings.range);this._updateHiddenRowsandColumns(t);(t._frozenRows||t._frozenColumns)&&this._setFreezePane(t._frozenRows,t._frozenColumns);t._activeCell=r;t.showHeader||this.showHeaders(t.showHeader);t.showGridlines||this.showGridlines(t.showGridlines);this.importSheet||this.XLSelection.selectRange(r,r)},_updateImportedMergedCells:function(n){n._mergedCells=n._mergedCells;for(var t=0,i=n._mergedCells.length;t<i;t++)n._mergedCells[t].isCenterAlign&&(this._mergeCenter=!0),this.mergeCells(n._mergedCells[t].range,!0),this._mergeCenter=!1;n._mergedCell=[]},_updateImportedData:function(i,r,u,f){u=u?u:this.getActiveSheetIndex();r=r?r:this.getSheet(u).selectedRange;var a=this.getRows(u)[0],v,p=n(this._getJSSheetHeader(u).find("colgroup")[0].outerHTML).attr("id","ss"),c=t.buildTag("table#wrapTable.e-table",{});c.append(p);this._detachTable=this._getContent(u).find(".e-content >table");v=this._detachTable[0].tBodies[0].rows;this._detachTable.detach();this.element[0].insertBefore(c[0],this.element[0].childNodes[0]);for(var h,s,e,o,y=this.getRange(r[0],r[1],r[2],r[3],u),l=0,w=y.length;l<w;)o=y[l],s=o.parentNode.rowIndex,h=o.cellIndex,e=i[l],this.XLEdit._updateDataContainer(o,{value:this.XLEdit._parseValue(e.value).value},u),this.isFormula(e.value)?this.XLEdit._refreshCalcEngine(s,h,!0,e.value):(o.innerHTML=e.value2||"",this.XLEdit._refreshCellAlignment(o,e.value),this.XLEdit._refreshCalcEngine(s,h)),f||(o.className=o.className+(e.format?" "+e.format:""),e.hyperlink&&("cellAdr"in e.hyperlink?n(o).html(t.buildTag("a",e.value2,"",{href:"#"})):n(o).html(t.buildTag("a",e.value2,"",{href:e.hyperlink.webAdr,target:"_blank"}))),e.comment&&this.XLComment.setComment(o,null,!1),e.border&&this.XLFormat.applyBorder(this._getBorderInput(e.border),this._getAlphaRange(u,o.parentNode.rowIndex,o.cellIndex,o.parentNode.rowIndex,o.cellIndex)),e.picture&&this.XLShape._copyImages(o,e.picture,u),e.isMerge&&(e.isCenterAlign&&(this._mergeCenter=!0),this.mergeCells(e.mRange,!0),this._mergeCenter=!1),e.wrap&&this._setWrapTextForImport(u,s,h,v)),h===r[3]&&this._wrapRow&&(this._setWrapHeight(u,s,v,a,c,"hide"),this._hasClass(a[s],"e-sswraprow")||this.addClass(a[s],"e-sswraprow"),this._wrapRow=!1),l++;c.remove();this._getContent(u).find(".e-content").append(this._detachTable);f||(this._refreshHashCode(),this.XLComment._updateCmntArrowPos())},_updateImportedStyles:function(n){var r,t,i=n.length;if(i)for(n=n.reverse();i--;)t=n[i],t.indexOf("e-format")===-1?this._dataContainer.hashCode.push(t):(r=this.XLFormat.getFormatFromHashCode(t),this.XLFormat._createFormatClass(r))},_updateImportedTable:function(n){var i,r,t,u=this.getObjectLength(n);if(u)while(u--)t=n[u],i=t.range,r=this.XLFormat._getTableLayoutFromName(t.formatName),r||(r=this.XLFormat._formatAsTableStyle,t.formatName=r.formatName),this.XLFormat.createTable({header:!0,name:t.name,format:r.format,formatName:t.formatName},this._getAlphaRange(this.getActiveSheetIndex(),i[0],i[1],i[2],i[3]))},_updateConditionalFormats:function(n){var t,i=n.length;if(i)for(n=n.reverse();i--;)t=n[i].split("_"),this.XLCFormat._cFormat(t[0],t[1],t[2],t[3],null,Number(t[4]),this.getRangeIndices(t[5]))},_updateImportedSheetModel:function(n){for(var t,i=1,r=this.model.sheets,u=n.sheets.length;i<u;)t=n.sheets[i],r.push({sheetName:t._sheetName.text,rowCount:t.rowCount||this.model.rowCount,colCount:t.colCount||this.model.columnCount}),i++},_setRowColumnSize:function(n){var r=[],i=n.columnsWidthCollection,t=i.length;if(t){while(t--)i[t]!==64&&r.push({cellIndex:t,width:i[t]});this.setWidthToColumns(r)}if(i=n.rowsHeightCollection,t=i.length,r=[],t){while(t--)i[t]>20&&r.push({rowIndex:t,height:i[t]});this.setHeightToRows(r)}},setHeightToRows:function(t){for(var r=this,u=r.getActiveSheetIndex(),f=r._getJSSheetRowHeaderContent(u),e=f.find(".e-table")[0].tBodies[0],o=e.rows,s=r._getJSSheetContent(u).find(".e-content > .e-table")[0].tBodies[0].rows,i=0,h=t.length;i<h;i++)n(o[t[i].rowIndex]).outerHeight(t[i].height),n(s[t[i].rowIndex]).height(t[i].height)},_updateNameManager:function(t){t=t||[];var i=t.length;if(i){while(i--)this.XLRibbon._updateNamedRanges(t[i].name,t[i].refersto);n("#"+this._id+"_nmgrid").ejGrid("option",{dataSource:t});this.model.nameManager=t;this.XLRibbon._updateUseInFormulaTrgt()}},_setFreezePane:function(n,t){n&&t?this.XLFreeze.freezePanes({rowIndex:n,colIndex:t}):n?this.XLFreeze.freezeRows(n):t&&this.XLFreeze.freezeColumns(t)},_updateHiddenRowsandColumns:function(n){var i=n.hideRowsCollection,t=i.length;if(t)while(t--)this.hideRow(i[t],i[t]);if(i=n.hideColsCollection,t=i.length,t)while(t--)this.hideColumn(i[t],i[t])},_updateImportedChart:function(n){for(var i,r,f,t,u=0,e=n.length;u<e;)t=n[u],i=this.getSheet(t.dataSheetIdx),t.dataSheetIdx!=this.getActiveSheetIndex()&&i._importRendered&&(r=this.getRangeIndices(i._usedRange),f=this.getRangeData(r,!1,["value","value2"],t.dataSheetIdx),this._updateImportedData(f,r,t.dataSheetIdx,!0)),this.XLChart.createChart(t.range,{type:t.commonSeriesOptions.type,enable3D:t.enable3D,marker:t.commonSeriesOptions.marker,top:t.top,left:t.left,heigth:t.size.height,width:t.size.width,title:t.title,legend:t.legend,primaryYAxis:t.primaryYAxis,primaryXAxis:t.primaryXAxis,dataSheetIdx:t.dataSheetIdx,_id:t.dummyId}),u++},_getBorderInput:function(n){n=n.split("_");for(var t=4,i={},r=["top","right","bottom","left"];t--;)n[t].length&&(i[r[t]]=n[t]);return i},_refreshHashCode:function(){for(var n=this._dataContainer.hashCode,t=n.length;t--;)n[t].indexOf("e-format")===-1&&n[t].indexOf("e-border")===-1&&(n[t]="")},clearUndoRedo:function(){this._undoCollection=[];this._redoCollection=[];this._updateUndoRedoIcons()},_initializePicture:function(n){this._getContent(n).find(".e-content").append(t.buildTag("div.e-ss-imgvisual"))},_getShapePositionInManager:function(n,t,i,r){for(var o=this.getActiveSheetIndex(),f=this._dataContainer.sheets[o][n][t],u=0,e=f.length;u<e;u++)if(f[r][u].id===i)break;return u},_swapVal:function(n){var t=n.prev;n.prev=n.cur;n.cur=t},_updateDataValidation:function(n){var t,i=n.length;if(i)while(i--)t=n[i].split("_"),n[i].indexOf("list")<0?this.XLValidate.applyDVRules(t[0]==="1"?!0:!1,[this._getValue(this.XLRibbon._actions,t[1]),t[2],t[3]],t[4],this.getRangeIndices(t[5])):this.XLValidate.applyDVRules(t[0]==="1"?!0:!1,["list",t[1]],"list",this.getRangeIndices(t[3]))},_getValue:function(n,t){for(var i,r=n.length;r--;)if(i=n[r],i.text===t)return i.value},setUndoRedoSteps:function(n){this._undoredoStep=n},_undoRedoOperation:function(t){var i,r;(t.which===90||t.keyCode===90)&&t.ctrlKey?n(t.target).is(":input")?(i=n(t.target).val(),r={sheetIndex:this.getActiveSheetIndex(),rowIndex:n(t.target).parents("tr").index(),colIndex:n(t.target).parents("td").index(),value:i,reqType:"edit"},this._redoCollection.push(r),n(t.target).val().length<=0?n(t.target).val(i):n(t.target).val(""),n("#"+this._id).focus()):(this._isUndo=!0,this._performUndoRedo()):(t.which===89||t.keyCode===89)&&t.ctrlKey&&(n(t.target).is(":input")?(i=n(t.target).val(),r={sheetIndex:this.getActiveSheetIndex(),rowIndex:n(t.target).parents("tr").index(),colIndex:n(t.target).parents("td").index(),value:i,reqType:"edit"},this._undoCollection.push(r),n(t.target).val().length<=0?n(t.target).val(i):n(t.target).val(""),n("#"+this._id).focus()):(this._isUndo=!1,this._performUndoRedo()))},_performUndoRedo:function(){var n=this._isUndo?this._undoCollection.pop():this._redoCollection.pop(),i;if(!t.isNullOrUndefined(n)){n.sheetIndex!==this.getActiveSheetIndex()&&this.gotoPage(n.sheetIndex,null);this._isUndoRedo=!0;switch(n.reqType){case"auto-fill":this._undoForAutoFill(n);break;case"auto-sum":this._undoForAutoSum(n);break;case"cell-format":this._undoForFormat(n);break;case"cell-styles":this._undoForStyle(n);break;case"clear-all":this._undoForClAll(n);break;case"clear-comment":this._undoForClComment(n);break;case"clear-content":this._undoForClContent(n);break;case"clear-format":this._undoForClFormat(n);break;case"clear-link":this._undoForCLLink(n);break;case"comment":this._undoForComment(n);break;case"cond-format":this._undoForCondFormat(n);break;case"copy-paste":this._undoForCopyPaste(n);break;case"cut-paste":this._undoForCutPaste(n);break;case"delete":this._undoForDel(n);break;case"edit":this._undoForEdit(n);break;case"filter":this._undoForFilter(n);break;case"filterbycolor":this._undoForFilterByColor(n);break;case"find-replace":this._undoForFind(n);break;case"format-painter":this._undoForFormatPaint(n);break;case"format-table":this._undoForFormatTable(n);break;case"hyperlink":this._undoForHyperlink(n);break;case"insert":this._undoForIns(n);break;case"merge-cells":this._undoForMerge(n);break;case"namemanager":this._undoForNameMngr(n);break;case"paging":i=n.nSheetIndex;n.nSheetIndex=n.sheetIndex;n.sheetIndex=i;break;case"pivotgrid":this._undoForPivot(n);break;case"resize-column":this._undoForResizeCol(n);break;case"resize-row":this._undoForResizeRow(n);break;case"resize-fit-height":this._undoForResizeFHeight(n);break;case"resize-fit-width":this._undoForResizeFWidth(n);break;case"reorder-cells":this._undoForReOrder(n);break;case"show-hide":this._undoForShowHide(n);break;case"shape":this._undoForShape(n);break;case"sort":this._undoForSort(n);break;case"sortbycolor":this._undoForSortByColor(n);break;case"textwrap":this._undoForTextWrap(n);break;case"validation":this._undoForValidation(n)}this._isUndo?this._redoCollection.push(n):this._undoCollection.push(n);this._undoCollection.length>this._undoredoStep&&this._undoCollection.splice(0,1);this._redoCollection.length>this._undoredoStep&&this._redoCollection.splice(0,1);this._updateUndoRedoIcons();this.XLRibbon._updateRibbonIcons();this._isUndoRedo=!1;this._isUndo=!1;this.XLSelection._refreshBorder()}},_undoForAutoFill:function(t){this._isUndo?(this.clearRangeData(t.range),this.XLFormat.updateFormat(t.bFormat,t.range),this.updateData(n.extend(!0,[],t.bData),t.range),t.actionType=="flash-fill"&&this.updateData(n.extend(!0,[],t.bdData),t.bRange),this.performSelection({rowIndex:t.bRange[0],colIndex:t.bRange[1]},{rowIndex:t.bRange[2],colIndex:t.bRange[3]})):(this.XLFormat.updateFormat(t.aFormat,t.range),this.updateData(n.extend(!0,[],t.aData),t.range),t.actionType=="flash-fill"&&this.updateData(n.extend(!0,[],t.adData),t.bRange),this.performSelection({rowIndex:t.bRange[0],colIndex:t.bRange[1]},{rowIndex:t.range[2],colIndex:t.range[3]}))},_undoForAutoSum:function(n){var i=this._dataContainer.sheets[n.sheetIndex],t;this._isUndo?(t=this.getCell(n.updCell.rowIndex,n.updCell.colIndex,n.sheetIndex),this._clearFormula(n.updCell.rowIndex,n.updCell.colIndex),i[n.updCell.rowIndex][n.updCell.colIndex]=n.updCell.pObj,t.text(n.updCell.pValue)):this.XLRibbon.autoSum(n.oprType,n.range)},_undoForClAll:function(i){var u,r,f;for(this._isUndo?(this.updateData(n.extend(!0,[],i.bData),i.range),this.XLFormat.updateFormat(i.bFormat,i.range),this.XLCFormat.refreshCFormat(i.range)):(this.XLFormat.clearFormat(i.range),this.XLCFormat.clearCF(!0,i.range),this.clearRangeData(i.range)),r=0,f=i.selCells.length;r<f;r++)u=this.getCell(i.selCells[r].rowIndex,i.selCells[r].colIndex,i.sheetIndex)[0],i.selCells[r].prevComment&&(this._isUndo?(this.XLEdit._updateDataContainer(u,{comment:i.selCells[r].prevComment}),n(u).removeClass("e-commentcell"),this.XLComment.setComment(u,null,!1)):(this.XLComment.deleteComment([i.selCells[r].rowIndex,i.selCells[r].colIndex,i.selCells[r].rowIndex,i.selCells[r].colIndex],"clear"),n(u).removeClass("e-commentcell"))),i.selCells[r].prevLink&&this._isUndo&&(this.XLEdit._updateDataContainer(u,{hyperlink:i.selCells[r].prevLink}),t.isNullOrUndefined(i.selCells[r].prevLink.webAdr)?n(u).html(t.buildTag("a.e-hyperlinks",i.selCells[r].prevText,"",{href:"#"})):n(u).html(t.buildTag("a.e-hyperlinks",i.selCells[r].prevText,"",{href:i.selCells[r].prevLink.webAdr,target:"_blank"}))),i.selCells[r].mRange&&(this._isUndo?(this._isClearAll=!0,i.selCells[r].mergeCenter&&(this._mergeCenter=!0),this.mergeCells(i.selCells[r].mRange),this._mergeCenter=!1,this._isClearAll=!1):(this._isClearAll=!0,this.unmergeCells(i.selCells[r].mRange),this._isClearAll=!1)),i.selCells[r].wrap&&(this._isClearAll=!0,this.setWrapText(this._getAlphaRange(i.sheetIndex,i.selCells[r].rowIndex,i.selCells[r].colIndex,i.selCells[r].rowIndex,i.selCells[r].colIndex)),this._isClearAll=!1)},_undoForClComment:function(n){var u,i,f,e,t,o;if(f={rowIndex:n.selCells[0].rowIndex,colIndex:n.selCells[0].colIndex},e={rowIndex:n.selCells[n.selCells.length-1].rowIndex,colIndex:n.selCells[n.selCells.length-1].colIndex},this._isUndo)for(t=0,o=n.selCells.length;t<o;t++)i={rowIndex:n.selCells[t].rowIndex,colIndex:n.selCells[t].colIndex},u=this.getCell(n.selCells[t].rowIndex,n.selCells[t].colIndex),this.XLEdit._updateDataContainer(u[0],{comment:n.selCells[t].prevComment}),this.XLSelection.selectRange(i,i),this.XLComment.setComment(),this.XLComment._updateCurCmntVal();else this.XLSelection.selectRange(f,e),this.XLComment.deleteComment(r,"clear");this.XLDragFill.positionAutoFillElement()},_undoForClContent:function(i){var f=this.getRange(i.range[0],i.range[1],i.range[2],i.range[3]),r,u;if(this._isUndo){if(this.updateData(n.extend(!0,[],i.bData),i.range),i.bData.length)for(r=0,len=f.length;r<len;r++)!t.isNullOrUndefined(i.bData[r])&&i.bData[r].hyperlink&&(hldata=i.bData[r].hyperlink,hldata&&(hldata.webAdr?f.eq(r).html(t.buildTag("a",i.bData[r].value,"",{href:hldata.webAdr,target:"_blank","class":"e-hyperlinks"})):f.eq(r).html(t.buildTag("a",i.bData[r].value,"",{href:"#","class":"e-hyperlinks"}))))}else this.clearRangeData(i.range,["value","value2"]);for(r=i.range[0];r<i.range[2]+1;r++)for(u=i.range[1];u<i.range[3]+1;u++)this.XLComment._updateCmntFrmCntnr(r,u)},_undoForClFormat:function(n){var r,i=n.wRange.length>n.hRange.length+1?n.wRange.length:n.hRange.length,u,t;for(i=i>n.cFormatRule.length+1?i:n.cFormatRule.length,this._isUndo?this.XLFormat.updateFormat(n.bFormat,n.range):this.XLFormat.clearFormat(n.range),t=0;t<i;t++)n.wRange[t]&&(r=this._getAlphaRange(n.sheetIndex,n.wRange[t].rowIndex,n.wRange[t].colIndex,n.wRange[t].rowIndex,n.wRange[t].colIndex),this._isUndo?this.setWrapText(r):this.setWrapText(r,"unwrap")),n.hRange[t]&&(u=this.getCell(n.hRange[t].rowIndex,n.hRange[t].colIndex),this._isUndo?u.find("a").css("color","#428bca").addClass("e-hyperlinks"):u.find("a").css("color","#444445").removeClass("e-hyperlinks")),n.cFormatRule[t].rule&&(this._isUndo?this.XLCFormat.setCFRule(n.cFormatRule[t].rule):(this.performSelection({rowIndex:n.cFormatRule[t].rowIndex,colIndex:n.cFormatRule[t].colIndex},{rowIndex:n.cFormatRule[t].rowIndex,colIndex:n.cFormatRule[t].colIndex}),this.XLCFormat.clearCF(!0)))},_undoForCLLink:function(n){var i={rowIndex:n.selCells[0].rowIndex,colIndex:n.selCells[0].colIndex},r,u={rowIndex:n.selCells[n.selCells.length-1].rowIndex,colIndex:n.selCells[n.selCells.length-1].colIndex},t,f;for(this.XLSelection.selectRange(i,u),this._isUndo?this._setLink(n.selCells):this._removeHyperlink("clear",n.selCells),this.XLSelection.selectRange(i,u),this.XLDragFill.positionAutoFillElement(),t=0,f=n.selCells.length;t<f;t++)r=n.selCells[t].prevLink,n.selCells[t].prevLink=n.selCells[t].curLink,n.selCells[t].curLink=r},_undoForComment:function(t){var u,r,e,o,f,i,s;for(e={rowIndex:t.selCells[0].rowIndex,colIndex:t.selCells[0].colIndex},o={rowIndex:t.selCells[t.selCells.length-1].rowIndex,colIndex:t.selCells[t.selCells.length-1].colIndex},i=0,s=t.selCells.length;i<s;i++)r={rowIndex:t.selCells[i].rowIndex,colIndex:t.selCells[i].colIndex},u=this.getCell(t.selCells[i].rowIndex,t.selCells[i].colIndex),this.XLSelection.selectRange(r,r),this.getSheet(t.sheetIndex)._startCell=r,t.action==="add"?(t.selCells[i].prevComment=this.XLEdit.getPropertyValueByElem(u,"comment"),this.XLComment.deleteComment()):t.action==="edit"?(n(u.find(".e-comment-txtarea")).val(t.selCells[i].prevComment.value),this.XLComment._updateCurCmntVal(),f=t.selCells[i].prevComment,t.selCells[i].prevComment=t.selCells[i].curComment,t.selCells[i].curComment=f):(this.XLEdit._updateDataContainer(u[0],{comment:t.selCells[i].prevComment}),this.XLComment.setComment(this.getCell(t.selCells[i].rowIndex,t.selCells[i].colIndex),null,!1),this.XLSelection.selectRange(r,r),this.XLComment._updateCurCmntVal(),f=t.selCells[i].prevComment,t.selCells[i].prevComment=t.selCells[i].curComment,t.selCells[i].curComment=f);t.action==="add"?t.action="delete":t.action==="delete"&&(t.action="add");this.XLSelection.selectRange(e,o);this.XLDragFill.positionAutoFillElement()},_undoForCondFormat:function(i){var u,c,f,a,s,l,r,e=[],h,o;if(this._isUndo){if(i.action==="add"){for(o=this.getRange(i.range[0],i.range[1],i.range[2],i.range[3]),l=this.XLEdit.getPropertyValueByElem(n(o[0]),"cFormatRule"),i.poppedRule=l[l.length-1],u=0,f=o.length;u<f;u++)if(h=this.XLEdit.getPropertyValueByElem(n(o[u]),"cFormatRule"),!this.isUndefined(h))for(h.pop(),c=0,a=h.length;c<a;c++)s=h[c],e.length===0?(r=s.indexOf("true")>-1?s.replace("_true",""):s.replace("_false",""),e.push(r)):e=this._addCondFormatRule(e,s);for(o.removeClass("e-redft e-yellowft e-greenft e-redf e-redt"),this.clearRangeData(null,["cFormatRule"],o),u=0,f=e.length;u<f;u++)r=e[u].split("_"),this.XLCFormat._cFormat(r[0],r[2],r[3],r[4],r[5])}else if(i.action==="clear")for(u=0,f=i.rule.length;u<f;u++)this.XLCFormat.setCFRule(i.rule[u][0])}else i.action==="add"?t.isNullOrUndefined(i.poppedRule)||(r=i.poppedRule.split("_"),this.XLCFormat._cFormat(r[0],r[2],r[3],r[4],r[5])):i.action==="clear"&&this.XLCFormat.clearCF(i.selection)},_undoForCopyPaste:function(i){var f={},h=this._dataContainer,c=this.getSheet(i.pSheetIndex)._shapeMngr,e,b,v,u,y,p,d,a,k,w,g,nt,o,tt,s,l,it;if(i.operation==="shape")a=this.getCell(i.pasteCell.rowIndex,i.pasteCell.colIndex,i.pSheetIndex)[0],b=i.pShapeId.indexOf("picture")>-1?"picture":"chart",c[b].some(function(n,t){return i.pShapeId===n.id?(v=t,!0):!1}),e=n.extend(!0,{},i.pasteCell.obj),t.isNullOrUndefined(e)||(this.XLShape._picCellIdx={rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},b==="chart"?"chart"in e&&(this._isUndo?(f=n.extend(!0,{},c.chart[v]),t.isNullOrUndefined(h.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(h.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),h.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=e,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+f.id))):(this.getCell(i.pasteCell.rowIndex,i.pasteCell.colIndex,i.pSheetIndex).addClass("e-activecell"),f=n.extend(!0,{},c.chart[v]),o=f.range,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,o[0],o[1],o[2],o[3]),f),this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.cSheetIndex))):"picture"in e&&(this._isUndo?(f=n.extend(!0,{},c.picture[v]),t.isNullOrUndefined(h.sheets[sheetIdx][i.pasteCell.rowIndex])&&(h.sheets[sheetIdx][i.pasteCell.rowIndex]={}),h.sheets[sheetIdx][i.pasteCell.rowIndex][i.pasteCell.colIndex]=e,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+f.id))):(f=n.extend(!0,{},c.picture[v]),w=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.pSheetIndex,a,c.sharedPics[f.data],f.top,f.left,f.width,f.height,parseInt(f.id.replace(w,""))))));else{for(h=this._dataContainer,k=[],u=0,p=i.text.length;u<p;u++)for(y=0,d=i.text[u].split("\t").length;y<d;y++)k.push(i.text[u].split("\t")[y]);for(this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),this.setActiveSheetIndex(i.pSheetIndex),u=0,p=i.pasteCells.length;u<p;u++)if(a=this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex)[0],a!==r){if(a.textContent=this._isUndo?"":k[u],e=t.isNullOrUndefined(h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex])?{}:h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex],this._isUndo||"isMerge"in i.pasteCells[u].prevObj&&(this._mergeCenter=i.pasteCells[u].prevObj.isCenterAlign,this.mergeCells(i.pasteCells[u].prevObj.mRange,!0)),!t.isNullOrUndefined(e)){if("picture"in e)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[u].rowIndex,colIndex:i.pasteCells[u].colIndex},s=0,l=e.picture.length;s<l;s++)f=n.extend(!0,{},c.picture[e.picture[s]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+f.id));if("chart"in e)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[u].rowIndex,colIndex:i.pasteCells[u].colIndex},s=0,l=e.chart.length;s<l;s++)f=n.extend(!0,{},c.chart[e.chart[s]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+f.id));"isMerge"in e&&this._isUndo&&(i.pasteCells[u].newObj=n.extend(!0,{},h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex]),this.unmergeCells(this._getAlphaRange(i.pSheetIndex,i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex)),this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex).removeAttr("rowspan").removeAttr("colspan"),"isMerge"in i.pasteCells[u].prevObj&&(this._mergeCenter=i.pasteCells[u].prevObj.isCenterAlign,this.mergeCells(i.pasteCells[u].prevObj.mRange,!0),this._mergeCenter=!1))}if(t.isNullOrUndefined(h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex])&&(h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex]={}),h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex]=n.extend(!0,{},i.pasteCells[u].prevObj),tt=i.pasteCells[u].prevObj,i.pasteCells[u].prevObj=i.pasteCells[u].newObj,i.pasteCells[u].newObj=tt,this._setRowHdrHeight(i.pSheetIndex,n(a).parent().index()),e=t.isNullOrUndefined(h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex])?{}:h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex],g=i.pasteCells[u].rowIndex,nt=i.pasteCells[u].colIndex,this._applyCommentLink(e,a,g,nt),this._isPaste=!0,!t.isNullOrUndefined(e)){if("picture"in e)for(s=0,l=e.picture.length;s<l;s++)f=n.extend(!0,{},c.picture[e.picture[s]]),w=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.pSheetIndex,a,c.sharedPics[f.data],f.top,f.left,f.width,f.height,parseInt(f.id.replace(w,"")));if("chart"in e){for(o=e.chart[0].range,this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex).addClass("e-activecell"),s=0,l=e.chart.length;s<l;s++)f=n.extend(!0,{},c.chart[e.chart[s]]),this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.pSheetIndex,o[0],o[1],o[2],o[3]),f);this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.pSheetIndex)}this._isPaste=!1}}i.isSpecial&&(this.XLFormat.clearFormat(i.pasteBorder.range),this.XLFormat.updateFormat(i.pasteBorder.prevBorder,i.pasteBorder.range),it=i.pasteBorder.prevBorder,i.pasteBorder.prevBorder=i.pasteBorder.newBorder,i.pasteBorder.newBorder=it);this._isUndo?(t.isNullOrUndefined(i.cSheetIndex)||this.setActiveSheetIndex(i.cSheetIndex),i.cutCells.length>0&&this.XLSelection._focusBorder(i.cutCells[0],i.cutCells[i.cutCells.length-1],this._cutFocus),this.setActiveSheetIndex(i.sheetIndex),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])):(i.cutCells.length>0&&this.XLSelection._focusBorder(i.cutCells[0],i.cutCells[i.cutCells.length-1],this._cutFocus),this.setActiveSheetIndex(i.pSheetIndex),i.pasteCells.length>0&&this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1]))}this.XLDragFill.positionAutoFillElement()},_undoForCutPaste:function(i){var f,o={},l=this._dataContainer,c=this.getSheet(i.pSheetIndex)._shapeMngr,v,y,w,ut,ft,b,d,g,nt,a,rt,u,tt,it,et,s,e,h,ct,lt,at;if(i.operation==="shape")a=this.getCell(i.pasteCell.rowIndex,i.pasteCell.colIndex,i.pSheetIndex)[0],y=i.pShapeId.indexOf("picture")>-1?"picture":"chart",c[y].some(function(n,t){return i.pShapeId===n.id?(w=t,!0):!1}),f=n.extend(!0,{},i.pasteCell.obj),t.isNullOrUndefined(f)||(this.XLShape._picCellIdx={rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},o=n.extend(!0,{},c[y][w]),t.isNullOrUndefined(l.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(l.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),l.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=f,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+o.id))),f=n.extend(!0,{},i.cutCell.obj),y=i.cShapeId.indexOf("picture")>-1?"picture":"chart",c[y].some(function(n,t){return i.cShapeId===n.id?(w=t,!0):!1}),t.isNullOrUndefined(f)||(this.getCell(i.cutCell.rowIndex,i.cutCell.colIndex,i.cSheetIndex).addClass("e-activecell"),y==="chart"?"chart"in f&&(o=n.extend(!0,{},c.chart[w]),s=o.range,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,s[0],s[1],s[2],s[3]),o),this.XLSelection.selectRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]},i.cSheetIndex)):"picture"in f&&(a=this.getCell(i.cutCell.rowIndex,i.cutCell.colIndex,i.cSheetIndex)[0],o=n.extend(!0,{},c.picture[w]),v=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.cSheetIndex,a,c.sharedPics[o.data],o.top,o.left,o.width,o.height,parseInt(o.id.replace(v,""))))),this.XLShape._picCellIdx={rowIndex:i.cutCell.rowIndex,colIndex:i.cutCell.colIndex},ut=i.pasteCell,i.pasteCell=i.cutCell,i.cutCell=ut,ft=i.pShapeId,i.pShapeId=i.cShapeId,i.cShapeId=ft;else{for(l=this._dataContainer,rt=[],this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),u=0,it=i.text.length;u<it;u++)for(tt=0,et=i.text[u].split("\t").length;tt<et;tt++)rt.push(i.text[u].split("\t")[tt]);for(u=0,it=i.pasteCells.length;u<it;u++){if(!t.isNullOrUndefined(i.pSheetIndex)&&(a=this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex)[0],a!==r)){if(a.textContent="",f=l.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex],!t.isNullOrUndefined(f)){if("picture"in f)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[u].rowIndex,colIndex:i.pasteCells[u].colIndex},e=0,h=f.picture.length;e<h;e++)o=n.extend(!0,{},c.picture[f.picture[e]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+o.id));if("chart"in f)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[u].rowIndex,colIndex:i.pasteCells[u].colIndex},e=0,h=f.chart.length;e<h;e++)o=n.extend(!0,{},c.chart[f.chart[e]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+o.id));"isMerge"in f&&(this._isUndo?(n.extend(!0,i.pasteCells[u].newObj,l.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex]),this.setActiveSheetIndex(i.pSheetIndex),this.unmergeCells(f.mRange),this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex).removeAttr("rowspan").removeAttr("colspan"),"isMerge"in i.pasteCells[u].prevObj&&(this._mergeCenter=i.pasteCells[u].prevObj.isCenterAlign,this.mergeCells(i.pasteCells[u].prevObj.mRange,!0),this._mergeCenter=!1)):(this.setActiveSheetIndex(i.pSheetIndex),this.unmergeCells(f.mRange,!0),"isMerge"in i.pasteCells[u].prevObj&&(this._mergeCenter=i.pasteCells[u].prevObj.isCenterAlign,this.mergeCells(i.pasteCells[u].prevObj.mRange,!0),this._mergeCenter=!1),this.setActiveSheetIndex(i.cSheetIndex),this.unmergeCells(this._getAlphaRange(i.pSheetIndex,i.cutCells[u].rowIndex,i.cutCells[u].colIndex,i.cutCells[u].rowIndex,i.cutCells[u].colIndex)),s=this.getRangeIndices(i.cutCells[u].prevObj.mRange),this.XLSelection.selectRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]},i.sheetIndex)))}if(l.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex]=n.extend(!0,{},i.pasteCells[u].prevObj),d=i.pasteCells[u].prevObj,i.pasteCells[u].prevObj=i.pasteCells[u].newObj,i.pasteCells[u].newObj=d,this._setRowHdrHeight(i.pSheetIndex,n(a).parent().index()),f=l.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex],g=i.pasteCells[u].rowIndex,nt=i.pasteCells[u].colIndex,this._applyCommentLink(f,a,g,nt),this._isPaste=!0,!t.isNullOrUndefined(f)){if("picture"in f)for(e=0,h=f.picture.length;e<h;e++)o=n.extend(!0,{},c.picture[f.picture[e]]),v=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.pSheetIndex,a,c.sharedPics[o.data],o.top,o.left,o.width,o.height,parseInt(o.id.replace(v,"")));if("chart"in f){for(this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex).addClass("e-activecell"),e=0,h=f.chart.length;e<h;e++)o=n.extend(!0,{},c.chart[f.chart[e]]),s=o.range,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,s[0],s[1],s[2],s[3]),o);this.XLSelection.selectRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]},i.pSheetIndex)}}this._isPaste=!1}if(!t.isNullOrUndefined(i.cSheetIndex)&&(b=this.getCell(i.cutCells[u].rowIndex,i.cutCells[u].colIndex,i.cSheetIndex)[0],!t.isNullOrUndefined(b))){if(b.textContent=rt[u],this.setActiveSheetIndex(i.cSheetIndex),f=t.isNullOrUndefined(l.sheets[i.cSheetIndex][i.cutCells[u].rowIndex])?{}:l.sheets[i.cSheetIndex][i.cutCells[u].rowIndex][i.cutCells[u].colIndex],!t.isNullOrUndefined(f)){if("picture"in f)for(this.XLShape._picCellIdx={rowIndex:i.cutCells[u].rowIndex,colIndex:i.cutCells[u].colIndex},e=0,h=f.picture.length;e<h;e++)o=n.extend(!0,{},c.picture[f.picture[e]]),this.XLShape._deleteShape(i.cSheetIndex,this.element.find("#"+o.id));if("chart"in f)for(this.XLShape._picCellIdx={rowIndex:i.cutCells[u].rowIndex,colIndex:i.cutCells[u].colIndex},e=0,h=f.chart.length;e<h;e++)o=n.extend(!0,{},c.chart[f.chart[e]]),this.XLShape._deleteShape(i.cSheetIndex,this.element.find("#"+o.id))}if(t.isNullOrUndefined(l.sheets[i.cSheetIndex][i.cutCells[u].rowIndex])&&(l.sheets[i.cSheetIndex][i.cutCells[u].rowIndex]={}),l.sheets[i.cSheetIndex][i.cutCells[u].rowIndex][i.cutCells[u].colIndex]=n.extend(!0,{},i.cutCells[u].prevObj),d=i.cutCells[u].prevObj,i.cutCells[u].prevObj=i.cutCells[u].newObj,i.cutCells[u].newObj=d,this._setRowHdrHeight(i.cSheetIndex,n(b).parent().index()),f=t.isNullOrUndefined(l.sheets[i.cSheetIndex][i.cutCells[u].rowIndex])?{}:l.sheets[i.cSheetIndex][i.cutCells[u].rowIndex][i.cutCells[u].colIndex],g=i.cutCells[u].rowIndex,nt=i.cutCells[u].colIndex,this._applyCommentLink(f,b,g,nt),this._isPaste=!0,!t.isNullOrUndefined(f)){if("picture"in f)for(e=0,h=f.picture.length;e<h;e++)o=n.extend(!0,{},c.picture[f.picture[e]]),v=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.cSheetIndex,a,c.sharedPics[o.data],o.top,o.left,o.width,o.height,parseInt(o.id.replace(v,"")));if("chart"in f){for(this.getCell(i.cutCells[u].rowIndex,i.cutCells[u].colIndex,i.cSheetIndex).addClass("e-activecell"),e=0,h=f.chart.length;e<h;e++)o=n.extend(!0,{},c.chart[f.chart[e]]),s=o.range,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.cSheetIndex,s[0],s[1],s[2],s[3]),o);this.XLSelection.selectRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]},i.cSheetIndex)}"isMerge"in f&&(this._mergeCenter=f.isCenterAlign,this.mergeCells(f.mRange,!0),this._mergeCenter=!1)}this._isPaste=!1}}if(i.isSpecial&&(t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLFormat.clearFormat(i.pasteBorder.range),this.XLFormat.updateFormat(i.pasteBorder.prevBorder,i.pasteBorder.range)),nBrdr=i.pasteBorder.prevBorder,i.pasteBorder.prevBorder=i.pasteBorder.newBorder,i.pasteBorder.newBorder=nBrdr,t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLFormat.clearFormat(i.cutBorder.range),this.XLFormat.updateFormat(i.cutBorder.prevBorder,i.cutBorder.range)),nBrdr=i.cutBorder.prevBorder,i.cutBorder.prevBorder=i.cutBorder.newBorder,i.cutBorder.newBorder=nBrdr),!t.isNullOrUndefined(i.pfat)){var ot,p=i.pfat.table,k,st=i.pfat.minRowIdx,ht=i.pfat.minColIdx;for(s=i.pfat.range,e=0,h=p.length;e<h;e++)k=p[e].range,t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLFormat.removeTable(n.trim(p[e].tblObj.name.replace("Table","")))),t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this._isUndo?this.XLFormat.createTable(p[e].tblObj,p[e].range):(ot=this.getRangeIndices(this._getAlphaRange(i.cSheetIndex,k[0]+st-s[0],k[1]+ht-s[1],st-s[0]+k[2],ht-s[1]+k[3])),this.XLFormat.createTable(p[e].tblObj,ot)))}t.isNullOrUndefined(i.filter)||(this.XLFilter.clearFilter(),this.XLFilter.filter(details.filter));this._isUndo?(t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLSelection.selectRange(i.cutCells[0],i.cutCells[i.cutCells.length-1])),t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1]))):(t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection._focusBorder(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1],this._cutFocus),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])),t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLSelection.selectRange(i.cutCells[0],i.cutCells[i.cutCells.length-1])));this.XLDragFill.positionAutoFillElement();ct=i.pasteCells;i.pasteCells=i.cutCells;i.cutCells=ct;lt=i.pasteBorder;i.pasteBorder=i.cutBorder;i.cutBorder=lt;at=i.cSheetIndex;i.cSheetIndex=i.pSheetIndex;i.pSheetIndex=at}},_undoForDel:function(t){n.extend(!0,this._delCells,t.delCells);this._deletedText=n.extend(!0,[],t.text);switch(t.action){case"deleteShiftUp":this.deleteShiftUp(t.startCell,t.endCell);break;case"deleteShiftLeft":this.deleteShiftLeft(t.startCell,t.endCell);break;case"deleteRow":this.deleteEntireRow(t.startCell,t.endCell);break;case"deleteColumn":this.deleteEntireColumn(t.startCell,t.endCell)}},_undoForEdit:function(i){var f,e,u={rowIndex:i.rowIndex,colIndex:i.colIndex},o,r=this.getCell(i.rowIndex,i.colIndex),s;this.setActiveCell(i.rowIndex,i.colIndex,i.sheetIndex);this.XLSelection.selectRange(u,u);this.XLDragFill.positionAutoFillElement();s=r.find("a");s.length>0&&(i.action=r.text().length<1?"add":"delete",i.reqType="edit",u.prevLink=this.XLEdit.getPropertyValueByElem(r,"hyperlink"),u.prevText=r.text(),i.selCells=[]);n(".e-selected.e-commentcell").length>0&&(o=this.XLEdit.getPropertyValueByElem(r,"comment"));this.XLEdit.updateCellValue(r,i.pValue);e=this.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"hyperlink",i.sheetIndex);e&&(e.webAdr?r.html(t.buildTag("a",r.text(),"",{href:e.webAdr,target:"_blank","class":"e-hyperlinks"})):r.html(t.buildTag("a",r.text(),"",{href:"#","class":"e-hyperlinks"})));s.length>0&&(u.curLink=this.XLEdit.getPropertyValueByElem(r,"hyperlink"),u.curText=r.text(),i.selCells.push(u));t.isNullOrUndefined(o)||(this.XLEdit._updateDataContainer(r[0],{comment:o}),r.removeClass("e-commentcell"),this.XLComment.setComment(),this.XLComment._updateCurCmntVal());this._setRowHdrHeight(i.sheetIndex,r.parent().index());f=i.cValue;i.cValue=i.pValue;i.pValue=f;this.XLEdit._isEdit=!1;f=i.previousValue;i.previousValue=i.value;i.value=f},_undoForFilter:function(i){var h=!1,e=[],u,o,s=[],r,f,c,l;if(i.operation==="filter"&&i.requestType!=="filterbycell")if(this._isUndo){for(r=this._undoCollection.length-1;r>=0;r--){if(this._undoCollection[r].reqType==="filter"&&this._undoCollection[r].tableID===i.tableID&&this._undoCollection[r].action==="filtering"&&this._undoCollection[r].status!=="apply-filterIcon"){for(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],u=this._undoCollection[r],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,u.tableID),r=0,f=u.filterCollection.length;r<f;r++)e.push(u.filterCollection[r]);this.model.sheets[u.sheetIndex].filterSettings.filteredColumns=e;t.isNullOrUndefined(this._excelFilter._predicates[u.sheetIndex][u.fieldName])&&(this._excelFilter._predicates[u.sheetIndex][u.fieldName]={});this._excelFilter._predicates[u.sheetIndex][u.fieldName]=u.ejpredicate;this.model.sheets[u.sheetIndex]._selectedRange=u.range;this.XLFilter._filterHandler(u);c="undo";h=!0;break}if(this._undoCollection[r].requestType==="filterbycell"){u=this._undoCollection[r];delete this._excelFilter._predicates[u.sheetIndex][u.fieldName];this.XLFilter._clearFilterColumn(u.fieldName,"","","Or",null,null,u.tableID);n.extend(!0,s,u.selCells);this.XLFilter._filterActiveCell(u.sheetIndex,u.activeCell,s,u.filteredValue);c="undo";h=!0;break}}h||(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID))}else{for(e=[],delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),r=0,f=i.filterCollection.length;r<f;r++)e.push(i.filterCollection[r]);this.model.sheets[i.sheetIndex].filterSettings.filteredColumns=e;t.isNullOrUndefined(this._excelFilter._predicates[i.sheetIndex][i.fieldName])&&(this._excelFilter._predicates[i.sheetIndex][i.fieldName]={});this._excelFilter._predicates[i.sheetIndex][i.fieldName]=i.ejpredicate;this.XLFilter._filterHandler(i);c="redo"}else if(this._isUndo){if(i.operation==="apply-filter"&&i.requestType!=="filterbycell"){for(r=0,f=i.filteredCells.length;r<f;r++)i.filteredCells[r].find(".e-ssfilter").remove(),this.isNumber(i.filteredCells[r].text())&&i.filteredCells[r].addClass(this._rAlign);i.operation="remove-filter"}if(i.requestType==="filterbycell"){for(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),r=i.activeCell.colIndex,f=i.selCells[i.selCells.length-1].colIndex;r<=f;r++)o=this.getCell(i.activeCell.rowIndex,r),o.find("span.e-ssfilter").remove(),o.addClass(this._rAlign);i.operation="remove-filter"}}else if(i.operation==="remove-filter"){if(i.requestType==="filterbycell")o=this.getCell(i.activeCell.rowIndex,i.activeCell.colIndex),o.find("span.e-ssfilter").remove(),delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),n.extend(!0,s,i.selCells),this.XLFilter._filterActiveCell(i.sheetIndex,i.activeCell,s,i.filteredValue);else for(r=0,f=i.filteredCells.length;r<f;r++)l=this.XLFilter._getFilterIcon(),this.XLFilter._applyFilterIcon(i.filteredCells[r],l),i.filteredCells[r].removeClass(this._rAlign);i.operation="apply-filter"}},_undoForFilterByColor:function(n){for(var r=!1,i=this._isUndo?this._undoCollection:this._redoCollection,t=i.length-1;t>=0;t--)if(i[t].reqType==="filterbycolor"&&i[t].tableID===n.tableID){this.XLFilter._filterHandler(i[t]);r=!0;break}r||(delete this._excelFilter._predicates[n.sheetIndex][n.columnName],this.XLFilter._clearFilterColumn(n.columnName,"","","Or",null,null,n.tableID))},_undoForFind:function(n){var i,t,r,u;switch(n.operation){case"replace":i=this.getCell(n.rowIndex,n.colIndex,n.sheetIndex);this.XLEdit.updateCell(i,n.selCells[t].prevData.value,n.sheetIndex);i.text(n.prevData.value);u=n.prevData;n.prevData=n.newData;n.newData=u;this.XLSelection.selectRange({rowIndex:n.rowIndex,colIndex:n.colIndex},{rowIndex:n.rowIndex,colIndex:n.colIndex});break;case"replaceAll":for(t=0,r=n.selCells.length;t<r;t++)i=this.getCell(n.selCells[t].rowIndex,n.selCells[t].colIndex,n.selCells[t].sheetIndex),this.XLEdit.updateCell(i,n.selCells[t].prevData.value,n.selCells[t].sheetIndex),i.text(n.selCells[t].prevData.value),u=n.selCells[t].prevData,n.selCells[t].prevData=n.selCells[t].newData,n.selCells[t].newData=u;break;case"blanks":case"conditions":case"validations":case"formulas":case"rowdiff":case"coldiff":case"comments":case"constants":for(t=0,r=n.selCells.length;t<r;t++)i=this.getCell(n.selCells[t].rowIndex,n.selCells[t].colIndex,n.sheetIndex),this._isUndo?i.operation==="coldiff"||i.operation==="rowdiff"?n.selCells[t].isApply?i.removeClass("e-goto-blank"):i.addClass("e-goto-blank"):n.selCells[t].isApply?i.addClass("e-goto-blank"):i.removeClass("e-goto-blank"):i.removeClass("e-goto-blank")}},_undoForFormat:function(n){var h=[],c,r,e,o=this._dataContainer,f,u,i,s;if(t.isNullOrUndefined(n.process))for((t.isNullOrUndefined(n.action)||n.action!=="decimal")&&(this.XLFormat.clearFormat(n.range),this.XLFormat.updateFormat(n.beforeFormat,n.range),u=n.beforeFormat,n.beforeFormat=n.afterFormat,n.afterFormat=u),c={startCell:n.selCell[0],endCell:n.selCell[n.selCell.length-1]},i=0,s=n.selCell.length;i<s;i++)r=n.selCell[i],e=this.getCell(r.rowIndex,r.colIndex),t.isNullOrUndefined(o.sheets[n.sheetIndex][r.rowIndex])||t.isNullOrUndefined(o.sheets[n.sheetIndex][r.rowIndex][r.colIndex])||(o.sheets[n.sheetIndex][r.rowIndex][r.colIndex]=n.selCell[i].beforeFormat,f=this.XLEdit.getPropertyValueByElem(e,"value2"),h.push({data:f}),e[0].innerHTML=t.isNullOrUndefined(f)?"":f),n.selCell[0].colIndex===n.selCell[i].colIndex&&(this._isUndo?this.XLResize.setRowHeight(n.selCell[i].rowIndex,n.selCell[i].bRowHeight):this.XLResize.setRowHeight(n.selCell[i].rowIndex,n.selCell[i].aRowHeight)),u=n.selCell[i].beforeFormat,n.selCell[i].beforeFormat=n.selCell[i].afterFormat,n.selCell[i].afterFormat=u;!t.isNullOrUndefined(n.process)&&n.process.indexOf("border")>-1&&(this.XLFormat.clearFormat(n.range),this.XLFormat.updateFormat(n.beforeFormat,n.range),u=n.beforeFormat,n.beforeFormat=n.afterFormat,n.afterFormat=u);n.status="undo-cellformat"},_undoForFormatPaint:function(t){for(var u,r,f=this._formatRegx,e=this._borderRegx,i=0,o=t.selCells.length;i<o;i++)r=this.getCell(t.selCells[i].rowIndex,t.selCells[i].colIndex)[0],r.className.indexOf("e-format")&&(r.className=r.className.replace(f,"")),n(r).addClass(t.selCells[i].bFormat),r.className.indexOf("e-border")&&(r.className=r.className.replace(e,"")),n(r).addClass(t.selCells[i].bBorder),n(r).text(t.selCells[i].bVal),n(r).data(t.selCells[i].bData),u=t.selCells[i].bFormat,t.selCells[i].bFormat=t.selCells[i].aFormat,t.selCells[i].aFormat=u,u=t.selCells[i].bBorder,t.selCells[i].bBorder=t.selCells[i].aBorder,t.selCells[i].aBorder=u,u=t.selCells[i].bData,t.selCells[i].bBorder=t.selCells[i].aData,t.selCells[i].aBorder=u,u=t.selCells[i].bVal,t.selCells[i].bVal=t.selCells[i].aVal,t.selCells[i].aVal=u},_undoForFormatTable:function(t){var o,v,e,f,u=t.sheetIndex,i=this.getSheet(u)._tableManager,h,y=this,r=t.header,s,p,c,l,a;switch(t.action){case"convertorange":if(this._isUndo){for(i[t.tableID]={name:"Table"+t.tableID,range:t.beforeRange,format:t.format,formatName:t.formatName},this.XLFilter._filterCellRange(u,this._getProperAlphaRange(u,i[t.tableID].range[0],i[t.tableID].range[1],i[t.tableID].range[2],i[t.tableID].range[3])),s=i[t.tableID].range[1],p=i[t.tableID].range[3]+1;s<p;s++)for(o=i[t.tableID].range[0],v=i[t.tableID].range[2]+1;o<v;o++)this.getCell(o,s,u).addClass("e-table"+t.tableID).find("span").addClass("e-ft"+t.tableID);this.model.sheets[u].filterSettings.tableRange[t.tableID]=t.tableRange}else t.tableID in i&&(h="e-table"+t.tableID,y.element.find("."+h).removeClass(h),y.XLFilter._clearFilterTable(u,t.tableID),delete i[t.tableID],delete this.model.sheets[u]._header[t.tableID]);break;case"filtericon":c=n("#"+t.id).data("ejCheckBox");t.check?c.option("checked",!1):c.option("checked",!0);t.check=!t.check;this.XLFilter._clearFilterTableIcon(t.sheetIndex,parseInt(t.tableId));break;case"firstlastcolumn":l=n("#"+t.id).data("ejCheckBox");t.check?(this.XLFormat.format({style:{"font-weight":"normal"}},t.range),l.option("checked",!1)):(this.XLFormat.format({style:{"font-weight":"bold"}},t.range),l.option("checked",!0));t.check=!t.check;break;case"totalrow":a=n("#"+t.id).data("ejCheckBox");t.check?(this.XLEdit.updateCellValue(n(t.cell[0]),""),this.XLEdit.updateCellValue(n(t.cell[t.cell.length-1]),""),"totalRow"in t.tmgr[t.tid]&&delete t.tmgr[t.tid].totalRow,a.option("checked",!1)):(this.XLEdit.updateCellValue(n(t.cell[0]),"Total"),this.XLEdit.updateCellValue(n(t.cell[t.cell.length-1]),"=SUM("+t.range+")"),t.tmgr[t.tid].totalRow=!0,a.option("checked",!0));t.check=!t.check;break;case"resizetable":this._isUndo?(this._isFATResize=!0,this.XLFormat.removeTable(t.tableId),this.XLFormat.clearFormat(t.afterRange),e=t.beforeRange[3]-t.beforeRange[1]+1,f=r[t.tableId].header?this.getRangeData(t.beforeRange):this.getRangeData(t.beforeRange).splice(e,this.getRangeData(t.beforeRange).length),this.clearRangeData(t.beforeRange),r[t.tableId].header?this.updateData(f,[t.beforeRange[0],t.beforeRange[1],t.beforeRange[2],t.beforeRange[3]]):this.updateData(f,[t.beforeRange[0],t.beforeRange[1],t.beforeRange[2]-1,t.beforeRange[3]]),i[t.tableId]={header:r[t.tableId].header,name:"Table"+t.tableId,range:t.beforeRange,format:t.format,formatName:t.formatName},r[t.tableId].header?this.XLFormat.createTable(i[t.tableId],t.beforeRange):this.XLFormat.createTable(i[t.tableId],[t.beforeRange[0],t.beforeRange[1],t.beforeRange[2]-1,t.beforeRange[3]])):(this._isFATResize=!0,this.XLFormat.removeTable(t.tableId),this.XLFormat.clearFormat(t.beforeRange),e=t.beforeRange[3]-t.beforeRange[1]+1,f=r[t.tableId].header?this.getRangeData(t.afterRange):this.getRangeData(t.afterRange).splice(e,this.getRangeData(t.afterRange).length),this.clearRangeData(t.afterRange),r[t.tableId].header?this.updateData(f,t.afterRange):this.updateData(f,[t.afterRange[0],t.afterRange[1],t.afterRange[2]-1,t.afterRange[3]]),i[t.tableId]={header:r[t.tableId].header,name:"Table"+t.tableId,range:t.beforeRange,format:t.format,formatName:t.formatName},r[t.tableId].header?this.XLFormat.createTable(i[t.tableId],t.afterRange):this.XLFormat.createTable(i[t.tableId],[t.afterRange[0],t.afterRange[1],t.afterRange[2]-1,t.afterRange[3]]));break;default:this._isUndo?(this.XLFormat.removeTable(t.tableID),this.XLFormat.clearFormat(t.afterRange),t.tableStyle.header||(e=t.afterRange[3]-t.afterRange[1]+1,this.clearRangeData(t.afterRange),this.updateData(n.extend(!0,[],t.beforeRangeData),t.afterRange)),this.XLFormat.updateFormat(t.beforeFormat,t.afterRange)):(i[t.tableID]={name:"Table"+t.tableID,range:t.beforeRange},this.XLFormat.createTable(t.tableStyle,t.beforeRange))}},_undoForHyperlink:function(n){var i={rowIndex:n.selCells[n.selCells.length-1].rowIndex,colIndex:n.selCells[n.selCells.length-1].colIndex},r={rowIndex:n.selCells[0].rowIndex,colIndex:n.selCells[0].colIndex},t,u,f,e;for(this.XLSelection.selectRange(r,i),n.action==="add"?(this.XLSelection.selectRange(r,i),this._removeHyperlink(n.reqType,n.selCells)):n.action==="edit"?(this.XLSelection.selectRange(r,i),this._setLink(n.selCells)):(this.XLSelection.selectRange(r,i),this._setLink(n.selCells)),t=0,u=n.selCells.length;t<u;t++)f=n.selCells[t].prevLink,n.selCells[t].prevLink=n.selCells[t].curLink,n.selCells[t].curLink=f,e=n.selCells[t].prevText,n.selCells[t].prevText=n.selCells[t].curText,n.selCells[t].curText=e;n.action==="add"?n.action="delete":n.action==="delete"&&(n.action="add");this.XLSelection.selectRange(r,i);this.XLDragFill.positionAutoFillElement()},_undoForIns:function(t){n.extend(!0,this._delCells,t.delCells);n.extend(!0,this._deletedText,t.text);switch(t.action){case"insertShiftRight":this.insertShiftRight(t.startCell,t.endCell);break;case"insertShiftBottom":this.insertShiftBottom(t.startCell,t.endCell);break;case"insertRow":this.insertEntireRow(t.startCell,t.endCell);break;case"insertColumn":this.insertEntireColumn(t.startCell,t.endCell)}},_undoForMerge:function(n){var r,u,e,o,i,f;this._delCells=n.hideCells;this._selMergeCells=[];switch(n.action){case"merge-all":case"merge-across":case"un-merge":for(i=0,f=n.mCells.length;i<f;i++)n.action==="un-merge"?t.isNullOrUndefined(n.mCells[i].prevObj.mRange)||(r=this.getRangeIndices(n.mCells[i].prevObj.mRange),u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),this._mergeCenter=n.mCells[i].prevObj.isCenterAlign,this._mergeCells(n.sheetIndex,u,{},[])):(e=this._getHiddenRowColumnCount(n.sheetIndex,n.mCells[i].curObj.mRange),this._unMergeAllCells(n.sheetIndex,i,n.mCells,[],e.hRow,e.hCol)),o=n.mCells[i].prevObj,n.mCells[i].prevObj=n.mCells[i].curObj,n.mCells[i].curObj=o;if(n.action!=="un-merge")for(i=0,f=n.mCells.length;i<f;i++)t.isNullOrUndefined(n.mCells[i].curObj)||t.isNullOrUndefined(n.mCells[i].curObj.mRange)||(r=this.getRangeIndices(n.mCells[i].curObj.mRange),u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),this._mergeCenter=n.mCells[i].curObj.isCenterAlign,this._mergeCells(n.sheetIndex,u,{},[]));n.action=n.action==="un-merge"?"merge-all":"un-merge"}r=this._getSelectedCells(n.sheetIndex,n.range);u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]});this.performSelection(u[0],u[u.length-1]);this._delCells=[]},_undoForNameMngr:function(n){t.isNullOrUndefined(n.actionType)?n.action==="delete"?(this.XLRibbon.removeNamedRange(n.name),n.action="add"):n.action==="add"&&(this.XLRibbon.addNamedRange(n.name,n.refersTo,n.comment),n.action="delete"):n.action==="delete"?(this.XLRibbon.addNamedRange(n.value.name,n.value.refersto,n.value.comment),this.XLRibbon.removeNamedRange(n.name),n.action="add"):(this.XLRibbon.addNamedRange(n.name,n.refersTo,n.comment),this.XLRibbon.removeNamedRange(n.value.name),n.action="delete")},_undoForReOrder:function(t){this._isUndo?(this.XLComment.deleteComment(),this.clearRangeData(t.destinationRange),this.XLFormat.clearFormat(t.destinationRange),this.updateData(n.extend(!0,[],t.sourceData),t.sourceRange),this.updateData(n.extend(!0,[],t.destinationData),t.destinationRange),this.XLFormat.updateFormat(t.sourceFormat,t.sourceRange),this.XLFormat.updateFormat(t.destinationFormat,t.destinationRange),this.setActiveCell(t.sourceRange[0],t.sourceRange[1]),this.XLSelection.selectRange({rowIndex:t.sourceRange[0],colIndex:t.sourceRange[1]},{rowIndex:t.sourceRange[2],colIndex:t.sourceRange[3]},t.sheetIndex),this.XLDragFill.positionAutoFillElement()):(this.XLSelection.selectRange({rowIndex:t.sourceRange[0],colIndex:t.sourceRange[1]},{rowIndex:t.sourceRange[2],colIndex:t.sourceRange[3]},t.sheetIndex),this.XLComment.deleteComment(),this.clearRangeData(t.sourceRange),this.clearRangeData(t.destinationRange),this.XLFormat.clearFormat(t.sourceRange),this.XLFormat.clearFormat(t.destinationRange),this.updateData(n.extend(!0,[],t.sourceData),t.destinationRange),this.XLFormat.updateFormat(t.sourceFormat,t.destinationRange),this.setActiveCell(t.destinationRange[0],t.destinationRange[1]),this.XLSelection.selectRange({rowIndex:t.destinationRange[0],colIndex:t.destinationRange[1]},{rowIndex:t.destinationRange[2],colIndex:t.destinationRange[3]},t.sheetIndex),this.XLDragFill.positionAutoFillElement())},_undoForPivot:function(n){var t=this._isUndo?this._undoCollection:this._redoCollection,i={curOperation:n,prevOperation:t[t.length-1],isUndo:this._isUndo};this._trigger("_readUndoRedo",i)},_undoForResizeCol:function(n){this.XLResize.setColWidth(n.colIndex,n.oldWidth);var t=n.oldWidth;n.oldWidth=n.newWidth;n.newWidth=t},_undoForResizeRow:function(n){this.XLResize.setRowHeight(n.rowIndex,n.oldHeight);var t=n.oldHeight;n.oldHeight=n.newHeight;n.newHeight=t},_undoForResizeFHeight:function(n){this.XLResize.setRowHeight(n.rowIndex,n.newHeight);this.XLDragFill.positionAutoFillElement()},_undoForResizeFWidth:function(n){var t=this.getCell(0,n.colIndex).get(0),i=n.newWidth;n.newWidth=t.offsetWidth===n.oldWidth?n.newWidth:n.oldWidth;n.oldWidth=i;this.XLResize._applyWidth(n.target,n.sheetIndex,n.colIndex,n.newWidth);this.XLDragFill.positionAutoFillElement()},_undoForShape:function(i){var u,r,a,v,c,l,b,h,k,d,o,e;i.action!=="create"&&i.action!=="remove"&&i.action!=="edit"&&i.action!=="border"&&i.action!=="resetpic"&&i.action!=="changepic"&&i.action!=="picturesize"&&i.action!=="chartTheme"&&i.action!=="chartType"&&(u=n("#"+i.cid).data("ejChart"),r=this.getSheet(i.sheetIndex)._shapeMngr.chart[this.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"chart")[0]]);switch(i.action){case"remove":this.XLShape._picCellIdx=this.XLShape._getCellIndexFromOffset(i.position.top,i.position.left);this.XLShape._deleteShape(i.sheetIndex,n("#"+i.id));i.action="create";break;case"create":i.shapeType==="picture"?(this.XLShape._createPicture(i.sheetIndex,i.actCell,i.img,i.position.top,i.position.left,i.position.width,i.position.height,i.cnt),n(i.actCell).addClass("e-activecell")):(this.XLSelection.selectRange({rowIndex:i.range[0],colIndex:i.range[1]},{rowIndex:i.range[0],colIndex:i.range[1]},i.sheetIndex),this.getCell(i.range[0],i.range[1],i.sheetIndex).addClass("e-activecell"),this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,i.range[0],i.range[1],i.range[2],i.range[3]),i.options,i.id),this.getCell(i.range[0],i.range[1],i.sheetIndex).addClass("e-activecell"));i.action="remove";break;case"edit":var p,o=this._dataContainer.sheets[i.sheetIndex],s=i.id.split("_")[1].replace(/[0-9]/g,""),y={},w,f;n("#"+i.id).css({left:i.prev.left,top:i.prev.top,height:i.prev.height,width:i.prev.width});s==="chart"&&this.XLChart.resizeChart(i.id,i.prev.height,i.prev.width);i.visualImg.hide();this.XLShape._picCellIdx=this.XLShape._getCellIndexFromOffset(i.prev.top,i.prev.left);f=this.XLShape._getCellIndexFromOffset(i.cur.top,i.cur.left);p=this._getShapePositionInManager(f.rowIndex,f.colIndex,i.id,s);y[s]=i.obj[s][p];this.XLEdit._updateDataContainer(this.getCell(this.XLShape._picCellIdx.rowIndex,this.XLShape._picCellIdx.colIndex,i.sheetIndex)[0],y);i.actionType!="resize"&&(this.getObjectLength(o[f.rowIndex][f.colIndex])<2&&o[f.rowIndex][f.colIndex][s].length<2?delete o[f.rowIndex][f.colIndex]:o[f.rowIndex][f.colIndex][s].length<2?delete o[f.rowIndex][f.colIndex][s]:(o[f.rowIndex][f.colIndex][s].some(function(n,t){if(y.id===n.id)return w=t,!0}),o[f.rowIndex][f.colIndex][s].splice(w,1)));this.getCell(this.XLShape._picCellIdx.rowIndex,this.XLShape._picCellIdx.colIndex,i.sheetIndex).addClass("e-activecell");this.model.showRibbon&&(s==="picture"?this.XLRibbon._toggleFormatTab():this.XLRibbon._toggleChartDesignTab());this._swapVal(i);break;case"PHAxis":case"PVAxis":a=i.action=="PHAxis"?"primaryXAxis":"primaryYAxis";v=i.action==="PHAxis"?"xAxis":"yAxis";i.visibility=!i.visibility;u.option(a,{visible:i.visibility});r[v].visible=i.visibility;break;case"PX":case"PY":a=i.action=="PX"?"primaryXAxis":"primaryYAxis";v=i.action==="PX"?"xAxis":"yAxis";t.isNullOrUndefined(i.prev.text)&&(i.prev.text="");u.option(a,{title:{text:i.prev.text}});r[v].title.text=i.prev.text;this._swapVal(i);break;case"CT":u.option("title",{textAlignment:i.prev.align,text:i.prev.text});r.title={text:i.prev.text,textAlignment:i.prev.align};this._swapVal(i);break;case"DLNone":u.option({series:i.prev.series});r.dataLabel={visible:i.prev.series[0].marker.dataLabel.visible};this._swapVal(i);break;case"DL":u.option({series:i.prev.series});r.dataLabel={visible:i.prev.series[0].marker.dataLabel.visible,vAlign:i.prev.series[0].marker.dataLabel.verticalTextAlignment,tPosn:i.prev.series[0].marker.dataLabel.textPosition};this._swapVal(i);break;case"PMajorH":i.visibility=!i.visibility;u.option("primaryYAxis",{majorGridLines:{visible:i.visibility}});r.yAxis.majorGridLines={visible:i.visibility};break;case"PMajorV":i.visibility=!i.visibility;u.option("primaryXAxis",{majorGridLines:{visible:i.visibility}});r.xAxis.majorGridLines={visible:i.visibility};break;case"PMinorH":i.visibility=!i.visibility;u.option("primaryYAxis",{minorGridLines:{visible:i.visibility},minorTicksPerInterval:5,minorTickLines:{visible:i.visibility}});r.yAxis.minorGridLines={visible:i.visibility};break;case"PMinorV":i.visibility=!i.visibility;u.option("primaryXAxis",{minorGridLines:{visible:i.visibility},minorTicksPerInterval:5,minorTickLines:{visible:i.visibility}});r.xAxis.minorGridLines={visible:i.visibility};break;case"LNone":i.visibility=!i.visibility;u.option("legend",{visible:i.visibility});r.legend.visible=i.visibility;break;case"Legend":u.option("legend",{position:i.prev.position});r.legend.position=i.prev.position;this._swapVal(i);break;case"width":c={width:i.prev.width,height:i.prev.height};l=n("#"+u._id);u.option("size",n.extend(!0,{},c));l[0].style.height=i.prev.height+"px";l[0].style.width=i.prev.width+"px";r.width=i.prev.width;r.height=i.prev.height;this.XLRibbon._setChartWidthHeight(c);this._swapVal(i);break;case"height":c={width:i.prev.width,height:i.prev.height};l=n("#"+u._id);u.option("size",n.extend(!0,{},c));l[0].style.height=i.prev.height+"px";l[0].style.width=i.prev.width+"px";r.width=i.prev.width;r.height=i.prev.Height;this.XLRibbon._setChartWidthHeight(c);this._swapVal(i);break;case"srcolumn":u.option({series:{}});r.isRowColSwitched=!r.isRowColSwitched;b={xRange:r.xRange,yRange:r.yRange,lRange:r.lRange,isRowColSwitched:r.isRowColSwitched,dataSheetIdx:r.dataSheetIdx};h=this.XLChart._processChartSeries(b);u.option({series:h.series});this.getActiveSheetIndex()===r.dataSheetIdx&&this.XLChart._focusChartRange(h.xRange,h.yRange,h.lRange);r.xAxis.range=h.xRange;r.yAxis.range=h.yRange;r.legend.range=h.lRange;break;case"border":k=this._dataContainer.sheets[i.sheetIndex][i.cellIdx.rowIndex][i.cellIdx.colIndex].picture[i.picIdx];e=n("#"+i.id);e.css({"border-color":i.prev.bcolor,"border-style":i.prev.bstyle,"border-width":i.prev.bwidth});k={bcolor:n(e[0]).css("border-color"),bstyle:n(e[0]).css("border-style"),bwidth:n(e[0]).css("border-width")};this._swapVal(i);break;case"resetpic":e=n("#"+i.id);i.actionType==="resetpicture"?e.css({"border-color":i.prev.color,"border-style":i.prev.style,"border-width":i.prev.width}):(e.css({width:i.prev.width,height:i.prev.height}),this.XLShape._updateShapeObj(e[0]));this._swapVal(i);break;case"changepic":o=this._dataContainer;n("#"+i.id).css("background-image","url('"+i.prev.img+"')");d=this._getShapePositionInManager(i.cell.rowIndex,i.cell.colIndex,i.id,"picture");o.pictures[o.sheets[i.sheetIndex][i.cell.rowIndex][i.cell.colIndex].picture[d].data]=i.prev.img;this._swapVal(i);break;case"picturesize":e=n("#"+i.id);e.css({width:i.prev.width,height:i.prev.height});this._swapVal(i);break;case"chartTheme":this.XLChart.refreshChart(this.element.find("#"+this._id+"_chart").val(),{theme:i.prev.theme});this._swapVal(i);break;case"chartType":this.XLChart.refreshChart(i.chartId,{type:i.prev.chartType,enable3D:i.prev.enable3D,marker:i.prev.marker});this._swapVal(i)}},_undoForShowHide:function(n){n.action==="show"?(n.operation==="row"?this.hideRow(n.start,n.end):this.hideColumn(n.start,n.end),n.action="hide"):(n.operation==="row"?this.showRow(n.start+1):this.showColumn(n.start+1),n.action="show")},_undoForSort:function(n){var f=this.XLEdit.getColumnIndexByField(n.columnName),i=this.getCell(n.range[0]-1,f),t=i.find("span.e-filterspan")[0],r,u;n.operation==="unsort"?(r={startCell:{rowIndex:n.range[0],colIndex:n.range[1]},endCell:{rowIndex:n.range[2],colIndex:n.range[3]}},this.updateRangeData(n,r,n.rangeData),n.operation="sort",this.isUndefined(t)||(t.className=t.className.indexOf("-asc")>1?t.className.replace("-asc",n.prevIcon):t.className.replace("-dsc",n.prevIcon))):(this.XLSort.sortByRange(n.range,n.columnName,n.direction),n.operation="unsort",this.XLFilter._changeSortIcon(i,n.direction));u=n.prevIcon;n.prevIcon=n.currIcon;n.currIcon=u},_undoForSortByColor:function(n){var i=n.range,r=n.prev.data,u,s=this.getCell(i[0]-1,i[1]),o,e,f;for(this.clearRangeData(i),this.updateData(r,i),r=r.reverse(),e=this.getRange(i[0],i[1],i[2],i[3]),u=e.length,this.XLFormat.clearFormat(i,"format");u--;)o=t.isNullOrUndefined(r[u].format)?"":r[u].format,this.XLFormat._updateFormatClass(e[u],o);f=s.find(".e-filterspan");f.length>0&&(f[0].className=f[0].className.replace(n.cur.icon,n.prev.icon));this._swapVal(n)},_undoForStyle:function(n){this.XLFormat.clearFormat(n.range);this.XLFormat.updateFormat(n.beforeFormat,n.range);var t=this.changePosition(n.beforeFormat,n.afterFormat);n.beforeFormat=t[1];n.afterFormat=t[0];this._isUndoRedo=!0;n.status="undo-cellstyles"},_undoForTextWrap:function(n){n.operation==="wrap"?(this.setWrapText(n.range,"unwrap"),n.operation="unwrap"):(this.setWrapText(n.range,"wrap"),n.operation="wrap");this.XLDragFill.positionAutoFillElement()},_undoForValidation:function(n){var u,i,e,f,r,s,o;if(n.operation==="cl-hl-data")this.XLValidate.highlightInvalidData(n.range),n.operation="hl-data";else if(n.operation==="apply-validation"){for(f=n.selectedCells,o=[],i=0,e=f.length;i<e;i++)u=this.getCell(f[i].rowIndex,f[i].colIndex),s=this.XLEdit.getPropertyValueByElem(u,"rule"),r=this.changePosition(f[i].prevRule,s),n.selectedCells[i].prevRule=r[1],t.isNullOrUndefined(r[0])||(r[0].customVal=r[0].customVal,this.XLEdit._updateDataContainer(u[0],{rule:r[0]})),o.push(u[0]);t.isNullOrUndefined(r[0])&&this.clearRangeData(null,["rule"],o)}else if(n.operation==="hl-data")this.XLValidate.clearHighlightedValData(n.range),n.operation="cl-hl-data";else if(this._isUndo)for(i=0,e=n.selCells.length;i<e;i++)u=this.getCell(n.selCells[i].rowIndex,n.selCells[i].colIndex),this.XLEdit._updateDataContainer(u[0],{rule:n.selCells[i].rules});else this.XLValidate.clearDV(n.range)},_applyCommentLink:function(i,r,u,f){var c=this._dataContainer,o,s,l,e,h,a;if(cFormatData=c.cFormatData,n(r).removeClass("e-redft e-yellowft e-greenft e-redf e-redt"),i&&(s=this.isNumber(i.value2)?c.sharedData[i.value2]:i.value2,this.XLEdit.updateCellValue(n(r),s),"comment"in i&&(n(r).removeClass("e-commentcell"),this.XLComment.setComment(n(r),null,!1)),"hyperlink"in i&&(o=i.hyperlink,o?o.webAdr?n(r).html(t.buildTag("a",s,"",{href:o.webAdr,target:"_blank","class":"e-hyperlinks"})):n(r).html(t.buildTag("a",s,"",{href:"#","class":"e-hyperlinks"})):0),"cFormatRule"in i))for(l=i.cFormatRule,h=0,a=l.length;h<a;h++)e=cFormatData[h].split("_"),this.XLCFormat._cFormat(e[0],e[2],e[3],e[4],null,null,[u,f,u,f])},changePosition:function(n,i){var r=[];return r.push(i),r.push(n),t.swap(r,0,1),r},_addValidationRule:function(t,i){var u=[],r,f;for(n.extend(!0,u,t),r=0,f=t.length;r<f;r++)t[r].customVal!==i.customVal&&t[r].required!==i.required&&t[r].Number!==i.number&&u.push(i);return u},_addCondFormatRule:function(t,i){var f=!1,u=[],r,e;for(n.extend(!0,u,t),r=0,e=t.length;r<e;r++)if(i=i.indexOf("true")>-1?i.replace("_true",""):i.replace("_false",""),t[r]===i){f=!0;break}return f||u.push(i),u},getCellClass:function(n){var t=this._formatRegx;return n&&n.className.indexOf("e-format")>-1?n.className.match(t)[0]:""},_renderInsertDeleteDialog:function(){var n=this._id+"_insertdeletedlg",i,e,r,u,f;i=t.buildTag("div#"+n+".e-insertdialog","",{display:"none"});e=t.buildTag("div#"+n+"_content.e-contentdialog");i.append(e);f=t.buildTag("div#"+n+"_btndiv.e-insertdlgbtndiv");r=t.buildTag("input#"+n+"_okbtn");u=t.buildTag("input#"+n+"_cantn");r.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:50,click:t.proxy(this._insertDeleteOk,this),enabled:!0});u.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._insertDeleteCancel,this),showRoundedCorner:!0,width:50});f.append(r).append(u);i.append(f);r.addClass("e-conok");u.addClass("e-concancel");i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,width:180,height:192,cssClass:"e-ss-dialog"})},_renderInsertDialog:function(){var t=n("#"+this._id+"_insertdeletedlg"),i,r;t.ejDialog({title:this._getLocStr("Insert")});t.ejDialog("open");this._insDelStatus="insert";i=n("#"+t[0].id+"_content");r=["shiftright","shiftbottom","entirerow","entirecolumn"];i.children().empty();this._createRadioButton(t,i,r);n("#"+t[0].id+"_shiftbottom").ejRadioButton({checked:!0})},_renderDeleteDialog:function(){var t=n("#"+this._id+"_insertdeletedlg"),i,r;t.ejDialog({title:this._getLocStr("Delete")});t.ejDialog("open");this._insDelStatus="delete";i=n("#"+t[0].id+"_content");r=["shiftleft","shiftup","entirerow","entirecolumn"];i.children().empty();this._createRadioButton(t,i,r);n("#"+t[0].id+"_shiftleft").ejRadioButton({checked:!0})},_createRadioButton:function(n,i,r){var o,h,s,e,u,f,c;for(s=t.buildTag("table"),f=0,c=r.length;f<c;f++)e=t.buildTag("tr"),u=t.buildTag("td.e-chkstatus"),h=t.buildTag("label.lblsrt",this._getLocStr(r[f]),{},{"for":n[0].id+"_"+r[f]}),o=t.buildTag("input#"+n[0].id+"_"+r[f],"",{},{type:"radio",name:"inserdelete"}),u.append(o),e.append(u),u=t.buildTag("td.e-chkstatus"),u.append(h),o.ejRadioButton({size:"medium"}),e.append(u),s.append(e);i.append(s)},_getSelectedOption:function(t){for(var u,f=this._id+"_insertdeletedlg",r=0,i=0;i<4;i++)if(u=n("#"+f+"_"+t[i]).data("ejRadioButton"),u.model.checked){r=i;break}return r},_insertDeleteOk:function(){var o,f;this._isUndo=!1;this._isUndoRedo=!1;var t,i,e=this.getActiveSheetIndex(),r=this.model.sheets[e]._selectedCells[0],u=this.model.sheets[e]._selectedCells[this.model.sheets[e]._selectedCells.length-1];for(this._insDelStatus.indexOf("insert")>-1?(t=["shiftright","shiftbottom","entirerow","entirecolumn"],i=this._getSelectedOption(t),t[i].indexOf("shiftright")>-1?this.insertShiftRight(r,u):t[i].indexOf("shiftbottom")>-1?this.insertShiftBottom(r,u):t[i].indexOf("entirerow")>-1?this.insertEntireRow(r,u):this.insertEntireColumn(r,u)):(t=["shiftleft","shiftup","entirerow","entirecolumn"],i=this._getSelectedOption(t),t[i].indexOf("shiftleft")>-1?this.deleteShiftLeft(r,u):t[i].indexOf("shiftup")>-1?this.deleteShiftUp(r,u):t[i].indexOf("entirerow")>-1?this.deleteEntireRow(r,u):this.deleteEntireColumn(r,u)),n("#"+this._id+"_insertdeletedlg").ejDialog("close"),o=this.model.sheets[this.model.activeSheetIndex]._shapeMngr.chart,f=0;f<o.length;f++)this.XLChart._refreshChart(o[f])},_insertDeleteCancel:function(){n("#"+this._id+"_insertdeletedlg").ejDialog("close")},_undoredoDetails:function(n,t,i,r,u){var f={sheetIndex:n,startCell:t,endCell:i,reqType:r,action:u,delCells:this._delCells,text:this._deletedText};this.importSheet||this._completeAction(f)},_refreshFormula:function(n,t,i,r,u){var o=this.getActiveSheetIndex(),s,e=this.XLEdit.getPropertyValue(n,t,"value"),h,c,f,l,a=this.getSheet(o);this.isFormula(e)&&(h=e.substring(e.indexOf("(")+1,e.indexOf(")")),f=this.getRangeIndices(h),s=u==="column"?r==="insert"?f[3]+i:f[3]-i:r==="insert"?f[2]+i:f[2]-i,c=u==="column"?this._getAlphaRange(o,f[0],f[1],f[2],s):this._getAlphaRange(o,f[0],f[1],s,f[3]),e=e.replace(h,c),l=new ValueChangedArgs(n+1,t+1,e),this._sheets[o]._calcEngine.valueChanged(a._sheetName.value,l),this.XLEdit._updateDataContainer(this.getCell(n,t,o)[0],{value:e}),this._applyFormula(o,n,t))},_applyFormula:function(n,i,r){t.isNullOrUndefined(this.model.sheets[n]._formulaCollection[i])&&(this.model.sheets[n]._formulaCollection[i]={});var u=this._sheets[n]._calcEngine.getFormulaInfoTable().values();this.model.sheets[n]._formulaCollection[i][r]=u[u.length-1]},_clearFormula:function(n,t){var f,e,i,r=this.getActiveSheetIndex(),s=this.XLEdit.getPropertyValue(n,t,"value"),u,o;if(this.isFormula(s)){for(f=this.model.sheets[r]._formulaCollection[n][t],i=this._sheets[r]._calcEngine.getFormulaInfoTable().values(),e=i.indexOf(f),i.splice(e,1),this._sheets[r]._calcEngine.getFormulaInfoTable().clear(),u=0,o=i.length;u<o;u++)this._sheets[r]._calcEngine.getFormulaInfoTable().add(i[u]);delete this.model.sheets[r]._formulaCollection[n][t]}},_refreshValAndCF:function(n,t,i,r){var u=this._dataContainer.sheets[this.getActiveSheetIndex()];this.isUndefined(i)&&this.isUndefined(r)?delete u[n][t]:(this.isUndefined(i)||(u[n][t]={rule:i}),this.isUndefined(r)||(u[n][t]={cFormatRule:r}))},_refreshDataContainer:function(i,r){for(var k,rt,d,ut,w,g,f,o,c,it,p=0,ft=0,et,e=this._dataContainer.sheets[i],ot,tt,st,s,h,v,b,l,a,y,ht,nt=parseInt(this.getObjectKeys(e)[this.getObjectLength(e)-1]),u=0;u<=nt;u++)t.isNullOrUndefined(e[u])||(et=this.getObjectKeys(e[u]),ft=parseInt(et[et.length-1]),ft>p&&(p=ft));st=r.startCol<=p?r.colCount+r.startCol:p-1;ot=r.status.indexOf("shift")>-1?st:p-1;tt=r.status.indexOf("shift")>-1?r.rowCount+r.startRow:nt;k=r.startRow;rt=r.startRow+r.rowCount-1;d=r.startCol;ut=r.startCol+r.colCount-1;switch(r.status){case"insertRow":for(u=nt,c=r.startRow;u>=c;u--)if(!t.isNullOrUndefined(e[u])){if(e[u+r.rowCount]=n.extend(!0,{},e[u]),!t.isNullOrUndefined(e[u+r.rowCount]))for(v=this.getObjectKeys(e[u+r.rowCount]),f=0,it=v.length;f<it;f++)this._clearFormula(u,f),u>=k&&u<=rt?(w=this.XLEdit.getPropertyValueByElem(this.getCell(k,f),"rule"),g=this.XLEdit.getPropertyValueByElem(this.getCell(k,f),"cFormatRule"),this._refreshValAndCF(u,f,w,g,r.rowCount,0)):delete e[u][f],this._refreshFormula(u+r.rowCount,parseInt(v[f]),r.rowCount,"insert","row");this.getObjectLength(e[u])<1&&delete e[u]}if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,b=s[s.length-1].row-s[0].row,u=0,c=s.length;u<c;u++)for(e[s[u].row]=s[u].value,v=this.getObjectKeys(e[s[u].row]),f=0,it=v.length;f<it;f++)this._refreshFormula(s[u].row,parseInt(v[f]),b,"insert","row");break;case"insertColumn":for(u=0;u<=tt;u++)for(f=p,c=r.startCol;f>=c;f--)l=a=null,t.isNullOrUndefined(e[u])||(t.isNullOrUndefined(e[u][f])||(t.isNullOrUndefined(e[u][f+r.colCount])||(t.isNullOrUndefined(e[u][f+r.colCount].picture)||(l=e[u][f+r.colCount].picture),t.isNullOrUndefined(e[u][f+r.colCount].chart)||(a=e[u][f+r.colCount].chart)),e[u][f+r.colCount]=e[u][f],t.isNullOrUndefined(e[u][f].picture)&&t.isNullOrUndefined(e[u][f].chart)||(t.isNullOrUndefined(e[u][f].picture)||(l=e[u][f].picture),t.isNullOrUndefined(e[u][f].chart)||(a=e[u][f].chart)),t.isNullOrUndefined(e[u][f+r.colCount])||(t.isNullOrUndefined(l)||(e[u][f+r.colCount].picture=l),t.isNullOrUndefined(a)||(e[u][f+r.colCount].chart=a))),this._clearFormula(u,f),f>=d&&f<=ut?(w=this.XLEdit.getPropertyValueByElem(this.getCell(u,d),"rule"),g=this.XLEdit.getPropertyValueByElem(this.getCell(u,d),"cFormatRule"),this._refreshValAndCF(u,f,w,g,0,r.colCount)):delete e[u][f],!t.isNullOrUndefined(e[u][f])||t.isNullOrUndefined(l)&&t.isNullOrUndefined(a)||(e[u][f]={}),t.isNullOrUndefined(l)||(e[u][f].picture=l),t.isNullOrUndefined(a)||(e[u][f].chart=a),this._refreshFormula(u,f+r.colCount,r.colCount,"insert","column"));if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,b=s[s.length-1].col-s[0].col,o=0,c=s.length;o<c;o++)t.isNullOrUndefined(e[s[o].row])&&(e[s[o].row]={}),e[s[o].row][s[o].col]=s[o].value,this._refreshFormula(s[o].row,s[o].col,b,"insert","column");break;case"deleteRow":for(this._delCells=[],h=[],u=r.startRow;u<=nt;u++){if(u<r.startRow+r.rowCount){if(this._delCells.push({row:u,value:n.extend(!0,{},e[u])}),!t.isNullOrUndefined(e[u]))for(v=this.getObjectKeys(e[u]),f=0,c=v.length;f<c;f++)this._clearFormula(u,f),e[u][f]={};e[u]={};h.push({row:u})}if(!t.isNullOrUndefined(e[u+r.rowCount])){for(e[u]=n.extend(!0,{},e[u+r.rowCount]),v=this.getObjectKeys(e[u]),f=0,c=v.length;f<c;f++)this._clearFormula(u+r.rowCount,f),e[u+r.rowCount][f]={},this._refreshFormula(u,parseInt(v[f]),r.rowCount,"delete","row");e[u+r.rowCount]={};h.push({row:u+r.rowCount})}}for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row])===0&&(this._clearFormula(h[o].row,h[o].col),delete e[h[o].row]);break;case"deleteColumn":for(this._delCells=[],h=[],u=0;u<=tt;u++){for(f=r.startCol;f<=p;f++)l=a=null,f<r.startCol+r.colCount&&(t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f])}),this._clearFormula(u,f),e[u][f]={},t.isNullOrUndefined(this._delCells[this._delCells.length-1])||(y=this._delCells.length-1,t.isNullOrUndefined(this._delCells[y].value.picture)||(e[u][f].picture=this._delCells[y].value.picture),t.isNullOrUndefined(this._delCells[y].value.chart)||(e[u][f].chart=this._delCells[y].value.chart)),h.push({row:u,col:f}))),t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f+r.colCount])||(e[u][f]=n.extend(!0,{},e[u][f+r.colCount]),t.isNullOrUndefined(e[u][f+r.colCount].picture)||(l=e[u][f+r.colCount].picture),t.isNullOrUndefined(e[u][f+r.colCount].chart)||(a=e[u][f+r.colCount].chart),this._clearFormula(u,f+r.colCount),e[u][f+r.colCount]={},t.isNullOrUndefined(l)||(e[u][f+r.colCount].picture=l),t.isNullOrUndefined(a)||(e[u][f+r.colCount].chart=a),t.isNullOrUndefined(this._delCells[this._delCells.length-1])||(y=this._delCells.length-1,t.isNullOrUndefined(this._delCells[y].value.picture)||(e[u][f].picture=this._delCells[y].value.picture),t.isNullOrUndefined(this._delCells[y].value.chart)||(e[u][f].chart=this._delCells[y].value.chart)),h.push({row:u,col:f+r.colCount}),this._refreshFormula(u,f,r.colCount,"delete","column"));for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row][h[o].col])===0&&(this._clearFormula(h[o].row,h[o].col),delete e[h[o].row][h[o].col]);h=[]}break;case"shiftRight":for(u=r.startRow;u<tt;u++)for(f=p,c=r.startCol;f>=c;f--)t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(e[u][f+r.colCount]=n.extend(!0,{},e[u][f]),this._clearFormula(u,f),f>=d&&f<=ut?(w=this.XLEdit.getPropertyValueByElem(this.getCell(u,d),"rule"),ht=this.XLEdit.getPropertyValueByElem(this.getCell(u,d),"cFormatRule"),this._refreshValAndCF(u,f,w,g,0,r.colCount)):delete e[u][f],this._refreshFormula(u,f+r.colCount,r.colCount,"insert","column"));if(this._isUndo)for(s=this._delCells,b=s[s.length-1].col-s[0].col,o=0,c=s.length;o<c;o++)e[s[o].row][s[o].col]=s[o].value,this._refreshFormula(s[o].row,s[o].col,b,"insert","column");break;case"shiftLeft":for(this._delCells=[],h=[],u=r.startRow;u<tt;u++){for(f=r.startCol;f<=p;f++)f<r.startCol+r.colCount&&(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f])}),this._clearFormula(u,f),e[u][f]={},h.push({row:u,col:f})),t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f+r.colCount])||(e[u][f]=n.extend(!0,{},e[u][f+r.colCount]),h.push({row:u,col:f+r.colCount}),this._clearFormula(u,f+r.colCount),e[u][f+r.colCount]={},this._refreshFormula(u,f,r.colCount,"delete","column"));for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row][h[o].col])===0&&(this._clearFormula(h[o].row,h[o].col),delete e[h[o].row][h[o].col]);h=[]}break;case"shiftBottom":for(u=nt,c=r.startRow;u>=c;u--){for(f=r.startCol;f<ot;f++)t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(t.isNullOrUndefined(e[u+r.rowCount])&&(e[u+r.rowCount]={}),e[u+r.rowCount][f]=n.extend(!0,{},e[u][f]),this._clearFormula(u,f),u>=k&&u<=rt?(w=this.XLEdit.getPropertyValueByElem(this.getCell(k,f),"rule"),g=this.XLEdit.getPropertyValueByElem(this.getCell(k,f),"cFormatRule"),this._refreshValAndCF(u,f,w,g,r.rowCount,0)):delete e[u][f],this._refreshFormula(u+r.rowCount,f,r.rowCount,"insert","row"));t.isNullOrUndefined(e[u])||this.getObjectLength(e[u])===0&&delete e[u]}if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,b=s[s.length-1].row-s[0].row,u=0,c=s.length;u<c;u++)t.isNullOrUndefined(e[s[u].row])&&(e[s[u].row]={}),e[s[u].row][s[u].col]=s[u].value,this._refreshFormula(s[u].row,s[u].col,b,"insert","row");break;case"shiftUp":for(h=[],u=r.startRow;u<=nt;u++)for(f=r.startCol;f<ot;f++)u<r.startRow+r.rowCount&&!t.isNullOrUndefined(e[u])&&(t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f])}),this._clearFormula(u,f),e[u][f]={},h.push({row:u,col:f}))),t.isNullOrUndefined(e[u+r.rowCount])||t.isNullOrUndefined(e[u+r.rowCount][f])||(t.isNullOrUndefined(e[u])&&(e[u]={}),e[u][f]=n.extend(!0,{},e[u+r.rowCount][f]),this._clearFormula(u+r.rowCount,f),e[u+r.rowCount][f]={},h.push({row:u+r.rowCount,col:f}),this._refreshFormula(u,f,r.rowCount,"delete","row"));for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row][h[o].col])===0&&(this._clearFormula(h[o].row,h[o].col),delete e[h[o].row][h[o].col]),this.getObjectLength(e[h[o].row])===0&&delete e[h[o].row]}},insertShiftRight:function(n,t){var i,r=this.getActiveSheetIndex(),u;this._isUndo?(i="shiftLeft",this._insDelStatus="delete"):(i="shiftRight",this._insDelStatus="insert");this.XLScroll._createNewColumn(r,n,t,"shift");this.performSelection(n,t);u={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:i};this._refreshDataContainer(r,u);this._isUndoRedo||this._undoredoDetails(r,n,t,"insert","insertShiftRight")},insertShiftBottom:function(t,i){var r,u,l,o=this.getActiveSheetIndex(),h,f,e,a,s,c;if(this._isUndo){for(f=this._getContent(o).find("tbody").get(0).rows,r=t.rowIndex,l=f.length;r<l;r++)if(e=r+(i.rowIndex-t.rowIndex+1),e<f.length)for(u=t.colIndex;u<=i.colIndex;u++)n(f[r]).find("td").get(u).outerHTML=n(f[e]).find("td").get(u).outerHTML,n(f[e]).find("td").get(u).innerHTML="";h="shiftUp"}else{for(r=t.rowIndex;r<=i.rowIndex;r++)this.XLScroll._createNewRow(o,-1,-1,"insert");for(f=this._getContent(o).find("tbody").get(0).rows,r=f.length-1;r>=t.rowIndex;r--)if(e=r-(i.rowIndex-t.rowIndex+1),e>=t.rowIndex)for(u=t.colIndex;u<=i.colIndex;u++)s=n(f[e]).find("td").get(u),c=n(f[r]).find("td").get(u),c.outerHTML=s.outerHTML,s.innerHTML="",c.className=s.className,s.className="e-rowcell";h="shiftBottom"}this.performSelection(t,i);a={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:h};this._refreshDataContainer(o,a);this._isUndoRedo||this._undoredoDetails(o,t,i,"insert","insertShiftBottom")},insertEntireRow:function(t,i){var r,o,f,u=this.getActiveSheetIndex(),s,h,c,l,a=this._getJSSheetRowHeaderContent(u).find(".e-rowselected"),e;if(this._isUndo){for(s=this._getContent(u).find("tbody").get(0).rows,h=this._getJSSheetRowHeaderContent(u).find("tbody").get(0).rows,c=this._getJSSheetRowHeaderContent(u).find("tbody").get(0),r=i.rowIndex;r>=t.rowIndex;r--)n(s[r]).remove(),n(h[r]).remove(),this.model.sheets[u].rowCount=this.model.sheets[u].rowCount-1,this.XLScroll._getRowHeightsAfterInsert(u,this.model.sheets[u]._fRow);for(e=n(c).find("td"),r=0,o=e.length;r<o;r++)n(e[r]).text(r+1);f="deleteRow"}else{for(r=t.rowIndex;r<=i.rowIndex;r++)this.XLScroll._createNewRow(u,r,t.colIndex,"insert");f="insertRow"}a.length?this.XLSelection.selectRows(t.rowIndex,i.rowIndex):this.performSelection(t,i);this.XLComment._updateCmntArrowPos();l={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:f};this._refreshDataContainer(u,l);this._isUndoRedo||this._undoredoDetails(u,t,i,"insert","insertRow")},insertEntireColumn:function(n,t){var r,i=this.getActiveSheetIndex(),u,f=this._getJSSheetHeader(i).find(".e-colselected");this._isUndo?(this._insDelStatus="delete",r="deleteColumn"):(r="insertColumn",this._insDelStatus="insert");this.XLScroll._createNewColumn(i,n,t,"insert");f.length?this.XLSelection.selectColumns(n.colIndex,t.colIndex):this.performSelection(n,t);this.XLComment._updateCmntArrowPos();u={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:r};this._refreshDataContainer(i,u);this._isUndoRedo||this._undoredoDetails(i,n,t,"insert","insertColumn")},deleteShiftLeft:function(t,i){var r,u,f=this.getActiveSheetIndex(),c=this._getContent(f).find("tbody").get(0),o,e=[],s,h;if(this._isUndo){for(n.extend(!0,e,this._deletedText),this._insDelStatus="insert",h=this._getContent(f).find("tbody").get(0).rows,this.XLScroll._createNewColumn(f,t,i,"shift"),r=t.rowIndex;r<=i.rowIndex;r++)for(u=t.colIndex;u<=i.colIndex;u++)n(h[r]).find("td").get(u).outerHTML=e.shift();o="shiftRight"}else{for(this._insDelStatus="delete",r=t.rowIndex;r<=i.rowIndex;r++)for(u=t.colIndex;u<=i.colIndex;u++)e.push(n(c).find("tr").eq(r).find("td").get(u).outerHTML);this.XLScroll._createNewColumn(f,t,i,"shift");o="shiftLeft"}this.performSelection(t,i);s={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:o};this._refreshDataContainer(f,s);this._deletedText=e;this._isUndoRedo||this._undoredoDetails(f,t,i,"delete","deleteShiftLeft")},deleteShiftUp:function(t,i){var r,u,c,o=this.getActiveSheetIndex(),f=this._getContent(o).find("tbody").get(0).rows,h,s=[],e,l;if(this._isUndo){for(n.extend(!0,s,this._deletedText),r=t.rowIndex;r<=i.rowIndex;r++)this.XLScroll._createNewRow(o,-1,-1,"insert");for(f=this._getContent(o).find("tbody").get(0).rows,r=f.length-1;r>=t.rowIndex;r--)if(e=r-(i.rowIndex-t.rowIndex+1),e>=t.rowIndex)for(u=t.colIndex;u<=i.colIndex;u++)n(f[r]).find("td").get(u).outerHTML=n(f[e]).find("td").get(u).outerHTML,n(f[e]).find("td").get(u).innerHTML="";for(r=t.rowIndex;r<=i.rowIndex;r++)for(u=t.colIndex;u<=i.colIndex;u++)n(f[r]).find("td").get(u).outerHTML=s.shift();h="shiftBottom"}else for(h="shiftUp",r=t.rowIndex,c=f.length;r<c;r++)if(e=r+(i.rowIndex-t.rowIndex+1),e<f.length)for(u=t.colIndex;u<=i.colIndex;u++)s.push(n(f[r]).find("td").get(u).outerHTML),n(f[r]).find("td").get(u).outerHTML=n(f[e]).find("td").get(u).outerHTML,n(f[r]).find("td").eq(u).data(n(f[e]).find("td").eq(u).data()),n(f[e]).find("td").get(u).innerHTML="";this.performSelection(t,i);l={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:h};this._refreshDataContainer(o,l);this._deletedText=s;this._isUndoRedo||this._undoredoDetails(o,t,i,"delete","deleteShiftUp")},deleteEntireRow:function(t,i){var r,a,e,s,h,f,c,o=[],u=this.getActiveSheetIndex(),l,v;if(e=this._getContent(u).find("table"),f=this._getJSSheetRowHeaderContent(u).find("table"),selRowHdr=f.find(".e-rowselected"),this._isUndo)for(c="insertRow",n.extend(!0,o,this._deletedText),r=t.rowIndex;r<=i.rowIndex;r++)l=o.pop(),e.find("tr").eq(r).before(l),h=this.XLScroll._rowHeaderTemplate(1),n(h).height(n(l).height()),f.find("tr").eq(r).before(h),this.model.sheets[u].rowCount=this.model.sheets[u].rowCount+1,this.XLScroll._getRowHeightsAfterInsert(u,this.model.sheets[u]._fRow);else for(c="deleteRow",r=i.rowIndex;r>=t.rowIndex;r--)o.push(e.find("tr").get(r).outerHTML),e.find("tr").eq(r).remove(),f.find("tr").eq(r).remove(),this.model.sheets[u].rowCount=this.model.sheets[u].rowCount-1,this.XLScroll._getRowHeightsAfterInsert(u,this.model.sheets[u]._fRow),this.XLScroll._createNewRow(u,-1,-1,"insert");for(s=f.find("td"),r=0,a=s.length;r<a;r++)n(s[r]).text(r+1);v={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:c};this._refreshDataContainer(u,v);selRowHdr.length?this.XLSelection.selectRows(t.rowIndex,i.rowIndex):this.performSelection(t,i);this._deletedText=o;this._isUndoRedo||this._undoredoDetails(u,t,i,"delete","deleteRow")},deleteEntireColumn:function(t,i){var u,r,c,e=this.getActiveSheetIndex(),f,v,o,l,a,s,y,h=[],p,w;if(f=this._getContent(e).find("tbody").get(0),o=this._getJSSheetHeader(e).find("tr").eq(0),l=n(f).prev(),a=o.parent().prev(),s=this.XLScroll._colGroupTemplate(1),colHdrSel=o.find(".e-colselected"),this._isUndo){for(h=n.extend(!0,h,this._deletedText),y="insertColumn",r=t.colIndex;r<=i.colIndex;r++)n(a).find("col").eq(r).before(s),o.parent().find("th").eq(r).before("<th class='e-headercell'><div class='e-headercelldiv'><\/div><\/th>"),n(l).find("col").eq(r).before(s);for(u=f.rows.length-1;u>=0;u--)for(r=t.colIndex;r<=i.colIndex;r++)n(f.rows[u]).find("td").eq(r).before(h.pop())}else{for(y="deleteColumn",r=i.colIndex;r>=t.colIndex;r--)n(a).find("col").eq(r).remove(),n(l).find("col").eq(r).remove(),n(a).append(s),n(l).append(s);for(u=0,c=f.rows.length;u<c;u++)for(r=i.colIndex;r>=t.colIndex;r--)w=this.XLScroll._columnTemplate(),n(f.rows[u]).append(w),h.push(n(f.rows[u]).find("td").get(r).outerHTML),n(f.rows[u]).find("td").eq(r).remove()}for(v=n(o).find("th"),u=0,c=v.length;u<c;u++)n(v[u]).find("div").text(this._generateHeaderText(e,u+1));p={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:y};this._refreshDataContainer(e,p);colHdrSel.length?this.XLSelection.selectColumns(t.colIndex,i.colIndex):this.performSelection(t,i);this._deletedText=h;this._isUndoRedo||this._undoredoDetails(e,t,i,"delete","deleteColumn")},performSelection:function(n,t){var i=this.getActiveSheetIndex();this.XLScroll._refreshScroller(i,"refresh","all");this.XLSelection.selectRange(n,t);this.XLDragFill.positionAutoFillElement();this.model.sheets[i]._startCell=n;this.model.sheets[i]._endCell=t},hideRow:function(n,i){for(var c,r=this.getActiveSheetIndex(),f=this.getSheet(r),o=this.getRows(r),e=o[1],l=o[0],s=f.hideRowsCollection,h=f._hiddenHeight,u=n;u<=i;u++)e[u].className.indexOf("e-fr-hide")===-1&&(this.addClass(e[u],"e-fr-hide"),this.addClass(l[u],"e-fr-hide"),s.push(u),h=h+parseInt(e[u].style.height),this.model.sheets[r]._importRendered||this.XLScroll._createNewRow(r,-1,-1,"insert"));f.hideRowsCollection=t.distinct(s);this.addClass(this._getJSSheetRowHeaderContent(r).find("tr:eq("+(i+1)+") td")[0],"e-hrow");this.model.sheets[r]._importRendered||(this.getSheet(r)._activeCell.rowIndex=i+1,this.XLSelection.selectRow(i+1,r),this.XLDragFill.hideAutoFillElement(),this._isUndoRedo||(c={sheetIndex:r,reqType:"show-hide",action:"hide",operation:"row",start:n,end:i},this._completeAction(c)))},showRow:function(i,r){var u=this.getActiveSheetIndex(),s=i-1>0?i-1:0,c=this.getSheet(u),l=this.getRows(u),e=l[1],f=l[0],h=c.hideRowsCollection,a=c._hiddenHeight,y=n(this._getJSSheetHeader(u).find("colgroup")[0].outerHTML).attr("id","ss"),o=t.buildTag("table#wrapTable.e-table",{}),v;if(o.append(y),this.element[0].insertBefore(o[0],this.element[0].childNodes[0]),i!==r||this._hasClass(e[s],"e-fr-hide")){for(j=s;j<=r;j++)hideValue=h.indexOf(j),hideValue>-1&&(this._removeClass(e[j],"e-fr-hide"),this._removeClass(f[j],"e-fr-hide"),a=a-n(e).eq(j).height(),h.splice(hideValue,1),h.length>0&&i===r?(this._removeClass(n(f[j+1]).find("td")[0],"e-hrow"),this._hasClass(e[s-1],"e-fr-hide")&&this.addClass(n(f[j]).find("td")[0],"e-hrow")):i===r?this._removeClass(n(f[j+1]).find("td")[0],"e-hrow"):this._removeClass(n(f[j+1]).find("td")[0],"e-hrow")),this._setWrapHeight(u,j,e,f,o,"visible"),o.remove(),this.XLDragFill.positionAutoFillElement();i<r?(this.setActiveCell(i,0),this.XLSelection.selectRows(i,r,u)):(this.setActiveCell(i-1,0),this.XLSelection.selectRow(i-1,u));this.XLDragFill.positionAutoFillElement();v={sheetIndex:u,reqType:"show-hide",action:"show",operation:"row",start:i,end:0};this.model.sheets[u]._importRendered||this._isUndoRedo||this._completeAction(v)}},_colgroupRefresh:function(t){var i,r,u,f;this.model.allowResizing&&(i=this._getJSSheetHeader(t).find("colgroup"),r=this._getContent(t).find("colgroup"));u=n(i).clone();f=n(r).clone();n(r).remove();n(i).remove();n(u).prependTo(this._getJSSheetHeader(t).find(".e-table"));n(f).prependTo(this._getContent(t).find(".e-table"))},hideColumn:function(t,i){for(var f,s,r=this.getActiveSheetIndex(),o=this._getContent(r).find(".e-table").find("col"),l=this._getJSSheetHeader(r).find("col"),e,a=this.getSheet(r).hideColsCollection,h=this.getSheet(r)._hiddenWidth,c,u=t;u<=i;u++)if(!this._hasClass(o[u],"e-fc-hide"))for(this.addClass(o[u],"e-fc-hide"),this.addClass(l[u],"e-fc-hide"),this.model.sheets[r]._importRendered||a.push(u),h=h+n(o[u]).width(),e=this._getContent(r).find(".e-filterspan"),f=0,s=e.length;f<s;f++)parTdIdx=e[f].parentNode.cellIndex,parTdIdx===u&&this.addClass(e[f],"e-hide");this.addClass(this._getJSSheetHeader(r).find("thead th:eq("+(i+1)+")")[0],"e-hcol");this.model.sheets[r]._importRendered&&this.setActiveCell(0,0);this.model.sheets[r]._importRendered||(this._getJSSheetHeader(r).find("col").length-1===i?this.XLSelection.selectColumn(i-1,r):this.XLSelection.selectColumn(i+1,r),this.XLDragFill.positionAutoFillElement(),this._isUndoRedo||(c={sheetIndex:r,reqType:"show-hide",action:"hide",operation:"column",start:t,end:i},this._completeAction(c)));this.getBrowserDetails().browser.indexOf("msie")>-1&&this._colgroupRefresh(r)},showColumn:function(t,r){var u=this.getActiveSheetIndex(),f=t-1>0?t-1:0,h=this.getSheet(u).hideColsCollection,o=this._getContent(u).find(".e-table").find("col"),a=this._getJSSheetHeader(u).find("col"),e,c=this.getSheet(u)._hiddenWidth,s=this._getJSSheetHeader(u).find("th"),l;if(t!==r||this._hasClass(o[f],"e-fc-hide")){for(j=f;j<=r;j++){if(hideValue=h.indexOf(j),hideValue>-1){for(c=c-n(o[j]).width(),this._removeClass(o[j],"e-fc-hide"),this._removeClass(a[j],"e-fc-hide"),e=this._getContent(u).find(".e-filterspan"),i=0,len=e.length;i<len;i++)parTdIdx=e[i].parentNode.cellIndex,parTdIdx===j&&this._hasClass(e[i],"e-hide")&&this._removeClass(e[i],"e-hide");h.splice(hideValue,1);h.length>0&&t===r?(this._removeClass(s.get(t),"e-hcol"),this._hasClass(o[f-1],"e-fc-hide")&&this.addClass(s.get(f),"e-hcol")):t==r?this._removeClass(s.get(t),"e-hcol"):this._removeClass(s.get(j+1),"e-hcol")}t<r?this.XLSelection.selectColumns(t,r,u):this.XLSelection.selectColumn(f,u);this.XLDragFill.positionAutoFillElement();this._isUndoRedo||this.model.sheets[u]._importRendered||(l={sheetIndex:u,reqType:"show-hide",action:"show",operation:"column",start:t,end:0},this._completeAction(l))}this.getBrowserDetails().browser.indexOf("msie")>-1&&this._colgroupRefresh(u)}},_destroySheet:function(n){this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value).empty()},_destroy:function(){var t=1,i;for(this._unWireEvents(),this.element.find(".e-spreadsheet-list").empty(),n("#"+this._id+"_sscustomformat").remove();t<=this.model.sheetCount;)i=this.getSheet(t)._sheetName.value,delete n.templates[this._id+"JSONTemplate"+t],CalcEngine.unregisterGridAsSheet(i,i),t++;this.model.sheets=[];this.model.nameManager=[];n("#"+this._id+"_nmgrid").ejGrid("option",{dataSource:[]});CalcEngine._tokenCount=0},_unWireEvents:function(){var r=this.element,i=t.eventType,u=this._id;this._off(r,i.mouseDown,".e-ribbon, .e-spreadsheetcontentcontainer .e-vscroll, .e-spreadsheetcontentcontainer .e-hscroll",this._rClickHandler);this._off(r,i.mouseDown,".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel",this._mouseDownHandler);this._off(r,"keydown",this._keyDownHandler);this._off(r,"click",".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel, .e-ss-object",this._cellClick);this._off(r,"dblclick",".e-spreadsheetcontentcontainer,.e-spreadsheetheader,.e-spreadsheetrowheader",this._recorddblClickHandler);this._off(r,i.mouseMove,this._mouseMove);this._off(r,i.mouseUp,this._sheetMouseUp);this.model.allowResizing&&this._off(r,i.mouseLeave,".e-spreadsheetrowheader,.e-spreadsheetheader",this._mouseLeave);this._off(r,i.click,".e-ssfiltered, .e-ssfilter, .e-ssfiltered-asc, .e-ssfilter-asc, .e-ssfiltered-dsc, .e-ssfilter-dsc",this._filterDownHandler);this._off(r,i.mouseDown,".e-ssddl",this._ddlopen);this._off(r,"mouseover",".e-rowcell",this._cellHoverHandler);this._off(this._getInputBox(),"input",this.XLEdit._formulaBoxInputChange);this._off(n("#"+u+"_cellstyles"),i.click,this._cellStyleClick);this._off(n("#"+u+"_formatastable"),i.click,this._formatAsTableClick);this._off(n("#"+u+"_nmuseinformula"),i.click,".e-nmuseinformularow",this._useInFormulaClick);this.element.find(".e-spreadsheet-list").unbind("mousewheel DOMMouseScroll",n.proxy(this.XLScroll._spreadMouseWheel,this.XLScroll));this._off(n("#"+u+"picturecolor"),i.mouseMove,this.XLRibbon._pictureColorOpen);this._off(n("#"+u+"_Ribbon_PictureBorder").find(".picturecolor"),i.mouseMove,this.XLRibbon._pictureColorClose);this._off(n("#"+u+"_Ribbon_PictureColor_popup"),i.click,this.XLRibbon._pictureColorClose);this._off(n(".e-menu .e-chartcontent .e-chartcell"),i.click,this._chartClickHandler);this._off(n("#"+u+"_allchart").find(".e-chartimg"),i.click,this._allChartType);this.model.scrollSettings.isResponsive&&n(window).unbind("resize",n.proxy(this._spreadsheetonresize,this))},getValueRowCol:function(n,t,i){var u=this._dataContainer,r=u.sheets;return t=t-1,i=i-1,n in r&&t in r[n]&&i in r[n][t]?u.sharedData[r[n][t][i].value]:void 0},setValueRowCol:function(n,t,i,r){var u,f,e=i-1,o=r-1,s=this.getCell(e,o,n)[0];u=this.getRangeData([e,o,e,o],!1,["formatStr","type","thousandSeparator","decimalPlaces"],n)[0];u.formatStr&&(f=this.XLFormat._format(t,{formatStr:u.formatStr,type:u.type,thousandSeparator:u.thousandSeparator,decimalPlaces:u.decimalPlaces}));u.type=="fraction"&&(f=this.XLFormat._format(t,{type:u.type}));this.XLEdit._updateDataContainer(s,{value2:f||t});this.XLEdit._refreshCellAlignment(s,t,u.type)},getActiveCellElem:function(n){return this._getContent(this.isNumber(n)?n:this.getActiveSheetIndex()).find("td.e-activecell")},_hlDlgOpen:function(){var s=this.getActiveSheetIndex(),u=this.getActiveCellElem(s);if(!u.length)return!1;var t=this._id,h,c=n("#"+t+"_Ribbon_webAddress"),l=n("#"+t+"_Ribbon_cellAddress"),f=n("#"+t+"_Ribbon_findText"),i,r=this.XLEdit.getPropertyValue(u.parent("tr").index(),u[0].cellIndex,"hyperlink",s),a,e,o=n("#"+t+"_Ribbon_cellText");n("#"+t+"_HLDialog").ejDialog("open");e=n("#"+t+"_Ribbon_sheentName").data("ejTreeView");e.option("fields",{dataSource:this.XLRibbon._sheetData()});h=n("#"+t+"_HLDialogTab").data("ejTab");o.attr("disabled",!1);f.attr("disabled",!1);this.isUndefined(r)?h.model.selectedItemIndex===0?c.val(""):(e.selectNode("#"+(s+1)),o.val(e.getText("#"+(s+1))+"!A1"),l.val("A1")):(this.isUndefined(r.webAdr)?h.option({selectedItemIndex:1}):h.option({selectedItemIndex:0}),c.val(r.webAdr),this.isUndefined(r.cellAdr)||(l.val(r.cellAdr.split("_")[0]),a=parseInt(r.cellAdr.split("_")[1])+1,e.selectNode("#"+a)));n("#"+t+"_Form_Ribbon_cellAddress").validate().resetForm();n("#"+t+"_Form_Ribbon_webAddress").validate().resetForm();f.val("");i=this.XLEdit.getPropertyValueByElem(u);this.isUndefined(i)||(this.isFormula(i)||this.XLEdit.getPropertyValueByElem(u,"type")==="datetime"||n.isNumeric(i)?(o.val(this._getLocStr("HyperLinkHide")),f.val(this._getLocStr("HyperLinkHide")),o.attr("disabled",!0),f.attr("disabled",!0)):(o.val(i),f.val(i)));c.focus().setInputPos(c.val().length);l.focus().setInputPos(l.val().length)},_setLink:function(t){var e,r,o,h,u,a,c,l=this.getActiveSheetIndex(),v,i,f=this.getActiveCellElem(l),s;u=this.getSheet(l).selectedRange;e=n("#"+this._id+"_Ribbon_cellText").val();r=n("#"+this._id+"_Ribbon_cellAddress").val();o=n("#"+this._id+"_Ribbon_findText").val();h=n("#"+this._id+"_Ribbon_webAddress").val();c=n("#"+this._id+"_Ribbon_sheentName").data("ejTreeView");a=c.getSelectedNode().index();e.length||o.length||(e=c.getSelectedNode().text()+"!"+r,o=h);s=this.XLEdit.getPropertyValueByElem(f);i=this.XLEdit.getPropertyValueByElem(f,"type")==="datetime"?this.XLEdit.getPropertyValueByElem(f,"value2"):n.isNumeric(s)||this.isFormula(s)?s:r.length?e:o;this.XLEdit.updateCellValue(f,i);(this.isFormula(i)||n.isNumeric(i))&&(i=this.XLEdit.getPropertyValueByElem(f,"value2"));v=r.length?{cellAdr:r,text:i}:{webAdr:h,text:i};this.setHyperlink(this._getAlphaRange(l,u[0],u[1],u[2],u[3]),v,a+1,t)},setHyperlink:function(i,r,u,f){var c;if(this.model.allowHyperlink){if(c={range:i,address:r.webAdr,text:r.text,sheetIndex:u,reqType:"hyperlink",action:"add"},this._trigActionBegin(c))return;i=c.range;r.webAdr=c.address;r.text=c.text;u=c.sheetIndex;var y,s,p,v,g=this.getActiveSheetIndex(),w,l=[],b,h,e,a,o=this._getAlphaRangeCells(i),k={sheetIndex:this.getActiveSheetIndex(),reqType:"hyperlink"},d;if(k.action=t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(n(o[0]),"hyperlink"))?"add":"edit",this._isUndoRedo)for(e=0,a=o.length;e<a;e++)t.isNullOrUndefined(f[e].prevLink)||(this.XLEdit._updateDataContainer(o[e],{hyperlink:f[e].prevLink}),e===0?(n(o[e]).find("a").remove(),t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").cellAdr)?n(o[e]).text("").append(t.buildTag("a",f[e].prevText,"",{href:this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").webAdr,target:"_blank"})):n(o[e]).text("").append(t.buildTag("a",f[e].prevText,"",{href:"#"}))):(d=n(o[e]).text(),n(o[e]).find("a").remove(),t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").cellAdr)?n(o[e]).text("").append(t.buildTag("a",d,"",{href:this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").webAdr,target:"_blank"})):n(o[e]).text("").append(t.buildTag("a",d,"",{href:"#"}))),n(o[e]).find("a").addClass("e-hyperlinks"),this._isHLink=!0,this.XLFormat.format({style:{color:"#428bca"}}),this._isHLink=!1);else{for(t.isNullOrUndefined(r.webAdr)?(s=r.cellAdr,y=t.isNullOrUndefined(r.text)?o.eq(0).text():r.text,s.indexOf("!")>-1&&(w=s.split("!"),u=this._getSheetIndexByName(w[0]),s=w[1]),s.indexOf("$")>-1&&(s=s.split("$").join(""))):(v=r.webAdr,p=t.isNullOrUndefined(r.text)?o.eq(0).text():r.text,v.indexOf("http://")===-1&&(v="http://"+v)),e=0,a=o.length;e<a;e++)l.push({rowIndex:n(o[e]).parent().index(),colIndex:o[e].cellIndex,prevLink:this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink")});for(this.isUndefined(s)?this.updateUniqueData({hyperlink:{webAdr:v}},null,o):this.updateUniqueData({hyperlink:{cellAdr:s+"_"+u}},null,o),e=0,a=o.length;e<a;e++)h=o.eq(e).text(),l[e].prevText=h,n(o.eq(e).find("a")).remove(),n(o.eq(e).contents()[0]).remove(),o.eq(e).hasClass("e-commentcell")&&o.eq(e).removeClass("e-commentcell")&&this.XLComment.setComment(o.eq(e),null,!1),b=this.XLEdit.getPropertyValue(o.eq(e).closest("tr").index(),o.eq(e)[0].cellIndex,"hyperlink",g),b.cellAdr?(h=e===0?y:h,o.eq(e).append(t.buildTag("a",h,"",{href:"#"})),l[e].curText=y):(h=e===0?p:h,o.eq(e).append(t.buildTag("a",h,"",{href:b.webAdr,target:"_blank"})),l[e].curText=p),l[e].curLink=this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink");n(o.find("a")).addClass("e-hyperlinks");this._isHLink=!0;this.XLFormat.format({style:{color:"#428bca"}},i);this._isHLink=!1;k.selCells=l;this.model.sheets[g]._importRendered||this._completeAction(k)}}},removeHyperlink:function(i,r,u){var f,o,h=[],a=this.getActiveSheetIndex(),s=[],c,e=this._getAlphaRangeCells(i),l={sheetIndex:a,reqType:"hyperlink",action:"delete"};for(e.find("a").contents().unwrap(),e.find("a").removeClass("e-hyperlinks"),this._isHLink=!0,this.XLFormat.format({style:{color:"#444445"}},i),this._isHLink=!1,f=0,o=e.length;f<o;f++)s.push({rowIndex:n(e[f]).parent().index(),colIndex:e[f].cellIndex,prevLink:this.XLEdit.getPropertyValueByElem(n(e[f]),"hyperlink"),prevText:e.eq(f).text()}),this.clearRangeData(null,["hyperlink"],[e[f]]),s[f].curLink=this.XLEdit.getPropertyValueByElem(n(e[f]),"hyperlink"),this._isUndoRedo&&!this._isSort&&e.eq(f).text(u[f].prevText),s[f].curText=e.eq(f).text(),!this._isUndoRedo||this._isSort||t.isNullOrUndefined(u[f].prevLink)||(this.XLEdit._updateDataContainer(e[f],{hyperlink:u[f].prevLink}),c={rowIndex:u[f].rowIndex,colIndex:u[f].colIndex},this.XLSelection.selectRange(c,c),this._setLink([u[f]]),h.push(f));for(f=0,o=h.length;f<o;f++)e.splice(h[f],1);l.selCells=s;l.reqType=t.isNullOrUndefined(r)?"hyperlink":"clear-link";this.model.sheets[a]._importRendered||this._isUndoRedo||this._isSort||this._completeAction(l)},_removeHyperlink:function(n,t){var r=this.getActiveSheetIndex(),i=this.getSheet(r).selectedRange;this.removeHyperlink(this._getAlphaRange(r,i[0],i[1],i[2],i[3]),n,t)},_openLink:function(){var n=this.getActiveSheetIndex(),t=this.getSheetElement(n).find(".e-activecell");this._hlClick(this.XLEdit.getPropertyValue(t.closest("tr").index(),t[0].cellIndex,"hyperlink",n))},_hlClick:function(t){var i,r,u,e,o,s=this.getActiveSheetIndex(),f;t.cellAdr?(i=this.getRangeIndices(t.cellAdr),u={rowIndex:i[0],colIndex:i[1]},e={rowIndex:i[2],colIndex:i[3]},r=t.cellAdr.split("_")[1]===0?s:Number(t.cellAdr.split("_")[1]),this.gotoPage(r,!1),this.getSheet(s)._activeCell=u,this.XLSelection.selectRange(u,e,r),this.XLScroll._scrollSelectedPosition(r,u),this.XLDragFill.positionAutoFillElement(),this._isPrevCMenu=!0):(o=new RegExp("^(http://www.|http://www.|ftp://www.|www.){1}([0-9A-Za-z]+.)"),f=n("#"+this._id+"_alertdlg"),o.test(t.webAdr)?window.open(t.webAdr,"_blank"):(this._renderAlertDlgContent(f,"Alert",t.webAdr+this._getLocStr("HyperLinkAlert"),""),this._alertDialog.element.ejDialog("open")&&f.focus()))},showWaitingPopUp:function(){n("#"+this._id).data("ejWaitingPopup").show()},hideWaitingPopUp:function(){n("#"+this._id).data("ejWaitingPopup").hide()},_getSelRange:function(n){var t,i,r=this.getActiveSheetIndex();return t=n[0],i=n[n.length-1],this._generateHeaderText(r,t.colIndex+1)+(t.rowIndex+1)+":"+this._generateHeaderText(r,i.colIndex+1)+(i.rowIndex+1)},_getSelectedCells:function(n,i){var u,r;return t.isNullOrUndefined(i)?(u=this.model.sheets[n]._selectedCells,i=this._getSelRange(u),r=this.getRangeIndices(i)):(r=this.getRangeIndices(i),u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]})),this.model.sheets[n]._selectedCells=u,r},_getHiddenCells:function(i,r,u,f){var e=this._dataContainer.sheets[i];return t.isNullOrUndefined(f[u.rowIndex])&&(f[u.rowIndex]={}),t.isNullOrUndefined(f[u.rowIndex][u.colIndex])&&(f[u.rowIndex][u.colIndex]={value:{},text:""}),t.isNullOrUndefined(e[u.rowIndex])||(f[u.rowIndex][u.colIndex].value=n.extend(!0,{},e[u.rowIndex][u.colIndex]),delete e[u.rowIndex][u.colIndex],f[u.rowIndex][u.colIndex].text=r.text()),r.empty(),f},_getRowSpan:function(t,i){for(var f=this.getRows(t)[0],r=0,u=i[0].rowIndex,e=i[i.length-1].rowIndex;u<=e;u++)n(f[u]).hasClass("e-fr-hide")||(r=r+1);return r},_getHiddenRowColumnCount:function(t,i){for(var r=this.getRangeIndices(i),e=0,o=0,f,s=this.getRows(t)[0],h=this._getContent(t).find("col"),u=r[0];u<=r[2];u++)n(s[u]).hasClass("e-fr-hide")&&(e=e+1);for(f=r[1];f<=r[3];f++)n(h[f]).hasClass("e-fc-hide")&&(o=o+1);return{hRow:e,hCol:o}},mergeCells:function(i,r){var f,c,e=this.getActiveSheetIndex(),a=n("#"+this._id+"_alertdlg"),u,s,h=!1,o,l;if(this._selMergeCells=[],this._mergeType="merge-cells",s=this._getSelectedCells(e,i),u=t.isNullOrUndefined(i)?this.model.sheets[e]._selectedCells:this.XLSelection._getSelectedRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]}),!this.model.sheets[e]._importRendered)if(this._mergeCenter){for(h=!1,f=0,c=u.length;f<c;f++)o=this.getCell(u[f].rowIndex,u[f].colIndex),(o[0].rowSpan>1||o[0].colSpan>1)&&(l=this._getHiddenRowColumnCount(e,this.XLEdit.getPropertyValueByElem(o,"mRange")),this._unMergeAllCells(e,f,u,[],l.hRow,l.hCol),h=!0);this.performSelection(u[0],u[u.length-1])}else for(f=0,c=u.length;f<c;f++)if(o=this.getCell(u[f].rowIndex,u[f].colIndex),o[0].rowSpan===1&&o[0].colSpan===1){h=!1;break}!this.model.sheets[e]._importRendered&&!this._isUndoRedo&&this._rangeHasData(s)&&!r&&!h&&u.length>1?(this._renderAlertDlgContent(a,"",this._getLocStr("MergeCellsAlert"),"MergeCells",498),this._alertDialog.element.ejDialog("open")&&a.focus()):h||this._mergeCells(e,u,{},[])},_mergeCells:function(i,r,u,f){var a=this._dataContainer.sheets[i],v,y,o,s,p={},e,h,l=this._rcRegx,k=this._getContent(i).find("col"),w,c,b;if(o=r[0].rowIndex,s=r[0].colIndex,e=this.getCell(o,s),!e.parent().hasClass("e-fr-hide")&&k.eq(s).hasClass("e-fc-hide"))return{hideCell:[],mCells:[]};for(e.get(0).colSpan=r[r.length-1].colIndex-r[0].colIndex+1,e.get(0).rowSpan=this._getRowSpan(i,r),e.hasClass("e-mc-hide")&&(e.removeClass("e-mc-hide"),e[0].className.match(l[0])&&(e[0].className=e[0].className.replace(l,""))),this._selMergeCells.push(r[0]),this._mergeType==="merge-cells"&&this._mergeCenter&&e.addClass("e-calign"),w="e-rc-"+o+":"+s,c=1,b=r.length;c<b;c++)h=this.getCell(r[c].rowIndex,r[c].colIndex),h.hasClass("e-mc-hide")&&(h.removeClass("e-mc-hide"),h[0].className.match(l[0])&&(h[0].className=h[0].className.replace(l,""))),h.addClass("e-mc-hide "+w),u=this._getHiddenCells(i,h,r[c],u),this._selMergeCells.push(r[c]);return t.isNullOrUndefined(a[o])||n.extend(!0,p,a[o][s]),y=this._getSelRange(r),this.model.sheets[i]._activeCell=r[0],this.model.sheets[i]._importRendered||(this.performSelection(r[0],r[r.length-1]),this.XLEdit._updateDataContainer(e[0],{isMerge:!0,mRange:y,isCenterAlign:this._mergeCenter})),f.push({rowIndex:o,colIndex:s,prevObj:p,curObj:n.extend(!0,{},a[o][s])}),this.model.sheets[i]._importRendered||this._isUndoRedo||this._paste||this._isClearAll||this._mergeType==="merge-cells"&&(v={sheetIndex:i,cells:[{rowIndex:o,colIndex:s}],range:y,reqType:"merge-cells",action:"merge-all",hideCells:u,mCells:f},v.operation=this._mergeCenter?"merge-center":"merge-all",this._paste||this._completeAction(v)),this._mergeCenter=!1,this._paste=!1,{hideCells:u,mCells:f}},mergeAcrossCell:function(i,r){var e=this.getActiveSheetIndex(),o=n("#"+this._id+"_alertdlg"),u,f;this._selMergeCells=[];f=this._getSelectedCells(e,i);u=t.isNullOrUndefined(i)?this.model.sheets[e]._selectedCells:this.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]});!this._isUndoRedo&&this._rangeHasData(f)&&!this.model.sheets[e]._importRendered&&!r&&u.length>1&&u[0].colIndex!=u[u.length-1].colIndex?(this._renderAlertDlgContent(o,"",this._getLocStr("MergeCellsAlert"),"MergeAcrossCells",630),this._alertDialog.element.ejDialog("open")&&o.focus()):u[0].colIndex!=u[u.length-1].colIndex&&this._mergeAcrossCells(e,u);this.performSelection(u[0],u[u.length-1])},_mergeAcrossCells:function(t,i){var r,f,h,o=!0,e,c,l,a,v,y,s=[],u={mCells:[],hideCells:{}};for(this._mergeType="merge-across",r=0,h=i.length;r<h;r++)if(e=this.getCell(i[r].rowIndex,i[r].colIndex),e[0].rowSpan===1&&e[0].colSpan===1){o=!1;break}else e[0].rowSpan>1&&(o=!1);if(!o)for(v=i[0].rowIndex,y=i[i.length-1].rowIndex,l=i[0].colIndex,a=i[i.length-1].colIndex,r=v;r<=y;r++){for(s=[],f=l;f<=a;f++)s.push({rowIndex:r,colIndex:f});u=this._mergeCells(t,s,u.hideCells,u.mCells)}this.model.sheets[t]._importRendered||this._isUndoRedo||this._isClearAll||(c={sheetIndex:t,cells:n.extend(!0,[],this._selMergeCells),range:this._getSelRange(this._selMergeCells),reqType:"merge-cells",action:"merge-across",operation:"merge-across",hideCells:u.hideCells,mCells:u.mCells},this._paste||this._completeAction(c),this._paste=!1);this.performSelection(i[0],i[i.length-1])},unmergeCells:function(n){var r=this.getActiveSheetIndex(),e=[],i,h,f,o,s,u,c;for(f=this._getSelectedCells(r,n),this._selMergeCells=[],i=t.isNullOrUndefined(n)?this.model.sheets[r]._selectedCells:this.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]}),u=0,c=i.length;u<c;u++)s=this.XLEdit.getPropertyValue(i[u].rowIndex,i[u].colIndex,"mRange",r),this.isUndefined(s)||(o=this._getHiddenRowColumnCount(r,s),e=this._unMergeAllCells(r,u,i,e,o.hRow,o.hCol));n=this._getSelRange(i);this.performSelection(i[0],i[i.length-1]);this.model.sheets[r]._importRendered||this._isUndoRedo||this._isClearAll||(h={sheetIndex:r,cells:i,range:n,reqType:"merge-cells",action:"un-merge",operation:"un-merge",mCells:e},this._completeAction(h))},_unMergeAllCells:function(i,r,u,f,e,o){var c,a,e,o,p,v=this._dataContainer.sheets[i],w=this._rcRegx,nt,d={},y,b,k,h,s,l,g,tt=this.getRows(i)[0],it=this._getContent(i).find("col");if(s=u[r].rowIndex,l=u[r].colIndex,rowhdrrows=this._getJSSheetRowHeader(i).find(".e-table").get(0).rows,y=this.getCell(s,l),b=y.get(0).colSpan,k=y.get(0).rowSpan,b>1||k>1)for(y.hasClass("e-calign")&&(nt="center",y.removeClass("e-calign")),n.extend(!0,d,v[s][l]),y.get(0).colSpan=1,y.get(0).rowSpan=1,t.isNullOrUndefined(v[s])||t.isNullOrUndefined(v[s][l])||(this.XLEdit.getPropertyValueByElem(y,"isMerge",i)&&n(rowhdrrows[s]).height()<y[0].offsetHeight&&this._setRowHdrHeight(i,s),delete v[s][l].isMerge,delete v[s][l].mRange,delete v[s][l].isCenterAlign),f.push({rowIndex:s,colIndex:l,prevObj:d,curObj:n.extend(!0,{},v[s][l])}),g=[],c=s;c<s+k+e;c++)for(a=l;a<l+b+o;a++)h=this.getCell(c,a),this._selMergeCells.push({rowIndex:c,colIndex:a}),h.hasClass("e-mc-hide")&&(this._isUndoRedo&&(h[0].rowSpan>1||h[0].colSpan>1)&&(g.push({rowIndex:c,colIndex:a,rowSpan:h[0].rowSpan,colSpan:h[0].colSpan}),h[0].rowSpan=1,h[0].colSpan=1),p=h[0].className.match(w)[0].replace("e-rc-","").split(":"),p.length>0&&parseInt(p[0])===s&&parseInt(p[1])===l&&(h.removeClass("e-mc-hide"),h[0].className.match(w)&&(h[0].className=h[0].className.replace(w,"")))),this._isUndoRedo&&!t.isNullOrUndefined(this._delCells)&&(t.isNullOrUndefined(this._delCells[c])||t.isNullOrUndefined(this._delCells[c][a])||t.isNullOrUndefined(v[c])||(v[c][a]=this._delCells[c][a].value,h.text(this._delCells[c][a].text)));return f},showHeaders:function(t){var i=this.getActiveSheetIndex(),r={};this.model.sheets[i].showHeader=t;this._isDisplayHeader=!0;n.extend(!0,r,this.model.scrollSettings);this.model.sheets[i].showHeader?(this._getJSSheetRowHeader(i).show(),this._getJSSheetHeader(i).show()):(this._getJSSheetRowHeader(i).hide(),this._getJSSheetHeader(i).hide());this.XLRibbon._heightWidthCalculation(i,r)},showGridlines:function(n){var t=this.getActiveSheetIndex();this.model.sheets[t].showGridlines=n;this.model.sheets[t].showGridlines?this._getContent(t).find(".e-rowcell").removeClass("e-hborder"):this._getContent(t).find(".e-rowcell").addClass("e-hborder")},printHeader:function(n){this.model.sheets[this.getActiveSheetIndex()].printHeader=n},printGridlines:function(n){this.model.sheets[this.getActiveSheetIndex()].printGridlines=n},setSheetFocus:function(){n("#"+this._id).focus()},_diffNumbers:function(n,t){return n-t},_isValidDate:function(n){var t,i;return/^\d{1,4}[\.|\/|-]\d{1,2}[\.|\/|-]\d{1,4}$/.test(n)?(n=n.replace(/0*(\d*)/gi,"$1"),t=n.split(/[\.|\/|-]/),t[1]=t[1]-1,t[2].length<4&&(t[2]=parseInt(t[2])<50?2e3+parseInt(t[2]):1900+parseInt(t[2])),i=new Date(t[2],t[1],t[0]),i.getDate()!=t[0]||i.getMonth()!=t[1]||i.getFullYear()!=t[2]?!1:!0):!1},_isValidTime:function(n){for(var t,r,i=0,o=!1,f,e,u=0,s=n.length;u<s;u++){if(t=n.substring(u,u+1),(t<"0"||t>"9")&&t!=":"&&t!=" "&&t!="a"&&t!="A"&&t!="p"&&t!="P"&&t!="m"&&t!="M")return!1;t==":"&&i++;(t=="p"||t=="P"||t=="a"||t=="A")&&(o=!0)}return i<1||i>2?!1:(r=n.substring(0,n.indexOf(":")),parseFloat(r)<0||parseFloat(r)>23)?!1:o&&(parseFloat(r)<1||parseFloat(r)>12)?!1:(f=i==2?n.substring(n.indexOf(":")+1,n.lastIndexOf(":")):n.substring(n.indexOf(":")+1,n.length),parseFloat(f)<0||parseFloat(f)>59)?!1:(e=i==2?n.substring(n.lastIndexOf(":")+1,n.length):"00",parseFloat(e)<0||parseFloat(e)>59)?!1:!0},_setXY:function(n){var t=0,i=0;return n.type==="mousemove"||n.type==="mousedown"?(t=n.clientX,i=n.clientY):n.type==="touchmove"?(t=n.originalEvent.changedTouches[0].clientX,i=n.originalEvent.changedTouches[0].clientY):n.type==="MSPointerMove"&&(t=n.originalEvent.clientX,i=n.originalEvent.clientY),[t,i]},getBrowserDetails:function(){var t=navigator.userAgent.match(/(firefox|chrome|opera|msie|safari)\s?\/?(\d+(.\d+)*)/i);return!navigator.userAgent.match(/Trident\/7\./)?{browser:t[1].toLowerCase(),version:t[2]}:{browser:"msie",version:n.uaMatch(navigator.userAgent).version}},_getSelectedItems:function(n,i,r){var f,e,o,u;return n=n?n:this.getActiveSheetIndex(),u=this.getSheet(n),t.isNullOrUndefined(r)&&t.isNullOrUndefined(i)?(f=u._selectedCells,e=u._startCell,o=u._endCell,r=this._generateHeaderText(n,e.colIndex+1)+(e.rowIndex+1)+":"+this._generateHeaderText(n,o.colIndex+1)+(o.rowIndex+1)):(i=this.isUndefined(i)?this.getRangeIndices(r):i,f=this.getRange(i[0],i[1],i[2],i[3],n),r=this._generateHeaderText(n,i[1]+1)+(i[0]+1)+":"+this._generateHeaderText(n,i[3]+1)+(i[2]+1)),[f,r]},setBorder:function(n,t){var r="",s=n.borderStyle,f=n.ID,e=n.hexaCode,l,a,v,h,c,u,y,o=this._getContent(this.getActiveSheetIndex());l=["bottomborder","topborder","leftborder","rightborder","outsideborder"];a=["thickboxborder","thickbottomborder","topandbottomborder","topandthickbottomborder"];v=["allborder"];h={topborder:{top:""},rightborder:{right:""},bottomborder:{bottom:""},leftborder:{left:""},outsideborder:{top:"",right:"",bottom:"",left:""},thickboxborder:{top:"2px solid",right:"2px solid",bottom:"2px solid",left:"2px solid"},thickbottomborder:{bottom:"2px solid"},topandbottomborder:{top:"1px solid",bottom:"1px solid"},topandthickbottomborder:{top:"1px solid",bottom:"2px solid"}};c={solid:"1px solid",dashed:"1px dashed",dotted:"1px dotted"};this._isGridBordering=this._isOutsideBordering=!1;switch(!0){case l.indexOf(f)>-1:u=h[f];for(i in u)r="",r=r+c[s]+" "+e,u[i]=r;this.XLFormat.applyBorder(u,t);break;case a.indexOf(f)>-1:u=h[f];for(i in u)r="",y=u[i].split(" "),r=y.length===2?r+u[i]+" "+e:r+u[i]+" "+s+" "+e,u[i]=r;this.XLFormat.applyBorder(u,t);break;case v.indexOf(f)>-1:r=r+c[s]+" "+e;this.XLFormat.applyBorder(r,t);break;case f==="noborder":this.XLFormat.applyBorder("noborder");break;case f==="drawborder":this.XLSelection._isOutsideBordering=!0;o.removeClass("e-ss-cursor");o.addClass("e-ss-drwbrdrcursor");break;case f==="drawbordergrid":this.XLSelection._isGridBordering=!0;o.removeClass("e-ss-cursor");o.addClass("e-ss-drwbrdrgridcursor")}},clearBorder:function(n){n=this.getRangeIndices(n);this.XLFormat.clearFormat(n,"border")},clearAllFormat:function(n){var h=this.getActiveSheetIndex(),i=this.isUndefined(n)?this.getSheet(h).selectedRange:this.getRangeIndices(n),f=[],c={sheetIndex:h,reqType:"clear-format",range:i,bFormat:this.XLFormat.getHashCodeClassAsArray(i),wRange:[],hRange:[],cFormatRule:[]},e,o,s,l,r,u;for(this._isClearAll=!0,this.XLFormat.clearFormat(i),this.XLCFormat.clearCF(!0),e=this.getObjectKeys(this._dataContainer.sheets[h]),f[0]=i[0]>parseInt(e[0])?i[0]:parseInt(e[0]),f[2]=i[2]<parseInt(e[e.length-1])?i[2]:parseInt(e[e.length-1]),r=f[0];r<f[2]+1;r++)for(o=this.getObjectKeys(this._dataContainer.sheets[h][r]),f[1]=i[1]>parseInt(o[0])?i[1]:parseInt(o[0]),f[3]=i[3]<parseInt(o[o.length-1])?i[3]:parseInt(o[o.length-1]),u=f[1];u<f[3]+1;u++)s=this.getCell(r,u),s[0].className.indexOf("e-sswraptext")>-1&&c.wRange.push({rowIndex:r,colIndex:u}),l=t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(s,"cFormatRule"))?"":this.XLCFormat.getCFRule(r,u)[this.XLCFormat.getCFRule(r,u).length-1],c.cFormatRule.push({rowIndex:r,colIndex:u,rule:l}),s.find("a").hasClass("e-hyperlinks")&&(c.hRange.push({rowIndex:r,colIndex:u,rowIndex:r,colIndex:u}),s.find("a").css("color","#444445").removeClass("e-hyperlinks"));this.setWrapText(n,"unwrap");this.XLComment._updateCmntArrowPos();this.XLRibbon._updateRibbonIcons();this._isClearAll=!1;this._isUndoRedo||this._completeAction(c)},clearContents:function(n){var t,i;n=this.isUndefined(n)?this.getSheet(r).selectedRange:this.getRangeIndices(n);var r=this.getActiveSheetIndex(),u=this.getRangeData(n),f={sheetIndex:r,reqType:"clear-content",range:n,bData:u};for(this.clearRangeData(n,["value","value2"]),t=n[0];t<n[2]+1;t++)for(i=n[1];i<n[3]+1;i++)this.XLComment._updateCmntFrmCntnr(t,i);this._completeAction(f);this.setSheetFocus()},clearAll:function(n){var h=this.getActiveSheetIndex(),f=[],u=this.isUndefined(n)?this.getSheet(h).selectedRange:this.getRangeIndices(n),v=this.getRangeData(u),l={sheetIndex:h,reqType:"clear-all",range:u,bFormat:this.XLFormat.getHashCodeClassAsArray(u),bData:v,selCells:[]},e=this._dataContainer.sheets[h],o,s,c,a,i,r;for(this._isClearAll=!0,o=this.getObjectKeys(this._dataContainer.sheets[h]),f[0]=u[0]>parseInt(o[0])?u[0]:parseInt(o[0]),f[2]=u[2]<parseInt(o[o.length-1])?u[2]:parseInt(o[o.length-1]),i=f[0];i<f[2]+1;i++)for(s=this.getObjectKeys(this._dataContainer.sheets[h][i]),f[1]=u[1]>parseInt(s[0])?u[1]:parseInt(s[0]),f[3]=u[3]<parseInt(s[s.length-1])?u[3]:parseInt(s[s.length-1]),r=f[1];r<f[3]+1;r++)c=this.getCell(i,r),a=t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(c,"cFormatRule"))?"":this.XLCFormat.getCFRule(i,r)[this.XLCFormat.getCFRule(i,r).length-1],t.isNullOrUndefined(e[i][r])||l.selCells.push({rowIndex:i,colIndex:r,prevLink:this.XLEdit.getPropertyValueByElem(c,"hyperlink"),curLink:{},prevText:c.text(),prevComment:this.XLEdit.getPropertyValueByElem(c,"comment"),mRange:t.isNullOrUndefined(e[i][r].mRange)?"":e[i][r].mRange,mergeCenter:!t.isNullOrUndefined(e[i][r].mRange)&&e[i][r].isCenterAlign,wrap:t.isNullOrUndefined(e[i][r].wrap)?"":e[i][r].wrap,cFormatRule:a});this.clearRangeData(u);this.XLFormat.clearFormat(u);this.XLCFormat.clearCF(!0);this.unmergeCells(n);this.setWrapText(n,"unwrap");this._isClearAll=!1;this.XLRibbon._updateRibbonIcons();this._completeAction(l)},renameSheet:function(n){this._updateSheetNames(n)},copySheet:function(n,i,r){var y=this._getSheetIndex(y),u,f,a,e,v=!1,c=2,h,o=this.element.find("#NumericContainer").children().eq(n-1),l=i,s=this.model.sheets;if(!r&&s[l]._sheetName.text===o.text()){this.setSheetFocus();return}for(f=1,a=s.length;f<a;f++)s.length-1!==l&&s[l]._sheetName.text===s[f]._sheetName.text&&(u=f),o.text()===s[f]._sheetName.text&&(h=f);if(r){for(o.text().match(".*[ ]+[(]+[0-9]+[)]$")===null?e=o.text()+" ("+c+")":o.text().lastIndexOf(" ")>-1&&(c=parseInt(o.text().substring(o.text().lastIndexOf("(")+1,o.text().lastIndexOf(")"))),e=o.text().substring(0,o.text().lastIndexOf(" "))+" ("+c+")");!v;){for(e=e.substring(0,e.lastIndexOf(" "))+" ("+c+")",f=1,a=s.length;f<a;f++)e===s[f]._sheetName.text&&c++;c===parseInt(e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")")))&&(v=!0)}this._copySheetProcess(h,e);h=this.model.sheetCount;t.isNullOrUndefined(u)&&(u=h)}else!t.isNullOrUndefined(u)&&u>h&&(u=u-1);t.isNullOrUndefined(u)&&(u=l);r||u!==h?(this._swapSheetDtCntr(h,u),this.getPager().ejPager("option",{currentPage:l}),this.gotoPage(l,!1),this.setSheetFocus()):this.setSheetFocus()},getHyperlink:function(n){return this.XLEdit.getPropertyValueByElem(n,"hyperlink",this.getActiveSheetIndex())},getComment:function(n){return this.XLEdit.getPropertyValueByElem(n,"comment",this.getActiveSheetIndex())}});t.Spreadsheet.locale={};t.Spreadsheet.locale["en-US"]={Cut:"Cut",Copy:"Copy",FormatPainter:"Format Painter",Paste:"Paste",PasteValues:"Paste Values Only",PasteSpecial:"Paste",Filter:"Filter",FilterContent:"Turn on filtering for the selected cells.",FilterSelected:"Filter by Selected Cell's value",Sort:"Sort",Clear:"Clear",ClearContent:"Delete everything in the cell, or remove just the formatting, contents, comments or hyperlinks.",ClearFilter:"Clear Filter",ClearFilterContent:"Clear the filter and sort state for the current range of data.",SortAtoZ:"Sort A to Z",SortAtoZContent:"Lowest to Highest.",SortZtoA:"Sort Z to A",SortZtoAContent:"Highest to Lowest.",SortSmallesttoLargest:"Sort Smallest to Largest",SortLargesttoSmallest:"Sort Largest to Smallest",SortOldesttoNewest:"Sort Oldest to Newest",SortNewesttoOldest:"Sort Newest to Oldest",Insert:"Insert",InsertTitle:"Insert Cells",InsertContent:"Add new cells, rows, or columns to your workbook.<br /><br />FYI: To insert multiple rows or columns at a time, select multiple rows or columns in the sheet, and click Insert.",InsertSBContent:"Add cells, rows, columns, or sheets to your workbook.",Delete:"Delete",DeleteTitle:"Delete Cells",DeleteContent:"Delete cells, rows, columns, or sheets from your workbook.<br /><br />FYI: To delete multiple rows or columns at a time, select multiple rows or columns in the sheet, and click Delete.",FindSelectTitle:"Find & Select",FindSelectContent:"Click to see options for finding text in your document.",Title:"Spreadsheet",Ok:"OK",Cancel:"Cancel",Alert:"We couldn't do this for the selected range of cells. Select a single cell within a range of data and then try again.",HeaderAlert:"The command could not be completed as you are attempting to filter with the filter header. Select a single cell in the filter range and try the command again.",FlashFillAlert:"All the data next to your selection was checked and there was no pattern for filling in values.",Formatcells:"Format Cells",FontFamily:"Font",FFContent:"Pick a new font for your text.",FontSize:"Font Size",FSContent:"Change the size of your text.",IncreaseFontSize:"Increase Font Size",IFSContent:"Make your text a bit bigger.",DecreaseFontSize:"Decrease Font Size",DFSContent:"Make your text a bit smaller.",Bold:"Bold",Italic:"Italic",Underline:"Underline",Linethrough:"Linethrough",FillColor:"Fill Color",FontColor:"Font Color",TopAlign:"Top Align",TopAlignContent:"Align text to the top.",MiddleAlign:"Middle Align",MiddleAlignContent:"Align text so that it is centered between the top and bottom of the cell.",BottomAlign:"Bottom Align",BottomAlignContent:"Align text to the bottom.",WrapText:"Wrap Text",WrapTextContent:"Wrap extra-long text into multiple lines so you can see all of it.",AlignLeft:"Align Left",AlignLeftContent:"Align your content to the left.",AlignCenter:"Center",AlignCenterContent:"Center your content.",AlignRight:"Align Right",AlignRightContent:"Align your content to the right.",Justify:"Justify",JustifyContent:"Distribute your text evenly between the margins.",Undo:"Undo",Redo:"Redo",IncreaseIndent:"Increase Indent",IncreaseIndentContent:"Move your content farther away from the cell border.",DecreaseIndent:"Decrease Indent",DecreaseIndentContent:"Move your content closer to the cell border.",NumberFormat:"Number Format",NumberFormatContent:"Choose the format for your cells, such as percentage, currency, date or time.",AccountingStyle:"Accounting Style",AccountingStyleContent:"Format as dollar accounting number format.",PercentageStyle:"Percent Style",PercentageStyleContent:"Format as a percent.",CommaStyle:"Comma Style",CommaStyleContent:"Format with a thousands separator.",IncreaseDecimal:"Increase Decimal",IncreaseDecimalContent:"Show more decimal places for a more precise value.",DecreaseDecimal:"Decrease Decimal",DecreaseDecimalContent:"Show fewer decimal places.",AutoSum:"AutoSum",AutoSumTitle:"Sum",AutoSumContent:"Automatically add a quick calculation to your worksheet, such as sum or average.",Fill:"Fill",ExportXL:"Excel",ExportCsv:"CSV",SaveXml:"Save XML",BackgroundColor:"Fill Color",BGContent:"Color the background of the cells to make them stand out.",Color:"Font Color",ColorContent:"Change the color of your text.",Border:"Border",BorderContent:"Apply borders to the currently selected cells.",BottomBorder:"Bottom Border",TopBorder:"Top Border",LeftBorder:"Left Border",RightBorder:"Right Border",OutsideBorder:"Outside Borders",NoBorder:"No Border",AllBorder:"All Borders",ThickBoxBorder:"Thick Box Border",ThickBottomBorder:"Thick Bottom Border",TopandThickBottomBorder:"Top and Thick Bottom Border",DrawBorderGrid:"Draw Border Grid",DrawBorder:"Draw Border",TopandBottomBorder:"Top and Bottom Border",BorderColor:"Line Color",BorderStyle:"Line Style",Number:"Number is used for general display of numbers.",General:"General format cells have no specific number format.",Currency:"Currency format is used for general monetary values.",Accounting:"Accounting format lines up the currency symbols and decimal points.",Text:"Text format cell is displayed exactly as entered.",Percentage:"This Format multiplies the cell value by 100 and displays with percent symbol.",CustomMessage:"Type number format code, using one of existing codes as a starting point.",Fractions:"",Scientific:"",Type:"Type",CustomFormatAlert:"Enter a valid format",Date:"Date formats display date and time serial numbers as date values",File:"FILE",New:"New",Open:"Open",Save:"Save As",Print:"Print",PrintContent:"Print the current sheet.",PrintSheet:"Print Sheet",PrintSelected:"Print Selected",PrintSelectedContent:"Select an area on the sheet you would like to print.",HighlightVal:"Highlight Invalid Data",ClearVal:"Clear Validation",ClearHLVal:"Clear Highlighted Data",Validation:"Validation",DataValidation:"Data Validation",DVContent:"Pick from a list of rules to limit the type of data that can be entered in a cell.",A4:"A4",A3:"A3",Letter:"Letter",PageSize:"Page Size",PageSizeContent:"Choose a page size for your document.",FormatCells:"FormatCells",ConditionalFormat:"Conditional Formatting",CFContent:"Easily spot trends and patterns in your data using colors to visually highlight important values.",And:"and",With:"with",GTTitle:"Greater Than",GTContent:"Format cells that are GREATER THAN:",LTTitle:"Less Than",LTContent:"Format cells that are LESS THAN:",BWTitle:"Between",BWContent:"Format cells that are BETWEEN:",EQTitle:"Equal To",EQContent:"Format cells that are EQUAL TO:",DateTitle:"A Date Occurring",DateContent:"Format cells that contain a DATE:",ContainsTitle:"Text That Contains",ContainsContent:"Format cells that contain the text:",GreaterThan:"Greater Than",LessThan:"Less Than",Between:"Between",EqualTo:"Equal To",TextthatContains:"Text that Contains",DateOccurring:"A Date Occurring",ClearRules:"Clear Rules",ClearRulesfromSelected:"Clear Rules from Selected Cells",ClearRulesfromEntireSheets:"Clear Rules from Entire Sheet",CellStyles:"Cell Styles",CellStylesContent:"A colorful style is a great way to make important data stand out on the sheet.",CellStyleHeaderText:"Good, Bad and Neutral/Titles and Headings/Themed Cell Styles/New Cell Style",Custom:"Custom",CellStyleGBN:"Normal/Bad/Good/Neutral",CellStyleTH:"Heading 4/Title",CellsStyleTCS:"20% - Accent1/20% - Accent2/20% - Accent3/20% - Accent4/60% - Accent1/60% - Accent2/60% - Accent3/60% - Accent4/Accent1/Accent2/Accent3/Accent4",CellStyleNCS:"New Cell Style",Style:"Style",CustomCellStylePropText:"Style Name:/Font Family:/Font Size:/Text Align:/Vertical Align:/Border:/Border Style:/Border Color:/Background Color:/Font Color:/Bold:/Italic:/Strike Through:",FormatAsTable:"Format as Table",FATContent:"Quickly convert a range of cells to a table with its own style.",FATHeaderText:"Light/Medium/Dark",FATNameDlgText:"Table Name/My table has headers",ResizeAlert:"The specified range is invalid. The top of the table must remain in the same row, and the resulting table must overlap the original table. Specify a valid range.",FATResizeTableText:"Enter new data range for your table",FATReizeTableNote:"Note: The headers must remain in the same row, and the resulting table range must overlap the original table range.",FormatAsTableAlert:"Cannot create a table with a single row. A table must have at least two rows, one for the table header, and one for data",FormatAsTableTitle:"Light 1/Light 2/Light 3/Light 4/Light 5/Light 6/Light 7/Light 8/Light 9/Light 10/Light 11/Light 12/Medium 1/Medium 2/Medium 3/Medium 4/Medium 5/Medium 6/Medium 7/Medium 8/Dark 1/Dark 2/Dark 3/Dark 4",NewTableStyle:"New Table Style",ResizeTable:"Resize Table",ResizeTableContent:"Resize this table by adding or removing rows and columns.",ConvertToRange:"Convert to Range",ConvertToRangeContent:"Convert this table into a normal range of cells.",ConverToRangeAlert:"Do you want to convert the table to a normal range?",TableID:"Table ID:",Table:"Table",TableContent:"Create a table to organize and analyze related data.",TableStyleOptions:"First Column/Last Column/Total Row/Filter Button",Format:"Format",CustFATPropText:"Table Name/Header Layout/Content Layout/Content Border",NameManager:"Name Manager",NameManagerContent:"Create, edit, delete and find all the names used in the workbook.<br /><br />Names can be used in formulas as substitutes for cell references.",DefinedNames:"Defined Names",DefineName:"Define Name",DefineNameContent:"Define and apply names.",UseInFormula:"Use In Formula",UseInFormulaContent:"Choose a name used in this workbook and insert it into the current formula.",Refersto:"Refers to",RefersTo:"Refers to",Name:"Name",Scope:"Scope",NMNameAlert:"The name that you entered is not valid./Reason for this can include:/The name does not begin with a letter or an underscore/The name contains a space or other invalid characters/The name conflicts with a spreadsheet built-in name or the name of another object in the workbook",NMUniqueNameAlert:"The name entered already exists. Enter a unique name.",NMRangeAlert:"Enter a valid range",FORMULAS:"FORMULAS",Value:"Values",Formula:"Formulas",MissingParenthesisAlert:"Your formula is missing a parenthesis--) or (. Check the formula, and then add the parenthesis in the appropriate place.",UnsupportedFile:"Unsupported File",IncorrectPassword:"Unable to open the file or worksheet with the given password",InvalidUrl:"Please specify proper URL",Up:"Up",Down:"Down",Sheet:"Sheet",Workbook:"Workbook",Rows:"By Rows",Columns:"By Columns",FindReplace:"Find Replace",FindnReplace:"Find and Replace",Find:"Find",Replace:"Replace",FindLabel:"Find what:",ReplaceLabel:"Replace with:",ReplaceAll:"ReplaceAll",Close:"Close",FindNext:"Find Next",FindPrev:"Find Prev",Settings:"Settings",MatchCase:"Match case",MatchAll:"Match entire cell contents",Within:"Within:",Search:"Search:",Lookin:"Look in:",shiftright:"Shift cells right",shiftbottom:"Shift cells down",entirerow:"Entire row",entirecolumn:"Entire column",shiftup:"Shift cells up",shiftleft:"Shift cells left",Direction:"Direction:",GoTo:"Go To",GoToName:"Go to:",Reference:"Reference:",Special:"Special",Select:"Select",Comments:"Comments",Formulas:"Formulas",Constants:"Constants",RowDiff:"Row differences",ColDiff:"Column differences",LastCell:"Last cell",CFormat:"Conditional formats",Blanks:"Blanks",GotoError:"Error",GotoLogicals:"Logicals",GotoNumbers:"Numbers",GotoText:"Text",FindSelect:"Find & Select",Comment:"Comment",NewComment:"New",InsertComment:"Insert Comment",EditComment:"Edit",DeleteComment:"Delete Comment",DeleteCommentContent:"Delete the selected comment.",HideComment:"Hide Comment",Next:"Next",NextContent:"Jump to the next comment.",Previous:"Previous",PreviousContent:"Jump to the previous comment.",ShowHide:"Show/Hide Comment",ShowHideContent:"Show or hide the comment on the active cell.",ShowAll:"Show All Comments",ShowAllContent:"Display all comments in the sheet.",UserName:"User Name",Hide:"Hide",Unhide:"Unhide",Add:"Add",DropAlert:"Do you want to replace the existing data?",PutCellColor:"Put Selected Cell Color To The Top",PutFontColor:"Put Selected Font Color To The Top",WebPage:"Web Page",WorkSheet:"Worksheet Reference",InsertHyperLink:"Insert Hyperlink",HyperLink:"Hyperlink",EditLink:"Editlink",OpenLink:"Openlink",HyperlinkText:"Text:",RemoveLink:"Removelink",WebAddress:"Web Address:",CellAddress:"Cell Reference:",SheetIndex:"Select a place in this document",ClearAll:"Clear All",ClearFormats:"Clear Formats",ClearContents:"Clear Contents",ClearComments:"Clear Comments",ClearHyperLinks:"Clear Hyperlinks",SortFilter:"Sort & Filter",SortFilterContent:"Organize your data so it's easier to analyze.",NumberStart:"Minimum:",NumberEnd:"Maximum:",DecimalStart:"Minimum",DecimalEnd:"Maximum:",DateStart:"Start Date:",DateEnd:"End Date:",ListStart:"Source:",ListEnd:"Cell Reference:",TimeStart:"Start Time:",TimeEnd:"End Time:",TextLengthStart:"Minimum:",TextLengthEnd:"Maximum:",CommentFindEndAlert:"Spreadsheet reached the end of the workbook. Do you want to continue reviewing from the beginning of the workbook?",InsertSheet:"Insert",DeleteSheet:"Delete",RenameSheet:"Rename",MoveorCopy:"Move or Copy",HideSheet:"Hide",UnhideSheet:"Unhide",SheetRenameAlert:"That name is already taken. Try a different one.",SheetRenameEmptyAlert:"Please enter a valid Sheet Name!",SheetDeleteAlert:"\tYou cannot undo deleting sheet, as you might delete some data. Click OK to delete.",SheetDeleteErrorAlert:"A workbook must contain at least one visible worksheet.",CtrlKeyCopyErrorAlert:"The command you choose cannot be performed with multiple selections. Select a single range and click the command again",MoveToEnd:"Move To End",Beforesheet:"Before sheet:",CreateaCopy:"Create a copy",AutoFillOptions:"Copy Cells/Fill Series/Fill Formatting Only/Fill Without Formatting/Flash Fill",NumberValidationMsg:"Enter only digits",DateValidationMsg:"Enter only date",Required:"Required",TimeValidationMsg:"The time you entered for the Time is invalid.",CellAdrsValidationMsg:"Reference is not valid.",PivotTable:"Pivot Table",PivotTableContent:"Easily arrange and summarize complex data in a PivotTable.",NumberTab:"Number",AlignmentTab:"Alignment",FontTab:"Font",BorderTab:"Border",FillTab:"Fill",textalignment:"Text alignment",horizontal:"Horizontal:",vertical:"Vertical:",indent:"Indent",textcontrol:"Text Control",wraptext:"Wrap text",fontgroup:"Font:",fontstyle:"Font style:",size:"Size:",Size:"Page size",effects:"Effects:",underline:"Underline",strikethrough:"Strikethrough",overline:"Overline",color:"Color:",normalfont:"Normal font",preview:"Preview",previewtext:"AaBbCcYyZz",line:"Line",style:"Style:",presets:"Presets",none:"None",outline:"Outline",border:"Border",allside:"All sides",backgroundcolor:"Background Color:",inscells:"Insert Cells",insrows:"Insert Sheet Rows",inscols:"Insert Sheet Columns",inssheet:"Insert Sheet",delcells:"Delete Cells",delrows:"Delete Sheet Rows",delcols:"Delete Sheet Columns",delsheet:"Delete Sheet",HyperLinkAlert:"The address of this site is not valid. Check the address and try again",ReplaceData:"All done. We made / replacements.",NotFound:"We couldn't find what you were looking for. Select setting tab for more ways to search",Data:"Data:",Allow:"Allow:",IgnoreBlank:"Ignore blank",NotFind:"Unable to find the match to replace",freezePanes:"Freeze Panes",FreezeRow:"Freeze Top Row",FreezeColumn:"Freeze First Column",unfreezePanes:"Unfreeze Panes",DestroyAlert:"Are you sure you want to destroy the current workbook without saving and create a new workbook?",ImageValAlert:"Upload image files only",Pictures:"Pictures",PicturesTitle:"From File",PicturesContent:"Insert pictures from your computer or from other computers that you are connected to.",ImportAlert:"Are you sure you want to destroy the current workbook without saving and import a new workbook?",UnmergeCells:"Unmerge Cells",MergeCells:"Merge Cells",MergeAcross:"Merge Across",MergeAndCenter:"Merge & Center",MergeAndCenterContent:"Combine and center the contents of the selected cells in a new larger cell.",MergeCellsAlert:"Merging Cells keeps only upper left cell value and discards the other values",Axes:"Axes",PHAxis:"Primary Horizontal Axis",PVAxis:"Primary Vertical Axis",AxisTitle:"Axis Title",PHAxisTitle:"Primary Horizontal Axis Title",PVAxisTitle:"Primary Vertical Axis Title",CTNone:"None",CTCenter:"Center",CTFar:"Far",CTNear:"Near",DataLabels:"Data Labels",DLNone:"None",DLCenter:"Center",DLIEnd:"Inside End",DLIBase:"Inside Base",DLOEnd:"Outside End",ErrorBar:"Error Bars",Gridline:"Gridlines",PMajorH:"Primary Major Horizontal Line",PMajorV:"Primary Major Vertical Line",PMinorH:"Primary Minor Horizontal Line",PMinorV:"Primary Minor Vertical Line",Legend:"Legends",LNone:"None",LLeft:"Left",LRight:"Right",LBottom:"Bottom",LTop:"Top",ChartTitleDlgText:"Enter Title",ChartTitle:"Title",CorrectFormat:"Select the correct Format File",ResetPicture:"Reset Picture",ResetPictureContent:"Discard all of the formatting changes made to this picture.",PictureBorder:"Picture Border",PictureBorderContent:"Pick the color, width, and line style for the outline of your shape.",ResetSize:"Reset Picture & Size",Height:"Height",Width:"Width",ThemeColor:"Theme Colors",NoOutline:"No Outline",Weight:"Weight",Dashes:"Dashes",ColumnChart:"2-D Column/3-D Column",ColumnChartTitle:"Insert Column Chart",ColumnChartContent:"Use this chart type to visually compare values across a few categories.",BarChart:"2-D Bar/3-D Bar",BarChartTitle:"Insert Bar Chart",BarChartContent:"Use this chart type to visually compare values across a few categories when the chart shows duration or the category text is long.",StockChart:"Radar Chart",StockChartTitle:"Insert Radar Chart",StockChartContent:"Use this chart type to show values relative to a center point.",LineChart:"2-D Line Marker",LineChartTitle:"Insert Line Chart",LineChartContent:"Use this chart type to show trends over time (years, months, and days) or categories.",AreaChart:"2-D Area/3-D Area",AreaChartTitle:"Insert Area Chart",AreaChartContent:"Use this chart type to show trends over time (years, months, and days) or categories. Use it to highlight the magnitude of change over time.",ComboChart:"Combo",PieChart:"2-D Pie 3-D Pie Doughnut",PieChartTitle:"Insert Pie/Doughnut Chart",PieChartContent:"Use this chart type to show proportions of a whole. Use it when the total of your numbers is 100%.",ScatterChart:"Scatter",ScatterChartTitle:"Insert Scatter (X, Y) Chart",ScatterChartContent:"Use this chart type to show the relationship between sets of values.",ChartRange:"Chart Range",XAxisRange:"Enter X-axis range:",YAxisRange:"Enter Y-axis range:",LegendRange:"Enter legend range:",YAxisMissing:"Enter Y-axis range to create chart",InvalidYAxis:"Y-axis range must be within the selected range",InvalidXAxis:"X-axis range must be within the selected range",InvalidLegend:"Legend range must be within the selected range",InvalidXAxisColumns:"X-axis range should be within a single column",FreezePanes:"Freeze Panes",FreezePanesContent:"Freeze a portion of the sheet to keep it visible while you scroll through the rest of the sheet.",PasteTitle:"Paste (Ctrl+V)",PasteContent:"Add content on the Clipboard to your document.",PasteSplitContent:"Pick a paste option, such as keeping formatting or pasting only content.",CutTitle:"Cut (Ctrl+X)",CutContent:"Remove the selection and put it on the Clipboard so you can paste it somewhere else.",CopyTitle:"Copy (Ctrl+C)",CopyContent:"Put a copy of the selection on the Clipboard so you can paste it somewhere else.",FPTitle:"Format Painter",FPContent:"Like the look of a particular selection? You can apply that look to other content in the document.",BoldTitle:"Bold (Ctrl+B)",BoldContent:"Make your text bold.",ItalicTitle:"Italic (Ctrl+I)",ItalicContent:"Italicize your text.",ULineTitle:"Underline (Ctrl+U)",ULineContent:"Underline your text.",LineTrTitle:"Line Through (Ctrl+L)",LineTrContent:"Cross something out by drawing a line through it.",UndoTitle:"Undo (Ctrl+Z)",UndoContent:"Undo your last action.",RedoTitle:"Redo (Ctrl+Y)",RedoContent:"Redo your last action.",TableTitle:"Table (Ctrl+T)",HyperLinkTitle:"Add a Hyperlink (Ctrl+K)",HyperLinkContent:"Create a link in your document for quick access to webpages and files. <br /><br />Hyperlinks can also take you to places in your document.",NewCommentTitle:"Insert a Comment",NewCommentContent:"Add a note about this part of the document.",AddChartElement:"Add Chart Element",AddChartElementContent:"Add elements to the created chart.",SwitchRowColumn:"Switch Row/Column",SwitchRowColumnContent:"Swap the data over the axis.",MergeAlert:"We can't do that to a merged cell.",UnhideDlgText:"Unhide Sheet:",ChartThemes:"Chart Themes",ChartThemesContent:"Pick a new theme for your chart.",ChangePicture:"Change Picture",ChangePictureContent:"Change to a different picture, preserving the formatting and size of the current picture.",ChangeChartType:"Change Chart Type",SelectData:"Select Data",SelectDataContent:"Change the data range included in the chart.",Sum:"Sum",Average:"Average",CountNumber:"Count Numbers",Max:"Max",Min:"Min",ChartType:"Change Chart Type",ChartTypeContent:"Change to a different chart type.",AllCharts:"AllCharts",defaultfont:"Default",LGeneral:"General",LCurrency:"Currency",LAccounting:"Accounting",LDate:"Date",LTime:"Time",LPercentage:"Percentage",LFraction:"Fraction",LScientific:"Scientific",LText:"Text",LCustom:"Custom",Top:"Top",Center:"Center",Bottom:"Bottom",Left:"Left (Indent)",Right:"Right",Justify:"Justify",GeneralTxt:"General format cells have no specific number format.",NegativeNumbersTxt:"Negative Numbers",ThousandSeparatorTxt:"Use 1000 Separator by (,)",DecimalPlacesTxt:"Decimal Places:",TextTxt:"Text format cells are treated as text even when a number is in the cell. The cell is displayed exactly as entered.",BoldItalic:"Bold Italic",Regular:"Regular",HyperLinkHide:"<<Selection in Document>>",InvalidSheetIndex:"Specify proper SheetIndex",HugeDataAlert:"File too large to open.",TitleColumnChart:"Clustered Column/Stacked Column/100% Stacked Column/3D Clustered Column/3D Stacked Column/ 3D 100% Stacked Column",TitleBarChart:"Clustered Bar/Stacked Bar/100% Stacked Bar/3D Clustered Bar/3D Stacked Bar/3D 100% Stacked Bar",TitleRadarChart:"Radar/Radar with Markers",TitleLineChart:"Line/Line with Markers",TitleAreaChart:"Area/Stacked Area/100% Stacked Area",TitlePieChart:"Pie/3D Pie/Doughnut",TitleScatterChart:"Scatter",BetweenAlert:"The Maximum must be greater or equal to the Minimum.",BorderStyles:"Solid/Dashed/Dotted",FPaneAlert:"Freeze Pane is not applied for the First Cell",ReplaceNotFound:"Spreadsheet cannot find a match."};t.Spreadsheet.scrollMode={Normal:"normal",Infinite:"infinite"};t.Spreadsheet.AutoFillOptions={CopyCells:"copycells",FillSeries:"fillseries",FillFormattingOnly:"fillformattingonly",FillWithoutFormatting:"fillwithoutformatting",FlashFill:"flashfill"};t.Spreadsheet.autoFillDirection={Up:"up",Right:"right",Down:"down",Left:"left"};t.Spreadsheet.pageSize={A4:"A4",A3:"A3",Letter:"Letter"};t.Spreadsheet.Actions={Sorting:"sorting",Selection:"selection",AutoFill:"autofill",CellNavigation:"cellnavigation",Filtering:"filtering"};t.Spreadsheet.exportType={Excel:"Excel",Csv:"Csv"};t.Spreadsheet.CellType={String:"string",Number:"number",Custom:"custom",Formula:"formula",Time:"time",LongDate:"longdate",ShortDate:"shortdate",Scientific:"scientific",Fraction:"fraction",Text:"text",General:"general",Accounting:"accounting",Currency:"currency",Percentage:"percentage",Date:"date",DateTime:"datetime"};t.Spreadsheet.SupportedStyles={FontFamily:"font-family",FontSize:"font-size",FontStyle:"font-style",FontWeight:"font-weight",TextAlign:"text-align",TextDecoration:"text-decoration",TextIndent:"text-indent",VerticalAlign:"vertical-align"};t.Spreadsheet.Validation={">":"GreaterThan",">=":"GreaterOrEqualTo","<":"LessThan","<=":"LessThanOrEqualTo","==":"EqualTo","!=":"NotEqualTo","!":"Not","=":""};t.Spreadsheet.msg=" ";t.Spreadsheet.getMsg=function(){return t.Spreadsheet.msg};t.Spreadsheet.SelectionType={Row:"row",Column:"column",Default:"default"};t.Spreadsheet.SelectionUnit={Single:"single",Range:"range",MultiRange:"multirange"}})(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.selection=function(n){this.XLObj=n;this._isRightClick=!1;this._colhdrClick=!1;this._rowhdrClick=!1;this._aFillDownHandler=!1;this._isOutsideBordering=!1;this._isGridBordering=!1;this._isRowSelected=!1;this._isColSelected=!1;this._isSheetSelected=!1;this._isEndReached=!0};t.spreadsheetFeatures.selection.prototype={_selectionMouseDownHandler:function(i){i.preventDefault();var u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex()),r=i.target;u._on(n(document),"mouseup",this._mouseUpHandler);i.which===3||i.button===2||u.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.Single?this._isRightClick=!0:u._on(u.element,"mousemove",this._mouseMoveHandler);r.tagName=="TD"?(u.XLEdit._isFormulaEdit?(i.ctrlKey&&(this._clearBorder(u._arrayAsString(u._ctrlFormulaBorder)),u._ctrlKeyCount=u._formulaRange.length),u._dStartCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex}):i.shiftKey&&f._startCell.rowIndex!=-1?f._endCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex}:(f._startCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},f._activeCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex}),r.className.indexOf("e-rowheader")>-1&&(this._rowhdrClick=!0)):r.parentNode.tagName=="TH"?(i.shiftKey&&f._startCell.rowIndex!=-1?f._endCell={rowIndex:0,colIndex:r.parentNode.cellIndex}:(f._startCell={rowIndex:0,colIndex:r.parentNode.cellIndex},f._activeCell={rowIndex:0,colIndex:r.parentNode.cellIndex}),r.className.indexOf("e-headercelldiv")>-1&&(this._colhdrClick=!0)):r.className=="e-autofill"&&(this._aFillDownHandler=!0)},_mouseMoveHandler:function(i){var o,e=this,f=e.XLSelection,s=e.getActiveSheetIndex(),u=e.getSheet(s),r=i.target,h,c=e.model.selectionSettings.selectionType,l=t.Spreadsheet.SelectionType;if(r.tagName=="TD"){if(this.XLSelection._isEndReached=!1,e._getContent(s).find("td").removeClass(e._ctrlFormulaBorder[e._ctrlKeyCount%6].join(" ")),e.XLEdit._isFormulaEdit){i.ctrlKey?(e._dEndCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},f._processFormulaRange(e._ctrlFormulaBorder,!0)):(e._dEndCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},f._processFormulaRange(e._ctrlFormulaBorder,!0));return}if(f._aFillDownHandler&&n(r).parents(".e-rowheadercontent").length===0){e.XLDragFill._selectAutoFillRange(r);return}if(u._startCell=u._activeCell,u._endCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},f._processBoundary(),n(r).parents(".e-spreadsheetcontentcontainer").length>0){if(i.ctrlKey&&e.model.selectionSettings.selectionType===t.Spreadsheet.SelectionType.Default&&e.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.MultiRange){e._getContent(e.getActiveSheetIndex()).find("td").removeClass("e-activecell e-focusright e-focusbottom");h=e.swapRange([u._startCell.rowIndex,u._startCell.colIndex,u._endCell.rowIndex,u._endCell.colIndex]);e.getRange(h[0],h[1],h[2],h[3]).addClass("e-ctrlselected");f._focusRange(u._startCell,u._endCell,e._selectionBorder);e.XLDragFill.hideAutoFillElement();return}c===l.Row||f._rowhdrClick?f.selectRows(u._startCell.rowIndex,u._endCell.rowIndex):c===l.Column||f._colhdrClick?f.selectColumns(u._startCell.colIndex,u._endCell.colIndex):f.selectRange(u._startCell,u._endCell,r)}else if(n(r).parents(".e-rowheadercontent").length>0)f._colhdrClick||f._rowhdrClick?c===l.Column?f.selectColumns(0,u.colCount-1):f.selectRows(u._startCell.rowIndex,u._endCell.rowIndex):(o={position:"horizontal",action:"Decrement"},f._scrollCalculation(s,r,o));else return}else if(t.isNullOrUndefined(r.parentNode)||r.parentNode.tagName!="TH")if(r.className.indexOf("e-hhandlespace")>-1||r.className.indexOf("e-hhandle")>-1||r.className.indexOf("e-hup")>-1||r.className.indexOf("e-hdown")>-1)o={position:"vertical",action:"Increment"},f._scrollCalculation(s,r,o);else if(r.className.indexOf("e-vhandlespace")>-1||r.className.indexOf("e-vhandle")>-1||r.className.indexOf("e-vup")>-1||r.className.indexOf("e-vdown")>-1)o={position:"horizontal",action:"Increment"},f._scrollCalculation(s,r,o);else return;else u._endCell={rowIndex:0,colIndex:r.parentNode.cellIndex},u._startCell=u._activeCell,f._processBoundary(),f._colhdrClick||f._rowhdrClick?c===l.Row?f.selectRows(0,u.rowCount-1):f.selectColumns(u._startCell.colIndex,u._endCell.colIndex):(o={position:"vertical",action:"Decrement"},f._scrollCalculation(s,r,o))},_mouseUpHandler:function(i){var v,s,h,o,r=this,u=r.XLSelection,y=r.getActiveSheetIndex(),f=r.getSheet(y),c=f.selectedRange,b=r.getSheetElement(y),e=i.target,l=r.model.selectionSettings.selectionType,a=t.Spreadsheet.SelectionType,w,p;if(r._off(n(document),"mouseup",u._mouseUpHandler)._off(r.element,"mousemove",u._mouseMoveHandler),e.tagName=="TD"||e.tagName=="INPUT"||e.tagName=="DIV"&&u._aFillDownHandler){if(n(e).parents(".e-rowheadercontent").length>0&&(u._isOutsideBordering=u._isGridBordering=!1),r._preventcutcopy=i.ctrlKey?!0:!1,r.XLEdit._isFormulaEdit){r._getContent(r.getActiveSheetIndex()).find("td").removeClass(r._ctrlFormulaBorder.join(" ").replace(/,/g," "));i.ctrlKey?(r._dEndCell={rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex},u._processFormulaRange(r._formulaBorder)):(u._clearBorder(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")),r._ctrlKeyCount=0,r._dEndCell={rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex},u._processFormulaRange(r._formulaBorder),r._formulaRange=[]);r._formulaRange.push(r._getProperAlphaRange(y,r._dStartCell.rowIndex,r._dStartCell.colIndex,r._dEndCell.rowIndex,r._dEndCell.colIndex));return}if(u._aFillDownHandler){if(h=e.tagName=="DIV"?f._endCell:{rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex},o=r.XLDragFill._getAutoFillRange(h),o)"direction"in o?(r._pStartCell=f._startCell,r._pEndCell=f._endCell,r._pFillCell=h,r.inRange(f.selectedRange,h.rowIndex,h.colIndex)?r.clearRangeData(null,null,n(u.getSelectedCells()).not(".e-autofillcell")):r.XLDragFill.autoFill({dataRange:f.selectedRange,fillRange:o.fillRange,fillType:r.model.autoFillSettings.fillType,direction:o.direction}),f._startCell=o.startCell,f._endCell=o.endCell):u._aFillDownHandler=!1;else return;u.selectRange(o.startCell,o.endCell)}else if(u._isOutsideBordering||u._isGridBordering)if(s="1px "+r._borderStyle+" "+r._borderColor,f._endCell=u._isRightClick?f._startCell:{rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex},n(e).parents(".e-spreadsheetcontentcontainer").length>0)u._isGridBordering?r.XLFormat.applyBorder(s):r.XLFormat.applyBorder({top:s,right:s,bottom:s,left:s}),u._cleanUp(),r.XLDragFill.hideAutoFillElement();else return;else if(e.tagName=="INPUT"&&n(e).parents("tr").length>0?f._endCell=u._isRightClick?f._startCell:{rowIndex:n(e).parents("tr")[0].rowIndex,colIndex:n(e).parents("td")[0].cellIndex}:u._isRightClick?f._endCell=f._startCell:(f._startCell=f._activeCell,f._endCell={rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex},u._processBoundary()),n(e).parents(".e-spreadsheetcontentcontainer").length>0){if(i.ctrlKey&&r.model.selectionSettings.selectionType===t.Spreadsheet.SelectionType.Default&&r.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.MultiRange){r._getContent(r.getActiveSheetIndex()).find("td").removeClass("e-activecell e-focustop e-focusleft e-ctrlselected");c=r.swapRange([f._startCell.rowIndex,f._startCell.colIndex,f._endCell.rowIndex,f._endCell.colIndex]);r.getRange(c[0],c[1],c[2],c[3]).addClass("e-selected");r.getCell(f._activeCell.rowIndex,f._activeCell.colIndex).addClass("e-activecell");u._focusRange(f._startCell,f._endCell,r._selectionBorder);r.XLDragFill.hideAutoFillElement();r.getSheet(r.getActiveSheetIndex())._selectedCells.push(u._getSelectedRange(r.getSheet(1)._startCell,r.getSheet(1)._endCell));r.model.showRibbon&&r.model.allowComments&&b.find(".e-selected.e-commentcell").length>0&&r.XLRibbon._enableButtons(["deleteComment"],"ejButton");return}l===a.Row||u._rowhdrClick?u.selectRows(f._startCell.rowIndex,f._endCell.rowIndex):l===a.Column||u._colhdrClick?u.selectColumns(f._startCell.colIndex,f._endCell.colIndex):u.selectRange(f._startCell,f._endCell,e)}else if(n(e).parents(".e-rowheadercontent").length>0)(u._colhdrClick||u._rowhdrClick)&&(l===a.Column?u.selectColumns(0,f.colCount-1):u.selectRows(f._startCell.rowIndex,f._endCell.rowIndex),u._hdrClick=!1),u._isOutsideBordering=u._isGridBordering=!1;else return;e.tagName==="TD"&&r.model.showRibbon&&(w=n("#"+r._id+"_Ribbon_clearfilter").data("ejButton"),r.XLRibbon._changeClrFltrStatus(w,"button",e))}else if(u._aFillDownHandler||t.isNullOrUndefined(e.parentNode)||e.parentNode.tagName!="TH")if(typeof e.className!="object"&&e.className&&e.className.indexOf("e-spreadsheetcolumnheader")>-1)u.selectSheet(),u._isOutsideBordering=u._isGridBordering=!1;else{r.XLRibbon._updateRibbonIcons();return}else f._startCell=f._activeCell,f._endCell=u._isRightClick?f._startCell:{rowIndex:0,colIndex:e.parentNode.cellIndex},u._processBoundary(),(u._colhdrClick||u._rowhdrClick)&&(l===a.Row?u.selectRows(0,f.rowCount-1):u.selectColumns(f._startCell.colIndex,f._endCell.colIndex)),u._isOutsideBordering=u._isGridBordering=!1;r.model.allowCellFormatting&&r.XLFormat._formatEnable&&r.XLFormat._fPMouseUp(i);r.model.showRibbon&&(r.XLEdit._isEdit?r.XLRibbon._disableRibbonIcons():r.XLRibbon._updateRibbonIcons());r.XLDragFill.positionAutoFillElement(u._aFillDownHandler);u._isRightClick=u._aFillDownHandler=!1;u._colhdrClick=u._rowhdrClick=!1;r.setSheetFocus();r.model.showRibbon&&(v=n("#"+r._id+"_Ribbon_merge").data("ejSplitButton"),this._getContent(r.getActiveSheetIndex()).find(".e-selected").is('[class*="e-table"]')?v.option("enabled",!1):v.option("enabled",!0));this.model.allowEditing&&this.XLEdit._isEdit&&(p=this.getSheet(this.getActiveSheetIndex())._startCell,this.getCell(p.rowIndex,p.colIndex).find(".e-ss-input").focus())},_processBoundary:function(){var h,e,u,f,c,r,o=[],l="e-rc-",i=this.XLObj,y=i._rcRegx,s=i.getSheet(i.getActiveSheetIndex()),a=s._startCell,v=s._endCell,t=i.swapRange([a.rowIndex,a.colIndex,v.rowIndex,v.colIndex]);for(s._startCell={rowIndex:t[0],colIndex:t[1]},s._endCell={rowIndex:t[2],colIndex:t[3]},f=n.makeArray(i.getRange(t[0],t[1],t[0],t[3])),f=f.concat(n.makeArray(i.getRange(t[0],t[3],t[2],t[3]))),f=f.concat(n.makeArray(i.getRange(t[2],t[1],t[2],t[3]))),f=f.concat(n.makeArray(i.getRange(t[0],t[1],t[2],t[1]))),h=f.length;h--;)if(u=f[h],c=u.className,r=(u.parentNode.rowIndex+":"+u.cellIndex).toString(),e=(i.hasSpan(u.rowSpan)||i.hasSpan(u.colSpan))&&o.indexOf(r)===-1&&(o.push(r),this._updateRange(u,t)),c.indexOf(l)>-1&&(r=c.match(y)[0].split(" ")[0].replace(l,""),o.indexOf(r)===-1&&(o.push(r),r=r.split(":"),u=i.getCell(Number(r[0]),Number(r[1]))[0],e=this._updateRange(u,t))),e)break;e&&this._processBoundary()},_updateRange:function(n,t){var f=this.XLObj,e=f.getSheet(f.getActiveSheetIndex()),i=t.slice(0),r=n.parentNode.rowIndex,u=n.cellIndex,o=r+(n.rowSpan-1),s=u+(n.colSpan-1);return r<t[0]&&(t[0]=r),u<t[1]&&(t[1]=u),o>t[2]&&(t[2]=o),s>t[3]&&(t[3]=s),t[0]!=i[0]||t[1]!=i[1]||t[2]!=i[2]||t[3]!=i[3]?(e._startCell={rowIndex:t[0],colIndex:t[1]},e._endCell={rowIndex:t[2],colIndex:t[3]},!0):void 0},_getSpanIndex:function(n){var t,i,r="e-rc-";if(n.indexOf(r)>-1)return i=this.XLObj._rcRegx,t=n.match(i)[0].split(" ")[0].replace(r,"").split(":"),{rowIndex:Number(t[0]),colIndex:Number(t[1])}},selectRange:function(n,i,r){var u=this.XLObj;if(u.model.allowSelection){var o,s,c,f,e=u.getSheet(u.getActiveSheetIndex()),h,a=u._rcRegx,l="e-rc-";(f=e.selectedRange,u.importSheet||(h={prevRange:f,prevCells:u.getRange(f[0],f[1],f[2],f[3]),rangeData:u.getRangeData([n.rowIndex,n.colIndex,i.rowIndex,i.colIndex]),cells:u.getRange(n.rowIndex,n.colIndex,i.rowIndex,i.colIndex)},r&&(h.target=r),!u._trigger("beforeCellSelect",h)))&&(u._dStartCell=n,u._dEndCell=i,f=e.selectedRange=u.swapRange([n.rowIndex,n.colIndex,i.rowIndex,i.colIndex]),this._cleanUp(!1),c=u.getRange(f[0],f[1],f[2],f[3]),c.addClass("e-selected"),s=u.getCell(e._activeCell.rowIndex,e._activeCell.colIndex),s[0].className.indexOf(l)>-1&&(o=s[0].className.match(a)[0].split(" ")[0].replace(l,"").split(":"),s=u.getCell(Number(o[0]),Number(o[1])),e._activeCell={rowIndex:Number(o[0]),colIndex:Number(o[1])}),s.addClass("e-activecell"),this._focusRange(n,i,u._selectionBorder),this._highlightHeader(f),u.model.allowDragAndDrop&&t.spreadsheetFeatures.dragAndDrop&&u.XLDragDrap._initDragAndDropRange([n.rowIndex,n.colIndex,i.rowIndex,i.colIndex]),e._selectedCells=this._getSelectedRange(n,i),h={rangeData:u.getRangeData([n.rowIndex,n.colIndex,i.rowIndex,i.colIndex]),selectedCells:u.getRange(f[0],f[1],f[2],f[3]),target:r},u.model.enableContextMenu&&u.XLRibbon._dirtySelect(c),this._isRowSelected=this._isColSelected=this._isSheetSelected=!1,u._trigger("cellSelected",h))}},selectRow:function(n){var i=this.XLObj,t;i.model.allowSelection&&(t=i.getSheet(i.getActiveSheetIndex()),t._startCell={rowIndex:n,colIndex:0},t._endCell={rowIndex:n,colIndex:t.colCount-1},this.selectRange(t._startCell,t._endCell),this._selectRow(n,"e-rowselected"),this._isRowSelected=!0)},selectRows:function(n,t){var r=this.XLObj,i;r.model.allowSelection&&(i=r.getSheet(r.getActiveSheetIndex()),i._startCell={rowIndex:n,colIndex:0},i._endCell={rowIndex:t,colIndex:i.colCount-1},this.selectRange(i._startCell,i._endCell),this._markHeaderSelection([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],"row"),this._isRowSelected=!0)},selectColumn:function(n){var i=this.XLObj,t;i.model.allowSelection&&(t=i.getSheet(i.getActiveSheetIndex()),t._startCell={rowIndex:0,colIndex:n},t._endCell={rowIndex:t.rowCount-1,colIndex:n},this.selectRange(t._startCell,t._endCell),this._selectColumn(n,"e-colselected"),this._isColSelected=!0)},selectColumns:function(n,t){var r=this.XLObj,i;r.model.allowSelection&&(i=r.getSheet(r.getActiveSheetIndex()),i._startCell={rowIndex:0,colIndex:n},i._endCell={rowIndex:i.rowCount-1,colIndex:t},this.selectRange(i._startCell,i._endCell),this._markHeaderSelection([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],"column"),this._isColSelected=!0)},selectSheet:function(){var t=this.XLObj,n;t.model.allowSelection&&(n=t.getSheet(t.getActiveSheetIndex()),n._activeCell={rowIndex:0,colIndex:0},n._startCell={rowIndex:0,colIndex:0},n._endCell={rowIndex:n.rowCount-1,colIndex:n.colCount-1},this.selectRange(n._startCell,n._endCell),t.element.find(".e-spreadsheetcolumnheader").addClass("e-sheetselected"),t.XLDragFill.hideAutoFillElement(),this._isSheetSelected=!0)},refreshSelection:function(){var t=this.XLObj,n=t.getSheet(t.getActiveSheetIndex()).selectedRange,i=n[0],r=n[1],u=n[2],f=n[3];this._isRowSelected?this.selectRows(i,u):this._isColSelected?this.selectColumns(r,f):this._isSheetSelected?this.selectSheet():this.selectRange({rowIndex:i,colIndex:r},{rowIndex:u,colIndex:f})},getSelectedCells:function(n){return this.XLObj._getContent(this.XLObj._getSheetIndex(n))[0].querySelectorAll("td.e-selected")},_select:function(n,t){var i=this.XLObj.getCell(n.rowIndex,n.colIndex);i&&i.addClass(t)},_selectRow:function(n,t){var i=this.XLObj._getJSSheetRowHeaderContent(this.XLObj.getActiveSheetIndex()).find("td:eq("+n+")");i&&i.addClass(t)},_selectRows:function(n,t,i){var r=this.XLObj._getJSSheetRowHeaderContent(this.XLObj.getActiveSheetIndex()).find("td");r=t!==n?r.slice(n,t+1):r.eq(t);r&&r.addClass(i)},_selectColumn:function(n,t){var i=this.XLObj._getJSSheetHeader(this.XLObj.getActiveSheetIndex()).find("th:eq("+n+")");i&&i.addClass(t)},_selectColumns:function(n,t,i){var r=this.XLObj._getJSSheetHeader(this.XLObj.getActiveSheetIndex()).find("th");r=t!==n?r.slice(n,t+1):r.eq(t);r&&r.addClass(i)},_focusBorder:function(n,t,i){var r=this.XLObj,e=r.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]),u=e[0],f=e[1],o=e[2],s=e[3];u-1>=0&&r.getRange(u-1,f,u-1,s).addClass(i[1]);r.getRange(u,s,o,s).addClass(i[0]);r.getRange(o,f,o,s).addClass(i[1]);f-1>=0&&r.getRange(u,f-1,o,f-1).addClass(i[0])},_focusRange:function(n,t,i){var r=this.XLObj;r.getFocusTopElem().removeClass().addClass("e-focustop "+i[0]);r.getFocusRightElem().removeClass().addClass("e-focusright "+i[1]);r.getFocusBottomElem().removeClass().addClass("e-focusbottom "+i[2]);r.getFocusLeftElem().removeClass().addClass("e-focusleft "+i[3]);this._refreshBorder(r.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]))},_refreshBorder:function(n){n=n?n:this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).selectedRange;var u,f,i="e-hide",r=this.XLObj,s=n[0],h=n[1],t=this._focusInfo(n),e=r.getFocusTopElem().removeClass(i),c=r.getFocusRightElem().removeClass(i),l=r.getFocusBottomElem().removeClass(i),o=r.getFocusLeftElem().removeClass(i),a=t.topLeft.top,v=t.topLeft.left,y=t.topRight.left+t.topRight.width-t.topLeft.left,p=t.topRight.top,w=t.topRight.left+t.topRight.width,b=t.bottomRight.top+t.bottomRight.height-t.topRight.top,k=t.bottomLeft.top+t.bottomLeft.height,d=t.topLeft.left,g=t.bottomRight.left+t.bottomRight.width-t.bottomLeft.left,nt=t.topLeft.top,tt=t.topLeft.left,it=t.bottomLeft.top+t.bottomLeft.height-t.topLeft.top;r.model.selectionSettings.enableAnimation?(u=r.model.selectionSettings.animationType,f=r.model.selectionSettings.animationTime,s?e.animate({top:a.toString(),left:v.toString(),width:y.toString()},f,u):e.addClass(i),c.animate({top:p.toString(),left:w.toString(),height:b.toString()},f,u),l.animate({top:k.toString(),left:d.toString(),width:g.toString()},f,u),h?o.removeClass(i).animate({top:nt.toString(),left:tt.toString(),height:it.toString()},f,u):o.addClass(i)):(s?e.css({top:a,left:v,width:y}):e.addClass(i),c.css({top:p,left:w,height:b}),l.css({top:k,left:d,width:g}),h?o.css({top:nt,left:tt,height:it}):o.addClass(i))},_focusInfo:function(n){var u="e-rc-",i={},r=this.XLObj,t=r.getCell(n[0],n[1])[0];return i.topLeft=this._getCellProp(t),t=r.getCell(n[0],n[3])[0],i.topRight=t.className.indexOf(u)===-1?this._getCellProp(t):this._getCellProp(this._getMergedCell(t.className)),t=r.getCell(n[2],n[1])[0],i.bottomLeft=t.className.indexOf(u)===-1?this._getCellProp(t):this._getCellProp(this._getMergedCell(t.className)),t=r.getCell(n[2],n[3])[0],i.bottomRight=t.className.indexOf(u)===-1?this._getCellProp(t):this._getCellProp(this._getMergedCell(t.className)),i},_getMergedCell:function(n){var t=this.XLObj,i=n.match(t._rcRegx)[0].split(" ")[0].replace("e-rc-","").split(":");return t.getCell(Number(i[0]),Number(i[1]))[0]},_getCellProp:function(n){return{top:n.offsetTop-1,left:n.offsetLeft-1,height:n.offsetHeight,width:n.offsetWidth}},_highlightHeader:function(n){this._selectRows(n[0],n[2],"e-rowhighlight");this._selectColumns(n[1],n[3],"e-colhighlight")},_markHeaderSelection:function(n,t){var r=this.XLObj,i;if(n=r.swapRange(n),i=n[0],t==="row")while(i<=n[2])this._selectRow(i,"e-rowselected"),i++;else for(i=n[1];i<=n[3];)this._selectColumn(i,"e-colselected"),i++},_getSelectedRange:function(n,t){for(var r,u=[],f=this.XLObj,i=f.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]);i[0]<=i[2];){for(r=i[1];r<=i[3];)u.push({rowIndex:i[0],colIndex:r}),r=r+1;i[0]=i[0]+1}return u},_processFormulaRange:function(n){var u,t=this.XLObj,f=t.getActiveSheetIndex(),i=t._dStartCell,r=t._dEndCell,e=t._getContent(f).find(".e-editedcell");this._focusBorder(i,r,n[t._ctrlKeyCount%6]);t.XLDragFill.hideAutoFillElement();u=t._getAlphaRange(f,i.rowIndex,i.colIndex,r.rowIndex,r.colIndex);t.XLEdit._updateFormulaCellRange(u);t.XLEdit._isCellEdit?t.XLEdit._focusElements(e):t._getInputBox().focus()},_scrollCalculation:function(n,t,i){var e,r=this.XLObj,u=r.getSheet(r.getActiveSheetIndex()),f;r.XLSelection._isEndReached=!0;e=setInterval(function(){var h,o=r._getContent(n).find("#hscrollBar").data("ejScrollBar"),s=r._getContent(n).find("#vscrollBar").data("ejScrollBar");if(!r.XLSelection._isEndReached){clearInterval(e);return}if(i.position==="horizontal")i.action=="Increment"?(h=Math.ceil(parseFloat(o.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(o.element.find(".e-hhandle").width()))>=o.element.find(".e-hhandlespace").width()-1,h?r.XLScroll._scrollX(n):o.scroll(o.value()+r.model.columnWidth,!0),r.XLShape._shapeROStart||r.XLShape._shapeRSStart||(u._endCell.colIndex=u.colCount-1)):(f=o.value()-r.model.columnWidth,f<0&&(f=0),o.value()>=0&&o.scroll(f,!0),r.XLSelection._aFillDownHandler&&(u._endCell.colIndex=u._leftCol.idx));else if(i.position==="vertical")if(i.action=="Increment")h=Math.ceil(parseFloat(s.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(s.element.find(".e-vhandle").height()))>=s.element.find(".e-vhandlespace").height()-1,h?r.XLScroll._scrollY(n):s.scroll(s.value()+r.model.rowHeight,!0),r.XLShape._shapeROStart||r.XLShape._shapeRSStart||(u._endCell.rowIndex=u.rowCount-1);else if(f=s.value()-r.model.rowHeight,f<0&&(f=0),s.value()>0&&s.scroll(f,!0),!r.XLShape._shapeROStart&&!r.XLShape._shapeRSStart){if(u._topRow.idx<1)return;u._startCell=u._activeCell;u._endCell.rowIndex=u._topRow.idx-1;u._endCell.colIndex=t.parentNode.cellIndex}r.XLShape._shapeROStart||r.XLShape._shapeRSStart||(r.XLSelection._aFillDownHandler?r.XLDragFill._selectAutoFillRange(null,u._endCell):r.XLSelection.selectRange(u._startCell,u._endCell),r.XLDragFill.positionAutoFillElement(r.XLSelection._aFillDownHandler))},200);t.addEventListener("mouseup",function(){clearInterval(e)});document.addEventListener("mouseup",function(){clearInterval(e)})},_cleanUp:function(n){var r,i="e-hide",t=this.XLObj,f=t.getActiveSheetIndex(),u;for(t.XLDragFill._autoFillCleanUp(),r=t.getSheetElement(f)[0].querySelectorAll(".e-selected,.e-rowselected,.e-colselected,.e-rowhighlight,.e-colhighlight,.e-sheetselected,.e-activecell"),u=r.length;u--;)t._removeClass(r[u],"e-activecell|e-selected|e-rowhighlight|e-colhighlight|e-rowselected|e-colselected|e-ddcell|e-sheetselected");n&&(t.addClass(t.getFocusTopElem()[0],i),t.addClass(t.getFocusRightElem()[0],i),t.addClass(t.getFocusBottomElem()[0],i),t.addClass(t.getFocusLeftElem()[0],i));t.getSheet(f)._selectedCells=[]},_clearBorder:function(n){var t=this.XLObj;t._getContent(t.getActiveSheetIndex()).find("td").removeClass(n)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.filter=function(n){this.XLObj=n;this._isSearchEdit=!1;this._isDecimal=!1};t.spreadsheetFeatures.filter.prototype={_renderExcelFilter:function(){var n=this.XLObj,i={instance:n,showSortOptions:!0,maxFilterLimit:n.model.sheets[n.getActiveSheetIndex()].filterSettings.maxFilterChoices,filterHandler:t.proxy(this._filterHandler,this),cancelHandler:t.proxy(this._cancelHandler,this),customFilterHandler:t.proxy(this._customFilterHandler,this)};n._excelFilter=new t.excelFilter(i)},_customFilterHandler:function(){var t=this.XLObj;this._isDecimal&&(n("#"+t._id+"number_CustomValue1").ejNumericTextbox("option",{decimalPlaces:2}),n("#"+t._id+"number_CustomValue2").ejNumericTextbox("option",{decimalPlaces:2}))},_renderFilterDialogs:function(){var n=this.XLObj;n._excelFilter.renderDialog("string");n._excelFilter.renderDialog("number");n._excelFilter.renderDialog("date");n.element.find(".e-excelfilter.e-dlgcontainer").hide()},_createSelection:function(t,i,r,u,f){for(var o=this.XLObj,s=o.getRows(t)[1],h,c=0,e=r,l=s.length;e<l;e++){if(h=o.getCell(e,u),!n(s[e]).hasClass("e-hide")&&h.text().length===0&&e>r)return{endRowIndex:e,filteredIndex:f};c=e+1;f.push(e)}return{endRowIndex:c,filteredIndex:f}},_getSelectedRangeData:function(n,i,r,u){var f=this.XLObj,e=f.getActiveSheetIndex(),tt=f.model.sheets[e]._multipleFiltering,w=[],v,it=0,o,s,b=f._formatRegx,k=[],d,y,a,g,h;r===-1&&(f.model.sheets[e].filterSettings.range=f._generateHeaderText(e,n.colIndex+1)+n.rowIndex+":"+f._generateHeaderText(e,i.colIndex+1)+(i.rowIndex+1));tt&&(i.colIndex=f.model.sheets[e]._multifilterIdx[f.model.sheets[e]._multifilterIdx.length-1],it=f.model.sheets[e]._multifilterIdx);var c,nt=[],l=f._dataContainer,p=l.sheets[e];for(o=n.rowIndex;o<=i.rowIndex;o++){for(c={},s=n.colIndex;s<=i.colIndex;s++)a=f.getCell(o,u),v=f._generateHeaderText(e,s+1),a.parent()[0].className.indexOf("e-fr-hide")<0&&(t.isNullOrUndefined(a[0].className.match(b))||(d=a[0].className.match(b)[0],y=f._getColorFromFormat(d),g={id:s,background:y[0],foreground:y[1]},k.push(g)),o in p&&s in p[o]?(h=p[o][s],c[v]=t.isNullOrUndefined(l.sharedData[h.value])?"":f._isDateTime(l.sharedData[h.value])||f.isFormula(l.sharedData[h.value])?h.value2:l.sharedData[h.value]):c[v]="");f.getObjectLength(c)>0&&(nt.push(c),w.push(o))}f.model.sheets[e]._selectedCellColors=k;f.model.sheets[e]._selectedRange={startRow:n.rowIndex,endRow:i.rowIndex,dataSourceIndexes:w};f.model.sheets[e].filterSettings.filteredRange=nt},_getColumnType:function(t,i,r,u){for(var o="string",f,e=i;e<r;e++)if(f=this.XLObj.XLEdit.getPropertyValue(e,u,"value",t),n.isNumeric(f))this._isDecimal||(this._isDecimal=f%1!=0),o="number";else return"string";return o},_getColumnByField:function(n,t){for(var r=this.XLObj,i=0;i<r.model.sheets[n].columns.length;i++)if(r.model.sheets[n].columns[i].field===t)break;return i===r.model.sheets[n].columns.length?null:r.model.sheets[n].columns[i]},_findRowIndexByKey:function(n,t,i,r,u){for(var f=0,e=n.length;f<e;f++)n[f][t]===i&&u.push(r.dataSourceIndexes[f]);return u},_checkEmptyText:function(t){for(var i=this.XLObj,u=i.model.sheets[t]._selectedCells,f=!1,e=n("#"+i._id+"_alertdlg"),r=0,o=u.length;r<o;r++)if(i.getCell(u[r].rowIndex,u[r].colIndex).text().length>0)return f=!0,!0;if(!f)return i._renderAlertDlgContent(e,"Alert",i._getLocStr("Alert"),"",620),e.ejDialog("open"),!1},_getFilterIcon:function(){var n=t.buildTag("span .e-icon","",{});return n.addClass("e-spanfilter e-filterspan e-ssfilter"),n},filterByActiveCell:function(){var t=this.XLObj,r=t.getActiveSheetIndex(),i;if(t.model.allowFiltering){var u=t.model.sheets[r]._activeCell,f=t.getCell(u.rowIndex,u.colIndex),e=t.model.sheets[r]._selectedCells;this._checkEmptyText(r)&&(f.find("span").is(".e-ssfiltered, .e-ssfilter, .e-ssfilter-asc, .e-ssfiltered-asc, .e-ssfilter-dsc, .e-ssfiltered-dsc")?(t._renderAlertDlgContent(n("#"+t._id+"_alertdlg"),"Alert",t._getLocStr("HeaderAlert"),440),n("#"+t._id+"_alertdlg").ejDialog("open")):(i=t.XLEdit.getPropertyValueByElem(f,"value"),i=t._isDateTime(i)?t.XLEdit.getPropertyValueByElem(f,"value2"):i,this._filterActiveCell(r,u,e,i)))}},_filterActiveCell:function(n,t,i,r){var u=this.XLObj;u.model.sheets[n]._activeCell=t;u.model.sheets[n]._selectedCells=i;this._filterByValue(n,null,u.model.sheets[n].columns[t.colIndex].field,"or","equal",r)},_filterByValue:function(i,r,u,f,e,o){var s=this.XLObj,a,c,l,p,k,d,w,b=-1,h,g,v,y,nt=s.XLEdit.getColumnIndexByField(u),tt=s.getRows(i)[1];if(t.isNullOrUndefined(r)?a=s.model.sheets[i]._selectedCells:(c=s.getRangeIndices(r),a=s.XLSelection._getSelectedRange({rowIndex:c[0],colIndex:c[1]},{rowIndex:c[2],colIndex:c[3]})),l=a[0],!t.isNullOrUndefined(r)&&s.getCell(l.rowIndex,l.colIndex).text()!==o)for(h=c[0];h<c[2];h++)if(n(tt[h].cells[nt]).text()===o){l={rowIndex:h,colIndex:nt};break}for(y={currentFilteringColumn:u,action:"filter",predicated:f,requestType:"filterbycell",reqType:"filter",filteredValue:o,selCells:n.extend(!0,[],a),activeCell:l},v=this._applyFilterByValue(i,l,a,o),s._excelFilter._predicates[i]={},p={field:u,value:o,predicate:f,operator:e,matchcase:!1},{}.currentFilterCollection=o,s._excelFilter._predicates[i][u]=t.Predicate(u,e,o),s.model.sheets[i].filterSettings.filteredColumns.push(p),k=t.DataManager(s.model.sheets[i].filterSettings.filteredColumns),d=(new t.Query).where("field",t.FilterOperators.equal,u),w=k.executeLocal(d),h=0,g=w.length;h<g;h++)b=n.inArray(w[h],s.model.sheets[i].filterSettings.filteredColumns),b>-1&&s.model.sheets[i].filterSettings.filteredColumns.splice(b,1);s.model.sheets[i].filterSettings.filteredColumns.push(p);y.filteredcolumns=v.filteredColumns=s.model.sheets[i].filterSettings.filteredColumns;v.predicate=s._excelFilter._predicates[i];y.tableID=v.tableID;s.XLSelection._refreshBorder();s._processBindings(y)&&(s.model.sheets[i].filterSettings.filteredColumns=temp)},_applyFilterByValue:function(n,i,r){var f=this.XLObj,v=[],l,s,y,b,p,a,w=f.getCell(i.rowIndex,i.colIndex)[0].className,e=f.model.sheets[n].filterSettings.tableRange,o,h,k=!1,d,c,u;for(a=w.indexOf("e-table")>-1?parseInt(w.substr(w.indexOf("e-table")+7,w.indexOf("")+1)):-1,u=0,c=e.length;u<c;u++)if(e[u].tableID===a){h=u;break}if(!t.isNullOrUndefined(h)&&e[h].tableID===a&&e[h].selectedCellIndexes.indexOf(i.colIndex)!==-1&&e[u].startRow<=i.rowIndex&&e[u].endRow>=i.rowIndex)o=e[h],f.model.sheets[n].filterSettings.filteredRange=e[h].filteredRange,f.model.sheets[n]._selectedRange=e[h].selectedRange;else{for(f.model.sheets[n]._multipleFiltering=!1,f.model.sheets[n]._multifilterIdx=[],this.clearFilter("remove"),p=f._getContent(n).find(".e-ssfilter, .e-ssfiltered, .e-ssfilter-asc, .e-ssfiltered-asc, .e-ssfilter-dsc, .e-ssfiltered-dsc"),u=0,c=p.length;u<c;u++)p[u].className.indexOf("e-ft")===-1&&p[u].remove();if(f._getContent(n).find(".e-filterhdr").removeClass("e-filterhdr"),r.length<2||r[0].rowIndex===r[r.length-1].rowIndex){for(s=-1,y=r[r.length-1].rowIndex,u=r[0].rowIndex;u>=0;u--)if(f.getCell(u,r[0].colIndex).text().length<1){s=u;break}s=s===-1?1:s+1;y=this._createSelection(n,s,y,r[0].colIndex,[]).endRowIndex-1;l={rowIndex:y,colIndex:i.colIndex};this._getSelectedRangeData({rowIndex:s,colIndex:i.colIndex},l,-1,i.colIndex)}else s=i.rowIndex===0?1:i.rowIndex+1,l=r[r.length-1],this._getSelectedRangeData({rowIndex:s,colIndex:i.colIndex},l,-1,i.colIndex);for(u=r[0].colIndex,c=r[r.length-1].colIndex;u<=c;u++)v.push(u),b=this._getFilterIcon(),d=f.getCell(s-1,u),this._applyFilterIcon(d,b);for(v.length>1&&(f.model.sheets[n]._multipleFiltering=!0),f.model.sheets[n]._multifilterIdx=v,f.model.sheets[n]._selectedCellIndexes=v,u=0,c=e.length;u<c;u++)if(e[u].tableID===a){h=u;k=!0;break}k?(o=e[h],o.startRow=i.rowIndex,o.endRow=l.rowIndex,o.multiFiltering=f.model.sheets[n]._multipleFiltering,o.multifilterIdx=f.model.sheets[n]._multifilterIdx,o.selectedCellIndexes=f.model.sheets[n]._multifilterIdx,o.selectedRange=f.model.sheets[n]._selectedRange,o.filteredRange=f.model.sheets[n].filterSettings.filteredRange,o.hiddenIdx=[],o.tableID=a):(f.model.sheets[n].filterSettings.tableRange.push({startRow:s,endRow:l.rowIndex,tableID:-1,multiFiltering:f.model.sheets[n]._multipleFiltering,multifilterIdx:f.model.sheets[n]._multifilterIdx,selectedCellIndexes:f.model.sheets[n]._multifilterIdx,selectedRange:f.model.sheets[n]._selectedRange,filteredRange:f.model.sheets[n].filterSettings.filteredRange,hiddenIdx:[]}),o=e[e.length-1])}return o},clearFilter:function(n){for(var i=this.XLObj,r=i.getActiveSheetIndex(),u,f=i._getContent(r).find(".e-ssfiltered, .e-ssfiltered-asc, .e-ssfiltered-dsc"),e=i.model.sheets[r].filterSettings.tableRange,o=-1,t=0,s=f.length;t<s;t++)f.get(t).className.indexOf("e-ft")===-1&&(u=i.model.sheets[r].columns[f.eq(t).parent()[0].cellIndex].field,delete i._excelFilter._predicates[r][u],this._clearFilterColumn(u,"","","Or","","",-1));if(n==="remove"){for(t=0;t<e.length;t++)if(e[t].tableID===-1){o=t;break}o>-1&&e.splice(o,1)}},filter:function(t){var i=this.XLObj,c,u;if(i.model.allowFiltering){var r=i.getActiveSheetIndex(),s=!1,e=i.model.sheets[r]._activeCell,f=i._getContent(r).find(".e-ssfilter, .e-ssfiltered, .e-ssfilter-asc, .e-ssfilter-dsc, .e-ssfiltered-asc, .e-ssfiltered-dsc"),o,h;if(i.model.sheets[r]._multipleFiltering=!1,i.model.sheets[r]._multifilterIdx=[],f.length>0&&!(i.getCell(e.rowIndex,e.colIndex,r)[0].className.indexOf("e-table")>-1))for(u=0,c=f.length;u<c;u++)f[u].className.indexOf("e-ft")===-1&&(this.clearFilter("remove"),i.model.sheets[r].filterSettings.filteredRange=[],i.model.sheets[r]._selectedRange={},i.model.sheets[r]._selectedCellIndexes=[],i.model.sheets[r].filterSettings.filteredColumns=[],i._excelFilter._predicates[r]={},n.isNumeric(n(f[u]).parent().text())&&n(f[u]).parent().addClass(i._rAlign),n(f[u]).remove(),f.parent().removeClass("e-filterhdr"),s=!0);if(i.getCell(e.rowIndex,e.colIndex,r)[0].className.indexOf("e-table")>-1){for(o=i._getTableID(i.getCell(e.rowIndex,e.colIndex,r)[0].className),h=i.model.sheets[r].filterSettings.tableRange[o].multifilterIdx.length,u=0;u<h;u++)i.getCell(i.model.sheets[r].filterSettings.tableRange[o].startRow,i.model.sheets[r].filterSettings.tableRange[o].multifilterIdx[u],r)[0].className.indexOf("e-ssfiltered")>-1&&this._clearFilterColumn(i.model.sheets[r].columns[u].field,"","","","","",o);this._clearFilterTableIcon(r,o);s=!0}s||this._filterCellRange(r,t)}},_applyFilterIcon:function(n,t){var o=this.XLObj._rAlign,i=this.XLObj,u=i.getActiveSheetIndex(),f=n.index(),e=i._getContent(u).find("col:eq("+f+")"),r;i.isNumber(n.text())&&i._removeClass(n[0],o);n[0].insertBefore(t[0],n[0].childNodes[n[0].childNodes.length-1]);r=i.XLResize._getContentWidth(f,u,n.parent());e.width()<r+19&&(e.width(r+19),i._getJSSheetHeader(u).find("col:eq("+f+")").width(r+19),i.getSheet(u).columnsWidthCollection[f]=r+19);n.addClass("e-filterhdr")},_filterCellRange:function(i,r){var u=this.XLObj,s,a=!1,ot,st,it,ht=0,v,rt,o,f,d,w,ct,g,lt,c,y,e,h,b=[],k=-1,p=0,nt=0,at=!1,vt=!1,l,ut=[],tt,ft=!1,yt={sheetIndex:i,reqType:"filter",operation:"apply-filter"},wt=u.model.sheets[i]._multifilterIdx,bt=u.getRows(i)[1],pt=[],et;for(t.isNullOrUndefined(r)?s=u.model.sheets[i]._selectedCells:(g=u.getRangeIndices(r),s=u.XLSelection._getSelectedRange({rowIndex:g[0],colIndex:g[1]},{rowIndex:g[2],colIndex:g[3]})),o=s[0].colIndex,w=s[s.length-1].colIndex;o<=w;o++){if(b.push(o),v=this._getFilterIcon(),l=s[0].rowIndex,s.length<2){if(wt.push(o),e=u.getCell(l,o),e.text().length<1){for(f=l;f>=0;f--)if(e=u.getCell(f,o),e.is(":visible")&&e.text().length>0){vt=!0;break}if(!vt)for(f=l;f<l+2;f++)if(e=u.getCell(f,o),e.is(":visible")&&e.text().length>0){this._applyFilterIcon(e,v);a=!0;p=nt=f;break}if(!a){for(rt=!1,f=l;f>l-2;f--)f>-1&&(e=u.getCell(f,o),e.text().length===0&&f>0&&(e=u.getCell(f-1,o),e.text().length==0&&(rt=!0)));if(!rt)for(f=l-2;f>=0;f--)if(e=u.getCell(f,o),e.is(":visible")&&(e.text().length===0||f===0)){d=f===0?f:f+1;e=u.getCell(d,o);this._applyFilterIcon(e,v);a=!0;p=nt=d;break}}}else{for(f=l;f>=0;f--)if(e=u.getCell(f,o),e.is(":visible")&&e.text().length===0){d=f+1;e=u.getCell(f+1,o);this._applyFilterIcon(e,v);a=!0;p=nt=d;break}a||(e=u.getCell(0,o),this._applyFilterIcon(e,v),a=!0,p=nt=0)}a||(u._renderAlertDlgContent(n("#"+u._id+"_alertdlg"),"Alert",u._getLocStr("Alert")),n("#"+u._id+"_alertdlg").ejDialog("open"))}else{if(!at||b.length>0)for(f=l,ct=s[s.length-1].rowIndex;f<=ct;f++)e=u.getCell(f,o),e.text().length>0&&((k===-1||k>f)&&(k=f),at=!0,a=!0,ft=!0),k<f&&ht===0&&pt.push(f);ft&&(ut.push(o),u.model.sheets[i]._multifilterIdx.push(o),ft=!1)}ht++}if(b.length>1&&(u.model.sheets[i]._multipleFiltering=!0),tt=[],a){if(s.length>1){for(o=0,w=ut.length;o<w;o++)v=this._getFilterIcon(),e=u.getCell(k,ut[o]),this._applyFilterIcon(e,v),tt.push(e);c={rowIndex:k+1,colIndex:s[0].colIndex};y={rowIndex:s[s.length-1].rowIndex};u.model.sheets[i]._selectedRange={startRow:c.rowIndex,endRow:y.rowIndex,dataSourceIndexes:pt};this._getSelectedRangeData(c,s[s.length-1],-1,c.colIndex);u.model.sheets[i]._selectedCellIndexes=b}else s.length===1&&(e=u.getCell(p,b[0]),tt.push(e)),et=this._createSelection(i,p+1,nt,b[0],[]),lt=et.endRowIndex-1,c={rowIndex:p+1,colIndex:s[0].colIndex},y={rowIndex:lt,colIndex:s[0].colIndex},u.model.sheets[i]._selectedRange={startRow:c.rowIndex,endRow:y.rowIndex,dataSourceIndexes:et.filteredIndex},this._getSelectedRangeData(c,y,-1,c.colIndex),u.model.sheets[i]._selectedCellIndexes.push(s[0].colIndex);for(yt={sheetIndex:i,filteredCells:tt,reqType:"filter",operation:"apply-filter",tableID:-1},it=u.model.sheets[i].filterSettings.tableRange,o=0,w=it.length;o<w;o++)it[o].tableID===-1&&(ot=!0,st=o);ot?(h=u.model.sheets[i].filterSettings.tableRange[st],h.startRow=c.rowIndex,h.endRow=y.rowIndex,h.multiFiltering=u.model.sheets[i]._multipleFiltering,h.multifilterIdx=u.model.sheets[i]._multifilterIdx,h.selectedCellIndexes=u.model.sheets[i]._multifilterIdx,h.selectedRange=u.model.sheets[i]._selectedRange,h.filteredRange=u.model.sheets[i].filterSettings.filteredRange,h.filteredColumns=u.model.sheets[i].filterSettings.filteredColumns,h.predicate=u._excelFilter._predicates[i],h.hiddenIdx=[]):u.model.sheets[i].filterSettings.tableRange.push({startRow:c.rowIndex,endRow:y.rowIndex,tableID:-1,multiFiltering:u.model.sheets[i]._multipleFiltering,multifilterIdx:u.model.sheets[i]._multifilterIdx,selectedCellIndexes:u.model.sheets[i]._multifilterIdx,selectedRange:u.model.sheets[i]._selectedRange,filteredRange:u.model.sheets[i].filterSettings.filteredRange,filteredColumns:u.model.sheets[i].filterSettings.filteredColumns,predicate:{},hiddenIdx:[]});u.model.sheets[i]._importRendered||(u.XLSelection._refreshBorder(),u._completeAction(yt))}else u._renderAlertDlgContent(n("#"+u._id+"_alertdlg"),"Alert",u._getLocStr("Alert"),"",440),n("#"+u._id+"_alertdlg").ejDialog("open")},_filterClickHandler:function(t){var i=this.XLObj,s=n(t.target),u=i.getActiveSheetIndex(),k=!1,l,a,v,st,h,d,c,ht,g,o,e,f,nt=[],ct={},tt,it,y,rt,p,w,ut,r,ft,et,ot,b;if(a=i.model.sheets[u].columns[t.target.parentNode.cellIndex].field,this._isDecimal=!1,s[0].className.indexOf("e-ssfiltered")>-1&&(k=!0),s[0].className.indexOf("e-ssfilter")>-1){for(f=i.model.sheets[u].filterSettings.tableRange,o=s[0].className.indexOf("e-ft")!==-1?parseInt(s[0].className.substr(s[0].className.indexOf("e-ft")+4,s[0].className.length)):-1,r=0,h=f.length;r<h;r++)f[r].tableID===o&&(w=r,f[r].multiFiltering?(d=f[r].multifilterIdx[0],c=f[r].multifilterIdx[f[r].multifilterIdx.length-1]):d=c=t.target.parentNode.cellIndex,rt={rowIndex:f[r].startRow,colIndex:d},p={rowIndex:f[r].endRow,colIndex:c},i.model.sheets[u]._multipleFiltering=f[r].multiFiltering,i.model.sheets[u]._multifilterIdx=f[r].multifilterIdx,e=i.model.sheets[u]._selectedRange=f[r].selectedRange,i.model.sheets[u].filterSettings.filteredRange=f[r].filteredRange,i.model.sheets[u]._selectedCellIndexes=f[r].selectedCellIndexes);if(o===-1){if(ut=this._createSelection(u,e.startRow,e.endRow,c,e.dataSourceIndexes),l=ut.endRowIndex-1,e.endRow!=l)for(r=e.endRow+1;r<=l;r++)ht=i.getCell(r,c),g={field:a,value:ht.text(),matchcase:!1,operator:"equal",predicate:"or"},i.model.sheets[u].filterSettings.filteredColumns.push(g),f[w].filteredColumns.push(g),f[w].selectedRange.endRow=l;p={rowIndex:l,colIndex:c};f[w].selectedRange=i.model.sheets[u]._selectedRange={startRow:rt.rowIndex,endRow:p.rowIndex,dataSourceIndexes:ut.filteredIndex}}for(this._getSelectedRangeData(rt,p,o,t.target.parentNode.cellIndex),v=i.model.sheets[u].columns,st=this._getColumnType(u,e.startRow,e.endRow,t.target.parentNode.cellIndex),r=0,h=v.length;r<h;r++)if(v[r].field===a){i._$colType=st;i._$curFieldName=v[r].field;break}for(ft=i.element.find(".e-excelfilter.e-dlgcontainer"),ot=i.element.height(),tt=i.element.width(),et=ft.height(),it=ft.width(),y=t.clientX,b=t.clientY,tt-t.clientX<=it&&(y=tt-it),ot-t.clientY<=et&&(b=ot-(et+20)),f=i.model.sheets[u].filterSettings.tableRange,r=0,h=f.length;r<h;r++)f[r].tableID===o&&(nt=f[r].filteredColumns,ct=f[r].predicate);i._excelFilter._predicates[u]=ct;this._isSearchEdit=!0;i.model.sheets[u].filterSettings.filteredRange==null?i._excelFilter.openXFDialog({field:a,dataSource:i.model.sheets[u].dataSource,position:{X:y,Y:b},type:i._$colType,format:i._$colFormat,filteredColumns:nt,sortedColumns:[],key:u,tableID:o,selectedColors:i.model.sheets[u]._selectedCellColors,isFiltered:k,blank:"",enableColor:!0,filteredByColor:i.model.sheets[u]._filteredByColor}):i._excelFilter.openXFDialog({field:a,dataSource:i.model.sheets[u].filterSettings.filteredRange,position:{X:y,Y:b},type:i._$colType,format:i._$colFormat,filteredColumns:nt,sortedColumns:[],key:u,tableID:o,selectedColors:i.model.sheets[u]._selectedCellColors,isFiltered:k,blank:"",enableColor:!0,filteredByColor:i.model.sheets[u]._filteredByColor})}},_cancelHandler:function(){this._isSearchEdit=!1},_filterHandler:function(i){var h,ut=!1,a=-1,k,v,u={},ft,r=this.XLObj,e=r.getActiveSheetIndex(),et,d,g,y,o=[],w={},s,ot,st,c,f,l,p,nt,tt,it,b,rt;for(u.requestType=i.action==="sorting"||i.action==="filterbycolor"?i.action:"filtering",h=r.model.sheets[e].filterSettings.tableRange,r.XLFilter._isSearchEdit=!1,f=0,l=h.length;f<l;f++)h[f].tableID===i.tableID&&(n.extend(!0,o,h[f].filteredColumns),w=h[f].predicate,ut=!0,a=f);if(i.action==="filtering"){for(ft=t.DataManager(o),et=(new t.Query).where("field",t.FilterOperators.equal,i.fieldName),d=ft.executeLocal(et),u.filteredColumns=o,f=0,l=d.length;f<l;f++)g=n.inArray(d[f],o),g>=0&&o.splice(g,1);t.merge(o,i.filterCollection);w=r._excelFilter._predicates[e]}else if(i.action==="clearfiltering"){y=i.filterDetails;delete r._excelFilter._predicates[e][i.fieldName];r.model.sheets[e].filterSettings.filteredColumns=o;this._clearFilterColumn(y.field,y.operator,y.value,y.predicate,"","",i.tableID);return}if(ut&&(h[a].filteredColumns=o,h[a].predicate=w),u.tableID=i.tableID,i.action==="filtering"||i.action==="clearfiltering")u.currentFilteringColumn=i.fieldName,u.ejpredicate=i.ejpredicate,u.filterCollection=n.extend(!0,[],i.filterCollection),u.action="filtering",u.reqType="filter",u.sheetIndex=e,u.filteredcolumns=o,u.predicate=w;else if(i.action==="sorting")for(u.requestType=u.action=i.action,k=r.XLEdit.getColumnIndexByField(i.sortDetails.field),v=r.model.sheets[e].filterSettings.tableRange[a].selectedRange,c=r.model.sheets[e].filterSettings.tableRange[a].selectedCellIndexes,r.XLSort.sortByRange(r.swapRange([v.startRow,c[0],v.endRow,c[c.length-1]]),i.sortDetails.field,i.sortDetails.direction),this._changeSortIcon(r.getCell(v.startRow-1,k),i.sortDetails.direction),f=0,l=c.length;f<l;f++)s=r.getCell(v.startRow-1,c[f]).find(".e-filterspan")[0],c[f]!=k&&(r._hasClass(s,"e-ssfilter-asc")||r._hasClass(s,"e-ssfilter-dsc"))&&(r._hasClass(s,"e-ssfilter-asc")&&r._removeClass(s,"e-ssfilter-asc"),r._hasClass(s,"e-ssfilter-dsc")&&r._removeClass(s,"e-ssfilter-dsc"),r.addClass(s,"e-ssfilter"));else u.requestType=u.action=i.action,u.range=r.model.sheets[e]._selectedRange,i.action==="sortbycolor"?(u.sortColumn=i.sortDetails.field,u.operation=i.sortDetails.operation,p=i.sortDetails.color.replace("rgb(","").replace(")","").split(",")):(r._isUndoRedo?(u.filterColumn=i.columnName,u.operation=i.operation):(u.filterColumn=i.filterDetails.field,u.operation=i.filterDetails.operation,p=i.filterDetails.color.replace("rgb(","").replace(")","").split(",")),u.tableID=i.tableID,r.model.sheets[e]._filteredByColor=u.filterColumn),r._isUndoRedo||(nt=p[0],tt=p[1],it=p[2]),u.operation==="sortbgcolor"||u.operation==="filterbgcolor"?u.bgcolor=r._isUndoRedo?i.bgcolor:this._convertrgbtohex(parseInt(nt),parseInt(tt),parseInt(it)):u.fgcolor=r._isUndoRedo?i.fgcolor:this._convertrgbtohex(parseInt(nt),parseInt(tt),parseInt(it));b=n("#"+r._id+r._excelFilter._$colType+"SelectAll").data("ejCheckBox");rt=r._excelFilter._openedFltr.find(".e-searchinput").val();ot=!t.isNullOrUndefined(b)&&b.model.checked&&b.model.enabled;st=!t.isNullOrUndefined(rt)&&rt.length<1;ot&&st&&r._excelFilter._openedFltr.is(":visible")&&i.action!=="sortbycolor"&&i.action!=="filterbycolor"&&i.action!=="sorting"?(delete r._excelFilter._predicates[e][u.currentFilteringColumn],r.model.sheets[e].filterSettings.filteredColumns=o,this._clearFilterColumn(u.currentFilteringColumn,"","","Or","","",i.tableID)&&(r.model.sheets[e].filterSettings.filteredColumns=temp)):i.action!=="sorting"&&r._processBindings(u)&&(o=temp);r.XLSelection._refreshBorder()},_convertrgbtohex:function(n,t,i){return"#"+(16777216+(n<<16)+(t<<8)+i).toString(16).slice(1)},_clearFilterColumn:function(i,r,u,f,e,o,s){var b,a={},h,w,c=this.XLObj,l=c.getActiveSheetIndex(),nt=!1,k={},tt,it,d,g,v=c.model.sheets[l].filterSettings.tableRange,y=[],p,rt;for(a.requestType=t.Grid.Actions.Filtering,a.currentFilterObject=[],n.isArray(r)||(r=n.makeArray(r)),n.isArray(u)||(u=n.makeArray(u)),this._currentFilterColumn=this._getColumnByField(l,i),p=0,rt=r.length;p<rt;p++)if(k={field:i,operator:r[p],value:u[p],matchcase:e,predicate:f,actualFilterValue:o},!nt){for(h=0,w=v.length;h<w;h++)v[h].tableID===s&&(b=v[h],n.extend(!0,y,v[h].filteredColumns),c._excelFilter._predicates[l]=v[h].predicate,c.model.sheets[l].filterSettings.filteredRange=c.model.sheets[l].filterSettings.tableRange[h].filteredRange,c.model.sheets[l]._selectedCellIndexes=v[h].selectedCellIndexes,c.model.sheets[l]._selectedRange=v[h].selectedRange,c.model.sheets[l]._multifilterIdx=v[h].multifilterIdx);for(tt=t.DataManager(y),it=(new t.Query).where("field",t.FilterOperators.equal,k.field),d=tt.executeLocal(it),h=0,w=d.length;h<w;h++)g=n.inArray(d[h],y),g!==-1&&y.splice(g,1)}nt=!0;delete c._excelFilter._predicates[l][i];b.filteredColumns=y;b.predicate=c._excelFilter._predicates[l];a.currentFilterObject.push(k);a.filterCollection=y;a.currentFilteringColumn=i;a.filteredcolumns=y;a.action="clearFiltering";a.reqType="filter";a.tableID=s;c._processBindings(a)&&(c.model.sheets[l].filterSettings.filteredColumns.reverse().splice(0,r.length),c.model.sheets[l].filterSettings.filteredColumns.reverse());this.XLObj.XLSelection._refreshBorder()},_filterTable:function(t,i){var r=this.XLObj,o=[],l=!1,a=!1,e,v,h,y,u,p;r.model.sheets[t]._multipleFiltering=!1;r.model.sheets[t]._multifilterIdx=[];var c=r.getSheet(t)._selectedCells,s=c[c.length-1],f=c[0],w=r._getContent(t).find("tbody").get(0).rows,b=n(w).eq(f.rowIndex);for(u=f.colIndex;u<=s.colIndex;u++)b.find("td").eq(u).find(".e-ssfilter, .e-ssfiltered, .e-ssfilter-asc, .e-ssfiltered-asc, .e-ssfilter-dsc, .e-ssfiltered-dsc").length>0?l=!0:(v=r.getCell(f.rowIndex,u),h=this._getFilterIcon(),y="e-ft"+i,h.addClass(y),this._applyFilterIcon(v,h),o.push(u),r.model.sheets[t]._multifilterIdx.push(u));if(!l)if(o.length>1&&(r.model.sheets[t]._multipleFiltering=!0,a=!0),f.rowIndex=f.rowIndex+1,this._getSelectedRangeData(f,s,i,f.colIndex),r._isFATResize){if(e=r.model.sheets[t].filterSettings.tableRange,e.length)for(u=0,p=e.length;u<p;u++)if(e[u].tableID===i){e[u].endRow=s.rowIndex;break}r._isFATResize=!1}else r.model.sheets[t].filterSettings.tableRange.push({startRow:f.rowIndex,endRow:s.rowIndex,tableID:i,multiFiltering:a,multifilterIdx:o,selectedCellIndexes:o,selectedRange:r.model.sheets[t]._selectedRange,filteredRange:r.model.sheets[t].filterSettings.filteredRange,filteredColumns:r.model.sheets[t].filterSettings.filteredColumns,predicate:{},hiddenIdx:[]})},_clearFilterTable:function(t,i,r){for(var s,y,o=this.XLObj,u=o.model.sheets[t].filterSettings.tableRange,h,c,e,l,a,f=0,v=u.length;f<v;f++)if(u[f].tableID===i){for(o.model.sheets[t]._selectedRange=u[f].selectedRange,s=u[f].multifilterIdx,y=u[f].startRow,e=0,l=s.length;e<l;e++)a=o.model.sheets[t].columns[s[e]].field,this._clearFilterColumn(a,"","","Or","","",u[f].tableID),r||(h=o.getCell(y-1,s[e]),c=h.find(".e-filterspan"),n(c).remove(),h.removeClass("e-filterhdr"));r||(u.splice(f,1),v=u.length)}},_clearFilterTableIcon:function(n,t){for(var u=this.XLObj,r=u.model.sheets[n].filterSettings.tableRange,o,s,f,h,e,i=0,c=r.length;i<c;i++)if(r[i].tableID===t)for(u.model.sheets[n]._selectedRange=r[i].selectedRange,u.model.sheets[n].filterSettings.filteredRange=r[i].filteredRange,o=r[i].multifilterIdx,s=r[i].startRow,f=0,h=o.length;f<h;f++)e=u.getCell(s-1,o[f]).find(".e-filterspan"),e.is(":visible")?e.hide():e.show()},_insertFilterIcon:function(n,t,i,r,u){var e,f,o;u&&n===r&&(e=this.XLObj.getCell(n,t-1),f=this._getFilterIcon(),o="e-ft"+i.tableID,f.addClass(o),i.multifilterIdx.push(i.multifilterIdx[i.multifilterIdx.length-1]+1),this._applyFilterIcon(e,f))},_changeFilterIcon:function(n,t){var i=n.find("span");t==="filter"?i.hasClass("e-ssfilter")?i.removeClass("e-ssfilter").addClass("e-ssfiltered"):i.hasClass("e-ssfilter-asc")?i.removeClass("e-ssfilter-asc").addClass("e-ssfiltered-asc"):i.hasClass("e-ssfilter-dsc")&&i.removeClass("e-ssfilter-dsc").addClass("e-ssfiltered-dsc"):i.hasClass("e-ssfiltered")?i.removeClass("e-ssfiltered").addClass("e-ssfilter"):i.hasClass("e-ssfiltered-asc")?i.removeClass("e-ssfiltered-asc").addClass("e-ssfilter-asc"):i.hasClass("e-ssfiltered-dsc")&&i.removeClass("e-ssfiltered-dsc").addClass("e-ssfilter-dsc")},_changeSortIcon:function(n,t){var i=n.find("span");t==="ascending"?i.hasClass("e-ssfilter")?i.removeClass("e-ssfilter").addClass("e-ssfilter-asc"):i.hasClass("e-ssfilter-dsc")?i.removeClass("e-ssfilter-dsc").addClass("e-ssfilter-asc"):i.hasClass("e-ssfiltered")?i.removeClass("e-ssfiltered").addClass("e-ssfiltered-asc"):i.hasClass("e-ssfiltered-dsc")&&i.removeClass("e-ssfiltered-dsc").addClass("e-ssfiltered-asc"):i.hasClass("e-ssfilter")?i.removeClass("e-ssfilter").addClass("e-ssfilter-dsc"):i.hasClass("e-ssfilter-asc")?i.removeClass("e-ssfilter-asc").addClass("e-ssfilter-dsc"):i.hasClass("e-ssfiltered")?i.removeClass("e-ssfiltered").addClass("e-ssfiltered-dsc"):i.hasClass("e-ssfiltered-asc")&&i.removeClass("e-ssfiltered-asc").addClass("e-ssfiltered-dsc")},_extendFilterRange:function(n,t){var o=this.XLObj,u,s=o.getActiveSheetIndex(),r=o.model.sheets[s].filterSettings.tableRange,i,e,f;if(r.length)for(i=0,f=r.length;i<f;i++)if(r[i].tableID==n){if(r[i].endRow<t[2]&&(u=r[i].selectedRange.dataSourceIndexes,r[i].endRow=r[i].selectedRange.endRow=t[2],u[u.length-1]<r[i].endRow))for(e=u[u.length-1],f=r[i].endRow;e<f;e++)u.push(e+1);break}}}}(jQuery,Syncfusion),function(n,t,r){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.ribbon=function(n){this.XLObj=n;this._tabCollection=[];this._contextualTabCollection=[];this._smallBtnHeight=25;this._mediumBtnHeight=35;this._bigBtnHeight=75;this._splitBtnHeight=75;this._dropDownHeight=25;this._ribbonState=!0;this._isSetModel=!1;this._isDesignTab=!0;this._hasTitle="";this._isWrapText=!1;this._pageLaySptBtnIds=["sizesbtn"];this._dataBtnIds=["sortAtoZ","sortZtoA","filter","clearfilter","validationbtn"];this._dataSptBtnIds=["validationsbtn"];this._toggleBtnIds=["bold","italic","underline","line-through","left","right","center","justify","top","middle","bottom","wraptext","formatpainter"];this._homeBtnIds=["pastebtn","increasefontsize","decreasefontsize","increaseindent","decreaseindent","increment","decrement","undo","redo","accounting","usegrouping","percentage","cut","copy"];this._homeSptBtnIds=["pastesbtn","border","cFormat","formatastable","cellstyles","find","clear","merge","autosum"];this._insertBtnIds=["pivotTable","table","hyperlink","pictures"];this._insertSptBtnIds=["columnchart","barchart","stockchart","linechart","areachart","combochart","piechart","scatterchart"];this._pageLayBtnIds=["sizebtn","print","printselected"];this._pageLayChckBxIds=["Vheading","Vgridlines","Pheading","Pgridlines"];this._ddIds=["cellformat","fontsize","font-family"];this._cpIds=["background-color","color"];this._splitBtnIds=["border","paste","cFormat","formatastable","cellstyles","find","clear","sortfilter"];this._fileMenuData=[{id:"File",text:n._getLocStr("File"),parentId:null},{id:"New",text:n._getLocStr("New"),parentId:"File",sprite:"e-icon e-ss-newsheet"},{id:"Open",text:n._getLocStr("Open")+"...",parentId:"File",sprite:"e-icon e-ss-open"},{id:"Save",text:n._getLocStr("Save"),parentId:"File",sprite:"e-icon e-ss-saveas"},{id:"Print",text:n._getLocStr("Print"),parentId:"File",sprite:"e-icon e-ss-print"},{id:"ExportXL",text:n._getLocStr("ExportXL"),parentId:"Save",sprite:"e-icon e-ss-exportxl"},{id:"ExportCsv",text:n._getLocStr("ExportCsv"),parentId:"Save",sprite:"e-icon e-ss-exportcsv"},{id:"PrintSheet",text:n._getLocStr("PrintSheet"),parentId:"Print",sprite:"e-icon e-ss-print"},{id:"PrintSelected",text:n._getLocStr("PrintSelected"),parentId:"Print",sprite:"e-icon e-ss-printselected"}];this._pasteMenuData=[{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:null},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:null}];this._fontFamily=[{value:"1",text:"Segoe UI"},{value:"2",text:"Arial"},{value:"3",text:"Times New Roman"},{value:"4",text:"Tahoma"},{value:"5",text:"Helvetica"},{value:"6",text:"Calibri"}];this._fontSize=[{value:"8px",text:"8"},{value:"9px",text:"9"},{value:"10px",text:"10"},{value:"11px",text:"11"},{value:"12px",text:"12"},{value:"14px",text:"14"},{value:"16px",text:"16"},{value:"18px",text:"18"},{value:"20px",text:"20"},{value:"22px",text:"22"},{value:"24px",text:"24"},{value:"26px",text:"26"},{value:"28px",text:"28"},{value:"36px",text:"36"},{value:"48px",text:"48"},{value:"72px",text:"72"}];this._mergeMenuData=[{id:"MergeAndCenter",text:n._getLocStr("MergeAndCenter"),parentId:null,sprite:"e-icon e-ss-mergecenter"},{id:"MergeAcross",text:n._getLocStr("MergeAcross"),parentId:null,sprite:"e-icon e-ss-mergeacross"},{id:"MergeCells",text:n._getLocStr("MergeCells"),parentId:null,sprite:"e-icon e-ss-merge"},{id:"UnmergeCells",text:n._getLocStr("UnmergeCells"),parentId:null,sprite:"e-icon e-ss-unmerge"}];this._sortFltrMenuData=[{id:"SortAtoZ",text:this.XLObj._getLocStr("SortAtoZ"),parentId:null,sprite:"e-icon e-ssdrop-sortatoz"},{id:"SortZtoA",text:this.XLObj._getLocStr("SortZtoA"),parentId:null,sprite:"e-icon e-ssdrop-sortztoa"},{id:"Filter",text:this.XLObj._getLocStr("Filter"),parentId:null,sprite:"e-icon e-ssdrop-filter"},{id:"ClearFilter",text:this.XLObj._getLocStr("ClearFilter"),parentId:null,sprite:"e-icon e-ssdrop-clearfilter"}];this._findMenuData=[{id:"Find",text:n._getLocStr("Find")+"...",parentId:null,sprite:"e-icon e-ss-find"},{id:"Replace",text:n._getLocStr("Replace")+"...",parentId:null,sprite:"e-icon e-ss-replace"},{id:"GoTo",text:n._getLocStr("GoTo")+"...",parentId:null,sprite:"e-icon e-ss-goto"},{id:"GoToSpecial",text:n._getLocStr("GoTo")+" "+n._getLocStr("Special")+"...",parentId:null},{id:"Formulas",text:n._getLocStr("Formulas"),parentId:null},{id:"Comments",text:n._getLocStr("Comments"),parentId:null},{id:"CFormat",text:n._getLocStr("ConditionalFormat"),parentId:null},{id:"Constants",text:n._getLocStr("Constants"),parentId:null},{id:"DataValidation",text:n._getLocStr("DataValidation"),parentId:null}];this._valMenuData=[{id:"Validation",text:n._getLocStr("DataValidation")+"...",parentId:null,sprite:"e-icon e-ss-validation"},{id:"HighlightVal",text:n._getLocStr("HighlightVal"),parentId:null,sprite:"e-icon e-ss-hlval"},{id:"ClearHLVal",text:n._getLocStr("ClearHLVal"),parentId:null,sprite:"e-icon e-ss-clearval"},{id:"ClearVal",text:n._getLocStr("ClearVal"),parentId:null,sprite:"e-icon e-ss-clearval"}];this._pageSizes=[{id:"A4",text:n._getLocStr("A4"),parentId:null,sprite:"e-icon e-ss-A4size"},{id:"A3",text:n._getLocStr("A3"),parentId:null,sprite:"e-icon e-ss-A3size"},{id:"Letter",text:n._getLocStr("Letter"),parentId:null,sprite:"e-icon e-ss-lettersize"}];this._viewMenuData=[{id:"freezePanes",text:n._getLocStr("freezePanes"),parentId:null,sprite:"e-icon e-ss-frzpane"},{id:"FreezeRow",text:n._getLocStr("FreezeRow"),parentId:null,sprite:"e-icon e-ss-frzrow"},{id:"FreezeColumn",text:n._getLocStr("FreezeColumn"),parentId:null,sprite:"e-icon e-ss-frzcln"}];this._insertMenuData=[{id:"InsertCells",text:n._getLocStr("inscells")+"...",parentId:null,sprite:"e-icon e-ssr-inscell"},{id:"InsertSheetRows",text:n._getLocStr("insrows"),parentId:null,sprite:"e-icon e-ssr-insrow"},{id:"InsertSheetColumns",text:n._getLocStr("inscols"),parentId:null,sprite:"e-icon e-ssr-inscol"},{id:"InsertSheet",text:n._getLocStr("inssheet"),parentId:null,sprite:"e-icon e-ssr-inssheet"}];this._resetPicture=[{id:"resetpicture",text:n._getLocStr("ResetPicture"),parentId:null,sprite:"e-icon e-ss-resetpicture"},{id:"resetsize",text:n._getLocStr("ResetSize"),parentId:null,sprite:"e-icon e-ss-resetpicture"}];var t=n._getLocStr("BorderStyles").split("/");this._borderMenuData=[{id:"bottomborder",text:n._getLocStr("BottomBorder"),parentId:null,sprite:"e-icon e-ss-bottomborder"},{id:"topborder",text:n._getLocStr("TopBorder"),parentId:null,sprite:"e-icon e-ss-topborder"},{id:"leftborder",text:n._getLocStr("LeftBorder"),parentId:null,sprite:"e-icon e-ss-leftborder"},{id:"rightborder",text:n._getLocStr("RightBorder"),parentId:null,sprite:"e-icon e-ss-rightborder"},{id:"outsideborder",text:n._getLocStr("OutsideBorder"),parentId:null,sprite:"e-icon e-ss-outsideborder"},{id:"allborder",text:n._getLocStr("AllBorder"),parentId:null,sprite:"e-icon e-ss-allborder"},{id:"noborder",text:n._getLocStr("NoBorder"),parentId:null,sprite:"e-icon e-ss-noborder"},{id:"thickboxborder",text:n._getLocStr("ThickBoxBorder"),parentId:null,sprite:"e-icon e-ss-thickboxborder"},{id:"thickbottomborder",text:n._getLocStr("ThickBottomBorder"),parentId:null,sprite:"e-icon e-ss-thickbottomborder"},{id:"topandbottomborder",text:n._getLocStr("TopandBottomBorder"),parentId:null,sprite:"e-icon e-ss-topandbottomborder"},{id:"topandthickbottomborder",text:n._getLocStr("TopandThickBottomBorder"),parentId:null,sprite:"e-icon e-ss-topandthickbottomborder"},{id:"drawborder",text:n._getLocStr("DrawBorder"),parentId:null,sprite:"e-icon e-ss-drawborder"},{id:"drawbordergrid",text:n._getLocStr("DrawBorderGrid"),parentId:null,sprite:"e-icon e-ss-drawbordergrid"},{id:n._id+"_bordercolor",text:n._getLocStr("BorderColor"),parentId:null,sprite:"e-icon e-ss-bordercolor"},{id:n._id+"_Ribbon_bordercolor",text:"",parentId:n._id+"_bordercolor"},{id:n._id+"_Ribbon_borderstyle",text:n._getLocStr("BorderStyle"),parentId:null},{id:"solid",text:t[0],parentId:n._id+"_Ribbon_borderstyle"},{id:"dashed",text:t[1],parentId:n._id+"_Ribbon_borderstyle"},{id:"dotted",text:t[2],parentId:n._id+"_Ribbon_borderstyle"},];this._textAlign=[{value:"1",text:"Left"},{value:"2",text:"Center"},{value:"3",text:"Right"}];this._verticalAlign=[{value:"1",text:"Top"},{value:"2",text:"Middle"},{value:"3",text:"Bottom"}];this._actions=[{value:"Greater",text:"greater than"},{value:"GreaterOrEqual",text:"greater or equal to"},{value:"Less",text:"less than"},{value:"LessOrEqual",text:"less than or equal to"},{value:"Equal",text:"equal to"},{value:"NotEqual",text:"not equal to"},{value:"Between",text:"between"},{value:"NotBetween",text:"not between"}];this._types=[{value:"number",text:"Number"},{value:"decimal",text:"Decimal"},{value:"date",text:"Date"},{value:"time",text:"Time"},{value:"text",text:"TextLength"},{value:"list",text:"List"}];this._cFormatData={greaterthan:["GTTitle","GTContent"],lessthan:["LTTitle","LTContent"],between:["BWTitle","BWContent"],equalto:["EQTitle","EQContent"],textcontains:["ContainsTitle","ContainsContent"],dateoccur:["DateTitle","DateContent"]};this._styles=[{value:"redft",text:"Light Red Fill with Dark Red Text"},{value:"yellowft",text:"Yellow Fill with Dark Yellow Text"},{value:"greenft",text:"Green Fill with Dark Green Text"},{value:"redf",text:"Red Fill"},{value:"redt",text:"Red Text"}];this._currentCFormat="";this._addrList=[];this._within=[{value:"sheet",text:n._getLocStr("Sheet")},{value:"workbook",text:n._getLocStr("Workbook")}];this._sType=[{value:"columns",text:n._getLocStr("Columns")},{value:"rows",text:n._getLocStr("Rows")}];this._vType=[{value:"value",text:n._getLocStr("Value")},{value:"formula",text:n._getLocStr("Formula")},{value:"comment",text:n._getLocStr("Comments")}];this._direction=[{value:"down",text:n._getLocStr("Down")},{value:"up",text:n._getLocStr("Up")}];this._gotoRBtnSet1=["Comments","Blanks","LastCell","Formulas","Constants"];this._gotoRBtnSet2=["RowDiff","ColDiff","CFormat","DataValidation"];this._gotoChkBox=["GotoNumbers","GotoText","GotoLogicals","GotoError"];this._othersSptBtnIds=["inssbtn","delsbtn","find","fPane"];this._contextualBtnIds=["resizetable","convertorange"];this._contextualInputIds=["tableid","tablename"];this._contextualCheckBoxIds=["tsofirstcolumn","tsolastcolumn","tsototalrow","tsofiltercolumn"];this._numberFormat=[{value:"1",text:"General"},{value:"2",text:"Number"},{value:"3",text:"Currency"},{value:"4",text:"Accounting"},{value:"5",text:"Percentage"},{value:"6",text:"Text"},{value:"7",text:"Shortdate"},{value:"8",text:"Longdate"},{value:"9",text:"Time"},{value:"10",text:"Scientific"},{value:"11",text:"Fraction"}];this._othersBtnIds=["insbtn","delbtn","namemanager","definename"];this._deleteMenuData=[{id:"DeleteCells",text:n._getLocStr("delcells")+"...",parentId:null,sprite:"e-icon e-ssr-delcell"},{id:"DeleteSheetRows",text:n._getLocStr("delrows"),parentId:null,sprite:"e-icon e-ssr-delrow"},{id:"DeleteSheetColumns",text:n._getLocStr("delcols"),parentId:null,sprite:"e-icon e-ssr-delcol"},{id:"DeleteSheet",text:n._getLocStr("delsheet"),parentId:null,sprite:"e-icon e-ssr-delsheet"}];this._clearMenuData=[{id:"Clear_All",text:n._getLocStr("ClearAll"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Clear_Formats",text:n._getLocStr("ClearFormats"),parentId:null,sprite:"e-icon e-ss-clearformat"},{id:"Clear_Contents",text:n._getLocStr("ClearContents"),parentId:null},{id:"Clear_Comments",text:n._getLocStr("ClearComments"),parentId:null},{id:"Clear_Hyperlinks",text:n._getLocStr("ClearHyperLinks"),parentId:null}];this._autosumMenuData=[{id:"Sum",text:n._getLocStr("Sum"),parentId:null,sprite:"e-icon e-ssr-autosum"},{id:"Average",text:n._getLocStr("Average"),parentId:null},{id:"Count",text:n._getLocStr("CountNumber"),parentId:null},{id:"Max",text:n._getLocStr("Max"),parentId:null},{id:"Min",text:n._getLocStr("Min"),parentId:null}];this._cmntTglBtnIds=["showAllComments"];this._cmntBtnIds=["newComment","deleteComment","previousComment","nextComment","showHideComment"];this._chartThemes=[{value:"flatlight",text:"Flat Light"},{value:"flatdark",text:"Flat Dark"},{value:"azure",text:"Azure"},{value:"azuredark",text:"Azure Dark"},{value:"lime",text:"Lime"},{value:"limedark",text:"Lime Dark"},{value:"saffron",text:"Saffron"},{value:"saffrondark",text:"Saffron Dark"}];this._isCustomCellStyleReset=!1};t.spreadsheetFeatures.ribbon.prototype={_renderDialog:function(){var i=this.XLObj,o=i._id,f=o+"_numberdlg",s,l,h,a,e,r,u,c;s=t.buildTag("div#"+f+".e-numberdialog");l=t.buildTag("div#"+f+"_numbertab.e-dlgtab");e=t.buildTag("ul");u=t.buildTag("a",i._getLocStr("NumberTab"),{},{href:"#"+o+"_number"});r=t.buildTag("li",u);e.append(r);u=t.buildTag("a",i._getLocStr("AlignmentTab"),{},{href:"#"+o+"_alignment"});r=t.buildTag("li",u);e.append(r);u=t.buildTag("a",i._getLocStr("FontTab"),{},{href:"#"+o+"_font"});r=t.buildTag("li",u);e.append(r);u=t.buildTag("a",i._getLocStr("BorderTab"),{},{href:"#"+o+"_border"});r=t.buildTag("li",u);e.append(r);u=t.buildTag("a",i._getLocStr("FillTab"),{},{href:"#"+o+"_fill"});r=t.buildTag("li",u);e.append(r);l.append(e);s.append(l);a=t.buildTag("div#"+f+"_btndiv.e-dlgnumbtndiv");h=t.buildTag("input#"+f+"_okbtn","",{"margin-right":8});c=t.buildTag("input#"+f+"_cantn");h.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._groupExpanderOk,this),enabled:!0,cssClass:"e-formatdlgok"});c.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._groupExpanderCancel,this),showRoundedCorner:!0,width:60,cssClass:"e-formatdlgcncl"});a.append(h).append(c);s.append(a);s.append(t.buildTag("div#"+f+"_format_dataMnger","",{display:"none"}));h.addClass("e-conok");c.addClass("e-concancel");i.element.append(s);s.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("Formatcells"),width:548,height:464,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)});n("#"+f+"_numbertab").ejTab({width:527,height:381,cssClass:"e-ss-dlgtab e-ss-formatdlg",itemActive:n.proxy(this._formatTabChange,this)});this._renderNumberTab();this._renderAlignmentTab();this._renderFontTab();this._renderBorderTab();this._renderFillTab()},_formatTabChange:function(t){var i=this.XLObj,r=n("#"+i._id+"_font_flist").data("ejListBox"),u=n("#"+i._id+"_font_fSizelist").data("ejListBox");t.activeIndex===2&&n("#"+i._id+"_font_flist").length>0&&(r._refreshScroller(),u._refreshScroller())},_renderChartTypeDialog:function(){var i=this.XLObj,r=i._id+"_charttypedlg",u,s,f,e,o,h,c,l;u=t.buildTag("div#"+r+".e-chartdialog");s=t.buildTag("div#"+r+"_allcharttab.e-chtdlgtab");h=t.buildTag("ul","",{margin:"8px 0 0 10px",width:"486px",height:"25px"});l=t.buildTag("a",i._getLocStr("AllCharts"),{},{href:"#"+i._id+"_allchart"});c=t.buildTag("li",l);u.append(s.append(h.append(c)));o=t.buildTag("div#"+r+"_btndiv.e-chtdlgbtndiv");f=t.buildTag("div#"+r+"_okbtn","",{"margin-right":8});e=t.buildTag("div#"+r+"_cantn","",{"margin-right":"6px"});f.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._chartTypeOk,this),enabled:!0,cssClass:"e-chartdlgok"});e.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._chartTypeCancel,this),showRoundedCorner:!0,width:60,cssClass:"e-chartdlgcncl"});o.append(f).append(e);u.append(o);f.addClass("e-conok");e.addClass("e-concancel");i.element.append(u);u.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("ChartType"),width:510,height:463,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)});n("#"+r+"_allcharttab").ejTab({width:496,height:387,cssClass:"e-ss-dlgtab e-ss-chartdlg"});this._renderAllChartTab()},_renderAllChartTab:function(){var b=this.XLObj,r=b._id,u=r+"_chartdlg_charttab",v,y,e,o,k="",i,p,d,f,s,g,h,c,l,w="",a=["Column-6","Bar-6","Radar-2","Line-2","Area-3","Pie-3","Scatter-1"];for(v=t.buildTag("div#"+u+"_right.e-chtdlgright"),y=t.buildTag("div#"+u+"_left.e-chtdlgleft"),e=t.buildTag("div#"+u+"_content.e-chtdlgcontent",{"border-bottom":0}),o=t.buildTag("ul#"+u+"_list"),h=0,c=a.length;h<c;h++)i=a[h].split("-")[0],k+="<li><span class='e-icon e-ss-dlg"+i.toLowerCase()+"chart'><\/span>"+i+"<\/li>";for(o.append(k),o.ejListBox({width:"240",selectIndexChanged:n.proxy(this._onChartChange,this),height:"300",allowMultiSelection:!1,selectedItemIndex:0}),y.append(o),e=t.buildTag("div#"+u+"_content.e-chtdlgcontent"),v.append(e),n("#"+r+"_allchart").css("margin-left","10px"),n("#"+r+"_allchart").append(y).append(v),s=0,c=a.length;s<c;s++){for(l=a[s].split("-"),d=b._getLocStr("Title"+l[0]+"Chart").split("/"),i=l[0].toLowerCase(),p=t.buildTag("div#"+r+"_"+i+"chart"),f=1,g=parseInt(l[1]);f<=g;f++)w+="<span class='e-chartimg e-dlg"+i+"chart"+f+"' title='"+d[f-1]+"'><\/span>";e.append(p.append(w));n("#"+r+"_"+i+"chart").find(".e-dlg"+i+"chart1").addClass("e-chartselect");p.hide();w=""}n("#"+r+"_columnchart").show()},_onChartChange:function(t){for(var r=this.XLObj,u=t.data.selectedText.toLowerCase(),f=["column","bar","radar","line","area","pie","scatter"],i=0;i<f.length;i++)n("#"+r._id+"_"+f[i]+"chart").hide();n("#"+r._id+"_"+u+"chart").show();n("#"+r._id+"_allchart").find(".e-chartimg").removeClass("e-chartselect");n("#"+r._id+"_"+u+"chart").find(".e-dlg"+u+"chart1").addClass("e-chartselect")},_renderNumberTab:function(){var r=this.XLObj,i=r._id+"_numberdlg_numbertab",u,f,e,s,h,c,o,l;h=t.buildTag("div#"+i+"_display.e-dlgtext","",null,{data:{}});u=t.buildTag("div#"+i+"_right.e-dlgright");f=t.buildTag("div#"+i+"_left.e-dlgleft");s=t.buildTag("div#"+i+"_center.e-dlgcenter");o=t.buildTag("ul#"+i+"_list");l=[{Category:"General",Id:r._getLocStr("LGeneral")},{Category:"Number",Id:r._getLocStr("NumberTab")},{Category:"Currency",Id:r._getLocStr("LCurrency")},{Category:"Accounting",Id:r._getLocStr("LAccounting")},{Category:"Date",Id:r._getLocStr("LDate")},{Category:"Time",Id:r._getLocStr("LTime")},{Category:"Percentage",Id:r._getLocStr("LPercentage")},{Category:"Fraction",Id:r._getLocStr("LFraction")},{Category:"Scientific",Id:r._getLocStr("LScientific")},{Category:"Text",Id:r._getLocStr("LText")},{Category:"Custom",Id:r._getLocStr("LCustom")}];o.ejListBox({width:"240",dataSource:l,fields:{text:"Id",value:"Category"},selectIndexChanged:n.proxy(this._onselectIndexchange,this),height:"300",allowMultiSelection:!1,selectedItemIndex:0});f.append(o);e=t.buildTag("div#"+i+"_input.e-dlginput");e.append(h);c=t.buildTag("div#"+i+"_content.e-dlgcontent");u.append(e).append(c);n("#"+r._id+"_number").append(f).append(u).append(s);this._renderGeneral(i);this._renderNumber(i);this._renderCurrency(i);this._renderAccounting(i);this._renderPercentage(i);this._renderDate(i);this._renderText(i);this._renderTime(i);this._renderFraction(i);this._renderScientific(i);this._renderCustom(i)},_renderAlignmentTab:function(){var i=this.XLObj,r=i._id+"_alignment",e,u,f,o,s=t.buildTag("table"),a=t.buildTag("tr"),v=t.buildTag("tr"),h=t.buildTag("td","",{width:"170px"}),c=t.buildTag("td"),l=t.buildTag("td","","",{rowspan:"2"}),y=[{value:"none",text:i._getLocStr("LGeneral")},{value:"left",text:i._getLocStr("Left")},{value:"center",text:i._getLocStr("Center")},{value:"right",text:i._getLocStr("Right")},{value:"justify",text:i._getLocStr("Justify")}],p=[{value:"top",text:i._getLocStr("Top")},{value:"middle",text:i._getLocStr("Center")},{value:"bottom",text:i._getLocStr("Bottom")}];o=t.buildTag("div#"+r+"_content");e=t.buildTag("div#"+r+"_textAlign","",{height:"158px"});e.append(t.buildTag("label#"+r+"_lblAlgnTxt1",i._getLocStr("textalignment")),t.buildTag("hr.e-ss-sctnseparator","",{"margin-left":"93px"}));h.append(t.buildTag("label#"+r+"_lblAlgnTxt2",i._getLocStr("horizontal")),t.buildTag("input#"+r+"_hortxtdropdwn","","",{type:"text"}));c.append(t.buildTag("label#"+r+"_lblAlgnTxt3",i._getLocStr("vertical"),{"padding-top":"10px"}),t.buildTag("input#"+r+"_vertxtdropdwn","","",{type:"text"}));l.append(t.buildTag("label#"+r+"_lblAlgnTxt4",i._getLocStr("indent")),t.buildTag("input#"+r+"_indntnumericbox","",{width:"60px"},{type:"text"}));s.append(a.append(h,l),v.append(c));u=t.buildTag("div#"+r+"_textControl","",{"margin-top":"13px"});u.append(t.buildTag("label#"+r+"_lblAlgnTxt5",i._getLocStr("textcontrol")),t.buildTag("hr.e-ss-sctnseparator","",{"margin-left":"77px"}));f=t.buildTag("input#"+r+"_wraptext");u.append(t.buildTag("div#"+r+"_txtCtrlContent",f));o.append(e.append(s),u);n("#"+i._id+"_alignment").append(o);n("#"+r+"_hortxtdropdwn").ejDropDownList({dataSource:y,change:n.proxy(this._processpreviewaction,this,"text-align")});n("#"+r+"_vertxtdropdwn").ejDropDownList({dataSource:p,change:n.proxy(this._processpreviewaction,this,"vertical-align")});n("#"+r+"_indntnumericbox").ejNumericTextbox({name:"numeric",value:0,minValue:0,maxValue:99,change:n.proxy(this._processpreviewaction,this,"text-indent")});f.ejCheckBox();f.parent().append(t.buildTag("label").text(i._getLocStr("wraptext")).css("margin-left","6px"))},_renderFontTab:function(){var r=this.XLObj,i=r._id+"_font",v,y,p,w,b,k,f,e,o,s,h,c,d,ut=t.buildTag("div#"+i+"_content","",{width:509,"margin-left":-11,"margin-top":0}),u=t.buildTag("table"),ft=t.buildTag("tr"),et=t.buildTag("tr"),ot=t.buildTag("tr"),l,g,nt,a,tt,it,rt;v=t.buildTag("ul#"+i+"_flist");y=t.buildTag("ul#"+i+"_fStylelist");p=t.buildTag("ul#"+i+"_fSizelist");w=t.buildTag("div#"+i+"_flistdiv","",{height:135,width:175}).append(v);b=t.buildTag("div#"+i+"_fStylelistdiv","",{height:135,width:150}).append(y);k=t.buildTag("div#"+i+"_fSizelistdiv","",{height:135,width:150}).append(p);f=t.buildTag("td",t.buildTag("label#"+i+"_lblfontTxt1",r._getLocStr("fontgroup"))).append("<br />",t.buildTag("input#"+i+"_fontTxtbx","",{width:171,"-moz-padding-end":1,"text-indent":"8px"},{type:"text",disabled:"true"}));f.append(w);e=t.buildTag("td",t.buildTag("label#"+i+"_lblfontTxt2",r._getLocStr("fontstyle")),{"padding-left":"12px","padding-right":"13px"}).append("<br />",t.buildTag("input#"+i+"_fontStyleTxtbx","",{width:146,"-moz-padding-end":1,"text-indent":"8px"},{type:"text",disabled:"true"}));e.append(b);o=t.buildTag("td",t.buildTag("label#"+i+"_lblfontTxt3",r._getLocStr("size"))).append("<br />",t.buildTag("input#"+i+"_fontSizeTxtbx","",{width:146,"-moz-padding-end":1,"text-indent":"8px"},{type:"text",disabled:"true"}));o.append(k);u.append(ft.append(f,e,o));s=t.buildTag("td","",{},{rowspan:"2"});h=t.buildTag("div#"+i+"_effects");c=t.buildTag("input#"+i+"_underline","","",{name:"small"});d=t.buildTag("label.e-effectrdbtn",r._getLocStr("underline"),{},{"for":i+"_underline"});l=t.buildTag("input#"+i+"_strike","","",{name:"small"});g=t.buildTag("label.e-effectrdbtn",r._getLocStr("strikethrough"),{},{"for":i+"_strike"});a=t.buildTag("input#"+i+"_defaultfont.e-deffontbtn","",{position:"relative",top:"14px"});h.append(t.buildTag("label#"+i+"_lblfontTxt4",r._getLocStr("effects")),"<br />",c,d,"<br />",l,g,"<br />",a);s.append(h);nt=t.buildTag("td",t.buildTag("label#"+i+"_lblcolorTxt1",r._getLocStr("color")),{"padding-left":"11px","padding-top":"13px"}).append("<br />",t.buildTag("input#"+i+"_colorpick","",{width:"174px"},{type:"text"}));u.append(et.append(s,nt));tt=t.buildTag("div#"+i+"_viewpanel.e-dlgviewpanel",r._getLocStr("previewtext"));it=t.buildTag("td",t.buildTag("label#"+i+"_lblpreviewTxt1",r._getLocStr("preview")),{"padding-left":"12px"},{colspan:"2"}).append(tt);u.append(ot.append(it));n("#"+r._id+"_font").append(ut.append(u));c.ejCheckBox({size:"small",value:"underline",change:n.proxy(this._processpreviewaction,this,"text-decoration")});l.ejCheckBox({size:"small",value:"line-through",change:n.proxy(this._processpreviewaction,this,"text-decoration")});n("#"+i+"_colorpick").ejColorPicker({value:"#278787",modelType:"palette",cssClass:"e-spreadsheet",open:n.proxy(this._colorPickerHandler,this,i.split("_")[1]+"_colorpick"),change:n.proxy(this._processpreviewaction,this,"color")});n("#"+i+"_colorpick_popup").find(".e-buttons").hide();n("#"+i+"_colorpick_Presets").width(118);a.ejButton({text:r._getLocStr("defaultfont"),showRoundedCorner:!0,width:60,click:n.proxy(this._processpreviewaction,this,"default")});rt=[{text:r._getLocStr("Regular"),value:"normal"},{text:r._getLocStr("Italic"),value:"italic"},{text:r._getLocStr("Bold"),value:"bold"},{text:r._getLocStr("BoldItalic"),value:"italic"}];n("#"+r._id+"_font_flist").ejListBox(this._listObj(this._fontFamily,"175px","font-family"));n("#"+r._id+"_font_fStylelist").ejListBox(this._listObj(rt,"150px","font-style"));n("#"+r._id+"_font_fSizelist").ejListBox(this._listObj(this._fontSize,"150px","font-size"))},_renderBorderTab:function(){var r=this.XLObj,i=r._id+"_border",ct=t.buildTag("div#"+i+"_content"),l=t.buildTag("table"),lt=t.buildTag("tr"),at=t.buildTag("tr"),a,v,y,p,w,e,b,k,d,g,nt,tt,it,rt,ut,o,s,ft,et,ot,st,ht,h,u,f,c;k=t.buildTag("ul#"+i+"_linestyles");d=t.buildTag("div#"+i+"_styles",t.buildTag("label").text(r._getLocStr("style"))).append(k);e=t.buildTag("td",t.buildTag("label#"+i+"_lblborderTxt1",r._getLocStr("line")),{"padding-left":"45px"},{rowspan:"2"});b=t.buildTag("div#"+i+"_colorContainer",t.buildTag("label#"+i+"_lblcolorTxt1",r._getLocStr("color")),{"padding-top":"26px"}).append("<br />",t.buildTag("input#"+i+"_colorpick","",{width:"174px"},{type:"text"}));e.append(d,b);w=t.buildTag("button#"+i+"_none","",{padding:"5px 5px"});p=t.buildTag("button#"+i+"_outside","",{padding:"5px 6px"});y=t.buildTag("button#"+i+"_allside","",{padding:"5px 6px"});v=t.buildTag("table",t.buildTag("tr").append(t.buildTag("td",w,{"padding-right":"12px","padding-left":"27px","text-align":"center"}).append("<br />",r._getLocStr("none")),t.buildTag("td",p,{"padding-right":"12px","text-align":"center"}).append("<br />",r._getLocStr("outline","",{"text-align":"center"})),t.buildTag("td",y,{"padding-right":"12px","text-align":"center"}).append("<br />",r._getLocStr("allside"))));a=t.buildTag("td",t.buildTag("label#"+i+"_lblborderTxt2",r._getLocStr("presets")),{"padding-right":"22px"}).append(v);u={type:"checkbox"};f={"margin-bottom":"5px"};ht=t.buildTag("div",t.buildTag("input#"+i+"_topbroder","",{},u),f);st=t.buildTag("div",t.buildTag("input#"+i+"_leftbroder","",{},u),f);ot=t.buildTag("div",t.buildTag("input#"+i+"_rightbroder","",{},u),f);et=t.buildTag("div",t.buildTag("input#"+i+"_bottombroder","",{},u),f);ft=t.buildTag("td").append(ht,st,ot,et);o=t.buildTag("table#"+i+"_outlinepreview","",{height:"28px",width:"117px"});h=t.buildTag("td","Text");s=t.buildTag("tr","",{"line-height":"40px","text-align":"center"}).append(h.clone(),h);o.append(s.clone(),s);ut=t.buildTag("div","",{height:"9px","margin-top":"6px"}).append(t.buildTag("span.e-toppreview"),t.buildTag("span.e-toprightpreview"));rt=t.buildTag("div","",{height:"15px"}).append(t.buildTag("span.e-bottompreview"),t.buildTag("span.e-bottompreviewright"));it=t.buildTag("div#"+i+"_previewpanel.e-borderpreviewpanel").append(ut,t.buildTag("div#"+i+"_preview.e-borderpreview",t.buildTag("label#"+i+"_previewtext","Text")).append(o),rt);tt=t.buildTag("td",it);nt=t.buildTag("table",t.buildTag("tr").append(ft,tt));g=t.buildTag("td",t.buildTag("label#"+i+"_lblborderTxt3",r._getLocStr("border"))).append(nt);l.append(lt.append(a,e),at.append(g));n("#"+r._id+"_border").append(ct.append(l));n("#"+i+"_linestyles").ejListBox({dataSource:[{text:"none",value:"none"},{text:"solid",value:"solid"},{text:"dashed",value:"dashed"},{text:"dotted",value:"dotted"}],template:'<div style="height: 10px"><div style="border:1px ${value} black; margin-top: 7px;"><\/div><\/div>',height:"120px",width:"175px"});n("#"+i+"_colorpick").ejColorPicker({value:"#000000",open:n.proxy(this._colorPickerHandler,this,i.split("_")[1]+"_colorpick"),change:n.proxy(this._processpreviewaction,this,"border-color"),modelType:"palette",cssClass:"e-spreadsheet"});n("#"+i+"_colorpick_popup").find(".e-buttons").hide();n("#"+i+"_colorpick_Presets").width(118);n("#"+i+"_none").ejButton(this._buttonObj("e-ss-noborderdlg","none"));n("#"+i+"_outside").ejButton(this._buttonObj("e-ss-outsideborderdlg","border"));n("#"+i+"_allside").ejButton(this._buttonObj("e-ss-allborderdlg","allside"));n("#"+i+"_topbroder").ejToggleButton(this._toggleBtnObj("e-ss-topborderdlg","border-top"));n("#"+i+"_leftbroder").ejToggleButton(this._toggleBtnObj("e-ss-leftborderdlg","border-left"));n("#"+i+"_rightbroder").ejToggleButton(this._toggleBtnObj("e-ss-rightborderdlg","border-right"));n("#"+i+"_bottombroder").ejToggleButton(this._toggleBtnObj("e-ss-bottomborderdlg","border-bottom"));c=n("#"+r._id+"_border_linestyles").data("ejListBox");c.element.find("li").eq(0).text("None");c.option("selectedItemIndex",1)},_toggleBtnObj:function(t,i){return{size:"normal",contentType:"imageonly",defaultPrefixIcon:t,click:n.proxy(this._processborderaction,this,i)}},_buttonObj:function(t,i){return{width:"35px",height:"35px",contentType:"imageonly",prefixIcon:t,click:n.proxy(this._processborderaction,this,i)}},_renderFillTab:function(){var r=this.XLObj,i=r._id+"_fill",h=t.buildTag("div#"+i+"_content","",{"margin-left":-9}),u=t.buildTag("table"),c=t.buildTag("tr"),f,e,o,s;f=t.buildTag("input#"+i+"_nocolor","",{},{type:"checkbox"});e=t.buildTag("td",t.buildTag("label#"+i+"_lblbgcolorTxt1",r._getLocStr("backgroundcolor"))).append(f,t.buildTag("div#"+i+"_colorpick","",{"margin-top":"10px"}));o=t.buildTag("div#"+i+"_viewpanel.e-dlgviewpanel","",{width:"310px"});s=t.buildTag("td",t.buildTag("label#"+i+"_lblpreviewTxt1",r._getLocStr("preview")),{"padding-left":"10px","padding-bottom":"160px"}).append(o);u.append(c.append(e,s));n("#"+r._id+"_fill").append(h.append(u));n("#"+i+"_colorpick").ejColorPicker({displayInline:!0,modelType:"palette",presetType:"basic",cssClass:"e-spreadsheet",change:n.proxy(this._processpreviewfillaction,this,"background-color")});n("#"+i+"_colorpick_popup").find(".e-buttons").hide().end().find(".e-footer").show();n("#"+i+"_colorpick_Presets").width(118);n("#"+i+"_nocolor").ejToggleButton({size:"normal",defaultText:"No Color",width:"175px",click:n.proxy(this._processpreviewfillaction,this,"nocolor")})},_initValDialog:function(){var i,r,u,f,e,o,s,h,n=this.XLObj;i=t.buildTag("div#"+n._id+"_ValDialog");r=t.buildTag("div#"+n._id+"_ValDialog_valDlgTab");o=t.buildTag("ul");h=t.buildTag("a","Settings",{},{href:"#"+n._id+"_Validation"});s=t.buildTag("li .e-tab",h);o.append(s);r.append(o);r.ejTab({width:276,height:300,cssClass:"e-ss-dlgtabval"});i.append(r);e=t.buildTag("div#"+n._id+"btnDiv.e-dtvalbtndiv");u=t.buildTag("input#"+n._id+"Dialog_OkBtn .e-conok");f=t.buildTag("input#"+n._id+"Dialog_CancelBtn .e-concancel");u.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._valDlgBtnClick,this,"ok"),enabled:!0});f.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._valDlgBtnClick,this,"cancel"),showRoundedCorner:!0,width:60});e.append(u).append(f);i.append(e);i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("DataValidation"),width:292,height:380,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_initCFDialog:function(){var n=this.XLObj,i,e,r,u,f;i=t.buildTag("div#"+n._id+"_CFDialog");n.element.append(i);e=t.buildTag("div#"+n._id+"_CondFormat","",{"margin-left":-2});i.append(e);f=t.buildTag("div#"+n._id+"cfBtnDiv.e-dlgbtndiv","",{margin:"10px -3px 3px"});r=t.buildTag("input#"+n._id+"cfDialog_OkBtn .e-conok");u=t.buildTag("input#"+n._id+"cfDialog_CancelBtn .e-concancel");r.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgCFOk,this),enabled:!0});u.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._dlgCFCancel,this),showRoundedCorner:!0,width:60});f.append(r).append(u);i.append(f);i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("ConditionalFormat"),width:275,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_initHLDialog:function(){var n=this.XLObj,i,r,u,f,e,o,s,h;i=t.buildTag("div#"+n._id+"_HLDialog");r=t.buildTag("div#"+n._id+"_HLDialogTab.e-valdlgtab");u=t.buildTag("ul");e=t.buildTag("a",n._getLocStr("WebPage"),{},{href:"#"+n._id+"_Web"});f=t.buildTag("li",e);u.append(f);e=t.buildTag("a",n._getLocStr("WorkSheet"),{},{href:"#"+n._id+"_Doc"});f=t.buildTag("li",e);u.append(f);r.append(u);r.ejTab({width:330,itemActive:t.proxy(this._hlTabChange,this),cssClass:"e-ss-dlgtab"});i.append(r);o=t.buildTag("div#"+n._id+"hlBtnDiv.e-ss-hlbtndiv","",{float:"right",margin:"6px -7px -1px"});s=t.buildTag("input#"+n._id+"hlDialog_OkBtn .e-conok");h=t.buildTag("input#"+n._id+"hlDialog_CancelBtn .e-concancel");s.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgHLOk,this),enabled:!0});h.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._dlgHLCancel,this),showRoundedCorner:!0,width:60});o.append(s).append(h);i.append(o);i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("InsertHyperLink"),width:345,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_initFRDialog:function(){var n=this.XLObj,f,e,o,s,h,c,u,i,r,l,a;f=t.buildTag("div#"+n._id+"_FRDialog");e=t.buildTag("div#"+n._id+"_FRDialog_FPDlgTab.e-valdlgtab");u=t.buildTag("ul");r=t.buildTag("a",n._getLocStr("Find"),{},{href:"#"+n._id+"_Find"});i=t.buildTag("li .e-tab",r);u.append(i);r=t.buildTag("a",n._getLocStr("Replace"),{},{href:"#"+n._id+"_Replace"});i=t.buildTag("li.e-tab",r);u.append(i);r=t.buildTag("a",n._getLocStr("Settings"),{},{href:"#"+n._id+"_Settings"});i=t.buildTag("li.e-tab",r);u.append(i);e.append(u);e.ejTab({width:367,height:110,itemActive:t.proxy(this._findTabChange,this),cssClass:"e-ss-dlgtab"});f.append(e);c=t.buildTag("div#"+n._id+"btnFRDiv.e-dlgbtndiv");l=t.buildTag("input#"+n._id+"FR_ReplaceBtn .e-conok");a=t.buildTag("input#"+n._id+"FR_ReplaceAllBtn .e-conok");o=t.buildTag("input#"+n._id+"FR_NextBtn .e-conok");s=t.buildTag("input#"+n._id+"FR_PrevBtn .e-conok");h=t.buildTag("input#"+n._id+"FR_CloseBtn .e-concancel");l.ejButton({text:n._getLocStr("Replace"),showRoundedCorner:!0,width:50,height:17,click:t.proxy(this._btnFROnClick,this,"FR_ReplaceBtn"),enabled:!0}).css("display","none");a.ejButton({text:n._getLocStr("ReplaceAll"),showRoundedCorner:!0,width:64,height:17,click:t.proxy(this._btnFROnClick,this,"FR_ReplaceAllBtn"),enabled:!0}).css("display","none");o.ejButton({text:n._getLocStr("FindNext"),showRoundedCorner:!0,width:59,height:17,click:t.proxy(this._btnFROnClick,this,"FR_NextBtn"),enabled:!0});s.ejButton({text:n._getLocStr("FindPrev"),showRoundedCorner:!0,width:59,height:17,click:t.proxy(this._btnFROnClick,this,"FR_PrevBtn"),enabled:!0});h.ejButton({text:n._getLocStr("Close"),click:t.proxy(this._btnFROnClick,this,"FR_CloseBtn"),showRoundedCorner:!0,width:47,height:17});c.append(l).append(a).append(o).append(s).append(h);f.append(c);f.ejDialog({showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("FindnReplace"),width:383,height:194,cssClass:"e-ss-dialog e-ss-frdlg",close:t.proxy(this._dialogClose,this)})},_initGoToDialog:function(){var n=this.XLObj,i,r,o,u,f,e,s,h;i=t.buildTag("div#"+n._id+"_GoDialog");r=t.buildTag("div#"+n._id+"_GoToDlgTab.e-valdlgtab");u=t.buildTag("ul");e=t.buildTag("a",n._getLocStr("GoTo"),{},{href:"#"+n._id+"_GoTo"});f=t.buildTag("li .e-tab",e);u.append(f);e=t.buildTag("a",n._getLocStr("GoTo")+" "+n._getLocStr("Special"),{},{href:"#"+n._id+"_GoToSp"});f=t.buildTag("li.e-tab",e);u.append(f);r.append(u);r.ejTab({width:302,height:340,itemActive:t.proxy(this._gotoTabChange,this),cssClass:"e-ss-dlgtab"});i.append(r);o=t.buildTag("div#"+n._id+"btnDiv.e-dlgbtndiv");i.append(o);s=t.buildTag("input#"+n._id+"Dialog_GoOkBtn .e-conok");h=t.buildTag("input#"+n._id+"Dialog_GoCancelBtn .e-concancel");s.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:60,height:20,click:t.proxy(this._gotoBtnClick,this,"ok")});h.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._gotoBtnClick,this,"cancel"),height:20,showRoundedCorner:!0,width:60});o.append(s).append(h);n.element.append(i);i.ejDialog({showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("GoTo"),width:318,height:420,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_dialogClose:function(){this.XLObj.setSheetFocus()},_beforeDlgClose:function(t){var i=n("#"+this.XLObj._id+"_nmgrid_dialogEdit_overLay");i.length&&(t.cancel=!0)},_setButtonHeights:function(){this._smallBtnHeight=25;this._mediumBtnHeight=35;this._bigBtnHeight=75;this._splitBtnHeight=75;this._drpDownHeight=25},_homeTabObj:function(){var i,n=this.XLObj,f="imagetop",u={},r=n._id,e=n.model;(n.model.allowMerging||n.model.allowWrap||n.model.allowCellFormatting||n.model.allowFormatAsTable||n.model.allowConditionalFormats||n.model.allowUndoRedo||n.model.allowClipboard||n.model.allowEditing)&&(u={id:"home",text:"HOME",groups:[]});n.getObjectLength(u)>0&&(n.model.allowClipboard&&(i={text:"Clipboard",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("pastebtn","paste","textandimage","e-icon e-ssr-paste",45,this._mediumBtnHeight,"PasteTitle","PasteContent",!1,f),this._generateSplitBtn("pastesbtn","Paste","textandimage",r+"_Ribbon_Paste",{dataSource:this._pasteMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,45,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-pastesbtn","PasteTitle","PasteSplitContent")]},{groups:[this._generateBtn("cut","Cut","textandimage","e-icon e-ssr-cut",58,this._smallBtnHeight,"CutTitle","CutContent"),this._generateBtn("copy","Copy","textandimage","e-icon e-ssr-copy",67,this._smallBtnHeight,"CopyTitle","CopyContent"),n.model.allowFormatPainter&&this._generateToggleBtn("formatpainter","FormatPainter","textandimage","e-icon e-ss-formatpainter","FPTitle",110,this._smallBtnHeight,"FPContent")]}]},u.groups.push(i)),n.model.allowCellFormatting&&(i={text:"Font",alignType:t.Ribbon.alignType.rows,enableGroupExpander:!0,content:[{groups:[this._generateDD("font-family","FontFamily",this._fontFamily,"1",150,this._smallBtnHeight,"FontFamily","FFContent"),this._generateDD("fontsize","FontSize",this._fontSize,"8px",65,this._smallBtnHeight,"FontSize","FSContent"),this._generateBtn("increasefontsize","IncreaseFontSize","imageonly","e-icon e-ss-increasefontsize","",this._smallBtnHeight,"IncreaseFontSize","IFSContent"),this._generateBtn("decreasefontsize","DecreaseFontSize","imageonly","e-icon e-ss-decreasefontsize","",this._smallBtnHeight,"DecreaseFontSize","DFSContent")]},{groups:[this._generateToggleBtn("bold","Bold","imageonly","e-icon e-ss-bold","BoldTitle","",this._smallBtnHeight,"BoldContent"),this._generateToggleBtn("italic","Italic","imageonly","e-icon e-ss-italic","ItalicTitle","",this._smallBtnHeight,"ItalicContent"),this._generateToggleBtn("underline","Underline","imageonly","e-icon e-ss-underline","ULineTitle","",this._smallBtnHeight,"ULineContent"),this._generateToggleBtn("line-through","Linethrough","imageonly","e-icon e-ss-linethrough","LineTrTitle",25,this._smallBtnHeight,"LineTrContent",!0),this._generateSplitBtn("border","Border","imageonly",r+"_Ribbon_Border",{dataSource:this._borderMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-bottomborder",!0,50,this._smallBtnHeight,"","","","","Border","BorderContent"),this._generateCustomControl(r+"_Ribbon_background-color","BackgroundColor","BackgroundColor","BGContent"),this._generateCustomControl(r+"_Ribbon_color","Color","Color","ColorContent")]}]},u.groups.push(i)),(n.model.allowMerging||n.model.allowWrap)&&(i={text:"Alignment",alignType:t.Ribbon.alignType.rows,enableGroupExpander:!0,content:[{groups:[this._generateToggleBtn("left","AlignLeft","imageonly","e-icon e-ss-alignleft","AlignLeft","","","AlignLeftContent"),this._generateToggleBtn("center","AlignCenter","imageonly","e-icon e-ss-aligncenter","AlignCenter","","","AlignCenterContent"),this._generateToggleBtn("right","AlignRight","imageonly","e-icon e-ss-alignright","AlignRight","","","AlignRightContent"),this._generateToggleBtn("justify","Justify","imageonly","e-icon e-ss-alignjustify","Justify","","","JustifyContent"),this._generateSplitBtn("merge","MergeAndCenter","textandimage",r+"_Ribbon_Merge",{dataSource:this._mergeMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-merge",!1,136,25,"right","","","e-spreadsheet e-mergebtn","MergeAndCenter","MergeAndCenterContent")]},{groups:[this._generateToggleBtn("top","TopAlign","imageonly","e-icon e-ss-topalign","TopAlign","","","TopAlignContent"),this._generateToggleBtn("middle","MiddleAlign","imageonly","e-icon e-ss-middlealign","MiddleAlign","","","MiddleAlignContent"),this._generateToggleBtn("bottom","BottomAlign","imageonly","e-icon e-ss-bottomalign","BottomAlign","","","BottomAlignContent"),this._generateBtn("decreaseindent","DecreaseIndent","imageonly","e-icon e-ss-outdent","","","DecreaseIndent","DecreaseIndentContent"),this._generateBtn("increaseindent","IncreaseIndent","imageonly","e-icon e-ss-indent","","","IncreaseIndent","IncreaseIndentContent"),this._generateToggleBtn("wraptext","WrapText","textandimage","e-icon e-ss-wraptext","WrapText",80,25,"WrapTextContent")]}]},u.groups.push(i)),n.model.allowUndoRedo&&(i={text:"Actions",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("undo","Undo","textandimage","e-ss-undo",40,this._bigBtnHeight,"UndoTitle","UndoContent",!1,f,""),this._generateBtn("redo","Redo","textandimage","e-ss-redo",40,this._bigBtnHeight,"RedoTitle","RedoContent",!1,f,"")]}]},u.groups.push(i)),n.model.allowCellFormatting&&(i={text:"Number",alignType:t.Ribbon.alignType.rows,enableGroupExpander:!0,content:[{groups:[n.model.allowCellFormatting&&this._generateDD("cellformat","NumberFormat",this._numberFormat,"1",125,this._smallBtnHeight,"NumberFormat","NumberFormatContent")]},{groups:[this._generateBtn("accounting","AccountingStyle","imageonly","e-icon e-ss-accounting","",this._smallBtnHeight,"AccountingStyle","AccountingStyleContent"),this._generateBtn("percentage","PercentageStyle","imageonly","e-icon e-ss-percentage","",this._smallBtnHeight,"PercentageStyle","PercentageStyleContent"),this._generateBtn("usegrouping","CommaStyle","imageonly","e-icon e-ss-comma","",this._smallBtnHeight,"CommaStyle","CommaStyleContent"),e.formatSettings.allowDecimalPlaces&&this._generateBtn("increment","IncreaseDecimal","imageonly","e-icon e-ss-increasedecimal","",this._smallBtnHeight,"IncreaseDecimal","IncreaseDecimalContent"),e.formatSettings.allowDecimalPlaces&&this._generateBtn("decrement","DecreaseDecimal","imageonly","e-icon e-ss-decreasedecimal","",this._smallBtnHeight,"DecreaseDecimal","DecreaseDecimalContent")]}]},u.groups.push(i)),(n.model.allowFormatAsTable||n.model.allowConditionalFormats)&&(i={text:"Styles",alignType:t.Ribbon.alignType.rows,content:[{groups:[e.allowConditionalFormats&&this._generateSplitBtn("cFormat","ConditionalFormat","textandimage",r+"_CFormat","","e-icon e-ssr-condformat",!1,81,this._splitBtnHeight,"bottom",f,"dropdown","e-spreadsheet e-cformatbtn","ConditionalFormat","CFContent"),this._generateSplitBtn("formatastable","FormatAsTable","textandimage",r+"_formatastable","","e-icon e-ssr-formatastable",!1,65,this._splitBtnHeight,"bottom",t.ImagePosition.ImageTop,"dropdown","e-spreadsheet e-formatastablebtn","FormatAsTable","FATContent"),this._generateSplitBtn("cellstyles","CellStyles","textandimage",r+"_cellstyles","","e-icon e-ssr-cellstyles",!1,56,this._splitBtnHeight,"bottom",t.ImagePosition.ImageTop,"dropdown","e-spreadsheet e-cellstylebtn","CellStyles","CellStylesContent")]}]},u.groups.push(i)),n.model.allowEditing&&(i={text:"Editing",alignType:t.Ribbon.alignType.columns,content:[{groups:[n.model.allowSorting&&n.model.allowFiltering&&this._generateSplitBtn("sortfilter","SortFilter","textandimage",r+"_Ribbon_SortFilter",{dataSource:this._sortFltrMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-sortfilter",!1,60,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-sortfltrbtn","SortFilter","SortFilterContent")]},{groups:[this._generateSplitBtn("autosum","AutoSum","textandimage",r+"_Ribbon_AutoSum",{dataSource:this._autosumMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-autosum",!1,100,35,"right","","dropdown","e-spreadsheet e-autosumbtn","AutoSumTitle","AutoSumContent"),this._generateSplitBtn("clear","Clear","textandimage",r+"_Ribbon_Clear",{dataSource:this._clearMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-clear",!1,80,35,"right","","dropdown","e-spreadsheet e-clearbtn","Clear","ClearContent")]}]},u.groups.push(i)),this._tabCollection.push(u))},_insertTabObj:function(){var i,n=this.XLObj,f="imagetop",r={},u=n._id;(n.model.allowFormatAsTable||n.model.pictureSettings.allowPictures||n.model.allowHyperlink||n.model.allowCharts)&&(r={id:"insert",text:"INSERT",groups:[]});n.getObjectLength(r)>0&&((n.model.allowFormatAsTable||n.model.allowPivotTable)&&(i={text:"Tables",alignType:t.Ribbon.alignType.rows,content:[{groups:[n.model.allowPivotTable&&this._generateBtn("pivotTable","PivotTable","textandimage","e-icon e-ssr-pivottable",65,this._bigBtnHeight,"PivotTable","PivotTableContent",!1,f),n.model.allowFormatAsTable&&this._generateBtn("table","Table","textandimage","e-icon e-ssr-table",50,this._bigBtnHeight,"Table","TableContent",!1,f)]}]},r.groups.push(i)),n.model.pictureSettings.allowPictures&&(i={text:"Illustrations",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("pictures","Pictures","textandimage","e-icon e-ssr-pictures",60,this._bigBtnHeight,"PicturesTitle","PicturesContent",!1,f,"")]}]},r.groups.push(i)),n.model.allowHyperlink&&(i={text:"Links",alignType:t.Ribbon.alignType.rows,content:[{groups:[n.model.allowHyperlink&&this._generateBtn("hyperlink","HyperLink","textandimage","e-icon e-ssr-hyperlink",60,this._bigBtnHeight,"HyperLinkTitle","HyperLinkContent",!1,f,"")]}]},r.groups.push(i)),n.model.allowCharts&&(i={text:"Charts",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("columnchart","ColumnChart","imageonly",u+"_Ribbon_ColumnChart","","e-icon e-ss-colchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","ColumnChartTitle","ColumnChartContent"),this._generateSplitBtn("barchart","BarChart","imageonly",u+"_Ribbon_BarChart","","e-icon e-ss-barchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","BarChartTitle","BarChartContent"),this._generateSplitBtn("stockchart","StockChart","imageonly",u+"_Ribbon_StockChart","","e-icon e-ss-stockchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","StockChartTitle","StockChartContent")]},{groups:[this._generateSplitBtn("linechart","LineChart","imageonly",u+"_Ribbon_LineChart","","e-icon e-ss-linechart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","LineChartTitle","LineChartContent"),this._generateSplitBtn("areachart","AreaChart","imageonly",u+"_Ribbon_AreaChart","","e-icon e-ss-areachart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","AreaChartTitle","AreaChartContent"),this._generateSplitBtn("piechart","PieChart","imageonly",u+"_Ribbon_PieChart","","e-icon e-ss-piechart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","PieChartTitle","PieChartContent")]},{groups:[this._generateSplitBtn("scatterchart","ScatterChart","imageonly",u+"_Ribbon_ScatterChart","","e-icon e-ss-scterchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","ScatterChartTitle","ScatterChartContent")]}]},r.groups.push(i)),this._tabCollection.push(r))},_dataTabObj:function(){var r,n=this.XLObj,i={};(n.model.allowFiltering||n.model.allowSorting||n.model.allowDataValidation)&&(i={id:"data",text:"DATA",groups:[]});n.getObjectLength(i)>0&&((n.model.allowFiltering||n.model.allowSorting)&&(r={text:"Sort & Filter",alignType:t.Ribbon.alignType.columns,content:[{groups:[n.model.allowSorting&&this._generateBtn("sortAtoZ","SortAtoZ","textandimage","e-icon e-ssr-sortatoz",90,this._smallBtnHeight,"SortAtoZ","SortAtoZContent",!1,"","e-datapadding"),n.model.allowSorting&&this._generateBtn("sortZtoA","SortZtoA","textandimage","e-icon e-ssr-sortztoa",90,this._smallBtnHeight,"SortZtoA","SortZtoAContent",!1,"","e-datapadding")]},{groups:[this._generateBtn("filter","Filter","textandimage","e-icon e-ssr-filter",60,this._smallBtnHeight,"Filter","FilterContent",!1,"","e-datapadding"),this._generateBtn("clearfilter","ClearFilter","textandimage","e-icon e-ss-clearfilter",90,this._smallBtnHeight,"ClearFilter","ClearFilterContent",!1,"","e-datapadding")]}]},i.groups.push(r)),n.model.allowDataValidation&&(r={text:"",alignType:t.Ribbon.alignType.columns,content:[{groups:[n.model.allowDataValidation&&this._generateBtn("validationbtn","Validation","imageonly","e-icon e-ssr-validation",60,this._mediumBtnHeight,"DataValidation","DVContent",!1,"imagetop"),n.model.allowDataValidation&&this._generateSplitBtn("validationsbtn","DataValidation","textandimage",n._id+"_Ribbon_Validation",{dataSource:this._valMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,67,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-validationsbtn","DataValidation","DVContent")]}]},i.groups.push(r)),this._tabCollection.push(i))},_pageTabObj:function(){var i,n=this.XLObj,u="imagetop",r={};(n.model.printSettings.allowPageSetup||n.model.printSettings.allowPageSize||n.model.printSettings.allowPrinting)&&(r={id:"pagelayout",text:"PAGE LAYOUT",groups:[]});n.getObjectLength(r)>0&&(n.model.printSettings.allowPageSetup&&(i={text:"Sheet Options",alignType:t.Ribbon.alignType.rows,content:[{groups:[{contentID:n._id+"_Ribbon_pagesetupleft",toolTip:"Print",enableSeparator:!0,type:t.Ribbon.type.custom,height:80},{contentID:n._id+"_Ribbon_pagesetupright",toolTip:"Heading",enableSeparator:!0,type:t.Ribbon.type.custom,height:80}]}]},r.groups.push(i)),n.model.printSettings.allowPageSize&&(i={text:"PageSize",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("sizebtn","size","imageonly","e-icon e-ssr-pagesize",65,44,"size","PageSizeContent",!1,u,""),this._generateSplitBtn("sizesbtn","PageSize","textandimage",n._id+"_Ribbon_PageSize",{dataSource:this._pageSizes,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,65,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-pagesizesbtn","PageSize","PageSizeContent")]}]},r.groups.push(i)),n.model.printSettings.allowPrinting&&(i={text:"Print",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("print","Print","textandimage","e-icon e-ssr-print",50,this._bigBtnHeight,"Print","PrintContent",!1,u,"")]},{groups:[this._generateBtn("printselected","PrintSelected","textandimage","e-icon e-ssr-printselected",60,this._bigBtnHeight,"PrintSelected","PrintSelectedContent",!0,u,"")]}]},r.groups.push(i)),this._tabCollection.push(r))},_reviewTabObj:function(){var u,r=this.XLObj,n="imagetop",i={};r.model.allowComments&&(i={id:"review",text:"REVIEW",groups:[]});r.getObjectLength(i)>0&&(r.model.allowComments&&(u={text:"Comments",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("newComment","New","textandimage","e-icon e-ssr-newcmnt",60,this._bigBtnHeight,"NewCommentTitle","NewCommentContent",!1,n)]},{groups:[this._generateBtn("deleteComment","Delete","textandimage","e-icon e-ssr-deletecmnt",49,this._bigBtnHeight,"DeleteComment","DeleteCommentContent",!1,n)]},{groups:[this._generateBtn("previousComment","Previous","textandimage","e-icon e-ssr-previouscmnt",49,this._bigBtnHeight,"Previous","PreviousContent",!1,n)]},{groups:[this._generateBtn("nextComment","Next","textandimage","e-icon e-ssr-nextcmnt",49,this._bigBtnHeight,"Next","NextContent",!1,n)]},{groups:[this._generateBtn("showHideComment","ShowHide","textandimage","e-icon e-ssr-showhidecmnt",160,this._smallBtnHeight,"ShowHide","ShowHideContent",!1,"imageLeft","e-ssr-cmntcolbtn"),this._generateToggleBtn("showAllComments","ShowAll","textandimage","e-icon e-ssr-showallcmnt","ShowAll",155,this._smallBtnHeight,"ShowAllContent",!1,"e-ssr-cmntcolbtn")]}]},i.groups.push(u)),this._tabCollection.push(i))},_otherTabObj:function(){var i,n=this.XLObj,u="imagetop",r={},f=n._id,e=t.ContentType;(n.model.allowInsert||n.model.allowDelete||n.model.allowSearching||n.model.allowFreezing||n.model.allowFormulaBar)&&(r={id:"others",text:"OTHERS",groups:[]});n.getObjectLength(r)>0&&(n.model.allowFreezing&&(i={text:"Window",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("fPane","FreezePanes","textandimage",n._id+"_Ribbon_FPane",{dataSource:this._viewMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-frzpane",!1,60,this._splitBtnHeight,"bottom",u,"dropdown","e-spreadsheet e-fpanebtn","FreezePanes","FreezePanesContent")]}]},r.groups.push(i)),n.model.allowFormulaBar&&(i={text:n._getLocStr("Formula"),alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("namemanager","NameManager",e.TextAndImage,"e-icon e-ssr-namemngr",70,this._bigBtnHeight,"NameManager","NameManagerContent",!1,u,"")]},{groups:[this._generateBtn("definename","DefineName",e.TextAndImage,"e-icon e-ssr-definename",110,25,"DefineName","DefineNameContent"),this._generateSplitBtn("useinformula","UseInFormula","textandimage",n._id+"_nmuseinformula","","e-icon e-ssr-useformula",!1,110,25,t.ArrowPosition.Bottom,t.ImagePosition.ImageLeft,"dropdown","e-spreadsheet e-useinformulabtn","UseInFormula","UseInFormulaContent")]}]},r.groups.push(i)),(n.model.allowInsert||n.model.allowDelete)&&(i={text:"Cells",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("insbtn","Insert","imageonly","e-icon e-ssr-insert",45,40,"InsertTitle","InsertContent",!1,u),this._generateSplitBtn("inssbtn","Insert","textandimage",f+"_Ribbon_Ins",{dataSource:this._insertMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,45,this._mediumBtnHeight,"bottom","","dropdown","e-insertsbtn","InsertTitle","InsertSBContent")]},{groups:[this._generateBtn("delbtn","Delete","imageonly","e-icon e-ssr-delete",45,40,"DeleteTitle","DeleteContent",!1,u),this._generateSplitBtn("delsbtn","Delete","textandimage",f+"_Ribbon_Del",{dataSource:this._deleteMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,45,this._mediumBtnHeight,"bottom","","dropdown","e-deletesbtn","DeleteTitle","DeleteContent")]}]},r.groups.push(i)),n.model.allowSearching&&(i={text:"Editing",alignType:t.Ribbon.alignType.rows,content:[{groups:[n.model.allowSearching&&this._generateSplitBtn("find","FindSelect","textandimage",f+"_Ribbon_FindRep",{dataSource:this._findMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-findselect",!1,61,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-findbtn","FindSelectTitle","FindSelectContent")]}]},r.groups.push(i)),this._tabCollection.push(r))},_renderRibbon:function(){var l=this.XLObj,i=l._id,r=l.element,a=l.model,u,f,e,o,y,s,h,c,p,v;r.prepend(t.buildTag("div","","",{id:i+"_Ribbon"}));r.append(t.buildTag("ul","","",{id:i+"_Menu"}));this._renderChartTypeDialog();r.append(t.buildTag("input","","",{id:i+"_Ribbon_background-color",type:"text"}));r.append(t.buildTag("input","","",{id:i+"_Ribbon_BorderColor",type:"text"}));r.append(this._borderPicture());r.append(this._chartElementTag());a.allowConditionalFormats&&r.append(this._cFTag());r.append(this._renderFormatAsTable());r.append(l.XLRibbon._renderCellStyles());r.append(t.buildTag("ul","","",{id:i+"_Ribbon_FPane"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Merge"}));p="<input id="+i+'_chart type="text" style="display:none;"/>';r.append(p);this._renderNameManagerDlg();v=t.buildTag("div","",{width:"180",height:"80"},{id:i+"_Ribbon_chartsize"});u=t.buildTag("table");f=t.buildTag("tr");s=t.buildTag("tr");e=t.buildTag("td");o=t.buildTag("td");h=t.buildTag("td");c=t.buildTag("td");e.append(t.buildTag("label.e-icon e-ssr-chartheight","",{width:"25",height:"25",display:"visible"},{id:i+"_Ribbon_chartheightlbl"}));o.append(t.buildTag("input","",{type:"text"},{id:i+"_Ribbon_chartheight"}));f.append(e).append(o);h.append(t.buildTag("label.e-icon e-ssr-chartwidth","",{width:"25",height:"25",display:"visible"},{id:i+"_Ribbon_chartwidthlbl"}));c.append(t.buildTag("input","",{type:"text"},{id:i+"_Ribbon_chartwidth"}));s.append(h).append(c);u.append(f).append(s);v.append(u);r.append(v);var w=t.buildTag("div","",{width:"140",height:"80"},{id:i+"_Ribbon_pagesetup"}),b=t.buildTag("div","",{width:"70",height:"80",float:"left"},{id:i+"_Ribbon_pagesetupleft"}),k=t.buildTag("div","",{width:"60",height:"80",float:"right"},{id:i+"_Ribbon_pagesetupright"}),d=t.buildTag("label","",{width:"70",display:"visible"},{id:i+"_Ribbon_pagesetup_hdrlbl"}),g=t.buildTag("label","",{width:"60",display:"visible"},{id:i+"_Ribbon_pagesetup_grdlnlbl"});u=t.buildTag("table");f=t.buildTag("tr");s=t.buildTag("tr");e=t.buildTag("td");o=t.buildTag("td");h=t.buildTag("td");c=t.buildTag("td");var nt=t.buildTag("label.e-printhdrlbl","",{width:"40",display:"visible"},{id:i+"_Ribbon_pagesetup_printhdrlbl","for":i+"_Ribbon_Pheading"}),tt=t.buildTag("label.e-viewhdrlbl","",{width:"40",display:"visible"},{id:i+"_Ribbon_pagesetup_viewhdrlbl","for":i+"_Ribbon_Vheading"}),it=t.buildTag("input","","",{id:i+"_Ribbon_Pheading"}),rt=t.buildTag("input","","",{id:i+"_Ribbon_Vheading"});e.append(it);o.append(nt);f.append(e).append(o);h.append(rt);c.append(tt);s.append(h).append(c);u.append(s).append(f);b.append(d).append(u);var ut=t.buildTag("label.e-printlinlbl","",{width:"40"},{id:i+"_Ribbon_pagesetup_printgrdlnlbl","for":i+"_Ribbon_Pgridlines"}),ft=t.buildTag("label.e-viewlinlbl","",{width:"40"},{id:i+"_Ribbon_pagesetup_viewgrdlnlbl","for":i+"_Ribbon_Vgridlines"}),et=t.buildTag("input","","",{id:i+"_Ribbon_Pgridlines"}),ot=t.buildTag("input","","",{id:i+"_Ribbon_Vgridlines"});u=t.buildTag("table");f=t.buildTag("tr");e=t.buildTag("td");o=t.buildTag("td");s=t.buildTag("tr");h=t.buildTag("td");c=t.buildTag("td");e.append(et);o.append(ut);f.append(e).append(o);h.append(ot);c.append(ft);s.append(h).append(c);u.append(s).append(f);k.append(g).append(u);w.append(b).append(k);r.append(w);n("#"+i+"_Ribbon_pagesetup_grdlnlbl").text("Gridlines");n("#"+i+"_Ribbon_pagesetup_hdrlbl").text("Headings");n("#"+i+"_Ribbon_pagesetup_printhdrlbl").text("Print");n("#"+i+"_Ribbon_pagesetup_printgrdlnlbl").text("Print");n("#"+i+"_Ribbon_pagesetup_viewhdrlbl").text("View");n("#"+i+"_Ribbon_pagesetup_viewgrdlnlbl").text("View");r.append(t.buildTag("ul","","",{id:i+"_Ribbon_PageSize"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Paste"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_FindRep"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Validation"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Border"}));r.append(t.buildTag("input","","",{id:i+"_Ribbon_color",type:"text"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Clear"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_SortFilter"}));r.append(t.buildTag("ul","",{width:"auto"},{id:i+"_Ribbon_Ins"}));r.append(t.buildTag("ul","",{width:"auto"},{id:i+"_Ribbon_Del"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_ResetPic"}));r.append(this._chartType("ColumnChart",6,2,2,["column","stackingcolumn","stackingcolumn100","column","stackingcolumn","stackingcolumn100"]));r.append(this._chartType("BarChart",6,2,2,["bar","stackingbar","stackingbar100","bar","stackingbar","stackingbar100"]));r.append(this._chartType("StockChart",2,2,2,["radar","radar"]));r.append(this._chartType("LineChart",2,2,3,["line","line"]));r.append(this._chartType("AreaChart",3,3,3,["Area","stackingarea","stackingarea100"]));r.append(this._chartType("PieChart",3,3,4,["pie","pie","doughnut"]));r.append(this._chartType("ScatterChart",1,2,2,["scatter"]));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_AutoSum"}));this._renderDesignTab();this._renderFormatTab();this._homeTabObj();this._insertTabObj();this._dataTabObj();this._pageTabObj();this._reviewTabObj();this._otherTabObj();this._contextualTabObj();n("#"+i+"_Ribbon").ejRibbon({width:"100%",allowResizing:!0,applicationTab:{Type:"ApplicationMenu",itemID:i+"_Menu",menuSettings:{click:n.proxy(this._menuClickHandler),openOnClick:!0,fields:{dataSource:this._fileMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"}}},tabs:this._tabCollection,contextualTabs:this._contextualTabCollection,onTabClick:n.proxy(this._onTabClick,this),onTabSelect:n.proxy(this._onTabSelect,this),groupExpand:n.proxy(this._onGroupExpander,this),create:n.proxy(this._onControlCreated,this),onToggleButtonClick:n.proxy(this._onToggleButtonClick,this),onRibbonCollapse:n.proxy(this._onRibbonCollapse,this)});n("#"+i+"_bordercolor ul li").find("a").remove();n("#"+i+"_bordercolor ul li").append(n("#"+i+"_Ribbon_BorderColor_popup"));a.scrollSettings.isResponsive&&n("#"+i+"_Ribbon").ejRibbon("option",{allowResizing:!0});this._hideTabs();a.allowComments||l._setAllowComments(!1);y=t.SplitButton.prototype._documentClick;t.SplitButton.prototype._documentClick=function(t){n(t.target).is(".e-formatastable")||y.call(this,t)}},_renderFUpload:function(){var i=this.XLObj;i.element.append(t.buildTag("div","","",{id:i._id+"_file",style:"display:none"}));n("#"+i._id+"_file").ejUploadbox({dialogAction:{content:i.element},saveUrl:i.model.importSettings.importMapper,fileSelect:n.proxy(this._fileSelect),complete:n.proxy(this._changeImport),uploadName:"file",autoUpload:!0,showFileDetails:!1,error:n.proxy(i._importFailed,i)});n("#"+i._id+"_file_SelectButton").hide()},_contextualTabObj:function(){var r=this.XLObj,n=r._id,u="imagetop",i;r.model.allowFormatAsTable&&(i={backgroundColor:"#FCFBEB",borderColor:"#F2CC1C",tabs:[{id:"design",text:"Design",groups:[{text:"Properties",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_tableproperties"},{text:"Tools",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("resizetable","ResizeTable","textandimage","e-icon e-ssr-resizetable",130,this._smallBtnHeight,"ResizeTable","ResizeTableContent"),this._generateBtn("convertorange","ConvertToRange","textandimage","e-icon e-ssr-range",130,this._smallBtnHeight,"ConvertToRange","ConvertToRangeContent")]}]},{text:"Table Style Options",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_tablestyleoptions"}]}]},this._contextualTabCollection.push(i));r.model.allowCharts&&(i={backgroundColor:"#EAF6BD",borderColor:"#90AA3C",tabs:[{id:"cdesign",text:"Chart Design",groups:[{text:"ChartLayouts",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("cElement","AddChartElement","textandimage",n+"_Ribbon_CElement","","e-icon e-ssr-celements",!0,74,this._bigBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-chartlayoutbtn","AddChartElement","AddChartElementContent")]}]},{text:"Data",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("srcolumn","SwitchRowColumn","textandimage","e-icon e-ssr-srcolumn",75,this._bigBtnHeight,"SwitchRowColumn","SwitchRowColumnContent","","imagetop"),this._generateBtn("selectData","SelectData","textandimage","e-icon e-ssr-selectdata",75,this._bigBtnHeight,"SelectData","SelectDataContent",!1,u)]}]},{text:"Type",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("charttype","ChartType","textandimage","e-icon e-ssr-charttype",105,this._bigBtnHeight,"ChartType","ChartTypeContent",!1,u)]}]},{text:"Chart Themes",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateDD("chartTheme","ChartThemes",this._chartThemes,"1",160,this._smallBtnHeight,"ChartThemes","ChartThemesContent")]}]},{text:"Size",alignType:t.Ribbon.alignType.columns,content:[{groups:[{contentID:n+"_Ribbon_chartsize",toolTip:"print",enableSeparator:!0,type:t.Ribbon.type.custom,height:80}]}]}]}]},this._contextualTabCollection.push(i));r.model.pictureSettings.allowPictures&&(i={backgroundColor:"#FCFBEB",borderColor:"#F2CC1C",tabs:[{id:"format",text:"Format",groups:[{text:"Adjust",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("changepic","ChangePicture","textandimage","e-icon e-ssr-changepicture",120,this._mediumBtnHeight,"ChangePicture","ChangePictureContent"),this._generateSplitBtn("resetpic","ResetPicture","textandimage",n+"_Ribbon_ResetPic",{dataSource:this._resetPicture,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-resetpicture",!1,120,this._mediumBtnHeight,"left","","dropdown","e-ss-resetpictbtn","ResetPicture","ResetPictureContent")]}]},{text:"Border",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("pictureborder","PictureBorder","textandimage",n+"_Ribbon_PictureBorder","","e-icon e-ssr-pictureborder",!1,120,this._mediumBtnHeight,"left","","dropdown","e-ss-pictbrdrbtn","PictureBorder","PictureBorderContent")]}]},{text:"Size",alignType:t.Ribbon.alignType.columns,type:"custom",contentID:n+"_picturesize"}]}]},this._contextualTabCollection.push(i))},_onToggleButtonClick:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);this._ribbonState=!(t.action==="collapse");t.action==="expand"&&(t.action="tabClick",this._heightWidthCalculation(i.getActiveSheetIndex(),r,t))},_heightWidthCalculation:function(t,i,r){var f,u=this.XLObj,e=u.getActivationPanel(),o=e.is(":visible");i.width.toString().indexOf("%")!==-1&&(i.width=u.getMainPanel().width());u._isDisplayHeader?(f=n("#"+u._id+"_Ribbon").height(),u._isDisplayHeader=!1):f=r.action==="toggleBtn"?n("#"+u._id+"_Ribbon").height():this._ribbonState?n("#"+u._id+"_Ribbon").height()+u.element.find(".e-ribbon .e-content").eq(0).height():n("#"+u._id+"_Ribbon").height()-u.element.find(".e-ribbon .e-content").eq(0).height();u._setSheetWidthHeight(t,{width:o?i.width-u.model.apWidth:i.width,height:i.height},f,"resize");o&&e.height(u.getMainPanel().height())},_hideTabs:function(){for(var r=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("instance"),i=["","Design","Chart Design","Chart Format","Format"],t=i.length;t=t-1;)r.hideTab(i[t])},_renderDesignTab:function(){var n=this.XLObj,t="",i=n._getLocStr("TableStyleOptions").split("/");t="<div id="+n._id+'_tableproperties ><div class="e-tablepropetiesrow" ><div class="e-tablepropertiescell" >'+n._getLocStr("TableID")+'<\/div><div class="e-tablepropertiescell"><input id='+n._id+'_tableid style="width:80px; opacity:0.7" readonly /><\/div><\/div><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell">Table Name:<\/div><div class="e-tablepropertiescell"><input type="text" id='+n._id+'_tablename style="width:80px;opacity:0.7" readonly /><\/div><\/div><\/div>';t=t+"<div id="+n._id+'_tablestyleoptions ><div class="e-tablestyleoptionsrow" ><div class="e-tablestyleoptionscell"><input id='+n._id+'_Ribbon_tsofirstcolumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsofirstcolumn">'+i[0]+'<\/label><\/div><div class="e-tablestyleoptionscell" ><input id='+n._id+'_Ribbon_tsolastcolumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsolastcolumn">'+i[1]+'<\/label><\/div><\/div><div class="e-tablestyleoptionsrow" ><div class="e-tablestyleoptionscell"><input id='+n._id+'_Ribbon_tsototalrow type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsototalrow">'+i[2]+'<\/label><\/div><div class="e-tablestyleoptionscell" ><input id='+n._id+'_Ribbon_tsofiltercolumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsofiltercolumn">'+i[3]+"<\/label><\/div><\/div><\/div>";n.element.append(t)},_renderFormatTab:function(){var n=this.XLObj;n.element.append("<div id="+n._id+"_picturesize><table><tr><td>"+n._getLocStr("Height")+": <\/label><\/td><td><input id='"+n._id+"_pictureheight' type='text' /><\/td><\/tr><tr><td><labe>"+n._getLocStr("Width")+": <\/label><\/td><td><input id='"+n._id+"_picturewidth' type='text' /><\/td><\/tr><\/table><\/div>")},_renderNameManagerDlg:function(){var i=this.XLObj,r="<div id = '"+i._id+"_nmdlg' class='e-ssdlg e-nmdlg' ><div class='e-nmdlgcont' ><div id='"+i._id+"_nmgrid' class='ej-ssgrid' ><\/div><div><div class='e-nmdlgdiv'>"+i._getLocStr("Refersto")+":<input type='text' class='e-nmrange e-ejinputtext' id='"+i._id+"_nmrange'/><\/div><div class='e-nmclose' ><button id='"+i._id+"_nmclose' class='ej-ssbtn' >"+i._getLocStr("Close")+"<\/button><\/div><\/div><\/div><\/div>";r=r+"<div id='"+i._id+"_nmeditortemplate' class='e-hide' ><table><tr><td>"+i._getLocStr("Name")+":<\/td><td><input id='name' type='text' class='e-ejinputtext' value='{{: name}}'/><\/td><\/tr><tr><td>"+i._getLocStr("Scope")+":<\/td><td><input class='e-nmscope e-ejinputtext' id='scope' type='text' readonly value='Workbook'/><\/td><\/tr><tr><td>"+i._getLocStr("Comment")+":<\/td><td><textarea id='comment' value='{{: comment}}'>{{: comment}}<\/textarea><\/td><\/tr><tr><td>"+i._getLocStr("RefersTo")+":<\/td><td><input type='text' class='e-ejinputtext' id='refersto' value='{{: refersto}}' /><\/td><\/tr><\/table><\/div>";r=r+"<div id='"+i._id+"_nmuseinformula' class='e-nmuseinformula'><\/div>";i.element.append(r);n("#"+i._id+"_nmclose").ejButton({showRoundedCorner:!0,size:t.ButtonSize.Mini,click:n.proxy(this._nmdlgClose,i)});n("#"+i._id+"_nmgrid").ejGrid({dataSource:i.model.nameManager.slice(0),height:162,width:510,allowScrolling:!0,allowSorting:!0,enableAltRow:!1,cssClass:"e-ss-dialog",selectionType:t.Grid.SelectionType.Single,editSettings:{allowAdding:!0,editMode:t.Grid.EditMode.DialogTemplate,dialogEditorTemplateID:"#"+i._id+"_nmeditortemplate"},toolbarSettings:{showToolbar:!0,toolbarItems:[t.Grid.ToolBarItems.Add]},actionBegin:n.proxy(this._nmActionBegin,i),actionComplete:n.proxy(this._nmActionComplete,i),rowSelected:n.proxy(this._nmRecordSelected,i),contextMenuSettings:{enableContextMenu:!0,contextMenuItems:["Add Record"]},columns:[{field:"name",headerText:i._getLocStr("Name"),isPrimaryKey:!0,width:120},{field:"refersto",headerText:i._getLocStr("RefersTo"),width:120},{field:"scope",headerText:i._getLocStr("Scope"),width:80},{field:"comment",headerText:i._getLocStr("Comment"),width:160}]});n("#"+i._id+"_nmdlg").ejDialog({showOnInit:!1,title:i._getLocStr("NameManager"),enableModal:!0,enableResize:!1,width:"537px",cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this),beforeClose:t.proxy(this._beforeDlgClose,this)})},_updateNMRange:function(){var t=this.XLObj;n("#"+t._id+"_nmgridEditForm").find("#refersto").val("="+t._getDollarAlphaRange(t.getSheet(t.getActiveSheetIndex()).selectedRange,!0))},_nmdlgClose:function(){n("#"+this._id+"_nmdlg").ejDialog("close")},_nmRecordSelected:function(t){n("#"+this._id+"_nmdlg").find(".e-nmrange").val(t.data.refersto)},_nmActionBegin:function(n){var t=0,u=!1,f,e,r,i=this.getSheet(this.getActiveSheetIndex());if(n.requestType==="save"){if(r=n.data,r.name=r.name.toUpperCase(),r.sheetIndex=this._getSheetIdxFromName(n.data.refersto.split("!")[0].replace("=","")),n.cancel=!0,r.sheetIndex===-1){alert(this._getLocStr("InvalidSheetIndex"));return}if(i._nmEdit)for(e in i._nmValue){for(f=this.model.nameManager.length;t<f;){if(this.model.nameManager[t].name===i._nmValue.name){this.model.nameManager.splice(t,1);this._sheets[this.getActiveSheetIndex()]._calcEngine.removeNamedRange(i._nmValue.name);break}t++}for(t=this._formulaCollection.length;t--;)if(this._formulaCollection[t].display===i._nmValue.name){u=!0;this._formulaCollection.splice(t,1);break}if(u)break}this.XLRibbon._validateNamedRange(r.name,r.refersto)?n.cancel=!1:u&&this.model.nameManager.push(i._nmValue)}n.requestType==="beginedit"&&(i._nmEdit=!0,i._nmValue={name:n.model.dataSource[n.model.selectedRowIndex].name,refersto:n.model.dataSource[n.model.selectedRowIndex].refersto,comment:n.model.dataSource[n.model.selectedRowIndex].comment,sheetIndex:n.model.dataSource[n.model.selectedRowIndex].sheetIndex,scope:n.model.dataSource[n.model.selectedRowIndex].scope})},_nmActionComplete:function(t){var i=n("#"+this._id+"_nmgrid").ejGrid("instance"),r=t.requestType;switch(r){case"add":n("#"+this._id+"_nmgrid_dialogEdit").ejDialog("instance").model.open=n.proxy(this.XLRibbon._updateNMRange(),this);break;case"save":this.XLRibbon._addNamedRange(i,t.data.name,t.data.refersto);break;case"delete":this.XLRibbon._removeNamedRange(i,t.data.name)}},_updateNamedRanges:function(n,t){var i=this.XLObj;i._sheets[i.getActiveSheetIndex()]._calcEngine.addNamedRange(n,t.replace("=",""));i._formulaCollection.push({text:"="+n,display:n})},_updateUseInFormulaTrgt:function(){for(var i=0,t=this.XLObj,r="",e=n("#"+t._id+"_nmuseinformula"),u=t.model.nameManager,f=u.length;i<f;)r=r+"<div class='e-nmuseinformularow'>"+u[i].name+"<\/div>",i++;f?n("#"+t._id+"_Ribbon_useinformula").ejSplitButton("enable"):n("#"+t._id+"_Ribbon_useinformula").ejSplitButton("disable");e.html("<div>"+r+"<\/div>")},addNamedRange:function(i,r,u,f){var e=n("#"+this.XLObj._id+"_nmgrid").ejGrid("instance");t.isNullOrUndefined(i)||(i=i.toString().toUpperCase());this._validateNamedRange(i,r)&&(e.addRecord({name:i,refersto:r,comment:u?u:"",scope:"WorkBook",sheetIndex:f}),e.refreshContent())},_addNamedRange:function(t,i,r){var u=this.XLObj,f;u.model.nameManager=t.model.dataSource.slice(0);this._updateNamedRanges(i,r);this._updateUseInFormulaTrgt();u._isUndoRedo||(f={sheetIndex:u.getActiveSheetIndex(),reqType:"namemanager",action:"delete",name:i,refersTo:r},u.model.sheets[f.sheetIndex]._nmEdit&&(f.actionType="edit",f.value=n.extend(!0,{},u.model.sheets[f.sheetIndex]._nmValue),u.model.sheets[f.sheetIndex]._nmEdit=!1),u._completeAction(f))},removeNamedRange:function(i){var r=n("#"+this.XLObj._id+"_nmgrid").data("ejGrid");t.isNullOrUndefined(i)||(i=i.toString().toUpperCase());r.deleteRecord("name",{name:i})},_removeNamedRange:function(n,t){var r,u,i=this.XLObj,f=i.model.nameManager[i.model.nameManager.length-1],e;if(i.model.nameManager=n.model.dataSource.slice(0),u=i.model.nameManager,i._sheets[i.getActiveSheetIndex()]._calcEngine.removeNamedRange(t),i._updateFormulaCollection(),r=u.length,r)while(r--)i._formulaCollection.push({text:"="+u[r].name,display:u[r].name});this._updateUseInFormulaTrgt();i._isUndoRedo||(e={sheetIndex:i.getActiveSheetIndex(),reqType:"namemanager",action:"add",name:t,refersTo:f.refersto,comment:f.comment},i._completeAction(e))},_validateNamedRange:function(t,i){var u,f,o,e,s,r=this.XLObj;if(u=this._validateDollarRange(i),f=/^[a-zA-Z_]+$/.test(t)&&this._validateLibraryFunctions(t),o=this._validateNameManager(t),u&&f&&o)return!0;e=n("#"+r._id+"_alertdlg");s=u?f?r._getLocStr("NMUniqueNameAlert"):r._getLocStr("NMNameAlert").split("/")[0]:r._getLocStr("NMRangeAlert");r._renderAlertDlgContent(e,"Alert",s,"",272);e.ejDialog("open")},_validateLibraryFunctions:function(n){var i,r=[],u=(new CalcEngine).getLibraryFunctions();n=t.isNullOrUndefined(n)?"":n.toString().toUpperCase();for(i in u.items)r.push(i);for(i=r.length;i--;)if(r[i]===n)return!1;return!0},_validateNameManager:function(n){var i=0,r=this.XLObj.model.nameManager,u=r.length;for(n=t.isNullOrUndefined(n)?"":n.toString().toUpperCase();i<u;){if(r[i].name===n)return!1;i++}return!0},_validateDollarRange:function(n){try{if(n&&n.indexOf("!")>-1)return n=n.split("!")[1].replace(/\$/g,""),this.XLObj.getRangeIndices(n),!0}catch(t){return!1}},_renderFormatAsTable:function(){for(var y,l,c=this.XLObj,r=0,lt=[11,19],p=0,h="",w="",i="w:bold",u="c:#FFFFFF",t="c:#000000",b="c:#2F75B5",k="c:#ED7D31",d="c:#FFC000",f="1px solid #000000",e="1px solid #2f75b5",o="1px solid #ED7D31",s="1px solid #FFC000",g="b:#D9D9D9",a="b:#DDEBF7",nt="b:#FCE4D6",tt="b:#FFF2CC",ft="b:#000000",et="b:#DBECF6",it="b:#FFE2C6",rt="b:#FFF1BF",v="b:#000000",ot="b:#D7D7D7",st="b:#FFC000",ht="b:#5B9BD5",ut="hl?"+i+";"+t+";bo:tb-"+f+"&cl?"+g+";"+t+","+t+"&cb?b-"+f+"/hl?"+i+";bo:tb-"+e+";"+b+"&cl?"+a+";"+b+","+b+"&cb?b-"+e+"/hl?"+i+";bo:tb-"+o+";"+k+"&cl?"+nt+";"+k+","+k+"&cb?b-"+o+"/hl?"+i+";bo:tb-"+s+";"+d+"&cl?"+tt+";"+d+","+d+"&cb?b-"+s+"/hl?"+i+";"+ft+";"+u+";bo:o-"+f+"&cl?bo:t-"+f+";"+t+"&cb?o-"+f+"/hl?bo:o-"+e+";"+i+";"+ht+";"+u+"&cl?bo:t-"+e+";"+t+"&cb?o-"+e+"/hl?"+i+";b:#EB7E2F;"+u+";bo:o-"+o+"&cl?bo:t-"+o+";"+t+"&cb?o-"+o+"/hl?"+i+";"+st+";"+u+";bo:o-"+s+"&cl?bo:t-"+s+";"+t+"&cb?o-"+s+"/hl?"+i+";bo:gb-"+f+";"+t+"&cl?"+g+";"+t+","+t+"&cb?gb-"+f+"/hl?"+i+";bo:gb-"+e+";"+t+"&cl?"+a+";"+t+","+t+"&cb?gb-"+e+"/hl?"+i+";bo:gb-"+o+";"+t+"&cl?"+nt+";"+t+","+t+"&cb?gb-"+o+"/hl?"+i+";bo:gb-"+s+";"+t+"&cl?"+tt+";"+t+","+t+"&cb?gb-"+s+"/hl?"+i+";"+ft+";"+u+"&cl?b:#A6A6A6;"+t+","+g+";"+t+"/hl?"+i+";"+et+";"+u+"&cl?b:#BDD7EE;"+t+","+a+";"+t+"/hl?"+i+";"+it+";"+u+"&cl?b:#F8CBAD;"+t+","+nt+";"+t+"/hl?"+i+";"+rt+";"+u+"&cl?b:#FFE699;"+t+","+tt+";"+t+"/hl?"+i+";"+ot+";"+t+";bo:gb-"+f+"&cl?b:#A7A7A7;"+t+","+ot+";"+t+"&cb?gb-"+f+"/hl?"+i+";"+et+";"+t+";bo:gb-"+e+"&cl?b:#BED8F1;"+t+","+a+";"+t+"&cb?gb-"+e+"/hl?"+i+";"+it+";"+t+";bo:gb-"+o+"&cl?b:#F6CAAD;"+t+","+it+";"+t+"&cb?gb-"+o+"/hl?"+i+";"+rt+";"+t+";bo:gb-"+s+"&cl?b:#FDE18D;"+t+","+rt+";"+t+"&cb?gb-"+s+"/hl?"+i+";"+v+";"+u+"&cl?b:#404040;"+u+",b:#737373;"+u+"/hl?"+i+";"+v+";"+u+"&cl?b:#2F75B5;"+u+","+ht+";"+u+"/hl?"+i+";"+v+";"+u+"&cl?b:#C65911;"+u+",b:#ED7D31;"+u+"/hl?"+i+";"+v+";"+u+"&cl?b:#BF8F00;"+u+","+st+";"+u,ct=c._getLocStr("FATHeaderText").split("/"),at=c._getLocStr("FormatAsTableTitle").split("/"),vt=["Light1","Light2","Light3","Light5","Light8","Light9","Light10","Light12","Light15","Light16","Light17","Light19","Medium1","Medium2","Medium3","Medium5","Medium22","Medium23","Medium24","Medium26","Dark1","Dark2","Dark3","Dark5"],ut=ut.split("/");r<24;)h=h+c._renderDIV("e-formatastablecell",'<div class="e-ss-cellstyles-'+(r+1)+'" />'),r===lt[p]&&(p=p+1,h=h+"<\/br>"),r=r+1;for(r=0,h=h.split("<\/br>");r<ct.length*2;)w=w+c._renderDIV(r%2==0?"e-formatastableheader":"e-formatastablecontent",r%2==0?ct[r/2]:h[0]),r%2!=0&&h.shift(),r=r+1;for(y=n("<div id="+c._id+'_formatastable class="e-spreadsheet e-formatastable" style="display:none;box-shadow:3px 5px 15px #111111" >'+w+"<\/div>"),l=y.find(".e-formatastablecell"),r=0;r<l.length;)n(l[r]).data({format:this._getFormatAsTableInput(ut[r]),formatName:"TableStyle"+vt[r]}).attr("title",at[r]),r=r+1;return c.XLFormat._formatAsTableStyle=n(l[0]).data(),this._renderFATNameDlg(),this._renderChartNameDlg(),this._renderFATResizeTableDlg(),y},_renderFATNameDlg:function(){var r,i=this.XLObj,u=i._getLocStr("FATNameDlgText").split("/"),f={showRoundedCorner:!0,size:"mini",click:n.proxy(this._fatNameDlgBtnClick,this)};r="<div id="+i._id+'_fatnamedlg ><div class="e-fatnamedlgrow"><div class="e-fatnamedlgcell" style="width: 75px;" >'+u[0]+'<\/div><div class="e-fatnamedlgcell" ><input id="'+i._id+'_fatname" class="e-ejinputtext" style="width: 170px;" /><\/div><\/div><div class="e-fatnamedlgrow"><div class="e-fatnamedlgcell" ><\/div><div class="e-fatnamedlgcell" style="padding-left: 100px; margin-top: -24px; width: 152px;" ><input type="checkbox" id="'+i._id+'_fatheader" style="margin-right: 3px;" /> <label for="'+i._id+'_fatheader">'+u[1]+'<\/label><\/div><\/div><div style="margin-left:135px" class="e-fatnamedlgrow"><div class="e-fatnamedlgbtn" style="margin-right: 15px;"><button id='+i._id+'_fatnamedlgok style="margin-left:-7px">'+i._getLocStr("Ok")+'<\/button><\/div><div class="e-fatnamedlgbtn"><button id='+i._id+"_fatnamedlgcancel>"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(r);n("#"+i._id+"_fatnamedlgok").ejButton(f);n("#"+i._id+"_fatnamedlgcancel").ejButton(f);n("#"+i._id+"_fatnamedlg").ejDialog({showOnInit:!1,width:"286px",showRoundedCorner:!0,title:i._getLocStr("FormatAsTable"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_renderChartNameDlg:function(){var r,i=this.XLObj,f=i._getLocStr("ChartTitleDlgText"),u={showRoundedCorner:!0,size:"mini",click:n.proxy(this._chartNameDlgBtnClick,this)};r="<div id="+i._id+'_chartnamedlg ><div class="e-chartnamedlgrow"><div class="e-chartnamedlgcell" style="width: 75px;" >'+f+'<\/div><div class="e-chartnamedlgcell" ><input id="'+i._id+'_chartname" style="width: 215px;" /><\/div><\/div><div class="e-chartnamedlgrow"><div class="e-chartnamedlgbtn"><table class="e-ss-chrttitle"><tr><td style="padding-right:8px"><button id='+i._id+"_chartnamedlgok >"+i._getLocStr("Ok")+"<\/button><\/td><td><button id="+i._id+"_chartnamedlgcancel>"+i._getLocStr("Cancel")+"<\/button><\/td><\/tr><\/table><\/div><\/div>";i.element.append(r);n("#"+i._id+"_chartnamedlgok").ejButton(u);n("#"+i._id+"_chartnamedlgcancel").ejButton(u);n("#"+i._id+"_chartnamedlg").ejDialog({showOnInit:!1,width:"338px",showRoundedCorner:!0,title:i._getLocStr("ChartTitle"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_renderFATResizeTableDlg:function(){var i=this.XLObj,r={showRoundedCorner:!0,size:"mini",click:n.proxy(this._fatResizeTableBtnClick,this)},u="<div id="+i._id+'_fatresizetabledlg ><div class="e-fatresizetablerow"><div class="e-fatresizetablecell" >'+i._getLocStr("FATResizeTableText")+'<\/div><div class="e-fatresizetablecell" ><input id="'+i._id+'_fatresizetablerange" class="e-ejinputtext" style="width: 234px;"><\/div><\/div><div class="e-fatresizetablerow">'+i._getLocStr("FATReizeTableNote")+'<\/div><div style="height: 32px;" class="e-fatresizetablerow"><div class="e-fatresizetablebtn"><button id='+i._id+"_fatresizetabledlgok >"+i._getLocStr("Ok")+'<\/button><\/div><div class="e-fatresizetablebtn"><button id='+i._id+"_fatresizetabledlgcancel >"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(u);n("#"+i._id+"_fatresizetabledlgok").ejButton(r);n("#"+i._id+"_fatresizetabledlgcancel").ejButton(r);n("#"+i._id+"_fatresizetabledlg").ejDialog({showOnInit:!1,width:"494px",showRoundedCorner:!0,title:i._getLocStr("ResizeTable"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_renderCustFATDlg:function(){for(var i=this.XLObj,r=0,o,f="<div id="+i._id+"_custfatdlg >",s=i._getLocStr("CustFATPropText").split("/"),e={showRoundedCorner:!0,size:"mini",click:n.proxy(this._customFormatAsTableHandler),cssClass:"e-ss-tablestyle"},u=["tablename","headerLayout","contentLayout0","contentBorder"];r<s.length;)o="",o=i._renderDIV("e-customformatastabletext",s[r])+i._renderDIV("e-customformatastablecontrol",'<input class="e-formatastabletext" type="text" id='+i._id+"_custfat"+u[r]+" />")+i._renderDIV("e-customformatastablebutton e-custfatbutton",r===2?'<button style="float:right" id='+i._id+"_custfatbtncnt >"+i._getLocStr("Add")+'<\/button><button style="float:right;margin-right:6px;" id='+i._id+"_custfatbtn"+u[r]+' class="e-custfatbtncontent" >'+i._getLocStr("Format")+"<\/button>":r>0?'<button style="float:right" id='+i._id+"_custfatbtn"+u[r]+" >"+i._getLocStr("Format")+"<\/button>":""),f=f+i._renderDIV("e-customformatastableproperty",o),r=r+1;f=f+'<div style="float: right;margin:18px 7px 8px;" ><div style="display:inline-block; margin-right: 8px;"><button id='+i._id+"_custfatbtnok >"+i._getLocStr("Ok")+'<\/button><\/div><div style="display:inline-block;margin-right: -6px;"><button id='+i._id+"_custfatbtncancel >"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(f);n("#"+i._id+"_custfatbtn"+u[1]).ejButton(e);n("#"+i._id+"_custfatbtn"+u[2]).ejButton(e);n("#"+i._id+"_custfatbtn"+u[3]).ejButton(e);n("#"+i._id+"_custfatbtncnt").ejButton(e);n("#"+i._id+"_custfatbtnok").ejButton({showRoundedCorner:!0,size:"mini",click:n.proxy(this._customFATActions,this)});n("#"+i._id+"_custfatbtncancel").ejButton({showRoundedCorner:!0,size:"mini",click:n.proxy(this._customFATActions,this)});n("#"+i._id+"_custfatdlg").ejDialog({showOnInit:!1,title:i._getLocStr("NewTableStyle"),enableModal:!0,enableResize:!1,width:"450px",cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_customFATActions:function(t){var i=this.XLObj,r,u;t.model.text===i._getLocStr("Ok")&&(u='<div class="e-formatastablecell"><div class=" e-ss-cellstyles-1"><\/div><\/div>',r=n("#"+i._id+"_formatastable"),r.find(".e-formatastableheader").first().removeClass("e-hide"),r.find(".e-customformatastable").removeClass("e-hide").append(u),r.find(".e-customformatastable .e-formatastablecell").data({format:i._customTableStyle}));n("#"+i._id+"_custfatdlg").ejDialog("close");i._customTableStyle={}},_fatResizeTableBtnClick:function(t){var i=this.XLObj,u=document.getElementById(i._id+"_fatresizetablerange").value,o=i.getActiveSheetIndex(),e,r,f;u=u.indexOf(":")!=-1?i.getRangeIndices(u):[];r=document.getElementById(i._id+"_tableid").value;f=i.getSheet(o)._tableManager;e={sheetIndex:o,reqType:"format-table",action:"resizetable",beforeRange:f[r].range,tableId:r};t.model.text===i._getLocStr("Ok")&&(u.length&&u[0]===f[r].range[0]&&u[1]===f[r].range[1]&&u[3]===f[r].range[3]?(f[r].range=u,i.XLFormat._createTable(r,{format:f[r].format}),i.XLFilter._extendFilterRange(r,u),e.afterRange=u,e.format=f[r].format,e.formatName=f[r].formatName,e.header=n.extend(!0,{},i.model.sheets[o]._header),i._completeAction(e)):(i._renderAlertDlgContent(n("#"+i._id+"_alertdlg"),"Alert",i._getLocStr("ResizeAlert")),n("#"+i._id+"_alertdlg").ejDialog("open")));n("#"+i._id+"_fatresizetabledlg").ejDialog("close")},_fatNameDlgBtnClick:function(t){var r,i=this.XLObj,u=i._id;n("#"+u+"_fatnamedlg").ejDialog("close");t.model.text===i._getLocStr("Ok")&&(r={header:document.getElementById(u+"_fatheader").checked,name:document.getElementById(u+"_fatname").value,format:i.XLFormat._formatAsTableStyle.format},i.XLFormat._formatAsTableStyle.formatName&&(r.formatName=i.XLFormat._formatAsTableStyle.formatName),i.XLFormat.createTable(r))},_chartNameDlgBtnClick:function(t){var f,r,i=this.XLObj,s=i.getActiveSheetIndex(),o=i.getSheet(s)._shapeMngr.chart[i.XLEdit.getPropertyValue(i.XLShape._picCellIdx.rowIndex,i.XLShape._picCellIdx.colIndex,"chart")[0]],u,e=i._id,h=document.getElementById(e+"_chart").value;if(n("#"+e+"_chartnamedlg").ejDialog("close"),f=n("#"+h).data("ejChart"),r={sheetIndex:s,reqType:"shape",shapeType:"chart",cid:h,rowIndex:i.XLShape._picCellIdx.rowIndex,colIndex:i.XLShape._picCellIdx.colIndex,prev:{},cur:{}},u=document.getElementById(e+"_chartname").value,t.model.text===i._getLocStr("Ok"))switch(i._hasTitle){case"PX":f.option("primaryXAxis",{title:{text:u}});o.xAxis.title.text=u;r.action="PX";break;case"PY":f.option("primaryYAxis",{title:{text:u}});o.yAxis.title.text=u;r.action="PY";break;case"CT":f.option("title",{text:u});o.title.text=u;r.action="CT"}r.prev.text=i._cOpt.prevText;i._hasTitle=="CT"&&(r.prev.align=i._cOpt.prevAlign,r.cur.align=i._cOpt.curAlign);r.cur.text=u;i._completeAction(r);i._cOpt={};document.getElementById(e+"_chartname").value=""},_customFormatAsTableHandler:function(){var u,r,t=this._id.split("_")[0],i=n("#"+t).data("ejSpreadsheet"),f=n("#"+t+"_customcellstyledialog");i._tableLayout=this._id.replace(t+"_custfatbtn","");this._id===t+"_custfatbtncnt"?(u='<div style="float:right;margin-right:3px;margin-top:-2px" class="e-customformatastableproperty" >'+i._renderDIV("e-customformatastabletext","")+i._renderDIV("e-customformatastablecontrol",'<input type="text" id='+i._id+"_custfatcontentLayout"+n(".e-custfatbtncontent").length+' readonly   style="width: 283px;margin:3px 3px" />')+i._renderDIV("e-customformatastablebutton e-customformatbutton","<button  id="+i._id+"_custfatbtncontentLayout"+n(".e-custfatbtncontent").length+' class="e-custfatbtncontent" >'+i._getLocStr("Format")+"<\/button>")+"<\/div>",n("#"+t+"_custfatdlg").find(".e-customformatastableproperty").last().before(u),n("#"+t+"_custfatbtncontentLayout"+(n(".e-custfatbtncontent").length-1)).ejButton({showRoundedCorner:!0,size:"mini",click:i.XLRibbon._customFormatAsTableHandler})):(r=f.find(".e-customcellstyleproperty"),n(r[0]).hide(),this._id===t+"_custfatbtncontentBorder"&&[1,2,3,4,8,9,10,11,12].forEach(function(t){n(r[t]).hide()}),f.ejDialog("open"),n("#"+t+"_customcellstyleborder").focus())},_designTabUpdate:function(t,i){var r=this.XLObj,u=n("#"+r._id+"_Ribbon").ejRibbon("instance"),f;u.showTab("Design");this._isDesignTab&&u.option({selectedItemIndex:this._getTabIndex("design")});document.getElementById(r._id+"_tablename").value=r.getSheet(r.getActiveSheetIndex())._tableManager[t].name;document.getElementById(r._id+"_tableid").value=t;f=n("#"+r._id+"_Ribbon_clearfilter").data("ejButton");this._changeClrFltrStatus(f,"button",i)},_formatTabUpdate:function(){var t=this.XLObj,i=n("#"+t._id+"_Ribbon").ejRibbon("instance");t.model.showRibbon&&i.showTab("Format");t._shapeChange=!0;t.element.find("#"+t._id+"_pictureheight").ejNumericTextbox("option","value",t.element.find(".e-ss-activeimg").height());t.element.find("#"+t._id+"_picturewidth").ejNumericTextbox("option","value",t.element.find(".e-ss-activeimg").width());t.model.showRibbon&&i.option({selectedItemIndex:t.XLRibbon._getTabIndex("format")});t._shapeChange=!1},_chartDesignTabUpdate:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon").ejRibbon("instance"),u=t.get(0).id,f=t.get(0).offsetLeft,e=t.get(0).offsetTop;i.XLShape._picCellIdx=i.XLShape._getCellIndexFromOffset(e,f);r.showTab("Chart Design");r.showTab("Chart Format");r.option({selectedItemIndex:i.XLRibbon._getTabIndex("cdesign")});document.getElementById(i._id+"_chart").value=u;this._isSetModel=!0;i.element.find("#"+i._id+"_Ribbon_chartheight").ejNumericTextbox("option","value",i.element.find(".e-ss-activeimg").height());i.element.find("#"+i._id+"_Ribbon_chartwidth").ejNumericTextbox("option","value",i.element.find(".e-ss-activeimg").width());r.element.find("#"+i._id+"_Ribbon_chartTheme").ejDropDownList("setSelectedValue",t.ejChart("option","theme"));this._isSetModel=!1},_setChartWidthHeight:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_chartwidth").ejNumericTextbox("instance"),u=n("#"+i._id+"_Ribbon_chartheight").ejNumericTextbox("instance");i._shapeChange=!0;u.option({value:t.height});r.option({value:t.width});i._shapeChange=!1},_toggleDesignTab:function(i){var r=this.XLObj,u=n("#"+this.XLObj._id+"_Ribbon").data("ejRibbon"),f;(t.isNullOrUndefined(i)||!t.isNullOrUndefined(i)&&i.className.indexOf("e-ft")<0)&&(u.hideTab("Design"),u.option({selectedItemIndex:1}));f=n("#"+this.XLObj._id+"_Ribbon_clearfilter").data("ejButton");t.isNullOrUndefined(i)&&(i=r.getCell(r.getActiveCell().rowIndex,r.getActiveCell().colIndex)[0]);this._changeClrFltrStatus(f,"button",i)},_toggleChartDesignTab:function(){var t=n("#"+this.XLObj._id+"_Ribbon").data("ejRibbon");t.hideTab("Chart Design");t.hideTab("Chart Format");t.option({selectedItemIndex:1})},_toggleFormatTab:function(){n("#"+this.XLObj._id+"_Ribbon").ejRibbon("hideTab","Format")},_getTabIndex:function(t){if(this.XLObj.model.showRibbon){for(var u=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("model"),r=u.tabs,f=u.contextualTabs,i=0;i<f.length;)r=r.concat(f[i].tabs),i++;for(i=r.length;i--;)if(r[i].id===t)return++i}},_getFormatAsTableInput:function(n){var h=this.XLObj,t,u,o,i,f=0,r=0,c=[],s={hl:"headerLayout",cl:"contentLayout",hb:"headerBorder",cb:"contentBorder"},e={};for(n=n.split("&");f<n.length;){if(o=n[f].split("?"),t=o[0],u=o[1],t==="hl")e[s[t]]=h._getStyleAsJSON(u,!0);else if(t==="cl"){for(i=u.split(",");r<i.length;)c.push(i[r].length?h._getStyleAsJSON(i[r],!0):{}),r=r+1;e[s[t]]=c}else t==="cb"&&(i=u.split("-"),e[s[t]]={border:this._getBorderObj(i[0],i[1])});f=f+1}return e},_getBorderObj:function(n,t){var r,i={t:{top:""},r:{right:""},b:{bottom:""},l:{left:""},o:{top:"",right:"",bottom:"",left:""},tb:{top:"",bottom:""}};if(n==="gb")return t;for(r in i[n])i[n][r]=t;return i[n]},_renderCellStyles:function(){for(var t=0,u=[],i="",e=[4,2,12,1],r=this.XLObj,f=r._dataContainer.hashCode,o=r._getLocStr("CellStyleHeaderText").split("/"),s=r._getLocStr("CellStyleGBN").split("/"),h=["",f[0],f[1],f[2]],c=r._getLocStr("CellStyleTH").split("/"),l=f.slice(3,5),a=r._getLocStr("CellsStyleTCS").split("/"),v=f.slice(5,17),y=r._getLocStr("CellStyleNCS").split("/");t<e[0];)i=i+r._renderDIV("e-cellstylecell "+h[t],s[t]),t=t+1;for(u.push(i),i="",t=0;t<e[1];)i=i+r._renderDIV("e-cellstylecell "+l[t],c[t]),t=t+1;for(u.push(i),i="",t=0;t<e[2];)i=i+r._renderDIV("e-cellstylecell "+v[t],a[t]),t=t+1;for(u.push(i),i="",t=0;t<e[3];)i=i+r._renderDIV("e-cellstylecell e-customaction",y[t]+"..."),t=t+1;for(u.push(i),i="",t=0;t<o.length*2;)i=i+r._renderDIV(t%2==0?"e-cellstyleheader":"e-cellstylecontent",t%2==0?o[t/2]:u[0]),t%2!=0&&u.shift(),t++;return r.XLRibbon._renderCustomCellStyleDialog(),n("<div id="+r._id+'_cellstyles class="e-spreadsheet e-cellstyles" style="box-shadow:3px 5px 15px #111111"><div class="e-cellstyleheader e-hide">'+r._getLocStr("Custom")+'<\/div><div class="e-customcellstyle e-cellstylecontent e-hide"><\/div>'+i+"<\/div>")},_renderCustomCellStyleDialog:function(){for(var u=0,e,i=this.XLObj,r=i.XLRibbon._customCellStyleChangeHandler,f="<div id="+i._id+"_customcellstyledialog Title="+i._getLocStr("Style")+">",o=i._getLocStr("CustomCellStylePropText").split("/"),s=["name","font-family","font-size","text-align","vertical-align","border","borderstyle","bordercolor","background-color","color","font-weight","font-style","text-decoration"];u<o.length;)e="",e=i._renderDIV("e-customcelltypetext",o[u])+i._renderDIV("e-customcelltypecontrol","<input id="+i._id+"_customcellstyle"+s[u]+" />"),f=f+i._renderDIV("e-customcellstyleproperty",e),u=u+1;f=f+'<div class="e-customcellstyleproperty" style="margin-bottom: 4px; margin-left: 439px;" ><div style="display:inline-block; margin:5px"><button id='+i._id+"_customcellstylebtnok >"+i._getLocStr("Ok")+'<\/button><\/div><div style="display:inline-block;margin:5px"><button id='+i._id+"_customcellstylebtncancel >"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(f);document.querySelectorAll(".e-customcellstyleproperty")[0].style.width="590px";document.querySelectorAll(".e-customcellstyleproperty")[0].style.height="36px";n("#"+i._id+"_customcellstylefont-family").ejDropDownList({dataSource:this._fontFamily,value:"1",change:n.proxy(r)});n("#"+i._id+"_customcellstylefont-size").ejDropDownList({dataSource:[{value:"1",text:"8px"},{value:"2",text:"9px"},{value:"3",text:"10px"},{value:"4",text:"11px"},{value:"5",text:"12px"},{value:"6",text:"14px"},{value:"7",text:"16px"},{value:"7",text:"18px"}],value:"1",change:n.proxy(r)});n("#"+i._id+"_customcellstyletext-align").ejDropDownList({dataSource:this._textAlign,value:"1",change:n.proxy(r)});n("#"+i._id+"_customcellstylevertical-align").ejDropDownList({dataSource:this._verticalAlign,value:"1",change:n.proxy(r)});n("#"+i._id+"_customcellstyleborder").ejDropDownList({dataSource:[{value:"bottomborder",text:"Bottom Border"},{value:"topborder",text:"Top Border"},{value:"leftborder",text:"Left Border"},{value:"rightborder",text:"Right Border"},{value:"allborder",text:"All Border"},{value:"outsideborder",text:"Outside Border"},{value:"thickboxborder",text:"Thick Box Border"},{value:"thickbottomborder",text:"Thick Bottom Border"},{value:"topandbottomborder",text:"Top and Bottom Border"},{value:"topandthickbottomborder",text:"Top and Thick Bottom Border"}],value:"topborder",change:n.proxy(r)});n("#"+i._id+"_customcellstyleborderstyle").ejDropDownList({dataSource:[{value:"solid",text:"Solid"},{value:"dashed",text:"Dashed"},{value:"dotted",text:"Dotted"}],value:"solid",change:n.proxy(r)});n("#"+i._id+"_customcellstylebordercolor").ejColorPicker({value:"#278787",modelType:"palette",cssClass:"e-spreadsheet",open:n.proxy(this._colorPickerHandler,this,"customcellstylebordercolor"),change:n.proxy(r)});n("#"+i._id+"_customcellstylebackground-color").ejColorPicker({value:"#278787",modelType:"palette",cssClass:"e-spreadsheet",open:n.proxy(this._colorPickerHandler,this,"customcellstylebackground-color"),change:n.proxy(r)});n("#"+i._id+"_customcellstylecolor").ejColorPicker({value:"#278787",modelType:"palette",cssClass:"e-spreadsheet",open:n.proxy(this._colorPickerHandler,this,"customcellstylecolor"),change:n.proxy(r)});n("#"+i._id+"_customcellstylefont-weight").ejCheckBox({change:n.proxy(r)});n("#"+i._id+"_customcellstylefont-style").ejCheckBox({change:n.proxy(r)});n("#"+i._id+"_customcellstyletext-decoration").ejCheckBox({change:n.proxy(r)});n("#"+i._id+"_customcellstylebtnok").ejButton({showRoundedCorner:!0,size:"mini",click:n.proxy(this._customCellStyleBtnClickHandler,this)});n("#"+i._id+"_customcellstylebtncancel").ejButton({showRoundedCorner:!0,size:"mini",click:n.proxy(this._customCellStyleBtnClickHandler,this)});n("#"+i._id+"_customcellstyledialog").ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,width:"620px",cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)});n("#"+i._id+"_customcellstylename").css("width",137);n("#"+i._id+"_customcellstylebordercolor_Presets").width(118);n("#"+i._id+"_customcellstylebackground-color_Presets").width(118);n("#"+i._id+"_customcellstylecolor_Presets").width(118)},_resetCustomCellStyle:function(){var t=this.XLObj._id,r="value",i="option",f="checked",u="1",e="#278787";this._isCustomCellStyleReset=!0;n("#"+t+"_customcellstylefont-family").ejDropDownList(i,r,u);n("#"+t+"_customcellstylefont-size").ejDropDownList(i,r,u);n("#"+t+"_customcellstyletext-align").ejDropDownList(i,r,u);n("#"+t+"_customcellstylevertical-align").ejDropDownList(i,r,u);n("#"+t+"_customcellstylebackground-color").ejColorPicker(i,r,e);n("#"+t+"_customcellstylecolor").ejColorPicker(i,r,e);n("#"+t+"_customcellstylefont-weight").ejCheckBox(i,f,!1);n("#"+t+"_customcellstylefont-style").ejCheckBox(i,f,!1);n("#"+t+"_customcellstyletext-decoration").ejCheckBox(i,f,!1);this._isCustomCellStyleReset=!1},_customCellStyleChangeHandler:function(t){var r,e,h,s,c,l,o=this._id.split("_"),a=n("#"+o[0]).data("ejSpreadsheet"),u=a._customCellStyle,f=o[1].replace("customcellstyle","");if(!a.XLRibbon._isCustomCellStyleReset)switch(this.pluginName){case"ejCheckBox":t.isChecked?u[f]={"text-decoration":"underline","font-weight":"bold","font-style":"italic"}[f]:f in u&&delete u[f];break;case"ejColorPicker":if(f==="bordercolor"){if("border"in u)for(i in u.border)u.border[i].replace(u.border[i].split(" ")[2],t.value);s=n("#"+o[0]+"_customcellstylebordercolor").data("ejColorPicker");s.model.value=t.value}else f==="background-color"?(s=n("#"+o[0]+"_customcellstylebackground-color").data("ejColorPicker"),u[f]=t.value):f==="color"&&(s=n("#"+o[0]+"_customcellstylecolor").data("ejColorPicker"),u[f]=t.value);s.hide();s.setValue(t.value);break;default:switch(f){case"border":h=n("#"+o[0]+"_customcellstylebordercolor").ejColorPicker("model").value;c=n("#"+o[0]+"_customcellstyleborderstyle").ejDropDownList("model").value;r="1px "+c+" "+h;e="2px "+c+" "+h;l={topborder:{top:r},rightborder:{right:r},bottomborder:{bottom:r},leftborder:{left:r},allborder:{top:r,right:r,bottom:r,left:r},outsideborder:{top:r,right:r,bottom:r,left:r},thickboxborder:{top:e,right:e,bottom:e,left:e},thickbottomborder:{bottom:e},topandbottomborder:{top:r,bottom:r},topandthickbottomborder:{top:r,bottom:e}};u[f]=l[t.value];break;case"borderstyle":if("border"in u)for(i in u.border)u.border[i].replace(u.border[i].split(" ")[1],t.value);break;default:u[f]=t.selectedText}}},_customCellStyleBtnClickHandler:function(t){var i=this.XLObj;if(t.model.text===i._getLocStr("Ok")&&i.getObjectLength(i._customCellStyle))if(i._tableLayout.length)i._tableLayout.indexOf("contentLayout")===-1?i._customTableStyle[i._tableLayout]=i._customCellStyle:(i._customTableStyle.contentLayout||(i._customTableStyle.contentLayout=[]),i._customTableStyle.contentLayout[i._tableLayout.replace("contentLayout","")]=i._customCellStyle),document.getElementById(i._id+"_custfat"+i._tableLayout).value=JSON.stringify(i._customCellStyle),i._tableLayout="";else{var u=n("#"+i._id+"_cellstyles"),f=u.find(".e-customcellstyle"),r=n("#"+i._id+"_customcellstylename").val();r=r.length?r:i._getLocStr("Style")+" "+(f.children().length+1);u.find(".e-cellstyleheader").first().removeClass("e-hide");f.removeClass("e-hide").append(i._renderDIV("e-cellstylecell "+i.XLFormat._createFormatClass(i._customCellStyle),r))}i._customCellStyle={};n("#"+i._id+"_customcellstyledialog").ejDialog("close");n("#"+i._id+"_customcellstyledialog").children(":hidden").show()},_onTabClick:function(n){var t=this.XLObj;n.prevActiveIndex!==-1&&(t.XLEdit._isEdit||t.XLComment._isCommentEdit||t._isSheetRename)&&this._enableRibbonIcons();t._trigger("onTabClick",n);this._ribbonState||(this._ribbonState=!0,n.action="tabClick",this._heightWidthCalculation(t.getActiveSheetIndex(),t.model.scrollSettings,n))},_onRibbonCollapse:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);this._ribbonState=!(t.action==="collapse");t.action==="collapse"&&(t.action="toggleBtn",this._heightWidthCalculation(i.getActiveSheetIndex(),r,t))},_onTabSelect:function(n){var t=this.XLObj,i=t.getActiveCellElem(t.getActiveSheetIndex());(t.XLEdit._isEdit||t.XLComment._isCommentEdit||t._isSheetRename)&&this._disableRibbonIcons();this._updateRibbonIcons();i.length&&i[0].className.indexOf("e-table")!=-1&&(this._isDesignTab=n.activeIndex==this._getTabIndex("design"));t._trigger("onTabSelect",n)},_valDTypeOnChange:function(t){var i=this.XLObj;n("#"+i._id+"_Form_ValDialog").validate().resetForm();t.value==="Between"||t.value==="NotBetween"?(n("#"+i._id+"_Ribbon_lbMax").show(),n("#"+i._id+"_Ribbon_btnMax").show(),n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr("NumberStart"))):(n("#"+i._id+"_Ribbon_lbMax").hide(),n("#"+i._id+"_Ribbon_btnMax").hide(),n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr("Value")));this._dialogValidate("_ValDialog")},_valTypeOnChange:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList");r.enable();t.value==="List"?(n("#"+i._id+"_Ribbon_lbMax").hide(),n("#"+i._id+"_Ribbon_btnMax").hide(),r.disable()):(r._selectedValue==="Between"||r._selectedValue==="NotBetween")&&(n("#"+i._id+"_Ribbon_lbMax").show(),n("#"+i._id+"_Ribbon_btnMax").show());n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr(t.selectedText+"Start"));n("#"+i._id+"_Ribbon_lbMax").text(i._getLocStr(t.selectedText+"End"));this._dialogValidate("_ValDialog")},_valDlgBtnClick:function(t){var i=this.XLObj;if(t==="ok"&&n("#"+i._id+"_Form_ValDialog").valid()){var u=n("#"+i._id+"_Ribbon_blank").data("ejCheckBox"),r=n("#"+i._id+"_Ribbon_ddType").data("ejDropDownList"),f=n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList");r._selectedValue==="List"?i.XLValidate.applyDVRules(u.isChecked(),["list",n("#"+i._id+"_Ribbon_btnMin").val()],this._types[r.selectedIndexValue].value):i.XLValidate.applyDVRules(u.isChecked(),[this._actions[f.selectedIndexValue].value,n("#"+i._id+"_Ribbon_btnMin").val(),n("#"+i._id+"_Ribbon_btnMax").val()],this._types[r.selectedIndexValue].value);i._setddlCell()}(t==="cancel"||t==="ok"&&n("#"+i._id+"_Form_ValDialog").valid())&&(n("#"+i._id+"_Ribbon_ddType").data("ejDropDownList").option({selectedItemIndex:0}),n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList").option({selectedItemIndex:6}),n("#"+i._id+"_Ribbon_blank").data("ejCheckBox").option({checked:!0}),n("#"+i._id+"_Ribbon_btnMin").val(""),n("#"+i._id+"_Ribbon_btnMax").val(""),n("#"+i._id+"_ValDialog").ejDialog("close"),i.setSheetFocus())},_renderValDialog:function(){var i=this.XLObj,r,f,u,e,o,h,s,c,l;n("#"+i._id+"_Ribbon_MainDiv").length<1&&(r=t.buildTag("div","",{},{id:i._id+"_Ribbon_MainDiv"}),n("#"+i._id+"_Validation").append(r),u=t.buildTag("label").text(i._getLocStr("Allow")),r.append(u),e=t.buildTag("input","","",{id:i._id+"_Ribbon_ddType",type:"text"}),r.append(e),e.ejDropDownList({dataSource:this._types,fields:{id:"Types",text:"text",value:"text"},selectedItemIndex:1,width:235,height:25,change:n.proxy(this._valTypeOnChange,this)}),o=t.buildTag("input#"+i._id+"_Ribbon_blank").css("margin-left","3%"),h=t.buildTag("label",i._getLocStr("IgnoreBlank"),{"margin-left":"1%"},{"for":i._id+"_Ribbon_blank"}),r.append(o),r.append(h),o.ejCheckBox(),u=t.buildTag("label").text(i._getLocStr("Data")).css("display","table"),r.append(u),s=t.buildTag("input","","",{id:i._id+"_Ribbon_ddAction",type:"text"}),r.append(s),s.ejDropDownList({dataSource:this._actions,fields:{id:"Types",text:"text",value:"value"},selectedItemIndex:6,width:235,height:25,change:n.proxy(this._valDTypeOnChange,this)}),f=t.buildTag("div","",{"margin-top":"10px"},{id:i._id+"_Ribbon_SubDiv"}),u=t.buildTag("label","","",{id:i._id+"_Ribbon_lbMin"}).text(i._getLocStr("NumberStart")).css("display","table"),f.append(u),c=t.buildTag("input.e-ejinputtext","",{width:232},{id:i._id+"_Ribbon_btnMin",type:"text",name:i._id+"_valMin"}),f.append(c),u=t.buildTag("label","","",{id:i._id+"_Ribbon_lbMax"}).text(i._getLocStr("NumberEnd")).css({display:"table","padding-top":"5px"}),f.append(u),l=t.buildTag("input.e-ejinputtext","",{width:232},{id:i._id+"_Ribbon_btnMax",type:"text",name:i._id+"_valMax"}),f.append(l),n("#"+i._id+"_Validation").append(f),n("#"+i._id+"_Validation").addClass("e-valdiv"),n("#"+i._id+"_Validation").css("height","300px"),n("#"+i._id+"_Ribbon_SubDiv").wrapInner('<form id="'+i._id+'_Form_ValDialog" onsubmit="return false"><\/form>'),this._dialogValidate("_ValDialog"))},_dialogValidate:function(t,i){var f=this.XLObj,e=f._id,l,g=n("#"+e+"_Form"+t),o,r,a,v,s,y,p,u,w,b,h,k=!0,c,d;g.validate({errorElement:"div",wrapper:"div",errorPlacement:function(n,t){n.insertAfter(t.closest("input"));n.children().addClass("e-dlg-field-validation-error");n.css({position:"relative"});n.offset({left:t.offset().left,top:t.offset().top+19})},onfocusout:function(n){this.element(n)}});c=n("#"+e+"_Ribbon_ddAction").ejDropDownList("getSelectedItem");switch(t){case"_ValDialog":l=n("#"+e+"_Ribbon_ddType").data("ejDropDownList");o=l.getSelectedValue();break;case"_CFDialog":o=i.charAt(0).toUpperCase()+i.slice(1).toLowerCase();break;case"_GoToDiv":o="CellAdr";break;case"_Ribbon_cellAddress":o="CellAdr";break;case"_Ribbon_webAddress":o="WebAdr"}for(n("#"+e+"_Form"+t).validate().resetForm(),u=[],p=n("#"+e+"_Form"+t).find("input").length,y={required:!0,date:!0,messages:{date:f._getLocStr("DateValidationMsg"),required:f._getLocStr("RequiredField")}},v={required:!0,celladdr:!0},w={required:!0,number:!0,messages:{required:f._getLocStr("RequiredField"),number:f._getLocStr("NumberValidationMsg")}},b={required:!0,time:!0},s={required:!0},d={required:!0,betweentype:!0},n.validator.addMethod("time",function(n){return n===""||n.match(/^(([0-1]?[0-9])|([2][0-3])):([0-5]?[0-9])(:([0-5]?[0-9]))?(\s(AM|am|PM|pm))?$/)},f._getLocStr("TimeValidationMsg")),n.validator.addMethod("celladdr",function(t,i){var r,u=n("#"+i.id.split("_")[0]).data("ejSpreadsheet"),f=u.getSheet(n("#"+u._id+"_Ribbon_sheentName").ejTreeView("option","selectedNode"));return t.indexOf("=")>-1&&(t=t.split("=")[1]),t.indexOf("!")>-1&&(h=t.split("!"),k=n("#"+i.id.split("_textRef")[0]).data("ejSpreadsheet")._getSheetIndexByName(h[0]),t=h[1]),t.indexOf("$")>-1&&(t=t.split("$").join("")),r=u.getRangeIndices(t),r=f.colCount<=r[3]||f.rowCount<=r[2]?null:t,(t.match(/^(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9]):(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9])$/)||t.match(/^(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9])$/)&&k)&&r},f._getLocStr("CellAdrsValidationMsg")),n.validator.addMethod("betweentype",function(t,i){var r=n("#"+i.id.split("_")[0]+"_Ribbon_btnMin").val(),u=n("#"+i.id.split("_")[0]+"_Ribbon_btnMax").val();return(r===""||u===""||parseInt(r)>parseInt(u)||Date.parse(r)>Date.parse(u)||new Date("01/01/1990 "+r).getTime()>new Date("01/01/1990 "+u).getTime())&&(t=null),t},f._getLocStr("BetweenAlert")),r=0,a=p;r<a;r++){u[r]=n("#"+e+"_Form"+t).find("input")[r].id;switch(o){case"Date":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",y);break;case"Time":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",b);break;case"Number":case"Decimal":case"TextLength":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",w);break;case"List":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",s);break;case"CellAdr":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",v);break;case"WebAdr":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",s)}o!=="List"&&(c==="between"||c==="not between")&&n("#"+e+"_Ribbon_btnMax").rules("add",d)}},_renderCFDialog:function(i){var f,o,e,u,h,r=this.XLObj,s;h=n("#"+r._id+"_CFDialog").data("ejDialog");h.option({title:r._getLocStr(this._cFormatData[i.ID][0])});n("#"+r._id+"_Ribbon_CFSubDiv").length<1&&(o=t.buildTag("div","",{"margin-top":"8px"},{id:r._id+"_Ribbon_CFSubDiv"}),e=t.buildTag("label").text(r._getLocStr("With")),o.append(e),s=t.buildTag("input","",{"line-height":0},{id:r._id+"_Ribbon_ddStyle",type:"text"}),o.append(s),s.ejDropDownList({dataSource:this._styles,fields:{id:"Types",text:"text",value:"value"},selectedItemIndex:0,width:250,height:25,change:n.proxy(this._ddOnChange,this)}),n("#"+r._id+"_CondFormat").append(o),n("#"+r._id+"_CondFormat").addClass("e-cfdiv"));n("#"+r._id+"_Ribbon_CFMainDiv").length>0&&n("#"+r._id+"_Ribbon_CFMainDiv").remove();f=t.buildTag("div","","",{id:r._id+"_Ribbon_CFMainDiv"});n("#"+r._id+"_CondFormat").prepend(f);i.ID=="between"&&(u=t.buildTag("input.ejinputtext","",{width:248},{id:r._id+"_Ribbon_input2",type:"text"}),f.prepend(u),e=t.buildTag("label").text(r._getLocStr("And")).css("display","table"),f.prepend(e));u=t.buildTag("input.ejinputtext","",{width:248},{id:r._id+"_Ribbon_input1",type:"text"});f.prepend(u);e=t.buildTag("label").text(r._getLocStr(this._cFormatData[i.ID][1]));f.prepend(e);(i.ID==="aboveavg"||i.ID==="belowavg")&&u.hide();n("#"+r._id+"_Ribbon_CFMainDiv").wrapInner('<form id="'+r._id+'_Form_CFDialog" onsubmit="return false"><\/form>');u.is(":visible")&&u.focus().setInputPos(u.val().length);this._dialogValidate("_CFDialog",i.ID)},_dlgCFOk:function(){var t=this.XLObj,i;n("#"+t._id+"_Form_CFDialog").valid()&&(i=n("#"+t._id+"_Ribbon_ddStyle").data("ejDropDownList"),t.XLCFormat._cFormat(this._currentCFormat,n("#"+t._id+"_Ribbon_input1").val(),n("#"+t._id+"_Ribbon_input2").val(),i.getSelectedValue()),n("#"+t._id+"_CFDialog").ejDialog("close"),t.setSheetFocus())},_dlgCFCancel:function(){var t=this.XLObj;n("#"+t._id+"_CFDialog").ejDialog("close");t.setSheetFocus()},_sheetData:function(){var i=this.XLObj,r=[],t=[],n;for(t[0]={id:1,name:"Sheet Reference",hasChild:!0,expanded:!0},n=1;n<i.model.sheets.length;n++)r[n]=i.model.sheets[n]._sheetName.text,t[n]={id:n+1,pid:1,name:r[n],hasChild:!0,expanded:!0};return t},_renderHLDialog:function(){var i=this.XLObj,e,r,u,f,s,o;n("#"+i._id+"_Ribbon_WebDiv").length<1&&(e=t.buildTag("div","",{"margin-bottom":-19,position:"relative",height:68,width:315},{id:i._id+"_Ribbon_WebDiv.e-ss-webdiv"}),r=t.buildTag("label.e-ss-hllblfind").text(i._getLocStr("HyperlinkText")),e.append(r),u=t.buildTag("input.e-ss-hltxtfind e-ejinputtext","",{width:216},{id:i._id+"_Ribbon_findText",type:"text"}),e.append(u),r=t.buildTag("label.e-ss-hllblweb","","",{id:i._id+"_Ribbon_address"}).text(i._getLocStr("WebAddress")),e.append(r),u=t.buildTag("input.e-ss-hltxtweb e-ejinputtext","",{width:216},{id:i._id+"_Ribbon_webAddress",type:"text"}),e.append(u),n("#"+i._id+"_Web").append(e).css({"padding-left":"7px","padding-right":"7px"}),f=t.buildTag("div","","",{id:i._id+"_Ribbon_DocDiv"}),r=t.buildTag("label.e-ss-hllblfind").text(i._getLocStr("HyperlinkText")),f.append(r),u=t.buildTag("input.e-ss-hltxtfind e-ejinputtext","",{width:216},{id:i._id+"_Ribbon_cellText",type:"text"}),f.append(u),r=t.buildTag("label.e-ss-hllblweb").text(i._getLocStr("CellAddress")),f.append(r),u=t.buildTag("input.e-ss-hltxtweb e-ejinputtext","",{width:216},{id:i._id+"_Ribbon_cellAddress",type:"text"}),f.append(u),o=t.buildTag("div.e-ss-scroll","","",{id:i._id+"_Ribbon_Sheet"}),f.append(o),r=t.buildTag("label").text(i._getLocStr("SheetIndex")).css({position:"relative",top:2}),o.append(r),s=t.buildTag("div","","",{id:i._id+"_Ribbon_sheentName"}),o.append(s),s.ejTreeView({fields:{id:"id",parentId:"pid",text:"name",hasChild:"hasChild",dataSource:this._sheetData(),expanded:"expanded"},nodeSelect:n.proxy(this._sheetSelect,i)}),n("#"+i._id+"_Doc").append(f).css({"padding-left":"7px","padding-right":"7px"}),n("#"+i._id+"_Ribbon_cellAddress").wrap("<form id='"+i._id+"_Form_Ribbon_cellAddress' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_cellAddress"),n("#"+i._id+"_Ribbon_webAddress").wrap("<form id='"+i._id+"_Form_Ribbon_webAddress' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_webAddress"))},_sheetSelect:function(t){var i,u,f=this._getSheetNames(),r=n("#"+this._id+"_Ribbon_cellAddress"),e=n("#"+this._id+"hlDialog_OkBtn").data("ejButton"),o=n("#"+this._id+"_Ribbon_cellText");if(t.model.selectedNode>0)for(r.attr("disabled",!1),e.enable(),r.focus().setInputPos(1),i=0,u=f.length;i<u;i++)f[i].text===o.val().split("!")[0]&&o.val(t.value+"!"+r.val());else r.attr("disabled",!0),e.disable()},_dlgHLOk:function(){var t=this.XLObj;n("#"+t._id+"_Form_Ribbon_cellAddress").valid()&&n("#"+t._id+"_Form_Ribbon_webAddress").valid()&&(t._setLink(),this._dlgHLCancel())},_dlgHLCancel:function(){n("#"+this.XLObj._id+"_HLDialog").ejDialog("close")},_renderFRDialog:function(){var e,r,l,a,o,u,s,h,c,f,i=this.XLObj;n("#"+i._id+"_Ribbon_FindDiv").length<1&&(e=t.buildTag("div.e-divfind","","",{id:i._id+"_Ribbon_FindDiv"}),n("#"+i._id+"_Find").append(e),r=t.buildTag("label.e-lblfind").text(i._getLocStr("FindLabel")).css("display","table"),e.append(r),l=t.buildTag("input.e-ejinputtext e-txtfind","","",{id:i._id+"_Ribbon_textFind",type:"text"}),e.append(l),r=t.buildTag("label.e-lblreplace","","",{id:i._id+"_Ribbon_lbReplace"}).text(i._getLocStr("ReplaceLabel")).css("display","table"),e.append(r),a=t.buildTag("input.e-ejinputtext e-txtreplace","","",{id:i._id+"_Ribbon_textReplace",type:"text"}).css("display","none"),e.append(a),n("#"+i._id+"_Ribbon_lbReplace").hide(),f=t.buildTag("div","",{width:350,height:133},{id:i._id+"_Ribbon_SettingsDiv"}),o=t.buildTag("input#"+i._id+"_Ribbon_Case"),r=t.buildTag("label",i._getLocStr("MatchCase"),{"margin-right":"20%"},{"for":i._id+"_Ribbon_Case"}),f.append(o),f.append(r),o.ejCheckBox(),o=t.buildTag("input#"+i._id+"_Ribbon_AllContent"),r=t.buildTag("label",i._getLocStr("MatchAll"),{},{"for":i._id+"_Ribbon_AllContent"}),f.append(o),o.ejCheckBox(),f.append(r,"<br />"),r=t.buildTag("label").text(i._getLocStr("Within")).css("display","table"),u=t.buildTag("input","","",{id:i._id+"_Ribbon_ddWithin",type:"text"}),s=t.buildTag("div","",{display:"inline-block",width:"45%"}),c=t.buildTag("div","",{display:"block"}),s.append(r,u),u.ejDropDownList(i._generateEJDD(this._within,{id:"Types",text:"text",value:"value"},0,125,25)),r=t.buildTag("label").text(i._getLocStr("Search")).css("display","table"),u=t.buildTag("input","","",{id:i._id+"_Ribbon_ddSearch",type:"text"}),h=t.buildTag("div","",{display:"inline-block",width:"40%"}),h.append(r,u),f.append(c.append(s,h)),u.ejDropDownList(i._generateEJDD(this._sType,{id:"Types",text:"text",value:"value"},0,125,25)),r=t.buildTag("label").text(i._getLocStr("Lookin")).css("display","table"),u=t.buildTag("input","","",{id:i._id+"_Ribbon_ddLookin",type:"text"}),s=t.buildTag("div","",{display:"inline-block",width:"45%"}),s.append(r,u),u.ejDropDownList(i._generateEJDD(this._vType,{id:"Types",text:"text",value:"value"},0,125,25,"Type")),r=t.buildTag("label").text(i._getLocStr("Replace")+" "+i._getLocStr("Direction")).css("display","table"),u=t.buildTag("input","","",{id:i._id+"_Ribbon_ddDirection",type:"text"}),h=t.buildTag("div","",{display:"inline-block",width:"40%"}),h.append(r,u),c=t.buildTag("div","",{display:"block"}),f.append(c.append(s,h)),u.ejDropDownList(i._generateEJDD(this._direction,{id:"Types",text:"text",value:"value"},0,125,25)),n("#"+i._id+"_Settings").append(f),n("#"+i._id+"_Ribbon_FindRep").css("width",174))},_frTypeChange:function(t,i){t==="Type"&&(i.value==="comment"||i.value==="formula")?(n("#"+this._id+"_Ribbon_textReplace").attr("disabled",!0),n("#"+this._id+"FR_ReplaceBtn").ejButton("disable"),n("#"+this._id+"FR_ReplaceAllBtn").ejButton("disable")):(n("#"+this._id+"_Ribbon_textReplace").removeAttr("disabled"),n("#"+this._id+"FR_ReplaceBtn").ejButton("enable"),n("#"+this._id+"FR_ReplaceAllBtn").ejButton("enable"))},_hlTabChange:function(t){var i=this.XLObj,h=n("#"+i._id+"_Ribbon_sheentName").data("ejTreeView"),e=i.getActiveSheetIndex(),a=i.getActiveCellElem(e),u=n("#"+i._id+"_Ribbon_webAddress"),s=n("#"+i._id+"_Ribbon_findText"),f=n("#"+i._id+"_Ribbon_cellAddress"),o=n("#"+i._id+"_Ribbon_cellText"),r=i.XLEdit.getPropertyValueByElem(a,"hyperlink",e),c=n("#"+i._id+"_Doc"),l=n("#"+i._id+"_Web");switch(t.activeIndex){case 0:u.focus().setInputPos(u.val().length);s.val(o.val());f.val("");o.val("");i.isUndefined(r)||i.isUndefined(r.webAdr)||u.val(r.webAdr);c.hide();l.show();n("#"+i._id+"hlDialog_OkBtn").ejButton("enable");break;case 1:u.val("");f.val("A1");i.isUndefined(r)||i.isUndefined(r.cellAdr)||f.val(r.cellAdr.split("_")[0]);c.show();l.hide();h.selectNode("#"+(e+1));s.val().length?o.val(s.val()):o.val(h.getText("#"+(e+1))+"!A1");u.val("");f.focus().setInputPos(f.val().length)}},_findTabChange:function(t){var r,i=this.XLObj;switch(t.activeIndex){case 0:r=n("#"+i._id+"_Ribbon_FindDiv");n("#"+i._id+"_FRDialog_wrapper").css("height","200px");n("#"+i._id+"_FRDialog_FPDlgTab").css("height","122px");n("#"+i._id+"_FRDialog").parent("div").css("height","194px");n("#"+i._id+"_Ribbon_lbReplace").hide();n("#"+i._id+"_Ribbon_textReplace").hide();n("#"+i._id+"FR_ReplaceBtn").hide();n("#"+i._id+"FR_ReplaceAllBtn").hide();n("#"+i._id+"_Find").append(r);n("#"+i._id+"FR_PrevBtn").show();n("#"+i._id+"FR_NextBtn").show();n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length);break;case 1:r=n("#"+i._id+"_Ribbon_FindDiv");n("#"+i._id+"_FRDialog_wrapper").css("height","200px");n("#"+i._id+"_FRDialog_FPDlgTab").css("height","122px");n("#"+i._id+"_FRDialog").parent("div").css("height","194px");n("#"+i._id+"_Ribbon_lbReplace").show();n("#"+i._id+"_Ribbon_textReplace").show();n("#"+i._id+"FR_ReplaceBtn").show();n("#"+i._id+"FR_ReplaceAllBtn").show();n("#"+i._id+"FR_PrevBtn").show();n("#"+i._id+"FR_NextBtn").show();n("#"+i._id+"_Replace").append(r);n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length);break;case 2:n("#"+i._id+"_FRDialog_wrapper").css("height","270px");n("#"+i._id+"_FRDialog_FPDlgTab").css("height","193px");n("#"+i._id+"_FRDialog").parent("div").css("height","250px");n("#"+i._id+"FR_PrevBtn").hide();n("#"+i._id+"FR_NextBtn").hide();n("#"+i._id+"FR_ReplaceBtn").hide();n("#"+i._id+"FR_ReplaceAllBtn").hide();n("#"+i._id+"_Ribbon_ddWithin").focus()}},_gotoTabChange:function(t){var i=this.XLObj;t.activeIndex==0&&n("#"+i._id+"_textRef").focus().setInputPos(n("#"+i._id+"_textRef").val().length)},_btnFROnClick:function(t){var i=this.XLObj,h;i.element.ejWaitingPopup("show");var r=i.getActiveSheetIndex(),l=i.getSheet(r)._startCell.rowIndex,a=i.getSheet(r)._startCell.colIndex,u=n("#"+i._id+"_Ribbon_Case").data("ejCheckBox").isChecked(),f=n("#"+i._id+"_Ribbon_AllContent").data("ejCheckBox").isChecked(),e=this._within[n("#"+i._id+"_Ribbon_ddWithin").data("ejDropDownList").selectedIndexValue].value,s=this._sType[n("#"+i._id+"_Ribbon_ddSearch").data("ejDropDownList").selectedIndexValue].value,o=this._vType[n("#"+i._id+"_Ribbon_ddLookin").data("ejDropDownList").selectedIndexValue].value,v=this._direction[n("#"+i._id+"_Ribbon_ddDirection").data("ejDropDownList").selectedIndexValue].value,c;switch(t){case"FR_NextBtn":case"FR_PrevBtn":i.XLFndRp._findCount=0;c=t==="FR_NextBtn"?i.XLFndRp._findNext(n("#"+i._id+"_Ribbon_textFind").val(),r,u,f,o,e,s):i.XLFndRp._findPrev(n("#"+i._id+"_Ribbon_textFind").val(),r,u,f,o,e,s);c||(i.XLFndRp._updateSelection(l,a,r),h=n("#"+i._id+"_alertdlg"),i.element.ejWaitingPopup("hide"),i._renderAlertDlgContent(h,"Alert",i._getLocStr("NotFound")),h.ejDialog("open"));break;case"FR_ReplaceBtn":i.XLFndRp._replaceData(n("#"+i._id+"_Ribbon_textFind").val(),n("#"+i._id+"_Ribbon_textReplace").val(),r,u,f,o,v,e,s);break;case"FR_ReplaceAllBtn":i.XLFndRp._replaceAllData(n("#"+i._id+"_Ribbon_textFind").val(),n("#"+i._id+"_Ribbon_textReplace").val(),u,f,o,e);break;case"FR_CloseBtn":n("#"+i._id+"_FRDialog").ejDialog("close");i.setSheetFocus()}i.element.ejWaitingPopup("hide")},_renderGoToDialog:function(){var r,f,u,e,o,i=this.XLObj;n("#"+i._id+"_GoToDiv").length<1&&(r=t.buildTag("div","",{"margin-left":-6,height:282},{id:i._id+"_GoToDiv"}),n("#"+i._id+"_GoTo").append(r),u=t.buildTag("label").text(i._getLocStr("GoToName")).css("display","table"),r.append(u),e=t.buildTag("ul#"+i._id+"_GotoAddr"),r.append(e),n("#"+i._id+"_GotoAddr").ejListBox({dataSource:this._addrList,height:"190px",width:"254px",selected:n.proxy(this._gotoValChange,this),fields:{id:"Types",text:"text",value:"value"}}),u=t.buildTag("label").text(i._getLocStr("Reference")).css("display","table"),r.append(u),o=t.buildTag("input.e-ejinputtext","","",{id:i._id+"_textRef",type:"text"}).css("width","252px"),r.append(o),f=t.buildTag("div#"+i._id+"_GoToSpDiv","",{height:281,width:280,"margin-left":-7}),n("#"+i._id+"_GoToSp").append(f),u=t.buildTag("label").text(i._getLocStr("Select")).css("display","table"),f.append(u),this._renderGotoSp(n("#"+i._id+"_GoToSpDiv"),this._gotoRBtnSet1,this._gotoRBtnSet2,this._gotoChkBox),n("#"+i._id+"_GoToDiv").wrapInner('<form id="'+i._id+'_Form_GoToDiv" onsubmit="return false"><\/form>'),this._dialogValidate("_GoToDiv"))},_renderGotoSp:function(i,r,u,f){for(var l,c,s,e,h=this.XLObj,v=h._id+"_gotoSpDiv",a,y=t.buildTag("table"),o=0;o<r.length;o++)s=t.buildTag("tr","",{height:35}),e=t.buildTag("td"),l=t.buildTag("input#"+v+"_"+r[o],"",{},{type:"radio",name:"gotospecial"}),e.append(l),s.append(e),l.ejRadioButton({size:"medium",change:n.proxy(this._rBtnOnClick,this,r[o])}),e=t.buildTag("td","",{width:100}),c=t.buildTag("label",h._getLocStr(r[o]),{},{"for":v+"_"+r[o]}),e.append(c),s.append(e),h.isUndefined(u[o])||(e=t.buildTag("td"),l=t.buildTag("input#"+v+"_"+u[o],"",{},{type:"radio",name:"gotospecial"}),e.append(l),s.append(e),l.ejRadioButton({size:"medium",change:n.proxy(this._rBtnOnClick,this,u[o])}),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(u[o]),{},{"for":v+"_"+u[o]}),e.append(c),s.append(e)),y.append(s);for(o=0;o<f.length;o=o+2)s=t.buildTag("tr"),e=t.buildTag("td"),a=t.buildTag("input#"+h._id+"_"+f[o]),e.append(a),s.append(e),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(f[o]),{},{"for":h._id+"_"+f[o]}),e.append(c),s.append(e),a.ejCheckBox({checked:!0,enabled:!1}),e=t.buildTag("td"),a=t.buildTag("input#"+h._id+"_"+f[o+1]),e.append(a),s.append(e),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(f[o+1]),{},{"for":h._id+"_"+f[o+1]}),e.append(c),s.append(e),a.ejCheckBox({checked:!0,enabled:!1}),y.append(s);i.append(y);n("#"+v+"_Blanks").ejRadioButton("option",{checked:!0})},_rBtnOnClick:function(t){var r=this.XLObj,i;if(t==="Formulas"||t==="Constants")for(i=0;i<this._gotoChkBox.length;i++)n("#"+r._id+"_"+this._gotoChkBox[i]).data("ejCheckBox").option({enabled:!0});else for(i=0;i<this._gotoChkBox.length;i++)n("#"+r._id+"_"+this._gotoChkBox[i]).data("ejCheckBox").option({enabled:!1})},_gotoValChange:function(t){n("#"+this.XLObj._id+"_textRef").val(t.model.value)},_gotoBtnClick:function(t){var i=this.XLObj,v,e,u;switch(t){case"ok":if(n("#"+i._id+"_Form_GoToDiv").valid())if(v=n("#"+i._id+"_GoToDlgTab").data("ejTab"),v.model.selectedItemIndex)i.XLFndRp._applyGoToRule(n("#"+i._id+"_GoToSpDiv").find(".e-rad-active").parents("div")[0].id.split("ej"+i._id+"_gotoSpDiv_")[1].toLowerCase(),n("#"+i._id+"_"+this._gotoChkBox[0]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[1]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[2]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[3]).data("ejCheckBox").isChecked()),n("#"+i._id+"_GoDialog").ejDialog("close");else{var y,o,p=i.getActiveSheetIndex(),s=i.getSheet(p),f,h,r=n.trim(n("#"+i._id+"_textRef").val().toString()),c,l,a=i._getDollarAlphaRange(s.selectedRange);r.indexOf("!")>-1&&(l=r.split("!"),c=i._getSheetIndexByName(l[0]),r=l[1]);r.indexOf("$")>-1&&(r=r.split("$").join(""));r.indexOf(":")<0&&(r=r+":"+r);r=r.replace("=","");c&&i.gotoPage(c,!1);e=i.getRangeIndices(r);u=i.getRange(e[0],e[1],e[2],e[3]);f={rowIndex:n(u[0]).parent("tr").index(),colIndex:n(u[0]).index()};h={rowIndex:n(u[u.length-1]).parent("tr").index(),colIndex:n(u[u.length-1]).index()};i.setActiveCell(f.rowIndex,f.colIndex);i.XLSelection.selectRange(f,h);i.XLScroll._scrollSelectedPosition(i.getActiveSheetIndex(),f);i.XLDragFill.positionAutoFillElement();s._startCell=f;s._endCell=h;i.setSheetFocus();y=n.grep(this._addrList,function(n){return n.value===a});y.length<1&&(this._addrList.push({value:a,text:a}),o=n("#"+i._id+"_GotoAddr").data("ejListBox"),this._addrList=JSON.parse(JSON.stringify(this._addrList)),o.model.dataSource=this._addrList,o.option("fields",{dataSource:this._addrList}));n("#"+i._id+"_GoDialog").ejDialog("close")}break;case"cancel":n("#"+i._id+"_GoDialog").ejDialog("close")}i.setSheetFocus()},_onGroupExpander:function(t){var i=this.XLObj,r,u;switch(t.target.id){case i._id+"_Ribbon_Number_e-groupexpander":case i._id+"_Ribbon_Alignment_e-groupexpander":case i._id+"_Ribbon_Font_e-groupexpander":r=n("#"+i._id+"_numberdlg_numbertab").data("ejTab");u=t.target.id===i._id+"_Ribbon_Alignment_e-groupexpander"?1:t.target.id===i._id+"_Ribbon_Font_e-groupexpander"?2:0;r.showItem(u);this._initFormatDialog()}},_initFormatDialog:function(){var t=this.XLObj;n("#"+t._id+"_numberdlg").ejDialog("open");this._updateformatdlg();this._isWrapText=n("#"+t._id+"_alignment_wraptext").ejCheckBox("option","checked");n("#"+t._id+"_numberdlg_format_dataMnger").data({styles:{style:{}},border:{}})},_updateformatdlg:function(){var e,s,i,h,u,r,o,t=this.XLObj,c,l,f;for(s=t.XLFormat.getFormatClass(t.getActiveCellElem().prop("class"),!1),c=t.XLFormat.getFormatClass(t.getActiveCellElem().prop("class"),!0),h=t._getContent(t.getActiveSheetIndex()).find(".e-selected"),i=h.length>1,e=i?{}:t.XLFormat.getFormatFromHashCode(s),l=i?{}:t.XLFormat.getBorderFromHashCode(c),o=t.model.sheets[1]._activeCell,u=t.XLEdit.getPropertyValue(o.rowIndex,o.colIndex,"type",t.getActiveSheetIndex()),r=n("#"+t._id+"_numberdlg_numbertab_list").data("ejListBox"),r.unSelectAll(),(u==="longdate"||u==="shortdate")&&(u="date"),f=0;f<r.model.dataSource.length;f++)if(r.model.dataSource[f].Category.toLowerCase()==u){r.selectItemByIndex(f);break}this._renderInputDiv(r,"initial");this._updateAlignmentContent(e,i);this._updateFontContent(e,i);this._updateFillContent(e,i);this._updateBorderContent(l.border,i)},_listObj:function(t,i,r){return{dataSource:t,fields:{text:"text",value:"value"},height:"135px",width:i,selectIndexChanged:n.proxy(this._processpreviewaction,this,r)}},_processborderaction:function(t,i){var u=this.XLObj,s=n("#"+u._id+"_numberdlg").find("#"+u._id+"_border_preview"),d=n("#"+u._id+"_border_colorpick").data("ejColorPicker"),l=n("#"+u._id+"_border_linestyles").data("ejListBox"),a=d.getValue(),h=l.model.dataSource[l.model.selectedItemIndex].value,v=["_border_leftbroder","_border_topbroder","_border_rightbroder","_border_bottombroder"],r="1px "+h+" "+a,c=!0,y,p,w,b,k,o=n("#"+u._id+"_numberdlg_format_dataMnger"),f=o.data("border"),e=n("#"+u._id+"_border_outlinepreview td");u.isUndefined(f)||(h==="none"&&(t="none"),t==="none"&&(r="",c=!1),(t==="allside"||t==="none")&&(e.eq(1).css("border-left",r),e.eq(2).css("border-top",r),e.eq(3).css("border-top",r),e.eq(3).css("border-left",r),f=o.data("border",{}).data("border"),r.length>0&&(f.allside=r),k=n("#"+u._id+"_border_allside").data("ejButton"),k.model.text=r,s.css({"border-top":r,"border-right":r,"border-left":r,"border-bottom":r}),this._toggleButtonAction(v,c,!1)),t==="none"||t==="border"?(s.css({"border-top":r,"border-right":r,"border-left":r,"border-bottom":r}),this._toggleButtonAction(v,c,!0),e.eq(1).css("border-left",""),e.eq(2).css("border-top",""),e.eq(3).css("border-top",""),e.eq(3).css("border-left",""),y=n("#"+u._id+"_border_leftbroder").data("ejToggleButton"),p=n("#"+u._id+"_border_topbroder").data("ejToggleButton"),w=n("#"+u._id+"_border_rightbroder").data("ejToggleButton"),b=n("#"+u._id+"_border_bottombroder").data("ejToggleButton"),f=o.data("border",{}).data("border"),r.length>0?f.left=f.top=f.right=f.bottom=r:o.data("border","noborder"),y.model.activeText=p.model.activeText=w.model.activeText=b.model.activeText=r):(r=i.model.toggleState?"1px "+h+" "+a:"",s.css(t,r),i.model.activeText=r,f==="noborder"&&o.data("border",{}),r.length>0?f[t.split("-")[1]]=r:delete f[t.split("-")[1]]))},_toggleButtonAction:function(t,i,r){for(var u,f=0;f<t.length;f++)u=n("#"+this.XLObj._id+t[f]).data("ejToggleButton"),u._toggleButtonStatus(i),u.model.toggleState=i,r?u.enable():u.disable()},_processpreviewaction:function(t,i){var r=this.XLObj,f=n("#"+r._id+"_font_viewpanel"),h=n("#"+r._id+"_font_flist").data("ejListBox"),c=n("#"+r._id+"_font_fStylelist").data("ejListBox"),l=n("#"+r._id+"_font_fSizelist").data("ejListBox"),a=n("#"+r._id+"_font_colorpick").data("ejColorPicker"),b=n("#"+r._id+"_font_strike").data("ejCheckBox"),k=n("#"+r._id+"_font_underline").data("ejCheckBox"),u=n("#"+r._id+"_numberdlg_format_dataMnger").data("styles"),v,y=n("#"+r._id+"_alignment_hortxtdropdwn").data("ejDropDownList"),p=n("#"+r._id+"_alignment_indntnumericbox").data("ejNumericTextbox"),w=n("#"+r._id+"_border_colorpick").data("ejColorPicker"),e,s,o;if(!r.isUndefined(u))switch(t){case"font-family":f.css(t,i.data.value);n("#"+r._id+"_font_fontTxtbx").val(i.data.value);u.style[t]=i.data.value;break;case"font-size":f.css(t,i.data.value+"px");n("#"+r._id+"_font_fontSizeTxtbx").val(i.data.value);u.style[t]=i.data.value+"px";break;case"font-style":e=i.data.selectedItemIndex;s="font-weight";e<2?(f.css(s,""),f.css(t,i.data.dataSource[e].value),u.style[t]=i.data.dataSource[e].value,delete u.style[s]):e===2?(f.css(t,""),f.css(s,i.data.dataSource[e].value),u.style[s]=i.data.dataSource[e].value,delete u.style[t]):(f.css(s,i.data.dataSource[e-1].value),f.css(t,i.data.dataSource[e].value),u.style[t]=i.data.dataSource[e].value,u.style[s]=i.data.dataSource[e-1].value);n("#"+r._id+"_font_fontStyleTxtbx").val(i.data.dataSource[e].text);break;case"text-decoration":o=f.get(0).style.textDecoration;i.model.checked?(o=o.replace("none",""),f.get(0).style.textDecoration=o+" "+i.model.value,u.style[t]=o.length?n.trim(o)+" "+i.model.value:i.model.value):(o=n.trim(o.replace(i.model.value,"")),f.get(0).style.textDecoration=o,u.style[t]=o.length?o:"none");break;case"color":a.getValue()!==i.value&&a.setValue(i.value);a.hide();f.css(t,i.value);u.style[t]=i.value;break;case"border-color":w.setValue(i.value);w.hide();break;case"default":h.unSelectAll();c.unSelectAll();l.unSelectAll();h.selectItemByIndex(0);l.selectItemByIndex(5);c.selectItemByIndex(0);a.setValue("#000000");n("#"+r._id+"_font_fontTxtbx").val(h.model.dataSource[0].text);n("#"+r._id+"_font_fontSizeTxtbx").val(l.model.dataSource[5].text);b.option({checked:!1});k.option({checked:!1});v={"font-family":h.model.dataSource[0].text,"font-style":c.model.dataSource[0].value,"font-size":l.model.dataSource[5].text,"font-weight":c.model.dataSource[0].value,color:"#000000","text-decoration":"none"};n("#"+r._id+"_font_viewpanel").css(v);u.style=v;break;case"text-align":y.selectedIndexValue!==1&&p.option({value:0});u.style[t]=i.value;break;case"vertical-align":u.style[t]=i.value;break;case"text-indent":p.getValue()!==0&&y.option({selectedItemIndex:1});u.style[t]=i.value+"px"}},_processpreviewfillaction:function(t,i){var r=this.XLObj,o=n("#"+r._id+"_fill_viewpanel"),u=n("#"+r._id+"_numberdlg_format_dataMnger").data("styles"),f=n("#"+r._id+"_fill_nocolor").data("ejToggleButton"),e=n("#"+r._id+"_fill_colorpick").data("ejColorPicker");r.isUndefined(u)||(t==="background-color"?(o.css(t,i.value),e.model.value=i.value,f.model.preventToggle&&(f._toggleButtonStatus(!1),f.model.preventToggle=!1),u.style[t]=i.value):(e.model.value="",e._removeClass(),i.model.preventToggle=!0,o.css("background-color",""),u.style["background-color"]=""))},_updateBorderContent:function(){var t=this.XLObj,r=t._getContent(t.getActiveSheetIndex()).find(".e-selected"),i=n("#"+t._id+"_border_allside").data("ejButton");r.length>1?n("#"+t._id+"_border_outlinepreview").show()&&n("#"+t._id+"_border_previewtext").hide()&&i.enable():n("#"+t._id+"_border_outlinepreview").hide()&&n("#"+t._id+"_border_previewtext").show()&&i.disable();this._processborderaction("none")},_updateFillContent:function(i){var r=this.XLObj,e=n("#"+r._id+"_fill_viewpanel"),f=n("#"+r._id+"_fill_nocolor").data("ejToggleButton"),u=n("#"+r._id+"_fill_colorpick").data("ejColorPicker");t.isNullOrUndefined(i["background-color"])?(u.setValue(""),u._removeClass(),e.css("background-color",""),f._toggleButtonStatus(!0),f.model.preventToggle=!0):u.setValue(i["background-color"])},_updateFontContent:function(i,r){var f,u=this.XLObj,l=n("#"+u._id+"_font_flist").data("ejListBox"),e=n("#"+u._id+"_font_fStylelist").data("ejListBox"),a=n("#"+u._id+"_font_fSizelist").data("ejListBox"),d=n("#"+u._id+"_font_strike").data("ejCheckBox"),g=n("#"+u._id+"_font_underline").data("ejCheckBox"),v=n("#"+u._id+"_font_colorpick").data("ejColorPicker"),o=0,s=5,y=!1,p=!1,w=i["font-family"]||"Segoe UI",b=i["font-size"]||"14px",h=i["text-decoration"]||"none",c=i["font-weight"]==="bold",k=i["font-style"]==="italic";f=!r&&(c||k)?c&&k?3:c?2:1:0;r||(this._fontFamily.some(function(n,t){return w===n.text.toLowerCase()?(o=t,!0):!1}),this._fontSize.some(function(n,t){return b===n.value?(s=t,!0):!1}),h.indexOf("underline")>-1&&(p=!0),h.indexOf("line-through")>-1&&(y=!0));l.unSelectAll();e.unSelectAll();a.unSelectAll();l.selectItemByIndex(o);a.selectItemByIndex(s);e.selectItemByIndex(f);n("#"+u._id+"_font_fontTxtbx").val(this._fontFamily[o].text);n("#"+u._id+"_font_fontStyleTxtbx").val(e.model.dataSource[f].text);n("#"+u._id+"_font_fontSizeTxtbx").val(this._fontSize[s].text);v.setValue(t.isNullOrUndefined(i.color)?"#000000":i.color);n("#"+u._id+"_font_viewpanel").css({"font-family":w,"font-size":b,color:v.getValue(),"text-decoration":h,"font-weight":e.model.dataSource[f].value,"font-style":e.model.dataSource[f].value});d.option({checked:y});g.option({checked:p})},_updateAlignmentContent:function(i,r){var u=this.XLObj,o=n("#"+u._id+"_alignment_hortxtdropdwn").data("ejDropDownList"),s=n("#"+u._id+"_alignment_vertxtdropdwn").data("ejDropDownList"),h=n("#"+u._id+"_alignment_indntnumericbox").data("ejNumericTextbox"),f=n("#"+u._id+"_alignment_wraptext").data("ejCheckBox"),e=u.XLEdit.getPropertyValueByElem(u.getActiveCellElem(),"wrap");r&&(e=!1);o.setSelectedValue(t.isNullOrUndefined(i["text-align"])?"none":i["text-align"]);s.setSelectedValue(t.isNullOrUndefined(i["vertical-align"])?"bottom":i["vertical-align"]);h._setValue(t.isNullOrUndefined(i["text-indent"])?0:parseInt(i["text-indent"].replace("px","")));e?f.option("checked",!0):f.option("checked",!1)},_renderInputDiv:function(i,r){var c,l,y,h,f=this.XLObj,a=f._id+"_numberdlg_numbertab",nt=n("#"+a+"_check").data("ejCheckBox"),tt=n("#"+a+"_numeric").data("ejNumericTextbox"),g,p=n("#"+a+"_list").data("ejListBox"),v,u,s,w,it=t.widgetBase.formatting,b,e,o,k,d;l=t.isNullOrUndefined(i.data)&&t.isNullOrUndefined(p._selectedItemindex())?0:p._selectedItemindex();p.selectItemByIndex(l);w=t.isNullOrUndefined(i.data)?p.model.dataSource[l].Category.toLowerCase():i.data.selectedText.toLowerCase();v=f.model.sheets[f.getActiveSheetIndex()]._activeCell;u=f.XLEdit.getPropertyValue(v.rowIndex,v.colIndex,"value",f.getActiveSheetIndex());c=f.XLEdit.getPropertyValue(v.rowIndex,v.colIndex,"decimalPlaces",f.getActiveSheetIndex());c=t.isNullOrUndefined(c)?2:c;y=f.XLEdit.getPropertyValue(v.rowIndex,v.colIndex,"thousandSeparator",f.getActiveSheetIndex());y=t.isNullOrUndefined(y)?!1:y;s=u=t.isNullOrUndefined(u)?"":u;switch(w){case"number":case"accounting":case"currency":case"percentage":w==="number"?(h="{0:N"+c+"}",nt.option("checked",y)):h=w==="accounting"||w==="currency"?"{0:C"+c+"}":"{0:P"+c+"}";tt.option("value",c);u.toString().length>0&&(f._isDateTime(u)&&(u=f._dateToInt(u)),e=this._isDecimal(u),o=this._isNumber(u),(e.isDecimal||o.isNumber)&&(e.isDecimal&&(u=e.text),o.isNumber&&(u=o.text),s=f.XLFormat._format(u,{formatStr:h,thousandSeparator:y,type:w})));break;case"scientific":h="{0:N"+c+"}";u.toString().length>0&&(f._isDateTime(u)&&(u=f._dateToInt(u)),e=this._isDecimal(u),o=this._isNumber(u),(e.isDecimal||o.isNumber)&&(e.isDecimal&&(u=e.text),o.isNumber&&(u=o.text),s=parseInt(it(h,u,f.model.locale).replace(",","").replace(".","")),s=f.toExponential(s,2)));break;case"fraction":u.toString().length>0&&(f._isDateTime(u)&&(u=f._dateToInt(u)),e=this._isDecimal(u),o=this._isNumber(u),(e.isDecimal||o.isNumber)&&(e.isDecimal&&(u=e.text),o.isNumber&&(u=o.text),b=f.toFraction(u),s=t.isNullOrUndefined(b.numerator)?b.integer:b.integer+" "+b.numerator+"/"+b.denominator));break;case"time":k=n("#"+a+"_timelist").data("ejListBox");h=k.model.dataSource[k._selectedItemindex()].format;e=this._isDecimal(u);o=this._isNumber(u);e.isDecimal||o.isNumber?(e.isDecimal&&(u=parseInt(e.text)),o.isNumber&&(u=o.text),u=f.intToDate(u),s=f.XLFormat._format(u,{formatStr:h,type:"time"})):f._isDateTime(u)&&(s=f.XLFormat._format(u,{formatStr:h,type:"time"}));break;case"date":d=n("#"+a+"_datelist").data("ejListBox");h=d.model.dataSource[d._selectedItemindex()].format;e=this._isDecimal(u);o=this._isNumber(u);e.isDecimal||o.isNumber?(e.isDecimal&&(u=parseInt(e.text)),o.isNumber&&(u=o.text),u=f.intToDate(u),s=f.XLFormat._format(u,{formatStr:h,type:"shortdate"})):f._isDateTime(u)&&(s=f.XLFormat._format(u,{formatStr:h,type:"shortdate"}));break;case"general":case"text":case"custom":f._isDateTime(u)&&(s=f._dateToInt(u))}l=t.isNullOrUndefined(i.data)&&t.isNullOrUndefined(p._selectedItemindex())?0:p._selectedItemindex();g=t.isNullOrUndefined(i.data)?i.model.dataSource[l].Category.toLowerCase()==="date"?"shortdate":i.model.dataSource[l].Category.toLowerCase():i.data.selectedText.toLowerCase()==="date"?"shortdate":i.data.selectedText.toLowerCase();t.isNullOrUndefined(s)&&(s="");n("#"+a+"_display").text(s).data({type:g,formatStr:h,decimalPlaces:2,thousandSeparator:!1,value:u});r==="selectchanged"&&(n("#"+a+"_display").data().value=s);r==="initial"&&(i.model.selectedItemIndex=l,this._onselectIndexchange(i))},_isDecimal:function(n){var t={};return t.isDecimal=/^[-+]?[\d.]+$/g.test(n),t.isDecimal&&(t.text=parseFloat(n)),t},_isNumber:function(n){var t={};return t.isNumber=/^-?[0-9]+$/.test(n),t.isNumber&&(t.text=parseInt(n)),t},_onselectIndexchange:function(t){var r=this.XLObj,i=r._id+"_numberdlg_numbertab",u=n("#"+i+"_center"),f=t.model.dataSource[t.model.selectedItemIndex].Category;n("#"+i+"_general").hide();n("#"+i+"_number").hide();n("#"+i+"_accounting").hide();n("#"+i+"_currency").hide();n("#"+i+"_date").hide();n("#"+i+"_text").hide();n("#"+i+"_percentage").hide();n("#"+i+"_fraction").hide();n("#"+i+"_time").hide();n("#"+i+"_scientific").hide();n("#"+i+"_custom").hide();n("#"+i+"_"+f.toLowerCase()).show();this._renderInputDiv(t,"selectchanged");switch(f){case"Number":u.text(r._getLocStr("Number"));break;case"Currency":u.text(r._getLocStr("Currency"));break;case"Accounting":u.text(r._getLocStr("Accounting"));break;case"Percentage":u.text(r._getLocStr("Percentage"));break;case"Date":u.text(r._getLocStr("Date"));break;case"Fraction":u.text(r._getLocStr("Fractions"));break;case"Scientific":u.text(r._getLocStr("Scientific"));break;case"Time":u.text(r._getLocStr("Date"));break;case"Custom":u.text(r._getLocStr("CustomMessage"));n("#"+r._id+"_customlist").data("ejListBox")._refreshScroller();break;case"Text":u.text("");break;case"General":u.text("")}},_borderPicture:function(){var n=this.XLObj;return"<ul id="+n._id+"_Ribbon_PictureBorder><li id='"+n._id+"picturecolor'><a>"+n._getLocStr("ThemeColor")+"<\/a><ul><li><input id='"+n._id+"_Ribbon_PictureColor'><\/input><\/li><\/ul><\/li><li id='nooutline' class='picturecolor'><a>"+n._getLocStr("NoOutline")+"<\/a><\/li><li id='weight' class='picturecolor'><a>"+n._getLocStr("Weight")+"<\/a><ul><li id='1px'><a>1px<\/a><\/li><li id='2px'><a>2px<\/a><\/li><li id='3px'><a>3px<\/a><\/li><\/ul><\/li><li id='dashes' class='picturecolor'><a>"+n._getLocStr("Dashes")+"<\/a><ul><li id='solid'><a><div style='top:9px;border:1px solid black;width:40px'><\/div><\/a><\/li><li id='dotted'><a><div style='top:9px;border:1px dotted black;width:40px'><\/div><\/a><\/li><li id='dashed'><a><div style='top:9px;border:1px dashed black;width:40px'><\/div><\/a><\/li><\/ul><\/li><\/ul>"},_chartElementTag:function(){var n=this.XLObj,t="<ul id="+n._id+"_Ribbon_CElement>";return t+='<li class="axes" id="Axes"><a><span class="e-ss-chartimg e-icon e-ss-axes"><\/span>'+n._getLocStr("Axes")+'<\/a><ul><li class="phaxis e-ss-cmenuitem" id="PHAxis"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-phaxis"><\/span>'+n._getLocStr("PHAxis")+'<\/a><\/li><li class="pvaxis e-ss-cmenuitem" id="PVAxis"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pvaxis"><\/span>'+n._getLocStr("PVAxis")+"<\/a><\/li><\/ul><\/li>",t+='<li class="axistitle" id="AxisTitle"><a><span class="e-ss-chartimg e-icon e-ss-axistitle"><\/span>'+n._getLocStr("AxisTitle")+'<\/a><ul><li class="phaxistitle e-ss-cmenuitem" id="PHAxisTitle"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-phaxistitle"><\/span>'+n._getLocStr("PHAxisTitle")+'<\/a><\/li><li class="pvaxistitle e-ss-cmenuitem" id="PVAxisTitle"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pvaxistitle"><\/span>'+n._getLocStr("PVAxisTitle")+"<\/a><\/li><\/ul><\/li>",t+='<li class="charttitle" id="ChartTitle"><a><span class="e-ss-chartimg e-icon e-ss-charttitle"><\/span>'+n._getLocStr("ChartTitle")+'<\/a><ul><li class="ctnone e-ss-cmenuitem" id="CTNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctnone"><\/span>'+n._getLocStr("CTNone")+'<\/a><\/li><li class="ctcenter e-ss-cmenuitem" id="CTCenter"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctcenter"><\/span>'+n._getLocStr("CTCenter")+'<\/a><\/li><li class="ctfar e-ss-cmenuitem" id="CTFar"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctfar"><\/span>'+n._getLocStr("CTFar")+'<\/a><\/li><li class="ctnear e-ss-cmenuitem" id="CTNear"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctnear"><\/span>'+n._getLocStr("CTNear")+"<\/a><\/li><\/ul><\/li>",t+='<li class="datalabels" id="DataLabels"><a><span class="e-ss-chartimg e-icon e-ss-datalabels"><\/span>'+n._getLocStr("DataLabels")+'<\/a><ul><li class="dlnone e-ss-cmenuitem" id="DLNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlnone"><\/span>'+n._getLocStr("DLNone")+'<\/a><\/li><li class="dlcenter e-ss-cmenuitem" id="DLCenter"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlcenter"><\/span>'+n._getLocStr("DLCenter")+'<\/a><\/li><li class="dliend e-ss-cmenuitem" id="DLIEnd"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dliend"><\/span>'+n._getLocStr("DLIEnd")+'<\/a><\/li><li class="dlibase e-ss-cmenuitem" id="DLIBase"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlibase"><\/span>'+n._getLocStr("DLIBase")+'<\/a><\/li><li class="dloend e-ss-cmenuitem" id="DLOEnd"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dloend"><\/span>'+n._getLocStr("DLOEnd")+"<\/a><\/li><\/ul><\/li>",t+='<li class="gridline" id="Gridline"><a><span class="e-ss-chartimg e-icon e-ss-gridline"><\/span>'+n._getLocStr("Gridline")+'<\/a><ul><li class="pmajorh e-ss-cmenuitem" id="PMajorH"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pmajorh"><\/span>'+n._getLocStr("PMajorH")+'<\/a><\/li><li class="pmajorv e-ss-cmenuitem" id="PMajorV"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pmajorv"><\/span>'+n._getLocStr("PMajorV")+'<\/a><\/li><li class="pminorh e-ss-cmenuitem" id="PMinorH"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon  e-ss-pminorh"><\/span>'+n._getLocStr("PMinorH")+'<\/a><\/li><li class="pminorv e-ss-cmenuitem" id="PMinorV"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pminorv"><\/span>'+n._getLocStr("PMinorV")+"<\/a><\/li><\/ul><\/li>",t+('<li class="legend" id="Legend"><a><span class="e-ss-chartimg e-icon e-ss-legend"><\/span>'+n._getLocStr("Legend")+'<\/a><ul><li class="lnone e-ss-cmenuitem" id="LNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lnone"><\/span>'+n._getLocStr("LNone")+'<\/a><\/li><li class="lright e-ss-cmenuitem" id="LRight"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lright"><\/span>'+n._getLocStr("LRight")+'<\/a><\/li><li class="lleft e-ss-cmenuitem" id="LLeft"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lleft"><\/span>'+n._getLocStr("LLeft")+'<\/a><\/li><li class="lbottom e-ss-cmenuitem" id="LBottom"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lbottom"><\/span>'+n._getLocStr("LBottom")+'<\/a><\/li><li class="ltop e-ss-cmenuitem" id="LTop"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ltop"><\/span>'+n._getLocStr("LTop")+"<\/a><\/li><\/ul><\/li>")},_cFTag:function(){var t,u,i,n=this.XLObj,r=["greaterthan","lessthan","between","equalto","textcontains","dateoccur"];for(u=[n._getLocStr("GreaterThan")+"...",n._getLocStr("LessThan")+"...",n._getLocStr("Between")+"...",n._getLocStr("EqualTo")+"...",n._getLocStr("TextthatContains")+"...",n._getLocStr("DateOccurring")+"..."],i="<ul id="+n._id+"_CFormat><li id="+n._id+"_HLCellRules><a><span class='e-icon e-ss-hlcellrules'><\/span>Highlight Cell Rules<\/a><ul>",t=0;t<r.length;t++)i+="<li id='"+r[t]+"'><a><span class='e-icon e-ss-"+r[t]+"'><\/span>"+u[t]+"<\/a><\/li>";return i+("<\/ul><\/li><li id="+n._id+"_ClearRules><a><span class='e-icon e-ss-clearrules'><\/span>"+n._getLocStr("ClearRules")+"<\/a><ul><li id='clearselected'><a>"+n._getLocStr("ClearRulesfromSelected")+"<\/a><\/li><li id='clearall'><a>"+n._getLocStr("ClearRulesfromEntireSheets")+"<\/a><\/li><\/ul><\/li><\/ul>")},_renderGeneral:function(i){var r=t.buildTag("div#"+i+"_general.e-subtab"),e=this.XLObj,u=t.buildTag("div#"+i+"_top.e-generalcontent"),f=t.buildTag("div#"+i+"_displaytext.e-textcontent");f.text(e._getLocStr("GeneralTxt"));u.append(f);r.append(u);r.hide();n("#"+i+"_content").append(r)},_renderNumber:function(i){var u=t.buildTag("div#"+i+"_top.e-numbercontent"),f=this.XLObj,r=t.buildTag("div#"+i+"_number.e-subtab"),e=t.buildTag("input#"+i+"_numeric"),s=t.buildTag("label").text(f._getLocStr("DecimalPlacesTxt")),o=t.buildTag("input#"+i+"_check"),h=t.buildTag("label").text(f._getLocStr("ThousandSeparatorTxt"));u.append(s).append(e).append(o).append(h);e.ejNumericTextbox({name:"numeric",value:2,height:25,minValue:1,maxValue:30,change:n.proxy(this._decimalValueChange,this)});o.ejCheckBox({change:n.proxy(this._useGroupSeparator,this)});r.append(u);r.hide();n("#"+i+"_content").append(r)},_renderCurrency:function(i){var u=t.buildTag("div#"+i+"_top.e-currencycontent"),e=this.XLObj,r=t.buildTag("div#"+i+"_currency.e-subtab"),f=t.buildTag("input#"+i+"_numeric"),o=t.buildTag("label").text(e._getLocStr("DecimalPlacesTxt"));u.append(o).append(f);f.ejNumericTextbox({name:"numeric",value:2,height:25,minValue:1,maxValue:30,change:n.proxy(this._decimalValueChange,this)});r.append(u);r.hide();n("#"+i+"_content").append(r)},_renderAccounting:function(i){var u=t.buildTag("div#"+i+"_top.e-accountingcontent"),f=this.XLObj,r=t.buildTag("div#"+i+"_accounting.e-subtab"),e=t.buildTag("input#"+i+"_numeric"),o=t.buildTag("label").text(f._getLocStr("DecimalPlacesTxt")),s=t.buildTag("label","",{"margin-top":"10px"}).text(f._getLocStr("SymbolsTxt"));u.append(o).append(e);e.ejNumericTextbox({name:"numeric",value:2,height:25,minValue:1,maxValue:30,change:n.proxy(this._decimalValueChange,this)});r.append(u);r.hide();n("#"+i+"_content").append(r)},_renderPercentage:function(i){var u=t.buildTag("div#"+i+"_top.e-PercentageContent"),e=this.XLObj,r=t.buildTag("div#"+i+"_percentage.e-subtab"),f=t.buildTag("input#"+i+"_numeric"),o=t.buildTag("label").text(e._getLocStr("DecimalPlacesTxt"));u.append(o).append(f);f.ejNumericTextbox({name:"numeric",value:2,height:25,minValue:1,maxValue:30,change:n.proxy(this._decimalValueChange,this)});r.append(u);r.hide();n("#"+i+"_content").append(r)},_renderDate:function(i){var u=t.buildTag("div#"+i+"_top.e-dateContent"),o=this.XLObj,r=t.buildTag("div#"+i+"_date.e-subtab"),s=t.buildTag("label").text(o._getLocStr("Type")).css("display","table"),f=t.buildTag("ul#"+i+"_datelist"),e;u.append(s).append(f);e=[{type:"Wednesday, March 14, 2012",format:"{0: dddd, MMMM dd, yyyy}"},{type:"3/14/2012",format:"{0: M/d/yyyy}"},{type:"March 03",format:"{0: MMMM dd}"},{type:"2012 March",format:"{0: yyyy MMMM}"},{type:"3/14/12 1:30 PM",format:"{0: dd/MM/yyyy h:mm:ss tt}"}];f.ejListBox({dataSource:e,fields:{text:"type",value:"type"},selectedItemIndex:0,width:"270px",height:"120px",selected:n.proxy(this._dateValueChange,this)});r.append(u);r.hide();n("#"+i+"_content").append(r)},_renderText:function(i){var r=t.buildTag("div#"+i+"_text.e-subtab"),e=this.XLObj,u=t.buildTag("div#"+i+"_top"),f=t.buildTag("div#"+i+"_text.e-textcontent");f.text(e._getLocStr("TextTxt"));u.append(f);r.append(u);r.hide();n("#"+i+"_content").append(r)},_renderTime:function(i){var u=t.buildTag("div#"+i+"_top.e-timeContent"),o=this.XLObj,r=t.buildTag("div#"+i+"_time.e-subtab"),s=t.buildTag("label").text(o._getLocStr("Type")).css("display","table"),f=t.buildTag("ul#"+i+"_timelist"),e;u.append(s).append(f);e=[{type:"1:30:55 PM",format:"{0:h:mm:ss tt}"},{type:"1:30 PM",format:"{0:h:mm tt}"},{type:"13:30:55",format:"{0:h:mm:ss}"},{type:"1:30",format:"{0:hh:mm}"}];f.ejListBox({dataSource:e,fields:{text:"type",value:"format"},selectedItemIndex:0,width:"270px",height:"120px",selected:n.proxy(this._timeValueChange,this)});r.append(u);r.hide();n("#"+i+"_content").append(r)},_renderFraction:function(i){var u=t.buildTag("div#"+i+"_top.e-FractionContent"),r=t.buildTag("div#"+i+"_fraction.e-subtab");r.append(u);r.hide();n("#"+i+"_content").append(r)},_renderScientific:function(i){var u=t.buildTag("div#"+i+"_top.e-ScientificContent"),e=this.XLObj,r=t.buildTag("div#"+i+"_scientific.e-subtab"),f=t.buildTag("input#"+i+"_numeric"),o=t.buildTag("label").text(e._getLocStr("Type"));u.append(o).append(f);f.ejNumericTextbox({name:"numeric",value:2,height:25,minValue:1,maxValue:30,change:n.proxy(this._decimalValueChange,this)});r.append(u);r.hide();n("#"+i+"_content").append(r)},_renderCustom:function(t){var i=this.XLObj,r="<div id='"+t+"_custom' class='e-subtab' style='display:none' ><div>"+i._getLocStr("Type")+":<\/div><div style='width:266px'><input type='text' style='text-indent:8px' id='"+i._id+"_custominput' class='e-custominput' value='0' /><\/div><div><ul id ='"+i._id+"_customlist' class='ej-sslistbox' /><\/ul><\/div><div><button type ='text' id ='"+i._id+"_customformatdelete' class='e-custfmtdelete ej-ssbtn' >"+i._getLocStr("Delete")+"<\/button><\/div><\/div><\/div><\/div>";n("#"+t+"_content").append(r);i._on(n("#"+i._id+"_custominput"),"keydown",this._validateCustomFormat);n("#"+i._id+"_customformatdelete").ejButton({enabled:!1,size:"mini",click:n.proxy(this._customFormatDelete,this)});n("#"+i._id+"_customlist").ejListBox({width:"270px",height:"148px",dataSource:[{text:"0",type:"default"},{text:"0.00",type:"default"},{text:"#,##0",type:"default"},{text:"#,##00.00",type:"default"},{text:"0%",type:"default"},{text:"0.00%",type:"default"},{text:"m/d/yyyy",type:"default"},{text:"d-mmm",type:"default"},{text:"h:mm",type:"default"},{text:"mm:ss",type:"default"}],fields:{text:"text",value:"type"},selectIndexChanged:n.proxy(this._customFormatClick,this),allowMultiSelection:!1,selectedItemIndex:0})},_customFormatClick:function(t){var i=this.XLObj,u=i.XLFormat.customFormatParser(t.model.selectedText),r=i.getSheet(i.getActiveSheetIndex())._activeCell;n("#"+i._id+"_customformatdelete").ejButton("instance")._setModel({enabled:t.model.dataSource[t.model.selectedItemIndex].type==="custom"});n("#"+i._id+"_custominput").val(t.model.selectedText);n("#"+i._id+"_numberdlg_numbertab_display").text(i.XLFormat._format(i.XLEdit.getPropertyValue(r.rowIndex,r.colIndex),u))},_customFormatDelete:function(){var t=n("#"+this.XLObj._id+"_customlist").ejListBox("instance"),i=t.model.dataSource;i.splice(t.model.selectedItemIndex,1);t._setModel({dataSource:i})},_validateCustomFormat:function(t){var i=t?this:this.XLObj,u,r,f,e=n("#"+i._id+"_custominput").val(),o=i.XLFormat.customFormatParser(e);if(t){if(t.keyCode!==13)return;if(t.keyCode===13){i.XLRibbon._groupExpanderOk();return}}if(i.getObjectLength(o))u=n("#"+i._id+"_customlist").data("ejListBox"),r=u.model.dataSource,i._isValueAlreadyExist(r,"text",e)||(r.push({text:e,type:"custom"}),u._setModel({dataSource:r})),n("#"+i._id+"_numberdlg").ejDialog("close"),i.XLFormat.format(o);else return f=n("#"+i._id+"_alertdlg"),i._renderAlertDlgContent(f,"Alert",i._getLocStr("CustomFormatAlert")),f.ejDialog("open"),!0},_changeImport:function(i){var r=n("#"+n("#"+this._id).parents("div")[0].id).data("ejSpreadsheet"),u,f;i.files.rawFile.type.indexOf("image")>-1?(this.updialog.ejDialog("close"),r.XLShape._insertPicture(i),r.XLRibbon._formatTabUpdate()):(u=t.browserInfo(),f=u.name==="msie"&&parseInt(u.version)<10?i.responseText:i.xhr.response,this.updialog.ejDialog("close"),r.importSheet=!0,r.importSuccess(f),r.importSheet=!1);r.hideWaitingPopUp()},_menuClickHandler:function(i){var r=n("#"+this._id.split("_Menu")[0]).data("ejSpreadsheet"),u,f={element:i.element,parentId:i.parentId,parentText:i.parentText,text:i.text,event:i.event};if(r.XLEdit._isEdit&&n(r.getActiveCellElem().find("input")[0]).focus().setInputPos(n(r.getActiveCellElem().find("input")[0]).val().length),!r._trigger("menuClick",f))switch(i.ID){case"New":r.XLEdit._isSheetsDirty()&&(u=n("#"+r._id+"_alertdlg"),r._renderAlertDlgContent(u,"",r._getLocStr("DestroyAlert"),"New",470),r._alertDialog.element.ejDialog("open")&&u.focus());break;case"Open":r.XLEdit._isSheetsDirty()?(u=n("#"+r._id+"_alertdlg"),r._renderAlertDlgContent(u,"",r._getLocStr("ImportAlert"),"Open",470),r._alertDialog.element.ejDialog("open")&&u.focus()):n("#"+r._id+"_file .e-uploadinput").click();break;case"ExportXL":r.XLExport["export"](t.Spreadsheet.exportType.Excel);break;case"PrintSheet":r.XLPrint.printSheet(r.getActiveSheetIndex());break;case"PrintSelected":r.XLPrint.printSelection(r.getActiveSheetIndex());break;case"ExportCsv":r.XLExport["export"](t.Spreadsheet.exportType.Csv)}},_cpClickHandler:function(t){var i=this.XLObj;i._isApply=!0;t==="Ribbon_background-color"?i.XLFormat.format({style:{"background-color":n("#"+i._id+"_Ribbon_background-color").ejColorPicker("option","value")}}):t==="Ribbon_color"&&i.XLFormat.format({style:{color:n("#"+i._id+"_Ribbon_color").ejColorPicker("option","value")}})},_ribbonClickHandler:function(i){var y,ot,oi,gt,vt,p,w,si,f,l,ut,st,ht,yt,ft,a,k,s,pt={},u=n("#"+this._id.split("_Ribbon")[0]).data("ejSpreadsheet"),h=u.getActiveSheetIndex(),rt=u.getSheet(h),v={},c={},d=this._id.split("_"),g=t.Spreadsheet.SupportedStyles,ni,hi,ct,wi,o,tt,wt,ci,li,bt,ti,lt,dt,ii,ri,ai,vi,at,yi,it,ui,nt,b,e,et,fi,kt;if(!u._shapeChange&&!u.XLRibbon._isSetModel){if(ct=u._getContent(h),wi=u.getMainPanel(),ot=n("#"+u._id+"_Ribbon_cellformat").data("ejDropDownList"),ft=n("#"+u._id+"_Ribbon_fontsize").data("ejDropDownList"),yt=n(u.getCell(rt._activeCell.rowIndex,rt._activeCell.colIndex)),!(u.XLFormat._formatEnable||u.XLSelection._isOutsideBordering||u.XLSelection._isGridBordering)||u._id+"_Ribbon_BorderColor"===this._id||u._borderStyles.indexOf(i.ID)>-1||(u.XLSelection._isGridBordering=u.XLSelection._isOutsideBordering=u.XLFormat._formatEnable=!1,n("#"+u._id+"_Ribbon_formatpainter").ejToggleButton("option",{toggleState:!1}),!u.isUndefined(i.model.prefixIcon)&&(i.model.prefixIcon.indexOf("e-ss-drawborder")>0||i.model.prefixIcon.indexOf("e-ss-drawbordergrid")>0)&&(u.XLSelection._isGridBordering=u.XLSelection._isOutsideBordering=!0),ct.addClass("e-ss-cursor"),ct.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor e-ss-fpcursor")),hi={Id:this._id,isChecked:i.isChecked,status:i.status,prop:i.model,model:u.model},u._trigger("ribbonClick",hi)){u.XLRibbon._updateRibbonIcons();return}u.model.autoFillSettings.showFillOptions&&(u._getAutoFillOptElem().addClass("e-hide"),n("#"+u._id+"_ctxtmenu").hide());switch(this._id){case u._id+"_Ribbon_cut":u.XLClipboard.cutCells();break;case u._id+"_Ribbon_copy":u.XLClipboard.copyCells();break;case u._id+"_Ribbon_pastebtn":case u._id+"_Ribbon_pastesbtn":u.XLClipboard._isSpecial=!(i.ID==="PasteValues");u.XLClipboard.pasteCells();break;case u._id+"_Ribbon_undo":u.XLClipboard._triggerKeyDown(90,!0);break;case u._id+"_Ribbon_redo":u.XLClipboard._triggerKeyDown(89,!0);break;case u._id+"_Ribbon_wraptext":u._textFormatting("wrapText");break;case u._id+"_Ribbon_exportXL":u.XLExport["export"](t.Spreadsheet.exportType.Excel);break;case u._id+"_Ribbon_exportCsv":u.XLExport["export"](t.Spreadsheet.exportType.Csv);break;case u._id+"_Ribbon_print":u.XLPrint.printSheet(h);break;case u._id+"_Ribbon_printselected":u.XLPrint.printSelection(h);break;case u._id+"_Ribbon_new":u._cellFormatHandler(this._id.replace(u._id+"_Ribbon_",""),i.selectedText);break;case u._id+"_Ribbon_bold":c[g.FontWeight]=i.model.toggleState?"bold":"normal";v.style=c;u.XLFormat.format(v);break;case u._id+"_Ribbon_italic":c[g.FontStyle]=i.model.toggleState?"italic":"normal";v.style=c;u.XLFormat.format(v);break;case u._id+"_Ribbon_underline":case u._id+"_Ribbon_line-through":tt=u.XLFormat.getFormatFromHashCode(u.XLFormat.getFormatClass(yt[0].className))["text-decoration"]||"";i.model.toggleState?(tt=tt.replace("none",""),c[g.TextDecoration]=tt?tt.indexOf("underline")===-1?tt+" "+d[d.length-1]:d[d.length-1]+" "+tt:d[d.length-1]):(tt=n.trim(tt.replace(d[d.length-1],"")),c[g.TextDecoration]=tt.length?tt:"none");v.style=c;u.XLFormat.format(v);break;case u._id+"_Ribbon_fontsize":c[g.FontSize]=i.value;v.style=c;u.XLFormat.format(v);break;case u._id+"_Ribbon_increasefontsize":case u._id+"_Ribbon_decreasefontsize":this._id==u._id+"_Ribbon_increasefontsize"?(ht=t.isNullOrUndefined(ft.selectedIndexValue)?6:ft.selectedIndexValue+1,t.isNullOrUndefined(u.XLRibbon._fontSize[ht])||ft.option({selectedItemIndex:ht})):this._id==u._id+"_Ribbon_decreasefontsize"&&(ht=t.isNullOrUndefined(ft.selectedIndexValue)?4:ft.selectedIndexValue-1,t.isNullOrUndefined(u.XLRibbon._fontSize[ht])||ft.option({selectedItemIndex:ht}));c[g.FontSize]=ft.value();v.style=c;u.XLFormat.format(v);break;case u._id+"_Ribbon_left":case u._id+"_Ribbon_right":case u._id+"_Ribbon_center":case u._id+"_Ribbon_justify":ut=n(this.element.parents("div").eq(1)).find(".e-text-align");t.isNullOrUndefined(ut[0])||(n("#"+ut[0].id).ejToggleButton("option","toggleState",!1),ut.removeClass("e-text-align"));this.element.addClass("e-text-align");c[g.TextAlign]=i.model.toggleState?d[d.length-1]:"left";v.style=c;u.XLFormat.format(v);break;case u._id+"_Ribbon_top":case u._id+"_Ribbon_middle":case u._id+"_Ribbon_bottom":ut=n(this.element.parents("div").eq(1)).find(".e-vertical-align");t.isNullOrUndefined(ut[0])||(n("#"+ut[0].id).ejToggleButton("option","toggleState",!1),ut.removeClass("e-vertical-align"));this.element.addClass("e-vertical-align");c[g.VerticalAlign]=i.model.toggleState?d[d.length-1]:"bottom";v.style=c;u.XLFormat.format(v);break;case u._id+"_Ribbon_font-family":c[g.FontFamily]=i.text;v.style=c;u.XLFormat.format(v);break;case u._id+"_Ribbon_increaseindent":case u._id+"_Ribbon_decreaseindent":wt=u.XLFormat.getFormatFromHashCode(u.XLFormat.getFormatClass(yt[0].className));ni="text-indent"in wt?this._id===u._id+"_Ribbon_increaseindent"?Number(wt[g.TextIndent].replace("px",""))+2:Number(wt[g.TextIndent].replace("px",""))-2:this._id===u._id+"_Ribbon_decreaseindent"?-1:2;ni>=0&&((ct.find(".e-selected").length>1||wt[g.TextAlign]!=="left")&&(c[g.TextAlign]="left"),c[g.TextIndent]=ni+"px",v.style=c,u.XLFormat.format(v));u.XLRibbon._updateRibbonIcons();break;case u._id+"_Ribbon_Pheading":u.model.sheets[h].printHeader=i.isChecked;break;case u._id+"_Ribbon_Pgridlines":u.model.sheets[h].printGridlines=i.isChecked;break;case u._id+"_Ribbon_Vheading":u.showHeaders(i.isChecked);break;case u._id+"_Ribbon_Vgridlines":u.showGridlines(i.isChecked);break;case u._id+"_Ribbon_sizebtn":case u._id+"_Ribbon_sizesbtn":ci=t.isNullOrUndefined(i.ID)?i.model.prefixIcon.substring(12):i.ID;u.XLPrint._printSetting(ci);break;case u._id+"_Ribbon_cellformat":v.type=i.text.toLowerCase();u.XLFormat.format(v);break;case u._id+"_Ribbon_increment":case u._id+"_Ribbon_decrement":yt.data("type")!="number"&&n.isNumeric(u.XLEdit.getPropertyValueByElem(yt))&&(u.XLRibbon._isSetModel=!0,ot.option({selectedItemIndex:1}),u.XLRibbon._isSetModel=!1);u.XLFormat.updateDecimalPlaces(d[d.length-1]);break;case u._id+"_Ribbon_accounting":case u._id+"_Ribbon_percentage":this._id===u._id+"_Ribbon_accounting"?ot.option({selectedItemIndex:3}):ot.option({selectedItemIndex:4});v.type=ot.selectedTextValue.toLowerCase();u.XLFormat.format(v);break;case u._id+"_Ribbon_usegrouping":ot.option({selectedItemIndex:1});v.type=ot.selectedTextValue.toLowerCase();u.XLFormat.format(v);break;case u._id+"_Ribbon_sortAtoZ":u.XLSort._sortHandler("SortAtoZ");break;case u._id+"_Ribbon_sortZtoA":u.XLSort._sortHandler("SortZtoA");break;case u._id+"_Ribbon_filter":u.XLFilter.filter();break;case u._id+"_Ribbon_clearfilter":st=u.getCell(u.getActiveCell().rowIndex,u.getActiveCell().colIndex)[0].className;st.indexOf("e-table")<0?u.XLFilter.clearFilter():(a=u._getTableID(st),u.XLFilter._clearFilterTable(u.getActiveSheetIndex(),parseInt(a),!0));break;case u._id+"_Ribbon_BorderColor":pt=n("#"+u._id+"_Ribbon_BorderColor").data("ejColorPicker");t.isNullOrUndefined(pt)||pt.hide();t.isNullOrUndefined(i.value)||(u._borderColor=i.value);break;case u._id+"_Ribbon_border":u._borderStyles.indexOf(i.ID)<0?t.isNullOrUndefined(i.ID)?i.ID=i.model.prefixIcon.substring(12):i.ID.indexOf("bordercolor")<0&&n(this.element).find(".e-icon ").removeClass().addClass("e-icon e-ss-"+i.ID)&&this.option({prefixIcon:"e-icon e-ss-"+i.ID}):u.XLRibbon._updateBordeStyle(i);oi=u._borderColor||"#000000";p=rt._startCell;w=rt._endCell;li=u._getAlphaRange(h,p.rowIndex,p.colIndex,w.rowIndex,w.colIndex);u.XLSelection._isOutsideBordering||u.XLSelection._isGridBordering?u._borderStyles.indexOf(i.ID)>-1||(u.XLSelection._isOutsideBordering=u.XLSelection._isGridBordering=!1):u.setBorder({ID:i.ID,hexaCode:oi,borderStyle:u._borderStyle},li);break;case u._id+"_Ribbon_validationsbtn":case u._id+"_Ribbon_validationbtn":i.ID=="ClearVal"?u.XLValidate.clearDV():i.ID=="HighlightVal"?u.XLValidate.highlightInvalidData():i.ID=="ClearHLVal"?u.XLValidate.clearHighlightedValData():(n("#"+u._id+"_ValDialog").ejDialog("open"),n("#"+u._id+"_Form_ValDialog").validate().resetForm(),n("#"+u._id+"_Ribbon_ddType_wrapper").focus(),bt=u.XLEdit.getPropertyValueByElem(u.getActiveCellElem(h),"rule"),bt?(ti=bt.customVal,lt=ti.split("_"),ti.indexOf("list")>-1?(n("#"+u._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",5),n("#"+u._id+"_Ribbon_btnMin").val(lt[0]),n("#"+u._id+"_Ribbon_blank").ejCheckBox("option","checked",!bt.required)):(u.XLRibbon._types.some(function(n,t){if(lt[4]===n.value)return dt=t,!0}),n("#"+u._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",dt),u.XLRibbon._actions.some(function(n,t){if(lt[0]===n.value)return dt=t,!0}),n("#"+u._id+"_Ribbon_ddAction").ejDropDownList("option","selectedItemIndex",dt),n("#"+u._id+"_Ribbon_btnMin").val(lt[1].replace("^","")),n("#"+u._id+"_Ribbon_btnMax").val(lt[2].replace("^","")),n("#"+u._id+"_Ribbon_blank").ejCheckBox("option","checked",!bt.required))):(n("#"+u._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",1),n("#"+u._id+"_Ribbon_ddAction").ejDropDownList("option","selectedItemIndex",6),n("#"+u._id+"_Ribbon_btnMin").val(""),n("#"+u._id+"_Ribbon_btnMax").val(""),n("#"+u._id+"_Ribbon_blank").ejCheckBox("option","checked",!0)));break;case u._id+"_Ribbon_cFormat":if(!i.ID.length)break;u.XLRibbon._currentCFormat=i.ID;i.ID.startsWith("clear")?u.XLCFormat.clearCF(i.ID==="clearselected"):i.ID.indexOf("_HLCellRules")>0||i.ID.indexOf("_ClearRules")>0||(n("#"+u._id+"_CFDialog").ejDialog("open"),u.XLRibbon._renderCFDialog(i));break;case u._id+"_Ribbon_find":gt=n("#"+u._id+"_GoToDlgTab").data("ejTab");ii=n("#"+u._id+"_FRDialog_FPDlgTab").data("ejTab");switch(i.ID){case"Find":n("#"+u._id+"_FRDialog").ejDialog("open");ii.option({selectedItemIndex:0});n("#"+u._id+"_Ribbon_textFind").focus().setInputPos(n("#"+u._id+"_Ribbon_textFind").val().length);break;case"Replace":n("#"+u._id+"_FRDialog").ejDialog("open");ii.option({selectedItemIndex:1});n("#"+u._id+"_Ribbon_textFind").focus().setInputPos(n("#"+u._id+"_Ribbon_textFind").val().length);break;case"GoTo":n("#"+u._id+"_GoDialog").ejDialog("open");n("#"+u._id+"_Form_GoToDiv").validate().resetForm();gt.option({selectedItemIndex:0});n("#"+u._id+"_textRef").focus().setInputPos(n("#"+u._id+"_Ribbon_textFind").val().length);break;case"GoToSpecial":n("#"+u._id+"_GoDialog").ejDialog("open");gt.option({selectedItemIndex:1});n("#"+u._id+"_Blanks").focus();break;default:u.XLFndRp._applyGoToRule(i.ID.toLowerCase(),!0,!0,!0,!0)}break;case u._id+"_Ribbon_formatpainter":if(!i.model.toggleState)return!1;u.XLFormat._formatEnable=!0;ct.removeClass("e-ss-cursor");ct.addClass("e-ss-fpcursor");u.XLFormat._formatPainter();break;case u._id+"_Ribbon_convertorange":if(confirm(u._getLocStr("ConverToRangeAlert"))){for(a=parseInt(document.getElementById(u._id+"_tableid").value),k=u.getSheet(h)._tableManager,ri=u.model.sheets[h].filterSettings.tableRange,y=0;y<ri.length;y++)ri[y].tableID==a&&(ai=y);f={sheetIndex:h,reqType:"format-table",action:"convertorange",beforeFormat:u.XLFormat.getHashCodeClassAsArray()};f.tableID=a;f.format=k[a].format;f.formatName=k[a].formatName;f.tableRange=u.model.sheets[h].filterSettings.tableRange[ai];f.beforeRange=k[a].range;u.isNumber(a)&&u.XLFormat.removeTable(a);vi=u.getCell(u.getActiveCell().rowIndex,u.getActiveCell().colIndex)[0];u.XLRibbon._toggleDesignTab(vi);u._completeAction(f)}break;case u._id+"_Ribbon_resizetable":a=parseInt(document.getElementById(u._id+"_tableid").value);s=u.model.sheets[h]._tableManager[a].range;n("#"+u._id+"_fatresizetablerange").val(u._getAlphaRange(h,s[0],s[1],s[2],s[3]));n("#"+u._id+"_fatresizetabledlg").ejDialog("open");break;case u._id+"_Ribbon_tsofirstcolumn":case u._id+"_Ribbon_tsolastcolumn":k=rt._tableManager;a=document.getElementById(u._id+"_tableid").value;a in k&&(s=k[a].range,s=this._id===u._id+"_Ribbon_tsofirstcolumn"?u._getProperAlphaRange(h,s[0]+1,s[1],s[2],s[1]):u._getProperAlphaRange(h,s[0]+1,s[3],s[2],s[3]),u.XLFormat.format({style:{"font-weight":i.isChecked?"bold":"normal"}},s),f={sheetIndex:h,reqType:"format-table",action:"firstlastcolumn",range:s,check:i.isChecked,id:i.model.id},u._completeAction(f));break;case u._id+"_Ribbon_tsototalrow":k=rt._tableManager;a=document.getElementById(u._id+"_tableid").value;a in k&&(s=k[a].range,at=u.getRange(s[2]+1,s[1],s[2]+1,s[3]),yi=u._getProperAlphaRange(h,s[0]+1,s[3],s[2],s[3]),s=i.isChecked?u._getProperAlphaRange(h,s[0]+1,s[3],s[2],s[3]):"",at.length>1&&u.XLEdit.updateCellValue(n(at[0]),i.isChecked?"Total":""),u.XLEdit.updateCellValue(n(at[at.length-1]),i.isChecked?"=SUM("+s+")":""),i.isChecked?k[a].totalRow=!0:"totalRow"in k[a]&&delete k[a].totalRow,f={sheetIndex:h,reqType:"format-table",action:"totalrow",range:yi,check:i.isChecked,id:i.model.id,cell:at,tmgr:k,tid:a},u._completeAction(f));break;case u._id+"_Ribbon_tsofiltercolumn":u.XLFilter._clearFilterTableIcon(h,parseInt(document.getElementById(u._id+"_tableid").value));f={sheetIndex:h,reqType:"format-table",action:"filtericon",tableId:document.getElementById(u._id+"_tableid").value,id:i.model.id,check:i.isChecked};u._completeAction(f);break;case u._id+"_Ribbon_table":n("#"+u._id+"_fatnamedlg").ejDialog("open");document.getElementById(u._id+"_fatname").value="Table "+u.getObjectLength(rt._tableManager);n("#"+u._id+"_fatname").focus().setInputPos(0);break;case u._id+"_Ribbon_newComment":n("#"+u._id+"_Ribbon_newComment").text()===u._getLocStr("NewComment")?u.XLComment.setComment():u.XLComment.editComment();break;case u._id+"_Ribbon_deleteComment":u.XLComment.deleteComment();break;case u._id+"_Ribbon_showAllComments":u.XLComment.showAllComments();break;case u._id+"_Ribbon_showHideComment":u.XLComment.showHideComment();break;case u._id+"_Ribbon_nextComment":u.XLComment.findNextComment();break;case u._id+"_Ribbon_previousComment":u.XLComment.findPrevComment();break;case u._id+"_Ribbon_hyperlink":u._hlDlgOpen();break;case u._id+"_Ribbon_sortfilter":switch(i.ID){case"SortAtoZ":case"SortZtoA":u.XLSort._sortHandler(i.ID);break;case"Filter":u.XLFilter.filter();break;default:st=u.getCell(u.getActiveCell().rowIndex,u.getActiveCell().colIndex)[0].className;st.indexOf("e-table")<0?u.XLFilter.clearFilter():(a=u._getTableID(st),u.XLFilter._clearFilterTable(u.getActiveSheetIndex(),parseInt(a),!0))}break;case u._id+"_Ribbon_insbtn":case u._id+"_Ribbon_inssbtn":p=u.model.sheets[h]._selectedCells[0];w=u.model.sheets[h]._selectedCells[u.model.sheets[h]._selectedCells.length-1];switch(i.ID){case"InsertCells":u._renderInsertDialog();break;case"InsertSheetRows":u.insertEntireRow(p,w);break;case"InsertSheetColumns":u._insDelStatus="insert";u.insertEntireColumn(p,w);break;case"InsertSheet":u.insertSheet();break;default:u.element.find(".e-rowselected").length>0?u.insertEntireRow(p,w):u.element.find(".e-colselected").length>0?(u._insDelStatus="insert",u.insertEntireColumn(p,w)):u.insertShiftBottom(p,w)}break;case u._id+"_Ribbon_delbtn":case u._id+"_Ribbon_delsbtn":p=u.model.sheets[h]._selectedCells[0];w=u.model.sheets[h]._selectedCells[u.model.sheets[h]._selectedCells.length-1];switch(i.ID){case"DeleteCells":u._renderDeleteDialog();break;case"DeleteSheetRows":u.deleteEntireRow(p,w,[]);break;case"DeleteSheetColumns":u._insDelStatus="delete";u.deleteEntireColumn(p,w,[]);break;case"DeleteSheet":u.deleteSheet(h);break;default:u.element.find(".e-rowselected").length>0?u.deleteEntireRow(p,w):u.element.find(".e-colselected").length>0?(u._insDelStatus="insert",u.deleteEntireColumn(p,w)):u.deleteShiftUp(p,w)}break;case u._id+"_Ribbon_clear":s=rt.selectedRange;switch(i.ID){case"Clear_All":s=u._getAlphaRange(h,s[0],s[1],s[2],s[3]);u.clearAll(s);break;case"Clear_Formats":s=u._getAlphaRange(h,s[0],s[1],s[2],s[3]);u.clearAllFormat(s);break;case"Clear_Contents":s=u._getAlphaRange(h,s[0],s[1],s[2],s[3]);u.clearContents(s);break;case"Clear_Comments":u.XLComment.deleteComment(r,"clear");break;default:u._removeHyperlink("clear")}u.XLSelection._clearBorder(u._arrayAsString(u._cutFocus),h);break;case u._id+"_Ribbon_pivotTable":if(si={sheetIndex:h,model:u.model.sheets},u._trigger("_createPivotTable",si))return;break;case u._id+"_Ribbon_charttype":n("#"+u._id+"_charttypedlg").ejDialog("open");break;case u._id+"_Ribbon_pictures":u._uploadImage=!0;n("#"+u._id+"_file .e-uploadinput").click();u.XLRibbon._toggleFormatTab();break;case u._id+"_Ribbon_namemanager":it=n("#"+u._id+"_nmgrid").data("ejGrid");it.getContentTable().find("td").addClass("e-ss-emptyrecord");it.model.dataSource.length<1?it.getContentTable().find("td").addClass("e-ss-emptyrecord"):it.getContentTable().find(".e-ss-emptyrecord").removeClass("e-ss-emptyrecord");n("#"+u._id+"_nmdlg").ejDialog("open");n("#"+u._id+"_nmgrid").focus();break;case u._id+"_Ribbon_definename":it=n("#"+u._id+"_nmgrid").data("ejGrid");it.getContentTable().find("td").addClass("e-ss-emptyrecord");it.model.dataSource.length<1?it.getContentTable().find("td").addClass("e-ss-emptyrecord"):it.getContentTable().find(".e-ss-emptyrecord").removeClass("e-ss-emptyrecord");n("#"+u._id+"_nmdlg").ejDialog("open");n("#"+u._id+"_nmgrid").ejGrid("instance").addRecord();n("#"+u._id+"_nmgridEditForm input")[0].focus();break;case u._id+"_Ribbon_fPane":switch(i.ID){case"freezePanes":u.XLFreeze.freezePanes(u.model.sheets[h]._activeCell);break;case"FreezeRow":u.XLFreeze.freezeTopRow();break;case"FreezeColumn":u.XLFreeze.freezeFirstColumn();break;case"unfreezePanes":u.XLFreeze.unfreezePanes()}break;case u._id+"_Ribbon_merge":t.isNullOrUndefined(i.ID)&&(u._mergeCenter=!0,u.mergeCells());switch(i.ID){case"MergeCells":u.mergeCells();break;case"MergeAcross":u.mergeAcrossCell();break;case"MergeAndCenter":u._mergeCenter=!0;u.mergeCells();break;case"UnmergeCells":u.unmergeCells()}break;case u._id+"_Ribbon_autosum":vt=rt.selectedRange;u.XLRibbon.autoSum(i.ID.toUpperCase(),u._getAlphaRange(h,vt[0],vt[1],vt[2],vt[3]));break;case u._id+"_Ribbon_cElement":o=u.getSheet(h)._shapeMngr.chart[u.XLEdit.getPropertyValue(u.XLShape._picCellIdx.rowIndex,u.XLShape._picCellIdx.colIndex,"chart")[0]];nt=document.getElementById(u._id+"_chart").value;e=n("#"+nt).ejChart("instance");f={sheetIndex:h,reqType:"shape",shapeType:"chart",cid:nt,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex};switch(i.ID){case"PHAxis":f.visibility=!e.model.primaryXAxis.visible;e.option("primaryXAxis",{visible:f.visibility});o.xAxis.visible=f.visibility;f.action=i.ID;break;case"PVAxis":f.visibility=!e.model.primaryYAxis.visible;e.option("primaryYAxis",{visible:f.visibility});o.yAxis.visible=f.visibility;f.action=i.ID;break;case"PHAxisTitle":u._cOpt.prev={text:o.xAxis.title.text};e.model.primaryXAxis.title.text.length!=0?(e.option("primaryXAxis",{title:{text:""}}),o.xAxis.title.text="",f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"PX",cid:nt,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,prev:{text:u._cOpt.prev.text},cur:{text:""}},u._completeAction(f)):(u._hasTitle="PX",document.getElementById(u._id+"_chartname").value=o.xAxis.title.text,n("#"+u._id+"_chartnamedlg").ejDialog("open"),n("#"+u._id+"_chartname").focus().setInputPos(o.xAxis.title.text.length),u._cOpt={prevText:o.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"PVAxisTitle":u._cOpt.prev={text:o.yAxis.title.text};e.model.primaryYAxis.title.text.length!=0?(e.option("primaryYAxis",{title:{text:""}}),o.yAxis.title.text="",f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"PY",cid:nt,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,prev:{text:u._cOpt.prev.text},cur:{text:""}},u._completeAction(f)):(u._hasTitle="PY",document.getElementById(u._id+"_chartname").value=o.yAxis.title.text,n("#"+u._id+"_chartnamedlg").ejDialog("open"),n("#"+u._id+"_chartname").focus().setInputPos(o.yAxis.title.text.length),u._cOpt={prevText:o.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"CTNone":u._cOpt.prev={text:o.xAxis.title.text};e.model.title.text.length!=0?(e.option("title",{text:""}),o.title.text="",f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"CT",cid:nt,rowIndex:u._picCellIdx.rowIndex,colIndex:u._picCellIdx.colIndex,prev:{text:u._cOpt.prev.text},cur:{text:""}},u._completeAction(f)):(u._hasTitle="CT",document.getElementById(u._id+"_chartname").value=o.title.text,n("#"+u._id+"_chartnamedlg").ejDialog("open"),n("#"+u._id+"_chartname").focus().setInputPos(o.title.text.length),u._cOpt={prevText:o.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"CTCenter":u._hasTitle="CT";u._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(u._id+"_chartname").value=o.title.text;n("#"+u._id+"_chartnamedlg").ejDialog("open");n("#"+u._id+"_chartname").focus().setInputPos(o.title.text.length);e.option("title",{textAlignment:"center"});u._cOpt.curAlign=e.model.title.textAlignment;o.title.align="center";break;case"CTFar":u._hasTitle="CT";u._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(u._id+"_chartname").value=o.title.text;n("#"+u._id+"_chartnamedlg").ejDialog("open");n("#"+u._id+"_chartname").focus().setInputPos(o.title.text.length);e.option("title",{textAlignment:"far"});u._cOpt.curAlign=e.model.title.textAlignment;o.title.align="far";break;case"CTNear":u._hasTitle="CT";u._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(u._id+"_chartname").value=o.title.text;n("#"+u._id+"_chartnamedlg").ejDialog("open");n("#"+u._id+"_chartname").focus().setInputPos(o.title.text.length);e.option("title",{textAlignment:"near"});u._cOpt.curAlign=e.model.title.textAlignment;o.title.align="near";break;case"DLNone":for(b=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},ui=e.model.series[0].marker.dataLabel.visible?!1:!0,y=0;y<e.model.series.length;y++)b.push({marker:{dataLabel:{visible:ui,verticalTextAlignment:"far",textPosition:"top"}}});e.option({series:b});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:ui};break;case"DLCenter":for(b=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},y=0;y<e.model.series.length;y++)b.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"center",textPosition:"middle"}}});e.option({series:b});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"center",tPosn:"middle"};break;case"DLIBase":for(b=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},y=0;y<e.model.series.length;y++)b.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"far",textPosition:"bottom"}}});e.option({series:b});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"far",tPosn:"bottom"};break;case"DLIEnd":for(b=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},y=0;y<e.model.series.length;y++)b.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"near",textPosition:"top"}}});e.option({series:b});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"near",tPosn:"top"};break;case"DLOEnd":for(b=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},y=0;y<e.model.series.length;y++)b.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"far",textPosition:"top"}}});e.option({series:b});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"far",tPosn:"top"};break;case"PMajorH":f.visibility=!e.model.primaryYAxis.majorGridLines.visible;e.option("primaryYAxis",{majorGridLines:{visible:f.visibility}});o.yAxis.majorGridLines={visible:f.visibility};f.action=i.ID;break;case"PMajorV":f.visibility=!e.model.primaryXAxis.majorGridLines.visible;e.option("primaryXAxis",{majorGridLines:{visible:f.visibility}});o.xAxis.majorGridLines={visible:f.visibility};f.action=i.ID;break;case"PMinorH":f.visibility=!e.model.primaryYAxis.minorGridLines.visible;e.option("primaryYAxis",{minorGridLines:{visible:f.visibility},minorTicksPerInterval:5,minorTickLines:{visible:f.visibility}});o.yAxis.minorGridLines={visible:f.visibility};f.action=i.ID;break;case"PMinorV":f.visibility=!e.model.primaryXAxis.minorGridLines.visible;e.option("primaryXAxis",{minorGridLines:{visible:f.visibility},minorTicksPerInterval:5,minorTickLines:{visible:f.visibility}});o.xAxis.minorGridLines={visible:f.visibility};f.action=i.ID;break;case"LNone":f.visibility=!e.model.legend.visible;e.option("legend",{visible:f.visibility});o.legend.visible=f.visibility;f.action=i.ID;break;case"LLeft":f.prev={position:e.model.legend.position};e.option("legend",{position:"left"});o.legend.position="left";f.cur={position:e.model.legend.position};f.action="Legend";break;case"LRight":f.prev={position:e.model.legend.position};e.option("legend",{position:"right"});o.legend.position="right";f.cur={position:e.model.legend.position};f.action="Legend";break;case"LBottom":f.prev={position:e.model.legend.position};e.option("legend",{position:"bottom"});o.legend.position="bottom";f.cur={position:e.model.legend.position};f.action="Legend";break;case"LTop":f.prev={position:e.model.legend.position};e.option("legend",{position:"top"});o.legend.position="top";f.cur={position:e.model.legend.position};f.action="Legend"}t.isNullOrUndefined(f.action)||u._completeAction(f);break;case u._id+"_Ribbon_chartwidth":u.XLRibbon._changeChartSize("height",i.value);break;case u._id+"_Ribbon_chartheight":u.XLRibbon._changeChartSize("width",i.value);break;case u._id+"_Ribbon_srcolumn":nt=document.getElementById(u._id+"_chart").value;e=n("#"+nt).ejChart("instance");o=u.XLChart._getShapeObj(nt,"chart");f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"srcolumn",cid:nt,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex};e.model.series.length=0;o.isRowColSwitched=!o.isRowColSwitched;pt={xRange:o.xRange,yRange:o.yRange,lRange:o.lRange,isRowColSwitched:o.isRowColSwitched,dataSheetIdx:o.dataSheetIdx};et=u.XLChart._processChartSeries(pt);e.option({series:et.series});u.getActiveSheetIndex()===o.dataSheetIdx&&u.XLChart._focusChartRange(et.xRange,et.yRange,et.lRange);o.xAxis.range=et.xRange;o.yAxis.range=et.yRange;o.legend.range=et.lRange;u._completeAction(f);break;case u._id+"_Ribbon_PictureColor":case u._id+"_Ribbon_pictureborder":l=u.element.find(".e-ss-activeimg");fi=new RegExp("\\be-shapebdr.*?\\b","g");c=l[0].className.match(fi)?u.XLShape._getImgStyleFromHashCode(l[0].className.match(fi)[0]):{"border-color":"transparent","border-width":"1px","border-style":"solid"};var ei=c["border-color"],pi=c["border-width"],c=c["border-style"];if(u._cOpt={prevColor:l.css("border-color"),prevWidth:l.css("border-width"),prevStyle:l.css("border-style")},l[0]){switch(!0){case this._id.indexOf("PictureColor")>-1:ei=i.value;break;case i.ID.indexOf("px")>-1:pi=i.ID;break;case i.ID==="nooutline":ei="transparent";break;default:c=i.ID}u.XLShape._updateImgBorder(l[0],pi,c,ei)}break;case u._id+"_Ribbon_resetpic":l=u.element.find(".e-ss-activeimg");f={sheetIndex:h,reqType:"shape",shapeType:"picture",action:"resetpic",id:n(l).attr("id"),actionType:i.ID};i.ID==="resetpicture"?(f.prev={color:l.css("border-color"),style:l.css("border-style"),width:l.css("border-width")},l[0].className=l[0].className.replace(new RegExp("\\be-shapebdr.*?\\b","g"),""),f.cur={color:l.css("border-color"),style:l.css("border-style"),width:l.css("border-width")}):(f.prev={width:l.css("width"),height:l.css("height")},l.css({width:u.model.pictureSettings.width,height:u.model.pictureSettings.height}),f.cur={width:l.css("width"),height:l.css("height")},u.XLShape._updateShapeObj(l[0]),u.XLRibbon._formatTabUpdate());u._completeAction(f);break;case u._id+"_Ribbon_changepic":u._uploadImage=!0;u.XLShape._changePicture=!0;u.element.find("#"+u._id+"_file .e-uploadinput").click();u.XLRibbon._toggleFormatTab();break;case u._id+"_Ribbon_selectData":nt=document.getElementById(u._id+"_chart").value;o=u.XLChart._getShapeObj(nt,"chart");n("#"+u._id+"_crxaxis").val(o.xRange?u._getAlphaRange(h,o.xRange[0],o.xRange[1],o.xRange[2],o.xRange[3]):"");n("#"+u._id+"_cryaxis").val(o.yRange?u._getAlphaRange(h,o.yRange[0],o.yRange[1],o.yRange[2],o.yRange[3]):"");n("#"+u._id+"_crlaxis").val(o.lRange?u._getAlphaRange(h,o.lRange[0],o.lRange[1],o.lRange[2],o.lRange[3]):"");n("#"+u._id+"_chartrangedlg").ejDialog("open");n("#"+u._id+"_crxaxis").focus().setInputPos(0);break;case u._id+"_Ribbon_chartTheme":kt=u.element.find("#"+u._id+"_chart").val();f={sheetIndex:h,reqType:"shape",action:"chartTheme"};f.prev={theme:n("#"+kt).data("ejChart").model.theme};this.selectedTextValue.indexOf("Dark")>-1?n("#"+kt).addClass("e-ss-charttheme"):n("#"+kt).removeClass("e-ss-charttheme");u.XLChart.refreshChart(kt,{theme:this._selectedValue});f.cur={theme:this._selectedValue};u._completeAction(f)}}},_changeChartSize:function(t,i){var r=this.XLObj,h,o=r.XLEdit.getPropertyValue(r.XLShape._picCellIdx.rowIndex,r.XLShape._picCellIdx.colIndex,"chart")[0],f=document.getElementById(r._id+"_chart").value,u=n("#"+f).ejChart("instance"),s=n("#"+f),e={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:t,cid:f,rowIndex:r.XLShape._picCellIdx.rowIndex,colIndex:r.XLShape._picCellIdx.colIndex,prev:{width:u.model.size.width,height:u.model.size.height}};h=u.model.size;t==="height"?(u.option("size",{width:i.toString()}),o.width=i,s[0].style.width=i+"px",e.cur={width:i.toString(),height:u.model.size.height}):(u.option("size",{height:i.toString()}),o.height=i,s[0].style.height=i+"px",e.cur={width:u.model.size.width,height:i.toString()});r._completeAction(e)},_updateBordeStyle:function(n){var t=this.XLObj;t._borderStyle=n.ID&&n.ID.length>0&&n.ID},_pictureColorOpen:function(){var t=n("#"+this._id+"picturecolor");n("#"+this._id+"_Ribbon_PictureColor").ejColorPicker("show");n("#"+this._id+"_Ribbon_PictureColor_popup").find(".e-footerContainer").hide();n("#"+this._id+"_Ribbon_PictureColor_popup").offset({left:t.offset().left+150,top:t.offset().top+10})},_pictureColorClose:function(){n("#"+this._id+"_Ribbon_PictureColor").ejColorPicker("hide")},_colorPickerHandler:function(t,i){var u,r=this.XLObj,f;i.type==="open"?n("#"+r._id+"_"+t+"_popup").find(".e-buttons, .e-button").hide():i.type==="change"&&(u=r.XLFormat,f=n("#"+r._id+"_"+t).data("ejColorPicker"),t==="Ribbon_color"?(u.format({style:{color:i.value}}),n("#"+r._id+"_Ribbon_home_Font_Color").find(".e-selected-color").css("background-color",i.value)):(u.format({style:{"background-color":i.value}}),n("#"+r._id+"_Ribbon_home_Font_Background").find(".e-selected-color").css("background-color",i.value)),f.hide(),f.setValue(i.value))},_updateRibbonIcons:function(){if(this.XLObj.model.showRibbon){var i=this.XLObj,e=n("#"+i._id+"_Ribbon_cellformat").data("ejDropDownList"),o=n("#"+i._id+"_Ribbon_fontsize").data("ejDropDownList");n("#"+i._id+"_Ribbon_fontsize").css("width","auto");var s=n("#"+i._id+"_Ribbon_font-family").data("ejDropDownList"),u=-1,f,l=n("#"+i._id+"_Ribbon").data("ejRibbon");switch(l.getTabText(l.model.selectedItemIndex)){case"HOME":var y=i.getActiveSheetIndex(),a=i.getSheet(y),h=n(i.getCell(a._activeCell.rowIndex,a._activeCell.colIndex)),c=i.XLEdit.getPropertyValueByElem(h,"wrap"),p=i.XLEdit.getPropertyValueByElem(h,"isMerge"),r=i.XLFormat.getFormatFromHashCode(i.XLFormat.getFormatClass(h[0].className)),v=i.XLEdit.getPropertyValueByElem(h,"type");i.isUndefined(c)&&(c=!1);n("#"+i._id+"_Ribbon_wraptext").ejToggleButton("option",{toggleState:c});p?(n("#"+i._id+"_Ribbon_merge").addClass("e-ss-active"),n("#"+i._id+"_Ribbon_mergedrpbtn").addClass("e-ss-active")):(n("#"+i._id+"_Ribbon_merge").removeClass("e-ss-active"),n("#"+i._id+"_Ribbon_mergedrpbtn").removeClass("e-ss-active"));v&&this._numberFormat.some(function(n,t){return v===n.text.toLowerCase()?(u=t,!0):!1});e._initValue=!0;u>-1?e.option({selectedItemIndex:u}):!t.isNullOrUndefined(e.selectedIndexValue)&&e.selectedIndexValue!=0&&e.option({selectedItemIndex:0});e._initValue=!1;r&&(t.isNullOrUndefined(r["font-size"])?u=-1:this._fontSize.some(function(n,t){return r["font-size"]===n.value?(u=t,!0):!1}),o._initValue=!0,u>-1?o.option({selectedItemIndex:u})||(u=-1):!t.isNullOrUndefined(o.selectedIndexValue)&&o.selectedIndexValue!=5&&o.option({selectedItemIndex:5}),o._initValue=!1,t.isNullOrUndefined(r["font-family"])?u=-1:this._fontFamily.some(function(n,t){return r["font-family"]===n.text.toLowerCase()?(u=t,!0):!1}),s._initValue=!0,u>-1?s.option({selectedItemIndex:u}):!t.isNullOrUndefined(s.selectedIndexValue)&&s.selectedIndexValue!=0&&s.option({selectedItemIndex:0}),s._initValue=!1,r["font-weight"]=="bold"?n("#"+i._id+"_Ribbon_bold").data("ejToggleButton").option("toggleState",!0):n("#"+i._id+"_Ribbon_bold").data("ejToggleButton").option("toggleState",!1),r["font-style"]=="italic"?n("#"+i._id+"_Ribbon_italic").data("ejToggleButton").option("toggleState",!0):n("#"+i._id+"_Ribbon_italic").data("ejToggleButton").option("toggleState",!1),r["text-decoration"]=r["text-decoration"]||"",n("#"+i._id+"_Ribbon_underline").data("ejToggleButton").option("toggleState",r["text-decoration"].indexOf("underline")!==-1),n("#"+i._id+"_Ribbon_line-through").data("ejToggleButton").option("toggleState",r["text-decoration"].indexOf("line-through")!==-1),f=n(i.element).find(".e-text-align"),t.isNullOrUndefined(f[0])||(n("#"+f[0].id).data("ejToggleButton").option("toggleState",!1)||f.removeClass("e-text-align")),t.isNullOrUndefined(r["text-align"])||(n("#"+i._id+"_Ribbon_"+r["text-align"]).data("ejToggleButton").option("toggleState",!0)||n("#"+i._id+"_Ribbon_"+r["text-align"]).addClass("e-text-align")),f=n(i.element).find(".e-vertical-align"),t.isNullOrUndefined(f[0])||(n("#"+f[0].id).data("ejToggleButton").option("toggleState",!1)||f.removeClass("e-vertical-align")),t.isNullOrUndefined(r["vertical-align"])?n("#"+i._id+"_Ribbon_bottom").data("ejToggleButton").option("toggleState",!0)||n("#"+i._id+"_Ribbon_bottom").addClass("e-vertical-align"):n("#"+i._id+"_Ribbon_"+r["vertical-align"]).data("ejToggleButton").option("toggleState",!0)||n("#"+i._id+"_Ribbon_"+r["vertical-align"]).addClass("e-vertical-align"));break;case"REVIEW":!i.model.allowComments||i.XLComment._isCommentEdit||i.XLEdit._isEdit||i._isSheetRename||i.XLComment._updateCmntRibIcons(i.getActiveCellElem())}}},_disableButtons:function(n,t){for(var r,f=this.XLObj,i=0,u=n.length;i<u;i++)r=f.element.find("#"+f._id+"_Ribbon_"+n[i]),r.length&&r.data(t).disable()},_enableButtons:function(n,t){for(var r,f=this.XLObj,i=0,u=n.length;i<u;i++)r=f.element.find("#"+f._id+"_Ribbon_"+n[i]),r.length&&r.data(t).enable()},_disableInputs:function(t,i){for(var r=0,u=t.length;r<u;r++)n("#"+this.XLObj._id+"_"+t[r]).attr("disabled",i)},_enableRibbonIcons:function(){if(this.XLObj.model.showRibbon){var t=this.XLObj,i=n("#"+t._id+"_Ribbon").data("ejRibbon");switch(i.getTabText(i.model.selectedItemIndex)){case"HOME":this._enableButtons(this._homeBtnIds,"ejButton");this._enableButtons(this._toggleBtnIds,"ejToggleButton");this._enableButtons(this._ddIds,"ejDropDownList");this._enableButtons(this._cpIds,"ejColorPicker");this._enableButtons(this._splitBtnIds,"ejSplitButton");this._enableButtons(this._homeSptBtnIds,"ejSplitButton");break;case"INSERT":this._enableButtons(this._insertBtnIds,"ejButton");this._enableButtons(this._insertSptBtnIds,"ejSplitButton");break;case"DATA":this._enableButtons(this._dataBtnIds,"ejButton");this._enableButtons(this._dataSptBtnIds,"ejSplitButton");break;case"PAGE LAYOUT":this._enableButtons(this._pageLaySptBtnIds,"ejSplitButton");this._enableButtons(this._pageLayBtnIds,"ejButton");this._enableButtons(this._pageLayChckBxIds,"ejCheckBox");break;case"FORMULAS":this._enableButtons(this._formulaBtnIds,"ejButton");this._enableButtons(this._formulaSptBtnIds,"ejSplitButton");break;case"REVIEW":t.model.allowComments&&!t.XLComment._isCommentEdit&&t.XLComment._updateCmntRibIcons();break;case"OTHERS":this._enableButtons(this._othersSptBtnIds,"ejSplitButton");this._enableButtons(this._othersBtnIds,"ejButton");break;case"Design":this._enableButtons(this._contextualBtnIds,"ejButton");this._enableButtons(this._contextualCheckBoxIds,"ejCheckBox");this._disableInputs(this._contextualInputIds,!1)}t.XLClipboard._copyBackup.cells||(t.XLRibbon._disableButtons(["pastebtn"],"ejButton")||t.XLRibbon._disableButtons(["pastesbtn"],"ejSplitButton"))}},_disableRibbonIcons:function(){if(this.XLObj.model.showRibbon){var t=n("#"+this.XLObj._id+"_Ribbon").data("ejRibbon");switch(t.getTabText(t.model.selectedItemIndex)){case"HOME":this._disableButtons(this._homeBtnIds,"ejButton");this._disableButtons(this._toggleBtnIds,"ejToggleButton");this._disableButtons(this._ddIds,"ejDropDownList");this._disableButtons(this._cpIds,"ejColorPicker");this._disableButtons(this._splitBtnIds,"ejSplitButton");this._disableButtons(this._homeSptBtnIds,"ejSplitButton");break;case"INSERT":this._disableButtons(this._insertBtnIds,"ejButton");this._disableButtons(this._insertSptBtnIds,"ejSplitButton");break;case"DATA":this._disableButtons(this._dataBtnIds,"ejButton");this._disableButtons(this._dataSptBtnIds,"ejSplitButton");break;case"PAGE LAYOUT":this._disableButtons(this._pageLaySptBtnIds,"ejSplitButton");this._disableButtons(this._pageLayBtnIds,"ejButton");this._disableButtons(this._pageLayChckBxIds,"ejCheckBox");break;case"FORMULAS":this._disableButtons(this._formulaBtnIds,"ejButton");this._disableButtons(this._formulaSptBtnIds,"ejSplitButton");break;case"REVIEW":this._disableButtons(this._cmntBtnIds,"ejButton");this._disableButtons(this._cmntTglBtnIds,"ejToggleButton");break;case"OTHERS":this._disableButtons(this._othersSptBtnIds,"ejSplitButton");this._disableButtons(this._othersBtnIds,"ejButton");break;case"Design":this._disableButtons(this._contextualBtnIds,"ejButton");this._disableButtons(this._contextualCheckBoxIds,"ejCheckBox");this._disableInputs(this._contextualInputIds,!0)}}},_capitalize:function(n){return n[0].toUpperCase()+n.slice(1)},_generateToggleBtn:function(i,r,u,f,e,o,s,h,c,l){return{id:i,toolTip:this.XLObj._getLocStr(r),type:t.Ribbon.type.toggleButton,enableSeparator:c,toggleButtonSettings:{width:o,height:s,contentType:u,cssClass:l,defaultPrefixIcon:f,activePrefixIcon:f,defaultText:this.XLObj._getLocStr(r),activeText:this.XLObj._getLocStr(r),click:n.proxy(this._ribbonClickHandler)},customToolTip:{title:this.XLObj._getLocStr(e),content:"<h6>"+this.XLObj._getLocStr(h)+"<\/h6>"}}},_generateBtn:function(i,r,u,f,e,o,s,h,c,l,a){return{id:i,text:this.XLObj._getLocStr(r),toolTip:this.XLObj._getLocStr(r),cssClass:a,enableSeparator:c,type:t.Ribbon.type.button,buttonSettings:{contentType:u,width:e,height:o,imagePosition:l=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,prefixIcon:f,click:n.proxy(this._ribbonClickHandler)},customToolTip:{title:this.XLObj._getLocStr(s),content:"<h6>"+this.XLObj._getLocStr(h)+"<\/h6>"}}},_generateDD:function(i,r,u,f,e,o,s,h){return{id:i,text:this.XLObj._getLocStr(r),toolTip:this.XLObj._getLocStr(r),type:t.Ribbon.type.dropDownList,dropdownSettings:{dataSource:u,value:f,popupHide:n.proxy(this._ribbonClickHandler),width:e,height:o},customToolTip:{title:this.XLObj._getLocStr(s),content:"<h6>"+this.XLObj._getLocStr(h)+"<\/h6>"}}},_generateCustomControl:function(i,r,u,f){return{type:t.Ribbon.type.custom,contentID:i,toolTip:this.XLObj._getLocStr(r),click:n.proxy(this._ribbonClickHandler),change:n.proxy(this._ribbonClickHandler),customToolTip:{title:this.XLObj._getLocStr(u),content:"<h6>"+this.XLObj._getLocStr(f)+"<\/h6>"}}},_generateSplitBtn:function(i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){return{id:i,toolTip:this.XLObj._getLocStr(r),text:this.XLObj._getLocStr(r),type:t.Ribbon.type.splitButton,cssClass:y,enableSeparator:s,splitButtonSettings:{contentType:u,targetID:f,arrowPosition:l=="bottom"?t.ArrowPosition.Bottom:t.ArrowPosition.Right,imagePosition:a=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,buttonMode:v=="dropdown"?t.ButtonMode.Dropdown:t.ButtonMode.Split,fields:e,prefixIcon:o,click:n.proxy(this._ribbonClickHandler),itemSelected:n.proxy(this._ribbonClickHandler),height:c,width:h,beforeOpen:i==="sortfilter"?n.proxy(this._sfbeforeOpen,this):i==="inssbtn"||i==="delsbtn"?n.proxy(this._insdelbeforOpen,this):i==="fPane"?n.proxy(this._fpbeforeOpen,this):null},customToolTip:{title:this.XLObj._getLocStr(p),content:"<h6>"+this.XLObj._getLocStr(w)+"<\/h6>"}}},_fpbeforeOpen:function(){var t=this.XLObj,r=t.getActiveSheetIndex(),u=n("#"+t._id+"_Ribbon_FPane").data("ejMenu"),i=u.model.fields.dataSource.slice(0);t.getFrozenRows(r)>0||t.getFrozenColumns(r)>0?(i[0].id="unfreezePanes",i[0].text=t._getLocStr("unfreezePanes")):(i[0].id="freezePanes",i[0].text=t._getLocStr("freezePanes"));u.option("fields",{id:"id",dataSource:i,parentId:"parentId"})},_sfbeforeOpen:function(){var t=this.XLObj,i=n("#"+t._id+"_Ribbon_SortFilter").data("ejMenu"),r;r=t.getCell(t.getActiveCell().rowIndex,t.getActiveCell().colIndex)[0];t.model.allowFiltering||i.disableItemByID("Filter");t.model.allowSorting||(i.disableItemByID("SortAtoZ"),i.disableItemByID("SortZtoA"));this._changeClrFltrStatus(i,"menu",r)},_insdelbeforOpen:function(){var t=this.XLObj,i=n("#"+t._id+"_Ribbon_Ins").data("ejMenu"),r=n("#"+t._id+"_Ribbon_Del").data("ejMenu");t.element.find(".e-colselected").length?(i.disableItemByID("InsertSheetRows"),r.disableItemByID("DeleteSheetRows")):(i.enableItemByID("InsertSheetRows"),r.enableItemByID("DeleteSheetRows"));t.element.find(".e-rowselected").length?(i.disableItemByID("InsertSheetColumns"),r.disableItemByID("DeleteSheetColumns")):(i.enableItemByID("InsertSheetColumns"),r.enableItemByID("DeleteSheetColumns"))},_changeClrFltrStatus:function(n,t,i){var f=this.XLObj,s=f.getActiveSheetIndex(),e=!1,u,r,o;for(t==="menu"?n.disableItemByID("ClearFilter"):n.disable(),i.className.indexOf("e-table")<0&&(e=!0),u=f._getContent(s).find("span.e-ssfiltered, span.e-ssfiltered-asc, span.e-ssfiltered-dsc"),r=0,o=u.length;r<o;r++)if(e){if(u[r].className.indexOf("e-ft")<0){t==="menu"?n.enableItemByID("ClearFilter"):n.enable();break}}else if(u[r].className.indexOf("e-ft")>0){t==="menu"?n.enableItemByID("ClearFilter"):n.enable();break}},_onControlCreated:function(){var i,r,t=this.XLObj;i=(t.isNumber(t.model.scrollSettings.height)?t.model.scrollSettings.height:t.element.height())-(n("#"+t._id+"_Ribbon").height()-t.element.find(".e-ribbon .e-content").eq(0).height()+t._formulaHeight)-40;r=t.isNumber(t.model.scrollSettings.width)?t.model.scrollSettings.width-40:t.element.width()-40;t.model.allowCellFormatting&&(n("#"+t._id+"_Ribbon_background-color").ejColorPicker({value:"#FFFF00",modelType:"palette",cssClass:"e-spreadsheet e-ss-colorpicker",toolIcon:"e-ss-backgroundcolor",open:n.proxy(this._colorPickerHandler,this,"Ribbon_background-color"),change:n.proxy(this._colorPickerHandler,this,"Ribbon_background-color"),select:n.proxy(this._cpClickHandler,this,"Ribbon_background-color")}),n("#"+t._id+"_Ribbon_color").ejColorPicker({value:"#FF0000",modelType:"palette",cssClass:"e-spreadsheet e-ss-colorpicker",toolIcon:"e-ss-fontcolor",open:n.proxy(this._colorPickerHandler,this,"Ribbon_color"),change:n.proxy(this._colorPickerHandler,this,"Ribbon_color"),select:n.proxy(this._cpClickHandler,this,"Ribbon_color")}),n("#"+t._id+"_Ribbon_BorderColor").ejColorPicker({modelType:"palette",presetType:"basic",cssClass:"e-spreadsheet",change:n.proxy(this._ribbonClickHandler)}),n("#"+t._id+"_Ribbon_BorderColorWrapper").hide(),n("#"+t._id+"_Ribbon_BorderColor_popup").height("100px"),n("#"+t._id+"_Ribbon_BorderColor_popup").css({display:"block"}),n("#"+t._id+"_Ribbon_BorderCP").ejColorPicker({value:"#278787",displayInline:!0,modelType:"picker"}),n("#"+t._id+"_Ribbon_BorderCP_Presets").hide(),n("#"+t._id+"_Ribbon_Border").width(200),n("#"+t._id+"_CFormat").width(180),n("#"+t._id+"_Ribbon_Border").addClass("e-spreadsheet e-border"),n("#"+t._id+"_Ribbon_color_Presets").width(118),n("#"+t._id+"_Ribbon_background-color_Presets").width(118));t.model.printSettings.allowPageSetup&&(n("#"+t._id+"_Ribbon_pagesetupleft").show(),n("#"+t._id+"_Ribbon_pagesetupright").show(),n("#"+t._id+"_Ribbon_Pheading").ejCheckBox({change:n.proxy(this._ribbonClickHandler)}),n("#"+t._id+"_Ribbon_Pgridlines").ejCheckBox({change:n.proxy(this._ribbonClickHandler)}),n("#"+t._id+"_Ribbon_Vheading").ejCheckBox({change:n.proxy(this._ribbonClickHandler),checked:!0}),n("#"+t._id+"_Ribbon_Vgridlines").ejCheckBox({change:n.proxy(this._ribbonClickHandler),checked:!0}));t.model.allowFormatAsTable&&(n("#"+t._id+"_Ribbon_tsofirstcolumn").ejCheckBox({change:n.proxy(this._ribbonClickHandler)}),n("#"+t._id+"_Ribbon_tsolastcolumn").ejCheckBox({change:n.proxy(this._ribbonClickHandler)}),n("#"+t._id+"_Ribbon_tsototalrow").ejCheckBox({change:n.proxy(this._ribbonClickHandler)}),n("#"+t._id+"_Ribbon_tsofiltercolumn").ejCheckBox({change:n.proxy(this._ribbonClickHandler)}));t.model.allowCharts&&(n("#"+t._id+"_Ribbon_chartwidth").ejNumericTextbox({name:"numeric",value:5,minValue:0,maxValue:r,decimalPlaces:1,incrementStep:5,change:n.proxy(this._ribbonClickHandler)}),n("#"+t._id+"_Ribbon_chartheight").ejNumericTextbox({name:"numeric",value:5,minValue:0,maxValue:i,decimalPlaces:1,incrementStep:5,change:n.proxy(this._ribbonClickHandler)}));t.model.pictureSettings.allowPictures&&(n("#"+t._id+"_pictureheight").ejNumericTextbox({name:"numeric",value:100,minValue:25,incrementStep:5,change:n.proxy(this._pictureSizeChange,this,"picturewidth")}),n("#"+t._id+"_picturewidth").ejNumericTextbox({name:"numeric",value:100,minValue:25,incrementStep:5,change:n.proxy(this._pictureSizeChange,this,"pictureheight")}),n("#"+t._id+"_Ribbon_PictureColor").ejColorPicker({modelType:"palette",presetType:"basic",cssClass:"e-spreadsheet",change:n.proxy(this._ribbonClickHandler)}),n("#"+t._id+"_Ribbon_PictureColorWrapper").hide(),n("#"+t._id+"_Ribbon_PictureColor_popup").height(100));n("#"+t._id+"_Ribbon_Validation").width(160);this._disableButtons(["pastebtn"],"ejButton");this._disableButtons(["pastesbtn","useinformula"],"ejSplitButton");n("#"+t._id+"_Ribbon_background-color_popup").find(".e-buttons, .e-button").hide();n("#"+t._id+"_Ribbon_color_popup").find(".e-buttons, .e-button").hide()},_fileSelect:function(t){var i=n("#"+n("#"+this._id).parents("div")[0].id).data("ejSpreadsheet"),r=n("#"+i._id+"_alertdlg");if(i._uploadImage&&t[0].extension===".xlsx"||!i._uploadImage&&t[0].rawFile.type.indexOf("image")>-1)return i._renderAlertDlgContent(r,"Alert",i._getLocStr("CorrectFormat"),""),i._alertDialog.element.ejDialog("open")&&r.focus(),!1;i._uploadImage=!1;i.showWaitingPopUp()},_pictureSizeChange:function(t,i){var u=this.XLObj,f,r=u.element.find(".e-ss-activeimg"),e={sheetIndex:u.getActiveSheetIndex(),reqType:"shape",shapeType:"picture",action:"picturesize",name:t,id:n(r).attr("id"),prev:{},cur:{}};u._shapeChange||u.XLRibbon._isSetModel||(e.prev={width:r.width(),height:r.height()},t==="pictureheight"?(f=parseInt(r.height()*i.value/r.width()),r.css({width:i.value,height:f}),e.cur={width:i.value,height:f}):(f=parseInt(r.width()*i.value/r.height()),r.css({height:i.value,width:f}),e.cur={height:i.value,width:f}),u.XLRibbon._isSetModel=!0,n("#"+u._id+"_"+t).ejNumericTextbox("option",{value:f}),u.XLRibbon._isSetModel=!1,u._completeAction(e),u.XLShape._updateShapeObj(r[0]))},_decimalValueChange:function(i){var r=this.XLObj,s=n("#"+r._id+"_numberdlg_numbertab_check").data("ejCheckBox"),h=n("#"+r._id+"_numberdlg_numbertab_list").data("ejListBox"),o,u,c,e,f=h.model.dataSource[h._selectedItemindex()].Category.toLowerCase();(e=r.XLFormat._getFormatString(f,i.value),e)&&((o=r.model.sheets[r.getActiveSheetIndex()]._activeCell,u=r.XLEdit.getPropertyValue(o.rowIndex,o.colIndex,"value",r.getActiveSheetIndex()),t.isNullOrUndefined(u))||(r._isDateTime(u)&&(u=r._dateToInt(u)),c=r.XLFormat._format(u,{formatStr:e,type:f,thousandSeparator:s.isChecked(),decimalPlaces:i.value}),n(".e-dlgtext").text(c),f==="date"&&(f="shortdate"),n.extend(n(".e-dlgtext").data(),{formatStr:e,decimalPlaces:i.value,type:f,thousandSeparator:s.isChecked()})))},_useGroupSeparator:function(i){var r=this.XLObj,e=r._id+"_numberdlg_numbertab",h=n("#"+e+"_list").data("ejListBox"),c=n("#"+e+"_numeric").data("ejNumericTextbox"),s,u,l,o,f=h.model.dataSource[h._selectedItemindex()].Category.toLowerCase();(o=r.XLFormat._getFormatString(f,c.model.value),o)&&((s=r.model.sheets[r.getActiveSheetIndex()]._activeCell,u=r.XLEdit.getPropertyValue(s.rowIndex,s.colIndex,"value",r.getActiveSheetIndex()),t.isNullOrUndefined(u))||(r._isDateTime(u)&&(u=r._dateToInt(u)),l=r.XLFormat._format(u,{formatStr:o,type:f,thousandSeparator:i.isChecked}),n("#"+e+"_display").text(l),f==="date"&&(f="shortdate"),n.extend(n("#"+e+"_display").data(),{formatStr:o,decimalPlaces:c.model.value,type:f,thousandSeparator:i.isChecked})))},_dateValueChange:function(i){var u=this.XLObj,s=u._id+"_numberdlg_numbertab",r,h,f,c,l=n("#"+s+"_list").data("ejListBox"),a,e,o;(h=u.model.sheets[u.getActiveSheetIndex()]._activeCell,r=u.XLEdit.getPropertyValue(h.rowIndex,h.colIndex,"value",u.getActiveSheetIndex()),t.isNullOrUndefined(r))||(f=this._getSelectedListFormat(i.model.dataSource,i.selectedText),l.model.dataSource[l._selectedItemindex()].Category.toLowerCase()==="date"&&(a="shortdate"),e=this._isDecimal(r),o=this._isNumber(r),e.isDecimal||o.isNumber?(e.isDecimal&&(r=parseInt(e.text)),o.isNumber&&(r=o.text),r=u.intToDate(r),c=u.XLFormat._format(r,{formatStr:f,type:"shortdate"})):c=u._isDateTime(r)?u.XLFormat._format(r,{formatStr:f,type:"shortdate"}):r,n("#"+s+"_display").text(c),n.extend(n("#"+s+"_display").data(),{value:r,type:"shortdate",formatStr:f}))},_timeValueChange:function(i){var u=this.XLObj,c=u._id+"_numberdlg_numbertab",r,l,e,a,f=n("#"+c+"_list").data("ejListBox"),o,s,h;(o=f.model.dataSource[f._selectedItemindex()].Category.toLowerCase(),l=u.model.sheets[u.getActiveSheetIndex()]._activeCell,r=u.XLEdit.getPropertyValue(l.rowIndex,l.colIndex,"value",u.getActiveSheetIndex()),t.isNullOrUndefined(r))||(e=u.XLRibbon._getSelectedListFormat(i.model.dataSource,i.selectedText),s=this._isDecimal(r),h=this._isNumber(r),s.isDecimal||h.isNumber?(s.isDecimal&&(r=parseInt(s.text)),h.isNumber&&(r=h.text),r=u.intToDate(r),a=u.XLFormat._format(r,{formatStr:e,type:f.model.dataSource[f._selectedItemindex()].Category.toLowerCase()})):a=u._isDateTime(r)?u.XLFormat._format(r,{formatStr:e,type:f.model.dataSource[f._selectedItemindex()].Category.toLowerCase()}):r,n("#"+c+"_display").text(a),o==="date"&&(o="shortdate"),n.extend(n("#"+c+"_display").data(),{value:r,type:o,formatStr:e}))},_getSelectedListFormat:function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i].type===t)return n[i].format},_groupExpanderOk:function(){var i=this.XLObj,f=n("#"+i._id+"_numberdlg_numbertab_list").data("ejListBox"),r=n("#"+i._id+"_numberdlg_format_dataMnger").data(),e=n("#"+i._id+"_numberdlg_numbertab_display").data(),u=n("#"+i._id+"_alignment_wraptext").data("ejCheckBox");(f.model.value==="Custom"?i.XLRibbon._validateCustomFormat():i.XLFormat.format(e))||(i.XLFormat.format(r.styles),jQuery.isEmptyObject(r.border)||(t.isNullOrUndefined(r.border.allside)||(i.XLFormat.applyBorder(r.border.allside),delete r.border.allside),i.XLFormat.applyBorder(r.border)),this._isWrapText!=u.option("checked")&&i.setWrapText(null,u.option("checked")?"wrap":"unwrap"),this._updateRibbonIcons(),this._isWrapText=!1,n("#"+i._id+"_numberdlg").ejDialog("close"),i.setSheetFocus())},_groupExpanderCancel:function(){var t=this.XLObj;n("#"+t._id+"_numberdlg").ejDialog("close");t.setSheetFocus()},_chartTypeOk:function(){var r=this.XLObj,o=r.element.find("#"+r._id+"_chart").val(),u=n("#"+o).data("ejChart"),e,t,f,s,h,i;f=n("#"+r._id+"_allchart").find(".e-chartselect")[0].classList[1];t=f.split("e-dlg")[1].split("chart");s=["e-dlgcolumnchart4","e-dlgcolumnchart5","e-dlgcolumnchart6","e-dlgbarchart4","e-dlgbarchart5","e-dlgbarchart6","e-dlgpiechart2"];h=["e-dlgstockchart2","e-dlglinechart2","dlgradarchart2"];i={type:t[0],enable3D:!1,marker:{visible:!1}};(t[0]==="column"||t[0]==="bar"||t[0]==="area")&&(t[1]==="1"||t[1]==="4"?i.type=t[0]:t[1]==="2"||t[1]==="5"?i.type="stacking"+t[0]:(t[1]==="3"||t[1]==="6")&&(i.type="stacking"+t[0]+"100"));s.indexOf(f)>-1&&(i.enable3D=!0);h.indexOf(f)>-1&&(i.marker={visible:!0});f==="e-dlgpiechart3"&&(i.type="doughnut");e={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:"chartType",chartId:o};e.prev={chartType:u.model.series[0].type,enable3D:u.model.enable3D,marker:u.model.series[0].marker.visible};r.XLChart.refreshChart(o,i);e.cur={chartType:u.model.series[0].type,enable3D:u.model.enable3D,marker:u.model.series[0].marker.visible};n("#"+r._id+"_charttypedlg").ejDialog("close");r._completeAction(e)},_chartTypeCancel:function(){var t=this.XLObj;n("#"+t._id+"_charttypedlg").ejDialog("close");t.setSheetFocus()},_chartType:function(i,r,u,f,e){var h,o,l=0,c=this.XLObj,a=c._getLocStr(i).split("/"),v=i.toLowerCase(),s;for(h=t.buildTag("div#"+c._id+"_Ribbon_"+i,"",{width:"auto"}),h.append("<div class='e-chartheader'><span>"+a[0]+"<\/span><\/div>"),s=t.buildTag("div.e-chartcontent"),o=0;o<r;o++)s.append("<div class='e-chartcell e-"+v+(o+1)+"' title="+e[o]+"><\/div>"),n(s).children().eq(o).data({type:e[o],enable3D:!1,marker:{visible:!1}}),o===u&&(h.append(s).append("<div class='e-chartheader'><span>"+a[1]+"<\/span><\/div>"),s=t.buildTag("div.e-chartcontent")),o>f&&(n(s).children().eq(l).data({type:e[o],enable3D:!0,marker:{visible:!1}}),l++);h.append(s);s=n(h).find(".e-"+v+"2");(i==="StockChart"||i==="LineChart")&&s.data({marker:{visible:!0}});i==="PieChart"&&s.data({enable3D:!0});c.element.append(h)},autoSum:function(i,r){if(this.XLObj.model.allowAutoSum){var v,k,d,s=this.XLObj,p=s.XLEdit,c=s.getActiveSheetIndex(),g=s.getActiveCell(c),w,b=s.getRangeIndices(r),u=s.XLSelection._getSelectedRange({rowIndex:b[0],colIndex:b[1]},{rowIndex:b[2],colIndex:b[3]}),h=u.length-1,y=s.getActiveCellElem(c),nt=u[h].rowIndex-u[0].rowIndex,tt=u[h].colIndex-u[0].colIndex,a={sheetIndex:c,range:r,reqType:"auto-sum",oprType:i},f,e,l,it=s.getRange(u[0].rowIndex,u[0].colIndex,u[h].rowIndex,u[h].colIndex).text().length,o=s._dataContainer.sheets[c];if(h!==0&&it)if(nt===0&&tt>0)w=s._getAlphaRange(c,u[0].rowIndex,u[0].colIndex,u[h].rowIndex,u[h].colIndex),f=u[h].rowIndex,e=u[h].colIndex+1,l=s.getCell(f,e,c),a.updCell={rowIndex:f,colIndex:e,pObj:{},pValue:l.text()},t.isNullOrUndefined(o[f])&&(o[f]={}),t.isNullOrUndefined(o[f][e])&&(o[f][e]={}),n.extend(!0,a.updCell.pObj,o[f][e]),p.updateCellValue(l,"="+i+"("+w+")"),l.addClass("e-ralign");else for(d=u[h].colIndex-u[0].colIndex,v=0;v<=d;v++)w=s._getAlphaRange(c,u[0].rowIndex,u[v].colIndex,u[h].rowIndex,u[v].colIndex),f=u[h].rowIndex+1,e=u[v].colIndex,l=s.getCell(f,e,c),a.updCell={rowIndex:f,colIndex:e,pObj:{},pValue:l.text()},t.isNullOrUndefined(o[f])&&(o[f]={}),t.isNullOrUndefined(o[f][e])&&(o[f][e]={}),n.extend(!0,a.updCell.pObj,o[f][e]),p.updateCellValue(l,"="+i+"("+w+")"),l.addClass("e-ralign");else f=y.parent().index(),e=y[0].cellIndex,a.updCell={rowIndex:f,colIndex:e,pObj:{},pValue:y.text()},t.isNullOrUndefined(o[f])&&(o[f]={}),t.isNullOrUndefined(o[f][e])&&(o[f][e]={}),n.extend(!0,a.updCell.pObj,o[f][e]),p.updateCell(y,"="+i+"()"),p.editCell(g.rowIndex,g.colIndex,!0),k=y.find("input"),k.focus().setInputPos(k.val().length-1);s._isUndoRedo||s._completeAction(a)}},_dirtySelect:function(t){var i=n("#"+this.XLObj._id+"_contextMenuCell").data("ejMenu"),r=["sortfilter","inssbtn","delsbtn","formatastable","clear"],u=["convertorange","table","filter","clearfilter"];t.not("[class*='e-table']").length>0&&t.is("[class*='e-table']")?(this._disableButtons(r,"ejSplitButton"),this._disableButtons(u,"ejButton"),i.disableItemByID("Sort"),i.disableItemByID("Insert"),i.disableItemByID("Delete")):(this._enableButtons(r,"ejSplitButton"),this._enableButtons(u,"ejButton"),i.enableItemByID("Sort"),i.enableItemByID("Insert"),i.enableItemByID("Delete"))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.freezepane=function(n){this.XLObj=n;this._isFirstRow=!1;this._isFirstColumn=!1};t.spreadsheetFeatures.freezepane.prototype={freezeTopRow:function(){var n=this.XLObj,i=n.getActiveSheetIndex(),t=n.getSheet(i);n.model.allowFreezing&&(this._getFirstFreezeRow(),this._isFirstRow=!0,this.freezeRows(t._firstRow.idx===0?1:t._firstRow.idx))},_getFirstFreezeRow:function(){for(var t=this.XLObj,r=t.getActiveSheetIndex(),u=t.getSheet(r),i=u._rowHeightCollection,f=t._getContent(r).find(".e-vscrollbar").data("ejScrollBar"),e=f.element.find(".e-vhandle")[0].offsetTop*f._scrollData.onePx,n=0,o=i.length;n<o;n++)if(i[n].value>=e){u._firstRow={idx:n,value:i[n].value};break}},freezeFirstColumn:function(){var n=this.XLObj,i=n.getActiveSheetIndex(),t=n.getSheet(i);n.model.allowFreezing&&(this._getFirstFreezeColumn(),this._isFirstColumn=!0,this.freezeColumns(t._firstCol.idx===0?1:t._firstCol.idx))},_getFirstFreezeColumn:function(){for(var t=this.XLObj,r=t.getActiveSheetIndex(),u=t.getSheet(r),i=u._colWidthCollection,f=t._getContent(r).find(".e-hscrollbar").data("ejScrollBar"),e=f.element.find(".e-hhandle")[0].offsetLeft*f._scrollData.onePx,n=0,o=i.length;n<o;n++)if(i[n].value>=e){u._firstCol={idx:n,value:i[n].value};break}},freezeRows:function(t){var i=this.XLObj,u;if(i.model.allowFreezing){this._isFirstRow||this._getFirstFreezeRow();var r=i.getActiveSheetIndex(),f=i.getSheet(r),s=i.model.sheets[r]._firstRow;(i.getFrozenRows(r)>0||i.getFrozenColumns(r)>0)&&this.unfreezePanes();var h=i.getRows(r)[0],e=i.getRows(r)[1],o=i._getContent(r).find(".e-vscrollbar").data("ejScrollBar");for(f._frozenHeight=0,i.XLScroll._refreshScroller(r,"refresh","vertical"),o.element.find(".e-vhandle").css("top",0),o.value(0),t>0&&(i.setFrozenRows(t,r),this._updateRowHeightCollection(),f._currentTopFrozenRow=t,n(e[t-1]).addClass("e-frozerow").find("td").addClass("e-frrow"),n(h[t-1]).addClass("e-frozerow").find("td").addClass("e-frrow")),u=0;u<s.idx;u++)f._frozenHeight+=parseInt(e[u].style.height)}},freezeColumns:function(t){var i=this.XLObj,o;if(i.model.allowFreezing){this._isFirstColumn&&this._getFirstFreezeColumn();var r=i.getActiveSheetIndex(),u,s,h=i.model.sheets[r]._firstCol,c=i._getJSSheetHeader(r).find("tr"),f=i.getSheet(r),e=i.getRows(r)[1];if((i.getFrozenRows(r)>0||i.getFrozenColumns(r)>0)&&this.unfreezePanes(r),o=i._getContent(r).find(".e-hscrollbar").data("ejScrollBar"),this._updateColWidthCollection(),f._frozenWidth=0,i.XLScroll._refreshScroller(r,"refresh","horizontal"),o.element.find(".e-hhandle").css("left",0),o.value(0),t>0){for(i.setFrozenColumns(t,r),f._currentLeftFrozenColumn=t,c.find("th").eq(t-1).addClass("e-frozecolumn"),u=0,s=e.length;u<s;u++)n(e[u]).find("td").eq(t-1).addClass("e-frozecolumn");for(u=0;u<h.idx;u++)f._frozenWidth+=n(e[0]).find("td")[u].offsetWidth}}},freezePanes:function(i){var h,c,f=this.XLObj,u=f.getActiveSheetIndex(),p=f.getRows(u)[1],s=f.getSheet(u),w=f._getContent(u),v=f.getSheet(u)._rowHeightCollection,y=f.getSheet(u)._colWidthCollection,b,k,d,g,e,o,l,r,a;if((f.getFrozenRows(u)>0||f.getFrozenColumns(u)>0)&&this.unfreezePanes(u),h=w.find(".e-vscrollbar").data("ejScrollBar"),c=w.find(".e-hscrollbar").data("ejScrollBar"),e=0,o=0,t.isNullOrUndefined(i)||(e=i.rowIndex,o=i.colIndex),e>0&&o>0){for(s._frozenHeight=0,s._frozenWidth=0,b=h.element.find(".e-vhandle")[0].offsetTop*h._scrollData.onePx,r=0,l=v.length;r<l;r++)if(v[r].value>=b){d=f.getSheet(u)._firstRow={idx:r,value:v[r].value};break}for(k=c.element.find(".e-hhandle")[0].offsetLeft*c._scrollData.onePx,r=0,l=y.length;r<l;r++)if(y[r].value>=k){g=f.model.sheets[u]._firstCol={idx:r,value:y[r].value};break}for(r=0;r<d.idx;r++)s._frozenHeight+=parseInt(p[r].style.height);for(a=0;a<g.idx;a++)s._frozenWidth+=n(p[0]).find("td")[a].offsetWidth;f.setFrozenColumns(o,u);f.setFrozenRows(e,u);s._currentTopFrozenRow=e;s._currentLeftFrozenColumn=o;this._updateRowHeightCollection();this._updateColWidthCollection();this._applyFreeze(u);f.XLScroll._refreshScroller(u,"refresh","all");h.element.find(".e-vhandle").css("top",0);h.value(0);c.element.find(".e-hhandle").css("left",0);c.value(0)}else e<1&&o>0?this.freezeColumns(o):o<1&&e>0&&this.freezeRows(e)},_applyFreeze:function(t){var i=this.XLObj,o=i._getJSSheetHeader(t).find("tr"),s=i.getRows(t)[0],u=i.getRows(t)[1],f=i.getFrozenColumns(t),r,e;for(n(u[i.getFrozenRows(t)-1]).addClass("e-frozerow").find("td").addClass("e-frrow"),n(s[i.getFrozenRows(t)-1]).addClass("e-frozerow").find("td").addClass("e-frrow"),o.find("th").eq(f-1).addClass("e-frozecolumn"),r=0,e=u.length;r<e;r++)n(u[r]).find("td").eq(f-1).addClass("e-frozecolumn")},unfreezePanes:function(){var t=this.XLObj,i=t.getActiveSheetIndex(),r,u;t.model.allowFreezing&&(r=t._getContent(i).find(".e-vscrollbar").data("ejScrollBar"),u=t._getContent(i).find(".e-hscrollbar").data("ejScrollBar"),r.element.find(".e-vhandle").css("top",0),r.value(0),u.element.find(".e-hhandle").css("left",0),u.value(0),t.setFrozenColumns(0,i),t.setFrozenRows(0,i),t._getJSSheetHeader(i).find(".e-table").find("th").removeClass("e-frozecolumn").removeClass("e-frrow"),t._getJSSheetRowHeader(i).find(".e-table").find("td").removeClass("e-frozecolumn").removeClass("e-frrow"),t._getContent(i).find(".e-table").find("td").removeClass("e-frozecolumn").removeClass("e-frrow"),n(t.getRows(i)[1]).removeClass("e-frozerow"),n(t.getRows(i)[0]).removeClass("e-frozerow"),n(t.getRows(i)[0]).removeClass("e-fr-hide"),n(t.getRows(i)[1]).removeClass("e-fr-hide"),t._getContent(i).find("col").removeClass("e-fc-hide"),n(t._getJSSheetHeader(i).find("col")).removeClass("e-fc-hide"),t.model.sheets[i]._frozenHeight=0,t.model.sheets[i]._frozenWidth=0,t.XLScroll._getRowHeightsAfterInsert(i),t.XLScroll._getColWidthsAfterInsert(i),r.scroll(0))},_getTopRow:function(n,t){for(var r=this.XLObj,u=r.getFrozenRows(t),f=0,i=0,e=r.model.sheets[t]._rowHeightCollection.length;i<e;i++)if(f=i,r.model.sheets[t]._rowHeightCollection[i].value>n){u=r.model.sheets[t]._rowHeightCollection[i].idx;break}return{imaginaryIndex:u,actualIndex:u,i:f}},_getLeftColumn:function(n,t){for(var r=this.XLObj,u=r.getFrozenColumns(t),f=0,i=0,e=r.model.sheets[t]._colWidthCollection.length;i<e;i++)if(f=i,r.model.sheets[t]._colWidthCollection[i].value>n){u=r.model.sheets[t]._colWidthCollection[i].idx;break}return{imaginaryIndex:u,actualIndex:u,i:f}},_showHideRow:function(t,i,r,u,f){var o=this.XLObj,s=o.getRows(t),e,c=o.getSheet(t),a=o._getContent(t).find(".e-content").height(),l=0,v=o._getContent(t).find(".e-table").height(),y=o.getSheet(t)._firstRow,h=o.getSheet(t)._fpHiddenHeight;if(u==="hide")for(e=i;e<=r;e++)a>v-(y.value+n(s[0][e]).height())&&o.XLScroll._createNewRow(t,-1,-1,"insert"),o._hasClass(s[0][e],"e-fr-hide")||(h=h+n(s[0][e]).height()),o.addClass(s[0][e],"e-fr-hide"),o.addClass(s[1][e],"e-fr-hide"),c._currentTopFrozenRow=e;else{for(e=i;e<=r;e++)o._hasClass(s[0][e],"e-fr-hide")&&(o._removeClass(s[0][e],"e-fr-hide"),o._removeClass(s[1][e],"e-fr-hide"),l=n(s[0][e]).height(),h=h-l<=0?0:h-l);c._currentTopFrozenRow=i}c._fpHiddenHeight=h;c._currentTopPosition=f},_hideRow:function(t){var r=this.XLObj,i=r.getSheet(t),u=r.getRows(t),f=i._fpHiddenHeight;r._hasClass(u[0][i._currentTopFrozenRow],"e-fr-hide")||(r.addClass(u[0][i._currentTopFrozenRow],"e-fr-hide"),r.addClass(u[1][i._currentTopFrozenRow],"e-fr-hide"),i._fpHiddenHeight=f+n(u[0][i._currentTopFrozenRow]).height());i._currentTopFrozenRow=i._currentTopFrozenRow+1},_showHideColumn:function(t,i,r,u){var s,c,y={rowIndex:-1,colIndex:-1},h=r,f=this.XLObj,l=f._getContent(t).find(".e-table").find("col"),p=f._getJSSheetHeader(t).find("col"),e,o,a,w=f._getContent(t).find(".e-content").width(),b=f._getContent(t).find(".e-table").width(),k=f.model.sheets[t]._firstCol,v=f.getSheet(t)._fpHiddenWidth;if(u==="hide"){for(e=i;e<=r;e++)for(h=e,n(l[h]).addClass("e-fc-hide"),n(p[e]).addClass("e-fc-hide"),v=v+n(l[h]).width(),w>b-(k.value+f.model.columnWidth)&&f.XLScroll._createNewColumn(t,y,y,"insert"),s=f._getContent(t).find(".e-filterspan"),o=0,a=s.length;o<a;o++)c=n(s[o]).parent()[0].cellIndex,c===h&&n(s[o]).addClass("e-hide");f.model.sheets[t]._currentLeftFrozenColumn=h}else{for(e=i;e<=h;e++)for(n(l[e]).removeClass("e-fc-hide"),n(p[e]).removeClass("e-fc-hide"),v=v-n(l[h]).width(),s=f._getContent(t).find(".e-filterspan"),o=0,a=s.length;o<a;o++)c=n(s[o]).parent()[0].cellIndex,c===e&&n(s[o]).removeClass("e-hide");f.model.sheets[t]._currentLeftFrozenColumn=i}f.model.sheets[t]._currentLeftFrozenColumn<=f.getFrozenColumns(t)&&(f.model.sheets[t]._currentLeftFrozenColumn=f.getFrozenColumns(t))},_hideColumn:function(t){var i=this.XLObj,r=i.model.sheets[t]._currentLeftFrozenColumn,u=i._getContent(t).find("col"),e=i._getJSSheetHeader(t).find("col"),f=i.getSheet(t)._fpHiddenWidth;n(u[r]).addClass("e-fc-hide");n(e[r]).addClass("e-fc-hide");i.model.sheets[t]._currentLeftFrozenColumn=r+1;f=f+n(u[r]).width()},_changevHandlerPosition:function(n){var i=this.XLObj,t=i._getContent(i.getActiveSheetIndex()).find(".e-vscrollbar").data("ejScrollBar");t.value(n);n=t!=null&&n>=t._scrollData.scrollable?t._scrollData.scrollable:n;t!=null&&n>=0&&n<=t._scrollData.scrollable&&(n=n/t._scrollData.onePx,t.element.find(".e-vhandle").css("top",n-1))},_changehHandlerPosition:function(n){var i=this.XLObj,t=i._getContent(i.getActiveSheetIndex()).find(".e-hscrollbar").data("ejScrollBar");t.value(n);n=t!=null&&n>=t._scrollData.scrollable?t._scrollData.scrollable:n;t!=null&&n>=0&&n<=t._scrollData.scrollable&&(n=n/t._scrollData.onePx,t.element.find(".e-hhandle").css("left",n-1))},_updateRowHeightCollection:function(){var i=this.XLObj,u=i.getActiveSheetIndex(),f,e=i.getSheet(u),r,o;if(f=i.getRows(u)[1],!t.isNullOrUndefined(f))for(e._rowHeightCollection=[{idx:i.getFrozenRows(u),value:1}],r=i.getFrozenRows(u)+1,o=f.length;r<o;r++)e._rowHeightCollection.push({idx:r,value:e._rowHeightCollection[e._rowHeightCollection.length-1].value+n(f[r]).height()})},_updateColWidthCollection:function(){var n=this.XLObj,i=n.getActiveSheetIndex(),u=n.getSheet(i),o=n._getJSSheetHeader(i).find("col"),f=n.getRows(i)[1],r,e;if(!t.isNullOrUndefined(f))for(u._colWidthCollection=[{idx:n.getFrozenColumns(i),value:1}],r=n.getFrozenColumns(i)+1,e=f[0].cells.length;r<e;r++)u._colWidthCollection.push({idx:r,value:u._colWidthCollection[u._colWidthCollection.length-1].value+parseInt(o[r].style.width)})}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.math={toFraction:function(n){if(this.isNumber(n)){var r=n.toString(),e=r.split(".")[0],t=r.split(".")[1];if(!t)return{integer:n};var i=(+t).toString(),u=this.getPlaceValue(t,i),f=this.getGcd(i,u);return{integer:e,numerator:Number(i)/f,denominator:Number(u)/f}}return null},toExponential:function(n,t){var r,i;return this.isNumber(n)?(r=Number(n),t=this.isNumber(t)?t:2,i=r.toExponential(t).split("e+"),i[0]+"E+"+this.padZeros(i[1])):null},toAccounting:function(i,r,u){if(i=i||"",this.isNumber(r)&&i&&Globalize.culture(u)){var e,o,s=t.widgetBase.formatting(i,r,u),f=this._currencySymbol,h=n.trim(s.replace(f,""));s.indexOf(f)?(e=Number(r)?h:"-",o=f):(e=f,o=Number(r)?h:"-");r=e+"   "+o}return r},intToDate:function(n){return new Date((Number(n)-2)*864e5+new Date("01/01/1900").getTime())},getGcd:function(n,t){return(n=Number(n),t=Number(t),!t)?n:this.getGcd(t,n%t)},isNumber:function(n){return n-parseFloat(n)>=0},isTime:function(n){return n?n.toString().indexOf(":")!==-1:!1},isFormula:function(n){var t,i;return n&&!n.toString().indexOf("=")&&n.length>1?(t=n.split("(").length-1,i=n.split(")").length-1,t===i):!1},getPlaceValue:function(n,t){var i=n.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},padZeros:function(n,i,r){return this.isNumber(n)?(i=this.isNumber(i)?i:2,r=t.isNullOrUndefined(t.Spreadsheet.autoFillDirection[r])?t.Spreadsheet.autoFillDirection.Left:t.Spreadsheet.autoFillDirection[r],r===t.Spreadsheet.autoFillDirection.Left?n<=this.maxValue(i)?Array(i-this.getDigits(n)+1).join("0")+n.toString():n.toString():n<this.minValue(i)?n.toString()+Array(i-this.getDigits(n)+1).join("0"):n.toString()):null},maxValue:function(n){return this.isNumber(n)?Number(Array(n+1).join("9")):null},minValue:function(n){return this.isNumber(n)?Number("1"+Array(n).join("0")):null},getDigits:function(n){return this.isNumber(n)?n.toString().length:null},_round:function(n,t){return Number(Math.round(n+"e"+t)+"e-"+t)},_parseTime:function(n){var u,t,i=0,r=3,f={},e;if(this.isTime(n))for(n=n.toString(),t=n.split(" "),u=t.length;i<u;){if(this.isTime(t[i]))for(e=t[i].split(":");r<6;)f[this._datePattern[r]]=e[r-3]||"0",r++;i++}return f},_dateToInt:function(n){var t=new Date("01/01/1900"),i=this._isDateTime(n)?n:new Date(n),r=i.getTime()-t.getTime();return r/864e5+2},_defTimeFormat:function(n){return[n.getHours(),n.getMinutes(),n.getSeconds()].join(":")},_isDate:function(n){var i={};return t.isNullOrUndefined(Globalize.parseDate(n.toString()))||(n=this._dateToInt(n.toString())),/^((0?[1-9]|1[012])[-.](0?[1-9]|[12][0-9]|3[01])[-.](19|20)?[0-9]{2})*$/.test(n.toString())?(n=n.toString().replace("-","/","g"),n=this._dateToInt(n.toString()),i.text=n,i.isDate=!0):(i.text=n,i.isDate=!1),i},_defDateFormat:function(n){return[n.getMonth()+1,n.getDate(),n.getFullYear()].join("/")},_isCellReference:function(n){return/^[a-z]+[0-9]+$/gi.test(n)},_isDateTime:function(n){return Object.prototype.toString.call(n)==="[object Date]"&&n.valueOf()!==NaN}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.resizing=function(t){this.XLObj=t;this._$visualElem=n();this._currentHCell=-1;this._colMinWidth=15;this._rowMinHeight=20;this._allowStart=!1;this._resizeStart=!1;this._resizeType="";this._tableY=null;this._oldWidth=null;this._orgX=null;this._orgY=null;this._extra=null;this._initialTableWidth=null;this._resizeElt=null;this._tableX=null;this._oldHeight=null;this._initialTableHeight=null};t.spreadsheetFeatures.resizing.prototype={getColWidth:function(n){return this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).columnsWidthCollection[n]},getRowHeight:function(n){return this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).rowsHeightCollection[n]},setColWidth:function(n,t){this.XLObj.model.allowResizing&&(this._currentHCell=n,this._resizeColumnUsingDiff(t,this.XLObj._getJSSheetHeader(this.XLObj.getActiveSheetIndex()).find(".e-columnheader").find(".e-headercell")[this._currentHCell].offsetWidth))},setRowHeight:function(n,t){this.XLObj.model.allowResizing&&(this._currentHCell=n,this._resizeRowUsingDiff(t,this.XLObj._getJSSheetRowHeaderContent(this.XLObj.getActiveSheetIndex()).find("tbody").find(".e-rowheader")[this._currentHCell].offsetHeight))},_headerMouseDown:function(n){n.stopImmediatePropagation();this._colMouseDown(n)},_colMouseDown:function(t){if(this._allowStart&&n(t.target).css("cursor")==="col-resize"){var i=t.clientX,r=t.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(i=t.pageX,r=t.pageY);i+=document.documentElement.scrollLeft;t.button!=2&&this._start(i,r);this._resizeType="Col";t.preventDefault()}},_mouseHover:function(t){var s,f=this.XLObj,c=f.getActiveSheetIndex(),e=f._getJSSheetHeader(c),i;if(!this._$visualElem.is(":visible")&&(i=n(t.target),i.is(".e-headercelldiv")&&(i=n(i.get(0).parentNode)),i.hasClass("e-headercell"))){var o=i.get(0),r=o.getBoundingClientRect(),h=f._setXY(t),u=h[0],l=h[1];s=n(e.find(".e-table").get(0)).width()+n(e.find(".e-columnheader").get(0)).offset().left;(u>=r.left+document.documentElement.scrollLeft+o.offsetWidth-5||u<=r.left+3)&&u<s&&u>=r.left&&l<=r.top+document.documentElement.scrollTop+t.target.offsetHeight?(i.addClass("e-ss-colresize"),this._currentHCell=e.find(".e-headercell").index(o),this._allowStart=!0):(n(".e-ss-colresize").removeClass("e-ss-colresize"),this._allowStart=!1,this._currentHCell=-1)}},_start:function(i,r){var u=this.XLObj,e,o=u.getActiveSheetIndex(),s=u._getJSSheetHeader(o),l=s.find(".e-columnheader"),h=l.find(".e-headercell"),f,c;(this._currentHCell>-1&&this._currentHCell<h.length&&(f=h[this._currentHCell]),t.isNullOrUndefined(f))||(c=f.getBoundingClientRect(),this._tableY=c.top+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart?(this._$visualElem=n(document.createElement("div")),e=u._getJSSheetContent(o).height()+s.height(),this._$visualElem.addClass("e-reSizeColbg").appendTo(u.element).css({height:e+"px"}).addClass("e-ss-colresize"),this._$visualElem.css({left:i-1,top:this._tableY}),this._oldWidth=f.offsetWidth,this._orgX=i,this._orgY=r,this._extra=i-this._orgX,this._resizeStart=!0):this._currentHCell=-1)},_cMouseMove:function(t){if(this._resizeStart){var r=this.XLObj._setXY(t),i=r[0],u=r[1];navigator.userAgent.indexOf("WebKit")>-1&&(i=t.pageX,u=t.pageY);i+=document.documentElement.scrollLeft;t.preventDefault();this._moveVisual(i);n(t.target).addClass("e-ss-colresize")}else this._mouseHover(t)},_reSize:function(t){var u,i=this.XLObj,r=i.getActiveSheetIndex();this._initialTableWidth=i._getJSSheetHeader(r).find(".e-headercontent").width();this._getResizableCell();this._currentHCell>-1&&this._resizeStart&&(u=i._getJSSheetHeader(r).find(".e-columnheader").find(".e-headercell")[this._currentHCell].offsetWidth,this._resizeColumnUsingDiff(t-this._orgX+u,u),i.model.scrollSettings.allowScrolling&&i.XLScroll._refreshScroller(r,"refresh","all"),i.XLDragFill.positionAutoFillElement(),i.XLDragFill.hideAutoFillOptions(),n("#"+i._id+"ddl").length&&i._ddlPosition());this._currentHCell>0&&i._setRowHdrHeightResize(r,this._currentHCell);i.XLSelection._refreshBorder();this._removeVisualElem()},_resizeColumnUsingDiff:function(t,i){var r=this.XLObj,o={},f=r.getActiveSheetIndex(),s=r._getJSSheetHeader(f),h,c,e,u,l,a;if(t>0){for(t=t>this._colMinWidth?t:this._colMinWidth,h=s.find("col").eq(this._currentHCell),c=r._getJSSheetContent(f).find(".e-spreadsheetcontentcontainer").find("col").eq(this._currentHCell),h.outerWidth(t),c.width(t),e=r._getContent(f).find(".e-filterspan"),u=0,l=e.length;u<l;u++)a=n(e[u]).parent(),r.XLFilter._applyFilterIcon(a,n(e[u]));this._findColumnsWidth();s.find(".e-columnheader").css("cursor","default");o={sheetIndex:f,colIndex:this._currentHCell,newWidth:t,oldWidth:i,reqType:"resize-column"};i!=t&&r._completeAction(o)}},_findColumnsWidth:function(){for(var i=this.XLObj,u=i.getActiveSheetIndex(),r=i.getSheet(u),f=i._getJSSheetHeader(u).find("col"),n=0,e=r.columns.length;n<e;n++)t.isNullOrUndefined(r.columns[n])||(r.columnsWidthCollection[n]=f.eq(n).width())},_calculateWidth:function(){for(var t=this.XLObj,i=t._getJSSheetHeader(t.getActiveSheetIndex()).find("col"),r=0,n=0;n<i.length;n++)r+=i.eq(n).width();return r},_cMouseUp:function(n){if(this._resizeStart){var t=n.clientX,i=n.clientY,r=this.XLObj;navigator.userAgent.indexOf("WebKit")>-1&&(t=n.pageX,i=n.pageY);t+=document.documentElement.scrollLeft;this._reSize(t,i);r.element.find("#"+r._id+"ddl").ejDropDownList("hidePopup")}},_getResizableCell:function(){for(var t=this.XLObj,f=t._getJSSheetHeader(t.getActiveSheetIndex()).find(".e-columnheader"),i=f.find(".e-headercell").not(".e-hide"),e=navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollLeft:document.documentElement.scrollLeft,r,u,n=0,o=i.length;n<o;n++)if(u=i[n].getBoundingClientRect(),r=u.left+e+5,r>this._orgX){this._currentHCell=n-1;return}},_moveVisual:function(n){var i=this.XLObj,t=i._getJSSheetHeader(i.getActiveSheetIndex()).find(".e-headercontent")[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<n||n<t.left+document.documentElement.scrollLeft?this._$visualElem.remove():this._currentHCell>-1&&this._$visualElem.css({left:n-1,top:this._tableY})},_rowMouseDown:function(t){if(this._allowStart&&n(t.target).css("cursor")==="row-resize"){var r=t.clientX,i=t.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(r=t.pageX,i=t.pageY);i+=document.documentElement.scrollTop;t.button!=2&&this._rowStart(r,i);this._resizeType="Row";t.preventDefault()}return!1},_rowMouseHover:function(t){var i;if(!this._$visualElem.is(":visible")&&(i=n(t.target),i.hasClass("e-rowheader"))){var r=this.XLObj,o=r.getActiveSheetIndex(),s=r._getJSSheetRowHeaderContent(o),e=i.get(0),u=e.getBoundingClientRect(),h=r._setXY(t),c=h[0],f=h[1],l=r._getJSSheetRowHeader(o).find(".e-table").height()+s.find("tbody").offset().top;(f>=u.top+document.documentElement.scrollTop+e.offsetHeight-5||f<=u.top+3)&&f<l&&f>=u.top&&c<=u.left+document.documentElement.scrollLeft+t.target.offsetWidth?(i.addClass("e-ss-rowresize"),this._resizeElt=i.parent(),this._currentHCell=s.find(".e-rowheader").index(e),this._allowStart=!0):(n(".e-ss-rowresize").removeClass("e-ss-rowresize"),this._allowStart=!1,this._currentHCell=-1)}},_rowStart:function(t,i){var r=this.XLObj,f=r.getActiveSheetIndex(),e=r._getJSSheetRowHeader(f).find(".e-rowheader"),u,o,s;(this._currentHCell>-1&&this._currentHCell<e.length&&(u=e[this._currentHCell]),u)&&(o=u.getBoundingClientRect(),this._tableX=o.left+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollLeft:document.documentElement.scrollLeft),this._allowStart?(this._$visualElem=n(document.createElement("div")),s=r._getJSSheetContent(f).width(),this._$visualElem.addClass("e-reSizeRowbg").appendTo(r.element).css({width:s+"px"}).addClass("e-ss-rowresize"),this._$visualElem.css({top:i-1,left:this._tableX}),this._oldHeight=u.offsetHeight,this._orgX=t,this._orgY=i,this._extra=i-this._orgY,this._resizeStart=!0):this._currentHCell=-1)},_rMouseMove:function(t){if(this._resizeStart){var r=this.XLObj._setXY(t),u=r[0],i=r[1];navigator.userAgent.indexOf("WebKit")>-1&&(u=t.pageX,i=t.pageY);i+=document.documentElement.scrollTop;t.preventDefault();n(t.target).addClass("e-ss-rowresize");this._moveRowVisual(i)}else this._rowMouseHover(t)},_rowResize:function(t,i){var u,r=this.XLObj,f=r.getActiveSheetIndex(),o=r.getRows(f)[1],e=!1;this._initialTableHeight=r._getJSSheetRowHeader(f).find(".e-rowheadercontent").height();this._getResizableRowCell();e=n(o[this._currentHCell]).find(".e-sswraptext").length>0;this._currentHCell>-1&&this._resizeStart&&(u=r._getJSSheetRowHeaderContent(f).find("tbody").find(".e-rowheader")[this._currentHCell].offsetHeight,(!e||e&&i-this._orgY+u>u)&&this._resizeRowUsingDiff(i-this._orgY+u,u),r.model.scrollSettings.allowScrolling&&r.XLScroll._refreshScroller(f,"refresh","all"),r.XLDragFill.positionAutoFillElement(),r.XLDragFill.hideAutoFillOptions());r.XLSelection._refreshBorder();this._removeVisualElem()},_resizeRowUsingDiff:function(t,i){var r=this.XLObj,f=r.getActiveSheetIndex(),s={},o=r._getJSSheetRowHeaderContent(f),h,c,l,e,u,a;if(t>0){for(t=t>this._rowMinHeight?t:this._rowMinHeight,c=o.find("tbody").children().eq(this._currentHCell),l=r._getJSSheetContent(f).find(".e-content").find("tr").eq(this._currentHCell),c.outerHeight(t),l.height(t),o.find("tbody").css("cursor","default"),o.find("tbody").children().css("cursor","default"),this._findRowsHeight(),e=r._getContent(f).find(".e-filterspan"),u=0,a=e.length;u<a;u++)h=n(e[u]).parent(),r.XLFilter._applyFilterIcon(h,n(e[u]));s={sheetIndex:f,rowIndex:this._currentHCell,newHeight:t,oldHeight:i,reqType:"resize-row"};i!=t&&r._completeAction(s)}},_findRowsHeight:function(){for(var n=this.XLObj,i=n.getActiveSheetIndex(),r=n.getSheet(i),u=n._getJSSheetContent(i).find("tbody").children(),t=0,f=r.rowCount;t<f;t++)n._sheets[i]._Rows[0]&&(r.rowsHeightCollection[t]=u.eq(t).height())},_calculateHeight:function(){for(var t=this.XLObj,i=t._getJSSheetRowHeaderContent(t.getActiveSheetIndex()).find("tbody").children(),r=0,n=0,u=i.length;n<u;n++)r+=i.eq(n).height();return r},_rMouseUp:function(t){if(this._resizeStart){var r=t.clientX,i=t.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(r=t.pageX,i=t.pageY);i+=document.documentElement.scrollTop;this._rowResize(r,i);n("#"+this.XLObj._id+"ddl").length&&this.XLObj._ddlPosition()}},_getResizableRowCell:function(){for(var u=this.XLObj,i=u._getJSSheetContent(u.getActiveSheetIndex()).find(".e-rowheader"),o=navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop,f,r,e=1,t=0,s=i.length;t<s;t++)if(r=i[t].getBoundingClientRect(),r.top==0&&e++,f=r.top+o+5,f>this._orgY){this._currentHCell=n(i[t-1]).is(":visible")?t-1:t-e;return}},_moveRowVisual:function(n){var i=this.XLObj,t=i._getJSSheetContent(i.getActiveSheetIndex()).find(".e-rowheadercontent")[0].getBoundingClientRect();t.top+document.documentElement.scrollTop+t.height<n||n<t.top+document.documentElement.scrollTop?this._$visualElem.remove():this._currentHCell>-1&&this._$visualElem.css({top:n-1,left:this._tableX})},_apMouseDown:function(t){if(this._allowStart&&n(t.target).closest("div").css("cursor")==="col-resize"){var i=t.clientX,r=t.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(i=t.pageX,r=t.pageY);i+=document.documentElement.scrollLeft;t.button!=2&&this._apStart(i,r);this._resizeType="AP";t.preventDefault()}return!1},_apMouseHover:function(t){var i=this.XLObj;if(!this._$visualElem.is(":visible")){var r=n(t.target),o=r.get(0),u=o.getBoundingClientRect(),f=i._setXY(t),e=f[0],s=f[1];e<=u.left+4&&e>=u.left?(r.parent().addClass("e-ss-apresize"),this._allowStart=!0):(i.element.find(".e-ss-apresize").removeClass("e-ss-apresize"),this._allowStart=!1)}},_apStart:function(t){var i=this.XLObj,f=i.getActivationPanel()[0],e=f.getBoundingClientRect(),r=i.getActiveSheetIndex(),u;this._tableY=e.top+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop);this._allowStart&&(this._$visualElem=n(document.createElement("div")),u=i._getJSSheetContent(r).height()+i.getJSSheetHeader(r).height(),this._$visualElem.addClass("e-reSizeAPbg").appendTo(i.element).css({height:u+"px"}).addClass("e-ss-apresize"),this._$visualElem.css({left:t,top:this._tableY}),this._resizeStart=!0)},_apMouseMove:function(n){if(this._resizeStart){var i=this.XLObj._setXY(n),t=i[0];t+=document.documentElement.scrollLeft;n.preventDefault();this._apMoveVisual(t)}else this._apMouseHover(n)},_apMouseUp:function(n){if(this._resizeStart){var t=n.clientX,i=n.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(t=n.pageX,i=n.pageY);t+=document.documentElement.scrollLeft;this._apReSize(t,i)}},_apMoveVisual:function(n){this._$visualElem.css({left:n,top:this._tableY})},_apReSize:function(t){var i=this.XLObj;i.model.apWidth=Math.abs(i.model.scrollSettings.width-t);n(i.getActivationPanel()).width(i.model.apWidth);i.setSheetWidthHeight(i.getActiveSheetIndex(),{width:t,height:i.model.scrollSettings.height});this._removeVisualElem()},_removeVisualElem:function(){var n=this.XLObj;this._$visualElem.remove();n.element.find(".e-reSizeRowbg").remove();this._resizeStart=!1;this._currentHCell=-1;this._resizeType="";this._allowStart=!1;n.XLComment._updateCmntArrowPos()},fitWidth:function(n){for(var t=this.XLObj,i=0,r=n.length;i<r;i++)this._fitWidth(n[i],t._sheets[t.model.activeSheetIndex]._Rows[1]);t.XLSelection._refreshBorder()},_resizeToFitWidth:function(t){var i=this.XLObj,r;n(t.target).css("cursor")==="col-resize"&&(n(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),r=n(t.target),r.hasClass("e-headercell")&&this._fitWidth(t.target.cellIndex,i._sheets[i.model.activeSheetIndex]._Rows[1]));i.XLSelection._refreshBorder()},_fitWidth:function(t,i){var r=this.XLObj,f=r.getActiveSheetIndex(),e=r._getJSSheetHeader(f).find(".e-headercell")[t],c=n(e).children(".e-headercelldiv"),u=0,s=0,o=0,h;i=i?i:r.sheets[f]._Rows[1];o=this._getContentWidth(t,f,i);s=this._getHeaderContentWidth(c,f);o>1&&(u=s>o?s:o,u=u+10,h={target:e,sheetIndex:r.getActiveSheetIndex(),colIndex:t,newWidth:u,oldWidth:e.offsetWidth,reqType:"resize-fit-width"},u>0&&(u<20&&(u=30),this._applyWidth(e,f,t,u),r.XLDragFill.positionAutoFillElement(),r.XLComment._updateCmntArrowPos(),r.model.sheets[f]._importRendered||r._isUndoRedo||r._completeAction(h)))},_applyWidth:function(n,t,i,r){var u=this.XLObj;u._getJSSheetHeader(t).find("col").eq(i).width(r);u._getJSSheetContent(t).find("col").eq(i+1).width(r);u.getSheet(t).columnsWidthCollection[i]=r;u.getSheet(t).columns[i].width=r},_getContentWidth:function(t,i,r){for(var u,y,c=0,l,e,a=this.XLObj,p,o,f,b=a._formatRegx,w="",h,s=0,v=r.length;s<v;s++){for(o=n(r[s]).find(".e-rowcell").eq(t),f=n(o).find("span"),l=0,u=0,y=f.length;u<y;u++)f[u].className.indexOf("e-icon")>-1&&(l+=n(f[u]).outerWidth(!0)+parseInt(n(f[u]).css("margin-left"))+parseInt(n(f[u]).css("margin-right")));p="<span style='display:none'>"+o.text()+"<\/span>";o[0].className.indexOf("e-format")>-1&&(w=o[0].className.match(b)[0]);a.element.append(p);h=a.element.find("span:last");h.addClass(w);e=h.width();h.remove();e=e+l;e>c&&(c=e)}return c},_getHeaderContentWidth:function(n){var i=0,r=t.buildTag("span",{},{}),u=n.html();return r.html(u),n.html(r),i=n.find("span:first").width(),i=i+10,n.html(u),i},fitHeight:function(n){for(var i=this.XLObj,r=i.getRows(i.getActiveSheetIndex())[0],t=0,u=n.length;t<u;t++)r[t].className.indexOf("e-sswraprow")<0&&this._fitHeight(n[t]);i.XLSelection._refreshBorder()},_resizeToFitHeight:function(t){var i=this.XLObj;n(t.target).hasClass("e-rowheader")&&t.target.parentNode.className.indexOf("e-sswraprow")<0&&this._fitHeight(parseInt(t.target.textContent));i.XLSelection._refreshBorder()},_fitHeight:function(i){var r=this.XLObj,u=r.getActiveSheetIndex(),c,s=r._getJSSheetRowHeader(u).find(".e-rowheader")[i-1],f=0,e,h=0,o,l=t.buildTag("span",{},{}),a=r.getRows(u)[1][i-1].cells;h=this._getContentHeight(i,a,u);e=n(s);l.html(e.text());e.html(l);o=e.find("span:first").height();o=o+parseInt(n(e).css("padding-top"))+parseInt(n(e).css("padding-bottom"))+1;f=h<o?o:h;f<r.model.rowHeight&&(f=r.model.rowHeight);c={target:s,sheetIndex:r.getActiveSheetIndex(),rowIndex:i,newHeight:f,oldHeight:s.offsetHeight,reqType:"resize-fit-height"};n(s.parentElement).height(f);n(r._getContent(u).find("tr")[i-1]).height(f);r.getSheet(u).columns[i].height=f;r.XLDragFill.positionAutoFillElement();r.XLComment._updateCmntArrowPos();r.XLScroll._refreshScroller(u,"refresh","all");r.model.sheets[u]._importRendered||r._completeAction(c)},_getContentHeight:function(i,r){for(var l=this.XLObj,e=0,o=t.buildTag("span",{},{}),s,h="",a=l._formatRegx,u,c,f=0,v=r.length;f<v;f++)u=n(r[f]),c=u.text(),r[f].className.indexOf("e-format")>-1&&(h=r[f].className.match(a)[0]),o.addClass(h),o.append(c),u.append(o),s=u.find("span").height(),s>e&&(e=s),u.find("span:last").remove();return e+5}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.editing=function(n){this.XLObj=n;this._EditCellDetails={value:null,rowIndex:-1,columnIndex:-1,fieldName:null,cell:null};this._tdsOffsetWidth=[];this._isEdit=!1;this._isFormulaEdit=!1;this._skipHTML=!1;this._EditTemplate=null;this._filterIcon=null;this._isCellEdit=!0;this._validOperators=["+","-","*","/",","];this._invalidOperators=["%"];this._validCharacters=["+","-","*","/",",","(","="]};t.spreadsheetFeatures.editing.prototype={getCurrentEditCellData:function(){var i=this.XLObj,r,t;return this._isEdit&&n("#"+i._id+"EditForm").length?(r=n("#"+i._id+"_"+this._EditCellDetails.fieldName),t=r.val(),typeof t=="string"&&t.length&&i.getSheet(i.getActiveSheetIndex()).columns[this._EditCellDetails.columnIndex].type==="number"&&(t=parseFloat(t)),t):null},getColumnIndexByField:function(n){for(var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),t=0,u=r.columns.length;t<u;t++)if(r.columns[t].field===n)break;return t},_processEditing:function(){this._addEditTemplate()},_addEditTemplate:function(){var n=this.XLObj,u=n.getActiveSheetIndex(),r,i,e,f;if(n.getSheet(u).columns.length!==0){for(r=t.buildTag("div","",{display:"none"},{id:n._id+"_EditTemplate"}),i=0,e=n.getSheet(u).columns.length;i<e;i++)f=t.buildTag("div","",{},{id:n.getSheet(u).columns[i].field+"_Edit"}),this._initCellEditType(i,f),r.append(f);r.children().length&&(this._EditTemplate=r)}},_initCellEditType:function(n,i){var r=this.XLObj,u=r.getSheet(r.getActiveSheetIndex()).columns[n].field;i.html(t.buildTag("input.e-field e-ss-input","",{},{value:"{{:"+u+"}}",id:r._id+"_"+u,name:u}))},editCell:function(t,i,r){var u=this.XLObj;if(u.model.allowEditing){var o=u.getActiveSheetIndex(),e=u.getSheet(o),c=u.getActiveCell(o),l,v=u.getRows(o)[1],y=n(v[t]),p=e.columns[i].field,s=y.find(".e-rowcell").eq(i),a=u.getSheet(o).columns[i],f={columnName:a.field,value:this.getPropertyValueByElem(s),columnObject:a,cell:s},h={rowIndex:t,colIndex:i};(typeof f.value=="object"&&(f.value=this.getPropertyValueByElem(s,"value2")),u._trigger("cellEdit",f))||((c.rowIndex!==t||c.colIndex!==i)&&(e._activeCell=h,e._startCell.rowIndex<=t&&e._startCell.colIndex<=i&&e._endCell.rowIndex>=t&&e._endCell.colIndex>=i?u.XLSelection.selectRange(e._startCell,e._endCell):u.XLSelection.selectRange(h,h),u.XLDragFill.positionAutoFillElement()),this._EditCellDetails={rowIndex:t,value:f.value,columnIndex:i,fieldName:p,cell:s},l=f.value,r||(f.value=""),this._renderBulkEditObject(f,s,l),this.getPropertyValueByElem(u.getCell(e._activeCell.rowIndex,e._activeCell.colIndex),"rule")&&u.XLValidate._setValidation(),this.getPropertyValue(f.cell.parent().index(),f.cell[0].cellIndex,"hyperlink",o)&&n("#"+u._id+"_"+this._EditCellDetails.fieldName).addClass("e-hyperlinks"),f.cell.addClass("e-editedcell"),u.isFormula(f.value)&&this._processFormulaEditRange(f.value))}},_renderBulkEditObject:function(i,r,u){var s=this.XLObj,o=t.buildTag("form","",{},{id:s._id+"EditForm"}),y=this._EditTemplate,h={},c=r.height(),f=r.find(".e-filterspan"),l,e,a,v;h[i.columnObject.field]=i.value;f.length>0&&(l={filterIcon:f,rowIndex:f.parentsUntil("table").eq(1).index(),colIndex:f.parent().index()},this._filterIcon=l);e=r.height();r.empty();r.hasClass("e-sswraptext")&&c!==e&&r.height(c);a=y.find("#"+i.columnObject.field+"_Edit").html();v=n(n.templates(a).render(h));o.append(v.height(e-1));r.append(o);this._setoffsetWidth(o);this._refreshEditForm(r,i.value,u,e);this._isEdit=!0;s.XLRibbon._disableRibbonIcons()},_setoffsetWidth:function(n){for(var i=n.closest("td"),t=0,r=i.length;t<r;t++)this._tdsOffsetWidth[t]=i.get(t).offsetWidth},_refreshEditForm:function(t,i,r,u){var e=this.XLObj,k=document.getElementById(e._id+"EditForm"),l=n(k).find("input,select"),f,a,o=e._dataContainer.sheets[e.getActiveSheetIndex()],s={},v=t.parent().index(),p,y,h,w,c,b;for(o&&o[v]&&o[v][t[0].cellIndex]&&(s=o[v][t[0].cellIndex]),h=0,w=l.length;h<w;h++){if(f=l.eq(h),e.isNumber(r)&&f.addClass("e-ralign"),f.addClass(e.XLFormat.getFormatClass(f.closest("td")[0].className)),f.css({border:"none",outline:"none"}),a=e.XLFormat.getFormatClass(f.closest("td")[0].className),f.addClass(a),a||f.css({color:"#000000"}),s&&"cFormatRule"in s)for(y=n.extend(!0,[],s.cFormatRule),c=0,b=y.length;c<b;c++)p=e._dataContainer.cFormatData[y[c]].split("_"),n.parseJSON(p[7])&&f.css({"background-color":t.css("background-color"),color:t.css("color")});f.on("input",function(t){var i=n("#"+this.id.split("_")[0]).data("ejSpreadsheet");i.XLEdit._isFormulaEdit=!t.target.value.indexOf("=");i.XLEdit._isFormulaEdit&&i.XLEdit._processFormulaEditRange(t.target.value);i._getInputBox().val(t.target.value);i.XLEdit._isCellEdit=!0});f.on("focus",function(){var t=n("#"+this.id.split("_")[0]).data("ejSpreadsheet");t.XLEdit._isCellEdit=!0});this._renderAutoComplete(f,i,u);e._setFormulaSuggElem(n("#"+l[0].id+"_suggestion"))}this._focusElements(f.closest("td"))},_renderAutoComplete:function(t,i,r){var u=this.XLObj;t.ejAutocomplete({dataSource:u._formulaCollection,value:i,cssClass:"e-ss-autocomplete",width:"100%",height:r,delaySuggestionTimeout:10,minCharacter:2,popupWidth:"170px",popupHeight:"150px",showEmptyResultText:!1,autoFocus:!0,template:"<span class='e-icon e-ss-function'> <\/span><div> ${display} <\/div>",select:n.proxy(this._formulaSelect,u),open:n.proxy(this._formulaSuggestionStatus,u),close:n.proxy(this._formulaSuggestionStatus,u)});t.data("ejAutocomplete")._bubbleEvent(!0)},saveCell:function(){var o,i=this.XLObj,r,b,c;if(this._isEdit){var f=i.getActiveSheetIndex(),s,k=i.getSheet(f),l=n("#"+i._id+"EditForm"),d=l.closest("td"),h,a=k.columns[this._EditCellDetails.columnIndex],u,v=n("#"+i._id+"_"+this._EditCellDetails.fieldName),e,y,p,w;if(i.model.allowDataValidation&&!l.validate().element(v[0]))return!1;if(r={columnName:a.field,value:this.getCurrentEditCellData(),pValue:this._EditCellDetails.value,columnObject:a,cell:d},i._trigger("cellSave",r))return;if(this.updateCellValue(r.cell,r.value),s=this.getPropertyValue(r.cell.parent().index(),r.cell[0].cellIndex,"hyperlink",f),s&&(s.webAdr?r.cell.html(t.buildTag("a",r.cell.text(),"",{href:s.webAdr,target:"_blank","class":"e-hyperlinks"})):r.cell.html(t.buildTag("a",r.cell.text(),"",{href:"#","class":"e-hyperlinks"}))),n("#"+v[0].id+"_suggestion").remove(),b=t.isNullOrUndefined(this._EditCellDetails.value)?"":this._EditCellDetails.value,p=r.cell.parent().index(),w=r.cell.index(),c={sheetIndex:f,rowIndex:p,colIndex:w,cValue:r.value,reqType:"edit",iconName:"",pValue:b},r.value.toString().indexOf("=")===0&&(c.operation="formula"),i._setRowHdrHeight(f,r.cell.parent().index()),this._isFormulaEdit&&i._getContent(f).find("td").removeClass(i._formulaBorder.join(" ").replace(/,/g," ")+" "+i._ctrlFormulaBorder.join(" ").replace(/,/g," ")),this._isEdit=this._isFormulaEdit=!1,r.cell.removeClass("e-editedcell"),i.XLCellNav._isNavigate=!0,i.model.showRibbon&&(i.XLRibbon._enableRibbonIcons(),i.XLRibbon._updateRibbonIcons()),(t.isNullOrUndefined(r.pValue)||r.value!==r.pValue.toString())&&i._completeAction(c),i._updateUndoRedoIcons(),e=this.getPropertyValueByElem(r.cell,"cFormatRule"),i.model.allowConditionalFormats&&e&&e.length)for(h=0,y=e.length;h<y;h++)u=e[h].split("_"),i.XLCFormat._cFormat(u[0],u[2],u[3],u[4],u[5]);return o=i.getActiveCellElem(),i._hasComment=!0,o.hasClass("e-commentcell")&&o.removeClass("e-commentcell")&&i.XLComment.setComment(),o.hasClass("e-hlcell")&&i.XLValidate.highlightInvalidData(),i._hasComment=this._shiftKeyEnabled=!1,i._ctrlKeyCount=0,i.XLSelection._clearBorder(i._formulaBorder.join(" ").replace(/,/g," ")+" "+i._ctrlFormulaBorder.join(" ").replace(/,/g," ")),i.setSheetFocus(),!0}},updateCellValue:function(n,i,r,u){if(n){var f=this.XLObj,e=n[0].cellIndex,o=n[0].parentNode.rowIndex,s=f._rAlign;u=f.getActiveSheetIndex();f.isFormula(i)?(this._refreshCalcEngine(o,e,!0,i),this._updateDataContainer(n[0],{value:i,type:t.Spreadsheet.CellType.Formula}),f._applyFormula(u,o,e),this._updateUsedRange(o,e),f._isFormulaSuggestion=!1):(this.updateCell(n,i),this._refreshCalcEngine(o,e));f.XLFormat._hasFormat(r)&&f.XLFormat._updateFormatClass(n[0],r);t.isNullOrUndefined(this._filterIcon)||this._filterIcon.rowIndex===o&&this._filterIcon.colIndex===e&&(n[0].className.indexOf(s)>-1&&n.removeClass(s),n.append(this._filterIcon.filterIcon),this._filterIcon=null);f.XLChart._refreshChartElements(o,e,u)}},updateCell:function(n,i,r){if(n){var c=this.XLObj,e=n[0],o=e.parentNode.rowIndex,s=e.cellIndex,h=t.Spreadsheet.CellType,f=this._parseValue(i),u=c.getRangeData([o,s,o,s],!1,["formatStr","type","thousandSeparator","decimalPlaces"],r)[0];u.type&&u.type!=h.General&&(f.type=u.type,delete f.formatStr);(u.formatStr||u.type===h.Scientific||u.type===h.Fraction)&&(f.value2=c.XLFormat._format(f.value,{formatStr:u.formatStr,type:u.type,thousandSeparator:u.thousandSeparator,decimalPlaces:u.decimalPlaces}));this._updateDataContainer(e,f,r);this._updateUsedRange(o,s)}},_parseValue:function(i){i=this.XLObj.isNumber(i)?Number(i):i||"";var s,u,h,f=this.XLObj,e=f.model.locale,o=t.Spreadsheet.CellType,r=i+"",a=o.General,v=Globalize.culture(e).numberFormat["."],y=Globalize.culture(e).numberFormat[","],c=Globalize.culture(e).calendar.patterns,l=r.indexOf(f._currencySymbol);if((l===0||l>-1&&l===r.length-1)&&(u=Globalize.parseFloat(r,10,e),u))return{value:u,value2:r,type:o.Currency};if(n.trim(r).indexOf(f._percentSymbol)>-1&&(u=n.trim(r).replace(f._percentSymbol,""),f.isNumber(u)))return{value:Number(u),value2:r,type:o.Percentage};if((r.indexOf(v)>-1&&r.indexOf(y)===-1||r.indexOf(v)>-1&&r.indexOf(y)>-1)&&(u=Globalize.parseFloat(r,10,e),u))return{value:u,value2:r,type:a};for(s in c)if(u=Globalize.parseDate(r,c[s],e),u)return h="{0:"+c[s]+"}",r=f.XLFormat._format(u,{type:o.DateTime,formatStr:h}),{value:u,value2:r,type:o.DateTime,formatStr:h};return(r.toLowerCase()==="true"||r.toLowerCase()==="false")&&(i=r=r.toUpperCase()),{value:i,value2:r,type:a}},updateCellWithContainer:function(i,r,u){var o=this.XLObj;u=u?u:o.getActiveSheetIndex();r=r?r:o.getSheet(u).selectedRange;for(var h,c,f,e,l=o.getRange(r[0],r[1],r[2],r[3],u),s=0,a=l.length;s<a;)e=l[s],c=e.parentNode.rowIndex,h=e.cellIndex,f=i[s],this._updateDataContainer(e,f),e.innerHTML=t.isNullOrUndefined(f.value2)?"":f.value2.toString(),this._refreshCellAlignment(e,f.value),this._refreshCalcEngine(c,h,o.isFormula(f.value),f.value),f.format&&o.addClass(e,f.format),f.hyperlink&&("cellAdr"in f.hyperlink?n(e).html(t.buildTag("a.e-hyperlinks",f.value2,"",{href:"#"})):n(e).html(t.buildTag("a.e-hyperlinks",f.value2,"",{href:f.hyperlink.webAdr,target:"_blank"}))),f.comment&&o.XLComment.setComment(e,null,!1),f.border&&o.XLFormat.applyBorder(o._getBorderInput(f.border),o._getAlphaRange(u,e.parentNode.rowIndex,e.cellIndex,e.parentNode.rowIndex,e.cellIndex)),s++;o.model.allowConditionalFormats&&o.XLCFormat.refreshCFormat(r)},_refreshCellAlignment:function(i,r,u){var f=this.XLObj,o=f._rAlign,s=f._cAlign,e=n(i);r=t.isNullOrUndefined(r)?this.getPropertyValueByElem(e,"value"):r;u=u?u:this.getPropertyValueByElem(e,"type");this.getPropertyValueByElem(e,"isCenterAlign")||i.className.indexOf(s)>-1&&e.removeClass(s);i.className.indexOf(o)>-1&&e.removeClass(o);(f.isNumber(r)||typeof r=="object")&&u!==t.Spreadsheet.CellType.Text?f.addClass(i,o):f._isBool(r)&&f.addClass(i,s)},_editingHandler:function(t){var i=this.XLObj,f,e,u,ut,p,h,l,w,g,it,s,nt,rt;if((t.keyCode===61||t.keyCode===32||t.keyCode>=48&&t.keyCode<=59||t.keyCode>=65&&t.keyCode<=90||t.keyCode>=96&&t.keyCode<=111||t.keyCode===173||t.keyCode>=186&&t.keyCode<=192||t.keyCode>=219&&t.keyCode<=222||t.keyCode>=226)&&!t.ctrlKey)f=i.getActiveSheetIndex(),e=i.getSheet(f),u=i.getCell(e._activeCell.rowIndex,e._activeCell.colIndex),this._isEdit||u.hasClass("e-readonly")||(i.element.find(".e-cdata").length&&i.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),ut=n("#"+i._id+"EditForm"),this.editCell(n.inArray(u.closest("tr").get(0),i.getRows(f)[1]),u.index(),!1));else if(t.keyCode!==113||t.shiftKey||t.ctrlKey)if(t.keyCode===27&&this._isEdit)f=i.getActiveSheetIndex(),e=i.getSheet(f),l=e._activeCell.rowIndex,w=e._activeCell.colIndex,u=i.getCell(l,w),p=i._dataContainer.sheets[f],h=l in p&&w in p[l]?p[l][w]:h,u.removeClass("e-editedcell"),u.get(0).textContent=i.isUndefined(h)?"":typeof h.value2=="string"?h.value2:i._dataContainer.sharedData[h.value],i.setSheetFocus(),i._setRowHdrHeight(f,e._selectedCells[0].rowIndex),this._isEdit=this._isFormulaEdit=!1,i._getContent(f).find("td").removeClass(i._formulaBorder.join(" ").replace(/,/g," ")+" "+i._ctrlFormulaBorder.join(" ").replace(/,/g," ")),i.XLDragFill.positionAutoFillElement(),i.model.showRibbon&&i.XLRibbon._enableRibbonIcons(),i.XLCellNav._isNavigate=!0;else if(t.keyCode===46)if(this._isEdit)i._ctrlKeyCount>0&&(i._ctrlKeyCount=0,i._formulaRange=[],i.XLSelection._clearBorder(i._formulaBorder.join(" ").replace(/,/g," ")+" "+i._ctrlFormulaBorder.join(" ").replace(/,/g," ")));else{f=i.getActiveSheetIndex();e=i.getSheet(f);u=i.getCell(e._activeCell.rowIndex,e._activeCell.colIndex);var tt,o,b,k,a,v,d,c,ft=new RegExp("\\be-format.*?\\b","g"),y,r=e._selectedCells,et=i.getRangeData([r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex]);if(!this._isEdit){for(i.element.find(".e-cdata").length&&i.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),g=i.model.sheets[f]._tableManager,u.hasClass("e-readonly")||i.clearRangeData(null,["value2","value"]),o=0,k=r.length;o<k;o++)if(u=i.getCell(r[o].rowIndex,r[o].colIndex),!u.hasClass("e-readonly")){if(i._getInputBox().val(""),i.XLComment._updateCmntFrmCntnr(r[o].rowIndex,r[o].colIndex),y=this.getPropertyValueByElem(u,"cFormatRule"),i.model.allowConditionalFormats&&y&&y.length)for(b=0,d=y.length;b<d;b++)c=y[b].split("_"),i.XLCFormat._cFormat(c[0],c[2],c[3],c[4],c[5]);i._setRowHdrHeight(f,r[o].rowIndex)}for(a=0,d=i.getObjectLength(g);a<d;a++)if(it=n.extend(!0,{},g[a]),s=it.range,i.XLClipboard._compareRange([r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex],s)){for(i.XLFormat.removeTable(n.trim(g[a].name.replace("Table",""))),nt=i.getRange(s[0],s[1],s[2],s[3],f),v=0,k=nt.length;v<k;v++)tt=nt[v].className,nt[v].className=tt.replace(ft,"");i.XLFormat.clearFormat(s)}}rt={sheetIndex:f,range:[r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex],bData:et,reqType:"clear-content"};i._completeAction(rt)}else t.ctrlKey||t.shiftKey||t.keyCode!==8?t.keyCode!==13&&t.keyCode!==9||!this._isEdit||i.XLCellNav._isNavigate||this._isFormulaEdit||(t.preventDefault(),i.XLCellNav._isNavigate=!0):(f=i.getActiveSheetIndex(),e=i.getSheet(f),u=i.getCell(e._activeCell.rowIndex,e._activeCell.colIndex),this._isEdit||u.hasClass("e-readonly")||(i.element.find(".e-cdata").length&&i.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),u=i.getCell(e._activeCell.rowIndex,e._activeCell.colIndex),u.empty(),this.editCell(n.inArray(u.closest("tr").get(0),i.getRows(f)[1]),u.index(),!1),i._setRowHdrHeight(f,e._activeCell.rowIndex),i._getInputBox().val("")));else f=i.getActiveSheetIndex(),e=i.getSheet(f),u=i.getCell(e._activeCell.rowIndex,e._activeCell.colIndex),this._isEdit||u.hasClass("e-readonly")||(i.element.find(".e-cdata").length&&i.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),this.editCell(n.inArray(u.closest("tr").get(0),i.getRows(f)[1]),u.index(),!0),i.XLCellNav._isNavigate=!1)},_focusElements:function(t){n(t).find("input,select").not(":hidden").focus().setInputPos(n(t).find("input,select").val().length)},_updateUsedRange:function(n,t){var r=this.XLObj,i=r.model.sheets[r.getActiveSheetIndex()]._usedRange;i.rowIndex<n&&(i.rowIndex=n);i.colIndex<t&&(i.colIndex=t)},_updateDataContainer:function(n,i,r){var a=this.XLObj,f,o,h,e,v,u,c,w;if(a.getObjectLength(i)){v=t.Spreadsheet.CellType;u=a._dataContainer;r=a._getSheetIndex(r);var y=n.cellIndex,l=n.parentNode.rowIndex,s=["value","value2","type","cFormatRule","range","thousandSeparator","rule","format","border","picture","chart"],p;l in u.sheets[r]||(u.sheets[r][l]={});(y in u.sheets[r][l])?o=u.sheets[r][l][y]:u.sheets[r][l][y]=o={};for(f in i){e=i[f];switch(f){case s[0]:case s[4]:case s[5]:u.sharedData.indexOf(e)===-1&&u.sharedData.push(e);h=u.sharedData.indexOf(e);o[f]=h;break;case s[1]:[v.General,v.Text].indexOf(i.type)===-1?o[f]=i.value2:(u.sharedData.indexOf(i.value2)===-1&&u.sharedData.push(i.value2),o[f]=u.sharedData.indexOf(i.value2));p=n.getElementsByTagName("a");p.length?p[0].innerHTML=i.value2:n.innerHTML=this._skipHTML?n.innerHTML.concat(i.value2):i.value2;this._refreshCellAlignment(n,i.value,i.type);break;case s[2]:o[f]=u.cellType.indexOf(i.type);break;case s[3]:for(c=0,w=e.length;c<w;)u.cFormatData.indexOf(e[c])===-1&&u.cFormatData.push(e[c]),h=u.cFormatData.indexOf(e[c]),o[f]?o[f].indexOf(h)<0&&o[f].push(h):o[f]=[h],c++;break;case s[6]:u.valData.indexOf(e.customVal)===-1&&u.valData.push(e.customVal);o[f]=JSON.parse(JSON.stringify(e));o[f].customVal=u.valData.indexOf(e.customVal);break;case s[7]:case s[8]:u.hashCode.indexOf(e)===-1&&u.hashCode.push(e);o[f]=u.hashCode.indexOf(e);break;case s[9]:case s[10]:o[f]?o[f].indexOf(e)<0&&o[f].push(e):o[f]=[e];break;default:o[f]=e}}}else n.innerHTML=""},getPropertyValue:function(i,r,u,f){var o,e,v=t.Spreadsheet.CellType,c=this.XLObj,s=c._dataContainer,l=s.sheets,h,a;if(f=f?f:c.getActiveSheetIndex(),f in l&&i in l[f]&&r in l[f][i]&&(e=l[f][i][r],!t.isNullOrUndefined(e))){u=u?u:"value";switch(u){case"value":case"range":case"thousandSeparator":o=s.sharedData[e[u]];break;case"format":case"border":o=s.hashCode[e[u]];break;case"value2":o=[v.General,v.Text].indexOf(s.cellType[e.type])===-1?e.value2:s.sharedData[e.value2];break;case"type":o=s.cellType[e.type];break;case"cFormatRule":for(h=0,a=0,o=[],c.isUndefined(e[u])||(a=e[u].length);h<a;)e[u][h]in s.cFormatData&&o.push(s.cFormatData[e[u][h]]),h++;break;case"rule":c.isUndefined(e[u])||(o=[],n.extend(!0,o,e[u]),o.customVal=s.valData[o.customVal]);break;default:o=e[u]}}return o},getPropertyValueByElem:function(n,i,r){if(!t.isNullOrUndefined(n[0]))return this.getPropertyValue(n[0].parentNode.rowIndex,n[0].cellIndex,i,r)},_isSheetsDirty:function(){for(var n=this.XLObj,i=n._dataContainer.sheets,t=1,r=n.getObjectLength(i)+1;t<r;){if(n.getObjectLength(i[t]))return!0;t++}return!1},_refreshCalcEngine:function(n,t,i,r){var h,o,f,u=this.XLObj,e=u.getActiveSheetIndex(),s=u.getSheet(e);i?(h=new ValueChangedArgs(n+1,t+1,r),u._sheets[e]._calcEngine.valueChanged(s._sheetName.value,h)):(o=CalcEngine.getSheetFamilyItem(s._sheetName.value),f=RangeInfo.getAlphaLabel(t+1)+(n+1),u._sheets[e]._calcEngine.isSheetMember()&&o.parentObjectToToken!=null&&(f=o.parentObjectToToken.getItem(s._sheetName.value)+f),u._sheets[e]._calcEngine.refresh(f))},_formulaSelect:function(n){var t=n.text+"(";this.getActiveCellElem().find("input").val(t);this._getInputBox().val(t);this.XLCellNav._canKeyBoardNavigate=!1},_formulaBoxInputChange:function(n){var r=this.getActiveSheetIndex(),t=this.getSheet(r)._activeCell,u=this.getCell(t.rowIndex,t.colIndex,r),i=u.find("input:visible");this.XLEdit._isFormulaEdit=!n.target.value.indexOf("=");this.XLEdit._isFormulaEdit&&this.XLEdit._processFormulaEditRange(n.target.value,!0);i.length||(this.XLEdit.editCell(t.rowIndex,t.colIndex,!0),i=u.find("input:visible"));i.val(n.target.value);n.target.focus();this.XLEdit._isCellEdit=!1},_formulaSuggestionStatus:function(n){this._isFormulaSuggestion=n.type==="open"},_updateFormulaCellRange:function(n,t){var r,u=this.XLObj,f=u._getContent(u.getActiveSheetIndex()).find(".e-editedcell input").not(":hidden"),i=f.val(),e=i[i.length-1];t&&this._validCharacters.indexOf(e)===-1?i=i+",":(r=this._getCharPosition(i),r>-1&&(i=i.substr(0,[r+1])));n=i+n;f.val(n);u._getInputBox().val(n)},_getCharPosition:function(n){for(var t=n.length;t--;)if(this._validCharacters.indexOf(n[t])>-1)return t;return-1},_processFormulaEditRange:function(t,i){var f,e,u=0,r=this.XLObj,o=r.XLDragFill._parseFormula(t),s=o.length;for(r._ctrlKeyCount=0,r._formulaRange=[],r._ctrlKeyEnabled=!1,r.XLSelection._clearBorder(r._arrayAsString(r._ctrlFormulaBorder.concat(r._formulaBorder)));u<s;){if(f=o[u],this._invalidOperators.indexOf(f)>-1)break;r._isCellReference(f)&&(o[u+1]===":"&&(u++,r._isCellReference(o[u+1])&&(f=f+":"+o[u+1],u++)),this._updateFormulaEditRange(f,r._ctrlKeyCount),r._ctrlKeyCount++);u++}e=t.charAt(t.length-1);e==="("&&t.split("(").length===2?(r._isFormulaSuggestion=!1,r._getInputBox().val(t),i?n("#"+r._id+"_inputbox_suggestion").hide():r._getFormulaSuggElem().hide()):e===")"&&r.isFormula(t)&&(r.XLEdit._isFormulaEdit=!1,r._formulaRange=[],r._ctrlKeyCount=0);e===":"?(r._shiftKeyEnabled=!0,r._ctrlKeyCount--):this._validOperators.indexOf(e)>-1&&(r._dStartCell=r.getSheet(r.getActiveSheetIndex())._activeCell,r._ctrlKeyEnabled=!0,r._shiftKeyEnabled=!1)},_updateFormulaEditRange:function(n,t){var i=this.XLObj,r=i.getRangeIndices(n);i._formulaRange[t]=n;i._dStartCell={rowIndex:r[0],colIndex:r[1]};i._dEndCell={rowIndex:r[2],colIndex:r[3]};i.XLSelection._focusBorder(i._dStartCell,i._dEndCell,i._formulaBorder[t%6])}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.validation=function(n){this.XLObj=n;this._ruleSymbols={Greater:">",GreaterOrEqual:">=",Less:"<",LessOrEqual:"<=",Equal:"==",NotEqual:"!=",Between:">=&&<=&&=",NotBetween:">=&&<=&&!"}};t.spreadsheetFeatures.validation.prototype={_setValidation:function(){this.XLObj.model.allowDataValidation&&(this._initValidator(),this._setValidationToField())},_initValidator:function(){var i=n("#"+this.XLObj._id+"EditForm");i.validate({errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(i,r){var u=r.closest("td"),f=n(i).addClass("e-error");u.find(".e-error").remove();f.insertAfter(r.closest(".e-widget"));f.prepend(t.buildTag("div.e-errortail e-toparrow"));f.css({left:u[0].offsetLeft,top:u[0].offsetTop+r.height()})}})},_setValidationToField:function(){var n=this.XLObj,i=n.XLEdit.getPropertyValueByElem(n.getActiveCellElem(),"rule"),r;delete i.type;n.element.find("#"+n._id+"_"+n.XLEdit._EditCellDetails.fieldName).rules("add",i);r=n.element.find("#"+n._id+"EditForm").validate();t.isNullOrUndefined(i.required)||(r.settings.messages[name]={},r.settings.messages[name].required=n.XLEdit._EditCellDetails.fieldName+(n.XLEdit._EditCellDetails.rowIndex+1)+" is required")},applyDVRules:function(r,u,f,e){var o=this.XLObj,c=o.getActiveSheetIndex(),p=!1,k=o._getSelectedItems(c,e),s=k[0],h,l,w,v,y,a,b;if(o.model.allowDataValidation){h={};h.required=!r;switch(f){case"number":u.push("parseInt");h.digits=!0;u.push("number");break;case"decimal":u.push("parseFloat");h.number=!0;u.push("decimal");break;case"date":u.push("parseDate");h.date=!0;u.push("date");break;case"time":u.push("parseTime");u.push("time");break;case"text":u[1]="^"+u[1];u[2]="^"+u[2];u.push("length");u.push("text");break;case"list":w=u[1];u=[];u.push(w);u.push("list")}for(u.push(o._getSelectedItems(c,e)[1]),u.push(c),h.customVal=u.join("_"),h.type=f,v=[],y={},i=0,len=s.length;i<len;i++)a=t.isNullOrUndefined(s[i].colIndex)?{rowIndex:n(s[i]).parent().index(),colIndex:s[i].cellIndex}:s[i],l=o.getCell(a.rowIndex,a.colIndex),y={rowIndex:a.rowIndex,colIndex:a.colIndex,prevRule:o.XLEdit.getPropertyValueByElem(l,"rule")},l.hasClass("e-hlcell")&&(p=!0),l.removeData("rule"),l.removeClass("e-hlcell"),o.XLEdit._updateDataContainer(l[0],{rule:h}),v.push(y);p===!0&&this.highlightInvalidData();o.model.sheets[c]._importRendered||o._isUndoRedo||(b={sheetIndex:c,reqType:"validation",operation:"apply-validation",selectedCells:v,range:o._getAlphaRange(c,s[0].rowIndex,s[0].colIndex,s[s.length-1].rowIndex,s[s.length-1].colIndex)},o._completeAction(b))}},clearDV:function(n){var i=this.XLObj,r,o,u,s,h,e,f,c;if(i.model.allowDataValidation){for(s=i.getActiveSheetIndex(),h={sheetIndex:s,reqType:"validation",operation:"clear-validation",selCells:[]},t.isNullOrUndefined(n)?(r=i.model.sheets[s]._selectedCells,u=i.XLSelection._getSelectedRange({rowIndex:r[0].rowIndex,colIndex:r[0].colIndex},{rowIndex:r[r.length-1].rowIndex,colIndex:r[r.length-1].colIndex})):(e=i.getRangeIndices(n),u=i.XLSelection._getSelectedRange({rowIndex:e[0],colIndex:e[1]},{rowIndex:e[2],colIndex:e[3]})),f=0,c=u.length;f<c;f++)o=i.getCell(u[f].rowIndex,u[f].colIndex),h.selCells.push({rowIndex:u[f].rowIndex,colIndex:u[f].colIndex,rules:i.XLEdit.getPropertyValueByElem(o,"rule")}),i.clearRangeData(null,["rule"],o),o.removeClass("e-hlcell");i._isUndoRedo||i._completeAction(h)}},clearHighlightedValData:function(n){var i=this.XLObj,r,s,u,o,f,e,h,c;if(i.model.allowDataValidation){for(o=i.getActiveSheetIndex(),t.isNullOrUndefined(n)?(r=i.model.sheets[o]._selectedCells,u=i.XLSelection._getSelectedRange({rowIndex:r[0].rowIndex,colIndex:r[0].colIndex},{rowIndex:r[r.length-1].rowIndex,colIndex:r[r.length-1].colIndex})):(f=i.getRangeIndices(n),u=i.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]})),e=0,h=u.length;e<h;e++)s=i.getCell(u[e].rowIndex,u[e].colIndex),s.removeClass("e-hlcell");i._isUndoRedo||(c={sheetIndex:o,reqType:"validation",operation:"cl-hl-data",range:n},i._completeAction(c))}},_checkValidation:function(n,i){var r=this.XLObj,h,o,s,u,f,e;if(n.length){if(i[i.length-4]==="list"){for(s=!1,i=i.splice(0,i.length-4),o=0,h=i.length;o<h;o++)if(s=r._dataContainer.sharedData[parseInt(i[o])].toString()===n,s)break;return t.Spreadsheet.msg="The value you entered is not valid",s}return i[0]=this._ruleSymbols[i[0]],i[1].indexOf("=")>-1&&(u=i[1].replace("=",""),f=this.getRangeIndices(u+":"+u),i[1]=r.XLEdit.getPropertyValue(f[0],f[1]).toString()),i[2].indexOf("=")>-1&&(u=i[2].replace("=",""),f=this.getRangeIndices(u+":"+u),i[2]=r.XLEdit.getPropertyValue(f[0],f[1]).toString()),i[0].length<=2?(t.Spreadsheet.msg="The "+i[4]+" should be "+t.Spreadsheet.Validation[i[0]]+" "+i[1].replace("^",""),r.operators[i[0]](r.parse[i[3]](n),r.parse[i[3]](i[1]))):(e=[],e=i[0].split("&&"),t.Spreadsheet.msg="The "+i[4]+" should "+t.Spreadsheet.Validation[e[2]]+"Between "+i[1].replace("^","")+" and "+i[2].replace("^",""),r.operators[e[2]](r.operators[e[0]](r.parse[i[3]](n),r.parse[i[3]](i[1]))&&r.operators[e[1]](r.parse[i[3]](n),r.parse[i[3]](i[2]))))}return!0},highlightInvalidData:function(i){var r=this.XLObj,a,v,u,f,c,e,s,l,h,o,y;if(r.model.allowDataValidation){for(h=r.getActiveSheetIndex(),t.isNullOrUndefined(i)?(u=r.model.sheets[h]._selectedCells,i=r._getAlphaRange(h,u[0].rowIndex,u[0].colIndex,u[u.length-1].rowIndex,u[u.length-1].colIndex)):(s=r.getRangeIndices(i),u=r.XLSelection._getSelectedRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]})),e=0,a=u.length;e<a;e++)l=t.isNullOrUndefined(u[e].colIndex)?{rowIndex:n(u[e]).parent().index(),colIndex:u[e].cellIndex}:u[e],f=r.getCell(l.rowIndex,l.colIndex),o=r.XLEdit.getPropertyValueByElem(f,"rule"),r.XLEdit.getPropertyValueByElem(f)&&!t.isNullOrUndefined(o)?(v=r.XLEdit.getPropertyValueByElem(f,"type")==="datetime"?r.XLEdit.getPropertyValueByElem(f,"value2").toString():r.XLEdit.getPropertyValueByElem(f).toString(),c=o?!this._checkValidation(v,o.customVal.split("_")):!1):t.isNullOrUndefined(o)||(c=o.required),c?f.addClass("e-hlcell"):f.removeClass("e-hlcell");r._isUndoRedo||(y={sheetIndex:h,reqType:"validation",operation:"hl-data",range:i},r._completeAction(y))}},_replaceRule:function(n,t){this.XLObj._dataContainer.cFormatData[n]=t}};t.isNullOrUndefined(n.validator)||n.validator.addMethod("customVal",function(t,i,r){var u=n("#"+n(i).parents("div")[7].id).data("ejSpreadsheet");return u.XLValidate._checkValidation(t,r.split("_"))},t.Spreadsheet.getMsg)}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.dragFill=function(n){this.XLObj=n;this._customList=[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]];this._uniqueOBracket=String.fromCharCode(129);this._uniqueCBracket=String.fromCharCode(130);this._uniqueCSeparator=String.fromCharCode(131);this._uniqueCOperator=String.fromCharCode(132);this._uniquePOperator=String.fromCharCode(133);this._uniqueSOperator=String.fromCharCode(134);this._uniqueMOperator=String.fromCharCode(135);this._uniqueDOperator=String.fromCharCode(136);this._uniqueModOperator=String.fromCharCode(137)};t.spreadsheetFeatures.dragFill.prototype={positionAutoFillElement:function(t){if(this.XLObj.model.allowAutoFill){var e,u,f,i=this.XLObj,s="e-hide",o=i.getActiveSheetIndex(),h=i._getJSSheetRowHeaderContent(o)[0].querySelectorAll("td.e-rowselected"),c=i._getJSSheetHeader(o)[0].querySelectorAll("th.e-colselected"),r=h.length?h:c.length?c:i.XLSelection.getSelectedCells(),l=r.length;l&&(r=r[l-1],e=i.XLSelection._getSpanIndex(r.className),e&&(r=i.getCell(e.rowIndex,e.colIndex)[0]),u=n(r),f=u.offset(),i.getAutoFillElem().removeClass(s).offset({top:f.top+u.height(),left:f.left+u.width()}),i.model.autoFillSettings.showFillOptions&&t&&i._getAutoFillOptElem().removeClass(s).offset({top:f.top+u.height()+5,left:f.left+u.width()+2}),i.getSheet(o)._autoFillCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex});i.model.allowFormulaBar&&i.updateFormulaBar()}},hideAutoFillElement:function(){this.XLObj.getAutoFillElem().addClass("e-hide")},hideAutoFillOptions:function(){this.XLObj._getAutoFillOptElem().find("button").data("ejSplitButton")._hidePopup();this.XLObj._getAutoFillOptElem().addClass("e-hide")},autoFill:function(n){var i,r,u;if((n=n||{},this.XLObj.model.allowAutoFill&&n.dataRange&&n.fillRange&&n.direction)&&(i=this.XLObj,r=t.Spreadsheet.AutoFillOptions,n.fillType=n.fillType?n.fillType:r.FillSeries,n.sheetIndex=i.getActiveSheetIndex(),u={sheetIndex:n.sheetIndex,reqType:"auto-fill",range:n.fillRange,bRange:n.dataRange,bData:i.getRangeData(n.fillRange),bFormat:i.XLFormat.getHashCodeClassAsArray(n.fillRange)},i._isAutoFillClass=!0,!i._trigger("autoFillBegin",n))){switch(n.fillType){case r.FillSeries:case r.FillWithoutFormatting:this._fillSeries(n);break;case r.CopyCells:case r.FillFormattingOnly:this._copyCells(n);break;case r.FlashFill:u.actionType="flash-fill";u.bdData=i.getRangeData(n.dataRange);this._flashFill(n);u.adData=i.getRangeData(n.dataRange)}u.aData=i.getRangeData(n.fillRange);u.aFormat=i.XLFormat.getHashCodeClassAsArray(n.fillRange);i._completeAction(u);i._trigger("autoFillComplete",n)}},_fillSeries:function(i){for(var u,st,o,r,rt,s,h,v,ht,y,ut,c,ct,p,w,b,k,l,lt,e=0,f=this.XLObj,yt=f.getActiveSheetIndex(),d=t.Spreadsheet.autoFillDirection,g=t.Spreadsheet.CellType,nt=i.dataRange[0],tt=i.dataRange[1],at=i.dataRange[2],vt=i.dataRange[3],ft=i.fillRange[0],et=i.fillRange[1],pt=i.fillRange[2],wt=i.fillRange[3],it=[d.Down,d.Up].indexOf(i.direction)>-1,a=[d.Up,d.Left].indexOf(i.direction)>-1,bt=it?vt-tt:at-nt,ot=i.fillType===t.Spreadsheet.AutoFillOptions.FillSeries;e<=bt;){if(it?(p={rowIndex:nt,colIndex:tt+e},w={rowIndex:at,colIndex:tt+e},b={rowIndex:ft,colIndex:et+e},k={rowIndex:pt,colIndex:et+e}):(p={rowIndex:nt+e,colIndex:tt},w={rowIndex:nt+e,colIndex:vt},b={rowIndex:ft+e,colIndex:et},k={rowIndex:ft+e,colIndex:wt}),rt=[p.rowIndex,p.colIndex,w.rowIndex,w.colIndex],o=this._getPattern(rt,{isRFill:a,isVFill:it}),!o)return;for(st=o.length,ot&&(f.XLFormat.clearFormat(i.fillRange),c=f.getRangeData(rt,null,["format"]),ct=c.length),l=f.getRange(b.rowIndex,b.colIndex,k.rowIndex,k.colIndex),lt=l.length,a&&(l=l.toArray().reverse(),o=o.reverse(),o=this._ensurePattern(o),ot&&(c=c.reverse())),h=0;h<lt;){r=o[h%st];f.isNumber(r)&&(r=o[r]);switch(r.type){case g.Number:u=f._round(r.regVal.a+r.regVal.b*r.i,5);a?r.i--:r.i++;break;case g.String:u=r.val[r.i%r.val.length];r.i++;break;case g.Formula:for(ut=!1,u="=",v=0,ht=r.val.length;v<ht;)s=r.val[v],f._isObject(s)?(ut=!0,y=f._round(s.a+s.b*r.i,0),u+=y<1?"#REF!":it?s.c+y:f._generateHeaderText(yt,y)+s.c):u+=s,v++;ut&&a?r.i--:r.i++;break;case g.Custom:u=f._round(r.regVal.a+r.regVal.b*r.i,0);u<0&&(u=u%r.len+r.len);u>=r.len&&(u=u%r.len);u=r.val[u];a?r.i--:r.i++}f.XLEdit.updateCellValue(n(l[h]),u,ot?c[h%ct].format:null);h++}e++}},_ensurePattern:function(n){for(var i,u=-1,r=n.length;r--;)i=n[r],this.XLObj._isObject(i)?(u=r,i.type===t.Spreadsheet.CellType.String&&(i.val=i.val.reverse())):n[r]=u;return n},_copyCells:function(i){for(var u,w,s,h,c,l,a,b,f,e,d,o=this.XLObj,r=0,v=t.Spreadsheet.autoFillDirection,y=i.dataRange[0],p=i.dataRange[1],it=i.dataRange[2],rt=i.dataRange[3],g=i.fillRange[0],nt=i.fillRange[1],ft=i.fillRange[2],et=i.fillRange[3],ut=[v.Down,v.Up].indexOf(i.direction)>-1,ot=[v.Up,v.Left].indexOf(i.direction)>-1,st=ut?rt-p:it-y,tt=i.fillType===t.Spreadsheet.AutoFillOptions.FillFormattingOnly;r<=st;){if(ut?(c={rowIndex:y,colIndex:p+r},l={rowIndex:it,colIndex:p+r},s={rowIndex:g,colIndex:nt+r},h={rowIndex:ft,colIndex:nt+r}):(c={rowIndex:y+r,colIndex:p},l={rowIndex:y+r,colIndex:rt},s={rowIndex:g+r,colIndex:nt},h={rowIndex:g+r,colIndex:et}),w=[c.rowIndex,c.colIndex,l.rowIndex,l.colIndex],o.XLFormat.clearFormat(i.fillRange),tt||(a=o.getRangeData(w,!0,null,null,!0)),f=o.getRangeData(w,null,["format"]),b=f.length,e=o.getRange(s.rowIndex,s.colIndex,h.rowIndex,h.colIndex),d=e.length,u=0,ot&&(e=e.toArray().reverse(),f=f.reverse(),tt||(a=a.reverse())),tt)while(u<d)o.XLFormat._updateFormatClass(e[u],f[u%b].format),u++;else while(u<d)k=u%b,o.XLEdit.updateCellValue(n(e[u]),a[k],f[k].format),u++;r++}},_flashFill:function(t){var h,r,o,s,i=this.XLObj,c=t.dataRange[0],l=t.dataRange[2],u=t.fillRange[0],a=t.fillRange[1],f=t.fillRange[2],v=t.fillRange[3],e=this._getFlashFillPattern(t.dataRange,"left");if(e)for(o=i.getRangeData([u,e.colIndex,f,e.colIndex],!0,null,null,!0),e.subStr>-1&&(o=this._splitString(o," ",e.subStr)),r=i.getRange(u,a,f,v),s=r.length;s--;)i.XLEdit.updateCellValue(n(r[s]),o[s]);else u>c&&(u=c),f<l&&(f=l),r=i.getRange(u,a,f,v),h=n("#"+i._id+"_alertdlg"),i._getAutoFillOptElem().addClass("e-hide"),i.updateUniqueData({value:"",value2:"",type:"general"},null,r),i._renderAlertDlgContent(h,"Alert",i._getLocStr("FlashFillAlert")),h.ejDialog("open")},_getFlashFillPattern:function(n,i){var u,f,h,a,e,r=0,o=-1,v=this.XLObj,s=v.getRangeData(n,!0,null,null,!0),y=s.length,c=n[0],p=t.Spreadsheet.autoFillDirection.Right,w=i===p,l;if(s.join().replace(/,/g,"").length&&(l=s[0].toString(),r=n[1],r)){while(w?r++:r--)if(f=v.XLEdit.getPropertyValue(c,r),f=t.isNullOrUndefined(f)?"":f.toString(),f.length){if(f===l)if(y>1){if(u=this._matchData(c,r,s),u)return u}else return{colIndex:r,subStr:o};for(h=f.split(" "),a=h.length,e=0;e<a;){if(l===h[e])if(o=e,y>1){if(u=this._matchData(c,r,s),u)return o>u.subStr&&(u.subStr=o),u}else return{colIndex:r,subStr:o};e++}}else break;if(!w)return this._getFlashFillPattern(n,p)}},_matchData:function(n,i,r){for(var u,o=!1,s,f,h,l,e=1,c=-1,a=r.length;e<a;){if(o=!1,s=r[e].toString(),f=this.XLObj.XLEdit.getPropertyValue(n+e,i),f=t.isNullOrUndefined(f)?"":f.toString(),s===f){o=!0;e++;continue}for(h=f.split(" "),l=h.length,u=0;u<l;){if(s===h[u]){c<u&&(c=u);o=!0;break}u++}e++}if(o&&e===a)return{colIndex:i,subStr:c}},_splitString:function(n,t,i){for(var f,r,u=n.length;u--;){for(j=i,f=n[u].split(t);j>-1;){if(r=f[j],r)break;j--}n[u]=r}return n},_getPattern:function(n,i){var u,o,s,a,l,v,w,b,h,e,y=0,f=[],k=this.XLObj,c=t.Spreadsheet.CellType,p=this._getDataPattern(n),d=p.length,r;if(p){while(y<d){r=p[y];switch(r.type){case c.Number:for(o=f.length,e=r.val.length,h=i.isRFill?-1:e,e===1&&r.val.push(r.val[0]+1),a=this._getPredictionValue(r.val),s={regVal:a,type:r.type,i:h},f.push(s),u=1;u<e;)f.push(o),u++;break;case c.String:for(o=f.length,s={val:r.val,type:r.type,i:0},f.push(s),u=1,e=r.val.length;u<e;)f.push(o),u++;break;case c.Formula:if(e=r.val.length,r=this._getFormulaPattern(r.val,i),h=i.isRFill?-1:e,r.isInPattern)for(o=f.length,s={val:r.val,type:c.Formula,i:h},f.push(s),u=1;u<e;)f.push(o),u++;else for(u=0,h=i.isRFill?-1:1;u<e;)f.push({val:r.val[u],type:c.Formula,i:h}),u++;break;default:if(r.type.indexOf(c.Custom)>-1)for(o=f.length,e=r.val.length,h=i.isRFill?-1:e,l=this._customList[Number(r.type.replace(c.Custom,""))],b=l.indexOf(r.val[0])===-1,v=k.toArrayLowerCase(l.slice(0)),w=k.toArrayLowerCase(r.val),a=this._getCustomPredictionValue(w,v),s={val:b?v:l,regVal:a,i:h,type:c.Custom,len:l.length},f.push(s),u=1;u<e;)f.push(o),u++}y++}return f}},_getCustomPredictionValue:function(n,t){for(var r=0,i=[],u=n.length;r<u;)i.push(t.indexOf(n[r])),r++;return i.length===1&&i.push(i[0]+1),this._getPredictionValue(i)},_getDataPattern:function(n){var i,r,u=0,t={},f=[],e=this.XLObj.getRangeData(n,!0,null,null,!0),o=e.length;if(o){while(u<o)i=e[u],r=this._getType(i),u===0?t={val:[i],type:r}:r===t.type?t.val.push(i):(f.push(t),t={val:[i],type:r}),u++;return f.push(t),f}},_getFormulaPattern:function(n,t){for(var r,e,u,h=this.XLObj,f=[],i=0,s=n.length,o;i<s;)f.push(this._parseFormula(n[i])),i++;if(o=this._isInPattern(f,t.isVFill),o){for(r=f[0],i=r.length;i--;)u=r[i],h._isCellReference(u)&&(r[i]=this._getCellRefPrediction(u,t));return{isInPattern:o,val:r}}for(i=0;i<s;){for(r=f[i],e=r.length;e--;)u=r[e],h._isCellReference(u)&&(f[i][e]=this._getCellRefPrediction(u,t,s));i++}return{isInPattern:o,val:f}},_getCellRefPrediction:function(n,t,i){n=n.toUpperCase();var u=[],e=new RegExp("[a-z]","gi"),o=new RegExp("[0-9]","g"),f="",s=t.isVFill?n.replace(o,f):n.replace(e,f),r=t.isVFill?Number(n.replace(e,f)):this.XLObj._generateColCount(n.replace(o,f));return i&&i!==1?(u.push(r),u.push(r+i)):(u.push(r),u.push(r+1)),r=this._getPredictionValue(u),r.c=s,r},_isInPattern:function(n,t){var o,i,s,a,r,u,h,c,f=this.XLObj,e="",v=0,l=1,y=n.length,p=new RegExp("[0-9]","g"),w=new RegExp("[a-z]","gi");if(y===1)return!1;while(l<y){if(o=n[v],s=n[l],i=o.length,a=s.length,i!==a)return!1;while(i--)if(r=o[i],u=s[i],f._isCellReference(r)===f._isCellReference(u)){if(t?(h=Number(r.replace(w,e)),c=Number(u.replace(w,e))):(h=f._generateColCount(r.replace(p,e)),c=f._generateColCount(u.replace(p,e))),h!==c-1)return!1}else if(r!==u)return!1;v++;l++}return!0},_parseFormula:function(n){var t,u,r=0,i=[],f;for(n=this._markSpecialChar(n.replace("=","")),n=n.split(/\(|\)|,|:|\+|-|\*|\/|%/g),f=n.length;r<f;){if(t=n[r],!t){r++;continue}t.length===1?i.push(this._isUniqueChar(t)?this._getUniqueCharVal(t):t):(u=t[0],this._isUniqueChar(u)?(i.push(this._getUniqueCharVal(u)),i.push(t.substr(1))):i.push(t));r++}return i},_getUniqueCharVal:function(n){switch(n){case this._uniqueOBracket:return"(";case this._uniqueCBracket:return")";case this._uniqueCSeparator:return",";case this._uniqueCOperator:return":";case this._uniquePOperator:return"+";case this._uniqueSOperator:return"-";case this._uniqueMOperator:return"*";case this._uniqueDOperator:return"/";case this._uniqueModOperator:return"%"}return""},_isUniqueChar:function(n){var t=n.charCodeAt(n);return t>=129&&t<=137},_markSpecialChar:function(n){return n=n.replace(/\(/g,"("+this._uniqueOBracket).replace(/\)/g,")"+this._uniqueCBracket),n=n.replace(/,/g,","+this._uniqueCSeparator).replace(/:/g,":"+this._uniqueCOperator),n=n.replace(/\+/g,"+"+this._uniquePOperator).replace(/-/g,"-"+this._uniqueSOperator),n=n.replace(/\*/g,"*"+this._uniqueMOperator).replace(/\//g,"/"+this._uniqueDOperator),n.replace(/%/g,"%"+this._uniqueModOperator)},_getPredictionValue:function(n){for(var t=0,i=0,u=0,f=0,r=0,e=n.length,o,s;t<e;)i=i+t,u=u+Number(n[t]),f=f+t*Number(n[t]),r=r+t*t,t++;return o=this.XLObj._round((u*r-i*f)/(e*r-i*i),5),s=this.XLObj._round((e*f-i*u)/(e*r-i*i),5),{a:o,b:s}},_getType:function(n){var i=this._isCustomType(n),r=t.Spreadsheet.CellType,u=this.XLObj;return i?i=i:u.isFormula(n)?i=r.Formula:u.isNumber(n)&&(i=r.Number),i||r.String},_isCustomType:function(n){n=n+"";n=n.toLowerCase();for(var i=this._customList.length;i--;)if(this.XLObj.toArrayLowerCase(this._customList[i].slice(0)).indexOf(n)>-1)return t.Spreadsheet.CellType.Custom+i;return!1},_selectAutoFillRange:function(n,t){var u,r,i,f;if(n&&(t={rowIndex:n.parentNode.rowIndex,colIndex:n.cellIndex}),r=this.XLObj,i=this._getAutoFillRange(t),i){for(this._autoFillCleanUp(),f=r.getRange(i.startCell.rowIndex,i.startCell.colIndex,i.endCell.rowIndex,i.endCell.colIndex),u=f.length;u--;)r.addClass(f[u],"e-autofillcell");r.XLSelection._focusRange(i.startCell,i.endCell,r._autofillBorder)}},_getAutoFillRange:function(n){var s=t.Spreadsheet.autoFillDirection,v=this.XLObj,h=this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()),y=h._startCell,p=h._endCell,i=h._autoFillCell,f=h.selectedRange,e=f[0],o=f[1],r=f[2],u=f[3],l=v.inRange(f,n.rowIndex,n.colIndex),c={rowIndex:e,colIndex:o},a={rowIndex:r,colIndex:u};return n.rowIndex<i.rowIndex?l?{startCell:c,endCell:{rowIndex:n.rowIndex,colIndex:u}}:{startCell:a,endCell:{rowIndex:n.rowIndex,colIndex:o},fillRange:[n.rowIndex,o,e-1,u],direction:s.Up}:n.colIndex>i.colIndex?{startCell:c,endCell:{rowIndex:r,colIndex:n.colIndex},fillRange:[e,u+1,r,n.colIndex],direction:s.Right}:n.rowIndex>i.rowIndex?{startCell:c,endCell:{rowIndex:n.rowIndex,colIndex:u},fillRange:[r+1,o,n.rowIndex,u],direction:s.Down}:n.colIndex<i.colIndex?l?{startCell:c,endCell:{rowIndex:r,colIndex:n.colIndex}}:{startCell:a,endCell:{rowIndex:e,colIndex:n.colIndex},fillRange:[e,n.colIndex,r,o-1],direction:s.Left}:n.rowIndex===i.rowIndex&&n.colIndex===i.colIndex?{startCell:y,endCell:p}:void 0},_getDirection:function(n,i){var r=t.Spreadsheet.autoFillDirection;return i.rowIndex<n.rowIndex?r.Up:i.colIndex>n.colIndex?r.Right:i.rowIndex>n.rowIndex?r.Down:i.colIndex<n.colIndex?r.Left:null},_getFillRange:function(n,i,r,u){var f=t.Spreadsheet.autoFillDirection;switch(u){case f.Up:return[r.rowIndex,r.colIndex,n.rowIndex-1,i.colIndex];case f.Right:return[n.rowIndex,i.colIndex+1,i.rowIndex,r.colIndex];case f.Down:return[i.rowIndex+1,n.colIndex,r.rowIndex,i.colIndex];case f.Left:return[n.rowIndex,r.colIndex,i.rowIndex,n.colIndex-1]}return null},_autoFillOptionClick:function(t){var f=n("#"+t.model.targetID),e=f.find("span"),u=f.find("#"+t.ID).find(">>");if(!this._hasClass(u[0],"e-ss-fillselect")){var r=this.XLDragFill,i=this.getSheet(this.getActiveSheetIndex()),o=r._getDirection(this._pEndCell,this._pFillCell),s=this.swapRange([this._pStartCell.rowIndex,this._pStartCell.colIndex,this._pEndCell.rowIndex,this._pEndCell.colIndex]),h=r._getFillRange(this._pStartCell,this._pEndCell,this._pFillCell,o),c=i._startCell,l=i._endCell;this._isUndo=!0;this._performUndoRedo();i._startCell=c;i._endCell=l;this.XLSelection.selectRange(i._startCell,i._endCell);r.positionAutoFillElement(!0);r.autoFill({dataRange:s,fillRange:h,direction:o,fillType:t.ID});e.removeClass("e-ss-fillselect");e.addClass("e-ss-filloption");u.removeClass("e-ss-filloption e-ss-fillselect");u.addClass("e-ss-fillselect");this._isAutoFillClass=this._isUndo=!1}},_autoFillCleanUp:function(){var i,n,r,f="e-hide",t=this.XLObj,e=t.getAutoFillElem(),o=t._getAutoFillOptElem(),u;for(e&&t.addClass(e[0],f),o&&t.addClass(o[0],f),u=t._getContent(t.getActiveSheetIndex())[0].querySelectorAll("td.e-autofillcell"),i=u.length;i--;)r=u[i],n=r.className,n=n.replace(/e-autofillcell|e-blur/g,""),n=n.replace(/ +/g," "),r.className=n},_autoFillClick:function(){for(var o=!1,u=!1,s=this.getSheet(this.getActiveSheetIndex()).selectedRange,r=this.XLDragFill._getPattern(s,{isRFill:!0,isVFill:!0}),f=n("#"+this._id+"_ctxtmenu"),e=f.find("#flashfill"),i=f.find("#fillseries"),l=f.find("#copycells span"),h=s[3]-s[1]+1,t=0,c=r.length;t<c;t++)this.isUndefined(r[t].type)||r[t].type!=="string"||(o=!0),this.isUndefined(r[t].type)||r[t].type!=="number"||(u=!0);this._isAutoFillClass&&f.find("span").removeClass("e-ss-fillselect").addClass("e-ss-filloption");o&&!u&&h>1?(i.hide(),e.hide(),this._isAutoFillClass&&l.addClass("e-ss-fillselect")):u&&h===1?(this._isAutoFillClass&&i.find("span").addClass("e-ss-fillselect"),i.show(),e.show()):o&&!u&&h===1?(e.show(),i.hide(),this._isAutoFillClass&&l.addClass("e-ss-fillselect")):(this._isAutoFillClass&&i.find("span").addClass("e-ss-fillselect"),e.hide(),i.show())}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellNavigation=function(n){this.XLObj=n;this._canKeyBoardNavigate=!0;this._isNavigate=!0};t.spreadsheetFeatures.cellNavigation.prototype={_selectionKeyDownHandler:function(t){var w,a,b,e,o,l,k,i=this.XLObj,c=i.getActiveSheetIndex(),f=i.getSheet(c),r=t.keyCode,v=t.shiftKey,d=t.ctrlKey,s={keyCode:r,shiftKey:v,ctrlKey:d,altKey:t.altKey},u=f._activeCell,h=f._endCell,y=f.rowCount,p=f.colCount;if((r===9&&this._canKeyBoardNavigate||r===13)&&!d){if(t.preventDefault(),a=t.target.value,i.XLEdit._isFormulaEdit&&!i._isFormulaSuggestion)if(a.length>1)if(this._isValidParameter(a))i.isFormula(a)||(a=a+")",i.getActiveCellElem(c).find("input:visible").val(a),i._getInputBox().val(a)),i.XLEdit.saveCell(),i._getContent(c).find("td").removeClass(i._formulaBorder.join(" ").replace(/,/g," ")+" "+i._ctrlFormulaBorder.join(" ").replace(/,/g," ")),i.XLSelection._cleanUp(),i.XLSelection.selectRange(f._activeCell,f._activeCell),i.XLEdit._isFormulaEdit=!1,i._formulaRange=[],i._ctrlKeyCount=0;else{w=n("#"+i._id+"_alertdlg");i._renderAlertDlgContent(w,"Alert",i._getLocStr("MissingParenthesisAlert"),"MissingParenthesis");w.ejDialog("open")&&w.focus();return}else i.XLEdit.saveCell(),i.XLEdit._isFormulaEdit=!1;b=i._getJSSheetRowHeaderContent(c).find(".e-rowselected").length>0?i._getJSSheetRowHeaderContent(c).find(".e-rowselected"):i._getJSSheetHeader(c).find(".e-colselected").length>0?i._getJSSheetHeader(c).find(".e-colselected"):i._getContent(c).find(".e-selected");b.length&&(k=b[0].className,b.length===1?k.indexOf("e-rowcell")>-1?v?r===9&&u.colIndex>0?this._navigateCell(u.rowIndex,u.colIndex-1,s):r===13&&u.rowIndex>0&&this._navigateCell(u.rowIndex-1,u.colIndex,s):r===9&&u.colIndex<p?this._navigateCell(u.rowIndex,u.colIndex+1,s):r===13&&u.rowIndex<y&&this._navigateCell(u.rowIndex+1,u.colIndex,s):k.indexOf("e-rowselected")>-1?v?u.colIndex>0&&this._navigateRow("Backward"):u.colIndex<39&&this._navigateRow("Forward"):k.indexOf("e-colselected")>-1&&(v?u.rowIndex>0&&this._navigateCol("Backward"):u.rowIndex<39&&this._navigateCol("Forward")):v?r===9?this._navigateRange("ShiftTab"):this._navigateRange("ShiftEnter"):r===9?this._navigateRange("Tab"):this._navigateRange("Enter"))}else if((r===37||r===38&&!i._isFormulaSuggestion||r===39||r===40&&!i._isFormulaSuggestion)&&this._isNavigate)if(t.preventDefault(),i.XLEdit._isFormulaEdit)l=i.swapRange([i._dStartCell.rowIndex,i._dStartCell.colIndex,i._dEndCell.rowIndex,i._dEndCell.colIndex]),i.getRange(l[0]?l[0]-1:l[0],l[1]?l[1]-1:l[1],l[2],l[3]).removeClass(i._formulaBorder[i._ctrlKeyCount%6].join(" ")+" "+i._ctrlFormulaBorder[i._ctrlKeyCount%6].join(" ")),d&&(e=i._dStartCell,r===37&&e.colIndex>0?i._dStartCell=i._dEndCell={rowIndex:e.rowIndex,colIndex:0}:r===38&&e.rowIndex>0?i._dStartCell=i._dEndCell={rowIndex:0,colIndex:e.colIndex}:r===39&&e.colIndex<f.colCount?i._dStartCell=i._dEndCell={rowIndex:e.rowIndex,colIndex:f.colCount}:r===40&&e.rowIndex<y&&(i._dStartCell=i._dEndCell={rowIndex:f.colCount,colIndex:e.colIndex})),v||i._shiftKeyEnabled?(o=i._dEndCell,r===37&&o.colIndex>0?i._dEndCell={rowIndex:o.rowIndex,colIndex:o.colIndex-1}:r===38&&o.rowIndex>0?i._dEndCell={rowIndex:o.rowIndex-1,colIndex:o.colIndex}:r===39&&o.colIndex<f.colCount?i._dEndCell={rowIndex:o.rowIndex,colIndex:o.colIndex+1}:r===40&&o.rowIndex<f.rowCount&&(i._dEndCell={rowIndex:o.rowIndex+1,colIndex:o.colIndex})):(e=i._dStartCell,r===37&&e.colIndex>0?i._dStartCell=i._dEndCell={rowIndex:e.rowIndex,colIndex:e.colIndex-1}:r===38&&e.rowIndex>0?i._dStartCell=i._dEndCell={rowIndex:e.rowIndex-1,colIndex:e.colIndex}:r===39&&e.colIndex<f.colCount?i._dStartCell=i._dEndCell={rowIndex:e.rowIndex,colIndex:e.colIndex+1}:r===40&&e.rowIndex<f.rowCount&&(i._dStartCell=i._dEndCell={rowIndex:e.rowIndex+1,colIndex:e.colIndex})),i.XLSelection._processFormulaRange(i._ctrlFormulaBorder),i._formulaRange[i._ctrlKeyCount]=i._getProperAlphaRange(c,i._dStartCell.rowIndex,i._dStartCell.colIndex,i._dEndCell.rowIndex,i._dEndCell.colIndex);else if(d)r===37&&u.colIndex>0?this._navigateCell(u.rowIndex,0,s):r===38&&u.rowIndex>0?this._navigateCell(0,u.colIndex,s):r===39&&u.colIndex<p-1?this._navigateCell(u.rowIndex,p-1,s):r===40&&u.rowIndex<y-1&&this._navigateCell(y-1,u.colIndex,s);else if(v){if(r===37&&h.colIndex>0?f._endCell={rowIndex:h.rowIndex,colIndex:h.colIndex-1}:r===38&&h.rowIndex>0?f._endCell={rowIndex:h.rowIndex-1,colIndex:h.colIndex}:r===39&&h.colIndex<p?f._endCell={rowIndex:h.rowIndex,colIndex:h.colIndex+1}:r===40&&h.rowIndex<y&&(f._endCell={rowIndex:h.rowIndex+1,colIndex:h.colIndex}),(f.rowCount===f._endCell.rowIndex||f.colCount===f._endCell.colIndex)&&i.model.scrollSettings.scrollMode==="normal")return;f.rowCount===f._endCell.rowIndex&&i.XLScroll._scrollY(c);f.colCount===f._endCell.colIndex&&i.XLScroll._scrollX(c);i.XLSelection.selectRange(f._startCell,f._endCell);i.XLDragFill.positionAutoFillElement()}else if(s={keyCode:r,shiftKey:!1,ctrlKey:!1,altKey:!1},r===37&&u.colIndex>0)this._navigateCell(u.rowIndex,u.colIndex-1,s);else if(r===38&&u.rowIndex>0)this._navigateCell(u.rowIndex-1,u.colIndex,s);else if(r===39&&u.colIndex<p)this._navigateCell(u.rowIndex,u.colIndex+1,s);else if(r===40&&u.rowIndex<y)this._navigateCell(u.rowIndex+1,u.colIndex,s);else return!1},_navigateCell:function(i,r,u){var p,w,s,f=this.XLObj,c=f.getActiveSheetIndex(),e=f.getSheet(c),y=f._getContent(c),l=y.find("#hscrollBar").data("ejScrollBar"),a=y.find("#vscrollBar").data("ejScrollBar"),h=y.find(".e-content"),o,v=!1;if(e.rowCount!==i&&e.colCount!==r||f.model.scrollSettings.scrollMode!=="normal"){e.rowCount===i&&(f.XLScroll._scrollY(c),v=!0);e.colCount===r&&(f.XLScroll._scrollX(c),v=!0);o=f.getCell(i,r);o.length>0&&(e._activeCell=e._endCell=e._startCell={rowIndex:i,colIndex:r});s=f.getCell(i,r)[0];!t.isNullOrUndefined(s)&&(s.className.indexOf("e-rc-")>-1||f.hasSpan(s.rowSpan)||f.hasSpan(s.colSpan))&&(f.XLSelection._processBoundary(),e._activeCell=e._startCell,o=f.getCell(e._activeCell.rowIndex,e._activeCell.colIndex),w=!0);o.length<1?u.keyCode==40||u.keyCode==13?f.XLScroll._scrollY(c):(u.keyCode==39||u.keyCode==9)&&f.XLScroll._scrollX(c):(h.offset().top+h[0].offsetHeight<=o.offset().top+o[0].offsetHeight&&(u.keyCode==40||u.keyCode==13&&!u.shiftKey)&&!v?(a._scrollData.step=1,u.ctrlKey&&u.keyCode==40?f.XLScroll._scrollSelectedPosition(c,f.getActiveCell(c)):a.scroll(a.value()+parseInt(o.parent()[0].style.height),!0)):o.offset().top-e._frozenHeight<=h.offset().top&&(u.keyCode==38||u.keyCode==13&&u.shiftKey)&&!v&&(a._scrollData.step=-1,o.parent().index()>0?a.scroll(a.value()-parseInt(o.parent()[0].style.height),!0):a.scroll(0)),h[0].offsetWidth<=o.offset().left+o[0].offsetWidth&&(u.keyCode==39||u.keyCode==9&&!u.shiftKey)&&!v?(l._scrollData.step=1,u.ctrlKey&&u.keyCode==39?f.XLScroll._scrollSelectedPosition(c,f.getActiveCell(c)):l.scroll(l.value()+o[0].offsetWidth,!0)):o.offset().left-e._frozenWidth<=h.offset().left&&(u.keyCode==37||u.keyCode==9&&u.shiftKey)&&!v&&(l._scrollData.step=-1,o.get(0).cellIndex>0?l.scroll(l.value()-o[0].offsetWidth,!0):l.scroll(0)));p=y.find("col");var d=n(f.getRows(c)[1]),b=e._startCell.rowIndex,k=e._startCell.colIndex;s=f.getCell(b,k);s.length>0&&((h[0].offsetWidth>=s.offset().left||h.offset().left+h[0].offsetWidth>=s.offset().left+s[0].offsetWidth)&&(u.keyCode==39||u.keyCode==9&&!u.shiftKey)&&(f.XLSelection.selectRange(e._startCell,e._startCell),f.model.showRibbon&&f.XLRibbon._updateRibbonIcons(),f.XLDragFill.positionAutoFillElement()),!p.eq(k).hasClass("e-fc-hide")&&(u.keyCode==37||u.keyCode==9&&u.shiftKey)&&(f.XLSelection.selectRange(e._startCell,e._startCell),f.model.showRibbon&&f.XLRibbon._updateRibbonIcons(),f.XLDragFill.positionAutoFillElement()),!d.eq(b).hasClass("e-fr-hide")&&(u.keyCode==38||u.keyCode==13&&u.shiftKey)&&(f.XLSelection.selectRange(e._startCell,e._startCell),f.model.showRibbon&&f.XLRibbon._updateRibbonIcons(),f.XLDragFill.positionAutoFillElement()),(h.offset().top+h[0].offsetHeight>=s.offset().top||h.offset().top+h[0].offsetHeight>=s.offset().top+s[0].offsetHeight)&&(u.keyCode==40||u.keyCode==13&&!u.shiftKey)&&(f.XLSelection.selectRange(e._startCell,e._startCell),f.model.showRibbon&&f.XLRibbon._updateRibbonIcons(),f.XLDragFill.positionAutoFillElement()));w&&(u.keyCode===37||u.shiftKey&&u.keyCode===9?r=e._startCell.colIndex:u.keyCode===38||u.shiftKey&&u.keyCode===13?i=e._startCell.rowIndex:u.keyCode===39||u.keyCode===9?r=e._endCell.colIndex:(u.keyCode===40||u.keyCode===13)&&(i=e._endCell.rowIndex),e._activeCell={rowIndex:i,colIndex:r})}},_navigateRange:function(n){var h=this.XLObj,s=h.getSheet(h.getActiveSheetIndex()),i=s._startCell,r=s._endCell,t=s._activeCell,u=i.rowIndex<r.rowIndex?i.rowIndex:r.rowIndex,f=i.rowIndex>r.rowIndex?i.rowIndex:r.rowIndex,e=i.colIndex<r.colIndex?i.colIndex:r.colIndex,o=i.colIndex>r.colIndex?i.colIndex:r.colIndex;if(n=="Tab")if(t.colIndex<o)this._navigateRow("Forward");else if(t.rowIndex<f)this._updateActiveCell(t.rowIndex+1,e);else if(t.rowIndex==f&&t.colIndex==o)this._updateActiveCell(u,e);else return!1;else if(n=="Enter")if(t.rowIndex<f)this._navigateCol("Forward");else if(t.colIndex<o)this._updateActiveCell(u,t.colIndex+1);else if(t.rowIndex==f&&t.colIndex==o)this._updateActiveCell(u,e);else return!1;else if(n=="ShiftTab")if(t.colIndex>e)this._navigateRow("Backward");else if(t.rowIndex>u)this._updateActiveCell(t.rowIndex-1,o);else if(t.rowIndex==u&&t.colIndex==e)this._updateActiveCell(f,o);else return!1;else if(t.rowIndex>u)this._navigateCol("Backward");else if(t.colIndex>e)this._updateActiveCell(f,t.colIndex-1);else if(t.rowIndex==u&&t.colIndex==e)this._updateActiveCell(f,o);else return!1},_navigateRow:function(n){var t=this.XLObj,i=t.getSheet(t.getActiveSheetIndex())._activeCell;this._updateActiveCell(i.rowIndex,i.colIndex+(n=="Forward"?1:-1))},_navigateCol:function(n){var t=this.XLObj,i=t.getSheet(t.getActiveSheetIndex())._activeCell;this._updateActiveCell(i.rowIndex+(n=="Forward"?1:-1),i.colIndex)},_updateActiveCell:function(n,t){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),u=r._activeCell;i.getCell(u.rowIndex,u.colIndex).removeClass("e-activecell");r._activeCell={rowIndex:n,colIndex:t};i.getCell(r._activeCell.rowIndex,r._activeCell.colIndex).addClass("e-activecell");i.updateFormulaBar();i.setSheetFocus()},_isValidParameter:function(n){var t=n.indexOf("(");return t>-1?(n=n.split("("),n[1].length>0):!0}}}(jQuery,Syncfusion),function(n,t,i){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellFormatting=function(n){this.XLObj=n;this._formatEnable=!1;this._thousandSeparator=Globalize.culture(this.XLObj.model.locale).numberFormat[","];this._formatAsTableStyle={};this._rowLength=null;this._colLength=null;this._getFormat=null;this._getDataFormat=null;this._getEformatClass=null;this._borderPosition=["top","right","bottom","left"];this._cellObj=null};t.spreadsheetFeatures.cellFormatting.prototype={format:function(i,r){var a;if(this.XLObj.model.allowCellFormatting){var u,o,v,y,e,f=this.XLObj,l={},p=0,k=[],d="style",h={reqType:"cell-format"},s=f.getActiveSheetIndex(),w=f._rAlign,c=f._dataContainer,g="format",b=f._getAlphaRangeCells(r),nt=b.length;if(!f._trigger("beforeCellFormat",{sheetIndex:s,format:i,cells:b})&&nt>0){if(i=this._getFormatObj(i),d in i||g in i){for(h.beforeFormat=this.getHashCodeClassAsArray();p<nt;)o=b[p],v=n(o),u={rowIndex:o.parentNode.rowIndex,colIndex:o.cellIndex,beforeFormat:{},afterFormat:{},bRowHeight:f.XLResize.getRowHeight(o.parentNode.rowIndex)},l=t.isNullOrUndefined(c.sheets[s][u.rowIndex])?{}:t.isNullOrUndefined(c.sheets[s][u.rowIndex][u.colIndex])?{}:c.sheets[s][u.rowIndex][u.colIndex],n.extend(!0,u.beforeFormat,l),d in i&&(u.prevClass=o.className,y=this._getExtendedClass(o.className,i.style),this._updateFormatClass(o,y),u.className=y,"font-size"in i.style&&(a=f.XLResize._getContentHeight(u.rowIndex,[o]),f.setHeightToRows([{rowIndex:u.rowIndex,height:a>20?a:20}]),f.getSheet(s).rowsHeightCollection[u.rowIndex]=a,f.XLSelection._refreshBorder())),g in i&&i.type&&(e=f.XLEdit.getPropertyValue(u.rowIndex,u.colIndex),e=t.isNullOrUndefined(e)?"":e,this._cellObj={value:e,type:i.type,formatStr:i.format.formatStr,decimalPlaces:i.format.decimalPlaces,thousandSeparator:i.format["thousandSeparator"]?!0:!1},["text","general"].indexOf(this._cellObj.type)!==-1?(f._isDateTime(e)&&(e=f._dateToInt(e),this._cellObj.value=e),this._cellObj.type===t.Spreadsheet.CellType.Text?v.removeClass(w):f.isNumber(e)&&o.className.indexOf(w)===-1&&v.addClass(w)):e=this._format(e,{formatStr:this._cellObj.formatStr,type:this._cellObj.type,thousandSeparator:this._cellObj.thousandSeparator,decimalPlaces:this._cellObj.decimalPlaces,cellObj:this._cellObj}),this._cellObj.value2=e+"",f.XLEdit._updateDataContainer(o,this._cellObj),u.beforeFormat.Oprtype=this._cellObj.type,this._cellObj=null),l=t.isNullOrUndefined(c.sheets[s][u.rowIndex])?{}:t.isNullOrUndefined(c.sheets[s][u.rowIndex][u.colIndex])?{}:c.sheets[s][u.rowIndex][u.colIndex],u.afterFormat=n.extend(!0,{},l),u.afterFormat.Oprtype=u.beforeFormat.Oprtype,u.aRowHeight=f.XLResize.getRowHeight(o.parentNode.rowIndex),k.push(u),p++;h.selCell=k;h.afterFormat=this.getHashCodeClassAsArray();h.range=f.model.sheets[f.getActiveSheetIndex()].selectedRange;h.sheetIndex=f.getActiveSheetIndex()}"border"in i?this.applyBorder(i.border,r,h):f.model.sheets[s]._importRendered||f._isUndoRedo||this._formatEnable||f._isHLink||f._isSort||f._completeAction(h)}}},_format:function(n,i){var u=this.XLObj,e=i.formatStr,r=u.isUndefined(n)?"":n,s=i.type||"",f=t.Spreadsheet.CellType,o=u.model.locale,h=["."].indexOf(this._thousandSeparator)>-1?"\\":"",c=new RegExp(h+this._thousandSeparator,"g");n=r.toString();switch(s){case f.Accounting:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toAccounting(e,r,o));break;case f.Currency:case f.Number:case f.Percentage:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.formatting(e,r,o),!i.thousandSeparator&&[f.Number,f.Percentage].indexOf(s)>-1&&this._thousandSeparator&&(r=r.replace(c,"")));break;case f.Scientific:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toExponential(r,i.decimalPlaces));break;case f.Fraction:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toFraction(r),r="numerator"in r?r.integer+" "+r.numerator+"/"+r.denominator:r.integer);break;case f.LongDate:case f.ShortDate:case f.Date:case f.Time:case f.DateTime:u.isNumber(r)?(r=u.intToDate(r),this._cellObj&&(this._cellObj.value=r)):u._isDateTime(r)||(r=Globalize.parseDate(r));u._isDateTime(r)&&(r=u.formatting(e,r,o))}return t.isNullOrUndefined(r)?n:r},createTable:function(t,i){if(this.XLObj.model.allowFormatAsTable){var o,v,u,y,e,r=this.XLObj,a={format:t.format},s=r.getActiveSheetIndex(),f=r.getSheet(s),l=t.name||"",p=f._tableManager,h=f._startCell,c=f._endCell,w="formatName",b={sheetIndex:s,tableStyle:t,reqType:"format-table"};r._trigActionBegin(b)||(t=b.tableStyle,r._isFAT=!0,u=r._isUndoRedo?n.extend(!0,[],i):i?r.getRangeIndices(i):r.swapRange([h.rowIndex,h.colIndex,c.rowIndex,c.colIndex]),y=r.getCell(u[0],u[1])[0].className,f._importRendered||(o={sheetIndex:r.getActiveSheetIndex(),reqType:"format-table",beforeFormat:this.getHashCodeClassAsArray(),beforeRange:n.extend(!0,[],u)},o.beforeRangeData=t.header?r.getRangeData([u[0],u[1],u[2],u[3]]):r.getRangeData([u[0],u[1],u[2]+1,u[3]])),w in t&&(a[w]=t.formatName),y.indexOf("e-table")===-1?(e=r._isUndoRedo||r.XLClipboard._isCut?parseInt(l.replace("Table","")):f._importRendered?this._getTableIdxFromName(t.name):r.getObjectLength(p),l=l.length?l:"Table "+e,r.model.sheets[s]._header[e]={header:t.header},t.header?i?(i=r._isUndoRedo?i:r.getRangeIndices(i),f._startCell={rowIndex:i[0],colIndex:i[1]},f._endCell={rowIndex:i[2],colIndex:i[3]},r.XLSelection.selectRange(f._startCell,f._endCell),f._importRendered||r.XLDragFill.positionAutoFillElement()):i=r.swapRange([h.rowIndex,h.colIndex,c.rowIndex,c.colIndex]):(r._isUndoRedo?u=n.extend(!0,[],i):(u=i?r.getRangeIndices(i):r.swapRange([h.rowIndex,h.colIndex,c.rowIndex,c.colIndex]),i=u),r.XLDragDrap.moveRangeTo(u,[u[0]+1,u[1],u[2]+1,u[3]]),f._startCell={rowIndex:u[0],colIndex:u[1]},f._endCell={rowIndex:u[2]+1,colIndex:u[3]},r.XLSelection.selectRange(f._startCell,f._endCell),f._importRendered||r.XLDragFill.positionAutoFillElement(),u[2]=u[2]+1),"dataSource"in t&&r.updateRange(s,{showHeader:"showHeader"in t?t.showHeader:!0,startCell:r._getAlphaRange(s,i[0],i[1],i[0],i[1]),dataSource:t.dataSource}),v=r.getRange(i[0],i[1],i[2],i[3]),v.addClass("e-table"+e),f._importRendered||(p[e]={name:l,range:u}),r.XLRibbon._isDesignTab=!0,this._createTable(e,a),f._importRendered||r.XLRibbon._designTabUpdate(e,v[0]),r.XLFilter._filterTable(s,e)):(this._formatAsTableStyle=a,this._createTable(r._getTableID(y),a),r._undoCollection.pop(),r._undoCollection.pop()),r._isFAT=!1,f._importRendered||(o.tableID=e,o.tableStyle=t,o.afterRange=u,r._isPaste||r._isUndoRedo||r._completeAction(o)),r.XLSelection._refreshBorder())}},_createTable:function(t,r){var f,w,h,o,s,a,c,y,k=0,e=this.XLObj,l=r.format,p="border",v=e.getActiveSheetIndex(),d=e.getSheet(v),b=e.getSheet(v)._tableManager,u=b[t].range;for(b[t].format=l,!d._importRendered&&r.formatName&&(b[t].formatName=r.formatName),h=e.getRange(u[0]-1,u[1]-1,u[2],u[3]),f=h.length;f--;)o=h[f],n(o).removeClass(this.getFormatClass(o.className,!0));if("contentLayout"in l)for(f=u[0]+1,y=l.contentLayout.length;f<=u[2];){if(s=n.extend(!0,{},l.contentLayout[k%y]),p in s&&(a=e._getProperAlphaRange(v,f,u[1],f,u[3]),c=s.border,delete s[p]),e.getObjectLength(s))for(h=e.getRange(f,u[1],f,u[3]),h.hasClass("e-table"+t)||h.addClass("e-table"+t),w=h.length;w--;)o=h[w],e.XLEdit.getPropertyValue(o.parentNode.rowIndex,o.cellIndex,"hyperlink")&&delete s.color,this._updateFormatClass(o,this._getExtendedClass(o.className,s));c&&(c.tableID=t,this.applyBorder(c,a),c=i);k++;f++}for(f=0,s=i,h=e.getRange(u[0],u[1],u[0],u[3]),("headerLayout"in l)&&(s=n.extend(!0,{},l.headerLayout),p in l.headerLayout&&(a=e._getProperAlphaRange(v,u[0],u[1],u[0],u[3]),c=s.border,delete s[p])),y=h.length;f<y;)o=h[f],o.innerHTML.length||e.XLEdit.updateCell(n(o),"Column "+(f+1)),e.getObjectLength(s)&&this._updateFormatClass(o,this._getExtendedClass(o.className,s)),f++;c&&(c.tableID=t,this.applyBorder(c,a),c=i);"contentBorder"in l&&(l.contentBorder.border.tableID=t,a=e._getProperAlphaRange(v,u[0]+1,u[1],u[2],u[3]),this.applyBorder(l.contentBorder.border,a));n("#"+e._id+"_Ribbon_tsofiltercolumn").ejCheckBox("option",{checked:!0})},removeTable:function(t){var r,i=this.XLObj,u=i.getActiveSheetIndex(),f=i.getSheet(u)._tableManager;t in f&&(r="e-table"+t,i.element.find("."+r).removeClass(r),i._isFATResize||i.XLFilter._clearFilterTable(u,t),delete f[t],delete i.model.sheets[u]._header[t],n("#"+i._id+"_Ribbon_tsofiltercolumn").ejCheckBox("option",{checked:!1}),i.XLRibbon._toggleDesignTab())},_getTableLayoutFromName:function(t){if(t)for(var i,r=n("#"+this.XLObj._id+"_formatastable").find(".e-formatastablecell"),u=r.length-1;u--;)if(i=n(r[u]).data(),i.formatName===t)return i},_getTableIdxFromName:function(n){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex())._tableManager,t=i.getObjectLength(r);if(t)while(t--)if(r[t].name===n)return t;return-1},customFormatParser:function(n){var i,f,e,h={},s=t.Spreadsheet.CellType,r="{0:",u="}",c="N",a="P",o=".",l="0";return n=t.isNullOrUndefined(n)?"":n.toString(),Number(n)===0?(n.indexOf(o)>-1?(e=n.split(o),i=r+c+e[1].length+u):i=r+"D"+n.length+u,f=s.Number):!n.indexOf("#")&&n.indexOf(",")>-1&&n.lastIndexOf(l)===n.length-1?(n.indexOf(o)>-1?(e=n.split(o),i=r+c+e[1].length+u):i=r+c+l+u,h.thousandSeparator=!0,f=s.Number):n.lastIndexOf("%")===n.length-1&&Number(n.replace(/%/g,""))===0?(n.indexOf(o)>-1?(e=n.split(o),i=r+a+--e[1].length+u):i=r+a+l+u,f=s.Percentage):/^[dMy/-]+$/.test(n)?(i=r+n+u,f=s.Date):/^[hmst:\s]+$/.test(n)&&(i=r+n+u,f=s.Time),i&&(h.formatStr=i,h.type=f),h},applyBorder:function(i,r,u){if(this.XLObj.model.formatSettings.allowCellBorder&&(this.XLObj.getObjectLength(i)||n.type(i)==="string")){var f=this.XLObj,o=f.getActiveSheetIndex(),e=f.getSheet(o),s=e._startCell,h=e._endCell;r=r?f.getRangeIndices(r):f.swapRange([s.rowIndex,s.colIndex,h.rowIndex,h.colIndex]);e._importRendered||(u||(u={sheetIndex:o,reqType:"cell-format",process:"border"}),u.range=r,u.beforeFormat=this.getHashCodeClassAsArray(r));f.getObjectLength(i)?this._applyBorderCss(i,r,u):i==="noborder"?this.clearFormat(r,"border"):this._applyAllBorderCss(i,r,u);e._importRendered||f._isUndoRedo||t.isNullOrUndefined(i.tableID)&&!this._formatEnable&&(u.afterFormat=this.getHashCodeClassAsArray(r),f._completeAction(u))}},updateDecimalPlaces:function(i,r){if(this.XLObj.model.formatSettings.allowDecimalPlaces){var h,e,s,y,u,p,a=0,f={},v={},o=this.XLObj,c=o.getActiveSheetIndex(),l=o._dataContainer,w={action:"decimal",reqType:"cell-format",sheetIndex:c},b=[];if(r=o._getAlphaRangeCells(r),y=r.length,y)while(a<y)e=r[a].parentNode.rowIndex,s=r[a].cellIndex,u=o.getRangeData([e,s,e,s])[0],h={rowIndex:e,colIndex:s,afterFormat:{},beforeFormat:{}},v=t.isNullOrUndefined(l.sheets[c][e])?{}:t.isNullOrUndefined(l.sheets[c][e][s])?{}:l.sheets[c][e][s],n.extend(!0,h.beforeFormat,v),o.isNumber(u.value)&&(o.isUndefined(u.decimalPlaces)&&(u.decimalPlaces=0),f.type=u.type===t.Spreadsheet.CellType.General?t.Spreadsheet.CellType.Number:u.type,f.decimalPlaces=u.decimalPlaces=i==="decrement"?u.decimalPlaces>0?u.decimalPlaces-1:0:u.decimalPlaces+1,f.formatStr=this._getFormatString(f.type,f.decimalPlaces),p=this._format(u.value,{formatStr:f.formatStr,type:f.type,thousandSeparator:u.thousandSeparator,decimalPlaces:f.decimalPlaces}),f.value2=p,o.XLEdit._updateDataContainer(r[a],f),h.beforeFormat.Oprtype=f.type),v=t.isNullOrUndefined(l.sheets[c][e])?{}:t.isNullOrUndefined(l.sheets[c][e][s])?{}:l.sheets[c][e][s],n.extend(!0,h.afterFormat,v),h.afterFormat.Oprtype=h.beforeFormat.Oprtype,b.push(h),a++;w.selCell=b;o._isUndoRedo||o._completeAction(w)}},getFormatClass:function(n,t){var i=t?"e-border":"e-format",r=new RegExp("\\b"+i+".*?\\b","g");return n.indexOf(i)!==-1?n.match(r)[0]:""},getHashCodeClassAsArray:function(n){var t=0,r={format:[]},i=this.XLObj,e=["topborder","leftborder"],u,f,o;for(n=n?i.swapRange(n):i.getSheet(i.getActiveSheetIndex()).selectedRange,f=i.getRange(n[0],n[1],n[2],n[3]),o=f.length;t<o;)u=f[t].className,r.format.push(this.getFormatClass(u)+" "+this.getFormatClass(u,!0)),t++;for(t=2;t--;)r[e[t]]=this._getBorderArray(n,e[t]);return r},_getBorderArray:function(n,t){var i,r=0,u=[],o=this.XLObj,f="topborder",s=t===f?n[0]-1:n[1]-1,e;if(s>=0)for(e=t===f?o.getRange(n[0]-1,n[1],n[0]-1,n[3]):o.getRange(n[0],n[1]-1,n[2],n[1]-1),i=e.length;r<i;)u.push(this.getFormatClass(e[r].className,!0)),r++;else for(i=t===f?n[3]-n[1]+1:n[2]-n[0]+1;i--;)u.push("");return u},clearFormat:function(t,i){var r,e,o,s,u=this.XLObj,h=[],y=["topborder","leftborder"],l="format",a="border",v=!i||i===l,c=!i||i===a,f;for(t=t?u.swapRange(t):u.getSheet(u.getActiveSheetIndex()).selectedRange,f=u.getRange(t[0],t[1],t[2],t[3]),r=f.length;r--;)o=f[r],e=n(o),s=o.className,v&&e.removeClass(this.getFormatClass(s)),c&&e.removeClass(this.getFormatClass(s,!0));if(v&&h.push(l),c&&h.push(a),u.clearRangeData(null,h,f),c)for(r=2;r--;)this._clearBorderClass(t,y[r])},_clearBorderClass:function(t,i){var s,h,f,r,u,o,e=this.XLObj,c="topborder",l=i===c?t[0]-1:t[1]-1;if(l>=0)for(h=i===c?e.getRange(t[0]-1,t[1],t[0]-1,t[3]):e.getRange(t[0],t[1]-1,t[2],t[1]-1),s=h.length;s--;)f=h[s],o=this.getFormatClass(f.className,!0),o.length&&(u=o.split("S"),r=this._getBorderFromHashCode(u[1]),"border"in r&&(delete r.border[i===c?"bottom":"right"],u[1]=this._getBorderHashCode(r.border),!e.getObjectLength(r.border)&&delete r.border),n.extend(!0,r,this._getBorderFromHashCode(u[0].replace("e-border",""))),e.getObjectLength(r)?this._updateFormatClass(f,this._createFormatClass(r,u[0]+u[1]),!0):(n(f).removeClass(o),e.clearRangeData(null,["border"],[f])))},updateFormat:function(n,t){var i,f=["topborder","leftborder"],r=this.XLObj,u,e;for(t=t?r.swapRange(t):r.getSheet(r.getActiveSheetIndex()).selectedRange,u=r.getRange(t[0],t[1],t[2],t[3]),e=n.format,i=u.length;i--;)this._updateHashCodeClass(u[i],e[i]);for(i=2;i--;)this._updateBorderClass(t,n[f[i]],f[i])},_updateBorderClass:function(n,t,i){var r,u,f=this.XLObj,e="topborder",o=i===e?n[0]-1:n[1]-1;if(o>=0)for(u=i===e?f.getRange(n[0]-1,n[1],n[0]-1,n[3]):f.getRange(n[0],n[1]-1,n[2],n[1]-1),r=u.length;r--;)this._updateFormatClass(u[r],t[r],!0)},updateUniqueFormat:function(n,t){for(var r=this.XLObj._getArrayRangeCells(t),i=r.length+1;i=i-1;)this._updateFormatClass(r[i-1],n)},_hasFormat:function(n){return n?!t.isNullOrUndefined(n.match(/e-format|e-border/)):!1},getFormatHashCode:function(n){var i="";return i="background-color"in n?n["background-color"].replace("#",""):"6N",i="color"in n?i+n.color.replace("#",""):i+"6N",i="font-family"in n?t.isNullOrUndefined(this._getStyleCode("FontFamily",n["font-family"]))?i+"2N":i+this._getStyleCode("FontFamily",n["font-family"]):i+"2N",i="font-size"in n?i+this._getFontCode(n["font-size"]):i+"2N",i="font-style"in n?t.isNullOrUndefined(this._getStyleCode("FontStyle",n["font-style"]))?i+"1N":i+this._getStyleCode("FontStyle",n["font-style"]):i+"1N",i="text-decoration"in n?t.isNullOrUndefined(this._getStyleCode("TextDecoration",n["text-decoration"]))?i+"1N":i+this._getStyleCode("TextDecoration",n["text-decoration"]):i+"1N",i="vertical-align"in n?t.isNullOrUndefined(this._getStyleCode("VerticalAlign",n["vertical-align"]))?i+"1N":i+this._getStyleCode("VerticalAlign",n["vertical-align"]):i+"1N",i="text-align"in n?t.isNullOrUndefined(this._getStyleCode("TextAlign",n["text-align"]))?i+"1N":i+this._getStyleCode("TextAlign",n["text-align"]):i+"1N",i="text-indent"in n?i+this._getFontCode(n["text-indent"]):i+"2N",i="font-weight"in n?t.isNullOrUndefined(this._getStyleCode("FontWeight",n["font-weight"]))?i+"1N":i+this._getStyleCode("FontWeight",n["font-weight"]):i+"1N","e-format"+i},getFormatFromHashCode:function(n){var r={},i,t=0,u="e-format";return n=n||"",n.indexOf(u)||(i=n.replace(u,"").split("N"),i[t].length===1?t=t+1:(r["background-color"]="#"+i[t].slice(0,6),i[t]=i[t].substr(6)),i[t].length===1?t=t+1:(r.color="#"+i[t].slice(0,6),i[t]=i[t].substr(6)),i[t].length===1?t=t+1:i[t].length===2?(r["font-family"]=this._getCodeStyle("FontFamily",i[t].slice(0,1)+"1N"),t=t+1):(r["font-family"]=this._getCodeStyle("FontFamily",i[t].slice(0,2)),i[t]=i[t].substr(2)),i[t].length===1?t=t+1:i[t].length===2?(r["font-size"]=i[t].slice(0,1)+"px",t=t+1):(r["font-size"]=i[t].slice(0,2)+"px",i[t]=i[t].substr(2)),i[t].length===1?t=t+1:(r["font-style"]=this._getCodeStyle("FontStyle",i[t].slice(0,1)),i[t]=i[t].substr(1)),i[t].length===1?t=t+1:(r["text-decoration"]=this._getCodeStyle("TextDecoration",i[t].slice(0,1)),i[t]=i[t].substr(1)),i[t].length===1?t=t+1:(r["vertical-align"]=this._getCodeStyle("VerticalAlign",i[t].slice(0,1)),i[t]=i[t].substr(1)),i[t].length===1?t=t+1:(r["text-align"]=this._getCodeStyle("TextAlign",i[t].slice(0,1)),i[t]=i[t].substr(1)),i[t].length===1?t=t+1:i[t].length===2?(r["text-indent"]=i[t].slice(0,1)+"px",t=t+1):(r["text-indent"]=i[t].slice(0,2)+"px",i[t]=i[t].substr(2)),i[t]==="2"&&(r["font-weight"]="bold")),r},getBorderFromHashCode:function(n,t){var i={};return n=n||"",n.indexOf("e-border")||(n=n.replace("e-border","").split("S")[t?1:0],i=this._getBorderFromHashCode(n)),i},_getBorderFromHashCode:function(n){var i,t=0,r={};return n=n||"",n.length>12&&(i=n.split("N"),r={border:{}},i[t].length>1?(r.border.right=this._concatBorderCode(i[t]),i[t]=i[t].substr(8)):t=t+3,i[t].length>1&&(r.border.bottom=this._concatBorderCode(i[t]))),r},_formatPainter:function(){var r=this.XLObj,o=r.getActiveSheetIndex(),i,u,s=0,n=r.getSheet(o)._startCell,t=r.getSheet(o)._endCell,f,e;for(this._rowLength=t.rowIndex-n.rowIndex+1,this._colLength=t.colIndex-n.colIndex+1,f=this._rowLength,e=this._colLength,this._getFormat=this.getHashCodeClassAsArray([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]),this._getDataFormat=r.getRangeData([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex],null,["value","value2","type","formatStr","thousandSeparator","decimalPlaces"]),this._getEformatClass=new Array(f),i=0;i<f;i++)for(this._getEformatClass[i]=new Array(e),u=0;u<e;u++)this._getEformatClass[i][u]=this._getFormat.format[s],s++},_fPMouseUp:function(){for(var v,u=this.XLObj,h=u.getActiveSheetIndex(),rt=u._getContent(h),b=0,k=0,d=0,ut,g=u.model.sheets[h]._selectedCells,o=g[0],y=g[g.length-1],c,i=0,nt=0,e=0,l,p,ft,r=u._getArrayRangeCells([o.rowIndex,o.colIndex,y.rowIndex,y.colIndex]),a=u.XLSelection._getSelectedRange(o,y),ot=y.rowIndex-o.rowIndex,st=y.colIndex-o.colIndex,tt=new Array(a.length),lt=this._getDataFormat.length,ht={sheetIndex:h,reqType:"format-painter"},w=[],s,ct=u._formatRegx,it=u._borderRegx,f=0,et=a.length;f<et;f++)tt[f]=u._generateHeaderText(h,a[f].colIndex+1)+(a[f].rowIndex+1)+":"+u._generateHeaderText(h,a[f].colIndex+1)+(a[f].rowIndex+1);for(f=0;f<=ot;f++){for(nt++,c=0;c<=st;c++){if(b++,s={rowIndex:n(r[i]).parent().index(),colIndex:r[i].cellIndex},s.bVal=n(r[i]).text(),n.extend(!0,s.bData,n(r[i]).data()),s.bFormat=r[i].className.indexOf("e-format")!==-1?r[i].className.match(ct)[0]:"",s.bBorder=r[i].className.indexOf("e-border")!==-1?r[i].className.match(it)[0]:"",this._updateFormatClass(r[i],this._getEformatClass[f][c]),v={type:this._getDataFormat[e].type?this._getDataFormat[e].type:"general"},this._getDataFormat[e].formatStr&&(v.formatStr=this._getDataFormat[e].formatStr),this._getDataFormat[e].decimalPlaces&&(v.decimalPlaces=this._getDataFormat[e].decimalPlaces),this._getDataFormat[e].thousandSeparator&&(v.thousandSeparator=this._getDataFormat[e].thousandSeparator),this.format(v,tt[i]),u.XLEdit.updateCell(r.eq(i),r.eq(i).text()),t.isNullOrUndefined(this._getDataFormat[e].cFormatRule)||(ut=this._getDataFormat[e].cFormatRule[0],p=ut.split("_"),ft=p[5],p[p.indexOf(ft)]=tt[i],u._dataContainer.cFormatRule=p.join("_"),l=u._dataContainer.cFormatRule.split("_"),u.XLCFormat._cFormat(l[0],l[2],l[3],l[4],l[5])),e===lt-1&&(e=-1),s.aVal=n(r[i]).text(),s.aData=n(r[i]).data(),s.aFormat=r[i].className.indexOf("e-format")!==-1?r[i].className.match(ct)[0]:"",s.aBorder=r[i].className.indexOf("e-border")!==-1?r[i].className.match(it)[0]:"",w.push(s),e++,i++,f===0&&(o.rowIndex>0&&this._updateFormatClass(u.getCell(o.rowIndex-1,o.colIndex+(b-1),h)[0],this._getFormat.topborder[k]),k++,this._getFormat.topborder.length===k&&(k=0)),c===0&&(o.colIndex>0&&this._updateFormatClass(u.getCell(o.rowIndex+(nt-1),o.colIndex-1,h)[0],this._getFormat.leftborder[d]),d++,this._getFormat.topborder.length===d&&(d=0)),b===st+1){b=0;break}this._colLength===c+1&&(c=-1)}if(nt===ot+1)break;this._rowLength===f+1&&(f=-1)}r=u.getCell(w[f].rowIndex,w[f].colIndex)[0];w[f].aBorder=r.className.indexOf("e-border")!==-1?r.className.match(it)[0]:"";this._formatEnable=!1;rt.addClass("e-ss-cursor");rt.removeClass("e-ss-fpcursor");n("#"+u._id+"_Ribbon_formatpainter").ejToggleButton("option",{toggleState:!1});ht.selCells=w;u._isUndoRedo||u._completeAction(ht)},_getFormatObj:function(n){if("type"in n||"formatStr"in n){var t={},i="thousandSeparator";t.formatStr="formatStr"in n?n.formatStr:this._getFormatString(n.type,n.decimalPlaces);t.decimalPlaces="decimalPlaces"in n?n.decimalPlaces:["currency","accounting","number"].indexOf(n.type)!==-1?parseInt(t.formatStr.replace(/{0:|[A-Z]|}/g,"")):0;i in n?t[i]=n[i]:n.type==="number"&&(t[i]=!0);n.format=t}return"style"in n&&n.style.border&&(n.border=n.style.border,delete n.style.border,this.XLObj.getObjectLength(n.style)||delete n.style),n},_getFormatString:function(n,i){var r=t.Spreadsheet.CellFormat[n];return this.XLObj.isNumber(i)&&!t.isNullOrUndefined(r)&&(r="{0:"+r.substr(3,1)+i+"}"),r||""},_createFormatClass:function(n,t){var i=this.XLObj._dataContainer.hashCode,r;return(t=t?t:this.getFormatHashCode(n),i.indexOf(t)!==-1)?t:(r=this._getCssPropertyAsString(n),this._writeCssRules(t,r),i.push(t),t)},_writeCssRules:function(n,t){var i=document.getElementById(this.XLObj._id+"_sscustomformat"),r=".e-spreadsheet ."+n+" {"+t+"}";i.styleSheet?i.styleSheet.cssText+=r:i.appendChild(document.createTextNode(r))},_getCssPropertyAsString:function(n){var t="",i,r,u;if("border"in n){i=n.border;for(r in i)n["border-"+r]=i[r];delete n.border}for(u in n)t=t+(u+":"+n[u]+";");return t},_splitBorderCode:function(n){return n=n.split(" "),n[0].replace("px","")+this._getStyleCode("BorderStyle",n[1])+n[2].replace("#","")},_concatBorderCode:function(n){return n.substr(0,1)+"px "+this._getCodeStyle("BorderStyle",n.substr(1,1))+" #"+n.substr(2,6)},_getCodeStyle:function(n,i){n=t.Spreadsheet[n];for(var r in n)if(n.hasOwnProperty(r)&&n[r]===i)return r},_getStyleCode:function(n,i){return i=i||"",t.Spreadsheet[n][i.toLowerCase()]},_getFontCode:function(n){var t=n.replace(/px|-|\+/g,"");return t.length===2?t:t.length===1?t+"1N":"2N"},_getExtendedClass:function(t,i){var r=this.getFormatFromHashCode(this.getFormatClass(t));return n.extend(!0,r,i),this._createFormatClass(r)},_updateHashCodeClass:function(i,r){var u,f,e=this.XLObj,o={},s=e._formatRegx,h=e._borderRegx;t.isNullOrUndefined(r)||(i.className=i.className.replace(s,"").replace(h,""),u=r.indexOf("e-format")>-1,f=r.indexOf("e-border")>-1,u&&(o.format=r.match(s)[0]),f&&(o.border=r.match(h)[0]),n(i).addClass(r),(u||f)&&e.XLEdit._updateDataContainer(i,o))},_updateFormatClass:function(n,t,i){var r,u,f=this.XLObj,e="e-format",o="e-border";t&&(t.indexOf(e)>-1||t.indexOf(o)>-1)&&(r=i?o:e,u=new RegExp("\\b"+r+".*?\\b","g"),n.className=n.className.replace(u,""),f.addClass(n,t),f.XLEdit._updateDataContainer(n,i?{border:t}:{format:t}))},_applyBorderCss:function(n,t){var i=this._borderPosition;i[0]in n&&t[0]-1>=0&&this._updateBorder([t[0]-1,t[1],t[0]-1,t[3]],this._parseBorder(i[2],n.top),!0);i[1]in n&&this._updateBorder([t[0],t[3],t[2],t[3]],this._parseBorder(i[1],n.right));i[2]in n&&this._updateBorder([t[2],t[1],t[2],t[3]],this._parseBorder(i[2],n.bottom));i[3]in n&&t[1]-1>=0&&this._updateBorder([t[0],t[1]-1,t[2],t[1]-1],this._parseBorder(i[1],n.left),!0)},_applyAllBorderCss:function(n,t){var i=this._borderPosition;this._updateBorder(t,this._parseBorder(i[1]+" "+i[2],n));t[0]-1>=0&&this._updateBorder([t[0]-1,t[1],t[0]-1,t[3]],this._parseBorder(i[2],n),!0);t[1]-1>=0&&this._updateBorder([t[0],t[1]-1,t[2],t[1]-1],this._parseBorder(i[1],n),!0)},_updateBorder:function(n,t,i){for(var e,r,u=0,f=this.XLObj,o=f.getRange(n[0],n[1],n[2],n[3]),s=o.length;u<s;)r=o[u],i&&(f.hasSpan(r.rowSpan)||f.hasSpan(r.colSpan))||(e=this._extendBorder(this.getFormatClass(r.className,!0),t,i),this._updateFormatClass(r,e,!0)),u++},_extendBorder:function(t,i,r){var u;return t=t.length?t.replace("e-border","").split("S"):"1N1N6N1N1N6NS1N1N6N1N1N6N".split("S"),r?(u=this._getBorderFromHashCode(t[1]),n.extend(!0,u,i),t[1]=this._getBorderHashCode(u.border),u=n.extend(!0,this._getBorderFromHashCode(t[0]),u)):(u=this._getBorderFromHashCode(t[0]),n.extend(!0,u,i),t[0]=this._getBorderHashCode(u.border),u=n.extend(!0,this._getBorderFromHashCode(t[1]),u)),this._createFormatClass(u,"e-border"+t[0]+"S"+t[1])},_getBorderHashCode:function(n){var t="";return t="right"in n?this._splitBorderCode(n.right):"1N1N6N",t+("bottom"in n?this._splitBorderCode(n.bottom):"1N1N6N")},_parseBorder:function(n,t){var i=0,r={border:{}};for(n=n.split(" ");i<n.length;)r.border[n[i]]=t,i++;return r}};t.Spreadsheet.FontFamily={calibri:"11N","times new roman":"21N",arial:"31N","courier new":"41N","segoe ui":"51N",tahoma:"61N",verdana:"71N",helvetica:"81N",georgia:"91N","comic sans ms":"10"};t.Spreadsheet.FontStyle={normal:"1",italic:"2",oblique:"3"};t.Spreadsheet.TextAlign={left:"1",right:"2",center:"3",justify:"4"};t.Spreadsheet.VerticalAlign={top:"1",middle:"2",bottom:"3"};t.Spreadsheet.TextDecoration={none:"1",underline:"2",overline:"3","line-through":"4","line-through underline":"5"};t.Spreadsheet.FontWeight={normal:"1",bold:"2"};t.Spreadsheet.BorderStyle={solid:"1",dashed:"2",dotted:"3"};t.Spreadsheet.CellFormat={number:"{0:N2}",currency:"{0:C2}",accounting:"{0:C2}",percentage:"{0:P2}",shortdate:"{0:MM/dd/yyyy}",longdate:"{0:dddd, MMMM dd, yyyy}",time:"{0:T}",scientific:"{0:N2}"}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cFormat=function(n){this.XLObj=n};t.spreadsheetFeatures.cFormat.prototype={getCFRule:function(n,t){var u=this.XLObj,f=u._dataContainer.sheets[u.getActiveSheetIndex()][n][t].cFormatRule,e=[],s=u._dataContainer.cFormatData,i,r,o;if(f)for(r=0,o=f.length;r<o;r++)i=s[f[r]].split("_"),e.push({action:i[0],input1:i[2],input2:i[3],color:i[4],addr:i[5],isApplied:JSON.parse(i[7])});return e},setCFRule:function(n){var t=this.XLObj;t.model.allowConditionalFormats&&this._cFormat(n.action,n.input1,n.input2,n.color,n.addr,t.getActiveSheetIndex())},_updateCFormatRule:function(n,t){return n.indexOf("true")>-1?n.replace("true",t):n.replace("false",t)},_getRuleIndex:function(n,i){if(t.isNullOrUndefined(i))return-1;for(var r=0,u=i.length;r<u;r++)if(i[r]===n)return r;return-1},_cFormat:function(n,t,i,r,u,f,e,o){var s=this.XLObj;if(s.model.allowConditionalFormats){s.element.ejWaitingPopup("show");f=f?f:s.getActiveSheetIndex();var h=s.getSheet(f),c=h.selectedRange,l={sheetIndex:f,reqType:"cond-format",action:"add",range:c};switch(n){case"greaterthan":this._applyGLEValues(">",t,r,n,u,f,e);break;case"greaterequalto":this._applyGLEValues(">=",t,r,n,u,f,e);break;case"lessthan":this._applyGLEValues("<",t,r,n,u,f,e);break;case"lessequalto":this._applyGLEValues("<=",t,r,n,u,f,e);break;case"equalto":this._applyGLEValues("==",t,r,n,u,f,e);break;case"notequalto":this._applyGLEValues("!=",t,r,n,u,f,e);break;case"between":this._applyBetweenValues("=",t,i,r,n,u,f,e);break;case"notbetween":this._applyBetweenValues("!",t,i,r,n,u,f,e);break;case"textcontains":this._applyContainsValues(t,r,n,u,f,e);break;case"dateoccur":this._applyDateContainsValues(t,r,n,u,f,e)}h._importRendered||s._isUndoRedo||o=="paste"||s._completeAction(l);s.element.ejWaitingPopup("hide")}},clearCF:function(i,r){var u=this.XLObj,o=u.getActiveSheetIndex(),c={sheetIndex:o,reqType:"cond-format",action:"clear",selection:i,rule:[]},f,l,s,h,e;if(u.model.allowConditionalFormats){for(s="",h=u._dataContainer.cFormatData,e=u.isUndefined(r)?i?u.element.find(".e-selected"):u.element.find(".e-rowcell"):u._getSelectedItems(o,r)[0],e.removeClass("e-redft e-yellowft e-greenft e-redf e-redt"),f=0,l=e.length;f<l;f++)t.isNullOrUndefined(u._dataContainer.sheets[o][n(e[f]).parent().index()])||t.isNullOrUndefined(u._dataContainer.sheets[o][n(e[f]).parent().index()][e[f].cellIndex])||t.isNullOrUndefined(u._dataContainer.sheets[o][n(e[f]).parent().index()][e[f].cellIndex].cFormatRule)||(c.rule.push(this.getCFRule(n(e[f]).parent().index(),e[f].cellIndex)),u.clearRangeData(null,["cFormatRule"],n(e[f])));s=i?"clear_"+o+"_"+u._getSelectedItems()[1]:"clear_"+o+"_entire";h.indexOf(s)===-1&&h.push(s);u._isUndoRedo||u._completeAction(c)}},_getValueForCFormat:function(n,t){var r=this.XLObj,f=n.parent().index(),e=n[0].cellIndex,o=r.getRangeData([f,e,f,e],!1,null,t),i=r.XLEdit.getPropertyValueByElem(n),u=r.XLEdit.getPropertyValueByElem(n,"value2");return i=i?i.toString():"",(u&&typeof u=="string"&&!o.formatStr&&i[0]==="="||r.XLEdit.getPropertyValueByElem(n,"type")==="datetime")&&(i=u),i},_applyGLEValues:function(i,r,u,f,e,o,s){var h=this.XLObj,c,v,y,b,l,k,d,g,p,w=new RegExp(/[^.0-9]+/g),tt=new RegExp(/[^.-a-zA-Z 0-9]+/g),a,nt;for(b=h._getSelectedItems(o,s,e),y=b[0],e=b[1],a=0,nt=y.length;a<nt;a++)if(v=t.isNullOrUndefined(y[a].rowIndex)?n(y[a]):h.getCell(y[a].rowIndex,y[a].colIndex),!v.hasClass("e-hidecell")){if(c=this._getValueForCFormat(v,o),p=h.XLEdit.getPropertyValueByElem(v,"type")?h.XLEdit.getPropertyValueByElem(v,"type"):"general",k=!0,g=-1,t.isNullOrUndefined(c)||!c.length)l=!1;else if(n.isNumeric(r))if(n.isNumeric(c))c=parseFloat(c),l=h.operators[i](c,parseFloat(r.replace(tt,""))),p==="percentage"&&(l=h.operators[i](c,0));else if(h._isValidDate(c))l=h.operators[i](h._dateToInt(c),parseFloat(r));else if(h._isValidTime(c))continue;else l=h.operators[i](c.toLowerCase(),r.toLowerCase());else r.lastIndexOf("%")===r.length-1&&n.isNumeric(r.replace(w,""))?l=p==="percentage"?h.operators[i](parseFloat(c),parseFloat(r.replace(w,""))):n.isNumeric(c)?h.operators[i](parseFloat(c),0):h.operators[i](c.length,0):r.indexOf("$")===0&&n.isNumeric(r.replace(w,""))?l=p==="accounting"||p!=="currency"||n.isNumeric(c)?h.operators[i](parseFloat(c),parseFloat(r.replace(w,""))):(h.operators[i](c.length,0)||h._isValidDate(c))&&!h._isValidTime(c):h._isValidDate(r)?h._isValidDate(c)?l=h.operators[i](h._dateToInt(new Date(c)),h._dateToInt(new Date(r))):h._isValidTime(c)||(l=n.isNumeric(c)?h.operators[i](parseFloat(c),h._dateToInt(r)):h.operators[i](c.length,h._dateToInt(r))):l=h._isValidTime(r)?h._isValidTime(c)?h.operators[i](h.parse.parseTime(c),h.parse.parseTime(r)):n.isNumeric(c)?h.operators[i](parseFloat(c),0):h.operators[i](c.length,0):h.operators[i](c.toLowerCase(),r.toLowerCase());d=f+"_"+i+"_"+r+"__"+u+"_"+e+"_"+h.getActiveSheetIndex();this._applyCFormatRule(v,d,g,l,k,u)}},_applyBetweenValues:function(i,r,u,f,e,o,s,h){var c=this.XLObj,l,w,b,k,a,g,nt,tt,y,v=new RegExp(/[^.0-9]+/g),d=new RegExp(/[^.-a-zA-Z 0-9]+/g),ut,p,it;for(k=c._getSelectedItems(s,h,o),b=k[0],o=k[1],c.operators["<"](r,u)||(k=u,u=r,r=k),p=0,it=b.length;p<it;p++)if(w=t.isNullOrUndefined(b[p].rowIndex)?n(b[p]):c.getCell(b[p].rowIndex,b[p].colIndex),!w.hasClass("e-hidecell")){if(l=this._getValueForCFormat(w,s),y=c.XLEdit.getPropertyValueByElem(w,"type")?c.XLEdit.getPropertyValueByElem(w,"type"):"general",g=!0,tt=-1,t.isNullOrUndefined(l)||!l.length)a=!1;else if(n.isNumeric(r.replace(d,""))&&n.isNumeric(u.replace(d,""))&&y!=="percentage"&&y!=="currency"&&y!=="accounting")if(r=r.replace(d,""),u=u.replace(d,""),n.isNumeric(l))a=c.operators[i](parseFloat(l)>=parseFloat(r)&&parseFloat(l)<=parseFloat(u));else if(c._isValidDate(l))a=c.operators[i](c._dateToInt(l)>=parseFloat(r)&&ut<=parseFloat(u));else if(c._isValidTime(l))continue;else a=c.operators[i](l.toLowerCase()>=r.toLowerCase()&&l.toLowerCase()<=u.toLowerCase());else if(r.lastIndexOf("%")===r.length-1&&n.isNumeric(r.replace(v,""))&&u.lastIndexOf("%")===u.length-1&&n.isNumeric(u.replace(v,"")))y==="percentage"&&(a=c.operators[i](parseFloat(l)>=parseFloat(r.replace(v,""))&&parseFloat(l)<=parseFloat(u.replace(v,""))));else if(r.indexOf("$")===0&&n.isNumeric(r.replace(v,""))&&u.indexOf("$")===0&&n.isNumeric(u.replace(v,"")))(y==="accounting"||y!=="currency")&&(a=c.operators[i](parseFloat(l)>=parseFloat(r.replace(v,""))&&parseFloat(l)<=parseFloat(u.replace(v,""))));else if(c._isValidDate(r)&&c._isValidDate(u)){var rt=c._dateToInt(new Date(l)),ft=c._dateToInt(new Date(r)),et=c._dateToInt(new Date(u));a=c.operators[i](rt>=ft&&rt<=et)}else c._isValidTime(r)&&c._isValidTime(u)?c._isValidTime(l)&&(a=c.operators[i](c.parse.parseTime(l)>=c.parse.parseTime(r)&&c.parse.parseTime(l)<=c.parse.parseTime(u))):a=c.operators[i](l.toLowerCase()>=r.toLowerCase()&&l.toLowerCase()<=u.toLowerCase());nt=e+"_"+i+"_"+r+"_"+u+"_"+f+"_"+o+"_"+c.getActiveSheetIndex();this._applyCFormatRule(w,nt,tt,a,g,f)}},_applyContainsValues:function(i,r,u,f,e,o){var h=this.XLObj,s,v,l,y,a,p,w,b,k=new RegExp(/[^.-a-zA-Z 0-9]+/g),c,d;for(y=h._getSelectedItems(e,o,f),l=y[0],f=y[1],c=0,d=l.length;c<d;c++)(v=t.isNullOrUndefined(l[c].rowIndex)?n(l[c]):h.getCell(l[c].rowIndex,l[c].colIndex),v.hasClass("e-hidecell"))||(s=this._getValueForCFormat(v,e),p=!0,b=-1,t.isNullOrUndefined(s)||!s.length?a=!1:n.isNumeric(i.replace(k,""))?(i=i.replace(k,""),h._isValidDate(s)&&(s=h._dateToInt(s).toString()),a=s.indexOf(i)>-1):h._isValidDate(i)?(h._isValidDate(s)&&(s=h._dateToInt(s).toString()),a=s.indexOf(h._dateToInt(i))>-1):h._isValidTime(i)?(h._isValidTime(s)&&(s=h._dateToInt("01/01/1990 "+s).toString()),a=s.indexOf(h._dateToInt("01/01/1990 "+i))>-1):a=s.toLowerCase().indexOf(i.toLowerCase())>-1,w=u+"__"+i+"__"+r+"_"+f+"_"+h.getActiveSheetIndex(),this._applyCFormatRule(v,w,b,a,p,r))},_applyDateContainsValues:function(i,r,u,f,e,o){var c=this.XLObj,l,a,v=!1,y,p,w=c._getSelectedItems(e,o,f),h=w[0],s,b,k,d;for(f=w[1],s=0,b=h.length;s<b;s++)(a=t.isNullOrUndefined(h[s].rowIndex)?n(h[s]):c.getCell(h[s].rowIndex,h[s].colIndex),a.hasClass("e-hidecell"))||(l=this._getValueForCFormat(a,e),p=-1,t.isNullOrUndefined(l)||!l.length?v=!1:c._isValidDate(i)&&(k=new Date(l),d=new Date(i),v=k-d==0),y=u+"__"+i+"__"+r+"_"+f+"_"+c.getActiveSheetIndex(),this._applyCFormatRule(a,y,p,v,!0,r))},refreshCFormat:function(t){for(var e=this.XLObj,i,o=[],l=e.getActiveSheetIndex(),f,s=e._getSelectedItems(l,t)[0],r,h,u=0,c=s.length;u<c;u++){if(r=e.XLEdit.getPropertyValueByElem(n(s[u]),"cFormatRule"),!e.isUndefined(r))for(i=0,h=r.length;i<h;i++)r[i]=r[i].replace("_true","").replace("_false",""),o.indexOf(r[i])<0&&o.push(r[i]);n(s[u]).removeClass("e-redft e-yellowft e-greenft e-redf e-redt");e.clearRangeData(null,["cFormatRule"],n(s[u]))}for(i=0,h=o.length;i<h;i++)f=o[i].split("_"),this._cFormat(f[0],f[2],f[3],f[4],f[5])},_applyCFormatRule:function(n,t,i,r,u,f){var o=this.XLObj,e=o.XLEdit.getPropertyValueByElem(n,"cFormatRule"),s,c,h,l;if(this._getRuleIndex(t+"_true",e)>-1&&(i=this._getRuleIndex(t+"_true",e)),this._getRuleIndex(t+"_false",e)>-1&&(i=this._getRuleIndex(t+"_false",e)),i>-1&&(s=e[i],c=o._dataContainer.cFormatData.indexOf(this._updateCFormatRule(s,r)),c>-1?o._dataContainer.sheets[o.getActiveSheetIndex()][n.parent().index()][n[0].cellIndex].cFormatRule[i]=c:(o._dataContainer.cFormatData.push(this._updateCFormatRule(s,r)),o._dataContainer.sheets[o.getActiveSheetIndex()][n.parent().index()][n[0].cellIndex].cFormatRule[i]=o._dataContainer.cFormatData.length-1)),e=o.XLEdit.getPropertyValueByElem(n,"cFormatRule"),!o.isUndefined(e)&&e.length>0&&(!(t+"_true"===e[i]||t+"_false"===e[i])||e.length>1)){for(h=0,l=e.length;h<l;h++)s=e[h].split("_"),s[7]==="true"&&s[4]===f&&(u=!1);r?n.removeClass("e-redft e-yellowft e-greenft e-redf e-redt")&&n.addClass("e-"+f):u&&n.removeClass("e-"+f)}else r?n.removeClass("e-redft e-yellowft e-greenft e-redf e-redt")&&n.addClass("e-"+f):n.removeClass("e-"+f);this._getRuleIndex(t+"_true",e)<0&&this._getRuleIndex(t+"_false",e)<0&&o.XLEdit._updateDataContainer(n[0],{cFormatRule:[t+"_"+r]})}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.clipboard=function(n){this.XLObj=n;this._cutCells=[];this._copyCells=[];this._copyBackup={};this._cData="";this._isCut=!1;this._copyRange=[];this._isSpecial=!0;this._isShape=!1};t.spreadsheetFeatures.clipboard.prototype={copyCells:function(){this._triggerKeyDown(67,!0)},cutCells:function(){this._triggerKeyDown(88,!0)},pasteCells:function(){this._triggerKeyDown(86,!0)},_initCopyPaste:function(){var i=this.XLObj._id,r=t.buildTag("div",{},{position:"fixed",top:-1e3,left:-1e3},{id:i+"_copyPaste"});n("body").append(r);r.append(t.buildTag("textarea ."+i+"_copyTxt",{},{width:1,height:1,overflow:"hidden",opacity:0,resize:"none",cursor:"default"},{id:i+"_hiddenTxt"}))},_copyPasteHandler:function(t){var i=this.XLObj,r;if(i._isUndoRedo=!1,(t.keyCode===67||t.keyCode===88)&&i._preventcutcopy){r=n("#"+i._id+"_alertdlg");i._renderAlertDlgContent(r,"Alert",i._getLocStr("CtrlKeyCopyErrorAlert"),"CtrlKeyCopyErrorAction",450);i._alertDialog.element.ejDialog("open")&&r.focus();return}t.ctrlKey?t.keyCode===67?(this._getClipboard(t),this._cutCells=[],this._copyCells=i.getSheet(i.getActiveSheetIndex())._selectedCells,this._copyCells.length||(this._copyCells=[i.XLShape._picCellIdx]),setTimeout(function(){i.setSheetFocus()},0)):t.keyCode===88?(this._cutCells=i.getSheet(i.getActiveSheetIndex())._selectedCells,this._cutCells.length||(this._cutCells=[i.XLShape._picCellIdx]),this._getClipboard(t),setTimeout(function(){i.setSheetFocus()},0)):t.keyCode===86&&(i.isUndefined(t.bubbles)||(this._isSpecial=!0),n("#"+i._id+"_hiddenTxt").select(),setTimeout(function(){i.XLClipboard._setClipboard()},0)):t.keyCode===27&&i.element.find(".e-cdata").length&&i.element.find("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom")},_triggerKeyDown:function(t,i){var u=this.XLObj,r;u.setSheetFocus();r=n.Event("keydown");r.keyCode=t;r.ctrlKey=i;n("#"+u._id).trigger(r)},_getClipboard:function(t){var i=this.XLObj,r=i.getActiveSheetIndex(),e=i.getSheet(r),o=e._startCell,s=e._endCell,f=i._getContent(r).find(".e-selected"),h=i.getActiveCellElem(r)[0],u;i.XLClipboard._copyBackup.cells||(i.XLRibbon._enableButtons(["pastebtn"],"ejButton")||i.XLRibbon._enableButtons(["pastesbtn"],"ejSplitButton"));f.length?(this._copyBackup={cells:[],border:i.XLFormat.getHashCodeClassAsArray(),table:[],filterRange:[]},u=this._getSelectedData(o,s),i.element.find(".e-cdata").length&&i.element.find("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),n(f).addClass("e-cdata"),i.XLSelection._focusBorder(o,s,i._cutFocus),this._cData=f.length<2&&!u.length?u=" ":u,this._isCut=!1,n("#"+i._id+"_hiddenTxt").val(u).select(),this._copyBackup.actCellPos={top:h.offsetTop,left:h.offsetLeft},this._isShape=!1):(this._isShape=!0,this._copyBackup={elem:i.getSheetElement(r).find(".e-ss-activeimg"),isCut:t.keyCode===88,sIdx:r})},_getSelectedData:function(t,i){var r=this.XLObj,c="",f,e,u,o,l=r.getActiveSheetIndex(),w,h,y,p;for(t.rowIndex>=i.rowIndex&&(w=t,t=i,i=w),this._copyRange=[],this._copyRange.push(r.getActiveSheetIndex()),this._copyRange.push(r._getSelectedItems()[1]),e=t.rowIndex;e<=i.rowIndex;e++)if(e!==t.rowIndex&&(c+="\n"),t.colIndex<=i.colIndex)for(u=t.colIndex;u<=i.colIndex;u++)f=r.getCell(e,u)[0],o=r.XLEdit.getPropertyValueByElem(n(f))?r.XLEdit.getPropertyValueByElem(n(f)):"",this._updateCBackupData(e,u,f),f&&(c+=u!==i.colIndex?o+"\t":o);else for(u=i.colIndex;u<=t.colIndex;u++)f=r.getCell(e,u)[0],o=r.XLEdit.getPropertyValueByElem(n(f))?r.XLEdit.getPropertyValueByElem(n(f)):"",this._updateCBackupData(e,u,f),f&&(c+=u!==t.colIndex?o+"\t":o);var a=r.model.sheets[l]._tableManager,s,v,b=[],k=r.model.sheets[l].selectedRange;for(h=0,y=r.getObjectLength(a);h<y;h++)s=n.extend(!0,{},a[h]),v=s.range,this._compareRange(k,v)&&(b.push(s.name),s.header=!0,s.name="Table"+(parseInt(n.trim(a[y-1].name.replace("Table","")))+h),this._copyBackup.table.push({tblName:b,tblObj:s,range:v}));return p=r.getRangeIndices(r.model.sheets[l].filterSettings.range),this._compareRange(k,p)&&(this._copyBackup.filterRange=p),c},_updateCBackupData:function(t,i,r){var e=this.XLObj,u=e._dataContainer,f=e.getActiveSheetIndex(),o,s=new RegExp("\\be-format.*?\\b","g");o=t in u.sheets[f]&&i in u.sheets[f][t]?n.extend(!0,{},u.sheets[f][t][i]):{};this._copyBackup.cells.push({cell:o,format:r.className.indexOf("e-format")>-1?r.className.match(s)[0]:""})},_setClipboard:function(){var i=this.XLObj,e,tt=[],f=[],kt,li=new RegExp("\\be-format.*?\\b","g"),c,ct=!1,b,u=i.getActiveSheetIndex(),p={cSheetIndex:this._copyRange[0],pSheetIndex:u,sheetIndex:u},lt=i.getSheet(u)._startCell,at=i.getSheet(u)._endCell,l,d,ut=0,vt,ai,dt,s={},k,vi,gi=new RegExp("\\be-shapebdr.*?\\b","g"),nr=["solid","dashed","dotted"],v=lt.rowIndex<at.rowIndex?lt.rowIndex:at.rowIndex,tr,yi=this._copyBackup.table,y=lt.colIndex<at.colIndex?lt.colIndex:at.colIndex,a=i._dataContainer,r,ft,sr=i.model.sheets[u],yt=i.getSheetElement(u).find(".e-activecell"),rt=i.getSheet(this._copyBackup.sIdx||this._copyRange[0]||u)._shapeMngr,ht,it,pt,ir,rr,pi,g,ri,wt,wi,ui,fi,h,w,hr,cr,ei,o,nt,oi,st,si,ot,bi,ki,gt,or,ni;if(this._isShape){var ur,wt,ti=i.XLShape._picCellIdx,bt=i.getActiveCell(u),et,ii;k=this._copyBackup.elem;wt=k[0].id;kt=wt.indexOf("picture")>-1?"picture":"chart";rt[kt].some(function(n,t){return wt===n.id?(ur=t,!0):!1});p={sheetIndex:u,cSheetIndex:this._copyBackup.sIdx,pSheetIndex:u,operation:"shape",cShapeId:wt,reqType:this._copyBackup.isCut?"cut-paste":"copy-paste"};e=n.extend(!0,{},a.sheets[this._copyBackup.sIdx][ti.rowIndex][ti.colIndex]);p.cutCell={rowIndex:ti.rowIndex,colIndex:ti.colIndex,obj:e};f=i.getCell(bt.rowIndex,bt.colIndex);n.extend(!0,s,rt[kt][ur]);k=i.element.find("#"+s.id);kt==="picture"?(it=k[0].className,it.indexOf("e-shapebdr")>-1?(it=k[0].className.match(gi)[0],et=it.replace("e-shapebdr","").split("N"),ii=et[2],i.XLShape._createPicture(u,f[0],rt.sharedPics[s.data],f[0].offsetTop,f[0].offsetLeft,s.width,s.height,null,"#"+ii,nr[parseInt(et[1])-1],et[0]+"px")):i.XLShape._createPicture(u,f[0],rt.sharedPics[s.data],f[0].offsetTop,f[0].offsetLeft,s.width,s.height)):(r=s.range,r=i._getAlphaRange(u,r[0],r[1],r[2],r[3]),r.indexOf(":")===-1&&(r=r+":"+r),s.top=f[0].offsetTop,s.left=f[0].offsetLeft,i.XLChart.createChart(r,n.extend(!0,{},s)));this._copyBackup.isCut&&i.XLShape._deleteShape(this._copyBackup.sIdx,k);this._isShape=this._copyBackup.isCut?!1:!0;this._cutCells=[];i._isUndoRedo||(ri=ri=i._id+"_"+kt,wt=parseInt(s.id.replace(ri,""))+1,p.pShapeId=ri+wt,p.pasteCell={rowIndex:bt.rowIndex,colIndex:bt.colIndex,obj:n.extend(!0,{},a.sheets[u][bt.rowIndex][bt.colIndex])},i._completeAction(p))}else{if(p.reqType=this._cutCells.length>0?"cut-paste":"copy-paste",i.element.find(".e-selected").hasClass("e-readonly")){i.element.find(".e-cdata").length&&i.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom");return}if(p.text=tt=n("#"+i._id+"_hiddenTxt").val().split("\n"),ct=this._cData===n("#"+i._id+"_hiddenTxt").val(),this._cData.length<1&&p.text.length<2)return;if(ct||tt[tt.length-1]!==""||tt.splice(tt.length-1,1),wi=[],ct?(p.isSpecial=this._isSpecial,r=i.getRangeIndices(this._copyRange[1]),i.setActiveSheetIndex(this._copyRange[0]),p.cutBorder={range:r,prevBorder:i.XLFormat.getHashCodeClassAsArray(r)},i.setActiveSheetIndex(u)):p.isSpecial=!1,this._cutCells.length){for(pi=[],g=this._copyRange[0],l=0,pt=this._cutCells.length;l<pt;l++)h=this._cutCells[l].rowIndex,w=this._cutCells[l].colIndex,c=i.getCell(h,w,g),f={rowIndex:h,colIndex:w,prevObj:{},newObj:{}},t.isNullOrUndefined(a.sheets[g][h])?f.prevObj={}:n.extend(!0,f.prevObj,a.sheets[g][h][w]),c[0]&&(i.XLEdit.updateCellValue(c,""),e=t.isNullOrUndefined(a.sheets[g][h])?{}:n.extend(!0,{},a.sheets[g][h][w]),"wrap"in e&&(vt=i._generateHeaderText(g,w+1)+(h+1),i.setWrapText(vt+":"+vt,"wrap")),c.removeClass("e-commentcell e-hyperlinks e-redft e-yellowft e-greenft e-redf e-redt"),h in a.sheets[g]&&w in a.sheets[u][h]&&delete a.sheets[g][h][w],c[0].className.match(li)&&(c[0].className=c[0].className.replace(li,"")),t.isNullOrUndefined(a.sheets[g][h])?f.newObj={}:n.extend(!0,f.newObj,a.sheets[g][h][w]),i._setRowHdrHeight(g,n(c[0]).parent().index())),pi.push(f);for(o=0,nt=yi.length;o<nt;o++)tr=n.trim(yi[o].tblName),i.XLFormat.removeTable(n.trim(yi[o].tblName[0].replace("Table","")));i.XLFormat.clearFormat(r);i.setActiveSheetIndex(g);i.XLFormat.clearFormat(r,"border");i.setActiveSheetIndex(u);p.cutCells=pi;p.cfat={table:tr,range:r};rr=!0;i.element.find(".e-cdata").length&&i.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom")}else{if(oi=[],this._isSpecial)for(l=0,pt=this._copyCells.length;l<pt;l++)h=this._copyCells[l].rowIndex,w=this._copyCells[l].colIndex,f={rowIndex:h,colIndex:w},t.isNullOrUndefined(a.sheets[u][h])?f.prevObj={}:n.extend(!0,f.prevObj,a.sheets[u][h][w]),oi.push(f);else oi=this._copyCells;p.cutCells=oi}for(tt.length?ht=[v,y,v+tt.length-1,y+tt[0].split("\t").length-1]:(ht=[v,y,v,y],d=1,l=1),p.pasteBorder={range:ht,prevBorder:i.XLFormat.getHashCodeClassAsArray(ht)},l=0,pt=tt.length;l<pt;l++){for(f=tt[l].split("\t"),d=0,ir=f.length;d<ir;d++){if(c=i.getCell(v+l,y+d),t.isNullOrUndefined(c[0])&&(sr.colCount<=y+d?i.XLScroll._createNewColumn(u,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert"):i.XLScroll._createNewRow(u,-1,-1,"insert"),i.XLScroll._refreshScroller(u,"refresh","all"),c=i.getCell(v+l,y+d)),b={rowIndex:v+l,colIndex:y+d},b.prevObj=t.isNullOrUndefined(a.sheets[u][v+l])?{}:n.extend(!0,{},a.sheets[u][v+l][y+d]),this._isCut&&ct)return;if(this._isSpecial&&ct)if(r=i.getRangeIndices(this._copyRange[1]),ei=i.getRange(r[0],r[1],r[2],r[3],this._copyRange[0]),h=c.parent("tr").index(),w=c[0].cellIndex,hr=n(ei[ut]).parent("tr").index(),cr=ei[ut].cellIndex,c[0].className=c[0].className.replace(li,""),it=this._copyBackup.cells[ut].format,t.isNullOrUndefined(it)||c.addClass(it),e=n.extend(!0,{},this._copyBackup.cells[ut].cell),e){if(h in a.sheets[u]||(a.sheets[u][h]={}),w in a.sheets[u][h]||(a.sheets[u][h][w]={}),a.sheets[u][h][w]=e,fi=e.value2&&typeof e.value2=="string"&&!e.formatStr?a.sharedData[e.value][0]==="="?a.sharedData[e.value]:e.value2:a.sharedData[e.value],i.XLEdit.updateCellValue(c,fi),"hyperlink"in e&&(ui=e.hyperlink,ui?ui.webAdr?c.html(t.buildTag("a.e-hyperlinks",fi,"",{href:ui.webAdr,target:"_blank"})):c.html(t.buildTag("a.e-hyperlinks",fi,"",{href:"#"})):0),"comment"in e&&(c.removeClass("e-commentcell"),i.XLComment.setComment(c,null,!1)),"cFormatRule"in e)for(ai=n.extend(!0,[],e.cFormatRule),e.cFormatRule=[],o=0,nt=ai.length;o<nt;o++)dt=i._dataContainer.cFormatData[ai[o]].split("_"),i.XLCFormat._cFormat(dt[0],dt[2],dt[3],dt[4],null,null,[h,w,h,w],"paste");if("wrap"in e&&(vt=i._generateHeaderText(u,w+1)+(h+1),i.setWrapText(vt+":"+vt,"wrap")),i._isPaste=!0,"picture"in e)for(o=0,nt=e.picture.length;o<nt;o++)f=this._copyCells.length?this._copyCells[ut]:this._cutCells[ut],ft=this._copyBackup.actCellPos,st=i.getRangeData([f.rowIndex,f.colIndex,f.rowIndex,f.colIndex])[0],(!i.isUndefined(st.picture)&&st.picture.indexOf(e.picture[o])>-1||!this._copyCells.length)&&(n.extend(!0,s,rt.picture[e.picture[o]]),k=i.element.find("#"+s.id),s.rowIndex===f.rowIndex&&s.colIndex===f.colIndex&&(k=i.element.find("#"+s.id),it=k[0].className,it.indexOf("e-shapebdr")>-1?(it=k[0].className.match(gi)[0],et=it.replace("e-shapebdr","").split("N"),ii=et[2],i.XLShape._createPicture(u,c[0],rt.sharedPics[s.data],parseInt(k.css("top"))-ft.top+yt[0].offsetTop,parseInt(k.css("left"))-ft.left+yt[0].offsetLeft,s.width,s.height,null,"#"+ii,nr[parseInt(et[1])-1],et[0]+"px")):i.XLShape._createPicture(u,c[0],rt.sharedPics[s.data],parseInt(k.css("top"))-ft.top+yt[0].offsetTop,parseInt(k.css("left"))-ft.left+yt[0].offsetLeft,s.width,s.height),a.sheets[u][v+l][y+d].picture[o]=rt.picture.length-1,this._cutCells.length&&k.remove()));if("chart"in e)for(st=i.getRangeData([h,w,h,w]),o=0,nt=e.chart.length;o<nt;o++)f=this._copyCells.length?this._copyCells[ut]:this._cutCells[ut],ft=this._copyBackup.actCellPos,st=i.getRangeData([f.rowIndex,f.colIndex,f.rowIndex,f.colIndex])[0],(!i.isUndefined(st.chart)&&st.chart.indexOf(e.chart[o])>-1||!this._copyCells.length)&&(n.extend(!0,s,rt.chart[e.chart[o]]),k=i.element.find("#"+s.id),s.rowIndex===f.rowIndex&&s.colIndex===f.colIndex&&(r=s.range,r=i._getAlphaRange(u,r[0],r[1],r[2],r[3]),r.indexOf(":")<0&&(r=r+":"+r),s.top=parseInt(k.css("top"))-ft.top+yt[0].offsetTop,s.left=parseInt(k.css("left"))-ft.left+yt[0].offsetLeft,i.XLChart.createChart(r,s),a.sheets[u][v+l][y+d].chart[o]=rt.chart.length-1,this._cutCells.length&&k.remove()));if("isMerge"in e){si=0;r=i.getRangeIndices(e.mRange);var hi=r[2]-r[0],ci=r[3]-r[1],lr=i.getSheet(u)._selectedCells,di=i._getAlphaRange(u,b.rowIndex,b.colIndex,b.rowIndex+hi,b.colIndex+ci),fr=n("#"+i._id+"_alertdlg"),er=i.getRange(r[0],r[1],r[2],r[3],u).eq(0).attr("rowspan"),ar=at.rowIndex-lt.rowIndex,vr=at.colIndex-lt.colIndex;if(ot=i.getRange(b.rowIndex,b.colIndex,b.rowIndex+hi,b.colIndex+ci,u),ei.length>=lr.length||!((vr+1)%(ci+1)==0&&(ar+1)%(hi+1)==0)){for(o=0,nt=ot.length;o<nt;o++)ot[o].className.indexOf("e-mc-hide")<0&&(si++,bi=ot[o].getAttribute("rowspan"),ki=ot[o].getAttribute("colspan"),t.isNullOrUndefined(bi)||t.isNullOrUndefined(ki)||(si+=parseInt(bi)*parseInt(ki)-1),e.isCenterAlign&&(ot.addClass("e-calign"),ot.removeClass("e-ralign")));ot.length===si?(this._cutCells.length&&(i.setActiveSheetIndex(g),i._unMergeAllCells(this._copyRange[0],0,i.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),[],0,0),i.setActiveSheetIndex(u)),i._paste=!0,i.isUndefined(b.prevObj.mRange)||i.unmergeCells(b.prevObj.mRange),i.unmergeCells(di),i._mergeCenter=e.isCenterAlign,!i.isUndefined(er)&&er==="1"?i.mergeAcrossCell(di,!0):i.mergeCells(di,!0)):(i.XLEdit._updateDataContainer(i.getCell(r[0],r[1],this._copyRange[0])[0],{isMerge:e.isMerge,mRange:e.mRange,isCenterAlign:e.isCenterAlign}),i._renderAlertDlgContent(fr,"Alert",i._getLocStr("MergeAlert"),"",250),i._alertDialog.element.ejDialog("open")&&fr.focus())}i.performSelection({rowIndex:b.rowIndex,colIndex:b.colIndex},{rowIndex:b.rowIndex+hi,colIndex:b.colIndex+ci})}}else i.XLEdit.updateCellValue(c,""),delete a.sheets[u][h][w];else i.XLEdit.updateCellValue(c,f[d]),f[d].indexOf("=")>-1&&i.XLEdit.updateCellValue(c,c.html());ut++;b.newObj=t.isNullOrUndefined(a.sheets[u][v+l])?{}:n.extend(!0,{},a.sheets[u][v+l][y+d]);t.isNullOrUndefined(b.newObj)&&(b.newObj={});wi.push(b)}i._setRowHdrHeight(u,c.parent().index())}if(tt.length<1&&(l=1),this._cutCells.length&&(this._isCut=rr,this._cutCells=[]),this._isSpecial&&ct){for(or=this._copyBackup.table,r=i.getRangeIndices(this._copyRange[1]),o=0,nt=or.length;o<nt;o++)gt=this._copyBackup.table[o].range,i.XLFormat.createTable(this._copyBackup.table[o].tblObj,i._getAlphaRange(this._copyRange[0],gt[0]+v-r[0],gt[1]+y-r[1],v-r[0]+gt[2],y-r[1]+gt[3]));ht=[v,y,l+v-1,d+y-1];i.XLFormat.updateFormat(this._copyBackup.border,ht);this._cutCells.length&&this._copyBackup.filterRange.length>0&&this._copyRange[0]===u&&(ni=this._copyBackup.filterRange,i.XLFilter.clearFilter(),vi=i._generateHeaderText(u,ni[1]+y-r[1]+1)+(ni[0]+v-r[0]+1)+":"+i._generateHeaderText(u,y-r[1]+ni[3]+1)+(v-r[0]+ni[2]+1),i.XLFilter.filter(vi));p.pasteBorder.newBorder=i.XLFormat.getHashCodeClassAsArray(ht);i.setActiveSheetIndex(this._copyRange[0]);p.cutBorder.newBorder=i.XLFormat.getHashCodeClassAsArray(r);i.setActiveSheetIndex(u)}p.pfat={table:this._copyBackup.table,range:r,minRowIdx:v,minColIdx:y};p.pfilter=vi;p.pasteCells=wi;i.XLSelection.selectRange({rowIndex:v,colIndex:y},{rowIndex:l+v-1,colIndex:d+y-1});i.getSheet(u)._startCell={rowIndex:v,colIndex:y};i.getSheet(u)._endCell={rowIndex:l+v-1,colIndex:d+y-1};i.XLDragFill.positionAutoFillElement();p.sheetIndex=u;i.setSheetFocus();i._isUndoRedo||i._completeAction(p)}},_compareRange:function(n,t){return n[0]<=t[0]&&n[1]<=t[1]&&n[2]>=t[2]&&n[3]>=t[3]}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.comments=function(n){this.XLObj=n;this._isCommentEdit=!1;this._isShowAllComments=!1;this._curCommentHCell=null};t.spreadsheetFeatures.comments.prototype={setComment:function(i,r,u){var f=this.XLObj,o=f.getActiveSheetIndex(),e=t.isNullOrUndefined(i)?f.getActiveCellElem(o):n(i),c=e.parent().index(),l=e.index(),h,s;u=t.isNullOrUndefined(u);t.isNullOrUndefined(r)||f.XLEdit._updateDataContainer(e[0],{comment:{value:r,isVisible:t.isNullOrUndefined(f.XLEdit.getPropertyValueByElem(e,"comment",o))?u:f.XLEdit.getPropertyValueByElem(e,"comment",o).isVisible}});h=t.isNullOrUndefined(f.XLEdit.getPropertyValueByElem(e,"comment",o))?(f.model.userName.length>0?f.model.userName:f._getLocStr("UserName"))+":\n":f.XLEdit.getPropertyValueByElem(e,"comment",o).value;f.model.allowComments&&e.length>0&&!e.hasClass("e-commentcell")&&!f.XLEdit._isEdit&&(e.prepend(t.buildTag("div.e-comment",t.buildTag("span.e-celltoparrow")).append(t.buildTag("textarea.e-comment-txtarea",h,{"z-index":10}))).addClass("e-commentcell"),this._updateCmntArrowPos(e),s=e.find(".e-comment-txtarea"),this._updateCmtAreaPos(e,s),s.focus().setInputPos(s.val().length),f.model.sheets[o]._importRendered&&(f.XLEdit.getPropertyValueByElem(e,"comment",o).value=s.val()),u?(s.focus(),(t.isNullOrUndefined(f.XLDragDrap.dragDropMngr)||!f.XLDragDrap.dragDropMngr._isDragAndDropped)&&this._updateCurrentCell(c,l),this._isCommentEdit=!0,f.model.showRibbon&&f.XLRibbon._disableRibbonIcons()):(f._isShowAllComments||f.XLEdit.getPropertyValueByElem(e,"comment",o).isVisible||s.hide(),(t.isNullOrUndefined(f.XLDragDrap.dragDropMngr)||!f.XLDragDrap.dragDropMngr._isDragAndDropped)&&this._updateCmntRibIcons(f.XLClipboard._isSpecial?f.getActiveCellElem():e)))},_updateCmtAreaPos:function(n,t){var r=this.XLObj,u=r.getActiveSheetIndex(),s=r._getContent(u).find("#hscrollBar").offset(),f=r._getContent(u).find("#vscrollBar").offset(),h=r._getJSSheetHeader(u).offset(),i=t.offset(),e=t.height(),o=t.width();i.top+e+5>s.top&&i.left+o<f.left?t.css({top:-77}):i.left+o>f.left&&i.top+e+5>s.top?t.css({left:-136,top:-81}):i.top+e>h.top&&i.left+o>f.left&&t.css({left:-137,top:n.height()+8})},deleteComment:function(i,r){var u=this.XLObj,h=[],c=n("#"+u._id+"_Ribbon_newComment"),o=u.getActiveSheetIndex(),f=t.isNullOrUndefined(i)?u.getSheetElement(o).find(".e-selected.e-commentcell"):u.getRange(i[0],i[1],i[2],i[3],o).filter(".e-commentcell"),s={sheetIndex:o,reqType:"comment",action:"delete"},e;if(u.model.allowComments&&f.hasClass("e-commentcell")){for(e=0;e<f.length;e++)t.isNullOrUndefined(u.XLEdit.getPropertyValueByElem(n(f[e]),"comment"))||h.push({rowIndex:n(f[e]).parent().index(),colIndex:f[e].cellIndex,prevComment:u.XLEdit.getPropertyValueByElem(n(f[e]),"comment"),currComment:{}});s.selCells=h;f.find(".e-comment").parent("td").removeClass("e-commentcell").end().remove()&&u.clearRangeData(null,["comment"],f);u.model.showRibbon&&(t.isNullOrUndefined(u.XLDragDrap.dragDropMngr)||!u.XLDragDrap.dragDropMngr._isDragAndDropped)&&(u.XLRibbon._disableButtons(["deleteComment"],"ejButton"),c.find(".e-icon").removeClass("e-ssr-editcmnt").addClass("e-ssr-newcmnt")&&c.find(".e-btntxt").text(u._getLocStr("NewComment")),u.element.find(".e-commentcell").length===0&&u.XLRibbon._disableButtons(["deleteComment","previousComment","nextComment"],"ejButton"));s.reqType=t.isNullOrUndefined(r)?"comment":"clear-comment";u.XLComment._updateCmntRibIcons();u._isUndoRedo||u._completeAction(s)}},editComment:function(i){var r=this.XLObj,u=t.isNullOrUndefined(i)?r.getActiveCellElem():n(i);r.model.allowComments&&u.hasClass("e-commentcell")&&u.find(".e-comment-txtarea").css("display","inline-table").focus()&&(this._isCommentEdit=!0);r.model.showRibbon&&r.XLRibbon._disableRibbonIcons()},showHideComment:function(i){var r=this.XLObj,u=t.isNullOrUndefined(i)?r.getActiveCellElem():n(i),e=u.find(".e-comment-txtarea"),f=!1;r.model.allowComments&&(u.hasClass("e-commentcell")&&(r.XLEdit.getPropertyValueByElem(u,"comment").isVisible?e.hide()&&(f=!1):(e.css("display","inline-table"),this._curCommentHCell=null,f=!0)),r.isUndefined(f)||(r.XLEdit.getPropertyValueByElem(u,"comment").isVisible=f))},showAllComments:function(){var t=this.XLObj,e=t.getMainPanel().find(".e-comment-txtarea"),h=n("#"+t._id+"_Ribbon_showAllComments").data("ejToggleButton"),o=["previousComment","nextComment"],i,s,r,u,f;if(t.model.allowComments){for(!this._isShowAllComments&&e.css("display","inline-table")&&(r=!0)||e.hide()&&(r=!1),this._isShowAllComments=r,i=1;i<=t.model.sheetCount;i++)for(u=0,f=t.getSheetElement(i).find(".e-commentcell"),s=f.length;u<s;)t.XLEdit.getPropertyValueByElem(n(f[u]),"comment",i).isVisible=r,u++;t.model.showRibbon&&(h.model.toggleState?t.XLRibbon._disableButtons(o,"ejButton"):t.getMainPanel().find(".e-commentcell").length>0&&t.XLRibbon._enableButtons(o,"ejButton"))}},findPrevComment:function(){var i=this.XLObj,s=i.model.activeSheetIndex,a,h,c,l,u,f,e,r,v=n("#"+i._id+"_alertdlg"),y=n("#"+i._id+"_Ribbon_newComment"),o;if(i.model.allowComments&&!(i.getMainPanel().find(".e-commentcell").length<1)){for(i.showWaitingPopUp(),u=s;u>0;u--)for(u!==s&&i.gotoPage(u,!1),a=i.model.sheets[i.model.activeSheetIndex].rowCount-1,h=i.model.sheets[i.model.activeSheetIndex].colCount-1,u!==s&&this._updateCurrentCell(a-1,h-1),c=i.getSheet(i.model.activeSheetIndex)._activeCell.rowIndex,l=i.getSheet(i.model.activeSheetIndex)._activeCell.colIndex,f=c;f>=0;f--)for(f!==c&&(l=h-1),e=l;e>=0;e--){if(r=n(i.getCell(f,e)),o=n(r.find(".e-comment-txtarea")),i.getActiveCellElem()[0]!==r[0]&&!t.isNullOrUndefined(i.XLEdit.getPropertyValueByElem(r,"comment"))&&i.XLEdit.getPropertyValueByElem(r,"comment").isVisible&&o.hide(),r.hasClass("e-commentcell")&&!o.is(":visible"))return o.css("display","inline-table").focus()&&this._updateCurrentCell(f,e),i.model.showRibbon&&(i.XLRibbon._enableButtons(["deleteComment","showHideComment"],"ejButton"),y.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt")&&y.find(".e-btntxt").text(i._getLocStr("EditComment"))),i.setSheetFocus(),i.hideWaitingPopUp(),!0;this._isShowAllComments||this._isCommentEdit||!r.hasClass("e-commentcell")||i.XLEdit.getPropertyValueByElem(r,"comment").isVisible||o.hide()}u===0&&(i._renderAlertDlgContent(v,"",i._getLocStr("CommentFindEndAlert"),"findPrevComment",630),i._alertDialog.element.ejDialog("open")&&v.focus())}},findNextComment:function(){var i=this.XLObj,s=i.model.activeSheetIndex,h,c,l,a,u,f,e,r,o,v=n("#"+i._id+"_alertdlg"),y=n("#"+i._id+"_Ribbon_newComment");if(i.model.allowComments&&!(i.getMainPanel().find(".e-commentcell").length<1)){for(i.showWaitingPopUp(),u=s;u<=i.model.sheetCount;u++)for(u!==s&&i.gotoPage(u,!1),u!==s&&this._updateCurrentCell(0,0),h=i.getSheet(i.model.activeSheetIndex)._activeCell.rowIndex,c=i.getSheet(i.model.activeSheetIndex)._activeCell.colIndex,l=i.model.sheets[i.model.activeSheetIndex].rowCount-1,a=i.model.sheets[i.model.activeSheetIndex].colCount-1,f=h;f<l;f++)for(f!==h&&(c=0),e=c;e<a;e++){if(r=n(i.getCell(f,e)),o=n(r.find(".e-comment-txtarea")),i.getActiveCellElem()[0]!==r[0]&&!t.isNullOrUndefined(i.XLEdit.getPropertyValueByElem(r,"comment"))&&i.XLEdit.getPropertyValueByElem(r,"comment").isVisible&&o.hide(),r.hasClass("e-commentcell")&&!o.is(":visible"))return o.css("display","inline-table").focus()&&this._updateCurrentCell(f,e),i.model.showRibbon&&(i.XLRibbon._enableButtons(["deleteComment","showHideComment"],"ejButton"),y.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt")&&y.find(".e-btntxt").text(i._getLocStr("EditComment"))),i.setSheetFocus(),i.hideWaitingPopUp(),!0;this._isShowAllComments||this._isCommentEdit||!r.hasClass("e-commentcell")||i.XLEdit.getPropertyValueByElem(r,"comment").isVisible||o.hide()}u===i.model.sheetCount+1&&(i._renderAlertDlgContent(v,"",i._getLocStr("CommentFindEndAlert"),"findNextComment",630),i._alertDialog.element.ejDialog("open")&&v.focus())}},_commentMouseMove:function(i){var f=this.XLObj,r=n(i.target),e=r.find(".e-comment-txtarea"),u;this._isCommentEdit||(t.isNullOrUndefined(this._curCommentHCell)||r!==this._curCommentHCell&&(u=f.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment"),t.isNullOrUndefined(u)||u.isVisible||!this._curCommentHCell.find(".e-comment-txtarea").hide()||(this._curCommentHCell=null)),i.target.tagName==="TD"&&r.hasClass("e-commentcell")&&e.css("display","inline-table")&&(this._curCommentHCell=r))},_commentMouseDownHandler:function(t){var i=this.XLObj,r=i.getActiveCellElem(),u,f=n(r.find(".e-comment-txtarea")),e=i.getActiveSheetIndex(),o=i.getSheetElement(e);r.hasClass("e-commentcell")&&f.get()[0]!==t.target&&(u=i.XLEdit.getPropertyValueByElem(r,"comment"),this._isCommentEdit&&this._updateCurCmntVal(),this._isShowAllComments||i.isUndefined(u)||u.isVisible||f.hide());n(t.target).hasClass("e-comment-txtarea")&&(n(t.target).focus().css("z-index",10)&&(this._isCommentEdit=!0),this._updateCurrentCell(n(t.target).parents("td").parent().index(),n(t.target).parents("td").index()),i.model.showRibbon&&i.XLRibbon._disableRibbonIcons())},_updateCmntRibIcons:function(i){var r=this.XLObj,e=["showHideComment","deleteComment"],o=r.getActiveSheetIndex(),s=r.getSheetElement(o),u=n("#"+r._id+"_Ribbon_newComment"),h=r.getActiveCellElem(),f=s.find(".e-selected");i=t.isNullOrUndefined(r.XLDragDrap.dragDropMngr)||!r.XLDragDrap.dragDropMngr._isDragAndDropped?i?i:h:r.getCell(r._dStartCell.rowIndex,r._dStartCell.colIndex);r.XLRibbon._enableButtons(["newComment"],"ejButton");r.XLRibbon._enableButtons(r.XLRibbon._cmntTglBtnIds,"ejToggleButton");i.hasClass("e-commentcell")?(r.XLRibbon._enableButtons(e,"ejButton"),u.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt")&&u.find(".e-btntxt").text(r._getLocStr("EditComment"))):(u.find(".e-icon").removeClass("e-ssr-editcmnt").addClass("e-ssr-newcmnt")&&u.find(".e-btntxt").text(r._getLocStr("NewComment")),r.XLRibbon._disableButtons(e,"ejButton"));this._isShowAllComments||r.element.find(".e-commentcell").length===0?r.XLRibbon._disableButtons(["previousComment","nextComment"],"ejButton"):r.XLRibbon._enableButtons(["previousComment","nextComment"],"ejButton");f.length>1&&f.is(i)&&f.filter(".e-commentcell").length>0&&r.XLRibbon._enableButtons(["deleteComment"],"ejButton")},_updateCurCmntVal:function(i,r){r=t.isNullOrUndefined(r)?"":r;var u=this.XLObj,f=t.isNullOrUndefined(i)?u.getActiveCellElem():n(i),o=n(f.find(".e-comment-txtarea")),s,h=[],e={sheetIndex:u.getActiveSheetIndex(),reqType:"comment"},c=f.parent().index(),l=f.index();h.push({rowIndex:c,colIndex:l});e.action=t.isNullOrUndefined(u.XLEdit.getPropertyValueByElem(f,"comment"))?"add":"edit";e.selCells=h;e.selCells[0].prevComment=u.XLEdit.getPropertyValueByElem(f,"comment");s=o.css("z-index",9).val();u.XLEdit._updateDataContainer(f.get(0),{comment:{value:s,isVisible:u.isUndefined(u.XLEdit.getPropertyValueByElem(f,"comment"))?this._isShowAllComments:u.XLEdit.getPropertyValueByElem(f,"comment").isVisible}});this._isShowAllComments||u.XLEdit.getPropertyValueByElem(f,"comment").isVisible||o.hide();u.setSheetFocus();this._isCommentEdit=!1;u.XLCellNav._isNavigate=!0;u.model.showRibbon&&u.XLRibbon._enableRibbonIcons();u.XLEdit._updateUsedRange(c,l);e.selCells[0].curComment=u.XLEdit.getPropertyValueByElem(f,"comment");u._isUndoRedo||u._hasComment||r=="paste"||u._completeAction(e)},_updateCurrentCell:function(n,t,i){var r=this.XLObj,u={rowIndex:n,colIndex:t},f;i=i?i:r.model.activeSheetIndex;f=r.getSheet(i);f._activeCell=u;r.XLSelection.selectRange(u,u,i);f._startCell=f._endCell=u;r.XLDragFill.positionAutoFillElement()},_updateCmntArrowPos:function(t){var u=this.XLObj,f=t?t:u.getSheetElement(u.getActiveSheetIndex()).find(".e-commentcell"),r,i,e;if(u.model.allowComments)for(r=0,e=f.length;r<e;r++)i=n(f[r]),i.find(".e-comment").css({top:i.get()[0].offsetTop+"px",left:i.get()[0].offsetLeft+i.get()[0].offsetWidth-5+"px"})},_updateCmntFrmCntnr:function(n,t){var i=this.XLObj,u=i._dataContainer.sheets[i.getActiveSheetIndex()],r=i.getCell(n,t);i.XLEdit.getPropertyValueByElem(r,"comment")&&(i._removeClass(r[0],"e-commentcell"),this.setComment(i.getCell(n,t),null,!1))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.contextmenu=function(n){this.XLObj=n;this._clrFltrEnable=!1;this._rowCellMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,sprite:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert")+"...",parentId:null},{id:"Delete",text:n._getLocStr("Delete")+"...",parentId:null},{id:"Filter",text:n._getLocStr("Filter"),parentId:null,sprite:"e-icon e-ss-filter"},{id:"Sort",text:n._getLocStr("Sort"),parentId:null,sprite:"e-icon e-ss-sortatoz"},{id:"SortAtoZ",parentId:"Sort",text:n._getLocStr("SortAtoZ"),sprite:"e-icon e-ss-sortatoz"},{id:"SortZtoA",parentId:"Sort",text:n._getLocStr("SortZtoA"),sprite:"e-icon e-ss-sortztoa"},{id:"ctxComment",parentId:null,text:n._getLocStr("Comment")},{id:"ctxInsrtCmnt",text:n._getLocStr("InsertComment"),parentId:"ctxComment",sprite:"e-icon e-ss-newcmnt"},{id:"ctxEditCmnt",text:n._getLocStr("EditComment"),parentId:"ctxComment",sprite:"e-icon e-ss-editcmnt"},{id:"ctxDeleteCmnt",text:n._getLocStr("DeleteComment"),parentId:"ctxComment",sprite:"e-icon e-ss-deletecmnt"},{id:"ctxShwHdCmnt",text:n._getLocStr("ShowHide"),parentId:"ctxComment",sprite:"e-icon"},{id:"PutCellColor",parentId:"Sort",text:n._getLocStr("PutCellColor"),sprite:""},{id:"PutFontColor",parentId:"Sort",text:n._getLocStr("PutFontColor"),sprite:""},{id:"FormatCells",text:n._getLocStr("FormatCells")+"...",parentId:null,sprite:"e-icon e-ss-formatcells"},{id:"CmHyperLink",text:n._getLocStr("HyperLink"),parentId:null,sprite:"e-icon e-ss-hyperlink"},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"ClearFilter",parentId:"Filter",text:n._getLocStr("ClearFilter"),sprite:"e-icon e-ss-filternone"},{id:"FilterSelected",parentId:"Filter",text:n._getLocStr("FilterSelected"),sprite:"e-icon e-ss-filter"},{id:"HyperLink",text:n._getLocStr("HyperLink")+"...",parentId:"CmHyperLink",sprite:"e-icon e-ss-hyperlink"},{id:"EditLink",text:n._getLocStr("EditLink")+"...",parentId:"CmHyperLink"},{id:"OpenLink",text:n._getLocStr("OpenLink"),parentId:"CmHyperLink"},{id:"RemoveLink",text:n._getLocStr("RemoveLink"),parentId:"CmHyperLink",sprite:"e-icon e-ss-removelink"},];this._columnHeaderMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,sprite:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert"),parentId:null},{id:"Delete",text:n._getLocStr("Delete"),parentId:null},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Hide",text:n._getLocStr("Hide"),parentId:null},{id:"Unhide",text:n._getLocStr("Unhide"),parentId:null}];this._rowHeaderMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,sprite:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert"),parentId:null},{id:"Delete",text:n._getLocStr("Delete"),parentId:null},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Hide",text:n._getLocStr("Hide"),parentId:null},{id:"Unhide",text:n._getLocStr("Unhide"),parentId:null}];this._footerMenuData=[{id:"InsertSheet",text:n._getLocStr("InsertSheet"),parentId:null},{id:"DeleteSheet",text:n._getLocStr("DeleteSheet"),parentId:null,sprite:"e-icon e-ss-delete"},{id:"RenameSheet",text:n._getLocStr("RenameSheet"),parentId:null,sprite:"e-icon "},{id:"MoveorCopy",text:n._getLocStr("MoveorCopy")+"...",parentId:null,sprite:"e-icon "},{id:"HideSheet",text:n._getLocStr("HideSheet"),parentId:null,sprite:"e-icon "},{id:"UnhideSheet",text:n._getLocStr("UnhideSheet"),parentId:null,sprite:"e-icon "}];this._chartMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"ChartType",text:n._getLocStr("ChangeChartType")+"...",parentId:null},{id:"SelectData",text:n._getLocStr("SelectData")+"...",parentId:null}];this._imgMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"ChangePicture",text:n._getLocStr("ChangePicture"),parentId:null}]};t.spreadsheetFeatures.contextmenu.prototype={_initContextMenu:function(){var n=t.buildTag("ul .e-spreadsheet"," ",{display:"none"},{id:this.XLObj._id+"_contextMenuCell"});this._createMenu(n,this._rowCellMenuData,".e-spreadsheetcontentcontainer");n=t.buildTag("ul .e-spreadsheet"," ",{display:"none"},{id:this.XLObj._id+"_contextMenuColumnHeader"});this._createMenu(n,this._columnHeaderMenuData,".e-columnheader");n=t.buildTag("ul .e-spreadsheet"," ",{display:"none"},{id:this.XLObj._id+"_contextMenuRowHeader"});this._createMenu(n,this._rowHeaderMenuData,".e-rowheadercontent")},_initCMenuFooter:function(){var n=t.buildTag("ul .e-spreadsheet"," ",{display:"none"},{id:this.XLObj._id+"_contextMenuFooter"});this._createMenu(n,this._footerMenuData,".e-pagercontainer")},_createMenu:function(i,r,u){i.ejMenu({fields:{dataSource:r,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},menuType:t.MenuType.ContextMenu,openOnClick:!1,beforeOpen:n.proxy(this._beforeOpen,this),click:n.proxy(this._menuClick,this),contextMenuTarget:u})},hideCMenu:function(){n("#"+this.XLObj._id+"_contextMenuCell").data("ejMenu").element.hide();n("#"+this.XLObj._id+"_contextMenuColumnHeader").data("ejMenu").element.hide();n("#"+this.XLObj._id+"_contextMenuRowHeader").data("ejMenu").element.hide();n("#"+this.XLObj._id+"_contextMenuFooter").data("ejMenu").element.hide()},_beforeOpen:function(i){var r=this.XLObj,d,v,lt,et,tt,y,ot,b,it,k;this._clrFltrEnable=!1;r.model.enableContextMenu||(i.cancel=!0);this.hideCMenu();var l=i.target,st={target:l},u=n(l),ht=r.getActiveCellElem().length>0?r.getActiveCellElem():u,e=this._rowCellMenuData,f=n("#"+r._id+"_contextMenuCell").data("ejMenu"),a=n("#"+r._id+"_contextMenuFooter").data("ejMenu"),c=r.getActiveCell(s),rt,h,o;if(!r._trigger("beforeOpen",st)){if((r.XLEdit._isEdit||r.XLComment._isCommentEdit||u.hasClass("e-filterspan")||r._isPrevCMenu||u.parents("div").hasClass("e-vscroll")||u.parents("div").hasClass("e-hscroll")||n(l.parentNode).hasClass("e-pagercontainer")&&!u.hasClass("e-link"))&&(i.cancel=!0),u.hasClass("e-rowcell")||u.hasClass("e-hyperlinks")){var g=[],s=r.getActiveSheetIndex(),ut=r.getSheet(s),ft=r._getJSSheetHeader(s).find("th"),ct=r._getJSSheetRowHeader(s).find("td"),p=n("#"+r._id+"_contextMenuColumnHeader").data("ejMenu"),w=n("#"+r._id+"_contextMenuRowHeader").data("ejMenu"),nt=r.XLEdit.getPropertyValueByElem(r.getCell(ut._activeCell.rowIndex,ut._activeCell.colIndex));if(u.hasClass("e-hyperlinks")&&(u=u.parent("td"),l=u[0]),t.isNullOrUndefined(r.XLEdit.getPropertyValueByElem(u,"range")))if(n(ft[u.index()]).hasClass("e-colselected")||n(ct[u.parent().index()]).hasClass("e-rowselected"))e=n(ft[u.index()]).hasClass("e-colselected")?this._columnHeaderMenuData:this._rowHeaderMenuData,JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&f.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"});else{if(JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&f.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"}),r.model.allowHyperlink?(this._enableMenuOpt(["CmHyperLink"]),et=r.XLEdit.getPropertyValue(u.parent().index(),l.cellIndex,"hyperlink",s),tt=["EditLink","OpenLink","RemoveLink"],t.isNullOrUndefined(et)?(this._disableMenuOpt(tt),this._enableMenuOpt(["HyperLink"])):(this._enableMenuOpt(tt),this._disableMenuOpt(["HyperLink"]))):this._disableMenuOpt(["CmHyperLink"]),r.model.allowFiltering){if(f.enableItemByID("Filter"),o=r.model.sheets[s].filterSettings.tableRange,actvCell=r.getCell(c.rowIndex,c.colIndex,s)[0],o.length>0){for(rt=actvCell.className.indexOf("e-table")>-1?actvCell.className[actvCell.className.indexOf("e-table")+7]:-1,y=0,ot=o.length;y<ot;y++)if(o[y].tableID===parseInt(rt)){h=y;break}!t.isNullOrUndefined(h)&&c.rowIndex<o[h].selectedRange.endRow+1&&c.rowIndex>o[h].selectedRange.startRow-2&&c.colIndex<o[h].multifilterIdx[o[h].multifilterIdx.length-1]+1&&c.colIndex>o[h].multifilterIdx[0]-1&&(d=r.getCell(o[h].selectedRange.startRow-1,c.colIndex,s).find("span"),d.length&&d[0].className.indexOf("e-ssfiltered")>-1&&(f.enableItemByID("ClearFilter"),this._clrFltrEnable=!0))}this._clrFltrEnable||f.disableItemByID("ClearFilter")}else f.disableItemByID("Filter");r.model.allowInsert?(w.enableItemByID("Insert"),p.enableItemByID("Insert"),f.enableItemByID("Insert"),a.enableItemByID("InsertSheet")):(w.disableItemByID("Insert"),p.disableItemByID("Insert"),f.disableItemByID("Insert"),a.disableItemByID("InsertSheet"));r.model.allowDelete?(w.enableItemByID("Delete"),p.enableItemByID("Delete"),f.enableItemByID("Delete"),a.enableItemByID("DeleteSheet")):(w.disableItemByID("Delete"),p.disableItemByID("Delete"),f.disableItemByID("Delete"),a.disableItemByID("DeleteSheet"));r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem?this._enableMenuOpt(["Paste"]):this._disableMenuOpt(["Paste"]);r.model.allowSorting?this._enableMenuOpt(["Sort"]):this._disableMenuOpt(["Sort"]);g=!t.isNullOrUndefined(nt)&&n.isNumeric(nt)?[r._getLocStr("SortSmallesttoLargest"),r._getLocStr("SortLargesttoSmallest")]:t.isNullOrUndefined(Globalize.parseDate(nt))?[r._getLocStr("SortAtoZ"),r._getLocStr("SortZtoA")]:[r._getLocStr("SortOldesttoNewest"),r._getLocStr("SortNewesttoOldest")];r.model.allowComments?(f.element.find("#ctxComment").hasClass("e-disable-item")&&this._enableMenuOpt(["ctxComment"]),b=r.getSheetElement(r.getActiveSheetIndex()).find(".e-selected"),it=b.length>1?ht:u,it.hasClass("e-commentcell")?(this._disableMenuOpt(["ctxInsrtCmnt"]),e["13"].text=r.XLEdit.getPropertyValueByElem(it,"comment").isVisible?r._getLocStr("HideComment"):r._getLocStr("ShowHide"),this._enableMenuOpt(["ctxEditCmnt","ctxDeleteCmnt","ctxShwHdCmnt"])):(this._enableMenuOpt(["ctxInsrtCmnt"]),this._disableMenuOpt(["ctxEditCmnt","ctxDeleteCmnt","ctxShwHdCmnt"])),b.filter(l).length>0&&b.filter(".e-commentcell").length>0&&this._enableMenuOpt(["ctxDeleteCmnt"])):this._disableMenuOpt(["ctxComment"]);e["7"].text=g[0];e["8"].text=g[1];JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&f.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"})}else v=r.model.sheets[s].rangeSettings[r.XLEdit.getPropertyValueByElem(u,"range")],lt=r.getRangeIndices(v.range),f.option("fields",{dataSource:v.contextMenuSettings.dataSource,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"}),f.option("width",v.contextMenuSettings.width),f.option("height",v.contextMenuSettings.height)}else u.hasClass("e-ss-imgvisual")||u.hasClass("e-ss-object")||u.closest("div").hasClass("e-ss-object")?(k=n.extend(!0,[],this._chartMenuData),k=this.XLObj.model.showRibbon?this._chartMenuData:k.splice(0,2),e=r.XLShape._shapeType==="chart"?k:this._imgMenuData,JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&f.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"})):u.hasClass("e-link")&&(r._isCommentEdit&&r.XLComment._updateCurCmntVal(),r._isSheetRename&&r._updateSheetNames(),u.not("a.e-currentitem, a.e-PP, a.e-NP").hasClass("e-numericitem")&&r.gotoPage(u.data("index")),r._getSheetNames(!1).length>0?a.enableItemByID("UnhideSheet"):a.disableItemByID("UnhideSheet"));r.XLRibbon._dirtySelect(r._getContent(r.getActiveSheetIndex()).find(".e-selected"))}},_menuClick:function(n){this.XLObj._trigger("contextMenuClick",n)||this._processCMenu(n.ID,n.events.element)},_processCMenu:function(t,i){var l,o,r=this.XLObj,e=r.getActiveSheetIndex(),h,c,s,u,f;switch(t){case"Cut":r.XLClipboard.cutCells();break;case"Copy":r.XLClipboard.copyCells();break;case"PasteSpecial":case"PasteValues":r.XLClipboard._isSpecial=!(t==="PasteValues");r.XLClipboard.pasteCells();break;case"Insert":r._insDelStatus="insert";u=r._getJSSheetHeader(e).find(".e-colselected");f=r._getJSSheetRowHeader(e).find(".e-rowselected");u.length?r.insertEntireColumn({rowIndex:0,colIndex:u[0].cellIndex},{rowIndex:0,colIndex:u[u.length-1].cellIndex}):f.length?r.insertEntireRow({rowIndex:n(f[0]).parent().index(),colIndex:0},{rowIndex:n(f[f.length-1]).parent().index(),colIndex:0}):r._renderInsertDialog();break;case"Delete":u=n(r._getJSSheetHeader(e).find("tr")[0]).find(".e-colselected");f=n(r.getRows(e)[0]).find(".e-rowselected");i.parentElement.id.indexOf("ColumnHeader")>-1||u.length>0?r.deleteEntireColumn({rowIndex:0,colIndex:u[0].cellIndex},{rowIndex:0,colIndex:u[u.length-1].cellIndex},[]):i.parentElement.id.indexOf("RowHeader")>-1||f.length>0?r.deleteEntireRow({rowIndex:n(f[0]).parent().index(),colIndex:0},{rowIndex:n(f[f.length-1]).parent().index(),colIndex:0},[]):r._renderDeleteDialog();break;case"FilterSelected":r.XLFilter.filterByActiveCell();this._clrFltrEnable=!1;break;case"ClearFilter":h=r.getActiveCell(e);clsname=r.getCell(h.rowIndex,h.colIndex,e)[0].className;tabId=clsname.indexOf("e-table");tabId>-1?(c=r.model.sheets[e].columns[h.colIndex].field,r.XLFilter._clearFilterColumn(c,"","","","","",parseInt(clsname[tabId+7])),delete r._excelFilter._predicates[e][c]):r.XLFilter.clearFilter("apply");this._clrFltrEnable=!1;break;case"SortAtoZ":case"SortZtoA":case"SortSmallesttoLargest":case"SortLargesttoSmallest":case"SortOldesttoNewest":case"SortNewesttoOldest":case"PutCellColor":case"PutFontColor":r.XLSort._sortHandler(t);break;case"ClearContents":s=r.model.sheets[e].selectedRange;r.clearContents(r._getAlphaRange(e,s[0],s[1],s[2],s[3]));break;case"InsertSheet":r.insertSheet();break;case"DeleteSheet":r.deleteSheet(e);break;case"RenameSheet":r._renameSheet();break;case"MoveorCopy":r._renderMoveCopyDlg();break;case"FormatCells":n("#"+r._id+"_numberdlg_numbertab").ejTab("option","selectedItemIndex",0);r.XLRibbon._initFormatDialog();break;case"Hide":u=r._getJSSheetHeader(e).find(".e-colselected");f=r._getJSSheetRowHeader(e).find(".e-rowselected");u.length&&r.hideColumn(u[0].cellIndex,u[u.length-1].cellIndex);f.length&&r.hideRow(n(f[0]).parent().index(),n(f[f.length-1]).parent().index());break;case"Unhide":u=r._getJSSheetHeader(e).find(".e-colselected");f=r._getJSSheetRowHeader(e).find(".e-rowselected");u.length&&r.showColumn(u[0].cellIndex,u[u.length-1].cellIndex);f.length&&r.showRow(n(f[0]).parent().index(),n(f[f.length-1]).parent().index());break;case"HyperLink":case"EditLink":r._hlDlgOpen();break;case"RemoveLink":r._removeHyperlink();break;case"OpenLink":r._openLink();break;case"ctxInsrtCmnt":r.XLComment.setComment();break;case"ctxEditCmnt":r.XLComment.editComment();break;case"ctxDeleteCmnt":r.XLComment.deleteComment();break;case"ctxShwHdCmnt":r.XLComment.showHideComment();break;case"ChangePicture":r._uploadImage=!0;r.XLShape._changePicture=!0;r.element.find("#"+r._id+"_file .e-uploadinput").click();break;case"ChartType":n("#"+r._id+"_charttypedlg").ejDialog("open");break;case"SelectData":l=document.getElementById(r._id+"_chart").value;o=r.XLChart._getShapeObj(l,"chart");n("#"+r._id+"_crxaxis").val(o.xRange?r._getAlphaRange(e,o.xRange[0],o.xRange[1],o.xRange[2],o.xRange[3]):"");n("#"+r._id+"_cryaxis").val(o.yRange?r._getAlphaRange(e,o.yRange[0],o.yRange[1],o.yRange[2],o.yRange[3]):"");n("#"+r._id+"_crlaxis").val(o.lRange?r._getAlphaRange(e,o.lRange[0],o.lRange[1],o.lRange[2],o.lRange[3]):"");n("#"+r._id+"_chartrangedlg").ejDialog("open");break;case"HideSheet":r.hideSheet();break;case"UnhideSheet":r._renderUnhideDlg()}},_disableMenuOpt:function(t){for(var r=n("#"+this.XLObj._id+"_contextMenuCell").data("ejMenu"),i=0,u=t.length;i<u;i++)r.disableItemByID(t[i])},_enableMenuOpt:function(t){for(var r=n("#"+this.XLObj._id+"_contextMenuCell").data("ejMenu"),i=0,u=t.length;i<u;i++)r.enableItemByID(t[i])}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.sorting=function(n){this.XLObj=n};t.spreadsheetFeatures.sorting.prototype={_sortHandler:function(i){var c,l,a,v,y,o,r=this.XLObj,p="",u={},w=r._formatRegx,s=r.getActiveSheetIndex(),f=r.getSheet(s),e,h;if(p=f.columns[f._activeCell.colIndex].field,i!="PutCellColor"&&i!="PutFontColor"){if(!r.model.allowSorting||f._selectedCells.length==0)return;if(y=i==="SortZtoA"?t.sortOrder.Descending:t.sortOrder.Ascending,o=r._getTableID(r.getActiveCellElem()[0].className),o)u=f._tableManager[o].range.slice(0),u[0]++;else{if(u=f.selectedRange.slice(0),e=u[0],h=u[1],e===u[2])return;a=r.XLEdit.getPropertyValue(e,h);v=r.XLEdit.getPropertyValue(e+1,h);c=r.isNumber(a)?t.Spreadsheet.CellType.Number:t.Spreadsheet.CellType.String;l=r.isNumber(v)?t.Spreadsheet.CellType.Number:t.Spreadsheet.CellType.String;(c!=l||n(this.XLObj.getCell(u[0],u[1]))[0].className.indexOf("e-sswraptext")>-1)&&u[0]++}this.sortByRange(u,p,y)}else{var b,k=f._activeCell,d,g=r.getCell(k.rowIndex,k.colIndex),nt=r.getSheet(s),tt=nt._startCell,it=nt._endCell;g.get(0).className.match(w)!=null&&(d=r._getColorFromFormat(g.get(0).className.match(w)[0]));b=r._getAlphaRange(s,tt.rowIndex,tt.colIndex,it.rowIndex,it.colIndex);this.sortByColor(i,d,b)}},sortByColor:function(n,i,r){var f=this.XLObj,o=f.getActiveSheetIndex(),u={},e,s,c=f.getSheet(o),h;r=f.getRangeIndices(r);h=c.columns[r[1]].field;t.isNullOrUndefined(i)||(i=i.length===2&&n==="PutCellColor"?i[0]:i[1],n==="PutCellColor"?(u.operation="sortbgcolor",u.bgcolor=i):(u.operation="sortfgcolor",u.fgcolor=i),u.requestType=u.action="sortbycolor",u.sortColumn=h,u.selRange={startCell:{rowIndex:r[0],colIndex:r[1]},endCell:{rowIndex:r[2],colIndex:r[3]}},u.rangeData=f.getRangeDataAsObject(u.selRange.startCell,u.selRange.endCell)[0],e=this._getSortColorRange({rowIndex:r[0],colIndex:r[1]}),t.isNullOrUndefined(e)||(s=f.XLFilter._createSelection(o,e,r[0],r[1],[]).endRowIndex,e=n==="PutCellColor"||n==="PutFontColor"?e+1:e,u.range=f.model.sheets[o]._selectedRange={startRow:e,endRow:s,dataSourceIndexes:[]},f._processBindings(u)))},_getSortColorRange:function(t){var u=this.XLObj,r=u.getCell(t.rowIndex,t.colIndex),f=!1,h,i,o=0,c=!1,e=t.rowIndex,s=t.colIndex;if(r.text().length<1){for(i=e;i<e+2;i++)if(r=u.getCell(i,s),r.is(":visible")&&r.text().length>0){f=!0;o=i;break}if(!f){for(i=e;i>e-2;i--)i>-1&&(r=u.getCell(i,s),r.text().length===0&&i>0&&(r=u.getCell(i-1,s),r.text().length==0&&(c=!0)));if(!c)for(i=e-2;i>0;i--)if(r=u.getCell(i,s),r.is(":visible")&&r.text().length===0){h=i+1;f=!0;o=h;break}}}else for(i=e;i>=0;i--){if(r=u.getCell(i,s),r.is(":visible")&&r.text().length===0){h=i+1;f=!0;o=h;break}f||i!=0||(o=i,f=!0)}if(f)return o;u._renderAlertDlgContent(n("#"+u._id+"_alertdlg"),"Alert",u._getLocStr("Alert"),"",630);n("#"+u._id+"_alertdlg").ejDialog("open")},sortByRange:function(n,i,r){var s,f=this.XLObj,e=0,h=[],u={},c=[],o;if(f.model.allowSorting){for(h=f.getRangeDataAsObject({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]})[0],o=f._getContent(f.getActiveSheetIndex()).find(".e-selected").find(".e-filterspan"),s=o.length;e<s;)c.push({filterIcon:o.eq(e),colIndex:o.eq(e).parent().index(),rowIndex:o.eq(e).parentsUntil("table").eq(1).index()}),e++;u.requestType=t.Spreadsheet.Actions.Sorting;u.range=n;u.columnName=i;u.rangeData=h;u.action="sorting";u.sortDirection=r;u.filterIcon=c;f._processBindings(u)}},_sortComplete:function(n){var t=this.XLObj,r=n.range,f=this._swapSortedDatas(n),i,u;for(t._isSort=!0,t.XLComment.deleteComment(r),t._removeHyperlink(),t.clearRangeData(r,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"]),t.XLFormat.clearFormat(r,"format"),t.XLEdit.updateCellWithContainer(f,r),i=0,u=n.filterIcon.length;i<u;i++)t.XLFilter._applyFilterIcon(t.getCell(n.filterIcon[i].rowIndex,n.filterIcon[i].colIndex),n.filterIcon[i].filterIcon);t._isSort=!1},_swapSortedDatas:function(n){for(var o,s,t,r=0,u=[],h=n.model.currentViewData,l=h.length,a=this.XLObj._generateColCount(n.columnName)-1,c,i=n.range,f=i[3]-i[1]+1,v=a-i[1],e=this.XLObj.getRangeData(i,!1,["value","value2","type","thousandSeparator","range","format","comment","hyperlink"]);r<l;){for(o=h[r][n.columnName],t=v,c=e.length;t<c;){if(e[t].value===o){s=this._getMinIdx(t,f);u=u.concat(e.splice(s,f));break}t+=f}r++}return u},_getMinIdx:function(n,t){var i,r;if(i=r=t,n<t)return 0;while(i<=n){if(r+=t,r>n)return i;i+=t}}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.dragAndDrop=function(n){this.XLObj=n;this._isDragAndDropStart=!1;this._dragAndDropCell={rowIndex:0,colIndex:0};this._isDragAndDropped=!1;this._allowDragAndDrop=!1};t.spreadsheetFeatures.dragAndDrop.prototype={moveRangeTo:function(t,i){var r=this.XLObj,e=r.getActiveSheetIndex(),o=r.getSheet(e);t=r.swapRange(t);i=r.swapRange(i);var u={rowIndex:i[0],colIndex:i[1]},f={rowIndex:i[2],colIndex:i[3]},s=r.getRangeData(t),h=r.XLFormat.getHashCodeClassAsArray(t),c={sheetIndex:e,reqType:"reorder-cells",sourceData:n.extend(!0,[],s),sourceRange:t,destinationRange:i,sourceFormat:h,destinationFormat:r.XLFormat.getHashCodeClassAsArray(i),destinationData:r.getRangeData(i)};r.XLComment.deleteComment();r.clearRangeData(t);r.clearRangeData(i);r.XLFormat.clearFormat(t);r.updateData(s,i);r.XLFormat.updateFormat(h,i);r.setActiveCell(u.rowIndex,u.colIndex);u.rowIndex===0&&f.rowIndex===o.rowCount-1?r.XLSelection.selectColumns(u.colIndex,f.colIndex):u.colIndex===0&&f.colIndex===o.colCount-1?r.XLSelection.selectRows(u.rowIndex,f.rowIndex):r.XLSelection.selectRange(u,f);r._isUndoRedo||r._isFAT||r._completeAction(c)},_dMouseHover:function(n){var i=this.XLObj,f,e,o,s,t,h,r,u,c=n.target,l=c.className;if(l.indexOf("e-ddcell")>-1&&(t=n.target.getBoundingClientRect(),h=i._setXY(n),r=h[0],u=h[1],f=r-i.getFocusLeftElem().offset().left,f=f>=0&&f<=5,e=u-i.getFocusTopElem().offset().top,e=e>=0&&e<=5,o=i.getFocusRightElem().offset().left-r,o=o>=0&&o<=5,s=i.getFocusBottomElem().offset().top-u,s=s>=0&&s<=5,f&&r<=t.left+5&&r>=t.left||e&&u<=t.top+5&&u>=t.top||o&&r>=t.right-5&&r<=t.right||s&&u>=t.bottom-5&&u<=t.bottom)){i.addClass(c,"e-cursormove");this._isDragAndDropStart=!0;return}this._isDragAndDropStart&&(i._getContent(i.getActiveSheetIndex()).find(".e-cursormove").removeClass("e-cursormove"),this._isDragAndDropStart=!1)},_dMouseDown:function(n){var t=this.XLObj,u=t.getActiveSheetIndex(),i=t.getSheet(u),r;(n.preventDefault(),n.stopImmediatePropagation(),r=t.swapRange([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]),this._dragAndDropCell={rowIndex:n.target.parentNode.rowIndex,colIndex:n.target.cellIndex},t._dStartCell={rowIndex:r[0],colIndex:r[1]},t._dEndCell={rowIndex:r[2],colIndex:r[3]},t._trigger("dragStart",{sheetIndex:u,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}}))||(this._allowDragAndDrop=!0)},_dMouseMove:function(n){if(this._allowDragAndDrop){var r={rowIndex:n.target.parentNode.rowIndex,colIndex:n.target.cellIndex},t=this.XLObj,u=t.getActiveSheetIndex(),i=t.getSheet(u);if(t._trigger("drag",{sheetIndex:u,target:n.target,currentCell:r,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}}))return;t.XLSelection._focusBorder(i._startCell,i._endCell,t._thinBorder);this._updateDCells(r);t.XLSelection._focusRange(t._dStartCell,t._dEndCell,t._autofillBorder)}else this._dMouseHover(n)},_dMouseUp:function(n){if(this._isDragAndDropped){var t=this.XLObj,u=t.getActiveSheetIndex(),i=t.getSheet(u),f=!0,r=!1,e=[t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex],o={sheetIndex:u,preventAlert:!1,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}};t._isUniqueRange(i.selectedRange,t.swapRange(e))?this._preventDrop(i):(r=t._trigger("beforeDrop",o),o.preventAlert||r||!t._rangeHasData(e)||(f=confirm(t._getLocStr("DropAlert"))),!r&&f?(this.moveRangeTo([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],[t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex]),i._startCell=t._dStartCell,i._endCell=t._dEndCell):this._preventDrop(i),!r&&f&&t._trigger("drop",{sheetIndex:u,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}}));t.XLSelection._clearBorder(t._arrayAsString(t._thinBorder));t.XLDragFill.positionAutoFillElement()}this._allowDragAndDrop=this._isDragAndDropStart=this._isDragAndDropped=!1},_preventDrop:function(n){var t=this.XLObj;t.XLSelection._focusRange(n._startCell,n._endCell,t._selectionBorder);t._dStartCell=n._startCell;t._dEndCell=n._endCell},_updateDCells:function(n){var t=this.XLObj,r,u,f,e,i;r=t.getActiveSheetIndex();u=t.getSheet(r);i=u._selectedCells.length;f=t._getJSSheetHeader(r).find(".e-headercontent th");e=t._getJSSheetRowHeaderContent(r).find("td");f[u._startCell.colIndex].className.indexOf("e-colselected")===-1&&(n.rowIndex<this._dragAndDropCell.rowIndex&&t._dStartCell.rowIndex?(t._dStartCell.rowIndex=t._dStartCell.rowIndex-(this._dragAndDropCell.rowIndex-n.rowIndex),t._dEndCell.rowIndex=i===1?t._dStartCell.rowIndex:t._dEndCell.rowIndex-(this._dragAndDropCell.rowIndex-n.rowIndex)):n.rowIndex>this._dragAndDropCell.rowIndex&&(t._dStartCell.rowIndex=t._dStartCell.rowIndex+(n.rowIndex-this._dragAndDropCell.rowIndex),t._dEndCell.rowIndex=i===1?t._dStartCell.rowIndex:t._dEndCell.rowIndex+(n.rowIndex-this._dragAndDropCell.rowIndex)));e[u._startCell.rowIndex].className.indexOf("e-rowselected")===-1&&(n.colIndex<this._dragAndDropCell.colIndex&&t._dStartCell.colIndex?(t._dStartCell.colIndex=t._dStartCell.colIndex-(this._dragAndDropCell.colIndex-n.colIndex),t._dEndCell.colIndex=i===1?t._dStartCell.colIndex:t._dEndCell.colIndex-(this._dragAndDropCell.colIndex-n.colIndex)):n.colIndex>this._dragAndDropCell.colIndex&&(t._dStartCell.colIndex=t._dStartCell.colIndex+(n.colIndex-this._dragAndDropCell.colIndex),t._dEndCell.colIndex=i===1?t._dStartCell.colIndex:t._dEndCell.colIndex+(n.colIndex-this._dragAndDropCell.colIndex)));this._dragAndDropCell=n;this._isDragAndDropped=!0},_initDragAndDropRange:function(n){var t=0,u="e-ddcell",r=this.XLObj;n=r.swapRange(n);for(var f=r.getRange(n[0],n[1],n[2],n[3]),e=n[2]-n[0]+1,i=n[3]-n[1]+1;t<i;)r.addClass(f[t],u),t++;for(t=i-1;t<e*i;)r.addClass(f[t],u),t+=i;for(t=(e-1)*i;t<e*i;)r.addClass(f[t],u),t++;for(t=0;t<e*i;)r.addClass(f[t],u),t=t+i}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.exporting=function(n){this.XLObj=n};t.spreadsheetFeatures.exporting.prototype={"export":function(i){var s=this.XLObj,r={},a=s.model.exportSettings,w,o,h,c,v,u,l,f,b,k,y,p,e;for(n.extend(!0,r,s.model),v=i===t.Spreadsheet.exportType.Excel?a.excelUrl:a.csvUrl,u=1;u<r.sheets.length;u++)for(r.sheets[u].chart=[],n.extend(!0,r.sheets[u].chart,r.sheets[u]._shapeMngr.chart),r.sheets[u]._shapeMngr.chart=[],l=0,b=r.sheets[u].chart.length;l<b;l++)if(y=n("#"+r.sheets[u].chart[l].id).data("ejChart"),y){for(p=n.extend(!0,{},y.model),e=p.series,f=0,k=e.length;f<k;f++)delete e[f].dataSource,delete e[f].query,e[f].fill=jQuery.type(e[f].fill)=="array"?e[f].fill[0].color:e[f].fill;r.sheets[u]._shapeMngr.chart.push(p)}(r.sheets.shift(),a.allowExporting&&!s.isUndefined(v))&&(w={action:v,method:"post"},o=t.buildTag("form","",null,w),h={name:"sheetData",type:"hidden",value:JSON.stringify(s._dataContainer)},c=t.buildTag("input","",null,h),o.append(c),h={name:"sheetModel",type:"hidden",value:JSON.stringify(this._dropElements(r))},c=t.buildTag("input","",null,h),o.append(c),n("body").append(o),o.submit())},_dropElements:function(n){var r=n.sheets,f=["_spreadSheetPager","datasource"],u,t,i;n.undoCollection=[];for(u in r){i=r[u];for(t in i)f.indexOf(t)>-1&&(i[t]=null)}return n}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.findnreplace=function(n){this.XLObj=n;this._findCount=0;this.caseSen={"true":function(n){return n.toString()},"false":function(n){return n.toString().toLowerCase()}};this.isEMatch={"true":function(n,t){return n==t},"false":function(n,t){return n.indexOf(t)>-1}}};t.spreadsheetFeatures.findnreplace.prototype={replaceAllBySheet:function(n,t,i,r){this.XLObj.model.allowSearching&&this._replaceAllData(n,t,i,r,"value","sheet")},replaceAllByBook:function(n,t,i,r){this.XLObj.model.allowSearching&&this._replaceAllData(n,t,i,r,"value","workbook")},_findNext:function(n,t,i,r,u,f,e){var l=this.XLObj,h={sheetIndex:t,value:n,isCaseSensitive:i,isEntireMatch:r,searchBy:e,mode:f,findType:u,reqType:"findNext"};if(l._trigActionBegin(h))return!0;n=h.value;t=h.sheetIndex;i=h.isCaseSensitive;r=h.isEntireMatch;u=h.findType;f=h.mode;e=h.searchBy;var w=t?t:l.model.activeSheetIndex,tt=l.getSheet(w),a=tt._activeCell.rowIndex,v=tt._activeCell.colIndex,p=tt._usedRange,b=p.rowIndex+1,k=p.colIndex+1,d,o,s,y,g,c=e==="rows",nt,it;if(c||(nt=a,a=v,v=nt,nt=b,b=k,k=nt),f==="sheet"){for(o=a;o<b;o++)for(o!==a&&(v=0),s=v;s<k;s++)if(d=this._compareValues(c?o:s,c?s:o,w,n,i,r,u),d&&!(o===a&&s===v))return this._updateSelection(c?o:s,c?s:o),this._findCount++,h={reqType:"findNext",activeCell:l.getActiveCellElem()},l._trigActionComplete(h),!0}else for(y=w,it=l.model.sheetCount;y<=it;y++)for(p=l.model.sheets[y]._usedRange,y!==w&&(v=0,a=0,b=c?p.rowIndex:p.colIndex,k=c?p.colIndex:p.rowIndex),o=a;o<b+1;o++)for(o!==a&&(v=0),s=v;s<k+1;s++)if(d=this._compareValues(c?o:s,c?s:o,y,n,i,r,u),d&&!(y===w&&o===a&&s===v))return this._updateSelection(c?o:s,c?s:o,y),this._findCount++,h={reqType:"findNext",activeCell:l.getActiveCellElem()},l._trigActionComplete(h),!0;return this._findCount?!1:(g=f==="sheet"?w:1,this._updateSelection(0,0,g),this._findCount++,this._compareValues(0,0,g,n,i,r,u)?!0:this._findNext(n,g,i,r,u,f,e))},_findPrev:function(n,t,i,r,u,f,e){var c=this.XLObj,h={sheetIndex:t,value:n,isCaseSensitive:i,isEntireMatch:r,searchBy:e,mode:f,findType:u,reqType:"findPrevious"};if(c._trigActionBegin(h))return!0;n=h.value;t=h.sheetIndex;i=h.isCaseSensitive;r=h.isEntireMatch;u=h.findType;f=h.mode;e=h.searchBy;var k=t?t:c.model.activeSheetIndex,tt=c.getSheet(k),a=tt._activeCell.rowIndex,v=tt._activeCell.colIndex,w=tt._usedRange,b=w.rowIndex+1,y=w.colIndex+1,g,o,s,p,d,l=e==="rows",nt;if(l||(nt=a,a=v,v=nt,nt=b,b=y,y=nt),f==="sheet"){for(o=a;o>=0;o--)for(o!==a&&(v=y),s=v;s>=0;s--)if(g=this._compareValues(l?o:s,l?s:o,k,n,i,r,u),g&&!(o===a&&s===v))return this._updateSelection(l?o:s,l?s:o),this._findCount++,h={reqType:"findPrevious",activeCell:c.getActiveCellElem()},c._trigActionComplete(h),!0}else for(p=k;p>=1;p--)for(w=c.model.sheets[p]._usedRange,p!==k&&(b=l?w.rowIndex:w.colIndex,y=l?w.colIndex:w.rowIndex,v=y,a=b),o=a;o>=0;o--)for(o!==a&&(v=y+1),s=v;s>=0;s--)if(g=this._compareValues(l?o:s,l?s:o,p,n,i,r,u),g&&!(p===k&&o===a&&s===v))return this._updateSelection(l?o:s,l?s:o,p),this._findCount++,h={reqType:"findPrevious",activeCell:c.getActiveCellElem()},c._trigActionComplete(h),!0;return this._findCount?!1:(d=f==="sheet"?k:c.model.sheetCount,b=c.model.sheets[d]._usedRange.rowIndex,y=c.model.sheets[d]._usedRange.colIndex,this._updateSelection(b,y,d),this._findCount++,this._compareValues(b,y,d,n,i,r,u)?!0:this._findPrev(n,d,i,r,u,f,e))},_compareValues:function(n,i,r,u,f,e,o){var s=this.XLObj,c=s.getCell(n,i,r),h=s.XLEdit.getPropertyValueByElem(c,null,r)?s.XLEdit.getPropertyValueByElem(c,null,r).toString():"",l=!t.isNullOrUndefined(h)&&h.charAt(0)==="="&&!t.isNullOrUndefined(s.XLEdit.getPropertyValueByElem(c,"value2",r))&&typeof s.XLEdit.getPropertyValueByElem(c,"value2",r)=="string";return h=o==="value"?h&&!l?this.caseSen[f](h):"":o==="formula"?l?this.caseSen[f](h):"":s.XLEdit.getPropertyValueByElem(c,"comment",r)?this.caseSen[f](s.XLEdit.getPropertyValueByElem(c,"comment",r).value):"",u=this.caseSen[f](u),this.isEMatch[e](h,u)},_replace:function(n,t,i,r,u){var f=this.XLObj,o=f.getActiveSheetIndex(),e=f.XLEdit.getPropertyValueByElem(n,null,t)?f.XLEdit.getPropertyValueByElem(n,null,t).toString():"",s=new RegExp(i.toString(),"ig"),h=e!==""&&i!==""?u?e.replace(i,r):e.replace(s,r):r;t===o||f.gotoPage(t);f.XLEdit.updateCellValue(n,h);n.hasClass("e-commentcell")&&n.removeClass("e-commentcell")&&f.XLComment.setComment(n,null,!1)},_replaceData:function(t,i,r,u,f,e,o,s,h){var v,a,c=this.XLObj,l=r?r:c.model.activeSheetIndex,b=c.getSheet(l),y=b._activeCell.rowIndex,p=b._activeCell.colIndex,k,w,d;this._compareValues(y,p,l,t,u,f,e)?(a=c.getCell(y,p,l),v={sheetIndex:l,reqType:"find-replace",operation:"replace",rowIndex:a.parent().index(),colIndex:a.index(),sIndex:r},v.prevData={value:a.text()},this._replace(a,r,t,i,u),v.newData={value:a.text()},this._findCount=0,k=o==="up"?this._findPrev(t,l,u,f,e,s,h):this._findNext(t,l,u,f,e,s,h),k||this._updateSelection(y,p,l),c._isUndoRedo||c._completeAction(v)):(w=n("#"+c._id+"_alertdlg"),d=c._getLocStr("ReplaceNotFound"),c._renderAlertDlgContent(w,"Alert",d),w.ejDialog("open"))},_replaceAllData:function(t,i,r,u,f,e){var b,s,a,k=[],o=this.XLObj,v=o.model.activeSheetIndex,d=o.getSheet(v),y=d._usedRange,it=d._activeCell.rowIndex,rt=d._activeCell.colIndex,h,c,l,p,w,g=0,nt,tt;if(b={sheetIndex:v,reqType:"find-replace",operation:"replaceAll"},e==="sheet")for(h=0,p=y.rowIndex+1;h<p;h++)for(c=0,w=y.colIndex+1;c<w;c++)this._compareValues(h,c,v,t,r,u,f)&&(s=o.getCell(h,c,v),a={rowIndex:s.parent().index(),colIndex:s.index(),prevData:{value:s.text()},sheetIndex:v},this._replace(s,v,t,i,r),g++,a.newData={value:s.text()},k.push(a));else for(l=1;l<=o.model.sheetCount;l++)for(y=o.model.sheets[l]._usedRange,h=0,p=y.rowIndex+1;h<p;h++)for(c=0,w=y.colIndex+1;c<w;c++)this._compareValues(h,c,l,t,r,u,f)&&(s=o.getCell(h,c,l),a={rowIndex:s.parent().index(),colIndex:s.index(),prevData:{value:s.text()},sheetIndex:l},this._replace(s,l,t,i,r),g++,a.newData={value:s.text()},k.push(a));b.selCells=k;this._updateSelection(it,rt);o._isUndoRedo||o._completeAction(b);o.element.ejWaitingPopup("hide");nt=n("#"+o._id+"_alertdlg");tt=o._getLocStr("ReplaceData").split("/");o._renderAlertDlgContent(nt,"Alert",tt[0]+g+" "+tt[1]);n("#"+o._id+"_FRDialog").ejDialog("close");nt.ejDialog("open")},_updateSelection:function(n,t,i){var u={rowIndex:n,colIndex:t},r=this.XLObj,f=r.getActiveSheetIndex(),e=r.getSheet(f);i||(i=f);i&&i!==f&&r.gotoPage(i,!1);e._selectedCells.length<2?(r.setActiveCell(u.rowIndex,u.colIndex,i),r.XLSelection.selectRange(u,u),e._startCell=u,e._endCell=u):r.XLCellNav._updateActiveCell(n,t);r.XLScroll._scrollSelectedPosition(i,r.getActiveCell(i));r.XLDragFill.positionAutoFillElement()},_fRKeyDownHandler:function(t){var i=this.XLObj;t.ctrlKey&&(t.keyCode===70?(t.preventDefault(),n("#"+i._id+"_FRDialog").ejDialog("open"),n("#"+i._id+"_FRDialog_FPDlgTab").ejTab("option","selectedItemIndex",0),n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length)):t.keyCode===72?(t.preventDefault(),n("#"+i._id+"_FRDialog").ejDialog("open"),n("#"+i._id+"_FRDialog_FPDlgTab").ejTab("option","selectedItemIndex",1),n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length)):t.keyCode===71&&(t.preventDefault(),n("#"+i._id+"_GoDialog").ejDialog("open"),n("#"+i._id+"_GoToDlgTab").ejTab("option","selectedItemIndex",0),n("#"+i._id+"_textRef").focus().setInputPos(n("#"+i._id+"_textRef").val().length)))},_getSelRangeDetails:function(n){var t=n[n.length-1].rowIndex-n[0].rowIndex,i=n[n.length-1].colIndex-n[0].colIndex,r=n[0].rowIndex,u=n[0].colIndex;return[t,i,r,u]},_applyGoToRule:function(n,t,i,r,u){var f=this.XLObj,e,o;f.element.ejWaitingPopup("show");switch(n){case"blanks":this._applyGotoBlanks();break;case"formulas":this._applyGotoFormulas(t,i,r,u);break;case"comments":this._applyGotoComments();break;case"datavalidation":this._applyGotoValidation();break;case"cformat":this._applyGotoCFormat();break;case"lastcell":e=f.getActiveSheetIndex();o=f.model.sheets[e]._usedRange;this._updateSelection(o.rowIndex,o.colIndex,e);break;case"constants":this._applyGotoConstants(t,i,r,u);break;case"rowdiff":this._applyGotoRowDiff();break;case"coldiff":this._applyGotoColDiff()}f.element.ejWaitingPopup("hide")},_applyGotoBlanks:function(){var t,i,r,h=[],e,u,n=this.XLObj,f=n.getActiveSheetIndex(),c=n.model.sheets[f]._usedRange,l,a=c.rowIndex,v=c.colIndex,y=n.getSheet(f)._selectedCells,o=0,s=0,p={sheetIndex:f,reqType:"find-replace",operation:"blanks"};for(y.length>1&&(u=this._getSelRangeDetails(y),a=u[0],v=u[1],o=u[2],s=u[3]),t=0;t<=a;t++)for(i=0;i<=v;i++)r=n.getCell(t+o,i+s,f),l=n.XLEdit.getPropertyValueByElem(r)?n.XLEdit.getPropertyValueByElem(r).toString():"",e=!l.length,e?r.addClass("e-goto-blank"):r.removeClass("e-goto-blank"),e&&h.push({rowIndex:t+o,colIndex:i+s,isApply:!0});p.selCells=h;n._isUndoRedo||n._completeAction(p)},_applyGotoComments:function(){var i,r,f,c=[],o,u,n=this.XLObj,e=n.getActiveSheetIndex(),l=n.model.sheets[e]._usedRange,a,v=l.rowIndex,y=l.colIndex,p=n.getSheet(e)._selectedCells,s=0,h=0,w={sheetIndex:e,reqType:"find-replace",operation:"comments"};for(p.length>1&&(u=this._getSelRangeDetails(p),v=u[0],y=u[1],s=u[2],h=u[3]),i=0;i<=v;i++)for(r=0;r<=y;r++)f=n.getCell(i+s,r+h,e),a=n.XLEdit.getPropertyValueByElem(f,"comment"),o=!t.isNullOrUndefined(a),o?f.addClass("e-goto-blank"):f.removeClass("e-goto-blank"),o&&c.push({rowIndex:i+s,colIndex:r+h,isApply:!0});w.selCells=c;n._isUndoRedo||n._completeAction(w)},_applyGotoFormulas:function(i,r,u,f){var h,c,s,w=[],v,l,o=this.XLObj,a=o.getActiveSheetIndex(),b,e,k,d=o.model.sheets[a]._usedRange,g=d.rowIndex,nt=d.colIndex,tt=o.getSheet(a)._selectedCells,y=0,p=0,it={sheetIndex:a,reqType:"find-replace",operation:"formulas"};for(tt.length>1&&(l=this._getSelRangeDetails(tt),g=l[0],nt=l[1],y=l[2],p=l[3]),h=0;h<=g;h++)for(c=0;c<=nt;c++)s=o.getCell(h+y,c+p,a),b=t.isNullOrUndefined(o.XLEdit.getPropertyValueByElem(s))?"":o.XLEdit.getPropertyValueByElem(s).toString(),e=t.isNullOrUndefined(o.XLEdit.getPropertyValueByElem(s,"value2"))?"":o.XLEdit.getPropertyValueByElem(s,"value2").toString(),k=b.charAt(0)==="="&&typeof e=="string",v=k&&(i&&n.isNumeric(e)||r&&!(e.toLowerCase()==="true"||e.toLowerCase()==="false")&&!n.isNumeric(e)&&!(e.length!==0&&e.indexOf("#")===0&&e.lastIndexOf("?")===e.length-1&&e.length>0)||u&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")||f&&e.length!==0&&e.indexOf("#")===0&&e.lastIndexOf("?")===e.length-1),v?s.addClass("e-goto-blank"):s.removeClass("e-goto-blank"),v&&w.push({rowIndex:h+y,colIndex:c+p,isApply:!0});it.selCells=w;o._isUndoRedo||o._completeAction(it)},_applyGotoValidation:function(){var i,r,f,c=[],o,u,n=this.XLObj,e=n.getActiveSheetIndex(),l=n.model.sheets[e]._usedRange,a,v=l.rowIndex,y=l.colIndex,p=n.getSheet(e)._selectedCells,s=0,h=0,w={sheetIndex:e,reqType:"find-replace",operation:"validations"};for(p.length>1&&(u=this._getSelRangeDetails(p),v=u[0],y=u[1],s=u[2],h=u[3]),i=0;i<=v;i++)for(r=0;r<=y;r++)f=n.getCell(i+s,r+h,e),a=n.XLEdit.getPropertyValueByElem(f,"rule"),o=!t.isNullOrUndefined(a),o?f.addClass("e-goto-blank"):f.removeClass("e-goto-blank"),o&&c.push({rowIndex:i+s,colIndex:r+h,isApply:!0});w.selCells=c;n._isUndoRedo||n._completeAction(w)},_applyGotoCFormat:function(){var i,r,f,l=[],o,u,n=this.XLObj,e=n.getActiveSheetIndex(),a=n.model.sheets[e]._usedRange,s,v=a.rowIndex,y=a.colIndex,p=n.getSheet(e)._selectedCells,h=0,c=0,w={sheetIndex:e,reqType:"find-replace",operation:"conditions"};for(p.length>1&&(u=this._getSelRangeDetails(p),v=u[0],y=u[1],h=u[2],c=u[3]),i=0;i<=v;i++)for(r=0;r<=y;r++)f=n.getCell(i+h,r+c,e),s=n.XLEdit.getPropertyValueByElem(f,"cFormatRule"),o=!t.isNullOrUndefined(s)&&s.length,o?f.addClass("e-goto-blank"):f.removeClass("e-goto-blank"),o&&l.push({rowIndex:i+h,colIndex:r+c,isApply:!0});w.selCells=l;n._isUndoRedo||n._completeAction(w)},_applyGotoConstants:function(i,r,u,f){var c,l,s,tt=[],v,b,a,o=this.XLObj,y=o.getActiveSheetIndex(),e,h,k=o.model.sheets[y]._usedRange,d=k.rowIndex,g=k.colIndex,nt=o.getSheet(y)._selectedCells,p=0,w=0;for(nt.length>1&&(a=this._getSelRangeDetails(nt),d=a[0],g=a[1],p=a[2],w=a[3]),c=0;c<=d;c++)for(l=0;l<=g;l++)s=o.getCell(c+p,l+w,y),e=t.isNullOrUndefined(o.XLEdit.getPropertyValueByElem(s))?"":o.XLEdit.getPropertyValueByElem(s).toString(),h=t.isNullOrUndefined(o.XLEdit.getPropertyValueByElem(s,"value2"))?"":o.XLEdit.getPropertyValueByElem(s,"value2").toString(),b=e.charAt(0)==="="&&typeof h=="string",v=!b&&(i&&n.isNumeric(e)||r&&!(e.toLowerCase()==="true"||e.toLowerCase()==="false")&&!n.isNumeric(e)&&e.length>0||u&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")||f&&h.length!==0&&h.indexOf("#")===0&&h.lastIndexOf("?")===h.length-1),v?s.addClass("e-goto-blank"):s.removeClass("e-goto-blank"),v&&tt.push({rowIndex:c+p,colIndex:l+w,isApply:!0})},_applyGotoColDiff:function(){var t,r,u,h=[],s,f,n=this.XLObj,i=n.getActiveSheetIndex(),c=n.model.sheets[i]._usedRange,l,a=c.rowIndex,v=c.colIndex,y=n.getSheet(i)._selectedCells,e=0,o=0,p={sheetIndex:i,reqType:"find-replace",operation:"coldiff"},w;if(y.length>1)for(f=this._getSelRangeDetails(y),a=f[0],v=f[1],e=f[2],o=f[3],t=0;t<=v;t++)for(w=n.XLEdit.getPropertyValueByElem(n.getCell(e,t+o,i))?n.XLEdit.getPropertyValueByElem(n.getCell(e,t+o,i)).toString():"",r=0;r<=a;r++)u=n.getCell(r+e,t+o,i),l=n.XLEdit.getPropertyValueByElem(u)?n.XLEdit.getPropertyValueByElem(u).toString():"",s=l===w,s?u.removeClass("e-goto-blank"):u.addClass("e-goto-blank"),s||h.push({rowIndex:r+e,colIndex:t+o,isApply:!1});p.selCells=h;n._isUndoRedo||n._completeAction(p)},_applyGotoRowDiff:function(){var t,r,u,h=[],s,f,n=this.XLObj,i=n.getActiveSheetIndex(),c=n.model.sheets[i]._usedRange,l,a=c.rowIndex,v=c.colIndex,y=n.getSheet(i)._selectedCells,e=0,o=0,p,w={sheetIndex:i,reqType:"find-replace",operation:"rowdiff"};if(y.length>1)for(f=this._getSelRangeDetails(y),a=f[0],v=f[1],e=f[2],o=f[3],t=0;t<=a;t++)for(p=n.XLEdit.getPropertyValueByElem(n.getCell(t+e,o,i))?n.XLEdit.getPropertyValueByElem(n.getCell(t+e,o,i)).toString():"",r=0;r<=v;r++)u=n.getCell(t+e,r+o,i),l=n.XLEdit.getPropertyValueByElem(u)?n.XLEdit.getPropertyValueByElem(u).toString():"",s=l===p,s?u.removeClass("e-goto-blank"):u.addClass("e-goto-blank"),s||h.push({rowIndex:t+e,colIndex:r+o,isApply:!1});w.selCells=h;n._isUndoRedo||n._completeAction(w)}}}(jQuery,Syncfusion);$.fn.setInputPos=function(n,t){return t||(t=n),$(this).is(":visible")?this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(n,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",n);i.select()}}):void 0},function($,ej){ej.spreadsheetFeatures=ej.spreadsheetFeatures||{};ej.spreadsheetFeatures.shape=function(n){this.XLObj=n;this._imgX=0;this._imgY=0;this._imgOffsetleft=0;this._imgOffsetTop=0;this._shapeType="Img";this._shapeROStart=!1;this._shapeRSStart=!1;this._imgRSWStart=!1;this._imgRSEStart=!1;this._imgRSNStart=!1;this._imgRSSStart=!1;this._changePicture=!1;this._picCellIdx={};this._insertPic=!1};ej.spreadsheetFeatures.shape.prototype={_insertPicture:function(n){var t=this.XLObj,a=ej.browserInfo(),r=a.name==="msie"&&parseInt(a.version)<10?n.responseText:n.xhr.response,c,o,s,h,i,v,u,l,y,f;if(r.startsWith("Invalid"))c=$("#"+t._id+"_alertdlg"),t._renderAlertDlgContent(c,"Alert",t._getLocStr("ImageValAlert")),c.ejDialog("open");else if(o=t.getActiveSheetIndex(),this._changePicture)i=t.element.find(".e-ss-activeimg").get(0),s=i.offsetLeft,h=i.offsetTop,f=this._getCellIndexFromOffset(h,s),u=t.getSheet(o)._shapeMngr,$(i).css("background-image","url('"+r+"')"),u.picture.some(function(n,t){if(i.id===n.id)return y=t,!0}),l=u.picture[y],v={sheetIndex:o,reqType:"shape",shapeType:"picture",action:"changepic",id:$(i).attr("id"),cell:f,prev:{img:u.sharedPics[l.data]},cur:{img:r}},u.sharedPics.indexOf(r)===-1&&u.sharedPics.push(r),l.data=u.sharedPics.indexOf(r),this._changePicture=!1,t.setSheetFocus(),t._completeAction(v);else{var e=t.getActiveCellElem()[0],p=t.model.pictureSettings,w=p.height,b=p.width;ej.isNullOrUndefined(e)&&(i=t.element.find(".e-ss-activeimg").get(0),f=this._getCellIndexFromOffset(i.offsetTop,i.offsetLeft),e=t.getCell(f.rowIndex,f.colIndex)[0]);s=e.offsetLeft;h=e.offsetTop;this._insertPic=!0;this._createPicture(o,e,r,h,s,b,w)}},setPicture:function(n,t,i,r,u,f,e){var o=this.XLObj,c=o.getActiveSheetIndex(),s=o.getCell(n,t)[0],h=o.model.pictureSettings;u=u?u:h.height;r=r?r:h.width;this._createPicture(c,s,i,f?f:s.offsetTop,e?e:s.offsetLeft,r,u)},_createPicture:function(n,t,i,r,u,f,e,o,s,h,c){var l,a,v,y,p,w;(s=s?s:"transparent",h=h?h:"solid",c=c?c:"1px",l=this.XLObj,a={sheetIndex:n,targetCell:t,top:r,left:u,width:f,height:e,bcolor:s,bstyle:h,bwidth:c,reqType:"picture",add:"add"},l._trigActionBegin(a))||(r=a.top,u=a.left,f=a.width,e=a.height,o=ej.isNullOrUndefined(o)?l.XLChart._shapeCnt:o,p=$(t).parent().index(),w=t.cellIndex,l._getContent(n).find(".e-content").append(ej.buildTag("div.e-ss-object","","",{id:l._id+"_picture"+o})),v=$("#"+l._id+"_picture"+o),v.css({"background-image":"url('"+i+"')",height:e,width:f,left:u,top:r}),v.addClass(this._getImgBorderHashCode({"border-color":s,"border-style":h,"border-width":c})),l._isUndoRedo||l.XLChart._shapeCnt++,l.model.sheets[n]._importRendered?l.model.sheets[n]._shapeMngr.picture[o].id=l._id+"_picture"+o:this._updateShapeMngr(t,{picture:{data:i,id:l._id+"_picture"+o,height:e,width:f,left:u,top:r,rowIndex:p,colIndex:w}},"picture"),this._selectImg(v),l.setSheetFocus(),l.model.sheets[n]._importRendered||l._isUndoRedo||l._isPaste||l.XLClipboard._isShape||(y={sheetIndex:n,reqType:"shape",shapeType:"picture",action:"remove",id:l._id+"_picture"+o,actCell:t,img:i,cnt:o},y.position={top:r,left:u,height:e,width:f},l._completeAction(y)))},_shapeMouseDown:function(n){var t,u;n.preventDefault();t=this.XLObj;u=document.activeElement.id;(u.indexOf("pictureheight")>-1||u.indexOf("picturewidth")>-1)&&t.setSheetFocus();var r,o=n.target.id,i=$(n.target),s=i.get(0),f=s.offsetLeft,e=s.offsetTop,h=t._setXY(n);this._selectImg(i);this._picCellIdx=this._getCellIndexFromOffset(e,f);this._imgOffsetleft=f;this._imgOffsetTop=e;this._imgX=h[0];this._imgY=h[1];this._shapeType=o.indexOf("chart")>-1?"chart":"Img";i.css("cursor")==="move"?this._shapeROStart=!0:(i.css("cursor")==="col-resize"||i.css("cursor")==="row-resize")&&(this._shapeRSStart=!0,t._getContent(t.getActiveSheetIndex()).find(".e-ss-imgvisual").css({left:f,top:e,height:i.height(),width:i.width()}));this._shapeType==="chart"&&(r=t.XLChart._getShapeObj(o,this._shapeType),t.getActiveSheetIndex()===r.dataSheetIdx&&t.XLChart._focusChartRange(r.xAxis.range,r.yAxis.range,r.legend.range))},_imgKeyDown:function(n){var f=this.XLObj,s=f.getActiveSheetIndex(),t=f._getContent(s).find(".e-ss-activeimg"),i=t.get(0),e=i.offsetLeft,o=i.offsetTop,r,u;if(this._shapeType=t[0].id.indexOf("chart")>-1?"chart":"Img",this._picCellIdx=this._getCellIndexFromOffset(o,e),n.shiftKey||n.ctrlKey)n.shiftKey&&!n.ctrlKey&&(n.keyCode===39||n.keyCode===38?(n.preventDefault(),r=t.height()+2,u=t.width()+2,r<400&&u<600&&t.css({width:u,height:r}),this._updateShapeObj(i),f.XLRibbon._formatTabUpdate()):(n.keyCode===37||n.keyCode===40)&&(n.preventDefault(),r=t.height()-2,u=t.width()-2,r>40&&u>60&&t.css({width:u,height:r}),this._updateShapeObj(i),f.XLRibbon._formatTabUpdate()));else{switch(n.keyCode){case 39:n.preventDefault();t.css({left:e+2});this._updateShapeObj(i);break;case 37:n.preventDefault();e>1&&t.css({left:e-2});this._updateShapeObj(i);break;case 38:n.preventDefault();o>1&&t.css({top:o-2});this._updateShapeObj(i);break;case 40:n.preventDefault();t.css({top:o+2});this._updateShapeObj(i)}this._onKeyscrollShape(s,t,n)}n.keyCode===46&&(n.preventDefault(),this._deleteShape(s,t))},_shapeMouseUp:function(n){var s="chart",f,u=this.XLObj,o=u.getActiveSheetIndex(),h=u._getContent(o),i=h.find(".e-ss-activeimg"),e=h.find(".e-ss-imgvisual"),r=$(n.target),t=r.get(0);(r.hasClass("e-ss-picture")||r[0].id.indexOf("picture")>-1)&&u.XLRibbon._formatTabUpdate();t.id.indexOf(s)>-1&&t.id.indexOf("Ribbon")<0&&(t=$(t).parents(".e-ss-object").get(0));this._shapeROStart?(u._isUndoRedo||(parseInt(i.css("top"))!=t.offsetTop||parseInt(i.css("left"))!=t.offsetLeft)&&(f={sheetIndex:o,reqType:"shape",shapeType:"chart",action:"edit",actionType:"reorder",id:$(i).attr("id"),visualImg:e,trgt:r},f.prev={top:parseInt(i.css("top")),left:parseInt(i.css("left")),height:parseInt(i.css("height")),width:parseInt(i.css("width"))},f.cur={top:t.offsetTop,left:t.offsetLeft,height:r.height(),width:r.width()}),u._isUndoRedo||(parseInt(i.css("top"))!=t.offsetTop||parseInt(i.css("left"))!=t.offsetLeft)&&(f.obj=$.extend(!0,{},u._dataContainer.sheets[o][this._picCellIdx.rowIndex][this._picCellIdx.colIndex]),u._completeAction(f)),i.css({left:t.offsetLeft,top:t.offsetTop}),this._updateShapeObj(t),e.removeClass("e-ss-picture").hide()):this._shapeRSStart&&(u._isUndoRedo||(t.className.indexOf("e-ss-imgvisual")<0&&e.length>0&&(t=e[0],r=$(t)),(parseInt(i.css("height"))!=r.height()||parseInt(i.css("width"))!=r.width())&&(f={sheetIndex:o,reqType:"shape",shapeType:"chart",action:"edit",actionType:"resize",id:$(i).attr("id"),visualImg:e,trgt:r},f.prev={top:parseInt(i.css("top")),left:parseInt(i.css("left")),height:parseInt(i.css("height")),width:parseInt(i.css("width"))},f.cur={top:t.offsetTop,left:t.offsetLeft,height:r.height(),width:r.width()},f.obj=$.extend(!0,{},u._dataContainer.sheets[o][this._picCellIdx.rowIndex][this._picCellIdx.colIndex]),u._completeAction(f))),i.css({left:t.offsetLeft,top:t.offsetTop,height:r.height(),width:r.width()}),this._updateShapeObj(t),e.removeClass("e-ss-picture").hide(),this._shapeType==="Img"&&u.model.showRibbon&&u.XLRibbon._formatTabUpdate(),this._shapeType===s&&(u.XLChart.resizeChart(i.attr("id"),r.height(),r.width()),u.model.showRibbon&&u.XLRibbon._chartDesignTabUpdate($("#"+i.attr("id")))));this._refreshImgResizing();this._shapeType="Img";this._shapeROStart=this._shapeRSStart=!1},_imgMouseMove:function(n){var c=this.XLObj;if(c._getContent(c.getActiveSheetIndex()).find(".e-ss-activeimg").length){n.preventDefault();var k=c.getActiveSheetIndex(),o=c._getContent(k),r=o.find(".e-ss-activeimg"),t=o.find(".e-ss-imgvisual"),l=r.get(0),e=l.getBoundingClientRect(),y=c._setXY(n),u=y[0],f=y[1],i,s,h;if(this._shapeROStart)t.show(),l.id.indexOf("picture")>-1&&t.addClass("e-ss-picture"),s=u-(this._imgX-this._imgOffsetleft),h=f-(this._imgY-this._imgOffsetTop),s>-1&&h>-1&&t.css({left:s,top:h,height:r.height(),width:r.width()});else{var a=t.width(),v=t.height(),p=l.offsetWidth,w=l.offsetHeight,b=o.find(".e-content"),d=o.find(".e-hscrollbar").data("ejScrollBar"),g=o.find(".e-vscrollbar").data("ejScrollBar");if(this._shapeRSStart){if(t.show(),l.id.indexOf("picture")>-1&&t.addClass("e-ss-picture"),r.css("cursor")==="col-resize"||r.css("cursor")==="row-resize")switch(!0){case this._imgRSWStart:i=this._imgX-u;s=t[0].offsetLeft-i;s>-1&&(t.css({width:a+i,left:s}),this._imgX=u);break;case this._imgRSEStart:i=this._imgX-u;a-i+t[0].offsetLeft+5<b.width()+d.value()&&(t.css({width:a-i}),this._imgX=u);break;case this._imgRSNStart:i=this._imgY-f;h=t[0].offsetTop-i;h>-1&&(t.css({height:v+i,top:h}),this._imgY=f);break;case this._imgRSSStart:i=this._imgY-f;v-i+t[0].offsetTop+5<b.height()+g.value()&&(t.css({height:v-i}),this._imgY=f)}}else this._refreshImgResizing(),u<=e.left+4&&u>=e.left?(r.addClass("e-ss-imgcresize"),this._imgRSWStart=!0):u<=e.left+p&&u>=e.left+p-4?(r.addClass("e-ss-imgcresize"),this._imgRSEStart=!0):o.find(".e-ss-imgcresize").removeClass("e-ss-imgcresize"),f<=e.top+4&&f>=e.top?(r.addClass("e-ss-imgrresize"),this._imgRSNStart=!0):f<=e.top+w&&f>=e.top+w-4?(r.addClass("e-ss-imgrresize"),this._imgRSSStart=!0):o.find(".e-ss-imgrresize").removeClass("e-ss-imgrresize")}}},_deleteShape:function(n,t){var h,i=this.XLObj,f=this._picCellIdx,v=i._dataContainer,s=i.getSheet(n)._shapeMngr,u=v.sheets[n][f.rowIndex][f.colIndex],o,r=t.get(0).id.split("_")[1].replace(/[0-9]/g,""),c=t.get(0),l,a,e=s[r][u[r][0]];s[r].some(function(n,t){return c.id===n.id?(a=t,!0):!1});i._isUndoRedo||i._isPaste||i.XLClipboard._isShape||(o={sheetIndex:n,id:c.id,picIndex:a,reqType:"shape",shapeType:r,action:"create",options:e,range:e.range,img:s.sharedPics[e.data]},o.actCell=i.getCell(f.rowIndex,f.colIndex,n)[0],o.position={height:e.height,width:e.width,top:e.top,left:e.left},o.cnt=t.get(0).id.split("_")[1].replace(/[a-z]/g,""),i._completeAction(o));u[r].some(function(n,t){return c.id===s[r][u[r][t]].id?(l=t,!0):!1});Object.keys(u).length<2&&u[r].length<2?delete u:u[r].length<2?delete u[r]:u[r].splice(l,1);h={rowIndex:f.rowIndex,colIndex:f.colIndex};n===i._getSheetIndex()&&(i.setActiveCell(f.rowIndex,f.colIndex),i.performSelection(h,h));t.remove();i.model.showRibbon&&(r==="picture"?i.XLRibbon._toggleFormatTab():i.XLRibbon._toggleChartDesignTab());i.XLChart._isChartBorderDrawn&&i.XLChart._clearChartRange(i._arrayAsString(i._chartBorder))},_selectImg:function(n){this.XLObj._getContent(this.XLObj.getActiveSheetIndex()).find(".e-ss-activeimg").removeClass("e-ss-activeimg");n.addClass("e-ss-activeimg");this.XLObj.XLSelection._cleanUp(!0)},_refreshImgResizing:function(){this._imgRSEStart=!1;this._imgRSWStart=!1;this._imgRSNStart=!1;this._imgRSSStart=!1},_getShapePropeties:function(n,t,i){var r,u=this.XLObj.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,i);for(r in u)return u[r].id===t?u[r]:void 0},_updateShapeMngr:function(n,t,i){var u=this.XLObj,o=u.getActiveSheetIndex(),e=u.getSheet(o)._shapeMngr,s=!1,r=e[i],h,c={},f;if(u.model.sheets[o]._importRendered&&i==="chart")for(f=0;f<r.length;f++)r[f].dummyId==t.chart._id&&(s=!0,r[f]=t.chart);s||r.push($.extend(!0,{},t[i]));i==="picture"&&(e.sharedPics.indexOf(t[i].data)<0&&e.sharedPics.push(t[i].data),h=e.sharedPics.indexOf(t[i].data),r[r.length-1].data=h);(!u._isPaste||this._insertPic||u.XLClipboard._isShape)&&(c[i]=r.length-1,u.XLEdit._updateDataContainer(n,c),this._insertPic=!1)},_updateShapeObj:function(n){var f,r=this.XLObj,o=r.getActiveSheetIndex(),a=r._dataContainer,e,i,c,t=this._shapeType==="Img"?"picture":"chart",u=this._picCellIdx,s=r.getSheet(o)._shapeMngr,h,l={};r.getObjectLength(this._picCellIdx)||(u=this._picCellIdx=this._getCellIndexFromOffset(n.offsetTop,n.offsetLeft));f=r._getContent(o).find(".e-ss-activeimg");i=a.sheets[o][u.rowIndex][u.colIndex];s[t].some(function(n,t){return f[0].id===n.id?(c=t,!0):!1});e=s[t][c];i[t].some(function(n,r){return f[0].id===s[t][i[t][r]].id?(h=r,!0):!1});l[t]=i[t][h];r.getObjectLength(i)<2&&i[t].length<2?delete i:i[t].length<2?delete i[t]:i[t].splice(h,1);this._picCellIdx=u=this._getCellIndexFromOffset(n.offsetTop,n.offsetLeft);e.height=f.height();e.width=f.width();e.left=f[0].offsetLeft;e.top=f[0].offsetTop;e.rowIndex=u.rowIndex;e.colIndex=u.colIndex;r.XLEdit._updateDataContainer(r.getCell(u.rowIndex,u.colIndex,o)[0],l)},_updateImgBorder:function(n,t,i,r){var u=this.XLObj,c=u.getActiveSheetIndex(),v=n.offsetLeft,y=n.offsetTop,o,p=this._getCellIndexFromOffset(y,v),l=u.getSheet(c)._shapeMngr,f,s,a=new RegExp("\\be-shapebdr.*?\\b","g"),e,h;l.picture.some(function(t,i){return n.id===t.id?(s=i,!0):!1});f=l.picture[s];o={sheetIndex:c,reqType:"shape",shapeType:"picture",action:"border",id:$(u.element.find(".e-ss-activeimg")).attr("id"),prev:{bcolor:u._cOpt.prevColor,bstyle:u._cOpt.prevStyle,bwidth:u._cOpt.prevWidth},cur:{},picIdx:s,cellIdx:p};e=t+" "+i+" "+r;h=this._getImgBorderHashCode({"border-color":r,"border-style":i,"border-width":t});u.XLFormat._writeCssRules(h,u.XLFormat._getCssPropertyAsString({border:{left:e,right:e,top:e,bottom:e}}));f.bcolor=r;f.bstyle=i;f.bwidth=t;n.className.match(a)&&(n.className=n.className.replace(a,""));$(n).addClass(h);o.cur={bcolor:f.bcolor,bstyle:f.bstyle,bwidth:f.bwidth};u._cOpt={};u._completeAction(o)},_getCellIndexFromOffset:function(n,t){for(var e=this.XLObj,h=e.getActiveSheetIndex(),f=e.getSheet(h),o=0,s=0,r=0,i=0,u=f.rowsHeightCollection.length;i<u;i++)if(r+=f.rowsHeightCollection[i],r>n){o=i;break}for(i=0,r=0,u=f.columnsWidthCollection.length;i<u;i++)if(r+=f.columnsWidthCollection[i],r>t){s=i;break}return{rowIndex:o,colIndex:s}},_getImgBorderHashCode:function(n){var i=this.XLObj,t="";return"border-width"in n&&(t=parseInt(n["border-width"])+"N"),"border-style"in n&&(t=t+i.XLFormat._getStyleCode("BorderStyle",n["border-style"])+"N"),"border-color"in n&&(t=t+n["border-color"].replace("#","")),"e-shapebdr"+t},_getImgStyleFromHashCode:function(n){var i=this.XLObj,n=n||"",t={};return n=n.replace("e-shapebdr","").split("N"),n.length>1&&(t["border-width"]=n[0]+"px",t["border-style"]=["","solid","dashed","dotted"][n[1]],t["border-color"]="#"+n[2]),t},_copyImages:function(cell,pics,sheetIdx){var sheet=this.XLObj.model.sheets[sheetIdx],shapeMngr=sheet._shapeMngr,i,len,picObj;for(sheet._importRendered&&(pics=eval(pics)),i=0,len=pics.length;i<len;i++)picObj=shapeMngr.picture[pics[i]],this._createPicture(sheetIdx,cell,shapeMngr.sharedPics[picObj.data],picObj.top,picObj.left,picObj.width,picObj.height,pics[i],picObj.bcolor,picObj.bstyle,picObj.bwidth)},_scrollShape:function(n,t,i,r){var f={position:"none",action:"none"},u=this.XLObj,e=u._getContent(n);parseInt(t.css("width"))+(t.offset().left-u._getContent(n).find(".e-content").offset().left)>u._getContent(n).find(".e-content").width()&&this._imgX<=i?f={position:"horizontal",action:"Increment"}:t.offset().left-e.find(".e-content").offset().left<=0?f={position:"horizontal",action:"Decrement"}:parseInt(t.css("height"))+(t.offset().top-u._getContent(n).find(".e-content").offset().top)>u._getContent(n).find(".e-content").height()&&this._imgY<=r?f={position:"vertical",action:"Increment"}:t.offset().top-e.find(".e-content").offset().top<=0&&(f={position:"vertical",action:"Decrement"});u.XLSelection._scrollCalculation(n,t.get(0),f)},_onKeyscrollShape:function(n,t,i){var r=this.XLObj,u=r._getContent(n).find(".e-content"),f=r._getContent(n).find("#hscrollBar").ejScrollBar("instance"),e=r._getContent(n).find("#vscrollBar").ejScrollBar("instance");u.offset().top+u[0].offsetHeight<=t.offset().top+t[0].offsetHeight&&(i.keyCode==40||i.keyCode==13&&!i.shiftKey)?e.scroll(e.value()+2,!0):t.offset().top-r.model.sheets[n]._frozenHeight<=u.offset().top&&(i.keyCode==38||i.keyCode==13&&i.shiftKey)&&e.value()-2>=0&&e.scroll(e.value()-2,!0);u[0].offsetWidth<=t.offset().left+t[0].offsetWidth&&(i.keyCode==39||i.keyCode==9&&!i.shiftKey)?f.scroll(f.value()+2,!0):t.offset().left-r.model.sheets[n]._frozenWidth<=u.offset().left&&(i.keyCode==37||i.keyCode==9&&i.shiftKey)&&f.value()-2>=0&&f.scroll(f.value()-2,!0)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.chart=function(n){this.XLObj=n;this._shapeCnt=1;this._isChartBorderDrawn=!1};t.spreadsheetFeatures.chart.prototype={createChart:function(n,i){if(this.XLObj.model.allowCharts){i=i||{};var h,e,f,a,u,c,r=this.XLObj,l="chart",o=r._getSheetIndex(i.sheetIdx),v=r.getSheet(o),s=r.getActiveCellElem(o)[0];(r._isUndoRedo&&(h=i.id.split("_")[1].replace(/[a-z]/g,"")),n=n?r.getRangeIndices(n):v.selectedRange,t.isNullOrUndefined(i.top)||t.isNullOrUndefined(i.left)||(i.activeCell=r.XLShape._getCellIndexFromOffset(i.top,i.left)),i.activeCell&&(s=r.getCell(i.activeCell.rowIndex,i.activeCell.colIndex,o)[0]),r.isRange(n)&&s)&&(i.id=h?r._id+"_"+l+h:r._id+"_"+l+this._shapeCnt,i.type=i.type?i.type:"column",i.animation=i.animation?i.animation:!1,i.range=n,i.dataSheetIdx=i.dataSheetIdx?i.dataSheetIdx:o,i.height=i.height?i.height:r.model.chartSettings.height,i.width=i.width?i.width:r.model.chartSettings.width,i.top=i.top?i.top:s.offsetTop,i.left=i.left?i.left:s.offsetLeft,i.isRowColSwitched=i.isRowColSwitched?i.isRowColSwitched:!1,r.isUndefined(i.xRange)&&(c=this._processChartrange(n,i.dataSheetIdx),i.xRange=c.xRange,i.yRange=c.yRange,i.lRange=c.lRange),f=this._processChartSeries(i),i.xRange=f.xRange,i.yRange=f.yRange,i.lRange=f.lRange,r.getActiveSheetIndex()===i.dataSheetIdx&&this._focusChartRange(f.xRange,f.yRange,f.lRange),e=this._renderBaseElem(l,i.top,i.left,h),e.ejChart(this._processChartOptions(i,f.series)),u=e.ejChart("model"),i.theme=u.theme,i.title={text:u.title.text.length?u.title.text:""},i.xAxis={min:u.primaryXAxis.range.min,max:u.primaryXAxis.range.max,interval:u.primaryXAxis.range.interval,title:{text:u.primaryXAxis.title.text.length?u.primaryXAxis.title.text:""},range:f.xRange},i.yAxis={min:u.primaryYAxis.range.min,max:u.primaryYAxis.range.max,interval:u.primaryYAxis.range.interval,title:{text:u.primaryYAxis.title.text.length?u.primaryYAxis.title.text:""},range:f.yRange},i.legend={visible:u.legend.visible,range:f.lRange},r._isUndoRedo||r.XLShape._updateShapeMngr(s,{chart:i},"chart"),r.model.showRibbon&&(r.XLRibbon._chartDesignTabUpdate(e),r.XLRibbon._setChartWidthHeight(i)),r._on(e,t.eventType.mouseDown,r._mouseDownHandler),r._on(e,t.eventType.mouseMove,r._mouseMove),v._importRendered||r._isUndoRedo||r._isPaste||r.XLClipboard._isShape||(a={sheetIndex:o,reqType:"shape",shapeType:"chart",action:"remove",options:i,range:i.range,id:i.id,position:{top:i.top,left:i.left}},r._completeAction(a)))}},resizeChart:function(i,r,u){var f={},e=n("#"+i);e.length&&(t.isNullOrUndefined(r)||(f.height=r.toString()),t.isNullOrUndefined(u)||(f.width=u.toString()),e.ejChart("option",{size:f}))},refreshChart:function(t,i){var r,u="marker",f=this._getShapeObj(t,"chart");if(f){for(r in i)f[r]=i[r];i.type&&(i.commonSeriesOptions={type:i.type},delete i.type);u in i&&(i.commonSeriesOptions?i.commonSeriesOptions.marker={visible:i.marker.visible}:i.commonSeriesOptions={marker:i.marker},delete i[u]);n("#"+t).ejChart("option",i)}},_processChartOptions:function(n,t){var i={commonSeriesOptions:{type:n.type,enableAnimation:n.animation},series:t,canResize:!0,size:{height:n.height.toString(),width:n.width.toString()},primaryXAxis:{minorTicksPerInterval:5,minorGridLines:{visible:!1},minorTickLines:{visible:!1}},primaryYAxis:{minorTicksPerInterval:5,minorGridLines:{visible:!1},minorTickLines:{visible:!1}},enableRotation:!1,depth:100,wallSize:2,tilt:0,rotation:34,perspectiveAngle:90,sideBySideSeriesPlacement:!0,seriesRendering:this.XLObj.model.seriesRendering};return n.enable3D&&(i.enable3D=!0),n.marker&&(i.commonSeriesOptions.marker=n.marker),i.title=n.title||{},i.legend=n.legend||{},i.primaryYAxis=n.primaryYAxis||{},i.primaryXAxis=n.primaryXAxis||{},i},_processChartrange:function(n,i){var o=this.XLObj,h,s,c,r=n[0],u=n[1],f=n[2],e=n[3],l=o.XLEdit.getPropertyValue(r,e,null,i),a=o.XLEdit.getPropertyValue(f,u,null,i);return o.isUndefined(o.XLEdit.getPropertyValue(r,u,null,i))?(h=[r+1,u,f,u],s=[r+1,u+1,f,e],c=[r,u+1,r,e]):t.isNullOrUndefined(a)||o.isNumber(a)?(s=[r,u,f,e],t.isNullOrUndefined(l)||o.isNumber(l)||(c=[r,u,r,e],s[0]=s[0]+1)):t.isNullOrUndefined(l)||o.isNumber(l)?(h=[r,u,f,u],s=[r,u+1,f,e]):(h=[r+1,u,f,u],s=[r+1,u+1,f,e],c=[r,u+1,r,e]),{xRange:h,yRange:s,lRange:c}},_processChartSeries:function(n){n=n||{};var t=this.XLObj,l,w,i=n.xRange,r=n.yRange,u=n.lRange,f,b,e,o,a,v,y,p,s,k,h=0,c=0,d=[];for(b=t.getRangeData(r,!0,null,n.dataSheetIdx),a=r[2]-r[0]+1,v=r[3]-r[1]+1,n.isRowColSwitched?(f=u?t.getRangeData(u,!0,null,n.dataSheetIdx):this._getVirtualXValues(v+1),i&&(e=t._toArrayString(t.getRangeData(i,!0,null,n.dataSheetIdx))),o=a):(f=i?t.getRangeData(i,!0,null,n.dataSheetIdx):this._getVirtualXValues(a+1),u&&(e=t._toArrayString(t.getRangeData(u,!0,null,n.dataSheetIdx))),o=v),w=f.length,k=n.isRowColSwitched?1:o;h<o;){for(s=0,y=[],c=n.isRowColSwitched?c:h;s<w;)l=b[c],y.push({x:f[s],y:t.isNumber(l)?l:""}),c+=k,s++;p={points:y};e&&(p.name=e[h]);d.push(p);h++}return{series:d,xRange:n.isRowColSwitched?u:i,yRange:r,lRange:n.isRowColSwitched?i:u}},_getVirtualXValues:function(n){for(var t=1,i=[];t<n;)i.push(t),t++;return i},_focusChartRange:function(n,t,i){var r=this.XLObj,u=r._chartBorder;this._clearChartRange(r._arrayAsString(u));i&&r.XLSelection._focusBorder({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]},u[0]);n&&r.XLSelection._focusBorder({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]},u[1]);r.XLSelection._focusBorder({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]},u[2]);this._isChartBorderDrawn=!0},_clearChartRange:function(n){this.XLObj.XLSelection._clearBorder(n);this._isChartBorderDrawn=!1},_renderBaseElem:function(i,r,u,f){f=t.isNullOrUndefined(f)?this._shapeCnt:f;var e=this.XLObj,o=n("<div id='"+e._id+"_"+i+f+"' class='e-ss-object' style='top:"+r+"px;left:"+u+"px' ><\/div>");return e._getContent(e.getActiveSheetIndex()).find(".e-content").append(o),e.XLShape._selectImg(o),e._isUndoRedo||this._shapeCnt++,o},_refreshChartElements:function(n,t,i){var r,f=this.XLObj,e=f.getSheet(f._getSheetIndex(i))._shapeMngr.chart,u=e.length;if(u)while(u--)r=e[u],this.XLObj.inRange(r.range,n,t)&&this._refreshChart(r)},_refreshChart:function(t){if(n("#"+t.id).length!=0){var i=n("#"+t.id).data("ejChart"),u={xRange:t.xRange,yRange:t.yRange,lRange:t.lRange,isRowColSwitched:t.isRowColSwitched,dataSheetIdx:t.dataSheetIdx},r;i.model.series.length=0;r=this._processChartSeries(u);i.option({series:r.series})}},_getShapeObj:function(n,t){var i,u=this.XLObj.getSheet(this.XLObj.getActiveSheetIndex())._shapeMngr[t],r=u.length;if(r)while(r--)if(i=u[r],i.id===n)return i},_validateChartRange:function(n,t,i,r){var u=this.XLObj;if(!i)return{msg:u._getLocStr("YAxisMissing")};if(!(u.inRange(n,i[0],i[1])||u.inRange(n,i[2],i[3])))return{msg:u._getLocStr("InvalidYAxis")};if(t)if(u.inRange(n,t[0],t[1])||u.inRange(n,n[2],n[3])){if(t[3]-t[1]!=0)return{msg:u._getLocStr("InvalidXAxisColumns")}}else return{msg:u._getLocStr("InvalidXAxis")};return r&&!(u.inRange(n,r[0],r[1])||u.inRange(n,r[2],r[3]))?{msg:u._getLocStr("InvalidLegend")}:{status:!0}},_renderChartRangeDialog:function(){var t=this.XLObj,i={width:70,height:30,showRoundedCorner:!0,click:n.proxy(this._chartRangeDlgBtnClick,this)},r=n("<div id='"+t._id+"_chartrangedlg' ><div class='e-crcontent'><div class='e-crrow' style='padding-bottom:40px;padding-left:3px' ><div class='e-crlcell' >"+t._getLocStr("XAxisRange")+"<\/div><div class='e-crrcell' ><input type='text' id='"+t._id+"_crxaxis'/><\/div><\/div><div class='e-crrow' style='padding-bottom:40px;padding-left:3px' ><div class='e-crlcell' >"+t._getLocStr("YAxisRange")+"<\/div><div class='e-crrcell' ><input type='text' id='"+t._id+"_cryaxis' /><\/div><\/div><div class='e-crrow' style='padding-bottom:40px;padding-left:3px' ><div class='e-crlcell' >"+t._getLocStr("LegendRange")+"<\/div><div class='e-crrcell' ><input type='text' id='"+t._id+"_crlaxis'/><\/div><\/div><div class='e-cractionbtn' ><button id='"+t._id+"_crok' >"+t._getLocStr("Ok")+"<\/button><button id='"+t._id+"_crcancel'>"+t._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>");t.element.append(r);r.ejDialog({width:300,height:219,enableResize:!1,showOnInit:!1,enableModal:!0,cssClass:"e-ss-dialog",title:t._getLocStr("ChartRange")});n("#"+t._id+"_crok").ejButton(i);n("#"+t._id+"_crcancel").ejButton(i)},_chartRangeDlgBtnClick:function(t){var s,h,i,c,l,a,v,y=!0,f,e,o,r=this.XLObj,u;t.model.text===r._getLocStr("Ok")&&(h=document.getElementById(r._id+"_chart").value,u=this._getShapeObj(h,"chart"),l=n("#"+r._id+"_crxaxis").val(),a=n("#"+r._id+"_cryaxis").val(),v=n("#"+r._id+"_crlaxis").val(),l.length&&(f=r.getRangeIndices(l)),a.length&&(e=r.getRangeIndices(a)),v.length&&(o=r.getRangeIndices(v)),c=this._validateChartRange(u.range,f,e,o),c.status?(u.xRange=f,u.yRange=e,u.lRange=o,this._refreshChart(u),i=n("#"+h).ejChart("model"),u.xAxis={min:i.primaryXAxis.range.min,max:i.primaryXAxis.range.max,interval:i.primaryXAxis.range.interval,title:{text:i.primaryXAxis.title.text.length?i.primaryXAxis.title.text:""},range:f},u.yAxis={min:i.primaryYAxis.range.min,max:i.primaryYAxis.range.max,interval:i.primaryYAxis.range.interval,title:{text:i.primaryYAxis.title.text.length?i.primaryYAxis.title.text:""},range:e},u.legend={visible:i.legend.visible,range:o},r.getActiveSheetIndex()===u.dataSheetIdx&&this._focusChartRange(f,e,o)):(s=n("#"+r._id+"_alertdlg"),y=!1,r._renderAlertDlgContent(s,"Alert",c.msg),s.ejDialog("open")));y&&n("#"+r._id+"_chartrangedlg").ejDialog("close")}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.print=function(n){this.XLObj=n;this._printHeight=800;this._pageHeight=800;this._pageWidth=750;this._marginTop=30;this._marginBottom=150;this._printRowLabels=!1;this._isPrintSelection=!1;this._stRow=0;this._stColumn=0};t.spreadsheetFeatures.print.prototype={_printSetting:function(n){this.XLObj.model.pageSize=n;switch(n){case t.Spreadsheet.pageSize.A4:this._printHeight=800;this._pageHeight=800;this._pageWidth=750;this._marginTop=30;this._marginBottom=150;break;case t.Spreadsheet.pageSize.A3:this._printHeight=1350;this._pageHeight=1310;this._pageWidth=860;this._marginTop=30;this._marginBottom=150;break;case t.Spreadsheet.pageSize.Letter:this._printHeight=1e3;this._pageHeight=950;this._pageWidth=860;this._marginTop=30;this._marginBottom=60}},printSelection:function(){var i=this.XLObj,o,r,e=i.getActiveSheetIndex(),u=i.getSheet(e)._selectedCells,l=u[u.length-1],w=l.rowIndex,a=l.colIndex,h,f,c=t.buildTag("table"),v=t.buildTag("colgroup"),y=i._getContent(e).find("col"),p=t.buildTag("div#printDiv"),s;for(i._detachTable=i._getContent(e).find(".e-content >table"),i._detachTable.detach(),i._isPrint=!0,r=u[0].colIndex;r<a;r++)n(y[r].outerHTML).attr("id","cc").appendTo(v);for(c.append(v),o=u[0].rowIndex;o<=w;o++){for(f=i.getCell(o,0),h=f.parent().hasClass("e-fr-hide")?t.buildTag("tr.e-fr-hide","",{height:parseInt(f[0].parentNode.style.height)}):t.buildTag("tr","",{height:parseInt(f[0].parentNode.style.height)}),r=u[0].colIndex;r<=a;r++)f=i.getCell(o,r),n(y[r]).hasClass("e-fc-hide")&&i.addClass(f[0],"e-fc-hide"),n(f[0].outerHTML).attr("id","s").appendTo(h);c.append(h)}this._stRow=u[0].rowIndex;this._stCol=u[0].colIndex;this._isPrintSelection=!0;s=n(c[0].outerHTML).attr("id","print");i._getContent(e).find(".e-content").append(i._detachTable);i._isPrint=!1;this._printRowLabels?this._calculateTabCount(p,e,s):this._constructSheet(p,e,s,s.get(0).rows)},printSheet:function(){var u=t.buildTag("div#printDiv"),r=this.XLObj,i=r.getActiveSheetIndex(),f=n(r._getContent(i).find(".e-content .e-table")[0].outerHTML).attr("id","print");this._printRowLabels?this._calculateTabCount(u,i,f):this._constructSheet(u,i,f,n(r._getContent(i).find(".e-content .e-table")).get(0).rows)},_calculateTabCount:function(t,i,r){for(var s,e=[],f=0,o=n(this.XLObj.getRows(i)[1]).parents("table").find("col"),u=0,h=o.length;u<h;u++)f+=parseInt(o[u].style.width),f>=this._pageWidth&&(e.push({tCount:1,cellCount:u}),f=0);s={xlObj:this.XLObj,element:e,table:r,printDiv:t,Index:i};this.XLObj._trigger("beforePrint",s)},_calculateCellRowCount:function(n,t,i){for(var f=this.XLObj,e,p=[],w=[],s=0,h=0,c=12,l=40,a=0,v=0,u,y=f._getContent(f.getActiveSheetIndex()).find("col"),r=t,o=n[0].cells.length;r<o;r++)if(s+=parseInt(y[r].style.width),p.push(parseInt(y[r].style.width)),s>=this._pageWidth){v=c=r;break}else e=Math.floor((this._pageWidth-s)/f.model.columnWidth),v=c=n[i].cells.length+e;for(u=i,o=n.length;u<o;u++)if(h+=parseInt(n[u].style.height),w.push(parseInt(n[u].style.height)),h>=this._pageHeight){a=l=u;break}else e=Math.floor((this._pageHeight-h)/f.model.rowHeight),a=l=n.length+e;return{startCell:t,endCell:v,startRow:i,endRow:a,cellCount:c,rowCount:l}},_constructSheet:function(n,i,r,u){var h=t.buildTag("div .e-spreadsheet","",{}),e=0,f=this._calculateCellRowCount(u,0,0),o=u[0].cells.length,s=u.length;e=Math.ceil(o/f.cellCount);e=e*Math.ceil(s/f.rowCount);e==1&&(f.rowCount=u.length);this._contructPrintableElement(i,n,h,r,u,s,o,e,f.cellCount,f.rowCount,f.startRow,f.startCell,f.endRow,f.endCell)},_contructPrintableElement:function(i,r,u,f,e,o,s,h,c,l,a,v,y,p){for(var ut,ot,g,st,ft=!1,rt,k=this.XLObj,ht=t.buildTag("div"),nt,ct,et=!1,lt=0,tt,w,it,d,at,b,yt=k._getContent(i).find("col"),vt=h;vt>0;vt--){for(nt=this._calculateCellRowCount(e,v,a),v=nt.startCell,p=nt.endCell,a=nt.startRow,y=nt.endRow,c=nt.cellCount,l=nt.rowCount,rt=this._constructTable(i,v,p),k.model.sheets[i].printHeader&&this._constructHeaders(v,p,y,rt),ct=this._isPrintSelection?a<this._stRow?this._stRow:a:a,w=a;w<y;w++){for(t.isNullOrUndefined(f[0].rows[w])?(d=n(f[0].rows[0].cells[0]),g=t.buildTag("tr","",{height:k.model.rowHeight})):(d=n(f[0].rows[w].cells[0]),g=d.parent().height()>0?t.buildTag("tr","",{height:d.parent().height()}):t.buildTag("tr","",{height:k.model.rowHeight})),d.parent().hasClass("e-fr-hide")&&g.addClass("e-fr-hide"),it=v;it<p;it++)k.model.sheets[i].printHeader&&!ft&&(st='<td class="{0}">{1}<\/td>',n(String.format(st,"e-rowcell e-header",ct+w+1)).appendTo(g),ft=!0),n(e[w]).length>0&&n(e[w].cells[it]).length>0?(d=n(e[w].cells[it].outerHTML).attr("id","ss"),n(yt[it]).hasClass("e-fc-hide")&&d.addClass("e-fc-hide"),d.appendTo(g)):t.buildTag("td.e-rowcell").appendTo(g);ft=!1;rt.append(g)}if(r.append(rt),y<o)a=y,y=y+l;else if(y>=o){if(p>=s)break;a=0;y=l;v=p;p=p+c}}for(w=r.find("table").length-1;w>=0;--w)tt=n(r.find("table")[w]),et||this._checkEmptyRow(i,tt,"first"),lt=k.model.sheets[i].printHeader?tt.find("tr.empty").length+1:tt.find("tr.empty").length,(tt.find("tr").length!==lt||et)&&(n(tt.get(0).outerHTML).attr("id","cc").appendTo(ht),et=!0);for(b=ht.find("table"),w=b.length-1;w>=0;--w)b.length-1!==w?(k.model.pageSize===t.Spreadsheet.pageSize.A4&&b.eq(w).css({"margin-top":300,"margin-bottom":300}),k.model.pageSize===t.Spreadsheet.pageSize.A3&&b.eq(w).css({"margin-top":120,"margin-bottom":110}),k.model.pageSize===t.Spreadsheet.pageSize.Letter&&(k.model.sheets[i].printHeader?b.eq(w).css({"margin-top":70,"margin-bottom":50}):b.eq(w).css({"margin-top":0,"margin-bottom":50}))):b.length-1===w&&(k.model.sheets[i].printHeader||b.eq(w).css({"margin-top":30,"margin-bottom":0})),w===0&&(b.length>1&&b.eq(w).css({"margin-top":120,"margin-bottom":0}),this._checkEmptyRow(i,b.eq(w),"last")),n(b[w].outerHTML).attr("id","cc").appendTo(u);for(ut=n("head").find("link"),ot=[],w=0,at=ut.length;w<at;w++)if(ut[w].href.indexOf("ej.pivoticon.css")>-1){ot.push(ut[w]);break}k._trigger("_pivotPrint",{element:u});this._isPrintSelection=!1;this.print(u,ot,i)},_checkEmptyRow:function(t,i,r){for(var o,f,e=i.find("tr"),u=e.length-1;u>=0;--u)if(o=n(e[u]).find(".e-rowcell").length,f=n(e[u]).find(".e-rowcell:empty").length,f=this.XLObj.model.sheets[t].printHeader?f+1:f,f===o)n(e[u]).addClass("empty");else{n(e[u]).addClass("nonempty");break}r==="last"&&(i.find("tr.empty").find("td").removeClass("e-rowcell"),i.find("tr.empty").find("td.e-header").text(""))},_constructTable:function(i,r,u){var e=t.buildTag("colgroup"),s=this.XLObj,h=t.buildTag("table.e-table","",{height:this._printHeight,"margin-top":this._marginTop,"margin-bottom":this._marginBottom}),c=s._getContent(s.getActiveSheetIndex()).find("col"),o,f;for(s.model.sheets[i].printHeader&&(o='<col class="{0}" style= "width: 30px;" >{1}<\/col>',n(o).appendTo(e)),f=r;f<u;f++)n(c[f]).length>0?n(c[f].outerHTML).attr("id","cc").appendTo(e):(o='<col class="{0}" style= "width: 60px;" >{1}<\/col>',n(o).appendTo(e));return h.append(e),h},_constructHeaders:function(i,r,u,f){var h=t.buildTag("tr","",{height:30}),c,l,s,a,v,o=this.XLObj,y=!1,w=o._getContent(o.getActiveSheetIndex()).find("col"),p="e-rowcell",e;for(this._isPrintSelection&&i<this._stCol&&(r=r+(this._stCol-i),i=this._stCol),c='<td class="{0}" style= "width: 30px;" >{1}<\/td>',l='<div class = "{0}" > {1}<\/div>',e=i;e<=r;e++)y?(s=o._generateHeaderText(o.getActiveSheetIndex(),e),p=n(w[e-1]).hasClass("e-fc-hide")?"e-rowcell e-fc-hide":"e-rowcell"):(s="",y=!0),a=String.format(l,"e-headercelldiv",s),v=String.format(c,p,a),n(h[0]).append(v);f.append(h)},print:function(i,r,u){var e,h,o,s=t.buildTag("div"),c=i.clone(),f=window.open("","print","'height=452,width=1024,tabbar=no");s.append(c);f.document.write("<!DOCTYPE html>");t.browserInfo().name==="msie"?(o="",r.length>0&&n(r).each(function(t,i){n(i).attr("href",i.href);o+=i.outerHTML}),f.document.write("<html><head><\/head><body>"+o+s[0].innerHTML+"<\/body><\/html>")):(o="",f.document.write("<html><head>"),r.length>0&&n(r).each(function(t,i){n(i).attr("href",i.href);o+=i.outerHTML}),f.document.writeln(o+"<\/head><body>"),f.document.writeln(s[0].innerHTML+"<\/body><\/html>"));n(f.document.head).append("<style><\/style>");e=n(document).find("style#"+this.XLObj._id+"_sscustomformat").text();h=n(f.document.head).find("style");e=this.XLObj.model.sheets[u].printGridlines?e.concat(".e-spreadsheet .e-rowcell {border: 1px solid;line-height: 14px;width: auto;cursor:cell;overflow:hidden;}.e-spreadsheet .e-table{border-collapse: collapse}"):e.concat(".e-spreadsheet .e-rowcell {line-height: 14px;width: auto;cursor:cell;overflow:hidden;}.e-spreadsheet .e-table{border-collapse: collapse}");e=e.concat(".e-spreadsheet .e-fr-hide { display: none !important;}.e-spreadsheet .e-fc-hide { display: none !important;}");h.append(e);f.focus();n("#print").remove();setTimeout(function(){t.isNullOrUndefined(f.window)||(t.isNullOrUndefined(f.location)||(f.print(),f.location.reload()),setTimeout(function(){f.close()},2e3))},2e3)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.scroller=function(n){this.XLObj=n};t.spreadsheetFeatures.scroller.prototype={_getColWidths:function(n){var r=this.XLObj,f=r.getSheet(n),u=r.getRows(n)[1],i,e;if(!t.isNullOrUndefined(u))for(f._colWidthCollection=[],i=r.getFrozenColumns(n),e=u[0].cells.length;i<e;i++)f._colWidthCollection.push({idx:i,value:u[0].cells[i].offsetLeft});return r._colWidthCollection},_getColWidthsAfterInsert:function(n){var i=this.XLObj,u=i.getSheet(n),f=i.getRows(n)[1],o=i._getContent(n).find("col"),r,e;if(!t.isNullOrUndefined(f))for(u._colWidthCollection=[{idx:i.getFrozenColumns(n),value:1}],r=i.getFrozenColumns(n)+1,e=f[0].cells.length;r<e;r++)u._colWidthCollection.push({idx:r,value:u._colWidthCollection[u._colWidthCollection.length-1].value+parseInt(o[r].style.width)});return i._colWidthCollection},_getRowHeights:function(n){var r=this.XLObj,f=r.getSheet(n),u=r.getRows(n)[1],i,e;if(!t.isNullOrUndefined(u))for(f._rowHeightCollection=[],i=r.getFrozenRows(n),e=u.length;i<e;i++)f._rowHeightCollection.push({idx:i,value:u[i].offsetTop});return r._rowHeightCollection},_getRowHeightsAfterInsert:function(n){var i=this.XLObj,f=i.getRows(n)[1],u=i.getSheet(n),r,e;if(!t.isNullOrUndefined(f))for(u._rowHeightCollection=[{idx:i.getFrozenRows(n),value:1}],r=i.getFrozenRows(n)+1,e=f.length;r<e;r++)u._rowHeightCollection.push({idx:r,value:u._rowHeightCollection[u._rowHeightCollection.length-1].value+parseInt(f[r].style.height)});return i._rowHeightCollection},_createScroller:function(i,r){var o=this.XLObj,u=o._getContent(i),f=t.buildTag("div#vscrollBar"),e=t.buildTag("div#hscrollBar");u.append(f).append(e);u.find(".e-content").width(r.width-18).height(r.height-18);f.ejScrollBar({orientation:"vertical",height:r.height-18,minimum:0,viewportsize:r.height,infiniteScrolling:!0,scroll:n.proxy(this._scrollSpreadY,this)});e.ejScrollBar({orientation:"horizontal",width:r.width-18,minimum:0,infiniteScrolling:!0,viewportsize:r.width,scroll:n.proxy(this._scrollSpreadX,this)});this._refreshScroller(i,"initial","all")},_hScroller:function(n){return this.XLObj._getContent(n).find("#hscrollBar").data("ejScrollBar")},_vScroller:function(n){return this.XLObj._getContent(n).find("#vscrollBar").data("ejScrollBar")},_refreshScroller:function(n,t,i){var f=this.XLObj,r=this._hScroller(n),u=this._vScroller(n),e,s,o,h;(i==="all"||i==="horizontal")&&(this._getColWidthsAfterInsert(n,0),e=f._getContent(n).find(".e-content").width(),s=f.model.sheets[n]._colWidthCollection[f.model.sheets[n]._colWidthCollection.length-1].value+f.model.sheets[n].columnsWidthCollection[0]-f.getSheet(n)._frozenWidth,r._scrollData.handleSpace=e-2*r.model.buttonSize,r._scrollData.handle=Math.floor((e-18)/s*r._scrollData.handleSpace),r._scrollData.handle<15&&(r._scrollData.handle=15),r.model.maximum=s-e,r._scrollData.scrollable=s-e,r._scrollData.onePx=r._scrollData.scrollable/(r._scrollData.handleSpace-r._scrollData.handle),r["e-hhandle"].width(r._scrollData.handle),r.model.scrollLeft=r._scrollData.handleSpace-r._scrollData.handle);(i==="all"||i==="vertical")&&(this._getRowHeightsAfterInsert(n,0),o=f._getContent(n).find(".e-content").height(),h=f._getContent(n).find(".e-content .e-table").height()-f.getSheet(n)._frozenHeight+f.getSheet(n)._fpHiddenHeight,u._scrollData.handleSpace=o-2*u.model.buttonSize,u._scrollData.handle=Math.floor((o-18)/h*u._scrollData.handleSpace),u._scrollData.handle<15&&(u._scrollData.handle=15),u.model.maximum=h-o,u._scrollData.scrollable=h-o,u._scrollData.onePx=u._scrollData.scrollable/(u._scrollData.handleSpace-u._scrollData.handle),u["e-vhandle"].height(u._scrollData.handle),u.model.scrollTop=u._scrollData.handleSpace-u._scrollData.handle)},_changeTopSpread:function(n,t,i,r){var f=n.value(),u=f+i;t.step=i;(t.enableRTL?u<t.scrollable:u>t.scrollable)&&(u=t.scrollable);(t.enableRTL?u>0:u<0)&&(u=0);n.scroll(u,r)},_spreadMouseWheel:function(n){var r=this.XLObj;if(n.stopImmediatePropagation(),n.preventDefault(),!r.element.find(".e-excelfilter.e-dlgcontainer").is(":visible")){var t=0,u=n,i=this._vScroller(r.getActiveSheetIndex());(n=n.originalEvent,n.wheelDelta?(t=-n.wheelDelta/120,window.opera&&parseFloat(window.opera.version,10)<10&&(t=-t)):n.detail&&(t=n.detail/3),t)&&this._changeTopSpread(i,i._scrollData,t*i._scrollData.scrollOneStepBy,"wheel")&&(n.preventDefault?n.preventDefault():u.preventDefault())}},_scrollSpreadX:function(n){var i=this.XLObj,r=i.getActiveSheetIndex(),f,u=this._hScroller(r),s=i._getContent(r).find(".e-table").find("col"),o,e;n.reachedEnd=Math.ceil(parseFloat(u.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(u.element.find(".e-hhandle").width()))>=i.element.find(".e-hhandlespace").width()-1;f=n.scrollLeft;i.getFrozenColumns(r)>0&&(n.cancel=!0,n.scrollData!=null&&n.scrollData.dimension!="height"&&(!n.reachedEnd||n.scrollData.step<0)&&(o=i.XLFreeze._getLeftColumn(f,r),e=o.imaginaryIndex,i.XLFreeze._changehHandlerPosition(f),e>i.model.sheets[r]._currentLeftFrozenColumn?i._getContent(r).find(".e-content").width()<=i._getContent(r).find(".e-table").width()-i.model.columnWidth&&i.XLFreeze._showHideColumn(r,i.model.sheets[r]._currentLeftFrozenColumn,e,"hide",i.model.sheets[r]._colWidthCollection[o.i].value):e<i.model.sheets[r]._currentLeftFrozenColumn&&i.XLFreeze._showHideColumn(r,e,i.model.sheets[r]._currentLeftFrozenColumn+1,"show",i.model.sheets[r]._colWidthCollection[o.i].value)));i.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&n.reachedEnd&&n.scrollData.step>-1&&(n.cancel=!0,this._scrollRight(r),this._refreshScroller(r,"refresh","horizontal"),u.element.find(".e-hhandle").css("left",u._scrollData.handleSpace-(u._scrollData.handle+1)),f=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,i.getFrozenColumns(r)>0&&i._getContent(r).find(".e-content").width()<=i._getContent(r).find(".e-table").width()-i.model.sheets[r]._firstCol.value&&i.XLFreeze._hideColumn(r),u.value(f));n.scrollLeft=f;i.getFrozenColumns(r)<1&&i._getContent(r).find(".e-content").scrollLeft(n.scrollLeft,n.scrollData.onePx);this._getFirstColumn(r);i.getFrozenColumns(r)>0&&(i.model.allowComments&&i.XLComment._updateCmntArrowPos(),i.XLSelection.refreshSelection(),i.XLDragFill.positionAutoFillElement(),s.eq(i.getActiveCellElem(r).index())[0].className.indexOf("e-fc-hide")>-1&&i.XLDragFill.hideAutoFillElement())},_scrollSpreadY:function(n){var i=this.XLObj,r=i.getActiveSheetIndex(),f,u=this._vScroller(r),o,e;n.reachedEnd=Math.ceil(parseFloat(u.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(u.element.find(".e-vhandle").height()))>=u.element.find(".e-vhandlespace").height()-1;f=n.scrollTop;i.getFrozenRows(r)>0&&n.scrollData!=null&&n.scrollData.dimension!="width"&&(n.cancel=!0,i.XLFreeze._changevHandlerPosition(f),n.reachedEnd||(o=i.XLFreeze._getTopRow(f,r),e=o.imaginaryIndex,e>i.model.sheets[r]._currentTopFrozenRow?i._getContent(r).find(".e-content").height()<=i._getContent(r).find(".e-table").height()-i.model.rowHeight&&i.XLFreeze._showHideRow(r,i.model.sheets[r]._currentTopFrozenRow,e,"hide",i.model.sheets[r]._rowHeightCollection[o.i].value):e<i.model.sheets[r]._currentTopFrozenRow&&i.XLFreeze._showHideRow(r,e,i.model.sheets[r]._currentTopFrozenRow+1,"show",i.model.sheets[r]._rowHeightCollection[o.i].value)));i.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&n.reachedEnd&&n.scrollData.step>-1&&(this._scrollBottom(r),this._refreshScroller(r,"refresh","vertical"),u.element.find(".e-vhandle").css("top",u._scrollData.handleSpace-u._scrollData.handle),f=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,i.getFrozenRows(r)>0&&i._getContent(r).find(".e-content").height()<=i._getContent(r).find(".e-table").height()-i.model.sheets[r]._firstRow.value&&i.XLFreeze._hideRow(r),n.cancel=!0,u.value(f));n.scrollTop=f;i.getFrozenRows(r)<1&&i._getContent(r).find(".e-content").scrollTop(n.scrollTop,u._scrollData.onePx);this._getFirstRow(r);i.getFrozenRows(r)>0&&(i.model.allowComments&&i.XLComment._updateCmntArrowPos(),i.XLSelection.refreshSelection(),i.XLDragFill.positionAutoFillElement(),i.getActiveCellElem(r).parent()[0].className.indexOf("e-fr-hide")>-1&&i.XLDragFill.hideAutoFillElement())},_scrollX:function(i){var r=this.XLObj,u=this._hScroller(i),o,f=[1],h=r._getContent(i).find("tbody").eq(0).prev(),e,s;for(r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&this._scrollRight(i),u.model.maximum=u.model.maximum+r.model.columnWidth,u._scrollData.scrollable=u._scrollData.scrollable+r.model.columnWidth,this._refreshScroller(i,"refresh","horizontal"),u.element.find(".e-hhandle").css("left",u._scrollData.handleSpace-(u._scrollData.handle+1)),o=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,u.value(o),e=0,s=r.model.sheets[i]._fCol;e<s;e++)f.push(f[f.length-1]+n(h.find("col")[e]).width());r.getFrozenColumns(i)>0&&r._getContent(i).find(".e-content").width()<=r._getContent(i).find(".e-table").width()-(f[f.length-1]+r.model.columnWidth)&&r.XLFreeze._hideColumn(i);r.getFrozenColumns(i)<1&&r._getContent(i).find(".e-content").scrollLeft(o,u._scrollData.onePx);this._getFirstColumn(i)},_scrollY:function(i){var r=this.XLObj,u=this._vScroller(i),o,f=[1],h=r.getRows(i)[1],e,s;for(r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&this._scrollBottom(i),u.model.maximum=u.model.maximum+r.model.rowHeight,u._scrollData.scrollable=u._scrollData.scrollable+r.model.rowHeight,this._refreshScroller(i,"refresh","vertical"),u.element.find(".e-vhandle").css("top",u._scrollData.handleSpace-(u._scrollData.handle+1)),o=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,u.value(o),e=0,s=r.model.sheets[i]._fRow;e<s;e++)f.push(f[f.length-1]+n(h[e]).height());r.getFrozenRows(i)>0&&r._getContent(i).find(".e-content").height()<=r._getContent(i).find(".e-table").height()-(f[f.length-1]+r.model.rowHeight)&&r.XLFreeze._hideRow(i);r.getFrozenRows(i)<1&&r._getContent(i).find(".e-content").scrollTop(o,u._scrollData.onePx);this._getFirstRow(i)},_getFirstRow:function(n){var r=this.XLObj,u,f=this._vScroller(n),i=r.model.sheets[n]._rowHeightCollection,t,e;for(u=parseInt(f.element.find(".e-vhandle").css("top"))*f._scrollData.onePx,t=0,e=i.length;t<e;t++)if(i[t].value>=u){r.model.sheets[n]._topRow={idx:t,value:i[t].value};break}},_getFirstColumn:function(n){var r=this.XLObj,u,f=this._hScroller(n),i=r.model.sheets[n]._colWidthCollection,t,e;for(u=parseInt(f.element.find(".e-hhandle").css("left"))*f._scrollData.onePx,t=0,e=i.length;t<e;t++)if(i[t].value>=u){r.model.sheets[n]._leftCol={idx:t,value:i[t].value};break}},_scrollSelectedPosition:function(n,t){var e,u,r=this.XLObj,o=this._hScroller(n),f=this._vScroller(n),i=r.getCell(t.rowIndex,t.colIndex);(parseInt(i.width())+(i.offset().left-r._getContent(n).find(".e-content").offset().left)>r._getContent(n).find(".e-content").width()||i.offset().left-r._getContent(n).find(".e-content").offset().left<=0)&&(e=i.offset().left-(o._scrollData.handleSpace+o.model.buttonSize),e<0&&(e=0),o.scroll(e));(parseInt(i.height())+(i.offset().top-r._getContent(n).find(".e-content").offset().top)>r._getContent(n).find(".e-content").height()||i.offset().top-r._getContent(n).find(".e-content").offset().top<=0)&&(u=i.offset().top-(f._scrollData.handleSpace+f.model.buttonSize),u<0&&(u=0),u>f._scrollData.scrollable&&(u=f._scrollData.scrollable),f.scroll(u))},_rowTemplate:function(n){for(var u="",t=this.XLObj,i,e=t.model.sheets[n].hideColsCollection,r=0,f=t.model.sheets[n].colCount;r<f;r++)i=r===t.getFrozenColumns(n)-1?"e-rowcell e-frozecolumn":"e-rowcell",t.model.sheets[n].showGridlines||(i=i.concat(" e-hborder")),u+=String.format('<td class="{0}" style="{2}"  >{1}<\/td>',i,"");return String.format("<tr style='{0}'>"+u+"<\/tr>","height:"+t.model.rowHeight+"px;")},_rowHeaderTemplate:function(n){var t;return t=String.format('<td class="{0}"  >{1}<\/td>',"e-rowheader",n),String.format("<tr style='{0}'>"+t+"<\/tr>","height:"+this.XLObj.model.rowHeight+"px;")},_columnTemplate:function(n){var t,i=this.XLObj,r=i.getActiveSheetIndex(),u=i.model.sheets[r].hideRowsCollection;return t=n===i.getFrozenRows(r)-1?"e-rowcell e-frrow":"e-rowcell",i.model.sheets[r].showGridlines||(t=t.concat(" e-hborder")),String.format('<td class="{0}" style="{2}" >{1}<\/td>',t,"")},_colGroupTemplate:function(n){return String.format("<col style = '{0}'><\/col>","width:"+this.XLObj.model.sheets[n].columnWidth+"px;")},_columnHeaderTemplate:function(n,t){var i,r;return i=this.XLObj._generateHeaderText(t,n),r=String.format('<div class = "{0}" > {1}<\/div>',"e-headercelldiv",i),String.format('<th class="{0}"  >{1}<\/th>',"e-headercell",r)},_createNewRow:function(t,i,r,u){var o,e,c,s,l,f=this.XLObj,a=f.XLSelection,h,v;for(c=this._rowTemplate(t),o=f._getContent(t).find("tbody").get(0),s=f._getJSSheetRowHeaderContent(t).find("tbody").get(0),i===-1||r>-1&&i>-1&&u==="shift"?(n(s).append(this._rowHeaderTemplate(parseInt(s.lastChild.textContent)+1)),n(o).append(c),u=="shift"&&(n(o).find("tr:last").find("td:last").remove(),n(o).find("tr").eq(i).find("td").eq(r-1).after(this._columnTemplate()))):(e=o.insertRow(i),n(e).height(f.model.rowHeight),n(e).append(n(c)[0].innerHTML),e=s.insertRow(i),n(e).height(f.model.rowHeight),n(e).append("<td class='e-rowheader'><\/td>")),f.model.sheets[t].rowCount=f.model.sheets[t].rowCount+1,f.model.sheets[t].rowsHeightCollection.push(f.model.rowHeight),this._getRowHeightsAfterInsert(t,f.model.sheets[t]._fRow),f.model.sheets[t].dataSource.push({}),l=n(s).find("td"),h=0,v=l.length;h<v;h++)n(l[h]).text(h+1);(a._isColSelected||a._isSheetSelected)&&a.refreshSelection()},_createNewColumn:function(i,r,u,f){var e,o,c,s=this.XLObj,it=s.getSheet(i),rt=s.XLSelection,h,y,w,b,ut,a,l,p,k,ft,st,et,ot,d,g=!1,nt,v,tt;for(h=s._getContent(i).find("tbody").get(0),y=s._getJSSheetHeader(i).find("tr").get(0),w=n(h).prev(),b=n(y).parent().prev(),ut=s._generateColCount(n.trim(y.lastChild.textContent)),v=s.model.sheets[i].filterSettings.tableRange,e=0,c=v.length;e<c;e++)if(d=v[e].multifilterIdx,r.colIndex>d[0]&&u.colIndex<d[d.length-1]){g=!0;nt=v[e].startRow-1;v=v[e];break}if(r.colIndex===-1||r.colIndex>-1&&r.rowIndex>-1&&f==="shift"){if(r.colIndex===-1&&f==="insert"){for(p=this._columnHeaderTemplate(ut+1,i),n(y).append(p),a=this._colGroupTemplate(i),n(b).append(a),e=0,c=h.rows.length;e<c;e++)l=this._columnTemplate(e),n(h.rows[e]).append(l);w.append(a)}if(f==="shift"){for(tt=ut,e=r.colIndex;e<=u.colIndex;e++)p=this._columnHeaderTemplate(tt+1,i),n(y).append(p),a=this._colGroupTemplate(i),b.append(a),w.append(a),tt=tt+1;for(e=0,c=h.rows.length;e<c;e++)for(o=r.colIndex;o<=u.colIndex;o++)l=this._columnTemplate(e),n(h.rows[e]).append(l);if(s._insDelStatus.indexOf("insert")>-1)for(e=r.rowIndex;e<=u.rowIndex;e++){for(o=r.colIndex;o<=u.colIndex;o++)n(h).find("tr").eq(e).find("td:last").remove(),l=this._columnTemplate(e),n(h).find("tr").eq(e).find("td").eq(o).before(l);s.XLFilter._insertFilterIcon(e,o,v,nt,g)}else for(e=r.rowIndex;e<=u.rowIndex;e++){for(o=u.colIndex;o>=r.colIndex;o--)n(h).find("tr").eq(e).find("td").eq(o).remove(),l=this._columnTemplate(e),n(h).find("tr").eq(e).append(l);s.XLFilter._insertFilterIcon(e,o,v,nt,g)}}}else{if(s._insDelStatus.indexOf("insert")>-1){for(e=r.colIndex;e<=u.colIndex;e++)p=this._columnHeaderTemplate(e+1,i),n(y).find("th").eq(e).before(p),a=this._colGroupTemplate(i),b.find("col").eq(e).before(a),w.find("col").eq(e).before(a);for(e=0,c=h.rows.length;e<c;e++){for(o=r.colIndex;o<=u.colIndex;o++)l=this._columnTemplate(e),n(h.rows[e]).find("td").eq(o).before(l);s.XLFilter._insertFilterIcon(e,o,v,nt,g)}}else{for(e=u.colIndex;e>=r.colIndex;e--)n(y).find("th").eq(e).remove(),b.find("col").eq(e).remove(),w.find("col").eq(e).remove();for(e=0,c=h.rows.length;e<c;e++)for(o=u.colIndex;o>=r.colIndex;o--)n(h.rows[e]).find("td").eq(o).remove()}for(ft=n(y).find("th"),e=0,c=ft.length;e<c;e++)n(ft[e]).find(".e-headercelldiv").text(s._generateHeaderText(i,e+1))}st=n.trim(n(p).text());k=n(l).text();s.model.sheets[i].columns.push({field:st,type:k!=null?k.getDay?"date":typeof k:null,width:n(l).width()});et=s.XLEdit._EditTemplate;ot=t.buildTag("div","",{},{id:it.columns[it.columns.length-1].field+"_Edit"});s.XLEdit._initCellEditType(it.columns.length-1,ot);et.append(ot);s.XLEdit._EditTemplate=et;s.model.sheets[i].colCount=s.model.sheets[i].colCount+1;s.model.sheets[i].columnsWidthCollection.push(s.model.columnWidth);this._getColWidthsAfterInsert(i);(rt._isRowSelected||rt._isSheetSelected)&&rt.refreshSelection()},_insertColHeaders:function(t,i,r){var f=this._columnHeaderTemplate(i+1,t),u;n(r).append(f);u=this._colGroupTemplate(t);n(r.parentNode.previousSibling).append(u)},_scrollBottom:function(n){this._createNewRow(n,-1,-1,"insert")},_scrollRight:function(n){var t={rowIndex:-1,colIndex:-1};this._createNewColumn(n,t,t,"insert")}}}(jQuery,Syncfusion)});