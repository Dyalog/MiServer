/*!
*  filename: ej.mobile.listbox.min.js
*  version : 12.2.0.36
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function($,ej,undefined){ej.widget("ejmListbox","ej.mobile.Listbox",{_setFirst:!0,_rootCSS:"e-m-lb",defaults:{autoAdjustHeight:!1,height:undefined,width:undefined,selectedItemIndex:-1,showScrollbars:!0,headerTitle:"Title",showHeaderBackButton:!1,headerBackButtonText:undefined,showHeader:!0,autoAdjustScrollHeight:!0,headerBackButtonTap:undefined,adjustFixedPosition:!0,enableNativeScrolling:ej.isAndroid()&&ej.isLowerAndroid()||ej.isWindows()&&ej.isMobile()||ej.isIOS7()?!1:ej.isDevice()||ej.isWindows()&&!ej.isMobile()?!0:!1,hideHeaderForUnsupportedDevice:!1,enableGroupList:!1,enableAjax:!1,ios7:{inline:!1},windows:{preventSkew:!1,renderDefault:!1},allowScrolling:!1,renderMode:"auto",theme:"auto",enableCache:!1,enablePersistence:!1,load:undefined,loadComplete:undefined,touchStart:undefined,touchEnd:undefined,ajaxBeforeLoad:undefined,ajaxSuccess:undefined,ajaxError:undefined,ajaxComplete:undefined,ajaxSettings:{type:"GET",cache:!1,async:!0,dataType:"html",contentType:"html",url:"",data:{}},renderTemplate:!1,templateId:null,persistSelection:!1,preventSelection:!1,dataBinding:!1,dataSource:[],query:null,fieldSettings:{navigateUrl:"navigateUrl",href:"href",enableAjax:"enableAjax",preventSelection:"preventSelection",persistSelection:"persistSelection",text:"text",enableCheckMark:"enableCheckMark",checked:"checked",primaryKey:"primaryKey",parentPrimaryKey:"parentPrimaryKey",imageClass:"imageClass",imageUrl:"imageUrl",childHeaderTitle:"childHeaderTitle",childId:"childId",childHeaderBackButtonText:"childHeaderBackButtonText",renderTemplate:"renderTemplate",templateId:"templateId",touchStart:"touchStart",touchEnd:"touchEnd",attributes:"attributes"},enableFiltering:!1,enableCheckMark:!1,transition:ej.isAndroid()?"pop":ej.isWindows()&&ej.isMobile()?"turn":ej.isWindows()&&!ej.isMobile()?"none":"slide",checkDOMChanges:!1},dataTypes:{dataSource:"data",fieldSettings:"data",renderMode:"enum",theme:"enum",enablePersistence:"boolean"},observables:["selectedItemIndex","dataSource"],selectedItemIndex:ej.util.valueFunction("selectedItemIndex"),dataSource:ej.util.valueFunction("dataSource"),_init:function(){this._preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/};this._storedContent=[];this._storedTemplate=[];this._load()},_load:function(){if(ej.setRenderMode(this),ej.setTheme(this),this._touchStart=this.model.touchStart,this._touchEnd=this.model.touchEnd,this.model.renderMode=="windows"&&ej.isMobile()&&this.model.windows.renderDefault&&(this.model.theme="default"),this._orgEle=this.element.clone(),this._index=0,this._items=[],this._indexVal=0,this.model.id=this.element[0].id,this.model.load&&this._trigger("load"),this.model.fieldSettings=eval(this.model.fieldSettings),this.model.fieldSettings&&this.model.query!=null){var proxy=this;this.dataSource().executeQuery(eval(this.model.query)).done(function(n){proxy.model.dataSource=n.result;proxy._renderControl()})}else this._renderControl()},_renderControl:function(){var f,i,e,o,t,s,n,u,r;if(this.element.addClass("e-m-parentlb "),this._lbEle=ej.buildTag("div.e-m-lb"),this._lbEle.addClass("subpage e-m-"+this.model.renderMode+" e-m-"+this.model.theme).addClass(ej.isMobile()?"e-m-mobile":"e-m-tablet").addClass(this.model.ios7.inline?"e-m-inline":""),this._lContainer=ej.buildTag("div.e-m-list-container#"+this.model.id+"_container"),n=this.element.find(">ul"),this.model.showHeader&&(f=this._renderHeader(this.model.id,this.model.showHeaderBackButton,this.model.headerTitle,this.model.headerBackButtonText),this._lbEle.prepend(f)),this.model.allowScrolling&&this._renderScrollPanel(this._lbEle,this.model.id+"_scroll",this.model.id+"_container"),this.model.dataBinding&&!this.model.renderTemplate&&this.element.empty(),this.model.renderTemplate&&(this.model.templateId&&ej.getCurrentPage().find("#"+this.model.templateId).length?(this._template=ej.getCurrentPage().find("#"+this.model.templateId),ej.destroyWidgets(this._template),this._template.remove(),this._template=this._template[0].nodeName&&this._template[0].nodeName.toLowerCase()=="script"?this._template[0].innerHTML:this._template[0].outerHTML):(ej.destroyWidgets(this.element),this._template=this.element.html(),this.element.empty())),!this.model.renderTemplate||this.model.dataBinding||this.model.enableGroupList){if(!this.model.renderTemplate||this.model.renderTemplate&&this.model.dataBinding||this.model.renderTemplate&&this.model.enableGroupList){if(this.model.enableGroupList){if(this._lContainer.addClass("e-m-grouped"),i=ej.buildTag("div.e-m-grouplist"),n=this.element.children(),n.length)for(e=this.model.dataBinding?this.dataSource().length:n.length,t=0;t<e;t++)this.model.dataBinding?(this._items=this.dataSource()[t].items,this.model.renderTemplate?ulItem=n[t]:(ulItem=ej.buildTag("ul"),this._lbEle.append(ulItem))):(this._items=[],ulItem=n[t]),o=this.model.dataBinding?this.dataSource()[t].key:ej.getAttrVal($(ulItem),"data-ej-grouplisttitle","GroupList"+(t+1)),s=ej.buildTag("div.e-m-groupdiv",ej.buildTag("div.e-m-grouptitle",o)),i.append(s.append(this._renderListItems($(ulItem).addClass("e-m-grouped"))));else this._template&&(ej.destroyWidgets(this._template),i[0].innerHTML=this._template);this._lContainer.append(i);ej.widget.init(i)}else this.model.dataBinding&&(n=ej.buildTag("ul"),this._items=this.dataSource()),n.length?(ej.destroyWidgets(n),this._lContainer.append(this._renderListItems(n))):this._template&&(ej.destroyWidgets(this._template),this._lContainer[0].innerHTML=this._template);this.element.prepend(this._lbEle);this.model.enableFiltering&&this._createFilterWrapper(this._lbEle);this._lbEle.append(this._lContainer);ej.widget.init(this._lContainer);u=this.element.find("li.e-m-list");u.removeEmptyAttrs();u.find(".e-m-list-anchor").removeEmptyAttrs();ej.widget.init(this._lbEle);r=this.element.find("ul");r.find("li:first").addClass("e-m-firstitem");r.find("li:last").addClass("e-m-lastitem");this._liEl=this.element.find("li");this.selectedItemIndex()>=0&&!this.model.preventSelection&&(!ej.getBooleanVal(r[this.selectedItemIndex()],"data-preventSelection"),this._currentItem=$(this._liEl[this.selectedItemIndex()]),this._prevItem=this._currentItem,this._currentItem.removeClass("e-m-state-default").addClass("e-m-state-active"));$(this.element.find(".e-m-lb-check").parent()).addClass("e-m-lb-checkdiv");$(this.element.find(".e-m-lb-check").closest("li.e-m-list")).addClass("e-m-list-check");$(this.element.find(".e-m-lb-input").closest(".e-m-lb-filter")).addClass("e-m-lb-inputdiv");this._wireEvents()}}else this.element.append(this._lbEle.append(this._lContainer)),this._template&&(this._lContainer.append(this._template),ej.widget.init(this._lContainer));this._setHeightWidth();this.model.loadComplete&&this._trigger("loadComplete")},_createFilterWrapper:function(n){var t=ej.buildTag("div.e-m-lb-filter",ej.buildTag("input.e-m-lb-input","",{},{"data-role":"ejmtextbox","data-ej-rendermode":this.model.renderMode,"data-ej-theme":this.model.theme,"data-ej-windows-renderdefault":this.model.windows.renderDefault})),i=ej.buildTag("a.e-m-lb-anchor",ej.buildTag("span.e-m-input-btn"),{},{Title:"Clear text","data-role":"none"});$(t).append(i);n.append(t)},_renderListItems:function(ul){var proxy=this,ulItems,j;if(ul.addClass("e-m-list-hdr e-m-clearall"),this._liItems=ul.find(">li"),this._liItems.length&&!this.model.dataBinding||this.model.dataBinding){this._renderParentChildTemplate();this.model.dataBinding||this._liItems.each(function(n,t){proxy._generateData(t,null,ej.getAttrVal(t,"data-ej-primarykey",null))});this._items=eval(this._items);var dataMgr=ej.DataManager(this._items),parentItem=dataMgr.executeLocal(ej.Query().from(this._items).where(ej.Predicate(this.model.fieldSettings.parentPrimaryKey,ej.FilterOperators.equal,null)).group(this.model.fieldSettings.parentPrimaryKey)),grouped=dataMgr.executeLocal(ej.Query().from(this._items).where(ej.Predicate(this.model.fieldSettings.parentPrimaryKey,ej.FilterOperators.notEqual,null)).group(this.model.fieldSettings.parentPrimaryKey));if(parentItem[0])for(ul.empty().html($(this.jsRender).render(parentItem[0].items)),grouped.length&&(this.element.append($(this.jsChildRender).render(grouped)),$.each(grouped,function(n,t){var u,r,i;for(ej.widget.init(proxy.element.find("#child"+t.key)),u=proxy.element.find("#child"+t.key).find("ul"),r=u.find("li"),k=0,i=0;i<r.length;i++)grouped[k].items[i]&&grouped[k].items[i].attributes&&$(r[i]).addAttrs(grouped[k].items[i].attributes);k++})),ulItems=ul.find(">li"),j=0;j<ulItems.length;j++)parentItem[0].items[j]&&parentItem[0].items[j].attributes&&$(ulItems[j]).addAttrs(parentItem[0].items[j].attributes)}return ul},_renderHeader:function(n,t,i,r){return ej.buildTag("div","",{},{"data-role":"ejmheader","data-ej-showLeftButton":t,"data-ej-leftbuttoncaption":r?r:"Back","data-ej-title":i,"data-ej-leftbuttontap":this.model.headerBackButtonTap,"data-ej-righttbuttontap":this.model.headerBackButtonTap,"data-ej-rendermode":this.model.renderMode,"data-ej-theme":this.model.theme,"data-ej-position":"normal",id:n+"_header","data-ej-hideforunsupporteddevice":this.model.hideHeaderForUnsupportedDevice,"data-ej-windows-renderdefault":this.model.windows.renderDefault})},_renderScrollPanel:function(n,t,i){this._scrollWrapper=ej.buildTag("div","",{},{"data-role":"ejmscrollpanel","data-ej-rendermode":this.model.renderMode,"data-ej-target":i,id:t,"data-ej-theme":this.model.theme,"data-ej-targetwidth":this.model.width,"data-ej-targetheight":this.model.height,"data-ej-setautoheight":this.model.autoAdjustScrollHeight,"data-ej-adjustfixedposition":this.model.adjustFixedPosition,"data-ej-enablenativescrolling":this.model.enableNativeScrolling,"data-ej-windows-renderdefault":this.model.windows.renderDefault,"data-ej-showscrollbars":this.model.showScrollbars,"data-ej-checkdomchanges":this.model.checkDOMChanges});n.append(this._scrollWrapper)},_renderParentChildTemplate:function(){var t=this._renderLists(),i,n,r;$.views.helpers({_checkAjaxUrls:this._checkAjaxUrl,_checkImgUrls:this._checkImgUrl,_checkIsChecked:this._checkIsCheck,Object:this});this.jsRender=ej.buildTag("script#"+this.model.id+"_Template","",{},{type:"text/x-jsrender"});ej.browserInfo().name=="msie"&&ej.browserInfo().version<10?this.jsRender[0].innerText=t[0].outerHTML.replace(/&gt;/g,">"):this.jsRender[0].innerHTML=t[0].outerHTML.replace(/&gt;/g,">");this.jsChildRender=ej.buildTag("script#"+this.model.id+"_ChildTemplate","",{},{type:"text/x-jsrender"});i=ej.buildTag("ul.e-m-childcontainer e-m-list-hdr e-m-clearall");t.addClass("e-m-childli");i[0].innerHTML="{{for items}}"+t[0].outerHTML+"{{/for}}";n=ej.buildTag("div.e-m-lb e-m-"+this.model.renderMode+" e-m-"+this.model.theme+" subpage e-m-childitem","",{},{id:"{{if key}}child{{>key}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}",style:"display:none"});n.addClass(ej.isMobile()?" e-m-mobile":" e-m-tablet");r=ej.buildTag("div.e-m-list-container","",{},{id:"{{if key}}child{{>key}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}_container"});this.model.showHeader&&n.append(this._renderHeader("{{if key}}child{{>key}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}",!0,"Title"));this.model.enableFiltering&&this._createFilterWrapper(n);n.append(r.append(i));this.model.allowScrolling&&this._renderScrollPanel(n,"{{if key}}child{{>key}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}_scroll","{{if key}}child{{>key}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}_container");ej.browserInfo().name=="msie"&&ej.browserInfo().version<10?this.jsChildRender[0].innerText=n[0].outerHTML.replace(/&gt;/g,">"):this.jsChildRender[0].innerHTML=n[0].outerHTML.replace(/&gt;/g,">")},_renderLists:function(){var n=ej.buildTag("li","",{},{"class":"e-m-user-select e-m-list e-m-state-default{{if "+this.model.fieldSettings.primaryKey+" || "+this.model.fieldSettings.enableAjax+" || "+this.model.enableAjax+"}} e-m-arrow{{/if}}{{if "+this.model.fieldSettings.imageClass+"}} e-m-margin{{else}}{{if "+this.model.fieldSettings.imageUrl+"}} e-m-margin{{/if}}{{/if}}","data-childid":"{{if "+this.model.fieldSettings.primaryKey+"}}child{{>"+this.model.fieldSettings.primaryKey+"}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}","data-childtitle":"{{>"+this.model.fieldSettings.childHeaderTitle+"}}","data-childbackbutton":"{{>"+this.model.fieldSettings.childHeaderBackButtonText+"}}","data-preventSelection":"{{>"+this.model.fieldSettings.preventSelection+"}}","data-persistSelection":"{{>"+this.model.fieldSettings.persistSelection+"}}","data-navigateUrl":"{{>"+this.model.fieldSettings.navigateUrl+"}}","data-loadajax":"{{>"+this.model.fieldSettings.enableAjax+"}}","data-href":"{{>"+this.model.fieldSettings.href+"}}{{:~_checkAjaxUrls()}}","data-check":"{{>"+this.model.fieldSettings.enableCheckMark+"}}","data-templateid":"{{>"+this.model.fieldSettings.renderTemplate+"}}","data-touchstart":"{{>"+this.model.fieldSettings.touchStart+"}}","data-touchend":"{{>"+this.model.fieldSettings.touchEnd+"}}"}),i;if(this.model.renderTemplate)this.model.dataBinding&&this._template&&(n[0].innerHTML=this._template);else{var r=ej.buildTag("a","",{},{"class":"e-m-list-anchor e-m-remove-shadow{{if "+this.model.fieldSettings.imageClass+"}} e-m-margin{{else}}{{if "+this.model.fieldSettings.imageUrl+"}} e-m-margin{{/if}}{{/if}}{{if "+this.model.fieldSettings.primaryKey+" || "+this.model.fieldSettings.enableAjax+" || "+this.model.enableAjax+"}} e-m-fontimage{{/if}}",href:"{{>"+this.model.fieldSettings.navigateUrl+"}}"}),u=ej.buildTag("span","{{>"+this.model.fieldSettings.text+"}}",{},{"class":"e-m-list-text e-m-rel e-m-user-select{{if "+this.model.fieldSettings.imageClass+"}} e-m-text{{else}}{{if "+this.model.fieldSettings.imageUrl+"}} e-m-text{{/if}}{{/if}}"}),f=ej.buildTag("div","",{},{"class":"e-m-list-img e-m-rel e-m-user-select {{>"+this.model.fieldSettings.imageClass+"}}"}),t=ej.buildTag("input.e-m-lb-check","",{},{"data-role":"ejmcheckbox","data-ej-preventdefault":!0,"data-ej-theme":this.model.theme,"data-ej-rendermode":this.model.renderMode,"data-ej-checked":"{{:~_checkIsChecked()}}","data-ej-windows-renderdefault":this.model.windows.renderDefault});r[0].innerHTML=this.model.renderMode=="windows"&&ej.isMobile()?"{{if !"+this.model.fieldSettings.primaryKey+"}}{{if "+this.model.fieldSettings.enableAjax+" == undefined || "+this.model.fieldSettings.enableAjax+".toString() == 'false'}}{{if !"+this.model.fieldSettings.navigateUrl+"}}{{if "+this.model.fieldSettings.enableCheckMark+" !== undefined}}{{if "+this.model.fieldSettings.enableCheckMark+".toString() == 'false' ? "+this.model.fieldSettings.enableCheckMark+" : "+this.model.enableCheckMark+"}}"+t[0].outerHTML+"{{/if}}{{else}}{{if "+this.model.enableCheckMark+"}}"+t[0].outerHTML+"{{/if}}{{/if}}{{/if}}{{/if}}{{/if}}{{if "+this.model.fieldSettings.imageClass+"}}"+f[0].outerHTML+"{{else}}{{if "+this.model.fieldSettings.imageUrl+"}}{{:~_checkImgUrls()}}{{/if}}{{/if}}"+u[0].outerHTML:"{{if "+this.model.fieldSettings.imageClass+"}}"+f[0].outerHTML+"{{else}}{{if "+this.model.fieldSettings.imageUrl+"}}{{:~_checkImgUrls()}}{{/if}}{{/if}}"+u[0].outerHTML+"{{if !"+this.model.fieldSettings.primaryKey+"}}{{if "+this.model.fieldSettings.enableAjax+" == undefined || "+this.model.fieldSettings.enableAjax+".toString() == 'false'}}{{if !"+this.model.fieldSettings.navigateUrl+"}}{{if "+this.model.fieldSettings.enableCheckMark+" !== undefined}}{{if "+this.model.fieldSettings.enableCheckMark+".toString() == 'false' ? "+this.model.fieldSettings.enableCheckMark+" : "+this.model.enableCheckMark+"}}"+t[0].outerHTML+"{{/if}}{{else}}{{if "+this.model.enableCheckMark+"}}"+t[0].outerHTML+"{{/if}}{{/if}}{{/if}}{{/if}}{{/if}}";n[0].innerHTML="{{if "+this.model.fieldSettings.renderTemplate+" == undefined || "+this.model.fieldSettings.renderTemplate+".toString() == 'false'}}"+r[0].outerHTML+"{{else}}{{:templateId}}{{/if}}"}return this.model.renderMode=="ios7"&&(i=ej.buildTag("div.e-m-list-div"),i[0].innerHTML=n[0].innerHTML,n.empty().append(i)),n},_renderChild:function(n){this._currentItem.attr("data-childid",n);this._currentItem.attr("data-childtitle")||this._currentItem.attr("data-childtitle",this._currentItem.text());this._div=ej.buildTag("div#"+n+".e-m-lb e-m-"+this.model.renderMode+" e-m-"+this.model.theme+" subpage e-m-childitem e-m-ajaxchild",this.model.showHeader?this._renderHeader(n,!0,this._currentItem.text()):"");this._div.hide();this._div.addClass(ej.isMobile()?"e-m-mobile":"e-m-tablet");this._container=ej.buildTag("div.e-m-list-container#"+n+"_container");this.element.append(this._div);this.model.allowScrolling&&this._renderScrollPanel(this._div,n+"_scroll",n+"_container")},_checkAjaxUrl:function(){var t=this.data.href,i,n;t&&t.indexOf("#")!=-1&&t!="#"&&(i=this.getRsc("helpers","Object"),i._storedContent[this.index]||(n=ej.getCurrentPage().find(t).remove(),i._storedContent[this.index]=n[0].nodeName&&n[0].nodeName.toLowerCase()=="script"?n[0].innerHTML:n[0].outerHTML))},_checkImgUrl:function(){var n=this.data[this.getRsc("helpers","Object").model.fieldSettings.imageUrl];return $.support.pushstate||(n=App.route.makeUrlAbsolute(n,!0)),"<img src = "+n+" class='e-m-list-img e-m-rel e-m-user-select'/>"},_checkIsCheck:function(){return this.data[this.getRsc("helpers","Object").model.fieldSettings.checked]?!0:!1},_generateData:function(n,t,i){var f=ej.getAttrVal(n,"data-ej-text",$(n).text()),e=null,u=$(n),c=ej.getAttrVal(n,"data-ej-childbuttontext",""),o=ej.getBooleanVal(n,"data-ej-rendertemplate",!1),r,s,h;o&&(ej.getCurrentPage().find("#"+ej.getAttrVal(n,"data-ej-templateid")).length?(r=ej.getCurrentPage().find("#"+ej.getAttrVal(n,"data-ej-templateid")).remove(),this._storedTemplate[this._indexVal]=r[0].nodeName&&r[0].nodeName.toLowerCase()=="script"?r[0].innerHTML:r[0].outerHTML):this._storedTemplate[this._indexVal]||(this._storedTemplate[this._indexVal]=n.innerHTML),this._indexVal++);u.find(">ul").length&&(s=this,e=ej.getAttrVal(n,"data-ej-childtitle",f),h=u.find(">ul").find(">li"),h.each(function(n,t){s._generateData(t,ej.getAttrVal(t,"data-ej-parentkey",i),ej.getAttrVal(t,"data-ej-primarykey",null))}));this._items[this._index]={navigateUrl:ej.getAttrVal(n,"data-ej-navigateUrl",""),href:ej.getAttrVal(n,"data-ej-href",""),enableAjax:ej.getBooleanVal(n,"data-ej-enableAjax",this.model.enableAjax),preventSelection:ej.getBooleanVal(n,"data-ej-preventSelection",this.model.preventSelection),persistSelection:ej.getBooleanVal(n,"data-ej-persistSelection",this.model.persistSelection),text:f,enableCheckMark:ej.getBooleanVal(n,"data-ej-enableCheckMark",this.model.enableCheckMark),checked:ej.getBooleanVal(n,"data-ej-checked",!1),primaryKey:i,parentPrimaryKey:t,imageClass:ej.getAttrVal(n,"data-ej-imageclass",""),imageUrl:ej.getAttrVal(n,"data-ej-imageurl",""),childHeaderTitle:e,childId:ej.getAttrVal(n,"data-ej-childid","page_"+parseInt(Math.random().toFixed(3)*1e3)),childHeaderBackButtonText:c,renderTemplate:o,templateId:this._storedTemplate[this._indexVal-1],touchStart:ej.getAttrVal(n,"data-ej-touchstart",null),touchEnd:ej.getAttrVal(n,"data-ej-touchend",null),attributes:u.removeAttrs(/^data-ej-/)[0].attributes};this._index+=1},_onTouchStartHandler:function(n){ej.isDevice()||ej._preventDefaultException(n.target,this._preventDefaultException)||n.preventDefault();ej.isWindows()&&(this._Coords={x:n.x,y:n.y});this._currentItem=$(n.currentTarget);this._scroll=!1;ej.getBooleanVal(this._currentItem,"data-preventSelection",this.model.preventSelection)||this._addSelection();this.model.renderMode!="windows"||this.model.windows.preventSkew||this._currentItem.addClass(ej.isMobile()?ej._getSkewClass($(this._currentItem),n.pageX,n.pageY):"e-m-skew-center");this.model.touchStart=ej.getAttrVal(this._currentItem,"data-touchstart",this._touchStart);this.model.touchStart&&this._trigger("touchStart",this._returnData());ej._listenEvents([this._liEl,this._liEl],[ej.endEvent(),ej.moveEvent()],[this._touchEndDelegate,this._touchMoveDelegate]);$(window).bind(ej.endEvent(),this._docClickDelegate)},_onTouchMoveHandler:function(){this._scroll=!0;ej.getBooleanVal(this._currentItem,"data-persistSelection",this.model.persistSelection)?this._prevItem&&this._prevItem[0]!=this._currentItem[0]&&this._removeSelection():this._removeSelection();this.model.renderMode!="windows"||this.model.windows.preventSkew||ej._removeSkewClass(this._currentItem)},_onTouchEndHandler:function(n){var r,u,t,i,f;if(this._isFromAjax=!1,ej.getBooleanVal(this._currentItem,"data-persistSelection",this.model.persistSelection)||this._removeSelection(),this.model.renderMode!="windows"||this.model.windows.preventSkew||ej._removeSkewClass(this._currentItem),this._scroll)return this._setCurrent(),this._unbindEvents(n),ej.blockDefaultActions(n),!1;if(this._scroll)this.model.renderMode!="windows"||ej.isMobile()||this._touchEndEventHandler();else{if(this._currentItem.find(".e-m-lb-check").length&&(r=this._currentItem.find(".e-m-lb-check"),r.ejmCheckBox("model.checked",r.attr("checked")?!1:!0)),u=this._currentItem.attr("data-childbackbutton")==undefined?this._currentItem.closest(".e-m-lb").find(".e-m-header").length?this._currentItem.closest(".e-m-lb").find(".e-m-header").ejmHeader("getTitle"):"Back":ej.getAttrVal(this._currentItem,"data-childbackbutton"),t=this._currentItem.attr("data-href"),this._currentItem.attr("data-navigateUrl"))this._touchEndEventHandler();else{if(i=this.element.find("[data-ajaxurl='"+App.route.convertToRelativeUrl(t)+"']"),ej.getBooleanVal(this._currentItem,"data-loadajax",this.model.enableAjax)&&(!this.model.enableCache||i.length==0)){i.length&&i.remove();this.loadAjaxContent(t,u);this._unbindEvents(n);return}t&&t.indexOf("#")!=-1&&($("#"+t.replace("#","")).length||(this._renderChild(ej.getAttrVal(this._currentItem,"data-childid","page_"+parseInt(Math.random().toFixed(3)*1e3))),f=ej.buildTag("div.e-m-content",this._storedContent[this._currentItem.index()]),this._div.append(this._container.append(f)),ej.widget.init(this._div)));this._updateContent(this._currentItem,u);this._touchEndEventHandler()}this._prevItem=this._currentItem}this._unbindEvents(n)},_setCurrent:function(){this._prevItem&&ej.getBooleanVal(this._currentItem,"data-persistSelection",this.model.persistSelection)&&(this._currentItem=this._prevItem,this._currentItem.removeClass("e-m-state-default").addClass("e-m-state-active"))},_unbindEvents:function(n){n&&n.target.nodeName&&n.target.nodeName.toLowerCase()!="a"&&(this._scroll=!1);ej._listenEvents([this._liEl,this._liEl],[ej.endEvent(),ej.moveEvent()],[this._touchEndDelegate,this._touchMoveDelegate],!0)},_addSelection:function(){this._scroll||(this._currentItem.closest(".e-m-list-container").find(".e-m-state-active").removeClass("e-m-state-active").addClass("e-m-state-default"),this._currentItem.removeClass("e-m-state-default").addClass("e-m-state-active"))},_removeSelection:function(){var n=this;n._currentItem.removeClass("e-m-state-active").addClass("e-m-state-default")},_updateContent:function(n,t){var o=this,i=$(n),u=i.attr("data-childid"),r=this.element.find("#"+u),f,s,e,h;r.length&&(f=this.element.find("#"+u+"_header"),s=this.element.find("#"+u+"_scroll"),this.model.enableFiltering&&this._initializeFiltering($(r)),e=i.attr("data-childtitle")==undefined?n.text():i.attr("data-childtitle"),f.hasClass("e-m-header")&&(h=f.ejmHeader("instance"),h.setModel({title:e,leftButtonCaption:t})),r.attr("data-hdr-title",e).attr("data-hdr-bckbtn",t),App.transferPage(i.closest(".subpage"),r,{isFromAjax:this._isFromAjax,transition:this.model.transition,parentSubPage:i.closest(".e-m-lb").hasClass(".e-m-childitem")?!1:!0}),r.bind(ej.transitionEndEvent(),function(){o._setHeightWidth();o.model.allowScrolling&&s.ejmScrollPanel("refresh")}))},_setHeightWidth:function(){if(this.model.autoAdjustHeight)this.element.height(window.innerHeight);else if(this.model.height)this.element.height(this.model.height);else{var n=this.element[0].scrollHeight?this.element[0].scrollHeight:ej.getDimension(this._lbEle.find(".e-m-list-container"),"outerHeight");this.model.showHeader&&(n=n+ej.getDimension(this._lbEle.find(".e-m-header"),"outerHeight"));this.model.enableFiltering&&(n=n+ej.getDimension(this._lbEle.find(".e-m-lb-inputdiv"),"outerHeight"));this.element.height(n)}this.model.width&&this.element.width(this.model.width)},_touchEndEventHandler:function(){this.model.touchEnd=ej.getAttrVal(this._currentItem,"data-touchend",this._touchEnd);this.selectedItemIndex(this._currentItem.index());this.model.touchEnd&&this._trigger("touchEnd",this._returnData())},_returnData:function(){var n=this._currentItem.closest("ul.e-m-list-hdr").find("input.e-m-lb-check[checked]").closest("li");return{hasChild:this.element.find("#"+this._currentItem.attr("data-childid")).length?!0:!1,item:this._currentItem,text:this._currentItem.text(),index:this._currentItem.index(),isChecked:this._currentItem.find("input.e-m-lb-check").attr("checked")=="checked"?!0:!1,checkedItems:n.length?n:null,checkedItemsText:$(n).map(function(){return $(this).text()}).get()}},_docClick:function(){this._scroll&&this._setCurrent();$(window).unbind(ej.endEvent(),this._docClickDelegate);ej._listenEvents([this._liEl,this._liEl],[ej.endEvent(),ej.moveEvent()],[this._touchEndDelegate,this._touchMoveDelegate],!0)},_popStateNavigation:function(n,t){t.pageUrl&&this.model.enableFiltering&&this._initializeFiltering($("div[data-url='"+t.pageUrl.replace("#","")+"']"))},_anchorClickHandler:function(n){if(this._scroll)return ej.blockDefaultActions(n),!1},_onResize:function(){var n=this;setTimeout(function(){n._setHeightWidth()},ej.isAndroid()?200:0)},_onScrollStop:function(n){ej.blockDefaultActions(n)},_createDelegates:function(){this._anchorClickDelegate=$.proxy(this._anchorClickHandler,this);this._keyup=$.proxy(this._onKeyUp,this);this._touchStartDelegate=$.proxy(this._onTouchStartHandler,this);this._touchEndDelegate=$.proxy(this._onTouchEndHandler,this);this._touchMoveDelegate=$.proxy(this._onTouchMoveHandler,this);this._resizeDelegate=$.proxy(this._onResize,this);this._popStateDelegate=$.proxy(this._popStateNavigation,this);this._docClickDelegate=$.proxy(this._docClick,this)},_wireEvents:function(n){var t,i;this._createDelegates();t=n?"unbind":"bind";this.model.autoAdjustHeight&&(i=!ej.isDevice()&&!ej.isTouchDevice()?"resize":"orientationchange",ej._listenEvents([window],[i],[this._resizeDelegate],n));ej._listenEvents([this._liEl.find("a"),this.element.find(".e-m-lb-input"),this._liEl,this._liEl],["click","keyup",ej.startEvent(),ej.cancelEvent()],[this._anchorClickDelegate,this._keyup,this._touchStartDelegate,this._touchMoveDelegate],n);this._lContainer.on("scrollstop",$.proxy(this._onScrollStop,this));$("body")[t]("viewpopstate",this._popStateDelegate);this.model.enableFiltering&&this._initializeFiltering(this._lbEle)},_initializeFiltering:function(n){var i,t;for(this._searchItems=$(n).find(".e-m-list"),n.find(".e-m-lb-input").ejmTextBox("model.value",""),n.find('.e-m-list[style*="display: none"]').show(),i="a",this._elementText=[],t=0;t<this._searchItems.length;t++)$(this._searchItems[t]).find(i)?this._elementText.push($.trim($(this._searchItems[t]).find(i).html().replace(new RegExp("<[^<]+>","g"),"").toLowerCase())):this._elementText.push("")},_onKeyUp:function(n){for(var t=0;t<this._searchItems.length;t++)this._elementText[t].indexOf(n.target.value)==-1?$(this._searchItems[t]).css("display","none"):$(this._searchItems[t]).css("display","")},_setModel:function(n){var r=!1,t,i;for(t in n)i="_set"+t.charAt(0).toUpperCase()+t.slice(1),this[i]?this[i](n[t]):r=!0;r&&this._refresh()},_setTheme:function(n){if(n&&(this.model.theme=n,this._lbEle.removeClass("e-m-dark e-m-light e-m-default").addClass("e-m-"+this.model.theme),this.model.enableFiltering&&this.element.find(".e-m-text-input").ejmTextBox("model.theme",this.model.theme),this.model.showHeader&&this._lbEle.find("#"+this.model.id+"_header").ejmHeader("model.theme",this.model.theme),this.element.find(".e-m-childitem").length)){$(this.element.find(".e-m-childitem")).removeClass("e-m-dark e-m-light e-m-default").addClass("e-m-"+this.model.theme);var t=this.element.find(".e-m-childitem .e-m-header"),i=this;t.each(function(n,t){$(t).ejmHeader("model.theme",i.model.theme)})}},_setDataSource:function(n,t){this.model.dataBinding&&n&&(this.dataSource(n),t&&(this.model.fieldSettings=t),this._refresh())},_getElement:function(n){return n?this.element.find("#"+n):this._lbEle},_isEnable:function(n){return n.hasClass("e-m-state-disabled")?!1:!0},_refresh:function(){this._destroy();this.element.addClass("e-m-lb");this._load()},_clearElement:function(){this.element.removeAttr("class");this.element.empty().html(this._orgEle.html())},_destroy:function(){this._wireEvents(!0);this._clearElement()},loadAjaxContent:function(n,t){var i=this,r;this._isFromAjax=!0;this._renderChild(ej.getAttrVal(this._currentItem,"data-childid","page_"+parseInt(Math.random().toFixed(3)*1e3)));$.support.pushstate||(n=App.route.makeUrlAbsolute(n));this.model.ajaxBeforeLoad&&this._trigger("ajaxBeforeLoad",{ajaxData:this.model.ajaxSettings});r={cache:i.model.ajaxSettings.cache,async:i.model.ajaxSettings.async,type:i.model.ajaxSettings.type,contentType:i.model.ajaxSettings.contentType,url:i.model.ajaxSettings.url?i.model.ajaxSettings.url:n,dataType:i.model.ajaxSettings.dataType,data:i.model.ajaxSettings.data,successHandler:function(r){var f=ej.buildTag("div.e-m-content",/<\/?body[^>]*>/gmi.test(r)?r.split(/<\/?body[^>]*>/gmi)[1]:r||""),u;i._div.append(i._container.append(f));i._div.attr("data-ajaxurl",App.route.convertToRelativeUrl(n));i._updateContent(i._currentItem,t);u={content:i._div,item:i._currentItem,index:$(i._currentItem).index(),text:$(i._currentItem).text(),url:i.model.ajaxSettings.url?i.model.ajaxSettings.url:n};i.model.ajaxSuccess&&i._trigger("ajaxSuccess",u)},errorHandler:function(t,r,u){var f={xhr:t,textStatus:r,errorThrown:u,item:i._currentItem,index:$(i._currentItem).index(),text:$(i._currentItem).text(),url:i.model.ajaxSettings.url?i.model.ajaxSettings.url:n};i.model.ajaxError&&i._trigger("ajaxError",f)},completeHandler:function(n){i.model.ajaxComplete&&i._trigger("ajaxComplete",n)}};ej.sendAjaxRequest(r)},selectItem:function(n,t){n>=0&&this._isEnable($(this._getElement(t).find("li.e-m-list")[n]))&&(this._currentItem=$(this._getElement(t).find("li.e-m-list")[n]),this._prevItem=this._currentItem,this._onTouchEndHandler())},setActive:function(n,t){n>=0&&(element=this._getElement(t),this._isEnable($(element.find("li.e-m-list")[n]))&&ej.getBooleanVal($(element.find("li.e-m-list")[n]),"data-persistSelection",this.model.persistSelection)&&(element.find("li.e-m-list.e-m-state-active").removeClass("e-m-state-active").addClass("e-m-state-default"),this._currentItem=$(element.find("li.e-m-list")[n]),this._prevItem=this._currentItem,this._currentItem.removeClass("e-m-state-default").addClass("e-m-state-active")))},deActive:function(n,t){n>=0&&this._isEnable($(this._getElement(t).find("li.e-m-list")[n]))&&$(this._getElement(t).find("li.e-m-list")[n]).removeClass("e-m-state-active").addClass("e-m-state-default")},enableItem:function(n,t){n>=0&&$(this._getElement(t).find("li.e-m-list")[n]).removeClass("e-m-state-disabled")},disableItem:function(n,t){n>=0&&$(this._getElement(t).find("li.e-m-list")[n]).addClass("e-m-state-disabled")},removeCheckMark:function(n,t){element=this._getElement(t);n>=0&&this._isEnable($(element.find("li.e-m-list")[n]))?$(element.find("li.e-m-list")[n]).find(".e-m-lb-checkdiv").remove():element.find(".e-m-lb-checkdiv").remove()},checkItem:function(n,t){n>=0&&this._isEnable($(this._getElement(t).find("li.e-m-list")[n]))&&$(this._getElement(t).find(".e-m-lb-check")[n]).ejmCheckBox("model.checked",!0)},unCheckItem:function(n,t){n>=0&&this._isEnable($(this._getElement(t).find("li.e-m-list")[n]))&&$(this._getElement(t).find(".e-m-lb-check")[n]).ejmCheckBox("model.checked",!1)},checkAllItem:function(n){var t=this;this._getElement(n).find(".e-m-lb-check").each(function(i,r){t._isEnable($(t._getElement(n).find("li.e-m-list")[i]))&&$(r).ejmCheckBox("model.checked",!0)})},unCheckAllItem:function(n){var t=this;this._getElement(n).find(".e-m-lb-check").each(function(i,r){t._isEnable($(t._getElement(n).find("li.e-m-list")[i]))&&$(r).ejmCheckBox("model.checked",!1)})},getActiveItem:function(n){return this._getElement(n).find("li.e-m-list.e-m-state-active")},getActiveItemText:function(n){return this._getElement(n).find("li.e-m-list.e-m-state-active").text()},getItemText:function(n,t){if(n>=0)return $(this._getElement(t).find("li.e-m-list")[n]).text()},getCheckedItems:function(n){return this._getElement(n).find('input.e-m-lb-check[checked="checked"]').closest("li.e-m-list")},getCheckedItemsText:function(n){return $(this._getElement(n).find('input.e-m-lb-check[checked="checked"]').closest("li.e-m-list")).map(function(){return $(this).text()}).get()},hasChild:function(n,t){if(n>=0)return this.element.find("#"+$(this._getElement(t).find("li.e-m-list")[n]).attr("data-childid")).length?!0:!1},isChecked:function(n,t){if(n>=0)return $(this._getElement(t).find("li.e-m-list input.e-m-lb-check")[n]).attr("checked")=="checked"?!0:!1},showItem:function(n,t){n>=0&&$(this._getElement(t).find("li.e-m-list")[n]).css("visibility","")},hideItem:function(n,t){n>=0&&$(this._getElement(t).find("li.e-m-list")[n]).css("visibility","hidden")},show:function(n){this._getElement(n).css("visibility","")},hide:function(n){this._getElement(n).css("visibility","hidden")},addItem:function(n,t){t>=0?n.insertBefore($(this._orgEle.children().children()[t])):this._orgEle.children().append(n);this._refresh()},removeItem:function(n,t){if(n>=0){element=this._getElement(t);var i=$(element.find("li.e-m-list")[n]).attr("data-childid");this.element.find($("#"+i).length)&&this.element.find($("#"+i)).remove();$(element.find("li.e-m-list")[n]).remove()}},getItemsCount:function(n){return this._getElement(n).find("li.e-m-list").length}})})(jQuery,Syncfusion)