/*!
*  filename: ej.mobile.togglebutton.min.js
*  version : 12.3
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./ej.mobile.core.min","./ej.mobile.application.min","./../common/ej.core.min","./../common/ej.data.min","./../common/ej.unobtrusive.min","./../common/ej.touch.min"],n):n()})(function(){(function(n,t){t.widget("ejmToggleButton","ej.mobile.ToggleButton",{_setFirst:!0,_rootCSS:"e-m-tbutton",defaults:{theme:"auto",animate:!0,toggleState:!0,renderMode:"auto",windows:{renderDefault:!1},touchStart:null,touchEnd:null,change:null,enabled:!0,enablePersistence:!1},dataTypes:{renderMode:"enum",theme:"enum",animate:"boolean",toggleState:"boolean",enabled:"boolean",enablePersistence:"boolean"},_init:function(){this._cloneElement=this.element.clone();this._browser=t.browser();this._renderControl();this._wireEvents(!1);this.model.enabled?this.enable():this.disable()},_renderControl:function(){t.setRenderMode(this);t.setTheme(this);this.model.renderMode=="windows"&&this.model.windows.renderDefault&&t.isMobile()&&(this.model.theme="default");var n=this.model;this.element.addClass("e-m-tbutton e-m-"+n.renderMode+" e-m-"+n.theme).css({visibility:"hidden"}).addClass("e-m-"+n.renderMode+"corner-all");this._input=t.buildTag("input",{},{},{type:"checkbox","data-role":"none"}).css("display","none");this._innerdiv=t.buildTag("div.e-m-innerdiv");this._filler=t.buildTag("div.e-m-filler");this._offstate=t.buildTag("div.e-m-offstate").html("ON");this._onstate=t.buildTag("div.e-m-onstate").html("OFF");this._slider=t.buildTag("div.e-m-tslider");n.toggleState?(this._input.attr("checked","checked").attr("value",!0),this._offstate.addClass("e-m-active"),this._slider.html("OFF").addClass("e-m-"+n.renderMode+"-active"),this.element.addClass("e-m-"+n.renderMode+"-active")):(this._input.attr("value",!1),this._onstate.addClass("e-m-default"),this._slider.html("ON"));this._input.attr("class","e-m-input");this._innerdiv.append(this._offstate).append(this._slider).append(this._onstate);this.element.append(this._input).append(this._innerdiv).append(this._filler);this._slider.attr("Draggable","false");this.transtime=this.model.renderMode=="flat"||this.model.renderMode=="ios7"?this.model.animate?"200ms":"0ms":"0ms";this._setToggleNativePosition()},_createDelegates:function(){this._touchStartHandler=n.proxy(this._touchStart,this);this._touchEndHandler=n.proxy(this._touchEnd,this);this._touchMoveHandler=n.proxy(this._touchMove,this)},_wireEvents:function(n){this._createDelegates();t.listenTouchEvent(this.element,t.startEvent(),this._touchStartHandler,n)},_touchStart:function(n){var r,i,u;t.blockDefaultActions(n);r=n.touches?n.touches[0]:n;this._startPoint=r.pageY;this.maxMove=this.element.width()-this._slider.width();i=this.model;this._flag=!0;this._startstate=i.toggleState;this._startTime=n.timeStamp||Date.now();this._startPos=n.pageX;n=t.isTouchDevice()?n.changedTouches[0]:n;(this.model.renderMode=="flat"||this.model.renderMode=="ios7")&&(this.maxMove=this.maxMove-2);this._slider.addClass("e-m-touchactive");this.element.addClass("e-m-touchactive");this._onstate.addClass("e-m-touchactive");this._position={x:n.pageX,y:n.pageY};this.startValue=this._getNormalValue(this._position);this._handleX=this._slider.offset().left-this.element.offset().left;t.listenEvents([document,document],[t.endEvent(),t.moveEvent()],[this._touchEndHandler,this._touchMoveHandler],!1);u={state:i.toggleState};i.touchStart&&this._trigger("touchStart",u)},_touchMove:function(n){var i,r,u;t.blockDefaultActions(n);i=n.touches?n.touches[0]:n;this._endPoint=i.pageY;this._startPoint!=this._endPoint&&(r=this.model,this._flag=!1,n=t.isTouchDevice()?n.changedTouches[0]:n,this._position={x:n.pageX,y:n.pageY},u=this._getNormalValue(this._position),this._curValue=u-this.startValue,this._endTime=n.timeStamp||Date.now(),this._endPos=n.pageX,this._offstate.css("opacity",1),this._onstate.css("opacity",1),this._transitionTime(this._innerdiv,this.transtime),r.renderMode!="ios7"?this._handleX+this._curValue>=0&&this._handleX+this._curValue<=this.maxMove&&(this.model.renderMode=="android"&&(this._flag?this._onstate.hasClass("e-m-active")?this._offState():this._onState():this._handleX+this._curValue<this.maxMove/2?this._offState():this._onState()),this.model.renderMode=="windows"?(this._translateContent(this._slider,this._handleX+this._curValue),this._filler.width(this._handleX+this._curValue-4)):this._translateContent(this._innerdiv,this._handleX+this._curValue)):this._handleX+this._curValue<this.maxMove/2?this._offState():this._onState())},_touchEnd:function(n){var i,u,r;t.blockDefaultActions(n);this._slider.removeClass("e-m-touchactive");this.element.removeClass("e-m-touchactive");this._onstate.removeClass("e-m-touchactive");i=this.model;t.listenEvents([document,document],[t.endEvent(),t.moveEvent()],[this._touchEndHandler,this._touchMoveHandler],!0);n=t.isTouchDevice()?n.changedTouches[0]:n;u=this._slider.offset().left-this.element.offset().left;this._delTime=this._endTime-this._startTime;this._delPos=this._startstate?-(this._endPos-this._startPos):this._endPos-this._startPos;(i.renderMode==="ios7"||i.renderMode==="windows")&&this._delTime<300&&this._delPos>10?this._startstate?this._offState():this._onState():(i.animate!="true"||this._innerdiv.hasClass("e-m-transition")||this._innerdiv.addClass("e-m-transition"),this._flag?this._onstate.hasClass("e-m-active")?this._offState():this._onState():u<this.maxMove/2?this._offState():this._onState());this._input.attr("checked")?(this._slider.addClass("e-m-"+i.renderMode+"-active"),this.element.addClass("e-m-"+i.renderMode+"-active")):(this._slider.removeClass("e-m-"+i.renderMode+"-active"),this.element.removeClass("e-m-"+i.renderMode+"-active"));r={state:i.toggleState};i.touchEnd&&this._trigger("touchEnd",r);i.change&&this._startstate!=i.toggleState&&this._trigger("change",r)},_setToggleNativePosition:function(){var e=this.model,u,f,r,i,o;this._browser=t.browser();u=this._onstate.removeClass("e-m-onstate").outerWidth();f=this._offstate.removeClass("e-m-offstate").outerWidth();this._onstate.addClass("e-m-onstate");this._offstate.addClass("e-m-offstate");r=this._innerdiv.width;i=Math.max(u,f);i>r&&(n(this._innerdiv).width(i+t.getCurrentPage().find(this._slider,"width")+20),this._onstate.width(i+t.getCurrentPage().find(this._slider,"width")+20),this._offstate.width(i+t.getCurrentPage().find(this._slider,"width")+20));o=Math.max(this._onstate.width(),this._offstate.width());this._flag=!1;this._innerdiv[0].style[this._browser+"TransitionProperty"]="-"+this._browser.toLowerCase()+"-transform";this._innerdiv[0].style[this._browser+"TransitionDuration"]="0ms";this._slider[0].style[this._browser+"TransitionProperty"]="-"+this._browser.toLowerCase()+"-transform";this._slider[0].style[this._browser+"TransitionDuration"]="0ms";this.model.renderMode=="ios7"&&this._slider.css("-"+this._browser+"-Transition"," width 0.5s ease");this._innerdiv.css("-"+this._browser+"-user-select","none");i>r&&this._offstate.css("left",-(i-t.getDimension(this._slider,"width")/2+this._slider.width()+10));e.toggleState?this._onState():this._offState();this._transitionTime(this._innerdiv,this.transtime);this.element.css({visibility:"visible"})},_getNormalValue:function(n){var t,i,r,u;return t=n.x-this.element.offset().left,i=t/this.element[0].offsetWidth,r=this.element.width(),u=i*r,this._trimValue(u)},_trimValue:function(n){var t=1,i=n%t,r=n-i;return Math.abs(i)*2>=t&&(r+=i>0?t:-t),parseFloat(r.toFixed(5))},_offState:function(){modelobj=this.model;modelobj.toggleState=!1;this._input.removeAttr("checked","checked").attr("value",!1);this._onstate.addClass("e-m-default").removeClass("e-m-active");this._slider.html("OFF");this._onstate.css("opacity",1);this._transitionTime(this._innerdiv,this.transtime);modelobj.renderMode=="windows"?(this._translateContent(this._slider,0),this._filler.width("0px")):this._translateContent(this._innerdiv,0);this._slider.removeClass("e-m-"+modelobj.renderMode+"-active");this.element.removeClass("e-m-"+modelobj.renderMode+"-active");this._transitionTime(this._offstate,this.transtime);this.model.renderMode=="ios7"&&this._translateContent(this._innerdiv,0)},_onState:function(){modelobj=this.model;modelobj.toggleState=!0;this._input.attr("checked","checked").attr("value",!0);this._slider.html("ON");this._offstate.css("opacity",1);this._transitionTime(this._innerdiv,this.transtime);var n=modelobj.renderMode=="flat"?52:49;this.model.renderMode=="windows"?(this._translateContent(this._slider,43),this._filler.width("39px")):this._translateContent(this._innerdiv,n);this._slider.addClass("e-m-"+modelobj.renderMode+"-active");this.element.addClass("e-m-"+modelobj.renderMode+"-active");this._onstate.addClass("e-m-active").removeClass("e-m-default");this._transitionTime(this._onstate,this.transtime);this.model.renderMode=="ios7"&&this._translateContent(this._innerdiv,22)},_transitionTime:function(n,i){n[0].style[t.transitionDuration]=i},_translateContent:function(n,i){n[0].style[t.transform]="translateX("+i+"px)"},_setModel:function(n){var i;for(var r in n)switch(r){case"theme":this.element.removeClass("e-m-light e-m-dark e-m-default").addClass("e-m-"+n.theme.toLowerCase());break;case"renderMode":n.renderMode=="auto"?t.setRenderMode(this):this.model.renderMode=n.renderMode;i=!0;break;case"toggleState":this._setToggleNativePosition();break;case"animate":i=!0;break;case"enabled":n.enabled?this.enable():this.disable()}i&&this._refresh()},_refresh:function(){this._clearElement();this._renderControl();this._wireEvents()},_clearElement:function(){this._wireEvents(!0);this.element.removeAttr("class");this.element.removeAttr("style");this.element.html("")},_destroy:function(){this._cloneElement.insertBefore(this.element).removeClass("e-m-tbutton");this.element.remove()},disable:function(){this.element.addClass("e-m-state-disabled");this._wireEvents(!0);this.model.enabled=!1},enable:function(){this.element.removeClass("e-m-state-disabled");this._wireEvents(!1);this.model.enabled=!0}})})(jQuery,Syncfusion)})