/*!
*  filename: ej.mobile.accordion.min.js
*  version : 12.3
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./ej.mobile.core.min","./ej.mobile.application.min","./../common/ej.core.min","./../common/ej.data.min","./../common/ej.unobtrusive.min","./../common/ej.touch.min"],n):n()})(function(){(function(n,t,r){t.widget("ejmAccordion","ej.mobile.Accordion",{_setFirst:!0,_rootCSS:"e-m-acc",validTags:["div","span"],defaults:{renderMode:"auto",collapsible:!1,selectedItems:[0],disabledItems:[],theme:"auto",heightAdjustMode:"content",showHeaderIcon:!1,enableCache:!0,enableMultipleOpen:!1,enablePersistence:!1,enabled:!0,spinnerText:"loading...",windows:{renderDefault:!1},active:null,beforeActive:null,ajaxLoad:null,ajaxBeforeLoad:null,ajaxSuccess:null,ajaxError:null},dataTypes:{renderMode:"enum",collapsible:"boolean",theme:"enum",showHeaderIcon:"boolean",enableCache:"boolean",heightAdjustMode:"enum",enableMultipleOpen:"boolean",selectedItems:"array",enabled:"boolean",disabledItems:"array"},observableArray:["selectedItems"],selectedItems:t.util.valueFunction("selectedItems"),_init:function(){this._cloneElement=n(this.element).clone();this._renderControl();this._icons=this.element.find(".e-m-acc-img");this._contentElements=this.element.find("> .e-m-acc-content");this._items=this.element.find(">.e-m-acc-header");this._anchors=this._items.find(".e-m-acc-link");this._maxAutoHeight=0;this._createDelegates();this._wireEvents(!1);this.show();this._displayHeaderIcon(this.model.showHeaderIcon);this._load();this._enabledAction(this.model.enabled);this.disableItems(this.model.disabledItems)},_renderControl:function(){var i,u,f;t.setRenderMode(this);t.setTheme(this);this.model.renderMode=="windows"&&this.model.windows.renderDefault&&(this.model.theme="default");i=this;this.element.addClass("e-m-user-select");this.element.addClass("e-m-acc e-m-"+this.model.renderMode);this.element.addClass("e-m-"+this.model.theme);u=t.buildTag("div");u.append(this.element.html());this.element.empty();f=u.find(">ul >li");n.each(f,function(u,e){var s=t.buildTag("div.e-m-acc-header e-m-acc-innerdiv"),o=t.buildTag("h3.e-m-acc-header e-m-acc-item"),h=t.buildTag("div.e-m-acc e-m-acc-content"),l=t.getAttrVal(e,"data-ej-ajaxurl","#"),a=t.getAttrVal(e,"data-ej-text"),c=t.getAttrVal(e,"data-ej-logoclass");s.append(t.buildTag("div.e-m-acc-link",a));s.append(t.buildTag("a.e-m-acc-linkhref","","",{href:l}));s.append(t.buildTag("div.e-m-fontimage e-m-acc-img"));c!=r&&s.append(t.buildTag("div.e-m-acc-logourl "+c));o=o.append(s);h.html(n(e).html().trim());i.element.append(o).append(h);o.attr("tabindex",u);h.attr("id","header-content-"+(u+1));!i.model.enableMultipleOpen&&i.selectedItems().length>1&&i.selectedItems().splice(1,i.selectedItems().length);n.inArray(u,i.selectedItems())>-1?o.addClass("e-m-acc-state-active"):(o.addClass("e-m-acc-state-default"),h.hide());u==0&&o.addClass("e-m-acc-border-top");u==f.length-1&&(o.addClass("e-m-acc-border-bottom"),h.addClass("e-m-acc-content-border-bottom"))})},_createDelegates:function(){this._onOrientationChangeHandler=n.proxy(this._onOrientationChangeHandler,this);this._onResizeEventHandler=n.proxy(this._onResizeEventHandler,this);this._onClickHandler=n.proxy(this._onClickHandler,this);this._onStartHandler=n.proxy(this._onStartHandler,this);this._onTouchMoveHandler=n.proxy(this._onTouchMoveHandler,this)},_wireEvents:function(n){t.listenEvents([window,window,this._items,this._items],["orientationchange","resize",t.endEvent(),t.startEvent()],[this._onOrientationChangeHandler,this._onResizeEventHandler,this._onClickHandler,this._onStartHandler],n)},_onClickHandler:function(i){if(t.blockDefaultActions(i),!this._scroll){var r=n(i.currentTarget);this._select(r,i)}},_onResizeEventHandler:function(n){n.preventDefault();this._setHeightAdjustMode(this.model.heightAdjustMode)},_onOrientationChangeHandler:function(n){n.preventDefault();this._setHeightAdjustMode(this.model.heightAdjustMode)},_onStartHandler:function(n){n.preventDefault();this._scroll=!1;t._touchStartPoints(n,this);t.listenTouchEvent(this._items,t.moveEvent(),this._onTouchMoveHandler)},_onTouchMoveHandler:function(n){t._isTouchMoved(n,this)&&(n.preventDefault(),this._scroll=!0)},_load:function(){var u=this,t;for(u._setHeightAdjustMode(this.model.heightAdjustMode),this._items.filter(".e-m-acc-state-default").next().hide(),t=0;t<this.selectedItems().length;t++){var i=n(this._getContentElement(this.selectedItems()[t])),r=n(n(i).prev()).find(".e-m-acc-link"),f=n(n(i).prev()).find(".e-m-acc-linkhref"),e=n(r).attr("href");i.is(":empty")&&e!="#"&&this._sendAjaxRequest(i,r,f)}},_getContentElement:function(n){var i,r,t,u;if(!isNaN(+n))for(i=this._contentElements,r=new RegExp("-"+(n+1)+"$"),t=0,u=i.length;t<u;t++)if(r.test(i[t].id))return i[t]},_ajaxSuccessHandler:function(t,i,r,u,f,e){f!=null&&u.html(f);n(i).html(t);n(i).addClass("e-m-acc-ajax");n(r).remove();this.model.ajaxLoad&&this._trigger("ajaxLoad");var t={data:t,url:e.attr("href"),content:i};this.model.ajaxSuccess&&this._trigger("ajaxSuccess",t);this.model.heightAdjustMode=="auto"&&this._enableAutoHeight()},_ajaxErrorHandler:function(n,t,i){var n={data:n,url:t.attr("href"),title:i};this.model.ajaxError&&this._trigger("ajaxError",n)},_sendAjaxRequest:function(i,r,u){var s=t.buildTag("span.e-m-acc-ajax-loading"),f,e,h,c,o,l;this.model.spinnerText!=null&&this.model.spinnerText!=""&&(f=r.html(),r.html(this.model.spinnerText));e=u.attr("href");(!n.support.pushstate||t.isWindowsWebView())&&(e=App.route.makeUrlAbsolute(u.attr("href")));h=n(n(r).parent()).find("span.e-m-acc-ajax-loading");n(h).is(":empty")||r.parent().append(s);c={url:u.attr("href")};this.model.ajaxBeforeLoad&&this._trigger("ajaxBeforeLoad",c);o=this;l={type:"GET",cache:!0,url:e,data:{},dataType:"html",successHandler:function(n){o._ajaxSuccessHandler(n,i,s,r,f,u)},errorHandler:function(n){o._ajaxErrorHandler(n,u,f)}};t.sendAjaxRequest(l)},_enableAutoHeight:function(){for(i=0;i<this.selectedItems().length;i++){var u=!1,t=this._contentElements,u=n(t[this.selectedItems()[i]]).is(":empty"),r=0;t.each(function(){r=Math.max(r,n(this).outerHeight()-20)});u||t.height(r)}},_enableFillSpace:function(){var i=this,r=this.element.parent().height(),t;this.element.parent().css({overflow:"auto"});i._items.each(function(){r-=n(this).outerHeight()});t=0;i._items.next().each(function(){t=Math.max(t,n(this).innerHeight()-n(this).height())}).height(r-t).css({overflow:"auto"})},_select:function(i,r){var u;if(n(i).hasClass("e-m-acc-state-disabled"))t.blockDefaultActions(r);else{u={activeItemIndex:i};this.model.beforeActive&&this._trigger("beforeActive",u);var o=this._getContentElement(this._items.index(i)),h=i.find(".e-m-acc-link"),s=i.find(".e-m-acc-linkhref"),c=s.attr("href"),l=n(o).is(":empty"),f=this.element.find(".e-m-acc-header.e-m-acc-state-active")[0],e=n(f).attr("tabindex"),a=this._getContentElement(parseInt(e));this.model.enableMultipleOpen?n(i[0]).hasClass("e-m-acc-state-active")?this._hideTab(this._items.index(i)):this._showTab(this._items.index(i)):f==i[0]?this.model.collapsible&&this._hideTab(this._items.index(i)):(this._hideTab(e),this._showTab(this._items.index(i)));u={selectedItemIndices:this.selectedItems(),lastSelectedItemIndices:n(f).index(".e-m-acc-header"),items:this._items};this.model.active&&this._trigger("active",u);t.blockDefaultActions(r)}},_showTab:function(t){if(t==null)return!1;this._isAjaxContent(parseInt(t));var i=this._getContentElement(parseInt(t)),r=n(i.previousSibling).hasClass("e-m-state-disabled");if(r)return!1;n(i.previousSibling).addClass("e-m-acc-state-active").removeClass("e-m-acc-state-default");this.model.renderMode=="android"?n(i).slideDown("fast"):n(i).slideDown(300,"linear");this._addSelectedItems(parseInt(t))},_isAjaxContent:function(t){var i=n(this._getContentElement(t)),f=n(n(i).prev()).find(".e-m-acc-link"),r=n(n(i).prev()).find(".e-m-acc-linkhref"),u=n(r).attr("href");(i.is(":empty")&&u!="#"||!this.model.enableCache&&u!="#")&&this._sendAjaxRequest(i,f,r)},_hideTab:function(t){if(t==null)return!1;var i=this._getContentElement(parseInt(t));n(i.previousSibling).removeClass("e-m-acc-state-active").addClass("e-m-acc-state-default");this.model.renderMode=="android"?n(i).slideUp("fast"):n(i).slideUp(300,"linear");this._deleteSelectedItems(parseInt(t))},_addSelectedItems:function(t){n.inArray(t,this.selectedItems())<0&&this.selectedItems().push(t)},_deleteSelectedItems:function(t){n.inArray(t,this.selectedItems())>-1&&(position=n.inArray(t,this.selectedItems()),this.selectedItems().splice(position,1))},_setRenderMode:function(n){n=="auto"?t.setRenderMode(this):this.model.renderMode=n;this.element.removeClass("e-m-ios7 e-m-android e-m-windows e-m-flat").addClass("e-m-"+this.model.renderMode)},_setTheme:function(n){this.element.removeClass("e-m-dark e-m-light").addClass("e-m-"+n)},_enabledAction:function(n){n?(this._enableAll(),this._wireEvents(!1)):(this._disableAll(),this._wireEvents(!0))},_displayHeaderIcon:function(n){this.model.showHeaderIcon=n;var t=n?"inline-block":"none";this._icons.css("display",t)},_setHeightAdjustMode:function(n){n=="fill"?this._enableFillSpace():n=="auto"?this._enableAutoHeight():this._contentElements.css({height:"auto",overflow:"hidden"})},_setMultipleOpen:function(n){this.model.enableMultipleOpen=n;this.collapseAll()},enableItems:function(t){if(!this.model.enabled)return!1;if(n.isArray(t)){var i=this;n.each(t,function(t,r){n(i._items[r]).removeClass("e-m-state-disabled")})}else n(this._items[t]).removeClass("e-m-state-disabled")},disableItems:function(t){if(!this.model.enabled)return!1;if(n.isArray(t)){var i=this;n.each(t,function(t,r){n(i._items[r]).addClass("e-m-state-disabled")})}else n(this._items[t]).addClass("e-m-state-disabled")},_enableAll:function(){var t=[];n.each(this._items,function(i,r){n(r).removeClass("e-m-state-disabled");t.push(i)})},_disableAll:function(){var t=[];n.each(this._items,function(i,r){n(r).addClass("e-m-state-disabled");t.push(i)})},_setModel:function(n){for(var t in n)switch(t){case"renderMode":this._setRenderMode(n.renderMode);break;case"theme":this._setTheme(n.theme);break;case"selectedItems":this.selectItems(n.selectedItems);break;case"disabledItems":this.disableItems(n.disabledItems);break;case"showHeaderIcon":this._displayHeaderIcon(n.showHeaderIcon);break;case"heightAdjustMode":this._setHeightAdjustMode(n.heightAdjustMode);break;case"collapsible":this.model.collapsible=n.collapsible;break;case"enableMultipleOpen":this._setMultipleOpen(n.enableMultipleOpen);break;case"enabled":this._enabledAction(n.enabled);break;case"spinnerText":this.model.spinnerText=n.spinnerText}},_destroy:function(){this._wireEvents(!0);this._cloneElement.insertBefore(this.element);this.element.remove()},show:function(){n(this.element).css("display","block")},hide:function(){n(this.element).css("display","none")},selectItems:function(t){var r,u,f,e,i;if(!this.model.enabled)return!1;if(this.model.enableMultipleOpen)for(i=0;i<t.length;i++)this._showTab(t[i]);else(!n.isArray(t)||n.isArray(t)&&t.length==1)&&(r=parseInt(this.element.find(".e-m-acc-header.e-m-acc-state-active").attr("tabindex")),e=this.element.find(".e-m-acc-header.e-m-acc-state-active")[0],f=this._getContentElement(parseInt(t)),u=f.previousSibling,u==e?this.model.collapsible&&this._hideTab(parseInt(n(u).attr("tabindex"))):(isNaN(r)||this._hideTab(parseInt(r)),this._showTab(t)))},deselectItems:function(t){if(!this.model.enabled)return!1;if(this.model.enableMultipleOpen)for(var i=0;i<t.length;i++)this._hideTab(t[i]);else(!n.isArray(t)||n.isArray(t)&&t.length==1)&&this._hideTab(t)},collapseAll:function(){if(!this.model.enabled)return!1;this.deselectItems(n.makeArray(this.selectedItems()))},expandAll:function(){if(!this.model.enabled)return!1;var t=this;if(!this.model.enableMultipleOpen)return!1;n.each(t._items,function(i){n.inArray(i,t.selectedItems())>-1||t._showTab(i)})},getItemsCount:function(){if(this._items)return this._items.length}});t.mobile.Accordion.HeightAdjustMode={Content:"content",Auto:"auto",Fill:"fill"}})(jQuery,Syncfusion)})