/*!
*  filename: ej.mobile.dialog.min.js
*  version : 12.3
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./ej.mobile.core.min","./ej.mobile.application.min","./ej.mobile.button.min","./ej.mobile.header.min","./ej.mobile.scrollpanel.min","./../common/ej.core.min","./../common/ej.data.min","./../common/ej.unobtrusive.min","./../common/ej.touch.min"],n):n()})(function(){(function(n,t){t.widget("ejmDialog","ej.mobile.Dialog",{_setFirst:!0,_rootCSS:"e-m-dialog",defaults:{enableAutoOpen:!1,title:null,beforeClose:null,open:null,close:null,buttonTap:null,renderMode:"auto",theme:"auto",enableModal:!1,showButtons:!0,allowScrolling:!0,enableNativeScrolling:t.isAndroid()&&t.isLowerAndroid()||t.isIOS()?!1:t.isDevice()?!0:!1,mode:"alert",leftButtonCaption:"Cancel",rightButtonCaption:"Continue",checkDOMChanges:!1,templateId:null,targetHeight:null,enablePersistence:!1,windows:{renderDefault:!1}},dataTypes:{enableAutoOpen:"boolean",renderMode:"enum",enableModal:"boolean",allowScrolling:"boolean",showButtons:"boolean",checkDOMChanges:"boolean",mode:"enum",enablePersistence:"boolean"},_init:function(){this.id=this.element.attr("id");this._browser=t.browser();this._body=App.activePage;t.setRenderMode(this);t.setTheme(this);this.model.renderMode=="windows"&&this.model.windows.renderDefault&&t.isMobile()&&(this.model.theme="default");this._orgEle=this.element.clone();this._renderControl();this._wireEvents()},_renderControl:function(){if(this.element.addClass("e-m-"+this.model.renderMode+" e-m-dialog e-m-user-select e-m-"+this.model.theme+""),this.model.templateId&&t.getCurrentPage().find("#"+this.model.templateId).length){var n=t.getCurrentPage().find("#"+this.model.templateId);this._template=n;t.destroyWidgets(this._template);this._html=n[0].nodeName&&n[0].nodeName.toLowerCase()=="script"?t.getClearString(n[0].innerHTML):n}else this._html=this.model.templateId?this._template:this.element.html();this.element.empty();this.model.buttonTap&&this.model.buttonTap.name&&(this.model.buttonTap=this.model.buttonTap.name);this["_"+this.model.mode+"Type"]();this._dialogInit()},_confirmType:function(){this._renderConfirmAlertDialog()},_alertType:function(){this._renderConfirmAlertDialog()},_normalType:function(){this._renderNormalDialog()},_fullviewType:function(){this._renderFullViewDialog()},_renderConfirmAlertDialog:function(){this.element.addClass("e-m-dlg-table");this._outerDiv=t.buildTag("div.e-m-dlg-table-cell");this._innerDiv=t.buildTag("div.e-m-dlg e-m-dlg-inner e-m-dlg-alert e-m-"+this.model.theme+"");this.model.enableAutoOpen&&this._innerDiv.addClass("e-m-dlg-showanimate").addClass("e-m-dlg-open");this._contDiv=t.buildTag("div.e-m-dlg-content");var n=t.buildTag("div.e-m-dlg-title",this.model.title);this._contDiv.append(n);this._templateDiv=t.buildTag("div#"+this.id+"content.e-m-dlg-desc");this._contDiv.append(this._templateDiv.html(this._html));this.model.showButtons?this._renderDialogButton():this._innerDiv.append(this._contDiv);t.widget.init(this._innerDiv);this.element.append(this._outerDiv.append(this._innerDiv));this.model.allowScrolling&&this._scroll()},_renderNormalDialog:function(){this.element.addClass("e-m-dlg-table");this._outerDiv=t.buildTag("div").css({display:"table-cell"});this._innerDiv=t.buildTag("div.e-m-dlg-inner e-m-"+this.model.theme+" e-m-dlg e-m-dlg-normal");this.model.mode=="fullview"&&this._innerDiv.addClass("e-m-dlgfullview");this.model.enableAutoOpen&&this._innerDiv.addClass("e-m-dlg-open");this.header=t.buildTag("div#"+this.id+"header",{},{},{"data-role":"ejmheader","data-ej-title":this.model.title,"data-ej-rendermode":this.model.renderMode,"data-ej-theme":this.model.theme,"data-ej-position":"normal"});this.model.showButtons&&(this.model.renderMode=="ios7"?this._header():this._headerTemplate());this._innerDiv.append(this.header);this._content=t.buildTag("div#"+this.id+"content.e-m-dlg-content").css("padding","10px 15px");this._content.html(this._html);this._innerDiv.append(this._content);t.widget.init(this._innerDiv);this.element.append(this._outerDiv.append(this._innerDiv));this._headerHeight=this.element.find(".e-m-header").outerHeight();this._height=window.innerHeight-(this._headerHeight+20);this._content.height(this._height);this._scrollWrapper=t.buildTag("div#"+this.id+"_scroll");this._content.append(this._scrollWrapper);this._scrollPanel()},_renderFullViewDialog:function(){this.model.renderMode=="ios7"?this._renderNormalDialog():this._fullViewDialog()},_scroll:function(){this._scrollWrapper=t.buildTag("div#"+this.id+"_scroll");this._templateDiv.append(this._scrollWrapper);this._height=t.getDimension(this._templateDiv,"outerHeight");this._titHeight=t.getDimension(this.element.find(".e-m-dlg-title"),"outerHeight");this._btnHeight=t.getDimension(this.element.find(".e-m-dlg-btn"),"outerHeight");this._dlgScrollHeight=this.model.targetHeight?this.model.targetHeight:window.innerHeight-(this._titHeight+this._btnHeight+50);this._height>this._dlgScrollHeight&&(this._templateDiv.height(this._dlgScrollHeight).css("padding","0px 15px"),this._scrollPanel())},_scrollPanel:function(){this._scrollWrapper.ejmScrollPanel({target:this.id+"content",targetHeight:this._dlgScrollHeight,checkDOMChanges:this.model.checkDOMChanges,enableHrScroll:!1,enableVerScroll:!0,renderMode:this.model.renderMode,enableNativeScrolling:this.model.enableNativeScrolling})},_header:function(){this.header.attr({"data-ej-leftbuttoncaption":this.model.leftButtonCaption,"data-ej-rightbuttoncaption":this.model.rightButtonCaption,"data-ej-leftbuttonstyle":"header","data-ej-showleftbutton":"true","data-ej-showrightbutton":"true"});this.model.buttonTap&&this.header.attr({"data-ej-leftbuttontap":this.model.buttonTap,"data-ej-rightbuttontap":this.model.buttonTap})},_headerTemplate:function(){var n=t.buildTag("div.e-m-norbtnok"),i=t.buildTag("div.e-m-norbtncancel"),r=t.buildTag("input#btnok",{},{},{type:"button","data-role":"ejmbutton","data-ej-text":this.model.leftButtonCaption,"data-ej-rendermode":this.model.renderMode,"data-ej-inline":"true","data-ej-theme":this.model.theme,windows:{renderDefault:this.model.windows.renderDefault}}),u=t.buildTag("input#btncancel",{},{},{type:"button","data-role":"ejmbutton","data-ej-text":this.model.rightButtonCaption,"data-ej-rendermode":this.model.renderMode,"data-ej-inline":"true","data-ej-theme":this.model.theme,windows:{renderDefault:this.model.windows.renderDefault}});this.model.buttonTap&&(r.attr({"data-ej-touchend":this.model.buttonTap}),u.attr({"data-ej-touchend":this.model.buttonTap}));n.append(r);i.append(u);this.header.append(n).append(i)},_fullViewDialog:function(){var e,n,i,r,u,f;this._innerDiv=t.buildTag("div.e-m-dlg e-m-"+this.model.theme+" e-m-dlg-open e-m-dlgfullview");this._contDiv=t.buildTag("div.e-m-dlg-content");e=t.buildTag("div.e-m-dlg-title",this.model.title);this._contDiv.append(e);this._templateDiv=t.buildTag("div#"+this.id+"content.e-m-dlg-desc");this._contDiv.append(this._templateDiv.html(this._html));this.model.showButtons&&(n=t.buildTag("div.e-m-dlg-btn"),i=t.buildTag("input",{},{},{type:"button"}),n.append(i),r=this.model.renderMode=="windows"?"normal":"dialog",this._renderButton(i,this.model.leftButtonCaption,this.id+"_left",r),u=t.buildTag("input",{},{},{type:"button"}),n.append(u),this._renderButton(u,this.model.rightButtonCaption,this.id+"_right",r),this._innerDiv.append(this._contDiv.append(n)));this._innerDiv.append(this._contDiv);t.widget.init(this._innerDiv);this.element.append(this._innerDiv);this._scrollWrapper=t.buildTag("div#"+this.id+"_scroll");this._templateDiv.append(this._scrollWrapper);this._fullTitHeight=this.element.find(".e-m-dlg-title").outerHeight();this._fullBtnHeight=this.element.find(".e-m-dlg-btn").outerHeight();f=this.model.targetHeight?this.model.targetHeight:window.innerHeight-(this._fullTitHeight+this._fullBtnHeight+20);this._templateDiv.height(f).css("padding","10px 15px");this._scrollPanel();this._scrollWrapper.ejmScrollPanel({targetHeight:f})},_renderDialogButton:function(){var n=t.buildTag("div.e-m-dlg-btn"),i,r,u;this.model.mode=="alert"&&n.addClass("e-m-alert");i=t.buildTag("input",{},{},{type:"button"});n.append(i);r=this.model.renderMode=="windows"?"normal":"dialog";this._renderButton(i,this.model.leftButtonCaption,this.id+"_left",r);this.model.mode=="confirm"&&(u=t.buildTag("input",{},{},{type:"button"}),n.append(u),this._renderButton(u,this.model.rightButtonCaption,this.id+"_right",r));this._innerDiv.append(this._contDiv.append(n))},_renderButton:function(n,t,i,r){this.model.renderMode!="flat"&&n.attr("data-ej-theme",this.model.theme);n.attr({"data-role":"ejmbutton","data-ej-text":t,id:i+"_btn","data-ej-rendermode":this.model.renderMode,"data-ej-touchend":this.model.buttonTap,windows:{renderDefault:this.model.windows.renderDefault}}).attr("data-ej-"+this.model.renderMode+"-style",r)},_dialogInit:function(){this.element.parents("form").length>0?this.element.appendTo(this.element.parents("form")):this.element.appendTo(App.activePage);this.model.enableModal&&this.model.mode!="fullview"&&this._setModal();this.model.enableAutoOpen||(this.element.css("display","none"),this._body.find("#"+this.id+"_dialog_overlay").css("display","none"));this._setDialogPosition()},_wireEvents:function(i){t.listenEvents([window,window],["resize","orientationchange"],[n.proxy(this._onResize,this),n.proxy(this._onOrientationChange,this)],i)},_onResize:function(){this._setDialogPosition();this.element.css({"z-index":t.getMaxZindex()+1})},_onOrientationChange:function(){var n=this;window.setTimeout(function(){n._setDialogPosition()},t.isAndroid()?200:0)},_setDialogPosition:function(){var t;n(this.element).is(":visible")&&(this.model.mode=="normal"||this.model.mode=="fullview"&&this.model.renderMode=="ios7"?(this._height=window.innerHeight-(this._headerHeight+20),this._content.height(this._height)):this.model.mode=="fullview"&&this.model.renderMode!="ios7"?(t=this.model.targetHeight?this.model.targetHeight:window.innerHeight-(this._fullTitHeight+this._fullBtnHeight+20),this.element.find(".e-m-dlg-desc").height(t),this._scrollWrapper.ejmScrollPanel({targetHeight:t})):(t=this.model.targetHeight?this.model.targetHeight:window.innerHeight-(this._titHeight+this._btnHeight+50),this._height>t&&(this._templateDiv.height(t).css("padding","0px 15px"),this._scrollPanel(),this._scrollWrapper.ejmScrollPanel({targetHeight:t}))))},_setModal:function(){var n=this._body.find("#"+this.id+"_dialog_overlay");(n==null||n.length<=0)&&(n=t.buildTag("div#"+this.id+"_dialog_overlay.e-m-"+this.model.renderMode+" e-m-overlay"));this._body.append(n)},_refresh:function(){this._destroy();this._renderControl();this._wireEvents(!1)},_destroy:function(){this.element.removeAttr("class");this.model.enableModal&&this._body.find("#"+this.id+"_dialog_overlay").remove();this.element.html(this._orgEle.html())},_setModel:function(n){var r=!1,t,i;for(t in n)i="_set"+t.charAt(0).toUpperCase()+t.slice(1),this[i]?this[i]():r=!0;r&&this._refresh()},_setRenderMode:function(){this._refresh()},_setTheme:function(){this.element.removeClass("e-m-dark e-m-light").addClass("e-m-"+this.model.theme+"");this.element.find(".e-m-dlg-open").removeClass("e-m-dark e-m-light").addClass("e-m-"+this.model.theme+"");this.element.find(".e-m-dlg-btn").find(".e-m-btn").ejmButton({theme:this.model.theme});this.element.find(".e-m-header").ejmHeader({theme:this.model.theme});this.element.find(".e-m-header").find(".e-m-btn").ejmButton({theme:this.model.theme});this.element.find(".e-m-scrollpanel").ejmScrollPanel({theme:this.model.theme})},_setMode:function(){this._refresh()},_setTitle:function(){this.element.children().hasClass("e-m-header")?this.element.find(".e-m-header").ejmHeader({title:this.model.title}):this.element.find(".e-m-dlg-title").html(this.model.title)},_setEnableModal:function(){this.model.enableModal&&this.model.enableAutoOpen&&this.model.mode!="fullview"?this._setModal():this._body.find("#"+this.id+"_dialog_overlay").remove()},_setShowButtons:function(){this._refresh()},_setButtonTap:function(){this.element.find(".e-m-btn").ejmButton({touchEnd:this.model.buttonTap})},_setBeforeClose:function(){},_setClose:function(){},_setOpen:function(){},open:function(){this.element.css({"z-index":t.getMaxZindex()+1});this.model.enableModal&&this.model.mode!="fullview"&&this._body.find("#"+this.id+"_dialog_overlay").css("display","block");this.element.css("display","table");this._innerDiv.removeClass("e-m-dlg-hideanimate").addClass("e-m-dlg-showanimate").addClass("e-m-dlg-open");var n={title:this.model.title};this.model.open&&this._trigger("open",n)},close:function(){var n={title:this.model.title};this.model.beforeClose&&this._trigger("beforeClose",n);this.model.enableModal&&this.model.mode!="fullview"&&this._body.find("#"+this.id+"_dialog_overlay").css("display","none");this._innerDiv.removeClass("e-m-dlg-showanimate").addClass("e-m-dlg-hideanimate").removeClass("e-m-dlg-open");this.element.css("display","none");this.model.close&&this._trigger("close",n)},isOpened:function(){return n(this.element).is(":visible")?!0:!1}});t.mobile.Dialog.Mode={Alert:"alert",Confirm:"confirm",Normal:"normal",FullView:"fullview"}})(jQuery,Syncfusion)})