/*!
*  filename: ej.mobile.listview.min.js
*  version : 12.4.0.24
*  Copyright Syncfusion Inc. 2001 - 2014. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./ej.mobile.core.min","./ej.mobile.application.min","./ej.mobile.button.min","./ej.mobile.checkbox.min","./ej.mobile.textbox.min","./ej.mobile.header.min","./ej.mobile.scrollpanel.min","./../common/ej.core.min","./../common/ej.data.min","./../common/ej.unobtrusive.min","./../common/ej.touch.min"],n):n()})(function(){(function($,ej,undefined){ej.widget("ejListViewBase","ej.ListViewBase",{defaults:{height:null,width:null,selectedItemIndex:-1,enableGroupList:!1,enableAjax:!1,enableCache:!1,enablePersistence:!1,load:null,loadComplete:null,ajaxBeforeLoad:null,ajaxSuccess:null,ajaxError:null,ajaxComplete:null,ajaxSettings:{type:"GET",cache:!1,async:!0,dataType:"html",contentType:"html",url:"",data:{}},renderTemplate:!1,templateId:null,persistSelection:!1,preventSelection:!1,dataSource:[],query:null,showHeader:!1,headerTitle:"Title",headerBackButtonText:null,fieldSettings:{navigateUrl:"navigateUrl",href:"href",enableAjax:"enableAjax",preventSelection:"preventSelection",persistSelection:"persistSelection",text:"text",enableCheckMark:"enableCheckMark",checked:"checked",primaryKey:"primaryKey",parentPrimaryKey:"parentPrimaryKey",imageClass:"imageClass",imageUrl:"imageUrl",childHeaderTitle:"childHeaderTitle",childId:"childId",childHeaderBackButtonText:"childHeaderBackButtonText",renderTemplate:"renderTemplate",templateId:"templateId",touchStart:"touchStart",touchEnd:"touchEnd",attributes:"attributes"},enableFiltering:!1,enableCheckMark:!1},observables:["selectedItemIndex","dataSource"],selectedItemIndex:ej.util.valueFunction("selectedItemIndex"),dataSource:ej.util.valueFunction("dataSource"),_load:function(){if(this._orgEle=this.element.clone(),this._index=0,this._items=[],this._indexVal=0,this.model.id=this.element[0].id,this.model.load&&this._trigger("load"),this.model.fieldSettings=eval(this.model.fieldSettings),this.model.fieldSettings&&this.model.query!=null){var proxy=this;proxy._prefixClass=="e-m-"&&App.waitingPopUp.show();this.dataSource().executeQuery(eval(this.model.query)).done(function(n){proxy.model.dataSource=n.result;proxy._renderControl();proxy._prefixClass=="e-m-"&&App.waitingPopUp.hide()})}else this._renderControl()},_renderControl:function(){var f,i,e,o,t,s,n,u,r;if(this.element.addClass(this._prefixClass+"parentlv "),this._lbEle=ej.buildTag("div."+this._rootCSS),this._lbEle.addClass("subpage"),this._prefixClass=="e-m-"&&(this._lbEle.addClass("e-m-"+this.model.renderMode+" e-m-"+this.model.theme).addClass(ej.isMobile()?"e-m-mobile":"e-m-tablet"),this.model.ios7.inline&&this._lbEle.addClass("e-m-inline")),this._lContainer=ej.buildTag("div."+this._prefixClass+"list-container#"+this.model.id+"_container"),n=this.element.find(">ul"),this.model.showHeader&&(f=this._renderHeader(this.model.id,this.model.showHeaderBackButton,this.model.headerTitle,this.model.headerBackButtonText),this._lbEle.prepend(f)),this._prefixClass=="e-m-"&&this.model.allowScrolling&&this._renderScrollPanel(this._lbEle,this.model.id+"_scroll",this.model.id+"_container"),this._hasDataSource()&&!this.model.renderTemplate&&this.element.empty(),this.model.renderTemplate&&(this.model.templateId?ej.getCurrentPage().find("#"+this.model.templateId).length&&(this._template=ej.getCurrentPage().find("#"+this.model.templateId),ej.destroyWidgets(this._template),this._template.remove(),this._template=this._template[0].nodeName&&this._template[0].nodeName.toLowerCase()=="script"?ej.getClearString(this._template[0].innerHTML):this._template[0].outerHTML):(ej.destroyWidgets(this.element),this._template=this.element.html(),this.element.empty())),!this.model.renderTemplate||this._hasDataSource()||this.model.enableGroupList){if(!this.model.renderTemplate||this.model.renderTemplate&&this._hasDataSource()||this.model.renderTemplate&&this.model.enableGroupList){if(this.model.enableGroupList){if(this._lContainer.addClass(this._prefixClass+"grouped"),i=ej.buildTag("div."+this._prefixClass+"grouplist"),n=this.element.children(),n.length)for(e=this._hasDataSource()?this.dataSource().length:n.length,t=0;t<e;t++)this._hasDataSource()?(this._items=this.dataSource()[t].items,this.model.renderTemplate?ulItem=n[t]:(ulItem=ej.buildTag("ul"),this._lbEle.append(ulItem))):(this._items=[],ulItem=n[t]),o=this._hasDataSource()?this.dataSource()[t].key:ej.getAttrVal($(ulItem),"data-ej-grouplisttitle","GroupList"+(t+1)),s=ej.buildTag("div."+this._prefixClass+"groupdiv",ej.buildTag("div."+this._prefixClass+"grouptitle",o)),i.append(s.append(this._renderListItems($(ulItem).addClass(this._prefixClass+"grouped"))));else this._template&&(ej.destroyWidgets(this._template),i[0].innerHTML=this._template);this._lContainer.append(i);ej.widget.init&&ej.widget.init(i)}else this._hasDataSource()&&(n=ej.buildTag("ul"),this._items=this.dataSource()),n.length?(ej.destroyWidgets(n),this._lContainer.append(this._renderListItems(n))):this._template&&(ej.destroyWidgets(this._template),this._lContainer[0].innerHTML=this._template);this.element.prepend(this._lbEle);this.model.enableFiltering&&this._createFilterWrapper(this._lbEle);this._lbEle.append(this._lContainer);ej.widget.init&&ej.widget.init(this._lContainer);u=this.element.find("li."+this._prefixClass+"list");u.removeEleEmptyAttrs();u.find("."+this._prefixClass+"list-anchor").removeEleEmptyAttrs();ej.widget.init&&ej.widget.init(this._lbEle);r=this.element.find("ul");r.find("li:first").addClass(this._prefixClass+"firstitem");r.find("li:last").addClass(this._prefixClass+"lastitem");this._liEl=this.element.find("li");this.selectedItemIndex()>=0&&!this.model.preventSelection&&this.model.persistSelection&&!ej.getBooleanVal(r[this.selectedItemIndex()],"data-preventselection",this.model.preventSelection)&&ej.getBooleanVal(r[this.selectedItemIndex()],"data-persistselection",this.model.persistSelection)&&(this._currentItem=$(this._liEl[this.selectedItemIndex()]),this._prevItem=this._currentItem,this._currentItem.removeClass(this._prefixClass+"state-default").addClass(this._prefixClass+"state-active"));$(this.element.find("."+this._prefixClass+"lv-check").parent()).addClass(this._prefixClass+"lv-checkdiv");$(this.element.find("."+this._prefixClass+"lv-check").closest("li."+this._prefixClass+"list")).addClass(this._prefixClass+"list-check");$(this.element.find("."+this._prefixClass+"lv-input").closest("."+this._prefixClass+"lv-filter")).addClass(this._prefixClass+"lv-inputdiv");this._wireEvents()}}else this.element.append(this._lbEle.append(this._lContainer)),this._template&&(this._lContainer.append(this._template),ej.widget.init&&ej.widget.init(this._lContainer));this._setHeightWidth();this.model.loadComplete&&this._trigger("loadComplete")},_createFilterWrapper:function(n){var t=this._createFilterDiv(),i=ej.buildTag("a."+this._prefixClass+"lv-anchor",ej.buildTag("span."+this._prefixClass+"input-btn"),{},{Title:"Clear text","data-role":"none"});$(t).append(i);n.append(t)},_renderListItems:function(ul){var proxy=this,ulItems,j;if(ul.addClass(this._prefixClass+"list-hdr "+this._prefixClass+"clearall"),this._liItems=ul.find(">li"),this._liItems.length&&!this._hasDataSource()||this._hasDataSource()){this._renderParentChildTemplate();this._hasDataSource()||this._liItems.each(function(n,t){proxy._generateData(t,null,ej.getAttrVal(t,"data-ej-primarykey",null))});this._items=eval(this._items);var dataMgr=ej.DataManager(this._items),parentItem=dataMgr.executeLocal(ej.Query().from(this._items).where(ej.Predicate(this.model.fieldSettings.parentPrimaryKey,ej.FilterOperators.equal,null)).group(this.model.fieldSettings.parentPrimaryKey)),grouped=dataMgr.executeLocal(ej.Query().from(this._items).where(ej.Predicate(this.model.fieldSettings.parentPrimaryKey,ej.FilterOperators.notEqual,null)).group(this.model.fieldSettings.parentPrimaryKey));if(parentItem[0])for(ul.empty().html($(this.jsRender).render(parentItem[0].items)),grouped.length&&(this.element.append($(this.jsChildRender).render(grouped)),$.each(grouped,function(n,t){var u,r,i;for(ej.widget.init&&ej.widget.init(proxy.element.find("#child"+t.key)),u=proxy.element.find("#child"+t.key).find("ul"),r=u.find("li"),k=0,i=0;i<r.length;i++)grouped[k].items[i]&&grouped[k].items[i].attributes&&$(r[i]).addEleAttrs(grouped[k].items[i].attributes);k++})),ulItems=ul.find(">li"),j=0;j<ulItems.length;j++)parentItem[0].items[j]&&parentItem[0].items[j].attributes&&$(ulItems[j]).addEleAttrs(parentItem[0].items[j].attributes)}return this._initEJCheckBox&&this._initEJCheckBox(ul),ul},_renderParentChildTemplate:function(){var t=this._renderLists(),i,n,r;$.views.helpers({_checkAjaxUrls:this._checkAjaxUrl,_checkImgUrls:this._checkImgUrl,_checkIsChecked:this._checkIsCheck,Object:this,ej:ej});this.jsRender=ej.buildTag("script#"+this.model.id+"_Template","",{},{type:"text/x-jsrender"});this.jsRender[0].text=ej.browserInfo().name=="msie"&&ej.browserInfo().version<10?t[0].outerHTML.replace(/&gt;/g,">"):t[0].outerHTML.replace(/&gt;/g,">");this.jsChildRender=ej.buildTag("script#"+this.model.id+"_ChildTemplate","",{},{type:"text/x-jsrender"});i=ej.buildTag("ul."+this._prefixClass+"childcontainer "+this._prefixClass+"list-hdr "+this._prefixClass+"clearall");t.addClass(this._prefixClass+"childli");i[0].innerHTML="{{for items}}"+t[0].outerHTML+"{{/for}}";n=ej.buildTag("div."+this._rootCSS+" subpage "+this._prefixClass+"childitem","",{},{id:"{{if key}}child{{>key}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}",style:"display:none"});this._prefixClass=="e-m-"&&n.addClass(this._prefixClass+this.model.renderMode+this._prefixClass+this.model.theme+!ej.isMobile()?" e-m-tablet":" e-m-mobile");r=ej.buildTag("div."+this._prefixClass+"list-container","",{},{id:"{{if key}}child{{>key}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}_container"});this.model.showHeader&&n.append(this._renderHeader("{{if key}}child{{>key}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}",!0,"Title"));this.model.enableFiltering&&this._createFilterWrapper(n);n.append(r.append(i));this._prefixClass=="e-m-"&&this.model.allowScrolling&&this._renderScrollPanel(n,"{{if key}}child{{>key}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}_scroll","{{if key}}child{{>key}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}_container");ej.browserInfo().name=="msie"&&ej.browserInfo().version<10?this.jsChildRender[0].text=n[0].outerHTML.replace(/&gt;/g,">"):this.jsChildRender[0].innerHTML=n[0].outerHTML.replace(/&gt;/g,">")},_renderLists:function(){var n=ej.buildTag("li","",{},{"class":this._prefixClass+"user-select "+this._prefixClass+"list "+this._prefixClass+"state-default{{if "+this.model.fieldSettings.primaryKey+" || "+this.model.fieldSettings.enableAjax+" || "+this.model.enableAjax+"}} "+this._prefixClass+"arrow{{/if}}{{if "+this.model.fieldSettings.imageClass+"}} "+this._prefixClass+"margin{{else}}{{if "+this.model.fieldSettings.imageUrl+"}} "+this._prefixClass+"margin{{/if}}{{/if}}","data-childid":"{{if "+this.model.fieldSettings.primaryKey+"}}child{{>"+this.model.fieldSettings.primaryKey+"}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}","data-childtitle":"{{>"+this.model.fieldSettings.childHeaderTitle+"}}","data-childbackbutton":"{{>"+this.model.fieldSettings.childHeaderBackButtonText+"}}","data-preventSelection":"{{>"+this.model.fieldSettings.preventSelection+"}}","data-persistSelection":"{{>"+this.model.fieldSettings.persistSelection+"}}","data-navigateUrl":"{{>"+this.model.fieldSettings.navigateUrl+"}}","data-loadajax":"{{>"+this.model.fieldSettings.enableAjax+"}}","data-href":"{{>"+this.model.fieldSettings.href+"}}{{:~_checkAjaxUrls()}}","data-check":"{{>"+this.model.fieldSettings.enableCheckMark+"}}","data-templateid":"{{>"+this.model.fieldSettings.renderTemplate+"}}","data-touchstart":"{{>"+this.model.fieldSettings.touchStart+"}}","data-touchend":"{{>"+this.model.fieldSettings.touchEnd+"}}"}),i;if(this.model.renderTemplate)this._hasDataSource()&&this._template&&(n[0].innerHTML=this._template);else{var r=ej.buildTag("a","",{},{"class":this._prefixClass+"list-anchor "+this._prefixClass+"remove-shadow{{if "+this.model.fieldSettings.imageClass+"}} "+this._prefixClass+"margin{{else}}{{if "+this.model.fieldSettings.imageUrl+"}} "+this._prefixClass+"margin{{/if}}{{/if}}{{if "+this.model.fieldSettings.primaryKey+" || "+this.model.fieldSettings.enableAjax+" || "+this.model.enableAjax+"}} "+this._prefixClass+"fontimage{{/if}}",href:ej.browserInfo().name=="msie"&&ej.browserInfo().version<9?"{{if "+this.model.fieldSettings.navigateUrl+" == ''}}#{{else}}{{:"+this.model.fieldSettings.navigateUrl+"}}{{/if}}":""}),u=ej.buildTag("span","{{>"+this.model.fieldSettings.text+"}}",{},{"class":this._prefixClass+"list-text "+this._prefixClass+"rel "+this._prefixClass+"user-select{{if "+this.model.fieldSettings.imageClass+"}} "+this._prefixClass+"text{{else}}{{if "+this.model.fieldSettings.imageUrl+"}} "+this._prefixClass+"text{{/if}}{{/if}}"}),f=ej.buildTag("div","",{},{"class":this._prefixClass+"list-img "+this._prefixClass+"rel "+this._prefixClass+"user-select {{>"+this.model.fieldSettings.imageClass+"}}"}),t=this._createCheckBox();r[0].innerHTML=this.model.renderMode=="windows"&&ej.isMobile()?"{{if !"+this.model.fieldSettings.primaryKey+"}}{{if "+this.model.fieldSettings.enableAjax+" == undefined || "+this.model.fieldSettings.enableAjax+".toString() == 'false'}}{{if !"+this.model.fieldSettings.navigateUrl+"}}{{if "+this.model.fieldSettings.enableCheckMark+" !== undefined}}{{if "+this.model.fieldSettings.enableCheckMark+".toString() == 'false' ? "+this.model.fieldSettings.enableCheckMark+" : "+this.model.enableCheckMark+"}}"+t[0].outerHTML+"{{/if}}{{else}}{{if "+this.model.enableCheckMark+"}}"+t[0].outerHTML+"{{/if}}{{/if}}{{/if}}{{/if}}{{/if}}{{if "+this.model.fieldSettings.imageClass+"}}"+f[0].outerHTML+"{{else}}{{if "+this.model.fieldSettings.imageUrl+"}}{{:~_checkImgUrls()}}{{/if}}{{/if}}"+u[0].outerHTML:"{{if "+this.model.fieldSettings.imageClass+"}}"+f[0].outerHTML+"{{else}}{{if "+this.model.fieldSettings.imageUrl+"}}{{:~_checkImgUrls()}}{{/if}}{{/if}}"+u[0].outerHTML+"{{if !"+this.model.fieldSettings.primaryKey+"}}{{if "+this.model.fieldSettings.enableAjax+" == undefined || "+this.model.fieldSettings.enableAjax+".toString() == 'false'}}{{if !"+this.model.fieldSettings.navigateUrl+"}}{{if "+this.model.fieldSettings.enableCheckMark+" !== undefined}}{{if "+this.model.fieldSettings.enableCheckMark+".toString() == 'false' ? "+this.model.fieldSettings.enableCheckMark+" : "+this.model.enableCheckMark+"}}"+t[0].outerHTML+"{{/if}}{{else}}{{if "+this.model.enableCheckMark+"}}"+t[0].outerHTML+"{{/if}}{{/if}}{{/if}}{{/if}}{{/if}}";n[0].innerHTML="{{if "+this.model.fieldSettings.renderTemplate+" == undefined || "+this.model.fieldSettings.renderTemplate+".toString() == 'false'}}"+r[0].outerHTML+"{{else}}{{:templateId}}{{/if}}"}return this.model.renderMode=="ios7"&&(i=ej.buildTag("div."+this._prefixClass+"list-div"),i[0].innerHTML=n[0].innerHTML,n.empty().append(i)),n},_renderChild:function(n){this._currentItem.attr("data-childid",n);this._currentItem.attr("data-childtitle")||this._currentItem.attr("data-childtitle",this._currentItem.text());this._createListDiv(n);this._div.hide();this._prefixClass=="e-m-"&&this._div.addClass(ej.isMobile()?this._prefixClass+"m-mobile":this._prefixClass+"m-tablet");this._container=ej.buildTag("div."+this._prefixClass+"list-container#"+n+"_container");this.element.append(this._div);this.model.allowScrolling&&this._renderScrollPanel(this._div,n+"_scroll",n+"_container")},_checkAjaxUrl:function(){var r=this.data.href,t=this.getRsc("helpers","Object"),i=this.getRsc("helpers","ej"),n;r&&r.indexOf("#")!=-1&&r!="#"?t._storedContent[this.index]?t._storedContent[this.index]&&i.getCurrentPage().find(r).length&&(n=i.getCurrentPage().find(r).remove(),n=n[0].nodeName&&n[0].nodeName.toLowerCase()=="script"?i.getClearString(n[0].innerHTML):n[0].outerHTML,t._storedContent=i._pushValue(t._storedContent,n,this.index)):(n=i.getCurrentPage().find(r).remove(),t._storedContent[this.index]=n[0].nodeName&&n[0].nodeName.toLowerCase()=="script"?i.getClearString(n[0].innerHTML):n[0].outerHTML):t._storedContent[this.index]&&(t._storedContent=i._pushValue(t._storedContent,"",this.index))},_checkImgUrl:function(){var n=this.getRsc("helpers","Object"),t=this.data[n.model.fieldSettings.imageUrl];return $.support.pushstate||(t=typeof App=="object"?App.route.makeUrlAbsolute(t,!0):t),"<img src = "+t+" class='"+n._prefixClass+"list-img "+n._prefixClass+"rel "+n._prefixClass+"user-select'/>"},_checkIsCheck:function(){return this.data[this.getRsc("helpers","Object").model.fieldSettings.checked]?!0:!1},_generateData:function(n,t,i){var f=ej.getAttrVal(n,"data-ej-text",$(n).text()),e=null,u=$(n),c=ej.getAttrVal(n,"data-ej-childbuttontext",""),o=ej.getBooleanVal(n,"data-ej-rendertemplate",!1),r,s,h;o&&(ej.getCurrentPage().find("#"+ej.getAttrVal(n,"data-ej-templateid")).length?(r=ej.getCurrentPage().find("#"+ej.getAttrVal(n,"data-ej-templateid")).remove(),this._storedTemplate[this._indexVal]=r[0].nodeName&&r[0].nodeName.toLowerCase()=="script"?ej.getClearString(r[0].innerHTML):r[0].outerHTML):this._storedTemplate[this._indexVal]?this._storedTemplate[this._indexVal]&&ej.getCurrentPage().find("#"+ej.getAttrVal(n,"data-ej-templateid")).length&&(r=ej.getCurrentPage().find("#"+ej.getAttrVal(n,"data-ej-templateid")).remove(),r=r[0].nodeName&&r[0].nodeName.toLowerCase()=="script"?ej.getClearString(r[0].innerHTML):r[0].outerHTML,this._storedTemplate=ej._pushValue(this._storedTemplate,r,this._indexVal)):this._storedTemplate[this._indexVal]=n.innerHTML,this._indexVal++);u.find(">ul").length&&(s=this,e=ej.getAttrVal(n,"data-ej-childtitle",f),$(n).attr("data-ej-primarykey")||($(n).attr("data-ej-primarykey",Math.round(Math.random()*100)),i=ej.getAttrVal(n,"data-ej-primarykey")),h=u.find(">ul").find(">li"),h.each(function(n,t){s._generateData(t,ej.getAttrVal(t,"data-ej-parentkey",i),ej.getAttrVal(t,"data-ej-primarykey",null))}));this._items[this._index]={navigateUrl:ej.getAttrVal(n,"data-ej-navigateUrl",""),href:ej.getAttrVal(n,"data-ej-href",""),enableAjax:ej.getBooleanVal(n,"data-ej-enableAjax",this.model.enableAjax),preventSelection:ej.getBooleanVal(n,"data-ej-preventSelection",this.model.preventSelection),persistSelection:ej.getBooleanVal(n,"data-ej-persistSelection",this.model.persistSelection),text:f,enableCheckMark:ej.getBooleanVal(n,"data-ej-enableCheckMark",this.model.enableCheckMark),checked:ej.getBooleanVal(n,"data-ej-checked",!1),primaryKey:i,parentPrimaryKey:t,imageClass:ej.getAttrVal(n,"data-ej-imageclass",""),imageUrl:ej.getAttrVal(n,"data-ej-imageurl",""),childHeaderTitle:e,childId:ej.getAttrVal(n,"data-ej-childid","page_"+parseInt(Math.random().toFixed(3)*1e3)),childHeaderBackButtonText:c,renderTemplate:o,templateId:this._storedTemplate[this._indexVal-1],touchStart:ej.getAttrVal(n,"data-ej-touchstart",null),touchEnd:ej.getAttrVal(n,"data-ej-touchend",null),attributes:u.removeEleAttrs(/^data-ej-/)[0].attributes};this._index+=1},_onTouchStartHandler:function(n){ej.isDevice()||ej._preventDefaultException(n.target,this._preventDefaultException)||n.preventDefault&&n.preventDefault();ej.isWindows&&ej.isWindows()&&ej._touchStartPoints(n,this);this._currentItem=$(n.currentTarget);this._scroll=!1;ej.getBooleanVal(this._currentItem,"data-preventSelection",this.model.preventSelection)||this._addSelection();this.model.renderMode!="windows"||this.model.windows.preventSkew||this._currentItem.addClass(ej.isMobile()?ej._getSkewClass($(this._currentItem),n.pageX,n.pageY):this._prefixClass+"m-skew-center");this._triggerStartEvent(this._returnData());ej.listenEvents([this._liEl,this._liEl],[ej.endEvent(),ej.moveEvent(),ej.cancelEvent()],[this._touchEndDelegate,this._touchMoveDelegate,this._touchMoveDelegate],!1,this);$(window).bind(ej.endEvent(),this._docClickDelegate)},_onTouchMoveHandler:function(n){(!ej.isWindows||ej.isWindows&&!ej.isWindows()||ej.isWindows&&ej.isWindows()&&ej._isTouchMoved(n,this))&&(this._scroll=!0,ej.getBooleanVal(this._currentItem,"data-persistSelection",this.model.persistSelection)?this._prevItem&&this._prevItem[0]!=this._currentItem[0]&&this._removeSelection():this._removeSelection(),this.model.renderMode!="windows"||this.model.windows.preventSkew?this.model.renderMode!="windows"&&!ej.getBooleanVal(this._currentItem,"data-preventselection",this.model.preventSelection)&&this._prevItem&&ej.getBooleanVal(this._currentItem,"data-persistSelection",this.model.persistSelection)&&this._prevItem.removeClass(this._prefixClass+"state-default").addClass(this._prefixClass+"state-active"):ej._removeSkewClass(this._currentItem))},_onTouchEndHandler:function(n){var u,r,t,i,f;if(this._isFromAjax=!1,ej.getBooleanVal(this._currentItem,"data-persistSelection",this.model.persistSelection)||this._removeSelection(),this.model.renderMode!="windows"||this.model.windows.preventSkew||ej._removeSkewClass(this._currentItem),this._scroll)return this._setCurrent(),this._unbindEvents(n),!1;if(this._scroll)this.model.renderMode!="windows"||ej.isMobile()||this._touchEndEventHandler();else{if(this._currentItem.find("."+this._prefixClass+"lv-check").length&&(u=this._currentItem.find("."+this._prefixClass+"lv-check"),this._prefixClass!="e-m-"&&(this._prefixClass!="e-"||$(n.target).closest(".e-lv-checkdiv").length)||this._toggleCheckboxValue(u)),r=this._prefixClass=="e-m-"?this._currentItem.attr("data-childbackbutton")==undefined?this._currentItem.closest("."+this._rootCSS+"").find("."+this._prefixClass+"header").length?this._currentItem.closest("."+this._rootCSS+"").find("."+this._prefixClass+"header").ejmHeader("getTitle"):"Back":ej.getAttrVal(this._currentItem,"data-childbackbutton"):this._currentItem.attr("data-childbackbutton")==undefined?this._currentItem.closest("."+this._rootCSS+"").find("."+this._prefixClass+"header").length?this._currentItem.closest("."+this._rootCSS+"").find("."+this._prefixClass+"header ."+this._prefixClass+"htitle").text():"Back":ej.getAttrVal(this._currentItem,"data-childbackbutton"),t=this._currentItem.attr("data-href"),this._currentItem.attr("data-navigateUrl"))this._touchEndEventHandler();else{if(i=this.element.find("[data-ajaxurl='"+this._convertToRelativeUrl(t)+"']"),ej.getBooleanVal(this._currentItem,"data-loadajax",this.model.enableAjax)&&(!this.model.enableCache||i.length==0)){i.length&&i.remove();this.loadAjaxContent(t,r);this._unbindEvents(n);return}t&&t.indexOf("#")!=-1&&($("#"+t.replace("#","")).length||(this._renderChild(ej.getAttrVal(this._currentItem,"data-childid","page_"+parseInt(Math.random().toFixed(3)*1e3))),f=ej.buildTag("div."+this._prefixClass+"content",this._storedContent[this._currentItem.index()]),this._div.append(this._container.append(f)),ej.widget.init&&ej.widget.init(this._div)));this._updateContent(this._currentItem,r);this._touchEndEventHandler()}this._prevItem=this._currentItem}this._unbindEvents(n)},_setCurrent:function(){this._prevItem&&ej.getBooleanVal(this._currentItem,"data-persistSelection",this.model.persistSelection)&&(this._currentItem=this._prevItem,this._currentItem.removeClass(this._prefixClass+"state-default").addClass(this._prefixClass+"state-active"))},_unbindEvents:function(n){n&&n.target.nodeName&&n.target.nodeName.toLowerCase()!="a"&&(this._scroll=!1);ej.listenEvents([this._liEl,this._liEl],[ej.endEvent(),ej.moveEvent(),ej.cancelEvent()],[this._touchEndDelegate,this._touchMoveDelegate,this._touchMoveDelegate],!0,this)},_addSelection:function(){this._scroll||(this._currentItem.closest("."+this._prefixClass+"list-container").find("."+this._prefixClass+"state-active").removeClass(this._prefixClass+"state-active").addClass(this._prefixClass+"state-default"),this._currentItem.removeClass(this._prefixClass+"state-default").addClass(this._prefixClass+"state-active"))},_removeSelection:function(){var n=this;n._currentItem.removeClass(this._prefixClass+"state-active").addClass(this._prefixClass+"state-default")},_setHeightWidth:function(){if(this.model.autoAdjustHeight)this.element.height(window.innerHeight);else if(this.model.height)this.element.height(this.model.height);else{var n=this.element[0].scrollHeight?this.element[0].scrollHeight:ej.getDimension(this._lbEle.find("."+this._prefixClass+"list-container"),"outerHeight");this.model.showHeader&&(n=n+ej.getDimension(this._lbEle.find("."+this._prefixClass+"header"),"outerHeight"));this.model.enableFiltering&&(n=n+ej.getDimension(this._lbEle.find("."+this._prefixClass+"lv-inputdiv"),"outerHeight"));this.element.height(n)}this.model.width&&this.element.width(this.model.width)},_touchEndEventHandler:function(){this._triggerEndEvent(this._returnData())},_docClick:function(){this._scroll&&this._setCurrent();$(window).unbind(ej.endEvent(),this._docClickDelegate);ej.listenEvents([this._liEl,this._liEl],[ej.endEvent(),ej.moveEvent()],[this._touchEndDelegate,this._touchMoveDelegate],!0,this)},_popStateNavigation:function(n,t){t.pageUrl&&this.model.enableFiltering&&this._initializeFiltering($("div[data-url='"+t.pageUrl.replace("#","")+"']"))},_anchorClickHandler:function(n){if(this._scroll)return ej.blockDefaultActions(n),!1},_onResize:function(){var n=this;setTimeout(function(){n._setHeightWidth()},ej.isAndroid()?200:0)},_onScrollStop:function(n){ej.blockDefaultActions(n)},_createDelegates:function(){this._anchorClickDelegate=$.proxy(this._anchorClickHandler,this);this._keyup=$.proxy(this._onKeyUp,this);this._touchStartDelegate=$.proxy(this._onTouchStartHandler,this);this._touchEndDelegate=$.proxy(this._onTouchEndHandler,this);this._touchMoveDelegate=$.proxy(this._onTouchMoveHandler,this);this._resizeDelegate=$.proxy(this._onResize,this);this._popStateDelegate=$.proxy(this._popStateNavigation,this);this._docClickDelegate=$.proxy(this._docClick,this)},_wireEvents:function(n){var t,i;this._createDelegates();t=n?"unbind":"bind";this.model.autoAdjustHeight&&(i=!ej.isDevice()&&!ej.isTouchDevice()?"resize":"orientationchange",ej.listenEvents([window],[i],[this._resizeDelegate],n,this));ej.listenEvents([this._liEl.find("a"),this.element.find("."+this._prefixClass+"lv-input"),this._liEl,this._liEl],["click","keyup",ej.startEvent(),ej.cancelEvent()],[this._anchorClickDelegate,this._keyup,this._touchStartDelegate,this._touchMoveDelegate],n,this);this._lContainer.on("scrollstop",$.proxy(this._onScrollStop,this));$("body")[t]("viewpopstate",this._popStateDelegate);this.model.enableFiltering&&this._initializeFiltering(this._lbEle)},_initializeFiltering:function(n){var i,t;for(this._searchItems=$(n).find("."+this._prefixClass+"list"),this._emptyFilterTextValue(n),n.find("."+this._prefixClass+'list[style*="display: none"]').show(),i="a",this._elementText=[],t=0;t<this._searchItems.length;t++)$(this._searchItems[t]).find(i)?this._elementText.push($.trim($(this._searchItems[t]).find(i).html().replace(new RegExp("<[^<]+>","g"),"").toLowerCase())):this._elementText.push("")},_onKeyUp:function(n){for(var t=0;t<this._searchItems.length;t++)this._elementText[t].indexOf(n.target.value)==-1?$(this._searchItems[t]).css("display","none"):$(this._searchItems[t]).css("display","")},_setModel:function(n){var r=!1,t,i;for(t in n)i="_set"+t.charAt(0).toUpperCase()+t.slice(1),this[i]?this[i](n[t]):r=!0;r&&this._refresh()},_setTheme:function(n){if(n&&(this.model.theme=n,this._lbEle.removeClass("e-m-dark e-m-light e-default").addClass("e-m-"+this.model.theme),this.model.enableFiltering&&this.element.find("."+this._prefixClass+"text-input").ejmTextBox("model.theme",this.model.theme),this.model.showHeader&&this._lbEle.find("#"+this.model.id+"_header").ejmHeader("model.theme",this.model.theme),this.element.find("."+this._prefixClass+"childitem").length)){$(this.element.find("."+this._prefixClass+"childitem")).removeClass("e-m-dark e-m-light e-default").addClass("e-m-"+this.model.theme);var t=this.element.find("."+this._prefixClass+"childitem ."+this._prefixClass+"header"),i=this;t.each(function(n,t){$(t).ejmHeader("model.theme",i.model.theme)})}},_setDataSource:function(n,t){this._hasDataSource()&&n&&(t&&(this.model.fieldSettings=t),this._refresh())},_hasDataSource:function(){return this.dataSource()&&this.dataSource().length},_getElement:function(n){return n?this.element.find("#"+n):this._lbEle},_isEnable:function(n){return n.hasClass(this._prefixClass+"state-disabled")?!1:!0},_refresh:function(){this._destroy();this.element.addClass(this._rootCSS);this._load()},_clearElement:function(){this.element.removeAttr("class").removeAttr("style");this.element.empty().html(this._orgEle.html())},_destroy:function(){this._wireEvents(!0);this._clearElement()},loadAjaxContent:function(n,t){var i=this,r,u;this._isFromAjax=!0;this._renderChild(ej.getAttrVal(this._currentItem,"data-childid","page_"+parseInt(Math.random().toFixed(3)*1e3)));(!$.support.pushstate||ej.isWindowsWebView())&&(n=App.route.makeUrlAbsolute(n));r={content:i._div,item:i._currentItem,index:$(i._currentItem).index(),text:$(i._currentItem).text(),url:i.model.ajaxSettings.url?i.model.ajaxSettings.url:n};this.model.ajaxBeforeLoad&&this._trigger("ajaxBeforeLoad",r);u={cache:i.model.ajaxSettings.cache,async:i.model.ajaxSettings.async,type:i.model.ajaxSettings.type,contentType:i.model.ajaxSettings.contentType,url:ej.isWindowsWebView()?n:i.model.ajaxSettings.url?i.model.ajaxSettings.url:n,dataType:i.model.ajaxSettings.dataType,data:i.model.ajaxSettings.data,successHandler:function(r){var f=ej.buildTag("div."+this._prefixClass+"content",/<\/?body[^>]*>/gmi.test(r)?r.split(/<\/?body[^>]*>/gmi)[1]:r||""),u;i._div.append(i._container.append(f));i._div.attr("data-ajaxurl",App.route.convertToRelativeUrl(n));i._updateContent(i._currentItem,t);u={content:i._div,item:i._currentItem,index:$(i._currentItem).index(),text:$(i._currentItem).text(),url:i.model.ajaxSettings.url?i.model.ajaxSettings.url:n};i.model.ajaxSuccess&&i._trigger("ajaxSuccess",u)},errorHandler:function(t,r,u){var f={xhr:t,textStatus:r,errorThrown:u,item:i._currentItem,index:$(i._currentItem).index(),text:$(i._currentItem).text(),url:i.model.ajaxSettings.url?i.model.ajaxSettings.url:n};i.model.ajaxError&&i._trigger("ajaxError",f)},completeHandler:function(){var t={content:i._div,item:i._currentItem,index:$(i._currentItem).index(),text:$(i._currentItem).text(),url:i.model.ajaxSettings.url?i.model.ajaxSettings.url:n};i.model.ajaxComplete&&i._trigger("ajaxComplete",t)}};ej.sendAjaxRequest(u)},selectItem:function(n,t){n>=0&&this._isEnable($(this._getElement(t).find("li."+this._prefixClass+"list")[n]))&&(this._currentItem=$(this._getElement(t).find("li."+this._prefixClass+"list")[n]),this._prevItem=this._currentItem,this._onTouchEndHandler())},setActive:function(n,t){n>=0&&(element=this._getElement(t),this._isEnable($(element.find("li."+this._prefixClass+"list")[n]))&&ej.getBooleanVal($(element.find("li."+this._prefixClass+"list")[n]),"data-persistSelection",this.model.persistSelection)&&(element.find("li."+this._prefixClass+"list."+this._prefixClass+"state-active").removeClass(this._prefixClass+"state-active").addClass(this._prefixClass+"state-default"),this._currentItem=$(element.find("li."+this._prefixClass+"list")[n]),this._prevItem=this._currentItem,this._currentItem.removeClass(this._prefixClass+"state-default").addClass(this._prefixClass+"state-active")))},deActive:function(n,t){n>=0&&this._isEnable($(this._getElement(t).find("li."+this._prefixClass+"list")[n]))&&$(this._getElement(t).find("li."+this._prefixClass+"list")[n]).removeClass(this._prefixClass+"state-active").addClass(this._prefixClass+"state-default")},enableItem:function(n,t){n>=0&&$(this._getElement(t).find("li."+this._prefixClass+"list")[n]).removeClass(this._prefixClass+"state-disabled")},disableItem:function(n,t){n>=0&&$(this._getElement(t).find("li."+this._prefixClass+"list")[n]).addClass(this._prefixClass+"state-disabled")},removeCheckMark:function(n,t){element=this._getElement(t);n>=0&&this._isEnable($(element.find("li."+this._prefixClass+"list")[n]))?$(element.find("li."+this._prefixClass+"list")[n]).find("."+this._prefixClass+"lv-checkdiv").remove():element.find("."+this._prefixClass+"lv-checkdiv").remove()},checkItem:function(n,t){n>=0&&this._isEnable($(this._getElement(t).find("li."+this._prefixClass+"list")[n]))&&this._setCheckboxValue($(this._getElement(t).find("."+this._prefixClass+"lv-check")[n]),!0)},unCheckItem:function(n,t){n>=0&&this._isEnable($(this._getElement(t).find("li."+this._prefixClass+"list")[n]))&&this._setCheckboxValue($(this._getElement(t).find("."+this._prefixClass+"lv-check")[n]),!1)},checkAllItem:function(n){var t=this;this._getElement(n).find("."+this._prefixClass+"lv-check").each(function(i,r){t._isEnable($(t._getElement(n).find("li."+t._prefixClass+"list")[i]))&&t._setCheckboxValue($(r),!0)})},unCheckAllItem:function(n){var t=this;this._getElement(n).find("."+this._prefixClass+"lv-check").each(function(i,r){t._isEnable($(t._getElement(n).find("li."+t._prefixClass+"list")[i]))&&t._setCheckboxValue($(r),!1)})},getActiveItem:function(n){return this._getElement(n).find("li."+this._prefixClass+"list."+this._prefixClass+"state-active")},getActiveItemText:function(n){return this._getElement(n).find("li."+this._prefixClass+"list."+this._prefixClass+"state-active").text()},getItemText:function(n,t){if(n>=0)return $(this._getElement(t).find("li."+this._prefixClass+"list")[n]).text()},getCheckedItems:function(n){return this._getElement(n).find("input."+this._prefixClass+"lv-check:checked").closest("li."+this._prefixClass+"list")},getCheckedItemsText:function(n){return $(this.getCheckedItems(n)).map(function(){return $(this).text()}).get()},hasChild:function(n,t){if(n>=0)return this.element.find("#"+$(this._getElement(t).find("li."+this._prefixClass+"list")[n]).attr("data-childid")).length?!0:!1},isChecked:function(n,t){if(n>=0)return $(this._getElement(t).find("li."+this._prefixClass+"list")[n]).find("input."+this._prefixClass+"lv-check").prop("checked")},showItem:function(n,t){n>=0&&$(this._getElement(t).find("li."+this._prefixClass+"list")[n]).css("visibility","")},hideItem:function(n,t){n>=0&&$(this._getElement(t).find("li."+this._prefixClass+"list")[n]).css("visibility","hidden")},show:function(n){this._getElement(n).css("visibility","")},hide:function(n){this._getElement(n).css("visibility","hidden")},addItem:function(n,t){t>=0?n.insertBefore($(this._orgEle.children().children()[t])):this._orgEle.children().append(n);this._refresh()},removeItem:function(n,t){if(n>=0){element=this._getElement(t);var i=$(element.find("li."+this._prefixClass+"list")[n]).attr("data-childid");this.element.find($("#"+i).length)&&this.element.find($("#"+i)).remove();$(element.find("li."+this._prefixClass+"list")[n]).remove()}},clear:function(){this.element.empty().html();this._liEl=this.element.find("li."+this._prefixClass+"list")},getItemsCount:function(n){return this._getElement(n).find("li."+this._prefixClass+"list").length}})})(jQuery,Syncfusion),function(n,t,i){t.widget("ejmListView","ej.mobile.ListView",{_setFirst:!0,_rootCSS:"e-m-lv",_prefixClass:"e-m-",defaults:{showScrollbars:!0,headerTitle:"Title",showHeaderBackButton:!1,autoAdjustScrollHeight:!0,autoAdjustHeight:!1,headerBackButtonTap:null,adjustFixedPosition:!0,enableNativeScrolling:t.isAndroid()||t.isIOS()?!1:t.isDevice()?!0:!1,hideHeaderForUnsupportedDevice:!1,ios7:{inline:!1},windows:{preventSkew:!1,renderDefault:!1,enableHeaderCustomText:!1},allowScrolling:!0,renderMode:"auto",theme:"auto",touchStart:null,touchEnd:null,transition:t.isAndroid()?"pop":t.isWindows()&&t.isMobile()?"turn":t.isWindows()&&!t.isMobile()?"none":"slide",checkDOMChanges:!1},dataTypes:{dataSource:"data",fieldSettings:"data",renderMode:"enum",theme:"enum",enablePersistence:"boolean"},observables:["selectedItemIndex","dataSource"],selectedItemIndex:t.util.valueFunction("selectedItemIndex"),dataSource:t.util.valueFunction("dataSource"),_init:function(){this._preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/};this._storedContent=[];this._storedTemplate=[];t.setRenderMode(this);t.setTheme(this);this.model.renderMode=="windows"&&t.isMobile()&&this.model.windows.renderDefault&&(this.model.theme="default");this._touchStart=this.model.touchStart;this._touchEnd=this.model.touchEnd;this._load()},_renderScrollPanel:function(n,i,r){this._scrollWrapper=t.buildTag("div","",{},{"data-role":"ejmscrollpanel","data-ej-rendermode":this.model.renderMode,"data-ej-target":r,id:i,"data-ej-theme":this.model.theme,"data-ej-targetwidth":this.model.width,"data-ej-targetheight":this.model.height,"data-ej-setautoheight":this.model.autoAdjustScrollHeight,"data-ej-adjustfixedposition":this.model.adjustFixedPosition,"data-ej-enablenativescrolling":this.model.enableNativeScrolling,"data-ej-windows-renderdefault":this.model.windows.renderDefault,"data-ej-showscrollbars":this.model.showScrollbars,"data-ej-checkdomchanges":this.model.checkDOMChanges});n.append(this._scrollWrapper)},_updateContent:function(r,u){var a=this,e=n(r),o=e.attr("data-childid"),f=this.element.find(n("#"+o)),s,c,h,l;f.length&&(s=this.element.find("#"+o+"_header"),c=this.element.find("#"+o+"_scroll"),this.model.enableFiltering&&this._initializeFiltering(n(f)),h=e.attr("data-childtitle")==i?r.text():e.attr("data-childtitle"),s.hasClass("e-m-header")&&(l=s.ejmHeader("instance"),l.setModel({title:h,leftButtonCaption:u})),f.attr("data-hdr-title",h).attr("data-hdr-bckbtn",u),App.transferPage(e.closest(".subpage"),f,{isFromAjax:this._isFromAjax,transition:this.model.transition,parentSubPage:e.closest(".subpage").hasClass("e-m-childitem")?!1:!0}),this._transitionDelegate=n.proxy(this._transitionHandler,{proxy:this,idEle:f,scrollEle:c,delegate:this._transitionDelegate}),f.bind(t.transitionEndEvent(),this._transitionDelegate))},_transitionHandler:function(){this.proxy._setHeightWidth();this.proxy.model.allowScrolling&&this.scrollEle.ejmScrollPanel("refresh");this.idEle.unbind(t.transitionEndEvent(),this.delegate)},_renderHeader:function(n,i,r,u){return t.buildTag("div","",{},{"data-role":"ejmheader","data-ej-showLeftButton":i,"data-ej-leftbuttoncaption":u?u:"Back","data-ej-title":r,"data-ej-leftbuttontap":this.model.headerBackButtonTap,"data-ej-righttbuttontap":this.model.headerBackButtonTap,"data-ej-rendermode":this.model.renderMode,"data-ej-theme":this.model.theme,"data-ej-position":"normal",id:n+"_header","data-ej-hideforunsupporteddevice":this.model.hideHeaderForUnsupportedDevice,"data-ej-windows-renderdefault":this.model.windows.renderDefault,"data-ej-windows-enablecustomtext":this.model.windows.enableHeaderCustomText})},_returnData:function(){var t=this._currentItem.closest("ul.e-m-list-hdr").find("input.e-m-lv-check:checked").closest("li");return{hasChild:this.element.find("#"+this._currentItem.attr("data-childid")).length?!0:!1,item:this._currentItem,text:this._currentItem.find(".e-m-list-text").text(),index:this._currentItem.index(),isChecked:this._currentItem.find("input.e-m-lv-check").length?this._currentItem.find("input.e-m-lv-check").prop("checked"):!1,checkedItems:t.length?t:null,checkedItemsText:t.length?n(t).map(function(){return n(this).text()}).get():null}},_triggerStartEvent:function(n){this.model.touchStart=t.getAttrVal(this._currentItem,"data-touchstart",this._touchStart);this.model.touchStart&&this._trigger("touchStart",n)},_triggerEndEvent:function(n){this.model.touchEnd=t.getAttrVal(this._currentItem,"data-touchend",this._touchEnd);this.selectedItemIndex(this._currentItem.index());this.model.touchEnd&&this._trigger("touchEnd",n)},_createFilterDiv:function(){return t.buildTag("div.e-m-lv-filter",t.buildTag("input.e-m-lv-input","",{},{"data-role":"ejmtextbox","data-ej-rendermode":this.model.renderMode,"data-ej-theme":this.model.theme,"data-ej-windows-renderdefault":this.model.windows.renderDefault}))},_emptyFilterTextValue:function(n){n.find(".e-m-lv-input").ejmTextBox("model.value","")},_createListDiv:function(n){this._div=t.buildTag("div#"+n+"."+this._rootCSS+" e-m-"+this.model.renderMode+" e-m-"+this.model.theme+" subpage e-m-childitem e-m-ajaxchild",this.model.showHeader?this._renderHeader(n,!0,this._currentItem.text()):"")},_createCheckBox:function(){return t.buildTag("input.e-m-lv-check","",{},{type:"checkbox","data-role":"ejmcheckbox","data-ej-preventdefault":!0,"data-ej-theme":this.model.theme,"data-ej-rendermode":this.model.renderMode,"data-ej-checked":"{{:~_checkIsChecked()}}","data-ej-windows-renderdefault":this.model.windows.renderDefault})},_toggleCheckboxValue:function(n){n.ejmCheckBox("model.checked",!n.prop("checked"))},_setCheckboxValue:function(n,t){n.ejmCheckBox({checked:t})},_convertToRelativeUrl:function(n){return App.route.convertToRelativeUrl(n)}});n.extend(!0,t.mobile.ListView.prototype,t.ListViewBase.prototype)}(jQuery,Syncfusion)})