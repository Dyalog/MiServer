/*!
*  filename: ej.spreadsheet.min.js
*  version : 13.4.0.53
*  Copyright Syncfusion Inc. 2001 - 2016. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.scroller.min","./ej.datepicker.min","./ej.checkbox.min","./ej.dropdownlist.min","./ej.editor.min","./ej.pager.min","./ej.ribbon.min","./ej.calculate.min","./ej.excelfilter .min"],n):n()})(function(){(function(n,t,r){t.widget("ejSpreadsheet","ej.Spreadsheet",{_rootCSS:"e-spreadsheet",element:null,_excelFilter:null,validTags:["div"],model:null,defaults:{allowFreezing:!0,enableContextMenu:!0,allowEditing:!0,allowResizing:!0,allowMerging:!0,allowWrap:!0,allowUndoRedo:!0,allowClipboard:!0,allowDataValidation:!0,allowConditionalFormats:!0,allowSearching:!0,allowKeyboardNavigation:!0,allowAutoFill:!0,allowSelection:!0,allowSorting:!0,allowDragAndDrop:!0,allowCellType:!1,allowAutoCellType:!1,allowCharts:!0,enablePersistence:!1,allowCellFormatting:!0,allowFormulaBar:!0,showRibbon:!0,allowComments:!0,allowFiltering:!0,allowInsert:!0,allowDelete:!0,allowFormatPainter:!0,allowHyperlink:!0,allowImport:!0,allowFormatAsTable:!0,allowAutoSum:!0,allowPivotTable:!1,allowLockCell:!0,columnCount:21,rowCount:20,rowHeight:20,columnWidth:64,sheetCount:1,undoRedoStep:20,activeSheetIndex:1,apWidth:200,cssClass:"",userName:"",locale:"en-US",pageSize:"A4",sheets:[],nameManager:[],currentViewData:null,query:null,actionBegin:null,actionComplete:null,beforeCellFormat:null,cellFormatting:null,beforeOpen:null,beforeDrop:null,drop:null,cellEdit:null,pagerClick:null,cellClick:null,_pivotPrint:null,tabClick:null,tabSelect:null,_createPivotTable:null,beforePanelOpen:null,load:null,loadComplete:null,beforePrint:null,editRangeBegin:null,editRangeComplete:null,cellHover:null,menuClick:null,contextMenuClick:null,ribbonClick:null,dragStart:null,drag:null,cellSave:null,beforeCellSelect:null,autoFillBegin:null,autoFillComplete:null,seriesRendering:null,openFailure:null,scrollSettings:{width:1300,height:550,allowScrolling:!0,scrollMode:"infinite",isResponsive:!1,allowVirtualScrolling:!0,allowSheetOnDemand:!1},pageSettings:{pageCount:10,currentPage:1,pagerHeight:26},exportSettings:{allowExporting:!0,excelUrl:null,csvUrl:null,password:null},pictureSettings:{allowPictures:!0,height:220,width:440},selectionSettings:{selectionType:"default",selectionUnit:"multirange",enableAnimation:!1,animationType:"easeOutQuart",animationTime:.001,activeCell:""},chartSettings:{height:220,width:440},formatSettings:{allowFontFamily:!0,allowDecimalPlaces:!0,allowCellBorder:!0},autoFillSettings:{fillType:"fillseries",showFillOptions:!0},importSettings:{importMapper:"",importUrl:"",password:"",allowSheetOnDemand:!1},printSettings:{allowPageSetup:!0,allowPageSize:!1,allowPrinting:!0}},dataTypes:{pageSize:"enum",sheets:"array",nameManager:"array",scrollSettings:{scrollMode:"enum"},selectionSettings:{selectionType:"enum",selectionUnit:"enum",animationType:"enum"},autoFillSettings:{fillType:"enum"}},_dataSource:function(n){return this.getSheet(n).dataSource},getSheet:function(n){return this.model.sheets[n]},getSheetElement:function(n){return this.element.find("#"+this._id+"_"+this.getSheet(n)._sheetName.value)},getDataSource:function(n){return this.getSheet(n).dataSource},setDataSource:function(n,t){this.getSheet(n).dataSource=t},_getJSSheetHeader:function(n){return this._sheets[n]._sheetHeader},_setJSSheetHeader:function(n,t){this._sheets[t]._sheetHeader=n},_getInputBox:function(){return this._inputBox},_setInputBox:function(n){this._inputBox=n},_getIndexBox:function(){return this._indexBox},_setIndexBox:function(n){this._indexBox=n},_getJSSheetRowHeader:function(n){return this._sheets[n]._sheetRowHeader},_setJSSheetRowHeader:function(n,t){this._sheets[t]._sheetRowHeader=n},_getJSSheetRowHeaderContent:function(n){return this._sheets[n]._sheetRowHeaderContent},_setJSSheetRowHeaderContent:function(n,t){this._sheets[t]._sheetRowHeaderContent=n},_getJSSheetContent:function(n){return this._sheets[n]._sheetContent},_setJSSheetContent:function(n,t){this._sheets[t]._sheetContent=n},_getContent:function(n){return this._sheets[n]._content},_setContent:function(n,t){this._sheets[t]._content=n},getPager:function(){return this._spreadSheetPager},setPager:function(n){this._spreadSheetPager=n},getFooter:function(){return this._footer},setFooter:function(n){this._footer=n},getMainPanel:function(){return this._mainPanel},setMainPanel:function(n){this._mainPanel=n},getGroupPanel:function(){return this._groupPanel},setGroupPanel:function(n){this._groupPanel=n},getActivationPanel:function(){return this._activationPanel},setActivationPanel:function(n){this._activationPanel=n},getActiveSheetIndex:function(){return this.model.activeSheetIndex},setActiveSheetIndex:function(n){this.model.activeSheetIndex=n},getRows:function(n){return this._sheets[n]._Rows},setRows:function(n,t){this._sheets[t]._Rows=n},getFrozenRows:function(n){return this.getSheet(n)._frozenRows},setFrozenRows:function(n,t){this.getSheet(t)._frozenRows=n},getFrozenColumns:function(n){return this.getSheet(n)._frozenColumns},setFrozenColumns:function(n,t){this.getSheet(t)._frozenColumns=n},setFocusTopElem:function(n){this._focusTopElem=n},getFocusTopElem:function(){return this._focusTopElem},setFocusRightElem:function(n){this._focusRightElem=n},getFocusRightElem:function(){return this._focusRightElem},setFocusBottomElem:function(n){this._focusBottomElem=n},getFocusBottomElem:function(){return this._focusBottomElem},setFocusLeftElem:function(n){this._focusLeftElem=n},getFocusLeftElem:function(){return this._focusLeftElem},setAutoFillElem:function(n){this._autoFillElem=n},getAutoFillElem:function(){return this._autoFillElem},_setAutoFillOptElem:function(n){this._autoFillOptElem=n},_getAutoFillOptElem:function(){return this._autoFillOptElem},setActiveCell:function(n,i,r){var f=this.getSheet(r?r:this.getActiveSheetIndex()),u;typeof n=="string"&&(u=this.getRangeIndices(n),n=u[0],i=u[1]);f._activeCell=t.isNullOrUndefined(n)&&t.isNullOrUndefined(i)?f._startCell:{rowIndex:n,colIndex:i}},getActiveCell:function(n){return this.getSheet(this._getSheetIndex(n))._activeCell},_setFormulaSuggElem:function(n){this._formulaSuggElem=n},_getFormulaSuggElem:function(){return this._formulaSuggElem},_setRowHdrTBody:function(n,t){this._sheets[t]._rowHdrTBody=n},_getRowHdrTBody:function(n){return this._sheets[n]._rowHdrTBody},_setContTBody:function(n,t){this._sheets[t]._contTBody=n},_getContTBody:function(n){return this._sheets[n]._contTBody},_init:function(){var n=this.model.importSettings,i=this.model.scrollSettings;t.support.stableSort=!1;this._isInitLoad=!0;this._browserDetails=t.browserInfo();this.element.attr("tabindex",0).css({height:i.height,width:i.width});this.element.ejWaitingPopup();this.model.allowImport&&n.importUrl.length?this["import"]({url:n.importUrl,password:this._encrypt(n.password),allowSheetOnDemand:n.allowSheetOnDemand}):(this.showWaitingPopUp(),this._initBase(),this.clearUndoRedo(),this.hideWaitingPopUp(),this._trigger("loadComplete",{model:this.model}))},_initBase:function(){this.model.rowHeight===this.defaults.rowHeight&&this._browserDetails.name==="mozilla"&&this.model.rowHeight++;this.isImport||this._refreshModel();this._initProps();this._initCSSTag();this._initEditForm();this._renderFUpload();this._initLayout();this._initDependencies();this._wireEvents();this.model.allowDataValidation&&this.XLValidate._addDVMethod();this._isInitLoad=!1},_initProps:function(){var r=this.model,i=t.spreadsheetFeatures;this.localizedLabels=t.getLocalizedConstants(this.sfType,r.locale);this.isImport||r.sheets.splice(0,0,{});this.XLClipboard=new i.clipboard(this);this.XLEdit=new i.editing(this);this.XLPrint=new i.print(this);this.XLRibbon=new i.ribbon(this);this.XLRibbon._setButtonHeights();r.allowDragAndDrop&&(this.XLDragDrop=new i.dragAndDrop(this));r.allowKeyboardNavigation&&(this.XLCellNav=new i.cellNavigation(this));r.allowFiltering&&(this.XLFilter=new i.filter(this));r.allowAutoFill&&(this.XLDragFill=new i.dragFill(this));(r.allowCellFormatting||r.allowFormatAsTable||r.allowFormatPainter)&&(this.XLFormat=new i.cellFormatting(this),this.XLCellFrmtDlg=new i.formatCellDialog(this));r.allowConditionalFormats&&(this.XLCFormat=new i.cFormat(this));r.allowSearching&&(this.XLSearch=new i.findnreplace(this));r.allowCharts&&(this.XLChart=new i.chart(this));r.exportSettings.allowExporting&&(this.XLExport=new i.exporting(this));r.scrollSettings.allowScrolling&&(this.XLScroll=new i.scroller(this));r.allowSorting&&(this.XLSort=new i.sorting(this));r.allowFreezing&&(this.XLFreeze=new i.freezepane(this));r.allowComments&&(this.XLComment=new i.comments(this));r.allowSelection&&(this.XLSelection=new i.selection(this));(r.allowCharts||r.pictureSettings.allowPictures)&&(this.XLShape=new i.shape(this));r.allowResizing&&(this.XLResize=new i.resizing(this));r.enableContextMenu&&(this.XLCMenu=new i.contextmenu(this));r.allowDataValidation&&(this.XLValidate=new i.validation(this));r.allowCellType&&(this.XLCellType=new i.cellType(this));i.math&&n.extend(t.Spreadsheet.prototype,i.math);this._initPvtProps();this.isImport||this._updateCellType()},_initPvtProps:function(){var u,h,c,i,r,a,s,f=1,e={rowIndex:0,colIndex:0},o=this._getLocStr("AutoFillOptions").split("/"),v=this.getActiveSheetIndex(),l=t.preferredCulture(this.model.locale).numberFormat;for(this._dataContainer=this.isImport?n.extend(!0,{},this._impData.dataContainer):{sheets:{},sheetCellType:{},hashCode:[],sharedData:[],cellType:[],valData:[],cFormatData:[]},this._newSIndex=1,this.isImport=this.isImport||!1,this._calcID=CalcEngine.createSheetFamilyID(),this._sheets=[],this._isWidth=!1,this._cellProp=["value","value2","type","cFormatRule","range","thousandSeparator","rule","format","border","picture","chart","calcValue","align","hyperlink","formats","borders","tformats","tborders","isFilterHeader","filterState","tableName","comment","formatStr","decimalPlaces","cellType"];f<=this.model.sheetCount;){for(this._sheetSettings(f),this.isImport||(this._dataContainer.sheets[f]={}),u=this.model.sheets[f],s=0,a=u.rangeSettings.length;s<a;)r=u.rangeSettings[s],r.dataSource&&(i=[0,0,0,0],r.startCell&&(i=this._toIntrnlRange(r.startCell,f)),i[2]=i[0]+(r.showHeader?r.dataSource.length:r.dataSource.length-1),i[3]=i[1]+this.getObjectLength(r.dataSource[0])-1,r.range=i,h=i[2]+1,c=i[3]+1,u.rowCount<h&&(u.rowCount=h),u.colCount<=c&&(u.colCount=c)),s++;this._newSIndex++;f++}this._detachTable=null;this._isPrint=!1;this._isSheetInsert=!1;this._isSheetRename=!1;this._sheetCopy={isSheetCopy:!1,sheetContent:null};this._currentJsonData={};this._alertDialog={element:null,action:null};dataSrc=this.getDataSource(v);this._dataManager=dataSrc?dataSrc instanceof t.DataManager?dataSrc:t.DataManager(dataSrc):null;this._isUndo=!1;this._undoCollection=[];this._redoCollection=[];this._hasComment=!1;this._tableLayout="";this._ctrlKeyCount=0;this._formulaRange=[];this._formulaHeight=36;this._isSort=!1;this._isPaste=!1;this._isFATResize=!1;this._isDisplayHeader=!1;this._currencySymbol=l.currency.symbol||"$";this._percentSymbol=l.percent.symbol||"%";this._decimalSeparator=l["."]||".";this.operators={"<":function(n,t){return n<t},">":function(n,t){return n>t},">=":function(n,t){return n>=t},"<=":function(n,t){return n<=t},"==":function(n,t){return n===t},"!=":function(n,t){return n!==t},"!":function(n){return!n},"=":function(n){return n}};this.parse={parseInt:function(n){return parseInt(n)},parseFloat:function(n){return parseFloat(n)},parseDate:function(n){return new Date(n).getTime()},parseTime:function(n){return new Date("01/01/1990 "+n).getTime()},length:function(n){return n.charAt(0)==="^"?parseInt(n.split("^")[1]):n.length}};this._selMergeCells=[];this._mergeType="merge-cells";this._delCells=[];this._deletedText=[];this._removeMergeColl=[];this._insData={};this._deletedDimension=[];this._insDelStatus="";this._isUndoRedo=!1;this._indexBox=null;this._inputBox=null;this._focusTopElem=null;this._focusRightElem=null;this._focusBottomElem=null;this._focusLeftElem=null;this._dStartCell=e;this._dEndCell=e;this._pStartCell=e;this._pEndCell=e;this._pFillCell=e;this._borderFocus=["e-focusright","e-focusbottom"];this._cutFocus=["e-cutright","e-cutbottom"];this._autoFillFocus=["e-autofillright","e-autofillbottom"];this._formulaBorder=[["e-bborderright","e-bborderbottom"],["e-rborderright","e-rborderbottom"],["e-vborderright","e-vborderbottom"],["e-gborderright","e-gborderbottom"],["e-pborderright","e-pborderbottom"],["e-oborderright","e-oborderbottom"]];this._ctrlFormulaBorder=[["e-bctrlborderright","e-bctrlborderbottom"],["e-rctrlborderright","e-rctrlborderbottom"],["e-vctrlborderright","e-vctrlborderbottom"],["e-gctrlborderright","e-gctrlborderbottom"],["e-pctrlborderright","e-pctrlborderbottom"],["e-octrlborderright","e-octrlborderbottom"]];this._borderTypes=[{id:"bottomborder",text:this._getLocStr("BottomBorder"),parentId:null,sprite:"e-icon e-ss-bottomborder"},{id:"topborder",text:this._getLocStr("TopBorder"),parentId:null,sprite:"e-icon e-ss-topborder"},{id:"leftborder",text:this._getLocStr("LeftBorder"),parentId:null,sprite:"e-icon e-ss-leftborder"},{id:"rightborder",text:this._getLocStr("RightBorder"),parentId:null,sprite:"e-icon e-ss-rightborder"},{id:"noborder",text:this._getLocStr("NoBorder"),parentId:null,sprite:"e-icon e-ss-noborder"},{id:"allborder",text:this._getLocStr("AllBorder"),parentId:null,sprite:"e-icon e-ss-allborder"}];this._isApply=!1;this._datePattern=["year","month","day","hours","minutes","seconds"];this._styleColl={};this._borderStyle="solid";this._borderColor="#000000";this._borderStyles=["solid","dashed","dotted"];this._mergeCenter=!1;this._ddlCell=null;this._cOpt={};this._shapeChange=!1;this._dupDetails=!1;this._paste=!1;this._autoFillElem=null;this._autoFillOptElem=null;this._fillOptionMenuData=[{id:"copycells",text:o[0],parentId:null,sprite:"e-icon e-ss-fillselect"},{id:"fillseries",text:o[1],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"fillformattingonly",text:o[2],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"fillwithoutformatting",text:o[3],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"flashfill",text:o[4],parentId:null,sprite:"e-icon e-ss-filloption"}];this._formulaSuggElem=null;this._isFormulaSuggestion=!1;this._ctrlKeyEnabled=!1;this._shiftKeyEnabled=!1;this._preventctrlkey=!1;this._rAlign="e-ralign";this._cAlign="e-calign";this._chartBorder=[["e-rcbright","e-rcbbottom"],["e-vcbright","e-vcbbottom"],["e-bcbright","e-bcbbottom"]];this._selectionBorder=["e-selecttop","e-selectright","e-selectbottom","e-selectleft"];this._autofillBorder=["e-autofilltop","e-autofillright","e-autofillbottom","e-autofillleft"];this._thinBorder=["e-thinright","e-thinbottom"];this._rcRegx=new RegExp("\\be-rc.*\\b","g");this._mcRegx=new RegExp("\\be-mc.*\\b","g");this._formatRegx=new RegExp("\\be-format.*?\\b","g");this._borderRegx=new RegExp("\\be-border.*?\\b","g");this._wrapRow=!1;this._formulaChanged=[];this._ref=[];this._prevText="";this._selectDataval={};this._undoInputobj={};this._cureditedCell="";this._colHeaderHeight=22;this._rowHeaderWidth=30;this._scrollerHeight=18;this._scrollerWidth=18;this._scrollAdjust=!1;this._canAdjustScroll=!1;this._bufferCnt=5;this._maxRowCnt=1048576;this._maxColCnt=16384;this._impData=this._impData||null;this._isNew=!1;this._isSheetReq=!1;this._intrnlReq=!1;this._isFilterApplied=!1;this._commentCount=0;this._tableCnt=1;this._isPerHt=this.model.scrollSettings.height.toString().indexOf("%")>-1;this._isPerWt=this.model.scrollSettings.width.toString().indexOf("%")>-1;this._uploadImage=!1;this._responsiveWidth=this._isPerWt?this.element.parent().width():this.model.scrollSettings.width;this._celltypes=[];this._updateFormulaCollection()},_sheetSettings:function(n){var u,i,e,o,f,r;this._isSheetReq?u=this.getSheet(n):(f={rowIndex:0,colIndex:0},r=this.getSheet(n),o=this._generateSheetName(this._newSIndex),u=this.model.sheets[n]={colCount:r&&r.colCount||this.model.columnCount,rowCount:r&&r.rowCount||this.model.rowCount,_formulaCollection:{},columnsWidthCollection:[],_colWidthCollection:[],rowsHeightCollection:[],_rowHeightCollection:[],_spreadSheetPager:null,showHeader:r?t.isNullOrUndefined(r.showHeader)?!0:r.showHeader:!0,showGridlines:r?t.isNullOrUndefined(r.showGridlines)?!0:r.showGridlines:!0,dataSource:r&&r.dataSource||null,columns:r&&r.columns||[],cellTypes:r&&r.cellTypes||[],_excelFilter:null,filterSettings:{filteredColumns:[],maxFilterChoices:1e3,filteredRange:[],range:"",tableRange:[]},_frozenRows:r&&r._frozenRows||0,_frozenColumns:r&&r._frozenColumns||0,_selectedRange:{},_selectedCellColors:[],columnWidth:this.model.columnWidth,rowHeight:this.model.rowHeight,_currentTopFrozenRow:0,_currentLeftFrozenColumn:0,_frozenHeight:0,_frozenWidth:0,_firstRow:{idx:0,value:0},_firstCol:{idx:0,value:0},_topRow:{idx:0,value:0},_bottomRow:{idx:0,value:0},_leftCol:{idx:0,value:0},_rightCol:{idx:0,value:0},_filterColl:{},_commentColl:{},_mergeColl:{},_unmergeColl:{},_clrMergeColl:[],_clrWrapColl:[],_selectedCells:[],selectedRange:[0,0,0,0],_tableManager:{},_header:{},_selectedCellIndexes:[],_startCell:f,_endCell:f,_activeCell:f,_autoFillCell:f,rangeSettings:r&&r.rangeSettings||[],_sheetName:{text:o,value:this._getLocStr("Sheet")+this._newSIndex,isVisible:!0},_multipleFiltering:!1,_multifilterIdx:[],_filteredByColor:"",staticWidth:0,_fRow:0,_fCol:0,hideColsCollection:{},hideRowsCollection:{},filteredRowsCollection:[],_rHeightCollection:[],_frHiddenHeight:0,_fpHiddenHeight:0,_fpHiddenWidth:0,_pTarget:{},_cSpan:1,_rSpan:1,_usedRange:{rowIndex:0,colIndex:0},_mergedCells:[],_shapeMngr:{picture:{},chart:{},sharedPics:[]},_nmValue:{},_nmEdit:!1,_wrapHtCollection:{},_isChartBorderDrawn:!1,_virtualBlockCnt:0,_virtualBlockRowCnt:0,_virtualContBlockIdx:1,_virtualTopTBodyHgt:0,_virtualBottomTBodyHgt:0,_virtualTBodyHgt:0,_scrollTop:0,_scrollLeft:0,_virtualRowIdx:[],_virtualTopTBodyOffset:{top:0,bottom:0},_virtualContTBodyOffset:{top:0,bottom:0},_virtualBottomTBodyOffset:{top:0,bottom:0},_isVirtualTopReached:!0,_isVirtualEndReached:!1,_isLoaded:!1,_isRowSelected:!1,_isColSelected:!1,_isSheetSelected:!1,_isSheetProtected:!1,_contWidth:0,_isRangeSelected:!1,_isEmptyActiveCell:!1,_isMultiSelect:!1,_isImported:this.isImport,_isRequested:!1,_goToCollection:{multiple:!1,selected:[]}},e=u._sheetName.value,psheet=this._sheets[n]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null,_contTBody:null,_rowHdrTBody:null},psheet._calcEngine=new CalcEngine(this,this._calcID),psheet._calcEngine.setUseDependencies(!0),psheet._calcEngine.setExcelLikeComputations(!0),psheet._calcEngine.setUseDatesInCalculations(!0),psheet._calcEngine.registerGridAsSheet(e,e,this._calcID));this.isImport&&(i=this._impData.model.sheets[n],u._sheetName.text=i._sheetName.text,this.model.importSettings.allowSheetOnDemand&&n!==this.getActiveSheetIndex()||(u._isRequested=!0),u._isRequested&&(i._usedRange&&(i._usedRange.rowIndex&&(u._usedRange.rowIndex=i._usedRange.rowIndex),i._usedRange.colIndex&&(u._usedRange.colIndex=i._usedRange.colIndex)),i._startCell&&(i._startCell.rowIndex&&(u._startCell.rowIndex=i._startCell.rowIndex),i._startCell.colIndex&&(u._startCell.colIndex=i._startCell.colIndex)),i._endCell&&(i._endCell.rowIndex&&(u._endCell.rowIndex=i._endCell.rowIndex),i._endCell.colIndex&&(u._endCell.colIndex=i._endCell.colIndex)),i._activeCell&&(i._activeCell.rowIndex&&(u._activeCell.rowIndex=i._activeCell.rowIndex),i._activeCell.colIndex&&(u._activeCell.colIndex=i._activeCell.colIndex)),i.columnsWidthCollection&&(u.columnsWidthCollection=i.columnsWidthCollection),i.rowsHeightCollection&&(u.rowsHeightCollection=i.rowsHeightCollection),t.isNullOrUndefined(i.showGridlines)||(u.showGridlines=i.showGridlines),i.hideRowsCollection&&(u.hideRowsCollection=i.hideRowsCollection),i._shapeMngr.picture.length&&(u._shapeMngr.sharedPics=i._shapeMngr.sharedPics),i._isSheetProtected&&(u._isSheetProtected=i._isSheetProtected)))},_generateSheetName:function(n){var t,f,r,o=1,u=this.model.sheets,e=this._getLocStr("Sheet"),i=u[n];for(r=i&&i.sheetName||e+n,t=1,f=u.length;t<f;t++)u[t]._sheetName&&r===u[t]._sheetName.text&&(t=1,r=i&&i.sheetName?i.sheetName+o++:e+ ++n);return r},_initTags:function(){var n=t.buildTag("span#"+this._id+"_emptySpan"),i=t.buildTag("div#"+this._id+"_emptyDiv");this.element.find(".e-spreadsheetmainpanel").append(n).append(i);this._refreshGlobalSpan()},_initCSSTag:function(){if(!document.getElementById(this._id+"_sscustomformat")){this.isImport&&(this._dataContainer.hashCode=[]);var r,t,n,u,i=0;if(r=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],t=document.createElement("style"),t.setAttribute("id",this._id+"_sscustomformat"),t.type="text/css",r.appendChild(t),this.isImport)this._refreshImpStyles(this._impData.dataContainer.hashCode);else if(this.XLFormat)for(n="s:11pt/b:#FFC7CE;c:#82012A;f:calibri;s:11pt/b:#C6EED2;c:#0A7043;f:calibri;s:11pt/b:#FEEC9B;c:#826717;f:calibri;s:11pt/f:Calibri;w:bold;v:top;s:11pt/f:calibri;s:18pt/b:#DDE5F6;f:calibri;s:11pt/b:#FDE0D2;f:calibri;s:11pt/b:#EEEEEC;f:calibri;s:11pt/b:#FEF4CD;f:calibri;s:11pt/b:#9CC0E7;f:calibri;s:11pt/b:#F9AD7B;f:calibri;s:11pt/b:#C9C9C9;f:calibri;s:11pt/b:#FED965;f:calibri;s:11pt/b:#559AD9;c:#FFFFFF;f:calibri;s:11pt/b:#EB7E2F;c:#FFFFFF;f:calibri;s:11pt/b:#A5A5A5;c:#FFFFFF;f:calibri;s:11pt/b:#FDBF01;c:#FFFFFF;f:calibri;s:11pt".split("/"),u=n.length;i<u;)this.XLFormat._createFormatClass(this._getStyleAsJSON(n[i])),i++;n=".e-spreadsheet .e-hide, .e-spreadsheet .e-mc-hide, .e-spreadsheet .e-fr-hide, .e-spreadsheet .e-r-hide, .e-spreadsheet .e-col-hide{ display: none}";n+=".e-spreadsheet .e-rowcell.e-redft { background-color: #FFC7CE; color: #9C0055;} .e-spreadsheet .e-rowcell.e-yellowft { background-color: #FFEB9C; color: #9C6500;}";n+=".e-spreadsheet .e-rowcell.e-greenft { background-color: #C6EFCE;   color: #006100;} .e-spreadsheet .e-rowcell.e-redf { background-color: #FFC7CE;} .e-spreadsheet .e-rowcell.e-redt { color: #9C0055;}";n+=".e-spreadsheet .e-rowcell.e-hlcell { background-color: #FFFF00; color: #FF0000;} .e-spreadsheet .e-rowcell.e-goto-blank { background-color: #C6C6C6;}";n+=".e-fc-hide, .e-c-hide  {width: 0 !important;}";t.styleSheet?t.styleSheet.cssText+=n:t.appendChild(document.createTextNode(n))}},_initEditForm:function(){var n,i,r;n=t.buildTag("input","",{display:"none"},{id:this._id+"_AutoComplete"});n.addClass("e-hide");this.element.append(n);this.XLEdit._renderAutoComplete(n,"",null,!0);i=t.buildTag("form","",{width:1,height:1},{id:this._id+"EditForm"});r=t.buildTag("input","",{width:1,height:1,overflow:"hidden",opacity:0},{id:this._id+"_ValElem"});i.append(r);this.element.append(i)},_getStyleAsJSON:function(n){var t,i=0,r={},u={b:"background-color",c:"color",f:"font-family",s:"font-size",w:"font-weight",v:"vetical-align",bo:"border"};for(n=n.split(";"),len=n.length;i<len;)t=n[i].split(":"),r[u[t[0]]]=t[0]==="bo"?this.XLRibbon._getBorderObj(t[1].split("-")[0],t[1].split("-")[1]):t[1],i++;return r},_initLayout:function(){this.model.showRibbon&&this.XLRibbon._renderRibbon();this.model.allowFormulaBar&&this._renderFormulaBar();this._renderLayout();this._renderFooter()},_renderLayout:function(){var n,t;for(this._addInitTemplate(),this._renderPanel(),this._initTags(),this.model.scrollSettings.allowVirtualScrolling||this.model.scrollSettings.allowSheetOnDemand?n=t=this.getActiveSheetIndex():(n=1,t=this.model.sheetCount);n<=t;)this._renderSheet(n),n++},_addInitTemplate:function(){for(var t,n=1;n<=this.model.sheetCount;)t=this.getSheet(n),t.dataSource&&this._initColumns(n,t.dataSource[0]),n++},_refreshGlobalSpan:function(){var i=this._id,t;t=this._isWidth?n("#"+i+"_emptyDiv"):n("#"+i+"_emptySpan");t[0].style.display!=="none"&&(t.removeAttr("style"),t[0].className="",t.text(""));this._isWidth||t.toggle()},_initColumns:function(n,i){for(var u,e,f,o,r=this.getSheet(n);i.length;)i=i.items[0];if(r.columns.length===0&&i)for(f in i)i.hasOwnProperty(f)&&(typeof i[f]!="object"||i[f]instanceof Date)&&(e=i[f],r.columns.push({field:f,type:e!=null?e.getDay?"date":typeof e:null}));else for(u=0,len=r.columns.length;u<len;u++)t.isNullOrUndefined(r.columns[u].type)&&(o=t.isNullOrUndefined(r.columns[u].field)?null:t.getObject(r.columns[u].field,i),r.columns[u].type=o!=null?o.getDay?"date":typeof o:null);r.colCount=r.columns.length},_renderPanel:function(){var i,n,r=this.model.scrollSettings,u={height:r.height,width:r.width};i=t.buildTag("div.e-spreadsheetgrppanel","",u,{id:this._id+"GroupPanel"});this.setGroupPanel(i);n=t.buildTag("div.e-spreadsheetmainpanel",this._renderDIV("e-spreadsheet-list",""),u,{id:this._id+"MainPanel"});i.append(n);this.setMainPanel(n);n=t.buildTag("div.e-spreadsheetactpanel","",{height:r.height,width:this.model.apWidth,display:"none"},{id:this._id+"ActivationPanel"});i.append(n);this.setActivationPanel(n);this.element.append(i)},_renderSheet:function(i){var r,u=this.getSheet(i),e=u._sheetName.value,f=this.element.find("#"+this._id+"_"+e);this._trigger("load",{sheetIndex:i,model:this.model});r=f.length===1?f:t.buildTag("div.e-sheet ","",{},{id:this._id+"_"+e});r.append(this._renderContent(i));f.length||this.element.find(".e-spreadsheet-list").append(r);this._refreshContent(i);this.model.enableContextMenu&&this.XLCMenu._initContextMenu();this._initializePicture(i);this.isImport&&this.model.allowCellType&&this.model.allowAutoCellType&&this._celltypes.length>0&&this._processCellTypes(this._celltypes,i);this.model.allowCellType&&!this.model.scrollSettings.allowVirtualScrolling&&this.XLCellType._rangeCellTypes(u.cellTypes,i);i!==this.getActiveSheetIndex()&&r.hide();n("#"+this._id+"_CalcManual").find("span").hasClass("e-ss-calcauto")&&this._sheets[i]._calcEngine.setCalculatingSuspended(!0);u._isImported||(u._isLoaded=!0)},_refreshDataSrc:function(n){for(var s,r,l,u,f,e,t,h,i,o,c=0,a=this.getSheet(n),v=a.rangeSettings.length;c<v;){if(t=a.rangeSettings[c],t.range){if(o=t.range,s=0,r=o[0],u=o[1],l=o[2],t.showHeader){this.getObjectLength(t.headerStyles)&&this.model.allowCellFormatting&&(h=this.XLFormat._createFormatClass(t.headerStyles));e=t.dataSource[s];for(f in e)i=this.XLEdit._parseValue(this._iterateComplxObj(e[f],f).prop),i.sheetIdx=n,i.rangeName=t.rangeName,h&&(i.format=h,i.formats=t.headerStyles),this.XLEdit._updateDataContainer({rowIndex:r,colIndex:u},{dataObj:i,sheetIdx:n,skipCell:!0}),u++;r++}while(r<=l){e=t.dataSource[s];u=o[1];for(f in e)i=this.XLEdit._parseValue(this._iterateComplxObj(e[f],f).value),i.sheetIdx=n,i.rangeName=t.rangeName,this.XLEdit._updateDataContainer({rowIndex:r,colIndex:u},{dataObj:i,sheetIdx:n,skipCell:!0}),u++;s++;r++}}c++}},_iterateComplxObj:function(n,t,i){var r,u,o=".",e=i||t,f={prop:e,value:n};if(this._isObject(n))for(r in n){if(u=n[r],this.isUndefined(u))return f;if(n.hasOwnProperty(r)&&this._isObject(u)&&!this._isDateTime(u))e+=o+r,f=this._iterateComplxObj(u,r,e);else return f.prop+=o+r,f.value=u,f}return f},_renderContent:function(n){var r=[],i=t.buildTag("div.e-spreadsheetheader"),o=t.buildTag("div.e-headercontent"),s=t.buildTag("div.e-spreadsheetcolumnheader e-icon e-ss-selectall  e-ss-cursor","",{float:"left",width:29,height:20.5},{}),u=t.buildTag("div.e-spreadsheetcontentcontainer"),h=t.buildTag("div.e-content e-ss-cursor"),f=t.buildTag("div.e-spreadsheetrowheader","",{float:"left",width:"30px"},{}),e=t.buildTag("div.e-rowheadercontent");return this._setJSSheetHeader(i,n),i.append(s),i.append(o),r.push(i),i=t.buildTag("div.e-spreadsheetcontent"),this._setJSSheetContent(i,n),this._setContent(u,n),this._setJSSheetRowHeader(f,n),this._setJSSheetRowHeaderContent(e,n),f.append(e),u.append(h),i.append(f),i.append(u),r.push(i),r},_processCellTypes:function(n,t){for(var r=[],i=0,u=n.length;i<u;i++)n[i].cellType.type==="DatePicker"?r.push({range:this._getAlphaRange(t,n[i].rowIndex,n[i].colIndex,n[i].rowIndex,n[i].colIndex),settings:{type:n[i].cellType.type,value:n[i].value}}):r.push({range:this._getAlphaRange(t,n[i].rowIndex,n[i].colIndex,n[i].rowIndex,n[i].colIndex),settings:{type:n[i].cellType.type,isChecked:n[i].cellType.isChecked}});this.XLCellType._rangeCellTypes(r,t);this._celltypes=[]},_refreshContent:function(n){var u,f,r={},t=this.getSheet(n),i=this.model.scrollSettings,e=i.allowVirtualScrolling;this._refreshRowColCnt(n);t.dataSource&&!this._sheetCopy.isSheetCopy&&(t._isTemplate=!0,t._isImported||t._isLoaded||(t.rowCount=t.dataSource.length),t.columns.length*t.columnWidth<i.width&&(colWidth=i.width/t.columns.length-1,t.columnWidth=colWidth));this._getJSSheetHeader(n).find(".e-headercontent").append(this._renderHeaderColumns(n));this._refreshTemplates(n);this._getJSSheetRowHeaderContent(n).append(this._renderHdrRows(n));t._isImported||t._isLoaded||this._refreshDataSrc(n);this._getContent(n).find(".e-content").append(this._renderContTable(n));e?this._refreshViewport(0,n):this.model.allowComments&&this.XLComment._updateCmntArrowPos(null,n);r.width=i.width;r.height=i.height;this._setSheetWidthHeight(n,r,null,"refresh");u=this._getContTBody(n).find("tr");f=this._getRowHdrTBody(n).find("tr");this.setRows([f,u],n)},_renderHeaderColumns:function(i){var u,f,r,e=n(document.createElement("thead")),o=t.buildTag("table.e-table","",{},{cellspacing:"0.25px"});return r=this._renderHeaderCol(i,0,this.getSheet(i).colCount),f=r.pop(),u=r.pop(),e.append(u),o.append(f).append(e),o},_renderHeaderCol:function(i,r,u){var s,h,y,p,c,l,a=0,v=[],e=r,f=this.getSheet(i),o=f.columnWidth,w=t.buildTag("tr.e-columnheader"),b=n(document.createElement("colgroup"));for(f._colWidthCollection.push(a);e<u;)(this._sheetCopy.isSheetCopy||f._isImported&&!f._isLoaded)&&(l=f.columnsWidthCollection[e],o=l?l:f.columnWidth),f.columnsWidthCollection[e]=o,e!=u-1&&(a=f._colWidthCollection[f._colWidthCollection.length-1]+o,f._colWidthCollection.push(a)),s=t.buildTag("th.e-headercell","",{},{}),h=f._isTemplate?t.buildTag("div.e-headercelldiv",this._generateHeaderText(i,e),{},{}):t.buildTag("div.e-headercelldiv",this._generateHeaderText(i,e+1),{},{}),s.append(h),p=h.text(),y=t.buildTag("col","",{width:o},{}),w.append(s),b.append(y),f._isTemplate||f.columns.push({field:p,type:c!=null?c.getDay?"date":typeof c:null,width:o}),e++;return v.push(w),v.push(b),v},_renderHdrRows:function(i){var u,o,f,s=0,h=this.model.scrollSettings.allowVirtualScrolling,r=this.getSheet(i),e=r.rowHeight,c=n(document.createElement("colgroup")),l=document.createElement("col");if(l.style.width="30px",c.append(l),r.dataSource&&!this.isImport&&(r.rowCount=r.dataSource.length),f=t.buildTag("table.e-table",c.get(0).outerHTML),!this._sheetCopy.isSheetCopy)for(u=0,o=r.rowCount,r._rowHeightCollection.push(s);u<o;)r._isImported&&!r._isLoaded?(e=r.rowsHeightCollection[u],this.isUndefined(e)&&(e=r.rowsHeightCollection[u]=r.rowHeight)):r.rowsHeightCollection.push(e),u!=o-1&&(s=r._rowHeightCollection[r._rowHeightCollection.length-1]+e,r._rowHeightCollection.push(s)),u++;return h?f.append("<tbody class='e-ss-virtualtop'><\/tbody><tbody><\/tbody><tbody class='e-ss-virtualbottomm'><\/tbody><\/table><\/div>"):f.append("<tbody>"+this._renderRowHdr(null,i)+"<\/tbody>"),this._setRowHdrTBody(f.find("tbody").eq(h?1:0),i),f},_renderRowHdr:function(i,r){var u,f,o=0,s=[],e=this.getSheet(r),h=i&&this.model.scrollSettings.allowVirtualScrolling;for(cnt=h?i.length:e.rowCount;o<cnt;)u=h?i[o]:o,(t.isNullOrUndefined(this.XLEdit.getPropertyValue(u,0,"isFilterHide"))||t.isNullOrUndefined(this.XLEdit.getPropertyValue(u,0,"isRHide")))&&(f={height:e.rowsHeightCollection[u]<this.model.rowHeight?this.model.rowHeight:e.rowsHeightCollection[u],rowidx:u},f.className=this.XLEdit.getPropertyValue(u,0,"hRow")?"e-rowheader e-hrow ":"e-rowheader",this.XLEdit.getPropertyValue(u,0,"isFilterHighlight")&&(f.className+=" e-filterhiglight"),f.wrap=this.XLEdit.getPropertyValue(u,0,"wrapRow")?"e-sswraprow":"",this._inRow(e.selectedRange,u)&&(f.className+=" e-rowhighlight",e._isRowSelected&&(f.className+=" e-rowselected")),s.push(f)),o++;return n.render[this._id+"JSONRowHdrTemplate"+r](s)},_renderContTable:function(i){var u,r,f=this.model.scrollSettings.allowVirtualScrolling,e=this.getSheet(i);return this._sheetCopy.isSheetCopy?r=n(this._sheetCopy.sheetContent):(r=t.buildTag("table.e-table",this._sheets[i]._contentColGroup.outerHTML),f?r.append("<tbody class='e-ss-virtualtop'><\/tbody><tbody><\/tbody><tbody class='e-ss-virtualbottom'><\/tbody>"):(u=this.getRangeData([0,0,e.rowCount-1,e.colCount-1],!1,["value","value2","comment","hyperlink","format","border","type","isFilterHide","isRHide","isFHide","isFilterHeader","isFilterVisible","filterState","isMHide","merge","hRow","isLocked","wrap","isOverflow","align","picture","cFormatRule","isOfBrdr"],i,!1,!1,!1,null,null,!0),r.append("<tbody>"+this._renderData(u,i)+"<\/tbody>"))),this._setContTBody(r.find("tbody").eq(f?1:0),i),r},_initDependencies:function(){var n=this.model;n.allowSelection&&(this._createFocusElement(),this._initializeSelection());n.allowClipboard&&this.XLClipboard._initCopyPaste();n.allowEditing&&this.XLEdit._processEditing(this.getActiveSheetIndex());this._initDialogs();this._renderDDownList();this.clearUndoRedo();n.showRibbon&&this.XLRibbon._disableButtons(["clearfilter"],"ejButton")},_initDialogs:function(){var n=this.model;n.allowFiltering&&(this.XLFilter._renderExcelFilter(),this.XLFilter._renderFilterDialogs());n.allowDataValidation&&(this.XLRibbon._initValDialog(),this.XLRibbon._renderValDialog());n.allowConditionalFormats&&this.XLRibbon._initCFDialog();this.XLRibbon._initHLDialog();this.XLRibbon._renderHLDialog();this._passwordDlg();this._importPasswordDlg();n.allowSearching&&(this.XLRibbon._initFRDialog(),this.XLRibbon._renderFRDialog(),this.XLRibbon._initGoToDialog(),this.XLRibbon._renderGoToDialog());this._initMoveCopyDlg();this._initUnhideDlg();this._renderInsertDeleteDialog();n.allowCellFormatting&&this.XLCellFrmtDlg._renderCellFrmtDlg();this._renderAlertdlg();n.allowCharts&&this.XLChart._renderChartRangeDialog();n.enableContextMenu&&this.XLCMenu._initCMenuFooter()},_generateHeaderText:function(n,t){var i;if(n=this._getSheetIndex(n),n)if(i=this.getSheet(n),i._isTemplate){if(i.columns[t]!=r)return i.columns[t].field}else return t/26>1?this._generateHeaderText(n,t%26==0?t/26-1:Math.floor(t/26))+String.fromCharCode(t%26==0?"Z".charCodeAt("Z"):64+t%26):String.fromCharCode(64+t)},_generateColCount:function(n){var i=0,t;for(n=n.split("").reverse().join(""),t=n.length-1;t>=0;t--)i+=(n[t].charCodeAt(n[t])-64)*Math.pow(26,t);return i},_getSheetIndex:function(n){return n?n:this.getActiveSheetIndex()},_getSheetIdxFromName:function(n){for(var t=1,i=this.model.sheets,r=i.length-1;t<=r;){if(i[t]._sheetName.value.toLowerCase()===n.toLowerCase())return t;t++}return-1},_getAlphaRange:function(n,t,i,r,u){return t=t+1,i=i+1,r=r+1,u=u+1,t===r&&i===u?this._generateHeaderText(n,i)+t:this._generateHeaderText(n,i)+t+":"+this._generateHeaderText(n,u)+r},_getProperAlphaRange:function(n,t,i,r,u){var f=this._getAlphaRange(n,t,i,r,u);return f.indexOf(":")===-1?f+":"+f:f},_getDollarAlphaRange:function(n,t){var i=this.getActiveSheetIndex();return t&&!this.isRange(n)?this.getSheet(i)._sheetName.value+"!$"+this._generateHeaderText(i,n[1]+1)+"$"+(n[0]+1):this.getSheet(i)._sheetName.value+"!$"+this._generateHeaderText(i,n[1]+1)+"$"+(n[0]+1)+":$"+this._generateHeaderText(i,n[3]+1)+"$"+(n[2]+1)},_toIntrnlRange:function(n,t){return n?this._isString(n)&&(n=this.getRangeIndices(n)):(t=this._getSheetIndex(t),n=this.getSheet(t).selectedRange),n},_getMaxRowColCnt:function(n,t,i){for(var u,f,r,e=0,o=0,n=n?n:this.model.sheets,s=i?i:1,h=i?i+1:n.length;s<h;)r=n[s],t&&r._usedRange?(u=r._usedRange.rowIndex,f=r._usedRange.colIndex):(u=r.rowCount,f=r.colCount),e<u&&(e=u),o<f&&(o=f),s++;return{rowCount:e,colCount:o}},_generateEJMenu:function(n,i,r){return{menuType:n==="normal"?t.MenuType.NormalMenu:t.MenuType.ContextMenu,orientation:i==="vertical"?t.Orientation.Vertical:t.orientation.Horizontal,cssClass:r}},_generateEJDD:function(t,i,r,u,f,e){return{dataSource:t,fields:i,selectedItemIndex:r,width:u,height:f,cssClass:"e-"+this._id+"-ddl",change:n.proxy(this.XLRibbon._frTypeChange,this,e)}},_refreshWidthHeight:function(i,r,u,f){var h,y=0,c=0,e=this._getContent(i),l,a,v=this.getSheet(i),s=this._getJSSheetRowHeader(i),o=0;return this.model.scrollSettings.isResponsive&&(f==="tabClick"||f==="toggleBtn")&&(o=this.XLRibbon._ribbonState?2:1),a=this.model.allowFormulaBar?this._formulaHeight:0,t.isNullOrUndefined(u)&&(u=n("#"+this._id+"_Ribbon").height()),v.showHeader&&(y=22,c=s.width()),l=r.height-(u+a),this.getGroupPanel().height(l+1),this.getMainPanel().height(l),r.height=r.height-(y+this.model.pageSettings.pagerHeight+a+u),e.find("#hscrollBar").length>0&&(e.find("#hscrollBar").remove(),s.removeClass("e-scrollrowcss"),this._getJSSheetRowHeaderContent(i).height(r.height),v._contWidth=r.height-o,e.find(".e-content").height(v._contWidth)),e.find("#vscrollBar").length>0&&(e.find("#vscrollBar").remove(),s.removeClass("e-scrollcss"),e.find(".e-content").width(r.width-o)),e.height(r.height-o),s.height(r.height-o),this._getJSSheetContent(i).width(r.width),h=this.getFooter(),h&&h.width(r.width),r.width=r.width-c,this._alignFormulaBar(r.width+c),r},_setSheetWidthHeight:function(t,i,r,u,f){var p=n(document),e,o,s,h,c=this._getContent(t),l,v=this._getJSSheetRowHeader(t),a,w=this.model.scrollSettings.isResponsive,y;w?(e=i.height=this._isPerHt?this.element.parent().height():i.height,o=i.width=this._isPerWt?this.getMainPanel().width():i.width,u==="refresh"&&(y=this._browserDetails,y.name.indexOf("msie")>-1&&(p=this.model.showRibbon?n(document):n("body"))),a=this._refreshWidthHeight(t,n.extend(!0,{},i),r,f),f="repeat",i.height=h=this._isPerHt?this.element.parent().height():i.height,i.width=s=this._isPerWt?this.getMainPanel().width():i.width,(o!=s||e!=h)&&(i=this._refreshWidthHeight(t,i,r,f)),o===s&&(i.width=a.width),e===h&&(i.height=a.height)):i=this._refreshWidthHeight(t,n.extend(!0,{},i),r,f);this.model.scrollSettings.allowScrolling&&this._renderScroller(t,i);c.find("#vscrollBar").length>0&&this._getJSSheetHeader(t).addClass("e-scrollcss");c.find("#hscrollBar").length>0&&(l=c.height(),v.height(l-18),this._getJSSheetRowHeaderContent(t).height(l-18),v.addClass("e-scrollrowcss"))},setWidthToColumns:function(n){var u=this.getActiveSheetIndex(),l=this._getContent(u).find("col"),a=this._getJSSheetHeader(u).find("col"),h=0,t,i,o=!1,f=this.getSheet(u),s,r,c,e;for(typeof n[0]=="object"&&(o=!0),r=0,c=n.length;r<c;r++)for(t=o?n[r].width:n[r],i=o?n[r].colIndex:r,s=this.XLEdit._getPropWithCellIdx([0,i,f.rowCount-1,i],"isOfBrdr",u),t===0&&(t=64),a[i].style.width=t+"px",l[i].style.width=t+"px",h+=t,f.columnsWidthCollection[i]=t,f.columns[i].width=t,this.model.scrollSettings.allowScrolling&&this.XLScroll._getColWidths(u,i),e=0;e<s.length;e++)cellIdx=s[e],this._textClip(cellIdx.rowIdx,cellIdx.colIdx,"delete","",!0),this._textClip(cellIdx.rowIdx,cellIdx.colIdx,"add","",!0);f.staticWidth=h;this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(u,"refresh","horizontal");(!f._isImported||f._isLoaded)&&(this.XLSelection._refreshBorder(),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())},setHeightToRows:function(n){var i=this.getActiveSheetIndex(),o=0,r=this.getSheet(i),u=!1,f=this.getRows(i),s=f[1],h=f[0],t,e;for(typeof n[0]=="object"&&(u=!0),t=0,e=n.length;t<e;t++)height=u?widthColl[t].height:n[t],rowIdx=u?widthColl[t].rowIndex:t,height===0&&(height=22),s[rowIdx].style.height=height+"px",h[rowIdx].style.height=height+"px",o+=height,r.rowsHeightCollection[rowIdx]=height;this.model.scrollSettings.allowScrolling&&(this.XLScroll._getRowHeights(i,1),this.XLScroll._refreshScroller(i,"refresh","vertical"));(!r._isImported||r._isLoaded)&&(this.XLSelection._refreshBorder(),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())},_refreshRowColCnt:function(t){var u,f,e,r,o=0,s=0,i=this.getSheet(t),c=0,l=0,a=0,h=0,v=0,y=0,p=0,w=0,b=0,k=this.model.scrollSettings.isResponsive?this.element.parent().height():this.model.scrollSettings.height,d=this.model.scrollSettings.isResponsive?this.element.parent().width():this.model.scrollSettings.width;this.model.scrollSettings.allowScrolling&&(y=this._scrollerHeight,p=this._scrollerWidth);i.showHeader&&(w=this._colHeaderHeight,b=this._rowHeaderWidth);this.model.showRibbon&&(l=n("#"+this._id+"_Ribbon").height());this.model.allowFormulaBar&&(a=this._formulaHeight);this.getActivationPanel().is(":visible")&&(c=this.getActivationPanel().width());i.rowCount>this._maxRowCnt?i.rowCount=this._maxRowCnt:(h=k-(l+a+w+this.model.pageSettings.pagerHeight+y),o=h+this._bufferCnt*i.rowHeight,f=this.isImport?this._getMaxHgt(t):i.rowCount*i.rowHeight,f<o&&(r=o-f,u=Math.ceil(r/i.rowHeight),i.rowCount+=u,f+=u*i.rowHeight),this.model.scrollSettings.allowVirtualScrolling&&(i._virtualBlockRowCnt=Math.ceil(h/i.rowHeight)+this._bufferCnt,r=i.rowCount%i._virtualBlockRowCnt,r&&(u=i._virtualBlockRowCnt-r,i.rowCount+=u,f+=u*i.rowHeight),i._virtualBlockCnt=i.rowCount/i._virtualBlockRowCnt,i._virtualTBodyHgt=f));i.colCount>this._maxColCnt?i.colCount=this._maxColCnt:(v=d-(c+p+b),s=v+this._bufferCnt*i.columnWidth,e=this.isImport?this._getMaxWth(t):i.colCount*i.columnWidth,e<s&&(r=s-e,i.colCount+=Math.ceil(r/i.columnWidth)))},_getMaxHgt:function(n){for(var i=0,t=0,r=this.getSheet(n),u=r.rowsHeightCollection.length;t<u;)i+=r.rowsHeightCollection[t],t++;return i},_getMaxWth:function(n){for(var i=0,t=0,r=this.getSheet(n),u=r.columnsWidthCollection.length;t<u;)i+=r.columnsWidthCollection[t],t++;return i},_refreshTemplates:function(i,r,u,f){for(var h,e,s=t.isNullOrUndefined(u)?0:u,c={},o=this.getSheet(i),a=t.buildTag("colgroup"),v=this.model.scrollSettings.allowVirtualScrolling,y=t.isNullOrUndefined(f)?o.colCount:f,l=v?"<tr style = 'height: {{:height}}px' idx = '{{:rowidx}}'>":"<tr style = 'height: {{:height}}px'>";s<y;)colWth=o._isImported&&!o._isLoaded?o.columnsWidthCollection[s]:o.columnWidth,e=this._generateHeaderText(i,s+1),h=document.createElement("col"),h.style.width=colWth+"px",l+="<td class='{{:"+e+"_className}}' rowspan=' {{:"+e+"_rspan}}' colspan=' {{:"+e+"_cspan}}'>{{:"+e+"_value}}<\/td>",a.append(h),s++;c[this._id+"JSONTemplate"+i]=l+"<\/tr>";r||(c[this._id+"JSONRowHdrTemplate"+i]=v?"<tr class='{{:wrap}}' style='height:{{:height}}px' idx='{{:rowidx}}'><td class='{{:className}}'>{{:rowidx + 1}}<\/td><\/tr>":"<tr class='{{:wrap}}' style='height:{{:height}}px'><td class='{{:className}}'>{{:rowidx + 1}}<\/td><\/tr>");n.templates(c);this._sheets[i]._contentColGroup=a.get(0)},_renderData:function(i,r,u,f,e){var y,tt,l,c,s,p,h,w,ft,ct,b,lt,at,et,vt,ot,yt,o,it,rt=!0,k=0,st=0,d=" ",g=[],r=this._getSheetIndex(r),a=this.getSheet(r),ht=t.isNullOrUndefined(f)?a.colCount:f,bt=this._dataContainer.cFormatData,v=this._dataContainer.sheets[r],nt=a._goToCollection,pt=nt.selected.length,ut,wt;if(i)for(ft=i.data,tt=ft.length/ht;k<tt;){for(s={},y=st,l=i.rowIdx[k],c=t.isNullOrUndefined(u)?0:u,cellIdx={rowIndex:l,colIndex:c};y<st+ht;){if(o=ft[y],!t.isNullOrUndefined(o)){if(p=this._generateHeaderText(r,c+1),h=p+"_className",w=p+"_value",lt=p+"_rspan",at=p+"_cspan",s[h]="e-rowcell e-wrapword e-ss-col"+c+" ",a.showGridlines||(s[h]+=" e-hborder"),!nt.multiple&&pt&&nt.selected.indexOf(l+":"+c)>-1&&(s[h]+=" e-selected"),c in a.hideColsCollection&&(s[h]+=" e-freezeOverflow"),this.inRange(a.selectedRange,l,c)&&(rt=!0,nt.multiple&&(rt=!1,pt&&nt.selected.indexOf(l+":"+c)>-1&&(rt=!0)),rt&&(s[h]+=" e-selected"),a._activeCell.rowIndex===l&&a._activeCell.colIndex===c&&(s[h]+=" e-activecell")),this.isImport&&this.model.allowCellType&&this.model.allowAutoCellType&&((o.type=="shortdate"||o.type=="longdate")&&this._celltypes.push({rowIndex:l,colIndex:c,sheetIndex:r,cellType:{type:"DatePicker"},value:o.value2}),o.value2&&["true","yes","false","no"].indexOf(o.value2.toLowerCase())>-1&&this._celltypes.push({rowIndex:l,colIndex:c,sheetIndex:r,cellType:{type:"CheckBox",isChecked:["yes","true"].indexOf(o.value2.toLowerCase())>-1?!0:!1}})),o.format&&(s[h]+=d+o.format),o.border&&(s[h]+=d+o.border),o.align?o.align===t.Spreadsheet.Align.center?s[h]+=d+this._cAlign:o.align===t.Spreadsheet.Align.right&&(s[h]+=d+this._rAlign):o.type===t.Spreadsheet.CellType.General&&(this._isDateTime(o.value)||this.isNumber(o.value))&&(s[h]+=d+this._rAlign),o.isMHide&&(s[h]+=" e-mc-hide"),o.isOfBrdr&&(s[h]+=" e-ofbrdr"),this.isUndefined(o.isOverflow)&&(!a._isImported||this.XLEdit.getPropertyValue(l,c+1,"overflow"))||(s[h]+=" e-overflow"),o.merge&&(et=o.merge.mSpan,s[lt]=et.rowSpan,s[at]=et.colSpan,o.merge.isCenterAlign&&(s[h]+=d+this._cAlign)),o.cFormatRule)for(ut=0,wt=o.cFormatRule.length;ut<wt;ut++)ot=o.cFormatRule[ut].split("_"),ot[7]==="true"&&(s[h]+=" e-"+ot[4]);o.wrap&&(s[h]+=" e-sswraptext",this.isUndefined(v[l])&&(v[l]={}),this.isUndefined(v[l][0])&&(v[l][0]={}),v[l][0].wrapRow=!0,this.isUndefined(v[0])&&(v[0]={}),this.isUndefined(v[0][c])&&(v[0][c]={},v[0][c].wrapCol=!0,v[0][c].wrapWidth=a.columnsWidthCollection[c]));it=o.value2||"";o.hyperlink?t.isNullOrUndefined(e)?s[w]=o.hyperlink.webAddr?String.format("<a href={0} class='e-hyperlinks' targrt='_blank'>{1}<\/a>",o.hyperlink.webAddr,it):String.format("<a href={0} class='e-hyperlinks'>{1}<\/a>","#",it):s[h]+=" e-hyperlinks":s[w]=it;o.comment&&(s[h]+=" e-commentcell",yt=o.comment.isVisible?"visible":"none",s[w]=String.format("<span class='e-comment'><span class='e-celltoparrow'><\/span><textarea class='e-comment-txtarea' style='display:{0};z-index:9'>{1}<\/textarea><\/span>",yt,o.comment.value)+s[w]);o.rule&&o.rule.isApply&&(s[h]+=" e-hlcell");o.isFilterHeader&&(ct="e-icon e-spanfilter e-filterspan "+this.getSheet(r)._filterColl[l][c].status,vt=o.isFilterVisible?"display: visible":"display: none",s[w]=String.format('<span class="{0}" style="{1}"><\/span>',ct,vt)+s[w])}c++;y++}s.rowidx=l;b=a.rowsHeightCollection[l];s.height=b<this.model.rowHeight?this.model.rowHeight:b;g.push(s);st=y;k++}else if(tt=this.model.scrollSettings.allowVirtualScrolling?a._virtualBlockRowCnt:a.rowCount,a.dataSource)g=a.dataSource;else while(k<tt){for(s={},y=0;y<ht;)p=this._generateHeaderText(r,y+1),h=p+"_className",s[h]="e-rowcell e-wrapword e-ss-col"+y,y++;b=a.rowsHeightCollection[k];s.height=b<this.model.rowHeight?this.model.rowHeight:b;s.rowidx=l;g.push(s);k++}return a.dataSource=g,n.render[this._id+"JSONTemplate"+r](g)},_refreshViewport:function(n,t){var f,r,u=0,i=this.getSheet(t),e=this.XLShape._getCellIndexFromOffset(n,0);i._virtualContBlockIdx=this._getVirtualBlockIdx(i,e.rowIndex);currIdx=(i._virtualContBlockIdx-1)*i._virtualBlockRowCnt;nextIdx=i._virtualContBlockIdx*i._virtualBlockRowCnt;i._virtualContTBodyOffset.top=this._getRowOffsetTop(i,currIdx);i._virtualBlockCnt===1?(i._virtualTopTBodyOffset.top=i._virtualTopTBodyOffset.bottom=i._virtualTopTBodyHgt=0,i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom=i._virtualBottomTBodyHgt=0,i._virtualContTBodyOffset.bottom=this._getRowOffsetBottom(nextIdx-1,t),r=i._virtualBlockRowCnt,i._isVirtualTopReached=i._isVirtualEndReached=!0):i._virtualContBlockIdx===1?(i._virtualTopTBodyOffset.top=i._virtualTopTBodyOffset.bottom=i._virtualTopTBodyHgt=0,i._virtualContTBodyOffset.bottom=i._virtualBottomTBodyOffset.top=this._getRowOffsetTop(i,nextIdx),i._virtualBottomTBodyOffset.bottom=this._getRowOffsetBottom(nextIdx+(i._virtualBlockRowCnt-1),t),i._virtualBottomTBodyHgt=i._virtualTBodyHgt-(i._virtualContTBodyOffset.bottom-i._virtualContTBodyOffset.top+(i._virtualBottomTBodyOffset.bottom-i._virtualBottomTBodyOffset.top)),r=i._virtualBlockRowCnt*2,i._isVirtualTopReached=!0,i._isVirtualEndReached=!1):i._virtualContBlockIdx===i._virtualBlockCnt?(u=(i._virtualContBlockIdx-2)*i._virtualBlockRowCnt,i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom=i._virtualBottomTBodyHgt=0,i._virtualContTBodyOffset.bottom=this._getRowOffsetBottom(currIdx+(i._virtualBlockRowCnt-1),t),i._virtualTopTBodyOffset.top=this._getRowOffsetTop(i,u),i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.top,i._virtualTopTBodyHgt=i._virtualTBodyHgt-(i._virtualContTBodyOffset.bottom-i._virtualContTBodyOffset.top+(i._virtualTopTBodyOffset.bottom-i._virtualTopTBodyOffset.top)),r=i._virtualBlockRowCnt*2,i._isVirtualEndReached=!0,i._isVirtualTopReached=!1):(u=currIdx-i._virtualBlockRowCnt,i._virtualTopTBodyOffset.top=this._getRowOffsetTop(i,u),i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.top=this._getRowOffsetTop(i,currIdx),i._virtualContTBodyOffset.bottom=i._virtualBottomTBodyOffset.top=this._getRowOffsetTop(i,nextIdx),i._virtualBottomTBodyOffset.bottom=this._getRowOffsetBottom(nextIdx+(i._virtualBlockRowCnt-1),t),i._virtualTopTBodyHgt=n-(i._virtualTopTBodyOffset.bottom-i._virtualTopTBodyOffset.top+(n-i._virtualContTBodyOffset.top)),i._virtualBottomTBodyHgt=i._virtualTBodyHgt-i._virtualBottomTBodyOffset.bottom,r=i._virtualBlockRowCnt*3,i._isVirtualTopReached=i._isVirtualEndReached=!1);f=this.getRangeData(null,null,["value","value2","comment","hyperlink","rule","cFormatRule","format","border","type","isFilterHide","isRHide","isFHide","isFilterHeader","isFilterVisible","filterState","isMHide","merge","hRow","isLocked","wrap","isOverflow","align","isOfBrdr"],t,!1,!1,!0,u,r,!0);this._getRowHdrTBody(t).html(this._renderRowHdr(f.rowIdx,t));this._getContTBody(t).html(this._renderData(f,t));this._refreshRows(t);this._refreshTBodiesHgt(t);this._refreshRows(t);this.model.allowComments&&this.XLComment._updateCmntArrowPos(null,t);i._virtualRowIdx=f.rowIdx;this.model.allowCellType&&this.XLCellType._rangeCellTypes(i.cellTypes,t);this._refreshViewVar(n,null,t)},_getVirtualBlockIdx:function(n,t){for(var i=1;i<=n._virtualBlockCnt;){if(t<i*n._virtualBlockRowCnt)return i;i++}},_getRowOffsetTop:function(n,t){return n._rowHeightCollection[t]},_getRowOffsetBottom:function(n,t){return this.getSheet(t)._rowHeightCollection[n]+this.getSheet(t).rowsHeightCollection[n]},_getColOffsetLeft:function(n,t){return n._colWidthCollection[t]},_getCellIdx:function(n){return{rowIndex:this.model.scrollSettings.allowVirtualScrolling?Number(n.parentNode.attributes.getNamedItem("idx").value):n.parentNode.rowIndex,colIndex:n.cellIndex}},_removeRange:function(t,i){var r=this.getActiveSheetIndex(),e=this._getRowHdrTBody(r),u=n(this._getRowHdrTBody(r)[0].rows),o=this._getContTBody(r),f=n(this._getContTBody(r)[0].rows);u.splice(t,i);f.splice(t,i);this.setRows([u,f],r);o.html(f);e.html(u)},_refreshTBodiesHgt:function(n){var t="px",n=this._getSheetIndex(n),i=this.getSheet(n),r=this._getJSSheetRowHeaderContent(n)[0].getElementsByTagName("tbody"),u=this._getContent(n)[0].getElementsByTagName("tbody");r[0].style.height=u[0].style.height=i._virtualTopTBodyHgt+t;r[2].style.height=u[2].style.height=i._virtualBottomTBodyHgt+t},_renderTD:function(n,t,i){return String.format("<td class='{0}' style='{1}' >{2}<\/td>",n,t,i)},_renderDIV:function(n,t,i){return i?String.format("<div class='{0}' title='{2}'>{1}<\/div>",n,t,i):String.format("<div class='{0}'>{1}<\/div>",n,t)},_renderTR:function(n,t,i){var r=this._sheetCopy.isSheetCopy?this.getSheet(i).rowsHeightCollection[t]:this.model.rowHeight,u="height:"+r+"px";return String.format("<tr style='{0}'>"+n+"<\/tr>",u)},_renderFooter:function(){var i=t.buildTag("div.e-spreadsheetfooter"),u=t.buildTag("table.e-table","",{},{}),f=n(document.createElement("tbody")),e=n(document.createElement("tr")),r=n(document.createElement("td"));r.append(this._renderSpreadSheetPager());r.find(".e-pagercontainer").append(t.buildTag("div#"+this._id+"_AddSheet.e-new e-icon e-default","",null,{title:this._getLocStr("NewSheet")}));e.append(r);f.append(e);u.append(f);i.append(u);this.getMainPanel().append(i);i.width(this.model.scrollSettings.width).height(this.model.pageSettings.pagerHeight);this.setFooter(i);this._refreshSpreadSheetPager()},gotoPage:function(t,i){var f,r,u=this.model.sheets,h=this.getPager(),o="option",s="checked",e={reqType:"gotoSheet",gotoIndex:t,newSheet:i};this._trigActionBegin(e)||!i&&t>this.model.sheetCount||t<1||(this.setActiveSheetIndex(t),r=u[t],i||r._isRequested||!r._isImported?(this.element.find(".e-sheet").hide(),i&&(this._addSheet(t),r=u[t]),this._isSheetInsert&&(f=h.ejPager("option","currentPage"),this._swapSheetDtCntr(u.length-1,f),this.model.activeSheetIndex=t=f,this._isSheetInsert=!1),this._isNew||(this.model.scrollSettings.allowVirtualScrolling||this.model.scrollSettings.allowSheetOnDemand)&&!r._isLoaded?this._renderSheet(t):this.element.find("#"+this._id+"_"+r._sheetName.value).show(),r._isImported&&!r._isLoaded&&(this._refreshImpSheets(t),r._isLoaded=!0),(!r._isImported||r._isLoaded)&&this.model.enableContextMenu&&this.XLCMenu.hideCMenu(),this._refreshSpreadSheetPager(),this._initializeSelection(),this.getSheetElement(t).find(".e-ss-activeimg").length&&this.XLSelection._cleanUp(!0),this.model.showRibbon&&(this._updateRibbonTab(r._activeCell),this.isImport||(this.model.allowLockCell&&(u[t]._isSheetProtected?this.XLRibbon._disableRibbonIcons():this.XLRibbon._enableRibbonIcons(),this.XLRibbon._updateRibbonIcons()),this.model.allowComments&&this.XLComment._updateCmntRibIcons()),n("#"+this._id+"_Ribbon_Vheading").ejCheckBox(o,s,r.showHeader),n("#"+this._id+"_Ribbon_Vgridlines").ejCheckBox(o,s,r.showGridlines)),e={activeSheet:t,reqType:"gotoSheet"},this._trigActionComplete(e)):this._importSheet(t))},insertSheet:function(){if(this.model.allowInsert){var n=this.getPager(),t=n.ejPager("option","totalRecordsCount")+1;n.ejPager("option",{totalRecordsCount:t});this._isSheetInsert=!0;this.gotoPage(t,!0);this.setSheetFocus()}},_renameSheet:function(){var i=n(".e-currentitem"),r=t.buildTag("input#"+this._id+"_Sheet_RenamePanel","",{width:i.width()+5+"px",padding:0},{type:"input",value:i.text(),maxlength:"31"});i.hide();r.insertAfter(i).select().focus();this._isSheetRename=!0;this.model.showRibbon&&this.XLRibbon._disableRibbonIcons()},deleteSheet:function(n){var t=this.getActiveSheetIndex(),i=this._getSheetNames(!0).length;n=n||t;i>1?(n!==t&&this.gotoPage(n,!1),this.getObjectLength(this._dataContainer.sheets[n])?this._showAlertDlg("","SheetDeleteAlert","sheetDeleteActn",470):this._removeSheet(n)):this._showAlertDlg("Alert","SheetDeleteErrorAlert","",430)},hideSheet:function(t){var i=this._getSheetNames(!0),u=this._getSheetNames(),r=n.isNumeric(t)?t:this._getSheetIndexByName(t)||this.getActiveSheetIndex();i.length>1?(u[r-1].isVisible=!1,this.gotoPage(this._getNxtVisibleSheet(r,null,i))):this._showAlertDlg("Alert","SheetDeleteErrorAlert","",377)},unhideSheet:function(t){var r=this._getSheetNames(),i=n.isNumeric(t)?t:this._getSheetIndexByName(t);r[i-1].isVisible||(r[i-1].isVisible=!0,this.gotoPage(i))},_getNxtVisibleSheet:function(n,t,i){var r=this._getSheetNames(),u=r.length,f="<=",e=1,o=this._getSheetNames(!0),s=r[n-1].value===(i&&i[i.length-1].value||o[o.length-1].value);for((t||s)&&(u=0,f=">=",e=-1);this.operators[f](n,u);){if(r[n-1].isVisible)return n;n=n+e}},_renderSpreadSheetPager:function(){var i={},t=n(document.createElement("div"));return this.model.pageSettings.click=this._spreadSheetPagerClickHandler,this.model.pageSettings.totalRecordsCount=this.model.sheetCount,this.model.pageSettings.locale=this.model.locale,n.extend(i,this.model.pageSettings),i.currentPage=this.getActiveSheetIndex(),i.masterObject=this,i.pageSize=1,this.setPager(t),t.ejPager(i),t.ejPager("refreshPager"),inst=t.ejPager("instance"),inst._$first[0].title=this._getLocStr("Firstsheet"),inst._$last[0].title=this._getLocStr("Lastsheet"),inst._$next[0].title=this._getLocStr("Nextsheet"),inst._$prev[0].title=this._getLocStr("Prevsheet"),t.find(".e-parentmsgbar").remove(),t.find("a.e-PP").appendTo(t.find(".e-pagercontainer")),t.find("#NumericContainer").appendTo(t.find(".e-pagercontainer")),t.find("a.e-NP").appendTo(t.find(".e-pagercontainer")),t},_getPageCount:function(){var i,f,r=this.getPager(),e=0,o=r.find(".e-currentitem"),c=r.width()-(r.find(".e-pagercontainer").width()-r.find("#NumericContainer").width()),l=r.find(".e-link.e-numericitem:visible").not(".e-PP, .e-NP"),s=this._getSheetNames(),u=n(l[0]).data("index"),a=t.buildTag("canvas"),h=a[0].getContext("2d");for(h.font=o.css("font-size")+" "+o.css("font-family"),i=0,f=this.model.pageSettings.pageCount;i<f;i++)if(!this.isUndefined(s[u-1])){if(e+=h.measureText(s[u-1].text).width+25,c<=e)return i;u++}return i},_spreadSheetPagerClickHandler:function(i){var s,o,h=!1,r=this.model.masterObject,u,f=n(i.event.target),e;if(!f.hasClass("e-new")||!r.model.exportSettings.password)return(r.model.allowComments&&r.XLComment._isCommentEdit||r.XLEdit._isEdit)&&(i.event&&(f.hasClass("e-pager")||f.hasClass("e-new"))||r.element.find(".e-field-validation-error").length)?void 0:(r.model.allowComments&&r.XLComment._isCommentEdit&&r.XLComment._updateCurCmntVal(),r.XLEdit._isEdit&&r.XLEdit.saveCell(),!t.isNullOrUndefined(i.event)&&(f.hasClass("e-prevpage")||f.hasClass("e-nextpage")||f.hasClass("e-firstpage")||f.hasClass("e-lastpage"))&&(i.currentPage=r._getNxtVisibleSheet(i.currentPage,f.hasClass("e-prevpage")||f.hasClass("e-lastpage"))),u={activeSheet:r.getActiveSheetIndex(),gotoSheet:i.currentPage,newSheet:i.event&&f.hasClass("e-new")},u.newSheet?(s=r.getPager(),o=s.ejPager("option","totalRecordsCount")+1,u.gotoSheet=o):u.gotoSheet=i.currentPage,i.currentPage=u.gotoSheet,!t.isNullOrUndefined(i.event)&&i.event.target.id.indexOf("_Sheet_RenamePanel")>-1||r._isSheetRename&&!r._updateSheetNames(null,!1)||this._prevPageNo===i.currentPage)?void 0:(u.newSheet&&(s.ejPager("option",{totalRecordsCount:o,currentPage:o}),i.currentPage=o,h=!0),r.model.allowFiltering&&r._filterClose(),r.gotoPage(i.currentPage,h),r.XLFormat._formatEnable&&(e=r._getContent(u.activeSheet).find("div.e-content"),r.addClass(e,"e-ss-cursor"),r._removeClass(e,"e-ss-fpcursor"),e=r._getContent(u.gotoSheet).find("div.e-content"),r._removeClass(e,"e-ss-cursor"),r.addClass(e,"e-ss-fpcursor")),r._trigger("pagerClick",u))?void 0:(r.model.scrollSettings.isResponsive&&r._refreshSheetonResize(),n(i.event.target).hasClass("e-pager")||r._completeAction({reqType:"paging",sheetIndex:u.activeSheet,nSheetIndex:i.currentPage}),!1)},_pagerdblClickHandler:function(){this.XLEdit&&this.XLEdit._isEdit&&this.getActiveCellElem().find(".e-error").length||this._isSheetRename||this._renameSheet()},_createTemplateElement:function(t,i){var r=document.createElement("script");return r.id=(this._id+t+i.field+n.inArray(i,this.getSheet(t).columns)+"_Template").split(" ").join(""),r.type="text/x-jsrender",r.text=i.templateContent?i.templateContent:n(i.templateID).html(),n("body").append(r),n(i.templateID).hide(),r},_refreshSpreadSheetPager:function(){var t=this.getPager(),n={currentPage:this.getActiveSheetIndex()};(this.isImport||this._isNew||this.getPager()===null)&&(n.totalRecordsCount=this.model.sheetCount);n.pageCount=this._getPageCount();t.ejPager("option",n).ejPager("refreshPager");this._updatePageContainer(t,n.currentPage)},_updatePageContainer:function(t,i){for(var e,s,f=t.data("ejPager"),o=this.model.sheets,u=t.find(".e-link.e-numericitem:visible").not(".e-PP, .e-NP"),r=0,h=u.length;r<h;r++)n(u[r]).text(o[n(u[r]).data("index")]._sheetName.text),o[n(u[r]).data("index")]._sheetName.isVisible?s=n(u[r]).data("index")%f.model.pageCount:n(u[r]).hide(),!e&&o[n(u[r]).data("index")]._sheetName.isVisible&&(e=n(u[r]).data("index")%f.model.pageCount);f._$prev.removeClass("e-prevpagedisabled e-disable").addClass("e-prevpage e-default");e===i&&(f._$first.addClass("e-firstpagedisabled e-disable").removeClass("e-firstpage e-default"),f._$prev.addClass("e-prevpagedisabled e-disable").removeClass("e-prevpage e-default"));s===i&&(f._$last.addClass("e-lastpagedisabled e-disable").removeClass("e-lastpage e-default"),f._$next.addClass("e-nextpagedisabled e-disable").removeClass("e-nextpage e-default"))},_updateSheetNames:function(i,r){var c=this.getPager(),u,s,f=c.find(".e-currentitem"),e=this.model.sheets,o=n("#"+this._id+"_Sheet_RenamePanel"),h=!0;if(t.isNullOrUndefined(i)&&(i=o.val().trim()),r){o.remove();f.show();this.model.showRibbon&&this.XLRibbon._enableRibbonIcons();this._isSheetRename=!1;return}if(i.match(new RegExp(".*[\\[\\]\\*\\\\/\\^].*"))&&(i=!1),!i)return this._showAlertDlg("Alert","SheetRenameEmptyAlert","sheetRenameActn",500),!1;for(u=1,s=e.length;u<s;u++)f.text()!==e[u]._sheetName.text&&i.toLowerCase()===e[u]._sheetName.text.toLowerCase()&&(h=!1);if(h)return(e[f.data("index")]._sheetName.text=i)&&(o.remove(),f.show(),this._isSheetRename=!1),this._refreshSpreadSheetPager(),this.model.showRibbon&&this.XLRibbon._enableRibbonIcons(),!0;this._showAlertDlg("Alert","SheetRenameAlert","sheetRenameActn",325)},_getSheetIndexByName:function(n){var i=this._getSheetNames(),t,r;for(n&&(n=n.toLowerCase()),t=0,r=i.length;t<r;t++)if(i[t].text.toLowerCase()===n)return t+1;return!1},_removeSheet:function(n){var t=this.model.sheetCount,i=this._dataContainer.sheets;t>1&&(this._getAutoFillOptElem().appendTo(this.element),this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value).remove(),this.setActiveSheetIndex(t===this.getActiveSheetIndex()?n-1:n),this._swapSheetDtCntr(n,t),t in i&&delete i[t],this._sheets.splice(t,1),this.model.sheets.splice(t,1),t=--this.model.sheetCount,this.getPager().ejPager("option",{totalRecordsCount:t,pageCount:t}),this.gotoPage(this.getActiveSheetIndex(),!1),this._getAutoFillOptElem().appendTo(this._getContent(this.getActiveSheetIndex()).find(".e-content")),this._rebindScrollEvnt(),this.clearUndoRedo())},_rebindScrollEvnt:function(){for(var n=1;n<=this.model.sheetCount;n++)this._getContent(n).find(".e-content").off("scroll"),this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value).find(".e-headercontent").off("scroll"),this._refreshScrollerEvent(n)},_getSheetNames:function(n){for(var u=[],i=this.model.sheets,t=1,r=i.length;t<r;t++)(this.isUndefined(n)||(!n||i[t]._sheetName.isVisible)&&(n||!i[t]._sheetName.isVisible))&&u.push(i[t]._sheetName);return u},_initMoveCopyDlg:function(){var n=this._id+"_moveCopyDlg",i,r,f,e,o,s,u,h,c;i=t.buildTag("div#"+n,"",{display:"none"});r=t.buildTag("div#"+n+"_sheetContent.e-dlgctndiv e-dlg-fields",t.buildTag("label.e-dlg-fields",this._getLocStr("Beforesheet")));h=t.buildTag("div.e-dlg-fields");s=t.buildTag("ul#"+n+"_list");r.append(h.append(s));u=t.buildTag("input#"+n+"_createcopy");r.append(u);u.ejCheckBox({cssClass:"e-dlg-fields"});u.parent().append(t.buildTag("label",this._getLocStr("CreateaCopy"),{"margin-left":6}));i.append(r);o=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");c=t.buildTag("div.e-dlg-btnctnr");f=t.buildTag("input#"+n+"_okbtn");e=t.buildTag("input#"+n+"_cnlbtn");f.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._moveCopyBtnClick,this,"ok")});e.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._moveCopyBtnClick,this,"cancel"),showRoundedCorner:!0,width:"25%"});o.append(c.append(f,e));i.append(o);this.element.append(i);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("MoveorCopy"),width:280,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg"});s.ejListBox({dataSource:this._getSheetNames(),height:"197px",width:"250px",fields:{text:"text",value:"value"}})},_renderMoveCopyDlg:function(){var r=n("#"+this._id+"_moveCopyDlg"),t=n("#"+this._id+"_moveCopyDlg_list").data("ejListBox"),i=this._getSheetNames();i.push({text:this._getLocStr("MoveToEnd"),value:this._getLocStr("MoveToEnd")});r.ejDialog("open");t.model.dataSource=i;t.option("fields",{dataSource:i});t.unSelectAll();t.selectItemByIndex(0)},_initUnhideDlg:function(){var n=this._id+"_UnhideDlg",i,r,u,f,e,o,s;i=t.buildTag("div#"+n,"",{display:"none"});r=t.buildTag("div#"+n+"_sheetContent.e-dlgctndiv e-dlg-fields",t.buildTag("label.e-dlg-fields",this._getLocStr("UnhideDlgText")));o=t.buildTag("ul#"+n+"_list");r.append(o);i.append(r);e=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");s=t.buildTag("div.e-dlg-btnctnr");u=t.buildTag("input#"+n+"_okbtn");f=t.buildTag("input#"+n+"_cnlbtn");u.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._unhideBtnClick,this,"ok")});f.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._unhideBtnClick,this,"cancel"),showRoundedCorner:!0,width:"25%"});e.append(s.append(u,f));i.append(e);this.element.append(i);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("UnhideSheet"),width:280,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg"});o.ejListBox({dataSource:this._getSheetNames(),height:"197px",width:"250px",fields:{text:"text",value:"value"}})},_renderUnhideDlg:function(){var r=n("#"+this._id+"_UnhideDlg"),t=n("#"+this._id+"_UnhideDlg_list").data("ejListBox"),i=this._getSheetNames(!1);i.length>0&&(r.ejDialog("open"),t.model.dataSource=i,t.option("fields",{dataSource:i}),t.unselectAll(),t.selectItemByIndex(0))},_moveCopyBtnClick:function(i){switch(i){case"ok":var r,u,v,f,y=!1,s=2,o,e=n(this.element).find(".e-currentitem"),p=n("#"+this._id+"_moveCopyDlg_list").data("ejListBox"),h=n("#"+this._id+"_moveCopyDlg_createcopy").data("ejCheckBox"),a=p.getSelectedItems()[0].text,c=p.getIndexByText(a),l=this.model.sheets;if(!h.isChecked()&&a===e.text()){n("#"+this._id+"_moveCopyDlg").ejDialog("close");this.setSheetFocus();return}for(u=1;u<l.length;u++)a===l[u]._sheetName.text&&(r=u),e.text()===l[u]._sheetName.text&&(o=u);if(h.isChecked()){for(e.text().match(".*[ ]+[(]+[0-9]+[)]$")===null?f=e.text()+" ("+s+")":e.text().lastIndexOf(" ")!==-1&&(s=parseInt(e.text().substring(e.text().lastIndexOf("(")+1,e.text().lastIndexOf(")"))),f=e.text().substring(0,e.text().lastIndexOf(" "))+" ("+s+")");!y;){for(f=f.substring(0,f.lastIndexOf(" "))+" ("+s+")",u=1,v=l.length;u<v;u++)f===l[u]._sheetName.text&&s++;s===parseInt(f.substring(f.lastIndexOf("(")+1,f.lastIndexOf(")")))&&(y=!0)}this._copySheetProcess(o,f);o=this.model.sheetCount;t.isNullOrUndefined(r)&&(r=o)}else!t.isNullOrUndefined(r)&&r>o&&(r=r-1);if(t.isNullOrUndefined(r)&&(r=c),!h.isChecked()&&r===o){n("#"+this._id+"_moveCopyDlg").ejDialog("close");this.setSheetFocus();break}this._swapSheetDtCntr(o,r);n("#"+this._id+"_moveCopyDlg").ejDialog("close");r<=o&&(c=c+1);this.getPager().ejPager("option",{currentPage:c});this.gotoPage(c,!1);this._rebindScrollEvnt();h._unChecked();h._isChecked=!1;this.setSheetFocus();break;case"cancel":n("#"+this._id+"_moveCopyDlg").ejDialog("close")}},_unhideBtnClick:function(t){if(t==="ok"){var i=n("#"+this._id+"_UnhideDlg_list").data("ejListBox");this.unhideSheet(i.getSelectedItems()[0].text)}n("#"+this._id+"_UnhideDlg").ejDialog("close")},_swapSheetDtCntr:function(n,t){var f=this._dataContainer.sheets,i=this.model.sheets,e=this._sheets,o=this._getLocStr("Sheet"),s=[{}],h,l=this._getSheetNames(),u,r,c;for(u in f)f.hasOwnProperty(u)&&(s[parseInt(i[u]._sheetName.value.replace(o,""))]=f[u]);for(i.splice(t,0,i.splice(n,1)[0]),e.splice(t,0,e.splice(n,1)[0]),r=1,c=i.length;r<c;r++)h=parseInt(i[r]._sheetName.value.replace(o,"")),this._dataContainer.sheets[r]=s[h];this.clearUndoRedo()},_copySheetProcess:function(t,i){var e,c=this.getPager(),l=c.ejPager("option","totalRecordsCount")+1,u=this.model.sheets,r,s,f,h,a,o,v;if(c.ejPager("option",{totalRecordsCount:l,currentPage:l}),u.push(jQuery.extend(!0,{},u[t])),this._sheetCopy={isSheetCopy:!0,sheetContent:this._getContent(t).find(".e-table").clone(!0).get(0)},r=this.model.sheetCount+1,u[r]._sheetName.text=i,s=u[r]._sheetName.value=this._getLocStr("Sheet")+this._newSIndex,this._newSIndex++,this.setActiveSheetIndex(r),this._dataContainer.sheets[r]=n.extend(!0,{},this._dataContainer.sheets[t]),f=this._sheets[r]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null,_calcEngine:null},this._renderSheet(r),this.model.sheetCount++,this._sheetCopy={isSheetCopy:!1,sheetContent:null},f._calcEngine=new CalcEngine(this,this._calcID),f._calcEngine.setUseDependencies(!0),f._calcEngine.setExcelLikeComputations(!0),f._calcEngine.setUseDatesInCalculations(!0),f._calcEngine.registerGridAsSheet(s,s,this._calcID),!this.model.scrollSettings.allowVirtualScrolling)for(h=this._getContent(r).find(".e-commentcell"),o=0,v=h.length;o<v;o++)a=n(h[o]),e=this._getCellIdx(n(".e-commentcell")[0]),a.removeClass("e-commentcell")&&this.XLComment.setComment([e.rowIndex,e.colIndex,e.rowIndex,e.colIndex],null,!1);this.model.allowComments&&this.XLComment._updateCmntArrowPos();this.model.allowSelection&&this.XLSelection.selectRange(u[r]._startCell,u[r]._endCell)},showActivationPanel:function(n){var u,r=this.getActiveSheetIndex(),t=this.getActivationPanel(),i=this.model.scrollSettings;if(this.isUndefined(n))t.is(":visible")&&(t.hide(),this._setSheetWidthHeight(r,{width:i.width,height:i.height},null,"resize"),this.getMainPanel().width(this.getMainPanel().width()+this.model.apWidth));else if(u=this.getSheet(r).rangeSettings[n],u.showPanel){if(this._trigger("beforePanelOpen",{activationPanel:t,range:u,sheetIndex:r}))return;this._setSheetWidthHeight(r,{width:i.width-this.model.apWidth,height:i.height},null,"resize");t.width(this.model.apWidth).height(this.getMainPanel().height());this.getMainPanel().width(i.width-this.model.apWidth);t.show()}},_addSheet:function(n){this._sheetSettings(n);this._dataContainer.sheets[n]={};this._renderSheet(n);this._newSIndex++;this.model.sheetCount++},addNewSheet:function(){this.element.find(".e-pager .e-new").click()},_createFocusElement:function(){this.setFocusTopElem(n("<div class='e-focustop e-hide' ><\/div>"));this.setFocusRightElem(n("<div class='e-focusright e-hide' ><\/div>"));this.setFocusBottomElem(n("<div class='e-focusbottom e-hide' ><\/div>"));this.setFocusLeftElem(n("<div class='e-focusleft e-hide' ><\/div>"))},_createAutoFillElement:function(){var i,r=this._getContent(this.getActiveSheetIndex()).find(".e-content");this.model.allowAutoFill&&(i=n("<div class='e-autofill e-hide'><\/div>"),r.append(i),this.setAutoFillElem(i));this.model.autoFillSettings.showFillOptions&&(this.element.append(t.buildTag("ul.e-spreadsheet","",{width:"auto"},{id:this._id+"_ctxtmenu"})),i=n("<div class='e-splitspan e-hide' title="+this._getLocStr("AutoFillTitle")+"><button id="+this._id+"_dragfilloptionbtn><\/button><\/div>"),r.append(i),this._setAutoFillOptElem(i));this._initializeSplitButton()},_initializeSplitButton:function(){this._getAutoFillOptElem().find("button").ejSplitButton({size:"normal",contentType:"imageonly",targetID:this._id+"_ctxtmenu",prefixIcon:"e-icon e-ss-autofill",isSeparator:!1,buttonMode:t.ButtonMode.Dropdown,imagePosition:t.ImagePosition.ImageLeft,arrowPosition:t.ArrowPosition.Right,fields:{dataSource:this._fillOptionMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},beforeOpen:n.proxy(this.model.allowAutoFill&&this.XLDragFill._autoFillClick,this),itemSelected:n.proxy(this.model.allowAutoFill&&this.XLDragFill._autoFillOptionClick,this),width:"42px",height:"24px",cssClass:"e-spreadsheet e-autofillbtn"})},_renderFormulaBar:function(){var t;this.element.append("<div id="+this._id+"_formulabar class='e-formulabar' ><div id="+this._id+"_indexbox class='e-indexbox' title='"+this._getLocStr("NameBox")+"'><\/div><div class='e-inputbox' ><input id="+this._id+"_inputbox type='text' title='"+this._getLocStr("FormulaBar")+"'/><\/div><\/div>");this._setIndexBox(n("#"+this._id+"_indexbox"));t=n("#"+this._id+"_inputbox");this._setInputBox(t);this.XLEdit._renderAutoComplete(t,"",23);this._alignFormulaBar()},_alignFormulaBar:function(n){n=n||this._responsiveWidth;this.element.find(".e-formulabar").width(n);n=parseInt(n);var i,r,t;i=n/10;r=n-(i+25);t=this.element.find(".e-inputbox");t.hide();t.width(Math.floor(r));this.element.find(".e-indexbox").width(Math.floor(i));t.show()},hideFormulaBar:function(){n("#"+this._id+"_formulabar").hide()},showFormulaBar:function(){this.model.allowFormulaBar&&(n("#"+this._id+"_formulabar").show(),this.updateFormulaBar())},updateFormulaBar:function(){var r,i,e,u=this.getActiveSheetIndex(),n=this.getSheet(u)._activeCell,f=this._getContent(u).find(".e-ss-activeimg")[0];i=this.getRangeData([n.rowIndex,n.colIndex,n.rowIndex,n.colIndex],!1,["value","value2","isLocked"])[0];r=t.isNullOrUndefined(i)?"":t.isNullOrUndefined(i.value)?"":i.value;this._isDateTime(r)&&(r=i.value2);this._getInputBox().val(r);this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"isReadonly")||this.model.allowLockCell&&this.getSheet(u)._isSheetProtected&&i.isLocked?this._getInputBox().attr("readonly","readonly"):this._getInputBox().removeAttr("readonly");e=f&&(f.id.indexOf(this._id+"_picture")>-1||f.id.indexOf(this._id+"_chart")>-1)?f.id.split("_")[1]:this._getAlphaRange(u,n.rowIndex,n.colIndex,n.rowIndex,n.colIndex);this._getIndexBox().html(e)},_initializeSelection:function(){var i,r=this.model,f=this.getActiveSheetIndex(),n=this.getSheet(f),u=this._getContent(f).find(".e-content"),e=r.selectionSettings.selectionType,o=t.Spreadsheet.SelectionType,s=r.selectionSettings.activeCell;u.append(this.getFocusTopElem(),this.getFocusRightElem(),this.getFocusBottomElem(),this.getFocusLeftElem());r.allowSelection&&(s&&(i=this.getRangeIndices(s),!this.isRange(i)&&i[0]<n.rowCount&&i[1]<n.colCount&&(n._startCell=n._endCell=n._activeCell={rowIndex:i[0],colIndex:i[1]})),(!n._isImported||n._isLoaded)&&n._selectedCells.length?this.XLSelection._refreshBorder():(this.XLSelection._processBoundary(),e===o.Row?this.XLSelection.selectRows(n._startCell.rowIndex,n._endCell.rowIndex):e===o.Column?this.XLSelection.selectColumns(n._startCell.colIndex,n._endCell.colIndex):this.XLSelection.selectRange(n._startCell,n._endCell)));this.getAutoFillElem()||this._createAutoFillElement();r.allowAutoFill&&(this.getAutoFillElem().appendTo(u),this.XLDragFill.positionAutoFillElement());r.autoFillSettings.showFillOptions&&r.allowAutoFill&&(this._getAutoFillOptElem().appendTo(u),this.XLDragFill.hideAutoFillOptions())},_updateRibbonTab:function(t){var i,r,f=this.getActiveSheetIndex(),e=n("#"+this._id+"_Ribbon").data("ejRibbon"),o=this.element.find(".e-ribbon .e-contextul a:visible"),u=o.length,s=e.element.find("#"+this._id+"_Ribbon_togglebutton");if(t&&(r=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"tableName",f)),u)while(u--)e.hideTab(o[u].text);s.hasClass("e-ribbonpin")&&this._refreshSheetonResize();i=this._getContent(f).find(".e-ss-activeimg");i.length?i[0].id.indexOf("chart")>-1?this.XLRibbon._chartDesignTabUpdate(i):this.XLRibbon._formatTabUpdate():r&&this.XLRibbon._designTabUpdate(this._getTableID(r),t)},_updateCellType:function(){var n,i=t.Spreadsheet.CellType;for(n in i)this._dataContainer.cellType.push(i[n])},_updateFormulaCollection:function(){var n,i=(new CalcEngine).getLibraryFunctions(),t=[];for(n in i.items)t.push({text:"="+n,display:n});this._formulaCollection=t},_renderScroller:function(n,t){this.XLScroll._createScroller(n,t);this._refreshScrollerEvent(n)},_refreshScrollerEvent:function(i){this._getContent(i).find(".e-content").scroll(t.proxy(function(t){this._getJSSheetHeader(i).find(".e-headercontent").scrollLeft(n(t.currentTarget).scrollLeft());this._getJSSheetRowHeaderContent(i).scrollTop(n(t.currentTarget).scrollTop())},this));this.element.find("#"+this._id+"_"+this.model.sheets[i]._sheetName.value).find(".e-headercontent").scroll(t.proxy(function(t){var r=n(t.currentTarget);this._getContent(i).find(".e-content").first().scrollLeft(r.scrollLeft())},this))},_rClickHandler:function(){t.isNullOrUndefined(this._excelFilter)||(this.XLFilter._isSearchEdit=!1,this._excelFilter.closeXFDialog())},_cellClick:function(i){var e,r=i.target,o=this.getActiveSheetIndex(),u,s,f;if(i.target.tagName==="TD"&&n(i.target).parents("div")[0].className.indexOf("e-content")>-1){if(u=r.cellIndex,s=n.inArray(n(r).closest("tr").get(0),this.getRows(o)[1]),f=this.getSheet(o).columns[u],e={columnName:f.field,value:n(r).data("value"),columnIndex:u,rowIndex:s,columnObject:f,cell:r,eventArgs:i,event:i,target:i.target},this._trigger("cellClick",e))return}else if(!t.isNullOrUndefined(n(i.target).parents("div"))&&n(i.target).parents("div")[0].className.indexOf("e-content")>-1&&(r=n(i.target).parents("td").get(0),!t.isNullOrUndefined(r)&&(u=r.cellIndex,s=n.inArray(n(r).closest("tr").get(0),this.getRows(o)[1]),f=this.getSheet(o).columns[u],e={columnName:f.field,value:n(r).data("value"),columnIndex:u,rowIndex:s,columnObject:f,cell:r,eventArgs:i,event:i,target:i.target},this._trigger("cellClick",e))))return},_wireEvents:function(){var f,e=this,i=this.element,r=t.eventType,u=this._id;this._on(i,r.mouseDown,".e-ribbon, .e-spreadsheetcontentcontainer .e-vscroll, .e-spreadsheetcontentcontainer .e-hscroll",this._rClickHandler);this._on(i,r.mouseDown,".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel",this._mouseDownHandler);this._on(i,"keydown",this._keyDownHandler);this._on(i,"keydown",".e-ss-object",this._keyDownHandler);this._on(i,"keyup",this._keyUpHandler);this._on(i,"click",".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel, .e-ss-object",this._cellClick);this._on(i,"dblclick",".e-spreadsheetcontentcontainer,.e-spreadsheetheader,.e-spreadsheetrowheader",this._recorddblClickHandler);this._on(i,"dblclick",".e-numericcontainer .e-numericitem",this._pagerdblClickHandler);this._on(i,r.mouseMove,this._mouseMove);this._on(i,r.mouseUp,this._sheetMouseUp);this.model.allowResizing&&this._on(i,r.mouseLeave,".e-spreadsheetrowheader,.e-spreadsheetheader",this._mouseLeave);this._on(i,r.click,".e-ssfiltered, .e-ssfilter, .e-ssfiltered-asc, .e-ssfilter-asc, .e-ssfiltered-dsc, .e-ssfilter-dsc",this._filterDownHandler);this._on(i,r.mouseDown,".e-ssddl",this._ddlopen);this._on(i,"mouseover",".e-rowcell",this._cellHoverHandler);this._on(i,"mouseover",".e-viewhdrlbl, .e-vheading",this._headingchkboxHover);this._on(i,"mouseover",".e-viewlinlbl, .e-vgridlines",this._gridlineschkboxHover);this._on(i,"mouseleave",".e-viewhdrlbl, .e-vheading",this._headingchkboxLeave);this._on(i,"mouseleave",".e-viewlinlbl, .e-vgridlines",this._gridlineschkboxLeave);this.model.allowFormulaBar&&this._on(this._getInputBox(),"input",this.XLEdit._formulaBoxInputChange);this._on(n("#"+u+"_cellstyles"),r.click,this._cellStyleClick);this._on(n("#"+u+"_formatastable"),r.click,this._formatAsTableClick);this._on(n("#"+u+"_nmuseinformula"),r.click,".e-nmuseinformularow",this._useInFormulaClick);this.model.scrollSettings.allowScrolling&&this.element.find(".e-spreadsheet-list").bind("mousewheel DOMMouseScroll",n.proxy(this.XLScroll._spreadMouseWheel,this.XLScroll));this._on(n(".e-menu .e-chartcontent .e-chartcell"),r.click,this._chartClickHandler);this._on(n("#"+u+"_allchart").find(".e-chartimg"),r.click,this._allChartType);this.model.scrollSettings.isResponsive&&(window.onresize=function(){f&&clearTimeout(f);f=setTimeout(function(){e._spreadsheetonresize()},100)})},_headingchkboxHover:function(){this.element.find(".e-vheading .e-chk-act, .e-vheading .e-chk-inact").addClass("e-chkhover")},_gridlineschkboxHover:function(){this.element.find(".e-vgridlines .e-chk-act,.e-vgridlines .e-chk-inact").addClass("e-chkhover")},_headingchkboxLeave:function(){this.element.find(".e-vheading .e-chk-act, .e-vheading .e-chk-inact").removeClass("e-chkhover")},_gridlineschkboxLeave:function(){this.element.find(".e-vgridlines .e-chk-act,.e-vgridlines .e-chk-inact").removeClass("e-chkhover")},_allChartType:function(t){n("#"+this._id+"_allchart").find(".e-chartimg").removeClass("e-chartselect");n(t.target).addClass("e-chartselect")},_spreadsheetonresize:function(){this._refreshSheetonResize()},_refreshSheetonResize:function(){var u=this.getActiveSheetIndex(),i,o=this.getActivationPanel(),f=n(".e-menu:visible[id^="+this._id+"], .e-ddl-popup:visible[id^="+this._id+"]"),t,r,e=["CFormat","Validation","PageSize","FPane","Ins","Del","FindRep"];this.element.find(".e-inputbox").hide();i={width:this.model.scrollSettings.width,height:this.model.scrollSettings.height};i.width=o.is(":visible")?i.width-this.model.apWidth:i.width;this._setSheetWidthHeight(u,i,null,"resize");this.element.find(".e-inputbox").show();this.model.scrollSettings.allowScrolling&&this.XLScroll._scrollSelectedPosition(u,this.getActiveCell());f.length&&(t=f[0].id.split("_",3),t.indexOf("Ribbon")===-1&&t.splice(1,0,"Ribbon"),t[2]=e.indexOf(t[2])>-1?["cFormat","validationsbtn","sizesbtn","fPane","inssbtn","delsbtn","find"][e.indexOf(t[2])]:t[2].toLowerCase(),t=t.join("_"),t.length&&(r=n("#"+t),r.hasClass("e-splitbutton")&&r.ejSplitButton("hide"),r.hasClass("e-dropdownlist")&&r.ejDropDownList("hidePopup")))},_chartClickHandler:function(t){var i=n(t.target),r=n.extend(!0,{},n(t.target).data());i.parents().eq(1).hide();this.XLChart.createChart(null,r)},_useInFormulaClick:function(t){var r=this.getActiveSheetIndex(),i=this.getActiveCellElem(r)[0];this.XLEdit.editCell(i.parentNode.rowIndex,i.cellIndex,!0);n("#"+this._id+"_Edit").text("="+t.target.textContent);n("#"+this._id+"_Edit").focusEnd();n("#"+this._id+"_nmuseinformula").hide()},_formatAsTableClick:function(t){var r,u,f=t.target,e=this.getActiveSheetIndex(),o=this.getSheet(e),i=o._selectedCells;i.length!==0&&f.parentNode.className==="e-formatastablecell"&&(r=this.XLEdit.getPropertyValue(i[0].rowIndex,i[0].colIndex,"tableName",e),r?(this.XLFormat._formatAsTableStyle=n(f.parentNode).data(),this.XLFormat._createTable(this._getTableID(r),this.XLFormat._formatAsTableStyle)):i.length>1?(u=n("#"+this._id+"_fatname"),n("#"+this._id+"_fatnamedlg").ejDialog("open"),n("#"+this._id+"_fatheader").data("ejCheckBox").option("checked",!1),u.val("Table"+this._tableCnt++).focus().setInputPos(u.val().length),this.model.allowCellFormatting&&(this.XLFormat._formatAsTableStyle=n(f.parentNode).data())):this._showAlertDlg("Alert","FormatAsTableAlert",null,445),n("#"+this._id+"_Ribbon_formatastable").data("ejSplitButton")._hidePopup())},_getTableID:function(n,t){var i,r=this.getSheet(this.getActiveSheetIndex())._tableManager;if(t){for(i in r)if(t===r[i].name)return Number(i)}else for(i in r)if(n.indexOf("e-table"+i)>-1)return Number(i)},_cellStyleClick:function(t){var i=this.model.sheets[this.getActiveSheetIndex()].selectedRange,r=t.target.className,f=this.XLFormat.getFormatClass(r),u={range:i,sheetIndex:this.getActiveSheetIndex(),reqType:"cell-styles",beforeFormat:this.getRangeData(i,!1,["format","formats"])};r.indexOf("e-cellstylecell")>-1&&this.XLFormat.updateUniqueFormat(f);u.afterFormat=this.getRangeData(i,!1,["format","formats"]);this.isUndoRedo||this._completeAction(u);n("#"+this._id+"_Ribbon_cellstyles").data("ejSplitButton")._hidePopup();this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()},_cellHoverHandler:function(n){var t={target:n.target};this._trigger("cellHover",t)},_filterDownHandler:function(t){t.target.className.indexOf("e-ssfilter")>-1&&(this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")?this._excelFilter.closeXFDialog():this.XLFilter._filterClickHandler(t))},_mouseDownHandler:function(i){var y,o,s;i.target=this._changeTargetWithOffset(i);var l,a,u,c="e-ss-object",r=i.target,f=n(r),e=this.getActiveSheetIndex(),p=this.getSheet(e),v,w=!0,h=n("#"+this._id+"_Ribbon").data("ejRibbon"),b=!0,o;if((this.model.allowCharts&&p._isChartBorderDrawn&&this.XLChart._clearChartRange(this._arrayAsString(this._chartBorder)),(this.model.pictureSettings.allowPictures||this.model.allowCharts)&&(f.hasClass(c)||n(f).parents("."+c).length)?(f.hasClass(c)||(r=i.target=n(f).parents("."+c)[0]),this.XLShape._shapeMouseDown(i)):(b=!1,this.XLShape._shapeROStart&&this.XLShape._shapeRSStart||this._getContent(e).find(".e-ss-activeimg").removeClass("e-ss-activeimg e-ss-imgcresize e-ss-imgrresize")),l=r.className,r.id.indexOf("picture")===-1&&this.model.showRibbon&&(h.model.selectedItemIndex===this.XLRibbon._getTabIndex("format")||h.isVisible("Format"))&&this.XLRibbon._toggleFormatTab(),this.model.showRibbon&&r.id.indexOf("chart")>-1?this.XLRibbon._chartDesignTabUpdate(n(r)):this.model.showRibbon&&(h.model.selectedItemIndex===this.XLRibbon._getTabIndex("cdesign")||h.isVisible("Chart Design"))&&this.XLRibbon._toggleChartDesignTab(),!this.XLEdit._isEdit||r.nodeName=="TD"||this._hasClass(r,"e-autofill"))&&(this.model.allowDragAndDrop&&this.XLDragDrop._isDragAndDropStart&&l!=="e-autofill"&&l.indexOf("e-filterspan")<0&&this.XLDragDrop._dMouseDown(i),this.model.allowResizing&&!this.XLEdit._isEdit&&(n(r).hasClass("e-headercelldiv")||n(r).hasClass("e-headercell")?this.XLResize._headerMouseDown(i):n(r).hasClass("e-rowheader")?this.XLResize._rowMouseDown(i):n(r).hasClass("e-spreadsheetactpanel")&&this.XLResize._apMouseDown(i)),!(n(r).parents("div.e-spreadsheetactpanel").length>0))){if(w=this.XLEdit._isEdit?(this._isFormulaSuggestion||!this.XLEdit._isFormulaEdit)&&this.XLEdit.saveCell():!0,!w&&!this.XLEdit._isFormulaEdit)return!1;this.model.allowComments&&!f.hasClass("e-pager")&&this.getSheetElement(e).find(".e-commentcell").length&&this.XLComment._commentMouseDownHandler(i);r.tagName!=="SPAN"&&r.tagName!=="A"||t.isNullOrUndefined(f.parent("td")[0])?r.tagName==="TD"?(o=r,u=this._getCellIdx(o),this.model.showRibbon&&this.XLRibbon.updateRibbonIcons()):u=this.getActiveCell():(o=f.parent("td")[0],u=this._getCellIdx(o));r.tagName==="A"?(p._activeCell=u,this.XLSelection.selectRange(u,u),i.which!==3&&this._hlClick(this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"hyperlink",e))):(i.button!==2||i.which!==3||this.getSheetElement(e).find(".e-selected, .e-colselected .e-headercelldiv, .e-rowselected").index(r)===-1)&&this.model.allowSelection&&!b&&(t.isNullOrUndefined(this.XLDragDrop)||!this.XLDragDrop._allowDragAndDrop)&&(this.XLResize&&this.XLResize._resizeStart||f.hasClass("e-comment-txtarea")||this.XLSelection._selectionMouseDownHandler(i));this.model.allowFiltering&&this._filterClose();this._undoInputobj={};r.tagName==="TD"&&n(r).parents("div")[0].className==="e-content"&&this.displayActivationPanel(this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"range"));r.tagName==="TD"&&r.className.indexOf("e-rowheader")<0&&(t.isNullOrUndefined(this._ddlCell)||(this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup"),this.element.find("#"+this._id+"ddlspan").remove(),this._ddlCell=null));r.tagName==="TD"&&(y=this._getCellIdx(r),t.isNullOrUndefined(this.XLEdit.getPropertyValue(y.rowIndex,y.colIndex,"rule",e))||this._setddlCell(i));this._isSheetRename&&this._updateSheetNames(null,!1);this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup");this._hasClass(r,"e-rowcell")&&(a=this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"tableName",e));a?(v=this._getTableID(a),this.isNumber(v)&&this.XLRibbon._designTabUpdate(v,u)):this.model.showRibbon&&(h.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||h.isVisible(this._getLocStr("Design")))&&this.XLRibbon._toggleDesignTab(u);this.model.allowEditing&&(o=this.getSheet(this.getActiveSheetIndex())._activeCell,this.XLEdit._isEdit&&i.target.id!==this._id+"_inputbox"&&(s=n(i.target).hasClass("e-ss-input")||!this.XLEdit._isFBarFocused?this.element.find("#"+this._id+"_Edit"):this._getInputBox(),s&&(i.target.id!==s[0].id&&s.focus().setInputPos(s[0].selectionStart,s[0].selectionEnd),s.hasClass("e-ss-input")&&(this.XLEdit._isFBarFocused=!1))),this.model.allowComments&&this.XLComment._isCommentEdit||this._isSheetRename||i.target.id!==this._id+"_inputbox"||(i.target.readOnly?this.setSheetFocus():(this.XLEdit._isEdit||this.XLEdit.editCell(o.rowIndex,o.colIndex,!0),this._getInputBox().focus(),this.XLEdit._isFBarFocused=!0)))}},_renderDDownList:function(){this.element.append(t.buildTag("input","","",{id:this._id+"ddl",style:"display:none"}));n("#"+this._id+"ddl").ejDropDownList({fields:{id:"Types",text:"text",value:"text"},beforePopupShown:n.proxy(this._drppopupshow,this),cssClass:"e-"+this._id+"-ddl",width:.1,height:.1,change:n.proxy(this._changeddl,this)})},_setddlCell:function(i){var a,p=[],w,c,f,v,l=this.getActiveSheetIndex(),b,o,r,h,e,u,y,s;if(t.isNullOrUndefined(i)||i.type!=="mousedown"?(f=this.getActiveCell(),v=n("#"+this._id+"GroupPanel").find("div.e-content")[0]):(f=this._getCellIdx(i.target),v=i.currentTarget),c=this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"rule",l),c&&c.type==="list"){if(this._ddlCell=f,w=c.customVal.split("_"),o=w[0],e=[],o.startsWith("=")&&o.indexOf(",")<0){for(u=n.trim(o.replace("=","")),u.indexOf("!")>-1&&(y=u.split("!"),l=this._getSheetIndexByName(y[0]),u=y[1]),u.indexOf("$")>-1&&(u=u.split("$").join("")),u.indexOf(":")<0&&(u=u+":"+u),range=this.getRangeIndices(u),s=this.getRange(range),r=0,h=s.length;r<h;r++)!t.isNullOrUndefined(n(s[r]))&&this.XLEdit.getPropertyValueByElem(n(s[r]),null,l)?e.push(this.XLEdit.getPropertyValueByElem(n(s[r]),null,l)):e.push("");e.length||e.push(o)}else o.indexOf(",")>-1?e=o.split(","):(e=[],e.push(o));for(r=0,h=e.length;r<h;r++)p[r]={id:r+1,text:e[r].toString()};f=this.getCell(f.rowIndex,f.colIndex);a={top:f[0].offsetTop,left:f[0].offsetLeft};b=f.height()-18;v.insertAdjacentHTML("beforeEnd","<span id='"+this._id+"ddlspan' class='e-icon e-ssddl e-spanddl e-ddlspan' role='button'><\/span>");n("#"+this._id+"ddlspan").css({top:a.top+b,left:a.left+f.width()+3});n("#"+this._id+"ddl").ejDropDownList("option","dataSource",p)}},_drppopupshow:function(){var t=this.getCell(this._ddlCell.rowIndex,this._ddlCell.colIndex);n("#"+this._id+"ddl_popup").css({width:this.getActiveCellElem().width()+20,"font-size":"11",top:t.position().top,left:t.position().left})},_ddlPosition:function(){var t=this.getCell(this._ddlCell.rowIndex,this._ddlCell.colIndex),i={top:t[0].offsetTop,left:t[0].offsetLeft};n("#"+this._id+"ddlspan").css({top:i.top+t.height()-19,left:i.left+t.width()+3})},_changeddl:function(n){this.XLEdit.updateCellValue(this.getActiveCell(),n.selectedText);this.getActiveCellElem().hasClass("e-hlcell")&&this.XLValidate.highlightInvalidData()},_ddlopen:function(i){var f=this.getActiveSheetIndex(),e=this.getActiveCell(f),r,u;if(this.XLEdit._isEdit&&this.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"rule").customVal.split("_")[2]==="true")return!1;this.XLEdit.saveCell();r=n("#"+this._id+"ddl").data("ejDropDownList");u=this.getCell(this._ddlCell.rowIndex,this._ddlCell.colIndex);i.stopPropagation();t.isNullOrUndefined(r)||(r._isPopupShown()?r._hideResult():(r._showResult(),n("#"+this._id+"ddl_popup").css({width:this.getActiveCellElem().width()+20,"font-size":"11",top:20,left:100}),n("#"+this._id+"ddl_popup_list_wrapper").css({top:this._getJSSheetHeader(f).position().top+this._colHeaderHeight+parseInt(u.parent("tr").css("height"))+u.position().top,left:this._getJSSheetRowHeader(f)[0].offsetLeft+u.position().left+this._rowHeaderWidth})))},_mouseMove:function(i){i.target=this._changeTargetWithOffset(i);var r=n(i.target);!this.model.allowResizing||!(this.XLResize._resizeType==="Col"||r.hasClass("e-headercelldiv")||r.hasClass("e-headercell")||r.hasClass("e-reSizeColbg"))||this.XLEdit._isEdit||this.XLCMenu&&this.XLCMenu._isMenuOpened?!this.model.allowResizing||!(this.XLResize._resizeType==="Row"||r.hasClass("e-rowheader")||r.hasClass("e-reSizeRowbg"))||this.XLEdit._isEdit||this.XLCMenu&&this.XLCMenu._isMenuOpened?this.model.allowResizing&&(this.XLResize._resizeType==="AP"||r.hasClass("e-spreadsheetactpanel")||r.parents("e-spreadsheetactpanel").length>0)?this.XLResize._apMouseMove(i):(this.model.pictureSettings.allowPictures||this.model.allowCharts)&&(r.hasClass("e-ss-object")||r.parents(".e-ss-object").length||this.XLShape._shapeROStart||this.XLShape._shapeRSStart||r.hasClass("e-ss-imgvisual"))&&this.XLShape._imgMouseMove(i):this.XLResize._rMouseMove(i):this.XLResize._cMouseMove(i);this.model.allowDragAndDrop&&t.spreadsheetFeatures.dragAndDrop&&r.hasClass("e-rowcell")&&!this.XLEdit._isEdit&&this._getJSSheetHeader(this.getActiveSheetIndex())[0].querySelector(".e-spreadsheetcolumnheader").className.indexOf("e-sheetselected")===-1&&this.XLDragDrop._dMouseMove(i);this.model.allowComments&&!this.XLComment._isCommentEdit&&this.getSheetElement(this.getActiveSheetIndex()).find(".e-commentcell").length>0&&this.XLComment._commentMouseMove(i);t.isNullOrUndefined(i.target.parentNode)||i.target.id.indexOf("_svg")<0&&i.target.parentNode.className.indexOf("e-content")<0&&!n(i.target).is("td.e-rowcell")&&this.XLShape._shapeMouseUp(i)},_mouseLeave:function(){n(".e-ss-colresize, .e-ss-rowresize").removeClass("e-ss-colresize e-ss-rowresize")},_sheetMouseUp:function(t){this.model.allowResizing&&(this.XLResize._resizeType==="Col"?this.XLResize._cMouseUp(t):this.XLResize._resizeType==="Row"?this.XLResize._rMouseUp(t):this.XLResize._resizeType==="AP"&&this.XLResize._apMouseUp(t));this.model.allowDragAndDrop&&this.XLDragDrop._allowDragAndDrop&&this.XLDragDrop._dMouseUp(t);this.model.allowComments&&this.XLComment._isCommentEdit&&this.getActiveCellElem().find("textarea").focus();this._isSheetRename&&n("#"+this._id+"_Sheet_RenamePanel").focus();this.model.pictureSettings.allowPictures&&this.XLShape._shapeMouseUp(t)},_keyDownHandler:function(r){var a,h,b=!0,v=!1,o=this.getActiveSheetIndex(),u=this.element.find("#"+this._id+"_AutoComplete").data("ejAutocomplete"),y,p,c,l,f,e,k,w=n("#"+this._id+"_Ribbon").data("ejRibbon"),s,d;if(this._getContent(o).find(".e-ss-activeimg").length&&(v=!0,a=document.activeElement.id,a.indexOf(this._id+"_pictureheight")<0&&a.indexOf(this._id+"_picturewidth")<0&&this.XLShape._imgKeyDown(r)),u.showSuggestionBox&&u.suggestionList){if(r.keyCode===38){u._removeListHover();u._activeItem=u._activeItem>1?u._activeItem-1:u._listSize;u._addListHover();u._targetFocus();return}if(r.keyCode===40){u._removeListHover();u._activeItem=u._activeItem<u._listSize?u._activeItem+1:1;u._addListHover();return}}if(r.target.id.indexOf("_Edit")>-1&&(this.XLCellNav._canKeyBoardNavigate=!0),this.XLEdit._editElem&&(h=this.XLEdit._editElem.text()),r.target.id.indexOf("_Edit")>-1&&r.keyCode===9&&h.indexOf("=")===0&&h.indexOf(")")!=h.length-1){if(r.preventDefault(),!u.suggestionList.is(":visible")&&this.model.allowKeyboardNavigation){this._isFormulaSuggestion&&(r.keyCode===39||r.keyCode===37||r.keyCode===13&&!r.altKey)&&this.XLEdit.saveCell();this.XLCellNav._selectionKeyDownHandler(r);return}if(y=this.model.nameManager.length,i=0,p=!1,c,l=u._getActiveText(),y)while(i<y){if(this.model.nameManager[i].name===l.slice(1)){p=!0;break}i=i+1}c=p?l:l+"(";this.XLEdit._editElem.text(c);this.model.allowFormulaBar&&this._getInputBox().val(c);r.target.id.indexOf("_Edit")>-1&&this.XLEdit._editElem.focusEnd();this.XLCellNav._canKeyBoardNavigate=!1;return}if(r.target.id.indexOf("_Custom")<0&&r.target.id.indexOf("_Ribbon")<0){if(r.stopImmediatePropagation(),r.target.id===this._id+"_tablename")if(r.keyCode===13)f=this.getActiveCell(),k=this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"tableName")||"",tmgr=this.getSheet(this.getActiveSheetIndex())._tableManager,e=this._getTableID(k),s=tmgr[e].name,d=this._getDollarAlphaRange(tmgr[e].range,!0),this.XLRibbon.removeNamedRange(s),tmgr[e].name=document.getElementById(this._id+"_tablename").value,this.XLRibbon.addNamedRange(tmgr[e].name,d,null,o),w.showTab(this._getLocStr("Design"));else return;if(this.model.allowFiltering&&this.XLFilter._isSearchEdit&&r.keyCode!==27||(n(r.target).parents(".e-formulabar").length&&this.XLEdit._isEdit&&this.model.allowKeyboardNavigation&&(this.XLCellNav._isNavigate=r.keyCode===13),this._isSheetRename||this.XLEdit._isEdit||this.XLComment&&this.XLComment._isCommentEdit||!this.model.allowClipboard||this.XLClipboard._copyPasteHandler(r),v||this._isSheetRename||((this.XLComment&&this.XLComment._isCommentEdit)?this.model.allowKeyboardNavigation&&(this.XLCellNav._isNavigate=!1):this.model.allowEditing&&(document.activeElement.id.indexOf("_inputbox")===-1||r.keyCode===27)&&this.XLEdit._editingHandler(r)),this.model.allowSearching&&this.XLSearch._fRKeyDownHandler(r),this._isFormulaSuggestion&&(r.keyCode===39||r.keyCode===37||r.keyCode===13&&!r.altKey)?this.XLEdit.saveCell():this.XLEdit._isFormulaEdit||r.keyCode!==9&&(r.keyCode!==13||r.altKey)&&r.keyCode!==37&&r.keyCode!==38&&r.keyCode!==39&&r.keyCode!==40||(b=this.XLEdit._isEdit&&this.model.allowKeyboardNavigation&&this.XLCellNav._isNavigate?this.XLEdit.saveCell():!0),n(r.target).hasClass("e-field-validation-error")||r.target.id==this._id+"_Ribbon_font-family_wrapper"||r.target.id==this._id+"_Ribbon_cellformat_wrapper"||r.target.id==this._id+"_Ribbon_fontsize_wrapper"))return!0;if(!b&&!this.XLEdit._isFormulaEdit||r.keyCode===13&&r.altKey)return!1;!this.model.allowKeyboardNavigation||v||this._isSheetRename||(this.model.allowComments&&this.XLComment._isCommentEdit||n(r.target).parents(".e-formulabar").length&&r.keyCode!==9&&(r.keyCode!==13||r.altKey)||this.XLCellNav._selectionKeyDownHandler(r),this._keyboardShortCuts(r));this.model.allowUndoRedo&&(this.model.allowComments&&!this.XLComment._isCommentEdit?this._undoRedoOperation(r):this.model.allowComments||this._undoRedoOperation(r));this.XLEdit._isFormulaEdit&&r.keyCode===9&&!this.XLCellNav._canKeyBoardNavigate&&(this.XLCellNav._canKeyBoardNavigate=!0)}r.target.tagName!=="DIV"||this.XLEdit._isEdit||t.isNullOrUndefined(this._ddlCell)||(this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup"),this.element.find("#"+this._id+"ddlspan").remove(),this._ddlCell=null);f=this.getSheet(o)._activeCell;s=this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"tableName",o);s?(e=this._getTableID(s),this.isNumber(e)&&this.XLRibbon._designTabUpdate(e,f)):this.model.showRibbon&&(w.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||w.isVisible(this._getLocStr("Design")))&&this.XLRibbon._toggleDesignTab(f);this.XLEdit._isEdit||t.isNullOrUndefined(this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"rule",o))||this._setddlCell(r);this._isSheetRename&&(r.keyCode===13||r.keyCode===9||r.keyCode===27)&&(r.preventDefault(),this._updateSheetNames(null,r.keyCode===27)&&this.setSheetFocus());u.suggestionList.is(":visible")&&(this.XLEdit._editElem.text()===""||r.keyCode===13)&&u.suggestionList.hide()},_keyUpHandler:function(n){this.model.allowEditing&&this.XLEdit._isEdit&&this.element.find("#"+this._id+"_Edit").text().indexOf("=")>-1&&n.keyCode!==40&&n.keyCode!==38&&this.XLEdit._captureEditing(n)},_recorddblClickHandler:function(t){if(!(t.target.id.indexOf("chart")>-1)&&!this._hasClass(t.target,"e-comment-txtarea")&&!this._hasClass(t.target,"e-filterspan")){var i,u,r,f=this.getActiveSheetIndex(),e=this.getSheet(f);if(t.target=this._changeTargetWithOffset(t),this.model.allowEditing&&this.model.allowSelection){if(this.XLSelection._isOutsideBordering||this.XLSelection._isGridBordering){i=this._getContent(f).find("div:first-child");i.addClass("e-ss-cursor");i.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor");this.XLSelection.selectRange(e._startCell,e._endCell);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this.XLSelection._isOutsideBordering=this.XLSelection._isGridBordering=!1;return}if(!this.XLEdit._isEdit&&(n(t.target).hasClass("e-rowcell")||n(t.target).parents("td").hasClass("e-rowcell"))&&!this._hasClass(n(t.target),"e-readonly")&&!n(t.target).hasClass("e-cellreadonly")){if(n(".e-cdata").length&&n(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),u=n(t.target),u.closest("#"+this._id+"EditForm").length)return;r=t.target.id.length<1?this._getCellIdx(t.target):this._getCellIdx(n(t.target).parents("td")[0]);this.XLEdit.editCell(r.rowIndex,r.colIndex,!0);this.model.allowKeyboardNavigation&&(this.XLCellNav._isNavigate=!1)}this.model.allowResizing&&(n(t.target).hasClass("e-headercell")||n(t.target).hasClass("e-headercelldiv"))&&this.XLResize._resizeToFitWidth(t);n(t.target).is("span")&&this.model.allowResizing&&this._hasClass(n(t.target.parentNode)[0],"e-ss-rowresize")?this.XLResize._resizeToFitHeight(t.target.parentNode):this.model.allowResizing&&n(t.target).hasClass("e-ss-rowresize")&&this.XLResize._resizeToFitHeight(t)}}},_keyboardShortCuts:function(i){var a,y,c,v,p,l;if(this.XLEdit._isEdit)return!1;var h,o,s,e=this.XLFormat,w=this.getActiveSheetIndex(),f=this.getSheet(w),u=f._selectedCells,r=!1;if(this.model.allowLockCell&&f._isSheetProtected&&(r=!0),i.ctrlKey){switch(i.keyCode){case 65:i.preventDefault();this.model.allowSelection&&(h=this.getActiveCellElem(),this.selectAll(),t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(n(h[0]).closest("tr").index(),h[0].cellIndex),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement());break;case 66:i.preventDefault();r||this._toggleFontPrpty("bold");break;case 68:case 82:i.preventDefault();this.model.allowAutoFill&&this.XLDragFill._fillRange(i.keyCode===68);break;case 73:i.preventDefault();r||this._toggleFontPrpty("italic");break;case 75:i.preventDefault();this.model.allowHyperlink&&!r&&this._hlDlgOpen();break;case 85:i.preventDefault();r||this._toggleFontPrpty("underline");break;case 80:i.preventDefault();this.XLPrint.printSheet();break;case 79:i.preventDefault();this.model.allowImport&&(this._isSheetsDirty()?this._showAlertDlg("","ImportAlert","Open",470,135):n("#"+this._id+"_file .e-uploadinput").click());break;case 83:i.preventDefault();this.XLExport["export"]("Excel");break;case 32:if(i.preventDefault(),!this.model.allowSelection)return;a=u[0].colIndex;y=u[u.length-1].colIndex;o={rowIndex:0,colIndex:a};s={rowIndex:f.rowCount-1,colIndex:y};this.model.allowSelection&&this.XLSelection.selectRange(o,s);f._startCell=o;f._endCell=s;t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(u[0].rowIndex,a);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();break;case 49:i.preventDefault();this.XLCellFrmtDlg._initFormatCellDlg();break;case 53:i.preventDefault();r||this._toggleFontPrpty("line-through");break;case 56:i.shiftKey||r||(i.preventDefault(),this.hideColumn(f._startCell.colIndex,f._endCell.colIndex));break;case 57:i.shiftKey||(i.preventDefault(),r||this.hideRow(f._startCell.rowIndex,f._endCell.rowIndex));break;case 220:i.shiftKey||(i.preventDefault(),this.model.allowSearching&&this.XLSearch._applyGotoRowDiff());break;case 90:i.preventDefault();break;case 89:i.preventDefault();break;case 114:i.preventDefault();this.model.showRibbon&&!r&&this.XLRibbon._openNameManagerDlg()}if(i.shiftKey)switch(i.keyCode){case 192:i.preventDefault();r||e.format({type:"general"});break;case 52:i.preventDefault();r||e.format({type:"currency"});break;case 53:i.preventDefault();r||e.format({type:"percentage"});break;case 54:i.preventDefault();r||e.format({type:"scientific"});break;case 51:i.preventDefault();r||e.format({type:"shortdate"});break;case 50:i.preventDefault();r||e.format({type:"time"});break;case 49:i.preventDefault();r||e.format({type:"number"});break;case 55:i.preventDefault();this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder&&!r&&this.XLFormat.applyBorder({top:"1px solid #000000",right:"1px solid #000000",bottom:"1px solid #000000",left:"1px solid #000000"});break;case 173:i.preventDefault();this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder&&!r&&this.XLFormat.applyBorder("noborder");break;case 73:i.preventDefault();this.model.allowInsert&&!r&&this._renderInsertDialog();break;case 68:i.preventDefault();this.model.allowDelete&&!r&&this._renderDeleteDialog();break;case 113:i.preventDefault();c=n("#"+this._id+"_Ribbon").data("ejRibbon");this.model.showRibbon&&(c.element.find(".e-rarrowup-2x").length?c.collapse():c.expand());break;case 56:i.preventDefault();r||this.showColumn(u[0].colIndex,u[u.length-1].colIndex);break;case 57:i.preventDefault();r||this.showRow(u[0].rowIndex,u[u.length-1].rowIndex);break;case 79:i.preventDefault();this.XLSearch._applyGotoComments();break;case 220:i.preventDefault();this.XLSearch._applyGotoColDiff()}}else if(i.shiftKey)i.keyCode===32?(i.preventDefault(),this.model.allowSelection&&(v=u[0].rowIndex,p=u[u.length-1].rowIndex,o={rowIndex:v,colIndex:0},s={rowIndex:p,colIndex:f.colCount-1},this.XLSelection.selectRange(o,s),f._startCell=o,f._endCell=s,t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(v,u[0].colIndex),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())):i.keyCode===113?(i.preventDefault(),h=this.getActiveCellElem(),r||(h.hasClass("e-commentcell")?this.XLComment.editComment():this.XLComment.setComment())):i.keyCode===122&&(i.preventDefault(),this.addNewSheet());else if(i.keyCode===27){if(this.model.allowComments&&this.XLComment._isCommentEdit&&(this.XLComment._updateCurCmntVal(),this.XLComment._updateCmntRibIcons()),this.model.allowContextMenu&&(this.XLCMenu._isMenuOpened||n("#"+this._id+"_contextMenuColumnHeader").is(":visible")||n("#"+this._id+"_contextMenuRowHeader").is(":visible"))&&this.XLCMenu.hideCMenu(),this.model.allowFiltering&&this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")){if(l=this._excelFilter._menuWrap.data("ejMenu"),l.element.find(".e-mhover li:visible").length){l._isContextMenuOpen||l._closeMenu();return}this.XLFilter._isSearchEdit=!1;this._excelFilter.closeXFDialog()}this.setSheetFocus()}else i.altKey&&(i.keyCode===112&&this.model.showRibbon&&this.model.allowCharts&&!r?(i.preventDefault(),this.XLChart.createChart(null,{type:"column",enable3D:!1,marker:{visible:!1}})):i.keyCode!==84||!this.model.showRibbon||this.XLRibbon._isDirtySelect||r||(i.preventDefault(),this.XLRibbon._openFATDlg()))},_triggerTBtnClick:function(t){var i=n("#"+t).data("ejToggleButton");i.buttontag.click()},_toggleFontPrpty:function(n){var u=this.getActiveCell(),f=this.XLFormat,t={style:{}},r,i,e;r=this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"format");e=!this.isUndefined(r)&&this.XLFormat.getFormatFromHashCode(r);i=n==="bold"?"font-weight":n==="italic"?"font-style":"text-decoration";e[i]===n?(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_"+n).ejToggleButton("option","toggleState",!1),t.style[i]="none",f.format(t)):(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_"+n).ejToggleButton("option","toggleState",!0),t.style[i]=n,f.format(t))},_getLocStr:function(n){return this.localizedLabels[n]},_checkIndicesInContainer:function(n,t,i,r){var u=this._dataContainer.sheets;return n in u&&t in u[n]&&i in u[n][t]?r?r in u[n][t][i]?!0:!1:!0:!1},_textFormatting:function(t){switch(t){case"wrapText":var i=n("#"+this._id+"_Ribbon_wraptext").data("ejToggleButton");this.setWrapText(i.model.toggleState?"wrap":"unwrap",null)}},wrapText:function(n){this.setWrapText("wrap",n)},unWrapText:function(n){this.setWrapText("unwrap",n)},setWrapText:function(n,i){var r,h,e,o=this.getActiveSheetIndex(),p,s=this.getSheet(o),f=0,l,tt=this.getRows(o)[1],d=this.getRows(o)[0],w,a,v=s.rowsHeightCollection,it=s.columnsWidthCollection,c=0,y=s._wrapHtCollection,b=!1,k,rt=this.model.scrollSettings.allowVirtualScrolling,ut=s._clrWrapColl,u,g,nt;if(t.isNullOrUndefined(i)?(r=s._selectedCells,h=s.selectedRange):(h=typeof i=="string"?this.getRangeIndices(i):i,r=this.XLSelection._getSelectedRange({rowIndex:h[0],colIndex:h[1]},{rowIndex:h[2],colIndex:h[3]})),r.length>1)w=this._getProperAlphaRange(o,r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex);else if(r.length>0)w=this._getAlphaRange(o,r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex);else return;for(u=0,g=r.length;u<g;u++){if(k=rt?this._getRowIdx(r[u].rowIndex):r[u].rowIndex,b=this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"wrap"),(n==="unwrap"&&!b||n==="wrap"&&b)&&!this._isPaste)return;if(n==="unwrap")this._isUndoRedo||ut.push({rowIdx:r[u].rowIndex,colIdx:r[u].colIndex}),this._isRowViewable(o,r[u].rowIndex)&&(e=this.getCell(r[u].rowIndex,r[u].colIndex),this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"merge")&&(p=e.find("#"+this._id+"_MergeWrap"),e[0].innerHTML=p[0].innerHTML,p.remove()),this._removeClass(e,"e-sswraptext"),this._removeClass(d[r[u].rowIndex],"e-sswraprow"),f=y[r[u].rowIndex],e.find(".e-filterspan").length>0&&(l=e.find(".e-filterspan"),this.model.allowFiltering&&this.XLFilter._postionFilterIcon(e,l))),this.XLEdit._clearDataContainer({cellIdx:r[u],property:["wrap"]}),this.XLEdit._clearDataContainer({cellIdx:{rowIndex:r[u].rowIndex,colIndex:0},property:["wrapRow"]}),this.XLEdit._clearDataContainer({cellIdx:{rowIndex:0,colIndex:r[u].colIndex},property:["wrapCol","wrapWidth"]}),this._textClip(r[u].rowIndex,r[u].colIndex,"add");else{if(this._textClip(r[u].rowIndex,r[u].colIndex,"delete"),this.XLEdit._updateDataContainer({rowIndex:r[u].rowIndex,colIndex:r[u].colIndex},{dataObj:{wrap:!0}}),this._isRowViewable(o,r[u].rowIndex)){if(e=this.getCell(r[u].rowIndex,r[u].colIndex),e.is(":visible")){if(this.addClass(e[0],"e-sswraptext"),e[0].rowSpan>1)for(a=r[u].rowIndex;a<r[u].rowIndex+e[0].rowSpan;a++)c=c+v[a];e.find(".e-filterspan").length>0&&(l=e.find(".e-filterspan"),this.model.allowFiltering&&this.XLFilter._postionFilterIcon(e,l));f=e[0].offsetHeight;f<=c&&(f=c-f)}}else f=this._detailsFromGlobalSpan(r[u].rowIndex,r[u].colIndex,"height",this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"value"),it[r[u].colIndex]);y[r[u].rowIndex]=u>0&&r[u].rowIndex===r[u-1].rowIndex?y[r[u-1].rowIndex]:y[r[u].rowIndex]=v[r[u].rowIndex];t.isNullOrUndefined(this.XLEdit.getPropertyValue(r[u].rowIndex,0,"wrapRow"))&&this.XLEdit._updateDataContainer({rowIndex:r[u].rowIndex,colIndex:0},{dataObj:{wrapRow:!0}});t.isNullOrUndefined(this.XLEdit.getPropertyValue(r[u].rowIndex,0,"wrapCol"))&&this.XLEdit._updateDataContainer({rowIndex:0,colIndex:r[u].colIndex},{dataObj:{wrapCol:!0,wrapWidth:this.getSheet(o).columnsWidthCollection[r[u].colIndex]}})}f>0&&(r[u].colIndex===h[3]&&(this._isRowViewable(o,r[u].rowIndex)&&(d[k].style.height=f+"px",tt[k].style.height=f+"px",this.getFrozenRows(o)>=r[u].rowIndex&&(c>=f?(f=c-f,this._refreshFreezeRows(o,r[u].rowIndex,f,"delete")):(f=f-c,this._refreshFreezeRows(o,r[u].rowIndex,f,"insert")))),v[r[u].rowIndex]=f),this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"merge")||(v[r[u].rowIndex]=f));f=0}this.model.allowComments&&this.XLComment._updateCmntArrowPos();(!s._isImported||s._isLoaded)&&(nt={sheetIndex:o,selectedCells:r,reqType:"textwrap",operation:n,range:w},this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(o,"refresh","all"),this.XLSelection._refreshBorder(),this._isUndoRedo||this._dupDetails||this._completeAction(nt));this.model.scrollSettings.allowScrolling&&this.XLScroll._getRowHeights(o,r[0].rowIndex+1)},_setWrapHeight:function(t,i,r,u,f,e){var h=r[i],s=this.getSheet(t),v=s.hideRowsCollection,c=!1,l=s.rowsHeightCollection,a,o;c=i in v;l[i]>0?o=l[i]:c&&e!=="visible"||(a=n(r[i].outerHTML).attr("id","ss"),f[0].insertBefore(a[0],f[0].childNodes[0]),o=f[0].rows[0].getBoundingClientRect().height,f[0].rows[0].parentNode.removeChild(f[0].rows[0]));o=o<20?20:o;parseInt(h.style.height)<o&&(h.style.height=o+"px",n(u[i])[0].style.height=o+"px",s.rowsHeightCollection[i]=o)},_setRowHdrHeight:function(n,t){var r=this._getRowIdx(t),i=this.getSheet(n),u=this.getRows(n),f=i.rowsHeightCollection[t];this._isRowViewable(n,t)&&(u[0][r].style.height=f+"px");this.model.allowSelection&&this.XLSelection.refreshSelection();(!i._isImported||i._isLoaded)&&this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_refreshRangeTRHght:function(n,t){for(var r=t[0]<1?t[0]:t[0]-1,u=this.getSheet(n),i=r;i<=t[2];i++)this._setRowHdrHeight(n,i);this.XLScroll._getRowHeights(n,r);(!u._isImported||u._isLoaded)&&this.XLSelection._refreshBorder()},_renderAlertdlg:function(){var i=this._id+"_alertdlg";if(!n(i).length){var r=t.buildTag("div#"+i+".e-alertdlg","",{display:"none"}),s=t.buildTag("div#"+i+"_dlgcontent .e-alertdlgcontent"),u=t.buildTag("div#"+i+"_dlgbtncontent .e-dlg-btnfields"),h=t.buildTag("div#"+i+"_condiv .e-dlg-btnctnr"),c=t.buildTag("div#"+i+"_alertdiv .e-dlg-btnctnr");r.append(s);var f=t.buildTag("input#"+this._id+"_dialog_Ok"),e=t.buildTag("input#"+this._id+"_dialog_Can","",{"margin-left":10}),o=t.buildTag("input#"+this._id+"_dialog_alertOk");f.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertOkClick,this),enabled:!0});e.ejButton({text:this._getLocStr("Cancel"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertCanClick,this)});o.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertOkClick,this),enabled:!0});u.append(h.append(f,e));u.append(c.append(o));r.append(u);this.element.append(r)}},alert:function(t){var i=n("#Spreadsheet").data("ejSpreadsheet"),r=n("#"+i._id+"_alertdlg");i._renderAlertDlgContent(r,"Alert",t);r.ejDialog("open")},_renderAlertDlgContent:function(n,i,r,u,f,e){var o=n.find("#"+this._id+"_alertdlg_dlgcontent"),s=n.find("#"+this._id+"_alertdlg_condiv"),h=n.find("#"+this._id+"_alertdlg_alertdiv");f=f||400;e=e||"";i==="Alert"?(s.hide(),h.show()):(s.show(),h.hide());o.text("");o.html(r);n.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("Title"),width:f,height:"auto",minHeight:0,cssClass:"e-ss-dialog e-"+this._id+"-dlg"+e,open:t.proxy(this._alertDlgOpen)});this._alertDialog={element:n,action:u}},_alertDlgOpen:function(){this.element.find("input:visible:first").focus()},_alertOkClick:function(){var u,i=1,r=this.getActiveSheetIndex(),f,e,o,t;this._alertDialog.element.ejDialog("close");switch(this._alertDialog.action){case"findPrevComment":this.gotoPage(this.model.sheetCount,!1);u=this.model.sheets[this.model.sheetCount];this.XLComment._updateCurrentCell(u.rowCount-1,u.colCount-1);this.XLComment.findPrevComment();this._alertDialog.action=null;break;case"findNextComment":this.gotoPage(1,!1);this.XLComment._updateCurrentCell(0,0);this.XLComment.findNextComment();this._alertDialog.action=null;break;case"sheetRenameActn":n("#"+this._id+"_Sheet_RenamePanel").select().focus();break;case"sheetDeleteActn":this._removeSheet(r);this._alertDialog.action=null;break;case"New":this._isNew=!0;this._destroy();this._dataContainer.sheets[i]={};this.clearUndoRedo();this._updateCellType();this.model.sheetCount=i;this.model.activeSheetIndex=i;this._sheetSettings(i);this._newSIndex++;this._initCSSTag();this.gotoPage(i,!1);this.model.allowLockCell&&this.protectSheet(!1);f=n("#"+this._id+"_Ribbon_protectWorkbook").data("ejToggleButton");f&&(f.option("toggleState",!1),this.model.exportSettings.password=null,n("#"+this._id+"_AddSheet").removeClass("e-disable"));this.XLRibbon._toggleFormatTab();this.XLRibbon._toggleChartDesignTab();this._refreshSpreadSheetPager();this._isNew=!1;break;case"Open":n("#"+this._id+"_file .e-uploadinput").click();break;case"MissingParenthesis":this.XLEdit._focusElements(this.getActiveCellElem(r));break;case"MergeCells":this._mergeCells(r,this.model.sheets[r]._selectedCells,{},[]);this._alertDialog.action=null;break;case"MergeAcrossCells":this._mergeAcrossCells(r,this.model.sheets[r]._selectedCells);this._alertDialog.action=null;break;case"MergeInsertDelete":for(this._dupDetails=!0,e=this._removeMergeColl,i=0,o=e.length;i<o;i++)this.unmergeCells(e[i].merge.mRange,!0);this._dupDetails=!1;t=this._insData;switch(t.value.status){case"shiftRight":this._insertShiftRight(t.sheetIdx,t.startCell,t.endCell,t.value);break;case"shiftBottom":this._insertShiftBottom(t.sheetIdx,t.startCell,t.endCell,t.value);break;case"shiftUp":this._deleteShiftUp(t.sheetIdx,t.startCell,t.endCell,t.value);break;case"shiftLeft":this._deleteShiftLeft(t.sheetIdx,t.startCell,t.endCell,t.value)}this._alertDialog.action=null;break;case"CtrlKeyErrorAction":this.setSheetFocus();break;case"InvalidChartTitleActn":n("#"+this._id+"_chartnamedlg").find("input:first").focus()}},_alertCanClick:function(){(this._alertDialog.action=="findNextComment"||this._alertDialog.action=="findPrevComment")&&n(this.getActiveCellElem()).find(".e-comment-txtarea").css("display","inline-table");this._alertDialog.element.ejDialog("close");this.hideWaitingPopUp()},_showAlertDlg:function(t,i,r,u,f){var e=n("#"+this._id+"_alertdlg"),o="Alert",s=i.indexOf("T-")===0?i.slice(2):this._getLocStr(i);t===o?this._renderAlertDlgContent(e,o,s,r,u,f):this._renderAlertDlgContent(e,"",s,r,u,f);e.ejDialog("open")},_isSheetsDirty:function(){var n=1,t=this._dataContainer.sheets,i=this.getObjectLength(t)+1;if(this.model.nameManager.length||this.getObjectLength(t)>1)return!0;while(n<i){if(this.getObjectLength(t[n]))return!0;n++}return!1},getCell:function(t,i,r){var u=0,r=this._getSheetIndex(r),f=this.getSheet(r);return this.model.scrollSettings.allowVirtualScrolling&&(u=1,t=this._getRowIdx(t),t===-1)?null:(this.isImport||f._isImported||this._isPrint)&&this._detachTable?n(this._detachTable[0].tBodies[u].rows[t].cells[i]):this._getContTBody(r)?n(this._getContTBody(r)[0].rows[t].cells[i]):null},getRange:function(i,r,u){i=this._toIntrnlRange(i,r);var c=i[0],s=i[1],h=i[2],e=i[3],f,v,o,y,l,w,a,p=[],r=this._getSheetIndex(r),b=this.getSheet(r);if(o=(this.isImport||b._isImported)&&this._detachTable?n(this._detachTable[0].tBodies[1].rows):n(this._getContTBody(r)[0].rows),c>h&&(l=c,c=h,h=l),s>e&&(l=s,s=e,e=l),this.model.scrollSettings.allowVirtualScrolling)for(f=c;f<=h;f++)v=this._getRowIdx(f),v>-1&&(y=n(o[v].cells),a=e===s?y.eq(e):y.slice(s,e+1),t.merge(p,a));else for(o=h!==c?o.slice(c,h+1):o.eq(h),w=o.length,f=0;f<w;f++)u&&this._isHiddenRow(f,r)||(a=e!==s?n(o[f].cells).slice(s,e+1):n(o[f].cells).eq(e),t.merge(p,a));return n(p)},getRangeIndices:function(n){n=n.indexOf(":")===-1?n+":"+n:n;var r=n.split(":"),t,i=[];return t=r[0].split(/[A-Z]/i),i.push(parseInt(t[t.length-1])-1),i.push(this._generateColCount(r[0].split(/[0-9]/)[0].toUpperCase())-1),t=r[1].split(/[A-Z]/i),i.push(parseInt(t[t.length-1])-1),i.push(this._generateColCount(r[1].split(/[0-9]/)[0].toUpperCase())-1),this.swapRange(i),i},swapRange:function(n){return n[0]>n[2]&&t.dataUtil.swap(n,0,2),n[1]>n[3]&&t.dataUtil.swap(n,1,3),n},updateRange:function(n,t){var u,o,y,s,h,c,l,f,a,i=[],v=[],e=t.dataSource,p=e.length,w=this.getObjectLength(e[0]);if(l=t.startCell,t.range?i=t.range:(c=l.split(/[A-Z]/i),i.push(parseInt(c[c.length-1])-1),i.push(this._generateColCount(l[0].split(/[0-9]/)[0].toUpperCase())-1),i.push(i[0]+p-(t.showHeader?0:1)),i.push(i[1]+w-1)),f=this.XLSelection._getSelectedRange({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]}),h=this._getContent(n),a=h.find(".e-content >table"),this.model.allowAutoCellType&&this.model.allowCellType||a.detach(),t.showHeader)for(s in e[0])v.push(s);for(o=0;o<p;o++)if(e[o]!=r)for(s in e[0])v.push(e[o][s]);for(u=0,y=f.length;u<y;u++)this.XLEdit.updateCell(f[u],v[u],n),t.showHeader&&u<w&&(i=t.startCell+":"+(this._generateHeaderText(n,f[f.length-1].colIndex+1)+(f[0].rowIndex+1)),t.headerStyles&&this.XLFormat.format({style:t.headerStyles},i));this.model.allowAutoCellType&&this.model.allowCellType||h.find(".e-content").append(a)},editRange:function(t,i){var o,s,v,u,l,r,a,f=this.getActiveSheetIndex(),e=this.getSheet(f).rangeSettings[t],h=this.getRangeIndices(e.range),c=this.getRange(h);for(this._trigger("editRangeBegin",{range:e,sheetIndex:f}),e.cssClass&&c.addClass(e.cssClass),e.readOnly&&c.addClass("e-readonly"),l=this._getContent(f),a=l.find(".e-content >table"),a.detach(),o=0,v=c.length;o<v;o++)u=c[o],$cell=n(u),n.trim(t).length&&this.XLEdit._updateDataContainer({rowIndex:u.parentNode.rowIndex,colIndex:u.cellIndex},{dataObj:{range:t}}),r=i(u,u.cellIndex,o),typeof r=="string"?this.XLEdit.updateCell($cell,r):typeof r=="object"&&(r.Value.indexOf("=")!==0?this.XLEdit.updateCell($cell,r.Value):this.XLEdit.updateCellValue($cell,r.Value),$cell.data("value2",r.Value2),$cell.data("type",r.NumberFormat),r.StyleIndex>1&&$cell.addClass(this._styleColl[r.StyleIndex]));for(l.find(".e-content").append(a),s=h[0];s<h[2]+1;s++)this._setRowHdrHeight(f,s);this._trigger("editRangeComplete",{range:e,sheetIndex:f});this.XLScroll._getRowHeights(f,h[0])},removeRange:function(n){this.clearRange(n);delete this.getSheet(this.getActiveSheetIndex()).rangeSettings[n]},clearRange:function(n){var r,t,i=this.getSheet(this.getActiveSheetIndex()).rangeSettings[n];r=this.getRangeIndices(i.range);t=this.getRange(r);i.cssClass&&t.removeClass(i.cssClass);i.readOnly&&t.removeClass("e-readonly");this.clearRangeData(null,["range","value","type","value2"],t);t.empty()},getObjectLength:function(n){var t,i=0;if(n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{},Object.keys)return Object.keys(n).length;for(t in n)n.hasOwnProperty(t)&&i++;return i},getObjectKeys:function(n){var t,i=[];if(n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{},Object.keys)return Object.keys(n);for(t in n)n.hasOwnProperty(t)&&i.push(t);return i},toArrayLowerCase:function(n){for(var t=0;t<n.length;t++)n[t]=n[t].toString().toLowerCase();return n},_isValueAlreadyExist:function(n,t,i){for(var r=0,u=n.length;r<u;){if(n[r][t]===i)return!0;r++}return!1},addClass:function(n,t){if(this._isObject(n)&&(n=n[0]),n){var i=n.className;i.indexOf(t)===-1&&(n.className=i+" "+t)}},_removeClass:function(n,t){(this._isObject(n)&&(n=n[0]),n)&&(n.className=n.className.replace(new RegExp(t,"g"),"").replace(/ +/g," "))},_hasClass:function(n,t){if(this._isObject(n)&&(n=n[0]),n)return n.className.indexOf(t)>-1},isUndefined:function(n){return n===r},_isString:function(n){return typeof n=="string"},_isObject:function(n){return Object.prototype.toString.call(n)==="[object Object]"},_isBool:function(n){return n=n+"",n=n.toUpperCase(),n==="TRUE"||n==="FALSE"},isRange:function(n){return n[0]!==n[2]||n[1]!==n[3]},_isMultiRange:function(n){return!this._isString(n)&&!this.isNumber(n[0])},inRange:function(n,t,i){return t>=n[0]&&t<=n[2]&&i>=n[1]&&i<=n[3]},_inRow:function(n,t){return t>=n[0]&&t<=n[2]},_inColumn:function(n,t){return t>=n[1]&&t<=n[3]},_isUniqueRange:function(n,t){return n.toString()===t.toString()},hasSpan:function(n){return this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"merge")?!0:!1},_getMergedIdx:function(n,t){var u,f,e,r,o=0,i=this.XLEdit.getPropertyValue(n,t,"merge"),s=this.getActiveSheetIndex();if(i){if(i.mRange&&this.model.scrollSettings.allowVirtualScrolling&&this.getObjectLength(this.getSheet(s).hideRowsCollection)&&(u=this.getRangeIndices(i.mRange),f=u[0],e=u[2],e-f>1))for(r=f+1;r<e;)this.XLEdit.getPropertyValue(r,0,["isRHide"])&&o++,r++;if(i.mSpan)return{rowIndex:n+i.mSpan.rowSpan+o-1,colIndex:t+i.mSpan.colSpan-1}}return{rowIndex:n,colIndex:t}},_getMergeParent:function(n,t){var i=this.XLEdit.getPropertyValue(n,t,"mergeIdx");return i?{rowIndex:i.rowIndex,colIndex:i.colIndex}:{rowIndex:n,colIndex:t}},_getCellInfo:function(n,t){var i=this.getSheet(this._getSheetIndex(t)),r,u;return r=n.rowIndex>=i._frozenRows?i._rowHeightCollection[n.rowIndex]-i._fpHiddenHeight:i._rowHeightCollection[n.rowIndex],u=n.colIndex>=i._frozenColumns?i._colWidthCollection[n.colIndex]-i._fpHiddenWidth:i._colWidthCollection[n.colIndex],{top:r-1,left:u-1,height:i.rowsHeightCollection[n.rowIndex],width:i.columnsWidthCollection[n.colIndex]}},_getRowIdx:function(n){return this.model.scrollSettings.allowVirtualScrolling&&(n=this.getSheet(this.getActiveSheetIndex())._virtualRowIdx.indexOf(n)),n},_arrayAsString:function(n){return n.join(" ").replace(/,/g," ")},_rangeHasData:function(n){var t,i,r;for(n=this.swapRange(n),t=this.XLSelection._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]}),i=t.length;i--;)if(r=t[i],this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex))return!0;return!1},_isTableRange:function(n,t,i){i=this._getSheetIndex(i);var r,u=this.getSheet(i)._tableManager;for(r in u)if(this.inRange(u[r].range,n,t))return!0;return!1},_hasCellStyle:function(n,t,i){for(var r,u=["borders","formats"],f=u.length;f--;)if(r=this.XLEdit.getPropertyValue(n,t,u[f],i),r)return!0;return!1},_isHiddenRow:function(n,t){return this.XLEdit.getPropertyValue(n,0,"isFilterHide",t)||this.XLEdit.getPropertyValue(n,0,"isRHide",t)||!1},_refreshViewVar:function(n,i,r){r=this._getSheetIndex(r);var u=this.getSheet(r);t.isNullOrUndefined(n)||(u._topRow.idx=this.XLShape._getCellIndexFromOffset(n,null,r).rowIndex,u._topRow.value=this._getRowOffsetTop(u,u._topRow.idx),u._bottomRow.idx=u._topRow.idx+(u._virtualBlockRowCnt-this._bufferCnt),u._bottomRow.value=this._getRowOffsetTop(u,u._bottomRow.idx));t.isNullOrUndefined(i)||(u._leftCol.idx=this.XLShape._getCellIndexFromOffset(null,i,r).colIndex,u._leftCol.value=this._getColOffsetLeft(u,u._leftCol.idx))},_getFormatString:function(n,i){var r=t.Spreadsheet.CellFormat[n];return this.isNumber(i)&&!t.isNullOrUndefined(r)&&(r="{0:"+r.substr(3,1)+i+"}"),r||""},_refreshVrtlBlocks:function(n){for(var r,i=idx=0,u=["_virtualTopTBodyOffset","_virtualContTBodyOffset","_virtualBottomTBodyOffset"],n=this._getSheetIndex(n),t=this.getSheet(n);i<3;)(i||t._isVirtualTopReached)&&i!==1&&(i!==2||t._isVirtualEndReached)||(r=t._virtualRowIdx[idx],t[u[i]].top=this._getRowOffsetTop(t,r),idx+=t._virtualBlockRowCnt,r=t._virtualRowIdx[idx-1],t[u[i]].bottom=this._getRowOffsetBottom(r,n)),i++;t._virtualTBodyHgt=t._rowHeightCollection[t._rowHeightCollection.length-1]+t.rowsHeightCollection[t.rowsHeightCollection.length-1]},getRangeDataAsObject:function(n,i,r){var f,s,e,h,c,w=t.Spreadsheet.CellType,o=this._dataContainer,l=o.sheets[this.getActiveSheetIndex()],u,a,v,y,b=[],k=[],p=[];for(n.rowIndex>i.rowIndex?(u=i.rowIndex,a=n.rowIndex):(u=n.rowIndex,a=i.rowIndex),n.colIndex>i.colIndex?(v=i.colIndex,y=n.colIndex):(v=n.colIndex,y=i.colIndex);u<=a;){if(!r||!this._isHiddenRow(u)){for(h={},c={},f=v;f<=y;f++)s=this.getSheet(this.getActiveSheetIndex()).columns[f].field,u in l&&f in l[u]&&(e=l[u][f],h[s]=o.sharedData[e.value],c[s]=[w.General,w.Text].indexOf(o.cellType[e.type])===-1?e.value2:o.sharedData[e.value2]);b.push(h);k.push(c)}u++}return p.push(b),p.push(k),p},_getColorFromFormat:function(n){var r=[],i,u,f;return t.isNullOrUndefined(n)||(i=n.replace("e-format","").toLowerCase(),u=i.startsWith("6n")?"#"+i.substr(2,6):"#"+i.substr(6,6),f="#"+i.substr(0,6),r.push(f),r.push(u)),r},getRangeData:function(n,i,r,u,f,e,o,s,h,c){u=u?u:this.getActiveSheetIndex();r=r?r:["value","value2","type","formatStr","decimalPlaces","thousandSeparator","range","format","border","comment","hyperlink","picture","cFormatRule","rule","chart","isLocked","wrap","formats","cellType"];var d,b,it,a,g,v,l,k,w,nt,rt=[],y=[],ut="value",tt=!1,ft=this.getSheet(u),et=this._dataContainer,p=et.sheets[u],ot=et.sharedData;for(n=this._toIntrnlRange(n,u),n=n?this.swapRange(n):ft.selectedRange,this.model.scrollSettings.allowVirtualScrolling&&o&&!t.isNullOrUndefined(s)?(tt=!0,l=s,k=l+(h-1),w=ft.colCount-1):(l=n[0],k=n[2],w=n[3]);l<=k;){if(nt=this._isHiddenRow(l,u),tt&&nt)k++;else if(!o||!nt){if(a=tt?0:n[1],l in p)if(i)while(a<=w)v="",a in p[l]&&ut in p[l][a]&&(v=ot[p[l][a][ut]],f&&this._isDateTime(v)?v=this.XLEdit.getPropertyValue(l,a,"value2",u):e&&this.isFormula(v)&&(v=this.XLEdit.getPropertyValue(l,a,"calcValue",u))),y.push(v),a++;else while(a<=w){if(a in p[l]){for(d=r.length,g={},it=p[l][a];d--;)b=r[d],this.isUndefined(it[b])||(g[b]=this.XLEdit.getPropertyValue(l,a,b,u));y.push(g)}else y.push({});a++}else while(a<=w)i?y.push(""):y.push({}),a++;rt.push(l)}l++}return c?{rowIdx:rt,data:y}:y},_processBindings:function(n){if(this.model.query=new t.Query,this._trigger("actionBegin",n))return!0;this._ensureDataSource(n);n.action==="sorting"?(this.XLSort._sortComplete(n),this._isUndoRedo||this._completeAction(n)):this._completeAction(n)},_ensureDataSource:function(n){var a=this.getActiveSheetIndex(),v=this.getSheet(a),i,u=this.model.query,f,s,h,e,c,o,y,p,l;if(n.action==="filtering"||n.action==="clearfiltering"||n.requestType==="filterbycell"){for(i=v.filterSettings.filteredRange==null?this._dataSource(a):v.filterSettings.filteredRange,c=v.filterSettings.tableRange,o=0,y=c.length;o<y;o++)if(c[o].tableID===n.tableID){c[o].filteredRange=i;break}if(this._dataManager=t.DataManager(i),i instanceof t.DataManager||(this.model.currentViewData=i),this.model.query.requiresCount(),u=this.model.query,n.filteredcolumns.length){s=this._excelFilter._predicates[a];p=i[0];for(l in s)p.hasOwnProperty(l)&&(h=s[l]),h=s[l],f=f!=r?f.and(h):h;t.isNullOrUndefined(f)||u.where(f);i instanceof t.DataManager||(e=this._dataManager.executeLocal(u),this._filteredRecordsCount=e.count,this.model.currentViewData=e.result)}}else n.requestType==="sorting"&&(this._dataManager=t.DataManager(n.rangeData),n.rangeData instanceof t.DataManager||(this.model.currentViewData=n.rangeData),u.sortBy(n.columnName,n.sortDirection),n.rangeData instanceof t.DataManager||(e=this._dataManager.executeLocal(u),this.model.currentViewData=e))},_toArrayData:function(n){for(var u,t,i=0,r=[],f=n.length;i<f;){if(t=n[i],this.getObjectLength(t))for(u in t)r.push(t[u]);else r.push("");i++}return r},updateRangeData:function(n,t,i){for(var u=this.XLSelection._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]}),r=0;r<u.length;r++)this.model.allowCellFormatting&&this.XLFormat._hasFormat(t[r].format)&&(this.XLFormat._updateFormatClass(u[r],t[r].format),this.XLEdit._updateDataContainer(u[r],{dataObj:{formats:t[r].formats},sheetIdx:this.getActiveSheetIndex(),status:i}))},updateData:function(i,r,u){var y=this.getActiveSheetIndex(),c,f,l,s,h,a,e,o,v;if(r=r?this.swapRange(r):this.getSheet(y).selectedRange,formatObj={},a=n.makeArray(this.getRange(r)).reverse(),i.length===a.length)for(f=i.length,i=i.reverse();f--;)c=a[f],v=this._getCellIdx(c),e=v.rowIndex,o=v.colIndex,this.XLEdit._updateDataContainer({rowIndex:e,colIndex:o},{dataObj:i[f]}),"hyperlink"in i[f]&&(s=i[f].hyperlink,h=n(c),this.isUndefined(s)||(t.isNullOrUndefined(u)||u!=="clear-format"?s.webAddr?h.html(t.buildTag("a",i[f].value2,"",{href:s.webAddr,target:"_blank","class":"e-hyperlinks"})):h.html(t.buildTag("a",i[f].value2,"",{href:"#","class":"e-hyperlinks"})):h.find("a").css({color:"#428bca","text-decoration":"underline"}).addClass("e-hyperlinks"))),t.isNullOrUndefined(u)||u!=="clear-format"||(t.isNullOrUndefined(i[f].formatStr)||(formatObj.formatStr=i[f].formatStr),t.isNullOrUndefined(i[f].type)||(formatObj.type=i[f].type),t.isNullOrUndefined(i[f].decimalPlaces)||(formatObj.decimalPlaces=i[f].decimalPlaces),t.isNullOrUndefined(i[f].thousandSeperator)||(formatObj.thousandSeperator=i[f].thousandSeperator),this.XLFormat.format(formatObj,this._getAlphaRange(y,e,o,e,o))),"comment"in i[f]&&!this.XLEdit.getPropertyValue(e,o,"comment")&&this.model.allowComments&&this.XLComment._updateCmntFrmCntnr(e,o),"value"in i[f]&&(l=i[f].value,this.XLEdit._refreshCalcEngine(e,o,this.isFormula(l),l))},updateUniqueData:function(n,t,i){t=t?this.swapRange(t):this.getSheet(this.getActiveSheetIndex()).selectedRange;var r,f={dataObj:n},u=t[0],e=t[2],o=t[3];for(i&&(f.skipCell=i);u<=e;){for(r=t[1];r<=o;)this.XLEdit._updateDataContainer({rowIndex:u,colIndex:r},f),r++;u++}},clearRangeData:function(n,t,i,r,u,f){var e,o,s,h,c=this.getActiveSheetIndex();for(n=this._toIntrnlRange(n,c),t=t?t:["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink"],e=n[0],s=n[2],h=n[3];e<=s;){if(!r||!this._isHiddenRow(e))for(o=n[1];o<=h;)this.XLEdit._clearDataContainer({cellIdx:{rowIndex:e,colIndex:o},property:t,status:u,skipCell:f}),o++;t.indexOf("wrap")>-1&&this._setRowHdrHeight(c,e);e++}},_getArrayRangeCells:function(n){return n?(n=this.swapRange(n),this.getRange(n)):this._getContent(this.getActiveSheetIndex()).find(".e-selected")},_getAlphaRangeCells:function(n){return n?(n=this.getRangeIndices(n),this.getRange(n)):this._getContent(this.getActiveSheetIndex()).find(".e-selected")},_getMultiRangeCells:function(n){var i,t,u,r,f;if(n){if(i=0,u=[],r=[],this._isString(n))r.push(this.getRangeIndices(n));else if(this.isNumber(n[0]))r.push(n);else for(f=n.length;i<f;)t=n[i],r.push(Array.isArray(t)?t:this.getRangeIndices(t)),i++;for(i=0,f=r.length;i<f;)t=r[i],u=u.concat(this.XLSelection._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]})),i++}else u=this.getSheet(this.getActiveSheetIndex())._selectedCells;return u},_completeAction:function(n){var u=this.getActiveSheetIndex(),h=this.getSheet(u),r,o,a,v,s,c,l,i,f,e,y;if(n.reqType==="filter")if(n.operation!=="apply-filter"&&n.operation!=="remove-filter")for(o=n.model.currentViewData,r={sheetIndex:u,range:h._selectedRange,currentViewData:o,fieldName:n.currentFilteringColumn,ejpredicate:n.ejpredicate,activeCell:n.activeCell,filteredValue:n.filteredValue,filterCollection:n.filteredcolumns,requestType:n.requestType,reqType:n.reqType,selCells:n.selCells,action:n.action,operation:"filter",selectedDataSource:h.selectedDataSource,tableID:n.tableID,filteredCells:n.filteredCells,fltrdIdxes:[]},i=0,len=o.length;i<len;i++)r.fltrdIdxes.push(r.range.startRow+h.filterSettings.filteredRange.indexOf(o[i]));else r=n.operation==="remove-filter"?n:{sheetIndex:u,filteredCells:n.filteredCells,reqType:"filter",operation:"apply-filter",tableID:n.tableID,fRange:this.getSheet(u).filterSettings.range};else if(n.requestType===t.Spreadsheet.Actions.Sorting){for(l=[],c=n.filterIcon.length>0?n.range[0]-1:n.range[0],i=0;i<n.filterIcon.length;i++)s=this.XLFilter._getFilterHeader(u,c,n.filterIcon[i].colIndex),a=t.isNullOrUndefined(s)?"":s.status.indexOf("-asc")>-1?"-asc":s.status.indexOf("-dsc")>-1?"-dsc":"",v=n.filterIcon[i].colIndex===this._generateColCount(n.columnName)-1?n.sortDirection==="ascending"?"-asc":"-dsc":"",l.push({rowIdx:c,colIdx:n.filterIcon[i].colIndex,prevIcon:a,currIcon:v});r={sheetIndex:u,filterIcons:l,isSortByFilter:n.isSortByFilter,colSelected:n.colSelected,range:n.range,columnName:n.columnName,rangeData:n.rangeData,reqType:"sort",direction:n.sortDirection,operation:"unsort"}}else if(n.requestType==="sortbycolor"||n.requestType==="filterbycolor"){if(r={sheetIndex:u,operation:n.operation,oprType:n.oprType,requestType:n.requestType,action:n.action,bgcolor:n.bgcolor,fgcolor:n.fgcolor,tableID:n.tableID,reqType:n.requestType},r.columnName=n.requestType==="sortbycolor"?n.sortColumn:n.filterColumn,n.requestType==="filterbycolor"){for(e=[],y=this._generateColCount(r.columnName),i=n.range.endRow;i>=n.range.startRow;i--)f=this.XLEdit.getPropertyValue(i,y-1,"formats"),t.isNullOrUndefined(f)||(n.operation==="filterbgcolor"?t.isNullOrUndefined(f["background-color"])||n.bgcolor===f["background-color"].toLowerCase()&&e.push(i):t.isNullOrUndefined(f.color)||n.fgcolor===f.color.toLowerCase()&&e.push(i));r.fltrdIdxes=e}}else r=n;!this.model.allowUndoRedo||r.requestType==="sortbycolor"||this._dupDetails||this._updateUndoRedoCollection(r);(n.requestType==="filtering"||n.requestType==="filterbycolor"||n.requestType==="sortbycolor"||n.requestType==="filterbycell")&&n.operation!=="apply-filter"&&n.operation!=="remove-filter"&&this.sendDataRenderingRequest(r,this.getActiveSheetIndex());this.model.allowAutoFill&&n.reqType!=="find-replace"&&this.element.find(".e-ss-activeimg").length<1&&this.XLDragFill.positionAutoFillElement();this._updateUndoRedoIcons();this._trigger("actionComplete",n)},_updateUndoRedoCollection:function(n){this._isUndoRedo||(this._undoCollection.push(n),this._redoCollection=[]);this._undoCollection.length>this.undoRedoStep&&this._undoCollection.splice(0,1)},_trigActionBegin:function(n){return this._trigger("actionBegin",n)},_trigActionComplete:function(n){return this._trigger("actionComplete",n)},_updateUndoRedoIcons:function(){if(this.model.showRibbon&&this.model.allowUndoRedo){var t,i=n("#"+this._id+"_Ribbon_undo").data("ejButton"),r=n("#"+this._id+"_Ribbon_redo").data("ejButton");this._undoCollection.length?i.enable():i.disable();this._redoCollection.length?r.enable():r.disable();this.XLEdit._isEdit||this.XLComment&&this.XLComment._isCommentEdit||this._isSheetRename||!document.activeElement||!(document.activeElement.id.indexOf(this._id+"_Ribbon")<0)||this.setSheetFocus();t={reqType:"picture",action:"add"};this._trigActionComplete(t)}},_filterMergeCells:function(n,t){for(var s=this.getActiveSheetIndex(),h=this._dataContainer.sheets[s],e=this.getObjectKeys(h[n]),r,i,o=!1,u,f=0;f<e.length;f++)u=this.XLEdit.getPropertyValue(n,e[f],"mergeIdx"),u&&(r=u,o=!0);o&&(i=this.getCell(r.rowIndex,r.colIndex)[0],i.rowSpan=t==="incr"?i.rowSpan+1:i.rowSpan-1)},_isRowVisible:function(n,t){var i=this._dataContainer.sheets[n];return t in i?0 in i[t]&&(i[t][0].isRHide||i[t][0].isFRHide)?!1:!0:!0},_selectFirstCell:function(n,t,i,r){var u=this.getSheet(n);return u._isImported&&!u._isLoaded||r||(r=!r,this.performSelection({rowIndex:t,colIndex:i},{rowIndex:t,colIndex:i})),r},_refreshMergeCells:function(n,i,r,u){var y=this.getActiveSheetIndex(),a,o,p,w=!1,h=0,e,v,b=this.getSheet(y)._mergeColl,c,f,k,l,d,s;for(e=this.getObjectKeys(b),f=0,k=e.length;f<k;f++)for(v=this.getObjectKeys(b[e[f]]),l=0,d=v.length;l<d;l++)if(c=this.XLEdit.getPropertyValue(e[f],v[l],"merge"),h=0,cIdxes=0,c.mSpan){if(range=this.getRangeIndices(c.mRange),n>-1)for(a=parseInt(e[f]),o=parseInt(e[f])+c.mSpan.rowSpan-1,s=n;s<n+r;s++)a<=s&&o>=s&&(u==="hide"?h+=1:t.isNullOrUndefined(this.XLEdit.getPropertyValue(s,0,"isRHide"))||(h+=1));this._isRowViewable(y,parseInt(e[f]))&&(p=this.getCell(parseInt(e[f]),parseInt(v[l]))[0],w=!0);n>-1&&(o=u==="hide"?o-h:o+h,w&&(p.rowSpan=o-a+1),c.mSpan.rowSpan=o-a+1)}},_clearAllMergeCells:function(t,i,r,u,f,e){var v=this.getSheet(t),p=!0,b=this._dupDetails,s,l=!1,y=v._mergeColl,k=v._unmergeColl,d=this._removeMergeColl,h,a,g=this._dataContainer.sheets[t],o,w,c;for(this._dupDetails=!0,h=this.getObjectKeys(y),o=0,w=h.length;o<w;o++)for(a=this.getObjectKeys(y[h[o]]),c=0;c<a.length;c++)mergeObj=n.extend(!0,{},this.XLEdit.getPropertyValue(h[o],a[c],"merge")),s=this.getRangeIndices(mergeObj.mRange),e.indexOf("shift")>-1?(this._removeMergeColl=[],e.indexOf("Bottom")>-1||e.indexOf("Up")>-1?u<=s[3]&&s[1]<=u+f&&i<=s[2]&&(p=!1,l=!0):(e.indexOf("Right")>-1||e.indexOf("Left")>-1)&&i<=s[2]&&s[0]<=i+r&&u<=s[3]&&(p=!1,l=!0),l&&this._removeMergeColl.push({type:y[h[o]][a[c]],merge:mergeObj}),l=!1):((i===-1||i!=-1&&s[0]<i&&s[2]>i)&&(l=!0),(u===-1||u!=-1&&s[1]<u&&s[3]>u)&&(l=!0),l&&(h[o]in k?v._unmergeColl[h[o]][a[c]]={type:y[h[o]][a[c]],merge:mergeObj}:(v._unmergeColl[h[o]]={},v._unmergeColl[h[o]][a[c]]={type:y[h[o]][a[c]],merge:mergeObj}),this.unmergeCells(mergeObj.mRange,!0))),l=!1;return this._dupDetails=b,p},_refreshAllMergeCells:function(n,i,r,u,f,e){var a=this.getSheet(n),v=!1,y=a._unmergeColl,w=this._dupDetails,b,k,h,l,o,d=this._dataContainer.sheets[n],s,p,c;for(h=this.getObjectKeys(y),this._dupDetails=!0,s=0,p=h.length;s<p;s++)for(b=parseInt(h[s])>i?e.indexOf("insert")>-1?parseInt(h[s])+r:parseInt(h[s])-r:h[s],l=this.getObjectKeys(y[h[s]]),c=0;c<l.length;c++)k=parseInt(l[c])>u?e.indexOf("insert")>-1?parseInt(l[c])+f:parseInt(l[c])-f:l[c],mergeObj=a._unmergeColl[h[s]][l[c]].merge,this._mergeCenter=a._unmergeColl[h[s]][l[c]].type==="center",o=this.getRangeIndices(mergeObj.mRange),(i>-1||u>-1)&&(t.isNullOrUndefined(o)||(e.indexOf("Shift")>-1?(this._unMergeRange=mergeObj.mRange,this._showAlertDlg("","MergeCellsAlert","MergeCellsInsertAlert",498)):(i>-1&&(this._isUndoRedo&&(v=i<o[2]?o[2]-i==1:i-o[2]==1),i+1<=o[0]&&(o[0]=e==="insert"?o[0]+r:o[0]-r),(i<=o[2]||v)&&(o[2]=e==="insert"?o[2]+r:o[2]-r)),u>-1&&(this._isUndoRedo&&(v=u<o[3]?o[3]-u==1:u-o[3]==1),u+1<=o[1]&&(o[1]=e==="insert"?o[1]+f:o[1]-f),(u<=o[3]||v)&&(o[3]=e==="insert"?o[3]+f:o[3]-f)),mRange=this._getAlphaRange(n,o[0],o[1],o[2],o[3]),delete a._unmergeColl[h[s]][l[c]],this.mergeCells(mRange,!0))));this._dupDetails=w},sendDataRenderingRequest:function(i,u){for(var f,it=!1,nt,rt,wt,bt,ui=this._rAlign,s=this.getSheet(u),tt=this.model.scrollSettings.allowVirtualScrolling,e=s._selectedRange,p=[],h,fi,kt,b=s.filteredRowsCollection,a,et,v,y=s.filterSettings.tableRange,ot=[],dt,st,w=[],ht,ft,d,vt,ni,o,yt,pt,k,ti,lt,ii,ri,c=0,ut=y.length;c<ut;c++)if(y[c].tableID==i.tableID){v=c;break}if(tt&&(nt=s.rowsHeightCollection,rt=s.hideRowsCollection),this._dupDetails=!0,t.isNullOrUndefined(i)||i.reqType!="filter"){if(!t.isNullOrUndefined(i)&&(i.requestType==="sortbycolor"||i.requestType==="filterbycolor")){var ei=e.startRow,at=[],ct,gt=[],h=this._generateColCount(i.columnName)-1,l,g;if(i.prev={},i.cur={},i.oprType.indexOf("Put")<0&&(s._filterColl[e.startRow-1][h].status.indexOf("e-ssfilter")>-1&&i.requestType==="filterbycolor"?this._isRowViewable(u,e.startRow-1)&&(kt=this.getCell(e.startRow-1,h),kt.removeClass(ui),this.XLFilter._changeFilterIcon({rowIndex:e.startRow-1,colIndex:h},"filter",this.XLEdit.getPropertyValue(e.startRow-1,h,"filterState"))):s._filterColl[e.startRow-1][h].status.indexOf("-asc")&&(i.prev.icon=s._filterColl[e.startRow-1][h].status,this._isRowViewable(u,e.startRow-1)&&(kt=this.getCell(e.startRow-1,h),this.XLFilter._changeSortIcon({rowIndex:e.startRow-1,colIndex:h},"ascending")),i.cur.icon=s._filterColl[e.startRow-1][h].status)),i.requestType==="sortbycolor"){for(l=[e.startRow,h,e.endRow,h],g=this.getRangeData(l,null,null,null,null,null,!0),c=0,ft=g.length;c<ft;c++)ct=g[c].formats,t.isNullOrUndefined(ct)||(i.operation==="sortbgcolor"?t.isNullOrUndefined(ct["background-color"])||i.bgcolor===ct["background-color"].toLowerCase()&&at.push(c):t.isNullOrUndefined(ct.color)||i.fgcolor===ct.color.toLowerCase()&&at.push(c));if(this.isUndefined(i.tableID))for(d=[],pt=l[1];pt<=l[3];pt++)d.push(pt);else d=y[v].multifilterIdx;for(l=[e.startRow,d[0],e.endRow,d[d.length-1]],g=this.getRangeData(l,null,null,null,null,null,!0),i.prev.data=n.extend(!0,[],g),l.colIndex=h,i.range=l,o=0,ut=d.length;o<ut;o++){for(vt=[],ni=[],l=[e.startRow,d[o],e.endRow,d[o]],g=this.getRangeData(l,null,null,null,null,null,!0),yt=at.length-1;yt>=0;yt--)vt.push(g.splice(at[yt],1)[0]);ni=vt.reverse().concat(g);vt.length>0&&(this._isSort=!0,this._dupDetails=!0,this.XLComment.deleteComment(l,null,!0,null),this._removeHyperlink(null,null,!0),this.clearRangeData(l,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0),this.XLFormat.removeStyle(l,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0}),this._isSort=!1,this._dupDetails=!1,this.XLEdit.updateCellWithContainer(ni,l,u,!0))}i.cur.data=n.extend(!0,[],this.getRangeData(l,null,null,null,null,null,!0));this._updateUndoRedoCollection(i)}else{for(gt=[],ot=[],y[v].fltrdIdxes=p=i.fltrdIdxes,a=e.startRow===0?0:e.startRow,f=a;f<=e.endRow;f++){for(ht=!1,o=0,ft=p.length;o<ft;o++)p[o]==f&&(ht=!0);ht?(lt=this.XLEdit.getPropertyValue(f,h,"value2"),lt=t.isNullOrUndefined(lt)?"":lt,dt={field:i.columnName,value:lt,predicate:"or",operator:"equal",matchcase:!1},st=t.Predicate(i.columnName,"equal",lt),this.XLEdit.getPropertyValue(f,0,"filterID")===i.tableID&&(delete this._dataContainer.sheets[u][f][0].isFilterHide,delete this._dataContainer.sheets[u][f][0].filterID,tt?nt[f]=rt[f]:(this.XLFilter._isFilter=!0,this._showRow(f+1,f),this.XLFilter._isFilter=!1,b.indexOf(f)>-1&&b.splice(b.indexOf(f),1),s._isImported&&!s._isLoaded||it||(it=!it,this.performSelection({rowIndex:f,colIndex:h},{rowIndex:f,colIndex:h})))),gt.push(dt),w.push(dt),k=w[0],ti=k.from):(t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isRHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFilterHide"))&&(this.XLEdit._updateDataContainer({rowIndex:f,colIndex:0},{dataObj:{isFilterHide:!0,filterID:i.tableID}}),et=!0),tt?et&&(rt[f]=nt[f],nt[f]=0):(this.XLFilter._isFilter=!0,this._hideRow(f,f,"isFilterHide"),this.XLFilter._isFilter=!1,b.indexOf(f)===-1&&b.push(f)),et=!1)}if(tt&&(!s._isImported||s._isLoaded)&&(this._refreshViewport(this.getSheet(u)._scrollTop,u),this.performSelection({rowIndex:p[0],colIndex:h},{rowIndex:p[0],colIndex:h})),this.XLScroll._getRowHeights(u,a),!t.isNullOrUndefined(value)){for(st=k.ejpredicate?k.ejpredicate:t.Predicate(k.field,k.operator,k.value,!k.matchcase),o=1;o<w.length;o++)st=w[o].ejpredicate!=r?st[w[o].predicate](w[o].ejpredicate):st[w[o].predicate](w[o].field,w[o].operator,w[o].value,!w[o].matchcase);t.isNullOrUndefined(y[v].predicate[i.columnName])&&(y[v].predicate[i.columnName]={});y[v].filteredColumns=gt;y[v].predicate[i.columnName]=ti?{from:k.from,take:k.take}:st;y[v].hiddenIdx=n.extend(!0,[],ot);ot=[]}}}}else if(h=this._generateColCount(i.fieldName)-1,e=i.range,ot=y[v].hiddenIdx,wt=i.currentViewData,i.requestType.indexOf("filtering")>-1||i.requestType.indexOf("filterbycell")>-1||i.action.indexOf("clearfiltering")===-1){for(bt=s.filterSettings.filteredRange,c=0,ut=wt.length;c<ut;c++)idx=bt.indexOf(wt[c]),idx>-1&&p.push(bt[idx].idx);for(y[v].fltrdIdxes=p,a=e.startRow===0?0:e.startRow,f=a;f<=e.endRow;f++){for(ht=!1,o=0,ft=p.length;o<ft;o++)p[o]==f&&(ht=!0);ht?(t.isNullOrUndefined(this._dataContainer.sheets[u][f])||t.isNullOrUndefined(this._dataContainer.sheets[u][f][0])||(delete this._dataContainer.sheets[u][f][0].isFilterHide,delete this._dataContainer.sheets[u][f][0].filterID),tt?(f in rt&&(nt[f]=rt[f]),a=f===0?0:f-1,this.XLEdit.getPropertyValue(a,0,"hRow")&&delete this._dataContainer.sheets[u][a][0].hRow):(this.XLFilter._isFilter=!0,this._showRow(f+1,f),this.XLFilter._isFilter=!1,b.indexOf(f)>-1&&b.splice(b.indexOf(f),1),s._isImported&&!s._isLoaded||it||(it=!it,this.performSelection({rowIndex:f,colIndex:h},{rowIndex:f,colIndex:h})))):(t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isRHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFilterHide"))&&(this.XLEdit._updateDataContainer({rowIndex:f,colIndex:0},{dataObj:{isFilterHide:!0,filterID:i.tableID}}),et=!0),tt?(et&&(rt[f]=nt[f],nt[f]=0,et=!1),a=f===0?0:f-1,this.XLEdit._updateDataContainer({rowIndex:a,colIndex:0},{dataObj:{hRow:!0}})):(this.XLFilter._isFilter=!0,this._hideRow(f,f,"isFilterHide"),this.XLFilter._isFilter=!1,b.indexOf(f)===-1&&b.push(f)))}a=e.startRow===0?0:e.startRow-1;tt&&(!s._isImported||s._isLoaded)&&(this._refreshViewport(s._scrollTop,u),this.performSelection({rowIndex:p[0],colIndex:h},{rowIndex:p[0],colIndex:h}));this.XLScroll._getRowHeights(u,a);fi=s.columns;i.action==="clearfiltering"&&(s._filteredByColor=-1,this._excelFilter.closeXFDialog());this.XLFilter._updateFilterIcons(a,e.startRow,h,i.action);y[v].hiddenIdx=n.extend(!0,[],ot);ot=[]}t.isNullOrUndefined(i)||i.action!=="filter"&&i.action!=="filtering"&&i.action!=="filterbycolor"?i.action==="clearfiltering"&&(i.tableID>-1&&s.filterSettings.tableRange[v].filterColumnName.pop(i.fieldName),this.XLFilter._fltrRowHighlight(e.startRow,e.endRow,"clear",i.tableID,i.filterCollection.length)):(i.tableID>-1&&s.filterSettings.tableRange[v].filterColumnName.push(i.fieldName),this.XLFilter._fltrRowHighlight(e.startRow,e.endRow,"add",i.tableID,i.filterCollection.length));this._dupDetails=!1;this.model.showRibbon&&this.model.allowFiltering&&(ii=n("#"+this._id+"_Ribbon_clearfilter").data("ejButton"),ri={rowIndex:this.getActiveCell().rowIndex,colIndex:this.getActiveCell().colIndex},this.XLRibbon._changeClrFltrStatus(ii,"button",ri));this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(u,"refresh","vertical","filter")},_filterClose:function(){this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")&&(this.XLFilter._isSearchEdit=!1,this._excelFilter.closeXFDialog())},_setModel:function(i){var e,h,y=this.getActiveSheetIndex(),a,f=this.model,u=this._id,o=n("#"+u+"_Ribbon").ejRibbon("instance"),r=o.element,l,s,v,c;for(e in i){f[e]=i[e];switch(e){case"allowClipboard":i[e]?(f.allowFormatPainter&&f.allowCellFormatting||r.find("#"+u+"_Ribbon_home_Clipboard").show(),r.find("#"+u+"_Ribbon_home_Clipboard_1").show(),r.find("#"+u+"_Ribbon_home_Clipboard_cut").show(),r.find("#"+u+"_Ribbon_home_Clipboard_copy").show(),t.isNullOrUndefined(this.XLClipboard)&&(this.XLClipboard=new t.spreadsheetFeatures.clipboard(f))):(f.allowFormatPainter&&f.allowCellFormatting||r.find("#"+u+"_Ribbon_home_Clipboard").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_1").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_cut").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_copy").hide());break;case"activeSheetIndex":this.gotoPage(i[e],!1);break;case"pageSettings":this.isUndefined(i.pageSettings.currentPage)||this.gotoPage(i.pageSettings.currentPage,!1);this.isUndefined(i.pageSettings.pageCount)||(this.getPager().ejPager("option","pageCount",i.pageSettings.pageCount),this._refreshSpreadSheetPager());break;case"allowComments":i[e]?(t.isNullOrUndefined(this.XLComment)&&(this.XLComment=new t.spreadsheetFeatures.comments(f)),o.length&&o.showTab("REVIEW")):o.length&&o.hideTab("REVIEW");break;case"allowFormatPainter":f.allowCellFormatting&&(i[e]?(f.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").show(),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(f)),r.find("#"+u+"_Ribbon_home_Clipboard_formatpainter").show()):(f.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_formatpainter").hide()));break;case"allowHyperlink":i[e]?r.find("#"+u+"_Ribbon_insert_Links").show():r.find("#"+u+"_Ribbon_insert_Links").hide();break;case"enableContextMenu":i[e]&&t.isNullOrUndefined(this.XLCMenu)&&(this.XLCMenu=new t.spreadsheetFeatures.contextmenu(f));break;case"allowEditing":i[e]?(t.isNullOrUndefined(this.XLEdit)&&(this.XLEdit=new t.spreadsheetFeatures.editing(f)),r.find("#"+u+"_Ribbon_home_Editing").show()):r.find("#"+u+"_Ribbon_home_Editing").hide();break;case"allowResizing":i[e]&&t.isNullOrUndefined(this.XLResize)&&(this.XLResize=new t.spreadsheetFeatures.resizing(f));break;case"allowDataValidation":i[e]?(r.find("#"+u+"_Ribbon_data_DataTools").show(),t.isNullOrUndefined(XLValidate)&&(this.XLValidate=new t.spreadsheetFeatures.validation(f))):r.find("#"+u+"_Ribbon_data_DataTools").hide();break;case"allowConditionalFormats":i[e]?(r.find("#"+u+"_Ribbon_home_Styles_cFormat").show(),t.isNullOrUndefined(this.XLCFormat)&&(this.XLCFormat=new t.spreadsheetFeatures.cFormat(f))):r.find("#"+u+"_Ribbon_home_Styles_cFormat").hide();break;case"allowSearching":this.model.allowSearching=i[e];i[e]?(t.isNullOrUndefined(this.XLSearch)&&(this.XLSearch=new t.spreadsheetFeatures.findnreplace(f)),r.find("#"+u+"_Ribbon_others_Editing").show()):r.find("#"+u+"_Ribbon_others_Editing").hide();break;case"pictureSettings":for(l in i[e])switch(l){case"allowPictures":f.pictureSettings.allowPictures=i[e][l];i[e][l]?(t.isNullOrUndefined(this.XLShape)&&(this.XLShape=new t.spreadsheetFeatures.shape(f)),r.find("#"+u+"_Ribbon_insert_Illustrations").show()):r.find("#"+u+"_Ribbon_insert_Illustrations").hide()}break;case"showRibbon":this.model.showRibbon=i[e];i[e]?n("#"+u+"_Ribbon").show():n("#"+u+"_Ribbon").hide();break;case"exportSettings":for(h in i[e])switch(h){case"allowExporting":f.exportSettings.allowExporting=i[e][h];i[e][h]?(r.find("#saveas_backStageTab").show(),t.isNullOrUndefined(this.XLExport)&&(this.XLExport=new t.spreadsheetFeatures.exporting(f))):r.find("#saveas_backStageTab").hide();break;case"excelUrl":f.exportSettings.excelUrl=i[e][h];break;case"csvUrl":f.exportSettings.csvUrl=i[e][h]}break;case"allowKeyboardNavigation":i[e]&&t.isNullOrUndefined(this.XLCellNav)&&(this.XLCellNav=new t.spreadsheetFeatures.cellNavigation(f));break;case"allowAutoFill":i[e]&&t.isNullOrUndefined(this.XLDragFill)&&(this.XLDragFill=new t.spreadsheetFeatures.dragFill(f));break;case"allowSelection":i[e]&&t.isNullOrUndefined(this.XLSelection)&&(this.XLSelection=new t.spreadsheetFeatures.selection(f));break;case"allowDragAndDrop":i[e]&&t.isNullOrUndefined(this.XLDragDrop)&&(this.XLDragDrop=new t.spreadsheetFeatures.dragAndDrop(f));break;case"allowCellFormatting":i[e]?((f.allowConditionalFormats||f.allowFormatAsTable)&&r.find("#"+u+"_Ribbon_home_Styles").show(),r.find("#"+u+"_Ribbon_home_Font").show(),r.find("#"+u+"_Ribbon_home_Number").show(),r.find("#"+u+"_Ribbon_home_Alignment_top").show(),r.find("#"+u+"_Ribbon_home_Alignment_middle").show(),r.find("#"+u+"_Ribbon_home_Alignment_bottom").show(),r.find("#"+u+"_Ribbon_separator_bottom").show(),r.find("#"+u+"_Ribbon_home_Alignment_left").show(),r.find("#"+u+"_Ribbon_home_Alignment_center").show(),r.find("#"+u+"_Ribbon_home_Alignment_right").show(),r.find("#"+u+"_Ribbon_separator_right").show(),r.find("#"+u+"_Ribbon_home_Styles_cellstyles").show(),f.allowFormatPainter&&r.find("#"+u+"_Ribbon_home_Clipboard_formatpainter").show(),f.allowClipboard&&r.find("#"+u+"_Ribbon_home_Clipboard").show(),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(f))):(r.find("#"+u+"_Ribbon_home_Font").hide(),r.find("#"+u+"_Ribbon_home_Number").hide(),r.find("#"+u+"_Ribbon_home_Alignment_top").hide(),r.find("#"+u+"_Ribbon_home_Alignment_middle").hide(),r.find("#"+u+"_Ribbon_home_Alignment_bottom").hide(),r.find("#"+u+"_Ribbon_separator_bottom").hide(),r.find("#"+u+"_Ribbon_home_Alignment_left").hide(),r.find("#"+u+"_Ribbon_home_Alignment_center").hide(),r.find("#"+u+"_Ribbon_home_Alignment_right").hide(),r.find("#"+u+"_Ribbon_separator_right").hide(),r.find("#"+u+"_Ribbon_home_Styles_cellstyles").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_formatpainter").hide(),f.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").hide(),f.allowConditionalFormats||f.allowFormatAsTable||r.find("#"+u+"_Ribbon_home_Styles").hide());break;case"allowImport":i[e]?r.find("#new_backStageTab").show():r.find("#new_backStageTab").hide();break;case"importSettings":for(importProp in i[e])switch(h){case"importMapper":f.importSettings.importMapper=i[e][importProp];break;case"importUrl":f.importSettings.importUrl=i[e][importProp];break;case"password":f.importSettings.password=i[e][importProp]}break;case"allowSorting":i[e]?(t.isNullOrUndefined(this.XLSort)&&(this.XLSort=this.XLSort=new t.spreadsheetFeatures.sorting(f)),r.find("#"+u+"_Ribbon_data_SortFilter_1").show(),r.find("#"+u+"_Ribbon_data_Sort").show(),r.find("#"+u+"_Ribbon_home_Editing_1").show()):(r.find("#"+u+"_Ribbon_data_SortFilter_1").hide(),this.model.allowFiltering||(r.find("#"+u+"_Ribbon_data_Sort").hide(),r.find("#"+u+"_Ribbon_home_Editing_1").hide()));case"formatSettings":if(f.allowCellFormatting)for(s in i[e])switch(s){case"allowFontFamily":f.formatSettings.allowFontFamily=i[e][s];i[e][s]?r.find("#"+u+"_Ribbon_home_Font_font-family").show():r.find("#"+u+"_Ribbon_home_Font_font-family").hide();break;case"allowDecimalPlaces":f.formatSettings.allowDecimalPlaces=i[e][s];i[e][s]?(r.find("#"+u+"_Ribbon_home_Number_increment").show(),r.find("#"+u+"_Ribbon_home_Number_decrement").show(),r.find("#"+u+"_Ribbon_separator_usegrouping").show()):(r.find("#"+u+"_Ribbon_home_Number_increment").hide(),r.find("#"+u+"_Ribbon_home_Number_decrement").hide(),r.find("#"+u+"_Ribbon_separator_usegrouping").hide());break;case"allowCellBorder":f.formatSettings.allowCellBorder=i[e][s];i[e][s]?(r.find("#"+u+"_Ribbon_separator_border").show(),r.find("#"+u+"_Ribbon_home_Font_border").show()):(r.find("#"+u+"_Ribbon_separator_border").hide(),r.find("#"+u+"_Ribbon_home_Font_border").hide())}break;case"showGridlines":this.model.showRibbon&&(a=this.element.find("#"+this._id+"_Ribbon_Vgridlines").data("ejCheckBox"),i[e]?a._checked():a._unChecked());this.showGridlines(i[e]);break;case"scrollSettings":v={};t.isNullOrUndefined(i.scrollSettings)||(t.isNullOrUndefined(i.scrollSettings.allowScrolling)||(f.scrollSettings.allowScrolling=i.scrollSettings.allowScrolling),t.isNullOrUndefined(i.scrollSettings.scrollMode)||(f.scrollSettings.scrollMode=i.scrollSettings.scrollMode==="normal"?t.Spreadsheet.scrollMode.Normal:t.Spreadsheet.scrollMode.Infinite),t.isNullOrUndefined(i.scrollSettings.width)||(f.scrollSettings.width=i.scrollSettings.width),t.isNullOrUndefined(i.scrollSettings.height)||(f.scrollSettings.height=i.scrollSettings.height));n.extend(!0,v,this.model.scrollSettings);this._setSheetWidthHeight(y,v);break;case"allowFiltering":i[e]?(r.find("#"+u+"_Ribbon_data_SortFilter_2").show(),r.find("#"+u+"_Ribbon_data_Sort").show(),r.find("#"+u+"_Ribbon_home_Editing_1").show(),t.isNullOrUndefined(this.XLFilter)&&(this.XLFilter=new t.spreadsheetFeatures.filter(f)),this.XLFilter._renderExcelFilter(),this.XLFilter._renderFilterDialogs()):(this.model.allowSorting||(r.find("#"+u+"_Ribbon_data_Sort").hide(),r.find("#"+u+"_Ribbon_home_Editing_1").hide()),r.find("#"+u+"_Ribbon_data_SortFilter_2").hide());break;case"allowInsert":i[e]?(f.allowDelete||r.find("#"+u+"_Ribbon_others_Cells").show(),r.find("#"+u+"_Ribbon_others_Cells_1").show()):(f.allowDelete||r.find("#"+u+"_Ribbon_others_Cells").hide(),r.find("#"+u+"_Ribbon_others_Cells_1").hide());break;case"allowDelete":i[e]?(f.allowInsert||r.find("#"+u+"_Ribbon_others_Cells").show(),r.find("#"+u+"_Ribbon_others_Cells_2").show()):(f.allowInsert||r.find("#"+u+"_Ribbon_others_Cells").hide(),r.find("#"+u+"_Ribbon_others_Cells_2").hide());break;case"allowFreezing":i[e]?(t.isNullOrUndefined(this.XLFreeze)&&(this.XLFreeze=new t.spreadsheetFeatures.freezepane(f)),r.find("#"+u+"_Ribbon_others_Window").show()):r.find("#"+u+"_Ribbon_others_Window").hide();break;case"allowMerging":i[e]?r.find("#"+u+"_Ribbon_home_Alignment_merge").show():r.find("#"+u+"_Ribbon_home_Alignment_merge").hide();break;case"freezeFirstColumn":case"allowWrap":i[e]?r.find("#"+u+"_Ribbon_home_Alignment_wraptext").show():r.find("#"+u+"_Ribbon_home_Alignment_wraptext").hide();break;case"allowUndoRedo":i[e]?r.find("#"+u+"_Ribbon_home_Actions").show():r.find("#"+u+"_Ribbon_home_Actions").hide();case"freezeLeftColumn":this.XLFreeze.freezeLeftColumn(y);this.XLFreeze._updateFPaneMenu("freeze");break;case"freezeRows":case"allowFormatAsTable":i[e]?(f.allowPivotTable||r.find("#"+u+"_Ribbon_insert_Tables").show(),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(f)),r.find("#"+u+"_Ribbon_home_Styles_formatastable").show(),r.find("#"+u+"_Ribbon_insert_Tables_table").show()):(f.allowPivotTable||r.find("#"+u+"_Ribbon_insert_Tables").hide(),r.find("#"+u+"_Ribbon_home_Styles_formatastable").hide(),r.find("#"+u+"_Ribbon_insert_Tables_table").hide());break;case"freezeColumns":case"allowPivotTable":i[e]?(f.allowFormatAsTable||r.find("#"+u+"_Ribbon_insert_Tables").show(),r.find("#"+u+"_Ribbon_insert_Tables_pivotTable").show()):(f.allowFormatAsTable||r.find("#"+u+"_Ribbon_insert_Tables").hide(),r.find("#"+u+"_Ribbon_insert_Tables_pivotTable").hide());break;case"allowAutoSum":i[e]?r.find("#"+u+"_Ribbon_home_Editing_autosum").show():r.find("#"+u+"_Ribbon_home_Editing_autosum").hide();break;case"allowCharts":i[e]?((t.isNullOrUndefined(this.XLChart)||t.isNullOrUndefined(this.XLShape))&&(this.XLShape=new t.spreadsheetFeatures.shape(f)),this.XLChart=new t.spreadsheetFeatures.chart(f),r.find("#"+u+"_Ribbon_insert_Charts").show()):r.find("#"+u+"_Ribbon_insert_Charts").hide();break;case"allowSortandFilter":case"printSettings":for(c in i[e])switch(c){case"allowPrinting":f.printSettings.allowPrinting=i[e][c];i[e][c]?(this.XLPrint=new t.spreadsheetFeatures.print(f),r.find("#"+u+"_Ribbon_pagelayout_Print").show(),r.find("#print_backStageTab").show()):(r.find("#print_backStageTab").show(),r.find("#"+u+"_Ribbon_pagelayout_Print").hide());break;case"allowPageSize":f.printSettings.allowPageSize=i[e][c];i[e][c]?r.find("#"+u+"_Ribbon_pagelayout_PageLayout").show():r.find("#"+u+"_Ribbon_pagelayout_PageLayout").hide()}break;case"allowLockCell":i[e]?(r.find(".e-ssr-protectsheetbtn").show(),r.find(".e-ssr-lockbtn").show()):(r.find(".e-ssr-protectsheetbtn").hide(),r.find(".e-ssr-lockbtn").hide());break;case"undoRedoStep":this.undoRedoStep=i[e]}}o.length&&(f.allowAutoSum||f.allowFiltering||f.allowUndoRedo||f.allowSorting||f.allowClipboard||f.allowFormatPainter||f.allowCellFormatting||f.allowMerging||f.allowWrap||f.allowConditionalFormats||f.allowFormatAsTable?o.showTab("HOME"):o.hideTab("HOME"),f.allowFormatAsTable||f.allowPictures||f.allowHyperlink||f.allowCharts?o.showTab("INSERT"):o.hideTab("INSERT"),f.allowDataValidation||f.allowFiltering||f.allowSorting?o.showTab("DATA"):o.hideTab("DATA"),f.allowPrinting?o.showTab("PAGELAYOUT"):o.hideTab("PAGELAYOUT"),f.allowComments?o.showTab("REVIEW"):o.hideTab("REVIEW"),f.allowFreezing||f.allowInsert||f.allowDelete||f.allowSearching?o.showTab("OTHERS"):o.hideTab("OTHERS"))},"import":function(t){if(this.model.allowImport){var r=this,i={type:"POST",data:this._import(t),async:!0,url:this.model.importSettings.importMapper,success:function(n){r._importSuccess(n)},error:function(n,t){r._importFailed({type:t,xhr:{status:n.status,statusText:n.statusText}})}};(this._browserDetails.name!=="msie"||this._browserDetails.version!=="9.0"||i.data.append)&&(i.processData=!1,i.contentType=!1);r.showWaitingPopUp();n.ajax(i)}},_import:function(n){if(window.FormData&&this._isObject(n)){var t=new FormData;for(prop in n)t.append(prop,n[prop]);return t}return n},_importSuccess:function(t){var i=["UnsupportedFile","IncorrectPassword","InvalidUrl","NeedPassword"];switch(t){case i[0]:case i[1]:case i[2]:this._showAlertDlg("Alert",t,"",null,110);break;case i[3]:n("#"+this._id+"_ImportPasswordDialog").ejDialog("open");this.model.importSettings.password="";break;default:this.loadFromJSON(JSON.parse(t))}this.hideWaitingPopUp()},loadFromJSON:function(t){var i,f,r,u,e,o;for(this.isImport=!0,n("#"+this._id+"_file").ejUploadbox("option","autoUpload",!0),r=1,u=t.model.sheets,e=0,o=u.length;e<o;e++)if(u[r]._frozenRows||u[r]._frozenColumns){this.model.scrollSettings.allowVirtualScrolling=!1;this.option("allowFreezing",!0);break}if(this._isSheetReq)i=Number(this.getObjectKeys(t.dataContainer.sheets)[0]),this._refreshImpStyles(t.dataContainer.hashCode),this._impData.dataContainer=n.extend(!0,{},t.dataContainer),this._impData.dataContainer.sheets=this._dataContainer.sheets,this._impData.dataContainer.cellType=this._dataContainer.cellType,this._impData.dataContainer.sheets[i]=t.dataContainer.sheets[i],this._impData.model.sheets[i]=t.sheet,this._dataContainer=n.extend(!0,{},this._impData.dataContainer),this._dataContainer.sheetCellType={},this._refreshModel(t.sheet,!0,i),this._sheetSettings(i),this._intrnlReq||this.gotoPage(i,!1),this._isSheetReq=!1;else if(this.model.scrollSettings.allowVirtualScrolling||(f=this._getMaxRowColCnt(t.model.sheets,!0)),this.model.scrollSettings.allowVirtualScrolling||t.dataContainer.sharedData.length<50001&&f.rowCount<10001&&f.colCount<126){if(this._impData=t,this._isInitLoad)this._refreshModel(t.model),this._initBase();else{for(this._destroy(),this._refreshModel(t.model),this._dataContainer=n.extend(!0,{},t.dataContainer),this._dataContainer.sheetCellType={},this._initCSSTag();r<=this.model.sheetCount;)this._sheetSettings(r),this.model.scrollSettings.allowVirtualScrolling||this.model.importSettings.allowSheetOnDemand||this._renderSheet(r),this._newSIndex++,r++;this._refreshNameMngr(t.model.nameManager);this.gotoPage(this.getActiveSheetIndex(),!1)}this.clearUndoRedo();this._trigger("loadComplete",{model:this.model})}else this._showAlertDlg("Alert","HugeDataAlert");this._intrnlReq||(this.isImport=!1);this._intrnlReq=!1},_importFailed:function(n){var t={failureType:n.type};n.xhr?(t.status=n.xhr.status,t.statusText=n.xhr.statusText):t.statusText=n.error;this.hideWaitingPopUp();this._trigger("openFailure",t)},_importSheet:function(t){var r,i={},u=this.model.importSettings;this._isSheetReq=!0;i={sheetIndex:t,allowSheetOnDemand:u.allowSheetOnDemand,password:this._encrypt(u.password)};i.dataContainer=JSON.stringify({hashCode:this._dataContainer.hashCode,sharedData:this._dataContainer.sharedData,valData:this._dataContainer.valData,cFormatData:this._dataContainer.cFormatData});r=n("#"+this._id+"_file").data("ejUploadbox")._files;r?i.file=r[0].rawFile:i.url=u.importUrl;this["import"](i);this.getSheet(t)._isRequested=!0},_refreshModel:function(n,t,i){var u,e,r,f=1;if(n)if(t)r=this.model.sheets[this._getSheetIndex(i)],r.rowCount=n.rowCount||this.defaults.rowCount,r.colCount=n.colCount||this.defaults.colCount;else for(this.model.sheetCount=n.sheetCount||this.defaults.sheetCount,this.model.activeSheetIndex=n.activeSheetIndex||this.defaults.activeSheetIndex,this.model.rowHeight=n.rowHeight||this.defaults.rowHeight,this.model.columnWidth=n.columnWidth||this.defaults.columnWidth,this.model.sheets=[{}],u=n.sheets.length;f<u;)r=n.sheets[f],e={rowCount:r.rowCount||this.defaults.rowCount,colCount:r.colCount||this.defaults.colCount},this.model.sheets.push(e),f++;else u=this.model.sheets.length,this.model.sheetCount<u&&(this.model.sheetCount=u)},_refreshImpStyles:function(n){for(var r,t,i=0,u=n.length;i<u;)t=n[i],this._dataContainer.hashCode.indexOf(t)===-1&&(t.indexOf("e-format")===-1?this._dataContainer.hashCode.push(t):(r=this.XLFormat.getFormatFromHashCode(t),this.XLFormat._createFormatClass(r))),i++},_refreshImpSheets:function(n){var t=this._impData.model.sheets[n];this._refreshImpCells(n);this._refreshImpDV(n);this._refreshImpCF(n);this.model.allowMerging&&t._mergedCells&&this._refreshImpMC(t._mergedCells);this.model.allowFiltering&&t.filterSettings.range&&this.XLFilter._filterCellRange(n,t.filterSettings.range);this._refreshImpHC(t.hideColsCollection);(t._frozenRows||t._frozenColumns)&&this._setFreezePane(t._frozenRows,t._frozenColumns);this._refreshImpTable(t._tableManager);this.model.allowCellType&&this._refreshSheetCellTypes(this._impData.dataContainer.sheetCellType,n);this._refreshImpCharts(t._shapeMngr.chart);this._refreshImpPics(t._shapeMngr,n);t.showHeader===!1&&this.showHeaders(t.showHeader)},_refreshImpCells:function(n){for(var t,i=0,u=this.getSheet(n)._usedRange,r=this.XLEdit._getPropWithCellIdx([0,0,u.rowIndex,u.colIndex],"value",n,!0),f=r.length;i<f;)t=r[i],this.XLEdit._refreshCalcEngine(t.rowIdx,t.colIdx,!0,t.value),i++;if(this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder)for(i=0,r=this.XLEdit._getPropWithCellIdx([0,0,u.rowIndex,u.colIndex],"borders",n),f=r.length;i<f;)t=r[i],this.XLFormat.applyBorder(t.value,[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]),i++},_refreshImpDV:function(n){if(this.model.allowDataValidation)for(var u,t,r,f=this._impData.dataContainer.valData.length,i=0;i<f;i++)r=this._impData.dataContainer.valData[i],t=r.split("_"),u=Number(t[t.length-1]),u===n&&(r.indexOf("list")===-1?this.XLValidate.applyDVRules(t[5],[this._getValue(this.XLRibbon._actions,t[1]),t[2],t[3]],t[4],t[0]==="1"?!0:!1,!0):this.XLValidate.applyDVRules(t[3],["list",t[1]],"list",t[0]==="1"?!0:!1,!0),this._impData.dataContainer.valData.splice(i,1),f=this._impData.dataContainer.valData.length,i--)},_refreshSheetCellTypes:function(n,t){var r=[],i,u;if(!(this.getObjectLength(n)<1)){for(i=1,u=this.getObjectLength(n[t]);i<=u;i++)r.push({range:n[t][i].settings.range,settings:n[t][i].settings});this.XLCellType._rangeCellTypes(r,t)}},_refreshImpCF:function(n){if(this.model.allowConditionalFormats)for(var t,r=this._impData.dataContainer.cFormatData.length,i=0;i<r;i++)t=this._impData.dataContainer.cFormatData[i].split("_"),idx=Number(t[4]),idx===n&&(this.XLCFormat._cFormat(t[0],t[1],t[2],t[3],null,idx,this.getRangeIndices(t[5])),this._impData.dataContainer.cFormatData.splice(i,1),r=this._impData.dataContainer.cFormatData.length,i--)},_refreshImpMC:function(n){var t,i=n.length;if(i)while(i--)t=n[i],t.isCenterAlign&&(this._mergeCenter=!0),this.mergeCells(t.range,!0),this._mergeCenter=!1},_refreshImpHC:function(n){var t,i=n.length;if(i)while(i--)t=n[i],this._hideColumn(t,t)},_setFreezePane:function(n,t){n&&t?this.XLFreeze.freezePanes({rowIndex:n,colIndex:t}):n?this.XLFreeze.freezeRows(n):t&&this.XLFreeze.freezeColumns(t)},_refreshImpTable:function(n){var t,i,r,u=this.getObjectLength(n);if(this.model.allowFormatAsTable&&u)while(u--)r=n[u],t=r.range,i=this.XLFormat._getTableLayoutFromName(r.formatName),i||(i=this.XLFormat._formatAsTableStyle,r.formatName=i.formatName),this.XLFormat.createTable({header:!0,name:"Table"+this._tableCnt++,format:i.format,formatName:r.formatName},this._getAlphaRange(this.getActiveSheetIndex(),t[0],t[1],t[2],t[3]))},_refreshImpCharts:function(n){if(this.model.allowCharts)for(var i,t,r=0,u=this.getObjectLength(n);r<u;)t=n["chart"+r],i=this.getSheet(t.dataSheetIdx),t.dataSheetIdx!=this.getActiveSheetIndex()&&i._isImported&&!i._isRequested&&(this._intrnlReq=!0,this._importSheet(t.dataSheetIdx)),this.XLChart.createChart(t.range,{type:t.commonSeriesOptions.type,enable3D:t.enable3D,marker:t.commonSeriesOptions.marker,top:t.top,left:t.left,heigth:t.size.height,width:t.size.width,title:t.title,legend:t.legend,primaryYAxis:t.primaryYAxis,primaryXAxis:t.primaryXAxis,dataSheetIdx:t.dataSheetIdx}),r++},_refreshImpPics:function(n,t){if(this.model.pictureSettings.allowPictures)for(var i,r=0,u=this.getObjectLength(n.picture);r<u;)i=n.picture["picture"+r],this.XLShape._createPicture(t,null,n.sharedPics[i.data],i.top,i.left,i.width,i.height,null,i.bcolor,i.bstyle,i.bwidth),r++},_refreshNameMngr:function(t){t=t||this.model.nameManager;var i=t.length;if(this.model.showRibbon){if(i)while(i--)this.XLRibbon._updateNamedRanges(t[i].name,t[i].refersto,!0);n("#"+this._id+"_nmgrid").ejGrid("option",{dataSource:t});this.XLRibbon._updateUseInFormulaTrgt()}this.XLEdit._refreshAutoComplete()},_getBorderInput:function(n){n=n.split("_");for(var t=4,i={},r=["top","right","bottom","left"];t--;)n[t].length&&(i[r[t]]=n[t]);return i},_refreshHashCode:function(n){n=n||this._dataContainer.hashCode;for(var t,i=n.length;i--;)t=n[i],t.indexOf("e-format")===-1&&t.indexOf("e-border")===-1&&(n[i]="")},clearUndoRedo:function(){this._undoCollection=[];this._redoCollection=[];this._updateUndoRedoIcons()},_initializePicture:function(n){this._getContent(n).find(".e-content").append(t.buildTag("div.e-ss-imgvisual"))},_getShapePositionInManager:function(n,t,i,r){for(var o=this.getActiveSheetIndex(),f=this._dataContainer.sheets[o][n][t],u=0,e=f.length;u<e;u++)if(f[r][u].id===i)break;return u},_swapVal:function(n){var t=n.prev;n.prev=n.cur;n.cur=t},_getValue:function(n,t){for(var i,r=n.length;r--;)if(i=n[r],i.value===t)return i.value},_isRowViewable:function(n,t){var i=!0;return this.model.scrollSettings.allowVirtualScrolling&&(n=this._getSheetIndex(n),i=this.getSheet(n)._virtualRowIdx.indexOf(t)>-1),i},_isColumnViewable:function(){return!0},_undoRedoOperation:function(t){var r,u,i=this.getActiveCell();(t.which===90||t.keyCode===90)&&t.ctrlKey?(t.preventDefault(),t.target.id.indexOf("_Edit")>-1||t.target.id.indexOf("_input")>-1?(r=this.XLEdit.getCurrentEditCellData(),r!==this._cureditedCell&&(u=r,t.target.id.indexOf("_Edit")>-1?t.target.textContent=this._cureditedCell:n("#"+this._id+"_Edit")[0].textContent=this._cureditedCell,this.model.allowFormulaBar&&this._getInputBox().val(this._cureditedCell),this._undoInputobj={value:u,rowIndex:i.rowIndex,colIndex:i.colIndex})):(this._isUndo=!0,this._performUndoRedo())):(t.which===89||t.keyCode===89)&&t.ctrlKey&&(t.preventDefault(),t.target.id.indexOf("_Edit")>-1||t.target.id.indexOf("_input")>-1?i.rowIndex===this._undoInputobj.rowIndex&&i.colIndex===this._undoInputobj.colIndex&&(t.target.id.indexOf("_Edit")>-1?t.target.textContent=this._undoInputobj.value:n("#"+this._id+"_Edit")[0].textContent=this._undoInputobj.value,this.model.allowFormulaBar&&this._getInputBox().val(this._undoInputobj.value)):(this._isUndo=!1,this._performUndoRedo()))},_performUndoRedo:function(){var n=this._isUndo?this._undoCollection.pop():this._redoCollection.pop(),i;if(!t.isNullOrUndefined(n)){n.sheetIndex!==this.getActiveSheetIndex()&&this.gotoPage(n.sheetIndex,null);this._isUndoRedo=!0;switch(n.reqType){case"auto-fill":this._undoForAutoFill(n);break;case"auto-sum":this._undoForAutoSum(n);break;case"cell-format":this._undoForFormat(n);break;case"cell-styles":this._undoForStyle(n);break;case"clear-all":this._undoForClAll(n);break;case"clear-comment":this._undoForClComment(n);break;case"clear-content":this._undoForClContent(n);break;case"clear-format":this._undoForClFormat(n);break;case"clear-link":this._undoForCLLink(n);break;case"comment":this._undoForComment(n);break;case"cond-format":this._undoForCondFormat(n);break;case"copy-paste":this._undoForCopyPaste(n);break;case"cut-paste":this._undoForCutPaste(n);break;case"delete":this._undoForDel(n);break;case"edit":this._undoForEdit(n);break;case"filter":this._undoForFilter(n);break;case"filterbycolor":this._undoForFilterByColor(n);break;case"find-replace":this._undoForFind(n);break;case"format-painter":this._undoForFormatPaint(n);break;case"format-table":this._undoForFormatTable(n);break;case"hyperlink":this._undoForHyperlink(n);break;case"insert":this._undoForIns(n);break;case"merge-cells":this._undoForMerge(n);break;case"paging":i=n.nSheetIndex;n.nSheetIndex=n.sheetIndex;n.sheetIndex=i;break;case"pivotgrid":this._undoForPivot(n);break;case"resize-column":this._undoForResizeCol(n);break;case"resize-row":this._undoForResizeRow(n);break;case"resize-fit-height":this._undoForResizeFHeight(n);break;case"resize-fit-width":this._undoForResizeFWidth(n);break;case"reorder-cells":this._undoForReOrder(n);break;case"show-hide":this._undoForShowHide(n);break;case"shape":this._undoForShape(n);break;case"sort":this._undoForSort(n);break;case"sortbycolor":this._undoForSortByColor(n);break;case"textwrap":this._undoForTextWrap(n);break;case"validation":this._undoForValidation(n)}this._isUndo?this._redoCollection.push(n):this._undoCollection.push(n);this._undoCollection.length>this.undoRedoStep&&this._undoCollection.splice(0,1);this._redoCollection.length>this.undoRedoStep&&this._redoCollection.splice(0,1);this._updateUndoRedoIcons();this.model.showRibbon&&this.XLRibbon._updateRibbonIcons();this._isUndoRedo=!1;this._isUndo=!1;n.reqType!="shape"&&this.XLSelection._refreshBorder()}},_undoForAutoFill:function(t){var i=this.getSheet(t.sheetIndex);this._isUndo?(this.clearRangeData(t.range,this._cellProp),this.model.allowCellFormatting&&(this.XLFormat.removeStyle(t.range),this.XLFormat.updateFormat(t.bFormat,t.range)),this.updateData(n.extend(!0,[],t.bData),t.range),t.actionType=="flash-fill"&&this.updateData(n.extend(!0,[],t.bdData),t.bRange),t.colSel?this.XLSelection.selectColumns(i._startCell.colIndex,i._endCell.colIndex):t.rowSel?this.XLSelection.selectRows(i._startCell.rowIndex,i._endCell.rowIndex):this.performSelection({rowIndex:t.bRange[0],colIndex:t.bRange[1]},{rowIndex:t.bRange[2],colIndex:t.bRange[3]})):(this.model.allowCellFormatting&&this.XLFormat.updateFormat(t.aFormat,t.range),this.updateData(n.extend(!0,[],t.aData),t.range),this.XLCFormat.refreshCFormat(),t.actionType=="flash-fill"&&this.updateData(n.extend(!0,[],t.adData),t.bRange),this.performSelection({rowIndex:t.bRange[0],colIndex:t.bRange[1]},{rowIndex:t.range[2],colIndex:t.range[3]}))},_undoForAutoSum:function(t){var e=this._dataContainer.sheets[t.sheetIndex],r,u,i,f;if(this._isUndo){for(i=0,f=t.updCell.length;i<f;i++)r=this.getCell(t.updCell[i].rowIndex,t.updCell[i].colIndex,t.sheetIndex),this._clearFormula(t.updCell[i].rowIndex,t.updCell[i].colIndex),this.clearRangeData([t.updCell[i].rowIndex,t.updCell[i].colIndex,t.updCell[i].rowIndex,t.updCell[i].colIndex],["value2"],null,!0),u=n.extend(!0,{},t.updCell[i].pObj),e[t.updCell[i].rowIndex][t.updCell[i].colIndex]=u,r.text(t.updCell[i].pValue);this.performSelection(t.range)}else this.XLRibbon.autoSum(t.oprType,t.range)},_undoForClAll:function(t){var u=this.model.sheets[t.sheetIndex],i,r;if(this._dupDetails=!0,this._isUndo){for(this.updateData(n.extend(!0,[],t.bData),t.range),i=0,r=t.wrapColl.length;i<r;i++)this.setWrapText("wrap",[t.wrapColl[i].rowIdx,t.wrapColl[i].colIdx.val.wrapColl[i].rowIdx,t.wrapColl[i].colIdx]);for(i=0,r=t.mergeColl.length;i<r;i++)this._mergeCenter=t.mergeColl.mergeObj.isCenterAlign,this.mergeCells(t.mergeColl.mergeObj.mRange,!0)}else this.clearRangeData(t.range,["value","value2","format","formats","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","comment","cFormatRule"]),this.setWrapText("unwrap",t.range),this.unmergeCells(t.range);this._dupDetails=!1;t.tblObj&&(this._isUndo?this.XLFormat.createTable(t.tblObj,t.tblObj.range):(this.XLFormat.removeTable(t.tblId),this.XLRibbon._toggleDesignTab(this.getActiveCell())));this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t.range)},_undoForClComment:function(n){var i,u,f,t,e;if(n.selCells.length){if(u={rowIndex:n.selCells[0].rowIndex,colIndex:n.selCells[0].colIndex},f={rowIndex:n.selCells[n.selCells.length-1].rowIndex,colIndex:n.selCells[n.selCells.length-1].colIndex},this._isUndo)for(t=0,e=n.selCells.length;t<e;t++)i={rowIndex:n.selCells[t].rowIndex,colIndex:n.selCells[t].colIndex},this.XLEdit._updateDataContainer({rowIndex:n.selCells[t].rowIndex,colIndex:n.selCells[t].colIndex},{dataObj:{comment:n.selCells[t].prevComment}}),this.XLSelection.selectRange(i,i),this.XLComment.setComment(),this.XLComment._updateCurCmntVal();else this.XLSelection.selectRange(u,f),this.XLComment.deleteComment(r,null,!1,"clear");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()}},_undoForClContent:function(t){this._isUndo?this.updateData(n.extend(!0,[],t.bData),t.range):this.clearRangeData(t.range,["value","value2","hyperlink"],t.reqType);this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t.range)},_undoForClFormat:function(t){var u=this._dataContainer.sheets[t.sheetIndex],i,r;if(this._isUndo){for(i=0,r=t.wrapColl.length;i<r;i++)this.setWrapText("wrap",[t.wrapColl[i].rowIdx,t.wrapColl[i].colIdx.val.wrapColl[i].rowIdx,t.wrapColl[i].colIdx]);this.updateData(n.extend(!0,[],t.bData),t.range,t.reqType)}else t.tblObj?this.clearRangeData(t.range,["format","formats","tformats","border","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","cFormatRule"]):this.clearRangeData(t.range,["format","formats","border","type","formatstr","decimalPlaces","thousandSeparator","hyperlink","cFormatRule"],"",!1,t.reqType),this.setWrapText("unwrap",t.range);this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t.range)},_undoForCLLink:function(n){var f={rowIndex:n.selCells[0].rowIndex,colIndex:n.selCells[0].colIndex},e,u,o={rowIndex:n.selCells[n.selCells.length-1].rowIndex,colIndex:n.selCells[n.selCells.length-1].colIndex},i,r;if(this.setActiveCell(n.selCells[0].rowIndex,n.selCells[0].colIndex),this.XLSelection.selectRange(f,o),this._isUndo)for(i=0,r=n.selCells.length;i<r;i++)n.selCells[i].prevLink&&(u=this.getCell(n.selCells[i].rowIndex,n.selCells[i].colIndex),n.selCells[i].prevLink.webAddr?u.html(t.buildTag("a.e-hyperlinks",n.selCells[i].prevText,"",{href:n.selCells[i].prevLink.webAddr,target:"_blank"})):u.html(t.buildTag("a.e-hyperlinks",n.selCells[i].prevText,"",{href:"#"})));else this._removeHyperlink("clear",n.selCells);for(this.XLSelection.selectRange(f,o),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),i=0,r=n.selCells.length;i<r;i++)e=n.selCells[i].prevLink,n.selCells[i].prevLink=n.selCells[i].curLink,n.selCells[i].curLink=e},_undoForComment:function(n){var t,u,f,r,i,e;for(u={rowIndex:n.selCells[0].rowIndex,colIndex:n.selCells[0].colIndex},f={rowIndex:n.selCells[n.selCells.length-1].rowIndex,colIndex:n.selCells[n.selCells.length-1].colIndex},i=0,e=n.selCells.length;i<e;i++)t={rowIndex:n.selCells[i].rowIndex,colIndex:n.selCells[i].colIndex},this.XLSelection.selectRange(t,t),this.getSheet(n.sheetIndex)._startCell=t,n.action==="add"?(n.selCells[i].prevComment=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"comment"),this.XLComment.deleteComment()):n.action==="edit"?(this._isRowViewable(n.sheetIndex,t.rowIndex)&&this.getCell(t.rowIndex,t.colIndex).find(".e-comment-txtarea").val(n.selCells[i].prevComment.value),this.XLComment._updateCurCmntVal(),r=n.selCells[i].prevComment,n.selCells[i].prevComment=n.selCells[i].curComment,n.selCells[i].curComment=r):(this.XLEdit._updateDataContainer(t,{dataObj:{comment:n.selCells[i].prevComment}}),this.XLComment.setComment([t.rowIndex,t.colIndex,t.rowIndex,t.colIndex],null,!1),this.XLSelection.selectRange(t,t),this.XLComment._updateCurCmntVal(),r=n.selCells[i].prevComment,n.selCells[i].prevComment=n.selCells[i].curComment,n.selCells[i].curComment=r);n.action==="add"?n.action="delete":n.action==="delete"&&(n.action="add");this.XLSelection.selectRange(u,f);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForCondFormat:function(n){var i,e,l,s,c,r,o=[],h,a,u,f,v;if(this._isUndo){if(n.action==="add"){for(u=this.XLSelection._getSelectedRange({rowIndex:n.range[0],colIndex:n.range[1]},{rowIndex:n.range[2],colIndex:n.range[3]}),c=this.XLEdit.getPropertyValue(u[0].rowIndex,u[0].colIndex,"cFormatRule"),n.poppedRule=c[c.length-1],i=0,e=u.length;i<e;i++){if(h=this.XLEdit.getPropertyValue(u[i].rowIndex,u[i].colIndex,"cFormatRule"),!this.isUndefined(h))for(h.pop(),f=0,l=h.length;f<l;f++)s=h[f],o.length===0?(r=s.indexOf("true")>-1?s.replace("_true",""):s.replace("_false",""),o.push(r)):o=this._addCondFormatRule(o,s);this._isRowViewable(n.sheetIndex,u[i].rowIndex)&&(a=this.getCell(u[i].rowIndex,u[i].colIndex,n.sheetIndex),a.removeClass("e-redft e-yellowft e-greenft e-redf e-redt"))}for(this.clearRangeData(n.range,["cFormatRule"],u),i=0,e=o.length;i<e;i++)r=o[i].split("_"),this.XLCFormat._cFormat(r[0],r[2],r[3],r[4],r[5],n.sheetIndex,n.range)}else if(n.action==="clear")for(i=0,e=n.rule.length;i<e;i++)for(f=0,v=n.rule[i].length;f<v;f++)this.XLCFormat.setCFRule(n.rule[i][f])}else n.action==="add"?t.isNullOrUndefined(n.poppedRule)||(r=n.poppedRule.split("_"),this.XLCFormat._cFormat(r[0],r[2],r[3],r[4],r[5],n.sheetIndex,n.range)):n.action==="clear"&&this.XLCFormat.clearCF(n.selection)},_undoForCopyPaste:function(i){var u={},s=this._dataContainer,k,c=this.getSheet(i.pSheetIndex)._shapeMngr,f,ut,a,e,h;if(i.operation==="shape")k=i.pShapeId.indexOf("picture")>-1?"picture":"chart",f=n.extend(!0,{},i.pasteCell.obj),t.isNullOrUndefined(f)||(this.XLShape._picCellIdx={rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},k==="chart"?"chart"in f&&(this._isUndo?(u=n.extend(!0,{},c.chart[i.pShapeId]),t.isNullOrUndefined(s.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(s.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),s.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=f,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+u.id))):(this.setActiveCell(i.pasteCell.rowIndex,i.pasteCell.colIndex,i.pSheetIndex),u=n.extend(!0,{},i.pasteCell.shapeObj),o=u.range,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,o[0],o[1],o[2],o[3]),u),this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.cSheetIndex))):"picture"in f&&(this._isUndo?(u=n.extend(!0,{},c.picture[i.pShapeId]),t.isNullOrUndefined(s.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(s.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),s.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=f,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+u.id))):(u=n.extend(!0,{},i.pasteCell.shapeObj),p=this._id+"_picture",this.XLShape._createPicture(i.pSheetIndex,{rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},c.sharedPics[u.data],u.top,u.left,u.width,u.height,parseInt(u.id.replace(p,"")))))),this.XLScroll._getRowHeights(i.pSheetIndex,i.pasteCell.rowIndex);else{for(var v,d,w,l,g=!1,b,s=this._dataContainer,nt=[],p,tt,it,o,rt,ut,e,h,r=0,y=i.text.length;r<y;r++)for(v=0,d=i.text[r].split("\t").length;v<d;v++)nt.push(i.text[r].split("\t")[v]);for(this._dupDetails=!0,this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),this.setActiveSheetIndex(i.pSheetIndex),r=0,y=i.pasteCells.length;r<y;r++){if(f=t.isNullOrUndefined(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])?{}:s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex],this._isUndo||"merge"in i.pasteCells[r].prevObj&&(this._mergeCenter=i.pasteCells[r].prevObj.merge.isCenterAlign,this.mergeCells(i.pasteCells[r].prevObj.merge.mRange,!0)),this._isRowViewable(i.pSheetIndex,i.pasteCells[r].rowIndex)&&(w=this.getCell(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pSheetIndex)[0],this._isUndo||(w.textContent=nt[r]),g=!0),!t.isNullOrUndefined(f)){if("picture"in f)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[r].rowIndex,colIndex:i.pasteCells[r].colIndex},e=0,h=f.picture.length;e<h;e++)u=n.extend(!0,{},c.picture[f.picture[e]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+u.id));if("chart"in f)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[r].rowIndex,colIndex:i.pasteCells[r].colIndex},e=0,h=f.chart.length;e<h;e++)u=n.extend(!0,{},c.chart[f.chart[e]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+u.id));l=this._generateHeaderText(i.pSheetIndex,i.pasteCells[r].colIndex+1)+(i.pasteCells[r].rowIndex+1);"wrap"in f&&this.setWrapText("unwrap",l+":"+l);"merge"in f&&this._isUndo&&(i.pasteCells[r].newObj=n.extend(!0,{},s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]),this.unmergeCells(this._getAlphaRange(i.pSheetIndex,i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex)),this.getCell(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pSheetIndex).removeAttr("rowspan").removeAttr("colspan"),"merge"in i.pasteCells[r].prevObj&&(this._mergeCenter=i.pasteCells[r].prevObj.merge.isCenterAlign,this.mergeCells(i.pasteCells[r].prevObj.merge.mRange,!0),this._mergeCenter=!1))}if(g&&this._isUndo&&(w.textContent=""),t.isNullOrUndefined(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])&&(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex]={}),t.isNullOrUndefined(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex])||(b=s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].overflow),this.model.allowCellFormatting&&this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]=n.extend(!0,{},i.pasteCells[r].prevObj),b&&(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].overflow=b),this._textClip(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,"delete"),this._setRowHdrHeight(i.pSheetIndex,i.pasteCells[r].rowIndex),f=t.isNullOrUndefined(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])?{}:s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex],tt=i.pasteCells[r].rowIndex,it=i.pasteCells[r].colIndex,this._applyCommentLink(f,{rowIndex:i.pasteCells[r].rowIndex,colIndex:i.pasteCells[r].colIndex},tt,it),this._isPaste=!0,!t.isNullOrUndefined(f)){if("picture"in f)for(e=0,h=f.picture.length;e<h;e++)u=n.extend(!0,{},c.picture[f.picture[e]]),p=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.pSheetIndex,{rowIndex:i.pasteCells[r].rowIndex,colIndex:i.pasteCells[r].colIndex},c.sharedPics[u.data],u.top,u.left,u.width,u.height,parseInt(u.id.replace(p,"")));if("chart"in f){for(o=f.chart[0].range,this.setActiveCell(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pSheetIndex),e=0,h=f.chart.length;e<h;e++)u=n.extend(!0,{},c.chart[f.chart[e]]),this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.pSheetIndex,o[0],o[1],o[2],o[3]),u);this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.pSheetIndex)}l=this._generateHeaderText(i.pSheetIndex,i.pasteCells[r].colIndex+1)+(i.pasteCells[r].rowIndex+1);"wrap"in f&&this.setWrapText("wrap",l+":"+l);this._isPaste=!1}rt=i.pasteCells[r].prevObj;i.pasteCells[r].prevObj=i.pasteCells[r].newObj;i.pasteCells[r].newObj=rt}if(i.isSpecial&&(this.model.allowCellFormatting&&(this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),this.isUndefined(i.pasteBorder.prevBorder)||this.XLFormat.updateFormat(i.pasteBorder.prevBorder,i.pasteBorder.range,"format")),ut=i.pasteBorder.prevBorder,i.pasteBorder.prevBorder=i.pasteBorder.newBorder,i.pasteBorder.newBorder=ut),!t.isNullOrUndefined(i.pfat))for(a=i.pfat.ptable,e=0,h=a.length;e<h;e++)t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this._isUndo?this.XLFormat.removeTable(n.trim(a[e].name.replace("Table",""))):(a[e].header=!0,this.XLFormat.createTable(a[e],a[e].range)));t.isNullOrUndefined(i.filter)||(this.XLFilter.clearFilter(),this.XLFilter.filter(details.filter));this._dupDetails=!1}i.operation!=="shape"&&(this._isUndo?(t.isNullOrUndefined(i.cSheetIndex)||this.setActiveSheetIndex(i.cSheetIndex),i.cutCells.length>0&&this.XLSelection._focusBorder(i.cutCells[0],i.cutCells[i.cutCells.length-1],this._cutFocus),this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])):(t.isNullOrUndefined(i.cSheetIndex)||this.setActiveSheetIndex(i.cSheetIndex),i.cutCells.length>0&&this.XLSelection._focusBorder(i.cutCells[0],i.cutCells[i.cutCells.length-1],this._cutFocus),this.setActiveSheetIndex(i.pSheetIndex),i.pasteCells.length>0&&this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),this.XLScroll._getRowHeights(i.pSheetIndex,i.pasteCells[0].rowIndex))},_undoForCutPaste:function(i){var u,p,e={},s=this._dataContainer,l=this.getSheet(i.pSheetIndex)._shapeMngr,w,tt,k,ut,ft,et,d,v,c,a,rt,it,g,nt,ot,o,r,f,h,lt,at,vt;if(i.operation==="shape")k=i.pShapeId.indexOf("picture")>-1?"picture":"chart",u=n.extend(!0,{},i.pasteCell.obj),t.isNullOrUndefined(u)||(this.XLShape._picCellIdx={rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},e=n.extend(!0,{},l[k][i.pShapeId]),t.isNullOrUndefined(s.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(s.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),s.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=u,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+e.id))),u=n.extend(!0,{},i.cutCell.obj),k=i.cShapeId.indexOf("picture")>-1?"picture":"chart",t.isNullOrUndefined(u)||(this.setActiveCell(i.cutCell.rowIndex,i.cutCell.colIndex,i.cSheetIndex),k==="chart"?"chart"in u&&(e=n.extend(!0,{},i.cutCell.shapeObj),o=e.range,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,o[0],o[1],o[2],o[3]),e),this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.cSheetIndex)):"picture"in u&&(e=n.extend(!0,{},i.cutCell.shapeObj),w=this._id+"_picture",this.XLShape._createPicture(i.cSheetIndex,{rowIndex:i.cutCell.rowIndex,colIndex:i.cutCell.colIndex},l.sharedPics[e.data],e.top,e.left,e.width,e.height,parseInt(e.id.replace(w,""))))),this.XLShape._picCellIdx={rowIndex:i.cutCell.rowIndex,colIndex:i.cutCell.colIndex},ut=i.pasteCell,i.pasteCell=i.cutCell,i.cutCell=ut,ft=i.pShapeId,i.pShapeId=i.cShapeId,i.cShapeId=ft;else{for(s=this._dataContainer,it=[],this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),r=0,nt=i.text.length;r<nt;r++)for(g=0,ot=i.text[r].split("\t").length;g<ot;g++)it.push(i.text[r].split("\t")[g]);for(r=0,nt=i.pasteCells.length;r<nt;r++)if(!t.isNullOrUndefined(i.pSheetIndex)){if(this.isUndefined(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])||(u=s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]),v=this._generateHeaderText(i.pSheetIndex,i.pasteCells[r].colIndex+1)+(i.pasteCells[r].rowIndex+1),"wrap"in u&&this.setWrapText("unwrap",v+":"+v),this._isRowViewable(i.pSheetIndex,i.pasteCells[r].rowIndex)&&(rt=this.getCell(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pSheetIndex)[0],rt.textContent=""),!this.isUndefined(u)){if("picture"in u)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[r].rowIndex,colIndex:i.pasteCells[r].colIndex},f=0,h=u.picture.length;f<h;f++)e=n.extend(!0,{},l.picture[u.picture[f]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+e.id));if("chart"in u)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[r].rowIndex,colIndex:i.pasteCells[r].colIndex},f=0,h=u.chart.length;f<h;f++)e=n.extend(!0,{},l.chart[u.chart[f]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+e.id));"merge"in u&&(this._isUndo?(n.extend(!0,i.pasteCells[r].newObj,s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]),this.setActiveSheetIndex(i.pSheetIndex),this.unmergeCells(u.merge.mRange),this.getCell(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pSheetIndex).removeAttr("rowspan").removeAttr("colspan"),"merge"in i.pasteCells[r].prevObj&&(this._mergeCenter=i.pasteCells[r].prevObj.merge.isCenterAlign,this.mergeCells(i.pasteCells[r].prevObj.merge.mRange,!0),this._mergeCenter=!1)):(this.setActiveSheetIndex(i.pSheetIndex),this.unmergeCells(u.merge.mRange,!0),"merge"in i.pasteCells[r].prevObj&&(this._mergeCenter=i.pasteCells[r].prevObj.merge.isCenterAlign,this.mergeCells(i.pasteCells[r].prevObj.merge.mRange,!0),this._mergeCenter=!1),this.setActiveSheetIndex(i.cSheetIndex),this.unmergeCells(this._getAlphaRange(i.pSheetIndex,i.cutCells[r].rowIndex,i.cutCells[r].colIndex,i.cutCells[r].rowIndex,i.cutCells[r].colIndex)),o=this.getRangeIndices(i.cutCells[r].prevObj.merge.mRange),this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.sheetIndex)))}if(this.isUndefined(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])&&(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex]={}),t.isNullOrUndefined(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex])||(p=s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].overflow),this.model.allowCellFormatting&&this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].wrap&&(tt=!0),s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]=n.extend(!0,{},i.pasteCells[r].prevObj),this._textClip(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,"delete"),!this.isUndefined(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])&&(p&&(s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].overflow=p),this._setRowHdrHeight(i.pSheetIndex,i.pasteCells[r].rowIndex),u=s.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex],c=i.pasteCells[r].rowIndex,a=i.pasteCells[r].colIndex,this._applyCommentLink(u,{rowIndex:c,colIndex:a},c,a),tt&&(u.wrap=tt),this._isPaste=!0,!t.isNullOrUndefined(u))){if("picture"in u)for(f=0,h=u.picture.length;f<h;f++)e=n.extend(!0,{},l.picture[u.picture[f]]),w=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.pSheetIndex,{rowIndex:c,colIndex:a},l.sharedPics[e.data],e.top,e.left,e.width,e.height,parseInt(e.id.replace(w,"")));if("chart"in u){for(this.setActiveCell(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pSheetIndex),f=0,h=u.chart.length;f<h;f++)e=n.extend(!0,{},l.chart[u.chart[f]]),o=e.range,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,o[0],o[1],o[2],o[3]),e);this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.pSheetIndex)}v=this._generateHeaderText(i.pSheetIndex,a+1)+(c+1);"wrap"in u&&this.setWrapText("wrap",v+":"+v)}d=i.pasteCells[r].prevObj;i.pasteCells[r].prevObj=i.pasteCells[r].newObj;i.pasteCells[r].newObj=d;this._isPaste=!1}for(r=0;r<i.cutCells.length;r++)if(!t.isNullOrUndefined(i.cSheetIndex)){if(this._isRowViewable(i.cSheetIndex,i.cutCells[r].rowIndex)&&(et=this.getCell(i.cutCells[r].rowIndex,i.cutCells[r].colIndex,i.cSheetIndex)[0],et.textContent=it[r]),this.setActiveSheetIndex(i.cSheetIndex),u=t.isNullOrUndefined(s.sheets[i.cSheetIndex][i.cutCells[r].rowIndex])?{}:s.sheets[i.cSheetIndex][i.cutCells[r].rowIndex][i.cutCells[r].colIndex],!t.isNullOrUndefined(u)){if("picture"in u)for(this.XLShape._picCellIdx={rowIndex:i.cutCells[r].rowIndex,colIndex:i.cutCells[r].colIndex},f=0,h=u.picture.length;f<h;f++)e=n.extend(!0,{},l.picture[u.picture[f]]),this.XLShape._deleteShape(i.cSheetIndex,this.element.find("#"+e.id));if("chart"in u)for(this.XLShape._picCellIdx={rowIndex:i.cutCells[r].rowIndex,colIndex:i.cutCells[r].colIndex},f=0,h=u.chart.length;f<h;f++)e=n.extend(!0,{},l.chart[u.chart[f]]),this.XLShape._deleteShape(i.cSheetIndex,this.element.find("#"+e.id))}if(t.isNullOrUndefined(s.sheets[i.cSheetIndex][i.cutCells[r].rowIndex])&&(s.sheets[i.cSheetIndex][i.cutCells[r].rowIndex]={}),t.isNullOrUndefined(s.sheets[i.cSheetIndex][i.cutCells[r].rowIndex][i.cutCells[r].colIndex])||(p=s.sheets[i.cSheetIndex][i.cutCells[r].rowIndex][i.cutCells[r].colIndex].overflow),i.cutCells[r].prevObj.tableName&&delete i.cutCells[r].prevObj.tableName,s.sheets[i.cSheetIndex][i.cutCells[r].rowIndex][i.cutCells[r].colIndex]=n.extend(!0,{},i.cutCells[r].prevObj),p&&(s.sheets[i.cSheetIndex][i.cutCells[r].rowIndex][i.cutCells[r].colIndex].overflow=p),d=i.cutCells[r].prevObj,i.cutCells[r].prevObj=i.cutCells[r].newObj,i.cutCells[r].newObj=d,c=i.cutCells[r].rowIndex,a=i.cutCells[r].colIndex,this._setRowHdrHeight(i.cSheetIndex,c),this.XLScroll._getRowHeights(i.cSheetIndex,c),u=t.isNullOrUndefined(s.sheets[i.cSheetIndex][c])?{}:s.sheets[i.cSheetIndex][c][a],this._applyCommentLink(u,{rowIndex:c,colIndex:a},c,a),this._isPaste=!0,!t.isNullOrUndefined(u)){if("picture"in u)for(f=0,h=u.picture.length;f<h;f++)e=n.extend(!0,{},l.picture[u.picture[f]]),w=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.cSheetIndex,{rowIndex:c,colIndex:a},l.sharedPics[e.data],e.top,e.left,e.width,e.height,parseInt(e.id.replace(w,"")));if("chart"in u){for(this.setActiveCell(i.cutCells[r].rowIndex,i.cutCells[r].colIndex,i.cSheetIndex),f=0,h=u.chart.length;f<h;f++)e=n.extend(!0,{},l.chart[u.chart[f]]),o=e.range,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.cSheetIndex,o[0],o[1],o[2],o[3]),e);this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.cSheetIndex)}"merge"in u&&(this._mergeCenter=u.merge.isCenterAlign,this.mergeCells(u.merge.mRange,!0),this._mergeCenter=!1);this._dupDetails=!0;v=this._generateHeaderText(i.cSheetIdx,i.cutCells[r].colIndex+1)+(i.cutCells[r].rowIndex+1);"wrap"in u&&this.setWrapText("wrap",v+":"+v);this._dupDetails=!1}this._isPaste=!1}if(this.XLScroll._getRowHeights(i.pSheetIndex,i.pasteCells[0].rowIndex<i.cutCells[0].rowIndex?i.pasteCells[0].rowIndex:i.cutCells[0].rowIndex),this.model.allowCellFormatting&&!t.isNullOrUndefined(i.pSheetIndex)&&(this.setActiveSheetIndex(i.pSheetIndex),this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),this.isUndefined(i.pasteBorder.prevBorder)||this.XLFormat.updateFormat(i.pasteBorder.prevBorder,i.pasteBorder.range,"format")),nBrdr=i.pasteBorder.prevBorder,i.pasteBorder.prevBorder=i.pasteBorder.newBorder,i.pasteBorder.newBorder=nBrdr,this.model.allowCellFormatting&&!t.isNullOrUndefined(i.cSheetIndex)&&(this.setActiveSheetIndex(i.cSheetIndex),i.isSpecial&&this.XLFormat.removeStyle(i.cutBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),i.cutBorder.prevBorder&&this.XLFormat.updateFormat(i.cutBorder.prevBorder,i.cutBorder.range,"format")),nBrdr=i.cutBorder.prevBorder,i.cutBorder.prevBorder=i.cutBorder.newBorder,i.cutBorder.newBorder=nBrdr,!t.isNullOrUndefined(i.pfat)){var st,y=i.pfat.table,b,ht=i.pfat.minRowIdx,ct=i.pfat.minColIdx;for(o=i.pfat.range,f=0,h=y.length;f<h;f++)b=y[f].range,t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLFormat.removeTable(n.trim(y[f].tblObj.name.replace("Table",""))),this.XLRibbon.removeNamedRange(y[f].tblObj.name)),t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this._isUndo?this.XLFormat.createTable(y[f].tblObj,y[f].range):(st=this.getRangeIndices(this._getAlphaRange(i.cSheetIndex,b[0]+ht-o[0],b[1]+ct-o[1],ht-o[0]+b[2],ct-o[1]+b[3])),this.XLFormat.createTable(y[f].tblObj,st)))}t.isNullOrUndefined(i.filter)||(this.XLFilter.clearFilter(),this.XLFilter.filter(details.filter))}i.operation!=="shape"&&(this._isUndo?(t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLSelection.selectRange(i.cutCells[0],i.cutCells[i.cutCells.length-1])),t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1]))):(t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection._focusBorder(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1],this._cutFocus),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])),t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLSelection.selectRange(i.cutCells[0],i.cutCells[i.cutCells.length-1]))));this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();lt=i.pasteCells;i.pasteCells=i.cutCells;i.cutCells=lt;at=i.pasteBorder;i.pasteBorder=i.cutBorder;i.cutBorder=at;vt=i.cSheetIndex;i.cSheetIndex=i.pSheetIndex;i.pSheetIndex=vt},_undoForDel:function(t){this._delCells=n.extend(!0,[],t.delCells);this._deletedText=n.extend(!0,[],t.text);this._removeMergeColl=n.extend(!0,[],t.removeMerge);this._deletedDimension=n.extend(!0,[],t.deletedDimension);switch(t.action){case"deleteShiftUp":this.deleteShiftUp(t.startCell,t.endCell);break;case"deleteShiftLeft":this.deleteShiftLeft(t.startCell,t.endCell);break;case"deleteRow":this.deleteEntireRow(t.startCell.rowIndex,t.endCell.rowIndex);break;case"deleteColumn":this.deleteEntireColumn(t.startCell.colIndex,t.endCell.colIndex)}},_undoForEdit:function(n){var u,h,o,f,s=n.cFormatRule,e={rowIndex:n.rowIndex,colIndex:n.colIndex},c,r,l;if(this.setActiveCell(n.rowIndex,n.colIndex,n.sheetIndex),this.XLSelection.selectRange(n.startCell,n.endCell),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),this._isRowViewable(n.sheetIndex,n.rowIndex)&&(r=this.getCell(n.rowIndex,n.colIndex),l=r.find("a").css("text-decoration")),u=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"hyperlink",n.sheetIndex),t.isNullOrUndefined(u)||(h=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"value2"),n.action=h.length<1?"add":"delete",n.reqType="edit",e.prevLink=u,e.prevText=h,n.selCells=[]),c=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"comment"),this.XLEdit.updateCellValue({rowIndex:n.rowIndex,colIndex:n.colIndex},n.pValue),this._dupDetails=!0,s&&s.length)for(i=0,len=s.length;i<len;i++)f=s[i].split("_"),this.XLCFormat._cFormat(f[0],f[2],f[3],f[4],f[5]);this._dupDetails=!1;this._textClip(n.rowIndex,n.colIndex,n.pValue.length>0?"add":"delete");t.isNullOrUndefined(c)||(this.XLEdit._updateDataContainer({rowIndex:n.rowIndex,colIndex:n.colIndex},{dataObj:{comment:c}}),this.XLComment.setComment(),this.XLComment._updateCurCmntVal());this._isRowViewable(n.sheetIndex,n.rowIndex)&&(u&&(u.webAdr?r.html(t.buildTag("a",r.text(),"",{href:hldata.webAdr,target:"_blank","class":"e-hyperlinks"})):r.html(t.buildTag("a",r.text(),"",{href:"#","class":"e-hyperlinks"}))),r.find("a").css("text-decoration",l),r.removeClass("e-commentcell"));t.isNullOrUndefined(u)||(e.curLink=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"hyperlink"),e.curText=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"value2"),n.selCells.push(e));this._setRowHdrHeight(n.sheetIndex,n.rowIndex);this.XLScroll._getRowHeights(n.sheetIndex,n.rowIndex);o=n.cValue;n.cValue=n.pValue;n.pValue=o;this.XLEdit._isEdit=!1;o=n.previousValue;n.previousValue=n.value;n.value=o},_undoForFilter:function(i){var a=!1,h=[],u,y,o=[],v,f,c,p,r,e,s,l;if(i.operation==="filter"&&i.requestType!=="filterbycell")if(this._isUndo){for(r=this._undoCollection.length-1;r>=0;r--){if(this._undoCollection[r].reqType==="filter"&&this._undoCollection[r].tableID===i.tableID&&this._undoCollection[r].action==="filtering"&&this._undoCollection[r].status!=="apply-filterIcon"){for(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],u=this._undoCollection[r],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,u.tableID),r=0,e=u.filterCollection.length;r<e;r++)h.push(u.filterCollection[r]);this.model.sheets[u.sheetIndex].filterSettings.filteredColumns=h;t.isNullOrUndefined(this._excelFilter._predicates[u.sheetIndex][u.fieldName])&&(this._excelFilter._predicates[u.sheetIndex][u.fieldName]={});this._excelFilter._predicates[u.sheetIndex][u.fieldName]=u.ejpredicate;this.model.sheets[u.sheetIndex]._selectedRange=u.range;this.XLFilter._filterHandler(u);v="undo";a=!0;break}if(this._undoCollection[r].requestType==="filterbycell"){u=this._undoCollection[r];delete this._excelFilter._predicates[u.sheetIndex][u.fieldName];this.XLFilter._clearFilterColumn(u.fieldName,"","","Or",null,null,u.tableID);n.extend(!0,o,u.selCells);this.XLFilter._filterActiveCell(u.sheetIndex,u.activeCell,o,u.filteredValue);v="undo";a=!0;break}}a||(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID))}else{for(h=[],delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),r=0,e=i.filterCollection.length;r<e;r++)h.push(i.filterCollection[r]);this.model.sheets[i.sheetIndex].filterSettings.filteredColumns=h;t.isNullOrUndefined(this._excelFilter._predicates[i.sheetIndex][i.fieldName])&&(this._excelFilter._predicates[i.sheetIndex][i.fieldName]={});this._excelFilter._predicates[i.sheetIndex][i.fieldName]=i.ejpredicate;i.filterCollection.length&&this.XLFilter._filterHandler(i);v="redo"}else if(this._isUndo){if(i.operation==="apply-filter"&&i.requestType!=="filterbycell")for(r=0,e=i.filteredCells.length;r<e;r++)f=this.getCell(i.filteredCells[r].rowIndex,i.filteredCells[r].colIndex,i.sheetIndex),f.find(".e-ssfilter").remove(),this._removeClass(f[0],"e-filterhdr"),(this.isNumber(f.text())||this.XLEdit._parseValue(f.text()).type==="datetime"||this.XLEdit._parseValue(f.text()).type==="currency"||this.XLEdit._parseValue(f.text()).type==="percentage")&&f.addClass(this._rAlign);if(i.requestType==="filterbycell"){if(!this.isUndefined(i.filteredCells))for(r=0,e=i.filteredCells.length;r<e;r++)f=this.getCell(i.filteredCells[r].rowIndex,i.filteredCells[r].colIndex,i.sheetIndex),f.find(".e-ssfiltered, .e-ssfilter").remove(),this._removeClass(f[0],"e-filterhdr"),(this.isNumber(f.text())||this.XLEdit._parseValue(f.text()).type==="datetime"||this.XLEdit._parseValue(f.text()).type==="currency"||this.XLEdit._parseValue(f.text()).type==="percentage")&&f.addClass(this._rAlign);delete this._excelFilter._predicates[i.sheetIndex][i.fieldName];this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID)}if(this.model.sheets[i.sheetIndex].filterSettings.range="",i.operation==="apply-filter"&&i.requestType!="filterbycell"||i.requestType==="filterbycell"&&!this.isUndefined(i.filteredCells)){for(c=this.model.sheets[i.sheetIndex].filterSettings.tableRange,r=0,e=c.length;r<e;r++)if(c[r].tableID===i.tableID){p=r;break}i.filterRange=c.splice(p,1)[0]}if(i.operation==="remove-filter"){if(s=this._undoCollection[this._undoCollection.length-1],s.requestType==="filterbycell")n.extend(!0,o,s.selCells),this.XLFilter._filterActiveCell(s.sheetIndex,s.activeCell,o,s.filteredValue);else for(r=0,e=i.filteredCells.length;r<e;r++)l=this.XLFilter._getFilterIcon(),this.XLFilter._applyFilterIcon(i.filteredCells[r],l),i.filteredCells[r].removeClass(this._rAlign);this.model.sheets[i.sheetIndex].filterSettings.range=i.fRange;this.model.sheets[i.sheetIndex].filterSettings.tableRange.push(i.filterRange)}}else if(i.operation==="remove-filter"&&(i.requestType==="filterbycell"?(this._isRowViewable(i.sheetIndex,i.activeCell.rowIndex)&&(y=this.getCell(i.activeCell.rowIndex,i.activeCell.colIndex),y.find("span.e-ssfilter").remove()),delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),n.extend(!0,o,i.selCells),this.XLFilter._filterActiveCell(i.sheetIndex,i.activeCell,o,i.filteredValue)):this.XLFilter.clearFilter("remove")),i.operation==="filter"&&i.requestType==="filterbycell"&&(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),n.extend(!0,o,i.selCells),this.XLFilter._filterActiveCell(i.sheetIndex,i.activeCell,o,i.filteredValue)),i.operation==="apply-filter"){for(r=0,e=i.filteredCells.length;r<e;r++)l=this.XLFilter._getFilterIcon(),this.XLFilter._applyFilterIcon({rowIndex:i.filteredCells[r].rowIndex,colIndex:i.filteredCells[r].colIndex},l);this.model.sheets[i.sheetIndex].filterSettings.range=i.fRange;this.model.sheets[i.sheetIndex].filterSettings.tableRange.push(i.filterRange)}},_undoForFilterByColor:function(n){var i,r=[],t;for(r.push(n),i=this._isUndo?this._undoCollection:r,delete this._excelFilter._predicates[n.sheetIndex][n.columnName],this.XLFilter._clearFilterColumn(n.columnName,"","","Or",null,null,n.tableID),t=i.length-1;t>=0;t--)if(i[t].reqType==="filterbycolor"&&i[t].tableID===n.tableID){this.XLFilter._filterHandler(i[t]);break}},_undoForFind:function(n){var i,t,r,u;switch(n.operation){case"replace":this.XLEdit.updateCellValue({rowIndex:n.rowIndex,colIndex:n.colIndex},n.prevData.value,null,n.sheetIndex);u=n.prevData;n.prevData=n.newData;n.newData=u;this.XLSelection.selectRange({rowIndex:n.rowIndex,colIndex:n.colIndex},{rowIndex:n.rowIndex,colIndex:n.colIndex});break;case"replaceAll":for(t=0,r=n.selCells.length;t<r;t++)this.XLEdit.updateCellValue({rowIndex:n.selCells[t].rowIndex,colIndex:n.selCells[t].colIndex},n.selCells[t].prevData.value,null,n.selCells[t].sheetIndex),u=n.selCells[t].prevData,n.selCells[t].prevData=n.selCells[t].newData,n.selCells[t].newData=u;break;case"blanks":case"conditions":case"validations":case"formulas":case"rowdiff":case"coldiff":case"comments":case"constants":for(t=0,r=n.selCells.length;t<r;t++)i=this.getCell(n.selCells[t].rowIndex,n.selCells[t].colIndex,n.sheetIndex),this._isUndo?i.operation==="coldiff"||i.operation==="rowdiff"?n.selCells[t].isApply?i.removeClass("e-selected"):i.addClass("e-selected"):n.selCells[t].isApply?i.addClass("e-selected"):i.removeClass("e-selected"):i.removeClass("e-selected")}this.model.allowFormulaBar&&this.updateFormulaBar()},_undoForFormat:function(i){var h=!1,y,r,l,f,e=this._dataContainer.sheets[i.sheetIndex],c,o,a,s="",u,v;if(t.isNullOrUndefined(i.process))for(i.oprType==="style"&&(this.XLFormat.removeStyle(i.range,{cellStyle:!0,format:!0}),s="e-format",!t.isNullOrUndefined(i.process)&&i.process.indexOf("border")>-1&&(s="e-border"),a=new RegExp("\\b"+s+".*?\\b","g")),y={startCell:i.selCell[0],endCell:i.selCell[i.selCell.length-1]},u=0,v=i.selCell.length;u<v;u++)r=i.selCell[u],this._isRowViewable(i.sheetIndex,r.rowIndex)&&(f=this.getCell(r.rowIndex,r.colIndex)[0],h=!0),t.isNullOrUndefined(e[r.rowIndex])&&(e[r.rowIndex]={}),t.isNullOrUndefined(e[r.rowIndex][r.colIndex])&&(e[r.rowIndex][r.colIndex]={}),n.extend(!0,e[r.rowIndex][r.colIndex],i.selCell[u].beforeFormat),h&&(i.oprType==="format"?(c=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2"),f.innerHTML=t.isNullOrUndefined(c)?"":c):(l=s==="e-format"?this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"format"):this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border"),f.className=f.className.replace(a,""),this.addClass(f,l))),i.selCell[0].colIndex===i.selCell[u].colIndex&&this.model.allowResizing&&(this._isUndo?this.XLResize.setRowHeight(i.selCell[u].rowIndex,i.selCell[u].bRowHeight):this.XLResize.setRowHeight(i.selCell[u].rowIndex,i.selCell[u].aRowHeight)),o=i.selCell[u].beforeFormat,i.selCell[u].beforeFormat=i.selCell[u].afterFormat,i.selCell[u].afterFormat=o,h=!1;!t.isNullOrUndefined(i.process)&&i.process.indexOf("border")>-1&&(this.XLFormat.removeStyle(i.range),this.XLFormat.updateFormat(i.beforeFormat,i.range),o=i.beforeFormat,i.beforeFormat=i.afterFormat,i.afterFormat=o);i.status="undo-cellformat"},_undoForFormatPaint:function(t){var r,i,e,o,s=this._dataContainer.sheets[t.sheetIndex],u,f;for(this.XLCFormat.clearCF(!0,t.range),this.XLFormat.removeStyle(t.range),this.updateData(n.extend(!0,[],t.beforeData),t.range),this.XLCFormat.refreshCFormat(t.range),e=this.getRangeData(t.range),o=this.XLSelection._getSelectedRange({rowIndex:t.range[0],colIndex:t.range[1]},{rowIndex:t.range[2],colIndex:t.range[3]}),i=0,f=t.unwrapCells.length;i<f;i++)this.setWrapText("unwrap",this._getAlphaRange(t.sheetIndex,t.unwrapCells[i].rowIndex,t.unwrapCells[i].colIndex,t.unwrapCells[i].rowIndex,t.unwrapCells[i].colIndex));for(i=0,u=t.wrapCells.length;i<u;i++)this.setWrapText("wrap",this._getAlphaRange(t.sheetIndex,t.wrapCells[i].rowIndex,t.wrapCells[i].colIndex,t.wrapCells[i].rowIndex,t.wrapCells[i].colIndex));r=t.unwrapCells;t.unwrapCells=t.wrapCells;t.wrapCells=r;r=t.beforeData;t.beforeData=t.afterData;t.afterData=r},_undoForFormatTable:function(i){var f,k,h,c,e,o,a,v,l,y=0,s=i.sheetIndex,r=this.getSheet(s)._tableManager,it,u=i.header,p,w,b;switch(i.action){case"convertorange":this._isUndo?(r[i.tableID]={name:"Table"+i.tableID,range:i.beforeRange,format:i.format,formatName:i.formatName},this.XLFilter._filterCellRange(s,this._getProperAlphaRange(s,r[i.tableID].range[0],r[i.tableID].range[1],r[i.tableID].range[2],r[i.tableID].range[3])),this.updateUniqueData({tableName:"e-table"+i.tableID},r[i.tableID].range),this.model.sheets[s].filterSettings.tableRange[i.tableID]=i.tableRange,r[i.tableID].isFilter=i.isFilter,r[i.tableID].firstColumn=i.firstColumn,r[i.tableID].lastColumn=i.lastColumn,r[i.tableID].totalRow=i.totalRow):i.tableID in r&&(it="e-table"+i.tableID,this.XLFormat.removeTable(i.tableID),this.XLFilter._clearFilterTable(s,i.tableID),delete r[i.tableID],delete this.model.sheets[s]._header[i.tableID]);break;case"filtericon":p=n("#"+i.id).data("ejCheckBox");w=i.tableId;i.check?p.option("checked",!1):p.option("checked",!0);r[w].isFilter=!i.check;i.check=!i.check;this.XLFilter._clearFilterTableIcon(i.sheetIndex,w);break;case"firstlastcolumn":b=n("#"+i.id).data("ejCheckBox");i.check?(this.XLFormat.format({style:{"font-weight":"normal"}},i.range),b.option("checked",!1)):(this.XLFormat.format({style:{"font-weight":"bold"}},i.range),b.option("checked",!0));r[i.tableId][i.prop]=!i.check;i.check=!i.check;break;case"totalrow":var d=i.cell[0],g=i.cell[i.cell.length-1],nt=n("#"+i.id).data("ejCheckBox"),rt=i.tmgr[i.tableId].range,tt;i.check?(this.XLEdit.updateCellValue(d,i.pcells[0].value2),this.XLEdit.updateCellValue(g,i.pcells[1].value2),"totalRow"in i.tmgr[i.tableId]&&delete i.tmgr[i.tableId].totalRow,nt.option("checked",!1)):(this.XLEdit.updateCellValue(d,"Total"),r[i.tableId].fnNumber=i.fnNumber,this.XLEdit.updateCellValue(g,"=SUBTOTAL("+r[i.tableId].fnNumber+", "+i.range+")"),i.tmgr[i.tableId].totalRow=!0,nt.option("checked",!0));tt=i.pcells;i.pcells=i.curCells;i.curCells=tt;i.check=!i.check;break;case"resizetable":this._isUndo?(this._isFATResize=!0,e=r[i.tableId].name,this.XLFormat.removeTable(i.tableId),this.XLRibbon.removeNamedRange(e),this.XLFormat.removeStyle(i.afterRange),h=i.beforeRange[3]-i.beforeRange[1]+1,o=u[i.tableId].header?this.getRangeData(i.beforeRange):this.getRangeData(i.beforeRange).splice(h,this.getRangeData(i.beforeRange).length),this.clearRangeData(i.beforeRange),u[i.tableId].header?this.updateData(o,[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2],i.beforeRange[3]]):this.updateData(o,[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2]-1,i.beforeRange[3]]),r[i.tableId]={header:u[i.tableId].header,name:"Table"+i.tableId,range:i.beforeRange,format:i.format,formatName:i.formatName},u[i.tableId].header?this.XLFormat.createTable(r[i.tableId],i.beforeRange):this.XLFormat.createTable(r[i.tableId],[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2]-1,i.beforeRange[3]])):(this._isFATResize=!0,e=r[i.tableId].name,this.XLFormat.removeTable(i.tableId),this.XLRibbon.removeNamedRange(e),this.XLFormat.removeStyle(i.beforeRange),h=i.beforeRange[3]-i.beforeRange[1]+1,o=u[i.tableId].header?this.getRangeData(i.afterRange):this.getRangeData(i.afterRange).splice(h,this.getRangeData(i.afterRange).length),this.clearRangeData(i.afterRange),u[i.tableId].header?this.updateData(o,i.afterRange):this.updateData(o,[i.afterRange[0],i.afterRange[1],i.afterRange[2]-1,i.afterRange[3]]),r[i.tableId]={header:u[i.tableId].header,name:"Table"+i.tableId,range:i.beforeRange,format:i.format,formatName:i.formatName},u[i.tableId].header?this.XLFormat.createTable(r[i.tableId],i.afterRange):this.XLFormat.createTable(r[i.tableId],[i.afterRange[0],i.afterRange[1],i.afterRange[2]-1,i.afterRange[3]]));break;default:if(this._isUndo){if(e=r[i.tableID].name,this.XLFormat.removeTable(i.tableID),this.XLRibbon.removeNamedRange(e),this.XLFormat.removeStyle(i.afterRange),i.tableStyle.header)for(f=0,k=i.beforeRangeHeader.length;f<k;f++)t.isNullOrUndefined(i.beforeRangeHeader[f].value2)?this.XLEdit.updateCellValue(this._getCellIdx(i.pcells[f]),""):this.isNumber(i.pcells[f].innerHTML)&&this.XLEdit._refreshCellAlignment({cellIdx:i.pcells[f]});else h=i.afterRange[3]-i.afterRange[1]+1,this.clearRangeData(i.afterRange),this.updateData(n.extend(!0,[],i.beforeRangeData),i.afterRange);if(this.XLFormat.updateFormat(i.beforeFormat,i.afterRange),a=i.beforeMergeRange,v=a.length,v)while(y<v)l=a[y].value,l&&(c=this.getRangeIndices(l.mRange),selCell=this.XLSelection._getSelectedRange({rowIndex:c[0],colIndex:c[1]},{rowIndex:c[2],colIndex:c[3]}),this._mergeCenter=l.isCenterAlign,this._mergeCells(i.sheetIndex,selCell,{},[])),y++}else this.XLFormat.createTable(i.tableStyle,i.beforeRange)}},_autosumFormatUpdate:function(n,t,i,r){var f={},u,e=this.getActiveSheetIndex();n.type!=="general"&&(this._dupDetails=!0,f.type=n.type,u=i?this._getAlphaRange(e,t[2]+1,t[3],t[2]+1,t[3]):this._getAlphaRange(e,t[0],t[1],t[2],t[3]),r?this.XLFormat.format({type:"general"},u+":"+u):this.XLFormat.format(f,u+":"+u),this._dupDetails=!1)},_undoForHyperlink:function(n){var i={rowIndex:n.selCells[n.selCells.length-1].rowIndex,colIndex:n.selCells[n.selCells.length-1].colIndex},r={rowIndex:n.selCells[0].rowIndex,colIndex:n.selCells[0].colIndex},t,u,f,e;for(this.setActiveCell(n.selCells[0].rowIndex,n.selCells[0].colIndex),this.XLSelection.selectRange(r,i),n.action==="add"?this._removeHyperlink(n.reqType,n.selCells):n.action==="edit"?this._setLink(n.selCells):this._setLink(n.selCells),t=0,u=n.selCells.length;t<u;t++)f=n.selCells[t].prevLink,n.selCells[t].prevLink=n.selCells[t].curLink,n.selCells[t].curLink=f,e=n.selCells[t].prevText,n.selCells[t].prevText=n.selCells[t].curText,n.selCells[t].curText=e;n.action==="add"?n.action="delete":n.action==="delete"&&(n.action="add");this.XLSelection.selectRange(r,i);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForIns:function(t){n.extend(!0,this._delCells,t.delCells);n.extend(!0,this._deletedText,t.text);n.extend(!0,this._removeMergeColl,t.removeMerge);switch(t.action){case"insertShiftRight":this.insertShiftRight(t.startCell,t.endCell);break;case"insertShiftBottom":this.insertShiftBottom(t.startCell,t.endCell);break;case"insertRow":this.insertEntireRow(t.startCell.rowIndex,t.endCell.rowIndex);break;case"insertColumn":this.insertEntireColumn(t.startCell.colIndex,t.endCell.colIndex)}},_undoForMerge:function(n){var r,u,s,e,f,h,i,o;this._delCells=n.hideCells;this._selMergeCells=[];switch(n.action){case"merge-all":case"merge-across":case"un-merge":for(i=0,o=n.mCells.length;i<o;i++)e=t.isNullOrUndefined(n.mCells[i].prevObj)?{}:t.isNullOrUndefined(n.mCells[i].prevObj.merge)?{}:n.mCells[i].prevObj.merge,f=t.isNullOrUndefined(n.mCells[i].curObj)?{}:t.isNullOrUndefined(n.mCells[i].curObj.merge)?{}:n.mCells[i].curObj.merge,n.action==="un-merge"?t.isNullOrUndefined(e.mRange)||(r=this.getRangeIndices(e.mRange),u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),this._mergeCenter=e.isCenterAlign,this._mergeCells(n.sheetIndex,u,{},[])):(s=this._getHiddenRowColumnCount(n.sheetIndex,f.mRange),this._unMergeAllCells(n.sheetIndex,i,n.mCells,[],s.hRow,s.hCol)),h=n.mCells[i].prevObj,n.mCells[i].prevObj=n.mCells[i].curObj,n.mCells[i].curObj=h;if(n.action!=="un-merge")for(i=0,o=n.mCells.length;i<o;i++)e=t.isNullOrUndefined(n.mCells[i].prevObj)?{}:t.isNullOrUndefined(n.mCells[i].prevObj.merge)?{}:n.mCells[i].prevObj.merge,f=t.isNullOrUndefined(n.mCells[i].curObj)?{}:t.isNullOrUndefined(n.mCells[i].curObj.merge)?{}:n.mCells[i].curObj.merge,t.isNullOrUndefined(f.mRange)||(r=this.getRangeIndices(f.mRange),u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),this._mergeCenter=f.isCenterAlign,this._mergeCells(n.sheetIndex,u,{},[]));n.action=n.action==="un-merge"?"merge-all":"un-merge"}r=this._getSelectedCells(n.sheetIndex,n.range);u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]});this.performSelection(u[0],u[u.length-1]);this._delCells=[]},_undoForReOrder:function(i){var r=this.getSheet(i.sheetIndex);this._isUndo?(this.XLComment.deleteComment(),this.clearRangeData(i.destinationRange),this.XLFormat.removeStyle(i.destinationRange),this.XLCFormat.clearCF(!0,i.destinationRange),this.updateData(n.extend(!0,[],i.sourceData),i.sourceRange),this.updateData(n.extend(!0,[],i.destinationData),i.destinationRange),this.XLFormat.updateFormat(i.sourceFormat,i.sourceRange),this.XLFormat.updateFormat(i.destinationFormat,i.destinationRange),this.isUndefined(i.sourceCFormat)||this.XLCFormat.setCFRule(i.sourceCFormat),this.setActiveCell(i.sourceRange[0],i.sourceRange[1]),this.XLSelection.selectRange({rowIndex:i.sourceRange[0],colIndex:i.sourceRange[1]},{rowIndex:i.sourceRange[2],colIndex:i.sourceRange[3]},i.sheetIndex),r._startCell={rowIndex:i.sourceRange[0],colIndex:i.sourceRange[1]},r._endCell={rowIndex:i.sourceRange[2],colIndex:i.sourceRange[3]},this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()):(this.XLSelection.selectRange({rowIndex:i.sourceRange[0],colIndex:i.sourceRange[1]},{rowIndex:i.sourceRange[2],colIndex:i.sourceRange[3]},i.sheetIndex),this.XLComment.deleteComment(),this.clearRangeData(i.sourceRange),this.clearRangeData(i.destinationRange),t.isNullOrUndefined(this.XLEdit.getPropertyValue(i.sourceRange[0],i.sourceRange[1],"tableName"))&&this.XLFormat.removeStyle(i.sourceRange),t.isNullOrUndefined(this.XLEdit.getPropertyValue(i.destinationRange[0],i.destinationRange[1],"tableName"))&&this.XLFormat.removeStyle(i.destinationRange),this.XLCFormat.clearCF(!0,i.sourceRange),this.updateData(n.extend(!0,[],i.sourceData),i.destinationRange),this.XLFormat.updateFormat(i.sourceFormat,i.destinationRange),this.isUndefined(i.destinationCFormat)||this.XLCFormat.setCFRule(i.destinationCFormat),this.setActiveCell(i.destinationRange[0],i.destinationRange[1]),this.XLSelection.selectRange({rowIndex:i.destinationRange[0],colIndex:i.destinationRange[1]},{rowIndex:i.destinationRange[2],colIndex:i.destinationRange[3]},i.sheetIndex),r._startCell={rowIndex:i.destinationRange[0],colIndex:i.destinationRange[1]},r._endCell={rowIndex:i.destinationRange[2],colIndex:i.destinationRange[3]},this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())},_undoForPivot:function(n){var t=this._isUndo?this._undoCollection:this._redoCollection,i={curOperation:n,prevOperation:t[t.length-1],isUndo:this._isUndo};this._trigger("_readUndoRedo",i)},_undoForResizeCol:function(n){this.XLResize.setColWidth(n.colIndex,n.oldWidth);var t=n.oldWidth;n.oldWidth=n.newWidth;n.newWidth=t;this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForResizeRow:function(n){this.XLResize.setRowHeight(n.rowIndex,n.oldHeight);var t=n.oldHeight;n.oldHeight=n.newHeight;n.newHeight=t;this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForResizeFHeight:function(n){this.XLResize.setRowHeight(n.rowIndex,n.newHeight);this.getFrozenRows(n.sheetIndex)>=n.rowIndex&&this._refreshFreezeColumns(n.sheetIndex,n.rowIndex,n.newHeight-n.oldHeight,"resize");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForResizeFWidth:function(n){var t=this.getCell(0,n.colIndex).get(0),i=n.newWidth;n.newWidth=t.offsetWidth===n.oldWidth?n.newWidth:n.oldWidth;n.oldWidth=i;this.XLResize._applyWidth(n.target,n.sheetIndex,n.colIndex,n.newWidth);this.XLScroll._getColWidths(n.sheetIndex,n.colIndex);this.getFrozenColumns(n.sheetIndex)>=this._currentHCell&&this._refreshFreezeColumns(n.sheetIndex,n.colIndex,n.newWidth-n.oldWidth,"resize");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForShape:function(i){var u,r,v,g,nt=0,b,ot=this.getSheet(i.sheetIndex)._shapeMngr,y,p,c,l,rt,h,ut,w,ft,d,s,e,a,et;this.model.showRibbon&&(b=this.XLRibbon._chartThemes);i.action!=="create"&&i.action!=="remove"&&i.action!=="edit"&&i.action!=="border"&&i.action!=="resetpic"&&i.action!=="changepic"&&i.action!=="picturesize"&&i.action!=="chartTheme"&&i.action!=="chartType"&&i.action!=="selectData"&&(u=n("#"+i.cid).data("ejChart"),r=this.getSheet(i.sheetIndex)._shapeMngr.chart[this.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"chart")[0]]);switch(i.action){case"remove":this.XLShape._picCellIdx=this.XLShape._getCellIndexFromOffset(i.position.top,i.position.left);this.XLShape._deleteShape(i.sheetIndex,n("#"+i.id));i.action="create";break;case"create":i.shapeType==="picture"?(this.XLShape._createPicture(i.sheetIndex,i.actCell,i.img,i.position.top,i.position.left,i.position.width,i.position.height,i.cnt),this.XLRibbon._formatTabUpdate(),n(i.actCell).addClass("e-activecell")):(this.XLSelection.selectRange({rowIndex:i.range[0],colIndex:i.range[1]},{rowIndex:i.range[0],colIndex:i.range[1]},i.sheetIndex),this.setActiveCell(i.range[0],i.range[1],i.sheetIndex),this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,i.range[0],i.range[1],i.range[2],i.range[3]),i.options,i.id));i.action="remove";break;case"edit":var tt,s=this._dataContainer.sheets[i.sheetIndex],o=i.id.split("_")[1].replace(/[0-9]/g,""),k={},it,f;n("#"+i.id).css({left:i.prev.left,top:i.prev.top,height:i.prev.height,width:i.prev.width});o==="chart"&&this.XLChart.resizeChart(i.id,i.prev.height,i.prev.width);i.visualImg.hide();this.XLShape._picCellIdx=this.XLShape._getCellIndexFromOffset(i.prev.top,i.prev.left);f=this.XLShape._getCellIndexFromOffset(i.cur.top,i.cur.left);tt=this._getShapePositionInManager(f.rowIndex,f.colIndex,i.id,o);k[o]=i.obj[o][tt];this.XLEdit._updateDataContainer({rowIndex:this.XLShape._picCellIdx.rowIndex,colIndex:this.XLShape._picCellIdx.colIndex},{dataObj:k});i.actionType!="resize"&&(this.getObjectLength(s[f.rowIndex][f.colIndex])<2&&s[f.rowIndex][f.colIndex][o].length<2?delete s[f.rowIndex][f.colIndex]:s[f.rowIndex][f.colIndex][o].length<2?delete s[f.rowIndex][f.colIndex][o]:(s[f.rowIndex][f.colIndex][o].some(function(n,t){if(k.id===n.id)return it=t,!0}),s[f.rowIndex][f.colIndex][o].splice(it,1)));this.getCell(this.XLShape._picCellIdx.rowIndex,this.XLShape._picCellIdx.colIndex,i.sheetIndex).addClass("e-activecell");this.model.showRibbon&&this.element.find(".e-ss-activeimg").length<1&&(o==="picture"?this.XLRibbon._toggleFormatTab():this.XLRibbon._toggleChartDesignTab());this._swapVal(i);break;case"PHAxis":case"PVAxis":y=i.action=="PHAxis"?"primaryXAxis":"primaryYAxis";p=i.action==="PHAxis"?"xAxis":"yAxis";i.visibility=!i.visibility;u.option(y,{visible:i.visibility});r[p].visible=i.visibility;break;case"PX":case"PY":y=i.action=="PX"?"primaryXAxis":"primaryYAxis";p=i.action==="PX"?"xAxis":"yAxis";t.isNullOrUndefined(i.prev.text)&&(i.prev.text="");u.option(y,{title:{text:i.prev.text}});r[p].title.text=i.prev.text;this._swapVal(i);break;case"CT":u.option("title",{textAlignment:i.prev.align,text:i.prev.text});r.title={text:i.prev.text,textAlignment:i.prev.align};this._swapVal(i);break;case"DLNone":u.option({series:i.prev.series});r.dataLabel={visible:i.prev.series[0].marker.dataLabel.visible};this._swapVal(i);break;case"DL":u.option({series:i.prev.series});r.dataLabel={visible:i.prev.series[0].marker.dataLabel.visible,vAlign:i.prev.series[0].marker.dataLabel.verticalTextAlignment,tPosn:i.prev.series[0].marker.dataLabel.textPosition};this._swapVal(i);break;case"PMajorH":i.visibility=!i.visibility;u.option("primaryYAxis",{majorGridLines:{visible:i.visibility}});r.yAxis.majorGridLines={visible:i.visibility};break;case"PMajorV":i.visibility=!i.visibility;u.option("primaryXAxis",{majorGridLines:{visible:i.visibility}});r.xAxis.majorGridLines={visible:i.visibility};break;case"PMinorH":i.visibility=!i.visibility;u.option("primaryYAxis",{minorGridLines:{visible:i.visibility},minorTicksPerInterval:5,minorTickLines:{visible:i.visibility}});r.yAxis.minorGridLines={visible:i.visibility};break;case"PMinorV":i.visibility=!i.visibility;u.option("primaryXAxis",{minorGridLines:{visible:i.visibility},minorTicksPerInterval:5,minorTickLines:{visible:i.visibility}});r.xAxis.minorGridLines={visible:i.visibility};break;case"LNone":i.visibility=!i.visibility;u.option("legend",{visible:i.visibility});r.legend.visible=i.visibility;break;case"Legend":u.option("legend",{position:i.prev.position});r.legend.position=i.prev.position;this._swapVal(i);break;case"width":c={width:i.prev.width,height:i.prev.height};l=n("#"+u._id);u.option("size",n.extend(!0,{},c));l[0].style.height=i.prev.height+"px";l[0].style.width=i.prev.width+"px";r.width=i.prev.width;r.height=i.prev.height;this.XLRibbon._setChartWidthHeight(c);this._swapVal(i);break;case"height":c={width:i.prev.width,height:i.prev.height};l=n("#"+u._id);u.option("size",n.extend(!0,{},c));l[0].style.height=i.prev.height+"px";l[0].style.width=i.prev.width+"px";r.width=i.prev.width;r.height=i.prev.Height;this.XLRibbon._setChartWidthHeight(c);this._swapVal(i);break;case"srcolumn":u.model.series.length=0;r.isRowColSwitched=!r.isRowColSwitched;rt={xRange:r.xRange,yRange:r.yRange,lRange:r.lRange,isRowColSwitched:r.isRowColSwitched,dataSheetIdx:r.dataSheetIdx};h=this.XLChart._processChartSeries(rt);u.option({series:h.series});this.getActiveSheetIndex()===r.dataSheetIdx&&this.XLChart._focusChartRange(h.xRange,h.yRange,h.lRange);r.xAxis.range=h.xRange;r.yAxis.range=h.yRange;r.legend.range=h.lRange;break;case"border":ft=this._dataContainer.sheets[i.sheetIndex][i.cellIdx.rowIndex][i.cellIdx.colIndex].picture[i.picIdx];e=n("#"+i.id);this._removeClass(e[0],i.curClass);this.addClass(e[0],i.prevClass);w=this.XLShape._getImgStyleFromHashCode(i.prevClass);ft={bcolor:w["border-color"],bstyle:w["border-style"],bwidth:w["border-width"]};ut=i.prevClass;i.prevClass=i.curClass;i.curClass=ut;break;case"resetpic":e=n("#"+i.id);d=new RegExp("\\be-shapebdr.*?\\b","g");this._isUndo?t.isNullOrUndefined(e[0].className.match(d))&&this.XLShape._updateImgBorder(e[0],i.prev.bwidth,i.prev.bstyle,i.prev.bcolor):e[0].className=e[0].className.replace(d,"");i.actionType!=="resetpicture"&&(e.css({width:i.prev.width,height:i.prev.height}),this.XLShape._selectImg(e),this.XLShape._updateShapeObj(e[0]));this._swapVal(i);break;case"changepic":s=this._dataContainer;n("#"+i.id).css("background-image","url('"+i.prev.img+"')");ot.picture[i.prev.pcIdx].data=i.prev.data;this._swapVal(i);break;case"picturesize":e=n("#"+i.id);e.css({width:i.prev.width,height:i.prev.height});this._swapVal(i);break;case"chartTheme":for(v=this.element.find("#"+this._id+"_chart").val(),g=n("#"+this._id+"_Ribbon_chartTheme").data("ejDropDownList"),i.prev.theme.indexOf("dark")>-1?n("#"+v).addClass("e-ss-charttheme"):n("#"+v).removeClass("e-ss-charttheme"),this.XLChart.refreshChart(v,{theme:i.prev.theme}),a=0,et=b.length;et>a;a++)if(i.prev.theme===b[a].value.toLowerCase()){nt=a;break}g.option({selectedItemIndex:nt});this._swapVal(i);break;case"chartType":this.XLChart.refreshChart(i.chartId,{type:i.prev.chartType,enable3D:i.prev.enable3D,marker:i.prev.marker});this._swapVal(i);break;case"selectData":this.XLChart._processChartRange(i.prev.xRange,i.prev.yRange,i.prev.lRange,document.getElementById(this._id+"_chart").value);this._swapVal(i)}},_undoForShowHide:function(n){var t,i,r,u,f,e,o;if(n.operation==="row"){for(r=this._getJSSheetRowHeaderContent(n.sheetIndex),t=0,i=n.hideRows.length;t<i;t++)n.action==="show"?this._hideRow(n.hideRows[t],n.hideRows[t],"isRHide"):this._showRow(n.hideRows[t],n.hideRows[t],"isRHide");for(t=0,i=n.remBRows.length;t<i;t++)this.addClass(r.find("td")[n.remBRows[t]],"e-hrow"),this.XLEdit._updateDataContainer({rowIndex:n.remBRows[t],colIndex:0},{dataObj:{hRow:!0}});for(t=0,i=n.addBRows.length;t<i;t++)this._removeClass(r.find("td")[n.addBRows[t]],"e-hrow"),this._dataContainer.sheets[n.sheetIndex][n.addBRows[t]][0].hRow;this.setActiveCell(n.bSelect.startRow,0);n.bSelect.startRow===n.bSelect.endRow?this.XLSelection.selectRow(n.bSelect.startRow,n.sheetIndex):this.XLSelection.selectRows(n.bSelect.startRow,n.bSelect.endRow,n.sheetIndex);f=n.addBRows;n.addBRows=n.remBRows;n.remBRows=f}else{for(u=this._getJSSheetHeader(n.sheetIndex).find("th"),t=0,i=n.hideCols.length;t<i;t++)n.action==="show"?this._hideColumn(n.hideCols[t],n.hideCols[t]):this._showColumn(n.hideCols[t],n.hideCols[t]);for(t=0,i=n.remBCols.length;t<i;t++)this.XLEdit._updateDataContainer({rowIndex:0,colIndex:n.remBCols[t]},{dataObj:{hCol:!0}}),this.addClass(u[n.remBCols[t]],"e-hcol");for(t=0,i=n.addBCols.length;t<i;t++)this._removeClass(u[n.addBCols[t]],"e-hcol"),this._dataContainer.sheets[n.sheetIndex][0][n.addBCols[t]].hCol;this.setActiveCell(0,n.bSelect.startCol);n.bSelect.startCol===n.bSelect.endCol?this.XLSelection.selectColumn(n.bSelect.startCol,n.sheetIndex):this.XLSelection.selectColumns(n.bSelect.startCol,n.bSelect.endCol,n.sheetIndex);e=n.addBCols;n.addBCols=n.remBCols;n.remBCols=e}n.action=n.action==="show"?"hide":"show";o=n.bSelect;n.bSelect=n.aSelect;n.aSelect=o;this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForSort:function(n){var o=this.XLEdit.getColumnIndexByField(n.columnName),u,i,r,f,e=this.getSheet(n.sheetIndex)._filterColl,t;if(n.colSelected<1&&(f=n.range[0],n.range[0]>0&&(f=n.range[0]-1)),n.operation==="unsort"?(this._dupDetails=!0,this.XLComment.deleteComment(n.range,null,!0,null),this._removeHyperlink(null,null,!0),this.clearRangeData(n.range,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0),this.XLFormat.removeStyle(n.range,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0}),this.XLEdit.updateCellWithContainer(n.rangeData,n.range,n.sheetIndex,!0),this._dupDetails=!1,n.operation="sort"):(this.XLSort._isSortByFilter=n.isSortByFilter,this.XLSort.sortByRange(n.range,n.columnName,n.direction),n.operation="unsort"),n.isSortByFilter)for(t=0;t<n.filterIcons.length;t++)r=e[n.filterIcons[t].rowIdx][n.filterIcons[t].colIdx],r.status=r.status.indexOf("-asc")>1?r.status.replace("-asc",n.filterIcons[t].prevIcon):r.status.indexOf("-dsc")>1?r.status.replace("-dsc",n.filterIcons[t].prevIcon):r.status+n.filterIcons[t].prevIcon,this._isRowViewable(n.sheetIndex,n.filterIcons[t].rowIdx)&&(i=this.getCell(n.filterIcons[t].rowIdx,n.filterIcons[t].colIdx).find(".e-filterspan")[0],i.className=i.className.indexOf("-asc")>1?i.className.replace("-asc",n.filterIcons[t].prevIcon):i.className.indexOf("-dsc")>1?i.className.replace("-dsc",n.filterIcons[t].prevIcon):i.className.indexOf("e-ssfiltered")>-1?i.className.replace("e-ssfiltered","e-ssfiltered"+n.filterIcons[t].prevIcon):i.className.replace("e-ssfilter","e-ssfilter"+n.filterIcons[t].prevIcon)),u=n.filterIcons[t].prevIcon,n.filterIcons[t].prevIcon=n.filterIcons[t].currIcon,n.filterIcons[t].currIcon=u},_undoForSortByColor:function(n){var t=n.range,r=n.prev.data,u=this.getCell(t[0]-1,t[1]),i;this.XLComment.deleteComment(t,null,!0,null);this._isSort=!0;this._dupDetails=!0;this._removeHyperlink(null,null,!0);this._isSort=!1;this._dupDetails=!1;this.clearRangeData(t,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0);this.XLFormat.removeStyle(t,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0});this.XLEdit.updateCellWithContainer(r,t,n.sheetIndex,!0);i=u.find(".e-filterspan");i.length>0&&(i[0].className=i[0].className.replace(n.cur.icon,n.prev.icon));this._swapVal(n)},_undoForStyle:function(n){this.XLFormat.removeStyle(n.range,{cellStyle:!0,format:!0});this.updateRangeData(n.range,n.beforeFormat);var t=this.changePosition(n.beforeFormat,n.afterFormat);this._refreshRangeTRHght(this.getActiveSheetIndex(),n.range);n.beforeFormat=t[1];n.afterFormat=t[0];this._isUndoRedo=!0;n.status="undo-cellstyles"},_undoForTextWrap:function(n){n.operation==="wrap"?(this.setWrapText("unwrap",n.range),n.operation="unwrap"):(this.setWrapText("wrap",n.range),n.operation="wrap");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForValidation:function(n){var i,f,e=this.getRangeIndices(n.range),r,u,s,o;if(this.performSelection({rowIndex:e[0],colIndex:e[1]},{rowIndex:e[2],colIndex:e[3]}),n.operation==="cl-hl-data")this.XLValidate.highlightInvalidData(n.range),n.operation="hl-data";else if(n.operation==="apply-validation"){for(r=n.selectedCells,o=[],i=0,f=r.length;i<f;i++)s=this.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"rule"),u=this.changePosition(r[i].prevRule,s),n.selectedCells[i].prevRule=u[1],t.isNullOrUndefined(u[0])||(u[0].customVal=u[0].customVal,this.XLEdit._updateDataContainer({rowIndex:r[i].rowIndex,colIndex:r[i].colIndex},{dataObj:{rule:u[0]}})),o.push(r[i]);t.isNullOrUndefined(u[0])&&this.clearRangeData(null,["rule"],o)}else if(n.operation==="hl-data")this.XLValidate.clearHighlightedValData(n.range),n.operation="cl-hl-data";else if(this._isUndo){for(i=0,f=n.selCells.length;i<f;i++)this.XLEdit._updateDataContainer({rowIndex:n.selCells[i].rowIndex,colIndex:n.selCells[i].colIndex},{dataObj:{rule:n.selCells[i].rules}});n.hlStatus&&this.XLValidate.highlightInvalidData(n.range)}else this.XLValidate.clearDV(n.range)},_applyCommentLink:function(i,r,u,f){var l=this._dataContainer,p=l.cFormatData,e,c=!1,a,v,o,h,y,s;if(this._isRowViewable(this.getActiveSheetIndex(),r.rowIndex)&&(e=this.getCell(r.rowIndex,r.colIndex),c=!0,n(e).removeClass("e-redft e-yellowft e-greenft e-redf e-redt")),i){if(a=this.isNumber(i.value2)?l.sharedData[i.value2]:i.value2,this.XLEdit.updateCellValue(r,a),"comment"in i&&(c&&e.removeClass("e-commentcell"),this.XLComment.setComment([r.rowIndex,r.colIndex,r.rowIndex,r.colIndex],null,!1)),"cFormatRule"in i)for(v=i.cFormatRule,h=0,y=v.length;h<y;h++)o=p[h].split("_"),this.XLCFormat._cFormat(o[0],o[2],o[3],o[4],null,null,[u,f,u,f]);"hyperlink"in i&&(s=i.hyperlink,c&&(s&&!s.webAddr?e.html(t.buildTag("a.e-hyperlinks",e.text(),"",{href:"#"})):e.html(t.buildTag("a.e-hyperlinks",e.text(),"",{href:s.webAddr,target:"_blank"}))))}},changePosition:function(n,i){var r=[];return r.push(i),r.push(n),t.swap(r,0,1),r},_addValidationRule:function(t,i){var u=[],r,f;for(n.extend(!0,u,t),r=0,f=t.length;r<f;r++)t[r].customVal!==i.customVal&&t[r].required!==i.required&&t[r].Number!==i.number&&u.push(i);return u},_addCondFormatRule:function(t,i){var f=!1,u=[],r,e;for(n.extend(!0,u,t),r=0,e=t.length;r<e;r++)if(i=i.indexOf("true")>-1?i.replace("_true",""):i.replace("_false",""),t[r]===i){f=!0;break}return f||u.push(i),u},getCellClass:function(n){var t=this._formatRegx;return n&&n.className.indexOf("e-format")>-1?n.className.match(t)[0]:""},_renderInsertDeleteDialog:function(){var n=this._id+"_insertdeletedlg",i,e,r,u,f,o;i=t.buildTag("div#"+n,"",{display:"none"});e=t.buildTag("div#"+n+"_content.e-dlg-fields e-dlgctndiv");i.append(e);f=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");o=t.buildTag("div");r=t.buildTag("input#"+n+"_okbtn","",{"margin-left":4});u=t.buildTag("input#"+n+"_cantn");r.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:"40%",click:t.proxy(this._insertDeleteOk,this),enabled:!0});u.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._insertDeleteCancel,this),showRoundedCorner:!0,width:"40%"});f.append(o.append(r,u));i.append(f);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,width:187,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg",minWidth:150})},_renderInsertDialog:function(){var t=n("#"+this._id+"_insertdeletedlg"),i,r;t.ejDialog({title:this._getLocStr("Insert")});t.ejDialog("open");this._insDelStatus="insert";i=n("#"+t[0].id+"_content");r=["shiftright","shiftbottom","entirerow","entirecolumn"];i.children().empty();this._createRadioButton(t,i,r);n("#"+t[0].id+"_shiftbottom").ejRadioButton({checked:!0});t.find("input[type='submit']:first").focus()},_renderDeleteDialog:function(){var t=n("#"+this._id+"_insertdeletedlg"),i,r;t.ejDialog({title:this._getLocStr("Delete")});t.ejDialog("open");this._insDelStatus="delete";i=n("#"+t[0].id+"_content");r=["shiftleft","shiftup","entirerow","entirecolumn"];i.children().empty();this._createRadioButton(t,i,r);n("#"+t[0].id+"_shiftleft").ejRadioButton({checked:!0});t.find("input[type='submit']:first").focus()},_createRadioButton:function(n,i,r){var o,h,s,e,u,f,c;for(s=t.buildTag("table"),f=0,c=r.length;f<c;f++)e=t.buildTag("tr"),u=t.buildTag("td"),h=t.buildTag("label",this._getLocStr(r[f]),{"padding-bottom":4},{"for":n[0].id+"_"+r[f]}),o=t.buildTag("input#"+n[0].id+"_"+r[f],"",{},{type:"radio",name:"inserdelete"}),u.append(o),e.append(u),u=t.buildTag("td"),u.append(h),o.ejRadioButton({size:"medium"}),e.append(u),s.append(e);i.append(s)},_getSelectedOption:function(t){for(var u,f=this._id+"_insertdeletedlg",r=0,i=0;i<4;i++)if(u=n("#"+f+"_"+t[i]).data("ejRadioButton"),u.model.checked){r=i;break}return r},_insertDeleteOk:function(){var o,f;this._isUndo=!1;this._isUndoRedo=!1;this._delCells=[];this._deletedText=[];this._removeMergeColl=[];this._deletedDimension=[];var t,i,e=this.getActiveSheetIndex(),r=this.model.sheets[e]._selectedCells[0],u=this.model.sheets[e]._selectedCells[this.model.sheets[e]._selectedCells.length-1];for(this._insDelStatus.indexOf("insert")>-1?(t=["shiftright","shiftbottom","entirerow","entirecolumn"],i=this._getSelectedOption(t),t[i].indexOf("shiftright")>-1?this.insertShiftRight(r,u):t[i].indexOf("shiftbottom")>-1?this.insertShiftBottom(r,u):t[i].indexOf("entirerow")>-1?this.insertEntireRow(r.rowIndex,u.rowIndex):this.insertEntireColumn(r.colIndex,u.colIndex)):(t=["shiftleft","shiftup","entirerow","entirecolumn"],i=this._getSelectedOption(t),t[i].indexOf("shiftleft")>-1?this.deleteShiftLeft(r,u):t[i].indexOf("shiftup")>-1?this.deleteShiftUp(r,u):t[i].indexOf("entirerow")>-1?this.deleteEntireRow(r.rowIndex,u.rowIndex):this.deleteEntireColumn(r.colIndex,u.colIndex)),n("#"+this._id+"_insertdeletedlg").ejDialog("close"),o=this.model.sheets[this.model.activeSheetIndex]._shapeMngr.chart,f=0;f<o.length;f++)this.XLChart._refreshChart(o[f])},_insertDeleteCancel:function(){n("#"+this._id+"_insertdeletedlg").ejDialog("close")},_undoredoDetails:function(n,t,i,r,u){var f={sheetIndex:n,startCell:t,endCell:i,reqType:r,action:u,delCells:this._delCells,text:this._deletedText,deletedDimension:this._deletedDimension,removeMerge:this._removeMergeColl};this.isImport||this._completeAction(f);this._removeMergeColl=[]},_getRangeFrmFormula:function(n){var t=n.substring(n.indexOf("(")+1,n.indexOf(")")),i=new RegExp("^\\b[a-zA-Z][0-9]*:[a-zA-Z][0-9]*\\b$","g");if(i.test(t))return t;if(t.indexOf(",")>1){if(i.test(t.split(",")[1]))return t.split(",")[1];if(i.test(t.replace(",",":")))return t.replace(",",":")}},_refreshFormula:function(n,i,r,u,f,e,o){var v=this.getActiveSheetIndex(),c,h,a=this.XLEdit.getPropertyValue(n,i,"value"),l,y,s,p,w=this.getSheet(v);if((!this._isUndo||this._formulaChanged.pop()!=="true")&&this.isFormula(a)){if(l=this._getRangeFrmFormula(a),t.isNullOrUndefined(l))return;s=this.getRangeIndices(l);c=f==="column"?u==="insert"?s[3]+r:s[3]-r:u==="insert"?s[2]+r:s[2]-r;h=f==="column"?u==="insert"?s[1]+r:s[1]-r:u==="insert"?s[0]+r:s[0]-r;f==="column"?e>s[1]&&(h=s[1]):e>s[0]&&(h=s[0]);f==="column"?e>s[3]&&(c=s[3]):e>s[2]&&(c=s[2]);o&&(s[1]===s[3]||s[0]!==s[2]||(f==="column"?s[1]===s[3]&&(c=s[3],h=s[1]):s[0]===s[2]&&(c=s[2],h=s[0])),f==="column"?c<s[1]&&(c=s[3]):c<s[0]&&(c=s[2]),f==="column"?h<s[1]&&(h=s[1]):h<s[0]&&(h=s[0]),f==="row"&&(u==="delete"?h<s[2]&&s[1]!=i&&(c=s[2],h=s[0]):s[1]!=i&&(c=s[2],h=s[0])),f==="column"&&(u==="delete"?h<s[3]&&s[0]!=n&&(c=s[3],h=s[1]):s[0]!=n&&(c=s[3],h=s[1])));y=f==="column"?this._getAlphaRange(v,s[0],h,s[2],c):this._getAlphaRange(v,h,s[1],c,s[3]);n===s[0]&&i===s[1]&&(y="#REF!",this._ref.push(l));this._isUndo&&l==="#REF!"&&(y=this._ref.pop());a=a.replace(l,y);p=new ValueChangedArgs(n+1,i+1,a);this._sheets[v]._calcEngine.valueChanged(w._sheetName.value,p);this.XLEdit._updateDataContainer({rowIndex:n,colIndex:i},{dataObj:{value:a}});this._applyFormula(v,n,i);this._isUndo||(l===y?this._formulaChanged.push("true"):this._formulaChanged.push("false"))}},_applyFormula:function(n,i,r){t.isNullOrUndefined(this.model.sheets[n]._formulaCollection[i])&&(this.model.sheets[n]._formulaCollection[i]={});var u=this._sheets[n]._calcEngine.getFormulaInfoTable().values();this.model.sheets[n]._formulaCollection[i][r]=u[u.length-1]},_clearFormula:function(n,t){var f,e,i,r=this.getActiveSheetIndex(),s=this.XLEdit.getPropertyValue(n,t,"value"),u,o;if(this.isFormula(s)){for(f=this.model.sheets[r]._formulaCollection[n][t],i=this._sheets[r]._calcEngine.getFormulaInfoTable().values(),e=i.indexOf(f),i.splice(e,1),this._sheets[r]._calcEngine.getFormulaInfoTable().clear(),u=0,o=i.length;u<o;u++)this._sheets[r]._calcEngine.getFormulaInfoTable().add(i[u]);delete this.model.sheets[r]._formulaCollection[n][t]}},_refreshValAndCF:function(n,t,i,r){var e=this._dataContainer.sheets[this.getActiveSheetIndex()],u=this._dataContainer.cFormatData,f;this.isUndefined(i)&&this.isUndefined(r)?delete e[n][t]:(this.isUndefined(i)||(e[n][t]={rule:i}),this.isUndefined(r)||(f=u[r[0]].replace("true","false"),u.indexOf(f)<0&&u.push(f),e[n][t]={cFormatRule:[u.indexOf(f)]}))},_refreshRows:function(n){var t=this._getRowHdrTBody(n).find("tr"),i=this._getContTBody(n).find("tr");this.setRows([t,i],n)},_refreshDataContainer:function(i,r){for(var a,ft,v,et,d,g,f,o,c,ut,k=0,ot=0,st,e=this._dataContainer.sheets[i],ht,it,ct,s,h,l,nt,p,w,b,y=this.model.scrollSettings.allowVirtualScrolling,rt=this.getSheet(i)._usedRange,tt=parseInt(this.getObjectKeys(e)[this.getObjectLength(e)-1]),u=0;u<=tt;u++)t.isNullOrUndefined(e[u])||(st=this.getObjectKeys(e[u]),ot=parseInt(st[st.length-1]),ot>k&&(k=ot));ct=r.startCol<=k?r.colCount+r.startCol:k-1;ht=r.status.indexOf("shift")>-1?ct:k-1;it=r.status.indexOf("shift")>-1?r.rowCount+r.startRow:tt;a=r.startRow;ft=r.startRow+r.rowCount-1;v=r.startCol;et=r.startCol+r.colCount-1;switch(r.status){case"insertRow":for(u=tt,c=r.startRow;u>=c;u--)if(!t.isNullOrUndefined(e[u])){if(e[u+r.rowCount]=n.extend(!0,{},e[u]),!t.isNullOrUndefined(e[u+r.rowCount]))for(l=this.getObjectKeys(e[u+r.rowCount]),f=0,ut=l.length;f<ut;f++)this._clearFormula(u,l[f]),u>=a&&u<=ft?(this._checkIndicesInContainer(i,a,l[f],"rule")&&(d=this._dataContainer.sheets[i][a][l[f]].rule),this._checkIndicesInContainer(i,a,l[f],"cFormatRule")&&(g=this._dataContainer.sheets[i][a][l[f]].cFormatRule),this._refreshValAndCF(u,l[f],d,g,r.rowCount,0),y||a<1||this.addClass(this.getCell(u,l[f])[0],this.XLFormat.getFormatClass(this.getCell(a-1,l[f])[0].className,!1))):delete e[u][l[f]],this._refreshFormula(u+r.rowCount,parseInt(l[f]),r.rowCount,"insert","row",r.startRow,!1),this.XLEdit._refreshCalcEngine(u+r.rowCount,parseInt(l[f])),y||this.XLComment._updateCmntFrmCntnr(u+r.rowCount,parseInt(l[f]));this.getObjectLength(e[u])<1&&delete e[u]}if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,nt=s[s.length-1].row-s[0].row,u=0,c=s.length;u<c;u++)for(e[s[u].row]=s[u].value,l=this.getObjectKeys(e[s[u].row]),f=0,ut=l.length;f<ut;f++)this._refreshFormula(s[u].row,parseInt(l[f]),nt,"insert","row","",!1),this.XLEdit._refreshCalcEngine(s[u].row,parseInt(l[f]));break;case"insertColumn":for(u=0;u<=it;u++)for(f=k,c=r.startCol;f>=c;f--)p=w=null,t.isNullOrUndefined(e[u])||(t.isNullOrUndefined(e[u][f])||(t.isNullOrUndefined(e[u][f+r.colCount])||(t.isNullOrUndefined(e[u][f+r.colCount].picture)||(p=e[u][f+r.colCount].picture),t.isNullOrUndefined(e[u][f+r.colCount].chart)||(w=e[u][f+r.colCount].chart)),e[u][f+r.colCount]=e[u][f],t.isNullOrUndefined(e[u][f].picture)&&t.isNullOrUndefined(e[u][f].chart)||(t.isNullOrUndefined(e[u][f].picture)||(p=e[u][f].picture),t.isNullOrUndefined(e[u][f].chart)||(w=e[u][f].chart)),t.isNullOrUndefined(e[u][f+r.colCount])||(t.isNullOrUndefined(p)||(e[u][f+r.colCount].picture=p),t.isNullOrUndefined(w)||(e[u][f+r.colCount].chart=w))),this._clearFormula(u,f),f>=v&&f<=et?(this._checkIndicesInContainer(i,u,v,"rule")&&(d=this._dataContainer.sheets[i][u][v].rule),this._checkIndicesInContainer(i,u,v,"cFormatRule")&&(g=this._dataContainer.sheets[i][u][v].cFormatRule),this._refreshValAndCF(u,f,d,g,0,r.colCount),y||!v<1&&this.addClass(this.getCell(u,f)[0],this.XLFormat.getFormatClass(this.getCell(u,v-1)[0].className,!1))):delete e[u][f],!t.isNullOrUndefined(e[u][f])||t.isNullOrUndefined(p)&&t.isNullOrUndefined(w)||(e[u][f]={}),t.isNullOrUndefined(p)||(e[u][f].picture=p),t.isNullOrUndefined(w)||(e[u][f].chart=w),this._refreshFormula(u,f+r.colCount,r.colCount,"insert","column",r.startCol,!1),this.XLEdit._refreshCalcEngine(u,f+r.colCount),y||this.XLComment._updateCmntFrmCntnr(u,f+r.colCount));if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,nt=s[s.length-1].col-s[0].col,o=0,c=s.length;o<c;o++)t.isNullOrUndefined(e[s[o].row])&&(e[s[o].row]={}),e[s[o].row][s[o].col]=s[o].value,this._refreshFormula(s[o].row,s[o].col,nt,"insert","column","",!1),this.XLEdit._refreshCalcEngine(s[o].row,s[o].col),y||this.XLComment._updateCmntFrmCntnr(s[o].row,s[o].col);break;case"deleteRow":for(this._delCells=[],h=[],u=r.startRow;u<=tt;u++){if(u<r.startRow+r.rowCount){if(this._delCells.push({row:u,value:n.extend(!0,{},e[u])}),!t.isNullOrUndefined(e[u]))for(l=this.getObjectKeys(e[u]),f=0,c=l.length;f<c;f++)this._clearFormula(u,l[f]),e[u][l[f]]={};e[u]={};h.push({row:u})}if(!t.isNullOrUndefined(e[u+r.rowCount])){for(e[u]=n.extend(!0,{},e[u+r.rowCount]),l=this.getObjectKeys(e[u]),f=0,c=l.length;f<c;f++)this._clearFormula(u+r.rowCount,l[f]),e[u+r.rowCount][l[f]]={},this._refreshFormula(u,parseInt(l[f]),r.rowCount,"delete","row",r.startRow,!1),y||this.XLComment._updateCmntFrmCntnr(u,parseInt(l[f]));e[u+r.rowCount]={};h.push({row:u+r.rowCount})}}for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row])===0&&(this._clearFormula(h[o].row,h[o].col),delete e[h[o].row]);break;case"deleteColumn":for(this._delCells=[],h=[],u=0;u<=it;u++){for(f=r.startCol;f<=k;f++)p=w=null,f<r.startCol+r.colCount&&(t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f])}),this._clearFormula(u,f),e[u][f]={},t.isNullOrUndefined(this._delCells[this._delCells.length-1])||(b=this._delCells.length-1,t.isNullOrUndefined(this._delCells[b].value.picture)||(e[u][f].picture=this._delCells[b].value.picture),t.isNullOrUndefined(this._delCells[b].value.chart)||(e[u][f].chart=this._delCells[b].value.chart)),h.push({row:u,col:f}))),t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f+r.colCount])||(e[u][f]=n.extend(!0,{},e[u][f+r.colCount]),t.isNullOrUndefined(e[u][f+r.colCount].picture)||(p=e[u][f+r.colCount].picture),t.isNullOrUndefined(e[u][f+r.colCount].chart)||(w=e[u][f+r.colCount].chart),this._clearFormula(u,f+r.colCount),e[u][f+r.colCount]={},t.isNullOrUndefined(p)||(e[u][f+r.colCount].picture=p),t.isNullOrUndefined(w)||(e[u][f+r.colCount].chart=w),t.isNullOrUndefined(this._delCells[this._delCells.length-1])||(b=this._delCells.length-1,t.isNullOrUndefined(this._delCells[b].value.picture)||(e[u][f].picture=this._delCells[b].value.picture),t.isNullOrUndefined(this._delCells[b].value.chart)||(e[u][f].chart=this._delCells[b].value.chart)),h.push({row:u,col:f+r.colCount}),this._refreshFormula(u,f,r.colCount,"delete","column",r.startCol,!1),y||this.XLComment._updateCmntFrmCntnr(u,f));for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row][h[o].col])===0&&(this._clearFormula(h[o].row,h[o].col),delete e[h[o].row][h[o].col]);h=[]}break;case"shiftRight":for(u=r.startRow;u<it;u++)for(f=k,c=r.startCol;f>=c;f--)t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(e[u][f+r.colCount]=n.extend(!0,{},e[u][f]),this._clearFormula(u,f),f>=v&&f<=et?(this._checkIndicesInContainer(i,u,v,"rule")&&(d=this._dataContainer.sheets[i][u][v].rule),this._checkIndicesInContainer(i,u,v,"cFormatRule")&&(g=this._dataContainer.sheets[i][u][v].cFormatRule),this._refreshValAndCF(u,f,d,g,0,r.colCount),v<1||this.addClass(this.getCell(u,f)[0],this.XLFormat.getFormatClass(this.getCell(u,v-1)[0].className,!1))):delete e[u][f],this._refreshFormula(u,f+r.colCount,r.colCount,"insert","column",r.startCol,!0),this.XLEdit._refreshCalcEngine(u,f+r.colCount),this.XLEdit._refreshCalcEngine(u,f),y||this.XLComment._updateCmntFrmCntnr(u,f+r.rowCount));if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,nt=s[s.length-1].col-s[0].col,o=0,c=s.length;o<c;o++)e[s[o].row][s[o].col]=s[o].value,this._refreshFormula(s[o].row,s[o].col,nt,"insert","column",r.startRow,!1),this.XLEdit._refreshCalcEngine(s[o].row,s[o].col),y||this.XLComment._updateCmntFrmCntnr(s[o].row,s[o].col);break;case"shiftLeft":for(this._delCells=[],h=[],u=r.startRow;u<it;u++){for(f=r.startCol;f<=k;f++)f<r.startCol+r.colCount&&!t.isNullOrUndefined(e[u])&&(t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f])}),this._clearFormula(u,f),e[u][f]={},h.push({row:u,col:f}))),t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f+r.colCount])||(e[u][f]=n.extend(!0,{},e[u][f+r.colCount]),this.clearTextNode(this.getCell(u,f+r.colCount)),this.clearTextNode(this.getCell(u,f),this.XLEdit.getPropertyValue(u,f,"value2")),h.push({row:u,col:f+r.colCount}),this._clearFormula(u,f+r.colCount),e[u][f+r.colCount]={},this._refreshFormula(u,f,r.colCount,"delete","column",r.startCol,!0),y||this.XLComment._updateCmntFrmCntnr(u,f)),this.XLEdit._refreshCalcEngine(u,f);for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row][h[o].col])===0&&(this._clearFormula(h[o].row,h[o].col),this.XLEdit._refreshCalcEngine(h[o].row,h[o].col),delete e[h[o].row][h[o].col]);h=[]}break;case"shiftBottom":for(u=tt,c=r.startRow;u>=c;u--){for(f=r.startCol;f<ht;f++)t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(t.isNullOrUndefined(e[u+r.rowCount])&&(e[u+r.rowCount]={}),e[u+r.rowCount][f]=n.extend(!0,{},e[u][f]),this._clearFormula(u,f),u>=a&&u<=ft?(this._checkIndicesInContainer(i,a,f,"rule")&&(d=this._dataContainer.sheets[i][a][f].rule),this._checkIndicesInContainer(i,a,f,"cFormatRule")&&(g=this._dataContainer.sheets[i][a][f].cFormatRule),this._refreshValAndCF(u,f,d,g,r.rowCount,0),y||a<1||this.addClass(this.getCell(u,f)[0],this.XLFormat.getFormatClass(this.getCell(a-1,f)[0].className,!1))):delete e[u][f],this._refreshFormula(u+r.rowCount,f,r.rowCount,"insert","row",r.startRow,!0),y||this.XLComment._updateCmntFrmCntnr(u+r.rowCount,f)),this.XLEdit._refreshCalcEngine(u,f),this.XLEdit._refreshCalcEngine(u+r.rowCount,f);t.isNullOrUndefined(e[u])||this.getObjectLength(e[u])===0&&delete e[u]}if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,nt=s[s.length-1].row-s[0].row,u=0,c=s.length;u<c;u++)t.isNullOrUndefined(e[s[u].row])&&(e[s[u].row]={}),e[s[u].row][s[u].col]=s[u].value,this._refreshFormula(s[u].row,s[u].col,nt,"insert","row",r.startRow,!0),this.XLEdit._refreshCalcEngine(s[u].row,s[u].col),y||this.XLComment._updateCmntFrmCntnr(s[u].row,s[u].col);break;case"shiftUp":for(h=[],u=r.startRow;u<=tt;u++)for(f=r.startCol;f<ht;f++)u<r.startRow+r.rowCount&&!t.isNullOrUndefined(e[u])&&(t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f])}),this._clearFormula(u,f),e[u][f]={},h.push({row:u,col:f}))),t.isNullOrUndefined(e[u+r.rowCount])||t.isNullOrUndefined(e[u+r.rowCount][f])||(t.isNullOrUndefined(e[u])&&(e[u]={}),e[u][f]=n.extend(!0,{},e[u+r.rowCount][f]),this.clearTextNode(this.getCell(u+r.rowCount,f)),this.clearTextNode(this.getCell(u,f),this.XLEdit.getPropertyValue(u,f,"value2")),this._clearFormula(u+r.rowCount,f),e[u+r.rowCount][f]={},h.push({row:u+r.rowCount,col:f}),this._refreshFormula(u,f,r.rowCount,"delete","row",r.startRow,!0),y||this.XLComment._updateCmntFrmCntnr(u,f)),this.XLEdit._refreshCalcEngine(u,f);for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row][h[o].col])===0&&(this._clearFormula(h[o].row,h[o].col),delete e[h[o].row][h[o].col]),this.getObjectLength(e[h[o].row])===0&&delete e[h[o].row]}r.status.indexOf("insert")>-1&&(rt.rowIndex=rt.rowIndex+r.rowCount,rt.colIndex=rt.colIndex+r.colCount,this.getSheet(i)._usedRange=rt)},_undoInsDelMerge:function(){if(this._isUndo){this._dupDetails=!0;for(var n=0,t=this._removeMergeColl.length;n<t;n++)this._mergeCenter=this._removeMergeColl[n].merge.isCenterAlign,this.mergeCells(this._removeMergeColl[n].merge.mRange,!0);this._dupDetails=!1}},insertShiftRight:function(n,t){var i,f=!1,u=this.getActiveSheetIndex(),r;this._isUndo?(i="shiftLeft",this._insDelStatus="delete"):(i="shiftRight",this._insDelStatus="insert");this.model.allowFiltering&&this.XLFilter._checkFilterApplied(u,n.rowIndex,n.colIndex,i);this._isFilterApplied?this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630):(r={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:i},this._isUndo||(f=this._clearAllMergeCells(u,n.rowIndex,r.rowCount,n.colIndex,r.colCount,i)),this._isUndo||f?this._insertShiftRight(u,n,t,r):(this._insData={sheetIdx:u,startCell:n,endCell:t,value:r},this._showAlertDlg("Alert","MergeCellsAlert","MergeInsertDelete",498)),this._undoInsDelMerge())},_insertShiftRight:function(t,i,r,u){var s=r.colIndex-i.colIndex+1,h=this.getRows(t)[1],l=this._getJSSheetHeader(t).find("col"),a=this._getContent(t).find("col"),o,f,e,c;if(this._isUndo){for(o=i.rowIndex;o<=r.rowIndex;o++)for(iTd=n(h[o]).find("td"),len=iTd.length-1,f=i.colIndex;f<=len-s;f++)iTd[f].outerHTML=iTd[f+s].outerHTML;for(e=len;e>len-s;e--)for(l.eq(e).remove(),a.eq(e).remove(),c=0;c<h.length;c++)n(h[c]).find("td:eq("+e+")").remove()}else{for(e=0;e<s;e++)this.XLScroll._createNewColumn(t,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert");for(o=i.rowIndex;o<=r.rowIndex;o++)for(iTd=n(h[o]).find("td"),len=iTd.length-1,f=len-s;f>=i.colIndex;f--)iTd[f+s].outerHTML=iTd[f].outerHTML,iTd[f].innerHTML=""}this.performSelection(i,r);this._refreshDataContainer(t,u);this._isUndo?this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"delete"):this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"insert");this.model.allowComments&&this.XLComment._updateCmntArrowPos();this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._isUndoRedo||this._undoredoDetails(t,i,r,"insert","insertShiftRight");this._refreshRows(t)},insertShiftBottom:function(n,t){var f=!1,r=this.getActiveSheetIndex(),u,i;u=this._isUndo?"shiftUp":"shiftBottom";this.model.allowFiltering&&this.XLFilter._checkFilterApplied(r,n.rowIndex,n.colIndex,u);this._isFilterApplied?this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630):(i={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:u},this._isUndo||(f=this._clearAllMergeCells(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u)),this._isUndo||f?this._insertShiftBottom(r,n,t,i):(this._insData={sheetIdx:r,startCell:n,endCell:t,value:i},this._showAlertDlg("Alert","MergeCellsAlert","MergeInsertDelete",498)),this._undoInsDelMerge())},_insertShiftBottom:function(t,i,r,u){var y=this.model.scrollSettings.allowVirtualScrolling,e,f,c,a;if(this._refreshDataContainer(t,u),y)this._refreshViewport(this.getSheet(t)._scrollTop,t);else{var h,s,l,v=this.getRows(t),o=v[1],p=v[0];if(this._isUndo){for(o=this._getContent(t).find("tbody").get(0).rows,e=i.rowIndex,a=o.length;e<a;e++)if(h=e+(r.rowIndex-i.rowIndex+1),l=n(o[e]).find("td"),h<o.length)for(s=n(o[h]).find("td"),f=i.colIndex;f<=r.colIndex;f++)l[f].outerHTML=s[f].outerHTML,s[f].innerHTML="";for(f=i.colIndex;f<=r.colIndex;f++)for(c=a-1,length=a-1-(r.rowIndex-i.rowIndex+1);c>length;c--)n(o[c]).remove(),n(p[c]).remove(),this.model.sheets[t].rowCount=this.model.sheets[t].rowCount-1;this.XLScroll._refreshScroller(1,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"all")}else{for(e=i.rowIndex;e<=r.rowIndex;e++)this.XLScroll._createNewRow(t,-1,-1,"insert");for(e=o.length-1;e>=i.rowIndex;e--)if(h=e-(r.rowIndex-i.rowIndex+1),l=n(o[e]).find("td"),h>=i.rowIndex)for(s=n(o[h]).find("td"),f=i.colIndex;f<=r.colIndex;f++)l[f].outerHTML=s[f].outerHTML,s[f].innerHTML="",l[f].className=s[f].className,s[f].className="e-rowcell e-wrapword"}this._refreshRows(t)}this.performSelection(i,r);this.model.allowComments&&this.XLComment._updateCmntArrowPos();this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._isUndo?this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"delete"):this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"insert");this._isUndoRedo||this._dupDetails||this._undoredoDetails(t,i,r,"insert","insertShiftBottom")},insertEntireRow:function(t,i){var v=this.model.scrollSettings.allowVirtualScrolling,u,l,o,f,r=this.getActiveSheetIndex(),e=this.getSheet(r),y=e._isRowSelected,h,a,s,c;if(this._isUndo?(o="deleteRow",this._insDelStatus="delete"):(o="insertRow",this._insDelStatus="insert"),f={startCol:0,colCount:e.colCount,startRow:t,rowCount:i-t+1,status:o},this._isUndo?this._clearAllMergeCells(r,t,f.rowCount,-1,0,o):this._clearAllMergeCells(r,t,f.rowCount,-1,0,o),v)this._refreshDataContainer(r,f),this.XLFilter._updateFilterCollection(r,t,i-t,"row",this._insDelStatus),this._refreshViewport(this.getSheet(r)._scrollTop,r);else{if(this._isUndo){for(h=this.getRows(r),a=h[1],s=h[0],u=i;u>=t;u--)n(a[u]).remove(),n(s[u]).remove(),e.rowCount=e.rowCount-1,this.XLScroll._getRowHeights(r,t),this._refreshFreezeRows(r,u,parseInt(s[u].style.height),"delete");for(c=s.find("td"),u=0,l=c.length;u<l;u++)n(c[u]).text(u+1)}else for(u=t;u<=i;u++)this.XLScroll._createNewRow(r,u,0,"insert"),this._refreshFreezeRows(r,u,this.model.rowHeight,"insert");this._refreshDataContainer(r,f);this.XLFilter._updateFilterCollection(r,t,i-t,"row",this._insDelStatus);this._refreshRows(r)}this._isUndo?this._refreshAllMergeCells(r,t,f.rowCount,-1,0,"delete"):this._refreshAllMergeCells(r,t,f.rowCount,-1,0,"insert");y?this.XLSelection.selectRows(t,i):this.performSelection({rowIndex:t,colIndex:0},{rowIndex:i,colIndex:e.colCount-1});this.model.allowComments&&this.XLComment._updateCmntArrowPos();this._isUndoRedo||this._undoredoDetails(r,{rowIndex:t,colIndex:0},{rowIndex:i,colIndex:e.colCount-1},"insert","insertRow")},insertEntireColumn:function(n,t){var u,i=this.getActiveSheetIndex(),r,o=this.getSheet(i),s=o._isColSelected,f,e;this._isUndo?(this._insDelStatus="delete",u="deleteColumn"):(u="insertColumn",this._insDelStatus="insert");r={startCol:n,colCount:t-n+1,startRow:0,rowCount:o.rowCount,status:u};this._isUndo?this._clearAllMergeCells(i,-1,0,n,r.colCount,u):this._clearAllMergeCells(i,-1,0,n,r.colCount,u);this._refreshDataContainer(i,r);f={rowIndex:0,colIndex:n};e={rowIndex:0,colIndex:t};this.XLScroll._createNewColumn(i,f,e,"insert");this._isUndo?this._refreshAllMergeCells(i,-1,0,n,r.colCount,"delete"):this._refreshAllMergeCells(i,-1,0,n,r.colCount,"insert");this.XLFilter._updateFilterCollection(i,n,t-n,"column",this._insDelStatus);this._isUndoRedo||this._undoredoDetails(i,f,e,"insert","insertColumn");this.model.allowComments&&this.XLComment._updateCmntArrowPos();s?this.XLSelection.selectColumns(n,t):this.performSelection(f,e);this._refreshRows(i)},deleteShiftLeft:function(n,t){var f=!1,u=this.getActiveSheetIndex(),i,r;this._isUndo?(this._insDelStatus="insert",i="shiftRight"):(this._insDelStatus="delete",i="shiftLeft");this.model.allowFiltering&&this.XLFilter._checkFilterApplied(u,n.rowIndex,n.colIndex,i);this._isFilterApplied?this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630):(r={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:i},this._isUndo||(f=this._clearAllMergeCells(u,n.rowIndex,r.rowCount,n.colIndex,r.colCount,i)),this._isUndo||f?this._deleteShiftLeft(u,n,t,r):(this._insData={sheetIdx:u,startCell:n,endCell:t,value:r},this._showAlertDlg("Alert","MergeCellsAlert","MergeInsertDelete",498)),this._undoInsDelMerge())},_deleteShiftLeft:function(t,i,r,u){var o,s,f,e,h=r.colIndex-i.colIndex+1,l=this.getRows(t)[1],c=[],a;if(this._isUndo)for(n.extend(!0,c,this._deletedText),o=i.rowIndex;o<=r.rowIndex;o++){for(f=n(l[o]).find("td"),a=f.length-1,e=a-h;e>i.colIndex-1;e--)f[e+h].outerHTML=f[e].outerHTML;for(s=i.colIndex;s<=r.colIndex;s++)f[s].outerHTML=c.shift()}else for(this._insDelStatus="delete",o=i.rowIndex;o<=r.rowIndex;o++){for(f=n(l[o]).find("td"),s=i.colIndex;s<=r.colIndex;s++)c.push(f[s].outerHTML);for(e=i.colIndex,length=f.length;e<length-h;e++)f[e].outerHTML=f[e+h].outerHTML}this.performSelection(i,r);this._refreshDataContainer(t,u);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._deletedText=c;this.model.allowComments&&this.XLComment._updateCmntArrowPos();this._isUndo?this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"insert"):this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"delete");this._isUndoRedo||this._undoredoDetails(t,i,r,"delete","deleteShiftLeft");this._refreshRows(t)},deleteShiftUp:function(n,t){var f=!1,r=this.getActiveSheetIndex(),u,i;u=this._isUndo?"shiftBottom":"shiftUp";this.model.allowFiltering&&this.XLFilter._checkFilterApplied(r,n.rowIndex,n.colIndex,u);this._isFilterApplied?this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630):(i={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:u},this._isUndo||(f=this._clearAllMergeCells(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u)),this._isUndo||f?this._deleteShiftUp(r,n,t,i):(this._insData={sheetIdx:r,startCell:n,endCell:t,value:i},this._showAlertDlg("Alert","MergeCellsAlert","MergeInsertDelete",498)),this._undoInsDelMerge())},_deleteShiftUp:function(t,i,r,u){var v=this.model.scrollSettings.allowVirtualScrolling,e,f,a,l=[],h,s,c,o;if(v)this._refreshDataContainer(t,u),this._refreshViewport(this.getSheet(t)._scrollTop,t);else{if(o=this.getRows(t)[1],this._isUndo){for(n.extend(!0,l,this._deletedText),e=o.length-1;e>=i.rowIndex;e--)if(h=e-(r.rowIndex-i.rowIndex+1),s=n(o[e]).find("td"),h>=i.rowIndex)for(c=n(o[h]).find("td"),f=i.colIndex;f<=r.colIndex;f++)s[f].outerHTML=c[f].outerHTML,c[f].innerHTML="";for(e=i.rowIndex;e<=r.rowIndex;e++)for(s=n(o[e]).find("td"),f=i.colIndex;f<=r.colIndex;f++)s[f].outerHTML=l.shift()}else for(e=i.rowIndex,a=o.length;e<a;e++)if(h=e+(r.rowIndex-i.rowIndex+1),s=n(o[e]).find("td"),h<o.length)for(c=n(o[h]).find("td"),f=i.colIndex;f<=r.colIndex;f++)l.push(s[f].outerHTML),s[f].outerHTML=c[f].outerHTML,c[f].innerHTML="";this._refreshDataContainer(t,u);this._refreshRows(t)}this.performSelection(i,r);this.model.allowComments&&this.XLComment._updateCmntArrowPos();this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._deletedText=l;this._isUndo?this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"insert"):this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"delete");this._isUndoRedo||this._dupDetails||this._undoredoDetails(t,i,r,"delete","deleteShiftUp")},deleteEntireRow:function(i,r){var k=this.model.scrollSettings.allowVirtualScrolling,u,y,s,f=this.getActiveSheetIndex(),e=this.getSheet(f);if(rowHeightColl=e.rowsHeightCollection,this._isUndo?(this._insDelStatus="insert",s="insertRow"):(s="deleteRow",this._insDelStatus="delete"),o={startCol:0,colCount:e.colCount,startRow:i,rowCount:r-i+1,status:s},this._isUndo?this._clearAllMergeCells(f,i,o.rowCount,-1,0,s):this._clearAllMergeCells(f,i,o.rowCount,-1,0,s),this._isUndo?(c=rowHeightColl.splice(0,i),t.merge(c,this._deletedDimension),t.merge(c,rowHeightColl),e.rowsHeightCollection=rowHeightColl=c,this._deletedDimension=[]):this._deletedDimension=rowHeightColl.splice(i,r-i+1),k)this._refreshDataContainer(f,o),this._refreshViewport(this.getSheet(f)._scrollTop,f);else{var l,p,h=[],c,w,o,b=this.getRows(f),a=b[1],v=b[0];if(this._isUndo){for(n.extend(!0,h,this._deletedText),u=i;u<=r;u++)w=h.pop(),n(a[u]).before(w),p=this.XLScroll._rowHeaderTemplate(1,rowHeightColl[u]),n(v[u]).before(p),e.rowCount=e.rowCount+1,this._refreshFreezeRows(f,u,rowHeightColl[u],"insert");this._refreshRows(f)}else for(u=r;u>=i;u--)h.push(a[u].outerHTML),this._refreshFreezeRows(f,u,parseInt(v[u].style.height),"delete"),n(a[u]).remove(),n(v[u]).remove(),e.rowCount=e.rowCount-1,this.XLScroll._createNewRow(f,-1,-1,"insert");for(l=n(this.getRows(f)[0]).find("td"),u=0,y=l.length;u<y;u++)n(l[u]).text(u+1);this._refreshDataContainer(f,o);this._refreshRows(f)}e._isRowSelected?this.XLSelection.selectRows(i,r):this.performSelection({rowIndex:i,colIndex:0},{rowIndex:r,colIndex:e.colCount-1});this._deletedText=h;this.model.allowComments&&this.XLComment._updateCmntArrowPos();this._isUndo?this._refreshAllMergeCells(f,i,o.rowCount,-1,0,"insert"):this._refreshAllMergeCells(f,i,o.rowCount,-1,0,"delete");this.XLFilter._updateFilterCollection(f,i,r-i,"row",this._insDelStatus);this.XLScroll._getRowHeights(f,i);this._isUndoRedo||this._undoredoDetails(f,{rowIndex:i,colIndex:0},{rowIndex:r,colIndex:e.colCount-1},"delete","deleteRow")},deleteEntireColumn:function(i,r){var e,u,v,y,f=this.getActiveSheetIndex(),s=this.getSheet(f),l=this.getRows(f)[1],h=this._getContent(f).find("col"),p=this._getJSSheetHeader(f).find("col"),w=this._getJSSheetHeader(f).find("th"),a,o=[],c,d,b,g=this.XLScroll._colGroupTemplate(1),k=s.columnsWidthCollection,nt=this.model.scrollSettings.allowVirtualScrolling?this._getContent(f).find("tbody").get(1):this._getContent(f).find("tbody").get(0);if(this._isUndo?(a="insertColumn",this._insDelStatus="insert"):(a="deleteColumn",this._insDelStatus="delete"),c={startCol:i,colCount:r-i+1,startRow:0,rowCount:s.rowCount,status:a},this._isUndo?this._clearAllMergeCells(f,-1,0,i,c.colCount,a):this._clearAllMergeCells(f,-1,0,i,c.colCount,a),this._isUndo){for(o=n.extend(!0,o,this._deletedText),e=l.length-1;e>=0;e--)for(y=n(l[e]).find("td"),u=i;u<=r;u++)y.eq(u).before(o.pop());for(u=i;u<=r;u++)h.eq(u).before(o.pop()),w.eq(u).before("<th class='e-headercell'><div class='e-headercelldiv'><\/div><\/th>"),p.eq(u).before(o.pop()),this._refreshFreezeColumns(f,u,parseInt(h[u].style.width),"insert");b=k.splice(0,i);t.merge(b,this._deletedDimension);t.merge(b,k);s.columnsWidthCollection=b;this._deletedDimension=[]}else{for(u=r;u>=i;u--)o.push(p[u].outerHTML),o.push(h[u].outerHTML),this._deletedDimension.push(k.splice(u,1)[0]),this._refreshFreezeColumns(f,u,parseInt(h[u].style.width),"delete"),p.eq(u).remove(),h.eq(u).remove(),p.parent().append(g),h.parent().append(g),k.push(this.model.columnWidth);for(e=0,v=l.length;e<v;e++)for(y=n(l[e]).find("td"),u=r;u>=i;u--)d=this.XLScroll._columnTemplate(),n(l[e]).append(d),o.push(y[u].outerHTML),n(nt.rows[e]).find("td").eq(u).remove()}for(this.XLFilter._updateFilterCollection(f,i,r-i,"column",this._insDelStatus),s.colCount=h.length,w=this._getJSSheetHeader(f).find("th"),e=0,v=w.length;e<v;e++)n(w[e]).find("div").text(this._generateHeaderText(f,e+1));this._refreshDataContainer(f,c);this._isUndo?this._refreshAllMergeCells(f,-1,0,i,c.colCount,"insert"):this._refreshAllMergeCells(f,-1,0,i,c.colCount,"delete");s._isColSelected?this.XLSelection.selectColumns(i,r):this.performSelection({rowIndex:0,colIndex:i},{rowIndex:s.rowCount-1,colIndex:r});this._deletedText=o;this.model.allowComments&&this.XLComment._updateCmntArrowPos();this.XLScroll._getColWidths(f,i);this._isUndoRedo||this._undoredoDetails(f,{rowIndex:0,colIndex:i},{rowIndex:s.rowCount-1,colIndex:r},"delete","deleteColumn");this._refreshRows(f)},_refreshFreezeRows:function(n,t,i,r){if(t<this.getFrozenRows(n)){var u=parseInt(this._getContent(n).find(".e-frow")[0].style.top);r==="hide"||r==="delete"?(this._getContent(n).find(".e-frow")[0].style.top=u-i+"px",this._getJSSheetRowHeaderContent(n).find(".e-frow")[0].style.top=u-i+"px",r==="delete"&&(this.getSheet(n)._frozenRows=this.getSheet(n)._frozenRows-1)):r==="unhide"||r==="insert"?(this._getContent(n).find(".e-frow")[0].style.top=u+i+"px",this._getJSSheetRowHeaderContent(n).find(".e-frow")[0].style.top=u+i+"px",r==="insert"&&(this.getSheet(n)._frozenRows=this.getSheet(n)._frozenRows+1)):(this._getContent(n).find(".e-frow")[0].style.top=u+i+"px",this._getJSSheetRowHeaderContent(n).find(".e-frow")[0].style.top=u+i+"px")}this.getSheet(n)._currentTopFrozenRow=this.getSheet(n)._frozenRows},_refreshFreezeColumns:function(n,t,i,r){if(t<this.getFrozenColumns(n)){var u=parseInt(this._getContent(n).find(".e-fcol")[0].style.left);r==="hide"||r==="delete"?(this._getContent(n).find(".e-fcol")[0].style.left=u-i+"px",this._getJSSheetHeader(n).find(".e-fcol")[0].style.left=u-i+"px",r==="delete"&&(this.getSheet(n)._frozenColumns=this.getSheet(n)._frozenColumns-1)):r==="unhide"||r==="insert"?(this._getContent(n).find(".e-fcol")[0].style.left=u+i+"px",this._getJSSheetHeader(n).find(".e-fcol")[0].style.left=u+i+"px",r==="insert"&&(this.getSheet(n)._frozenColumns=this.getSheet(n)._frozenColumns+1)):(this._getContent(n).find(".e-fcol")[0].style.left=u+i+"px",this._getJSSheetHeader(n).find(".e-fcol")[0].style.left=u+i+"px")}this.getSheet(n)._currentLeftFrozenColumn=this.getSheet(n)._frozenColumns},performSelection:function(n,t){var r=this.getActiveSheetIndex(),i,u=this.getSheet(r);typeof n=="string"&&(i=this.getRangeIndices(n),n={rowIndex:i[0],colIndex:i[1]},t={rowIndex:i[2],colIndex:i[3]});this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(r,"refresh","all");this.setActiveCell(n.rowIndex,n.colIndex);this.XLSelection.selectRange(n,t);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();u._startCell=n;u._endCell=t},_checkRowCol:function(n,i){if(n!==0&&i!==0)return t.isNullOrUndefined(i)&&(i=n),{start:n,end:i}},hideRow:function(n,t){var i=this._checkRowCol(n,t);this._hideRow(i.start-1,i.end-1,"isRHide")},showRow:function(n,t){var i=this._checkRowCol(n,t);this._showRow(i.start-1,i.end-1,"isRHide")},hideColumn:function(n,t){var i=this._checkRowCol(n,t);this._hideColumn(i.start-1,i.end-1)},showColumn:function(n,t){var i=this._checkRowCol(n,t);this._showColumn(i.start-1,i.end-1)},_hideRow:function(n,t,i){var u=this.getActiveSheetIndex(),f=this.getSheet(u),s=this.getRows(u),a=s[1],v=s[0],e=this.model.scrollSettings.allowVirtualScrolling,o=f.hideRowsCollection,h=[],c=f.rowsHeightCollection,r,l;for(this._isUndoRedo||(this.XLEdit._updateDataContainer({rowIndex:n?n-1:n,colIndex:0},{dataObj:{hRow:!0}}),e||this.addClass(this._getJSSheetRowHeaderContent(u).find(".e-rowheader")[n-1],"e-hrow")),r=n;r<=t;r++)i==="isRHide"&&this.XLEdit._updateDataContainer({rowIndex:r,colIndex:0},{dataObj:{isRHide:!0}}),h.push(r),r in o||(o[r]=c[r],c[r]=0,e||(this._isRowViewable(u,r)&&(this.addClass(a[r],"e-r-hide"),this.addClass(v[r],"e-r-hide")),this._refreshFreezeRows(u,r,o[r],"hide"),this.model.scrollSettings.allowScrolling&&(!f._isImported||f._isLoaded)&&this.XLScroll._createNewRow(u,-1,-1,"insert"),this._filterMergeCells(r,"decr")));e&&(this._refreshMergeCells(n,-1,t-n+1,"hide"),this._refreshViewport(f._scrollTop,u));f._isImported&&!f._isLoaded||this.XLFilter._isFilter||(this.model.allowComments&&this.XLComment._updateCmntArrowPos(),this.model.scrollSettings.allowScrolling&&!e&&this.XLScroll._refreshScroller(u,"refresh","vertical"),this._isUndoRedo||(f._activeCell.rowIndex=t+1,l={sheetIndex:u,reqType:"show-hide",action:"hide",operation:"row",bSelect:{startRow:n,endRow:t},aSelect:{startRow:t+1,endRow:t+1},addBRows:n?[n-1]:[n],remBRows:[],hideRows:h},this._completeAction(l)));this.XLFilter._isFilter||this.XLScroll._getRowHeights(u,n);this.XLSelection.selectRow(t+1,u);this.model.allowAutoFill&&this.XLDragFill.hideAutoFillElement()},_showRow:function(i,r,u){var c,f=this.getActiveSheetIndex(),v=i-1>0?i-1:0,e=this.getSheet(f),y=this.getRows(f),p=y[1],l=y[0],w=[],b=[],k=e.rowsHeightCollection,s=e.hideRowsCollection,nt=n(this._getJSSheetHeader(f).find("colgroup")[0].outerHTML).attr("id","ss"),h=t.buildTag("table#wrapTable.e-table",{}),a=this._dataContainer.sheets[f],o=this.model.scrollSettings.allowVirtualScrolling,tt=e.columnsWidthCollection,d=this.element.find(".e-spreadsheetcolumnheader"),g;for(o||(h.append(nt),this.element[0].insertBefore(h[0],this.element[0].childNodes[0])),j=v;j<=r;j++)j in s&&(hideValue=s[j],u==="isRHide"&&delete a[j][0].isRHide,w.push(j),k[j]=s[j],delete s[j],o||(this._removeClass(p[j],"e-r-hide"),this._removeClass(l[j],"e-r-hide"),this._refreshFreezeRows(f,j,k[j],"unhide"),this._filterMergeCells(j,"incr")),!this._isUndoRedo&&j>0?(b.push(j-1),delete a[j-1][0].hRow,o||this._removeClass(n(l[j-1]).find("td")[0],"e-hrow")):j===0&&(delete a[0][0].hRow,o||(d.height(20.5),this._removeClass(d[0],"e-hrow")))),o||(this._setWrapHeight(f,j,p,l,h,"visible"),h.remove()),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();o&&(this._refreshMergeCells(i,-1,r-i+1,"show"),this._refreshViewport(e._scrollTop,f));this.XLFilter._isFilter||this.XLScroll._getRowHeights(f,v);e._isImported&&!e._isLoaded||this._isUndoRedo||this.XLFilter._isFilter||(i<r?(this.setActiveCell(i,0),this.XLSelection.selectRows(i,r,f),c={startRow:i,endRow:r}):(this.setActiveCell(i-1,0),this.XLSelection.selectRow(i-1,f),c={startRow:i-1,endRow:i-1}),this.XLDragFill.positionAutoFillElement(),g={sheetIndex:f,reqType:"show-hide",action:"show",operation:"row",bSelect:{startRow:i,endRow:r},aSelect:c,addBRows:[],remBRows:b,hideRows:w},this._completeAction(g));this.XLFilter._isFilter||((!e._isImported||e._isLoaded)&&this.model.allowComments&&this.XLComment._updateCmntArrowPos(),this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(f,"refresh","vertical"))},_colgroupRefresh:function(t){var i,r,u,f;this.model.allowResizing&&(i=this._getJSSheetHeader(t).find("colgroup"),r=this._getContent(t).find("colgroup"));u=n(i).clone();f=n(r).clone();n(r).remove();n(i).remove();n(u).prependTo(this._getJSSheetHeader(t).find(".e-table"));n(f).prependTo(this._getContent(t).find(".e-table"))},_updateFilterIcon:function(n,i,r){t.isNullOrUndefined(r)&&(r=this.getActiveSheetIndex());for(var o=this.getSheet(r).filterSettings.tableRange,u,e,f=0,s=o.length;f<s;f++)e=o[f].multifilterIdx,n>=e[0]&&n<=e[e.length-1]&&(u=o[f].startRow-1,this._isRowViewable(r,u)&&(i==="hide"?this.getCell(u,n).find(".e-filterspan").hide():this.getCell(u,n).find(".e-filterspan").show()),this.XLEdit._updateDataContainer({rowIndex:u,colIndex:n},{dataObj:{isFilterVisible:i!="hide"}}))},_hideColumn:function(n,i){for(var f,l,o,s=!1,u=this.getActiveSheetIndex(),g=this._getContent(u).find("col"),nt=this._getJSSheetHeader(u).find("col"),a,v,e=this.getSheet(u),y=e.hideColsCollection,p=[],h=[],w,b=e._filterColl,tt,c=e.columnsWidthCollection,k=this.element.find(".e-spreadsheetcolumnheader"),d,r=n;r<=i;r++)if(this.element.find(".e-ss-col"+r).addClass("e-freezeOverflow"),v=this.XLEdit.getPropertyValue(0,r,"isCHide"),this._isColumnViewable(u,r)&&(s=!0),t.isNullOrUndefined(v))for(this.XLEdit._updateDataContainer({rowIndex:0,colIndex:r},{dataObj:{isCHide:!0}}),s&&(this.addClass(g[r],"e-c-hide"),this.addClass(nt[r],"e-c-hide"),w=this.getRange([0,r,this.model.rowCount-1,r]),w.filter(".e-sswraptext").hide(),this._updateFilterIcon(r,"hide",u)),(!e._isImported||e._isLoaded)&&p.push(r),y[r]=c[r],c[r]=0,this._refreshFreezeColumns(u,r,y[r],"hide"),fltrKeys=this.getObjectKeys(b),f=0,l=fltrKeys.length;f<l;f++)t.isNullOrUndefined(b[fltrKeys[f]])||(tt=fltrKeys[f],t.isNullOrUndefined(this.XLEdit.getPropertyValue(fltrKeys[f],r,"isSpanHide"))&&(this.XLEdit._updateDataContainer({rowIndex:fltrKeys[f],colIndex:r},{dataObj:{isSpanHide:!0}}),s&&(a=this.getCell(f,r).find(".e-filterspan"),this.addClass(a[0],"e-hide"))));this._isUndoRedo||(n?h.push(n-1):h.push(n),this._isColumnViewable(u,n)&&(n===0?(k.width(28),this.addClass(k[0],"e-hfcol"),this.XLEdit._updateDataContainer({rowIndex:0,colIndex:0},{dataObj:{hCol:!0}})):(this.XLEdit._updateDataContainer({rowIndex:0,colIndex:n-1},{dataObj:{hCol:!0}}),this.addClass(this._getJSSheetHeader(u).find("th:eq("+(n-1)+")")[0],"e-hcol"))));this.XLScroll._getColWidths(u,n);this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(u,"refresh","horizontal");!e._isImported||e._isLoaded?(c.length-1===i?(this.XLSelection.selectColumn(i-1,u),this.setActiveCell(0,i-1),o={startCol:i-1,endCol:i-1}):(o={startCol:i+1,endCol:i+1},this.setActiveCell(0,i+1),this.XLSelection.selectColumn(i+1,u)),this.XLDragFill.positionAutoFillElement(),this._isUndoRedo||(d={sheetIndex:u,reqType:"show-hide",action:"hide",operation:"column",bSelect:{startCol:n,endCol:i},aSelect:o,hideCols:p,addBCols:h,remBCols:[]},this._completeAction(d)),this.model.allowComments&&this.XLComment._updateCmntArrowPos()):this.setActiveCell(0,0);this._browserDetails.name.indexOf("msie")>-1&&this._colgroupRefresh(u)},_showColumn:function(n,t){var i=this.getActiveSheetIndex(),u=n-1>0?n-1:0,r=this.getSheet(i),f=r.hideColsCollection,v=this._getContent(i).find("col"),o=[],e=!1,s=[],y=this._getJSSheetHeader(i).find("col"),p=this._getJSSheetHeader(i).find("th"),h,c=r.columnsWidthCollection,l=this.element.find(".e-spreadsheetcolumnheader"),a;for(j=u;j<=t;j++)this.element.find(".e-ss-col"+j).removeClass("e-freezeOverflow"),j in f&&(hideValue=f[j],this._isColumnViewable(i,j)&&(e=!0),e&&(this._removeClass(v[j],"e-c-hide"),this._removeClass(y[j],"e-c-hide")),c[j]=f[j],delete f[j],delete this._dataContainer.sheets[i][0][j].isCHide,this._refreshFreezeColumns(i,j,c[j],"unhide"),this._updateFilterIcon(j,"show",i),o.push(j),e&&(h=this.getRange([0,j,this.model.rowCount-1,j]),h.filter(".e-sswraptext").show()),!this._isUndoRedo&&j>0?(e&&this._removeClass(p.get(j-1),"e-hcol"),delete this._dataContainer.sheets[i][0][j-1].hCol,s.push(j-1)):j===0&&(l.width(29),this._removeClass(l[0],"e-hfcol"),delete this._dataContainer.sheets[i][0][0].hCol));this.XLScroll._getColWidths(i,u);this._isUndoRedo||r._isImported&&!r._isLoaded||(n<t?(this.XLSelection.selectColumns(n,t,i),aSelect={startCol:n,endCol:t}):(this.XLSelection.selectColumn(u,i),aSelect={startCol:u,endCol:u}),this.XLDragFill.positionAutoFillElement(),a={sheetIndex:i,reqType:"show-hide",action:"show",operation:"column",bSelect:{startCol:n,endCol:t},aSelect:aSelect,addBCols:[],remBCols:s,hideCols:o},this._completeAction(a));this._browserDetails.name.indexOf("msie")>-1&&this._colgroupRefresh(i);(!r._isImported||r._isLoaded)&&this.model.allowComments&&this.XLComment._updateCmntArrowPos();this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(i,"refresh","horizontal")},_destroySheet:function(n){this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value).empty()},_destroy:function(){var i,t=1;if(n("#"+this._id+"_sscustomformat").remove(),this.isImport||this._isNew){while(t<=this.model.sheetCount)delete n.templates[this._id+"JSONTemplate"+t],delete n.templates[this._id+"JSONRowHdrTemplate"+t],i=this.getSheet(t)._sheetName.value,CalcEngine.unregisterGridAsSheet(i,i),t++;this.model.sheets=[];this.model.nameManager=[];this._sheets=[];this._updateFormulaCollection();this.isImport?this._detachTable=null:(n("#"+this._id+"_nmgrid").ejGrid("option",{dataSource:[]}),this._dataContainer={sheets:{},hashCode:[],sharedData:[],cellType:[],valData:[],cFormatData:[]},this.XLRibbon._updateUseInFormulaTrgt(),this.XLEdit._refreshAutoComplete());this.element.append([this.getFocusTopElem(),this.getFocusRightElem(),this.getFocusBottomElem(),this.getFocusLeftElem(),this.getAutoFillElem(),this._getAutoFillOptElem()]);this.element.find(".e-spreadsheet-list").empty();this._tableCnt=this._newSIndex=1;this.XLChart&&(this.XLChart._shapeCnt=1);CalcEngine._tokenCount=0}else this._unWireEvents(),this._destroySubControls(),this.element.empty(),this.element.css({height:"",width:""}),this.element.removeAttr("tabindex"),this.element.removeEleEmptyAttrs()},_destroySubControls:function(){var t,i=this._id,r;r=n("input.e-"+i+"-ddl");r.length&&r.ejDropDownList("destroy");this.model.allowFiltering&&this._excelFilter.resetExcelFilter();this.model.showRibbon&&(n("#"+this._id+"_nmgrid").ejGrid("destroy"),n("#"+this._id+"_Ribbon_background-color").ejColorPicker("destroy"),n("#"+this._id+"_Ribbon_color").ejColorPicker("destroy"),n("#"+this._id+"_Ribbon_PictureColor").ejColorPicker("destroy"),n("#"+this._id+"_Ribbon_BorderColor").ejColorPicker("destroy"),n(".e-"+this._id+"-spltbtn").ejSplitButton("destroy"),n("#"+this._id+"_Ribbon").ejRibbon("destroy"));t=n(".e-"+i+"-dlg");t.length&&t.remove();this.model.allowFormulaBar&&n("#"+this._id+"_inputbox").ejAutocomplete("destroy");n("#"+this._id+"_AutoComplete").ejAutocomplete("destroy");this.model.allowAutoFill&&n("#"+this._id+"_dragfilloptionbtn").ejSplitButton("destroy");this.model.enableContextMenu&&(n("#"+this._id+"_contextMenuCell").ejMenu("destroy").remove(),n("#"+this._id+"_contextMenuColumnHeader").ejMenu("destroy").remove(),n("#"+this._id+"_contextMenuRowHeader").ejMenu("destroy").remove(),n("#"+this._id+"_contextMenuFooter").ejMenu("destroy").remove(),n(".e-"+i+"-cmenu").remove());n("#"+this._id+"_copyPaste").remove();n("#"+this._id).ejWaitingPopup("destroy")},_unWireEvents:function(){var i=this.element,r=t.eventType,u=this._id;this._off(i,r.mouseDown,".e-ribbon, .e-spreadsheetcontentcontainer .e-vscroll, .e-spreadsheetcontentcontainer .e-hscroll",this._rClickHandler);this._off(i,r.mouseDown,".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel",this._mouseDownHandler);this._off(i,"keydown",this._keyDownHandler);this._off(n(".e-ss-object"),"keydown",this._keyDownHandler);this._off(i,"click",".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel, .e-ss-object",this._cellClick);this._off(i,"dblclick",".e-spreadsheetcontentcontainer,.e-spreadsheetheader,.e-spreadsheetrowheader",this._recorddblClickHandler);this._off(i,"dblclick",".e-numericcontainer .e-numericitem",this._pagerdblClickHandler);this._off(i,r.mouseMove,this._mouseMove);this._off(i,r.mouseUp,this._sheetMouseUp);this.model.allowResizing&&this._off(i,r.mouseLeave,".e-spreadsheetrowheader,.e-spreadsheetheader",this._mouseLeave);this._off(i,r.click,".e-ssfiltered, .e-ssfilter, .e-ssfiltered-asc, .e-ssfilter-asc, .e-ssfiltered-dsc, .e-ssfilter-dsc",this._filterDownHandler);this._off(i,r.mouseDown,".e-ssddl",this._ddlopen);this._off(i,"mouseover",".e-rowcell",this._cellHoverHandler);this._off(i,"mouseover",".e-viewhdrlbl, .e-vheading",this._headingchkboxHover);this._off(i,"mouseover",".e-viewlinlbl, .e-vgridlines",this._gridlineschkboxHover);this._off(i,"mouseleave",".e-viewhdrlbl, .e-vheading",this._headingchkboxLeave);this._off(i,"mouseleave",".e-viewlinlbl, .e-vgridlines",this._gridlineschkboxLeave);this._off(this._getInputBox(),"input",this.XLEdit._formulaBoxInputChange);this._off(n("#"+u+"_cellstyles"),r.click,this._cellStyleClick);this._off(n("#"+u+"_formatastable"),r.click,this._formatAsTableClick);this._off(n("#"+u+"_nmuseinformula"),r.click,".e-nmuseinformularow",this._useInFormulaClick);this.element.find(".e-spreadsheet-list").unbind("mousewheel DOMMouseScroll",n.proxy(this.XLScroll._spreadMouseWheel,this.XLScroll));this._off(n(".e-menu .e-chartcontent .e-chartcell"),r.click,this._chartClickHandler);this._off(n("#"+u+"_allchart").find(".e-chartimg"),r.click,this._allChartType);this.model.scrollSettings.isResponsive&&n(window).unbind("resize",n.proxy(this._spreadsheetonresize,this))},getValueRowCol:function(n,t,i){var r=this.getSheet(n);return r._isImported&&!r._isRequested&&(this._intrnlReq=!0,this._importSheet(n)),this.XLEdit.getPropertyValue(t-1,i-1,"value",n)},setValueRowCol:function(n,i,r,u){r--;u--;var f,e,o={rowIndex:r,colIndex:u};f=this.getRangeData([r,u,r,u],!1,["formatStr","type","thousandSeparator","decimalPlaces"],n)[0];f.formatStr&&(e=this.XLFormat._format(i,{formatStr:f.formatStr,type:f.type,thousandSeparator:f.thousandSeparator,decimalPlaces:f.decimalPlaces}));f.type=="fraction"&&(e=this.XLFormat._format(i,{type:f.type}));e=t.isNullOrUndefined(e)?i:e;this.XLEdit._updateDataContainer(o,{dataObj:{type:t.Spreadsheet.CellType.Formula,value2:e,calcValue:this.XLEdit._parseValue(i).value},sheetIdx:n});this.XLEdit._refreshCellAlignment({cellIdx:o,value:i,type:f.type})},getActiveCellElem:function(n){n=this._getSheetIndex(n);var t=this.getSheet(n);return this.getCell(t._activeCell.rowIndex,t._activeCell.colIndex,n)},_hlDlgOpen:function(){var s=this.getActiveSheetIndex(),i=this.getActiveCellElem(s);if(!i.length)return!1;var t=this._id,h,c=n("#"+t+"_Ribbon_webAddress"),l=n("#"+t+"_Ribbon_cellAddress"),e=n("#"+t+"_Ribbon_findText"),r,u=this.XLEdit.getPropertyValue(i.parent("tr").index(),i[0].cellIndex,"hyperlink",s),a,o,f=n("#"+t+"_Ribbon_cellText");n("#"+t+"_HLDialog").ejDialog("open");o=n("#"+t+"_Ribbon_sheentName").data("ejTreeView");o.option("fields",{dataSource:this.XLRibbon._sheetData()});h=n("#"+t+"_HLDialogTab").data("ejTab");f.attr("disabled",!1);e.attr("disabled",!1);this.isUndefined(u)?h.model.selectedItemIndex===0?(c.val("http://"),f.val("")):(o.selectNode(s+1),f.val(o.getText(s+1)+"!A1"),l.val("A1")):(this.isUndefined(u.webAddr)?h.option({selectedItemIndex:1}):h.option({selectedItemIndex:0}),this.isUndefined(u.cellAddr)?(c.val(u.webAddr),l.val("A1")):(l.val(u.cellAddr.split("_")[0]),a=parseInt(u.cellAddr.split("_")[1])+1,o.selectNode(a),c.val("http://")));n.validator&&(n("#"+t+"_Form_Ribbon_cellAddress").validate().resetForm(),n("#"+t+"_Form_Ribbon_webAddress").validate().resetForm());e.val("");r=this.XLEdit.getPropertyValueByElem(i);this.isUndefined(r)||(this.isFormula(r)||this.XLEdit.getPropertyValueByElem(i,"type")&&this.XLEdit.getPropertyValueByElem(i,"type").indexOf("date")>-1||n.isNumeric(r)?(f.val(this._getLocStr("HyperLinkHide")),e.val(this._getLocStr("HyperLinkHide")),f.attr("disabled",!0),e.attr("disabled",!0)):(f.val(r),e.val(r)))},_setLink:function(i){var o,h,s,c,e,y,l,a=this.getActiveSheetIndex(),p,u,r=this.getActiveCell(a),f,v;e=this.getSheet(a).selectedRange;v=n("#"+this._id+"_HLDialogTab").ejTab("option","selectedItemIndex");o=n("#"+this._id+"_Ribbon_cellText").val();h=n("#"+this._id+"_Ribbon_cellAddress").val();s=n("#"+this._id+"_Ribbon_findText").val();c=n("#"+this._id+"_Ribbon_webAddress").val();l=n("#"+this._id+"_Ribbon_sheentName").data("ejTreeView");y=this._getSheetIndexByName(l.getSelectedNode().text());o.length||s.length||(o=l.getSelectedNode().text()+"!"+h,s=c);f=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex);this._prevText=t.isNullOrUndefined(f)?"":f;u=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"type")&&this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"type").indexOf("date")>-1?this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2"):n.isNumeric(f)||this.isFormula(f)?f:v===0?s:o;this.XLEdit.updateCellValue(r,u);(this.isFormula(u)||n.isNumeric(u))&&(u=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2"));p=v===0?{webAddr:c,text:u}:{cellAddr:h,text:u};this.setHyperlink(this._getAlphaRange(a,e[0],e[1],e[2],e[3]),p,y,i)},setHyperlink:function(i,r,u,f){var c;if(this.model.allowHyperlink){if(c={range:i,address:r.webAddr,text:r.text,sheetIndex:u,reqType:"hyperlink",action:"add"},this._trigActionBegin(c))return;i=c.range;r.webAddr=c.address;r.text=c.text;u=c.sheetIndex;var w,s,b,v,y,tt=this.getActiveSheetIndex(),p=this.getSheet(tt),k,l=[],d,h,e,a,o=this._getAlphaRangeCells(i),g={sheetIndex:this.getActiveSheetIndex(),reqType:"hyperlink"},nt;if(t.isNullOrUndefined(i)?(selCellObj=p._selectedCells,rng=p.selectedRange):(rng=this.getRangeIndices(i),selCellObj=this.XLSelection._getSelectedRange({rowIndex:rng[0],colIndex:rng[1]},{rowIndex:rng[2],colIndex:rng[3]})),g.action=t.isNullOrUndefined(this.XLEdit.getPropertyValue(selCellObj[0].rowIndex,selCellObj[0].colIndex,"hyperlink"))?"add":"edit",this._isUndoRedo)for(e=0,a=selCellObj.length;e<a;e++)t.isNullOrUndefined(f[e].prevLink)||(this.XLEdit._updateDataContainer({rowIndex:selCellObj[e].rowIndex,colIndex:selCellObj[e].colIndex},{dataObj:{hyperlink:f[e].prevLink}}),this._isRowViewable(u,selCellObj[e].rowIndex)&&(nt=n(o[e]).text(),n(o[e]).find("a").remove(),o[e].lastChild?o[e].lastChild.textContent="":n(o[e]).text(""),e===0?t.isNullOrUndefined(this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"hyperlink").cellAddr)?n(o[e]).append(t.buildTag("a",f[e].prevText,"",{href:this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").webAddr,target:"_blank"})):n(o[e]).append(t.buildTag("a",f[e].prevText,"",{href:"#"})):t.isNullOrUndefined(this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"hyperlink").cellAddr)?n(o[e]).append(t.buildTag("a",nt,"",{href:this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").webAddr,target:"_blank"})):n(o[e]).append(t.buildTag("a",nt,"",{href:"#"})),n(o[e]).find("a").addClass("e-hyperlinks")),this._dupDetails=!0,this.XLFormat.format({style:{color:"#428bca"}}),this._dupDetails=!1);else{for(t.isNullOrUndefined(r.webAddr)?(s=r.cellAddr,w=t.isNullOrUndefined(r.text)?this.XLEdit.getPropertyValue(selCellObj[0].rowIndex,selCellObj[0].colIndex,"value2"):r.text,s.indexOf("!")>-1&&(k=s.split("!"),u=this._getSheetIndexByName(k[0]),s=k[1]),s.indexOf("$")>-1&&(cellAdr=s.split("$").join(""))):(v=r.webAddr,b=t.isNullOrUndefined(r.text)?this.XLEdit.getPropertyValue(selCellObj[0].rowIndex,selCellObj[0].colIndex,"value2"):r.text,v.indexOf("http")===-1&&(v="http://"+v)),e=0,a=selCellObj.length;e<a;e++)l.push({rowIndex:selCellObj[e].rowIndex,colIndex:selCellObj[e].colIndex,prevLink:this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"hyperlink"),prevColor:this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"formats")});for(this.isUndefined(s)?this.updateUniqueData({hyperlink:{webAddr:v}},rng):this.updateUniqueData({hyperlink:{cellAddr:s+"_"+u}},rng),e=0,a=selCellObj.length;e<a;e++)h=this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"value2"),l[e].prevText=e===0?this._prevText:h,this._isRowViewable(u,selCellObj[e].rowIndex)&&(n(o.eq(e).find("a")).remove(),this.XLEdit._refreshTextNode(o[e]),y=!0),d=this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"hyperlink",tt),d.cellAddr?(h=e===0?w:h,y&&o.eq(e).append(t.buildTag("a",h,"",{href:"#"})),l[e].curText=w):(h=e===0?b:h,y&&o.eq(e).append(t.buildTag("a",h,"",{href:d.webAddr,target:"_blank"})),l[e].curText=b),l[e].curLink=this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"hyperlink"),y&&n(o[e]).find("a").addClass("e-hyperlinks");this._dupDetails=!0;this.XLFormat.format({style:{color:"#428bca"}},i);this._dupDetails=!1;g.selCells=l;(!p._isImported||p._isLoaded)&&this._completeAction(g)}}},removeHyperlink:function(i,r,u,f,e){var o,a,v,y=[],d=this._dupDetails,s,c,h=this.getActiveSheetIndex(),p=this.getSheet(h),l=[],w,k=this._getAlphaRangeCells(i),b={sheetIndex:h,reqType:"hyperlink",action:"delete"};for(t.isNullOrUndefined(i)?(c=this.getRangeIndices(i),s=this.XLSelection._getSelectedRange({rowIndex:c[0],colIndex:c[1]},{rowIndex:c[2],colIndex:c[3]})):s=p._selectedCells,o=0,a=s.length;o<a;o++)e&&this._isHiddenRow(s.rowIndex)||(l.push({rowIndex:s[o].rowIndex,colIndex:s[o].colIndex,prevLink:this.XLEdit.getPropertyValue(s[o].rowIndex,s[o].colIndex,"hyperlink"),prevText:this.XLEdit.getPropertyValue(s[o].rowIndex,s[o].colIndex,"value2"),prevColor:this.XLEdit.getPropertyValue(s[o].rowIndex,s[o].colIndex,"formats")}),this._dupDetails=!0,l[o].prevLink&&(r?this.XLFormat.format({style:{"text-decoration":"underline"}},this._getAlphaRange(h,s[o].rowIndex,s[o].colIndex,s[o].rowIndex,s[o].colIndex)):(this.isUndefined(f[o].prevColor)||(v=f[o].prevColor.color),this.XLFormat.format({style:{color:this.isUndefined(v)?"#444445":v}},this._getAlphaRange(h,s[o].rowIndex,s[o].colIndex,s[o].rowIndex,s[o].colIndex)))),this._dupDetails=d,this.clearRangeData([s[o].rowIndex,s[o].colIndex,s[o].rowIndex,s[o].colIndex],["hyperlink"]),this._isUndoRedo||(l[o].curLink=this.XLEdit.getPropertyValue(s[o].rowIndex,s[o].colIndex,"hyperlink")),this._isRowViewable(h,s[o].rowIndex)&&(n(k[o]).find("a").contents().unwrap(),n(k[o]).find("a").removeClass("e-hyperlinks"),isViewed=!0),this._isUndoRedo&&!this._dupDetails&&this.XLEdit._updateDataContainer({rowIndex:s[o].rowIndex,colIndex:s[o].colIndex},{dataObj:{value2:f[o].prevText},sheetIdx:h}),this._isUndoRedo||(l[o].curText=this.XLEdit.getPropertyValue(s[o].rowIndex,s[o].colIndex,"value2")),!this._isUndoRedo||this._dupDetails||t.isNullOrUndefined(f[o].prevLink)||(this.XLEdit._updateDataContainer({rowIndex:s[o].rowIndex,colIndex:s[o].colIndex},{dataObj:{hyperlink:f[o].prevLink}}),w={rowIndex:f[o].rowIndex,colIndex:f[o].colIndex},this.XLSelection.selectRange(w,w),this._setLink([f[o]]),y.push(o)));for(o=0,a=y.length;o<a;o++)s.splice(y[o],1);b.selCells=l;b.reqType=t.isNullOrUndefined(u)?"hyperlink":"clear-link";p._isImported&&!p._isLoaded||this._isUndoRedo||this._dupDetails||this._completeAction(b)},_removeHyperlink:function(n,t,i){var u=this.getActiveSheetIndex(),r=this.getSheet(u).selectedRange;this.removeHyperlink(this._getAlphaRange(u,r[0],r[1],r[2],r[3]),n==="clear",n,t,i)},_openLink:function(){var n=this.getActiveSheetIndex(),t=this.getSheetElement(n).find(".e-activecell");this._hlClick(this.XLEdit.getPropertyValue(t.closest("tr").index(),t[0].cellIndex,"hyperlink",n))},_hlClick:function(n){var r,u,t,f,i=this.getActiveSheetIndex(),e=this._getLocStr("HyperLinkAlert").split("-");this.model.enableContextMenu&&this.XLCMenu.hideCMenu();n.cellAddr?(r=this.getRangeIndices(n.cellAddr),t={rowIndex:r[0],colIndex:r[1]},f={rowIndex:r[2],colIndex:r[3]},u=n.cellAddr.split("_")[1]===0?i:Number(n.cellAddr.split("_")[1]),this.gotoPage(u,!1),this.getSheet(i)._activeCell=t,this.XLSelection.selectRange(t,f,u),this.getSheet(i)._startCell=t,this.getSheet(i)._endCell=f,this.XLScroll._scrollSelectedPosition(u,t),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()):(t={rowIndex:this.getSheet(i)._activeCell.rowIndex,colIndex:this.getSheet(i)._activeCell.colIndex},this.getSheet(i)._startCell=t,this.getSheet(i)._endCell=t,this._isValidUrl(n.webAddr)?window.open(n.webAddr,"_blank"):this._showAlertDlg("Alert","HyperLinkAlert"))},_isValidUrl:function(n){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(n)},showWaitingPopUp:function(){n("#"+this._id).data("ejWaitingPopup").show()},hideWaitingPopUp:function(){n("#"+this._id).data("ejWaitingPopup").hide()},_getSelRange:function(n){var t,i,r=this.getActiveSheetIndex();return t=n[0],i=n[n.length-1],this._generateHeaderText(r,t.colIndex+1)+(t.rowIndex+1)+":"+this._generateHeaderText(r,i.colIndex+1)+(i.rowIndex+1)},_getSelectedCells:function(n,i){var u,r;return t.isNullOrUndefined(i)?(u=this.model.sheets[n]._selectedCells,u.length>0&&(i=this._getSelRange(u),r=this.getRangeIndices(i))):(r=this.getRangeIndices(i),u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]})),this.model.sheets[n]._selectedCells=u,r},_getHiddenCells:function(i,r,u,f){var e=this._dataContainer.sheets[i],o;return t.isNullOrUndefined(f[u.rowIndex])&&(f[u.rowIndex]={}),t.isNullOrUndefined(f[u.rowIndex][u.colIndex])&&(f[u.rowIndex][u.colIndex]={value:{},text:""}),t.isNullOrUndefined(e[u.rowIndex])||(f[u.rowIndex][u.colIndex].value=n.extend(!0,{},e[u.rowIndex][u.colIndex]),o=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2",i),delete e[u.rowIndex][u.colIndex],f[u.rowIndex][u.colIndex].text=t.isNullOrUndefined(o)?"":o),this._isRowViewable(i,r.rowIndex)&&(r=this.getCell(r.rowIndex,r.colIndex,i).empty()),f},_getRowSpan:function(n,i){for(var e=this.getRows(n)[0],u=0,r=i[0].rowIndex,f=i[i.length-1].rowIndex;r<=f;r++)t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isRHide",n))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isFHide",n))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isFilterHide",n))&&(u=u+1);return u},_getColSpan:function(n,t){for(var r=0,u=this._getJSSheetHeader(n).find("col"),i=t[0].colIndex,f=t[t.length-1].colIndex;i<=f;i++)this._hasClass(u[i],"e-fc-hide")||this._hasClass(u[i],"e-c-hide")||(r=r+1);return r},_getHiddenRowColumnCount:function(i,r){for(var e=this.getRangeIndices(r),o=0,s=0,f,c=this.getRows(i)[0],h=this._getContent(i).find("col"),u=e[0];u<=e[2];u++)t.isNullOrUndefined(this.XLEdit.getPropertyValue(u,0,"isRHide",i))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(u,0,"isFHide",i))||(o=o+1);for(f=e[1];f<=e[3];f++)(n(h[f]).hasClass("e-fc-hide")||n(h[f]).hasClass("e-c-hide"))&&(s=s+1);return{hRow:o,hCol:s}},_updateMergeColl:function(n,i,r,u){var f=this.getSheet(n)._mergeColl;t.isNullOrUndefined(f[i])&&(f[i]={});f[i][r]=u},mergeCells:function(i,r){var f,o,c=1,l=1,a,p=[],e=this.getActiveSheetIndex(),v=this.getSheet(e),w=n("#"+this._id+"_alertdlg"),u,s,h=!1,y;if((!t.isNullOrUndefined(i)||!(this.XLSelection.getSelectedCells(e).length<2))&&!(this._getAlphaRangeCells(i).length<2)&&(this._selMergeCells=[],this._mergeType="merge-cells",s=this._getSelectedCells(e,i),!this.isUndefined(s))){if(u=t.isNullOrUndefined(i)?this.model.sheets[e]._selectedCells:this.XLSelection._getSelectedRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]}),(!v._isImported||v._isLoaded)&&!this._isUndoRedo)if(this._mergeCenter){for(h=!1,f=0,a=u.length;f<a;f++)o=this.XLEdit.getPropertyValue(u[f].rowIndex,u[f].colIndex,"merge",e),t.isNullOrUndefined(o)||(c=o.mSpan.rowSpan,l=o.mSpan.colSpan,(c>1||l>1)&&(y=this._getHiddenRowColumnCount(e,this.XLEdit.getPropertyValue(u[f].rowIndex,u[f].colIndex,"merge").mRange),this._unMergeAllCells(e,f,u,p,y.hRow,y.hCol),h=!0));!h||this._dupDetails||this._isUndoRedo||(t.isNullOrUndefined(i)&&(i=this._getSelRange(u)),details={sheetIndex:e,cells:u,range:i,reqType:"merge-cells",action:"un-merge",operation:"un-merge",mCells:p},this._completeAction(details));this.performSelection(u[0],u[u.length-1])}else for(f=0,a=u.length;f<a;f++)if(o=this.XLEdit.getPropertyValue(u[f].rowIndex,u[f].colIndex,"merge",e),t.isNullOrUndefined(o)||(c=o.mSpan.rowSpan,l=o.mSpan.colSpan),c===1&&l===1){h=!1;break}(!v._isImported||v._isLoaded)&&!this._isUndoRedo&&this._rangeHasData(s)&&!r&&!h&&u.length>1?this._showAlertDlg("","MergeCellsAlert","MergeCells",498):h||this._mergeCells(e,u,{},[]);this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()}},_mergeCells:function(i,r,u,f){var l,c=this._dataContainer.sheets[i],y,p,e,s,w={},h,v,k=this._getJSSheetHeader(i).find("col"),a=this.getSheet(i),o,b;if(e=r[0].rowIndex,s=r[0].colIndex,(t.isNullOrUndefined(this.XLEdit.getPropertyValue(e,0,"isFRHide"))||t.isNullOrUndefined(this.XLEdit.getPropertyValue(e,0,"isRHide")))&&k.eq(s).hasClass("e-fc-hide"))return{hideCell:[],mCells:[]};for(l={rowSpan:this._getRowSpan(i,r),colSpan:r[r.length-1].colIndex-r[0].colIndex+1},t.isNullOrUndefined(c[e])||t.isNullOrUndefined(c[e][s])||(delete c[e][s].isMHide,delete c[e][s].mergeIdx),this._isRowViewable(i,e)&&(h=this.getCell(e,s),h[0].colSpan=l.colSpan,h[0].rowSpan=l.rowSpan,h[0].className=h[0].className.replace("e-mc-hide",""),this._mergeCenter&&h.addClass("e-calign "),h.hasClass("e-commentcell")&&this.model.allowComments&&this.XLComment._updateCmntArrowPos(h)),this._selMergeCells.push(r[0]),this._textClip(r[0].rowIndex,r[0].colIndex,"add"),this._textClip(r[0].rowIndex,r[0].colIndex,"delete","",!0),this.addClass(this.getCell(r[0].rowIndex,r[0].colIndex)[0],"e-freezeOverflow"),o=1,b=r.length;o<b;o++)this._isRowViewable(i,r[o].rowIndex)&&(v=this.getCell(r[o].rowIndex,r[o].colIndex),this._hasClass(v[0],"e-mc-hide")||this.addClass(v[0],"e-mc-hide"),this.addClass(v[0],"e-freezeOverflow")),this._textClip(r[o].rowIndex,r[o].colIndex,"add"),this._textClip(r[o].rowIndex,r[o].colIndex,"delete","",!0),u=this._getHiddenCells(i,{rowIndex:r[o].rowIndex,colIndex:r[o].colIndex},r[o],u),this.XLEdit._updateDataContainer({rowIndex:r[o].rowIndex,colIndex:r[o].colIndex},{dataObj:{isMHide:!0,mergeIdx:{rowIndex:e,colIndex:s}},sheetIdx:i}),this._selMergeCells.push(r[o]);return t.isNullOrUndefined(c[e])||n.extend(!0,w,c[e][s]),p=this._getSelRange(r),a._activeCell=r[0],(!a._isImported||a._isLoaded)&&(this.performSelection(r[0],r[r.length-1]),this.XLEdit._updateDataContainer({rowIndex:e,colIndex:s},{dataObj:{merge:{mSpan:l,isMerge:!0,mRange:p,isCenterAlign:this._mergeCenter}}}),this._updateMergeColl(i,e,s,this._mergeCenter?"center":"merge")),f.push({rowIndex:e,colIndex:s,prevObj:w,curObj:n.extend(!0,{},c[e][s])}),a._isImported&&!a._isLoaded||this._isUndoRedo||this._dupDetails||this._paste||this._mergeType!=="merge-cells"||(y={sheetIndex:i,cells:[{rowIndex:e,colIndex:s}],range:p,reqType:"merge-cells",action:"merge-all",hideCells:u,mCells:f},y.operation=this._mergeCenter?"merge-center":"merge-all",this._paste||this._completeAction(y)),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),this._mergeCenter=!1,this._paste=!1,this.XLEdit._updateUsedRange(e+l.rowSpan,s+l.colSpan),{hideCells:u,mCells:f}},mergeAcrossCells:function(i,r){var e=this.getActiveSheetIndex(),o=this.getSheet(e),h=n("#"+this._id+"_alertdlg"),u,f,s;t.isNullOrUndefined(i)&&this.XLSelection.getSelectedCells(e).length<2||this._getAlphaRangeCells(i).length<2||(this._selMergeCells=[],f=this._getSelectedCells(e,i),this.isUndefined(f))||(u=t.isNullOrUndefined(i)?this.model.sheets[e]._selectedCells:this.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]}),s=this._getAlphaRange(e,u[0].rowIndex,u[0].colIndex,u[u.length-1].rowIndex,u[u.length-1].colIndex),!this._isUndoRedo&&this._rangeHasData(f)&&(!o._isImported||o._isLoaded)&&!r&&u.length>1&&u[0].colIndex!=u[u.length-1].colIndex?this._showAlertDlg("","MergeCellsAlert","MergeAcrossCells",498):u[0].colIndex!=u[u.length-1].colIndex&&this._mergeAcrossCells(e,u),this.performSelection(u[0],u[u.length-1]),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons())},_mergeAcrossCells:function(i,r){var u,e,l,o,s=1,a=1,h=!0,v,y,p,w,b,c=[],f={mCells:[],hideCells:{}},k=this.getSheet(i);for(this._mergeType="merge-across",u=0,l=r.length;u<l;u++)if(o=this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"merge",i),t.isNullOrUndefined(o)||(s=o.mSpan.rowSpan,a=o.mSpan.colSpan),s===1&&a===1){h=!1;break}else s>1&&(h=!1);if(!h)for(w=r[0].rowIndex,b=r[r.length-1].rowIndex,y=r[0].colIndex,p=r[r.length-1].colIndex,u=w;u<=b;u++){for(c=[],e=y;e<=p;e++)c.push({rowIndex:u,colIndex:e});f=this._mergeCells(i,c,f.hideCells,f.mCells)}k._isImported&&!k._isLoaded||this._isUndoRedo||this._dupDetails||(v={sheetIndex:i,cells:n.extend(!0,[],this._selMergeCells),range:this._getSelRange(this._selMergeCells),reqType:"merge-cells",action:"merge-across",operation:"merge-across",hideCells:f.hideCells,mCells:f.mCells},this._paste||this._completeAction(v),this._paste=!1);this.performSelection(r[0],r[r.length-1])},unmergeCells:function(n){var u=this.getActiveSheetIndex(),o=this.getSheet(u),s=[],i,c,f,h,e,a=o._clrMergeColl,r,l;if(!this.isUndefined(n)){for(f=typeof n=="string"?this.getRangeIndices(n):n,this._selMergeCells=[],i=t.isNullOrUndefined(n)?this.model.sheets[u]._selectedCells:this.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]}),r=0,l=i.length;r<l;r++)e=this.XLEdit.getPropertyValue(i[r].rowIndex,i[r].colIndex,"merge",u),this.isUndefined(e)||(h=this._getHiddenRowColumnCount(u,e.mRange),s=this._unMergeAllCells(u,r,i,s,h.hRow,h.hCol),a.push({rowIdx:i[r].rowIndex,colIdx:i[r].colIndex,mergeObj:e}));n=this._getSelRange(i);this.performSelection(i[0],i[i.length-1]);o._isImported&&!o._isLoaded||this._isUndoRedo||this._dupDetails||(c={sheetIndex:u,cells:i,range:n,reqType:"merge-cells",action:"un-merge",operation:"un-merge",mCells:s},this._completeAction(c));this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()}},_unMergeAllCells:function(i,r,u,f,e,o){var s,h,e,o,v,k,d=1,g=1,w,b=!1,a=this._dataContainer.sheets[i],it={},p,nt,y,c,l,rt,tt;if(c=u[r].rowIndex,l=u[r].colIndex,rowhdrrows=this.getRows(i)[0],p=this.getCell(c,l),v=this.XLEdit.getPropertyValue(c,l,"merge",i),t.isNullOrUndefined(v)||(d=v.mSpan.rowSpan,g=v.mSpan.colSpan),g>1||d>1)for(tt=a[c][l],n.extend(!0,it,tt),delete tt.merge,delete this.getSheet(i)._mergeColl[c][l],this._isRowViewable(i,c)&&(p=this.getCell(c,l),this.XLEdit.getPropertyValue(c,l,"wrap",i)&&(k=p.find("#"+this._id+"_MergeWrap"),p.innerHTML=k.innerHTML,k.remove()),t.isNullOrUndefined(v.isCenterAlign)||p.removeClass("e-calign"),p[0].colSpan=p[0].rowSpan=1,n(rowhdrrows[c]).height()<p[0].offsetHeight&&this._setRowHdrHeight(i,c),this.XLScroll._getRowHeights(i,c)),f.push({rowIndex:c,colIndex:l,prevObj:it,curObj:n.extend(!0,{},a[c][l])}),rt=[],s=c;s<c+d+e;s++)for(h=l;h<l+g+o;h++)this._selMergeCells.push({rowIndex:s,colIndex:h}),this._isRowViewable(i,s)&&(y=this.getCell(s,h,i),b=!0),t.isNullOrUndefined(this.XLEdit.getPropertyValue(s,h,"isMHide",i))||(this._isUndoRedo&&(w=this.XLEdit.getPropertyValue(s,h,"merge",i),t.isNullOrUndefined(w)||(w.mergeSpan.rowSpan>1||w.mergeSpan.colSpan>1)&&(rt.push({rowIndex:s,colIndex:h,rowSpan:w.mergeSpan.rowSpan,colSpan:w.mergeSpan.colSpan}),a[s][h].merge.mSpan={rowSpan:1,colSpan:1},y[0].rowSpan=1,y[0].colSpan=1)),mergeIdx=this.XLEdit.getPropertyValue(s,h,"mergeIdx",i),t.isNullOrUndefined(mergeIdx)||mergeIdx.rowIndex===c&&mergeIdx.colIndex===l&&(b&&y.removeClass("e-mc-hide"),delete a[s][h].isMHide,delete a[s][h].mergeIdx)),this._isUndoRedo&&!t.isNullOrUndefined(this._delCells)&&(t.isNullOrUndefined(this._delCells[s])||t.isNullOrUndefined(this._delCells[s][h])||t.isNullOrUndefined(a[s])||(nt=!t.isNullOrUndefined(a[s][h])&&a[s][h].overflow,a[s][h]=this._delCells[s][h].value,nt&&(a[s][h].overflow=nt),b&&y.text(this._delCells[s][h].text),v=this.XLEdit.getPropertyValue(s,h,"merge"),!t.isNullOrUndefined(v)&&v.isMerge&&this.mergeCells(v.mRange,!0))),b&&y.hasClass("e-commentcell")&&this.model.allowComments&&this.XLComment._updateCmntArrowPos(y),b&&(this._removeClass(y[0],"e-freezeOverflow"),y.text().length>0?this._textClip(s,h,"add"):this._textClip(s,h,"delete"));return f},showHeaders:function(t){var r,i=this.getActiveSheetIndex(),u=this.getSheet(i),f=this._getJSSheetHeader(i),e=this._getContent(i).find(".e-content"),o=this._getJSSheetRowHeader(i);u.showHeader=t;this._isDisplayHeader=!0;u.showHeader?(o.show(),f.show(),e.removeClass("e-viewbrdr")):(o.hide(),f.hide(),e.addClass("e-viewbrdr"));this.model.showRibbon&&(r=n.extend(!0,{},this.model.scrollSettings),this.XLRibbon._heightWidthCalculation(i,r,{action:""}))},showGridlines:function(n){var t=this.getActiveSheetIndex(),i=this.getSheet(t),r=this._getContent(t).find(".e-rowcell");i.showGridlines=n;i.showGridlines?r.removeClass("e-hborder"):r.addClass("e-hborder")},setSheetFocus:function(){var t=window.pageXOffset,i=window.pageYOffset;n(document.activeElement).hasClass("e-datepicker")||n("#"+this._id).focus();this._isInitLoad||window.scrollTo(t,i)},_diffNumbers:function(n,t){return n-t},_isValidDate:function(n){var t,i;return/^\d{1,4}[\.|\/|-]\d{1,2}[\.|\/|-]\d{1,4}$/.test(n)?(n=n.replace(/0*(\d*)/gi,"$1"),t=n.split(/[\.|\/|-]/),t[1]=t[1]-1,t[2].length<4&&(t[2]=parseInt(t[2])<50?2e3+parseInt(t[2]):1900+parseInt(t[2])),i=new Date(t[2],t[1],t[0]),i.getDate()!=t[0]||i.getMonth()!=t[1]||i.getFullYear()!=t[2]?!1:!0):!1},_isValidTime:function(n){for(var t,r,i=0,o=!1,f,e,u=0,s=n.length;u<s;u++){if(t=n.substring(u,u+1),(t<"0"||t>"9")&&t!=":"&&t!=" "&&t!="a"&&t!="A"&&t!="p"&&t!="P"&&t!="m"&&t!="M")return!1;t==":"&&i++;(t=="p"||t=="P"||t=="a"||t=="A")&&(o=!0)}return i<1||i>2?!1:(r=n.substring(0,n.indexOf(":")),parseFloat(r)<0||parseFloat(r)>23)?!1:o&&(parseFloat(r)<1||parseFloat(r)>12)?!1:(f=i==2?n.substring(n.indexOf(":")+1,n.lastIndexOf(":")):n.substring(n.indexOf(":")+1,n.length),parseFloat(f)<0||parseFloat(f)>59)?!1:(e=i==2?n.substring(n.lastIndexOf(":")+1,n.length):"00",parseFloat(e)<0||parseFloat(e)>59)?!1:!0},_setXY:function(n){var t=0,i=0;return n.type==="mousemove"||n.type==="mousedown"?(t=n.clientX,i=n.clientY):n.type==="touchmove"?(t=n.originalEvent.changedTouches[0].clientX,i=n.originalEvent.changedTouches[0].clientY):n.type==="MSPointerMove"&&(t=n.originalEvent.clientX,i=n.originalEvent.clientY),[t,i]},_getSelectedItems:function(n,i,r){var f,e,o,u;return n=n?n:this.getActiveSheetIndex(),u=this.getSheet(n),t.isNullOrUndefined(r)&&t.isNullOrUndefined(i)?(f=u._selectedCells,e=u._startCell,o=u._endCell,r=this._generateHeaderText(n,e.colIndex+1)+(e.rowIndex+1)+":"+this._generateHeaderText(n,o.colIndex+1)+(o.rowIndex+1)):(i=this.isUndefined(i)?this.getRangeIndices(r):i,f=this.getRange(i,n),r=this._generateHeaderText(n,i[1]+1)+(i[0]+1)+":"+this._generateHeaderText(n,i[3]+1)+(i[2]+1)),[f,r]},setBorder:function(n,t){if(this.model.allowCellFormatting){var f="",e=!1,l=n.style,u=n.type,h=n.color,o,a,c,v,r,y,s=this._getContent(this.getActiveSheetIndex()).find("div:first-child");o=["bottom","top","left","right","outside","allborder"];a=["thickbox","thickbottom","topandbottom","topandthickbottom"];c={top:{top:""},right:{right:""},bottom:{bottom:""},left:{left:""},outside:{top:"",right:"",bottom:"",left:""},thickbox:{top:"2px solid",right:"2px solid",bottom:"2px solid",left:"2px solid"},thickbottom:{bottom:"2px solid"},topandbottom:{top:"1px solid",bottom:"1px solid"},topandthickbottom:{top:"1px solid",bottom:"2px solid"}};v={solid:"1px solid",dashed:"1px dashed",dotted:"1px dotted"};this.XLSelection._isGridBordering=this.XLSelection._isOutsideBordering=!1;switch(!0){case o.indexOf(u)>-1:e=u===o[5];r=c[e?o[4]:u];for(i in r)r[i]=v[l]+" "+h;e&&(r.isGridBorder=e);this.XLFormat.applyBorder(r,t);break;case a.indexOf(u)>-1:r=c[u];for(i in r)f="",y=r[i].split(" "),f=y.length===2?f+r[i]+" "+h:f+r[i]+" "+l+" "+h,r[i]=f;this.XLFormat.applyBorder(r,t);break;case u==="noborder":this.XLFormat.format({border:{}},t);break;case u==="drawborder":this.XLSelection._isOutsideBordering=!0;s.removeClass("e-ss-cursor");s.addClass("e-ss-drwbrdrcursor");this.XLSelection._cleanUp(!0);break;case u==="drawbordergrid":this.XLSelection._isGridBordering=!0;s.removeClass("e-ss-cursor");s.addClass("e-ss-drwbrdrgridcursor");this.XLSelection._cleanUp(!0)}}},clearBorder:function(n){n=this.getRangeIndices(n);this.XLFormat.removeStyle(n,{cellStyle:!0,tableStyle:!0,border:!0})},clearAllFormat:function(i){var s=this.getActiveSheetIndex(),c=this._dataContainer.sheets[s],u=[],f,e,h=this.getSheet(s),r=this.isUndefined(i)?h.selectedRange:this.getRangeIndices(i),o={sheetIndex:s,reqType:"clear-format",range:r};(o.bData=n.extend(!0,[],this.getRangeData(r,!1,["format","tformats","type","formatStr","decimalPlaces","thousandSeparator","formats","hyperlink","cFormatRule"])),this._dupDetails=!0,f=this.getObjectKeys(c),u[0]=r[0]>parseInt(f[0])?r[0]:parseInt(f[0]),u[2]=r[2]<parseInt(f[f.length-1])?r[2]:parseInt(f[f.length-1]),e=this.getObjectKeys(c[u[2]]),u[1]=r[1]>parseInt(e[0])?r[1]:parseInt(e[0]),u[3]=r[3]<parseInt(e[e.length-1])?r[3]:parseInt(e[e.length-1]),t.isNullOrUndefined(f))||(isTable=this._checkTableRange(this._getAlphaRange(s,u[0],u[1],u[2],u[3])),o.tblObj=isTable.tblObj,isTable.status?this.clearRangeData(r,["format","formatStr","decimalPlaces","thousandSeparator","formats","tborder","tformats","hyperlink","cFormatRule"],"",!1,o.reqType):this.clearRangeData(r,["format","formatStr","decimalPlaces","thousandSeparator","formats","hyperlink","cFormatRule"],"",!1,o.reqType),this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(r),h._clrWrapColl=[],this.setWrapText("unwrap",r),o.wrapColl=n.extend(!0,[],h._clrWrapColl),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),this._dupDetails=!1,this._isUndoRedo||this._completeAction(o))},clearContents:function(t){t=this.isUndefined(t)?this.getSheet(i).selectedRange:this.getRangeIndices(t);var i=this.getActiveSheetIndex(),u=this.getRangeData(t),r={sheetIndex:i,reqType:"clear-content",range:t,bData:n.extend(!0,[],u)};this.clearRangeData(t,["value","value2","hyperlink"],"",!1,r.reqType);this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t);this._completeAction(r);this.setSheetFocus()},clearAll:function(i){var f,e,s=this.getActiveSheetIndex(),h=this.getSheet(s),u=[],r=this.isUndefined(i)?h.selectedRange:this.getRangeIndices(i),o={sheetIndex:s,reqType:"clear-all",range:r},c=this._dataContainer.sheets[s];(this._dupDetails=!0,f=this.getObjectKeys(c),u[0]=r[0]>parseInt(f[0])?r[0]:parseInt(f[0]),u[2]=r[2]<parseInt(f[f.length-1])?r[2]:parseInt(f[f.length-1]),e=this.getObjectKeys(c[u[2]]),u[1]=r[1]>parseInt(e[0])?r[1]:parseInt(e[0]),u[3]=r[3]<parseInt(e[e.length-1])?r[3]:parseInt(e[e.length-1]),t.isNullOrUndefined(f)||t.isNullOrUndefined(e))||(o.bData=n.extend(!0,[],this.getRangeData(r,!1,["value","value2","hyperlink","merge","wrap","cFormatRule","comment","format","formats","tformat"],s)),isTable=this._checkTableRange(this._getAlphaRange(s,u[0],u[1],u[2],u[3])),isTable.status&&(o.tblObj=isTable.tblObj,o.tblId=isTable.tblId,this.XLFormat.removeTable(o.tblId)),this.clearRangeData(r,["value","value2","hyperlink","cFormatRule","comment","format","formats"],"",!1),this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(r),this.model.allowDataValidation&&this.XLValidate.clearDV(),this.setWrapText("unwrap",r),h._clrMergeColl=[],h._clrWrapColl=[],this.unmergeCells(r),o.mergeColl=n.extend(!0,[],h._clrMergeColl),o.wrapColl=n.extend(!0,[],h._clrWrapColl),this._dupDetails=!1,this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),this.XLRibbon._toggleDesignTab(this.getActiveCell()),this._completeAction(o))},_checkTableRange:function(n,i){var f,e=this.getActiveSheetIndex(),h=this.model.sheets[e],r,u,o=this.getRangeIndices(n),s=i?this.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"tableName"):this.XLEdit.getPropertyValue(o[0],o[1],"tableName");return s&&(r=this._getTableID(s)),t.isNullOrUndefined(r)?{status:!1}:(u=h._tableManager[r],tRange=u.range,f=this._getAlphaRange(e,tRange[0],tRange[1],tRange[2],tRange[3]),n===f?{status:!0,tableObj:u,tblId:r}:{status:!1})},clearTextNode:function(n,i){if(!t.isNullOrUndefined(n)){var r=this.getActiveSheetIndex(),u=n[0].parentNode.rowIndex,f=n[0].cellIndex,o=this._dataContainer.sheets[r],e=n[0].childNodes[n[0].childNodes.length-1];(i=i||"",this._checkIndicesInContainer(r,u,f,"rule")&&o[u][f].rule.type==="list")||t.isNullOrUndefined(e)||e.hasChildNodes("a")||(n[0].lastChild.textContent=i)}},_changeTargetWithOffset:function(i){var r,u=i.offsetX||i.pageX-n(i.target).offset().left;if(this._hasClass(n(document.activeElement),"e-datepicker")&&i.type==="mouseup"&&n("#"+this._id).focus(),n(i.target).is("a")&&(r=i.target,i.target=i.target.parentNode),n(i.target).is("#"+this._id+"_MergeWrap"))return n(i.target).parents().closest("td")[0];if(this._hasClass(n(i.target).parents().closest("td"),"e-cellreadonly"))return this._hasClass(n(i.target),"e-datepicker")&&i.type==="mouseup"&&n(i.target).focus(),n(i.target).parents().closest("td")[0];if(n(i.target).is("td")&&this._hasClass(n(i.target),"e-cellreadonly")&&!t.isNullOrUndefined(n(i.target).find(".e-chk-image"))&&i.type==="mouseup")return n("#"+n(i.target).find(".e-checkbox")[0].id).ejCheckBox("instance")._checkedHandler(),i.target;if(u>i.target.offsetWidth&&n(i.target).is("td")){var f=this.getSheet(this.getActiveSheetIndex()),e=this._getCellIdx(i.target),o=f._colWidthCollection[e.colIndex]+u,s=f._rowHeightCollection[e.rowIndex];return r&&this.addClass(r,"e-rmanchor"),this.getCell(this.XLShape._getCellIndexFromOffset(s,o).rowIndex,this.XLShape._getCellIndexFromOffset(s,o).colIndex)[0]}return r?(this._removeClass(r,"e-rmanchor"),r):(this._removeClass(n(i.target).find("a")[0],"e-rmanchor"),i.target)},_textClip:function(i,r,u,f,e){var o,y,s;if(!this.XLEdit.getPropertyValue(i,r,"merge")&&!this.XLEdit.getPropertyValue(i,r,"wrap")){var b,k=!1,l,d=!1,p=this.getActiveSheetIndex(),g,nt=this.getSheet(p),tt=nt._rowHeightCollection,it=nt._colWidthCollection,w=this._dataContainer.sheets[p],h=this.XLEdit,a,c=h.getPropertyValue(i,r,"overflow"),v=this.getSheet(p)._isLoaded;if(v&&(a=this.getCell(i,r)),!(this.XLEdit.getPropertyValue(i,r,"cellType")>-1)){if(this._dupDetails||(this._dupDetails=!0,k=!0),u==="add"){if(this._hasClass(a,"e-overflow")&&(this._removeClass(a,"e-overflow"),this.clearRangeData([i,r,i,r],["isOverflow"],"","","",!0)),this._refreshGlobalSpan(),span=n("#"+this._id+"_emptySpan"),f||(this.addClass(span,"e-rowcell e-wrapword"),this.addClass(span,h.getPropertyValue(i,r,"format")),span.text(h.getPropertyValue(i,r,"value2")),f=span.width()),this._refreshGlobalSpan(),b=this.XLShape._getCellIndexFromOffset(tt[i],it[r]+f),l=b.colIndex-r,!e&&!t.isNullOrUndefined(c)&&c.rowIndex===i)for(g=v&&this.getCell(c.rowIndex,c.colIndex),this.addClass(g,"e-overflow"),h._updateDataContainer({rowIndex:c.rowIndex,colIndex:c.colIndex},{dataObj:{isOverflow:!1},skipCell:!0}),o=0,y=w[i][r].overflow.cellCount;o<=y;o++)o!==0&&this.clearRangeData([i,c.colIndex+o,i,c.colIndex+o],["overflow"],"","","",!0),o!==y&&(this._removeClass(v&&this.getCell(i,c.colIndex+o),"e-ofbrdr"),this.clearRangeData([i,c.colIndex+o,i,c.colIndex+o],["isOfBrdr"],"","","",!0));for(o=1;o<=l;o++)if(h.getPropertyValue(i,r+o,"value2")||h.getPropertyValue(i,r+o,"merge")||h.getPropertyValue(i,r+o,"isMHide")){d=!0;break}if(d)this.addClass(a,"e-overflow"),h._updateDataContainer({rowIndex:i,colIndex:r},{dataObj:{isOverflow:!1},skipCell:!0});else if(l!==0)for(o=0;o<=l;o++)o&&h._updateDataContainer({rowIndex:i,colIndex:r+o},{dataObj:{overflow:{rowIndex:i,colIndex:r,cellCount:l}},skipCell:!0}),o!==l&&(this.addClass(v&&this.getCell(i,r+o),"e-ofbrdr"),h._updateDataContainer({rowIndex:i,colIndex:r+o},{dataObj:{isOfBrdr:!0},skipCell:!0}))}else if(u==="delete"){if(keys=this.getObjectKeys(w[i]),this._hasClass(a,"e-overflow")&&(this._removeClass(a,"e-overflow"),this.clearRangeData([i,r,i,r],["isOverflow"],"","","",!0)),!t.isNullOrUndefined(h.getPropertyValue(i,r+1,"overflow"))&&h.getPropertyValue(i,r+1,"overflow").colIndex===r)for(s=r,y=r+1+w[i][r+1].overflow.cellCount;s<y;s++)s!==r&&this.clearRangeData([i,s,i,s],["overflow"],"","","",!0),s!==y&&(this._removeClass(v&&this.getCell(i,s),"e-ofbrdr"),this.clearRangeData([i,s,i,s],["isOfBrdr"],"","","",!0));if(!e)for(s=keys.length-1;s>-1;s--)if(keys[s]<r&&(parseCell=v&&this.getCell(i,keys[s]),h.getPropertyValue(i,keys[s],"value2")||h.getPropertyValue(i,keys[s],"isMHide"))){this._hasClass(parseCell,"e-overflow")&&(this._removeClass(parseCell,"e-overflow"),this.clearRangeData([i,keys[s],i,keys[s]],["isOverflow"],"","","",!0),this._textClip(i,parseInt(keys[s]),"add"));break}}k&&(this._dupDetails=!1)}}},selectAll:function(){var i,n,v=!1,c=0,h=this.XLEdit,y=this._getCellIdx(this.getActiveCellElem()[0]),u=y.rowIndex,f=y.colIndex,a=this.getActiveSheetIndex(),b=this._dataContainer.sheets[a],l=this.getObjectKeys(b),k=parseInt(l[0]),d=parseInt(l[l.length-1]),e=this.getSheet(a),p=this._getUsedRangeFromSheet(a,!1),w=p.rowCount+p.colCount;if(e._startCell.rowIndex!==e._endCell.rowIndex||e._startCell.colIndex!==e._endCell.colIndex&&e._isMultiSelect){var r={rowIndex:e._startCell.rowIndex,colIndex:e._startCell.colIndex},t={rowIndex:e._endCell.rowIndex,colIndex:e._endCell.colIndex},s={rowIndex:e._startCell.rowIndex,colIndex:e._startCell.colIndex},o={rowIndex:e._endCell.rowIndex,colIndex:e._endCell.colIndex};for(v=!0,i=1;i<w;i++){for(n=s.colIndex;n<o.colIndex+2;n++)h.getPropertyValue(s.rowIndex-1,n,"value2")&&(r.colIndex=s.colIndex<n?s.colIndex:n,t.colIndex=o.colIndex>n?o.colIndex:n,r.rowIndex=s.rowIndex<s.rowIndex-1?s.rowIndex:s.rowIndex-1);for(n=s.rowIndex;n<o.rowIndex+2;n++)h.getPropertyValue(n,o.colIndex+1,"value2")&&(t.rowIndex=o.rowIndex>n?o.rowIndex:n);for(n=o.colIndex;n>s.colIndex-2;n--)h.getPropertyValue(o.rowIndex+1,n,"value2")&&(t.rowIndex=o.rowIndex>o.rowIndex+1?o.rowIndex:o.rowIndex+1,r.colIndex=s.colIndex<n?s.colIndex:n);for(n=o.rowIndex;n>s.rowIndex-2;n--)h.getPropertyValue(o.rowIndex+1,n,"value2")&&(t.rowIndex=o.rowIndex>o.rowIndex+1?o.rowIndex:o.rowIndex+1,r.colIndex=s.colIndex<n?s.colIndex:n);if(t.colIndex===o.colIndex&&t.rowIndex===o.rowIndex&&r.rowIndex===s.rowIndex&&r.colIndex===s.colIndex)if(i===1){e._isRangeSelected=!0;break}else{e._isRangeSelected=!1;break}s={rowIndex:r.rowIndex,colIndex:r.colIndex};o={rowIndex:t.rowIndex,colIndex:t.colIndex}}}if(!e._isRangeSelected&&!v){var r={rowIndex:u,colIndex:f},t={rowIndex:u,colIndex:f},s={rowIndex:u,colIndex:f},o={rowIndex:u,colIndex:f};for(i=1;i<w+1;i++){for(n=-c;n<c+1;n++)h.getPropertyValue(u+n,f+i,"value2")&&(t.rowIndex=t.rowIndex>u+n?t.rowIndex:u+n,t.colIndex=t.colIndex>f+i?t.colIndex:f+i);for(h.getPropertyValue(u+i,f+i,"value2")&&(t.rowIndex=t.rowIndex>u+i?t.rowIndex:u+i,t.colIndex=t.colIndex>f+i?t.colIndex:f+i),n=-c;n<c+1;n++)h.getPropertyValue(u+i,f+n,"value2")&&(t.rowIndex=t.rowIndex>u+i?t.rowIndex:u+i,t.colIndex=t.colIndex>f+n?t.colIndex:f+n);if(!h.getPropertyValue(u,f,"value2")&&t.colIndex===o.colIndex&&t.rowIndex===o.rowIndex&&r.rowIndex===s.rowIndex&&r.colIndex===s.colIndex&&c===0){e._isRangeSelected=!0;break}for(h.getPropertyValue(u+i,f-i,"value2")&&(t.rowIndex=t.rowIndex>u+i?t.rowIndex:u+i,r.colIndex=r.colIndex<f-i?r.colIndex:f-i),n=-c;n<c+1;n++)h.getPropertyValue(u+n,f-i,"value2")&&(r.rowIndex=r.rowIndex<u+n?r.rowIndex:u+n,r.colIndex=r.colIndex<f-i?r.colIndex:f-i,t.rowIndex=t.rowIndex>u+n?t.rowIndex:u+n);for(h.getPropertyValue(u-i,f-i,"value2")&&(r.rowIndex=r.rowIndex<u-i?r.rowIndex:u-i,r.colIndex=r.colIndex<f-i?r.colIndex:f-i),n=-c;n<c+1;n++)h.getPropertyValue(u-i,f+n,"value2")&&(r.rowIndex=r.rowIndex<u-i?r.rowIndex:u-i,r.colIndex=r.colIndex<f+n?r.colIndex:f+n,t.colIndex=t.colIndex>f+n?t.colIndex:f+n);if(h.getPropertyValue(u-i,f+i,"value2")&&(r.rowIndex=r.rowIndex<u-i?r.rowIndex:u-i,t.colIndex=t.colIndex>f+i?t.colIdx:f+i),t.colIndex===o.colIndex&&t.rowIndex===o.rowIndex&&r.rowIndex===s.rowIndex&&r.colIndex===s.colIndex)if(c!==0){e._isRangeSelected=!1;break}else{e._isRangeSelected=!0;break}s={rowIndex:r.rowIndex,colIndex:r.colIndex};o={rowIndex:t.rowIndex,colIndex:t.colIndex};c++}}e._isEmptyActiveCell||(!e._isRangeSelected&&!l.length<1?(this.XLSelection.selectRange(r,t),e._isMultiSelect=!1,e._startCell=r,e._endCell=t,e._isRangeSelected=!0,e._isEmptyActiveCell=h.getPropertyValue(u,f,"value2")?!1:!0):(this.XLSelection.selectSheet(),e._isRangeSelected=!0))},_getUsedRangeFromSheet:function(n,t){var u,o=n?n:this.getActiveSheetIndex(),s=this._dataContainer,e=s.sheets[o],f=this.getObjectKeys(e),i={rowIndex:parseInt(f[0]),colIndex:0},r={rowIndex:parseInt(f[f.length-1]),colIndex:0};for(u=0,length=f.length;u<length;u++)colKeys=this.getObjectKeys(e[parseInt(f[u])]),u===0?(i.colIndex=parseInt(colKeys[0]),r.colIndex=parseInt(colKeys[colKeys.length-1])):(i.colIndex=i.colIndex<parseInt(colKeys[0])?i.colIndex:parseInt(colKeys[0]),r.colIndex=r.colIndex>parseInt(colKeys[colKeys.length-1])?r.colIndex:parseInt(colKeys[colKeys.length-1]));return t?this._getAlphaRange(n,i.rowIndex,i.colIndex,r.rowIndex,r.colIndex):{startCell:i,endCell:r,rowCount:r.rowIndex-i.rowIndex+1,colCount:r.colIndex-i.colIndex+1}},sheetRename:function(n){this._updateSheetNames(n)},_isSubMenuOpen:function(){for(var i=["_formatastable","_cellstyles","_Ribbon_CElement","_contextMenuCell","_contextMenuColumnHeader","_contextMenuRowHeader","_contextMenuFooter"],t=0,r=i.length;t<r;){if(n("#"+this._id+i[t]).is(":visible"))return!0;t++}return!1},copySheet:function(n,i,r){var y=this._getSheetIndex(y),u,f,a,e,v=!1,c=2,h,s=this.model.sheets,o=this.element.find("#NumericContainer").children().eq(n-1),l=i;if(!r&&s[l]._sheetName.text===o.text()){this.setSheetFocus();return}for(f=1,a=s.length;f<a;f++)s.length-1!==l&&s[l]._sheetName.text===s[f]._sheetName.text&&(u=f),o.text()===s[f]._sheetName.text&&(h=f);if(r){for(o.text().match(".*[ ]+[(]+[0-9]+[)]$")===null?e=o.text()+" ("+c+")":o.text().lastIndexOf(" ")>-1&&(c=parseInt(o.text().substring(o.text().lastIndexOf("(")+1,o.text().lastIndexOf(")"))),e=o.text().substring(0,o.text().lastIndexOf(" "))+" ("+c+")");!v;){for(e=e.substring(0,e.lastIndexOf(" "))+" ("+c+")",f=1,a=s.length;f<a;f++)e===s[f]._sheetName.text&&c++;c===parseInt(e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")")))&&(v=!0)}this._copySheetProcess(h,e);h=this.model.sheetCount;t.isNullOrUndefined(u)&&(u=h)}else!t.isNullOrUndefined(u)&&u>h&&(u=u-1);t.isNullOrUndefined(u)&&(u=l);r||u!==h?(this._swapSheetDtCntr(h,u),this.getPager().ejPager("option",{currentPage:l}),this.gotoPage(l,!1),this.setSheetFocus()):this.setSheetFocus()},getHyperlink:function(n){return this.XLEdit.getPropertyValueByElem(n,"hyperlink",this.getActiveSheetIndex())},getComment:function(n){return this.XLEdit.getPropertyValueByElem(n,"comment",this.getActiveSheetIndex())},_isvalidRange:function(n){var t=new RegExp(/^\$?(?:\b[a-z]{1,3})\$?(?:\d{1,7}):\$?(?:\b[a-z]{1,3})\$?(?:\d{1,7})$/i);return t.test(n)},_renderFUpload:function(){this.element.append(t.buildTag("div","","",{id:this._id+"_file"}));n("#"+this._id+"_file").ejUploadbox({width:"0px",height:"0px",uploadName:"file",autoUpload:!0,showFileDetails:!1,dialogAction:{content:this.element},saveUrl:this.model.importSettings.importMapper,fileSelect:n.proxy(this._fileSelect,this),complete:n.proxy(this._changeImport,this),error:n.proxy(this._importFailed,this)});n("#"+this._id+"_file_SelectButton").hide()},_fileSelect:function(t){var r=t.files[0],i=r.extension;if(this._uploadImage&&i===".xlsx"||!this._uploadImage&&((this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10)?i.indexOf("jpg")>-1||i.indexOf("png")>-1||i.indexOf("jpeg")>-1||i.indexOf("gif")>-1:r.rawFile.type.indexOf("image")>-1))return this._showAlertDlg("Alert","CorrectFormat","",290),this._uploadImage=!1,!1;if(this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10||this._uploadImage)this.showWaitingPopUp();else return n("#"+this._id+"_file").ejUploadbox("option","autoUpload",!1),this["import"]({file:r.rawFile,password:this._encrypt(this.model.importSettings.password),allowSheetOnDemand:this.model.importSettings.allowSheetOnDemand}),this._uploadImage=!1,!1;this._uploadImage=!1},_changeImport:function(t){var r,i=n("#"+this._id+"_file").data("ejUploadbox");((this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10)?t.files[0].extension.indexOf("jpg")>-1||t.files[0].extension.indexOf("png")>-1||t.files[0].extension.indexOf("jpeg")>-1||t.files[0].extension.indexOf("gif")>-1:t.files.rawFile.type.indexOf("image")>-1)?(i.updialog.ejDialog("close"),this.XLShape._insertPicture(t),this.model.showRibbon&&this.XLRibbon._formatTabUpdate(),i.option("autoUpload",!0)):(r=this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10?t.responseText:t.xhr.response,i.updialog.ejDialog("close"),this._importSuccess(r));this.hideWaitingPopUp()},_importFailed:function(n){var t={failureType:n.type};n.xhr?(t.status=n.xhr.status,t.statusText=n.xhr.statusText):t.statusText=n.error;this.hideWaitingPopUp();this._trigger("openFailure",t)},_dlgBeforeOpen:function(){var t=n("#"+this._id+"_PasswordDialog").data("ejDialog");this.hideWaitingPopUp();n("#"+this._id+"_workBookName").text("'"+n("#"+this._id+"_file").data("ejUploadbox")._files[0].name+"'"+this._getLocStr("Protect"))},_dlgOk:function(){var r,t=n("#"+this._id+"_PasswordDialog").data("ejDialog"),i=n("#"+this._id+"_xlpassword"),u=n("#"+this._id+"_confirmpassword");r=n("#"+this._id+"_Ribbon_protectWorkbook").data("ejToggleButton");t.model.title==="Protect Workbook"?i.val().length&&u.val().length?i.val()===u.val()?(this.model.exportSettings.password=i.val(),n("#"+this._id+"_AddSheet").addClass("e-disable"),n("#"+this._id+"_confirm").hide(),t.option("title",this._getLocStr("UnProtectWorkbook"))):(n("#"+this._id+"_confirm").show(),this._showAlertDlg("Alert","PasswordAlert1"),r.option("toggleState",!1),t.option("title",this._getLocStr("ProtectWorkbook"))):(n("#"+this._id+"_confirm").show(),r.option("toggleState",!1),t.option("title",this._getLocStr("ProtectWorkbook")),this._showAlertDlg("Alert","PasswordAlert2")):t.model.title==="Unprotect Workbook"&&(this.model.exportSettings.password===i.val()?(n("#"+this._id+"_AddSheet").removeClass("e-disable"),this.model.exportSettings.password=null,n("#"+this._id+"_confirm").show(),t.option("title",this._getLocStr("ProtectWorkbook"))):(t.option("title",this._getLocStr("UnProtectWorkbook")),r.option("toggleState",!0),this._showAlertDlg("Alert","PasswordAlert3")));i.val("");u.val("");n("#"+this._id+"_PasswordDialog").ejDialog("close")},_passwordDlg:function(){var n,f,i,r,u,e;n=t.buildTag("div","","",{id:this._id+"_PasswordDialog"});u=t.buildTag("div.e-dlg-btnfields");e=t.buildTag("div.e-dlg-btnctnr");f="<div class= 'e-dlgctndiv'><table><tr class= 'e-dlgtd-fields'><td><label>"+this._getLocStr("Password")+":<\/label><\/td><td><input id ='"+this._id+"_xlpassword' type ='password' class = 'ejinputtext'/><\/td><\/tr><tr class= 'e-dlgtd-fields' id ='"+this._id+"_confirm'><td><label>"+this._getLocStr("ConfirmPassword")+"<\/label><\/td><td><input id ='"+this._id+"_confirmpassword' type ='password'  class = 'ejinputtext'/><\/td><\/tr><\/table><\/div>";n.append(f);i=t.buildTag("input","","",{type:"submit"});r=t.buildTag("input");i.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgOk,this),enabled:!0});r.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._dlgCancel,this),showRoundedCorner:!0,width:60});u.append(e.append(i,r));n.append(u);n.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("ProtectWorkbook"),width:420,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg",close:t.proxy(this._dlgCancel,this)})},_importPasswordDlg:function(){var i,e,r,u,f,o;i=t.buildTag("div","","",{id:this._id+"_ImportPasswordDialog"});f=t.buildTag("div.e-dlg-btnfields");o=t.buildTag("div.e-dlg-btnctnr");e="<div class= 'e-dlgctndiv'><table><tr class= 'e-dlgtd-fields'><td><label id ='"+this._id+"_workBookName' ><\/label><\/td><\/tr><tr class= 'e-dlgtd-fields'><td><label>"+this._getLocStr("Password")+":<\/label><\/td><td><input id ='"+this._id+"_importpassword' type ='password'  class = 'ejinputtext'/><\/td><\/tr><\/table><\/div>";i.append(e);r=t.buildTag("input","","",{type:"submit"});u=t.buildTag("input");r.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._importDlgOk,this),enabled:!0});u.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._dlgCancel,this),showRoundedCorner:!0,width:60});f.append(o.append(r,u));i.append(f);i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("Password"),beforeOpen:n.proxy(this._dlgBeforeOpen,this),width:420,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg",close:t.proxy(this._dlgCancel,this)})},_dlgCancel:function(){var t=n("#"+this._id+"_PasswordDialog").data("ejDialog");t.model.title==="Protect Workbook"?n("#"+this._id+"_Ribbon_protectWorkbook").ejToggleButton("option","toggleState",!1):t.model.title==="Unprotect Workbook"&&n("#"+this._id+"_Ribbon_protectWorkbook").ejToggleButton("option","toggleState",!0);n("#"+this._id+"_confirmpassword").val("");n("#"+this._id+"_xlpassword").val("");n("#"+this._id+"_importpassword").val("");n("#"+this._id+"_PasswordDialog").ejDialog("close");n("#"+this._id+"_ImportPasswordDialog").ejDialog("close")},_importDlgOk:function(){var t={},i=n("#"+this._id+"_importpassword");this.model.importSettings.password=i.val();i.val("");n("#"+this._id+"_ImportPasswordDialog").ejDialog("close");t.file=n("#"+this._id+"_file").data("ejUploadbox")._files[0].rawFile;t.password=this._encrypt(this.model.importSettings.password);t.allowSheetOnDemand=this.model.importSettings.allowSheetOnDemand;this["import"](t)},lockCells:function(n,t){var i,r=this.getActiveSheetIndex(),u=this.getSheet(r);i=t!=!1;this.model.allowLockCell&&!u._isSheetProtected&&(n=this._toIntrnlRange(n),i?this.updateUniqueData({isLocked:!0},n):this.clearRangeData(n,["isLocked"]),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons())},protectSheet:function(t){var i,u,f=this.getActiveSheetIndex(),e=this.getSheet(f),r=this.XLRibbon;i=t!==!1;this.model.allowLockCell&&(e._isSheetProtected=i,this.model.showRibbon&&(u=n("#"+this._id+"_Ribbon_LockCell").data("ejToggleButton"),u.option("enabled",!i),i?r._disableRibbonIcons():r._enableRibbonIcons(),r._updateRibbonIcons()),this.model.allowFormulaBar&&this.updateFormulaBar(),this.model.allowUndoRedo&&(this.model.sheetCount>1?this._removeUndoRedoForCurSheet(f,"undo"):(this._undoCollection=[],this._redoCollection=[])))},_israngeProtected:function(n){for(var t=0,i=!1;t<n.length;){if(this.XLEdit.getPropertyValue(n[t].rowIndex,n[t].colIndex,"isLocked")){i=!0;break}t++}return i},_isCellProtected:function(n,t,i){if(this.model.allowLockCell&&this.getSheet(this.getActiveSheetIndex())._isSheetProtected&&this.XLEdit.getPropertyValue(n,t,"isLocked"))return i&&this._popUplockCellAlert(),!0},_popUplockCellAlert:function(){this._showAlertDlg("Alert","LockAlert","",500)},_removeUndoRedoForCurSheet:function(n,t){var r=t==="undo"?this._undoCollection:this._redoCollection,i=r.length;if(i)while(i--)n===r[i].sheetIndex&&r.splice(i,1);t==="undo"&&this._removeUndoRedoForCurSheet(n,"redo")},_detailsFromGlobalSpan:function(i,r,u,f,e){var o,a,f=f||"w",s="e-rowcell ",h,c,l,v=this._browserDetails.name==="mozilla"?2:1;return this._isWidth=!this.isUndefined(e),this._refreshGlobalSpan(),o=this._isWidth?n("#"+this._id+"_emptyDiv"):n("#"+this._id+"_emptySpan"),o[0].style.width=e+"px",h=this.XLEdit.getPropertyValue(i,r,"format"),c=this.XLEdit.getPropertyValue(i,r,"border"),l=this.XLEdit.getPropertyValue(i,r,"wrap"),t.isNullOrUndefined(h)||(s+=h+" "),t.isNullOrUndefined(c)||(s+=c+" "),t.isNullOrUndefined(l)||(s+=l),this.addClass(o,s),o.text(f),a=u==="height"?o.outerHeight()+v:o.outerWidth()+v,this._refreshGlobalSpan(),a},_encrypt:function(n){if(!t.isNullOrUndefined(n)){for(var r="",i=0;i<n.length;++i)r+=String.fromCharCode(129^n.charCodeAt(i));return r}}});t.Spreadsheet.Locale=t.Spreadsheet.Locale||{};t.Spreadsheet.Locale["default"]=t.Spreadsheet.Locale["en-US"]={Cut:"Cut",Copy:"Copy",FormatPainter:"Format Painter",Paste:"Paste",PasteValues:"Paste Values Only",PasteSpecial:"Paste",Filter:"Filter",FilterContent:"Turn on filtering for the selected cells.",FilterSelected:"Filter by Selected Cell's value",Sort:"Sort",Clear:"Clear",ClearContent:"Delete everything in the cell, or remove just the formatting, contents, comments or hyperlinks.",ClearFilter:"Clear Filter",ClearFilterContent:"Clear the filter and sort state for the current range of data.",SortAtoZ:"Sort A to Z",SortAtoZContent:"Lowest to Highest.",SortZtoA:"Sort Z to A",SortZtoAContent:"Highest to Lowest.",SortSmallesttoLargest:"Sort Smallest to Largest",SortLargesttoSmallest:"Sort Largest to Smallest",SortOldesttoNewest:"Sort Oldest to Newest",SortNewesttoOldest:"Sort Newest to Oldest",Insert:"Insert",InsertTitle:"Insert Cells",InsertContent:"Add new cells, rows, or columns to your workbook.<br /><br />FYI: To insert multiple rows or columns at a time, select multiple rows or columns in the sheet, and click Insert.",InsertSBContent:"Add cells, rows, columns, or sheets to your workbook.",Delete:"Delete",DeleteTitle:"Delete Cells",DeleteContent:"Delete cells, rows, columns, or sheets from your workbook.<br /><br />FYI: To delete multiple rows or columns at a time, select multiple rows or columns in the sheet, and click Delete.",FindSelectTitle:"Find & Select",FindSelectContent:"Click to see options for finding text in your document.",CalculationOptions:"Calculation Options",CalcOptTitle:"Calculation Options",CalcOptContent:"Choose to calculate formulas automatically or manually.<br/><br/>If you make a change that affects a value, Spreadsheet will automatically recalculate it.",CalculateSheet:"Calculate Sheet",CalculateNow:"Calculate Now",CalculateNowContent:"Calculate the entire workbook now.<br/><br/>You only need to use this if automatic calculation is turned off.",CalculateSheetContent:"Calculate the active sheet now.<br/><br/>You only need to use this if automatic calculation is turned off.",Title:"Spreadsheet",Ok:"OK",Cancel:"Cancel",Alert:"We couldn't do this for the selected range of cells. Select a single cell within a range of data and then try again.",HeaderAlert:"The command could not be completed as you are attempting to filter with the filter header. Select a single cell in the filter range and try the command again.",FlashFillAlert:"All the data next to your selection was checked and there was no pattern for filling in values.",Formatcells:"Format Cells",FontFamily:"Font",FFContent:"Pick a new font for your text.",FontSize:"Font Size",FSContent:"Change the size of your text.",IncreaseFontSize:"Increase Font Size",IFSContent:"Make your text a bit bigger.",DecreaseFontSize:"Decrease Font Size",DFSContent:"Make your text a bit smaller.",Bold:"Bold",Italic:"Italic",Underline:"Underline",Linethrough:"Linethrough",FillColor:"Fill Color",FontColor:"Font Color",TopAlign:"Top Align",TopAlignContent:"Align text to the top.",MiddleAlign:"Middle Align",MiddleAlignContent:"Align text so that it is centered between the top and bottom of the cell.",BottomAlign:"Bottom Align",BottomAlignContent:"Align text to the bottom.",WrapText:"Wrap Text",WrapTextContent:"Wrap extra-long text into multiple lines so you can see all of it.",AlignLeft:"Align Left",AlignLeftContent:"Align your content to the left.",AlignCenter:"Center",AlignCenterContent:"Center your content.",AlignRight:"Align Right",AlignRightContent:"Align your content to the right.",Undo:"Undo",Redo:"Redo",NumberFormat:"Number Format",NumberFormatContent:"Choose the format for your cells, such as percentage, currency, date or time.",AccountingStyle:"Accounting Style",AccountingStyleContent:"Format as dollar accounting number format.",PercentageStyle:"Percent Style",PercentageStyleContent:"Format as a percent.",CommaStyle:"Comma Style",CommaStyleContent:"Format with a thousands separator.",IncreaseDecimal:"Increase Decimal",IncreaseDecimalContent:"Show more decimal places for a more precise value.",DecreaseDecimal:"Decrease Decimal",DecreaseDecimalContent:"Show fewer decimal places.",AutoSum:"AutoSum",AutoSumTitle:"Sum",AutoSumContent:"Automatically add a quick calculation to your worksheet, such as sum or average.",Fill:"Fill",ExportXL:"Excel",ExportCsv:"CSV",SaveXml:"Save XML",BackgroundColor:"Fill Color",BGContent:"Color the background of the cells to make them stand out.",Color:"Font Color",ColorContent:"Change the color of your text.",Border:"Border",BorderContent:"Apply borders to the currently selected cells.",BBottom:"Bottom Border",BTop:"Top Border",BLeft:"Left Border",BRight:"Right Border",Outside:"Outside Borders",NoBorder:"No Border",AllBorder:"All Borders",ThickBox:"Thick Box Border",ThickBottom:"Thick Bottom Border",TopandThickBottom:"Top and Thick Bottom Border",DrawBorderGrid:"Draw Border Grid",DrawBorder:"Draw Border",TopandBottom:"Top and Bottom Border",BorderColor:"Line Color",BorderStyle:"Line Style",Number:"Number is used for general display of numbers.  Currency and Accounting offer specialized formatting for monetary value.",General:"General format cells have no specific number format.",Currency:"Currency formats are used for general monetary values.  Use Accounting formats to align decimal points in a column.",Accounting:"Accounting formats line up the currency symbols and decimal points in a column.",Text:"Text format cells are treated as text even when a number is in the cell.  The cell is displayed exactly as entered.",Percentage:"Percentage formats multiply the cell value by 100 and displays the result with a percent symbol.",CustomMessage:"Type number format code, using one of existing codes as a starting point.",Fraction:"",Scientific:"",Type:"Type:",CustomFormatAlert:"Enter a valid format",Date:"Date formats display date and time serial numbers as date values.",Time:"Time formats display date and time serial numbers as date values.",File:"FILE",New:"New",Open:"Open",SaveAs:"Save As",Print:"Print",PrintContent:"Print the current sheet.",PrintSheet:"Print Sheet",PrintSelected:"Print Selected",PrintSelectedContent:"Select an area on the sheet you would like to print.",HighlightVal:"Format Invalid Data",ClearVal:"Clear Validation",Validation:"Validation",DataValidation:"Data Validation",DVContent:"Pick from a list of rules to limit the type of data that can be entered in a cell.",A4:"A4",A3:"A3",Letter:"Letter",PageSize:"Page Size",PageSizeContent:"Choose a page size for your document.",FormatCells:"FormatCells",ConditionalFormat:"Conditional Formatting",CFContent:"Easily spot trends and patterns in your data using colors to visually highlight important values.",And:"and",With:"with",GTTitle:"Greater Than",GTContent:"Format cells that are GREATER THAN:",LTTitle:"Less Than",LTContent:"Format cells that are LESS THAN:",BWTitle:"Between",BWContent:"Format cells that are BETWEEN:",EQTitle:"Equal To",EQContent:"Format cells that are EQUAL TO:",DateTitle:"A Date Occurring",DateContent:"Format cells that contain a DATE:",ContainsTitle:"Text That Contains",ContainsContent:"Format cells that contain the text:",GreaterThan:"Greater Than",LessThan:"Less Than",Between:"Between",EqualTo:"Equal To",TextthatContains:"Text that Contains",DateOccurring:"A Date Occurring",ClearRules:"Clear Rules",ClearRulesfromSelected:"Clear Rules from Selected Cells",ClearRulesfromEntireSheets:"Clear Rules from Entire Sheet",CellStyles:"Cell Styles",CellStylesContent:"A colorful style is a great way to make important data stand out on the sheet.",CellStyleHeaderText:"Good, Bad and Neutral/Titles and Headings/Themed Cell Styles",Custom:"Type the number format code, using one of the existing codes as starting point.",CellStyleGBN:"Normal/Bad/Good/Neutral",CellStyleTH:"Heading 4/Title",CellsStyleTCS:"20% - Accent1/20% - Accent2/20% - Accent3/20% - Accent4/60% - Accent1/60% - Accent2/60% - Accent3/60% - Accent4/Accent1/Accent2/Accent3/Accent4",Style:"Style",FormatAsTable:"Format As Table",FormatasTable:"Format as Table",FATContent:"Quickly convert a range of cells to a table with its own style.",FATHeaderText:"Light/Medium/Dark",FATNameDlgText:"Table Name :/My table has headers",InvalidReference:"The range you have specified is invalid",ResizeAlert:"The specified range is invalid. The top of the table must remain in the same row, and the resulting table must overlap the original table. Specify a valid range.",RangeNotCreated:"Increasing the row beyond the maximum sheet rowcount is restricted in Format as Table.",ResizeRestrictAlert:"Increase or decrease of column count and decrease of row count is restricted in Format as Table.",FATResizeTableText:"Enter new data range for your table:",FATReizeTableNote:"Note: The headers must remain in the same row and the resulting table range must overlap the original table range.",FormatAsTableAlert:"Cannot create a table with a single row. A table must have at least two rows, one for the table header, and one for data",FormatAsTableTitle:"Light 1/Light 2/Light 3/Light 4/Light 5/Light 6/Light 7/Light 8/Light 9/Light 10/Light 11/Light 12/Medium 1/Medium 2/Medium 3/Medium 4/Medium 5/Medium 6/Medium 7/Medium 8/Dark 1/Dark 2/Dark 3/Dark 4",NewTableStyle:"New Table Style",ResizeTable:"Resize Table",ResizeTableContent:"Resize this table by adding or removing rows and columns.",ConvertToRange:"Convert to Range",ConvertToRangeContent:"Convert this table into a normal range of cells.",ConverToRangeAlert:"Do you want to convert the table to a normal range?",TableID:"Table ID:",Table:"Table",TableContent:"Create a table to organize and analyze related data.",TableStyleOptions:"First Column/Last Column/Total Row/Filter Button",Format:"Format",NameManager:"Name Manager",NameManagerContent:"Create, edit, delete and find all the names used in the workbook.<br /><br />Names can be used in formulas as substitutes for cell references.",DefinedNames:"Defined Names",DefineName:"Define Name",DefineNameContent:"Define and apply names.",UseInFormula:"Use In Formula",UseInFormulaContent:"Choose a name used in this workbook and insert it into the current formula.",Refersto:"Refers to",RefersTo:"Refers To",Name:"Name",Scope:"Scope",NMNameAlert:"The name that you entered is not valid./Reason for this can include:/The name does not begin with a letter or an underscore/The name contains a space or other invalid characters/The name conflicts with a spreadsheet built-in name or the name of another object in the workbook",NMUniqueNameAlert:"The name entered already exists. Enter a unique name.",NMRangeAlert:"Enter a valid range",FORMULAS:"FORMULAS",Value:"Values",DataValue:"Values:",Formula:"Formulas",MissingParenthesisAlert:"Your formula is missing a parenthesis--) or (. Check the formula, and then add the parenthesis in the appropriate place.",UnsupportedFile:"Unsupported File",IncorrectPassword:"Unable to open the file or worksheet with the given password",InvalidUrl:"Please specify proper URL",Up:"Up",Down:"Down",Sheet:"Sheet",Workbook:"Workbook",Rows:"By Rows",Columns:"By Columns",FindReplace:"Find Replace",FindnReplace:"Find and Replace",Find:"Find",Replace:"Replace",FindLabel:"Find what:",ReplaceLabel:"Replace with:",ReplaceAll:"Replace All",Close:"Close",FindNext:"Find Next",FindPrev:"Find Prev",Automatic:"Automatic",Manual:"Manual",Settings:"Settings",MatchCase:"Match case",MatchAll:"Match entire cell contents",Within:"Within:",Search:"Search:",Lookin:"Look in:",shiftright:"Shift cells right",shiftbottom:"Shift cells down",entirerow:"Entire row",entirecolumn:"Entire column",shiftup:"Shift cells up",shiftleft:"Shift cells left",Direction:"Direction:",GoTo:"Go To",GoToName:"Go to:",Reference:"Reference:",Special:"Special",Select:"Select",Comments:"Comments",Formulas:"Formulas",Constants:"Constants",RowDiff:"Row differences",ColDiff:"Column differences",LastCell:"Last cell",CFormat:"Conditional formats",Blanks:"Blanks",GotoError:"Error",GotoLogicals:"Logicals",GotoNumbers:"Numbers",GotoText:"Text",FindSelect:"Find & Select",Comment:"Comment",NewComment:"New",InsertComment:"Insert Comment",EditComment:"Edit",DeleteComment:"Delete Comment",DeleteCommentContent:"Delete the selected comment.",HideComment:"Hide Comment",Next:"Next",NextContent:"Jump to the next comment.",Previous:"Previous",PreviousContent:"Jump to the previous comment.",ShowHide:"Show/Hide Comment",ShowHideContent:"Show or hide the comment on the active cell.",ShowAll:"Show All Comments",ShowAllContent:"Display all comments in the sheet.",UserName:"User Name",Hide:"Hide",Unhide:"Unhide",Add:"Add",DropAlert:"Do you want to replace the existing data?",PutCellColor:"Put Selected Cell Color To The Top",PutFontColor:"Put Selected Font Color To The Top",WebPage:"Web Page",WorkSheet:"Worksheet Reference",SheetReference:"Sheet Reference",InsertHyperLink:"Insert Hyperlink",HyperLink:"Hyperlink",EditLink:"Editlink",OpenLink:"Openlink",HyperlinkText:"Text:",RemoveLink:"Removelink",WebAddress:"Web Address:",CellAddress:"Cell Reference:",SheetIndex:"Select a place in this document",ClearAll:"Clear All",ClearFormats:"Clear Formats",ClearContents:"Clear Contents",ClearComments:"Clear Comments",ClearHyperLinks:"Clear Hyperlinks",SortFilter:"Sort & Filter",SortFilterContent:"Organize your data so it's easier to analyze.",NumberStart:"Minimum:",NumberEnd:"Maximum:",DecimalStart:"Minimum",DecimalEnd:"Maximum:",DateStart:"Start Date:",DateEnd:"End Date:",ListStart:"Source:",FreeText:"Show error alert after invalid data is entered",ListEnd:"Cell Reference:",TimeStart:"Start Time:",TimeEnd:"End Time:",TextLengthStart:"Minimum:",TextLengthEnd:"Maximum:",CommentFindEndAlert:"Spreadsheet reached the end of the workbook. Do you want to continue reviewing from the beginning of the workbook?",InsertSheet:"Insert",DeleteSheet:"Delete",RenameSheet:"Rename",MoveorCopy:"Move or Copy",HideSheet:"Hide",UnhideSheet:"Unhide",SheetRenameAlert:"That name is already taken. Try a different one.",SheetRenameEmptyAlert:"You typed an invalid name for a sheet. Make sure that:<ul><li>The name that you type does not exceed 31 characters.<\/li><li>The name does not contain any of the following characters:  / ? * [ or  ]<\/li><li>You did not leave the name blank.<\/li><\/ul>",SheetDeleteAlert:"You can't undo deleting sheets, and you might be removing some data. If you don't need it, click OK to delete.",SheetDeleteErrorAlert:"A workbook must contain at least one visible worksheet. To hide, delete, or move the selected sheet, you must first insert a new sheet or unhide a sheet that is already hidden.",CtrlKeyErrorAlert:"That command cannot be used on  multiple selections.",MoveToEnd:"Move To End",Beforesheet:"Before sheet:",CreateaCopy:"Create a copy",AutoFillOptions:"Copy Cells/Fill Series/Fill Formatting Only/Fill Without Formatting/Flash Fill",NumberValidationMsg:"Enter only digits",DateValidationMsg:"Enter only date",Required:"Required",TimeValidationMsg:"The time you entered for the Time is invalid.",cellAddrsValidationMsg:"Reference is not valid.",PivotTable:"Pivot Table",PivotTableContent:"Easily arrange and summarize complex data in a PivotTable.",NumberTab:"Number",AlignmentTab:"Alignment",FontTab:"Font",BorderTab:"Border",FillTab:"Fill",textalignment:"Text alignment",horizontal:"Horizontal:",vertical:"Vertical:",indent:"Indent",textcontrol:"Text Control",wraptext:"Wrap text",fontgroup:"Font:",fontstyle:"Font style:",size:"Size:",Size:"Page size",effects:"Effects:",underline:"Underline",strikethrough:"Strikethrough",overline:"Overline",color:"Color:",normalfont:"Normal font",preview:"Preview",previewtext:"AaBbCcYyZz",line:"Line",style:"Style:",presets:"Presets",none:"None",outline:"Outline",border:"Border",allside:"All sides",backgroundcolor:"Background Color:",inscells:"Insert Cells",insrows:"Insert Sheet Rows",inscols:"Insert Sheet Columns",inssheet:"Insert Sheet",delcells:"Delete Cells",delrows:"Delete Sheet Rows",delcols:"Delete Sheet Columns",delsheet:"Delete Sheet",HyperLinkAlert:"The address of this site is not valid.Check the address and try again.",ReplaceData:"All done. We made / replacements.",NotFound:"We couldn't find what you were looking for. Select settings tab for more ways to search",Data:"Data:",Allow:"Allow:",IgnoreBlank:"Ignore blank",NotFind:"Unable to find the match to replace",freezePanes:"Freeze Panes",FreezeRow:"Freeze Top Row",FreezeColumn:"Freeze First Column",unfreezePanes:"Unfreeze Panes",DestroyAlert:"Are you sure you want to destroy the current workbook without saving and create a new workbook?",ImageValAlert:"Upload image files only",Pictures:"Pictures",PicturesTitle:"From File",PicturesContent:"Insert pictures from computer or from other computers that you are connected to.",ImportAlert:"Are you sure you want to destroy the current workbook without saving and open a new workbook?",UnmergeCells:"Unmerge Cells",MergeCells:"Merge Cells",MergeAcross:"Merge Across",MergeAndCenter:"Merge & Center",MergeAndCenterContent:"Combine and center the contents of the selected cells in a new larger cell.",MergeCellsAlert:"Merging Cells keeps only upper left cell value and discards the other values.",MergeInsertAlert:"This operation will causes some merged cells to unmerge. Do you wish to continue ?",Axes:"Axes",PHAxis:"Primary Horizontal",PVAxis:"Primary Vertical",AxisTitle:"Axis Title",CTNone:"None",CTCenter:"Center",CTFar:"Far",CTNear:"Near",DataLabels:"Data Labels",DLNone:"None",DLCenter:"Center",DLIEnd:"Inside End",DLIBase:"Inside Base",DLOEnd:"Outside End",ErrorBar:"Error Bars",Gridline:"Gridlines",PMajorH:"Primary Major Horizontal",PMajorV:"Primary Major Vertical",PMinorH:"Primary Minor Horizontal",PMinorV:"Primary Minor Vertical",Legend:"Legends",LNone:"None",LLeft:"Left",LRight:"Right",LBottom:"Bottom",LTop:"Top",ChartTitleDlgText:"Enter Title",ChartTitle:"Title",InvalidTitle:"You typed an invalid name for the Title.",CorrectFormat:"Select the correct Format File",ResetPicture:"Reset Picture",ResetPictureContent:"Discard all of the formatting changes made to this picture.",PictureBorder:"Picture Border",PictureBorderContent:"Pick the color, width, and line style for the outline of your shape.",ResetSize:"Reset Picture & Size",Height:"Height",Width:"Width",ThemeColor:"Theme Colors",NoOutline:"No Outline",Weight:"Weight",Dashes:"Dashes",ColumnChart:"2-D Column/3-D Column",ColumnChartTitle:"Insert Column Chart",ColumnChartContent:"Use this chart type to visually compare values across a few categories.",BarChart:"2-D Bar/3-D Bar",BarChartTitle:"Insert Bar Chart",BarChartContent:"Use this chart type to visually compare values across a few categories when the chart shows duration or the category text is long.",StockChart:"Radar",StockChartTitle:"Insert Radar Chart",StockChartContent:"Use this chart type to show values relative to a center point.",LineChart:"2-D Line",LineChartTitle:"Insert Line Chart",LineChartContent:"Use this chart type to show trends over time (years, months, and days) or categories.",AreaChart:"2-D Area/3-D Area",AreaChartTitle:"Insert Area Chart",AreaChartContent:"Use this chart type to show trends over time (years, months, and days) or categories. Use it to highlight the magnitude of change over time.",ComboChart:"Combo",PieChart:"Pie",PieChartTitle:"Insert Pie/Doughnut Chart",PieChartContent:"Use this chart type to show proportions of a whole. Use it when the total of your numbers is 100%.",ScatterChart:"Scatter",ScatterChartTitle:"Insert Scatter (X, Y) Chart",ScatterChartContent:"Use this chart type to show the relationship between sets of values.",ClusteredColumn:"Clustered&nbsp;Column",StackedColumn:"Stacked&nbsp;Column",Stacked100Column:"100%&nbsp;Stacked&nbsp;Column",Cluster3DColumn:"3-D&nbsp;Clustered&nbsp;Column",Stacked3DColumn:"3-D&nbsp;Stacked&nbsp;Column",Stacked100Column3D:"3-D&nbsp;100%&nbsp;Stacked&nbsp;Column",ClusteredBar:"Clustered&nbsp;Bar",StackedBar:"Stacked&nbsp;Bar",Stacked100Bar:"100%&nbsp;Stacked&nbsp;Bar",Cluster3DBar:"3-D&nbsp;Clustered&nbsp;Bar",Stacked3DBar:"3-D&nbsp;Stacked&nbsp;Bar",Stacked100Bar3D:"3-D&nbsp;100%&nbsp;Stacked&nbsp;Bar",Radar:"Radar",RadarMarkers:"Radar&nbsp;with&nbsp;Markers",Line:"Line",LineMarkers:"Line&nbsp;with&nbsp;Markers",Area:"Area",StackedArea:"Stacked&nbsp;Area",Stacked100Area:"100%&nbsp;Stacked&nbsp;Area",Pie:"Pie",Pie3D:"3-D&nbsp;Pie",Doughnut:"Doughnut",Scatter:"Scatter",ChartRange:"Chart Range",XAxisRange:"Enter X-axis range:",YAxisRange:"Enter Y-axis range:",LegendRange:"Enter legend range:",YAxisMissing:"Enter Y-axis range to create chart",InvalidYAxis:"Y-axis range must be within the selected range",InvalidXAxis:"X-axis range must be within the selected range",InvalidLegend:"Legend range must be within the selected range",InvalidXAxisColumns:"X-axis range should be within a single column",FreezePanes:"Freeze Panes",FreezePanesContent:"Freeze a portion of the sheet to keep it visible while you scroll through the rest of the sheet.",PasteTitle:"Paste (Ctrl+V)",PasteContent:"Add content on the Clipboard to your document.",PasteSplitContent:"Pick a paste option, such as keeping formatting or pasting only content.",CutTitle:"Cut (Ctrl+X)",CutContent:"Remove the selection and put it on the Clipboard so you can paste it somewhere else.",CopyTitle:"Copy (Ctrl+C)",CopyContent:"Put a copy of the selection on the Clipboard so you can paste it somewhere else.",FPTitle:"Format Painter",FPContent:"Like the look of a particular selection? You can apply that look to other content in the document.",BoldTitle:"Bold (Ctrl+B)",BoldContent:"Make your text bold.",ItalicTitle:"Italic (Ctrl+I)",ItalicContent:"Italicize your text.",ULineTitle:"Underline (Ctrl+U)",ULineContent:"Underline your text.",LineTrTitle:"Strike Through (Ctrl+L)",LineTrContent:"Cross something out by drawing a strike through it.",UndoTitle:"Undo (Ctrl+Z)",UndoContent:"Undo your last action.",RedoTitle:"Redo (Ctrl+Y)",RedoContent:"Redo your last action.",TableTitle:"Table (Ctrl+T)",HyperLinkTitle:"Add a Hyperlink (Ctrl+K)",HyperLinkContent:"Create a link in your document for quick access to webpages and files. <br /><br />Hyperlinks can also take you to places in your document.",NewCommentTitle:"Insert a Comment",NewCommentContent:"Add a note about this part of the document.",AddChartElement:"Add Chart Element",AddChartElementContent:"Add elements to the created chart.",SwitchRowColumn:"Switch Row/ Column",SwitchRowColumnContent:"Swap the data over the axis.",MergeAlert:"We can't do that to a merged cell.",UnhideDlgText:"Unhide Sheet:",ChartThemes:"Chart Themes",ChartThemesContent:"Pick a new theme for your chart.",ChangePicture:"Change Picture",ChangePictureContent:"Change to a different picture, preserving the formatting and size of the current picture.",ChangeChartType:"Change Chart Type",SelectData:"Select Data",SelectDataContent:"Change the data range included in the chart.",Sum:"Sum",Average:"Average",CountNumber:"Count Numbers",Max:"Max",Min:"Min",ChartType:"Change Chart Type",ChartTypeContent:"Change to a different chart type.",AllCharts:"All Charts",defaultfont:"Default",LGeneral:"General",LCurrency:"Currency",LAccounting:"Accounting",LDate:"Date",LTime:"Time",LPercentage:"Percentage",LFraction:"Fraction",LScientific:"Scientific",LText:"Text",LCustom:"Custom",FormatSample:"Sample",Category:"Category:",Top:"Top",Center:"Center",Bottom:"Bottom",Left:"Left (Indent)",Right:"Right",Justify:"Justify",GeneralTxt:"General format cells have no specific number format.",NegativeNumbersTxt:"Negative Numbers",ThousandSeparatorTxt:"Use 1000 Separator",DecimalPlacesTxt:"Decimal Places:",TextTxt:"Text format cells are treated as text even when a number is in the cell. The cell is displayed exactly as entered.",BoldItalic:"Bold Italic",Regular:"Regular",HyperLinkHide:"<<Selection in Document>>",InvalidSheetIndex:"Specify proper SheetIndex",HugeDataAlert:"File too large to open.",ImportExportUrl:"Give import/export URL and try again.",TitleColumnChart:"Clustered Column/Stacked Column/100% Stacked Column/3D Clustered Column/3D Stacked Column/ 3D 100% Stacked Column",TitleBarChart:"Clustered Bar/Stacked Bar/100% Stacked Bar/3D Clustered Bar/3D Stacked Bar/3D 100% Stacked Bar",TitleRadarChart:"Radar/Radar with Markers",TitleLineChart:"Line/Line with Markers",TitleAreaChart:"Area/Stacked Area/100% Stacked Area",TitlePieChart:"Pie/3D Pie/Doughnut",TitleScatterChart:"Scatter",BetweenAlert:"The Maximum must be greater or equal to the Minimum.",BorderStyles:"Solid/Dashed/Dotted",FPaneAlert:"Freeze Pane is not applied for the First Cell",ReplaceNotFound:"Spreadsheet cannot find a match.",BlankWorkbook:"Blank workbook",SaveAsExcel:"Save As Excel",SaveAsCsv:"Save As CSV",PrintSheet:"Print Sheet",PrintSelected:"Print Selected",Design:"DESIGN",NewName:"New Name",FormulaBar:"Formula Bar",NameBox:"Name Box",NumberValMsg:"Decimal values cannot be used for number conditions.",NumberAlertMsg:"Enter only digits.",ListAlert:"Cell range is incorrect, Please enter correct cell range.",ListValAlert:"The list source must be a delimited list, or a reference to single row or column.",ListAlertMsg:"The value you entered is not valid",AutoFillTitle:"AutoFillOptions",NewSheet:"New Sheet",FullSheetCopyPasteAlert:"We can't paste because the Copy area and paste area aren't the same size.",Heading:"Headings",Gridlines:"Gridlines",Firstsheet:"Scroll to the first sheet",Lastsheet:"Scroll to the last sheet",Nextsheet:"Scroll to the next sheet",Prevsheet:"Scroll to the previous sheet",ProtectWorkbook:"Protect Workbook",UnProtectWorkbook:"Unprotect Workbook",ProtectWBContent:"Keep others from making structural changes to your workbook",Password:"Password",ConfirmPassword:"Reenter password to proceed:",PasswordAlert1:"Confirmation password is not identical.",PasswordAlert2:"Please enter a password.",PasswordAlert3:"The password you supplied is not correct. Verify that the CAPS LOCK key is off and be sure to use the correct capitalization.",Protect:"is protected.",Prevsheet:"Scroll to the previous sheet",Lock:"LockCell",Unlock:"UnlockCell",Protectsheet:"Protect Sheet",protectsheettooltip:"Prevent unwanted changes from others by limiting their ability to edit",Unprotect:"Unprotect Sheet",LockAlert:"The cell you are trying to change is on protected sheet. To make changes, click Unprotect Sheet in the Review tab.",InsertDeleteAlert:"This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet."};t.Spreadsheet.scrollMode={Normal:"normal",Infinite:"infinite"};t.Spreadsheet.AutoFillOptions={CopyCells:"copycells",FillSeries:"fillseries",FillFormattingOnly:"fillformattingonly",FillWithoutFormatting:"fillwithoutformatting",FlashFill:"flashfill"};t.Spreadsheet.autoFillDirection={Up:"up",Right:"right",Down:"down",Left:"left"};t.Spreadsheet.pageSize={A4:"A4",A3:"A3",Letter:"Letter"};t.Spreadsheet.Actions={Sorting:"sorting",Selection:"selection",AutoFill:"autofill",CellNavigation:"cellnavigation",Filtering:"filtering"};t.Spreadsheet.exportType={Excel:"Excel",Csv:"Csv"};t.Spreadsheet.CustomCellType={Button:"Button",CheckBox:"CheckBox",DropDownList:"DropDownList",DatePicker:"DatePicker"};t.Spreadsheet.CellType={String:"string",Number:"number",Custom:"custom",Formula:"formula",Time:"time",LongDate:"longdate",ShortDate:"shortdate",Scientific:"scientific",Fraction:"fraction",Text:"text",General:"general",Accounting:"accounting",Currency:"currency",Percentage:"percentage",Date:"date",DateTime:"datetime"};t.Spreadsheet.SupportedStyles={FontFamily:"font-family",FontSize:"font-size",FontStyle:"font-style",FontWeight:"font-weight",TextAlign:"text-align",TextDecoration:"text-decoration",VerticalAlign:"vertical-align"};t.Spreadsheet.Validation={">":"GreaterThan",">=":"GreaterOrEqualTo","<":"LessThan","<=":"LessThanOrEqualTo","==":"EqualTo","!=":"NotEqualTo","!":"Not","=":""};t.Spreadsheet.ValidationText={">":"greater than",">=":"greater than or equal to","<":"less than","<=":"less than or equal to","==":"equal to","!=":"not equal to","!":" not","=":""};t.Spreadsheet.msg=" ";t.Spreadsheet.getMsg=function(){return t.Spreadsheet.msg};t.Spreadsheet.SelectionType={Row:"row",Column:"column",Default:"default"};t.Spreadsheet.SelectionUnit={Single:"single",Range:"range",MultiRange:"multirange"};t.Spreadsheet.Align={left:"left",right:"right",center:"center"}})(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.selection=function(n){this.XLObj=n;this._isRightClick=!1;this._colhdrClick=!1;this._rowhdrClick=!1;this._aFillDownHandler=!1;this._isOutsideBordering=!1;this._isGridBordering=!1;this._isRowSelected=!1;this._isColSelected=!1;this._isEndReached=!0};t.spreadsheetFeatures.selection.prototype={_selectionMouseDownHandler:function(i){i.preventDefault();var r=this.XLObj,f=r.getSheet(r.getActiveSheetIndex()),u=i.target;r._on(n(document),"mouseup",this._mouseUpHandler);i.which===3||i.button===2||r.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.Single?this._isRightClick=!0:r._on(r.element,"mousemove",this._mouseMoveHandler);u.tagName=="TD"?(r.XLEdit._isFormulaEdit?(i.ctrlKey&&(this._clearBorder(r._arrayAsString(r._ctrlFormulaBorder)),r._ctrlKeyCount=r._formulaRange.length),r._dStartCell=r._getCellIdx(u)):i.shiftKey&&f._startCell.rowIndex!=-1?f._endCell=r._getCellIdx(u):(f._startCell=r._getCellIdx(u),f._activeCell=r._getCellIdx(u)),u.className.indexOf("e-rowheader")>-1&&(this._rowhdrClick=!0)):u.parentNode.tagName=="TH"?(i.shiftKey&&f._startCell.rowIndex!=-1?f._endCell={rowIndex:0,colIndex:u.parentNode.cellIndex}:(f._startCell={rowIndex:0,colIndex:u.parentNode.cellIndex},f._activeCell={rowIndex:0,colIndex:u.parentNode.cellIndex}),u.className.indexOf("e-headercelldiv")>-1&&(this._colhdrClick=!0)):u.className=="e-autofill"&&(this._aFillDownHandler=!0)},_mouseMoveHandler:function(i){var o,r=this,e=r.XLSelection,s=r.getActiveSheetIndex(),u=r.getSheet(s),f=i.target,l,h=r.model.selectionSettings.selectionType,c=t.Spreadsheet.SelectionType;if(f.tagName=="TD"){if(this.XLSelection._isEndReached=!1,r._getContent(s).find("td").removeClass(r._ctrlFormulaBorder[r._ctrlKeyCount%6].join(" ")),r.XLEdit._isFormulaEdit){i.ctrlKey?(r._dEndCell=r._getCellIdx(f),e._processFormulaRange(r._ctrlFormulaBorder,!0)):(r._dEndCell=r._getCellIdx(f),e._processFormulaRange(r._ctrlFormulaBorder,!0));return}if(e._aFillDownHandler&&n(f).parents(".e-rowheadercontent").length===0){r.model.allowAutoFill&&r.XLDragFill._selectAutoFillRange(f);return}if(u._startCell=u._activeCell,u._endCell=r._getCellIdx(f),e._processBoundary(),n(f).parents(".e-spreadsheetcontentcontainer").length>0){if(i.ctrlKey&&r.model.selectionSettings.selectionType===t.Spreadsheet.SelectionType.Default&&r.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.MultiRange){r._getContent(r.getActiveSheetIndex()).find("td").removeClass("e-activecell e-focusright e-focusbottom");l=r.swapRange([u._startCell.rowIndex,u._startCell.colIndex,u._endCell.rowIndex,u._endCell.colIndex]);r.getRange(l).addClass("e-ctrlselected");e._focusRange(u._startCell,u._endCell,r._selectionBorder);r.model.allowAutoFill&&r.XLDragFill.hideAutoFillElement();return}h===c.Row||e._rowhdrClick?e.selectRows(u._startCell.rowIndex,u._endCell.rowIndex):h===c.Column||e._colhdrClick?e.selectColumns(u._startCell.colIndex,u._endCell.colIndex):e.selectRange(u._startCell,u._endCell,f)}else if(n(f).parents(".e-rowheadercontent").length>0)e._colhdrClick||e._rowhdrClick?h===c.Column?e.selectColumns(0,u.colCount-1):e.selectRows(u._startCell.rowIndex,u._endCell.rowIndex):(o={position:"horizontal",action:"Decrement"},e._scrollCalculation(s,f,o));else return}else if(t.isNullOrUndefined(f.parentNode)||f.parentNode.tagName!="TH")if(f.className.indexOf("e-hhandlespace")>-1||f.className.indexOf("e-hhandle")>-1||f.className.indexOf("e-hup")>-1||f.className.indexOf("e-hdown")>-1)o={position:"vertical",action:"Increment"},e._scrollCalculation(s,f,o);else if(f.className.indexOf("e-vhandlespace")>-1||f.className.indexOf("e-vhandle")>-1||f.className.indexOf("e-vup")>-1||f.className.indexOf("e-vdown")>-1)o={position:"horizontal",action:"Increment"},e._scrollCalculation(s,f,o);else return;else u._endCell={rowIndex:0,colIndex:f.parentNode.cellIndex},u._startCell=u._activeCell,e._processBoundary(),e._colhdrClick||e._rowhdrClick?h===c.Row?e.selectRows(0,u.rowCount-1):e.selectColumns(u._startCell.colIndex,u._endCell.colIndex):(o={position:"vertical",action:"Decrement"},e._scrollCalculation(s,f,o))},_mouseUpHandler:function(i){var v,c,l,d,w,a,o,b,k,r=this,u=r.XLSelection,s=r.getActiveSheetIndex(),f=r.getSheet(s),g=f.selectedRange,e=i.target,h=n(e),nt=r.getSheetElement(s),y=r.model.selectionSettings.selectionType,tt=f._startCell,it=f._endCell,p=t.Spreadsheet.SelectionType;if(r._off(n(document),"mouseup",u._mouseUpHandler)._off(r.element,"mousemove",u._mouseMoveHandler),i.target=r._changeTargetWithOffset(i),e=i.target,e.tagName=="TD"||e.tagName=="INPUT"||e.tagName=="DIV"&&u._aFillDownHandler){if(h.parents(".e-rowheadercontent").length&&(u._isOutsideBordering=u._isGridBordering=!1),r._preventctrlkey=i.ctrlKey,r.XLEdit._isFormulaEdit){r._getContent(s).find("td").removeClass(r._ctrlFormulaBorder.join(" ").replace(/,/g," "));i.ctrlKey?(r._dEndCell=r._getCellIdx(e),u._processFormulaRange(r._formulaBorder)):(u._clearBorder(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")),r._ctrlKeyCount=0,r._dEndCell=r._getCellIdx(e),u._processFormulaRange(r._formulaBorder),r._formulaRange=[]);r._formulaRange.push(r._getProperAlphaRange(s,r._dStartCell.rowIndex,r._dStartCell.colIndex,r._dEndCell.rowIndex,r._dEndCell.colIndex));return}if(u._aFillDownHandler){if(a=e.tagName=="DIV"?r.XLShape._getCellIndexFromOffset(e.offsetTop,e.offsetLeft):r._getCellIdx(e),o=r.model.allowAutoFill&&r.XLDragFill._getAutoFillRange(a),r.model.allowLockCell&&r.getSheet(s)._isSheetProtected&&(l=r.swapRange(o.fillRange),d=r.XLSelection._getSelectedRange({rowIndex:l[0],colIndex:l[1]},{rowIndex:l[2],colIndex:l[3]}),r._israngeProtected(d))){u._aFillDownHandler=!1;r.XLSelection.selectRange(tt,it);r.XLDragFill.positionAutoFillElement();r._popUplockCellAlert();return}if(o)"direction"in o?(r._pStartCell=f._startCell,r._pEndCell=f._endCell,r._pFillCell=a,r.inRange(f.selectedRange,a.rowIndex,a.colIndex)?r.clearRangeData(null,null,n(u.getSelectedCells()).not(".e-autofillcell")):r.model.allowAutoFill&&r.XLDragFill.autoFill({dataRange:f.selectedRange,fillRange:o.fillRange,direction:o.direction}),f._startCell=o.startCell,f._endCell=o.endCell):u._aFillDownHandler=!1;else return;u.refreshSelection(r.swapRange([o.startCell.rowIndex,o.startCell.colIndex,o.endCell.rowIndex,o.endCell.colIndex]))}else if(u._isOutsideBordering||u._isGridBordering)if(c="1px "+r._borderStyle+" "+r._borderColor,u._isRightClick?f._endCell=f._startCell:(f._startCell=f._activeCell,f._endCell=r._getCellIdx(e),u._processBoundary()),h.parents(".e-spreadsheetcontentcontainer").length)b={top:c,right:c,bottom:c,left:c},u._isGridBordering&&(b.isGridBorder=!0),r.XLFormat.applyBorder(b,r.swapRange([f._startCell.rowIndex,f._startCell.colIndex,f._endCell.rowIndex,f._endCell.colIndex])),u._cleanUp(!0);else return;else if(e.tagName=="INPUT"&&h.parents("tr").length?f._endCell=u._isRightClick?f._startCell:r._getCellIdx(h.parents("td")[0]):u._isRightClick?f._endCell=f._startCell:(f._startCell=f._activeCell,f._endCell=r._getCellIdx(e),u._processBoundary()),h.parents(".e-spreadsheetcontentcontainer").length){if(i.ctrlKey&&r.model.selectionSettings.selectionType===t.Spreadsheet.SelectionType.Default&&r.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.MultiRange){r._getContent(s).find("td").removeClass("e-activecell e-focustop e-focusleft e-ctrlselected");g=r.swapRange([f._startCell.rowIndex,f._startCell.colIndex,f._endCell.rowIndex,f._endCell.colIndex]);r.getRange(g).addClass("e-selected");r.getCell(f._activeCell.rowIndex,f._activeCell.colIndex).addClass("e-activecell");u._focusRange(f._startCell,f._endCell,r._selectionBorder);r.model.allowAutoFill&&r.XLDragFill.hideAutoFillElement();r.getSheet(s)._selectedCells.push(u._getSelectedRange(r.getSheet(s)._startCell,r.getSheet(s)._endCell));r.model.showRibbon&&r.model.allowComments&&nt.find(".e-selected.e-commentcell").length&&r.XLRibbon._enableButtons(["deleteComment"],"ejButton");return}y===p.Row||u._rowhdrClick?u.selectRows(f._startCell.rowIndex,f._endCell.rowIndex):y===p.Column||u._colhdrClick?u.selectColumns(f._startCell.colIndex,f._endCell.colIndex):u.selectRange(f._startCell,f._endCell,e)}else if(h.parents(".e-rowheadercontent").length)(u._colhdrClick||u._rowhdrClick)&&(y===p.Column?u.selectColumns(0,f.colCount-1):u.selectRows(f._startCell.rowIndex,f._endCell.rowIndex),u._hdrClick=!1),u._isOutsideBordering=u._isGridBordering=!1;else return;e.tagName==="TD"&&r.model.showRibbon&&(k=n("#"+r._id+"_Ribbon_clearfilter").data("ejButton"),k&&r.XLRibbon._changeClrFltrStatus(k,"button",r._getCellIdx(e)))}else if(u._aFillDownHandler||t.isNullOrUndefined(e.parentNode)||e.parentNode.tagName!="TH")if(typeof e.className!="object"&&e.className&&e.className.indexOf("e-spreadsheetcolumnheader")>-1)u.selectSheet(!0),u._isOutsideBordering=u._isGridBordering=!1;else{r.model.showRibbon&&r.XLRibbon._updateRibbonIcons();return}else f._startCell=f._activeCell,f._endCell=u._isRightClick?f._startCell:{rowIndex:0,colIndex:e.parentNode.cellIndex},u._processBoundary(),(u._colhdrClick||u._rowhdrClick)&&(y===p.Row?u.selectRows(0,f.rowCount-1):u.selectColumns(f._startCell.colIndex,f._endCell.colIndex)),u._isOutsideBordering=u._isGridBordering=!1;r.model.allowCellFormatting&&r.XLFormat._formatEnable&&r.XLFormat._fPMouseUp(i);r.model.showRibbon&&(r.XLEdit._isEdit?r.XLRibbon._disableRibbonIcons():r.XLRibbon._updateRibbonIcons());!r.model.allowAutoFill||u._isOutsideBordering||u._isGridBordering||r.XLDragFill.positionAutoFillElement(u._aFillDownHandler);u._isRightClick=u._aFillDownHandler=!1;u._colhdrClick=u._rowhdrClick=!1;r.setSheetFocus();r.model.showRibbon&&(v=n("#"+r._id+"_Ribbon_merge").data("ejSplitButton"),t.isNullOrUndefined(v)||!r.model.allowLockCell||f._isSheetProtected||(r.XLRibbon._isDirtySelect?v.option("enabled",!1):v.option("enabled",!0)));r.model.allowEditing&&this.XLEdit._isEdit&&(w=r.getSheet(s)._startCell,r.getCell(w.rowIndex,w.colIndex).find(".e-ss-input").focus())},_processBoundary:function(){var r,o,u,t,f,i,s=[],e=this.XLObj,c=e.getActiveSheetIndex(),h=e.getSheet(c),l=h._startCell,a=h._endCell,n=e.swapRange([l.rowIndex,l.colIndex,a.rowIndex,a.colIndex]);for(h._startCell={rowIndex:n[0],colIndex:n[1]},h._endCell={rowIndex:n[2],colIndex:n[3]},t=this._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[0],colIndex:n[3]}),t=t.concat(this._getSelectedRange({rowIndex:n[0],colIndex:n[3]},{rowIndex:n[2],colIndex:n[3]})),t=t.concat(this._getSelectedRange({rowIndex:n[2],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]})),t=t.concat(this._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[1]})),r=t.length;r--;)if(u=t[r],f=e.XLEdit.getPropertyValue(t[r].rowIndex,t[r].colIndex,"mergeIdx",c),i=(u.rowIndex+":"+u.colIndex).toString(),o=e.hasSpan(u)&&s.indexOf(i)===-1&&(s.push(i),this._updateRange(u,n)),f&&(i=(f.rowIndex+":"+f.colIndex).toString(),s.indexOf(i)===-1&&(s.push(i),o=this._updateRange(f,n))),o)break;o&&this._processBoundary()},_updateRange:function(n,t){var r=this.XLObj,c=r.getActiveSheetIndex(),u=r.getSheet(c),i=t.slice(0),f=r._getMergedIdx(n.rowIndex,n.colIndex),e=n.rowIndex,o=n.colIndex,s=f.rowIndex,h=f.colIndex;return e<t[0]&&(t[0]=e),o<t[1]&&(t[1]=o),s>t[2]&&(t[2]=s),h>t[3]&&(t[3]=h),t[0]!=i[0]||t[1]!=i[1]||t[2]!=i[2]||t[3]!=i[3]?(u._startCell={rowIndex:t[0],colIndex:t[1]},u._endCell={rowIndex:t[2],colIndex:t[3]},!0):void 0},selectRange:function(n,t,i){var h,o,r,s,c,f,e,u=this.XLObj;u.model.allowSelection&&(u._isObject(n)?e=n:(n=u._toIntrnlRange(n),e={rowIndex:n[0],colIndex:n[1]},t={rowIndex:n[2],colIndex:n[3]}),o=u.getActiveSheetIndex(),r=u.getSheet(o),u.model.scrollSettings.allowVirtualScrolling&&(r._goToCollection={multiple:!1,selected:[]}),c=r.selectedRange,f=u.swapRange([e.rowIndex,e.colIndex,t.rowIndex,t.colIndex]),u.isImport||r._isImported&&!r._isLoaded||(s={prevRange:c,currRange:f,sheetIdx:o},i&&(s.target=i),!u._trigger("beforeCellSelect",s)))&&(u._dStartCell=e,u._dEndCell=t,r.selectedRange=f,this._cleanUp(!1),h=u.getRange(f),h.addClass("e-selected"),u.inRange(f,r._activeCell.rowIndex,r._activeCell.colIndex)||(r._activeCell={rowIndex:f[0],colIndex:f[1]}),r._activeCell=u._getMergeParent(r._activeCell.rowIndex,r._activeCell.colIndex),u._isRowViewable(o,r._activeCell.rowIndex)&&u.getCell(r._activeCell.rowIndex,r._activeCell.colIndex).addClass("e-activecell"),this._focusRange(e,t,u._selectionBorder),this._highlightHeader(f),r._selectedCells=this._getSelectedRange(e,t),u.model.allowFormulaBar&&u.updateFormulaBar(),u.model.enableContextMenu&&u.model.showRibbon&&u.XLRibbon._dirtySelect(h),u._isMultiSelect=!0,r._isEmptyActiveCell=r._isRangeSelected=r._isRowSelected=r._isColSelected=r._isSheetSelected=!1,r._isRowSelected=r._isColSelected=r._isSheetSelected=!1,u.isImport||r._isImported&&!r._isLoaded||(s={selectedRange:f,target:i,sheetIdx:o},u._trigger("cellSelected",s)))},selectRow:function(n){var i=this.XLObj,t=i.getSheet(i.getActiveSheetIndex());i.model.allowSelection&&(t._startCell={rowIndex:n,colIndex:0},t._endCell={rowIndex:n,colIndex:t.colCount-1},this.selectRange(t._startCell,t._endCell),this._selectRow(n,"e-rowselected"),t._isRowSelected=!0)},selectRows:function(n,t){var i,r=this.XLObj;r.model.allowSelection&&(i=r.getSheet(r.getActiveSheetIndex()),i._startCell={rowIndex:n,colIndex:0},i._endCell={rowIndex:t,colIndex:i.colCount-1},this.selectRange(i._startCell,i._endCell),this._markHeaderSelection([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],"row"),i._isRowSelected=!0)},selectColumn:function(n){var t,i=this.XLObj;i.model.allowSelection&&(t=i.getSheet(i.getActiveSheetIndex()),t._startCell={rowIndex:0,colIndex:n},t._endCell={rowIndex:t.rowCount-1,colIndex:n},this.selectRange(t._startCell,t._endCell),this._selectColumn(n,"e-colselected"),t._isColSelected=!0)},selectColumns:function(n,t){var i,r=this.XLObj;r.model.allowSelection&&(i=r.getSheet(r.getActiveSheetIndex()),i._startCell={rowIndex:0,colIndex:n},i._endCell={rowIndex:i.rowCount-1,colIndex:t},this.selectRange(i._startCell,i._endCell),this._markHeaderSelection([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],"column"),i._isColSelected=!0)},selectSheet:function(n){var i=this.XLObj,t=i.getSheet(i.getActiveSheetIndex());i.model.allowSelection&&(n&&(t._activeCell={rowIndex:t._topRow.idx,colIndex:0}),t._startCell={rowIndex:0,colIndex:0},t._endCell={rowIndex:t.rowCount-1,colIndex:t.colCount-1},this.selectRange(t._startCell,t._endCell),i.element.find(".e-spreadsheetcolumnheader").addClass("e-sheetselected"),t._isSheetSelected=!0)},refreshSelection:function(n){var i=this.XLObj,t=i.getSheet(i.getActiveSheetIndex()),n=n?n:t.selectedRange,r=n[0],u=n[1],f=n[2],e=n[3];t._isRowSelected?this.selectRows(r,f):t._isColSelected?this.selectColumns(u,e):t._isSheetSelected?this.selectSheet():this.selectRange({rowIndex:r,colIndex:u},{rowIndex:f,colIndex:e})},getSelectedCells:function(n){return this.XLObj._getContent(this.XLObj._getSheetIndex(n))[0].querySelectorAll("td.e-selected")},_select:function(n,t){var i=this.XLObj.getCell(n.rowIndex,n.colIndex);i&&i.addClass(t)},_selectRow:function(n,t){var i=this.XLObj._getJSSheetRowHeaderContent(this.XLObj.getActiveSheetIndex()).find("td:eq("+n+")");i&&i.addClass(t)},_selectRows:function(n,t,i){var u,r,e=this.XLObj,o=e.getActiveSheetIndex(),f=e._getJSSheetRowHeaderContent(o).find("td");u=e._getRowIdx(n);r=e._getRowIdx(t);u===-1&&(u=n);r===-1&&(r=t);f=u!==r?f.slice(u,r+1):f.eq(r);f&&f.addClass(i)},_selectColumn:function(n,t){var i=this.XLObj._getJSSheetHeader(this.XLObj.getActiveSheetIndex()).find("th:eq("+n+")");i&&i.addClass(t)},_selectColumns:function(n,t,i){var r=this.XLObj._getJSSheetHeader(this.XLObj.getActiveSheetIndex()).find("th");r=t!==n?r.slice(n,t+1):r.eq(t);r&&r.addClass(i)},_focusBorder:function(n,t,i){var r=this.XLObj,e=r.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]),u=e[0],f=e[1],o=e[2],s=e[3];u&&r.getRange([u-1,f,u-1,s]).addClass(i[1]);r.getRange([u,s,o,s]).addClass(i[0]);r.getRange([o,f,o,s]).addClass(i[1]);f&&r.getRange([u,f-1,o,f-1]).addClass(i[0])},_focusRange:function(n,t,i){var r=this.XLObj;r.getFocusTopElem().removeClass().addClass("e-focustop "+i[0]);r.getFocusRightElem().removeClass().addClass("e-focusright "+i[1]);r.getFocusBottomElem().removeClass().addClass("e-focusbottom "+i[2]);r.getFocusLeftElem().removeClass().addClass("e-focusleft "+i[3]);this._refreshBorder(r.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]))},_refreshBorder:function(n){n=n?n:this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).selectedRange;var u,f,i="e-hide",r=this.XLObj,s=n[0],h=n[1],t=this._focusInfo(n),e=r.getFocusTopElem().removeClass(i),c=r.getFocusRightElem().removeClass(i),l=r.getFocusBottomElem().removeClass(i),o=r.getFocusLeftElem().removeClass(i),a=t.topLeft.top,v=t.topLeft.left,y=t.topRight.left+t.topRight.width-t.topLeft.left,p=t.topRight.top,w=t.topRight.left+t.topRight.width,b=t.bottomRight.top+t.bottomRight.height-t.topRight.top,k=t.bottomLeft.top+t.bottomLeft.height,d=t.topLeft.left,g=t.bottomRight.left+t.bottomRight.width-t.bottomLeft.left,nt=t.topLeft.top,tt=t.topLeft.left,it=t.bottomLeft.top+t.bottomLeft.height-t.topLeft.top;r.model.selectionSettings.enableAnimation?(u=r.model.selectionSettings.animationType,f=r.model.selectionSettings.animationTime,s?e.animate({top:a.toString(),left:v.toString(),width:y.toString()},f,u):e.addClass(i),c.animate({top:p.toString(),left:w.toString(),height:b.toString()},f,u),l.animate({top:k.toString(),left:d.toString(),width:g.toString()},f,u),h?o.removeClass(i).animate({top:nt.toString(),left:tt.toString(),height:it.toString()},f,u):o.addClass(i)):(s?e.css({top:a,left:v,width:y}):e.addClass(i),c.css({top:p,left:w,height:b}),l.css({top:k,left:d,width:g}),h?o.css({top:nt,left:tt,height:it}):o.addClass(i))},_focusInfo:function(n){var i={},u=n[0],f=n[1],e=n[2],r=n[3],t=this.XLObj;return i.topLeft=t._getCellInfo({rowIndex:u,colIndex:f}),i.topRight=t._getCellInfo(f===r?{rowIndex:u,colIndex:r}:t._getMergedIdx(u,r)),i.bottomLeft=t._getCellInfo({rowIndex:e,colIndex:f}),i.bottomRight=t._getCellInfo(t._getMergedIdx(e,r)),i},_highlightHeader:function(n){this._selectRows(n[0],n[2],"e-rowhighlight");this._selectColumns(n[1],n[3],"e-colhighlight")},_markHeaderSelection:function(n,t){var i,r,u=this.XLObj;if(n=u.swapRange(n),i=n[0],t==="row")for(r=n[2];i<=r;)this._selectRow(i,"e-rowselected"),i++;else for(i=n[1],r=n[3];i<=r;)this._selectColumn(i,"e-colselected"),i++},_getSelectedRange:function(n,t){for(var r,e,o=[],s=this.XLObj,u=s.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]),i=u[0],f=u[2];i<=f;){for(r=u[1],e=u[3];r<=e;)o.push({rowIndex:i,colIndex:r}),r++;i++}return o},_processFormulaRange:function(n){var u,t=this.XLObj,f=t.getActiveSheetIndex(),i=t._dStartCell,r=t._dEndCell,e=t._getContent(f).find(".e-editedcell");this._focusBorder(i,r,n[t._ctrlKeyCount%6]);t.model.allowAutoFill&&(u=t._getAlphaRange(f,i.rowIndex,i.colIndex,r.rowIndex,r.colIndex),t.XLDragFill.hideAutoFillElement(),t.XLEdit._updateFormulaCellRange(u));t.XLEdit._isCellEdit?t.XLEdit._focusElements(e):t._getInputBox().focus()},_scrollCalculation:function(n,t,i){var s,h,f,e,r=this.XLObj,u,o;r.model.scrollSettings.allowVirtualScrolling||(u=r.getSheet(r.getActiveSheetIndex()),r.XLSelection._isEndReached=!0,s=setInterval(function(){if(f=r.XLScroll._hScroller(n),e=r.XLScroll._vScroller(n),!r.XLSelection._isEndReached){clearInterval(s);return}if(i.position==="horizontal")i.action=="Increment"?(h=Math.ceil(parseFloat(f.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(f.element.find(".e-hhandle").width()))>=f.element.find(".e-hhandlespace").width()-1,h?r.XLScroll._scrollX(n):f.scroll(f.value()+r.model.columnWidth,!0),r.XLShape._shapeROStart||r.XLShape._shapeRSStart||(u._endCell.colIndex=u.colCount-1)):(o=f.value()-r.model.columnWidth,o<0&&(o=0),f.value()>=0&&f.scroll(o,!0),r.XLSelection._aFillDownHandler&&(u._endCell.colIndex=u._leftCol.idx));else if(i.position==="vertical")if(i.action=="Increment")h=Math.ceil(parseFloat(e.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(e.element.find(".e-vhandle").height()))>=e.element.find(".e-vhandlespace").height()-1,h?r.XLScroll._scrollY(n):e.scroll(e.value()+r.model.rowHeight,!0),r.XLShape._shapeROStart||r.XLShape._shapeRSStart||(u._endCell.rowIndex=u.rowCount-1);else if(o=e.value()-r.model.rowHeight,o<0&&(o=0),e.value()>0&&e.scroll(o,!0),!r.XLShape._shapeROStart&&!r.XLShape._shapeRSStart){if(u._topRow.idx<1)return;u._startCell=u._activeCell;u._endCell.rowIndex=u._topRow.idx-1;u._endCell.colIndex=t.parentNode.cellIndex}r.XLShape._shapeROStart||r.XLShape._shapeRSStart||(r.XLSelection._aFillDownHandler?r.XLDragFill._selectAutoFillRange(null,u._endCell):r.XLSelection.selectRange(u._startCell,u._endCell),r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement(r.XLSelection._aFillDownHandler))},200),t.addEventListener("mouseup",function(){clearInterval(s)}),document.addEventListener("mouseup",function(){clearInterval(s)}))},_cleanUp:function(n){var r,u,i="e-hide",t=this.XLObj,f=t.getActiveSheetIndex(),e=t.getSheet(f);for(t.model.allowAutoFill&&t.XLDragFill._autoFillCleanUp(),u=t.getSheetElement(f)[0].querySelectorAll(".e-selected,.e-rowselected,.e-colselected,.e-rowhighlight,.e-colhighlight,.e-sheetselected,.e-activecell"),r=u.length;r--;)t._removeClass(u[r],"e-activecell|e-selected|e-rowhighlight|e-colhighlight|e-rowselected|e-colselected|e-sheetselected");n&&(t.addClass(t.getFocusTopElem()[0],i),t.addClass(t.getFocusRightElem()[0],i),t.addClass(t.getFocusBottomElem()[0],i),t.addClass(t.getFocusLeftElem()[0],i));e._selectedCells=[]},_clearBorder:function(n){var t=this.XLObj;t._getContent(t.getActiveSheetIndex()).find("td").removeClass(n)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.filter=function(n){this.XLObj=n;this._isSearchEdit=!1;this._isDecimal=!1;this._isFilter=!1};t.spreadsheetFeatures.filter.prototype={_renderExcelFilter:function(){var n=this.XLObj,i={instance:n,showSortOptions:!0,maxFilterLimit:n.model.sheets[n.getActiveSheetIndex()].filterSettings.maxFilterChoices,filterHandler:t.proxy(this._filterHandler,this),cancelHandler:t.proxy(this._cancelHandler,this),customFilterHandler:t.proxy(this._customFilterHandler,this)};n._excelFilter=new t.excelFilter(i)},_customFilterHandler:function(){var t=this.XLObj;this._isDecimal&&(n("#"+t._id+"number_CustomValue1").ejNumericTextbox("option",{decimalPlaces:2}),n("#"+t._id+"number_CustomValue2").ejNumericTextbox("option",{decimalPlaces:2}))},_renderFilterDialogs:function(){var n=this.XLObj;n._excelFilter.renderDialog("string");n._excelFilter.renderDialog("number");n._excelFilter.renderDialog("date");n.element.find(".e-excelfilter.e-dlgcontainer").hide()},_createSelection:function(n,i,r,u,f){for(var h=this.XLObj,l=h.getSheet(n)._usedRange.rowIndex,c=r,s=0,o=h._dataContainer.sheets[n],e=r;e<=l;e++)if(e in o){if((!(s in o[e])||s in o[e]&&t.isNullOrUndefined(o[e][s].isHide))&&t.isNullOrUndefined(h.XLEdit.getPropertyValue(e,u,"value2",n))&&e>=r)return e<=i&&(e=e+(i-e)),{endRowIndex:e,filteredIndex:f};(!(s in o[e])||s in o[e]&&t.isNullOrUndefined(o[e][s].isHide))&&!t.isNullOrUndefined(h.XLEdit.getPropertyValue(e,u,"value2",n))?(c=e+1,f.push(e)):c=c}return{endRowIndex:c,filteredIndex:f}},_getSelectedRangeData:function(n,i,r){var e=this.XLObj,o=0,l=e.getActiveSheetIndex(),h=e.getSheet(l),p=[],v,u,s,c,w=[],y,b,k=[],a=e._dataContainer,f=a.sheets[l];for(r===-1&&(h.filterSettings.range=e._generateHeaderText(l,n.colIndex+1)+n.rowIndex+":"+e._generateHeaderText(l,i.colIndex+1)+(i.rowIndex+1)),h._multipleFiltering&&(i.colIndex=h._multifilterIdx[h._multifilterIdx.length-1]),u=n.rowIndex;u<=i.rowIndex;u++){for(temp={},s=n.colIndex;s<=i.colIndex;s++)v=e._generateHeaderText(l,s+1),u in f&&(!(o in f[u])||o in f[u]&&t.isNullOrUndefined(f[u][o].isRHide)&&t.isNullOrUndefined(f[u][o].isFHide))&&(!(o in f[u])||o in f[u]&&(t.isNullOrUndefined(f[u][o].isFilterHide)||!t.isNullOrUndefined(f[u][o].isFilterHide)&&f[u][o].filterID===r))&&(temp.idx=u,u in f&&s in f[u]?(c=f[u][s],y=e.XLEdit.getPropertyValue(u,s,"formats"),t.isNullOrUndefined(y)||(b={id:s,background:y["background-color"],foreground:y.color},w.push(b)),temp[v]=t.isNullOrUndefined(a.sharedData[c.value])?"":e._isDateTime(a.sharedData[c.value])||e.isFormula(a.sharedData[c.value])?c.value2:a.sharedData[c.value]):temp[v]=""),!(u in f)&&u<i.rowIndex&&(temp.idx=u,temp[v]="");e.getObjectLength(temp)>0&&(k.push(temp),p.push(u))}h._selectedCellColors=w;h._selectedRange={startRow:n.rowIndex,endRow:i.rowIndex,dataSourceIndexes:p};h.filterSettings.filteredRange=k},_getColumnType:function(t,i,r,u){for(var o="string",f,e=i;e<r;e++)if(f=this.XLObj.XLEdit.getPropertyValue(e,u,"value",t),n.isNumeric(f))this._isDecimal||(this._isDecimal=f%1!=0),o="number";else return"string";return o},_getColumnByField:function(n,t){for(var u=this.XLObj,r=u.getSheet(n),i=0;i<r.columns.length;i++)if(r.columns[i].field===t)break;return i===r.columns.length?null:r.columns[i]},_checkEmptyText:function(n){for(var r=this.XLObj,u=r.model.sheets[n]._selectedCells,i=0,f=u.length;i<f;i++)if(!t.isNullOrUndefined(r.XLEdit.getPropertyValue(u[i].rowIndex,u[i].colIndex,"value",n)))return!0;return r._showAlertDlg("Alert","Alert",null,440),!1},_getFilterIcon:function(){var n=t.buildTag("span .e-icon","",{});return n.addClass("e-spanfilter e-filterspan e-ssfilter"),n},filterByActiveCell:function(){var n=this.XLObj,i=n.getActiveSheetIndex(),r;if(n.model.allowFiltering){var t=n.model.sheets[i]._activeCell,u=n.getCell(t.rowIndex,t.colIndex),f=n.model.sheets[i]._selectedCells;this._checkEmptyText(i)&&(u.find("span").is(".e-ssfiltered, .e-ssfilter, .e-ssfilter-asc, .e-ssfiltered-asc, .e-ssfilter-dsc, .e-ssfiltered-dsc")?n._showAlertDlg("Alert","HeaderAlert","",440):(r=n.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"value",i),r=n._isDateTime(r)?n.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"value2",i):r,this._filterActiveCell(i,t,f,r)))}},_filterActiveCell:function(n,t,i,r){var u=this.XLObj,f=u.getSheet(n);f._activeCell=t;f._selectedCells=i;this._filterByValue(n,null,f.columns[t.colIndex].field,"or","equal",r);u.model.allowComments&&u.XLComment._updateCmntArrowPos()},_filterByValue:function(i,r,u,f,e,o){var h=this.XLObj,w,a,v,k,tt,it,d,g=-1,rt,y,c,p,ut=h.XLEdit.getColumnIndexByField(u),l=h.getSheet(i),b,nt,s;if(t.isNullOrUndefined(r)?w=l._selectedCells:(a=h.getRangeIndices(r),w=h.XLSelection._getSelectedRange({rowIndex:a[0],colIndex:a[1]},{rowIndex:a[2],colIndex:a[3]})),v=w[0],!t.isNullOrUndefined(r)&&(y=h.XLEdit.getPropertyValue(v.rowIndex,v.colIndex,"value2",i),t.isNullOrUndefined(y)||y!==o))for(s=a[0];s<a[2];s++)if(y=h.XLEdit.getPropertyValue(s,ut,"value2",i),!t.isNullOrUndefined(y)&&y===o){v={rowIndex:s,colIndex:ut};break}for(p={currentFilteringColumn:u,action:"filter",predicated:f,requestType:"filterbycell",reqType:"filter",filteredValue:o,selCells:n.extend(!0,[],w),activeCell:v},c=this._applyFilterByValue(i,v,w,o),h._excelFilter._predicates[i]={},k={field:u,value:o,predicate:f,operator:e,matchcase:!1},{}.currentFilterCollection=o,h._excelFilter._predicates[i][u]=t.Predicate(u,e,o),l.filterSettings.filteredColumns.push(k),tt=t.DataManager(l.filterSettings.filteredColumns),it=(new t.Query).where("field",t.FilterOperators.equal,u),d=tt.executeLocal(it),s=0,rt=d.length;s<rt;s++)g=n.inArray(d[s],l.filterSettings.filteredColumns),g>-1&&l.filterSettings.filteredColumns.splice(g,1);if(l.filterSettings.filteredColumns.push(k),p.filteredcolumns=c.filteredColumns=l.filterSettings.filteredColumns,c.filteredColumns.length<1)for(b=c.multifilterIdx,s=b[0];s<=b[b.length-1];s++)nt=h._generateHeaderText(i,s+1),t.isNullOrUndefined(c.fColumns[nt])||(c.fColumns[nt]=[]);else c.fColumns[u]=n.extend(!0,[],c.filteredColumns);c.predicate=h._excelFilter._predicates[i];p.tableID=c.tableID;p.filteredCells=c.filteredCells;h.XLSelection._refreshBorder();p.operation="filterbycell";h._processBindings(p)&&(l.filterSettings.filteredColumns=temp)},_applyFilterByValue:function(i,r,u){var s=this.XLObj,e=s.getSheet(i),b=[],v,h,y,tt,a,ft=s.getCell(r.rowIndex,r.colIndex)[0].className,c=e.filterSettings.tableRange,it=[],o,l,rt=!1,d,p,et=s.model.scrollSettings.allowVirtualScrolling,g=s.getSheet(i)._filterColl,w,k,nt,f,ut;for(a=s.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tableName",i),a=s._getTableID(a),f=0,p=c.length;f<p;f++)if(c[f].tableID===a){l=f;break}if(!t.isNullOrUndefined(l)&&c[l].tableID===a&&c[l].selectedCellIndexes.indexOf(r.colIndex)!==-1&&c[f].startRow<=r.rowIndex&&c[f].endRow>=r.rowIndex)o=c[l],e.filterSettings.filteredRange=c[l].filteredRange,e._selectedRange=c[l].selectedRange;else{for(e._multipleFiltering=!1,e._multifilterIdx=[],s._dupDetails=!0,this.clearFilter("remove"),s._dupDetails=!1,w=s.getObjectKeys(g),f=w.length-1;f>=0;f--)for(k=s.getObjectKeys(g[f]),j=k.length-1;j>=0;j--)s._isRowViewable(i,w[f])&&(nt=s.getCell(w[f],k[j]),nt.find(".e-filterspan").remove(),nt.removeClass("e-filterhdr")),delete g[w[f]][k[j]];if(u.length<2||u[0].rowIndex===u[u.length-1].rowIndex){for(h=-1,y=u[u.length-1].rowIndex,f=u[0].rowIndex;f>=0;f--)if(t.isNullOrUndefined(s.XLEdit.getPropertyValue(f,u[0].colIndex,"value2"))){h=f;break}h=h===-1?1:h+2;y=this._createSelection(i,h,y+1,u[0].colIndex,[]).endRowIndex-1;v={rowIndex:y,colIndex:r.colIndex};this._getSelectedRangeData({rowIndex:h,colIndex:r.colIndex},v,-1,r.colIndex)}else h=r.rowIndex,y=this._createSelection(i,h,u[u.length-1].rowIndex+1,u[0].colIndex,[]).endRowIndex-1,v={rowIndex:y,colIndex:r.colIndex},this._getSelectedRangeData({rowIndex:h,colIndex:r.colIndex},v,-1,r.colIndex);for(ut=s.getSheet(i)._filterColl,f=u[0].colIndex,p=u[u.length-1].colIndex;f<=p;f++)b.push(f),tt=this._getFilterIcon(),h=h===0?1:h,d={rowIndex:h-1,colIndex:f},this._applyFilterIcon(d,tt),it.push(d);for(s.XLScroll._getColWidths(i,u[0].colIndex),b.length>1&&(e._multipleFiltering=!0),e._multifilterIdx=b,e._selectedCellIndexes=b,f=0,p=c.length;f<p;f++)if(c[f].tableID===a){l=f;rt=!0;break}rt?(o=c[l],o.startRow=r.rowIndex,o.endRow=v.rowIndex,o.multiFiltering=e._multipleFiltering,o.multifilterIdx=e._multifilterIdx,o.selectedCellIndexes=e._multifilterIdx,o.selectedRange=n.extend(!0,{},e._selectedRange),o.filteredRange=n.extend(!0,{},e.filterSettings.filteredRange),o.hiddenIdx=[],o.flterdIdxes=[],o.fColumns={},o.tableID=a):(e.filterSettings.tableRange.push({startRow:h,endRow:v.rowIndex,tableID:-1,fColumns:{},flterdIdxes:[],multiFiltering:e._multipleFiltering,multifilterIdx:e._multifilterIdx,selectedCellIndexes:e._multifilterIdx,selectedRange:n.extend(!0,{},e._selectedRange),filteredRange:e.filterSettings.filteredRange,hiddenIdx:[]}),o=c[c.length-1]);o.filteredCells=it}return o},clearFilter:function(i){for(var u=this.XLObj,s=u.getActiveSheetIndex(),l,p=u.getSheet(s),h=p._filterColl,a=p.filterSettings.tableRange,v=-1,f,w,b=[],y=u._dataContainer.sheets[s],e=u.getObjectKeys(h),o,c,k,r=e.length-1;r>=0;r--)for(o=u.getObjectKeys(h[e[r]]),f=o.length-1;f>=0;f--)t.isNullOrUndefined(u.XLEdit.getPropertyValue(e[r],o[f],"tableID",s))&&(b.push({rowIndex:parseInt(e[r]),colIndex:parseInt(o[f])}),fltrdCol=h[e[r]][o[f]],fltrdCol.status.indexOf("e-ssfiltered")>-1&&(l=u.model.sheets[s].columns[o[f]].field,delete u._excelFilter._predicates[s][l],this._clearFilterColumn(l,"","","Or","","",-1)),i==="remove"&&(delete h[e[r]][o[f]],delete y[e[r]][o[f]].isFilterHeader,delete y[e[r]][o[f]].filterState,delete y[e[r]][o[f]].isFilterVisible,u._isRowViewable(s,parseInt(e[r]))&&(c=u.getCell(parseInt(e[r]),parseInt(o[f])),n.isNumeric(u.XLEdit.getPropertyValue(parseInt(e[r]),parseInt(o[f])))&&c.addClass(u._rAlign),c.find(".e-filterspan").remove(),c.removeClass("e-filterhdr"))));if(i==="remove"){for(r=0;r<a.length;r++)if(a[r].tableID===-1){v=r;break}v>-1&&(w=a.splice(v,1)[0]);u.model.allowComments&&u.XLComment._updateCmntArrowPos();u._isUndoRedo||u._dupDetails||(k={sheetIndex:s,operation:"remove-filter",process:"apply-filter",filteredCells:b,requestType:"filter",reqType:"filter",filteredCells:fltrdCol,fRange:u.getSheet(s).filterSettings.range,filterRange:w},u._completeAction(k))}},filter:function(n){var r=this.XLObj;if(r.model.allowFiltering){var f=r.getActiveSheetIndex(),u=r.getSheet(f),o=!1,v=u._activeCell,e,s,h=u.filterSettings.tableRange,c,i,l,y,a;for(u._multipleFiltering=!1,u._multifilterIdx=[],e=r.XLEdit.getPropertyValue(v.rowIndex,v.colIndex,"tableID",f),i=0,l=h.length;i<l;i++)h[i].tableID===-1&&(o=!0),c=i;if(o&&(r._dupDetails=!0,this.clearFilter("remove"),r._dupDetails=!1,u.filterSettings.filteredRange=[],u._selectedRange={},u._selectedCellIndexes=[],u.filterSettings.filteredColumns=[],r._excelFilter._predicates[f]={}),!t.isNullOrUndefined(e)&&e>-1){for(y=tableRange[c].startRow,s=h[c].multifilterIdx,i=0,l=s.length;i<colLen;i++)a=this._getFilterHeader(f,y,s[i]),!t.isNullOrUndefined(a)&&a.status.indexOf("e-ssfiltered")>-1&&this._clearFilterColumn(u.columns[i].field,"","","","","",e);this._clearFilterTableIcon(f,e);o=!0}o||this._filterCellRange(f,n);r.model.allowComments&&r.XLComment._updateCmntArrowPos()}},_applyFilterIcon:function(n,t){var i=this.XLObj,a=this.XLObj._rAlign,f=i.getActiveSheetIndex(),u=n.rowIndex,r=n.colIndex,s=i.getSheet(f),c=i._getContent(f).find(".e-content col:eq("+r+")"),l=i._isRowViewable(f,u),o=s._filterColl,h=s.columnsWidthCollection,v=s.hideColsCollection,e;l&&(activeEle=i.getCell(u,r,f),activeEle[0].insertBefore(t[0],activeEle[0].childNodes[activeEle[0].childNodes.length-1]),e=i.model.allowResizing&&i.XLResize._getContentWidth(r,f,u,u)+19,h[r]<e&&(i.getFrozenColumns(f)>=r&&i._refreshFreezeColumns(f,r,e-c.width(),"resize"),c.width(e),i._getJSSheetHeader(f).find("col:eq("+r+")").width(e),h[r]>0?(h[r]=e,i.XLScroll._refreshScroller(f,"initial","horizontal")):v[r]=e),activeEle.addClass("e-filterhdr"),activeEle.removeClass("e-wrapword"));i.XLEdit._updateDataContainer({rowIndex:u,colIndex:r},{dataObj:{isFilterHeader:!0,filterState:"filter",isFilterVisible:!0},sheetIdx:f});i.isNumber(i.model.allowFiltering&&i.XLEdit.getPropertyValue(u,r,"value2",f))&&l&&i._removeClass(activeEle[0],a);u in o||(o[u]={});r in o[u]||(o[u][r]={});o[u][r].status="e-ssfilter";o[u][r].isTable=t[0].className.indexOf("e-ft")>-1},_postionFilterIcon:function(n,t){var i=this.XLObj,r=n||i.getActiveCellElem(),o=t||r.find(".e-filterspan"),f,e,u=i._getCellIdx(r[0]);i.model.allowResizing&&(f=i.XLResize._getContentWidth(u.colIndex,i.getActiveSheetIndex(),u.rowIndex,u.rowIndex),e=i.XLResize._getContentHeight(u.rowIndex,i.getActiveSheetIndex()));o.css("margin-top",i._hasClass(r[0],"e-sswraptext")&&f>r.width()?Math.floor(e-25):"")},_filterCellRange:function(n,i){var e=this.XLObj,o,a=!1,ot,st,rt,ht=0,ct,h,v,ut,u,r,d,b,lt,g,at,c,y,s,f=e.getSheet(n),k=[],p=-1,w=0,nt=0,vt=!1,yt=!1,l,tt=[],it=[],ft=!1,pt={sheetIndex:n,reqType:"filter",operation:"apply-filter"},bt=f._multifilterIdx,kt=e.getRows(n)[1],wt=[],et;for(t.isNullOrUndefined(i)?o=f._selectedCells:(g=e.getRangeIndices(i),o=e.XLSelection._getSelectedRange({rowIndex:g[0],colIndex:g[1]},{rowIndex:g[2],colIndex:g[3]})),u=o[0].colIndex,b=o[o.length-1].colIndex;u<=b;u++){if(k.push(u),v=this._getFilterIcon(),l=o[0].rowIndex,o.length<2){if(bt.push(u),ct=e.XLEdit.getPropertyValue(l,u,"value2",n),t.isNullOrUndefined(ct)){for(r=l;r>=0;r--)if(h=e._isRowVisible(n,r),h&&!t.isNullOrUndefined(e.XLEdit.getPropertyValue(r,u,"value2",n))){yt=!0;break}if(!yt)for(r=l;r<l+2;r++)if(h=e._isRowVisible(n,r),h&&!t.isNullOrUndefined(e.XLEdit.getPropertyValue(r,u,"value2",n))){this._applyFilterIcon({rowIndex:r,colIndex:u},v);a=!0;w=nt=r;break}if(!a){for(ut=!1,r=l;r>l-2;r--)r>-1&&(h=e._isRowVisible(n,r),h&&t.isNullOrUndefined(e.XLEdit.getPropertyValue(r,u,"value2",n))&&r>0&&e.XLEdit.getPropertyValue(r-1,u,"value2",n).length===0&&(ut=!0));if(!ut)for(r=l-2;r>=0;r--)if(h=e._isRowVisible(n,r),h&&(t.isNullOrUndefined(e.XLEdit.getPropertyValue(r,u,"value2",n))||r===0)){d=r===0?r:r+1;this._applyFilterIcon({rowIndex:d,colIndex:u},v);a=!0;w=nt=d;break}}}else{for(r=l;r>=0;r--)if(h=e._isRowVisible(n,r),h&&t.isNullOrUndefined(e.XLEdit.getPropertyValue(r,u,"value2",n))){d=r+1;this._applyFilterIcon({rowIndex:r+1,colIndex:u},v);a=!0;w=nt=d;break}a||(this._applyFilterIcon({rowIndex:0,colIndex:u},v),a=!0,w=nt=0)}a||e._showAlertDlg("Alert","Alert")}else{if(!vt||k.length>0)for(r=l,lt=o[o.length-1].rowIndex;r<=lt;r++)h=e._isRowVisible(n,r),h&&(e.XLEdit.getPropertyValue(r,u,"value2",n)||tt.length&&e.XLEdit.getPropertyValue(0,u,"isCHide",n))&&((p===-1||p>r)&&(p=r),vt=!0,a=!0,ft=!0),p<r&&ht===0&&wt.push(r);ft&&(tt.push(u),f._multifilterIdx.push(u),ft=!1)}ht++}if(k.length>1&&(f._multipleFiltering=!0),it=[],a){if(o.length>1){for(u=0,b=tt.length;u<b;u++)v=this._getFilterIcon(),this._applyFilterIcon({rowIndex:p,colIndex:tt[u]},v),it.push({rowIndex:p,colIndex:tt[u]});c={rowIndex:p+1,colIndex:o[0].colIndex};y={rowIndex:o[o.length-1].rowIndex};f._selectedRange={startRow:c.rowIndex,endRow:y.rowIndex,dataSourceIndexes:wt};this._getSelectedRangeData(c,o[o.length-1],-1,c.colIndex);f._selectedCellIndexes=k}else o.length===1&&it.push({rowIndex:w,colIndex:k[0]}),et=this._createSelection(n,w+1,nt+1,k[0],[]),at=et.endRowIndex-1,c={rowIndex:w+1,colIndex:o[0].colIndex},y={rowIndex:at,colIndex:o[0].colIndex},f._selectedRange={startRow:c.rowIndex,endRow:y.rowIndex,dataSourceIndexes:et.filteredIndex},this._getSelectedRangeData(c,y,-1,c.colIndex),f._selectedCellIndexes.push(o[0].colIndex);for(pt={sheetIndex:n,filteredCells:it,reqType:"filter",operation:"apply-filter",tableID:-1},rt=f.filterSettings.tableRange,u=0,b=rt.length;u<b;u++)rt[u].tableID===-1&&(ot=!0,st=u);ot?(s=f.filterSettings.tableRange[st],s.startRow=c.rowIndex,s.endRow=y.rowIndex,s.multiFiltering=f._multipleFiltering,s.multifilterIdx=f._multifilterIdx,s.selectedCellIndexes=f._multifilterIdx,s.selectedRange=f._selectedRange,s.filteredRange=f.filterSettings.filteredRange,s.filteredColumns=f.filterSettings.filteredColumns,s.predicate=e._excelFilter._predicates[n],s.hiddenIdx=[],s.flterdIdxes=[],s.fColumns={},s.filterColumnName=[]):f.filterSettings.tableRange.push({startRow:c.rowIndex,endRow:y.rowIndex,tableID:-1,multiFiltering:f._multipleFiltering,multifilterIdx:f._multifilterIdx,selectedCellIndexes:f._multifilterIdx,selectedRange:f._selectedRange,filteredRange:f.filterSettings.filteredRange,filteredColumns:f.filterSettings.filteredColumns,fColumns:{},predicate:{},hiddenIdx:[],fltrdIdxes:[],filterColumnName:[]});(!f._isImported||f._isLoaded)&&(e.XLSelection._refreshBorder(),e._completeAction(pt));e.XLScroll._getColWidths(n,f._multifilterIdx[0])}else e._showAlertDlg("Alert","Alert","",440)},_filterClickHandler:function(i){var u=this.XLObj,d,g,nt=n(i.target),e=u.getActiveSheetIndex(),o=u.getSheet(e),tt=!1,a,v,y,at,c,it,l,rt,h,s,f,ut=[],vt={},ft,et,p,ot,w,b,st,yt=u.model.scrollSettings.allowVirtualScrolling,r,ht,ct,lt,k;if((v=u.model.sheets[e].columns[i.target.parentNode.cellIndex].field,this._isDecimal=!1,!u.model.allowLockCell||!u.getSheet(e)._isSheetProtected)&&(nt[0].className.indexOf("e-ssfiltered")>-1&&(tt=!0),nt[0].className.indexOf("e-ssfilter")>-1)){for(f=u.model.sheets[e].filterSettings.tableRange,d=u._getCellIdx(nt.parent()[0]),g=u.XLEdit.getPropertyValue(d.rowIndex,d.colIndex,"tableName"),h=t.isNullOrUndefined(g)?-1:parseInt(g.replace("e-table","")),r=0,c=f.length;r<c;r++)f[r].tableID===h&&(b=r,f[r].multiFiltering?(it=f[r].multifilterIdx[0],l=f[r].multifilterIdx[f[r].multifilterIdx.length-1]):it=l=i.target.parentNode.cellIndex,ot={rowIndex:f[r].startRow,colIndex:it},w={rowIndex:f[r].endRow,colIndex:l},o._multipleFiltering=f[r].multiFiltering,o._multifilterIdx=f[r].multifilterIdx,s=o._selectedRange=f[r].selectedRange,o.filterSettings.filteredRange=f[r].filteredRange,o._selectedCellIndexes=f[r].selectedCellIndexes);if(h===-1){if(st=this._createSelection(e,s.startRow,s.endRow+1,l,s.dataSourceIndexes),a=st.endRowIndex-1,s.endRow!=a)for(r=s.endRow+1;r<=a;r++)rt={field:v,value:u.XLEdit.getPropertyValue(r,l,"value2",e),matchcase:!1,operator:"equal",predicate:"or"},o.filterSettings.filteredColumns.push(rt),f[b].filteredColumns.push(rt),f[b].selectedRange.endRow=a;w={rowIndex:a,colIndex:l};f[b].selectedRange=o._selectedRange={startRow:ot.rowIndex,endRow:w.rowIndex,dataSourceIndexes:st.filteredIndex}}for(this._getSelectedRangeData(ot,w,h,i.target.parentNode.cellIndex),y=o.columns,at=this._getColumnType(e,s.startRow,s.endRow,i.target.parentNode.cellIndex),r=0,c=y.length;r<c;r++)if(y[r].field===v){u._$colType=at;u._$curFieldName=y[r].field;break}for(ht=u.element.find(".e-excelfilter.e-dlgcontainer"),lt=u.element.height(),ft=u.element.width(),ct=ht.height(),et=ht.width(),p=i.clientX,k=i.clientY,ft-i.clientX<=et&&(p=ft-et),lt-i.clientY<=ct&&(k=lt-(ct+20)),f=u.model.sheets[e].filterSettings.tableRange,r=0,c=f.length;r<c;r++)f[r].tableID===h&&(ut=f[r].filteredColumns,vt=f[r].predicate);u._excelFilter._predicates[e]=vt;this._isSearchEdit=!0;o.filterSettings.filteredRange==null?u._excelFilter.openXFDialog({field:v,dataSource:u.model.sheets[e].dataSource,position:{X:p,Y:k},type:u._$colType,format:u._$colFormat,filteredColumns:ut,sortedColumns:[],key:e,tableID:h,selectedColors:u.model.sheets[e]._selectedCellColors,isFiltered:tt,blank:"",enableColor:!0,filteredByColor:u.model.sheets[e]._filteredByColor}):u._excelFilter.openXFDialog({field:v,dataSource:u.model.sheets[e].filterSettings.filteredRange,position:{X:p,Y:k},type:u._$colType,format:u._$colFormat,filteredColumns:ut,sortedColumns:[],key:e,tableID:h,selectedColors:u.model.sheets[e]._selectedCellColors,isFiltered:tt,blank:"",enableColor:!0,filteredByColor:u.model.sheets[e]._filteredByColor})}},_cancelHandler:function(){this._isSearchEdit=!1},_filterHandler:function(i){var e,ft=!1,o=-1,d,c,r={},et,u=this.XLObj,l=u.getActiveSheetIndex(),v=u.getSheet(l),ot,g,nt,s=[],p={},w,b,tt,h,k,f,a,y,it,rt,ut;for(r.requestType=i.action==="sorting"||i.action==="filterbycolor"?i.action:"filtering",e=v.filterSettings.tableRange,u.XLFilter._isSearchEdit=!1,f=0,a=e.length;f<a;f++)e[f].tableID===i.tableID&&(n.extend(!0,s,e[f].filteredColumns),p=e[f].predicate,ft=!0,o=f);if(r.tableID=i.tableID,i.action==="filtering"||i.action==="clearfiltering"){for(et=t.DataManager(s),ot=(new t.Query).where("field",t.FilterOperators.equal,i.fieldName),g=et.executeLocal(ot),r.filteredColumns=s,f=0,a=g.length;f<a;f++)nt=n.inArray(g[f],s),nt>=0&&s.splice(nt,1);i.action==="clearfiltering"?delete u._excelFilter._predicates[l][i.fieldName]:t.merge(s,i.filterCollection);p=u._excelFilter._predicates[l]}if(ft)if(e[o].filteredColumns=s,e[o].filterCollection=i.filterCollection,e[o].predicate=p,e[o].action=i.action,s.length<1)for(b=e[o].multifilterIdx,f=b[0];f<=b[b.length-1];f++)tt=u._generateHeaderText(l,f+1),t.isNullOrUndefined(e[o].fColumns[tt])||(e[o].fColumns[tt]=[]);else e[o].fColumns[i.fieldName]=n.extend(!0,[],s);if(i.action==="filtering"||i.action==="clearfiltering")r.currentFilteringColumn=i.fieldName,r.ejpredicate=i.ejpredicate,r.filterCollection=n.extend(!0,[],i.filterCollection),r.action=i.action,r.reqType="filter",r.sheetIndex=l,r.filteredcolumns=s,r.predicate=p;else if(i.action==="sorting"){if(!u.model.allowSorting)return;for(r.requestType=r.action=i.action,d=u.XLEdit.getColumnIndexByField(i.sortDetails.field),c=v.filterSettings.tableRange[o].selectedRange,h=v.filterSettings.tableRange[o].selectedCellIndexes,k=v._filterColl,u.XLSort._isSortByFilter=!0,u.XLSort.sortByRange(u.swapRange([c.startRow,h[0],c.endRow,h[h.length-1]]),i.sortDetails.field,i.sortDetails.direction,i.tableID),this._changeSortIcon({rowIndex:c.startRow-1,colIndex:d},i.sortDetails.direction),f=0,a=h.length;f<a;f++)h[f]!=d&&(k[c.startRow-1][h[f]].status.indexOf("-asc")>-1||k[c.startRow-1][h[f]].status.indexOf("-dsc")>-1)&&(k[c.startRow-1][h[f]].status="e-ssfilter",u._isRowViewable(l,c.startRow-1)&&(w=u.getCell(c.startRow-1,h[f]).find(".e-filterspan")[0],u._removeClass(w,"e-ssfilter-asc"),u._removeClass(w,"e-ssfilter-dsc"),u.addClass(w,"e-ssfilter")))}else r.requestType=r.action=i.action,r.range=v._selectedRange,i.action==="sortbycolor"?(r.sortColumn=i.sortDetails.field,r.operation=i.sortDetails.operation,y=i.sortDetails.color.replace("rgb(","").replace(")","").split(",")):(u._isUndoRedo?(r.filterColumn=i.columnName,r.operation=i.operation):(r.filterColumn=i.filterDetails.field,r.operation=i.filterDetails.operation,y=i.filterDetails.color.replace("rgb(","").replace(")","").split(",")),r.tableID=i.tableID,u.model.sheets[l]._filteredByColor=r.filterColumn),u._isUndoRedo||(it=y[0],rt=y[1],ut=y[2]),r.operation==="sortbgcolor"||r.operation==="filterbgcolor"?r.bgcolor=u._isUndoRedo?i.bgcolor:this._convertrgbtohex(parseInt(it),parseInt(rt),parseInt(ut)):r.fgcolor=u._isUndoRedo?i.fgcolor:this._convertrgbtohex(parseInt(it),parseInt(rt),parseInt(ut));i.action!=="sorting"&&u._processBindings(r)&&(s=temp);u.model.allowComments&&u.XLComment._updateCmntArrowPos();u.XLSelection._refreshBorder()},_convertrgbtohex:function(n,t,i){return"#"+(16777216+(n<<16)+(t<<8)+i).toString(16).slice(1)},_clearFilterColumn:function(i,r,u,f,e,o,s){var c=this.XLObj,b,l={},h,k,p=c.getActiveSheetIndex(),a=c.getSheet(p),tt=!1,d={},it,rt,g,nt,v=a.filterSettings.tableRange,y=[],w,ut;for(l.requestType=t.Grid.Actions.Filtering,l.currentFilterObject=[],n.isArray(r)||(r=n.makeArray(r)),n.isArray(u)||(u=n.makeArray(u)),this._currentFilterColumn=this._getColumnByField(p,i),w=0,ut=r.length;w<ut;w++)if(d={field:i,operator:r[w],value:u[w],matchcase:e,predicate:f,actualFilterValue:o},!tt){for(h=0,k=v.length;h<k;h++)v[h].tableID===s&&(b=v[h],n.extend(!0,y,v[h].filteredColumns),c._excelFilter._predicates[p]=v[h].predicate,a.filterSettings.filteredRange=a.filterSettings.tableRange[h].filteredRange,a._selectedCellIndexes=v[h].selectedCellIndexes,a._selectedRange=v[h].selectedRange,a._multifilterIdx=v[h].multifilterIdx);for(it=t.DataManager(y),rt=(new t.Query).where("field",t.FilterOperators.equal,d.field),g=it.executeLocal(rt),h=0,k=g.length;h<k;h++)nt=n.inArray(g[h],y),nt!==-1&&y.splice(nt,1)}c._isUndoRedo&&c.isUndefined(b)||(tt=!0,delete c._excelFilter._predicates[p][i],b.filteredColumns=y,b.predicate=c._excelFilter._predicates[p],l.currentFilterObject.push(d),l.filterCollection=y,l.currentFilteringColumn=i,l.filteredcolumns=y,l.action="clearfiltering",l.reqType="filter",l.tableID=s,c._processBindings(l)&&(a.filterSettings.filteredColumns.reverse().splice(0,r.length),a.filterSettings.filteredColumns.reverse()),c.model.allowComments&&c.XLComment._updateCmntArrowPos(),this.XLObj.XLSelection._refreshBorder())},_getFilterHeader:function(n,i,r){var f=this.XLObj,e=f.getSheet(n),u=e._filterColl;if(!t.isNullOrUndefined(u[i])&&!t.isNullOrUndefined(u[i][r]))return u[i][r]},_filterTable:function(i,r){var s=this.XLObj,f=s.getSheet(i),h=[],y=!1,p=!1,o,l,w,a,u,b;f._multipleFiltering=!1;f._multifilterIdx=[];var v=n.extend(!0,[],f._selectedCells),c=v[v.length-1],e=v[0];for(u=e.colIndex;u<=c.colIndex;u++)a=this._getFilterHeader(i,e.rowIndex,u),!t.isNullOrUndefined(a)&&a.status.indexOf("e-ssfilter")>-1?y=!0:(l=this._getFilterIcon(),w="e-ft"+r,l.addClass(w),this._applyFilterIcon({rowIndex:e.rowIndex,colIndex:u},l),h.push(u),f._multifilterIdx.push(u));if(s.XLScroll._getColWidths(i,e.colIndex),!y)if(h.length>1&&(f._multipleFiltering=!0,p=!0),e.rowIndex=e.rowIndex+1,this._getSelectedRangeData(e,c,r,e.colIndex),s._isFATResize){if(o=f.filterSettings.tableRange,o.length)for(u=0,b=o.length;u<b;u++)if(o[u].tableID===r){o[u].endRow=c.rowIndex;break}s._isFATResize=!1}else f.filterSettings.tableRange.push({startRow:e.rowIndex,endRow:c.rowIndex,tableID:r,multiFiltering:p,multifilterIdx:h,selectedCellIndexes:h,selectedRange:n.extend(!0,{},f._selectedRange),filteredRange:f.filterSettings.filteredRange,filteredColumns:f.filterSettings.filteredColumns,fColumns:{},predicate:{},hiddenIdx:[],filterColumnName:[]})},_clearFilterTable:function(n,t,i){var e=this.XLObj.getSheet(n?n:this.getActiveSheetIndex()),u,r,f;for(u=e.filterSettings.tableRange,r=0,f=u.length;r<f;r++)u[r].tableID===t&&(this._clearAllFilter(n,r,i),f=u.length)},_clearAllFilter:function(i,r,u){var h=this.XLObj,l=h._dataContainer.sheets[i],c=h.getSheet(i),s=c.filterSettings.tableRange,a,y,f,p,w,e,o,v;for(c._selectedRange=s[r].selectedRange,e=s[r].multifilterIdx,o=s[r].startRow,f=0,p=e.length;f<p;f++)w=c.columns[e[f]].field,v=h.XLEdit.getPropertyValue(o-1,e[f],"filterState"),!t.isNullOrUndefined(v)&&v.indexOf("filtered")>-1&&this._clearFilterColumn(w,"","","Or","","",s[r].tableID),u||(h._isRowViewable(i,o-1)&&(a=h.getCell(o-1,e[f]),y=a.find(".e-filterspan"),n(y).remove(),a.removeClass("e-filterhdr")),l[o-1][e[f]]&&(delete l[o-1][e[f]].isFilterHeader,delete l[o-1][e[f]].filterState),delete c._filterColl[o-1][e[f]]);u||(s.splice(r,1),len=s.length)},_clearFilterTableIcon:function(n,t){for(var f=this.XLObj,s,h=f.getSheet(n),r=h.filterSettings.tableRange,e,o,u,l,c,i=0,a=r.length;i<a;i++)if(r[i].tableID===t)for(h._selectedRange=r[i].selectedRange,h.filterSettings.filteredRange=r[i].filteredRange,e=r[i].multifilterIdx,o=r[i].startRow,u=0,l=e.length;u<l;u++)s=f.XLEdit.getPropertyValue(o-1,e[u],"isFilterVisible"),f._isRowViewable(n,o-1)&&(c=f.getCell(o-1,e[u]).find(".e-filterspan"),s?c.hide():c.show()),f.XLEdit._updateDataContainer({rowIndex:o-1,colIndex:e[u]},{dataObj:{isFilterVisible:!s}})},_insertFilterIcon:function(n,t,i){var r;r=this._getFilterIcon();i.tableID>-1&&this.XLObj.XLEdit._updateDataContainer({rowIndex:n,colIndex:t},{dataObj:{tableName:"e-table"+i.tableID}});this._applyFilterIcon({rowIndex:n,colIndex:t},r)},_changeFilterIcon:function(n,t,i){var e,s,h,c=!1,r=this.XLObj,u=n.rowIndex,f=n.colIndex,l=r._rAlign,o=r.getActiveSheetIndex();h=this._getFilterHeader(o,u,f).status;r._isRowViewable(o,u)&&(s=r.getCell(u,f),e=s.find(".e-filterspan")[0],s.removeClass(l),c=!0);t==="filter"?i.indexOf("filtered")<0&&(r.XLEdit._updateDataContainer({rowIndex:u,colIndex:f},{dataObj:{filterState:i.replace("filter","filtered")}}),r.getSheet(o)._filterColl[u][f].status=h.replace("e-ssfilter","e-ssfiltered"),c&&(e.className=e.className.replace("e-ssfilter","e-ssfiltered"))):(r.XLEdit._updateDataContainer({rowIndex:u,colIndex:f},{dataObj:{filterState:i.replace("filtered","filter")}}),r.getSheet(o)._filterColl[u][f].status=h.replace("e-ssfiltered","e-ssfilter"),c&&(e.className=e.className.replace("e-ssfiltered","e-ssfilter")))},_changeSortIcon:function(n,t){var u=this.XLObj,h=u.getActiveSheetIndex(),r,i,e,o=!1,s=u.getSheet(h)._filterColl,f;i=s[n.rowIndex][n.colIndex].status;r=i.indexOf("e-ssfiltered")>-1?12:10;e=i.substr(0,r);u._isRowViewable(h,n.rowIndex)&&(f=u.getCell(n.rowIndex,n.colIndex).find(".e-filterspan")[0],i=f.className,r=i.indexOf("e-ssfilter")+r,o=!0);t==="ascending"?(s[n.rowIndex][n.colIndex].status=e+"-asc",o&&(f.className=i.substr(0,r)+"-asc")):(s[n.rowIndex][n.colIndex].status=e+"-dsc",o&&(f.className=i.substr(0,r)+"-dsc"))},_extendFilterRange:function(n,t){var o=this.XLObj,u,r=o.getSheet(o.getActiveSheetIndex()).filterSettings.tableRange,i,e,f;if(r.length)for(i=0,f=r.length;i<f;i++)if(r[i].tableID==n){if(r[i].endRow<t[2]&&(u=r[i].selectedRange.dataSourceIndexes,r[i].endRow=r[i].selectedRange.endRow=t[2],u[u.length-1]<r[i].endRow))for(e=u[u.length-1],f=r[i].endRow;e<f;e++)u.push(e+1);break}},_checkFilteredCells:function(i){for(var u,b,v=this.XLObj,o=v.getSheet(i),c=o._selectedCells,d=new RegExp("\\be-table.*?\\b","g"),s,e=[-1],f=o.filterSettings.tableRange,h=o.selectedRange,l=!1,y=[],p,w,k=o._tableManager,r=0,a=c.length;r<a;r++)s=v.XLEdit.getPropertyValue(c[r].rowIndex,c[r].colIndex,"tableID",i),t.isNullOrUndefined(s)||e.indexOf(s)>-1&&e.push(s);for(r=0,a=e.length;r<a;r++)for(u=0,b=f.length;u<b;u++)if(f[u].tableID===e[r]){f[u].startRow===h[0]&&f[u].multifilterIdx[0]===h[1]&&f[u].endRow===h[2]&&f[u].multifilterIdx[f[u].multifilterIdx.length]===h[3]?(l=!0,p=n.extend(!0,{},k[e[r]]),w=n.extednd(!0,{},f[u]),y.push({tableID:e[r],tabObj:p,tabObj2:w})):l=!1;break}return tabDetails={isApplied:l,clrTable:y}},_moveFilteredCells:function(n,t){for(var u=t.clrTable,f,e,i=this.XLObj,r=0,o=u.length;r<o;r++)if(u[r].tableID>-1)i.XLFormat.removeTable(u[r].tableID),i.XLFormat.createTable(u[r].tableObj,newRng);else for(tabObj2=u[r].tabObj2,j=tabObj2.multifilterIdx[0],o=tabObj2.multifilterIdx[tabObj2.multifilterIdx.length-1];j<=o;j++)f=i._generateHeaderText(n,tabObj2.multifilterIdx[j]),delete i._excelFilter._predicates[n][f],i.XLFilter._clearFilterColumn(f,"","","Or",null,null,u[r].tableID),i._isRowViewable(n,tabObj2.startRow-1)&&(e=i.getCell(tabObj2.startRow-1,j,n),e.find("span.e-ssfilter").remove(),e.addClass(this._rAlign))},_updateFilterIcons:function(t,i,r,u){for(var o=this.XLObj,f,s,h=n("#"+o._id+"numberSelectAll").ejCheckBox("instance"),l=h?!1:h.model.checked,c=n("#"+o._id+"stringSelectAll").ejCheckBox("instance"),a=c?!1:c.model.checked,e=t;e<=i;e++){s={rowIndex:e,colIndex:r};f=o.XLEdit.getPropertyValue(e,r,"filterState");f.indexOf("filtered")>-1&&(u=="clearfiltering"||l||a)?this._changeFilterIcon(s,"filtered",f):f.indexOf("filtered")<0&&u!="clearfiltering"&&this._changeFilterIcon(s,"filter",f);break}},_fltrRowHighlight:function(t,i,r,u,f){var s=this.XLObj,v=s.getActiveSheetIndex(),l=s._getJSSheetRowHeaderContent(v),a=l.find("table tr:gt("+(t-1)+"):lt("+(i-t+1)+")"),o,y,e,h,c;if(s.model.scrollSettings.allowVirtualScrolling&&(a=l.find("table tr").filter(function(){return n(this).attr("idx")>=t&&n(this).attr("idx")<=i})),r==="clear")if(a.find("td").removeClass("e-filterhiglight"),s.clearRangeData([t,0,i,0],"isFilterHighlight"),u>-1)for(o=s.model.sheets[v].filterSettings.tableRange,e=0,y=o.length;e<y;e++)i>=o[e].startRow&&(t<=o[e].startRow||t<=o[e].endRow)&&o[e].tableID===u&&o[e].filterColumnName.length&&(h=o[e].startRow,c=o[e].endRow,l.find("table tr:gt("+(h-1)+"):lt("+(c-h+1)+")").find("td").addClass("e-filterhiglight"),s.updateUniqueData({isFilterHighlight:!0},[h,0,c,0]),s.model.scrollSettings.allowVirtualScrolling?l.find("table tr").filter(function(){return n(this).attr("idx")>=h&&n(this).attr("idx")<=c}).find("td").addClass("e-filterhiglight"):l.find("table tr:gt("+(h-1)+"):lt("+(c-h+1)+")").find("td").addClass("e-filterhiglight"),h>=o[e].startRow&&(h=o[e].startRow),c<=o[e].endRow&&(c=o[e].endRow),l.find("table tr:gt("+(h-1)+"):lt("+(c-h+1)+")").find("td").addClass("filterhiglight"));else s.model.scrollSettings.allowVirtualScrolling&&f?(a.find("td").addClass("e-filterhiglight"),s.updateUniqueData({isFilterHighlight:!0},[t,0,i,0])):a.hasClass("e-r-hide")&&(a.find("td").addClass("e-filterhiglight"),s.updateUniqueData({isFilterHighlight:!0},[t,0,i,0]));else r==="add"&&(a.find("td").addClass("e-filterhiglight"),s.updateUniqueData({isFilterHighlight:!0},[t,0,i,0]))},_checkFilterApplied:function(n,t,i,r){var h=!1,c=!1,f=!1,e=!1,o=this.XLObj,v=o.getSheet(n),l=v.filterSettings.tableRange,u,s,a;for(o._isFilterApplied=!1,s=0,a=l.length;s<a;s++){if(u=l[s],u.endRow<t&&(f=!0),u.startRow-1>t&&(h=!0),u.multifilterIdx[u.multifilterIdx.length-1]<i&&(e=!0),u.multifilterIdx[0]>i&&(c=!0),r.indexOf("Right")>-1||r.indexOf("Left")>-1){if(!h&&!f&&!e&&u.tableID>-1){o._isFilterApplied=!0;break}}else if(!c&&!e&&!f&&u.tableID>-1){o._isFilterApplied=!0;break}f=!1;h=!1;c=!1;e=!1}},_updateFilterCollection:function(i,r,u,f,e){var l,h,v,p,g,c=this.XLObj,y=c.getSheet(i),w=y.filterSettings.tableRange,o,s,rt=c.model.scrollSettings.allowVirtualScrolling,d,nt,a=y._filterColl,it,b,tt,k;if(u=u+1,f==="row")for(l=0,p=w.length;l<p;l++)o=w[l],s=o.multifilterIdx,e==="insert"?r<=o.endRow&&(o.endRow=o.endRow+u,r<o.startRow?(this._updateFilterColl(o.startRow-1,s[0],u,a,"insert","move",f,o.tableID),o.startRow=o.startRow+u,o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u,isInsertBefore:!0})):o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u})):r<=o.endRow&&(o.endRow=o.endRow-u,r<o.startRow?(this._updateFilterColl(o.startRow-1,s[0],u,a,"delete","move",f,o.tableID),o.startRow=o.startRow-u,o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u,isInsertBefore:!0})):o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u})),startCell={rowIndex:o.startRow,colIndex:s[0]},endCell={rowIndex:o.endRow,colIndex:s[s.length-1]},this._getSelectedRangeData(startCell,endCell,o.tableID),o.selectedRange=n.extend(!0,{},y._selectedRange),o.filteredRange=n.extend(!0,{},y.filterSettings.filteredRange);else for(it=c._dataContainer.sheets[i],b=0,l=0,p=w.length;l<p;l++){if(o=w[l],s=o.multifilterIdx,this._updateFilteredColumns(l,r,u,e),e==="insert"){if(r<=s[0]){for(tt=n.extend(!0,[],s),h=s.length-1;h>=0;h--)this._updateFilterColl(o.startRow-1,tt[h],u,a,"insert","move",f,o.tableID),s[b]=s[b]+u,b++;o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u,isInsertBefore:!0})}else if(r<=s[s.length-1])for(o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u}),h=s[s.length-1]+u;h>r;h--)s.indexOf(h)===-1&&s.push(h),this._updateFilterColl(o.startRow-1,h,u,a,"insert","extend",f,o.tableID)}else if(r<=s[0]){for(h=0;h<s.length;h++)s[h]=s[h]-u,this._updateFilterColl(o.startRow-1,s[h],u,a,"delete","move",f,o.tableID);o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u,isInsertBefore:!0})}else if(r<=s[s.length-1]){for(v=r,g=s[s.length-1];v<=g;v++)nt=c._generateHeaderText(i,v+1),d=c.XLEdit.getPropertyValue(o.startRow-1,v,"filterState"),!t.isNullOrUndefined(d)&&d.indexOf("filtered")>-1&&this._clearFilterColumn(nt,"","","Or","","",o.tableID),this._updateFilterColl(o.startRow-1,v,u,a,"delete","extend",f,o.tableID);for(s.splice(s.length-u,u),k=1;k<=u;k++)delete a[o.startRow-1][s[s.length-1]+k];o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u})}startCell={rowIndex:o.startRow,colIndex:s[0]};endCell={rowIndex:o.endRow,colIndex:s[s.length-1]};this._getSelectedRangeData(startCell,endCell,o.tableID);o.selectedRange=n.extend(!0,{},y._selectedRange);o.filteredRange=n.extend(!0,{},y.filterSettings.filteredRange);s.length<2&&(o.multiFiltering=!1)}},_updateFilterColl:function(n,i,r,u,f,e,o,s){var h=s>-1;t.isNullOrUndefined(u[n])&&(u[n]={});o==="column"?f==="insert"?e==="move"?(u[n][i+r]=u[n][i],delete u[n][i]):(u[n][i]=u[n][i-r],u[n][i-r]={isTable:h,status:"e-ssfilter"}):e==="move"?(u[n][i]=u[n][i+r],delete u[n][i+r]):u[n][i]=u[n][i+r]:f==="insert"?(u[n+r]=u[n],delete u[n]):(u[n]=u[n+r],delete u[n+r]);this.XLObj.getObjectLength(u[n])<1&&delete u[n]},_updateFilteredColumns:function(t,i,r,u){var f=this.XLObj,b,e=f.getActiveSheetIndex(),o=f.getSheet(e).filterSettings.tableRange[t],y=n.extend(!0,[],o.filteredColumns),k=n.extend(!0,{},o.fColumns),v=n.extend(!0,{},o.fColumns),d,s,a,c;for(colIdxes=o.multifilterIdx,s=0,d=y.length;s<d;s++)for(colIdx=f.XLEdit.getColumnIndexByField(o.filteredColumns[s].field),c=i;c<i+r;c++)i<=colIdx&&(u==="delete"?i===colIdx?y.splice(s,1):y[s].field=f._generateHeaderText(e,colIdx):y[s].field=f._generateHeaderText(e,colIdx+1+1));o.filteredColumns=y;var g=f.getObjectKeys(o.fColumns),w=f.getObjectKeys(k),h,l,p;for(o.predicate=o.predicate,s=w.length-1;s>=0;s--)for(b=f.XLEdit.getColumnIndexByField(w[s]),a=i;a<i+r;a++)if(a<=b){for(h=n.extend(!0,[],k[w[s]]),c=0;c<h.length;c++)colIdx=f.XLEdit.getColumnIndexByField(h[c].field),a<=colIdx&&(u==="delete"?a===colIdx?h.splice(s,1):h[c].field=f._generateHeaderText(e,colIdx):h[c].field=f._generateHeaderText(e,colIdx+1+1));l=f.XLEdit.getColumnIndexByField(w[s]);u==="delete"?a===l?(delete o.predicate[f._generateHeaderText(e,l+1)],delete v[f._generateHeaderText(e,l+1)]):(v[f._generateHeaderText(e,l)]=h,delete v[f._generateHeaderText(e,l+1)],o.predicate[f._generateHeaderText(e,l)]=f._excelFilter.generatePredicate(h),delete o.predicate[f._generateHeaderText(e,l+1)]):(p=l+1,v[f._generateHeaderText(e,p+1)]=h,delete v[f._generateHeaderText(e,p)],o.predicate[f._generateHeaderText(e,p+1)]=f._excelFilter.generatePredicate(h),delete o.predicate[f._generateHeaderText(e,p)])}o.fColumns=v}}}(jQuery,Syncfusion),function(n,t,r){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.ribbon=function(n){this.XLObj=n;this._appTabCollection=null;this._tabCollection=[];this._contextualTabCollection=[];this._smallBtnHeight=25;this._mediumBtnHeight=35;this._bigBtnHeight=75;this._splitBtnHeight=75;this._dropDownHeight=25;this._ribbonState=!0;this._isSetModel=!1;this._isDesignTab=!0;this._isDirtySelect=!1;this._hasTitle="";this._pageLaySptBtnIds=["sizesbtn"];this._dataBtnIds=["sortAtoZ","sortZtoA","filter","clearfilter","validationbtn"];this._dataSptBtnIds=["validationsbtn"];this._toggleBtnIds=["bold","italic","underline","line-through","left","right","center","top","middle","bottom","wraptext","formatpainter"];this._homeBtnIds=["pastebtn","increasefontsize","decreasefontsize","increment","decrement","undo","redo","accounting","usegrouping","percentage","cut","copy"];this._homeSptBtnIds=["pastesbtn","border","cFormat","formatastable","cellstyles","find","clear","merge","autosum"];this._protectStateBtnIds=["cut","copy","find","clear","pastebtn","pastesbtn","undo","redo","ProtectSheet","protectWorkbook","print","printselected"];this._insertBtnIds=["pivotTable","table","hyperlink","pictures"];this._insertSptBtnIds=["columnchart","barchart","stockchart","linechart","areachart","combochart","piechart","scatterchart"];this._pageLayBtnIds=["sizebtn","print","printselected"];this._pageLayChckBxIds=["Vheading","Vgridlines"];this._ddIds=["cellformat","fontsize","font-family"];this._cpIds=["background-color","color"];this._splitBtnIds=["border","paste","cFormat","formatastable","cellstyles","find","clear","sortfilter"];this._pasteMenuData=[{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:null},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:null}];this._fontFamily=[{value:"1",text:"Angsana New"},{value:"2",text:"Arial"},{value:"3",text:"Arial Black"},{value:"4",text:"Batang"},{value:"5",text:"Book Antiqua"},{value:"6",text:"Browallia New"},{value:"7",text:"Calibri"},{value:"8",text:"Cambria"},{value:"9",text:"Candara"},{value:"10",text:"Century"},{value:"11",text:"Comic Sans MS"},{value:"12",text:"Consolas"},{value:"13",text:"Constantia"},{value:"14",text:"Corbel"},{value:"15",text:"Cordia New"},{value:"16",text:"Courier"},{value:"17",text:"Courier New"},{value:"18",text:"DilleniaUPC"},{value:"19",text:"Dotum"},{value:"20",text:"FangSong"},{value:"21",text:"Garamond"},{value:"22",text:"Georgia"},{value:"23",text:"Gulim"},{value:"24",text:"GungSuh"},{value:"25",text:"KaiTi"},{value:"26",text:"JasmineUPC"},{value:"27",text:"Malgun Gothic"},{value:"28",text:"Mangal"},{value:"29",text:"Meiryo"},{value:"30",text:"Microsoft JhengHei"},{value:"31",text:"Microsoft YaHei"},{value:"32",text:"MingLiu"},{value:"33",text:"MingLiU_HKSCS"},{value:"34",text:"MS Gothic"},{value:"35",text:"MS Mincho"},{value:"36",text:"MS PGothic"},{value:"37",text:"MS PMincho"},{value:"38",text:"PMingliU"},{value:"39",text:"PMingLiU-ExtB"},{value:"40",text:"SimHei"},{value:"41",text:"SimSun"},{value:"42",text:"SimSun-ExtB"},{value:"43",text:"Tahoma"},{value:"44",text:"Times"},{value:"45",text:"Times New Roman"},{value:"46",text:"Trebuchet MS"},{value:"47",text:"Verdana"},{value:"48",text:"Yu Gothic"},{value:"49",text:"Yu Mincho"}];this._fontSize=[{value:"8pt",text:"8"},{value:"9pt",text:"9"},{value:"10pt",text:"10"},{value:"11pt",text:"11"},{value:"12pt",text:"12"},{value:"14pt",text:"14"},{value:"16pt",text:"16"},{value:"18pt",text:"18"},{value:"20pt",text:"20"},{value:"22pt",text:"22"},{value:"24pt",text:"24"},{value:"26pt",text:"26"},{value:"28pt",text:"28"},{value:"36pt",text:"36"},{value:"48pt",text:"48"},{value:"72pt",text:"72"}];this._mergeMenuData=[{id:"MergeAndCenter",text:n._getLocStr("MergeAndCenter"),parentId:null,sprite:"e-icon e-ss-mergecenter"},{id:"MergeAcross",text:n._getLocStr("MergeAcross"),parentId:null,sprite:"e-icon e-ss-mergeacross"},{id:"MergeCells",text:n._getLocStr("MergeCells"),parentId:null,sprite:"e-icon e-ss-merge"},{id:"UnmergeCells",text:n._getLocStr("UnmergeCells"),parentId:null,sprite:"e-icon e-ss-unmerge"}];this._sortFltrMenuData=[{id:"SortAtoZ",text:this.XLObj._getLocStr("SortAtoZ"),parentId:null,sprite:"e-icon e-ssdrop-sortatoz"},{id:"SortZtoA",text:this.XLObj._getLocStr("SortZtoA"),parentId:null,sprite:"e-icon e-ssdrop-sortztoa"},{id:"Filter",text:this.XLObj._getLocStr("Filter"),parentId:null,sprite:"e-icon e-ssdrop-filter"},{id:"ClearFilter",text:this.XLObj._getLocStr("ClearFilter"),parentId:null,sprite:"e-icon e-ssdrop-clearfilter"}];this._findMenuData=[{id:"Find",text:n._getLocStr("Find")+"...",parentId:null,sprite:"e-icon e-ss-find"},{id:"Replace",text:n._getLocStr("Replace")+"...",parentId:null,sprite:"e-icon e-ss-replace"},{id:"GoTo",text:n._getLocStr("GoTo")+"...",parentId:null,sprite:"e-icon e-ss-goto"},{id:"GoToSpecial",text:n._getLocStr("GoTo")+" "+n._getLocStr("Special")+"...",parentId:null},{id:"Formulas",text:n._getLocStr("Formulas"),parentId:null},{id:"Comments",text:n._getLocStr("Comments"),parentId:null},{id:"CFormat",text:n._getLocStr("ConditionalFormat"),parentId:null},{id:"Constants",text:n._getLocStr("Constants"),parentId:null},{id:"DataValidation",text:n._getLocStr("DataValidation"),parentId:null}];this._calcOptData=[{id:this.XLObj._id+"_CalcAuto",text:n._getLocStr("Automatic"),parentId:null,sprite:"e-icon e-ss-calcauto"},{id:this.XLObj._id+"_CalcManual",text:n._getLocStr("Manual"),parentId:null,sprite:"e-icon"},];this._valMenuData=[{id:"Validation",text:n._getLocStr("DataValidation")+"...",parentId:null,sprite:"e-icon e-ss-validation"},{id:"HighlightVal",text:n._getLocStr("HighlightVal"),parentId:null,sprite:"e-icon e-ss-hlval"},{id:"ClearHLVal",text:n._getLocStr("ClearFormats"),parentId:null,sprite:"e-icon e-ss-clearval"},{id:"ClearVal",text:n._getLocStr("ClearVal"),parentId:null,sprite:"e-icon e-ss-clearval"}];this._pageSizes=[{id:"A4",text:n._getLocStr("A4"),parentId:null,sprite:"e-icon e-ss-A4size"},{id:"A3",text:n._getLocStr("A3"),parentId:null,sprite:"e-icon e-ss-A3size"},{id:"Letter",text:n._getLocStr("Letter"),parentId:null,sprite:"e-icon e-ss-lettersize"}];this._viewMenuData=[{id:"freezePanes",text:n._getLocStr("freezePanes"),parentId:null,sprite:"e-icon e-ss-frzpane"},{id:"FreezeRow",text:n._getLocStr("FreezeRow"),parentId:null,sprite:"e-icon e-ss-frzrow"},{id:"FreezeColumn",text:n._getLocStr("FreezeColumn"),parentId:null,sprite:"e-icon e-ss-frzcln"}];this._insertMenuData=[{id:"InsertCells",text:n._getLocStr("inscells")+"...",parentId:null,sprite:"e-icon e-ssr-inscell"},{id:"InsertSheetRows",text:n._getLocStr("insrows"),parentId:null,sprite:"e-icon e-ssr-insrow"},{id:"InsertSheetColumns",text:n._getLocStr("inscols"),parentId:null,sprite:"e-icon e-ssr-inscol"},{id:"InsertSheet",text:n._getLocStr("inssheet"),parentId:null,sprite:"e-icon e-ssr-inssheet"}];this._resetPicture=[{id:"resetpicture",text:n._getLocStr("ResetPicture"),parentId:null,sprite:"e-icon e-ss-resetpicture"},{id:"resetsize",text:n._getLocStr("ResetSize"),parentId:null,sprite:"e-icon e-ss-resetpicture"}];var t=n._getLocStr("BorderStyles").split("/");this._borderMenuData=[{id:"bottom",text:n._getLocStr("BBottom"),parentId:null,sprite:"e-icon e-ss-bottom"},{id:"top",text:n._getLocStr("BTop"),parentId:null,sprite:"e-icon e-ss-top"},{id:"left",text:n._getLocStr("BLeft"),parentId:null,sprite:"e-icon e-ss-left"},{id:"right",text:n._getLocStr("BRight"),parentId:null,sprite:"e-icon e-ss-right"},{id:"noborder",text:n._getLocStr("NoBorder"),parentId:null,sprite:"e-icon e-ss-noborder"},{id:"allborder",text:n._getLocStr("AllBorder"),parentId:null,sprite:"e-icon e-ss-allborder"},{id:"outside",text:n._getLocStr("Outside"),parentId:null,sprite:"e-icon e-ss-outside"},{id:"thickbox",text:n._getLocStr("ThickBox"),parentId:null,sprite:"e-icon e-ss-thickbox"},{id:"thickbottom",text:n._getLocStr("ThickBottom"),parentId:null,sprite:"e-icon e-ss-thickbottom"},{id:"topandbottom",text:n._getLocStr("TopandBottom"),parentId:null,sprite:"e-icon e-ss-topandbottom"},{id:"topandthickbottom",text:n._getLocStr("TopandThickBottom"),parentId:null,sprite:"e-icon e-ss-topandthickbottom"},{id:"drawborder",text:n._getLocStr("DrawBorder"),parentId:null,sprite:"e-icon e-ss-drawborder"},{id:"drawbordergrid",text:n._getLocStr("DrawBorderGrid"),parentId:null,sprite:"e-icon e-ss-drawbordergrid"},{id:n._id+"_bordercolor",text:n._getLocStr("BorderColor"),parentId:null,sprite:"e-iconcolor"},{id:n._id+"_Ribbon_bordercolor",text:"",parentId:n._id+"_bordercolor"},{id:n._id+"_Ribbon_borderstyle",text:n._getLocStr("BorderStyle"),parentId:null},{id:"solid",text:t[0],parentId:n._id+"_Ribbon_borderstyle"},{id:"dashed",text:t[1],parentId:n._id+"_Ribbon_borderstyle"},{id:"dotted",text:t[2],parentId:n._id+"_Ribbon_borderstyle"},];this._cFormatMenuData=[{id:n._id+"_HLCellRules",text:"Highlight Cell Rules",parentId:null,sprite:"e-icon e-ss-hlcellrules"},{id:"greaterthan",text:n._getLocStr("GreaterThan")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-greaterthan"},{id:"lessthan",text:n._getLocStr("LessThan")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-lessthan"},{id:"between",text:n._getLocStr("Between")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-between"},{id:"equalto",text:n._getLocStr("EqualTo")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-equalto"},{id:"textcontains",text:n._getLocStr("TextthatContains")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-textcontains"},{id:"dateoccur",text:n._getLocStr("DateOccurring")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-dateoccur"},{id:n._id+"_ClearRules",text:n._getLocStr("ClearRules"),parentId:null,sprite:"e-icon e-ss-clearrules"},{id:"clearselected",text:n._getLocStr("ClearRulesfromSelected"),parentId:n._id+"_ClearRules"},{id:"clearall",text:n._getLocStr("ClearRulesfromEntireSheets"),parentId:n._id+"_ClearRules"},];this._textAlign=[{value:"1",text:"Left"},{value:"2",text:"Center"},{value:"3",text:"Right"}];this._verticalAlign=[{value:"1",text:"Top"},{value:"2",text:"Middle"},{value:"3",text:"Bottom"}];this._actions=[{value:"Greater",text:"greater than"},{value:"GreaterOrEqual",text:"greater or equal to"},{value:"Less",text:"less than"},{value:"LessOrEqual",text:"less than or equal to"},{value:"Equal",text:"equal to"},{value:"NotEqual",text:"not equal to"},{value:"Between",text:"between"},{value:"NotBetween",text:"not between"}];this._types=[{value:"number",text:"Number"},{value:"decimal",text:"Decimal"},{value:"date",text:"Date"},{value:"time",text:"Time"},{value:"text",text:"TextLength"},{value:"list",text:"List"}];this._cFormatData={greaterthan:["GTTitle","GTContent"],lessthan:["LTTitle","LTContent"],between:["BWTitle","BWContent"],equalto:["EQTitle","EQContent"],textcontains:["ContainsTitle","ContainsContent"],dateoccur:["DateTitle","DateContent"]};this._styles=[{value:"redft",text:"Light Red Fill with Dark Red Text"},{value:"yellowft",text:"Yellow Fill with Dark Yellow Text"},{value:"greenft",text:"Green Fill with Dark Green Text"},{value:"redf",text:"Red Fill"},{value:"redt",text:"Red Text"}];this._currentCFormat="";this._addrList=[];this._within=[{value:"sheet",text:n._getLocStr("Sheet")},{value:"workbook",text:n._getLocStr("Workbook")}];this._sType=[{value:"columns",text:n._getLocStr("Columns")},{value:"rows",text:n._getLocStr("Rows")}];this._vType=[{value:"value",text:n._getLocStr("Value")},{value:"formula",text:n._getLocStr("Formula")},{value:"comment",text:n._getLocStr("Comments")}];this._direction=[{value:"down",text:n._getLocStr("Down")},{value:"up",text:n._getLocStr("Up")}];this._gotoRBtnSet1=["Comments","Blanks","LastCell","Formulas","Constants"];this._gotoRBtnSet2=["RowDiff","ColDiff","CFormat","DataValidation"];this._gotoChkBox=["GotoNumbers","GotoText","GotoLogicals","GotoError"];this._othersSptBtnIds=["inssbtn","delsbtn","find","fPane","calcOpt"];this._contextualBtnIds=["resizetable","convertorange"];this._contextualInputIds=["tableid","tablename"];this._contextualCheckBoxIds=["tsofirstcolumn","tsolastcolumn","tsototalrow","tsofiltercolumn"];this._numberFormat=[{value:"1",text:"General"},{value:"2",text:"Number"},{value:"3",text:"Currency"},{value:"4",text:"Accounting"},{value:"5",text:"Percentage"},{value:"6",text:"Text"},{value:"7",text:"Shortdate"},{value:"8",text:"Longdate"},{value:"9",text:"Time"},{value:"10",text:"Scientific"},{value:"11",text:"Fraction"}];this._othersBtnIds=["insbtn","delbtn","namemanager","definename","calcNow","calcSht"];this._deleteMenuData=[{id:"DeleteCells",text:n._getLocStr("delcells")+"...",parentId:null,sprite:"e-icon e-ssr-delcell"},{id:"DeleteSheetRows",text:n._getLocStr("delrows"),parentId:null,sprite:"e-icon e-ssr-delrow"},{id:"DeleteSheetColumns",text:n._getLocStr("delcols"),parentId:null,sprite:"e-icon e-ssr-delcol"},{id:"DeleteSheet",text:n._getLocStr("delsheet"),parentId:null,sprite:"e-icon e-ssr-delsheet"}];this._clearMenuData=[{id:"Clear_All",text:n._getLocStr("ClearAll"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Clear_Formats",text:n._getLocStr("ClearFormats"),parentId:null,sprite:"e-icon e-ss-clearformat"},{id:"Clear_Contents",text:n._getLocStr("ClearContents"),parentId:null},{id:"Clear_Comments",text:n._getLocStr("ClearComments"),parentId:null},{id:"Clear_Hyperlinks",text:n._getLocStr("ClearHyperLinks"),parentId:null}];this._autosumMenuData=[{id:"Sum",text:n._getLocStr("Sum"),parentId:null,sprite:"e-icon e-ss-autosum"},{id:"Average",text:n._getLocStr("Average"),parentId:null},{id:"Count",text:n._getLocStr("CountNumber"),parentId:null},{id:"Max",text:n._getLocStr("Max"),parentId:null},{id:"Min",text:n._getLocStr("Min"),parentId:null}];this._cmntTglBtnIds=["showAllComments"];this._cmntBtnIds=["newComment","deleteComment","previousComment","nextComment","showHideComment"];this._reviewTabTglBtnIds=["ProtectSheet","protectWorkbook","LockCell"];this._chartThemes=[{value:"flatlight",text:"Flat Light"},{value:"flatdark",text:"Flat Dark"},{value:"azure",text:"Azure"},{value:"azuredark",text:"Azure Dark"},{value:"lime",text:"Lime"},{value:"limedark",text:"Lime Dark"},{value:"saffron",text:"Saffron"},{value:"saffrondark",text:"Saffron Dark"}];this._isCustomCellStyleReset=!1};t.spreadsheetFeatures.ribbon.prototype={_renderChartTypeDialog:function(){var u,s,f,e,o,h,c,l,a,v,i=this.XLObj,r=i._id+"_charttypedlg";u=t.buildTag("div#"+r+".e-chartdialog");s=t.buildTag("div#"+r+"_allcharttab.e-chtdlgtab");a=t.buildTag("div.e-dlg-fields e-dlgctndiv");h=t.buildTag("ul","","");l=t.buildTag("a",i._getLocStr("AllCharts"),{},{href:"#"+i._id+"_allchart"});c=t.buildTag("li",l);u.append(a.append(s.append(h.append(c))));o=t.buildTag("div#"+r+"_btndiv.e-dlg-btnfields");v=t.buildTag("div.e-dlg-btnctnr");f=t.buildTag("input#"+r+"_okbtn");e=t.buildTag("input#"+r+"_cantn");f.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._chartTypeOk,this),enabled:!0});e.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._chartTypeCancel,this),showRoundedCorner:!0,width:60});o.append(v.append(f,e));u.append(o);i.element.append(u);u.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("ChartType"),width:510,height:"auto",cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)});n("#"+r+"_allcharttab").ejTab({cssClass:"e-ss-dlgtab",width:480});this._renderAllChartTab()},_renderAllChartTab:function(){var r,e,b,o,s,h,v,y,c,l,i,p,k,w="",d="",g=this.XLObj,u=g._id,f=u+"_chartdlg_charttab",a=["Column-6","Bar-6","Radar-2","Line-2","Area-3","Pie-3","Scatter-1"];for(v=t.buildTag("div#"+f+"_right.e-chtdlgright"),y=t.buildTag("div#"+f+"_left.e-chtdlgleft"),c=t.buildTag("div#"+f+"_content.e-chtdlgcontent",{"border-bottom":0}),l=t.buildTag("ul#"+f+"_list"),o=0,s=a.length;o<s;o++)i=a[o].split("-")[0],d+="<li><span class='e-icon e-ss-dlg"+i.toLowerCase()+"chart'><\/span>"+i+"<\/li>";for(l.append(d),l.ejListBox({width:"240",selectIndexChanged:n.proxy(this._onChartChange,this),height:"300",allowMultiSelection:!1,selectedItemIndex:0}),y.append(l),c=t.buildTag("div#"+f+"_content.e-chtdlgcontent"),v.append(c),n("#"+u+"_allchart").append(y).append(v),e=0,s=a.length;e<s;e++){for(h=a[e].split("-"),k=g._getLocStr("Title"+h[0]+"Chart").split("/"),i=h[0].toLowerCase(),p=t.buildTag("div#"+u+"_"+i+"chart"),r=1,b=parseInt(h[1]);r<=b;r++)w+="<div class='e-chartimg e-dlg"+i+"chart"+r+"' title='"+k[r-1]+"'><\/div>";c.append(p.append(w));n("#"+u+"_"+i+"chart").find(".e-dlg"+i+"chart1").addClass("e-chartselect");p.hide();w=""}n("#"+u+"_columnchart").show()},_onChartChange:function(t){for(var r=this.XLObj,u=t.model.value.toLowerCase(),f=["column","bar","radar","line","area","pie","scatter"],i=0;i<f.length;i++)n("#"+r._id+"_"+f[i]+"chart").hide();n("#"+r._id+"_"+u+"chart").show();n("#"+r._id+"_allchart").find(".e-chartimg").removeClass("e-chartselect");n("#"+r._id+"_"+u+"chart").find(".e-dlg"+u+"chart1").addClass("e-chartselect")},_initValDialog:function(){var i,r,u,f,e,o,s,h,n=this.XLObj,c,l;i=t.buildTag("div#"+n._id+"_ValDialog");r=t.buildTag("div#"+n._id+"_ValDialog_valDlgTab");c=t.buildTag("div.e-dlg-fields e-dlgctndiv");o=t.buildTag("ul");h=t.buildTag("a","Settings",{},{href:"#"+n._id+"_Validation"});s=t.buildTag("li",h);o.append(s);r.append(o);r.ejTab({width:325,height:320,cssClass:"e-ss-dlgtab"});i.append(c.append(r));e=t.buildTag("div#"+n._id+"btnDiv.e-dlg-btnfields");l=t.buildTag("div.e-dlg-btnctnr");u=t.buildTag("input#"+n._id+"Dialog_OkBtn");f=t.buildTag("input#"+n._id+"Dialog_CancelBtn");u.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:"19%",click:t.proxy(this._valDlgBtnClick,this,"ok"),enabled:!0});f.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._valDlgBtnClick,this,"cancel"),showRoundedCorner:!0,width:"19%"});e.append(l.append(u,f));i.append(e);i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("DataValidation"),width:355,height:"auto",cssClass:"e-ss-dialog e-"+n._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_initCFDialog:function(){var n=this.XLObj,i,e,r,u,f,o;i=t.buildTag("div#"+n._id+"_CFDialog");n.element.append(i);e=t.buildTag("div#"+n._id+"_CondFormat.e-dlgctndiv");i.append(e);f=t.buildTag("div#"+n._id+"cfBtnDiv.e-dlg-btnfields");o=t.buildTag("div.e-dlg-btnctnr");r=t.buildTag("input#"+n._id+"cfDialog_OkBtn");u=t.buildTag("input#"+n._id+"cfDialog_CancelBtn");r.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._dlgCFOk,this),enabled:!0});u.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._dlgCFCancel,this),showRoundedCorner:!0,width:"25%"});f.append(o.append(r,u));i.append(f);i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("ConditionalFormat"),width:275,cssClass:"e-ss-dialog e-"+n._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_initHLDialog:function(){var i=this.XLObj,r,u,f,e,o,s,h,c,l;r=t.buildTag("div#"+i._id+"_HLDialog");u=t.buildTag("div#"+i._id+"_HLDialogTab");l=t.buildTag("div.e-dlg-fields e-dlgctndiv");f=t.buildTag("ul");o=t.buildTag("a",i._getLocStr("WebPage"),{},{href:"#"+i._id+"_Web"});e=t.buildTag("li",o);f.append(e);o=t.buildTag("a",i._getLocStr("WorkSheet"),{},{href:"#"+i._id+"_Doc"});e=t.buildTag("li",o);f.append(e);u.append(f);u.ejTab({width:350,itemActive:t.proxy(this._hlTabChange,this),cssClass:"e-ss-dlgtab"});r.append(l.append(u));s=t.buildTag("div#"+i._id+"hlBtnDiv.e-dlg-btnfields");$btnctnr=t.buildTag("div.e-dlg-btnctnr");h=t.buildTag("input#"+i._id+"hlDialog_OkBtn");c=t.buildTag("input#"+i._id+"hlDialog_CancelBtn");h.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgHLOk,this),enabled:!0});c.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._dlgHLCancel,this),showRoundedCorner:!0,width:60});s.append($btnctnr.append(h,c));r.append(s);r.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("InsertHyperLink"),width:380,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_Ribbon_webAddress"),r=n("#"+i._id+"_Ribbon_cellAddress");t.focus().setInputPos(t.val().length);r.focus().setInputPos(r.val().length)})})},_initFRDialog:function(){var i=this.XLObj,e,o,s,h,c,l,y,f,r,p,u,a,v;e=t.buildTag("div#"+i._id+"_FRDialog");o=t.buildTag("div#"+i._id+"_FRDialog_FPDlgTab");p=t.buildTag("div.e-dlg-fields e-dlgctndiv");f=t.buildTag("ul");u=t.buildTag("a",i._getLocStr("Find"),{},{href:"#"+i._id+"_Find"});r=t.buildTag("li",u);f.append(r);u=t.buildTag("a",i._getLocStr("Replace"),{},{href:"#"+i._id+"_Replace"});r=t.buildTag("li",u);f.append(r);u=t.buildTag("a",i._getLocStr("Settings"),{},{href:"#"+i._id+"_Settings"});r=t.buildTag("li",u);f.append(r);o.append(f);o.ejTab({width:390,height:110,itemActive:t.proxy(this._findTabChange,this),cssClass:"e-ss-dlgtab"});e.append(p.append(o));l=t.buildTag("div#"+i._id+"btnFRDiv.e-dlg-btnfields");y=t.buildTag("div.e-dlg-btnctnr");a=t.buildTag("input#"+i._id+"FR_ReplaceBtn","",{"margin-left":0});v=t.buildTag("input#"+i._id+"FR_ReplaceAllBtn");s=t.buildTag("input#"+i._id+"FR_NextBtn");h=t.buildTag("input#"+i._id+"FR_PrevBtn");c=t.buildTag("input#"+i._id+"FR_CloseBtn");a.ejButton({text:i._getLocStr("Replace"),showRoundedCorner:!0,width:55,height:17,click:t.proxy(this._btnFROnClick,this,"FR_ReplaceBtn"),enabled:!0}).css("display","none");v.ejButton({text:i._getLocStr("ReplaceAll"),showRoundedCorner:!0,width:70,height:17,click:t.proxy(this._btnFROnClick,this,"FR_ReplaceAllBtn"),enabled:!0}).css("display","none");s.ejButton({text:i._getLocStr("FindNext"),showRoundedCorner:!0,width:69,height:17,click:t.proxy(this._btnFROnClick,this,"FR_NextBtn"),enabled:!0});h.ejButton({text:i._getLocStr("FindPrev"),showRoundedCorner:!0,width:69,height:17,click:t.proxy(this._btnFROnClick,this,"FR_PrevBtn"),enabled:!0});c.ejButton({text:i._getLocStr("Close"),click:t.proxy(this._btnFROnClick,this,"FR_CloseBtn"),showRoundedCorner:!0,width:47,height:17});l.append(y.append(a,v,s,h,c));e.append(l);e.ejDialog({showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("FindnReplace"),width:420,height:"auto",cssClass:"e-ss-dialog e-ss-frdlg e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_Ribbon_textFind");t.focus().setInputPos(t.val().length)})})},_initGoToDialog:function(){var i=this.XLObj,r,u,c,f,e,o,s,h,l;r=t.buildTag("div#"+i._id+"_GoDialog");u=t.buildTag("div#"+i._id+"_GoToDlgTab");l=t.buildTag("div.e-dlg-fields e-dlgctndiv");f=t.buildTag("ul");o=t.buildTag("a",i._getLocStr("GoTo"),{},{href:"#"+i._id+"_GoTo"});e=t.buildTag("li",o);f.append(e);o=t.buildTag("a",i._getLocStr("GoTo")+" "+i._getLocStr("Special"),{},{href:"#"+i._id+"_GoToSp"});e=t.buildTag("li",o);f.append(e);u.append(f);u.ejTab({width:288,height:340,itemActive:t.proxy(this._gotoTabChange,this),cssClass:"e-ss-dlgtab"});r.append(l.append(u));c=t.buildTag("div#"+i._id+"btnDiv.e-dlg-btnfields");$btnctnr=t.buildTag("div.e-dlg-btnctnr");r.append(c.append($btnctnr));s=t.buildTag("input#"+i._id+"Dialog_GoOkBtn");h=t.buildTag("input#"+i._id+"Dialog_GoCancelBtn");s.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:"21.5%",click:t.proxy(this._gotoBtnClick,this,"ok")});h.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._gotoBtnClick,this,"cancel"),showRoundedCorner:!0,width:"21.5%"});$btnctnr.append(s,h);i.element.append(r);r.ejDialog({showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("GoTo"),width:318,height:"auto",cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_textRef");t.focus().setInputPos(t.val().length)})})},_dialogClose:function(){this.XLObj.setSheetFocus()},_beforeDlgClose:function(t){var i=n("#"+this.XLObj._id+"_nmgrid_dialogEdit_overLay");i.length&&(t.cancel=!0)},_setButtonHeights:function(){this._smallBtnHeight=25;this._mediumBtnHeight=35;this._bigBtnHeight=75;this._splitBtnHeight=75;this._drpDownHeight=25},_homeTabObj:function(){var n,f=this.XLObj,u="imagetop",r={id:"home",text:"HOME",groups:[]},i=f._id,e=f.model;n={text:"Clipboard",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("pastebtn","paste","textandimage","e-icon e-ssr-paste",45,this._mediumBtnHeight,"PasteTitle","PasteContent",!1,u),this._generateSplitBtn("pastesbtn","Paste","textandimage",i+"_Ribbon_Paste",{dataSource:this._pasteMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,45,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-pastesbtn","PasteTitle","PasteSplitContent")]},{groups:[this._generateBtn("cut","Cut","textandimage","e-icon e-ssr-cut",58,this._smallBtnHeight,"CutTitle","CutContent"),this._generateBtn("copy","Copy","textandimage","e-icon e-ssr-copy",67,this._smallBtnHeight,"CopyTitle","CopyContent"),this._generateToggleBtn("formatpainter","FormatPainter","textandimage","e-icon e-ss-formatpainter","FPTitle",110,this._smallBtnHeight,"FPContent")]}]};r.groups.push(n);n={text:"Font",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateDD("font-family","FontFamily",this._fontFamily,"7",150,this._smallBtnHeight,"FontFamily","FFContent"),this._generateDD("fontsize","FontSize",this._fontSize,"11pt",65,this._smallBtnHeight,"FontSize","FSContent"),this._generateBtn("increasefontsize","IncreaseFontSize","imageonly","e-icon e-ss-increasefontsize","",this._smallBtnHeight,"IncreaseFontSize","IFSContent"),this._generateBtn("decreasefontsize","DecreaseFontSize","imageonly","e-icon e-ss-decreasefontsize","",this._smallBtnHeight,"DecreaseFontSize","DFSContent")]},{groups:[this._generateToggleBtn("bold","Bold","imageonly","e-icon e-ss-bold","BoldTitle","",this._smallBtnHeight,"BoldContent"),this._generateToggleBtn("italic","Italic","imageonly","e-icon e-ss-italic","ItalicTitle","",this._smallBtnHeight,"ItalicContent"),this._generateToggleBtn("underline","Underline","imageonly","e-icon e-ss-underline","ULineTitle","",this._smallBtnHeight,"ULineContent"),this._generateToggleBtn("line-through","Linethrough","imageonly","e-icon e-ss-linethrough","LineTrTitle",25,this._smallBtnHeight,"LineTrContent",!0),this._generateSplitBtn("border","Border","imageonly",i+"_Ribbon_Border",{dataSource:this._borderMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-bottom",!0,37,this._smallBtnHeight,"","","","e-borderbtn","Border","BorderContent"),this._generateCustomControl(i+"_Ribbon_background-color","BackgroundColor","BackgroundColor","BGContent"),this._generateCustomControl(i+"_Ribbon_color","Color","Color","ColorContent")]}]};r.groups.push(n);n={text:"Alignment",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateToggleBtn("top","TopAlign","imageonly","e-icon e-ss-topalign","TopAlign","","","TopAlignContent"),this._generateToggleBtn("middle","MiddleAlign","imageonly","e-icon e-ss-middlealign","MiddleAlign","","","MiddleAlignContent"),this._generateToggleBtn("bottom","BottomAlign","imageonly","e-icon e-ss-bottomalign","BottomAlign","","","BottomAlignContent",!0),this._generateToggleBtn("wraptext","WrapText","textandimage","e-icon e-ss-wraptext","WrapText",85,25,"WrapTextContent")]},{groups:[this._generateToggleBtn("left","AlignLeft","imageonly","e-icon e-ss-alignleft","AlignLeft","","","AlignLeftContent"),this._generateToggleBtn("center","AlignCenter","imageonly","e-icon e-ss-aligncenter","AlignCenter","","","AlignCenterContent"),this._generateToggleBtn("right","AlignRight","imageonly","e-icon e-ss-alignright","AlignRight","","","AlignRightContent",!0),this._generateSplitBtn("merge","MergeAndCenter","textandimage",i+"_Ribbon_Merge",{dataSource:this._mergeMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-merge",!1,136,25,"right","","","e-spreadsheet e-mergebtn","MergeAndCenter","MergeAndCenterContent")]}]};r.groups.push(n);n={text:"Actions",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("undo","Undo","textandimage","e-ss-undo",40,this._bigBtnHeight,"UndoTitle","UndoContent",!1,u,""),this._generateBtn("redo","Redo","textandimage","e-ss-redo",40,this._bigBtnHeight,"RedoTitle","RedoContent",!1,u,"")]}]};r.groups.push(n);n={text:"Number",alignType:t.Ribbon.alignType.rows,enableGroupExpander:!0,content:[{groups:[this._generateDD("cellformat","NumberFormat",this._numberFormat,"1",125,this._smallBtnHeight,"NumberFormat","NumberFormatContent")]},{groups:[this._generateBtn("accounting","AccountingStyle","imageonly","e-icon e-ss-accounting","",this._smallBtnHeight,"AccountingStyle","AccountingStyleContent"),this._generateBtn("percentage","PercentageStyle","imageonly","e-icon e-ss-percentage","",this._smallBtnHeight,"PercentageStyle","PercentageStyleContent"),this._generateBtn("usegrouping","CommaStyle","imageonly","e-icon e-ss-comma","",this._smallBtnHeight,"CommaStyle","CommaStyleContent",!0),this._generateBtn("increment","IncreaseDecimal","imageonly","e-icon e-ss-increasedecimal","",this._smallBtnHeight,"IncreaseDecimal","IncreaseDecimalContent"),this._generateBtn("decrement","DecreaseDecimal","imageonly","e-icon e-ss-decreasedecimal","",this._smallBtnHeight,"DecreaseDecimal","DecreaseDecimalContent")]}]};r.groups.push(n);n={text:"Styles",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("cFormat","ConditionalFormat","textandimage",i+"_CFormat",{dataSource:this._cFormatMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-condformat",!1,75,this._splitBtnHeight,"bottom",u,"dropdown","e-spreadsheet e-cformatbtn","ConditionalFormat","CFContent"),this._generateSplitBtn("formatastable","FormatasTable","textandimage",i+"_formatastable","","e-icon e-ssr-formatastable",!1,65,this._splitBtnHeight,"bottom",t.ImagePosition.ImageTop,"dropdown","e-spreadsheet e-formatastablebtn","FormatAsTable","FATContent"),this._generateSplitBtn("cellstyles","CellStyles","textandimage",i+"_cellstyles","","e-icon e-ssr-cellstyles",!1,55,this._splitBtnHeight,"bottom",t.ImagePosition.ImageTop,"dropdown","e-spreadsheet e-cellstylebtn","CellStyles","CellStylesContent")]}]};r.groups.push(n);n={text:"Editing",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("sortfilter","SortFilter","textandimage",i+"_Ribbon_SortFilter",{dataSource:this._sortFltrMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-sortfilter",!1,50,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-sortfltrbtn","SortFilter","SortFilterContent")]},{groups:[this._generateSplitBtn("autosum","AutoSum","textandimage",i+"_Ribbon_AutoSum",{dataSource:this._autosumMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-autosum",!1,100,25,"right","","","e-spreadsheet e-autosumbtn","AutoSumTitle","AutoSumContent"),this._generateSplitBtn("clear","Clear","textandimage",i+"_Ribbon_Clear",{dataSource:this._clearMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-clear",!1,80,25,"right","","dropdown","e-spreadsheet e-clearbtn","Clear","ClearContent")]}]};r.groups.push(n);this._tabCollection.push(r)},_insertTabObj:function(){var n,f=this.XLObj,u="imagetop",r={id:"insert",text:"INSERT",groups:[]},i=f._id;n={text:"Tables",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("pivotTable","PivotTable","textandimage","e-icon e-ssr-pivottable",65,this._bigBtnHeight,"PivotTable","PivotTableContent",!1,u),this._generateBtn("table","Table","textandimage","e-icon e-ssr-table",50,this._bigBtnHeight,"Table","TableContent",!1,u)]}]};r.groups.push(n);n={text:"Illustrations",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("pictures","Pictures","textandimage","e-icon e-ssr-pictures",50,this._bigBtnHeight,"PicturesTitle","PicturesContent",!1,u,"")]}]};r.groups.push(n);n={text:"Links",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("hyperlink","HyperLink","textandimage","e-icon e-ssr-hyperlink",60,this._bigBtnHeight,"HyperLinkTitle","HyperLinkContent",!1,u,"")]}]};r.groups.push(n);n={text:"Charts",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("columnchart","ColumnChart","imageonly",i+"_Ribbon_ColumnChart","","e-icon e-ss-colchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","ColumnChartTitle","ColumnChartContent"),this._generateSplitBtn("barchart","BarChart","imageonly",i+"_Ribbon_BarChart","","e-icon e-ss-barchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","BarChartTitle","BarChartContent"),this._generateSplitBtn("stockchart","StockChart","imageonly",i+"_Ribbon_StockChart","","e-icon e-ss-stockchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","StockChartTitle","StockChartContent")]},{groups:[this._generateSplitBtn("linechart","LineChart","imageonly",i+"_Ribbon_LineChart","","e-icon e-ss-linechart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","LineChartTitle","LineChartContent"),this._generateSplitBtn("areachart","AreaChart","imageonly",i+"_Ribbon_AreaChart","","e-icon e-ss-areachart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","AreaChartTitle","AreaChartContent"),this._generateSplitBtn("piechart","PieChart","imageonly",i+"_Ribbon_PieChart","","e-icon e-ss-piechart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","PieChartTitle","PieChartContent")]},{groups:[this._generateSplitBtn("scatterchart","ScatterChart","imageonly",i+"_Ribbon_ScatterChart","","e-icon e-ss-scterchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","ScatterChartTitle","ScatterChartContent")]}]};r.groups.push(n);this._tabCollection.push(r)},_dataTabObj:function(){var n,r=this.XLObj,i={id:"data",text:"DATA",groups:[]};n={text:"Sort & Filter",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("sortAtoZ","SortAtoZ","textandimage","e-icon e-ssr-sortatoz",90,this._smallBtnHeight,"SortAtoZ","SortAtoZContent",!1,"","e-datapadding"),this._generateBtn("sortZtoA","SortZtoA","textandimage","e-icon e-ssr-sortztoa",90,this._smallBtnHeight,"SortZtoA","SortZtoAContent",!1,"","e-datapadding")]},{groups:[this._generateBtn("filter","Filter","textandimage","e-icon e-ssr-filter",60,this._smallBtnHeight,"Filter","FilterContent",!1,"","e-datapadding"),this._generateBtn("clearfilter","ClearFilter","textandimage","e-icon e-ss-clearfilter",90,this._smallBtnHeight,"ClearFilter","ClearFilterContent",!1,"","e-datapadding")]}]};i.groups.push(n);n={text:"Data Tools",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("validationbtn","Validation","imageonly","e-icon e-ssr-validation",70,39,"DataValidation","DVContent",!1,"imagetop"),this._generateSplitBtn("validationsbtn","DataValidation","textandimage",r._id+"_Ribbon_Validation",{dataSource:this._valMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,70,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-validationsbtn","DataValidation","DVContent")]}]};i.groups.push(n);this._tabCollection.push(i)},_pageTabObj:function(){var n,u=this.XLObj,r="imagetop",i={id:"pagelayout",text:"PAGE LAYOUT",groups:[]};n={text:"Show",alignType:t.Ribbon.alignType.rows,width:105,content:[{groups:[{contentID:u._id+"_Ribbon_pagesetupleft",type:t.Ribbon.type.custom,height:80},]}]};i.groups.push(n);n={text:"Page Layout",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("sizebtn","size","imageonly","e-icon e-ssr-pagesize",65,44,"size","PageSizeContent",!1,r,""),this._generateSplitBtn("sizesbtn","PageSize","textandimage",u._id+"_Ribbon_PageSize",{dataSource:this._pageSizes,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,65,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-pagesizesbtn","PageSize","PageSizeContent")]}]};i.groups.push(n);n={text:"Print",alignType:t.Ribbon.alignType.columns,width:120,content:[{groups:[this._generateBtn("print","Print","textandimage","e-icon e-ssr-print",50,this._bigBtnHeight,"Print","PrintContent",!1,r,"")]},{groups:[this._generateBtn("printselected","PrintSelected","textandimage","e-icon e-ssr-printselected",55,this._bigBtnHeight,"PrintSelected","PrintSelectedContent",!0,r,"")]}]};i.groups.push(n);this._tabCollection.push(i)},_reviewTabObj:function(){var n,u=this.XLObj,i="imagetop",r={id:"review",text:"REVIEW",groups:[]};n={text:"Comments",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("newComment","New","textandimage","e-icon e-ssr-newcmnt",49,this._bigBtnHeight,"NewCommentTitle","NewCommentContent",!1,i)]},{groups:[this._generateBtn("deleteComment","Delete","textandimage","e-icon e-ssr-deletecmnt",49,this._bigBtnHeight,"DeleteComment","DeleteCommentContent",!1,i)]},{groups:[this._generateBtn("previousComment","Previous","textandimage","e-icon e-ssr-previouscmnt",49,this._bigBtnHeight,"Previous","PreviousContent",!1,i)]},{groups:[this._generateBtn("nextComment","Next","textandimage","e-icon e-ssr-nextcmnt",49,this._bigBtnHeight,"Next","NextContent",!1,i)]},{groups:[this._generateBtn("showHideComment","ShowHide","textandimage","e-icon e-ssr-showhidecmnt",160,this._smallBtnHeight,"ShowHide","ShowHideContent",!1,"imageLeft","e-ssr-cmntcolbtn"),this._generateToggleBtn("showAllComments","ShowAll","textandimage","e-icon e-ssr-showallcmnt","ShowAll",155,this._smallBtnHeight,"ShowAllContent",!1,"e-ssr-cmntcolbtn")]}]};r.groups.push(n);n={text:"Changes",alignType:t.Ribbon.alignType.row,content:[{groups:[this._generateToggleBtn("ProtectSheet","Protectsheet","textandimage","e-icon e-ssr-protectsheet","Protectsheet",60,this._bigBtnHeight,"protectsheettooltip",!1,"e-ssr-protectsheetbtn","imagetop","Unprotect"),this._generateToggleBtn("protectWorkbook","ProtectWorkbook","textandimage","e-icon e-ssr-protect","ProtectWorkbook",60,this._bigBtnHeight,"ProtectWBContent",!1,"e-ssr-cmntcolbtn","imagetop"),this._generateToggleBtn("LockCell","Lock","textandimage","e-icon e-ssr-protlockcell","lock",90,this._smallBtnHeight,"Lock",!1,"e-ssr-lockbtn","","Unlock","e-icon e-ssr-protunlockcell"),]},]};r.groups.push(n);this._tabCollection.push(r)},_otherTabObj:function(){var n,r=this.XLObj,u="imagetop",i={id:"others",text:"OTHERS",groups:[]},f=r._id,e=t.ContentType;n={text:"Window",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("fPane","FreezePanes","textandimage",r._id+"_Ribbon_FPane",{dataSource:this._viewMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-frzpane",!1,55,this._splitBtnHeight,"bottom",u,"dropdown","e-spreadsheet e-fpanebtn","FreezePanes","FreezePanesContent")]}]};i.groups.push(n);n={text:r._getLocStr("Formula"),alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("namemanager","NameManager",e.TextAndImage,"e-icon e-ssr-namemngr",55,this._bigBtnHeight,"NameManager","NameManagerContent",!1,u,"")]},{groups:[this._generateBtn("definename","DefineName",e.TextAndImage,"e-icon e-ssr-definename",110,25,"DefineName","DefineNameContent"),this._generateSplitBtn("useinformula","UseInFormula","textandimage",r._id+"_nmuseinformula","","e-icon e-ssr-useformula",!1,125,25,t.ArrowPosition.Bottom,t.ImagePosition.ImageLeft,"dropdown","e-spreadsheet e-useinformulabtn","UseInFormula","UseInFormulaContent")]}]};i.groups.push(n);n={text:"Cells",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("insbtn","Insert","imageonly","e-icon e-ssr-insert",54,40,"InsertTitle","InsertContent",!1,u),this._generateSplitBtn("inssbtn","Insert","textandimage",f+"_Ribbon_Ins",{dataSource:this._insertMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,54,this._mediumBtnHeight,"bottom","","dropdown","e-insertsbtn","InsertTitle","InsertSBContent")]},{groups:[this._generateBtn("delbtn","Delete","imageonly","e-icon e-ssr-delete",54,40,"DeleteTitle","DeleteContent",!1,u),this._generateSplitBtn("delsbtn","Delete","textandimage",f+"_Ribbon_Del",{dataSource:this._deleteMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,54,this._mediumBtnHeight,"bottom","","dropdown","e-deletesbtn","DeleteTitle","DeleteContent")]}]};i.groups.push(n);n={text:"Editing",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("find","FindSelect","textandimage",f+"_Ribbon_FindRep",{dataSource:this._findMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-findselect",!1,55,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-findbtn","FindSelectTitle","FindSelectContent")]}]};i.groups.push(n);n={text:"Calculation",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("calcOpt","CalculationOptions","textandimage",f+"_Ribbon_CalcOpt",{dataSource:this._calcOptData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-calcopt",!1,67,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-coptbtn","CalcOptTitle","CalcOptContent")]},{groups:[this._generateBtn("calcNow","CalculateNow",e.TextAndImage,"e-icon e-ss-calcnow",110,30,"CalculateNow","CalculateNowContent"),this._generateBtn("calcSht","CalculateSheet",e.TextAndImage,"e-icon e-ss-calcsheet",110,30,"CalculateSheet","CalculateSheetContent")]}]};i.groups.push(n);this._tabCollection.push(i)},_renderRibbon:function(){var e,o,s,h,b,c,l,a,k,y,p,w,d,g,nt,tt,u=this.XLObj,i=u._id,r=u.element,f=u.model,v=t.buildTag("div","","",{id:i+"_Ribbon"});r.append(v);this._renderChartTypeDialog();f.allowCellFormatting&&(r.append(t.buildTag("input","","",{id:i+"_Ribbon_background-color",type:"text"})),v.append(t.buildTag("input","","",{id:i+"_Ribbon_BorderColor",type:"text"})));r.append(this._borderPicture());f.allowCharts&&r.append(this._chartElementTag());f.allowFormatAsTable&&r.append(this._renderFormatAsTable());r.append(this._renderCellStyles());r.append(t.buildTag("ul","","",{id:i+"_Ribbon_FPane"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Merge"}));k="<input id="+i+'_chart type="text" style="display:none;"/><input id='+i+'_tableid type="text" style="display:none;"/>';v.append(k);this._renderNameManagerDlg(v);f.allowCharts&&(y=t.buildTag("div.e-ss-numeric","",{width:"180",height:"80"},{id:i+"_Ribbon_chartsize"}),e=t.buildTag("table"),o=t.buildTag("tr"),c=t.buildTag("tr"),s=t.buildTag("td","",{width:"100%"}),h=t.buildTag("td"),l=t.buildTag("td"),a=t.buildTag("td"),s.append(t.buildTag("label.e-icon e-ssr-chartheight","",{width:"25",height:"25",display:"visible"},{id:i+"_Ribbon_chartheightlbl"})),h.append(t.buildTag("input","",{type:"text"},{id:i+"_Ribbon_chartheight"})),o.append(s).append(h),l.append(t.buildTag("label.e-icon e-ssr-chartwidth","",{width:"25",height:"25",display:"visible"},{id:i+"_Ribbon_chartwidthlbl"})),a.append(t.buildTag("input","",{type:"text"},{id:i+"_Ribbon_chartwidth"})),c.append(l).append(a),e.append(o).append(c),y.append(e),r.append(y));p=t.buildTag("div","",{width:"140",height:"80",display:"none"},{id:i+"_Ribbon_pagesetup"});w=t.buildTag("div","",{width:"70",height:"80",float:"left"},{id:i+"_Ribbon_pagesetupleft"});e=t.buildTag("table");o=t.buildTag("tr");c=t.buildTag("tr");s=t.buildTag("td","",{padding:"6px 0px 6px 6px"});h=t.buildTag("td","",{padding:"6px 0px 6px 6px"});l=t.buildTag("td","",{padding:"6px 0px 6px 6px"});a=t.buildTag("td","",{padding:"6px 0px 6px 6px"});d=t.buildTag("label.e-viewlinlbl","",{width:"40"},{id:i+"_Ribbon_pagesetup_viewgrdlnlbl","for":i+"_Ribbon_Vgridlines"});g=t.buildTag("label.e-viewhdrlbl","",{width:"40",display:"visible"},{id:i+"_Ribbon_pagesetup_viewhdrlbl","for":i+"_Ribbon_Vheading"});nt=t.buildTag("input","","",{id:i+"_Ribbon_Vheading"});tt=t.buildTag("input","","",{id:i+"_Ribbon_Vgridlines"});s.append(tt);h.append(d);o.append(s).append(h);l.append(nt);a.append(g);c.append(l).append(a);e.append(c).append(o);w.append(e);p.append(w);v.append(p);n("#"+i+"_Ribbon_pagesetup_viewhdrlbl").text(u._getLocStr("Heading"));n("#"+i+"_Ribbon_pagesetup_viewgrdlnlbl").text(u._getLocStr("Gridlines"));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_PageSize"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Paste"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_FindRep"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_CalcOpt"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Validation"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Border"}));r.append(t.buildTag("ul.e-spreadsheet","","",{id:i+"_CFormat"}));f.allowCellFormatting&&r.append(t.buildTag("input","","",{id:i+"_Ribbon_color",type:"text"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Clear"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_SortFilter"}));r.append(t.buildTag("ul","",{width:"auto"},{id:i+"_Ribbon_Ins"}));r.append(t.buildTag("ul","",{width:"auto"},{id:i+"_Ribbon_Del"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_ResetPic"}));r.append(this._chartType("ColumnChart",6,2,2,["column","stackingcolumn","stackingcolumn100","column","stackingcolumn","stackingcolumn100"],["ClusteredColumn","StackedColumn","Stacked100Column","Cluster3DColumn","Stacked3DColumn","Stacked100Column3D"]));r.append(this._chartType("BarChart",6,2,2,["bar","stackingbar","stackingbar100","bar","stackingbar","stackingbar100"],["ClusteredBar","StackedBar","Stacked100Bar","Cluster3DBar","Stacked3DBar","Stacked100Bar3D"]));r.append(this._chartType("StockChart",2,2,2,["radar","radar"],["Radar","RadarMarkers"]));r.append(this._chartType("LineChart",2,2,3,["line","line"],["Line","LineMarkers"]));r.append(this._chartType("AreaChart",3,3,3,["Area","stackingarea","stackingarea100"],["Area","StackedArea","Stacked100Area"]));r.append(this._chartType("PieChart",3,3,4,["pie","pie","doughnut"],["Pie","Pie3D","Doughnut"]));r.append(this._chartType("ScatterChart",1,2,2,["scatter"],["Scatter"]));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_AutoSum"}));this._renderAppTab();f.allowFormatAsTable&&this._renderDesignTab();this._renderFormatTab();this._homeTabObj();this._insertTabObj();this._dataTabObj();this._pageTabObj();this._reviewTabObj();this._otherTabObj();this._contextualTabObj();v.ejRibbon({width:"100%",allowResizing:!0,applicationTab:this._appTabCollection,tabs:this._tabCollection,contextualTabs:this._contextualTabCollection,tabClick:n.proxy(this._onTabClick,this),tabSelect:n.proxy(this._onTabSelect,this),create:n.proxy(this._onControlCreated,this),toggleButtonClick:n.proxy(this._onToggleButtonClick,this),collapse:n.proxy(this._onCollapse,this),backstageItemClick:n.proxy(this._onBackStageItemClick,this),groupExpand:n.proxy(this._onGroupExpander,this)});n("#"+i+"_bordercolor ul li").find("a").remove();n("#"+i+"_bordercolor ul li").append(n("#"+i+"_Ribbon_BorderColor_popup"));n("#"+i+"picturecolor ul li").find("a").remove();n("#"+i+"picturecolor ul li").append(n("#"+i+"_Ribbon_PictureColor_popup"));n("#"+i+"_Ribbon_review_Comments_5").css("vertical-align","middle");f.scrollSettings.isResponsive&&n("#"+i+"_Ribbon").ejRibbon("option",{allowResizing:!0});this._hideTabs();f.allowComments||u._setAllowComments(!1);b=t.SplitButton.prototype._documentClick;t.SplitButton.prototype._documentClick=function(t){n(t.target).is(".e-formatastable")||b.call(this,t)};u.model.allowFormatAsTable&&(n("#"+u._id+"_formatastable").data("ejMenu").model.open=function(){n("#"+u._id+"_formatastable").scrollTop(0)});this._updateRibCustomCss();this._hideOtherControls()},_updateRibCustomCss:function(){var u=this.XLObj,r=u._id,i=u.element;i.find("#"+r+"_Ribbon_background-colorWrapper .e-in-wrap, #"+r+"_Ribbon_colorWrapper .e-in-wrap").addClass("e-ssr-colpickHprt");i.find(".e-ssr-colpickHprt .e-color-container,.e-ssr-colpickHprt .e-select").addClass("e-ssr-colorcontainer");i.find(".e-mergebtn, .e-borderbtn, .e-autosumbtn").parent().addClass("e-ssr-horizontalprt");i.find("#"+r+"_Ribbon_font-family").parents(".e-controlpadding").addClass("e-ssr-fontfamily");i.find("#"+r+"_Ribbon_fontsize").parents(".e-controlpadding").addClass("e-ssr-fontsize");i.find("#"+r+"_Ribbon_insbtn").parent().parent().prepend(t.buildTag("span.e-ssr-verticalHparent e-ssr-insertbtnHprt","",{display:"inherit"}));i.find("#"+r+"_Ribbon_insbtn").parent().appendTo(n("span.e-ssr-verticalHparent.e-ssr-insertbtnHprt"));i.find("#"+r+"_Ribbon_inssbtn").closest("div").appendTo(n("span.e-ssr-verticalHparent.e-ssr-insertbtnHprt"));i.find("#"+r+"_Ribbon_delbtn").parent().parent().prepend(t.buildTag("span.e-ssr-verticalHparent e-ssr-deletebtnHprt","",{display:"inherit"}));i.find("#"+r+"_Ribbon_delbtn").parent().appendTo(n("span.e-ssr-verticalHparent.e-ssr-deletebtnHprt"));i.find("#"+r+"_Ribbon_delsbtn").closest("div").appendTo(n("span.e-ssr-verticalHparent.e-ssr-deletebtnHprt"));i.find("#"+r+"_Ribbon_sizebtn").parent().parent().prepend(t.buildTag("span.e-ssr-verticalHparent e-ssr-sizebtnHprt","",{display:"inherit"}));i.find("#"+r+"_Ribbon_sizebtn").parent().appendTo(n("span.e-ssr-verticalHparent.e-ssr-sizebtnHprt"));i.find("#"+r+"_Ribbon_sizesbtn").closest("div").appendTo(n("span.e-ssr-verticalHparent.e-ssr-sizebtnHprt"));i.find("#"+r+"_Ribbon_validationbtn").parent().parent().prepend(t.buildTag("span.e-ssr-verticalHparent e-ssr-dtvaldtnHprt","",{display:"inherit"}));i.find("#"+r+"_Ribbon_validationbtn").parent().appendTo(n("span.e-ssr-verticalHparent.e-ssr-dtvaldtnHprt"));i.find("#"+r+"_Ribbon_validationsbtn").closest("div").appendTo(n("span.e-ssr-verticalHparent.e-ssr-dtvaldtnHprt"));i.find("#"+r+"_Ribbon_pastebtn").parent().parent().prepend(t.buildTag("span.e-ssr-verticalHparent e-ssr-pastebtnHprt","",{display:"inherit"}));i.find("#"+r+"_Ribbon_pastebtn").parent().appendTo(n("span.e-ssr-verticalHparent.e-ssr-pastebtnHprt"));i.find("#"+r+"_Ribbon_pastesbtn").closest("div").appendTo(n("span.e-ssr-verticalHparent.e-ssr-pastebtnHprt"));i.find("#ej"+r+"_Ribbon_Vheading").addClass("e-vheading");i.find("#ej"+r+"_Ribbon_Vgridlines").addClass("e-vgridlines")},_hideOtherControls:function(){for(var t=0,i=["CElement","Paste","Border","Merge","SortFilter","Clear","ColumnChart","BarChart","Validation","PageSize","FPane","Ins","Del","FindRep","PastePic","PictureBorder","AutoSum","ResetPic","PictureBorder","StockChart","LineChart","AreaChart","PieChart","ScatterChart","color_Presets","PictureColor_Presets","BorderColor_Presets","background-color_Presets"],r=i.length;t--;)n("#"+this._id+"_Ribbon_"+i[t]).hide();for(t=0,i=["CFormat","formatastable","cellstyles","ctxtmenu"],r=i.length;t--;)n("#"+this._id+"_"+i[t]).hide()},_renderAppTab:function(){var i,n=this.XLObj,r=[];i="<div id='"+n._id+"_backstagetabnew' class='e-ssr-bstabnew'><div class='e-ssr-bscontent' title='"+n._getLocStr("BlankWorkbook")+"'><div class='e-ssr-bsnewtmpl' ><button id='"+n._id+"_bstab_new_blank' ><\/button><\/div><\/div><\/div>";i=i.concat("<div id='"+n._id+"_backstagetabsaveas' class='e-ssr-bstabsaveas'><div class='e-ssr-bscontent'><div class='e-ssr-bssaveasopt'><button id='"+n._id+"_bstab_saveas_excel'><\/button><span>"+n._getLocStr("SaveAsExcel")+"<\/span><\/div><div class='e-ssr-bssaveasopt'><button id='"+n._id+"_bstab_saveas_csv'><\/button><span>"+n._getLocStr("SaveAsCsv")+"<\/span><\/div><\/div><\/div>");i=i.concat("<div id='"+n._id+"_backstagetabprint' class='e-ssr-bstabprint'><div class='e-ssr-bscontent'><div class='e-ssr-bsprintopt'><button id='"+n._id+"_bstab_print_sheet'><\/button><span>"+n._getLocStr("PrintSheet")+"<\/span><\/div><div class='e-ssr-bsprintopt'><button id='"+n._id+"_bstab_print_selected'><\/button><span>"+n._getLocStr("PrintSelected")+"<\/span><\/div><\/div><\/div>");n.element.append(i);r.push({id:"new",text:n._getLocStr("New"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabnew"});r.push({id:"open",text:n._getLocStr("Open")+"...",itemType:t.Ribbon.itemType.button});r.push({id:"saveas",text:n._getLocStr("SaveAs"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabsaveas"});r.push({id:"print",text:n._getLocStr("Print"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabprint"});this._appTabCollection={type:t.Ribbon.applicationTabType.backstage,backstageSettings:{text:n._getLocStr("File"),headerWidth:124,height:n.model.scrollSettings.height,width:n.model.scrollSettings.width,pages:r}}},_onBackStageItemClick:function(t){var i=this.XLObj,r={element:t.target};if((i.XLEdit._isEdit&&i.XLEdit.saveCell(),!i._trigger("menuClick",r))&&t.id==="open_backStageBtn")if(i._isSheetsDirty())i._showAlertDlg("confirm","ImportAlert","Open",470);else{if(i.model.importSettings.importMapper.length<1){i._showAlertDlg("Alert","ImportExportUrl");return}n("#"+i._id+"_file .e-uploadinput").click()}},_bSBtnClickHandler:function(){var r,u=this._id.split("_"),i=n("#"+u[0]).data("ejSpreadsheet"),e=u[2],f=u[3];n("#"+i._id+"_Ribbon").ejRibbon("hideBackstage");switch(e){case"new":switch(f){case"blank":i._isSheetsDirty()&&i._showAlertDlg("confirm","DestroyAlert","New",470)}break;case"saveas":i.XLExport["export"](f==="excel"?t.Spreadsheet.exportType.Excel:t.Spreadsheet.exportType.Csv);break;case"print":r=i.getActiveSheetIndex();switch(f){case"sheet":i.XLPrint.printSheet(r);break;case"selected":i.XLPrint.printSelection(r)}}},_contextualTabObj:function(){var r=this.XLObj,n=r._id,u="imagetop",i;r.model.allowFormatAsTable&&(i={backgroundColor:"#FCFBEB",borderColor:"#F2CC1C",tabs:[{id:"design",text:r._getLocStr("Design"),groups:[{text:"Properties",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_tableproperties"},{text:"Tools",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("resizetable","ResizeTable","textandimage","e-icon e-ssr-resizetable",101,this._smallBtnHeight,"ResizeTable","ResizeTableContent"),this._generateBtn("convertorange","ConvertToRange","textandimage","e-icon e-ssr-range",130,this._smallBtnHeight,"ConvertToRange","ConvertToRangeContent")]}]},{text:"Table Style Options",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_tablestyleoptions"}]}]},this._contextualTabCollection.push(i));r.model.allowCharts&&(i={backgroundColor:"#EAF6BD",borderColor:"#90AA3C",tabs:[{id:"cdesign",text:"Chart Design",groups:[{text:"Chart Layouts",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("cElement","AddChartElement","textandimage",n+"_Ribbon_CElement","","e-icon e-ssr-celements",!0,65,this._bigBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-chartlayoutbtn","AddChartElement","AddChartElementContent")]}]},{text:"Data",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("srcolumn","SwitchRowColumn","textandimage","e-icon e-ssr-srcolumn",72,this._bigBtnHeight,"SwitchRowColumn","SwitchRowColumnContent","","imagetop"),this._generateBtn("selectData","SelectData","textandimage","e-icon e-ssr-selectdata",50,this._bigBtnHeight,"SelectData","SelectDataContent",!1,u)]}]},{text:"Type",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("charttype","ChartType","textandimage","e-icon e-ssr-charttype",65,this._bigBtnHeight,"ChartType","ChartTypeContent",!1,u)]}]},{text:"Chart Themes",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateDD("chartTheme","ChartThemes",this._chartThemes,"1",130,this._smallBtnHeight,"ChartThemes","ChartThemesContent")]}]},{text:"Size",alignType:t.Ribbon.alignType.columns,content:[{groups:[{contentID:n+"_Ribbon_chartsize",enableSeparator:!0,type:t.Ribbon.type.custom,height:80}]}]}]}]},this._contextualTabCollection.push(i));r.model.pictureSettings.allowPictures&&(i={backgroundColor:"#FCFBEB",borderColor:"#F2CC1C",tabs:[{id:"format",text:"Format",groups:[{text:"Adjust",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("changepic","ChangePicture","textandimage","e-icon e-ssr-changepicture",120,this._mediumBtnHeight,"ChangePicture","ChangePictureContent"),this._generateSplitBtn("resetpic","ResetPicture","textandimage",n+"_Ribbon_ResetPic",{dataSource:this._resetPicture,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-resetpicture",!1,120,this._mediumBtnHeight,"left","","dropdown","e-ss-resetpictbtn","ResetPicture","ResetPictureContent")]}]},{text:"Border",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("pictureborder","PictureBorder","textandimage",n+"_Ribbon_PictureBorder","","e-icon e-ssr-pictureborder",!1,120,this._mediumBtnHeight,"left","","dropdown","e-ss-pictbrdrbtn","PictureBorder","PictureBorderContent")]}]},{text:"Size",alignType:t.Ribbon.alignType.columns,type:"custom",contentID:n+"_picturesize"}]}]},this._contextualTabCollection.push(i))},_onToggleButtonClick:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);this._ribbonState=!(t.action==="collapse");t.action==="expand"&&(t.action="tabClick",this._heightWidthCalculation(i.getActiveSheetIndex(),r,t))},_heightWidthCalculation:function(t,i,r){var f,u=this.XLObj,e=u.getActivationPanel(),o=e.is(":visible");i.width.toString().indexOf("%")!==-1&&(i.width=u.getMainPanel().width());u._isDisplayHeader?(f=n("#"+u._id+"_Ribbon").height(),u._isDisplayHeader=!1):f=this._ribbonState?u.element.find(".e-ribbon .e-header").height()+110:u.element.find(".e-ribbon .e-header").height();u._setSheetWidthHeight(t,{width:o?i.width-u.model.apWidth:i.width,height:i.height},f,"resize",r.action);o&&e.height(u.getMainPanel().height())},_hideTabs:function(){for(var r=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("instance"),i=["",this.XLObj._getLocStr("Design"),"Chart Design","Format"],t=i.length;t=t-1;)r.hideTab(i[t])},_renderDesignTab:function(){var n=this.XLObj,t="",i=n._getLocStr("TableStyleOptions").split("/");t="<div id="+n._id+'_tableproperties ><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell">Table Name:<\/div><\/div><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell"><input type="text" id='+n._id+'_tablename class="ejinputtext" style="width:86px;opacity:0.7;height: 18px;text-indent: 3px;" /><\/div><\/div><\/div>';t=t+"<div id="+n._id+'_tablestyleoptions ><div class="e-tablestyleoptionsrow" ><div class="e-tablestyleoptionscell"><input id='+n._id+'_Ribbon_tsofirstcolumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsofirstcolumn">'+i[0]+'<\/label><\/div><div class="e-tablestyleoptionscell" ><input id='+n._id+'_Ribbon_tsolastcolumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsolastcolumn">'+i[1]+'<\/label><\/div><\/div><div class="e-tablestyleoptionsrow" ><div class="e-tablestyleoptionscell"><input id='+n._id+'_Ribbon_tsototalrow type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsototalrow">'+i[2]+'<\/label><\/div><div class="e-tablestyleoptionscell" ><input id='+n._id+'_Ribbon_tsofiltercolumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsofiltercolumn">'+i[3]+"<\/label><\/div><\/div><\/div>";n.element.append(t)},_renderFormatTab:function(){var n=this.XLObj;n.element.append("<div id="+n._id+"_picturesize class= e-ss-numeric><table><tr><td style='padding-right:4px;'>"+n._getLocStr("Height")+": <\/label><\/td><td style='padding-bottom:3px;'><input id='"+n._id+"_pictureheight' type='text' /><\/td><\/tr><tr><td><labe>"+n._getLocStr("Width")+": <\/label><\/td><td><input id='"+n._id+"_picturewidth' type='text' /><\/td><\/tr><\/table><\/div>")},_renderNameManagerDlg:function(i){var r=this.XLObj,u="<div id = '"+r._id+"_nmdlg' ><div class='e-dlgctndiv' ><div class='e-dlg-fields'><div id='"+r._id+"_nmgrid' ><\/div><\/div><div class='e-dlg-fields'><label class='e-dlg-fields'>"+r._getLocStr("Refersto")+":<\/label><input type='text' class='e-nmrange ejinputtext' id='"+r._id+"_nmrange' disabled='true' /><\/div><div class='e-dlg-btnfields' ><div class='e-dlg-btnctnr'><button id='"+r._id+"_nmclose' >"+r._getLocStr("Close")+"<\/button><\/div><\/div><\/div><\/div>";u=u+"<div id='"+r._id+"_nmeditortemplate' class='e-hide' ><div class='e-dlg-fields e-dlgctndiv'><table cellpadding='0' cellspacing='0'><tr><td>"+r._getLocStr("Name")+":<\/td><td><input id='name' type='text' class='ejinputtext' value='{{: name}}'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+r._getLocStr("Scope")+":<\/td><td><input class='e-nmscope ejinputtext' id='scope' type='text' readonly value='Workbook'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+r._getLocStr("Comment")+":<\/td><td><textarea id='comment' style='resize:none;height:44px;width:100%;' value='{{: comment}}'>{{: comment}}<\/textarea><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+r._getLocStr("Refersto")+":<\/td><td><input type='text' class='ejinputtext' id='refersto' value='{{: refersto}}' /><\/td><\/tr><\/table><\/div><\/div>";u=u+"<div id='"+r._id+"_nmuseinformula' class='e-nmuseinformula' style='width:125px'><\/div>";i.append(u);n("#"+r._id+"_nmclose").ejButton({showRoundedCorner:!0,width:68,click:n.proxy(this._nmdlgClose,r)});n("#"+r._id+"_nmgrid").ejGrid({dataSource:r.model.nameManager.slice(0),height:162,width:505,allowScrolling:!0,allowSorting:!0,enableAltRow:!1,cssClass:"e-ss-dialog ej-ssgrid e-"+r._id+"-dlg",selectionType:t.Grid.SelectionType.Single,editSettings:{allowAdding:!0,allowDeleting:!1,editMode:t.Grid.EditMode.DialogTemplate,dialogEditorTemplateID:"#"+r._id+"_nmeditortemplate"},toolbarSettings:{showToolbar:!0,toolbarItems:[t.Grid.ToolBarItems.Add]},actionBegin:n.proxy(this._nmActionBegin,r),actionComplete:n.proxy(this._nmActionComplete,r),rowSelected:n.proxy(this._nmRecordSelected,r),columns:[{field:"name",headerText:r._getLocStr("Name"),isPrimaryKey:!0,width:120},{field:"refersto",headerText:r._getLocStr("RefersTo"),width:120},{field:"scope",headerText:r._getLocStr("Scope"),width:80},{field:"comment",headerText:r._getLocStr("Comment"),width:160}]});n("#"+r._id+"_nmdlg").ejDialog({showOnInit:!1,title:r._getLocStr("NameManager"),enableModal:!0,enableResize:!1,width:"537px",cssClass:"e-ss-dialog e-"+r._id+"-dlg",close:t.proxy(this._dialogClose,this),beforeClose:t.proxy(this._beforeDlgClose,this)})},_updateNMRange:function(){var t=this.XLObj;n("#"+t._id+"_nmgridEditForm").find("#refersto").val("="+t._getDollarAlphaRange(t.getSheet(t.getActiveSheetIndex()).selectedRange,!0))},_nmdlgClose:function(){n("#"+this._id+"_nmdlg").ejDialog("close")},_nmRecordSelected:function(t){n("#"+this._id+"_nmdlg").find(".e-nmrange").val(t.data.refersto)},_nmActionBegin:function(n){var t=0,u=!1,f,e,r,i=this.getSheet(this.getActiveSheetIndex());if(n.requestType==="save"){if(r=n.data,r.sheetIndex=this._getSheetIdxFromName(n.data.refersto.split("!")[0].replace("=","")),n.cancel=!0,r.sheetIndex===-1){this._showAlertDlg("Alert","InvalidSheetIndex",null,275);return}if(i._nmEdit)for(e in i._nmValue){for(f=this.model.nameManager.length;t<f;){if(this.model.nameManager[t].name===i._nmValue.name){this.model.nameManager.splice(t,1);this._sheets[this.getActiveSheetIndex()]._calcEngine.removeNamedRange(i._nmValue.name);break}t++}for(t=this._formulaCollection.length;t--;)if(this._formulaCollection[t].display===i._nmValue.name){u=!0;this._formulaCollection.splice(t,1);break}if(u)break}this.XLRibbon._validateNamedRange(r.name,r.refersto)?n.cancel=!1:u&&this.model.nameManager.push(i._nmValue)}n.requestType==="beginedit"&&(i._nmEdit=!0,i._nmValue={name:n.model.dataSource[n.model.selectedRowIndex].name,refersto:n.model.dataSource[n.model.selectedRowIndex].refersto,comment:n.model.dataSource[n.model.selectedRowIndex].comment,sheetIndex:n.model.dataSource[n.model.selectedRowIndex].sheetIndex,scope:n.model.dataSource[n.model.selectedRowIndex].scope})},_nmActionComplete:function(t){var r=n("#"+this._id+"_nmgrid").data("ejGrid"),f=t.requestType,i,u;switch(f){case"add":i=n("#"+this._id+"_nmgrid_dialogEdit").data("ejDialog");i.model.open=n.proxy(this.XLRibbon._updateNMRange(),this);i.option("allowDraggable",!1);i.option("title",this._getLocStr("NewName"));u=n("#"+this._id+"_nmgridEditForm").find("input[type='button']:first");u.data("ejButton").option("text","OK");u.parent().addClass("e-dlg-btnfields").css("text-align","right");break;case"save":this.XLRibbon._addNamedRange(r,t.data.name,t.data.refersto);break;case"delete":this.XLRibbon._removeNamedRange(r,t.data.name);break;case"cancel":r.element.focus()}},_updateNamedRanges:function(n,t,i){var r=this.XLObj;r._sheets[r.getActiveSheetIndex()]._calcEngine.addNamedRange(n,t.replace("=",""));r._formulaCollection.push({text:"="+n,display:n});i||r.XLEdit._refreshAutoComplete()},_updateUseInFormulaTrgt:function(){for(var i=0,t=this.XLObj,r="",e=n("#"+t._id+"_nmuseinformula"),u=t.model.nameManager,f=u.length;i<f;)r=r+"<div class='e-nmuseinformularow' style = 'color:#333333'>"+u[i].name+"<\/div>",i++;f?n("#"+t._id+"_Ribbon_useinformula").ejSplitButton("enable"):n("#"+t._id+"_Ribbon_useinformula").ejSplitButton("disable");e.html("<div>"+r+"<\/div>")},addNamedRange:function(t,i,r,u){var f=n("#"+this.XLObj._id+"_nmgrid").data("ejGrid");this._validateNamedRange(t,i)&&(f.addRecord({name:t,refersto:i,comment:r?r:"",scope:"WorkBook",sheetIndex:u}),f.refreshContent())},_addNamedRange:function(n,t,i){var r=this.XLObj;r.model.nameManager=n.model.dataSource.slice(0);this._updateNamedRanges(t,i);this._updateUseInFormulaTrgt()},removeNamedRange:function(t){if(t){var i=n("#"+this.XLObj._id+"_nmgrid").data("ejGrid");i.option("editSettings",{allowDeleting:!0});i.deleteRecord("name",{name:t});i.option("editSettings",{allowDeleting:!1})}},_removeNamedRange:function(n,t){var r,u,i=this.XLObj,f=i.model.nameManager[i.model.nameManager.length-1];if(i.model.nameManager=n.model.dataSource.slice(0),u=i.model.nameManager,i._sheets[i.getActiveSheetIndex()]._calcEngine.removeNamedRange(t),i._updateFormulaCollection(),r=u.length,r)while(r--)i._formulaCollection.push({text:"="+u[r].name,display:u[r].name});this._updateUseInFormulaTrgt()},_validateNamedRange:function(t,i){var u,f,e,s,o,r=this.XLObj;if(u=this._validateDollarRange(i),t.length>0&&(f=/^([a-zA-Z_0-9]){0,255}$/.test(t)&&this._validateLibraryFunctions(t)),e=this._validateNameManager(t),r._isUndoRedo||u&&f&&e)return!0;s=n("#"+r._id+"_alertdlg");o=u?f?r._getLocStr("NMUniqueNameAlert"):r._getLocStr("NMNameAlert").split("/")[0]:r._getLocStr("NMRangeAlert");r._showAlertDlg("Alert","T-"+o,null,370)},_validateLibraryFunctions:function(n){var i,r=[],u=(new CalcEngine).getLibraryFunctions();n=t.isNullOrUndefined(n)?"":n.toString().toUpperCase();for(i in u.items)r.push(i);for(i=r.length;i--;)if(r[i]===n)return!1;return!0},_validateNameManager:function(n){var i=0,r=this.XLObj.model.nameManager,u=r.length;for(n=t.isNullOrUndefined(n)?"":n.toString().toUpperCase();i<u;){if(r[i].name.toUpperCase()===n)return!1;i++}return!0},_validateDollarRange:function(n){try{if(n&&n.indexOf("!")>-1)return n=n.split("!")[1].replace(/\$/g,""),this.XLObj.getRangeIndices(n),!0}catch(t){return!1}},_renderFormatAsTable:function(){for(var y,l,rt,h=this.XLObj,u=0,at=[11,19],ut=0,c="",ft="",i="w:bold",r="c:#FFFFFF",t="c:#000000",p="c:#2F75B5",w="c:#ED7D31",b="c:#FFC000",f="1px solid #000000",e="1px solid #2f75b5",o="1px solid #ED7D31",s="1px solid #FFC000",k="b:#D9D9D9",a="b:#DDEBF7",d="b:#FCE4D6",g="b:#FFF2CC",et="b:#000000",ot="b:#FFE2C6",st="b:#FFF1BF",v="b:#000000",ht="b:#D7D7D7",nt="b:#FFC000",tt="b:#5B9BD5",ct="b:#Ed7D31",it="hl?"+i+";"+t+";bo:tb-"+f+"&cl?"+k+";"+t+","+t+"&cb?b-"+f+"/hl?"+i+";bo:tb-"+e+";"+p+"&cl?"+a+";"+p+","+p+"&cb?b-"+e+"/hl?"+i+";bo:tb-"+o+";"+w+"&cl?"+d+";"+w+","+w+"&cb?b-"+o+"/hl?"+i+";bo:tb-"+s+";"+b+"&cl?"+g+";"+b+","+b+"&cb?b-"+s+"/hl?"+i+";"+et+";"+r+";bo:o-"+f+"&cl?bo:t-"+f+";"+t+"&cb?o-"+f+"/hl?bo:o-"+e+";"+i+";"+tt+";"+r+"&cl?bo:t-"+e+";"+t+"&cb?o-"+e+"/hl?"+i+";b:#EB7E2F;"+r+";bo:o-"+o+"&cl?bo:t-"+o+";"+t+"&cb?o-"+o+"/hl?"+i+";"+nt+";"+r+";bo:o-"+s+"&cl?bo:t-"+s+";"+t+"&cb?o-"+s+"/hl?"+i+";bo:gb-"+f+";"+t+"&cl?"+k+";"+t+","+t+"&cb?gb-"+f+"/hl?"+i+";bo:gb-"+e+";"+t+"&cl?"+a+";"+t+","+t+"&cb?gb-"+e+"/hl?"+i+";bo:gb-"+o+";"+t+"&cl?"+d+";"+t+","+t+"&cb?gb-"+o+"/hl?"+i+";bo:gb-"+s+";"+t+"&cl?"+g+";"+t+","+t+"&cb?gb-"+s+"/hl?"+i+";"+et+";"+r+"&cl?b:#A6A6A6;"+t+","+k+";"+t+"/hl?"+i+";"+tt+";"+r+"&cl?b:#BDD7EE;"+t+","+a+";"+t+"/hl?"+i+";"+ct+";"+r+"&cl?b:#F8CBAD;"+t+","+d+";"+t+"/hl?"+i+";"+nt+";"+r+"&cl?b:#FFE699;"+t+","+g+";"+t+"/hl?"+i+";"+ht+";"+t+";bo:gb-"+f+"&cl?b:#A7A7A7;"+t+","+ht+";"+t+"&cb?gb-"+f+"/hl?"+i+";b:#DBECF6;"+t+";bo:gb-"+e+"&cl?b:#BED8F1;"+t+","+a+";"+t+"&cb?gb-"+e+"/hl?"+i+";"+ot+";"+t+";bo:gb-"+o+"&cl?b:#F6CAAD;"+t+","+ot+";"+t+"&cb?gb-"+o+"/hl?"+i+";"+st+";"+t+";bo:gb-"+s+"&cl?b:#FDE18D;"+t+","+st+";"+t+"&cb?gb-"+s+"/hl?"+i+";"+v+";"+r+"&cl?b:#404040;"+r+",b:#737373;"+r+"/hl?"+i+";"+v+";"+r+"&cl?b:#2F75B5;"+r+","+tt+";"+r+"/hl?"+i+";"+v+";"+r+"&cl?b:#C65911;"+r+","+ct+";"+r+"/hl?"+i+";"+v+";"+r+"&cl?b:#BF8F00;"+r+","+nt+";"+r,lt=h._getLocStr("FATHeaderText").split("/"),vt=h._getLocStr("FormatAsTableTitle").split("/"),yt=["Light1","Light2","Light3","Light5","Light8","Light9","Light10","Light12","Light15","Light16","Light17","Light19","Medium8","Medium9","Medium10","Medium12","Medium22","Medium23","Medium24","Medium26","Dark1","Dark2","Dark3","Dark5"],it=it.split("/");u<24;)c=c+h._renderDIV("e-formatastablecell",'<div class="e-ss-cellstyles-'+(u+1)+'" />'),u===at[ut]&&(c+="<\/br>",ut++),u++;for(u=0,c=c.split("<\/br>");u<lt.length*2;)ft+=h._renderDIV(u%2==0?"e-formatastableheader":"e-formatastablecontent",u%2==0?lt[u/2]:c[0]),u%2!=0&&c.shift(),u++;for(y=n("<div id="+h._id+'_formatastable class="e-spreadsheet e-formatastable" style="display:none;" >'+ft+"<\/div>"),l=y.find(".e-formatastablecell"),u=0,rt=l.length;u<rt;)n(l[u]).data({format:this._getFormatAsTableInput(it[u]),formatName:"TableStyle"+yt[u]}).attr("title","Table Style "+vt[u]),u++;return h.XLFormat&&(h.XLFormat._formatAsTableStyle=n(l[0]).data()),this._renderFATNameDlg(),this._renderChartNameDlg(),this._renderFATResizeTableDlg(),y},_renderFATNameDlg:function(){var r,i=this.XLObj,u=i._getLocStr("FATNameDlgText").split("/"),f={showRoundedCorner:!0,width:"27%",click:n.proxy(this._fatNameDlgBtnClick,this)};r="<div id="+i._id+'_fatnamedlg><div class="e-dlg-fields e-dlgctndiv"><table cellspacing="0" cellpadding="0"><tr><td>'+u[0]+'<\/td><td><input id="'+i._id+'_fatname" class="ejinputtext" /><\/td><\/tr><tr class="e-dlgtd-fields"><td><\/td><td><input type="checkbox" id="'+i._id+'_fatheader" style="background-color:#ffffff"/> <label for="'+i._id+'_fatheader" style="margin-left: 4px;">'+u[1]+'<\/label><\/td><\/tr><\/table><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_fatnamedlgok>"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_fatnamedlgcancel>"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(r);n("#"+i._id+"_fatheader").ejCheckBox();n("#"+i._id+"_fatnamedlgok").ejButton(f);n("#"+i._id+"_fatnamedlgcancel").ejButton(f);n("#"+i._id+"_fatnamedlg").ejDialog({showOnInit:!1,width:"286px",showRoundedCorner:!0,title:i._getLocStr("FormatAsTable"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_renderChartNameDlg:function(){var r,i=this.XLObj,f=i._getLocStr("ChartTitleDlgText"),u={showRoundedCorner:!0,width:"23%",click:n.proxy(this._chartNameDlgBtnClick,this)};r="<div id="+i._id+'_chartnamedlg ><div class="e-dlg-fields e-dlgctndiv"><table cellpadding="0" cellspacing="0"><tr><td>'+f+'<\/td><td><input id="'+i._id+'_chartname" class="ejinputtext" /><\/td><\/tr><\/table><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_chartnamedlgok >"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_chartnamedlgcancel>"+i._getLocStr("Cancel")+"<\/button><\/div><\/div>";i.element.append(r);n("#"+i._id+"_chartnamedlgok").ejButton(u);n("#"+i._id+"_chartnamedlgcancel").ejButton(u);n("#"+i._id+"_chartnamedlg").ejDialog({showOnInit:!1,width:"334px",minHeight:"auto",showRoundedCorner:!0,title:i._getLocStr("ChartTitle"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_renderFATResizeTableDlg:function(){var i=this.XLObj,r={showRoundedCorner:!0,width:"15%",click:n.proxy(this._fatResizeTableBtnClick,this)},u="<div id="+i._id+'_fatresizetabledlg ><div class="e-dlgctndiv"><table><tr><td>'+i._getLocStr("FATResizeTableText")+'<\/td><td style="width: 50%;"><input id="'+i._id+'_fatresizetablerange" class="ejinputtext" style="margin-left: 2px;"><\/td><\/tr><\/table><div class="e-dlg-fields">'+i._getLocStr("FATReizeTableNote")+'<\/div><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_fatresizetabledlgok >"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_fatresizetabledlgcancel >"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(u);n("#"+i._id+"_fatresizetabledlgok").ejButton(r);n("#"+i._id+"_fatresizetabledlgcancel").ejButton(r);n("#"+i._id+"_fatresizetabledlg").ejDialog({showOnInit:!1,width:"494px",showRoundedCorner:!0,title:i._getLocStr("ResizeTable"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_fatResizeTableBtnClick:function(t){var i=this.XLObj,s,r=document.getElementById(i._id+"_fatresizetablerange").value,o=i.getActiveSheetIndex(),u,f=document.getElementById(i._id+"_tableid").value,e=i.getSheet(o)._tableManager;u={sheetIndex:o,reqType:"format-table",action:"resizetable",beforeRange:e[f].range,tableId:f};canclose=!0;t.model.text===i._getLocStr("Ok")&&(i._isvalidRange(r)?(r=r.indexOf(":")!=-1?i.getRangeIndices(r):[],s=this._validateResizeRange(r,e[f].range),s?i._showAlertDlg("Alert",s,"",500):(e[f].range=r,i.XLFormat._createTable(f,{format:e[f].format}),i.XLFilter._extendFilterRange(f,r),u.afterRange=r,u.format=e[f].format,u.formatName=e[f].formatName,u.header=n.extend(!0,{},i.model.sheets[o]._header),i._completeAction(u),e[f].totalRow&&(i.XLEdit.updateCellValue({rowIndex:u.beforeRange[2]+1,colIndex:u.beforeRange[1]},""),i._clearFormula(u.beforeRange[2]+1,u.beforeRange[3]),i.XLEdit.updateCellValue({rowIndex:u.beforeRange[2]+1,colIndex:u.beforeRange[3]},""),i.XLEdit.updateCellValue({rowIndex:r[2]+1,colIndex:r[1]},"Total"),i.XLEdit.updateCellValue({rowIndex:r[2]+1,colIndex:r[3]},"=SUBTOTAL("+e[f].fnNumber+","+i._getAlphaRange(o,r[0]+1,r[3],r[2],r[3])+")")))):(canclose=!1,i._showAlertDlg("Alert","InvalidReference","",375)));canclose&&n("#"+i._id+"_fatresizetabledlg").ejDialog("close")},_fatNameDlgBtnClick:function(t){var r,i=this.XLObj,u=i._id;n("#"+u+"_fatnamedlg").ejDialog("close");t.model.text===i._getLocStr("Ok")&&(r={header:n("#"+u+"_fatheader").ejCheckBox("checked"),name:document.getElementById(u+"_fatname").value,format:i.XLFormat._formatAsTableStyle.format},i.XLFormat._formatAsTableStyle.formatName&&(r.formatName=i.XLFormat._formatAsTableStyle.formatName),i.XLFormat.createTable(r))},_validateResizeRange:function(n,t){var i=this.XLObj;if(n.length){if(n[0]!=t[0]||n[1]!=t[1])return"ResizeAlert";if(n[3]!=t[3]||n[2]<t[2])return"ResizeRestrictAlert";if(n[2]>i.getSheet(i.getActiveSheetIndex()).rowCount)return"RangeNotCreated"}else return"InvalidReference"},_chartNameDlgBtnClick:function(t){var f,r,i=this.XLObj,s=i.getActiveSheetIndex(),o=i.getSheet(s)._shapeMngr.chart[i.XLEdit.getPropertyValue(i.XLShape._picCellIdx.rowIndex,i.XLShape._picCellIdx.colIndex,"chart")[0]],u,e=i._id,h=document.getElementById(e+"_chart").value;if(f=n("#"+h).data("ejChart"),r={sheetIndex:s,reqType:"shape",shapeType:"chart",cid:h,rowIndex:i.XLShape._picCellIdx.rowIndex,colIndex:i.XLShape._picCellIdx.colIndex,prev:{},cur:{}},u=document.getElementById(e+"_chartname").value,t.model.text===i._getLocStr("Ok")){if(!u.length){i._showAlertDlg("Alert","InvalidTitle","InvalidChartTitleActn",375);return}switch(i._hasTitle){case"PX":f.option("primaryXAxis",{title:{text:u}});o.xAxis.title.text=u;r.action="PX";break;case"PY":f.option("primaryYAxis",{title:{text:u}});o.yAxis.title.text=u;r.action="PY";break;case"CT":f.option("title",{text:u});o.title.text=u;r.action="CT"}}r.prev.text=i._cOpt.prevText;i._hasTitle=="CT"&&(r.prev.align=i._cOpt.prevAlign,r.cur.align=i._cOpt.curAlign);r.cur.text=u;i._completeAction(r);i._cOpt={};document.getElementById(e+"_chartname").value="";n("#"+e+"_chartnamedlg").ejDialog("close")},_designTabUpdate:function(t,i){var r=this.XLObj;if(r.model.showRibbon){var f=r._id,o,e=n("#"+r._id+"_Ribbon").ejRibbon("instance"),u=r.getSheet(r.getActiveSheetIndex())._tableManager;e.showTab(r._getLocStr("Design"));this._isDesignTab&&!e._isCollapsed&&e.option({selectedItemIndex:this._getTabIndex("design")});document.getElementById(r._id+"_tablename").value=u[t].name;document.getElementById(r._id+"_tableid").value=t;this._isSetModel=!0;n("#"+f+"_Ribbon_tsototalrow").data("ejCheckBox").option({checked:u[t].totalRow?!0:!1});n("#"+f+"_Ribbon_tsofirstcolumn").data("ejCheckBox").option({checked:u[t].firstColumn?!0:!1});n("#"+f+"_Ribbon_tsolastcolumn").data("ejCheckBox").option({checked:u[t].lastColumn?!0:!1});n("#"+f+"_Ribbon_tsofiltercolumn").data("ejCheckBox").option({checked:u[t].isFilter?!0:!1});this._isSetModel=!1;o=n("#"+r._id+"_Ribbon_clearfilter").data("ejButton");this._changeClrFltrStatus(o,"button",i)}},_formatTabUpdate:function(){var t=this.XLObj,i;t.model.showRibbon&&(i=n("#"+t._id+"_Ribbon").ejRibbon("instance"),i.showTab("Format"),t._shapeChange=!0,t.element.find("#"+t._id+"_pictureheight").ejNumericTextbox("option","value",t.element.find(".e-ss-activeimg").height()),t.element.find("#"+t._id+"_picturewidth").ejNumericTextbox("option","value",t.element.find(".e-ss-activeimg").width()),t.model.showRibbon&&!i._isCollapsed&&i.option({selectedItemIndex:t.XLRibbon._getTabIndex("format")}),t._shapeChange=!1)},_chartDesignTabUpdate:function(t){var i=this.XLObj;if(i.model.showRibbon){var r=n("#"+i._id+"_Ribbon").data("ejRibbon"),u=t.get(0).id,f=t.get(0).offsetLeft,e=t.get(0).offsetTop;i.XLShape._picCellIdx=i.XLShape._getCellIndexFromOffset(e,f);r.showTab("Chart Design");r._isCollapsed||r.option({selectedItemIndex:i.XLRibbon._getTabIndex("cdesign")});document.getElementById(i._id+"_chart").value=u;this._isSetModel=!0;this._setChartWidthHeight({height:t.height(),width:t.width()});r.element.find("#"+i._id+"_Ribbon_chartTheme").ejDropDownList("setSelectedValue",t.ejChart("option","theme"));this._isSetModel=!1;i.model.allowFormulaBar&&i.updateFormulaBar()}},_setChartWidthHeight:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_chartwidth").data("ejNumericTextbox"),u=n("#"+i._id+"_Ribbon_chartheight").data("ejNumericTextbox");i._shapeChange=!0;u.option({value:t.height});r.option({value:t.width});i._shapeChange=!1},_toggleDesignTab:function(i){var r=this.XLObj,f,u,e=r.getActiveSheetIndex();r.model.showRibbon&&(u=n("#"+r._id+"_Ribbon").data("ejRibbon"),(t.isNullOrUndefined(r.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"tableName"))||r.getSheetElement(e).find(".e-ss-activeimg").length)&&(u.hideTab(r._getLocStr("Design")),u._isCollapsed||u.option({selectedItemIndex:1})));f=n("#"+r._id+"_Ribbon_clearfilter").data("ejButton");this._changeClrFltrStatus(f,"button",i)},_toggleChartDesignTab:function(){var t,i=this.XLObj;i.model.showRibbon&&(t=n("#"+i._id+"_Ribbon").data("ejRibbon"),t.hideTab("Chart Design"),t._isCollapsed||t.option({selectedItemIndex:1}))},_toggleFormatTab:function(){var t,i=this.XLObj;i.model.showRibbon&&(t=n("#"+i._id+"_Ribbon").data("ejRibbon"),t.hideTab("Format"),t._isCollapsed||t.option({selectedItemIndex:1}))},_getTabIndex:function(t){if(this.XLObj.model.showRibbon){for(var u=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("model"),r=u.tabs,f=u.contextualTabs,i=0;i<f.length;)r=r.concat(f[i].tabs),i++;for(i=r.length;i--;)if(r[i].id===t)return++i}},_getFormatAsTableInput:function(n){var h=this.XLObj,t,r,e,i,o=0,u=0,c=[],s={hl:"headerLayout",cl:"contentLayout",hb:"headerBorder",cb:"contentBorder"},f={};for(n=n.split("&");o<n.length;){if(e=n[o].split("?"),t=e[0],r=e[1],t==="hl")f[s[t]]=h._getStyleAsJSON(r,!0);else if(t==="cl"){for(i=r.split(",");u<i.length;)c.push(i[u].length?h._getStyleAsJSON(i[u],!0):{}),u++;f[s[t]]=c}else t==="cb"&&(i=r.split("-"),f[s[t]]={border:this._getBorderObj(i[0],i[1])});o++}return f},_getBorderObj:function(n,t){var r,i={t:{top:""},r:{right:""},b:{bottom:""},l:{left:""},o:{top:"",right:"",bottom:"",left:""},tb:{top:"",bottom:""},gb:{top:"",right:"",bottom:"",left:""}};for(r in i[n])i[n][r]=t;return n==="gb"&&(i[n].isGridBorder=!0),i[n]},_renderCellStyles:function(){for(var r,t=0,e=[],i="",o=[4,2,12],u=this.XLObj,f=u._dataContainer.hashCode,s=u._getLocStr("CellStyleHeaderText").split("/"),c=u._getLocStr("CellStyleGBN").split("/"),l=[f[0],f[1],f[2],f[3]],a=u._getLocStr("CellStyleTH").split("/"),h=f.slice(4,6),v=u._getLocStr("CellsStyleTCS").split("/"),y=f.slice(6,18);t<o[0];)r=c[t],i=i+u._renderDIV("e-cellstylecell "+l[t],r,r),t++;for(e.push(i),i="",t=0;t<o[1];)r=a[t],i=t===1?i+'<div class="e-cellstylecell '+h[t]+'"  style="font-size: 11pt;" title='+r+">"+r+"<\/div>":i+u._renderDIV("e-cellstylecell "+h[t],r,r),t++;for(e.push(i),i="",t=0;t<o[2];)r=v[t],i=i+u._renderDIV("e-cellstylecell "+y[t],r,r),t++;for(e.push(i),i="",t=0;t<s.length*2;)i=i+u._renderDIV(t%2==0?"e-cellstyleheader":"e-cellstylecontent",t%2==0?s[t/2]:e[0]),t%2!=0&&e.shift(),t++;return n("<div id="+u._id+'_cellstyles class="e-spreadsheet e-cellstyles">'+i+"<\/div>")},_onTabClick:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);t.prevActiveIndex!==-1&&i.model.allowComments&&i.model.allowEditing&&(i.XLEdit._isEdit||i.XLComment._isCommentEdit||i._isSheetRename||!i.getSheet(i.getActiveSheetIndex())._isSheetProtected)&&!this._isDirtySelect&&this._enableRibbonIcons(t.activeIndex);i._trigger("tabClick",t)},_onCollapse:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);this._ribbonState=!1;t.action="toggleBtn";this._heightWidthCalculation(i.getActiveSheetIndex(),r,t)},_onTabSelect:function(n){var t=this.XLObj,i=t.getSheet(t.getActiveSheetIndex());t.model.showRibbon&&(t.XLEdit._isEdit||t.model.allowComments&&t.XLComment._isCommentEdit||t._isSheetRename||i._isSheetProtected?this._disableRibbonIcons():this._enableRibbonIcons(),this._updateRibbonIcons());t.XLEdit.getPropertyValue(i._activeCell.rowIndex,i._activeCell.colIndex,"tableName")&&(this._isDesignTab=n.activeIndex==this._getTabIndex("design")||n.activeIndex==this._getTabIndex("format")||n.activeIndex==this._getTabIndex("cdesign"));t._trigger("tabSelect",n)},_valDTypeOnChange:function(t){var i=this.XLObj;n.validator&&n("#"+i._id+"_Form_ValDialog").validate().resetForm();t.value==="Between"||t.value==="NotBetween"?(n("#"+i._id+"_Ribbon_lbMax").show(),n("#"+i._id+"_Ribbon_btnMax").show(),n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr("NumberStart"))):(n("#"+i._id+"_Ribbon_lbMax").hide(),n("#"+i._id+"_Ribbon_btnMax").hide(),n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr("DataValue")));this._dialogValidate("_ValDialog")},_valTypeOnChange:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList");r.enable();t.value==="List"?(n("#"+i._id+"_Ribbon_lbMax").hide(),n("#"+i._id+"_Ribbon_btnMax").hide(),r.disable()):(r._selectedValue==="Between"||r._selectedValue==="NotBetween")&&(n("#"+i._id+"_Ribbon_lbMax").show(),n("#"+i._id+"_Ribbon_btnMax").show());n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr(t.selectedText+"Start"));n("#"+i._id+"_Ribbon_lbMax").text(i._getLocStr(t.selectedText+"End"));this._dialogValidate("_ValDialog")},_valDlgBtnClick:function(t){var i=this.XLObj,f,e;if(t==="ok"&&n.validator&&n("#"+i._id+"_Form_ValDialog").valid()){var s=n("#"+i._id+"_Ribbon_blank").data("ejCheckBox"),h=n("#"+i._id+"_Ribbon_freetext").data("ejCheckBox").isChecked(),o=n("#"+i._id+"_Ribbon_ddType").data("ejDropDownList"),v=n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList");if(o._selectedValue==="List"){var r=n("#"+i._id+"_Ribbon_btnMin").val(),a=r,c,u,f=n("#"+i._id+"_alertdlg"),l;if(r.indexOf("=")>-1){if(r=r.split("=")[1],r.indexOf("!")>-1&&(c=r.split("!"),e=i._getSheetIndexByName(c[0]),r=c[1]),e===!1){i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}if(r.indexOf("$")>-1&&(r=r.split("$").join("")),r.indexOf(":")<0&&(r=r+":"+r),e=i.isUndefined(e)?i.getActiveSheetIndex():e,l=i.getSheet(e),u=i.getRangeIndices(r),isNaN(u[0])||isNaN(u[1])||isNaN(u[2])||isNaN(u[3])||l.colCount<=u[3]||l.rowCount<=u[2]){i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}if(u[2]===u[0]||u[3]===u[1])i.XLValidate.applyDVRules(null,["list",a],this._types[o.selectedIndexValue].value,s.isChecked(),h);else{i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListValAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}}else i.XLValidate.applyDVRules(null,["list",a],this._types[o.selectedIndexValue].value,s.isChecked(),h)}else i.XLValidate.applyDVRules(null,[this._actions[v.selectedIndexValue].value,n("#"+i._id+"_Ribbon_btnMin").val(),n("#"+i._id+"_Ribbon_btnMax").val()],this._types[o.selectedIndexValue].value,s.isChecked(),h);i._setddlCell()}else n.validator||(t="cancel");(t==="cancel"||t==="ok"&&n.validator&&n("#"+i._id+"_Form_ValDialog").valid())&&(n("#"+i._id+"_Ribbon_ddType").data("ejDropDownList").option({selectedItemIndex:0}),n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList").option({selectedItemIndex:6}),n("#"+i._id+"_Ribbon_blank").data("ejCheckBox").option({checked:!0}),n("#"+i._id+"_Ribbon_freetext").data("ejCheckBox").option({checked:!0}),n("#"+i._id+"_Ribbon_btnMin").val(""),n("#"+i._id+"_Ribbon_btnMax").val(""),n("#"+i._id+"_ValDialog").ejDialog("close"),i.setSheetFocus())},_renderValDialog:function(){var i=this.XLObj,h,e,v,o,c,a,y,p;if(n("#"+i._id+"_Ribbon_MainDiv").length<1){h=t.buildTag("div.e-dlgctndiv");e=t.buildTag("div.e-dlg-fields","",{},{id:i._id+"_Ribbon_MainDiv"});n("#"+i._id+"_Validation").append(e);o=t.buildTag("label.e-dlg-fields",i._getLocStr("Allow"));e.append(o);c=t.buildTag("input","","",{id:i._id+"_Ribbon_ddType",type:"text"});e.append(c);c.ejDropDownList({dataSource:this._types,fields:{id:"Types",text:"text",value:"text"},selectedItemIndex:1,cssClass:"e-"+i._id+"-ddl",width:235,height:25,change:n.proxy(this._valTypeOnChange,this)});var s=t.buildTag("input#"+i._id+"_Ribbon_blank"),l=t.buildTag("label",i._getLocStr("IgnoreBlank"),{},{"for":i._id+"_Ribbon_blank"}),f=t.buildTag("table"),u=t.buildTag("tr"),r=t.buildTag("td");r.append(s);u.append(r);r=t.buildTag("td");r.append(l);u.append(r);f.append(u);s.ejCheckBox();s=t.buildTag("input#"+i._id+"_Ribbon_freetext");l=t.buildTag("label#"+i._id+"_Ribbon_lblfreetext",i._getLocStr("FreeText"),{},{"for":i._id+"_Ribbon_lblfreetext"});u=t.buildTag("tr");r=t.buildTag("td");r.append(s);u.append(r);r=t.buildTag("td");r.append(l);u.append(r);f.append(u);e.append(f);s.ejCheckBox({checked:!0});o=t.buildTag("label.e-dlg-fields").text(i._getLocStr("Data"));e.append(o);a=t.buildTag("input","","",{id:i._id+"_Ribbon_ddAction",type:"text"});e.append(a);a.ejDropDownList({dataSource:this._actions,fields:{id:"Types",text:"text",value:"value"},selectedItemIndex:6,cssClass:"e-"+i._id+"-ddl",width:235,height:25,change:n.proxy(this._valDTypeOnChange,this)});v=t.buildTag("div.e-dlgctndiv e-dlg-fields","",{},{id:i._id+"_Ribbon_SubDiv"});f=t.buildTag("table");u=t.buildTag("tr");r=t.buildTag("td");o=t.buildTag("label.e-dlg-fields","","",{id:i._id+"_Ribbon_lbMin"}).text(i._getLocStr("NumberStart"));f.append(u.append(r.append(o)));u=t.buildTag("tr");r=t.buildTag("td");y=t.buildTag("input.ejinputtext","",{width:235},{id:i._id+"_Ribbon_btnMin",type:"text",name:i._id+"_valMin"});f.append(u.append(r.append(y)));u=t.buildTag("tr");r=t.buildTag("td");o=t.buildTag("label.e-dlg-fields","","",{id:i._id+"_Ribbon_lbMax"}).text(i._getLocStr("NumberEnd"));f.append(u.append(r.append(o)));u=t.buildTag("tr");r=t.buildTag("td");p=t.buildTag("input.ejinputtext","",{width:235},{id:i._id+"_Ribbon_btnMax",type:"text",name:i._id+"_valMax"});f.append(u.append(r.append(p)));h.append(e,v.append(f)).height(294);n("#"+i._id+"_Validation").append(h);n("#"+i._id+"_Ribbon_SubDiv").wrapInner('<form id="'+i._id+'_Form_ValDialog" onsubmit="return false"><\/form>');this._dialogValidate("_ValDialog")}},_dialogValidate:function(t,i){var f=this.XLObj,e=f._id,l,nt=n("#"+e+"_Form"+t),o,r,a,v,s,y,p,u,w,b,h,k=!0,c,d,g;if(n.validator){nt.validate({errorElement:"div",wrapper:"div",errorPlacement:function(n,t){n.insertAfter(t.closest("input"));n.children().addClass("e-dlg-field-validation-error");n.css({position:"relative"});n.offset({left:t.offset().left,top:t.offset().top+19})},onfocusout:function(n){this.element(n)}});c=n("#"+e+"_Ribbon_ddAction").ejDropDownList("getValue");switch(t){case"_ValDialog":l=n("#"+e+"_Ribbon_ddType").data("ejDropDownList");o=l.getSelectedValue();break;case"_CFDialog":o=i.charAt(0).toUpperCase()+i.slice(1).toLowerCase();break;case"_GoToDiv":o="cellAddr";break;case"_Ribbon_cellAddress":o="cellAddr";break;case"_Ribbon_webAddress":o="webAddr"}for(n("#"+e+"_Form"+t).validate().resetForm(),u=[],p=n("#"+e+"_Form"+t).find("input").length,y={required:!0,date:!0,messages:{date:f._getLocStr("DateValidationMsg"),required:f._getLocStr("RequiredField")}},v={required:!0,celladdr:!0},w={required:!0,numberVal:!0},g={required:!0,number:!0,messages:{required:f._getLocStr("RequiredField"),number:f._getLocStr("NumberValidationMsg")}},b={required:!0,time:!0},s={required:!0},d={required:!0,betweentype:!0},n.validator.addMethod("time",function(n){return n===""||n.match(/^(([0-1]?[0-9])|([2][0-3])):([0-5]?[0-9])(:([0-5]?[0-9]))?(\s(AM|am|PM|pm))?$/)},f._getLocStr("TimeValidationMsg")),n.validator.addMethod("date",function(n,t){var i=n.split("/");return this.optional(t)||!/Invalid|NaN/.test(new Date(/chrom(e|ium)/.test(navigator.userAgent.toLowerCase())?i[1]+"/"+i[0]+"/"+i[2]:n))},f._getLocStr("DateValidationMsg")),n.validator.addMethod("celladdr",function(t,i){var r,u=n("#"+i.id.split("_")[0]).data("ejSpreadsheet"),f=n("#"+u._id+"_Ribbon_sheentName").ejTreeView("option","selectedNode"),e;return f=f<0?u.getActiveSheetIndex():f,e=u.getSheet(f),t.indexOf("=")>-1&&(t=t.split("=")[1]),t.indexOf("!")>-1&&(h=t.split("!"),k=n("#"+i.id.split("_textRef")[0]).data("ejSpreadsheet")._getSheetIndexByName(h[0]),t=h[1]),t.indexOf("$")>-1&&(t=t.split("$").join("")),r=u.getRangeIndices(t),r=e.colCount<=r[3]||e.rowCount<=r[2]?null:t,(t.match(/^(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9]):(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9])$/)||t.match(/^(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9])$/)&&k)&&r},f._getLocStr("cellAddrsValidationMsg")),n.validator.addMethod("betweentype",function(t,i){var e=i.id.split("_")[0],f=n("#"+i.id.split("_")[0]+"_Ribbon_ddType").ejDropDownList("getSelectedValue"),r=n("#"+e+"_Ribbon_btnMin").val(),u=n("#"+i.id.split("_")[0]+"_Ribbon_btnMax").val();return(r===""||u===""||parseFloat(r)>parseFloat(u))&&(t=null),f==="Date"&&Date.parse(r)>Date.parse(u)&&(t=null),f==="Time"&&new Date("01/01/1990 "+r).getTime()>new Date("01/01/1990 "+u).getTime()&&(t=null),t},f._getLocStr("BetweenAlert")),n.validator.addMethod("numberVal",function(t){if(n.isNumeric(t))return parseFloat(t)%1!=0&&(t=null),n.validator.messages.numberVal=f._getLocStr("NumberValMsg"),t;n.validator.messages.numberVal=f._getLocStr("NumberAlertMsg")},n.validator.messages.numberVal),r=0,a=p;r<a;r++){u[r]=n("#"+e+"_Form"+t).find("input")[r].id;switch(o){case"Date":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",y);break;case"Time":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",b);break;case"Number":case"TextLength":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",w);break;case"Decimal":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",g);break;case"List":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",s);break;case"cellAddr":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",v);break;case"webAddr":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",s)}o!=="List"&&(c==="between"||c==="not between")&&n("#"+e+"_Ribbon_btnMax").rules("add",d)}}},_renderCFDialog:function(i){var f,o,e,u,h,r=this.XLObj,s;h=n("#"+r._id+"_CFDialog").data("ejDialog");h.option({title:r._getLocStr(this._cFormatData[i.ID][0])});n("#"+r._id+"_Ribbon_CFSubDiv").length<1&&(o=t.buildTag("div.e-dlg-fields","",{},{id:r._id+"_Ribbon_CFSubDiv"}),e=t.buildTag("label.e-dlg-fields").text(r._getLocStr("With")),o.append(e),s=t.buildTag("input","",{},{id:r._id+"_Ribbon_ddStyle",type:"text"}),o.append(s),s.ejDropDownList({dataSource:this._styles,fields:{id:"Types",text:"text",value:"value"},selectedItemIndex:0,cssClass:"e-"+r._id+"-ddl",width:"100%",height:25,change:n.proxy(this._ddOnChange,this)}),n("#"+r._id+"_CondFormat").append(o),n("#"+r._id+"_CondFormat").addClass("e-cfdiv"));n("#"+r._id+"_Ribbon_CFMainDiv").length>0&&n("#"+r._id+"_Ribbon_CFMainDiv").remove();f=t.buildTag("div.e-dlg-fields","","",{id:r._id+"_Ribbon_CFMainDiv"});n("#"+r._id+"_CondFormat").prepend(f);i.ID=="between"&&(u=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_input2",type:"text"}),f.prepend(u),e=t.buildTag("label.e-dlg-fields").text(r._getLocStr("And")).css("display","table"),f.prepend(e));u=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_input1",type:"text"});f.prepend(u);e=t.buildTag("label.e-dlg-fields").text(r._getLocStr(this._cFormatData[i.ID][1]));f.prepend(e);(i.ID==="aboveavg"||i.ID==="belowavg")&&u.hide();n("#"+r._id+"_Ribbon_CFMainDiv").wrapInner('<form id="'+r._id+'_Form_CFDialog" onsubmit="return false"><\/form>');u.is(":visible")&&u.focus().setInputPos(u.val().length);this._dialogValidate("_CFDialog",i.ID)},_dlgCFOk:function(){var t=this.XLObj,i;n("#"+t._id+"_Form_CFDialog").valid()&&(i=n("#"+t._id+"_Ribbon_ddStyle").data("ejDropDownList"),t.XLCFormat._cFormat(t.XLRibbon._currentCFormat,n("#"+t._id+"_Ribbon_input1").val(),n("#"+t._id+"_Ribbon_input2").val(),i.getSelectedValue()),n("#"+t._id+"_CFDialog").ejDialog("close"),t.setSheetFocus())},_dlgCFCancel:function(){var t=this.XLObj;n("#"+t._id+"_CFDialog").ejDialog("close");t.setSheetFocus()},_sheetData:function(){var r=this.XLObj,u=[],t=[],n,f,i=r._getSheetNames();for(t[0]={id:1,name:r._getLocStr("SheetReference"),hasChild:!0,expanded:!0},n=1,f=i.length;n<=f;n++)i[n-1].isVisible&&(u[n]=i[n-1].text,t[n]={id:n+1,pid:1,name:u[n],hasChild:!0,expanded:!0});return t},_renderHLDialog:function(){var i=this.XLObj,c,u,f,s,h,o,e,r,l;n("#"+i._id+"_Ribbon_WebDiv").length<1&&(c=t.buildTag("div.e-dlgctndiv","",{},{id:i._id+"_Ribbon_WebDiv"}),e=t.buildTag("table","",{},{cellpadding:0,cellspacing:0}),r=t.buildTag("tr"),$td=t.buildTag("td","",{width:"32%"}),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("HyperlinkText")),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_findText",type:"text"}),r.append($td.append(f)),r=t.buildTag("tr.e-dlgtd-fields"),$td=t.buildTag("td"),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("WebAddress"),"",{id:i._id+"_Ribbon_address"}),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_webAddress",type:"text"}),r.append($td.append(f)),n("#"+i._id+"_Web").append(c.append(e)),s=t.buildTag("div.e-dlgctndiv","","",{id:i._id+"_Ribbon_DocDiv"}),l=t.buildTag("div.e-dlg-fields"),e=t.buildTag("table"),r=t.buildTag("tr"),$td=t.buildTag("td","",{width:"32%"}),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("HyperlinkText")),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_cellText",type:"text"}),r.append($td.append(f)),r=t.buildTag("tr.e-dlgtd-fields"),$td=t.buildTag("td"),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("CellAddress")),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_cellAddress",type:"text"}),r.append($td.append(f)),o=t.buildTag("div.e-dlg-fields","","",{id:i._id+"_Ribbon_Sheet"}),s.append(l.append(e),o),u=t.buildTag("label",i._getLocStr("SheetIndex")),o.append(u),h=t.buildTag("div","","",{id:i._id+"_Ribbon_sheentName"}),o.append(h),h.ejTreeView({fields:{id:"id",parentId:"pid",text:"name",hasChild:"hasChild",dataSource:this._sheetData(),expanded:"expanded"},nodeSelect:n.proxy(this._sheetSelect,i),height:140}),n("#"+i._id+"_Doc").append(s),n("#"+i._id+"_Ribbon_cellAddress").wrap("<form id='"+i._id+"_Form_Ribbon_cellAddress' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_cellAddress"),n("#"+i._id+"_Ribbon_webAddress").wrap("<form id='"+i._id+"_Form_Ribbon_webAddress' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_webAddress"))},_sheetSelect:function(t){var i,u,f=this._getSheetNames(),r=n("#"+this._id+"_Ribbon_cellAddress"),e=n("#"+this._id+"hlDialog_OkBtn").data("ejButton"),o=n("#"+this._id+"_Ribbon_cellText");if(t.model.selectedNode>0)for(r.attr("disabled",!1),e.enable(),r.focus().setInputPos(1),i=0,u=f.length;i<u;i++)f[i].text===o.val().split("!")[0]&&o.val(t.value+"!"+r.val());else r.attr("disabled",!0),e.disable()},_dlgHLOk:function(){var t=this.XLObj;n("#"+t._id+"_Form_Ribbon_cellAddress").valid()&&n("#"+t._id+"_Form_Ribbon_webAddress").valid()&&(t._setLink(),this._dlgHLCancel())},_dlgHLCancel:function(){n("#"+this.XLObj._id+"_HLDialog").ejDialog("close")},_renderFRDialog:function(){var h,f,c,l,s,e,a,r=this.XLObj,o,u,i;n("#"+r._id+"_Ribbon_FindDiv").length<1&&(h=t.buildTag("div.e-dlgctndiv","",{height:63},{id:r._id+"_Ribbon_FindDiv"}),n("#"+r._id+"_Find").append(h),o=t.buildTag("table"),u=t.buildTag("tr"),i=t.buildTag("td","",{width:"26%"}),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("FindLabel")),i.append(f),i=t.buildTag("td"),c=t.buildTag("input.ejinputtext","","",{id:r._id+"_Ribbon_textFind",type:"text"}),i.append(c),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("ReplaceLabel"),"",{id:r._id+"_Ribbon_lbReplace"}),i.append(f),i=t.buildTag("td"),l=t.buildTag("input.ejinputtext","","",{id:r._id+"_Ribbon_textReplace",type:"text"}),i.append(l),u.append(i),h.append(o),n("#"+r._id+"_Ribbon_lbReplace").hide(),n("#"+r._id+"_Ribbon_textReplace").hide(),a=t.buildTag("div.e-dlgctndiv","",{},{id:r._id+"_Ribbon_SettingsDiv"}),o=t.buildTag("table"),u=t.buildTag("tr"),i=t.buildTag("td","",{width:"50%"}),o.append(u.append(i)),s=t.buildTag("input#"+r._id+"_Ribbon_Case"),f=t.buildTag("label",r._getLocStr("MatchCase"),{},{"for":r._id+"_Ribbon_Case"}),i.append(s),i.append(f),s.ejCheckBox(),i=t.buildTag("td"),s=t.buildTag("input#"+r._id+"_Ribbon_AllContent"),f=t.buildTag("label",r._getLocStr("MatchAll"),{},{"for":r._id+"_Ribbon_AllContent"}),i.append(s),s.ejCheckBox(),i.append(f),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label").text(r._getLocStr("Within")),i.append(f),i=t.buildTag("td"),f=t.buildTag("label").text(r._getLocStr("Search")),i.append(f),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddWithin",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._within,{id:"Types",text:"text",value:"value"},0,125,25)),i=t.buildTag("td"),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddSearch",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._sType,{id:"Types",text:"text",value:"value"},0,125,25)),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("Lookin")),i.append(f),i=t.buildTag("td"),f=t.buildTag("label",r._getLocStr("Replace")+" "+r._getLocStr("Direction")),u.append(i.append(f)),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddLookin",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._vType,{id:"Types",text:"text",value:"value"},0,125,25,"Type")),i=t.buildTag("td"),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddDirection",type:"text"}),u.append(i.append(e)),e.ejDropDownList(r._generateEJDD(this._direction,{id:"Types",text:"text",value:"value"},0,125,25)),n("#"+r._id+"_Settings").append(a.append(o)),n("#"+r._id+"_Ribbon_FindRep").css("width",174))},_frTypeChange:function(t,i){t==="Type"&&i.value==="comment"?(n("#"+this._id+"_Ribbon_textReplace").attr("disabled",!0),n("#"+this._id+"FR_ReplaceBtn").ejButton("disable"),n("#"+this._id+"FR_ReplaceAllBtn").ejButton("disable")):(n("#"+this._id+"_Ribbon_textReplace").removeAttr("disabled"),n("#"+this._id+"FR_ReplaceBtn").ejButton("enable"),n("#"+this._id+"FR_ReplaceAllBtn").ejButton("enable"))},_hlTabChange:function(t){var i=this.XLObj,e=n("#"+i._id+"_Ribbon_sheentName").data("ejTreeView"),o=i.getActiveSheetIndex(),s=n("#"+i._id+"_Doc"),h=n("#"+i._id+"_Web"),c=n("#"+i._id+"_Ribbon_webAddress"),u=n("#"+i._id+"_Ribbon_findText"),r=n("#"+i._id+"_Ribbon_cellAddress"),f=n("#"+i._id+"_Ribbon_cellText");switch(t.activeIndex){case 0:c.focus().setInputPos(c.val().length);u.val(f.val());s.hide();h.show();n("#"+i._id+"hlDialog_OkBtn").ejButton("enable");break;case 1:r.val().length||r.val("A1");s.show();h.hide();e.selectNode(o+1);u.val().length?f.val(u.val()):f.val(e.getText(o+1)+"!A1");r.focus().setInputPos(r.val().length)}},_findTabChange:function(t){var r,i=this.XLObj;switch(t.activeIndex){case 0:r=n("#"+i._id+"_Ribbon_FindDiv");n("#"+i._id+"_Ribbon_lbReplace").hide();n("#"+i._id+"_Ribbon_textReplace").hide();n("#"+i._id+"FR_ReplaceBtn").hide();n("#"+i._id+"FR_ReplaceAllBtn").hide();n("#"+i._id+"_Find").append(r);n("#"+i._id+"FR_PrevBtn").show();n("#"+i._id+"FR_NextBtn").show();n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length);break;case 1:r=n("#"+i._id+"_Ribbon_FindDiv");n("#"+i._id+"_Ribbon_lbReplace").show();n("#"+i._id+"_Ribbon_textReplace").show();n("#"+i._id+"FR_ReplaceBtn").show();n("#"+i._id+"FR_ReplaceAllBtn").show();n("#"+i._id+"FR_PrevBtn").show();n("#"+i._id+"FR_NextBtn").show();n("#"+i._id+"_Replace").append(r);n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length);break;case 2:n("#"+i._id+"FR_PrevBtn").hide();n("#"+i._id+"FR_NextBtn").hide();n("#"+i._id+"FR_ReplaceBtn").hide();n("#"+i._id+"FR_ReplaceAllBtn").hide();n("#"+i._id+"_Ribbon_ddWithin").focus()}},_gotoTabChange:function(t){var i=this.XLObj;t.activeIndex==0&&n("#"+i._id+"_textRef").focus().setInputPos(n("#"+i._id+"_textRef").val().length)},_btnFROnClick:function(t){var i=this.XLObj;i.element.ejWaitingPopup("show");var r=i.getActiveSheetIndex(),c=i.getSheet(r)._startCell.rowIndex,l=i.getSheet(r)._startCell.colIndex,u=n("#"+i._id+"_Ribbon_Case").data("ejCheckBox").isChecked(),f=n("#"+i._id+"_Ribbon_AllContent").data("ejCheckBox").isChecked(),e=this._within[n("#"+i._id+"_Ribbon_ddWithin").data("ejDropDownList").selectedIndexValue].value,s=this._sType[n("#"+i._id+"_Ribbon_ddSearch").data("ejDropDownList").selectedIndexValue].value,o=this._vType[n("#"+i._id+"_Ribbon_ddLookin").data("ejDropDownList").selectedIndexValue].value,a=this._direction[n("#"+i._id+"_Ribbon_ddDirection").data("ejDropDownList").selectedIndexValue].value,h;switch(t){case"FR_NextBtn":case"FR_PrevBtn":i.XLSearch._findCount=0;h=t==="FR_NextBtn"?i.XLSearch._findNext(n("#"+i._id+"_Ribbon_textFind").val(),r,u,f,o,e,s):i.XLSearch._findPrev(n("#"+i._id+"_Ribbon_textFind").val(),r,u,f,o,e,s);h||(i.XLSearch._updateSelection(c,l,r),i.element.ejWaitingPopup("hide"),i._showAlertDlg("Alert","NotFound"));break;case"FR_ReplaceBtn":i.XLSearch._replaceData(n("#"+i._id+"_Ribbon_textFind").val(),n("#"+i._id+"_Ribbon_textReplace").val(),r,u,f,o,a,e,s);break;case"FR_ReplaceAllBtn":i.XLSearch._replaceAllData(n("#"+i._id+"_Ribbon_textFind").val(),n("#"+i._id+"_Ribbon_textReplace").val(),u,f,o,e);break;case"FR_CloseBtn":n("#"+i._id+"_FRDialog").ejDialog("close");i.setSheetFocus()}i.element.ejWaitingPopup("hide")},_renderGoToDialog:function(){var f,e,u,o,s,i=this.XLObj,r;n("#"+i._id+"_GoToDiv").length<1&&(f=t.buildTag("div.e-dlgctndiv","",{},{id:i._id+"_GoToDiv"}),n("#"+i._id+"_GoTo").append(f),r=t.buildTag("div.e-dlg-fields"),u=t.buildTag("label.e-dlg-fields",i._getLocStr("GoToName")),o=t.buildTag("ul#"+i._id+"_GotoAddr"),f.append(r.append(u,o)),n("#"+i._id+"_GotoAddr").ejListBox({dataSource:this._addrList,height:"190px",width:"247px",selected:n.proxy(this._gotoValChange,this),fields:{id:"Types",text:"text",value:"value"}}),r=t.buildTag("div.e-dlg-fields"),u=t.buildTag("label.e-dlg-fields",i._getLocStr("Reference")),s=t.buildTag("input.ejinputtext","","",{id:i._id+"_textRef",type:"text"}),f.append(r.append(u,s)),e=t.buildTag("div#"+i._id+"_GoToSpDiv.e-dlgctndiv"),r=t.buildTag("div.e-dlg-fields e-dlgctndiv"),n("#"+i._id+"_GoToSp").append(e.append(r)),u=t.buildTag("label.e-dlg-fields").text(i._getLocStr("Select")).css("display","table"),r.append(u),this._renderGotoSp(r,this._gotoRBtnSet1,this._gotoRBtnSet2,this._gotoChkBox),n("#"+i._id+"_GoToDiv").wrapInner('<form id="'+i._id+'_Form_GoToDiv" onsubmit="return false"><\/form>'),this._dialogValidate("_GoToDiv"))},_renderGotoSp:function(i,r,u,f){for(var l,c,s,e,h=this.XLObj,v=h._id+"_gotoSpDiv",a,y=t.buildTag("table"),o=0;o<r.length;o++)s=t.buildTag("tr","",{height:35}),e=t.buildTag("td"),l=t.buildTag("input#"+v+"_"+r[o],"",{},{type:"radio",name:"gotospecial"}),e.append(l),s.append(e),l.ejRadioButton({size:"medium",change:n.proxy(this._rBtnOnClick,this,r[o])}),e=t.buildTag("td","",{width:100}),c=t.buildTag("label",h._getLocStr(r[o]),{},{"for":v+"_"+r[o]}),e.append(c),s.append(e),h.isUndefined(u[o])||(e=t.buildTag("td"),l=t.buildTag("input#"+v+"_"+u[o],"",{},{type:"radio",name:"gotospecial"}),e.append(l),s.append(e),l.ejRadioButton({size:"medium",change:n.proxy(this._rBtnOnClick,this,u[o])}),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(u[o]),{},{"for":v+"_"+u[o]}),e.append(c),s.append(e)),y.append(s);for(o=0;o<f.length;o=o+2)s=t.buildTag("tr"),e=t.buildTag("td"),a=t.buildTag("input#"+h._id+"_"+f[o]),e.append(a),s.append(e),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(f[o]),{},{"for":h._id+"_"+f[o]}),e.append(c),s.append(e),a.ejCheckBox({checked:!0,enabled:!1}),e=t.buildTag("td"),a=t.buildTag("input#"+h._id+"_"+f[o+1]),e.append(a),s.append(e),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(f[o+1]),{},{"for":h._id+"_"+f[o+1]}),e.append(c),s.append(e),a.ejCheckBox({checked:!0,enabled:!1}),y.append(s);i.append(y);n("#"+v+"_Blanks").ejRadioButton("option",{checked:!0})},_rBtnOnClick:function(t){var r=this.XLObj,i;if(t==="Formulas"||t==="Constants")for(i=0;i<this._gotoChkBox.length;i++)n("#"+r._id+"_"+this._gotoChkBox[i]).data("ejCheckBox").option({enabled:!0});else for(i=0;i<this._gotoChkBox.length;i++)n("#"+r._id+"_"+this._gotoChkBox[i]).data("ejCheckBox").option({enabled:!1})},_gotoValChange:function(t){n("#"+this.XLObj._id+"_textRef").val(t.model.value)},_gotoBtnClick:function(t){var i=this.XLObj,v,f,e;switch(t){case"ok":if(n("#"+i._id+"_Form_GoToDiv").valid())if(v=n("#"+i._id+"_GoToDlgTab").data("ejTab"),v.model.selectedItemIndex)i.XLSearch._applyGoToRule(n("#"+i._id+"_GoToSpDiv").find(".e-rad-active").parents("div")[0].id.split("ej"+i._id+"_gotoSpDiv_")[1].toLowerCase(),n("#"+i._id+"_"+this._gotoChkBox[0]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[1]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[2]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[3]).data("ejCheckBox").isChecked()),n("#"+i._id+"_GoDialog").ejDialog("close");else{var y,o,p=i.getActiveSheetIndex(),s=i.getSheet(p),u,h,r=n.trim(n("#"+i._id+"_textRef").val().toString()),c,l,a=i._getDollarAlphaRange(s.selectedRange);r.indexOf("!")>-1&&(l=r.split("!"),c=i._getSheetIndexByName(l[0]),r=l[1]);r.indexOf("$")>-1&&(r=r.split("$").join(""));r.indexOf(":")<0&&(r=r+":"+r);r=r.replace("=","");c&&i.gotoPage(c,!1);f=i.getRangeIndices(r);e=i.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]});u=e[0];h=e[e.length-1];i.setActiveCell(u.rowIndex,u.colIndex);i.XLSelection.selectRange(u,h);i.XLScroll._scrollSelectedPosition(i.getActiveSheetIndex(),u);i.XLDragFill.positionAutoFillElement();s._startCell=u;s._endCell=h;i.setSheetFocus();y=n.grep(this._addrList,function(n){return n.value===a});y.length<1&&(this._addrList.push({value:a,text:a}),o=n("#"+i._id+"_GotoAddr").data("ejListBox"),this._addrList=JSON.parse(JSON.stringify(this._addrList)),o.model.dataSource=this._addrList,o.option("fields",{dataSource:this._addrList}));n("#"+i._id+"_GoDialog").ejDialog("close")}break;case"cancel":n.validator&&n("#"+i._id+"_Form_GoToDiv").validate().resetForm();n("#"+i._id+"_GoDialog").ejDialog("close")}i.setSheetFocus()},_borderPicture:function(){var n=this.XLObj;return"<ul id="+n._id+"_Ribbon_PictureBorder><li id='"+n._id+"picturecolor'><a>"+n._getLocStr("ThemeColor")+"<\/a><ul><li><input id='"+n._id+"_Ribbon_PictureColor'><\/input><\/li><\/ul><\/li><li id='nooutline' class='picturecolor'><a>"+n._getLocStr("NoOutline")+"<\/a><\/li><li id='weight' class='picturecolor'><a>"+n._getLocStr("Weight")+"<\/a><ul><li id='1px'><a>1px<\/a><\/li><li id='2px'><a>2px<\/a><\/li><li id='3px'><a>3px<\/a><\/li><\/ul><\/li><li id='dashes' class='picturecolor'><a>"+n._getLocStr("Dashes")+"<\/a><ul><li id='solid'><a><div style='top:9px;border:1px solid black;width:40px'><\/div><\/a><\/li><li id='dotted'><a><div style='top:9px;border:1px dotted black;width:40px'><\/div><\/a><\/li><li id='dashed'><a><div style='top:9px;border:1px dashed black;width:40px'><\/div><\/a><\/li><\/ul><\/li><\/ul>"},_chartElementTag:function(){var n=this.XLObj,t="<ul id="+n._id+'_Ribbon_CElement class="e-spreadsheet">';return t+='<li class="axes" id="Axes"><a><span class="e-ss-chartimg e-icon e-ss-axes"><\/span>'+n._getLocStr("Axes")+'<\/a><ul><li class="phaxis e-ss-cmenuitem" id="PHAxis"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-phaxis"><\/span>'+n._getLocStr("PHAxis")+'<\/a><\/li><li class="pvaxis e-ss-cmenuitem" id="PVAxis"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pvaxis"><\/span>'+n._getLocStr("PVAxis")+"<\/a><\/li><\/ul><\/li>",t+='<li class="axistitle" id="AxisTitle"><a><span class="e-ss-chartimg e-icon e-ss-axistitle"><\/span>'+n._getLocStr("AxisTitle")+'<\/a><ul><li class="phaxistitle e-ss-cmenuitem" id="PHAxisTitle"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-phaxistitle"><\/span>'+n._getLocStr("PHAxis")+'<\/a><\/li><li class="pvaxistitle e-ss-cmenuitem" id="PVAxisTitle"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pvaxistitle"><\/span>'+n._getLocStr("PVAxis")+"<\/a><\/li><\/ul><\/li>",t+='<li class="charttitle" id="ChartTitle"><a><span class="e-ss-chartimg e-icon e-ss-charttitle"><\/span>'+n._getLocStr("ChartTitle")+'<\/a><ul><li class="ctnone e-ss-cmenuitem" id="CTNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctnone"><\/span>'+n._getLocStr("CTNone")+'<\/a><\/li><li class="ctcenter e-ss-cmenuitem" id="CTCenter"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctcenter"><\/span>'+n._getLocStr("CTCenter")+'<\/a><\/li><li class="ctfar e-ss-cmenuitem" id="CTFar"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctfar"><\/span>'+n._getLocStr("CTFar")+'<\/a><\/li><li class="ctnear e-ss-cmenuitem" id="CTNear"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctnear"><\/span>'+n._getLocStr("CTNear")+"<\/a><\/li><\/ul><\/li>",t+='<li class="datalabels" id="DataLabels"><a><span class="e-ss-chartimg e-icon e-ss-datalabels"><\/span>'+n._getLocStr("DataLabels")+'<\/a><ul><li class="dlnone e-ss-cmenuitem" id="DLNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlnone"><\/span>'+n._getLocStr("DLNone")+'<\/a><\/li><li class="dlcenter e-ss-cmenuitem" id="DLCenter"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlcenter"><\/span>'+n._getLocStr("DLCenter")+'<\/a><\/li><li class="dliend e-ss-cmenuitem" id="DLIEnd"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dliend"><\/span>'+n._getLocStr("DLIEnd")+'<\/a><\/li><li class="dlibase e-ss-cmenuitem" id="DLIBase"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlibase"><\/span>'+n._getLocStr("DLIBase")+'<\/a><\/li><li class="dloend e-ss-cmenuitem" id="DLOEnd"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dloend"><\/span>'+n._getLocStr("DLOEnd")+"<\/a><\/li><\/ul><\/li>",t+='<li class="gridline" id="Gridline"><a><span class="e-ss-chartimg e-icon e-ss-gridline"><\/span>'+n._getLocStr("Gridline")+'<\/a><ul><li class="pmajorh e-ss-cmenuitem" id="PMajorH"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pmajorh"><\/span>'+n._getLocStr("PMajorH")+'<\/a><\/li><li class="pmajorv e-ss-cmenuitem" id="PMajorV"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pmajorv"><\/span>'+n._getLocStr("PMajorV")+'<\/a><\/li><li class="pminorh e-ss-cmenuitem" id="PMinorH"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon  e-ss-pminorh"><\/span>'+n._getLocStr("PMinorH")+'<\/a><\/li><li class="pminorv e-ss-cmenuitem" id="PMinorV"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pminorv"><\/span>'+n._getLocStr("PMinorV")+"<\/a><\/li><\/ul><\/li>",t+('<li class="legend" id="Legend"><a><span class="e-ss-chartimg e-icon e-ss-legend"><\/span>'+n._getLocStr("Legend")+'<\/a><ul><li class="lnone e-ss-cmenuitem" id="LNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lnone"><\/span>'+n._getLocStr("LNone")+'<\/a><\/li><li class="lright e-ss-cmenuitem" id="LRight"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lright"><\/span>'+n._getLocStr("LRight")+'<\/a><\/li><li class="lleft e-ss-cmenuitem" id="LLeft"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lleft"><\/span>'+n._getLocStr("LLeft")+'<\/a><\/li><li class="lbottom e-ss-cmenuitem" id="LBottom"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lbottom"><\/span>'+n._getLocStr("LBottom")+'<\/a><\/li><li class="ltop e-ss-cmenuitem" id="LTop"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ltop"><\/span>'+n._getLocStr("LTop")+"<\/a><\/li><\/ul><\/li>")},_cpClickHandler:function(t){var i=this.XLObj;i._isApply=!0;t==="Ribbon_background-color"?i.XLFormat.format({style:{"background-color":n("#"+i._id+"_Ribbon_background-color").ejColorPicker("option","value")}}):t==="Ribbon_color"&&i.XLFormat.format({style:{color:n("#"+i._id+"_Ribbon_color").ejColorPicker("option","value")}});i.setSheetFocus()},_ribbonClickHandler:function(i){var a,ht,ai,ii,rt,ri,y,p,vi,f,w,ft,lt,at,gt,et,c,l,s,yt={},u=n("#"+this._id.split("_Ribbon")[0]).data("ejSpreadsheet"),h=u.getActiveSheetIndex(),tt=u.getSheet(h),b={},v={},d=this._id.split("_"),ut=t.Spreadsheet.SupportedStyles,yi,pt,nr,o,nt,pi,wi,ni,ui,ot,ti,fi,ei,bi,it,kt,hi,g,k,e,st,ct,dt,li;if(!u._shapeChange&&!u.XLRibbon._isSetModel){if(pt=u._getContent(h).find("div.e-content"),nr=u.getMainPanel(),ht=n("#"+u._id+"_Ribbon_cellformat").data("ejDropDownList"),et=n("#"+u._id+"_Ribbon_fontsize").data("ejDropDownList"),gt=n(u.getCell(tt._activeCell.rowIndex,tt._activeCell.colIndex)),u.model.allowSelection&&u.model.allowFormatAsTable&&u.model.allowCellFormatting&&(u.XLFormat._formatEnable||u.XLSelection._isOutsideBordering||u.XLSelection._isGridBordering)&&(u._id+"_Ribbon_BorderColor"===this._id||u._id+"_Ribbon_bordercolor"===i.ID||u._borderStyles.indexOf(i.ID)>-1||(u.XLSelection._isGridBordering=u.XLSelection._isOutsideBordering=u.XLFormat._formatEnable=!1,n("#"+u._id+"_Ribbon_formatpainter").ejToggleButton("option",{toggleState:!1}),(i.type==="itemSelected"||i.type==="click")&&!u.isUndefined(i.model.prefixIcon)&&(i.model.prefixIcon.split("e-ss-")[1]===i.ID||i.model.prefixIcon.indexOf("e-ss-drawborder")>-1||i.model.prefixIcon.indexOf("e-ss-drawbordergrid")>-1)&&(u.XLSelection._isGridBordering=u.XLSelection._isOutsideBordering=!0),pt.addClass("e-ss-cursor"),pt.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor e-ss-fpcursor"),u.XLSelection._cleanUp(!0))),yi={Id:this._id,isChecked:i.isChecked,status:i.status,prop:i.model,model:u.model},u._trigger("ribbonClick",yi)){u.model.showRibbon&&u.XLRibbon._updateRibbonIcons();return}!t.isNullOrUndefined(u._getAutoFillOptElem())&&u.model.autoFillSettings.showFillOptions&&(u._getAutoFillOptElem().addClass("e-hide"),n("#"+u._id+"_ctxtmenu").hide());switch(this._id){case u._id+"_Ribbon_cut":u.XLClipboard.cut();break;case u._id+"_Ribbon_copy":u.XLClipboard.copy();break;case u._id+"_Ribbon_pastebtn":case u._id+"_Ribbon_pastesbtn":u.XLClipboard._isSpecial=!(i.ID==="PasteValues");u.XLClipboard.paste();break;case u._id+"_Ribbon_undo":u.XLClipboard._triggerKeyDown(90,!0);break;case u._id+"_Ribbon_redo":u.XLClipboard._triggerKeyDown(89,!0);break;case u._id+"_Ribbon_wraptext":u._textFormatting("wrapText");break;case u._id+"_Ribbon_exportXL":u.XLExport["export"](t.Spreadsheet.exportType.Excel);break;case u._id+"_Ribbon_exportCsv":u.XLExport["export"](t.Spreadsheet.exportType.Csv);break;case u._id+"_Ribbon_print":u.XLPrint.printSheet(h);break;case u._id+"_Ribbon_printselected":u.XLPrint.printSelection(h);break;case u._id+"_Ribbon_new":u._cellFormatHandler(this._id.replace(u._id+"_Ribbon_",""),i.selectedText);break;case u._id+"_Ribbon_bold":v[ut.FontWeight]=i.model.toggleState?"bold":"normal";b.style=v;u.XLFormat.format(b);break;case u._id+"_Ribbon_italic":v[ut.FontStyle]=i.model.toggleState?"italic":"normal";b.style=v;u.XLFormat.format(b);break;case u._id+"_Ribbon_underline":case u._id+"_Ribbon_line-through":nt=u.XLFormat.getFormatFromHashCode(u.XLFormat.getFormatClass(gt[0].className))["text-decoration"]||"";i.model.toggleState?(nt=nt.replace("none",""),v[ut.TextDecoration]=nt?nt.indexOf("underline")===-1?nt+" "+d[d.length-1]:d[d.length-1]+" "+nt:d[d.length-1]):(nt=n.trim(nt.replace(d[d.length-1],"")),v[ut.TextDecoration]=nt.length?nt:"none");b.style=v;u.XLFormat.format(b);break;case u._id+"_Ribbon_fontsize":v[ut.FontSize]=i.value;b.style=v;u.XLFormat.format(b);break;case u._id+"_Ribbon_increasefontsize":case u._id+"_Ribbon_decreasefontsize":this._id==u._id+"_Ribbon_increasefontsize"?(at=t.isNullOrUndefined(et.selectedIndexValue)?6:et.selectedIndexValue+1,t.isNullOrUndefined(u.XLRibbon._fontSize[at])||et.option({selectedItemIndex:at})):this._id==u._id+"_Ribbon_decreasefontsize"&&(at=t.isNullOrUndefined(et.selectedIndexValue)?4:et.selectedIndexValue-1,t.isNullOrUndefined(u.XLRibbon._fontSize[at])||et.option({selectedItemIndex:at}));v[ut.FontSize]=et.value();b.style=v;u.XLFormat.format(b);break;case u._id+"_Ribbon_left":case u._id+"_Ribbon_right":case u._id+"_Ribbon_center":ft=n(this.element.parents("div").eq(1)).find(".e-text-align");t.isNullOrUndefined(ft[0])||(n("#"+ft[0].id).ejToggleButton("option","toggleState",!1),ft.removeClass("e-text-align"));this.element.addClass("e-text-align");v[ut.TextAlign]=i.model.toggleState?d[d.length-1]:"left";b.style=v;u.XLFormat.format(b);break;case u._id+"_Ribbon_top":case u._id+"_Ribbon_middle":case u._id+"_Ribbon_bottom":ft=n(this.element.parents("div").eq(1)).find(".e-vertical-align");t.isNullOrUndefined(ft[0])||(n("#"+ft[0].id).ejToggleButton("option","toggleState",!1),ft.removeClass("e-vertical-align"));this.element.addClass("e-vertical-align");v[ut.VerticalAlign]=i.model.toggleState?d[d.length-1]:"bottom";b.style=v;u.XLFormat.format(b);break;case u._id+"_Ribbon_font-family":v[ut.FontFamily]=i.text;b.style=v;u.XLFormat.format(b);break;case u._id+"_Ribbon_Vheading":u.showHeaders(i.isChecked);break;case u._id+"_Ribbon_Vgridlines":u.showGridlines(i.isChecked);break;case u._id+"_Ribbon_sizebtn":case u._id+"_Ribbon_sizesbtn":pi=t.isNullOrUndefined(i.ID)?i.model.prefixIcon.substring(12):i.ID;u.XLPrint._printSetting(pi);break;case u._id+"_Ribbon_cellformat":b.type=i.text.toLowerCase();u.XLFormat.format(b);break;case u._id+"_Ribbon_increment":case u._id+"_Ribbon_decrement":gt.data("type")!="number"&&n.isNumeric(u.XLEdit.getPropertyValueByElem(gt))&&(u.XLRibbon._isSetModel=!0,ht.option({selectedItemIndex:1}),u.XLRibbon._isSetModel=!1);u.XLFormat.updateDecimalPlaces(d[d.length-1]);break;case u._id+"_Ribbon_accounting":case u._id+"_Ribbon_percentage":this._id===u._id+"_Ribbon_accounting"?ht.option({selectedItemIndex:3}):ht.option({selectedItemIndex:4});b.type=ht.selectedTextValue.toLowerCase();u.XLFormat.format(b);break;case u._id+"_Ribbon_usegrouping":ht.option({selectedItemIndex:1});b.type=ht.selectedTextValue.toLowerCase();u.XLFormat.format(b);break;case u._id+"_Ribbon_sortAtoZ":u.XLSort._sortHandler("SortAtoZ");break;case u._id+"_Ribbon_sortZtoA":u.XLSort._sortHandler("SortZtoA");break;case u._id+"_Ribbon_filter":u.XLFilter.filter();break;case u._id+"_Ribbon_clearfilter":lt=u.getCell(u.getActiveCell().rowIndex,u.getActiveCell().colIndex)[0].className;lt.indexOf("e-table")<0?u.XLFilter.clearFilter():(c=u._getTableID(lt),u.XLFilter._clearFilterTable(u.getActiveSheetIndex(),parseInt(c),!0));break;case u._id+"_Ribbon_BorderColor":yt=n("#"+u._id+"_Ribbon_BorderColor").data("ejColorPicker");t.isNullOrUndefined(yt)||yt.hide();t.isNullOrUndefined(i.value)||(u._borderColor=i.value);break;case u._id+"_Ribbon_border":u._borderStyles.indexOf(i.ID)<0?t.isNullOrUndefined(i.ID)?i.ID=i.model.prefixIcon.substring(12):i.ID.indexOf("bordercolor")<0&&n(this.element).find(".e-icon ").removeClass().addClass("e-icon e-ss-"+i.ID)&&this.option({prefixIcon:"e-icon e-ss-"+i.ID}):u.XLRibbon._updateBordeStyle(i);ai=u._borderColor||"#000000";y=tt._startCell;p=tt._endCell;wi=u._getAlphaRange(h,y.rowIndex,y.colIndex,p.rowIndex,p.colIndex);u.XLSelection._isOutsideBordering||u.XLSelection._isGridBordering?!(u._borderStyles.indexOf(i.ID)>-1)&&i.ID.indexOf("bordercolor")<0&&(u.XLSelection._isOutsideBordering=u.XLSelection._isGridBordering=!1):u.setBorder({type:i.ID,color:ai,style:u._borderStyle},wi);break;case u._id+"_Ribbon_validationsbtn":case u._id+"_Ribbon_validationbtn":i.ID=="ClearVal"?u.XLValidate.clearDV():i.ID=="HighlightVal"?u.XLValidate.highlightInvalidData():i.ID=="ClearHLVal"?u.XLValidate.clearHighlightedValData():(n("#"+u._id+"_ValDialog").ejDialog("open"),n.validator&&n("#"+u._id+"_Form_ValDialog").validate().resetForm(),n("#"+u._id+"_Ribbon_ddType_wrapper").focus(),ni=u.XLEdit.getPropertyValueByElem(u.getActiveCellElem(h),"rule"),ni?(ui=ni.customVal,ot=ui.split("_"),ui.indexOf("list")>-1?(n("#"+u._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",5),n("#"+u._id+"_Ribbon_btnMin").val(ot[0])):(u.XLRibbon._types.some(function(n,t){if(ot[4]===n.value)return ti=t,!0}),n("#"+u._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",ti),u.XLRibbon._actions.some(function(n,t){if(ot[0]===n.value)return ti=t,!0}),n("#"+u._id+"_Ribbon_ddAction").ejDropDownList("option","selectedItemIndex",ti),n("#"+u._id+"_Ribbon_btnMin").val(ot[1].replace("^","")),n("#"+u._id+"_Ribbon_btnMax").val(ot[2].replace("^",""))),n("#"+u._id+"_Ribbon_blank").ejCheckBox("option","checked",!ni.required),n("#"+u._id+"_Ribbon_freetext").ejCheckBox("option","checked",JSON.parse(ot[ot.length-3]))):(n("#"+u._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",1),n("#"+u._id+"_Ribbon_ddAction").ejDropDownList("option","selectedItemIndex",6),n("#"+u._id+"_Ribbon_btnMin").val(""),n("#"+u._id+"_Ribbon_btnMax").val(""),n("#"+u._id+"_Ribbon_blank").ejCheckBox("option","checked",!0),n("#"+u._id+"_Ribbon_freetext").ejCheckBox("option","checked",!0)));break;case u._id+"_Ribbon_cFormat":if(!i.ID.length)break;u.XLRibbon._currentCFormat=i.ID;i.ID.startsWith("clear")?u.XLCFormat.clearCF(i.ID==="clearselected"):i.ID.indexOf("_HLCellRules")>0||i.ID.indexOf("_ClearRules")>0||(n("#"+u._id+"_CFDialog").ejDialog("open"),u.XLRibbon._renderCFDialog(i));break;case u._id+"_Ribbon_find":ii=n("#"+u._id+"_GoToDlgTab").data("ejTab");fi=n("#"+u._id+"_FRDialog_FPDlgTab").data("ejTab");switch(i.ID){case"Find":n("#"+u._id+"_FRDialog").ejDialog("open");fi.option({selectedItemIndex:0});n("#"+u._id+"_Ribbon_textFind").focus().setInputPos(n("#"+u._id+"_Ribbon_textFind").val().length);break;case"Replace":n("#"+u._id+"_FRDialog").ejDialog("open");fi.option({selectedItemIndex:1});n("#"+u._id+"_Ribbon_textFind").focus().setInputPos(n("#"+u._id+"_Ribbon_textFind").val().length);break;case"GoTo":n("#"+u._id+"_GoDialog").ejDialog("open");ii.option({selectedItemIndex:0});n("#"+u._id+"_textRef").focus().setInputPos(n("#"+u._id+"_Ribbon_textFind").val().length);n.validator&&n("#"+u._id+"_Form_GoToDiv").validate().resetForm();break;case"GoToSpecial":n("#"+u._id+"_GoDialog").ejDialog("open");ii.option({selectedItemIndex:1});n("#"+u._id+"_Blanks").focus();break;default:u.XLSearch._applyGoToRule(i.ID.toLowerCase(),!0,!0,!0,!0)}break;case u._id+"_Ribbon_calcOpt":switch(i.ID){case u._id+"_CalcAuto":u.XLEdit.calcOption(!0);break;case u._id+"_CalcManual":u.XLEdit.calcOption(!1)}break;case u._id+"_Ribbon_calcNow":u.XLEdit.calcNow();break;case u._id+"_Ribbon_calcSht":u.XLEdit.calcNow(u.getActiveSheetIndex());break;case u._id+"_Ribbon_formatpainter":if(!i.model.toggleState)return u.performSelection(u.getActiveCell(),u.getActiveCell()),!1;u.XLFormat._formatEnable=!0;pt.removeClass("e-ss-cursor");pt.addClass("e-ss-fpcursor");u.XLFormat._formatPainter();break;case u._id+"_Ribbon_convertorange":if(confirm(u._getLocStr("ConverToRangeAlert"))){for(c=parseInt(document.getElementById(u._id+"_tableid").value),l=u.getSheet(h)._tableManager,ei=u.model.sheets[h].filterSettings.tableRange,a=0;a<ei.length;a++)ei[a].tableID==c&&(bi=a);f={sheetIndex:h,reqType:"format-table",action:"convertorange",beforeFormat:u.XLFormat.getHashCodeClassAsArray()};f.tableID=c;f.name=l[c].name;f.format=l[c].format;f.formatName=l[c].formatName;f.tableRange=u.model.sheets[h].filterSettings.tableRange[bi];f.beforeRange=l[c].range;f.isFilter=l[c].isFilter;f.firstColumn=l[c].firstColumn;f.lastColumn=l[c].lastColumn;f.totalRow=l[c].totalRow;u.isNumber(c)&&u.XLFormat.removeTable(c);u.XLRibbon.removeNamedRange(f.name);u.XLRibbon._toggleDesignTab(u.getActiveCell());u._completeAction(f)}break;case u._id+"_Ribbon_resizetable":c=parseInt(document.getElementById(u._id+"_tableid").value);s=u.model.sheets[h]._tableManager[c].range;n("#"+u._id+"_fatresizetablerange").val(u._getAlphaRange(h,s[0],s[1],s[2],s[3]));n("#"+u._id+"_fatresizetabledlg").ejDialog("open");break;case u._id+"_Ribbon_tsofirstcolumn":case u._id+"_Ribbon_tsolastcolumn":l=tt._tableManager;c=document.getElementById(u._id+"_tableid").value;c in l&&(s=l[c].range,s=this._id===u._id+"_Ribbon_tsofirstcolumn"?u._getProperAlphaRange(h,s[0]+1,s[1],s[2],s[1]):u._getProperAlphaRange(h,s[0]+1,s[3],s[2],s[3]),this._id===u._id+"_Ribbon_tsofirstcolumn"?(i.isChecked?l[c].firstColumn=!0:delete l[c].firstColumn,ri="firstColumn"):(i.isChecked?l[c].lastColumn=!0:delete l[c].lastColumn,ri="lastColumn"),u._dupDetails=!0,u.XLFormat.format({style:{"font-weight":i.isChecked?"bold":"normal"}},s),u._dupDetails=!1,f={sheetIndex:h,reqType:"format-table",action:"firstlastcolumn",range:s,check:i.isChecked,id:i.model.id,tableId:parseInt(c),prop:ri},u._completeAction(f));break;case u._id+"_Ribbon_tsototalrow":var vt,oi,ki=[],di=[],wt,a,si=!1,bt,b={},y,p;if(l=tt._tableManager,c=document.getElementById(u._id+"_tableid").value,chkBoxObj=n("#"+i.model.id).data("ejCheckBox"),c in l){if(s=l[c].range,vt=u.XLSelection._getSelectedRange({rowIndex:s[2]+1,colIndex:s[1]},{rowIndex:s[2]+1,colIndex:s[3]}),ki.push(u.getRangeData([s[2]+1,s[1],s[2]+1,s[3]])),oi=u._getProperAlphaRange(h,s[0]+1,s[3],s[2],s[3]),y={rowIndex:s[2]+1,colIndex:s[1]},p={rowIndex:s[2]+1,colIndex:s[3]},s=i.isChecked?u._getProperAlphaRange(h,s[0]+1,s[3],s[2],s[3]):"",u._dupDetails=!0,i.isChecked){if(u.insertShiftBottom(y,p),u._isFilterApplied){chkBoxObj.option("checked",!1);return}if(vt.length>1&&u.XLEdit.updateCellValue(vt[0],i.isChecked?"Total":""),!l[c].fnNumber&&i.isChecked){if(wt=t.distinct(u.getRangeData(u.getRangeIndices(oi),!0)),wt=wt.filter(Boolean),a=wt.length,a){while(a--)if(!u.isNumber(wt[a])){si=!0;break}}else si=!0;l[c].fnNumber=si?103:109}u.XLEdit.updateCellValue(vt[vt.length-1],i.isChecked?"=SUBTOTAL("+l[c].fnNumber+","+s+")":"")}else if(u.deleteShiftUp(y,p),u._isFilterApplied){chkBoxObj.option("checked",!0);return}i.isChecked?l[c].totalRow=!0:"totalRow"in l[c]&&delete l[c].totalRow;bt=l[c].range;di.push(u.getRangeData([bt[2]+1,bt[1],bt[2]+1,bt[3]]));f={sheetIndex:h,reqType:"format-table",action:"totalrow",range:oi,check:i.isChecked,id:i.model.id,cell:vt,tmgr:l,tableId:c,pcells:ki[0],curCells:di[0],fnNumber:l[c].fnNumber};u._dupDetails=!1;u._completeAction(f)}break;case u._id+"_Ribbon_tsofiltercolumn":l=tt._tableManager;c=document.getElementById(u._id+"_tableid").value;u.XLFilter._clearFilterTableIcon(h,parseInt(document.getElementById(u._id+"_tableid").value));l[c].isFilter=i.isChecked;f={sheetIndex:h,reqType:"format-table",action:"filtericon",id:i.model.id,check:i.isChecked,tableId:parseInt(c)};u._completeAction(f);break;case u._id+"_Ribbon_table":u.XLRibbon._openFATDlg();break;case u._id+"_Ribbon_newComment":n("#"+u._id+"_Ribbon_newComment").text()===u._getLocStr("NewComment")?u.XLComment.setComment():u.XLComment.editComment();break;case u._id+"_Ribbon_deleteComment":u.XLComment.deleteComment();break;case u._id+"_Ribbon_showAllComments":u.XLComment.showAllComments();break;case u._id+"_Ribbon_showHideComment":u.XLComment.showHideComment();break;case u._id+"_Ribbon_nextComment":u.XLComment.findNextComment();break;case u._id+"_Ribbon_previousComment":u.XLComment.findPrevComment();break;case u._id+"_Ribbon_hyperlink":u._hlDlgOpen();break;case u._id+"_Ribbon_sortfilter":switch(i.ID){case"SortAtoZ":case"SortZtoA":u.model.allowSorting&&u.XLSort._sortHandler(i.ID);break;case"Filter":u.model.allowFiltering&&u.XLFilter.filter();break;default:lt=u.getCell(u.getActiveCell().rowIndex,u.getActiveCell().colIndex)[0].className;lt.indexOf("e-table")<0?u.XLFilter.clearFilter():(c=u._getTableID(lt),u.XLFilter._clearFilterTable(u.getActiveSheetIndex(),parseInt(c),!0))}break;case u._id+"_Ribbon_insbtn":case u._id+"_Ribbon_inssbtn":if(it=u.model.sheets[h]._selectedCells,it.length<1)return;y=it[0];p=it[it.length-1];switch(i.ID){case"InsertCells":u._getJSSheetRowHeaderContent(h).find(".e-rowselected").length?u.insertEntireRow(y.rowIndex,p.rowIndex):u._getJSSheetHeader(h).find(".e-colselected").length?(u._insDelStatus="insert",u.insertEntireColumn(y.colIndex,p.colIndex)):u._renderInsertDialog();break;case"InsertSheetRows":u.insertEntireRow(y.rowIndex,p.rowIndex);break;case"InsertSheetColumns":u._insDelStatus="insert";u.insertEntireColumn(y.colIndex,p.colIndex);break;case"InsertSheet":u.insertSheet();break;default:u.element.find(".e-rowselected").length>0?u.insertEntireRow(y.rowIndex,p.rowIndex):u.element.find(".e-colselected").length>0?(u._insDelStatus="insert",u.insertEntireColumn(y.colIndex,p.colIndex)):u.insertShiftBottom(y,p)}break;case u._id+"_Ribbon_delbtn":case u._id+"_Ribbon_delsbtn":if(it=u.model.sheets[h]._selectedCells,it.length<1)return;y=it[0];p=it[it.length-1];switch(i.ID){case"DeleteCells":u._getJSSheetRowHeaderContent(h).find(".e-rowselected").length?u.deleteEntireRow(y.rowIndex,p.rowIndex,[]):u._getJSSheetHeader(h).find(".e-colselected").length?(u._insDelStatus="delete",u.deleteEntireColumn(y.colIndex,p.colIndex,[])):u._renderDeleteDialog();break;case"DeleteSheetRows":u.deleteEntireRow(y.rowIndex,p.rowIndex,[]);break;case"DeleteSheetColumns":u._insDelStatus="delete";u.deleteEntireColumn(y.colIndex,p.colIndex,[]);break;case"DeleteSheet":u.deleteSheet(h);break;default:u.element.find(".e-rowselected").length>0?u.deleteEntireRow(y.rowIndex,p.rowIndex):u.element.find(".e-colselected").length>0?(u._insDelStatus="insert",u.deleteEntireColumn(y.colIndex,p.colIndex)):u.deleteShiftUp(y,p)}break;case u._id+"_Ribbon_clear":s=tt.selectedRange;switch(i.ID){case"Clear_All":s=u._getAlphaRange(h,s[0],s[1],s[2],s[3]);u.clearAll(s);break;case"Clear_Formats":s=u._getAlphaRange(h,s[0],s[1],s[2],s[3]);u.clearAllFormat(s);break;case"Clear_Contents":s=u._getAlphaRange(h,s[0],s[1],s[2],s[3]);u.clearContents(s);break;case"Clear_Comments":u.model.allowComments&&u.XLComment.deleteComment(r,h,!1,"clear");break;default:u._removeHyperlink("clear")}u.XLSelection._clearBorder(u._arrayAsString(u._cutFocus),h);break;case u._id+"_Ribbon_pivotTable":if(vi={sheetIndex:h,model:u.model.sheets},u._trigger("_createPivotTable",vi))return;break;case u._id+"_Ribbon_charttype":n("#"+u._id+"_charttypedlg").ejDialog("open");break;case u._id+"_Ribbon_pictures":if(u.model.importSettings.importMapper.length<1){u._showAlertDlg("Alert","ImportExportUrl");return}u._uploadImage=!0;n("#"+u._id+"_file .e-uploadinput").click();u.XLRibbon._toggleFormatTab();break;case u._id+"_Ribbon_namemanager":u.XLRibbon._openNameManagerDlg();break;case u._id+"_Ribbon_definename":kt=n("#"+u._id+"_nmgrid").data("ejGrid");kt.getContentTable().find("td").addClass("e-ss-emptyrecord");kt.model.dataSource.length<1?kt.getContentTable().find("td").addClass("e-ss-emptyrecord"):kt.getContentTable().find(".e-ss-emptyrecord").removeClass("e-ss-emptyrecord");n("#"+u._id+"_nmdlg").ejDialog("open");n("#"+u._id+"_nmgrid").ejGrid("instance").addRecord();n("#"+u._id+"_nmgridEditForm input")[0].focus();break;case u._id+"_Ribbon_fPane":switch(i.ID){case"freezePanes":u.XLFreeze.freezePanes(u.model.sheets[h]._activeCell);break;case"FreezeRow":u.XLFreeze.freezeTopRow();break;case"FreezeColumn":u.XLFreeze.freezeLeftColumn();break;case"unfreezePanes":u.XLFreeze.unfreezePanes()}break;case u._id+"_Ribbon_merge":t.isNullOrUndefined(i.ID)&&(u._mergeCenter=!0,u.mergeCells());switch(i.ID){case"MergeCells":u.mergeCells();break;case"MergeAcross":u.mergeAcrossCells();break;case"MergeAndCenter":u._mergeCenter=!0;u.mergeCells();break;case"UnmergeCells":u.unmergeCells(tt.selectedRange)}break;case u._id+"_Ribbon_autosum":rt=tt.selectedRange;i.type==="click"?u.XLRibbon.autoSum("SUM",u._getAlphaRange(h,rt[0],rt[1],rt[2],rt[3])):u.XLRibbon.autoSum(i.ID.toUpperCase(),u._getAlphaRange(h,rt[0],rt[1],rt[2],rt[3]));break;case u._id+"_Ribbon_cElement":o=u.getSheet(h)._shapeMngr.chart[u.XLEdit.getPropertyValue(u.XLShape._picCellIdx.rowIndex,u.XLShape._picCellIdx.colIndex,"chart")[0]];g=document.getElementById(u._id+"_chart").value;e=n("#"+g).ejChart("instance");f={sheetIndex:h,reqType:"shape",shapeType:"chart",cid:g,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex};switch(i.ID){case"PHAxis":f.visibility=!e.model.primaryXAxis.visible;e.option("primaryXAxis",{visible:f.visibility});o.xAxis.visible=f.visibility;f.action=i.ID;break;case"PVAxis":f.visibility=!e.model.primaryYAxis.visible;e.option("primaryYAxis",{visible:f.visibility});o.yAxis.visible=f.visibility;f.action=i.ID;break;case"PHAxisTitle":u._cOpt.prev={text:o.xAxis.title.text};e.model.primaryXAxis.title.text.length!=0?(e.option("primaryXAxis",{title:{text:""}}),o.xAxis.title.text="",f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"PX",cid:g,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,prev:{text:u._cOpt.prev.text},cur:{text:""}},u._completeAction(f)):(u._hasTitle="PX",document.getElementById(u._id+"_chartname").value=o.xAxis.title.text,n("#"+u._id+"_chartnamedlg").ejDialog("open"),n("#"+u._id+"_chartname").focus().setInputPos(o.xAxis.title.text.length),u._cOpt={prevText:o.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"PVAxisTitle":u._cOpt.prev={text:o.yAxis.title.text};e.model.primaryYAxis.title.text.length!=0?(e.option("primaryYAxis",{title:{text:""}}),o.yAxis.title.text="",f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"PY",cid:g,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,prev:{text:u._cOpt.prev.text},cur:{text:""}},u._completeAction(f)):(u._hasTitle="PY",document.getElementById(u._id+"_chartname").value=o.yAxis.title.text,n("#"+u._id+"_chartnamedlg").ejDialog("open"),n("#"+u._id+"_chartname").focus().setInputPos(o.yAxis.title.text.length),u._cOpt={prevText:o.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"CTNone":u._cOpt.prev={text:o.title.text};e.model.title.text.length&&(e.option("title",{text:""}),o.title.text="",f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"CT",cid:g,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,prev:{text:u._cOpt.prev.text},cur:{text:""}},u._completeAction(f));break;case"CTCenter":u._hasTitle="CT";u._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(u._id+"_chartname").value=o.title.text;n("#"+u._id+"_chartnamedlg").ejDialog("open");n("#"+u._id+"_chartname").focus().setInputPos(o.title.text.length);e.option("title",{textAlignment:"center"});u._cOpt.curAlign=e.model.title.textAlignment;o.title.align="center";break;case"CTFar":u._hasTitle="CT";u._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(u._id+"_chartname").value=o.title.text;n("#"+u._id+"_chartnamedlg").ejDialog("open");n("#"+u._id+"_chartname").focus().setInputPos(o.title.text.length);e.option("title",{textAlignment:"far"});u._cOpt.curAlign=e.model.title.textAlignment;o.title.align="far";break;case"CTNear":u._hasTitle="CT";u._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(u._id+"_chartname").value=o.title.text;n("#"+u._id+"_chartnamedlg").ejDialog("open");n("#"+u._id+"_chartname").focus().setInputPos(o.title.text.length);e.option("title",{textAlignment:"near"});u._cOpt.curAlign=e.model.title.textAlignment;o.title.align="near";break;case"DLNone":for(k=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},hi=e.model.series[0].marker.dataLabel.visible?!1:!0,a=0;a<e.model.series.length;a++)k.push({marker:{dataLabel:{visible:hi,verticalTextAlignment:"far",textPosition:"top"}}});e.option({series:k});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:hi};break;case"DLCenter":for(k=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},a=0;a<e.model.series.length;a++)k.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"center",textPosition:"middle",offset:{y:0}}}});e.option({series:k});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"center",tPosn:"middle"};break;case"DLIBase":for(k=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},a=0;a<e.model.series.length;a++)k.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"far",textPosition:"bottom",offset:{y:0}}}});e.option({series:k});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"far",tPosn:"bottom"};break;case"DLIEnd":for(k=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},a=0;a<e.model.series.length;a++)k.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"near",textPosition:"top",offset:{y:-10}}}});e.option({series:k});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"near",tPosn:"top"};break;case"DLOEnd":for(k=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},a=0;a<e.model.series.length;a++)k.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"near",textPosition:"top",offset:{y:0}}}});e.option({series:k});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"near",tPosn:"top"};break;case"PMajorH":f.visibility=!e.model.primaryYAxis.majorGridLines.visible;e.option("primaryYAxis",{majorGridLines:{visible:f.visibility}});o.yAxis.majorGridLines={visible:f.visibility};f.action=i.ID;break;case"PMajorV":f.visibility=!e.model.primaryXAxis.majorGridLines.visible;e.option("primaryXAxis",{majorGridLines:{visible:f.visibility}});o.xAxis.majorGridLines={visible:f.visibility};f.action=i.ID;break;case"PMinorH":f.visibility=!e.model.primaryYAxis.minorGridLines.visible;e.option("primaryYAxis",{minorGridLines:{visible:f.visibility},minorTicksPerInterval:5,minorTickLines:{visible:f.visibility}});o.yAxis.minorGridLines={visible:f.visibility};f.action=i.ID;break;case"PMinorV":f.visibility=!e.model.primaryXAxis.minorGridLines.visible;e.option("primaryXAxis",{minorGridLines:{visible:f.visibility},minorTicksPerInterval:5,minorTickLines:{visible:f.visibility}});o.xAxis.minorGridLines={visible:f.visibility};f.action=i.ID;break;case"LNone":f.visibility=!e.model.legend.visible;e.option("legend",{visible:f.visibility});o.legend.visible=f.visibility;f.action=i.ID;break;case"LLeft":f.prev={position:e.model.legend.position};e.option("legend",{position:"left",visible:!0});o.legend.position="left";f.cur={position:e.model.legend.position};f.action="Legend";break;case"LRight":f.prev={position:e.model.legend.position};e.option("legend",{position:"right",visible:!0});o.legend.position="right";f.cur={position:e.model.legend.position};f.action="Legend";break;case"LBottom":f.prev={position:e.model.legend.position};e.option("legend",{position:"bottom",visible:!0});o.legend.position="bottom";f.cur={position:e.model.legend.position};f.action="Legend";break;case"LTop":f.prev={position:e.model.legend.position};e.option("legend",{position:"top"});o.legend.position="top";f.cur={position:e.model.legend.position};f.action="Legend"}t.isNullOrUndefined(f.action)||u._completeAction(f);break;case u._id+"_Ribbon_chartwidth":u.XLRibbon._changeChartSize("height",i.value);break;case u._id+"_Ribbon_chartheight":u.XLRibbon._changeChartSize("width",i.value);break;case u._id+"_Ribbon_srcolumn":g=document.getElementById(u._id+"_chart").value;e=n("#"+g).ejChart("instance");o=u.XLChart._getShapeObj(g,"chart");f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"srcolumn",cid:g,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex};e.model.series.length=0;o.isRowColSwitched=!o.isRowColSwitched;yt={xRange:o.xRange,yRange:o.yRange,lRange:o.lRange,isRowColSwitched:o.isRowColSwitched,dataSheetIdx:o.dataSheetIdx};st=u.XLChart._processChartSeries(yt);e.option({series:st.series});u.getActiveSheetIndex()===o.dataSheetIdx&&u.XLChart._focusChartRange(st.xRange,st.yRange,st.lRange);o.xAxis.range=st.xRange;o.yAxis.range=st.yRange;o.legend.range=st.lRange;u._completeAction(f);break;case u._id+"_Ribbon_PictureColor":case u._id+"_Ribbon_pictureborder":if(["weight","dashes",u._id+"picturecolor",""].indexOf(i.ID)===-1){w=u.getSheetElement(h).find(".e-ss-activeimg");ct=new RegExp("\\be-shapebdr.*?\\b","g");v=w[0].className.match(ct)?u.XLShape._getImgStyleFromHashCode(w[0].className.match(ct)[0]):{"border-color":"transparent","border-width":"1px","border-style":"solid"};var ci=v["border-color"],gi=v["border-width"],v=v["border-style"];if(w[0]){switch(!0){case this._id.indexOf("PictureColor")>-1:ci=i.value;break;case i.ID.indexOf("px")>-1:gi=i.ID;break;case i.ID==="nooutline":ci="transparent";break;default:v=i.ID}u.XLShape._updateImgBorder(w[0],gi,v,ci)}}break;case u._id+"_Ribbon_resetpic":w=u.element.find(".e-ss-activeimg");ct=new RegExp("\\be-shapebdr.*?\\b","g");f={sheetIndex:h,reqType:"shape",shapeType:"picture",action:"resetpic",id:n(w).attr("id"),actionType:i.ID};u._dupDetails=!0;t.isNullOrUndefined(w[0].className.match(ct))||(imgStyle=u.XLShape._getImgStyleFromHashCode(w[0].className.match(ct)[0]));f.prev={bcolor:imgStyle["border-color"],bstyle:imgStyle["border-style"],bwidth:imgStyle["border-width"]};w[0].className=w[0].className.replace(ct,"");f.cur={bcolor:w.css("border-color"),bstyle:w.css("border-style"),bwidth:w.css("border-width")};w[0].className=w[0].className+" "+u.XLShape._getImgBorderHashCode({"border-color":f.cur.bcolor,"border-style":f.cur.bstyle,"border-width":f.cur.bwidth});i.ID!=="resetpicture"&&(f.prev.width=w.css("width"),f.prev.height=w.css("height"),w.css({width:u.model.pictureSettings.width,height:u.model.pictureSettings.height}),f.cur.width=w.css("width"),f.cur.height=w.css("height"),u.XLShape._updateShapeObj(w[0]),u.XLRibbon._formatTabUpdate());u._dupDetails=!1;u._completeAction(f);break;case u._id+"_Ribbon_changepic":u._uploadImage=!0;u.XLShape._changePicture=!0;u.element.find("#"+u._id+"_file .e-uploadinput").click();u.XLRibbon._toggleFormatTab();break;case u._id+"_Ribbon_selectData":g=document.getElementById(u._id+"_chart").value;o=u.XLChart._getShapeObj(g,"chart");n("#"+u._id+"_crxaxis").val(o.xRange?u._getAlphaRange(h,o.xRange[0],o.xRange[1],o.xRange[2],o.xRange[3]):"");n("#"+u._id+"_cryaxis").val(o.yRange?u._getAlphaRange(h,o.yRange[0],o.yRange[1],o.yRange[2],o.yRange[3]):"");n("#"+u._id+"_crlaxis").val(o.lRange?u._getAlphaRange(h,o.lRange[0],o.lRange[1],o.lRange[2],o.lRange[3]):"");u._selectDataval={xRange:n("#"+u._id+"_crxaxis").val(),yRange:n("#"+u._id+"_cryaxis").val(),lRange:n("#"+u._id+"_crlaxis").val()};n("#"+u._id+"_chartrangedlg").ejDialog("open");n("#"+u._id+"_crxaxis").focus().setInputPos(0);break;case u._id+"_Ribbon_chartTheme":dt=u.element.find("#"+u._id+"_chart").val();f={sheetIndex:h,reqType:"shape",action:"chartTheme"};f.prev={theme:n("#"+dt).data("ejChart").model.theme};this.selectedTextValue.indexOf("Dark")>-1?n("#"+dt).addClass("e-ss-charttheme"):n("#"+dt).removeClass("e-ss-charttheme");u.XLChart.refreshChart(dt,{theme:this._selectedValue});f.cur={theme:this._selectedValue};u._completeAction(f);break;case u._id+"_Ribbon_LockCell":u.lockCells(null,i.model.toggleState);break;case u._id+"_Ribbon_ProtectSheet":u.protectSheet(i.model.toggleState);break;case u._id+"_Ribbon_protectWorkbook":li=n("#"+u._id+"_PasswordDialog").data("ejDialog");u.model.exportSettings.password||(li.option("title",u._getLocStr("ProtectWorkbook")),n("#"+u._id+"_confirm").show());li.open()}this._id.indexOf("Comment")===-1&&u.setSheetFocus()}},_changeChartSize:function(t,i){var r=this.XLObj,h,o=r.XLEdit.getPropertyValue(r.XLShape._picCellIdx.rowIndex,r.XLShape._picCellIdx.colIndex,"chart")[0],f=document.getElementById(r._id+"_chart").value,u=n("#"+f).ejChart("instance"),s=n("#"+f),e={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:t,cid:f,rowIndex:r.XLShape._picCellIdx.rowIndex,colIndex:r.XLShape._picCellIdx.colIndex,prev:{width:u.model.size.width,height:u.model.size.height}};h=u.model.size;t==="height"?(u.option("size",{width:i.toString()}),o.width=i,s[0].style.width=i+"px",e.cur={width:i.toString(),height:u.model.size.height}):(u.option("size",{height:i.toString()}),o.height=i,s[0].style.height=i+"px",e.cur={width:u.model.size.width,height:i.toString()});r._completeAction(e)},_updateBordeStyle:function(n){var t=this.XLObj;t._borderStyle=n.ID&&n.ID.length>0&&n.ID},_colorPickerHandler:function(t,i){var u,r=this.XLObj,f;i.type==="open"?(n("#"+r._id+"_"+t+"_popup").find(".e-buttons, .e-button").hide(),n("#"+r._id+"_"+t+"_popup").focus()):i.type==="change"&&(u=r.XLFormat,f=n("#"+r._id+"_"+t).data("ejColorPicker"),t==="Ribbon_color"?(u.format({style:{color:i.value}}),n("#"+r._id+"_Ribbon_home_Font_Color").find(".e-selected-color").css("background-color",i.value)):(u.format({style:{"background-color":i.value}}),n("#"+r._id+"_Ribbon_home_Font_Background").find(".e-selected-color").css("background-color",i.value)),f.hide(),r._dupDetails=!0,f.setValue(i.value),r._dupDetails=!1)},updateRibbonIcons:function(){this._updateRibbonIcons()},_updateRibbonIcons:function(){if(this.XLObj.model.showRibbon){var l,a,w,v,p,r,f,i=this.XLObj,y,o=n("#"+i._id+"_Ribbon_cellformat").data("ejDropDownList"),k=i.getActiveSheetIndex(),s=i.getSheet(k),h=n("#"+i._id+"_Ribbon_fontsize").data("ejDropDownList");n("#"+i._id+"_Ribbon_fontsize").css("width","auto");var c=n("#"+i._id+"_Ribbon_font-family").data("ejDropDownList"),u=-1,e,b=n("#"+i._id+"_Ribbon").data("ejRibbon");switch(b.getTabText(b.model.selectedItemIndex)){case"HOME":f=s._activeCell;v=i.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"wrap");w=i.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"merge");format=i.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"format");p=i.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"type");t.isNullOrUndefined(i.XLFormat)||(r=i.XLFormat.getFormatFromHashCode(format));i.isUndefined(v)&&(v=!1);n("#"+i._id+"_Ribbon_wraptext").ejToggleButton("option",{toggleState:v});i.isUndefined(w)?(n("#"+i._id+"_Ribbon_merge").removeClass("e-ss-active"),n("#"+i._id+"_Ribbon_mergedrpbtn").removeClass("e-ss-active")):(n("#"+i._id+"_Ribbon_merge").addClass("e-ss-active"),n("#"+i._id+"_Ribbon_mergedrpbtn").addClass("e-ss-active"));p&&this._numberFormat.some(function(n,t){return p===n.text.toLowerCase()?(u=t,!0):!1});t.isNullOrUndefined(o)||(o._initValue=!0,u>-1?o.option({selectedItemIndex:u}):!t.isNullOrUndefined(o.selectedIndexValue)&&o.selectedIndexValue!=0&&o.option({selectedItemIndex:0}),o._initValue=!1);r&&(t.isNullOrUndefined(r["font-size"])?u=-1:this._fontSize.some(function(n,t){return r["font-size"]===n.value?(u=t,!0):!1}),h._initValue=!0,u>-1?h.option({selectedItemIndex:u})||(u=-1):!t.isNullOrUndefined(h.selectedIndexValue)&&h.selectedIndexValue!=3&&h.option({selectedItemIndex:3}),h._initValue=!1,t.isNullOrUndefined(r["font-family"])?u=-1:this._fontFamily.some(function(n,t){return r["font-family"]===n.text.toLowerCase()?(u=t,!0):!1}),c._initValue=!0,u>-1?c.option({selectedItemIndex:u}):!t.isNullOrUndefined(c.selectedIndexValue)&&c.selectedIndexValue!=6&&c.option({selectedItemIndex:6}),c._initValue=!1,r["font-weight"]=="bold"?n("#"+i._id+"_Ribbon_bold").data("ejToggleButton").option("toggleState",!0):n("#"+i._id+"_Ribbon_bold").data("ejToggleButton").option("toggleState",!1),r["font-style"]=="italic"?n("#"+i._id+"_Ribbon_italic").data("ejToggleButton").option("toggleState",!0):n("#"+i._id+"_Ribbon_italic").data("ejToggleButton").option("toggleState",!1),r["text-decoration"]=r["text-decoration"]||"",n("#"+i._id+"_Ribbon_underline").data("ejToggleButton").option("toggleState",r["text-decoration"].indexOf("underline")!==-1),n("#"+i._id+"_Ribbon_line-through").data("ejToggleButton").option("toggleState",r["text-decoration"].indexOf("line-through")!==-1),e=n(i.element).find(".e-text-align"),t.isNullOrUndefined(e[0])||(n("#"+e[0].id).data("ejToggleButton").option("toggleState",!1)||e.removeClass("e-text-align")),t.isNullOrUndefined(r["text-align"])||(n("#"+i._id+"_Ribbon_"+r["text-align"]).data("ejToggleButton").option("toggleState",!0)||n("#"+i._id+"_Ribbon_"+r["text-align"]).addClass("e-text-align")),e=n(i.element).find(".e-vertical-align"),t.isNullOrUndefined(e[0])||(n("#"+e[0].id).data("ejToggleButton").option("toggleState",!1)||e.removeClass("e-vertical-align")),t.isNullOrUndefined(r["vertical-align"])?n("#"+i._id+"_Ribbon_bottom").data("ejToggleButton").option("toggleState",!0)||n("#"+i._id+"_Ribbon_bottom").addClass("e-vertical-align"):n("#"+i._id+"_Ribbon_"+r["vertical-align"]).data("ejToggleButton").option("toggleState",!0)||n("#"+i._id+"_Ribbon_"+r["vertical-align"]).addClass("e-vertical-align"));y=n("#"+i._id+"_Ribbon_merge").data("ejSplitButton");!t.isNullOrUndefined(y)&&this._isDirtySelect||i.model.allowLockCell&&s._isSheetProtected?y.option("enabled",!1):y.option("enabled",!0);break;case"REVIEW":i.model.allowLockCell&&(a=n("#"+i._id+"_Ribbon_LockCell").data("ejToggleButton"),l=i.XLEdit.getPropertyValue(s._activeCell.rowIndex,s._activeCell.colIndex,"isLocked"),i.isUndefined(l)&&(l=!1),a.option("toggleState",l),n("#"+i._id+"_Ribbon_ProtectSheet").data("ejToggleButton").option("toggleState",s._isSheetProtected),s._isSheetProtected?a.disable():a.enable());s._isSheetProtected&&i.model.allowLockCell||!i.model.allowComments||i.XLComment._isCommentEdit||i.XLEdit._isEdit||i._isSheetRename||i.XLComment._updateCmntRibIcons(i.getActiveCell())}}},_disableButtons:function(n,i){for(var e=-1,f,r=this.XLObj,u=0,o=n.length;u<o;u++)r.model.allowLockCell&&(r.XLEdit._isEdit||r._isSheetRename||!r.getSheet(r.getActiveSheetIndex())._isSheetProtected||(e=this._protectStateBtnIds.indexOf(n[u]))),e===-1&&(f=r.element.find("#"+r._id+"_Ribbon_"+n[u]),f.length&&!t.isNullOrUndefined(f.data(i))&&f.data(i).disable())},_enableButtons:function(n,i){for(var e=0,f,r=this.XLObj,u=0,o=n.length;u<o;u++)r.model.allowLockCell&&!r._isSheetRename&&r.getSheet(r.getActiveSheetIndex())._isSheetProtected&&(e=this._protectStateBtnIds.indexOf(n[u])),e>-1&&(f=r.element.find("#"+r._id+"_Ribbon_"+n[u]),f.length&&!t.isNullOrUndefined(f.data(i))&&f.data(i).enable())},_disableInputs:function(t,i){for(var r=0,u=t.length;r<u;r++)n("#"+this.XLObj._id+"_"+t[r]).attr("disabled",i)},_enableRibbonIcons:function(t){if(this.XLObj.model.showRibbon){var c,i=this.XLObj,u=n("#"+i._id+"_Ribbon").data("ejRibbon"),l=i.getActiveSheetIndex(),f=i.getSheet(l)._filterColl,h,r,e,o,s;c=t?t:u.model.selectedItemIndex;switch(u.getTabText(c)){case"HOME":this._enableButtons(this._homeBtnIds,"ejButton");this._enableButtons(this._toggleBtnIds,"ejToggleButton");this._enableButtons(this._ddIds,"ejDropDownList");this._enableButtons(this._cpIds,"ejColorPicker");this._enableButtons(this._splitBtnIds,"ejSplitButton");this._enableButtons(this._homeSptBtnIds,"ejSplitButton");break;case"INSERT":this._enableButtons(this._insertBtnIds,"ejButton");this._enableButtons(this._insertSptBtnIds,"ejSplitButton");break;case"DATA":this._enableButtons(this._dataBtnIds,"ejButton");this._enableButtons(this._dataSptBtnIds,"ejSplitButton");break;case"PAGE LAYOUT":this._enableButtons(this._pageLaySptBtnIds,"ejSplitButton");this._enableButtons(this._pageLayBtnIds,"ejButton");this._enableButtons(this._pageLayChckBxIds,"ejCheckBox");n("#"+u._id+"_pagesetup_viewhdrlbl").eq(0).removeClass("e-disable");n("#"+u._id+"_pagesetup_viewgrdlnlbl").eq(0).removeClass("e-disable");break;case"FORMULAS":this._enableButtons(this._formulaBtnIds,"ejButton");this._enableButtons(this._formulaSptBtnIds,"ejSplitButton");break;case"REVIEW":i.model.allowComments&&!i.XLComment._isCommentEdit&&i.XLComment._updateCmntRibIcons();this._enableButtons(this._reviewTabTglBtnIds,"ejToggleButton");break;case"OTHERS":this._enableButtons(this._othersSptBtnIds,"ejSplitButton");this._enableButtons(this._othersBtnIds,"ejButton");break;case i._getLocStr("Design"):this._enableButtons(this._contextualBtnIds,"ejButton");this._enableButtons(this._contextualCheckBoxIds,"ejCheckBox");this._disableInputs(this._contextualInputIds,!1)}for(i.XLClipboard._copyBackup.cells||i.XLClipboard._copyBackup.elem||(i.XLRibbon._disableButtons(["pastebtn"],"ejButton")||i.XLRibbon._disableButtons(["pastesbtn"],"ejSplitButton")),n.isEmptyObject(f)&&this._disableButtons(["clearfilter"],"ejButton"),s=i.getObjectKeys(f),r=0,o=s.length;r<o;r++)for(h=i.getObjectKeys(f[s[r]]),e=0,o=h.length;e<o;e++)f[s[r]][h[e]].status.indexOf("e-ssfiltered")<0&&this._disableButtons(["clearfilter"],"ejButton");i._updateUndoRedoIcons()}},_disableRibbonIcons:function(){if(this.XLObj.model.showRibbon){var t=n("#"+this.XLObj._id+"_Ribbon").data("ejRibbon");switch(t.getTabText(t.model.selectedItemIndex)){case"HOME":this._disableButtons(this._homeBtnIds,"ejButton");this._disableButtons(this._toggleBtnIds,"ejToggleButton");this._disableButtons(this._ddIds,"ejDropDownList");this._disableButtons(this._cpIds,"ejColorPicker");this._disableButtons(this._splitBtnIds,"ejSplitButton");this._disableButtons(this._homeSptBtnIds,"ejSplitButton");break;case"INSERT":this._disableButtons(this._insertBtnIds,"ejButton");this._disableButtons(this._insertSptBtnIds,"ejSplitButton");break;case"DATA":this._disableButtons(this._dataBtnIds,"ejButton");this._disableButtons(this._dataSptBtnIds,"ejSplitButton");break;case"PAGE LAYOUT":this._disableButtons(this._pageLaySptBtnIds,"ejSplitButton");this._disableButtons(this._pageLayBtnIds,"ejButton");this._disableButtons(this._pageLayChckBxIds,"ejCheckBox");n("#"+t._id+"_pagesetup_viewhdrlbl").eq(0).addClass("e-disable");n("#"+t._id+"_pagesetup_viewgrdlnlbl").eq(0).addClass("e-disable");break;case"FORMULAS":this._disableButtons(this._formulaBtnIds,"ejButton");this._disableButtons(this._formulaSptBtnIds,"ejSplitButton");break;case"REVIEW":this._disableButtons(this._cmntBtnIds,"ejButton");this._disableButtons(this._cmntTglBtnIds,"ejToggleButton");this._disableButtons(this._reviewTabTglBtnIds,"ejToggleButton");break;case"OTHERS":this._disableButtons(this._othersSptBtnIds,"ejSplitButton");this._disableButtons(this._othersBtnIds,"ejButton");break;case this.XLObj._getLocStr("Design"):this._disableButtons(this._contextualBtnIds,"ejButton");this._disableButtons(this._contextualCheckBoxIds,"ejCheckBox");this._disableInputs(this._contextualInputIds,!0)}}},_capitalize:function(n){return n[0].toUpperCase()+n.slice(1)},_generateToggleBtn:function(i,r,u,f,e,o,s,h,c,l,a,v,y){return{id:i,toolTip:this.XLObj._getLocStr(r),type:t.Ribbon.type.toggleButton,enableSeparator:c,toggleButtonSettings:{width:o,height:s,contentType:u,cssClass:l,defaultPrefixIcon:f,activePrefixIcon:y?y:f,defaultText:this.XLObj._getLocStr(r),activeText:v?this.XLObj._getLocStr(v):this.XLObj._getLocStr(r),imagePosition:a=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,click:n.proxy(this._ribbonClickHandler)},customToolTip:{title:this.XLObj._getLocStr(e),content:"<h6>"+this.XLObj._getLocStr(h)+"<\/h6>"}}},_generateBtn:function(i,r,u,f,e,o,s,h,c,l,a){return{id:i,text:this.XLObj._getLocStr(r),toolTip:this.XLObj._getLocStr(r),cssClass:a,enableSeparator:c,type:t.Ribbon.type.button,buttonSettings:{contentType:u,width:e,height:o,imagePosition:l=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,prefixIcon:f,click:n.proxy(this._ribbonClickHandler)},customToolTip:{title:this.XLObj._getLocStr(s),content:"<h6>"+this.XLObj._getLocStr(h)+"<\/h6>"}}},_generateDD:function(i,r,u,f,e,o,s,h){return{id:i,text:this.XLObj._getLocStr(r),toolTip:this.XLObj._getLocStr(r),type:t.Ribbon.type.dropDownList,dropdownSettings:{dataSource:u,value:f,popupHide:n.proxy(this._ribbonClickHandler),width:e,height:o-1,cssClass:"e-"+this.XLObj._id+"-ddl"},customToolTip:{title:this.XLObj._getLocStr(s),content:"<h6>"+this.XLObj._getLocStr(h)+"<\/h6>"}}},_generateCustomControl:function(i,r,u,f){return{type:t.Ribbon.type.custom,contentID:i,toolTip:this.XLObj._getLocStr(r),click:n.proxy(this._ribbonClickHandler),change:n.proxy(this._ribbonClickHandler),customToolTip:{title:this.XLObj._getLocStr(u),content:"<h6>"+this.XLObj._getLocStr(f)+"<\/h6>"}}},_generateSplitBtn:function(i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){return{id:i,toolTip:this.XLObj._getLocStr(r),text:this.XLObj._getLocStr(r),type:t.Ribbon.type.splitButton,cssClass:y+" e-"+this.XLObj._id+"-spltbtn",enableSeparator:s,splitButtonSettings:{contentType:u,targetID:f,arrowPosition:l=="bottom"?t.ArrowPosition.Bottom:t.ArrowPosition.Right,imagePosition:a=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,buttonMode:v=="dropdown"?t.ButtonMode.Dropdown:t.ButtonMode.Split,fields:e,prefixIcon:o,click:n.proxy(this._ribbonClickHandler),itemSelected:n.proxy(this._ribbonClickHandler),height:c,width:h,beforeOpen:n.proxy(this._splitBeforeOpen,this,i),close:i==="inssbtn"||i==="delsbtn"||i==="validationsbtn"||i==="pastesbtn"?n.proxy(this._splitbtnClose,this,i):null},customToolTip:{title:this.XLObj._getLocStr(p),content:"<h6>"+this.XLObj._getLocStr(w)+"<\/h6>"}}},_splitBeforeOpen:function(n,t){var i=this.XLObj;n==="sortfilter"?this._sfbeforeOpen(t):n==="inssbtn"||n==="delsbtn"?this._insdelbeforOpen(t):n==="fPane"?this._fpbeforeOpen(t):n==="cElement"?this._celementpbeforeOpen(t):n==="validationsbtn"||n==="pastesbtn"?this._validpasteOpen(t):n==="clear"&&this._clearbeforeOpen(t)},_splitbtnClose:function(n){this.XLObj.element.find("#"+this.XLObj._id+"_Ribbon_"+n).parents("div.e-controlpadding").siblings().children("button").removeClass("e-active")},_fpbeforeOpen:function(){var t=this.XLObj,r=t.getActiveSheetIndex(),u=n("#"+t._id+"_Ribbon_FPane").data("ejMenu"),i=u.model.fields.dataSource.slice(0);t.getFrozenRows(r)>0||t.getFrozenColumns(r)>0?(i[0].id="unfreezePanes",i[0].text=t._getLocStr("unfreezePanes")):(i[0].id="freezePanes",i[0].text=t._getLocStr("freezePanes"));u.option("fields",{id:"id",dataSource:i,parentId:"parentId"})},_sfbeforeOpen:function(){var t=this.XLObj,i=n("#"+t._id+"_Ribbon_SortFilter").data("ejMenu");t.model.allowFiltering||i.disableItemByID("Filter");t.model.allowSorting||(i.disableItemByID("SortAtoZ"),i.disableItemByID("SortZtoA"));this._changeClrFltrStatus(i,"menu",t.getActiveCell())},_validpasteOpen:function(n){var t=this.XLObj;n.model.targetID===t._id+"_Ribbon_Validation"?t.element.find("#"+t._id+"_Ribbon_validationbtn").addClass("e-active"):t.element.find("#"+t._id+"_Ribbon_pastebtn").addClass("e-active")},_insdelbeforOpen:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_Ins").data("ejMenu"),u=n("#"+i._id+"_Ribbon_Del").data("ejMenu");t.model.targetID===i._id+"_Ribbon_Ins"?i.element.find("#"+i._id+"_Ribbon_insbtn").addClass("e-active"):i.element.find("#"+i._id+"_Ribbon_delbtn").addClass("e-active");i.element.find(".e-colselected").length?(r.disableItemByID("InsertSheetRows"),u.disableItemByID("DeleteSheetRows")):(r.enableItemByID("InsertSheetRows"),u.enableItemByID("DeleteSheetRows"));i.element.find(".e-rowselected").length?(r.disableItemByID("InsertSheetColumns"),u.disableItemByID("DeleteSheetColumns")):(r.enableItemByID("InsertSheetColumns"),u.enableItemByID("DeleteSheetColumns"));i.model.exportSettings.password?(r.disableItemByID("InsertSheet"),u.disableItemByID("DeleteSheet")):(r.enableItemByID("InsertSheet"),u.enableItemByID("DeleteSheet"))},_celementpbeforeOpen:function(){var t=this.XLObj;for(chartEle=n("#"+t._id+"_chart").val(),chType=t.XLChart._getShapeObj(chartEle,"chart").type,cEleMenuObj=n("#"+t._id+"_Ribbon_CElement").data("ejMenu"),pieChart=["Axes","AxisTitle","Gridline"],radarChart=["AxisTitle","PMinorH","PMinorV"],menuEle=["Axes","AxisTitle","Gridline","PMinorH","PMinorV"],i,len=0,i=0,len=menuEle.length;i<len;i++)cEleMenuObj.enableItemByID(menuEle[i]);if(chType==="pie"||chType==="doughnut")for(i=0,len=pieChart.length;i<len;i++)cEleMenuObj.disableItemByID(pieChart[i]);else if(chType==="radar")for(i=0,len=radarChart.length;i<len;i++)cEleMenuObj.disableItemByID(radarChart[i])},_clearbeforeOpen:function(){var i=this.XLObj,t=0,u=n("#"+i._id+"_Ribbon_Clear").data("ejMenu"),r=["Clear_Hyperlinks","Clear_Comments"];if(i.model.allowLockCell)if(i.getSheet(i.getActiveSheetIndex())._isSheetProtected)while(t<r.length)u.disableItemByID(r[t]),t++;else while(t<r.length)u.enableItemByID(r[t]),t++},_changeClrFltrStatus:function(n,t){var o=this.XLObj,s=o.getActiveSheetIndex(),i,r,f=o.getSheet(s)._filterColl,u,e;for(t==="menu"?n.disableItemByID("ClearFilter"):n.disable(),u=o.getObjectKeys(f),i=u.length-1;i>=0;i--)for(e=o.getObjectKeys(f[u[i]]),r=e.length-1;r>=0;r--)if(f[u[i]][e[r]].status.indexOf("filtered")>-1)if(0){if(!f[u[i]][e[r]].isTable){t==="menu"?n.enableItemByID("ClearFilter"):n.enable();break}}else if(!f[u[i]][e[r]].isTable){t==="menu"?n.enableItemByID("ClearFilter"):n.enable();break}},_onControlCreated:function(){var u,f,i=this.XLObj,t=i._id,r={height:154,width:163,text:i._getLocStr("BlankWorkbook"),contentType:"textandimage",imagePosition:"imagetop",prefixIcon:"e-ss-blank",click:n.proxy(this._bSBtnClickHandler)};u=(i.isNumber(i.model.scrollSettings.height)?i.model.scrollSettings.height:i.element.height())-(n("#"+t+"_Ribbon").height()-i.element.find(".e-ribbon .e-content").eq(0).height()+i._formulaHeight)-40;f=i.isNumber(i.model.scrollSettings.width)?i.model.scrollSettings.width-40:i.element.width()-40;n("#"+t+"_bstab_new_blank").ejButton(r);delete r.text;r.height=r.width=72;r.prefixIcon="e-ss-exportxl";n("#"+t+"_bstab_saveas_excel").ejButton(r);r.prefixIcon="e-ss-exportcsv";n("#"+t+"_bstab_saveas_csv").ejButton(r);r.prefixIcon="e-ss-print";n("#"+t+"_bstab_print_sheet").ejButton(r);r.prefixIcon="e-ss-printselected";n("#"+t+"_bstab_print_selected").ejButton(r);this._hideRibbonElem();n("#"+t+"_Ribbon_background-color").ejColorPicker({value:"#FFFF00",modelType:"palette",showSwitcher:!1,cssClass:"e-ss-colorpicker",toolIcon:"e-ss-backgroundcolor",open:n.proxy(this._colorPickerHandler,this,"Ribbon_background-color"),change:n.proxy(this._colorPickerHandler,this,"Ribbon_background-color"),select:n.proxy(this._cpClickHandler,this,"Ribbon_background-color")});n("#"+t+"_Ribbon_color").ejColorPicker({value:"#FF0000",modelType:"palette",showSwitcher:!1,cssClass:"e-ss-colorpicker",toolIcon:"e-ss-fontcolor",open:n.proxy(this._colorPickerHandler,this,"Ribbon_color"),change:n.proxy(this._colorPickerHandler,this,"Ribbon_color"),select:n.proxy(this._cpClickHandler,this,"Ribbon_color")});n("#"+t+"_Ribbon_BorderColor").ejColorPicker({modelType:"palette",presetType:"basic",cssClass:"e-ss-colorpicker e-ss-menuclrpkr",change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_BorderColorWrapper").hide();n("#"+t+"_Ribbon_BorderColor_popup").css({"padding-left":"10px",width:"197px",display:"block"});n("#"+t+"_Ribbon_BorderCP").ejColorPicker({value:"#278787",displayInline:!0,modelType:"picker"});n("#"+t+"_Ribbon_BorderCP_Presets").hide();n("#"+t+"_Ribbon_Border").width(200);n("#"+t+"_CFormat").width(200);n("#"+t+"_Ribbon_Border").addClass("e-spreadsheet e-border");n("#"+t+"_Ribbon_color_Presets").css("width","119px");n("#"+t+"_Ribbon_background-color_Presets").css("width","119px");n("#"+t+"_Ribbon_pagesetupleft").show();n("#"+t+"_Ribbon_Vheading").ejCheckBox({change:n.proxy(this._ribbonClickHandler),checked:!0});n("#"+t+"_Ribbon_Vgridlines").ejCheckBox({change:n.proxy(this._ribbonClickHandler),checked:!0});n("#"+t+"_Ribbon_tsofirstcolumn").ejCheckBox({change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_tsolastcolumn").ejCheckBox({change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_tsototalrow").ejCheckBox({change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_tsofiltercolumn").ejCheckBox({change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_chartwidth").ejNumericTextbox({name:"numeric",value:5,minValue:0,maxValue:f,decimalPlaces:1,incrementStep:5,change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_chartheight").ejNumericTextbox({name:"numeric",value:5,minValue:0,maxValue:u,decimalPlaces:1,incrementStep:5,change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_pictureheight").ejNumericTextbox({name:"numeric",value:100,minValue:25,incrementStep:5,change:n.proxy(this._pictureSizeChange,this,"picturewidth")});n("#"+t+"_picturewidth").ejNumericTextbox({name:"numeric",value:100,minValue:25,incrementStep:5,change:n.proxy(this._pictureSizeChange,this,"pictureheight")});n("#"+t+"_Ribbon_PictureColor").ejColorPicker({modelType:"palette",presetType:"basic",cssClass:"e-ss-colorpicker e-ss-menuclrpkr",change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_PictureColorWrapper").hide();n("#"+t+"_Ribbon_PictureColor_popup").css({"padding-left":"10px",width:"197px",display:"block"});!i.model.allowInsert&&i.model.scrollSettings.allowScrolling&&(this._disableButtons(["inssbtn"],"ejSplitButton"),this._disableButtons(["insbtn"],"ejButton"));!i.model.allowDelete&&i.model.scrollSettings.allowScrolling&&(this._disableButtons(["delsbtn"],"ejSplitButton"),this._disableButtons(["delbtn"],"ejButton"));n("#"+t+"_Ribbon_Validation").width(160);this._disableButtons(["pastebtn"],"ejButton");this._disableButtons(["pastesbtn","useinformula"],"ejSplitButton");n("#"+t+"_Ribbon_background-color_popup").find(".e-buttons, .e-button").hide();n("#"+t+"_Ribbon_color_popup").find(".e-buttons, .e-button").hide()},_hideRibbonElem:function(){var r=this.XLObj,u=n("#"+r._id+"_Ribbon").ejRibbon("instance"),t=r.model,i=u.element;t.allowAutoSum||t.allowFiltering||t.allowUndoRedo||t.allowSorting||t.allowClipboard||t.allowFormatPainter||t.allowCellFormatting||t.allowMerging||t.allowWrap||t.allowConditionalFormats||t.allowFormatAsTable||u.hideTab("HOME");t.allowFormatAsTable||t.allowPictures||t.allowHyperlink||t.allowCharts||u.hideTab("INSERT");t.allowDataValidation||t.allowFiltering||t.allowSorting||u.hideTab("DATA");t.allowPrinting||u.hideTab("PAGELAYOUT");t.allowComments||u.hideTab("REVIEW");t.allowFreezing||t.allowInsert||t.allowDelete||t.allowSearching||u.hideTab("OTHERS");t.allowClipboard||t.allowFormatPainter?t.allowFormatPainter?t.allowClipboard||(i.find("#"+r._id+"_Ribbon_home_Clipboard_1").hide(),i.find("#"+r._id+"_Ribbon_home_Clipboard_cut").hide(),i.find("#"+r._id+"_Ribbon_home_Clipboard_copy").hide()):i.find("#"+r._id+"_Ribbon_home_Clipboard_formatpainter").hide():i.find("#"+r._id+"_Ribbon_home_Clipboard").hide();t.allowCellFormatting||(i.find("#"+r._id+"_Ribbon_home_Font").hide(),i.find("#"+r._id+"_Ribbon_home_Number").hide(),i.find("#"+r._id+"_Ribbon_home_Alignment_top").hide(),i.find("#"+r._id+"_Ribbon_home_Alignment_middle").hide(),i.find("#"+r._id+"_Ribbon_home_Alignment_bottom").hide(),i.find("#"+r._id+"_Ribbon_separator_bottom").hide(),i.find("#"+r._id+"_Ribbon_home_Alignment_left").hide(),i.find("#"+r._id+"_Ribbon_home_Alignment_center").hide(),i.find("#"+r._id+"_Ribbon_home_Alignment_right").hide(),i.find("#"+r._id+"_Ribbon_separator_right").hide(),i.find("#"+r._id+"_Ribbon_home_Styles_cellstyles").hide(),t.allowConditionalFormats||t.allowFormatAsTable||i.find("#"+r._id+"_Ribbon_home_Styles").hide());t.allowCellFormatting&&(t.formatSettings.allowFontFamily||i.find("#"+r._id+"_Ribbon_home_Font_font-family").hide(),t.formatSettings.allowDecimalPlaces||(i.find("#"+r._id+"_Ribbon_home_Number_increment").hide(),i.find("#"+r._id+"_Ribbon_home_Number_decrement").hide(),i.find("#"+r._id+"_Ribbon_separator_usegrouping").hide()),t.formatSettings.allowCellBorder||(i.find("#"+r._id+"_Ribbon_home_Font_border").hide(),i.find("#"+r._id+"_Ribbon_home_Font_border").hide()));t.allowMerging||i.find("#"+r._id+"_Ribbon_home_Alignment_merge").hide();t.allowWrap||i.find("#"+r._id+"_Ribbon_home_Alignment_wraptext").hide();t.allowUndoRedo||i.find("#"+r._id+"_Ribbon_home_Actions").hide();t.allowPivotTable||t.allowFormatAsTable?t.allowPivotTable?t.allowFormatAsTable||(i.find("#"+r._id+"_Ribbon_home_Styles_formatastable").hide(),i.find("#"+r._id+"_Ribbon_insert_Tables_table").hide()):i.find("#"+r._id+"_Ribbon_insert_Tables_pivotTable").hide():i.find("#"+r._id+"_Ribbon_insert_Tables").hide();t.allowConditionalFormats||t.allowFormatAsTable||t.allowCellFormatting||i.find("#"+r._id+"_Ribbon_home_Styles").hide();t.allowConditionalFormats||i.find("#"+r._id+"_Ribbon_home_Styles_cFormat").hide();t.allowEditing&&(t.allowAutoSum||i.find("#"+r._id+"_Ribbon_home_Editing_autosum").hide(),t.allowSorting||t.allowFiltering||i.find("#"+r._id+"_Ribbon_home_Editing_1").hide());t.pictureSettings.allowPictures||i.find("#"+r._id+"_Ribbon_insert_Illustrations").hide();t.allowHyperlink||i.find("#"+r._id+"_Ribbon_insert_Links").hide();t.allowCharts||i.find("#"+r._id+"_Ribbon_insert_Charts").hide();t.allowFiltering||i.find("#"+r._id+"_Ribbon_data_SortFilter_2").hide();t.allowSorting||i.find("#"+r._id+"_Ribbon_data_SortFilter_1").hide();t.allowDataValidation||i.find("#"+r._id+"_Ribbon_data_DataTools").hide();t.printSettings.allowPrinting||(i.find("#"+r._id+"_Ribbon_pagelayout_Print").hide(),i.find("#print_backStageTab").hide());t.printSettings.allowPageSize||i.find("#"+r._id+"_Ribbon_pagelayout_PageLayout").hide();t.allowLockCell||(i.find(".e-ssr-protectsheetbtn").hide(),i.find(".e-ssr-lockbtn").hide());t.allowComments||t.allowLockCell||u.hideTab("REVIEW");t.allowComments||i.find("#"+r._id+"_Ribbon_review_Comments").hide();(!t.allowFreezing||t.scrollSettings.allowVirtualScrolling)&&i.find("#"+r._id+"_Ribbon_others_Window").hide();t.allowFormulaBar||r.hideFormulaBar();t.allowInsert||t.allowDelete?t.allowInsert?t.allowDelete||i.find("#"+r._id+"_Ribbon_others_Cells_2").hide():i.find("#"+r._id+"_Ribbon_others_Cells_1").hide():i.find("#"+r._id+"_Ribbon_others_Cells").hide();t.allowFiltering||t.allowSorting||i.find("#"+r._id+"_Ribbon_data_Sort").hide();t.allowSearching||i.find("#"+r._id+"_Ribbon_others_Editing").hide();t.allowFormatAsTable||t.allowPivotTable||i.find("#"+r._id+"_Ribbon_insert_Tables").hide();t.allowImport||i.find("#open_backStageBtn").hide();t.exportSettings.allowExporting||i.find("#saveas_backStageTab").hide()},_pictureSizeChange:function(t,i){var u=this.XLObj,f,r=u.element.find(".e-ss-activeimg"),e={sheetIndex:u.getActiveSheetIndex(),reqType:"shape",shapeType:"picture",action:"picturesize",name:t,id:n(r).attr("id"),prev:{},cur:{}};u._shapeChange||u.XLRibbon._isSetModel||(e.prev={width:r.width(),height:r.height()},t==="pictureheight"?(f=parseInt(r.height()*i.value/r.width()),r.css({width:i.value,height:f}),e.cur={width:i.value,height:f}):(f=parseInt(r.width()*i.value/r.height()),r.css({height:i.value,width:f}),e.cur={height:i.value,width:f}),u.XLRibbon._isSetModel=!0,n("#"+u._id+"_"+t).ejNumericTextbox("option",{value:f}),u.XLRibbon._isSetModel=!1,u._completeAction(e),u.XLShape._updateShapeObj(r[0]))},_chartTypeOk:function(){var r=this.XLObj,o=r.element.find("#"+r._id+"_chart").val(),u=n("#"+o).data("ejChart"),e,t,f,s,h,i;f=n("#"+r._id+"_allchart").find(".e-chartselect")[0].classList[1];t=f.split("e-dlg")[1].split("chart");s=["e-dlgcolumnchart4","e-dlgcolumnchart5","e-dlgcolumnchart6","e-dlgbarchart4","e-dlgbarchart5","e-dlgbarchart6","e-dlgpiechart2"];h=["e-dlgstockchart2","e-dlglinechart2","dlgradarchart2"];i={type:t[0],enable3D:!1,marker:{visible:!1}};(t[0]==="column"||t[0]==="bar"||t[0]==="area")&&(t[1]==="1"||t[1]==="4"?i.type=t[0]:t[1]==="2"||t[1]==="5"?i.type="stacking"+t[0]:(t[1]==="3"||t[1]==="6")&&(i.type="stacking"+t[0]+"100"));s.indexOf(f)>-1&&(i.enable3D=!0);h.indexOf(f)>-1&&(i.marker={visible:!0});f==="e-dlgpiechart3"&&(i.type="doughnut");e={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:"chartType",chartId:o};e.prev={chartType:u.model.series[0].type,enable3D:u.model.enable3D,marker:u.model.series[0].marker.visible};r.XLChart.refreshChart(o,i);e.cur={chartType:u.model.series[0].type,enable3D:u.model.enable3D,marker:u.model.series[0].marker.visible};n("#"+r._id+"_charttypedlg").ejDialog("close");r._completeAction(e)},_chartTypeCancel:function(){var t=this.XLObj;n("#"+t._id+"_charttypedlg").ejDialog("close");t.setSheetFocus()},_chartType:function(i,r,u,f,e,o){var c,s,a=0,l=this.XLObj,v=l._getLocStr(i).split("/"),y=i.toLowerCase(),h;for(c=t.buildTag("div#"+l._id+"_Ribbon_"+i+".e-ss-dialog","",{width:"auto",padding:"4px"}),c.append("<div class='e-chartheader'><span>"+v[0]+"<\/span><\/div>"),h=t.buildTag("div.e-chartcontent"),s=0;s<r;s++)h.append("<div class='e-chartcell e-"+y+(s+1)+"' title="+l._getLocStr(o[s])+"><\/div>"),n(h).children().eq(s).data({type:e[s],enable3D:!1,marker:{visible:!1}}),s===u&&(c.append(h).append("<div class='e-chartheader'><span>"+v[1]+"<\/span><\/div>"),h=t.buildTag("div.e-chartcontent")),s>f&&(n(h).children().eq(a).data({type:e[s],enable3D:!0,marker:{visible:!1}}),a++);c.append(h);h=n(c).find(".e-"+y+"2");(i==="StockChart"||i==="LineChart")&&h.data({marker:{visible:!0}});i==="PieChart"&&h.data({enable3D:!0});l.element.append(c)},autoSum:function(i,r){var nt;if(this.XLObj.model.allowAutoSum){var f=this.XLObj,k=f.XLEdit,s=f.getActiveSheetIndex(),d=f.getActiveCell(s),tt=!1,a;if(!t.isNullOrUndefined(d)){var l,g,p=f.getActiveCell(s),w,y=f.getRangeIndices(r),o=f.XLSelection._getSelectedRange({rowIndex:y[0],colIndex:y[1]},{rowIndex:y[2],colIndex:y[3]}),c=o.length-1,it=o[c].rowIndex-o[0].rowIndex,rt=o[c].colIndex-o[0].colIndex,v={sheetIndex:s,range:r,reqType:"auto-sum",oprType:i,updCell:[]},u,e,b,ut=f.getRangeData([o[0].rowIndex,o[0].colIndex,o[c].rowIndex,o[c].colIndex],!0).length,h=f._dataContainer.sheets[s];if(c!==0&&ut)if(it===0&&rt>0){for(w=f._getAlphaRange(s,o[0].rowIndex,o[0].colIndex,o[c].rowIndex,o[c].colIndex),u=o[c].rowIndex,e=o[c].colIndex+1,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2");!t.isNullOrUndefined(a)&&a!="";)e++,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2");e===f.getSheet(s).colCount&&f.XLScroll._createNewColumn(s,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert");f._isUndoRedo||v.updCell.push({rowIndex:u,colIndex:e,pObj:{},pValue:t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,e,"value2"))?"":f.XLEdit.getPropertyValue(u,e,"value2")});t.isNullOrUndefined(h[u])&&(h[u]={});t.isNullOrUndefined(h[u][e])&&(h[u][e]={});f._isUndoRedo||n.extend(!0,v.updCell[0].pObj,h[u][e]);f._isRowViewable(s,u)&&(b=f.getCell(u,e,s),b.addClass("e-ralign"));k.updateCellValue({rowIndex:u,colIndex:e},"="+i+"("+w+")");f._autosumFormatUpdate(f.getRangeData([o[0].rowIndex,o[0].colIndex,o[0].rowIndex,o[0].colIndex])[0],[u,e,u,e],!1,!1)}else{for(g=o[c].colIndex-o[0].colIndex,u=o[c].rowIndex+1,l=0;l<=g;l++)for(e=o[l].colIndex,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2"),nt=u;!t.isNullOrUndefined(a)&&a!="";)u++,nt=u,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2");for(l=0;l<=g;l++)e=o[l].colIndex,u=nt,w=f._getAlphaRange(s,o[0].rowIndex,e,o[c].rowIndex,e),o[c].rowIndex===f.getSheet(s).rowCount-1&&f.XLScroll._createNewRow(s,-1,-1,"insert"),f._isUndoRedo||v.updCell.push({rowIndex:u,colIndex:e,pObj:{},pValue:t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,e,"value2"))?"":f.XLEdit.getPropertyValue(u,e,"value2")}),t.isNullOrUndefined(h[u])&&(h[u]={}),t.isNullOrUndefined(h[u][e])&&(h[u][e]={}),f._isUndoRedo||n.extend(!0,v.updCell[l].pObj,h[u][e]),f._isRowViewable(s,u)&&(b=f.getCell(u,e,s),b.addClass("e-ralign")),k.updateCellValue({rowIndex:u,colIndex:e},"="+i+"("+w+")"),f._autosumFormatUpdate(f.getRangeData([o[0].rowIndex,o[l].colIndex,o[0].rowIndex,o[l].colIndex])[0],[u,e,u,e],!1,!1)}else u=d.rowIndex,e=d.colIndex,v.updCell.push({rowIndex:u,colIndex:e,pObj:{},pValue:t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,e,"value2"))?"":f.XLEdit.getPropertyValue(u,e,"value2")}),t.isNullOrUndefined(h[u])&&(h[u]={}),t.isNullOrUndefined(h[u][e])&&(h[u][e]={}),n.extend(!0,v.updCell[0].pObj,h[u][e]),f._isRowViewable(s,p.rowIndex)||f.XLScroll._scrollSelectedPosition(s,p),k.editCell(p.rowIndex,p.colIndex,!0),f.model.allowFormulaBar&&f._getInputBox().val("="+i+"()"),f._isRowViewable(s,u)&&(f.XLEdit._editElem.text("="+i+"()"),f.XLEdit._editElem.focusEnd()),tt=!0;f.performSelection({rowIndex:y[0],colIndex:y[1]},{rowIndex:u,colIndex:e});f._isUndoRedo||tt||f._completeAction(v)}}},_openNameManagerDlg:function(){var i=this.XLObj,t=n("#"+i._id+"_nmgrid").data("ejGrid");t.getContentTable().find("td").addClass("e-ss-emptyrecord");t.model.dataSource.length<1?t.getContentTable().find("td").addClass("e-ss-emptyrecord"):t.getContentTable().find(".e-ss-emptyrecord").removeClass("e-ss-emptyrecord");n("#"+i._id+"_nmdlg").ejDialog("open");n("#"+i._id+"_nmgrid").focus()},_openFATDlg:function(){var t=this.XLObj;n("#"+t._id+"_fatnamedlg").ejDialog("open");n("#"+t._id+"_fatheader").ejCheckBox("option","checked",!1);n("#"+t._id+"_fatname").val("Table"+(t.getObjectLength(t.getSheet(t.getActiveSheetIndex())._tableManager)+1)).focus().setInputPos(n("#"+t._id+"_fatname").val().length);t._tableCnt++},_dirtySelect:function(t){var l,r=this.XLObj,o=r.getActiveSheetIndex(),s=n("#"+r._id+"_contextMenuCell").data("ejMenu"),a=["sortfilter","clear"],v=["formatastable"],y=["convertorange","filter","clearfilter"],p=["table"],b=r.getActiveCellElem(o),g=n("#"+r._id+"_contextMenuColumnHeader").data("ejMenu"),nt=n("#"+r._id+"_contextMenuRowHeader").data("ejMenu"),k,u,d,f=r.getSheet(o).filterSettings.tableRange,h=!1,c=!1,w=n("#"+r._id+"_Ribbon_merge").data("ejSplitButton"),e,i;if(!r.model.allowLockCell||!r.getSheet(o)._isSheetProtected){if(u=r.getSheet(o)._selectedCells,t.length>0)for(d=n(t[t.length-1]).parent().index(),k=t[t.length-1].cellIndex,i=0,e=f.length;i<e;i++)if(f[i].startRow-1<=u[0].rowIndex&&f[i].endRow>=u[u.length-1].rowIndex&&f[i].multifilterIdx[0]<=u[0].colIndex&&f[i].multifilterIdx[f[i].multifilterIdx.length-1]>=u[u.length-1].colIndex){h=!0;break}else if(!(f[i].endRow<u[0].rowIndex||f[i].startRow-1>u[u.length-1].rowIndex||f[i].multifilterIdx[f[i].multifilterIdx.length-1]<u[0].colIndex||f[i].multifilterIdx[0]>u[u.length-1].colIndex)){c=!0;h=!0;break}if(c?(this._disableButtons(a,"ejSplitButton"),r._hasClass(b[0],"e-table")||this._disableButtons(v,"ejSplitButton"),this._disableButtons(y,"ejButton"),s&&s.disableItemByID("Sort"),w.option("enabled",!1)):(this._enableButtons(a,"ejSplitButton"),this._enableButtons(v,"ejSplitButton"),this._enableButtons(y,"ejButton"),w.option("enabled",!0),s&&r.model.allowSorting&&s.enableItemByID("Sort")),h?(this._disableButtons(p,"ejButton"),this._isDirtySelect=!0):(this._enableButtons(p,"ejButton"),this._isDirtySelect=!1),l=r._getContent(o).find(".e-ssfiltered, .e-ssfiltered-asc, .e-ssfiltered-dsc"),e=l.length,!c)if(e>0){for(i=0;i<e;i++)if(l[i].parentNode.className.indexOf("e-table")>-1)c?this._enableButtons(["clearfilter"],"ejButton"):this._disableButtons(["clearfilter"],"ejButton");else if(this._enableButtons(["clearfilter"],"ejButton"),h)return}else this._disableButtons(["clearfilter"],"ejButton")}},_onGroupExpander:function(n){var t=this.XLObj;switch(n.target.id){case t._id+"_Ribbon_Number_e-groupexpander":t.XLCellFrmtDlg._initFormatCellDlg()}}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.freezepane=function(n){this.XLObj=n;this._isFirstRow=!1;this._isFirstColumn=!1;this._hiddenCells={};this._frozenColsOverflow=[]};t.spreadsheetFeatures.freezepane.prototype={freezeTopRow:function(){var n=this.XLObj,t=n.getSheet(n.getActiveSheetIndex());!n.model.scrollSettings.allowVirtualScrolling&&n.model.allowFreezing&&(this._getFirstFreezeRow(),this._isFirstRow=!0,t._firstRow.idx===0&&(t._firstRow={idx:1,value:t._rowHeightCollection[1]}),this.freezeRows(t._firstRow.idx))},_getFirstFreezeRow:function(){var i=this.XLObj,u=i.getActiveSheetIndex(),t=i.getSheet(u),r=t._rowHeightCollection,f=i._getContent(u).find(".e-content").scrollTop(),n,e;if(f===0)t._firstRow={idx:1,value:r[1]};else for(n=0,e=r.length;n<e;n++)if(r[n]>=f){t._firstRow={idx:n+1,value:r[n+1]};break}t._firstRow.idx!==0&&i.XLScroll._getRowHeights(u,t._firstRow.idx)},freezeLeftColumn:function(){var n=this.XLObj,t=n.getSheet(n.getActiveSheetIndex());!n.model.scrollSettings.allowVirtualScrolling&&n.model.allowFreezing&&(this._getFirstFreezeColumn(),this._isFirstColumn=!0,t._firstCol.idx===0&&(t._firstCol={idx:1,value:t._colWidthCollection[1]}),this.freezeColumns(t._firstCol.idx))},_getFirstFreezeColumn:function(){var i=this.XLObj,u=i.getActiveSheetIndex(),r=i.getSheet(u),t=r._colWidthCollection,f=i._getContent(u).find(".e-content").scrollLeft(),n,e;if(f===0)r._firstCol={idx:1,value:t[1]};else for(n=0,e=t.length;n<e;n++)if(t[n]>=f){r._firstCol={idx:n+1,value:t[n+1]};break}},freezeRows:function(n){var t=this.XLObj,u,e;if(!t.model.scrollSettings.allowVirtualScrolling&&t.model.allowFreezing){this._isFirstRow||this._getFirstFreezeRow();var i=t.getActiveSheetIndex(),r=t.getSheet(i),o=t.model.sheets[i]._firstRow,s=r.rowsHeightCollection,f=t.XLScroll._vScroller(i);for((t.getFrozenRows(i)>0||t.getFrozenColumns(i)>0)&&this.unfreezePanes(),r._frozenHeight=0,f.element.find(".e-vhandle").css("top",0),f.value(0),n>0&&(t.setFrozenRows(n,i),t.XLScroll._getRowHeights(i,n),r._currentTopFrozenRow=n,this._applyFreeze(i,n,0)),u=0,e=o.idx;u<e;u++)r._frozenHeight+=s[u];t.XLScroll._refreshScroller(i,"refresh","vertical")}},freezeColumns:function(n){var t=this.XLObj,u,e;if(!t.model.scrollSettings.allowVirtualScrolling&&t.model.allowFreezing){this._isFirstColumn||this._getFirstFreezeColumn();var i=t.getActiveSheetIndex(),r=t.getSheet(i),o=r._firstCol,f=t.XLScroll._hScroller(i),s=r.columnsWidthCollection;if((t.getFrozenRows(i)>0||t.getFrozenColumns(i)>0)&&this.unfreezePanes(i),t.XLScroll._getColWidths(i,n),r._frozenWidth=0,f.element.find(".e-hhandle").css("left",0),f.value(0),n>0)for(t.setFrozenColumns(n,i),r._currentLeftFrozenColumn=n,this._applyFreeze(i,0,n),u=0,e=o.idx;u<e;u++)r._frozenWidth+=s[u];t.XLScroll._refreshScroller(i,"refresh","horizontal")}},freezePanes:function(n){var r=this.XLObj;if(!r.model.scrollSettings.allowVirtualScrolling&&r.model.allowFreezing){var h,c,i,s,u=r.getActiveSheetIndex(),f=r.getSheet(u),b=f.columnsWidthCollection,k=f.rowsHeightCollection,l=f._rowHeightCollection,a=f._colWidthCollection,v,y,p,w,e=0,o=0;if(this._isFirstRow=!1,this._isFirstColumn=!1,(r.getFrozenRows(u)>0||r.getFrozenColumns(u)>0)&&this.unfreezePanes(u),h=r.XLScroll._vScroller(u),c=r.XLScroll._hScroller(u),t.isNullOrUndefined(n)||(typeof n=="string"?(n=r.getRangeIndices(n),e=n[0],o=n[1]):(e=n.rowIndex,o=n.colIndex)),e>0&&o>0){for(f._frozenHeight=0,f._frozenWidth=0,v=h.element.find(".e-vhandle")[0].offsetTop*h._scrollData.onePx,i=0,s=l.length;i<s;i++)if(l[i]>=v){p=f._firstRow={idx:i,value:l[i]};break}for(y=c.element.find(".e-hhandle")[0].offsetLeft*c._scrollData.onePx,i=0,s=a.length;i<s;i++)if(a[i]>=y){w=f._firstCol={idx:i,value:a[i]};break}for(i=0,s=p.idx;i<s;i++)f._frozenHeight+=k[i];for(i=0,s=w.idx;i<s;i++)f._frozenWidth+=b[i];r.setFrozenColumns(o,u);r.setFrozenRows(e,u);f._currentTopFrozenRow=e;f._currentLeftFrozenColumn=o;r.XLScroll._getRowHeights(u,e);r.XLScroll._getColWidths(u,o);this._applyFreeze(u,e,o);r.XLScroll._refreshScroller(u,"refresh","all");h.element.find(".e-vhandle").css("top",0);h.value(0);c.element.find(".e-hhandle").css("left",0);c.value(0)}else e<1&&o>0?this.freezeColumns(o):o<1&&e>0&&this.freezeRows(e)}},_applyFreeze:function(t,i,r){var u=this.XLObj,o,s="",h="",c="",l="",f,a=u._getContent(t).find(".e-table").width(),e,v=u._getContent(t).find(".e-table").height(),y=u.getFrozenRows(t),p=u.getFrozenColumns(t);this._isFirstColumn||this._isFirstRow?(y&&(e=u.model.sheets[t]._firstRow.value),p&&(f=u.model.sheets[t]._firstCol.value)):(o=u.getCell(i,r),f=o[0].offsetLeft,e=o[0].offsetTop);y&&(s=String.format("<div class=\"{0}\" style='width:{1}px; left: {2}px; top: {3}px;'><\/div>","e-frow",a,0,e),h=String.format("<div class=\"{0}\" style='width:{1}px; left: {2}px; top: {3}px;'><\/div>","e-frow",a,0,e),u._getContent(t).find(".e-content").append(n(s)),u._getJSSheetRowHeaderContent(t).append(n(h)));p&&(c=String.format("<div class=\"{0}\" style='height:{1}px; left: {2}px; top: {3}px;'><\/div>","e-fcol",v,f,0),l=String.format("<div class=\"{0}\" style='height:{1}px; left: {2}px; top: {3}px;'><\/div>","e-fcol",v,f,0),u._getContent(t).find(".e-content").append(n(c)),u._getJSSheetHeader(t).find(".e-headercontent").append(n(l)));u.setSheetFocus()},unfreezePanes:function(){var t=this.XLObj,i=t.getActiveSheetIndex(),r=t.getSheet(i),o=t.getRows(i),u=t._getSelectedCells(i),s=t._getContent(i),h=t._getJSSheetHeader(i),f,e;!t.model.scrollSettings.allowVirtualScrolling&&t.model.allowFreezing&&(f=t.XLScroll._vScroller(i),e=t.XLScroll._hScroller(i),f.element.find(".e-vhandle").css("top",0),f.value(0),e.element.find(".e-hhandle").css("left",0),e.value(0),t.setFrozenColumns(0,i),t.setFrozenRows(0,i),s.find(".e-fcol, .e-frow").remove(),t._getJSSheetRowHeaderContent(i).find(".e-frow").remove(),h.find(".e-fcol").remove(),n(o[0]).removeClass("e-fr-hide"),n(o[1]).removeClass("e-fr-hide"),t._removeClass(s.find("col")[0],"e-fc-hide"),t._removeClass(h.find("col")[0],"e-fc-hide"),r._frozenHeight=0,r._frozenWidth=0,r._frozenVisHt=0,r._frozenVisWt=0,f.scroll(0),t.performSelection({rowIndex:u[0],colIndex:u[1]},{rowIndex:u[2],colIndex:u[3]}))},_getTopRow:function(n,t){for(var r=this.XLObj,u=r.getSheet(t),f=r.getFrozenRows(t),e=0,i=0,o=u._rowHeightCollection.length;i<o;i++)if(e=i,u._rowHeightCollection[i]>n){f=r.getFrozenRows(t)-1+i;break}return{imaginaryIndex:f,actualIndex:i,i:e}},_getLeftColumn:function(n,t){for(var r=this.XLObj,u=r.getSheet(t),f=r.getFrozenColumns(t),e=0,i=0,o=u._colWidthCollection.length;i<o;i++)if(e=i,u._colWidthCollection[i]>n){f=r.getFrozenColumns(t)-1+i;break}return{imaginaryIndex:f,actualIndex:i,i:e}},_showHideRow:function(t,i,r,u,f,e,o,s){var c=this.XLObj,h,l=c.getSheet(t),v=0,p=l._firstRow,a=l._fpHiddenHeight,y;if(u==="hide")for(h=i;h<=r;h++)y=n(e[0][h]).height(),o>s-(p.value+y)&&c.XLScroll._createNewRow(t,-1,-1,"insert"),c._hasClass(e[0][h],"e-fr-hide")||(a=a+y),c.addClass(e[0][h],"e-fr-hide"),c.addClass(e[1][h],"e-fr-hide"),l._currentTopFrozenRow=h;else{for(h=i;h<=r;h++)c._hasClass(e[0][h],"e-fr-hide")&&(c._removeClass(e[0][h],"e-fr-hide"),c._removeClass(e[1][h],"e-fr-hide"),v=n(e[0][h]).height(),a=a-v<=0?0:a-v);l._currentTopFrozenRow=i}l._fpHiddenHeight=a;l._currentTopPosition=f},_hideRow:function(t){var r=this.XLObj,i=r.getSheet(t),u=r.getRows(t),f=i._fpHiddenHeight;r._hasClass(u[0][i._currentTopFrozenRow],"e-fr-hide")||(r.addClass(u[0][i._currentTopFrozenRow],"e-fr-hide"),r.addClass(u[1][i._currentTopFrozenRow],"e-fr-hide"),i._fpHiddenHeight=f+n(u[0][i._currentTopFrozenRow]).height());i._currentTopFrozenRow=i._currentTopFrozenRow+1},_showHideColumn:function(n,t,i,r,u,f,e,o,s){var c=this.XLObj,p,b=c._rcRegx,w=i,h,l,a,v,y=c.getSheet(n);if(r==="hide"){for(h=t;h<=i;h++)if(w=h,a=c.XLEdit.getPropertyValue(0,h,"merge"),a)for(v=c.getRangeIndices(a.mRange),l=v[1];l<=v[3];l++)this._refreshHideColumn(n,l,f,e,o,s,"hide"),h=l;else this._refreshHideColumn(n,h,f,e,o,s,"hide");y._currentLeftFrozenColumn=w}else{for(h=t;h<=w;h++)if(a=c.XLEdit.getPropertyValue(0,h,"merge"),c.XLEdit.getPropertyValue(0,h,"isMHide")){if(p=c.XLEdit.getPropertyValue(0,h,"mergeIdx"),a=c.XLEdit.getPropertyValue(p.rowIndex,p.colIndex,"merge"),a)for(v=c.getRangeIndices(a.mRange),l=v[1];l<=v[3];l++)this._refreshHideColumn(n,l,f,e,o,s,"show"),h=l}else this._refreshHideColumn(n,h,f,e,o,s,"show");y._currentLeftFrozenColumn=t}y._currentLeftFrozenColumn<=c.getFrozenColumns(n)&&(y._currentLeftFrozenColumn=c.getFrozenColumns(n));y._currentLeftPosition=u},_hideColumn:function(n){var t=this.XLObj,f,e,i=0,o,l=t._rcRegx,s=t.getSheet(n),r=s._currentLeftFrozenColumn,h=t._getContent(n).find("col"),c=t._getJSSheetHeader(n).find("col"),u;if(t.XLEdit.getPropertyValue(0,r,"isMHide")){if(f=t.XLEdit.getPropertyValue(0,r,"mergeIdx"),o=t.XLEdit.getPropertyValueByElem(f.rowIndex,f.colIndex,"merge"),o)for(e=t.getRangeIndices(o.mRange),u=e[1];u<=e[3];u++)this._refreshHideColumn(n,u,h,c,0,0,"hide"),i=i+1}else this._refreshHideColumn(n,r,h,c,0,0,"hide"),i=i+1;s._currentLeftFrozenColumn=r+i},_refreshHideColumn:function(t,i,r,u,f,e,o){var l,h=this.XLObj,b,y=h.getSheet(t),w=y._fpHiddenWidth,p=h._getContent(t).find(".e-filterspan"),tt=y._firstCol,g={rowIndex:-1,colIndex:-1},k,nt=y.columnsWidthCollection,c,d,v,s,a;if(o==="hide"){if(!h._hasClass(r[i],"e-fc-hide")){if(b=h.getRange([0,i,h.model.rowCount-1,i]),b.filter(".e-sswraptext").hide(),y._frozenColumns===i)for(c=this._frozenColsOverflow=n(".e-ofbrdr.e-ss-col"+(i-1)),c.addClass("e-freezeOverflow"),s=0,d=c.length;s<d;s++)h._textClip(c[s].parentNode.rowIndex,c[s].cellIndex,"add"),h._textClip(c[s].parentNode.rowIndex,c[s].cellIndex,"delete","",!0);for(v=this._hiddenCells[i]=n(".e-ofbrdr.e-ss-col"+i),n(".e-ss-col"+i).addClass("e-freezeOverflow"),s=0,a=v.length;s<a;s++)h._textClip(v[s].parentNode.rowIndex,v[s].cellIndex,"delete","",!0);h.addClass(r[i],"e-fc-hide");h.addClass(u[i],"e-fc-hide");y._fpHiddenWidth=w+nt[i]}for(f>e-(tt.value+h.model.columnWidth)&&h.XLScroll._createNewColumn(t,g,g,"insert"),l=0,a=p.length;l<a;l++)k=n(p[l]).parent()[0].cellIndex,k===i&&n(p[l]).addClass("e-hide")}else{if(h._hasClass(r[i],"e-fc-hide")){if(b=h.getRange([0,i,h.model.rowCount-1,i]),b.filter(".e-sswraptext").show(),y._frozenColumns===i)for(c=this._frozenColsOverflow,c.removeClass("e-freezeOverflow"),s=0,d=c.length;s<d;s++)h._textClip(c[s].parentNode.rowIndex,c[s].cellIndex,"delete"),h._textClip(c[s].parentNode.rowIndex,c[s].cellIndex,"add","",!0);for(v=this._hiddenCells[i],n(".e-ss-col"+i).removeClass("e-freezeOverflow"),s=0,a=v.length;s<a;s++)h._textClip(v[s].parentNode.rowIndex,v[s].cellIndex,"add","",!0);h._removeClass(r[i],"e-fc-hide");h._removeClass(u[i],"e-fc-hide");w=w-nt[i];y._fpHiddenWidth=w>=0?w:0}for(l=0,a=p.length;l<a;l++)k=n(p[l]).parent()[0].cellIndex,k===i&&n(p[l]).removeClass("e-hide")}},_changevHandlerPosition:function(n){var i=this.XLObj,t=i.XLScroll._vScroller(i.getActiveSheetIndex());t.value(n);n=t!==null&&n>=t._scrollData.scrollable?t._scrollData.scrollable:n;t!==null&&n>=0&&n<=t._scrollData.scrollable&&(n=n/t._scrollData.onePx,t.element.find(".e-vhandle").css("top",n-1))},_changehHandlerPosition:function(n){var i=this.XLObj,t=i.XLScroll._hScroller(i.getActiveSheetIndex());t.value(n);n=t!==null&&n>=t._scrollData.scrollable?t._scrollData.scrollable:n;t!==null&&n>=0&&n<=t._scrollData.scrollable&&(n=n/t._scrollData.onePx,t.element.find(".e-hhandle").css("left",n-1))},_refreshFreezeDiv:function(n,t,i){var f=this.XLObj,r,u;t==="horizontal"?(r=f._getContent(n).find(".e-frow"),r.width(r.width()+i)):(u=f._getContent(n).find(".e-fcol"),u.height(u.height()+i))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.math={toFraction:function(n){if(this.isNumber(n)){var r=n.toString(),e=r.split(".")[0],t=r.split(".")[1];if(!t)return{integer:n};var i=(+t).toString(),u=this.getPlaceValue(t,i),f=this.getGcd(i,u);return{integer:e,numerator:Number(i)/f,denominator:Number(u)/f}}return null},toExponential:function(n,t){var r,i;return this.isNumber(n)?(r=Number(n),t=this.isNumber(t)?t:2,t>20&&(t=20),i=r.toExponential(t).split("e+"),i[0]+"E+"+this.padZeros(i[1])):null},toAccounting:function(i,r,u){if(this.isNumber(r)&&i){var e,o,s=t.widgetBase.formatting(i,r,u),f=this._currencySymbol,h=n.trim(s.replace(f,"")),c=s.indexOf(f);!c||r<0&&c===1?(e=f,o=Number(r)?h:"-"):(e=Number(r)?h:"-",o=f);r=e+"   "+o}return r},intToDate:function(n){return new Date((Number(n)-2)*864e5+new Date("01/01/1900").getTime())},getGcd:function(n,t){return(n=Number(n),t=Number(t),!t)?n:this.getGcd(t,n%t)},isNumber:function(n){return n-parseFloat(n)>=0},isTime:function(n){return n?n.toString().indexOf(":")!==-1:!1},isFormula:function(n){var t,i;return n&&!n.toString().indexOf("=")&&n.length>1?(t=n.split("(").length-1,i=n.split(")").length-1,t===i):!1},getPlaceValue:function(n,t){var i=n.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},padZeros:function(n,i,r){return this.isNumber(n)?(i=this.isNumber(i)?i:2,r=t.isNullOrUndefined(t.Spreadsheet.autoFillDirection[r])?t.Spreadsheet.autoFillDirection.Left:t.Spreadsheet.autoFillDirection[r],r===t.Spreadsheet.autoFillDirection.Left?n<=this.maxValue(i)?Array(i-this.getDigits(n)+1).join("0")+n.toString():n.toString():n<this.minValue(i)?n.toString()+Array(i-this.getDigits(n)+1).join("0"):n.toString()):null},maxValue:function(n){return this.isNumber(n)?Number(Array(n+1).join("9")):null},minValue:function(n){return this.isNumber(n)?Number("1"+Array(n).join("0")):null},getDigits:function(n){return this.isNumber(n)?n.toString().length:null},_round:function(n,t){return Number(Math.round(n+"e"+t)+"e-"+t)},_parseTime:function(n){var u,t,i=0,r=3,f={},e;if(this.isTime(n))for(n=n.toString(),t=n.split(" "),u=t.length;i<u;){if(this.isTime(t[i]))for(e=t[i].split(":");r<6;)f[this._datePattern[r]]=e[r-3]||"0",r++;i++}return f},_dateToInt:function(n){var t=new Date("01/01/1900"),i=this._isDateTime(n)?n:new Date(n),r=i.getTime()-t.getTime();return r/864e5+2},_defTimeFormat:function(n){return[n.getHours(),n.getMinutes(),n.getSeconds()].join(":")},_isDate:function(n){var i={};return t.isNullOrUndefined(t.parseDate(n.toString()))||(n=this._dateToInt(n.toString())),/^((0?[1-9]|1[012])[-.](0?[1-9]|[12][0-9]|3[01])[-.](19|20)?[0-9]{2})*$/.test(n.toString())?(n=n.toString().replace("-","/","g"),n=this._dateToInt(n.toString()),i.text=n,i.isDate=!0):(i.text=n,i.isDate=!1),i},_defDateFormat:function(n){return[n.getMonth()+1,n.getDate(),n.getFullYear()].join("/")},_isCellReference:function(n){return/^[a-z]+[0-9]+$/gi.test(n)},_isDateTime:function(n){return Object.prototype.toString.call(n)==="[object Date]"&&!isNaN(n.valueOf())},_decimalCnt:function(n){var t;return this.isNumber(n)&&(n=Number(n),t=n.toString(),t.indexOf(this._decimalSeparator)>-1)?(fixVal=n.toFixed(),t.length-fixVal.length-1):0}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.resizing=function(t){this.XLObj=t;this._$visualElem=n();this._currentHCell=-1;this._colMinWidth=15;this._rowMinHeight=20;this._allowStart=!1;this._resizeStart=!1;this._resizeType="";this._tableY=null;this._oldWidth=null;this._orgX=null;this._orgY=null;this._extra=null;this._initialTableWidth=null;this._resizeElt=null;this._tableX=null;this._oldHeight=null;this._initialTableHeight=null};t.spreadsheetFeatures.resizing.prototype={getColWidth:function(n){return this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).columnsWidthCollection[n]},getRowHeight:function(n){return this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).rowsHeightCollection[n]},setColWidth:function(n,t){if(this.XLObj.model.allowResizing){var i=this.XLObj.getActiveSheetIndex();this._currentHCell=n;this._resizeColumnUsingDiff(t,this.XLObj.getSheet(i).columnsWidthCollection[n]);this.XLObj.XLScroll._getColWidths(i,n)}},setRowHeight:function(n,t){if(this.XLObj.model.allowResizing){var i=this.XLObj.getActiveSheetIndex();this._currentHCell=n;this._resizeRowUsingDiff(t,this.XLObj.getSheet(i).rowsHeightCollection[n]);this.XLObj.XLScroll._getRowHeights(i,n)}},_headerMouseDown:function(n){n.preventDefault();this._colMouseDown(n)},_colMouseDown:function(t){if(this._allowStart&&n(t.target).css("cursor")==="col-resize"){var i=t.clientX,r=t.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(i=t.pageX,r=t.pageY);i+=document.documentElement.scrollLeft;t.button!==2&&this._start(i,r);this._resizeType="Col";t.preventDefault()}},_mouseHover:function(t){var s,i=this.XLObj,r=t.target,c=i.getActiveSheetIndex(),o=i._getJSSheetHeader(c);if(!this._$visualElem.is(":visible")&&(i._hasClass(r,".e-headercelldiv")&&(r=r.parentNode),i._hasClass(r,"e-headercell"))){var e=r,u=e.getBoundingClientRect(),h=i._setXY(t),f=h[0],l=h[1];if(s=n(o.find(".e-table")[0]).width()+n(o.find(".e-columnheader")[0]).offset().left,(f>=u.left+document.documentElement.scrollLeft+e.offsetWidth-5||f<=u.left+3)&&f<s&&f>=u.left&&l<=u.top+document.documentElement.scrollTop+r.offsetHeight){if(this._currentHCell=o.find(".e-headercell").index(e),this._currentHCell<1&&f<u.left+e.offsetWidth-5)return;i.addClass(r,"e-ss-colresize");this._allowStart=!0}else i._removeClass(n(".e-ss-colresize")[0],"e-ss-colresize"),this._allowStart=!1,this._currentHCell=-1}},_start:function(i,r){var u=this.XLObj,e,o=u.getActiveSheetIndex(),s=u._getJSSheetHeader(o),l=s.find(".e-columnheader"),h=l.find(".e-headercell"),f,c;(this._currentHCell>-1&&this._currentHCell<h.length&&(f=h[this._currentHCell]),t.isNullOrUndefined(f))||(c=f.getBoundingClientRect(),this._tableY=c.top+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart?(this._$visualElem=n(document.createElement("div")),e=u._getJSSheetContent(o).height()+s.height(),this._$visualElem.addClass("e-reSizeColbg").appendTo(u.element).css({height:e+"px"}).addClass("e-ss-colresize"),this._$visualElem.css({left:i-1,top:this._tableY}),this._oldWidth=f.offsetWidth,this._orgX=i,this._orgY=r,this._extra=i-this._orgX,this._resizeStart=!0):this._currentHCell=-1)},_cMouseMove:function(n){if(this._resizeStart){var i=this.XLObj._setXY(n),t=i[0];navigator.userAgent.indexOf("WebKit")>-1&&(t=n.pageX);t+=document.documentElement.scrollLeft;n.preventDefault();this._moveVisual(t);this.XLObj.addClass(n.target,"e-ss-colresize")}else this._mouseHover(n)},_reSize:function(t){var r,i=this.XLObj,u=i.getActiveSheetIndex();this._initialTableWidth=i._getJSSheetHeader(u).find(".e-headercontent").width();this._getResizableCell();this._currentHCell>-1&&this._resizeStart&&(r=i.getSheet(u).columnsWidthCollection[this._currentHCell],this._resizeColumnUsingDiff(t-this._orgX+r,r),i.model.allowAutoFill&&(i.XLDragFill.positionAutoFillElement(),i.XLDragFill.hideAutoFillOptions()),n("#"+i._id+"ddlspan").length&&i._ddlPosition());i.XLScroll._getRowHeights(u,this._currentHCell);i.model.allowSelection&&i.XLSelection._refreshBorder();this._removeVisualElem()},_resizeColumnUsingDiff:function(t,i){var c,e,d=[],a,v,y,p,g,nt,tt,f=[],r=this.XLObj,it={},o=r.getActiveSheetIndex(),w=r._getJSSheetHeader(o),b,k,l,u,s,h;if(t>0){for(b=w.find(".e-colselected"),k=b.length,t=t>this._colMinWidth?t:this._colMinWidth,k>0&&(l=b[0].cellIndex),u=0;u<k;u++)this._currentHCell==l&&(tt=!0),f.push(l),l++;for(tt||(f=[this._currentHCell]),u=0,h=f.length;u<h;u++)if(!r.XLEdit.getPropertyValue(0,f[u],"wrapCol")||!(r.XLEdit.getPropertyValue(0,f[u],"wrapWidth")>t)){if(g=w.find("col:eq("+f[u]+")"),nt=r._getJSSheetContent(o).find(".e-spreadsheetcontentcontainer").find("col:eq("+f[u]+")"),g.outerWidth(t),nt.width(t),r.getSheet(o).columnsWidthCollection[f[u]]=t,t>i)for(y=n(".e-ss-col"+f[u]),s=0,h=y.length;s<h;s++)e=r._getCellIdx(y[s]),a=r.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"value2"),a&&(r._refreshGlobalSpan(),c=n("#"+r._id+"_emptySpan"),r.addClass(c,"e-rowcell"),c.text(a),v=c.outerWidth(),r._refreshGlobalSpan(),t<v&&(r._textClip(e.rowIndex,e.colIndex,"delete"),r._textClip(e.rowIndex,e.colIndex,"add",v)));else for(p=n(".e-ss-col"+f[u]+".e-ofbrdr"),s=0,h=p.length;s<h;s++)e=r._getCellIdx(p[s]),r._textClip(e.rowIndex,e.colIndex,"delete","",!0),r._textClip(e.rowIndex,e.colIndex,"add","",!0);d.push(f[u]);r.getFrozenColumns(o)>=f[u]&&r._refreshFreezeColumns(o,f[u],t-i,"resize")}w.find(".e-columnheader").css("cursor","default");r._dupDetails||(it={sheetIndex:o,colIndex:d,newWidth:t,oldWidth:i,reqType:"resize-column"},i!==t&&r._completeAction(it));r.model.scrollSettings.allowScrolling&&(r.XLScroll._getColWidths(o,f[0]+1),r.XLScroll._refreshScroller(o,"refresh","all"))}},_calculateWidth:function(){for(var t=this.XLObj,i=t._getJSSheetHeader(t.getActiveSheetIndex()).find("col"),r=0,n=0;n<i.length;n++)r+=i.eq(n).width();return r},_cMouseUp:function(n){if(this._resizeStart){var t=n.clientX,i=this.XLObj;navigator.userAgent.indexOf("WebKit")>-1&&(t=n.pageX);t+=document.documentElement.scrollLeft;this._reSize(t);i.element.find("#"+i._id+"ddl").ejDropDownList("hidePopup")}},_getResizableCell:function(n){for(var i=this.XLObj,r=i.getActiveSheetIndex(),o=i._getJSSheetHeader(r).find(".e-columnheader"),u=o.find(".e-headercell").not(".e-hide"),s=navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollLeft:document.documentElement.scrollLeft,f,e,t=0,h=u.length;t<h;t++)if(e=u[t].getBoundingClientRect(),f=e.left+s+5,f>this._orgX){i.isUndefined(n)?this._currentHCell=t-1:n.target=i._getJSSheetHeader(r).find("th:eq("+(t-1)+")")[0];return}},_moveVisual:function(n){var i=this.XLObj,t=i._getJSSheetHeader(i.getActiveSheetIndex()).find(".e-headercontent")[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<n||n<t.left+document.documentElement.scrollLeft?this._$visualElem.remove():this._currentHCell>-1&&this._$visualElem.css({left:n-1,top:this._tableY})},_rowMouseDown:function(t){if(this._allowStart&&n(t.target).css("cursor")==="row-resize"){var r=t.clientX,i=t.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(r=t.pageX,i=t.pageY);i+=document.documentElement.scrollTop;t.button!==2&&this._rowStart(r,i);this._resizeType="Row";t.preventDefault()}return!1},_rowMouseHover:function(t){var i;if(!this._$visualElem.is(":visible")&&(i=n(t.target),i.hasClass("e-rowheader"))){var f=this.XLObj,o=f.getActiveSheetIndex(),s=f._getJSSheetRowHeaderContent(o),e=i.get(0),r=e.getBoundingClientRect(),h=f._setXY(t),c=h[0],u=h[1],l=f._getJSSheetRowHeader(o).find(".e-table").height()+s.find("tbody").offset().top;if((u>=r.top+document.documentElement.scrollTop+e.offsetHeight-5||u<=r.top+3)&&u<l&&u>=r.top&&c<=r.left+document.documentElement.scrollLeft+t.target.offsetWidth){if(this._resizeElt=i.parent(),this._currentHCell=s.find(".e-rowheader").index(e),this._currentHCell<1&&u<r.top+e.offsetHeight-5)return;i.addClass("e-ss-rowresize");this._allowStart=!0}else n(".e-ss-rowresize").removeClass("e-ss-rowresize"),this._allowStart=!1,this._currentHCell=-1}},_rowStart:function(t,i){var r=this.XLObj,f=r.getActiveSheetIndex(),e=r._getJSSheetRowHeader(f).find(".e-rowheader"),u,o,s;(this._currentHCell>-1&&this._currentHCell<e.length&&(u=e[this._currentHCell]),u)&&(o=u.getBoundingClientRect(),this._tableX=o.left+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollLeft:document.documentElement.scrollLeft),this._allowStart?(this._$visualElem=n(document.createElement("div")),s=r._getJSSheetContent(f).width(),this._$visualElem.addClass("e-reSizeRowbg").appendTo(r.element).css({width:s+"px"}).addClass("e-ss-rowresize"),this._$visualElem.css({top:i-1,left:this._tableX}),this._oldHeight=u.offsetHeight,this._orgX=t,this._orgY=i,this._extra=i-this._orgY,this._resizeStart=!0):this._currentHCell=-1)},_rMouseMove:function(t){if(this._resizeStart){var r=this.XLObj._setXY(t),i=r[1];navigator.userAgent.indexOf("WebKit")>-1&&(i=t.pageY);i+=document.documentElement.scrollTop;t.preventDefault();n(t.target).addClass("e-ss-rowresize");this._moveRowVisual(i)}else this._rowMouseHover(t)},_rowResize:function(t,i){var u,r=this.XLObj,f=r.getActiveSheetIndex(),o=r.getRows(f)[1],e=!1;this._initialTableHeight=r._getJSSheetRowHeader(f).find(".e-rowheadercontent").height();this._getResizableRowCell();e=n(o[this._currentHCell]).find(".e-sswraptext").length>0;this._currentHCell>-1&&this._resizeStart&&(u=r.getSheet(f).rowsHeightCollection[this._currentHCell],(!e||e&&i-this._orgY+u>u)&&this._resizeRowUsingDiff(i-this._orgY+u,u),r.model.allowAutoFill&&(r.XLDragFill.positionAutoFillElement(),r.XLDragFill.hideAutoFillOptions()));r.XLSelection._refreshBorder();this._removeVisualElem()},_resizeRowUsingDiff:function(n,t){var i=this.XLObj,r=i.getActiveSheetIndex(),l={},o=i._getJSSheetRowHeaderContent(r),a,v,y,f=[],e,u,p,h,c,s;if(n>0){for(h=o.find(".e-rowselected"),c=h.length,c>0&&(s=h[0].parentNode.rowIndex),n=n>this._rowMinHeight?n:this._rowMinHeight,u=0;u<c;u++)this._currentHCell==s&&(y=!0),f.push(s),s++;for(y||(f=[this._currentHCell]),u=0,p=f.length;u<p;u++)e=i.model.scrollSettings.allowVirtualScrolling?i.getSheet(r)._virtualRowIdx[f[u]]:f[u],i._isRowViewable(r,e)&&this._getContentHeight(e,r)<n&&(a=o.find("tr:eq("+f[u]+")"),v=i._getJSSheetContent(r).find(".e-content").find("tr:eq("+f[u]+")"),a.outerHeight(n),v.height(n)),i.getSheet(r).rowsHeightCollection[e]=n,i.model.scrollSettings.allowScrolling&&i.XLScroll._getRowHeights(r,e);o.find("tbody").css("cursor","default");o.find("tbody").children().css("cursor","default");i._dupDetails||(l={sheetIndex:r,rowIndex:this._currentHCell,newHeight:n,oldHeight:t,reqType:"resize-row"},t!==n&&i._completeAction(l));i.getFrozenRows(r)>=this._currentHCell&&i._refreshFreezeRows(r,this._currentHCell,n-t,"resize");i.model.scrollSettings.allowScrolling&&i.XLScroll._refreshScroller(r,"refresh","all")}},_findRowsHeight:function(n){for(var t=this.XLObj,i=t.getActiveSheetIndex(),f=t.getSheet(i),e=t._getJSSheetContent(i).find("tbody").children(),r,u=0,o=n.length;u<o;u++)r=n[u],t._sheets[i]._Rows[0]&&(f.rowsHeightCollection[r]=e.eq(r).height())},_calculateHeight:function(){for(var t=this.XLObj,i=t.getRows(t.getActiveSheetIndex())[0],r=0,n=0,u=i.length;n<u;n++)r+=i.eq(n).height();return r},_rMouseUp:function(t){if(this._resizeStart){var r=t.clientX,i=t.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(r=t.pageX,i=t.pageY);i+=document.documentElement.scrollTop;this._rowResize(r,i);n("#"+this.XLObj._id+"ddlspan").length&&this.XLObj._ddlPosition()}},_getResizableRowCell:function(t){for(var r=this.XLObj,e=r.getActiveSheetIndex(),u=r._getJSSheetContent(e).find(".e-rowheader"),h=navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop,o,f,s=1,i=0,c=u.length;i<c;i++)if(f=u[i].getBoundingClientRect(),f.top===0&&s++,o=f.top+h+5,o>this._orgY){r.isUndefined(t)?this._currentHCell=n(u[i-1]).is(":visible")?i-1:i-s:t.target=r._getJSSheetRowHeader(e).find("tr:eq("+(i-1)+") td")[0];return}},_moveRowVisual:function(n){var i=this.XLObj,t=i._getJSSheetContent(i.getActiveSheetIndex()).find(".e-rowheadercontent")[0].getBoundingClientRect();t.top+document.documentElement.scrollTop+t.height<n||n<t.top+document.documentElement.scrollTop?this._$visualElem.remove():this._currentHCell>-1&&this._$visualElem.css({top:n-1,left:this._tableX})},_apMouseDown:function(t){if(this._allowStart&&n(t.target).closest("div").css("cursor")==="col-resize"){var i=t.clientX;navigator.userAgent.indexOf("WebKit")>-1&&(i=t.pageX);i+=document.documentElement.scrollLeft;t.button!==2&&this._apStart(i);this._resizeType="AP";t.preventDefault()}return!1},_apMouseHover:function(t){var i=this.XLObj;if(!this._$visualElem.is(":visible")){var r=n(t.target),e=r.get(0),u=e.getBoundingClientRect(),o=i._setXY(t),f=o[0];f<=u.left+4&&f>=u.left?(r.parent().addClass("e-ss-apresize"),this._allowStart=!0):(i.element.find(".e-ss-apresize").removeClass("e-ss-apresize"),this._allowStart=!1)}},_apStart:function(t){var i=this.XLObj,f=i.getActivationPanel()[0],e=f.getBoundingClientRect(),r=i.getActiveSheetIndex(),u;this._tableY=e.top+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop);this._allowStart&&(this._$visualElem=n(document.createElement("div")),u=i._getJSSheetContent(r).height()+i.getJSSheetHeader(r).height(),this._$visualElem.addClass("e-reSizeAPbg").appendTo(i.element).css({height:u+"px"}).addClass("e-ss-apresize"),this._$visualElem.css({left:t,top:this._tableY}),this._resizeStart=!0)},_apMouseMove:function(n){if(this._resizeStart){var i=this.XLObj._setXY(n),t=i[0];t+=document.documentElement.scrollLeft;n.preventDefault();this._apMoveVisual(t)}else this._apMouseHover(n)},_apMouseUp:function(n){if(this._resizeStart){var t=n.clientX;navigator.userAgent.indexOf("WebKit")>-1&&(t=n.pageX);t+=document.documentElement.scrollLeft;this._apReSize(t)}},_apMoveVisual:function(n){this._$visualElem.css({left:n,top:this._tableY})},_apReSize:function(t){var i=this.XLObj;i.model.apWidth=Math.abs(i.model.scrollSettings.width-t);n(i.getActivationPanel()).width(i.model.apWidth);i.setSheetWidthHeight(i.getActiveSheetIndex(),{width:t,height:i.model.scrollSettings.height});this._removeVisualElem()},_removeVisualElem:function(){var n=this.XLObj;this._$visualElem.remove();n.element.find(".e-reSizeRowbg").remove();this._resizeStart=!1;this._currentHCell=-1;this._resizeType="";this._allowStart=!1;n.model.allowComments&&n.XLComment._updateCmntArrowPos()},fitWidth:function(n){for(var t=this.XLObj,i=t.getActiveSheetIndex(),r=0,u=n.length;r<u;r++)this._fitWidth(n[r],0,t.getSheet(i)._usedRange.rowIndex);t.model.scrollSettings.allowScrolling&&(t.XLScroll._getColWidths(i,n[0]+1),t.XLScroll._refreshScroller(i,"refresh","horizontal"));t.model.allowSelection&&t.XLSelection._refreshBorder()},_resizeToFitWidth:function(t){var i=this.XLObj,r,u=i.getActiveSheetIndex(),f=i.getSheet(u)._usedRange.rowIndex;n(t.target).css("cursor")==="col-resize"&&(i._hasClass(t.target,".e-headercelldiv")&&(t.target=t.target.parentNode),this._getResizableCell(t),r=n(t.target),i._hasClass(r[0],"e-headercell")&&this._fitWidth(t.target.cellIndex,0,f));this._mouseHover(t);i.model.scrollSettings.allowScrolling&&(i.XLScroll._getColWidths(i.getActiveSheetIndex(),t.target.cellIndex+1),i.XLScroll._refreshScroller(u,"refresh","horizontal"));i.model.allowSelection&&i.XLSelection._refreshBorder();i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement()},_fitWidth:function(t,i,r){var u=this.XLObj,e=u.getActiveSheetIndex(),o=u._getJSSheetHeader(e).find(".e-headercell")[t],a=n(o).children(".e-headercelldiv"),f=0,h=0,s=0,c=u.getSheet(e),l;r=r?r:c._usedRange.rowIndex;s=this._getContentWidth(t,e,i,r);h=this._getHeaderContentWidth(a,e);s>1&&(f=h>s?h:s,f=f+10,l={target:o,sheetIndex:e,colIndex:t,newWidth:f,oldWidth:o.offsetWidth,reqType:"resize-fit-width"},f>0&&(f<20&&(f=30),this._applyWidth(o,e,t,f),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement(),u.model.allowComments&&u.XLComment._updateCmntArrowPos(),c._isImported&&!c._isLoaded||u._isUndoRedo||u._dupDetails||u._completeAction(l),u.getFrozenColumns(e)>=t&&u._refreshFreezeColumns(e,t,f-l.oldWidth,"resize")));u.XLEdit._updateDataContainer({rowIndex:0,colIndex:t},{dataObj:{isFitWidth:!0}})},_applyWidth:function(n,t,i,r){var u=this.XLObj;u._getJSSheetHeader(t).find("col:eq("+i+")").width(r);u._getJSSheetContent(t).find("col:eq("+(i+1)+")").width(r);u.getSheet(t).columnsWidthCollection[i]=r;u.getSheet(t).columns[i].width=r},_getContentWidth:function(n,i,r,u){for(var h=0,o,s,c=this.XLObj,l=c._dataContainer.sheets[i],e,f=r;f<=u;f++)t.isNullOrUndefined(l[f])||(o=l[f][n]),t.isNullOrUndefined(o)?(o={},s={spanWidth:0,paddingWidth:0}):s=this._getCalculatedCellWidth(i,o),e=c._detailsFromGlobalSpan(f,n,"width",c.XLEdit.getPropertyValue(f,n,"value2")),e=e+s.spanWidth+s.paddingWidth,e>h&&(h=e);return h},_getCalculatedCellWidth:function(n,t){var i=0,r=0;return"isFilterHeader"in t?"isFilterVisible"in t&&(i+=17):i+=0,r=3,{spanWidth:i,paddingWidth:r}},_getHeaderContentWidth:function(n){var i=0,r=t.buildTag("span",{},{}),u=n.html();return r.html(u),n.html(r),i=n.find("span:first").width(),i=i+10,n.html(u),i},fitHeight:function(n){var i=this.XLObj,u,r,f;if(i.model.allowResizing){for(u=i.getActiveSheetIndex(),r=0,f=n.length;r<f;r++)t.isNullOrUndefined(i.XLEdit.getPropertyValue(n[r],0,"wrapRow"))&&this._fitHeight(n[r],n[r]),i._setRowHdrHeight(u,n[r]);i.model.scrollSettings.allowScrolling&&(i.XLScroll._getRowHeights(u,n[0]),i.XLScroll._refreshScroller(u,"refresh","vertical"));i.model.allowSelection&&i.XLSelection._refreshBorder()}},_resizeToFitHeight:function(n){var i=this.XLObj,u=i.getActiveSheetIndex(),f=n.target.parentNode.rowIndex,r;r=i.model.scrollSettings.allowVirtualScrolling?i.getSheet(u)._virtualRowIdx[f]:f;this._getResizableRowCell(n);t.isNullOrUndefined(i.XLEdit.getPropertyValue(r,0,"wrapRow"))&&(this._fitHeight(f,r),i._setRowHdrHeight(u,r),i.model.scrollSettings.allowScrolling&&(i.XLScroll._getRowHeights(i.getActiveSheetIndex(),r),i.XLScroll._refreshScroller(u,"refresh","vertical")),i.model.allowSelection&&i.XLSelection._refreshBorder(),i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement())},_fitHeight:function(i,r){var u=this.XLObj,f=u.getActiveSheetIndex(),s=u.getSheet(f),l=u._getJSSheetRowHeader(f).find(".e-rowheader")[i],e=0,h=0,o,a=t.buildTag("span",{},{height:20,width:30}),c;h=this._getContentHeight(r,f);a.html(r+1);u.element.append(a);o=u.element.find("span:last").outerHeight(!0);u.element.find("span:last").remove();o=o+4;e=h<o?o:h;e<u.model.rowHeight&&(e=u.model.rowHeight);c={target:l,sheetIndex:f,rowIndex:r,newHeight:e,oldHeight:s.rowsHeightCollection[i],reqType:"resize-fit-height"};u._isRowViewable(f,r)&&(n(l.parentElement).height(e),n(u._getContent(f).find("tr")[i]).height(e));u.getSheet(f).rowsHeightCollection[r]=e;u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement();u.model.allowComments&&u.XLComment._updateCmntArrowPos();u.model.scrollSettings.allowScrolling&&u.XLScroll._refreshScroller(f,"refresh","all");s._isImported&&!s._isLoaded||u._dupDetails||u._completeAction(c);u.getFrozenRows(f)>=r&&u._refreshFreezeRows(f,i,e-c.oldHeight,"resize");u.XLEdit._updateDataContainer({rowIndex:r,colIndex:0},{dataObj:{isFitHeight:!0}})},_getContentHeight:function(n,t){for(var i=this.XLObj,r=0,f,h=i._formatRegx,o=i.getSheet(t),e=i.getObjectKeys(i._dataContainer.sheets[t][n]),c=o.rowsHeightCollection[n],l=o.columnsWidthCollection,u=0,s=e.length;u<s;u++)f=i._detailsFromGlobalSpan(n,e[u],"height",i.XLEdit.getPropertyValue(n,e[u],"value2")),f>r&&(r=f);return r>i.model.rowHeight?r+5:r},_setRowHdrHeightResize:function(i,r){for(var f=this.XLObj,e=f.getRows(i),o=e[0],s=f.getSheet(i)._usedRange.rowIndex,u=0;u<=s;u++)t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,r,"mergeIdx"))&&t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,r,"merge"))&&f._isRowViewable(i,u)&&(tdHeight=f._detailsFromGlobalSpan(u,r,"height",f.XLEdit.getPropertyValue(u,r,"value2")),n(o[u]).height(tdHeight))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.editing=function(n){this.XLObj=n;this._EditCellDetails={value:null,rowIndex:-1,columnIndex:-1,fieldName:null,cell:null};this._isEdit=!1;this._isFormulaEdit=!1;this._isFBarFocused=!1;this._skipHTML=!1;this._editElem=null;this._filterIcon=null;this._isCellEdit=!0;this._validOperators=["+","-","*","/",","];this._invalidOperators=["%"];this._validCharacters=["+","-","*","/",",","(","="];this._textDecoration=!1;this._editCell=null;this._isACPositioned=!1;this._acPosition={left:0,top:0};this._isValidation=!1};t.spreadsheetFeatures.editing.prototype={getCurrentEditCellData:function(){var i,n,t=this.XLObj;return this._isEdit?(i=t.element.find("#"+t._id+"_Edit"),n=i.text(),typeof n=="string"&&n.length&&t.getSheet(t.getActiveSheetIndex()).columns[this._EditCellDetails.columnIndex].type==="number"&&(n=parseFloat(n)),n):null},getColumnIndexByField:function(n){for(var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),t=0,u=r.columns.length;t<u;t++)if(r.columns[t].field===n)break;return t},_processEditing:function(n){var i=this.XLObj,n=i._getSheetIndex(n),r=i.getSheet(n);r.columns.length===0||this._editElem||(this._editElem=t.buildTag("div.e-field e-ss-input","",{},{id:i._id+"_Edit",contenteditable:!0}))},editCell:function(t,i,r){var o,f,c,e,l,a,s,h,u=this.XLObj,v=u.element.find("#"+u._id+"_ValElem");u.model.allowEditing&&u.model.allowSelection&&!u._isCellProtected(t,i,!0)&&((h={rowIndex:t,colIndex:i},o=u.getActiveSheetIndex(),f=u.getSheet(o),l=u.getActiveCell(o),u._isRowViewable(o,t)&&(this._textDecoration=u.getCell(t,i).find("a").css("text-decoration")==="none"),s=u.getCell(t,i),column=f.columns[i],this._editCell=s,this._isACPositioned=!1,e={columnName:column.field,value:u.getRangeData([t,i,t,i],!0,null,o,!0)[0],columnObject:column,cell:s},u._trigger("cellEdit",e))||(u._cureditedCell=e.value,this._isValidation&&(v.rules("remove"),this._isValidation=!1),(l.rowIndex!==t||l.colIndex!==i)&&(f._activeCell=h,f._startCell.rowIndex<=t&&f._startCell.colIndex<=i&&f._endCell.rowIndex>=t&&f._endCell.colIndex>=i?u.XLSelection.selectRange(f._startCell,f._endCell):u.XLSelection.selectRange(h,h),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement()),this._EditCellDetails={rowIndex:t,value:e.value,columnIndex:i,fieldName:column.field,cell:s},r||(e.value=""),a=e.value,this._renderBulkEditObject(e,s,a),this.getPropertyValue(f._activeCell.rowIndex,f._activeCell.colIndex,"rule",o)&&u.XLValidate._setValidation(),c=n("#"+u._id+"_"+this._EditCellDetails.fieldName),this.getPropertyValue(t,i,"hyperlink",o)&&c.addClass("e-hyperlinks"),this._textDecoration&&c.css("text-decoration","none"),u.model.allowComments&&s.hasClass("e-commentcell")&&u.XLComment._visibleCmntCnt(s),e.cell.addClass(u._browserDetails.name==="msie"?"e-editedcell e-msie-edit":"e-editedcell"),u.isFormula(e.value)&&this._processFormulaEditRange(e.value)))},_renderBulkEditObject:function(i,r,u){var h,c,f=this.XLObj,l=r.height(),o=f.getActiveSheetIndex(),s=r.find(".e-filterspan"),a=f._getContent(o).find(".e-content"),e;({})[i.columnObject.field]=i.value;s.length&&(c={filterIcon:s,rowIndex:s.parentsUntil("table").eq(1).index(),colIndex:s.parent().index()},this._filterIcon=c);h=r.height();this._refreshTextNode(r[0]);r.hasClass("e-sswraptext")&&l!==h&&r.height(l);e=this._editElem;e.text("");t.isNullOrUndefined(u)||e.text(u);a.append(e);e.css({left:r[0].offsetLeft+2,top:r[0].offsetTop,cursor:"text",height:"auto",lineHeight:"normal",wordWrap:"break-word",position:"absolute",minWidth:r.width()});this._editCell.hasClass("e-sswraptext")?(e.css({width:r.width(),maxWidth:""}),n(f.getRows(o)[1][r.parent().index()]).height(f.model.sheets[o].rowsHeightCollection[r.parent().index()]),f.XLScroll._getRowHeights(o,r.parent().index())):e.css({width:"",maxWidth:a.width()-(r.offset().left-(f.element.offset().left+n(f.getRows(o)[0][0]).width()))-2});e.show();this._refreshEditForm(r,e,i.value,u,h);this._isEdit=!0;f.model.showRibbon&&f.XLRibbon._disableRibbonIcons()},_refreshEditForm:function(t,i,r,u){var h,e,c={},f=this.XLObj,l=document.getElementById(f._id+"EditForm"),a=n(l).find("input,select"),o=f._dataContainer.sheets[f.getActiveSheetIndex()],s=t.parent().index();o&&o[s]&&o[s][t[0].cellIndex]&&(c=o[s][t[0].cellIndex]);i[0].className="";e=this.getPropertyValueByElem(t,"type")||"";!f.isNumber(u)||e.indexOf("text")>-1||i.addClass("e-ralign");(e.indexOf("date")>-1||e.indexOf("time")>-1)&&i.addClass("e-ralign");i.css({border:"none",outline:"none"});this.XLObj.model.allowCellFormatting&&(h=f.XLFormat.getFormatClass(t[0].className));i.addClass(h);f.model.allowCellFormatting&&(i.css({color:t.css("color")}),i.css({"background-color":t.css("background-color")}));i.on("input",function(t){var i=n("#"+this.id.split("_")[0]).data("ejSpreadsheet");i.XLEdit._isFormulaEdit=!n(t.target).text().indexOf("=");i.XLEdit._isFormulaEdit&&i.XLEdit._processFormulaEditRange(n(t.target).text());i.model.allowFormulaBar&&i._getInputBox().val(n(t.target).text());i.XLEdit._isCellEdit=!0});i.on("focus",function(){var t=n("#"+this.id.split("_")[0]).data("ejSpreadsheet");t.XLEdit._isCellEdit=!0});f._setFormulaSuggElem(n("#"+f._id+"_AutoComplete_suggestion"));i.focusEnd()},_renderAutoComplete:function(t,i,r,u){var f=this.XLObj,e=u?" e-cell-ac e-ss-editinput":"";t.ejAutocomplete({dataSource:f._formulaCollection,value:i,cssClass:"e-ss-autocomplete"+e,width:"100%",height:r,htmlattributes:u?{display:"none"}:"",delaySuggestionTimeout:10,minCharacter:2,popupWidth:"170px",popupHeight:"150px",showEmptyResultText:!1,autoFocus:!0,template:"<span class='e-icon e-ss-function'> <\/span><div> ${display} <\/div>",select:n.proxy(this._formulaSelect,f),open:n.proxy(this._formulaSuggestionStatus,f),close:n.proxy(this._formulaSuggestionStatus,f)});t.data("ejAutocomplete")._bubbleEvent(!0)},_refreshAutoComplete:function(){var t=this.XLObj,i="ejAutocomplete",r="dataSource";t.model.allowFormulaBar&&n("#"+t._id+"_inputbox").data(i).option(r,t._formulaCollection);n("#"+t._id+"_AutoComplete").data(i).option(r,t._formulaCollection)},_captureEditing:function(){var t=this.XLObj,i,r=document.activeElement,f,u;r&&r.tagName==="DIV"&&(i=t.element.find("#"+t._id+"_AutoComplete"),i.val(n(r).text()),i.data("ejAutocomplete").search(),this._isACPositioned||(f=t.element.find("#"+t._id+"_Edit")[0],u=this._editCell[0].getBoundingClientRect(),this._acPosition.left=u.left+window.pageXOffset,this._acPosition.top=u.top+window.pageYOffset+n(f).height(),this._isACPositioned=!0),n("#"+t._id+"_AutoComplete_suggestion").css({left:this._acPosition.left,top:this._acPosition.top}))},saveCell:function(){var c,e,b,v,y,o,k,p,w,l,d,s,r,g,f,u,h,t=this.XLObj,nt,a,tt,i;if(t.model.allowEditing&&this._isEdit){if(u=t.getActiveSheetIndex(),h=t.getSheet(u),b=n("#"+t._id+"EditForm"),k=this._editCell,y=h.columns[this._EditCellDetails.columnIndex],p=t.element.find("#"+t._id+"_ValElem"),nt=t.element.find("#"+t._id+"_Edit")[0],a=n(nt).html(),r={columnName:y.field,value:this.getCurrentEditCellData(),pValue:this._EditCellDetails.value,columnObject:y,cell:k},t.model.allowDataValidation&&this._isValidation&&(p.val(r.value),!b.validate().element(p[0])))return!1;if(w=t._getCellIdx(r.cell[0]),i=w.rowIndex,s=w.colIndex,t._trigger("cellSave",r))return;if(this.updateCellValue({rowIndex:i,colIndex:s},r.value),this._textDecoration&&r.cell.find("a").css("text-decoration","none"),g=this._EditCellDetails.value||"",f={sheetIndex:u,rowIndex:i,colIndex:s,cValue:r.value,reqType:"edit",iconName:"",pValue:g},t.isFormula(r.value)&&(f.operation="formula"),t._setRowHdrHeight(u,i),t.model.scrollSettings.allowScrolling&&t.XLScroll._getRowHeights(u,i),this._isEdit=this._isFormulaEdit=!1,r.cell.removeClass("e-editedcell e-msie-edit"),t.model.allowKeyboardNavigation&&(t.XLCellNav._isNavigate=!0),t.model.showRibbon&&(t.XLRibbon._enableRibbonIcons(),t.XLRibbon._updateRibbonIcons()),t._updateUndoRedoIcons(),t.model.allowInsert||(t.XLRibbon._disableButtons(["inssbtn"],"ejSplitButton"),t.XLRibbon._disableButtons(["insbtn"],"ejButton")),t.model.allowDelete||(t.XLRibbon._disableButtons(["delsbtn"],"ejSplitButton"),t.XLRibbon._disableButtons(["delbtn"],"ejButton")),f.cFormatRule=l=this.getPropertyValue(i,s,"cFormatRule",u),t._dupDetails=!0,t.model.allowConditionalFormats&&l)for(c=0,d=l.length;c<d;c++)o=l[c].split("_"),t.XLCFormat._cFormat(o[0],o[2],o[3],o[4],t._generateHeaderText(u,s+1)+(i+1));return t._dupDetails=!1,f.endCell=h._endCell,f.startCell=h._startCell,r.pValue&&r.value===r.pValue.toString()||t._completeAction(f),e=t.getActiveCellElem(),e&&(t.model.allowComments&&e.hasClass("e-commentcell")&&t.XLComment._visibleCmntCnt(e,!0),e.hasClass("e-hlcell")&&t.XLValidate.highlightInvalidData()),this._shiftKeyEnabled=this._isFBarFocused=!1,t._ctrlKeyCount=0,!this._isFormulaEdit&&t.model.allowSelection&&t.XLSelection._clearBorder(t._formulaBorder.join(" ").replace(/,/g," ")+" "+t._ctrlFormulaBorder.join(" ").replace(/,/g," ")),t.model.allowFormulaBar&&(v=n("#"+t._id+"_inputbox").data("ejAutocomplete"),v&&v.hide()),this._editElem.hide(),t.setSheetFocus(),t._browserDetails.name==="mozilla"&&(a=a.slice(0,-4)),a.indexOf("<br>")>-1&&t.setWrapText(),this._editCell.hasClass("e-sswraptext")&&(tt=t._getCellIdx(this._editCell[0]),i=tt.rowIndex,h.rowsHeightCollection[i]=this._editCell[0].offsetHeight,t._setRowHdrHeight(u,i),t._isRowViewable(u,i)&&n(t.getRows(u)[1][this._editCell.parent().rowIndex]).height(t.model.sheets[u].rowsHeightCollection[i]),t.XLScroll._getRowHeights(u,i)),!0}},updateValue:function(n,t,i,r){var f=this.XLObj,u=f.getRangeIndices(n);this.updateCellValue({rowIndex:u[0],colIndex:u[1]},t,i,r)},updateCellValue:function(n,t,i,r){if(n){var u=this.XLObj,f=n.colIndex,e=n.rowIndex,r=u._getSheetIndex(r);u.isFormula(t)?(this._refreshCalcEngine(e,f,!0,t,r),this._updateDataContainer({rowIndex:e,colIndex:f},{dataObj:{value:t},sheetIdx:r}),u._applyFormula(r,e,f),u._isFormulaSuggestion=!1):(this.updateCell({rowIndex:e,colIndex:f},t,r),this._refreshCalcEngine(e,f,!1,null,r));u.model.allowCellFormatting&&u.XLFormat._hasFormat(i)&&u.XLFormat._updateFormatClass(n,i)}},updateCell:function(n,i,r){if(n){var o=this.XLObj,s=n.rowIndex,h=n.colIndex,e=t.Spreadsheet.CellType,f=this._parseValue(i),u=o.getRangeData([s,h,s,h],!1,["formatStr","type","thousandSeparator","decimalPlaces"],r)[0];u.type&&u.type!=e.General&&(f.type=u.type,delete f.formatStr);(u.formatStr||u.type===e.Scientific||u.type===e.Fraction)&&(f.value2=o.XLFormat._format(f.value,{formatStr:u.formatStr,type:u.type,thousandSeparator:u.thousandSeparator,decimalPlaces:u.decimalPlaces}));this._updateDataContainer(n,{dataObj:f,sheetIdx:r})}},_parseValue:function(i){i=this.XLObj.isNumber(i)?Number(i):i||"";var c,u,l,e,f=this.XLObj,s=f.model.locale,o=t.Spreadsheet.CellType,r=i+"",v=o.General,y=t.preferredCulture(s).numberFormat[","]||",",h=t.preferredCulture(s).calendar.patterns,a=r.indexOf(f._currencySymbol);if((a===0||a>-1&&a===r.length-1)&&(u=t.parseFloat(r,10,s),u))return e=f._decimalCnt(u),{type:o.Currency,value:u,value2:r,formatStr:f._getFormatString(o.Currency,e),decimalPlaces:e};if(n.trim(r).indexOf(f._percentSymbol)>-1&&(u=n.trim(r).replace(f._percentSymbol,""),f.isNumber(u)))return e=f._decimalCnt(u),{type:o.Percentage,value:Number(u)/100,value2:r,formatStr:f._getFormatString(o.Percentage,e),decimalPlaces:e};if(r.indexOf(f._decimalSeparator)>-1&&r.indexOf(y)>-1&&(u=t.parseFloat(r,10,s),u))return e=f._decimalCnt(u),{type:o.Number,value:u,value2:r,formatStr:f._getFormatString(o.Number,e),decimalPlaces:e};for(c in h)if(u=t.parseDate(r,h[c],s),u)return c==="T"&&(u=t.parseDate("1/1/1900 "+r,h.d+"\t"+h.T,s)),l="{0:"+h[c]+"}",r=f.XLFormat._format(u,{type:o.DateTime,formatStr:l}),{type:o.DateTime,value:u,value2:r,formatStr:l};return(r.toLowerCase()==="true"||r.toLowerCase()==="false")&&(i=r=r.toUpperCase()),{type:v,value:i,value2:r}},updateCellWithContainer:function(n,i,r,u){for(var h,s,o,f,c,a=0,y=0,e=this.XLObj,r=e._getSheetIndex(r),i=i?i:e.getSheet(r).selectedRange,l=e.XLSelection._getSelectedRange({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]}),v=l.length;a<v;)c=l[a],o=c.rowIndex,u&&e._isHiddenRow(o)||(s=c.colIndex,f=n[y],h=e.getCell(o,s,r),this._updateDataContainer(c,{dataObj:f}),this._refreshCalcEngine(o,s,e.isFormula(f.value),f.value),h&&f.format&&e.addClass(h[0],f.format),h&&f.hyperlink&&h.html(t.buildTag("a.e-hyperlinks",f.value2,"","cellAdr"in f.hyperlink?{href:"#"}:{href:f.hyperlink.webAdr,target:"_blank"})),f.comment&&e.XLComment.setComment([o,s,o,s],null,!1),f.border&&e.XLFormat.applyBorder(e._getBorderInput(f.border),e._getAlphaRange(r,o,s,o,s)),y++),a++;e.model.allowConditionalFormats&&e.XLCFormat.refreshCFormat(i)},_refreshCellAlignment:function(n){n=n||{};var f,e=t.Spreadsheet.Align,u=this.XLObj,i=n.cellIdx.rowIndex,r=n.cellIdx.colIndex;e in n||(n.value=t.isNullOrUndefined(n.value)?this.getPropertyValue(i,r,"value"):n.value,u.isFormula(n.value)&&(n.value=u.XLEdit.getPropertyValue(i,r,"calcValue")),n.type=n.type?n.type:this.getPropertyValue(i,r,"type"),(u.isNumber(n.value)||typeof n.value=="object")&&n.type!==t.Spreadsheet.CellType.Text?n.align=e.right:u._isBool(n.value)&&(n.align=e.center));f=this.getPropertyValue(i,r,"align");(!n.align||f&&f!=n.align)&&u.clearRangeData([i,r,i,r],["align"]);n.align&&this._updateDataContainer(n.cellIdx,{dataObj:{align:n.align}})},_editingHandler:function(i){var nt,r=this.XLObj,o,u,e,p,c,l,w,g,v,rt,ut,h;if(!(i.keyCode===61||!i.shiftKey&&i.keyCode===32||i.keyCode>=48&&i.keyCode<=59||i.keyCode>=65&&i.keyCode<=90||i.keyCode>=96&&i.keyCode<=111||i.keyCode===173||i.keyCode>=186&&i.keyCode<=192||i.keyCode>=219&&i.keyCode<=222||i.keyCode>=226)||i.ctrlKey||i.altKey)if(i.keyCode!==113||i.shiftKey||i.ctrlKey)if(i.keyCode===27&&this._isEdit)o=r.getActiveSheetIndex(),u=r.getSheet(o),l=u._activeCell.rowIndex,w=u._activeCell.colIndex,e=r.getCell(l,w),p=r._dataContainer.sheets[o],c=l in p&&w in p[l]?p[l][w]:c,r.element.find("#"+r._id+"_Edit").hide(),nt=r._isRowViewable(o,l),nt?(this._refreshTextNode(e[0],r.isUndefined(c)?"":typeof c.value2=="string"?c.value2:r._dataContainer.sharedData[c.value]),r.setSheetFocus(),r._setRowHdrHeight(o,u._selectedCells[0].rowIndex)):r.model.allowFormulaBar&&r.updateFormulaBar(),this._isFormulaEdit&&n("#"+r._id+"_AutoComplete").data("ejAutocomplete").suggestionList.hide(),this._isEdit=this._isFormulaEdit=this._isFBarFocused=!1,r._getContent(o).find("td").removeClass(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")),nt&&(r.model.allowComments&&e.hasClass("e-commentcell")&&r.XLComment._visibleCmntCnt(e,!0),r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement(),e.removeClass("e-editedcell e-msie-edit")),r.model.showRibbon&&r.XLRibbon._enableRibbonIcons(),r._getContent(r.getActiveSheetIndex()).find(".e-error").remove(),t.isNullOrUndefined(r.XLCellNav)||(r.XLCellNav._isNavigate=!0);else if(i.keyCode===46)if(this._isEdit)r._ctrlKeyCount>0&&(r._ctrlKeyCount=0,r._formulaRange=[],r.XLSelection._clearBorder(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")));else{if(r._preventctrlkey){r._showAlertDlg("Alert","CtrlKeyErrorAlert","CtrlKeyErrorAction",450);return}o=r.getActiveSheetIndex();u=r.getSheet(o);e=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex);var s,b,tt,k,d,a,it,et=new RegExp("\\be-format.*?\\b","g"),y,f=u._selectedCells,ft=r.getRangeData([f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex]);if(r.model.allowLockCell&&u._isSheetProtected&&r._israngeProtected(f)){r._popUplockCellAlert();return}if(!this._isEdit){for(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),g=r.model.sheets[o]._tableManager,rt=r.getObjectKeys(g),k=1,d=r.getObjectLength(g);k<=d;k++)if(v=g[rt[k]].range,r.XLClipboard._compareRange([f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex],v)){it=r._getAlphaRange(o,v[0],v[1],v[2],v[3]);r.clearAll(it);return}for(r._hasClass(e,"e-readonly")||r.clearRangeData(null,["value2","value","hyperlink"]),s=0,tt=f.length;s<tt;s++)if(e=r.getCell(f[s].rowIndex,f[s].colIndex),r._textClip(f[s].rowIndex,f[s].colIndex,"delete"),!r._hasClass(e,"e-readonly")){if(r.model.allowFormulaBar&&r._getInputBox().val(""),y=this.getPropertyValueByElem(e,"cFormatRule"),r.model.allowConditionalFormats&&y&&y.length)for(b=0,d=y.length;b<d;b++)a=y[b].split("_"),r.XLCFormat._cFormat(a[0],a[2],a[3],a[4],a[5]);r._setRowHdrHeight(o,f[s].rowIndex)}r.XLSelection._refreshBorder()}ut={sheetIndex:o,range:[f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex],bData:ft,reqType:"clear-content"};r._completeAction(ut)}else i.ctrlKey||i.shiftKey||i.keyCode!==8?(i.keyCode!==13||i.altKey)&&i.keyCode!==9||!this._isEdit||!r.model.allowKeyboardNavigation||r.XLCellNav._isNavigate||this._isFormulaEdit?i.keyCode===13&&i.altKey&&this._isEdit&&(i.preventDefault(),h=r.element.find("#"+r._id+"_Edit"),r._browserDetails.name==="msie"?h.html(h.html()+" <br>"):h.html(h.html()+" <br> <br>"),h.focus(),r._browserDetails.name!=="msie"&&h.altEnter()):(i.preventDefault(),t.isNullOrUndefined(r.XLCellNav)||(r.XLCellNav._isNavigate=!0)):(o=r.getActiveSheetIndex(),u=r.getSheet(o),e=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this._isEdit||r._hasClass(e,"e-readonly")||r._hasClass(e,"e-cellreadonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),e=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),e.empty(),this.editCell(u._activeCell.rowIndex,u._activeCell.colIndex,!1),r._setRowHdrHeight(o,u._activeCell.rowIndex),r.model.allowFormulaBar&&r._getInputBox().val("")));else o=r.getActiveSheetIndex(),u=r.getSheet(o),e=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this._isEdit||r._hasClass(e,"e-readonly")||r._hasClass(e,"e-cellreadonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),this.editCell(u._activeCell.rowIndex,u._activeCell.colIndex,!0),r.XLCellNav._isNavigate=!1);else o=r.getActiveSheetIndex(),u=r.getSheet(o),e=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this._isEdit||r._hasClass(e,"e-readonly")||r._hasClass(e,"e-cellreadonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),this.editCell(u._activeCell.rowIndex,u._activeCell.colIndex,!1))},_focusElements:function(t){n(t).not(":hidden").focus().setInputPos(n(t).text().length)},_updateUsedRange:function(n,t){var r=this.XLObj,i=r.model.sheets[r.getActiveSheetIndex()]._usedRange;i.rowIndex<n&&(i.rowIndex=n);i.colIndex<t&&(i.colIndex=t)},_updateDataContainer:function(i,r){var h,d,vt,w,l,yt,pt,ut,ft,e,f,s,o,g,y,p,et,ot,st,ht,wt,a,nt,k,bt,kt,tt,v,ct,it,rt,lt,at=!1,c=r.dataObj,u=this.XLObj,b=u._getSheetIndex(r.sheetIdx),dt=u.getSheet(b);if(!r.skipCell&&u._isRowViewable(b,i.rowIndex)&&(w=u.getCell(i.rowIndex,i.colIndex,b),l=w[0]),u.getObjectLength(c)){ut=t.Spreadsheet.CellType;ft=t.Spreadsheet.Align;a=u._dataContainer;y=i.colIndex;p=i.rowIndex;o=u._cellProp;nt=a.sheets[b];p in nt?(k=nt[p],y in k?e=k[y]:k[y]=e={}):(k=nt[p]={},k[y]=e={});l&&(u._hasClass(l,"e-sswraptext")?(u._removeClass(l,"e-sswraptext"),cellHeight=w.height(),u.addClass(l,"e-sswraptext")):cellHeight=w.height(),this.getPropertyValue(i.rowIndex,i.colIndex,"wrap")&&this.getPropertyValue(i.rowIndex,i.colIndex,"merge")&&(v=w.find("#"+u._id+"_MergeWrap")[0].lastChild,v?v.nodeType===1&&u._hasClass(v,"e-hyperlinks")?v.textContent="":v.nodeType===1&&u._hasClass(v,"e-comment")?v.lastChild.textContent="":v.textContent="":w.find("#"+u._id+"_MergeWrap")[0].textContent="",yt=w.find("#"+u._id+"_MergeWrap")[0].innerHTML,w.find("#"+u._id+"_MergeWrap").remove()));for(h in c){s=c[h];switch(h){case o[0]:case o[4]:case o[5]:case o[11]:f=a.sharedData.indexOf(s);f===-1&&(f=a.sharedData.push(s),f--);e[h]=f;(!dt._isImported||dt._isLoaded)&&!u._isInitLoad&&h===o[0]&&u.model.allowCharts&&(at=!0);break;case o[1]:if(c.type!=ut.General&&c.type!=ut.Text?e[h]=c.value2:(f=a.sharedData.indexOf(c.value2),f===-1&&(f=a.sharedData.push(c.value2),f--),e[h]=f),l){if(wt=l.getElementsByTagName("a"),wt.length)this._refreshTextNode(l,c.value2);else if(e[o[24]]>-1){if(st=a.sheetCellType[e[o[24]]],ht=st.id,n("#"+ht).length===0)return;if(c.value2)switch(st.type){case"Button":n("#"+ht).ejButton("instance").option("text",c.value2)}}else et=c.value2.length>7&&!isNaN(new Date(c.value2).valueOf()),ot=["true","yes","false","no"].indexOf(c.value2.toString().toLowerCase())>-1,u.model.allowCellType&&u.model.allowAutoCellType&&(et||ot)?et?(u.XLCellType._renderControls(p,y,b,{type:"DatePicker"}),n("#"+u._dataContainer.sheetCellType[e[o[24]]].id).ejDatePicker("instance").option("value",c.value2)):ot&&(u.XLCellType._renderControls(p,y,b,{type:"CheckBox"}),n("#"+u._dataContainer.sheetCellType[e[o[24]]].id).ejCheckBox("instance").option("checked",["true","yes"].indexOf(c.value2.toString().toLowerCase())>-1?!0:!1)):(this._skipHTML?l.innerHTML.concat(c.value2):this._refreshTextNode(l,c.value2),rt=a.sheets[b][p][y].ddlRange,rt&&(lt=a.sheetCellType[a.sheets[b][rt.rowIndex][rt.colIndex].cellType],n("#"+lt.id).ejDropDownList("instance").option("dataSource",u.getRangeData(u.getRangeIndices(lt.dataSourceRange),"","",b))));this._refreshCellAlignment({cellIdx:i,value:c.value,type:c.type})}tt=this.getPropertyValue(p,y,"value2");(tt||c.value2)&&(ct=t.isNullOrUndefined(tt)?!0:tt.length<=c.value2.length?!0:!1,u._textClip(p,y,ct?"add":"delete"),ct||u._textClip(p,y,"add"));e.isDirty=!0;break;case o[2]:e[h]=a.cellType.indexOf(c.type);break;case o[3]:for(d=0,vt=s.length;d<vt;)f=a.cFormatData.indexOf(s[d]),f===-1&&(f=a.cFormatData.push(s[d]),f--),e[h]?e[h].indexOf(f)===-1&&e[h].push(f):e[h]=[f],d++;break;case o[6]:f=a.valData.indexOf(s.customVal);f===-1&&(f=a.valData.push(s.customVal),f--);e[h]=JSON.parse(JSON.stringify(s));e[h].customVal=f;break;case o[7]:case o[8]:l&&(bt=h===o[8]?"e-border":"e-format",kt=new RegExp("\\b"+bt+".*?\\b","g"),l.className=l.className.replace(kt,""),u.addClass(l,s));f=a.hashCode.indexOf(s);f===-1&&(f=a.hashCode.push(s),f--);e[h]=f;break;case o[9]:case o[10]:e[h]?e[h].indexOf(s)===-1&&e[h].push(s):e[h]=[s];break;case o[12]:e[h]=s;l&&(s===ft.center?u.addClass(l,u._cAlign):s===ft.right&&u.addClass(l,u._rAlign));break;case o[14]:case o[16]:it=u.XLFormat.getFormatHashCode(s);f=a.hashCode.indexOf(it);f===-1&&(u.XLFormat._createFormatClass(s,it),f=a.hashCode.push(it),f--);e[h]=f;break;case o[15]:case o[17]:s=u.XLFormat._getBorderHashCode(s,!0);f=a.hashCode.indexOf(s);f===-1&&(f=a.hashCode.push(s),f--);e[h]=f;break;default:e[h]=s}this._updateUsedRange(i.rowIndex,i.colIndex)}at&&(u.XLChart._refreshChartElements(p,y,b),at=!1);this.getPropertyValue(i.rowIndex,i.colIndex,"wrap")&&this.getPropertyValue(i.rowIndex,i.colIndex,"merge")&&(pt=this.getPropertyValue(i.rowIndex,i.colIndex,"value2"),this._refreshTextNode(l),l.innerHTML="<div id ="+u._id+"_MergeWrap style = 'border :0px;overflow: hidden;max-height:"+cellHeight+"px'>"+l.innerHTML.concat(yt||"")+"<\/div>",v=w.find("#"+u._id+"_MergeWrap")[0].lastChild,value=c.value2||pt,v?v.nodeType===1&&u._hasClass(v,"e-hyperlinks")?v.textContent=value:v.nodeType===1&&u._hasClass(v,"e-comment")?(v.lastChild.textContent=this.getPropertyValue(i.rowIndex,i.colIndex,"comment").value,w.find("#"+u._id+"_MergeWrap").append(value)):v.textContent=value:w.find("#"+u._id+"_MergeWrap")[0].textContent=value);u.getObjectLength(e)===3&&(g=u.getRangeData([p,y,p,y],!1,o.slice(0,3))[0],g.value===""&&g.value2===""&&g.type===t.Spreadsheet.CellType.General&&u.clearRangeData([p,y,p,y],o.slice(0,3)))}else l&&this._refreshTextNode(l)},_clearDataContainer:function(i){var a,f,b,v,o,l,y,p,k,u=this.XLObj,c=u._getSheetIndex(i.sheetIdx),s=u._cellProp,r=i.cellIdx.rowIndex,e=i.cellIdx.colIndex,w=i.property||[],d=u._dataContainer,h=d.sheets[c],g=this.getPropertyValue(r,e,"value2");if(w.length&&r in h&&e in h[r]){for(l=h[r][e],a=w.length,!i.skipCell&&u._isRowViewable(c,r)&&(f=u.getCell(r,e,c));a--;){value=null;p=!1;o=w[a];switch(o){case s[0]:value=this.getPropertyValue(r,e,o,c);u.model.allowCharts&&u.XLChart._refreshChartElements(r,e,c);p=!0;break;case s[1]:f&&this._refreshTextNode(f[0]);g&&u._textClip(r,e,"delete");break;case s[3]:value=this.getPropertyValue(r,e,o,c);value&&f&&n(f).removeClass("e-redft e-yellowft e-greenft e-redf e-redt e-hlcell");break;case s[7]:case s[8]:value=this.getPropertyValue(r,e,o,c);value&&f&&u._removeClass(f[0],value);break;case s[12]:value=l[o];value&&f&&u._removeClass(f[0],value===t.Spreadsheet.Align.center?u._cAlign:u._rAlign);break;case s[13]:if(value=l[o],value&&f){if(y=f[0].lastChild.textContent,i.status==="clear-content"){f[0].lastChild.textContent="";break}else if(i.status==="clear-format"){v=f.find("a");u._hasClass(v[0],"e-hyperlinks")&&v.css({color:"#444445","text-decoration":"none"}).removeClass("e-hyperlinks");break}f.find("a").remove();t.isNullOrUndefined(f[0].lastChild)?f[0].textContent=y:f[0].lastChild.textContent=y}break;case s[18]:value=l[o];value&&f&&(f.removeClass("e-filterhdr"),f.find(".e-filterspan").remove());break;case s[21]:u.XLComment.deleteComment([r,e,r,e]);break;case s[5]:case s[22]:case s[23]:k=u._dupDetails;b=u._getAlphaRange(c,r,e,r,e);u.XLFormat.format({type:"general"},b);u._dupDetails=k}i.status==="clear-content"&&o==="hyperlink"?this.getPropertyValue(r,e,o,c)&&(delete h[r][e][o].webAddr,delete h[r][e][o].cellAddr):delete h[r][e][o];p&&this._refreshCalcEngine(r,e,u.isFormula(value),value)}u.getObjectLength(h[r][e])||delete h[r][e];u.getObjectLength(h[r])||delete h[r]}},getPropertyValue:function(i,r,u,f){var e,h,o,l=0,y=0,p=t.Spreadsheet.CellType,c=this.XLObj,s=c._dataContainer,a=s.sheets,v=c._cellProp;if(f=c._getSheetIndex(f),f in a&&i in a[f]&&r in a[f][i]&&(h=a[f][i][r],!t.isNullOrUndefined(h))){u=u?u:"value";o=h[u];switch(u){case"value":case"range":case"thousandSeparator":case"calcValue":e=s.sharedData[o];break;case"format":case"border":e=s.hashCode[o];break;case"value2":e=[p.General,p.Text].indexOf(s.cellType[h.type])===-1?h.value2:s.sharedData[h.value2];break;case"type":e=s.cellType[h.type];break;case"cFormatRule":for(e=[],c.isUndefined(o)||(y=o.length);l<y;)h[u][l]in s.cFormatData&&e.push(s.cFormatData[h[u][l]]),l++;break;case"rule":c.isUndefined(o)||(e={},n.extend(!0,e,o),e.customVal=s.valData[e.customVal]);break;case v[14]:case v[15]:case v[16]:case v[17]:c.isUndefined(o)||(e=s.hashCode[o],e=e.indexOf("e-format")===-1?c.XLFormat.getBorderFromHashCode(e,!0):c.XLFormat.getFormatFromHashCode(e));break;default:e=o}}return e},getPropertyValueByElem:function(n,i,r){if(!t.isNullOrUndefined(n[0])){var u=this.XLObj._getCellIdx(n[0]);return this.getPropertyValue(u.rowIndex,u.colIndex,i,r)}},_getPropWithCellIdx:function(n,t,i,r){for(var f,e=[],u=n[0],h=n[2],c=n[3],o=this.XLObj,i=o._getSheetIndex(i),s=o._dataContainer.sheets[i];u<=h;){if(s[u])for(minc=n[1];minc<=c;)s[u][minc]&&(f=this.getPropertyValue(u,minc,t,i),f&&(r?o.isFormula(f)&&e.push({rowIdx:u,colIdx:minc,value:f}):e.push({rowIdx:u,colIdx:minc,value:f}))),minc++;u++}return e},_refreshCalcEngine:function(n,i,r,u,f){var l,s,e,h=this.XLObj,f=h._getSheetIndex(f),c=h.getSheet(f),o=h._sheets[f]._calcEngine;r?(l=new ValueChangedArgs(n+1,i+1,u),o.valueChanged(c._sheetName.value,l)):(s=CalcEngine.getSheetFamilyItem(c._sheetName.value),e=RangeInfo.getAlphaLabel(i+1)+(n+1),o.isSheetMember()&&!t.isNullOrUndefined(s.parentObjectToToken)&&(e=s.parentObjectToToken.getItem(c._sheetName.value)+e),o.getFormulaInfoTable().containsKey(e)&&(o.getFormulaInfoTable().remove(e),o.getDependentCells().contains(e)&&o.clearFormulaDependentCells(e)),o.refresh(e))},_refreshTextNode:function(n,i){i=t.isNullOrUndefined(i)?"":i;var r=n.lastChild;r&&(r.nodeType===3||r.nodeType===1&&r.tagName==="A")?r.textContent=i:n.appendChild(document.createTextNode(i))},_formulaSelect:function(n){var u=this.model.nameManager.length,t=0,f=!1,i,r=n.text;if(u)while(t<u){if(this.model.nameManager[t].name===r.slice(1)){f=!0;break}t++}i=f?r:r+"(";this.XLEdit._editElem.text(i);this.model.allowFormulaBar&&this._getInputBox().val(i);this._isFormulaSuggestion=!1;this.XLCellNav._canKeyBoardNavigate=!1},_formulaBoxInputChange:function(n){var r=this.getActiveSheetIndex(),t=this.getSheet(r)._activeCell,i=this.element.find("#"+this._id+"_Edit");this.XLEdit._isFormulaEdit=!n.target.value.indexOf("=");this.XLEdit._isFormulaEdit&&this.XLEdit._processFormulaEditRange(n.target.value,!0);this.XLEdit._isEdit||(this.XLEdit.editCell(t.rowIndex,t.colIndex,!0),i=this.element.find("#"+this._id+"_Edit"));i.text(n.target.value);n.target.focus();this.XLEdit._isCellEdit=!1},_formulaSuggestionStatus:function(n){this._isFormulaSuggestion=n.type==="open"},_updateFormulaCellRange:function(n,t){var u,r=this.XLObj,f=r.element.find("#"+r._id+"_Edit").not(":hidden"),i=f.text(),e=i[i.length-1];t&&this._validCharacters.indexOf(e)===-1?i=i+",":(u=this._getCharPosition(i),u>-1&&(i=i.substr(0,[u+1])));n=i+n;f.text(n);r.model.allowFormulaBar&&r._getInputBox().val(n)},_getCharPosition:function(n){for(var t=n.length;t--;)if(this._validCharacters.indexOf(n[t])>-1)return t;return-1},_processFormulaEditRange:function(t,i){var f,e,u=0,r=this.XLObj,o=r.XLDragFill._parseFormula(t),s=o.length;for(r._ctrlKeyCount=0,r._formulaRange=[],r._ctrlKeyEnabled=!1,r.XLSelection._clearBorder(r._arrayAsString(r._ctrlFormulaBorder.concat(r._formulaBorder)));u<s;){if(f=o[u],this._invalidOperators.indexOf(f)>-1)break;r._isCellReference(f)&&(o[u+1]===":"&&(u++,r._isCellReference(o[u+1])&&(f=f+":"+o[u+1],u++)),this._updateFormulaEditRange(f,r._ctrlKeyCount),r._ctrlKeyCount++);u++}e=t.charAt(t.length-1);e==="("&&t.split("(").length===2?(r._isFormulaSuggestion=!1,r.model.allowFormulaBar&&r._getInputBox().val(t),i?n("#"+r._id+"_inputbox_suggestion").hide():r._getFormulaSuggElem().hide()):e===")"&&r.isFormula(t)&&(r.XLEdit._isFormulaEdit=!1,r._formulaRange=[],r._ctrlKeyCount=0);e===":"?(r._shiftKeyEnabled=!0,r._ctrlKeyCount--):this._validOperators.indexOf(e)>-1&&(r._dStartCell=r.getSheet(r.getActiveSheetIndex())._activeCell,r._ctrlKeyEnabled=!0,r._shiftKeyEnabled=!1)},_updateFormulaEditRange:function(n,t){var i=this.XLObj,r=i.getRangeIndices(n);i._formulaRange[t]=n;i._dStartCell={rowIndex:r[0],colIndex:r[1]};i._dEndCell={rowIndex:r[2],colIndex:r[3]};i.XLSelection._focusBorder(i._dStartCell,i._dEndCell,i._formulaBorder[t%6])},calcOption:function(t){var i=this.XLObj,u,f,o=i.getActiveSheetIndex(),r,e;for(t?(n("#"+i._id+"_CalcAuto").find("span").addClass("e-ss-calcauto"),n("#"+i._id+"_CalcManual").find("span").removeClass("e-ss-calcauto")):(n("#"+i._id+"_CalcManual").find("span").addClass("e-ss-calcauto"),n("#"+i._id+"_CalcAuto").find("span").removeClass("e-ss-calcauto")),r=1,e=i._sheets.length;r<e;r++)u=i._sheets[r]._calcEngine,t?(u.setCalculatingSuspended(!1),f=i.getSheet(r)._usedRange,i.setActiveSheetIndex(r),u.refreshRange(RangeInfo.cells(1,1,f.rowIndex+1,f.colIndex+1))):u.setCalculatingSuspended(!0);i.setActiveSheetIndex(o)},calcNow:function(n){var t=1,r,u,i=this.XLObj,f=i._sheets.length,e=i.getActiveSheetIndex();for(n&&(t=n,f=n+1);t<f;t++)r=i._sheets[t]._calcEngine,r.setCalculatingSuspended(!1),u=i.getSheet(t)._usedRange,i.setActiveSheetIndex(t),r.refreshRange(RangeInfo.cells(1,1,u.rowIndex+1,u.colIndex+1)),r.setCalculatingSuspended(!0);i.setActiveSheetIndex(e)},_rangeHasProperty:function(n,t,i){n&&(i=this.XLObj.getRangeData(n,!1,[t]));for(var r=0,u=i.length;r<u;){if(i[r][t])return!0;r++}},saveEditingValue:function(){var r,u,t,f,n,i,c,l,e,o={},s,a,v,p=this.XLObj,y=p._dataContainer,h;for(f=Object.getOwnPropertyNames(y.sheets),o.EditedData=[],t=0,c=f.length;t<c;t++)for(conSheet=y.sheets[f[t]],e=Object.getOwnPropertyNames(conSheet),r=0,a=e.length;r<a;r++)for(n=parseInt(e[r]),s=Object.getOwnPropertyNames(conSheet[n]),u=0,v=s.length;u<v;u++)i=parseInt(s[u]),conSheet[n][i].isDirty&&(h=parseInt(f[t]),l={SheetIndex:h,Value:this.getPropertyValue(n,i,"value2",h),CellIndex:{RowIndex:n,ColIndex:i}},delete conSheet[n][i].isDirty,o.EditedData.push(l));return o}};n.fn.focusEnd=function(){var r;n(this).focus();var u=n("<span />").appendTo(n(this)),f=u.get(0),t=null,i=null;return document.selection?(t=document.body.createTextRange(),t.moveToElementText(f),t.select()):window.getSelection&&(r=this[0],t=document.createRange(),i=window.getSelection(),t.setStart(r,1),t.collapse(!0),i.removeAllRanges(),i.addRange(t),r.focus()),u.remove(),this};n.fn.altEnter=function(){n(this).focus();var r=n("<span />").appendTo(n(this)),u=r.get(0),t=null,i=null;return document.selection?(t=document.body.createTextRange(),t.moveToElementText(u),t.select()):window.getSelection&&(t=document.createRange(),t.selectNode(u),i=window.getSelection(),i.removeAllRanges(),i.addRange(t)),r.remove(),this}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.validation=function(n){this.XLObj=n;this._ruleSymbols={Greater:">",GreaterOrEqual:">=",Less:"<",LessOrEqual:"<=",Equal:"==",NotEqual:"!=",Between:">=&&<=&&=",NotBetween:">=&&<=&&!"}};t.spreadsheetFeatures.validation.prototype={_setValidation:function(){this.XLObj.model.allowDataValidation&&n.validator&&(this._initValidator(),this._setValidationToField())},_initValidator:function(){var i=n("#"+this.XLObj._id+"EditForm");i.validate({errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(i,r){var u=n("#"+n(r).parents("div")[0].id).data("ejSpreadsheet"),o=u._getContent(u.getActiveSheetIndex()).find(".e-content"),f=u.XLEdit._editCell,e=n(i).addClass("e-error");o.append(e);e.prepend(t.buildTag("div.e-errortail e-toparrow"));e.css({left:f[0].offsetLeft,top:f[0].offsetTop+f.height()})}})},_setValidationToField:function(){var n=this.XLObj,i=n.XLEdit.getPropertyValueByElem(n.getActiveCellElem(),"rule"),r;delete i.type;delete i.isApply;n.element.find("#"+n._id+"_ValElem").rules("add",i);r=n.element.find("#"+n._id+"EditForm").validate();t.isNullOrUndefined(i.required)||(r.settings.messages[name]={},r.settings.messages[name].required=n.XLEdit._EditCellDetails.fieldName+(n.XLEdit._EditCellDetails.rowIndex+1)+" is required");n.XLEdit._isValidation=!0},applyDVRules:function(n,r,u,f,e){var p,a,h={},s=this.XLObj,c=s.getActiveSheetIndex(),w=s.getSheet(c),b=!1,l,o,k,v,y;if(t.isNullOrUndefined(n)?o=s.getSheet(c)._selectedCells:(typeof n=="string"&&(l=s.getRangeIndices(n)),o=s.XLSelection._getSelectedRange({rowIndex:l[0],colIndex:l[1]},{rowIndex:l[2],colIndex:l[3]})),s.model.allowDataValidation){h.required=!f;(r[0]!="Between"||r[0]!="NotBetween")&&r.length<3&&r.push("");switch(u){case"number":r.push("parseInt");h.digits=!0;r.push("number");break;case"decimal":r.push("parseFloat");h.number=!0;r.push("decimal");break;case"date":r.push("parseDate");h.date=!0;r.push("date");break;case"time":r.push("parseTime");r.push("time");break;case"text":r[1]="^"+r[1];r[2]="^"+r[2];r.push("length");r.push("text");break;case"list":k=r[1];r=[];r.push(k);r.push("list")}for(r.push(e),r.push(s._getSelectedItems(c,n)[1]),r.push(c),h.customVal=r.join("_"),h.isApply=!1,h.type=u,v=[],y={},i=0,len=o.length;i<len;i++)y={rowIndex:o[i].rowIndex,colIndex:o[i].colIndex,prevRule:s.XLEdit.getPropertyValue(o[i].rowIndex,o[i].colIndex,"rule")},s._isRowViewable(c,o[i].rowIndex)&&(a=s.getCell(o[i].rowIndex,o[i].colIndex),a.hasClass("e-hlcell")&&(b=!0),a.removeData("rule"),a.removeClass("e-hlcell")),s.XLEdit._updateDataContainer({rowIndex:o[i].rowIndex,colIndex:o[i].colIndex},{dataObj:{rule:h}}),v.push(y);b===!0&&this.highlightInvalidData();w._isImported&&!w._isLoaded||s._isUndoRedo||(p={sheetIndex:c,reqType:"validation",operation:"apply-validation",selectedCells:v,range:s._getAlphaRange(c,o[0].rowIndex,o[0].colIndex,o[o.length-1].rowIndex,o[o.length-1].colIndex)},s._completeAction(p))}},clearDV:function(n){var r=this.XLObj,f,h,i,e,o,s,u,c;if(r.model.allowDataValidation){for(e=r.getActiveSheetIndex(),o={sheetIndex:e,reqType:"validation",operation:"clear-validation",selCells:[]},t.isNullOrUndefined(n)?(f=r.model.sheets[e]._selectedCells,i=r.XLSelection._getSelectedRange({rowIndex:f[0].rowIndex,colIndex:f[0].colIndex},{rowIndex:f[f.length-1].rowIndex,colIndex:f[f.length-1].colIndex})):(s=r.getRangeIndices(n),i=r.XLSelection._getSelectedRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]})),u=0,c=i.length;u<c;u++)o.selCells.push({rowIndex:i[u].rowIndex,colIndex:i[u].colIndex,rules:r.XLEdit.getPropertyValue(i[u].rowIndex,i[u].colIndex,"rule")}),r.clearRangeData(null,["rule"],[{rowIndex:i[u].rowIndex,colIndex:i[u].colIndex}]),r._isRowViewable(e,i[u].rowIndex)&&(h=r.getCell(i[u].rowIndex,i[u].colIndex),o.hlStatus=h.hasClass("e-hlcell"),h.removeClass("e-hlcell"));o.range=r._getAlphaRange(e,i[0].rowIndex,i[0].colIndex,i[i.length-1].rowIndex,i[i.length-1].colIndex);r._isUndoRedo||r._completeAction(o)}},clearHighlightedValData:function(n){var r=this.XLObj,i,o,f,e,u,s,h;if(r.model.allowDataValidation){for(f=r.getActiveSheetIndex(),t.isNullOrUndefined(n)?i=r.model.sheets[f]._selectedCells:(e=r.getRangeIndices(n),i=r.XLSelection._getSelectedRange({rowIndex:e[0],colIndex:e[1]},{rowIndex:e[2],colIndex:e[3]})),u=0,s=i.length;u<s;u++)r._isRowViewable(f,i[u].rowIndex)&&(o=r.getCell(i[u].rowIndex,i[u].colIndex),o.removeClass("e-hlcell")),t.isNullOrUndefined(r.XLEdit.getPropertyValue(0,8,"rule"))||(r._dataContainer.sheets[f][i[u].rowIndex][i[u].colIndex].rule.isApply=!1);r._isUndoRedo||(h={sheetIndex:f,reqType:"validation",operation:"cl-hl-data",range:t.isNullOrUndefined(n)?this.XLObj._getAlphaRange(1,i[0].rowIndex,i[0].colIndex,i[i.length-1].rowIndex,i[i.length-1].colIndex):n},r._completeAction(h))}},_checkValidation:function(n,i){var r=this.XLObj,c,h,o,s,u,f,e;if(!JSON.parse(i[i.length-3]))return!0;if(n=this._convertValueByType(n,i[4]),i[1]=this._convertValueByType(i[1],i[4]),i[2]=this._convertValueByType(i[2],i[4]),n.length){if(i[i.length-4]==="list"){for(s=!1,h=i[0].indexOf(",")>-1?i[0].split(","):i[0].indexOf("=")>-1?r.getRangeData(r.getRangeIndices(i[0].split("=")[1]),!0):n,o=0,c=h.length;o<c;o++)if(s=h[o].toString()===n,s)break;return t.Spreadsheet.msg=r._getLocStr("ListAlertMsg"),s}return i[0]=this._ruleSymbols[i[0]],i[1].indexOf("=")>-1&&(u=i[1].replace("=",""),f=this.getRangeIndices(u+":"+u),i[1]=r.XLEdit.getPropertyValue(f[0],f[1]).toString()),i[2].indexOf("=")>-1&&(u=i[2].replace("=",""),f=this.getRangeIndices(u+":"+u),i[2]=r.XLEdit.getPropertyValue(f[0],f[1]).toString()),i[0].length<=2?(t.Spreadsheet.msg="The "+i[4]+" should be "+t.Spreadsheet.ValidationText[i[0]]+" "+i[1].replace("^",""),r.operators[i[0]](r.parse[i[3]](n),r.parse[i[3]](i[1]))):(e=[],e=i[0].split("&&"),t.Spreadsheet.msg="The "+i[4]+" should"+t.Spreadsheet.ValidationText[e[2]]+" be between "+i[1].replace("^","")+" and "+i[2].replace("^",""),r.operators[e[2]](r.operators[e[0]](r.parse[i[3]](n),r.parse[i[3]](i[1]))&&r.operators[e[1]](r.parse[i[3]](n),r.parse[i[3]](i[2]))))}return!0},_convertValueByType:function(t,i){if(t.length){var r=this.XLObj;switch(i){case"number":case"decimal":r._isValidDate(t)&&(t=r._dateToInt(t));break;case"date":n.isNumeric(t)&&(t=r.intToDate(t).toString())}}return t},highlightInvalidData:function(n){var u=this.XLObj,c,l,i,h,s,r,o,f,e,a;if(u.model.allowDataValidation){for(f=u.getActiveSheetIndex(),t.isNullOrUndefined(n)?(i=u.model.sheets[f]._selectedCells,n=u._getAlphaRange(f,i[0].rowIndex,i[0].colIndex,i[i.length-1].rowIndex,i[i.length-1].colIndex)):(o=u.getRangeIndices(n),i=u.XLSelection._getSelectedRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]})),r=0,c=i.length;r<c;r++)e=u.XLEdit.getPropertyValue(i[r].rowIndex,i[r].colIndex,"rule"),u.XLEdit.getPropertyValue(i[r].rowIndex,i[r].colIndex)&&!t.isNullOrUndefined(e)?(l=u.XLEdit.getPropertyValue(i[r].rowIndex,i[r].colIndex,"type")==="datetime"?u.XLEdit.getPropertyValue(i[r].rowIndex,i[r].colIndex,"value2").toString():u.XLEdit.getPropertyValue(i[r].rowIndex,i[r].colIndex).toString(),s=e?!this._checkValidation(l,e.customVal.split("_")):!1,u._dataContainer.sheets[f][i[r].rowIndex][i[r].colIndex].rule.isApply=s):t.isNullOrUndefined(e)||(s=e.required),u._isRowViewable(f,i[r].rowIndex)&&(h=u.getCell(i[r].rowIndex,i[r].colIndex),s?h.addClass("e-hlcell"):h.removeClass("e-hlcell"));u._isUndoRedo||(a={sheetIndex:f,reqType:"validation",operation:"hl-data",range:n},u._completeAction(a))}},_replaceRule:function(n,t){this.XLObj._dataContainer.cFormatData[n]=t},_addDVMethod:function(){t.isNullOrUndefined(n.validator)||n.validator.addMethod("customVal",function(t,i,r){var u=n("#"+n(i).parents("div")[0].id).data("ejSpreadsheet"),f=u._getContent(u.getActiveSheetIndex()).find(".e-content");return(f.find(".e-error").remove(),u.model.showRibbon&&!n("#"+u._id+"_Ribbon_freetext").data("ejCheckBox").isChecked())?!0:u.XLValidate._checkValidation(t,r.split("_"))},t.Spreadsheet.getMsg)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.dragFill=function(n){this.XLObj=n;this._customList=[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]];this._property=["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","format","rule"];this._fillInfo=null;this._verticalFill=!1;this._uniqueOBracket=String.fromCharCode(129);this._uniqueCBracket=String.fromCharCode(130);this._uniqueCSeparator=String.fromCharCode(131);this._uniqueCOperator=String.fromCharCode(132);this._uniquePOperator=String.fromCharCode(133);this._uniqueSOperator=String.fromCharCode(134);this._uniqueMOperator=String.fromCharCode(135);this._uniqueDOperator=String.fromCharCode(136);this._uniqueModOperator=String.fromCharCode(137)};t.spreadsheetFeatures.dragFill.prototype={positionAutoFillElement:function(n){var c,r,u,f,v,t,e=0,o=0,l=0,s=0,a=0,h=0,i=this.XLObj,y="e-hide";if(i.model.allowAutoFill&&i.model.allowSelection){if(v=i.getActiveSheetIndex(),t=i.getSheet(v),t._isRowSelected)l=-3,s=-1,a=5,h=4,r=t.selectedRange[2],u=t.selectedRange[1];else if(t._isColSelected)s=-3,h=5,r=t.selectedRange[0],u=t.selectedRange[3];else{if(t._isSheetSelected){this.hideAutoFillElement();return}l=-3;s=-3;a=1;h=3;r=t.selectedRange[2];u=t.selectedRange[3]}c=i._getMergedIdx(r,u);r=c.rowIndex;u=c.colIndex;f=i._getCellInfo({rowIndex:r,colIndex:u});t._isColSelected||(e+=f.height);t._isRowSelected||(o+=f.width);e+=f.top;o+=f.left;i.getAutoFillElem().removeClass(y).css({top:Math.round(e)+l,left:Math.round(o)+s});i.model.autoFillSettings.showFillOptions&&n&&i._getAutoFillOptElem().removeClass(y).css({top:e+a,left:o+h});t._autoFillCell={rowIndex:r,colIndex:u}}},hideAutoFillElement:function(){var n=this.XLObj._getAutoFillOptElem();n&&n.addClass("e-hide")},hideAutoFillOptions:function(){var n=this.XLObj._getAutoFillOptElem();n&&(n.find("button").data("ejSplitButton")._hidePopup(),n.addClass("e-hide"))},autoFill:function(n){if(n=n||{},this.XLObj.model.allowAutoFill&&n.dataRange&&n.fillRange&&n.direction){var r,i=this.XLObj,f=i.getActiveSheetIndex(),e=i.getSheet(f),u=t.Spreadsheet.AutoFillOptions;if(this._fillInfo=this._getFillInfo(n),n.fillType=n.fillType||this._fillInfo.fillType,this._verticalFill=n.direction==="down"||n.direction==="up",n.sheetIdx=f,n.fillRange=i._toIntrnlRange(n.fillRange,f),r={sheetIndex:n.sheetIdx,reqType:"auto-fill",range:n.fillRange,bRange:n.dataRange,bData:i.getRangeData(n.fillRange),bFormat:i.model.allowCellFormatting&&i.XLFormat.getHashCodeClassAsArray(n.fillRange)},r.rowSel=e._isRowSelected,r.colSel=e._isColSelected,!i._trigger("autoFillBegin",n)){switch(n.fillType){case u.FillSeries:case u.FillWithoutFormatting:this._fillSeries(n);break;case u.CopyCells:case u.FillFormattingOnly:this._copyCells(n);break;case u.FlashFill:r.actionType="flash-fill";r.bdData=i.getRangeData(n.dataRange);this._flashFill(n);r.adData=i.getRangeData(n.dataRange)}r.aData=i.getRangeData(n.fillRange);i.model.allowCellFormatting&&(r.aFormat=i.XLFormat.getHashCodeClassAsArray(n.fillRange));n.isKeyFill||this.positionAutoFillElement(!0);i._completeAction(r);i._trigger("autoFillComplete",n)}}},_fillSeries:function(n){for(var u,at,o,i,b,ot,v,s,vt,c,k,st,yt,d,ht,g,nt,tt,l,a,y,pt,h,f,e=0,r=this.XLObj,it=t.Spreadsheet.autoFillDirection,rt=t.Spreadsheet.CellType,ut=n.dataRange[0],ft=n.dataRange[1],wt=n.dataRange[2],bt=n.dataRange[3],ct=n.fillRange[0],lt=n.fillRange[1],kt=n.fillRange[2],dt=n.fillRange[3],et=[it.Down,it.Up].indexOf(n.direction)>-1,p=[it.Up,it.Left].indexOf(n.direction)>-1,gt=et?bt-ft:wt-ut,w=n.fillType===t.Spreadsheet.AutoFillOptions.FillSeries;e<=gt;){if(et?(nt={rowIndex:ut,colIndex:ft+e},tt={rowIndex:wt,colIndex:ft+e},l={rowIndex:ct,colIndex:lt+e},a={rowIndex:kt,colIndex:lt+e}):(nt={rowIndex:ut+e,colIndex:ft},tt={rowIndex:ut+e,colIndex:bt},l={rowIndex:ct+e,colIndex:lt},a={rowIndex:ct+e,colIndex:dt}),b=[nt.rowIndex,nt.colIndex,tt.rowIndex,tt.colIndex],ot=[l.rowIndex,l.colIndex,a.rowIndex,a.colIndex],o=this._getPattern(b,{isRFill:p,isVFill:et}),v=r.getRangeData(b,null,["hyperlink","rule","cFormatRule","type","formatStr","decimalPlaces"]),vt=v.length,!o)return;for(at=o.length,r.clearRangeData(ot,["hyperlink",w?"cFormatRule":null,"rule"]),w&&(r.model.allowCellFormatting&&r.XLFormat.removeStyle(ot),g=r.getRangeData(b,null,["format"])),y=r.XLSelection._getSelectedRange({rowIndex:l.rowIndex,colIndex:l.colIndex},{rowIndex:a.rowIndex,colIndex:a.colIndex}),pt=y.length,p&&(y=y.reverse(),o=o.reverse(),o=this._ensurePattern(o),v=v.reverse(),w&&(g=g.reverse())),c=0;c<pt;){h=y[c];i=o[c%at];r.isNumber(i)&&(i=o[i]);switch(i.type){case rt.Number:u=r._round(i.regVal.a+i.regVal.b*i.i,5);p?i.i--:i.i++;break;case rt.String:u=i.val[i.i%i.val.length];i.i++;break;case rt.Formula:for(ht=!1,u="=",k=0,yt=i.val.length;k<yt;)s=i.val[k],r._isObject(s)?(ht=!0,d=r._round(s.a+s.b*i.i,0),u+=d<1?"#REF!":et?s.c+d:r._generateHeaderText(n.sheetIdx,d)+s.c):u+=s,k++;ht&&p?i.i--:i.i++;break;case rt.Custom:u=r._round(i.regVal.a+i.regVal.b*i.i,0);u<0&&(u=u%i.len+i.len);u>=i.len&&(u=u%i.len);u=i.val[u];p?i.i--:i.i++}st=c%vt;f=v[st];r.XLEdit.updateCellValue(h,u,w?g[st].format:null);w&&(r.model.allowCellFormatting&&f.type&&f.type!="general"&&this._updateNFormat(f,h.rowIndex,h.colIndex),r.model.allowConditionalFormats&&f.cFormatRule&&this._updateCFormat(h,f.cFormatRule));r.model.allowHyperlink&&f.hyperlink&&this._updateHyperlinkTag(f.hyperlink,h,u);r.model.allowDataValidation&&f.rule&&r.XLEdit._updateDataContainer(h,{dataObj:{rule:f.rule}});c++}e++}},_copyCells:function(n){for(var s,h,p,et,u,e,w,b,c,tt,l,a,it,k,r,f,i=this.XLObj,yt=i.getActiveSheetIndex(),o=0,d=t.Spreadsheet.autoFillDirection,g=n.dataRange[0],nt=n.dataRange[1],ot=n.dataRange[2],st=n.dataRange[3],rt=n.fillRange[0],ut=n.fillRange[1],ct=n.fillRange[2],lt=n.fillRange[3],ht=[d.Down,d.Up].indexOf(n.direction)>-1,at=[d.Up,d.Left].indexOf(n.direction)>-1,vt=ht?st-nt:ot-g,ft=n.fillType===t.Spreadsheet.AutoFillOptions.FillFormattingOnly,v,y;o<=vt;){if(ht?(w={rowIndex:g,colIndex:nt+o},b={rowIndex:ot,colIndex:nt+o},u={rowIndex:rt,colIndex:ut+o},e={rowIndex:ct,colIndex:ut+o}):(w={rowIndex:g+o,colIndex:nt},b={rowIndex:g+o,colIndex:st},u={rowIndex:rt+o,colIndex:ut},e={rowIndex:rt+o,colIndex:lt}),p=[w.rowIndex,w.colIndex,b.rowIndex,b.colIndex],et=[u.rowIndex,u.colIndex,e.rowIndex,e.colIndex],i.model.allowCellFormatting)if(u.rowIndex==e.rowIndex)for(v=u.colIndex;v<=e.colIndex;v++)i.XLEdit.getPropertyValue(u.rowIndex,v,"tformats")||i.XLFormat.removeStyle([u.rowIndex,v,e.rowIndex,v]);else for(y=u.rowIndex;y<=e.rowIndex;y++)i.XLEdit.getPropertyValue(y,u.colIndex,"tformats")||i.XLFormat.removeStyle([y,u.colIndex,y,e.colIndex]);if(ft?c=i.getRangeData(p,!1,["cFormatRule","type","decimalPlaces","formatStr"]):(k=["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink"],i.model.allowConditionalFormats&&k.push("cFormatRule"),i.model.allowDataValidation&&k.push("rule"),i.clearRangeData(et,k),c=i.getRangeData(p,!1,["value","hyperlink","rule","cFormatRule","type","decimalPlaces","formatStr"])),l=i.getRangeData(p,null,["format"]),tt=l.length,a=i.XLSelection._getSelectedRange({rowIndex:u.rowIndex,colIndex:u.colIndex},{rowIndex:e.rowIndex,colIndex:e.colIndex}),it=a.length,s=0,at&&(a=a.reverse(),l=l.reverse(),ft||(c=c.reverse())),ft)while(s<it)h=s%tt,f=a[s],r=c[h],i.model.allowCellFormatting&&(i.XLFormat._updateFormatClass(f,l[h].format),this._updateNFormat(r,f.rowIndex,f.colIndex)),i.model.allowConditionalFormats&&r.cFormatRule&&this._updateCFormat(f,r.cFormatRule),s++;else while(s<it)h=s%tt,f=a[s],r=c[h],i.XLEdit.updateCellValue(f,r.value,l[h].format),i.model.allowCellFormatting&&r.type&&r.type!="general"&&this._updateNFormat(r,f.rowIndex,f.colIndex),i.model.allowHyperlink&&r.hyperlink&&this._updateHyperlinkTag(r.hyperlink,f,r.value),i.model.allowDataValidation&&r.rule&&i.XLEdit._updateDataContainer(f,{dataObj:{rule:r.rule}}),i.model.allowConditionalFormats&&r.cFormatRule&&this._updateCFormat(f,r.cFormatRule),s++;o++}},_flashFill:function(n){var o,f,e,t=this.XLObj,s=n.dataRange[0],h=n.dataRange[2],i=n.fillRange[0],c=n.fillRange[1],r=n.fillRange[2],l=n.fillRange[3],u=this._getFlashFillPattern(n.dataRange,"left");if(u)for(f=t.getRangeData([i,u.colIndex,r,u.colIndex],!0,null,null,!0),u.subStr>-1&&(f=this._splitString(f," ",u.subStr)),o=t.XLSelection._getSelectedRange({rowIndex:i,colIndex:c},{rowIndex:r,colIndex:l}),e=o.length;e--;)t.XLEdit.updateCellValue(o[e],f[e]);else i>s&&(i=s),r<h&&(r=h),t._getAutoFillOptElem().addClass("e-hide"),t.updateUniqueData({value:"",value2:"",type:"general"},[i,c,r,l]),t._showAlertDlg("Alert","FlashFillAlert")},_getFlashFillPattern:function(n,i){var u,f,h,v,e,c,r=0,o=-1,l=this.XLObj,s=l.getRangeData(n,!0,null,null,!0),y=s.length,a=n[0],p=t.Spreadsheet.autoFillDirection.Right,w=i===p;if(s.join().replace(/,/g,"").length&&(c=s[0].toString(),r=n[1],r)){while(w?r++:r--)if(f=l.XLEdit.getPropertyValue(a,r),f=l.isUndefined(f)?"":f.toString(),f.length){if(f===c)if(y>1){if(u=this._matchData(a,r,s),u)return u}else return{colIndex:r,subStr:o};for(h=f.split(" "),v=h.length,e=0;e<v;){if(c===h[e])if(o=e,y>1){if(u=this._matchData(a,r,s),u)return o>u.subStr&&(u.subStr=o),u}else return{colIndex:r,subStr:o};e++}}else break;if(!w)return this._getFlashFillPattern(n,p)}},_matchData:function(n,i,r){for(var u,o=!1,s,f,h,l,e=1,c=-1,a=r.length;e<a;){if(o=!1,s=r[e].toString(),f=this.XLObj.XLEdit.getPropertyValue(n+e,i),f=t.isNullOrUndefined(f)?"":f.toString(),s===f){o=!0;e++;continue}for(h=f.split(" "),l=h.length,u=0;u<l;){if(s===h[u]){c<u&&(c=u);o=!0;break}u++}e++}if(o&&e===a)return{colIndex:i,subStr:c}},_splitString:function(n,t,i){for(var e,u,f=n.length,r;f--;){for(r=i,e=n[f].split(t);r>-1;){if(u=e[r],u)break;r--}n[f]=u}return n},_getPattern:function(n,i){var u,o,s,a,l,v,w,b,h,e,y=0,f=[],k=this.XLObj,c=t.Spreadsheet.CellType,p=this._getDataPattern(n),d=p.length,r;if(p){while(y<d){r=p[y];switch(r.type){case c.Number:for(o=f.length,e=r.val.length,h=i.isRFill?-1:e,e===1&&r.val.push(r.val[0]+1),a=this._getPredictionValue(r.val),s={regVal:a,type:r.type,i:h},f.push(s),u=1;u<e;)f.push(o),u++;break;case c.String:for(o=f.length,s={val:r.val,type:r.type,i:0},f.push(s),u=1,e=r.val.length;u<e;)f.push(o),u++;break;case c.Formula:if(e=r.val.length,r=this._getFormulaPattern(r.val,i),h=i.isRFill?-1:e,r.isInPattern)for(o=f.length,s={val:r.val,type:c.Formula,i:h},f.push(s),u=1;u<e;)f.push(o),u++;else for(u=0,h=i.isRFill?-1:1;u<e;)f.push({val:r.val[u],type:c.Formula,i:h}),u++;break;default:if(r.type.indexOf(c.Custom)>-1)for(o=f.length,e=r.val.length,h=i.isRFill?-1:e,l=this._customList[Number(r.type.replace(c.Custom,""))],b=l.indexOf(r.val[0])===-1,v=k.toArrayLowerCase(l.slice(0)),w=k.toArrayLowerCase(r.val),a=this._getCustomPredictionValue(w,v),s={val:b?v:l,regVal:a,i:h,type:c.Custom,len:l.length},f.push(s),u=1;u<e;)f.push(o),u++}y++}return f}},_getCustomPredictionValue:function(n,t){for(var r=0,i=[],u=n.length;r<u;)i.push(t.indexOf(n[r])),r++;return i.length===1&&i.push(i[0]+1),this._getPredictionValue(i)},_getDataPattern:function(n){var i,r,u=0,t={},f=[],e=this.XLObj.getRangeData(n,!0,null,null,!0),o=e.length;if(o){while(u<o)i=e[u],r=this._getType(i),u===0?t={val:[i],type:r}:r===t.type?t.val.push(i):(f.push(t),t={val:[i],type:r}),u++;return f.push(t),f}},_getFormulaPattern:function(n,t){for(var r,e,u,o,h=this.XLObj,f=[],i=0,s=n.length;i<s;)f.push(this._parseFormula(n[i])),i++;if(o=this._isInPattern(f,t.isVFill),o){for(r=f[0],i=r.length;i--;)u=r[i],h._isCellReference(u)&&(r[i]=this._getCellRefPrediction(u,t));return{isInPattern:o,val:r}}for(i=0;i<s;){for(r=f[i],e=r.length;e--;)u=r[e],h._isCellReference(u)&&(f[i][e]=this._getCellRefPrediction(u,t,s));i++}return{isInPattern:o,val:f}},_getCellRefPrediction:function(n,t,i){n=n.toUpperCase();var u="",e=new RegExp("[a-z]","gi"),o=new RegExp("[0-9]","g"),s=t.isVFill?n.replace(o,u):n.replace(e,u),r=t.isVFill?Number(n.replace(e,u)):this.XLObj._generateColCount(n.replace(o,u)),f=[r];return i&&i!==1?f.push(r+i):f.push(r+1),r=this._getPredictionValue(f),r.c=s,r},_isInPattern:function(n,t){var o,i,s,a,r,u,h,c,f=this.XLObj,e="",v=0,l=1,y=n.length,p=new RegExp("[0-9]","g"),w=new RegExp("[a-z]","gi");if(y===1)return!1;while(l<y){if(o=n[v],s=n[l],i=o.length,a=s.length,i!==a)return!1;while(i--)if(r=o[i],u=s[i],f._isCellReference(r)===f._isCellReference(u)){if(t?(h=Number(r.replace(w,e)),c=Number(u.replace(w,e))):(h=f._generateColCount(r.replace(p,e)),c=f._generateColCount(u.replace(p,e))),h!==c-1)return!1}else if(r!==u)return!1;v++;l++}return!0},_parseFormula:function(n){var t,u,f,r=0,i=[];for(n=this._markSpecialChar(n.replace("=","")),n=n.split(/\(|\)|,|:|\+|-|\*|\/|%/g),f=n.length;r<f;){if(t=n[r],!t){r++;continue}t.length===1?i.push(this._isUniqueChar(t)?this._getUniqueCharVal(t):t):(u=t[0],this._isUniqueChar(u)?(i.push(this._getUniqueCharVal(u)),i.push(t.substr(1))):i.push(t));r++}return i},_getUniqueCharVal:function(n){switch(n){case this._uniqueOBracket:return"(";case this._uniqueCBracket:return")";case this._uniqueCSeparator:return",";case this._uniqueCOperator:return":";case this._uniquePOperator:return"+";case this._uniqueSOperator:return"-";case this._uniqueMOperator:return"*";case this._uniqueDOperator:return"/";case this._uniqueModOperator:return"%"}return""},_isUniqueChar:function(n){var t=n.charCodeAt(n);return t>=129&&t<=137},_markSpecialChar:function(n){return n=n.replace(/\(/g,"("+this._uniqueOBracket).replace(/\)/g,")"+this._uniqueCBracket),n=n.replace(/,/g,","+this._uniqueCSeparator).replace(/:/g,":"+this._uniqueCOperator),n=n.replace(/\+/g,"+"+this._uniquePOperator).replace(/-/g,"-"+this._uniqueSOperator),n=n.replace(/\*/g,"*"+this._uniqueMOperator).replace(/\//g,"/"+this._uniqueDOperator),n.replace(/%/g,"%"+this._uniqueModOperator)},_getPredictionValue:function(n){for(var t=0,i=0,u=0,f=0,r=0,e=n.length,o,s;t<e;)i=i+t,u=u+Number(n[t]),f=f+t*Number(n[t]),r=r+t*t,t++;return o=this.XLObj._round((u*r-i*f)/(e*r-i*i),5),s=this.XLObj._round((e*f-i*u)/(e*r-i*i),5),{a:o,b:s}},_getType:function(n){var i=this._isCustomType(n),r=t.Spreadsheet.CellType,u=this.XLObj;return i?i=i:u.isFormula(n)?i=r.Formula:u.isNumber(n)&&(i=r.Number),i||r.String},_isCustomType:function(n){n=n+"";n=n.toLowerCase();for(var i=this._customList.length;i--;)if(this.XLObj.toArrayLowerCase(this._customList[i].slice(0)).indexOf(n)>-1)return t.Spreadsheet.CellType.Custom+i;return!1},_ensurePattern:function(n){for(var i,u=-1,r=n.length;r--;)i=n[r],this.XLObj._isObject(i)?(u=r,i.type===t.Spreadsheet.CellType.String&&(i.val=i.val.reverse())):n[r]=u;return n},_selectAutoFillRange:function(n,t){n&&(t=this.XLObj._getCellIdx(n));var u,f,r=this.XLObj,i=this._getAutoFillRange(t);if(i){for(this._autoFillCleanUp(),f=r.getRange([i.startCell.rowIndex,i.startCell.colIndex,i.endCell.rowIndex,i.endCell.colIndex]),u=f.length;u--;)r.addClass(f[u],"e-autofillcell");r.XLSelection._focusRange(i.startCell,i.endCell,r._autofillBorder)}},_getAutoFillRange:function(n){var e=t.Spreadsheet.autoFillDirection,a=this.XLObj,l=a.getSheet(a.getActiveSheetIndex()),y=l._startCell,p=l._endCell,o=l._autoFillCell,h=l.selectedRange,u=h[0],f=h[1],r=h[2],i=h[3],v=a.inRange(h,n.rowIndex,n.colIndex),s={rowIndex:u,colIndex:f},c={rowIndex:r,colIndex:i};if(n.rowIndex<o.rowIndex){if(u-n.rowIndex>n.colIndex-i&&u-n.rowIndex>f-n.colIndex)return v?{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i}}:{startCell:c,endCell:{rowIndex:n.rowIndex,colIndex:f},fillRange:[n.rowIndex,f,u-1,i],direction:e.Up};if(n.colIndex>o.colIndex)return{startCell:s,endCell:{rowIndex:r,colIndex:n.colIndex},fillRange:[u,i+1,r,n.colIndex],direction:e.Right};if(n.colIndex<o.colIndex)return v?{startCell:s,endCell:c}:{startCell:c,endCell:{rowIndex:u,colIndex:n.colIndex},fillRange:[u,n.colIndex,r,f-1],direction:e.Left}}else{if(n.colIndex>o.colIndex)return n.rowIndex-r>n.colIndex-i?{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[r+1,f,n.rowIndex,i],direction:e.Down}:{startCell:s,endCell:{rowIndex:r,colIndex:n.colIndex},fillRange:[u,i+1,r,n.colIndex],direction:e.Right};if(n.colIndex<o.colIndex)return n.rowIndex-r>i-n.colIndex||n.rowIndex-u>i-n.colIndex&&n.rowIndex!==r?{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[r+1,f,n.rowIndex,i],direction:e.Down}:v?{startCell:s,endCell:c}:{startCell:c,endCell:{rowIndex:u,colIndex:n.colIndex},fillRange:[u,n.colIndex,r,f-1],direction:e.Left};if(n.rowIndex>o.rowIndex)return{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[r+1,f,n.rowIndex,i],direction:e.Down};if(n.rowIndex===o.rowIndex&&n.colIndex===o.colIndex)return{startCell:y,endCell:p}}},_getDirection:function(n,i,r){var u=t.Spreadsheet.autoFillDirection;if(r=this.XLObj.isUndefined(r)?this._verticalFill:r,r){if(i.rowIndex<n.rowIndex)return u.Up;if(i.rowIndex>n.rowIndex)return u.Down;if(i.colIndex>n.colIndex)return u.Right;if(i.colIndex<n.colIndex)return u.Left}else{if(i.colIndex>n.colIndex)return u.Right;if(i.colIndex<n.colIndex)return u.Left;if(i.rowIndex<n.rowIndex)return u.Up;if(i.rowIndex>n.rowIndex)return u.Down}return null},_getFillRange:function(n,i,r,u){var f=t.Spreadsheet.autoFillDirection;switch(u){case f.Up:return[r.rowIndex,n.colIndex,n.rowIndex-1,i.colIndex];case f.Right:return[n.rowIndex,i.colIndex+1,i.rowIndex,r.colIndex];case f.Down:return[i.rowIndex+1,n.colIndex,r.rowIndex,i.colIndex];case f.Left:return[n.rowIndex,r.colIndex,i.rowIndex,n.colIndex-1]}return null},_autoFillOptionClick:function(t){var r,i,u,f,e,o,s,h=n("#"+t.model.targetID).find("#"+t.ID).find(">>");this._hasClass(h[0],"e-ss-fillselect")||(r=this.XLDragFill,i=this.getSheet(this.getActiveSheetIndex()),u=r._getDirection(this._pEndCell,this._pFillCell),f=this.swapRange([this._pStartCell.rowIndex,this._pStartCell.colIndex,this._pEndCell.rowIndex,this._pEndCell.colIndex]),e=r._getFillRange(this._pStartCell,this._pEndCell,this._pFillCell,u),o=i._startCell,s=i._endCell,this._isUndo=!0,this._performUndoRedo(),i._isColSelected||i._isRowSelected||(i._startCell=o,i._endCell=s,this.XLSelection.selectRange(i._startCell,i._endCell)),r.positionAutoFillElement(!0),r.autoFill({dataRange:f,fillRange:e,direction:u,fillType:t.ID}),r._fillInfo.fillType=t.ID,this._isUndo=!1)},_autoFillCleanUp:function(){var i,n,r,u,f="e-hide",t=this.XLObj,e=t.getAutoFillElem(),o=t._getAutoFillOptElem();for(e&&t.addClass(e[0],f),o&&t.addClass(o[0],f),r=t._getContent(t.getActiveSheetIndex())[0].querySelectorAll("td.e-autofillcell"),i=r.length;i--;)u=r[i],n=u.className,n=n.replace(/e-autofillcell|e-blur/g,""),n=n.replace(/ +/g," "),u.className=n},_autoFillClick:function(){var f,r=0,u="e-ss-fillselect",i=n("#"+this._id+"_ctxtmenu").find("li"),t=i.find("."+u);for(t.length&&(t=t[0],this._removeClass(t,u),this.addClass(t,"e-ss-filloption")),i.show(),f=this.XLDragFill._fillInfo.disableItems.length;r<f;)n(i[this.XLDragFill._fillInfo.disableItems[r]]).hide(),r++;i.filter("#"+this.XLDragFill._fillInfo.fillType).find("span").addClass(u)},_fillRange:function(n,i){var l,a,h,v,r,u,o,s,f={isKeyFill:!0},e=this.XLObj,y=e.getSheet(e.getActiveSheetIndex()),c=t.Spreadsheet.autoFillDirection;if(i=i?i:y.selectedRange,r=i[0],u=i[1],o=i[2],s=i[3],l=this._getDirection({rowIndex:r,colIndex:u},{rowIndex:o,colIndex:s},n),a=n?l===c.Down:l===c.Right,e.isRange(i)&&a)n?(f.dataRange=[r,u,r,s],f.fillRange=[r+1,u,o,s]):(f.dataRange=[r,u,o,u],f.fillRange=[r,u+1,o,s]);else{if(n){if(!r)return;f.dataRange=[r-1,u,r-1,s]}else{if(!u)return;f.dataRange=[r,u-1,o,u-1]}f.fillRange=i}if(f.direction=n?c.Down:c.Right,f.fillType=t.Spreadsheet.AutoFillOptions.CopyCells,e.model.allowLockCell&&y._isSheetProtected&&(h=e.swapRange(f.fillRange),v=e.XLSelection._getSelectedRange({rowIndex:h[0],colIndex:h[1]},{rowIndex:h[2],colIndex:h[3]}),e._israngeProtected(v))){e._popUplockCellAlert();return}this.autoFill(f)},_getFillInfo:function(n){var f,i,e=!0,s=t.Spreadsheet.AutoFillOptions.CopyCells,o=[],r=this.XLObj,h=t.Spreadsheet.autoFillDirection,c=[h.Down,h.Up].indexOf(n.direction)>-1,u=r.getRangeData(n.dataRange,!0,null,null,!0),l=u.join().replace(/,/g,"").length;if(r.isRange(n.dataRange)&&l){for(f=u.length;f--;)if(i=u[f],r.isNumber(i)||r.isFormula(i)||this._isCustomType(i)){e=!1;s=t.Spreadsheet.AutoFillOptions.FillSeries;break}}else i=u[0],(r.isNumber(i)||r.isFormula(i)||this._isCustomType(i))&&(e=!1);return(!l||e)&&o.push(1),(!c||c&&n.dataRange[1]!==n.dataRange[3])&&o.push(4),{fillType:s,disableItems:o}},_updateHyperlinkTag:function(n,i,r){var f,u=this.XLObj;u.isUndefined(r)&&(r=u.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"value2"));u._isRowViewable(u.getActiveSheetIndex(),i.rowIndex)&&(f=u.getCell(i.rowIndex,i.colIndex),f[0].lastChild.nodeType===3&&f[0].lastChild.remove(),f.append(t.buildTag("a.e-hyperlinks",r,"",n.webAddr?{href:n.webAddr,target:"_blank"}:{href:"#"})));u.XLEdit._updateDataContainer(i,{dataObj:{hyperlink:n}})},_updateCFormat:function(n,t){var i,r=0,u=this.XLObj,f=t.length;for(u._dupDetails=!0;r<f;)i=t[r].split("_"),u.XLCFormat._cFormat(i[0],i[2],i[3],i[4],null,null,[n.rowIndex,n.colIndex,n.rowIndex,n.colIndex]),r++;u._dupDetails=!1},_updateNFormat:function(n,t,i){var u={type:n.type},r=this.XLObj;n.type!="general"&&(n.formatStr&&(u.formatStr=n.formatStr),"decimalPlaces"in n&&(u.decimalPlaces=n.decimalPlaces));r._dupDetails=!0;r.XLFormat.format(u,r._getAlphaRange(r.getActiveSheetIndex(),t,i,t,i));r._dupDetails=!1}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellNavigation=function(n){this.XLObj=n;this._canKeyBoardNavigate=!0;this._isNavigate=!0;this._scrollReverse=!1};t.spreadsheetFeatures.cellNavigation.prototype={_selectionKeyDownHandler:function(n){var c,l,e,o,h,b,d,v=[],t=this.XLObj,p=t.getActiveSheetIndex(),i=t.getSheet(p),r=n.keyCode,a=n.shiftKey,k=n.ctrlKey,f={keyCode:r,shiftKey:a,ctrlKey:k,altKey:n.altKey},u=i._activeCell,s=i._endCell,y=i.rowCount,w=i.colCount;if((r===9&&this._canKeyBoardNavigate||r===13)&&!k){if(n.preventDefault(),c=t.XLEdit.getCurrentEditCellData(),t.XLEdit._isFormulaEdit&&!t._isFormulaSuggestion)if(c.length>1)if(this._isValidParameter(c))t.isFormula(c)||(c=c+")",t.XLEdit._editElem.text(c),t.model.allowFormulaBar&&t._getInputBox().val(c)),t.XLEdit.saveCell(),t._getContent(p).find("td").removeClass(t._formulaBorder.join(" ").replace(/,/g," ")+" "+t._ctrlFormulaBorder.join(" ").replace(/,/g," ")),t.XLSelection._cleanUp(),t.XLSelection.selectRange(i._activeCell,i._activeCell),t.XLEdit._isFormulaEdit=!1,t._formulaRange=[],t._ctrlKeyCount=0;else{t._showAlertDlg("Alert","MissingParenthesisAlert","MissingParenthesis",440);return}else t.XLEdit.saveCell(),t.XLEdit._isFormulaEdit=!1;else r===9&&t.XLEdit._isEdit&&t.XLEdit.saveCell();l=i.selectedRange;d=i._isRowSelected||i._isColSelected;d?l[0]===l[2]||l[1]===l[3]?v.push({rowIndex:l[0],colIndex:l[1]}):v=i._selectedCells:v=i._selectedCells;v.length&&(v.length===1||!d&&this._isRangeMerged(v)?i._isRowSelected?a?u.colIndex>0&&this._navigateRow("Backward",f):u.colIndex<39&&this._navigateRow("Forward",f):i._isColSelected?a?u.rowIndex>0&&this._navigateCol("Backward",f):u.rowIndex<39&&this._navigateCol("Forward",f):a?r===9&&u.colIndex>0?this._navigateCell(u.rowIndex,u.colIndex-1,f):r===13&&u.rowIndex>0&&this._navigateCell(u.rowIndex-1,u.colIndex,f):r===9&&u.colIndex<w?this._navigateCell(u.rowIndex,u.colIndex+1,f):r===13&&u.rowIndex<y&&this._navigateCell(u.rowIndex+1,u.colIndex,f):a?r===9?this._navigateRange("ShiftTab",f):this._navigateRange("ShiftEnter",f):r===9?this._navigateRange("Tab",f):this._navigateRange("Enter",f))}else if((r===37||r===38&&!t._isFormulaSuggestion||r===39||r===40&&!t._isFormulaSuggestion)&&this._isNavigate)if(n.preventDefault(),t.XLEdit._isFormulaEdit)h=t.swapRange([t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex]),t.getRange([h[0]?h[0]-1:h[0],h[1]?h[1]-1:h[1],h[2],h[3]]).removeClass(t._formulaBorder[t._ctrlKeyCount%6].join(" ")+" "+t._ctrlFormulaBorder[t._ctrlKeyCount%6].join(" ")),k&&(e=t._dStartCell,r===37&&e.colIndex>0?t._dStartCell=t._dEndCell={rowIndex:e.rowIndex,colIndex:0}:r===38&&e.rowIndex>0?t._dStartCell=t._dEndCell={rowIndex:0,colIndex:e.colIndex}:r===39&&e.colIndex<i.colCount?t._dStartCell=t._dEndCell={rowIndex:e.rowIndex,colIndex:i.colCount}:r===40&&e.rowIndex<y&&(t._dStartCell=t._dEndCell={rowIndex:i.colCount,colIndex:e.colIndex})),a||t._shiftKeyEnabled?(o=t._dEndCell,r===37&&o.colIndex>0?t._dEndCell={rowIndex:o.rowIndex,colIndex:o.colIndex-1}:r===38&&o.rowIndex>0?t._dEndCell={rowIndex:o.rowIndex-1,colIndex:o.colIndex}:r===39&&o.colIndex<i.colCount?t._dEndCell={rowIndex:o.rowIndex,colIndex:o.colIndex+1}:r===40&&o.rowIndex<i.rowCount&&(t._dEndCell={rowIndex:o.rowIndex+1,colIndex:o.colIndex})):(e=t._dStartCell,r===37&&e.colIndex>0?t._dStartCell=t._dEndCell={rowIndex:e.rowIndex,colIndex:e.colIndex-1}:r===38&&e.rowIndex>0?t._dStartCell=t._dEndCell={rowIndex:e.rowIndex-1,colIndex:e.colIndex}:r===39&&e.colIndex<i.colCount?t._dStartCell=t._dEndCell={rowIndex:e.rowIndex,colIndex:e.colIndex+1}:r===40&&e.rowIndex<i.rowCount&&(t._dStartCell=t._dEndCell={rowIndex:e.rowIndex+1,colIndex:e.colIndex})),t.XLSelection._processFormulaRange(t._ctrlFormulaBorder),t._formulaRange[t._ctrlKeyCount]=t._getProperAlphaRange(p,t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex);else if(k)r===37&&u.colIndex>0?this._navigateCell(u.rowIndex,0,f):r===38&&u.rowIndex>0?this._navigateCell(0,u.colIndex,f):r===39&&u.colIndex<w-1?this._navigateCell(u.rowIndex,w-1,f):r===40&&u.rowIndex<y-1&&this._navigateCell(y-1,u.colIndex,f);else if(a){if(r===37&&s.colIndex>0?i._endCell={rowIndex:s.rowIndex,colIndex:s.colIndex-1}:r===38&&s.rowIndex>0?i._endCell={rowIndex:s.rowIndex-1,colIndex:s.colIndex}:r===39&&s.colIndex<w?i._endCell={rowIndex:s.rowIndex,colIndex:s.colIndex+1}:r===40&&s.rowIndex<y&&(i._endCell={rowIndex:s.rowIndex+1,colIndex:s.colIndex}),(i.rowCount===i._endCell.rowIndex||i.colCount===i._endCell.colIndex)&&t.model.scrollSettings.scrollMode==="normal")return;if((i.rowCount===i._endCell.rowIndex||i.colCount===i._endCell.colIndex)&&!t.model.scrollSettings.allowScrolling)return;t.model.scrollSettings.allowScrolling&&(r===40?!t.model.scrollSettings.allowVirtualScrolling:!0)&&(i.rowCount===i._endCell.rowIndex&&t.XLScroll._scrollY(p),i.colCount===i._endCell.colIndex&&t.XLScroll._scrollX(p));this._isHiddenCell(i._endCell)&&(b={rowIndex:i._endCell.rowIndex,colIndex:i._endCell.colIndex},this._skipHiddenRowsAndCols(b,f),i._endCell.rowIndex=b.rowIndex,i._endCell.colIndex=b.colIndex);this._scrollToCell(i._endCell,f);t.XLSelection.selectRange(i._startCell,i._endCell);t.model.allowAutoFill&&t.XLDragFill.positionAutoFillElement()}else if(f={keyCode:r,shiftKey:!1,ctrlKey:!1,altKey:!1},r===37&&u.colIndex>0)this._navigateCell(u.rowIndex,u.colIndex-1,f);else if(r===38&&u.rowIndex>0)this._navigateCell(u.rowIndex-1,u.colIndex,f);else if(r===39&&u.colIndex<w)this._navigateCell(u.rowIndex,u.colIndex+1,f);else if(r===40&&u.rowIndex<y)this._navigateCell(u.rowIndex+1,u.colIndex,f);else return!1},_navigateCell:function(t,i,r){var l,w,b,k,y,d,e={rowIndex:t,colIndex:i},u=this.XLObj,s=u.getActiveSheetIndex(),f=u.getSheet(s),o=u._getContent(s),h=o.find("#hscrollBar").data("ejScrollBar"),c=o.find("#vscrollBar").data("ejScrollBar"),a=o.find(".e-content"),g=u.XLEdit,v=!1,p=a[0].offsetWidth;if((f.rowCount!==e.rowIndex&&f.colCount!==e.colIndex||u.model.scrollSettings.scrollMode!=="normal")&&(f.rowCount!==e.rowIndex||!u.model.scrollSettings.allowVirtualScrolling)&&(f.rowCount!==e.rowIndex&&f.colCount!==e.colIndex||u.model.scrollSettings.allowScrolling)){for(f.rowCount===e.rowIndex&&(u.XLScroll._scrollY(s),v=!0),f.colCount===e.colIndex&&(u.XLScroll._scrollX(s),v=!0),b=u.getCell(e.rowIndex,e.colIndex),this._isHiddenCell(e)&&this._skipHiddenRowsAndCols(e,r),y=g.getPropertyValue(f._activeCell.rowIndex,f._activeCell.colIndex,"merge"),y&&g.getPropertyValue(e.rowIndex,e.colIndex,"mergeIdx")&&this._updateMergeRange(y,e,r),f._activeCell=f._endCell=f._startCell=e,(u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"mergeIdx")||u.hasSpan(e))&&(u.XLSelection._processBoundary(),f._activeCell=f._startCell,b=u.getCell(f._activeCell.rowIndex,f._activeCell.colIndex),w=!0),cellInfo=u._getCellInfo(e,s),k=f._leftCol.idx>0?f._leftCol.idx-1:f._leftCol.idx,u.model.scrollSettings.allowScrolling&&f._bottomRow.idx-1<=e.rowIndex&&(r.keyCode==40||r.keyCode==13&&!r.shiftKey)&&!v?(c._scrollData.step=1,r.ctrlKey&&r.keyCode==40?u.XLScroll._scrollSelectedPosition(s,u.getActiveCell(s)):c.scroll(c.value()+cellInfo.height,!0)):u.model.scrollSettings.allowScrolling&&f._topRow.idx>=e.rowIndex&&(r.keyCode==38||r.keyCode==13&&r.shiftKey)&&!v&&!u._hasClass(o.find("tr").eq(e.rowIndex)[0],"e-fr-hide")&&(c._scrollData.step=-1,e.rowIndex>0?c.scroll(c.value()-cellInfo.height,!0):c.scroll(0)),u.model.scrollSettings.allowScrolling&&p<=cellInfo.left+cellInfo.width&&(r.keyCode==39||r.keyCode==9&&!r.shiftKey)&&!v?(h._scrollData.step=1,r.ctrlKey&&r.keyCode==39?u.XLScroll._scrollSelectedPosition(s,u.getActiveCell(s)):h.scroll(h.value()+cellInfo.width,!0)):u.model.scrollSettings.allowScrolling&&k>=e.colIndex&&(r.keyCode==37||r.keyCode==9&&r.shiftKey)&&!v&&(h._scrollData.step=-1,e.colIndex>0?h.scroll(h.value()-cellInfo.width,!0):h.scroll(0)),l=o.find("col"),d=n(u.getRows(s)[1]),rowIdx=f._startCell.rowIndex,colIdx=f._startCell.colIndex,(p>=cellInfo.left||a.offset().left+p>=cellInfo.left+cellInfo.width)&&(r.keyCode==39||r.keyCode==9&&!r.shiftKey)&&(u.XLSelection.selectRange(f._startCell,f._startCell),u.model.showRibbon&&u.XLRibbon._updateRibbonIcons(),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement()),(!l.eq(colIdx).hasClass("e-fc-hide")||r.keyCode==37||r.keyCode==9&&r.shiftKey)&&(u.XLSelection.selectRange(f._startCell,f._endCell),u.model.showRibbon&&u.XLRibbon._updateRibbonIcons(),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement()),!d.eq(rowIdx).hasClass("e-fr-hide")&&(r.keyCode==38||r.keyCode==13&&r.shiftKey)&&(u.XLSelection.selectRange(f._startCell,f._endCell),u.model.showRibbon&&u.XLRibbon._updateRibbonIcons(),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement()),(a.offset().top+a[0].offsetHeight>=cellInfo.top||a.offset().top+a[0].offsetHeight>=cellInfo.top+cellInfo.height)&&(r.keyCode==40||r.keyCode==13&&!r.shiftKey)&&(u.XLSelection.selectRange(f._startCell,f._endCell),u.model.showRibbon&&u.XLRibbon._updateRibbonIcons(),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement()),w&&(r.keyCode===37||r.shiftKey&&r.keyCode===9?e.colIndex=f._startCell.colIndex:r.keyCode===38||r.shiftKey&&r.keyCode===13?e.rowIndex=f._startCell.rowIndex:r.keyCode===39||r.keyCode===9?e.colIndex=f._endCell.colIndex:(r.keyCode===40||r.keyCode===13)&&(e.rowIndex=f._endCell.rowIndex),f._activeCell=e),f._startCell=e;(r.keyCode===37||r.shiftKey&&r.keyCode===9)&&u._hasClass(l[f._startCell.colIndex],"e-c-hide");)u._removeClass(l[f._startCell.colIndex],"e-fc-hide"),f._startCell.colIndex--;while((r.keyCode===38||r.shiftKey&&r.keyCode===13)&&u._hasClass(o.find("tr")[f._startCell.rowIndex],"e-r-hide"))u._removeClass(o.find("tr")[f._startCell.rowIndex],"e-fr-hide"),f._startCell.rowIndex--;while((r.keyCode===39||r.keyCode===9)&&u._hasClass(l[f._startCell.colIndex],"e-c-hide"))f._startCell.colIndex++;while((r.keyCode===40||r.keyCode===13)&&u._hasClass(o.find("tr")[f._startCell.rowIndex],"e-r-hide"))f._startCell.rowIndex++;rIdx=f._startCell.rowIndex;cIdx=f._startCell.colIndex;(u._hasClass(l[cIdx],"e-fc-hide")||u._hasClass(o.find("tr")[rIdx],"e-fr-hide"))&&(f._activeCell=f._endCell={rowIndex:rIdx,colIndex:cIdx},u._hasClass(l[cIdx],"e-fc-hide")&&(r.keyCode===37||r.shiftKey&&r.keyCode===9)?(this._scrollReverse=!0,u._removeClass(l[cIdx],"e-fc-hide"),u._removeClass(u._getJSSheetHeader(s).find("col")[cIdx],"e-fc-hide"),h.scroll(h.value()-f.columnsWidthCollection[cIdx],!0),(h.value()<0||!u._hasClass(l[cIdx-1],"e-fc-hide"))&&h.scroll(0)):u._hasClass(o.find("tr")[rIdx],"e-fr-hide")&&(r.keyCode==38||r.shiftKey&&r.keyCode===13)?(this._scrollReverse=!0,u._removeClass(o.find("tr")[rIdx],"e-fr-hide"),u._removeClass(u._getJSSheetRowHeader(s).find("tr")[rIdx],"e-fr-hide"),c.scroll(c.value()-f.rowsHeightCollection[rIdx],!0),(c.value()<0||!u._hasClass(o.find("tr")[rIdx-1],"e-fr-hide"))&&c.scroll(0)):u._hasClass(l[cIdx],"e-fc-hide")&&(r.keyCode===39||r.keyCode===9)?u.XLScroll._scrollDirection("hscrollBar",0):u._hasClass(o.find("tr")[rIdx],"e-fr-hide")&&(r.keyCode===40||r.keyCode===13)&&u.XLScroll._scrollDirection("vscrollBar",0),u.XLSelection.selectRange({rowIndex:rIdx,colIndex:cIdx},{rowIndex:rIdx,colIndex:cIdx}));u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement()}},_navigateRange:function(n,t){var c=this.XLObj,h=c.getSheet(c.getActiveSheetIndex()),r=h._startCell,u=h._endCell,i=h._activeCell,f=r.rowIndex<u.rowIndex?r.rowIndex:u.rowIndex,e=r.rowIndex>u.rowIndex?r.rowIndex:u.rowIndex,o=r.colIndex<u.colIndex?r.colIndex:u.colIndex,s=r.colIndex>u.colIndex?r.colIndex:u.colIndex;if(n=="Tab")if(i.colIndex<s)this._navigateRow("Forward",t);else if(i.rowIndex<e)this._updateActiveCell(i.rowIndex+1,o,t,n);else if(i.rowIndex==e&&i.colIndex==s)this._updateActiveCell(f,o,t,n);else return!1;else if(n=="Enter")if(i.rowIndex<e)this._navigateCol("Forward",t);else if(i.colIndex<s)this._updateActiveCell(f,i.colIndex+1,t,n);else if(i.rowIndex==e&&i.colIndex==s)this._updateActiveCell(f,o,t,n);else return!1;else if(n=="ShiftTab")if(i.colIndex>o)this._navigateRow("Backward",t);else if(i.rowIndex>f)this._updateActiveCell(i.rowIndex-1,s,t,n);else if(i.rowIndex==f&&i.colIndex==o)this._updateActiveCell(e,s,t,n);else return!1;else if(i.rowIndex>f)this._navigateCol("Backward",t);else if(i.colIndex>o)this._updateActiveCell(e,i.colIndex-1,t,n);else if(i.rowIndex==f&&i.colIndex==o)this._updateActiveCell(e,s,t,n);else return!1},_navigateRow:function(n,t){var i,r,u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex())._activeCell;n==="Forward"?(i=1,r="Tab"):(i=-1,r="ShiftTab");this._updateActiveCell(f.rowIndex,f.colIndex+i,t,r)},_navigateCol:function(n,t){var i,r,u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex())._activeCell;n==="Forward"?(i=1,r="Enter"):(i=-1,r="ShiftEnter");this._updateActiveCell(f.rowIndex+i,f.colIndex,t,r)},_updateActiveCell:function(n,t,i,r){var f=this.XLObj,u=f.getSheet(f.getActiveSheetIndex()),e=u._activeCell;f.getCell(e.rowIndex,e.colIndex).removeClass("e-activecell");u._activeCell={rowIndex:n,colIndex:t};i&&this._isHiddenCell(u._activeCell)&&this._skipHiddenRowsAndCols(u._activeCell,i,!0,r);this._isMergedCell(u._activeCell)&&this._skipMergedCells(u._activeCell,i);this._scrollToCell(u._activeCell,i);f.getCell(u._activeCell.rowIndex,u._activeCell.colIndex).addClass("e-activecell");f.model.allowFormulaBar&&f.updateFormulaBar();f.setSheetFocus()},_isValidParameter:function(n){var t=n.indexOf("(");return t>-1?(n=n.split("("),n[1].length>0):!0},_skipHiddenRowsAndCols:function(n,t,i,r){var e=this.XLObj,u=e.getSheet(e.getActiveSheetIndex()),f=!0;i?this._navigateRange(r,t):((t.keyCode===37||t.keyCode===9&&t.shiftKey||t.keyCode===39&&t.ctrlKey)&&n.colIndex?n.colIndex--:(t.keyCode===38||t.keyCode===13&&t.shiftKey||t.keyCode===40&&t.ctrlKey)&&n.rowIndex?n.rowIndex--:(t.keyCode===39||t.keyCode===9||t.keyCode===37&&t.ctrlKey)&&n.colIndex<u.colCount?n.colIndex++:(t.keyCode===40||t.keyCode===13||t.keyCode===38&&t.ctrlKey)&&n.rowIndex<u.rowCount?n.rowIndex++:f=!1,this._isHiddenCell(n)&&f?this._skipHiddenRowsAndCols(n,t):f||((t.keyCode===37||t.keyCode===9&&t.shiftKey)&&!n.colIndex?n.colIndex=t.keyCode===37&&t.shiftKey?u._endCell.colIndex+1:u._startCell.colIndex:(t.keyCode===38||t.keyCode===13&&t.shiftKey)&&!n.rowIndex&&(n.rowIndex=t.keyCode===38&&t.shiftKey?u._endCell.rowIndex+1:u._startCell.rowIndex)))},_isHiddenCell:function(n){return this.XLObj.XLEdit.getPropertyValue(0,n.colIndex,"isCHide")||this.XLObj.XLEdit.getPropertyValue(n.rowIndex,0,"isRHide")||!1},_isMergedCell:function(n){return this.XLObj.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"isMHide")||!1},_skipMergedCells:function(n,t){var u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex()),i=f._startCell,r=f._endCell,e=!0,o=u._rcRegx;minr=i.rowIndex<r.rowIndex?i.rowIndex:r.rowIndex;maxr=i.rowIndex>r.rowIndex?i.rowIndex:r.rowIndex;minc=i.colIndex<r.colIndex?i.colIndex:r.colIndex;maxc=i.colIndex>r.colIndex?i.colIndex:r.colIndex;t.shiftKey&&t.keyCode===9?n.colIndex--:t.keyCode===9?n.colIndex++:t.shiftKey&&t.keyCode===13?n.rowIndex--:t.keyCode===13?n.rowIndex++:e=!1;n.colIndex>maxc?(n.colIndex=minc,n.rowIndex=n.rowIndex===maxr?minr:n.rowIndex+1):n.colIndex<minc?(n.colIndex=maxc,n.rowIndex=n.rowIndex===minr?maxr:n.rowIndex-1):n.rowIndex>maxr?(n.rowIndex=minr,n.colIndex=n.colIndex===maxc?minc:n.colIndex+1):n.rowIndex<minr&&(n.rowIndex=maxr,n.colIndex=n.colIndex===minc?maxc:n.colIndex-1);this._isMergedCell(n)&&e&&this._skipMergedCells(n,t)},_updateMergeRange:function(n,t,i){var f=this.XLObj,r=n.mSpan.colSpan-1,u=n.mSpan.rowSpan-1;i.shiftKey||i.keyCode!==39&&i.keyCode!==9?i.shiftKey||i.keyCode!==40&&i.keyCode!==13||(t.rowIndex=t.rowIndex+u):t.colIndex=t.colIndex+r},_isRangeMerged:function(n){var i,r={},u=this.XLObj,f=n[0],t=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"merge");if(t&&(r={rowIndex:n[0].rowIndex+t.mSpan.rowSpan-1,colIndex:n[0].colIndex+t.mSpan.colSpan-1},i=u.XLSelection._getSelectedRange(n[0],r),i.length===n.length))return!0},_scrollToCell:function(n){var i=this.XLObj,e=i.getActiveSheetIndex(),t=i._getCellInfo(n,e),r=i.getSheet(e),o=i._getContent(e),s=o.find(".e-content"),u=o.find("#hscrollBar").data("ejScrollBar"),f=o.find("#vscrollBar").data("ejScrollBar");(i.model.scrollSettings.scrollMode!=="normal"||r.colCount-1!==n.colIndex)&&(n.rowIndex>=r._bottomRow.idx-1&&r.rowCount-1>n.rowIndex?f.scroll(f.value()+t.height,!0):n.rowIndex<=r._topRow.idx?n.rowIndex>0?f.scroll(f.value()-t.height,!0):f.scroll(0):n.colIndex<=r._leftCol.idx-1?n.colIndex>0?u.scroll(u.value()-t.width,!0):u.scroll(0):s[0].offsetWidth<=t.left+t.width&&u.scroll(u.value()+t.width,!0))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellFormatting=function(n){this.XLObj=n;this._formatEnable=!1;this._thousandSeparator=t.preferredCulture(this.XLObj.model.locale).numberFormat[","];this._formatAsTableStyle={};this._rowLength=null;this._colLength=null;this._getFormat=null;this._getEformatClass=null;this._borderPosition=["top","right","bottom","left"];this._cellObj=null;this._isFAT=!1};t.spreadsheetFeatures.cellFormatting.prototype={format:function(i,r){if(this.XLObj.model.allowCellFormatting){var f,e,h,tt,et,it,rt,b,o,a,k,ut,d,c,ot,ft=0,v={},st=[],g="style",u=this.XLObj,y={},nt="format",s=u.getActiveSheetIndex(),p=u.getSheet(s),ct=u._rAlign,l=u._dataContainer,w={sheetIndex:s,reqType:"cell-format"},ht=u._dupDetails;if((h=u._getMultiRangeCells(r),b=h.length,!u._trigger("beforeCellFormat",{sheetIndex:s,format:i,cells:h}))&&b){if(i=this._getFormatObj(i),g in i||nt in i){for(w.oprType=(g in i)?"style":"format",ot=h[b-1].colIndex;ft<b;)e=h[ft],a={sheetIndex:s,format:i,cell:e},this._cellObj={},f={rowIndex:e.rowIndex,colIndex:e.colIndex,beforeFormat:{},afterFormat:{},bRowHeight:u.model.allowResizing&&u.XLResize.getRowHeight(e.rowIndex)},v=t.isNullOrUndefined(l.sheets[s][f.rowIndex])?{}:t.isNullOrUndefined(l.sheets[s][f.rowIndex][f.colIndex])?{}:l.sheets[s][f.rowIndex][f.colIndex],u._isRowViewable(s,e.rowIndex)&&(rt=u.getCell(e.rowIndex,e.colIndex)),g in i&&(f.prevClass=u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,nt),f.prevClass=f.prevClass?f.prevClass:"",c=this._getExtendedFormat(e,i.style),this._cellObj.formats=n.extend(!0,{},c.format),tt=u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"tformats"),tt&&(c.format=n.extend(tt,c.format)),this._cellObj.format=f.className=this._createFormatClass(c.format),f.beforeFormat=n.extend(!0,{},v),("font-family"in i.style||"font-size"in i.style)&&!u.XLEdit.getPropertyValue(e.rowIdx,e.colIndex,"isMHide")&&t.isNullOrUndefined(u.XLEdit.getPropertyValue(e.rowIdx,e.colIndex,"merge"))&&(d=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex),u.model.allowResizing&&(u.isNumber(d)||u._isDateTime(d)||u.isTime(d))&&(ut=u.XLResize._getContentWidth(f.colIndex,s,f.rowIndex,f.rowIndex)+2,ut>p.columnsWidthCollection[f.colIndex]&&u.setWidthToColumns([{colIndex:f.colIndex,width:ut}])),u.XLSelection._refreshBorder()),a.cssClass=c.className),nt in i&&i.type&&(o=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex),o=t.isNullOrUndefined(o)?"":o,this._cellObj.value=o,this._cellObj.type=i.type,this._cellObj.formatStr=i.format.formatStr,this._cellObj.decimalPlaces=i.format.decimalPlaces,this._cellObj.thousandSeparator=i.format["thousandSeparator"]?!0:!1,this._cellObj.canUpdate=!0,f.beforeFormat=n.extend(!0,{},v),u.isFormula(o)&&(o=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"calcValue"),this._cellObj.canUpdate=!1),["text","general"].indexOf(this._cellObj.type)!==-1?(u._isDateTime(o)&&(o=u._dateToInt(o),this._cellObj.value=o),this._cellObj.type===t.Spreadsheet.CellType.Text?y.align="":u.isNumber(o)&&u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"align")!="right"&&(y.align=t.Spreadsheet.Align.right),"align"in y&&(y.cellIdx=e,u.XLEdit._refreshCellAlignment(y))):o=this._format(o,{formatStr:this._cellObj.formatStr,type:this._cellObj.type,thousandSeparator:this._cellObj.thousandSeparator,decimalPlaces:this._cellObj.decimalPlaces,cellObj:this._cellObj}),a.value=this._cellObj.value,a.value2=this._cellObj.value2=o+"",delete this._cellObj.canUpdate,f.beforeFormat.Oprtype=this._cellObj.type),u.XLEdit._updateDataContainer(f,{dataObj:this._cellObj}),g in i&&("font-family"in i.style||"font-size"in i.style)&&!u.XLEdit.getPropertyValue(e.rowIdx,e.colIndex,"isMHide")&&t.isNullOrUndefined(u.XLEdit.getPropertyValue(e.rowIdx,e.colIndex,"merge"))&&(k=u._detailsFromGlobalSpan(f.rowIndex,f.colIndex,"height",u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2")),k>u.model.rowHeight&&(rt&&rt.outerHeight(k),p.rowsHeightCollection[f.rowIndex]=k)),et=u._getCellInfo(e),u._dupDetails=!0,nt in i&&(it=u._detailsFromGlobalSpan(e.rowIndex,e.colIndex,"width",this._cellObj.value2),it>et.width&&u.XLResize.setColWidth(e.colIndex,it)),u._dupDetails=!1,u._dupDetails=ht,this._cellObj=null,v=t.isNullOrUndefined(l.sheets[s][f.rowIndex])?{}:t.isNullOrUndefined(l.sheets[s][f.rowIndex][f.colIndex])?{}:l.sheets[s][f.rowIndex][f.colIndex],f.afterFormat=n.extend(!0,{},v),f.afterFormat.Oprtype=f.beforeFormat.Oprtype,f.aRowHeight=u.model.allowResizing&&u.XLResize.getRowHeight(e.rowIndex),st.push(f),u._trigger("cellFormatting",a),u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2")&&(u._textClip(f.rowIndex,f.colIndex,"delete"),u._textClip(f.rowIndex,f.colIndex,"add")),ot===f.colIndex&&u._setRowHdrHeight(s,f.rowIndex),ft++;w.selCell=st;w.range=p.selectedRange;u.XLScroll._getRowHeights(s,h[0].rowIndex)}"border"in i&&!u._isMultiRange(r)?this.applyBorder(i.border,r,w):p._isImported&&!p._isLoaded||u._isUndoRedo||u._dupDetails||u._isSort||u._completeAction(w)}}},_format:function(n,i){var u=this.XLObj,e=i.formatStr,r=u.isUndefined(n)?"":n,s=i.type||"",f=t.Spreadsheet.CellType,o=u.model.locale,h=["."].indexOf(this._thousandSeparator)>-1?"\\":"",c=new RegExp(h+this._thousandSeparator,"g");n=r.toString();switch(s){case f.Accounting:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toAccounting(e,r,o));break;case f.Currency:case f.Number:case f.Percentage:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.formatting(e,r,o),!i.thousandSeparator&&[f.Number,f.Percentage].indexOf(s)>-1&&this._thousandSeparator&&(r=r.replace(c,"")));break;case f.Scientific:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toExponential(r,i.decimalPlaces));break;case f.Fraction:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toFraction(r),r="numerator"in r?r.integer+" "+r.numerator+"/"+r.denominator:r.integer);break;case f.LongDate:case f.ShortDate:case f.Date:case f.Time:case f.DateTime:u.isNumber(r)?(r=u.intToDate(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r)):u._isDateTime(r)||(r=t.parseDate(r));u._isDateTime(r)&&(r=u.formatting(e,r,o))}return t.isNullOrUndefined(r)?n:r},createTable:function(t,i){if(this.XLObj.model.allowFormatAsTable){var s,w,u,y,h,e,r=this.XLObj,c=t.name||"",o=r.getActiveSheetIndex(),f=r.getSheet(o),p=f._tableManager,l=f._startCell,a=f._endCell,b="formatName",k={sheetIndex:o,tableStyle:t,reqType:"format-table"},d=t.format||this._getTableLayoutFromName(t.formatName).format,v={format:d},g=r._dupDetails;!r._trigActionBegin(k)&&d&&(t=k.tableStyle,this._isFAT=!0,u=r._isUndoRedo?n.merge([],i):i?r.getRangeIndices(i):f.selectedRange,y=r.XLEdit.getPropertyValue(u[0],u[1],"tableName")||"",(!f._isImported||f._isLoaded)&&(w=r.getRange(u),s={sheetIndex:o,reqType:"format-table",beforeFormat:this.getHashCodeClassAsArray(),beforeRange:n.extend(!0,[],u),pcells:w,beforeRangeHeader:r.getRangeData([u[0],u[1],u[0],u[3]])},h=t.header?[u[0],u[1],u[2],u[3]]:[u[0],u[1],u[2]+1,u[3]],s.beforeRangeData=r.getRangeData(h),s.beforeMergeRange=r.XLEdit._getPropWithCellIdx(h,"merge",o),r._dupDetails=!0,s.beforeMergeRange.length&&r.unmergeCells(r._getAlphaRange(o,h[0],h[1],h[2],h[3])),r._dupDetails=!1),b in t&&(v[b]=t.formatName),y?(this._formatAsTableStyle=v,r._dupDetails=!0,this._createTable(r._getTableID(y),v),r._dupDetails=!1,r._undoCollection.pop(),r._undoCollection.pop()):(e=r._isUndoRedo&&r.XLClipboard._isCut?parseInt(c.replace("Table","")):r.getObjectLength(p)+1,c=c.length?c:"Table"+e,r.model.sheets[o]._header[e]={header:t.header},t.header?(i?(i=r._isUndoRedo?i:r.getRangeIndices(i),f._startCell={rowIndex:i[0],colIndex:i[1]},f._endCell={rowIndex:i[2],colIndex:i[3]},r.XLSelection.selectRange(f._startCell,f._endCell),r.model.allowAutoFill&&(!f._isImported||f._isLoaded)&&r.XLDragFill.positionAutoFillElement()):i=r.swapRange([l.rowIndex,l.colIndex,a.rowIndex,a.colIndex]),i[0]===i[2]&&(u=i,u[2]=u[2]+1)):(r._isUndoRedo?u=n.extend(!0,[],i):(u=i?r.getRangeIndices(i):r.swapRange([l.rowIndex,l.colIndex,a.rowIndex,a.colIndex]),i=u),r.model.allowDragAndDrop&&r.XLDragDrop.moveRangeTo(u,[u[0]+1,u[1],u[2]+1,u[3]]),f._startCell={rowIndex:u[0],colIndex:u[1]},f._endCell={rowIndex:u[2]+1,colIndex:u[3]},r.XLSelection.selectRange(f._startCell,f._endCell),r.model.allowAutoFill&&(!f._isImported||f._isLoaded)&&r.XLDragFill.positionAutoFillElement(),u[2]=u[2]+1),"dataSource"in t&&r.updateRange(o,{showHeader:"showHeader"in t?t.showHeader:!0,startCell:r._getAlphaRange(o,i[0],i[1],i[0],i[1]),dataSource:t.dataSource}),r.updateUniqueData({tableName:"e-table"+e},i),p[e]={name:c,range:u},p[e].isFilter=!0,r.XLRibbon._isDesignTab=!0,r._dupDetails=!0,this._createTable(e,v),r.XLFilter._filterTable(o,e),r._dupDetails=!1,this._updateTblStyleOptns(e,t),f._isImported&&!f._isLoaded||t.hideTab||r.XLRibbon._designTabUpdate(e,{rowIndex:i[0],colIndex:i[1]}),r.model.allowComments&&r.XLComment._updateCmntArrowPos()),(!f._isImported||f._isLoaded)&&(r.XLRibbon._dirtySelect(r.getRange(i)),s.tableID=e,s.tableStyle=t,s.afterRange=u,r._dupDetails=g,r._isPaste||r._isUndoRedo||r._dupDetails||r._completeAction(s)),n("#"+r._id+"_Ribbon_tsofiltercolumn").ejCheckBox("option",{checked:!0}),i=r._getDollarAlphaRange(i,!0),r.XLRibbon.addNamedRange(c,i,null,o),r.XLSelection._refreshBorder(),this._isFAT=!1)}},_createTable:function(t,i){var f,s,h,r,c,nt,tt,rt,b,k,e,d,a=1,ut="format",ht=ut+"s",lt="t"+ht,ft="border",et="tableName",g="e-table"+t,ot=!1,u=this.XLObj,o=u.getActiveSheetIndex(),ct=u.getSheet(o),it=ct._tableManager[t],v=it.range,y=v[0],p=v[1],st=v[2],w=v[3];for(it[ut]=i.format,i.formatName&&(it["formatName"]=i.formatName),this.removeStyle(v,{tableStyle:!0,border:!0,sheetIdx:o}),("headerLayout"in i.format)&&(r=n.extend(!0,{},i.format.headerLayout),ft in r&&(c=u._getProperAlphaRange(o,y,p,y,w),this.applyBorder(r.border,c),delete r.border)),ot=u.getObjectLength(r)>0,f=y,s=p,h=w;s<=h;)k=!1,e={},cellIdx={rowIndex:f,colIndex:s},nt=u.XLEdit.getPropertyValue(f,s,"value2")||"",tt="Column"+a,u.XLEdit.getPropertyValue(f,s,et,o)!==g&&(e.tableName=g,k=!0),nt.length?nt.toLowerCase()===tt.toLowerCase()&&a++:(u.XLEdit.updateCell(cellIdx,tt),a++),ot&&(b=this._getExtendedFormat(cellIdx,r,this._isFAT),e.format=this._createFormatClass(b.format),e.tformats=r,k=!0),k&&u.XLEdit._updateDataContainer(cellIdx,{dataObj:e,sheetIdx:o}),s++;if("contentLayout"in i.format)for(rt=i.format.contentLayout.length,a=0,f=y+1,s=st;f<=s;){if(r=n.extend(!0,{},i.format.contentLayout[a%rt]),ft in r&&(c=u._getProperAlphaRange(o,f,p,f,w),this.applyBorder(r.border,c),delete r.border),u.getObjectLength(r))for(h=p,l=w;h<=l;)e={},cellIdx={rowIndex:f,colIndex:h},d=n.extend({},r),u.XLEdit.getPropertyValue(f,h,et,o)!==g&&(e.tableName=g),d.color&&u.XLEdit.getPropertyValue(f,h,"hyperlink")&&delete d.color,b=this._getExtendedFormat(cellIdx,d,this._isFAT),e.format=this._createFormatClass(b.format),e.tformats=r,u.XLEdit._updateDataContainer(cellIdx,{dataObj:e,sheetIdx:o}),h++;f++;a++}"contentBorder"in i.format&&(c=u._getProperAlphaRange(o,y+1,p,st,w),this.applyBorder(n.extend({},i.format.contentBorder.border),c))},_updateTblStyleOptns:function(n,t){var i,r,e="firstColumn",o="lastColumn",h="bold",c="normal",l="totalRow",s="isFilter",u=this.XLObj,f=u._getSheetIndex(),v=u.getSheet(f),a=v._tableManager;n in a&&(i=a[n],r=i.range,i[s]=s in t?t.isFilter:!0,i[s]||u.XLFilter._clearFilterTableIcon(f,n),u._dupDetails=!0,e in t&&(i[e]=t.firstColumn,this.format({style:{"font-weight":i[e]?h:c}},u._getProperAlphaRange(f,r[0]+1,r[1],r[2],r[1]))),o in t&&(i[o]=t.lastColumn,this.format({style:{"font-weight":i[o]?h:c}},u._getProperAlphaRange(f,r[0]+1,r[3],r[2],r[3]))),u._dupDetails=!1,l in t&&(i[l]=t.totalRow))},removeTable:function(t){if(this.XLObj.model.allowFormatAsTable){var i=this.XLObj,r,h,l,e,a,o,u=0,s=i.getActiveSheetIndex(),c=i.getSheet(s)._tableManager,f=c[t].range;if(t in c){if(i.clearRangeData(f,["tableName"]),r=i.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]}),h=r.length,h)while(u<h)l=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"formats"),e=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"tformats"),a=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"borders"),o=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"tborders"),e&&(n.extend(e,l),i.XLEdit._updateDataContainer(r[u],{dataObj:{formats:e}})),o&&(n.extend(o,a),i.XLEdit._updateDataContainer(r[u],{dataObj:{borders:o}})),i.XLEdit._clearDataContainer({cellIdx:{rowIndex:r[u].rowIndex,colIndex:r[u].colIndex},property:["tformats","tborders"]}),u++;i._isFATResize||i.XLFilter._clearFilterTable(s,parseInt(t));delete c[t];delete i.model.sheets[s]._header[t];n("#"+i._id+"_Ribbon_tsofiltercolumn").ejCheckBox("option",{checked:!1});i.XLRibbon._toggleDesignTab(i.getActiveCell(s))}}},_getTableLayoutFromName:function(t){if(t)for(var i,r=n("#"+this.XLObj._id+"_formatastable").find(".e-formatastablecell"),u=r.length-1;u--;)if(i=n(r[u]).data(),i.formatName===t)return i},_getTableIdxFromName:function(n){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex())._tableManager,t=i.getObjectLength(r);if(t)while(t--)if(r[t].name===n)return t;return-1},customFormatParser:function(n){if(this.XLObj.model.allowCellFormatting){var i,f,e,h={},s=t.Spreadsheet.CellType,r="{0:",u="}",c="N",a="P",o=".",l="0";return n=t.isNullOrUndefined(n)?"":n.toString(),Number(n)===0?(n.indexOf(o)>-1?(e=n.split(o),i=r+c+e[1].length+u):i=r+"D"+n.length+u,f=s.Number):!n.indexOf("#")&&n.indexOf(",")>-1&&n.lastIndexOf(l)===n.length-1?(n.indexOf(o)>-1?(e=n.split(o),i=r+c+e[1].length+u):i=r+c+l+u,h.thousandSeparator=!0,f=s.Number):n.lastIndexOf("%")===n.length-1&&Number(n.replace(/%/g,""))===0?(n.indexOf(o)>-1?(e=n.split(o),i=r+a+--e[1].length+u):i=r+a+l+u,f=s.Percentage):/^[dMy/-]+$/.test(n)?(i=r+n+u,f=s.Date):/^[hmst:\s]+$/.test(n)&&(i=r+n+u,f=s.Time),i&&(h.formatStr=i,h.type=f),h}},applyBorder:function(n,i,r){if(this.XLObj.model.allowCellFormatting&&this.XLObj.model.formatSettings.allowCellBorder){var u=this.XLObj,f=u.getActiveSheetIndex(),e=u.getSheet(f);i=u._toIntrnlRange(i);(!e._isImported||e._isLoaded)&&(r||(r={sheetIndex:f,reqType:"cell-format",process:"border"}),r.range=i,r.beforeFormat=this.getHashCodeClassAsArray(i));u.getObjectLength(n)?n.isGridBorder?this._applyAllBorderCss(n,i,r):this._applyBorderCss(n,i,r):this.removeStyle(i,{cellStyle:!0,border:!0,sheetIdx:f});e._isImported&&!e._isLoaded||u._isUndoRedo||(u._refreshRangeTRHght(f,i),t.isNullOrUndefined(n.tableID)&&!this._dupDetails&&(r.afterFormat=this.getHashCodeClassAsArray(i),u._completeAction(r)))}},updateDecimalPlaces:function(i,r){if(this.XLObj.model.allowCellFormatting&&(!this.XLObj.model.allowCellFormatting||this.XLObj.model.formatSettings.allowDecimalPlaces)){var a,c,o,f,p,e,w,v=0,s={},y={},u=this.XLObj,h=u.getActiveSheetIndex(),b=u.getSheet(h),l=u._dataContainer,k={action:"decimal",reqType:"cell-format",sheetIndex:h,oprType:"format"},d=[];if(r=r?u.getRangeIndices(r):b.selectedRange,a=u.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),p=a.length,p)while(v<p)o=a[v].rowIndex,f=a[v].colIndex,e=u.getRangeData([o,f,o,f])[0],c={rowIndex:o,colIndex:f,afterFormat:{},beforeFormat:{}},y=t.isNullOrUndefined(l.sheets[h][o])?{}:t.isNullOrUndefined(l.sheets[h][o][f])?{}:l.sheets[h][o][f],n.extend(!0,c.beforeFormat,y),u.isNumber(e.value)&&(u.isUndefined(e.decimalPlaces)&&(e.decimalPlaces=0),s.type=e.type===t.Spreadsheet.CellType.General?t.Spreadsheet.CellType.Number:e.type,s.decimalPlaces=e.decimalPlaces=i==="decrement"?e.decimalPlaces>0?e.decimalPlaces-1:0:e.decimalPlaces+1,s.formatStr=u._getFormatString(s.type,s.decimalPlaces),w=this._format(e.value,{formatStr:s.formatStr,type:s.type,thousandSeparator:e.thousandSeparator,decimalPlaces:s.decimalPlaces}),s.value2=w,u.XLResize._getContentWidth(f,h,0,u.getSheet(h)._usedRange.rowIndex)>=b.columnsWidthCollection[f]-5&&(u._dupDetails=!0,u.XLResize._fitWidth(f),u._dupDetails=!1,u.XLSelection.refreshSelection(),u.XLDragFill.positionAutoFillElement()),u.XLEdit._updateDataContainer({rowIndex:o,colIndex:f},{dataObj:s}),c.beforeFormat.Oprtype=s.type),y=t.isNullOrUndefined(l.sheets[h][o])?{}:t.isNullOrUndefined(l.sheets[h][o][f])?{}:l.sheets[h][o][f],n.extend(!0,c.afterFormat,y),c.afterFormat.Oprtype=c.beforeFormat.Oprtype,d.push(c),v++;k.selCell=d;u._isUndoRedo||u._completeAction(k)}},getFormatClass:function(n,t){var i=t?"e-border":"e-format",r=new RegExp("\\b"+i+".*?\\b","g");return n.indexOf(i)!==-1?n.match(r)[0]:""},getHashCodeClassAsArray:function(n){var r,e,u,t=0,f={format:[]},i=this.XLObj,o=i.getActiveSheetIndex(),s=["topborder","leftborder"];for(n=i._toIntrnlRange(n,o),n=n?i.swapRange(n):i.getSheet(o).selectedRange,r=i.getRange(n),e=r.length;t<e;)u=r[t].className,f.format.push(this.getFormatClass(u)+" "+this.getFormatClass(u,!0)),t++;for(t=2;t--;)f[s[t]]=this._getBorderArray(n,s[t]);return f},_getBorderArray:function(n,t){var i,r=0,u=[],o=this.XLObj,f="topborder",s=t===f?n[0]-1:n[1]-1,e;if(s>=0)for(e=t===f?o.getRange([n[0]-1,n[1],n[0]-1,n[3]]):o.getRange([n[0],n[1]-1,n[2],n[1]-1]),i=e.length;r<i;)u.push(this.getFormatClass(e[r].className,!0)),r++;else for(i=t===f?n[3]-n[1]+1:n[2]-n[0]+1;i--;)u.push("");return u},removeStyle:function(t,i){i=i||{cellStyle:!0,tableStyle:!0,format:!0,border:!0};var w,g,o,r,f,b,l,h,u,c,s,k,a,p,d=0,v=this._borderPosition,e=this.XLObj,nt=e._getSheetIndex(i.sheetIdx),y=e.getSheet(nt);for(t?(t=e._toIntrnlRange(t),w=e.XLSelection._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]})):(t=y.selectedRange,w=y._selectedCells),g=w.length;d<g;)a=!1,r=w[d],i.skipHiddenRow&&e._isHiddenRow(r.rowIndex,i.sheetIdx)||(i.format&&(i.cellStyle&&i.tableStyle?e.XLEdit._clearDataContainer({cellIdx:r,property:["format","formats","tformats"]}):(i.cellStyle&&e._hasCellStyle(r.rowIndex,r.colIndex,i.sheetIdx)||i.tableStyle&&e._isTableRange(r.rowIndex,r.colIndex,i.sheetIdx))&&(k=[i.cellStyle?"formats":"tformats"],b=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,i.cellStyle?"tformats":"formats",i.sheetIdx),b?(f=this.getFormatHashCode(b),this._updateFormatClass(r,f)):k.push("format"),e.XLEdit._clearDataContainer({cellIdx:r,property:k}))),i.border&&(i.cellStyle&&i.tableStyle?(l=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"borders",i.sheetIdx)||{},h=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(h,l),v[0]in h&&r.rowIndex&&(o=r.rowIndex-1,f=e.XLEdit.getPropertyValue(o,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),c=e.XLEdit.getPropertyValue(o,r.colIndex,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(o,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),"bottom"in s?u.bottom!=s.bottom&&(u.bottom=s.bottom,f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:o,colIndex:r.colIndex},f,!0)):(delete u.bottom,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:o,colIndex:r.colIndex},f,!0)):e.XLEdit._clearDataContainer({cellIdx:{rowIndex:o,colIndex:r.colIndex},property:["border"]})),a=!0),v[1]in h&&(p=!0,o=r.colIndex+1,f=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),o<y.colCount&&(c=e.XLEdit.getPropertyValue(r.rowIndex,o,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(r.rowIndex,o,"tborders",i.sheetIdx)||{},n.extend(s,c),v[3]in s&&(u.right!=s.left&&(u.right=s.left,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)),p=!1)),p&&(delete u.right,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):e.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),v[2]in h&&(p=!0,o=r.rowIndex+1,f=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),o<y.rowCount&&(c=e.XLEdit.getPropertyValue(o,r.colIndex,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(o,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),v[0]in s&&(u.bottom!=s.top&&(u.bottom=s.top,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)),p=!1)),p&&(delete u.bottom,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):e.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),v[3]in h&&r.colIndex&&(o=r.colIndex-1,f=e.XLEdit.getPropertyValue(r.rowIndex,o,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),c=e.XLEdit.getPropertyValue(r.rowIndex,o,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(r.rowIndex,o,"tborders",i.sheetIdx)||{},n.extend(s,c),"right"in s?u.right!=s.right&&(u.right=s.right,f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:o},f,!0)):(delete u.right,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:o},f,!0)):e.XLEdit._clearDataContainer({cellIdx:{rowIndex:r.rowIndex,colIndex:o},property:["border"]})),a=!0),a&&e.XLEdit._clearDataContainer({cellIdx:r,property:["borders","tborders"]})):i.cellStyle?(l=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"borders",i.sheetIdx)||{},h=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tborders",i.sheetIdx)||{},v[0]in l&&r.rowIndex&&(o=r.rowIndex-1,f=e.XLEdit.getPropertyValue(o,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),c=e.XLEdit.getPropertyValue(o,r.colIndex,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(o,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),"bottom"in s?l.bottom===u.bottom&&("top"in h?(u.bottom=h.top,f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:o,colIndex:r.colIndex},f,!0)):s.bottom!=u.bottom&&(u.bottom=s.bottom,f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:o,colIndex:r.colIndex},f,!0))):"top"in h?(u.bottom=h.top,f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:o,colIndex:r.colIndex},f,!0)):(delete u.bottom,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:o,colIndex:r.colIndex},f,!0)):e.XLEdit._clearDataContainer({cellIdx:{rowIndex:o,colIndex:r.colIndex},property:["border"]})),a=!0),v[1]in l&&(o=r.colIndex+1,f=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),o<y.colCount?(c=e.XLEdit.getPropertyValue(r.rowIndex,o,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(r.rowIndex,o,"tborders",i.sheetIdx)||{},n.extend(s,c),"left"in s?l.right===u.right&&("right"in h?(u.right=h.right,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):s.left!=u.right&&(u.right=s.left,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0))):"right"in h?(u.right=h.right,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):(delete u.right,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):e.XLEdit._clearDataContainer({cellIdx:r,property:["border"]}))):"right"in h?(u.right=h.right,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):(delete u.right,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):e.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),v[2]in l&&(o=r.rowIndex+1,f=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),o<y.rowCount?(c=e.XLEdit.getPropertyValue(o,r.colIndex,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(o,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),"top"in s?l.bottom===u.bottom&&("bottom"in h?(u.bottom=h.bottom,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):s.top!=u.bottom&&(u.bottom=s.top,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0))):"bottom"in h?(u.bottom=h.bottom,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):(delete u.bottom,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):e.XLEdit._clearDataContainer({cellIdx:r,property:["border"]}))):"bottom"in h?(u.bottom=h.bottom,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):(delete u.bottom,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):e.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),v[3]in l&&r.colIndex&&(o=r.colIndex-1,f=e.XLEdit.getPropertyValue(r.rowIndex,o,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),c=e.XLEdit.getPropertyValue(r.rowIndex,o,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(r.rowIndex,o,"tborders",i.sheetIdx)||{},n.extend(s,c),"right"in s?l.left===u.right&&("left"in h?(u.right=h.left,f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:o},f,!0)):s.right!=u.right&&(u.right=s.right,f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:o},f,!0))):"left"in h?(u.right=h.left,f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:o},f,!0)):(delete u.right,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:o},f,!0)):e.XLEdit._clearDataContainer({cellIdx:{rowIndex:r.rowIndex,colIndex:o},property:["border"]})),a=!0),a&&e.XLEdit._clearDataContainer({cellIdx:r,property:["borders"]})):i.tableStyle&&(l=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"borders",i.sheetIdx)||{},h=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tborders",i.sheetIdx)||{},"top"in h&&!("top"in l)&&r.rowIndex&&(o=r.rowIndex-1,f=e.XLEdit.getPropertyValue(o,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),c=e.XLEdit.getPropertyValue(o,r.colIndex,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(o,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),"bottom"in s?s.bottom!=u.bottom&&(u.bottom=s.bottom,f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:o,colIndex:r.colIndex},f,!0)):(delete u.bottom,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:o,colIndex:r.colIndex},f,!0)):e.XLEdit._clearDataContainer({cellIdx:{rowIndex:o,colIndex:r.colIndex},property:["border"]})),a=!0),"right"in h&&!("right"in l)&&(o=r.colIndex+1,f=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),o<y.colCount?(c=e.XLEdit.getPropertyValue(r.rowIndex,o,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(r.rowIndex,o,"tborders",i.sheetIdx)||{},n.extend(s,c),"left"in s?s.left!=u.right&&(u.right=s.left,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):(delete u.right,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):e.XLEdit._clearDataContainer({cellIdx:r,property:["border"]}))):(delete u.right,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):e.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),"bottom"in h&&!("bottom"in l)&&(o=r.rowIndex+1,f=e.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),o<y.rowCount?(c=e.XLEdit.getPropertyValue(o,r.colIndex,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(o,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),"top"in s?s.top!=u.bottom&&(u.bottom=s.top,f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):(delete u.bottom,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):e.XLEdit._clearDataContainer({cellIdx:r,property:["border"]}))):(delete u.bottom,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass(r,f,!0)):e.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),"left"in h&&!("left"in l)&&r.colIndex&&(o=r.colIndex-1,f=e.XLEdit.getPropertyValue(r.rowIndex,o,"border",i.sheetIdx),u=this.getBorderFromHashCode(f),c=e.XLEdit.getPropertyValue(r.rowIndex,o,"borders",i.sheetIdx)||{},s=e.XLEdit.getPropertyValue(r.rowIndex,o,"tborders",i.sheetIdx)||{},n.extend(s,c),"right"in s?s.right!=u.right&&(u.right=s.right,f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:o},f,!0)):(delete u.right,e.getObjectLength(u)?(f=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:o},f,!0)):e.XLEdit._clearDataContainer({cellIdx:{rowIndex:r.rowIndex,colIndex:o},property:["border"]})),a=!0),a&&e.XLEdit._clearDataContainer({cellIdx:r,property:["tborders"]})))),d++},_refreshStyles:function(t,i,r){for(var e,f,o,h="format",s="border",a=!i||i===h,v=!i||i===s,u=this.XLObj,c=u.XLSelection._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]}),l=c.length;l--;)cellIdx=c[l],a&&(e=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"formats")||{},f=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"tformats")||{},n.extend(f,e),u.getObjectLength(f)?(o=this._createFormatClass(f),this._updateFormatClass(cellIdx,o,!1)):u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,h)&&u.XLEdit._clearDataContainer({cellIdx:cellIdx,property:[h]})),v&&(e=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"borders")||{},f=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"tborders")||{},n.extend(f,e),u.getObjectLength(f)?(o=this._getBorderHashCode(f),this._updateFormatClass(cellIdx,o,!0)):u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,s)&&(r,style=this.getBorderFromHashCode(hCode),"right"in style,u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,s)&&u.XLEdit._clearDataContainer({cellIdx:cellIdx,property:[s]})))},updateFormat:function(n,t){var i,u,f=["topborder","leftborder"],r=this.XLObj,e=n.format;for(t=t?r.swapRange(t):r.getSheet(r.getActiveSheetIndex()).selectedRange,u=r.XLSelection._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]}),i=u.length;i--;)this._updateHashCodeClass(u[i],e[i]);for(i=2;i--;)this._updateBorderClass(t,n[f[i]],f[i])},_updateBorderClass:function(n,t,i){var r,u,f=this.XLObj,e="topborder",o=i===e?n[0]-1:n[1]-1;if(o>=0)for(u=i===e?f.XLSelection._getSelectedRange({rowIndex:n[0]-1,colIndex:n[1]},{rowIndex:n[0]-1,colIndex:n[3]}):f.XLSelection._getSelectedRange({rowIndex:n[0],colIndex:n[1]-1},{rowIndex:n[2],colIndex:n[1]-1}),r=u.length;r--;)this._updateFormatClass(u[r],t[r],!0)},updateUniqueFormat:function(n,t){for(var i=this.XLObj,r=i.getActiveSheetIndex(),t=t?t:i.getSheet(r).selectedRange,u=i.XLSelection._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]}),f=u.length;f--;)this._updateFormatClass(u[f],n),i.XLEdit._updateDataContainer(u[f],{dataObj:{formats:this.getFormatFromHashCode(n)},sheetIdx:r});i._refreshRangeTRHght(r,i.swapRange(t))},_hasFormat:function(n){return n?!t.isNullOrUndefined(n.match(/e-format|e-border/)):!1},getFormatHashCode:function(n){var i,u,t="",r=0,f="background-color",e="color",o="font-family",s="font-size",h=["font-style","text-decoration","vertical-align","text-align","font-weight"],c=h.length,l=["FontStyle","TextDecoration","VerticalAlign","TextAlign","FontWeight"];for(t=(f in n)?n[f].replace("#",""):"6N",t+=(e in n)?n[e].replace("#",""):"6N",(o in n)?(i=this._getStyleCode("FontFamily",n[o]),t+=i||"2N"):t+="2N",t+=(s in n)?this._getFontCode(n[s]):"2N";r<c;)u=h[r],u in n?(i=this._getStyleCode(l[r],n[u]),t+=i||"1N"):t+="1N",r++;return"e-format"+t},getFormatFromHashCode:function(n){var i,u,t=0,f=0,e="e-format",r={},o="pt",s="font-family",h="FontFamily",c="font-size",l=["font-style","text-decoration","vertical-align","text-align"],a=l.length,v=["FontStyle","TextDecoration","VerticalAlign","TextAlign"];if(n=n||"",!n.indexOf(e)){for(i=n.replace(e,"").split("N"),i[t].length===1?t++:(r["background-color"]="#"+i[t].slice(0,6),i[t]=i[t].substr(6)),i[t].length===1?t++:(r.color="#"+i[t].slice(0,6),i[t]=i[t].substr(6)),u=i[t].length,u===1?t++:u===2?(r[s]=this._getCodeStyle(h,i[t].slice(0,1)+"1N"),t++):(r[s]=this._getCodeStyle(h,i[t].slice(0,2)),i[t]=i[t].substr(2)),u=i[t].length,u===1?t++:u===2?(r[c]=i[t].slice(0,1)+o,t++):(r[c]=i[t].slice(0,2)+o,i[t]=i[t].substr(2));f<a;)i[t].length===1?t++:(r[l[f]]=this._getCodeStyle(v[f],i[t].slice(0,1)),i[t]=i[t].substr(1)),f++;i[t]==="2"&&(r["font-weight"]="bold")}return r},getBorderFromHashCode:function(n,t){var r,i=0,u={},e="e-border",f=this._borderPosition;return n=n||"",n.indexOf(e)||(r=n.replace(e,"").split("N"),r[i].length>1?(u[f[1]]=this._concatBorderCode(r[i]),r[i]=r[i].substr(8)):i+=3,r[i].length>1?(u[f[2]]=this._concatBorderCode(r[i]),t&&(r[i]=r[i].substr(8))):i+=3,t&&(r[i].length>1?(u[f[0]]=this._concatBorderCode(r[i]),r[i]=r[i].substr(8)):i+=3,r[i].length>1&&(u[f[3]]=this._concatBorderCode(r[i])))),u},_formatPainter:function(){var n=this.XLObj,f,e,h;if(n.model.allowFormatPainter&&n.model.allowCellFormatting){var c=n.getActiveSheetIndex(),t,i,o=0,s=n.getSheet(c),r=s._startCell,u=s._endCell;for(this._rowLength=u.rowIndex-r.rowIndex+1,this._colLength=u.colIndex-r.colIndex+1,f=this._rowLength,e=this._colLength,h=n.getRangeData([r.rowIndex,r.colIndex,u.rowIndex,u.colIndex],null,["value","value2","type","wrap","formatStr","thousandSeparator","decimalPlaces","cFormatRule","hyperlink","format","cellType"]),this._getEformatClass=new Array(f),t=0;t<f;t++)for(this._getEformatClass[t]=new Array(e),i=0;i<e;i++)this._getEformatClass[t][i]={rangeData:h[o]},o++}},_fPMouseUp:function(){var o,k,i=this.XLObj,l=i.getActiveSheetIndex(),w=i.getSheet(l),g=i._getContent(l).find("div.e-content"),d=0,nt,f=w._selectedCells,tt=w._startCell,it=w._endCell,s,h,r=0,rt=0,c,a,ut,ft,b,et=it.rowIndex-tt.rowIndex,ot=it.colIndex-tt.colIndex,e,st=i.XLEdit,u,v=w.selectedRange,y=i.getRangeData(v,null,["wrap","hyperlink","value","cFormatRule","format","cellType","formats","formatStr","decimalPlaces","thousandSeparator"]),p={sheetIndex:l,reqType:"format-painter",range:v,beforeData:y,bFormat:this.getHashCodeClassAsArray(v),unwrapCells:[],wrapCells:[]};for(i._dupDetails=!0,s=0;s<=et;s++){for(rt++,h=0;h<=ot;h++){if(d++,e=i._getAlphaRange(l,f[r].rowIndex,f[r].colIndex,f[r].rowIndex,f[r].colIndex),cell=f[r],u=this._getEformatClass[s][h],this.removeStyle([f[r].rowIndex,f[r].colIndex,f[r].rowIndex,f[r].colIndex],{cellStyle:!0,tableStyle:!1,format:!0}),o={type:u.rangeData.type?u.rangeData.type:"general"},u.rangeData.format&&(o.style=this.getFormatFromHashCode(u.rangeData.format)),u.rangeData.formatStr&&(o.formatStr=u.rangeData.formatStr),u.rangeData.decimalPlaces&&(o.decimalPlaces=u.rangeData.decimalPlaces),u.rangeData.thousandSeparator&&(o.thousandSeparator=u.rangeData.thousandSeparator),this.format(o,e),u.rangeData.cellType&&(k=i._dataContainer.sheetCellType[u.rangeData.cellType],k.text="",i.XLCellType._renderControls(f[r].rowIndex,f[r].colIndex,l,k)),!t.isNullOrUndefined(u.rangeData.cFormatRule))for(b=0,ft=u.rangeData.cFormatRule.length;b<ft;b++)nt=u.rangeData.cFormatRule[b],a=nt.split("_"),ut=a[5],a[a.indexOf(ut)]=e,i._dataContainer.cFormatRule=a.join("_"),c=i._dataContainer.cFormatRule.split("_"),i.XLCFormat._cFormat(c[0],c[2],c[3],c[4],c[5]);if(!t.isNullOrUndefined(y[r].wrap)&&t.isNullOrUndefined(u.rangeData.wrap)?(i._setWrapText("unwrap",e),p.wrapCells.push({rowIndex:f[r].rowIndex,colIndex:f[r].colIndex})):t.isNullOrUndefined(y[r].wrap)&&!t.isNullOrUndefined(u.rangeData.wrap)&&(i._setWrapText("wrap",e),p.unwrapCells.push({rowIndex:f[r].rowIndex,colIndex:f[r].colIndex})),!t.isNullOrUndefined(u.rangeData.hyperlink)&&i.isUndefined(y[r].hyperlink)?this.format({style:{"text-decoration":"underline",color:"#428bca"}},e):i.isUndefined(u.rangeData.hyperlink)&&!i.isUndefined(y[r].hyperlink)&&this.format({style:{"text-decoration":"none"}},e),r++,d===ot+1){d=0;break}this._colLength===h+1&&(h=-1)}if(rt===et+1)break;this._rowLength===s+1&&(s=-1)}this._formatEnable=!1;g.addClass("e-ss-cursor");g.removeClass("e-ss-fpcursor");n("#"+i._id+"_Ribbon_formatpainter").ejToggleButton("option",{toggleState:!1});i._dupDetails=!1;p.afterData=i.getRangeData(v,null,["wrap","hyperlink","value","cFormatRule","format","cellType","formats","formatStr","decimalPlaces","thousandSeparator"]);p.aFormat=this.getHashCodeClassAsArray(v);i.XLSelection.refreshSelection();i.XLDragFill.positionAutoFillElement();i._isUndoRedo||i._completeAction(p)},_getFormatObj:function(n){if("type"in n||"formatStr"in n){var t={},i="thousandSeparator";t.formatStr="formatStr"in n?n.formatStr:this.XLObj._getFormatString(n.type,n.decimalPlaces);t.decimalPlaces="decimalPlaces"in n?n.decimalPlaces:["currency","accounting","number"].indexOf(n.type)!==-1?parseInt(t.formatStr.replace(/{0:|[A-Z]|}/g,"")):0;i in n?t[i]=n[i]:n.type==="number"&&(t[i]=!0);n.format=t}return"style"in n&&n.style.border&&(n.border=n.style.border,delete n.style.border,this.XLObj.getObjectLength(n.style)||delete n.style),n},_createFormatClass:function(n,t){var i,r=this.XLObj._dataContainer.hashCode;return(t=t||this.getFormatHashCode(n),r.indexOf(t)!==-1)?t:(i=this._getCssPropertyAsString(n),this._writeCssRules(t,i),r.push(t),t)},_writeCssRules:function(n,t){var i=document.getElementById(this.XLObj._id+"_sscustomformat"),r=".e-spreadsheet ."+n+" {"+t+"}";i.styleSheet?i.styleSheet.cssText+=r:i.appendChild(document.createTextNode(r))},_getCssPropertyAsString:function(n){var t="",i,r,u;if("border"in n){i=n.border;for(r in i)n["border-"+r]=i[r];delete n.border}for(u in n)t=t+(u+":"+n[u]+";");return t},_splitBorderCode:function(n){return n=n.split(" "),n[0].replace("px","")+this._getStyleCode("BorderStyle",n[1])+n[2].replace("#","")},_concatBorderCode:function(n){return n.substr(0,1)+"px "+this._getCodeStyle("BorderStyle",n.substr(1,1))+" #"+n.substr(2,6)},_getCodeStyle:function(n,i){n=t.Spreadsheet[n];for(var r in n)if(n.hasOwnProperty(r)&&n[r]===i)return r},_getStyleCode:function(n,i){return i=i||"",t.Spreadsheet[n][i.toLowerCase()]},_getFontCode:function(n){var t=n.replace(/pt|-|\+/g,"");return t.length===2?t:t.length===1?t+"1N":"2N"},_getExtendedFormat:function(t,i,r){var u=this.XLObj.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"formats")||{};return r?(n.extend(i,u),{format:i}):(n.extend(u,i),{format:u})},_updateHashCodeClass:function(n,t){var i,r,u=this.XLObj,f={},e=u._formatRegx,o=u._borderRegx;t&&(i=t.indexOf("e-format")>-1,r=t.indexOf("e-border")>-1,i&&(f.format=t.match(e)[0]),r&&(f.border=t.match(o)[0]),(i||r)&&u.XLEdit._updateDataContainer({rowIndex:n.rowIndex,colIndex:n.colIndex},{dataObj:f}))},_updateFormatClass:function(n,t,i){t&&(t.indexOf("e-format")>-1||t.indexOf("e-border")>-1)&&this.XLObj.XLEdit._updateDataContainer(n,{dataObj:i?{border:t}:{format:t}})},_applyBorderCss:function(n,t){var u=this._borderPosition,h=u[0],o=u[1],s=u[2],c=u[3],i=t[0],r=t[1],f=t[2],e=t[3];h in n&&i&&this._updateBorder([i-1,r,i-1,e],n,s,!0);o in n&&this._updateBorder([i,e,f,e],n,o);s in n&&this._updateBorder([f,r,f,e],n,s);c in n&&r&&this._updateBorder([i,r-1,f,r-1],n,o,!0)},_applyAllBorderCss:function(n,t){var u=this._borderPosition[1],f=this._borderPosition[2],i=t[0],r=t[1],e=t[2],o=t[3];this._updateBorder(t,n,u+" "+f);i&&this._updateBorder([i-1,r,i-1,o],n,f,!0);r&&this._updateBorder([i,r-1,e,r-1],n,u,!0)},_updateBorder:function(t,i,r,u){var c,g,v,y,o,p,w,s,f,b,h,k=!1,d=!1,e=this._borderPosition,a=t[0],nt=t[2],tt=i.isGridBorder,l=this.XLObj;for(delete i.isGridBorder;a<=nt;){for(c=t[1],g=t[3];c<=g;)o={rowIndex:a,colIndex:c},v=a,y=c,u?(d=r===e[2],d?v++:y++,s=this._parseBorder(i,d?e[0]:e[3]).border):s=this._parseBorder(i,r).border,tt?u||(f=this._extendBorderObj(o,i,this._isFAT),k=!0):u?(p={rowIndex:v,colIndex:y},f=this._extendBorderObj(p,s,this._isFAT),l.XLEdit._updateDataContainer(p,{dataObj:this._isFAT?{tborders:f}:{borders:f}})):(f=this._extendBorderObj(o,this._parseBorder(i,r).border,this._isFAT),k=!0),k&&l.XLEdit._updateDataContainer(o,{dataObj:this._isFAT?{tborders:f}:{borders:f}}),u&&l.hasSpan(o)||(h=l.XLEdit.getPropertyValue(o.rowIndex,o.colIndex,"border"),h=h?this.getBorderFromHashCode(h):l.XLEdit.getPropertyValue(o.rowIndex,o.colIndex,"borders")||{},u?(f={},e[1]in h&&(f[e[3]]=h[e[1]]),e[2]in h&&(f[e[0]]=h[e[2]]),s=this._isFAT?n.extend(s,f):n.extend(f,s)):s=this._isFAT?n.extend(s,h):n.extend(h,s),b=this._parseBorder(s,e[1]+" "+e[2],u),w=this._getBorderHashCode(b.border),this._createFormatClass(b,w),this._updateFormatClass(o,w,!0)),c++;a++}},_extendBorderObj:function(t,i,r){var f=this.XLObj,u=f.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,r?"tborders":"borders")||{};return n.extend(u,i),u},_getBorderHashCode:function(n,t){var i="",r="1N1N6N",u=this._borderPosition,f=u[0],e=u[1],o=u[2],s=u[3];return i=e in n?this._splitBorderCode(n[e]):r,i+=o in n?this._splitBorderCode(n[o]):r,t&&(i+=f in n?this._splitBorderCode(n[f]):r,i+=s in n?this._splitBorderCode(n[s]):r),"e-border"+i},_parseBorder:function(n,t,i){var r,u,e={border:{}},f=this._borderPosition;for(t=t.split(" "),r=t.length;r--;)u=key=t[r],i&&(u=key===f[1]?f[3]:f[0]),value=n[u],value&&(e.border[key]=value);return e},_refreshTableRowCol:function(n){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),u=r._tableManager,t=u[n.tid];t&&(n.isInsertBefore?n.pos==="row"?(t.range[0]+=n.cnt,t.range[2]+=n.cnt):(t.range[1]+=n.cnt,t.range[3]+=n.cnt):(n.pos==="row"?t.range[2]=t.range[2]+n.cnt:t.range[3]=t.range[3]+n.cnt,i._dupDetails=!0,i.XLFormat._createTable(n.tid,{format:t.format}),i._dupDetails=!1))}};t.Spreadsheet.FontFamily={"angsana new":"11N",arial:"21N","arial black":"31N",batang:"41N","book antiqua":"51N","browallia new":"61N",calibri:"71N",cambria:"81N",candara:"91N",century:"10","comic sans ms":"11",consolas:"12",constantia:"13",corbel:"14","cordia new":"15",courier:"16","courier new":"17",dilleniaupc:"18",dotum:"19",fangsong:"20",garamond:"21",georgia:"22",gulim:"23",gungsuh:"24",kaiti:"25",jasmineupc:"26","malgun gothic":"27",mangal:"28",meiryo:"29","microsoft jhenghei":"30","microsoft yahei":"31",mingliu:"32",mingliu_hkscs:"33","ms gothic":"34","ms mincho":"35","ms pgothic":"36","ms pmincho":"37",pmingliu:"38","pmingliu-extb":"39",simhei:"40",simsun:"41","simsun-extb":"42",tahoma:"43",times:"44","times new roman":"45","trebuchet ms":"46",verdana:"47","yu gothic":"48","yu mincho":"49"};t.Spreadsheet.FontStyle={normal:"1",italic:"2",oblique:"3"};t.Spreadsheet.TextAlign={left:"1",right:"2",center:"3",justify:"4"};t.Spreadsheet.VerticalAlign={top:"1",middle:"2",bottom:"3"};t.Spreadsheet.TextDecoration={none:"1",underline:"2",overline:"3","line-through":"4","line-through underline":"5"};t.Spreadsheet.FontWeight={normal:"1",bold:"2"};t.Spreadsheet.BorderStyle={solid:"1",dashed:"2",dotted:"3"};t.Spreadsheet.CellFormat={number:"{0:N2}",currency:"{0:C2}",accounting:"{0:C2}",percentage:"{0:P2}",shortdate:"{0:MM/dd/yyyy}",longdate:"{0:dddd, MMMM dd, yyyy}",time:"{0:T}",scientific:"{0:N2}"}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellType=function(n){this.XLObj=n};t.spreadsheetFeatures.cellType.prototype={_renderControls:function(t,i,r,u,f){var p,k;if(u){var l,c,w,e=this.XLObj,o=r||e.getActiveSheetIndex(),h=e.getCell(t,i,o),b=e.getSheet(o),a=u.type,v=u.text||e.XLEdit.getPropertyValue(t,i,"value2",o)||u.type+e._generateHeaderText(o,i+1)+(t+1),s,y=e._dataContainer,g=b.columnsWidthCollection[i],d=b.rowsHeightCollection[t];c=e.getObjectLength(y.sheetCellType);e.addClass(h,"e-cellreadonly");switch(a){case"Button":s=e._id+"_btn_"+o+e._generateHeaderText(o,i+1)+(t+1);h&&(h.css("vertical-align","middle"),h[0].innerHTML="<button id ="+s+' style = "border: 0px; padding: 0px;color:'+u.color+";background:"+u["background-color"]+';"><\/button>');f||(l={type:a,id:s,text:v,color:u.color||"","background-color":u["background-color"]||""},y.sheetCellType[c]=l,e.XLEdit._updateDataContainer({rowIndex:t,colIndex:i},{dataObj:{cellType:c},sheetIdx:o}));n("#"+s).ejButton({width:"100%",height:"100%",text:v,create:n.proxy(this._onButtonCreate),click:n.proxy(this.onButtonClick),cssClass:u["class"]||""});break;case"CheckBox":s=e._id+"_chk_"+o+e._generateHeaderText(o,i+1)+(t+1);h&&(h[0].innerHTML="<input id ="+s+' style = "" />');f||(l={type:a,id:s,text:v,isChecked:u.isChecked||!1},y.sheetCellType[c]=l,e.XLEdit._updateDataContainer({rowIndex:t,colIndex:i},{dataObj:{cellType:c},sheetIdx:o}));n("#"+s).ejCheckBox({text:"",size:"small",change:n.proxy(this.onActiveStateChange),checked:u.isChecked||!1,cssClass:u["class"]||""});break;case"DropDownList":for(s=e._id+"_drpdwn_"+o+e._generateHeaderText(o,i+1)+(t+1),dataRange=u.dataSourceRange&&e.getRangeIndices(u.dataSourceRange),h&&(h[0].innerHTML="<input id ="+s+" />"),f||(l={type:a,id:s,text:v,style:"",dataSourceRange:u.dataSourceRange||"",selectedIndex:u.selectedIndex||""},y.sheetCellType[c]=l,e.XLEdit._updateDataContainer({rowIndex:t,colIndex:i},{dataObj:{cellType:c},sheetIdx:o})),w=e.XLSelection._getSelectedRange({rowIndex:dataRange[0],colIndex:dataRange[1]},{rowIndex:dataRange[2],colIndex:dataRange[3]}),p=0,k=w.length;p<k;p++)e.XLEdit._updateDataContainer({rowIndex:w[p].rowIndex,colIndex:w[p].colIndex},{dataObj:{ddlRange:{rowIndex:t,colIndex:i}},sheetIdx:o});n("#"+s).ejDropDownList({width:"100%",height:"100%",change:n.proxy(this.onActiveValueChange),dataSource:e.getRangeData(dataRange,"","",o),fields:{text:"value2"},watermarkText:u.watermarkText||"Select an option",cssClass:u["class"]||"",selectedIndex:u.selectedIndex||""});break;case"DatePicker":s=e._id+"_dp_"+o+e._generateHeaderText(o,i+1)+(t+1);h&&(h[0].innerHTML="<input id ="+s+' style = "height:'+(d-1)+'px" />');f||(l={type:a,id:s,text:v,style:""},y.sheetCellType[c]=l,e.XLEdit._updateDataContainer({rowIndex:t,colIndex:i},{dataObj:{cellType:c},sheetIdx:o}));n("#"+s).ejDatePicker({width:"100%",height:"100%",value:u.value||new Date,create:n.proxy(this._onDateCreate),change:n.proxy(this.onDateChange),cssClass:u["class"]||""})}}},addCellTypes:function(n,t,i){this._rangeCellTypes([{range:n,settings:t}],i)},_rangeCellTypes:function(i,r){var c,g,e,nt,b,tt;if(i){var u=this.XLObj,s=r||u.getActiveSheetIndex(),v,p=u._dataContainer,f,o,h,l,y,k,w,a,d=u.getSheet(s),it=d.cellTypes.length;for(t.merge(d.cellTypes,i),i=d.cellTypes,c=it,g=d.cellTypes.length;c<g;c++)if(w=u.getRangeIndices(i[c].range),o=i[c].settings,f=u.XLSelection._getSelectedRange({rowIndex:w[0],colIndex:w[1]},{rowIndex:w[2],colIndex:w[3]}),f.length===1)this._renderControls(f[0].rowIndex,f[0].colIndex,s,o);else{for(e=0,nt=f.length;e<nt;e++){a=u.getObjectLength(p.sheetCellType);h&&(h=u.getCell(f[e].rowIndex,f[e].colIndex,s),text=o.text||u.XLEdit.getPropertyValue(f[e].rowIndex,f[e].colIndex,"value2",s)||o.type+u._generateHeaderText(s,f[e].colIndex+1)+(f[e].rowIndex+1),h[0].innerHTML="");u._hasClass(h,"e-cellreadonly")||u.addClass(h,"e-cellreadonly");switch(o.type){case"Button":l=u._id+"_btn"+c+"_"+s+u._generateHeaderText(s,f[e].colIndex+1)+(f[e].rowIndex+1);h&&(h.css("vertical-align","middle"),h[0].innerHTML="<button id ="+l+' style = "border:0px; padding:0px;color:'+(o.color||"")+";background:"+(o["background-color"]||"")+';">'+text+"<\/button>");v={type:o.type,id:l,text:text,color:o.color||"","background-color":o["background-color"]||""};p.sheetCellType[a]=v;u.XLEdit._updateDataContainer({rowIndex:f[e].rowIndex,colIndex:f[e].colIndex},{dataObj:{cellType:a},sheetIdx:s});break;case"CheckBox":l=u._id+"_chk"+c+"_"+s+u._generateHeaderText(s,f[e].colIndex+1)+(f[e].rowIndex+1);h&&(h[0].innerHTML="<input id ="+l+" />");v={type:o.type,id:l,text:"",isChecked:o.isChecked||!1};p.sheetCellType[a]=v;u.XLEdit._updateDataContainer({rowIndex:f[e].rowIndex,colIndex:f[e].colIndex},{dataObj:{cellType:a},sheetIdx:s});break;case"DropDownList":for(l=u._id+"_drpdwn"+c+"_"+s+u._generateHeaderText(s,f[e].colIndex+1)+(f[e].rowIndex+1),h&&(h[0].innerHTML="<input id ="+l+" value = "+text+" />"),v={type:o.type,id:l,style:"",dataSourceRange:o.dataSourceRange||"",selectedIndex:o.selectedIndex||""},y=u.getRangeIndices(o.dataSourceRange),k=u.XLSelection._getSelectedRange({rowIndex:y[0],colIndex:y[1]},{rowIndex:y[2],colIndex:y[3]}),b=0,tt=k.length;b<tt;b++)u.XLEdit._updateDataContainer({rowIndex:k[b].rowIndex,colIndex:k[b].colIndex},{dataObj:{ddlRange:{rowIndex:f[e].rowIndex,colIndex:f[e].colIndex}}});p.sheetCellType[a]=v;u.XLEdit._updateDataContainer({rowIndex:f[e].rowIndex,colIndex:f[e].colIndex},{dataObj:{cellType:a},sheetIdx:s});break;case"DatePicker":l=u._id+"_dp"+c+"_"+s+u._generateHeaderText(s,f[e].colIndex+1)+(f[e].rowIndex+1);h&&(h[0].innerHTML="<input id ="+l+" value = "+text+' style = "height:'+(height-1)+'px" />');v={type:o.type,id:l,style:""};p.sheetCellType[a]=v;u.XLEdit._updateDataContainer({rowIndex:f[e].rowIndex,colIndex:f[e].colIndex},{dataObj:{cellType:a},sheetIdx:s})}}switch(o.type){case"Button":n("[id^='"+u._id+"_btn"+c+"_"+s+"']").ejButton({width:"100%",height:"100%",create:n.proxy(this._onButtonCreate),click:n.proxy(this.onButtonClick),cssClass:i["class"]||""});break;case"CheckBox":n("[id^='"+u._id+"_chk"+c+"_"+s+"']").ejCheckBox({change:n.proxy(this.onActiveStateChange),checked:o.isChecked||!1,cssClass:i["class"]||""});break;case"DropDownList":n("[id^='"+u._id+"_drpdwn"+c+"_"+s+"']").ejDropDownList({width:"100%",height:"100%",change:n.proxy(this.onActiveValueChange),dataSource:u.getRangeData(y,"","",s),fields:{text:"value2"},watermarkText:o.watermarkText||"Select an option",cssClass:o["class"]||"",selectedIndex:o.selectedIndex||""});break;case"DatePicker":n("[id^='"+u._id+"_dp"+c+"_"+s+"']").ejDatePicker({width:"100%",height:"100%",value:o.value||new Date,create:n.proxy(this._onDateCreate),change:n.proxy(this.onDateChange),cssClass:i["class"]||""})}}}},removeCellTypes:function(n,t){for(var f=this.XLObj,i=f.getRangeIndices(n),u=f.XLSelection._getSelectedRange({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]}),r=0,e=u.length;r<e;r++)this._removeControls(u[r].rowIndex,u[r].colIndex,t)},_removeControls:function(n,t,i,r){var u=this.XLObj,f=u.getCell(n,t,i),e=u._dataContainer,o=u.getActiveSheetIndex();r||(delete e.sheetCellType[e.sheets[o][n][t].cellType],delete e.sheets[o][n][t].cellType);f&&(f[0].innerHTML=u.XLEdit.getPropertyValue(n,t,"value2",o)||"");u._removeClass(f,"e-cellreadonly")},onActiveValueChange:function(t){var i=n("#"+this._id.split("_")[0]).data("ejSpreadsheet"),r=i._dataContainer,u=this.element.closest("td"),f=u[0].parentNode.rowIndex,e=u[0].cellIndex,o=i.getActiveSheetIndex();r.sheetCellType[r.sheets[o][f][e].cellType].selectedIndex=t.itemId;i.XLEdit._updateDataContainer({rowIndex:f,colIndex:e},{dataObj:i.XLEdit._parseValue(t.value)});i._trigger("ddlChange",t)},onActiveStateChange:function(t){var i=n("#"+this._id.split("_")[0]).data("ejSpreadsheet"),r=i._dataContainer,u=this.element.closest("td"),f=u[0].parentNode.rowIndex,e=u[0].cellIndex,o=i.getActiveSheetIndex();r.sheetCellType[r.sheets[o][f][e].cellType].isChecked=t.isChecked},_onDateCreate:function(t){var i=n("#"+this._id.split("_")[0]).data("ejSpreadsheet"),e=i._dataContainer,r=this.element.closest("td"),u=r[0].parentNode.rowIndex,f=r[0].cellIndex,o=i.getActiveSheetIndex();i.XLEdit._updateDataContainer({rowIndex:u,colIndex:f},{dataObj:i.XLEdit._parseValue(t.model.value.toLocaleString().split(", ")[0])})},onDateChange:function(t){var i=n("#"+this._id.split("_")[0]).data("ejSpreadsheet"),e=i._dataContainer,r=this.element.closest("td"),u=r[0].parentNode.rowIndex,f=r[0].cellIndex,o=i.getActiveSheetIndex();i.XLEdit._updateDataContainer({rowIndex:u,colIndex:f},{dataObj:i.XLEdit._parseValue(t.model.value.toLocaleString().split(", ")[0])})},_onButtonCreate:function(t){var i=n("#"+this._id.split("_")[0]).data("ejSpreadsheet"),e=i._dataContainer,r=this.element.closest("td"),u=r[0].parentNode.rowIndex,f=r[0].cellIndex,o=i.getActiveSheetIndex();i.XLEdit._updateDataContainer({rowIndex:u,colIndex:f},{dataObj:i.XLEdit._parseValue(t.model.text)})},onButtonClick:function(t){var i=n("#"+this._id.split("_")[0]).data("ejSpreadsheet");i._trigger("buttonClick",t)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cFormat=function(n){this.XLObj=n};t.spreadsheetFeatures.cFormat.prototype={getCFRule:function(n,t){var u=this.XLObj,h=u.getActiveSheetIndex(),f=u.XLEdit.getPropertyValue(n,t,["cFormatRule"]),e=[],s=u._dataContainer.cFormatData,i,r,o;if(f)for(r=0,o=f.length;r<o;r++)i=s[f[r]].split("_"),e.push({action:i[0],input1:i[2],input2:i[3],color:i[4],range:i[5],isApplied:JSON.parse(i[7])});return e},setCFRule:function(n){var t=this.XLObj;t.model.allowConditionalFormats&&this._cFormat(n.action,n.input1,n.input2,n.color,n.range,t.getActiveSheetIndex())},_updateCFormatRule:function(n,t){return n.indexOf("true")>-1?n.replace("true",t):n.replace("false",t)},_getRuleIndex:function(n,i){if(t.isNullOrUndefined(i))return-1;for(var r=0,u=i.length;r<u;r++)if(i[r]===n)return r;return-1},_cFormat:function(n,t,i,r,u,f,e,o){var s=this.XLObj;if(s.model.allowConditionalFormats){s.element.ejWaitingPopup("show");f=f?f:s.getActiveSheetIndex();var h=s.getSheet(f),c=h.selectedRange,l={sheetIndex:f,reqType:"cond-format",action:"add",range:c};switch(n){case"greaterthan":this._applyGLEValues(">",t,r,n,u,f,e);break;case"greaterequalto":this._applyGLEValues(">=",t,r,n,u,f,e);break;case"lessthan":this._applyGLEValues("<",t,r,n,u,f,e);break;case"lessequalto":this._applyGLEValues("<=",t,r,n,u,f,e);break;case"equalto":this._applyGLEValues("==",t,r,n,u,f,e);break;case"notequalto":this._applyGLEValues("!=",t,r,n,u,f,e);break;case"between":this._applyBetweenValues("=",t,i,r,n,u,f,e);break;case"notbetween":this._applyBetweenValues("!",t,i,r,n,u,f,e);break;case"textcontains":this._applyContainsValues(t,r,n,u,f,e);break;case"dateoccur":this._applyDateContainsValues(t,r,n,u,f,e)}h._isImported&&!h._isLoaded||s._isUndoRedo||o==="paste"||s._dupDetails||s._completeAction(l);s.element.ejWaitingPopup("hide")}},clearCF:function(n,i){var r=this.XLObj,u=r.getActiveSheetIndex(),f,e,a={sheetIndex:u,reqType:"cond-format",action:"clear",selection:n,rule:[]},h=r.getSheet(u),o,v,c,s,l;if(r.model.allowConditionalFormats){for(c=r._dataContainer.cFormatData,r.isUndefined(i)?s=n?h._selectedCells:r.XLSelection._getSelectedRange({rowIndex:0,colIndex:0},{rowIndex:h.rowCount-1,colIndex:h.colCount-1}):(i=r._toIntrnlRange(i,u),s=r.XLSelection._getSelectedRange({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]})),o=0,v=s.length;o<v;o++)f=s[o].rowIndex,e=s[o].colIndex,t.isNullOrUndefined(r._dataContainer.sheets[u][f])||t.isNullOrUndefined(r._dataContainer.sheets[u][f][e])||t.isNullOrUndefined(r._dataContainer.sheets[u][f][e].cFormatRule)||(a.rule.push(this.getCFRule(f,e)),r.clearRangeData([f,e,f,e],["cFormatRule"]));l=n?"clear_"+u+"_"+r._getSelectedItems()[1]:"clear_"+u+"_entire";c.indexOf(l)===-1&&c.push(l);r._isUndoRedo||r._dupDetails||r._completeAction(a)}},_getValueForCFormat:function(n,t){var f=this.XLObj,r=n.rowIndex,u=n.colIndex,o=f.getRangeData([r,u,r,u],!1,null,t),i=f.XLEdit.getPropertyValue(r,u),e=f.XLEdit.getPropertyValue(r,u,"value2");return i=i?i.toString():"",(e&&typeof e=="string"&&!o.formatStr&&i[0]==="="||f.XLEdit.getPropertyValue(r,u,"type")==="datetime")&&(i=e),i},_applyGLEValues:function(i,r,u,f,e,o,s){var h=this.XLObj,c,p,v,y,l,d,g,nt,w,k=new RegExp(/[^.0-9]+/g),ft=new RegExp(/[^.-a-zA-Z 0-9]+/g),tt=h.getSheet(o),it=tt._startCell,rt=tt._endCell,a,b,ut;for(t.isNullOrUndefined(s)&&t.isNullOrUndefined(e)?p=h.getSheet(o)._selectedCells:t.isNullOrUndefined(s)?(a=h.getRangeIndices(e),p=h.XLSelection._getSelectedRange({rowIndex:a[0],colIndex:a[1]},{rowIndex:a[2],colIndex:a[3]})):(a=typeof s=="string"?h.getRangeIndices(s):s,p=h.XLSelection._getSelectedRange({rowIndex:a[0],colIndex:a[1]},{rowIndex:a[2],colIndex:a[3]})),b=0,ut=p.length;b<ut;b++)if(v=p[b].rowIndex,y=p[b].colIndex,!h.XLEdit.getPropertyValue(v,y,"isMHide")&&!h.XLEdit.getPropertyValue(v,y,"isFilterHide")){if(c=this._getValueForCFormat({rowIndex:v,colIndex:y},o),w=h.XLEdit.getPropertyValue(v,y,"type")?h.XLEdit.getPropertyValue(v,y,"type"):"general",d=!0,nt=-1,t.isNullOrUndefined(c)||!c.length)l=f==="lessthan"||f==="lessequalto";else if(n.isNumeric(r))if(n.isNumeric(c))c=parseFloat(c),l=h.operators[i](c,parseFloat(r.replace(ft,""))),w==="percentage"&&(l=h.operators[i](c,0));else if(h._isValidDate(c))l=h.operators[i](h._dateToInt(c),parseFloat(r));else if(h._isValidTime(c))continue;else l=h.operators[i](c.toLowerCase(),r.toLowerCase());else r.lastIndexOf("%")===r.length-1&&n.isNumeric(r.replace(k,""))?l=w==="percentage"?h.operators[i](parseFloat(c),parseFloat(r.replace(k,""))):n.isNumeric(c)?h.operators[i](parseFloat(c),0):h.operators[i](c.length,0):r.indexOf("$")===0&&n.isNumeric(r.replace(k,""))?l=w==="accounting"||w!=="currency"||n.isNumeric(c)?h.operators[i](parseFloat(c),parseFloat(r.replace(k,""))):(h.operators[i](c.length,0)||h._isValidDate(c))&&!h._isValidTime(c):h._isValidDate(r)?h._isValidDate(c)?l=h.operators[i](h._dateToInt(new Date(c)),h._dateToInt(new Date(r))):h._isValidTime(c)||(l=n.isNumeric(c)?h.operators[i](parseFloat(c),h._dateToInt(r)):h.operators[i](c.length,h._dateToInt(r))):l=h._isValidTime(r)?h._isValidTime(c)?h.operators[i](h.parse.parseTime(c),h.parse.parseTime(r)):n.isNumeric(c)?h.operators[i](parseFloat(c),0):h.operators[i](c.length,0):h.operators[i](c.toLowerCase(),r.toLowerCase());t.isNullOrUndefined(e)&&(e=h._generateHeaderText(o,it.colIndex+1)+(it.rowIndex+1)+":"+h._generateHeaderText(o,rt.colIndex+1)+(rt.rowIndex+1));g=f+"_"+i+"_"+r+"__"+u+"_"+e+"_"+h.getActiveSheetIndex();this._applyCFormatRule({rowIndex:v,colIndex:y},g,nt,l,d,u)}},_applyBetweenValues:function(i,r,u,f,e,o,s,h){var c=this.XLObj,l,w,d,v,g,nt,tt,p,y=new RegExp(/[^.0-9]+/g),k=new RegExp(/[^.-a-zA-Z 0-9]+/g),ot,it=c.getSheet(s),rt=it._startCell,ut=it._endCell,a,b,ft;for(c.operators["<"](r,u)||(d=u,u=r,r=d),t.isNullOrUndefined(h)&&t.isNullOrUndefined(o)?w=c.getSheet(s)._selectedCells:t.isNullOrUndefined(h)?(a=c.getRangeIndices(o),w=c.XLSelection._getSelectedRange({rowIndex:a[0],colIndex:a[1]},{rowIndex:a[2],colIndex:a[3]})):(a=typeof h=="string"?c.getRangeIndices(h):h,w=c.XLSelection._getSelectedRange({rowIndex:a[0],colIndex:a[1]},{rowIndex:a[2],colIndex:a[3]})),b=0,ft=w.length;b<ft;b++)if(rowIdx=w[b].rowIndex,colIdx=w[b].colIndex,!c.XLEdit.getPropertyValue(rowIdx,colIdx,"isMHide")&&!c.XLEdit.getPropertyValue(rowIdx,colIdx,"isFilterHide")){if(l=this._getValueForCFormat({rowIndex:rowIdx,colIndex:colIdx},s),p=c.XLEdit.getPropertyValue(rowIdx,colIdx,"type")?c.XLEdit.getPropertyValue(rowIdx,colIdx,"type"):"general",g=!0,tt=-1,t.isNullOrUndefined(l)||!l.length)v=!1;else if(n.isNumeric(r.replace(k,""))&&n.isNumeric(u.replace(k,""))&&p!=="percentage"&&p!=="currency"&&p!=="accounting")if(r=r.replace(k,""),u=u.replace(k,""),n.isNumeric(l))v=c.operators[i](parseFloat(l)>=parseFloat(r)&&parseFloat(l)<=parseFloat(u));else if(c._isValidDate(l))v=c.operators[i](c._dateToInt(l)>=parseFloat(r)&&ot<=parseFloat(u));else if(c._isValidTime(l))continue;else v=c.operators[i](l.toLowerCase()>=r.toLowerCase()&&l.toLowerCase()<=u.toLowerCase());else if(r.lastIndexOf("%")===r.length-1&&n.isNumeric(r.replace(y,""))&&u.lastIndexOf("%")===u.length-1&&n.isNumeric(u.replace(y,""))&&p==="percentage")v=c.operators[i](parseFloat(l)>=parseFloat(r.replace(y,""))&&parseFloat(l)<=parseFloat(u.replace(y,"")));else if(r.indexOf("$")===0&&n.isNumeric(r.replace(y,""))&&u.indexOf("$")===0&&n.isNumeric(u.replace(y,""))&&(p==="accounting"||p!=="currency"))v=c.operators[i](parseFloat(l)>=parseFloat(r.replace(y,""))&&parseFloat(l)<=parseFloat(u.replace(y,"")));else if(c._isValidDate(r)&&c._isValidDate(u)){var et=c._dateToInt(new Date(l)),st=c._dateToInt(new Date(r)),ht=c._dateToInt(new Date(u));v=c.operators[i](et>=st&&et<=ht)}else v=c._isValidTime(r)&&c._isValidTime(u)&&c._isValidTime(l)?c.operators[i](c.parse.parseTime(l)>=c.parse.parseTime(r)&&c.parse.parseTime(l)<=c.parse.parseTime(u)):c.operators[i](l.toLowerCase()>=r.toLowerCase()&&l.toLowerCase()<=u.toLowerCase());t.isNullOrUndefined(o)&&(o=c._generateHeaderText(s,rt.colIndex+1)+(rt.rowIndex+1)+":"+c._generateHeaderText(s,ut.colIndex+1)+(ut.rowIndex+1));nt=e+"_"+i+"_"+r+"_"+u+"_"+f+"_"+o+"_"+c.getActiveSheetIndex();this._applyCFormatRule({rowIndex:rowIdx,colIndex:colIdx},nt,tt,v,g,f)}},_applyContainsValues:function(i,r,u,f,e,o){var s=this.XLObj,h,l,a,y,p,w,b=new RegExp(/[^.-a-zA-Z 0-9]+/g),k=s.getSheet(e),d=k._startCell,g=k._endCell,c,v,nt;for(t.isNullOrUndefined(o)&&t.isNullOrUndefined(f)?l=s.getSheet(e)._selectedCells:t.isNullOrUndefined(o)?(c=s.getRangeIndices(f),l=s.XLSelection._getSelectedRange({rowIndex:c[0],colIndex:c[1]},{rowIndex:c[2],colIndex:c[3]})):(c=typeof o=="string"?s.getRangeIndices(o):o,l=s.XLSelection._getSelectedRange({rowIndex:c[0],colIndex:c[1]},{rowIndex:c[2],colIndex:c[3]})),v=0,nt=l.length;v<nt;v++)(rowIdx=l[v].rowIndex,colIdx=l[v].colIndex,s.XLEdit.getPropertyValue(rowIdx,colIdx,"isMHide")||s.XLEdit.getPropertyValue(rowIdx,colIdx,"isFilterHide"))||(h=this._getValueForCFormat({rowIndex:rowIdx,colIndex:colIdx},e),type=s.XLEdit.getPropertyValue(rowIdx,colIdx,"type")?s.XLEdit.getPropertyValue(rowIdx,colIdx,"type"):"general",y=!0,w=-1,t.isNullOrUndefined(h)||!h.length?a=!1:n.isNumeric(i.replace(b,""))?(i=i.replace(b,""),s._isValidDate(h)&&(h=s._dateToInt(h).toString()),a=h.indexOf(i)>-1):s._isValidDate(i)?(s._isValidDate(h)&&(h=s._dateToInt(h).toString()),a=h.indexOf(s._dateToInt(i))>-1):s._isValidTime(i)?(s._isValidTime(h)&&(h=s._dateToInt("01/01/1990 "+h).toString()),a=h.indexOf(s._dateToInt("01/01/1990 "+i))>-1):a=h.toLowerCase().indexOf(i.toLowerCase())>-1,t.isNullOrUndefined(f)&&(f=s._generateHeaderText(e,d.colIndex+1)+(d.rowIndex+1)+":"+s._generateHeaderText(e,g.colIndex+1)+(g.rowIndex+1)),p=u+"__"+i+"__"+r+"_"+f+"_"+s.getActiveSheetIndex(),this._applyCFormatRule({rowIndex:rowIdx,colIndex:colIdx},p,w,a,y,r))},_applyDateContainsValues:function(n,i,r,u,f,e){var o=this.XLObj,c,l=!1,a,v,y=o.getSheet(f),p=y._startCell,w=y._endCell,s,h,b,k,d;for(t.isNullOrUndefined(e)&&t.isNullOrUndefined(u)?selected=o.getSheet(f)._selectedCells:t.isNullOrUndefined(e)?(s=o.getRangeIndices(u),selected=o.XLSelection._getSelectedRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]})):(s=typeof e=="string"?o.getRangeIndices(e):e,selected=o.XLSelection._getSelectedRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]})),h=0,b=selected.length;h<b;h++)(rowIdx=selected[h].rowIndex,colIdx=selected[h].colIndex,o.XLEdit.getPropertyValue(rowIdx,colIdx,"isMHide")||o.XLEdit.getPropertyValue(rowIdx,colIdx,"isFilterHide"))||(c=this._getValueForCFormat({rowIndex:rowIdx,colIndex:colIdx},f),v=-1,t.isNullOrUndefined(c)||!c.length?l=!1:o._isValidDate(n)&&(k=new Date(c),d=new Date(n),l=k-d==0),t.isNullOrUndefined(u)&&(u=o._generateHeaderText(f,p.colIndex+1)+(p.rowIndex+1)+":"+o._generateHeaderText(f,w.colIndex+1)+(w.rowIndex+1)),a=r+"__"+n+"__"+i+"_"+u+"_"+o.getActiveSheetIndex(),this._applyCFormatRule({rowIndex:rowIdx,colIndex:colIdx},a,v,l,!0,i))},refreshCFormat:function(n){var i=this.XLObj,y=i._dupDetails,f,r,s,h,e,o,u,v,c,l,a;if(i._dupDetails=!0,i.model.allowConditionalFormats){for(s=[],h=i.getActiveSheetIndex(),t.isNullOrUndefined(n)?o=i.getSheet(h)._selectedCells:(typeof n=="string"&&(n=i.getRangeIndices(n)),o=i.XLSelection._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]})),f=0,v=o.length;f<v;f++){if(l=o[f].rowIndex,a=o[f].colIndex,u=i.XLEdit.getPropertyValue(l,a,"cFormatRule"),!i.isUndefined(u)&&u.length)for(r=0,c=u.length;r<c;r++)u[r]=u[r].replace("_true","").replace("_false",""),s.indexOf(u[r])<0&&s.push(u[r]);i._isRowViewable(h,l)&&i.getCell(l,a,h).removeClass("e-redft e-yellowft e-greenft e-redf e-redt");i.clearRangeData(null,["cFormatRule"],o[f])}for(r=0,c=s.length;r<c;r++)e=s[r].split("_"),this._cFormat(e[0],e[2],e[3],e[4],e[5]);i._dupDetails=y}},_applyCFormatRule:function(n,t,i,r,u,f){var o=this.XLObj,v=o.getActiveSheetIndex(),s=n.rowIndex,h=n.colIndex,y,c,e=o.XLEdit.getPropertyValue(s,h,"cFormatRule"),l,p,b=!0,a,k;if(this._getRuleIndex(t+"_true",e)>-1&&(i=this._getRuleIndex(t+"_true",e)),this._getRuleIndex(t+"_false",e)>-1&&(i=this._getRuleIndex(t+"_false",e)),i>-1&&(l=e[i],p=o._dataContainer.cFormatData.indexOf(this._updateCFormatRule(l,r)),p>-1?o._dataContainer.sheets[v][s][h].cFormatRule[i]=p:(o._dataContainer.cFormatData.push(this._updateCFormatRule(l,r)),o._dataContainer.sheets[v][s][h].cFormatRule[i]=o._dataContainer.cFormatData.length-1)),e=o.XLEdit.getPropertyValue(s,h,"cFormatRule"),o._isRowViewable(v,s)&&(y=!0,c=o.getCell(s,h)),!o.isUndefined(e)&&e.length>0&&(!(t+"_true"===e[i]||t+"_false"===e[i])||e.length>1)){for(a=0,k=e.length;a<k;a++)l=e[a].split("_");y&&(r?c.removeClass("e-redft e-yellowft e-greenft e-redf e-redt").addClass("e-"+f):u&&c.removeClass("e-"+f))}else y&&(r?c.removeClass("e-redft e-yellowft e-greenft e-redf e-redt").addClass("e-"+f):c.removeClass("e-"+f));if(e&&e.length){var d=o.getRangeIndices(t.split("_")[5]),g=o.getRangeIndices(e[0].split("_")[5]),w=t.split("_");w.splice(6,1);w.splice(5,1);e[0].indexOf(w.join("_"))>-1&&o.inRange(g,d[0],d[1])&&(b=!1)}b&&this._getRuleIndex(t+"_true",e)<0&&this._getRuleIndex(t+"_false",e)<0&&o.XLEdit._updateDataContainer(n,{dataObj:{cFormatRule:[t+"_"+r]}})}}}(jQuery,Syncfusion),function(n,t,i){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.clipboard=function(n){this.XLObj=n;this._cutCells=[];this._copyCells=[];this._copyBackup={};this._cData="";this._isCut=!1;this._copyRange=[];this._isSpecial=!0;this._isShape=!1};t.spreadsheetFeatures.clipboard.prototype={copy:function(){this._triggerKeyDown(67,!0)},cut:function(){this._triggerKeyDown(88,!0)},paste:function(){this._triggerKeyDown(86,!0)},_initCopyPaste:function(){var i=this.XLObj._id,r=t.buildTag("div",{},{position:"fixed",top:-1e3,left:-1e3},{id:i+"_copyPaste"});n("body").append(r);r.append(t.buildTag("textarea ."+i+"_copyTxt",{},{width:1,height:1,overflow:"hidden",opacity:0,resize:"none",cursor:"default"},{id:i+"_hiddenTxt"}))},_copyPasteHandler:function(t){var r,i=this.XLObj,u=i.getSheet(i.getActiveSheetIndex());if(i._isUndoRedo=!1,(t.keyCode===67||t.keyCode===88||t.keyCode===86)&&i._preventctrlkey){i._showAlertDlg("Alert","CtrlKeyErrorAlert","CtrlKeyErrorAction",450);return}if(t.ctrlKey)if(t.keyCode===67)this._getClipboard(t),this._cutCells=[],n.extend(!0,this._copyCells,u._selectedCells),this._copyCells.length||(this._copyCells=[i.XLShape._picCellIdx]),setTimeout(function(){i.setSheetFocus()},0);else if(t.keyCode===88){if(r=u._selectedCells,i.model.allowLockCell&&u._isSheetProtected&&i._israngeProtected(r)){i._popUplockCellAlert();return}n.extend(!0,this._cutCells,r);this._cutCells.length||(this._cutCells=[i.XLShape._picCellIdx]);this._getClipboard(t);setTimeout(function(){i.setSheetFocus()},0)}else t.keyCode===86&&(i.isUndefined(t.bubbles)||(this._isSpecial=!0),n("#"+i._id+"_hiddenTxt").select(),setTimeout(function(){i.XLClipboard._setClipboard()},0));else t.keyCode===27&&i.element.find(".e-cdata").length&&i.element.find("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom")},_triggerKeyDown:function(t,i){var u=this.XLObj,r;u.setSheetFocus();r=n.Event("keydown");r.keyCode=t;r.ctrlKey=i;n("#"+u._id).trigger(r)},_getClipboard:function(t){var i=this.XLObj,r=i.getActiveSheetIndex(),e=i.getSheet(r),o=e._startCell,s=e._endCell,f=i._getContent(r).find(".e-selected"),h=i.getActiveCellElem(r)[0],u;!i.XLClipboard._copyBackup.cells&&i.model.showRibbon&&(i.XLRibbon._enableButtons(["pastebtn"],"ejButton"),i.XLRibbon._enableButtons(["pastesbtn"],"ejSplitButton"));f.length?(this._copyBackup={cells:[],border:i.model.allowCellFormatting&&i.XLFormat.getHashCodeClassAsArray(),table:[],filterRange:[]},u=this._getSelectedData(o,s),i.element.find(".e-cdata").length&&i.element.find("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),n(f).addClass("e-cdata"),i.XLSelection._focusBorder(o,s,i._cutFocus),this._cData=f.length<2&&!u.length?u=" ":u,this._isCut=!1,n("#"+i._id+"_hiddenTxt").val(u).select(),this._copyBackup.actCellPos={top:h.offsetTop,left:h.offsetLeft},this._copyBackup.cells[0].cell.wrap&&(this._copyBackup.cells[0].cell.wrap=""),t.keyCode==67&&(this._copyBackup.copypaste=!0),this._isShape=!1):(this._isShape=!0,this._copyBackup={elem:i.getSheetElement(r).find(".e-ss-activeimg"),isCut:t.keyCode===88,sIdx:r})},_getSelectedData:function(t,i){var u=this.XLObj,c="",f,r,s,l=u.getActiveSheetIndex(),v,h,b,a;for(t.rowIndex>=i.rowIndex&&(v=t,t=i,i=v),this._copyRange=[],this._copyRange.push(u.getActiveSheetIndex()),this._copyRange.push(u._getSelectedItems()[1]),f=t.rowIndex;f<=i.rowIndex;f++)if(f!==t.rowIndex&&(c+="\n"),t.colIndex<=i.colIndex)for(r=t.colIndex;r<=i.colIndex;r++)cData=u.getRangeData([f,r,f,r],!1,["type","value","value2"])[0],s=u.getObjectLength(cData)?cData.type!=="general"?cData.value2:cData.value:"",this._updateCBackupData(f,r),c+=r!==i.colIndex?s+"\t":s;else for(r=i.colIndex;r<=t.colIndex;r++)cData=u.getRangeData([f,r,f,r],!1,["type","value","value2"])[0],s=u.getObjectLength(cData)?cData.type!=="general"?cData.value2:cData.value:"",this._updateCBackupData(f,r),c+=r!==t.colIndex?s+"\t":s;var y=u.model.sheets[l]._tableManager,e,o,p=[],w=u.model.sheets[l].selectedRange;for(h=1,b=u.getObjectLength(y);h<=b;h++)if(e=n.extend(!0,{},y[h]),o=e.range,this._compareRange(w,e.totalRow?[o[0],o[1],o[2]+1,o[3]]:o)){p.push(e.name);e.header=!0;e.id=h;this._copyBackup.table.push({tblName:p,tblObj:e,range:o});break}return a=u.getRangeIndices(u.model.sheets[l].filterSettings.range),this._compareRange(w,a)&&(this._copyBackup.filterRange=a),c},_updateCBackupData:function(t,i){var u=this.XLObj;if(u.model.allowClipboard){var o=u.getActiveSheetIndex(),f,e=u._dataContainer.sheets[o],r,s=new RegExp("\\be-format.*?\\b","g");t in e&&i in e[t]?(r=n.extend(!0,{},e[t][i]),f=r.format?r.format:""):(r={},f="");this._copyBackup.cells.push({cell:r,format:f})}},_setClipboard:function(){var vr,gi,uu,pr,r=this.XLObj,o,ei,ut=[],c=[],wt,nr=new RegExp("\\be-format.*?\\b","g"),v,bt=!1,k,u=r.getActiveSheetIndex(),d={cSheetIndex:this._copyRange[0],pSheetIndex:u,sheetIndex:u},wr=[],kt=r.getSheet(u)._startCell,dt=r.getSheet(u)._endCell,y,nt,ft=0,h,it,gt,tr,oi,a={},g,ir,vt,br=new RegExp("\\be-shapebdr.*?\\b","g"),kr=["solid","dashed","dotted"],p=kt.rowIndex<dt.rowIndex?kt.rowIndex:dt.rowIndex,rr,ur=this._copyBackup.table,ct,li,w=kt.colIndex<dt.colIndex?kt.colIndex:dt.colIndex,l=r._dataContainer,f,lt,ai,si,st,er,tu,vi,ri,e,s,fu,eu,yi,pi,or,sr,yt,yr,wi,ot,ui,hr,cr,at,di,hi,ru,ar,ci;if(r.model.allowLockCell&&r.getSheet(u)._isSheetProtected&&(ei=r.swapRange(r.getRangeIndices(this._copyRange[1])),vr=r.XLSelection._getSelectedRange({rowIndex:p,colIndex:w},{rowIndex:p+(ei[2]-ei[0]),colIndex:w+(ei[3]-ei[1])}),r._israngeProtected(vr))){r._popUplockCellAlert();return}if(p===0&&w===0&&this._copyCells.length===this.XLObj.model.rowCount*this.XLObj.model.columnCount||this._copyCells.length!==this.XLObj.model.rowCount*this.XLObj.model.columnCount){var dr=r.model.sheets[u],ni=r.getSheetElement(u).find(".e-activecell"),et=r.getSheet(this._copyBackup.sIdx||this._copyRange[0]||u)._shapeMngr,ti,tt,ii,gr,nu,fr,b;if(this._isShape)si=r.XLShape._picCellIdx,st=r.getActiveCell(u),g=this._copyBackup.elem,ai=g[0].id,wt=ai.indexOf("picture")>-1?"picture":"chart",d={sheetIndex:u,cSheetIndex:this._copyBackup.sIdx,pSheetIndex:u,operation:"shape",cShapeId:ai,reqType:this._copyBackup.isCut?"cut-paste":"copy-paste"},o=n.extend(!0,{},l.sheets[this._copyBackup.sIdx][si.rowIndex][si.colIndex]),c=r.getCell(st.rowIndex,st.colIndex),n.extend(!0,a,et[wt][ai]),d.cutCell={rowIndex:si.rowIndex,colIndex:si.colIndex,obj:o,shapeObj:n.extend(!0,{},a)},g=r.element.find("#"+a.id),wt==="picture"?(tt=g[0].className,tt.indexOf("e-shapebdr")>-1?(tt=g[0].className.match(br)[0],ct=tt.replace("e-shapebdr","").split("N"),li=ct[2],r.XLShape._createPicture(u,st,et.sharedPics[a.data],c[0].offsetTop,c[0].offsetLeft,a.width,a.height,null,"#"+li,kr[parseInt(ct[1])-1],ct[0]+"px"),r.model.showRibbon&&r.XLRibbon._formatTabUpdate()):(r.XLShape._createPicture(u,st,et.sharedPics[a.data],c[0].offsetTop,c[0].offsetLeft,a.width,a.height),r.model.showRibbon&&r.XLRibbon._formatTabUpdate())):(f=a.range,f=r._getAlphaRange(u,f[0],f[1],f[2],f[3]),f.indexOf(":")===-1&&(f=f+":"+f),a.top=c[0].offsetTop,a.left=c[0].offsetLeft,r.XLChart.createChart(f,n.extend(!0,{},a))),this._copyBackup.isCut&&g.remove(),this._isShape=this._copyBackup.isCut?!1:!0,this._cutCells=[],r._isUndoRedo||(o=n.extend(!0,{},l.sheets[u][st.rowIndex][st.colIndex]),a=n.extend(!0,{},dr._shapeMngr[wt][o[wt][0]]),d.pShapeId=o[wt][0],d.pasteCell={rowIndex:st.rowIndex,colIndex:st.colIndex,obj:o,shapeObj:a},r._completeAction(d));else{if(tu=[],d.reqType=this._cutCells.length>0?"cut-paste":"copy-paste",r.element.find(".e-selected").hasClass("e-readonly")){r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom");return}if(d.text=ut=n("#"+r._id+"_hiddenTxt").val().split("\n"),bt=this._cData===n("#"+r._id+"_hiddenTxt").val(),this._cData.length<1&&d.text.length<1)return;if(bt||ut[ut.length-1]!==""||ut.splice(ut.length-1,1),er=[],tu=[],bt?(d.isSpecial=this._isSpecial,f=r.getRangeIndices(this._copyRange[1]),r.setActiveSheetIndex(this._copyRange[0]),d.cutBorder={range:f,prevBorder:r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(f)},r.setActiveSheetIndex(u)):d.isSpecial=!1,this._cutCells.length){for(fr=[],b=this._copyRange[0],y=0,ii=this._cutCells.length;y<ii;y++)e=this._cutCells[y].rowIndex,s=this._cutCells[y].colIndex,v=r.getCell(e,s,b),c={rowIndex:e,colIndex:s,prevObj:{},newObj:{},shapes:[]},t.isNullOrUndefined(l.sheets[b][e])?c.prevObj={}:n.extend(!0,c.prevObj,l.sheets[b][e][s]),o=t.isNullOrUndefined(l.sheets[b][e])?{}:n.extend(!0,{},l.sheets[b][e][s]),v&&v[0]?("merge"in c.prevObj||r.XLEdit.updateCellValue({rowIndex:e,colIndex:s},"","",b),"wrap"in o&&(gt=r._generateHeaderText(b,s+1)+(e+1),r._dupDetails=!0,r.setWrapText("unwrap",gt+":"+gt),r._dupDetails=!1),"cellType"in o&&r.model.allowCellType&&r.XLCellType._removeControls(e,s,b,!0),v.removeClass("e-hyperlinks e-redft e-yellowft e-greenft e-redf e-redt"),v.hasClass("e-commentcell")&&r.XLComment.deleteComment([e,s,e,s],b),e in l.sheets[b]&&s in l.sheets[b][e]&&(t.isNullOrUndefined(l.sheets[b][e][s])||(uu=l.sheets[b][e][s].overflow),delete l.sheets[b][e][s],r._textClip(e,s,"delete")),v[0].className.match(nr)&&(v[0].className=v[0].className.replace(nr,"")),t.isNullOrUndefined(l.sheets[b][e])?c.newObj={}:n.extend(!0,c.newObj,l.sheets[b][e][s]),r._setRowHdrHeight(b,r._getCellIdx(v[0]).rowIndex)):r.getObjectLength(o)&&(pr=r.getObjectKeys(o),r.clearRangeData([e,s,e,s],pr),r.model.allowCellType&&"cellType"in o&&delete l.sheetCellType[l.sheets[b][e][s].cellType]),fr.push(c);for(h=0,it=ur.length;h<it;h++)rr=n.trim(ur[h].tblName),r.XLFormat.removeTable(n.trim(ur[h].tblName[0].replace("Table",""))),r.XLRibbon.removeNamedRange(rr);r.model.allowCellFormatting&&r.XLFormat.removeStyle(f,{cellStyle:!0,tableStyle:!0,format:!0});r.setActiveSheetIndex(b);r.setActiveSheetIndex(u);d.cutCells=fr;d.cfat={table:rr,range:f};nu=!0;r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom")}else{if(pi=[],this._isSpecial)for(y=0,ii=this._copyCells.length;y<ii;y++)e=this._copyCells[y].rowIndex,s=this._copyCells[y].colIndex,c={rowIndex:e,colIndex:s,prevObj:{},newObj:{}},t.isNullOrUndefined(l.sheets[u][e])||n.extend(!0,c.prevObj,l.sheets[u][e][s]),pi.push(c);else pi=this._copyCells;d.cutCells=pi}for(ut.length?ti=[p,w,p+ut.length-1,w+ut[0].split("\t").length-1]:(ti=[p,w,p,w],y=nt=1),d.pasteBorder={range:ti,prevBorder:r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(ti)},yr=r._getContTBody(u).find("rows"),y=0,ii=ut.length;y<ii;y++){for(c=ut[y].split("\t"),nt=0,gr=c.length;nt<gr;nt++)if(v=yr[r._getRowIdx(p+y)]?r.getCell(p+y,w+nt)[0]:i,t.isNullOrUndefined(v)?(dr.colCount<=w+nt?r.XLScroll._createNewColumn(u,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert"):r.model.scrollSettings.allowVirtualScrolling||r.XLScroll._createNewRow(u,-1,-1,"insert"),r.XLScroll._refreshScroller(u,"refresh","all"),v=r.getCell(p+y,w+nt)):v=n(v),!t.isNullOrUndefined(v)){if(k={rowIndex:p+y,colIndex:w+nt},k.prevObj=t.isNullOrUndefined(l.sheets[u][p+y])?{}:n.extend(!0,{},l.sheets[u][p+y][w+nt]),t.isNullOrUndefined(k.prevObj)||(delete k.prevObj.isMHide,delete k.prevObj.mergeIdx),this._isCut&&bt)return;if(currentCellIdx=r._getCellIdx(v[0]),this._isSpecial&&bt)if(f=r.getRangeIndices(this._copyRange[1]),yi=r.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]}),e=currentCellIdx.rowIndex,s=currentCellIdx.colIndex,fu=yi[ft].rowIndex,eu=yi[ft].colIndex,v[0].className=v[0].className.replace(nr,""),tt=r._dataContainer.hashCode[this._copyBackup.cells[ft].format],"merge"in this._copyBackup.cells[ft].cell||t.isNullOrUndefined(tt)||v.addClass(tt),o=n.extend(!0,{},this._copyBackup.cells[ft].cell),e in l.sheets[u]||(l.sheets[u][e]={}),s in l.sheets[u][e]?"comment"in l.sheets[u][e][s]&&r.getCell(e,s).removeClass("e-commentcell"):l.sheets[u][e][s]={},o){if(at=n.extend(!0,{},r.XLEdit.getPropertyValue(e,s,"merge")),or=r.XLEdit.getPropertyValue(e,s,"isMHide"),sr=n.extend(!0,{},r.XLEdit.getPropertyValue(e,s,"mergeIdx")),delete o.overflow,delete o.tableName,n.extend(!0,l.sheets[u][e][s],o),yt=l.sheets[u][e][s],r.getObjectLength(at)?yt.merge=at:delete yt.merge,r.getObjectLength(sr)?yt.mergeIdx=sr:delete yt.mergeIdx,r.isUndefined(or)?delete yt.isMHide:yt.isMHide=or,r.XLEdit.getPropertyValue(e,s,"value2")&&r._textClip(e,s,"add"),ri=o.value2&&typeof o.value2=="string"&&!o.formatStr?l.sharedData[o.value][0]==="="?l.sharedData[o.value]:o.value2:l.sharedData[o.value],o.type===3&&(ri=this._getUpdatedCellFormula(ri,this._copyCells[ft],{rowIdx:e,colIdx:s})),"merge"in o||r.XLEdit.updateCellValue(currentCellIdx,ri),"merge"in o){wi=0;at=o.merge;f=r.getRangeIndices(at.mRange);var bi=f[2]-f[0],ki=f[3]-f[1],ou=r.getSheet(u)._selectedCells,lr=r._getAlphaRange(u,k.rowIndex,k.colIndex,k.rowIndex+bi,k.colIndex+ki),fi,su=dt.rowIndex-kt.rowIndex,hu=dt.colIndex-kt.colIndex;if(ot=r.XLSelection._getSelectedRange({rowIndex:k.rowIndex,colIndex:k.colIndex},{rowIndex:k.rowIndex+bi,colIndex:k.colIndex+ki}),yi.length>=ou.length||!((hu+1)%(ki+1)==0&&(su+1)%(bi+1)==0)){for(h=0,it=ot.length;h<it;h++)t.isNullOrUndefined(r.XLEdit.getPropertyValue(ot[h].rowIndex,ot[h].colIndex,"isMHide"))&&(ui=r.XLEdit.getPropertyValue(ot[h].rowIndex,ot[h].colIndex,"merge"),wi++,t.isNullOrUndefined(ui)||(ui&&(hr=ui.mSpan.rowSpan,cr=ui.mSpan.colSpan),t.isNullOrUndefined(hr)||t.isNullOrUndefined(cr)||(wi+=parseInt(hr)*parseInt(cr)-1),ui.isCenterAlign&&r._isRowViewable(u,ot[h].rowIndex)&&r.getCell(ot[h].rowIndex,ot[h].colIndex).addClass("e-calign").removeClass("e-ralign")));if(ot.length===wi){if(this._cutCells.length){for(var iu=!1,fi=r._getSelectedCells(b,at.mRange),ht,pt=r._dataContainer.sheets[b],rt=fi[0];rt<=fi[2];rt++)for(ht=fi[1];ht<=fi[3];ht++)r._isRowViewable(b,rt)&&r.getCell(rt,ht,b).text(""),t.isNullOrUndefined(pt[rt])&&(pt[rt]={}),t.isNullOrUndefined(pt[rt][ht])&&(pt[rt][ht]={}),iu?(pt[rt][ht].isMHide=!0,pt[rt][ht].mergeIdx={rowIndex:f[0],colIndex:f[1]}):(pt[rt][ht].merge=at,iu=!0);r.setActiveSheetIndex(b);r._unMergeAllCells(this._copyRange[0],0,r.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]}),[],0,0);r.setActiveSheetIndex(u)}r._paste=!0;r._dupDetails=!0;r.isUndefined(k.prevObj.merge)||r.unmergeCells(k.prevObj.merge.mRange);r.unmergeCells(lr);r._mergeCenter=at.isCenterAlign;r.isUndefined(fi)||fi!=="1"?r.mergeCells(lr,!0):r.mergeAcrossCells(lr,!0);r._dupDetails=!1;r.XLEdit.updateCellValue(currentCellIdx,ri);t.isNullOrUndefined(tt)||v.addClass(tt)}else{di=n.extend(!0,{},o);di.value=di.value2=ri;t.isNullOrUndefined(tt)||r.getCell(f[0],f[1],this._copyRange[0]).addClass(tt);r.XLEdit._updateDataContainer({rowIndex:f[0],colIndex:f[1]},{dataObj:di});r._showAlertDlg("Alert","MergeAlert","",250);return}}r.performSelection({rowIndex:k.rowIndex,colIndex:k.colIndex},{rowIndex:k.rowIndex+bi,colIndex:k.colIndex+ki})}if("hyperlink"in o&&(vi=o.hyperlink,vi&&!vi.webAddr?v.html(t.buildTag("a.e-hyperlinks",v.text(),"",{href:"#"})):v.html(t.buildTag("a.e-hyperlinks",v.text(),"",{href:vi.webAddr,target:"_blank"}))),"comment"in o&&(v.removeClass("e-commentcell"),r.XLComment.setComment([e,s,e,s],null,!1)),"cFormatRule"in o)for(tr=n.extend(!0,[],o.cFormatRule),o.cFormatRule=[],h=0,it=tr.length;h<it;h++)oi=r._dataContainer.cFormatData[tr[h]].split("_"),r.XLCFormat._cFormat(oi[0],oi[2],oi[3],oi[4],null,null,[e,s,e,s],"paste");if(r._isPaste=!0,"wrap"in o&&(r._dupDetails=!0,gt=r._generateHeaderText(u,s+1)+(e+1),r.setWrapText("wrap",gt+":"+gt),r._dupDetails=!1),"cellType"in o&&(gi=r._dataContainer.sheetCellType[o.cellType],gi.text="",r.model.allowCellType&&r.XLCellType._renderControls(e,s,u,gi,!this._cutCells.length)),r._isPaste=!0,"picture"in o)for(h=0,it=o.picture.length;h<it;h++)c=this._copyCells.length?this._copyCells[ft]:this._cutCells[ft],lt=this._copyBackup.actCellPos,vt=r.getRangeData([c.rowIndex,c.colIndex,c.rowIndex,c.colIndex],"","",this._copyRange[0])[0],(!r.isUndefined(vt.picture)&&vt.picture.indexOf(o.picture[h])>-1||!this._copyCells.length)&&(n.extend(!0,a,et.picture[o.picture[h]]),g=r.element.find("#"+a.id),a.rowIndex===c.rowIndex&&a.colIndex===c.colIndex&&(g=r.element.find("#"+a.id),tt=g[0].className,tt.indexOf("e-shapebdr")>-1?(tt=g[0].className.match(br)[0],ct=tt.replace("e-shapebdr","").split("N"),li=ct[2],r.XLShape._createPicture(u,r._getCellIdx(v[0]),et.sharedPics[a.data],parseInt(g.css("top"))-lt.top+ni[0].offsetTop,parseInt(g.css("left"))-lt.left+ni[0].offsetLeft,a.width,a.height,null,"#"+li,kr[parseInt(ct[1])-1],ct[0]+"px")):r.XLShape._createPicture(u,r._getCellIdx(v[0]),et.sharedPics[a.data],parseInt(g.css("top"))-lt.top+ni[0].offsetTop,parseInt(g.css("left"))-lt.left+ni[0].offsetLeft,a.width,a.height),this._copyRange[0]===u&&(l.sheets[u][p+y][w+nt].picture[h]=r.getObjectKeys(et.picture)[r.getObjectLength(et.picture)-1]),this._cutCells.length&&g.remove()));if("chart"in o)for(vt=r.getRangeData([e,s,e,s]),h=0,it=o.chart.length;h<it;h++)c=this._copyCells.length?this._copyCells[ft]:this._cutCells[ft],lt=this._copyBackup.actCellPos,vt=r.getRangeData([c.rowIndex,c.colIndex,c.rowIndex,c.colIndex])[0],(!r.isUndefined(vt.chart)&&vt.chart.indexOf(o.chart[h])>-1||!this._copyCells.length)&&(n.extend(!0,a,et.chart[o.chart[h]]),g=r.element.find("#"+a.id),a.rowIndex===c.rowIndex&&a.colIndex===c.colIndex&&(f=a.range,f=r._getAlphaRange(u,f[0],f[1],f[2],f[3]),f.indexOf(":")<0&&(f=f+":"+f),a.top=parseInt(g.css("top"))-lt.top+ni[0].offsetTop,a.left=parseInt(g.css("left"))-lt.left+ni[0].offsetLeft,r.XLChart.createChart(f,a),l.sheets[u][p+y][w+nt].chart[h]=r.getObjectKeys(et.chart)[r.getObjectLength(et.chart)-1],this._cutCells.length&&g.remove()));r._isPaste=!1}else r.XLEdit.updateCellValue(currentCellIdx,""),t.isNullOrUndefined(l.sheets[u][e])||delete l.sheets[u][e][s];else r.XLEdit.updateCellValue(currentCellIdx,c[nt]),c[nt].indexOf("=")>-1&&r.XLEdit.updateCellValue(currentCellIdx,v.html());ft++;k.newObj=t.isNullOrUndefined(l.sheets[u][p+y])?{}:n.extend(!0,{},l.sheets[u][p+y][w+nt]);t.isNullOrUndefined(k.newObj)&&(k.newObj={});er.push(k)}t.isNullOrUndefined(v)||r._setRowHdrHeight(u,r._getCellIdx(v[0]).rowIndex)}if(ut.length<1&&(y=1),this._cutCells.length&&(this._isCut=nu,this._cutCells=[]),this._isSpecial&&bt){for(ru=this._copyBackup.table,f=r.getRangeIndices(this._copyRange[1]),h=0,it=ru.length;h<it;h++)hi=this._copyBackup.table[h].range,ar=n.extend(!0,{},this._copyBackup.table[h].tblObj),this._copyBackup.copypaste&&(ar.name="Table"+r._tableCnt++),r._dupDetails=!0,r.XLFormat.createTable(ar,r._getAlphaRange(this._copyRange[0],hi[0]+p-f[0],hi[1]+w-f[1],p-f[0]+hi[2],w-f[1]+hi[3])),r._dupDetails=!1,wr.push(this.XLObj.model.sheets[u]._tableManager[this.XLObj.getObjectLength(this.XLObj.model.sheets[u]._tableManager)]);ti=[p,w,y+p-1,nt+w-1];this._cutCells.length&&this._copyBackup.filterRange.length>0&&this._copyRange[0]===u&&(ci=this._copyBackup.filterRange,r.XLFilter.clearFilter(),ir=r._generateHeaderText(u,ci[1]+w-f[1]+1)+(ci[0]+p-f[0]+1)+":"+r._generateHeaderText(u,w-f[1]+ci[3]+1)+(p-f[0]+ci[2]+1),r.XLFilter.filter(ir));d.pasteBorder.newBorder=r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(ti);r.setActiveSheetIndex(this._copyRange[0]);d.cutBorder.newBorder=r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(f);r.setActiveSheetIndex(u)}d.pfat={table:this._copyBackup.table,range:f,minRowIdx:p,minColIdx:w,ptable:wr};d.pfilter=ir;d.pasteCells=er;r.XLSelection.selectRange({rowIndex:p,colIndex:w},{rowIndex:y+p-1,colIndex:nt+w-1});r.getSheet(u)._startCell={rowIndex:p,colIndex:w};r.getSheet(u)._endCell={rowIndex:y+p-1,colIndex:nt+w-1};r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement();d.sheetIndex=u;r.setSheetFocus();r.model.showRibbon&&r.XLRibbon._updateRibbonIcons();r._isUndoRedo||r._completeAction(d)}r._isPaste=!1;r.XLScroll._getRowHeights(u,p)}else r._showAlertDlg("Alert","FullSheetCopyPasteAlert","",375)},_getUpdatedCellFormula:function(n,t,i){for(var f=this.XLObj,c=/([A-Z].*?[0-9])/g,l=i.rowIdx-t.rowIndex,a=i.colIdx-t.colIndex,r=f.XLDragFill._parseFormula(n),e,o,s,u=0,h=r.length;u<h;u++)r[u].match(c)&&(e=r[u].trim().match(/(\d+|\D+)/g),o=f._generateColCount(e[0])+a,s=parseInt(e[1])+l,r[u]=s>0&&o>0?f._generateHeaderText(f._getSheetIndex(),o)+s.toString():"#REF!");return r=r.join(""),"="+r},_compareRange:function(n,t){return n[0]<=t[0]&&n[1]<=t[1]&&n[2]>=t[2]&&n[3]>=t[3]}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.comments=function(n){this.XLObj=n;this._isCommentEdit=!1;this._isShowAllComments=!1;this._curCommentHCell=null};t.spreadsheetFeatures.comments.prototype={setComment:function(n,i,r,u){var b,v=!1,a,c,e,o,y,l,w,s,h,f=this.XLObj,p;f.model.allowComments&&(f.model.showRibbon&&(f._isPaste?!f.XLClipboard._cutCells.length:!0)&&f._commentCount++,s=f.getActiveSheetIndex(),h=f.getSheet(s),n?(rng=f._toIntrnlRange(n),e=rng[0],o=rng[1],c={rowIndex:e,colIndex:o}):(c=f.getActiveCell(s),e=c.rowIndex,o=c.colIndex),f.XLScroll._scrollSelectedPosition(s,c),e in h._commentColl||(h._commentColl[e]={}),h._commentColl[e][o]={isComment:!0},r=t.isNullOrUndefined(r)?!0:r,u=t.isNullOrUndefined(u)?!0:u,w=(f.model.userName.length>0?f.model.userName:f._getLocStr("UserName"))+":\n",b=f.XLEdit.getPropertyValue(e,o,"comment",s),t.isNullOrUndefined(i)||(u&&(i=w+i),f.XLEdit._updateDataContainer(c,{dataObj:{comment:{value:i,isVisible:t.isNullOrUndefined(f.XLEdit.getPropertyValue(e,o,"comment",s))?r:f.XLEdit.getPropertyValue(e,o,"comment",s).isVisible}}})),y=t.isNullOrUndefined(f.XLEdit.getPropertyValue(e,o,"comment",s))?(f.model.userName.length>0?f.model.userName:f._getLocStr("UserName"))+":\n":f.XLEdit.getPropertyValue(e,o,"comment",s).value,!f.model.allowComments||f.XLEdit._isEdit||f._isSheetRename||(f._isRowViewable(s,e)&&(a=f.getCell(e,o),a.prepend(t.buildTag("span.e-comment",t.buildTag("span.e-celltoparrow")).append(t.buildTag("textarea.e-comment-txtarea",y,{"z-index":10}))).addClass("e-commentcell"),this._updateCmntArrowPos(a),l=a.find(".e-comment-txtarea"),this._updateCmtAreaPos(a,l),l.focus().setInputPos(l.val().length),v=!0),(!h._isImported||h._isLoaded)&&(p=f.XLEdit.getPropertyValue(e,o,"comment",s),t.isNullOrUndefined(p)||(p.value=y)),r&&v?(l.focus(),!this._curCommentHCell||t.isNullOrUndefined(f.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment"))||f.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment").isVisible||(this._curCommentHCell.find(".e-comment-txtarea").hide(),this._curCommentHCell=null),f.XLDragDrop._isDragAndDropped||this._updateCurrentCell(e,o),this._isCommentEdit=!0,f.model.showRibbon&&f.XLRibbon._disableRibbonIcons()):v&&(this._isShowAllComments||f.XLEdit.getPropertyValue(e,o,"comment",s).isVisible||l.hide(),(!h._isImported||h._isLoaded)&&!f.XLDragDrop._isDragAndDropped&&f.model.showRibbon&&this._updateCmntRibIcons(f.XLClipboard._isSpecial?f.getActiveCell():{rowIndex:e,colIndex:o}))))},_updateCmtAreaPos:function(n,t){var r=this.XLObj,u=r.getActiveSheetIndex(),s=r._getContent(u).find("#hscrollBar").offset(),f=r._getContent(u).find("#vscrollBar").offset(),h=r._getJSSheetHeader(u).offset(),i=t.offset(),e=t.height(),o=t.width();r.model.scrollSettings.allowScrolling&&(i.top+e+5>s.top&&i.left+o<f.left?t.css({top:-77}):i.left+o>f.left&&i.top+e+5>s.top?t.css({left:-136,top:-81}):i.top+e>h.top&&i.left+o>f.left&&t.css({left:-137,top:n.height()+8}))},deleteComment:function(i,r,u,f){var e=this.XLObj,o;if(e.model.allowComments){var a,v=[],l=[],h=r||e.getActiveSheetIndex(),s,c={sheetIndex:h,reqType:"comment",action:"delete"};for(typeof i=="string"&&(i=e.getRangeIndices(i)),s=t.isNullOrUndefined(i)?e.getSheet(h)._selectedCells:e.XLSelection._getSelectedRange({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]}),o=0;o<s.length;o++)e.XLEdit.getPropertyValue(s[o].rowIndex,s[o].colIndex,"comment")&&v.push(s[o]);if(e.model.allowComments){for(o=0;o<s.length;o++)if(rowIdx=s[o].rowIndex,colIdx=s[o].colIndex,cmnt=e.XLEdit.getPropertyValue(rowIdx,colIdx,"comment"),!t.isNullOrUndefined(cmnt)){if(a=n(s[o]),u&&e._isHiddenRow(rowIdx)){s.splice(o,1);continue}e.model.showRibbon&&e._commentCount&&e._commentCount--;l.push({rowIndex:rowIdx,colIndex:colIdx,prevComment:cmnt,currComment:{}});e._isRowViewable(h,rowIdx)&&e.getCell(rowIdx,colIdx,h).removeClass("e-commentcell").find(".e-comment").remove();e.getSheet(h)._commentColl[rowIdx]&&delete e.getSheet(h)._commentColl[rowIdx][colIdx];delete e._dataContainer.sheets[h][rowIdx][colIdx].comment}c.selCells=l;e.model.showRibbon&&!e.XLDragDrop._isDragAndDropped&&e.XLComment._updateCmntRibIcons();c.reqType=t.isNullOrUndefined(f)?"comment":"clear-comment";e._isUndoRedo||e._dupDetails||e._completeAction(c)}}},editComment:function(n){var i=this.XLObj,r,u;i.model.allowComments&&(r=i.getActiveSheetIndex(),t.isNullOrUndefined(n)&&(n=i.getActiveCell()),i.XLEdit._isEdit||i._isSheetRename||(i.model.allowComments&&(t.isNullOrUndefined(i.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"comment"))||(i.XLScroll._scrollSelectedPosition(r,n),i._isRowViewable(r,n.rowIndex)&&(u=i.getCell(n.rowIndex,n.colIndex).find(".e-comment-txtarea"),u.css("display","inline-table").focus().setInputPos(u.text().length)),this._isCommentEdit=!0)),i.model.showRibbon&&i.XLRibbon._disableRibbonIcons()))},showHideComment:function(n){var i=this.XLObj,s=i.getActiveSheetIndex(),r,u,e,o=!1,f=!1;i.model.allowComments&&(r=t.isNullOrUndefined(n)?i.getActiveCell():i._getCellIdx(n[0]),u=i.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"comment"),t.isNullOrUndefined(u)||(i._isRowViewable(s,r.rowIndex)&&(e=i.getCell(r.rowIndex,r.colIndex).find(".e-comment-txtarea"),o=!0),u.isVisible?(o&&e.hide(),f=!1):(o&&e.css("display","inline-table"),this._curCommentHCell=null,f=!0)),i.isUndefined(f)||(u.isVisible=f))},showAllComments:function(){var t=this.XLObj,r;if(t.model.allowComments){for(var s=t.getActiveSheetIndex(),u,f,e,h=n("#"+t._id+"_Ribbon_showAllComments").data("ejToggleButton"),o=["previousComment","nextComment"],c=this._isShowAllComments?!1:!0,i=1;i<=t.model.sheetCount;i++)for(u=t.getSheet(i)._commentColl,rowKeys=t.getObjectKeys(u),j=0;j<rowKeys.length;j++){for(colKeys=t.getObjectKeys(u[rowKeys[j]]),r=0;r<colKeys.length;r++)t._isRowViewable(s,parseInt(rowKeys[j]))&&(f=t.getCell(parseInt(rowKeys[j]),parseInt(colKeys[r])).find(".e-comment-txtarea"),this._isShowAllComments?f.hide():f.css("display","inline-table")),t.XLEdit.getPropertyValue(rowKeys[j],colKeys[r],"comment",i).isVisible=!this._isShowAllComments;j==0&&(e=!0)}this._isShowAllComments=!this._isShowAllComments;t.model.showRibbon&&h.model.toggleState?t.XLRibbon._disableButtons(o,"ejButton"):t.model.showRibbon&&e&&t.XLRibbon._enableButtons(o,"ejButton")}},findPrevComment:function(){var i=this.XLObj,s,r,y,c,l,a,u,f,o,e,v,h;if(!i.model.allowComments)return!1;for(s=i.getActiveSheetIndex(),v=n("#"+i._id+"_Ribbon_newComment"),u=s;u>0;u--)if(r=i.getSheet(u),i.getObjectLength(r._commentColl))for(u!==s&&i.gotoPage(u,!1),i.model.showRibbon&&n("#"+i._id+"_Ribbon").ejRibbon("option","selectedItemIndex",5),y=r.rowCount-1,c=r.colCount-1,u!==s&&this._updateCurrentCell(y-1,c-1),l=r._activeCell.rowIndex,a=r._activeCell.colIndex,f=l;f>=0;f--)for(f!==l&&(a=c-1),o=a;o>=0;o--)if(i._isRowViewable(s,f)){if(e=n(i.getCell(f,o)),h=n(e.find(".e-comment-txtarea")),r._activeCell.rowIndex!==f&&r._activeCell.colIndex!==o&&!t.isNullOrUndefined(i.XLEdit.getPropertyValueByElem(e,"comment"))&&i.XLEdit.getPropertyValueByElem(e,"comment").isVisible&&h.hide(),e.hasClass("e-commentcell")&&!h.is(":visible"))return h.css("display","inline-table").focus()&&this._updateCurrentCell(f,o),i.model.showRibbon&&(i.XLRibbon._enableButtons(["deleteComment","showHideComment"],"ejButton"),v.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt"),v.find(".e-btntxt").text(i._getLocStr("EditComment"))),i.setSheetFocus(),!0;this._isShowAllComments||this._isCommentEdit||!e.hasClass("e-commentcell")||i.XLEdit.getPropertyValueByElem(e,"comment").isVisible||h.hide()}u===0&&i._showAlertDlg("","CommentFindEndAlert","findPrevComment",630)},findNextComment:function(){var i=this.XLObj,o,e,c,l,v,y,r,f,s,u,h,a;if(!i.model.allowComments)return!1;for(o=i.getActiveSheetIndex(),a=n("#"+i._id+"_Ribbon_newComment"),r=o;r<=i.model.sheetCount;r++)if(e=i.getSheet(r),i.getObjectLength(e._commentColl))for(r!==o&&i.gotoPage(r,!1),i.model.showRibbon&&n("#"+i._id+"_Ribbon").ejRibbon("option","selectedItemIndex",5),r!==o&&this._updateCurrentCell(0,0),c=e._activeCell.rowIndex,l=e._activeCell.colIndex,v=e.rowCount-1,y=e.colCount-1,f=c;f<v;f++)for(f!==c&&(l=0),s=l;s<y;s++){if(i._isRowViewable(o,f)&&(u=n(i.getCell(f,s)),h=n(u.find(".e-comment-txtarea")),i.getActiveCellElem()[0]!==u[0]&&!t.isNullOrUndefined(i.XLEdit.getPropertyValueByElem(u,"comment"))&&i.XLEdit.getPropertyValueByElem(u,"comment").isVisible&&h.hide(),u.hasClass("e-commentcell")&&!h.is(":visible")))return h.css("display","inline-table").focus(),this._updateCurrentCell(f,s),i.model.showRibbon&&(i.XLRibbon._enableButtons(["deleteComment","showHideComment"],"ejButton"),a.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt"),a.find(".e-btntxt").text(i._getLocStr("EditComment"))),i.setSheetFocus(),!0;this._isShowAllComments||this._isCommentEdit||!u.hasClass("e-commentcell")||i.XLEdit.getPropertyValueByElem(u,"comment").isVisible||h.hide()}r===i.model.sheetCount+1&&i._showAlertDlg("","CommentFindEndAlert","findNextComment",630)},_commentMouseMove:function(i){var e=this.XLObj,r,f,u;(r=i.target.tagName==="TD"?n(i.target):n(i.target).parent("td"),r.length)&&(f=r.find(".e-comment-txtarea"),this._isCommentEdit||(t.isNullOrUndefined(this._curCommentHCell)||r!==this._curCommentHCell&&(u=e.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment"),t.isNullOrUndefined(u)||u.isVisible||(this._curCommentHCell.find(".e-comment-txtarea").hide(),this._curCommentHCell=null)),r[0].tagName==="TD"&&r.hasClass("e-commentcell")&&(f.css("display","inline-table"),this._curCommentHCell=r)))},_commentMouseDownHandler:function(t){var i=this.XLObj,r=i.getActiveCell(),o=i.getActiveSheetIndex(),u,f,e;i._isRowViewable(o,r.rowIndex)&&(u=i.getCell(r.rowIndex,r.colIndex,o),e=n(u.find(".e-comment-txtarea")),u.hasClass("e-commentcell")&&e.get()[0]!==t.target&&(f=i.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"comment"),this._isCommentEdit&&this._updateCurCmntVal(r),this._isShowAllComments||i.isUndefined(f)||f.isVisible||e.hide()));n(t.target).hasClass("e-comment-txtarea")&&(n(t.target).focus().css("z-index",10)&&(this._isCommentEdit=!0),this._updateCurrentCell(n(t.target).parents("td").parent().index(),n(t.target).parents("td").index()),i.model.showRibbon&&i.XLRibbon._disableRibbonIcons())},_updateCmntRibIcons:function(t){var f,i=this.XLObj,e=["showHideComment","deleteComment"],u=i.getActiveSheetIndex(),l=i.getSheetElement(u),r=n("#"+i._id+"_Ribbon_newComment"),h=i.getActiveCell(),o=i.getSheet(u),c=o._selectedCells,s=o.selectedRange;t=i.model.allowDragAndDrop&&!i.XLDragDrop._isDragAndDropped?t?t:h:{rowIndex:i._dStartCell.rowIndex,colIndex:i._dStartCell.colIndex};i.XLRibbon._enableButtons(["newComment"],"ejButton");i.XLRibbon._enableButtons(i.XLRibbon._cmntTglBtnIds,"ejToggleButton");f=i.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"comment",u);f?(i.XLRibbon._enableButtons(e,"ejButton"),r.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt"),r.find(".e-btntxt").text(i._getLocStr("EditComment"))):(r.find(".e-icon").removeClass("e-ssr-editcmnt").addClass("e-ssr-newcmnt"),r.find(".e-btntxt").text(i._getLocStr("NewComment")),i.XLRibbon._disableButtons(e,"ejButton"));this._isShowAllComments||i._commentCount===0?i.XLRibbon._disableButtons(["previousComment","nextComment"],"ejButton"):i.XLRibbon._enableButtons(["previousComment","nextComment"],"ejButton");c.length&&i.inRange(s,t.rowIndex,t.colIndex)&&i.XLEdit._rangeHasProperty(s,"comment")&&i.XLRibbon._enableButtons(["deleteComment"],"ejButton")},_updateCurCmntVal:function(n,i){i=t.isNullOrUndefined(i)?"":i;var r=this.XLObj,h=t.isNullOrUndefined(n)?r.getActiveCell():n,o,c=[],l="User Name:",s=!1,e={sheetIndex:r.getActiveSheetIndex(),reqType:"comment"},u=h.rowIndex,f=h.colIndex;r._isRowViewable(e.sheetIndex,u)&&(o=r.getCell(u,f,r.getActiveSheetIndex()).find(".e-comment-txtarea"),s=!0);c.push({rowIndex:u,colIndex:f});e.action=t.isNullOrUndefined(r.XLEdit.getPropertyValue(u,f,"comment"))?"add":"edit";e.selCells=c;e.selCells[0].prevComment=r.XLEdit.getPropertyValue(u,f,"comment");s&&(l=o.css("z-index",9).val());r.XLEdit._updateDataContainer({rowIndex:u,colIndex:f},{dataObj:{comment:{value:l,isVisible:r.isUndefined(r.XLEdit.getPropertyValue(u,f,"comment"))?this._isShowAllComments:r.XLEdit.getPropertyValue(u,f,"comment").isVisible}}});!s||this._isShowAllComments||r.XLEdit.getPropertyValue(u,f,"comment").isVisible||o.hide();r.setSheetFocus();this._isCommentEdit=!1;r.XLCellNav._isNavigate=!0;r.model.showRibbon&&r.XLRibbon._enableRibbonIcons();r.XLEdit._updateUsedRange(u,f);e.selCells[0].curComment=r.XLEdit.getPropertyValue(u,f,"comment");r._isUndoRedo||r._hasComment||i==="paste"||r._completeAction(e)},_updateCurrentCell:function(n,t,i){var r=this.XLObj,u={rowIndex:n,colIndex:t},f;i=i?i:r.model.activeSheetIndex;f=r.getSheet(i);f._activeCell=u;r.XLSelection.selectRange(u,u,i);f._startCell=f._endCell=u;r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement()},_visibleCmntCnt:function(n,t){n.find(".e-comment")[t?"show":"hide"]()},_updateCmntArrowPos:function(t,i){var e=this.XLObj,o=t?t:e.getSheetElement(e._getSheetIndex(i)).find(".e-commentcell"),f,r,s,u;if(e.model.allowComments)for(f=0,s=o.length;f<s;f++)if(r=n(o[f]),u=r.find(".e-comment"),u.length){if(r.width()<5){u.hide();continue}u.is(":hidden")&&u.show();u.css({top:r.get()[0].offsetTop+"px",left:r.get()[0].offsetLeft+r.get()[0].offsetWidth-5+"px"})}},_updateCmntFrmCntnr:function(n,t){var i=this.XLObj;i.XLEdit.getPropertyValue(n,t,"comment")&&(i._isRowViewable(null,t)&&i.getCell(n,t).hasClass("e-commentcell")&&this.deleteComment([n,t,n,t]),this.setComment([n,t,n,t],null,!1))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.contextmenu=function(n){this.XLObj=n;this._clrFltrEnable=!1;this._isMenuOpened=!1;this._uniqueClass=this.XLObj._id+"-cmenu";this._rowCellMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,sprite:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert")+"...",parentId:null},{id:"Delete",text:n._getLocStr("Delete")+"...",parentId:null},{id:"Filter",text:n._getLocStr("Filter"),parentId:null,sprite:"e-icon e-ss-filter"},{id:"Sort",text:n._getLocStr("Sort"),parentId:null,sprite:"e-icon e-ss-sortatoz"},{id:"SortAtoZ",parentId:"Sort",text:n._getLocStr("SortAtoZ"),sprite:"e-icon e-ss-sortatoz"},{id:"SortZtoA",parentId:"Sort",text:n._getLocStr("SortZtoA"),sprite:"e-icon e-ss-sortztoa"},{id:"ctxComment",parentId:null,text:n._getLocStr("Comment")},{id:"ctxInsrtCmnt",text:n._getLocStr("InsertComment"),parentId:"ctxComment",sprite:"e-icon e-ss-newcmnt"},{id:"ctxEditCmnt",text:n._getLocStr("EditComment"),parentId:"ctxComment",sprite:"e-icon e-ss-editcmnt"},{id:"ctxDeleteCmnt",text:n._getLocStr("DeleteComment"),parentId:"ctxComment",sprite:"e-icon e-ss-deletecmnt"},{id:"ctxShwHdCmnt",text:n._getLocStr("ShowHide"),parentId:"ctxComment",sprite:"e-icon"},{id:"FormatCells",text:n._getLocStr("FormatCells")+"...",parentId:null,sprite:"e-icon e-ss-formatcells"},{id:"PutCellColor",parentId:"Sort",text:n._getLocStr("PutCellColor"),sprite:""},{id:"PutFontColor",parentId:"Sort",text:n._getLocStr("PutFontColor"),sprite:""},{id:"CmHyperLink",text:n._getLocStr("HyperLink"),parentId:null,sprite:"e-icon e-ss-hyperlink"},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"ClearFilter",parentId:"Filter",text:n._getLocStr("ClearFilter"),sprite:"e-icon e-ss-filternone"},{id:"FilterSelected",parentId:"Filter",text:n._getLocStr("FilterSelected"),sprite:"e-icon e-ss-filter"},{id:"HyperLink",text:n._getLocStr("HyperLink")+"...",parentId:"CmHyperLink",sprite:"e-icon e-ss-hyperlink"},{id:"EditLink",text:n._getLocStr("EditLink")+"...",parentId:"CmHyperLink"},{id:"OpenLink",text:n._getLocStr("OpenLink"),parentId:"CmHyperLink"},{id:"RemoveLink",text:n._getLocStr("RemoveLink"),parentId:"CmHyperLink",sprite:"e-icon e-ss-removelink"}];this._columnHeaderMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,sprite:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert"),parentId:null},{id:"Delete",text:n._getLocStr("Delete"),parentId:null},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Hide",text:n._getLocStr("Hide"),parentId:null},{id:"Unhide",text:n._getLocStr("Unhide"),parentId:null},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"}];this._rowHeaderMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,sprite:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert"),parentId:null},{id:"Delete",text:n._getLocStr("Delete"),parentId:null},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Hide",text:n._getLocStr("Hide"),parentId:null},{id:"Unhide",text:n._getLocStr("Unhide"),parentId:null},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"}];this._footerMenuData=[{id:"InsertSheet",text:n._getLocStr("InsertSheet"),parentId:null},{id:"DeleteSheet",text:n._getLocStr("DeleteSheet"),parentId:null,sprite:"e-icon e-ss-delete"},{id:"RenameSheet",text:n._getLocStr("RenameSheet"),parentId:null,sprite:"e-icon "},{id:"MoveorCopy",text:n._getLocStr("MoveorCopy")+"...",parentId:null,sprite:"e-icon "},{id:"HideSheet",text:n._getLocStr("HideSheet"),parentId:null,sprite:"e-icon "},{id:"UnhideSheet",text:n._getLocStr("UnhideSheet"),parentId:null,sprite:"e-icon "},{id:"ProtectSheet",text:n._getLocStr("Protectsheet"),parentId:null,sprite:"e-icon e-ss-cmenuprotect"}];this._chartMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"ChartType",text:n._getLocStr("ChangeChartType")+"...",parentId:null},{id:"SelectData",text:n._getLocStr("SelectData")+"...",parentId:null}];this._imgMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"ChangePicture",text:n._getLocStr("ChangePicture"),parentId:null}];this._protectRowMenuIds=["Insert","Delete","Filter","ctxComment","Sort","LockCells","CmHyperLink"];this._prtctHeaderIds=["Insert","Delete","Hide","Unhide"];this._footerIds=["InsertSheet","DeleteSheet","RenameSheet","MoveorCopy","HideSheet","UnhideSheet"]};t.spreadsheetFeatures.contextmenu.prototype={_initContextMenu:function(){var n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none"},{id:this.XLObj._id+"_contextMenuCell"});this._createMenu(n,this._rowCellMenuData,".e-spreadsheetcontentcontainer");n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none"},{id:this.XLObj._id+"_contextMenuColumnHeader"});this._createMenu(n,this._columnHeaderMenuData,".e-columnheader");n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none"},{id:this.XLObj._id+"_contextMenuRowHeader"});this._createMenu(n,this._rowHeaderMenuData,".e-rowheadercontent")},_initCMenuFooter:function(){var n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none"},{id:this.XLObj._id+"_contextMenuFooter"});this._createMenu(n,this._footerMenuData,".e-pagercontainer")},_createMenu:function(i,r,u){i.ejMenu({fields:{dataSource:r,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},menuType:t.MenuType.ContextMenu,openOnClick:!1,beforeOpen:n.proxy(this._beforeOpen,this),close:n.proxy(this._menuClose,this),click:n.proxy(this._menuClick,this),contextMenuTarget:u})},hideCMenu:function(){var t=this.XLObj;t.model.enableContextMenu&&(n("#"+t._id+"_contextMenuCell").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuColumnHeader").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuRowHeader").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuFooter").data("ejMenu").element.hide())},_beforeOpen:function(i){var r=this.XLObj,g,nt,w,st,rt,b,p,ht,k,ut,d,c;this._clrFltrEnable=!1;(!r.model.enableContextMenu||i.events.type=="mousedown"&&i.target.id.indexOf("_picture")>-1)&&(i.cancel=!0);this.hideCMenu();var v=i.target,ft,ct={target:v},u=n(v),h=r.getActiveSheetIndex(),y=r.getSheet(h),lt=!t.isNullOrUndefined(r.getActiveCellElem())&&r.getActiveCellElem().length>0?r.getActiveCellElem():u,e=this._rowCellMenuData,o=n("#"+r._id+"_contextMenuCell").data("ejMenu"),f=n("#"+r._id+"_contextMenuFooter").data("ejMenu"),a=r.getActiveCell(h),et,l,s;if(!r._trigger("beforeOpen",ct))if((r.XLEdit._isEdit||r.model.allowComments&&r.XLComment._isCommentEdit||u.hasClass("e-filterspan")||i.events.which===1&&u.hasClass("e-hyperlinks")||u.parents("div").hasClass("e-vscroll")||u.parents("div").hasClass("e-hscroll")||n(v.parentNode).hasClass("e-pagercontainer")&&!u.hasClass("e-link")||!t.isNullOrUndefined(r.XLResize)&&r.XLResize._resizeStart||i.target.id.indexOf("Sheet_RenamePanel")>-1||u.parents().hasClass("e-grid")||u.hasClass("e-autofill"))&&(i.cancel=!0),u.hasClass("e-rowcell")||u.hasClass("e-hyperlinks")){var tt=[],ot=r._getJSSheetHeader(h).find("th"),at=r._getJSSheetRowHeader(h).find("td"),vt=n("#"+r._id+"_contextMenuColumnHeader").data("ejMenu"),yt=n("#"+r._id+"_contextMenuRowHeader").data("ejMenu"),it=r.XLEdit.getPropertyValueByElem(r.getCell(y._activeCell.rowIndex,y._activeCell.colIndex));if(this._isMenuOpened=!0,r.model.allowLockCell&&y._isSheetProtected)this._disableMenuOpt(this._protectRowMenuIds);else{if(u.hasClass("e-hyperlinks")&&(u=u.parents("td"),v=u[0]),t.isNullOrUndefined(r.XLEdit.getPropertyValueByElem(u,"range")))if(n(ot[u.index()]).hasClass("e-colselected")||n(at[u.parent().index()]).hasClass("e-rowselected"))e=n(ot[u.index()]).hasClass("e-colselected")?this._columnHeaderMenuData:this._rowHeaderMenuData,JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&o.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"});else{if(JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&o.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"}),r.model.allowHyperlink?(this._enableMenuOpt(["CmHyperLink"]),st=r.XLEdit.getPropertyValue(u.parent().index(),v.cellIndex,"hyperlink",h),rt=["EditLink","OpenLink","RemoveLink"],t.isNullOrUndefined(st)?(this._disableMenuOpt(rt),this._enableMenuOpt(["HyperLink"])):(this._enableMenuOpt(rt),this._disableMenuOpt(["HyperLink"]))):this._disableMenuOpt(["CmHyperLink"]),r.model.allowFiltering){if(o.enableItemByID("Filter"),s=r.model.sheets[h].filterSettings.tableRange,b=r.getCell(a.rowIndex,a.colIndex,h)[0],s.length>0){for(et=b.className.indexOf("e-table")>-1?b.className[b.className.indexOf("e-table")+7]:-1,p=0,ht=s.length;p<ht;p++)if(s[p].tableID===parseInt(et)){l=p;break}!t.isNullOrUndefined(l)&&a.rowIndex<s[l].selectedRange.endRow+1&&a.rowIndex>s[l].selectedRange.startRow-2&&a.colIndex<s[l].multifilterIdx[s[l].multifilterIdx.length-1]+1&&a.colIndex>s[l].multifilterIdx[0]-1&&(g=r.getCell(s[l].selectedRange.startRow-1,a.colIndex,h).find("span"),g.length&&g[0].className.indexOf("e-ssfiltered")>-1&&(o.enableItemByID("ClearFilter"),this._clrFltrEnable=!0))}this._clrFltrEnable||o.disableItemByID("ClearFilter")}else o.disableItemByID("Filter");r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem?this._enableMenuOpt(["Paste"]):this._disableMenuOpt(["Paste"]);r.model.allowSorting?this._enableMenuOpt(["Sort"]):this._disableMenuOpt(["Sort"]);tt=!t.isNullOrUndefined(it)&&n.isNumeric(it)?[r._getLocStr("SortSmallesttoLargest"),r._getLocStr("SortLargesttoSmallest")]:t.isNullOrUndefined(t.parseDate(it))?[r._getLocStr("SortAtoZ"),r._getLocStr("SortZtoA")]:[r._getLocStr("SortOldesttoNewest"),r._getLocStr("SortNewesttoOldest")];r.model.allowComments?(o.element.find("#ctxComment").hasClass("e-disable-item")&&this._enableMenuOpt(["ctxComment"]),k=r.getSheetElement(r.getActiveSheetIndex()).find(".e-selected"),ut=k.length>1?lt:u,ut.hasClass("e-commentcell")?(this._disableMenuOpt(["ctxInsrtCmnt"]),e["13"].text=r.XLEdit.getPropertyValueByElem(ut,"comment").isVisible?r._getLocStr("HideComment"):r._getLocStr("ShowHide"),this._enableMenuOpt(["ctxEditCmnt","ctxDeleteCmnt","ctxShwHdCmnt"])):(this._enableMenuOpt(["ctxInsrtCmnt"]),this._disableMenuOpt(["ctxEditCmnt","ctxDeleteCmnt","ctxShwHdCmnt"])),k.filter(v).length>0&&k.filter(".e-commentcell").length>0&&this._enableMenuOpt(["ctxDeleteCmnt"])):this._disableMenuOpt(["ctxComment"]);e["7"].text=tt[0];e["8"].text=tt[1];JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&o.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"})}else w=r.model.sheets[h].rangeSettings[r.XLEdit.getPropertyValueByElem(u,"range")],o.option("fields",{dataSource:w.contextMenuSettings.dataSource,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"}),o.option("width",w.contextMenuSettings.width),o.option("height",w.contextMenuSettings.height);r.model.showRibbon&&r.XLRibbon._dirtySelect(r._getContent(r.getActiveSheetIndex()).find(".e-selected"))}r.model.allowInsert?f.enableItemByID("InsertSheet"):f.disableItemByID("InsertSheet");r.model.allowDelete?f.enableItemByID("DeleteSheet"):f.disableItemByID("DeleteSheet");r.model.allowClipboard?this._enableMenuOpt(["Cut","Copy"]):this._disableMenuOpt(["Cut","Copy"]);r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem?this._enableMenuOpt(["Paste"],c):this._disableMenuOpt(["Paste"],c)}else if(u.hasClass("e-ss-imgvisual")||u.hasClass("e-ss-object")||u.closest("div").hasClass("e-ss-object"))d=n.extend(!0,[],this._chartMenuData),this._isMenuOpened=!0,d=this.XLObj.model.showRibbon?this._chartMenuData:d.splice(0,2),e=r.XLShape._shapeType==="chart"?d:this._imgMenuData,JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&o.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"});else if(u.hasClass("e-link")){if(nt=f.model.fields.dataSource.slice(0),r._isSheetRename&&!r._updateSheetNames()){i.cancel=!0;return}ft=r.model.allowLockCell&&y._isSheetProtected?r._getLocStr("Unprotect"):r._getLocStr("Protectsheet");nt[6].text=ft;f.option("fields",{id:"id",dataSource:nt,parentId:"parentId"});this._isMenuOpened=!0;r._isCommentEdit&&r.XLComment._updateCurCmntVal();u.not("a.e-currentitem, a.e-PP, a.e-NP").hasClass("e-numericitem")&&r.gotoPage(u.data("index"));r.model.exportSettings.password?this._disableMenuOpt(this._footerIds,"contextMenuFooter"):(r._getSheetNames(!1).length>0?f.enableItemByID("UnhideSheet"):f.disableItemByID("UnhideSheet"),r._getSheetNames(!0).length>1?(f.enableItemByID("DeleteSheet"),f.enableItemByID("HideSheet"),f.enableItemByID("MoveorCopy")):(f.disableItemByID("DeleteSheet"),f.disableItemByID("HideSheet"),f.disableItemByID("MoveorCopy")));r.model.allowLockCell?f.enableItemByID("ProtectSheet"):f.disableItemByID("ProtectSheet")}else(u.hasClass("e-headercelldiv")||u.hasClass("e-headercell")||u.hasClass("e-rowheader"))&&(c=u.hasClass("e-rowheader")?"contextMenuRowHeader":"contextMenuColumnHeader",r.model.allowLockCell&&y._isSheetProtected?this._disableMenuOpt(this._prtctHeaderIds,c):this._enableMenuOpt(this._prtctHeaderIds,c),r.model.allowClipboard?this._enableMenuOpt(["Cut","Copy"],c):this._disableMenuOpt(["Cut","Copy"],c),r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem?this._enableMenuOpt(["Paste"],c):this._disableMenuOpt(["Paste"],c),r.model.showRibbon&&r.XLRibbon._dirtySelect(r._getContent(r.getActiveSheetIndex()).find(".e-selected")))},_menuClick:function(n){this.XLObj._trigger("contextMenuClick",n)||this._processCMenu(n.ID,n.events.element)},_menuClose:function(){this._isMenuOpened=!1},_processCMenu:function(i,r){var w,f,u=this.XLObj,e=u.getActiveSheetIndex(),s=u.getSheet(e),a,v,h,c,o=s._selectedCells,y,p,l;switch(i){case"Cut":u.XLClipboard.cut();break;case"Copy":u.XLClipboard.copy();break;case"PasteSpecial":case"PasteValues":u.XLClipboard._isSpecial=!(i==="PasteValues");u.XLClipboard.paste();break;case"Insert":u._insDelStatus="insert";s._isColSelected?(h=u._getJSSheetHeader(e).find(".e-colhighlight"),u.insertEntireColumn(h[0].cellIndex,h[h.length-1].cellIndex)):s._isRowSelected?(c=u._getJSSheetRowHeader(e).find(".e-rowhighlight"),u.insertEntireRow(n(c[0]).parent().index(),n(c[c.length-1]).parent().index())):u._renderInsertDialog();break;case"Delete":h=n(u._getJSSheetHeader(e).find("tr")[0]).find(".e-colselected");c=n(u.getRows(e)[0]).find(".e-rowselected");r.parentElement.id.indexOf("ColumnHeader")>-1||s._isColSelected?(h=u._getJSSheetHeader(e).find(".e-colhighlight"),u.deleteEntireColumn(h[0].cellIndex,h[h.length-1].cellIndex,[])):r.parentElement.id.indexOf("RowHeader")>-1||s._isRowSelected?(c=u._getJSSheetRowHeader(e).find(".e-rowhighlight"),u.deleteEntireRow(n(c[0]).parent().index(),n(c[c.length-1]).parent().index(),[])):u._renderDeleteDialog();break;case"FilterSelected":u.XLFilter.filterByActiveCell();this._clrFltrEnable=!1;break;case"ClearFilter":a=u.getActiveCell(e);y=u.XLEdit.getPropertyValue(a.rowIndex,a.colIndex,"tableName");p=t.isNullOrUndefined(y)?-1:parseInt(y.replace("table",""));p>-1?(v=u.model.sheets[e].columns[a.colIndex].field,u.XLFilter._clearFilterColumn(v,"","","","","",p),delete u._excelFilter._predicates[e][v]):u.XLFilter.clearFilter("apply");this._clrFltrEnable=!1;break;case"SortAtoZ":case"SortZtoA":case"SortSmallesttoLargest":case"SortLargesttoSmallest":case"SortOldesttoNewest":case"SortNewesttoOldest":case"PutCellColor":case"PutFontColor":u.model.allowSorting&&u.XLSort._sortHandler(i);break;case"ClearContents":l=u.model.sheets[e].selectedRange;u.clearContents(u._getAlphaRange(e,l[0],l[1],l[2],l[3]));break;case"InsertSheet":u.insertSheet();break;case"DeleteSheet":u.deleteSheet(e);break;case"RenameSheet":u._renameSheet();break;case"MoveorCopy":u._renderMoveCopyDlg();break;case"Hide":s._isColSelected&&u._hideColumn(o[0].colIndex,o[o.length-1].colIndex);s._isRowSelected&&u._hideRow(o[0].rowIndex,o[o.length-1].rowIndex,"isRHide");break;case"Unhide":s._isColSelected&&u._showColumn(o[0].colIndex,o[o.length-1].colIndex);s._isRowSelected&&u._showRow(o[0].rowIndex,o[o.length-1].rowIndex,"isRHide");break;case"HyperLink":case"EditLink":u._hlDlgOpen();break;case"RemoveLink":u._removeHyperlink();break;case"OpenLink":u._openLink();break;case"ctxInsrtCmnt":u.XLComment.setComment();break;case"ctxEditCmnt":u.XLComment.editComment();break;case"ctxDeleteCmnt":u.XLComment.deleteComment();break;case"ctxShwHdCmnt":u.XLComment.showHideComment();break;case"ChangePicture":u._uploadImage=!0;u.XLShape._changePicture=!0;u.element.find("#"+u._id+"_file .e-uploadinput").click();break;case"ChartType":n("#"+u._id+"_charttypedlg").ejDialog("open");break;case"SelectData":w=document.getElementById(u._id+"_chart").value;f=u.XLChart._getShapeObj(w,"chart");n("#"+u._id+"_crxaxis").val(f.xRange?u._getAlphaRange(e,f.xRange[0],f.xRange[1],f.xRange[2],f.xRange[3]):"");n("#"+u._id+"_cryaxis").val(f.yRange?u._getAlphaRange(e,f.yRange[0],f.yRange[1],f.yRange[2],f.yRange[3]):"");n("#"+u._id+"_crlaxis").val(f.lRange?u._getAlphaRange(e,f.lRange[0],f.lRange[1],f.lRange[2],f.lRange[3]):"");n("#"+u._id+"_chartrangedlg").ejDialog("open");break;case"HideSheet":u.hideSheet();break;case"UnhideSheet":u._renderUnhideDlg();break;case"ProtectSheet":u.protectSheet(!s._isSheetProtected);break;case"FormatCells":u.XLCellFrmtDlg._initFormatCellDlg()}},_disableMenuOpt:function(t,i){for(var u=i||"contextMenuCell",f=n("#"+this.XLObj._id+"_"+u).data("ejMenu"),r=0,e=t.length;r<e;r++)f.disableItemByID(t[r])},_enableMenuOpt:function(t,i){for(var u=i||"contextMenuCell",f=n("#"+this.XLObj._id+"_"+u).data("ejMenu"),r=0,e=t.length;r<e;r++)f.enableItemByID(t[r])}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.sorting=function(n){this.XLObj=n;this._isSortByFilter=!1};t.spreadsheetFeatures.sorting.prototype={_sortHandler:function(n){var e,v,y,p,w,b,k,c,s,l,d,f,a={},g="",u={},i=this.XLObj,nt=i._formatRegx,h=i.getActiveSheetIndex(),r=i.getSheet(h),o=r._selectedCells;if(o.length===1&&i.selectAll(),g=r.columns[r._activeCell.colIndex].field,this._isSortByFilter=!1,n!="PutCellColor"&&n!="PutFontColor"){if(!i.model.allowSorting||!r._selectedCells.length)return;if(b=n==="SortZtoA"?t.sortOrder.Descending:t.sortOrder.Ascending,k=i.XLEdit.getPropertyValue(r._activeCell.rowIndex,r._activeCell.colIndex,"tableName",h)||"",c=i._getTableID(k),t.isNullOrUndefined(c)){if(u=r.selectedRange.slice(0),s=u[0],l=u[1],s===u[2])return;for(p=i.XLEdit.getPropertyValue(s,l),e=s+1;e<=u[2];e++)if(!i._isHiddenRow(e)){w=i.XLEdit.getPropertyValue(e,l);break}v=i.isNumber(p)?t.Spreadsheet.CellType.Number:t.Spreadsheet.CellType.String;y=i.isNumber(w)?t.Spreadsheet.CellType.Number:t.Spreadsheet.CellType.String;v==y&&t.isNullOrUndefined(i.XLEdit.getPropertyValue(u[0],u[1],"isWrap"))||u[0]++}else u=r._tableManager[c].range.slice(0),u[0]++;this.sortByRange(u,g,b)}else d=i._getAlphaRange(h,r._startCell.rowIndex,r._startCell.colIndex,r._endCell.rowIndex,r._endCell.colIndex),f=i.XLEdit.getPropertyValue(r._startCell.rowIndex,r._startCell.colIndex,"formats"),i.isUndefined(f)||(f["background-color"]&&(a["background-color"]=f["background-color"].toLowerCase()),f.color&&(a.color=f.color.toLowerCase()),this.sortByColor(n,a,d));o.length===1&&(i.XLSelection.selectRange(o[0],o[0],h),r._startCell=r._endCell=o[0],i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement())},sortByColor:function(n,i,r){var f=this.XLObj;if(f.model.allowSorting){var o=f.getActiveSheetIndex(),u={oprType:n},e,s,c=f.getSheet(o),h;r=f.getRangeIndices(r);h=c.columns[r[1]].field;t.isNullOrUndefined(i)||(n==="PutCellColor"?(i["background-color"]&&(i=i["background-color"]),u.operation="sortbgcolor",u.bgcolor=i):(i.color&&(i=i.color),u.operation="sortfgcolor",u.fgcolor=i),u.requestType=u.action="sortbycolor",u.sortColumn=h,u.selRange={startCell:{rowIndex:r[0],colIndex:r[1]},endCell:{rowIndex:r[2],colIndex:r[3]}},u.rangeData=f.getRangeDataAsObject(u.selRange.startCell,u.selRange.endCell,!0)[0],e=r[0],t.isNullOrUndefined(e)||(s=f.XLFilter._createSelection(o,e,r[0]+1,r[1],[]).endRowIndex,e=n==="PutCellColor"||n==="PutFontColor"?e+1:e,u.range=f.model.sheets[o]._selectedRange={startRow:e,endRow:s,dataSourceIndexes:[]},f._processBindings(u)))}},_getSortColorRange:function(n){var r=this.XLObj,i=r.getCell(n.rowIndex,n.colIndex),u=!1,s,t,e=0,h=!1,f=n.rowIndex,o=n.colIndex;if(i.text().length<1){for(t=f;t<f+2;t++)if(i=r.getCell(t,o),i.is(":visible")&&i.text().length>0){u=!0;e=t;break}if(!u){for(t=f;t>f-2;t--)t>-1&&(i=r.getCell(t,o),i.text().length===0&&t>0&&(i=r.getCell(t-1,o),i.text().length==0&&(h=!0)));if(!h)for(t=f-2;t>0;t--)if(i=r.getCell(t,o),i.is(":visible")&&i.text().length===0){s=t+1;u=!0;e=s;break}}}else for(t=f;t>=0;t--){if(i=r.getCell(t,o),i.is(":visible")&&i.text().length===0){s=t+1;u=!0;e=s;break}u||t!=0||(e=t,u=!0)}if(u)return e;r._showAlertDlg("Alert","Alert",null,630)},sortByRange:function(n,i,r){var u=this.XLObj;if(u.model.allowSorting){var c,l=u.getActiveSheetIndex(),o=0,a=[],f={},v=[],e,y,s,h=u._getJSSheetHeader(l).find(".e-colselected").length;if(u.model.allowSorting){if(n=u._toIntrnlRange(n),this._isSortByFilter&&h<1){for(s=this._isSortByFilter?n[0]-1:n[0],y=u._getAlphaRange(l,s,n[1],s+1,n[3]),e=u._getAlphaRangeCells(y).find(".e-filterspan"),c=e.length;o<c;)v.push({colIndex:e[o].parentNode.cellIndex,rowIndex:e.eq(o).parents("tr").index()}),o++;e.length&&(n[0]=this._isSortByFilter?n[0]:n[0]+1)}a=u.getRangeDataAsObject({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]},!0)[0];f.requestType=t.Spreadsheet.Actions.Sorting;f.range=n;f.columnName=i;f.rangeData=a;f.action="sorting";f.sortDirection=r;f.filterIcon=v;f.isSortByFilter=this._isSortByFilter;f.colSelected=h;u._processBindings(f);h&&this._isSortByFilter&&u.XLFilter._changeSortIcon({rowIndex:n[0]-1,colIndex:n[1]},r)}}},_sortComplete:function(n){var t=this.XLObj,i=n.range,r=this._swapSortedDatas(n),u=r[1];t._dupDetails=!0;n.rangeData=r[0];t.model.allowComments&&t.XLComment.deleteComment(i,null,!0,"comment");t._removeHyperlink(null,null,!0);t.clearRangeData(i,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0);t.model.allowCellFormatting&&t.XLFormat.removeStyle(i,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0});t.XLEdit.updateCellWithContainer(u,i,null,!0);t._dupDetails=!1},_swapSortedDatas:function(t){var h,c,i,f=0,l=[],e=[],o=[],a=t.model.currentViewData,y=a.length,p=this.XLObj._generateColCount(t.columnName)-1,v,r=t.range,s=r[3]-r[1]+1,w=p-r[1],u=this.XLObj.getRangeData(r,!1,["value","value2","type","thousandSeparator","range","format","comment","hyperlink"],null,!1,!1,!0);for(n.extend(!0,l,u),e.push(l);f<y;){for(h=a[f][t.columnName],i=w,v=u.length;i<v;){if(u[i].value===h){c=this._getMinIdx(i,s);o=o.concat(u.splice(c,s));break}i+=s}f++}return e.push(o),e},_getMinIdx:function(n,t){var i,r;if(i=r=t,n<t)return 0;while(i<=n){if(r+=t,r>n)return i;i+=t}}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.dragAndDrop=function(n){this.XLObj=n;this._isDragAndDropStart=!1;this._dragAndDropCell={rowIndex:0,colIndex:0};this._isDragAndDropped=!1;this._allowDragAndDrop=!1};t.spreadsheetFeatures.dragAndDrop.prototype={moveRangeTo:function(i,r){var h,a,c,v,e,o,l,u=this.XLObj,s,y,f,p;u.model.allowDragAndDrop&&(h=u.getActiveSheetIndex(),a=u.getSheet(h),i=u.swapRange(i),r=u.swapRange(r),e={rowIndex:r[0],colIndex:r[1]},o={rowIndex:r[2],colIndex:r[3]},c=u.getRangeData(i,"",["value","value2","type","formatStr","decimalPlaces","thousandSeparator","range","format","border","comment","hyperlink","picture","cFormatRule","rule","chart","isLocked","wrap","formats","tformats","tborders","isFilterHeader","filterState","isFilterVisible","tableName"]),u.model.allowCellFormatting&&(v=u.XLFormat.getHashCodeClassAsArray(i)),u.model.allowConditionalFormats&&(s=u.XLEdit.getPropertyValue(i[0],i[1],"cFormatRule")),!u.isUndefined(s)&&s.length>0&&(f=s[0].split("_"),s={action:f[0],input1:f[2],input2:f[3],color:f[4],range:f[5]}),details={sheetIndex:h,reqType:"reorder-cells",sourceData:n.extend(!0,[],c),sourceRange:i,destinationRange:r,sourceFormat:v,destinationFormat:u.model.allowCellFormatting&&u.XLFormat.getHashCodeClassAsArray(r),destinationData:u.getRangeData(r),sourceCFormat:s},u.model.allowFiltering&&(l=u.XLFilter._checkFilteredCells(h)),u._dupDetails=!0,u.model.allowComments&&u.XLComment.deleteComment(),l&&l.isApplied?u.XLFilter._moveFilteredCells(h,l):(u.clearRangeData(i,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","isFilterHeader","filterState","isFilterVisible","tableName"]),u.clearRangeData(r),u.model.allowCellFormatting&&t.isNullOrUndefined(u.XLEdit.getPropertyValue(i[0],i[1],"tableName"))&&u.XLFormat.removeStyle(i),u.model.allowConditionalFormats&&u.XLCFormat.clearCF(!0,i),c[0].cFormatRule=[],u.updateData(c,r),u.model.allowCellFormatting&&u.XLFormat.updateFormat(v,r),u.model.allowConditionalFormats&&!u.isUndefined(f)&&(p=u._getAlphaRange(1,r[0],r[1],r[2],r[3]),y={action:f[0],input1:f[2],input2:f[3],color:f[4],range:p},details.destinationCFormat=y,u.XLCFormat.setCFRule(y))),u.setActiveCell(e.rowIndex,e.colIndex),e.rowIndex||o.rowIndex!==a.rowCount-1?e.colIndex||o.colIndex!==a.colCount-1?u.XLSelection.selectRange(e,o):u.XLSelection.selectRows(e.rowIndex,o.rowIndex):u.XLSelection.selectColumns(e.colIndex,o.colIndex),u._dupDetails=!1,u._isUndoRedo||!u.XLFormat||u.XLFormat._isFAT||u._completeAction(details))},_dMouseHover:function(n){var r,e,o,s,h,i,l,u,f,a=n.target,t=this.XLObj,v=t.getActiveSheetIndex(),c=t.getSheet(v).selectedRange;if(t._hasClass(a,"e-rowcell")&&(r=t._getCellIdx(a)),r&&t.inRange(c,r.rowIndex,r.colIndex)&&(r.rowIndex===c[0]||r.rowIndex===c[2]||r.colIndex===c[1]||r.colIndex===c[3])&&(i=n.target.getBoundingClientRect(),l=t._setXY(n),u=l[0],f=l[1],e=u-t.getFocusLeftElem().offset().left,e=e>=0&&e<=5,o=f-t.getFocusTopElem()[0].getBoundingClientRect().top,o=o>=0&&o<=5,s=t.getFocusRightElem().offset().left-u,s=s>=0&&s<=5,h=t.getFocusBottomElem()[0].getBoundingClientRect().top-f,h=h>=0&&h<=5,e&&u<=i.left+5&&u>=i.left||o&&f<=i.top+5&&f>=i.top||s&&u>=i.right-5&&u<=i.right||h&&f>=i.bottom-5&&f<=i.bottom)){t.addClass(a,"e-cursormove");this._isDragAndDropStart=!0;return}this._isDragAndDropStart&&(t._getContent(v).find(".e-cursormove").removeClass("e-cursormove"),this._isDragAndDropStart=!1)},_dMouseDown:function(n){var r,t=this.XLObj,u=t.getActiveSheetIndex(),i=t.getSheet(u);(n.preventDefault(),n.stopImmediatePropagation(),r=t.swapRange([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]),n.target.nodeName==="TD"&&(this._dragAndDropCell=t._getCellIdx(n.target)),t._dStartCell={rowIndex:r[0],colIndex:r[1]},t._dEndCell={rowIndex:r[2],colIndex:r[3]},t._trigger("dragStart",{sheetIndex:u,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}}))||(this._allowDragAndDrop=!0)},_dMouseMove:function(n){if(this._allowDragAndDrop){var t=this.XLObj,r=t.getActiveSheetIndex(),i=t.getSheet(r),u=t._getCellIdx(n.target);if(t._trigger("drag",{sheetIndex:r,target:n.target,currentCell:u,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}}))return;t.XLSelection._focusBorder(i._startCell,i._endCell,t._thinBorder);this._updateDCells(u);t.XLSelection._focusRange(t._dStartCell,t._dEndCell,t._autofillBorder)}else this._dMouseHover(n)},_dMouseUp:function(n){if(this._isDragAndDropped){var u,t=this.XLObj,e=t.getActiveSheetIndex(),i=t.getSheet(e),o=!0,f=!1,r=[t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex],s={sheetIndex:e,preventAlert:!1,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}},h=t._arrayAsString(t._thinBorder);if(t._isUniqueRange(i.selectedRange,t.swapRange(r)))this._preventDrop(i);else{if(t.model.allowLockCell&&i._isSheetProtected&&(u=t.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),u=u.concat(i._selectedCells),t._israngeProtected(u))){this._preventDrop(i);t.XLSelection._clearBorder(h);this._allowDragAndDrop=this._isDragAndDropStart=this._isDragAndDropped=!1;t._popUplockCellAlert();return}f=t._trigger("beforeDrop",s);s.preventAlert||f||!t._rangeHasData(r)||(o=confirm(t._getLocStr("DropAlert")));!f&&o?(this.moveRangeTo([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],[t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex]),i._startCell=t._dStartCell,i._endCell=t._dEndCell):this._preventDrop(i);!f&&o&&t._trigger("drop",{sheetIndex:e,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}})}t.XLSelection._clearBorder(h);t.model.allowAutoFill&&t.XLDragFill.positionAutoFillElement()}this._allowDragAndDrop=this._isDragAndDropStart=this._isDragAndDropped=!1},_preventDrop:function(n){var t=this.XLObj;t.XLSelection._focusRange(n._startCell,n._endCell,t._selectionBorder);t._dStartCell=n._startCell;t._dEndCell=n._endCell},_updateDCells:function(n){var t=this.XLObj,u=t.getActiveSheetIndex(),i=t.getSheet(u),r=t.isRange(i.selectedRange);i._isColSelected&&t.inRange(i.selectedRange,0,i._startCell.colIndex)||(n.rowIndex<this._dragAndDropCell.rowIndex&&t._dStartCell.rowIndex?(t._dStartCell.rowIndex=t._dStartCell.rowIndex-(this._dragAndDropCell.rowIndex-n.rowIndex),t._dEndCell.rowIndex=r?t._dEndCell.rowIndex-(this._dragAndDropCell.rowIndex-n.rowIndex):t._dStartCell.rowIndex):n.rowIndex>this._dragAndDropCell.rowIndex&&(t._dStartCell.rowIndex=t._dStartCell.rowIndex+(n.rowIndex-this._dragAndDropCell.rowIndex),t._dEndCell.rowIndex=r?t._dEndCell.rowIndex+(n.rowIndex-this._dragAndDropCell.rowIndex):t._dStartCell.rowIndex));i._isRowSelected&&t.inRange(i.selectedRange,i._startCell.rowIndex,0)||(n.colIndex<this._dragAndDropCell.colIndex&&t._dStartCell.colIndex?(t._dStartCell.colIndex=t._dStartCell.colIndex-(this._dragAndDropCell.colIndex-n.colIndex),t._dEndCell.colIndex=r?t._dEndCell.colIndex-(this._dragAndDropCell.colIndex-n.colIndex):t._dStartCell.colIndex):n.colIndex>this._dragAndDropCell.colIndex&&(t._dStartCell.colIndex=t._dStartCell.colIndex+(n.colIndex-this._dragAndDropCell.colIndex),t._dEndCell.colIndex=r?t._dEndCell.colIndex+(n.colIndex-this._dragAndDropCell.colIndex):t._dStartCell.colIndex));this._dragAndDropCell=n;this._isDragAndDropped=!0}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.exporting=function(n){this.XLObj=n};t.spreadsheetFeatures.exporting.prototype={"export":function(i){var e=this.XLObj,o,c,r,u,f,s,h;if(e.model.exportSettings.allowExporting){if(o=e.model.exportSettings,s=i===t.Spreadsheet.exportType.Excel?o.excelUrl:o.csvUrl,t.isNullOrUndefined(s)){e._showAlertDlg("Alert","ImportExportUrl");return}o.allowExporting&&!e.isUndefined(s)&&(c={action:s,method:"post"},r=t.buildTag("form","",null,c),h=this.getExportProps(),u={name:"sheetData",type:"hidden",value:h.data},f=t.buildTag("input","",null,u),r.append(f),u={name:"sheetModel",type:"hidden",value:h.model},f=t.buildTag("input","",null,u),r.append(f),u={name:"Password",type:"hidden",value:e._encrypt(o.password)},f=t.buildTag("input","",null,u),r.append(f),n("body").append(r),r.submit())}},_dropElements:function(n){var r=n.sheets,f=["_spreadSheetPager","dataSource","rangeSettings"],u,t,i;n.undoCollection=[];for(u in r){i=r[u];for(t in i)f.indexOf(t)>-1&&(i[t]=null)}return n},_getRequriedProp:function(n){for(var r={},u,i=["sheetCount","activeSheetIndex","nameManager"],o,e,s,t=0,f=i.length;t<f;t++)r[i[t]]=n[i[t]];e=n.sheets;r.sheets=[];i=["_activeCell","_endCell","_startCell","colCount","columnsWidthCollection","rowsHeightCollection","rowCount","_frozenColumns","_frozenRows","usedRange","dataAttribute","filterSettings","_tableManager","_sheetName","hideColsCollection","hideRowsCollection","showGridlines","showHeader","_isSheetProtected","_shapeMngr","chart"];for(t in e)for(r.sheets[t]={},s=r.sheets[t],o=e[t],u=0,f=i.length;u<f;u++)s[i[u]]=o[i[u]];return r},getExportProps:function(){var o=this.XLObj,t,h,u,v,y,c,l,e,p=n.extend(!0,{},o._dataContainer),r={},a=[],i,f={},s;for(o._refreshHashCode(p.hashCode),r=JSON.parse(JSON.stringify(o.model)),t=1;t<r.sheets.length;t++)for(f={},n.extend(!0,f,r.sheets[t]._shapeMngr.chart),a=o.getObjectKeys(f),r.sheets[t]._shapeMngr.chart={},h=0,v=a.length;h<v;h++)if(i=f[a[h]].id,c=n("#"+i).data("ejChart"),c){for(l=JSON.parse(JSON.stringify(c.model)),e=l.series,u=0,y=e.length;u<y;u++)delete e[u].dataSource,delete e[u].query,e[u].fill=jQuery.type(e[u].fill)=="array"?e[u].fill[0].color:e[u].fill;r.sheets[t]._shapeMngr.chart[i]=l;s=f[i].range;r.sheets[t]._shapeMngr.chart[i].range=o._generateHeaderText(t,s[1]+1)+(s[0]+1)+":"+o._generateHeaderText(t,s[3]+1)+(s[2]+1);r.sheets[t]._shapeMngr.chart[i].top=f[i].top;r.sheets[t]._shapeMngr.chart[i].left=f[i].left;r.sheets[t]._shapeMngr.chart[i].height=f[i].height;r.sheets[t]._shapeMngr.chart[i].width=f[i].width}return r.sheets.shift(),{model:JSON.stringify(this._getRequriedProp(r)),data:JSON.stringify(p)}}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.findnreplace=function(n){this.XLObj=n;this._findCount=0;this.caseSen={"true":function(n){return n.toString()},"false":function(n){return n.toString().toLowerCase()}};this.isEMatch={"true":function(n,t){return n==t},"false":function(n,t){if(!n.length||t.length)return n.indexOf(t)>-1}}};t.spreadsheetFeatures.findnreplace.prototype={replaceAllBySheet:function(n,t,i,r){this.XLObj.model.allowSearching&&this._replaceAllData(n,t,i,r,"value","sheet")},replaceAllByBook:function(n,t,i,r){this.XLObj.model.allowSearching&&this._replaceAllData(n,t,i,r,"value","workbook")},_findNext:function(n,t,i,r,u,f,e){var o,s,y,ct,tt,w,b,a,p,ot,it,rt,v,k,d,ut,ft,g=[],h=e==="rows",c=this.XLObj,st=!1,nt=t?t:c.getActiveSheetIndex(),ht=c.getSheet(nt),et=ht._activeCell,l={sheetIndex:t,value:n,isCaseSensitive:i,isEntireMatch:r,searchBy:e,mode:f,findType:u,reqType:"findNext"};if(c._trigActionBegin(l))return!0;if(c.model.allowEditing&&c.XLEdit._isEdit&&c.XLEdit.saveCell(),n=l.value,t=l.sheetIndex,i=l.isCaseSensitive,r=l.isEntireMatch,u=l.findType,f=l.mode,e=l.searchBy,w=ht._selectedCells,ot=w.length,p=ht._usedRange,ot===1||f==="workbook"?g=[et.rowIndex,et.colIndex,p.rowIndex+1,p.colIndex+1]:(st=!0,b=w[ot-1],g=[et.rowIndex,et.colIndex,b.rowIndex+1,b.colIndex+1]),a=g[0],v=g[1],k=g[2],d=g[3],h||(tt=a,a=v,v=tt,tt=k,k=d,d=tt),f==="sheet"){for(o=a;o<k;o++)for(o!==a&&(b=w[0],v=st?h?b.colIndex:b.rowIndex:0),s=v;s<d;s++)if(ut=this._compareValues(h?o:s,h?s:o,nt,n,i,r,u),ut&&!(o===a&&s===v))return this._updateSelection(h?o:s,h?s:o),this._findCount++,l={reqType:"findNext",activeCell:c.getActiveCellElem()},c._trigActionComplete(l),!0}else for(y=nt,ct=c.model.sheetCount;y<=ct;y++)for(p=c.model.sheets[y]._usedRange,y!==nt&&(v=0,a=0,k=h?p.rowIndex:p.colIndex,d=h?p.colIndex:p.rowIndex),o=a;o<k+1;o++)for(o!==a&&(v=0),s=v;s<d+1;s++)if(ut=this._compareValues(h?o:s,h?s:o,y,n,i,r,u),ut&&!(y===nt&&o===a&&s===v))return this._updateSelection(h?o:s,h?s:o,y),this._findCount++,l={reqType:"findNext",activeCell:c.getActiveCellElem()},c._trigActionComplete(l),!0;return this._findCount?!1:(it=0,rt=0,ft=f==="sheet"?nt:1,st&&(b=w[0],rt=w[0].rowIndex,it=w[0].colIndex),this._updateSelection(rt,it,ft),this._findCount++,this._compareValues(rt,it,ft,n,i,r,u)?!0:this._findNext(n,ft,i,r,u,f,e))},_findPrev:function(n,t,i,r,u,f,e){var o,s,p,it,k,a,nt,rt,ut,ft,v,y,tt,w,st=!1,d=[],ct=0,lt=0,c=e==="rows",et,h=this.XLObj,g=t?t:h.getActiveSheetIndex(),ht=h.getSheet(g),b=ht._usedRange,ot=ht._activeCell,l={sheetIndex:t,value:n,isCaseSensitive:i,isEntireMatch:r,searchBy:e,mode:f,findType:u,reqType:"findPrevious"};if(h._trigActionBegin(l))return!0;if(h.model.allowEditing&&h.XLEdit._isEdit&&h.XLEdit.saveCell(),n=l.value,t=l.sheetIndex,i=l.isCaseSensitive,r=l.isEntireMatch,u=l.findType,f=l.mode,e=l.searchBy,nt=ht._selectedCells,rt=nt.length,rt===1||f==="workbook"?d=[ot.rowIndex,ot.colIndex,b.rowIndex+1,b.colIndex+1]:(a=nt[rt-1],d=[ot.rowIndex,ot.colIndex,a.rowIndex,a.colIndex],st=!0),v=d[0],y=d[1],tt=d[2],w=d[3],c||(et=v,v=y,y=et,et=tt,tt=w,w=et),f==="sheet"){for(st&&(a=nt[0],ct=c?a.rowIndex:a.colIndex,lt=c?a.colIndex:a.rowIndex),o=v;o>=ct;o--)for(o!==v&&(y=w),s=y;s>=lt;s--)if(it=this._compareValues(c?o:s,c?s:o,g,n,i,r,u),it&&!(o===v&&s===y))return this._updateSelection(c?o:s,c?s:o),this._findCount++,l={reqType:"findPrevious",activeCell:h.getActiveCellElem()},h._trigActionComplete(l),!0}else for(p=g;p>=1;p--)for(b=h.model.sheets[p]._usedRange,p!==g&&(tt=c?b.rowIndex:b.colIndex,w=c?b.colIndex:b.rowIndex,y=w,v=tt),o=v;o>=0;o--)for(o!==v&&(y=w+1),s=y;s>=0;s--)if(it=this._compareValues(c?o:s,c?s:o,p,n,i,r,u),it&&!(p===g&&o===v&&s===y))return this._updateSelection(c?o:s,c?s:o,p),this._findCount++,l={reqType:"findPrevious",activeCell:h.getActiveCellElem()},h._trigActionComplete(l),!0;return this._findCount?!1:(k=f==="sheet"?g:h.model.sheetCount,ft=h.model.sheets[k]._usedRange.rowIndex,ut=h.model.sheets[k]._usedRange.colIndex,st&&(a=nt[rt-1],ft=a.rowIndex,ut=a.colIndex),this._updateSelection(ft,ut,k),this._findCount++,this._compareValues(ft,ut,k,n,i,r,u)?!0:this._findPrev(n,k,i,r,u,f,e))},_compareValues:function(n,t,i,r,u,f,e){var s=this.XLObj,o=s.XLEdit.getPropertyValue(n,t,null,i)?s.XLEdit.getPropertyValue(n,t,null,i).toString():"",h=s.isFormula(o)||e==="formula"&&o==="=";return o=e==="value"?o&&!h?this.caseSen[u](o):"":e==="formula"?h?this.caseSen[u](o):"":s.XLEdit.getPropertyValue(n,t,"comment",i)?this.caseSen[u](s.XLEdit.getPropertyValue(n,t,"comment",i).value):"",r=this.caseSen[u](r),this.isEMatch[f](o,r)},_replace:function(n,t,i,r,u){var f=this.XLObj,o=f.getActiveSheetIndex(),e=f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,null,t)?f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,null,t).toString():"",s=new RegExp(i.toString().replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),h=e!==""&&i!==""?u?e.replace(i,r):e.replace(s,r):r;t===o||f.gotoPage(t);f.XLEdit.updateCellValue(n,h)},_replaceData:function(n,t,i,r,u,f,e,o,s){var v,y,h=this.XLObj,c=i?i:h.model.activeSheetIndex,p=h.getSheet(c),l=p._activeCell.rowIndex,a=p._activeCell.colIndex,w;if(h.model.allowLockCell&&p._isSheetProtected){h._popUplockCellAlert();return}h.model.allowEditing&&h.XLEdit._isEdit&&h.XLEdit.saveCell();this._compareValues(l,a,c,n,r,u,f)?(y=f==="formula"?"value":"value2",v={sheetIndex:c,reqType:"find-replace",operation:"replace",rowIndex:l,colIndex:a,sIndex:i},v.prevData={value:h.XLEdit.getPropertyValue(l,a,y)},this._replace({rowIndex:l,colIndex:a},i,n,t,r),v.newData={value:h.XLEdit.getPropertyValue(l,a,y)},this._findCount=0,w=e==="up"?this._findPrev(n,c,r,u,f,o,s):this._findNext(n,c,r,u,f,o,s),w||this._updateSelection(l,a,c),h._isUndoRedo||h._completeAction(v)):h._showAlertDlg("Alert","ReplaceNotFound","")},_replaceAllData:function(t,i,r,u,f,e){var d,a,l,g=[],it=0,rt=!1,nt,o=this.XLObj,ut=o.model.sheetCount,v=o.model.activeSheetIndex,w=o.getSheet(v),y=w._usedRange,ft=w._activeCell.rowIndex,et=w._activeCell.colIndex,s,h,c,b,k,tt=0,p;if(d={sheetIndex:v,reqType:"find-replace",operation:"replaceAll"},a=f==="formula"?"value":"value2",o.model.allowEditing&&o.XLEdit._isEdit&&o.XLEdit.saveCell(),e==="sheet")for(o.model.allowLockCell&&w._isSheetProtected&&(rt=!0),s=0,b=y.rowIndex+1;s<b;s++)for(h=0,k=y.colIndex+1;h<k;h++)this._compareValues(s,h,v,t,r,u,f)&&(l={rowIndex:s,colIndex:h,prevData:{value:o.XLEdit.getPropertyValue(s,h,a)},sheetIndex:v},this._replace({rowIndex:s,colIndex:h},v,t,i,r),tt++,l.newData={value:o.XLEdit.getPropertyValue(s,h,a)},g.push(l));else for(c=1;c<=ut;c++){if(nt=o.model.sheets[c],o.model.allowLockCell&&nt._isSheetProtected){it++;continue}for(y=nt._usedRange,s=0,b=y.rowIndex+1;s<b;s++)for(h=0,k=y.colIndex+1;h<k;h++)this._compareValues(s,h,c,t,r,u,f)&&(l={rowIndex:s,colIndex:h,prevData:{value:o.XLEdit.getPropertyValue(s,h,a,c)},sheetIndex:c},this._replace({rowIndex:s,colIndex:h},c,t,i,r),tt++,l.newData={value:o.XLEdit.getPropertyValue(s,h,a)},g.push(l))}if(rt||it===ut){o._popUplockCellAlert();return}d.selCells=g;this._updateSelection(ft,et);o._isUndoRedo||o._completeAction(d);o.element.ejWaitingPopup("hide");p=o._getLocStr("ReplaceData").split("/");p="T-"+p[0]+tt+" "+p[1];n("#"+o._id+"_FRDialog").ejDialog("close");o._showAlertDlg("Alert",p,"",325)},_updateSelection:function(n,t,i){var u={rowIndex:n,colIndex:t},r=this.XLObj,f=r.getActiveSheetIndex(),e=r.getSheet(f);i||(i=f);i&&i!==f&&r.gotoPage(i,!1);r.getSheetElement(f).find(".e-selected:visible").length<2||!r.inRange(e.selectedRange,n,t)?(r.setActiveCell(u.rowIndex,u.colIndex,i),r.XLSelection.selectRange(u,u),e._startCell=u,e._endCell=u):r.XLCellNav._updateActiveCell(n,t);r.model.scrollSettings.allowScrolling&&r.XLScroll._scrollSelectedPosition(i,r.getActiveCell(i));r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement()},_fRKeyDownHandler:function(t){var i=this.XLObj;t.ctrlKey&&(t.keyCode===70?(t.preventDefault(),n("#"+i._id+"_FRDialog").ejDialog("open"),n("#"+i._id+"_FRDialog_FPDlgTab").ejTab("option","selectedItemIndex",0)):t.keyCode===72?(t.preventDefault(),n("#"+i._id+"_FRDialog").ejDialog("open"),n("#"+i._id+"_FRDialog_FPDlgTab").ejTab("option","selectedItemIndex",1)):t.keyCode===71&&(t.preventDefault(),n("#"+i._id+"_GoDialog").ejDialog("open"),n("#"+i._id+"_GoToDlgTab").ejTab("option","selectedItemIndex",0)))},_getSelRangeDetails:function(n){var t=n[n.length-1].rowIndex-n[0].rowIndex,i=n[n.length-1].colIndex-n[0].colIndex,r=n[0].rowIndex,u=n[0].colIndex;return[t,i,r,u]},_applyGoToRule:function(n,t,i,r,u){var e=this.XLObj,o,f;e.element.ejWaitingPopup("show");switch(n){case"blanks":this._applyGotoBlanks();break;case"formulas":this._applyGotoFormulas(t,i,r,u);break;case"comments":this._applyGotoComments();break;case"datavalidation":this._applyGotoValidation();break;case"cformat":this._applyGotoCFormat();break;case"lastcell":o=e.getActiveSheetIndex();f=e.model.sheets[o]._usedRange;e.XLSelection.selectRange({rowIndex:f.rowIndex,colIndex:f.colIndex},{rowIndex:f.rowIndex,colIndex:f.colIndex});this._updateSelection(f.rowIndex,f.colIndex,o);break;case"constants":this._applyGotoConstants(t,i,r,u);break;case"rowdiff":this._applyGotoRowDiff();break;case"coldiff":this._applyGotoColDiff()}e.element.ejWaitingPopup("hide")},_applyGotoBlanks:function(){var r,u,o,f=!1,s=[],t,n=this.XLObj,i=n.getActiveSheetIndex(),h=n.model.sheets[i]._usedRange,c,l=h.rowIndex,a=h.colIndex,e=n.getSheet(i),v=e._selectedCells,y=0,p=0,w={sheetIndex:i,reqType:"find-replace",operation:"blanks"};for(e._goToCollection={multiple:!1,selected:[]},v.length>1&&(t=this._getSelRangeDetails(v),l=t[0],a=t[1],y=t[2],p=t[3],e._goToCollection.multiple=!0),r=0;r<=l;r++){for(u=0;u<=a;u++)rIdx=r+y,cIdx=u+p,c=n.XLEdit.getPropertyValue(rIdx,cIdx)?n.XLEdit.getPropertyValue(rIdx,cIdx).toString():"",n._isRowViewable(i,rIdx)&&(o=n.getCell(rIdx,cIdx,i),f=!0),c.length?f&&o.removeClass("e-selected"):(s.push({rowIndex:rIdx,colIndex:cIdx,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&e._goToCollection.selected.push(rIdx+":"+cIdx),f&&o.addClass("e-selected"));f=!1}w.selCells=s;n._isUndoRedo||n._completeAction(w)},_applyGotoComments:function(){var u,f,s,e=!1,h=[],i,n=this.XLObj,r=n.getActiveSheetIndex(),c=n.getSheet(r)._usedRange,l,a=c.rowIndex,v=c.colIndex,o=n.getSheet(r),y=o._selectedCells,p=0,w=0,b={sheetIndex:r,reqType:"find-replace",operation:"comments"};for(o._goToCollection={multiple:!1,selected:[]},y.length>1&&(i=this._getSelRangeDetails(y),a=i[0],v=i[1],p=i[2],w=i[3],o._goToCollection.multiple=!0),u=0;u<=a;u++){for(f=0;f<=v;f++)rIdx=u+p,cIdx=f+w,l=n.XLEdit.getPropertyValue(rIdx,cIdx,"comment"),n._isRowViewable(r,rIdx)&&(s=n.getCell(rIdx,cIdx,r),e=!0),t.isNullOrUndefined(l)?e&&s.removeClass("e-selected"):(h.push({rowIndex:rIdx,colIndex:cIdx,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&o._goToCollection.selected.push(rIdx+":"+cIdx),e&&s.addClass("e-selected"));e=!1}b.selCells=h;n._isUndoRedo||n._completeAction(b)},_applyGotoFormulas:function(i,r,u,f){var v,l,w,s,h,y=!1,k=[],a,o=this.XLObj,c=o.getActiveSheetIndex(),d,e,g,nt=o.model.sheets[c]._usedRange,tt=nt.rowIndex,it=nt.colIndex,p=o.getSheet(c),rt=p._selectedCells,ut=0,b=0,ft={sheetIndex:c,reqType:"find-replace",operation:"formulas"};for(p._goToCollection={multiple:!1,selected:[]},rt.length>1&&(a=this._getSelRangeDetails(rt),tt=a[0],it=a[1],ut=a[2],b=a[3],p._goToCollection.multiple=!0),v=0;v<=tt;v++){for(l=0;l<=it;l++)s=v+ut,h=l+b,d=t.isNullOrUndefined(o.XLEdit.getPropertyValue(s,h))?"":o.XLEdit.getPropertyValue(s,l+b).toString(),e=t.isNullOrUndefined(o.XLEdit.getPropertyValue(s,h,"value2"))?"":o.XLEdit.getPropertyValue(s,h,"value2").toString(),g=d.charAt(0)==="="&&typeof e=="string",o._isRowViewable(c,s)&&(w=o.getCell(s,h,c),y=!0),g&&(i&&n.isNumeric(e)||r&&!(e.toLowerCase()==="true"||e.toLowerCase()==="false")&&!n.isNumeric(e)&&!(e.length!==0&&e.indexOf("#")===0&&e.lastIndexOf("?")===e.length-1&&e.length>0)||u&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")||f&&e.length!==0&&o._sheets[c]._calcEngine.getErrorStrings().indexOf("#VALUE!")>-1)?(k.push({rowIndex:s,colIndex:h,isApply:!0}),o.model.scrollSettings.allowVirtualScrolling&&p._goToCollection.selected.push(s+":"+h),y&&w.addClass("e-selected")):y&&w.removeClass("e-selected");y=!1}ft.selCells=k;o._isUndoRedo||o._completeAction(ft)},_applyGotoValidation:function(){var e,o,c,i,r,s=!1,l=[],u,n=this.XLObj,f=n.getActiveSheetIndex(),a=n.model.sheets[f]._usedRange,v,y=a.rowIndex,p=a.colIndex,h=n.getSheet(f),w=h._selectedCells,b=0,k=0,d={sheetIndex:f,reqType:"find-replace",operation:"validations"};for(h._goToCollection={multiple:!1,selected:[]},w.length>1&&(u=this._getSelRangeDetails(w),y=u[0],p=u[1],b=u[2],k=u[3],h._goToCollection.multiple=!0),e=0;e<=y;e++){for(o=0;o<=p;o++)i=e+b,r=o+k,v=n.XLEdit.getPropertyValue(i,r,"rule"),n._isRowViewable(f,i)&&(c=n.getCell(i,r,f),s=!0),t.isNullOrUndefined(v)?s&&c.removeClass("e-selected"):(l.push({rowIndex:i,colIndex:r,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&h._goToCollection.selected.push(i+":"+r),s&&c.addClass("e-selected"));s=!1}d.selCells=l;n._isUndoRedo||n._completeAction(d)},_applyGotoCFormat:function(){var e,o,c,i,r,s=!1,a=[],u,n=this.XLObj,f=n.getActiveSheetIndex(),v=n.model.sheets[f]._usedRange,l,y=v.rowIndex,p=v.colIndex,h=n.getSheet(f),w=h._selectedCells,b=0,k=0,d={sheetIndex:f,reqType:"find-replace",operation:"conditions"};for(h._goToCollection={multiple:!1,selected:[]},w.length>1&&(u=this._getSelRangeDetails(w),y=u[0],p=u[1],b=u[2],k=u[3],h._goToCollection.multiple=!0),e=0;e<=y;e++){for(o=0;o<=p;o++)i=e+b,r=o+k,l=n.XLEdit.getPropertyValue(i,r,"cFormatRule"),n._isRowViewable(f,i)&&(c=n.getCell(i,r,f),s=!0),!t.isNullOrUndefined(l)&&l.length?(a.push({rowIndex:i,colIndex:r,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&h._goToCollection.selected.push(i+":"+r),s&&c.addClass("e-selected")):s&&c.removeClass("e-selected");s=!1}d.selCells=a;n._isUndoRedo||n._completeAction(d)},_applyGotoConstants:function(i,r,u,f){var a,v,b,o,h,y=!1,ut=[],k,l,e=this.XLObj,p=e.getActiveSheetIndex(),s,c,d=e.model.sheets[p]._usedRange,g=d.rowIndex,nt=d.colIndex,w=e.getSheet(p),tt=w._selectedCells,it=0,rt=0;for(w._goToCollection={multiple:!1,selected:[]},tt.length>1&&(l=this._getSelRangeDetails(tt),g=l[0],nt=l[1],it=l[2],rt=l[3],w._goToCollection.multiple=!0),a=0;a<=g;a++){for(v=0;v<=nt;v++)o=a+it,h=v+rt,s=t.isNullOrUndefined(e.XLEdit.getPropertyValue(o,h))?"":e.XLEdit.getPropertyValue(o,h).toString(),c=t.isNullOrUndefined(e.XLEdit.getPropertyValue(o,h,"value2"))?"":e.XLEdit.getPropertyValue(o,h,"value2").toString(),k=s.charAt(0)==="="&&typeof c=="string",e._isRowViewable(p,o)&&(b=e.getCell(o,h,p),y=!0),!k&&(i&&n.isNumeric(s)||r&&!(s.toLowerCase()==="true"||s.toLowerCase()==="false")&&!n.isNumeric(s)&&s.length>0||u&&(s.toLowerCase()==="true"||s.toLowerCase()==="false")||f&&c.length!==0&&c.indexOf("#")===0&&c.lastIndexOf("?")===c.length-1)?(ut.push({rowIndex:o,colIndex:h,isApply:!0}),e.model.scrollSettings.allowVirtualScrolling&&w._goToCollection.selected.push(o+":"+h),y&&b.addClass("e-selected")):y&&b.removeClass("e-selected");y=!1}},_applyGotoColDiff:function(){var f,e,c,t,i,o=!1,l=[],r,n=this.XLObj,u=n.getActiveSheetIndex(),a=n.model.sheets[u]._usedRange,v,y=a.rowIndex,p=a.colIndex,s=n.getSheet(u),w=s._selectedCells,h=0,b=0,k={sheetIndex:u,reqType:"find-replace",operation:"coldiff"},d;if(s._goToCollection={multiple:!1,selected:[]},w.length>1)for(r=this._getSelRangeDetails(w),y=r[0],p=r[1],h=r[2],b=r[3],s._goToCollection.multiple=!0,f=0;f<=p;f++){for(t=f+b,d=n.XLEdit.getPropertyValue(h,t)?n.XLEdit.getPropertyValue(h,t).toString():"",e=0;e<=y;e++)i=e+h,v=n.XLEdit.getPropertyValue(i,t)?n.XLEdit.getPropertyValue(i,t).toString():"",n._isRowViewable(u,i)&&(c=n.getCell(i,t,u),o=!0),v===d?o&&c.removeClass("e-selected"):(l.push({rowIndex:i,colIndex:t,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&s._goToCollection.selected.push(i+":"+t),o&&c.addClass("e-selected"));o=!1}k.selCells=l;n._isUndoRedo||n._completeAction(k)},_applyGotoRowDiff:function(){var r,u,s,f=!1,h=[],t,n=this.XLObj,i=n.getActiveSheetIndex(),c=n.model.sheets[i]._usedRange,l,a=c.rowIndex,v=c.colIndex,e=n.getSheet(i),y=e._selectedCells,p=0,o=0,w,b={sheetIndex:i,reqType:"find-replace",operation:"rowdiff"};if(e._goToCollection={multiple:!1,selected:[]},y.length>1)for(t=this._getSelRangeDetails(y),a=t[0],v=t[1],p=t[2],o=t[3],e._goToCollection.multiple=!0,r=0;r<=a;r++){for(rIdx=r+p,w=n.XLEdit.getPropertyValue(rIdx,o)?n.XLEdit.getPropertyValue(rIdx,o).toString():"",u=0;u<=v;u++)cIdx=u+o,l=n.XLEdit.getPropertyValue(rIdx,cIdx)?n.XLEdit.getPropertyValue(rIdx,cIdx).toString():"",n._isRowViewable(i,rIdx)&&(s=n.getCell(rIdx,cIdx,i),f=!0),l===w?f&&s.removeClass("e-selected"):(h.push({rowIndex:rIdx,colIndex:cIdx,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&e._goToCollection.selected.push(rIdx+":"+cIdx),f&&s.addClass("e-selected"));f=!1}b.selCells=h;n._isUndoRedo||n._completeAction(b)}}}(jQuery,Syncfusion);$.fn.setInputPos=function(n,t){return t||(t=n),$(this).is(":visible")?this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(n,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",n);i.select()}}):void 0},function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.formatCellDialog=function(n){this.XLObj=n};t.spreadsheetFeatures.formatCellDialog.prototype={_renderCellFrmtDlg:function(){var i=this.XLObj,y=i._id,r=y+"_formatdlg",e,u,f,o,l,a,s,v,h,c;e=t.buildTag("div#"+r);u=t.buildTag("div#"+r+"_formattab");f=t.buildTag("div.e-dlg-fields e-dlgctndiv");o=t.buildTag("ul");l=t.buildTag("a",i._getLocStr("NumberTab"),{},{href:"#"+r+"_number"});a=t.buildTag("li",l);o.append(a);u.append(o);f.append(u);s=t.buildTag("div.e-dlg-btnfields");v=t.buildTag("div.e-dlg-btnctnr");h=t.buildTag("input#"+r+"_okbtn");c=t.buildTag("input#"+r+"_cantn");h.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgCFOk,this)});c.ejButton({text:i._getLocStr("Cancel"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgCFCancel,this)});s.append(v.append(h,c));f.append(t.buildTag("div#"+r+"_format_dataMnger","",{display:"none"}));i.element.append(e.append(f,s));e.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("Formatcells"),width:548,height:"auto",cssClass:"e-ss-dialog e-"+i._id+"-dlg",open:function(){n("#"+i._id+"_formatdlg_okbtn").focus()}});u.ejTab({width:518,cssClass:"e-ss-dlgtab",allowKeyboardNavigation:!1});this._renderNumberTab()},_renderNumberTab:function(){var i=this.XLObj,r=i._id+"_fdlg_nTab",d,g,nt,tt,c,l,s,a,h,o,e,f,u,v,y,p,w,b,k,it,rt;g=[{text:"Wednesday, March 14, 2012",value:"{0:dddd, MMMM dd, yyyy}"},{text:"03/14/2012",value:"{0:MM/dd/yyyy}"},{text:"March 03",value:"{0:MMMM dd}"},{text:"2012 March",value:"{0:yyyy MMMM}"},{text:"3/14/12 1:30 PM",value:"{0:dd/MM/yyyy h:mm tt}"}];d=[{value:"General",text:i._getLocStr("LGeneral")},{value:"Number",text:i._getLocStr("NumberTab")},{value:"Currency",text:i._getLocStr("LCurrency")},{value:"Accounting",text:i._getLocStr("LAccounting")},{value:"Date",text:i._getLocStr("LDate")},{value:"Time",text:i._getLocStr("LTime")},{value:"Percentage",text:i._getLocStr("LPercentage")},{value:"Fraction",text:i._getLocStr("LFraction")},{value:"Scientific",text:i._getLocStr("LScientific")},{value:"Text",text:i._getLocStr("LText")},{value:"Custom",text:i._getLocStr("LCustom")}];nt=[{text:"0",type:"default"},{text:"0.00",type:"default"},{text:"#,##0",type:"default"},{text:"#,##00.00",type:"default"},{text:"0%",type:"default"},{text:"0.00%",type:"default"},{text:"m/d/yyyy",type:"default"},{text:"d-mmm",type:"default"},{text:"h:mm",type:"default"},{text:"mm:ss",type:"default"}];tt=[{text:"1:30:55 PM",value:"{0:h:mm:ss tt}"},{text:"1:30 PM",value:"{0:h:mm tt}"},{text:"13:30:55",value:"{0:h:mm:ss}"},{text:"1:30",value:"{0:hh:mm}"}];c=t.buildTag("table","",{},{cellspacing:"0",cellpadding:"0"});l=t.buildTag("tr");h=t.buildTag("td","",{width:"25%","padding-right":16});s=t.buildTag("label#"+r+"_clabel.e-dlg-fields",i._getLocStr("Category"));a=t.buildTag("ul#"+r+"_list");c.append(l.append(h.append(s,a)));h=t.buildTag("td","",{"vertical-align":"top","padding-bottom":7});$table1=t.buildTag("table","",{"white-space":"normal"},{cellspacing:"0",cellpadding:"0"});$tr1=t.buildTag("tr");$td1=t.buildTag("td","",{"vertical-align":"top","padding-bottom":7});o=t.buildTag("input#"+r+"_sinput.ejinputtext","",{},{disabled:"disabled"});s=t.buildTag("label.e-dlg-fields",i._getLocStr("FormatSample"));$table1.append($tr1.append(s,o));$tr1=t.buildTag("tr");v=t.buildTag("td","",{"vertical-align":"top","padding-top":9});$tr1.append($tr1.append(v));l.append(h.append($table1.append($tr1)));e=t.buildTag("table","",{"white-space":"normal"});f=t.buildTag("tr#"+r+"_decimal.e-fdlg-num-options");u=t.buildTag("td",t.buildTag("label.e-dlg-fields",i._getLocStr("DecimalPlacesTxt"),{"padding-right":7,"padding-top":5}),"",{width:"103px"});f.append(u);u=t.buildTag("td");o=t.buildTag("input#"+r+"_decimalplace","");v.append(e.append(f.append(u.append(o))));f=t.buildTag("tr#"+r+"_tseparator.e-fdlg-num-options");u=t.buildTag("td","","",{colspan:"2"});$chkelem=t.buildTag("input#"+r+"_kseptr");e.append(f.append(u.append($chkelem)));f=t.buildTag("tr#"+r+"_dtypes.e-fdlg-num-options");u=t.buildTag("td",t.buildTag("label.e-dlg-fields",i._getLocStr("Type")));y=t.buildTag("ul#"+r+"_datetypes");e.append(f.append(u.append(y)));f=t.buildTag("tr#"+r+"_ttypes.e-fdlg-num-options");u=t.buildTag("td",t.buildTag("label.e-dlg-fields",i._getLocStr("Type")));p=t.buildTag("ul#"+r+"_timetypes");e.append(f.append(u.append(p)));f=t.buildTag("tr#"+r+"_custom.e-fdlg-num-options");u=t.buildTag("td",t.buildTag("label.e-dlg-fields",i._getLocStr("Type")));w=t.buildTag("input#"+r+"_custominput.ejinputtext");b=t.buildTag("ul#"+r+"_customtypes");k=t.buildTag("button#"+r+"_delBtn",i._getLocStr("Delete"));it=t.buildTag("div",k,{"text-align":"right","padding-top":7});e.append(f.append(u.append(w,b,it)));i._on(w,"keydown",this._validateCustomFormat);rt=t.buildTag("div#"+r+"_typeinfo","",{height:40,"padding-top":7});n("#"+i._id+"_formatdlg_number").append(c,rt);e.find(".e-fdlg-num-options").hide();a.ejListBox({selectedItemIndex:"0",width:"120",height:"332",dataSource:d,fields:{text:"text",value:"value"},select:n.proxy(this._onNumFormatSelect,this),allowMultiSelection:!1});o.ejNumericTextbox({name:"numeric",value:2,height:27,width:115,minValue:0,maxValue:30,change:n.proxy(this._refreshFrmtPropChanges,this)});$chkelem.ejCheckBox({change:n.proxy(this._refreshFrmtPropChanges,this)});$chkelem.parent().append(t.buildTag("label.e-dlg-fields",i._getLocStr("ThousandSeparatorTxt"),{"margin-left":6}));y.ejListBox({dataSource:g,fields:{text:"text",value:"value"},width:"270px",height:"120px",selected:n.proxy(this._refreshFrmtPropChanges,this)});p.ejListBox({dataSource:tt,fields:{text:"text",value:"value"},width:"270px",height:"123px",selected:n.proxy(this._refreshFrmtPropChanges,this)});b.ejListBox({dataSource:nt,fields:{text:"text",value:"value"},width:"338px",height:"120px",selected:n.proxy(this._refreshFrmtPropChanges,this)});k.ejButton({enabled:!1,size:"mini",click:n.proxy(this._customFormatDelete,this)})},_initFormatCellDlg:function(){var t=this.XLObj;n("#"+t._id+"_formatdlg").ejDialog("open");this._updateFormtdata();n("#"+t._id+"_formatdlg_format_dataMnger").removeData()},_updateFormtdata:function(){var i=this.XLObj,r=i.getActiveCell(),e=n("#"+i._id+"_fdlg_nTab_list").data("ejListBox"),a=n("#"+i._id+"_fdlg_nTab_decimalplace").data("ejNumericTextbox"),o=n("#"+i._id+"_fdlg_nTab_datetypes").data("ejListBox"),s=n("#"+i._id+"_fdlg_nTab_timetypes").data("ejListBox"),v=n("#"+i._id+"_fdlg_nTab_customtypes").data("ejListBox"),t,h,c,l,u,f;e._refreshScroller();t=i.getRangeData([r.rowIndex,r.colIndex,r.rowIndex,r.colIndex])[0];h="decimalPlaces"in t?t.decimalPlaces:2;c="thousandSeparator"in t?t.thousandSeparator:!1;l="type"in t?t.type.indexOf("date")>-1?"date":t.type:"general";"formatStr"in t?(u=o.getIndexByValue(t.formatStr),f=s.getIndexByValue(t.formatStr)):u=f=0;e.selectItemByValue(n.camelCase("-"+l));o.selectItemByIndex(u>-1?u:0);s.selectItemByIndex(f>-1?f:0);v.selectItemByIndex(0);a.option("value",h);n("#"+i._id+"_fdlg_nTab_kseptr").ejCheckBox({checked:c});this._onNumFormatSelect(e.model)},_onNumFormatSelect:function(t){var i=this.XLObj,r="#"+i._id+"_fdlg_nTab_",f=n("#"+i._id+"_fdlg_nTab_typeinfo"),u;n("#"+i._id+"_formatdlg_number").find(".e-fdlg-num-options").hide();switch(t.value){case"Number":n(r+"decimal, "+r+"tseparator").show();break;case"Currency":case"Accounting":case"Percentage":case"Scientific":n(r+"decimal").show();break;case"Date":n(r+"dtypes").show();n("#"+i._id+"_fdlg_nTab_datetypes").data("ejListBox")._refreshScroller();break;case"Time":n(r+"ttypes").show();n("#"+i._id+"_fdlg_nTab_timetypes").data("ejListBox")._refreshScroller();break;case"Custom":n(r+"custom").show();n("#"+i._id+"_fdlg_nTab_customtypes").data("ejListBox")._refreshScroller()}u=this._getFormattedText(t.value);n("#"+i._id+"_fdlg_nTab_decimalplace").data("ejNumericTextbox").option("maxValue",t.value==="Scientific"?20:30);n("#"+i._id+"_fdlg_nTab_sinput").val(u);f.text(i._getLocStr(t.value))},_getFormattedText:function(i){var u=this.XLObj,c=u.getActiveCell(),v=n("#"+u._id+"_fdlg_nTab_decimalplace").data("ejNumericTextbox"),y=n("#"+u._id+"_fdlg_nTab_datetypes").data("ejListBox"),l={Number:"0:N",Currency:"0:C",Accounting:"0:C",Percentage:"0:P",Scientific:"0:N"},p=n("#"+u._id+"_fdlg_nTab_timetypes").data("ejListBox"),s=t.Spreadsheet.CellType,a=t.Spreadsheet.CellFormat,h=n("#"+u._id+"_fdlg_nTab_customtypes").data("ejListBox"),e,r,o,f;e=v.getValue();r=u.XLEdit.getPropertyValue(c.rowIndex,c.colIndex)||"";o=n("#"+u._id+"_fdlg_nTab_kseptr").ejCheckBox("checked");switch(i){case"Number":case"Currency":case"Accounting":case"Percentage":f="{"+l[i]+e+"}";u._isDateTime(r)&&(r=u._dateToInt(r));r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,thousandSeparator:o,type:s[i],decimalPlaces:e}));break;case"Date":f=y.getSelectedItems()[0].value;i=f===a.longdate?"longdate":f===a.shortdate?"shortdate":"date";r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,type:i}));break;case"Time":f=p.getSelectedItems()[0].value;r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,type:s[i]}));e=0;break;case"Scientific":f="{"+l[i]+e+"}";u._isDateTime(r)&&(r=u._dateToInt(r));r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,thousandSeparator:o,type:s[i],decimalPlaces:e}));break;case"Fraction":u._isDateTime(r)&&(r=u._dateToInt(r));r=u.toFraction(r);r&&(r=t.isNullOrUndefined(r.numerator)?r.integer:r.integer+" "+r.numerator+"/"+r.denominator);break;case"General":case"Text":u._isDateTime(r)&&(r=u._dateToInt(r));break;case"Custom":cValue=h.getSelectedItems()[0].text;formatObj=u.XLFormat.customFormatParser(cValue);n("#"+u._id+"_fdlg_nTab_custominput").val(cValue);r=u.XLFormat._format(r,formatObj);n("#"+u._id+"_fdlg_nTab_delBtn").data("ejButton")._setModel({enabled:h.model.dataSource[h.getSelectedItems()[0].index].type==="custom"})}return n("#"+u._id+"_formatdlg_format_dataMnger").data("NumFormat",i==="Custom"?formatObj:{type:i.toLowerCase(),decimalPlaces:e,thousandSeparator:o,formatStr:f}),r},_refreshFrmtPropChanges:function(){var t=this.XLObj,i,r=n("#"+t._id+"_fdlg_nTab_list").data("ejListBox");i=this._getFormattedText(r.getSelectedItems()[0].value);n("#"+t._id+"_fdlg_nTab_sinput").val(i)},_dlgCFCancel:function(){var t=this.XLObj;n("#"+t._id+"_formatdlg").ejDialog("close");t.setSheetFocus()},_dlgCFOk:function(t){var i=this.XLObj,u=n("#"+i._id+"_fdlg_nTab_list").data("ejListBox"),r=n("#"+i._id+"_formatdlg_format_dataMnger").data();t&&u.model.value==="Custom"&&this._validateCustomFormat()||(i.getObjectLength(r.NumFormat)&&(i.XLFormat.format(r.NumFormat),i.model.showRibbon&&i.XLRibbon._updateRibbonIcons()),n("#"+i._id+"_formatdlg").ejDialog("close"),i.setSheetFocus())},_customFormatDelete:function(){var t=n("#"+this.XLObj._id+"_fdlg_nTab_customtypes").data("ejListBox"),i=t.model.dataSource;i.splice(t.model.selectedItemIndex,1);t._setModel({dataSource:i});t.selectItemByIndex(0);this._refreshFrmtPropChanges()},_validateCustomFormat:function(t){var i=t?this:this.XLObj,u,r,f,e=n("#"+i._id+"_fdlg_nTab_custominput").val(),o=i.XLFormat.customFormatParser(e);if(!t||t.keyCode===13)if(i.getObjectLength(o))u=n("#"+i._id+"_fdlg_nTab_customtypes").data("ejListBox"),r=u.model.dataSource,i._isValueAlreadyExist(r,"text",e)||(r.push({text:e,type:"custom"}),u._setModel({dataSource:r})),n("#"+i._id+"_formatdlg_format_dataMnger").data("NumFormat",o),t&&i.XLCellFrmtDlg._dlgCFOk();else return f=n("#"+i._id+"_alertdlg"),i._renderAlertDlgContent(f,"Alert",i._getLocStr("CustomFormatAlert")),f.ejDialog("open"),!0}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.shape=function(n){this.XLObj=n;this._imgX=0;this._imgY=0;this._imgOffsetleft=0;this._imgOffsetTop=0;this._shapeType="Img";this._shapeROStart=!1;this._shapeRSStart=!1;this._imgRSWStart=!1;this._imgRSEStart=!1;this._imgRSNStart=!1;this._imgRSSStart=!1;this._changePicture=!1;this._picCellIdx={};this._insertPic=!1};t.spreadsheetFeatures.shape.prototype={_insertPicture:function(i){var r=this.XLObj,f=r._browserDetails.name==="msie"&&parseInt(r._browserDetails.version)<10?i.responseText:i.xhr.response,o,h,c,l,u,v,e,s,y;if(f.startsWith("Invalid"))r._showAlertDlg("Alert","ImageValAlert");else if(o=r.getActiveSheetIndex(),h=r.getSheet(o),this._changePicture)u=r.getSheetElement(o).find(".e-ss-activeimg").get(0),c=u.offsetLeft,l=u.offsetTop,y=this._getCellIndexFromOffset(l,c),e=h._shapeMngr,n(u).css("background-image","url('"+f+"')"),s=e.picture[u.id],v={sheetIndex:o,reqType:"shape",shapeType:"picture",action:"changepic",id:n(u).attr("id"),cell:y,prev:{img:e.sharedPics[s.data],data:s.data,pcIdx:u.id},cur:{img:f,pcIdx:u.id}},e.sharedPics.indexOf(f)===-1&&e.sharedPics.push(f),s.data=e.sharedPics.indexOf(f),v.cur.data=s.data,this._changePicture=!1,r.setSheetFocus(),r._completeAction(v);else{var a=r.getActiveCell(),p=r.model.pictureSettings,w=p.height,b=p.width;t.isNullOrUndefined(a)&&(u=r.element.find(".e-ss-activeimg").get(0),y=this._getCellIndexFromOffset(u.offsetTop,u.offsetLeft));c=h._colWidthCollection[a.colIndex];l=h._rowHeightCollection[a.rowIndex];this._insertPic=!0;this._createPicture(o,a,f,l,c,b,w)}},setPicture:function(t,i,r,u,f,e){var o=this.XLObj,s,h,c,l,a,v;(n.isArray(t)?(s=t[0],h=t[1]):(c=o.getRangeIndices(t),s=c[0],h=c[1]),o.model.pictureSettings.allowPictures)&&(l=o.getActiveSheetIndex(),v=o.model.pictureSettings,u=u?u:v.height,r=r?r:v.width,o._isRowViewable(l,s)?(a=o.getCell(s,h)[0],f=f?f:a.offsetTop,e=e?e:a.offsetLeft):(f=f?f:0,e=e?e:0),this._createPicture(l,{rowIndex:s,colIndex:h},i,f,e,r,u))},_createPicture:function(i,r,u,f,e,o,s,h,c,l,a){var w,b,g,nt,p,k;c=c?c:"transparent";l=l?l:"solid";a=a?a:"1px";var v=this.XLObj,d=v.getSheet(i),y={sheetIndex:i,targetCell:r,top:f,left:e,width:o,height:s,bcolor:c,bstyle:l,bwidth:a,reqType:"picture",add:"add"};v._trigActionBegin(y)||(f=y.top,e=y.left,o=y.width,s=y.height,h=t.isNullOrUndefined(h)?v.model.allowCharts&&v.XLChart._shapeCnt:h,r||(r=this._getCellIndexFromOffset(f,e,i)),g=r.rowIndex,nt=r.colIndex,v._getContent(i).find(".e-content").append(t.buildTag("div.e-ss-object","","",{id:v._id+"_picture"+h})),w=n("#"+v._id+"_picture"+h),w.css({"background-image":"url('"+u+"')",height:s,width:o,left:e,top:f}),p=a+" "+l+" "+c,k=this._getImgBorderHashCode({"border-color":c,"border-style":l,"border-width":a}),v.model.allowCellFormatting&&v.XLFormat._writeCssRules(k,v.XLFormat._getCssPropertyAsString({border:{left:p,right:p,top:p,bottom:p}})),w.addClass(k),!v._isUndoRedo&&v.model.allowCharts&&v.XLChart._shapeCnt++,this._updateShapeMngr(r,{picture:{data:u,id:v._id+"_picture"+h,height:s,width:o,left:e,top:f,rowIndex:g,colIndex:nt}},"picture"),this._selectImg(w),v.setSheetFocus(),d._isImported&&!d._isLoaded||v._isUndoRedo||v._isPaste||v.XLClipboard._isShape||(b={sheetIndex:i,reqType:"shape",shapeType:"picture",action:"remove",id:v._id+"_picture"+h,actCell:r,img:u,cnt:h},b.position={top:f,left:e,height:s,width:o},v._completeAction(b)))},_shapeMouseDown:function(t){var i,f;t.preventDefault();i=this.XLObj;f=document.activeElement.id;(f.indexOf("pictureheight")>-1||f.indexOf("picturewidth")>-1)&&i.setSheetFocus();var u,s=t.target.id,r=n(t.target),h=r.get(0),e=h.offsetLeft,o=h.offsetTop,c=i._setXY(t);this._selectImg(r);this._picCellIdx=this._getCellIndexFromOffset(o,e);this._imgOffsetleft=e;this._imgOffsetTop=o;this._imgX=c[0];this._imgY=c[1];this._shapeType=s.indexOf("chart")>-1?"chart":"Img";r.css("cursor")==="move"?this._shapeROStart=!0:(r.css("cursor")==="col-resize"||r.css("cursor")==="row-resize")&&(this._shapeRSStart=!0,i._getContent(i.getActiveSheetIndex()).find(".e-ss-imgvisual").css({left:e,top:o,height:r.height(),width:r.width()}));this._shapeType==="chart"&&(u=i.XLChart._getShapeObj(s,this._shapeType),i.getActiveSheetIndex()===u.dataSheetIdx&&i.XLChart._focusChartRange(u.xAxis.range,u.yAxis.range,u.legend.range));i.model.enableContextMenu&&i.XLCMenu._isMenuOpened&&i.XLCMenu.hideCMenu()},_imgKeyDown:function(n){var r=this.XLObj,s=r.getActiveSheetIndex(),t=r._getContent(s).find(".e-ss-activeimg"),i=t.get(0),e=i.offsetLeft,o=i.offsetTop,u,f,h;if(this._shapeType=t[0].id.indexOf("chart")>-1?"chart":"Img",this._picCellIdx=this._getCellIndexFromOffset(o,e),n.shiftKey||n.ctrlKey)n.shiftKey&&!n.ctrlKey&&(n.keyCode===39||n.keyCode===38?(n.preventDefault(),u=t.height()+2,f=t.width()+2,u<400&&f<600&&t.css({width:f,height:u}),this._updateShapeObj(i),r.XLRibbon._formatTabUpdate()):(n.keyCode===37||n.keyCode===40)&&(n.preventDefault(),u=t.height()-2,f=t.width()-2,u>40&&f>60&&t.css({width:f,height:u}),this._updateShapeObj(i),r.XLRibbon._formatTabUpdate()));else{switch(n.keyCode){case 39:n.preventDefault();t.css({left:e+2});this._updateShapeObj(i);break;case 37:n.preventDefault();e>1&&t.css({left:e-2});this._updateShapeObj(i);break;case 38:n.preventDefault();o>1&&t.css({top:o-2});this._updateShapeObj(i);break;case 40:n.preventDefault();t.css({top:o+2});this._updateShapeObj(i)}this._onKeyscrollShape(s,t,n)}n.keyCode===46&&(n.preventDefault(),h=!1,r.XLClipboard._isShape&&(r.XLClipboard._isShape=!1,h=!0),this._deleteShape(s,t),h&&(r.XLClipboard._isShape=!0))},_shapeMouseUp:function(t){var h="chart",e,u=this.XLObj,o=u.getActiveSheetIndex(),c=u._getContent(o),r=c.find(".e-ss-activeimg"),s=c.find(".e-ss-imgvisual"),f=n(t.target),i=f.get(0);(f.hasClass("e-ss-picture")||f[0].id.indexOf(u._id+"_picture")>-1)&&u.model.showRibbon&&u.XLRibbon._formatTabUpdate();i.id.indexOf(h)>-1&&i.id.indexOf("Ribbon")<0&&(i=i.id.indexOf("_svg")>-1?n(i).parents(".e-ss-object").get(0):i);r.length<1&&(this._shapeROStart=!1);i.className.indexOf("e-ss-imgvisual")>-1||i.className.indexOf("e-ss-object")>-1||(this._shapeROStart&&(i=r[0]),this._shapeRSStart&&(i=s[0]));this._shapeROStart?(this.XLObj.model.allowAutoFill=!1,u._isUndoRedo||(parseInt(r.css("top"))!==i.offsetTop||parseInt(r.css("left"))!==i.offsetLeft)&&(e={sheetIndex:o,reqType:"shape",shapeType:"chart",action:"edit",actionType:"reorder",id:n(r).attr("id"),visualImg:s,trgt:f},e.prev={top:parseInt(r.css("top")),left:parseInt(r.css("left")),height:parseInt(r.css("height")),width:parseInt(r.css("width"))},e.cur={top:i.offsetTop,left:i.offsetLeft,height:f.height(),width:f.width()}),u._isUndoRedo||(parseInt(r.css("top"))!==i.offsetTop||parseInt(r.css("left"))!==i.offsetLeft)&&u._checkIndicesInContainer(o,this._picCellIdx.rowIndex,this._picCellIdx.colIndex)&&(e.obj=n.extend(!0,{},u._dataContainer.sheets[o][this._picCellIdx.rowIndex][this._picCellIdx.colIndex]),u._completeAction(e)),r.css({left:i.offsetLeft,top:i.offsetTop}),this._updateShapeObj(i),s.removeClass("e-ss-picture").hide()):this._shapeRSStart&&(u._isUndoRedo||(i.className.indexOf("e-ss-imgvisual")<0&&s.length>0&&this._shapeROStart&&(i=s[0]),f=n(i),(parseInt(r.css("height"))!==f.height()||parseInt(r.css("width"))!==f.width())&&u._checkIndicesInContainer(o,this._picCellIdx.rowIndex,this._picCellIdx.colIndex)&&(e={sheetIndex:o,reqType:"shape",shapeType:"chart",action:"edit",actionType:"resize",id:n(r).attr("id"),visualImg:s,trgt:f},e.prev={top:parseInt(r.css("top")),left:parseInt(r.css("left")),height:parseInt(r.css("height")),width:parseInt(r.css("width"))},e.cur={top:i.offsetTop,left:i.offsetLeft,height:f.height(),width:f.width()},e.obj=n.extend(!0,{},u._dataContainer.sheets[o][this._picCellIdx.rowIndex][this._picCellIdx.colIndex]),u._completeAction(e))),r.css({left:i.offsetLeft,top:i.offsetTop,height:f.height(),width:f.width()}),this._updateShapeObj(i),s.removeClass("e-ss-picture").hide(),this._shapeType==="Img"&&u.model.showRibbon&&u.XLRibbon._formatTabUpdate(),this._shapeType===h&&(u.XLChart.resizeChart(r.attr("id"),f.height(),f.width()),u.model.showRibbon&&u.XLRibbon._chartDesignTabUpdate(n("#"+r.attr("id")))));this._refreshImgResizing();this._shapeType="Img";this._shapeROStart=this._shapeRSStart=!1;this.XLObj.model.allowAutoFill=!0},_imgMouseMove:function(n){var o=this.XLObj;if(o._getContent(o.getActiveSheetIndex()).find(".e-ss-activeimg").length){n.preventDefault();var k=o.getActiveSheetIndex(),s=o._getContent(k),r=s.find(".e-ss-activeimg"),t=s.find(".e-ss-imgvisual"),l=r.get(0),e=l.getBoundingClientRect(),y=o._setXY(n),u=y[0],f=y[1],i,h,c;if(this._shapeROStart)t.show(),l.id.indexOf("picture")>-1&&t.addClass("e-ss-picture"),h=u-(this._imgX-this._imgOffsetleft),c=f-(this._imgY-this._imgOffsetTop),h>-1&&c>-1&&t.css({left:h,top:c,height:r.height(),width:r.width()});else{var a=t.width(),v=t.height(),p=l.offsetWidth,w=l.offsetHeight,b=s.find(".e-content"),d=s.find(".e-hscrollbar").data("ejScrollBar"),g=s.find(".e-vscrollbar").data("ejScrollBar");if(this._shapeRSStart){if(t.show(),l.id.indexOf("picture")>-1&&t.addClass("e-ss-picture"),r.css("cursor")==="col-resize"||r.css("cursor")==="row-resize")switch(!0){case this._imgRSWStart:i=this._imgX-u;h=t[0].offsetLeft-i;h>-1&&(t.css({width:a+i,left:h}),this._imgX=u);break;case this._imgRSEStart:i=this._imgX-u;o.model.scrollSettings.allowScrolling&&a-i+t[0].offsetLeft+5<b.width()+d.value()&&(t.css({width:a-i}),this._imgX=u);break;case this._imgRSNStart:i=this._imgY-f;c=t[0].offsetTop-i;c>-1&&(t.css({height:v+i,top:c}),this._imgY=f);break;case this._imgRSSStart:i=this._imgY-f;o.model.scrollSettings.allowScrolling&&v-i+t[0].offsetTop+5<b.height()+g.value()&&(t.css({height:v-i}),this._imgY=f)}}else this._refreshImgResizing(),u<=e.left+4&&u>=e.left?(r.addClass("e-ss-imgcresize"),this._imgRSWStart=!0):u<=e.left+p&&u>=e.left+p-4?(r.addClass("e-ss-imgcresize"),this._imgRSEStart=!0):s.find(".e-ss-imgcresize").removeClass("e-ss-imgcresize"),f<=e.top+4&&f>=e.top?(r.addClass("e-ss-imgrresize"),this._imgRSNStart=!0):f<=e.top+w&&f>=e.top+w-4?(r.addClass("e-ss-imgrresize"),this._imgRSSStart=!0):s.find(".e-ss-imgrresize").removeClass("e-ss-imgrresize")}}},_deleteShape:function(n,t){var c,i=this.XLObj,f=this._picCellIdx,v=i._dataContainer,l=i.getSheet(n),s=l._shapeMngr,u=v.sheets[n][f.rowIndex][f.colIndex],o,r=t.get(0).id.split("_")[1].replace(/[0-9]/g,""),h=t.get(0),a,e=s[r][u[r][0]];i._isUndoRedo||i._isPaste||i.XLClipboard._isShape||(o={sheetIndex:n,id:h.id,picIndex:h.id,reqType:"shape",shapeType:r,action:"create",options:e,range:e.range,img:s.sharedPics[e.data]},o.actCell={rowIndex:f.rowIndex,colIndex:f.colIndex},o.position={height:e.height,width:e.width,top:e.top,left:e.left},o.cnt=t.get(0).id.split("_")[1].replace(/[a-z]/g,""),i._completeAction(o));u[r].some(function(n,t){return h.id===s[r][u[r][t]].id?(a=t,!0):!1});Object.keys(u).length<2&&u[r].length<2?delete u:u[r].length<2?delete u[r]:u[r].splice(a,1);delete s[r][h.id];c={rowIndex:f.rowIndex,colIndex:f.colIndex};n===i._getSheetIndex()&&(i.setActiveCell(f.rowIndex,f.colIndex),i.performSelection(c,c));t.remove();i.model.allowFormulaBar&&i.updateFormulaBar();i.model.showRibbon&&(r==="picture"?i.XLRibbon._toggleFormatTab():i.XLRibbon._toggleChartDesignTab());l._isChartBorderDrawn&&i.XLChart._clearChartRange(i._arrayAsString(i._chartBorder))},_selectImg:function(n){this.XLObj._getContent(this.XLObj.getActiveSheetIndex()).find(".e-ss-activeimg").removeClass("e-ss-activeimg");n.addClass("e-ss-activeimg");this.XLObj.XLSelection._cleanUp(!0)},_refreshImgResizing:function(){this._imgRSEStart=!1;this._imgRSWStart=!1;this._imgRSNStart=!1;this._imgRSSStart=!1},_getShapePropeties:function(n,t,i){for(var r,u=this.XLObj.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,i);r in u;)return u[r].id===t?u[r]:void 0},_updateShapeMngr:function(t,i,r){var e,o={},u=this.XLObj,h=u.getActiveSheetIndex(),f=u.getSheet(h)._shapeMngr,s=f[r];s[i[r].id]=n.extend(!0,{},i[r]);r==="picture"&&(f.sharedPics.indexOf(i[r].data)<0&&f.sharedPics.push(i[r].data),e=f.sharedPics.indexOf(i[r].data),s[i[r].id].data=e);(!u._isPaste||this._insertPic||u.XLClipboard._isShape)&&(o[r]=i[r].id,u.XLEdit._updateDataContainer(t,{dataObj:o}),this._insertPic=!1)},_updateShapeObj:function(n){var u,f=this.XLObj,o=f.getActiveSheetIndex(),s=f._dataContainer,e,r,i=this._shapeType==="Img"?"picture":"chart",t=this._picCellIdx,c=f.getSheet(o)._shapeMngr,h,l={};(f.getObjectLength(this._picCellIdx)||(t=this._picCellIdx=this._getCellIndexFromOffset(n.offsetTop,n.offsetLeft)),u=f._getContent(o).find(".e-ss-activeimg"),r=s.sheets[o][t.rowIndex][t.colIndex],r&&r[i])&&(e=c[i][u[0].id],r[i].some(function(n,t){return u[0].id===c[i][r[i][t]].id?(h=t,!0):!1}),l[i]=r[i][h],f.getObjectLength(r)<2&&r[i].length<2?delete s.sheets[o][t.rowIndex][t.colIndex]:r[i].length<2?delete s.sheets[o][t.rowIndex][t.colIndex][i]:s.sheets[o][t.rowIndex][t.colIndex][i].splice(h,1),this._picCellIdx=t=this._getCellIndexFromOffset(n.offsetTop,n.offsetLeft),e.height=u.height(),e.width=u.width(),e.left=u[0].offsetLeft,e.top=u[0].offsetTop,e.rowIndex=t.rowIndex,e.colIndex=t.colIndex,f.XLEdit._updateDataContainer({rowIndex:t.rowIndex,colIndex:t.colIndex},{dataObj:l}))},_updateImgBorder:function(i,r,u,f){var e=this.XLObj,l=e.getActiveSheetIndex(),v=i.offsetLeft,y=i.offsetTop,a,p=this._getCellIndexFromOffset(y,v),w=e.getSheet(l)._shapeMngr,s,b,h=new RegExp("\\be-shapebdr.*?\\b","g"),o,c;s=w.picture[i.id];a={sheetIndex:l,reqType:"shape",shapeType:"picture",action:"border",id:n(e.getSheetElement(l).find(".e-ss-activeimg")).attr("id"),prevClass:t.isNullOrUndefined(i.className.match(h))?i.className:i.className.match(h)[0],picIdx:b,cellIdx:p};o=r+" "+u+" "+f;c=this._getImgBorderHashCode({"border-color":f,"border-style":u,"border-width":r});e.model.allowCellFormatting&&e.XLFormat._writeCssRules(c,e.XLFormat._getCssPropertyAsString({border:{left:o,right:o,top:o,bottom:o}}));s.bcolor=f;s.bstyle=u;s.bwidth=r;i.className.match(h)&&(i.className=i.className.replace(h,""));n(i).addClass(c);a.curClass=c;e._dupDetails||e._isUndoRedo||e._completeAction(a)},_getCellIndexFromOffset:function(n,i,r){var u,o,f=0,e={},h=this.XLObj,r=h._getSheetIndex(r),s=h.getSheet(r);if(!t.isNullOrUndefined(n))for(e.rowIndex=0,u=0,o=s.rowsHeightCollection.length;u<o;u++)if(f+=s.rowsHeightCollection[u],f>n){e.rowIndex=u;break}if(!t.isNullOrUndefined(i))for(e.colIndex=0,u=0,f=0,o=s.columnsWidthCollection.length;u<o;u++)if(f+=s.columnsWidthCollection[u],f>i){e.colIndex=u;break}return e},_getImgBorderHashCode:function(n){var i=this.XLObj,t="";return"border-width"in n&&(t=parseInt(n["border-width"])+"N"),i.model.allowCellFormatting&&"border-style"in n&&(t=t+i.XLFormat._getStyleCode("BorderStyle",n["border-style"])+"N"),"border-color"in n&&(t=t+n["border-color"].replace("#","")),"e-shapebdr"+t},_getImgStyleFromHashCode:function(n){var i=this.XLObj,t={};return n=n||"",n=n.replace("e-shapebdr","").split("N"),n.length>1&&(t["border-width"]=n[0]+"px",t["border-style"]=["","solid","dashed","dotted"][n[1]],t["border-color"]="#"+n[2]),t},_scrollShape:function(n,t,i,r){var f={position:"none",action:"none"},u=this.XLObj,e=u._getContent(n);parseInt(t.css("width"))+(t.offset().left-u._getContent(n).find(".e-content").offset().left)>u._getContent(n).find(".e-content").width()&&this._imgX<=i?f={position:"horizontal",action:"Increment"}:t.offset().left-e.find(".e-content").offset().left<=0?f={position:"horizontal",action:"Decrement"}:parseInt(t.css("height"))+(t.offset().top-u._getContent(n).find(".e-content").offset().top)>u._getContent(n).find(".e-content").height()&&this._imgY<=r?f={position:"vertical",action:"Increment"}:t.offset().top-e.find(".e-content").offset().top<=0&&(f={position:"vertical",action:"Decrement"});u.XLSelection._scrollCalculation(n,t.get(0),f)},_onKeyscrollShape:function(n,t,i){var r=this.XLObj,u=r._getContent(n).find(".e-content"),f=r._getContent(n).find("#hscrollBar").ejScrollBar("instance"),e=r._getContent(n).find("#vscrollBar").ejScrollBar("instance");u.offset().top+u[0].offsetHeight<=t.offset().top+t[0].offsetHeight&&(i.keyCode===40||i.keyCode===13&&!i.shiftKey)?e.scroll(e.value()+2,!0):t.offset().top-r.model.sheets[n]._frozenHeight<=u.offset().top&&(i.keyCode===38||i.keyCode===13&&i.shiftKey)&&e.value()-2>=0&&e.scroll(e.value()-2,!0);u[0].offsetWidth<=t.offset().left+t[0].offsetWidth&&(i.keyCode===39||i.keyCode===9&&!i.shiftKey)?f.scroll(f.value()+2,!0):t.offset().left-r.model.sheets[n]._frozenWidth<=u.offset().left&&(i.keyCode===37||i.keyCode===9&&i.shiftKey)&&f.value()-2>=0&&f.scroll(f.value()-2,!0)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.chart=function(n){this.XLObj=n;this._shapeCnt=1};t.spreadsheetFeatures.chart.prototype={createChart:function(n,i){if(this.XLObj.model.allowCharts){i=i||{};var o,e,f,v,c,u,s,r=this.XLObj,l="chart",a=r._getSheetIndex(i.sheetIdx),h=r.getSheet(a);(r._isUndoRedo&&(o=i.id.split("_")[1].replace(/[a-z]/g,"")),n=n?r.getRangeIndices(n):h.selectedRange,t.isNullOrUndefined(i.top)||t.isNullOrUndefined(i.left)||(i.activeCell=r.XLShape._getCellIndexFromOffset(i.top,i.left)),i.activeCell||(i.activeCell=h._activeCell),r.isRange(n)&&i.activeCell)&&(c=r._getCellInfo(i.activeCell),i.id=o?r._id+"_"+l+o:r._id+"_"+l+this._shapeCnt,i.type=i.type?i.type:"column",i.animation=i.animation?i.animation:!1,i.range=n,i.dataSheetIdx=i.dataSheetIdx?i.dataSheetIdx:a,i.height=i.height?i.height:r.model.chartSettings.height,i.width=i.width?i.width:r.model.chartSettings.width,i.top=i.top?i.top:c.top+2,i.left=i.left?i.left:c.left+2,i.isRowColSwitched=i.isRowColSwitched?i.isRowColSwitched:!1,r.isUndefined(i.xRange)&&(s=this._processChartrange(n,i.dataSheetIdx),i.xRange=s.xRange,i.yRange=s.yRange,i.lRange=s.lRange),f=this._processChartSeries(i),i.xRange=f.xRange,i.yRange=f.yRange,i.lRange=f.lRange,r.getActiveSheetIndex()===i.dataSheetIdx&&this._focusChartRange(f.xRange,f.yRange,f.lRange),e=this._renderBaseElem(l,i.top,i.left,o),e.ejChart(this._processChartOptions(i,f.series)),u=e.ejChart("model"),i.theme=u.theme,i.title={text:u.title.text.length?u.title.text:""},i.xAxis={min:u.primaryXAxis.range.min,max:u.primaryXAxis.range.max,interval:u.primaryXAxis.range.interval,title:{text:u.primaryXAxis.title.text.length?u.primaryXAxis.title.text:""},range:f.xRange},i.yAxis={min:u.primaryYAxis.range.min,max:u.primaryYAxis.range.max,interval:u.primaryYAxis.range.interval,title:{text:u.primaryYAxis.title.text.length?u.primaryYAxis.title.text:""},range:f.yRange},i.legend={visible:u.legend.visible,range:f.lRange},r.XLShape._updateShapeMngr(i.activeCell,{chart:i},"chart"),i.theme.indexOf("dark")>-1&&e.addClass("e-ss-charttheme"),r.model.showRibbon&&!i.hideTab&&r.XLRibbon._chartDesignTabUpdate(e),r._on(e,t.eventType.mouseDown,r._mouseDownHandler),r._on(e,t.eventType.mouseMove,r._mouseMove),r.setSheetFocus(),h._isImported&&!h._isLoaded||r._isUndoRedo||r._isPaste||r.XLClipboard._isShape||(v={sheetIndex:a,reqType:"shape",shapeType:"chart",action:"remove",options:i,range:i.range,id:i.id,position:{top:i.top,left:i.left}},r._completeAction(v)))}},resizeChart:function(i,r,u){var f={},e=n("#"+i);e.length&&(t.isNullOrUndefined(r)||(f.height=r.toString()),t.isNullOrUndefined(u)||(f.width=u.toString()),e.ejChart("option",{size:f}))},refreshChart:function(t,i){if(this.XLObj.model.allowCharts){var r,u="marker",f=this._getShapeObj(t,"chart");if(f){for(r in i)f[r]=i[r];i.type&&(i.commonSeriesOptions={type:i.type},delete i.type);u in i&&(i.commonSeriesOptions?i.commonSeriesOptions.marker={visible:i.marker.visible}:i.commonSeriesOptions={marker:i.marker},delete i[u]);n("#"+t).ejChart("option",i)}}},_processChartOptions:function(n,t){var r=yVisiblity=!1,i={commonSeriesOptions:{type:n.type,enableAnimation:n.animation},series:t,canResize:!0,size:{height:n.height.toString(),width:n.width.toString()},enableRotation:!1,depth:100,wallSize:2,tilt:0,rotation:34,perspectiveAngle:90,sideBySideSeriesPlacement:!0,seriesRendering:this.XLObj.model.seriesRendering};return n.enable3D&&(i.enable3D=!0),n.marker&&(i.commonSeriesOptions.marker=n.marker),n.theme&&(i.theme=n.theme),i.title=n.title||{},i.legend=n.legend||{},n.xAxis&&n.xAxis.minorGridLines&&(r=n.xAxis.minorGridLines.visible),n.yAxis&&n.yAxis.minorGridLines&&(yVisiblity=n.yAxis.minorGridLines.visible),i.primaryYAxis=n.primaryYAxis||{minorTicksPerInterval:5,minorGridLines:{visible:yVisiblity},minorTickLines:{visible:!1}},i.primaryXAxis=n.primaryXAxis||{minorTicksPerInterval:5,minorGridLines:{visible:r},minorTickLines:{visible:!1},valueType:"category"},i},_processChartrange:function(n,i){var s=this.XLObj,l,f,h,r=n[0],u=n[1],o=n[2],e=n[3],c=s.XLEdit.getPropertyValue(r,e,null,i),y=s.XLEdit.getPropertyValue(o,u,null,i),p=s.XLEdit.getPropertyValue(r,u,null,i),a=r===o,v=u===e;return!s.isUndefined(p)||a||v?t.isNullOrUndefined(y)||s.isNumber(y)||a||v?(f=[r,u,o,e],t.isNullOrUndefined(c)||s.isNumber(c)||s._isDateTime(c)?t.isNullOrUndefined(p)&&(a||v)&&(h=[r,u,r,e],a?(f[1]=f[1]+1,h[3]=h[1]):f[0]=f[0]+1):(h=[r,u,r,e],f[0]=f[0]+1)):t.isNullOrUndefined(c)||s.isNumber(c)?(l=[r,u,o,u],f=[r,u+1,o,e]):(l=[r+1,u,o,u],f=[r+1,u+1,o,e],h=[r,u+1,r,e]):(l=[r+1,u,o,u],f=[r+1,u+1,o,e],h=[r,u+1,r,e]),{xRange:l,yRange:f,lRange:h}},_processChartSeries:function(n){n=n||{};var t=this.XLObj,a,b,i=n.xRange,r=n.yRange,u=n.lRange,f,k,e,o,v,y,p,w,s,d,h=0,c=0,g=[],l=["value2"];for(k=t.getRangeData(r,!0,null,n.dataSheetIdx,!1,!0),v=r[2]-r[0]+1,y=r[3]-r[1]+1,n.isRowColSwitched?(f=u?t._toArrayData(t.getRangeData(u,!1,l,n.dataSheetIdx)):this._getVirtualXValues(y+1),i&&(e=t._toArrayData(t.getRangeData(i,!1,l,n.dataSheetIdx))),o=v):(f=i?t._toArrayData(t.getRangeData(i,!1,l,n.dataSheetIdx)):this._getVirtualXValues(v+1),u&&(e=t._toArrayData(t.getRangeData(u,!1,l,n.dataSheetIdx))),o=y),b=f.length,d=n.isRowColSwitched?1:o;h<o;){for(s=0,p=[],c=n.isRowColSwitched?c:h;s<b;)a=k[c],p.push({x:f[s],y:t.isNumber(a)?Number(a):0}),c+=d,s++;w={points:p};e&&(w.name=e[h]);g.push(w);h++}return{series:g,xRange:n.isRowColSwitched?u:i,yRange:r,lRange:n.isRowColSwitched?i:u}},_getVirtualXValues:function(n){for(var t=1,i=[];t<n;)i.push(t.toString()),t++;return i},_focusChartRange:function(n,t,i){var r=this.XLObj,u=r._chartBorder;this._clearChartRange(r._arrayAsString(u));i&&r.XLSelection._focusBorder({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]},u[0]);n&&r.XLSelection._focusBorder({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]},u[1]);r.XLSelection._focusBorder({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]},u[2]);r.getSheet(r.getActiveSheetIndex())._isChartBorderDrawn=!0},_clearChartRange:function(n){var t=this.XLObj;t.XLSelection._clearBorder(n);t.getSheet(t.getActiveSheetIndex())._isChartBorderDrawn=!1},_renderBaseElem:function(i,r,u,f){f=t.isNullOrUndefined(f)?this._shapeCnt:f;var e=this.XLObj,o=n("<div id='"+e._id+"_"+i+f+"' class='e-ss-object' style='top:"+r+"px;left:"+u+"px' ><\/div>");return e._getContent(e.getActiveSheetIndex()).find(".e-content").append(o),e.XLShape._selectImg(o),e._isUndoRedo||this._shapeCnt++,o},_refreshChartElements:function(n,t,i){for(var u,f,r,e=this.XLObj,o=1,s=e.model.sheetCount+1;o<s;){if(u=e.getSheet(o)._shapeMngr.chart,f=e.getObjectLength(u),f)while(f--)r=u[Object.keys(u)[f]],r.dataSheetIdx===i&&(this.XLObj.inRange(r.range,n,t)||this.XLObj._inRow(r.range,n)||this.XLObj._inColumn(r.range,t))&&this._refreshChart(r);o++}},_refreshChart:function(t){if(n("#"+t.id).length!==0){var i=n("#"+t.id).data("ejChart"),u={xRange:t.xRange,yRange:t.yRange,lRange:t.lRange,isRowColSwitched:t.isRowColSwitched,dataSheetIdx:t.dataSheetIdx},r;i.model.series.length=0;r=this._processChartSeries(u);i.option({series:r.series})}},_getShapeObj:function(n,t){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex())._shapeMngr[t],u=i.getObjectLength(r);if(u)return r[n]},_validateChartRange:function(n,t,i,r){var u=this.XLObj;if(!i)return{msg:u._getLocStr("YAxisMissing")};if(!(u.inRange(n,i[0],i[1])||u.inRange(n,i[2],i[3])))return{msg:u._getLocStr("InvalidYAxis")};if(t)if(u.inRange(n,t[0],t[1])||u.inRange(n,n[2],n[3])){if(t[3]-t[1]!=0)return{msg:u._getLocStr("InvalidXAxisColumns")}}else return{msg:u._getLocStr("InvalidXAxis")};return r&&!(u.inRange(n,r[0],r[1])||u.inRange(n,r[2],r[3]))?{msg:u._getLocStr("InvalidLegend")}:{status:!0}},_renderChartRangeDialog:function(){var t=this.XLObj,i={width:"25%",showRoundedCorner:!0,click:n.proxy(this._chartRangeDlgBtnClick,this)},r=n("<div id='"+t._id+"_chartrangedlg'><div class='e-dlgctndiv e-dlg-fields'><table cellpadding='0' cellspacing='0'><tr class='e-dlgtd-fields'><td>"+t._getLocStr("XAxisRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_crxaxis'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+t._getLocStr("YAxisRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_cryaxis' /><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+t._getLocStr("LegendRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_crlaxis'/><\/td><\/tr><\/table><\/div><div class='e-dlg-btnfields' ><div class='e-dlg-btnctnr'><button id='"+t._id+"_crok' >"+t._getLocStr("Ok")+"<\/button><button id='"+t._id+"_crcancel'>"+t._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>");t.element.append(r);r.ejDialog({width:310,height:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,cssClass:"e-ss-dialog e-"+t._id+"-dlg",title:t._getLocStr("ChartRange")});n("#"+t._id+"_crok").ejButton(i);n("#"+t._id+"_crcancel").ejButton(i)},_chartRangeDlgBtnClick:function(t){var r,u,f,e,i=this.XLObj,o=i._getSheetIndex(i.getActiveSheetIndex()),s=i.getSheet(o),h,c;t.model.text===i._getLocStr("Ok")&&(r=document.getElementById(i._id+"_chart").value,u=n("#"+i._id+"_crxaxis").val(),f=n("#"+i._id+"_cryaxis").val(),e=n("#"+i._id+"_crlaxis").val(),c={xRange:u,yRange:f,lRange:e},this._processChartRange(u,f,e,r));!0&&n("#"+i._id+"_chartrangedlg").ejDialog("close");s._isImported&&!s._isLoaded||i._isUndoRedo||(h={sheetIndex:o,reqType:"shape",shapeType:"chart",action:"selectData",id:r,prev:i._selectDataval,cur:c},i._completeAction(h))},_processChartRange:function(t,i,r,u){var l,e,o=this.XLObj,a,s,h,c,f;e=this._getShapeObj(u,"chart");t.length&&(s=o.getRangeIndices(t));i.length&&(h=o.getRangeIndices(i));r.length&&(c=o.getRangeIndices(r));l=this._validateChartRange(e.range,s,h,c);l.status?(e.xRange=s,e.yRange=h,e.lRange=c,this._refreshChart(e),f=n("#"+u).ejChart("model"),e.xAxis={min:f.primaryXAxis.range.min,max:f.primaryXAxis.range.max,interval:f.primaryXAxis.range.interval,title:{text:f.primaryXAxis.title.text.length?f.primaryXAxis.title.text:""},range:s},e.yAxis={min:f.primaryYAxis.range.min,max:f.primaryYAxis.range.max,interval:f.primaryYAxis.range.interval,title:{text:f.primaryYAxis.title.text.length?f.primaryYAxis.title.text:""},range:h},e.legend={visible:f.legend.visible,range:c},o.getActiveSheetIndex()===e.dataSheetIdx&&this._focusChartRange(s,h,c)):(a=!1,o._showAlertDlg("Alert","T-"+l.msg,"",400))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.print=function(n){this.XLObj=n;this._printHeight=950;this._pageHeight=970;this._pageWidth=750;this._marginTop=30;this._marginBottom=150;this._printRowLabels=!1;this._isPrintSelection=!1;this._stRow=0;this._stColumn=0};t.spreadsheetFeatures.print.prototype={_printSetting:function(n){this.XLObj.model.pageSize=n;switch(n){case t.Spreadsheet.pageSize.A4:this._printHeight=950;this._pageHeight=970;this._pageWidth=750;this._marginTop=30;this._marginBottom=150;break;case t.Spreadsheet.pageSize.A3:this._printHeight=1350;this._pageHeight=1330;this._pageWidth=860;this._marginTop=30;this._marginBottom=150;break;case t.Spreadsheet.pageSize.Letter:this._printHeight=1040;this._pageHeight=920;this._pageWidth=860;this._marginTop=30;this._marginBottom=60}},printSelection:function(){var i=this.XLObj;if(i.model.printSettings.allowPrinting){var e,h,u=i.getActiveSheetIndex(),s=i.getSheet(u)._selectedCells,r=s[0],o=s[s.length-1],c=o.colIndex-r.colIndex,f=t.buildTag("table"),l=t.buildTag("colgroup"),v=i._getContent(u).find("col"),a=t.buildTag("div#printDiv");for(i._refreshTemplates(u,!0,r.colIndex,r.colIndex+c+1),i._isPrint=!0,e=r.colIndex;e<o.colIndex;e++)n(v[e].outerHTML).attr("id","cc").appendTo(l);h=i.getRangeData([r.rowIndex,r.colIndex,o.rowIndex,o.colIndex],null,["value","value2","format","border","type","isFilterHide","isRHide","isFHide","isMHide","merge","hRow","wrap","overflow","align","hyperlink"],u,!1,!1,!1,null,null,!0);f.html(i._renderData(h,u,r.colIndex,c+1,!0));l.insertBefore(f.find("tbody"));this._stRow=r.rowIndex;this._stCol=r.colIndex;this._isPrintSelection=!0;i._isPrint=!1;this._printRowLabels?this._calculateTabCount(a,u,f):this._constructSheet(a,u,f,f[0].rows);i._refreshTemplates(u,!0)}},printSheet:function(){var i=this.XLObj;if(i.model.printSettings.allowPrinting){var e,o,s,h=t.buildTag("div#printDiv"),r=i.getActiveSheetIndex(),u=i.getSheet(r),l=u.columnsWidthCollection,a=i._getContent(r).find("col"),f=t.buildTag("table"),c=t.buildTag("colgroup");for(i._refreshTemplates(r,!0,0,u._usedRange.colIndex+1),i._isPrint=!0,e=0,o=l.length;e<o;e++)n(a[e].outerHTML).attr("id","cc").appendTo(c);s=i.getRangeData([0,0,u._usedRange.rowIndex,u._usedRange.colIndex],null,["value","value2","format","border","type","isFilterHide","isRHide","isFHide","isMHide","merge","hRow","wrap","overflow","align","hyperlink"],r,!1,!1,!1,null,null,!0);f.html(i._renderData(s,r,0,u._usedRange.colIndex+1,!0));c.insertBefore(f.find("tbody"));this._printRowLabels?this._calculateTabCount(h,r,f):this._constructSheet(h,r,f,f[0].rows);i._isPrint=!1;i._refreshTemplates(r,!0)}},_calculateTabCount:function(n,t,i){for(var s,u=this.XLObj,e=[],f=0,o=u.getSheet(u.getActiveSheetIndex()).columnsWidthCollection,r=0,h=o.length;r<h;r++)f+=o[r],f>=this._pageWidth&&(e.push({tCount:1,cellCount:r}),f=0);s={xlObj:u,element:e,table:i,printDiv:n,Index:t};this.XLObj._trigger("beforePrint",s)},_calculateCellRowCount:function(n,t,i){for(var f=this.XLObj,b=f.getActiveSheetIndex(),w=f.getSheet(b),s=w.columnsWidthCollection,h=w.rowsHeightCollection,e,c=0,l=0,a=12,v=40,y=0,p=0,u,r=t,o=s.length;r<o;r++)if(c+=s[r],c>=this._pageWidth){p=a=r;break}else e=Math.floor((this._pageWidth-c)/f.model.columnWidth),p=a=s.length+e;for(u=i,o=h.length;u<o;u++)if(l+=h[u],l>=this._pageHeight){y=v=u;break}else e=Math.floor((this._pageHeight-l)/f.model.rowHeight),y=v=h.length+e;return{startCell:t,endCell:p,startRow:i,endRow:y,cellCount:a,rowCount:v}},_constructSheet:function(n,i,r,u){var h=t.buildTag("div .e-spreadsheet","",{}),e=0,f=this._calculateCellRowCount(u,0,0),o=u[0].cells.length,s=u.length;e=Math.ceil(o/f.cellCount);e=e*Math.ceil(s/f.rowCount);e==1&&(f.rowCount=u.length);this._constructPrintableElement(i,n,h,r,u,s,o,e,f.cellCount,f.rowCount,f.startRow,f.startCell,f.endRow,f.endCell)},_constructPrintableElement:function(i,r,u,f,e,o,s,h,c,l,a,v,y,p){for(var ft,ct,d,lt,et=!1,ut,k=this.XLObj,g=k.getSheet(i),at=t.buildTag("div"),nt,vt,ot=!1,st,ht=!0,yt=!1,pt=!1,wt=0,tt,w,it,rt,bt,b,gt=k._getContent(i).find("col"),ni=g.columnsWidthCollection,dt=g.rowsHeightCollection,kt=h;kt>0;kt--){for(nt=this._calculateCellRowCount(e,v,a),v=nt.startCell,p=nt.endCell,a=nt.startRow,y=nt.endRow,c=nt.cellCount,l=nt.rowCount,ut=this._constructTable(i,v,p),g.showHeader&&this._constructHeaders(v,p,y,ut),vt=this._isPrintSelection?a<this._stRow?this._stRow:a:a,w=a;w<y;w++){for(t.isNullOrUndefined(f[0].rows[w])?(ht=!1,d=t.buildTag("tr","",{height:k.model.rowHeight})):(st=dt[w],ht=!0,d=st>0?t.buildTag("tr","",{height:st}):t.buildTag("tr","",{height:k.model.rowHeight})),ht&&(yt=k.XLEdit.getPropertyValue(w,0,"isRHide"),t.isNullOrUndefined(yt)||k.addClass(d[0],"e-r-hide")),it=v;it<p;it++)g.showHeader&&!et&&(lt='<td class="{0}">{1}<\/td>',n(String.format(lt,"e-rowcell e-header",vt+w+1)).appendTo(d),et=!0),n(e[w]).length>0&&n(e[w].cells[it]).length>0?(rt=n(e[w].cells[it].outerHTML).attr("id","ss"),rt.appendTo(d)):(rt=t.buildTag("td.e-rowcell"),rt.appendTo(d)),pt=k.XLEdit.getPropertyValue(0,it,"isCHide"),t.isNullOrUndefined(pt)||k.addClass(rt[0],"e-col-hide");et=!1;ut.append(d)}if(r.append(ut),y<o)a=y,y=y+l;else if(y>=o){if(p>=s)break;a=0;y=l;v=p;p=p+c}}for(w=r.find("table").length-1;w>=0;--w)tt=n(r.find("table")[w]),ot||this._checkEmptyRow(i,tt,"first"),wt=g.showHeader?tt.find("tr.empty").length+1:tt.find("tr.empty").length,(tt.find("tr").length!==wt||ot)&&(n(tt.get(0).outerHTML).attr("id","cc").appendTo(at),ot=!0);for(b=at.find("table"),w=b.length-1;w>=0;--w)b.length-1!==w?(k.model.pageSize===t.Spreadsheet.pageSize.A4&&b.eq(w).css({"margin-top":300,"margin-bottom":300}),k.model.pageSize===t.Spreadsheet.pageSize.A3&&b.eq(w).css({"margin-top":120,"margin-bottom":110}),k.model.pageSize===t.Spreadsheet.pageSize.Letter&&(g.showHeader?b.eq(w).css({"margin-top":70,"margin-bottom":50}):b.eq(w).css({"margin-top":0,"margin-bottom":50}))):b.length-1===w&&(g.showHeader?b.eq(w).css({"margin-top":30,"margin-bottom":20}):b.eq(w).css({"margin-top":30,"margin-bottom":0})),w===0&&(b.length>1&&b.eq(w).css({"margin-top":120,"margin-bottom":0}),this._checkEmptyRow(i,b.eq(w),"last")),n(b[w].outerHTML).attr("id","cc").appendTo(u);for(ft=n("head").find("link"),ct=[],w=0,bt=ft.length;w<bt;w++)if(ft[w].href.indexOf("ej.pivotintegration.css")>-1){ct.push(ft[w]);break}k._trigger("_pivotPrint",{element:u});this._isPrintSelection=!1;this.print(u,ct,i)},_checkEmptyRow:function(t,i,r){for(var o,e,f=i.find("tr"),s,h,c,u=f.length-1;u>=0;--u)if(o=n(f[u]).find(".e-rowcell").length,e=n(f[u]).find(".e-rowcell:empty").length,e=this.XLObj.model.sheets[t].showHeader?e+1:e,s=n(f[u]).find('td[class *= "e-format"]').length,h=n(f[u]).find('td[class *= "e-border"]').length,c=n(f[u]).find('td[class *= "e-mc-hide"]').length,e===o&&s<1&&h<1&&c<1)n(f[u]).addClass("empty");else{n(f[u]).addClass("nonempty");break}r==="last"&&(i.find("tr.empty").find("td").removeClass("e-rowcell"),i.find("tr.empty").find("td.e-header").text(""))},_constructTable:function(i,r,u){var e=t.buildTag("colgroup"),s=this.XLObj,l=t.buildTag("div","",{height:this._printHeight,"margin-top":this._marginTop,"margin-bottom":this._marginBottom}),h=t.buildTag("table.e-table","",{height:this._printHeight,"margin-top":this._marginTop,"margin-bottom":this._marginBottom}),c=s._getContent(s.getActiveSheetIndex()).find("col"),o,f;for(s.model.sheets[i].showHeader&&(o='<col class="{0}" style= "width: 30px;" >{1}<\/col>',n(o).appendTo(e)),f=r;f<u;f++)n(c[f]).length>0?n(c[f].outerHTML).attr("id","cc").appendTo(e):(o='<col style= "width: 64px;" ><\/col>',n(o).appendTo(e));return h.append(e),l.append(h),h},_constructHeaders:function(i,r,u,f){var o=this.XLObj,h=o.getActiveSheetIndex(),c=t.buildTag("tr","",{height:30}),l,a,s,v,y,p=!1,b=o._getContent(h).find("col"),w="e-rowcell",e;for(this._isPrintSelection&&i<this._stCol&&(r=r+(this._stCol-i),i=this._stCol),l='<td class="{0}">{1}<\/td>',a='<div class = "{0}" > {1}<\/div>',e=i;e<=r;e++)p?(s=o._generateHeaderText(h,e),w=t.isNullOrUndefined(o.XLEdit.getPropertyValue(0,e-1,"isCHide"))?"e-rowcell e-headercell":"e-rowcell e-col-hide"):(s="",p=!0),v=String.format(a,"e-headercelldiv",s),y=String.format(l,w,v),n(c[0]).append(y);f.append(c)},print:function(i,r,u){var s=this.XLObj,f,e,c,o,h,l;s.model.printSettings.allowPrinting&&((f=window.open("","print","'height=452,width=1024,tabbar=no"),s.isUndefined(f))||(h=t.buildTag("div"),l=i.clone(),h.append(l),f.document.write("<!DOCTYPE html>"),s._browserDetails.name==="msie"?(o="",r.length>0&&n(r).each(function(t,i){n(i).attr("href",i.href);o+=i.outerHTML}),f.document.write("<html><head><\/head><body>"+o+h[0].innerHTML+"<\/body><\/html>")):(o="",f.document.write("<html><head>"),r.length>0&&n(r).each(function(t,i){n(i).attr("href",i.href);o+=i.outerHTML}),f.document.writeln(o+"<\/head><body>"),f.document.writeln(h[0].innerHTML+"<\/body><\/html>")),n(f.document.head).append("<style><\/style>"),e=s.model.sheets[u].showGridlines?".e-spreadsheet .e-table{table-layout: fixed; width: 100%;}.e-spreadsheet .e-rowcell {border: 1px solid #000000;line-height: 14px;overflow: hidden;white-space: pre;vertical-align: bottom;}.e-spreadsheet .e-table{border-collapse: collapse}":".e-spreadsheet .e-table{table-layout: fixed; width: 100%;}.e-spreadsheet .e-rowcell {line-height: 14px;overflow: hidden;white-space: pre;vertical-align: bottom;}.e-spreadsheet .e-table{border-collapse: collapse}",e=e.concat(n(document).find("style#"+this.XLObj._id+"_sscustomformat").text()),c=n(f.document.head).find("style"),e=e.concat(".e-spreadsheet .e-fr-hide { display: none !important;}.e-spreadsheet .e-fc-hide { display: none !important;}.e-spreadsheet .e-sswraptext {word-break: break-all; white-space: normal;}.e-spreadsheet .e-headercell{text-align:center;}.e-spreadsheet .e-ralign{text-align:right;}.e-spreadsheet .e-calign{text-align:center;}"),e=e.concat(".e-spreadsheet .e-hyperlinks { text-decoration: underline;}"),c.append(e),f.focus(),n("#print").remove(),setTimeout(function(){t.isNullOrUndefined(f.window)||(t.isNullOrUndefined(f.location)||(f.print(),f.location.reload()),setTimeout(function(){f.close()},2e3))},2e3)))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.scroller=function(n){this.XLObj=n};t.spreadsheetFeatures.scroller.prototype={_getColWidths:function(n,t){var i,e=this.XLObj,f=e.getSheet(n),u=f.columnsWidthCollection,r=f._colWidthCollection;for(t||(t=1),i=t,len=u.length;i<len;i++)r[i]=r[i-1]+u[i-1];r[r.length-1]=r[r.length-2]+u[u.length-1]},_getRowHeights:function(n,t){var i,f=this.XLObj,e=f.getSheet(n),u=e.rowsHeightCollection,r=e._rowHeightCollection;for(t||(t=1),i=t,len=u.length;i<len;i++)r[i]=r[i-1]+u[i-1];r[r.length-1]=r[r.length-2]+u[u.length-1];f.model.scrollSettings.allowVirtualScrolling&&f._refreshVrtlBlocks(n);this._refreshScroller(n,"refresh","vertical")},_createScroller:function(i,r){var u=this.XLObj,f=u._getContent(i),e=t.buildTag("div#vscrollBar"),o=t.buildTag("div#hscrollBar"),s=u.getSheet(i);f.append(e).append(o);s._contWidth=r.width-18;f.find(".e-content").width(s._contWidth).height(r.height-19);e.ejScrollBar({orientation:"vertical",height:r.height-18,minimum:0,viewportsize:r.height,infiniteScrolling:!0,scroll:n.proxy(this._scrollSpreadY,this)});o.ejScrollBar({orientation:"horizontal",width:r.width-17,minimum:0,infiniteScrolling:!0,viewportsize:r.width,scroll:n.proxy(this._scrollSpreadX,this)});this._refreshScroller(i,"initial","all")},_hScroller:function(n){return this.XLObj._getContent(n).find("#hscrollBar").data("ejScrollBar")},_vScroller:function(n){return this.XLObj._getContent(n).find("#vscrollBar").data("ejScrollBar")},_refreshScroller:function(n,t,i){var v=this.XLObj,f=v.getSheet(n),r=this._hScroller(n),y,p,l=f.columnWidth,a=f.rowHeight,u=this._vScroller(n),s,e,h,o,w=v._getContent(n),c;if(i==="all"||i==="horizontal"){if(s=w.find(".e-content").width(),e=f._colWidthCollection[f._colWidthCollection.length-1]+18-f._frozenWidth,e<s+2*l)for(y=Math.floor((s+l*5-e)/l),c=0;c<y;c++)this._createNewColumn(n,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert"),e=e+l;r._scrollData.handleSpace=s-2*r.model.buttonSize;r._scrollData.handle=Math.floor((s-2*r.model.buttonSize)/e*r._scrollData.handleSpace);r._scrollData.handle<15&&(r._scrollData.handle=15);r.model.maximum=e-(s-2*r.model.buttonSize);r._scrollData.scrollable=e-(s-2*r.model.buttonSize);r._scrollData.onePx=r._scrollData.scrollable/(r._scrollData.handleSpace-r._scrollData.handle);r["e-hhandle"].width(r._scrollData.handle);r.model.scrollLeft=r._scrollData.handleSpace-r._scrollData.handle}if(i==="all"||i==="vertical"){if(h=w.find(".e-content").height(),o=f._rowHeightCollection[f._rowHeightCollection.length-1]+18-f._frozenHeight,o<h+2*a)for(p=Math.floor((h+a*5-o)/a),c=0;c<p;c++)this._createNewRow(n,-1,-1,"insert"),o=o+a;u._scrollData.handleSpace=h-2*u.model.buttonSize;u._scrollData.handle=Math.floor((h-18)/o*u._scrollData.handleSpace);u._scrollData.handle<15&&(u._scrollData.handle=15);u.model.maximum=o-(h-2*r.model.buttonSize);u._scrollData.scrollable=o-(h-2*r.model.buttonSize);u._scrollData.onePx=u._scrollData.scrollable/(u._scrollData.handleSpace-u._scrollData.handle);u["e-vhandle"].height(u._scrollData.handle);u.model.scrollTop=u._scrollData.handleSpace-u._scrollData.handle}},_changeTopSpread:function(n,t,i,r){var f=n.value(),u=f+i;t.step=i;(t.enableRTL?u<t.scrollable:u>t.scrollable)&&(u=t.scrollable);(t.enableRTL?u>0:u<0)&&(u=0);n.scroll(u,r)},_spreadMouseWheel:function(i){var r=this.XLObj,f;if(i.stopImmediatePropagation(),i.preventDefault(),!r.element.find(".e-excelfilter.e-dlgcontainer").is(":visible")&&!r._isSubMenuOpen()&&!r._isSheetRename){this.XLObj.XLComment._isCommentEdit&&(f=this.XLObj.getActiveCell(),t.isNullOrUndefined(f)||this.XLObj.XLComment._updateCurCmntVal({rowIndex:f.rowIndex,colIndex:f.colIndex}));r.model.allowDataValidation&&n("#"+r._id+"ddl").ejDropDownList("hidePopup");var u=0,o=i,e=this._vScroller(r.getActiveSheetIndex());(i=i.originalEvent,i.wheelDelta?(u=-i.wheelDelta/120,window.opera&&parseFloat(window.opera.version,10)<10&&(u=-u)):i.detail&&(u=i.detail/3),u)&&this._changeTopSpread(e,e._scrollData,u*e._scrollData.scrollOneStepBy,"wheel")&&(i.preventDefault?i.preventDefault():o.preventDefault())}},_scrollSpreadX:function(n){this._spreadHS(n)},_scrollDirection:function(n,t){var i=this.XLObj,n=i._getContent(i.getActiveSheetIndex()).find("#"+n).ejScrollBar("instance");n.value()<t?n._scrollData.step=1:n.value()>t&&(n._scrollData.step=-1);n.scroll(t)},_spreadHS:function(n){var i=this.XLObj,r=i.getActiveSheetIndex(),o=i.getSheet(r),e,u=this._hScroller(r),f=i._getContent(r),c=f.find("col"),o=i.model.sheets[r];if(n.reachedEnd=Math.ceil(parseFloat(u.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(u.element.find(".e-hhandle").width()))>=i.element.find(".e-hhandlespace").width()-2,e=n.scrollLeft,i.model.enableContextMenu&&i.XLCMenu.hideCMenu(),i.getFrozenColumns(r)>0&&!i.XLCellNav._scrollReverse&&(n.cancel=!0,n.scrollData!=null&&n.scrollData.dimension!="height"&&(!n.reachedEnd||n.scrollData.step<0))){var l=i.XLFreeze._getLeftColumn(e,r),s=l.imaginaryIndex,v=i._getJSSheetHeader(r).find("col"),y=f.find(".e-table").width(),p=f.width();i.XLFreeze._changehHandlerPosition(e);s>o._currentLeftFrozenColumn?f.find(".e-content").width()<=f.find(".e-table").width()-i.model.columnWidth&&i.XLFreeze._showHideColumn(r,o._currentLeftFrozenColumn,s,"hide",o._colWidthCollection[l.i],c,v,p,y):s<o._currentLeftFrozenColumn&&i.XLFreeze._showHideColumn(r,s,o._currentLeftFrozenColumn+1,"show",o._colWidthCollection[l.i],c,v,p,y)}if(i.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&n.reachedEnd&&n.scrollData.step>-1&&!(i.XLCellNav&&i.XLCellNav._scrollReverse)){var w=!1,b=!1,a=this,h;i.isUndefined(n.scrollData.target)||(h=setInterval(function(){w=!0;for(var n=0;n<5;n++)a._scrollRight(r),i.getFrozenColumns(r)<1&&i.getFrozenRows(r)>0&&i.XLFreeze._refreshFreezeDiv(r,"horizontal",20*i.getSheet(r).columnWidth),i.getFrozenColumns(r)>0&&f.find(".e-content").width()<=f.find(".e-table").width()-i.model.sheets[r]._firstCol.value&&i.XLFreeze._hideColumn(r);e=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx;a._refreshScroller(r,"refresh","horizontal");u.element.find(".e-hhandle").css("left",u._scrollData.handleSpace-(u._scrollData.handle+1));u.scroll(e);clearInterval(h);return},1e3),u.element.find(".e-hdown")[0].addEventListener("mouseup",function(){clearInterval(h);return}),document.addEventListener("mouseup",function(){clearInterval(h);return}),b=!0);n.cancel=!0;w&&b||(this._scrollRight(r),i.getFrozenColumns(r)<1&&i.getFrozenRows(r)>0&&i.XLFreeze._refreshFreezeDiv(r,"horizontal",i.getSheet(r).columnWidth),i.getFrozenColumns(r)>0&&f.find(".e-content").width()<=f.find(".e-table").width()-i.model.sheets[r]._firstCol.value&&i.XLFreeze._hideColumn(r),e=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,a._refreshScroller(r,"refresh","horizontal"),u.element.find(".e-hhandle").css("left",u._scrollData.handleSpace-(u._scrollData.handle+1)),u.value(e))}o._scrollLeft=n.scrollLeft=e;i.model.allowKeyboardNavigation&&(i.XLCellNav._scrollReverse=!1);i.getFrozenColumns(r)<1&&(f.find(".e-content").scrollLeft(n.scrollLeft,n.scrollData.onePx),u.value(n.scrollLeft),i.model.allowAutoFill&&i._getJSSheetHeader(r)[0].querySelectorAll("th.e-colselected").length<1&&i.element.find(".e-ss-activeimg").length<1&&i.XLDragFill.positionAutoFillElement());this._getFirstColumn(r);i.getFrozenColumns(r)>0&&(i.model.allowComments&&i.XLComment._updateCmntArrowPos(),i.XLSelection.refreshSelection(),i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement(),c.get(i.getActiveCellElem(r).index()).className.indexOf("e-fc-hide")>-1&&i.model.allowAutoFill&&i.XLDragFill.hideAutoFillElement())},_scrollSpreadY:function(n){var u,f,h,o=0,i=this.XLObj,r=i.getActiveSheetIndex(),e,s=i.getSheet(r),c=i.getDigits(s._bottomRow.idx);this.XLObj.model.scrollSettings.allowVirtualScrolling?this._scrollHandler(n):this._spreadVS(n);this.XLObj.XLComment._isCommentEdit&&(e=this.XLObj.getActiveCell(),t.isNullOrUndefined(e)||this.XLObj.XLComment._updateCurCmntVal({rowIndex:e.rowIndex,colIndex:e.colIndex}));u=i.getDigits(s._bottomRow.idx);h=u-c;h&&(u>3&&(o=(u-3)*10),f=i._rowHeaderWidth+o,i._getJSSheetRowHeaderContent(r).find("col").width(f),i._getJSSheetRowHeader(r).width(f),i._getJSSheetHeader(r).find(".e-spreadsheetcolumnheader").width(f-1),i._getContent(r).find(".e-content").width(s._contWidth-o))},_scrollHandler:function(n){var h,c,v,f,l,e=hgt=height=0,o=isRefreshed=!1,r=this.XLObj,u=r.getActiveSheetIndex(),i=r.getSheet(u),y=n.scrollTop>=i._scrollTop,s,a;if(n.scrollTop===i._scrollTop){if(y&&n.scrollTop>0&&r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&i.rowCount<r._maxRowCnt){for(i._virtualBlockCnt++,i.rowCount+=i._virtualBlockRowCnt;e<i._virtualBlockRowCnt;)i.rowsHeightCollection.push(i.rowHeight),hgt=i._rowHeightCollection[i._rowHeightCollection.length-1]+i.rowHeight,i._rowHeightCollection.push(hgt),i._virtualTBodyHgt+=i.rowHeight,e++;this._refreshScroller(u,"refresh","vertical");r._refreshViewport(n.scrollTop,u);o=!0}}else{if(prop=["value","value2","comment","hyperlink","format","border","type","isFilterHide","filterState","isMHide","isFHide","merge","isFilterHeader","isFilterVisible","text","general","cFormatRule","wrap","wrapRow","rule","align","isOverflow","isOfBrdr"],v=r._getRowHdrTBody(u),h=r._getContTBody(u),y)n.scrollTop>=i._virtualContTBodyOffset.bottom&&n.scrollTop<=i._virtualBottomTBodyOffset.bottom?(height=i._virtualTopTBodyOffset.bottom-i._virtualTopTBodyOffset.top,i._virtualTopTBodyOffset.top=i._virtualContTBodyOffset.top,i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.bottom,i._virtualContTBodyOffset.top=i._virtualBottomTBodyOffset.top,i._virtualContTBodyOffset.bottom=i._virtualBottomTBodyOffset.bottom,i._virtualContBlockIdx++,i._virtualContBlockIdx===i._virtualBlockCnt?(i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom=0,i._isVirtualEndReached=!0):(i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom,i._virtualBottomTBodyOffset.bottom=r._getRowOffsetBottom(i._virtualContBlockIdx*i._virtualBlockRowCnt+(i._virtualBlockRowCnt-1),u),f=r.getRangeData(null,null,prop,u,!1,!1,!0,i._virtualContBlockIdx*i._virtualBlockRowCnt,i._virtualBlockRowCnt,!0),v.append(r._renderRowHdr(f.rowIdx,u)),h.append(r._renderData(f,u)),i._virtualRowIdx=i._virtualRowIdx.concat(f.rowIdx),o=!0),i._isVirtualTopReached||(r._removeRange(0,i._virtualBlockRowCnt),i._virtualRowIdx.splice(0,i._virtualBlockRowCnt),i._virtualTopTBodyHgt+=height),i._virtualBottomTBodyHgt=i._virtualTBodyHgt-(i._virtualTopTBodyHgt+h.height()),r._refreshTBodiesHgt(),i._isVirtualTopReached=!1):!i._isVirtualEndReached&&n.scrollTop>=i._virtualBottomTBodyOffset.bottom&&(r._refreshViewport(n.scrollTop,u),o=isRefreshed=!0);else if(n.scrollTop+n.model.viewportsize<i._virtualContTBodyOffset.top&&n.scrollTop+n.model.viewportsize>=i._virtualTopTBodyOffset.top)for(height=i._virtualBottomTBodyOffset.bottom-i._virtualBottomTBodyOffset.top,i._virtualBottomTBodyOffset.top=i._virtualContTBodyOffset.top,i._virtualBottomTBodyOffset.bottom=i._virtualContTBodyOffset.bottom,i._virtualContTBodyOffset.top=i._virtualTopTBodyOffset.top,i._virtualContTBodyOffset.bottom=i._virtualTopTBodyOffset.bottom,i._virtualContBlockIdx--,i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.top,i._virtualContBlockIdx===1?(i._virtualTopTBodyOffset.top=0,i._isVirtualTopReached=!0):(i._virtualTopTBodyOffset.top=r._getRowOffsetTop(i,(i._virtualContBlockIdx-2)*i._virtualBlockRowCnt),f=r.getRangeData(null,null,prop,u,!1,!1,!0,(i._virtualContBlockIdx-2)*i._virtualBlockRowCnt,i._virtualBlockRowCnt,!0),v.prepend(r._renderRowHdr(f.rowIdx,u)),h.prepend(r._renderData(f,u)),i._virtualRowIdx=f.rowIdx.concat(i._virtualRowIdx),o=!0),i._isVirtualEndReached||(r._removeRange(i._virtualContBlockIdx===1?2*i._virtualBlockRowCnt:3*i._virtualBlockRowCnt,i._virtualBlockRowCnt),i._virtualRowIdx.splice(i._virtualContBlockIdx===1?2*i._virtualBlockRowCnt:3*i._virtualBlockRowCnt,i._virtualBlockRowCnt),i._virtualBottomTBodyHgt+=height),i._virtualTopTBodyHgt=i._virtualTBodyHgt-(i._virtualBottomTBodyHgt+h.height()),r._refreshTBodiesHgt(),i._isVirtualEndReached=!1,c=r.XLEdit._getPropWithCellIdx([(i._virtualContBlockIdx-2)*i._virtualBlockRowCnt,0,i._virtualBlockRowCnt,i.colCount],"cellType",u),s=0,a=c.length;s<a;s++)r.XLCellType._renderControls(c[s].rowIdx,c[s].colIdx,u,r._dataContainer.sheetCellType[c[s].value]);else!i._isVirtualTopReached&&n.scrollTop+n.model.viewportsize<=i._virtualTopTBodyOffset.top&&(r._refreshViewport(n.scrollTop,u),o=isRefreshed=!0);r._getContent(u).find(".e-content").scrollTop(n.scrollTop);isRefreshed||r._refreshViewVar(n.scrollTop,null,u);i._scrollTop=n.scrollTop}if(o){for(r.XLComment._updateCmntArrowPos(r._getContent(u).find(".e-commentcell")),l=r.getObjectKeys(r._dataContainer.sheets[u][0]),r._dupDetails=!0,e=0,a=l.length;e<a;e++)fitWidth=r.XLEdit.getPropertyValue(0,l[e],"isFitWidth"),t.isNullOrUndefined(fitWidth)||r.XLResize._fitWidth(l[e]);r._dupDetails=!1}},_spreadVS:function(n){var i=this.XLObj,r=i.getActiveSheetIndex(),e,u=this._vScroller(r),f=i.model.sheets[r],o=i._getContent(r);if(n.reachedEnd=Math.ceil(parseFloat(u.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(u.element.find(".e-vhandle").height()))>=u.element.find(".e-vhandlespace").height()-2,e=n.scrollTop,i.model.enableContextMenu&&i.XLCMenu.hideCMenu(),i.getFrozenRows(r)>0&&!(i.XLCellNav&&i.XLCellNav._scrollReverse)&&n.scrollData!=null&&n.scrollData.dimension!="width"&&(n.cancel=!0,i.XLFreeze._changevHandlerPosition(e),!n.reachedEnd||n.scrollData.step<0)){var c=i.XLFreeze._getTopRow(e,r),s=c.imaginaryIndex,a=i.getRows(r),v=i._getContent(r).find(".e-content").height(),y=i._getContent(r).find(".e-table").height();s>f._currentTopFrozenRow?o.find(".e-content").height()<=o.find(".e-table").height()-i.model.rowHeight&&i.XLFreeze._showHideRow(r,f._currentTopFrozenRow,s,"hide",f._rowHeightCollection[c.i],a,v,y):s<f._currentTopFrozenRow&&i.XLFreeze._showHideRow(r,s,f._currentTopFrozenRow+1,"show",f._rowHeightCollection[c.i],a,v,y)}if(i.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&n.reachedEnd&&n.scrollData.step>-1&&!(i.XLCellNav&&i.XLCellNav._scrollReverse)){var p=!1,w=!1,l=this,h;!i.isUndefined(n.scrollData.target)&&i._hasClass(n.scrollData.target,"e-vdown")&&(h=setInterval(function(){p=!0;for(var n=0;n<20;n++)l._scrollBottom(r),i.getFrozenRows(r)<1&&i.getFrozenColumns(r)>0&&i.XLFreeze._refreshFreezeDiv(r,"vertical",i.getSheet(r).rowHeight),i.getFrozenRows(r)>0&&o.find(".e-content").height()<=o.find(".e-table").height()-f._firstRow.value&&i.XLFreeze._hideRow(r);e=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx;l._refreshScroller(r,"refresh","vertical");u.element.find(".e-vhandle").css("top",u._scrollData.handleSpace-u._scrollData.handle);u.scroll(e);clearInterval(h);return},1e3),u.element.find(".e-vdown")[0].addEventListener("mouseup",function(){clearInterval(h);return}),document.addEventListener("mouseup",function(){clearInterval(h);return}),w=!0);n.cancel=!0;p&&w||(this._scrollBottom(r),i.getFrozenRows(r)<1&&i.getFrozenColumns(r)>0&&i.XLFreeze._refreshFreezeDiv(r,"vertical",i.getSheet(r).rowHeight),i.getFrozenRows(r)>0&&o.find(".e-content").height()<=o.find(".e-table").height()-f._firstRow.value&&i.XLFreeze._hideRow(r),e=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,l._refreshScroller(r,"refresh","vertical"),u.element.find(".e-vhandle").css("top",u._scrollData.handleSpace-u._scrollData.handle),u.value(e))}n.scrollTop=f._scrollTop=e;i.model.allowKeyboardNavigation&&(i.XLCellNav._scrollReverse=!1);i.getFrozenRows(r)<1&&o.find(".e-content").scrollTop(n.scrollTop,u._scrollData.onePx);i.model.allowAutoFill&&i._getJSSheetRowHeaderContent(r)[0].querySelectorAll("td.e-rowselected").length<1&&i.element.find(".e-ss-activeimg").length<1&&i.XLDragFill.positionAutoFillElement();this._getFirstRow(r);i.getFrozenRows(r)>0&&(i.model.allowComments&&i.XLComment._updateCmntArrowPos(),i.XLSelection.refreshSelection(),i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement(),i.getActiveCellElem(r).parent()[0].className.indexOf("e-fr-hide")>-1&&i.model.allowAutoFill&&i.XLDragFill.hideAutoFillElement())},_scrollX:function(i){var r=this.XLObj,u=this._hScroller(i),o,f=[1],h=r._getContent(i).find("tbody").eq(0).prev(),e,s;for(r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&this._scrollRight(i),u.model.maximum=u.model.maximum+r.model.columnWidth,u._scrollData.scrollable=u._scrollData.scrollable+r.model.columnWidth,this._refreshScroller(i,"refresh","horizontal"),u.element.find(".e-hhandle").css("left",u._scrollData.handleSpace-(u._scrollData.handle+1)),o=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,u.value(o),e=0,s=r.model.sheets[i]._fCol;e<s;e++)f.push(f[f.length-1]+n(h.find("col")[e]).width());r.getFrozenColumns(i)>0&&r._getContent(i).find(".e-content").width()<=r._getContent(i).find(".e-table").width()-(f[f.length-1]+r.model.columnWidth)&&r.XLFreeze._hideColumn(i);r.getFrozenColumns(i)<1&&r._getContent(i).find(".e-content").scrollLeft(o,u._scrollData.onePx);this._getFirstColumn(i)},_scrollY:function(i){var r=this.XLObj,u=this._vScroller(i),o,f=[1],h=r.getRows(i)[1],e,s;for(r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&this._scrollBottom(i),u.model.maximum=u.model.maximum+r.model.rowHeight,u._scrollData.scrollable=u._scrollData.scrollable+r.model.rowHeight,this._refreshScroller(i,"refresh","vertical"),u.element.find(".e-vhandle").css("top",u._scrollData.handleSpace-(u._scrollData.handle+1)),o=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,u.value(o),e=0,s=r.model.sheets[i]._fRow;e<s;e++)f.push(f[f.length-1]+n(h[e]).height());r.getFrozenRows(i)>0&&r._getContent(i).find(".e-content").height()<=r._getContent(i).find(".e-table").height()-(f[f.length-1]+r.model.rowHeight)&&r.XLFreeze._hideRow(i);r.getFrozenRows(i)<1&&r._getContent(i).find(".e-content").scrollTop(o,u._scrollData.onePx);this._getFirstRow(i)},_sortProcess:function(n,t){for(var r=0,u=n.length-1,i,f;r<=u;)if(i=(r+u)/2|0,f=n[i],f<t){if(n[i+1]>=t)return i+1;r=i+1}else if(f>t){if(n[i-1]<t)return i;u=i-1}else return i},_getFirstRow:function(n){var s=this.XLObj,r=s.getSheet(n),e,o,u,f,t=this._vScroller(n),i=r._rowHeightCollection;e=parseInt(t.element.find(".e-vhandle").css("top"))*t._scrollData.onePx;o=(parseInt(t.element.find(".e-vhandle").css("top"))+t.element.find(".e-vhandle").height())*t._scrollData.onePx;u=this._sortProcess(i,e);r._topRow={idx:u,value:i[u]};f=this._sortProcess(i,o);r._bottomRow={idx:f,value:i[f]}},_getFirstColumn:function(n){var s=this.XLObj,r=s.getSheet(n),e,o,u,f,t=this._hScroller(n),i=r._colWidthCollection;e=parseInt(t.element.find(".e-hhandle").css("left"))*t._scrollData.onePx;o=(parseInt(t.element.find(".e-hhandle").css("left"))+t.element.find(".e-hhandle").width())*t._scrollData.onePx;u=this._sortProcess(i,e);r._leftCol={idx:u,value:i[u]};f=this._sortProcess(i,o);r._rightCol={idx:f,value:i[f]}},_scrollSelectedPosition:function(n,t){var e,u,h=0,i=this.XLObj,s=this._hScroller(n),f=this._vScroller(n),r=i._getCellInfo(t),o=i.getSheet(n),c=i._dupDetails;(parseInt(r.width)+(r.left-i._getContent(n).find(".e-content").offset().left)>i._getContent(n).find(".e-content").width()||r.left-i._getContent(n).find(".e-content").offset().left<=0)&&(e=r.left-(s._scrollData.handleSpace+s.model.buttonSize),e<0&&(e=0),s.scroll(e));(parseInt(r.height)+(r.top-i._getContent(n).find(".e-content").offset().top)>i._getContent(n).find(".e-content").height()||r.top-i._getContent(n).find(".e-content").offset().top<=0||!(t.rowIndex>o._topRow.idx&&t.rowIndex<o._bottomRow.idx))&&(!t.rowIndex<o._bottomRow.idx&&t.rowIndex<o.rowCount-1&&(h=r.height),u=r.top+h-(f._scrollData.handleSpace+f.model.buttonSize),u<0&&(u=0),u>f._scrollData.scrollable&&(u=f._scrollData.scrollable),f.scroll(u));i._dupDetails=c},_rowTemplate:function(n,t){for(var f="",i=this.XLObj,u="e-rowcell",r=0,e=i.model.sheets[n].colCount;r<e;r++)i.getSheet(n).showGridlines||(u=u.concat(" e-hborder")),f+=String.format('<td class="{0}" style="{2}"  >{1}<\/td>',u,"");return String.format("<tr style='{0}' idx=\"{1}\">"+f+"<\/tr>","height:"+i.model.rowHeight+"px;",t-1)},_rowHeaderTemplate:function(n,t){var i,t=t?t:this.XLObj.model.rowHeight;return i=String.format('<td class="{0}"  >{1}<\/td>',"e-rowheader",n),String.format("<tr style='{0}' idx=\"{1}\">"+i+"<\/tr>","height:"+t+"px;",n-1)},_columnTemplate:function(){var n="e-rowcell",t=this.XLObj,i=t.getActiveSheetIndex();return t.getSheet(i).showGridlines||(n=n.concat(" e-hborder")),String.format('<td class="{0}" style="{2}" >{1}<\/td>',n,"")},_colGroupTemplate:function(n,t){var t=t?t:this.XLObj.getSheet(n).columnWidth;return String.format("<col style = '{0}'><\/col>","width:"+t+"px;")},_columnHeaderTemplate:function(n,t){var i,r;return i=this.XLObj._generateHeaderText(t,n),r=String.format('<div class = "{0}" > {1}<\/div>',"e-headercelldiv",i),String.format('<th class="{0}"  >{1}<\/th>',"e-headercell",r)},_createNewRow:function(t,i,r,u){var s,h,l,o,a,f=this.XLObj,y=f.model.scrollSettings.allowVirtualScrolling,p=f.XLSelection,e=f.getSheet(t),c,v;if(y?(s=f._getContent(t).find("tbody").get(1),o=f._getJSSheetRowHeaderContent(t).find("tbody").get(1)):(s=f._getContent(t).find("tbody").get(0),o=f._getJSSheetRowHeaderContent(t).find("tbody").get(0)),l=this._rowTemplate(t,parseInt(o.lastChild.textContent)+1),i===-1||r>-1&&i>-1&&u==="shift"?(n(o).append(this._rowHeaderTemplate(parseInt(o.lastChild.textContent)+1)),n(s).append(l),u=="shift"&&(n(s).find("tr:last td:last").remove(),n(s).find("tr: eq(' + rowIdx + ') td:eq(' + (colIdx - 1) + ')").after(this._columnTemplate()))):(h=s.insertRow(i),n(h).height(f.model.rowHeight),n(h).append(n(l)[0].innerHTML),h=o.insertRow(i),n(h).height(f.model.rowHeight),n(h).append("<td class='e-rowheader'><\/td>")),e.rowCount=f.model.sheets[t].rowCount+1,e.rowsHeightCollection.push(f.model.rowHeight),e.dataSource.push({}),i>-1){for(a=n(o).find("td"),c=0,v=a.length;c<v;c++)n(a[c]).text(c+1);f.XLScroll._getRowHeights(t,i+1)}e._rowHeightCollection.push(e._rowHeightCollection[e._rowHeightCollection.length-1]+f.model.rowHeight);f.model.allowSelection&&(e._isColSelected||e._isSheetSelected)&&p.refreshSelection();f._refreshRows(t)},_createNewColumn:function(i,r,u,f){var e,s,l,o=this.XLObj,h=o.getSheet(i),st=o.XLSelection,c,p,w,tt,ft,v,a,b,it,et,ot,rt,k=!1,d,y,ht=h.columnsWidthCollection,ut,g,nt;for(c=o._getContTBody(i)[0],p=o._getJSSheetHeader(i).find("tr")[0],w=o._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer colgroup"),tt=n(p).parent().prev(),ft=o._generateColCount(n.trim(p.lastChild.textContent)),y=o.model.sheets[i].filterSettings.tableRange,e=0,l=y.length;e<l;e++)if(rt=y[e].multifilterIdx,r.colIndex>rt[0]&&u.colIndex<rt[rt.length-1]){k=!0;d=y[e].startRow-1;y=y[e];break}if(r.colIndex===-1||r.colIndex>-1&&r.rowIndex>-1&&f==="shift"){if(r.colIndex===-1&&f==="insert"){for(b=this._columnHeaderTemplate(ft+1,i),n(p).append(b),v=this._colGroupTemplate(i),n(tt).append(v),e=0,l=c.rows.length;e<l;e++)a=this._columnTemplate(e),n(c.rows[e]).append(a);w.append(v);h.columnsWidthCollection.push(o.model.columnWidth)}if(f==="shift"){for(ut=ft,e=r.colIndex;e<=u.colIndex;e++)b=this._columnHeaderTemplate(ut+1,i),n(p).append(b),v=this._colGroupTemplate(i),tt.append(v),w.append(v),ut=ut+1;for(e=0,l=c.rows.length;e<l;e++)for(s=r.colIndex;s<=u.colIndex;s++)a=this._columnTemplate(e),n(c.rows[e]).append(a);if(o._insDelStatus.indexOf("insert")>-1)for(e=r.rowIndex;e<=u.rowIndex;e++)for(s=r.colIndex;s<=u.colIndex;s++)n(c).find("tr:eq("+e+") td:last").remove(),a=this._columnTemplate(e),n(c).find("tr").eq(e).find("td:eq("+s+")").before(a),k&&e===d&&o.model.allowFiltering&&o.XLFilter._insertFilterIcon(e,s,y,d,k);else for(e=r.rowIndex;e<=u.rowIndex;e++)for(s=u.colIndex;s>=r.colIndex;s--)n(c).find("tr:eq("+e+") td:eq("+s+")").remove(),a=this._columnTemplate(e),n(c).find("tr:eq("+e+")").append(a),k&&e===d&&o.model.allowFiltering&&o.XLFilter._insertFilterIcon(e,s,y,d,k)}h.colCount=h.colCount+1}else{if(nt=n.extend(!0,[],o.getSheet(i).columnsWidthCollection),o._insDelStatus.indexOf("insert")>-1){for(g=nt.splice(0,r.colIndex),e=r.colIndex;e<=u.colIndex;e++)b=this._columnHeaderTemplate(e+1,i),n(p).find("th:eq("+e+")").before(b),v=this._colGroupTemplate(i),g.push(o.model.columnWidth),tt.find("col:eq("+e+")").before(v),w.find("col:eq("+e+")").before(v),o._refreshFreezeColumns(i,e,parseInt(w.find("col")[e].style.width),"insert");for(t.merge(g,nt),h.columnsWidthCollection=g,e=0,l=c.rows.length;e<l;e++)for(s=r.colIndex;s<=u.colIndex;s++)a=this._columnTemplate(e),n(c.rows[e]).find("td:eq("+s+")").before(a),k&&e===d&&o.model.allowFiltering&&o.XLFilter._insertFilterIcon(e,s,y,d,k);h.colCount=h.colCount+1}else{for(g=nt.splice(0,r.colIndex),e=u.colIndex;e>=r.colIndex;e--)o._refreshFreezeColumns(i,e,parseInt(w.find("col")[e].style.width),"delete"),n(p).find("th:eq("+e+")").remove(),tt.find("col:eq("+e+")").remove(),w.find("col:eq("+e+")").remove(),nt.splice(e,1);for(t.merge(g,nt),h.columnsWidthCollection=g,e=0,l=c.rows.length;e<l;e++)for(s=u.colIndex;s>=r.colIndex;s--)n(c.rows[e]).find("td:eq("+s+")").remove();h.colCount=h.colCount-1}for(et=n(p).find("th"),e=0,l=et.length;e<l;e++)n(et[e]).find(".e-headercelldiv").text(o._generateHeaderText(i,e+1))}ot=n.trim(n(b).text());it=n(a).text();o.model.sheets[i].columns.push({field:ot,type:it!=null?it.getDay?"date":typeof it:null,width:n(a).width()});o.XLScroll._getColWidths(i,r.colIndex>-1?r.colIndex:h.colCount-2);o.model.allowSelection&&(h._isRowSelected||h._isSheetSelected)&&st.refreshSelection();o._refreshTemplates(i,!0)},_insertColHeaders:function(t,i,r){var f=this._columnHeaderTemplate(i+1,t),u;n(r).append(f);u=this._colGroupTemplate(t);n(r.parentNode.previousSibling).append(u)},_scrollBottom:function(n){this._createNewRow(n,-1,-1,"insert")},_scrollRight:function(n){var t={rowIndex:-1,colIndex:-1};this._createNewColumn(n,t,t,"insert")},_refreshRowCol:function(n,t){t=this.XLObj._getSheetIndex(t);var i,r=this.XLObj.getSheet(t),u=!1;if(r.colCount<n[3]+1){for(i=n[3]-(r.colCount-1);i--;)this._scrollRight(t);u=!0}if(r.rowCount<n[2]+1){for(i=n[2]-(r.rowCount-1);i--;)this._scrollBottom(t);u=!0}u&&this._refreshScroller(t,"refresh","all")}}}(jQuery,Syncfusion)});