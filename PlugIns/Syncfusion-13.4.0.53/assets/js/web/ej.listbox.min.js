/*!
*  filename: ej.listbox.min.js
*  version : 13.4.0.53
*  Copyright Syncfusion Inc. 2001 - 2016. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min"],n):n()})(function(){(function(n,t,r){t.widget("ejListBox","ej.ListBox",{element:null,ignoreOnPersist:["dataSource","query","itemRequestCount","fields","create","change","select","unselect","itemDragStart","itemDrag","itemDragStop","itemDrop","checkChange","destroy","actionComplete","actionFailure","actionSuccess","actionBegin","itemDropped","selected"],model:null,validTags:["ul"],_setFirst:!1,_rootCSS:"e-listbox",defaults:{itemsCount:null,totalItemsCount:null,dataSource:null,query:t.Query(),itemRequestCount:5,fields:{id:null,text:null,imageUrl:null,imageAttributes:null,spriteCssClass:null,htmlAttributes:null,tooltipText:null,selectBy:null,checkBy:null,groupBy:null,tableName:null,selected:null,category:null,toolTipText:null},height:"auto",width:"200",template:null,text:"",selectedIndex:null,checkedIndices:[],selectedIndices:[],cascadeTo:null,value:"",cssClass:"",targetID:null,htmlAttributes:{},showRoundedCorner:!1,enableRTL:!1,enabled:!0,showCheckbox:!1,allowVirtualScrolling:!1,virtualScrollMode:"normal",enablePersistence:!1,allowMultiSelection:!1,allowDrag:!1,allowDrop:!1,enableIncrementalSearch:!1,caseSensitiveSearch:!1,loadDataOnInit:!0,create:null,change:null,select:null,unselect:null,itemDragStart:null,itemDrag:null,itemDragStop:null,itemDrop:null,checkChange:null,destroy:null,actionComplete:null,actionSuccess:null,actionFailure:null,actionBegin:null,enableVirtualScrolling:!1,checkAll:!1,uncheckAll:!1,enableLoadOnDemand:!1,itemRequest:null,allowDragAndDrop:r,selectedItemIndex:null,enableItemsByIndex:null,checkItemsByIndex:null,disableItemsByIndex:null,uncheckItemsByIndex:null,itemDropped:null,selected:null,selectIndexChanged:null,selectedItems:[],checkedItems:[],checkedItemlist:[],selectedItemlist:[]},dataTypes:{cssClass:"string",itemsCount:"number",itemRequestCount:"number",allowDrag:"boolean",allowDrop:"boolean",enableIncrementalSearch:"boolean",caseSensitiveSearch:"boolean",height:"string",width:"string",template:"string",targetID:"string",selectedIndex:"number",cascadeTo:"string",showRoundedCorner:"boolean",enableRTL:"boolean",enablePersistence:"boolean",enabled:"boolean",allowMultiSelection:"boolean",dataSource:"data",checkedIndices:"data",selectedIndices:"data",htmlAttributes:"data",loadDataOnInit:"boolean",showCheckbox:"boolean"},observables:["value"],value:t.util.valueFunction("value"),enable:function(){if(this.listContainer.hasClass("e-disable")){this.target.disabled=!1;this.model.enabled=this.model.enabled=!0;this.element.removeAttr("disabled");this.listContainer.removeClass("e-disable");this.model.allowMultiSelection&&this.listContainer.removeClass("e-disable");var n=this.listContainer.find(".e-vscrollbar,.e-hscrollbar");this.model.showCheckbox&&this.element.find(".listcheckbox").ejCheckBox("enable");n.length>0&&this.scrollerObj.enable()}},disable:function(){if(!this.listContainer.hasClass("e-disable")){this.target.disabled=!0;this.model.enabled=this.model.enabled=!1;this.element.attr("disabled","disabled");this.listContainer.addClass("e-disable");this.model.allowMultiSelection&&this.listContainer.addClass("e-disable");var n=this.listContainer.find(".e-vscrollbar,.e-hscrollbar");this.model.showCheckbox&&this.element.find(".listcheckbox").ejCheckBox("disable");n.length>0&&this.scrollerObj.disable()}},selectItemByIndex:function(t){var i,r;t=parseInt(t);t==null||this.model.showCheckbox||(this._activeItem=t,this._activeItem<=0?this._activeItem=0:this._activeItem==this._listSize-1&&(this._activeItem=this._listSize-1),i=n(this.element.children("li")[this._activeItem]),i.hasClass("e-select")||i.hasClass("e-disable")||(this.element.children("li").removeClass("e-select"),this._selectedItems=[],this.model.selectedIndices=[],i.addClass("e-select"),this._selectedItems.push(i),this.model.selectedIndices.push(t),r=this._getItemObject(i,null),r.isInteraction=!1,this.model.select&&this._trigger("select",r)));this.model.cascadeTo&&(this._activeItem=t,this._cascadeAction());this._setSelectionValues()},checkItemByIndex:function(n){typeof n=="number"&&this.checkItemsByIndices(n.toString())},uncheckItemByIndex:function(n){typeof n=="number"&&this.uncheckItemsByIndices(n.toString())},checkItemsByIndices:function(i){var u,f,r,e;if(t.isNullOrUndefined(i))return!1;if(u=i.toString().split(","),u.length>0)for(f=0;f<u.length;f++)u[f]!=null&&(this._activeItem=parseInt(u[f]),this._activeItem<0&&(this._activeItem=0),r=n(this.element.children("li")[this._activeItem]),this.model.showCheckbox&&(n(r).find(".listcheckbox").ejCheckBox("isChecked")||n(r).hasClass("e-disable")||(n(r).find(".listcheckbox").ejCheckBox("option","checked",!0),this.checkedStatus=!0,n.inArray(this._activeItem,this._checkedItems)>-1||this._checkedItems.push(this._activeItem),n.inArray(r[0],this.model.checkedIndices)>-1||this.model.checkedIndices.push(r[0]),e=this._getItemObject(r,null),e.isInteraction=!1,this.model.change&&this._trigger("change",e))));this._setSelectionValues()},uncheckItemsByIndices:function(i){var u,f,e,r,o,s;if(t.isNullOrUndefined(i))return!1;if(u=i.toString().split(","),u.length>0)for(f=0;f<u.length;f++)u[f]!=null&&(e=parseInt(u[f]),r=n(this.element.children("li")[parseInt(e)]),this.model.showCheckbox&&n(r).find(".listcheckbox").ejCheckBox("isChecked")&&!n(r).hasClass("e-disable")&&(n(r).find(".listcheckbox").ejCheckBox("option","checked",!1),this.checkedStatus=!1,o=this.model.checkedIndices.indexOf(r[0]),n.inArray(e,this._checkedItems)>-1&&this._checkedItems.splice(o,1),n.inArray(r[0],this.model.checkedIndices)>-1&&this.model.checkedIndices.splice(o,1),s=this._getItemObject(r,null),s.isInteraction=!1,this.model.checkChange&&this._trigger("checkChange",s)));this._setSelectionValues()},selectAll:function(){var i,t,r;if(!this.model.showCheckbox&&this.model.allowMultiSelection)for(i=this.element.children("li"),t=0;t<i.length;t++)n(i[t]).hasClass("e-select")||n(i[t]).hasClass("e-disable")||(n(i[t]).addClass("e-select"),this._selectedItems.push(n(i[t])),this.model.selectedIndices.push(t),r=this._getItemObject(i,null),r.isInteraction=!1,this.model.select&&this._trigger("select",r));this._setSelectionValues()},unSelectAll:function(){this.unselectAll()},unselectAll:function(){return this.model.showCheckbox||this._removeListHover(),this._setSelectionValues(),this},selectItemsByIndex:function(n){this.selectItemsByIndices(n)},selectItemsByIndices:function(t){var u=t.toString().split(","),r,f,i,e;if(!this.model.showCheckbox&&this.model.allowMultiSelection)for(r=0;r<u.length;r++)u[r]!=null&&(f=parseInt(u[r]),this._activeItem=f,this._activeItem<0?this._activeItem=0:this._activeItem==this._listSize-1&&(this._activeItem=this._listSize-1),i=n(this.element.children("li")[this._activeItem]),i.hasClass("e-select")||i.hasClass("e-disable")||(i.addClass("e-select"),this._selectedItems.push(i),this.model.selectedIndices.push(f),e=this._getItemObject(i,null),e.isInteraction=!1,this.model.select&&this._trigger("select",e)));this._setSelectionValues()},unselectItemsByIndex:function(n){this.unselectItemsByIndices(n)},unselectItemsByIndices:function(t){var r,i,f,u,e,o;if(this.model.showCheckbox)return!1;for(r=t.toString().split(","),i=0;i<r.length;i++)r[i]!=null&&(f=parseInt(r[i]),u=n(this.element.children("li")[f]),this._activeItem=f,u.removeClass("e-active e-select"),e=this._selectedItems.indexOf(u[0]),this._selectedItems.splice(this.model.selectedIndices.indexOf(e),1),this.model.selectedIndices.splice(this.model.selectedIndices.indexOf(e),1),o=this._getItemObject(u,null),o.isInteraction=!1,this.model.unselect&&this._trigger("unselect",o));this._setSelectionValues()},unselectItemByIndex:function(t){var i,r,u;if(this.model.showCheckbox)return!1;t=parseInt(t);i=n(this.element.children("li")[t]);i.hasClass("e-select")&&(i.removeClass("e-active e-select"),r=this._selectedItems.indexOf(i[0]),this._selectedItems.splice(this.model.selectedIndices.indexOf(r),1),this.model.selectedIndices.splice(this.model.selectedIndices.indexOf(r),1),u=this._getItemObject(i,null),u.isInteraction=!1,this.model.unselect&&this._trigger("unselect",u));this._setSelectionValues()},selectItemByText:function(n){this[this.model.allowMultiSelection?"selectItemsByIndices":"selectItemByIndex"](this.getIndexByText(n))},selectItemByValue:function(n){this[this.model.allowMultiSelection?"selectItemsByIndices":"selectItemByIndex"](this.getIndexByValue(n))},unselectItemByText:function(n){this[this.model.allowMultiSelection?"unselectItemsByIndices":"unselectItemByIndex"](this.getIndexByText(n))},unselectItemByValue:function(n){this[this.model.allowMultiSelection?"unselectItemsByIndices":"unselectItemByIndex"](this.getIndexByValue(n))},getSelectedItems:function(){var t=[],i=this;return n(i.model.selectedIndices).each(function(n,r){t.push(i.getItemByIndex(r))}),t},getCheckedItems:function(){var t=[],i=this;return n(i.model.checkedIndices).each(function(n,r){t.push(i.getItemByIndex(r))}),t},removeItem:function(){return this.removeSelectedItems()},removeItemByText:function(n){return this.removeItemByIndex(this.getItemByText(n).index)},hideItem:function(){this.element.find("li:visible").first().hide();this._refreshScroller()},hideSelectedItems:function(){var n=this.getSelectedItems();this._hideOrShowItemsByIndex(n,"hide")},hideCheckedItems:function(){var n=this.getCheckedItems();this._hideOrShowItemsByIndex(n,"hide")},_hideOrShowItemsByIndex:function(t,i){if(n.type(t)=="number")i=="hide"?n(this.element.find("li")[t]).hide():n(this.element.find("li")[t]).show();else for(var r=0;r<t.length;r++)i=="hide"?t[r].item?t[r].item.hide():n(this.element.find("li")[t[r]]).hide():t[r].item?t[r].item.show():n(this.element.find("li")[t[r]]).show();this._refreshScroller()},showItem:function(){this.element.find("li:hidden").last().show();this._refreshScroller()},showItemsByIndices:function(n){this._hideOrShowItemsByIndex(n,"show")},hideItemsByIndices:function(n){this._hideOrShowItemsByIndex(n,"hide")},_hideOrShowItemsByValue:function(t,i){n.type(t)=="array"?this.element.find("li").each(function(){for(var r=0;r<=t.length;r++)n(this).text()==t[r]&&(i=="hide"?n(this).hide():n(this).show())}):this.element.find("li").each(function(){n(this).text()==t&&(i=="hide"?n(this).hide():n(this).show())});this._refreshScroller()},showItemsByValues:function(n){this._hideOrShowItemsByValue(n,"show")},hideItemsByValues:function(n){this._hideOrShowItemsByValue(n,"hide")},showItemByValue:function(n){this._hideOrShowItemsByValue(n,"show")},hideItemByValue:function(n){this._hideOrShowItemsByValue(n,"hide")},showItemByIndex:function(n){this._hideOrShowItemsByIndex(n,"show")},hideItemByIndex:function(n){this._hideOrShowItemsByIndex(n,"hide")},hide:function(){this.listContainer.hide()},show:function(){this.listContainer.show()},hideAllItems:function(){this.element.find("li:visible").hide();this._refreshScroller()},showAllItems:function(){this.element.find("li:hidden").show();this._refreshScroller()},_stateMaintained:function(t){var e,f,r,u;if(this.model.disableItemsByIndex=[],this.model.selectedIndices=[],this.model.checkedIndices=[],this.model.selectedIndex>=t&&this.model.selectedIndex!=null&&(this.model.selectedIndex==t||n(this.element.children()[t-1]).hasClass("e-disable")?this.model.selectedIndex=null:this.model.selectedIndex!=t&&(this.model.selectedIndex-=1)),f=n(t).length,f>1){for(i=f;i>=0;i--)n(this.element.children()[t[i]]).remove();for(e=this.element.children().length,u=0;u<e;u++)n(this.element.children()[u]).hasClass("e-disable")&&this.model.disableItemsByIndex.push(u)}else{for(r=t-1,r;r>=0;r--)n(this.element.children()[r]).hasClass("e-disable")&&this.model.disableItemsByIndex.push(r),n(this.element.children()[r]).hasClass("e-select")&&this.model.selectedIndices.push(r),n(this.element.children()[r]).find(".listcheckbox").ejCheckBox("isChecked")&&this.model.checkedIndices.push(r);for(t=parseInt(t)+1,t;t<this._listSize;t++)n(this.element.children()[t]).hasClass("e-disable")&&this.model.disableItemsByIndex.push(t-1),n(this.element.children()[t]).hasClass("e-select")&&this.model.selectedIndices.push(t-1),n(this.element.children()[t]).find(".listcheckbox").ejCheckBox("isChecked")&&this.model.checkedIndices.push(t-1)}},removeItemByIndex:function(i){if(t.isNullOrUndefined(this.model.dataSource)){var r=n(this.element.find("li")[i]).remove().text();return this._refreshItems(),r}if(!(this.model.dataSource instanceof t.DataManager))return this._getRemovedItems([parseInt(i)])},removeSelectedItems:function(){if(this.model.showCheckbox)return!1;if(t.isNullOrUndefined(this.model.dataSource)){var i=this.value();return n(this.getSelectedItems()).each(function(n,t){t.item.remove()}),this._refreshItems(),i}if(!(this.model.dataSource instanceof t.DataManager))return this._getRemovedItems(this.model.selectedIndices)},_getRemovedItems:function(n){var t=[];return this._stateMaintained(n),this.model.dataSource=this.model.dataSource.filter(function(i,r){if(n.indexOf(r)!=-1)t.push(i);else return!0}),this.refresh(!0),t},getIndexByValue:function(t){var i;return this.element.find("li").each(function(){if(n(this).attr("value")==t)return i=n(this).index(),!1}),i},getIndexByText:function(t){var i;return this.element.find("li").each(function(){if(n(this).text()==t)return i=n(this).index(),!1}),i},getTextByIndex:function(t){return n(this.element.find("li")[t]).text()},getItemByText:function(t){var r=this,i;return this.element.find("li").each(function(){if(n(this).text()==t)return i=r._getItemObject(n(this)),!1}),i},getItemByIndex:function(t){return this._getItemObject(n(this.element.find("li")[t]))},getListData:function(){return t.DataManager&&this.model.dataSource instanceof t.DataManager?this.listitems:this.model.dataSource?this.model.dataSource:void 0},enableItem:function(t){this.element.find("li").each(function(){if(n(this).text()==t)return n(this).removeClass("e-disable"),!1})},disableItem:function(t){this.element.find("li").each(function(){if(n(this).text()==t)return n(this).addClass("e-disable").removeClass("e-select"),!1})},moveUp:function(){var n=this._getItem(this._selectedIndices()).prev(),t=this._getItem(this._selectedIndices());this._addListHover();this._getItem(this._selectedItem).removeClass("e-hover");n.insertAfter(t)},moveDown:function(){var n=this._getItem(this._selectedIndices()).next(),t=this._getItem(this._selectedIndices());this._addListHover();this._getItem(this._selectedItem).removeClass("e-hover");n.insertBefore(t)},checkAll:function(){if(!this.model.showCheckbox)return!1;var t=this.element.find("li");for(i=0;i<t.length;i++)n(t[i].firstChild).find(".listcheckbox").ejCheckBox("isChecked")||n(t[i].firstChild).hasClass("e-disable")||(n(t[i].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this._checkedItems.push(t[i]),this.model.checkedIndices.push(i));this.model.uncheckAll=!1},unCheckAll:function(){this.uncheckAll()},uncheckAll:function(){if(!this.model.showCheckbox)return!1;var t=this.element.find("li");for(i=0;i<t.length;i++)n(t[i].firstChild).find(".listcheckbox").ejCheckBox("isChecked")&&n(t[i].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!1);this._checkedItems=[];this.model.checkedIndices=[];this.model.checkAll=!1},addItem:function(i,r){var r=!t.isNullOrUndefined(r)&&r<=this.element.find("li").length?r:this.element.find("li").length,e=this,u=r,f;if(t.isNullOrUndefined(this.model.dataSource))i instanceof Array?n(i).each(function(n,t){e.addItem(t,r);r=r+1}):(this.listitem=this.element.find("li").length?r-1<0?n(this.element.find("li")[0]).before('<li role="option">'+i+"<\/li>"):n(this.element.find("li")[r-1]).after('<li role="option">'+i+"<\/li>"):n(this.element).html('<li role="option">'+i+"<\/li>"),this.listitems=this.element.find("li"),this._addItemIndex=r,this.model.showCheckbox&&($checkbox=t.buildTag("input.listcheckbox e-align#popuplist"+(this.listitems.length-1)+"_"+this._id,"",{},{type:"checkbox",name:"list"+(this.listitems.length-1)}),n(this.listitems[r]).prepend($checkbox),n(n(this.listitems[r]).find(".listcheckbox")).ejCheckBox({change:n.proxy(this._onClickCheckList,this)})),(this.model.allowDrag||this.model.allowDrop)&&this._enableDragDrop(),this._addItemIndex=null,this._refreshItems());else if(!(this.model.dataSource instanceof t.DataManager)){for(i instanceof Array||(i=[i]),n(i).each(function(n,t){e.model.dataSource.splice(r,0,t);r=r+1}),this.model.disableItemsByIndex=[],this.model.selectedIndices=[],this.model.checkedIndices=[],this.model.selectedIndex>=u&&(this.model.selectedIndex+=1),f=u-1,f;f>=0;f--)n(this.element.children()[f]).hasClass("e-disable")&&this.model.disableItemsByIndex.push(f),n(this.element.children()[f]).hasClass("e-select")&&this.model.selectedIndices.push(f),n(this.element.children()[f]).find(".listcheckbox").ejCheckBox("isChecked")&&this.model.checkedIndices.push(f);for(u;u<this._listSize;u++)n(this.element.children()[u]).hasClass("e-disable")&&this.model.disableItemsByIndex.push(u+1),n(this.element.children()[u]).hasClass("e-select")&&this.model.selectedIndices.push(u+1),n(this.element.children()[u]).find(".listcheckbox").ejCheckBox("isChecked")&&this.model.checkedIndices.push(u+1);this.refresh(!0)}},enableItemByIndex:function(n){typeof n=="number"&&this.enableItemsByIndices(n.toString())},disableItemByIndex:function(n){typeof n=="number"&&this.disableItemsByIndices(n.toString())},disableItemsByIndices:function(i){var r,u,f;if(t.isNullOrUndefined(i))return!1;for(r=i.toString().split(","),u=0;u<r.length;u++)r.length>0&&!(n.inArray(r[u],this._disabledItems)>-1)&&(n(this.element.children("li")[parseInt(r[u])]).hasClass("e-select")&&n(this.element.children("li")[parseInt(r[u])]).removeClass("e-select"),f=n(this.element.children("li")[parseInt(r[u])]).addClass("e-disable"),f.find(".listcheckbox").ejCheckBox("disable"),this._disabledItems.push(r[u]))},enableItemsByIndices:function(t){for(var f,i=t.toString().split(","),u,r=0;r<i.length;r++)i.length>0&&n.inArray(i[r],this._disabledItems)>-1&&(u=n.inArray(i[r],this._disabledItems),f=n(this.element.children("li")[parseInt(i[r])]).removeClass("e-disable"),f.find(".listcheckbox").ejCheckBox("enable"),this._disabledItems.splice(u,1))},_init:function(){this._id=this.element[0].id;this._isMozilla=t.browserInfo().name=="mozilla"?!0:!1;this._cloneElement=this.element.clone();this._deprecatedValue()._initialize()._render()._wireEvents();this._initValue=!1;this._typeInterval=null;this._typingThreshold=2e3;this.model.checkAll&&this.checkAll();this.model.uncheckAll&&this.uncheckAll();this.model.disableItemsByIndex&&this.disableItemsByIndices(this.model.disableItemsByIndex.toString());this.model.enableItemsByIndex&&this.enableItemsByIndices(this.model.enableItemsByIndex.toString());this.model.uncheckItemsByIndex&&this.uncheckItemsByIndices(this.model.uncheckItemsByIndex.toString());this._deprecatedValue()._enabled(this.model.enabled)},_deprecatedValue:function(){return this.model.itemDrop=this.model.itemDrop||this.model.itemDropped,this.model.change=this.model.change||this.model.selectIndexChanged,this.model.fields.checkBy=this.model.fields.selected||this.model.fields.checkBy,this.model.fields.tooltipText=this.model.fields.toolTipText||this.model.fields.tooltipText,this.model.fields.groupBy=this.model.fields.category||this.model.fields.groupBy,this.model.select=this.model.select||this.model.selected,this.model.allowDragAndDrop!=r&&(this.model.allowDrag=this.model.allowDrop=!0),this.model.selectedIndex=this.model.selectedIndex!=null?this.model.selectedIndex:this.model.selectedItemIndex,this.model.checkedIndices=(this.model.checkedIndices.length?this.model.checkedIndices:null)||(this.model.checkItemsByIndex?this.model.checkItemsByIndex:null)||(this.model.checkedItems.length?this.model.checkedItems:null)||(this.model.checkedItemlist.length?this.model.checkedItemlist:[]),this.model.selectedIndices=(this.model.selectedIndices.length?this.model.selectedIndices:null)||(this.model.selectedItems.length?this.model.selectedItems:null)||(this.model.selectedItemlist.length?this.model.selectedItemlist:[]),this},_setModel:function(i){var r,u=!1;for(r in i)switch(r){case"value":this._setText(t.util.getVal(i[r]));break;case"dataSource":this.model.selectedIndex=null;this._checkModelDataBinding(i[r]);break;case"query":this._queryCheck(i[r]);break;case"fields":this.model.fields=i[r];this._checkModelDataBinding(this.model.dataSource);break;case"template":this.model.template=i[r];this.refresh(!0);break;case"loadDataOnInit":this._loadContent=i[r];this._checkModelDataBinding(this.model.dataSource);break;case"enableRTL":this.model.enableRTL=i[r];this.model.enableRTL?this.listContainer.addClass("e-rtl"):this.listContainer.removeClass("e-rtl");break;case"enabled":this.model.enabled=i[r];this._enabled(i[r]);break;case"height":case"width":this.model[r]=i[r];this._setDimensions();break;case"cssClass":this.model.cssClass=i[r];this.listContainer.addClass(this.model.cssClass);break;case"showCheckbox":this._removeListHover()._checkboxHideShow(i[r]).uncheckAll();break;case"showRoundedCorner":this._roundedCorner(i[r]);break;case"selectedItemIndex":case"selectedIndex":n(this.listitem[this.model.selectedIndex]).hasClass("e-disable")||(this.selectItemByIndex(i[r]),this.model.selectedIndex=this.model.selectedItemIndex=i[r]);break;case"checkItemsByIndex":case"checkedItemlist":case"checkedItems":case"checkedIndices":this.uncheckAll();this.checkItemsByIndices(i[r].toString());this.model.checkedIndices=this.model[r]=i[r];break;case"uncheckItemsByIndex":this.uncheckItemsByIndices(i[r].toString());this.model[r]=i[r];break;case"selectedItemlist":case"selectedItems":case"selectedIndices":this.unselectAll();this.selectItemsByIndices(i[r].toString());this.model.selectedIndices=i[r];break;case"enableItemsByIndex":this.model[r]=i[r];this.enableItemsByIndices(i[r].toString());break;case"disableItemsByIndex":this.model[r]=i[r];this.disableItemsByIndices(i[r].toString());break;case"enableVirtualScrolling":this.model.allowVirtualScrolling=i[r];u=!0;break;case"allowDrag":case"allowDrop":case"allowDragAndDrop":case"allowVirtualScrolling":case"virtualScrollMode":this.model[r]=i[r];u=!0;break;case"checkAll":this.model[r]=i[r];i[r]?this.checkAll():this.uncheckAll();break;case"uncheckAll":this.model[r]=i[r];i[r]?this.uncheckAll():this.checkAll();break;case"htmlAttributes":this._addAttr(i[r]);break;case"itemsCount":this.model.itemsCount=i[r];this._setItemsCount()._setDimensions();break;case"allowMultiSelection":this.model.allowMultiSelection=i[r];this._removeListHover()}u&&this._refresh()},_destroy:function(){return this.element.insertAfter(this.listContainer),this.listContainer.remove(),this._isList||this.element.empty(),n(window).unbind("resize",n.proxy(this._OnWindowResize,this)),this},_refresh:function(){this._destroy()._init()},_finalize:function(){return this.model.selectedIndex!=null?this.selectItemByIndex(this.model.selectedIndex):this.model.showCheckbox==!0&&this._selectedItems.length>0&&this._selectCheckedItem(this._selectedItems),this.model.checkedIndices!=null&&this.checkItemsByIndices(this.model.checkedIndices.toString()),this},_initialize:function(){return this._isList=this.element.children().length?!0:!1,this.target=this.element[0],this._queryString=null,this._disabledItems=[],this._itemId=null,this._up=this._down=this._ctrlClick=!1,this.checkedStatus=this._isScrollComplete=!1,this._incqueryString="",this._activeItem=null,this._initValue=!0,this.model.allowVirtualScrolling=this.model.allowVirtualScrolling?this.model.allowVirtualScrolling:this.model.enableLoadOnDemand,this.model.virtualScrollMode=this.model.enableVirtualScrolling?"continuous":this.model.virtualScrollMode,this._selectedItems=[],this._checkedItems=[],this._loadContent=this.model.loadDataOnInit,this.model.enableVirtualScrolling&&(this.model.allowVirtualScrolling=!0),this._setItemsCount(),this},_render:function(){return this.model.totalItemsCount&&(this.model.query=t.Query().take(this.model.totalItemsCount)),this._renderContainer()._addAttr(this.model.htmlAttributes),t.DataManager&&this.model.dataSource instanceof t.DataManager?this._initDataSource(this.model.dataSource):this._showFullList(),this.model.dataSource||this._finalize(),this.model.showRoundedCorner&&this._roundedCorner(!0),this},_queryCheck:function(n){this.model.query=n;this.element.empty();this._checkModelDataBinding(this.model.dataSource)},_checkModelDataBinding:function(n){this.model.dataSource=n;n!=null?n.length!=0?t.DataManager&&n instanceof t.DataManager?this._initDataSource(n):this._showFullList():this.element.empty():this.element.empty()},_initDataSource:function(n){var t,i;this._trigger("actionBegin");t=this;t.listitems=t.model.dataSource;t._updateLoadingClass(!0);i=n.executeQuery(this._getQuery());i.done(function(n){t.listitems=n.result;t._updateLoadingClass()._showFullList()._trigger("actionSuccess",n);t._finalize()}).fail(function(n){t.model.dataSource=null;t._updateLoadingClass(!0)._trigger("actionFailure",n)}).always(function(n){t.model.checkAll&&t.checkAll();t.model.uncheckAll&&t.uncheckAll();t._trigger("actionComplete",n)})},_getQuery:function(){var i,r,n,u;if(t.isNullOrUndefined(this.model.query)){r=[];n=this.model.fields;i=t.Query();for(u in n)u!=="tableName"&&r.push(n[u]);r.length>0&&i.select(r);this.model.dataSource.dataSource.url.match(n.tableName+"$")||t.isNullOrUndefined(n.tableName)||i.from(n.tableName)}else i=this.model.query;return i},_addDragableClass:function(){if(this.model.allowDrag||this.model.allowDrop){this.element.css("cursor","pointer");this.model.allowDrop&&(this.listContainer.addClass("e-droppable"),this.listBoxScroller.addClass("e-droppable"));var t=this;this.element.children("li").each(function(){t.model.allowDrag&&n(this).addClass("e-draggable");t.model.allowDrop&&n(this).addClass("e-droppable")})}return this},_enableDragDrop:function(){(this.model.allowDrag||this.model.allowDrop)&&this._drag()},_updateLoadingClass:function(n){return this.listContainer[n?"addClass":"removeClass"]("e-load"),this},_addAttr:function(t){var i=this;n.map(t,function(n,t){t=="class"?i.listContainer.addClass(n):t=="required"?i.element.attr(t,n):t=="disabled"&&n=="disabled"?i._enabled(!1):i.listContainer.attr(t,n)})},_renderContainer:function(){return this.listContainer=t.buildTag("div.e-ddl-popup e-box e-popup e-widget "+this.model.cssClass,"",{visibility:"hidden"},{tabIndex:0,id:this._id+"_container"}),this.listBoxScroller=t.buildTag("div"),this.ultag=t.buildTag("ul.e-ul","",{},{role:"listbox"}),this.element=this.element.addClass("e-ul"),this.listContainer.append(this.listBoxScroller).insertAfter(this.element),this.listBoxScroller.append(this.element),this.element.attr("unselectable","on").css("user-select","none"),this._hiddenInput=t.buildTag("input#"+this._id+"_hidden","",{},{type:"hidden"}).insertBefore(this.element),this._hiddenInput.attr("name",this._id),this},_renderlistContainer:function(){var e,u,s,i,a,c,o,h,y,l,v,f;if(this.hold=this.touchhold=!1,this.item="",this.startime=0,e=this.listitems,i=this.model.fields,this.lastScrollTop=-1,this.dummyUl=n(),this.model.enableRTL&&this.listContainer.addClass("e-rtl"),this.model.dataSource==null||this.model.dataSource.length<1)a=this.element.parents().last(),this.docbdy=this.model.targetID?a.find("#"+this.model.targetID):a.find("#"+this._id),this.itemsContainer=this.docbdy,this.itemsContainer.children("ol,ul").remove(),this.items=this.itemsContainer.children("li"),this.items.children("img").addClass("e-align"),this.items.children("div").addClass("e-align"),this.itemsContainer.children("span").addClass("e-ghead"),this.element.append(this.itemsContainer.children());else if(this.model.dataSource==null||typeof e[0]=="object")if(this.mapFld={_id:null,_imageUrl:null,_imageAttributes:null,_tooltipText:null,_spriteCSS:null,_text:null,_value:null,_htmlAttributes:null,_selectBy:null,_checkBy:null},this.mapFld._id=i&&i.id?i.id:"id",this.mapFld._imageUrl=i&&i.imageUrl?i.imageUrl:"imageUrl",this.mapFld._tooltipText=i&&i.tooltipText?i.tooltipText:"tooltipText",this.mapFld._imageAttributes=i&&i.imageAttributes?i.imageAttributes:"imageAttributes",this.mapFld._spriteCSS=i&&i.spriteCssClass?i.spriteCssClass:"spriteCssClass",this.mapFld._text=i&&i.text?i.text:this.listitems[0].text?"text":Object.keys(this.listitems[0])[0],this.mapFld._value=i&&i.value?i.value:"value",this.mapFld._htmlAttributes=i&&i.htmlAttributes?i.htmlAttributes:"htmlAttributes",this.mapFld._checkBy=i&&i.checkBy?i.checkBy:"checkBy",this.mapFld._selectBy=i&&i.selectBy?i.selectBy:"selectBy",c=i&&i.groupBy?i.groupBy:"",h=this.model.query,this.listContainer.height(this.model.height),this.listitemheight=24,this.model.allowVirtualScrolling){if(this.model.virtualScrollMode=="normal"){for(this.realUllength=0,this.model.dataSource.length<0&&(query=this.model.query.take(parseInt(this.listContainer.height()/this.listitemheight)),f=this,t.DataManager&&this.model.dataSource instanceof t.DataManager&&(f.listitems=f.model.dataSource,y=this.model.dataSource.executeQuery(query),y.done(function(n){f.listitems=n.result;f._trigger("actionSuccess",n)}).fail(function(n){f._trigger("actionFailure",n)}).always(function(n){f._trigger("actionComplete",n)}))),u=0;u<this.listitems.length;u++)this.dummyUl.push(t.buildTag("li",null,null,{style:"min-height:20px;"})[0]);this.element.append(this.dummyUl)}this._loadInitialData(h,e)}else if(c&&c!="")for(h=t.Query().group(c),o=t.DataManager(e).executeLocal(h),this.model.dataSource=[],u=0;u<o.length;u++)this.dummyUl.push(t.buildTag("span.e-ghead",o[u].key)[0]),this._loadlist(o[u].items),this.model.dataSource=this.model.dataSource.concat(o[u].items);else if(o=t.DataManager(e).executeLocal(h),o.length>0)if(this.model.template!=null){for(u=0;u<e.length;u++)l=this._getField(e[u],this.mapFld._htmlAttributes),v=this._getField(e[u],this.mapFld._id),s=t.buildTag("li"),l&&l!=""&&s.attr(l),v&&s.attr("id",v),this.model.template&&s.append(this._getTemplatedString(e[u])),this.dummyUl.push(s[0]);this.element.append(this.dummyUl)}else if(this.mergeValue!=o&&this.mergeValue!=r){for(this.mergeUl=[],u=0;u<this.mergeValue.length;u++)this.mergeUl.push(t.buildTag("li",this.mergeValue[u][this.model.fields.text],null,{style:"min-height:20px;"})[0]);this.element.append(this.mergeUl)}else this.realUllength=0,this._loadlist(o);f=this;this._setDimensions();this.listContainer.css({position:"relative",height:""});this.listBoxScroller.css({height:"",width:""});this.listContainer.ejScroller({height:this.listContainer.height(),width:0,scrollerSize:20,scroll:function(n){(n.source=="button"||n.source=="key"||n.source=="wheel"||n.source!="thumb")&&f.model!=null&&f._onScroll(n)},thumbEnd:function(n){f.model!=null&&n.originalEvent.target.tagName.toUpperCase()!="LI"&&f._onScroll(n)}});this.scrollerObj=this.listContainer.ejScroller("instance");this._setDimensions();this.listContainer.css({display:"none",visibility:"visible"});this._checkboxHideShow(this.model.showCheckbox)._checkitems()._showResult();this.model.virtualScrollMode!="continuous"||t.isNullOrUndefined(this.scrollerObj._vScrollbar)||(this.checkToLoadData=this.scrollerObj._vScrollbar._scrollData.scrollable+this.element.find("li").height()*3);this.model.totalItemsCount&&this._setTotalItemsCount()},_loadInitialData:function(n,i){var r=n.clone();this.realUllength=0;r=t.DataManager&&this.model.dataSource instanceof t.DataManager?r.range(0,parseInt(this.listContainer.height()/this.listitemheight)):r.range(0,this._listitems.length);groupedList=t.DataManager(i).executeLocal(r);this._loadlist(groupedList)},_loadlist:function(i){var u,r,y;if(this.element!=null){for(u=[],r=0;r<i.length;r++){var v=this._getField(i[r],this.mapFld._id),o=this._getField(i[r],this.mapFld._imageUrl),s=this._getField(i[r],this.mapFld._imageAttributes),h=this._getField(i[r],this.mapFld._spriteCSS),e=this._getField(i[r],this.mapFld._text),c=this._getField(i[r],this.mapFld._value),l=this._getField(i[r],this.mapFld._htmlAttributes),p=this._getField(i[r],this.mapFld._selectBy),w=this._getField(i[r],this.mapFld._checkBy),a=this._getField(i[r],this.mapFld._tooltipText),f=this.realUllength;litag=c&&c!=""?t.buildTag("li","","",{value:c,style:"min-height:20px;"}):t.buildTag("li",null,null,{style:"min-height:20px;"});v&&litag.attr("id",v);o&&o!=""&&(imgtag=t.buildTag("img.e-align","",{},{src:o,alt:e}),s&&s!=""&&imgtag.attr(s),litag.append(imgtag));h&&h!=""&&(divtag=t.buildTag("div.e-align "+h+" sprite-image"),litag.append(divtag));e&&e!=""&&litag.append(e);l&&l!=""&&litag.attr(l);a&&a!=""&&litag.attr("title",a);w&&litag.addClass("checkItem");p&&litag.addClass("selectItem");this.element.children()[f]!=null&&this.model.allowVirtualScrolling&&n(this.element.children()[f]).text()==""?n(this.element.children()[f]).replaceWith(litag[0]):this.model.allowVirtualScrolling&&this.model.virtualScrollMode=="normal"?n(this.dummyUl[f]).text(n(litag[0]).text()):this.dummyUl.push(litag[0]);this.realUllength+=1}this.model.allowVirtualScrolling||this.element.children().remove();this.element.children()[f]==null&&(!this.model.allowVirtualScrolling||this.model.virtualScrollMode==t.VirtualScrollMode.Continuous)&&this._loadContent&&this.element.append(this.dummyUl);this.element.find(".selectItem").each(function(t,i){u.push(n(i).index())});y=this;this.element.find(".checkItem").each(function(t,i){y.model.checkedIndices.push(n(i).index())});u.length&&(this.model.allowMultiSelection?this.model.selectedIndices=u:this.model.selectedIndex=u[0]);this._loadContent=!0}return this},_applySelection:function(){if(!(this.model.fields.checkBy||this.model.fields.selectBy))return!1;this.model.showCheckbox?(this.uncheckAll(),this.checkItemsByIndices(this.model.checkedIndices)):this.model.allowMultiSelection?this.selectItemsByIndices(this.model.selectedIndices):(this.unselectAll(),this.selectItemByIndex(this.model.selectedIndex))},_getField:function(n,i){return t.pvt.getObject(i,n)},_getTemplatedString:function(n){for(var t=this.model.template,i=t.indexOf("${"),r=t.indexOf("}"),u,f;i!=-1&&r!=-1;)u=t.substring(i,r+1),f=u.replace("${","").replace("}",""),t=t.replace(u,this._getField(n,f)),i=t.indexOf("${"),r=t.indexOf("}");return t},_checkboxHideShow:function(n){return n?this._createCheckbox():this._removeCheckbox(),this.model.showCheckbox=n,this.model.checkAll&&this.checkAll(),this},_createCheckbox:function(){var i,f,e=this,r,u;for(this._listitems=this.listContainer.find("ol,ul").children("li"),f=this._listitems.find("input[type=checkbox]"),i=0;i<this._listitems.length;i++)n(this._listitems[i]).text()!=""&&($checkbox=t.buildTag("input.listcheckbox e-align#popuplist"+i+"_"+this._id,"",{},{type:"checkbox",name:"list"+i}),n(this._listitems[i]).find("input[type=checkbox]").length||n(this._listitems[i]).prepend($checkbox));for(this.listContainer.find(".listcheckbox").ejCheckBox({cssClass:this.model.cssClass,change:n.proxy(this._onClickCheckList,this)}),i=0;i<this._listitems.length;i++)r=n(this._listitems[i]).find(".listcheckbox"),n(this._listitems[i]).hasClass("e-disable")?r.ejCheckBox("disable"):n(this._listitems[i]).hasClass("checkitem")&&(r.ejCheckBox({checked:!0}),this._activeItem=i,this.checkedStatus=!0,u=this._getItemObject(n(this._listitems[i]),null),u.isInteraction=!0,this._initValue||this._trigger("checkChange",u),n(this._listitems[i]).removeClass("checkItem"))},_removeCheckbox:function(){var n;this.listitem=this.listContainer.find("ol,ul").children("li");n=this.listitem.find(".listcheckbox");n.length>0&&(this.listitem.find(".listcheckbox").ejCheckBox("destroy"),this.listitem.find("input[type=checkbox]").remove(),this._checkedItems=[])},_selectCheckedItem:function(n){if(n.length>0)for(i=0;i<n.length;i++)this._selectedItems.push(n[i])},_refreshScroller:function(){if(this.model.virtualScrollMode=="continuous")this.listContainer.find(".e-content, .e-vhandle,.e-vhandle div").removeAttr("style"),this.listContainer.css({display:"block"}),this.scrollerObj&&(this.scrollerObj.model.height=this.listContainer.height(),this.scrollerObj.refresh(),this.scrollerObj.option("scrollTop",0));else{this.listContainer.find(".e-vhandle div").removeAttr("style");var n=this.listBoxScroller.height();this.listContainer.css({display:"block"});this.scrollerObj&&(this.scrollerObj.model.height=this.listContainer.height(),this.scrollerObj.refresh());this.listBoxScroller.css("height","100%")}this.model.enabled||this.scrollerObj&&this.scrollerObj.disable()},_setDimensions:function(){return this.listContainer.css({width:this.model.width,height:this.model.height}),this._refreshScroller(),this},_setItemsCount:function(){return this.model.height=this.model.itemsCount&&this.model.itemsCount!=0&&this.model.height=="auto"?this.model.itemsCount*30:this.model.height=="auto"?"220":this.model.height,this},_setTotalItemsCount:function(){this.element.height(this.element.find("li").outerHeight()*this.model.totalItemsCount);this.scrollerObj.refresh()},_refreshContainer:function(){this.listContainer.css({position:"relative"});this._setDimensions()._roundedCorner()._refreshScroller()},_drag:function(){var i=this,u=!1,r=null;this._listitem=this.element.parent();lilist=this._addItemIndex?n(n(this._listitem).find("li")[this._addItemIndex]):n(this._listitem).find("li");lilist.not(".e-js").ejDraggable({dragArea:null,clone:!0,dragStart:function(t){var f,u;return n(t.element.closest(".e-ddl-popup.e-js")).hasClass("e-disable")||t.element.hasClass("e-disable")?(r&&r.remove(),!1):(f=n("#"+this.element.parent()[0].id).data("ejListBox"),f._refreshItems(),u=i.getSelectedItems(),u.length>1?i._onDragStarts(u,t.target):i._onDragStarts([i._getItemObject(t.element,t)],t.target))?(t.cancel=!0,r&&r.remove(),!1):void 0},drag:function(t){var r=t.target,u=i.getSelectedItems();if(u.length>1?i._onDrag(u,r):i._onDrag([i._getItemObject(t.element,t)],r))return!1;(n(r).hasClass("e-droppable")||n(r).parent().hasClass("e-droppable"))&&n(r).addClass("allowDrop")},dragStop:function(t){t.element.dropped||r&&r.remove();var f=t.target,o=i,s=u?"Before":"After",e=i.getSelectedItems();return(e.length>1?i._onDragStop(e,f):i._onDragStop([i._getItemObject(t.element,t)],f))?!1:(n(t.element).removeClass("e-active"),f.nodeName=="UL"&&(f=n(f).children()[0]),n(f).closest("li").length?f=n(t.target).closest("li")[0]:f.nodeName!="LI"&&(f=n(f).closest(".e-ddl-popup.e-droppable")[0]),f&&f.nodeName=="LI"&&n(f).hasClass("e-droppable")&&n(f).closest(".e-ddl-popup.e-droppable").length?i._dropItem(f,t.element,u,t.event):n(f).hasClass("e-droppable")&&n(f).closest(".e-ddl-popup.e-droppable").length&&i._dropItemContainer(f,t.element,t.event),n(".allowDrop").removeClass("allowDrop"),t.target!=i.element[0]&&t.element.parent().length&&n(t.element.parent()[0]).data().ejWidgets[0]=="ejListBox"&&(i=n("#"+t.element.parent()[0].id).data(n(t.element.parent()[0]).data().ejWidgets[0]),e.length>1?i._onDropped(e,f):i._onDropped([i._getItemObject(t.element),t],t.target))?!1:void 0)},helper:function(u){if(!t.isNullOrUndefined(u.element)&&!n(u.element.closest(".e-ddl-popup.e-js")).hasClass("e-disable")&&n(u.element).hasClass("e-draggable")&&(i=n(u.element).closest(".e-listbox.e-js").data("ejListBox"),i._tempTarget=n(u.element).text(),i))return r=n(u.sender.target).clone().addClass("dragClone dragClonelist"),r.appendTo(n("body"))}})},_dropItem:function(t,i,r,u){var h=n(t).closest(".e-ddl-popup.e-droppable")[0].id.replace("_container",""),s=[],f=[],e=n("#"+h).data("ejListBox"),c=e.model.showCheckbox?!this.model.showCheckbox:this.model.showCheckbox,o;c||(o=this._getDropObject(t,i,u),s=o.dataIndex,f=o.dataObj,r?n(li).insertBefore(t):n(li).insertAfter(t),this._refreshItems(),f&&this.model.dataSource&&this._dropDataSource(e,s,f,li.index()),e._refreshItems())},_dropItemContainer:function(t,i,r){var s=n(t)[0].id.replace("_container",""),u=n("#"+s).data("ejListBox"),h=u.model.showCheckbox?!this.model.showCheckbox:this.model.showCheckbox;if(!h){var e=[],f=[],o=this._getDropObject(t,i,r);e=o.dataIndex;f=o.dataObj;li.insertAfter(n(n(t).find("li")).last());n(t).find("ul").append(li);this._refreshItems();f&&this.model.dataSource&&this._dropDataSource(u,e,f,u.model.dataSource?u.model.dataSource.length:0);u.model.allowDrag||n(li).ejDraggable("instance")._destroy();u._refreshItems()}},_dropDataSource:function(i,r,u,f){var o=t.DataManager&&this.model.dataSource instanceof t.DataManager,e;o||(r instanceof Array?(e=this,n.each(u,function(n){indx=e.model.dataSource.indexOf(u[n]);e.model.dataSource.splice(indx,1)})):this.model.dataSource.splice(r,1),i.model.dataSource instanceof Array?i.model.dataSource.splice.apply(i.model.dataSource,[f,0].concat(u)):i.model.dataSource=u)},_getDropObject:function(t,i){var r=[],u=[];return this.model.allowMultiSelection?(li=n(i).parent().find(".e-select").removeClass("e-select e-hover"),li.length||(li=i.removeClass("e-select e-hover"))):li=i.removeClass("e-select e-hover"),li.length?(proxy=this,n.each(li,function(){r.push(n(this).index());u.push(proxy.model.dataSource?proxy.model.dataSource[n(this).index()]:null)})):(r=li.index(),u=this.model.dataSource?this.model.dataSource[r]:null),{dataIndex:r,dataObj:u}},_showResult:function(){var i=this,t;return this._refreshContainer(),this.element.attr({"aria-expanded":!0}),t=this.element.children("li"),this._listSize=t.size(),t.unbind("contextmenu",n.proxy(this._OnMouseContext,this)),t.unbind("click",n.proxy(this._OnMouseClick,this)),t.unbind("touchstart mouseenter",n.proxy(this._OnMouseEnter,this)),t.unbind("touchend mouseleave",n.proxy(this._OnMouseLeave,this)),t.bind("touchstart mouseenter",n.proxy(this._OnMouseEnter,this)),t.bind("touchend mouseleave",n.proxy(this._OnMouseLeave,this)),t.bind("click",n.proxy(this._OnMouseClick,this)),t.bind("contextmenu",n.proxy(this._OnMouseContext,this)),n(window).bind("resize",n.proxy(this._OnWindowResize,this)),i.model.showCheckbox&&i.element.find(".listcheckbox").ejCheckBox({enabled:i.model.enabled}),this},_OnWindowResize:function(){this._refreshContainer();this.listContainer.css("display","block")},refresh:function(n){n||t.isNullOrUndefined(n)?(this.model.template&&this.element.empty(),this._checkModelDataBinding(this.model.dataSource)):(this.listContainer.css({height:this.model.height,width:this.model.width}),this._refreshScroller())},_removeListHover:function(){return this._selectedItems=[],this.model.selectedIndices=[],this.model.selectedIndex=null,this.element.children("li").removeClass("e-hover e-select"),this},_addListHover:function(){this._activeItem=this._selectedItem;var n=this._getItem(this._selectedItem);n.addClass("e-select e-hover");this.scrollerObj.setModel({scrollTop:this._calcScrollTop()});n.focus();this._OnListSelect(this.prevselectedItem,this._selectedItem)},_calcScrollTop:function(n){for(var f=this.element.outerHeight(),r=this.element.find("li"),u=0,i=n?n:this.element.find("li.e-select").index(),t=0;t<i;t++)u+=r.eq(t).outerHeight();return u-(this.listContainer.outerHeight()-r.eq(i).outerHeight())/2},_refreshItems:function(){this.listBoxScroller.append(this.element);this.listContainer.append(this.listBoxScroller);this._refreshContainer();this._showResult();this._setSelectionValues();this._setDisableValues()},_selectedIndices:function(){var t;return this.element.children("li").each(function(i){if(n(this).hasClass("e-select"))return t=i,!1}),this._selectedItem=t,t},_addSelectedItem:function(t){(!n.isArray(this.model.disableItemsByIndex)&&this.model.disableItemsByIndex!=null||n.isArray(this.model.disableItemsByIndex)&&this.model.disableItemsByIndex.length>0)&&(t.keyCode==40||t.keyCode==39?this._disableItemSelectDown():this._disableItemSelectUp(),this._selectedItem=this._activeItem);var i=this._getItem(this._selectedItem);this._selectedItems.push(i)},_getItem:function(t){return n(this.element.children("li")[t])},_getItemObject:function(n,t){return{item:n,index:n.index(),text:n.text(),value:n.attr("value")?n.attr("value"):n.text(),isEnabled:!n.hasClass("e-disable"),isSelected:n.hasClass("e-select"),isChecked:n.find(".e-chk-image").hasClass("e-chk-activeicon"),data:this.model.dataSource?this.getListData()[n.index()]:null,event:t?t:null}},_roundedCorner:function(n){return this.listContainer[n?"addClass":"removeClass"]("e-corner-all"),this},_enabled:function(n){return n?this.enable():this.disable(),this},_showFullList:function(){return this.model.dataSource!=null&&(t.DataManager&&this.model.dataSource instanceof t.DataManager||(this.listitems=this.model.dataSource),!this.model.query.queries.length||t.DataManager&&this.model.dataSource instanceof t.DataManager||(this.listitems=t.DataManager(this.model.dataSource).executeLocal(this.model.query))),this._renderlistContainer(),this.model.dataSource instanceof t.DataManager||this._trigger("actionComplete"),this._addDragableClass()._enableDragDrop(),this._disabledItems=[],this.disableItemsByIndices(this.model.disableItemsByIndex),this.model.selectedIndex&&this.selectItemByIndex(this.model.selectedIndex),this.selectItemsByIndices(this.model.selectedIndices),this.checkItemsByIndices(this.model.checkedIndices),this},_cascadeAction:function(){this.model.cascadeTo&&(this._currentValue=this._getField(this.listitems[this._activeItem],this.mapFld._value),this.selectDropObj=n("#"+this.model.cascadeTo).ejListBox("instance"),t.isNullOrUndefined(this._dSource)&&(this._dSource=this.selectDropObj.model.dataSource),this._performJsonDataInit())},_performJsonDataInit:function(){this._changedSource=t.DataManager(this._dSource).executeLocal(t.Query().where(this.mapFld._value,"==",this._currentValue));this.selectDropObj.setModel({dataSource:this._changedSource,enable:!0,value:""})},_OnMouseContext:function(n){return n.preventDefault(),!1},_OnMouseEnter:function(t){var i,r,u;this.startime=0;this.item="";t.type=="touchstart"&&(this.item=n(t.target).text(),this.startime=(new Date).getTime());this.model.enabled&&(this.element.children("li").removeClass("e-hover"),n(t.target).is("li")&&n(t.target).addClass("e-hover"),n(t.target).hasClass("e-disable")?n(t.target).removeClass("e-hover e-select"):t.target.tagName!="li"&&(i=n(t.target).parents("li"),n(i).addClass("e-hover")),u=0,this.element.children("li").each(function(t){if(n(this).hasClass("e-hover"))return r=t,!1}),this._activeItem=r)},_OnMouseLeave:function(t){this.element.children("li").removeClass("e-hover");this.endtime=(new Date).getTime();(this.endtime-this.startime)/200>2&&this.item==n(t.target).text()&&(this.hold=(this.endtime-this.startime)/200>2?!this.hold:!1)},_OnMouseClick:function(t){var i,e,o,u,f,s,c,h;if(t.which==3&&(this.hold=!0),this.endtime=(new Date).getTime(),(this.endtime-this.startime)/200>2&&(this.model.template||this.item!=n(t.target).text()||this.hold||(this.hold=(this.endtime-this.startime)/200>2)),this.model.enabled&&this._activeItem!=r){if(this.model.showCheckbox){if(n(t.currentTarget).is("li")&&n(t.target).is("li"))n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("isChecked")?(n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("option","checked",!1),s=this.model.checkedIndices.indexOf(n(t.currentTarget).index()),this._checkedItems.splice(s,1),this.model.checkedIndices.splice(s,1),this.checkedStatus=!1):(n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this._checkedItems.push(this._activeItem),this.model.checkedIndices.push(n(t.currentTarget).index()),this.checkedStatus=!0);else return!1;this.selectedTextValue=n(t.currentTarget).text();!this.element.hasClass("e-disable")&&n(t.target).is("li")&&(c={status:this.model.enabled,isChecked:this.checkedStatus,selectedTextValue:this.selectedTextValue},h=this._getItemObject(n(t.target),t),h.isInteraction=!0,this._trigger("checkChange",h));this._lastEleSelect=n(t.currentTarget).index()}else{if(this.prevselectedItem=this._lastEleSelect?this._lastEleSelect:this._selectedIndices(),i=n(this.element.children("li")[this._activeItem]),this.model.allowMultiSelection&&(t.ctrlKey||this.touchhold||this.hold||t.shiftKey)||this._removeListHover(),this.element.children("li").removeClass("e-hover"),i.hasClass("e-select"))i.removeClass("e-select"),this._selectedItems.splice(this.model.selectedIndices.indexOf(this._activeItem),1);else if(i.addClass("e-select"),this._selectedItems.push(i),this.model.selectedIndices.push(this._activeItem),t.shiftKey&&this.model.allowMultiSelection)for(t.ctrlKey||this._removeListHover(),this.prevselectedItem<this._activeItem?(e=this.prevselectedItem,o=this._activeItem):(e=this._activeItem,o=this.prevselectedItem),u=e;u<=o;u++)i=n(this.element.children("li")[u]),i.hasClass("e-disable")||(i.hasClass("e-select")||i.addClass("e-select"),this._selectedItems.push(i),this.model.selectedIndices.push(this._activeItem));this._selectedItem=this._selectedIndices();this._cascadeAction();f=n(this.element.children("li")[this._selectedItem]);n(f).text()!=""&&(this.element.val(n(f).text()),this.element.attr({value:this.element.val()}));this.model.selectedText=i.text();this._selectedData=this._getItemObject(n(f),t);this._selectedData.isInteraction=!0;this._prevSelectedData&&this._selectedData.text!=this._prevSelectedData.text&&this._trigger("unselect",this._prevSelectedData);this._trigger("select",this._selectedData);this._prevSelectedData=this._selectedData;this._lastEleSelect=this._activeItem;this._selectedItems&&this._selectedItems.length!=1&&(this._ctrlClick=!0)}this._setSelectionValues()._OnListSelect(this.prevselectedItem,this._activeItem)}t.target.nodeName!="INPUT"&&this.listContainer.focus()},_setSelectionValues:function(){var i=[],t,r;return this.model.selectedIndices=[],this.model.checkedIndices=[],t=this,this.model.showCheckbox?this.element.find("li .listcheckbox:checked").closest("li").each(function(r,u){i.push(n(u).attr("value")?n(u).attr("value"):n(u).text());t.model.checkedIndices.push(n(u).index())}):(r=this.element.children("li"),this.element.children("li.e-select").each(function(u,f){i.push(n(f).attr("value")?n(f).attr("value"):n(f).text());t.model.selectedIndices.push(r.index(f));t.model.selectedIndex=r.index(f)})),this.model.selectedItemIndex=this.model.selectedIndex,this.model.selectedItems=this.model.selectedItemlist=this.model.selectedIndices,this.model.checkedItems=this.model.checkedItemlist=this.model.checkItemsByIndex=this.model.checkedIndices,this.value(i.toString()),this._hiddenInput.val(this.value()),this},_setDisableValues:function(){this._disabledItems=[];this.model.disableItemsByIndex=[];for(var i=this.element.children().length,t=0;t<i;t++)n(this.element.children()[t]).hasClass("e-disable")&&this.model.disableItemsByIndex.push(t);this.disableItemsByIndices(this.model.disableItemsByIndex)},_onClickCheckList:function(t){if(this.checkedStatus=t.isChecked?!0:!1,!this._initValue){this.checkedStatus?this.model.checkedIndices.push(n(t.event.target).closest("li").index()):this.model.checkedIndices.splice(n.inArray(n(t.event.target).closest("li").index(),this.model.checkedIndices),1);var i=this._getItemObject(n(t.event.target).closest("li"),t);i.isInteraction=!0;this._trigger("checkChange",i)}},_disableItemSelectUp:function(){var i=this.model.disableItemsByIndex.split(",").sort().reverse(),t;for(this._activeItem==0?this._activeItem=this.listitems.length-1:this._activeItem--,t=0;n.inArray(this._activeItem.toString(),i)>-1;t++)this._activeItem--,this._activeItem==0&&(this._activeItem=this.listitems.length-1);n(this.element.children("li")[this._activeItem]).addClass("e-select")},_disableItemSelectDown:function(){var i=this.model.disableItemsByIndex.split(",").sort(),t;for(this.listitems.length-1==this._activeItem?this._activeItem=0:this._activeItem++,t=0;n.inArray(this._activeItem.toString(),i)>-1;t++)this._activeItem++,this.listitems.length==this._activeItem&&(this._activeItem=0);n(this.element.children("li")[this._activeItem]).addClass("e-select")},_checkitems:function(){var r,t;if(this.model.showCheckbox)for(r=this.element.find("li"),i=0;i<this.model.checkedIndices.length;i++)t=this.model.checkedIndices[i],n(r[t]).find(".listcheckbox").ejCheckBox("option","checked",!0),this._checkedItems.push(r[t]);else if(this.model.allowMultiSelection)for(i=0;i<this.model.selectedIndices.length;i++)t=this.model.selectedIndices[i],n(this.listitem[t]).hasClass("e-select")?(n(this.listitem[t]).removeClass("e-select"),this._selectedItems.pop(n(this.listitem[t]))):(n(this.listitem[t]).addClass("e-select"),this._selectedItems.push(n(this.listitem[t])));else n(this.listitem[this.model.selectedIndex]).hasClass("e-select")||n(this.listitem[this.model.selectedIndex]).addClass("e-select"),this._selectedItems.push(n(this.listitem[this.model.selectedIndex]));return this._setSelectionValues(),this},_OnListSelect:function(i,r,u){if(!t.isNullOrUndefined(i)&&i!=r&&!this.model.showCheckbox){var f=this._getItemObject(n(this.element.find("li")[r]),u);f.isInteraction=!0;this._trigger("change",f)}},_OnKeyDown:function(t){var r,s,e,i,f,u,o;if(this.model.enabled){this._selectedItems&&this._selectedItems.length==1&&!this.model.showCheckbox&&(this._lastEleSelect=n(this.element.children("li.e-select")).index());this._itemId=null;r=this.element.children("li");s=this;this._listSize=this.element.children("li").size();this.prevselectedItem=this._selectedIndices;t.shiftKey||(this._up=this._down);switch(t.keyCode){case 37:case 38:if(e=this.element.find("li"),i=this.model.showCheckbox?this._lastEleSelect||0:e.index(this.element.find("li.e-select")),t.shiftKey&&this.model.allowMultiSelection&&!this.model.showCheckbox){if(this._lastEleSelect==0)return!1;for(this._lastEleSelect=this._ctrlClick?this._lastEleSelect-1:this._lastEleSelect,i=this._lastEleSelect,this._selectedItem=i||i==0?i==0?this._listSize-1:this._down?i:i-1:0,u=this._selectedItem;n(r[u]).hasClass("e-disable");u--)this._selectedItem-=1;if(f=n(r[this._selectedItem]),f.hasClass("e-select")){if(this._selectedItem==0)return;f.removeClass("e-select");this._selectedItems.pop()}else f.addClass("e-select"),this._selectedItems.push(f);this.scrollerObj.setModel({scrollTop:this._calcScrollTop(this._selectedItem)});this._up=!0;this._down=!1;this._ctrlClick=!1}else{for(this._selectedItem=i||i==0?i==0?this._listSize-1:i-1:0,u=this._selectedItem;n(r[u]).hasClass("e-disable");u--)this._selectedItem-=1;this._addSelectedItem(t);n(r).removeClass("e-hover e-select");o=this.model.showCheckbox?"e-hover":"e-select";n(r[this._selectedItem]).addClass(o);this.scrollerObj.setModel({scrollTop:this._calcScrollTop(this._selectedItem)})}return this._OnListSelect(this._selectedItem+1,this._selectedItem,t),this._lastEleSelect=this._selectedItem,this._keyCascade(r[this._selectedItem]),this._setSelectionValues(),t.preventDefault(),!1;case 39:case 40:if(e=this.element.find("li"),i=this.model.showCheckbox?this._lastEleSelect||0:e.index(this.element.find("li.e-select")),t.shiftKey&&this.model.allowMultiSelection&&!this.model.showCheckbox){if(this._lastEleSelect==this._listSize-1)return!1;for(this._lastEleSelect=this._ctrlClick?this._lastEleSelect+1:this._lastEleSelect,i=this._lastEleSelect,this._selectedItem=i||i==0?i==this._listSize-1?0:this._up||this._ctrlClick?i:i+1:0,u=this._selectedItem;n(r[u]).hasClass("e-disable");u++)this._selectedItem+=1;f=n(r[this._selectedItem]);f.hasClass("e-select")?(f.removeClass("e-select"),this._selectedItems.pop()):(f.addClass("e-select"),this._selectedItems.push(f));this.scrollerObj.setModel({scrollTop:this._calcScrollTop(this._selectedItem)});this._up=!1;this._down=!0;this._ctrlClick=!1}else{for(this._selectedItem=i||i==0?i==this._listSize-1?0:i+1:0,u=this._selectedItem;n(r[u]).hasClass("e-disable");u++)this._selectedItem+=1;this._addSelectedItem(t);n(r).removeClass("e-hover e-select");o=this.model.showCheckbox?"e-hover":"e-select";n(r[this._selectedItem]).addClass(o);this.scrollerObj.setModel({scrollTop:this._calcScrollTop(this._selectedItem)})}return this._OnListSelect(this._selectedItem-1,this._selectedItem),this._lastEleSelect=this._selectedItem,this._keyCascade(r[this._selectedItem]),this._setSelectionValues(),!1;case 8:case 9:case 13:this.model.showCheckbox&&(this.model.checkedIndices.indexOf(this._selectedItem)<0?this.checkItemByIndex(this._selectedItem):this.uncheckItemByIndex(this._selectedItem));break;case 35:if(n(":focus").length&&n(":focus")[0].nodeName!="INPUT")return this._OnListSelect(this._selectedItem,this._listSize-1),this.selectItemByIndex(this._listSize-1),this.scrollerObj.setModel({scrollTop:this._calcScrollTop(this._listSize-1)}),this.model.showCheckbox&&(this._removeListHover(),n(r[this._listSize-1]).addClass("e-hover"),this._lastEleSelect=this._selectedItem=this._listSize-1),this._keyCascade(r[this._listSize-1]),t.preventDefault(),!1;break;case 36:if(n(":focus").length&&n(":focus")[0].nodeName!="INPUT")return this._OnListSelect(this._selectedItem,0),this.selectItemByIndex(0),this.scrollerObj.setModel({scrollTop:this._calcScrollTop(0)}),this.model.showCheckbox&&(this._removeListHover(),n(r[0]).addClass("e-hover"),this._lastEleSelect=this._selectedItem=0),this._keyCascade(r[0],t),t.preventDefault(),!1}}},_keyCascade:function(t,i){var r=this._getItemObject(n(t),i);r.isInteraction=!0;this._trigger("select",r);this.model.cascadeTo&&(this._activeItem=this._selectedItem,this._cascadeAction())},mergeData:function(i){var r,u;this.mergeUl=n();r=this;t.DataManager&&i instanceof t.DataManager?(u=i.executeQuery(this._getQuery()),u.done(function(n){r.mergeValue=n.result;r._renderlistContainer()})):(this.mergeValue=i,this._renderlistContainer())},_onScroll:function(i){var u,e,o,f;if(this._temp=this.model.dataSource,this.model.actionBegin&&this._trigger("actionBegin",{}),this._temp!=this.model.dataSource&&(t.DataManager&&this.model.dataSource instanceof t.DataManager?this._initDataSource(this.model.dataSource):this._showFullList()),u=this,e=this.element.find("li")[0],this.model.allowVirtualScrolling&&this.model.virtualScrollMode=="normal")this.itemIndex=parseInt(this.scrollerObj.scrollTop()/n(e).outerHeight()),this.realUllength=this.itemIndex,f=this.itemIndex,this.itemIndex>this.listContainer.height()/n(e).height()&&i.source!="wheel"?o=this.itemIndex+this._getLiCount():this.itemIndex>=0&&(o=parseInt(this.scrollerObj.scrollTop()/n(e).outerHeight()+this._getLiCount())),this.model.dataSource.length==r&&this._temp==this.model.dataSource?t.DataManager&&this.model.dataSource instanceof t.DataManager&&this._queryPromise(f,u,f+Math.round(this.model.height/this.listitemheight),i):this._temp!=this.model.dataSource?this._queryPromise(f,u,this._listitems.length,i):this.model.dataSource.length>0&&this._loadQueryData(f,o,u);else if(this.model.allowVirtualScrolling&&this.model.virtualScrollMode=="continuous"&&this.checkToLoadData>=this.scrollerObj._vScrollbar._scrollData.scrollable-this.scrollerObj.scrollTop()&&(this.lastScrollPosition=this.scrollerObj.scrollTop(),f=this.element.children().length,this.element.find("li").length<this.listitems.length))if(this.model.dataSource.length==r)t.DataManager&&this.model.dataSource instanceof t.DataManager&&this._queryPromise(f,u,f+this.model.itemRequestCount,i);else if(this.model.dataSource.length>0){if(this._isScrollComplete)return;this._loadQueryData(u.realUllength,u.realUllength+this.model.itemRequestCount,u)}},_queryPromise:function(n,t,i,r){this._trigger("itemRequest",{event:r,isInteraction:!0});var u=this.model.query.clone(),f=this.model.dataSource.executeQuery(u.range(n,i));this._updateLoadingClass(!0);f.done(function(i){t.realUllength=n;t._loadlist(i.result)._checkboxHideShow(t.model.showCheckbox)._showResult()._updateLoadingClass();t._applySelection();t.model.virtualScrollMode=="continuous"&&(t.scrollerObj.refresh(),t.scrollerObj.option("scrollTop",t.lastScrollPosition));t._trigger("actionSuccess",i)}).fail(function(n){t._trigger("actionFailure",n)}).always(function(n){t._trigger("actionComplete",n)})},_loadQueryData:function(n,t,i){this._isScrollComplete=t>=this.listitems.length?!0:!1;this._updateLoadingClass(!0);var r=this.model.dataSource;this._loadlist(r.slice(n,t))._showResult()._updateLoadingClass();i._applySelection();i.model.virtualScrollMode=="continuous"&&(i.scrollerObj.option("scrollTop",i.lastScrollPosition),i.scrollerObj.refresh())},_setText:function(t){for(i=0;i<this.listitems.length;i++)n(this.element.children("li")[i]).text()==t&&this.unselectAll().selectItemByIndex(i)},_getLiCount:function(){return parseInt(this.listContainer.height()/this.element.find("li").height())},_onDragStarts:function(n,t){return this._trigger("itemDragStart",{items:n,target:t})},_onDrag:function(n,t){return this._trigger("itemDrag",{items:n,target:t})},_onDragStop:function(n,t){return this._trigger("itemDragStop",{items:n,target:t})},_onDropped:function(n,t){return this._trigger("itemDrop",{items:n,target:t})},_OnKeyPress:function(n){this.model.enableIncrementalSearch&&this.model.enabled&&this._incrementalSearch(this._isMozilla?n.charCode:n.keyCode)},_incrementalSearch:function(t){var u,o,s,i;_proxy=this;u=String.fromCharCode(t);this._incqueryString!=u?this._incqueryString+=u:this._incqueryString=u;this._incqueryString.length>0&&this._typeInterval==null&&(this._typeInterval=setTimeout(function(){_proxy._incqueryString="";_proxy._typeInterval=null},_proxy._typingThreshold));var f=this.listContainer.find("ol,ul").children("li:not('.e-category')"),i,c=this.model.caseSensitiveSearch,r,h=this._incqueryString,l=this._incqueryString.length,e=!1;for(c||(h=h.toLowerCase()),o=this._activeItem,--o,s=this._activeItem!=f.length-1?this._activeItem+1:0,this._incqueryString.length>1&&(s=this._activeItem),i=s;i<f.length&&o!=i;i++)if(r=n.trim(n(f[i]).text()),r=c?r:r.toLowerCase(),r.substr(0,l)===h?(this._removeListHover(),this.element.children("li").removeClass("e-active"),this._selectedItem=i,this._addListHover(),e=!0):i==f.length-1&&e==!1&&(s!=0?(i=-1,++o):e=!0),e)break},_wireEvents:function(){this._on(this.listContainer,"focus",this._OnFocusIn);this._on(this.listContainer,"blur",this._OnFocusOut)},_OnFocusIn:function(){this._OnFocusOut();this._on(this.listContainer,"keydown",this._OnKeyDown);this._on(this.listContainer,"keypress",this._OnKeyPress)},_OnFocusOut:function(){this._off(this.listContainer,"keydown",this._OnKeyDown);this._off(this.listContainer,"keypress",this._OnKeyPress)}});t.VirtualScrollMode={Normal:"normal",Continuous:"continuous"}})(jQuery,Syncfusion)});