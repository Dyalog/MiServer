/*!
*  filename: ej.mobile.rotator.min.js
*  version : 13.3.0.18
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["jsrender","./../common/ej.core.min","./../common/ej.data.min","./ej.mobile.core.min","./ej.mobile.application.min","./../common/ej.unobtrusive.min","./../common/ej.touch.min","./ej.mobile.header.min"],n):n()})(function(){(function(n,t,r){t.widget("ejmRotator","ej.mobile.Rotator",{_setFirst:!0,_rootCSS:"e-m-rotator",_tags:[{tag:"items",attr:["imageUrl","text"]}],defaults:{targetId:null,renderMode:"auto",targetHeight:"auto",targetWidth:"auto",theme:"auto",currentItemIndex:0,showPager:!0,showHeader:!1,headerTitle:"Title",cssClass:"",swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,change:null,pagerSelect:null,dataBinding:!1,dataSource:null,orientation:"horizontal",pagerPosition:{horizontal:"bottom",vertical:"right"},enablePersistence:!1,windows:{renderDefault:!1},adjustFixedPosition:!1,items:[]},dataTypes:{renderMode:"enum",theme:"enum",showPager:"boolean",pagerPosition:{horizontal:"enum",vertical:"enum"},orientation:"enum",showHeader:"boolean",dataBinding:"boolean",adjustFixedPosition:"boolean",dataSource:"data",enablePersistence:"boolean",windows:{renderDefault:"boolean"}},observables:["currentItemIndex"],currentItemIndex:t.util.valueFunction("currentItemIndex"),_init:function(){App.activePage||App.createAppView();this._setValues();this._renderControl();this._wireEvents()},_setValues:function(){var f,u,r;if(t.setRenderMode(this),t.setTheme(this),this.model.renderMode=="windows"&&this.model.windows.renderDefault&&t.isMobile()&&(this.model.theme="default"),this._id=this.element.attr("id"),this.model.items.length!=0)for(this._wrapper=t.buildTag("div#"+this._id+"_container"),i=0;i<this.model.items.length;i++)this._wrapper.append(t.buildTag("div"));else if(this._wrapper=this.model.targetId?t.getCurrentPage().find("#"+this.model.targetId):n(this.element.children()[0]),this._wrapper[0].nodeName.toLowerCase()=="script"&&(this._wrapper=n(t.getClearString(this._wrapper[0].innerHTML)),(App.angularAppName||t.angular.defaultAppName)&&t.angular.compile(this._wrapper)),f=n(n(this._wrapper).children()[0]).attr("data-ej-imageUrl"),u=n(n(this._wrapper).children()[0]).attr("data-ej-text"),f||u)for(i=0;i<this._wrapper.children().length;i++)r={},r.imageUrl=n(n(this._wrapper).children()[i]).attr("data-ej-imageUrl"),u&&(r.text=n(n(this._wrapper).children()[i]).attr("data-ej-text")),this.model.items.push(r);this._divCount=this._wrapper.children().length;this._orgEle=this._wrapper;this._autoHeightWidthValues();this._browser=t.browser();this._startValues()},_autoHeightWidthValues:function(){if(this.model.adjustFixedPosition&&t.calculateWrapperOffset(this),this._mHeight=this.model.targetHeight=="auto"?this.model.adjustFixedPosition?window.innerHeight-(n(this._wrapper).length?t.getDimension(n(this._wrapper),"offset").top:"")-parseInt(n(this._wrapper).css("margin-bottom"))-(this.model.isFixedPosition?this._footerHeight:0)-parseInt(n(this._wrapper).css("padding-top"))-parseInt(n(this._wrapper).css("padding-bottom")):t.getDimension(this.element.parent(),"height"):parseInt(this.model.targetHeight),this._mWidth=this.model.targetWidth=="auto"?t.getDimension(this.element.parent(),"width"):parseInt(this.model.targetWidth),this.model.targetWidth=="auto"){this.element.css("width",this._mWidth);var i=this.element.closest(".subpage"),r=(i.length?t.getDimension(i,"innerWidth"):t.getDimension(this.element.closest(".appview"),"innerWidth"))-this.element.innerWidth();this._mWidth=this._mWidth+r}},_topLeftVaules:function(){this.model.renderMode=="android"?this._andSpanVal=(this.model.orientation=="horizontal"?this._mWidth:this._mHeight)/this._divCount:this._spanVal=(this.model.orientation=="horizontal"?this._mWidth:this._mHeight)/2-t.getDimension(this._span,"width")/2;this._span.addClass("e-m-sv-pager"+this.model.pagerPosition[this.model.orientation]+"")},_startValues:function(){this._moveEle=this._divCount>this.currentItemIndex()&&this.currentItemIndex()>=0?-(this.currentItemIndex()*(this.model.orientation=="horizontal"?this._mWidth:this._mHeight)):0;this._divEle=this._moveEle?this.currentItemIndex()+1:1;this._timeStart=0},_transform:function(n,t,i){var r="-"+this._browser+"-transform",u=this.model.orientation=="horizontal"?"translate3d("+n+"px,0px,0px) scale(1)":"translate3d(0px,"+n+"px,0px) scale(1)",f="-"+this._browser+"-transition-property",e="transform",o="-"+this._browser+"-transition-duration",s=t+"ms";i=="pager"?this._span.css(r,u).css(f,e).css(o,s):this._wrapper.css(r,u).css(f,e).css(o,s)},_renderControl:function(){t.setRenderMode(this);this.model.showHeader&&this._renderHeader();this.element.addClass("e-m-"+this.model.renderMode+" e-m-"+this.model.theme+" "+this.model.cssClass+" e-m-rotator e-m-user-select").append(this._wrapper);this.model.dataBinding?this._renderDatabind():this._renderDataProAndtemp()},_renderHeader:function(){this.element.addClass("e-m-rotatorheader");this.header=t.buildTag("div");this.element.append(this.header.ejmHeader({title:this.model.headerTitle,renderMode:this.model.renderMode,position:"normal"}));this.model.renderMode!="flat"&&this.header.ejmHeader({theme:this.model.theme})},_renderDatabind:function(){var n=t.buildTag("script#"+this._id+"_Template",{},{},{type:"text/x-jsrender"}),i=this._wrapper.find(">div"),r;i.remove();r=t.buildTag("div").append(i);n[0].text=r[0].innerHTML;t.getCurrentPage().append(n);this.model.dataSource&&this.renderDatasource(this.model.dataSource)},_renderDataProAndtemp:function(){this.model.items.length!=0&&(this._imgTag=this.model.items[0].imageUrl,this._textTag=this.model.items[0].text);(this._imgTag!=r||this._textTag!=r)&&this._tagCreate();this._scrollItem();this._transform(this._moveEle,350,"");this._renderPager()},_scrollItem:function(){this.element.css({width:""+this._mWidth+"px",height:""+(this._mHeight+this.element.find(".e-m-header").outerHeight())+"px"});this._wrapper.addClass("e-m-sv-container e-m-"+this.model.orientation+"").css({height:""+this._mHeight+"",width:""+this._mWidth+""});this._wrapper.children().addClass("e-m-rot-item")},_tagCreate:function(){var u=this._wrapper.find("div"),f,e;for(i=0;i<this._divCount;i++)this._imgTag!=r&&(f=t.buildTag("div").css({"background-image":"url("+this.model.items[i].imageUrl+")","background-position":"center","background-size":"100%","background-repeat":"no-repeat",height:"100%",width:"100%"})),this._textTag!=r&&(e=t.buildTag("p").html(this.model.items[i].text).css({"text-align":"center"})),this._imgTag!=r&&this._textTag!=r?n(u[i]).append(e).append(f):this._imgTag!=r&&this._textTag==r?n(u[i]).append(f):n(u[i]).append(e)},_renderPager:function(){if(this._span=t.buildTag("div.e-m-abs e-m-"+this.model.theme+""),t.isIOSWebView()&&this.model.showHeader&&this.model.pagerPosition[this.model.orientation]=="top"&&this._span.addClass("e-m-webview-pager"),this._wrapper.after(this._span),this.model.renderMode!="android"){for(i=0;i<this._divCount;i++)this._span.append(t.buildTag("span.e-m-sv-pager"));this._span.find(":nth-child("+this._divEle+")").addClass("e-m-active")}else this._span.append(t.buildTag("span.e-m-sv-pager e-m-active"));this._pagerPos();this._setShowPager()},_pagerPos:function(){this._topLeftVaules();this.model.renderMode=="android"?(this._spanTrans=(this._divEle-1)*this._andSpanVal,this.model.orientation=="horizontal"?this._span.children().css({width:""+this._andSpanVal+"px"}).fadeOut("slow"):this._span.children().css({height:""+this._andSpanVal+"px"}).fadeOut("slow"),this._transform(this._spanTrans,350,"pager")):this.model.orientation=="horizontal"?this._span.css("left",this._spanVal+"px"):this._span.css("top",this._spanVal+this.element.find(".e-m-header").outerHeight()+"px")},_wireEvents:function(i){this._onMouseDownDelg=n.proxy(this._onMouseDownHandler,this);this._onMouseMoveDelg=n.proxy(this._onMouseMoveHandler,this);this._onMouseUpDelg=n.proxy(this._onMouseUpHandler,this);t.listenTouchEvent(this._wrapper,t.startEvent(),this._onMouseDownDelg,i);this._pagerEvents(i)},_pagerEvents:function(i){this.model.renderMode!="android"&&(this._spanEle=this.element.find("div.e-m-abs").children(),this._onTouchStartDelegate=n.proxy(this._onTouchStartHandler,this),this._onTouchEndDelegate=n.proxy(this._onTouchEndHandler,this),t.listenEvents([this._spanEle,this._spanEle],[t.startEvent(),t.endEvent()],[this._onTouchStartDelegate,this._onTouchEndDelegate],i))},_onTouchStartHandler:function(t){this._index=n(t.currentTarget).index();this.model.currentItemIndex=this._index},_onTouchEndHandler:function(){this._moveEle=-(this._index*(this.model.orientation=="horizontal"?this._mWidth:this._mHeight));this._transform(this._moveEle,350,"");this._span.find(":nth-child("+this._divEle+")").removeClass("e-m-active");this._divEle=this._index+1;this._span.find(":nth-child("+this._divEle+")").addClass("e-m-active");var n={targetElement:this._wrapper,element:this._divEle};this.model.pagerSelect&&this._trigger("pagerselect",n)},resize:function(n){if(this.model.targetHeight=="auto"||this.model.targetWidth=="auto"){var i=this;window.setTimeout(function(){n.preventDefault();i._orientationAndResize()},t.isAndroid()?1e3:0)}},_orientationAndResize:function(){this._autoHeightWidthValues();var n=this.model.orientation=="horizontal"?this._mWidth:this._mHeight;this._moveEle=-(this._divEle*n-n);this._transform(this._moveEle,0,"");this._scrollItem();this._spanTrans=(this._divEle-1)*this._andSpanVal;this._pagerPos()},_onMouseDownHandler:function(n){t.isTouchDevice()&&(n=n.touches?n.touches[0]:n);this._startX=n.clientX;this._startY=n.clientY;this._timeStart=n.timeStamp||Date.now();t.listenEvents([this._wrapper,this._wrapper],[t.moveEvent(),t.endEvent()],[this._onMouseMoveDelg,this._onMouseUpDelg],!1);this.model.renderMode=="android"&&this._span.children().clearQueue()},_onMouseMoveHandler:function(n){var i,r,u;t.isTouchDevice()&&(n=n.touches?n.touches[0]:n);this._relativeX=n.clientX-this._startX;this._relativeY=n.clientY-this._startY;this.model.orientation=="horizontal"?(this._start=this._startX,this._relative=this._relativeX,this._distValue=this._mWidth,this._swipeLeftUp="swipeLeft",this._swipeRightDown="swipeRight"):(this._start=this._startY,this._relative=this._relativeY,this._distValue=this._mHeight,this._swipeLeftUp="swipeUp",this._swipeRightDown="swipeDown");this._start!=0&&Math.abs(this._relative)&&(this._relative<0&&this._divEle<this._divCount||this._relative>0&&this._divEle>1?(i=this._moveEle+this._relative,this._transform(i,0,"")):Math.abs(this._relative)<this._distValue/2&&(i=this._moveEle+this._relative,this._transform(i,0,"")));this._start!=0&&this.model.renderMode=="android"&&(r=this._relative/4,(this._relative<0&&this._divEle<this._divCount||this._relative>0&&this._divEle>1)&&(u=this._spanTrans-r),this._transform(u,0,"pager"),this._span.children().css("opacity",1).fadeIn("slow"));t.listenTouchEvent(this._wrapper,"mouseleave",this._onMouseUpDelg,!1)},_onMouseUpHandler:function(n){if(this._timeStart!=0){this._data={targetElement:this._wrapper,element:this._divEle};var u=(n.timeStamp||Date.now())-this._timeStart,r={dist:0,time:0},f=this._relative>0?!0:!1,i=this._relative;u<300&&(r=this._relative?this._momentum(this._relative,u,f?this._relative:-this._relative,this._distValue+this._relative,this._distValue):r,i=this._relative+r.dist);i<0&&Math.abs(i)>this._distValue/2&&this._divEle<this._divCount?(this._moveEle+=-this._distValue,this._movePager(!0),this._transform(this._moveEle,350,""),(this.model.swipeLeft||this.model.swipeUp)&&this._trigger(this._swipeLeftUp,this._data)):i>0&&Math.abs(i)>this._distValue/2&&this._divEle>1&&(this._moveEle-=-this._distValue,this._movePager(!1),this._transform(this._moveEle,350,""),(this.model.swipeRight||this.model.swipeDown)&&this._trigger(this._swipeRightDown,this._data));this._transform(this._moveEle,350,"");this.model.renderMode=="android"&&(this._transform(this._spanTrans,350,"pager"),this._span.children().fadeOut("slow"));this._timeStart=0;this._startX=0;this._relativeX=0;this._relative=0;this._start=0;t.listenEvents([this._wrapper,this._wrapper],[t.moveEvent(),t.endEvent()],[this._onMouseMoveDelg,this._onMouseUpDelg],!0)}this.currentItemIndex(this._divEle-1)},_momentum:function(n,t,i,r,u){var o=.0006,e=Math.abs(n)/t,f=e*e/(2*o),h=0,s=0;return n>0&&f>i?(s=u/(6/(f/e*o)),i=i+s,e=e*i/f,f=i):n<0&&f>r&&(s=u/(6/(f/e*o)),r=r+s,e=e*r/f,f=r),f=f*(n<0?-1:1),h=e/o,{dist:f,time:Math.round(h)}},_movePager:function(n){this.model.renderMode!="android"?(this._span.find(":nth-child("+this._divEle+")").removeClass("e-m-active"),this._divEle=n?this._divEle+1:this._divEle-1,this._span.find(":nth-child("+this._divEle+")").addClass("e-m-active"),this._spanTrans=(this._divEle-1)*this._andSpanVal):(this._divEle=n?this._divEle+1:this._divEle-1,this._spanTrans=(this._divEle-1)*this._andSpanVal,this._transform(this._spanTrans,350,"pager"),this._span.children().fadeOut("slow"));this._data={targetElement:this._wrapper,element:this._divEle};this.model.change&&this._trigger("change",this._data)},_setModel:function(n){var r=!1,t,i;for(t in n)(t!="swipeLeft"||t!="swipeRight")&&(i="_set"+t.charAt(0).toUpperCase()+t.slice(1)),this[i]?this[i]():r=!0;r&&this._refresh()},_setRenderMode:function(){this.element.removeClass("e-m-ios7 e-m-android e-m-windows e-m-flat").addClass("e-m-"+this.model.renderMode+"");this.element.find(".e-m-header").ejmHeader({renderMode:this.model.renderMode});this._pagerEvents(!0);this._span.remove();this._renderPager();this._pagerEvents(!1)},_setTheme:function(){this.element.removeClass("e-m-dark e-m-light").addClass("e-m-"+this.model.theme+"");this._span.removeClass("e-m-dark e-m-light").addClass("e-m-"+this.model.theme+"");this.element.find(".e-m-header").ejmHeader({theme:this.model.theme})},_setShowHeader:function(){this.model.currentItemIndex=this._divEle-1;this._refresh()},_setHeaderTitle:function(){this.element.find(".e-m-header").ejmHeader({title:this.model.headerTitle})},_setShowPager:function(){this.model.showPager?this._span.css("display","block"):this._span.css("display","none")},_setPagerPosition:function(){this._span.removeClass("e-m-sv-pagertop e-m-sv-pagerbottom e-m-sv-pagerleft e-m-sv-pagerright");this._span.addClass("e-m-sv-pager"+this.model.pagerPosition[this.model.orientation]+"");t.isIOSWebView()&&this.model.showHeader&&this.model.pagerPosition[this.model.orientation]=="top"&&this._span.addClass("e-m-webview-pager")},_setOrientation:function(){this.model.currentItemIndex=this._divEle-1;this._refresh()},_setCurrentItemIndex:function(){this.model.renderMode!="android"&&this._span.find(":nth-child("+this._divEle+")").removeClass("e-m-active");this._startValues();this._transform(this._moveEle,1e3,"");this._spanTrans=(this._divEle-1)*this._andSpanVal;this.model.renderMode!="android"?this._span.find(":nth-child("+this._divEle+")").addClass("e-m-active"):this._transform(this._spanTrans,350,"pager")},_refresh:function(){this._destroy();this._init()},_destroy:function(){this._wireEvents(!0);this._wrapper.children().removeAttr("class style");this.element.removeAttr("class style").children().removeAttr("class style").remove();this._span.remove();App.activePage.append(this._orgEle)},renderDatasource:function(t){var i=n.templates("#"+this._id+"_Template"),r=i.render(t);this._wrapper.html(r);this._divCount=this._wrapper.children().length;this._scrollItem();this._transform(this._moveEle,350,"");this._renderPager();this._wireEvents()}});t.mobile.Rotator.Orientation={Horizontal:"horizontal",Vertical:"vertical"};t.mobile.Rotator.PagerPositionHorizontal={Bottom:"bottom",Top:"top"};t.mobile.Rotator.PagerPositionVertical={Right:"right",Left:"left"}})(jQuery,Syncfusion)});