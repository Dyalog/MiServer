/*!
*  filename: ej.schedule.min.js
*  version : 13.3.0.18
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["jquery-easing","globalize","jsrender","./../common/ej.core.min","./../common/ej.data.min","./../common/ej.touch.min","./../common/ej.draggable.min","./../common/ej.scroller.min","./ej.button.min","./ej.checkbox.min","./ej.autocomplete.min","./ej.datepicker.min","./ej.dialog.min","./ej.dropdownlist.min","./ej.togglebutton.min","./ej.radiobutton.min","./ej.timepicker.min","./ej.editor.min","./ej.navigationdrawer.min"],n):n()})(function(){(function(n,t){t.scheduleFeatures=t.scheduleFeatures||{};var i=function(){return this._horiDateHeader="{{if multiRes == true}}<td class = 'e-horizontalheader'><div class='e-horizontalresheader'>{{:label}}<\/div><\/td>{{else}}{{/if}}<td class='e-horizontaldaterender'><div class='e-horizontaltimecells' style='height:{{:height}}px;'><div class='e-headerdays' style='position:absolute;'><table class ='e-table' cellpadding='0px' cellspacing='0px' style='width:100%;border-collapse:separate;'><tbody>{{if view !== 'month'}}<tr style='width:100%;'> <td>{{if view === 'day'}}<table cellspacing='0px' style='width:100%;'>{{else}}<table class='e-table' cellspacing='0px'>{{/if}}<tbody><tr> {{for cols ~headercellWidth = headercellWidth}}<td class='e-headercells {{:cellToday}} e-horizontalheadertddate'><div class='{{:currentDateClass}} e-horizontalheaderdiv'>{{:currentDay}}<\/div><\/td>{{/for}} <\/tr><\/tbody><\/table><\/td> <\/tr><tr style='width:100%;position:absolute;'> <td><table class =' e-table e-horizontaltabletimecell' cellspacing='0px' style='border-collapse:collapse;'><tbody><tr> {{for timeTdCount  ~columnvalue =column  }}{{for ~name=time ~dayend=timecellclass ~index=#getIndex() }}<td class='e-horizontaltimetd {{:~dayend}}'><div style='width:{{:timeCellWidth}}'><span class ='e-horizontaltimespan'>{{:~name.slice(0,2)}}<\/span><div class ='e-horizontaltimespandiv'>{{:~name.slice(3,5)}}<\/div><\/div><\/td>{{for ~columnvalue[~index] ~width = timeCellWidth}}<td class='e-horizontalalternatetd'><div style='width:{{:~width}}'><\/div><\/td>{{/for}}{{/for}}{{/for}}  <\/tr><\/tbody><\/table><\/td> <\/tr>{{/if}}{{if view == 'month'}}<tr>{{for cols}}<td class='e-headercells e-horizontmonthheaderdatetd {{:cellToday}}'><div class='e-dateheadercell e-horizontmonthdatealign'>{{:currentDate}}<\/div><\/td>{{/for}}<\/tr><tr>{{for cols}}<td class ='e-horizontmonthheaderdaytd'><div class='e-dateheadercell e-horizontmonthdatealign' style='width:{{:cellWidth}}'>{{:currentDay}}<\/div><\/td>{{/for}}<\/tr>{{/if}}<\/tbody><\/table><\/div><\/div><\/td>",this._horiDateHeader},r=function(){return this._userTimeCellsHoriTemplate="{{if multiRes == true}}<td class = 'e-horizontalheader'><div class='e-horizontalresheader'>{{:label}}<\/div><\/td>{{else}}{{/if}}<td class='e-horizontaldaterender'><div class='e-horizontaltimecells' style='height:{{:height}}px;'><div class='e-headerdays' style='position:absolute;'><table class ='e-table' cellpadding='0px' cellspacing='0px' style='width:100%;border-collapse:separate;'><tbody>{{if view !== 'month'}}<tr style='width:100%;'> <td>{{if view === 'day'}}<table cellspacing='0px' style='width:100%;'>{{else}}<table class='e-table' cellspacing='0px'>{{/if}}<tbody><tr> {{for cols ~headercellWidth = headercellWidth}}<td class='e-headercells {{:cellToday}} e-horizontalheadertddate'><div class='{{:currentDateClass}} e-horizontalheaderdiv'>{{:currentDay}}<\/div><\/td>{{/for}} <\/tr><\/tbody><\/table><\/td> <\/tr><tr style='width:100%;position:absolute;'> <td><table class='e-table e-horizontaltabletimecell' cellspacing='0px' style='border-collapse:collapse;'><tbody><tr> {{for timeTdCount  ~userTemplateId = userTemplateId  ~template=template  ~columnvalue =column}}{{for ~name=time ~names=times ~dayend=timecellclass }}<td class='e-horizontaltimetd {{:~dayend}}'><div style='width:{{:timeCellWidth}}'><span class ='e-horizontaltimespan'>{{:~name}}<\/span><div class ='e-horizontaltimespandiv'><\/div><\/div><\/td>{{for ~columnvalue ~width = timeCellWidth ~names=~names}}<td class='e-horizontalalternatetd' style='vertical-align:middle !important;'><div style='width:{{:~width}};' > {{if ~template ==true || ~userTemplateId==true }}{{:~names[#getIndex()]}}{{else}}<\/div>{{/if}}<\/td>{{/for}}{{/for}}{{/for}}  <\/tr><\/tbody><\/table><\/td> <\/tr>{{/if}}{{if view == 'month'}}<tr>{{for cols}}<td class='e-headercells e-horizontmonthheaderdatetd {{:cellToday}}'><div class='e-dateheadercell e-horizontmonthdatealign'>{{:currentDate}}<\/div><\/td>{{/for}}<\/tr><tr>{{for cols}}<td class ='e-horizontmonthheaderdaytd'><div class='e-dateheadercell e-horizontmonthdatealign' style='width:{{:cellWidth}}'>{{:currentDay}}<\/div><\/td>{{/for}}<\/tr>{{/if}}<\/tbody><\/table><\/div><\/div><\/td>",this._userTimeCellsHoriTemplate},u=function(){return this._horizontalResHeader="<div class ='e-horizontresdiv'><div class='e-horires' style='height:100%'><table class='e-table e-resourceheadertable' height='100%' width='100%' cellpadding='0px' cellspacing='0px' style='table-layout:fixed'><tbody>{{for trs}}<tr>{{for ~resname=name ~marginleft=marginleft }}{{if classname == 'e-parentnode'}}<td class='{{:classname}}' style='width:25px;height:{{:cellHeight}}'><\/td>{{else}}<td style='width:25px;height:{{:cellHeight}}'><\/td>{{/if}}<td class='{{:classname}}' style='vertical-align:middle;height:{{:cellHeight}}'><div class='e-resourceheadertext' style='text-align:left;margin-left:{{:~marginleft}};' title='{{if userResTemplId == true}}{{:name}}{{else}}{{:~resname}}{{/if}}'>{{if userResTemplId == true}}{{:userResHeader}}{{else}}{{:~resname}}{{/if}}<\/div><\/td>{{if classname == 'e-parentnode'}}<td id={{:idnum}} class='{{:classname}} {{:classname}}category e-resourceicon e-resourcecollapse' style='width:25px;vertical-align:middle;height:{{:cellHeight}}'><\/td>{{else}}<td class='{{:classname}} {{:classname}}category' style='width:25px;height:{{:cellHeight}}'><\/td>{{/if}}{{/for}}<\/tr>{{/for}}<\/tbody><\/table><\/div><\/div><div class='e-resfootertr' style='height:18px;'><\/div>",this._horizontalResHeader},f=function(){return this._cellsTemplate="<table class='e-table e-workcellstab' height='100%' cellpadding='0px' cellspacing='0px'><tbody>{{for cellrows ~cols=cols ~hourdiff=hourdiff ~view=view ~classname=classname ~tdWidth=tdWidth ~columnvalue=column ~userTemp=userTemplate ~userHtml=userHtml}}{{if classname == 'e-parentnode'}} <tr class='e-resourceheadertr' style='width:100%'>{{for ~cols ~tdWidth=tdWidth ~value=#getIndex()}}{{if #index % ~hourdiff == 0 && #index != 0 && ~view !== 'month' }}<td class='e-resourceheadercells e-workcells e-parentworkcell e-dayend' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{else}}<td class='e-resourceheadercells e-workcells e-parentworkcell' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{/if}}<div class='e-appointwrapper'><\/div>{{if ~userTemp == true}}{{if ~view !== 'month'}}{{:~userHtml[~value][0][#getIndex()]}}{{else}}{{:~userHtml[~value][#getIndex()]}}{{/if}}{{/if}}<\/td>{{if ~view !== 'month' ~val=#index}}{{for ~columnvalue[#getIndex()] ~width = cellWidth}}<td class='e-resourceheadercells e-workcells e-parentworkcell e-alternateworkcell' style='width:{{:~width}};height:{{:cellHeight}}'><div class='e-appointwrapper'><\/div>{{if ~userTemp == true}}{{:~userHtml[~value][1][~val][#getIndex()]}}{{/if}}<\/td>{{/for}}{{/if}}{{/for}}<\/tr>{{else}}<tr style='width:100%'>{{for ~cols ~tdWidth=tdWidth ~value=#getIndex()}}{{if #index % ~hourdiff == 0 && #index != 0 && ~view !== 'month'  }}<td class='e-workcells e-childworkcell e-dayend' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{else}}<td class='e-workcells e-childworkcell' style='width:{{:cellWidth}};height:{{:cellHeight}}'>{{/if}}<div class='e-appointwrapper'><\/div>{{if ~userTemp == true}}{{if ~view !== 'month'}}{{:~userHtml[~value][0][#getIndex()]}}{{else}}{{:~userHtml[~value][#getIndex()]}}{{/if}}{{/if}}<\/td>{{if ~view !== 'month' ~val=#index}}{{for ~columnvalue[#getIndex()] ~width = cellWidth}}<td class='e-workcells e-childworkcell e-alternateworkcell' style='width:{{:~width}};height:{{:cellHeight}}'><div class='e-appointwrapper'><\/div>{{if ~userTemp == true}}{{:~userHtml[~value][1][~val][#getIndex()]}}{{/if}}<\/td>{{/for}}{{/if}}{{/for}}<\/tr>{{/if}}{{/for}}<\/tbody><\/table>",this._cellsTemplate};t.scheduleFeatures.horizontal={_renderHorizontalTemplates:function(){this.horizontalHeader=n.templates(this._createTemplate(i(),"_HorizontalHeader"));this.cellTemplate=n.templates(this._createTemplate(f(),"_HorizontalCells"));this.horizontalResHeader=n.templates(this._createTemplate(u(),"_HorizontalResources"));this.userTimeCellHoriTemplate=n.templates(this._createTemplate(r(),"_userTimeCells"))},_horizontalViewNavigation:function(i){var e,r,o,h,u,c,f,l,s;if(i.type=="click"){if(this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7){if(this.element.find(".e-headercells").children().removeClass("e-activeview"),e=i.currentTarget.cellIndex,r=new Date(this._getRenderDates()[e]),this.model.minDate<=r&&this.model.maxDate>=r)this.model.timeScale.enable&&n(i.currentTarget).children().addClass("e-activeview"),this.currentDate(r);else return!1;this.model.highlightBusinessHours!=!0||t.isNullOrUndefined(this.model.businessStartHour)?(o=this.element.find(".e-workcells")[parseInt(e*(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))].offsetLeft,this.element.find(".e-hscroll").length>0&&(this.model.enableRTL?(h=this.element.find(".e-workcells")[0].offsetLeft,u=h-o,n("div#"+this._id+"_scroller").ejScroller({scrollLeft:u}),c=h+this.element.find(".e-workcells").width()-this.element.find(".e-draggableworkarea").width(),u=u>=c?c:u,n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",u+"px")):(n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-o+"px"),n("div#"+this._id+"_scroller").ejScroller({scrollLeft:o})))):this._businessHourScroller()}else if(this.currentView()=="month"||this._isCustomView()){if(e=i.currentTarget.cellIndex,this.model.views.indexOf("day")==-1)return!1;if(r=new Date(this.monthDays[e]),this.model.minDate<=r&&this.model.maxDate>=r)this.currentDate(r);else return!1;s="day";this._navView=!0;this._viewChange(i,this.currentView(),s)}}else if(i.type=="dblclick"&&(this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7)){if(f=n(i.target),l=f.hasClass("e-headercells")?f:f.parent().hasClass("e-headercells")?f.parent():f.parent().parent(),this.model.views.indexOf("day")==-1||!l.hasClass("e-headercells"))return!1;if(r=new Date(this._getRenderDates()[l.index()]),this.model.minDate<=r&&this.model.maxDate>=r)this.currentDate(r);else return!1;s="day";this._navView=!0;this._viewChange(i,this.currentView(),s)}},_renderHorizontalHeaderDays:function(i){var u,e,r,o,s,f;if(this.element.find(".e-headercells").addClass("e-dateheaderselect"),this.currentView()!=="month"&&!this._isCustomView()){for(r=0;r<this._dateRender.length;r++)u=this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?i.calendar.days.names[new Date(this._dateRender[r]).getDay()]:i.calendar.days.names[new Date(this._dateRender[r]).getDay()].slice(0,3):i.calendar.days.names[new Date(this._dateRender[r]).getDay()].slice(0,3),e=this.model.timeScale.enable?this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?u+" "+Globalize.format(new Date(this._dateRender[r]),"dd MMMM yyyy"):u+" "+Globalize.format(new Date(this._dateRender[r]),"dd MMM yy"):u+" "+new Date(this._dateRender[r]).getDate():this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?Globalize.format(new Date(this._dateRender[r]),"dd MMMM yyyy"):Globalize.format(new Date(this._dateRender[r]),"dd MMM yy"):("0"+new Date(this._dateRender[r]).getDate()).slice(-2),n(this.element.find(".e-headercells")[r]).find("div")[0].innerHTML=e;o=new Date(this.currentDate());this.model.orientation=="horizontal"&&this.currentView()!="month"&&this.model.timeScale.enable&&(s=this.element.find(".e-headercells").children(".e-activeview").parent().index(),this.element.find(".e-headercells").children().removeClass("e-activeview"),f=this.currentView()==="day"?0:this.currentView()==="workweek"?o.getDay()-1:s,this.currentView()!="day"&&n(this.element.find(".e-headercells")[f]).children().addClass("e-activeview"),new Date(new Date(this.currentDate()).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()?n(this.element.find("td.e-horizontalheadertddate")[f]).addClass("e-headerToday"):"")}},_horizontalScroll:function(t,i){if(i.currentView()=="week"||i.currentView()=="workweek"||this.currentView()==="customview"&&this._renderDays<=7){var u=n(i.element.find(".e-headercells").find(".e-activeview").parent()).index(),r=Math.floor(Math.abs(t.scrollLeft)/(i.element.find(".e-workcells").width()+1)/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)));u!==r&&i.element.find(".e-headercells").children().removeClass("e-activeview");n(i.element.find(".e-headercells")[r]).children().addClass("e-activeview");this.model.timeScale.enable||i.element.find(".e-headercells").children().removeClass("e-activeview")}},_getHorizontalheaderCellCount:function(n){for(var f=[],i=0;i<this._dateRender.length;i++){var r=this.currentView()==="month"||this.currentView()==="day"||this._isCustomView()?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?n.calendar.days.names[new Date(this._dateRender[i]).getDay()]:n.calendar.days.names[new Date(this._dateRender[i]).getDay()].slice(0,3):n.calendar.days.names[new Date(this._dateRender[i]).getDay()].slice(0,3),u=new Date(new Date(this._dateRender[i]).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()?"e-headerToday":"",e=this.currentView()==="month"||this._isCustomView()?{currentDay:r,currentDateClass:"",cellToday:u,cellWidth:this.model.cellWidth}:this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?{currentDay:r+" "+Globalize.format(new Date(this._dateRender[i]),"dd MMMM yyyy"),currentDateClass:"",cellToday:u,cellWidth:this.model.cellWidth}:{currentDay:r+" "+Globalize.format(new Date(this._dateRender[i]),"dd MMM yy"),currentDateClass:"",cellToday:u,cellWidth:this.model.cellWidth}:{currentDay:r+" "+new Date(this._dateRender[i]).getDate(),currentDateClass:new Date(this._dateRender[i]).getDate()===new Date(this.currentDate()).getDate()?"e-activeview":"",cellToday:u,cellWidth:this.model.cellWidth};f.push(e)}return f},_getHoriStartEndTime:function(i){var h=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate),a,c,e,v,f,y,p,w,s,u,r,o;for(h&&(a=n.templates(n(this.model.timeScale.majorSlotTemplate).html()),c=n.templates(n(this.model.timeScale.minorSlotTemplate).html())),e=[],v=this.currentView()=="week"?7:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:this.model.workWeek.length,f=0;f<v;f++)if(h){var s=new Date((new Date).setHours(0,0,0,0)),r=0,l=[];for(u=this.model.startHour;u<this.model.endHour;){for(y=this.model.timeScale.majorSlot+r,p=r;r<y;)w=r,r=r*6e4,h?w==p?o=t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)?c.render(object={date:new Date(new Date(this._dateRender[0]).setHours(u,0,0,r))}):a.render(object={date:new Date(new Date(this._dateRender[0]).setHours(u,0,0,r))}):t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)||l.push(c.render(object={date:new Date(new Date(this._dateRender[0]).setHours(u,0,0,r))}).trim()):this._timeMode==="12"?(o=(u===this.model.startHour||u===12)&&i.AM&&i.PM&&r==0?Globalize.format(new Date(new Date(s).setHours(u,0,0,r)),"hh tt"):Globalize.format(new Date(new Date(s).setHours(u,0,0,r)),"hh:mm tt"),e.push({time:o,id:u+"_"+r,timecellclass:u==this.model.startHour&&f!=0&&r==0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight,timeCellWidth:this.model.cellWidth?this._browserInfo.name=="webkit"?parseInt(this.model.cellWidth)-1+"px":this.model.cellWidth:this._browserInfo.name=="webkit"?"29px":"30px"})):e.push({time:(u<=9?"0"+u:u)+" 00",timecellclass:u%((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount)==this.model.startHour&&f!=0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight,timeCellWidth:this.model.cellWidth?this._browserInfo.name=="webkit"?parseInt(this.model.cellWidth)-1+"px":this.model.cellWidth:this._browserInfo.name=="webkit"?"29px":"30px"}),r=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)?r/6e4+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount:r/6e4+this.model.timeScale.majorSlot;u=this.model.timeScale.majorSlot>60?u+this.model.timeScale.majorSlot/60:r>=60?u+1:u;r=r>=60?0:r;h&&(r==this.model.timeScale.majorSlot||r==0)&&(e.push({time:o.trim(),times:l,id:u+"_"+r,timecellclass:u-1==this.model.startHour&&f!=0&&r==0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight,timeCellWidth:this.model.cellWidth?this._browserInfo.name=="webkit"?parseInt(this.model.cellWidth)-1+"px":this.model.cellWidth:this._browserInfo.name=="webkit"?"29px":"30px"}),l=[])}}else for(s=new Date((new Date).setHours(0,0,0,0)),u=this.model.startHour;u<this.model.endHour;){for(r=0;r<60;)r=r*6e4,this._timeMode==="12"?(o=(u===this.model.startHour||u===12)&&i.AM&&i.PM&&r==0?Globalize.format(new Date(new Date(s).setHours(u,0,0,r)),"hh tt"):Globalize.format(new Date(new Date(s).setHours(u,0,0,r)),"hh:mm tt"),e.push({time:o,id:u+"_"+r,timecellclass:u==this.model.startHour&&f!=0&&r==0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight,timeCellWidth:this.model.cellWidth?this._browserInfo.name=="webkit"?parseInt(this.model.cellWidth)-1+"px":this.model.cellWidth:this._browserInfo.name=="webkit"?"29px":"30px"})):e.push({time:(u<=9?"0"+u:u)+" 00",timecellclass:u%((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount)==this.model.startHour&&f!=0?"e-dayend":"",cellWidth:this.model.cellWidth?this.model.cellWidth:"30px",cellHeight:this.model.cellHeight,timeCellWidth:this.model.cellWidth?this._browserInfo.name=="webkit"?parseInt(this.model.cellWidth)-1+"px":this.model.cellWidth:this._browserInfo.name=="webkit"?"29px":"30px"}),r=r/6e4+this.model.timeScale.majorSlot;u=this.model.timeScale.majorSlot>60?u+this.model.timeScale.majorSlot/60:u+1}return e},_getHorizontalDayAppointments:function(n,i,r,u){for(var e,f=0;f<n.length;f++)e=!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1?new t.DataManager(this.model.resources[this.model.resources.length-1].resourceSettings.dataSource).executeLocal((new t.Query).where("groupId",t.FilterOperators.equal,parseInt(n[f][this.model.appointmentSettings.resourceFields.split(",")[this.model.appointmentSettings.resourceFields.split(",").length-2]]))):this.res1,e.length!=0&&(new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()==new Date(new Date(n[f][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()<=new Date(new Date(n[f][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?n[f][this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]==this.res1[u][this.model.resources[this.model.resources.length-1].resourceSettings.id]:!0&&new Date(new Date(n[f][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(n[f][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime())&&(this._renderApp(n[f],r,u),this._filtered.push(n[f]))},_renderHorizontalApp:function(i,r,u,f,e,o,s,h){var ht=this.element.find(".e-workcellstab tr"),ct=this._getResourceCollection(),nt,l,b,a,rt,tt,ut,at,it,y,p,c,et,ot,ft,st,k,w,d;if(i<=r&&(rt=new Date(i).getHours()<s?new Date(i).getHours()+-new Date(i).getHours()+-new Date(i).getMinutes():new Date(i).getHours()+-s,tt=new Date(r).getHours()>h?new Date(r).getHours()+(-new Date(r).getHours()+(h-s))+-new Date(r).getMinutes():new Date(r).getHours()+-s,tt=new Date(r).getHours()==h?new Date(tt).getMinutes()+-new Date(r).getMinutes():tt,nt=20,b=0,ut=0,this.model.startHour<=new Date(i).getHours())){var v=!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1?this._findResourceIndex(ct[0].dataSource,ct[0].id,u[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-2]])+1:0,g=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this._findResourceIndex(this.level_Resources,this.model.resources[this.model.resources.length-1].resourceSettings.id,u[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]])+1:1,lt=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?this._overlapApp(u.AppTaskId,u[this.model.appointmentSettings.startTime],u[this.model.appointmentSettings.endTime],u[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):this._overlapApp(u.AppTaskId,u[this.model.appointmentSettings.startTime],u[this.model.appointmentSettings.endTime],null);if(t.isNullOrUndefined(this.model.group)||(this.overlapList=new t.DataManager(lt).executeLocal((new t.Query).where("roomId",t.FilterOperators.equal,u.roomId))),at=this,ut=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?this._getOverlapCount(u,f,this._dateRender,u[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):this._getOverlapCount(u,f,this._dateRender,null),b=b+ut*nt,u[this.model.appointmentSettings.allDay])it=new Date(new Date(new Date(r).setHours(0,0,0,0)).getTime())-new Date(new Date(new Date(i).setHours(0,0,0,0)).getTime()),y=Math.round(it/864e5)+1,y>this._dateRender.length&&(y=new Date(this._dateRender[this._dateRender.length-1]).getDay()+1-new Date(i).getDay()),p=y*(h-s)*60,c=(this.model.endHour-this.model.startHour)*o*f,ft=Math.round((u[this.model.appointmentSettings.endTime]-u[this.model.appointmentSettings.startTime])/36e5),l=this.element.find(".e-workcells").outerWidth()/30*p+(p/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-1),a="0";else if(new Date(new Date(new Date(u[this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime())<new Date(new Date(new Date(u[this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()))it=new Date(new Date(new Date(r).setHours(0,0,0,0)).getTime())-new Date(new Date(new Date(i).setHours(0,0,0,0)).getTime()),et=new Date(r)<new Date(new Date(r).setHours(this.model.endHour,0,0))&&new Date(r)<new Date(new Date(r).setHours(this.model.startHour,0,0))?this.model.endHour*30:new Date(r).getHours()*60+new Date(r).getMinutes(),ot=new Date(i)>new Date(new Date(r).setHours(this.model.startHour,0,0))?this.model.startHour*60:new Date(i).getHours()*60+new Date(i).getMinutes(),y=Math.round(it/864e5),p=y*(h-s)*60-ot+et,c=(this.model.endHour-this.model.startHour)*o*(60/this.model.timeScale.majorSlot)*f+rt*o*(60/this.model.timeScale.majorSlot),ft=Math.round((u[this.model.appointmentSettings.endTime]-u[this.model.appointmentSettings.startTime])/36e5),l=this.element.find(".e-workcells").outerWidth()/30*p+ft*o,y>this._dateRender.length&&(y=new Date(this._dateRender[this._dateRender.length-1]).getDay()+1-new Date(i).getDay(),p=y*(h-s)*60,l=p/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*this.element.find(".e-workcells").width()+(p/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-3)),a=parseFloat(new Date(i).getMinutes())*this.element.find(".e-workcells")[0].offsetWidth*o/this.model.timeScale.majorSlot;else{if(a=parseFloat(new Date(i).getMinutes()+new Date(i).getMilliseconds()/60)*n(this.element.find(".e-workcells")[1]).width()*this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot,this.model.endHour-this.model.startHour==24)st=new Date(r).getHours()*60+new Date(r).getMinutes()-(new Date(i).getHours()*60+new Date(i).getMinutes());else var et=new Date(r).getHours()*60+new Date(r).getMinutes()>this.model.endHour*60?this.model.endHour*60:new Date(r).getHours()*60+new Date(r).getMinutes(),ot=new Date(i).getHours()*60+new Date(i).getMinutes()<this.model.startHour*60?this.model.startHour*60:new Date(i).getHours()*60+new Date(i).getMinutes(),st=et-ot;l=st/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*this.element.find(".e-workcells").width()+(st/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-2);c=(this.model.endHour-this.model.startHour)*o*(60/this.model.timeScale.majorSlot)*f+rt*o*(60/this.model.timeScale.majorSlot)}if(k=this._appointmentColor(u),b+nt<e){var vt=this.model.appointmentTemplateId?!0:!1,yt=this._getUserAppointmentTemplate(u),pt=this._timeMode=="12"?Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),this._pattern.t):Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"HH:mm"),wt=this._timeMode=="12"?Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),this._pattern.t):Globalize.format(new Date(u[this.model.appointmentSettings.endTime]),"HH:mm"),bt=this.appTemplate.render({id:u.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),appHeight:nt,rtl:this.model.enableRTL,subject:u[this.model.appointmentSettings.subject],startTime:pt,endTime:wt,left:a+"px",top:b,appWidth:l+"px",userAppTemplId:vt,userTemplate:yt,appClass:"e-appointment",appointData:k.appointColor.appointData,appointCustomcss:k.appointColor.appointCustomcss,appointtextcolor:k.appointColor.appointtextcolor,value:k.value,multiDiv:k.multiDiv,orientation:this.model.orientation,priority:this.model.prioritySettings.enable?u[this.model.appointmentSettings.priority]:"",enablePriority:this.model.prioritySettings.template,priorityTemplate:this.model.prioritySettings.template?this._priorityTemplate(u):u[this.model.appointmentSettings.priority],uid:u.Guid});n(n(ht[g+v-1]).find("div.e-appointwrapper")[c]).append(bt);!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1&&(w=this._getResourceColor(u),d=w.appointData==""?"e-categorycolor":"",this.model.enableRTL?n(n(this.element.find(".e-resourceheadertr")[v-1]).find("div.e-appointwrapper")[c]).append("<div class='e-categorybar "+d+"' id='categorybar_"+u.Guid+"' style='position:absolute;height:"+this.element.find(".e-resourceheadercells").height()+"px;background:"+w.appointData+";width:"+(l+1)+"px;right:"+a+"px;'><\/div>"):n(n(this.element.find(".e-resourceheadertr")[v-1]).find("div.e-appointwrapper")[c]).append("<div class='e-categorybar "+d+"' id='categorybar_"+u.Guid+"' style='position:absolute;height:"+this.element.find(".e-resourceheadercells").height()+"px;background:"+w.appointData+";width:"+(l+1)+"px;left:"+a+"px;'><\/div>"))}else n("#"+this._id+"_"+Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(g+v-1)+"_"+c).length==0&&(n(n(ht[g+v-1]).find("div.e-appointwrapper")[c]).append('<div id="'+this._id+"_"+Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(g+v-1)+"_"+c+'" class="e-icon e-appsoverflow"><\/div>'),!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1&&(w=this._getResourceColor(u),d=w.appointData==""?"e-categorycolor":"",this.model.enableRTL?n(n(this.element.find(".e-resourceheadertr")[v-1]).find("div.e-appointwrapper")[c]).append("<div class='e-categorybar "+d+"' id='categorybar_"+u.Guid+"' style='position:absolute;height:"+this.element.find(".e-resourceheadercells").height()+"px;background:"+w.appointData+";width:"+(l+1)+"px;right:"+a+"px;'><\/div>"):n(n(this.element.find(".e-resourceheadertr")[v-1]).find("div.e-appointwrapper")[c]).append("<div class='e-categorybar "+d+"' id='categorybar_"+u.Guid+"' style='position:absolute;height:"+this.element.find(".e-resourceheadercells").height()+"px;background:"+w.appointData+";width:"+(l+1)+"px;left:"+a+"px;'><\/div>")),this.element.find("#"+this._id+"_"+Globalize.format(new Date(u[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(g+v-1)+"_"+c).css(this.model.enableRTL?"right":"left",this.element.find(".e-workcells").width()+a-25+"px").css("top",b+"px"))}},_renderCategory:function(i,r,u,f,e,o,s,h,c,l){var w,a,v,y,p,b,k;u[this.model.appointmentSettings.allDay]?(w=new Date(new Date(new Date(o).setHours(0,0,0,0)).getTime())-new Date(new Date(new Date(e).setHours(0,0,0,0)).getTime()),a=Math.round(w/864e5)+1,a>this.dateRender.length&&(a=new Date(this.dateRender[this.dateRender.length-1]).getDay()+1-new Date(e).getDay()),v=a*1440,y=(this.model.endHour-this.model.startHour)*h*c,p=this.element.find(".e-workcells").width()/(30-1.1)*v+3,b="0"):new Date(new Date(new Date(u[this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime())<new Date(new Date(new Date(u[this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime())?(w=new Date(new Date(new Date(o).setHours(0,0,0,0)).getTime())-new Date(new Date(new Date(e).setHours(0,0,0,0)).getTime()),a=Math.round(w/864e5)+1,v=(a-1)*1440,y=(this.model.endHour-this.model.startHour)*h*c+l*h,p=this.element.find(".e-workcells").width()/(30-1.1)*v+new Date(o).getMinutes()*this.element.find(".e-workcells")[0].offsetWidth*h/60+(new Date(o).getHours()-this.model.startHour)*h,a>this.dateRender.length&&(a=new Date(this.dateRender[this.dateRender.length-1]).getDay()+1-new Date(e).getDay(),v=a*1440,p=this.element.find(".e-workcells").width()/(30-1.1)*v-y*25+10),b=parseFloat(new Date(e).getMinutes())*this.element.find(".e-workcells")[0].offsetWidth*h/60):(b=parseFloat(new Date(e).getMinutes())*this.element.find(".e-workcells")[0].offsetWidth*h/60,k=new Date(o).getHours()*60+new Date(o).getMinutes()-(new Date(e).getHours()*60+new Date(e).getMinutes()),p=this.element.find(".e-workcells").width()/30*k+(new Date(o).getHours()-new Date(e).getHours())*h-2,y=(this.model.endHour-this.model.startHour)*h*c+l*h);!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1&&n(n(n(i.find("td.e-resourceheadercells")).parent()[r-1]).find("div.e-appointwrapper")[y]).append("<div class='e-categorybar' style='position:absolute;height:"+(f-3)+"px;background:"+s.appointData+";width:"+(p+1)+"px;left:"+b+"px;'><\/div>")},_getHorizontalOverlapCount:function(n,i,r,u,f){for(var o=[],e=0;e<n.length;e++)!t.scheduleFeatures.resources||t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)?new Date(new Date(n[e][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()&&new Date(new Date(n[e][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()>=new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()&&(new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.endTime])>=new Date(n[e][this.model.appointmentSettings.startTime])||new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.endTime])&&new Date(u[this.model.appointmentSettings.endTime])>new Date(n[e][this.model.appointmentSettings.endTime])||new Date(u[this.model.appointmentSettings.startTime])>=new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.endTime])||new Date(u[this.model.appointmentSettings.endTime])>new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.endTime])<new Date(n[e][this.model.appointmentSettings.endTime]))&&o.push(n[e]):new Date(new Date(n[e][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()&&new Date(new Date(n[e][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()>=new Date(new Date(i[r]).setHours(0,0,0,0)).getTime()&&(new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.endTime])>=new Date(n[e][this.model.appointmentSettings.startTime])||new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.endTime])&&new Date(u[this.model.appointmentSettings.endTime])>new Date(n[e][this.model.appointmentSettings.endTime])||new Date(u[this.model.appointmentSettings.startTime])>=new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.startTime])<new Date(n[e][this.model.appointmentSettings.endTime])||new Date(u[this.model.appointmentSettings.endTime])>new Date(n[e][this.model.appointmentSettings.startTime])&&new Date(u[this.model.appointmentSettings.endTime])<new Date(n[e][this.model.appointmentSettings.endTime]))&&(f!=null?f==n[e][this.model.resources[this.model.resources.length-1].field]:f==null)&&o.push(n[e]);return o},_moveScroller:function(){if((this.currentView()=="week"||this.currentView()=="workweek"||this.currentView()==="customview"&&this._renderDays<=7)&&this.element.find(".e-headercells").children().hasClass("e-activeview")){var i=n(this.element.find(".e-headercells").find(".e-activeview").parent()).index(),t=this.element.find(".e-workcells")[parseInt(i*(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))].offsetLeft;this.element.find(".e-hscroll").length>0&&(this.model.enableRTL?(t=this.element.find(".e-workcells")[0].offsetLeft-t,n("div#"+this._id+"_scroller").ejScroller({scrollLeft:t}),n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",t+"px")):(n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-t+"px"),n("div#"+this._id+"_scroller").ejScroller({scrollLeft:t})))}},_renderHorizontalHeaderBar:function(){var u=this.model.timeScale.enable?this._isCustomView()?"month":this.currentView():"month",o=Globalize.culture(this.model.locale),v=u=="day"?1:u=="week"?7:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:this.model.workWeek.length,e=[],y=[],f=this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,d=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate),s=this._getStartEndTime(),r,p,g,w,i,b,a,k;if(d)for(i=0;i<this.model.timeScale.minorSlotCount-1;i++)e.push(i);else for(r=0;r<s.length;r++){for(i=0;i<this.model.timeScale.minorSlotCount-1;i++)if(f=f+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,f>(this.model.endHour-this.model.startHour)*60){if(e.push(i),i==this.model.timeScale.minorSlotCount-2){f=0;break}}else e.push(i);y.push(e);f=f+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount;e=[]}if(this.datesColumn=this._getHeaderAllDayCellsCount(),u==="month"||this._isCustomView()){for(this.datesColumn=[],this.monthDays=[],this.totdays=[],i=0;i<this._dateRender.length;i++)this.currentView()==="month"?new Date(this.currentDate()).getMonth()===new Date(this._dateRender[i]).getMonth()&&this.totdays.push(this._dateRender[i]):this.totdays.push(new Date(this._dateRender[i]));for(p=this.totdays.length,i=0;i<p;i++)g=o.calendar.days.names[new Date(this.totdays[i]).getDay()],w=this.model.timeScale.enable?{currentDate:Globalize.format(new Date(this.totdays[i]),"dd"),currentDateClass:"",currentDay:o.calendar.days.names[new Date(this.totdays[i]).getDay()].toString().slice(0,1),cellWidth:!this.model.cellWidth&&this.currentView()!="month"&&!this._isCustomView()?"30px":this.model.cellWidth,cellHeight:this.model.cellHeight}:this.currentView()=="day"||this.currentView()=="week"||this.currentView()=="workweek"?{currentDate:Globalize.format(new Date(this.totdays[i]),"dd"),currentDateClass:"",currentDay:this.currentView()=="day"?o.calendar.days.names[new Date(this.totdays[i]).getDay()]:o.calendar.days.names[new Date(this.totdays[i]).getDay()].toString().slice(0,3),cellWidth:this.model.cellWidth?this.model.cellWidth:"100%",cellHeight:this.model.cellHeight}:{currentDate:Globalize.format(new Date(this.totdays[i]),"dd"),currentDateClass:"",currentDay:o.calendar.days.names[new Date(this.totdays[i]).getDay()].toString().slice(0,1),cellWidth:this.model.cellWidth,cellHeight:this.model.cellHeight},this.datesColumn.push(w),this.monthDays.push(this.totdays[i])}var ut=this.currentView()=="month"||this._isCustomView()?1:0,c=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)&&!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)?!0:!1,h=t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)?!1:!0;if(c||h){var nt=n.templates(n(this.model.timeScale.minorSlotTemplate).html()),tt=n.templates(n(this.model.timeScale.majorSlotTemplate).html()),it=[],r=0;for(i=this.model.startHour;i<this.model.endHour;){for(var l=[],f=this.model.timeScale.majorSlot+r,rt=r;r<f;)b=r,r=r*6e4,this._timeMode==="12"&&(b!=rt||t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)?l.push(nt.render(object={date:new Date(new Date(this._dateRender[0]).setHours(i,0,0,r))}).trim()):l.push(tt.render(object={date:new Date(new Date(this._dateRender[0]).setHours(i,0,0,r))}).trim())),r=r/6e4+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount;i=this.model.timeScale.majorSlot>60?i+this.model.timeScale.majorSlot/60:r>=60?i+1:i;r=r>=60?0:r;it.push(l)}h=!0}a=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?!0:!1;k=c||h?this.userTimeCellHoriTemplate.render({cols:this.datesColumn,label:this._getLocalizedLabels("Resources"),multiRes:a,view:u,timeTdCount:s,colspan:u=="month"?1:s.length/v*2,height:u=="month"?62:59,width:this.model.width,headercellWidth:u=="day"?"100%":"55px",column:e,userTemplateId:c,template:h}):this.horizontalHeader.render({cols:this.datesColumn,label:this._getLocalizedLabels("Resources"),multiRes:a,view:u,timeTdCount:s,colspan:u=="month"?1:s.length/v*2,height:u=="month"?62:59,width:this.model.width,headercellWidth:u=="day"?"100%":"55px",column:y});this.aTR.append(k)},_renderHorizontalContent:function(n,i,r,u,f,e){var p=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate),a,l,s=[],w=[],h=this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,v=this._getStartEndTime(),c,o,b,k,y;if(p)for(o=0;o<v.length;o++)s.push(o);else for(v=this._getStartEndTime(),o=0;o<v.length;o++){for(c=0;c<this.model.timeScale.minorSlotCount-1;c++)if(h=h+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,h>(this.model.endHour-this.model.startHour)*60){if(s.push(c),c==this.model.timeScale.minorSlotCount-2){h=0;break}}else s.push(c);w.push(s);h=h+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount;s=[]}t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)?(b=this.currentView()=="month"||this._isCustomView()?"24px":"25px",l="",a=[{classname:"e-childnode",tdWidth:b}]):(l=this._renderHorizontalResources(),a=this._horiResources);k=60/this.model.timeScale.majorSlot;y=this.cellTemplate.render({cellrows:a,hourdiff:Math.ceil((this.model.endHour-this.model.startHour)*k),view:this.model.timeScale.enable?this._isCustomView()?"month":this.currentView():"month",cols:this.model.timeScale.enable?this.currentView()=="month"||this._isCustomView()?this.datesColumn:this._getStartEndTime():this.datesColumn,column:p?s:w,timeScale:this.model.timeScale.minorSlotCount});l==""?this.wTR.append(t.buildTag("td").append(n.append(i.append(r.append(u.append(f.append(e.append(this.$WorkCellDiv.append(y))))))))):this.wTR.append(t.buildTag("td.e-horizontalrestd",{},{},{width:"200px"}).append(l)).append(t.buildTag("td").append(n.append(i.append(r.append(u.append(f.append(e.append(this.$WorkCellDiv.append(y)))))))))},_getResourceHeadTemplate:function(t){var i=n.templates(n(this.model.resourceHeaderTemplateId).html());return i.render(t)},_renderHorizontalResources:function(){var f,u,e,v,o,i;this._resCollect=[];this._horizontalResRender=[];this._horiResources=[];var l=this.currentView(),y=l=="day"?1:l=="week"||l=="month"||this._isCustomView()?7:this.model.workWeek.length,h=this.currentView()=="month"||this._isCustomView()?"24px":"25px",c=this.model.resourceHeaderTemplateId?!0:!1;if(t.isNullOrUndefined(this.model.group))for(i=0;i<this.model.resources.length;i++)this._horizontalResRender.push(this.model.resources[i].resourceSettings.dataSource),this._resCollect.push(this.model.resources[i].resourceSettings.dataSource);else if(this.model.group.resources.length===1){for(u=0;u<this.model.group.resources.length;u++)f=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[u]);for(u=0;u<this._resourceInfo[f].dataSource.length;u++)this._horiResources.push({cellHeight:this.model.cellHeight,name:this._resourceInfo[f].dataSource[u][this._resourceInfo[f].text],idnum:this._resourceInfo[f].dataSource[u][this._resourceInfo[f].id],classname:"e-childnode",marginleft:"20px",width:"10px",backgroundcolor:"",border:"1px solid #bbbcbb",bordertop:"",tdWidth:h,userResHeader:this._getResourceHeadTemplate(n.extend(this._resourceInfo[f].dataSource[u],{classname:"e-childnode"})),userResTemplId:c}),this._resCollect.push(this._resourceInfo[f].dataSource[u]);this._horizontalResRender.push(this._resCollect)}else{var r=this._getResourceCollection(),s=0,i=0,a=[];for(e=0;e<r[s].dataSource.length;e++){for(this._horiResources.push({cellHeight:this.model.cellHeight,name:r[s].dataSource[e][r[s].text],idnum:r[s].dataSource[e][r[s].id],classname:"e-parentnode",marginleft:"20px",width:"10px",backgroundcolor:"#bbbcbb",border:"1px solid #bbbcbb",bordertop:"1px solid #bbbcbb",tdWidth:h,userResHeader:this._getResourceHeadTemplate(n.extend(r[s].dataSource[e],{classname:"e-parentnode"})),userResTemplId:c}),this._resCollect.push(r[s].dataSource[e]),i++,u=0;u<r[i].dataSource.length;u++){if(v=i,r[i-1].dataSource[e][r[i-1].id]==r[i].dataSource[u][r[i].groupId])for(a.push(r[i].dataSource[u]),this._horiResources.push({cellHeight:this.model.cellHeight,name:r[i].dataSource[u][r[i].text],idnum:r[i].dataSource[u][r[i].id]+"_"+r[i].dataSource[u][r[i].groupId],classname:"e-childnode",marginleft:"45px",width:"20px",backgroundcolor:"",border:"1px dotted #bbbcbb",bordertop:"",tdWidth:h,userResHeader:this._getResourceHeadTemplate(n.extend(r[i].dataSource[u],{classname:"e-childnode"})),userResTemplId:c}),this._resCollect.push(r[i].dataSource[u]);i<r.length-1;){for(o=0;o<r[i+1].dataSource.length;o++)r[i].dataSource[u][r[i].id]==r[i+1].dataSource[o][r[i+1].groupId]&&(a.push(r[i+1].dataSource[o]),this._horiResources.push({cellHeight:this.model.cellHeight,name:r[i+1].dataSource[o][r[i+1].text],classname:"e-childnode",marginleft:"55px",width:"20px",backgroundcolor:"",border:"1px dotted #bbbcbb",bordertop:"",tdWidth:h,userResHeader:this._getResourceHeadTemplate(n.extend(r[i+1].dataSource[o],{classname:"e-childnode"})),userResTemplId:c}),this._resCollect.push(r[i+1].dataSource[o]));i++}i=v}i=0}this._horizontalResRender.push(this._resCollect)}return this.horizontalResHeader.render({trs:this._horiResources})},_renderHorizontalCurrentTime:function(){var r,t,u,i;if(this.currentView()==="month"||this._isCustomView()){for(r=[],t=0;t<this._dateRender.length;t++)new Date(this.currentDate()).getMonth()===new Date(this._dateRender[t]).getMonth()&&r.push(new Date(this._dateRender[t]));for(u=this.element.find(".e-headerdays").find("table").find("td"),i=0;i<r.length;i++)new Date(new Date(r[i]).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()&&n(u[i]).addClass("e-monthcurrenttime")}else this.element.find("td.e-headerToday").length>0&&(this.element.find(".e-horizontaltabletimecell").parent().append('<div id="'+this._id+'_HighlightCurrentTimeline" class="e-highlightcurrenttimeline" style="height: 92%; width: 2px; position: absolute; background-color: red; "><\/div>'),n("#"+this._id+"_HighlightCurrentTimeline").css("top",this.element.find(".e-headerdays tr")[1].offsetTop))},_horizontalTimePosition:function(t,i){if(t.element.find("td.e-headerToday").length>0){var r=t.element.find("td.e-headerToday")[0].cellIndex,u=i.getHours()-t.model.startHour,f=(t.model.endHour-t.model.startHour)*2*r+u*2,e=parseFloat(i.getMinutes())*t.element.find(".e-workcells")[1].offsetWidth/30;n("#"+t._id+"_HighlightCurrentTimeline").css("left",f*t.element.find(".e-workcells")[1].offsetWidth+e)}},_horizontalBusinessHighlight:function(i,r,u,f,e){var a=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)?this._horiResources.length:1,c,l,s,o,h;if(this.currentView()!=="month"&&!this._isCustomView()&&this.model.timeScale.enable){for(s=0;s<a;s++)for(c=0;c<i.length;c++)for(o=r*f;o<u*f;o++)for(h=0;h<this.model.workWeek.length;h++)this._dayNamesArray.indexOf(this.model.workWeek[h])==new Date(i[c]).getDay()&&n(n(this.element.find(".e-workcellstab tr")[s]).find(".e-workcells")[o+(this.model.endHour-this.model.startHour)*f*c]).addClass("e-businesshighlightworkcells");this._businessHourScroller()}else for(l=this.monthDays,e=this.element.find(".e-workcells"),e.removeClass("e-monthcellhighlight"),s=0;s<a;s++)for(o=0;o<l.length;o++)for(h=0;h<this.model.workWeek.length;h++)this._dayNamesArray.indexOf(this.model.workWeek[h])==new Date(l[o]).getDay()&&n(n(this.element.find(".e-workcellstab tr")[s]).find(".e-workcells")[o]).addClass("e-monthcellhighlight")},_onResourceClick:function(i){var u=n(i.currentTarget),r;u.hasClass("e-resourceicon e-resourcecollapse")?(u.removeClass("e-resourceicon e-resourcecollapse"),u.addClass("e-resourceicon e-resourceexpand")):u.removeClass("e-resourceicon e-resourceexpand").addClass("e-resourceicon e-resourcecollapse");var e=n(i.currentTarget).parent().index(),f=this._getResourceCollection(),o=(new t.Query).where(f[f.length-1].groupId,t.FilterOperators.equal,parseInt(i.currentTarget.id)),s=new t.DataManager(f[f.length-1].dataSource).executeLocal(o);for(r=e+1;r<=s.length+e;r++)n(this.element.find(".e-resourceheadertable").find("tr")[r]).toggle(),n(this.element.find(".e-workcellstab").find("tr")[r]).toggle();this._renderScroller();this.element.find("div.e-prevapp,div.e-nextapp").remove();this.element.find(".e-horires").css("top","0px");this.element.find(".e-categorybar").height(this.element.find(".e-parentworkcell").height()-3);this._businessHourScroller();this._renderAppointmentAll()}}})(jQuery,Syncfusion),function(n,t){t.scheduleFeatures=t.scheduleFeatures||{};var i=function(){return this._resHeadTemplate="{{for resourceName}}{{for ~cols=colspan}}<td class='e-resourcecells' colspan='{{:~cols}}'> {{for ~resource=resourceNam}}<div class='e-resourceheadertext' align='center' title='{{if userResTemplId == true}}{{:resourceNam}}{{else}}{{:~resource}}{{/if}}'>{{if userResTemplId == true}}{{:userResHeader}}{{else}}{{:~resource}}{{/if}}<\/div>{{/for}}  <\/td>{{/for}}{{/for}}",this._resHeadTemplate};t.scheduleFeatures.resources={__getMultipleResourceCellsCount:function(n){var v,s,r,u,h,c,y,f,i,l,e,a,o;if(this.model.group.resources.length===1)v=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[0]),s=this._resourceInfo[v].dataSource.length;else{for(r=this._getResourceCollection(),u=[],i=0;i<r.length;i++)if(u=[],i==0)for(l=0;l<r[i].dataSource.length;l++)u.push({resourceNam:r[i].dataSource[l][r[i].text]});else for(i>1&&(r[i-1].dataSource=[],r[i-1].dataSource=this.res),this.res=[],h=t.group(r[i].dataSource,r[i].groupId),c=t.group(r[i-1].dataSource,r[i-1].id),this._resourceManager1=h instanceof t.DataManager?h:t.DataManager(h),e=0;e<c.length;e++)for(a=0;a<c[e].items.length;a++)if(y=(new t.Query).where("key",t.FilterOperators.equal,c[e].items[a][r[i-1].id]),f=this._resourceManager1.executeLocal(y),f.length>0)for(o=0;o<f[0].items.length;o++)u.push({resourceNam:f[0].items[o][r[i].text]}),this.res.push(f[0].items[o]);s=u.length;this.res1=u.length}return n=n*s,{resCount:s,count:n}},_initResourceData:function(n,t){var r=this._columnToSelect(n),i=this,u=n.dataSource.executeQuery(r);u.done(function(r){n.dataSource=r.result;i._resourceInfo.push(n);t==i.model.resources.length-1&&i._renderInitSchedule()})},_showMultipleResourceDetails:function(n){var f,e,o,u,i,r;if(this.model.resources.length>0){for(u=this._getResourceCollection(),r=0;r<u.length;r++)this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");for(i=0;i<this.render_Resources.length-1;i++)f=this.render_Resources[i+1]instanceof t.DataManager?this.render_Resources[i+1]:t.DataManager(this.render_Resources[i+1]),e=(new t.Query).where(u[i+1].groupId,t.FilterOperators.equal,n[this.model.appointmentSettings.resourceFields.toString().split(",")[i]]),o=f.executeLocal(e),this._appointmentAddWindow.find(".owner_"+(i+1)).ejAutocomplete("clearText"),this._appointmentAddWindow.find(".owner_"+(i+1)).ejAutocomplete("option","dataSource",o);for(r=0;r<u.length;r++)this._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(n[this.model.appointmentSettings.resourceFields.toString().split(",")[r]])}},_renderAppWindowResources:function(n){var i=this.render_Resources,r=this.model.enableRTL?"margin-right:30px;margin-top:-18px":"float:left",u=this.model.enableRTL?"float:none":"float:left",t;for(this._resCollection=this._getResourceCollection(),t=0;t<i.length;t++)this.model.resources[t].allowMultiple?n.find(".owner_"+t).ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:"visualmode",dataSource:i[t],fields:{text:this._resCollection[t].text,key:this._resCollection[t].id},change:this._onResourceChange,template:"<div class='e-resourcediv' style='height:15px; margin-right:5px; margin-top:3px; float:left; width:15px;"+u+"; background-color: ${"+this._resCollection[t].color+"}'><\/div> <div style= "+r+">${"+this._resCollection[t].text+"}<\/div>"}):n.find(".owner_"+t).ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:"none",dataSource:i[t],fields:{text:this._resCollection[t].text,key:this._resCollection[t].id},change:this._onResourceChange,template:"<div class='e-resourcediv' style='height:15px; margin-right:5px; margin-top:3px; float:left; width:15px;"+u+"; background-color: ${"+this._resCollection[t].color+"}'><\/div><div style= "+r+">${"+this._resCollection[t].text+"}<\/div>"})},_onResourceChange:function(i){var g,b,k,v,y,c,h;if(!t.isNullOrUndefined(i.value)&&i.value!=""){var nt=n("#"+this._id.toString().split("_")[0]),u=nt.ejSchedule("instance"),p=parseInt(this._id.toString().split("_")[2]),tt=u._appointmentAddWindow.find(".owner_"+p).ejAutocomplete("option","multiSelectMode"),o=this.getSelectedItems(),f=u._getResourceCollection();if(p<u.render_Resources.length-1&&o.length>0){var r=p+1,w=u.render_Resources[r-1]instanceof t.DataManager?u.render_Resources[r-1]:t.DataManager(u.render_Resources[r-1]),d=u.render_Resources[r]instanceof t.DataManager?u.render_Resources[r]:t.DataManager(u.render_Resources[r]),s,l,e,a=[];if(tt=="none"){if(t.isNullOrUndefined(i.value)||(g=(new t.Query).where(f[r-1].text,t.FilterOperators.equal,i.value),b=w.executeLocal(g)),k=!i.value||t.isNullOrUndefined(i.value)||b.length<=0?o[0][f[r-1].id]:b[0][f[r-1].id],!t.isNullOrUndefined(k)){for(s=(new t.Query).where(f[r-1].id,t.FilterOperators.equal,k),l=w.executeLocal(s),s=(new t.Query).where(f[r].groupId,t.FilterOperators.equal,l[0][f[r-1].id]),e=d.executeLocal(s),a=[],h=0;h<e.length;h++)a.push(e[h]);e.length!=0?(u._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText"),u._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",a),u._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(e[0][f[r].id]),o=e[0][f[r].id]):(u._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText"),u._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",a))}}else{for(v=t.Predicate(f[r-1].id,t.FilterOperators.equal,o[0][f[r-1].id]),o=i.value.split(","),c=1;c<o.length;c++)v=v.or(f[r-1].text,t.FilterOperators.equal,o[c]);if(s=(new t.Query).where(v),l=w.executeLocal(s),l.length>0){for(y=t.Predicate(f[r].groupId,t.FilterOperators.equal,l[0][f[r-1].id]),c=1;c<l.length;c++)y=y.or(f[r].groupId,t.FilterOperators.equal,l[c][f[r-1].id]);for(s=(new t.Query).where(y),e=d.executeLocal(s),a=[],h=0;h<e.length;h++)a.push(e[h]);u._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText");u._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",a);u._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(e[0][f[r].id]);o.push(e[0][f[r].id])}}}}},_getResourceCollection:function(){var i=[],f,n,r,u;if(!t.isNullOrUndefined(this.model.resources)){if(t.isNullOrUndefined(this.model.group))for(n=0;n<this.model.resources.length;n++)i.push({index:n});else{for(n=0;n<this.model.group.resources.length;n++)f=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[n]),i.push({index:f,name:this.model.resources[n].name});i=i.sort(function(n,t){var i=n.index,r=t.index;return i<r?-1:i>r?1:0})}for(r=[],u=0;u<i.length;u++)r.push(this._resourceInfo[i[u].index]);return this._resCollection=r,r}},_renderMultipleResourceHeaderTemplate:function(i,r){var h,c,y,l,a,p,w,k,u,e,tt,it,s,o;if(this.res1=[],this.render_Resources=[],this.level_Resources=[],h=this.currentView(),c=h=="day"?1:h=="week"||h=="month"?7:this.model.workWeek.length,c=h=="customview"&&this._dateRender.length>=7?7:h=="customview"&&this._dateRender.length<7?this._dateRender.length:c,t.isNullOrUndefined(this.model.group))for(o=0;o<this.model.resources.length;o++)this.render_Resources.push(this.model.resources[o].resourceSettings.dataSource);else if(y=this.model.resourceHeaderTemplateId?!0:!1,l=[],this.model.group.resources.length===1){for(u=0;u<this.model.group.resources.length;u++)a=this._findResourceIndex(this.model.resources,"name",this.model.group.resources[u]);for(u=0;u<this._resourceInfo[a].dataSource.length;u++)this.currentView()!="agenda"&&l.push({resourceNam:this._resourceInfo[a].dataSource[u][this._resourceInfo[a].text],colspan:c,userResHeader:this._getResourceHeadTemplate(n.extend(this._resourceInfo[a].dataSource[u],{classname:"e-childnode"})),userResTemplId:y}),this.res1.push(this._resourceInfo[a].dataSource[u]),this.level_Resources.push(this.res1[u]);this._valueCollection=this.res1;this.render_Resources.push(this.res1);this.model.orientation=="vertical"&&this.currentView()!="agenda"&&i!==null&&r!=null&&(p=h=="month"?50:56,w=this.resourceHeadTemplate.render({cols:r,resourceName:l,leftWidth:p}),i.append(t.buildTag("tr.e-headerbar").css("height","28px").append(w)))}else{var f=this._getResourceCollection(),rt=[],et=[],d=[],b=0,ut=[],g=[],ot=[],ft=[];if(this.resourceValue,rt=n.merge(rt,f),this.model.resources.length){for(o=0,e=0;e<f[f.length-2].dataSource.length;e++)for(var nt=(new t.Query).where(f[f.length-1].groupId,t.FilterOperators.equal,f[f.length-2].dataSource[e][f[f.length-2].id]),s=new t.DataManager(f[f.length-1].dataSource).executeLocal(nt),v=0;v<s.length;)et.push({resourceNam:s[v][f[f.length-1].text],colspan:1*c,userResHeader:this._getResourceHeadTemplate(n.extend(s[v],{classname:"e-childnode"})),userResTemplId:y}),d[o]=s[v],this.res1.push(s[v]),o++,v++;this._valueCollection=d;f[f.length-1].dataSource=d}for(u=this.model.resources.length-1;u>=0;u--){for(ot.push(u),e=0;e<f[u].dataSource.length;e++){if(tt=u!=0?this._findResourceIndex(f[u-1].dataSource,f[u-1].id,f[u].dataSource[e][f[u].groupId]):0,it=u!=this.model.resources.length-1?this._findResourceIndex(f[u+1].dataSource,f[u+1].groupId,f[u].dataSource[e][f[u].id]):this.model.resources.length-1,t.isNullOrUndefined(tt)&&t.isNullOrUndefined(it)?f[u].dataSource[e]=0:"",!t.isNullOrUndefined(tt)&&!t.isNullOrUndefined(it)&&f[u].dataSource[e]!==0){if(g.push(f[u].dataSource[e]),this.resourceValue=g.length,u<=this.model.resources.length-2){if(nt=(new t.Query).where(f[u+1].groupId,t.FilterOperators.equal,f[u].dataSource[e][f[u].id]),s=new t.DataManager(f[u+1].dataSource).executeLocal(nt),u<=this.model.resources.length-3){for(o=0;o<s.length;o++)b=b+s[o].count;k=b;f[u].dataSource[e].count=k;b=0}u==this.model.resources.length-2&&(f[u].dataSource[e].count=s.length,k=s.length);this.resourceValue=k;s.length=0}this.currentView()!="agenda"&&l.push({resourceNam:f[u].dataSource[e][f[u].text],colspan:this.resourceValue*c,userResHeader:this._getResourceHeadTemplate(n.extend(f[u].dataSource[e],{classname:"e-childnode"})),userResTemplId:y});this.level_Resources.push(f[u].dataSource[e]);g.length=0}this.model.orientation=="vertical"&&this.currentView()!="agenda"&&i!==null&&r!=null&&(p=h=="month"?50:56,w=this.resourceHeadTemplate.render({cols:r,resourceName:l,leftWidth:p}),ft[u]=t.buildTag("tr.e-headerbar").css("height","28px").append(w))}ut[u]=f[u].dataSource;l.length=0}this.render_Resources=ut;this.model.orientation=="vertical"&&this.currentView()!="agenda"?i.append(ft):""}return i},_getMultipleResourceAlldayApp:function(n,t,i,r){this.allDayCount=[];new Date(new Date(n[t]).setHours(0,0,0,0)).getTime()==new Date(new Date(this._processed[r][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&this._processed[r][this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]==this.res1[i][this.model.resources[this.model.resources.length-1].resourceSettings.id]&&(this._processed[r][this.model.appointmentSettings.allDay]===!0||(new Date(this._processed[r][this.model.appointmentSettings.endTime])-new Date(this._processed[r][this.model.appointmentSettings.startTime]))/36e5>=24)&&(this._setAllDayPos(this._processed[r],t,i),this._filtered.push(this._processed[r]),this.allDayCount.push(r))},_getResourceColor:function(n){var i=this._resCollection,r,u="",f="";return t.isNullOrUndefined(this.model.group)?(r=this._findResourceIndex(this.render_Resources[this.render_Resources.length-1],i[i.length-1].id,n[this.model.appointmentSettings.resourceFields.split(",")[this.model.appointmentSettings.resourceFields.split(",").length-1]]),t.isNullOrUndefined(r)||(u=t.isNullOrUndefined(this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].color])?u:this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].color],f=t.isNullOrUndefined(this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].appointmentClass])?f:this.render_Resources[this.render_Resources.length-1][r][i[i.length-1].appointmentClass])):(r=this._findResourceIndex(this.render_Resources[0],i[0].id,n[this.model.appointmentSettings.resourceFields.split(",")[0]]),t.isNullOrUndefined(r)||(u=t.isNullOrUndefined(this.render_Resources[0][r][i[0].color])?u:this.render_Resources[0][r][i[0].color],f=t.isNullOrUndefined(this.render_Resources[0][r][i[0].appointmentClass])?f:this.render_Resources[0][r][i[0].appointmentClass])),{appointData:u,appointCustomcss:f}},_getResourceValue:function(n){var r,i;return t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&(i=this._getResourceDetails(n),r=t.DataManager(this._getResourceCollection()[i.length-1].dataSource).executeLocal((new t.Query).where(this.model.resources[i.length-1].resourceSettings.id,"equal",i[0].id))[0]),r},_getResourceDetails:function(n,i){var f,o,e,h,c,s,r,u;if(!t.isNullOrUndefined(this.model.resources)&&this.model.resources.length>0){for(f=this.currentView()=="day"?1:this.currentView()=="week"||this.currentView()=="month"?7:this.model.workWeek.length,f=this.currentView()=="customview"&&this._dateRender.length>=7?7:this.currentView()=="customview"&&this._dateRender.length<7?this._dateRender.length:f,i=this.currentView()==="month"||this.currentView()=="customview"?n.index():t.isNullOrUndefined(this._cellIndex)?n.index():this._cellIndex,n.hasClass("e-detailedapp")?"":this.index=i,i=n.hasClass("e-detailedapp")?this.index:i,i=this.model.orientation=="vertical"?parseInt(i/f):t.isNullOrUndefined(this._workCellIndex)?n.parent().index():this._workCellIndex,o=this.model.orientation=="vertical"?this._valueCollection:this._resCollect,this._resourceCollection=[],r=this._getResourceCollection(),u=r.length-1;u>=0;u--)u==r.length-1?t.isNullOrUndefined(this.model.group)?(this._resourceCollection.push({id:r[r.length-1].dataSource[i][r[r.length-1].id]}),e=r[r.length-1].dataSource[i][r[r.length-1].groupId]):(this._resourceCollection.push({id:o[i][r[u].id]}),e=o[i][r[u].groupId]):(h=r[u].dataSource instanceof t.DataManager?r[u].dataSource:t.DataManager(r[u].dataSource),c=(new t.Query).where(r[u].id,t.FilterOperators.equal,e),s=h.executeLocal(c),this._resourceCollection.push({id:s[0][r[u].id]}),e=s[0][r[u].groupId]);return this._resourceCollection}},_getResourceFields:function(n){if(t.isNullOrUndefined(this.model.group))n[this.model.appointmentSettings.resourceFields.split(",")[0]]=this._resourceCollection[0].id;else for(var i=0,r=this._resourceCollection.length-1;i<this._resourceCollection.length;i++,r--)n[this.model.appointmentSettings.resourceFields.split(",")[i]]=this._resourceCollection[r].id;return n},_getDragDropResourceData:function(n,i,r){var u,e,f;return t.isNullOrUndefined(i)||(u=n.model.currentView=="day"?1:n.model.currentView=="week"||n.model.currentView=="month"?7:this.model.workWeek.length,u=n.model.currentView=="customview"&&this._dateRender.length>=7?7:n.model.currentView=="customview"&&this._dateRender.length<7?this._dateRender.length:u,e=n.model.enableRTL?n.res1.length-Math.floor(i/u)-1:Math.floor(i/u),f=n.model.orientation=="vertical"?n.res1[e]:n._resCollect[i],this._ownerId=f[n.model.resources[n.model.resources.length-1].resourceSettings.id],this._groupId=f[n.model.resources[n.model.resources.length-1].resourceSettings.groupId],r[n.model.appointmentSettings.resourceFields.split(",")[n.model.appointmentSettings.resourceFields.split(",").length-1]]=f[n.model.resources[n.model.resources.length-1].resourceSettings.id],this.model.appointmentSettings.resourceFields.split(",").length>1&&(r[n.model.appointmentSettings.resourceFields.split(",")[n.model.appointmentSettings.resourceFields.split(",").length-2]]=f[n.model.resources[n.model.resources.length-1].resourceSettings.groupId])),r},_renderResourceData:function(n,i){var f,u,r,e,s,o;if(this._getResourceDetails(n),f=[],u=[],this.model.resources.length)for(r=this._resourceCollection.length-1;r>=0;r--)e=this._findResourceIndex(this._resCollection[r].dataSource,this._resCollection[r].id,this._resourceCollection[this._resourceCollection.length-1-r].id),f.push(this._resCollection[r].dataSource[e]),r!=0?(s=(new t.Query).where(t.Predicate(this._resCollection[r].groupId,t.FilterOperators.equal,this._resCollection[r].dataSource[e][this._resCollection[r].groupId])),o=new t.DataManager(this._resCollection[r].dataSource).executeLocal(s),i=this._findResourceIndex(o,this._resCollection[r].id,this._resourceCollection[this._resourceCollection.length-1-r].id),u=o,this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText"),this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("option","dataSource",u),this._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(u[i][this._resCollection[r].id])):(this._appointmentAddWindow.find(".owner_"+r).ejAutocomplete("clearText"),this._appointmentAddWindow.find(".owner_"+r).data("ejAutocomplete").selectValueByKey(f[this._resourceCollection.length-1-r][this._resCollection[r].id]))},_bindResourcesData:function(){var i,n;if(!t.isNullOrUndefined(this.model.resources)){for(this._resourceInfo=[],i=!1,n=0;n<this.model.resources.length;n++)t.isNullOrUndefined(this.model.resources[n].resourceSettings)||(!t.isNullOrUndefined(this.model.resources[n].resourceSettings.query)&&this.model.resources[n].resourceSettings.query instanceof t.Query||(this.model.resources[n].resourceSettings.query=t.Query()),this.model.resources[n].resourceSettings.dataSource instanceof t.DataManager?this._initResourceData(this.model.resources[n].resourceSettings,n):(this._resourceInfo.push(this.model.resources[n].resourceSettings),i=!0));i&&this._renderInitSchedule()}},_renderResourceElements:function(n){for(var t=0;t<this.model.resources.length;t++)n+="<tr><td class='e-leftfields e-textlabel'>"+this.model.resources[t].title+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"_ownerfield_"+t+"'  class='owner_"+t+"' type='text' value=''/><div id='ownerlist'><\/div><\/td><\/tr>";return n},_renderResourcesTemplate:function(){this.model.orientation=="vertical"&&(this.resourceHeadTemplate=n.templates(this._createTemplate(i(),"_ResourceHeader")))}}}(jQuery,Syncfusion),function(n,t,r){t.scheduleFeatures=t.scheduleFeatures||{};var u=function(){return this._monthCellsTemplate="<table class='e-table e-workcellstab'  height='100%'width='100%' cellpadding='0px' cellspacing='0px'><tbody>{{for cellrows ~cols1=cols1}}<tr>{{for ~cwidth=cwidth ~cheight=cheight ~cols1}}<td class='e-monthcells' width='{{:~cwidth}}' height='{{:~cheight}}'><div class='e-monthheader'><\/div><div class='e-appointwrapper'><\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._monthCellsTemplate},f=function(){return this._appTemplate="<div class='{{:appClass}} {{:appointCustomcss}}' id='Appointment_{{:id}}' guid= '{{:uid}}' role='presentation' style='{{if rtl == true}}right{{else}}left{{/if}}: {{:left}}; width: {{:appWidth}}; background: {{:appointData}};  color:{{:appointtextcolor}}; height: {{:appHeight}}px; top: {{:top}}px;' >{{if appResize == true}}{{if appClass == 'e-appointment'}}{{if orientation == 'vertical'}}<div class='e-tophandle'><\/div><div class='e-bottomhandle'><\/div>{{else}}<div class='e-lefthandle'><\/div><div class='e-righthandle'><\/div>{{/if}}{{else}}{{if currentview != 'day'}}<div class='e-lefthandle'><\/div><div class='e-righthandle'><\/div>{{/if}}{{/if}}{{/if}}<span class='e-icon e-schedulemouseclose'/><\/span>{{if userAppTemplId == false}}<div class='e-appointinnertext'><div class='e-apptext {{if (priority!=undefined && priority!='')}}e-priorwidth{{/if}}'>{{:subject}} <\/div><div class='e-apptime {{if (priority!=undefined && priority!='')}}e-priorwidth{{/if}}'> {{:startTime}} - {{:endTime}}<\/div>{{if (priority!=undefined && priority!='') && ((priorityTemplate!=undefined && priorityTemplate!=''))}}{{if enablePriority==null}} <div class='e-priority e-{{:priorityTemplate}}'><\/div>{{else}}<div class='e-priority'>{{:priorityTemplate}}<\/div>{{/if}}<\/div>{{/if}}{{if value == true}}<div class='e-multipleCategory'>{{:multiDiv}}<\/div>{{/if}}<\/div>{{else}}{{:userTemplate}}{{/if}}<\/div>",this._appTemplate},e=function(){return this._categorizeMultipleTemplate="{{for renderData }}<div style='background:{{:value}};height:11px;width:6px;float:left'><\/div>{{/for}}",this._categorizeMultipleTemplate},o=function(){return this._headerTemplate="{{for cols ~view=view ~colspan=colspan}}<td class='e-headercells' colspan='{{:~colspan}}'><div class='e-dateheadercell'> <span class='e-headerdaydisplay'>{{:currentDay}}<\/span><\/div><\/td>{{/for}}",this._headerTemplate},s=function(){return this._leftIndent="<table class='e-table e-leftindenttable' width='{{:cswidth}}' cellpadding='0px' cellspacing='0px'><tbody> {{for trs ~tdClass=tdClass ~divClass=divClass}} <tr>{{for ~tdClass=tdClass ~divClass=divClass}} <td class='{{:~tdClass}}'style='height:27px;'> <div class='{{:~divClass}}'><\/div><\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._leftIndent},h=function(){return this._alldayTemplate="{{for cols ~colspan=colspan}} <td class='e-alldaycells' style='height:27px;' colspan='{{:~colspan}}'> <\/td>{{/for}}",this._alldayTemplate},c=function(){return this._workCellsTemplate="<table class='e-table e-workcellstab' width='100%' cellpadding='0px' cellspacing='0px'><tbody >{{for cellrows  ~timesc=timeScale ~cols1=cols1}}<tr>{{for ~index=#index ~cwidth=cwidth ~cheight=cheight ~cols1 }}{{if ((~index+1) % ~timesc) == 0 }}<td class='e-workcells' width='{{:~cwidth}}' height='{{:~cheight}}'>{{else}}<td class='e-workcells e-alternatecells'width='{{:~cwidth}}' height='{{:~cheight}}'>{{/if}}<div class='e-appointwrapper'><\/div><\/td>{{/for}}<\/tr>{{/for}}<\/tbody><\/table>",this._workCellsTemplate},l=function(){return this._timeCellsTemplate="<div class='e-scrolltimecells'><table class='e-table e-timecelltable' cellpadding='0px' cellspacing='0px'><tbody>{{for timerows ~timesc=timeScale ~cols1=cols1 ~view1=viewclass ~userTemplateId = userTemplateId ~timeValue1=timeValue1 ~template=template}}<tr>{{for ~name=time ~id=id ~view=~view1 ~index=#index }} {{if ~view == 0}}{{if ~userTemplateId==true}}<td class='e-timecells'>{{for ~cols1[~index] }}{{if (#index+1)% ~timesc ==0}}<div class='e-timecelldivs' style='height: 20px'>{{:~timeValue1[~index][#getIndex()]}}<\/div>{{else}}<div class='e-timecelldivs' style='height: 21px'>{{:~timeValue1[~index][#getIndex()]}}<\/div>{{/if}}{{/for}}<\/td>{{else}}<td class='e-timecells'><div class='e-timecelldivs'>{{if ~template==true}}{{:~name}}{{else}}{{:~name.slice(0,2)}}{{/if}}<\/div><\/td>{{/if}} <td class='e-timecells' rowspan='1'>{{for ~cols1[~index] }}{{if (#index+1)% ~timesc ==0}}<div class='e-ampmdisplay'><\/div>  {{else}} {{if (#getIndex())== 0}}<div id='{{:~id}}' class='e-ampmdisplay e-ampmstyle e-idAmpmstyle'> {{if ~template ==true || ~userTemplateId==true }}{{else}}{{:~name.slice(3,6)}}{{/if}}<\/div>{{else}}<div class='e-ampmdisplay e-ampmstyle'><\/div>{{/if}} {{/if}}{{/for}}<\/td>{{else}}<td class='e-timecells' style='width:51px;'><div class='e-timecelldivs'><\/div><\/td>{{/if}}{{/for}}<\/tr>{{/for}}<\/tbody><\/table><\/div>",this._timeCellsTemplate},a=function(){return this._userTimeCellsTemplate="<div class='e-scrolltimecells'><table class='e-table' cellpadding='0px' cellspacing='0px' width='70px'><tbody>{{for timerows ~timesc=timeScale ~cols1=cols1 ~view1=viewclass  ~userTemplateId = userTemplateId ~timeValue1=timeValue1 ~template=template ~cheight = cheight}}<tr height='21px'><th class='' rowspan='1'>{{:~timeValue1[#getIndex()][0]}}<\/th><\/tr>{{for ~cols1 ~name=time ~id=id ~view=~view1 ~index=#index ~timeSc=~timesc}}{{if  (#getIndex()+2)% ~timeSc ==0}}<tr height='21px'><th class='e-timecells' style='text-align:left' rowspan='1'>{{:~timeValue1[~index][#getIndex()+1]}}<\/th><\/tr> {{else}}<tr height='21px'><th class='' rowspan='1'>{{:~timeValue1[~index][#getIndex()+1]}}<\/th><\/tr>{{/if}}{{/for}}{{/for}}<\/tbody><\/table><\/div>",this._userTimeCellsTemplate},v=function(){return this._agendaHeaderTemplate="<tr>{{for cols}}<td class='e-headercells {{:className}} {{if (#index==0)}}e-firstcolumn{{/if}}'><div class='e-textwrapper'><b>{{:headertext}}<\/b><\/div><\/td>{{/for}}<\/tr>",this._agendaHeaderTemplate},y=function(){return this._agendaCellsTemplate="<table class='e-table e-agendacellstab' width='100%' cellpadding='0px' cellspacing='0px'><tbody >{{for cols}}<tr>{{if resGroup}}{{for resGroup}}<td class='e-agendacells {{:resId}} e-resourcecolumn {{if (#index==0)}}e-firstcolumn{{/if}}'><div class='e-textwrapper'>{{:text}}<\/div><\/td>{{/for}}{{/if}}{{if resChild}}<td rowspan={{:resRowSpan}} class='e-agendacells e-resourcecolumn {{if (resGroup.length==0)}}e-firstcolumn{{/if}}'><div class='e-textwrapper'>{{if userResourceId == false}}{{:resName}}{{else}}{{:userResourceHtml}}{{/if}}<\/div><\/td>{{/if}}{{if dayChild}}<td rowspan={{:dayRowSpan}} class='e-agendacells e-datecolumn {{if (resGroup.length != 0) }}{{else (resName =='')}}e-firstcolumn{{/if}}'><div class='e-textwrapper'>{{if userDateId == false}}{{:date}}{{else}}{{:userDateHtml}}{{/if}}<\/div><\/td>{{/if}}<td class='e-agendacells e-timecolumn {{if dayBorderBottom==false}}e-alternatecells{{/if}}'><div class='e-textwrapper'>{{if userTimeId == false}}{{:time}}{{else}}{{:userTimeHtml}}{{/if}}<\/div><\/td><td class='e-agendacells e-eventcolumn {{if dayBorderBottom==false}}e-alternatecells{{/if}}'><div class='e-textwrapper'><div id='Appointment_{{:id}}'  guid= '{{:uid}}' class='e-agendaappointment'>{{if userAppTemplId == false}}<span class='e-agendacolordiv' style='background:{{:background}};'/>{{:event}}{{else}}{{:userTemplate}}{{/if}}{{if readOnly == false}}<div class='e-agendahover'><span class='e-icon e-editapp' title={{:edittext}}/><span class='e-icon e-deleteapp' title={{:deletetext}}/><\/div>{{/if}}<\/div><\/div><\/td><\/tr>{{/for}}<\/tbody><\/table>",this._agendaCellsTemplate};t.widget("ejSchedule","ej.Schedule",{_rootCSS:"e-schedule",element:null,validTags:["div"],model:null,defaults:{timeZoneCollection:{dataSource:[{text:"UTC -12:00",id:"1",value:"UTC -12:00"},{text:"UTC -11:00",id:"2",value:"UTC -11:00"},{text:"UTC -10:00",id:"3",value:"UTC -10:00"},{text:"UTC -09:00",id:"4",value:"UTC -09:00"},{text:"UTC -08:00",id:"5",value:"UTC -08:00"},{text:"UTC -07:00",id:"6",value:"UTC -07:00"},{text:"UTC -06:00",id:"7",value:"UTC -06:00"},{text:"UTC -05:00",id:"8",value:"UTC -05:00"},{text:"UTC -04:30",id:"9",value:"UTC -04:30"},{text:"UTC -04:00",id:"10",value:"UTC -04:00"},{text:"UTC -03:30",id:"11",value:"UTC -03:30"},{text:"UTC -03:00",id:"12",value:"UTC -03:00"},{text:"UTC -02:00",id:"13",value:"UTC -02:00"},{text:"UTC -01:00",id:"14",value:"UTC -01:00"},{text:"UTC +00:00",id:"15",value:"UTC +00:00"},{text:"UTC +01:00",id:"16",value:"UTC +01:00"},{text:"UTC +02:00",id:"17",value:"UTC +02:00"},{text:"UTC +03:00",id:"18",value:"UTC +03:00"},{text:"UTC +03:30",id:"19",value:"UTC +03:30"},{text:"UTC +04:00",id:"20",value:"UTC +04:00"},{text:"UTC +04:30",id:"21",value:"UTC +04:30"},{text:"UTC +05:00",id:"22",value:"UTC +05:00"},{text:"UTC +05:30",id:"23",value:"UTC +05:30"},{text:"UTC +05:45",id:"24",value:"UTC +05:45"},{text:"UTC +06:00",id:"25",value:"UTC +06:00"},{text:"UTC +06:30",id:"26",value:"UTC +06:30"},{text:"UTC +07:00",id:"27",value:"UTC +07:00"},{text:"UTC +08:00",id:"28",value:"UTC +08:00"},{text:"UTC +09:00",id:"29",value:"UTC +09:00"},{text:"UTC +09:30",id:"30",value:"UTC +09:30"},{text:"UTC +10:00",id:"31",value:"UTC +10:00"},{text:"UTC +11:00",id:"32",value:"UTC +11:00"},{text:"UTC +12:00",id:"33",value:"UTC +12:00"},{text:"UTC +13:00",id:"34",value:"UTC +13:00"}],text:"text",id:"id",value:"value"},views:["Day","Week","WorkWeek","Month","Agenda"],agendaViewSettings:{daysInAgenda:7,dateColumnTemplateId:null,timeColumnTemplateId:null},currentView:"week",timeMode:null,firstDayOfWeek:null,workWeek:["Monday","Tuesday","Wednesday","Thursday","Friday"],dateFormat:"",isDST:!1,timeZone:null,timeScale:{enable:null,minorSlotCount:2,majorSlot:60,minorSlotTemplate:null,majorSlotTemplate:null},startHour:0,endHour:24,highlightBusinessHours:!0,enableLoadOnDemand:!1,enablePersistence:!1,showQuickWindow:!0,showLocationField:!1,businessStartHour:9,businessEndHour:18,workHours:{highlight:null,start:null,end:null},width:"100%",height:"1120px",cellHeight:"20px",cellWidth:"",currentDate:new Date,minDate:new Date(1900,01,01),maxDate:new Date(2099,12,31),cssClass:"",locale:"en-US",enableResize:!1,readOnly:!1,enableRTL:!1,enableAppointmentNavigation:!0,appointmentTemplateId:null,resourceHeaderTemplateId:null,allowDragDrop:!0,enableAppointmentResize:!0,showCurrentTimeIndicator:!0,showAllDayRow:!0,showHeaderBar:!0,isResponsive:!0,enableRecurrenceValidation:!0,reminderSettings:{enable:!1,alertBefore:5},contextMenuSettings:{enable:!1,menuItems:{appointment:[{id:"open",text:"Open Appointment"},{id:"delete",text:"Delete Appointment"}],cells:[{id:"new",text:"New Appointment"},{id:"recurrence",text:"New Recurring Appointment"},{id:"today",text:"Today"},{id:"gotodate",text:"Go to date"},{id:"settings",text:"Settings"},{id:"view",text:"View",parentId:"settings"},{id:"timemode",text:"TimeMode",parentId:"settings"},{id:"view_Day",text:"Day",parentId:"view"},{id:"view_Week",text:"Week",parentId:"view"},{id:"view_Workweek",text:"Workweek",parentId:"view"},{id:"view_Month",text:"Month",parentId:"view"},{id:"view_Agenda",text:"Agenda",parentId:"view"},{id:"timemode_Hour12",text:"12 Hours",parentId:"timemode"},{id:"timemode_Hour24",text:"24 Hours",parentId:"timemode"},{id:"businesshours",text:"Business Hours",parentId:"settings"}]}},group:null,resources:null,allowKeyboardNavigation:!0,appointmentSettings:{dataSource:[],query:null,tableName:null,id:"Id",subject:"Subject",description:"Description",startTime:"StartTime",endTime:"EndTime",recurrence:"Recurrence",recurrenceRule:"RecurrenceRule",allDay:"AllDay",resourceFields:null,categorize:null,recurrenceId:"RecurrenceId",recurrenceExDate:"recurrenceExDate",location:null,priority:null,startTimeZone:"StartTimeZone",endTimeZone:"EndTimeZone"},renderDates:null,orientation:"vertical",categorizeSettings:{enable:!1,allowMultiple:!1,dataSource:[{text:"Blue Category",id:1,color:"#7499e1",fontColor:"green"},{text:"Green Category",id:2,color:"#7cce6e",fontColor:"green"},{text:"Orange Category",id:3,color:"#f19d5a",fontColor:"green"},{text:"Purple Category",id:4,color:"#937bd1",fontColor:"green"},{text:"Red Category",id:5,color:"#d98889",fontColor:"green"},{text:"Yellow Category",id:6,color:"#f8f264",fontColor:"green"}],text:"text",id:"id",color:"color",fontColor:"fontColor"},prioritySettings:{enable:!1,template:null,dataSource:[{text:"None",value:"none"},{text:"High",value:"high"},{text:"Medium",value:"medium"},{text:"Low",value:"low"}],text:"text",value:"value"},cellClick:null,cellHover:null,appointmentClick:null,appointmentHover:null,cellDoubleClick:null,appointmentWindowOpen:null,appointmentSaved:null,appointmentEdited:null,appointmentDeleted:null,navigation:null,dragStart:null,drag:null,dragStop:null,resizeStart:null,resize:null,resizeStop:null,menuItemClick:null,beforeContextMenuOpen:null,reminder:null,actionBegin:null,actionComplete:null,showTimeScale:!0,tooltipSettings:{enable:!1,template:null}},dataTypes:{views:"array",workWeek:"array",timeZoneCollection:{dataSource:"data",query:"data"},renderDates:"data",enablePersistence:"boolean",showTimeScale:"boolean",resources:"array",group:{resources:"array"},appointmentSettings:{dataSource:"data",query:"data"},categorizeSettings:{dataSource:"data",query:"data"},prioritySettings:{dataSource:"data",query:"data"},contextMenuSettings:{menuItems:{appointment:"array",cells:"array"}}},_ignoreOnPersist:["appointmentSettings.query","appointmentSettings.dataSource","timeZoneCollection.dataSource","allowKeyboardNavigation","showQuickWindow","cssClass","locale","enableResize","showHeaderBar","readOnly","enableRTL","enableAppointmentNavigation","appointmentTemplateId","resourceHeaderTemplateId","allowDragDrop","enableAppointmentResize","showCurrentTimeIndicator","reminderSettings.enable","contextMenuSettings.enable","group.resources","categorizeSettings.enable","categorizeSettings.dataSource","cellClick","appointmentClick","cellDoubleClick","appointmentWindowOpen","appointmentSaved","appointmentEdited","appointmentDeleted","navigation","dragStart","dragStop","resizeStart","resize","resizeStop","menuItemClick","beforeContextMenuOpen","reminder","prioritySettings.dataSource","prioritySettings.enable","agendaViewSettings.daysInAgenda","agendaViewSettings.dateColumnTemplateId","agendaViewSettings.timeColumnTemplateId"],_ignoreFromAppointmentOnExport:["dataSource","query","tableName","resourceFields"],_resources:function(){this.element.empty();this._bindResourcesData();t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll()},observables:["appointmentSettings.dataSource","currentView","currentDate"],_tags:[{tag:"timeZoneCollection",attr:[],singular:"timeZoneCollection"},{tag:"appointmentSettings.dataSource",attr:[],singular:"dataSource"},{tag:"resources",attr:["allowMultiple","field","title","name","resourceSettings"]},{tag:"contextMenuSettings.menuItems.appointment",attr:["id","text","parentId"]},{tag:"contextMenuSettings.menuItems.cells",attr:["id","text","parentId"]},{tag:"categorizeSettings.dataSource",attr:["text","id","color","fontColor"]},{tag:"timeZoneCollection.dataSource",attr:["text","id","value"]},{tag:"prioritySettings.dataSource",attr:["text","value"]}],currentView:t.util.valueFunction("currentView"),currentDate:t.util.valueFunction("currentDate"),dataSource:t.util.valueFunction("appointmentSettings.dataSource"),_init:function(){t.isNullOrUndefined(this.model.workHours.start)&&(this.model.workHours.start=this.model.businessStartHour);t.isNullOrUndefined(this.model.workHours.end)&&(this.model.workHours.end=this.model.businessEndHour);t.isNullOrUndefined(this.model.workHours.highlight)&&(this.model.workHours.highlight=this.model.highlightBusinessHours);t.isNullOrUndefined(this.model.timeZoneCollection)&&(this.model.timeZoneCollection=this.model.timezoneCollection);t.isNullOrUndefined(this.model.timeScale.enable)&&(this.model.timeScale.enable=this.model.showTimeScale);this._currentDateFormat(this.model.dateFormat);this._trigger("load");this.element.addClass("e-schedule");!t.isNullOrUndefined(this.model.appointmentSettings.query)&&this.model.appointmentSettings.query instanceof t.Query||(this.model.appointmentSettings.query=t.Query());this.model.cssClass!=null&&this.element.addClass(this.model.cssClass);this._initPrivateProperties();!t.isNullOrUndefined(this.model.categorizeSettings)&&this.model.categorizeSettings.dataSource instanceof t.DataManager&&this._bindCategorizeData();!t.isNullOrUndefined(this.model.prioritySettings)&&this.model.prioritySettings.dataSource instanceof t.DataManager&&this._bindPriorityData();t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)?this._bindResourcesData():this._renderInitSchedule();this._wireEvents();t.isNullOrUndefined(this.model.appointmentSettings)||(this._dataManager=this.dataSource()instanceof t.DataManager?this.dataSource():this.dataSource()!=null?t.DataManager(this.dataSource()):null);this._bindAppointmentsData("Load");this.model.enableRTL&&this.element.addClass("e-rtl");this.model.reminderSettings.enable&&(this._checkReminders(),this._reminderInterval=window.setInterval(n.proxy(this._checkReminders,this),6e4));this._businessHourScroller()},_setModel:function(i){var u=!1,a=!1,r,b,k,v,y,p,s,o,w,d,e;for(r in i)switch(r){case"views":this.model.views=i[r];this.hTD.find("table.e-viewstable").remove();this.hTD.find("div.e-viewsdiv").append(this._renderViewNavigation(i[r].toString().toLowerCase().split(",")));this.element.find(".e-commonviewbutton.e-"+this.currentView()).addClass("e-activeview").attr("tabIndex",0).focus();t.isNullOrUndefined(this._scheduleDrawer)||(this._scheduleDrawer.ejNavigationDrawer("destroy"),n(this._scheduleDrawer).remove(),this._scheduleDrawer=null,(this._mediaQuery||this.element.width()<600)&&!n("#"+this._id+"navDrawer").hasClass("e-scheduledrawer")&&this._renderNavigationDrawer());this.model.views.toString().toLowerCase().split(",").indexOf(this.currentView())==-1&&(this._navView=!0,this._viewChange(null,null,this.model.views[0].toLowerCase()));break;case"currentView":this._navView=!0;this.model.views.toString().toLowerCase().split(",").indexOf(t.util.getVal(i[r]).toLowerCase())!=-1?this._viewChange(null,null,t.util.getVal(i[r]).toLowerCase()):this.currentView(this.element.find(".e-activeview")[0].className.split("e-")[2].split(" ")[0]);break;case"currentDate":this._setCurrentDate=!0;n.type(i[r])=="string"&&this._currentDateFormat(this.model.dateFormat);this.currentDate()<this.model.minDate&&this.currentDate(this.model.minDate);this.currentDate()>this.model.maxDate&&this.currentDate(this.model.maxDate);this._navigateClick(null,"DateNavigation");break;case"minDate":case"maxDate":this._currentDateFormat(this.model.dateFormat);u=!0;break;case"timeMode":this.model.timeMode=this._timeMode=i[r];var h=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)&&!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)?!0:!1,c=t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)?!1:!0,l=this._timeSlotCount(h,c);if(this._appointmentAddWindow.find(".startendtime").ejTimePicker({timeFormat:this._timeMode=="12"?this._pattern.t:"HH:mm"}),this.model.orientation!="horizontal"||this.currentView()==="month"||this._isCustomView()||this.currentView()==="agenda")this.currentView()==="month"||this._isCustomView()||this.currentView()==="agenda"||(v=this.currentView()=="month"?1:0,(h||c)&&this.currentView()!=="month"&&!this._isCustomView()?(l.columnCount.pop(),y=this.userTimeCellTemplate.render({timerows:this._getStartEndTime(),cols1:l.columnCount,viewclass:v,timeScale:this.model.timeScale.minorSlotCount,cheight:this.model.cellHeight,userTemplateId:h,timeValue1:l.timeValue1,template:c})):y=this.timeCellTemplate.render({timerows:this._getStartEndTime(),cols1:l.columnCount,viewclass:v,timeScale:this.model.timeScale.minorSlotCount,userTemplateId:h,template:c}),this.$TimeCellTD.children().remove(),this.$TimeCellTD.append(y),this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove(),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator));else{var f=this.model.timeScale.enable?this._isCustomView()?"month":this.currentView():"month",nt=Globalize.culture(this.model.locale),g=f=="day"?1:f=="week"?7:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:5;this.datesColumn=this._getHeaderAllDayCellsCount();b=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?!0:!1;k=this.horizontalHeader.render({cols:this.datesColumn,label:this._getLocalizedLabels("Resources"),multiRes:b,view:f,timeTdCount:this._getStartEndTime(),colspan:f=="month"?1:this._getStartEndTime().length/g*2,height:f=="month"?62:59,width:this.model.width,headercellWidth:f=="day"?"100%":"55px"});this.aTR.children().remove();this.aTR.append(k);this._borderAddRemove();this._moveScroller();this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");this._businessHourScroller()}t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll();break;case"timeZone":this._setmodelvalue=!0;this.model.timeZone=i[r];this.element.find("div.e-categorybar").remove();this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,.e-appsoverflow").remove();this._bindAppointmentsData("Load");break;case"timeScale":n.extend(this.model.timeScale,i[r]);u=!0;break;case"timezoneCollection":case"timeZoneCollection":n.extend(this.model.timeZoneCollection,i[r]);this._appointmentAddWindow.find(".startutc").ejDropDownList({dataSource:this.model.timeZoneCollection.dataSource});this._appointmentAddWindow.find(".endutc").ejDropDownList({dataSource:this.model.timeZoneCollection.dataSource});break;case"startHour":this.model.startHour=i[r];this.currentView()!=="agenda"&&this._setNewStartEndHours();break;case"endHour":this.model.endHour=i[r];this.currentView()!=="agenda"&&this._setNewStartEndHours();break;case"highlightBusinessHours":this.model.workHours.highlight=i[r];this.currentView()!=="agenda"&&(this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells")&&this.element.find(".e-monthcells").removeClass("e-monthcellhighlight"),this.model.workHours.highlight==!1?this._businessHourScroller():"");break;case"workHours":n.extend(this.model.workHours,i[r]);this.currentView()!=="agenda"&&(this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells")&&this.element.find(".e-monthcells").removeClass("e-monthcellhighlight"),this.model.workHours.highlight==!1?this._businessHourScroller():"");break;case"showAllDayRow":this.model.showAllDayRow=i[r];this.model.timeScale.enable||(this.model.showAllDayRow=!1);this.model.timeScale.enable&&this.currentView()!="agenda"&&(this.currentView()!="month"?(this.aTR.empty(),this._renderHeaderAllDayTemplate(),this._borderAddRemove(),this._headerbarWidth(),this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay")),this.model.showAllDayRow&&this._reRenderAllDayAppointments(),this.model.orientation=="vertical"&&this.model.cellWidth&&this.element.find(".e-workcellstab tr td:first-child").width(this.element.find(".e-headercells").width()),this.refreshScroller(),this.element.find(".e-emptytd").length<1&&this.model.orientation=="vertical"?this.aTR.find(".e-headeralldaydiv").parent().next().append(this._emptyCell()):"",this.element.find(".e-emptyalldaytd").css("height",this.element.find(".e-alldaycells").height()+"px"),this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width())):this.refreshScroller());break;case"isResponsive":this.model.isResponsive=i[r];this._onScheduleResize();break;case"isDST":this.model.isDST=i[r];t.isNullOrUndefined(this.model.timeZone)&&(p=new Date,this._timeValue=this._true==!1?-(p.getTimezoneOffset()-this._stdTimezoneOffset()):p.getTimezoneOffset()-this._stdTimezoneOffset(),this._true=this.model.isDST==!0?!1:!0,this._dayLight=!0,this.element.find("div.e-categorybar").remove(),this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-appsoverflow").remove(),t.isNullOrUndefined(this.model.appointmentSettings)||(this._dataManager=this.dataSource()instanceof t.DataManager?this.dataSource():this.dataSource()!=null?t.DataManager(this.dataSource()):null),this._bindAppointmentsData("Load"));break;case"enableRecurrenceValidation":this.model.enableRecurrenceValidation=i[r];this.model.enableRecurrenceValidation&&t.isNullOrUndefined(this._alertWindow)&&this._renderAlertWindow();this._dataProcessing(this._currentAppointmentData);this._renderAppointmentAll();break;case"businessStartHour":this.model.workHours.start=i[r];this.currentView()!=="agenda"&&(this.currentView()!=="month"&&!this._isCustomView()?this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"):this.element.find(".e-monthcells").removeClass("e-monthcellhighlight"),this.model.workHours.highlight&&this._highlightBusinessHours());break;case"businessEndHour":this.model.workHours.end=i[r];this.currentView()!=="agenda"&&(this.currentView()!=="month"&&!this._isCustomView()?this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"):this.element.find(".e-monthcells").removeClass("e-monthcellhighlight"),this.model.workHours.highlight&&this._highlightBusinessHours());break;case"height":this.model.height=i[r];this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove();u=!0;break;case"width":this.model.width=i[r];this._clientWidth=this.model.width;this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove();u=!0;break;case"cssClass":this.element.removeClass(this.model.cssClass).addClass(i[r]);break;case"locale":this.model.locale=i[r];s=Globalize.culture(this.model.locale);this._dayShortNames=s.calendar.days.namesAbbr;this._dayFullNames=s.calendar.days.names;this._monthNames=s.calendar.months.names;this._pattern=s.calendar.patterns;this.model.contextMenuSettings.enable&&(this._gotoDate=!0);u=!0;break;case"dateFormat":this._appointmentAddWindow.find(".startenddate").ejDatePicker({dateFormat:i[r]});this._appointmentAddWindow.find(".recurstartdate").ejDatePicker({dateFormat:i[r]});this._appointmentAddWindow.find(".e-until").ejDatePicker({dateFormat:i[r]});this._currentDateFormat(i[r]);break;case"enableResize":this.model.enableResize=i[r];this.model.enableResize&&(t.isTouchDevice()?this._on(n(window),"orientationchange",this._scheduleResize):this._on(n(window),"resize",this._scheduleResize),this._wireResizeEvents());break;case"readOnly":this.model.readOnly=i[r];this._renderAppointmentAll();break;case"showCurrentTimeIndicator":this.model.showCurrentTimeIndicator=i[r];this.currentView()!=="agenda"&&(this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this.model.showCurrentTimeIndicator||(this.currentView()!=="month"&&!this._isCustomView()?this.element.find(".e-highlightcurrenttimeline").remove():n(this.element.find(".e-monthcells")).removeClass("e-monthcurrenttime")));break;case"enableRTL":i[r]?this.element.addClass("e-rtl"):this.element.removeClass("e-rtl");this.model.enableRTL=i[r];u=!0;this._quickAppointWindow=null;break;case"appointmentTemplateId":this.model.appointmentTemplateId=i[r];this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,.e-appsoverflow").remove();this.element.find("div.e-categorybar").remove();t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll();break;case"allowKeyboardNavigation":this.model.allowKeyboardNavigation=i[r];this.model.allowKeyboardNavigation?(this._on(this.element,"keydown",n.proxy(this._onKeyDown,this)),this._on(n(document),"keydown",n.proxy(this._documentOnKeyDown,this))):(this._off(this.element,"keydown"),this._off(n(document),"keydown"));break;case"renderDates":n.extend(this.model.renderDates,i[r]);this._navView=!0;this._navigate=!1;this._viewChange(null,null,"customview");break;case"showTimeScale":this.model.timeScale.enable=i[r];this.model.timeScale.enable==!0?(this.model.showAllDayRow=!0,this.model.showCurrentTimeIndicator=!0):(this.model.showAllDayRow=!1,this.model.showCurrentTimeIndicator=!1);this.currentView()!=="agenda"&&(u=!0);break;case"appointmentSettings":n.isEmptyObject(i[r])||(n.extend(this.model.appointmentSettings,i[r]),this.element.find("div.e-categorybar").remove(),this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-appsoverflow").remove(),t.isNullOrUndefined(this.model.appointmentSettings)||(this._dataManager=this.dataSource()instanceof t.DataManager?this.dataSource():this.dataSource()!=null?t.DataManager(this.dataSource()):null),this._bindAppointmentsData("Load"));break;case"contextMenuSettings":n.extend(this.model.contextMenuSettings,i[r]);this.model.contextMenuSettings.enable&&t.isNullOrUndefined(this._contextMenu)&&this._showContextMenu(this.model.contextMenuSettings.enable);break;case"reminderSettings":i[r].enable?this._checkReminders()&&(this._reminderInterval=window.setInterval(n.proxy(this._checkReminders,this),6e4)):window.clearInterval(this._reminderInterval);break;case"enableAppointmentNavigation":this.model.enableAppointmentNavigation=i[r];this.model.enableAppointmentNavigation?(this._nextPrevAppointment(this.model.enableAppointmentNavigation),t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll()):this.element.find(".e-prevapp,.e-nextapp").remove();break;case"enableLoadOnDemand":this.model.enableLoadOnDemand=i[r];this.element.find("div.e-categorybar").remove();this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,.e-appsoverflow").remove();this._bindAppointmentsData("Load");break;case"resources":t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&(t.copyObject(this.model.resources,i[r]),u=!0,a=!0);break;case"categorizeSettings":n.extend(this.model.categorizeSettings,i[r]);t.isNullOrUndefined(this.model.categorizeSettings)||(this.model.categorizeSettings.enable&&this._appointmentAddWindow.find(".e-categorizevalue").length==0?(o="<tr id='"+this._id+"categorize'><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Categorize")+":<\/td><td colspan='3' class='e-rightfields'><input id= '"+this._id+"_categorize' class='e-categorizevalue' type='text' value=''/><div id='ownerlist'><\/div><\/td><\/tr>",this._appointmentAddWindow.find("."+this._id+"summary").after(o),this._renderTemplates(),e=this._appointmentAddWindow,this._renderCategoryItems(e)):this._appointmentAddWindow.find("#"+this._id+"categorize").remove(),this._showContextMenu(this.model.contextMenuSettings.enable),this._appointmentAddWindow.find(".e-categorizevalue").ejAutocomplete("clearText"),e=this._appointmentAddWindow,this._renderCategoryItems(e),t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll());break;case"group":t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&(n.extend(this.model.group,i[r]),u=!0,a=!0);break;case"cellWidth":this.model.cellWidth=i[r];this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove();this.currentView()!=="agenda"&&(u=!0);break;case"cellHeight":this.model.cellHeight=i[r];this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove();this.currentView()!=="agenda"&&(u=!0);break;case"orientation":this.model.orientation=i[r];!t.scheduleFeatures.resources||t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)||this.model.orientation!="horizontal"||this._on(this.element,"click","td.e-parentnodecategory",n.proxy(this._onResourceClick,this));u=!0;break;case"resourceHeaderTemplateId":this.model.resourceHeaderTemplateId=i[r];!t.scheduleFeatures.resources||t.isNullOrUndefined(this.model.group)||t.isNullOrUndefined(this.model.resources)||(this.currentView()!="agenda"?this.model.orientation=="horizontal"?(w=n(this.wTR.find("td")[0]),w.find("div.e-horizontresdiv").remove(),d=this._renderHorizontalResources(),w.html(d)):(this.aTR.empty(),this._renderHeaderAllDayTemplate(),this._borderAddRemove(),this._headerbarWidth(),this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay")),this.model.showAllDayRow&&this._reRenderAllDayAppointments()):this._renderAgendaContent());break;case"showLocationField":this.model.showLocationField=i[r];this.model.showLocationField?(o="<tr id='"+this._id+"showLocation' class='"+this._id+"showLocation'><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Location")+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"location' tabIndex='0' class='location e-inputtext' name='"+this.model.appointmentSettings.location+"' type='text' /><\/td><\/tr>",this._appointmentAddWindow.find("."+this._id+"subjecttr").after(o)):this._appointmentAddWindow.find("."+this._id+"showLocation").remove();break;case"prioritySettings":n.extend(this.model.prioritySettings,i[r]);this.model.prioritySettings.enable?(this._appointmentAddWindow.find("."+this._id+"priorityshow").length==0&&(o="<td colspan='1' class='e-textlabel "+this._id+"priorityshow'>"+this._getLocalizedLabels("Priority")+":<\/td><td colspan='1' class='"+this._id+"prioritylistshow'><input id='"+this._id+"_priority' class='priority' type='text' name='"+this.model.appointmentSettings.priority+"' value='' /><div id='prioritylist'><\/div><\/td>",this._appointmentAddWindow.find("."+this._id+"parrow").prepend(o)),e=this._appointmentAddWindow,this._renderPriorityItems(e),this._renderTemplates()):(this._appointmentAddWindow.find("."+this._id+"priorityshow").remove(),this._appointmentAddWindow.find("."+this._id+"prioritylistshow").remove());t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll();break;case"showQuickWindow":this.model.showQuickWindow=i[r];this.model.showQuickWindow&&t.isNullOrUndefined(this._quickAppointWindow)&&(this._renderQuickAppWindow()||this._renderQuickAppDetailsView());this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");break;case"allowDragDrop":if(this.model.allowDragDrop=i[r],this.currentView()=="agenda")return!1;this.model.allowDragDrop?this._dragdropAppointments():this._unWireDragDrop();break;case"enableAppointmentResize":if(this.model.enableAppointmentResize=i[r],this.currentView()=="agenda")return!1;this._renderAppointmentAll();break;case"showHeaderBar":this.model.showHeaderBar=i[r];this.model.showHeaderBar?(this.element.find(".e-scheduleheader").show(),this._reRenderHeaderBar()):(this.element.find(".e-scheduleheader").empty(),this.element.find(".e-scheduleheader").hide());this.refreshScroller();break;case"tooltipSettings":n.extend(this.model.tooltipSettings,i[r]);!t.isNullOrUndefined(this.model.tooltipSettings)&&this.model.tooltipSettings.enable?(this._on(this.element,"mouseover",".e-appointment,.e-alldayappointment,.e-monthappointment",n.proxy(this._showToolTip,this)),this._on(this.element,"mouseout",".e-appointment,.e-alldayappointment,.e-monthappointment",n.proxy(this._hideToolTip,this))):(this._off(this.element,"mouseover",".e-appointment,.e-alldayappointment,.e-monthappointment",n.proxy(this._showToolTip,this)),this._off(this.element,"mouseout",".e-appointment,.e-alldayappointment,.e-monthappointment",n.proxy(this._hideToolTip,this)));break;case"firstDayOfWeek":this.model.firstDayOfWeek=this._firstdayofweek=i[r];this._firstdayofweek&&(u=!0);break;case"workWeek":this.model.workWeek=i[r];(this.model.workWeek==null||this.model.workWeek.length>=0)&&(u=!0);break;case"agendaViewSettings":n.extend(this.model.agendaViewSettings,i[r]);this.currentView()=="agenda"&&(this.model.showHeaderBar&&(this.element.find("div.e-datedisplay")[0].innerHTML=this._getCurrentDateHeaderValue()),this._renderAgendaContent())}u&&(this.element.empty(),n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"AppointmentQuickWindow_wrapper,#"+this._id+"AppDetailsWindow_wrapper,#"+this._id+"RecurrenceEdit_wrapper").remove(),a?this._bindResourcesData():this._renderInitSchedule(),this.model.workHours.highlight==!0?this._businessHourScroller():"",t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll())},_touchSchedule:function(t){if(n(t.target).is(".e-appointment,.e-alldayappointment,.e-monthappointment")||n(t.target).parents().is(".e-appointment,.e-alldayappointment,.e-monthappointment"))return!1;var i,r=parseInt(this.element.find(".e-draggableworkarea").css("margin-left"));switch(t.type){case"swipeleft":if(this._mediaQuery&&this.currentView()!="agenda"){if(-r<this.element.find(".e-draggableworkarea").width()-this.element.find(".e-draggableworkarea").width()/this.res1.length)return this.element.find(".e-headeralldaydiv,.e-draggableworkarea").animate({"margin-left":r+-this.element.find(".e-draggableworkarea").width()/this.res1.length},500),!1;this.element.find(".e-headeralldaydiv,.e-draggableworkarea").css("margin-left","0px")}i={currentTarget:this.element.find(".e-navigatenext")};this._navigateClick(i,"Next");break;case"swiperight":if(this._mediaQuery&&this.currentView()!="agenda"){if(-r>0)return this.element.find(".e-headeralldaydiv,.e-draggableworkarea").animate({"margin-left":r+this.element.find(".e-draggableworkarea").width()/this.res1.length},500),!1;this.element.find(".e-headeralldaydiv,.e-draggableworkarea").css("margin-left",-(this.element.find(".e-draggableworkarea").width()-this.element.find(".e-draggableworkarea").width()/this.res1.length))}i={currentTarget:this.element.find(".e-navigateprevious")};this._navigateClick(i,"Previous")}},_initPrivateProperties:function(){this._navSelected=this._navDrawer=this._alldayLevel=this._reminderClose=this._navView=this._editKey=this._cellClick=this._recurChecked=this._setCurrentDate=this._leftResizing=this._rightResizing=this._topResizing=this._bottomResizing=this._navigate=this._navigate=!1;this._dragDrop=this._gotoDate=this._bindapp=!0;this._tempStart=this._tempEnd=this._currentAction="";this._currentRowIndex=this._currentColIndex=0;this._appId=this._parentId=this._splitId=1;this.overlapList=this._currentAppointmentData=this._processed=this._dateRender=[];this.res1=[0];this._appMainId=null;this._rRule={};this._dayNamesArray=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];this._dayNames=["SU","MO","TU","WE","TH","FR","SA"];var n=Globalize.culture(this.model.locale);this._dayShortNames=n.calendar.days.namesAbbr;this._dayFullNames=n.calendar.days.names;this._monthNames=n.calendar.months.names;this._pattern=n.calendar.patterns;this._browserInfo=t.browserInfo();this._focused=null},_destroy:function(){this.element.off();this._destorySubControls(n("#"+this._id+"_AddEditForm"));this._destorySubControls(n("#"+this._id+"_RecurForm"));this.element.find("#"+this._id+"_navigator").ejDatePicker("destroy");window.clearInterval(this._intervalID);n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"AppointmentQuickWindow_wrapper,#"+this._id+"AppDetailsWindow_wrapper,#"+this._id+"RecurrenceEdit_wrapper").remove();n("#"+this._id+"_WorkCells_Template,#"+this._id+"_MonthCells_Template,#"+this._id+"_TimeCells_Template,#"+this._id+"_HeaderDate_Template,#"+this._id+"_Appointment_Template,#"+this._id+"_AlldayCells_Template,#"+this._id+"_LeftIndentCells_Template").remove();this.element.empty().removeClass("e-schedule")},_destorySubControls:function(t){for(var i,u=t.find(".e-timepicker,.e-datepicker,.e-dropdownlist,.e-autocomplete"),r=0;r<u.length;r++)i=n(u[r]),i.hasClass("e-timepicker")?i.ejTimePicker("destroy"):i.hasClass("e-datepicker")?i.ejDatePicker("destroy"):i.hasClass("e-dropdownlist")?i.ejDropDownList("destroy"):i.hasClass("e-autocomplete")&&i.ejAutocomplete("destroy")},_wireEvents:function(){this._on((this.element,n(window)),"mousedown",n.proxy(this._onScheduleMouseDown,this));this._on(this.element,"click","div.e-navigateprevious,div.e-navigatenext",n.proxy(this._navigateClick,this));this._on(n(window),"resize",n.proxy(this._onScheduleResize,this));this._on(this.element,"click",".e-commonviewbutton",n.proxy(this._viewChange,this));this._on(this.element,"click",".e-datedisplay",n.proxy(this._viewCalendar,this));this._on(this.element,"click","div.e-appsoverflow",n.proxy(this._appOverflowClick,this));this._on(this.element,"click",".e-prevapp.enable,.e-nextapp.enable",n.proxy(this._nextPrev,this));this._on(this.element,"dblclick",".e-headercells",n.proxy(this._navigateView,this));this._on(this.element,"click",".e-headercells,.e-timecells,td.e-monthcells div.e-monthheader",n.proxy(this._navigateView,this));this._on(this.element,"mouseover","td.e-alldaycells,td.e-workcells:not('.e-resourceheadercells'),td.e-monthcells,td.e-agendacells",n.proxy(this._onCellMouseOver,this));this._on(this.element,"mouseout","td.e-alldaycells,td.e-workcells:not('.e-resourceheadercells'),td.e-monthcells,td.e-agendacells",n.proxy(this._onCellMouseOver,this));this._on(this.element,"click",".e-workcells,.e-alldaycells,.e-alldayappointment,.e-monthcells,.e-agendacells",n.proxy(this._cellSelection,this));this._mediaQuery||(this._on(this.element,t.eventType.mouseDown,"td.e-workcells,td.e-monthcells,td.e-alldaycells",n.proxy(this._mouseButtonClick,this)),this._on(this.element,"keydown click","td.e-workcells,td.e-monthcells,td.e-alldaycells",n.proxy(this._shiftSelection,this)));this._on(this.element,t.isMobile()?"click":"dblclick",".e-workcells:not('.e-resourceheadercells'),.e-alldaycells,.e-alldayappointment,.e-monthcells",n.proxy(this._appointmentWindow,this));(this._mediaQuery||t.isMobile())&&this._on(this.element,"tap",".e-appointment,.e-alldayappointment,div.e-monthappointment,.e-agendaappointment",n.proxy(this._appointmentWindow,this));this._on(this.element,"mouseover",".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment",n.proxy(this._onAppointMouseOver,this));this._on(this.element,"mouseout",".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment",n.proxy(this._onAppointMouseOver,this));this._on(this.element,"mouseover",".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment",n.proxy(this._showToolTip,this));this._on(this.element,"mouseout",".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment",n.proxy(this._hideToolTip,this));(this._mediaQuery||this.element.width()<600)&&this._on(this.element,"click","#"+this._id+"navDrawerIcon",n.proxy(this._drawerOpen,this));this.model.allowKeyboardNavigation&&(this._on(this.element,"keydown",n.proxy(this._onKeyDown,this)),this._on(n(document),"keydown",n.proxy(this._documentOnKeyDown,this)));this.model.orientation=="horizontal"&&this._on(this.element,"click","td.e-parentnodecategory",n.proxy(this._onResourceClick,this));this._on(this.element,"swipeleft swiperight",".e-contentarearow .e-workcellstab,.e-agendacellstab",n.proxy(this._touchSchedule,this));this.model.enableResize&&(t.isTouchDevice()?this._on(n(window),"orientationchange",this._scheduleResize):this._on(n(window),"resize",this._scheduleResize));this._on(this.element,"click",".e-schedulemouseclose,.e-deleteapp",n.proxy(this._deleteAppoint,this));this._on(this.element,"click",".e-editapp",n.proxy(this._appointmentWindow,this))},_drawerOpen:function(){this._scheduleDrawer.ejNavigationDrawer("open")},_mouseButtonClick:function(i){var s,e,o;if(!i.altKey&&!i.shiftKey&&!i.ctrlKey&&i.which!=3&&(i.which==1||i.type=="touchstart")&&!n(i.target).hasClass("e-resourceheadercells")){var u=i.target||document.activeElement||i.srcElement,f=this.element.find("div.e-draggableworkarea tr"),r=this;n(u).hasClass("e-alldaycells")&&(f=this.element.find(".e-alldaycells").parent());n(u).hasClass("e-selectedAppointment")&&(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(f[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());this._currentRowIndex=n(u).parent()[0].rowIndex;this._currentColIndex=n(u)[0].cellIndex;s=r.model.orientation=="horizontal"&&r.currentView()=="month"?r.monthDays:r.model.orientation=="vertical"?r.dateRender:r._dateRender;e=n(i.target).hasClass("e-workcells")||n(i.target).hasClass("e-alldaycells")?n(i.target).index():7-((parseInt(n(i.target).index()/7)+1)*7-n(i.target).index())+n(i.target).parent().index()*7;this.model.orientation=="horizontal"&&(e=r.currentView()!=="month"?Math.floor(e/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))):e);o=new Date(s[e]);o>=this.model.minDate&&o<=this.model.maxDate&&(n(u).hasClass("e-workcells")||n(u).hasClass("e-monthcells")||n(u).hasClass("e-alldaycells"))&&(f.bind(t.eventType.mouseMove,function(t){var i,f;r.model.showQuickWindow&&r._quickAppointWindow.ejDialog("close")&&r._quickAppDetailsWindow.ejDialog("close");t.preventDefault();i=t.target;t.type=="touchmove"&&(f=t.originalEvent.changedTouches[0],i=document.elementFromPoint(f.pageX,f.pageY));n(i).hasClass("e-selectedCell")&&r.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell");r._mouseSelection(t,r,u,i);r._moveScrollContent(u,r)}),f.bind(t.eventType.mouseUp,function(){f.unbind(t.eventType.mouseMove)}),this.element.find("e.workcells,e.alldaycells,.e-monthcells").removeClass("e-mousehover"),this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell"),this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"))}},_mouseSelection:function(t,i,r,u){var s=i.element.find("div.e-draggableworkarea tr"),a=n(r).parent()[0].rowIndex,o=n(r)[0].cellIndex,d=s.length-1,h,c,f,l=n(u).parent()[0].rowIndex,e=n(u)[0].cellIndex,y=i.element.find(".e-alldaycells").parent(),k=i.model.showAllDayRow,g=i.model.orientation=="horizontal"?s[0].cells.length:i.currentView()=="month"||i._isCustomView()?s[0].cells.length/i.res1.length:i._dateRender.length,nt=Math.floor(n(u).index()/g),p=g*(nt+1),w=g*nt,b,v;if(n(u).hasClass("e-workcells"))if(i.model.orientation=="vertical")if(o>=parseInt(w)&&o<=parseInt(p)-1&&e!="undefined"){if(o==e)if(l>a)for(f=parseInt(a);f<=l;f++)n(s[f].cells[o]).addClass("e-selectedCell");else if(l<a)for(f=parseInt(a);f>=l;f--)n(s[f].cells[o]).addClass("e-selectedCell");else n(s[l].cells[e]).addClass("e-selectedCell");else if(e>o){for(v=e-o,h=parseInt(a);h<=d;h++)n(s[h].cells[o]).addClass("e-selectedCell");if(k&&n(y[0].cells[[o]]).addClass("e-selectedCell"),k&&n(y[0].cells[[e]]).addClass("e-selectedCell"),v>1)for(f=1;f<=v-1;f++){for(b=0;b<=d;b++)n(s[b].cells[e-f]).addClass("e-selectedCell");k&&n(y[0].cells[[e-f]]).addClass("e-selectedCell")}for(c=0;c<=l;c++)n(s[c].cells[e]).addClass("e-selectedCell")}else if(e<o){for(v=o-e,h=parseInt(a);h>=0;h--)n(s[h].cells[o]).addClass("e-selectedCell");if(k&&n(y[0].cells[[o]]).addClass("e-selectedCell"),k&&n(y[0].cells[[e]]).addClass("e-selectedCell"),v>1)for(f=1;f<=v-1;f++){for(b=0;b<=d;b++)n(s[b].cells[[e+f]]).addClass("e-selectedCell");k&&n(y[0].cells[[e+f]]).addClass("e-selectedCell")}for(c=parseInt(l);c<=d;c++)n(s[c].cells[e]).addClass("e-selectedCell")}i._currentRowIndex=l;i._currentColIndex=e;n(s[l].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1;else if(a==l&&o>=parseInt(w)&&o<=parseInt(p)-1&&e!="undefined"){if(e>o)for(c=o;c<=e;c++)n(s[l].cells[c]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(e<=o)for(c=o;c>=e;c--)n(s[l].cells[c]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1;else if(n(u).hasClass("e-alldaycells"))if(o>=parseInt(w)&&o<=parseInt(p)-1&&e!="undefined"){if(e<o)for(f=o;f>=e;f--)n(y[0].cells[f]).addClass("e-selectedCell");else if(e>o)for(f=o;f<=e;f++)n(y[0].cells[f]).addClass("e-selectedCell");i._currentRowIndex=0;i._currentColIndex=e;n(y[0].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1;else if(n(u).hasClass("e-monthcells"))if(o>=parseInt(w)&&o<=parseInt(p)-1&&e!="undefined"){if(l==a)if(e<o)for(f=o;f>=e;f--)n(s[l].cells[f]).addClass("e-selectedCell");else if(e>o)for(f=o;f<=e;f++)n(s[l].cells[f]).addClass("e-selectedCell");else e==o&&n(s[l].cells[e]).addClass("e-selectedCell");else if(l>a){for(v=l-a,h=o;h<p;h++)n(s[a].cells[h]).addClass("e-selectedCell");if(v>1)for(f=1;f<=v-1;f++)for(h=w;h<p;h++)n(s[a+f].cells[h]).addClass("e-selectedCell");for(c=w;c<=e;c++)n(s[l].cells[c]).addClass("e-selectedCell")}else if(l<a){for(v=a-l,h=o;h>=w;h--)n(s[a].cells[h]).addClass("e-selectedCell");if(v>1)for(f=1;f<=v-1;f++)for(h=w;h<p;h++)n(s[a-f].cells[h]).addClass("e-selectedCell");for(c=p-1;c>=e;c--)n(s[l].cells[c]).addClass("e-selectedCell")}i._currentRowIndex=l;i._currentColIndex=e;n(s[l].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else return!1},_shiftSelection:function(t){var u,i,r;if(t.shiftKey==!0&&t.which==1&&!n(t.target).hasClass("e-resourceheadercells")){var f=this._focused,e=this,o=t.target;this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");this.element.find("e.workcells,e.alldaycells,.e-monthcells").removeClass("e-mousehover");this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell");this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment");u=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender;i=n(t.target).hasClass("e-workcells")||n(t.target).hasClass("e-alldaycells")?n(t.target).index():7-((parseInt(n(t.target).index()/7)+1)*7-n(t.target).index())+n(t.target).parent().index()*7;this.model.orientation=="horizontal"&&(i=this.currentView()!=="month"?Math.floor(i/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))):i);r=new Date(u[i]);r>=this.model.minDate&&r<=this.model.maxDate&&this._mouseSelection(t,e,f,o)}},_moveScrollContent:function(i,r){var u,e,f;r.model.orientation==="horizontal"?(u=r.element.find(".e-draggableworkarea").scrollLeft(),u=r.model.enableRTL?t.browserInfo().name=="mozilla"?u>0?u:u*-1:t.browserInfo().name=="chrome"||t.browserInfo().name=="webkit"?r.element.find(".e-workcells")[0].offsetLeft+r.element.find(".e-workcells").width()-r.element.find(".e-draggableworkarea").scrollLeft()-r.element.find(".e-draggableworkarea").width():Math.abs(u):-u,r.currentView()!="month"?n(r.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",u+"px"):r.element.find(".e-headerdays").css("left",u+"px"),r.currentView()==="day"||r.currentView()==="month"||r.currentView()=="customview"&&r._dateRender.length>7||!r.model.timeScale.enable||(e=n(r.element.find(".e-headercells").find(".e-activeview").parent()).index(),f=Math.floor(Math.abs(u)/(r.element.find(".e-workcells").width()+1)/((r.model.endHour-r.model.startHour)*2)),e!==f&&r.element.find(".e-headercells").children().removeClass("e-activeview"),n(r.element.find(".e-headercells")[f]).children().addClass("e-activeview"))):n(i).hasClass("e-monthcells")||r.element.find(".e-scrolltimecells").css("top",-r.element.find(".e-draggableworkarea").scrollTop()+"px")},_onScheduleMouseDown:function(t){var i=n(t.target),r=i.hasClass("e-appointment,e-alldayappointment,e-monthappointment")?i:i.parents(".e-appointment,.e-alldayappointment,.e-monthappointment");i.hasClass("e-workcells")||r.hasClass("e-appointment")||r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment")||i.hasClass("e-alldaycells")||i.hasClass("e-monthcells")||i.parents(".e-scheduledialog").hasClass("e-scheduledialog")||(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),this.element.find(".e-workcells").removeClass("e-mousehover"))},_onCellMouseOver:function(i){var r,u;if(this.currentView()=="agenda"){if(this._mediaQuery==!0)return!1;r=n(i.currentTarget);i.type==="mouseover"?(this.element.find(".e-mousehover").removeClass("e-mousehover"),r.hasClass("e-agendacells")&&(r.parent().find(".e-timecolumn,.e-eventcolumn").addClass("e-mousehover"),r.parent().find(".e-editapp").parent().show())):i.type==="mouseout"&&r.hasClass("e-agendacells")&&(r.parent().find(".e-timecolumn,.e-eventcolumn").removeClass("e-mousehover"),r.parent().find(".e-editapp").parent().hide())}else{r=n(i.currentTarget);u=n(i.target).hasClass("e-workcells")?n(i.target).index():n(i.target).hasClass("e-alldaycells")?n(i.target).index():7-((parseInt(n(i.target).index()/7)+1)*7-n(i.target).index())+n(i.target).parent().index()*7;this.model.orientation=="horizontal"&&(u=this.currentView()!=="month"?Math.floor(u/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))):u);var e=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,f=new Date(e[u]),o={currentDate:f,cellIndex:u,target:i,resources:!t.isNullOrUndefined(this.model.cellHover)&&!t.isNullOrUndefined(this.model.resources)?this._getResourceValue(r,u):null};if(this._trigger("cellHover",o))return!1;if(f>=this.model.minDate&&f<=this.model.maxDate)i.type==="mouseover"?(this.element.find(".e-mousehover").removeClass("e-mousehover"),(r.hasClass("e-workcells")||r.hasClass("e-monthcells"))&&!r.hasClass("e-resourceheadercells")&&r.addClass("e-mousehover")):i.type==="mouseout"&&(r.hasClass("e-workcells")||r.hasClass("e-monthcells"))&&r.removeClass("e-mousehover");else return!1}},_getAppDetails:function(i){var r=t.isNullOrUndefined(i.target)?n(i):n(i.target),e=r.hasClass("e-appointment")||r.hasClass("e-monthappointment")||r.hasClass("e-alldayappointment")||r.hasClass("e-agendaappointment")?r:r.parents(".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment"),u,f;appId=e.attr("guid");var o=this._getAppointmentByParentId(appId),s=(new t.Query).where("Guid",t.FilterOperators.equal,appId),h=t.DataManager(this._processed).executeLocal(s);return h[0][this.model.appointmentSettings.recurrence]==1?(u=(new t.Query).where("Guid",t.FilterOperators.equal,appId),f=new t.DataManager(this._processed).executeLocal(u)):(u=(new t.Query).where("ParentId",t.FilterOperators.equal,o.ParentId),f=new t.DataManager(this._processed).executeLocal(u)),f[0]},_onAppointMouseOver:function(i){var f,u,r;if(!this.model.readOnly){if(!t.isNullOrUndefined(this.model.appointmentHover)&&(f={appointment:this._getAppDetails(i)},this._trigger("appointmentHover",f)))return!1;if(this.currentView()=="agenda"){if(this._mediaQuery==!0)return!1;u=n(i.currentTarget);i.type==="mouseover"?(this.element.find(".e-mousehover").removeClass("e-mousehover"),u.hasClass("e-agendaappointment")&&(u.addClass("e-mousehover"),u.find(".e-editapp").parent().show())):i.type==="mouseout"&&u.hasClass("e-agendaappointment")&&(u.removeClass("e-mousehover"),u.find(".e-editapp").parent().hide())}else r=n(i.target).hasClass("e-appointment,e-alldayappointment,e-monthappointment")?n(i.target):n(i.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),r.hasClass("e-appointment")&&this.model.orientation=="vertical"?i.type==="mouseover"?(this.model.enableAppointmentResize&&(r.find(".e-bottomhandle,.e-tophandle").addClass("e-icon e-nsexpand"),r.find(".e-bottomhandle").addClass("e-appointresizer-bottom"),r.find(".e-tophandle").addClass("e-appointresizer-top")),r.find(".e-schedulemouseclose").css("display","block")):i.type==="mouseout"&&(this.model.enableAppointmentResize&&r.find(".e-bottomhandle,.e-tophandle").removeClass("e-icon e-nsexpand"),r.find(".e-schedulemouseclose").css("display","none")):((r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment"))&&this.model.orientation=="vertical"||this.model.orientation=="horizontal")&&(i.type==="mouseover"?(this.model.enableAppointmentResize&&(r.find(".e-lefthandle,.e-righthandle").addClass("e-icon e-ewexpand"),r.find(".e-lefthandle").addClass("e-appointresizer-left"),r.find(".e-righthandle").addClass("e-appointresizer-right")),r.find(".e-schedulemouseclose").css("display","block")):i.type==="mouseout"&&(this.model.enableAppointmentResize&&r.find(".e-lefthandle,.e-righthandle").removeClass("e-icon e-ewexpand"),r.find(".e-schedulemouseclose").css("display","none")))}},_cellSelection:function(r){var c,u,nt,a,e,l,tt,it,p,v,rt,ut,w,f,ft,h,st,ht,d,g,ct,lt,at,o;if(r.shiftKey||(this.element.find("e.workcells,e.alldaycells,.e-monthcells,.e-agendacells").removeClass("e-mousehover"),this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),c=Globalize.culture(this.model.locale),u=t.isNullOrUndefined(r.target)?n(r):n(r.target),u.hasClass("e-appointwrapper")||u.hasClass("e-textwrapper")&&(u=n(u).parent()),u.hasClass("e-lefthandle")||u.hasClass("e-righthandle")||u.hasClass("e-tophandle")||u.hasClass("e-bottomhandle")))return!1;if(t.isNullOrUndefined(r.type)||r.type!="beforeOpen"?this.element.find(".e-workcells,.e-alldaycells,.e-monthcells,.e-agendacells").removeClass("e-selectedCell"):(nt=this.element.find("td.e-selectedCell"),nt.length>0&&!u.hasClass("e-selectedCell")&&this.element.find(".e-workcells,.e-alldaycells,.e-monthcells,.e-agendacells").removeClass("e-selectedCell")),this.currentView()!="agenda"){if((u.hasClass("e-workcells")||u.hasClass("e-alldaycells")||u.hasClass("e-monthcells"))&&!u.hasClass("e-resourceheadercells")){if((this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close"),this._cellIndex=this.model.timeScale.enable?u.hasClass("e-workcells")?u.index():u.hasClass("e-alldaycells")?u.index():this._isCustomView()&&this._oneWeek?u.index():7-((parseInt(u.index()/7)+1)*7-u.index())+u.parent().index()*7:this.model.orientation=="vertical"&&this.currentView()=="month"||this.currentView()=="customview"&&this._dateRender.length>=7?7-((parseInt(u.index()/7)+1)*7-u.index())+u.parent().index()*7:u.index(),this.model.orientation=="horizontal"&&(this._cellIndex=this.model.timeScale.enable?this.currentView()!=="month"&&!this._isCustomView()?Math.floor(this._cellIndex/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot))):this._cellIndex:u.index(),this._workCellIndex=u.parent().index()),a=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"||this.currentView()=="customview"&&this._dateRender.length<=7?this.dateRender:this._dateRender,a=this.model.orientation=="horizontal"&&this.currentView()=="customview"&&this._dateRender.length<=7?this._dateRender:a,e=new Date(a[this._cellIndex]),this.model.minDate>e||this.model.maxDate<e)||(u.hasClass("e-workcells")&&this.model.timeScale.enable&&this.currentView()!=="month"&&!this._isCustomView()?(l=this.model.orientation=="vertical"?this.model.startHour*60+u.parent().index()*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount):(this.model.startHour+u.index())*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*this._cellIndex*(60/this.model.timeScale.majorSlot)*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount),l=l*6e4,this._timeScaleMin=this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,this._timeScaleMin=this._timeScaleMin*6e4,this.cur_StartTime=new Date(e).setMilliseconds(l),tt=parseInt(new Date(this.cur_StartTime).getHours())==new Date(new Date(e).setMinutes(this._timeScaleMin*this.model.timeScale.minorSlotCount*(this.model.endHour-this.model.startHour)-this.model.timeScale.minorSlotCount)).getHours()&&parseInt(new Date(this.cur_StartTime).getMinutes())==new Date(new Date(e).setMinutes(this._timeScaleMin*this.model.timeScale.minorSlotCount*(this.model.endHour-this.model.startHour)-this.model.timeScale.minorSlotCount)).getMinutes()?l+(this._timeScaleMin-1):new Date(this.cur_StartTime).getMilliseconds()+this._timeScaleMin,this.cur_EndTime=new Date(new Date(this.cur_StartTime).setMilliseconds(tt)),this.cur_EndTime=new Date(this.cur_StartTime).getDay()<new Date(this.cur_EndTime).getDay()?new Date(new Date(this.cur_StartTime).setHours(23,59,59)):this.cur_EndTime,this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!1})):u.hasClass("e-workcells")&&this.model.orientation=="horizontal"&&this.currentView()=="month"?(this.cur_StartTime=new Date(new Date(e).setHours(0,0)),this.cur_EndTime=new Date(new Date(e).setHours(23,59)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0})):(this.cur_StartTime=new Date(new Date(e).setHours(0,0)),this.cur_EndTime=new Date(new Date(e).setHours(23,59)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0})),it=c.calendar.days.names[new Date(e).getDay()]+", "+Globalize.format(new Date(e),"MMMM")+" "+new Date(e).getDate()+", "+Globalize.format(new Date(this.cur_StartTime),this._timeMode=="12"?this._pattern.t:"HH:mm")+" - "+Globalize.format(new Date(this.cur_EndTime),this._timeMode=="12"?this._pattern.t:"HH:mm"),p={startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,target:r,resources:this.model.cellClick!=null&&!t.isNullOrUndefined(this.model.resources)?this._getResourceValue(u):null,quickString:it},this._trigger("cellClick",p)))return!1;this.model.showQuickWindow&&(this._quickAppointWindow.find("#"+this._id+"_quickAppwindow").css("display","block"),this._quickAppointWindow.find(".e-quickstartend").html(p.quickString),v=n(r).hasClass("e-workcells")||n(r).hasClass("e-alldaycells")||n(r).hasClass("e-monthcells")?n(r):n(r.target),r.type!="beforeOpen"&&!this.model.readOnly?this._quickAppointWindow.ejDialog("open"):"",this._quickAppointWindow.find(".subject").val(""),rt=v.offset().left-(this._quickAppointWindow.width()-v.width())/2+10,ut=v.offset().top-this._quickAppointWindow.height()-10,this._quickAppointWindow.ejDialog({position:{X:rt,Y:ut}}),t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._getResourceDetails(u,this._cellIndex));u.addClass("e-selectedCell").attr("tabIndex",0).focus();this._focused=n(":focus");this.model.showQuickWindow&&this._quickAppointWindow.find(".subject").focus();this._cellClick=!0;this._appointmentAddWindow.ejDialog({title:this._getLocalizedLabels("CreateAppointmentTitle")})}else if(!u.hasClass("e-resourceheadercells")&&!u.hasClass("e-appsoverflow")&&!u.hasClass("e-monthheader")&&!u.hasClass("e-categorybar")){if(this._cellClick=!1,this._quickAppDetailsWindow&&this._quickAppDetailsWindow.find("#"+this._id+"_quickAppDetailswindow").css("display","block"),this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close"),o=u.hasClass("e-appointment")||u.hasClass("e-monthappointment")||u.hasClass("e-alldayappointment")?u:u.parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),this._appUid=o.attr("guid"),u.hasClass("e-schedulemouseclose"))return!1;for(this._processed=this._sortAppById(this._processed),w=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),i=0;i<w.length;i++){f=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,w[i].Guid));break}for(i=0;i<f.length;i++)ft=this.element.find("[guid="+f[i].Guid+"]"),ft.addClass("e-selectedAppointment");this._mediaQuery&&(this._mAppId=this._appUid);var et=this._sortAppById(f),y=et[0][this.model.appointmentSettings.recurrence]?et[0]:this._getAppointmentByParentId(this._appUid),b=(new Date).getTime()-y[this.model.appointmentSettings.startTime].getTime(),k=6e4,vt=60*k,yt=24*vt,ot=Math.abs(new Date-y[this.model.appointmentSettings.startTime]),s=Math.floor(ot/36e5);if(s=s<=9?"0"+s:s,h=new Date(ot).getUTCMinutes(),h=h<=9?"0"+h:h,st=Math.ceil(b/k-1)<0&&s<24?this._getLocalizedLabels("EventBeginsin")+" "+s+" "+this._getLocalizedLabels("Hours")+" "+h+" "+this._getLocalizedLabels("Minutes"):Math.ceil(b/k-1)<0&&s>=24?this._getLocalizedLabels("EventBeginsin")+" "+Math.abs(Math.ceil(b/yt))+" "+this._getLocalizedLabels("Days"):this._getLocalizedLabels("Overdue"),ht={appointment:f[0]},this._trigger("appointmentClick",ht))return n(".e-selectedAppointment").css({border:"none"}),!1;this.model.showQuickWindow&&(this._quickAppDetailsWindow&&this._quickAppDetailsWindow.find(".e-quicksubject").html(y[this.model.appointmentSettings.subject]),d=this._timeMode=="12"?Globalize.format(f[0][this.model.appointmentSettings.startTime],this._pattern.t):Globalize.format(f[0][this.model.appointmentSettings.startTime],"HH:mm"),g=this._timeMode=="12"?Globalize.format(f[f.length-1][this.model.appointmentSettings.endTime],this._pattern.t):Globalize.format(f[f.length-1][this.model.appointmentSettings.endTime],"HH:mm"),this._quickAppDetailsWindow.find(".e-rightfields").html(st),ct=f.length>1||f[0][this.model.appointmentSettings.startTime].getDay()!=f[f.length-1][this.model.appointmentSettings.endTime].getDay()?c.calendar.days.names[f[0][this.model.appointmentSettings.startTime].getDay()]+", "+Globalize.format(f[0][this.model.appointmentSettings.startTime],"MMMM")+" "+f[0][this.model.appointmentSettings.startTime].getDate()+" - "+d+" to "+c.calendar.days.names[f[f.length-1][this.model.appointmentSettings.endTime].getDay()]+", "+Globalize.format(f[f.length-1][this.model.appointmentSettings.endTime],"MMMM")+" "+f[f.length-1][this.model.appointmentSettings.endTime].getDate()+" - "+g:c.calendar.days.names[f[0][this.model.appointmentSettings.startTime].getDay()]+", "+Globalize.format(f[0][this.model.appointmentSettings.startTime],"MMMM")+" "+f[0][this.model.appointmentSettings.startTime].getDate()+", "+d+" - "+g,this._quickAppDetailsWindow.find(".e-quickstartendtime").html(ct),y[this.model.appointmentSettings.recurrence]==1?this._quickAppDetailsWindow.find(".e-editseries").removeClass("e-disable"):this._quickAppDetailsWindow.find(".e-editseries").addClass("e-disable"),r.type!="beforeOpen"?this._quickAppDetailsWindow.ejDialog("open"):"",this.model.readOnly?this._quickAppDetailsWindow.find(".e-scheduledelete").addClass("e-disable"):this._quickAppDetailsWindow.find(".e-scheduledelete").removeClass("e-disable"),lt=n(o).width()>this.element.width()?n(o).offset().left>this.element.offset().left?n(o).offset().left:this.element.find(".e-draggableworkarea").scrollLeft()>n(o).width()?this.element.offset().left:this.element.width()/2-4:n(o).offset().left-((this._quickAppDetailsWindow.width()-n(o).width())/2-4),at=n(o).offset().top-this._quickAppDetailsWindow.height()-10,this._quickAppDetailsWindow.ejDialog({position:{X:lt,Y:at}}),this._quickAppDetailsWindow.focus());this._appointmentAddWindow.ejDialog({title:this._getLocalizedLabels("Editevent")})}n(u).hasClass("e-monthcells")||this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")}else{if((this._cellIndex=0,this.cur_StartTime=new Date(new Date(this.currentDate()).setHours(0,0)),this.cur_EndTime=new Date(new Date(this.currentDate()).setHours(23,59)),n(u).parentsUntil(".e-agendacellstab tbody").find(".e-eventcolumn,.e-timecolumn").addClass("e-selectedCell").attr("tabIndex",0).focus(),o=u.hasClass("e-agendaappointment")?u:this.element.find(".e-selectedCell").parent().find(".e-agendaappointment"),this._appUid=o.attr("guid"),this._mediaQuery&&(this._mAppId=this._appUid),u.hasClass("e-editapp")||u.hasClass("e-deleteapp"))||(o=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),this._trigger("appointmentClick",{appointment:o[0]})))return!1;this._cellClick=!1}},_checkReminders:function(){var n,t;for(this._todayAppointments=[],n=0;n<this._processed.length;n++)new Date(new Date(this._processed[n][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date((new Date).setHours(0,0,0,0)).getTime()&&this._todayAppointments.push(this._processed[n]);t=this;jQuery.each(this._todayAppointments,function(n,i){var r=t.model.reminderSettings.alertBefore,e=i[t.model.appointmentSettings.startTime],u,f;r!=-1&&r!=null&&(u=(new Date).getTime(),f=(u-new Date(e).getTime())/6e4,Math.round(f)==r*-1&&t._trigger("reminder",{reminderAppointment:i}))})},_showContextMenu:function(i){var e=!1,o=!1,s=this.model.contextMenuSettings.menuItems.cells,f,h,c,r,u,l;if(i){if(this._contextMenu=t.buildTag("ul#"+this._id+"contextMenu"),this.element.append(this._contextMenu),this._contextMenu.ejMenu({fields:{id:"id",text:"text",parentId:"parentId"},menuType:t.MenuType.ContextMenu,openOnClick:!1,contextMenuTarget:"#"+this._id,width:"auto",click:n.proxy(this._onMenuSelect,this),beforeOpen:n.proxy(this._beforeopen,this)}),this.model.categorizeSettings.enable&&this.model.contextMenuSettings.menuItems.appointment){for(f=this.model.contextMenuSettings.menuItems.appointment,h=this.model.categorizeSettings.dataSource.length,r=0;r<f.length;r++)if(f[r].id=="categorize"){c=r;o=!0;break}if(o)for(r=0;r<h;r++)u=this.model.categorizeSettings,this.model.contextMenuSettings.menuItems.appointment.push({text:u.dataSource[r][u.text],id:"categorize_"+u.dataSource[r][u.id],fontColor:u.dataSource[r][u.fontColor],color:u.dataSource[r][u.color],parentId:this.model.contextMenuSettings.menuItems.appointment[c].id.toString()})}if(this._gotoDate&&this.model.contextMenuSettings.enable){for(l in s)if(s[l].id=="gotodate"){e=!0;break}e&&(this._renderGotoWindow(),this._gotoDate=!1)}}},_beforeopen:function(i){var c,y,f,p,w,b,v,e,u,k,h;if(this.model.contextMenuSettings.enable){n(document).unbind(t.eventType.mouseMove);var r=n(i.target),l,o=null,s,a=n(r).parents(".e-draggableworkarea tr").length>0&&n(r).parentsUntil(".e-draggableworkarea tr").is(".e-agendaappointment,.e-eventcolumn,.e-timecolumn")||n(r).is(".e-agendaappointment,.e-eventcolumn,.e-timecolumn");if(r.hasClass("e-appointment")||r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells")||t.isNullOrUndefined(this.model.appointmentTemplateId)||(r=n(i.target).offsetParent()),i.cancel=r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment")||r.hasClass("e-appointment")||r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-appointinnertext")||r.hasClass("e-monthcells")||r.hasClass("e-apptime")||r.hasClass("e-apptext")||a?!1:!0,i.cancel==!0)return h=this._contextMenu.data("ejMenu"),h.hide(),!1;if(this.currentView()=="agenda"&&a&&(i=n(r).hasClass("e-agendaappointment")?i:n(r).parents(".e-draggableworkarea tr").find(".e-agendaappointment")),this._cellSelection(i),c=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"||this.currentView()=="customview"&&this._dateRender.length<=7?this.dateRender:this._dateRender,c=this.model.orientation=="horizontal"&&this.currentView()=="customview"&&this._dateRender.length<=7?this._dateRender:c,y=new Date(c[this._cellIndex]),(r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells"))&&(s={currentDate:y,cellIndex:this._cellIndex,events:i,resources:!t.isNullOrUndefined(this.model.beforeContextMenuOpen)&&!t.isNullOrUndefined(this.model.resources)?this._getResourceValue(r,this._cellIndex):null}),(r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment")||r.hasClass("e-appointinnertext")||r.hasClass("e-apptime")||r.hasClass("e-apptext")||r.hasClass("e-appointment"))&&(o=this._getAppDetails(i),s={appointment:o,events:i}),this.currentView()=="agenda"&&(o=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],s={appointment:o,events:i}),this._baseTarget=r,this._trigger("beforeContextMenuOpen",s))return!1;if(f=this._contextMenu.data("ejMenu"),l=r.hasClass("e-alldayappointment")||r.hasClass("e-monthappointment")||r.hasClass("e-appointment")||r.hasClass("e-appointinnertext")||r.hasClass("e-apptime")||r.hasClass("e-apptext")||a?!1:!0,l?f.option("fields.dataSource",this.model.contextMenuSettings.menuItems.cells):f.option("fields.dataSource",this.model.contextMenuSettings.menuItems.appointment),this.model.readOnly?(f.disableItemByID("new"),f.disableItemByID("recurrence"),f.disableItemByID("delete"),f.disableItemByID("categorize")):(f.enableItemByID("new"),f.enableItemByID("recurrence"),f.enableItemByID("delete"),f.enableItemByID("categorize")),p=this.element.find("td.e-selectedCell"),p.length>1&&this.currentView()!="agenda"&&this._multipleCellAppointCreation(i),this._target=i,this.model.showQuickWindow&&(this._quickAppointWindow.ejDialog("close"),this._quickAppDetailsWindow.ejDialog("close")),this.model.categorizeSettings.enable&&l==!1){if(w=this._contextMenu.find("li#categorize").find("li").children(),w.find("div").length==0)for(u=0;u<this.model.categorizeSettings.dataSource.length;u++)this._contextMenu.find("li#categorize").find("li#categorize_"+this.model.categorizeSettings.dataSource[u][this.model.categorizeSettings.id]).children().append('<div><div style="border: 1px solid black;height: 12px;margin-left: 2px;margin-top: 2px;width: 12px;background-color:'+this.model.categorizeSettings.dataSource[u][this.model.categorizeSettings.color]+'"><\/div><\/div>');for(u=1;u<=this.model.categorizeSettings.dataSource.length;u++)this._contextMenu.find("li#categorize").find("li#categorize_"+u).children().find("div:first-child.e-categorizeMenuSelected")&&this._contextMenu.find("li#categorize").find("li#categorize_"+u).children().find("div:first-child").removeClass("e-categorizeMenuSelected");if(b=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),v=t.DataManager(this._processed).executeLocal(b),v[0][this.model.appointmentSettings.categorize])if(e=v[0][this.model.appointmentSettings.categorize].split(","),this.model.categorizeSettings.allowMultiple){if(e[0].length>0)for(u=0;u<e.length;u++)this._contextMenu.find("li#categorize").find("li#categorize_"+e[u]).children().find("div:first-child").addClass("e-categorizeMenuSelected")}else e[0].length>0&&(k=e.length-1,this._contextMenu.find("li#categorize").find("li#categorize_"+e[k]).children().find("div:first-child").addClass("e-categorizeMenuSelected"))}else this._contextMenu.find("li#categorize")&&this._contextMenu.find("li#categorize").css("display","none")}else return h=this._contextMenu.data("ejMenu"),h.hide(),!1},_onMenuSelect:function(i){var s=i.events.ID.split("_"),f="",c=this._baseTarget,a,l,v,y,p,w,o,e,r,b,u;if(n(c).is(".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment")||c.parents(".e-appointment").hasClass("e-appointment")||c.parents(".e-monthappointment").hasClass("e-monthappointment")||c.parents(".e-alldayappointment").hasClass("e-alldayappointment")||this.currentView()=="agenda"&&this.element.find(".e-selectedCell").parent().find(".e-agendaappointment")?(a=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),l=t.DataManager(this._processed).executeLocal(a),f=l[0][this.model.appointmentSettings.recurrence]==1&&l[0][this.model.appointmentSettings.recurrenceRule].indexOf("RECUREDITID")!=-1?l[0]:this._getAppointmentByParentId(this._appUid)):f={startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,resourceInfo:this._getResourceDetails(c)},this._trigger("menuItemClick",{events:i,targetInfo:f}))return!1;switch(s[0]){case"new":this._appointmentWindow(this._target);break;case"recurrence":this._appointmentWindow(this._target);this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0});this._repeat(i={isChecked:!0});break;case"open":this._appointmentWindow(this._target);break;case"today":this._navigateClick(this.currentDate(new Date),"DateNavigation");break;case"view":t.isNullOrUndefined(s[1])||(this.currentView(s[1].toLowerCase()),this._renderCurrentView("ViewChange"));break;case"timemode":if(!t.isNullOrUndefined(s[1])){if(this.model.timeMode=this._timeMode=s[1]=="Hour12"?"12":"24",this._appointmentAddWindow.find(".startendtime").ejTimePicker({timeFormat:this._timeMode=="12"?this._pattern.t:"HH:mm"}),this.model.orientation!="horizontal"||this.currentView()==="month"||this._isCustomView()||this.currentView()==="agenda")this.currentView()==="month"||this._isCustomView()||this.currentView()==="agenda"||(p=this.currentView()=="month"?1:0,w=this.timeCellTemplate.render({timerows:this._getStartEndTime(),cols1:[1,2,3,4,5,6,7,8,9,10,11,12],viewclass:p}),this.$TimeCellTD.children().remove(),this.$TimeCellTD.append(w),this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove(),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator));else{var h=this.model.timeScale.enable?this._isCustomView()?"month":this.currentView():"month",d=Globalize.culture(this.model.locale),k=h=="day"?1:h=="week"?7:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:5;this.datesColumn=this._getHeaderAllDayCellsCount();v=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)?!0:!1;y=this.horizontalHeader.render({cols:this.datesColumn,label:this._getLocalizedLabels("Resources"),multiRes:v,view:h,timeTdCount:this._getStartEndTime(),colspan:h=="month"?1:this._getStartEndTime().length/k*2,height:h=="month"?62:59,width:this.model.width,headercellWidth:h=="day"?"100%":"55px"});this.aTR.children().remove();this.aTR.append(y);this.model.timeScale.enable&&this._borderAddRemove();this._moveScroller();this.model.highlightBusinessHours?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");this._businessHourScroller()}t.isNullOrUndefined(this.dataSource())||this._renderAppointmentAll()}break;case"businesshours":this.model.workHours.highlight=this.model.workHours.highlight?!1:!0;this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells")&&this.element.find(".e-monthcells").removeClass("e-monthcellhighlight");break;case"gotodate":this._gotoWindow.ejDialog("open");break;case"delete":this._deleteAppoint();break;case"print":this._printAppointment();break;case"categorize":if(t.isNullOrUndefined(s[1]))this.element.find(".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment").removeClass("e-selectedAppointment");else if(this.model.categorizeSettings.enable){if(o=s[1],e="",f[this.model.appointmentSettings.categorize])if(r=f[this.model.appointmentSettings.categorize].split(","),this.model.categorizeSettings.allowMultiple){if(r[0].length>0){for(u=0;u<r.length;u++)if(r[u]==o){b=!0;break}if(b==!0)for(u=0;u<r.length;u++)r[r.length-1]!=o?r[u]!=o&&(e=r.length-1!=u?e+r[u]+",":e+r[u]):r[u]!=o&&(e=r.length-2!=u?e+r[u]+",":e+r[u]);else e=f[this.model.appointmentSettings.categorize]+","+o}}else e=r[r.length-1]==o?"":o.toString();else e=o.toString();f[this.model.appointmentSettings.categorize]=e;this.element.find("[guid="+this._appUid+"]").remove();new t.DataManager(this._currentAppointmentData).update("AppTaskId",f);new t.DataManager(this._processed).update("AppTaskId",f);this._renderSingleApp(f,f);break}}},_gotoOk:function(t){if(n(t.currentTarget).hasClass("e-gotoOk")){var i=this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker("option","value"),r=this._gotoWindow.find("#"+this._id+"show").ejDropDownList("option","itemValue");this.currentDate(new Date(i));this.currentView(r.toLowerCase());this._renderCurrentView("ViewChange")}this._gotoCancel()},_gotoCancel:function(){this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker({value:new Date});this._gotoWindow.find("#"+this._id+"show").ejDropDownList({value:"Day"});this._gotoWindow.ejDialog("close")},_renderGoto:function(){this._gotoWindow.find("#"+this._id+"gotodate").ejDatePicker({buttonText:this._getLocalizedLabels("Today"),enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,cssClass:this.model.cssClass,minDate:this.model.minDate,maxDate:this.model.maxDate});this._gotoWindow.find("#"+this._id+"show").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:[{text:this._getLocalizedLabels("Day"),value:"day"},{text:this._getLocalizedLabels("Week"),value:"week"},{text:this._getLocalizedLabels("WorkWeek"),value:"workweek"},{text:this._getLocalizedLabels("Month"),value:"month"},{text:this._getLocalizedLabels("Agenda"),value:"agenda"}],width:"100%",selectedItemIndex:0,cssClass:this.model.cssClass});this._gotoWindow.find(".e-gotobutton").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"60px",cssClass:this.model.cssClass})},_renderGotoWindow:function(){this._gotoWindow=t.buildTag("div.e-gotodialog#"+this._id+"gotoWindow");var i="<div><table width='100%' cellpadding='5'><tbody><tr><td>"+this._getLocalizedLabels("Date")+":<\/td><td><input id='"+this._id+"gotodate' type='text' value='' /><\/td><\/tr><tr><td>"+this._getLocalizedLabels("Showin")+":<\/td><td><input type='text' id='"+this._id+"show' /><\/td><\/tr><\/tbody><\/table>";i+="<div class='e-floatright'><table><tr><td><div><button id='"+this._id+"gotook' type='button' class='e-gotobutton e-gotoOk'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div><button id='"+this._id+"gotocancel' type='button' class='e-gotobutton e-gotoCancel'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div><\/div>";this._on(this._gotoWindow,"click",".e-gotobutton",n.proxy(this._gotoOk,this));this._gotoWindow.append(i);this.element.append(this._gotoWindow);this._renderGoto();this._gotoWindow.ejDialog({width:300,cssClass:this.model.cssClass,showOnInit:!1,enableRTL:this.model.enableRTL,enableModal:!0,title:this._getLocalizedLabels("Gotodate"),target:"#"+this._id,enableResize:!1,allowKeyboardNavigation:!1,close:n.proxy(this._gotoCancel,this)});n("#"+this._id+"gotoWindow_wrapper").appendTo("body").addClass("e-scheduledialog").find(".e-titlebar").addClass("e-dialogheader")},_highlightCurrentTime:function(i){var f,e,s,o,a,u;if(Globalize.culture(this.model.locale),i){for(f=!1,e=0,u=0;u<this._dateRender.length;u++)if(new Date(new Date(this._dateRender[u]).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()){f=!0;e=u;break}if(s=this.element.find(".e-workcellstab tr").first().find("td"),this.currentView()==="month"||this._isCustomView())if(f)if(this.model.orientation=="vertical")for(o=Math.ceil((e+1)/7),this.model.group||(this.res1=["0"]),u=0;u<this.res1.length;u++)a=u*7+(new Date).getDate()-new Date(this._dateRender[(o-1)*7]).getDate()+(o-1)*this.res1.length*7,n(this.element.find(".e-monthcells")[Math.floor(a)]).addClass("e-monthcurrenttime");else this._renderHorizontalCurrentTime();else this.model.orientation=="vertical"?this.element.find(".e-monthcells").removeClass("e-monthcurrenttime"):this.element.find(".e-workcells").removeClass("e-monthcurrenttime");else if(f){var r=this,h=this.currentView()==="week"?7:this.currentView()==="workweek"?this.model.workWeek.length:this.currentView()=="customview"?this._dateRender.length:1,c=this.model.cellWidth?parseInt(this.model.cellWidth):this.element.find(".e-draggableworkarea")[0].offsetWidth/(h*this.res1.length);if((new Date).getHours()>=r.model.startHour&&(new Date).getHours()<=r.model.endHour)if(r.model.orientation=="vertical")for(u=0;u<this.res1.length;u++)this.element.find(".e-draggableworkarea").append('<div id="'+this._id+u+'_HighlightCurrentTimeline" class="e-highlightcurrenttimeline"><\/div>'),n("#"+this._id+u+"_HighlightCurrentTimeline").append('<div class="e-currenttime"><\/div>').append(t.buildTag("div.e-icon e-timeidicatorcircle e-lefttimeindicator")).append(t.buildTag("div.e-icon e-timeidicatorcircle e-righttimeindicator")).css("width",c+"px").css("left",s[e+h*u].offsetLeft+"px").find(".e-righttimeindicator").css("margin-left",c-3+"px");else this._renderHorizontalCurrentTime();function l(){var i=new Date,u,f,t;if(i.setMinutes(i.getMinutes()),i.getHours()>=r.model.startHour&&i.getHours()<=r.model.endHour)if(r.model.orientation=="vertical"){for(u=((i.getHours()-r.model.startHour)*60+i.getMinutes())*(r.element.find(".e-workcells").height()+1)/30,t=0;t<r.res1.length;t++)n("#"+r._id+t+"_HighlightCurrentTimeline").css("top",u-1);for(f=r._timeMode=="12"?Globalize.format(new Date,"hh:mm tt"):Globalize.format(new Date,"HH:mm"),t=0;t<r.res1.length;t++)n("#"+r._id+t+"_HighlightCurrentTimeline").find(".e-currenttime").html(f),r._timeMode=="12"&&n("#"+r._id+t+"_HighlightCurrentTimeline").find(".e-currenttime").addClass("e-timewidth")}else r._horizontalTimePosition(r,i)}l();this._intervalID=window.setInterval(l,6e4)}else clearInterval(this._intervalID),this.element.find(".e-highlightcurrenttimeline").remove()}},_filter:function(){var r=[],i=[],t;for(this._filt=!0,this._dataProcessing(this._currentAppointmentData),i=n.extend(!0,[],this._processed),this._processed.length=0,this._filt=!1,t=0;t<i.length;t++)new Date(i[t][this.model.appointmentSettings.endTime])>=this.model.minDate&&new Date(i[t][this.model.appointmentSettings.endTime])<=this.model.maxDate&&r.push(i[t]);return r},_getPreviousNextAppointment:function(){var r=this._dateRender,f,i,t,u;if(this.model.orientation=="horizontal"&&this.currentView()=="month"){for(f=[],u=0;u<this._dateRender.length;u++)new Date(this.currentDate()).getMonth()===new Date(this._dateRender[u]).getMonth()&&f.push(this._dateRender[u]);r=n.extend(!0,[],f)}if(i=this._filter(),this._previousList=[],this._nextList=[],this.appointment,this.currentView()!="workweek")for(t=0;t<i.length;t++)new Date(i[t][this.model.appointmentSettings.startTime])<new Date(r[0])&&new Date(i[t][this.model.appointmentSettings.endTime])<new Date(r[0])?this._previousList.push(i[t]):new Date(i[t][this.model.appointmentSettings.startTime])>new Date(r[r.length-1])&&new Date(i[t][this.model.appointmentSettings.endTime])>new Date(r[r.length-1])&&this._nextList.push(i[t]);else for(t=0;t<i.length;t++)for(u=0;u<r.length;u++)new Date(i[t][this.model.appointmentSettings.startTime]).getDay()==new Date(r[u]).getDay()&&(new Date(i[t][this.model.appointmentSettings.startTime])<new Date(r[0])&&new Date(i[t][this.model.appointmentSettings.endTime])<new Date(r[0])?this._previousList.push(i[t]):new Date(i[t][this.model.appointmentSettings.startTime])>new Date(r[r.length-1])&&new Date(i[t][this.model.appointmentSettings.endTime])>new Date(r[r.length-1])&&this._nextList.push(i[t]));this.appointment={previous:this._previousList,next:this._nextList}},_nextPrevAppointment:function(n){var r,f,i;if(n&&!(this._browserInfo.name==="msie"&&this._browserInfo.version<9)){r=this.element.find("#"+this._id+"_scroller");this.height=r.height();this.width=r.width();f=this.element.find(".e-vscroll").width();i=this.element.find(".e-scrolltimecells").width();i=t.isNullOrUndefined(i)?this.model.orientation=="vertical"?56:0:i;var u=this.height/2-75,e,o=t.buildTag("div.e-prevapp enable",this._getLocalizedLabels("PreviousAppointment"),{},{}),s=t.buildTag("div.e-nextapp enable",this._getLocalizedLabels("NextAppointment"),{},{});e=this.model.timeScale.enable&&this.currentView()!="agenda"?this.model.orientation=="vertical"?this.currentView()!="month"&&!this._isCustomView()?-4:-10:-61:-61;this.width=this.model.timeScale.enable&&this.currentView()!="agenda"?this.width:this.width-i;this.model.enableRTL?(o.css("top",u+40+"px").css("transform","rotate(-90deg)").css("right",e+"px"),s.css("top",u+40+"px").css("transform","rotate(90deg)").css("right",this.width-f-(this.model.orientation=="vertical"&&(this.currentView()=="month"||this._isCustomView())?41:this.model.orientation=="vertical"?34:90)+"px")):(o.css("top",u+40+"px").css("transform","rotate(90deg)").css("left",e+"px"),s.css("top",u+40+"px").css("transform","rotate(-90deg)").css("left",this.width-f-(this.model.orientation=="vertical"&&(this.currentView()=="month"||this._isCustomView())?41:this.model.orientation=="vertical"?34:90)+"px"));r.append(o).append(s)}},_nextPrev:function(t){var i=this;n(t.currentTarget).hasClass("e-prevapp")?(this.appointment.previous.sort(function(n,t){return new Date(t[i.model.appointmentSettings.startTime])-new Date(n[i.model.appointmentSettings.startTime])}),this.currentView()=="customview"&&(this._daterend=this.appointment.previous[0][this.model.appointmentSettings.startTime]),this._navigateClick(this.currentDate(new Date(this.appointment.previous[0][this.model.appointmentSettings.startTime])),"Previous")):n(t.currentTarget).hasClass("e-nextapp")&&(this.appointment.next.sort(function(n,t){return new Date(n[i.model.appointmentSettings.startTime])-new Date(t[i.model.appointmentSettings.startTime])}),this.currentView()=="customview"&&(this._daterend=this.appointment.next[0][this.model.appointmentSettings.startTime]),this._navigateClick(this.currentDate(new Date(this.appointment.next[0][this.model.appointmentSettings.startTime])),"Next"))},_nextPrevButton:function(n){n.length!=0?this.element.find(".e-prevapp,.e-nextapp").css("display","none"):(this._getPreviousNextAppointment(),this.element.find(".e-prevapp,.e-nextapp").css("display","block"),this.appointment.previous.length==0?this.element.find(".e-prevapp").removeClass("enable").css("opacity","0.4"):this.element.find(".e-prevapp").addClass("enable").css("opacity","1"),this.appointment.next.length==0?this.element.find(".e-nextapp").removeClass("enable").css("opacity","0.4"):this.element.find(".e-nextapp").addClass("enable").css("opacity","1"))},_navigateView:function(i){var e,u,o,f,c=this.currentView(),r=n(i.target),s,h;if(this.currentView()=="agenda")return!1;if(this.model.orientation=="vertical"){if(this.currentView()==="month"||this._isCustomView()){if(r.hasClass("e-monthheader")){if(this.model.views.toString().toLowerCase().split(",").indexOf("day")==-1)return!1;if(f=r.parent().index(),o=f>6?f%7:f,u=new Date(this._getRenderDates()[r.parent().parent().index()*7+o]),this.model.minDate<=u&&this.model.maxDate>=u)this.currentDate(u);else return!1;e="day"}else if(r.hasClass("e-timecells")||r.hasClass("e-timecelldivs")){if(r=r.hasClass("e-timecells")?r:r.parent(),this.model.views.toString().toLowerCase().split(",").indexOf("week")==-1)return!1;if(u=new Date(this._getRenderDates()[r.parent().index()*7]),this.model.minDate<=u&&this.model.maxDate>=u)this.currentDate(u);else return!1;e="week"}}else if(this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7){if(s=r.hasClass("e-headercells")?r:r.parent().hasClass("e-headercells")?r.parent():r.parent().parent(),this.model.views.toString().toLowerCase().split(",").indexOf("day")==-1||!s.hasClass("e-headercells"))return!1;if(f=s.index(),h=this.currentView()==="workweek"?this.model.workWeek.length:this.currentView()==="customview"?this._dateRender.length:7,o=f>h-1?f%h:f,u=new Date(this._getRenderDates()[o]),this.model.minDate<=u&&this.model.maxDate>=u)this.currentDate(new Date(u));else return!1;e="day"}this._navView=!0;c=="day"||t.isNullOrUndefined(e)||(this._viewChange(i,c,e),this._businessHourScroller())}else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._horizontalViewNavigation(i)},_appOverflowClick:function(t){if(this.model.views.toString().toLowerCase().split(",").indexOf("day")!==-1){var i=n(t.target)[0].id.toString().split("_");this.currentDate(new Date(i[3],i[1]-1,i[2]));this._navView=!0;this._viewChange(t,this.currentView(),"day")}else return!1},_viewCalendar:function(){var i=this.element.find("#"+this._id+"_navigator").data("ejDatePicker"),t;i&&(i.show(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}),t=this.element.offset(),this.model.enableRTL?n("#e-"+this._id+"_navigator").css("top",t.top+47+"px").css("left",t.left+this.element.width()-280+"px"):n("#e-"+this._id+"_navigator").css("top",t.top+47+"px").css("left",t.left+55+"px"));this.element.find(".e-workcells").removeClass("e-selectedCell");this.element.find(".e-workcells").removeClass("e-mousehover");this.element.find(".e-appointment,.e-alldayappointment,.e-monthappointment").removeClass("e-selectedAppointment")},_viewChange:function(t,i,r){this._viewchange=!0;var f=!0,u;if(u={currentView:this.currentView(),currentDate:new Date(this.currentDate()),target:t,requestType:"viewNavigate"},this._trigger("actionBegin",{data:u,requestType:"viewNavigate"}))return!1;if(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),i!==r||!i&&!r){if(i=this.currentView(),this._navView?this.currentView(r):(f=this.currentView()==t.currentTarget.className.split("e-")[2].split(" ")[0]?!1:!0,this.currentView(n(t.currentTarget).hasClass("e-activeview")?this.currentView():t.currentTarget.className.split("e-")[2].split(" ")[0])),u={previousView:i,currentView:this.currentView(),currentDate:new Date(this.currentDate()),target:t,requestType:"viewNavigate"},this._trigger("navigation",u))return this.currentView(i),this._navView=!1,!1;f&&this._renderCurrentView("ViewChange")}u={previousView:i,currentView:this.currentView(),currentDate:new Date(this.currentDate()),target:t,requestType:"viewNavigate"};this._mediaQuery&&i!=this.currentView()&&this.element.find(".e-workareadiv,.e-navigate").addClass("navigate");this._trigger("actionComplete",{data:u,requestType:"viewNavigate"})},_renderCurrentView:function(i){var u,r,e,o,f;if(this.element.find(".e-commonviewbutton").blur(),this.element.find(".e-commonviewbutton").removeClass("e-activeview"),this.model.orientation=="vertical"&&this.element.find(".e-headerdaydisplay,.e-datedisplay,.e-headrealldaytable").children().remove(),this.wTR.children().remove(),this.aTR.children().remove(),this._calculateCustomDays()._getRenderDates(),this.element.find(".e-commonviewbutton.e-"+this.currentView()).addClass("e-activeview").attr("tabIndex",0).focus(),t.isNullOrUndefined(this._scheduleDrawer)||this._navSelected||this._scheduleDrawer.ejNavigationDrawer({listViewSettings:{selectedItemIndex:this.model.views.toString().toLowerCase().split(",").indexOf(this.currentView())+1}}),this._renderHeaderAllDayTemplate(),this._renderContentAreaTemplate(),this.currentView()!="agenda"){if(this.element.find(".e-workcells").width()<this.element.find(".e-dateheadercell").width()&&this.model.orientation=="horizontal"&&this.model.cellWidth==""?this.element.find(".e-workcells").width(this.currentView()=="month"||this._isCustomView()?this.element.find(".e-horizontmonthheaderdaytd").width():this.element.find(".e-horizontaltimetd ").width()):"",this.model.orientation=="vertical"&&(this._headerbarWidth(),this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay")),this.element.find(".e-ampmdisplay").height(this.element.find(".e-workcells").height()),this.model.timeScale.enable||(this.element.find(".e-headercells").first("td").css("border-left","none"),this.element.find(".e-workcellstab").find("tr").find("td:first-child").css("border-left","none"))),this.model.timeScale.enable&&this._borderAddRemove(),this.model.enableRTL&&this.element.removeClass("e-rtl"),this._renderScroller(),this.model.enableRTL&&this.element.addClass("e-rtl"),this.model.orientation=="vertical"?this.aTR.find(".e-headeralldaydiv").parent().next().append(this.element.find(".e-vscroll").length>0?this._emptyCell():""):"",this._mediaQuery&&this.model.cellWidth&&this.currentView()=="day"&&parseInt(this.element.find(".e-headertr td").siblings("td:last-child").css("width"))>this.element.find(".e-vscroll").width()&&this.element.find(".e-headertr td").siblings("td:last-child").css("width",this.element.find(".e-vscroll").width()+"px"),this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(this._moveScroller(),this.model.timeScale.enable||this.element.find(".e-headercells").removeClass("e-dateheaderselect"),!t.isNullOrUndefined(this.model.group)))for(u=this.element.find(".e-parentnodecategory"),r=0;r<u.length;r++)e=new t.DataManager(this.res1).executeLocal((new t.Query).where("groupId",t.FilterOperators.equal,parseInt(u[r].id))),e.length==0&&(u[r].className="e-parentnode e-parentnodecategory");this._renderHeaderDays()}else this.model.showHeaderBar&&(o=this._getCurrentDateHeaderValue(),this.element.find("div.e-datedisplay")[0].innerHTML=o);t.isNullOrUndefined(this.dataSource())||(this.model.enableLoadOnDemand?this._bindAppointmentsData(i):(this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll()),this._app.length<1&&this.model.enableAppointmentNavigation&&this._nextPrevButton(this._app));this.currentView()!="agenda"&&(this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator));this._validateMinMaxDate();this._navView=!1;this._dateRender.length>60||n.isNumeric(this.element.find(".e-monthcells").height())&&this.element.find(".e-monthcells").height()!=n(this.element.find(".e-timecells")[3]).height()&&this.model.orientation=="vertical"?this.element.find("td.e-timecells .e-timecelldivs").addClass("e-timedivcells"):"";this.model.orientation=="horizontal"&&this._browserInfo.name=="webkit"&&this.element.find(".e-workcells.e-dayend").width(this.element.find(".e-workcells.e-dayend").outerWidth()+1);this.currentView()=="agenda"||this.model.orientation!="horizontal"||t.isNullOrUndefined(this.model.group)||t.isNullOrUndefined(this.model.resources)||(f=this.model.enableRTL?"border-right":"border-left",this.element.find(".e-horizontaldaterender").css(f,"0px"),this.element.find(".e-workareadiv").parent().css(f,"0px"))},_renderHeaderDays:function(){var f,r,i,e,u,o,n;for(this.dateRender=[],f=this._getRenderDates(),this.res1=t.isNullOrUndefined(this.model.group)?[0]:this.res1,n=0;n<this.res1.length;n++)for(r=0;r<f.length;r++)this.dateRender.push(new Date(f[r]));if(i=Globalize.culture(this.model.locale),this.model.showHeaderBar&&(e=this._getCurrentDateHeaderValue(),this.element.find("div.e-datedisplay")[0].innerHTML=e),this.currentDate()<this.model.minDate&&this.currentDate(this.model.minDate),this.currentDate()>this.model.maxDate&&this.currentDate(this.model.maxDate),this.model.orientation=="vertical")if(this.currentView()==="month"||this._isCustomView())this._renderMonthTimeCells();else{for(n=0;n<this.dateRender.length;n++)u=this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?i.calendar.days.names[new Date(this.dateRender[n]).getDay()]:i.calendar.days.names[new Date(this.dateRender[n]).getDay()].slice(0,3):i.calendar.days.names[new Date(this.dateRender[n]).getDay()].slice(0,3),o=this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?u+" "+Globalize.format(new Date(this.dateRender[n]),"dd MMMM yyyy"):u+" "+Globalize.format(new Date(this.dateRender[n]),"dd MMM yy"):u+" "+new Date(this.dateRender[n]).getDate(),this.element.find(".e-headerdaydisplay")[n].innerHTML=o;this._mediaQuery?(this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd,.e-schedulesettings").attr("style","height:40px !important"),this.model.enableRTL?this.element.find(".e-alldaycells").first().css("border-right","none"):this.element.find(".e-alldaycells").first().css("border-left","none")):this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd,.e-schedulesettings").css("height","27px");this.element.find(".e-headercells").addClass("e-dateheaderselect")}else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._renderHorizontalHeaderDays(i)},_renderMonthTimeCells:function(){var o=0,u=this._dateRender,e=0,f=t.isNullOrUndefined(this.model.group)?7:this.res1.length*7,s=!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources?!0:!1,h,r,i;for(f=s?this._isCustomView()&&this._oneWeek?this.res1.length*this._dateRender.length:this.res1.length*7:t.isNullOrUndefined(this.model.group)?7:this._isCustomView()&&this._oneWeek?this.res1.length*this._dateRender.length:this.res1.length*7,h=s&&this._isCustomView()&&this._oneWeek?!0:!1,r=0;r<u.length;r++){for(i=e;i<f;i=i=h?i+this._dateRender.length:i+7)n(this.element.find("div.e-monthheader"))[i].innerHTML=Globalize.format(new Date(u[r]),"dd").toString(),this.currentView()!=="customview"&&(new Date(u[r]).getMonth()!==new Date(this.currentDate()).getMonth()?n(this.element.find("div.e-monthheader")[i]).addClass("e-monthdateshighlight"):n(this.element.find("div.e-monthheader")[i]).removeClass("e-monthdateshighlight"));e++;(r+1)%7==0&&(e=f,f=f+(t.isNullOrUndefined(this.model.group)?1:this.res1.length)*7,start=Globalize.format(new Date(u[r-6]),"MMM dd"),end=Globalize.format(new Date(u[r]),"MMM dd"),this.model.timeScale.enable&&(n(this.element.find(".e-timecelldivs"))[o].innerHTML=start+"- "+end),o++)}this.element.find(".e-timecells").addClass("e-dateheaderselect").height(this.element.find(".e-monthcells").height());i!=6&&this.element.find(".e-timecells").addClass("e-timecellpadding")},_navigateClick:function(i,r){var e,u,s,l,f,h,o,c;if(this._viewchange=!0,u=r,s=new Date(this.currentDate()),e={currentView:this.currentView(),currentDate:new Date(this.currentDate()),target:i,requestType:"dateNavigate"},this._trigger("actionBegin",{data:e,requestType:"dateNavigate"}))return!1;if(t.isNullOrUndefined(i)||t.isNullOrUndefined(i.value)||(l=Globalize.parseDate(i.value,this._pattern.d),this.currentDate(l)),i!=null&&!this._setCurrentDate){if(n(i.currentTarget).hasClass("e-disable"))return!1;f=new Date(this.currentDate());h=this.currentView()==="day"||this.currentView()==="agenda"?1:this.currentView()==="customview"?this._dateRender.length:7;n(i.currentTarget).hasClass("e-navigateprevious")?(this._daterend=this._dateRender,this._isCustomView()?(o=new Date(this._dateRender[0]),weekDate=new Date(this._dateRender[0]),weekDate.setTime(o.getTime()-this._dateRender.length*864e5),this.currentDate(new Date(weekDate))):this.currentDate(this.currentView()==="month"?new Date(f.setMonth(new Date(this.currentDate()).getMonth()-1)):new Date(f.setDate(new Date(this.currentDate()).getDate()-h))),this.element.find(".e-navigateprevious").attr("tabIndex",0).focus(),u="Previous"):n(i.currentTarget).hasClass("e-navigatenext")&&(this.currentView()=="customview"?(this._daterend=this._dateRender,o=new Date(this._dateRender[0]),weekDate=new Date(this._dateRender[0]),weekDate.setTime(o.getTime()+this._dateRender.length*864e5),this.currentDate(new Date(weekDate))):this.currentDate(this.currentView()==="month"?new Date(f.setMonth(new Date(this.currentDate()).getMonth()+1)):new Date(f.setDate(new Date(this.currentDate()).getDate()+h))),this.element.find(".e-navigatenext").attr("tabIndex",0).focus(),u="Next")}if(i!=null&&(n(i.currentTarget).hasClass("e-navigateprevious")||n(i.currentTarget).hasClass("e-navigatenext")||i.type=="select")&&(e={previousDate:s,currentDate:f,currentView:this.currentView(),target:i,requestType:"dateNavigate"}),this._trigger("navigation",e))return this.currentDate(new Date(s)),!1;this.element.find(".e-workcells,.e-alldaycells,.e-monthcells").removeClass("e-selectedCell");this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment");this.element.find(".e-appsoverflow").remove();this.element.find(".e-monthcells").removeClass("e-monthcurrenttime");this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove();this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close");this.currentView()==="month"||this.currentView()==="agenda"||this._isCustomView()?(this._navigate=!0,this._renderCurrentView(u)):(this.model.timeScale.enable?this._renderHeaderDays():this._renderCurrentView(u),!this._mediaQuery&&this.model.orientation=="vertical"&&this.model.timeScale.enable&&this._reRenderScroller(),t.isNullOrUndefined(this.dataSource())||(this.model.enableLoadOnDemand?this._bindAppointmentsData(u):(this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll())),this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells"),this._highlightCurrentTime(this.model.showCurrentTimeIndicator));this._validateMinMaxDate();this._setCurrentDate=!1;this._mediaQuery&&(c=n(i.currentTarget).hasClass("e-navigateprevious")?this.element.width():n(i.currentTarget).hasClass("e-navigatenext")||i.type=="select"?-this.element.width():0,this.element.find(".e-headeralldaydiv,.e-draggableworkarea,.e-vscroll").toggle(),this.element.find(".e-headeralldaydiv,.e-draggableworkarea,.e-vscroll").css("margin-left",-c).css("margin-right",c).toggle().animate({"margin-left":0,"margin-right":0},500,this.model.orientation=="vertical"&&this.element.find(".e-vscroll").length==1&&(this._browserInfo.name=="webkit"||this._browserInfo.name=="msie")?n.proxy(this._animateScroll,this):""));this._trigger("actionComplete",{data:e,requestType:"dateNavigate"})},_animateScroll:function(){highScrol=this.element.find(".e-businesshighlightworkcells").length!=0?this.element.find(".e-businesshighlightworkcells").first().parent()[0].rowIndex*n(".e-workcells").height():0;n("#"+this._id+"_scroller").ejScroller({scrollTop:highScrol+1});this.element.find(".e-scrolltimecells").css("top",-(highScrol+1)+"px")},_validateMinMaxDate:function(){this.element.find(".e-navigateprevious").removeClass("e-disable");this.element.find(".e-navigatenext").removeClass("e-disable");var n=new Date(this.currentDate()),r=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this._dateRender,t=new Date(r[0]),i=new Date(r[r.length-1]);this.currentView()=="workweek"&&(t=new Date(t.setDate(t.getDate()-1)),i=new Date(i.setDate(i.getDate()+1)));n=t;n<=this.model.minDate?this.element.find(".e-navigateprevious").addClass("e-disable"):this.element.find(".e-navigateprevious").removeClass("e-disable");n=i;n>=this.model.maxDate?this.element.find(".e-navigatenext").addClass("e-disable"):this.element.find(".e-navigatenext").removeClass("e-disable")},_onScheduleResize:function(){var o,u,i,s,l,r,e;if(t.isNullOrUndefined(this._scheduleDrawer)||this._scheduleDrawer.ejNavigationDrawer("close"),o=this._mediaQuery,u=typeof innerWidth=="number"&&window.innerWidth>document.documentElement.clientWidth,this._mediaQuery=this._browserInfo.name=="msie"&&parseInt(this._browserInfo.version,10)<=8?!1:(document.documentElement.clientWidth+(u?17:0)<361||t.isMobile())&&this.model.isResponsive,this._mediaQuery?this.element.addClass("e-scheduleresponsive"):this.element.removeClass("e-scheduleresponsive"),i=this.element.find(".e-scroller").data("ejScroller"),this.currentView()!="agenda"){s=this.element.find(".e-vscroll").width();this.element.find(".e-nextapp").css("left",this.element.width()-s-90+"px");this.model.enableRTL&&this.element.find(".e-nextapp").css("left","-45px");this.model.enableRTL&&this.element.find(".e-prevapp").css("left",this.element.width()-this.element.find(".e-scrolltimecells").width()-89+"px");var h=this.currentView()=="workweek"?this.model.workWeek.length:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,f=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1.length*h:h,a=parseInt(this.model.cellWidth)*f,c=this.model.orientation==="vertical"?(u&&this._mediaQuery?this.element.outerWidth()+17:this.element.outerWidth())-(this._mediaQuery&&this.currentView()=="month"?"":this.element.find(".e-scrolltimecells").parent().outerWidth()):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.element.width()-this.element.find(".e-resourceheadertable").width():this.element.width();i.model.width=c-2;i.model.height=this.scHeight-1-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top);i.refresh();this.model.orientation=="vertical"?(this.model.cellWidth&&!this._mediaQuery&&this.element.find(".e-draggableworkarea").width(this.element.width()>(parseInt(this.model.cellWidth)+1)*f+this.element.find(".e-scrolltimecells").parent().width()+(i.isVScroll()?18:0)?(parseInt(this.model.cellWidth)+1)*f-1:c-2-(i.isVScroll()?18:0)),this.model.timeScale.enable?this._mediaQuery&&this.res1.length>1&&this.model.group.resources.length==1&&this.element.find(".e-draggableworkarea").width(this.element.find(".e-draggableworkarea").width()*this.res1.length-1):(this.element.find(".e-draggableworkarea").css("height",this.model.cellHeight!="20px"?parseInt(this.model.cellHeight):i.model.height-1+"px"),this.element.find(".e-draggableworkarea").height(t.isNullOrUndefined(this.element.find(".e-hscroll"))?this.element.find(".e-draggableworkarea").height():this.element.find(".e-draggableworkarea").height()-this.element.find(".e-hscroll").height())),this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width()),this.element.find(".e-datecommondiv").parent().width(this.element.width()-2),this.element.find(".e-headrealldaytable").css("left",-this.element.find(".e-draggableworkarea").scrollLeft()+"px")):n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-i.model.scrollLeft+"px");this.currentView()=="month"||this._isCustomView()||this.model.orientation!="vertical"?this._renderCurrentView("ScheduleResize"):this.model.enableRTL&&(this.model.cellWidth||this.model.cellHeight!="20px")?this._renderCurrentView("ScheduleResize"):(this.model.showAllDayRow&&this.element.find("div.e-alldayappointment").remove()&&this._renderAllDayAppointments(),this.model.timeScale.enable||(this.element.find("div.e-monthappointment").remove(),this._renderMonthAppointment()),this._unWireResizeEvents(),this._wireResizeEvents(),this._dragdropAppointments());this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width());this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove();this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px");this._highlightCurrentTime(this.model.showCurrentTimeIndicator)}else i.model.width=this.element.width()-2,i.model.height=this.scHeight-1-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),i.refresh(),l=n("div#"+this._id+"_scroller"),this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width()),this.element.find(".e-datecommondiv").parent().width(this.element.width()-2),l.ejScroller("isVScroll")?this.element.find(".e-emptytd").show()&&this.element.find(".e-draggableworkarea").height(this.element.find(".e-draggableworkarea").height()+1):this.element.find(".e-emptytd").hide();(this._mediaQuery||this.element.width()<600)&&!n("#"+this._id+"navDrawer").hasClass("e-scheduledrawer")&&this._renderNavigationDrawer();r=this._mediaQuery==o?!1:!0;this._mediaQuery&&this.element.find(".e-vscroll").css("left",this.model.enableRTL?0:this.element.outerWidth()-18);!r&&(this.element.width()<600&&this.hTD.find(".e-mobileNavigation").length<1||this.element.width()>600&&this.hTD.find("table.e-viewstable").length<1)&&(this._reRenderHeaderBar(),this._on(this.element,"click","#"+this._id+"navDrawerIcon",n.proxy(this._drawerOpen,this)));r&&(this.model.enableAppointmentNavigation=r&&!this._mediaQuery,this.model.enableAppointmentNavigation?this._nextPrevAppointment(this.model.enableAppointmentNavigation):this.element.find(".e-prevapp,.e-nextapp").remove(),this.model.showHeaderBar&&this._reRenderHeaderBar(),this.element.find(".e-leftindenttable").width(this.element.find(".e-workleftindent").width()),this.element.find(".e-ampmdisplay").height(this.element.find(".e-workcells").height()),this._businessHourScroller(),this._mediaQuery&&(this.model.showQuickWindow=!1),this.model.showQuickWindow&&(this._renderQuickAppWindow()||this._renderQuickAppDetailsView()),this._destorySubControls(n("#"+this._id+"_AddEditForm")),this._destorySubControls(n("#"+this._id+"_RecurForm")),n("#"+this._id+"AppointmentAddEditWindow_wrapper").remove(),this._alertWindow.ejDialog("close"),this._recurEditWindow.ejDialog("close"),this._renderAppointmentWindow(),this._mediaQuery&&this._phoneChanges(),this._renderAppointmentAll(),this._mediaQuery?(this._off(this.element,t.eventType.mouseDown,"td.e-workcells,td.e-monthcells,td.e-alldaycells"),this._off(this.element,"keydown click","td.e-workcells,td.e-monthcells,td.e-alldaycells"),this._on(this.element,"click","#"+this._id+"navDrawerIcon",n.proxy(this._drawerOpen,this))):(this._on(this.element,t.eventType.mouseDown,"td.e-workcells,td.e-monthcells,td.e-alldaycells",n.proxy(this._mouseButtonClick,this)),this._on(this.element,"keydown click","td.e-workcells,td.e-monthcells,td.e-alldaycells",n.proxy(this._shiftSelection,this)),this.element.width()>600&&this._off(this.element,"click","#"+this._id+"navDrawerIcon")),this._on(this.element,t.isMobile()?"click":"dblclick",".e-workcells,.e-alldaycells,.e-alldayappointment,.e-monthcells",n.proxy(this._appointmentWindow,this)),this._mediaQuery||t.isMobile()?this._on(this.element,"tap",".e-appointment,.e-alldayappointment,div.e-monthappointment,.e-agendaappointment",n.proxy(this._appointmentWindow,this)):this._off(this.element,"tap",".e-appointment,.e-alldayappointment,div.e-monthappointment,.e-agendaappointment"),e=n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"RecurrenceEdit_wrapper,#"+this._id+"navDrawer,#"+this._id+"alertWindow_wrapper"),this._mediaQuery?e.addClass("e-scheduleresponsive"):e.removeClass("e-scheduleresponsive"));(this._mediaQuery||this.element.width()<600)&&this.element.find(".e-mobileNavigation").css("left",this.model.enableRTL?18:this.element.outerWidth()-36)},_reRenderHeaderBar:function(){var t=this.element.find(".e-scheduleheader");t.empty();this._renderHeaderBar(t);this.element.find("#"+this._id+"_navigator").ejDatePicker({enableRTL:this.model.enableRTL,buttonText:this._getLocalizedLabels("Today"),select:n.proxy(this._onselect,this),locale:this.model.locale,cssClass:this.model.cssClass,minDate:this.model.minDate,maxDate:this.model.maxDate});this.element.find(".e-datecommondiv").find(".e-datewidget").css("display","none");this.element.find(".e-commonviewbutton.e-"+this.currentView()).addClass("e-activeview")},_renderTemplates:function(){this.model.orientation=="vertical"&&(this.workcellTemp=n.templates(this._createTemplate(c(),"_WorkCells")),this.monthcellTemp=n.templates(this._createTemplate(u(),"_MonthCells")),this.timeCellTemplate=n.templates(this._createTemplate(l(),"_TimeCells")),this.userTimeCellTemplate=n.templates(this._createTemplate(a(),"_userTimeCells")),this.headTemplate=n.templates(this._createTemplate(o(),"_HeaderDate")),this.alldayTemp=n.templates(this._createTemplate(h(),"_AlldayCells")),this.leftIndent=n.templates(this._createTemplate(s(),"_LeftIndentCells")));t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._renderResourcesTemplate();this.agendaheadTemplate=n.templates(this._createTemplate(v(),"_HeaderDate"));this.agendacellTemp=n.templates(this._createTemplate(y(),"_AgendaCells"));this.appTemplate=n.templates(this._createTemplate(f(),"_Appointment"));t.scheduleFeatures.horizontal&&this.model.orientation==="horizontal"&&this._renderHorizontalTemplates();!t.isNullOrUndefined(this.model.categorizeSettings)&&this.model.categorizeSettings.enable&&(this._renderCategorizeTemplate(),this._categorizeMultipleTemplate=n.templates(this._createTemplate(e(),"_CategorizeMultiple")))},_setNewStartEndHours:function(){this.currentView()==="month"||this._isCustomView()||(this.wTR.children().remove(),this._renderContentAreaTemplate(),this._borderAddRemove(),this._renderScroller(),this.element.find(".e-ampmdisplay").height(this.element.find(".e-workcells").height()),this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").addClass("e-businesshighlightworkcells"),this.model.showCurrentTimeIndicator&&this.element.find(".e-highlightcurrenttimeline").remove(),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this._renderAppointmentAll())},_renderInitSchedule:function(){var s,i,f,u,r,l,e,o;this.model.timeScale.enable||(this.model.showAllDayRow=!1,this.model.showCurrentTimeIndicator=!1);s=typeof innerWidth=="number"&&window.innerWidth>document.documentElement.clientWidth;this._mediaQuery=this._browserInfo.name=="msie"&&parseInt(this._browserInfo.version,10)<=8?!1:(document.documentElement.clientWidth+(s?17:0)<361||t.isMobile())&&this.model.isResponsive;this._mediaQuery?this.element.addClass("e-scheduleresponsive"):this.element.removeClass("e-scheduleresponsive");this._mediaQuery&&(this.model.showQuickWindow=!1);i=Globalize.culture(this.model.locale);f=i.calendar;t.isNullOrUndefined(this._clientWidth)&&(this._clientWidth=this.model.width);this.currentView(this.currentView().toLowerCase());this.model.views=this.model.views.toString().toLowerCase().split(",");this.model.workWeek=this.model.workWeek==""||this.model.workWeek==null?this._dayNamesArray:this.model.workWeek;this._timeMode=this.model.timeMode==null?f.AM==null&&f.PM==null?"24":"12":this.model.timeMode;this.model.timeMode==null?this._pattern=i.calendar.patterns:this._pattern.t=this._timeMode=="12"?"h:mm tt":"HH:mm";this._firstdayofweek=this.model.firstDayOfWeek!=null?typeof this.model.firstDayOfWeek=="string"?this._dayNamesArray.indexOf(this.model.firstDayOfWeek.toString().toLowerCase()):i.calendar.firstDay:this.model.firstDayOfWeek;this.model.firstDayOfWeek==null&&(this._firstdayofweek=i.calendar.firstDay);this._firstdayofweek=this.model.firstDayOfWeek==null?i.calendar.firstDay:this._firstdayofweek;this.model.workWeek=this.model.workWeek.toString().toLowerCase().split(",");this.model.width=this.model.width?this.element.width(this._clientWidth).width():this.element.width();this.model.height=this.model.height?this.element.height(this.model.height).height():this.element.height();this.scWidth=this._scWidth?parseInt(this._scWidth):parseInt(this.model.width);this.scHeight=this._scHeight?parseInt(this._scHeight):parseInt(this.model.height);this.currentDate()<this.model.minDate&&this.currentDate(this.model.minDate);this.currentDate()>this.model.maxDate&&this.currentDate(this.model.maxDate);this.element.addClass("e-scheduleouter").height(this.model.height).width(this._clientWidth).attr("role","presentation");n(this.element).attr("tabIndex",1);var h=t.buildTag("div.e-scheduleinner","",{},{height:this.scHeight,width:this.scWidth}).css("height",this.scHeight-2+"px").css("position","relative"),a=t.buildTag("table.e-table","",{},{cellpadding:"0px",cellspacing:"0px"}).addClass("e-scheduleoutertable"),v=t.buildTag("tbody"),c=t.buildTag("tr.e-scheduleheader");if(this.aTR=t.buildTag("tr.e-headerarearow"),this.model.views.toString().toLowerCase().split(",").indexOf(this.currentView())==-1&&this.currentView(this.model.views[0].toLowerCase()),this._calculateCustomDays()._getRenderDates(),this.wTR=t.buildTag("tr.e-contentarearow"),this._renderTemplates(),this.model.showHeaderBar&&this._renderHeaderBar(c),this._renderHeaderAllDayTemplate(),this._renderContentAreaTemplate(),h.append(a.append(v.append(c).append(this.aTR).append(this.wTR))),this.element.append(h),this.model.showHeaderBar||this.element.find(".e-scheduleheader").hide(),this.model.showHeaderBar&&(this.element.find(".e-commonviewbutton.e-"+this.currentView()).addClass("e-activeview"),this.element.find("#"+this._id+"_navigator").ejDatePicker({startDay:this._firstdayofweek,enableRTL:this.model.enableRTL,buttonText:this._getLocalizedLabels("Today"),select:n.proxy(this._onselect,this),locale:this.model.locale,cssClass:this.model.cssClass,minDate:this.model.minDate,maxDate:this.model.maxDate}),this.element.find("span.e-datewidget").css("display","none")),this.currentView()!="agenda"){if(this.model.orientation=="vertical"&&(this._headerbarWidth(),(this.currentView()==="month"||this._isCustomView())&&this._renderMonthTimeCells(),this.model.timeScale.enable||(this.element.find(".e-headercells").first("td").css("border-left","none"),this.element.find(".e-workcellstab").find("tr").find("td:first-child").css("border-left","none")),!this.model.showAllDayRow&&this.model.cellWidth&&this.element.find(".e-workcellstab tr td:first-child").width(this.element.find(".e-headercells").width())),this.model.enableRTL&&this.element.addClass("e-rtl"),this.model.timeScale.enable&&this._borderAddRemove(),this.model.enableRTL&&this.element.removeClass("e-rtl"),this.element.find(".e-headercells").addClass("e-dateheaderselect"),this.element.find(".e-schedulesettings").html(this._getLocalizedLabels("AllDay")),this.element.find(".e-workcells").width()<this.element.find(".e-dateheadercell").width()&&this.model.orientation=="horizontal"&&this.model.cellWidth==""?this.element.find(".e-workcells").width(this.currentView()=="month"||this._isCustomView()?this.element.find(".e-horizontmonthheaderdaytd").width():this.element.find(".e-horizontaltimetd ").width()):"",this._renderScroller(),this.model.orientation=="vertical"?this.aTR.find(".e-headeralldaydiv").parent().next().append(this.element.find(".e-vscroll").length>0?this._emptyCell():""):"",this._mediaQuery&&this.model.cellWidth&&this.currentView()=="day"&&parseInt(this.element.find(".e-headertr td").siblings("td:last-child").css("width"))>this.element.find(".e-vscroll").width()&&this.element.find(".e-headertr td").siblings("td:last-child").css("width",this.element.find(".e-vscroll").width()+"px"),this.currentView()=="month"||this._isCustomView()?this.element.find(".e-timecells").height(n(this.element.find(".e-monthcells")).height()):this.element.find(".e-ampmdisplay").height(n(this.element.find(".e-workcells")).height()),this._highlightCurrentTime(this.model.showCurrentTimeIndicator),this.model.enableRTL&&this.element.addClass("e-rtl"),this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(this._moveScroller(),this.model.timeScale.enable||this.element.find(".e-headercells").removeClass("e-dateheaderselect"),!t.isNullOrUndefined(this.model.group)))for(u=this.element.find(".e-parentnodecategory"),r=0;r<u.length;r++)l=new t.DataManager(this.res1).executeLocal((new t.Query).where("groupId",t.FilterOperators.equal,parseInt(u[r].id))),l.length==0&&(u[r].className="e-parentnode e-parentnodecategory");this.model.workHours.highlight?this._highlightBusinessHours():this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");this._dateRender.length>60||n.isNumeric(this.element.find(".e-monthcells").height())&&this.element.find(".e-monthcells").height()!=n(this.element.find(".e-timecells")[3]).height()&&this.model.orientation=="vertical"?this.element.find("td.e-timecells .e-timecelldivs").addClass("e-timedivcells"):""}this._validateMinMaxDate();this._renderAppointmentWindow();(this._mediaQuery||this.element.width()<600)&&this._renderNavigationDrawer();this._renderRecurEditWindow();this.model.showQuickWindow&&(this._renderQuickAppWindow()||this._renderQuickAppDetailsView());this._showContextMenu(this.model.contextMenuSettings.enable);this.model.enableRecurrenceValidation&&this._renderAlertWindow();e=n("#"+this._id+"AppointmentAddEditWindow_wrapper,#"+this._id+"RecurrenceEdit_wrapper,#"+this._id+"navDrawer,#"+this._id+"alertWindow_wrapper");this._mediaQuery?e.addClass("e-scheduleresponsive"):e.removeClass("e-scheduleresponsive");this.model.orientation=="horizontal"&&this._browserInfo.name=="webkit"&&this.element.find(".e-workcells.e-dayend").width(this.element.find(".e-workcells.e-dayend").outerWidth()+1);this.currentView()=="agenda"||this.model.orientation!="horizontal"||t.isNullOrUndefined(this.model.group)||t.isNullOrUndefined(this.model.resources)||(o=this.model.enableRTL?"border-right":"border-left",this.element.find(".e-horizontaldaterender").css(o,"0px"),this.element.find(".e-workareadiv").parent().css(o,"0px"));this._mediaQuery&&this._phoneChanges();this.model.enableRTL&&t.browserInfo().name=="webkit"&&this._appointmentAddWindow.find(".e-chk-image").css("margin-right","-13px")},_borderAddRemove:function(){this.model.enableRTL?(this.element.find(".e-headrealldaytable tr td:first-child,.e-workcellstab tr td:first-child,.e-headerdays table tr td:first-child").css("border-right","none"),this.element.find(".e-horizontalheader,.e-horizontalrestd,.e-monthleftindent,.e-workleftindent,.e-empty").addClass("e-borderleft")):(this.element.find(".e-headrealldaytable tr td:first-child,.e-workcellstab tr td:first-child,.e-headerdays table tr td:first-child").css("border-left","none"),this.element.find(".e-horizontalheader,.e-horizontalrestd,.e-monthleftindent,.e-workleftindent,.e-empty").addClass("e-borderright"));this.model.orientation=="horizontal"?this.currentView()=="month"?this._browserInfo.name!="webkit"||this.model.cellWidth==""?this.element.find(".e-headerdays table tr td:first-child").width(this.element.find(".e-workcellstab tr td:first-child").width()):this.element.find(".e-workcellstab tr td:not(:first-child)").width(this.element.find(".e-horizontmonthheaderdaytd").first().width()+1):this._browserInfo.name=="webkit"&&this.element.find(".e-workcellstab tr td:first-child").width(this.element.find(".e-horizontaltimetd").first().width()):(this.model.cellWidth!=""&&this.element.find(".e-workcellstab tr td:first-child").width(this.element.find(".e-headercells").first().width()),this._browserInfo.name=="webkit"&&(this.currentView()=="month"?this.element.find(".e-monthleftindent").width(this.element.find(".e-monthempty").width()+1):this.element.find(".e-workleftindent").attr("style","width:"+(this.element.find(".e-empty").width()+1)+"px !important")))},_phoneChanges:function(){this._appointmentAddWindow.ejDialog({allowDraggable:!1,position:{X:"0",Y:"0"}})},_dateConvert:function(i){if(t.isNullOrUndefined(i))r=null;else{var r=new Date(parseInt(i.match(/\d+/).toString()));r=n.type(r)=="date"?r:new Date}return r},_calculateCustomDays:function(){var i,r;if(!t.isNullOrUndefined(this.model.renderDates)&&this.currentView()=="customview"&&!this._navigate&&(i=n.type(this.model.renderDates.start)!="date"?Globalize.parseDate(this.model.renderDates.start,this._datepattern()):new Date(this.model.renderDates.start),i=t.isNullOrUndefined(i)?new Date(this.model.renderDates.start).toString()=="Invalid Date"||new Date(this.model.renderDates.start).toString()=="NaN"?this._dateConvert(this.model.renderDates.start):new Date(this.model.renderDates.start):i,r=n.type(this.model.renderDates.end)!="date"?Globalize.parseDate(this.model.renderDates.end,this._datepattern()):new Date(this.model.renderDates.end),r=t.isNullOrUndefined(r)?new Date(this.model.renderDates.end).toString()=="Invalid Date"||new Date(this.model.renderDates.end).toString()=="NaN"?this._dateConvert(this.model.renderDates.end):new Date(this.model.renderDates.end):r,t.isNullOrUndefined(this.model.minDate)||t.isNullOrUndefined(this.model.maxDate)||(i=this.model.minDate>=i&&this.model.maxDate<=i?i:this.model.minDate>=i&&this.model.maxDate>=i?this.model.minDate:this.model.maxDate<=i?this.model.minDate:i,r=this.model.minDate>=r&&this.model.maxDate<=r?r:this.model.minDate<=r&&this.model.maxDate<=r?this.model.maxDate:this.model.minDate>=r?this.model.maxDate:r),this._renderStart=t.isNullOrUndefined(i)?r:new Date(i.getFullYear(),i.getMonth(),i.getDate()),this._renderEnd=t.isNullOrUndefined(r)?i:new Date(r.getFullYear(),r.getMonth(),r.getDate()),this._renderStart.getTime()<this.currentDate().getTime()&&this.currentDate().getTime()<this._renderEnd.getTime()&&Math.round((this.model.renderDates.end-this.model.renderDates.start)/864e5)+1<=7?this.currentDate(new Date(this.currentDate())):this.currentDate(new Date(this._renderStart)),this._renderDays=Math.round((this._renderEnd-this._renderStart)/864e5)+1,this._renderDays>7)){var e=this.model.orientation=="vertical"?new Date(this._firstweekdate(this._renderStart)):new Date(this._renderStart),u=new Date(this._renderEnd),f=u.getDay();this._firstdayofweek==0&&f!=6?u.setDate(new Date(this._renderEnd).getDate()+(6-f)):u.setDate(new Date(this._renderEnd).getDate()+(6-f)+this._firstdayofweek);u=this.model.orientation=="vertical"?u:new Date(this._renderEnd);this._numDays=Math.round((u-e)/864e5)+1}return this},_isCustomView:function(){if(this.currentView()=="customview"&&this._dateRender.length>7)return this._oneWeek=this._dateRender.length>7?!1:!0,!0;this.currentView()=="customview"&&(this._oneWeek=this._dateRender.length>7?!1:!0)},_headerbarWidth:function(){var i=this.currentView()=="workweek"?this.model.workWeek.length:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,n=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1.length*i:i,r=this.element.outerWidth()-(this.element.find(".e-draggableworkarea").offset().left-this.element.offset().left)<parseInt(this.model.cellWidth)*n?1:0;this._browserInfo.name=="webkit"?this.element.find(".e-headrealldaytable").width(this.model.cellWidth?parseInt(this.model.cellWidth)*n+(r?0:n):"100%"):this.element.find(".e-headrealldaytable").width(this.model.cellWidth?parseInt(this.model.cellWidth)*n+n:"100%")},_renderScroller:function(){var r=n("div#"+this._id+"_scroller"),f=this.scHeight-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),i=this,o=this.currentView()==="month"?0:4,e=this.model.orientation==="vertical"?this.element.width()-(this._mediaQuery&&this.currentView()=="month"?"":this.element.find(".e-scrolltimecells").parent().outerWidth()):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.element.width()-this.element.find(".e-resourceheadertable").width():this.element.width(),u;r.ejScroller({enableRTL:this.model.enableRTL,height:f-1,width:e-2,cssClass:this.model.cssClass,thumbStart:function(t){var r=n(t.originalEvent.target);if(!i._mediaQuery&&r.hasClass("e-workcells")||r.parents(".e-appointment").hasClass("e-appointment")||r.parents(".e-monthappointment").hasClass("e-monthappointment")||r.hasClass("e-categorybar"))return!1},scroll:function(r){var e=n("div#"+i._id+"_scroller").data("ejScroller"),u,f;(e.isVScroll()||e.isHScroll())&&(i.model.orientation==="vertical"?i.element.find(".e-scrolltimecells").css("top",-r.scrollTop+"px"):i.currentView()!=="month"&&!i._isCustomView()?n(i.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-r.scrollLeft+"px"):i.element.find(".e-headerdays").css("left",-r.scrollLeft+"px"),i.element.find(".e-vhandle").length==1&&i.element.find(".e-horires").css("top",-r.scrollTop+"px"),i.model.orientation=="vertical"?(i.element.find(".e-headrealldaytable").css("left",-r.scrollLeft+"px"),i._timeMode!=="12"||i.currentView()==="month"||i._isCustomView()||(u=r.scrollTop/(i.element.find(".e-workcells").height()*i.model.timeScale.minorSlotCount),u=Math.round(u)<u?Math.round(u)+1:Math.round(u),f=Globalize.culture(i.model.locale).calendar,f.AM&&f.PM&&i.element.find(".e-idAmpmstyle").each(function(t,i){t==u?parseInt(n(i)[0].id)<12?n(i).text(f.AM[0]):n(i).text(f.PM[0]):(n(i).text()==f.AM[0]&&t>0||n(i).text()==f.PM[0]&&parseInt(n(i)[0].id)>12)&&n(i).text("00")}))):t.scheduleFeatures.horizontal&&i.model.orientation=="horizontal"&&i._horizontalScroll(r,i));i.model.showQuickWindow&&i._quickAppointWindow.ejDialog("close")&&i._quickAppDetailsWindow.ejDialog("close")}});this._mediaQuery||this._nextPrevAppointment(this.model.enableAppointmentNavigation);this._renderHoriVerticalScroll();this.element.find(".e-vscroll").css("left",this.model.enableRTL?0:this.element.outerWidth()-(r.ejScroller("isVScroll")?18:0));this.element.find(".e-mobileNavigation").css("left",this.model.enableRTL?r.ejScroller("isVScroll")?18:0:this.element.outerWidth()-36);this.model.orientation=="horizontal"&&this.element.find(".e-vscroll").length>0&&(this.element.find(".e-scheduleheader td").first().attr("colspan","3"),this.element.find(".e-workareadiv").parent().attr("colspan","2"),u=this.element.find(".e-horizontaldaterender").parent(),n(u).append(t.buildTag("td","",{},{width:this.currentView()=="month"||this._isCustomView()?"18px":this._mediaQuery?"0px":"18px"}).append(this._emptyCell())))},_renderHoriVerticalScroll:function(){var i=n("div#"+this._id+"_scroller"),v=this.currentView()==="month"?0:4,u=this.model.orientation==="vertical"?this.element.width()-(this._mediaQuery&&this.currentView()=="month"?"":this.element.find(".e-scrolltimecells").parent().outerWidth()):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.element.width()-this.element.find(".e-resourceheadertable").width():this.element.width(),a,h,s,r;u=u-1;var e=this.scHeight-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),c=this.currentView()=="workweek"?this.model.workWeek.length:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,y=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1.length*c:c;if(this.model.orientation=="vertical")if(i.ejScroller("isVScroll")?this.element.find(".e-emptytd,.e-emptyalldaytd").show():this.element.find(".e-emptytd,.e-emptyalldaytd").hide(),this.model.cellWidth||this.model.cellHeight!="20px"){this.currentView()=="day"&&this.element.find(".e-headerdaydisplay").css("width",this.model.cellWidth);var p=this._dateRender.length/7,o=(parseInt(this.model.cellWidth)+1)*y,l=parseInt(this.model.cellHeight)*p,w=this.scWidth-this.element.find(".e-scrolltimecells").width()+v,f=e;this.currentView()=="month"||this._isCustomView()?(this.element.find(".e-draggableworkarea").width(this.element.width()>o+this.element.find(".e-scrolltimecells").width()+18?o-1:i.ejScroller("isVScroll")?u-19:u-1),this.model.cellHeight!="20px"?this.element.find(".e-draggableworkarea").height(f>l?l:i.ejScroller("isHScroll")?f-19:f-1):this.element.find(".e-draggableworkarea").height(i.ejScroller("isHScroll")?f-19:f-1),this.element.find(".e-emptytd").show()):(this.element.find(".e-draggableworkarea").width(this.element.width()>o+this.element.find(".e-scrolltimecells").width()+(i.ejScroller("isVScroll")?18:0)?o-1:u-1-(i.ejScroller("isVScroll")?18:0)),this.model.timeScale.enable||(this.model.cellHeight=="20px"?this.element.find(".e-draggableworkarea").height(i.ejScroller("isHScroll")?f-1-(i.ejScroller("isHScroll")?18:0):f-1):this.element.find(".e-draggableworkarea").height(parseInt(this.model.cellHeight))));this.model.cellWidth&&this.element.find(".e-datecommondiv").parent().width(this.element.width()-2);this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width())}else this.element.find(".e-draggableworkarea").height(e-1),i.ejScroller("isVScroll")&&!this._mediaQuery?this.element.find(".e-draggableworkarea").width(u-1-(i.ejScroller("isVScroll")?18:0)):this.currentView()=="month"||this._isCustomView()||!this.model.timeScale.enable?(this.element.find(".e-draggableworkarea").width(u-1),this.element.find(".e-draggableworkarea").height(e)):this._mediaQuery&&this.res1.length>1&&this.element.find(".e-draggableworkarea").width(this.element.find(".e-draggableworkarea").width()*this.res1.length),this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width()),this.element.find(".e-scrolltimecells").height(this.element.find(".e-draggableworkarea").height());else{if(i.ejScroller("isHScroll")?"":this.element.find(".e-draggableworkarea").css("height","100%")&&this.element.find(".e-resfootertr").css("height","0px"),!i.ejScroller("isVScroll")&&!i.ejScroller("isHScroll")?"":i.ejScroller("isVScroll")?"":this.element.find(".e-draggableworkarea").css("height",e-19),this.currentView()!="month"||i.ejScroller("isHScroll")||i.ejScroller("isVScroll")?this.model.timeScale.enable&&this.currentView()=="customview"&&this._dateRender.length>7&&(this.element.find(".e-headercells").width(this.element.find(".e-workcells").width()),this.element.find(".e-horizontmonthheaderdaytd").width(this.element.find(".e-workcells").width())):this.element.find(".e-draggableworkarea").css("height","100%"),this.element.find(".e-horizontresdiv").height(this.element.find(".e-draggableworkarea").height()),this.model.cellWidth||this.model.cellHeight!="20px")a=n(this.element.find(".e-workcells")[0]).parent().find("td").length,i.ejScroller("isHScroll")?"":this.element.find(".e-draggableworkarea").width(parseInt(this.model.cellWidth)*a),this.currentView()=="month"&&this.element.find(".e-headerdays").children().css("width",this.element.find(".e-draggableworkarea").children().width()+"px"),this.model.cellHeight=="20px"||this.model.resources||this.element.find(".e-draggableworkarea").height(parseInt(this.model.cellHeight)-1);else if(!i.ejScroller("isHScroll"))if(this.element.find(".e-horizontaltabletimecell").width(this.element.find(".e-workcellstab").width()),this.element.find(".e-horizontmonthheaderdaytd").length==0)for(s=this.element.find(".e-horizontaltimetd"),h=this.element.find(".e-horizontalalternatetd"),r=0;r<this.element.find(".e-childworkcell").length/2;r++)n(s[r]).width(n(this.element.find(".e-workcells")[r*2]).width()),this.element.find(".e-childworkcell").length==r*2+2?n(h[r]).width(n(this.element.find(".e-workcells")[r*2+1]).width()-2):n(h[r]).width(n(this.element.find(".e-workcells")[r*2+1]).width());else for(s=this.element.find(".e-horizontmonthheaderdaytd"),r=0;r<n(this.element.find(".e-workcellstab").find("tr")[0]).find(".e-workcells").length-1;r++)n(s[r]).width(n(this.element.find(".e-workcells")[r]).width());this.model.timeScale.enable||this.currentView()=="month"||this._isCustomView()||(this.model.cellWidth||this._browserInfo.name=="webkit"?this._browserInfo.name=="webkit"&&this.currentView()!="month"?(this.model.cellWidth&&this.element.find(".e-headerdays").width(this.model.cellWidth),this.element.find(".e-workcells").width(this.element.find(".e-draggableworkarea").width/this._dateRender.length),this.element.find(".e-dateheadercell").width(this.element.find(".e-workcells").width()),this.element.find(".e-headerdays table tr td:not(:first-child)").find(".e-dateheadercell").width(this.element.find(".e-workcells").width()-1),this.element.find(".e-workcells").width(this.element.find(".e-workcells").width())):this.element.find(".e-headerdays").width(this.model.cellWidth):(this.element.find(".e-dateheadercell").width(this.element.find(".e-workcells").width()),this.element.find(".e-workcells").width(this.element.find(".e-workcells").width())))}},_highlightBusinessHours:function(){var o,f,u,s,i,r;if(this.currentView()=="agenda")return!1;if(this.currentView()!=="month"&&!this._isCustomView()&&this.model.timeScale.enable){this.element.find(".e-workcells").removeClass("e-businesshighlightworkcells");var l=this.dateRender,u=this.element.find(".e-workcells"),h=this.model.workHours.start>=this.model.startHour?this.model.workHours.start-this.model.startHour:0,c=this.model.workHours.end<=this.model.endHour?this.model.workHours.end-this.model.startHour:this.model.endHour-this.model.startHour,e=60/this.model.timeScale.majorSlot*this.model.timeScale.minorSlotCount;if(this.res1=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1:[0],o=this.currentView()==="week"?7*this.res1.length:this.currentView()==="workweek"?this.model.workWeek.length*this.res1.length:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length*this.res1.length:1*this.res1.length,this.model.orientation=="vertical"){for(i=h*e;i<c*e;i++)for(r=0;r<o;r++)for(f=0;f<this.model.workWeek.length;f++)this._dayNamesArray.indexOf(this.model.workWeek[f])==new Date(l[r]).getDay()&&n(u[i*o+r]).addClass("e-businesshighlightworkcells");this._businessHourScroller()}else this._horizontalBusinessHighlight(this._dateRender,h,c,e,u)}else if(this.model.orientation=="vertical")for(s=this.dateRender,u=this.element.find(".e-monthcells"),u.removeClass("e-monthcellhighlight"),i=0;i<s.length;i++)for(r=0;r<this.model.workWeek.length;r++)this._dayNamesArray.indexOf(this.model.workWeek[r])==new Date(s[i]).getDay()&&n(u[i]).addClass("e-monthcellhighlight");else this._horizontalBusinessHighlight(null,null,null,null,null)},_onselect:function(n){this._navigateClick(n,"DateNavigation")},_renderHeaderBar:function(n){var f=this.model.orientation=="vertical"?1:2,i,r,u;this.hTD=t.buildTag("td","",{},{colspan:f});i=t.buildTag("div.e-datecommondiv").append(t.buildTag("div.e-icon e-navigateprevious","",{},{title:this._getLocalizedLabels("Previous")})).append(t.buildTag("div","",{},{"aria-live":"assertive",tabindex:0}).html(this._getCurrentDateHeaderValue()).addClass("e-datedisplay")).append(t.buildTag("input#"+this._id+"_navigator").css("display","none").addClass("dateCalendar")).append(t.buildTag("div.e-icon e-navigatenext","",{},{title:this._getLocalizedLabels("Next")}));this._mediaQuery||this.element.width()<600?(this._mediaQuery&&(i=t.buildTag("div.e-datecommondiv").append(t.buildTag("div.e-icon e-navigateprevious","",{},{title:this._getLocalizedLabels("Previous")})).append(t.buildTag("div.e-icon e-navigatenext","",{},{title:this._getLocalizedLabels("Next")}).css("margin-left","5px")).append(t.buildTag("div","",{},{"aria-live":"assertive",tabindex:0}).html(this._getCurrentDateHeaderValue()).addClass("e-datedisplay").css("font-size","18px")).append(t.buildTag("input#"+this._id+"_navigator").css("display","none").addClass("dateCalendar"))),r=t.buildTag("div#"+this._id+"navDrawerIcon.e-mobileNavigation e-icon"),n.append(this.hTD.append(t.buildTag("div").css("width","100%").append(i).append(r)))):(u=t.buildTag("div.e-viewsdiv"),n.append(this.hTD.append(t.buildTag("div").css("width","100%").append(i).append(u.append(this._renderViewNavigation(this.model.views))))))},_renderViewNavigation:function(n){for(var e=t.buildTag("table.e-table e-viewstable","",{},{cellspacing:"0px",cellpadding:"0px"}),o=t.buildTag("tbody"),u=t.buildTag("tr"),r=n,f,i=0;i<r.length;i++){f=r.length==1?"e-"+r[i].toLowerCase()+" e-singleview":i==0?"e-"+r[i].toLowerCase()+" e-firstview":i==r.length-1?"e-"+r[i].toLowerCase()+" e-lastview":"e-"+r[i].toLowerCase();switch(r[i]){case"day":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("Day"),{},{}).addClass("e-commonviewbutton").addClass(f)));break;case"week":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("Week"),{},{}).addClass("e-commonviewbutton").addClass(f)));break;case"workweek":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("WorkWeek"),{},{}).addClass("e-commonviewbutton").addClass(f)));break;case"month":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("Month"),{},{}).addClass("e-commonviewbutton").addClass(f)));break;case"customview":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("CustomView"),{},{}).addClass("e-commonviewbutton").addClass(f)));break;case"agenda":u.append(t.buildTag("td").append(t.buildTag("div",this._getLocalizedLabels("Agenda"),{},{}).addClass("e-commonviewbutton").addClass(f)))}}return e.append(o.append(u)),e},_emptyCell:function(){var i,r=n("div#"+this._id+"_scroller"),u="",f;if(!t.isNullOrUndefined(this.model.group))for(f=0;f<this.model.group.resources.length-1;f++)u=u+"<tr><td class='e-emptytd e-headerresourcecells' style='height: 27px'><\/td><\/tr>";return this.currentView()=="month"||this._isCustomView()||this.model.orientation!="vertical"?(this.currentView()=="month"||this._isCustomView())&&r.ejScroller("isVScroll")&&this.model.orientation=="vertical"?i=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?u+"<tr><td class='e-emptytd e-headerresourcecells' style='height: 27px'><\/td><\/tr>":"<tr><td class='e-emptytd' style='height:29px'><\/td><\/tr>":this.model.orientation=="horizontal"&&r.ejScroller("isVScroll")&&(this.currentView()=="month"&&r.ejScroller("isVScroll")&&(i+="<tr><td class='e-emptytd e-headerresourcecells' style='height:30px'><\/td><\/tr>",i+="<tr><td class='e-emptytd' style='height:29px'><\/td><\/tr>"),this.currentView()!="month"&&r.ejScroller("isVScroll")&&(i+="<tr><td class='e-emptytd e-headerresourcecells' style='height:30px'><\/td><\/tr>",i+="<tr><td class='e-emptytd' style='height:25px'><\/td><\/tr>"),i+="<\/tbody><\/table>"):(i="<table class='e-table' cellspacing='0' cellpadding='0'><tbody>",t.isNullOrUndefined(this.model.group)||t.isNullOrUndefined(this.model.resources)||(i+="<tr><td class='e-emptytd e-headerresourcecells' style='height: 27px'><\/td><\/tr>"),!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1&&(i+=u),i+="<tr><td class='e-emptytd' style='height:29px'><\/td><\/tr>",this.model.showAllDayRow&&(i+="<tr><td class='e-emptyalldaytd' style='height:27px'><\/td><\/tr>"),i+="<\/tbody><\/table>"),i},_recurrenceWindow:function(){var a=["Daily","Weekly","Monthly","Yearly","EveryWeekDay"],p=Globalize.culture(this.model.locale),v=this._dayShortNames,i=this._dayFullNames,r=this._monthNames,u=["First","Second","Third","Fourth","Last"],y=this.model.enableRTL?"margin-right":"margin-left",n,f,t,e,o,s,h,c,l;if(this._mediaQuery){for(n="<div class='e-recurwindow e-windowmargin' style='display:none'><form id='"+this._id+"_RecurForm'><table class='e-table' width='100%' cellpadding='7'><tbody>",n+="<tr><td width='16%' class='e-textlabel'>"+this._getLocalizedLabels("Recurrence")+":<\/td><td><input class='recurtype' id='recurtype' type='text' name='RecurrenceType' value='"+this._getLocalizedLabels(a[0])+"' /><div id='recurtypelist'><ul>",f=0;f<a.length;f++)n+="<li>"+this._getLocalizedLabels(a[f])+"<\/li>";for(n+="<\/ul><\/div><\/td><\/tr>",n+="<tr id='"+this._id+"repeatEvery'><td class='e-textlabel'>"+this._getLocalizedLabels("Every")+":<\/td><td class='e-tdpadding'><table><tr><td><div class='e-floatleft'><input id='recurevery' class='e-recurevery' type='text' /><\/div><\/td><td><div id='"+this._id+"recurtypes' class='e-appcheckbox'>"+this._getLocalizedLabels("RecurrenceDay")+"<\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"weeklyrecur' class='"+this._id+"weeklyrecur' style='display:none'><td colspan='2' id='recurweek' class='e-textlabel'><div>"+this._getLocalizedLabels("RepeatOn")+":<\/div><\/td><\/tr><tr class='"+this._id+"weeklyrecur'><td colspan='2' id='recurweekcount'><table class='e-table' cellpadding='3'><tr>",t=0;t<v.length;t++)n+="<td><div class='e-weekday e-_"+v[t]+"'><input id='"+this._id+"_"+this._dayNames[t]+"' class='weekdays e-weekly"+this._dayNames[t]+"'name='weekdays' type='checkbox'/><label class='e-textmargin' for='"+this._id+"_"+this._dayNames[t]+"'>"+v[t]+"<\/label><\/div><\/td>";for(n+="<\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"monthlyrecur' class='"+this._id+"monthlyrecur' style='display:none'><td colspan='2' id='recurmonthtext' class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("RepeatBy")+":<\/div><\/td><\/tr><tr class='"+this._id+"monthlyrecur'><td colspan='2' id='recurmonthcount'><table class='e-table' cellpadding='3'><tr><td><div><input id='"+this._id+"monthday' class='e-monthdaytype' name='monthday' type='radio'/><label class='e-textmargin' for='"+this._id+"monthday'>"+this._getLocalizedLabels("Day")+"<\/label><\/div><\/td><td><div><input id='monthdate' class='e-monthdate' type='text'/><\/div><\/td><\/tr><tr><td><div><input id='"+this._id+"monthon' class='e-monthposition' name='monthday' type='radio'/><label class='e-textmargin' for='"+this._id+"monthon'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div><input id='monthsrt' class='monthsrt' type='text' name='monthsrt' value=''/><div id='monthsrtlist'><ul>",e=0;e<u.length;e++)n+="<li>"+this._getLocalizedLabels(u[e])+"<\/li>";for(n+="<\/div><\/div><\/td>",n+="<td><div class='e-appcheckbox'><input id='monthsrtday' class='e-monthsrtday' type='text' name='monthsrtday' value=''/><div id='monthsrtdaylist'><ul>",o=0;o<i.length;o++)n+="<li>"+i[o]+"<\/li>";for(n+="<\/div><\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"yearlyrecur' class='"+this._id+"yearlyrecur' style='display:none'><td colspan='2' id='recuryeartext' class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("RepeatBy")+":<\/div><\/td><\/tr><tr class='"+this._id+"yearlyrecur'><td colspan='2' id='recuryearcount' ><table class='e-table' cellpadding='3'><tr><td><div><input id='"+this._id+"yearday' class='e-yearrecurday' name='yearday' type='radio'/><label class='e-textmargin' for='"+this._id+"yearday'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div class='e-controlalign'><input id='yearmonth' class='yearmonth' type='text' name='yearmonth' value=''/><\/div><\/td><div id='yearmonthlist'><ul>",s=0;s<r.length-1;s++)n+="<li>"+r[s]+"<\/li>";for(n+="<\/ul><\/div><td><input id='yeardate' class='yeardate' text='text'/><\/td><\/tr><tr><td><div><input id='"+this._id+"yearother' class='e-yearrecurposi' name='yearday' type='radio'/><label class='e-textmargin' for='"+this._id+"yearother'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div><input id='yearsrt' class='yearsrt' type='text' name='yearsrt' value=''/><div id='yearsrtlist'><ul>",h=0;h<u.length;h++)n+="<li>"+this._getLocalizedLabels(u[h])+"<\/li>";for(n+="<\/ul><\/div><\/div><\/td><td><div class='e-controlalign'><input id='yearsrtday' class='yearsrtday' type='text' name='yearsrtday' value=''/><div id='yearsrtdaylist'><ul>",c=0;c<i.length;c++)n+="<li>"+i[c]+"<\/li>";for(n+="<\/ul><\/div><\/div><\/td><td><div><span>"+this._getLocalizedLabels("OfEvery").split(" ")[0]+"<\/span><\/div><\/td><\/tr><tr><td><\/td><td><div><input id='yearsrtmonth' class='yearsrtmonth' type='text' name='yearsrtmonth' value=''/><div id='yearsrtmonthlist'><ul>",l=0;l<r.length-1;l++)n+="<li>"+r[l]+"<\/li>";return n+="<\/ul><\/div><\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr><td colspan='2' class='e-textlabel'>"+this._getLocalizedLabels("StartsOn")+":<\/td><\/tr><tr><td colspan='2'><input id='recurstartdate' class='recurstartdate' type='text' name='RecurStartDate' value=''/><\/td><\/tr>",n+="<tr><td colspan='2' class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("Ends")+":<\/div><\/td><\/tr><tr><td colspan='2'><table class='e-table' cellpadding='3'><tr><td><div><input id='repeatendnever' class='recurends e-recurnoend' type='radio' name='repeatend' value='Never'/><label class='e-textmargin' for='repeatendnever'>"+this._getLocalizedLabels("Never")+"<\/label><\/div><\/td><\/tr><tr><td><div><input id='"+this._id+"repeatendafter' class='recurends e-recurafter' type='radio' name='repeatend'/><label class='e-textmargin' for='"+this._id+"repeatendafter'>"+this._getLocalizedLabels("After")+"<\/label><\/div><\/td><td><div><input id='dailyoccurance' class='e-recurcount' type='text'/><\/div><\/td><td><span style='"+y+": -80px;'>"+this._getLocalizedLabels("Occurence")+"<\/span><\/td><\/tr><td><div><input id='"+this._id+"repeatendon' class='recurends e-recuruntil' type='radio' name='repeatend'/><label class='e-textmargin' for='"+this._id+"repeatendon'>"+this._getLocalizedLabels("On")+"<\/label><\/div><\/td><td><input id='daily' class='e-until' type='text' name='daily' value=''/><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr style='display:none'><td><span class='e-textlabel'>"+this._getLocalizedLabels("Summary")+":<\/span><\/td><td><span class=e-recurRule><\/span><\/td><\/tr><\/tbody><\/table><\/form>",n+("<div class='e-floatright'><table class='e-table' cellpadding='5'><tr><td><div class='e-btnmargin e-floatleft'><button id='donerecur' class='recurbutton'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div class='e-btnmargin e-floatleft'><button id='cancelrecur' class='e-cancelrecur recurbutton'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/tabled><\/div><\/div>")}for(n="<div class='e-recurwindow e-windowmargin' style='display:none'><form id='"+this._id+"_RecurForm'><table class='e-table' width='100%' cellpadding='7'><tbody>",n+="<tr><td width='16%' class='e-textlabel'>"+this._getLocalizedLabels("Recurrence")+":<\/td><td><input class='recurtype' id='recurtype' type='text' name='RecurrenceType' value='"+this._getLocalizedLabels(a[0])+"' /><div id='recurtypelist'><ul>",f=0;f<a.length;f++)n+="<li>"+this._getLocalizedLabels(a[f])+"<\/li>";for(n+="<\/ul><\/div><\/td><\/tr>",n+="<tr id='"+this._id+"repeatEvery'><td class='e-textlabel'>"+this._getLocalizedLabels("Every")+":<\/td><td class='e-tdpadding'><table><tr><td><div class='e-floatleft'><input id='recurevery' class='e-recurevery' type='text' /><\/div><\/td><td><div id='"+this._id+"recurtypes' class='e-appcheckbox'>"+this._getLocalizedLabels("RecurrenceDay")+"<\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"weeklyrecur' class='"+this._id+"weeklyrecur' style='display:none'><td id='recurweek' class='e-textlabel'><div>"+this._getLocalizedLabels("RepeatOn")+":<\/div><\/td><td id='recurweekcount'><table class='e-table' cellpadding='3'><tr>",t=0;t<v.length;t++)n+="<td><div class='e-weekday e-_"+v[t]+"'><input id='"+this._id+"_"+this._dayNames[t]+"' class='weekdays e-weekly"+this._dayNames[t]+"'name='weekdays' type='checkbox'/><label class='e-textmargin' for='"+this._id+"_"+this._dayNames[t]+"'>"+v[t]+"<\/label><\/div><\/td>";for(n+="<\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"monthlyrecur' class='"+this._id+"monthlyrecur' style='display:none'><td id='recurmonthtext' class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("RepeatBy")+":<\/div><\/td><td id='recurmonthcount'><table class='e-table' cellpadding='3'><tr><td><div><input id='"+this._id+"monthday' class='e-monthdaytype' name='monthday' type='radio'/><label class='e-textmargin' for='"+this._id+"monthday'>"+this._getLocalizedLabels("Day")+"<\/label><\/div><\/td><td><div><input id='monthdate' class='e-monthdate' type='text'/><\/div><\/td><\/tr><tr><td><div><input id='"+this._id+"monthon' class='e-monthposition' name='monthday' type='radio'/><label class='e-textmargin' for='"+this._id+"monthon'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div><input id='monthsrt' class='monthsrt' type='text' name='monthsrt' value=''/><div id='monthsrtlist'><ul>",e=0;e<u.length;e++)n+="<li>"+this._getLocalizedLabels(u[e])+"<\/li>";for(n+="<\/div><\/div><\/td>",n+="<td><div class='e-appcheckbox'><input id='monthsrtday' class='e-monthsrtday' type='text' name='monthsrtday' value=''/><div id='monthsrtdaylist'><ul>",o=0;o<i.length;o++)n+="<li>"+i[o]+"<\/li>";for(n+="<\/div><\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr id='"+this._id+"yearlyrecur' class='"+this._id+"yearlyrecur' style='display:none'><td id='recuryeartext' class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("RepeatBy")+":<\/div><\/td><td id='recuryearcount' ><table class='e-table' cellpadding='3'><tr><td><div><input id='"+this._id+"yearday' class='e-yearrecurday' name='yearday' type='radio'/><label class='e-textmargin' for='"+this._id+"yearday'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div class='e-controlalign'><input id='yearmonth' class='yearmonth' type='text' name='yearmonth' value=''/><\/div><\/td><div id='yearmonthlist'><ul>",s=0;s<r.length-1;s++)n+="<li>"+r[s]+"<\/li>";for(n+="<\/ul><\/div><td><input id='yeardate' class='yeardate' text='text'/><\/td><\/tr><tr><td><div><input id='"+this._id+"yearother' class='e-yearrecurposi' name='yearday' type='radio'/><label class='e-textmargin' for='"+this._id+"yearother'>"+this._getLocalizedLabels("The")+"<\/label><\/div><\/td><td><div><input id='yearsrt' class='yearsrt' type='text' name='yearsrt' value=''/><div id='yearsrtlist'><ul>",h=0;h<u.length;h++)n+="<li>"+this._getLocalizedLabels(u[h])+"<\/li>";for(n+="<\/ul><\/div><\/div><\/td><td><div class='e-controlalign'><input id='yearsrtday' class='yearsrtday' type='text' name='yearsrtday' value=''/><div id='yearsrtdaylist'><ul>",c=0;c<i.length;c++)n+="<li>"+i[c]+"<\/li>";for(n+="<\/ul><\/div><\/div><\/td><td><div><span>"+this._getLocalizedLabels("OfEvery").split(" ")[0]+"<\/span><\/div><\/td><td><div><input id='yearsrtmonth' class='yearsrtmonth' type='text' name='yearsrtmonth' value=''/><div id='yearsrtmonthlist'><ul>",l=0;l<r.length-1;l++)n+="<li>"+r[l]+"<\/li>";return n+="<\/ul><\/div><\/div><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr><td class='e-textlabel'>"+this._getLocalizedLabels("StartsOn")+":<\/td><td><input id='recurstartdate' class='recurstartdate' type='text' name='RecurStartDate' value=''/><\/td><\/tr>",n+="<tr><td class='e-recurendslabel'><div class='e-recurendsalign'>"+this._getLocalizedLabels("Ends")+":<\/div><\/td><td><table class='e-table' cellpadding='3'><tr><td><div><input id='repeatendnever' class='recurends e-recurnoend' type='radio' name='repeatend' value='Never'/><label class='e-textmargin' for='repeatendnever'>"+this._getLocalizedLabels("Never")+"<\/label><\/div><\/td><\/tr><tr><td><div><input id='"+this._id+"repeatendafter' class='recurends e-recurafter' type='radio' name='repeatend'/><label class='e-textmargin' for='"+this._id+"repeatendafter'>"+this._getLocalizedLabels("After")+"<\/label><\/div><\/td><td><div><input id='dailyoccurance' class='e-recurcount' type='text'/><\/div><\/td><td><span style='"+y+": -80px;'>"+this._getLocalizedLabels("Occurence")+"<\/span><\/td><\/tr><td><div><input id='"+this._id+"repeatendon' class='recurends e-recuruntil' type='radio' name='repeatend'/><label class='e-textmargin' for='"+this._id+"repeatendon'>"+this._getLocalizedLabels("On")+"<\/label><\/div><\/td><td><input id='daily' class='e-until' type='text' name='daily' value=''/><\/td><\/tr><\/table><\/td><\/tr>",n+="<tr style='display:none'><td><span class='e-textlabel'>"+this._getLocalizedLabels("Summary")+":<\/span><\/td><td><span class=e-recurRule><\/span><\/td><\/tr><\/tbody><\/table><\/form>",n+("<div class='e-floatright'><table class='e-table' cellpadding='5'><tr><td><div class='e-btnmargin e-floatleft'><button id='donerecur' class='recurbutton'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div class='e-btnmargin e-floatleft'><button id='cancelrecur' class='e-cancelrecur recurbutton'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/tabled><\/div><\/div>")},_renderNavigationDrawer:function(){var r,i;if(t.isNullOrUndefined(this._scheduleDrawer)){for(this._scheduleDrawer=t.buildTag("div#"+this._id+"navDrawer.navDrawerMenu e-scheduledrawer"),r="<ul><li data-ej-imageClass='e-icon e-mAddEvent' data-ej-text='"+this._getLocalizedLabels("AddEvent")+"' id='addEvent'><\/li>",i=0;i<this.model.views.length;i++)switch(this.model.views[i]){case"day":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("Day")+"' id='"+this.model.views[i]+"'><\/li>";break;case"week":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("Week")+"' id='"+this.model.views[i]+"'><\/li>";break;case"workweek":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("WorkWeek")+"' id='"+this.model.views[i]+"'><\/li>";break;case"month":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("Month")+"' id='"+this.model.views[i]+"'><\/li>";break;case"customview":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("CustomView")+"' id='"+this.model.views[i]+"'><\/li>";break;case"agenda":r+="<li data-ej-imageClass='e-icon e-m"+this.model.views[i]+" e-"+this.model.views[i]+"' data-ej-text='"+this._getLocalizedLabels("Agenda")+"' id='"+this.model.views[i]+"'><\/li>"}r+="<\/ul>";this._scheduleDrawer.append(r);this.element.find(".e-scheduleinner").append(this._scheduleDrawer);this._navDrawer=!0;this._scheduleDrawer.ejNavigationDrawer({type:"overlay",targetId:this._id+"navDrawerIcon",direction:this.model.enableRTL?"left":"right",enableListView:!0,listViewSettings:{persistSelection:!0,selectedItemIndex:this.model.views.toString().toLowerCase().split(",").indexOf(this.currentView())+1,width:100,height:"auto",mouseUp:n.proxy(this._slideMenuClick,this)},position:"normal"});this.model.enableRTL&&this._scheduleDrawer.parent().css("left","0px");this._navDrawer=!1}},_slideMenuClick:function(t){var r,u,o,f,i,e;if(this._navDrawer)return!1;if(this._scheduleDrawer.ejNavigationDrawer("close"),r=t.item.find("div").hasClass("e-day")?"day":t.item.find("div").hasClass("e-week")?"week":t.item.find("div").hasClass("e-workweek")?"workweek":t.item.find("div").hasClass("e-month")?"month":t.item.find("div").hasClass("e-customview")?"customview":t.item.find("div").hasClass("e-agenda")?"agenda":"open",r!="open")this._navView=this._navSelected=!0,this.currentView()!=r&&this._viewChange(null,this.currentView(),r),this._navSelected=!1;else if(this.currentView()!="agenda"){for(u=new Date(this.currentDate()),f=0,u=new Date(u.setHours(0,0,0,0)),i=0;i<this.dateRender.length;i++)if(new Date(this.dateRender[i]).getTime()==u.getTime()){f=i;break}e=(new Date).getHours();e=this.model.startHour+e*2;o=this.currentView()!="month"&&this.currentView()!="customview"&&this.model.timeScale.enable?this.element.find(".e-draggableworkarea tr")[e].cells[f]:this.element.find(".e-monthcells")[f];n(o).addClass(".e-selectedCell").trigger(n.Event("click"));this._appointmentWindow({target:o})}},_renderAlertWindow:function(){this._alertWindow=t.buildTag("div.e-alertdialog#"+this._id+"alertWindow");var i="<div><div class='e-alerttext'><\/div><div class='e-alertbtn'><button id='"+this._id+"alertok' type='button' class='e-alertbutton e-alertOk'>"+this._getLocalizedLabels("Ok")+"<\/button><\/div><\/div>";this._alertWindow.append(i);this.element.append(this._alertWindow);this._alertWindow.find(".e-alertbutton").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._alertClose,this),cssClass:this.model.cssClass});this._alertWindow.ejDialog({width:this._mediaQuery?"75%":450,cssClass:this.model.cssClass,showOnInit:!1,enableRTL:this.model.enableRTL,enableModal:!0,title:this._getLocalizedLabels("RecurrenceAlert"),target:"#"+this._id,enableResize:!1,allowKeyboardNavigation:!1,close:n.proxy(this._alertClose,this)});n("#"+this._id+"alertWindow_wrapper").addClass("e-scheduledialog").find(".e-titlebar").addClass("e-dialogheader")},_alertClose:function(t){this._alertWindow.find(".e-alerttext").html("");t.type=="click"&&t.model.text==this._getLocalizedLabels("Ok")&&this._alertWindow.find(".e-alertCancel").length!=0&&this._deletingAppointment();n("#"+this._id+"alertcancel").length!=0&&n("#"+this._id+"alertcancel").remove();this._alertWindow.ejDialog("close")},_renderAppointmentWindow:function(){var i,r;this._mediaQuery?(this._appointmentAddWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppointmentAddEditWindow"),i="<div class='e-appwindow e-windowmargin'><form id='"+this._id+"_AddEditForm'><table class='e-table' width='100%' cellpadding='7'><tbody>",i+="<tr><td colspan='3' class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("AppointmentSubject")+":<\/td><\/tr><tr><td colspan='3' class='e-rightfields'><input id='"+this._id+"subject' tabIndex='0' class='subject e-inputtext' name='"+this.model.appointmentSettings.subject+"' type='text' /><input id='id' class='id' type='text' name='"+this.model.appointmentSettings.id+"' value='' style='display: none'/><\/td><\/tr>",this.model.showLocationField&&(i+="<tr><td colspan='3' class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Location")+":<\/td><\/tr><tr><td colspan='3' class='e-rightfields'><input id='"+this._id+"location' tabIndex='0' class='location e-inputtext' name='"+this.model.appointmentSettings.location+"' type='text' /><\/td><\/tr>"),i+="<tr><td class='e-textlabel' colspan='3'>"+this._getLocalizedLabels("StartTime")+":<\/td><\/tr><tr><td width='37%'><input id='"+this._id+"startdate' class='startenddate' type='text' name='StartDate' value='' /><\/td><td width=31%'><input type='text' id='"+this._id+"starttime' class='startendtime' name='StartTime'/><\/td><td width='31%'><input id='"+this._id+"startTimeZone' class='startutc'  name='"+this.model.appointmentSettings.startTimeZone+"' type='text' value=''/><div id='Timezoneliststr'><\/div><\/td><\/tr>",i+="<tr><td class='e-textlabel' colspan='3'>"+this._getLocalizedLabels("EndTime")+":<\/td><\/tr><tr><td><input id='"+this._id+"enddate' class='startenddate' type='text' name='EndDate' value='' /><\/td><td><input type=''text' id='"+this._id+"endtime' class='startendtime' name='EndTime'/><\/td><td><input  id='"+this._id+"endTimeZone' class='endutc' name='"+this.model.appointmentSettings.endTimeZone+"' type='text' value=''/><div id='Timezonelistend'><\/div><\/td><\/tr>",this.model.prioritySettings.enable&&(i+="<tr><td class='e-leftfields e-textlabel' colspan='3'>"+this._getLocalizedLabels("Priority")+":<\/td><\/tr><tr><td colspan='3' class='e-rightfields'><input id= '"+this._id+"_priority' class='priority' type='text' name='"+this.model.appointmentSettings.priority+"' value=''/><div id='prioritylist'><\/div><\/td><\/tr>"),i+="<tr><td colspan='3'><table class='e-table' cellpadding='3'><tr><td><div class='e-allday e-checkboxmargin'><input id='"+this._id+"allday' tabIndex='0' class='allday' type='checkbox' name='"+this.model.appointmentSettings.allDay+"'/><\/div><\/td><td><div class='e-alldaytext'><label for='"+this._id+"allday'>"+this._getLocalizedLabels("AllDay")+"<\/label><\/div><\/td><td><div class='e-checkboxmargin e-recurrence'><input id='"+this._id+"recurrence' tabIndex='0' class='recurrence' type='checkbox' name='"+this.model.appointmentSettings.recurrence+"' value='recurrence'/><\/div><\/td><td><label class='e-repeatlbl' for='"+this._id+"recurrence'>"+this._getLocalizedLabels("Recurrence")+"<\/label><\/td><\/tr><\/table><\/td><\/tr>",i+="<tr id='"+this._id+"summary' class='"+this._id+"summary' style='display:none'><td class='e-textlabel'><label>"+this._getLocalizedLabels("Summary")+":<\/label><\/td><\/tr><tr class='"+this._id+"summary' style='display:none'><td colspan='4'><table><tr><td><label class='e-recurFinalRule'><\/label><\/td><td><div class='e-recuredit'><a class='e-recuredit' href='#'>"+this._getLocalizedLabels("Edit")+"<\/a><span class='e-icon e-scheduleedit'><\/span><\/div><\/td><\/tr><\/table><\/td><\/tr>",this.model.categorizeSettings.enable&&(i+="<tr id='"+this._id+"categorize'><td class='e-leftfields e-textlabel' colspan='3'>"+this._getLocalizedLabels("Categorize")+":<\/td><\/tr><tr><td colspan='3' class='e-rightfields'><input id= '"+this._id+"_categorize' class='e-categorizevalue' type='text' value=''/><div id='ownerlist'><\/div><\/td><\/tr>"),!t.isNullOrUndefined(this.model.resources)&&this.model.resources.length>0&&t.scheduleFeatures.resources&&(i=this._renderResourceElements(i)),i+="<tr><td colspan='3'><b>Description:<\/b><\/td><\/tr><tr><td colspan='3'><textarea class='e-description e-inputtext' id='description' name='"+this.model.appointmentSettings.description+"'><\/textarea><\/td><\/tr>",i+="<\/tbody><\/table><\/form>",i+="<div class='e-floatright' style='width:100%'><table width='100%' class='e-table' cellpadding='5'><tr><td width='30%'><div class='e-btnmargin e-floatleft'><button id='mDelete' class='e-btndelete e-appdelete'>"+this._getLocalizedLabels("Delete")+"<\/button><\/div><\/td><td width='30%'><div class='e-btnmargin e-floatleft'><button id='done' class='e-btndone e-appsave'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td width='30%'><div class='e-btnmargin e-floatleft'><button id='cancel' class='e-appointcancel cancel'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div><\/div>",this._appointmentAddWindow.append(i).append(this._recurrenceWindow())):(this._appointmentAddWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppointmentAddEditWindow"),i="<div class='e-appwindow e-windowmargin'><form id='"+this._id+"_AddEditForm'><table class='e-table' width='100%' cellpadding='7'><tbody>",i+="<tr  id='"+this._id+"subjecttr' class='"+this._id+"subjecttr'><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("AppointmentSubject")+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"subject' tabIndex='0' class='subject e-inputtext' name='"+this.model.appointmentSettings.subject+"' type='text' /><input id='id' class='id' type='text' name='"+this.model.appointmentSettings.id+"' value='' style='display: none'/><\/td><\/tr>",this.model.showLocationField&&(i+="<tr id='"+this._id+"showLocation' class='"+this._id+"showLocation'><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Location")+":<\/td><td colspan='3' class='e-rightfields'><input id='"+this._id+"location' tabIndex='0' class='location e-inputtext' name='"+this.model.appointmentSettings.location+"' type='text' /><\/td><\/tr>"),i+="<tr><td class='e-textlabel'>"+this._getLocalizedLabels("StartTime")+":<\/td><td width='25%'><input id='"+this._id+"startdate' class='startenddate' type='text' name='StartDate' value='' /><\/td><td width=22%'><input type='text' id='"+this._id+"starttime' class='startendtime' name='StartTime'/><\/td><td width='28%'><input  id='"+this._id+"startTimeZone'  class='startutc'  name='"+this.model.appointmentSettings.startTimeZone+"' type='text' value=''/><div id='Timezoneliststr'><\/div><\/td><\/tr>",i+="<tr><td class='e-textlabel'>"+this._getLocalizedLabels("EndTime")+":<\/td><td><input id='"+this._id+"enddate' class='startenddate' type='text' name='EndDate' value='' /><\/td><td><input type=''text' id='"+this._id+"endtime' class='startendtime' name='EndTime'/><\/td><td><input id='"+this._id+"endTimeZone'  class='endutc'  name='"+this.model.appointmentSettings.endTimeZone+"'  type='text' value=''/><div id='Timezonelistend'><\/div><\/td><\/tr>",r=this.model.prioritySettings.enable?"<td colspan='1' class='e-textlabel "+this._id+"priorityshow'>"+this._getLocalizedLabels("Priority")+":<\/td><td colspan='1' class='"+this._id+"prioritylistshow'><input id='"+this._id+"_priority' class='priority' type='text' name='"+this.model.appointmentSettings.priority+"' value='' /><div id='prioritylist'><\/div><\/td>":"<td style='display:none'><\/td>",i+="<tr class='"+this._id+"parrow'>"+r+"<td class='"+this._id+"allDay' colspan='4'><table class='e-table' cellpadding='3'><tr><td><div class='e-allday e-checkboxmargin'><input id='"+this._id+"allday' tabIndex='0' class='allday' type='checkbox' name='"+this.model.appointmentSettings.allDay+"'/><\/div><\/td><td><div class='e-alldaytext'><label for='"+this._id+"allday'>"+this._getLocalizedLabels("AllDay")+"<\/label><\/div><\/td><td><div class='e-checkboxmargin e-recurrence'><input id='"+this._id+"recurrence' tabIndex='0' class='recurrence' type='checkbox' name='"+this.model.appointmentSettings.recurrence+"' value='recurrence'/><\/div><\/td><td><label class='e-repeatlbl' for='"+this._id+"recurrence'>"+this._getLocalizedLabels("Recurrence")+"<\/label><\/td><\/tr><\/table><\/td><\/tr>",i+="<tr id='"+this._id+"summary' class='"+this._id+"summary' style='display:none'><td class='e-textlabel'><label>"+this._getLocalizedLabels("Summary")+":<\/label><\/td><td colspan='3'><table><tr><td><label class='e-recurFinalRule'><\/label><\/td><td><div class='e-recuredit'><a class='e-recuredit' href='#'>"+this._getLocalizedLabels("Edit")+"<\/a><span class='e-icon e-scheduleedit'><\/span><\/div><\/td><\/tr><\/table><\/td><\/tr>",this.model.categorizeSettings.enable&&(i+="<tr id='"+this._id+"categorize'><td class='e-leftfields e-textlabel'>"+this._getLocalizedLabels("Categorize")+":<\/td><td colspan='3' class='e-rightfields'><input id= '"+this._id+"_categorize' class='e-categorizevalue' type='text' value=''/><div id='ownerlist'><\/div><\/td><\/tr>"),!t.isNullOrUndefined(this.model.resources)&&this.model.resources.length>0&&t.scheduleFeatures.resources&&(i=this._renderResourceElements(i)),i+="<tr><td colspan='4'><textarea class='e-description e-inputtext' id='description' name='"+this.model.appointmentSettings.description+"'><\/textarea><\/td><\/tr>",i+="<\/tbody><\/table><\/form>",i+="<div class='e-floatright'><table class='e-table' cellpadding='5'><tr><td><div class='e-btnmargin e-floatleft'><button id='done' class='e-btndone e-appsave'>"+this._getLocalizedLabels("Done")+"<\/button><\/div><\/td><td><div class='e-btnmargin e-floatleft'><button id='cancel' class='e-appointcancel cancel'>"+this._getLocalizedLabels("Cancel")+"<\/button><\/div><\/td><\/tr><\/table><\/div><\/div>",this._appointmentAddWindow.append(i).append(this._recurrenceWindow()));this.element.append(this._appointmentAddWindow);this._renderControls();this._appointmentAddWindow.ejDialog({width:this._mediaQuery?"100%":600,cssClass:this.model.cssClass,showOnInit:!1,enableRTL:this.model.enableRTL,enableModal:!0,title:this._getLocalizedLabels("CreateAppointmentTitle"),target:"#"+this._id,enableResize:!1,allowKeyboardNavigation:!1,close:n.proxy(this._onclose,this)});n("#"+this._id+"AppointmentAddEditWindow_wrapper").appendTo("body").addClass("e-scheduledialog").find(".e-titlebar").addClass("e-dialogheader");n("#"+this._id+"_priority_popup_wrapper").addClass("e-schedulepriority");this._on(this._appointmentAddWindow,"click","a.e-recuredit",n.proxy(this._editRecurrence,this))},_renderQuickAppWindow:function(){var i,r;this._quickAppointWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppointmentQuickWindow");i="<div id='"+this._id+"_quickAppwindow' class='e-tableAppoint'><table cellpadding='7' class='e-qappwindow'><tbody>";i+="<tr><td colspan='2'><div class='e-quickstartend'><\/div> <div title='"+this._getLocalizedLabels("Close")+"'class='e-icon e-scheduleclose e-schedclosemargin e-pointercursor'><\/div><\/td><\/tr><tr><td class='e-subjectlabel'>"+this._getLocalizedLabels("AppointmentSubject")+":<\/td><td colspan='2' class='e-rightfields'><input id='"+this._id+"subject' class='subject e-inputtext'  type='text' /><\/td><\/tr><\/tbody><\/table>";i+="<div style='margin-top:5px; padding-bottom: 30px;'><div tabIndex='0' class='e-detailedapp e-detailedwindow'> "+this._getLocalizedLabels("Detailed")+" >><\/div><div style='margin-right:-3px;' class='e-floatright'><div class='e-quickAppDone'><button id='done' class='e-btndone qAppDone' style='font-size:12px !important;'>"+this._getLocalizedLabels("CreateAppointmentTitle")+"<\/button><\/div><\/div><\/div><\/div>";this._quickAppointWindow.append(i);this.element.append(this._quickAppointWindow);this._quickAppointWindow.append(t.buildTag("div.e-quickarrow").append("<div class='e-outerarrowline'><\/div>").append("<div class='e-innerarrow'><\/div>"));r=this._quickAppointWindow;r.find(".e-btndone").ejButton({showRoundedCorner:!0,width:"130px",click:n.proxy(this._saveAppointment,this),cssClass:this.model.cssClass,enableRTL:this.model.enableRTL});this._on(r.find(".e-scheduleclose"),"click",n.proxy(this._quickWindowClose,this));this._on(r.find(".e-detailedapp"),"click",n.proxy(this._appointmentWindow,this));this._quickAppointWindow.ejDialog({width:330,minHeight:0,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,enableAnimation:!1,showOnInit:!1,enableResize:!1,allowDraggable:!1,showHeader:!1,allowKeyboardNavigation:!1});n("#"+this._id+"AppointmentQuickWindow_wrapper").addClass("e-scheduledialog e-schedulequickdialog").css("overflow","visible").find("#"+this._id+"AppointmentQuickWindow").addClass("e-dialogouter")},_renderQuickAppDetailsView:function(){this._quickAppDetailsWindow=t.buildTag("div.e-scheduledialog#"+this._id+"AppDetailsWindow");var i="<div id='"+this._id+"_quickAppDetailswindow' class='e-tableAppoint e-appdetails'><table cellpadding='1' class='e-qappwindow'><tbody>";i+="<tr><td colspan='2'><div class='e-quicksubject'><\/div> <div title='"+this._getLocalizedLabels("Close")+"' class='e-icon e-scheduleclose e-schedclosemargin e-pointercursor'><\/div><\/td><\/tr><tr><td colspan='2' class='e-rightfields'><\/td><\/tr><tr><td colspan='2'><div class='e-quickstartendtime'><\/div><\/td><\/tr><\/tbody><\/table>";i+="<div style='margin-top:5px;'><div title='"+this._getLocalizedLabels("Delete")+"' class='e-icon e-scheduledelete e-pointercursor' tabIndex='0'><\/div><div class='e-floatright'><div class='e-editevents'><div class='e-editevent e-textellipsis' tabIndex='0'>"+this._getLocalizedLabels("Editevent")+" | <\/div><div class='e-editseries e-textellipsis' tabIndex='0'>"+this._getLocalizedLabels("Editseries")+" >><\/div> <\/div><\/div><\/div><\/div>";this._quickAppDetailsWindow.append(i);this.element.append(this._quickAppDetailsWindow);this._quickAppDetailsWindow.append(t.buildTag("div.e-quickarrow").append("<div class='e-outerarrowline'><\/div>").append("<div class='e-innerarrow'><\/div>"));this._on(this._quickAppDetailsWindow.find(".e-scheduleclose"),"click",n.proxy(this._quickAppDetailWindowClose,this));this._on(this._quickAppDetailsWindow.find(".e-scheduledelete"),"click",n.proxy(this._deleteAppoint,this));this._on(this._quickAppDetailsWindow.find(".e-editevent,.e-editseries"),"click",n.proxy(this._editClick,this));this._quickAppDetailsWindow.ejDialog({width:270,minHeight:0,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,enableAnimation:!1,showOnInit:!1,enableResize:!1,allowDraggable:!1,showHeader:!1,allowKeyboardNavigation:!1});n("#"+this._id+"AppDetailsWindow_wrapper").addClass("e-scheduledialog e-schedulequickdialog").css("overflow","visible").find("#"+this._id+"AppDetailsWindow").addClass("e-dialogouter")},_editClick:function(i){if(n(i.target).hasClass("e-editseries")&&this._quickAppDetailsWindow.find(".e-editseries").hasClass("e-disable"))return!1;var u=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),r=new t.DataManager(this._processed).executeLocal(u);n(i.target).hasClass("e-editevent")?r[0][this.model.appointmentSettings.recurrence]==1?(this._parentId=r[0].ParentId,this._currentAction=t.Schedule.Actions.EditOcurrence,this._showAppointmentDetails(this._appUid,!0)):t.isNullOrUndefined(r[0][this.model.appointmentSettings.recurrence])?(this._currentAction=t.Schedule.Actions.Save,this._showAppointmentDetails(this._appUid,!0)):(this._currentAction=t.Schedule.Actions.Save,this._showAppointmentDetails(r[0].Guid,!0)):n(i.target).hasClass("e-editseries")&&r[0][this.model.appointmentSettings.recurrence]==1&&(this._parentId=r[0][this.model.appointmentSettings.recurrenceId]==null?r[0].ParentId:r[0][this.model.appointmentSettings.recurrenceId],this._currentAction=t.Schedule.Actions.EditSeries,this._showAppointmentDetails(this._parentId,!1));this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close")},_deleteAppoint:function(i){var r,f,u;this.model.readOnly||(t.isNullOrUndefined(i)||!t.isNullOrUndefined(this._quickAppDetailsWindow)&&this._quickAppDetailsWindow.ejDialog("isOpen")?(u=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),this._recurId=u[0][this.model.appointmentSettings.recurrenceId],u[0][this.model.appointmentSettings.recurrence]?(this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("isOpen")&&this._quickAppDetailsWindow.ejDialog("close"),this._deletingAppointment()):this._deleteConfirmation()):(r=n(i.target).parent(),f=r.hasClass("e-appointment")||r.hasClass("e-monthappointment")||r.hasClass("e-alldayappointment")||r.hasClass("e-agendaappointment")?r:r.parents(".e-appointment,.e-alldayappointment,.e-monthappointment,.e-agendaappointment"),this._appUid=f.attr("guid"),this._mediaQuery&&(this._mAppId=this._appUid),u=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),this._recurId=u[0][this.model.appointmentSettings.recurrenceId],u[0][this.model.appointmentSettings.recurrence]?this._deletingAppointment():this._deleteConfirmation()))},_deletingAppointment:function(){if(this._appUid){this._currentAction=t.Schedule.Actions.Delete;var n=this._getAppointmentByParentId(this._mediaQuery?t.isNullOrUndefined(this._mAppId)?this._appUid:this._mAppId:this._appUid);n[this.model.appointmentSettings.recurrence]?(this._parentId=parseInt(n.AppTaskId),this._recurEditWindow.ejDialog("open"),this._recurEditWindow.focus(),this._deleteBeforeOpen()):this._deleteApp(this._mediaQuery?t.isNullOrUndefined(this._mAppId)?this._appUid:this._mAppId:this._appUid)}this._alertWindow.ejDialog("close")},_deleteConfirmation:function(){if(this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close"),t.isNullOrUndefined(this._alertWindow)&&this._renderAlertWindow(),n(".e-alertbtn").find(".e-alertCancel").length==0){var i="<button id='"+this._id+"alertcancel' class='e-alertbutton e-alertCancel'>"+this._getLocalizedLabels("Cancel")+"<\/button>";this._alertWindow.find(".e-alertbtn").append(i);this._alertWindow.find(".e-alertCancel").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._alertClose,this),cssClass:this.model.cssClass});this._mediaQuery&&this._alertWindow.find(".e-alertCancel").css({margin:"0px 20px 15px 10px"});n("#"+this._id+"alertWindow").ejDialog({width:this._mediaQuery?"90%":450,title:this._getLocalizedLabels("MouseOverDeleteTitle")});this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("DeleteConfirmation"));this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Delete"))}this._alertWindow.ejDialog("isOpen")||(this._alertWindow.ejDialog("open"),this._alertWindow.find(".e-alertOk").attr("tabIndex",0).focus())},_quickAppDetailWindowClose:function(){this._quickAppDetailsWindow.ejDialog("close");this._processFocus()},_alldayCheck:function(){this._appointmentAddWindow.find(".allday").ejCheckBox("option","checked")?(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker({value:this._timeMode=="12"?"12:00 AM":"00:00",enabled:!1}),this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker({value:this._timeMode=="12"?"11:59 PM":"23:59",enabled:!1}),this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList({enabled:!1})):((this._tempStart!=""||this._tempEnd!="")&&(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker({value:this._tempStart}),this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker({value:this._tempEnd}),(this._timeMode=="12"?this._tempStart=="12:00 AM"&&this._tempEnd=="11:59 PM":this._tempStart=="00:00"&&this._tempEnd=="23:59")&&(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker({value:Globalize.format(new Date("1/1/2000 "+this.model.workHours.start+":00:00"),this._pattern.t)}),this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker({value:Globalize.format(new Date("1/1/2000 "+this.model.workHours.start+":30:00"),this._pattern.t)}))),this._appointmentAddWindow.find(".startendtime").ejTimePicker({enabled:!0}),this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList({enabled:!0}),this._endSlotChange=!0,this._startSlotChange=!0)},_renderRecurEditWindow:function(){this._recurEditWindow=t.buildTag("div.e-scheduledialog#"+this._id+"RecurrenceEdit");var r=t.buildTag("div.e-recureditmsg",this._getLocalizedLabels("RecurrenceEditMessage")),i=t.buildTag("div.e-recureditbtns").append(t.buildTag("button.e-editonly",this._getLocalizedLabels("RecurrenceEditOnly"),{},{name:"recurrenceeditonly",value:this._getLocalizedLabels("RecurrenceEditOnly")})).append(t.buildTag("button.e-editseries",this._getLocalizedLabels("RecurrenceEditSeries"),{},{name:"recurrenceeditseries",value:this._getLocalizedLabels("RecurrenceEditSeries")}));this._recurEditWindow.append(r).append(i);i.find(".e-editonly,.e-editseries").ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,showRoundedCorner:!0});this._on(this._recurEditWindow,"click",".e-editonly,.e-editseries",n.proxy(this._recurBtnClick,this));this._on(this._recurEditWindow,"click","div.e-scheduleclose",n.proxy(this._recrConformClose,this));this._recurEditWindow.appendTo(this.element);this._mediaQuery&&this._recurEditWindow.find(".e-editonly,.e-editseries").css({"margin-top":"10px"});this._recurEditWindow.ejDialog({width:this._mediaQuery?"90%":360,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,title:this._getLocalizedLabels("RecurrenceEditTitle"),showOnInit:!1,enableModal:!0,enableResize:!1,target:"#"+this._id,allowKeyboardNavigation:!1,close:n.proxy(this._processFocus,this),beforeOpen:n.proxy(this._deleteBeforeOpen,this)});n("#"+this._id+"RecurrenceEdit_wrapper").appendTo("body").addClass("e-scheduledialog")},_recrConformClose:function(){this._recurEditWindow.ejDialog("close");this._processFocus()},_deleteBeforeOpen:function(){n("#"+this._id+"RecurrenceEdit_title").addClass("e-dialogheader");n("#"+this._id+"RecurrenceEdit_title").find(".e-title").html(this._currentAction==t.Schedule.Actions.Delete?this._getLocalizedLabels("RecurrenceDeleteTitle"):this._getLocalizedLabels("RecurrenceEditTitle"))},_getNewOverlapList:function(i){var e;if(this.currentView()!=="month"&&!this._isCustomView()){var r=i[this.model.appointmentSettings.startTime],f=this.currentView()=="day"?0:this.model.orientation=="horizontal"&&this.currentView()=="month"?n.inArray(new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime(),this.monthDays):n.inArray(new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime(),this._dateRender),o=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this._findResourceIndex(this.res1,this.model.resources[this.model.resources.length-1].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):0,u=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(this._dateRender[f]));u=u.and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(this._dateRender[f]).setHours(23,59,59)));u=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?u.and(this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1],t.FilterOperators.equal,this.res1[o][this.model.resources[this.model.resources.length-1].resourceSettings.id]):u;e=new t.DataManager(this._processed).executeLocal((new t.Query).where(u));this._appList=this._alldaySort(e);this._newoverlapList=this._overlapApp(i.AppTaskId,i[this.model.appointmentSettings.startTime],i[this.model.appointmentSettings.endTime],null);this._currentAction==t.Schedule.Actions.Delete?this._newoverlapList.splice(this._newoverlapList.indexOf(i),1):""}},_recurBtnClick:function(r){var f,c,s,e,o,u,a,h,y,v;if(n(r.target).hasClass("e-editonly"))if(this._editOnlyClicked=!0,this._currentAction==t.Schedule.Actions.Delete){if(f=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],this._getNewOverlapList(f),f[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1)if(c=f[this.model.appointmentSettings.recurrenceId]==null?f.ParentId:f[this.model.appointmentSettings.recurrenceId],s=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("AppTaskId",t.FilterOperators.equal,c)),e=this.dataSource()instanceof t.DataManager?this._dataManager.remove(this.model.appointmentSettings.id,f[this.model.appointmentSettings.id]):this._dataManager.remove("Guid",f.Guid),u=this,n.isFunction(e.promise))e.done(function(i){if(u._trigger("actionBegin",{id:u._appId,requestType:"appointmentDelete"}))return!1;if(u.model.enableLoadOnDemand)u._initDataSource("refresh");else{var r=t.isNullOrUndefined(i.record)?i:i.record;u._currentAppointmentData.length=0;u._dateFormat(r);u._bindAppointments=!0;u._currentAppointmentData=n.merge(u._currentAppointmentData,r);u._dataProcessing(r);u._renderAppointmentAll()}u._trigger("appointmentDeleted",{appointment:s});u._trigger("actionComplete",{appointment:s,requestType:"appointmentDelete"})}),e.fail(function(){});else{if(this._trigger("actionBegin",{id:this._appUid,requestType:"appointmentDelete"}))return!1;new t.DataManager(this._processed).remove("Guid",this._appUid);this.element.find("[guid="+this._appUid+"]").remove();this.element.find("#categorybar_"+this._appUid).remove();this.currentView()!=="month"&&!this._isCustomView()?this.currentView()=="agenda"?this._renderAgendaContent():this._reRenderApp(f):this._renderAppointmentAll();this._trigger("appointmentDeleted",{appointment:s});this._trigger("actionComplete",{appointment:s,requestType:"appointmentDelete"})}else{var c=f[this.model.appointmentSettings.recurrenceId]==null?f.ParentId:f[this.model.appointmentSettings.recurrenceId],p=this._deleteOcurrence(c,f[this.model.appointmentSettings.startTime]),l=this._timeZoneAppointments(p[0],"");if(e=this.dataSource()instanceof t.DataManager?this._dataManager.update(this.model.appointmentSettings.id,l):this._dataManager.update("AppTaskId",l),o=this._timeZoneAppointments(l,"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",o),u=this,e&&n.isFunction(e.promise)&&this.dataSource()instanceof t.DataManager)e.done(function(i){if(u._trigger("actionBegin",{id:u._appId,requestType:"appointmentDelete"}))return!1;if(u.model.enableLoadOnDemand)u._initDataSource("refresh");else{var r=t.isNullOrUndefined(i.record)?i:i.record;u._currentAppointmentData.length=0;u._dateFormat(r);u._bindAppointments=!0;u._currentAppointmentData=n.merge(u._currentAppointmentData,r);u._dataProcessing(r);u._renderAppointmentAll()}u._trigger("appointmentDeleted",{appointment:f});u._trigger("actionComplete",{appointment:f,requestType:"appointmentDelete"})}),e.fail(function(){});else{if(this._trigger("actionBegin",{id:this._appId,requestType:"appointmentDelete"}))return!1;if(new Date(new Date(o[this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(o[this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(o[this.model.appointmentSettings.endTime]-o[this.model.appointmentSettings.startTime])/36e5<24&&o[this.model.appointmentSettings.allDay]!==!0)for(a=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),i=0;i<a.length;i++)h=a[i].Guid,y=new t.DataManager(this._processed).remove("Guid",h),this.element.find("[guid="+h+"]").remove(),this.element.find("#categorybar_"+h).remove();else y=new t.DataManager(this._processed).remove("Guid",this._appUid),this.element.find("[guid="+this._appUid+"]").remove(),this.element.find("#categorybar_"+this._appUid).remove();this.currentView()!=="month"&&!this._isCustomView()?this.currentView()=="agenda"?this._renderAgendaContent():this._reRenderApp(f):this._renderAppointmentAll();this._trigger("appointmentDeleted",{appointment:f});this._trigger("actionComplete",{appointment:f,requestType:"appointmentDelete"})}}v=this._appointmentCount();v.length<1&&this.model.enableAppointmentNavigation&&this._nextPrevButton(v)}else this._currentAction=t.Schedule.Actions.EditOcurrence,this._showAppointmentDetails(this._appUid,!0);else this._editOnlyClicked=!1,this._currentAction==t.Schedule.Actions.Delete?this._deleteApp(this._appUid):(this._currentAction=t.Schedule.Actions.EditSeries,this._showAppointmentDetails(this._parentId,!1));this._recurEditWindow.ejDialog("close")},_repeat:function(n){if(n.isChecked||this._recurChecked)if(this._currentAction==t.Schedule.Actions.EditSeries||this._appointmentAddWindow.find(".e-recurFinalRule").html()!="")this._appointmentAddWindow.find("."+this._id+"summary").css("display","table-row");else{this._mediaQuery&&this._appointmentAddWindow.parent().parent().find(".e-dialog-icon").css("display","none");this._appointmentAddWindow.find(".e-appwindow").toggle();this._appointmentAddWindow.find(".e-recurwindow").css("margin-left",700).toggle().animate({"margin-left":10},400);this._recurClearFields();var i=new Date(this._appointmentAddWindow.find(".startenddate").ejDatePicker("option","value"));this._appointmentAddWindow.find(".recurtype").ejDropDownList({selectedItemIndex:0});this._appointmentAddWindow.find(".recurtype").ejDropDownList({selectedItemIndex:1});this._appointmentAddWindow.find(".recurstartdate").ejDatePicker("option","value",new Date(i));this._appointmentAddWindow.find(".e-until").ejDatePicker({value:new Date(i.setDate(i.getDate()+70))});this._appointmentAddWindow.find(".e-recurnoend").ejRadioButton({checked:!0})}else(this._currentAction==t.Schedule.Actions.EditSeries||this._appointmentAddWindow.find(".e-recurFinalRule").html()!="")&&this._appointmentAddWindow.find("."+this._id+"summary").css("display","none");this._recurChecked=!1},_recurtype:function(n){var i,t,r;this._rRuleFreq="";i="";t=new Date(this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value"));n.itemId!=null&&(this._appointmentAddWindow.find("#"+this._id+"repeatEvery").css("display","table-row"),n.itemId==0?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceDay"),this._appointmentAddWindow.find("."+this._id+"weeklyrecur,."+this._id+"monthlyrecur,."+this._id+"yearlyrecur").css("display","none"),this._appointmentAddWindow.find("#"+this._id+"dailyrecur").css("display","table-row"),this._rRuleFreq="DAILY",i=this._getLocalizedLabels("RecurrenceDay").toLowerCase()):n.itemId==1?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceWeek"),r=this._dayNames[t.getDay()],this._appointmentAddWindow.find(".e-weekly"+r).ejCheckBox({checked:!0}),i=this._getLocalizedLabels("RecurrenceWeek").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._dayFullNames[t.getDay()],this._rRuleFreq="WEEKLY",this._appointmentAddWindow.find("."+this._id+"monthlyrecur,."+this._id+"yearlyrecur,#"+this._id+"dailyrecur").css("display","none"),this._appointmentAddWindow.find("."+this._id+"weeklyrecur").css("display","table-row")):n.itemId==2?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceMonth"),this._appointmentAddWindow.find("."+this._id+"weeklyrecur,."+this._id+"yearlyrecur,#"+this._id+"dailyrecur").css("display","none"),this._appointmentAddWindow.find("."+this._id+"monthlyrecur").css("display","table-row"),this._appointmentAddWindow.find(".e-monthdate").ejNumericTextbox({value:t.getDate()}),this._appointmentAddWindow.find(".e-monthsrtday").ejDropDownList({selectedItemIndex:t.getDay()}),this._appointmentAddWindow.find(".monthsrt").ejDropDownList({selectedItemIndex:this._getWeekIndex(t)}),this._appointmentAddWindow.find(".e-monthdaytype").ejRadioButton({checked:!0}),this._rRuleFreq="MONTHLY",i=this._getLocalizedLabels("RecurrenceMonth").toLowerCase()):n.itemId==3?(this._appointmentAddWindow.find("#"+this._id+"recurtypes").get(0).innerHTML=this._getLocalizedLabels("RecurrenceYear"),this._appointmentAddWindow.find("."+this._id+"weeklyrecur,."+this._id+"monthlyrecur,#"+this._id+"dailyrecur").css("display","none"),this._appointmentAddWindow.find("."+this._id+"yearlyrecur").css("display","table-row"),this._appointmentAddWindow.find(".yearmonth").ejDropDownList({selectedItemIndex:t.getMonth()}),this._appointmentAddWindow.find(".yeardate").ejNumericTextbox({value:t.getDate()}),this._appointmentAddWindow.find(".yearsrtday").ejDropDownList({selectedItemIndex:t.getDay()}),this._appointmentAddWindow.find(".yearsrtmonth").ejDropDownList({selectedItemIndex:t.getMonth()}),this._appointmentAddWindow.find(".yearsrt").ejDropDownList({selectedItemIndex:this._getWeekIndex(t)}),this._appointmentAddWindow.find(".e-yearrecurday").ejRadioButton({checked:!0}),this._rRuleFreq="YEARLY",i=this._getLocalizedLabels("RecurrenceYear").toLowerCase()):n.itemId==4&&(this._rRuleFreq="WEEKDAYS",this._appointmentAddWindow.find("."+this._id+"weeklyrecur,."+this._id+"yearlyrecur,#"+this._id+"dailyrecur,#"+this._id+"repeatEvery,."+this._id+"monthlyrecur").css("display","none"),i=n.text),this._appointmentAddWindow.find(".e-recurRule").html(i))},_getRenderDates:function(){var f,h,e,l,i;this._dateRender=[];var o,r,c=[],u=[],s=[];if(this.currentView()==="week"||this.currentView()==="workweek"){if(o=this._firstweekdate(this.currentDate()),o.getDay()!=0||this._firstdayofweek==0&&this.model.workWeek.length>0&&this.currentView()=="workweek"||this.currentView()=="week")for(i=0;i<7;i++)r=new Date(o),r.setDate(o.getDate()+i),this._dateRender.push(new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime());if((this._firstdayofweek!=0||this._firstdayofweek==0)&&this.currentView()=="workweek"&&this.model.workWeek[0]=="monday"&&this.model.workWeek[4]=="friday"&&this.model.workWeek[5]!="saturday")for(i=0;i<7;i++)r=new Date(this._dateRender[i]),r.getDay()==0?this._dateRender.splice(i,1):r.getDay()==6&&this._dateRender.splice(i,2);else if(this.currentView()=="workweek"&&this.model.workWeek){for(i=0,e=0;i<this._dateRender.length;i++)this.model.workWeek[e]==this._dayNamesArray[i]&&(u.push(i),e++);if(this._firstdayofweek>=u[0]){for(f=0;f<u.length;f++)if(this._firstdayofweek<=u[f]){h=u[f];break}}else for(f=0;f<u.length;f++)if(this._firstdayofweek>u[f]){h=u[f];break}for(i=0,e=0;i<u.length;i++)h<=u[i]&&(s[e]=u[i],e++);for(s=n.merge(s,u),s=this._firstdayofweek!=0&&this._firstdayofweek<=h?n.unique(s):n.unique(u),i=0,e=0;i<this._dateRender.length;i++)s[e]==new Date(this._dateRender[i]).getDay()&&(c.push(this._dateRender[i]),e++);this._dateRender.length=0;this._dateRender=n.merge(this._dateRender,c)}}else if(this.currentView()==="month")this._dateRender=this._monthdates();else if(this.currentView()==="customview")if(t.isNullOrUndefined(this.model.renderDates))this._dateRender=this._monthdates();else for(l=this._renderDays<=7?this._renderDays:this._numDays,o=this._renderDays<=7?new Date(this.currentDate()):this.model.orientation=="vertical"?this._firstweekdate(this.currentDate()):new Date(this.currentDate()),i=0;i<l;i++)r=new Date(o),r.setDate(o.getDate()+i),this._dateRender.push(new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime());else this._dateRender.push(new Date(new Date(this.currentDate()).setHours(0,0,0)));return this._dateRender},_getCurrentDateHeaderValue:function(){var r=Globalize.culture(this.model.locale),t,n=this._dateRender,i;return this.currentView()==="day"?t=r.calendar.days.names[new Date(n[0]).getDay()].slice(0,3)+" "+new Date(n[0]).getDate()+" "+Globalize.format(new Date(n[0]),"MMM")+" "+new Date(n[0]).getFullYear():this.currentView()==="week"||this.currentView()==="workweek"?new Date(n[0]).getYear()===new Date(n[n.length-1]).getYear()?new Date(n[0]).getMonth()===new Date(n[n.length-1]).getMonth()?t=Globalize.format(new Date(n[0]),"dd")+" - "+Globalize.format(new Date(n[n.length-1]),"dd MMM yyyy"):new Date(n[0]).getMonth()!==new Date(n[n.length-1]).getMonth()&&(t=this.model.enableRTL?Globalize.format(new Date(n[n.length-1]),"MMM dd")+" - "+Globalize.format(new Date(n[0]),"dd MMM yyyy"):Globalize.format(new Date(n[0]),"dd MMM")+" - "+Globalize.format(new Date(n[n.length-1]),"dd MMM yyyy")):t=Globalize.format(new Date(n[0]),"MMM dd yyyy")+" - "+Globalize.format(new Date(n[n.length-1]),"MMM dd yyyy"):this.currentView()==="customview"?n.length==1?t=r.calendar.days.names[new Date(n[0]).getDay()].slice(0,3)+" "+new Date(n[0]).getDate()+" "+Globalize.format(new Date(n[0]),"MMM")+" "+new Date(n[0]).getFullYear():n.length>1&&n.length<=7?new Date(n[0]).getYear()===new Date(n[n.length-1]).getYear()?new Date(n[0]).getMonth()===new Date(n[n.length-1]).getMonth()?t=Globalize.format(new Date(n[0]),"dd")+" - "+Globalize.format(new Date(n[n.length-1]),"dd MMM yyyy"):new Date(n[0]).getMonth()!==new Date(n[n.length-1]).getMonth()&&(t=this.model.enableRTL?Globalize.format(new Date(n[n.length-1]),"MMM dd")+" - "+Globalize.format(new Date(n[0]),"dd MMM yyyy"):Globalize.format(new Date(n[0]),"dd MMM")+" - "+Globalize.format(new Date(n[n.length-1]),"dd MMM yyyy")):t=Globalize.format(new Date(n[0]),"MMM dd yyyy")+" - "+Globalize.format(new Date(n[n.length-1]),"MMM dd yyyy"):t=new Date(n[0]).getFullYear()==new Date(n[n.length-1]).getFullYear()?new Date(n[0]).getMonth()==new Date(n[n.length-1]).getMonth()?Globalize.format(new Date(this.currentDate()),"MMM yyyy"):Globalize.format(new Date(n[0]),"MMM")+" - "+Globalize.format(new Date(n[n.length-1]),"MMM yyyy"):Globalize.format(new Date(n[0]),"MMM yyyy")+" - "+Globalize.format(new Date(n[n.length-1]),"MMM yyyy"):this.currentView()==="agenda"?(i=this.model.agendaViewSettings.daysInAgenda>0?this.model.agendaViewSettings.daysInAgenda-1:0,new Date(n[0]).getYear()===new Date(new Date(n[0]).setDate(n[0].getDate()+i)).getYear()?new Date(n[0]).getMonth()===new Date(new Date(n[0]).setDate(n[0].getDate()+i)).getMonth()?t=Globalize.format(new Date(n[0]),"dd")+" - "+Globalize.format(new Date(new Date(n[0]).setDate(n[0].getDate()+i)),"dd MMM yyyy"):new Date(n[0]).getMonth()!==new Date(new Date(n[0]).setDate(n[0].getDate()+i)).getMonth()&&(t=this.model.enableRTL?Globalize.format(new Date(new Date(n[0]).setDate(n[0].getDate()+i)),"MMM dd")+" - "+Globalize.format(new Date(n[0]),"dd MMM yyyy"):Globalize.format(new Date(n[0]),"dd MMM")+" - "+Globalize.format(new Date(new Date(n[0]).setDate(n[0].getDate()+i)),"dd MMM yyyy")):t=Globalize.format(new Date(n[0]),"MMM dd yyyy")+" - "+Globalize.format(new Date(new Date(n[0]).setDate(n[0].getDate()+i)),"MMM dd yyyy")):t=Globalize.format(new Date(this.currentDate()),"MMM yyyy"),t},_firstweekdate:function(n){var i=new Date(n),t=i.getDay();return this._firstdayofweek==0?t!=0&&(i.setDate(i.getDate()-t),!this.model.timeScale.enable&&(this.currentView()=="workweek"||this._oneWeek)&&this._resize&&(i=new Date(this._dateRender[0]))):this._firstdayofweek!=0&&this.currentDate().getDay()>=this._firstdayofweek?(t=t-this._firstdayofweek,t=i.getDate()-t,i.setDate(t)):this._firstdayofweek!=0&&this.currentDate().getDay()<this._firstdayofweek&&(t=t-this._firstdayofweek,t=i.getDate()-t-7,i.setDate(t)),i},_getHeaderAllDayCellsCount:function(){var e=Globalize.culture(this.model.locale),h,o,c=[],r,u,s,l,f,i;if(this.dateRender=[],this._value=[],this.value=[],s=1,r=[],this.model.orientation=="vertical"){for(o=this._getColumnCount().length,t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)||!t.scheduleFeatures.resources||(l=this.__getMultipleResourceCellsCount(o),s=l.resCount),i=0;i<o;i++)u=this.currentView()==="month"||this.currentView()==="day"||this._isCustomView()?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?e.calendar.days.names[new Date(this._dateRender[i]).getDay()]:e.calendar.days.names[new Date(this._dateRender[i]).getDay()].slice(0,3):e.calendar.days.names[new Date(this._dateRender[i]).getDay()].slice(0,3),f=new Date(new Date(this._dateRender[i]).setHours(0,0,0,0)).getTime()===new Date((new Date).setHours(0,0,0,0)).getTime()?"e-headerToday":"",h=this.currentView()==="month"||this._isCustomView()?{currentDay:u,currentDateClass:"",cellToday:f}:this.currentView()==="day"?t.isNullOrUndefined(this.model.resources)&&t.isNullOrUndefined(this.model.group)?{currentDay:u+" "+Globalize.format(new Date(this._dateRender[i]),"dd MMMM yyyy"),currentDateClass:"",cellToday:f}:{currentDay:u+" "+Globalize.format(new Date(this._dateRender[i]),"dd MMM yy"),currentDateClass:"",cellToday:f}:{currentDay:u+" "+new Date(this._dateRender[i]).getDate(),currentDateClass:new Date(this._dateRender[i]).getDate()===new Date(this.currentDate()).getDate()?"e-activeview":"",cellToday:f},c.push(h),this._value.push(i);for(i=0;i<s;i++)this.dateRender=n.merge(this.dateRender,this._dateRender),r=n.merge(r,c),this.value=n.merge(this.value,this._value)}else r=this._getHorizontalheaderCellCount(e);return r},_findResourceIndex:function(n,t,i){for(var r=0;r<n.length;r++)if(n[r][t]===i)return r},_renderHeaderAllDayTemplate:function(){var r,e,i,k,d,g,nt,y,p,o;if(this.currentView()!="agenda")if(t.scheduleFeatures.horizontal&&this.model.orientation=="horizontal")!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources&&this._renderMultipleResourceHeaderTemplate(null,null),this._renderHorizontalHeaderBar();else{var s=t.buildTag("div.e-headeralldaydiv","",{},{height:"100%"}).css("position","relative").css("overflow","hidden"),w=0,h=t.buildTag("table.e-table e-headrealldaytable","",{},{cellspacing:"0px",cellpadding:"0px",width:"100%"}),u=t.buildTag("tbody"),b=t.buildTag("tr.e-dateheader"),f=this._getHeaderAllDayCellsCount(),o=this.headTemplate.render({cols:f,view:this.currentView(),colspan:1});!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources&&(u=this._renderMultipleResourceHeaderTemplate(u,f),w=t.isNullOrUndefined(this.model.group)?0:this.model.group.resources.length);var c=t.buildTag("div.e-navigate","",{},{}),l=t.buildTag("table.e-table e-headertable","",{},{cellspacing:"0px",cellpadding:"0px"}),a=t.buildTag("tbody"),v=t.buildTag("tr.e-headertr");for(headTrCount=this.currentView()=="month"||this._isCustomView()?1:2,r=w+headTrCount,e=[],i=0;i<r;i++)this.currentView()=="month"||this._isCustomView()?e.push({tdClass:i==r-1?"e-monthleftcells":"e-resourceheadercells",divClass:i==r-1?"e-dateheadercell":""}):e.push({tdClass:i==r-1?"e-leftindent":i==r-2?"e-settingsindent":"e-resourceheadercells",divClass:i==r-1?"e-schedulesettings e-textellipsis":i==r-2?"e-dateheadercell":""});k=this._mediaQuery?this.currentView()=="month"||this._isCustomView()?"50px":"30px":this.currentView()=="month"||this._isCustomView()?"50px":"56px";this.model.showAllDayRow||new t.DataManager(e).remove("tdClass","e-leftindent");d=this.leftIndent.render({trs:e,cswidth:k});this.model.timeScale.enable?this.aTR.append(t.buildTag("td").append(c.append(l.append(a.append(v.append(t.buildTag("td.e-empty","",{},{width:this._mediaQuery?this.currentView()=="month"||this._isCustomView()?"0px":"30px":this.currentView()=="month"||this._isCustomView()?"50px":"56px"}).addClass(this.currentView()=="month"||this._isCustomView()?"e-monthempty":"").append(d)).append(t.buildTag("td").append(s.append(h.append(u.append(b.append(o)))))).append(t.buildTag("td","",{},{width:this.currentView()=="month"||this._isCustomView()?"0px":this._mediaQuery?"0px":"18px"}))))))):this.aTR.append(t.buildTag("td").append(c.append(l.append(a.append(v.append(t.buildTag("td").append(s.append(h.append(u.append(b.append(o)))))).append(t.buildTag("td","",{},{width:this.currentView()=="month"||this._isCustomView()?"0px":this._mediaQuery?"0px":"18px"})))))));this.currentView()==="month"||this._isCustomView()||this.model.showAllDayRow&&(g=t.buildTag("tr"),nt=this.alldayTemp.render({cols:f,colspan:1}),u.append(g.append(nt)))}else{var c=t.buildTag("div.e-navigate","",{},{}),l=t.buildTag("table.e-table e-headertable","",{},{cellspacing:"0px",cellpadding:"0px"}),a=t.buildTag("tbody"),v=t.buildTag("tr.e-headertr"),s=t.buildTag("div.e-headeralldaydiv","",{},{height:"100%"}).css("position","relative").css("overflow","hidden"),h=t.buildTag("table.e-table e-headrealldaytable","",{},{cellspacing:"0px",cellpadding:"0px",width:"100%"}),u=t.buildTag("tbody tr"),f=[{headertext:this._getLocalizedLabels("Date"),className:"e-datecolumn"},{headertext:this._getLocalizedLabels("Time"),className:"e-timecolumn"},{headertext:this._getLocalizedLabels("Event"),className:"e-eventcolumn"}];if(!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources){for(this._renderMultipleResourceHeaderTemplate(null,null),y=[],p=0;p<this.render_Resources.length;p++)y.push({headertext:"",className:"e-resourcecolumn"});t.isNullOrUndefined(this.model.group)||(f=n.merge(y,f))}o=this.agendaheadTemplate.render({cols:f});this.aTR.append(t.buildTag("td").append(c.append(l.append(a.append(v.append(t.buildTag("td").append(s.append(h.append(u.append(o))))).append(t.buildTag("td.e-emptytd","",{},{width:"18px"})))))))}},_monthdates:function(){var t=new Date(this.currentDate()),n=new Date(t.getFullYear(),t.getMonth(),1),i=n.getDay()+1,u,e,f,r,o;for(this._firstdayofweek&&this._firstdayofweek>=5?n.setDate(n.getDate()-i+this._firstdayofweek-7):this._firstdayofweek<5?(n.setDate(n.getDate()-i+this._firstdayofweek),n.getMonth()==new Date(t.getFullYear(),t.getMonth(),1).getMonth()&&n.setDate(new Date(t.getFullYear(),t.getMonth(),1).getDate()-i+this._firstdayofweek-7)):n.setDate(n.getDate()-i),u=new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),this._firstdayofweek==0||this._firstdayofweek==5||this._firstdayofweek==6?(f=(i+u)%7!=0?7-(i+u)%7:0,e=parseInt((i+u+f)/7)):(f=7-new Date(t.getFullYear(),t.getMonth()+1,0).getDay(),e=u==30||t.getMonth()==6?6:5),r=[],o=0;o<e*7;o++)n.setDate(n.getDate()+1),r.push(new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0).getTime());return new Date(r[0]).getDate()==new Date(t.getFullYear(),t.getMonth(),1).getDate()&&(r=r.splice(0,35)),r},_getStartEndTime:function(){var i=[],f,u,e,r,n;if(this._timeInitial=0,u=Globalize.culture(this.model.locale).calendar,this.model.orientation==="vertical")if(this.currentView()=="month"||this._isCustomView())for(e=this._dateRender.length,n=0;n<e/7;n++)i.push(n);else if(t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate))for(r=new Date((new Date).setHours(0,0,0,0)),n=this.model.startHour*60;n<this.model.endHour*60;)this._timeMode==="12"?new Date(new Date(r).setHours(this.model.endHour,0,0,0)).getTime()>new Date(new Date(r).setHours(0,n,0,0)).getTime()&&(f=(n/60===this.model.startHour||n/60==12)&&u.AM&&u.PM?Globalize.format(new Date(new Date(r).setHours(0,n,0,0)),"hh tt"):Globalize.format(new Date(new Date(r).setHours(0,n,0,0)),"hh mm"),i.push({time:f,id:n/60})):i.push({time:new Date(new Date(r).setHours(0,n,0,0)).toTimeString().slice(0,5)+" 00"}),n=n+this.model.timeScale.majorSlot;else i=this._getUserTimeCellsTemplate();else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(i=this._getHoriStartEndTime(u));return i},_getWorkCellsCount:function(){var t=[],u,r,i,n;if(this.model.timeScale.enable)if(this.currentView()=="month"||this._isCustomView())for(i=this._dateRender.length,n=0;n<i/7;n++)t.push({crow:n,cwidth:this.model.cellWidth,cheight:this.model.cellHeight});else for(u=this._getStartEndTime(),r=0,n=0;n<this.model.timeScale.minorSlotCount*u.length;n++)if(r=r+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,r>(this.model.endHour-this.model.startHour)*60){t.push({crow:n,cwidth:this.model.cellWidth,cheight:this.model.cellHeight});break}else t.push({crow:n,cwidth:this.model.cellWidth,cheight:this.model.cellHeight});else for(i=this._dateRender.length,n=0;n<i/7;n++)t.push({crow:n,cwidth:this.model.cellWidth,cheight:this.model.cellHeight});return t},_renderContentAreaTemplate:function(){var r=t.buildTag("div.e-workareadiv"),u=t.buildTag("table.e-table e-worktable","",{},{height:"100%",cellpadding:"0px",cellspacing:"0px",width:"100%"}),f=t.buildTag("tbody"),e=t.buildTag("tr"),o=t.buildTag("td"),s=t.buildTag("div#"+this._id+"_scroller"),n,i,a,l;if(this.$WorkCellDiv=t.buildTag("div").css("position","relative").attr("class","e-draggableworkarea").css("height","100%"),n=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)&&!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)?!0:!1,i=t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)?!1:!0,this.currentView()!="agenda")if(t.scheduleFeatures.horizontal&&this.model.orientation=="horizontal")this._renderHorizontalContent(r,u,f,e,o,s);else{a=this.currentView()==="month"||this._isCustomView()?"e-monthleftindent":"e-workleftindent";this.$TimeCellTD=t.buildTag("td","",{},{}).addClass(a);var y=this.currentView()==="month"||this._isCustomView()?7:this._getRenderDates().length,c,n=!t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)&&!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)||!t.isNullOrUndefined(this.model.timeScale.minorSlotTemplate)?!0:!1,i=t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)?!1:!0,v=this.currentView()=="month"||this._isCustomView()?1:0,h=this._timeSlotCount(n,i);(n||i)&&this.currentView()!=="month"&&!this._isCustomView()?(h.columnCount.pop(),c=this.userTimeCellTemplate.render({timerows:this._getStartEndTime(),cols1:h.columnCount,viewclass:v,timeScale:this.model.timeScale.minorSlotCount,cheight:this.model.cellHeight,userTemplateId:n,timeValue1:h.timeValue1,template:i})):c=this.timeCellTemplate.render({timerows:this._getStartEndTime(),cols1:h.columnCount,viewclass:v,timeScale:this.model.timeScale.minorSlotCount,userTemplateId:n,template:i});l=this.currentView()!=="month"&&!this._isCustomView()&&this.model.timeScale.enable?this.workcellTemp.render({cellrows:this._getWorkCellsCount(),cols1:this.value,orientation:this.model.orientation,timeScale:this.model.timeScale.minorSlotCount}):this.monthcellTemp.render({cellrows:this._getWorkCellsCount(),cols1:this.value,orientation:this.model.orientation,timeScale:this.model.timeScale.minorSlotCount});this.model.timeScale.enable?this.wTR.append(t.buildTag("td").append(r.append(u.append(f.append(e.append(this.$TimeCellTD.append(c)).append(o.append(s.append(this.$WorkCellDiv.append(l))))))))):this.wTR.append(t.buildTag("td").append(r.append(u.append(f.append(e.append(o.append(s.append(this.$WorkCellDiv.append(l)))))))))}else this.wTR.append(t.buildTag("td").append(r.append(u.append(f.append(e.append(o.append(s.append(this.$WorkCellDiv))))))))},_timeSlotCount:function(i,r){var s=0,e=[],l=[],a,u,h,f,c;if((i||r)&&this.currentView()!=="month"&&!this._isCustomView()){for(f=0;f<this.model.timeScale.minorSlotCount;f++)e.push(f);h=e}else{for(a=this._getStartEndTime(),u=0;u<a.length;u++){for(f=0;f<this.model.timeScale.minorSlotCount;f++)if(s=s+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,s>(this.model.endHour-this.model.startHour)*60)break;else e.push(f);l.push(e);e=[]}h=l}if((i||r)&&this.currentView()!=="month"&&!this._isCustomView()){var v=n.templates(n(this.model.timeScale.minorSlotTemplate).html()),y=n.templates(n(this.model.timeScale.majorSlotTemplate).html()),p=[],u=0;for(f=this.model.startHour;f<this.model.endHour;){for(var o=[],s=this.model.timeScale.majorSlot+u,w=u;u<s;)c=u,u=u*6e4,this._timeMode==="12"?c!=w||t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)?o.push(v.render(object={date:new Date(new Date(this._dateRender[0]).setHours(f,0,0,u))}).trim()):o.push(y.render(object={date:new Date(new Date(this._dateRender[0]).setHours(f,0,0,u))}).trim()):c!=w||t.isNullOrUndefined(this.model.timeScale.majorSlotTemplate)?o.push(v.render(object={date:new Date(new Date(this._dateRender[0]).setHours(f,0,0,u))}).trim()):o.push(y.render(object={date:new Date(new Date(this._dateRender[0]).setHours(f,0,0,u))}).trim()),u=u/6e4+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount;f=this.model.timeScale.majorSlot>60?f+this.model.timeScale.majorSlot/60:u>=60?f+1:f;u=u>=60?0:u;p.push(o)}r=!0}return{columnCount:h,timeValue1:p}},_renderAgendaContent:function(){var rt,ut,ft,et,ot,st,ht,b,ct,k,lt,d,at,g,vt,yt,s,o,l,y,nt,p,tt,pt,c,u,r,kt,e,i,a,v,h;this.element.find(".e-agendacellstab").remove();var f=this._dateRender,w=[],it=[];for(this._app=[],this.model.group||(this.res1=["0"]),yt=this._getLocalizedLabels("Recurrence"),s=this.model.agendaViewSettings.daysInAgenda>0?this.model.agendaViewSettings.daysInAgenda-1:0,o=0;o<this.res1.length;o++)if(u=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(f[0])),u=u.and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(new Date(f[0]).setDate(f[0].getDate()+s)).setHours(23,59,59))),u=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?u.and(this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1],t.FilterOperators.equal,this.res1[o][this.model.resources[this.model.resources.length-1].resourceSettings.id]):u,l=new t.DataManager(this._processed).executeLocal((new t.Query).where(u)),this._app=n.merge(this._app,l),l.length>0){if(y=[],!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources){for(nt=this.res1[o][this.model.resources[this.model.resources.length-1].resourceSettings.groupId],e=this._resCollection,i=e.length-1;i>0;i--)p=new t.DataManager(e[i-1].dataSource).executeLocal((new t.Query).where(e[i-1].id,t.FilterOperators.equal,nt)),y.push({resId:"resLevel_"+i+"_"+p[0][e[i-1].id],text:p[0][e[i-1].text]}),nt=p[0][e[i-1].groupId];y.reverse()}for(tt=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?!0:!1,pt=l.length,g=this.model.resourceHeaderTemplateId?!0:!1,vt=g?this._getResourceHeadTemplate(this.res1[o]):"",c=0,new Date(f[0])<this.model.minDate&&(c=Math.floor((new Date(this.model.minDate)-new Date(f[0]))/864e5)),new Date(new Date(f[0]).setDate(f[0].getDate()+s))>this.model.maxDate&&(s=s-Math.floor((new Date(new Date(f[0]).setDate(f[0].getDate()+s))-new Date(this.model.maxDate))/864e5));c<=s;c++)if(u=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(new Date(f[0]).setDate(f[0].getDate()+c))),u=u.and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(new Date(f[0]).setDate(f[0].getDate()+c)).setHours(23,59,59))),u=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?u.and(this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1],t.FilterOperators.equal,this.res1[o][this.model.resources[this.model.resources.length-1].resourceSettings.id]):u,r=new t.DataManager(l).executeLocal((new t.Query).where(u)),r.length>0){w.push(w.length+1);var dt=r.length,wt=!0,bt=!1;for(i=0;i<r.length;i++)i==r.length-1&&(bt=!0),rt=this._timeMode=="12"?Globalize.format(r[i][this.model.appointmentSettings.startTime],this._pattern.t):Globalize.format(r[i][this.model.appointmentSettings.startTime],"HH:mm"),ut=this._timeMode=="12"?Globalize.format(r[i][this.model.appointmentSettings.endTime],this._pattern.t):Globalize.format(r[i][this.model.appointmentSettings.endTime],"HH:mm"),ft="<strong class='e-agendaday'>"+Globalize.format(new Date(r[i][this.model.appointmentSettings.startTime]),"dd")+"<\/strong><span class='e-agendaweek'>"+Globalize.format(new Date(r[i][this.model.appointmentSettings.startTime]),"dddd")+"<\/span><span class='e-agendamonth'>"+Globalize.format(new Date(r[i][this.model.appointmentSettings.startTime]),"MMM, yyyy")+"<\/span>",et=r[i][this.model.appointmentSettings.allDay]?"<div class='e-icon e-scheduleallday'><\/div>"+this._getLocalizedLabels("AllDay"):rt+" - "+ut,ot=r[i][this.model.appointmentSettings.recurrence]?"<span class='e-icon e-schedulerepeat' title='"+yt+"'/>"+r[i][this.model.appointmentSettings.subject]:r[i][this.model.appointmentSettings.subject],st=this.model.categorizeSettings.enable&&!t.isNullOrUndefined(r[i][this.model.appointmentSettings.categorize])&&r[i][this.model.appointmentSettings.categorize]!=""?this._getCategorizeColor(r[i]):!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources?this._getResourceColor(r[i]):{appointData:"",appointCustomcss:"",appointtextcolor:""},ht=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this.res1[o][this.model.resources[this.model.resources.length-1].resourceSettings.text]:"",b=this.model.appointmentTemplateId?!0:!1,ct=b?this._getUserAppointmentTemplate(r[i]):"",k=this.model.agendaViewSettings.dateColumnTemplateId?!0:!1,lt=k?this._getUserTemplate(this.model.agendaViewSettings.dateColumnTemplateId,r[i]):"",d=this.model.agendaViewSettings.timeColumnTemplateId?!0:!1,at=d?this._getUserTemplate(this.model.agendaViewSettings.timeColumnTemplateId,r[i]):"",it.push({readOnly:this.model.readOnly,edittext:this._getLocalizedLabels("Edit"),deletetext:this._getLocalizedLabels("Delete"),userResourceId:g,userResourceHtml:vt,userDateId:k,userDateHtml:lt,userTimeId:d,userTimeHtml:at,userAppTemplId:b,userTemplate:ct,resGroup:y,resName:ht,resChild:tt,resRowSpan:pt,id:r[i].AppTaskId,uid:r[i].Guid,dayRowSpan:r.length,dayChild:wt,dayBorderBottom:bt,background:st.appointData,date:ft,time:et,event:ot}),wt=!1,tt=!1}}if(kt=this.agendacellTemp.render({rows:w,cols:it}),this.element.find(".e-draggableworkarea").append(kt),!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources)for(e=this.render_Resources,i=0;i<e.length-1;i++)for(a=0;a<e[i].length;a++)v="resLevel_"+(i+1)+"_"+e[i][a][this._resCollection[i].id],this.element.find("."+v).first().attr("rowspan",this.element.find("."+v).length),this.element.find("."+v).slice(1).addClass("e-hide"),this.element.find(".e-hide").remove(),this.model.resourceHeaderTemplateId&&this.element.find("."+v).children().empty().append(this._getResourceHeadTemplate(e[i][a]));h=n("div#"+this._id+"_scroller");t.isNullOrUndefined(h.data("ejScroller"))&&(h.ejScroller({enableRTL:this.model.enableRTL,height:this.scHeight-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top)-1,width:this.element.width()-2,cssClass:this.model.cssClass}),this._mediaQuery||this._nextPrevAppointment(this.model.enableAppointmentNavigation));h.ejScroller("refresh");h.ejScroller("isVScroll")?this.element.find(".e-emptytd").show()&&this.element.find(".e-draggableworkarea").height(this.element.find(".e-draggableworkarea").height()+1):this.element.find(".e-emptytd").hide();this.element.find(".e-vscroll").css("left",this.model.enableRTL?0:this.element.outerWidth()-(h.ejScroller("isVScroll")?18:0));this.element.find(".e-mobileNavigation").css("left",this.model.enableRTL?h.ejScroller("isVScroll")?18:0:this.element.outerWidth()-36);this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width());this.model.enableAppointmentNavigation&&this._nextPrevButton(this._app)},_getUserTemplate:function(t,i){var r=n.extend(r,i);return r.View=this.currentView(),n.templates(n(t).html()).render(r)},_getColumnCount:function(){for(var t=[],i=this.currentView()==="month"||this._isCustomView()?this._isCustomView()?this._renderDays<=7?this._renderDays:7:7:this._getRenderDates().length,n=0;n<i;n++)t.push(n);return t},_bindAppointmentsData:function(i){t.isNullOrUndefined(this.model.appointmentSettings)||this.dataSource()==null||(this.model.enablePersistence&&(this.model.appointmentSettings.query=new t.Query,this._enablePersist=!0),!this.dataSource()instanceof t.DataManager&&this.dataSource().dataSource.offline&&this._dateFormat(this.dataSource()),this.dataSource()instanceof t.DataManager&&!this.dataSource().dataSource.offline?this._initDataSource(i):(this._angular=!this._bindapp&&!this._setmodelvalue&&this._viewchange==!0&&this.dataSource()[0][this.model.appointmentSettings.id]==this._obj[0][this.model.appointmentSettings.id],this._bindAppointments=this.dataSource().length>0?!0:!1,this._true=this.model.isDST==!0?!0:!1,this._timeZoneOffset=t.isNullOrUndefined(this.model.timeZone)&&this.model.isDST==!1?(new Date).getTimezoneOffset()-this._stdTimezoneOffset():0,this._currentAppointmentData=this.dataSource(),n.extend(!0,this._obj=[],this.dataSource()),!t.isNullOrUndefined(this.dataSource().dataSource)&&this.dataSource().dataSource.json&&(this._currentAppointmentData=this.dataSource().dataSource.json),this._dataCount=this._currentAppointmentData.length,this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll(),this._app.length<1&&this.model.enableAppointmentNavigation&&this._nextPrevButton(this._app),this.tzone=this.model.timeZone,this._bindapp=!1,this._setmodelvalue=!1,this._viewchange=!1))},_initDataSource:function(i){var e=this._columnToSelect(this.model.appointmentSettings,i),f=n.extend(!0,[],e._params),u,r,o;for(e._params=[],e.addParams("CurrentDate",this.currentDate()).addParams("CurrentView",this.currentView()).addParams("CurrentAction",i),u=0;u<f.length;u++)f[u].key!="CurrentDate"&&f[u].key!="CurrentView"&&f[u].key!="CurrentAction"&&e.addParams(f[u].key,f[u].value);r=this;o=this.dataSource().executeQuery(e);o.done(function(n){var i=new Date;r._true=r.model.isDST==!0?!0:!1;r._timeZoneOffset=t.isNullOrUndefined(r.model.timeZone)&&r.model.isDST==!1?i.getTimezoneOffset()-r._stdTimezoneOffset():0;r._dataCount=n.result.length;t.isNullOrUndefined(n.result.result)||(r._dataCount=n.result.count+1,n.result=n.result.result);r._bindAppointments=n.result.length>0?!0:!1;r._currentAppointmentData=n.result;r._overlapList=[];r._dataProcessing(n.result);r._renderAppointmentAll();r._app.length<1&&r.model.enableAppointmentNavigation&&r._nextPrevButton(r._app)})},_bindCategorizeData:function(){t.isNullOrUndefined(this.model.categorizeSettings)||(this._categoryInfo=[],!t.isNullOrUndefined(this.model.categorizeSettings.query)&&this.model.categorizeSettings.query instanceof t.Query||(this.model.categorizeSettings.query=t.Query()),this.model.categorizeSettings.dataSource instanceof t.DataManager?this._initCategorizeData(this.model.categorizeSettings):this._categoryInfo.push(this.model.categorizeSettings))},_initCategorizeData:function(n){var i=this._columnToSelect(n),t=this,r=n.dataSource.executeQuery(i);r.done(function(i){n.dataSource=i.result;t._categoryInfo.push(n);t._renderCategoryItems(t._appointmentAddWindow)})},_bindPriorityData:function(){t.isNullOrUndefined(this.model.prioritySettings)||(this._priorityInfo=[],!t.isNullOrUndefined(this.model.prioritySettings.query)&&this.model.prioritySettings.query instanceof t.Query||(this.model.prioritySettings.query=t.Query()),this.model.prioritySettings.dataSource instanceof t.DataManager?this._initPriorityData(this.model.prioritySettings):this._priorityInfo.push(this.model.prioritySettings))},_initPriorityData:function(n){var i=this._columnToSelect(n),t=this,r=n.dataSource.executeQuery(i);r.done(function(i){n.dataSource=i.result;t._priorityInfo.push(n);t._renderPriorityItems(t._appointmentAddWindow)})},_dateFormat:function(n){if(new Date(n[0][this.model.appointmentSettings.startTime]).toString()=="Invalid Date")for(var t=0;t<n.length;t++)n[t][this.model.appointmentSettings.startTime]=new Date(n[t][this.model.appointmentSettings.startTime]).toString()=="Invalid Date"||new Date(n[t][this.model.appointmentSettings.startTime]).toString()=="NaN"?new Date(parseInt(n[t][this.model.appointmentSettings.startTime].match(/\d+/).toString())):new Date(n[t][this.model.appointmentSettings.startTime]),n[t][this.model.appointmentSettings.endTime]=new Date(n[t][this.model.appointmentSettings.endTime]).toString()=="Invalid Date"?new Date(parseInt(n[t][this.model.appointmentSettings.endTime].match(/\d+/).toString())):new Date(n[t][this.model.appointmentSettings.endTime])},_columnToSelect:function(n){var i=t.Query();return t.isNullOrUndefined(n.tableName)||this.dataSource().dataSource.url.match(n.tableName+"$")?i=n.query:(i=n.query,i.from(n.tableName)),i},_getColumns:function(n){var r=[];for(var i in n)i!=="tableName"&&i!=="query"&&i!=="dataSource"&&(t.isNullOrUndefined(n[i])||r.push(n[i]));return r},_sortAppById:function(n){var t=this;return n.sort(function(n,t){var i=n.AppTaskId,r=t.AppTaskId;return i<r?-1:i>r?1:0}),n},_stdTimezoneOffset:function(){var n=new Date,t=new Date(n.getFullYear(),0,1),i=new Date(n.getFullYear(),6,1);return Math.max(t.getTimezoneOffset(),i.getTimezoneOffset())},_timeZoneCalculate:function(){var r=(new Date).getTimezoneOffset(),f,i,u;if(this.model.timeZone==null)obj=this.model.isDST==!1?-r+this._timeZoneOffset:-r;else if(this.model.timeZone.indexOf(":")!==-1)if(t.isNullOrUndefined(this.tzone)&&(this.tzone=this.model.timeZone),i=this.model.timeZone.indexOf("UTC")!=-1?this.model.timeZone[3]!==" "?this.model.timeZone.split(":"):this.model.timeZone.split(" ")[1].split(":"):this.model.timeZone.split(":"),u=this.tzone.indexOf("UTC")!=-1?this.tzone[3]!==" "?this.tzone.split(":"):this.tzone.split(" ")[1].split(":"):this.tzone.split(":"),n.isNumeric(parseInt(i[0]))&&parseInt(i[0]).toString.length<=2||i[0].indexOf("UTC")!==-1){var o=this.model.timeZone.indexOf("-")!==-1?-parseInt(i[0].replace(/\D/g,"")):parseInt(i[0].replace(/\D/g,"")),s=parseInt(i[1]),e=-(o*60+s);if(this._setmodelvalue==!0){if(this.tzone==this.model.timeZone)f=-r+e;else{var h=this.tzone.indexOf("-")!==-1?-parseInt(u[0].replace(/\D/g,"")):parseInt(u[0].replace(/\D/g,"")),c=parseInt(u[1]),l=-(h*60+c);f=-l+e}obj=-f}else obj=-e}else obj=-r;else obj=-r;return obj},_appointTimeZone:function(n){var i=n[this.model.appointmentSettings.startTimeZone],r=n[this.model.appointmentSettings.endTimeZone],u,f;return n.EndTimeZone=r=t.isNullOrUndefined(r)&&!t.isNullOrUndefined(i)?i:r,n.StartTimeZone=i=!t.isNullOrUndefined(r)&&t.isNullOrUndefined(i)?r:i,t.isNullOrUndefined(i)&&n[this.model.appointmentSettings.startTime]?(u=n[this.model.appointmentSettings.startTime],f=n[this.model.appointmentSettings.endTime],u=n[this.model.appointmentSettings.startTime]+this._timeZoneCalculate(n),f=n[this.model.appointmentSettings.endTime]+this._timeZoneCalculate(n)):t.isNullOrUndefined(i)||i==""&&r==""?i=0:(i=i.indexOf("UTC")!=-1?parseInt(i.split(" ")[1].split(":")[0])*60+parseInt(i.split(" ")[1].split(":")[1]):parseInt(i.split(":")[0])*60+parseInt(i.split(":")[1]),r=r.indexOf("UTC")!=-1?parseInt(r.split(" ")[1].split(":")[0])*60+parseInt(r.split(" ")[1].split(":")[1]):parseInt(r.split(":")[0])*60+parseInt(r.split(":")[1])),i},_timeZoneAppointments:function(n,i){var f,e,u,r;return n[this.model.appointmentSettings.allDay]?n:(t.isNullOrUndefined(this._dayLight)?(localutc=(new Date).getTimezoneOffset(),u=this._appointTimeZone(n),r=t.isNullOrUndefined(u)||u==0&&this.model.appointmentSettings.startTimeZone==null&&this.model.appointmentSettings.endTimeZone==null?this._timeZoneCalculate(n):u-this._timeZoneCalculate(n)):r=this._timeValue,r=i==""?-r:r,f=new Date(n[this.model.appointmentSettings.startTime]),e=new Date(n[this.model.appointmentSettings.endTime]),n[this.model.appointmentSettings.allDay]&&Math.round((new Date(n[this.model.appointmentSettings.endTime])-new Date(n[this.model.appointmentSettings.startTime]))/36e5)<24?n:(n[this.model.appointmentSettings.startTime]=new Date(f.setMinutes(f.getMinutes()+r)),n[this.model.appointmentSettings.endTime]=new Date(e.setMinutes(e.getMinutes()+r)),n))},_dataProcessing:function(n){var u,i,r;if(this._processed=[],this._appMainId=null,n.length>0){for(u=this._sortAppById(n),this._maxId=t.isNullOrUndefined(n[0])||t.isNullOrUndefined(n[0].AppTaskId)?1:n[0].AppTaskId,this.app=!0,i=0;i<n.length;i++)this._bindAppointments==!0&&!this._angular&&t.isNullOrUndefined(this._enablePersist)?(r=this._timeZoneAppointments(n[i],"reverse"),this._appointmentProcessing(r)):this._appointmentProcessing(n[i]);return this._bindAppointments=!1,this._processed=this._sortAppById(this._processed),this._processed}},_guidFormatGenerate:function(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},_RecurrenceAppointment:function(i){var r=new Date(i[this.model.appointmentSettings.startTime]),y=i[this.model.appointmentSettings.endTime].getTimezoneOffset()-i[this.model.appointmentSettings.startTime].getTimezoneOffset(),a=(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/1e3,p=Math.floor((a-y/1e3)/3600),w=Math.floor(a%3600/60),e,f,o,c,l,h,v;if(this._rRule={},_count=0,this._filt=!0,c=!1,i.AppTaskId=t.isNullOrUndefined(i.AppTaskId)?this._maxId:i.AppTaskId,t.isNullOrUndefined(i[this.model.appointmentSettings.recurrence])||t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])||this.recurrenceRuleSplit(i[this.model.appointmentSettings.recurrenceRule],i[this.model.appointmentSettings.recurrenceExDate]),i[this.model.appointmentSettings.recurrence]==1&&t.isNullOrUndefined(this._rRule.recurEditId)){if(e="",f=t.isNullOrUndefined(this._rRule.interval)?1:this._rRule.interval,t.isNullOrUndefined(this._rRule.weekDays)||(e=this._rRule.weekDays.split(",")),t.isNullOrUndefined(this._rRule.until))if(t.isNullOrUndefined(this._rRule.count))recurEndDate=new Date(new Date(this.currentDate()).setDate(r.getDate()+42*f));else switch(this._rRule.freq){case"DAILY":recurEndDate=new Date(new Date(r).setDate(r.getDate()+this._rRule.count*f));break;case"WEEKLY":o=r.getDate()+this._rRule.count/e.length*7*f;recurEndDate=new Date(new Date(r).setDate(Math.round(o)<o?o+1:o));break;case"MONTHLY":recurEndDate=new Date(new Date(r).setMonth(r.getMonth()+this._rRule.count*f));break;case"YEARLY":recurEndDate=new Date(new Date(r).setFullYear(r.getFullYear()+this._rRule.count*f))}else recurEndDate=new Date(this._rRule.until),recurEndDate.setDate(recurEndDate.getDate()+1);switch(this._rRule.freq){case"WEEKLY":e=this._rRule.weekDays.split(",");e.indexOf(this._dayNames[new Date(r).getDay()])==-1&&(r=this._weeklyDayFind(r,e));break;case"MONTHLY":if(t.isNullOrUndefined(this._rRule.monthDay))r=new Date(this._getWeekIndex(r)+1>this._rRule.setPositions&&this._rRule.setPositions!=-1?new Date(r.getFullYear(),r.getMonth()+1,1):r);else for(c=new Date(r).getDate()==new Date(r.getFullYear(),r.getMonth()+1,0).getDate()?!0:!1;new Date(r).getDate()!=this._rRule.monthDay;)r=new Date(r.setDate(r.getDate()+1));break;case"YEARLY":t.isNullOrUndefined(this._rRule.monthDay)?t.isNullOrUndefined(this._rRule.setPositions)||(r=new Date(r.getFullYear(),this._rRule.month-1,r.getDate()),r=new Date(this._getWeekIndex(r)+1>this._rRule.setPositions?new Date(r.getFullYear(),r.getMonth()+1,1):r)):r=r.getMonth()+1>=this._rRule.month&&r.getDate()>this._rRule.monthDay?new Date(r.getFullYear()+1,this._rRule.month-1,this._rRule.monthDay):new Date(r.getFullYear(),this._rRule.month-1,this._rRule.monthDay)}while(r<=recurEndDate){var s=i[this.model.appointmentSettings.startTime],u={},b=i[this.model.appointmentSettings.endTime];this._rRule.freq!="MONTHLY"&&this._rRule.freq!="YEARLY"||t.isNullOrUndefined(this._rRule.setPositions)||(r=this._dayOfWeekInMonth(r,this._rRule.weekDays,this._rRule.setPositions));l=new Date(r.getFullYear(),r.getMonth(),r.getDate(),s.getHours(),s.getMinutes(),0);h=new Date(r.getFullYear(),r.getMonth(),r.getDate(),s.getHours()+p,s.getMinutes()+w,0);this._idChecking();i[this.model.appointmentSettings.recurrenceId]=i.AppTaskId;i.ParentId=i.AppTaskId;i[this.model.appointmentSettings.recurrenceExDate]=i[this.model.appointmentSettings.recurrenceExDate]==null?null:i[this.model.appointmentSettings.recurrenceExDate];t.isNullOrUndefined(this._rRule.exDate)?u=this._addAppData(i,this._maxId,l,h,i.AppTaskId):this._rRule.exDate.indexOf(Globalize.format(new Date(r),this._pattern.d))==-1&&(u=this._addAppData(i,this._maxId,l,h,i.AppTaskId));switch(this._rRule.freq){case"DAILY":r=new Date(r.setDate(r.getDate()+f));break;case"WEEKLY":v=this._dayNames[new Date(r).getDay()];e.length-1!=e.indexOf(v)?r=this._weeklyDayFind(r,e):(r=new Date(r.setDate(r.getDate()+r.getDay()*-1)),r=new Date(r.setDate(r.getDate()+f*7-1)),r=this._weeklyDayFind(r,e));break;case"MONTHLY":r=c?new Date(r.getFullYear(),r.getMonth()+f+1,0):t.isNullOrUndefined(this._rRule.setPositions)?new Date(r.setMonth(r.getMonth()+f)):new Date(r.getFullYear(),r.getMonth()+f,1);break;case"YEARLY":r=new Date(r.setFullYear(r.getFullYear()+f))}if(new Date(new Date(i[this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5<24&&i[this.model.appointmentSettings.allDay]!==!0?(u.Guid=this._guidFormatGenerate(),this._multipleDayApp(u,this._maxId,u[this.model.appointmentSettings.startTime],h)):Math.round((u[this.model.appointmentSettings.endTime]-u[this.model.appointmentSettings.startTime])/36e5)>24?(u.Guid=this._guidFormatGenerate(),this._multipleSplit(u,this._maxId,u[this.model.appointmentSettings.startTime],u[this.model.appointmentSettings.endTime])):n.isEmptyObject(u)||(u.Guid=this._guidFormatGenerate(),this._processed.push(u)),this._maxId++,_count++,!t.isNullOrUndefined(this._rRule.count)&&_count==this._rRule.count)break}}this._filt=!1},_recurrenceAppSort:function(i){for(var e,u,f=[],r=0;r<i.length;r++)e=new t.DataManager(i).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,i[r].Guid)),e.length>1?(u=n.extend(!0,[],e),u[0][this.model.appointmentSettings.endTime]=u[u.length-1][this.model.appointmentSettings.endTime],f.push(u[0]),r++):f.push(i[r]);return f},_appointmentProcessing:function(i){var u;this._maxId=t.isNullOrUndefined(this._appMainId)?parseInt(this._maxId):parseInt(this._appMainId)+1;var e=new Date(i[this.model.appointmentSettings.startTime]),f=(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/1e3,o=Math.floor(f/3600),s=Math.floor(f%3600/60);this._rRule={};_count=0;_lastDay=!1;u={};u=n.extend(!0,{},i);i[this.model.appointmentSettings.recurrence]==1&&t.isNullOrUndefined(this._rRule.recurEditId)&&this._RecurrenceAppointment(i);new Date(new Date(i[this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5<24&&i[this.model.appointmentSettings.allDay]!==!0&&(i[this.model.appointmentSettings.recurrence]&&!t.isNullOrUndefined(this._rRule.recurEditId)||!i[this.model.appointmentSettings.recurrence])?(i[this.model.appointmentSettings.recurrenceId]=i[this.model.appointmentSettings.recurrenceId]==null?null:i[this.model.appointmentSettings.recurrenceId],i[this.model.appointmentSettings.recurrenceExDate]=i[this.model.appointmentSettings.recurrenceExDate]==null?null:i[this.model.appointmentSettings.recurrenceExDate],i.AppTaskId=i.AppTaskId==null?this._maxId:i.AppTaskId,t.isNullOrUndefined(i.ParentId)&&(i.ParentId=i.AppTaskId),i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,this._maxId=i.AppTaskId,this.app=!1,this._multipleDayApp(i,this._maxId,i[this.model.appointmentSettings.startTime],i[this.model.appointmentSettings.endTime])):(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5>24?((i[this.model.appointmentSettings.allDay]===!0||i[this.model.appointmentSettings.allDay]!==!0&&(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5>24)&&i[this.model.appointmentSettings.recurrence]!=1?(this._filt=!0,i.AppTaskId=i.AppTaskId==null?this._maxId:i.AppTaskId,t.isNullOrUndefined(i.ParentId)&&(i.ParentId=i.AppTaskId),i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,this._maxId=i.AppTaskId,this.app=!1,this._multipleSplit(i,this._maxId,i[this.model.appointmentSettings.startTime],i[this.model.appointmentSettings.endTime])):t.isNullOrUndefined(this._rRule.recurEditId)||(t.isNullOrUndefined(i.ParentId)&&(i.ParentId=this._rRule.recurEditId),i.AppTaskId=i.AppTaskId==null?this._maxId:i.AppTaskId,i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,this._maxId=i.AppTaskId,this.app=!1,this._multipleSplit(i,this._maxId,i[this.model.appointmentSettings.startTime],i[this.model.appointmentSettings.endTime])),this._filt=!1):i[this.model.appointmentSettings.recurrence]!=0&&t.isNullOrUndefined(this._rRule.recurEditId)?i[this.model.appointmentSettings.recurrence]!=r&&i[this.model.appointmentSettings.allDay]!=r||i[this.model.appointmentSettings.recurrence]||(i.AppTaskId=i.AppTaskId==null?this._maxId:i.AppTaskId,t.isNullOrUndefined(i.ParentId)&&(i.ParentId=i.AppTaskId),i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,i.RecurrenceId=null,i.recurrenceExDate=null,u=n.extend(!0,{},i),i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,this.app=!1,this._processed.push(i)):(i.AppTaskId=i.AppTaskId==null?this._maxId:i.AppTaskId,t.isNullOrUndefined(i.ParentId)&&(i.ParentId=i.AppTaskId),t.isNullOrUndefined(this._rRule.recurEditId)||(i.ParentId=this._rRule.recurEditId),i[this.model.appointmentSettings.recurrenceId]=i[this.model.appointmentSettings.recurrenceId]==null?i.ParentId:i[this.model.appointmentSettings.recurrenceId],i[this.model.appointmentSettings.recurrenceExDate]=i[this.model.appointmentSettings.recurrenceExDate]==null?null:i[this.model.appointmentSettings.recurrenceExDate],i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,this.app=!1,this._processed.push(i));this._appMainId=t.isNullOrUndefined(this._appMainId)||this._appMainId<this._maxId?this._maxId:this._appMainId},_idChecking:function(){for(var n,i,r=0;r<this._currentAppointmentData.length;r++)if(n=(new t.Query).where("AppTaskId",t.FilterOperators.equal,this._maxId),i=new t.DataManager(this._currentAppointmentData).executeLocal(n),i.length==0||this.app==!0){this._maxId;this.app=!1;break}else this._maxId++;for(;;)if(n=(new t.Query).where("AppTaskId",t.FilterOperators.equal,this._maxId),i=new t.DataManager(this._processed).executeLocal(n),i.length==0||this.app==!0){this._maxId;this.app=!1;break}else this._maxId++;return this._maxId},_multipleDayApp:function(n,t,i,r){var f=new Date(i),e,u,o;for(this.model.orientation=="vertical"||this.model.orientation=="horizontal"&&(i.getDay()==new Date(this._dateRender[this._dateRender.length-1]).getDay()||r.getDay()==new Date(this._dateRender[this._dateRender.length-1]).getDay())?(e=new Date(new Date(i).getFullYear(),new Date(i).getMonth(),new Date(i).getDate()),u=new Date(new Date(e).setHours(new Date(e).getHours()+24)),u=new Date(new Date(u).setMinutes(new Date(u).getMinutes()-1))):u=new Date(r);f>=new Date(i)&&f<=u&&u<=new Date(r);)n[this.model.appointmentSettings.recurrenceId]=n[this.model.appointmentSettings.recurrenceId]==null?null:n[this.model.appointmentSettings.recurrenceId],n[this.model.appointmentSettings.recurrenceExDate]=n[this.model.appointmentSettings.recurrenceExDate]==null?null:n[this.model.appointmentSettings.recurrenceExDate],o=this._addAppData(n,t,f,u,n.ParentId),this._processed.push(o),f=new Date(new Date(u).setMinutes(new Date(u).getMinutes()+1)),u=n[this.model.appointmentSettings.endTime],this._maxId=t=this._idChecking()},_multipleSplit:function(n,t,i,r){var o,l,e,f,s,u,h,c,v,a;for(i=new Date(i),this.currentView()=="workweek"&&(h=new Date(new Date(i).setDate(i.getDate()+1)),c=new Date(new Date(i).setDate(i.getDate()+2)),i=new Date(i).getDay()==0&&this.model.workWeek[0]=="monday"?h:new Date(i).getDay()==6?c:new Date(i)),this.starttime=new Date(this._dateRender[0])<=i||this._filt==!0?new Date(new Date(i).getFullYear(),new Date(i).getMonth(),new Date(i).getDate(),new Date(i).getHours(),new Date(i).getMinutes(),new Date(i).getSeconds()):new Date(this._dateRender[0]),o=new Date(new Date(r).getFullYear(),new Date(r).getMonth(),new Date(r).getDate()),l=0;this.starttime<=o;)if(this.starttime>=o&&!((r-i)/36e5>24)?this._filt=!1:"",e=0,f=this.starttime,this.currentView()!="agenda"&&(this.model.orientation=="horizontal"&&this.currentView()=="month"?e=new Date(f.getFullYear(),f.getMonth()+1,0).getDate()-f.getDate():this.currentView()=="customview"&&(this._renderDays<=7||this.model.orientation=="horizontal")?(this.starttime=new Date(new Date(f).getFullYear(),new Date(f).getMonth(),new Date(f).getDate()),e=this._dateRender.length-1-this._dateRender.indexOf(this.starttime.getTime())):this.currentView()!=="day"&&(this._firstdayofweek==0?e=6-f.getDay():(this._firstdayofweek!=0||this.currentView()=="month")&&(e=6-f.getDay()+this._firstdayofweek))),s=new Date(new Date(this.starttime).getFullYear(),new Date(this.starttime).getMonth(),new Date(this.starttime).getDate()+e),u=new Date(s).getDate()==new Date(o).getDate()&&this.currentView()!=="month"?new Date(new Date(s).setHours(new Date(r).getHours())):new Date(new Date(s).setHours(23)),u=new Date(s).getDate()==new Date(o).getDate()&&this.currentView()!=="month"?new Date(new Date(u).setMinutes(new Date(r.getMinutes()))):new Date(new Date(u).setMinutes(59)),u>=new Date(r)&&this.currentView!=="day"?u=n[this.model.appointmentSettings.endTime]:u.getDay()==6&&this.currentView()=="workweek"||u.getDay()==7&&this.currentView()=="workweek"?(h=new Date(new Date(u).setDate(u.getDate()-2)),c=new Date(new Date(u).setDate(u.getDate()-1)),u=new Date(u).getDay()==6?c:h):(u=u,v=!0),n[this.model.appointmentSettings.recurrenceId]=n[this.model.appointmentSettings.recurrenceId]==null?null:n[this.model.appointmentSettings.recurrenceId],n[this.model.appointmentSettings.recurrenceExDate]=n[this.model.appointmentSettings.recurrenceExDate]==null?null:n[this.model.appointmentSettings.recurrenceExDate],appointment=(n[this.model.appointmentSettings.endTime]-n[this.model.appointmentSettings.startTime])/36e5>24&&n[this.model.appointmentSettings.recurrence]!=1?this._addAppData(n,t,f,u,n.AppTaskId):this._addAppData(n,t,f,u,n.ParentId),this._processed.push(appointment),this._maxId=t=this._idChecking(),l=this.currentView()=="workweek"?3:1,this.starttime=new Date(new Date(u).getFullYear(),new Date(u).getMonth(),new Date(u).getDate()+l),a=this.currentView()=="agenda"?new Date(new Date(new Date(this._dateRender[0]).setDate(this._dateRender[0].getDate()+(this.model.agendaViewSettings.daysInAgenda>0?this.model.agendaViewSettings.daysInAgenda-1:0))).setHours(23,59,59)):new Date(this._dateRender[this._dateRender.length-1]),a<this.starttime&&!this._filt)break},_deleteOcurrence:function(n,i){var c=(new t.Query).where("AppTaskId",t.FilterOperators.equal,n),r=new t.DataManager(this._currentAppointmentData).executeLocal(c),u,l,s,o,e,f,h;if((this._currentAction=="delete"||this._currentAction=="editOcurrence")&&r[0][this.model.appointmentSettings.endTime].getDay()>r[0][this.model.appointmentSettings.startTime].getDay()&&(u=new t.DataManager(this._processed).executeLocal((new t.Query).where(this.model.appointmentSettings.startTime,t.FilterOperators.equal,i)),u=u.length==0?this._objDate:u,l=u,s=u[0].AppTaskId,u=new t.DataManager(this._processed).executeLocal((new t.Query).where("AppTaskId",t.FilterOperators.equal,s))),!t.isNullOrUndefined(r)&&!t.isNullOrUndefined(r[0][this.model.appointmentSettings.recurrenceRule])){if(o=r[0][this.model.appointmentSettings.recurrenceRule],this.recurrenceRuleSplit(o,r[0][this.model.appointmentSettings.recurrenceExDate]),t.isNullOrUndefined(this._rRule.exDate))(this._currentAction=="delete"||this._currentAction=="editOcurrence")&&r[0][this.model.appointmentSettings.endTime].getDay()>r[0][this.model.appointmentSettings.startTime].getDay()?u[0][this.model.appointmentSettings.startTime].getDay()==u[0][this.model.appointmentSettings.endTime].getDay()?(i=u[0][this.model.appointmentSettings.startTime],r[0][this.model.appointmentSettings.recurrenceRule]=o+";EXDATE="+Globalize.format(i,this._pattern.d),r[0][this.model.appointmentSettings.recurrenceExDate]=t.isNullOrUndefined(r[0][this.model.appointmentSettings.recurrenceExDate])?Globalize.format(i,this._pattern.d).toString():r[0][this.model.appointmentSettings.recurrenceExDate]+","+Globalize.format(i,this._pattern.d).toString()):(r[0][this.model.appointmentSettings.recurrenceRule]=o+";EXDATE="+Globalize.format(i,this._pattern.d),r[0][this.model.appointmentSettings.recurrenceExDate]=t.isNullOrUndefined(r[0][this.model.appointmentSettings.recurrenceExDate])?Globalize.format(i,this._pattern.d).toString():r[0][this.model.appointmentSettings.recurrenceExDate]+","+Globalize.format(i,this._pattern.d).toString()):(r[0][this.model.appointmentSettings.recurrenceRule]=o+";EXDATE="+Globalize.format(i,this._pattern.d),r[0][this.model.appointmentSettings.recurrenceExDate]=t.isNullOrUndefined(r[0][this.model.appointmentSettings.recurrenceExDate])?Globalize.format(i,this._pattern.d).toString():r[0][this.model.appointmentSettings.recurrenceExDate]+","+Globalize.format(i,this._pattern.d).toString());else{for(e=o.split(";"),recurRule="",f=0;f<e.length;f++)recurRule!=""&&(recurRule+=";"),h=e[f].replace(/ /g,"").split("="),h[0]=="EXDATE"&&((this._currentAction=="delete"||this._currentAction=="editOcurrence")&&r[0][this.model.appointmentSettings.endTime].getDay()>r[0][this.model.appointmentSettings.startTime].getDay()?u[0][this.model.appointmentSettings.startTime].getDay()==u[0][this.model.appointmentSettings.endTime].getDay()?(i=u[0][this.model.appointmentSettings.startTime],e[f]=e[f]+","+Globalize.format(i,this._pattern.d)):e[f]=e[f]+","+Globalize.format(i,this._pattern.d):e[f]=e[f]+","+Globalize.format(i,this._pattern.d)),recurRule+=e[f];r[0][this.model.appointmentSettings.recurrenceRule]=recurRule;r[0][this.model.appointmentSettings.recurrenceExDate]=t.isNullOrUndefined(r[0][this.model.appointmentSettings.recurrenceExDate])?Globalize.format(i,this._pattern.d).toString():r[0][this.model.appointmentSettings.recurrenceExDate]+","+Globalize.format(i,this._pattern.d).toString()}return r}},_getWeekIndex:function(n){var i=0,t=new Date(n.getFullYear(),n.getMonth(),1),r=n.getDay();if(r!=t.getDay())do t=new Date(t.setDate(t.getDate()+1));while(r!=t.getDay());while(t.getDate()!=n.getDate())t=new Date(t.setDate(t.getDate()+7)),i++;return i},_addAppData:function(i,r,u,f,e){var s={},o,h;for(o in this.model.appointmentSettings)if(o!="dataSource"&&o!="query"&&o!="tableName"&&o!="resourceFields"&&(s[this.model.appointmentSettings[o]]=i[this.model.appointmentSettings[o]]),o=="resourceFields")for(h in!t.isNullOrUndefined(this.model.appointmentSettings.resourceFields)&&this.model.appointmentSettings.resourceFields.split(","))s[this.model.appointmentSettings.resourceFields.split(",")[h]]=i[this.model.appointmentSettings.resourceFields.split(",")[h]];return t.isNullOrUndefined(r)||(s.AppTaskId=r),t.isNullOrUndefined(u)||(s[this.model.appointmentSettings.startTime]=u),t.isNullOrUndefined(f)||(s[this.model.appointmentSettings.endTime]=f),t.isNullOrUndefined(e)||(s.ParentId=e),n.extend({},i,s)},_dayOfWeekInMonth:function(n,t,i){for(var u=this._dayNames.indexOf(t),r=i==-1?new Date(n.getFullYear(),n.getMonth()+1,0):new Date(n.getFullYear(),n.getMonth(),1);r.getDay()!=u;)r=new Date(i==-1?r.setDate(r.getDate()-1):r.setDate(r.getDate()+1));return new Date(i==1||i==-1?r:r.setDate(r.getDate()+(i-1)*7))},_weeklyDayFind:function(n,t){var i=n,r;do i=new Date(i.setDate(i.getDate()+1)),r=this._dayNames[new Date(i).getDay()];while(t.indexOf(r)==-1);return i},_renderAppointments:function(){var u=this._dateRender,f,t,n,r,i;for(this._tempapp=[],this._app=[],f=1,this.level=0,this.cellwidth=this.element.find(".e-workcells").width(),this.leftPosition=0,this._filtered=[],this.model.group||(this.res1=["0"]),this.resIndex=0,t=0;t<this.res1.length;t++)for(n=0,i=u.length,new Date(this._dateRender[0])<this.model.minDate&&(n=Math.floor((new Date(this.model.minDate)-new Date(this._dateRender[0]))/864e5)),new Date(this._dateRender[this._dateRender.length-1])>this.model.maxDate&&(r=Math.floor((new Date(this._dateRender[this._dateRender.length-1])-new Date(this.model.maxDate))/864e5),i=this._dateRender.length-r),n;n<i;n++)this._getDayAppointments(n,t)},_findAllDayApp:function(n){if(n[this.model.appointmentSettings.allDay]!=!0){var i=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,n.Guid));return t.isNullOrUndefined(i[0])?!1:(i[0][this.model.appointmentSettings.endTime]-i[0][this.model.appointmentSettings.startTime])/36e5>24?!0:!1}},_getDayAppointments:function(i,r){var c,f,l,o,a,h,v;this._appList=[];var e=this._dateRender,u=this._processed,y=t.Predicate(this.model.appointmentSettings.endTime,t.FilterOperators.greaterThanOrEqual,new Date(e[i])).and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(e[i]).setHours(23,59,59))),p=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(e[i])).and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(e[i]).setHours(23,59,59))),s=y.or(p);if(s=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?s.and(this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1],t.FilterOperators.equal,this.res1[r][this.model.resources[this.model.resources.length-1].resourceSettings.id]):s,u=new t.DataManager(u).executeLocal((new t.Query).where(s)),c=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(e[i])),u=new t.DataManager(u).executeLocal((new t.Query).where(c)),this._appList=this._alldaySort(u),u=this._appointmentSort(u),this._app=n.merge(this._app,u),this.model.orientation=="vertical")for(f=0;f<u.length;f++)l=(u[f][this.model.appointmentSettings.endTime]-u[f][this.model.appointmentSettings.startTime])/36e5>=24,o=u[f][this.model.appointmentSettings.allDay],new Date(new Date(e[i]).setHours(0,0,0,0)).getTime()==new Date(new Date(u[f][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&o||l?(this._setAllDayPos(u[f],i,r),this._filtered.push(u[f])):new Date(new Date(u[f][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(e[i]).setHours(0,0,0,0)).getTime()&&new Date(new Date(u[f][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()>=new Date(new Date(e[i]).setHours(0,0,0,0)).getTime()&&new Date(new Date(u[f][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()==new Date(new Date(u[f][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(t.isNullOrUndefined(o)||o==""?!1:o===!0?!0:o.toLowerCase()==="false"?!1:o)===!1&&new Date(new Date(u[f][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(u[f][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(a=(new t.Query).where("Guid",t.FilterOperators.equal,u[f].Guid),h=new t.DataManager(this._processed).executeLocal(a),o||(v=this._findAllDayApp(u[f])),v||h[0][this.model.appointmentSettings.allDay]&&Math.round((new Date(h[0][this.model.appointmentSettings.endTime])-new Date(h[0][this.model.appointmentSettings.startTime]))/36e5)>=24?(this._setAllDayPos(u[f],i,r),this._filtered.push(u[f])):(this._renderApp(u[f],i,r),this._filtered.push(u[f])));else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._getHorizontalDayAppointments(u,e,i,r)},_startUtc:function(n){!t.isNullOrUndefined(this.startutcValue)&&t.isNullOrUndefined(this.tempValue)?this._utcValue(n,"startUtc"):n.model.value==""?"":n.model.value==this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList("model.value")&&this._appointmentAddWindow.find("#"+this._id+"startTimeZone").attr("aria-expanded")=="true"?this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList("option",{text:n.text,value:n.value}):this._appointmentAddWindow.find("#"+this._id+"endTimeZone").val(n.text)},_endUtc:function(n){this._appointmentAddWindow.find("#"+this._id+"endTimeZone").attr("aria-expanded")=="true"?this._utcValue(n,"endUtc"):""},_utcValue:function(n,i){var c,p,w,b,a,h;Globalize.culture(this.model.locale);i=="endUtc"?this._appointmentAddWindow.find(".endutc").val(n.text):"";var f=new Date(Globalize.format(this._appointmentAddWindow.find("#"+this._id+"startdate").val(),this._datepattern())+" "+Globalize.format(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("model.value"))),e=new Date(Globalize.format(this._appointmentAddWindow.find("#"+this._id+"enddate").val(),this._datepattern())+" "+Globalize.format(this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("model.value"))),v=new Date(f),k=new Date(e),u=i=="Appoint"?this.endTimeAppoint:i=="endUtc"?n.value:this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList("model.value"),r=i=="Appoint"?this.startTimeAppoint:i=="startUtc"?n.value:this._appointmentAddWindow.find("#"+this._id+"startTimeZone").ejDropDownList("model.value");if(r=r==""?this._timezoneStringValue():r,u=u==""?this._timezoneStringValue():u,u=u.indexOf("UTC")!=-1?parseInt(u.split(" ")[1].split(":")[0])*60+parseInt(u.split(" ")[1].split(":")[1]):parseInt(u.split(":")[0])*60+parseInt(u.split(":")[1]),r=r.indexOf("UTC")!=-1?parseInt(r.split(" ")[1].split(":")[0])*60+parseInt(r.split(" ")[1].split(":")[1]):parseInt(r.split(":")[0])*60+parseInt(r.split(":")[1]),c=u-r,f=new Date(f.setMinutes(f.getMinutes()+c)),i=="Appoint"){var y=new Date(n.StartTime),s=new Date(n.EndTime),l=t.isNullOrUndefined(this.model.timeZone)?-(new Date).getTimezoneOffset()+this._timeZoneOffset:this.model.timeZone.indexOf("UTC")!=-1?parseInt(this.model.timeZone.split(" ")[1].split(":")[0])*60+parseInt(this.model.timeZone.split(" ")[1].split(":")[1]):parseInt(this.model.timeZone.split(":")[0])*60+parseInt(this.model.timeZone.split(":")[1]),o=r==l?0:l-r;o=new Date(y.setMinutes(y.getMinutes()-o));p=this._timeMode=="12"?Globalize.format(new Date(o),this._pattern.t):Globalize.format(new Date(o),"HH:mm");this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker({value:Globalize.format(new Date(o),this._datepattern())});w=u-l;this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker({value:p})}e=i=="endUtc"||i=="Appoint"?new Date(v.setMinutes(v.getMinutes()+c)):f;e=i=="Appoint"?new Date(s.setMinutes(s.getMinutes()+w)):e;b=this._timeMode=="12"?Globalize.format(new Date(f),this._pattern.t):Globalize.format(new Date(f),"HH:mm");i=="Appoint"?h=this._timeMode=="12"?Globalize.format(new Date(s),this._pattern.t):Globalize.format(new Date(s),"HH:mm"):(a=new Date(e.setMinutes(e.getMinutes()+30)),h=this._timeMode=="12"?Globalize.format(new Date(a),this._pattern.t):Globalize.format(new Date(a),"HH:mm"));this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker({value:Globalize.format(new Date(e),this._datepattern())});i=="Appoint"?this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker({value:h}):this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker({value:h});this.startutcValue=1},_rowHandlesOver:function(t){this.model.enableAppointmentResize&&n(t.target).addClass("e-rowcursor")},_colHandlesOver:function(t){this.model.enableAppointmentResize&&n(t.target).addClass("e-columncursor")},_renderApp:function(r,u,f){var a=this.element.find(".e-workcells").outerHeight(),c=parseInt(this.model.startHour)<parseInt(this.model.endHour)?parseInt(this.model.startHour):0,l=parseInt(this.model.startHour)<parseInt(this.model.endHour)?parseInt(this.model.endHour):24,v=this._dateRender,e=r[this.model.appointmentSettings.startTime],s=r[this.model.appointmentSettings.endTime],nt,h,y,ot,b,k,tt,it,o,rt,st,d,g,p,ut,ft,et;if(new Date(e).getHours()<c&&(nt=new Date(e),nt.setHours(c,e.getMinutes(),e.getSeconds()),e=new Date(nt)),this.model.orientation=="vertical"){if(ot=parseInt(b*60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount),e<=s&&new Date(v[0]).getTime()<=e.getTime()&&new Date(new Date(v[v.length-1]).setHours(23,59,59))>=e.getTime()&&(b=new Date(e).getHours()<c?new Date(e).getHours()+-new Date(e).getHours()+-new Date(e).getMinutes():new Date(e).getHours()+-c,k=new Date(s).getHours()>l?new Date(s).getHours()+(-new Date(s).getHours()+(l-c))+-new Date(s).getMinutes():new Date(s).getHours()+-c,k=new Date(s).getHours()==l?new Date(k).getMinutes()+-new Date(s).getMinutes():k,l<=s.getHours()?(tt=new Date(s.setHours(l,00,00)),y=parseFloat(new Date(tt).getHours()*60+new Date(tt).getMinutes()-(new Date(e).getHours()*60+new Date(e).getMinutes()))*a*this.model.timeScale.minorSlotCount/60-3):(y=parseFloat(new Date(new Date(s).getTime())-new Date(new Date(e).getTime()))/6e4*a*this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot-2,r[this.model.appointmentSettings.endTime].getTimezoneOffset()-r[this.model.appointmentSettings.startTime].getTimezoneOffset()!=0&&(y=y-a*this.model.timeScale.minorSlotCount)),it=(parseFloat(new Date(r[this.model.appointmentSettings.startTime]).getHours()*60+new Date(e).getMinutes()+new Date(e).getSeconds()/60)-parseInt(b*60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)-this.model.startHour*60)*a*(this.model.timeScale.minorSlotCount/this.model.timeScale.majorSlot),this.model.startHour<=new Date(e).getHours())){if(o=this._overlapApp(r.AppTaskId,r[this.model.appointmentSettings.startTime],r[this.model.appointmentSettings.endTime],null),rt=t.Predicate(this.model.appointmentSettings.allDay,t.FilterOperators.contains,!1),o=new t.DataManager(o).executeLocal((new t.Query).where(rt)),st=this,o.length>1){for(o=this._appointmentSort(o),d=1,g=!1,i=0;i<o.length;i++){for(p=i+1;p<o.length;p++)new Date(o[i][this.model.appointmentSettings.endTime])>new Date(o[p][this.model.appointmentSettings.startTime])&&new Date(o[i][this.model.appointmentSettings.startTime])<new Date(o[p][this.model.appointmentSettings.endTime])&&(g=!0);g==!0&&(d=d+1,g=!1)}ut=o.indexOf(r);h=100/d+2;this.currentView()==="day"||this.currentView()=="customview"&&this._renderDays==1?h-=7:h;this.leftPosition=100/o.length*ut+"%"}else this.leftPosition="0",h=95;h=this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()=="customview"&&this._renderDays<=7?h-10+"%":h+"%";var w=this._appointmentColor(r),ht=this.model.appointmentTemplateId?!0:!1,ct=this._getUserAppointmentTemplate(r),lt=this._timeMode=="12"?Globalize.format(r[this.model.appointmentSettings.startTime],this._pattern.t):Globalize.format(r[this.model.appointmentSettings.startTime],"HH:mm"),at=this._timeMode=="12"?Globalize.format(r[this.model.appointmentSettings.endTime],this._pattern.t):Globalize.format(r[this.model.appointmentSettings.endTime],"HH:mm");t.isNullOrUndefined(r[this.model.appointmentSettings.recurrenceRule])||(ft=r[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1);et=this.appTemplate.render({id:r.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),appHeight:y,rtl:this.model.enableRTL,subject:r[this.model.appointmentSettings.subject],startTime:lt,endTime:at,left:this.leftPosition,top:it,appWidth:h,userAppTemplId:ht,userTemplate:ct,appClass:"e-appointment",appointData:w.appointColor.appointData,appointCustomcss:w.appointColor.appointCustomcss,appointtextcolor:w.appointColor.appointtextcolor,value:w.value,multiDiv:w.multiDiv,orientation:this.model.orientation,priority:this.model.prioritySettings.enable?r[this.model.appointmentSettings.priority]:"",enablePriority:this.model.prioritySettings.template,priorityTemplate:this.model.prioritySettings.template?this._priorityTemplate(r):r[this.model.appointmentSettings.priority],uid:r.Guid,recurrence:r[this.model.appointmentSettings.recurrence],recurrenceEdit:ft});n(this.element.find("div.e-appointwrapper")[parseInt(b*60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))*v.length*this.res1.length+u+v.length*f]).append(et)}}else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&this._renderHorizontalApp(e,s,r,u,a,this.model.timeScale.minorSlotCount,c,l)},_priorityTemplate:function(n){return this.model.prioritySettings.template.replace("{","").replace("$","").replace("}","").replace(this.model.prioritySettings.template.indexOf("value")!=-1?this.model.prioritySettings.value:this.model.prioritySettings.text,n[this.model.appointmentSettings.priority])},_getUserAppointmentTemplate:function(t){var r=n.templates(n(this.model.appointmentTemplateId).html()),i=n.extend(i,t);return i.View=this.currentView(),r.render(i)},_getUserTimeCellsTemplate:function(){for(var t,f=n.templates(n(this.model.timeScale.minorSlotTemplate).html()),r,u=[],i=this.model.startHour;i<this.model.endHour;){for(t=0;t<60;)t=t*6e4,r=f.render(object={date:new Date(new Date(this._dateRender[0]).setHours(i,0,0,t))}),u.push({time:r.trim(),id:i+"_"+t}),t=t/6e4+this.model.timeScale.majorSlot;i=this.model.timeScale.majorSlot>60?i+this.model.timeScale.majorSlot/60:i+1}return u},_overlapApp:function(n,i,r,u){var e,f;if(this.overlapList=[],this._appList=this._appointmentSort(this._appList),this.model.orientation=="vertical")for(f=0;f<this._appList.length;f++)e=this._findAllDayApp(this._appList[f]),new Date(this._appList[f][this.model.appointmentSettings.endTime])>new Date(i)&&new Date(this._appList[f][this.model.appointmentSettings.startTime])<new Date(r)&&new Date(new Date(this._appList[f][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()===new Date(new Date(i).setHours(0,0,0,0)).getTime()&&!e&&this.overlapList.push(this._appList[f]);else if(this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal)for(f=0;f<this._appList.length;f++)t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)?new Date(this._appList[f][this.model.appointmentSettings.endTime])>new Date(i)&&new Date(this._appList[f][this.model.appointmentSettings.startTime])<=new Date(r)&&this._appList[f][this.model.resources[this.model.resources.length-1].field]==u&&new Date(new Date(this._appList[f][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()===new Date(new Date(i).setHours(0,0,0,0)).getTime()&&this.overlapList.push(this._appList[f]):new Date(this._appList[f][this.model.appointmentSettings.endTime])>new Date(i)&&new Date(this._appList[f][this.model.appointmentSettings.startTime])<=new Date(r)&&new Date(new Date(this._appList[f][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()===new Date(new Date(i).setHours(0,0,0,0)).getTime()&&this.overlapList.push(this._appList[f]);return this.overlapList},_getOverlapCount:function(n,i,r,u){var v=[],d=r.length,f=this._processed,p=t.Predicate(this.model.appointmentSettings.endTime,t.FilterOperators.greaterThanOrEqual,new Date(r[i])).and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(r[i]).setHours(23,59,59))),w=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(r[i])).and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(r[i]).setHours(23,59,59))),b=p.or(w),e,h,c,k,l,s,a,y;f=new t.DataManager(f).executeLocal((new t.Query).where(b));f=this._appointmentSort(f);var g=new Date(r[i]),nt=new Date(new Date(r[i]).setHours(23,59,59)),o=[];if(this.model.orientation=="vertical"&&t.isNullOrUndefined(this.model.group))for(e=0;e<f.length;e++)h=(f[e][this.model.appointmentSettings.endTime]-f[e][this.model.appointmentSettings.startTime])/36e5>=24,c=f[e][this.model.appointmentSettings.allDay],(new Date(new Date(r[i]).setHours(0,0,0,0)).getTime()==new Date(new Date(f[e][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&c||h)&&o.push(f[e]);else if(t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)&&this.model.orientation=="vertical")for(e=0;e<f.length;e++)h=(f[e][this.model.appointmentSettings.endTime]-f[e][this.model.appointmentSettings.startTime])/36e5>=24,c=f[e][this.model.appointmentSettings.allDay],f[e][this.model.resources[this.model.resources.length-1].field]==u&&(new Date(new Date(r[i]).setHours(0,0,0,0)).getTime()==new Date(new Date(f[e][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&c||h)&&o.push(f[e]);else this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(o=this._getHorizontalOverlapCount(f,r,i,n,u));for(k=this,o=this._sortAppById(o),o=this._appointmentSort(o),l=-1,s=0;s<o.length;s++)if(a=this.element.find("[guid="+o[s].Guid+"]").height(),a=t.isNullOrUndefined(a)?!1:!0,a&&(this._appointmentLevel(o[s]),v.push(this.appLevel)),o[s].Guid==n.Guid){y=v.length>0?this._smallestMissingNumber(v):-1;l=o.length==1?s:y;break}return l==-1?0:l},_smallestMissingNumber:function(n){var i,t;if(n.length==0)return 0;for(i=Math.max.apply(Math,n),t=0;t<i;t++)if(n.indexOf(t)==-1)return t;return i+1},_appointmentLevel:function(n){var i=this.element.find("[guid="+n.Guid+"]").css("height"),r=this.element.find("[guid="+n.Guid+"]").css("top"),u;return this.model.orientation=="vertical"&&(u=t.isNullOrUndefined(this.model.resources)?this.currentView()=="month"||this._isCustomView()&&!this._oneWeek?0:this.element.find(".e-dateheader").outerHeight()+1:this.currentView()=="month"||this._isCustomView()&&!this._oneWeek?0:!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.group.resources)?this.model.group.resources.length>1?this.element.find(".e-headerbar").outerHeight()+this.element.find(".e-dateheader").outerHeight()*this.model.group.resources.length+1:this.element.find(".e-headerbar").outerHeight()+this.element.find(".e-dateheader").outerHeight()+1:this.element.find(".e-headerbar").outerHeight()+this.element.find(".e-dateheader").outerHeight()+1),this.appLevel=this.model.orientation=="vertical"?this.currentView()=="month"||this._isCustomView()&&!this._oneWeek?Math.round(parseInt(r)/parseInt(i)):Math.round((parseInt(r)-u)/parseInt(i)):Math.round(parseInt(r)/parseInt(i)),this.appLevel},_setAllDayPos:function(i,u,f){var tt,h,w;this.overlapList=[];var s=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this._getOverlapCount(i,u,this._dateRender,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):this._getOverlapCount(i,u,this._dateRender,null),o=i[this.model.appointmentSettings.startTime],e=i[this.model.appointmentSettings.endTime];if(new Date(o)<=new Date(e)){var l=this._dateRender,b,k=0,a=16,d=19,nt=new Date(l[0]),v=new Date(l[l.length-1]);v.setHours(23,59,59);e=new Date(e)>new Date(v)?v:e;tt=Math.ceil((new Date(o)-new Date(nt))/864e5);h=this.currentView()=="week"||this.currentView()=="day"||this.currentView()=="workweek"&&o.getDay()==e.getDay()?Math.ceil((new Date(new Date(e).setHours(23,59,59))-new Date(new Date(o).setHours(0,0,0)))/864e5):e.getDay()==6&&this.currentView()=="workweek"&&this._firstdayofweek!=0?n.inArray(new Date(e.getFullYear(),e.getMonth(),e.getDate()-1).getTime(),this._dateRender)+1:e.getDay()==0&&this.currentView()=="workweek"&&this._firstdayofweek!=0?n.inArray(new Date(e.getFullYear(),e.getMonth(),e.getDate()-2).getTime(),this._dateRender)+2:n.inArray(new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),this._dateRender)-n.inArray(new Date(o.getFullYear(),o.getMonth(),o.getDate()).getTime(),this._dateRender)+1;h<=0&&(h=1);var it=this.element.find(".e-alldaycells").width(),y=this.currentView()==="week"?7:this.currentView()==="workweek"?this.model.workWeek.length:this.currentView()=="customview"&&this._renderDays<=7?this._renderDays:1,rt=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.model.group.resources.length:0,ut=new Date(new Date(o).getFullYear(),new Date(o).getMonth(),new Date(o).getDate()),p=this.currentView()==="day"?0:this.currentView()==="workweek"&&this._firstdayofweek==0&&this.model.workWeek[0]=="Monday"&&this.model.workWeek[4]=="Friday"?new Date(o).getDay()-1:this._firstdayofweek||this.model.workWeek.length>0||this.currentView()=="customview"&&(this._renderDays<=7||this.model.orientation=="horizontal")?this._dateRender.indexOf(ut.getTime()):new Date(o).getDay();t.isNullOrUndefined(this.element.find(".e-alldaycells")[p+f*y])||(k=this.model.enableRTL?this.element.find(".e-headrealldaytable").width()-this.element.find(".e-alldaycells")[p+f*y].offsetLeft-this.element.find(".e-alldaycells").width():this.element.find(".e-alldaycells")[p+f*y].offsetLeft);b=h*it+h-2;a=s*a+3*(s+1)+this.element.find(".e-headercells").height()+1+rt*this.element.find(".e-headerbar").first().height();var c=this._appointmentColor(i),ft=this.model.appointmentTemplateId?!0:!1,et=this._getUserAppointmentTemplate(i),ot=this._timeMode=="12"?Globalize.format(i[this.model.appointmentSettings.startTime],this._pattern.t):Globalize.format(i[this.model.appointmentSettings.startTime],"HH:mm"),st=this._timeMode=="12"?Globalize.format(i[this.model.appointmentSettings.endTime],this._pattern.t):Globalize.format(i[this.model.appointmentSettings.endTime],"HH:mm"),ht=this.appTemplate.render({id:i.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),top:a,appHeight:d,rtl:this.model.enableRTL,subject:i[this.model.appointmentSettings.subject],startTime:ot,endTime:st,appWidth:b+"px",allday:!0,left:k+"px",userAppTemplId:ft,userTemplate:et,appClass:"e-alldayappointment",appointData:c.appointColor.appointData,appointCustomcss:c.appointColor.appointCustomcss,appointtextcolor:c.appointColor.appointtextcolor,value:c.value,multiDiv:c.multiDiv,orientation:this.model.orientation,priority:this.model.prioritySettings.enable?i[this.model.appointmentSettings.priority]:"",enablePriority:this.model.prioritySettings.template,priorityTemplate:this.model.prioritySettings.template?this._priorityTemplate(i):i[this.model.appointmentSettings.priority],uid:i.Guid,recurrence:i[this.model.appointmentSettings.recurrence]});this.level<=s&&(w=(s+1)*d+27,this._mediaQuery?(this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd,.e-schedulesettings").attr("style","height:"+(s==0?40:w)+"px !important"),this.model.enableRTL?this.element.find(".e-alldaycells").first().css("border-right","none"):this.element.find(".e-alldaycells").first().css("border-left","none")):this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd,.e-schedulesettings").css("height",w+"px"));this.element.find(".e-headrealldaytable").append(ht)}if(this._reRenderScroller(),this._alldayLevel=!1,this.level=this.level<s?s:this.level,i[this.model.appointmentSettings.recurrence]!=1){var ct=i[this.model.appointmentSettings.recurrence]==r||i.ParentId==r?i.AppTaskId:i.ParentId,lt=(new t.Query).where("AppTaskId",t.FilterOperators.equal,parseInt(ct)),at=this._currentAppointmentData,g=new t.DataManager(at).executeLocal(lt);new Date(i[this.model.appointmentSettings.endTime])<g[0][this.model.appointmentSettings.endTime]&&(this.model.enableRTL?this.element.find("[guid="+i.Guid+"]").children(".e-lefthandle").remove():this.element.find("[guid="+i.Guid+"]").children(".e-righthandle").remove());new Date(i[this.model.appointmentSettings.startTime])>g[0][this.model.appointmentSettings.startTime]&&(this.model.enableRTL?this.element.find("[guid="+i.Guid+"]").children(".e-righthandle").remove():this.element.find("[guid="+i.Guid+"]").children(".e-lefthandle").remove())}},_reRenderScroller:function(){var i=this._appointmentAddWindow.data("ejDialog"),f,e;i.option("enableAnimation",!1);i.close();var o=n("div#"+this._id+"_scroller"),r=this.element.find(".e-scroller").data("ejScroller"),u=typeof innerWidth=="number"&&window.innerWidth>document.documentElement.clientWidth,s=this.model.orientation==="vertical"?(u&&this._mediaQuery?this.element.outerWidth()+17:this.element.outerWidth())-(this._mediaQuery&&this.currentView()=="month"?"":this.element.find(".e-scrolltimecells").parent().outerWidth()):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.element.width()-this.element.find(".e-resourceheadertable").width():this.element.width();r.model.width=s-2;r.model.height=this.scHeight-1-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top);r.refresh();this.model.cellWidth!=""&&(f=this.currentView()=="workweek"?this.model.workWeek.length:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,e=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1.length*f:f,this.element.find(".e-draggableworkarea").width(this.element.width()>(parseInt(this.model.cellWidth)+1)*e+this.element.find(".e-scrolltimecells").parent().width()+(o.ejScroller("isVScroll")?18:0)?(parseInt(this.model.cellWidth)+1)*e-1:s-2-(o.ejScroller("isVScroll")?18:0)),this.element.find(".e-headeralldaydiv").width(this.element.find(".e-draggableworkarea").width()));this.element.find(".e-headeralldaydiv").width(this.element.find(".e-draggableworkarea").width());this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px");this.element.find(".e-emptytd").length<1&&this.model.orientation=="vertical"?this.aTR.find(".e-headeralldaydiv").parent().next().append(this.element.find(".e-vscroll").length>0?this._emptyCell():""):"";this.element.find(".e-emptyalldaytd").height(this.element.find(".e-alldaycells").height());this._mediaQuery&&this._appointmentAddWindow.ejDialog("close");u&&this._mediaQuery&&this.element.find(".e-draggableworkarea").width(u?this.element.find(".e-draggableworkarea").width()-17:this.element.find(".e-draggableworkarea").width());i.option("enableAnimation",!0)},_appointmentSort:function(n){var t=this;return this.currentView()!="day"?n.sort(function(n,i){var f=n[t.model.appointmentSettings.endTime]-n[t.model.appointmentSettings.startTime],e=i[t.model.appointmentSettings.endTime]-i[t.model.appointmentSettings.startTime],o=new Date(n[t.model.appointmentSettings.startTime]).setHours(0,0,0,0),s=new Date(i[t.model.appointmentSettings.startTime]).setHours(0,0,0,0),h=new Date(n[t.model.appointmentSettings.endTime]).setHours(0,0,0,0),c=new Date(i[t.model.appointmentSettings.endTime]).setHours(0,0,0,0),r=n[t.model.appointmentSettings.startTime],u=i[t.model.appointmentSettings.startTime];return o==s&&h==c?t.currentView()=="month"||n[t.model.appointmentSettings.allDay]===!0&&i[t.model.appointmentSettings.allDay]===!0||t._isCustomView()&&!t._oneWeek||f>=864e5&&e>=864e5?r-u||n.Guid.localeCompare(i.Guid):e-f||r-u||n.Guid.localeCompare(i.Guid):o==s?e-f||r-u||n.Guid.localeCompare(i.Guid):r-u||n.Guid.localeCompare(i.Guid)}):n.sort(function(n,i){var r=n[t.model.appointmentSettings.startTime],u=i[t.model.appointmentSettings.startTime],f=n[t.model.appointmentSettings.endTime]-n[t.model.appointmentSettings.startTime],e=i[t.model.appointmentSettings.endTime]-i[t.model.appointmentSettings.startTime];return r-u||e-f||n.Guid.localeCompare(i.Guid)}),n},_alldaySort:function(n){for(var i=this,r=[],t=0;t<n.length;t++)(new Date(n[t][i.model.appointmentSettings.endTime])-new Date(n[t][i.model.appointmentSettings.startTime]))/36e5<24&&!n[t][i.model.appointmentSettings.allDay]&&r.push(n[t]);return r},_appointmentRecurrenceSort:function(n){var t=this;return n.sort(function(n,i){var r=n[t.model.appointmentSettings.startTime],u=i[t.model.appointmentSettings.startTime];return r-u}),n},_renderMonthAppointment:function(){var h,r,i,e,o,f,l,c,s,a,u,v;for(this.filterData=[],h=[],this._app=[],r=this.model.orientation=="vertical"?this._dateRender:this.monthDays,i=this._processed,i=this._sortAppById(i),i=this._appointmentSort(i),e=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(r[0])),e=e.and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(r[r.length-1]).setHours(23,59,59))),this._appointmentsList=new t.DataManager(i).executeLocal((new t.Query).where(e)),i=this._appointmentsList,this.model.group||(this.res1=["0"]),o=0;o<this.res1.length;o++)for(f=0,c=r.length,new Date(r[0])<this.model.minDate&&(f=Math.floor((new Date(this.model.minDate)-new Date(r[0]))/864e5)),new Date(r[r.length-1])>this.model.maxDate&&(l=Math.floor((new Date(r[r.length-1])-new Date(this.model.maxDate))/864e5),c=r.length-l),f;f<c;f++)for(this.filterData=[],s=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(r[f])),s=s.and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(r[f]).setHours(23,59,59))),s=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?e.and(this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1],t.FilterOperators.equal,this.res1[o][this.model.resources[this.model.resources.length-1].resourceSettings.id]):e,i=new t.DataManager(this._appointmentsList).executeLocal((new t.Query).where(s)),a=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(r[f])),i=new t.DataManager(i).executeLocal((new t.Query).where(a)),i=this._appointmentSort(i),this._app=n.merge(this._app,i),u=0;u<i.length;u++)v=this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1?new t.DataManager(this.model.resources[this.model.resources.length-1].resourceSettings.dataSource).executeLocal((new t.Query).where("groupId",t.FilterOperators.equal,parseInt(i[u][this.model.appointmentSettings.resourceFields.split(",")[this.model.appointmentSettings.resourceFields.split(",").length-2]]))):this.res1,v.length!=0&&(i[u][this.model.appointmentSettings.allDay]==!0||(new Date(i[u][this.model.appointmentSettings.endTime])-new Date(i[u][this.model.appointmentSettings.startTime]))/36e5>24?new Date(new Date(r[f]).setHours(0,0,0,0)).getTime()==new Date(new Date(i[u][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(r[f]).setHours(0,0,0,0)).getTime()<=new Date(new Date(i[u][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(i[u][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(i[u][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(this._renderAppointmentMonth(i[u],f,o),h.push(i[u])):new Date(new Date(r[f]).setHours(0,0,0,0)).getTime()==new Date(new Date(i[u][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(r[f]).setHours(0,0,0,0)).getTime()<=new Date(new Date(i[u][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(i[u][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(i[u][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(this._renderAppointmentMonth(i[u],f,o),h.push(i[u])));this.model.enableAppointmentNavigation&&this._nextPrevButton(h)},_wireResizeEvents:function(){if(this.model.enableAppointmentResize&&!this.model.readOnly){this.element.find("div.e-lefthandle,div.e-righthandle,div.e-tophandle,div.e-bottomhandle").on("mousedown",n.proxy(this._appointmentResizeStart,this));this._on(this.element.find("div.e-lefthandle,div.e-righthandle"),"mouseover",n.proxy(this._colHandlesOver,this));this._on(this.element.find("div.e-tophandle,div.e-bottomhandle"),"mouseover",n.proxy(this._rowHandlesOver,this))}},_unWireResizeEvents:function(){this.model.enableAppointmentResize&&(this.element.find("div.e-lefthandle,div.e-righthandle,div.e-tophandle,div.e-bottomhandle").off("mousedown",n.proxy(this._appointmentResizeStart,this)),this._off(this.element.find("div.e-lefthandle,div.e-righthandle"),"mouseover",n.proxy(this._colHandlesOver,this)),this._off(this.element.find("div.e-tophandle,div.e-bottomhandle"),"mouseover",n.proxy(this._rowHandlesOver,this)))},_recuCollectionIndex:function(n,t){for(var r,u=this.model.appointmentSettings,i=0;i<n.length;i++)if(n[i].Guid==t.Guid&&n[i].AppTaskId==t.AppTaskId){r=i;break}return r},_getIndex:function(n,i,r,u,f){var l=[],y=this,v,e,o,h,s,c,a;for(u=this._sortAppById(u),u=this._appointmentSort(u),v=r.length,e=[],o=0;o<u.length;o++)t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)?u[o][this.model.resources[this.model.resources.length-1].field]==f&&new Date(new Date(u[o][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(r[n]).setHours(0,0,0,0)).getTime()&&new Date(new Date(u[o][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()>=new Date(new Date(r[n]).setHours(0,0,0,0)).getTime()&&new Date(new Date(u[o][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(u[o][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&e.push(u[o]):new Date(new Date(u[o][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(r[n]).setHours(0,0,0,0)).getTime()&&new Date(new Date(u[o][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()>=new Date(new Date(r[n]).setHours(0,0,0,0)).getTime()&&new Date(new Date(u[o][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<=new Date(new Date(u[o][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&e.push(u[o]);if(this.overlapList=e,e=this._sortAppById(e),e=this._appointmentSort(e),h=-1,e.length>0)for(s=0;s<e.length;s++)if(this.model.timeScale.enable){if(c=this.element.find("[guid="+e[s].Guid+"]").height(),c=t.isNullOrUndefined(c)?!1:!0,c&&(this._appointmentLevel(e[s]),l.push(this.appLevel)),e[s].Guid==i.Guid){a=l.length>0?this._smallestMissingNumber(l):-1;h=e.length==1?s:a;break}}else e[s].Guid==i.Guid&&(h=s);return h==-1?0:h},_renderAppointmentMonth:function(i,u){var s=this.model.orientation=="vertical"?this._dateRender:this.monthDays,et=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(s[0])),rt,c,w,l,f,ot,ht,vt;et=et.and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(s[s.length-1]).setHours(23,59,59)));appointments=new t.DataManager(this._processed).executeLocal((new t.Query).where(et));var it=t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this._getIndex(u,i,s,appointments,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):this._getIndex(u,i,s,appointments,null),h=new Date(i[this.model.appointmentSettings.startTime]),ct=new Date(i[this.model.appointmentSettings.endTime]),e,y=0;this.leftPosition=0;this.CellWidth=this.model.orientation=="vertical"?this.element.find(".e-monthcells").width():this.element.find(".e-workcells").width();this.CellHeight=this.model.orientation=="vertical"?this.element.find(".e-monthcells").height():this.element.find(".e-workcells").height();var d=new Date(h),p=new Date(ct),lt=new Date(s[s.length-1]);if(p=p>lt?lt:p,p.setHours(23,59),rt=this._firstdayofweek==0?7-new Date(d).getDay():7-new Date(d).getDay()+this._firstdayofweek,!this.model.timeScale.enable&&this._oneWeek&&(rt=7-s.indexOf(d.getTime())),c=Math.ceil((new Date(p)-new Date(d))/864e5),p.getTimezoneOffset()-d.getTimezoneOffset()!=0&&(c-=1),h<=ct){this.model.orientation=="vertical"?(c=c>=rt?rt:c,w=Math.ceil((u+1)/7),e=c*this.CellWidth-this.CellWidth/20):e=this.model.timeScale.enable||this.currentView()=="month"||this._isCustomView()?c*this.CellWidth:this.CellWidth*c-parseInt(this.CellWidth/10);l=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this._findResourceIndex(this.res1,this.model.resources[this.model.resources.length-1].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):0;f=t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)||!t.scheduleFeatures.resources?this.model.orientation=="vertical"&&this._isCustomView()&&!this._oneWeek?l*7+(new Date(h).getDay()+1)+(w-1)*this.res1.length*7:u+1:this.model.orientation=="vertical"?this.currentView()=="day"?l+1:this.currentView()=="workweek"||this._isCustomView()&&this._oneWeek?l*this._dateRender.length+(u+1):this.currentView()=="workweek"?l*this._dateRender.length+(new Date(h).getDay()+1)+(w-1)*this.res1.length*this._dateRender.length:this._firstdayofweek==0?l*7+(new Date(h).getDay()+1)+(w-1)*this.res1.length*7:this.model.orientation=="vertical"&&this._firstdayofweek!=0?l*7+(new Date(h).getDay()+1)+(w-1)*this.res1.length*7-this._firstdayofweek:u+1:u+1;this.model.orientation=="vertical"&&this._firstdayofweek!=0&&new Date(h).getDay()<this._firstdayofweek&&(f=l*7+(new Date(h).getDay()+1)+(w-1)*this.res1.length*7-this._firstdayofweek+7);var wt=e-1,g=this.model.appointmentTemplateId?!0:!1,a=this._getUserAppointmentTemplate(i),o=this.model.appointmentTemplateId?n(a).css("height")=="100%"?this.CellHeight-this.element.find(".e-monthheader").height()-15:n(a).css("height")=="0px"?this.element.find(".e-monthappointment").height():n(a).height():21;o=g?this.model.timeScale.enable&&this.model.orientation=="vertical"?o:this.model.orientation=="vertical"&&(this.currentView()=="month"||this._isCustomView()&&!this._oneWeek)?this.CellHeight-this.element.find(".e-monthheader").height()-15:this.CellHeight/10:o;e=this.model.appointmentTemplateId?n(a).css("width")=="100%"||n(a).css("width")=="0px"?e:n(a).width():e;y=it*o;this.leftPosition=0;t.isNullOrUndefined(this.model.resources)||(ot=this._getResourceCollection());var b=!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1?this._findResourceIndex(ot[0].dataSource,ot[0].id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-2]])+1:0,nt=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this._findResourceIndex(this.level_Resources,this.model.resources[this.model.resources.length-1].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]])+1:1,tt=this._appointmentColor(i),at=parseInt(this.CellWidth/(this.CellWidth<=e?this.CellWidth:e+(this.element.find(".e-monthappointment").outerWidth(!0)-this.element.find(".e-monthappointment").width()))),bt=parseInt((this.CellHeight-this.element.find(".e-monthheader").height()-10)/(this.element.find(".e-monthappointment").length>0?this.element.find(".e-monthappointment").outerHeight(!0):o));if(g&&n(a).css("height")!="0px"?it+1<=at*bt:this.CellHeight>this.element.find(".e-monthheader").height()+(it+1)*o+10){e<wt?g&&n(this.element.find(".e-appointwrapper")[f-1]).attr("style","height:"+(parseInt(it/at)+1)*o+"px !important;width:"+this.CellWidth+"px !important;position:absolute !important;"):g&&n(this.element.find(".e-appointwrapper")[f-1]);o-=2;y>1&&(y-=2);this.leftPosition>1&&(this.leftPosition-=1);var kt=this._timeMode=="12"?Globalize.format(i[this.model.appointmentSettings.startTime],this._pattern.t):Globalize.format(i[this.model.appointmentSettings.startTime],"HH:mm"),dt=this._timeMode=="12"?Globalize.format(i[this.model.appointmentSettings.endTime],this._pattern.t):Globalize.format(i[this.model.appointmentSettings.endTime],"HH:mm"),st=this.appTemplate.render({id:i.AppTaskId,appResize:this.model.enableAppointmentResize,currentview:this.currentView(),appHeight:o,rtl:this.model.enableRTL,subject:i[this.model.appointmentSettings.subject],startTime:kt,endTime:dt,left:this.leftPosition+"px",top:y,appWidth:e+"px",userAppTemplId:g,userTemplate:a,appClass:"e-monthappointment",appointData:tt.appointColor.appointData,appointCustomcss:tt.appointColor.appointCustomcss,appointtextcolor:tt.appointColor.appointtextcolor,value:tt.value,multiDiv:tt.multiDiv,priority:this.model.prioritySettings.enable?i[this.model.appointmentSettings.priority]:"",enablePriority:this.model.prioritySettings.template,priorityTemplate:this.model.prioritySettings.template?this._priorityTemplate(i):i[this.model.appointmentSettings.priority],uid:i.Guid,recurrence:i[this.model.appointmentSettings.recurrence]});this.model.orientation=="vertical"?n(this.element.find("div.e-appointwrapper")[f-1]).append(st):this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(n(n(this.element.find(".e-workcellstab tr")[nt+b-1]).find("div.e-appointwrapper")[f-1]).append(st),!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>0&&(ht=this._getResourceColor(i),vt=ht.appointData==""?"e-categorycolor":"",n(n(this.element.find(".e-resourceheadertr")[b-1]).find("div.e-appointwrapper")[f-1]).append("<div class='e-categorybar "+vt+"' id='categorybar_"+i.Guid+"'style='position:absolute;height:"+this.element.find(".e-resourceheadercells").height()+"px;background:"+ht.appointData+";width:"+(e+1)+"px;left:"+this.leftPosition+"px;'><\/div>")));st=""}else if(n("#"+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(nt+b-1)+"_"+(f-1)).length==0){if(this.model.orientation=="vertical"){var ut=f-1,k=new Date(i[this.model.appointmentSettings.startTime]).getTime(),yt=Math.round((i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/864e5),v=ut;do n(this.element.find("div.e-appointwrapper")[v]).append('<div id="'+this._id+"_"+Globalize.format(new Date(k),"MM_dd_yyyy")+"_"+(nt+b-1)+"_"+v+'" class="e-icon e-appsoverflow"><\/div>'),k=k+864e5,v++;while(v<yt+ut)}else{var ut=f-1,k=new Date(i[this.model.appointmentSettings.startTime]).getTime(),yt=Math.round((i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/864e5),v=ut;do n(n(this.element.find(".e-workcellstab tr")[nt+b-1]).find("div.e-appointwrapper")[v]).append('<div id="'+this._id+"_"+Globalize.format(new Date(k),"MM_dd_yyyy")+"_"+(nt+b-1)+"_"+v+'" class="e-icon e-appsoverflow"><\/div>'),k=k+864e5,v++;while(v<yt+ut)}y=this.CellHeight-(this.element.find(".e-monthheader").height()+this.element.find(".e-appsoverflow").height()-2);this.element.find(".e-icon.e-appsoverflow").css(this.model.enableRTL?"right":"left",this.CellWidth+this.leftPosition-25+"px").css("top",y+"px")}}if(!i[this.model.appointmentSettings.recurrence]){var gt=i.ParentId==r?i.AppTaskId:i.ParentId,ni=(new t.Query).where("AppTaskId",t.FilterOperators.equal,gt),ft=new t.DataManager(this._currentAppointmentData).executeLocal(ni),pt=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,i.Guid));new Date(i[this.model.appointmentSettings.endTime])<ft[0][this.model.appointmentSettings.endTime]&&(this.model.enableRTL?n(this.element.find("div.e-appointwrapper")[f-1]).find("[guid="+ft[0].Guid+"]").children(".e-lefthandle").remove():n(this.element.find("div.e-appointwrapper")[f-1]).find("[guid="+ft[0].Guid+"]").children(".e-righthandle").remove());new Date(i[this.model.appointmentSettings.startTime])>ft[0][this.model.appointmentSettings.startTime]&&(this.model.enableRTL?n(this.element.find("div.e-appointwrapper")[f-1]).find("[guid="+i.Guid+"]").children(".e-righthandle").remove():n(this.element.find("div.e-appointwrapper")[f-1]).find("[guid="+i.Guid+"]").children(".e-lefthandle").remove())}!t.isNullOrUndefined(pt)&&pt>1&&(n(this.element.find("div.e-appointwrapper")[f-1]).find("[guid="+i.Guid+"]").children(".e-lefthandle").remove(),n(this.element.find("div.e-appointwrapper")[f-1]).find("[guid="+i.Guid+"]").children(".e-righthandle").remove())},_quickWindowClose:function(){this._quickAppointWindow.ejDialog("close");this._processFocus()},_appointmentWindow:function(i){var v,o,s,h,e,w;this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close");var u,f,r=t.isNullOrUndefined(i.target)?n(i):n(i.target),y=(r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells")||this._cellClick||r.hasClass("e-detailedapp"))&&!r.hasClass("e-resourceheadercells")&&!r.hasClass("e-schedulemouseclose")&&!r.hasClass("e-appointinnertext")&&!r.hasClass("e-apptext")&&!r.hasClass("e-apptime"),c={startTime:new Date(this.cur_StartTime),endTime:this.cur_EndTime,target:i,resources:(this.model.appointmentWindowOpen!=null||this.model.cellDoubleClick!=null)&&y&&!t.isNullOrUndefined(this.model.resources)?this._getResourceValue(r):null};if(this._trigger("cellDoubleClick",c)||r.hasClass("e-categorybar"))return!1;if(!(r.hasClass("e-workcells")||r.hasClass("e-alldaycells")||r.hasClass("e-monthcells")||this._cellClick||r.hasClass("e-detailedapp"))||r.hasClass("e-resourceheadercells")||r.hasClass("e-schedulemouseclose")||r.hasClass("e-appointinnertext")||r.hasClass("e-apptext")||r.hasClass("e-apptime")){if(!r.hasClass("e-resourceheadercells")&&!r.hasClass("e-schedulemouseclose")){if(r.hasClass("e-monthheader")||r.hasClass("e-appsoverflow"))return!1;s=this._editKey?n(i):r.hasClass("e-appointment")||r.hasClass("e-monthappointment")||r.hasClass("e-alldayappointment")||r.hasClass("e-agendaappointment")?r:r.parents(".e-monthappointment,.e-appointment,.e-alldayappointment,.e-agendaappointment");t.isNullOrUndefined(s[0].id)||(this._currentAction=t.Schedule.Actions.Save,this._appUid=s.attr("guid"),e=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),h=new t.DataManager(this._processed).executeLocal(e),h[0][this.model.appointmentSettings.recurrence]==1?(this._parentId=h[0].ParentId,this._recurEditWindow.ejDialog("open"),this._recurEditWindow.focus(),this._deleteBeforeOpen()):(e=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),w=new t.DataManager(this._processed).executeLocal(e),this._showAppointmentDetails(this._appUid,!0)),this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close"));this._editKey=!1}}else{this._currentAction=t.Schedule.Actions.Add;this._appointmentAddWindow.find(".e-recurwindow").css("display","none");this._appointmentAddWindow.find(".e-appwindow").css("display","block");var l=this._cellIndex,p=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,a=new Date(p[l]);if(this.model.minDate>a||this.model.maxDate<a||(this._cellClick?(u=new Date(this.cur_StartTime),f=new Date(this.cur_EndTime)):(this.currentDate(new Date(this.dateRender[l])),r.hasClass("e-workcells")?(v=this.model.startHour+r.parent().index()/2,o=v.toString().split("."),u=new Date(this.currentDate()).setHours(parseInt(o[0]),parseInt(o[1])==5?30:00),f=new Date(new Date(u).setMinutes(new Date(u).getMinutes()+30))):r.hasClass("e-monthcells")?(u=new Date(new Date(this.currentDate()).setHours(9)),u=new Date(u).setMinutes(00),f=new Date(new Date(u).setMinutes(30))):(u=new Date(this.currentDate()),f=new Date(u),this._appointmentAddWindow.find(".allday ").ejCheckBox({checked:!0}))),this._trigger("appointmentWindowOpen",c)))return!1;this._appointmentAddWindow.find("#"+this._id+"subject").val(this.model.showQuickWindow?this._quickAppointWindow.find(".subject").val():"");this._appointmentAddWindow.find("#"+this._id+"location").val(this.model.showQuickWindow?this._quickAppointWindow.find(".location").val():"");this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option",{value:Globalize.format(new Date(u),this._datepattern())});this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option",{value:Globalize.format(new Date(f),this._datepattern())});this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(new Date(u),this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(new Date(f),this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"_priority").ejDropDownList("option","value",this.model.prioritySettings.dataSource[0][this.model.prioritySettings.value]);(n(i.currentTarget).hasClass("e-alldaycells")||this.currentView()=="month"||this._isCustomView())&&this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0});this._timeZoneCollection(null);this._tempStart=this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value");this._tempEnd=this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value");this._alldayCheck();t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._renderResourceData(r,this._cellIndex);this.model.readOnly||(this._appointmentAddWindow.find(".e-appsave,#donerecur").ejButton("enable",!0),this._mediaQuery&&this._appointmentAddWindow.find(".e-btndelete").css("display","none"),this._appointmentAddWindow.ejDialog("open"));this._mediaQuery||this._appointmentAddWindow.find(".subject").focus();this._cellClick=!1}},_editRecurrence:function(){this._appointmentAddWindow.find(".e-appwindow").toggle();this._mediaQuery&&this._appointmentAddWindow.parent().parent().find(".e-dialog-icon").css("display","none");this._appointmentAddWindow.find(".e-recurwindow").css("margin-left",700).toggle().animate({"margin-left":10},300)},_showAppointmentDetails:function(n,i){var o=i==!0?(new t.Query).where("Guid",t.FilterOperators.equal,n):(new t.Query).where("AppTaskId",t.FilterOperators.equal,n),s=i==!0?this._processed:this._currentAppointmentData,r=this._sortAppById(new t.DataManager(s).executeLocal(o)),u,f,e;if(r[0][this.model.appointmentSettings.endTime]=r[r.length-1][this.model.appointmentSettings.endTime],this._appointmentAddWindow.find(".subject").val(r[0][this.model.appointmentSettings.subject]),this._appointmentAddWindow.find(".location").val(r[0][this.model.appointmentSettings.location]),this._appointmentAddWindow.find(".id").val(r[0].AppTaskId),this._appointmentAddWindow.find(".e-description").val(r[0][this.model.appointmentSettings.description]?r[0][this.model.appointmentSettings.description]:""),u=r[0],this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",Globalize.format(u[this.model.appointmentSettings.startTime],this._datepattern())),this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",Globalize.format(u[this.model.appointmentSettings.endTime],this._datepattern())),this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(u[this.model.appointmentSettings.startTime],this._pattern.t)),this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(u[this.model.appointmentSettings.endTime],this._pattern.t)),this.model.prioritySettings.enable&&(t.isNullOrUndefined(u[this.model.appointmentSettings.priority])?this._appointmentAddWindow.find("#"+this._id+"_priority").ejDropDownList("option",{value:this.model.prioritySettings.dataSource[0][this.model.prioritySettings.value]}):this._appointmentAddWindow.find("#"+this._id+"_priority").ejDropDownList("option",{value:r[0][this.model.appointmentSettings.priority]})),this._timeZoneCollection(u),this._tempStart=this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value"),this._tempEnd=this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value"),r[0][this.model.appointmentSettings.allDay]==1&&this._appointmentAddWindow.find(".allday ").ejCheckBox({checked:!0}),r[0][this.model.appointmentSettings.recurrence]==1&&(this._recRule=r[0][this.model.appointmentSettings.recurrenceRule],i==!0?(t.isNullOrUndefined(r[0][this.model.appointmentSettings.recurrenceRule])||r[0][this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")==-1||(this._currentAction=t.Schedule.Actions.Save),this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0,enabled:!1}),this._appointmentAddWindow.find(".e-repeatlbl").addClass("e-disable"),this._appointmentAddWindow.find("."+this._id+"summary").css("display","none"),this._appointmentAddWindow.find(".e-recurFinalRule").html("")):(this.recurrenceRuleSplit(r[0][this.model.appointmentSettings.recurrenceRule],u[this.model.appointmentSettings.recurrenceExDate]),this._appointmentAddWindow.find(".recurstartdate").ejDatePicker({value:Globalize.format(u[this.model.appointmentSettings.startTime],this._datepattern())}),this._appointmentAddWindow.find("."+this._id+"summary").css("display","table-row"),this._appointmentAddWindow.find(".e-recurFinalRule").html(this._showRecurrenceFields(n)),this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:!0}),this._appointmentAddWindow.find(".e-recuredit").css("display","inline"))),this.model.categorizeSettings.enable&&!t.isNullOrUndefined(u[this.model.appointmentSettings.categorize])&&this._showCategorizeDetails(u),!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources&&this._showMultipleResourceDetails(u),f={appointment:r[0],edit:i},this._trigger("appointmentWindowOpen",f))return!1;this._alldayCheck();e=this.model.readOnly?"disable":"enable";this._appointmentAddWindow.find(".e-appsave,#donerecur").ejButton(e,!0);this._mediaQuery&&this._appointmentAddWindow.find(".e-btndelete").css("display","block");this._appointmentAddWindow.ejDialog("open");this._mediaQuery||this._appointmentAddWindow.find(".subject").focus()},_showRecurrenceFields:function(){var n="",i="",u=this._appointmentAddWindow.find(".recurtype"),f,r;n=t.isNullOrUndefined(this._rRule.interval)?this._getLocalizedLabels("Every")+" ":this._getLocalizedLabels("Every")+" "+this._rRule.interval+" ";switch(this._rRule.freq){case"DAILY":u.ejDropDownList({selectedItemIndex:0});n+=this._getLocalizedLabels("RecurrenceDay").toLowerCase();break;case"WEEKLY":for(u.ejDropDownList({selectedItemIndex:1}),this._appointmentAddWindow.find(".weekdays").ejCheckBox({checked:!1}),f=this._rRule.weekDays.split(","),r=0;r<f.length;r++)this._appointmentAddWindow.find(".e-weekly"+f[r]).ejCheckBox({checked:!0}),i+=this._dayShortNames[this._dayNames.indexOf(f[r])]+(r==f.length-1?"":", ");n+=this._getLocalizedLabels("RecurrenceWeek").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+i;break;case"MONTHLY":u.ejDropDownList({selectedItemIndex:2});t.isNullOrUndefined(this._rRule.monthDay)?(this._appointmentAddWindow.find(".e-monthposition").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-monthsrtday").ejDropDownList({selectedItemIndex:this._dayNames.indexOf(this._rRule.weekDays)}),this._appointmentAddWindow.find(".monthsrt").ejDropDownList({selectedItemIndex:this._rRule.setPositions-1}),i=this._appointmentAddWindow.find(".monthsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[this._dayNames.indexOf(this._rRule.weekDays)]):(this._appointmentAddWindow.find(".e-monthdaytype").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-monthdate").ejNumericTextbox({value:parseInt(this._rRule.monthDay)}),i=parseInt(this._rRule.monthDay));n+=this._getLocalizedLabels("RecurrenceMonth").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+i;break;case"YEARLY":u.ejDropDownList({selectedItemIndex:3});t.isNullOrUndefined(this._rRule.monthDay)?(this._appointmentAddWindow.find(".e-yearrecurposi").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".yearsrtday").ejDropDownList({selectedItemIndex:this._dayNames.indexOf(this._rRule.weekDays)}),this._appointmentAddWindow.find(".yearsrtmonth").ejDropDownList({selectedItemIndex:this._rRule.month-1}),this._appointmentAddWindow.find(".yearsrt").ejDropDownList({selectedItemIndex:this._rRule.setPositions-1}),i=this._appointmentAddWindow.find(".yearsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[this._dayNames.indexOf(this._rRule.weekDays)]+" "+this._monthNames[this._rRule.month-1]):(this._appointmentAddWindow.find(".e-yearrecurday").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".yearmonth").ejDropDownList({selectedItemIndex:this._rRule.month-1}),this._appointmentAddWindow.find(".yeardate").ejNumericTextbox({value:parseInt(this._rRule.monthDay)}),i=this._monthNames[this._rRule.month-1]+" "+parseInt(this._rRule.monthDay));n+=this._getLocalizedLabels("RecurrenceYear").toLowerCase()+" "+this._getLocalizedLabels("On").toLowerCase()+" "+i}return this._rRuleFreq=t.isNullOrUndefined(this._rRuleFreq)||this._rRuleFreq?u.ejDropDownList("option","value").toUpperCase():this._rRuleFreq,this._appointmentAddWindow.find(".e-recurevery").ejNumericTextbox({value:t.isNullOrUndefined(this._rRule.interval)?1:this._rRule.interval}),t.isNullOrUndefined(this._rRule.count)?t.isNullOrUndefined(this._rRule.until)?this._appointmentAddWindow.find(".e-recurnoend").ejRadioButton({checked:!0}):(this._appointmentAddWindow.find(".e-recuruntil").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-until").ejDatePicker({value:new Date(this._rRule.until)}),n+=" "+this._getLocalizedLabels("Until").toLowerCase()+" "+Globalize.format(new Date(this._rRule.until),this._datepattern())):(this._appointmentAddWindow.find(".e-recurafter").ejRadioButton({checked:!0}),this._appointmentAddWindow.find(".e-recurcount").ejNumericTextbox({value:this._rRule.count}),n+=", "+this._rRule.count+this._getLocalizedLabels("Times").toLowerCase()),n},_closerecur:function(t){var e,w,r,s,h,p,y,u,b,k;if(this._appointmentAddWindow.find(".e-recuruntil").ejRadioButton("option","checked")&&t.model.text!=this._getLocalizedLabels("Cancel")&&this._appointmentAddWindow.find("#recurstartdate").ejDatePicker("option","value")>this._appointmentAddWindow.find(".e-until").ejDatePicker("option","value"))return this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("WrongPattern")),this._alertWindow.ejDialog("open"),!1;if(t.model.text==this._getLocalizedLabels("Cancel"))this._appointmentAddWindow.find(".e-recurFinalRule").html()==""&&this._appointmentAddWindow.find("#"+this._id+"recurrence").ejCheckBox({checked:!1});else{var i,c,l="",o="",f="";i=this._findInterval(this._appointmentAddWindow.find(".e-recurevery"));switch(this._rRuleFreq){case"DAILY":this._recRule="FREQ="+this._rRuleFreq+";INTERVAL="+i;break;case"WEEKDAYS":this._recRule="FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR";f="MO,TU,WE,TH,FR";break;case"WEEKLY":var a=this._appointmentAddWindow.find("input[type='checkbox'][name='weekdays']"),v="";for(e=0;e<a.length;e++)n(a[e]).ejCheckBox("option","checked")==!0?f+=(f!=""?",":"")+this._dayNames[e].toUpperCase():"",n(a[e]).ejCheckBox("option","checked")==!0?v+=(v!=""?", ":"")+this._dayShortNames[e]:"";if(f==""){if(this.model.enableRecurrenceValidation)return n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert")),this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("WrongPattern")),this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok")),this._alertWindow.ejDialog("open"),!1;y=this._appointmentAddWindow.find(".recurstartdate").ejDatePicker("option","value");f=this._dayNames[y.getDay()].toUpperCase()}w=this._getLocalizedLabels("RecurrenceWeek").toLowerCase()+" on "+v;this._appointmentAddWindow.find(".e-recurRule").html(w);this._recRule="FREQ="+this._rRuleFreq+";INTERVAL="+i+";BYDAY="+f;break;case"MONTHLY":this._appointmentAddWindow.find(".e-monthdaytype").ejRadioButton("option","checked")?(c=this._appointmentAddWindow.find(".e-monthdate").ejNumericTextbox("option","value"),this._recRule="FREQ="+this._rRuleFreq+";BYMONTHDAY="+c+";INTERVAL="+i,o=" "+this._getLocalizedLabels("On").toLowerCase()+" "+c):(r=this._appointmentAddWindow.find(".monthsrt").ejDropDownList("option","selectedItemIndex"),s=this._appointmentAddWindow.find(".e-monthsrtday").ejDropDownList("option","selectedItemIndex"),r=r<4?r+1:-1,this._recRule="FREQ="+this._rRuleFreq+";BYDAY="+this._dayNames[s]+";BYSETPOS="+r+";INTERVAL="+i,o=" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._appointmentAddWindow.find(".monthsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[s]);break;case"YEARLY":if(this._appointmentAddWindow.find("#"+this._id+"yearday").ejRadioButton("option","checked"))h=this._appointmentAddWindow.find(".yearmonth").ejDropDownList("option","selectedItemIndex"),p=this._findInterval(this._appointmentAddWindow.find(".yeardate")),this._recRule="FREQ="+this._rRuleFreq+";BYMONTHDAY="+p+";BYMONTH="+(h+1)+";INTERVAL="+i,o=" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._monthNames[h]+" "+p;else{var r=this._appointmentAddWindow.find(".yearsrt").ejDropDownList("option","selectedItemIndex"),h=this._appointmentAddWindow.find(".yearsrtmonth").ejDropDownList("option","selectedItemIndex"),s=this._appointmentAddWindow.find(".yearsrtday").ejDropDownList("option","selectedItemIndex");r=r<4?r+1:-1;this._recRule="FREQ="+this._rRuleFreq+";BYDAY="+this._dayNames[s]+";BYMONTH="+(h+1)+";BYSETPOS="+r+";INTERVAL="+i;o=" "+this._getLocalizedLabels("On").toLowerCase()+" "+this._appointmentAddWindow.find(".yearsrt").ejDropDownList("option","value").toLowerCase()+" "+this._dayFullNames[s]+" "+this._monthNames[h]}}this._appointmentAddWindow.find(".e-recurafter").ejRadioButton("option","checked")?(u=this._findInterval(this._appointmentAddWindow.find(".e-recurcount")),this._recRule+=";COUNT="+u,l=u?", "+u+" "+this._getLocalizedLabels("Times"):", "):this._appointmentAddWindow.find(".e-recuruntil").ejRadioButton("option","checked")&&(y=Globalize.format(new Date(this._appointmentAddWindow.find(".e-until").ejDatePicker("option","value")),this._pattern.d),u=this._findRecurCount(i,f),this._recRule+=";COUNT="+u,l=u?", "+u+" "+this._getLocalizedLabels("Times"):", ");b=(this._rRuleFreq!="WEEKDAYS"?this._getLocalizedLabels("Every"):"")+" "+(i>1?i+" ":"");k=b+this._appointmentAddWindow.find(".e-recurRule").html()+o+l;this._appointmentAddWindow.find("."+this._id+"summary").css("display","table-row");this._appointmentAddWindow.find(".e-recurFinalRule").html(k);this._appointmentAddWindow.find(".e-recuredit").css("display","inline");o=""}this._appointmentAddWindow.find(".e-recurwindow").toggle();this._appointmentAddWindow.find(".e-appwindow").css("margin-left",700).toggle().animate({"margin-left":10},300);this._mediaQuery&&this._appointmentAddWindow.parent().parent().find(".e-dialog-icon").css("display","block");this._appointmentAddWindow.find(".done").focus()},_findRecurCount:function(n,t){for(var e=0,n,t,r=!1,i=new Date(this._appointmentAddWindow.find(".recurstartdate").ejDatePicker("option","value")),s=new Date(this._appointmentAddWindow.find(".e-until").ejDatePicker("option","value")),f,o,u;i<=s;){switch(this._rRuleFreq){case"DAILY":i=new Date(i.setDate(i.getDate()+n));r=!0;break;case"WEEKLY":case"WEEKDAYS":for(f=t.split(","),o=this._dayNames[new Date(i).getDay()],u=0;u<f.length;u++)if(f[u]==o){r=!0;break}break;case"MONTHLY":i=new Date(i.setMonth(i.getMonth()+n));r=!0;break;case"YEARLY":i=new Date(i.setFullYear(i.getFullYear()+n));r=!0}r&&e++;r=!1;(this._rRuleFreq=="WEEKLY"||this._rRuleFreq=="WEEKDAYS")&&(i=new Date(i.setDate(i.getDate()+1)))}return e},_recurDateChange:function(n){this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",n.value);this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value")<this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value")&&this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",n.value)},_findInterval:function(n){var i;return i=n.ejNumericTextbox("option","value"),t.isNullOrUndefined(i)?0:i},_cancel:function(){this._appointmentAddWindow.ejDialog("close")},_timeChange:function(n){var i=this._appointmentAddWindow.find("#"+this._id+"starttime").data("ejTimePicker");if(i.showDropdown&&i._id==this._id+"starttime")if(this._appointmentAddWindow.find(".startutc").val()!=this._appointmentAddWindow.find(".endutc").val())this._utcValue("","starttime");else{var r=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value")).split(":"),u=new Date(new Date("1/1/2000").setHours(parseInt(r[0],10),parseInt(r[1],10))),f=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value")).split(":"),t=new Date(new Date("1/1/2000").setHours(parseInt(f[0],10),parseInt(f[1],10))),e=this._timeFormat(n.prevTime).split(":"),o=new Date(new Date("1/1/2000").setHours(parseInt(e[0],10),parseInt(e[1],10))),s=new Date(new Date(t).setHours(t.getHours()+u.getHours()-o.getHours(),t.getMinutes()+u.getMinutes()-o.getMinutes()));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",s)}},_endTimeChange:function(){var n=this._appointmentAddWindow.find("#"+this._id+"endtime").data("ejTimePicker");n.showDropdown&&n._id==this._id+"endtime"&&(this._endSlotChange=!0)},_renderControls:function(){var i=this._appointmentAddWindow;i.find(".allday").ejCheckBox({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass,change:n.proxy(this._alldayCheck,this)});i.find(".startenddate").ejDatePicker({buttonText:this._getLocalizedLabels("Today"),startDay:this._firstdayofweek,enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,dateFormat:this.model.dateFormat,cssClass:this.model.cssClass,minDate:this.model.minDate,maxDate:this.model.maxDate});i.find("#"+this._id+"starttime").ejTimePicker({enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,change:n.proxy(this._timeChange,this),cssClass:this.model.cssClass,interval:30,timeFormat:this._timeMode=="12"?this._pattern.t:"HH:mm"});i.find("#"+this._id+"endtime").ejTimePicker({enableRTL:this.model.enableRTL,width:"100%",value:this.currentDate(),locale:this.model.locale,change:n.proxy(this._endTimeChange,this),cssClass:this.model.cssClass,interval:30,timeFormat:this._timeMode=="12"?this._pattern.t:"HH:mm"});i.find("#"+this._id+"startTimeZone").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:this.model.timeZoneCollection.dataSource,fields:{text:"text",id:"id",value:"value"},width:"100%",change:n.proxy(this._startUtc,this),cssClass:this.model.cssClass});i.find("#"+this._id+"endTimeZone").ejDropDownList({enableRTL:this.model.enableRTL,dataSource:this.model.timeZoneCollection.dataSource,fields:{text:"text",id:"id",value:"value"},width:"100%",change:n.proxy(this._endUtc,this),cssClass:this.model.cssClass});!this.model.prioritySettings.enable||this.model.prioritySettings.dataSource instanceof t.DataManager||this._renderPriorityItems(i);!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources&&this._renderAppWindowResources(i);!this.model.categorizeSettings.enable||this.model.categorizeSettings.dataSource instanceof t.DataManager||this._renderCategoryItems(i);i.find(".recurrence").ejCheckBox({enableRTL:this.model.enableRTL,change:n.proxy(this._repeat,this),cssClass:this.model.cssClass});i.find(".e-btndone").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:this._mediaQuery?"100%":"100px",click:n.proxy(this._saveAppointment,this),cssClass:this.model.cssClass});i.find(".cancel").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:this._mediaQuery?"100%":"100px",click:n.proxy(this._cancel,this),cssClass:this.model.cssClass});i.find(".recurtype").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"recurtypelist",width:"100%",select:n.proxy(this._recurtype,this),cssClass:this.model.cssClass});i.find(".dailyrecurtype").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-dailyeveryday").ejRadioButton({enableRTL:this.model.enableRTL,checked:!0,cssClass:this.model.cssClass});i.find(".everydaycount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"everydaycount",minValue:1,value:1,width:"100px",float:"left",cssClass:this.model.cssClass});i.find(".recurends").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-recurcount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"dailyoccurance",minValue:1,value:10,width:"65px",cssClass:this.model.cssClass,change:n.proxy(this._endAfterChange,this)});i.find(".weekcount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"weekcount",minValue:1,value:1,width:"100px",cssClass:this.model.cssClass});i.find(".e-recurevery").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"recurevery",minValue:1,value:1,width:"100px",cssClass:this.model.cssClass});i.find(".weekdays").ejCheckBox({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-monthposition").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-monthdaytype").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".e-monthdate").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"monthdate",minValue:1,maxValue:31,value:1,width:"70px",cssClass:this.model.cssClass,change:n.proxy(this._monthDateChange,this)});i.find(".monthnumber").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"monthnumber",minValue:1,value:1,width:"70px",cssClass:this.model.cssClass});i.find(".yearcount").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"yearcount",minValue:1,value:1,width:"50px",cssClass:this.model.cssClass});i.find(".e-yearrecurposi,.e-yearrecurday").ejRadioButton({enableRTL:this.model.enableRTL,cssClass:this.model.cssClass});i.find(".yeardate").ejNumericTextbox({enableRTL:this.model.enableRTL,name:"yeardate",minValue:1,maxValue:31,value:1,width:"70px",cssClass:this.model.cssClass,change:n.proxy(this._yearDateChange,this)});i.find(".recurbutton").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100px",click:n.proxy(this._closerecur,this),cssClass:this.model.cssClass});i.find(".monthsrt").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"monthsrtlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._monthDayChange,this)});i.find(".e-monthsrtday").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"monthsrtdaylist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._monthDayChange,this)});i.find(".yearsrt").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearsrtlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDayChange,this)});i.find(".yearmonth").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearmonthlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDateChange,this)});i.find(".yearsrtday").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearsrtdaylist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDayChange,this)});i.find(".yearsrtmonth").ejDropDownList({enableRTL:this.model.enableRTL,targetID:"yearsrtmonthlist",width:"100px",cssClass:this.model.cssClass,change:n.proxy(this._yearDayChange,this)});i.find(".recurstartdate").ejDatePicker({buttonText:this._getLocalizedLabels("Today"),startDay:this._firstdayofweek,enableRTL:this.model.enableRTL,locale:this.model.locale,cssClass:this.model.cssClass,dateFormat:this.model.dateFormat,change:n.proxy(this._recurDateChange,this),minDate:this.model.minDate,maxDate:this.model.maxDate});i.find(".e-until").ejDatePicker({buttonText:this._getLocalizedLabels("Today"),startDay:this._firstdayofweek,enableRTL:this.model.enableRTL,locale:this.model.locale,cssClass:this.model.cssClass,dateFormat:this.model.dateFormat,change:n.proxy(this._endOnChange,this)});this._mediaQuery&&i.find(".e-btndelete").ejButton({enableRTL:this.model.enableRTL,showRoundedCorner:!0,width:"100%",click:n.proxy(this._mobileAppDelete,this),cssClass:this.model.cssClass})},_mobileAppDelete:function(){this._mediaQuery&&!t.isNullOrUndefined(this._editOnlyClicked)&&!this._editOnlyClicked&&this._appointmentAddWindow.find(".recurrence").ejCheckBox("option","checked")?this._deleteApp(this._appUid):this._deleteAppoint();this._appointmentAddWindow.ejDialog("close")},_renderPriorityItems:function(n){t.isNullOrUndefined(n)||n.find(".priority").ejDropDownList({enableRTL:this.model.enableRTL,template:t.isNullOrUndefined(this.model.prioritySettings.template)?"<div class='e-${"+this.model.prioritySettings.value+"}'><\/div><div>${"+this.model.prioritySettings.text+"}<\/div>":this.model.prioritySettings.template+"${"+this.model.prioritySettings.text+"}",dataSource:this.model.prioritySettings.dataSource,fields:{text:this.model.prioritySettings.text,value:this.model.prioritySettings.value},width:"100%",cssClass:this.model.cssClass})},_renderCategoryItems:function(n){t.isNullOrUndefined(n)||n.find(".e-categorizevalue").ejAutocomplete({enableRTL:this.model.enableRTL,showPopupButton:!0,width:"100%",cssClass:this.model.cssClass,multiSelectMode:this.model.categorizeSettings.allowMultiple?"visualmode":"none",dataSource:this.model.categorizeSettings.dataSource,fields:{text:this.model.categorizeSettings.text,value:this.model.categorizeSettings.color,key:this.model.categorizeSettings.id,fontColor:this.model.categorizeSettings.fontColor},template:this._categorizeTemplate})},_appointmentColor:function(n){var i=this.model.categorizeSettings.enable&&!t.isNullOrUndefined(n[this.model.appointmentSettings.categorize])&&n[this.model.appointmentSettings.categorize]!=""?this._getCategorizeColor(n):!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources?this._getResourceColor(n):{appointData:"",appointCustomcss:"",appointtextcolor:""};if(this.model.categorizeSettings.enable&&this.model.categorizeSettings.allowMultiple&&!t.isNullOrUndefined(n[this.model.appointmentSettings.categorize]))var f=n[this.model.appointmentSettings.categorize].split(","),e=f.length,r=e>1?!0:!1,u=this._categorizeMultipleDiv(n,f,e);return!t.isNullOrUndefined(u)&&i.appointData.length>0&&this.model.categorizeSettings.allowMultiple?{appointColor:i,value:r,multiDiv:u}:i.appointData.length>0&&!this.model.categorizeSettings.allowMultiple||!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources?{appointColor:i}:(appointData="",appointCustomcss="",appointtextcolor="",r="",{appointColor:i,value:r,multiDiv:u})},_categorizeMultipleDiv:function(n,r,u){var o=[],f,e;for(i=0;i<=u-1;i++)if(i!=u-1){if(f=this.model.categorizeSettings,e=this._findResourceIndex(f.dataSource,this.model.categorizeSettings.id,r[i]),t.isNullOrUndefined(e)&&(e=this._findResourceIndex(f.dataSource,this.model.categorizeSettings.id,parseInt(r[i]))),t.isNullOrUndefined(e))return n[this.model.appointmentSettings.categorize]="",null;o.push({text:f.dataSource[e][f.text],value:f.dataSource[e][f.color],key:f.dataSource[e][f.id],fontColor:f.dataSource[e][f.fontColor]})}return this._categorizeMultipleTemplate.render({renderData:o})},_getResCategorySaveData:function(n,i,r,u){var l=[],e,w,b,y,h,p,c,a,d,v,f,o;if(e=this._addAppData(r,u,new Date(r[this.model.appointmentSettings.startTime]),new Date(r[this.model.appointmentSettings.endTime]),u),n.length>0){for(y=n[n.length-1].length-1,h="",f=0;f<=y;f++)p=n[n.length-1][f][this.model.categorizeSettings.id],h=f!=y?h+p.toString()+",":h+p.toString();e[this.model.appointmentSettings.categorize]=h}if(i.length>0){var k=e[this.model.appointmentSettings.categorize],o=this.model.appointmentSettings.resourceFields.toString().split(","),s=this._getResourceCollection();if(i[i.length-1].length>0)for(c=0;c<i[i.length-1].length;c++){for(e=this._addAppData(r,u,new Date(r[this.model.appointmentSettings.startTime]),new Date(r[this.model.appointmentSettings.endTime]),u),e[this.model.appointmentSettings.recurrenceId]=r[this.model.appointmentSettings.recurrenceId]==null?null:u,e[this.model.appointmentSettings.categorize]=k,i[i.length-1].length>1&&(r.Guid=this._guidFormatGenerate(),r.AppTaskId=u,u++),a=(new t.Query).where("AppTaskId",t.FilterOperators.equal,u),d=new t.DataManager(this._processed).executeLocal(a),u=d.length==0?u:this._processed[this._processed.length-1].AppTaskId+1,e[o[o.length-1]]=i[o.length-1][c][s[s.length-1].id],v=i[o.length-1][c][s[s.length-1].id],f=o.length-1;f>0;f--)w=this.render_Resources[f]instanceof t.DataManager?this.render_Resources[f]:t.DataManager(this.render_Resources[f]),a=(new t.Query).where(s[f].id,t.FilterOperators.equal,v),appointId=w.executeLocal(a),b=this.render_Resources[f-1]instanceof t.DataManager?this.render_Resources[f-1]:t.DataManager(this.render_Resources[f-1]),query1=(new t.Query).where(s[f-1].id,t.FilterOperators.equal,appointId[0][s[f].groupId]),appointGroupId=b.executeLocal(query1),v=appointGroupId[0][s[f-1].id],e[o[f-1]]=v;this._currentAction==t.Schedule.Actions.EditOcurrence&&(e[this.model.appointmentSettings.id]=e.AppTaskId);l.push(e)}else{if(o=this.model.appointmentSettings.resourceFields.toString().split(","),e=this._addAppData(r,u,new Date(r[this.model.appointmentSettings.startTime]),new Date(r[this.model.appointmentSettings.endTime]),u),e[this.model.appointmentSettings.categorize]=k,o.length>1)for(f=0;f<o.length;f++)e[o[f]]=this.model.resources[f].resourceSettings.dataSource[0].id;else e[o[o.length-1]]=this.model.resources[0].resourceSettings.dataSource[0].id;this._currentAction==t.Schedule.Actions.EditOcurrence&&(e[this.model.appointmentSettings.id]=e.AppTaskId);l.push(e)}}return i.length==0&&n.length>0&&(this._currentAction==t.Schedule.Actions.EditOcurrence&&(e[this.model.appointmentSettings.id]=e.AppTaskId),l.push(e)),l},_timeZoneCollection:function(n){var i;if(n!==null&&(this.startTimeAppoint=n[this.model.appointmentSettings.startTimeZone],this.endTimeAppoint=n[this.model.appointmentSettings.endTimeZone]),this.startutcValue=null,this.tempValue=null,n!==null&&this.endTimeAppoint&&(this._utcValue(n,"Appoint"),this.tempValue=1),this.model.timeInfo!=null)i=this._findResourceIndex(this.model.timeZoneCollection.dataSource,"id",this.model.timeInfo);else{var c=this.model.timeZone==null?this._timezoneStringValue():this.model.timeZone,r=n!==null?t.isNullOrUndefined(this.startTimeAppoint)?c:this.startTimeAppoint:c,e=this.model.timeZoneCollection.dataSource[0][this.model.timeZoneCollection.value],u=e.indexOf("UTC")==-1&&r.indexOf("UTC")!=-1?r.split(" ")[1]:e.indexOf("UTC")!=-1&&r.indexOf("UTC")==-1?"UTC "+r:r,f=!t.isNullOrUndefined(e.split(":")[2])&&!t.isNullOrUndefined(r.split(":")[2])||t.isNullOrUndefined(e.split(":")[2])&&t.isNullOrUndefined(r.split(":")[2])?u:t.isNullOrUndefined(e.split(":")[2])&&!t.isNullOrUndefined(r.split(":")[2])?u.split(":")[0]+":"+u.split(":")[1]:u+":00",o=u.indexOf("UTC")!=-1?u.split(" ")[1].split(":")[0].length==1?"0"+u.split(" ")[1].split(":")[0]:u.split(" ")[1].split(":")[0]:u.split(":")[0].length==1?"0"+u.split(":")[0]:u.split(":")[0],l=o[0]=="+"?o.split("+"):o.split("-"),a="0"+l[1],s=a.length==2?a:l[1],v=f.indexOf("UTC")!=-1?f.split(" ")[0]+" +"+s+":"+f.split(" ")[1].split(":")[1]:"0"+s+":"+f.split(" ")[1].split(":")[1],y=f.indexOf("UTC")!=-1?f.split(" ")[0]+" -"+s+":"+f.split(" ")[1].split(":")[1]:"0"+s+":"+f.split(" ")[1].split(":")[1],h=o[0]=="+"?v:y,i=this._findResourceIndex(this.model.timeZoneCollection.dataSource,"value",h);i=t.isNullOrUndefined(i)?this._findResourceIndex(this.model.timeZoneCollection.dataSource,"value",h.replace("+","")):i;i=t.isNullOrUndefined(i)?"add":i}if(this.model.timeZone==null&&i==0?(this._appointmentAddWindow.find("#"+this._id+"startTimeZone").val("UTC "+Globalize.format(new Date,"zzz"))&&this._appointmentAddWindow.find("#"+this._id+"startTimeZone_hidden").val("UTC "+Globalize.format(new Date,"zzz")),this._appointmentAddWindow.find("#"+this._id+"endTimeZone").val("UTC "+Globalize.format(new Date,"zzz"))&&this._appointmentAddWindow.find("#"+this._id+"endTimeZone_hidden").val("UTC "+Globalize.format(new Date,"zzz"))):i!=="add"&&(this._appointmentAddWindow.find("#"+this._id+"startTimeZone").ejDropDownList("option",{text:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.text],value:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.value]}),this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList("option",{text:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.text],value:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.value]})),n===null||t.isNullOrUndefined(this.startTimeAppoint)||(this._appointmentAddWindow.find("#"+this._id+"startTimeZone").ejDropDownList("option",{value:n!==null&&this.startTimeAppoint?this.startTimeAppoint:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.value]}),this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList("option",{value:n!==null&&this.endTimeAppoint?this.endTimeAppoint:this.model.timeZoneCollection.dataSource[i][this.model.timeZoneCollection.value]})),(this.model.timeZone!=null||this.model.timeZone==null||n!=null)&&i=="add"){var r=n!=null?this.startTimeAppoint:this.model.timeZone==null?this._timezoneStringValue():this.model.timeZone,e=this.model.timeZoneCollection.dataSource[0][this.model.timeZoneCollection.value],h=e.indexOf("UTC")==-1&&r.indexOf("UTC")!=-1?r.split(" ")[1]:e.indexOf("UTC")!=-1&&r.indexOf("UTC")==-1?"UTC "+r:r;this.model.timeZoneCollection.dataSource.push({text:h,id:(this.model.timeZoneCollection.dataSource.length+1).toString()+"_val",value:h});this._appointmentAddWindow.find("#"+this._id+"startTimeZone").ejDropDownList({dataSource:this.model.timeZoneCollection.dataSource});this._appointmentAddWindow.find("#"+this._id+"endTimeZone").ejDropDownList({dataSource:this.model.timeZoneCollection.dataSource});n!=null?this._timeZoneCollection(n):this._timeZoneCollection(null)}},_timezoneStringValue:function(){var t=-(new Date).getTimezoneOffset()+this._timeZoneOffset,i=t<0?"-":"+",n=Math.abs(t),r=Math.floor(n/60)<10?"0"+Math.floor(n/60):Math.floor(n/60),u=n%60<10?"0"+n%60:n%60;return i+r+":"+u},_showCategorizeDetails:function(t){var r=t[this.model.appointmentSettings.categorize].split(","),u;for(i=0;i<r.length;i++)u=n.type(r[i])=="string"?r[i]:parseInt(r[i]),this._appointmentAddWindow.find(".e-categorizevalue").data("ejAutocomplete").selectValueByKey(u)},_renderCategorizeTemplate:function(){var n=this.model.enableRTL?"margin-right:30px;margin-top:-18px":"float:left",i=this.model.enableRTL?"float:none":"float:left";t.isNullOrUndefined(this.model.categorizeSettings)||(this._categorizeTemplate="<div class='e-categorizeTemplate' style='height:15px;margin-right:5px;margin-top:3px;"+i+";width:15px;background-color: ${"+this.model.categorizeSettings.color+"}'><\/div><div style= "+n+">${"+this.model.categorizeSettings.text+"}<\/div>")},_getCategorizeColor:function(n){var r=null,u="",o="",f="",e=n[this.model.appointmentSettings.categorize].split(","),s=e.length-1,i=this.model.categorizeSettings;return(r=this._findResourceIndex(i.dataSource,this.model.categorizeSettings.id,e[s]),t.isNullOrUndefined(r)&&(r=this._findResourceIndex(i.dataSource,this.model.categorizeSettings.id,parseInt(e[s]))),t.isNullOrUndefined(r))?(n[this.model.appointmentSettings.categorize]="",{appointData:u,appointCustomcss:o,appointtextcolor:f}):(u=t.isNullOrUndefined(i.dataSource[r][i.color])?u:i.dataSource[r][i.color],f=t.isNullOrUndefined(i.dataSource[r][i.fontColor])?f:i.dataSource[r][i.fontColor],{appointData:u,appointCustomcss:o,appointtextcolor:f})},_currentDateFormat:function(i){var r,u,f,e;t.isNullOrUndefined(i)||n.type(this.currentDate())=="date"&&n.type(this.model.minDate)=="date"&&n.type(this.model.maxDate)=="date"?i=="MM/dd/yyyy"&&(n.type(this.currentDate())!="date"||n.type(this.model.minDate)!="date"||n.type(this.model.maxDate)!="date")&&(e=Globalize.parseDate(this.currentDate()),r=Globalize.parseDate(this.model.minDate),u=Globalize.parseDate(this.model.maxDate),t.isNullOrUndefined(e)?this.currentDate(new Date):this.currentDate(e),this.model.minDate=t.isNullOrUndefined(r)?this.model.minDate:r,this.model.maxDate=t.isNullOrUndefined(u)?this.model.maxDate:u):(f=Globalize.parseDate(this.currentDate(),this.model.dateFormat),r=Globalize.parseDate(this.model.minDate,this.model.dateFormat),u=Globalize.parseDate(this.model.maxDate,this.model.dateFormat),this.currentDate(t.isNullOrUndefined(f)?new Date(this.currentDate()).toString()=="Invalid Date"||new Date(this.currentDate()).toString()=="NaN"?this._dateConvert(this.currentDate()):new Date(this.currentDate()):f),this.model.minDate=t.isNullOrUndefined(r)?new Date(this.model.minDate).toString()=="Invalid Date"||new Date(this.model.minDate).toString()=="NaN"?this._dateConvert(this.model.minDate):new Date(this.model.minDate):r,this.model.maxDate=t.isNullOrUndefined(u)?new Date(this.model.maxDate).toString()=="Invalid Date"||new Date(this.model.maxDate).toString()=="NaN"?this._dateConvert(this.model.maxDate):new Date(this.model.maxDate):u)},_datepattern:function(){return this.model.dateFormat!=""&&!t.isNullOrUndefined(this.model.dateFormat)?this.model.dateFormat:this._pattern.d},_businessHourScroller:function(){var i,r,u;if(this.currentView()=="agenda")return!1;this.model.orientation=="vertical"?(i=this.element.find(".e-businesshighlightworkcells").length!=0&&this.model.workHours.highlight==!0?this.element.find(".e-businesshighlightworkcells").first().parent()[0].rowIndex*this.element.find(".e-workcells").height():0,n("div#"+this._id+"_scroller").ejScroller({scrollTop:i}),this.element.find(".e-scrolltimecells").css("top",-this.element.find(".e-draggableworkarea").scrollTop()+"px")):this.model.orientation=="horizontal"&&this.model.timeScale.enable&&(this.element.find(".e-businesshighlightworkcells").length!=0&&this.model.workHours.highlight==!0&&this.currentView()!="month"?this.currentView()==="week"||this.currentView()==="workweek"||this.currentView()==="customview"&&this._renderDays<=7?(r=this.element.find(".e-activeview.e-horizontalheaderdiv").parent().index(),!t.isNullOrUndefined(r)&&r>=0&&(this.currentView()=="customview"?this.currentDate(new Date(this._dateRender[0])):this.currentDate(new Date(this._getRenderDates()[r])),dateRender=new Date(this._getRenderDates()[r]).getDay(),i=this.element.find(".e-workcells")[r*(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)].offsetLeft),(this.currentView()==="week"&&[0,6].indexOf(dateRender)==-1||this.currentView()==="workweek")&&(i=this.model.enableRTL?i+this.element.find(".e-workcells").width()-this.model.workHours.start*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)*this.element.find(".e-workcells").width():this.model.workHours.start*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)*this.element.find(".e-workcells").width()+(i-this.element.find(".e-workcells").width()))):i=this.element.find(".e-businesshighlightworkcells")[0].offsetLeft:i=this.element.find(".e-activeview.e-horizontalheaderdiv").parent().index()!=-1?this.element.find(".e-workcells")[this.element.find(".e-activeview.e-horizontalheaderdiv").parent().index()*(this.model.endHour-this.model.startHour)*2]:0,this.model.enableRTL?(i=this.element.find(".e-workcells")[0].offsetLeft-i,n("div#"+this._id+"_scroller").ejScroller({scrollLeft:i}),u=this.element.find(".e-workcells")[0].offsetLeft+this.element.find(".e-workcells").width()-this.element.find(".e-draggableworkarea").width(),i=i>=u?u:i,n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",i+"px")):(n("div#"+this._id+"_scroller").ejScroller({scrollLeft:i}),n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-this.element.find(".e-draggableworkarea").scrollLeft()+"px")))},_yearDateChange:function(){this._appointmentAddWindow.find("#"+this._id+"yearday").ejRadioButton("option","checked",!0)},_yearDayChange:function(){this._appointmentAddWindow.find("#"+this._id+"yearother").ejRadioButton("option","checked",!0)},_monthDateChange:function(){this._appointmentAddWindow.find("#"+this._id+"monthday").ejRadioButton("option","checked",!0)},_monthDayChange:function(){this._appointmentAddWindow.find("#"+this._id+"monthon").ejRadioButton("option","checked",!0)},_endAfterChange:function(){this._appointmentAddWindow.find("#"+this._id+"repeatendafter").ejRadioButton("option","checked",!0)},_endOnChange:function(){this._appointmentAddWindow.find("#"+this._id+"repeatendon").ejRadioButton("option","checked",!0)},_minToHour:function(n){var t=parseInt(n/60),n=n%60;return{h:t,m:n}},_onclose:function(){this._appointmentAddWindow.find(".e-recurwindow").hide();this._appointmentAddWindow.find(".e-appwindow").css("margin-left",700).show().animate({"margin-left":10},300);this._clearFields();this._processFocus()},_printAppointment:function(){var e=t.buildTag("div"),c=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),o=new t.DataManager(this._processed).executeLocal(c),r="<table align='center' style='margin-top:50px;margin-left:50;'>",u=this,i,f,s,h;return n.each(o[0],function(n,i){n=="ParentId"||t.isNullOrUndefined(i)||t.isNullOrUndefined(n)||n=="null"||((n==u.model.appointmentSettings.startTime||n==u.model.appointmentSettings.endTime)&&(i=i),r+="<tr style='height:30px'><td style='width:300px'><b>"+n+":<\/b><\/td><td  style='width:600px'>"+i+"<\/td><\/tr>")}),r+="<\/table>",i="",t.isNullOrUndefined(this.model.appointmentSettings.resourceFields)||this.model.appointmentSettings.resourceFields==""||(f=u.model.appointmentSettings.resourceFields.split(","),n.each(this.model.resources[this.model.resources.length-1].resourceSettings.dataSource,function(n,t){t.id==o[0][f[f.length-1]]&&(i=t.text)})),i=i==""?"Unknown":i,s="<font size='20' style='margin-top:50px;margin-left:50;font-family:Times New Roman'><b>"+i+"<\/b><\/font><\/br><hr style='margin-left:50' size='10'>",h=s+r,e.append(h),t.print(e),!1},_recurrenceValidate:function(n,i,r,u){var o,s,v,y,e,h,p,c,w,f;if(t.isNullOrUndefined(n)||this.recurrenceRuleSplit(n,i),t.isNullOrUndefined(u)?(v=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value")).split(":"),o=new Date(this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value").setHours(parseInt(v[0],10),parseInt(v[1],10)))):o=u,t.isNullOrUndefined(r)?(y=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value")).split(":"),s=new Date(this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value").setHours(parseInt(y[0],10),parseInt(y[1],10)))):s=r,(o-s)/864e5<14){if(e=t.isNullOrUndefined(r)?this._appointmentAddWindow.find("#recurstartdate").ejDatePicker("option","value"):r,h=this._rRule.interval,t.isNullOrUndefined(this._rRule.until))if(t.isNullOrUndefined(this._rRule.count))recurEndDate=new Date(new Date(this.currentDate()).setDate(e.getDate()+42*h));else switch(this._rRule.freq){case"DAILY":recurEndDate=new Date(new Date(e).setDate(e.getDate()+this._rRule.count*h));break;case"WEEKLY":p=this._rRule.weekDays.split(",");c=e.getDate()+this._rRule.count/p.length*7*h;recurEndDate=new Date(new Date(e).setDate(Math.round(c)<c?c+1:c));break;case"MONTHLY":recurEndDate=new Date(new Date(e).setMonth(e.getMonth()+this._rRule.count*h));break;case"YEARLY":recurEndDate=new Date(new Date(e).setFullYear(e.getFullYear()+this._rRule.count*h))}else recurEndDate=new Date(this._rRule.until),recurEndDate.setDate(recurEndDate.getDate()+1);if((recurEndDate-e)/864e5<(this._rRule.freq=="DAILY"?2:this._rRule.freq=="WEEKLY"?7:1))return!0;switch(this._rRule.freq){case"DAILY":return w=this._rRule.interval,(o-s)/36e5>parseInt(w)*24?!1:!0;case"WEEKLY":if(n.split(";")[1].split("=")[0]=="INTERVAL"){var a=this._rRule.weekDays.split(","),k={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6},l=[],b=[];for(f=0;f<a.length*(parseInt(this._rRule.interval)+1);f++)l[f]=a.length>f?k[a[f]]:l[f-a.length]+7*parseInt(this._rRule.interval);for(f=1;f<l.length;f++)b.push(l[f]-l[f-1]);return(o-s)/36e5>Math.min.apply(Math,b)*24?!1:!0}return(o-s)/36e5>24?!1:!0;case"MONTHLY":return!0;case"YEARLY":return!0}}else return!1},_saveAppointment:function(){var ci,b,gt,i,p,ni,st,rt,s,l,k,ti,ht,ct,v,y,wt,f,lt,at,h,vt,o,bt,kt,ri,ui,fi,ei,oi,nt,si,g,it,w,ft,a,hi,pt,u,e;if(this._currentAction!=""&&(start=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value")).split(":"),end=this._timeFormat(this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value")).split(":"),startTime=new Date(this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value").setHours(parseInt(start[0],10),parseInt(start[1],10))),endTime=new Date(this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value").setHours(parseInt(end[0],10),parseInt(end[1],10))),startTime>endTime))return this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("StartEndError")),this._alertWindow.ejDialog("open"),!1;if(this._appointmentAddWindow.find("#"+this._id+"recurrence").ejCheckBox("option","checked")&&this._recRule!=""&&!t.isNullOrUndefined(this._recRule)&&this.model.enableRecurrenceValidation&&this._currentAction=="add"&&!this._recurrenceValidate(this._recRule))return n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert")),this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("CreateError")),this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok")),this._alertWindow.ejDialog("open"),!1;if(ci=this._sortAppById(this._processed),this._cellClick&&this.model.showQuickWindow){if((i={},b=t.isNullOrUndefined(this._appMainId)?1:this._appMainId+1,this.model.enableLoadOnDemand&&(b=this._dataCount),i[this.model.appointmentSettings.id]=b,i.AppTaskId=b,i.ParentId=b,i[this.model.appointmentSettings.subject]=this._quickAppointWindow.find(".subject").val(),i[this.model.appointmentSettings.startTime]=new Date(this.cur_StartTime),i[this.model.appointmentSettings.endTime]=new Date(this.cur_EndTime),i[this.model.appointmentSettings.allDay]=this.currentView()==="month"||new Date(this.cur_StartTime).getHours()==0&&new Date(this.cur_EndTime).getHours()==23&&new Date(this.cur_EndTime).getMinutes()==59||this._isCustomView()?!0:!1,i[this.model.appointmentSettings.allDay]||(i[this.model.appointmentSettings.startTimeZone]=this.model.timeZone==null?"UTC "+this._timezoneStringValue():this.model.timeZone,i[this.model.appointmentSettings.endTimeZone]=this.model.timeZone==null?"UTC "+this._timezoneStringValue():this.model.timeZone),i[this.model.appointmentSettings.recurrence]=!1,t.isNullOrUndefined(this.model.group)&&(t.isNullOrUndefined(this.model.resources)||!t.scheduleFeatures.resources)||(i=this._getResourceFields(i)),"null"in i&&delete i[null],f={appointment:i},this._trigger("actionBegin",{data:f.appointment,requestType:"appointmentSave"}))||this._trigger("appointmentSaved",f))return this._quickAppointWindow.ejDialog("close"),!1;this._currentAction==t.Schedule.Actions.Add;f.appointment.Guid=this._guidFormatGenerate();n.extend(!0,gt={},f.appointment);h=this._timeZoneAppointments(gt,"");w=this._dataManager.insert(h);new t.DataManager(this._currentAppointmentData).update("AppTaskId",f.appointment);u=this;n.isFunction(w.promise)&&this.dataSource()instanceof t.DataManager?(w.done(function(i){if(u.model.enableLoadOnDemand)u._initDataSource("refresh");else{var r=t.isNullOrUndefined(i.record)?i:i.record;u._currentAppointmentData.length=0;u._dateFormat(r);u._bindAppointments=!0;u._currentAppointmentData=n.merge(u._currentAppointmentData,r);u._dataProcessing(r);u._renderAppointmentAll()}u._trigger("actionComplete",{data:f.appointment,requestType:"appointmentSave"})}),w.fail(function(){})):(this._processed.push(f.appointment),this._appMainId=i.AppTaskId+1,this._renderSingleApp(i,f.appointment),this._appMainId=this._sortAppById(this._processed)[this._processed.length-1].AppTaskId,this._trigger("actionComplete",{data:f.appointment,requestType:"appointmentSave"}));this._cellClick=!1;this._quickAppointWindow.ejDialog("close")}else{for(i={},h={},ni=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),b=this._currentAction==t.Schedule.Actions.Add||this._currentAction==t.Schedule.Actions.EditOcurrence?this.model.enableLoadOnDemand?this._dataCount+1:t.isNullOrUndefined(this._appMainId)?parseInt(this._appId):this._appMainId+1:ni[0].AppTaskId,p=n("#"+this._id+"AppointmentAddEditWindow").find("#"+this._id+"_AddEditForm").get(0),st=[],rt=[],s=0;s<p.length;s++)l=p[s].name,k=n(p[s]),l!=r&&(this.model.appointmentSettings.startTimeZone==null&&this.model.appointmentSettings.endTimeZone==null&&l==""&&(l=p[s].id.replace(this._id,"")),v=p[s].value,l!=""&&i[l]==null?(l==this.model.appointmentSettings.id&&(v=v==""?parseInt(b):parseInt(v)),n(p[s]).hasClass("e-datepicker")?v=k.ejDatePicker("option","value"):n(p[s]).hasClass("e-datepicker")?v=k.ejTimePicker("option","value"):k.data("ejDropDownList")?v=k.ejDropDownList("model.value"):k.data("ejAutocomplete")&&(n(p[s])[0].id==this._id+"_categorize"?rt.push(k.data("ejAutocomplete").getSelectedItems()):st.push(k.data("ejAutocomplete").getSelectedItems())),l!="StartDate"&&l!="EndDate"&&l!="StartTime"&&l!="EndTime"?i[l]=p[s].type!="checkbox"?v:n(p[s]).is(":checked"):h[l]=l=="StartDate"||l=="EndDate"?new Date(v):v):k.data("ejAutocomplete")&&(n(p[s])[0].id==this._id+"_categorize"?rt.push(k.data("ejAutocomplete").getSelectedItems()):st.push(k.data("ejAutocomplete").getSelectedItems())));if(this.model.categorizeSettings.enable==!0&&this.model.categorizeSettings.allowMultiple!=!0&&(ti=this.model.categorizeSettings,categorizeDataIndex=this._findResourceIndex(ti.dataSource,this.model.categorizeSettings.text,i[this._id+"_categorize"]),rt[0].push(this.model.categorizeSettings.dataSource[categorizeDataIndex]),rt[0].shift()),"null"in i&&delete i[null],ht=this._timeFormat(this._startSlotChange||t.isNullOrUndefined(this.cur_StartTime)?h.StartTime:new Date(this.cur_StartTime).toTimeString()).split(":"),ct=this._timeFormat(this._endSlotChange||t.isNullOrUndefined(this.cur_EndTime)?h.EndTime:new Date(this.cur_EndTime).toTimeString()).split(":"),i[this.model.appointmentSettings.startTime]=new Date(h.StartDate.setHours(parseInt(ht[0],10),parseInt(ht[1],10))),i[this.model.appointmentSettings.endTime]=new Date(h.EndDate.setHours(parseInt(ct[0],10),parseInt(ct[1],10))),i[this.model.appointmentSettings.recurrence]&&(i[this.model.appointmentSettings.recurrenceRule]=this._recRule),this._publicMethodSave=!0,v=this._timeZoneSavingAppoint(i,h),i=v.obj,nt=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),y=new t.DataManager(this._processed).executeLocal(nt),i[this.model.appointmentSettings.recurrenceRule]!=""&&!t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])&&this.model.enableRecurrenceValidation&&(this._currentAction=="editSeries"||this._currentAction=="editOcurrence"||this._currentAction=="save"))if(this._currentAction=="editOcurrence"||this._currentAction=="save"){var ut=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],ii=ut[this.model.appointmentSettings.recurrenceId]==null?ut.ParentId:ut[this.model.appointmentSettings.recurrenceId],wt=ut[this.model.appointmentSettings.recurrenceId]==null?"ParentId":this.model.appointmentSettings.recurrenceId,d=new t.DataManager(this._processed).executeLocal((new t.Query).where(wt,t.FilterOperators.equal,ii)),li=(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5<24&&i[this.model.appointmentSettings.endTime].getDate()!=i[this.model.appointmentSettings.startTime].getDate();li&&(d=this._recurrenceAppSort(d));var d=this._appointmentRecurrenceSort(d),s=this._recuCollectionIndex(d,ut),tt=this.model.appointmentSettings;if(s==0?t.isNullOrUndefined(d[s+1])?!1:!(new Date(new Date(d[s+1][tt.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[tt.endTime]).setHours(0,0,0,0)).getTime()):s==d.length-1?!(new Date(new Date(d[s-1][tt.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[tt.startTime]).setHours(0,0,0,0)).getTime()):!(new Date(new Date(d[s-1][tt.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[tt.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(d[s+1][tt.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[tt.endTime]).setHours(0,0,0,0)).getTime()))return n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert")),this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("CreateError")),this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok")),this._alertWindow.ejDialog("open"),!1}else if(!this._recurrenceValidate(i[this.model.appointmentSettings.recurrenceRule],y[0][this.model.appointmentSettings.recurrenceExDate]))return n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert")),this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("CreateError")),this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok")),this._alertWindow.ejDialog("open"),!1;if(this._currentAction==t.Schedule.Actions.EditOcurrence)this._objDate=y,wt=this._objDate[0][this.model.appointmentSettings.recurrenceId]==null?"ParentId":this.model.appointmentSettings.recurrenceId,o=this._deleteOcurrence(this._objDate[0][wt],new Date(y[0][this.model.appointmentSettings.startTime])),new t.DataManager(this._processed).remove("Guid",this._appUid),i[this.model.appointmentSettings.recurrence]=1,i[this.model.appointmentSettings.recurrenceRule]=o[0][this.model.appointmentSettings.recurrenceRule]+";RECUREDITID="+o[0].AppTaskId,i[this.model.appointmentSettings.recurrenceId]=o[0][this.model.appointmentSettings.recurrenceId],i.Guid=this._appUid,i[this.model.appointmentSettings.recurrenceExDate]=o[0][this.model.appointmentSettings.recurrenceExDate];else if(this._currentAction==t.Schedule.Actions.EditSeries){var ii=y[0][this.model.appointmentSettings.recurrenceId]==null?y[0].ParentId:y[0][this.model.appointmentSettings.recurrenceId],nt=(new t.Query).where("AppTaskId",t.FilterOperators.equal,ii),o=new t.DataManager(this._currentAppointmentData).executeLocal(nt);i.AppTaskId=o[0].AppTaskId;i[this.model.appointmentSettings.id]=o[0][this.model.appointmentSettings.id];b=o[0].AppTaskId;i[this.model.appointmentSettings.recurrenceId]=o[0][this.model.appointmentSettings.recurrenceId];i.Guid=this._appUid;i[this.model.appointmentSettings.recurrenceExDate]=o[0][this.model.appointmentSettings.recurrenceExDate];i[this.model.appointmentSettings.recurrenceRule]=t.isNullOrUndefined(this._recRule)||this._recRule==""?o[0][this.model.appointmentSettings.recurrenceRule]:this._recRule}if(this._currentAction!=t.Schedule.Actions.Add){if((i.Guid=y[0].Guid,i.AppTaskId=y[0].AppTaskId,i[this.model.appointmentSettings.id]=this._currentAction!=t.Schedule.Actions.EditSeries?y[0][this.model.appointmentSettings.id]:i[this.model.appointmentSettings.id],this._trigger("actionBegin",{data:i,requestType:"appointmentEdit"}))||this._trigger("appointmentEdited",{appointment:i}))return this._appointmentAddWindow.ejDialog("close"),!1}else if((i.Guid=t.isNullOrUndefined(i.Guid)?this._guidFormatGenerate():i.Guid,this._trigger("actionBegin",{data:i,requestType:"appointmentSave"}))||this._trigger("appointmentSaved",{appointment:i}))return this._appointmentAddWindow.ejDialog("close"),!1;if(f=[],this._startTimezone!=this._endTimezone?i[this.model.appointmentSettings.endTime]=v.cloneEnddiffer:"",!t.isNullOrUndefined(this.model.categorizeSettings)&&rt.length>0||!t.isNullOrUndefined(this.model.resources)&&t.scheduleFeatures.resources?f=this._getResCategorySaveData(rt,st,i,b,h,ht,ct):(at=this._currentAction==t.Schedule.Actions.EditOcurrence||!t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])&&i[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1?this._parentId:this._currentAction==t.Schedule.Actions.Save?y[0].AppTaskId:b,this._maxId=(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/36e5>24&&this._currentAction!=t.Schedule.Actions.EditOcurrence&&i[this.model.appointmentSettings.allDay]==!0?at:this._currentAction==t.Schedule.Actions.Save?y[0].AppTaskId:this._appMainId+1,this._maxId=(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/36e5>24&&!t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])&&i[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1&&this._currentAction==t.Schedule.Actions.Save?y[0].AppTaskId:this._maxId,this._maxId=this._currentAction==t.Schedule.Actions.EditSeries?at:this._maxId,lt=this._addAppData(i,this._maxId,new Date(i[this.model.appointmentSettings.startTime]),new Date(i[this.model.appointmentSettings.endTime]),at),this._currentAction==t.Schedule.Actions.EditOcurrence&&(lt[this.model.appointmentSettings.id]=lt.AppTaskId),f.push(lt)),f[this.model.appointmentSettings.startTime]>f[this.model.appointmentSettings.endTime])return!1;if(this._currentAction==t.Schedule.Actions.Add||this._currentAction==t.Schedule.Actions.EditOcurrence){for(this._maxId=b,u=this,h=[],g=0;g<f.length;g++)vt=f[g][this.model.appointmentSettings.startTimeZone],vt!=this.model.timeZone?h.push(this._timeZoneAppointments(f[g],"")):h.push(f[g]);for(it=0;it<f.length;it++)new t.DataManager(this._currentAppointmentData).update("AppTaskId",f[it]);for(o=[],this._currentAction==t.Schedule.Actions.EditOcurrence?(nt=(new t.Query).where("AppTaskId",t.FilterOperators.equal,this._parentId),bt=new t.DataManager(this._currentAppointmentData).executeLocal(nt),new t.DataManager(this._currentAppointmentData).update("AppTaskId",bt[0]),o.push(this._timeZoneAppointments(bt[0],""))):o=[],w=this.dataSource()instanceof t.DataManager?this._dataManager.saveChanges({added:h,changed:o,deleted:[]},this.model.appointmentSettings.id):this._dataManager.saveChanges({added:h,changed:o,deleted:[]},"AppTaskId"),ft=[],a=0;a<h.length;a++)ft=vt!=this.model.timeZone?this._timeZoneAppointments(h[a],"reverse"):h[a],new t.DataManager(this._currentAppointmentData).update("AppTaskId",ft);for(kt=[],a=0;a<o.length;a++)kt=vt!=this.model.timeZone?this._timeZoneAppointments(o[a],"reverse"):o[a],new t.DataManager(this._currentAppointmentData).update("AppTaskId",kt);if(n.isFunction(w.promise)&&this.dataSource()instanceof t.DataManager)w.done(function(i){if(u.model.enableLoadOnDemand)u._initDataSource("refresh");else{var r=t.isNullOrUndefined(i.record)?i:i.record;u._currentAppointmentData.length=0;u._dateFormat(r);u._bindAppointments=!0;u._currentAppointmentData=n.merge(u._currentAppointmentData,r);u._dataProcessing(r);u._renderAppointmentAll()}u._trigger("actionComplete",{data:f,requestType:"appointmentSave"})}),w.fail(function(){});else{for(ri=f[0][this.model.appointmentSettings.recurrence]?1:f.length,e=0;e<ri;e++)this.model.timeScale.enable&&this._appointmentProcessing(f[e]),this._currentAction==t.Schedule.Actions.EditOcurrence&&(this.element.find("[guid="+this._appUid+"]").remove(),this.element.find("#categorybar_"+this._appUid).remove()),this.model.timeScale.enable?this.dataSource()instanceof t.DataManager||this._renderSingleApp(i,f[e]):(ui=Math.ceil((i.EndTime-i.StartTime)/864e5),fi=ui>1?!0:!1,fi||this._mediaQuery?(this._appointmentProcessing(f[e]),this._renderAppointmentAll()):i.Recurrence==!0||this._mediaQuery?(this._appointmentProcessing(f[e]),this._renderSingleApp(i,f[e])):(this._processed.push(f[e]),this._renderSingleApp(i,f[e])),this._mediaQuery&&(this._unWireResizeEvents(),this._wireResizeEvents(),this._dragdropAppointments()));this._trigger("actionComplete",{data:f,requestType:"appointmentSave"})}}else if(this._currentAction==t.Schedule.Actions.Save||this._currentAction==t.Schedule.Actions.EditSeries){var dt=[],c=[],yt=[];for(e=0;e<f.length;e++)ei=this._currentAction==t.Schedule.Actions.Save?f[e].Guid:f[e][this.model.appointmentSettings.recurrenceId],oi=this._currentAction==t.Schedule.Actions.Save?"Guid":this.model.appointmentSettings.recurrenceId,nt=(new t.Query).where(oi,t.FilterOperators.equal,ei),o=new t.DataManager(this._currentAppointmentData).executeLocal(nt),!t.isNullOrUndefined(o)&&o.length>0?c.push(f[e]):dt.push(f[e]);if(this._currentAction==t.Schedule.Actions.EditSeries)for(e=0;e<c.length;e++)nt=t.Query().where(t.Predicate(this.model.appointmentSettings.recurrenceRule,t.FilterOperators.contains,"RECUREDITID="+f[e].ParentId,!0)),si=new t.DataManager(this._currentAppointmentData).executeLocal(nt),yt=yt.concat(si),this._appointmentAddWindow.find(".recurbutton").click(),c[e][this.model.appointmentSettings.recurrenceRule]=this._recRule,c[e][this.model.appointmentSettings.recurrenceExDate]=null;var u=this,w,et=[],ot=[];for(g=0;g<dt.length;g++)et.push(this._timeZoneAppointments(dt[g],""));for(it=0;it<c.length;it++)ot.push(this._timeZoneAppointments(c[it],""));for(w=this.dataSource()instanceof t.DataManager?this._dataManager.saveChanges({added:et,changed:ot,deleted:yt},this.model.appointmentSettings.id):this._dataManager.saveChanges({added:et,changed:ot,deleted:yt},"AppTaskId"),a=0;a<et.length;a++)ft=this._timeZoneAppointments(et[a],"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",ft);for(pt=0;pt<ot.length;pt++)hi=this._timeZoneAppointments(ot[pt],"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",hi);if(c.length>0)if(u=this,n.isFunction(w.promise)&&this.dataSource()instanceof t.DataManager)w.done(function(i){if(u.model.enableLoadOnDemand)u._initDataSource("refresh");else{var r=t.isNullOrUndefined(i.record)?i:i.record;u._currentAppointmentData.length=0;r.length>0&&u._dateFormat(r);u._bindAppointments=!0;u._currentAppointmentData=n.merge(u._currentAppointmentData,r);u._dataProcessing(r);u._renderAppointmentAll()}u._appMainId=u._processed.length>0?u._sortAppById(u._processed)[u._processed.length-1].AppTaskId:u._appMainId;u._trigger("actionComplete",{data:c,requestType:"appointmentEdit"})}),w.fail(function(){});else{for(e=0;e<c.length;e++)c[e][this.model.appointmentSettings.recurrence]||new Date(new Date(c[e][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(c[e][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(new Date(c[e][this.model.appointmentSettings.endTime])-new Date(c[e][this.model.appointmentSettings.startTime]))/36e5<24&&c[e][this.model.appointmentSettings.allDay]!==!0||new t.DataManager(this._currentAppointmentData).update("AppTaskId",c[e]),this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll(),this._appMainId=this._processed.length>0?this._sortAppById(this._processed)[this._processed.length-1].AppTaskId:this._appMainId;this._trigger("actionComplete",{data:c,requestType:"appointmentEdit"})}}}this._clearFields();this._appointmentAddWindow.ejDialog("close");this.element.find("div.e-draggableworkarea tr").find("td").hasClass("e-selectedCell")&&this._processFocus();this._recRule=""},_timeZoneSavingAppoint:function(n,i){var h,o,r,a;if(this._startTimezone=n[this.model.appointmentSettings.startTimeZone],this._endTimezone=n[this.model.appointmentSettings.endTimeZone],!t.isNullOrUndefined(this._startTimezone)&&this._startTimezone!=""){var s=this._startTimezone.indexOf("UTC")!=-1?this._startTimezone.split(" ")[1].split(":"):this._startTimezone.split(":"),u=parseInt(s[0]),f=parseInt(s[1]),e=u*60+f;if(this.model.timeZone==null?(h=(new Date).getTimezoneOffset()-this._timeZoneOffset,r=this._minToHour(h+(u*60+f))):(o=this.model.timeZone.indexOf("UTC")!=-1?this.model.timeZone.split(" ")[1].split(":"):this.model.timeZone.split(":"),r=this._minToHour(u*60+f),r.h=r.h-parseInt(o[0]),r.m=r.m-parseInt(o[1])),new Date(n[this.model.appointmentSettings.startTime].setHours(n[this.model.appointmentSettings.startTime].getHours()-r.h,n[this.model.appointmentSettings.startTime].getMinutes()-r.m)),this._startTimezone!=this._endTimezone&&this._publicMethodSave){this.startutcValue=null;this.tempValue=null;var c=this._endTimezone.indexOf("UTC")!=-1?this._endTimezone.split(" ")[1].split(":"):this._endTimezone.split(":"),v=parseInt(c[0]),y=parseInt(c[1]),p=v*60+y;e=e-p;var w=new Date(i.StartDate),b=new Date(n[this.model.appointmentSettings.startTime]),l=new Date(i.EndDate);duration=new Date(l.setMinutes(l.getMinutes()+e));duration=new Date(duration.setMinutes(duration.getMinutes()-(r.h*60+r.m)));a=duration}else new Date(n[this.model.appointmentSettings.endTime].setHours(n[this.model.appointmentSettings.endTime].getHours()-r.h,n[this.model.appointmentSettings.endTime].getMinutes()-r.m))}return{obj:n,cloneEnddiffer:a}},_renderAllDayAppointments:function(){var s=this.cellwidth-20,f,i,u,r,n,e,o;for(this.level=0,f=this._dateRender,allDayCount=[],this.element.find(".e-alldayappointment").remove(),i=this._appointmentSort(this._processed),this.model.group||(this.res1=["0"]),u=0;u<this.res1.length;u++)for(r=0;r<f.length;r++)for(n=0;n<i.length;n++)t.isNullOrUndefined(this.model.resources)||t.isNullOrUndefined(this.model.group)||!t.scheduleFeatures.resources?(e=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where(t.Predicate("Guid",t.FilterOperators.equal,i[n].Guid))),o=e.length>0?(e[0][this.model.appointmentSettings.endTime]-e[0][this.model.appointmentSettings.startTime])/36e5>=24:(i[n][this.model.appointmentSettings.endTime]-i[n][this.model.appointmentSettings.startTime])/36e5>=24,Globalize.format(new Date(f[r]),this._pattern.d)==Globalize.format(new Date(i[n][this.model.appointmentSettings.startTime]),this._pattern.d)&&(i[n][this.model.appointmentSettings.allDay]===!0||o)&&(this._setAllDayPos(i[n],r,u),this._filtered.push(i[n]),allDayCount.push(n))):(this._getMultipleResourceAlldayApp(f,r,u,n),t.isNullOrUndefined(this.allDayCount[0])?"":allDayCount.push(this.allDayCount[0])),this._app=this._filtered;allDayCount.length==0&&this.level==0&&(this._mediaQuery?this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd,.e-schedulesettings").attr("style","height:40px !important"):this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd,.e-schedulesettings").css("height","27px"),this.element.find(".e-alldaycells").first().css(this.model.enableRTL?"border-right":"border-left","none"));this._reRenderScroller()},_renderSingleApp:function(i,r){var a=new Date(new Date(i[this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5<24&&i[this.model.appointmentSettings.allDay]!==!0&&i[this.model.appointmentSettings.recurrence]!=1,f,v,o,l,s,u,e;if(this.element.find(".e-prevapp,.e-nextapp").css("display","none"),(i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5>24||a||i[this.model.appointmentSettings.recurrence]==1)this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll();else if(this.currentView()!="agenda"){for(a||r[this.model.appointmentSettings.recurrence]==!0&&r[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")==-1?f=new t.DataManager(this._processed).executeLocal((new t.Query).where("ParentId",t.FilterOperators.equal,r.ParentId)):(f=[r],v=f[0].Guid),o=0;o<f.length;o++){var u=f[o][this.model.appointmentSettings.startTime],e=this.currentView()=="day"&&new Date(new Date(this._dateRender[0]).setHours(0,0,0,0)).getTime()==new Date(new Date(i[this.model.appointmentSettings.startTime]).setHours(0,0,0)).getTime()?0:this.model.orientation=="horizontal"&&this.currentView()=="month"?n.inArray(new Date(u.getFullYear(),u.getMonth(),u.getDate()).getTime(),this.monthDays):this.currentView()=="day"?-1:n.inArray(new Date(u.getFullYear(),u.getMonth(),u.getDate()).getTime(),this._dateRender),h=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this._findResourceIndex(this.res1,this.model.resources[this.model.resources.length-1].resourceSettings.id,r[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):0,c=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(this._dateRender[e]));if(c=c.and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(this._dateRender[e]).setHours(23,59,59))),c=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?c.and(this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1],t.FilterOperators.equal,this.res1[h][this.model.resources[this.model.resources.length-1].resourceSettings.id]):c,l=new t.DataManager(this._processed).executeLocal((new t.Query).where(c)),this._appList=this.currentView()!=="month"&&!this._isCustomView()&&!i[this.model.appointmentSettings.allDay]?this._alldaySort(l):l,this.model.timeScale.enable?this.currentView()!=="month"&&!this._isCustomView()?this.model.orientation=="vertical"&&e>=0&&(i[this.model.appointmentSettings.allDay]||Math.round((i[this.model.appointmentSettings.endTime]-i[this.model.appointmentSettings.startTime])/36e5)>=24)?this._renderAllDayAppointments():this._renderApp(f[o],e,h):this._renderAppointmentMonth(f[o],e,h):(this._renderAppointmentMonth(f[o],e,h),f[o][this.model.appointmentSettings.allDay]!=!0&&(this._dragDrop&&this._renderMonthAppointment(),this._dragDrop&&this._monthOverlap(f[o]))),this.overlapList.length>1)for(s=0;s<this.overlapList.length;s++)this.element.find("#Appointment_"+this.overlapList[s].AppTaskId).remove(),this.element.find("#categorybar_"+this.overlapList[s].AppTaskId).remove(),u=this.overlapList[s][this.model.appointmentSettings.startTime],e=this.currentView()=="day"?0:this.model.orientation=="horizontal"&&this.currentView()=="month"?n.inArray(new Date(u.getFullYear(),u.getMonth(),u.getDate()).getTime(),this.monthDays):n.inArray(new Date(u.getFullYear(),u.getMonth(),u.getDate()).getTime(),this._dateRender),this.model.timeScale.enable?this.currentView()=="month"||this._isCustomView()?this._renderAppointmentMonth(this.overlapList[s],e,h):this._renderApp(this.overlapList[s],e,h):this._renderAppointmentMonth(this.overlapList[s],e,h);this._currentAction!=t.Schedule.Actions.Save||i[this.model.appointmentSettings.allDay]||this.currentView()==="month"||this._isCustomView()||this._reRenderApp(r);this._currentAction=""}this._unWireResizeEvents();this._wireResizeEvents();this._dragdropAppointments()}else this._renderAgendaContent()},_timeFormat:function(n){var e=Globalize.culture(this.model.locale),i=Number(n.match(/^(\d+)/)[1]),o=Number(n.match(/:(\d+)/)[1]),f,r,u;return t.isNullOrUndefined(n.split(" ")[1])||(f=n.match(/\s(.*)$/)[1],f==e.calendar.PM[0]&&i<12&&(i=i+12),f==e.calendar.AM[0]&&i==12&&(i=i-12)),r=i.toString(),u=o.toString(),i<10&&(r="0"+r),o<10&&(u="0"+u),r+":"+u},_processEscapeKey:function(){this._processFocus();this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")},_processFocus:function(){var s=this.element.find("div.e-selectedAppointment"),o,l;if(s.length!=0&&s.focus(),this.element.find("td.e-selectedCell").hasClass("e-workcells")){var r=this.element.find("div.e-draggableworkarea tr"),h=r.length-1,i,t,c,f,u,e=this.currentView(),a=this;this.element.find("td.e-selectedCell").each(function(o,s){var l=n(s).index(),a;if(l!=null&&!isNaN(l))if(i==null?(i=l,c=n(s).parent()[0].rowIndex):i<l?i=i:i!=l&&(i=l,c=n(s).parent()[0].rowIndex),t==null){if(t=l,e!="month")for(u=parseInt(t),a=0;a<=h;a++)n(r[a].cells[u]).hasClass("e-selectedCell")&&(f=a)}else if(t>l)t=t;else if(t!=l&&(t=l,e!="month"))for(u=parseInt(t),a=0;a<=h;a++)n(r[a].cells[u]).hasClass("e-selectedCell")&&(f=a)});e!="month"?n(r[f].cells[t]).attr("tabIndex",0).focus():(o=r.find("td.e-selectedCell"),l=parseInt(o.length)-1,n(o[l]).attr("tabIndex",0).focus())}else this.element.focus(),this.element.find("td.e-selectedCell").attr("tabIndex",0).focus()},_clearFields:function(){this._appointmentAddWindow.find(".subject").val("");this._appointmentAddWindow.find(".id").val("");this._appointmentAddWindow.find(".e-description").val("").css("height","");this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",Globalize.format(new Date,this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",Globalize.format(new Date,this._pattern.d));this._appointmentAddWindow.find(".startendtime").ejTimePicker({enabled:!0});this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(new Date,this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(new Date,this._pattern.t));this._appointmentAddWindow.find(".recurrence,.weekdays").ejCheckBox({checked:!1,enabled:!0});this._appointmentAddWindow.find(".e-repeatlbl").removeClass("e-disable");this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!1});this._appointmentAddWindow.find(".startutc,.endutc").ejDropDownList("clearText");this._appointmentAddWindow.find("."+this._id+"summary").css("display","none");this._appointmentAddWindow.find(".e-recurFinalRule").html("");this._appointmentAddWindow.find(".e-recuredit").hide();this._appointmentAddWindow.find(".e-categorizevalue").ejAutocomplete("clearText")},_getNumericModel:function(){return numericModel={width:"100px",minValue:1,value:1,cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,localize:this.model.locale}},_recurClearFields:function(){for(var i=this._appointmentAddWindow.find("input[type='checkbox'][name='weekdays']"),t=0;t<i.length;t++)n(i[t]).ejCheckBox({checked:!1});this._appointmentAddWindow.find(".e-recurevery").ejNumericTextbox({value:1});this._appointmentAddWindow.find(".e-recurcount").ejNumericTextbox({value:10});this._appointmentAddWindow.find(".e-recurRule").html("")},_deleteApp:function(r){var w=this.level,s,c,l,f,u,y,o,e,a,d,p,h,v;if(this._trigger("actionBegin",{id:r,requestType:"appointmentDelete"})||(l=(new t.Query).where("Guid",t.FilterOperators.equal,r),f=t.DataManager(this._processed).executeLocal(l),f.length==0)||(this._getNewOverlapList(f[0]),s={appointment:f},this._trigger("appointmentDeleted",s)))return!1;if(u=this._getAppointmentByParentId(r),f[0][this.model.appointmentSettings.recurrence]){var b=f[0][this.model.appointmentSettings.recurrenceId]==null?f[0].ParentId:f[0][this.model.appointmentSettings.recurrenceId],k=f[0][this.model.appointmentSettings.recurrenceId]==null?"ParentId":this.model.appointmentSettings.recurrenceId,l=(new t.Query).where(k,t.FilterOperators.equal,b);c=t.DataManager(this._currentAppointmentData).executeLocal(l);o=this.dataSource()instanceof t.DataManager?this._dataManager.saveChanges({added:[],changed:[],deleted:c},this.model.appointmentSettings.id):this._dataManager.saveChanges({added:[],changed:[],deleted:c},"AppTaskId")}else y=f.length==0?r:u.AppTaskId,o=this.dataSource()instanceof t.DataManager?this._dataManager.remove("Id",u[this.model.appointmentSettings.id]):this._dataManager.remove("AppTaskId",y);if(e=this,!t.isNullOrUndefined(o))if(n.isFunction(o.promise))o.done(function(i){if(e.model.enableLoadOnDemand)e._initDataSource("refresh");else{var r=t.isNullOrUndefined(i.record)?i:i.record;e._currentAppointmentData.length=0;e._dateFormat(r);e._bindAppointments=!0;e._currentAppointmentData=n.merge(e._currentAppointmentData,r);e._dataProcessing(r);e._renderAppointmentAll()}e._trigger("actionComplete",{data:u,requestType:"appointmentDelete"})}),o.fail(function(){});else{if(a=new Date(new Date(u[this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(u[this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(u[this.model.appointmentSettings.endTime]-u[this.model.appointmentSettings.startTime])/36e5<24&&u[this.model.appointmentSettings.allDay]!==!0&&u[this.model.appointmentSettings.recurrence]!=1,this.currentView()!="agenda")if(this._currentAppointmentData.length>0)this.model.timeScale.enable?u[this.model.appointmentSettings.recurrence]||a||(new Date(u[this.model.appointmentSettings.endTime])-new Date(u[this.model.appointmentSettings.startTime]))/36e5>24?(d=u[this.model.appointmentSettings.recurrence]?f[0][this.model.appointmentSettings.recurrenceId]==null?f[0].ParentId:f[0][this.model.appointmentSettings.recurrenceId]:f[0].AppTaskId,new t.DataManager(this._currentAppointmentData).remove("AppTaskId",u.AppTaskId),this._dataProcessing(this._currentAppointmentData),this._renderAppointmentAll()):(new t.DataManager(this._processed).remove("Guid",r),this.element.find("[guid="+r+"]").remove(),this.element.find("#categorybar_"+r).remove(),this.currentView()!=="month"&&!this._isCustomView()?this.model.orientation=="vertical"&&f[0][this.model.appointmentSettings.allDay]==1?this._reRenderAllDayAppointments():this._reRenderApp(f[0]):this._renderAppointmentAll()):u[this.model.appointmentSettings.recurrence]||a||(new Date(u[this.model.appointmentSettings.endTime])-new Date(u[this.model.appointmentSettings.startTime]))/36e5>24?this._recurrenceIdDelete(f[0].ParentId)&&this._dataProcessing(this._currentAppointmentData)&&this._renderAppointmentAll():new t.DataManager(this._processed).remove("Guid",r)&&this.element.find("[guid="+r+"]").remove()&&this.element.find("#categorybar_"+r).remove()&&this._renderAppointmentAll();else for(p=(new t.Query).where("ParentId",t.FilterOperators.equal,u.ParentId),h=new t.DataManager(this._processed).executeLocal(p),i=0;i<h.length;i++)this.element.find("[guid="+h[i].Guid+"]").remove(),this.element.find("#categorybar_"+h[i].Guid).remove(),new t.DataManager(this._processed).remove("Guid",h[i].Guid);else new t.DataManager(this._processed).remove("Guid",r),this._recurrenceIdDelete(f[0].ParentId),this._renderAgendaContent();this._trigger("actionComplete",{data:u,requestType:"appointmentDelete"});this.model.timeScale.enable&&((s.appointment[0][this.model.appointmentSettings.endTime]-s.appointment[0][this.model.appointmentSettings.startTime])/36e5>24||s.appointment[0][this.model.appointmentSettings.allDay])&&this.currentView()!="month"&&!this._isCustomView()&&this.currentView()!="agenda"&&w==0&&(this._mediaQuery?this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd,.e-schedulesettings").attr("style","height:40px !important"):this.element.find(".e-alldaycells,.e-leftindent,.e-emptyalldaytd,.e-schedulesettings").css("height","27px"),this.element.find(".e-alldaycells").first().css(this.model.enableRTL?"border-right":"border-left","none"),this._reRenderScroller())}v=this._appointmentCount();v.length<1&&this.model.enableAppointmentNavigation&&this._nextPrevButton(v)},_appointmentCount:function(){var n=this._dateRender,i=this._processed,u,r;return i=this._sortAppById(i),i=this._appointmentSort(i),u=this.currentView()=="agenda"?new Date(new Date(new Date(n[0]).setDate(n[0].getDate()+(this.model.agendaViewSettings.daysInAgenda>0?this.model.agendaViewSettings.daysInAgenda-1:0))).setHours(23,59,59)):new Date(new Date(n[n.length-1]).setHours(23,59,59)),r=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(n[0])),r=r.and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,u),new t.DataManager(i).executeLocal((new t.Query).where(r))},_reRenderAllDayAppointments:function(){this._alldayLevel=this.level==1?!0:!1;this.model.showAllDayRow&&this.element.find("div.e-alldayappointment").remove()&&this._renderAllDayAppointments();this._unWireResizeEvents();this._wireResizeEvents();this._dragdropAppointments()},_recurrenceIdDelete:function(n){for(var u=t.Query().where(t.Predicate("ParentId",t.FilterOperators.equal,n)),r=new t.DataManager(this._processed).executeLocal(u),i=0;i<r.length;i++)new t.DataManager(this._processed).remove("Guid",r[i].Guid),this.element.find("[guid="+r[i].Guid+"]").remove(),this.element.find("#categorybar_"+r[i].Guid).remove()},_appointmentResizeStart:function(i){if(this.model.enableAppointmentResize){var r={element:n(i.target).parent()};if((this._appointdata=n(i.target).parent(),this._trigger("actionBegin",{data:r,requestType:"appointmentResize"}))||this._trigger("resizeStart",r)||(i.preventDefault(),this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),this.resizeStart=!0,n(i.target).hasClass("e-lefthandle")||n(i.target).hasClass("e-righthandle")?(this.resize=i.pageX,this.appoint_width=n(i.target).parent().width(),this.appoint_left=parseInt(n(i.target).parent()[0].style.left),this._appointleft=parseInt(n(n(i.target).parent()[0]).offset().left),this._appointright=parseInt(n(n(i.target).parent()[0]).css("right")),this.model.orientation=="horizontal"&&this.model.enableRTL?n(i.target).hasClass("e-lefthandle")?this._rightResizing=!0:this._leftResizing=!0:n(i.target).hasClass("e-lefthandle")?this._leftResizing=!0:this._rightResizing=!0):(n(i.target).hasClass("e-tophandle")||n(i.target).hasClass("e-bottomhandle"))&&(this.resize=i.pageY,this.appoint_height=n(i.target).parent().height(),this.appoint_top=parseInt(n(i.target).parent()[0].style.top),n(i.target).hasClass("e-tophandle")?this._topResizing=!0:this._bottomResizing=!0),this._curElmt=n(i.target).parent(),this.element.find(".e-workcells").removeClass("e-selectedCell,e-mousehover"),n(document).bind(t.eventType.mouseMove,n.proxy(this._appointmentResizing,this)),n(document).bind(t.eventType.mouseUp,n.proxy(this._appointmentResizeStop,this)),n(i.target).hasClass("e-rowcursor")||n(i.target).hasClass("e-columncursor")))return!1}},_appointmentResizing:function(t){var i=n(t.target),r={element:i.parent()},u=n(t.target).hasClass("e-appointment")||n(t.target).hasClass("e-monthappointment")||n(t.target).hasClass("e-workcells")||n(t.target).hasClass("e-monthcells")||n(t.target).hasClass("e-alldayappointment")||n(t.target).hasClass("e-alldaycells")?n(t.target):n(t.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment"),f=this.element.find(".e-workcells").height(),e=n(u[0]).height()/f;if(this._trigger("resize",r))return!1;this._topResizing?e>0&&!n(t.target).hasClass("e-alldaycells")&&!n(t.target).hasClass("e-apptext")&&(this._curElmt.height(this.appoint_height+this.resize-t.pageY+3),this._curElmt.css("top",this.appoint_top-(this.resize-t.pageY)-3)):this._bottomResizing?this._curElmt.height(this.appoint_height+(t.pageY-this.resize)+2):this._rightResizing?this.model.orientation=="horizontal"&&this.model.enableRTL?(this._curElmt.width(this.appoint_width+this.resize-t.pageX+3),this._curElmt.css("left",this.appoint_left-(this.resize-t.pageX)-3)):(this._curElmt.width(this.appoint_width+(t.pageX-this.resize)+2),this._curElmt.css("right",this._appointright-(t.pageX-this.resize)-2)):this._leftResizing&&(this.model.orientation=="horizontal"&&this.model.enableRTL?(this._curElmt.width(this.appoint_width+(t.pageX-this.resize)+2),this._curElmt.css("right",this._appointright-(t.pageX-this.resize)-2)):(this._curElmt.width(this.appoint_width+this.resize-t.pageX+3),this._curElmt.css("left",this.appoint_left-(this.resize-t.pageX)-3)))},_appointmentResizeStop:function(i){var at,dt,nr,hi,ht,ci,ft,li,wt,vt,ot,v,ct,k,ti,ni,kt,ii,ri,et,ui,s,tt,a,yt,o,bt,g,b,vi,l,fi,lt;try{at=this.element.find(".e-draggableworkarea");this.resizeStart=!1;n(document).unbind(t.eventType.mouseMove,n.proxy(this._appointmentResizing,this));n(document).unbind(t.eventType.mouseUp,n.proxy(this._appointmentResizeStop,this));var f=this.model.appointmentSettings,rr=this._currentAppointmentData,yi=this.element.find(".e-workcellstab"),pi=yi.find("tr").length*this.element.find(".e-workcells").height(),h=n(i.target).hasClass("e-appointment")||n(i.target).hasClass("e-monthappointment")||n(i.target).hasClass("e-alldayappointment")?n(i.target):n(i.target).parents(".e-appointment,.e-alldayappointment,.e-monthappointment");h.length==0&&(h=this._appointdata);h[0].id!=this._appointdata[0].id&&(h=this._appointdata);this._appUid=h.attr("guid");var y=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),it=y.length>1?!0:!1,p=y[0][f.recurrence]&&y[0][f.recurrenceRule].toString().indexOf("RECUREDITID")==-1?this._getAppointmentByParentId(this._appUid):y[0][f.recurrence]?y[0]:this._getAppointmentByParentId(this._appUid),w=this.currentView()==="week"||this.currentView()==="month"||this._isCustomView()?7:this.currentView()==="workweek"&&this.model.workWeek.length>0?this.model.workWeek.length:1;if(w=this.currentView()=="customview"&&this._renderDays<=7?this._renderDays:w,p!=null||p!==r){var ur=p[this.model.appointmentSettings.startTime].getDate()<new Date(p[this.model.appointmentSettings.endTime]).getDate()?!0:!1,e=new Date(p[this.model.appointmentSettings.startTime]),u=new Date(p[this.model.appointmentSettings.endTime]);it&&y[0][f.recurrence]?(dt=this._sortAppById(new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,y[0].Guid))),e=new Date(dt[0][this.model.appointmentSettings.startTime]),u=new Date(dt[1][this.model.appointmentSettings.endTime])):y[0][f.recurrence]&&(e=new Date(y[0][this.model.appointmentSettings.startTime]),u=new Date(y[0][this.model.appointmentSettings.endTime]));var rt=p[this.model.appointmentSettings.startTime],d=p[this.model.appointmentSettings.endTime],ei=n(h[0]).height();if(this.currentView()!=="month"&&!this._isCustomView())var wi=n(h[0]).offset().top,ut=this.element.find(".e-workcells").height(),oi=at.height()+at.scrollTop(),si=wi-at.offset().top+at.scrollTop(),st=si-ut/this.model.timeScale.minorSlotCount<oi?si:oi-ei;var bi=n(h[0]).height()/ut,ki=(st+bi*ut)*this.model.timeScale.majorSlot/(this.model.timeScale.minorSlotCount*(ut+1))/30,di=ei-parseInt(ki),gi=st+di;if(this._topResizing)nr=this._topResizing,st>0?(ht=st*this.model.timeScale.majorSlot/(this.model.timeScale.minorSlotCount*(ut+1)),e.setHours(parseInt(this.model.startHour)+parseInt(ht/60)),e.setMinutes(parseInt(ht%60)),e.setMinutes(e.getMinutes()*1)):e.setHours(0,0,0),this._topResizing=!1;else if(this._bottomResizing)hi=this._bottomResizing,st>=0&&gi<pi?(ci=n(h[0]).height()/ut,ht=(st+ci*ut)*this.model.timeScale.majorSlot/(this.model.timeScale.minorSlotCount*(ut+1)),u.setHours(parseInt(this.model.startHour)+parseInt(ht/60)),u.setMinutes(ht%60),u.setMinutes(u.getMinutes()*1)):u.setHours(23,59,59),this._bottomResizing=!1;else if(this._leftResizing)this.model.orientation=="vertical"?(o=this.model.group?this._findResourceIndex(this.res1,this.model.resources[this.model.resources.length-1].resourceSettings.id,p[this.model.appointmentSettings.resourceFields.split(",")[this.model.resources.length-1]]):0,this.currentView()!=="month"&&!this._isCustomView()&&this.model.timeScale.enable?this.model.enableRTL?(ot=n(h[0]).width()-this.appoint_width,v=Math.round(ot/this.element.find(".e-alldaycells").width()),u=new Date(y[0][f.endTime]),u.setDate(new Date(u).getDate()+v),u.setHours(new Date(d).getHours(),new Date(d).getMinutes())):n(h[0]).offset().left>n(this.element.find(".e-alldaycells")[o*w]).offset().left&&(e=new Date(this._dateRender[0]),ft=n(h[0]).offset().left-n(this.element.find(".e-alldaycells")[o*w]).offset().left,v=Math.round(ft/(this.element.find(".e-alldaycells").width()+1)),e.setDate(new Date(e).getDate()+v),e.setHours(new Date(rt).getHours()),e.setMinutes(new Date(rt).getMinutes())):(vt=this.model.enableRTL?n(this.element.find(".e-monthcells")[(o+1)*w-1]).offset().left:n(this.element.find(".e-monthcells")[o*w]).offset().left,n(h[0]).offset().left>vt&&(this.model.enableRTL?(v=Math.round((n(h[0]).width()-this.appoint_width)/this.element.find(".e-monthcells").width()),u.setDate(new Date(u).getDate()+v),u.setHours(new Date(d).getHours(),new Date(d).getMinutes())):(this._resize=!0,e=new Date(this._firstweekdate(new Date(y[0][f.startTime]))),this._resize=!1,v=Math.round((n(h[0]).offset().left-n(this.element.find(".e-monthcells")[o*w]).offset().left)/this.element.find(".e-monthcells").width()),e.setDate(e.getDate()+v),e.setHours(new Date(rt).getHours(),new Date(rt).getMinutes()))))):(ft=n(this.element.find(".e-workcells.e-childworkcell")[0]).offset().left<n(h[0]).offset().left?n(h[0]).offset().left-this._appointleft:n(this.element.find(".e-workcells.e-childworkcell")[0]).offset().left-this._appointleft,this.model.enableRTL&&(li=n(h[0]).width()-this.appoint_width,ft=-li),this.currentView()=="month"||this._isCustomView()||!this.model.timeScale.enable?(v=Math.round(ft/(this.element.find(".e-workcells").width()+1)),e.setDate(new Date(e).getDate()+v)):(ct=ft*60/(this.element.find(".e-workcells").width()*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)+1),e.setHours(parseInt(new Date(e).getHours())+parseInt(ct/60)),e.setMinutes(new Date(e).getMinutes()+parseInt(ct%60)),e.setMinutes(e.getMinutes()*1),e<new Date(this._dateRender[0])&&(e=new Date(this._dateRender[0]))),e=new Date(e)),this._leftResizing=!1;else if(this._rightResizing){if(this.model.orientation=="vertical")if(o=this.model.group?this._findResourceIndex(this.res1,this.model.resources[this.model.resources.length-1].resourceSettings.id,p[this.model.appointmentSettings.resourceFields.split(",")[this.model.resources.length-1]]):0,this.currentView()!=="month"&&!this._isCustomView()&&this.model.timeScale.enable)if(this.model.enableRTL)ot=n(h[0]).width()-this.appoint_width,v=Math.round(ot/this.element.find(".e-alldaycells").width()),e=new Date(y[0][f.startTime]),e.setDate(new Date(e).getDate()-v),e.setHours(new Date(rt).getHours(),new Date(rt).getMinutes());else{var ft=h[0].offsetLeft+n(h[0]).width(),v=Math.floor(ft/this.element.find(".e-alldaycells").width())-o*w,vt=o==this.res1.length-1?n(this.element.find(".e-alldaycells")[(o+1)*w-1]).offset().left+this.element.find(".e-alldaycells").width():n(this.element.find(".e-alldaycells")[(o+1)*w]).offset().left;vt>=ft&&(this.model.workWeek.length>0?(u=new Date(this._dateRender[0]),u.setDate(new Date(this._dateRender[v]).getDate()),u.setMonth(new Date(this._dateRender[v]).getMonth()),u.setHours(new Date(d).getHours(),new Date(d).getMinutes())):(u=new Date(this._dateRender[0]),u.setDate(new Date(u).getDate()+(v>=w?v-1:v)),u.setHours(new Date(d).getHours(),new Date(d).getMinutes())))}else wt=this.element.find(".e-monthcells").width(),vt=this.model.enableRTL?n(this.element.find(".e-monthcells")[o*w]).offset().left+wt:o==this.res1.length-1?n(this.element.find(".e-monthcells")[(o+1)*w-1]).offset().left+wt:n(this.element.find(".e-monthcells")[(o+1)*w]).offset().left,vt>=n(h[0]).offset().left+n(h[0]).width()&&(v=Math.round((n(h[0]).width()-this.appoint_width)/wt),this.model.enableRTL?(e.setDate(new Date(e).getDate()-v),e.setHours(new Date(rt).getHours(),new Date(rt).getMinutes())):(u.setDate(new Date(u).getDate()+v),u.setHours(new Date(d).getHours(),new Date(d).getMinutes())));else ot=n(h[0]).width()-this.appoint_width,this.currentView()=="month"||this._isCustomView()||!this.model.timeScale.enable?(v=Math.round(ot/(this.element.find(".e-workcells").width()+1)),u.setDate(new Date(u).getDate()+v)):(ct=ot*60/(this.element.find(".e-workcells").width()*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot)+1),u.setHours(new Date(u).getHours()+parseInt(ct/60)),u.setMinutes(new Date(u).getMinutes()+parseInt(ct%60)),u.setMinutes(u.getMinutes()*1),u>new Date(new Date(this._dateRender[this._dateRender.length-1]).setHours(23,59,59))&&(u=new Date(new Date(this._dateRender[this._dateRender.length-1]).setHours(23,59,59)))),u=new Date(u);this._rightResizing=!1}if((e>=u||n(h[0]).width()==0)&&(e=y[0][f.startTime],u=y[0][f.endTime]),k=!0,p[f.recurrence]==1&&p[f.recurrenceRule].toString().indexOf("RECUREDITID")==-1){var c={},gt=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),nt=new t.DataManager(this._processed).executeLocal(gt)[0],ni=nt[this.model.appointmentSettings.recurrenceId]==null?nt.ParentId:nt[this.model.appointmentSettings.recurrenceId],tr=nt[this.model.appointmentSettings.recurrenceId]==null?"ParentId":this.model.appointmentSettings.recurrenceId,a=new t.DataManager(this._processed).executeLocal((new t.Query).where(tr,t.FilterOperators.equal,ni));if(it&&(a=this._recurrenceAppSort(a)),a=this._appointmentRecurrenceSort(a),n.extend(c,y[0]),yt=new Date(new Date(this.model.maxDate).getTime()),yt.setHours(23,59,59),u>=new Date(this.model.minDate)&&u<=yt){this.model.enableRecurrenceValidation&&c[f.recurrence]&&(o=this._recuCollectionIndex(a,nt));this._processed=this._sortAppById(this._processed);ti=this._appMainId+1;this.model.enableLoadOnDemand&&(ti=this._dataCount);!this.model.enableRecurrenceValidation||!c[f.recurrence]||(o==0?t.isNullOrUndefined(a[o+1])?!0:new Date(new Date(a[o+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(u).setHours(0,0,0,0)).getTime():o==a.length-1?new Date(new Date(a[o-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(e).setHours(0,0,0,0)).getTime():new Date(new Date(a[o-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(e).setHours(0,0,0,0)).getTime()&&new Date(new Date(a[o+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(u).setHours(0,0,0,0)).getTime())?(bt={appointment:c,target:i},prvStartTime=c[f.startTime],prvEndTime=c[f.endTime],c[f.startTime]=new Date(e),c[f.endTime]=new Date(u),this._trigger("resizeStop",bt)?(c[f.startTime]=new Date(prvStartTime),c[f.endTime]=new Date(prvEndTime),k=!0):(k=!1,ni=this._getAppointmentByParentId(this._appUid)[f.recurrenceId]==null?this._getAppointmentByParentId(this._appUid).ParentId:this._getAppointmentByParentId(this._appUid)[f.recurrenceId],this._deleteOcurrence(ni,new Date(nt[f.startTime])),c[f.recurrenceRule]=y[0][f.recurrenceRule]+";RECUREDITID="+c.ParentId,c.AppTaskId=ti,c.Id=c.AppTaskId)):(c[f.startTime]=nt[f.startTime],c[f.endTime]=nt[f.endTime],n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert")),this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("DragResizeError")),this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok")),this._alertWindow.ejDialog("open"),k=!0);kt={data:c};g=[];g.push(this._timeZoneAppointments(kt.data,""));var pt=[],ir=c[this.model.appointmentSettings.recurrenceId]==null?c.ParentId:c[this.model.appointmentSettings.recurrenceId],gt=(new t.Query).where("AppTaskId",t.FilterOperators.equal,ir),ai=new t.DataManager(this._currentAppointmentData).executeLocal(gt);for(new t.DataManager(this._currentAppointmentData).update("AppTaskId",ai[0]),pt.push(this._timeZoneAppointments(ai[0],"")),this.dataSource()instanceof t.DataManager?k||(b=this._dataManager.saveChanges({added:g,changed:pt,deleted:[]},this.model.appointmentSettings.id)):k||(b=this._dataManager.saveChanges({added:g,changed:pt,deleted:[]},"AppTaskId")),ii=[],et=0;et<g.length;et++)ii=this._timeZoneAppointments(g[et],"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",ii);for(ri=[],et=0;et<pt.length;et++)ri=this._timeZoneAppointments(pt[et],"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",ri);l=this;!t.isNullOrUndefined(b)&&n.isFunction(b.promise)&&this.dataSource()instanceof t.DataManager?(b.done(function(i){if(l.model.enableLoadOnDemand)l._initDataSource("refresh");else{var r=t.isNullOrUndefined(i.record)?i:i.record;l._currentAppointmentData.length=0;l._dateFormat(r);l._bindAppointments=!0;l._currentAppointmentData=n.merge(l._currentAppointmentData,r);l._dataProcessing(r);l._renderAppointmentAll()}l._trigger("actionComplete",{data:c,requestType:"appointmentResize"})}),b.fail(function(){l._renderAppointmentAll()})):(this._processed.splice(this._processed.indexOf(nt),1),it?this._appointmentProcessing(kt.data):this._processed.push(kt.data),it?hi?this.element.find("[guid="+y[0].Guid+"]").remove():this.element.find("[guid="+y[0].Guid+"]").remove():this.element.find("[guid="+y[0].Guid+"]").remove(),this._renderSingleApp(c,c),this._trigger("actionComplete",{data:c,requestType:"appointmentResize"}))}else this._renderAppointmentAll()}else{if(ui={},it)s={},tt=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,p.Guid));else var gt=(new t.Query).where("Guid",t.FilterOperators.equal,p.Guid),s={},tt=new t.DataManager(this._processed).executeLocal(gt);if(tt[0][this.model.appointmentSettings.allDay]||this._getNewOverlapList(tt[0]),a=new t.DataManager(this._processed).executeLocal((new t.Query).where("ParentId",t.FilterOperators.equal,tt[0].ParentId)),it&&(a=this._recurrenceAppSort(a)),a=this._appointmentRecurrenceSort(a),n.extend(s,tt),ui=n.extend(!0,[],tt[0]),yt=new Date(new Date(this.model.maxDate).setHours(23,59,59)),this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&this.element.find("#categorybar_"+p.Guid).remove(),u>=new Date(this.model.minDate)&&u<=yt&&(this.model.enableRecurrenceValidation&&s[0][f.recurrence]&&(o=this._recuCollectionIndex(a,tt[0])),!this.model.enableRecurrenceValidation||!s[0][f.recurrence]||(o==0?t.isNullOrUndefined(a[o+1])?!0:new Date(new Date(a[o+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(u).setHours(0,0,0,0)).getTime():o==a.length-1?new Date(new Date(a[o-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(e).setHours(0,0,0,0)).getTime():new Date(new Date(a[o-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(e).setHours(0,0,0,0)).getTime()&&new Date(new Date(a[o+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(u).setHours(0,0,0,0)).getTime())?(bt={appointment:s[0],target:i},prevStartTime=s[0][this.model.appointmentSettings.startTime],prevEndTime=s[0][this.model.appointmentSettings.endTime],s[0][this.model.appointmentSettings.startTime]=e,s[0][this.model.appointmentSettings.endTime]=u,this._trigger("resizeStop",bt)?(s[0][this.model.appointmentSettings.startTime]=prevStartTime,s[0][this.model.appointmentSettings.endTime]=prevEndTime,k=!0):k=!1):(s[0][f.startTime]=tt[0][f.startTime],s[0][f.endTime]=tt[0][f.endTime],n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert")),this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("DragResizeError")),this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok")),this._alertWindow.ejDialog("open"),k=!0),g=this._timeZoneAppointments(s[0],""),this.dataSource()instanceof t.DataManager?k||(b=this._dataManager.update(this.model.appointmentSettings.id,g)):k||(b=this._dataManager.update("AppTaskId",g)),vi=this._timeZoneAppointments(g,"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",vi)),l=this,!t.isNullOrUndefined(b)&&b&&n.isFunction(b.promise)&&this.dataSource()instanceof t.DataManager)b.done(function(i){if(l.model.enableLoadOnDemand)l._initDataSource("refresh");else{var r=t.isNullOrUndefined(i.record)?i:i.record;l._currentAppointmentData.length=0;l._dateFormat(r);l._bindAppointments=!0;l._currentAppointmentData=n.merge(l._currentAppointmentData,r);l._dataProcessing(r);l._renderAppointmentAll()}l._trigger("actionComplete",{data:s,requestType:"appointmentResize"})}),b.fail(function(){l._renderAppointmentAll()});else{if(fi=(new Date(s[0][this.model.appointmentSettings.endTime])-new Date(s[0][this.model.appointmentSettings.startTime]))/36e5>24,s[0][this.model.appointmentSettings.recurrence])new t.DataManager(this._processed).update("Guid",s[0]);else if((s[0][this.model.appointmentSettings.endTime]-s[0][this.model.appointmentSettings.startTime])/36e5<24){for(dele=new t.DataManager(this._processed).executeLocal(t.Query().where("Guid",t.FilterOperators.equal,s[0].Guid)),lt=0;lt<dele.length;lt++)new t.DataManager(this._processed).remove("Guid",dele[lt].Guid),this.element.find("[guid="+dele[lt].Guid+"]").remove(),this.element.find("#categorybar_"+dele[lt].Guid).remove();this._appointmentProcessing(s[0])}else new t.DataManager(this._processed).update("ParentId",s[0]);it||this.element.find("[guid="+this._appUid+"]").remove();this.currentView()==="month"||this._isCustomView()?fi?this._renderSingleApp(s[0],s[0]):this._renderAppointmentAll():(this._renderSingleApp(s[0],s[0]),it||fi||this._reRenderApp(ui));this._trigger("actionComplete",{data:s,requestType:"appointmentResize"})}this._appMainId=this._sortAppById(this._processed)[this._processed.length-1].AppTaskId}}this.element.find("div.e-tophandle,div.e-bottomhandle").removeClass("e-rowcursor");this.element.find("div.e-lefthandle,div.e-righthandle").removeClass("e-columncursor")}catch(i){}},_reRenderApp:function(i){var u=i[this.model.appointmentSettings.startTime],r,h,f,a,c;if(this.model.orientation=="horizontal")var l=2,v=new Date(u).getHours()<this.model.startHour?new Date(u).getHours()+-new Date(u).getHours()+-new Date(u).getMinutes():new Date(u).getHours()+-this.model.startHour,y=!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1?this._findResourceIndex(this.model.resources[0].resourceSettings.dataSource,this.model.resources[0].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-2]])+1:0;var e=this.currentView()=="day"?0:this.model.orientation=="horizontal"&&this.currentView()=="month"?n.inArray(new Date(u.getFullYear(),u.getMonth(),u.getDate()).getTime(),this.monthDays):n.inArray(new Date(u.getFullYear(),u.getMonth(),u.getDate()).getTime(),this._dateRender),o=this.model.orientation=="vertical"?!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this._findResourceIndex(this.res1,this.model.resources[this.model.resources.length-1].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):0:!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this._findResourceIndex(this.level_Resources,this.model.resources[this.model.resources.length-1].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):0,s=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(this._dateRender[e]));for(s=s.and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(this._dateRender[e]).setHours(23,59,59))),s=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?s.and(this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1],t.FilterOperators.equal,this.res1[o][this.model.resources[this.model.resources.length-1].resourceSettings.id]):s,r=new t.DataManager(this._processed).executeLocal((new t.Query).where(s)),this._appList=this.currentView()!=="month"&&!this._isCustomView()&&!i[this.model.appointmentSettings.allDay]?this._alldaySort(r):r,h=this.model.orientation=="vertical"?o*7+(new Date(u).getDay()+1)+(Math.ceil((e+1)/7)-1)*this.res1.length*7:(this.model.endHour-this.model.startHour)*l*e+v*l,this.model.orientation=="vertical"?this.element.find("#"+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+o+"_"+(h-1)).remove():this.element.find("#"+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(o+y)+"_"+h).remove(),f=0;f<r.length;f++)this.element.find("#Appointment_"+r[f].AppTaskId).remove(),this.element.find("#categorybar_"+r[f].Guid).remove(),a=this._findAllDayApp(r[f]),this.model.timeScale.enable&&this.currentView()!=="month"&&!this._isCustomView()?e>=0&&r[f][this.model.appointmentSettings.allDay]&&this.model.orientation=="vertical"||this.model.orientation=="vertical"&&(r[f][this.model.appointmentSettings.endTime]-r[f][this.model.appointmentSettings.startTime])/36e5>24||a?this._setAllDayPos(r[f],e,o):this._renderApp(r[f],e,o):this._renderAppointmentMonth(r[f],e,o);c=this._appointmentCount();c.length==0&&this._nextPrevButton(c);this._unWireResizeEvents();this._wireResizeEvents();this._dragdropAppointments()},recurrenceRuleSplit:function(i,r){var u,s,h,o,e,f;for(this._rRule={},s=r,h=i.split(";"),o=0;o<h.length;o++){u=h[o].split("=");switch(n.trim(u[0]).toUpperCase()){case"FREQ":this._rRule.freq=n.trim(u[1]).toUpperCase();break;case"INTERVAL":this._rRule.interval=parseInt(u[1],10);break;case"COUNT":this._rRule.count=parseInt(u[1],10);break;case"UNTIL":this._rRule.until=new Date(u[1]);break;case"BYDAY":this._rRule.weekDays=u[1];break;case"BYMONTHDAY":this._rRule.monthDay=parseInt(u[1],10);break;case"BYMONTH":this._rRule.month=parseInt(u[1],10);break;case"BYSETPOS":this._rRule.setPositions=parseInt(u[1],10);break;case"WKST":this._rRule.weekStart=u[1];break;case"EXDATE":if(t.isNullOrUndefined(r)||t.isNullOrUndefined(s.split(",")))for(e=u[1].split(","),this._rRule.exDate=[],f=0;f<e.length;f++)this._rRule.exDate[f]=e[f];else for(e=s.split(","),this._rRule.exDate=[],f=0;f<e.length;f++)this._rRule.exDate[f]=e[f];break;case"RECUREDITID":this._rRule.recurEditId=parseInt(u[1])}}return this._rRule},_dragdropAppointments:function(){var r,i,u;if(this.model.readOnly)return!1;this._topResizing=!1;this._bottomResizing=!1;this._leftResizing=!1;this._rightResizing=!1;this.model.allowDragDrop&&(i=this,u=this.element.find(".e-appointment"),u.ejDraggable({handle:".e-appointment",dragArea:i.element.find("div.e-draggableworkarea",".e-headrealldaytable tr"[!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.model.group.resources.length+1:1]),cursorAt:{top:0,left:0},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){return r=n(t.sender.target).hasClass("e-appointment")?n(t.sender.target):n(t.sender.target).parents(".e-appointment"),i._appointElement(r,i)}}),u=this.element.find(".e-alldayappointment"),u.ejDraggable({handle:".e-alldayappointment",dragArea:i.element.find(".e-headrealldaytable tr"[!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.model.group.resources.length+1:1],"div.e-draggableworkarea"),cursorAt:{top:17,left:0},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){return r=n(t.sender.target).hasClass("e-alldayappointment")?n(t.sender.target):n(t.sender.target).parents(".e-alldayappointment"),i._appointElement(r,i)}}),u=this.element.find(".e-monthappointment"),u.ejDraggable({handle:".e-monthappointment",dragArea:i.element.find("div.e-draggableworkarea"),cursorAt:{top:0,left:0},dragStart:function(n){i._dragStart(n)},drag:function(n){i._dragOver(n)},dragStop:function(n){i._dragStop(n)},helper:function(t){return r=n(t.sender.target).hasClass("e-monthappointment")?n(t.sender.target):n(t.sender.target).parents(".e-monthappointment"),i._appointElement(r,i)}}))},_appointElement:function(n,t){var i=t.model.orientation=="vertical"&&n.hasClass("e-appointment")&&this.currentView()!="day"?n.closest("td").width()*.85:n.width();return n.find(".e-schedulemouseclose").removeClass("e-schedulemouseclose e-icon"),n.find(".e-tophandle").removeClass("e-tophandle e-appointresizer-top e-icon e-nsexpand"),n.find(".e-bottomhandle").removeClass("e-bottomhandle e-appointresizer-bottom e-icon e-nsexpand"),n.find(".e-lefthandle").removeClass("e-lefthandle e-appointresizer-left e-icon e-ewexpand"),n.find(".e-righthandle").removeClass("e-righthandle e-appointresizer-right e-icon e-ewexpand"),n.clone().prop("id","cloneElement").appendTo(n.parent()),n.addClass("e-draggableAppointment e-scheduleAppGlassy").removeClass("e-schedulemouseclose e-tophandle e-bottomhandle").css("width",i+"px").appendTo(t.element)},_dragStart:function(t){if(n(t.element[0]).hasClass("e-appointment")||n(t.element[0]).hasClass("e-monthappointment")||n(t.element[0]).hasClass("e-alldayappointment")){var r=t.element,i={target:r};if(this._trigger("actionBegin",{data:i,requestType:"appointmentDrag"})||this._trigger("dragStart",i))return!1}else t.cancel=!0;this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close")},_dragOver:function(t){var i=n(t.element),r={target:i};this._trigger("drag",r);this.element.find(".e-workcells").removeClass("e-selectedCell");this.element.find(".e-workcells").removeClass("e-mousehover")},_dragStop:function(i){var s,b,bt,e,st,dt,vr,yr,tr,pr,ht,gt,ct,oi,lt,kr,tt,gr,ir,rr,v,d,si,vt,ur,u,h,k,ft,ni,it,hi,w,ti,ci,a,ai,li,g,fr,er,et,tu,or,pi,wi,o,y,yt,p,wt,rt,nt,sr,iu,ou,bi,ut,ki;this.model.showQuickWindow&&this._quickAppDetailsWindow.ejDialog("close");var r=this,f=r.model.appointmentSettings,l=r.element.find(".e-draggableworkarea");if(this._appUid=i.element.attr("guid"),s=this._sortAppById(new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))),s.length>1&&!s[0][f.recurrence])b=!0,e=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0];else if(b=!1,bt=n.extend(!0,[],s),bt[0][f.endTime]=bt[bt.length-1][f.endTime],e=s[0][f.recurrence]&&s[0][f.recurrenceRule].toString().indexOf("RECUREDITID")==-1?this._getAppointmentByParentId(this._appUid):s[0][f.recurrence]?s.length>1?bt[0]:s[0]:this._getAppointmentByParentId(this._appUid),s.length>1)var su=new t.DataManager(this._processed).executeLocal((new t.Query).where("AppTaskId",t.FilterOperators.equal,parseInt(i.element[0].id.split("_")[1])))[0],hr=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid)),b=!0;var ii=n.extend(!0,{},e),di=Math.ceil((ii[f.endTime]-ii[f.startTime])/36e5)<24&&ii[f.endTime].getDay()!=ii[f.startTime].getDay()?!0:!1,hu=this._currentAppointmentData;if(this.model.orientation=="vertical"){if(n(i.element[0]).hasClass("e-appointment")){var ri=l.height()+l.scrollTop(),cr=i.element[0].offsetHeight,ot=this.element.find(".e-workcells").height(),ui=n(i.element[0]).offset().top-l.offset().top+l.scrollTop(),kt=ui-ot/(60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))<ri?ui:ri-cr;if((kt>0||!this.model.showAllDayRow)&&i.target.classList[0]!="e-alldaycells"){st=kt>0?kt*60/(60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*(ot+1)):60/(60/(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)*(ot+1));var b=new Date(new Date(e[r.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(e[r.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()?!0:!1,gi=e[r.model.appointmentSettings.startTime],nr=e[r.model.appointmentSettings.endTime];b&&s[0][f.recurrence]&&(gi=hr[0][this.model.appointmentSettings.startTime],nr=hr[1][this.model.appointmentSettings.endTime]);var fi=(nr-gi)/1e3,lr=Math.floor(fi/3600),ar=Math.floor(fi%3600/60),u,c,v,d;if(r.currentView()==="month"||r._isCustomView()?(u=e[r.model.appointmentSettings.startTime],c=new Date(u)):(dt=new Date(r._firstweekdate(r.currentDate())),(r.currentView()==="workweek"||r.currentView()=="customview"&&r._renderDays==5)&&(vr=new Date(dt).getDay(),yr=vr==0?1:0,dt.setDate(dt.getDate()+yr)),u=dt,pr=l.width(),tt=r.currentView()==="week"?7:r.currentView()==="workweek"?this.model.workWeek.length:r.currentView()=="customview"?r._renderDays:1,tt=t.isNullOrUndefined(r.model.group)?tt:tt*r.res1.length,h=Math.floor((n(i.element[0]).offset().left+l.scrollLeft()-l.offset().left)/this.element.find(".e-workcells").width()),u=this.model.enableRTL?new Date(this.dateRender[tt-h-1]):new Date(this.dateRender[h]),c=u),b)u=r._getNewStartTime(st,u),v=new Date(u),c=r._getNewEndTime(u,lr,ar),d=new Date(c);else{var wr=(st%60).toFixed(1),br=wr.toString().split("."),ru=t.isNullOrUndefined(br[1])?0:br[1]/1;u.setHours(parseInt(r.model.startHour)+Math.round(st/60),parseInt(wr.toString().split(".")[0]),ru,0);u=new Date(u).getMinutes()>=30?new Date(new Date(u).setHours(new Date(u).getHours()-1)):new Date(u);u.setMinutes(u.getMinutes()*1);v=new Date(u);tr=e[r.model.appointmentSettings.endTime].getHours()*60+e[r.model.appointmentSettings.endTime].getMinutes()-(e[r.model.appointmentSettings.startTime].getHours()*60+e[r.model.appointmentSettings.startTime].getMinutes());c.setHours(new Date(u).getHours()+parseInt(tr/60));c.setMinutes(new Date(u).getMinutes()+parseInt(tr%60));c.setMinutes(c.getMinutes()*1);d=new Date(c)}}else pr=l.width(),tt=r.currentView()==="week"?7:r.currentView()==="workweek"?this.model.workWeek.length:r.currentView()=="customview"?r._renderDays:1,tt=t.isNullOrUndefined(r.model.group)?tt:tt*r.res1.length,h=Math.floor((n(i.element[0]).offset().left+l.scrollLeft()-l.offset().left)/this.element.find(".e-workcells").width()),u=this.model.enableRTL?new Date(this.dateRender[tt-h-1]):new Date(this.dateRender[h]),u.setHours(0),u.setMinutes(0),v=new Date(u),c=u,c.setHours(23),c.setMinutes(59),d=new Date(c),ht=!0}else if(n(i.element[0]).hasClass("e-alldayappointment"))if(i.target.classList[0]=="e-workcells"){h=i.target.cellIndex;u=new Date(this.dateRender[h]);var ri=l.height()+l.scrollTop(),cr=i.element[0].offsetHeight,ot=this.element.find(".e-workcells").height(),ui=n(i.element[0]).offset().top-l.offset().top+l.scrollTop(),kt=ui-ot/2<ri?ui:ri-cr,st=kt>0?kt*60/(2*(ot+1)):30/(ot+1);u.setHours(parseInt(this.model.startHour)+Math.round(st/60));u.setMinutes(parseInt(st%60));u=new Date(u).getMinutes()>=30?new Date(new Date(u).setHours(new Date(u).getHours()-1)):new Date(u);u.setMinutes(Math.round(u.getMinutes()/10)*10);v=new Date(u);c=new Date(u).setMinutes(u.getMinutes()+30);d=new Date(c);ht=!1;this.alldayDrag=!0}else{u=e[this.model.appointmentSettings.startTime];c=e[this.model.appointmentSettings.endTime];s[0][f.recurrence]&&s[0][f.recurrenceRule].toString().indexOf("RECUREDITID")==-1&&(u=s[0][this.model.appointmentSettings.startTime],c=s[0][this.model.appointmentSettings.endTime]);gt=n(i.element[0]).offset().left+l.scrollLeft()-this.element.find(".e-alldaycells").offset().left-1;gt=this.model.enableRTL?Math.abs(gt):gt;var h=Math.round(gt/(this.element.find(".e-alldaycells").width()+1)),cu=Math.round(n(i.element[0]).width()/(this.element.find(".e-alldaycells").width()+1)),uu=Math.ceil((c-u)/864e5),lu=Math.round(n(i.element[0]).width()/(this.element.find(".e-alldaycells").width()+1)),ei=r.currentView()==="week"?7:r.currentView()==="workweek"?this.model.workWeek.length:r.currentView()=="customview"?r._renderDays:1;u=new Date(this._dateRender[h]);c=new Date(this._dateRender[h]);c.setHours(e[r.model.appointmentSettings.endTime].getHours(),e[r.model.appointmentSettings.endTime].getMinutes(),e[r.model.appointmentSettings.endTime].getSeconds());h<0?u<=new Date(this._dateRender[0])?(v=new Date(u),v.setDate(v.getDate()+h),v.setHours(new Date(e[r.model.appointmentSettings.startTime]).getHours()),v.setMinutes(new Date(e[r.model.appointmentSettings.startTime]).getMinutes()),v=new Date(v)):(ct=new Date(r._dateRender[0]),ct.setDate(ct.getDate()+h),ct.setHours(new Date(e[r.model.appointmentSettings.startTime]).getHours()),ct.setMinutes(new Date(e[r.model.appointmentSettings.startTime]).getMinutes()),v=new Date(ct)):u<new Date(this._dateRender[0])?(oi=h>ei-1?h%ei:h,u.setDate(new Date(e[r.model.appointmentSettings.startTime]).getDate()+oi),u.setHours(new Date(e[r.model.appointmentSettings.startTime]).getHours()),u.setMinutes(new Date(e[r.model.appointmentSettings.startTime]).getMinutes()),v=new Date(u)):(oi=h>ei-1?h%ei:h,v=new Date(new Date(this._dateRender[oi])),v.setHours(new Date(e[r.model.appointmentSettings.startTime]).getHours()),v.setMinutes(new Date(e[r.model.appointmentSettings.startTime]).getMinutes()));lt=new Date(v);lt.setDate(lt.getDate()+uu-1);lt.setHours(new Date(e[r.model.appointmentSettings.endTime]).getHours());lt.setMinutes(new Date(e[r.model.appointmentSettings.endTime]).getMinutes());d=new Date(lt)}else if(n(i.element[0]).hasClass("e-monthappointment")){k=e[r.model.appointmentSettings.startTime];ft=e[r.model.appointmentSettings.endTime];s[0][f.recurrence]&&s[0][f.recurrenceRule].toString().indexOf("RECUREDITID")==-1&&(k=s[0][this.model.appointmentSettings.startTime],ft=s[s.length-1][this.model.appointmentSettings.endTime]);u=new Date(new Date(r.model.currentDate).getFullYear(),new Date(r.model.currentDate).getMonth(),1);kr=u.getDay();u.setDate(u.getDate()-kr);this.currentView()!="month"&&(this.currentView()!="customview"||this._oneWeek)?(tt=t.isNullOrUndefined(r.model.group)?r._dateRender.length:r._dateRender.length*r.res1.length,h=parseInt((n(i.element[0]).offset().left-l.offset().left)/Math.round(l.width()/tt))):(h=parseInt((n(i.element[0]).offset().left+l.scrollLeft()-l.offset().left)/this.element.find(".e-monthcells").width()),h=this.model.enableRTL?6-h:h);di&&parseInt(i.element.attr("id").split("_")[1])==s[s.length-1].AppTaskId&&(h-=1);var dr=parseInt((n(i.element[0]).offset().top+l.scrollTop()-l.offset().top)/this.element.find(".e-monthcells").outerHeight()),at=this.currentView()=="month"||this._isCustomView()&&!this._oneWeek?7:this._dateRender.length,p=this.model.enableRTL?dr*at+(h-Math.floor(h/at)*at)-(ft.getDay()-k.getDay()):dr*at+(h-Math.floor(h/at)*at);u=new Date(new Date(r._dateRender[p]).setHours(k.getHours(),k.getMinutes(),k.getSeconds()));Math.ceil((e[f.endTime]-e[f.startTime])/36e5)>24?(gr=new t.DataManager(this._processed).executeLocal((new t.Query).where("AppTaskId",t.FilterOperators.equal,parseInt(i.element.attr("id").split("_")[1]))),ir=new Date(gr[0][f.startTime])-new Date(s[0][f.startTime]),v=new Date(u-ir),ni=u.getTime()-new Date(k).getTime()-new Date(ir).getTime()):(v=new Date(u),ni=u.getTime()-new Date(k).getTime());c=new Date(new Date(ft).getTime()+ni);d=new Date(c)}}else if(this.model.orientation=="horizontal"&&t.scheduleFeatures.horizontal&&(v=new Date(e[r.model.appointmentSettings.startTime]),d=new Date(e[r.model.appointmentSettings.endTime]),si=this.model.enableRTL?document.elementFromPoint(n(i.element[0]).offset().left,n(i.element[0]).offset().top-1).cellIndex-Math.floor(n(i.element[0]).width()/30-1):Math.floor((n(i.element[0]).offset().left+l.scrollLeft()-l.offset().left)/this.element.find(".e-workcells").width()),vt=parseInt((n(i.element[0]).offset().top+l.scrollTop()-l.offset().top)/this.element.find(".e-workcells").outerHeight()),this.element.find(".e-resourceheadertable .e-resourceexpand").length>0&&(vt+=n(this.element.find(".e-resourceheadertable").find("tr").filter(function(){return n(this).css("display")!=="none"})[vt]).prevUntil("table.e-resourceheadertable").filter(function(){return n(this).css("display")=="none"}).length),ur=n(this.element.find(".e-workcellstab tr")[vt]).find("td")[si],!n(ur).hasClass("e-resourceheadercells")&&!t.isNullOrUndefined(ur))){u=new Date(this._dateRender[0]);rr=this.model.enableRTL?si*30:(n(i.element[0]).offset().left+l.scrollLeft()-l.offset().left)*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount)/n(this.element.find(".e-workcells")[1]).outerWidth();u.setHours(parseInt(r.model.startHour)+Math.round(rr/60));u.setMinutes(parseInt(rr%60));u=new Date(u).getMinutes()>=30?new Date(new Date(u).setHours(new Date(u).getHours()-1)):new Date(u);u.setMinutes(u.getMinutes()*1);this.model.workWeek.length!=5&&(p=Math.floor(si/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount)),u.setDate(new Date(this._dateRender[p]).getDate()));v=new Date(u);var gi=e[r.model.appointmentSettings.startTime],nr=e[r.model.appointmentSettings.endTime],fi=(nr-gi)/1e3,lr=Math.floor(fi/3600),ar=Math.floor(fi%3600/60);c=r._getNewEndTime(u,lr,ar);d=new Date(c);this._cellIndex=this.model.enableRTL?this.element.find(".e-workcells").length-Math.round(n(i.element[0]).offset().left/this.element.find(".e-workcells").width()):Math.floor((n(i.element[0]).offset().left+l.scrollLeft()-l.offset().left)/this.element.find(".e-workcells").width());h=vt;n(i.element[0]).hasClass("e-monthappointment")&&(k=new Date(e[r.model.appointmentSettings.startTime]),ft=new Date(e[r.model.appointmentSettings.endTime]),s[0][f.recurrence]&&s[0][f.recurrenceRule].toString().indexOf("RECUREDITID")==-1?(k=s[0][this.model.appointmentSettings.startTime],ft=s[0][this.model.appointmentSettings.endTime]):s[0][f.recurrence]&&s[0][f.recurrenceRule].toString().indexOf("RECUREDITID")>0&&(e=s[0],k=s[0][this.model.appointmentSettings.startTime],ft=s[0][this.model.appointmentSettings.endTime]),u=new Date(r.monthDays[this._cellIndex]),u.setHours(k.getHours(),k.getMinutes(),k.getSeconds()),v=new Date(u),ni=u.getTime()-new Date(k).getTime(),c=new Date(new Date(ft).getTime()+ni),d=new Date(c))}if(it=!0,e[f.recurrence]==1&&e[f.recurrenceRule].indexOf("RECUREDITID")==-1){hi=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid);w=this._sortAppById(new t.DataManager(this._processed).executeLocal(hi));w.length>1&&(ti=n.extend(!0,[],w),ti[0][this.model.appointmentSettings.endTime]=ti[ti.length-1][this.model.appointmentSettings.endTime]);w=w.length>1?ti[0]:w[0];b&&(ci=new t.DataManager(this._processed).executeLocal(hi));var li=w[this.model.appointmentSettings.recurrenceId]==null?w.ParentId:w[this.model.appointmentSettings.recurrenceId],fu=w[this.model.appointmentSettings.recurrenceId]==null?"ParentId":this.model.appointmentSettings.recurrenceId,y=new t.DataManager(this._processed).executeLocal((new t.Query).where(fu,t.FilterOperators.equal,li));if(b&&(y=this._recurrenceAppSort(y)),y=this._appointmentRecurrenceSort(y),a={},n.extend(a,s[0]),yt=new Date(new Date(this.model.maxDate).getTime()),yt.setHours(23,59,59),d>=new Date(this.model.minDate)&&d<=yt){if(this.model.enableRecurrenceValidation&&a[f.recurrence]&&(p=this._recuCollectionIndex(y,w)),this._processed=this._sortAppById(this._processed),ai=this._appMainId+1,this._appMainId=ai,this.model.enableLoadOnDemand&&(ai=this._dataCount),!this.model.enableRecurrenceValidation||!a[f.recurrence]||(p==0?t.isNullOrUndefined(y[p+1])?!0:new Date(new Date(y[p+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(c).setHours(0,0,0,0)).getTime():p==y.length-1?new Date(new Date(y[p-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(u).setHours(0,0,0,0)).getTime():new Date(new Date(y[p-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(u).setHours(0,0,0,0)).getTime()&&new Date(new Date(y[p+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(c).setHours(0,0,0,0)).getTime())?(precellstrtime=w[f.startTime],precellendtime=w[f.endTime],a[f.startTime]=v,a[f.endTime]=d,t.isNullOrUndefined(this.model.resources)||(pi=a.ownerId,this.model.appointmentSettings.resourceFields.split(",").length>1&&(wi=a.roomId)),!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&(a=this._getDragDropResourceData(r,h,a)),r._trigger("dragStop",{appointment:a})?(a[f.startTime]=precellstrtime,a[f.endTime]=precellendtime,t.isNullOrUndefined(this.model.resources)||(a.ownerId=pi,this.model.appointmentSettings.resourceFields.split(",").length>1&&(a.roomId=wi)),it=!0):(it=!1,li=e[f.recurrenceId]==null?e.ParentId:e[f.recurrenceId],r._deleteOcurrence(li,w[f.startTime]),a[f.recurrenceRule]=e[f.recurrenceRule]+";RECUREDITID="+a.ParentId,a[f.recurrenceExDate]=e[f.recurrenceExDate],a.AppTaskId=ai,a.Id=a.AppTaskId,t.isNullOrUndefined(ht)||(a[f.allDay]=ht))):(a[f.startTime]=w[f.startTime],a[f.endTime]=w[f.endTime],n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert")),this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("DragResizeError")),this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok")),this._alertWindow.ejDialog("open"),it=!0),b)for(ut=0;ut<ci.length;ut++)this.element.find("[guid="+ci[ut].Guid+"]").remove(),new t.DataManager(this._processed).remove("Guid",ci[ut].Guid);g={data:a};rt=[];rt.push(this._timeZoneAppointments(g.data,""));var pt=[],li=a[this.model.appointmentSettings.recurrenceId]==null?e.ParentId:a[this.model.appointmentSettings.recurrenceId],hi=(new t.Query).where("AppTaskId",t.FilterOperators.equal,li),nu=new t.DataManager(this._currentAppointmentData).executeLocal(hi);for(new t.DataManager(this._currentAppointmentData).update("AppTaskId",nu[0]),pt.push(this._timeZoneAppointments(nu[0],"")),this.dataSource()instanceof t.DataManager?it||(nt=this._dataManager.saveChanges({added:rt,changed:pt,deleted:[]},this.model.appointmentSettings.id)):it||(nt=this._dataManager.saveChanges({added:rt,changed:pt,deleted:[]},"AppTaskId")),fr=[],et=0;et<rt.length;et++)fr=this._timeZoneAppointments(rt[et],"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",fr);if(pt[0].AppTaskId!=rt[0].AppTaskId)for(er=[],et=0;et<pt.length;et++)er=this._timeZoneAppointments(pt[et],"reverse"),new t.DataManager(this._currentAppointmentData).update("AppTaskId",er);!t.isNullOrUndefined(nt)&&n.isFunction(nt.promise)&&r.dataSource()instanceof t.DataManager?(nt.done(function(i){if(r.model.enableLoadOnDemand)r._initDataSource("refresh");else{var u=t.isNullOrUndefined(i.record)?i:i.record;r._currentAppointmentData.length=0;r._dateFormat(u);r._bindAppointments=!0;r._currentAppointmentData=n.merge(r._currentAppointmentData,u);r._dataProcessing(u);r._renderAppointmentAll()}r._trigger("actionComplete",{appointment:a,requestType:"appointmentDrag"})}),nt.fail(function(){r._renderAppointmentAll()})):(b||r._processed.splice(r._processed.indexOf(w),1),tu=g.data[this.model.appointmentSettings.endTime].getDate()==g.data[this.model.appointmentSettings.startTime].getDate(),or=Math.ceil((w[this.model.appointmentSettings.endTime]-w[this.model.appointmentSettings.startTime])/864e5)>1?!0:!1,b?or?this._multipleSplit(g.data,g.data.AppTaskId,g.data[this.model.appointmentSettings.startTime],g.data[this.model.appointmentSettings.endTime]):tu?this._processed.push(g.data):this._multipleDayApp(g.data,g.data.AppTaskId,g.data[this.model.appointmentSettings.startTime],g.data[this.model.appointmentSettings.endTime]):this._processed.push(g.data),this._renderAppointmentAll(),r._trigger("actionComplete",{appointment:a,requestType:"appointmentDrag"}))}else this._renderAppointmentAll()}else{var wt={},vi=s[0][r.model.appointmentSettings.startTime],yi=s[s.length-1][r.model.appointmentSettings.endTime];t.isNullOrUndefined(this.model.resources)||(pi=s[0].ownerId,this.model.appointmentSettings.resourceFields.split(",").length>1&&(wi=s[0].roomId));b?o=new t.DataManager(this._currentAppointmentData).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,s[0].Guid)):(o=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,s[0].Guid)),wt=n.extend(!0,[],o[0]));y=new t.DataManager(this._processed).executeLocal((new t.Query).where("ParentId",t.FilterOperators.equal,o[0].ParentId));b&&(y=this._recurrenceAppSort(y));y=this._appointmentRecurrenceSort(y);yt=new Date(new Date(this.model.maxDate).getTime());yt.setHours(23,59,59);v>=new Date(this.model.minDate)&&d<=yt&&(o[0][r.model.appointmentSettings.startTime]=v,o[0][r.model.appointmentSettings.endTime]=d,this.model.enableRecurrenceValidation&&(p=this._recuCollectionIndex(y,o[0])),!this.model.enableRecurrenceValidation||!o[0][f.recurrence]||(p==0?t.isNullOrUndefined(y[p+1])?!0:new Date(new Date(y[p+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(c).setHours(0,0,0,0)).getTime():p==y.length-1?new Date(new Date(y[p-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(u).setHours(0,0,0,0)).getTime():new Date(new Date(y[p-1][f.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(u).setHours(0,0,0,0)).getTime()&&new Date(new Date(y[p+1][f.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(c).setHours(0,0,0,0)).getTime())?(!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&(o[0]=this._getDragDropResourceData(r,h,o[0])),r._trigger("dragStop",{appointment:o[0]})?(o[0][r.model.appointmentSettings.startTime]=vi,o[0][r.model.appointmentSettings.endTime]=yi,t.isNullOrUndefined(this.model.resources)||(o[0].ownerId=pi,this.model.appointmentSettings.resourceFields.split(",").length>1&&(o[0].roomId=wi)),it=!0):(it=!1,this.model.orientation=="horizontal"&&o[0][this.model.appointmentSettings.allDay]&&t.isNullOrUndefined(h)&&(o[0].ownerId=this.res1[vt].id)),t.isNullOrUndefined(ht)||(o[0][r.model.appointmentSettings.allDay]=ht)):(o[0][f.startTime]=vi,o[0][f.endTime]=yi,n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert")),this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("DragResizeError")),this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok")),this._alertWindow.ejDialog("open"),it=!0));b&&(wt=n.extend(!0,[],o[0]));var au=this.model.orientation=="vertical"&&new Date(new Date(vi).setHours(0,0,0,0)).getTime()<new Date(new Date(yi).setHours(0,0,0,0)).getTime()&&(yi-vi)/36e5<24&&o[0][this.model.appointmentSettings.allDay]!==!0,eu=Math.ceil((o[0].EndTime-o[0].StartTime)/864e5),or=eu>1?!0:!1;if(this.element.find("[guid="+this._appUid+"]").remove(),this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&r.element.find("#categorybar_"+e.Guid).remove(),rt=this._timeZoneAppointments(o[0],""),this.dataSource()instanceof t.DataManager?it||(nt=r._dataManager.update(this.model.appointmentSettings.id,rt)):it||(nt=r._dataManager.update("AppTaskId",rt)),sr=this._timeZoneAppointments(rt,"reverse"),b?new t.DataManager(this._currentAppointmentData).update("Guid",sr):new t.DataManager(this._currentAppointmentData).update("AppTaskId",sr),!t.isNullOrUndefined(nt)&&nt&&n.isFunction(nt.promise)&&r.dataSource()instanceof t.DataManager)nt.done(function(i){if(r.model.enableLoadOnDemand)r._initDataSource("refresh");else{var u=t.isNullOrUndefined(i.record)?i:i.record;r._currentAppointmentData.length=0;r._dateFormat(u);r._bindAppointments=!0;r._currentAppointmentData=n.merge(r._currentAppointmentData,u);r._dataProcessing(u);r._renderAppointmentAll()}r._trigger("actionComplete",{appointment:o,requestType:"appointmentDrag"})}),nt.fail(function(){r._renderAppointmentAll()});else{if(o[0][this.model.appointmentSettings.recurrence]&&new t.DataManager(this._processed).update("AppTaskId",o[0]),iu=new t.DataManager(this._processed).executeLocal((new t.Query).where("ParentId",t.FilterOperators.equal,o[0].ParentId)),ou=iu.length==0?!1:!0,b)for(bi=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,o[0].Guid)),ut=0;ut<bi.length;ut++)new t.DataManager(this._processed).remove("Guid",bi[ut].Guid),this.element.find("[guid="+bi[ut].Guid+"]").remove();ki=(new Date(o[0][this.model.appointmentSettings.endTime])-new Date(o[0][this.model.appointmentSettings.startTime]))/36e5>24;!this.model.timeScale.enable||this.model.orientation!="vertical"||this.currentView()==="month"||ki||this._isCustomView()||o[0][f.allDay]!=1?ki||this.currentView()=="month"||this._isCustomView()?(this._dragDrop=!1,this.model.timeScale.enable?this._renderSingleApp(o[0],o[0]):(or?(this._appointmentProcessing(o[0]),this._renderSingleApp(o[0],o[0])):o[0][this.model.appointmentSettings.recurrence]?this._renderAppointmentAll():this._renderSingleApp(o[0],o[0]),this.model.orientation=="vertical"&&this._unWireResizeEvents(),this.model.orientation=="vertical"&&this._wireResizeEvents(),this.model.orientation=="vertical"&&this._dragdropAppointments()),this.model.timeScale.enable&&(this.currentView()=="month"||this._isCustomView())&&!b&&this._monthOverlap(wt)):(this._dragDrop=!1,b&&this._appointmentProcessing(o[0]),this._renderSingleApp(o[0],o[0]),b||ki||!this.model.timeScale.enable||this.alldayDrag||this._reRenderApp(wt),di&&this._reRenderApp(wt),this.alldayDrag&&(this._renderAllDayAppointments(),this._unWireResizeEvents(),this._wireResizeEvents(),this._dragdropAppointments(),this.alldayDrag=!1),this.model.orientation!="vertical"||this.model.timeScale.enable||(di||this._monthOverlap(wt),this._unWireResizeEvents(),this._wireResizeEvents(),this._dragdropAppointments())):this.model.showAllDayRow&&this._renderAppointmentAll();this._trigger("actionComplete",{appointment:o,requestType:"appointmentDrag"});this._appMainId=this._sortAppById(this._processed)[this._processed.length-1].AppTaskId}}this.element.find("#cloneElement").length>0&&this.element.find("#cloneElement").remove()},_monthOverlap:function(i){var r=i[this.model.appointmentSettings.startTime],s,h,u;if(this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources)var a=new Date(r).getHours()<this.model.startHour?new Date(r).getHours()+-new Date(r).getHours()+-new Date(r).getMinutes():new Date(r).getHours()+-this.model.startHour,c=!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1?this._findResourceIndex(this.model.resources[0].resourceSettings.dataSource,this.model.resources[0].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-2]])+1:0;var f=this.currentView()=="day"?0:this.model.orientation=="horizontal"&&this.currentView()=="month"?n.inArray(new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime(),this.monthDays):n.inArray(new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime(),this._dateRender),e=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?this._findResourceIndex(this.res1,this.model.resources[this.model.resources.length-1].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1]]):0,c=!t.isNullOrUndefined(this.model.group)&&this.model.group.resources.length>1?this._findResourceIndex(this.model.resources[0].resourceSettings.dataSource,this.model.resources[0].resourceSettings.id,i[this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-2]])+1:0,l=this.model.orientation=="vertical"?this._dateRender[f]:this.monthDays[f],o=t.Predicate(this.model.appointmentSettings.startTime,t.FilterOperators.greaterThanOrEqual,new Date(l));for(o=o.and(this.model.appointmentSettings.startTime,t.FilterOperators.lessThanOrEqual,new Date(new Date(l).setHours(23,59,59))),o=!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources?o.and(this.model.appointmentSettings.resourceFields.toString().split(",")[this.model.resources.length-1],t.FilterOperators.equal,this.res1[e][this.model.resources[this.model.resources.length-1].resourceSettings.id]):o,s=new t.DataManager(this._processed).executeLocal((new t.Query).where(o)),h=this.model.orientation=="vertical"?e*7+(new Date(r).getDay()+1)+(Math.ceil((f+1)/7)-1)*this.res1.length*7:f+1,this.model.orientation=="vertical"?this.element.find("#"+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(e+c)+"_"+(h-1)).remove():this.element.find("#"+this._id+"_"+Globalize.format(new Date(i[this.model.appointmentSettings.startTime]),"MM_dd_yyyy")+"_"+(e+c)+"_"+(h-1)).remove(),u=0;u<s.length;u++)this.element.find("[guid="+s[u].Guid+"]").remove(),this.element.find("#categorybar_"+s[u].Guid).remove(),this.model.timeScale.enable?this.currentView()=="month"||this._isCustomView()?this._renderAppointmentMonth(s[u],f,e):"":this._renderAppointmentMonth(s[u],f,e);this._unWireResizeEvents();this._wireResizeEvents();this._dragdropAppointments()},_unWireDragDrop:function(){var n=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment");n.ejDraggable("destroy")},_getAppointmentByParentId:function(i){var f=this._currentAppointmentData,u=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,i)),r=new t.DataManager(f).executeLocal((new t.Query).where("AppTaskId",t.FilterOperators.equal,parseInt(u[0].ParentId)));return n.isEmptyObject(r)?r:r[0]},_renderAppointmentAll:function(){this.currentView()=="agenda"?this._renderAgendaContent():(Globalize.culture(this.model.locale),this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,.e-appsoverflow").remove(),this.element.find("div.e-categorybar").remove(),this.currentView()!="month"&&!this._isCustomView()&&this.model.timeScale.enable?(this._renderAppointments(),this.model.enableAppointmentNavigation&&this._nextPrevButton(this._filtered)):this._renderMonthAppointment(),this._wireResizeEvents(),this._dragdropAppointments())},_getNewEndTime:function(n,t,i){var r=new Date(n);return r.setHours(r.getHours()+t),r.setMinutes(r.getMinutes()+i),r},_getNewStartTime:function(n,t){return t.setHours(t.getHours()+parseInt(this.model.startHour)+parseInt(n/60)),t.setMinutes(t.getMinutes()+parseInt(n%60)),t.setMinutes(Math.round(t.getMinutes()/10)*10),t},_createTemplate:function(t,i){var r=document.createElement("script");return r.id=this._id+i+"_Template",r.type="text/x-jsrender",r.text=t,n("body").append(r),r},_documentOnKeyDown:function(n){if(this.model.allowKeyboardNavigation){var t=n.target||document.activeElement||n.srcElement;n.which==27?this._processEscapeKey():n.which==13?this._processEnterKey(t):n.shiftKey==!1&&n.which==9&&this._processWindowTab(t)}},_processWindowTab:function(t){n(t).hasClass("qAppDone")?this._quickAppointWindow.find(".subject").focus():n(t).hasClass("e-appointcancel")||n(t).hasClass("e-cancelrecur")?this._appointmentAddWindow.find(".subject").focus():n(t).hasClass("e-editseries")&&this.model.showQuickWindow&&this._quickAppDetailsWindow.focus()},_onKeyDown:function(t){var r,i,f,l,u,o,s,e,a;if(this.model.allowKeyboardNavigation){if(this.model.showQuickWindow&&this._quickAppointWindow.ejDialog("close")&&this._quickAppDetailsWindow.ejDialog("close"),r=this.element.find("div.e-draggableworkarea tr"),i=t.target||document.activeElement||t.srcElement,n(i).hasClass("e-alldaycells")&&(r=this.element.find(".e-alldaycells").parent()),f=n(i).hasClass("e-workcells")?n(i).index():n(i).hasClass("e-alldaycells")?n(i).index():7-((parseInt(n(i).index()/7)+1)*7-n(i).index())+n(i).parent().index()*7,this.model.orientation=="horizontal"&&(f=this.currentView()!=="month"?Math.floor(f/((this.model.endHour-this.model.startHour)*2)):f),l=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this._dateRender,this.currentView()=="agenda"&&(f=0),u=new Date(l[f]),t.which==39&&u.setDate(u.getDate()+1),t.which==37&&u.setDate(u.getDate()-1),(n(i).hasClass("e-workcells")||n(i).hasClass("e-alldaycells")||n(i).hasClass("e-monthcells"))&&u>=this.model.minDate&&u<=this.model.maxDate)this.element.find("#"+this._id+"_navigator").ejDatePicker("hide"),(n(i).hasClass("e-workcells")||n(i).hasClass("e-alldaycells")||n(i).hasClass("e-monthcells"))&&n(i).addClass("e-selectedCell"),t.shiftKey==!1&&t.which==38?(this._stopDefaultAction(t),this._processUpArrow(i,r)):t.shiftKey==!1&&t.which==40?(this._stopDefaultAction(t),this._processDown(i,r)):t.ctrlKey==!1&&t.shiftKey==!1&&t.which==39?(this._stopDefaultAction(t),this._processRight(i,r)):t.ctrlKey==!1&&t.shiftKey==!1&&t.which==37?(this._stopDefaultAction(t),this._processLeft(i,r)):t.shiftKey==!0&&t.which==38?(this._stopDefaultAction(t),this._processShiftUp(i,t,r)):t.shiftKey==!0&&t.which==40?(this._stopDefaultAction(t),this._processShiftDown(i,t,r)):t.shiftKey==!0&&t.which==37?(this._stopDefaultAction(t),this._processShiftLeft(i,t,r)):t.shiftKey==!0&&t.which==39&&(this._stopDefaultAction(t),this._processShiftRight(i,t,r));else if(this.currentView()=="agenda"&&(this._stopDefaultAction(t),t.which==38||t.which==40)){this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment");var v=r.length-1,h=this.element.find(".e-selectedCell").parent().index(),c=t.which==38?parseInt(h)-1:parseInt(h)+1;c>=0&&c<=v&&h!="undefined"&&(n(r).find(".e-eventcolumn,.e-timecolumn").removeClass("e-selectedCell"),n(r[c]).find(".e-eventcolumn,.e-timecolumn").addClass("e-selectedCell").attr("tabIndex",0).focus())}t.altKey==!0&&t.which==67?(this._stopDefaultAction(t),this.element.find(".e-datedisplay").click()):t.ctrlKey==!0&&t.which==37?(this._stopDefaultAction(t),this.element.find("div.e-navigateprevious").click(),this.element.find("div.e-navigateprevious").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):t.ctrlKey==!0&&t.which==39?(this._stopDefaultAction(t),this.element.find("div.e-navigatenext").click(),this.element.find("div.e-navigatenext").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):t.altKey==!0&&t.which==107||t.altKey==!0&&t.which==187||t.altKey==!0&&t.which==61?(this._stopDefaultAction(t),this._navigateToolbarRight(t)):t.altKey==!0&&t.which==189||t.altKey==!0&&t.which==109||t.altKey==!0&&t.which==45||t.altKey==!0&&t.which==173?(this._stopDefaultAction(t),this._navigateToolbarLeft(t)):t.ctrlKey==!0&&t.which==67?(this._stopDefaultAction(t),this._cancel()):t.which==32?n(document.activeElement)[0]===this.element.find("div.e-navigateprevious")[0]?(this._stopDefaultAction(t),this.element.find("div.e-navigateprevious").click(),this.element.find("div.e-navigateprevious").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):n(document.activeElement)[0]===this.element.find("div.e-navigatenext")[0]&&(this._stopDefaultAction(t),this.element.find("div.e-navigatenext").click(),this.element.find("div.e-navigatenext").attr("tabIndex",0).focus(),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())})):t.altKey==!0&&t.which==78?(this._stopDefaultAction(t),this.currentView()!="agenda"&&this._newAppWindow(i,r),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")):t.ctrlKey==!0&&t.which==69?(this._stopDefaultAction(t),o=this.element.find(".e-selectedAppointment"),this.currentView()=="agenda"&&this.element.find(".e-selectedCell").length>0&&(e=this.element.find(".e-selectedCell").parent().find(".e-agendaappointment"),e.hasClass("e-agendaappointment")&&(o=e)),o.length>0&&(this._editKey=!0,this._cellClick=!1,this._appointmentWindow(o),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide"))):t.which==46?(this._stopDefaultAction(t),s=this.element.find(".e-selectedAppointment"),this.currentView()=="agenda"&&this.element.find(".e-selectedCell").length>0&&(e=this.element.find(".e-selectedCell").parent().find(".e-agendaappointment"),e.hasClass("e-agendaappointment")&&(s=e)),s.length>0&&(this._appUid=s.attr("guid"),this._deleteAppoint())):t.shiftKey==!0&&t.which==9?(this._stopDefaultAction(t),this._reverseTab(i,t,r),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide")):t.shiftKey==!1&&t.which==9&&(this._stopDefaultAction(t),this._processTab(i,t,r),this.element.find("#"+this._id+"_navigator").ejDatePicker("hide"));a=this;this.currentView()!="agenda"&&this._moveScrollContent(i,a)}},_processShiftUp:function(t,i,r){var u,o,s;if(this.model.orientation=="horizontal")return!1;if(n(t).hasClass("e-workcells")){var h=r.length-1,f=n(t).parent()[0].rowIndex,e=n(t)[0].cellIndex;f>0&&f<=h&&f!="undefined"?(u=parseInt(f)-1,u>=0&&(n(r[u].cells[e]).hasClass("e-selectedCell")?(n(r[u].cells[e]).attr("tabIndex",0).focus(),n(r[f].cells[e]).removeClass("e-selectedCell")):(n(r[f].cells[e]).addClass("e-selectedCell"),n(r[u].cells[e]).addClass("e-selectedCell").attr("tabIndex",0).focus())),this._currentRowIndex=u,this._currentColIndex=e):(n(r[f].cells[e]).attr("tabIndex",0).focus(),this._currentRowIndex=f,this._currentColIndex=e)}else if(n(t).hasClass("e-monthcells")){var c=Math.floor(n(t).index()/7),h=r.length-1,l=7*(c+1),a=7*parseInt(c),f=n(t).parent()[0].rowIndex,e=n(t)[0].cellIndex;if(f>0&&f<=h&&f!="undefined")if(u=parseInt(f)-1,u>=0)if(n(r[u].cells[e]).hasClass("e-selectedCell")){for(o=e;o>=a;o--)n(r[f].cells[o]).attr("tabIndex",0).focus(),n(r[f].cells[o]).removeClass("e-selectedCell");for(s=l-1;s>=e;s--)u>=0&&(n(r[u].cells[s]).attr("tabIndex",0).focus(),n(r[u].cells[s]).removeClass("e-selectedCell"));n(r[u].cells[e]).addClass("e-selectedCell")}else{for(o=e;o>=a;o--)n(r[f].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();for(s=l-1;s>=e;s--)u>=0&&n(r[u].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else n(r[u+1].cells[e]).attr("tabIndex",0).focus();else return!1}else return!1},_processShiftDown:function(t,i,r){var e,o,s;if(this.model.orientation=="horizontal")return!1;if(n(t).hasClass("e-workcells")){var h=r.length-1,u=n(t).parent()[0].rowIndex,f=n(t)[0].cellIndex;u>=0&&u<=h&&u!="undefined"&&(n(r[u].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus(),e=parseInt(u)+1,e<=h?(n(r[e].cells[f]).hasClass("e-selectedCell")?(n(r[e].cells[f]).attr("tabIndex",0).focus(),n(r[u].cells[f]).removeClass("e-selectedCell")):(n(r[u].cells[f]).addClass("e-selectedCell"),n(r[e].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus()),this._currentRowIndex=e,this._currentColIndex=f):(n(r[u].cells[f]).attr("tabIndex",0).focus(),this._currentRowIndex=u,this._currentColIndex=f))}else if(n(t).hasClass("e-monthcells")){var c=Math.floor(n(t).index()/7),h=r.length-1,l=7*(c+1),a=7*parseInt(c),u=n(t).parent()[0].rowIndex,f=n(t)[0].cellIndex;if(u>=0&&u<=h&&u!="undefined")if(e=parseInt(u)+1,e<this._dateRender.length/7)if(n(r[e].cells[f]).hasClass("e-selectedCell")){for(o=f;o<=l-1;o++)n(r[u].cells[o]).attr("tabIndex",0).focus(),n(r[u].cells[o]).removeClass("e-selectedCell");for(s=a;s<=f;s++)e<this._dateRender.length/7&&(n(r[e].cells[s]).attr("tabIndex",0).focus(),n(r[e].cells[s]).removeClass("e-selectedCell"));n(r[e].cells[f]).addClass("e-selectedCell")}else{for(o=f;o<=l-1;o++)n(r[u].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();for(s=a;s<=f;s++)e<this._dateRender.length/7&&n(r[e].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else n(r[e-1].cells[f]).attr("tabIndex",0).focus();else return!1}else return!1},_processShiftLeft:function(t,i,r){var rt=r.length-1,h,c,l,w;if(n(t).hasClass("e-workcells")){var b=t,v=this.currentView()=="day"?1:this.currentView()=="workweek"?this.model.workWeek.length:7,d=this.model.orientation=="vertical"?v:this.currentView()=="month"?this.totdays.length:v*(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot),y=Math.floor(n(b).index()/d),g=d*y,o=n(b)[0].cellIndex,e=n(b).parent()[0].rowIndex,u=o-1,nt=this.model.orientation=="vertical"?0:e,tt=this.model.orientation=="vertical"?rt:e,it=this.model.orientation=="vertical"&&this.model.showAllDayRow?!0:!1,k=this.element.find(".e-alldaycells").parent();if(o>0&&u>parseInt(g)-1&&o!="undefined"){if(n(r[e].cells[u]).hasClass("e-selectedCell")){for(h=nt;h<=parseInt(e);h++)n(r[h].cells[o]).removeClass("e-selectedCell");for(c=tt;c>=parseInt(e);c--)n(r[c].cells[u]).removeClass("e-selectedCell");it&&n(k[0].cells[o]).removeClass("e-selectedCell").attr("tabIndex",0).focus();n(r[e].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else{for(h=nt;h<=parseInt(e);h++)n(r[h].cells[o]).addClass("e-selectedCell");for(c=tt;c>=parseInt(e);c--)n(r[c].cells[u]).addClass("e-selectedCell");it&&(n(k[0].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus(),n(k[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus());n(r[e].cells[u]).attr("tabIndex",0).focus()}this._currentRowIndex=e;this._currentColIndex=u}else n(r[e].cells[u+1]).attr("tabIndex",0).focus(),this._currentRowIndex=e,this._currentColIndex=u+1}else if(n(t).hasClass("e-monthcells")){var y=Math.floor(n(t).index()/7),rt=r.length-1,a=7*(parseInt(y)+1),p=7*parseInt(y),s=n(t).parent()[0].rowIndex,f=n(t)[0].cellIndex;if(f>=p&&f<=a&&f!="undefined")newcur=parseInt(f)-1,n(r[s].cells[newcur]).hasClass("e-selectedCell")?f==p&&s>=1?(l=parseInt(s)-1,w=parseInt(a)-1,l>=0&&(n(r[l].cells[w]).attr("tabIndex",0).focus(),n(r[l].cells[f]).removeClass("e-selectedCell"),n(r[s].cells[p]).removeClass("e-selectedClass"))):f<a&&(newcur=parseInt(f)-1,n(r[s].cells[newcur]).attr("tabIndex",0).focus(),n(r[s].cells[f]).removeClass("e-selectedCell")):f==p&&s>=0?(l=parseInt(s)-1,w=parseInt(a)-1,l>=0?n(r[l].cells[w]).addClass("e-selectedCell").attr("tabIndex",0).focus():n(r[l+1].cells[f]).attr("tabIndex",0).focus()):f<a&&(newcur=parseInt(f)-1,n(r[s].cells[newcur]).addClass("e-selectedCell").attr("tabIndex",0).focus());else return}else if(n(t).hasClass("e-alldaycells")){var v=this.currentView()=="day"?1:this.currentView()=="workweek"?this.model.workWeek.length:7,y=Math.floor(n(t).index()/v),g=v*y,o=n(t)[0].cellIndex,u=o-1;o>0&&u>parseInt(g)-1&&o!="undefined"?(n(r[0].cells[u]).hasClass("e-selectedCell")?(n(r[0].cells[o]).removeClass("e-selectedCell"),n(r[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(r[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus(),this._currentRowIndex=0,this._currentColIndex=u):(n(r[0].cells[u+1]).attr("tabIndex",0).focus(),this._currentRowIndex=0,this._currentColIndex=u+1)}else return!1},_processShiftRight:function(t,i,r){var s,h,o;if(n(t).hasClass("e-workcells")){var g=r.length-1,l=this.currentView()=="day"?1:this.currentView()=="workweek"?this.model.workWeek.length:7,p=this.model.orientation=="vertical"?l:this.currentView()=="month"?this.totdays.length:l*(this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount*(60/this.model.timeScale.majorSlot),a=Math.floor(n(t).index()/p),c=p*(a+1),e=n(t).parent()[0].rowIndex,u=n(t)[0].cellIndex,f=parseInt(u)+1,w=this.model.orientation=="vertical"?0:e,b=this.model.orientation=="vertical"?g:e,y=this.element.find(".e-alldaycells").parent(),k=this.model.orientation=="vertical"&&this.model.showAllDayRow?!0:!1;if(u>=0&&u<parseInt(c)-1&&u!="undefined"){if(n(r[e].cells[f]).hasClass("e-selectedCell")){for(s=parseInt(e);s<=b;s++)n(r[s].cells[u]).removeClass("e-selectedCell");for(h=w;h<=e;h++)n(r[h].cells[f]).removeClass("e-selectedCell").attr("tabIndex",0).focus();k&&n(y[0].cells[u]).removeClass("e-selectedCell");n(r[e].cells[f]).addClass("e-selectedCell")}else{for(s=parseInt(e);s<=b;s++)n(r[s].cells[u]).addClass("e-selectedCell");for(h=w;h<=e;h++)n(r[h].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus();k&&(n(y[0].cells[f]).addClass("e-selectedCell"),n(y[0].cells[u]).addClass("e-selectedCell"))}this._currentRowIndex=e;this._currentColIndex=f}else n(r[e].cells[u]).attr("tabIndex",0).focus()}else if(n(t).hasClass("e-monthcells")){var a=Math.floor(n(t).index()/7),g=r.length-1,v=c=7*(parseInt(a)+1),d=7*parseInt(a),e=n(t).parent()[0].rowIndex,u=n(t)[0].cellIndex,f=parseInt(u)+1;if(u>=0&&u<=parseInt(c)-1&&u!="undefined")n(r[e].cells[f]).hasClass("e-selectedCell")?(f<v&&(n(r[e].cells[f]).attr("tabIndex",0).focus(),n(r[e].cells[u]).removeClass("e-selectedCell")),u==parseInt(c)-1&&e<this._dateRender.length/7&&(o=parseInt(e)+1,u=d,o<this._dateRender.length/7&&(n(r[o].cells[u]).removeClass("e-selectedCell").attr("tabIndex",0).focus(),f<v&&(n(r[o].cells[f]).attr("tabIndex",0).focus(),n(r[o].cells[u]).removeClass("e-selectedCell"))))):(f<v&&n(r[e].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus(),u==parseInt(c)-1&&e<this._dateRender.length/7&&(o=parseInt(e)+1,u=d,o<this._dateRender.length/7?(n(r[o].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus(),f<v&&n(r[o].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(r[o-1].cells[f-1]).attr("tabIndex",0).focus()));else return!1}else if(n(t).hasClass("e-alldaycells")){var l=this.currentView()=="day"?1:this.currentView()=="workweek"?this.model.workWeek.length:7,a=Math.floor(n(t).index()/l),c=l*(a+1),u=n(t)[0].cellIndex,f=parseInt(u)+1;u>=0&&u<parseInt(c)-1&&u!="undefined"?(n(r[0].cells[f]).hasClass("e-selectedCell")?(n(r[0].cells[u]).removeClass("e-selectedCell"),n(r[0].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(r[0].cells[f]).addClass("e-selectedCell").attr("tabIndex",0).focus(),this._currentRowIndex=0,this._currentColIndex=f):n(r[0].cells[u]).attr("tabIndex",0).focus()}else return!1},_processEnterKey:function(t){var u,f,r,i;n(t).hasClass("e-workcells")||n(t).hasClass("e-monthcells")||n(t).hasClass("e-alldaycells")?(u=this.element.find("td.e-selectedCell"),f=u.length-1,f==0?this._cellSelection(t):this._multipleCellAppointCreation(t)):n(t).hasClass("e-detailedapp e-detailedwindow")?this._appointmentWindow(t):n(t).parent().hasClass("e-allday")?(r=this._appointmentAddWindow.find("#"+this._id+"allday").ejCheckBox("option","checked"),i=r?!1:!0,this._appointmentAddWindow.find(".allday").ejCheckBox({checked:i})):n(t).parent().hasClass("e-recurrence")?(r=this._appointmentAddWindow.find("#"+this._id+"recurrence").ejCheckBox("option","checked"),i=r?!1:!0,this._appointmentAddWindow.find(".recurrence").ejCheckBox({checked:i}),this._recurChecked=i?!0:!1,this._repeat(t)):n(t).hasClass("e-scheduledelete")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-scheduledelete").click():n(t).hasClass("e-editevent")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-editevent").click():n(t).hasClass(".e-editseries")?this.model.showQuickWindow&&this._quickAppDetailsWindow.find(".e-editseries").click():n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment")?this._cellSelection(t):n(t).parent().hasClass("e-weekday")&&(r=this._appointmentAddWindow.find("#"+n(t).children()[0].id).ejCheckBox("option","checked"),i=r?!1:!0,this._appointmentAddWindow.find("#"+n(t).children()[0].id).ejCheckBox({checked:i}))},_findMinMaxCellIndex:function(){var u=this.element.find("div.e-draggableworkarea tr"),o=u.length-1,i,t,f,s,e,r=this.currentView(),h=r=="day"?1:r=="workweek"?this.model.workWeek.length:7,c=this;return this.element.find("td.e-selectedCell").each(function(h,c){var a=n(c).index(),l;if(a!=null&&!isNaN(a)){if(i==null?(i=a,f=n(c).parent()[0].rowIndex):i<a?i=i:i!=a&&(i=a,f=n(c).parent()[0].rowIndex),r!="month")for(l=0;l<=o;l++)if(n(u[l].cells[i]).hasClass("e-selectedCell")){f=l;break}if(t==null){if(t=a,r!="month")for(e=parseInt(t),l=0;l<=o;l++)n(u[l].cells[e]).hasClass("e-selectedCell")&&(s=l)}else if(t>a)t=t;else if(t!=a&&(t=a,r!="month"))for(e=parseInt(t),l=0;l<=o;l++)n(u[l].cells[e]).hasClass("e-selectedCell")&&(s=l)}}),{rowInx:f,maxrowInx:s,omincolIndex:i,omaxcolIndex:t}},_multipleCellAppointCreation:function(i){var r=t.isNullOrUndefined(i.target)?n(i):n(i.target),a,v,f,e,p,w;this._cellIndex=n(r).hasClass("e-workcells")?n(r).index():n(r).hasClass("e-alldaycells")?n(r).index():7-((parseInt(n(r).index()/7)+1)*7-n(r).index())+n(r).parent().index()*7;this.model.orientation=="horizontal"&&(this._cellIndex=this.currentView()!=="month"?Math.floor(this._cellIndex/((this.model.endHour-this.model.startHour)*this.model.timeScale.minorSlotCount)):this._cellIndex,this._workCellIndex=n(r).parent().index());var o=this._findMinMaxCellIndex(),s=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"?this.dateRender:this._dateRender,h=o.omincolIndex,c=o.omaxcolIndex,b=o.rowInx,k=o.maxrowInx,f=s[h],e=s[c],l=Globalize.culture(this.model.locale);if(this.model.orientation=="vertical")if(n(r).hasClass("e-workcells"))this._min=this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount,a=this.model.startHour+b*this._min*6e4,v=this.model.startHour+(k+1)*this._min*6e4,this.cur_StartTime=new Date(new Date(f).setMilliseconds(a)),this.cur_EndTime=new Date(new Date(e).setMilliseconds(v));else if(n(r).hasClass("e-monthcells")){var u=this.element.find("td.e-selectedCell"),y=u.length-1,d=n(u[0]).parent().index()*7+(n(u[0]).index()-Math.floor(n(u[0]).index()/7)*7),g=n(u[y]).parent().index()*7+(n(u[y]).index()-Math.floor(n(u[y]).index()/7)*7),nt=new Date(this._dateRender[d]),tt=new Date(this._dateRender[g]);this.cur_StartTime=new Date(nt.setHours(0,0,0));this.cur_EndTime=new Date(tt.setHours(23,59,59))}else n(r).hasClass("e-alldaycells")&&(this.cur_StartTime=new Date(f),this.cur_EndTime=new Date(new Date(e).setHours(23,59,59)));else if(this.currentView()!="month"&&!this._isCustomView()&&this.model.timeScale.enable){var f=s[0],e=s[0],a=this.model.startHour+h*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount),v=this.model.startHour+c*(this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount);this.cur_StartTime=new Date(f).setMinutes(a);this.cur_EndTime=new Date(e).setMinutes(v);this.cur_EndTime=new Date(new Date(this.cur_EndTime).setMinutes(new Date(this.cur_EndTime).getMinutes()+this.model.timeScale.majorSlot/this.model.timeScale.minorSlotCount))}else f=this.totdays[h],e=this.totdays[c],this.cur_StartTime=new Date(f),this.cur_EndTime=new Date(new Date(e).setHours(23,59,59));this.model.showQuickWindow&&i.type!=="beforeOpen"&&(this._quickAppointWindow.find("#"+this._id+"_quickAppwindow").css("display","block"),new Date(new Date(this.cur_StartTime).setHours(0,0,0,0)).getTime()==new Date(new Date(this.cur_EndTime).setHours(0,0,0,0)).getTime()?this._quickAppointWindow.find(".e-quickstartend").html(l.calendar.days.names[new Date(this.cur_StartTime).getDay()]+", "+Globalize.format(new Date(this.cur_StartTime),"MMMM")+" "+new Date(this.cur_StartTime).getDate()+", "+Globalize.format(new Date(this.cur_StartTime),this._timeMode=="12"?this._pattern.t:"HH:mm")+" - "+Globalize.format(new Date(this.cur_EndTime),this._timeMode=="12"?this._pattern.t:"HH:mm")):this._quickAppointWindow.find(".e-quickstartend").html(l.calendar.days.names[new Date(this.cur_StartTime).getDay()]+", "+Globalize.format(new Date(this.cur_StartTime),"MMMM")+" "+new Date(this.cur_StartTime).getDate()+", "+Globalize.format(new Date(this.cur_StartTime),this._timeMode=="12"?this._pattern.t:"HH:mm")+" - "+l.calendar.days.names[new Date(this.cur_EndTime).getDay()]+", "+Globalize.format(new Date(this.cur_EndTime),"MMMM")+" "+new Date(this.cur_EndTime).getDate()+", "+Globalize.format(new Date(this.cur_EndTime),this._timeMode=="12"?this._pattern.t:"HH:mm")),this._quickAppointWindow.find(".subject").val(""),this.model.readOnly||this._quickAppointWindow.ejDialog("open"),p=n(r).offset().left-(this._quickAppointWindow.width()-n(r).width())/2+10,w=n(r).offset().top-this._quickAppointWindow.height()-10,this._quickAppointWindow.ejDialog({position:{X:p,Y:w}}),this._quickAppointWindow.find(".subject").focus(),t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._getResourceDetails(n(r)));this._cellClick=!0},_addCellSelection:function(t){var i=this.element.find("td.e-selectedCell"),r=i.length-1;r>0&&(this.element.find("td.e-selectedCell").removeClass("e-selectedCell"),n(t[this._currentRowIndex].cells[this._currentColIndex]).addClass("e-selectedCell").attr("tabIndex",0).focus())},_processUpArrow:function(t,i){var e,r,u;if(n(t).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(i[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(t).hasClass("e-selectedCell")&&this._addCellSelection(i),e=this.element.find(".e-alldaycells"),n(t).hasClass("e-workcells")){var o=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)-1;if(r>0&&r<=o&&r!="undefined"){if(n(i[r-1].cells[u]).hasClass("e-resourceheadercells"))return!1;n(i[r].cells[u]).removeClass("e-selectedCell").blur();n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else r==0&&(this.model.orientation=="vertical"?(r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(this.element).attr("tabIndex",0).focus(),n(e[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else{if(n(t).hasClass("e-alldaycells"))return!1;if(n(t).hasClass("e-monthcells")){var o=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)-1;if(r>=0&&r<=o&&r!="undefined")f>=0?(n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[0].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1}else return!1}},_processDown:function(t,i){var o,s;if(n(t).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(i[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(t).hasClass("e-selectedCell")&&this._addCellSelection(i),n(t).hasClass("e-workcells")){var e=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)+1;if(r>=0&&r<=e&&r!="undefined")if(f<=e){if(n(i[r+1].cells[u]).hasClass("e-resourceheadercells"))return!1;n(i[r].cells[u]).removeClass("e-selectedCell").blur();n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()}else n(i[r].cells[u]).attr("tabIndex",0).focus()}else if(n(t).hasClass("e-alldaycells"))o=this.element.find("td.e-selectedCell")[0].cellIndex,s=this.element.find(".e-alldaycells"),n(s[o]).removeClass("e-selectedCell").blur(),n(this.element.find(".e-workcells")[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(n(t).hasClass("e-monthcells")){var e=i.length-1,r=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,f=parseInt(r)+1;r>=0&&r<e&&r!="undefined"&&(f<=7?(n(i[r].cells[u]).removeClass("e-selectedCell").blur(),n(i[f].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i[f-1].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else return!1},_processRight:function(i,r){var l,s,y,p,e,h;if(n(i).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i).hasClass("e-selectedCell")&&this._addCellSelection(r),n(i).hasClass("e-workcells")){var c=r[0].cells.length,f=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,o=parseInt(u)+1;if(u>=0&&u<parseInt(c)-1&&u!="undefined")n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(u==parseInt(c)-1)this.currentView()!="month"?(l=n(i).parent()[0].rowIndex,this.element.find("div.e-navigatenext").click(),n(r[l].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(this.element.find("div.e-navigatenext").click(),n(this.element.find("div.e-draggableworkarea tr")[f].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());else return!1}else if(n(i).hasClass("e-monthcells")){var a=Math.floor(n(i).index()/7),b=r.length-1,v=resmaxcolindex=7*(parseInt(a)+1),w=7*parseInt(a),f=n(i).parent()[0].rowIndex,u=n(i)[0].cellIndex,o=parseInt(u)+1;o<v&&(n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus());u==parseInt(resmaxcolindex)-1&&f<this._dateRender.length/7&&(n(r[f].cells[u]).removeClass("e-selectedCell").blur(),s=parseInt(f)+1,u=w,s<this._dateRender.length/7?(n(r[s].cells[u]).addClass("e-selectedCell").attr("tabIndex",0).focus(),o<v&&n(r[s].cells[o]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(y=u/7,this.element.find("div.e-navigatenext").click(),p=t.isNullOrUndefined(this.model.group)?0:y*7,n(this.element.find(".e-monthcells")[p]).addClass("e-selectedCell").attr("tabIndex",0).focus()))}else if(n(i).hasClass("e-alldaycells"))if(e=this.element.find("td.e-selectedCell")[0].cellIndex,h=parseInt(this.element.find(".e-alldaycells").length)-1,e>=0&&e<h)n(this.element.find(".e-alldaycells")[e]).removeClass("e-selectedCell").blur(),n(this.element.find(".e-alldaycells")[parseInt(e)+1]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(e==h)this.element.find("div.e-navigatenext").click(),n(this.element.find(".e-alldaycells")[0]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1},_processLeft:function(i,r){var l,f,u,h,w,b,k,d,e,c;if(n(i).hasClass("e-selectedAppointment")?(this.element.find(".e-selectedAppointment").removeClass("e-selectedAppointment"),n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()):n(i).hasClass("e-selectedCell")&&this._addCellSelection(r),n(i).hasClass("e-workcells")){var o=r[0].cells.length,f=this.element.find("td.e-selectedCell").parent()[0].rowIndex,u=this.element.find("td.e-selectedCell")[0].cellIndex,s=parseInt(u)-1;if(u>0&&u<=parseInt(o)-1&&u!="undefined")n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(u==0)this.currentView()!="month"?(l=n(i).parent()[0].rowIndex,this.element.find("div.e-navigateprevious").click(),n(r[l].cells[o-1]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(this.element.find("div.e-navigateprevious").click(),n(this.element.find("div.e-draggableworkarea tr")[f].cells[this.totdays.length-1]).addClass("e-selectedCell").attr("tabIndex",0).focus());else return!1}else if(n(i).hasClass("e-monthcells")){var a=Math.floor(n(i).index()/7),nt=r.length-1,v=7*(parseInt(a)+1),g=7*parseInt(a),y=this.currentView()=="day"?1:this.currentView()=="workweek"?this.model.workWeek.length:7,p=this.model.orientation=="vertical"?y:this.currentView()=="month"?this.totdays.length:y*(this.model.endHour-this.model.startHour)*2;o=!t.isNullOrUndefined(this.model.resources)&&!t.isNullOrUndefined(this.model.group)&&t.scheduleFeatures.resources&&this.model.orientation=="vertical"?this.render_Resources[this.render_Resources.length-1].length*p:p;f=this.element.find("td.e-selectedCell").parent()[0].rowIndex;u=this.element.find("td.e-selectedCell")[0].cellIndex;u==g&&f>=0?(h=parseInt(f)-1,w=parseInt(v)-1,h>=0?(n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[h].cells[w]).addClass("e-selectedCell").attr("tabIndex",0).focus()):(b=u/7,this.element.find("div.e-navigateprevious").click(),k=this._dateRender.length/7,d=t.isNullOrUndefined(this.model.group)?0:b*7,n(this.element.find("div.e-draggableworkarea tr")[k-1].cells[d+6]).addClass("e-selectedCell").attr("tabIndex",0).focus())):u<v&&(s=parseInt(u)-1,n(r[f].cells[u]).removeClass("e-selectedCell").blur(),n(r[f].cells[s]).addClass("e-selectedCell").attr("tabIndex",0).focus())}else if(n(i).hasClass("e-alldaycells"))if(e=this.element.find("td.e-selectedCell")[0].cellIndex,c=parseInt(this.element.find(".e-alldaycells").length)-1,e>0&&e<=c)n(this.element.find(".e-alldaycells")[e]).removeClass("e-selectedCell").blur(),n(this.element.find(".e-alldaycells")[parseInt(e)-1]).addClass("e-selectedCell").attr("tabIndex",0).focus();else if(e==0)this.element.find("div.e-navigateprevious").click(),n(this.element.find(".e-alldaycells")[c]).addClass("e-selectedCell").attr("tabIndex",0).focus();else return!1},_navigateToolbarRight:function(n){var t=this.model.views,i=this.element.find(".e-commonviewbutton.e-"+this.currentView()).parent().index(),r;i<t.length-1&&(r=t[i+1].toLowerCase(),this._navView=!0,this._viewChange(n,this.currentView(),r),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}))},_navigateToolbarLeft:function(n){var t=this.element.find(".e-commonviewbutton.e-"+this.currentView()).parent().index(),i;t>0&&(i=this.model.views[t-1].toLowerCase(),this._navView=!0,this._viewChange(n,this.currentView(),i),this.element.find("#"+this._id+"_navigator").ejDatePicker({value:new Date(this.currentDate())}))},_newAppWindow:function(i){var u,f,b,v,k,w;if(n(i).hasClass("e-selectedCell")){this._currentAction=t.Schedule.Actions.Add;var h=i==null?w:i,ut=n(h).parent().index(),ft=n(h).index(),r=this.model.orientation=="horizontal"&&this.currentView()=="month"?this.monthDays:this.model.orientation=="vertical"||this.currentView()=="customview"&&this._dateRender.length<=7?this.dateRender:this._dateRender;if(r=this.model.orientation=="horizontal"&&this.currentView()=="customview"&&this._dateRender.length<=7?this._dateRender:r,u=parseInt(this.element.find("td.e-selectedCell").length)-1,_target=n(h),this._cellIndex=this.model.timeScale.enable?_target.hasClass("e-workcells")?_target.index():_target.hasClass("e-alldaycells")?_target.index():this._isCustomView()&&this._oneWeek?_target.index():7-((parseInt(_target.index()/7)+1)*7-_target.index())+_target.parent().index()*7:this.model.orientation=="vertical"&&this.currentView()=="month"||this.currentView()=="customview"&&this._dateRender.length>=7?7-((parseInt(_target.index()/7)+1)*7-_target.index())+_target.parent().index()*7:_target.index(),this.model.orientation=="horizontal"&&(this._cellIndex=this.model.timeScale.enable?this.currentView()!=="month"&&!this._isCustomView()?Math.floor(this._cellIndex/((this.model.endHour-this.model.startHour)*2)):this._cellIndex:_target.index(),this._workCellIndex=_target.parent().index()),u==0){if(f=new Date(r[this._cellIndex]),this.model.minDate>f||this.model.maxDate<f)return!1;_target.hasClass("e-workcells")&&this.model.timeScale.enable&&this.currentView()!=="month"&&!this._isCustomView()?(b=this.model.orientation=="vertical"?this.model.startHour+_target.parent().index()/2:this.model.startHour+(_target.index()-(this.model.endHour-this.model.startHour)*2*this._cellIndex)/2,v=b.toString().split("."),startTime=new Date(f).setHours(parseInt(v[0]),parseInt(v[1])==5?30:00),k=parseInt(new Date(startTime).getHours())==23&&parseInt(new Date(startTime).getMinutes())==30?new Date(startTime).getMinutes()+29:new Date(startTime).getMinutes()+30,endTime=new Date(new Date(startTime).setMinutes(k)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!1})):(startTime=new Date(new Date(f).setHours(0,0,0)),endTime=new Date(new Date(f).setHours(23,59,59)),this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0}))}else if(u>0){var c=this._findMinMaxCellIndex(),l=c.omincolIndex,a=c.omaxcolIndex,d=c.rowInx,g=c.maxrowInx;if(this.model.orientation=="vertical")if(n(i).hasClass("e-workcells")){var y=r[l],p=r[a],e=(this.model.startHour+d/2).toString().split("."),o=(this.model.startHour+g/2).toString().split(".");startTime=new Date(new Date(y).setHours(parseInt(e[0]),parseInt(e[1])==5?30:00));endTime=new Date(p).setHours(parseInt(o[0]),parseInt(o[1])==5?30:00);endTime=new Date(new Date(endTime).setMinutes(new Date(endTime).getMinutes()+30))}else if(n(i).hasClass("e-monthcells")){var s=this.element.find("td.e-selectedCell"),nt=n(s[0]).parent().index()*7+(n(s[0]).index()-Math.floor(n(s[0]).index()/7)*7),tt=n(s[u]).parent().index()*7+(n(s[u]).index()-Math.floor(n(s[u]).index()/7)*7),it=new Date(this._dateRender[nt]),rt=new Date(this._dateRender[tt]);startTime=new Date(new Date(it).setHours(0,0,0));endTime=new Date(new Date(rt).setHours(23,59,59))}else n(i).hasClass("e-alldaycells")&&(startTime=new Date(new Date(r[l]).setHours(0,0,0)),endTime=new Date(new Date(r[a]).setHours(23,59,59)));else if(this.currentView()!="month"&&!this._isCustomView()&&this.model.timeScale.enable){var y=r[0],p=r[0],e=(this.model.startHour+l/2).toString().split("."),o=(this.model.startHour+a/2).toString().split(".");startTime=new Date(new Date(y).setHours(parseInt(e[0]),parseInt(e[1])==5?30:00));endTime=new Date(p).setHours(parseInt(o[0]),parseInt(o[1])==5?30:00);endTime=new Date(new Date(endTime).setMinutes(new Date(endTime).getMinutes()+30))}else{var y=this.totdays[l],p=this.totdays[a],e=this.model.startHour.toString().split("."),o=this.model.startHour.toString().split(".");startTime=new Date(y).setHours(parseInt(e[0]),parseInt(e[1])==5?30:00);endTime=new Date(p).setHours(parseInt(o[0]),parseInt(o[1])==5?30:00);endTime=new Date(new Date(endTime).setMinutes(new Date(endTime).getMinutes()+30));endTime=new Date(new Date(endTime).setHours(23,59,59))}}if(w={startTime:new Date(startTime),endTime:new Date(endTime),target:_target,resources:(this.model.appointmentWindowOpen!=null||this.model.cellDoubleClick!=null)&&!t.isNullOrUndefined(this.model.resources)?this._getResourceValue(_target):null},this._trigger("appointmentWindowOpen",w))return!1;t.scheduleFeatures.resources&&!t.isNullOrUndefined(this.model.resources)&&this._renderResourceData(n(h),this._cellIndex);this._appointmentAddWindow.find("#"+this._id+"startdate").ejDatePicker("option","value",Globalize.format(new Date(startTime),this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"enddate").ejDatePicker("option","value",Globalize.format(new Date(endTime),this._pattern.d));this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value",Globalize.format(new Date(startTime),this._pattern.t));this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value",Globalize.format(new Date(endTime),this._pattern.t));(n(i).hasClass("e-alldaycells")||this.currentView()=="month"||this._isCustomView())&&this._appointmentAddWindow.find(".allday").ejCheckBox({checked:!0});this._timeZoneCollection(null);this._tempStart=this._appointmentAddWindow.find("#"+this._id+"starttime").ejTimePicker("option","value");this._tempEnd=this._appointmentAddWindow.find("#"+this._id+"endtime").ejTimePicker("option","value");this._alldayCheck();this.model.readOnly||(this._appointmentAddWindow.find(".e-appsave,#donerecur").ejButton("enable",!0),this._mediaQuery&&this._appointmentAddWindow.find(".e-btndelete").css("display","none"),this._appointmentAddWindow.ejDialog("open"));this._appointmentAddWindow.find(".subject").focus();this._cellClick=!1}},_showToolTip:function(i){var u,r,s;if(this.model.tooltipSettings.enable&&!t.isTouchDevice()){if(n(i.target).is(".e-tophandle,.e-bottomhandle,.e-schedulemouseclose,.e-righthandle,.e-lefthandle,.e-schedulerepeat,.e-editapp,.e-deleteapp"))return!1;if(u=this._getAppDetails(i),r=n(".e-scheduletooltip"),r.length==0&&(r=n("<div class='e-scheduletooltip' style='position: absolute; z-index: 105; display: block;'><\/div>"),n(document.body).append(r)),t.isNullOrUndefined(this.model.tooltipSettings.template)){var h=this._timeMode=="12"?Globalize.format(u.StartTime,this._pattern.t):Globalize.format(u.StartTime,"HH:mm"),c=this._timeMode=="12"?Globalize.format(u.EndTime,this._pattern.t):Globalize.format(u.EndTime,"HH:mm"),l=u.Subject==""?this._getLocalizedLabels("NoTitle"):u.Subject,s=l+":&nbsp;("+h+"-"+c+")";r.html(s)}else s=n(this.model.tooltipSettings.template).render(u),r.html(s.trim());var f=i.pageX,e=i.pageY,o=n(r);f=f+o.width()<this.model.width?f:f-o.width();e=e+o.height()<this.model.height?e:e-o.height();n(r).css("left",f);n(r).css("top",e);this.model.enableRTL==!0&&o.addClass("e-rtl");n(".e-scheduletooltip").show()}},_hideToolTip:function(){this.model.tooltipSettings.enable&&n(".e-scheduletooltip").remove()},_processTab:function(t,i,r){var u=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-agendaappointment"),s,c,e,o,f,h;if((t.id==this._id||n(t).hasClass("e-datedisplay"))&&(u.length!=0?n(u[0]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus()),n(t).hasClass("e-selectedCell")&&u.length!=0){if(s=this.element.find("td.e-selectedCell"),c=parseInt(s.length)-1,c>0)for(e=0;e<=c;e++)s[e].blur(),n(s[e]).removeClass("e-selectedCell");else n(t).removeClass("e-selectedCell").blur();n(u[0]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()}n(t).hasClass("e-navigateprevious")?this.element.find(".e-navigatenext").attr("tabIndex",0).focus():n(t).hasClass("e-navigatenext")&&(n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus(),n(r[0].cells[0]).hasClass("e-resourceheadercells")&&n(r[1].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());(n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment")||n(t).hasClass("e-agendaappointment"))&&(o=u.length,f=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-agendaappointment").index(this.element.find(".e-selectedAppointment")),f<o&&f>=0?(n(u[f]).removeClass("e-selectedAppointment").blur(),h=parseInt(f)+1,h<o?n(u[h]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():h==o&&this.element.find(".e-navigateprevious").attr("tabIndex",0).focus()):f==o&&this.element.find(".e-navigateprevious").attr("tabIndex",0).focus())},_reverseTab:function(t,i,r){var u=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-agendaappointment"),h,e,c,l,o,f,s;if((t.id==this._id||n(t).hasClass("e-datedisplay"))&&(e=parseInt(u.length)-1,u.length!=0&&n(u[e]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()),h=u.length,n(t).hasClass("e-selectedCell")&&(e=u.length-1,u.length!=0)){if(c=this.element.find("td.e-selectedCell"),l=parseInt(c.length)-1,l>0)for(o=0;o<=l;o++)n(c[o]).removeClass("e-selectedCell").blur();else n(t).removeClass("e-selectedCell").blur();n(u[e]).addClass("e-selectedAppointment").attr("tabIndex",0).focus()}n(t).hasClass("e-navigatenext")?n(this.element).find(".e-navigateprevious").attr("tabIndex",0).focus():n(t).hasClass("e-navigateprevious")&&(n(r[0].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus(),n(r[0].cells[0]).hasClass("e-resourceheadercells")&&n(r[1].cells[0]).addClass("e-selectedCell").attr("tabIndex",0).focus());(n(t).hasClass("e-appointment")||n(t).hasClass("e-alldayappointment")||n(t).hasClass("e-monthappointment")||n(t).hasClass("e-agendaappointment"))&&(f=this.element.find("div.e-appointment,div.e-alldayappointment,div.e-monthappointment,div.e-agendaappointment").index(this.element.find(".e-selectedAppointment")),f<h&&f>0?(n(u[f]).removeClass("e-selectedAppointment").blur(),s=parseInt(f)-1,s<h&&f>=0?n(u[s]).addClass("e-selectedAppointment").attr("tabIndex",0).focus():s==0&&n(this.element).find(".e-navigatenext").attr("tabIndex",0).focus()):f==0&&(n(u[f]).removeClass("e-selectedAppointment").blur(),n(this.element).find(".e-navigatenext").attr("tabIndex",0).focus()))},_stopDefaultAction:function(n){n.cancelBubble=!0;n.returnValue=!1;n.stopPropagation();n.preventDefault()},_getLocalizedLabels:function(n){return t.Schedule.Locale[this.model.locale][n]===r?t.Schedule.Locale["en-US"][n]:t.Schedule.Locale[this.model.locale][n]},refreshAppointments:function(){t.isNullOrUndefined(this.model.appointmentSettings)||(this._dataManager=this.dataSource()instanceof t.DataManager?this.dataSource():this.dataSource()!=null?t.DataManager(this.dataSource()):null);this._bindAppointmentsData("Refresh")},refresh:function(){this._destroy();this._init()},saveAppointment:function(i){var vt,v,lt,g,rt,o,ft,it,ct,f,e,ut,d,h,p,b,r,nt,tt,s,k,wt;if(!this.model.readOnly)if(vt=this._sortAppById(this._processed),this._publicMethodSave=!1,i[this.model.appointmentSettings.startTimeZone]=this.model.timeZone==null?"UTC "+Globalize.format(new Date,"zzz"):this.model.timeZone,i[this.model.appointmentSettings.endTimeZone]=this.model.timeZone==null?"UTC "+Globalize.format(new Date,"zzz"):this.model.timeZone,lt=this._timeZoneSavingAppoint(i,""),i=lt.obj,o=this._timeZoneAppointments(i,""),t.isNullOrUndefined(i[this.model.appointmentSettings.id])&&!i[this.model.appointmentSettings.id]!=""||(g=new t.DataManager(this._processed).executeLocal((new t.Query).where(this.model.appointmentSettings.id,t.FilterOperators.equal,i[this.model.appointmentSettings.id])),t.isNullOrUndefined(g[0])||(i.Guid=g[0].Guid,i.AppTaskId=g[0].AppTaskId,i.RecurrenceId=g[0].recurrenceId,i.recurrenceExDate=g[0].recurrenceExDate,i.ParentId=g[0].ParentId)),r=this,v=t.isNullOrUndefined(this._appMainId)?1:this._appMainId+1,t.isNullOrUndefined(i.AppTaskId)||i.AppTaskId==""){if((i[this.model.appointmentSettings.id]=t.isNullOrUndefined(i[this.model.appointmentSettings.id])||i[this.model.appointmentSettings.id]==""?v:i[this.model.appointmentSettings.id],o[this.model.appointmentSettings.id]=t.isNullOrUndefined(o[this.model.appointmentSettings.id])||o[this.model.appointmentSettings.id]==""?v:o[this.model.appointmentSettings.id],o.AppTaskId=v,i.AppTaskId=v,o.ParentId=v,i.ParentId=v,i.Guid=this._guidFormatGenerate(),this._trigger("actionBegin",{data:i,requestType:"appointmentSave",methodType:"public"}))||this._trigger("appointmentSaved",{appointment:i,methodType:"public"}))return!1;s=this._dataManager.insert(o);it=this._timeZoneAppointments(o,"reverse");new t.DataManager(this._currentAppointmentData).update("AppTaskId",it);!t.isNullOrUndefined(s)&&n.isFunction(s.promise)&&this.dataSource()instanceof t.DataManager?s.done(function(i){if(r.model.enableLoadOnDemand)r._initDataSource("refresh");else{var u=t.isNullOrUndefined(i.record)?i:i.record;r._currentAppointmentData.length=0;r._dateFormat(u);r._bindAppointments=!0;r._currentAppointmentData=n.merge(r._currentAppointmentData,u);r._dataProcessing(u);r._renderAppointmentAll()}r._trigger("actionComplete",{data:o,requestType:"appointmentSave",methodType:"public"})}):(this._processed.push(i),this._renderSingleApp(i,i),this._appMainId=this._sortAppById(this._processed)[this._processed.length-1].AppTaskId,this._trigger("actionComplete",{data:i,requestType:"appointmentSave",methodType:"public"}))}else if(this._currentAction=="editOcurrence"){if(this._trigger("actionBegin",{data:i,requestType:"appointmentEdit"})||this._trigger("appointmentEdited",{appointment:i}))return!1;var y=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],ht=y[this.model.appointmentSettings.recurrenceId]==null?y.ParentId:y[this.model.appointmentSettings.recurrenceId],rt=y[this.model.appointmentSettings.recurrenceId]==null?"ParentId":this.model.appointmentSettings.recurrenceId,l=this._appointmentRecurrenceSort(new t.DataManager(this._processed).executeLocal((new t.Query).where(rt,t.FilterOperators.equal,ht))),a=this._recuCollectionIndex(l,y),c=this.model.appointmentSettings;if(a==0?t.isNullOrUndefined(l[a+1])?!1:!(new Date(new Date(l[a+1][c.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[c.endTime]).setHours(0,0,0,0)).getTime()):a==l.length-1?!(new Date(new Date(l[a-1][c.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[c.startTime]).setHours(0,0,0,0)).getTime()):!(new Date(new Date(l[a-1][c.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[c.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(l[a+1][c.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[c.endTime]).setHours(0,0,0,0)).getTime()))return n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert")),this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("CreateError")),this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok")),this._alertWindow.ejDialog("open"),!1;p=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid);f=new t.DataManager(this._processed).executeLocal(p);this._objDate=f;rt=this._objDate[0][this.model.appointmentSettings.recurrenceId]==null?"ParentId":this.model.appointmentSettings.recurrenceId;h=this._deleteOcurrence(this._objDate[0][rt],new Date(f[0][this.model.appointmentSettings.startTime]));new t.DataManager(this._processed).remove("Guid",this._appUid);i[this.model.appointmentSettings.recurrence]=1;i[this.model.appointmentSettings.recurrenceRule]=h[0][this.model.appointmentSettings.recurrenceRule]+";RECUREDITID="+h[0].AppTaskId;i[this.model.appointmentSettings.recurrenceId]=h[0][this.model.appointmentSettings.recurrenceId];i.Guid=this._appUid;i[this.model.appointmentSettings.recurrenceExDate]=h[0][this.model.appointmentSettings.recurrenceExdate];i.Guid=f[0].Guid;i[this.model.appointmentSettings.id]=f[0][this.model.appointmentSettings.id];e=[];d=this._currentAction==t.Schedule.Actions.EditOcurrence||!t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])&&i[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1?this._parentId:this._currentAction==t.Schedule.Actions.Save?f[0].AppTaskId:v;this._maxId=(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/36e5>24&&this._currentAction!=t.Schedule.Actions.EditOcurrence&&i[this.model.appointmentSettings.allDay]==!0?d:this._currentAction==t.Schedule.Actions.Save?f[0].AppTaskId:this._appMainId+1;this._maxId=(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/36e5>24&&!t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])&&i[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1&&this._currentAction==t.Schedule.Actions.Save?f[0].AppTaskId:this._maxId;this._maxId=this._currentAction==t.Schedule.Actions.EditSeries?d:this._maxId;ut=this._addAppData(i,this._maxId,new Date(i[this.model.appointmentSettings.startTime]),new Date(i[this.model.appointmentSettings.endTime]),d);e.push(ut);o=[];ft=e[0][this.model.appointmentSettings.startTimeZone];ft!=this.model.timeZone?o.push(this._timeZoneAppointments(e[0],"")):o.push(e[0]);new t.DataManager(this._currentAppointmentData).update("AppTaskId",e[0]);var h=[],p=(new t.Query).where("AppTaskId",t.FilterOperators.equal,this._parentId),at=new t.DataManager(this._currentAppointmentData).executeLocal(p);new t.DataManager(this._currentAppointmentData).update("AppTaskId",at[0]);h.push(this._timeZoneAppointments(at[0],""));s=this.dataSource()instanceof t.DataManager?this._dataManager.saveChanges({added:e,changed:h,deleted:[]},this.model.appointmentSettings.id):this._dataManager.saveChanges({added:e,changed:h,deleted:[]},"AppTaskId");it=[];it=ft!=this.model.timeZone?this._timeZoneAppointments(o[0],"reverse"):o[0];new t.DataManager(this._currentAppointmentData).update("AppTaskId",it);ct=[];ct=ft!=this.model.timeZone?this._timeZoneAppointments(h[0],"reverse"):h[0];new t.DataManager(this._currentAppointmentData).update("AppTaskId",ct);n.isFunction(s.promise)&&this.dataSource()instanceof t.DataManager?(s.done(function(i){if(r.model.enableLoadOnDemand)r._initDataSource("refresh");else{var u=t.isNullOrUndefined(i.record)?i:i.record;r._currentAppointmentData.length=0;r._dateFormat(u);r._bindAppointments=!0;r._currentAppointmentData=n.merge(r._currentAppointmentData,u);r._dataProcessing(u);r._renderAppointmentAll()}r._trigger("actionComplete",{data:e,requestType:"appointmentSave"})}),s.fail(function(){})):(this.model.timeScale.enable&&this._appointmentProcessing(e[0]),this.element.find("[guid="+this._appUid+"]").remove(),this.element.find("#categorybar_"+this._appUid).remove(),this._renderSingleApp(i,e[0]),this._trigger("actionComplete",{data:e,requestType:"appointmentEdit",methodType:"public"}))}else if(this._currentAction=="save"&&i[this.model.appointmentSettings.recurrence]||this._currentAction==t.Schedule.Actions.EditSeries){if(this._trigger("actionBegin",{data:i,requestType:"appointmentEdit"})||this._trigger("appointmentEdited",{appointment:i}))return!1;if(p=(new t.Query).where("Guid",t.FilterOperators.equal,this._appUid),f=new t.DataManager(this._processed).executeLocal(p),this._currentAction!=t.Schedule.Actions.EditSeries){t.isNullOrUndefined(f[0][this.model.appointmentSettings.recurrenceRule])||(i[this.model.appointmentSettings.recurrenceRule]=f[0][this.model.appointmentSettings.recurrenceRule]);var y=new t.DataManager(this._processed).executeLocal((new t.Query).where("Guid",t.FilterOperators.equal,this._appUid))[0],ht=y[this.model.appointmentSettings.recurrenceId]==null?y.ParentId:y[this.model.appointmentSettings.recurrenceId],rt=y[this.model.appointmentSettings.recurrenceId]==null?"ParentId":this.model.appointmentSettings.recurrenceId,l=this._appointmentRecurrenceSort(new t.DataManager(this._processed).executeLocal((new t.Query).where(rt,t.FilterOperators.equal,ht))),a=this._recuCollectionIndex(l,y),c=this.model.appointmentSettings;if(a==0?t.isNullOrUndefined(l[a+1])?!1:!(new Date(new Date(l[a+1][c.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[c.endTime]).setHours(0,0,0,0)).getTime()):a==l.length-1?!(new Date(new Date(l[a-1][c.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[c.startTime]).setHours(0,0,0,0)).getTime()):!(new Date(new Date(l[a-1][c.endTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[c.startTime]).setHours(0,0,0,0)).getTime()&&new Date(new Date(l[a+1][c.startTime]).setHours(0,0,0,0)).getTime()>new Date(new Date(i[c.endTime]).setHours(0,0,0,0)).getTime()))return n("#"+this._id+"alertWindow").ejDialog("instance").option("title",this._getLocalizedLabels("RecurrenceAlert")),this._alertWindow.find(".e-alerttext").html(this._getLocalizedLabels("CreateError")),this._alertWindow.find(".e-alertOk").html(this._getLocalizedLabels("Ok")),this._alertWindow.ejDialog("open"),!1}else{var ht=f[0][this.model.appointmentSettings.recurrenceId]==null?f[0].ParentId:f[0][this.model.appointmentSettings.recurrenceId],p=(new t.Query).where("AppTaskId",t.FilterOperators.equal,ht),h=new t.DataManager(this._currentAppointmentData).executeLocal(p);i.AppTaskId=h[0].AppTaskId;i[this.model.appointmentSettings.id]=h[0][this.model.appointmentSettings.id];v=h[0].AppTaskId;i[this.model.appointmentSettings.recurrenceId]=h[0][this.model.appointmentSettings.recurrenceId];i.Guid=this._appUid;i[this.model.appointmentSettings.recurrenceExDate]=h[0][this.model.appointmentSettings.recurrenceExate]}i.Guid=f[0].Guid;i[this.model.appointmentSettings.id]=this._currentAction!=t.Schedule.Actions.EditSeries?f[0][this.model.appointmentSettings.id]:i[this.model.appointmentSettings.id];e=[];d=this._currentAction==t.Schedule.Actions.EditOcurrence||!t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])&&i[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1?this._parentId:this._currentAction==t.Schedule.Actions.Save?f[0].AppTaskId:v;this._maxId=(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/36e5>24&&this._currentAction!=t.Schedule.Actions.EditOcurrence&&i[this.model.appointmentSettings.allDay]==!0?d:this._currentAction==t.Schedule.Actions.Save?f[0].AppTaskId:this._appMainId+1;this._maxId=(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/36e5>24&&!t.isNullOrUndefined(i[this.model.appointmentSettings.recurrenceRule])&&i[this.model.appointmentSettings.recurrenceRule].toString().indexOf("RECUREDITID")!=-1&&this._currentAction==t.Schedule.Actions.Save?f[0].AppTaskId:this._maxId;this._maxId=this._currentAction==t.Schedule.Actions.EditSeries?d:this._maxId;ut=this._addAppData(i,this._maxId,new Date(i[this.model.appointmentSettings.startTime]),new Date(i[this.model.appointmentSettings.endTime]),d);e.push(ut);var w=[],u=[],et=[],yt=this._currentAction==t.Schedule.Actions.Save?e[0].Guid:e[0][this.model.appointmentSettings.recurrenceId],pt=this._currentAction==t.Schedule.Actions.Save?"Guid":this.model.appointmentSettings.recurrenceId;p=(new t.Query).where(pt,t.FilterOperators.equal,yt);h=new t.DataManager(this._currentAppointmentData).executeLocal(p);!t.isNullOrUndefined(h)&&h.length>0?u.push(e[0]):w.push(e[0]);this._currentAction==t.Schedule.Actions.EditSeries&&(p=t.Query().where(t.Predicate(this.model.appointmentSettings.recurrenceRule,t.FilterOperators.contains,"RECUREDITID="+e[0].ParentId,!0)),b=new t.DataManager(this._currentAppointmentData).executeLocal(p),et=et.concat(b));var r=this,s,ot=[],st=[];if(w.length>0&&ot.push(this._timeZoneAppointments(w[0],"")),u.length>0&&st.push(this._timeZoneAppointments(u[0],"")),s=this.dataSource()instanceof t.DataManager?this._dataManager.saveChanges({added:ot,changed:st,deleted:et},this.model.appointmentSettings.id):this._dataManager.saveChanges({added:ot,changed:st,deleted:et},"AppTaskId"),u.length>0&&(k=this._timeZoneAppointments(st[0],"reverse")),w.length>0&&(k=this._timeZoneAppointments(ot[0],"reverse")),new t.DataManager(this._currentAppointmentData).update("AppTaskId",k),u.length>0){if(r=this,n.isFunction(s.promise)&&this.dataSource()instanceof t.DataManager)s.done(function(i){if(r.model.enableLoadOnDemand)r._initDataSource("refresh");else{var f=t.isNullOrUndefined(i.record)?i:i.record;r._currentAppointmentData.length=0;r._dateFormat(f);r._bindAppointments=!0;r._currentAppointmentData=n.merge(r._currentAppointmentData,f);r._dataProcessing(f);r._renderAppointmentAll()}r._appMainId=r._processed.length>0?r._sortAppById(r._processed)[r._processed.length-1].AppTaskId:r._appMainId;r._trigger("actionComplete",{data:u,requestType:"appointmentEdit"})}),s.fail(function(){});else{for(u[0][this.model.appointmentSettings.recurrence]||new Date(new Date(u[0][this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(u[0][this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(new Date(u[0][this.model.appointmentSettings.endTime])-new Date(u[0][this.model.appointmentSettings.startTime]))/36e5<24&&u[0][this.model.appointmentSettings.allDay]!==!0||new t.DataManager(this._currentAppointmentData).update("AppTaskId",u[0]),b=new t.DataManager(this._processed).executeLocal(t.Query().where("ParentId",t.FilterOperators.equal,u[0].AppTaskId)),b.length==0?new t.DataManager(this._processed).update("AppTaskId",u[0]):"",nt=0;nt<b.length;nt++)new t.DataManager(this._processed).remove("Guid",b[nt].Guid),this.element.find("[guid="+b[nt].Guid+"]").remove(),this.element.find("#categorybar_"+b[nt].Guid).remove();this.element.find("[guid="+u[0].Guid+"]").remove();b.length!=0&&this._appointmentProcessing(u[0]);this._renderSingleApp(u[0],u[0]);this._appMainId=this._processed.length>0?this._sortAppById(this._processed)[this._processed.length-1].AppTaskId:this._appMainId}this._trigger("actionComplete",{data:u,requestType:"appointmentEdit",methodType:"public"})}if(w.length>0)if(n.isFunction(s.promise)&&this.dataSource()instanceof t.DataManager)s.done(function(i){if(r.model.enableLoadOnDemand)r._initDataSource("refresh");else{var u=t.isNullOrUndefined(i.record)?i:i.record;r._currentAppointmentData.length=0;r._dateFormat(u);r._bindAppointments=!0;r._currentAppointmentData=n.merge(r._currentAppointmentData,u);r._dataProcessing(u);r._renderAppointmentAll()}}),s.fail(function(){});else for(tt=0;tt<w.length;tt++)this._appointmentProcessing(w[tt]),this.dataSource()instanceof t.DataManager||this._renderSingleApp(w[tt],w[tt])}else{if(this._trigger("actionBegin",{data:i,requestType:"appointmentEdit",methodType:"public"})||this._trigger("appointmentEdited",{appointment:i,methodType:"public"}))return!1;s=this.dataSource()instanceof t.DataManager?this._dataManager.update(this.model.appointmentSettings.id,o):this._dataManager.update("AppTaskId",o);k=this._timeZoneAppointments(o,"reverse");new t.DataManager(this._currentAppointmentData).update("AppTaskId",k);wt=this._appId==1?i.AppTaskId:this._appId;n.isFunction(s.promise)&&this.dataSource()instanceof t.DataManager?s.done(function(i){if(r.model.enableLoadOnDemand)r._initDataSource("refresh");else{var u=t.isNullOrUndefined(i.record)?i:i.record;r._currentAppointmentData.length=0;r._dateFormat(u);r._bindAppointments=!0;r._currentAppointmentData=n.merge(r._currentAppointmentData,u);r._dataProcessing(u);r._renderAppointmentAll()}r._trigger("actionComplete",{data:i,requestType:"appointmentEdit",methodType:"public"})}):(i[this.model.appointmentSettings.recurrence]||new Date(new Date(i[this.model.appointmentSettings.startTime]).setHours(0,0,0,0)).getTime()<new Date(new Date(i[this.model.appointmentSettings.endTime]).setHours(0,0,0,0)).getTime()&&(new Date(i[this.model.appointmentSettings.endTime])-new Date(i[this.model.appointmentSettings.startTime]))/36e5<24&&i[this.model.appointmentSettings.allDay]!==!0||new t.DataManager(this._processed).update("AppTaskId",k)&&this.element.find("[guid="+this._appUid+"]").remove()&&this.element.find("#categorybar_"+this._appUid).remove(),this._renderSingleApp(k,k),this._trigger("actionComplete",{data:k,requestType:"appointmentEdit",methodType:"public"}))}},print:function(){var i=this.element.clone();this.currentView()=="agenda"?(i.width(this.element.find(".e-agendacellstab").width()),i.height(n("#"+this._id+" .e-headertr").height()+this.element.find(".e-agendacellstab").height()+n("#"+this._id+" .e-scheduleheader").height()+2),n(i.find(".e-scroller")).ejScroller({width:this.element.find(".e-agendacellstab").width(),height:n("#"+this._id+" .e-agendacellstab").height()+2}),n(i).find(".e-commonviewbutton").css({"margin-top":"0px"}),n(i).find(".e-viewstable").css({"padding-top":"15px"})):this.model.orientation=="vertical"?(i.width(this.element.find(".e-workcellstab").width()+n(".e-workleftindent").width()),i.height(n("#"+this._id+" .e-headertr").height()+n("#"+this._id+" .e-workcellstab").height()+n("#"+this._id+" .e-scheduleheader").height()+2),n(i.find(".e-scroller")).ejScroller({width:this.element.find(".e-workcellstab").width(),height:n("#"+this._id+" .e-workcellstab").height()+2}),n(i).find(".e-scrolltimecells").css({top:0}),n(i).find(".e-commonviewbutton").css({"margin-top":"0px"}),n(i).find(".e-viewstable").css({"padding-top":"15px"}),n(i).children().first().css({border:"0px solid #bbbcbb"}),i.css({border:"1px solid #bbbcbb"}),this.model.currentView=="month"&&n(i).find(".e-draggableworkarea").css({height:n(this.element).find(".e-timecells").height()*n(this.element).find(".e-timecells").length+2})):(i.width(n(this.element).find(".e-workcellstab").width()),n(i.find(".e-scroller")).ejScroller({width:n(this.element).find(".e-workcellstab").width()}),n(i).find(".e-headerdays").find("tr:first").next().css({left:"0px"}),n(i).find(".e-commonviewbutton").css({"margin-top":"0px"}),n(i).find(".e-viewstable").css({"padding-top":"15px"}),n(i).find(".e-draggableworkarea").css({height:n(this.element).height()-n(this.element).find(".e-scheduleheader").height()+n(this.element).find(".e-scheduleheader").next().height()}));t.print(i)},deleteAppointment:function(n){this.model.readOnly||this._deleteApp(n)},getAppointments:function(){return this.dataSource()},searchAppointments:function(n,i,r,u){var f=t.Query(),e,o=t.isNullOrUndefined(i)?this._getColumns(this.model.appointmentSettings):i;return r=t.isNullOrUndefined(r)?"contains":r,u=t.isNullOrUndefined(u)?!0:u,typeof n=="string"?n.length&&(f.search(n,o,r,u),e=this.dataSource()instanceof t.DataManager?f:this._dataManager.executeLocal(f)):typeof n=="object"&&(e=this.filterAppointments(n)),e},filterAppointments:function(n){var o,e=t.Query(),u,r,f,i;if(!t.isNullOrUndefined(n)){for(r=n[0],u=t.isNullOrUndefined(r.matchcase)?!0:r.matchcase,f=t.Predicate(r.field,r.operator,r.value,u),i=1;i<n.length;i++)u=t.isNullOrUndefined(n[i].matchcase)?!0:n[i].matchcase,f=f[n[i].predicate](n[i].field,n[i].operator,n[i].value,u);e.where(f);o=this.dataSource()instanceof t.DataManager?e:this._dataManager.executeLocal(e)}return o},refreshScroller:function(){var i=this.element.find(".e-scroller").data("ejScroller"),f=this.model.orientation==="vertical"?this.element.width()-(this._mediaQuery&&this.currentView()=="month"?"":this.element.find(".e-scrolltimecells").parent().outerWidth()):this.model.orientation=="horizontal"&&!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.element.width()-this.element.find(".e-resourceheadertable").width():this.element.width();if(i.model.width=f-2,i.model.height=this.scHeight-1-(this.element.find(".e-draggableworkarea").offset().top-this.element.offset().top),i.refresh(),this.model.orientation=="vertical"){if(this.model.cellWidth){this.currentView()=="day"&&this.element.find(".e-headerdaydisplay").css("width",this.model.cellWidth);var r=this.currentView()=="workweek"?this.model.workWeek.length:this.currentView()=="day"?1:this.currentView()==="customview"&&this._renderDays<=7?this._dateRender.length:7,e=!t.isNullOrUndefined(this.model.group)&&!t.isNullOrUndefined(this.model.resources)?this.res1.length*r:r,o=this._dateRender.length/7,u=parseInt(this.model.cellWidth)*e,s=parseInt(this.model.cellHeight)*o;this.element.find(".e-draggableworkarea").width(this.element.width()>u+this.element.find(".e-scrolltimecells").width()+18?u:i.model.width-18)}this.element.find(".e-headrealldaytable").parent().width(this.element.find(".e-draggableworkarea").width());this.element.find(".e-datecommondiv").parent().width(this.element.width()-2);this.element.find(".e-headrealldaytable").css("left",-this.element.find(".e-draggableworkarea").scrollLeft()+"px")}else n(this.element.find(".e-horizontaltimecells").find("table tr")[2]).css("left",-i.model.scrollLeft+"px"),this.element.find(".e-horizontresdiv").height(this.element.find(".e-draggableworkarea").height());this.currentView()=="month"&&this.model.orientation=="vertical"&&this._renderCurrentView()},exportSchedule:function(i,r,u){var y=JSON.parse(JSON.stringify(this.model)),o=JSON.parse(JSON.stringify(this.model.appointmentSettings)),p={action:i,method:"post"},f=t.buildTag("form","",null,p),e,s,h,c,l,a,v;if(this._ignoreFromAppointmentOnExport)for(e=0;e<this._ignoreFromAppointmentOnExport.length;e++)delete o[this._ignoreFromAppointmentOnExport[e]];return t.raiseWebFormsServerEvents?(s={model:y,originalEventType:r},h={model:JSON.stringify(o),appId:u},t.raiseWebFormsServerEvents(r,s,h)):(c={name:"ScheduleModel",type:"hidden",value:JSON.stringify(o)},l=t.buildTag("input","",null,c),t.isNullOrUndefined(u)||(a={name:"AppointmentId",type:"hidden",value:u},v=t.buildTag("input","",null,a),f.append(v)),f.append(l),f.append(this),n("body").append(f),f.submit()),!0}});t.scheduleFeatures.resources&&n.extend(t.Schedule.prototype,t.scheduleFeatures.resources);t.scheduleFeatures.horizontal&&n.extend(t.Schedule.prototype,t.scheduleFeatures.horizontal);t.Schedule.Locale={};t.Schedule.Locale["en-US"]={ReminderWindowTitle:"Reminder window",CreateAppointmentTitle:"Create Appointment",RecurrenceEditTitle:"Edit Repeat Appointment",RecurrenceEditMessage:"How would you like to change the appointment in the series?",RecurrenceEditOnly:"Only this appointment",RecurrenceEditSeries:"Entire series",PreviousAppointment:"Previous Appointment",NextAppointment:"Next Appointment",AppointmentSubject:"Subject",StartTime:"Start Time",EndTime:"End Time",AllDay:"All day",StartTimeZone:"Start TimeZone",EndTimeZone:"End TimeZone",Today:"Today",Recurrence:"Repeat",Done:"Done",Cancel:"Cancel",Ok:"Ok",RepeatBy:"Repeat by",RepeatEvery:"Repeat every",RepeatOn:"Repeat on",StartsOn:"Starts on",Ends:"Ends",Summary:"Summary",Daily:"Daily",Weekly:"Weekly",Monthly:"Monthly",Yearly:"Yearly",Every:"Every",EveryWeekDay:"Every weekday",Never:"Never",After:"After",Occurence:"Occurrence(s)",On:"On",Edit:"Edit",RecurrenceDay:"Day(s)",RecurrenceWeek:"Week(s)",RecurrenceMonth:"Month(s)",RecurrenceYear:"Year(s)",The:"The",OfEvery:"of every",First:"First",Second:"Second",Third:"Third",Fourth:"Fourth",Last:"Last",WeekDay:"Weekday",WeekEndDay:"Weekendday",Subject:"Subject",Categorize:"Categories",DueIn:"Due In",DismissAll:"Dismiss All",Dismiss:"Dismiss",OpenItem:"Open Item",Snooze:"Snooze",Day:"Day",Week:"Week",WorkWeek:"Work Week",Month:"Month",AddEvent:"Add Event",CustomView:"Custom View",Agenda:"Agenda",Detailed:"Edit Appointment",EventBeginsin:"Appointment Begins in",Editevent:"Edit Appointment",Editseries:"Edit Series",Times:"times",Until:"until",Eventwas:"Appointment was",Hours:"hrs",Minutes:"mins",Overdue:"Overdue Appointment",Days:"day(s)",Event:"Event",Select:"select",Previous:"prev",Next:"next",Close:"close",Delete:"Delete",Date:"Date",Showin:"Show in",Gotodate:"Go To Date",Resources:"RESOURCES",RecurrenceDeleteTitle:"Delete Repeat Appointment",Location:"Location",Priority:"Priority",RecurrenceAlert:"Alert",NoTitle:"No Title",WrongPattern:"The recurrence pattern is not valid",CreateError:"The duration of the appointment must be shorter than how frequently it occurs. Shorten the duration, or change the recurrence pattern in the Appointment Recurrence dialog box.",DragResizeError:"Cannot reschedule an occurrence of the recurring appointment if it skips over a later occurrence of the same appointment.",StartEndError:"End time should be greater than start time",MouseOverDeleteTitle:"Delete Appointment",DeleteConfirmation:"Are you sure you want to delete this appointment?",Time:"Time"};t.Schedule.Actions={Add:"add",Save:"save",Delete:"delete",EditOcurrence:"editOcurrence",EditSeries:"editSeries"};t.Schedule.CurrentView={Day:"day",Week:"week",Workweek:"workweek",Month:"month",CustomView:"customview",Agenda:"agenda"};t.Schedule.TimeMode={Hour12:"12",Hour24:"24"};t.Schedule.Orientation={Vertical:"vertical",Horizontal:"horizontal"};t.Schedule.DayOfWeek={Sunday:"Sunday",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday"}}(jQuery,Syncfusion)});