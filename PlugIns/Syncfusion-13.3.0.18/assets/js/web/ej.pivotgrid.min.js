/*!
*  filename: ej.pivotgrid.min.js
*  version : 13.3.0.18
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.touch.min","./ej.button.min","./ej.waitingpopup.min","./ej.pivotpager.min"],n):n()})(function(){(function(n,t,r){t.widget("ejPivotGrid","ej.PivotGrid",{_rootCSS:"e-pivotgrid",element:null,model:null,validTags:["div","span"],defaults:{url:"",cssClass:"",jsonRecords:"",currentReport:"",layout:"Normal",analysisMode:"olap",enablePivotFieldList:!0,enableGroupingBar:!1,enableDeferUpdate:!1,enableJSONRendering:!1,enableVirtualScrolling:!1,enableCellContext:!1,enableRTL:!1,enableToolTip:!0,enableCellSelection:!1,enableConditionalFormatting:!1,enableColumnGrandTotal:!0,enableRowGrandTotal:!0,enableGrandTotal:!0,enableCollapseByDefault:!1,isResponsive:!1,hyperlinkSettings:{enableValueCellHyperlink:!1,enableRowHeaderHyperlink:!1,enableColumnHeaderHyperlink:!1,enableSummaryCellHyperlink:!1},serviceMethodSettings:{initialize:"InitializeGrid",drillDown:"DrillGrid",exportPivotGrid:"Export",paging:"Paging",fetchMembers:"FetchMembers",nodeStateModified:"NodeStateModified",nodeDropped:"NodeDropped",filtering:"Filtering",sorting:"Sorting",deferUpdate:"DeferUpdate"},customObject:{},locale:"en-US",cellSelection:"",valueCellHyperlinkClick:"",rowHeaderHyperlinkClick:"",columnHeaderHyperlinkClick:"",summaryCellHyperlinkClick:"",beforeServiceInvoke:null,afterServiceInvoke:null,drillSuccess:null,cellContext:"",load:null,renderComplete:null,renderFailure:null,renderSuccess:null},dataTypes:{serviceMethodSettings:"data",customObject:"data"},observables:["layout","enableCellContext","hyperlinkSettings.enableValueCellHyperlink","hyperlinkSettings.enableRowHeaderHyperlink","hyperlinkSettings.enableColumnHeaderHyperlink","hyperlinkSettings.enableSummaryCellHyperlink"],layout:t.util.valueFunction("layout"),enableCellContext:t.util.valueFunction("enableCellContext"),enableValueCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableValueCellHyperlink"),enableRowHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableRowHeaderHyperlink"),enableColumnHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableColumnHeaderHyperlink"),enableSummaryCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableSummaryCellHyperlink"),locale:t.util.valueFunction("locale"),getOlapReport:function(){return this._olapReport},setOlapReport:function(n){this._olapReport=n},getJSONRecords:function(){return this._JSONRecords},setJSONRecords:function(t){this._JSONRecords=n.parseJSON(t)},_init:function(){this._initPrivateProperties();this._load()},_destroy:function(){this.element.empty().removeClass("e-pivotgrid"+this.model.cssClass);this.ogridWaitingPopup!=r&&this.ogridWaitingPopup._destroy()},_initPrivateProperties:function(){this._id=this.element.attr("id");this._olapReport="";this._JSONRecords=null;this._drillCaption="";this._drillAction="";this._startDrilldown=!1;this._pagerObj=null;this._seriesPageCount=null;this._categPageCount=null;this._seriesCurrentPage=1;this._categCurrentPage=1;this._drillHeaders=[];this._collapsedRowHeaders=[];this._isDragging=!1;this._droppedClass="";this._dataModel="";this._ascdes="";this._filterUpdate=[];this._pivotRow=[];this._pivotColumn=[];this._pivotCalculation=[];this._pivotFilter=[];this._pivotTableFields=[];this._schemaData=null;ogridWaitingPopup=null;this._oriX=null;this._oriY=null;this._startPosCell=null;_proxy=this;this._maxViewLoading=null;this.formattingArrayClone=[];this.removedItems=[];this.mdformattingArray=[];this.defaultStyleSCell=[];this.defaultStyleVCell=[];this._list=[];this._list.push("Add New");this.rowCount=0},_load:function(){var r={action:t.PivotGrid.GridAction.Initialize,element:this.element,customObject:this.model.customObject},i;if(this._trigger("load",r),this.element.addClass(this.model.cssClass),typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?(this.model.customObject=oclientProxy.model.customObject,n("#"+oclientProxy._id+"_maxView")[0]?(n("#"+oclientProxy._id+"_maxView").ejWaitingPopup({showOnInit:!0}),this._maxViewLoading=("#"+oclientProxy._id+"_maxView").data("ejWaitingPopup")):oclientWaitingPopup.show()):typeof oclientWaitingPopup=="undefined"&&(n("#"+this._id).ejWaitingPopup({showOnInit:!0}),ogridWaitingPopup=n("#"+this._id).data("ejWaitingPopup")),this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:t.PivotGrid.GridAction.Initialize,element:this.element,customObject:this.model.customObject}),i=JSON.stringify(this.model.customObject),_proxy.model.enableJSONRendering==!0){this._renderControlSuccess(this.model.jsonRecords);return}this.element[0]!=null&&this.element.parents().find(".controlPanel").length>0&&this.layout()!=""&&this.layout()!=t.PivotGrid.Layout.Normal?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",currentReport:this.model.currentReport,gridLayout:this.layout(),customObject:i}),this._renderControlSuccess):this.element[0]!=null&&this.element.parents().find(".controlPanel").length>0?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",currentReport:this.model.currentReport,customObject:i}),this._renderControlSuccess):this.layout()!=""&&this.layout()!=t.PivotGrid.Layout.Normal?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,customObject:i}),this._renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",enablePivotFieldList:this.model.enablePivotFieldList,customObject:i}),this._renderControlSuccess)},_setFirst:!0,_setModel:function(n){for(var t in n)switch(t){case"OlapReport":this.setOlapReport(n[t]);break;case"JsonData":this.setOlapReport(n[t]);break;case"RefreshOlapGrid":this.element.renderControlFromJSON(n[t]);break;case"layout":this._load();break;case"customObject":this.model.customObject=n[t];break;case"enableCellContext":this._load();break;case"enableValueCellHyperlink":this._load();break;case"enableRowHeaderHyperlink":this._load();break;case"enableColumnHeaderHyperlink":this._load();break;case"enableSummaryCellHyperlink":this._load();break;case"locale":this._load()}},_wireEvents:function(){this.model.enableCellSelection&&this._on(this.element,"mousedown",".value",this._initCellSelection);this.enableCellContext()==!0&&(document.addEventListener?(document.removeEventListener("contextmenu",_proxy._cellContext,!1),document.addEventListener("contextmenu",_proxy._cellContext,!1)):(document.detachEvent("oncontextmenu",_proxy._cellContext),document.attachEvent("oncontextmenu",_proxy._cellContext)));this.drillDownHandler=n.proxy(this._drillDown,this);this.addHyperlinkHandler=n.proxy(this._addHyperlink,this);this.removeHyperlinkHandler=n.proxy(this._removeHyperlink,this);this._on(this.element,"mouseover",".value, .rowheader, .colheader",this.addHyperlinkHandler);this._on(this.element,"mouseleave",".value, .rowheader, .colheader",this.removeHyperlinkHandler);this._on(this.element,"click",".value, .colheader, .rowheader",function(t){if(t.target.className.indexOf("hyperlink")!=-1){var i=n(t.target).attr("p"),r=this.getJSONRecords()[parseInt(parseInt(i.split(",")[0])*this.rowCount+parseInt(i.split(",")[1]))].Info,u={cellValue:t.target.innerHTML,cellPosition:i,cellType:t.target.className.split(" ")[0],uniqueName:r.split("::")[0],args:t,rawdata:r};this.enableSummaryCellHyperlink()&&t.target.className.indexOf("summary value")>=0?this._trigger("summaryCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:t}):this.enableValueCellHyperlink()&&t.target.className.indexOf("value")>=0?this._trigger("valueCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:t}):this.enableRowHeaderHyperlink()&&t.target.className.indexOf("rowheader")>=0?this._trigger("rowHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:t}):this.enableColumnHeaderHyperlink()&&t.target.className.indexOf("colheader")>=0&&this._trigger("columnHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:t})}});this._on(this.element,"click",".expand, .collapse",t.proxy(this._drillDown,this));this._on(this.element,"mouseover",".colheader, .rowheader, .expand, .collapse",function(t){if(t.target.className.indexOf("expand")>-1&&!n(t.target).hasClass("header-hover-expand"))n(t.target).addClass("header-hover-expand");else if(t.target.className.indexOf("collapse")>-1&&!n(t.target).hasClass("header-hover-collapse"))n(t.target).addClass("header-hover-collapse");else if((t.target.className.indexOf("expand")<0||t.target.className.indexOf("collapse")<0)&&n(t.target).children("span").length>0){var i=n(t.target).children("span")[0];!n(i).hasClass("header-hover-expand")&&i.className.indexOf("expand")>-1?n(i).addClass("header-hover-expand"):!n(i).hasClass("header-hover-collapse")&&i.className.indexOf("collapse")>-1&&n(i).addClass("header-hover-collapse")}});this._on(this.element,"mouseleave",".colheader, .rowheader, .expand, .collapse",function(){this.element.find(".expand, .collapse").removeClass("header-hover-expand header-hover-collapse")});this.model.enableToolTip&&(this._on(this.element,"mouseover",".value",this._applyToolTip),this._on(this.element,"mouseleave",".value",function(){n("#"+this._id+"_gridTooltip").hide("slow")}));this._on(this.element,"click",".filter",t.proxy(this._onFilterBtnClick,this));this._on(this.element,"click",".sorting",t.proxy(this._onSortBtnClick,this));this._on(this.element,"click",".removeBtn",t.proxy(this._removePvtBtn,this));this._on(this.element,"mouseover",".pvtBtn",function(n){this.element.find(n.target.parentElement).addClass("e-btn e-select")});this._on(this.element,"mouseleave",".pvtBtn",function(n){this.element.find(n.target.parentElement).removeClass("e-btn e-select")});this._on(this.element,"mouseover",".pivotButton",function(n){n.target.title=n.target.textContent})},_unWireEvents:function(){this._off(this.element,"click",".expand, .collapse");this._off(this.element,"click",".value, .colheader, .rowheader");this._off(this.element,"mouseover",".colheader, .rowheader, .expand, .collapse");this._off(this.element,"mouseleave",".colheader, .rowheader, .expand, .collapse");this._off(this.element,"mouseover",".value, .rowheader, .colheader",this.addHyperlinkHandler);this._off(this.element,"mouseleave",".value, .rowheader, .colheader",this.removeHyperlinkHandler);this._off(this.element,"mouseover",".value");this._off(this.element,"mouseleave",".value");this._off(this.element,"mousedown",".value");this._off(this.element,"mouseup",".value");this._off(this.element,"click",".filter");this._off(this.element,"click",".sorting");this._off(this.element,"click",".removeBtn");this._off(this.element,"mouseover",".pvtBtn");this._off(this.element,"mouseleave",".pvtBtn")},_onSortBtnClick:function(i){var f,r,u,o,e,s;for(n(i.target).toggleClass("descending"),f=this._ascdes.split("##"),r=0,u=0;u<f.length;u++)f[u]==n(n(i.target).siblings()[1]).text()&&(r=1);classNames=i.target.className;isDescending=new RegExp("descending");isDescending.test(classNames)?r==0&&(this._ascdes+=n(n(i.target).siblings()[1]).text()+"##"):r==1&&(this._ascdes=this._ascdes.replace(n(n(i.target).siblings()[1]).text()+"##",""));e=JSON.stringify(this.model.customObject);try{o=JSON.parse(this.getOlapReport()).Report}catch(h){o=this.getOlapReport()}this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject});e=JSON.stringify(this.model.customObject);s=JSON.stringify({action:"sorting",sortedHeaders:this._ascdes,currentReport:o,customObject:e});ogridWaitingPopup=this.element.data("ejWaitingPopup");t.isNullOrUndefined(ogridWaitingPopup)||ogridWaitingPopup.show();this.model.enableDeferUpdate?t.isNullOrUndefined(ogridWaitingPopup)||ogridWaitingPopup.hide():this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.sorting,s,this._sortingSuccess)},_deferUpdate:function(){var i,r,n,u;try{i=JSON.parse(this.getOlapReport()).Report}catch(f){i=this.getOlapReport()}for(r="",n=0;n<this._filterUpdate.length;n++)r+=this._filterUpdate[n]+"%%";u=JSON.stringify({action:"deferUpdate",sortedHeaders:this._ascdes,filterParams:r,currentReport:i});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.deferUpdate,u,this._renderControlSuccess);this._filterUpdate=[];ogridWaitingPopup=this.element.data("ejWaitingPopup");t.isNullOrUndefined(ogridWaitingPopup)||ogridWaitingPopup.show()},_dialogBtnClick:function(i){var a,h,r,p,o,l,w,s,b;if(this.element.find(".e-dialog, .clientDialog").hide(),a="",i.model.text.toLowerCase()!="cancel"){var e=this._dataModel=="Olap"?a=this._getUnSelectedNodes()+"FILTERED"+this._getSelectedNodes(this._curFilteredAxis=="Filter"?!0:!1):this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:not(:checked)"),v=!1,u=this._dataModel=="Olap"?e:this._curFilteredAxis+"::"+this._curFilteredText+"::FILTERED",f=this._curFilteredText,c=[],y={};if(h=this._getUnSelectedNodes()!=""?!0:!1,this._dataModel=="Pivot"){for(r=0;r<e.length;r++)c.push(n(e[r].parentElement).siblings("a").text());for(y[f]=c,t.isNullOrUndefined(this._tempFilterData)&&(this._tempFilterData=[]),r=0;r<this._tempFilterData.length;r++)t.isNullOrUndefined(this._tempFilterData[r][f])||(this._tempFilterData[r][f]=c,v=!0);if(v||this._tempFilterData.push(y),this._schemaData!=null&&(this._schemaData._tempFilterData=this._tempFilterData),t.isNullOrUndefined(this._curFilteredAxis)||this._curFilteredAxis!="")for(r=0;r<e.length;r++)u+="##"+n(e[r].parentElement).siblings("a").text()}if(filteredBtn=this.model.layout=="excel"?this.element.find(".schemaFieldTree li:contains('"+this._curFilteredText+"')"):this.element.find("."+this._curFilteredAxis+" .pivotButton:contains("+this._curFilteredText+") .filterBtn"),this.model.layout=="Normal"&&this._schemaData!=null){for(r=0;r<this._schemaData.element.find(".fieldTable").find("li").length;r++)this._curFilteredText==this._schemaData.element.find(".fieldTable").find("li")[r].id&&(_pivotProxy._selectedTreeNode=this._schemaData.element.find(".fieldTable").find("li")[r]);if(n(_pivotProxy._selectedTreeNode).parents("li:eq(0)").children().children("span").hasClass("hierarchyCDB")&&(_pivotProxy._selectedTreeNode=n(n(_pivotProxy._selectedTreeNode).parents("li:eq(0)"))),h&&n(n(_pivotProxy._selectedTreeNode)).find(".filter").length<=0?(p=t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML,n(n(_pivotProxy._selectedTreeNode).find(".e-text")[0]).after(p)):h||n(_pivotProxy._selectedTreeNode).find(".filter").remove(),this._curFilteredAxis=="")return!1}try{o=JSON.parse(this.getOlapReport()).Report}catch(k){o=this.getOlapReport()}if(this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject}),l=JSON.stringify(this.model.customObject),w=this.model.customObject!={}&&u!=""?JSON.stringify({action:"filtering",filterParams:u,sortedHeaders:this._ascdes,currentReport:o,customObject:l}):this.model.customObject!={}?JSON.stringify({action:"filtering",currentReport:o,customObject:l}):u!=""?JSON.stringify({action:"filtering",filterParams:u,sortedHeaders:this._ascdes,currentReport:o}):JSON.stringify({action:"filtering"}),ogridWaitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(ogridWaitingPopup)||ogridWaitingPopup.show(),this.model.enableDeferUpdate){if(this._filterUpdate.push(u),!t.isNullOrUndefined(this._tempFilterData))for(s=0;s<this._tempFilterData.length;s++)for(b in this._tempFilterData[s])b==f&&this._tempFilterData[s][f].length>0&&this.element.find("#pivotButton"+f).next().addClass("filtered");t.isNullOrUndefined(ogridWaitingPopup)||ogridWaitingPopup.hide()}else this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,w,this._filterElementSuccess)}},_getUnSelectedNodes:function(){for(var r,f=this.element.find(".editorTreeView")[0],u="",i=n(f).find(":input.nodecheckbox:not(:checked)"),t=0;t<i.length;t++)n(i[t].parentElement).find("span:nth-child(1)").attr("class").indexOf("e-chk-act")>-1||n(i[t].parentElement).attr("aria-checked")=="mixed"||(r=n(i[t]).parents("li:eq(0)"),u+="::"+r[0].id+"||"+n(r).attr("tag"));return u},_createDialog:function(i,r){var f,o,u,s,h,c;this.element.find(".e-dialog, .clientDialog").remove();var l=t.buildTag("div#EditorDiv.editorDiv",t.buildTag("div",t.buildTag("div.memberEditorDiv",t.buildTag("div#editorTreeView.editorTreeView")[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML+"<\/br>",a=t.buildTag("div",t.buildTag("button#OKBtn.dialogOKBtn","OK")[0].outerHTML+t.buildTag("button#CancelBtn.dialogCancelBtn","Cancel")[0].outerHTML,{float:"right",margin:"-5px 0 6px"})[0].outerHTML,v=t.buildTag("div#clientDialog.clientDialog",l+a,{opacity:"1"}).attr("title",i)[0].outerHTML,r=JSON.parse(r),e;if(!t.isNullOrUndefined(this._tempFilterData)){for(u=0;u<this._tempFilterData.length;u++)t.isNullOrUndefined(this._tempFilterData[u][i])||(e=this._tempFilterData[u][i]);if(!t.isNullOrUndefined(e))for(u=0;u<e.length;u++)for(f=0;f<r.length;f++)e[u]==r[f].name&&(r[f].checkedStatus=!1)}for(n(v).appendTo("#"+this._id),this.element.find(".editorTreeView").ejTreeView({showCheckbox:!0,loadOnDemand:!0,height:n(".memberEditorDiv").height(),fields:{id:"id",text:"name",isChecked:"checkedStatus",hasChild:"hasChildren",dataSource:r},nodeClick:""}),o=this.element.find(".editorTreeView").find("li"),u=0;u<o.length;u++)o[u].setAttribute("tag",r[u].tag);this.element.find(".dialogOKBtn, .dialogCancelBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(this._dialogBtnClick,this)});this._dialogOKBtnObj=this.element.find(".dialogOKBtn").data("ejButton");this._memberTreeObj=this.element.find(".editorTreeView").data("ejTreeView");s=this.element.find(".editorTreeView li:gt(0)");h=n(s).find(":input.nodecheckbox:not(:checked)");h.length>0&&(c=n(this._memberTreeObj.element.find("li:first")).find("div .e-chkbox-small > span > span:eq(0)"),n(c).removeClass("e-chk-activeicon").addClass("e-chk-indetericon"));this.element.find(".clientDialog").ejDialog({width:265,target:"#"+this._id,enableResize:!1});this._memberTreeObj.model.nodeCheck=t.proxy(this._onNodeCheckChanges,this);this._memberTreeObj.model.nodeUncheck=t.proxy(this._onNodeCheckChanges,this);this._memberTreeObj.element.find(".e-plus").length==0&&this._memberTreeObj.element.find(".e-item").css("padding","0px");this._unWireEvents();this._wireEvents()},_onNodeCheckChanges:function(i){if(i.value=="(All)"&&i.type=="nodeUncheck")this._memberTreeObj.model.nodeCheck="",this._memberTreeObj.model.nodeUncheck="",this.element.find(".editorTreeView").ejTreeView("unCheckAll"),this._memberTreeObj.model.nodeCheck=t.proxy(this._onNodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._onNodeCheckChanges,this),this._dialogOKBtnObj.disable();else if(i.value=="(All)"&&i.type=="nodeCheck")this._memberTreeObj.model.nodeCheck="",this._memberTreeObj.model.nodeUncheck="",this.element.find(".editorTreeView").ejTreeView("checkAll"),n(this._memberTreeObj.element.find("li:first")).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-chk-indetericon"),this._memberTreeObj.model.nodeCheck=t.proxy(this._onNodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._onNodeCheckChanges,this),this._dialogOKBtnObj.enable();else if(i.value!="(All)"){var r=this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:not(:checked)"),u=n(this._memberTreeObj.element.find("li:first")).find("div .e-chkbox-small > span > span:eq(0)");r.length==0||r.length==1&&r[0].id[r[0].id.length-1]==0?(n(u).parent().removeClass("e-chk-inact").removeClass("e-chk-ind").addClass("e-chk-act"),u.removeClass("e-chk-indetericon").addClass("e-chk-activeicon")):i.type=="nodeCheck"&&r.length==1&&r[0].id[r[0].id.length-1]==0?u.removeClass("e-chk-indetericon").addClass("e-chk-activeicon"):r.length>0&&u.removeClass("e-chk-activeicon").addClass("e-chk-indetericon");this._dialogOKBtnObj.enable();i.type=="nodeUncheck"&&r.length+1==this._memberTreeObj.element.find("li").length&&(u.removeClass("e-chk-activeicon").removeClass("e-chk-indetericon"),this._dialogOKBtnObj.disable())}},_fetchMemberSuccess:function(n){n[0]!=r&&n.length>0?(this._currentMembers=n[0].Value,n[1]!=null&&n[1]!=r&&(this.model.customObject=n[1].Value)):n.d!=r&&n.d.length>0?(this._currentMembers=n.d[0].Value,n.d[1]!=null&&n.d[1]!=r&&(this.model.customObject=n.d[1].Value)):n!=r&&n.length>0?(this._currentMembers=n.EditorTreeInfo,n!=null&&n!=r&&(this.model.customObject=n.customObject)):n!=r&&(this._currentMembers=n.EditorTreeInfo);this._createDialog(this._dialogTitle,this._currentMembers);this.model.afterServiceInvoke!=null&&this._trigger("afterServiceInvoke",{action:"fetchMembers",element:this.element,customObject:this.model.customObject})},_filterElementSuccess:function(n){n[0]!=r?n[2]!=null&&n[2]!=r&&(this.model.customObject=n[2].Value):n.d!=r?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):n.customObject!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this._trigger("afterServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject});this._renderControlSuccess(n)},_sortingSuccess:function(n){n[0]!=r?n[2]!=r&&n.length>0&&(this.model.customObject=n[2].Value):n.d!=r&&n.d.length>0?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):n!=r&&n.length>0&&n.customObject!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this._trigger("afterServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject});this._renderControlSuccess(n)},_onFilterBtnClick:function(t){var i,r;this._curFilteredAxis=t.target.parentElement.attributes.tag.value.split(":")[0];this._curFilteredText=n(n(t.target).siblings()[1]).text();this._dialogTitle=n(n(t.target).siblings()[1]).text();try{i=JSON.parse(this.getOlapReport()).Report}catch(u){i=this.getOlapReport()}this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"fetchMembers",element:this.element,customObject:this.model.customObject});r=JSON.stringify(this.model.customObject);eventArgs=JSON.stringify({action:"fetchMembers",headerTag:this._dialogTitle,sortedHeaders:this._ascdes,currentReport:i,customObject:r});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchMembers,eventArgs,this._fetchMemberSuccess)},_applyToolTip:function(t){var u,o,i,f="",y,s,a,c,h,e,l,v;if(valueCell="",i=n(t.target).hasClass("summary")?n(t.target).siblings("th").hasClass("rowheader")?n(t.target).parent("tr").find(".rowheader").last().attr("p"):n(t.target).parent("tr").find(".summary").attr("p"):n(t.target).parent("tr").find(".rowheader").last().attr("p"),i!=null)if(i[0]==0&&parseInt(i.split(",")[0])!=null)i==this.getJSONRecords()[parseInt(parseInt(i.split(",")[0])*this.rowCount+parseInt(i.split(",")[1]))].Index&&(o=this.getJSONRecords()[parseInt(parseInt(i.split(",")[0])*this.rowCount+parseInt(i.split(",")[1]))].Value);else while(i[0]>=0)i==this.getJSONRecords()[parseInt(parseInt(i.split(",")[0])*this.rowCount+parseInt(i.split(",")[1]))].Index&&(u=this.getJSONRecords()[parseInt(parseInt(i.split(",")[0])*this.rowCount+parseInt(i.split(",")[1]))].Value,i=parseInt(i.split(",")[0])-1+","+parseInt(i.split(",")[1])),o=o?u+"-"+o:u;for(y=n(t.target).closest("tbody").prev().children("tr:last").length!=0?n(t.target).closest("tbody").prev().children("tr:last").children("th").attr("p")[2]:-1,s=n(t.target).attr("p"),s!=r&&s==this.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*this.rowCount+parseInt(s.split(",")[1]))].Index&&(a=parseInt(s.split(",")[0])),c=0;c<=y;c++)h=a+","+c,a!=null&&h==this.getJSONRecords()[parseInt(parseInt(h.split(",")[0])*this.rowCount+parseInt(h.split(",")[1]))].Index&&(u=this.getJSONRecords()[parseInt(parseInt(h.split(",")[0])*this.rowCount+parseInt(h.split(",")[1]))].Value,f==""?f=u:u!=""&&(f=f+"-"+u));n("#"+this._id+"_gridTooltip").remove();e=n(t.target).position();n("#"+this._id).after('<div id="'+this._id+'_gridTooltip" class="pGridTooltip"><\/div>');n("#"+this._id+"_gridTooltip").append('<p id="value" class="tooltipText">'+this._getLocalizedLabels("ToolTipValue")+": "+(n(t.target).text()?n(t.target).text():"No Value")+"<\/p>");n("#"+this._id+"_gridTooltip").append('<p id="row" class="tooltipText">'+this._getLocalizedLabels("ToolTipRow")+": "+(o==r||this.rowCount==1?"No value":o)+"<\/p>");n("#"+this._id+"_gridTooltip").append('<p id="column" class="tooltipText">'+this._getLocalizedLabels("ToolTipColumn")+": "+(f==r||f==""?"No value":f)+"<\/p>");l=0;l=typeof oclientProxy!="undefined"?n("#"+this._id).parent().position().left+oclientProxy.element.find(".gridContainer").width():n("#"+this._id).parent().position().left+n("#"+this._id).parent().width();v=e.left+n("#"+this._id+"_gridTooltip").width();n("#"+this._id+"_gridTooltip").css({left:(e.left>0?e.left:0)+(l-v<0?l-v-20:5),top:e.top>100?e.top-n("#"+this._id+"_gridTooltip").outerHeight()-2:e.top+30});n("#"+this._id+"_gridTooltip").show("fast");this.model.enableRTL?(n("#"+this._id+"_gridTooltip p").addClass("e-rtl"),n("#"+this._id+"_gridTooltip p").css("text-align","right")):(n("#"+this._id+"_gridTooltip p").removeClass("e-rtl"),n("#"+this._id+"_gridTooltip p").css("text-align","left"));typeof oclientProxy!="undefined"&&oclientProxy.controlPlacement()=="tile"&&n("#"+this._id+"_gridTooltip").css("position","absolute")},_applyVScrolling:function(){var i=this,l=n(this.element).find(".virtualScrollGrid"),f,h,r,o,e,c,u,s;this._seriesPageCount>1&&(f=function(){return i.element.find(".vScrollPanel").position().top+1},h=n(this.element).find(".vScrollPanel"),h.height(n(l).height()),h.html(t.buildTag("div.vScrollThumb")[0].outerHTML),r=h.find(".vScrollThumb"),r.height(Math.max(Math.ceil(n(l).height()/i._seriesPageCount),15)),o=h.height()-r.height()-2,r.offset({top:f()+(i._seriesCurrentPage-1)*(o/(i._seriesPageCount-1))}),n(r).bind("mousedown",function(t){var s,u,e;n(this).addClass("dragging");s=t.pageY-f();u=r.position().top-f();i.element.find(".seriesPageIndicator").removeClass("inActive").css({top:r.position().top,left:r.position().left+20});e=i._seriesCurrentPage;n(document).bind("mousemove",function(t){if(window.navigator.userAgent.indexOf("MSIE ")>-1)n(document).on("selectstart",function(n){n.preventDefault()});else window.getSelection().removeAllRanges();var h=t.pageY-f()-s;h>0&&u+h<=o?r.offset({top:u+h+f()}):h<0&&u+h>=0?r.offset({top:u+h+f()}):u+h>o?r.offset({top:f()+o}):u+h<0&&r.offset({top:f()});e=Math.ceil((r.position().top-f())/(o/i._seriesPageCount))==0?1:Math.ceil((r.position().top-f())/(o/i._seriesPageCount));i.element.find(".seriesPageIndicator").css({top:r.position().top});i.element.find(".series_CurrentPage").html(e)});n(document).bind("mouseup",function(){n(document).off("selectstart");n(this).unbind("mousemove").unbind("mouseup");n(r).removeClass("dragging");e!=i._seriesCurrentPage?(i._seriesCurrentPage=e,i.refreshPagedPivotGrid("series",i._seriesCurrentPage)):i.element.find(".seriesPageIndicator").addClass("inActive")})}));this._categPageCount>1&&(e=function(){return i.element.find(".hScrollPanel").position().left+1},c=n(this.element).find(".hScrollPanel"),c.width(n(l).width()),c.html(t.buildTag("div.hScrollThumb")[0].outerHTML),u=c.find(".hScrollThumb"),u.width(Math.max(Math.ceil(n(l).width()/i._categPageCount),15)),s=c.width()-u.width()-2,u.offset({left:e()+(i._categCurrentPage-1)*(s/(i._categPageCount-1))}),n(u).bind("mousedown",function(t){var o,r,f;n(this).addClass("dragging");o=t.pageX-e();r=u.position().left-e();i.element.find(".categPageIndicator").removeClass("inActive").css({left:u.position().left,top:u.position().top+20});f=i._categCurrentPage;n(document).bind("mousemove",function(t){if(window.navigator.userAgent.indexOf("MSIE ")>-1)n(document).on("selectstart",function(n){n.preventDefault()});else window.getSelection().removeAllRanges();var h=t.pageX-e()-o;h>0&&r+h<=s?u.offset({left:r+h+e()}):h<0&&r+h>=0?u.offset({left:r+h+e()}):r+h>s?u.offset({left:e()+s}):r+h<0&&u.offset({left:e()});f=Math.ceil((u.position().left-e())/(s/i._categPageCount))==0?1:Math.ceil((u.position().left-e())/(s/i._categPageCount));i.element.find(".categPageIndicator").css({left:u.position().left});i.element.find(".categ_CurrentPage").html(f)});n(document).bind("mouseup",function(){n(document).off("selectstart");n(this).unbind("mousemove").unbind("mouseup");n(u).removeClass("dragging");f!=i._categCurrentPage?(i._categCurrentPage=f,i.refreshPagedPivotGrid("categ",i._categCurrentPage)):i.element.find(".categPageIndicator").addClass("inActive")})}))},_getLocalizedLabels:function(n){return t.PivotGrid.locale[this.locale()][n]===r?t.PivotGrid.locale["en-US"][n]:t.PivotGrid.locale[this.locale()][n]},_drillDown:function(i){var f,e,u,o,r,s,h;if(!this.model.enableDeferUpdate){this._dataModel!="Pivot"&&this._off(this.element,"click",".expand, .collapse");this._dataModel=="Pivot"&&this.element.find(".colheader, .rowheader, .value").removeClass("e-droppable");f=i.target.className;this._startDrilldown=!0;f=f.split(" ");f[0]=="expand"?this._drillAction="drilldown":f[0]=="collapse"&&(this._drillAction="drillup");this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:t.PivotGrid.GridAction.DrillDown,element:this.element,customObject:this.model.customObject});e=JSON.stringify(this.model.customObject);u=n(i.target).parent().attr("p");this._drillCaption=n.trim(n(i.target).parent().text());typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?n("#"+oclientProxy._id+"_maxView")[0]?(n("#"+oclientProxy._id+"_maxView").ejWaitingPopup({showOnInit:!0}),this._maxViewLoading=n("#"+oclientProxy._id+"_maxView").data("ejWaitingPopup")):oclientWaitingPopup.show():(ogridWaitingPopup=this.element.data("ejWaitingPopup"),ogridWaitingPopup.show());o=this.model.analysisMode=="relational"?_proxy._drillHeaders.join("||"):this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this.rowCount+parseInt(u.split(",")[1]))].Info;try{r=JSON.parse(this.getOlapReport()).Report}catch(c){r=this.getOlapReport()}typeof oclientProxy!="undefined"&&(r=oclientProxy.model.enableDeferUpdate?oclientProxy.currentReport:r,oclientProxy._olapReport=oclientProxy.currentReport);this._dataModel=="Pivot"?(_proxy=this,s=n(this.element).find("table").detach(),this._collapseMember(s,i.target),this.element.append(s),_proxy._hideGrandTotal(),_proxy.model.enableGroupingBar&&(tableWidth=n("#"+_proxy._id).find(".pivotGridTable").width(),_proxy.element.find(".groupingBarPivot .drag").width(tableWidth-5),cellWidth=n("#"+_proxy._id).find(".pivotGridTable").find("th").width(),_proxy.element.find(".groupingBarPivot .values").width(cellWidth-2),_proxy.element.find(".groupingBarPivot .columns").width(tableWidth-cellWidth),_proxy.element.find(".groupingBarPivot .valueColumn").width(tableWidth)),_proxy._dataModel=="Pivot"&&_proxy.element.find(".colheader, .rowheader, .value").addClass("e-droppable"),ogridWaitingPopup.hide(),h=i,_proxy._trigger("renderSuccess",i),this.model.enableGroupingBar&&_proxy._createFields("drilldown",n("table").width(),n("table th").outerWidth())):this.layout()!=""||this.layout()!="normal"?typeof oclientProxy!="undefined"?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:u,currentReport:r,clientReports:oclientProxy.reports,headerInfo:o,layout:this.layout(),customObject:e}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:u,currentReport:r,headerInfo:o,layout:this.layout(),customObject:e}),this._drillDownSuccess):typeof oclientProxy!="undefined"?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:u,currentReport:r,clientReports:oclientProxy.reports,headerInfo:o,customObject:e}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:u,currentReport:r,headerInfo:o,customObject:e}),this._drillDownSuccess)}},_collapseMember:function(t,i){var e=n(i).parent()[0],v=n(e).attr("p"),d=n(i).attr("tag")!=r?parseInt(n(i).attr("tag"))+e.rowSpan:e.rowSpan,b=n(i).attr("tag")!=r?parseInt(n(i).attr("tag"))+e.colSpan:e.colSpan,h=n(i).closest("tr")[0],ut=null,ft=null,g="false",et=0,nt,k,a,ot,s,tt,f,p,st,it,l,c,w,y,rt,o,u;if(e.className=="rowheader"||e.className=="summary"&&n(e).attr("role")=="rowheader")if(nt=!n(e).index()>0,n(i).attr("class").indexOf("collapse")>-1){for(f=0;f<d;f++){if(ut=n(h).next(),nt)n(h).css("display","none"),n(h).attr("tag",n(h).attr("tag")!=r?parseInt(n(h).attr("tag"))+1:1);else{for(a=e,y=0;y<=n(e).nextAll().length;y++)n(a).css("display","none").attr("hc",n(a).attr("hc")==r?1:parseInt(n(a).attr("hc"))+1),a=n(a).next();g="true"}h=ut;nt=!0}for(k=g=="true"?e.rowSpan-1:e.rowSpan,n(h).find("th").text(n(h).find("th").text().replace(" Total","")).prepend('<span class="expand e-icon" tag="'+d+":"+g+'">&nbsp;<\/span>'),s=n(h).prevAll().find("th:has(span):not(.summary)"),f=0;f<s.length;f++)parseInt(n(s[f]).attr("p").split(",")[0])<parseInt(v.split(",")[0])&&parseInt(n(s[f]).attr("p").split(",")[1])+s[f].rowSpan+(n(s[f]).find("span").attr("tag")!=r?parseInt(n(s[f]).find("span").attr("tag")):0)>=parseInt(v.split(",")[1])+d&&(s[f].rowSpan-=k,n(s[f]).find("span").attr("tag",n(s[f]).find("span").attr("tag")!=r?parseInt(n(s[f]).find("span").attr("tag"))+k:k))}else if(n(i).attr("class").indexOf("expand")>-1){for(f=parseInt(n(i).attr("tag").split(":")[0]);f>=0;f--)ft=n(h).prev(),n(h).attr("tag")==r||parseInt(n(h).attr("tag"))<=1?n(h).css("display","table-row"):et++,n(h).attr("tag")!=r&&(parseInt(n(h).attr("tag")-1)==0?n(h).removeAttr("tag"):n(h).attr("tag",parseInt(n(h).attr("tag"))-1)),h=ft;if(n(i).attr("tag").split(":")[1]=="true")for(a=n(t).find("th[p='"+parseInt(n(e).attr("p").split(",")[0])+","+(parseInt(n(e).attr("p").split(",")[1])-parseInt(n(i).attr("tag").split(":")[0]))+"']"),ot=n(a).nextAll().length,y=0;y<=ot;y++)n(a).attr("hc")==r||parseInt(n(a).attr("hc"))<=1?(n(a).removeAttr("hc"),n(a).attr("ch")==r&&n(a).css("display","")):n(a).attr("hc",parseInt(n(a).attr("hc"))-1),a=n(a).next();for(s=n(n(i).closest("tr")[0]).prevAll().find("th:has(span):not(.summary)"),tt=(n(i).attr("tag").split(":")[1]=="true"?parseInt(n(i).attr("tag").split(":")[0])-1:parseInt(n(i).attr("tag").split(":")[0]))-et,f=0;f<s.length;f++)parseInt(n(s[f]).attr("p").split(",")[0])<parseInt(v.split(",")[0])&&parseInt(n(s[f]).attr("p").split(",")[1])+s[f].rowSpan+(n(s[f]).find("span").attr("tag")!=r?parseInt(n(s[f]).find("span").attr("tag")):0)>=parseInt(v.split(",")[1])&&(s[f].rowSpan+=tt,n(s[f]).find("span").attr("tag")!=r&&n(s[f]).find("span").attr("tag",parseInt(n(s[f]).find("span").attr("tag"))-tt),parseInt(n(s[f]).find("span").attr("tag"))==0&&n(s[f]).find("span").removeAttr("tag"));n(e).text(n(e).text().trim()+" Total");n(e).prepend("<span style='margin-left:10px'><\/span>")}if(e.className=="colheader"||e.className=="summary"&&n(e).attr("role")=="columnheader")if(p=parseInt(v.split(",")[0]),st=n(t).find("tr"),n(i).attr("class").indexOf("collapse")>-1){for(u=0;u<b;u++){for(l=n(h).nextAll().find("th[p^='"+(u+p)+",']"),c=0;c<n(l).length;c++)n(l[c]).attr("hc",n(l[c]).attr("hc")!=r?parseInt(n(l[c]).attr("hc"))+1:1).css("display","none");(n(l[c]).attr("hc")==r||parseInt(n(l[c]).attr("hc"))<1)&&(n(t).find("td[p^='"+(u+p)+",']").css("display","none"),n(t).find("th[p^='0,']:not(.summary)").parent().find("td[p^='"+(u+p)+",']").attr("ch",1))}for(n(e).attr("hc",1).css("display","none"),n(e).next().text(n(e).text().replace(" Total","")).prepend('<span class="expand e-icon" tag="'+b+'">&nbsp;<\/span>'),o=n(h).prevAll().find("th:has(span):not(.summary)"),u=0;u<o.length;u++)parseInt(n(o[u]).attr("p").split(",")[1])<parseInt(v.split(",")[1])&&parseInt(n(o[u]).attr("p").split(",")[0])<=parseInt(v.split(",")[0])&&parseInt(n(o[u]).attr("p").split(",")[0])+o[u].colSpan+(n(o[u]).find("span").attr("tag")!=r?parseInt(n(o[u]).find("span").attr("tag")):0)>=parseInt(v.split(",")[0])+b&&(o[u].colSpan-=e.colSpan,n(o[u]).find("span").attr("tag",n(o[u]).find("span").attr("tag")!=r?parseInt(n(o[u]).find("span").attr("tag"))+e.colSpan:e.colSpan))}else if(n(i).attr("class").indexOf("expand")>-1){for(it=0,u=1;u<b;u++){for(l=n(h).nextAll().find("th[p^='"+(p-u)+",']"),c=0;c<n(l).length;c++)n(l[c]).attr("hc")==r||parseInt(n(l[c]).attr("hc"))==1?(n(l[c]).css("display",""),n(l[c]).removeAttr("hc")):parseInt(n(l[c]).attr("hc"))-1==0?n(l[c]).removeAttr("hc"):n(l[c]).attr("hc",parseInt(n(l[c]).attr("hc"))-1);if(n(l).last().attr("hc")==r)for(n(t).find("td[p^='"+(p-u)+",']").css("display",""),w=n(t).find("th[p^='0,']:not(.summary)").parent().find("td[p^='"+(p-u)+",']"),n(w).removeAttr("ch"),y=0;y<=n(w).length;y++)n(w[y]).attr("hc")!=r&&n(w[y]).css("display","none");else it++}for(n(e).prev().removeAttr("hc").css("display",""),rt=parseInt(n(i).attr("tag"))-it,o=n(h).prevAll().find("th:has(span):not(.summary)"),u=0;u<o.length;u++)parseInt(n(o[u]).attr("p").split(",")[1])<parseInt(v.split(",")[1])&&parseInt(n(o[u]).attr("p").split(",")[0])<parseInt(v.split(",")[0])&&parseInt(n(o[u]).attr("p").split(",")[0])+o[u].colSpan+(n(o[u]).find("span").attr("tag")!=r?parseInt(n(o[u]).find("span").attr("tag")):0)>=parseInt(v.split(",")[0])&&(o[u].colSpan+=rt,n(o[u]).find("span").attr("tag")!=r&&n(o[u]).find("span").attr("tag",parseInt(n(o[u]).find("span").attr("tag"))-rt),parseInt(n(o[u]).find("span").attr("tag"))==0&&n(o[u]).find("span").removeAttr("tag"));n(e).text(n(e).text().trim()+" Total");n(e).prepend("<span style='margin-left:10px'><\/span>")}},_addHyperlink:function(t){if(n(".hyperlinkValueCell")[0]&&n(n(".hyperlinkValueCell")[0]).removeClass("hyperlinkValueCell"),n(".hyperlinkHeaderCell")[0]&&n(n(".hyperlinkHeaderCell")[0]).removeClass("hyperlinkHeaderCell"),n(t.target).text()==""||n(t.target).text()==null)return!1;t.target.className.split(" ")[0]=="value"&&this.enableValueCellHyperlink()?n(t.target).addClass("hyperlinkValueCell"):n(t.target).hasClass("summary value")&&this.enableSummaryCellHyperlink()?n(t.target).addClass("hyperlinkValueCell"):t.target.className.split(" ")[0]=="rowheader"&&this.enableRowHeaderHyperlink()?n(t.target).addClass("hyperlinkHeaderCell"):t.target.className.split(" ")[0]=="colheader"&&this.enableColumnHeaderHyperlink()&&n(t.target).addClass("hyperlinkHeaderCell")},_removeHyperlink:function(t){n(t.target).removeClass("hyperlinkValueCell").removeClass("hyperlinkHeaderCell")},_cellContext:function(t){var i=t.target||t.srcElement,r;if(_proxy.enableCellContext()==!0&&n(i).parents("#"+_proxy._id)[0]&&(r=n(i).attr("p"),r)){var r=n(i).attr("p"),u=_proxy.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*_proxy.rowCount+parseInt(r.split(",")[1]))].Info,f={cellValue:i.innerHTML,cellPosition:r,cellType:i.className.split(" ")[0],role:n(i).attr("role"),uniqueName:u.split("::")[0],args:t,rawdata:u};f.cellType!=""&&_proxy._trigger("cellContext",{args:f});t.target?t.preventDefault():window.event.returnValue=!1}},_initCellSelection:function(i){this._on(this.element,"mouseup",".value",this._completeCellSelection);var r;_oriX=i.pageX;_oriY=i.pageY;r=i.target||window.event.srcElement;n(".value").addClass("selection");n("#"+_proxy._id).append(t.buildTag("div.cellSelection#"+_proxy._id+"_cellSelection","",{}));_startPosCell=n(r)[0].attributes.getNamedItem("p").value;this._on(this.element,"mousemove",".value, .cellSelection",this._cellSelection)},_cellSelection:function(i){n("#"+_proxy._id+"_gridTooltip").hide();i.pageX<_oriX?n("#"+_proxy._id+"_cellSelection").css({left:i.pageX+2,width:_oriX-i.pageX}):n("#"+_proxy._id+"_cellSelection").css({left:_oriX-6,width:i.pageX-_oriX});i.pageY<_oriY?n("#"+_proxy._id+"_cellSelection").css({top:i.pageY,height:_oriY-i.pageY-7}):n("#"+_proxy._id+"_cellSelection").css({top:_oriY+7,height:i.pageY-_oriY-11});n(".pivotGridTable").mouseleave(function(i){t.isNullOrUndefined(i.toElement)||i.toElement.classList[0]!="e-pivotgrid"||(n("#"+_proxy._id+"_cellSelection").remove(),n(".value").removeClass("selection"),_proxy._off(_proxy.element,"mouseup",".value"))})},_completeCellSelection:function(t){var ut,u,s=[],d=[],i,g=[],o,f,h,c,l,w,tt,y,a,b,it,k,rt;for(_proxy._off(_proxy.element,"mousemove",".value"),n(".value").removeClass("selection"),ut=t.target||window.event.srcElement,u=n(ut)[0].attributes.getNamedItem("p").value,f=0,h=parseInt(_startPosCell.split(",")[1])<parseInt(u.split(",")[1])?parseInt(_startPosCell.split(",")[1]):parseInt(u.split(",")[1]);h<=(parseInt(_startPosCell.split(",")[1])>parseInt(u.split(",")[1])?parseInt(_startPosCell.split(",")[1]):parseInt(u.split(",")[1]));h++)for(c=parseInt(_startPosCell.split(",")[0])<parseInt(u.split(",")[0])?parseInt(_startPosCell.split(",")[0]):parseInt(u.split(",")[0]);c<=(parseInt(_startPosCell.split(",")[0])>parseInt(u.split(",")[0])?parseInt(_startPosCell.split(",")[0]):parseInt(u.split(",")[0]));c++){s[f]=_proxy.getJSONRecords()[c*_proxy.rowCount+h];var e,v="",nt,ft,p=0,et=0;if(i=n("#"+_proxy._id).find("tbody").find('[p="'+c+","+h+'"]').parent("tr").find(".rowheader").last().attr("p"),i==r&&(i=n("#"+_proxy._id).find("tbody").find('[p="'+c+","+h+'"]').parent("tr").find(".summary").first().attr("p")),nt=i,i!=null){while(i[0]>=0)i==_proxy.getJSONRecords()[parseInt(parseInt(i.split(",")[0])*_proxy.rowCount+parseInt(i.split(",")[1]))].Index&&(e=_proxy.getJSONRecords()[parseInt(parseInt(i.split(",")[0])*_proxy.rowCount+parseInt(i.split(",")[1]))].Value,i=parseInt(i.split(",")[0])-1+","+parseInt(i.split(",")[1])),v&&e!=""?v=e+"##"+v:e!=""&&(v=e);d[f]=v}for(l="",tt=n("#"+_proxy._id).find("td[p*='"+parseInt(s[f].Index.split(",")[0])+","+parseInt(s[f].Index.split(",")[1])+"']").closest("tbody").prev().children("tr:last").children("th").attr("p")[2],ft=tt,o=s[f].Index,o!=r&&o==_proxy.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*_proxy.rowCount+parseInt(o.split(",")[1]))].Index&&(y=parseInt(o.split(",")[0])),a=0;a<=tt;a++)y!=null&&y+","+a==_proxy.getJSONRecords()[parseInt(parseInt(y)*_proxy.rowCount+a)].Index&&(w=_proxy.getJSONRecords()[parseInt(parseInt(y)*_proxy.rowCount+a)].Value,l==""?l=w:w!=""&&(l=l+"##"+w)),g[f]=l;f++}for(b=_proxy.getJSONRecords()[parseInt(parseInt(nt.split(",")[0])*_proxy.rowCount+parseInt(nt.split(",")[1]))].Info;b[0]>=0;)e=_proxy.getJSONRecords()[parseInt(parseInt(b.split(",")[0])*_proxy.rowCount+parseInt(b.split(",")[1]))].Info,(e.split("::")[0].indexOf("Measures")>0||e.split("::")[0].indexOf("MEASURES")>0)&&p++,i=parseInt(i.split(",")[0])-1+","+parseInt(i.split(",")[1]);if(it=parseInt(o.split(",")[0]),p==0)for(k=0;k<=ft;k++)it!=null&&(rt=_proxy.getJSONRecords()[parseInt(parseInt(it)*_proxy.rowCount+k)].Info),(rt.split("::")[0].indexOf("Measures")>0||rt.split("::")[0].indexOf("MEASURES")>0)&&et++;args={JSONRecords:s,rowHeader:d,columnHeader:g,measureCount:p>0?"Row:"+p:"Column:"+et};_proxy._trigger("cellSelection",args);s=d=g=[];n("#"+_proxy._id+"_cellSelection").remove();_proxy._on(_proxy.element,"mousemove",".value",_proxy._applyToolTip)},exportPivotGrid:function(n){var t,i,r;try{t=JSON.parse(this.getOlapReport()).Report}catch(u){t=this.getOlapReport()}if(this.element.find(".summary").length>0)i={valueCellColor:this.element.find(".value").css("color"),valueCellBGColor:this.element.find(".value").css("background-color"),summaryCellColor:this.element.find(".summary").css("color"),summaryCellBGColor:this.element.find(".summary").css("background-color")};else if(this.element.find(".value").length>0)i={valueCellColor:this.element.find(".value").css("color"),valueCellBGColor:this.element.find(".value").css("background-color")};else return!1;r={args:JSON.stringify({exportOption:n,currentReport:t,layout:_proxy.layout(),colorSettings:JSON.stringify(i)})};this.doPostBack(_proxy.model.url+"/"+_proxy.model.serviceMethodSettings.exportPivotGrid,r)},_getFArrayfromMArray:function(n){var t={formattingArrayClone:1,defaultStyleSCell:2,defaultStyleVCell:3,removedItems:4}[n];for(i=0;i<this.mdformattingArray.length;i++)if(this.mdformattingArray[i][0]==_proxy._id)return this.mdformattingArray[i][t];return[]},createConditionalDialog:function(){var r,u,f,l,e,o,s,h,c;_proxy.element.find(".e-dialog, .clientDialog").remove();r=t.buildTag("div#"+this._id+"_clientDlg.clientDialog",{opacity:"1"})[0].outerHTML;f=_proxy._getLocalizedLabels("ConditionalFormatting");var a=t.buildTag("label#"+this._id+"_conLbl.conditionLbl",this._getLocalizedLabels("Condition"))[0].outerHTML,v=t.buildTag("input#"+this._id+"_conType.conditionType","",{},{type:"text",tabindex:0,accesskey:"f"})[0].outerHTML,y=t.buildTag("label#"+this._id+"_editcond.editcondition",this._getLocalizedLabels("Editcondtion"))[0].outerHTML,p=t.buildTag("label#"+this._id+"_value1.value1",this._getLocalizedLabels("Value1"))[0].outerHTML,w=t.buildTag("label#"+this._id+"_value2.value2",this._getLocalizedLabels("Value2"))[0].outerHTML,b=t.buildTag("label#"+this._id+"_backcolorLbl.backcolorLbl",this._getLocalizedLabels("Backcolor"))[0].outerHTML,k=t.buildTag("label#"+this._id+"_bordercolorLbl.bordercolorLbl",this._getLocalizedLabels("Bordercolor"))[0].outerHTML,d=t.buildTag("label#"+this._id+"_borderrangeLbl.borderrangeLbl",this._getLocalizedLabels("Borderrange"))[0].outerHTML,g=t.buildTag("label#"+this._id+"_borderstyleLbl.borderstyleLbl",this._getLocalizedLabels("Borderstyle"))[0].outerHTML,nt=t.buildTag("label#"+this._id+"_fStyleLbl.fStyleLbl",this._getLocalizedLabels("Fontstyle"))[0].outerHTML,tt=t.buildTag("label#"+this._id+"_fSizeLbl.fSizeLbl",this._getLocalizedLabels("Fontsize"))[0].outerHTML,it=t.buildTag("input#"+this._id+"_editCon.editconditionDropDown","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,l=t.buildTag("button#"+this._id+"_removeBtn.dialogremoveBtn e-icon","",{},{name:_proxy._getLocalizedLabels("Remove")})[0].outerHTML,rt=t.buildTag("input#"+this._id+"_conFrom.conditionFrom","",{},{name:"inputVal",type:"text",tabindex:2})[0].outerHTML,ut=t.buildTag("input#"+this._id+"_conTo.conditionTo","",{},{name:"inputVal",type:"text",tabindex:3})[0].outerHTML,ft=t.buildTag("input#"+this._id+"_backcolor.backcolor","",{},{type:"text",tabindex:4,accesskey:"b"})[0].outerHTML,et=t.buildTag("input#"+this._id+"_bordercolor.bordercolor","",{},{type:"text",tabindex:5,accesskey:"c"})[0].outerHTML,ot=t.buildTag("input#"+this._id+"_borderrange.borderrange","",{},{type:"text",tabindex:6,accesskey:"r"})[0].outerHTML,st=t.buildTag("input#"+this._id+"_borderstyle.borderstyle","",{},{type:"text",tabindex:7,accesskey:"s"})[0].outerHTML,ht=t.buildTag("input#"+this._id+"_fStyle.fStyle","",{},{type:"text",tabindex:8,accesskey:"o"})[0].outerHTML,ct=t.buildTag("input#"+this._id+"_fSize.fSize","",{},{type:"text",tabindex:9,accesskey:"l"})[0].outerHTML,lt=t.buildTag("div#"+this._id+"_conditionDlg.conditionDlg","<table class='conditionformatTbl'><tr><td>"+a+"<\/td><td>"+v+"<\/td><td>"+y+"<\/td><td>"+it+"<\/td><td>"+l+"<\/td><\/tr><tr><td>"+p+"<\/td><td>"+rt+"<\/td><td>"+w+"<\/td><td>"+ut+"<\/td><\/tr><tr><td>"+b+"<\/td><td>"+ft+"<\/td><td>"+d+"<\/td><td>"+ot+"<\/td><\/tr><tr><td>"+k+"<\/td><td>"+et+"<\/td><td>"+g+"<\/td><td>"+st+"<\/td><\/tr><tr><td>"+nt+"<\/td><td>"+ht+"<\/td><td>"+tt+"<\/td><td>"+ct+"<\/td><\/tr><\/table>")[0].outerHTML;return u=lt,s=t.buildTag("button#"+this._id+"_OKBtn.dialogOKBtn","",{},{name:_proxy._getLocalizedLabels("OK")})[0].outerHTML,h=t.buildTag("button#"+this._id+"_CancelBtn.dialogCancelBtn","",{},{name:_proxy._getLocalizedLabels("Cancel")})[0].outerHTML,dialogFooter=t.buildTag("div",s+h,{float:"right",margin:"20px 39px 6px"})[0].outerHTML,n("#"+_proxy._id).after(r),n("#"+this._id+"_clientDlg").append(u+dialogFooter),n("#"+this._id+"_clientDlg").ejDialog({width:"auto",target:"#"+_proxy._id,enableResize:!1}),n(".e-titlebar").prepend(t.buildTag("div",f,{display:"inline"})[0].outerHTML)[0],n("#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,#"+this._id+"_removeBtn").ejButton(),n("#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn").css({margin:"0 0 0 10px",width:"67px"}),n("#"+this._id+"_removeBtn").css({width:"29px",height:"29px"}),n("#"+this._id+"_conFrom,#"+this._id+"_conTo").css({width:"136px",height:"26px"}),n("#"+this._id+"_conditionDlg").css({margin:"13px 0 0 0"}),n("#"+this._id+"_editcond,#"+this._id+"_value2,#"+this._id+"_borderrangeLbl,#"+this._id+"_borderstyleLbl,#"+this._id+"_fSizeLbl").css({margin:"0 0 0 15px"}),n("#"+this._id+"_conTo").attr("disabled","disabled"),this.removeBtn=n("#"+this._id+"_removeBtn").data("ejButton"),e=n("#"+this._id+"_OKBtn").data("ejButton"),o=n("#"+this._id+"_CancelBtn").data("ejButton"),this.removeBtn.setModel({enabled:!1}),e.setModel({text:_proxy._getLocalizedLabels("OK")}),o.setModel({text:_proxy._getLocalizedLabels("Cancel")}),n("#"+this._id+"_conType").ejDropDownList({change:"_onActiveConditionChange",dataSource:["Lesser","Greater","Equal","Not Equal","Between","Not Between"],selectedIndices:[0],width:"142px",height:"30px"}),n("#"+this._id+"_editCon").ejDropDownList({change:"_onEditConditionChange",dataSource:this._list,selectedIndices:[0],width:"142px",height:"30px"}),n("#"+this._id+"_backcolor").ejDropDownList({dataSource:["AliceBlue","Black","Blue","Brown","Gold","Green","Lime","Maroon","Orange","Pink","Red","Violet","White","Yellow"],selectedIndices:[0],width:"142px",height:"30px"}),n("#"+this._id+"_bordercolor").ejDropDownList({dataSource:["AliceBlue","Black","Blue","Brown","Gold","Green","Lime","Maroon","Orange","Pink","Red","Violet","White","Yellow"],selectedIndices:[0],width:"142px",height:"30px"}),n("#"+this._id+"_borderrange").ejDropDownList({dataSource:["1","2","3","4","5","6","7","8","9"],selectedIndices:[0],width:"142px",height:"30px"}),n("#"+this._id+"_borderstyle").ejDropDownList({dataSource:["Solid","Dashed","Dotted","Double","Groove","Inset","Outset","Ridge","None"],selectedIndices:[0],width:"142px",height:"30px"}),n("#"+this._id+"_fStyle").ejDropDownList({dataSource:["Algerian","Arial","Bodoni MT","Britannic Bold","Cambria","Calibri","Courier New","DejaVu Sans","Forte","Gerogia","Impact","Segoe UI","Tahoma","Times New Roman","Verdana","None"],selectedIndices:[0],width:"142px",height:"30px"}),n("#"+this._id+"_fSize").ejDropDownList({dataSource:["12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],selectedIndices:[0],width:"142px",height:"30px"}),_proxy.element.find("#"+this._id+"_conType").ejDropDownList("option","change",t.proxy(_proxy._onActiveConditionChange,_proxy)),_proxy.element.find("#"+this._id+"_editCon").ejDropDownList("option","change",t.proxy(_proxy._onEditConditionChange,_proxy)),this.isNewFormat=!0,this.formattingArrayClone=this._getFArrayfromMArray("formattingArrayClone"),this.removedItems=this._getFArrayfromMArray("removedItems"),this.ddlEditCondition=n("#"+this._id+"_editCon").data("ejDropDownList"),this.ddlConditionType=n("#"+this._id+"_conType").data("ejDropDownList"),this.ddlFont=n("#"+this._id+"_fStyle").data("ejDropDownList"),this.ddlFontSize=n("#"+this._id+"_fSize").data("ejDropDownList"),this.ddlBackColor=n("#"+this._id+"_backcolor").data("ejDropDownList"),this.ddlBorderColor=n("#"+this._id+"_bordercolor").data("ejDropDownList"),this.ddlBorderStyle=n("#"+this._id+"_borderstyle").data("ejDropDownList"),this.ddlBorderWidth=n("#"+this._id+"_borderrange").data("ejDropDownList"),this.element.find("#"+this._id+"_conFrom,#"+this._id+"_conTo").keypress(function(t){return t.which==8||t.which==0?!0:t.which<46||t.which>58?!1:t.which==46&&n(this).val().indexOf(".")!=-1||t.which==47?!1:void 0}),_proxy=this,n("#"+this._id+"_OKBtn").click(function(){var t,r,f,u;if(_proxy._clearGrid(),n("#"+_proxy._id+"_conFrom").val()==""?alert("Enter Operand1"):n("#"+_proxy._id+"_conTo").attr("disabled")||n("#"+_proxy._id+"_conTo").val()!=""?_proxy._applyFormatting():alert("Enter Operand2"),_proxy.isNewFormat){if(t=_proxy.ddlEditCondition._selectedIndices[0],r=_proxy.formattingArrayClone.length/10,r>0)for(i=r-1;i<r;i++){for(f=i,t=0;t<_proxy.formattingArrayClone.length-1;t+=10)u="Format "+i,_proxy.formattingArrayClone[t+9]!=u&&_proxy.formattingArrayClone[t+9]=="Add New"&&(f=f+1,_proxy._list.push(u));_proxy.formattingArrayClone[t-1]=="Add New"&&(_proxy.formattingArrayClone[t-1]=u)}_proxy.isNewFormat=!0}else alert("The given value not matched"),_proxy.isNewFormat=!0}),c=_proxy.formattingArrayClone.length/10,c>0&&(_proxy.ddlEditCondition.selectItemByText(this.formattingArrayClone[this.formattingArrayClone.length-1]),_proxy._onEditConditionChange()),n("#"+this._id+"_removeBtn").click(function(){_proxy._removeFormatting()}),n("#"+this._id+"_CancelBtn").click(function(){_proxy.element.find(".e-dialog, .clientDialog").remove()}),!1},_onActiveConditionChange:function(t){t.selectedText=="Between"||t.selectedText=="Not Between"?n("#"+this._id+"_conTo").removeAttr("disabled"):(n("#"+this._id+"_conTo").attr("disabled","disabled"),n("#"+this._id+"_conTo").val(""))},_onEditConditionChange:function(){if(this.ddlEditCondition._selectedIndices[0]>0){this.formattingArrayClone=this._getFArrayfromMArray("formattingArrayClone");var t=this.ddlEditCondition._selectedIndices[0]*10-10;this.ddlConditionType.selectItemByText(this.formattingArrayClone[t]);n("#"+this._id+"_conFrom").val(this.formattingArrayClone[t+1]);n("#"+this._id+"_conTo").val(this.formattingArrayClone[t+2]);this.ddlBackColor.selectItemByText(this.formattingArrayClone[t+3]);this.ddlBorderColor.selectItemByText(this.formattingArrayClone[t+4]);this.ddlBorderStyle.selectItemByText(this.formattingArrayClone[t+5]);this.ddlBorderWidth.selectItemByText(this.formattingArrayClone[t+6]);this.ddlFont.selectItemByText(this.formattingArrayClone[t+7]);this.ddlFontSize.selectItemByText(this.formattingArrayClone[t+8]);this.removeBtn.option("enabled",!0);_proxy._onConditionTypeChange()}else this.removeBtn.option("enabled",!1),_proxy._clearWindow()},_clearWindow:function(){n("#"+this._id+"_clientDlg").find("#"+this._id+"_conFrom,#"+this._id+"_conTo").val("");n("#"+this._id+"_conTo").disabled=!0},_onConditionTypeChange:function(){n("#"+this._id+"_conTo").disabled=!(this.ddlConditionType._selectedIndices[0]==4||this.ddlConditionType._selectedIndices[0]==5)},_removeFormatting:function(){var r,n,t;if(this.removeBtn.option("enabled")&&(j=0,this.removedItems=this._getFArrayfromMArray("removedItems"),r=confirm("Are you sure you want to remove the selected format?"),r==!0)){for(n=this.ddlEditCondition._selectedIndices[0],n==1&&this.removeBtn.option("enabled",!1),_proxy.removedItems[_proxy.removedItems.length]=_proxy.ddlEditCondition._selectedValue,this._list.pop(this.ddlEditCondition._selectedIndices[0]-1),n-1!=0?(_proxy.ddlEditCondition._selectedIndices[0]=n-1,_proxy.ddlEditCondition.selectItemByText(this.formattingArrayClone[n*10-11])):this._list.length>1?(_proxy.ddlEditCondition._selectedIndices[0]=n,_proxy.ddlEditCondition.selectItemByText(this.formattingArrayClone[n*10-1])):_proxy.ddlEditCondition._selectedIndices[0]=n-1,i=(n-1)*10+0;i<=(n-1)*10+9;i++)this.formattingArrayClone[i]="N/A";for(t=this.formattingArrayClone,this.formattingArrayClone=[],i=0;i<t.length;i++)t[i]!="N/A"&&(this.formattingArrayClone[j]=t[i],j++);for(i=0;i<this.mdformattingArray.length;i++)this.mdformattingArray[i][0]==_proxy._id&&(this.mdformattingArray[i][1]=this.formattingArrayClone,this.mdformattingArray[i][4]=this.removedItems);_proxy._onEditConditionChange();_proxy._clearGrid();_proxy._applyFormatting();_proxy.element.find(".e-dialog, .clientDialog").remove()}},_clearGrid:function(){var t=n(".pivotGridTable .value"),r;for(i=0;i<t.length;i++)r=!1,t[i].className=="value"?(this.defaultStyleVCell.length==0&&(this.defaultStyleVCell=this.defaultStyleSCell),n(t[i]).is(":visible")||(r=!0),n(t[i]).attr("style",this.defaultStyleVCell)):(this.defaultStyleSCell.length==0&&(this.defaultStyleSCell=this.defaultStyleVCell),n(t[i]).is(":visible")||(r=!0),n(t[i]).attr("style",this.defaultStyleSCell)),r&&n(t[i]).hide()},_applyFormatting:function(){var t,r,u;if(n("#"+this._id+"_conFrom").val()!=""){t=n(".pivotGridTable .value");u=!1;this.formattingArrayClone=this._getFArrayfromMArray("formattingArrayClone");this.removedItems=this._getFArrayfromMArray("removedItems");this.formattingArrayClone.length==0&&(u=!0);var f=n("#"+this._id+"_conFrom").val(),e=n("#"+this._id+"_conTo").val(),o=this.ddlConditionType._selectedValue,s=this.ddlBackColor._selectedValue,h=this.ddlBorderColor._selectedValue,c=this.ddlBorderWidth._selectedValue,a=this.ddlFont._selectedValue,v=this.ddlFontSize._selectedValue,y=this.ddlBorderStyle._selectedValue,p=this.ddlEditCondition._selectedValue;if(r=[this.ddlConditionType._selectedValue,f,e,this.ddlBackColor._selectedValue,this.ddlBorderColor._selectedValue,this.ddlBorderStyle._selectedValue,this.ddlBorderWidth._selectedValue,this.ddlFont._selectedValue,this.ddlFontSize._selectedValue,this.ddlEditCondition._selectedValue],j=0,l=0,cdnFmtLen=this.formattingArrayClone.length+10,!this.isDrillDown)if(this.ddlEditCondition._selectedIndices[0]==0)for(i=this.formattingArrayClone.length;i<cdnFmtLen;i++)this.formattingArrayClone[i]=r[l],l++;else if(cdnFmtLen=this.ddlEditCondition._selectedIndices[0]*10-10,this.ddlEditCondition._selectedIndices[0]>0)for(i=cdnFmtLen;i<cdnFmtLen+10;i++)this.formattingArrayClone[i]=r[l],l++;for(this.isDrillDown=!1,_proxy._setDefaultStyle(),j=0,l=0,u&&(this.mdformattingArray[this.mdformattingArray.length]=[],this.mdformattingArray[this.mdformattingArray.length-1]=[_proxy._id,this.formattingArrayClone,this.defaultStyleSCell,this.defaultStyleVCell,this.removedItems]),l=0;l<this.formattingArrayClone.length;l++){for(value=[],i=0;i<t.length;i++)value.length==0&&(value[value.length]=this.formattingArrayClone[l+1],value[value.length]=this.formattingArrayClone[l+2],value[value.length]=this.formattingArrayClone[l]),this._getResult(this.formattingArrayClone[l+1],this.formattingArrayClone[l+2],Number(n(t[i]).text().replace(/[^0-9\.]+/g,"")),this.formattingArrayClone[l])&&(n(t[i]).text()!=""||n(t[i]).text()!=null)&&(t[i].style.backgroundColor=this.formattingArrayClone[l+3],t[i].style.borderColor=this.formattingArrayClone[l+4],t[i].style.borderStyle=this.formattingArrayClone[l+5],t[i].style.borderWidth=this.formattingArrayClone[l+6]+"px",t[i].style.fontFamily=this.formattingArrayClone[l+7],t[i].style.fontSize=this.formattingArrayClone[l+8]+"px");l+=9}_proxy.element.find(".e-dialog, .clientDialog").remove()}},_getResult:function(n,t,i,r){switch(r){case"Lesser":return i<n;case"Greater":return i>n;case"Equal":if(i==n)return i;break;case"Not Equal":return i!=n;case"Between":return n<t&&i>n&&i<t||n>t&&i<n&&i>t||i==n&&i==t;case"Not Between":return!(n<t&&i>n&&i<t||n>t&&i<n&&i>t||i==n&&i==t)}},_setDefaultStyle:function(){var t=n(".pivotGridTable .value");if(this.defaultStyleSCell=this._getFArrayfromMArray("defaultStyleSCell"),this.defaultStyleVCell=this._getFArrayfromMArray("defaultStyleVCell"),this.defaultStyleVCell.length==0||this.defaultStyleSCell.length==0)for(j=0;j<t.length;j++)t[j].className=="value"&&this.defaultStyleVCell.length==0&&t[j].currentStyle!=r?this.defaultStyleVCell=t[j].currentStyle:t[j].className=="summary value"&&this.defaultStyleSCell.length==0&&t[j].currentStyle!=r&&(this.defaultStyleSCell=t[j].currentStyle)},_renderControlSuccess:function(i){_proxy=this;try{if(i[0]!=r&&i.length>0?(_proxy.setJSONRecords(i[0].Value),_proxy.setOlapReport(i[1].Value),i[2]!=null&&i[2]!=r&&i[2].Key=="PageSettings"&&(_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(i[3].Value).Column/JSON.parse(i[2].Value).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(i[3].Value).Row/JSON.parse(i[2].Value).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(i[2].Value).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(i[2].Value).SeriesPageSize):n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&_proxy._pagerObj.initPagerProperties(JSON.parse(i[3].Value),JSON.parse(i[2].Value)),i[4]!=null&&i[4]!=r&&(_proxy.model.customObject=i[4].Value)),(i[2]!=null&&i[2]!=r&&i[2].Key!="PageSettings"||i[2]!=null&&i[2]!=r&&i[2].Key=="customobject")&&(_proxy.model.customObject=i[2].Value)):i.d!=r&&i.d.length>0?(_proxy.setJSONRecords(i.d[0].Value),_proxy.setOlapReport(i.d[1].Value),i.d[2]!=null&&i.d[2]!=r&&i.d[2].Key=="PageSettings"&&(_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(i.d[3].Value).Column/JSON.parse(i.d[2].Value).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(i.d[3].Value).Row/JSON.parse(i.d[2].Value).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(i.d[2].Value).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(i.d[2].Value).SeriesCurrentPage):n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&_proxy._pagerObj.initPagerProperties(JSON.parse(i.d[3].Value),JSON.parse(i.d[2].Value)),i.d[4]!=null&&i.d[4]!=r&&(_proxy.model.customObject=i.d[4].Value)),(i.d[2]!=null&&i.d[2]!=r&&i.d[2].Value=="PageSettings"||i.d[2]!=null&&i.d[2]!=r&&i.d[2].Key=="customobject")&&(_proxy.model.customObject=i.d[2].Value)):!t.isNullOrUndefined(i)&&t.isNullOrUndefined(i.d)&&(i.PivotRecords!=r?(_proxy.setJSONRecords(i.PivotRecords),_proxy.setOlapReport(i.OlapReport),i.HeaderCounts!=r&&_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Column/JSON.parse(i.PageSettings).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Row/JSON.parse(i.PageSettings).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(i.PageSettings).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(i.PageSettings).SeriesCurrentPage):i.HeaderCounts!=r&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&_proxy._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))):i.JsonRecords!=r&&_proxy.model.enableJSONRendering==!0?(_proxy.setJSONRecords(JSON.stringify(i.JsonRecords)),_proxy.setOlapReport(JSON.stringify(i.PivotReport))):i.JsonRecords!=r&&(_proxy.setJSONRecords(i.JsonRecords),_proxy.setOlapReport(i.PivotReport)),i.customObject!=null&&i.customObject!=r&&(_proxy.model.customObject=i.customObject)),_proxy.getOlapReport()!=r&&_proxy.getOlapReport()!=""&&_proxy.model.enableVirtualScrolling!=!0)try{_proxy._dataModel=JSON.parse(_proxy.getOlapReport()).DataModel}catch(f){_proxy._dataModel=""}_proxy.model.enableGroupingBar==!0&&this._dataModel=="Pivot"&&(report=JSON.parse(_proxy.getOlapReport()),this._pivotTableFields=JSON.parse(report.ItemsProperties),_proxy._createGroupingBar(report));_proxy.model.afterServiceInvoke!=null&&_proxy._trigger("afterServiceInvoke",{action:t.PivotGrid.GridAction.Initialize,element:_proxy.element,customObject:_proxy.model.customObject});_proxy.getJSONRecords()!=null&&_proxy.getJSONRecords().length>0?_proxy.renderControlFromJSON(_proxy.getJSONRecords()):_proxy.renderControlFromJSON("");_proxy.model.enableConditionalFormatting&&this.formattingArrayClone.length>0&&_proxy._applyFormatting();typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?n("#"+oclientProxy._id+"_maxView")[0]&&this._maxViewLoading?this._maxViewLoading.hide():oclientWaitingPopup.hide():ogridWaitingPopup.hide()}catch(f){}var u={action:"initialize",customObject:this.model.customObject,element:this.element};this._hideGrandTotal();this._trigger("renderSuccess",u)},_hideGrandTotal:function(){if(this.model.enableRowGrandTotal&&this.model.enableGrandTotal||this._dataModel!="Pivot"||n("#"+this._id).find("tr:last").hide(),n("#"+this._id).find("tr:first th.summary").attr("p")!=r&&(!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)&&this._dataModel=="Pivot"){var t=n("#"+this._id).find("th.calc.gtot");for(cLen=0;cLen<t.length;cLen++)n("#"+this._id).find('th[p^="'+parseInt(n(t[cLen]).attr("p").split(",")[0])+',"]').hide(),n("#"+this._id).find('td[p^="'+parseInt(n(t[cLen]).attr("p").split(",")[0])+',"]').hide()}},_createGroupingBar:function(n){var i,r;for(this._pivotFilter=_proxy._getLocalizedLabels("DragFieldHere"),i=0;i<n.Filters.length;i++)if(n.PivotColumns.length>=1)for(r=0;r<n.PivotColumns.length;r++)n.Filters.length==0||t.isNullOrUndefined(n.Filters[i])||n.Filters[i].Tag!=n.PivotColumns[r].Tag||(n.Filters.splice(i,1),i=-1);for(i=0;i<n.Filters.length;i++)if(n.PivotRows.length>=1)for(r=0;r<n.PivotRows.length;r++)n.Filters.length==0||t.isNullOrUndefined(n.Filters[i])||n.Filters[i].Tag!=n.PivotRows[r].Tag||(n.Filters.splice(i,1),i=-1);for(i=0;i<n.Filters.length;i++)if(n.PivotCalculations.length>=1)for(r=0;r<n.PivotCalculations.length;r++)n.Filters.length==0||t.isNullOrUndefined(n.Filters[i])||n.Filters[i].Tag!=n.PivotCalculations[r].Tag||(n.Filters.splice(i,1),i=-1);filterTag=_proxy._createPivotButtons(this._pivotFilter!=null&&n.Filters.length>1&&n.Filters[0].Tag==n.Filters[1].Tag?n.Filters.slice(1):n.Filters,"filter");this._pivotFilter=filterTag;rowTag=_proxy._createPivotButtons(n.PivotRows,"row");this._pivotRow=rowTag;columnTag=_proxy._createPivotButtons(n.PivotColumns,"column");this._pivotColumn=columnTag;valueTag=_proxy._createPivotButtons(n.PivotCalculations,"values");this._pivotCalculation=valueTag},_createPivotButtons:function(n,i){var e,f,h,r,o,s,u,c;if(!t.isNullOrUndefined(n)){for(e="",f=i=="column"?"columns":i=="row"?"rows":i=="filter"?"Slicers":"",f==""&&i=="values"&&(h=this.element.find(".pivotButton:contains('Measures')").length>0?this.element.find(".pivotButton:contains('Measures')").parent()[0].className.split(" ")[0]:"schemaColumn",f=h=="schemaColumn"?"columns":"rows"),r=0;r<n.length;r++){for(o=this._ascdes.split("##"),s=0,sort="",filtered="",u=0;u<o.length;u++)o[u]==n[r].Tag&&(s=1);if(s==1&&(sort="descending"),!t.isNullOrUndefined(this._tempFilterData))for(u=0;u<this._tempFilterData.length;u++)for(c in this._tempFilterData[u])c==n[r].Tag&&this._tempFilterData[u][n[r].Tag].length>0&&(filtered="filtered");e+=t.buildTag("span.pivotButton",t.buildTag("span.dropIndicator")[0].outerHTML+t.buildTag("button.pvtBtn#pivotButton"+n[r].FieldHeader||n[r].FieldName||n[r].Name||n[r].DimensionName,n[r].FieldHeader||n[r].FieldName||n[r].Name||n[r].DimensionName)[0].outerHTML+t.buildTag("span.filter e-icon "+filtered)[0].outerHTML+t.buildTag("span.sorting e-icon "+sort)[0].outerHTML+t.buildTag("span.removeBtn e-icon")[0].outerHTML).attr("tag",f+":"+n[r].Tag)[0].outerHTML}return e}},_createFields:function(i){var s,r,h,f,e,u,o;if(this.element.find(".groupingBarPivot").remove(),this.element.prepend(t.buildTag("div#groupingBarPivot.groupingBarPivot")[0].outerHTML),this.element.find(".groupingBarPivot").prepend(t.buildTag("div.valueColumn",t.buildTag("span.values","")[0].outerHTML+t.buildTag("span.columns","")[0].outerHTML,{width:"100%"})),this.element.find(".groupingBarPivot").prepend(t.buildTag("div.drag",t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+_proxy._getLocalizedLabels("DragFieldHere"),{width:"100%"})[0].outerHTML),this._pivotFilter!=""&&this._pivotFilter!=null&&this.element.find(".drag").text(""),this.element.find(".drag").append(this._pivotFilter),this.element.find(".values").append(this._pivotCalculation),this.element.find(".columns").append(this._pivotColumn),_proxy.element.find(".values .pivotButton").length==0&&_proxy.element.find(".values").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+_proxy._getLocalizedLabels("ValueArea")),_proxy.element.find(".columns .pivotButton").length==0&&_proxy.element.find(".columns").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+_proxy._getLocalizedLabels("ColumnArea")),_proxy.element.find(".rows .pivotButton").length==0&&_proxy.element.find(".rows").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+_proxy._getLocalizedLabels("RowArea")),(this.element.find(".rowheader").length==0&&this.element.find(".colheader").length==0&&this.element.find(".values .pivotButton").length==0||this.element.find(".pivotGridTable th").length==0)&&(s=t.buildTag("div.emptyRows",t.buildTag("span.rows",_proxy._getLocalizedLabels("RowArea"),{width:"5px"})[0].outerHTML,{width:140})[0].outerHTML,this.element.find(".rows").length==0?this.element.find(".groupingBarPivot").append(s):"",this.model.enableDeferUpdate&&this._pivotRow!=""&&(this.element.find(".rows").text(""),this.element.find(".rows").append(this._pivotRow)),this.element.find(".emptyRows,.rows").ejDroppable({})),this.element.find(".values").find(".filter").remove(),this.element.find(".values").find(".sorting").remove(),this.element.find(".drag").find(".sorting").remove(),this.element.find(".pivotButton .pvtBtn").ejButton({size:"normal"}).ejDraggable({handle:"button",clone:!0,cursorAt:{left:-5,top:-5},dragStart:t.proxy(function(){this._isDragging=!0},this),dragStop:t.proxy(this._onPvtBtnDropped,this),helper:t.proxy(function(t){return t.sender.target.className.indexOf("e-btn")>-1?n(t.sender.target).clone().addClass("dragClone").appendTo(this.element):!1},this)}),this.element.find(".drag, .values, .columns, .grpRow, .rows").ejDroppable({}),this.element.find(".pivotGridTable").find("thead th:eq(1)").length>0?this.element.find(".groupingBarPivot").width(n(".pivotGridTable").width()):this.element.find(".pivotGridTable").find("thead").length>0?this.model.isResponsive||this.element.find(".groupingBarPivot").width(n(".rows").width()+150):this.element.find(".groupingBarPivot").width(300),_proxy.element.find(".rows").height(this.model.enableDeferUpdate||i=="drilldown"?this.element.find(".grpRow").height()-8:this.element.find(".grpRow").height()),(this.element.find(".rows").width()>140||this.model.enableDeferUpdate&&_proxy.element.find(".rows").width()<_proxy.element.find(".grpRow").width())&&(this.enableDeferUpdate?this.element.find(".rows").width(this.element.find(".colheader").length==0?this.element.find(".grpRow").width()-140:this.element.find(".grpRow").width()):_proxy.element.find(".rows").width(_proxy.model.enableDeferUpdate?_proxy.element.find(".grpRow").width()-8:_proxy.element.find(".grpRow").width())),(this.element.find(".pivotGridTable thead").length>0||this.model.enableDeferUpdate&&this.element.find(".pivotGridTable thead").length==0)&&(this.model.isResponsive&&this.element.find(".values .pivotButton").length==0&&this.element.find(".columns .pivotButton").length==0?this.element.find(".values").width(140):this.element.find(".values").width(this.element.find(".grpRow").length>0?this.model.enableDeferUpdate&&this.element.find(".colheader").length==0?this.element.find(".grpRow").width():this.element.find(".grpRow").width()+4:140),this.model.enableDeferUpdate&&this.element.find(".colheader").length==0&&this.element.find(".pivotGridTable .rowheader").length!=0&&(u=_proxy.element.find(".groupingBarPivot").width()-_proxy.element.find(".values").width(),u<140&&this.element.find(".groupingBarPivot").width(this.element.find(".groupingBarPivot").width()+140)),this.element.find(".pivotGridTable").find("thead th:eq(1)").length>0||this.model.enableDeferUpdate&&_proxy.element.find(".columns .pivotButton").length==0?(r=this.element.find(".pivotGridTable").width()-this.element.find(".values").width()-4,this.element.find(".pivotGridTable").find("thead th:eq(2)").length==0?(this.element.find(".columns").css("min-width",r>=30&&this.element.find(".pivotGridTable .colheader").length==0?140:r),(_proxy.element.find(".columns .pivotButton").length==0||this.model.enableDeferUpdate&&_proxy.element.find(".pivotGridTable .colheader").length==0)&&(_proxy.element.find(".columns .pivotButton").length==0&&(r=this.element.find(".groupingBarPivot").width()-this.element.find(".values").width()-5,this.element.find(".columns").width(r),r<140&&(n(".groupingBarPivot .values .pivotButton").length==1||n(".groupingBarPivot .values .pivotButton").length==0&&this.model.enableDeferUpdate)&&this.element.find(".columns").css("min-width",r+"px")),this.element.find(".columns").addClass("widthSetter"))):r<140?this.element.find(".columns").css("min-width",r).addClass("widthSetter"):this.element.find(".columns").width(r)):this.element.find(".pivotGridTable").find("thead th:eq(1)").length!=0||this.model.enableDeferUpdate||(h=this.element.find(".columns .pivotButton").length<1?1:this.element.find(".columns .pivotButton").length,this.element.find(".columns").addClass("widthSetter"),this.element.find(".columns").css("min-width",(this.element.find(".groupingBarPivot").width()-this.element.find(".values").width()-7)/h))),this.element.find(".drag").height()>30&&(f=this.element.find(".groupingBarPivot").width()/(_proxy.element.find(".drag .pivotButton").length+1)-5,_proxy.element.find(".drag .pivotButton").width(f)),this.element.find(".values").height()>30&&(f=this.element.find(".values").width()/(_proxy.element.find(".values .pivotButton").length+1)-5,_proxy.element.find(".values .pivotButton").width(f)),this.element.find(".rows").height()>30&&this.model.enableDeferUpdate&&this.element.find(".pivotGridTable").find("thead th:eq(1)").length==0&&(f=this.element.find(".rows").width()/(_proxy.element.find(".rows .pivotButton").length+1)-5,_proxy.element.find(".rows .pivotButton").width(f)),this.model.enableDeferUpdate&&_proxy.element.find(".columns .pivotButton").length!=0){for(e=0,u=0,o=0;_proxy.element.find(".columns .pivotButton").length>o;o++)e=_proxy.element.find(".columns .pivotButton:eq("+o+")").width()+e+7;if(this.element.find(".pivotGridTable .colheader,.pivotGridTable tr:eq(0) .summary").each(function(){u=u+n(this).width()}),e>=u){var c=this.element.find(".pivotGridTable .colheader").length>0?1:0,r=c==0?140:u,f=r/(_proxy.element.find(".columns .pivotButton").length+1)-5;_proxy.element.find(".columns .pivotButton").width(f)}}(this.element.find(".values").height()>this.element.find(".columns").height()||this.element.find(".columns").height()>this.element.find(".values").height())&&(this.element.find(".values").height()>this.element.find(".columns").height()?this.element.find(".columns").height(this.element.find(".values").height()):this.element.find(".values").height(this.element.find(".columns").height()));this.element.find(".colheader, .rowheader, .value").addClass("e-droppable");this.element.find(".summary").removeClass("e-droppable")},_onPvtBtnDropped:function(i){var e,u,s,l;if(this._dataModel=="Pivot")for(e=n(i.target).parents(),u=0;u<e.length;u++)if(e[u].className.split(" ")[0]=="e-pivotschemadesigner"){this.element.find(".dragClone").remove();return}this._isDragging=!1;this.element.find(".dropIndicator").removeClass("dropIndicatorHover");var o="",f,r,h=!1,c=!1;if(this._dataModel=="Pivot")for(f=i.element.text(),r=i.target.className.indexOf("e-droppable")>=0?i.target.className.split(" ")[0]:"",o,h=i.element.find("~ .filterIndicator").length>0?!0:!1,c=i.element.find("~ span:eq(0) span.descending").length>0?!0:!1,r==""&&(i.target.tagName=="BUTTON"||i.target.tagName=="SPAN")&&(r=i.target.parentNode.parentElement.className.split(" ")[0]),u=0;u<this._pivotTableFields.length;u++)this._pivotTableFields[u].name==f&&(this._pivotTableFields[u].isSelected=!0,o=this._pivotTableFields[u]);if(this.element.find(".dragClone").remove(),r=="rows"||r=="columns"||r=="values"||r=="drag"){r=="drag"&&this.element.find(".drag").text("");s="";try{report=JSON.parse(this.getOlapReport()).Report}catch(a){report=this.getOlapReport()}n(i.element.parent()).remove();ogridWaitingPopup=this.element.data("ejWaitingPopup");t.isNullOrUndefined(ogridWaitingPopup)||ogridWaitingPopup.show();this._schemaData!=null&&(this._schemaData.element.find("#pivotButton"+f).parent().remove(),this._schemaData._createPivotButton(f,r=="rows"?"row":r=="columns"?"column":r=="drag"?"filter":r=="values"?"value":"",h,c,s));r=r=="rows"?"schemaRow":r=="columns"?"schemaColumn":r=="drag"?"schemaFilter":r=="values"?"schemaValue":"";this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject});l=JSON.stringify(this.model.customObject);eventArgs=JSON.stringify({action:"nodeDropped",dropAxis:r+"::"+s,headerTag:JSON.stringify(o),sortedHeaders:this._ascdes,currentReport:report,customObject:l});successMethod=this._renderControlSuccess;this.model.enableDeferUpdate?(t.isNullOrUndefined(ogridWaitingPopup)||ogridWaitingPopup.hide(),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,eventArgs.replace("nodeDropped","nodeDroppedDeferUpdate"),this._pvtBtnDroppedSuccess)):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,eventArgs,this._pvtBtnDroppedSuccess)}else this._removePvtBtn(i)},_pvtBtnDroppedSuccess:function(n){!t.isNullOrUndefined(n[0])&&n.length>0?n[2]!=null&&n[2]!=r&&(this.model.customObject=n[2].Value):!t.isNullOrUndefined(n.d)&&n.d.length>0?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):t.isNullOrUndefined(n)||t.isNullOrUndefined(n.OlapReport)||n!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this._trigger("afterServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject});this.model.enableDeferUpdate?this._deferUpdateSuccess(n):this._renderControlSuccess(n)},_deferUpdateSuccess:function(i){t.isNullOrUndefined(i.PivotReport)?_proxy.setOlapReport(i.d[0].Value):_proxy.setOlapReport(i.PivotReport);this.model.enableGroupingBar&&(report=JSON.parse(_proxy.getOlapReport()),this._pivotTableFields=JSON.parse(report.ItemsProperties),_proxy._createGroupingBar(report),this.element.find(".grpRow .rows").text(""),this.element.find(".grpRow .rows").children().remove(),this.element.find(".grpRow .rows").append(_proxy._pivotRow),_proxy._createFields(null,n("table").width(),n("table th").outerWidth()))},_removePvtBtn:function(i){var e,r,f,u,s,o,h,c;for(i.type=="click"?r=n(n(i.target).siblings()[1]).text():(r=i.element.text(),f=i.element.parent().attr("tag")),filterTag="",filterItems="",selectedElement="",f="",uniqueName="",e="",selectedElement=_proxy.element.find(".pivotButton:contains("+r+")"),u=0;u<this._pivotTableFields.length;u++)this._pivotTableFields[u].name==r&&(this._pivotTableFields[u].isSelected=!1,f=this._pivotTableFields[u]);try{e=JSON.parse(this.getOlapReport()).Report}catch(l){e=this.getOlapReport()}filterTag="schemaRow::"+r+"::FILTERED"+filterItems;s=this._droppedClass!=""?this._droppedClass:f.pivotType=="PivotItem"?"schemaRow":"schemaValue";this._droppedClass="";n(selectedElement).remove();ogridWaitingPopup=this.element.data("ejWaitingPopup");t.isNullOrUndefined(ogridWaitingPopup)||ogridWaitingPopup.show();this._schemaData!=null?(h=this._schemaData._tableTreeObj.element.find("li:contains('"+r+"')"),this._schemaData._tableTreeObj.uncheckNode(h)):(this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"nodeStateModified",element:this.element,customObject:this.model.customObject}),c=JSON.stringify(this.model.customObject),o=JSON.stringify({action:"nodeStateModified",headerTag:JSON.stringify(f),dropAxis:s+"::",sortedHeaders:this._ascdes,filterParams:filterTag,currentReport:e,customObject:c}),this.model.enableDeferUpdate?(this.doAjaxPost("POST",this.model.url+"/nodeStateModified",o.replace("nodeStateModified","nodeStateModifiedDeferUpdate"),this._nodeStateModifiedSuccess),t.isNullOrUndefined(ogridWaitingPopup)||ogridWaitingPopup.hide()):this.doAjaxPost("POST",this.model.url+"/nodeStateModified",o,this._nodeStateModifiedSuccess))},_nodeStateModifiedSuccess:function(n){n[0]!=r?n[2]!=null&&n[2]!=r&&(this.model.customObject=n[2].Value):n.d!=r?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):n.customObject!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this._trigger("afterServiceInvoke",{action:"nodeStateModified",element:this.element,customObject:this.model.customObject});this.model.pivotControl.model.enableDeferUpdate?this._deferUpdateSuccess(n):this._renderControlSuccess(n)},_drillDownSuccess:function(i){_proxy=this;i[0]!=r?(this.setJSONRecords(i[0].Value),this.setOlapReport(i[1].Value),typeof oclientProxy!="undefined"&&(oclientProxy.currentReport=i[1].Value,i[2].Value!=r&&i[2].Value!="undefined"&&(oclientProxy.reports=i[2].Value)),i[3]!=null&&i[3]!=r&&i[3].Key=="PageSettings"&&(_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(i[4].Value).Column/JSON.parse(i[3].Value).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(i[4].Value).Row/JSON.parse(i[3].Value).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(i[3].Value).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(i[3].Value).SeriesPageSize):n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&_proxy._pagerObj.initPagerProperties(JSON.parse(i[4].Value),JSON.parse(i[3].Value)),i[5]!=null&&i[5]!=r&&(_proxy.model.customObject=i[5].Value)),i[3]!=null&&i[3]!=r&&i[3].Key!="PageSettings"&&(_proxy.model.customObject=i[3].Value)):i.d!=r?(this.setJSONRecords(i.d[0].Value),this.setOlapReport(i.d[1].Value),typeof oclientProxy!="undefined"&&(oclientProxy.currentReport=i.d[1].Value,i.d[2].Value!=r&&i.d[2].Value!="undefined"&&(oclientProxy.reports=i.d[2].Value)),i.d[3]!=null&&i.d[3]!=r&&i.d[3].Key=="PageSettings"&&(_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(i.d[4].Value).Column/JSON.parse(i.d[3].Value).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(i.d[4].Value).Row/JSON.parse(i.d[3].Value).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(i.d[3].Value).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(i.d[3].Value).SeriesCurrentPage):n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&_proxy._pagerObj.initPagerProperties(JSON.parse(i.d[4].Value),JSON.parse(i.d[3].Value)),i.d[5]!=null&&i.d[5]!=r&&(_proxy.model.customObject=i.d[5].Value)),i.d[3]!=null&&i.d[3]!=r&&i.d[3].Key!="PageSettings"&&(_proxy.model.customObject=i.d[3].Value)):(this.setJSONRecords(i.PivotRecords),this.setOlapReport(i.OlapReport),typeof oclientProxy!="undefined"&&(oclientProxy.currentReport=i.OlapReport,i.reports!=r&&i.reports!="undefined"&&(oclientProxy.reports=i.reports)),i.length>3&&(_proxy.model.enableVirtualScrolling?(_proxy._categPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Column/JSON.parse(i.PageSettings).CategorialPageSize),_proxy._seriesPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Row/JSON.parse(i.PageSettings).SeriesPageSize),_proxy._categCurrentPage=JSON.parse(i.PageSettings).CategorialCurrentPage,_proxy._seriesCurrentPage=JSON.parse(i.PageSettings).SeriesCurrentPage):n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&_proxy._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))),i.customObject!=null&&i.customObject!=r&&(_proxy.model.customObject=i.customObject));this.model.afterServiceInvoke!=null&&this._trigger("afterServiceInvoke",{action:t.PivotGrid.GridAction.DrillDown,element:this.element,customObject:this.model.customObject});this.renderControlFromJSON(this.getJSONRecords());try{this.model.currentReport=JSON.parse(this.getOlapReport()).Report}catch(f){this.model.currentReport=this.getOlapReport()}this._trigger("drillSuccess",this.element);typeof oclientWaitingPopup!="undefined"&&oclientWaitingPopup!=null?n("#"+oclientProxy._id+"_maxView")[0]&&this._maxViewLoading?(this._maxViewLoading.hide(),oclientWaitingPopup.hide()):oclientProxy.model.displaySettings.mode=="gridOnly"&&oclientWaitingPopup.hide():typeof oclientProxy!="undefined"?(!oclientProxy||oclientProxy.ogridObj._startDrilldown||oclientProxy.ochartObj._startDrilldown)&&oclientProxy.model.displaySettings.mode!="gridOnly"||oclientWaitingPopup.hide():typeof oclientWaitingPopup=="undefined"&&(ogridWaitingPopup=n("#"+this._id).data("ejWaitingPopup"),ogridWaitingPopup.hide());typeof oclientProxy!="undefined"?oclientProxy.ogridObj._startDrilldown=!1:ogridWaitingPopup.hide();var u={action:this._drillAction,customObject:this.model.customObject,element:this.element};this._trigger("renderSuccess",u)},doAjaxPost:function(i,r,u,f){n.ajax({type:i,url:r,contentType:"application/json; charset=utf-8",dataType:"json",data:u,success:n.proxy(f,this),complete:t.proxy(function(t){n.proxy(t,this);var i={action:this._currentAction,customObject:this.model.customObject,element:this.element};this._trigger("renderComplete",i)},this),error:t.proxy(function(n){ogridWaitingPopup.hide();var t={action:this._drillAction!=""?this._drillAction:"initialize",customObject:this.model.customObject,element:this.element,Message:n};this._trigger("renderFailure",t)},this)})},doPostBack:function(t,i){var r=n("<form>").attr({action:t,method:"POST",name:"export"}),f=function(t,i){var u=n('<input type="hidden" title="params">').attr({id:t,name:t,value:i}).appendTo(r)};for(var u in i)f(u,i[u]);r.appendTo(document.body).submit().remove()},refreshPagedPivotGrid:function(t,i){typeof oclientWaitingPopup=="undefined"&&(ogridWaitingPopup=n("#"+this._id).data("ejWaitingPopup"),ogridWaitingPopup.show());t=t.indexOf("categ")!=-1?"categorical":"series";var r;try{r=JSON.parse(this.getOlapReport()).Report}catch(u){r=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"Paging",pagingInfo:t+":"+i,currentReport:r,layout:this.layout(),customObject:null}),this._renderControlSuccess)},renderControlFromJSON:function(i){var r,s,a,v,e,o,u;if(_proxy=this,r=n('<table class="pivotGridTable" cellspacing="0" cellpadding="0" role=\'grid\'  aria-readonly=\'true\'><\/table>'),this.model.isResponsive&&r.addClass("e-table"),this.rowCount=0,i!=null&&i!=""){jQuery.each(i,function(){this.Index[0]==0&&_proxy.rowCount++});var h=n("<thead><\/thead>"),c=n("<tbody><\/tbody>"),l=!0,f=0;i[0].CSS=="none"?f=i[0].RowSpan-1:(jQuery.each(i,function(n){return f+=i[n].RowSpan,i[n].CSS=="colheader"}),f=f-2);jQuery.each(i,function(r){var o,u,e,s;if(r<_proxy.rowCount)if(l){for(l=r>=f?!1:!0,o="<tr role='row'>",u=r;u<i.length;u=u+_proxy.rowCount)if(i[u].Span!="Block")if(o=i[u].Index=="0,0"&&_proxy.model.enableGroupingBar&&_proxy._dataModel=="Pivot"?o+"<th class=grpRow p="+i[u].Index+" colspan="+i[u].ColSpan+" rowspan="+i[u].RowSpan+" role='columnheader'>"+(i[u].State==0?'<span style="margin-left: 0px"><\/span>':i[u].State==2?'<span class="expand e-icon">&nbsp;<\/span>':i[u].State==1?'<span class="collapse e-icon" title="Collapsed">&nbsp;<\/span>':"")+i[u].Value+t.buildTag("div.rows",_proxy._pivotRow,{})[0].outerHTML+"<\/th>":o+"<th"+(i[u].CSS=="none"?"":' class="'+i[u].CSS)+(i[u].CSS=="none"?" p="+i[u].Index:'" p='+i[u].Index)+" colspan="+i[u].ColSpan+" rowspan="+i[u].RowSpan+" role='columnheader'>"+(i[u].State==0?'<span style="margin-left: 10px"><\/span>':i[u].State==2?'<span class="expand e-icon">&nbsp;<\/span>':i[u].State==1?'<span class="collapse e-icon" title="Collapsed">&nbsp;<\/span>':"")+i[u].Value+"<\/th>",i[u].RowSpan>1&&i[u].ColSpan<=1)for(e=u+1;e<u+i[u].RowSpan;e++)i[e].Span="Block";else if(i[u].ColSpan>1&&i[u].RowSpan<=1)for(e=u+_proxy.rowCount;e<u+i[u].ColSpan*_proxy.rowCount;e=e+_proxy.rowCount)i[e].Span="Block";else if(i[u].ColSpan>1&&i[u].RowSpan>1)for(e=u;e<u+i[u].RowSpan;e++){for(s=e+_proxy.rowCount;s<e+i[u].ColSpan*_proxy.rowCount;s=s+_proxy.rowCount)i[s].Span="Block";i[e].Index!="0,0"&&(i[e].Span="Block")}o+="<\/tr>";n(h).append(o)}else{for(o="<tr role='row'>",u=r;u<i.length;u=u+_proxy.rowCount)if(i[u].Span!="Block")if(o=i[u].CSS=="rowheader"||i[u].CSS=="summary"||i[u].CSS=="summary"?_proxy.layout().toLowerCase()=="excellikelayout"?o+"<th"+(i[u].CSS=="none"?"":' class="'+i[u].CSS)+'" p='+i[u].Index+" colspan="+i[u].ColSpan+" rowspan="+i[u].RowSpan+" role='rowheader'>"+(i[u].State==2?'<span style="margin-left:'+i[u].Level*10+'px" class="expand e-icon">&nbsp;<\/span>':i[u].State==1?'<span style="margin-left:'+i[u].Level*10+'px" class="collapse e-icon">&nbsp;<\/span>':'<span style="margin-left:'+i[u].Level*10+'px">&nbsp;<\/span>')+i[u].Value+"<\/th>":o+"<th"+(i[u].CSS=="none"?"":' class="'+i[u].CSS)+'" p='+i[u].Index+" colspan="+i[u].ColSpan+" rowspan="+i[u].RowSpan+" role='rowheader'>"+(i[u].State==0?'<span style="margin-left: 10px"><\/span>':i[u].State==2?'<span class="expand e-icon">&nbsp;<\/span>':i[u].State==1?'<span class="collapse e-icon">&nbsp;<\/span>':"")+i[u].Value+"<\/th>":o+"<td"+(i[u].CSS=="none"?"":' class="'+i[u].CSS)+'" p='+i[u].Index+" colspan="+i[u].ColSpan+" rowspan="+i[u].RowSpan+" role='gridcell'>"+(i[u].State==2?'<span class="expand e-icon">&nbsp;<\/span>':i[u].State==1?'<span class="collapse e-icon">&nbsp;<\/span>':"")+i[u].Value+"<\/td>",i[u].RowSpan>1&&i[u].ColSpan<=1)for(e=u+1;e<u+i[u].RowSpan;e++)i[e].Span="Block";else if(i[u].ColSpan>1&&i[u].RowSpan<=1)for(e=u+_proxy.rowCount;e<u+i[u].ColSpan*_proxy.rowCount;e=e+_proxy.rowCount)i[e].Span="Block";else if(i[u].ColSpan>1&&i[u].RowSpan>1)for(e=u;e<u+i[u].RowSpan;e++){for(s=e+_proxy.rowCount;s<e+i[u].ColSpan*_proxy.rowCount;s=s+_proxy.rowCount)i[s].Span="Block";i[e].Index!="0,0"&&(i[e].Span="Block")}o+="<\/tr>";n(c).append(o)}})}if(this._unWireEvents(),this._wireEvents(),n(r).append(h),n(r).append(c),this._dataModel=="Pivot"&&this.model.enableCollapseByDefault){for(s=JSON.parse(this.getOlapReport()),a=s.Rows,v=s.Columns,e=a;e>=0;e--)for(thRList=n(r).find("th[p^='"+e+",']:has('span.collapse')[class^='rowheader']"),u=0;u<thRList.length;u++)this._collapseMember(r,n(thRList[u]).find(".collapse"));for(o=v;o>=0;o--)for(thCList=n(r).find("th[p$=',"+o+"']:has('span.collapse')[class$='colheader']"),u=0;u<thCList.length;u++)this._collapseMember(r,n(thCList[u]).find(".collapse"))}this.element.html("");_proxy.model.enableVirtualScrolling?(_proxy._createVirtualPivotGrid(r),_proxy._applyVScrolling()):this.model.enableGroupingBar&&this._dataModel=="Pivot"?(_proxy.element.append(r),_proxy._createFields(r,n("table").width(),n("table th").outerWidth())):this.element.append(r);_proxy.model.enableRTL?(this.element.find("table").addClass("e-rtl"),this.element.find(".groupingBarPivot").addClass("e-rtl"),this.element.find(".groupingBarPivot").width(n(".pivotGridTable").width()),this.element.find("table .rowheader,.colheader,.summary, .groupingBarPivot, .grpRow").css("text-align","right")):(this.element.find("table").removeClass("e-rtl"),this.element.find(".groupingBarPivot").removeClass("e-rtl"),this.element.find("table .rowheader,.colheader,.summary, .grpRow, .groupingBarPivot ").css("text-align","left"));_proxy.model.enableConditionalFormatting&&this.formattingArrayClone.length>0&&(_proxy._drillAction!=""&&(_proxy.isDrillDown=!0),_proxy._applyFormatting())},_createVirtualPivotGrid:function(n){var u=_proxy._seriesPageCount>1?t.buildTag("div.vScrollPanel")[0].outerHTML:"",f=_proxy._categPageCount>1?t.buildTag("div.hScrollPanel")[0].outerHTML:"",e=t.buildTag("td.virtualScrollGrid",n[0].outerHTML)[0],o=t.buildTag("td.virtualScrollElement",u),s=t.buildTag("td.virtualScrollElement",f),h=t.buildTag("tr.virtualScrollElement",e.outerHTML+o[0].outerHTML),c=t.buildTag("tr.virtualScrollElement",s[0].outerHTML+t.buildTag("td.virtualScrollElement")[0].outerHTML),l=t.buildTag("tbody.oGridOuterDiv.virtualScrollElement",h[0].outerHTML+c[0].outerHTML),i,r;this.element.html(t.buildTag("table.virtualScrollElement",l[0].outerHTML));i=t.buildTag("div.seriesPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("SeriesPage"))[0].outerHTML+t.buildTag("span.series_CurrentPage",_proxy._seriesCurrentPage)[0].outerHTML+" / "+t.buildTag("span.series_pageCount",_proxy._seriesPageCount)[0].outerHTML)[0].outerHTML;_proxy._seriesPageCount>1&&_proxy.element.append(i);r=t.buildTag("div.categPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("CategoricalPage"))[0].outerHTML+t.buildTag("span.categ_CurrentPage",_proxy._categCurrentPage)[0].outerHTML+" / "+t.buildTag("span.categ_pageCount",_proxy._categPageCount)[0].outerHTML)[0].outerHTML;_proxy._categPageCount>1&&_proxy.element.append(r)}});t.PivotGrid.Layout={Normal:"normal",NormalTopSummary:"normaltopsummary",NoSummaries:"nosummaries",ExcelLikeLayout:"excellikelayout"};t.PivotGrid.locale={};t.PivotGrid.locale["en-US"]={ToolTipRow:"Row",ToolTipColumn:"Column",ToolTipValue:"Value",SeriesPage:"Series Page",CategoricalPage:"Categorical Page",DragFieldHere:"Drag field here",ColumnArea:"Drop column here",RowArea:"Drop row here",ValueArea:"Drop values here",OK:"OK",Cancel:"Cancel",Remove:"Remove",ConditionalFormatting:"Conditional Formatting",Condition:"Conditional Type",Value1:"Value1",Value2:"Value2",Editcondtion:"Edit Condition",Backcolor:"Back Color",Borderrange:"Border Range",Borderstyle:"Border Style",Fontsize:"Font Size",Fontstyle:"Font Style",Bordercolor:"Border Color"};t.PivotGrid.GridAction={Initialize:"initialize",DrillDown:"drillDown"};t.PivotGrid.ExportOptions={Excel:"excel",Word:"word",PDF:"pdf",CSV:"csv"};t.PivotGrid.AnalysisMode={Olap:"olap",Relational:"relational"}})(jQuery,Syncfusion)});