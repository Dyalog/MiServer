/*!
*  filename: ej.spreadsheet.min.js
*  version : 13.3.0.18
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.scroller.min","./ej.datepicker.min","./ej.checkbox.min","./ej.dropdownlist.min","./ej.editor.min","./ej.pager.min","./ej.ribbon.min","./ej.calculate.min","./ej.excelfilter .min"],n):n()})(function(){(function(n,t,r){t.widget("ejSpreadsheet","ej.Spreadsheet",{_rootCSS:"e-spreadsheet",element:null,_excelFilter:null,validTags:["div"],model:null,defaults:{allowFreezing:!0,enableContextMenu:!0,allowEditing:!0,allowResizing:!0,allowMerging:!0,allowWrap:!0,allowUndoRedo:!0,allowClipboard:!0,allowDataValidation:!0,allowConditionalFormats:!0,allowSearching:!0,allowKeyboardNavigation:!0,allowAutoFill:!0,allowSelection:!0,allowSorting:!0,allowDragAndDrop:!0,allowCharts:!0,enablePersistence:!1,allowCellFormatting:!0,allowFormulaBar:!0,showRibbon:!0,allowComments:!0,allowFiltering:!0,allowInsert:!0,allowDelete:!0,allowFormatPainter:!0,allowHyperlink:!0,allowImport:!0,allowFormatAsTable:!0,allowAutoSum:!0,allowPivotTable:!1,columnCount:21,rowCount:20,rowHeight:20,columnWidth:60,sheetCount:1,undoredoStep:20,activeSheetIndex:1,apWidth:200,cssClass:"",userName:"",locale:"en-US",pageSize:"A4",sheets:[],nameManager:[],currentViewData:null,query:null,actionBegin:null,actionComplete:null,beforeCellFormat:null,cellFormatting:null,beforeOpen:null,beforeDrop:null,drop:null,cellEdit:null,pagerClick:null,cellClick:null,_pivotPrint:null,tabClick:null,tabSelect:null,_createPivotTable:null,beforePanelOpen:null,load:null,loadComplete:null,beforePrint:null,editRangeBegin:null,editRangeComplete:null,cellHover:null,menuClick:null,contextMenuClick:null,ribbonClick:null,dragStart:null,drag:null,cellSave:null,beforeCellSelect:null,autoFillBegin:null,autoFillComplete:null,seriesRendering:null,openFailure:null,scrollSettings:{width:600,height:300,allowScrolling:!0,scrollMode:"infinite",isResponsive:!1},pageSettings:{pageCount:10,currentPage:1,pagerHeight:26},exportSettings:{allowExporting:!0,excelUrl:null,csvUrl:null},pictureSettings:{allowPictures:!0,height:220,width:440},selectionSettings:{selectionType:"default",selectionUnit:"multirange",enableAnimation:!1,animationType:"easeOutQuart",animationTime:.001,activeCell:""},chartSettings:{height:220,width:440},formatSettings:{allowFontFamily:!0,allowDecimalPlaces:!0,allowCellBorder:!0},autoFillSettings:{fillType:"fillseries",showFillOptions:!0},importSettings:{importMapper:"",importUrl:"",password:""},printSettings:{allowPageSetup:!0,allowPageSize:!1,allowPrinting:!0}},_dataSource:function(n){return this.getSheet(n).dataSource},getSheet:function(n){return this.model.sheets[n]},getSheetElement:function(n){return this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value)},getDataSource:function(n){return this.getSheet(n).dataSource},setDataSource:function(n,t){this.getSheet(n).dataSource=t},_getJSSheetHeader:function(n){return this._sheets[n]._sheetHeader},_setJSSheetHeader:function(n,t){this._sheets[t]._sheetHeader=n},_getInputBox:function(){return this._inputBox},_setInputBox:function(n){this._inputBox=n},_getIndexBox:function(){return this._indexBox},_setIndexBox:function(n){this._indexBox=n},_getJSSheetRowHeader:function(n){return this._sheets[n]._sheetRowHeader},_setJSSheetRowHeader:function(n,t){this._sheets[t]._sheetRowHeader=n},_getJSSheetRowHeaderContent:function(n){return this._sheets[n]._sheetRowHeaderContent},_setJSSheetRowHeaderContent:function(n,t){this._sheets[t]._sheetRowHeaderContent=n},_getJSSheetContent:function(n){return this._sheets[n]._sheetContent},_setJSSheetContent:function(n,t){this._sheets[t]._sheetContent=n},_getContent:function(n){return this._sheets[n]._content},_setContent:function(n,t){this._sheets[t]._content=n},getPager:function(){return this._spreadSheetPager},setPager:function(n){this._spreadSheetPager=n},getFooter:function(){return this._footer},setFooter:function(n){this._footer=n},getMainPanel:function(){return this._mainPanel},setMainPanel:function(n){this._mainPanel=n},getGroupPanel:function(){return this._groupPanel},setGroupPanel:function(n){this._groupPanel=n},getActivationPanel:function(){return this._activationPanel},setActivationPanel:function(n){this._activationPanel=n},getActiveSheetIndex:function(){return this.model.activeSheetIndex},setActiveSheetIndex:function(n){this.model.activeSheetIndex=n},getRows:function(n){return this._sheets[n]._Rows},setRows:function(n,t){this._sheets[t]._Rows=n},getFrozenRows:function(n){return this.getSheet(n)._frozenRows},setFrozenRows:function(n,t){this.getSheet(t)._frozenRows=n},getFrozenColumns:function(n){return this.getSheet(n)._frozenColumns},setFrozenColumns:function(n,t){this.getSheet(t)._frozenColumns=n},setFocusTopElem:function(n){this._focusTopElem=n},getFocusTopElem:function(){return this._focusTopElem},setFocusRightElem:function(n){this._focusRightElem=n},getFocusRightElem:function(){return this._focusRightElem},setFocusBottomElem:function(n){this._focusBottomElem=n},getFocusBottomElem:function(){return this._focusBottomElem},setFocusLeftElem:function(n){this._focusLeftElem=n},getFocusLeftElem:function(){return this._focusLeftElem},setAutoFillElem:function(n){this._autoFillElem=n},getAutoFillElem:function(){return this._autoFillElem},_setAutoFillOptElem:function(n){this._autoFillOptElem=n},_getAutoFillOptElem:function(){return this._autoFillOptElem},setActiveCell:function(n,i,r){var f=this.getSheet(r?r:this.getActiveSheetIndex()),u;typeof n=="string"&&(u=this.getRangeIndices(n),n=u[0],i=u[1]);f._activeCell=t.isNullOrUndefined(n)&&t.isNullOrUndefined(i)?f._startCell:{rowIndex:n,colIndex:i}},getActiveCell:function(n){return this.getSheet(n?n:this.getActiveSheetIndex())._activeCell},_setFormulaSuggElem:function(n){this._formulaSuggElem=n},_getFormulaSuggElem:function(){return this._formulaSuggElem},_sheetSettings:function(n){var i={rowIndex:0,colIndex:0},t=this.getSheet(n),r=this._generateSheetName(this._newSIndex);this.model.sheets[n]={colCount:t&&t.colCount||this.model.columnCount,rowCount:t&&t.rowCount||this.model.rowCount,_formulaCollection:{},columnsWidthCollection:[],rowsHeightCollection:[],_spreadSheetPager:null,showHeader:!0,showGridlines:!0,dataSource:this.isUndefined(t)?null:t.dataSource,columns:t&&t.columns?t.columns:[],_excelFilter:null,filterSettings:{filteredColumns:[],maxFilterChoices:1e3,filteredRange:[],range:"",tableRange:[]},_frozenRows:t&&t._frozenRows||0,_frozenColumns:t&&t._frozenColumns||0,_selectedRange:{},_selectedCellColors:[],columnWidth:this.model.columnWidth,rowHeight:this.model.rowHeight,_currentTopFrozenRow:0,_currentLeftFrozenColumn:0,_frozenHeight:0,_frozenWidth:0,_firstRow:{idx:0,value:0},_firstCol:{idx:0,value:0},_topRow:{idx:0,value:0},_leftCol:{idx:0,value:0},_selectedCells:[],selectedRange:[],_tableManager:{},_header:{},_selectedCellIndexes:[],_startCell:i,_endCell:i,_activeCell:i,_autoFillCell:i,rangeSettings:t&&t.rangeSettings||[],_sheetName:{text:r,value:this._getLocStr("Sheet")+this._newSIndex,isVisible:!0},_multipleFiltering:!1,_multifilterIdx:[],_filteredByColor:"",staticWidth:0,_fRow:0,_fCol:0,hideColsCollection:[],hideRowsCollection:[],filteredRowsCollection:[],_rHeightCollection:[],_cWidthCollection:[],_hiddenHeight:0,_hiddenWidth:0,_frHiddenHeight:0,_fpHiddenHeight:0,_fpHiddenWidth:0,_pTarget:{},_cSpan:1,_rSpan:1,_usedRange:{rowIndex:0,colIndex:0},_mergedCells:[],_shapeMngr:{picture:[],chart:[],sharedPics:[]},_nmValue:{},_nmEdit:!1,_importRendered:!1,_defRowCount:0,_defColCount:0,_wrapHtCollection:{},_isChartBorderDrawn:!1}},_generateSheetName:function(n){var i,u,t=this.model.sheets,f=1,r;if(r=this.isUndefined(t[n])||this.isUndefined(t[n].sheetName)?this._getLocStr("Sheet")+n:t[n].sheetName,!this.isUndefined(t))for(i=1,u=t.length;i<u;i++)this.isUndefined(t[i]._sheetName)||r!==t[i]._sheetName.text||(i=1,r=this.isUndefined(t[n])||this.isUndefined(t[n].sheetName)?this._getLocStr("Sheet")+ ++n:t[n].sheetName+f++);return r},_initPrivateProperties:function(){var n=1,i={rowIndex:0,colIndex:0},r=this._getLocStr("AutoFillOptions").split("/");for(this._dataContainer={sheets:{},hashCode:[],sharedData:[],cellType:[],valData:[],cFormatData:[],pictures:[]},this._newSIndex=1,this._sheets=this.importSheet?this._sheets:[];n<=this.model.sheetCount;)this._sheetSettings(n),this._dataContainer.sheets[n]={},this._sheets[n]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null,_calcEngine:null},this._newSIndex++,n++;this.XLCFormat=null;this.XLCellNav=null;this.XLClipboard=null;this.XLEdit=null;this.XLFormat=null;this.XLFndRp=null;this.XLChart=null;this.XLCMenu=null;this.XLComment=null;this.XLDragDrap=null;this.XLDragFill=null;this.XLExport=null;this.XLFilter=null;this.XLFreeze=null;this.XLPrint=null;this.XLResize=null;this.XLRibbon=null;this.XLScroll=null;this.XLSelection=null;this.XLSort=null;this.XLShape=null;this.XLValidate=null;this._detachTable=null;this._isPrint=!1;this._isSheetInsert=!1;this._isSheetRename=!1;this._sheetCopy={isSheetCopy:!1,sheetContent:null};this._id=this.element.attr("id");this._currentJsonData={};this._alertDialog={element:null,action:null};this._dataManager=this.getDataSource(this.getActiveSheetIndex())instanceof t.DataManager?this.getDataSource(this.getActiveSheetIndex()):this.getDataSource(this.getActiveSheetIndex())!=null?t.DataManager(this.getDataSource(this.getActiveSheetIndex())):null;this._isUndo=!1;this._undoCollection=[];this._redoCollection=[];this._hasComment=!1;this._tableLayout="";this._ctrlKeyCount=0;this._formulaRange=[];this._formulaHeight=36;this._isSort=!1;this._isPaste=!1;this._undoredoStep=20;this._isFAT=!1;this._isFATResize=!1;this._isDisplayHeader=!1;this._isPerHt=!1;this._isPerWt=!1;this._currencySymbol=Globalize.culture(this.model.locale).numberFormat.currency.symbol?Globalize.culture(this.model.locale).numberFormat.currency.symbol:"$";this._percentSymbol=Globalize.culture(this.model.locale).numberFormat.percent.symbol?Globalize.culture(this.model.locale).numberFormat.percent.symbol:"%";this.operators={"<":function(n,t){return n<t},">":function(n,t){return n>t},">=":function(n,t){return n>=t},"<=":function(n,t){return n<=t},"==":function(n,t){return n===t},"!=":function(n,t){return n!==t},"!":function(n){return!n},"=":function(n){return n}};this.parse={parseInt:function(n){return parseInt(n)},parseFloat:function(n){return parseFloat(n)},parseDate:function(n){return new Date(n).getTime()},parseTime:function(n){return new Date("01/01/1990 "+n).getTime()},length:function(n){return n.charAt(0)==="^"?parseInt(n.split("^")[1]):n.length}};this._selMergeCells=[];this._mergeType="merge-cells";this._delCells=[];this._deletedText=[];this._insDelStatus="";this.$headerTable=null;this._isUndoRedo=!1;this._indexBox=null;this._inputBox=null;this._focusTopElem=null;this._focusRightElem=null;this._focusBottomElem=null;this._focusLeftElem=null;this._dStartCell=i;this._dEndCell=i;this._pStartCell=i;this._pEndCell=i;this._pFillCell=i;this._borderFocus=["e-focusright","e-focusbottom"];this._cutFocus=["e-cutright","e-cutbottom"];this._autoFillFocus=["e-autofillright","e-autofillbottom"];this._formulaBorder=[["e-bborderright","e-bborderbottom"],["e-rborderright","e-rborderbottom"],["e-vborderright","e-vborderbottom"],["e-gborderright","e-gborderbottom"],["e-pborderright","e-pborderbottom"],["e-oborderright","e-oborderbottom"]];this._ctrlFormulaBorder=[["e-bctrlborderright","e-bctrlborderbottom"],["e-rctrlborderright","e-rctrlborderbottom"],["e-vctrlborderright","e-vctrlborderbottom"],["e-gctrlborderright","e-gctrlborderbottom"],["e-pctrlborderright","e-pctrlborderbottom"],["e-octrlborderright","e-octrlborderbottom"]];this._borderTypes=[{id:"bottomborder",text:this._getLocStr("BottomBorder"),parentId:null,sprite:"e-icon e-ss-bottomborder"},{id:"topborder",text:this._getLocStr("TopBorder"),parentId:null,sprite:"e-icon e-ss-topborder"},{id:"leftborder",text:this._getLocStr("LeftBorder"),parentId:null,sprite:"e-icon e-ss-leftborder"},{id:"rightborder",text:this._getLocStr("RightBorder"),parentId:null,sprite:"e-icon e-ss-rightborder"},{id:"noborder",text:this._getLocStr("NoBorder"),parentId:null,sprite:"e-icon e-ss-noborder"},{id:"allborder",text:this._getLocStr("AllBorder"),parentId:null,sprite:"e-icon e-ss-allborder"}];this._isApply=!1;this._datePattern=["year","month","day","hours","minutes","seconds"];this._styleColl={};this.importSheet=this.importSheet?!0:!1;this._borderStyle="solid";this._borderColor="#000000";this._borderStyles=["solid","dashed","dotted"];this._mergeCenter=!1;this._ddlCell=null;this._cOpt={};this._shapeChange=!1;this._dupDetails=!1;this._paste=!1;this._autoFillElem=null;this._autoFillOptElem=null;this._rowCount=this.model.rowCount;this._colCount=this.model.columnCount;this._fillOptionMenuData=[{id:"copycells",text:r[0],parentId:null,sprite:"e-icon e-ss-fillselect"},{id:"fillseries",text:r[1],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"fillformattingonly",text:r[2],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"fillwithoutformatting",text:r[3],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"flashfill",text:r[4],parentId:null,sprite:"e-icon e-ss-filloption"}];this._formulaSuggElem=null;this._isFormulaSuggestion=!1;this._ctrlKeyEnabled=!1;this._shiftKeyEnabled=!1;this._preventctrlkey=!1;this._rAlign="e-ralign";this._cAlign="e-calign";this._chartBorder=[["e-rcbright","e-rcbbottom"],["e-vcbright","e-vcbbottom"],["e-bcbright","e-bcbbottom"]];this._selectionBorder=["e-selecttop","e-selectright","e-selectbottom","e-selectleft"];this._autofillBorder=["e-autofilltop","e-autofillright","e-autofillbottom","e-autofillleft"];this._thinBorder=["e-thinright","e-thinbottom"];this._rcRegx=new RegExp("\\be-rc.*\\b","g");this._mcRegx=new RegExp("\\be-mc.*\\b","g");this._formatRegx=new RegExp("\\be-format.*?\\b","g");this._borderRegx=new RegExp("\\be-border.*?\\b","g");this._wrapRow=!1;this._formulaChanged=[];this._ref=[];this._prevText="";this._selectDataval={};this._undoInputobj={};this._cureditedCell="";this._importedCondFormat=[];this._importedValData=[]},_initCssRules:function(){var t,n;t=document.getElementById(this._id+"_sscustomformat");n=".e-spreadsheet .e-hide, .e-spreadsheet .e-mc-hide, .e-spreadsheet .e-fr-hide, .e-spreadsheet .e-r-hide{ display: none}";n+=".e-spreadsheet .e-rowcell.e-redft { background-color: #FFC7CE; color: #9C0055;} .e-spreadsheet .e-rowcell.e-yellowft { background-color: #FFEB9C; color: #9C6500;}";n+=".e-spreadsheet .e-rowcell.e-greenft { background-color: #C6EFCE;   color: #006100;} .e-spreadsheet .e-rowcell.e-redf { background-color: #FFC7CE;} .e-spreadsheet .e-rowcell.e-redt { color: #9C0055;}";n+=".e-spreadsheet .e-rowcell.e-hlcell { background-color: #FFFF00; color: #FF0000;} .e-spreadsheet .e-rowcell.e-goto-blank { background-color: #C6C6C6;}";n+=".e-fc-hide, .e-c-hide  {width: 0 !important;}";t.styleSheet?t.styleSheet.cssText+=n:t.appendChild(document.createTextNode(n))},_generateHeaderText:function(n,t){var i;if(n)if(i=this.getSheet(n),i._isTemplate){if(i.columns[t]!=r)return i.columns[t].field}else return t/26>1?this._generateHeaderText(n,t%26==0?t/26-1:Math.floor(t/26))+String.fromCharCode(t%26==0?"Z".charCodeAt("Z"):64+t%26):String.fromCharCode(64+t)},_generateColCount:function(n){var i=0,t;for(n=n.split("").reverse().join(""),t=n.length-1;t>=0;t--)i+=(n[t].charCodeAt(n[t])-64)*Math.pow(26,t);return i},_getSheetIndex:function(n){return n?n:this.getActiveSheetIndex()},_getSheetIdxFromName:function(n){for(var t=1,i=this.model.sheets,r=i.length-1;t<=r;){if(i[t]._sheetName.value===n)return t;t++}return-1},_getAlphaRange:function(n,t,i,r,u){return t=t+1,i=i+1,r=r+1,u=u+1,t===r&&i===u?this._generateHeaderText(n,i)+t:this._generateHeaderText(n,i)+t+":"+this._generateHeaderText(n,u)+r},_getProperAlphaRange:function(n,t,i,r,u){var f=this._getAlphaRange(n,t,i,r,u);return f.indexOf(":")===-1?f+":"+f:f},_getDollarAlphaRange:function(n,t){var i=this.getActiveSheetIndex();return t&&!this.isRange(n)?this.getSheet(i)._sheetName.value+"!$"+this._generateHeaderText(i,n[1]+1)+"$"+(n[0]+1):this.getSheet(i)._sheetName.value+"!$"+this._generateHeaderText(i,n[1]+1)+"$"+(n[0]+1)+":$"+this._generateHeaderText(i,n[3]+1)+"$"+(n[2]+1)},_getWorkbookMaxRowColCnt:function(n,t){for(var f,r,u,i,e=0,o=0,s=1,n=n?n:this.model.sheets,h=n.length;s<h;){if(i=n[s],t){if(!i.usedRange)continue;f=this.getRangeIndices(i.usedRange);r=f[2];u=f[3]}else r=i.rowCount,u=i.colCount;e<r&&(e=r);o<u&&(o=u);s++}return{rowCount:e,colCount:o}},_generateEJMenu:function(n,i,r){return{menuType:n==="normal"?t.MenuType.NormalMenu:t.MenuType.ContextMenu,orientation:i==="vertical"?t.Orientation.Vertical:t.orientation.Horizontal,cssClass:r}},_generateEJDD:function(t,i,r,u,f,e){return{dataSource:t,fields:i,selectedItemIndex:r,width:u,height:f,change:n.proxy(this.XLRibbon._frTypeChange,this,e)}},_renderHeaderCol:function(i,r,u){for(var a=t.buildTag("tr.e-columnheader"),v,h,y=n(document.createElement("colgroup")),p=n(document.createElement("tr")),c,w,l,b,f=this.getSheet(i),s=[],o=f.columnWidth,e=u;e<r;e++)this._sheetCopy.isSheetCopy&&(o=t.isNullOrUndefined(f.columnsWidthCollection[e])?f.columnWidth:f.columnsWidthCollection[e]),c=t.buildTag("th.e-headercell","",{},{}),w=document.createElement("td"),l=f._isTemplate?t.buildTag("div.e-headercelldiv",this._generateHeaderText(i,e),{},{}):t.buildTag("div.e-headercelldiv",this._generateHeaderText(i,e+1),{},{}),c.append(l),v=l.text(),b=t.buildTag("col","",{width:o},{}),p.append(w),a.append(c),y.append(b),f.columnsWidthCollection[e]=o,f._colWidthCollection.push({idx:e+1,value:f._colWidthCollection[f._colWidthCollection.length-1].value+o}),f._isTemplate||f.columns.push({field:v,type:h!=null?h.getDay?"date":typeof h:null,width:o});return s.push(p),s.push(a),s.push(y),s},_renderHeaderColumns:function(i){var u=t.buildTag("table.e-table","",{},{cellspacing:"0.25px"}),f=n(document.createElement("thead")),e=t.buildTag("tbody.e-hide"),o,s,h,r;return r=this._renderHeaderCol(i,this.getSheet(i).colCount,0),s=r.pop(),o=r.pop(),h=r.pop(),f.append(o),e.append(h),u.append(s).append(f).append(e),u},_renderHeader:function(n){var i=t.buildTag("div.e-spreadsheetheader"),u=t.buildTag("div.e-spreadsheetcolumnheader e-icon e-ss-selectall  e-ss-cursor","",{float:"left",width:29,height:20.5},{}),r=t.buildTag("div.e-headercontent");return r.append(this._renderHeaderColumns(n)),this._setJSSheetHeader(i,n),i.append(u),i.append(r),i},_refreshWidthHeight:function(i,r,u,f){var h,a=0,v=0,e=this._getContent(i),c,l,s=this._getJSSheetRowHeader(i),o=0;return this.model.scrollSettings.isResponsive&&(f==="tabClick"||f==="toggleBtn")&&(o=this.XLRibbon._ribbonState?2:1),l=this.model.allowFormulaBar?this._formulaHeight:0,t.isNullOrUndefined(u)&&(u=n("#"+this._id+"_Ribbon").height()),this.model.sheets[i].showHeader&&(a=22,v=s.width()),c=r.height-(u+l),this.getGroupPanel().height(c),this.getMainPanel().height(c),r.height=r.height-(a+this.model.pageSettings.pagerHeight+l+u),e.find("#hscrollBar").length>0&&(e.find("#hscrollBar").remove(),s.removeClass("e-scrollrowcss"),this._getJSSheetRowHeaderContent(i).height(r.height),e.find(".e-content").height(r.height-o)),e.find("#vscrollBar").length>0&&(e.find("#vscrollBar").remove(),s.removeClass("e-scrollcss"),e.find(".e-content").width(r.width-o)),e.height(r.height-o),s.height(r.height-o),this._getJSSheetContent(i).width(r.width),n(this.getFooter()).width(r.width),h=this.element.find(".e-spreadsheetfooter"),h.length?this._alignFormulaBar(h.width()):this._alignFormulaBar(this.element.find(".e-spreadsheetheader").width()),r.width=r.width-v,r},_setSheetWidthHeight:function(t,i,r,u,f){var p=n(document),e,o,s,h,c=this._getContent(t),l,v=this._getJSSheetRowHeader(t),a,w=this.model.scrollSettings.isResponsive,y;w?(e=i.height=this._isPerHt?this.element.parent().height():i.height,o=i.width=this._isPerWt?this.getMainPanel().width():i.width,u==="refresh"&&(y=this.getBrowserDetails(),y.browser.indexOf("msie")>-1&&(p=this.model.showRibbon?n(document):n("body"))),a=this._refreshWidthHeight(t,n.extend(!0,{},i),r,f),f="repeat",i.height=h=this._isPerHt?this.element.parent().height():i.height,i.width=s=this._isPerWt?this.getMainPanel().width():i.width,(o!=s||e!=h)&&(i=this._refreshWidthHeight(t,i,r,f)),o===s&&(i.width=a.width),e===h&&(i.height=a.height)):i=this._refreshWidthHeight(t,n.extend(!0,{},i),r,f);this.model.scrollSettings.allowScrolling&&this._renderScroller(t,i);c.find("#vscrollBar").length>0&&this._getJSSheetHeader(t).addClass("e-scrollcss");c.find("#hscrollBar").length>0&&(l=c.height(),v.height(l-18),this._getJSSheetRowHeaderContent(t).height(l-18),v.addClass("e-scrollrowcss"))},setWidthToColumns:function(n){for(var r,u,f=0,i=this.getActiveSheetIndex(),e=this.getSheet(i),t=0,o=n.length;t<o;t++)r=this._getContent(i).find("col")[n[t].cellIndex],u=this._getJSSheetHeader(i).find("col")[n[t].cellIndex],n[t].width===0&&(n[t].width=60),u.style.width=n[t].width+"px",r.style.width=n[t].width+"px",f+=n[t].width,e.columnsWidthCollection[n[t].cellIndex]=n[t].width,e.columns[n[t].cellIndex].width=n[t].width;this.model.sheets[i].staticWidth=f;this.model.scrollSettings.allowScrolling&&(this.XLScroll._getColWidths(i,1),this.XLScroll._refreshScroller(i,"refresh","horizontal"));this.model.sheets[i]._importRendered||(this.XLSelection._refreshBorder(),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())},_calculateRowAndColumnCount:function(t){var e=0,h=!1,c=!1,r,l=this.model.columnCount*this.model.columnWidth,a=this.model.rowCount*this.model.rowHeight,i=this.getSheet(t),o=this.element.find(".e-spreadsheetpanel").width()+2,s=this.element.parent().height(),u=0,f=0;this.model.showRibbon&&(u=n("#"+this._id+"_Ribbon").height());this.model.allowFormulaBar&&(f=this._formulaHeight);this.getActivationPanel().is(":visible")&&(e=this.getActivationPanel().width());o-e>l&&(r=(o-l)/this.model.columnWidth,this.model.columnCount+=Math.ceil(r)+5,h=!0);s-(u+f)>a&&(r=(s-(u+f)-a)/this.model.rowHeight,this.model.rowCount+=Math.ceil(r)+5,c=!0);h&&(this.model.columnCount>i.colCount?i.colCount=this.model.columnCount:this.model.columnCount=i.colCount);c&&(this.model.rowCount>i.rowCount?i.rowCount=this.model.rowCount:this.model.rowCount=i.rowCount);i._defRowCount=parseInt((s-(u+f))/this.model.rowHeight)+10;i._defColCount=parseInt((o-e)/this.model.columnWidth)+10},_addTemplate:function(i){var l={},a=t.buildTag("tbody"),o,v=t.buildTag("colgroup"),s,u,f=this.getSheet(i),e=f.columns,h,w=this.getBrowserDetails().browser==="firefox"?this.model.rowHeight+1:this.model.rowHeight,r,y,c,p;for(o=t.buildTag("tr","",{height:w+"px"}),r=0,y=f.colCount;r<y;r++)s=document.createElement("col"),s.style.width=f.columnWidth+"px",u=t.buildTag("td.e-rowcell"),e&&e[r]&&(e[r].template?(c={},c["_"+this._id+"ColumnTemplating"]=this._spreadsheetTemplate,n.views.helpers(c),p=this._createTemplateElement(i,e[r]),u.addClass("e-templatecell").html("{{:~_"+this._id+"ColumnTemplating('"+p.id+"')}}")):(h="{{:#data['"+f.columns[r].field+"']}}",u.attr("data-value",h),u.html(h))),o.append(u),v.append(s);a.get(0).appendChild(o.get(0));l[this._id+"JSONTemplate"+i]=a.html();n.templates(l);this._sheets[i]._contentColGroup=v.get(0)},_addInitTemplate:function(){for(var t,n=1;n<=this.model.sheetCount;)t=this.getSheet(n),t.dataSource&&this._initColumns(n,t.dataSource[0]),n++},_renderData:function(t){var i=[],r;if(this.getSheet(t).dataSource)i=this.getSheet(t).dataSource;else for(r=0;r<this.getSheet(t).rowCount;r++)i.push({});return this.getSheet(t).dataSource=i,n.render[this._id+"JSONTemplate"+t](i)},_renderContent:function(i){var r=t.buildTag("div.e-spreadsheetcontent"),u,a=t.buildTag("div.e-spreadsheetrowheader","",{float:"left",width:"30px"},{}),v=t.buildTag("div.e-spreadsheetcontentcontainer"),f,e,o,s,y,p,h,c,l;for(this._setJSSheetContent(r,i),r.append(a),r.append(v),f=n(document.createElement("colgroup")),o="",e=document.createElement("col"),e.style.width="30px",f.append(e),s=this.getSheet(i).rowCount,y=this.getSheet(i).colCount,p=this.getSheet(i).columnWidth,this.getSheet(i).dataSource&&!this.importSheet&&(this.getSheet(i).rowCount=this.getSheet(i).dataSource.length),u=0;u<s;u++)h=this._renderTD("e-rowheader","",u+1),o+=this._renderTR(h,u,i);c=r.find(".e-spreadsheetcontentcontainer").get(0);l=r.find(".e-spreadsheetrowheader").get(0);l.innerHTML=["<div class='e-rowheadercontent'><table class='e-table'>"+f.get(0).outerHTML,"<tbody>",o,"<\/tbody><\/table><\/div>"].join("");c.innerHTML=this._sheetCopy.isSheetCopy?["<div class='e-content e-ss-cursor'>"+this._sheetCopy.sheetContent.outerHTML+"<\/div>"].join(""):["<div class='e-content e-ss-cursor'><table class='e-table'>"+this._sheets[i]._contentColGroup.outerHTML,"<tbody>",this._renderData(i),"<\/tbody>","<\/table><\/div>"].join("");this._setContent(r.find(".e-spreadsheetcontentcontainer"),i);this._setJSSheetRowHeader(r.find(".e-spreadsheetrowheader"),i);this._setJSSheetRowHeaderContent(r.find(".e-rowheadercontent"),i);var w=this._getContent(i).find(".e-table").get(0).rows,b=this._getJSSheetRowHeader(i).find(".e-table").get(0).rows,k=[b,w];return this.setRows(k,i),r},_renderTD:function(n,t,i){return String.format("<td class='{0}' style='{1}' >{2}<\/td>",n,t,i)},_renderDIV:function(n,t,i){return i?String.format("<div class='{0}' title='{2}'>{1}<\/div>",n,t,i):String.format("<div class='{0}'>{1}<\/div>",n,t)},_renderTR:function(n,t,i){var r=this.getSheet(i),u=this._sheetCopy.isSheetCopy?this.getSheet(i).rowsHeightCollection[t]:this.getBrowserDetails().browser==="firefox"?this.model.rowHeight+1:this.model.rowHeight,f="height:"+u+"px;";return this._sheetCopy.isSheetCopy||(r.rowsHeightCollection.push(u),r._rowHeightCollection.push({idx:t+1,value:r._rowHeightCollection[r._rowHeightCollection.length-1].value+u})),String.format("<tr style='{0}'>"+n+"<\/tr>",f)},_renderFooter:function(){var i=t.buildTag("div.e-spreadsheetfooter"),u=t.buildTag("table.e-table","",{},{}),f=n(document.createElement("tbody")),e=n(document.createElement("tr")),r=n(document.createElement("td"));r.append(this._renderSpreadSheetPager());r.find(".e-pagercontainer").append(t.buildTag("div.e-new e-icon e-default","",null,{title:this._getLocStr("NewSheet")}));e.append(r);f.append(e);u.append(f);i.append(u);this.getMainPanel().append(i);i.width(this.model.scrollSettings.width);i.height(this.model.pageSettings.pagerHeight);this.setFooter(i);this._refreshSpreadSheetPager()},gotoPage:function(t,i){var u,r=this.model.sheets,s=this.getPager(),e="option",o="checked",f={reqType:"gotoSheet",gotoIndex:t,newSheet:i};this._trigActionBegin(f)||!i&&t>this.model.sheetCount||t<1||(this.setActiveSheetIndex(t),this.element.find(".e-sheet").hide(),i&&this._addSheet(t),this._isSheetInsert&&(u=s.ejPager("option","currentPage"),this._swapSheetDtCntr(r.length-1,u),this.model.activeSheetIndex=t=u,this._isSheetInsert=!1),this.element.find("#"+this._id+"_"+this.model.sheets[t]._sheetName.value).show(),r[t]._importRendered||this.model.enableContextMenu&&this.XLCMenu.hideCMenu(),this._refreshSpreadSheetPager(),r[t]._importRendered&&(this.showWaitingPopUp(),this._updateImportedSheets(t),this.XLScroll._refreshScroller(t,"refresh","all"),(r[t]._frozenRows||r[t]._frozenColumns)&&this._setFreezePane(r[t]._frozenRows,r[t]._frozenColumns),this.hideWaitingPopUp()),this._initializeSelection(),this.getSheetElement(t).find(".e-ss-activeimg").length&&this.XLSelection._cleanUp(!0),r[t]._importRendered=!1,this.model.showRibbon&&(this._updateRibbonTab(this.getActiveCellElem(t)[0]),!this.importSheet&&this.model.allowComments&&this.XLComment._updateCmntRibIcons(),n("#"+this._id+"_Ribbon_Vheading").ejCheckBox(e,o,r[t].showHeader),n("#"+this._id+"_Ribbon_Vgridlines").ejCheckBox(e,o,r[t].showGridlines)),f={activeSheet:this.getActiveSheetIndex(),reqType:"gotoSheet"},this._trigActionComplete(f))},insertSheet:function(){if(this.model.allowInsert){var n=this.getPager(),t=n.ejPager("option","totalRecordsCount")+1;n.ejPager("option",{totalRecordsCount:t});this._isSheetInsert=!0;this.gotoPage(t,!0);this.setSheetFocus()}},_renameSheet:function(){var i=n(".e-currentitem"),r=t.buildTag("input#"+this._id+"_Sheet_RenamePanel","",{width:i.width()+5+"px",padding:0},{type:"input",value:i.text(),maxlength:"31"});i.hide()&&r.insertAfter(i).select().focus()&&(this._isSheetRename=!0);this.model.showRibbon&&this.XLRibbon._disableRibbonIcons()},deleteSheet:function(n){var t=this.getActiveSheetIndex(),i=this._getSheetNames(!0).length;if(n=n||t,i>1)n!==t&&this.gotoPage(n,!1),this.getObjectLength(this._dataContainer.sheets[n])?this._showAlertDlg("","SheetDeleteAlert","sheetDeleteActn",470):this._removeSheet(n);else{this._showAlertDlg("Alert","SheetDeleteErrorAlert","",430);return}},hideSheet:function(t){var u=this.getActiveSheetIndex(),i=n.isNumeric(t)?t:this._getSheetIndexByName(t)||u,r=this._getSheetNames(!0),f=this._getSheetNames();r.length>1?(f[i-1].isVisible=!1,this.gotoPage(this._getNxtVisibleSheet(i,null,r))):this._showAlertDlg("Alert","SheetDeleteErrorAlert","",377)},unhideSheet:function(t){var r=this._getSheetNames(),i=n.isNumeric(t)?t:this._getSheetIndexByName(t);r[i-1].isVisible||(r[i-1].isVisible=!0,this.gotoPage(i))},_getNxtVisibleSheet:function(n,t,i){var r=this._getSheetNames(),u=r.length,f="<=",e=1,o=this._getSheetNames(!0),s=r[n-1].value===(i&&i[i.length-1].value||o[o.length-1].value);for((t||s)&&(u=0,f=">=",e=-1);this.operators[f](n,u);){if(r[n-1].isVisible)return n;n=n+e}},_renderSpreadSheetPager:function(){var t=n(document.createElement("div")),i={};return this.model.pageSettings.click=this._spreadSheetPagerClickHandler,this.model.pageSettings.totalRecordsCount=this.model.sheetCount,this.model.pageSettings.locale=this.model.locale,n.extend(i,this.model.pageSettings),i.currentPage=this.model.activeSheetIndex,i.masterObject=this,i.pageSize=1,this.setPager(t),t.ejPager(i),t.ejPager("refreshPager"),inst=t.ejPager("instance"),inst._$first[0].title=this._getLocStr("Firstsheet"),inst._$last[0].title=this._getLocStr("Lastsheet"),inst._$next[0].title=this._getLocStr("Nextsheet"),inst._$prev[0].title=this._getLocStr("Prevsheet"),t.find(".e-parentmsgbar").remove(),t.find("a.e-PP").appendTo(t.find(".e-pagercontainer")),t.find("#NumericContainer").appendTo(t.find(".e-pagercontainer")),t.find("a.e-NP").appendTo(t.find(".e-pagercontainer")),t},_getPageCount:function(){var i=this.getPager(),f=0,c=i.width()-(i.find(".e-pagercontainer").width()-i.find("#NumericContainer").width()),e=i.find(".e-currentitem"),l=i.find(".e-link.e-numericitem:visible").not(".e-PP, .e-NP"),o=this._getSheetNames(),u=n(l[0]).data("index"),a=t.buildTag("canvas"),s=a[0].getContext("2d"),r,h;for(s.font=e.css("font-size")+" "+e.css("font-family"),r=0,h=this.model.pageSettings.pageCount;r<h;r++)if(!this.isUndefined(o[u-1])){if(f+=s.measureText(o[u-1].text).width+25,c<=f)return r;u++}return r},_spreadSheetPagerClickHandler:function(i){var o,e,s=!1,r=this.model.masterObject,f,u=n(i.event.target);if(!(r.model.allowComments&&r.XLComment._isCommentEdit||r.XLEdit._isEdit)||!(i.event&&(u.hasClass("e-pager")||u.hasClass("e-new"))||r.element.find(".e-field-validation-error").length))return(r.model.allowComments&&r.XLComment._isCommentEdit&&r.XLComment._updateCurCmntVal(),r.XLEdit._isEdit&&r.XLEdit.saveCell(),!t.isNullOrUndefined(i.event)&&(u.hasClass("e-prevpage")||u.hasClass("e-nextpage")||u.hasClass("e-firstpage")||u.hasClass("e-lastpage"))&&(i.currentPage=r._getNxtVisibleSheet(i.currentPage,u.hasClass("e-prevpage")||u.hasClass("e-lastpage"))),f={activeSheet:r.getActiveSheetIndex(),gotoSheet:i.currentPage,newSheet:i.event&&u.hasClass("e-new")},f.newSheet?(o=r.getPager(),e=o.ejPager("option","totalRecordsCount")+1,f.gotoSheet=e):f.gotoSheet=i.currentPage,i.currentPage=f.gotoSheet,!t.isNullOrUndefined(i.event)&&i.event.target.id.indexOf("_Sheet_RenamePanel")>-1||r._isSheetRename&&!r._updateSheetNames(null,!1)||this._prevPageNo===i.currentPage)?void 0:(f.newSheet&&(o.ejPager("option",{totalRecordsCount:e,currentPage:e}),i.currentPage=e,s=!0),r.model.allowFiltering&&r._filterClose(),r.gotoPage(i.currentPage,s),r._trigger("pagerClick",f))?void 0:(r.model.scrollSettings.isResponsive&&r._refreshSheetonResize(),n(i.event.target).hasClass("e-pager")||r._completeAction({reqType:"paging",sheetIndex:f.activeSheet,nSheetIndex:i.currentPage}),!1)},_pagerdblClickHandler:function(){this.XLEdit&&this.XLEdit._isEdit&&this.getActiveCellElem().find(".e-error").length||this._isSheetRename||this._renameSheet()},_initColumns:function(n,i){for(var u,f,r,o,e;i.length>0;)i=i.items[0];if(this.getSheet(n).columns.length===0&&i)for(u in i)i.hasOwnProperty(u)&&(typeof i[u]!="object"||i[u]instanceof Date)&&(f=i[u],this.getSheet(n).columns.push({field:u,type:f!=null?f.getDay?"date":typeof f:null}));else for(r=0,o=this.getSheet(n).columns.length;r<o;r++)t.isNullOrUndefined(this.getSheet(n).columns[r].type)&&(e=t.isNullOrUndefined(this.getSheet(n).columns[r].field)?null:t.getObject(this.getSheet(n).columns[r].field,i),this.getSheet(n).columns[r].type=e!=null?e.getDay?"date":typeof e:null);this.getSheet(n).colCount=this.getSheet(n).columns.length},_spreadsheetTemplate:function(t){return n("#"+t).render(this.data)},_createTemplateElement:function(t,i){var r=document.createElement("script");return r.id=(this._id+t+i.field+n.inArray(i,this.getSheet(t).columns)+"_Template").split(" ").join(""),r.type="text/x-jsrender",r.text=i.templateContent?i.templateContent:n(i.templateID).html(),n("body").append(r),n(i.templateID).hide(),r},_refreshSpreadSheetPager:function(){var t=this.getPager(),n={};this.getPager()==null||this.importSheet?(n.currentPage=this.getActiveSheetIndex(),n.totalRecordsCount=this.model.sheetCount):n.currentPage=this.getActiveSheetIndex();n.pageCount=this._getPageCount();t.ejPager("option",n).ejPager("refreshPager");this._updatePageContainer(t,n.currentPage)},_updatePageContainer:function(t,i){for(var f=t.data("ejPager"),u=t.find(".e-link.e-numericitem:visible").not(".e-PP, .e-NP"),e=this.model.sheets,o,s,r=0,h=u.length;r<h;r++)n(u[r]).text(e[n(u[r]).data("index")]._sheetName.text),e[n(u[r]).data("index")]._sheetName.isVisible?s=n(u[r]).data("index"):n(u[r]).hide(),!o&&e[n(u[r]).data("index")]._sheetName.isVisible&&(o=n(u[r]).data("index"));f._$prev.removeClass("e-prevpagedisabled e-disable").addClass("e-prevpage e-default");o===i&&(f._$first.addClass("e-firstpagedisabled e-disable").removeClass("e-firstpage e-default"),f._$prev.addClass("e-prevpagedisabled e-disable").removeClass("e-prevpage e-default"));s===i&&(f._$last.addClass("e-lastpagedisabled e-disable").removeClass("e-lastpage e-default"),f._$next.addClass("e-nextpagedisabled e-disable").removeClass("e-nextpage e-default"))},_updateSheetNames:function(i,r){var c=this.getPager(),u,s,f=c.find(".e-currentitem"),e=this.model.sheets,o=n("#"+this._id+"_Sheet_RenamePanel"),h=!0;if(t.isNullOrUndefined(i)&&(i=o.val().trim()),r){o.remove()&&f.show();this.model.showRibbon&&this.XLRibbon._enableRibbonIcons();this._isSheetRename=!1;return}if(i.match(new RegExp(".*[\\[\\]\\*\\\\/\\^].*"))&&(i=!1),!i)return this._showAlertDlg("Alert","SheetRenameEmptyAlert","sheetRenameActn",500),!1;for(u=1,s=e.length;u<s;u++)f.text()!==e[u]._sheetName.text&&i===e[u]._sheetName.text&&(h=!1);return h?((e[f.data("index")]._sheetName.text=i)&&o.remove()&&f.show()&&(this._isSheetRename=!1),this._refreshSpreadSheetPager(),this.model.showRibbon&&this.XLRibbon._enableRibbonIcons(),!0):(this._showAlertDlg("Alert","SheetRenameAlert","sheetRenameActn",325),!1)},_getSheetIndexByName:function(n){for(var i=this._getSheetNames(),t=0,r=i.length;t<r;t++)if(i[t].text===n)return t+1;return!1},_removeSheet:function(n){var i=this.model.sheetCount,u=this._dataContainer.sheets,t,r;if(i>1){for(this._getAutoFillOptElem().appendTo(this.element),this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value).remove(),this.setActiveSheetIndex(i===this.getActiveSheetIndex()?n-1:n),this._swapSheetDtCntr(n,i),(i in u)&&delete u[i],this._sheets.splice(i,1),this.model.sheets.splice(i,1),i=--this.model.sheetCount,this.getPager().ejPager("option",{totalRecordsCount:i,pageCount:i}),this.gotoPage(this.getActiveSheetIndex(),!1),this._getAutoFillOptElem().appendTo(this._getContent(this.getActiveSheetIndex()).find(".e-content")),this._rebindScrollEvnt(),t=0,r=this._undoCollection.length;t<r;t++)this._undoCollection[t]&&this._undoCollection[t].sheetIndex==n&&this._undoCollection.splice(t,1);for(t=0,r=this._redoCollection.length;t<r;t++)this._redoCollection[t]&&this._redoCollection[t].sheetIndex==n&&this._redoCollection.splice(t,1)}},_rebindScrollEvnt:function(){for(var n=1;n<=this.model.sheetCount;n++)this._getContent(n).find(".e-content").off("scroll"),this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value).find(".e-headercontent").off("scroll"),this._refreshScrollerEvent(n)},_getSheetNames:function(n){for(var r=[],i=this.model.sheets,t=1,u=i.length;t<u;t++)(this.isUndefined(n)||(!n||i[t]._sheetName.isVisible)&&(n||!i[t]._sheetName.isVisible))&&r.push(i[t]._sheetName);return r},_initMoveCopyDlg:function(){var n=this._id+"_moveCopyDlg",i,r,f,e,o,s,u,h,c;i=t.buildTag("div#"+n,"",{display:"none"});r=t.buildTag("div#"+n+"_sheetContent.e-dlgctndiv e-dlg-fields",t.buildTag("label.e-dlg-fields",this._getLocStr("Beforesheet")));h=t.buildTag("div.e-dlg-fields");s=t.buildTag("ul#"+n+"_list");r.append(h.append(s));u=t.buildTag("input#"+n+"_createcopy");r.append(u);u.ejCheckBox({cssClass:"e-dlg-fields"});u.parent().append(t.buildTag("label",this._getLocStr("CreateaCopy"),{"margin-left":6}));i.append(r);o=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");c=t.buildTag("div.e-dlg-btnctnr");f=t.buildTag("input#"+n+"_okbtn");e=t.buildTag("input#"+n+"_cnlbtn");f.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._moveCopyBtnClick,this,"ok")});e.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._moveCopyBtnClick,this,"cancel"),showRoundedCorner:!0,width:"25%"});o.append(c.append(f,e));i.append(o);this.element.append(i);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("MoveorCopy"),width:280,height:"auto",cssClass:"e-ss-dialog"});s.ejListBox({dataSource:this._getSheetNames(),height:"197px",width:"250px",fields:{text:"text",value:"value"}})},_renderMoveCopyDlg:function(){var r=n("#"+this._id+"_moveCopyDlg"),t=n("#"+this._id+"_moveCopyDlg_list").data("ejListBox"),i=this._getSheetNames();i.push({text:this._getLocStr("MoveToEnd"),value:this._getLocStr("MoveToEnd")});r.ejDialog("open");t.model.dataSource=i;t.option("fields",{dataSource:i});t.unSelectAll();t.selectItemByIndex(0)},_initUnhideDlg:function(){var n=this._id+"_UnhideDlg",i,r,u,f,e,o,s;i=t.buildTag("div#"+n,"",{display:"none"});r=t.buildTag("div#"+n+"_sheetContent.e-dlgctndiv e-dlg-fields",t.buildTag("label.e-dlg-fields",this._getLocStr("UnhideDlgText")));o=t.buildTag("ul#"+n+"_list");r.append(o);i.append(r);e=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");s=t.buildTag("div.e-dlg-btnctnr");u=t.buildTag("input#"+n+"_okbtn");f=t.buildTag("input#"+n+"_cnlbtn");u.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._unhideBtnClick,this,"ok")});f.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._unhideBtnClick,this,"cancel"),showRoundedCorner:!0,width:"25%"});e.append(s.append(u,f));i.append(e);this.element.append(i);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("UnhideSheet"),width:280,height:"auto",cssClass:"e-ss-dialog"});o.ejListBox({dataSource:this._getSheetNames(),height:"197px",width:"250px",fields:{text:"text",value:"value"}})},_renderUnhideDlg:function(){var r=n("#"+this._id+"_UnhideDlg"),t=n("#"+this._id+"_UnhideDlg_list").data("ejListBox"),i=this._getSheetNames(!1);i.length>0&&(r.ejDialog("open"),t.model.dataSource=i,t.option("fields",{dataSource:i}),t.unselectAll(),t.selectItemByIndex(0))},_moveCopyBtnClick:function(i){switch(i){case"ok":var r,u,v,f,y=!1,s=2,o,e=n(this.element).find(".e-currentitem"),p=n("#"+this._id+"_moveCopyDlg_list").data("ejListBox"),h=n("#"+this._id+"_moveCopyDlg_createcopy").data("ejCheckBox"),a=p.getSelectedItems()[0].text,c=p.getIndexByText(a),l=this.model.sheets;if(!h.isChecked()&&a===e.text()){n("#"+this._id+"_moveCopyDlg").ejDialog("close");this.setSheetFocus();return}for(u=1;u<l.length;u++)a===l[u]._sheetName.text&&(r=u),e.text()===l[u]._sheetName.text&&(o=u);if(h.isChecked()){for(e.text().match(".*[ ]+[(]+[0-9]+[)]$")===null?f=e.text()+" ("+s+")":e.text().lastIndexOf(" ")!==-1&&(s=parseInt(e.text().substring(e.text().lastIndexOf("(")+1,e.text().lastIndexOf(")"))),f=e.text().substring(0,e.text().lastIndexOf(" "))+" ("+s+")");!y;){for(f=f.substring(0,f.lastIndexOf(" "))+" ("+s+")",u=1,v=l.length;u<v;u++)f===l[u]._sheetName.text&&s++;s===parseInt(f.substring(f.lastIndexOf("(")+1,f.lastIndexOf(")")))&&(y=!0)}this._copySheetProcess(o,f);o=this.model.sheetCount;t.isNullOrUndefined(r)&&(r=o)}else!t.isNullOrUndefined(r)&&r>o&&(r=r-1);if(t.isNullOrUndefined(r)&&(r=c),!h.isChecked()&&r===o){n("#"+this._id+"_moveCopyDlg").ejDialog("close");this.setSheetFocus();break}this._swapSheetDtCntr(o,r);n("#"+this._id+"_moveCopyDlg").ejDialog("close");r<=o&&(c=c+1);this.getPager().ejPager("option",{currentPage:c});this.gotoPage(c,!1);this._rebindScrollEvnt();h._unChecked();h._isChecked=!1;this.setSheetFocus();break;case"cancel":n("#"+this._id+"_moveCopyDlg").ejDialog("close")}},_unhideBtnClick:function(t){if(t==="ok"){var i=n("#"+this._id+"_UnhideDlg_list").data("ejListBox");this.unhideSheet(i.getSelectedItems()[0].text)}n("#"+this._id+"_UnhideDlg").ejDialog("close")},_swapSheetDtCntr:function(n,t){var h=this._dataContainer.sheets,u=this.model.sheets,c=this._sheets,f=this._getLocStr("Sheet"),l=[{}],e,i,o,a=[],v=[],y=this._getSheetNames(),s,r,p;for(s in h)h.hasOwnProperty(s)&&(l[parseInt(u[s]._sheetName.value.replace(f,""))]=h[s]);for(u.splice(t,0,u.splice(n,1)[0]),c.splice(t,0,c.splice(n,1)[0]),r=1,p=u.length;r<p;r++){for(e=parseInt(u[r]._sheetName.value.replace(f,"")),this._dataContainer.sheets[r]=l[e],i=0,o=this._undoCollection.length;i<o;i++)a.indexOf(i)===-1&&parseInt(y[this._undoCollection[i].sheetIndex-1].value.replace(f,""))===e&&(this._undoCollection[i].sheetIndex=r,a.push(i));for(i=0,o=this._redoCollection.length;i<o;i++)v.indexOf(i)===-1&&parseInt(y[this._redoCollection[i].sheetIndex-1].value.replace(f,""))===e&&(this._redoCollection[i].sheetIndex=r,v.push(i))}},_copySheetProcess:function(t,i){var s=this.getPager(),h=s.ejPager("option","totalRecordsCount")+1,u=this.model.sheets,r,e,o,f,c;for(s.ejPager("option",{totalRecordsCount:h,currentPage:h}),u.push(jQuery.extend(!0,{},u[t])),this._sheetCopy={isSheetCopy:!0,sheetContent:this._getContent(t).find(".e-table").clone(!0).get(0)},r=this.model.sheetCount+1,u[r]._sheetName.text=i,u[r]._sheetName.value=this._getLocStr("Sheet")+this._newSIndex,this._newSIndex++,this.setActiveSheetIndex(r),this._dataContainer.sheets[r]=n.extend(!0,{},this._dataContainer.sheets[t]),this._sheets[r]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null,_calcEngine:null},this._createSheets(r),this.model.sheetCount++,this._sheetCopy={isSheetCopy:!1,sheetContent:null},e=this._getContent(r).find(".e-commentcell"),f=0,c=e.length;f<c;f++)o=n(e[f]),o.removeClass("e-commentcell")&&this.XLComment.setComment(o,null,!1);this.model.allowSelection&&this.XLSelection.selectRange(u[r]._startCell,u[r]._endCell)},_init:function(){if(t.support.stableSort=!1,this.element.attr("tabIndex",0),this.element.ejWaitingPopup(),this._renderPanel(),this._initialLoad=!0,this.model.allowImport&&this.model.importSettings.importUrl.length>0){var n=new FormData;n.append("Url",this.model.importSettings.importUrl);n.append("Password",this.model.importSettings.password);this["import"](n)}else this.model.sheets.splice(0,0,{}),this._renderSheets();this._initialLoad=!1;this._trigger("loadComplete",{model:this.model})},_renderPanel:function(){var i,n,r=this.model.scrollSettings;i=t.buildTag("div.e-spreadsheetpanel","",{height:r.height,width:r.width},{id:this._id+"GroupPanel"});this.setGroupPanel(i);n=t.buildTag("div.e-spreadsheetpanel","",{height:r.height,width:r.width},{id:this._id+"MainPanel"});i.append(n);this.setMainPanel(n);n=t.buildTag("div.e-spreadsheetactpanel","",{height:r.height,width:this.model.apWidth,display:"none"},{id:this._id+"ActivationPanel"});i.append(n);this.element.append(i);this.setActivationPanel(n)},showActivationPanel:function(n){var u,r=this.getActiveSheetIndex(),t=this.getActivationPanel(),i=this.model.scrollSettings;if(this.isUndefined(n))t.is(":visible")&&(t.hide(),this._setSheetWidthHeight(r,{width:i.width,height:i.height},null,"resize"),this.getMainPanel().width(this.getMainPanel().width()+this.model.apWidth));else if(u=this.getSheet(r).rangeSettings[n],u.showPanel){if(this._trigger("beforePanelOpen",{activationPanel:t,range:u,sheetIndex:r}))return;this._setSheetWidthHeight(r,{width:i.width-this.model.apWidth,height:i.height},null,"resize");t.width(this.model.apWidth).height(this.getMainPanel().height());this.getMainPanel().width(i.width-this.model.apWidth);t.show()}},_renderSheets:function(){var r=1,i=this.model,u=i.scrollSettings;for(this.element.width(i.scrollSettings.width),this.element.height(i.scrollSettings.height),this._initPrivateProperties(),this._updateFormulaCollection(),this._updateCellType(),this._isPerHt=i.scrollSettings.height.toString().indexOf("%")>-1,this._isPerWt=i.scrollSettings.width.toString().indexOf("%")>-1,this.model.allowDragAndDrop&&(this.XLDragDrap=new t.spreadsheetFeatures.dragAndDrop(this)),this.model.allowKeyboardNavigation&&(this.XLCellNav=new t.spreadsheetFeatures.cellNavigation(this)),this.model.allowFiltering&&(this.XLFilter=new t.spreadsheetFeatures.filter(this)),this.model.allowAutoFill&&(this.XLDragFill=new t.spreadsheetFeatures.dragFill(this)),(this.model.allowCellFormatting||this.model.allowFormatAsTable||this.model.allowFormatPainter)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(this)),this.XLRibbon=new t.spreadsheetFeatures.ribbon(this),this.model.allowConditionalFormats&&(this.XLCFormat=new t.spreadsheetFeatures.cFormat(this)),this.XLClipboard=new t.spreadsheetFeatures.clipboard(this),this.XLEdit=new t.spreadsheetFeatures.editing(this),this.model.allowSearching&&(this.XLFndRp=new t.spreadsheetFeatures.findnreplace(this)),this.model.allowCharts&&(this.XLChart=new t.spreadsheetFeatures.chart(this)),this.model.exportSettings.allowExporting&&(this.XLExport=new t.spreadsheetFeatures.exporting(this)),this.model.scrollSettings.allowScrolling&&(this.XLScroll=new t.spreadsheetFeatures.scroller(this)),this.XLPrint=new t.spreadsheetFeatures.print(this),this.model.allowSorting&&(this.XLSort=new t.spreadsheetFeatures.sorting(this)),this.model.allowFreezing&&(this.XLFreeze=new t.spreadsheetFeatures.freezepane(this)),this.model.allowComments&&(this.XLComment=new t.spreadsheetFeatures.comments(this)),this.model.allowSelection&&(this.XLSelection=new t.spreadsheetFeatures.selection(this)),(this.model.allowCharts||this.model.pictureSettings.allowPictures)&&(this.XLShape=new t.spreadsheetFeatures.shape(this)),this.model.allowResizing&&(this.XLResize=new t.spreadsheetFeatures.resizing(this)),this.model.enableContextMenu&&(this.XLCMenu=new t.spreadsheetFeatures.contextmenu(this)),this.model.allowDataValidation&&(this.XLValidate=new t.spreadsheetFeatures.validation(this)),this.importSheet||(this._extendSpreadsheet(),this._addInitTemplate(),this.getMainPanel().append(this._renderDIV("e-spreadsheet-list","")),this._renderFormulaBar(),this.XLRibbon._setButtonHeights()),!this._initialLoad&&this.showFormulaBar&&n("#"+this._id+"_inputbox").data("ejAutocomplete").option("dataSource",this._formulaCollection),this._initializeStyleTag(),this._initCssRules(),this.importSheet||(i.showRibbon&&this.XLRibbon._renderRibbon(),i.pictureSettings.allowPictures&&this.XLRibbon._renderFUpload(),this._calcID=CalcEngine.createSheetFamilyID()),this._setFormulaBar(),this._hideOtherControls();r<=i.sheetCount;)this._createSheets(r),r++;if(i.allowSelection&&(this._createFocusElement(),this._initializeSelection()),this._wireEvents(),!this.importSheet)for(this._renderFooter(),this.model.allowFiltering&&(this.XLFilter._renderExcelFilter(),this.XLFilter._renderFilterDialogs()),this.XLClipboard._initCopyPaste(),i.allowDataValidation&&this.XLRibbon._initValDialog(),i.allowDataValidation&&this.XLRibbon._renderValDialog(),i.allowConditionalFormats&&this.XLRibbon._initCFDialog(),this.XLRibbon._initHLDialog(),this.XLRibbon._renderHLDialog(),i.allowSearching&&(this.XLRibbon._initFRDialog(),this.XLRibbon._renderFRDialog(),this.XLRibbon._initGoToDialog(),this.XLRibbon._renderGoToDialog()),this._initMoveCopyDlg(),this._initUnhideDlg(),this._renderInsertDeleteDialog(),this._renderAlertdlg(),this.model.allowCharts&&this.XLChart._renderChartRangeDialog(),i.enableContextMenu&&this.XLCMenu._initCMenuFooter(),r=1;r<=i.sheetCount;)i.sheets[r].rangeSettings.dataSource&&this.updateRange(r,i.sheets[r].rangeSettings),r++;this.clearUndoRedo();this.model.showRibbon&&this.XLRibbon._disableButtons(["clearfilter"],"ejButton")},_extendSpreadsheet:function(){var i=t.spreadsheetFeatures,r=t.Spreadsheet.prototype;i.math&&n.extend(r,i.math)},_createSheets:function(n){var r,h,e={},o=this.model,i=this.getSheet(n),u=o.scrollSettings,f=i._sheetName.value,s=this.element.find("#"+this._id+"_"+f);this._trigger("load",{sheetIndex:n,model:o});this.model.rowCount=i.rowCount;this.model.columnCount=i.colCount;this._calculateRowAndColumnCount(n);i.rowCount=this.model.rowCount;i.colCount=this.model.columnCount;i._rowHeightCollection=[{idx:0,value:1}];i._colWidthCollection=[{idx:0,value:1}];i.dataSource&&!this._sheetCopy.isSheetCopy&&(i._isTemplate=!0,this.importSheet||(i.rowCount=i.dataSource.length),i.columns.length*i.columnWidth<u.width&&(h=u.width/i.columns.length-1,i.columnWidth=h));this._sheetCopy.isSheetCopy||this._addTemplate(n);r=s.length===1?s:t.buildTag("div.e-sheet ","",{},{id:this._id+"_"+f});r.append(this._renderHeader(n));r.append(this._renderContent(n));s.length<1&&this.element.find(".e-spreadsheet-list").append(r);e.width=u.width;e.height=u.height;o.enableContextMenu&&this.XLCMenu._initContextMenu();this.XLEdit._processEditing();n!==this.getActiveSheetIndex()&&r.hide();this._setSheetWidthHeight(n,e,null,"refresh");this._sheets[n]._calcEngine=new CalcEngine(this,this._calcID);this._sheets[n]._calcEngine.setUseDependencies(!0);this._sheets[n]._calcEngine.setExcelLikeComputations(!0);this._sheets[n]._calcEngine.setUseDatesInCalculations(!0);this._sheets[n]._calcEngine.registerGridAsSheet(f,f,this._calcID);this._initializePicture(n)},_hideOtherControls:function(){n("#"+this._id+"_Ribbon_CElement").hide();n("#"+this._id+"_Ribbon_Paste").hide();n("#"+this._id+"_Ribbon_Border").hide();n("#"+this._id+"_Ribbon_Merge").hide();n("#"+this._id+"_CFormat").hide();n("#"+this._id+"_formatastable").hide();n("#"+this._id+"_cellstyles").hide();n("#"+this._id+"_Ribbon_SortFilter").hide();n("#"+this._id+"_Ribbon_Clear").hide();n("#"+this._id+"_Ribbon_ColumnChart").hide();n("#"+this._id+"_Ribbon_BarChart").hide();n("#"+this._id+"_Ribbon_Validation").hide();n("#"+this._id+"_Ribbon_PageSize").hide();n("#"+this._id+"_Ribbon_FPane").hide();n("#"+this._id+"_Ribbon_Ins").hide();n("#"+this._id+"_Ribbon_Del").hide();n("#"+this._id+"_Ribbon_FindRep").hide();n("#"+this._id+"_Ribbon_PastePic").hide();n("#"+this._id+"_Ribbon_PictureBorder").hide();n("#"+this._id+"_ctxtmenu").hide();n("#"+this._id+"_Ribbon_AutoSum").hide();n("#"+this._id+"_Ribbon_ResetPic").hide();n("#"+this._id+"_Ribbon_PictureBorder").hide();n("#"+this._id+"_Ribbon_StockChart").hide();n("#"+this._id+"_Ribbon_LineChart").hide();n("#"+this._id+"_Ribbon_AreaChart").hide();n("#"+this._id+"_Ribbon_PieChart").hide();n("#"+this._id+"_Ribbon_ScatterChart").hide();n("#"+this._id+"_Ribbon_color_Presets").hide();n("#"+this._id+"_Ribbon_PictureColor_Presets").hide();n("#"+this._id+"_Ribbon_BorderColor_Presets").hide();n("#"+this._id+"_Ribbon_background-color_Presets").hide()},_addSheet:function(n){this._sheetSettings(n);this._sheets[n]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null};this._dataContainer.sheets[n]={};this._createSheets(n);this._newSIndex++;this.model.sheetCount++},addNewSheet:function(){this.element.find(".e-pager .e-new").click()},_createFocusElement:function(){this.setFocusTopElem(n("<div class='e-focustop e-hide' ><\/div>"));this.setFocusRightElem(n("<div class='e-focusright e-hide' ><\/div>"));this.setFocusBottomElem(n("<div class='e-focusbottom e-hide' ><\/div>"));this.setFocusLeftElem(n("<div class='e-focusleft e-hide' ><\/div>"))},_createAutoFillElement:function(){var i,r=this._getContent(this.getActiveSheetIndex()).find(".e-content");this.model.allowAutoFill&&(i=n("<div class='e-autofill e-hide'><\/div>"),r.append(i),this.setAutoFillElem(i));this.model.autoFillSettings.showFillOptions&&(this.element.append(t.buildTag("ul.e-spreadsheet","",{width:"auto"},{id:this._id+"_ctxtmenu"})),i=n("<div class='e-splitspan e-hide' title="+this._getLocStr("AutoFillTitle")+"><button id="+this._id+"_dragfilloptionbtn><\/button><\/div>"),r.append(i),this._setAutoFillOptElem(i));this._initializeSplitButton()},_initializeSplitButton:function(){n("#"+this._id+"_dragfilloptionbtn").ejSplitButton({size:"normal",contentType:"imageonly",targetID:this._id+"_ctxtmenu",prefixIcon:"e-icon e-ss-autofill",isSeparator:!1,buttonMode:t.ButtonMode.Dropdown,imagePosition:t.ImagePosition.ImageLeft,arrowPosition:t.ArrowPosition.Right,fields:{dataSource:this._fillOptionMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},beforeOpen:n.proxy(this.model.allowAutoFill&&this.XLDragFill._autoFillClick,this),itemSelected:n.proxy(this.model.allowAutoFill&&this.XLDragFill._autoFillOptionClick,this),width:"42px",height:"24px",cssClass:"e-spreadsheet e-autofillbtn"})},_renderFormulaBar:function(){this.element.prepend("<div id="+this._id+"_formulabar class='e-formulabar' ><div id="+this._id+"_indexbox class='e-indexbox' title='"+this._getLocStr("NameBox")+"'><\/div><div class='e-inputbox' ><input id="+this._id+"_inputbox type='text' title='"+this._getLocStr("FormulaBar")+"'/><\/div><\/div>");this.XLEdit._renderAutoComplete(n("#"+this._id+"_inputbox"),"",23);this.model.allowFormulaBar||this.hideFormulaBar()},_alignFormulaBar:function(n){this.element.find(".e-formulabar").width(n);n=parseInt(n);var i,r,t;i=n/10;r=n-(i+25);t=this.element.find(".e-inputbox");t.hide();t.width(Math.floor(r));this.element.find(".e-indexbox").width(Math.floor(i));t.show()},_setFormulaBar:function(){this._setInputBox(n("#"+this._id+"_inputbox"));this._setIndexBox(n("#"+this._id+"_indexbox"))},hideFormulaBar:function(){n("#"+this._id+"_formulabar").hide()},showFormulaBar:function(){this.model.allowFormulaBar&&n("#"+this._id+"_formulabar").show();this.updateFormulaBar()},updateFormulaBar:function(){var i,r,f=this.getActiveSheetIndex(),n=this.getSheet(f)._activeCell,e,u=this._getContent(f).find(".e-ss-activeimg");r=this.getRangeData([n.rowIndex,n.colIndex,n.rowIndex,n.colIndex],!1,["value","value2"])[0];i=t.isNullOrUndefined(r.value)?"":r.value;this._isDateTime(i)&&(i=r.value2);this._getInputBox().val(i);this.getCell(n.rowIndex,n.colIndex).hasClass("e-readonly")?this._getInputBox().attr("readonly","readonly"):this._getInputBox().removeAttr("readonly");e=!t.isNullOrUndefined(u[0])&&(u[0].id.indexOf(this._id+"_picture")>-1||u[0].id.indexOf(this._id+"_chart")>-1)?u[0].id.split("_")[1]:this._getAlphaRange(f,n.rowIndex,n.colIndex,n.rowIndex,n.colIndex);this._getIndexBox().html(e)},_initializeSelection:function(){var i,r=this.model,f=this.getActiveSheetIndex(),n=this.getSheet(f),u=this._getContent(f).find(".e-content"),e=r.selectionSettings.selectionType,o=t.Spreadsheet.SelectionType,s=r.selectionSettings.activeCell;u.append(this.getFocusTopElem(),this.getFocusRightElem(),this.getFocusBottomElem(),this.getFocusLeftElem());r.allowSelection&&(s&&(i=this.getRangeIndices(s),!this.isRange(i)&&i[0]<n.rowCount&&i[1]<n.colCount&&(n._startCell=n._endCell=n._activeCell={rowIndex:i[0],colIndex:i[1]})),!n._importRendered&&n._selectedCells.length?this.XLSelection._refreshBorder():(this.XLSelection._processBoundary(),e===o.Row?this.XLSelection.selectRows(n._startCell.rowIndex,n._endCell.rowIndex):e===o.Column?this.XLSelection.selectColumns(n._startCell.colIndex,n._endCell.colIndex):this.XLSelection.selectRange(n._startCell,n._endCell)));this.getAutoFillElem()||this._createAutoFillElement();r.allowAutoFill&&(this.getAutoFillElem().appendTo(u),this.XLDragFill.positionAutoFillElement());r.autoFillSettings.showFillOptions&&r.allowAutoFill&&(this._getAutoFillOptElem().appendTo(u),this.XLDragFill.hideAutoFillOptions())},_updateRibbonTab:function(i){var r,f=n("#"+this._id+"_Ribbon").data("ejRibbon"),e,o=this.element.find(".e-ribbon .e-contextul a:visible"),u=o.length,s=f.element.find("#"+this._id+"_Ribbon_togglebutton");if(t.isNullOrUndefined(i)||(e=i.className),u)while(u--)f.hideTab(o[u].text);if(s.hasClass("e-ribbonpin")&&this._refreshSheetonResize(),r=this._getContent(this.getActiveSheetIndex()).find(".e-ss-activeimg"),r.length)r[0].id.indexOf("chart")>-1?this.XLRibbon._chartDesignTabUpdate(r):this.XLRibbon._formatTabUpdate();else if(!t.isNullOrUndefined(i)&&this._hasClass(i,"e-table"))this.XLRibbon._designTabUpdate(this._getTableID(e),i);else return},_updateCellType:function(){var n,i=t.Spreadsheet.CellType;for(n in i)this._dataContainer.cellType.push(i[n])},_initializeStyleTag:function(){if(!document.getElementById(this._id+"_sscustomformat")){var u,n,r,i=0;for(r="s:11pt/b:#FFC7CE;c:#82012A;f:calibri;s:11pt/b:#C6EED2;c:#0A7043;f:calibri;s:11pt/b:#FEEC9B;c:#826717;f:calibri;s:11pt/f:Calibri;w:bold;v:top;s:11pt/f:calibri;s:18pt/b:#DDE5F6;f:calibri;s:11pt/b:#FDE0D2;f:calibri;s:11pt/b:#EEEEEC;f:calibri;s:11pt/b:#FEF4CD;f:calibri;s:11pt/b:#9CC0E7;f:calibri;s:11pt/b:#F9AD7B;f:calibri;s:11pt/b:#C9C9C9;f:calibri;s:11pt/b:#FED965;f:calibri;s:11pt/b:#559AD9;c:#FFFFFF;f:calibri;s:11pt/b:#EB7E2F;c:#FFFFFF;f:calibri;s:11pt/b:#A5A5A5;c:#FFFFFF;f:calibri;s:11pt/b:#FDBF01;c:#FFFFFF;f:calibri;s:11pt".split("/"),u=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],n=document.createElement("style"),n.setAttribute("id",this._id+"_sscustomformat"),n.type="text/css",u.appendChild(n);i<r.length;)t.isNullOrUndefined(this.XLFormat)||this.XLFormat._createFormatClass(this._getStyleAsJSON(r[i])),i=i+1}},_getStyleAsJSON:function(n){var t,i=0,r={},u={b:"background-color",c:"color",f:"font-family",s:"font-size",w:"font-weight",v:"vetical-align",bo:"border"};for(n=n.split(";");i<n.length;)t=n[i].split(":"),r[u[t[0]]]=t[0]==="bo"?this.XLRibbon._getBorderObj(t[1].split("-")[0],t[1].split("-")[1]):t[1],i=i+1;return r},_updateFormulaCollection:function(){var n,i=(new CalcEngine).getLibraryFunctions(),t=[];for(n in i.items)t.push({text:"="+n,display:n});this._formulaCollection=t},_renderScroller:function(n,t){this.XLScroll._createScroller(n,t);this._refreshScrollerEvent(n)},_refreshScrollerEvent:function(i){this._getContent(i).find(".e-content").scroll(t.proxy(function(t){this._getJSSheetHeader(i).find(".e-headercontent").scrollLeft(n(t.currentTarget).scrollLeft());this._getJSSheetRowHeaderContent(i).scrollTop(n(t.currentTarget).scrollTop())},this));this.element.find("#"+this._id+"_"+this.model.sheets[i]._sheetName.value).find(".e-headercontent").scroll(t.proxy(function(t){var r=n(t.currentTarget);this._getContent(i).find(".e-content").first().scrollLeft(r.scrollLeft())},this))},_rClickHandler:function(){t.isNullOrUndefined(this._excelFilter)||(this.XLFilter._isSearchEdit=!1,this._excelFilter.closeXFDialog())},_cellClick:function(i){var e,r=i.target,o=this.getActiveSheetIndex(),u,s,f;if(i.target.tagName==="TD"&&n(i.target).parents("div")[0].className.indexOf("e-content")>-1){if(u=r.cellIndex,s=n.inArray(n(r).closest("tr").get(0),this.getRows(o)[1]),f=this.getSheet(o).columns[u],e={columnName:f.field,value:n(r).data("value"),columnIndex:u,rowIndex:s,columnObject:f,cell:r,eventArgs:i,event:i,target:i.target},this._trigger("cellClick",e))return}else if(!t.isNullOrUndefined(n(i.target).parents("div"))&&n(i.target).parents("div")[0].className.indexOf("e-content")>-1&&(r=n(i.target).parents("td").get(0),!t.isNullOrUndefined(r)&&(u=r.cellIndex,s=n.inArray(n(r).closest("tr").get(0),this.getRows(o)[1]),f=this.getSheet(o).columns[u],e={columnName:f.field,value:n(r).data("value"),columnIndex:u,rowIndex:s,columnObject:f,cell:r,eventArgs:i,event:i,target:i.target},this._trigger("cellClick",e))))return},_wireEvents:function(){var i=this.element,r=t.eventType,u=this._id,f,e;this._on(i,r.mouseDown,".e-ribbon, .e-spreadsheetcontentcontainer .e-vscroll, .e-spreadsheetcontentcontainer .e-hscroll",this._rClickHandler);this._on(i,r.mouseDown,".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel",this._mouseDownHandler);this._on(i,"keydown",this._keyDownHandler);this._on(i,"click",".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel, .e-ss-object",this._cellClick);this._on(i,"dblclick",".e-spreadsheetcontentcontainer,.e-spreadsheetheader,.e-spreadsheetrowheader",this._recorddblClickHandler);this._on(i,"dblclick",".e-numericcontainer .e-numericitem",this._pagerdblClickHandler);this._on(i,r.mouseMove,this._mouseMove);this._on(i,r.mouseUp,this._sheetMouseUp);this.model.allowResizing&&this._on(i,r.mouseLeave,".e-spreadsheetrowheader,.e-spreadsheetheader",this._mouseLeave);this._on(i,r.click,".e-ssfiltered, .e-ssfilter, .e-ssfiltered-asc, .e-ssfilter-asc, .e-ssfiltered-dsc, .e-ssfilter-dsc",this._filterDownHandler);this._on(i,r.mouseDown,".e-ssddl",this._ddlopen);this._on(i,"mouseover",".e-rowcell",this._cellHoverHandler);this._on(i,"mouseover",".e-viewhdrlbl, .e-vheading",this._headingchkboxHover);this._on(i,"mouseover",".e-viewlinlbl, .e-vgridlines",this._gridlineschkboxHover);this._on(i,"mouseleave",".e-viewhdrlbl, .e-vheading",this._headingchkboxLeave);this._on(i,"mouseleave",".e-viewlinlbl, .e-vgridlines",this._gridlineschkboxLeave);this._on(this._getInputBox(),"input",this.XLEdit._formulaBoxInputChange);this._on(n("#"+u+"_cellstyles"),r.click,this._cellStyleClick);this._on(n("#"+u+"_formatastable"),r.click,this._formatAsTableClick);this._on(n("#"+u+"_nmuseinformula"),r.click,".e-nmuseinformularow",this._useInFormulaClick);this.model.scrollSettings.allowScrolling&&this.element.find(".e-spreadsheet-list").bind("mousewheel DOMMouseScroll",n.proxy(this.XLScroll._spreadMouseWheel,this.XLScroll));this._on(n(".e-menu .e-chartcontent .e-chartcell"),r.click,this._chartClickHandler);this._on(n("#"+u+"_allchart").find(".e-chartimg"),r.click,this._allChartType);this.model.scrollSettings.isResponsive&&(e=this,window.onresize=function(){f&&clearTimeout(f);f=setTimeout(function(){e._spreadsheetonresize()},100)})},_headingchkboxHover:function(){this.element.find(".e-vheading .e-chk-act, .e-vheading .e-chk-inact").addClass("e-chkhover")},_gridlineschkboxHover:function(){this.element.find(".e-vgridlines .e-chk-act,.e-vgridlines .e-chk-inact").addClass("e-chkhover")},_headingchkboxLeave:function(){this.element.find(".e-vheading .e-chk-act, .e-vheading .e-chk-inact").removeClass("e-chkhover")},_gridlineschkboxLeave:function(){this.element.find(".e-vgridlines .e-chk-act,.e-vgridlines .e-chk-inact").removeClass("e-chkhover")},_allChartType:function(t){n("#"+this._id+"_allchart").find(".e-chartimg").removeClass("e-chartselect");n(t.target).addClass("e-chartselect")},_spreadsheetonresize:function(){this._refreshSheetonResize()},_refreshSheetonResize:function(){var u=this.getActiveSheetIndex(),i,o=this.getActivationPanel(),f=n(".e-menu:visible[id^="+this._id+"], .e-ddl-popup:visible[id^="+this._id+"]"),t,r,e=["CFormat","Validation","PageSize","FPane","Ins","Del","FindRep"];this.element.find(".e-inputbox").hide();i={width:this.model.scrollSettings.width,height:this.model.scrollSettings.height};i.width=o.is(":visible")?i.width-this.model.apWidth:i.width;this._setSheetWidthHeight(u,i,null,"resize");this.element.find(".e-inputbox").show();this.model.scrollSettings.allowScrolling&&this.XLScroll._scrollSelectedPosition(u,this.getActiveCell());f.length&&(t=f[0].id.split("_",3),t.indexOf("Ribbon")===-1&&t.splice(1,0,"Ribbon"),t[2]=e.indexOf(t[2])>-1?["cFormat","validationsbtn","sizesbtn","fPane","inssbtn","delsbtn","find"][e.indexOf(t[2])]:t[2].toLowerCase(),t=t.join("_"),t.length&&(r=n("#"+t),r.hasClass("e-splitbutton")&&r.ejSplitButton("hide"),r.hasClass("e-dropdownlist")&&r.ejDropDownList("hidePopup")))},_chartClickHandler:function(t){var i=n(t.target),r=n.extend(!0,{},n(t.target).data());i.parents().eq(1).hide();this.XLChart.createChart(null,r)},_useInFormulaClick:function(t){var i=this,u=i.getActiveSheetIndex(),r=i.getActiveCellElem(u)[0];i.XLEdit.editCell(r.parentNode.rowIndex,r.cellIndex,!0);n("#"+i._id+"_"+i.XLEdit._EditCellDetails.fieldName).val("="+t.target.textContent);n("#"+i._id+"_nmuseinformula").hide()},_formatAsTableClick:function(t){var u,f,i=this,e=t.target,o=i.getSheet(i.getActiveSheetIndex()),r=o._selectedCells;r.length!==0&&e.parentNode.className==="e-formatastablecell"&&(u=i.getCell(r[0].rowIndex,r[0].colIndex)[0].className,u.indexOf("e-table")>-1?(i.XLFormat._formatAsTableStyle=n(e.parentNode).data(),i.XLFormat._createTable(i._getTableID(u),i.XLFormat._formatAsTableStyle)):r.length>1?(f=n("#"+i._id+"_fatname"),n("#"+i._id+"_fatnamedlg").ejDialog("open"),n("#"+i._id+"_fatheader").attr("checked",!1),f.val("Table "+i.getObjectLength(o._tableManager)).focus().setInputPos(f.val().length),i.model.allowCellFormatting&&(i.XLFormat._formatAsTableStyle=n(e.parentNode).data())):i._showAlertDlg("Alert","FormatAsTableAlert",null,445),n("#"+i._id+"_Ribbon_formatastable").data("ejSplitButton")._hidePopup())},_getTableID:function(n,t){var i,r=this.getSheet(this.getActiveSheetIndex())._tableManager;if(t){for(i in r)if(t===r[i].name)return Number(i)}else for(i in r)if(n.indexOf("e-table"+i)>-1)return Number(i)},_cellStyleClick:function(t){var r=t.target.className,u=this.XLFormat.getFormatClass(r),i={sheetIndex:this.getActiveSheetIndex(),reqType:"cell-styles",beforeFormat:this.XLFormat.getHashCodeClassAsArray()};r.indexOf("e-cellstylecell")>-1&&(u.indexOf("e-format")>-1?this.XLFormat.updateUniqueFormat(u):this.XLFormat.clearFormat());i.afterFormat=this.XLFormat.getHashCodeClassAsArray();i.range=this.model.sheets[this.getActiveSheetIndex()].selectedRange;this.isUndoRedo||this._completeAction(i);n("#"+this._id+"_Ribbon_cellstyles").data("ejSplitButton")._hidePopup()},_cellHoverHandler:function(n){var t={target:n.target};this._trigger("cellHover",t)},_filterDownHandler:function(t){t.target.className.indexOf("e-ssfilter")>-1&&(this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")?this._excelFilter.closeXFDialog():this.XLFilter._filterClickHandler(t))},_mouseDownHandler:function(i){var h,c="e-ss-object",r=i.target,e=n(r),f=this.getActiveSheetIndex(),l=this.getSheet(f),v,y=this,p=!0,a=n("#"+this._id+"_Ribbon").data("ejRibbon"),w=!0,s,b,u,o;if((this.model.allowCharts&&l._isChartBorderDrawn&&this.XLChart._clearChartRange(this._arrayAsString(this._chartBorder)),this.getSheetElement(f).find(".e-ss-activeimg").length&&this.model.showRibbon&&a.model.selectedItemIndex===this.XLRibbon._getTabIndex("format")&&this.XLRibbon._toggleFormatTab(),(this.model.pictureSettings.allowPictures||this.model.allowCharts)&&(e.hasClass(c)||n(e).parents("."+c).length)?(e.hasClass(c)||(r=i.target=n(e).parents("."+c)[0]),this.XLShape._shapeMouseDown(i)):(w=!1,this.XLShape._shapeROStart||this.XLShape._shapeRSStart||this._getContent(f).find(".e-ss-activeimg").removeClass("e-ss-activeimg e-ss-imgcresize e-ss-imgrresize")),h=r.className,this.model.showRibbon&&r.id.indexOf("chart")>-1?this.XLRibbon._chartDesignTabUpdate(n(r)):this.model.showRibbon&&a.model.selectedItemIndex===this.XLRibbon._getTabIndex("cdesign")&&this.XLRibbon._toggleChartDesignTab(),!this.XLEdit._isEdit||!(n(this.getCell(l._activeCell.rowIndex,l._activeCell.colIndex)).index(n(r).parents("td"))>-1))&&(this.model.allowDragAndDrop&&this.XLDragDrap._isDragAndDropStart&&h!=="e-autofill"&&this.XLDragDrap._dMouseDown(i),this.model.allowResizing&&!this.XLEdit._isEdit&&(n(r).hasClass("e-headercelldiv")||n(r).hasClass("e-headercell")?this.XLResize._headerMouseDown(i):n(r).hasClass("e-rowheader")?this.XLResize._rowMouseDown(i):n(r).hasClass("e-spreadsheetactpanel")&&this.XLResize._apMouseDown(i)),!(n(r).parents("div.e-spreadsheetactpanel").length>0))){if(p=this.XLEdit._isEdit?(this._isFormulaSuggestion||!this.XLEdit._isFormulaEdit)&&this.XLEdit.saveCell():!0,!p&&!this.XLEdit._isFormulaEdit)return!1;r.tagName==="A"?(u=e.parent("td")[0],s={rowIndex:u.parentNode.rowIndex,colIndex:u.cellIndex},l._activeCell=s,this.XLSelection.selectRange(s,s),i.which!==3&&this._hlClick(this.XLEdit.getPropertyValue(s.rowIndex,s.colIndex,"hyperlink",f))):(i.button!==2||i.which!==3||this.getSheetElement(f).find(".e-selected, .e-colselected .e-headercelldiv, .e-rowselected").index(r)===-1)&&this.model.allowSelection&&!w&&(t.isNullOrUndefined(this.XLDragDrap)||!this.XLDragDrap._allowDragAndDrop)&&(this.XLResize&&this.XLResize._resizeStart||e.hasClass("e-comment-txtarea")||this.XLSelection._selectionMouseDownHandler(i));this.model.allowFiltering&&this._filterClose();this._undoInputobj={};this._setRowHdrHeight(f,this.model.sheets[f]._activeCell.rowIndex);r.tagName==="TD"&&n(r).parents("div")[0].className==="e-content"&&this.displayActivationPanel(this.XLEdit.getPropertyValueByElem(n(r),"range"));r.tagName==="TD"&&r.className.indexOf("e-rowheader")<0&&(b=n("#"+this._id+"ddl").val(),u=this._ddlCell,t.isNullOrUndefined(u)||(u.find("span#"+this._id+"ddl_wrapper").remove(),n("#"+this._id+"ddlspan").remove(),n("#"+this._id+"ddl").remove(),u.text(b),this.XLEdit.updateCell(u,u.text()),this._ddlCell=null));t.isNullOrUndefined(this.XLEdit.getPropertyValue(n(r).closest("tr").index(),n(r)[0].cellIndex,"rule",f))||this._setddlCell(i);this.model.allowComments&&!e.hasClass("e-pager")&&this.getSheetElement(f).find(".e-commentcell").length>0&&this.XLComment._commentMouseDownHandler(i);this._isSheetRename&&this._updateSheetNames(null,!1);this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup");h.indexOf("e-rowcell")>-1&&h.indexOf("e-table")>-1?(v=y._getTableID(h),y.isNumber(v)&&y.XLRibbon._designTabUpdate(v,r)):this.model.showRibbon&&(a.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||a.isVisible(this._getLocStr("Design")))&&this.XLRibbon._toggleDesignTab(r);this.model.allowEditing&&(u=this.getSheet(this.getActiveSheetIndex())._activeCell,this.XLEdit._isEdit&&i.target.id!==this._id+"_inputbox"&&(o=n(i.target).hasClass("e-ss-input")||!this.XLEdit._isFBarFocused?this.getCell(u.rowIndex,u.colIndex).find(".e-ss-input"):this._getInputBox(),o&&(i.target.id!==o[0].id&&o.focus().setInputPos(o[0].selectionStart,o[0].selectionEnd),o.hasClass("e-ss-input")&&(this.XLEdit._isFBarFocused=!1))),this.model.allowComments&&this.XLComment._isCommentEdit||this._isSheetRename||i.target.id!==this._id+"_inputbox"||(i.target.readOnly?this.setSheetFocus():(this.XLEdit._isEdit||this.XLEdit.editCell(u.rowIndex,u.colIndex,!0),this._getInputBox().focus(),this.XLEdit._isFBarFocused=!0)))}},_setddlCell:function(i){var a,p=[],w,l,o,v,s=this.getActiveSheetIndex(),b,e,u,c,f,r,y,h;if(t.isNullOrUndefined(i)||i.type!=="mousedown"?(o=this.getSheetElement(s).find(".e-activecell")[0],v=n("#"+this._id+"GroupPanel").find("div.e-content")[0]):(o=i.target,v=i.currentTarget),l=this.XLEdit.getPropertyValue(n(o).closest("tr").index(),o.cellIndex,"rule",s),l&&l.type==="list"){if(this._ddlCell=n(o),w=l.customVal.split("_"),e=w[0],f=[],e.startsWith("=")&&e.indexOf(",")<0){for(r=n.trim(e.replace("=","")),r.indexOf("!")>-1&&(y=r.split("!"),s=this._getSheetIndexByName(y[0]),r=y[1]),r.indexOf("$")>-1&&(r=r.split("$").join("")),r.indexOf(":")<0&&(r=r+":"+r),range=this.getRangeIndices(r),h=this.getRange(range[0],range[1],range[2],range[3]),u=0,c=h.length;u<c;u++)!t.isNullOrUndefined(n(h[u]))&&this.XLEdit.getPropertyValueByElem(n(h[u]),null,s)?f.push(this.XLEdit.getPropertyValueByElem(n(h[u]),null,s)):f.push("");f.length||f.push(e)}else e.indexOf(",")>-1?f=e.split(","):(f=[],f.push(e));for(u=0,c=f.length;u<c;u++)p[u]={id:u+1,text:f[u].toString()};r=this._ddlCell.text();this._ddlCell.text("");a={top:this._ddlCell[0].offsetTop,left:this._ddlCell[0].offsetLeft};b=this._ddlCell.height()-18;n(o).append('<input id="'+this._id+'ddl" type="text" style="line-height:0px;text-align:end;padding-left:0px;background-color:#ffffff;color:#333333;font-family:calibri;" value='+r+">");v.insertAdjacentHTML("beforeEnd","<span id='"+this._id+"ddlspan' class='e-icon e-ssddl e-spanddl e-ddlspan' role='button'><\/span>");n("#"+this._id+"ddlspan").css({top:a.top+b,left:a.left+this._ddlCell.width()+3});n("#"+this._id+"ddl").ejDropDownList({dataSource:p,fields:{id:"Types",text:"text",value:"text"},height:"16",width:"auto",beforePopupShown:n.proxy(this._drppopupshow,this),change:n.proxy(this._changeddl,this)});n("#"+this._id+"ddl_dropdown").remove();n("#"+this._id+"ddl_container").removeClass("e-in-wrap e-box")}},_drppopupshow:function(){n("#"+this._id+"ddl_popup").css({width:this.getActiveCellElem().width()+20,"font-size":"11px"})},_ddlPosition:function(){var t={top:this._ddlCell[0].offsetTop,left:this._ddlCell[0].offsetLeft};n("#"+this._id+"ddlspan").css({top:t.top+this._ddlCell.height()-19,left:t.left+this._ddlCell.width()+3})},_changeddl:function(t){this.XLEdit.updateCellValue(n("#"+this._id+"ddl").parents("td"),t.selectedText);this.getActiveCellElem().hasClass("e-hlcell")&&this.XLValidate.highlightInvalidData()},_ddlopen:function(i){var r=n("#"+this._id+"ddl").data("ejDropDownList");i.stopPropagation();t.isNullOrUndefined(r)||(r._isPopupShown()?r._hideResult():(r._showResult(),n("#"+this._id+"ddl_popup").css({width:this.getActiveCellElem().width()+20,"font-size":"11px"})))},_mouseMove:function(i){var r=n(i.target);!this.model.allowResizing||!(this.XLResize._resizeType==="Col"||r.hasClass("e-headercelldiv")||r.hasClass("e-headercell")||r.hasClass("e-reSizeColbg"))||this.XLEdit._isEdit||this.XLCMenu&&this.XLCMenu._isMenuOpened?!this.model.allowResizing||!(this.XLResize._resizeType==="Row"||r.hasClass("e-rowheader")||r.hasClass("e-reSizeRowbg"))||this.XLEdit._isEdit||this.XLCMenu&&this.XLCMenu._isMenuOpened?this.model.allowResizing&&(this.XLResize._resizeType==="AP"||r.hasClass("e-spreadsheetactpanel")||r.parents("e-spreadsheetactpanel").length>0)?this.XLResize._apMouseMove(i):(this.model.pictureSettings.allowPictures||this.model.allowCharts)&&(r.hasClass("e-ss-object")||r.parents(".e-ss-object").length||this.XLShape._shapeROStart||this.XLShape._shapeRSStart||r.hasClass("e-ss-imgvisual"))&&this.XLShape._imgMouseMove(i):this.XLResize._rMouseMove(i):this.XLResize._cMouseMove(i);this.model.allowDragAndDrop&&t.spreadsheetFeatures.dragAndDrop&&r.hasClass("e-rowcell")&&!this.XLEdit._isEdit&&this._getJSSheetHeader(this.getActiveSheetIndex())[0].querySelector(".e-spreadsheetcolumnheader").className.indexOf("e-sheetselected")===-1&&this.XLDragDrap._dMouseMove(i);this.model.allowComments&&!this.XLComment._isCommentEdit&&this.getSheetElement(this.getActiveSheetIndex()).find(".e-commentcell").length>0&&this.XLComment._commentMouseMove(i);t.isNullOrUndefined(i.target.parentNode)||i.target.id.indexOf("_svg")<0&&i.target.parentNode.className.indexOf("e-content")<0&&!n(i.target).is("td.e-rowcell")&&this.XLShape._shapeMouseUp(i)},_mouseLeave:function(){n(".e-ss-colresize, .e-ss-rowresize").removeClass("e-ss-colresize e-ss-rowresize")},_sheetMouseUp:function(t){this.model.allowResizing&&(this.XLResize._resizeType==="Col"?this.XLResize._cMouseUp(t):this.XLResize._resizeType==="Row"?this.XLResize._rMouseUp(t):this.XLResize._resizeType==="AP"&&this.XLResize._apMouseUp(t));this.model.allowDragAndDrop&&this.XLDragDrap._allowDragAndDrop&&this.XLDragDrap._dMouseUp(t);this.model.allowComments&&this.XLComment._isCommentEdit&&this.getActiveCellElem().find("textarea").focus();this._isSheetRename&&n("#"+this._id+"_Sheet_RenamePanel").focus();this.model.pictureSettings.allowPictures&&this.XLShape._shapeMouseUp(t)},_keyDownHandler:function(i){var c=!0,e=!1,l=this.getActiveSheetIndex(),r,o,f,a=n("#"+this._id+"_Ribbon").data("ejRibbon"),s;if(this._getContent(l).find(".e-ss-activeimg").length&&(e=!0,s=document.activeElement.id,s.indexOf(this._id+"_pictureheight")<0&&s.indexOf(this._id+"_picturewidth")<0&&this.XLShape._imgKeyDown(i)),i.target.id.indexOf("_Custom")<0&&i.target.id.indexOf("_Ribbon")<0){if((i.stopImmediatePropagation(),this.model.allowFiltering&&this.XLFilter._isSearchEdit&&i.keyCode!==27)||(n(i.target).parents(".e-formulabar").length&&this.XLEdit._isEdit&&this.model.allowKeyboardNavigation&&(this.XLCellNav._isNavigate=i.keyCode===13),this._isSheetRename||this.XLEdit._isEdit||this.XLComment&&this.XLComment._isCommentEdit||!this.model.allowClipboard||this.XLClipboard._copyPasteHandler(i),e||this._isSheetRename||((this.XLComment&&this.XLComment._isCommentEdit)?this.model.allowKeyboardNavigation&&(this.XLCellNav._isNavigate=!1):this.model.allowEditing&&(document.activeElement.id.indexOf("_inputbox")===-1||i.keyCode===27)&&this.XLEdit._editingHandler(i)),this.model.allowSearching&&this.XLFndRp._fRKeyDownHandler(i),this._isFormulaSuggestion&&(i.keyCode===39||i.keyCode===37||i.keyCode===13)?this.XLEdit.saveCell():this.XLEdit._isFormulaEdit||i.keyCode!==9&&i.keyCode!==13&&i.keyCode!==37&&i.keyCode!==38&&i.keyCode!==39&&i.keyCode!==40||(c=this.XLEdit._isEdit&&this.model.allowKeyboardNavigation&&this.XLCellNav._isNavigate?this.XLEdit.saveCell():!0),n(i.target).hasClass("e-field-validation-error")||i.target.id==this._id+"_Ribbon_font-family_wrapper"||i.target.id==this._id+"_Ribbon_cellformat_wrapper"||i.target.id==this._id+"_Ribbon_fontsize_wrapper"))return!0;if(!c&&!this.XLEdit._isFormulaEdit)return!1;!this.model.allowKeyboardNavigation||e||this._isSheetRename||(this.model.allowComments&&this.XLComment._isCommentEdit||n(i.target).parents(".e-formulabar").length&&i.keyCode!==9&&i.keyCode!==13||this.XLCellNav._selectionKeyDownHandler(i),this._keyboardShortCuts(i));this.model.allowUndoRedo&&(this.model.allowComments&&!this.XLComment._isCommentEdit?this._undoRedoOperation(i):this.model.allowComments||this._undoRedoOperation(i));this.XLEdit._isFormulaEdit&&i.keyCode===9&&!this.XLCellNav._canKeyBoardNavigate&&(this.XLCellNav._canKeyBoardNavigate=!0)}if(i.target.tagName==="DIV"&&!this.XLEdit._isEdit){var h=this.element.find("#"+this._id+"ddl"),v=h.val(),u=this._ddlCell;t.isNullOrUndefined(u)||(h.ejDropDownList("hidePopup"),u.find("span#"+this._id+"ddl_wrapper").remove(),this.element.find("#"+this._id+"ddlspan").remove(),h.remove(),u.text(v),this.XLEdit.updateCell(u,u.text()),this._ddlCell=null)}r=this.getActiveCellElem();f=!t.isNullOrUndefined(r)&&r.length?r[0].className:"";f.indexOf("e-rowcell")>-1&&f.indexOf("e-table")>-1?(o=this._getTableID(f),this.isNumber(o)&&this.XLRibbon._designTabUpdate(o,i.target)):this.model.showRibbon&&(a.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||a.isVisible(this._getLocStr("Design")))&&this.XLRibbon._toggleDesignTab(i.target);!r.length||this.XLEdit._isEdit||t.isNullOrUndefined(this.XLEdit.getPropertyValue(r.closest("tr").index(),r[0].cellIndex,"rule",l))||this._setddlCell(i);this._isSheetRename&&(i.keyCode===13||i.keyCode===9||i.keyCode===27)&&(i.preventDefault(),this._updateSheetNames(null,i.keyCode===27)&&this.setSheetFocus())},_recorddblClickHandler:function(i){var u,r;if(this.model.allowEditing&&this.model.allowSelection){if(this.XLSelection._isOutsideBordering||this.XLSelection._isGridBordering)return u=this._getContent(this.getActiveSheetIndex()).find("div:first-child"),u.addClass("e-ss-cursor"),u.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor"),this.XLSelection._isOutsideBordering=this.XLSelection._isGridBordering=!1,!1;if(!this.XLEdit._isEdit&&(n(i.target).hasClass("e-rowcell")||n(i.target).parents("td").hasClass("e-rowcell"))&&!n(i.target).hasClass("e-readonly")){if(n(".e-cdata").length&&n(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),r=n(i.target),r.closest("#"+this._id+"EditForm").length)return;this.XLEdit.editCell(n.inArray(r.closest("tr").get(0),this.getRows(this.getActiveSheetIndex())[1]),r.closest("td")[0].cellIndex,!0);t.isNullOrUndefined(this.XLCellNav)||(this.XLCellNav._isNavigate=!1)}if(this.model.allowResizing&&(n(i.target).hasClass("e-headercell")||n(i.target).hasClass("e-headercelldiv"))&&this.XLResize._resizeToFitWidth(i),n(i.target).is("span")&&this.model.allowResizing&&this._hasClass(n(i.target.parentNode)[0],"e-ss-rowresize")?this.XLResize._resizeToFitHeight(i.target.parentNode):this.model.allowResizing&&n(i.target).hasClass("e-ss-rowresize")&&this.XLResize._resizeToFitHeight(i),this.XLSelection._isOutsideBordering||this.XLSelection._isGridBordering)return u=this._getContent(this.getActiveSheetIndex()),u.addClass("e-ss-cursor"),u.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor"),this.XLSelection._isOutsideBordering=this.XLSelection._isGridBordering=!1,!1;if(!this.XLEdit._isEdit&&n(i.target).hasClass("e-rowcell")&&!n(i.target).hasClass("e-readonly")){if(this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),r=n(i.target),r.closest("#"+this._id+"EditForm").length)return;this.XLEdit.editCell(n.inArray(r.closest("tr").get(0),this.getRows(this.getActiveSheetIndex())[1]),r.closest("td")[0].cellIndex,!0);this._isNavigate=!1}}},_keyboardShortCuts:function(i){var r,f,c,e,o,h,s,l,u,a;if(this.XLEdit._isEdit)return!1;if(s=this.XLFormat,i.ctrlKey){switch(i.keyCode){case 65:i.preventDefault();this.model.allowSelection&&(r=this.getActiveSheetIndex(),f=this.model.sheets[r],c=this.getActiveCellElem(),e={rowIndex:0,colIndex:0},o={rowIndex:f.rowCount-1,colIndex:f.colCount-1},this.XLSelection.selectRange(e,o),this.getSheet(r)._startCell=e,this.getSheet(r)._endCell=o,t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(n(c[0]).closest("tr").index(),c[0].cellIndex),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement());break;case 66:i.preventDefault();this._toggleFontPrpty("bold");break;case 68:case 82:i.preventDefault();this.model.allowAutoFill&&this.XLDragFill._fillRange(i.keyCode===68);break;case 73:i.preventDefault();this._toggleFontPrpty("italic");break;case 75:i.preventDefault();this.model.allowHyperlink&&this._hlDlgOpen();break;case 85:i.preventDefault();this._toggleFontPrpty("underline");break;case 80:i.preventDefault();this.XLPrint.printSheet();break;case 79:i.preventDefault();this.model.allowImport&&(this._isSheetsDirty()?this._showAlertDlg("","ImportAlert","Open",470,135):n("#"+this._id+"_file .e-uploadinput").click());break;case 83:i.preventDefault();this.XLExport["export"]("Excel");break;case 32:if(i.preventDefault(),!this.model.allowSelection)return;r=this.getActiveSheetIndex();f=this.getSheet(r);var u=f._selectedCells,v=u[0].colIndex,p=u[u.length-1].colIndex;e={rowIndex:0,colIndex:v};o={rowIndex:f.rowCount-1,colIndex:p};this.model.allowSelection&&this.XLSelection.selectRange(e,o);this.getSheet(r)._startCell=e;this.getSheet(r)._endCell=o;t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(u[0].rowIndex,v);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();break;case 53:i.preventDefault();this._toggleFontPrpty("line-through");break;case 56:i.shiftKey||(i.preventDefault(),r=this.getActiveSheetIndex(),h=this.getSheet(r),this.hideColumn(h._startCell.colIndex,h._endCell.colIndex));break;case 57:i.shiftKey||(i.preventDefault(),r=this.getActiveSheetIndex(),h=this.getSheet(r),this.hideRow(h._startCell.rowIndex,h._endCell.rowIndex));break;case 220:i.shiftKey||(i.preventDefault(),this.model.allowSearching&&this.XLFndRp._applyGotoRowDiff());break;case 90:i.preventDefault();break;case 89:i.preventDefault();break;case 114:i.preventDefault();this.model.showRibbon&&this.XLRibbon._openNameManagerDlg()}if(i.shiftKey)switch(i.keyCode){case 192:i.preventDefault();s.format({type:"general"});break;case 52:i.preventDefault();s.format({type:"currency"});break;case 53:i.preventDefault();s.format({type:"percentage"});break;case 54:i.preventDefault();s.format({type:"scientific"});break;case 51:i.preventDefault();s.format({type:"shortdate"});break;case 50:i.preventDefault();s.format({type:"time"});break;case 49:i.preventDefault();s.format({type:"number"});break;case 55:i.preventDefault();this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder&&this.XLFormat.applyBorder({top:"1px solid #000000",right:"1px solid #000000",bottom:"1px solid #000000",left:"1px solid #000000"});break;case 173:i.preventDefault();this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder&&this.XLFormat.applyBorder("noborder");break;case 73:i.preventDefault();this.model.allowInsert&&this._renderInsertDialog();break;case 68:i.preventDefault();this.model.allowDelete&&this._renderDeleteDialog();break;case 113:i.preventDefault();l=n("#"+this._id+"_Ribbon").data("ejRibbon");this.model.showRibbon&&(l.element.find(".e-rarrowup-2x").length?l.collapse():l.expand());break;case 56:i.preventDefault();u=this.getSheet(this.getActiveSheetIndex())._selectedCells;this.showColumn(u[0].colIndex,u[u.length-1].colIndex);break;case 57:i.preventDefault();u=this.getSheet(this.getActiveSheetIndex())._selectedCells;this.showRow(u[0].rowIndex,u[u.length-1].rowIndex);break;case 79:i.preventDefault();this.XLFndRp._applyGotoComments();break;case 220:i.preventDefault();this.XLFndRp._applyGotoColDiff()}}else if(i.shiftKey)if(i.keyCode===32){if(i.preventDefault(),this.model.allowSelection){r=this.getActiveSheetIndex();f=this.getSheet(r);var u=f._selectedCells,y=u[0].rowIndex,w=u[u.length-1].rowIndex;e={rowIndex:y,colIndex:0};o={rowIndex:w,colIndex:f.colCount-1};this.XLSelection.selectRange(e,o);this.getSheet(r)._startCell=e;this.getSheet(r)._endCell=o;t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(y,u[0].colIndex);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()}}else i.keyCode===113?(i.preventDefault(),c=this.getActiveCellElem(),c.hasClass("e-commentcell")?this.XLComment.editComment():this.XLComment.setComment()):i.keyCode===122&&(i.preventDefault(),this.addNewSheet());else if(i.keyCode===27){if(this.model.allowComments&&this.XLComment._isCommentEdit&&(this.XLComment._updateCurCmntVal(),this.XLComment._updateCmntRibIcons()),this.model.allowFiltering&&this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")){if(a=this._excelFilter._menuWrap.data("ejMenu"),a.element.find(".e-mhover li:visible").length){a._isContextMenuOpen||a._closeMenu();return}this.XLFilter._isSearchEdit=!1;this._excelFilter.closeXFDialog()}this.setSheetFocus()}else i.altKey&&(i.keyCode===112&&this.model.showRibbon&&this.model.allowCharts?(i.preventDefault(),this.XLChart.createChart(null,{type:"column",enable3D:!1,marker:{visible:!1}})):i.keyCode===84&&this.model.showRibbon&&!this.XLRibbon._isDirtySelect&&(i.preventDefault(),this.XLRibbon._openFATDlg()))},_triggerTBtnClick:function(t){var i=n("#"+t).data("ejToggleButton");i.buttontag.click()},_toggleFontPrpty:function(n){var u=this.getActiveCell(),f=this.XLFormat,t={style:{}},r,i,e;r=this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"format");e=!this.isUndefined(r)&&this.XLFormat.getFormatFromHashCode(r);i=n==="bold"?"font-weight":n==="italic"?"font-style":"text-decoration";e[i]===n?(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_"+n).ejToggleButton("option","toggleState",!1),t.style[i]="none",f.format(t)):(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_"+n).ejToggleButton("option","toggleState",!0),t.style[i]=n,f.format(t))},_getLocStr:function(n){return t.Spreadsheet.locale[this.model.locale]===r||t.Spreadsheet.locale[this.model.locale][n]===r?t.Spreadsheet.locale["en-US"][n]:t.Spreadsheet.locale[this.model.locale][n]},_checkIndicesInContainer:function(n,t,i,r){var u=this._dataContainer.sheets;return n in u&&t in u[n]&&i in u[n][t]?r?r in u[n][t][i]?!0:!1:!0:!1},_textFormatting:function(n){switch(n){case"wrapText":this.setWrapText(null,"")}},setWrapText:function(i,r){var u,o,s=this.getActiveSheetIndex(),w=this.getSheet(s),e=0,a,nt=this.getRows(s)[1],c=this.getRows(s)[0],b,v,y=w.rowsHeightCollection,h=0,p=this.getSheet(s)._wrapHtCollection,k,l,f,d,g;for(t.isNullOrUndefined(i)?u=w._selectedCells:(l=this.getRangeIndices(i),u=this.XLSelection._getSelectedRange({rowIndex:l[0],colIndex:l[1]},{rowIndex:l[2],colIndex:l[3]})),u.length>1?b=this._getProperAlphaRange(s,u[0].rowIndex,u[0].colIndex,u[u.length-1].rowIndex,u[u.length-1].colIndex):u.length>0&&(b=this._getAlphaRange(s,u[0].rowIndex,u[0].colIndex,u[u.length-1].rowIndex,u[u.length-1].colIndex)),f=0,d=u.length;f<d;f++){if(o=this.getCell(u[f].rowIndex,u[f].colIndex),o.hasClass("e-sswraptext")||r==="unwrap")o.removeClass("e-sswraptext"),n(c[u[f].rowIndex]).removeClass("e-sswraprow"),r="unwrap",h=y[u[f].rowIndex],e=p[u[f].rowIndex],o.find(".e-filterspan").length>0&&(a=o.find(".e-filterspan"),this.model.allowFiltering&&this.XLFilter._postionFilterIcon(o,a)),this.XLEdit._updateDataContainer(o[0],{wrap:!1});else{if(r="wrap",o.is(":visible")){if(o.addClass("e-sswraptext"),n(c[u[f].rowIndex]).hasClass("e-sswraprow")||n(c[u[f].rowIndex]).addClass("e-sswraprow"),o[0].rowSpan>1)for(v=u[f].rowIndex;v<u[f].rowIndex+o[0].rowSpan;v++)h=h+y[v];else h=y[u[f].rowIndex];o.find(".e-filterspan").length>0&&(a=o.find(".e-filterspan"),this.model.allowFiltering&&this.XLFilter._postionFilterIcon(o,a));e=o[0].offsetHeight;e<=h&&(e=h-e)}p[u[f].rowIndex]=f>0&&u[f].rowIndex===u[f-1].rowIndex?p[u[f-1].rowIndex]:p[u[f].rowIndex]=n(c[u[f].rowIndex]).height();this.XLEdit._updateDataContainer(o[0],{wrap:!0})}k=this.model.sheets[s].selectedRange;e>0&&u[f].colIndex===k[3]&&(n(c[u[f].rowIndex]).height(e),n(nt[u[f].rowIndex]).height(e),y[u[f].rowIndex]=e,this.getFrozenRows(s)>=u[f].rowIndex&&(h>=e?(e=h-e,this._refreshFreezeRows(s,u[f].rowIndex,e,"delete")):(e=e-h,this._refreshFreezeRows(s,u[f].rowIndex,e,"insert"))));e=0}this.model.allowComments&&this.XLComment._updateCmntArrowPos();w._importRendered||(g={sheetIndex:s,selectedCells:u,reqType:"textwrap",operation:r,range:b},this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(s,"refresh","all"),this.XLSelection._refreshBorder(),this._isUndoRedo||this._dupDetails||this._completeAction(g));this.model.scrollSettings.allowScrolling&&this.XLScroll._getRowHeights(s,u[0].rowIndex+1)},_setWrapTextForImport:function(n,t,i,r){var u,f=this.getSheet(n)._wrapHtCollection;u=r[t];this.addClass(u.cells[i],"e-sswraptext");f[t]=20;this._wrapRow=!0},_setWrapHeight:function(t,i,r,u,f,e){var h=r[i],s=this.getSheet(t),v=s.hideRowsCollection,c=!1,l=s.rowsHeightCollection,a,o;c=v.indexOf(i)>-1;l[i]>0?o=l[i]:c&&e!=="visible"||(a=n(r[i].outerHTML).attr("id","ss"),f[0].insertBefore(a[0],f[0].childNodes[0]),o=f[0].rows[0].getBoundingClientRect().height,f[0].rows[0].parentNode.removeChild(f[0].rows[0]));o=o<20?20:o;parseInt(h.style.height)<o&&(h.style.height=o+"px",n(u[i])[0].style.height=o+"px",s.rowsHeightCollection[i]=o)},_setRowHdrHeightResize:function(t,i){for(var r,f=this.getRows(t),e=f[0],o=f[1],u=0,s=o.length;u<s;u++)(r=this.getCell(u,i),r[0].className.indexOf("e-rc")>0||r.prop("rowspan")>1||r.prop("colspan")>1)||n(e[u]).height(r[0].offsetHeight)},_setRowHdrHeight:function(t,i){n(this.getRows(t)[0][i]).height(n(this.getRows(t)[1][i]).height());!this.model.sheets[t]._importRendered&&this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_refreshRangeTRHght:function(n,t){for(var r=t[0]<1?t[0]:t[0]-1,i=r;i<=t[2];i++)this._setRowHdrHeight(n,i);this.model.sheets[n]._importRendered||this.XLSelection._refreshBorder()},_renderAlertdlg:function(){var i=this._id+"_alertdlg";if(!n(i).length){var r=t.buildTag("div#"+i+".e-alertdlg","",{display:"none"}),s=t.buildTag("div#"+i+"_dlgcontent .e-alertdlgcontent"),u=t.buildTag("div#"+i+"_dlgbtncontent .e-dlg-btnfields"),h=t.buildTag("div#"+i+"_condiv .e-dlg-btnctnr"),c=t.buildTag("div#"+i+"_alertdiv .e-dlg-btnctnr");r.append(s);var f=t.buildTag("input#"+this._id+"_dialog_Ok"),e=t.buildTag("input#"+this._id+"_dialog_Can","",{"margin-left":10}),o=t.buildTag("input#"+this._id+"_dialog_alertOk");f.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertOkClick,this),enabled:!0});e.ejButton({text:this._getLocStr("Cancel"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertCanClick,this)});o.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertOkClick,this),enabled:!0});u.append(h.append(f,e));u.append(c.append(o));r.append(u);this.element.append(r)}},_renderAlertDlgContent:function(n,i,r,u,f,e){var o=n.find("#"+this._id+"_alertdlg_dlgcontent"),s=n.find("#"+this._id+"_alertdlg_condiv"),h=n.find("#"+this._id+"_alertdlg_alertdiv");f=f||400;e=e||"";i==="Alert"?(s.hide(),h.show()):(s.show(),h.hide());o.text("");o.html(r);n.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("Title"),width:f,height:"auto",minHeight:0,cssClass:"e-ss-dialog "+e,open:t.proxy(this._alertDlgOpen)});this._alertDialog={element:n,action:u}},_alertDlgOpen:function(){this.element.find("input:visible:first").focus()},_alertOkClick:function(){var t=this.getActiveSheetIndex(),i;this._alertDialog.element.ejDialog("close");switch(this._alertDialog.action){case"findPrevComment":this.gotoPage(this.model.sheetCount,!1);i=this.model.sheets[this.model.sheetCount];this.XLComment._updateCurrentCell(i.rowCount-1,i.colCount-1);this.XLComment.findPrevComment();this._alertDialog.action=null;break;case"findNextComment":this.gotoPage(1,!1);this.XLComment._updateCurrentCell(0,0);this.XLComment.findNextComment();this._alertDialog.action=null;break;case"sheetRenameActn":n("#"+this._id+"_Sheet_RenamePanel").select().focus();break;case"sheetDeleteActn":this._removeSheet(t);this._alertDialog.action=null;break;case"New":this._destroy();this.importSheet=!0;this.model.sheetCount=1;this.model.activeSheetIndex=1;this.model.sheets.splice(0,0,{});this._renderSheets();this.XLRibbon._toggleFormatTab();this.XLRibbon._toggleChartDesignTab();this._refreshSpreadSheetPager();this.importSheet=!1;break;case"Open":n("#"+this._id+"_file .e-uploadinput").click();break;case"MissingParenthesis":this.XLEdit._focusElements(this.getActiveCellElem(t));break;case"MergeCells":this._mergeCells(t,this.model.sheets[t]._selectedCells,{},[]);this._alertDialog.action=null;break;case"MergeAcrossCells":this._mergeAcrossCells(t,this.model.sheets[t]._selectedCells);this._alertDialog.action=null;break;case"CtrlKeyErrorAction":this.setSheetFocus();break;case"InvalidChartTitleActn":n("#"+this._id+"_chartnamedlg").find("input:first").focus()}},_alertCanClick:function(){(this._alertDialog.action=="findNextComment"||this._alertDialog.action=="findPrevComment")&&n(this.getActiveCellElem()).find(".e-comment-txtarea").css("display","inline-table");this._alertDialog.element.ejDialog("close");this.hideWaitingPopUp()},_showAlertDlg:function(t,i,r,u,f){var e=n("#"+this._id+"_alertdlg"),o="Alert",s=i.indexOf("T-")===0?i.slice(2):this._getLocStr(i);t===o?this._renderAlertDlgContent(e,o,s,r,u,f):this._renderAlertDlgContent(e,"",s,r,u,f);e.ejDialog("open")},_isSheetsDirty:function(){var n=1,t=this._dataContainer.sheets,i=this.getObjectLength(t)+1;if(this.model.nameManager.length)return!0;while(n<i){if(this.getObjectLength(t[n]))return!0;n++}return!1},getCell:function(t,i,r){return r=this._getSheetIndex(r),(this.importSheet||this.model.sheets[r]._importRendered||this._isPrint)&&this._detachTable?n(this._detachTable[0].tBodies[0].rows[t].cells[i]):n(this._getContent(r).find(".e-table")[0].tBodies[0].rows[t].cells[i])},getRange:function(i,r,u,f,e,o){var s,a,l,v,y,c,h;for(s=(this.importSheet||this.model.sheets[this._getSheetIndex(e)]._importRendered)&&this._detachTable?n(this._detachTable[0].rows):n(this._getContent(this._getSheetIndex(e)).find(".e-table")[0].rows),typeof i=="string"&&(c=this.getRangeIndices(i),i=c[0],r=c[1],u=c[2],f=c[3]),i>u&&(l=i,i=u,u=l),r>f&&(l=r,r=f,f=l),s=u!==i?s.slice(i,u+1):s.eq(u),a=[],v=s.length,h=0;h<v;h++)o&&this._isHiddenRow(h,s)||(y=f!==r?n(s[h].cells).slice(r,f+1):n(s[h].cells).eq(f),t.merge(a,y));return n(a)},getRangeIndices:function(n){n=n.indexOf(":")===-1?n+":"+n:n;var r=n.split(":"),t,i=[];return t=r[0].split(/[A-Z]/i),i.push(parseInt(t[t.length-1])-1),i.push(this._generateColCount(r[0].split(/[0-9]/)[0].toUpperCase())-1),t=r[1].split(/[A-Z]/i),i.push(parseInt(t[t.length-1])-1),i.push(this._generateColCount(r[1].split(/[0-9]/)[0].toUpperCase())-1),this.swapRange(i),i},swapRange:function(n){return n[0]>n[2]&&t.dataUtil.swap(n,0,2),n[1]>n[3]&&t.dataUtil.swap(n,1,3),n},updateRange:function(t,i){var f=i.dataSource,c,l,u=[],a=[],h,y=f.length,p=this.getObjectLength(f[0]),e,v,s,o;if(l=i.startCell,c=l.split(/[A-Z]/i),u.push(parseInt(c[c.length-1])-1),u.push(this._generateColCount(l[0].split(/[0-9]/)[0].toUpperCase())-1),u.push(u[0]+y-(i.showHeader?0:1)),u.push(u[1]+p-1),this.XLScroll._refreshRowCol(u,t),e=this.getRange(u[0],u[1],u[2],u[3],t),v=this._getContent(t).find(".e-content >table"),v.detach(),i.showHeader)for(h in f[0])a.push(h);for(s=0;s<y;s++)if(f[s]!=r)for(h in f[0])a.push(f[s][h]);for(o=0;o<e.length;o++)this.XLEdit.updateCell(n(e[o]),a[o],t),i.showHeader&&o<p&&(u=i.startCell+":"+(this._generateHeaderText(t,e[e.length-1].cellIndex+1)+(n(e[0]).parent().index()+1)),i.headerStyles&&this.XLFormat.format({style:i.headerStyles},u));this._getContent(t).find(".e-content").append(v)},editRange:function(t,i){var f=this.getSheet(this.getActiveSheetIndex()).rangeSettings[t],u,r,o,s,l,e=this.getRangeIndices(f.range),h=this.getRange(e[0],e[1],e[2],e[3]),c;for(this._trigger("editRangeBegin",{range:f,sheetIndex:this.getActiveSheetIndex()}),f.cssClass&&h.addClass(f.cssClass),f.readOnly&&h.addClass("e-readonly"),c=this._getContent(this.getActiveSheetIndex()).find(".e-content >table"),c.detach(),o=0,l=h.length;o<l;o++)u=h[o],n.trim(t).length&&this.XLEdit._updateDataContainer(u,{range:t}),r=i(u,u.cellIndex,o),typeof r=="string"?this.XLEdit.updateCell(n(u),r):typeof r=="object"&&(r.Value.indexOf("=")!==0?this.XLEdit.updateCell(n(u),r.Value):this.XLEdit.updateCellValue(n(u),r.Value),n(u).data("value2",r.Value2),n(u).data("type",r.NumberFormat),r.StyleIndex>1&&n(u).addClass(this._styleColl[r.StyleIndex]));for(this._getContent(this.getActiveSheetIndex()).find(".e-content").append(c),s=e[0];s<e[2]+1;s++)this._setRowHdrHeight(this.getActiveSheetIndex(),s);this._trigger("editRangeComplete",{range:f,sheetIndex:this.getActiveSheetIndex()})},removeRange:function(n){this.clearRange(n);delete this.getSheet(this.getActiveSheetIndex()).rangeSettings[n]},clearRange:function(n){var t=this.getSheet(this.getActiveSheetIndex()).rangeSettings[n],i=this.getRangeIndices(t.range),r=this.getRange(i[0],i[1],i[2],i[3]);t.cssClass&&r.removeClass(t.cssClass);t.readOnly&&r.removeClass("e-readonly");this.clearRangeData(null,["range","value","type","value2"],r);r.empty()},getObjectLength:function(n){var t,i=0;if(n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{},Object.keys)return Object.keys(n).length;for(t in n)n.hasOwnProperty(t)&&i++;return i},getObjectKeys:function(n){var t,i=[];if(n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{},Object.keys)return Object.keys(n);for(t in n)n.hasOwnProperty(t)&&i.push(t);return i},toArrayLowerCase:function(n){for(var t=0;t<n.length;t++)n[t]=n[t].toString().toLowerCase();return n},_isValueAlreadyExist:function(n,t,i){for(var r=0,u=n.length;r<u;){if(n[r][t]===i)return!0;r++}return!1},addClass:function(n,t){if(n){var i=n.className;i.indexOf(t)===-1&&(n.className=i+" "+t)}},_removeClass:function(n,t){n&&(n.className=n.className.replace(new RegExp(t,"g"),"").replace(/ +/g," "))},_hasClass:function(n,t){if(n)return n.className.indexOf(t)>-1},isUndefined:function(n){return n===r},_isObject:function(n){return Object.prototype.toString.call(n)==="[object Object]"},_isBool:function(n){return n=n+"",n=n.toUpperCase(),n==="TRUE"||n==="FALSE"},isRange:function(n){return n[0]!==n[2]||n[1]!==n[3]},inRange:function(n,t,i){return t>=n[0]&&t<=n[2]&&i>=n[1]&&i<=n[3]},_isUniqueRange:function(n,t){return n.toString()===t.toString()},hasSpan:function(n){return n>1},_arrayAsString:function(n){return n.join(" ").replace(/,/g," ")},_rangeHasData:function(n){var t,i;for(n=this.swapRange(n),t=this.getRange(n[0],n[1],n[2],n[3]),i=t.length;i--;)if(t[i].innerHTML.length)return!0;return!1},_isHiddenRow:function(n,t){var i=t?t[n]:this._sheets[this.getActiveSheetIndex()]._Rows[0][n];return this._hasClass(i,"e-r-hide")||this._hasClass(i,"e-hide")},getRangeDataAsObject:function(n,i,r){var f,s,e,h,c,w=t.Spreadsheet.CellType,o=this._dataContainer,l=o.sheets[this.getActiveSheetIndex()],u,a,v,y,b=[],k=[],p=[];for(n.rowIndex>i.rowIndex?(u=i.rowIndex,a=n.rowIndex):(u=n.rowIndex,a=i.rowIndex),n.colIndex>i.colIndex?(v=i.colIndex,y=n.colIndex):(v=n.colIndex,y=i.colIndex);u<=a;){if(!r||!this._isHiddenRow(u)){for(h={},c={},f=v;f<=y;f++)s=this.getSheet(this.getActiveSheetIndex()).columns[f].field,u in l&&f in l[u]&&(e=l[u][f],h[s]=o.sharedData[e.value],c[s]=[w.General,w.Text].indexOf(o.cellType[e.type])===-1?e.value2:o.sharedData[e.value2]);b.push(h);k.push(c)}u++}return p.push(b),p.push(k),p},_getColorFromFormat:function(n){var i=[],t,r,u;return t=n.replace("e-format","").toLowerCase(),r=t.startsWith("6n")?"#"+t.substr(2,6):"#"+t.substr(6,6),u="#"+t.substr(0,6),i.push(u),i.push(r),i},getRangeData:function(n,t,i,r,u,f,e){r=r?r:this.getActiveSheetIndex();i=i?i:["value","value2","type","formatStr","decimalPlaces","thousandSeparator","range","format","border","comment","hyperlink","picture","cFormatRule","rule","chart"];var v,a,w,o,y,h,c=[],b="value",k=this._dataContainer,l=k.sheets[r],d=k.sharedData;n=n?this.swapRange(n):this.getSheet(r).selectedRange;for(var s=n[0],g=n[2],p=n[3];s<=g;){if(!e||!this._isHiddenRow(s))if(o=n[1],s in l)if(t)while(o<=p)h="",o in l[s]&&b in l[s][o]&&(h=d[l[s][o][b]],u&&this._isDateTime(h)?h=this.XLEdit.getPropertyValue(s,o,"value2"):f&&this.isFormula(h)&&(h=this.XLEdit.getPropertyValue(s,o,"calcValue"))),c.push(h),o++;else while(o<=p){if(o in l[s]){for(v=i.length,y={},w=l[s][o];v--;)a=i[v],this.isUndefined(w[a])||(y[a]=this.XLEdit.getPropertyValue(s,o,a,r));c.push(y)}else c.push({});o++}else while(o<=p)t?c.push(""):c.push({}),o++;s++}return c},_processBindings:function(n){if(this.model.query=new t.Query,this._trigger("actionBegin",n))return!0;this._ensureDataSource(n);n.action==="sorting"&&this.XLSort._sortComplete(n);n.action==="sorting"?this._isUndoRedo||this._completeAction(n):this._completeAction(n)},_ensureDataSource:function(n){var f=this.getActiveSheetIndex(),i,u=this.model.query,e,s,h,c,l,o,v,y,a;if(n.action==="filtering"||n.action==="clearfiltering"||n.requestType==="filterbycell"){for(i=this.model.sheets[f].filterSettings.filteredRange==null?this._dataSource(f):this.model.sheets[f].filterSettings.filteredRange,l=this.model.sheets[f].filterSettings.tableRange,o=0,v=l.length;o<v;o++)if(l[o].tableID===n.tableID){l[o].filteredRange=i;break}if(this._dataManager=t.DataManager(i),i instanceof t.DataManager||(this.model.currentViewData=i),this.model.query.requiresCount(),u=this.model.query,n.filteredcolumns.length){s=this._excelFilter._predicates[f];y=i[0];for(a in s)y.hasOwnProperty(a)&&(h=s[a]),h=s[a],e=e!=r?e.and(h):h;t.isNullOrUndefined(e)||u.where(e);i instanceof t.DataManager||(this._filteredRecordsCount=this._dataManager.executeLocal(u).count,c=this._dataManager.executeLocal(u),this.model.currentViewData=c.result)}}else n.requestType==="sorting"&&(this._dataManager=t.DataManager(n.rangeData),n.rangeData instanceof t.DataManager||(this.model.currentViewData=n.rangeData),u.sortBy(n.columnName,n.sortDirection),n.rangeData instanceof t.DataManager||(c=this._dataManager.executeLocal(u),this.model.currentViewData=c))},_toArrayData:function(n){for(var u,t,i=0,r=[],f=n.length;i<f;){if(t=n[i],this.getObjectLength(t))for(u in t)r.push(t[u]);else r.push("");i++}return r},updateRangeData:function(n,i,r){var f=this.XLSelection._getSelectedRange(i.startCell,i.endCell),o=this._toArrayData(r),u,e;if(o.length===f.length)for(u=0;u<f.length;u++)if(!t.isNullOrUndefined(o[u])&&(this.XLEdit.updateCellValue(this.getCell(f[u].rowIndex,f[u].colIndex),o[u]),!t.isNullOrUndefined(n.filterIcon)))for(e=0;e<n.filterIcon.length;e++)if(n.filterIcon[e].rowIndex===f[u].rowIndex&&n.filterIcon[e].colIndex===f[u].colIndex){this.getCell(f[u].rowIndex,f[u].colIndex).append(n.filterIcon[e].filterIcon);break}},updateData:function(i,r){r=r?this.swapRange(r):this.getSheet(this.getActiveSheetIndex()).selectedRange;var f,u,o,e,s,h=n.makeArray(this.getRange(r[0],r[1],r[2],r[3])).reverse(),c,l;if(i.length===h.length)for(u=i.length,i=i.reverse();u--;)f=h[u],c=f.parentNode.rowIndex,l=f.cellIndex,this.XLEdit._updateDataContainer(f,i[u]),"hyperlink"in i[u]&&(e=i[u].hyperlink,s=n(f),this.isUndefined(e)||(e.webAddr?s.html(t.buildTag("a",i[u].value2,"",{href:e.webAddr,target:"_blank","class":"e-hyperlinks"})):s.html(t.buildTag("a",i[u].value2,"",{href:"#","class":"e-hyperlinks"})))),"comment"in i[u]&&this.model.allowComments&&this.XLComment._updateCmntFrmCntnr(null,null,n(f)),"value"in i[u]&&(o=i[u].value,this.XLEdit._refreshCalcEngine(c,l,this.isFormula(o),o))},updateUniqueData:function(n,t,i){i||(t=t?this.swapRange(t):this.getSheet(this.getActiveSheetIndex()).selectedRange,i=this.getRange(t[0],t[1],t[2],t[3]));for(var r=i.length;r--;)this.XLEdit._updateDataContainer(i[r],n)},clearRangeData:function(n,t,i,r){var o,h,s,c,l=this.getActiveSheetIndex(),e=this._dataContainer.sheets[l],u,f;for(t=t?t:["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink"],i||(n=n?this.swapRange(n):this.getSheet(this.getActiveSheetIndex()).selectedRange,i=this.getRange(n[0],n[1],n[2],n[3])),o=i.length;o--;)if(u=i[o].parentNode.rowIndex,f=i[o].cellIndex,(!r||!this._isHiddenRow(u))&&u in e&&f in e[u]){for(s=this.XLEdit.getPropertyValue(u,f,"value"),this.isFormula(s)?(c=!0,s=""):c=!1,h=t.length;h--;)delete e[u][f][t[h]];t.indexOf("value2")>-1&&(i[o].innerHTML="");this.getObjectLength(e[u][f])||delete e[u][f];this.getObjectLength(e[u])||delete e[u];t.indexOf("value")>-1&&(this.XLEdit._refreshCalcEngine(u,f,c,s),this.model.allowCharts&&this.XLChart._refreshChartElements(u,f,l))}},_getArrayRangeCells:function(n){return n?(n=this.swapRange(n),this.getRange(n[0],n[1],n[2],n[3])):this._getContent(this.getActiveSheetIndex()).find(".e-selected")},_getAlphaRangeCells:function(n){return n?(n=this.getRangeIndices(n),this.getRange(n[0],n[1],n[2],n[3])):this._getContent(this.getActiveSheetIndex()).find(".e-selected")},_completeAction:function(n){var r=this.getActiveSheetIndex(),i,f,e,u;n.reqType==="filter"?i=n.operation!=="apply-filter"&&n.operation!=="remove-filter"?{sheetIndex:r,range:this.model.sheets[r]._selectedRange,currentViewData:n.model.currentViewData,fieldName:n.currentFilteringColumn,ejpredicate:n.ejpredicate,activeCell:n.activeCell,filteredValue:n.filteredValue,filterCollection:n.filteredcolumns,requestType:n.requestType,reqType:n.reqType,selCells:n.selCells,action:n.action,operation:"filter",selectedDataSource:this.model.sheets[r].selectedDataSource,tableID:n.tableID,filteredCells:n.filteredCells}:n.operation==="remove-filter"?n:{sheetIndex:r,filteredCells:n.filteredCells,reqType:"filter",operation:"apply-filter",tableID:n.tableID,fRange:this.getSheet(r).filterSettings.range}:n.requestType===t.Spreadsheet.Actions.Sorting?(u=this.getCell(n.filterIcon.length>0?n.range[0]-1:n.range[0],this.XLEdit.getColumnIndexByField(n.columnName)).find(".e-filterspan"),f=u[0]?u[0].className.indexOf("-asc")>-1?"-asc":u[0].className.indexOf("-dsc")>-1?"-dsc":"":"",e=n.sortDirection==="ascending"?"-asc":"-dsc",i={sheetIndex:r,prevIcon:f,isSortByFilter:n.isSortByFilter,colSelected:n.colSelected,currIcon:e,range:n.range,columnName:n.columnName,rangeData:n.rangeData,reqType:"sort",direction:n.sortDirection,operation:"unsort"}):n.requestType==="sortbycolor"||n.requestType==="filterbycolor"?(i={sheetIndex:r,operation:n.operation,requestType:n.requestType,action:n.action,bgcolor:n.bgcolor,fgcolor:n.fgcolor,tableID:n.tableID,reqType:n.requestType},i.columnName=n.requestType==="sortbycolor"?n.sortColumn:n.filterColumn):i=n;!this.model.allowUndoRedo||i.requestType==="sortbycolor"||this._updateUndoRedoCollection(i);n.operation!=="apply-filter"&&n.operation!=="remove-filter"&&this.sendDataRenderingRequest(i,this.getActiveSheetIndex());this.model.allowAutoFill&&n.reqType!=="find-replace"&&this.XLDragFill.positionAutoFillElement();this._updateUndoRedoIcons();this._trigger("actionComplete",n)},_updateUndoRedoCollection:function(n){this._isUndoRedo||(this._undoCollection.push(n),this._redoCollection=[]);this._undoCollection.length>this._undoredoStep&&this._undoCollection.splice(0,1)},_trigActionBegin:function(n){return this._trigger("actionBegin",n)},_trigActionComplete:function(n){return this._trigger("actionComplete",n)},_updateUndoRedoIcons:function(){if(this.model.showRibbon&&this.model.allowUndoRedo){var t,i=n("#"+this._id+"_Ribbon_undo").data("ejButton"),r=n("#"+this._id+"_Ribbon_redo").data("ejButton");this._undoCollection.length?i.enable():i.disable();this._redoCollection.length?r.enable():r.disable();this.XLEdit._isEdit||this.XLComment&&this.XLComment._isCommentEdit||this._isSheetRename||!document.activeElement||!(document.activeElement.id.indexOf(this._id+"_Ribbon")<0)||this.setSheetFocus();t={reqType:"picture",action:"add"};this._trigActionComplete(t)}},_filterMergeCells:function(n,t){for(var o=this._rcRegx,r,i,f=!1,e=n.find(".e-mc-hide"),u=0,s=e.length;u<s;u++)r=e[u].className.match(o)[0].split(" ")[0].replace("e-rc-","").split(":"),f=!0;f&&(i=this.getCell(r[0],r[1])[0],i.rowSpan=t==="incr"?i.rowSpan+1:i.rowSpan-1)},_selectFirstCell:function(n,t,i,r){return this.getSheet(n)._importRendered||r||(r=!r,this.performSelection({rowIndex:t,colIndex:i},{rowIndex:t,colIndex:i})),r},_refreshMergeCells:function(i,r){for(var o=i.find('td[class *= "e-merge"]'),h=this.getActiveSheetIndex(),f,u,s=this._dataContainer.sheets[h],e=0,c=o.length;e<c;e++)f=this.XLEdit.getPropertyValueByElem(n(o[e]),"mRange"),t.isNullOrUndefined(f)?r==="show"&&this._removeClass(o[e],"e-merge"):(this.unmergeCells(f),u=this.getRangeIndices(f),u[0]=r==="hide"?u[0]+1:u[0]-1,f=this._getAlphaRange(h,u[0],u[1],u[2],u[3]),r==="hide"?(s[u[0]-1][u[1]].mRange=f,this.addClass(this.getCell(u[0]-1,u[1])[0],"e-merge")):(t.isNullOrUndefined(s[u[0]+1][u[1]])||delete s[u[0]+1][u[1]].mRange,this._removeClass(this.getCell(u[0]+1,u[1])[0],"e-merge")),u[0]<u[2]&&this.mergeCells(f,!0))},_refreshAllMergeCells:function(i,r,u,f,e,o){var l=this._getContent(i).find(".e-merge"),h,s,v=this._dataContainer.sheets[i],c,a;for(this._dupDetails=!0,c=0,a=l.length;c<a;c++)h=this.XLEdit.getPropertyValueByElem(n(l[c]),"mRange"),s=this.getRangeIndices(h),(r>-1&&r<=s[0]||f>-1&&f<=s[1])&&(t.isNullOrUndefined(h)||(r>-1&&(r+1<=s[0]&&(s[0]=o==="insert"?s[0]+u:s[0]-u),s[2]=o==="insert"?s[2]+u:s[2]-u),f>-1&&(f+1<=s[1]&&(s[1]=o==="insert"?s[1]+e:s[1]-e),s[3]=o==="insert"?s[3]+e:s[3]-e),h=this._getAlphaRange(i,s[0],s[1],s[2],s[3]),this.unmergeCells(h),this.mergeCells(h,!0)));this._dupDetails=!1},sendDataRenderingRequest:function(i,u){for(var f,rt=!1,lt,hi=this._rAlign,li=this._rcRegx,ii=this.getRows(u),at=ii[0],h=ii[1],g=this.getSheet(u),s=g._selectedRange,ri,kt,dt=[],a,ci,nt,v=g.filteredRowsCollection,ui=g.hideRowsCollection,ct,k,p=g.filterSettings.tableRange,vt=this._formatRegx,c=[],gt,ft,y=[],et,ot=g.rowCount,yt=0,fi=g._defRowCount,tt=g._frHiddenHeight,st,d,pt,ti,e,wt,bt,b,ei,oi,si,o=0,ut=p.length;o<ut;o++)if(p[o].tableID==i.tableID){k=o;break}if(this._dupDetails=!0,t.isNullOrUndefined(i)||i.reqType!="filter"){if(!t.isNullOrUndefined(i)&&(i.requestType==="sortbycolor"||i.requestType==="filterbycolor")){var ai=s.startRow,it=[],ht,ni=[],a=this._generateColCount(i.columnName)-1,l,w;if(nt=this.getCell(s.startRow-1,a),i.prev={},i.cur={},nt.find(".e-ssfilter, .e-ssfilter-asc, .e-ssfilter-dsc, .e-ssfiltered, .e-ssfiltered-asc, .e-ssfiltered-dsc").length>0&&i.requestType==="filterbycolor"?(nt.removeClass(hi),this.XLFilter._changeFilterIcon(nt,"filter")):nt.find(".e-ssfilter-dsc, .e-ssfilter, .e-ssfiltered, .e-ssfiltered-dsc").length>0&&(i.prev.icon=nt.find(".e-filterspan")[0].className.split(" ")[3],this.XLFilter._changeSortIcon(nt,"ascending"),i.cur.icon=nt.find(".e-filterspan")[0].className.split(" ")[3]),i.requestType==="sortbycolor"){for(l=[s.startRow,a,s.endRow,a],w=this.getRangeData(l,null,null,null,null,null,!0),o=0;o<w.length;o++)t.isNullOrUndefined(w[o].format)||t.isNullOrUndefined(w[o].format.match(vt))||(ht=this._getColorFromFormat(w[o].format.match(vt)[0]),i.operation==="sortbgcolor"||i.operation==="filterbgcolor"?i.bgcolor===ht[0].toLowerCase()&&it.push(o):i.fgcolor===ht[1].toLowerCase()&&it.push(o));if(this.isUndefined(i.tableID))for(d=[],bt=l[1];bt<=l[3];bt++)d.push(bt);else d=p[k].multifilterIdx;for(l=[s.startRow,d[0],s.endRow,d[d.length-1]],w=this.getRangeData(l,null,null,null,null,null,!0),i.prev.data=n.extend(!0,[],w),l.colIndex=a,i.range=l,e=0,ut=d.length;e<ut;e++){for(pt=[],ti=[],l=[s.startRow,d[e],s.endRow,d[e]],w=this.getRangeData(l,null,null,null,null,null,!0),wt=it.length-1;wt>=0;wt--)pt.push(w.splice(it[wt],1)[0]);ti=pt.reverse().concat(w);pt.length>0&&(this._isSort=!0,this.XLComment.deleteComment(l,null,!0),this._removeHyperlink(null,null,!0),this.clearRangeData(l,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0),this.XLFormat.clearFormat(l,"format",!0),this._isSort=!1,this.XLEdit.updateCellWithContainer(ti,l,u,!0))}i.cur.data=n.extend(!0,[],this.getRangeData(l,null,null,null,null,null,!0));this._updateUndoRedoCollection(i)}else{for(o=s.endRow;o>=s.startRow;o--)ct=this.getCell(o,a),t.isNullOrUndefined(ct[0].className.match(vt))||(ht=this._getColorFromFormat(ct[0].className.match(vt)[0]),i.operation==="filterbgcolor"?i.bgcolor===ht[0].toLowerCase()&&it.push(o):i.fgcolor===ht[1].toLowerCase()&&it.push(o));for(ni=[],c=[],st=s.startRow===0?0:s.startRow,f=st;f<=s.endRow;f++){for(et=!1,e=0,lt=it.length;e<lt;e++)it[e]==f&&(et=!0);et?(gt={field:i.columnName,value:n(h[f].cells[a]).text(),predicate:"or",operator:"equal",matchcase:!1},ft=t.Predicate(i.columnName,"equal",n(h[f].cells[a]).text()),this._removeClass(h[f],"e-hide"),this._removeClass(at[f],"e-hide"),this._refreshMergeCells(n(h[f]),"show"),this._filterMergeCells(n(h[f]),"incr"),c.indexOf(f)&&c.splice(c.indexOf(f),1),v.indexOf(f)&&v.splice(v.indexOf(f),1),rowHt=n(h[f]).height(),tt=tt-rowHt,this._refreshFreezeRows(u,f,rowHt,"unhide"),ni.push(gt),y.push(gt),this.getSheet(u)._importRendered||rt||(rt=!rt,this.performSelection({rowIndex:f,colIndex:a},{rowIndex:f,colIndex:a}))):(this._filterMergeCells(n(h[f]),"decr"),rowHt=n(h[f]).height(),tt=tt+rowHt,this._refreshFreezeRows(u,f,rowHt,"hide"),this._refreshMergeCells(n(h[f]),"hide"),this.addClass(h[f],"e-hide"),this.addClass(at[f],"e-hide"),c.indexOf(f)===-1&&c.push(f),v.indexOf(f)===-1&&v.push(f),hiddenRowColl=v.length+ui.length,yt=hiddenRowColl>ot?hiddenRowColl-ot:ot-hiddenRowColl,fi>=yt&&this.model.scrollSettings.allowScrolling&&this.XLScroll._createNewRow(u,-1,-1,"insert"))}if(ct=this.getCell(s.startRow-1,a),this.XLFilter._changeFilterIcon(ct,"filter"),b=y[0],ei=b.from,!t.isNullOrUndefined(value)){for(ft=b.ejpredicate?b.ejpredicate:t.Predicate(b.field,b.operator,b.value,!b.matchcase),e=1;e<y.length;e++)ft=y[e].ejpredicate!=r?ft[y[e].predicate](y[e].ejpredicate):ft[y[e].predicate](y[e].field,y[e].operator,y[e].value,!y[e].matchcase);t.isNullOrUndefined(p[k].predicate[i.columnName])&&(p[k].predicate[i.columnName]={});p[k].filteredColumns=ni;p[k].predicate[i.columnName]=ei?{from:b.from,take:b.take}:ft;p[k].hiddenIdx=n.extend(!0,[],c);c=[]}}}}else{if(kt=i.currentViewData,a=this._generateColCount(i.fieldName)-1,s=i.range,c=p[k].hiddenIdx,i.requestType.indexOf("filtering")>-1||i.requestType.indexOf("filterbycell")>-1||i.action.indexOf("clearfiltering")>-1){for(o=0,ut=kt.length;o<ut;o++)dt.push(s.startRow+g.filterSettings.filteredRange.indexOf(kt[o]));for(st=s.startRow===0?0:s.startRow,f=st;f<=s.endRow;f++){for(et=!1,e=0,lt=dt.length;e<lt;e++)dt[e]==f&&(et=!0);et?(this._removeClass(h[f],"e-hide"),this._removeClass(at[f],"e-hide"),this._refreshMergeCells(n(h[f]),"show"),rowHt=n(h[f]).height(),tt=tt-rowHt,this._filterMergeCells(n(h[f]),"incr"),c.indexOf(f)&&c.splice(c.indexOf(f),1),v.indexOf(f)&&v.splice(v.indexOf(f),1),this._refreshFreezeRows(u,f,rowHt,"unhide"),this.getSheet(u)._importRendered||rt||(rt=!rt,this.performSelection({rowIndex:f,colIndex:a},{rowIndex:f,colIndex:a}))):(this._hasClass(h[f],"e-hide")||(this._filterMergeCells(n(h[f]),"decr"),rowHt=n(h[f]).height(),tt=tt+rowHt,this._refreshFreezeRows(u,f,rowHt,"hide"),this._refreshMergeCells(n(h[f]),"hide")),this.addClass(h[f],"e-hide"),this.addClass(at[f],"e-hide"),c.indexOf(f)===-1&&c.push(f),v.indexOf(f)===-1&&v.push(f),hiddenRowColl=v.length+ui.length,yt=hiddenRowColl>ot?hiddenRowColl-ot:ot-hiddenRowColl,fi>=yt&&this.model.scrollSettings.allowScrolling&&this.XLScroll._createNewRow(u,-1,-1,"insert"))}ci=this.model.sheets[u].columns;i.action==="clearfiltering"&&(this.model.sheets[u]._filteredByColor=-1,this._excelFilter.closeXFDialog())}ri=this._generateColCount(i.fieldName)-1;st=s.startRow===0?0:s.startRow-1;this.XLFilter._updateFilterIcons(st,s.startRow,ri,i.action);p[k].hiddenIdx=n.extend(!0,[],c);c=[]}this._dupDetails=!1;this.model.showRibbon&&this.model.allowFiltering&&(oi=n("#"+this._id+"_Ribbon_clearfilter").data("ejButton"),si=this.getCell(this.getActiveCell().rowIndex,this.getActiveCell().colIndex)[0],this.XLRibbon._changeClrFltrStatus(oi,"button",si));this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(u,"refresh","vertical","filter")},_filterClose:function(){this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")&&(this.XLFilter._isSearchEdit=!1,this._excelFilter.closeXFDialog())},_setModel:function(i){var e,h,y=this.getActiveSheetIndex(),a,f=this.model,u=this._id,o=n("#"+u+"_Ribbon").ejRibbon("instance"),r=o.element,l,s,v,c;for(e in i){f[e]=i[e];switch(e){case"allowClipboard":i[e]?(f.allowFormatPainter&&f.allowCellFormatting||r.find("#"+u+"_Ribbon_home_Clipboard").show(),r.find("#"+u+"_Ribbon_home_Clipboard_1").show(),r.find("#"+u+"_Ribbon_home_Clipboard_cut").show(),r.find("#"+u+"_Ribbon_home_Clipboard_copy").show(),t.isNullOrUndefined(this.XLClipboard)&&(this.XLClipboard=new t.spreadsheetFeatures.clipboard(f))):(f.allowFormatPainter&&f.allowCellFormatting||r.find("#"+u+"_Ribbon_home_Clipboard").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_1").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_cut").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_copy").hide());break;case"activeSheetIndex":this.gotoPage(i[e],!1);break;case"pageSettings":this.isUndefined(i.pageSettings.currentPage)||this.gotoPage(i.pageSettings.currentPage,!1);this.isUndefined(i.pageSettings.pageCount)||(this.getPager().ejPager("option","pageCount",i.pageSettings.pageCount),this._refreshSpreadSheetPager());break;case"allowComments":i[e]?(t.isNullOrUndefined(this.XLComment)&&(this.XLComment=new t.spreadsheetFeatures.comments(f)),o.length&&o.showTab("REVIEW")):o.length&&o.hideTab("REVIEW");break;case"allowFormatPainter":f.allowCellFormatting&&(i[e]?(f.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").show(),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(f)),r.find("#"+u+"_Ribbon_home_Clipboard_formatpainter").show()):(f.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_formatpainter").hide()));break;case"allowHyperlink":i[e]?r.find("#"+u+"_Ribbon_insert_Links").show():r.find("#"+u+"_Ribbon_insert_Links").hide();break;case"enableContextMenu":i[e]&&t.isNullOrUndefined(this.XLCMenu)&&(this.XLCMenu=new t.spreadsheetFeatures.contextmenu(f));break;case"allowEditing":i[e]?(t.isNullOrUndefined(this.XLEdit)&&(this.XLEdit=new t.spreadsheetFeatures.editing(f)),r.find("#"+u+"_Ribbon_home_Editing").show()):r.find("#"+u+"_Ribbon_home_Editing").hide();break;case"allowResizing":i[e]&&t.isNullOrUndefined(this.XLResize)&&(this.XLResize=new t.spreadsheetFeatures.resizing(f));break;case"allowDataValidation":i[e]?(r.find("#"+u+"_Ribbon_data_DataTools").show(),t.isNullOrUndefined(XLValidate)&&(this.XLValidate=new t.spreadsheetFeatures.validation(f))):r.find("#"+u+"_Ribbon_data_DataTools").hide();break;case"allowConditionalFormats":i[e]?(r.find("#"+u+"_Ribbon_home_Styles_cFormat").show(),t.isNullOrUndefined(this.XLCFormat)&&(this.XLCFormat=new t.spreadsheetFeatures.cFormat(f))):r.find("#"+u+"_Ribbon_home_Styles_cFormat").hide();break;case"allowSearching":this.model.allowSearching=i[e];i[e]?(t.isNullOrUndefined(this.XLFndRp)&&(this.XLFndRp=new t.spreadsheetFeatures.findnreplace(f)),r.find("#"+u+"_Ribbon_others_Editing").show()):r.find("#"+u+"_Ribbon_others_Editing").hide();break;case"pictureSettings":for(l in i[e])switch(l){case"allowPictures":f.pictureSettings.allowPictures=i[e][l];i[e][l]?(t.isNullOrUndefined(this.XLShape)&&(this.XLShape=new t.spreadsheetFeatures.shape(f)),r.find("#"+u+"_Ribbon_insert_Illustrations").show()):r.find("#"+u+"_Ribbon_insert_Illustrations").hide()}break;case"showRibbon":this.model.showRibbon=i[e];i[e]?n("#"+u+"_Ribbon").show():n("#"+u+"_Ribbon").hide();break;case"exportSettings":for(h in i[e])switch(h){case"allowExporting":f.exportSettings.allowExporting=i[e][h];i[e][h]?(r.find("#saveas_backStageTab").show(),t.isNullOrUndefined(this.XLExport)&&(this.XLExport=new t.spreadsheetFeatures.exporting(f))):r.find("#saveas_backStageTab").hide();break;case"excelUrl":f.exportSettings.excelUrl=i[e][h];break;case"csvUrl":f.exportSettings.csvUrl=i[e][h]}break;case"allowKeyboardNavigation":i[e]&&t.isNullOrUndefined(this.XLCellNav)&&(this.XLCellNav=new t.spreadsheetFeatures.cellNavigation(f));break;case"allowAutoFill":i[e]&&t.isNullOrUndefined(this.XLDragFill)&&(this.XLDragFill=new t.spreadsheetFeatures.dragFill(f));break;case"allowSelection":i[e]&&t.isNullOrUndefined(this.XLSelection)&&(this.XLSelection=new t.spreadsheetFeatures.selection(f));break;case"allowDragAndDrop":i[e]&&t.isNullOrUndefined(this.XLDragDrap)&&(this.XLDragDrap=new t.spreadsheetFeatures.dragAndDrop(f));break;case"allowCellFormatting":i[e]?((f.allowConditionalFormats||f.allowFormatAsTable)&&r.find("#"+u+"_Ribbon_home_Styles").show(),r.find("#"+u+"_Ribbon_home_Font").show(),r.find("#"+u+"_Ribbon_home_Number").show(),r.find("#"+u+"_Ribbon_home_Alignment_top").show(),r.find("#"+u+"_Ribbon_home_Alignment_middle").show(),r.find("#"+u+"_Ribbon_home_Alignment_bottom").show(),r.find("#"+u+"_Ribbon_separator_bottom").show(),r.find("#"+u+"_Ribbon_home_Alignment_left").show(),r.find("#"+u+"_Ribbon_home_Alignment_center").show(),r.find("#"+u+"_Ribbon_home_Alignment_right").show(),r.find("#"+u+"_Ribbon_separator_right").show(),r.find("#"+u+"_Ribbon_home_Styles_cellstyles").show(),f.allowFormatPainter&&r.find("#"+u+"_Ribbon_home_Clipboard_formatpainter").show(),f.allowClipboard&&r.find("#"+u+"_Ribbon_home_Clipboard").show(),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(f))):(r.find("#"+u+"_Ribbon_home_Font").hide(),r.find("#"+u+"_Ribbon_home_Number").hide(),r.find("#"+u+"_Ribbon_home_Alignment_top").hide(),r.find("#"+u+"_Ribbon_home_Alignment_middle").hide(),r.find("#"+u+"_Ribbon_home_Alignment_bottom").hide(),r.find("#"+u+"_Ribbon_separator_bottom").hide(),r.find("#"+u+"_Ribbon_home_Alignment_left").hide(),r.find("#"+u+"_Ribbon_home_Alignment_center").hide(),r.find("#"+u+"_Ribbon_home_Alignment_right").hide(),r.find("#"+u+"_Ribbon_separator_right").hide(),r.find("#"+u+"_Ribbon_home_Styles_cellstyles").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_formatpainter").hide(),f.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").hide(),f.allowConditionalFormats||f.allowFormatAsTable||r.find("#"+u+"_Ribbon_home_Styles").hide());break;case"allowImport":i[e]?r.find("#new_backStageTab").show():r.find("#new_backStageTab").hide();break;case"importSettings":for(importProp in i[e])switch(h){case"importMapper":f.importSettings.importMapper=i[e][importProp];break;case"importUrl":f.importSettings.importUrl=i[e][importProp];break;case"password":f.importSettings.password=i[e][importProp]}break;case"allowSorting":i[e]?(t.isNullOrUndefined(this.XLSort)&&(this.XLSort=this.XLSort=new t.spreadsheetFeatures.sorting(f)),r.find("#"+u+"_Ribbon_data_SortFilter_1").show(),r.find("#"+u+"_Ribbon_data_Sort").show(),r.find("#"+u+"_Ribbon_home_Editing_1").show()):(r.find("#"+u+"_Ribbon_data_SortFilter_1").hide(),this.model.allowFiltering||(r.find("#"+u+"_Ribbon_data_Sort").hide(),r.find("#"+u+"_Ribbon_home_Editing_1").hide()));case"formatSettings":if(f.allowCellFormatting)for(s in i[e])switch(s){case"allowFontFamily":f.formatSettings.allowFontFamily=i[e][s];i[e][s]?r.find("#"+u+"_Ribbon_home_Font_font-family").show():r.find("#"+u+"_Ribbon_home_Font_font-family").hide();break;case"allowDecimalPlaces":f.formatSettings.allowDecimalPlaces=i[e][s];i[e][s]?(r.find("#"+u+"_Ribbon_home_Number_increment").show(),r.find("#"+u+"_Ribbon_home_Number_decrement").show(),r.find("#"+u+"_Ribbon_separator_usegrouping").show()):(r.find("#"+u+"_Ribbon_home_Number_increment").hide(),r.find("#"+u+"_Ribbon_home_Number_decrement").hide(),r.find("#"+u+"_Ribbon_separator_usegrouping").hide());break;case"allowCellBorder":f.formatSettings.allowCellBorder=i[e][s];i[e][s]?(r.find("#"+u+"_Ribbon_separator_border").show(),r.find("#"+u+"_Ribbon_home_Font_border").show()):(r.find("#"+u+"_Ribbon_separator_border").hide(),r.find("#"+u+"_Ribbon_home_Font_border").hide())}break;case"showGridlines":this.model.showRibbon&&(a=this.element.find("#"+this._id+"_Ribbon_Vgridlines").data("ejCheckBox"),i[e]?a._checked():a._unChecked());this.showGridlines(i[e]);break;case"scrollSettings":v={};t.isNullOrUndefined(i.scrollSettings)||(t.isNullOrUndefined(i.scrollSettings.allowScrolling)||(f.scrollSettings.allowScrolling=i.scrollSettings.allowScrolling),t.isNullOrUndefined(i.scrollSettings.scrollMode)||(f.scrollSettings.scrollMode=i.scrollSettings.scrollMode==="normal"?t.Spreadsheet.scrollMode.Normal:t.Spreadsheet.scrollMode.Infinite),t.isNullOrUndefined(i.scrollSettings.width)||(f.scrollSettings.width=i.scrollSettings.width),t.isNullOrUndefined(i.scrollSettings.height)||(f.scrollSettings.height=i.scrollSettings.height));n.extend(!0,v,this.model.scrollSettings);this._setSheetWidthHeight(y,v);break;case"allowFiltering":i[e]?(r.find("#"+u+"_Ribbon_data_SortFilter_2").show(),r.find("#"+u+"_Ribbon_data_Sort").show(),r.find("#"+u+"_Ribbon_home_Editing_1").show(),t.isNullOrUndefined(this.XLFilter)&&(this.XLFilter=new t.spreadsheetFeatures.filter(f)),this.XLFilter._renderExcelFilter(),this.XLFilter._renderFilterDialogs()):(this.model.allowSorting||(r.find("#"+u+"_Ribbon_data_Sort").hide(),r.find("#"+u+"_Ribbon_home_Editing_1").hide()),r.find("#"+u+"_Ribbon_data_SortFilter_2").hide());break;case"allowInsert":i[e]?(f.allowDelete||r.find("#"+u+"_Ribbon_others_Cells").show(),r.find("#"+u+"_Ribbon_others_Cells_1").show()):(f.allowDelete||r.find("#"+u+"_Ribbon_others_Cells").hide(),r.find("#"+u+"_Ribbon_others_Cells_1").hide());break;case"allowDelete":i[e]?(f.allowInsert||r.find("#"+u+"_Ribbon_others_Cells").show(),r.find("#"+u+"_Ribbon_others_Cells_2").show()):(f.allowInsert||r.find("#"+u+"_Ribbon_others_Cells").hide(),r.find("#"+u+"_Ribbon_others_Cells_2").hide());break;case"allowFreezing":i[e]?(t.isNullOrUndefined(this.XLFreeze)&&(this.XLFreeze=new t.spreadsheetFeatures.freezepane(f)),r.find("#"+u+"_Ribbon_others_Window").show()):r.find("#"+u+"_Ribbon_others_Window").hide();break;case"allowMerging":i[e]?r.find("#"+u+"_Ribbon_home_Alignment_merge").show():r.find("#"+u+"_Ribbon_home_Alignment_merge").hide();break;case"freezeFirstColumn":case"allowWrap":i[e]?r.find("#"+u+"_Ribbon_home_Alignment_wraptext").show():r.find("#"+u+"_Ribbon_home_Alignment_wraptext").hide();break;case"allowUndoRedo":i[e]?r.find("#"+u+"_Ribbon_home_Actions").show():r.find("#"+u+"_Ribbon_home_Actions").hide();case"freezeLeftColumn":this.XLFreeze.freezeLeftColumn(y);this.XLFreeze._updateFPaneMenu("freeze");break;case"freezeRows":case"allowFormatAsTable":i[e]?(f.allowPivotTable||r.find("#"+u+"_Ribbon_insert_Tables").show(),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(f)),r.find("#"+u+"_Ribbon_home_Styles_formatastable").show(),r.find("#"+u+"_Ribbon_insert_Tables_table").show()):(f.allowPivotTable||r.find("#"+u+"_Ribbon_insert_Tables").hide(),r.find("#"+u+"_Ribbon_home_Styles_formatastable").hide(),r.find("#"+u+"_Ribbon_insert_Tables_table").hide());break;case"freezeColumns":case"allowPivotTable":i[e]?(f.allowFormatAsTable||r.find("#"+u+"_Ribbon_insert_Tables").show(),r.find("#"+u+"_Ribbon_insert_Tables_pivotTable").show()):(f.allowFormatAsTable||r.find("#"+u+"_Ribbon_insert_Tables").hide(),r.find("#"+u+"_Ribbon_insert_Tables_pivotTable").hide());break;case"allowAutoSum":i[e]?r.find("#"+u+"_Ribbon_home_Editing_autosum").show():r.find("#"+u+"_Ribbon_home_Editing_autosum").hide();break;case"allowCharts":i[e]?((t.isNullOrUndefined(this.XLChart)||t.isNullOrUndefined(this.XLShape))&&(this.XLShape=new t.spreadsheetFeatures.shape(f)),this.XLChart=new t.spreadsheetFeatures.chart(f),r.find("#"+u+"_Ribbon_insert_Charts").show()):r.find("#"+u+"_Ribbon_insert_Charts").hide();break;case"allowSortandFilter":case"printSettings":for(c in i[e])switch(c){case"allowPrinting":f.printSettings.allowPrinting=i[e][c];i[e][c]?(this.XLPrint=new t.spreadsheetFeatures.print(f),r.find("#"+u+"_Ribbon_pagelayout_Print").show(),r.find("#print_backStageTab").show()):(r.find("#print_backStageTab").show(),r.find("#"+u+"_Ribbon_pagelayout_Print").hide());break;case"allowPageSize":f.printSettings.allowPageSize=i[e][c];i[e][c]?r.find("#"+u+"_Ribbon_pagelayout_PageLayout").show():r.find("#"+u+"_Ribbon_pagelayout_PageLayout").hide()}}}o.length&&(f.allowAutoSum||f.allowFiltering||f.allowUndoRedo||f.allowSorting||f.allowClipboard||f.allowFormatPainter||f.allowCellFormatting||f.allowMerging||f.allowWrap||f.allowConditionalFormats||f.allowFormatAsTable?o.showTab("HOME"):o.hideTab("HOME"),f.allowFormatAsTable||f.allowPictures||f.allowHyperlink||f.allowCharts?o.showTab("INSERT"):o.hideTab("INSERT"),f.allowDataValidation||f.allowFiltering||f.allowSorting?o.showTab("DATA"):o.hideTab("DATA"),f.allowPrinting?o.showTab("PAGELAYOUT"):o.hideTab("PAGELAYOUT"),f.allowComments?o.showTab("REVIEW"):o.hideTab("REVIEW"),f.allowFreezing||f.allowInsert||f.allowDelete||f.allowSearching?o.showTab("OTHERS"):o.hideTab("OTHERS"))},"import":function(t){if(this.model.allowImport){var i=this;i.importSheet=i._initialLoad?!1:!0;i.showWaitingPopUp();n.ajax({type:"POST",data:t,processData:!1,contentType:!1,async:!1,url:i.model.importSettings.importMapper,success:function(n){i._importSuccess(n);i.importSheet=!1},error:function(n,t){i._importFailed({type:t,xhr:{status:n.status,statusText:n.statusText}})}});i.hideWaitingPopUp()}},_importSuccess:function(n){if(this.model.allowImport){var t=["UnsupportedFile","IncorrectPassword","InvalidUrl"];switch(n){case t[0]:case t[1]:case t[2]:this._showAlertDlg("Alert",n,"",null,110);break;default:this.loadFromJSON(JSON.parse(n))}}},loadFromJSON:function(n){var r,f=1,o,s,t,i,e,h=this._getWorkbookMaxRowColCnt(n.model.sheets,!0),u;if(n.dataContainer.sharedData.length<50001&&h.rowCount<10001&&h.colCount<126){for(this._rowCount=this.model.rowCount,this._colCount=this.model.columnCount,s=n.dataContainer.hashCode,this._initialLoad||this._destroy(),this.model.sheetCount=n.model.sheetCount,this._updateImportedSheetModel(n.model),this.model.sheets.splice(0,0,{}),this.model.activeSheetIndex=n.model.activeSheetIndex,this._renderSheets(),this._importedCondFormat=n.dataContainer.cFormatData,this._importedValData=n.dataContainer.valData,n.dataContainer.cFormatData=[],n.dataContainer.hashCode=this._dataContainer.hashCode,n.dataContainer.valData=[],this._dataContainer=n.dataContainer,this.XLFormat._formatAsTableStyle=this.XLFormat._getTableLayoutFromName("TableStyleLight1"),this._updateImportedStyles(s),this._updateNameManager(n.model.nameManager),f=n.model.sheets.length;f--;)if(t=n.model.sheets[f],i=this.getSheet(f),t.usedRange){for(i._importRendered=!0,r=0;r<t.columnsWidthCollection.length;r++)this.isUndefined(t.columnsWidthCollection[r])||(i.columnsWidthCollection[r]=t.columnsWidthCollection[r]);for(r=0;r<t.rowsHeightCollection.length;r++)this.isUndefined(t.rowsHeightCollection[r])||(i.rowsHeightCollection[r]=t.rowsHeightCollection[r]);i._shapeMngr=t._shapeMngr;t._mergedCells&&(i._mergedCells=t._mergedCells);e=this.getRangeIndices(t.usedRange);i._usedRange={rowIndex:e[2],colIndex:e[3]};t._tableManager&&(i._tableManager=t._tableManager);t.filterSettings.range&&(i.filterSettings.range=t.filterSettings.range);i.hideRowsCollection=t.hideRowsCollection;i.hideColsCollection=t.hideColsCollection;(t._frozenRows||t._frozenColumns)&&(i._frozenRows=t._frozenRows,i._frozenColumns=t._frozenColumns);t.showHeader||(i.showHeader=t.showHeader);t.showGridlines||(i.showGridlines=t.showGridlines)}this.gotoPage(this.model.activeSheetIndex,!1);o=this.getCell(this.getActiveCell().rowIndex,this.getActiveCell().colIndex)[0];this.XLRibbon._toggleDesignTab(o);this.model.showRibbon&&this.XLRibbon._enableRibbonIcons();this.XLComment._isCommentEdit=!1;this.clearUndoRedo();this._trigger("loadComplete",{model:this.model});u=this.getSheet(this.model.activeSheetIndex);u._importRendered=!0;(u._frozenRows||u._frozenColumns)&&this._setFreezePane(u._frozenRows,u._frozenColumns);u._importRendered=!1;this._detachTable=null;this.model.rowCount=this._rowCount;this.model.columnCount=this._colCount}else this._showAlertDlg("Alert","HugeDataAlert")},_importFailed:function(n){var t={failureType:n.type};n.xhr?(t.status=n.xhr.status,t.statusText=n.xhr.statusText):t.statusText=n.error;this.hideWaitingPopUp();this._trigger("openFailure",t)},_updateImportedSheets:function(n){var i,u,t=this.getSheet(n),r={rowIndex:0,colIndex:0};this._setRowColumnSize(t);i=[0,0,t._usedRange.rowIndex,t._usedRange.colIndex];u=this.getRangeData(i,!1,["value","value2","format","hyperlink","comment","border","picture","wrap","isMerge","mRange","isCenterAlign"]);this._updateImportedData(u,i);this._updateConditionalFormats();this._updateDataValidation();this._updateImportedChart(t._shapeMngr.chart);this._updateImportedTable(t._tableManager);t.filterSettings.range.length&&this.XLFilter._filterCellRange(n,t.filterSettings.range);this._updateHiddenRowsandColumns(t);t._activeCell=r;t.showHeader||this.showHeaders(t.showHeader);t.showGridlines||this.showGridlines(t.showGridlines);this.importSheet||this.XLSelection.selectRange(r,r)},_updateImportedMergedCells:function(n){n._mergedCells=n._mergedCells;for(var t=0,i=n._mergedCells.length;t<i;t++)n._mergedCells[t].isCenterAlign&&(this._mergeCenter=!0),this.mergeCells(n._mergedCells[t].range,!0),this._mergeCenter=!1;n._mergedCell=[]},_updateImportedData:function(i,r,u,f){u=u?u:this.getActiveSheetIndex();r=r?r:this.getSheet(u).selectedRange;var a=this.getRows(u)[0],v,p=n(this._getJSSheetHeader(u).find("colgroup")[0].outerHTML).attr("id","ss"),c=t.buildTag("table#wrapTable.e-table",{});c.append(p);this._detachTable=this._getContent(u).find(".e-content >table");v=this._detachTable[0].tBodies[0].rows;this._detachTable.detach();this.element[0].insertBefore(c[0],this.element[0].childNodes[0]);for(var h,s,e,o,y=this.getRange(r[0],r[1],r[2],r[3],u),l=0,w=y.length;l<w;)o=y[l],s=o.parentNode.rowIndex,h=o.cellIndex,e=i[l],this.XLEdit._updateDataContainer(o,{value:this.XLEdit._parseValue(e.value).value},u),this.isFormula(e.value)?this.XLEdit._refreshCalcEngine(s,h,!0,e.value):(o.innerHTML=e.value2||"",this.XLEdit._refreshCellAlignment(o,e.value),this.XLEdit._refreshCalcEngine(s,h)),f||(o.className=o.className+(e.format?" "+e.format:""),e.hyperlink&&("cellAddr"in e.hyperlink?n(o).html(t.buildTag("a",e.value2,"",{href:"#"})):n(o).html(t.buildTag("a",e.value2,"",{href:e.hyperlink.webAddr,target:"_blank"}))),e.comment&&this.XLComment.setComment(o,null,!1),e.border&&this.XLFormat.applyBorder(this._getBorderInput(e.border),this._getAlphaRange(u,o.parentNode.rowIndex,o.cellIndex,o.parentNode.rowIndex,o.cellIndex)),e.picture&&this.XLShape._copyImages(o,e.picture,u),e.isMerge&&(e.isCenterAlign&&(this._mergeCenter=!0),this.mergeCells(e.mRange,!0),this._mergeCenter=!1),e.wrap&&this._setWrapTextForImport(u,s,h,v)),h===r[3]&&this._wrapRow&&(this._setWrapHeight(u,s,v,a,c,"hide"),this._hasClass(a[s],"e-sswraprow")||this.addClass(a[s],"e-sswraprow"),this._wrapRow=!1),l++;c.remove();this._getContent(u).find(".e-content").append(this._detachTable);f||this.XLComment._updateCmntArrowPos()},_updateImportedStyles:function(n){for(var r,t,i=0,u=n.length;i<u;)t=n[i],t.indexOf("e-format")===-1?this._dataContainer.hashCode.push(t):(r=this.XLFormat.getFormatFromHashCode(t),this.XLFormat._createFormatClass(r)),i++},_updateImportedTable:function(n){var i,r,t,u=this.getObjectLength(n);if(u)while(u--)t=n[u],i=t.range,r=this.XLFormat._getTableLayoutFromName(t.formatName),r||(r=this.XLFormat._formatAsTableStyle,t.formatName=r.formatName),this.XLFormat.createTable({header:!0,name:t.name,format:r.format,formatName:t.formatName},this._getAlphaRange(this.getActiveSheetIndex(),i[0],i[1],i[2],i[3]))},_updateConditionalFormats:function(){for(var n,r=this.getActiveSheetIndex(),i=this._importedCondFormat.length,t=0;t<i;t++)n=this._importedCondFormat[t].split("_"),idx=Number(n[4]),idx===r&&(this.XLCFormat._cFormat(n[0],n[1],n[2],n[3],null,idx,this.getRangeIndices(n[5])),this._importedCondFormat.splice(t,1),i=this._importedCondFormat.length,t--)},_updateImportedSheetModel:function(n){for(var t,i=1,r=this.model.sheets,u=n.sheets.length;i<u;)t=n.sheets[i],r.push({sheetName:t._sheetName.text,rowCount:t.rowCount||this.model.rowCount,colCount:t.colCount||this.model.columnCount}),i++},_setRowColumnSize:function(n){var r=[],i=n.columnsWidthCollection,t=i.length;if(t){while(t--)i[t]!==64&&r.push({cellIndex:t,width:i[t]});this.setWidthToColumns(r)}if(i=n.rowsHeightCollection,t=i.length,r=[],t){while(t--)i[t]>20&&r.push({rowIndex:t,height:i[t]});this.setHeightToRows(r)}},setHeightToRows:function(t){for(var u=this,r=u.getActiveSheetIndex(),f=u._getJSSheetRowHeaderContent(r),e=f.find(".e-table")[0].tBodies[0],o=e.rows,s=u._getJSSheetContent(r).find(".e-content > .e-table")[0].tBodies[0].rows,i=0,h=t.length;i<h;i++)n(o[t[i].rowIndex]).outerHeight(t[i].height),n(s[t[i].rowIndex]).height(t[i].height);this.XLScroll._getRowHeights(r,1);this.XLScroll._refreshScroller(r,"refresh","vertical")},_updateNameManager:function(t){t=t||[];var i=t.length;if(i){while(i--)this.XLRibbon._updateNamedRanges(t[i].name,t[i].refersto);n("#"+this._id+"_nmgrid").ejGrid("option",{dataSource:t});this.model.nameManager=t;this.XLRibbon._updateUseInFormulaTrgt()}},_setFreezePane:function(n,t){n&&t?this.XLFreeze.freezePanes({rowIndex:n,colIndex:t}):n?this.XLFreeze.freezeRows(n):t&&this.XLFreeze.freezeColumns(t)},_updateHiddenRowsandColumns:function(n){var i=n.hideRowsCollection,t=i.length;if(t)while(t--)this._hideRow(i[t],i[t]);if(i=n.hideColsCollection,t=i.length,t)while(t--)this._hideColumn(i[t],i[t])},_updateImportedChart:function(n){for(var i,r,f,t,u=0,e=n.length;u<e;)t=n[u],i=this.getSheet(t.dataSheetIdx),t.dataSheetIdx!=this.getActiveSheetIndex()&&i._importRendered&&(r=this.getRangeIndices(i._usedRange),f=this.getRangeData(r,!1,["value","value2"],t.dataSheetIdx),this._updateImportedData(f,r,t.dataSheetIdx,!0)),this.XLChart.createChart(t.range,{type:t.commonSeriesOptions.type,enable3D:t.enable3D,marker:t.commonSeriesOptions.marker,top:t.top,left:t.left,heigth:t.size.height,width:t.size.width,title:t.title,legend:t.legend,primaryYAxis:t.primaryYAxis,primaryXAxis:t.primaryXAxis,dataSheetIdx:t.dataSheetIdx,_id:t.dummyId}),u++},_getBorderInput:function(n){n=n.split("_");for(var t=4,i={},r=["top","right","bottom","left"];t--;)n[t].length&&(i[r[t]]=n[t]);return i},_refreshHashCode:function(n){n=n||this._dataContainer.hashCode;for(var t,i=n.length;i--;)t=n[i],t.indexOf("e-format")===-1&&t.indexOf("e-border")===-1&&(n[i]="")},clearUndoRedo:function(){this._undoCollection=[];this._redoCollection=[];this._updateUndoRedoIcons()},_initializePicture:function(n){this._getContent(n).find(".e-content").append(t.buildTag("div.e-ss-imgvisual"))},_getShapePositionInManager:function(n,t,i,r){for(var o=this.getActiveSheetIndex(),f=this._dataContainer.sheets[o][n][t],u=0,e=f.length;u<e;u++)if(f[r][u].id===i)break;return u},_swapVal:function(n){var t=n.prev;n.prev=n.cur;n.cur=t},_updateDataValidation:function(){for(var n,i,u=this.getActiveSheetIndex(),r=this._importedValData.length,t=0;t<r;t++)n=this._importedValData[t].split("_"),i=Number(n[n.length-1]),i===u&&(this._importedValData[t].indexOf("list")===-1?this.XLValidate.applyDVRules(n[5],[this._getValue(this.XLRibbon._actions,n[1]),n[2],n[3]],n[4],n[0]==="1"?!0:!1,!0):this.XLValidate.applyDVRules(n[3],["list",n[1]],"list",n[0]==="1"?!0:!1,!0),this._importedValData.splice(t,1),r=this._importedValData.length,t--)},_getValue:function(n,t){for(var i,r=n.length;r--;)if(i=n[r],i.value===t)return i.value},setUndoRedoSteps:function(n){this._undoredoStep=n},_undoRedoOperation:function(t){if((t.which===90||t.keyCode===90)&&t.ctrlKey)if(t.preventDefault(),n(t.target).is(":input")){if(n(t.target).val()!==this._cureditedCell){var i=n(t.target).val();n(t.target).val(this._cureditedCell);this._getInputBox().val(this._cureditedCell);this._undoInputobj={value:i,rowIndex:n(t.target).parents("tr")[0].rowIndex,colIndex:n(t.target).parents("td")[0].cellIndex}}}else this._isUndo=!0,this._performUndoRedo();else(t.which===89||t.keyCode===89)&&t.ctrlKey&&(t.preventDefault(),n(t.target).is(":input")?n(t.target).parents("td")[0].cellIndex===this._undoInputobj.colIndex&&n(t.target).parents("tr")[0].rowIndex===this._undoInputobj.rowIndex&&(n(t.target).val(this._undoInputobj.value),this._getInputBox().val(this._undoInputobj.value)):(this._isUndo=!1,this._performUndoRedo()))},_performUndoRedo:function(){var n=this._isUndo?this._undoCollection.pop():this._redoCollection.pop(),i;if(!t.isNullOrUndefined(n)){n.sheetIndex!==this.getActiveSheetIndex()&&this.gotoPage(n.sheetIndex,null);this._isUndoRedo=!0;switch(n.reqType){case"auto-fill":this._undoForAutoFill(n);break;case"auto-sum":this._undoForAutoSum(n);break;case"cell-format":this._undoForFormat(n);break;case"cell-styles":this._undoForStyle(n);break;case"clear-all":this._undoForClAll(n);break;case"clear-comment":this._undoForClComment(n);break;case"clear-content":this._undoForClContent(n);break;case"clear-format":this._undoForClFormat(n);break;case"clear-link":this._undoForCLLink(n);break;case"comment":this._undoForComment(n);break;case"cond-format":this._undoForCondFormat(n);break;case"copy-paste":this._undoForCopyPaste(n);break;case"cut-paste":this._undoForCutPaste(n);break;case"delete":this._undoForDel(n);break;case"edit":this._undoForEdit(n);break;case"filter":this._undoForFilter(n);break;case"filterbycolor":this._undoForFilterByColor(n);break;case"find-replace":this._undoForFind(n);break;case"format-painter":this._undoForFormatPaint(n);break;case"format-table":this._undoForFormatTable(n);break;case"hyperlink":this._undoForHyperlink(n);break;case"insert":this._undoForIns(n);break;case"merge-cells":this._undoForMerge(n);break;case"paging":i=n.nSheetIndex;n.nSheetIndex=n.sheetIndex;n.sheetIndex=i;break;case"pivotgrid":this._undoForPivot(n);break;case"resize-column":this._undoForResizeCol(n);break;case"resize-row":this._undoForResizeRow(n);break;case"resize-fit-height":this._undoForResizeFHeight(n);break;case"resize-fit-width":this._undoForResizeFWidth(n);break;case"reorder-cells":this._undoForReOrder(n);break;case"show-hide":this._undoForShowHide(n);break;case"shape":this._undoForShape(n);break;case"sort":this._undoForSort(n);break;case"sortbycolor":this._undoForSortByColor(n);break;case"textwrap":this._undoForTextWrap(n);break;case"validation":this._undoForValidation(n)}this._isUndo?this._redoCollection.push(n):this._undoCollection.push(n);this._undoCollection.length>this._undoredoStep&&this._undoCollection.splice(0,1);this._redoCollection.length>this._undoredoStep&&this._redoCollection.splice(0,1);this._updateUndoRedoIcons();this.XLRibbon._updateRibbonIcons();this._isUndoRedo=!1;this._isUndo=!1;n.reqType!="shape"&&this.XLSelection._refreshBorder()}},_undoForAutoFill:function(t){var i=this.getSheet(t.sheetIndex);this._isUndo?(this.clearRangeData(t.range),this.model.allowCellFormatting&&this.XLFormat.updateFormat(t.bFormat,t.range),this.updateData(n.extend(!0,[],t.bData),t.range),t.actionType=="flash-fill"&&this.updateData(n.extend(!0,[],t.bdData),t.bRange),t.colSel?this.XLSelection.selectColumns(i._startCell.colIndex,i._endCell.colIndex):t.rowSel?this.XLSelection.selectRows(i._startCell.rowIndex,i._endCell.rowIndex):this.performSelection({rowIndex:t.bRange[0],colIndex:t.bRange[1]},{rowIndex:t.bRange[2],colIndex:t.bRange[3]})):(this.model.allowCellFormatting&&this.XLFormat.updateFormat(t.aFormat,t.range),this.updateData(n.extend(!0,[],t.aData),t.range),t.actionType=="flash-fill"&&this.updateData(n.extend(!0,[],t.adData),t.bRange),this.performSelection({rowIndex:t.bRange[0],colIndex:t.bRange[1]},{rowIndex:t.range[2],colIndex:t.range[3]}))},_undoForAutoSum:function(n){var u=this._dataContainer.sheets[n.sheetIndex],i,t,r;if(this._isUndo)for(t=0,r=n.updCell.length;t<r;t++)i=this.getCell(n.updCell[t].rowIndex,n.updCell[t].colIndex,n.sheetIndex),this._clearFormula(n.updCell[t].rowIndex,n.updCell[t].colIndex),u[n.updCell[t].rowIndex][n.updCell[t].colIndex]=n.updCell[t].pObj,i.text(n.updCell[t].pValue);else this.XLRibbon.autoSum(n.oprType,n.range)},_undoForClAll:function(i){var f,u,o,e=this.model.sheets[i.sheetIndex],r,s;for(this._isUndo?(this.updateData(n.extend(!0,[],i.bData),i.range),this.model.allowCellFormatting&&this.XLFormat.updateFormat(i.bFormat,i.range),this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(i.range)):(this.model.allowCellFormatting&&this.XLFormat.clearFormat(i.range),this.model.allowConditionalFormats&&this.XLCFormat.clearCF(!0,i.range),this.clearRangeData(i.range)),r=0,s=i.selCells.length;r<s;r++)f=this.getCell(i.selCells[r].rowIndex,i.selCells[r].colIndex,i.sheetIndex)[0],i.selCells[r].prevComment&&(this._isUndo?(this.XLEdit._updateDataContainer(f,{comment:i.selCells[r].prevComment}),n(f).removeClass("e-commentcell"),this.model.allowComments&&this.XLComment.setComment(f,null,!1)):(this.model.allowComments&&this.XLComment.deleteComment([i.selCells[r].rowIndex,i.selCells[r].colIndex,i.selCells[r].rowIndex,i.selCells[r].colIndex],"clear"),n(f).removeClass("e-commentcell"))),i.selCells[r].prevLink&&this._isUndo&&(this.XLEdit._updateDataContainer(f,{hyperlink:i.selCells[r].prevLink}),t.isNullOrUndefined(i.selCells[r].prevLink.webAddr)?n(f).html(t.buildTag("a.e-hyperlinks",i.selCells[r].prevText,"",{href:"#"})):n(f).html(t.buildTag("a.e-hyperlinks",i.selCells[r].prevText,"",{href:i.selCells[r].prevLink.webAddr,target:"_blank"}))),i.selCells[r].mRange&&(this._isUndo?(this._dupDetails=!0,i.selCells[r].mergeCenter&&(this._mergeCenter=!0),this.mergeCells(i.selCells[r].mRange),this._mergeCenter=!1,this._dupDetails=!1):(this._dupDetails=!0,this.unmergeCells(i.selCells[r].mRange),this._dupDetails=!1)),i.selCells[r].wrap&&(this._dupDetails=!0,this.setWrapText(this._getAlphaRange(i.sheetIndex,i.selCells[r].rowIndex,i.selCells[r].colIndex,i.selCells[r].rowIndex,i.selCells[r].colIndex)),this._dupDetails=!1);if(i.tabId>-1)if(this._isUndo)e._tableManager[i.tabId]=i.tableObj,u=e._tableManager[i.tabId].range,this.performSelection({rowIndex:u[0],colIndex:u[1]},{rowIndex:u[2],colIndex:u[3]}),this.element.find(".e-selected").addClass("e-table"+i.tabId),this.XLFilter._filterTable(i.sheetIndex,i.tabId);else{for(u=e._tableManager[i.tabId].range,o=e.filterSettings.tableRange,this.performSelection({rowIndex:u[0],colIndex:u[1]},{rowIndex:u[2],colIndex:u[3]}),this.element.find(".e-selected").removeClass("e-filterhdr e-table"+i.tabId),delete e._tableManager[i.tabId],r=0,s=o.length;r<s;r++)if(o[r].tableID===i.tabId){o.splice(r,1);break}this.XLRibbon._toggleDesignTab()}},_undoForClComment:function(n){var u,i,f,e,t,o;if(f={rowIndex:n.selCells[0].rowIndex,colIndex:n.selCells[0].colIndex},e={rowIndex:n.selCells[n.selCells.length-1].rowIndex,colIndex:n.selCells[n.selCells.length-1].colIndex},this._isUndo)for(t=0,o=n.selCells.length;t<o;t++)i={rowIndex:n.selCells[t].rowIndex,colIndex:n.selCells[t].colIndex},u=this.getCell(n.selCells[t].rowIndex,n.selCells[t].colIndex),this.XLEdit._updateDataContainer(u[0],{comment:n.selCells[t].prevComment}),this.XLSelection.selectRange(i,i),this.XLComment.setComment(this.getCell(n.selCells[t].rowIndex,n.selCells[t].colIndex),null,!1),this.XLComment._updateCurCmntVal();else this.XLSelection.selectRange(f,e),this.XLComment.deleteComment(r,"clear");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForClContent:function(i){var f=this.getRange(i.range[0],i.range[1],i.range[2],i.range[3]),r,u;if(this._isUndo){if(this.updateData(n.extend(!0,[],i.bData),i.range),i.bData.length)for(r=0,len=f.length;r<len;r++)!t.isNullOrUndefined(i.bData[r])&&i.bData[r].hyperlink&&(hldata=i.bData[r].hyperlink,hldata&&(hldata.webAddr?f.eq(r).html(t.buildTag("a",i.bData[r].value,"",{href:hldata.webAddr,target:"_blank","class":"e-hyperlinks"})):f.eq(r).html(t.buildTag("a",i.bData[r].value,"",{href:"#","class":"e-hyperlinks"}))))}else this.clearRangeData(i.range,["value","value2"]);for(r=i.range[0];r<i.range[2]+1;r++)for(u=i.range[1];u<i.range[3]+1;u++)this.model.allowComments&&this.XLComment._updateCmntFrmCntnr(r,u)},_undoForClFormat:function(n){var r,i=n.wRange.length>n.hRange.length+1?n.wRange.length:n.hRange.length,u,t;for(i=i>n.cFormatRule.length+1?i:n.cFormatRule.length,this.model.allowCellFormatting&&(this._isUndo?this.XLFormat.updateFormat(n.bFormat,n.range):this.XLFormat.clearFormat(n.range)),t=0;t<i;t++)n.wRange[t]&&(r=this._getAlphaRange(n.sheetIndex,n.wRange[t].rowIndex,n.wRange[t].colIndex,n.wRange[t].rowIndex,n.wRange[t].colIndex),this._isUndo?this.setWrapText(r):this.setWrapText(r,"unwrap")),n.hRange[t]&&(u=this.getCell(n.hRange[t].rowIndex,n.hRange[t].colIndex),this._isUndo?u.find("a").css({color:"#428bca","text-decoration":"underline"}).addClass("e-hyperlinks"):u.find("a").css({color:"#444445","text-decoration":"none"}).removeClass("e-hyperlinks")),this.model.allowConditionalFormats&&n.cFormatRule[t].rule&&(this._isUndo?this.XLCFormat.setCFRule(n.cFormatRule[t].rule):(this.performSelection({rowIndex:n.cFormatRule[t].rowIndex,colIndex:n.cFormatRule[t].colIndex},{rowIndex:n.cFormatRule[t].rowIndex,colIndex:n.cFormatRule[t].colIndex}),this.XLCFormat.clearCF(!0)))},_undoForCLLink:function(n){var f={rowIndex:n.selCells[0].rowIndex,colIndex:n.selCells[0].colIndex},e,u,o={rowIndex:n.selCells[n.selCells.length-1].rowIndex,colIndex:n.selCells[n.selCells.length-1].colIndex},i,r;if(this.setActiveCell(n.selCells[0].rowIndex,n.selCells[0].colIndex),this.XLSelection.selectRange(f,o),this._isUndo)for(i=0,r=n.selCells.length;i<r;i++)n.selCells[i].prevLink&&(u=this.getCell(n.selCells[i].rowIndex,n.selCells[i].colIndex),n.selCells[i].prevLink.webAddr?u.html(t.buildTag("a.e-hyperlinks",n.selCells[i].prevText,"",{href:n.selCells[i].prevLink.webAddr,target:"_blank"})):u.html(t.buildTag("a.e-hyperlinks",n.selCells[i].prevText,"",{href:"#"})));else this._removeHyperlink("clear",n.selCells);for(this.XLSelection.selectRange(f,o),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),i=0,r=n.selCells.length;i<r;i++)e=n.selCells[i].prevLink,n.selCells[i].prevLink=n.selCells[i].curLink,n.selCells[i].curLink=e},_undoForComment:function(t){var u,r,e,o,f,i,s;for(e={rowIndex:t.selCells[0].rowIndex,colIndex:t.selCells[0].colIndex},o={rowIndex:t.selCells[t.selCells.length-1].rowIndex,colIndex:t.selCells[t.selCells.length-1].colIndex},i=0,s=t.selCells.length;i<s;i++)r={rowIndex:t.selCells[i].rowIndex,colIndex:t.selCells[i].colIndex},u=this.getCell(t.selCells[i].rowIndex,t.selCells[i].colIndex),this.XLSelection.selectRange(r,r),this.getSheet(t.sheetIndex)._startCell=r,t.action==="add"?(t.selCells[i].prevComment=this.XLEdit.getPropertyValueByElem(u,"comment"),this.XLComment.deleteComment()):t.action==="edit"?(n(u.find(".e-comment-txtarea")).val(t.selCells[i].prevComment.value),this.XLComment._updateCurCmntVal(),f=t.selCells[i].prevComment,t.selCells[i].prevComment=t.selCells[i].curComment,t.selCells[i].curComment=f):(this.XLEdit._updateDataContainer(u[0],{comment:t.selCells[i].prevComment}),this.XLComment.setComment(this.getCell(t.selCells[i].rowIndex,t.selCells[i].colIndex),null,!1),this.XLSelection.selectRange(r,r),this.XLComment._updateCurCmntVal(),f=t.selCells[i].prevComment,t.selCells[i].prevComment=t.selCells[i].curComment,t.selCells[i].curComment=f);t.action==="add"?t.action="delete":t.action==="delete"&&(t.action="add");this.XLSelection.selectRange(e,o);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForCondFormat:function(i){var u,c,f,a,s,l,r,e=[],h,o;if(this._isUndo){if(i.action==="add"){for(o=this.getRange(i.range[0],i.range[1],i.range[2],i.range[3]),l=this.XLEdit.getPropertyValueByElem(n(o[0]),"cFormatRule"),i.poppedRule=l[l.length-1],u=0,f=o.length;u<f;u++)if(h=this.XLEdit.getPropertyValueByElem(n(o[u]),"cFormatRule"),!this.isUndefined(h))for(h.pop(),c=0,a=h.length;c<a;c++)s=h[c],e.length===0?(r=s.indexOf("true")>-1?s.replace("_true",""):s.replace("_false",""),e.push(r)):e=this._addCondFormatRule(e,s);for(o.removeClass("e-redft e-yellowft e-greenft e-redf e-redt"),this.clearRangeData(null,["cFormatRule"],o),u=0,f=e.length;u<f;u++)r=e[u].split("_"),this.XLCFormat._cFormat(r[0],r[2],r[3],r[4],r[5])}else if(i.action==="clear")for(u=0,f=i.rule.length;u<f;u++)this.XLCFormat.setCFRule(i.rule[u][0])}else i.action==="add"?t.isNullOrUndefined(i.poppedRule)||(r=i.poppedRule.split("_"),this.XLCFormat._cFormat(r[0],r[2],r[3],r[4],r[5])):i.action==="clear"&&this.XLCFormat.clearCF(i.selection)},_undoForCopyPaste:function(i){var f={},h=this._dataContainer,c=this.getSheet(i.pSheetIndex)._shapeMngr,e,k,y,u,p,w,g,a,d,b,nt,tt,s,it,rt,v,o,l;if(i.operation==="shape")a=this.getCell(i.pasteCell.rowIndex,i.pasteCell.colIndex,i.pSheetIndex)[0],k=i.pShapeId.indexOf("picture")>-1?"picture":"chart",c[k].some(function(n,t){return i.pShapeId===n.id?(y=t,!0):!1}),e=n.extend(!0,{},i.pasteCell.obj),t.isNullOrUndefined(e)||(this.XLShape._picCellIdx={rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},k==="chart"?"chart"in e&&(this._isUndo?(f=n.extend(!0,{},c.chart[y]),t.isNullOrUndefined(h.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(h.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),h.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=e,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+f.id))):(this.getCell(i.pasteCell.rowIndex,i.pasteCell.colIndex,i.pSheetIndex).addClass("e-activecell"),f=n.extend(!0,{},c.chart[y]),s=f.range,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,s[0],s[1],s[2],s[3]),f),this.XLSelection.selectRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]},i.cSheetIndex))):"picture"in e&&(this._isUndo?(f=n.extend(!0,{},c.picture[y]),t.isNullOrUndefined(h.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(h.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),h.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=e,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+f.id))):(f=n.extend(!0,{},c.picture[y]),b=this._id+"_picture",this.XLChart._shapeCnt++,this.XLShape._createPicture(i.pSheetIndex,a,c.sharedPics[f.data],f.top,f.left,f.width,f.height,parseInt(f.id.replace(b,""))))));else{for(h=this._dataContainer,d=[],u=0,w=i.text.length;u<w;u++)for(p=0,g=i.text[u].split("\t").length;p<g;p++)d.push(i.text[u].split("\t")[p]);for(this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),this.setActiveSheetIndex(i.pSheetIndex),u=0,w=i.pasteCells.length;u<w;u++)if(a=this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex)[0],a!==r){if(a.textContent=this._isUndo?"":d[u],e=t.isNullOrUndefined(h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex])?{}:h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex],this._isUndo||"isMerge"in i.pasteCells[u].prevObj&&(this._mergeCenter=i.pasteCells[u].prevObj.isCenterAlign,this.mergeCells(i.pasteCells[u].prevObj.mRange,!0)),!t.isNullOrUndefined(e)){if("picture"in e)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[u].rowIndex,colIndex:i.pasteCells[u].colIndex},o=0,l=e.picture.length;o<l;o++)f=n.extend(!0,{},c.picture[e.picture[o]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+f.id));if("chart"in e)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[u].rowIndex,colIndex:i.pasteCells[u].colIndex},o=0,l=e.chart.length;o<l;o++)f=n.extend(!0,{},c.chart[e.chart[o]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+f.id));"isMerge"in e&&this._isUndo&&(i.pasteCells[u].newObj=n.extend(!0,{},h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex]),this.unmergeCells(this._getAlphaRange(i.pSheetIndex,i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex)),this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex).removeAttr("rowspan").removeAttr("colspan"),"isMerge"in i.pasteCells[u].prevObj&&(this._mergeCenter=i.pasteCells[u].prevObj.isCenterAlign,this.mergeCells(i.pasteCells[u].prevObj.mRange,!0),this._mergeCenter=!1))}if(t.isNullOrUndefined(h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex])&&(h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex]={}),h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex]=n.extend(!0,{},i.pasteCells[u].prevObj),it=i.pasteCells[u].prevObj,i.pasteCells[u].prevObj=i.pasteCells[u].newObj,i.pasteCells[u].newObj=it,this._setRowHdrHeight(i.pSheetIndex,n(a).parent().index()),e=t.isNullOrUndefined(h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex])?{}:h.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex],nt=i.pasteCells[u].rowIndex,tt=i.pasteCells[u].colIndex,this._applyCommentLink(e,a,nt,tt),this._isPaste=!0,!t.isNullOrUndefined(e)){if("picture"in e)for(o=0,l=e.picture.length;o<l;o++)f=n.extend(!0,{},c.picture[e.picture[o]]),b=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.pSheetIndex,a,c.sharedPics[f.data],f.top,f.left,f.width,f.height,parseInt(f.id.replace(b,"")));if("chart"in e){for(s=e.chart[0].range,this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex).addClass("e-activecell"),o=0,l=e.chart.length;o<l;o++)f=n.extend(!0,{},c.chart[e.chart[o]]),this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.pSheetIndex,s[0],s[1],s[2],s[3]),f);this.XLSelection.selectRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]},i.pSheetIndex)}this._isPaste=!1}}if(i.isSpecial&&(this.model.allowCellFormatting&&(this.XLFormat.clearFormat(i.pasteBorder.range,"format"),this.isUndefined(i.pasteBorder.prevBorder)||this.XLFormat.updateFormat(i.pasteBorder.prevBorder,i.pasteBorder.range,"format")),rt=i.pasteBorder.prevBorder,i.pasteBorder.prevBorder=i.pasteBorder.newBorder,i.pasteBorder.newBorder=rt),!t.isNullOrUndefined(i.pfat))for(v=i.pfat.ptable,o=0,l=v.length;o<l;o++)t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this._isUndo?this.XLFormat.removeTable(n.trim(v[o].name.replace("Table",""))):(v[o].header=!0,this.XLFormat.createTable(v[o],v[o].range)));t.isNullOrUndefined(i.filter)||(this.XLFilter.clearFilter(),this.XLFilter.filter(details.filter));this._isUndo?(t.isNullOrUndefined(i.cSheetIndex)||this.setActiveSheetIndex(i.cSheetIndex),i.cutCells.length>0&&this.XLSelection._focusBorder(i.cutCells[0],i.cutCells[i.cutCells.length-1],this._cutFocus),this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])):(t.isNullOrUndefined(i.cSheetIndex)||this.setActiveSheetIndex(i.cSheetIndex),i.cutCells.length>0&&this.XLSelection._focusBorder(i.cutCells[0],i.cutCells[i.cutCells.length-1],this._cutFocus),this.setActiveSheetIndex(i.pSheetIndex),i.pasteCells.length>0&&this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1]))}this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForCutPaste:function(i){var f,o={},c=this._dataContainer,l=this.getSheet(i.pSheetIndex)._shapeMngr,v,y,w,ut,ft,b,d,g,nt,a,rt,u,tt,it,et,s,e,h,ct,lt,at;if(i.operation==="shape")a=this.getCell(i.pasteCell.rowIndex,i.pasteCell.colIndex,i.pSheetIndex)[0],y=i.pShapeId.indexOf("picture")>-1?"picture":"chart",l[y].some(function(n,t){return i.pShapeId===n.id?(w=t,!0):!1}),f=n.extend(!0,{},i.pasteCell.obj),t.isNullOrUndefined(f)||(this.XLShape._picCellIdx={rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},o=n.extend(!0,{},l[y][w]),t.isNullOrUndefined(c.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(c.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),c.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=f,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+o.id))),f=n.extend(!0,{},i.cutCell.obj),y=i.cShapeId.indexOf("picture")>-1?"picture":"chart",l[y].some(function(n,t){return i.cShapeId===n.id?(w=t,!0):!1}),t.isNullOrUndefined(f)||(this.getCell(i.cutCell.rowIndex,i.cutCell.colIndex,i.cSheetIndex).addClass("e-activecell"),y==="chart"?"chart"in f&&(o=n.extend(!0,{},l.chart[w]),s=o.range,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,s[0],s[1],s[2],s[3]),o),this.XLSelection.selectRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]},i.cSheetIndex)):"picture"in f&&(a=this.getCell(i.cutCell.rowIndex,i.cutCell.colIndex,i.cSheetIndex)[0],o=n.extend(!0,{},l.picture[w]),v=this._id+"_picture",this._isUndo?!(this.XLChart._shapeCnt===1)&&this.XLChart._shapeCnt--:this.XLChart._shapeCnt++,this.XLShape._createPicture(i.cSheetIndex,a,l.sharedPics[o.data],o.top,o.left,o.width,o.height,parseInt(o.id.replace(v,""))))),this.XLShape._picCellIdx={rowIndex:i.cutCell.rowIndex,colIndex:i.cutCell.colIndex},ut=i.pasteCell,i.pasteCell=i.cutCell,i.cutCell=ut,ft=i.pShapeId,i.pShapeId=i.cShapeId,i.cShapeId=ft;else{for(c=this._dataContainer,rt=[],this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),u=0,it=i.text.length;u<it;u++)for(tt=0,et=i.text[u].split("\t").length;tt<et;tt++)rt.push(i.text[u].split("\t")[tt]);for(u=0,it=i.pasteCells.length;u<it;u++){if(!t.isNullOrUndefined(i.pSheetIndex)&&(a=this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex)[0],a!==r)){if(a.textContent="",this.isUndefined(c.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex])||(f=c.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex]),!this.isUndefined(f)){if("picture"in f)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[u].rowIndex,colIndex:i.pasteCells[u].colIndex},e=0,h=f.picture.length;e<h;e++)o=n.extend(!0,{},l.picture[f.picture[e]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+o.id));if("chart"in f)for(this.XLShape._picCellIdx={rowIndex:i.pasteCells[u].rowIndex,colIndex:i.pasteCells[u].colIndex},e=0,h=f.chart.length;e<h;e++)o=n.extend(!0,{},l.chart[f.chart[e]]),this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+o.id));"isMerge"in f&&(this._isUndo?(n.extend(!0,i.pasteCells[u].newObj,c.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex]),this.setActiveSheetIndex(i.pSheetIndex),this.unmergeCells(f.mRange),this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex).removeAttr("rowspan").removeAttr("colspan"),"isMerge"in i.pasteCells[u].prevObj&&(this._mergeCenter=i.pasteCells[u].prevObj.isCenterAlign,this.mergeCells(i.pasteCells[u].prevObj.mRange,!0),this._mergeCenter=!1)):(this.setActiveSheetIndex(i.pSheetIndex),this.unmergeCells(f.mRange,!0),"isMerge"in i.pasteCells[u].prevObj&&(this._mergeCenter=i.pasteCells[u].prevObj.isCenterAlign,this.mergeCells(i.pasteCells[u].prevObj.mRange,!0),this._mergeCenter=!1),this.setActiveSheetIndex(i.cSheetIndex),this.unmergeCells(this._getAlphaRange(i.pSheetIndex,i.cutCells[u].rowIndex,i.cutCells[u].colIndex,i.cutCells[u].rowIndex,i.cutCells[u].colIndex)),s=this.getRangeIndices(i.cutCells[u].prevObj.mRange),this.XLSelection.selectRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]},i.sheetIndex)))}if(this.isUndefined(c.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex])&&(c.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex]={}),c.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex]=n.extend(!0,{},i.pasteCells[u].prevObj),d=i.pasteCells[u].prevObj,i.pasteCells[u].prevObj=i.pasteCells[u].newObj,i.pasteCells[u].newObj=d,this._setRowHdrHeight(i.pSheetIndex,n(a).parent().index()),f=c.sheets[i.pSheetIndex][i.pasteCells[u].rowIndex][i.pasteCells[u].colIndex],g=i.pasteCells[u].rowIndex,nt=i.pasteCells[u].colIndex,this._applyCommentLink(f,a,g,nt),this._isPaste=!0,!t.isNullOrUndefined(f)){if("picture"in f)for(e=0,h=f.picture.length;e<h;e++)o=n.extend(!0,{},l.picture[f.picture[e]]),v=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.pSheetIndex,a,l.sharedPics[o.data],o.top,o.left,o.width,o.height,parseInt(o.id.replace(v,"")));if("chart"in f){for(this.getCell(i.pasteCells[u].rowIndex,i.pasteCells[u].colIndex,i.pSheetIndex).addClass("e-activecell"),e=0,h=f.chart.length;e<h;e++)o=n.extend(!0,{},l.chart[f.chart[e]]),s=o.range,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,s[0],s[1],s[2],s[3]),o);this.XLSelection.selectRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]},i.pSheetIndex)}}this._isPaste=!1}if(!t.isNullOrUndefined(i.cSheetIndex)&&(b=this.getCell(i.cutCells[u].rowIndex,i.cutCells[u].colIndex,i.cSheetIndex)[0],!t.isNullOrUndefined(b))){if(b.textContent=rt[u],this.setActiveSheetIndex(i.cSheetIndex),f=t.isNullOrUndefined(c.sheets[i.cSheetIndex][i.cutCells[u].rowIndex])?{}:c.sheets[i.cSheetIndex][i.cutCells[u].rowIndex][i.cutCells[u].colIndex],!t.isNullOrUndefined(f)){if("picture"in f)for(this.XLShape._picCellIdx={rowIndex:i.cutCells[u].rowIndex,colIndex:i.cutCells[u].colIndex},e=0,h=f.picture.length;e<h;e++)o=n.extend(!0,{},l.picture[f.picture[e]]),this.XLShape._deleteShape(i.cSheetIndex,this.element.find("#"+o.id));if("chart"in f)for(this.XLShape._picCellIdx={rowIndex:i.cutCells[u].rowIndex,colIndex:i.cutCells[u].colIndex},e=0,h=f.chart.length;e<h;e++)o=n.extend(!0,{},l.chart[f.chart[e]]),this.XLShape._deleteShape(i.cSheetIndex,this.element.find("#"+o.id))}if(t.isNullOrUndefined(c.sheets[i.cSheetIndex][i.cutCells[u].rowIndex])&&(c.sheets[i.cSheetIndex][i.cutCells[u].rowIndex]={}),c.sheets[i.cSheetIndex][i.cutCells[u].rowIndex][i.cutCells[u].colIndex]=n.extend(!0,{},i.cutCells[u].prevObj),d=i.cutCells[u].prevObj,i.cutCells[u].prevObj=i.cutCells[u].newObj,i.cutCells[u].newObj=d,this._setRowHdrHeight(i.cSheetIndex,n(b).parent().index()),f=t.isNullOrUndefined(c.sheets[i.cSheetIndex][i.cutCells[u].rowIndex])?{}:c.sheets[i.cSheetIndex][i.cutCells[u].rowIndex][i.cutCells[u].colIndex],g=i.cutCells[u].rowIndex,nt=i.cutCells[u].colIndex,this._applyCommentLink(f,b,g,nt),this._isPaste=!0,!t.isNullOrUndefined(f)){if("picture"in f)for(e=0,h=f.picture.length;e<h;e++)o=n.extend(!0,{},l.picture[f.picture[e]]),v=this._id+"_picture",this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLShape._createPicture(i.cSheetIndex,a,l.sharedPics[o.data],o.top,o.left,o.width,o.height,parseInt(o.id.replace(v,"")));if("chart"in f){for(this.getCell(i.cutCells[u].rowIndex,i.cutCells[u].colIndex,i.cSheetIndex).addClass("e-activecell"),e=0,h=f.chart.length;e<h;e++)o=n.extend(!0,{},l.chart[f.chart[e]]),s=o.range,this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,this.XLChart.createChart(this._getAlphaRange(i.cSheetIndex,s[0],s[1],s[2],s[3]),o);this.XLSelection.selectRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]},i.cSheetIndex)}"isMerge"in f&&(this._mergeCenter=f.isCenterAlign,this.mergeCells(f.mRange,!0),this._mergeCenter=!1)}this._isPaste=!1}}if(i.isSpecial&&(this.model.allowCellFormatting&&!t.isNullOrUndefined(i.pSheetIndex)&&(this.setActiveSheetIndex(i.pSheetIndex),this.XLFormat.clearFormat(i.pasteBorder.range,"format"),this.isUndefined(i.pasteBorder.prevBorder)||this.XLFormat.updateFormat(i.pasteBorder.prevBorder,i.pasteBorder.range,"format")),nBrdr=i.pasteBorder.prevBorder,i.pasteBorder.prevBorder=i.pasteBorder.newBorder,i.pasteBorder.newBorder=nBrdr,this.model.allowCellFormatting&&!t.isNullOrUndefined(i.cSheetIndex)&&(this.setActiveSheetIndex(i.cSheetIndex),this.XLFormat.clearFormat(i.cutBorder.range,"format"),this.isUndefined(i.pasteBorder.prevBorder)||this.XLFormat.updateFormat(i.cutBorder.prevBorder,i.cutBorder.range,"format")),nBrdr=i.cutBorder.prevBorder,i.cutBorder.prevBorder=i.cutBorder.newBorder,i.cutBorder.newBorder=nBrdr),!t.isNullOrUndefined(i.pfat)){var ot,p=i.pfat.table,k,st=i.pfat.minRowIdx,ht=i.pfat.minColIdx;for(s=i.pfat.range,e=0,h=p.length;e<h;e++)k=p[e].range,t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLFormat.removeTable(n.trim(p[e].tblObj.name.replace("Table","")))),t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this._isUndo?this.XLFormat.createTable(p[e].tblObj,p[e].range):(ot=this.getRangeIndices(this._getAlphaRange(i.cSheetIndex,k[0]+st-s[0],k[1]+ht-s[1],st-s[0]+k[2],ht-s[1]+k[3])),this.XLFormat.createTable(p[e].tblObj,ot)))}t.isNullOrUndefined(i.filter)||(this.XLFilter.clearFilter(),this.XLFilter.filter(details.filter));this._isUndo?(t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLSelection.selectRange(i.cutCells[0],i.cutCells[i.cutCells.length-1])),t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1]))):(t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection._focusBorder(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1],this._cutFocus),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])),t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLSelection.selectRange(i.cutCells[0],i.cutCells[i.cutCells.length-1])));this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();ct=i.pasteCells;i.pasteCells=i.cutCells;i.cutCells=ct;lt=i.pasteBorder;i.pasteBorder=i.cutBorder;i.cutBorder=lt;at=i.cSheetIndex;i.cSheetIndex=i.pSheetIndex;i.pSheetIndex=at}},_undoForDel:function(t){n.extend(!0,this._delCells,t.delCells);this._deletedText=n.extend(!0,[],t.text);switch(t.action){case"deleteShiftUp":this.deleteShiftUp(t.startCell,t.endCell);break;case"deleteShiftLeft":this.deleteShiftLeft(t.startCell,t.endCell);break;case"deleteRow":this.deleteEntireRow(t.startCell,t.endCell);break;case"deleteColumn":this.deleteEntireColumn(t.startCell,t.endCell)}},_undoForEdit:function(r){var o,s,e,h=r.cFormatRule,f={rowIndex:r.rowIndex,colIndex:r.colIndex},c,u=this.getCell(r.rowIndex,r.colIndex),a=u.find("a").css("text-decoration"),l;if(this.setActiveCell(r.rowIndex,r.colIndex,r.sheetIndex),this.XLSelection.selectRange(f,f),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),l=u.find("a"),l.length>0&&(r.action=u.text().length<1?"add":"delete",r.reqType="edit",f.prevLink=this.XLEdit.getPropertyValueByElem(u,"hyperlink"),f.prevText=u.text(),r.selCells=[]),n(".e-selected.e-commentcell").length>0&&(c=this.XLEdit.getPropertyValueByElem(u,"comment")),this.XLEdit.updateCellValue(u,r.pValue),this._dupDetails=!0,h&&h.length)for(i=0,len=h.length;i<len;i++)e=h[i].split("_"),this.XLCFormat._cFormat(e[0],e[2],e[3],e[4],e[5]);this._dupDetails=!1;s=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"hyperlink",r.sheetIndex);s&&(s.webAddr?u.html(t.buildTag("a",u.text(),"",{href:s.webAddr,target:"_blank","class":"e-hyperlinks"})):u.html(t.buildTag("a",u.text(),"",{href:"#","class":"e-hyperlinks"})));u.find("a").css("text-decoration",a);l.length>0&&(f.curLink=this.XLEdit.getPropertyValueByElem(u,"hyperlink"),f.curText=u.text(),r.selCells.push(f));t.isNullOrUndefined(c)||(this.XLEdit._updateDataContainer(u[0],{comment:c}),u.removeClass("e-commentcell"),this.XLComment.setComment(),this.XLComment._updateCurCmntVal());this._setRowHdrHeight(r.sheetIndex,u.parent().index());o=r.cValue;r.cValue=r.pValue;r.pValue=o;this.XLEdit._isEdit=!1;o=r.previousValue;r.previousValue=r.value;r.value=o},_undoForFilter:function(i){var c=!1,o=[],u,a,e=[],l,s,v,r,f,h;if(i.operation==="filter"&&i.requestType!=="filterbycell")if(this._isUndo){for(r=this._undoCollection.length-1;r>=0;r--){if(this._undoCollection[r].reqType==="filter"&&this._undoCollection[r].tableID===i.tableID&&this._undoCollection[r].action==="filtering"&&this._undoCollection[r].status!=="apply-filterIcon"){for(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],u=this._undoCollection[r],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,u.tableID),r=0,f=u.filterCollection.length;r<f;r++)o.push(u.filterCollection[r]);this.model.sheets[u.sheetIndex].filterSettings.filteredColumns=o;t.isNullOrUndefined(this._excelFilter._predicates[u.sheetIndex][u.fieldName])&&(this._excelFilter._predicates[u.sheetIndex][u.fieldName]={});this._excelFilter._predicates[u.sheetIndex][u.fieldName]=u.ejpredicate;this.model.sheets[u.sheetIndex]._selectedRange=u.range;this.XLFilter._filterHandler(u);l="undo";c=!0;break}if(this._undoCollection[r].requestType==="filterbycell"){u=this._undoCollection[r];delete this._excelFilter._predicates[u.sheetIndex][u.fieldName];this.XLFilter._clearFilterColumn(u.fieldName,"","","Or",null,null,u.tableID);n.extend(!0,e,u.selCells);this.XLFilter._filterActiveCell(u.sheetIndex,u.activeCell,e,u.filteredValue);l="undo";c=!0;break}}c||(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID))}else{for(o=[],delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),r=0,f=i.filterCollection.length;r<f;r++)o.push(i.filterCollection[r]);this.model.sheets[i.sheetIndex].filterSettings.filteredColumns=o;t.isNullOrUndefined(this._excelFilter._predicates[i.sheetIndex][i.fieldName])&&(this._excelFilter._predicates[i.sheetIndex][i.fieldName]={});this._excelFilter._predicates[i.sheetIndex][i.fieldName]=i.ejpredicate;i.filterCollection.length&&this.XLFilter._filterHandler(i);l="redo"}else if(this._isUndo){if(i.operation==="apply-filter"&&i.requestType!=="filterbycell")for(r=0,f=i.filteredCells.length;r<f;r++)i.filteredCells[r].find(".e-ssfilter").remove(),this._removeClass(i.filteredCells[r][0],"e-filterhdr"),(this.isNumber(i.filteredCells[r].text())||this.XLEdit._parseValue(i.filteredCells[r].text()).type==="datetime"||this.XLEdit._parseValue(i.filteredCells[r].text()).type==="currency"||this.XLEdit._parseValue(i.filteredCells[r].text()).type==="percentage")&&i.filteredCells[r].addClass(this._rAlign);if(i.requestType==="filterbycell"){if(!this.isUndefined(i.filteredCells))for(r=0,f=i.filteredCells.length;r<f;r++)i.filteredCells[r].find(".e-ssfiltered, .e-ssfilter").remove(),this._removeClass(i.filteredCells[r][0],"e-filterhdr"),(this.isNumber(i.filteredCells[r].text())||this.XLEdit._parseValue(i.filteredCells[r].text()).type==="datetime"||this.XLEdit._parseValue(i.filteredCells[r].text()).type==="currency"||this.XLEdit._parseValue(i.filteredCells[r].text()).type==="percentage")&&i.filteredCells[r].addClass(this._rAlign);delete this._excelFilter._predicates[i.sheetIndex][i.fieldName];this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID)}if(this.model.sheets[i.sheetIndex].filterSettings.range="",i.operation==="apply-filter"&&i.requestType!="filterbycell"||i.requestType==="filterbycell"&&!this.isUndefined(i.filteredCells)){for(s=this.model.sheets[i.sheetIndex].filterSettings.tableRange,r=0,f=s.length;r<f;r++)if(s[r].tableID===i.tableID){v=r;break}i.filterRange=s.splice(v,1)[0]}if(i.operation==="remove-filter"){for(r=0,f=i.filteredCells.length;r<f;r++)h=this.XLFilter._getFilterIcon(),this.XLFilter._applyFilterIcon(i.filteredCells[r],h),i.filteredCells[r].removeClass(this._rAlign);this.model.sheets[i.sheetIndex].filterSettings.range=i.fRange;this.model.sheets[i.sheetIndex].filterSettings.tableRange.push(i.filterRange)}}else if(i.operation==="remove-filter"&&(i.requestType==="filterbycell"?(a=this.getCell(i.activeCell.rowIndex,i.activeCell.colIndex),a.find("span.e-ssfilter").remove(),delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),n.extend(!0,e,i.selCells),this.XLFilter._filterActiveCell(i.sheetIndex,i.activeCell,e,i.filteredValue)):this.XLFilter.clearFilter("remove")),i.operation==="filter"&&i.requestType==="filterbycell"&&(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),n.extend(!0,e,i.selCells),this.XLFilter._filterActiveCell(i.sheetIndex,i.activeCell,e,i.filteredValue)),i.operation==="apply-filter"){for(r=0,f=i.filteredCells.length;r<f;r++)h=this.XLFilter._getFilterIcon(),this.XLFilter._applyFilterIcon(i.filteredCells[r],h),i.filteredCells[r].removeClass(this._rAlign);this.model.sheets[i.sheetIndex].filterSettings.range=i.fRange;this.model.sheets[i.sheetIndex].filterSettings.tableRange.push(i.filterRange)}},_undoForFilterByColor:function(n){var i,r=[],t;for(r.push(n),i=this._isUndo?this._undoCollection:r,delete this._excelFilter._predicates[n.sheetIndex][n.columnName],this.XLFilter._clearFilterColumn(n.columnName,"","","Or",null,null,n.tableID),t=i.length-1;t>=0;t--)if(i[t].reqType==="filterbycolor"&&i[t].tableID===n.tableID){this.XLFilter._filterHandler(i[t]);break}},_undoForFind:function(n){var i,t,r,u;switch(n.operation){case"replace":i=this.getCell(n.rowIndex,n.colIndex,n.sheetIndex);this.XLEdit.updateCell(i,n.prevData.value,n.sheetIndex);i.text(n.prevData.value);u=n.prevData;n.prevData=n.newData;n.newData=u;this.XLSelection.selectRange({rowIndex:n.rowIndex,colIndex:n.colIndex},{rowIndex:n.rowIndex,colIndex:n.colIndex});break;case"replaceAll":for(t=0,r=n.selCells.length;t<r;t++)i=this.getCell(n.selCells[t].rowIndex,n.selCells[t].colIndex,n.selCells[t].sheetIndex),this.XLEdit.updateCell(i,n.selCells[t].prevData.value,n.selCells[t].sheetIndex),i.text(n.selCells[t].prevData.value),u=n.selCells[t].prevData,n.selCells[t].prevData=n.selCells[t].newData,n.selCells[t].newData=u;break;case"blanks":case"conditions":case"validations":case"formulas":case"rowdiff":case"coldiff":case"comments":case"constants":for(t=0,r=n.selCells.length;t<r;t++)i=this.getCell(n.selCells[t].rowIndex,n.selCells[t].colIndex,n.sheetIndex),this._isUndo?i.operation==="coldiff"||i.operation==="rowdiff"?n.selCells[t].isApply?i.removeClass("e-selected"):i.addClass("e-selected"):n.selCells[t].isApply?i.addClass("e-selected"):i.removeClass("e-selected"):i.removeClass("e-selected")}},_undoForFormat:function(n){var h=[],c,r,e,o=this._dataContainer,f,u,i,s;if(t.isNullOrUndefined(n.process))for((t.isNullOrUndefined(n.action)||n.action!=="decimal")&&(this.XLFormat.clearFormat(n.range),this.XLFormat.updateFormat(n.beforeFormat,n.range),u=n.beforeFormat,n.beforeFormat=n.afterFormat,n.afterFormat=u),c={startCell:n.selCell[0],endCell:n.selCell[n.selCell.length-1]},i=0,s=n.selCell.length;i<s;i++)r=n.selCell[i],e=this.getCell(r.rowIndex,r.colIndex),t.isNullOrUndefined(o.sheets[n.sheetIndex][r.rowIndex])||t.isNullOrUndefined(o.sheets[n.sheetIndex][r.rowIndex][r.colIndex])||(o.sheets[n.sheetIndex][r.rowIndex][r.colIndex]=n.selCell[i].beforeFormat,f=this.XLEdit.getPropertyValueByElem(e,"value2"),h.push({data:f}),e[0].innerHTML=t.isNullOrUndefined(f)?"":f),n.selCell[0].colIndex===n.selCell[i].colIndex&&this.model.allowResizing&&(this._isUndo?this.XLResize.setRowHeight(n.selCell[i].rowIndex,n.selCell[i].bRowHeight):this.XLResize.setRowHeight(n.selCell[i].rowIndex,n.selCell[i].aRowHeight)),u=n.selCell[i].beforeFormat,n.selCell[i].beforeFormat=n.selCell[i].afterFormat,n.selCell[i].afterFormat=u;!t.isNullOrUndefined(n.process)&&n.process.indexOf("border")>-1&&(this.XLFormat.clearFormat(n.range),this.XLFormat.updateFormat(n.beforeFormat,n.range),u=n.beforeFormat,n.beforeFormat=n.afterFormat,n.afterFormat=u);n.status="undo-cellformat"},_undoForFormatPaint:function(t){for(var u,r,f=this._formatRegx,e=this._borderRegx,i=0,o=t.selCells.length;i<o;i++)r=this.getCell(t.selCells[i].rowIndex,t.selCells[i].colIndex)[0],r.className.indexOf("e-format")&&(r.className=r.className.replace(f,"")),n(r).addClass(t.selCells[i].bFormat),r.className.indexOf("e-border")&&(r.className=r.className.replace(e,"")),n(r).addClass(t.selCells[i].bBorder),n(r).text(t.selCells[i].bVal),n(r).data(t.selCells[i].bData),u=t.selCells[i].bFormat,t.selCells[i].bFormat=t.selCells[i].aFormat,t.selCells[i].aFormat=u,u=t.selCells[i].bBorder,t.selCells[i].bBorder=t.selCells[i].aBorder,t.selCells[i].aBorder=u,u=t.selCells[i].bData,t.selCells[i].bBorder=t.selCells[i].aData,t.selCells[i].aBorder=u,u=t.selCells[i].bVal,t.selCells[i].bVal=t.selCells[i].aVal,t.selCells[i].aVal=u},_undoForFormatTable:function(i){var u,h,s,o,e=i.sheetIndex,r=this.getSheet(e)._tableManager,l,p=this,f=i.header,c,w,a,v,y;switch(i.action){case"convertorange":if(this._isUndo){for(r[i.tableID]={name:"Table"+i.tableID,range:i.beforeRange,format:i.format,formatName:i.formatName},this.XLFilter._filterCellRange(e,this._getProperAlphaRange(e,r[i.tableID].range[0],r[i.tableID].range[1],r[i.tableID].range[2],r[i.tableID].range[3])),c=r[i.tableID].range[1],w=r[i.tableID].range[3]+1;c<w;c++)for(u=r[i.tableID].range[0],h=r[i.tableID].range[2]+1;u<h;u++)this.getCell(u,c,e).addClass("e-table"+i.tableID).find("span").addClass("e-ft"+i.tableID);this.model.sheets[e].filterSettings.tableRange[i.tableID]=i.tableRange;r[i.tableID].isFilter=i.isFilter;r[i.tableID].firstColumn=i.firstColumn;r[i.tableID].lastColumn=i.lastColumn;r[i.tableID].totalRow=i.totalRow}else i.tableID in r&&(l="e-table"+i.tableID,p.element.find("."+l).removeClass(l),p.XLFilter._clearFilterTable(e,i.tableID),delete r[i.tableID],delete this.model.sheets[e]._header[i.tableID]);break;case"filtericon":a=n("#"+i.id).data("ejCheckBox");i.check?a.option("checked",!1):a.option("checked",!0);i.check=!i.check;this.XLFilter._clearFilterTableIcon(i.sheetIndex,parseInt(i.tableId));break;case"firstlastcolumn":v=n("#"+i.id).data("ejCheckBox");i.check?(this.XLFormat.format({style:{"font-weight":"normal"}},i.range),v.option("checked",!1)):(this.XLFormat.format({style:{"font-weight":"bold"}},i.range),v.option("checked",!0));i.check=!i.check;break;case"totalrow":y=n("#"+i.id).data("ejCheckBox");i.check?(this.XLEdit.updateCellValue(n(i.cell[0]),i.pcells[0].value2),this.XLEdit.updateCellValue(n(i.cell[i.cell.length-1]),i.pcells[1].value2),"totalRow"in i.tmgr[i.tid]&&delete i.tmgr[i.tid].totalRow,y.option("checked",!1)):(this.XLEdit.updateCellValue(n(i.cell[0]),"Total"),this.XLEdit.updateCellValue(n(i.cell[i.cell.length-1]),"=SUBTOTAL("+r[i.tid].fnNumber+", "+i.range+")"),i.tmgr[i.tid].totalRow=!0,y.option("checked",!0));i.check=!i.check;break;case"resizetable":this._isUndo?(this._isFATResize=!0,this.XLFormat.removeTable(i.tableId),this.XLFormat.clearFormat(i.afterRange),s=i.beforeRange[3]-i.beforeRange[1]+1,o=f[i.tableId].header?this.getRangeData(i.beforeRange):this.getRangeData(i.beforeRange).splice(s,this.getRangeData(i.beforeRange).length),this.clearRangeData(i.beforeRange),f[i.tableId].header?this.updateData(o,[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2],i.beforeRange[3]]):this.updateData(o,[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2]-1,i.beforeRange[3]]),r[i.tableId]={header:f[i.tableId].header,name:"Table"+i.tableId,range:i.beforeRange,format:i.format,formatName:i.formatName},f[i.tableId].header?this.XLFormat.createTable(r[i.tableId],i.beforeRange):this.XLFormat.createTable(r[i.tableId],[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2]-1,i.beforeRange[3]])):(this._isFATResize=!0,this.XLFormat.removeTable(i.tableId),this.XLFormat.clearFormat(i.beforeRange),s=i.beforeRange[3]-i.beforeRange[1]+1,o=f[i.tableId].header?this.getRangeData(i.afterRange):this.getRangeData(i.afterRange).splice(s,this.getRangeData(i.afterRange).length),this.clearRangeData(i.afterRange),f[i.tableId].header?this.updateData(o,i.afterRange):this.updateData(o,[i.afterRange[0],i.afterRange[1],i.afterRange[2]-1,i.afterRange[3]]),r[i.tableId]={header:f[i.tableId].header,name:"Table"+i.tableId,range:i.beforeRange,format:i.format,formatName:i.formatName},f[i.tableId].header?this.XLFormat.createTable(r[i.tableId],i.afterRange):this.XLFormat.createTable(r[i.tableId],[i.afterRange[0],i.afterRange[1],i.afterRange[2]-1,i.afterRange[3]]));break;default:if(this._isUndo){if(this.XLFormat.removeTable(i.tableID),this.XLFormat.clearFormat(i.afterRange),i.tableStyle.header)for(u=0,h=i.beforeRangeHeader.length;u<h;u++)t.isNullOrUndefined(i.beforeRangeHeader[u].value2)?this.XLEdit.updateCellValue(n(i.pcells[u]),""):this.isNumber(i.pcells[u].innerHTML)&&this.XLEdit._refreshCellAlignment(i.pcells[u]);else s=i.afterRange[3]-i.afterRange[1]+1,this.clearRangeData(i.afterRange),this.updateData(n.extend(!0,[],i.beforeRangeData),i.afterRange);this.XLFormat.updateFormat(i.beforeFormat,i.afterRange)}else r[i.tableID]={name:"Table"+i.tableID,range:i.beforeRange},this.XLFormat.createTable(i.tableStyle,i.beforeRange)}},_undoForHyperlink:function(n){var i={rowIndex:n.selCells[n.selCells.length-1].rowIndex,colIndex:n.selCells[n.selCells.length-1].colIndex},r={rowIndex:n.selCells[0].rowIndex,colIndex:n.selCells[0].colIndex},t,u,f,e;for(this.setActiveCell(n.selCells[0].rowIndex,n.selCells[0].colIndex),this.XLSelection.selectRange(r,i),n.action==="add"?(this.XLSelection.selectRange(r,i),this._removeHyperlink(n.reqType,n.selCells)):n.action==="edit"?(this.XLSelection.selectRange(r,i),this._setLink(n.selCells)):(this.XLSelection.selectRange(r,i),this._setLink(n.selCells)),t=0,u=n.selCells.length;t<u;t++)f=n.selCells[t].prevLink,n.selCells[t].prevLink=n.selCells[t].curLink,n.selCells[t].curLink=f,e=n.selCells[t].prevText,n.selCells[t].prevText=n.selCells[t].curText,n.selCells[t].curText=e;n.action==="add"?n.action="delete":n.action==="delete"&&(n.action="add");this.XLSelection.selectRange(r,i);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForIns:function(t){n.extend(!0,this._delCells,t.delCells);n.extend(!0,this._deletedText,t.text);switch(t.action){case"insertShiftRight":this.insertShiftRight(t.startCell,t.endCell);break;case"insertShiftBottom":this.insertShiftBottom(t.startCell,t.endCell);break;case"insertRow":this.insertEntireRow(t.startCell,t.endCell);break;case"insertColumn":this.insertEntireColumn(t.startCell,t.endCell)}},_undoForMerge:function(n){var r,u,e,o,i,f;this._delCells=n.hideCells;this._selMergeCells=[];switch(n.action){case"merge-all":case"merge-across":case"un-merge":for(i=0,f=n.mCells.length;i<f;i++)n.action==="un-merge"?t.isNullOrUndefined(n.mCells[i].prevObj.mRange)||(r=this.getRangeIndices(n.mCells[i].prevObj.mRange),u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),this._mergeCenter=n.mCells[i].prevObj.isCenterAlign,this._mergeCells(n.sheetIndex,u,{},[])):(e=this._getHiddenRowColumnCount(n.sheetIndex,n.mCells[i].curObj.mRange),this._unMergeAllCells(n.sheetIndex,i,n.mCells,[],e.hRow,e.hCol)),o=n.mCells[i].prevObj,n.mCells[i].prevObj=n.mCells[i].curObj,n.mCells[i].curObj=o;if(n.action!=="un-merge")for(i=0,f=n.mCells.length;i<f;i++)t.isNullOrUndefined(n.mCells[i].curObj)||t.isNullOrUndefined(n.mCells[i].curObj.mRange)||(r=this.getRangeIndices(n.mCells[i].curObj.mRange),u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),this._mergeCenter=n.mCells[i].curObj.isCenterAlign,this._mergeCells(n.sheetIndex,u,{},[]));n.action=n.action==="un-merge"?"merge-all":"un-merge"}r=this._getSelectedCells(n.sheetIndex,n.range);u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]});this.performSelection(u[0],u[u.length-1]);this._delCells=[]},_undoForReOrder:function(t){var i=this.getSheet(t.sheetIndex);this._isUndo?(this.XLComment.deleteComment(),this.clearRangeData(t.destinationRange),this.XLFormat.clearFormat(t.destinationRange),this.updateData(n.extend(!0,[],t.sourceData),t.sourceRange),this.updateData(n.extend(!0,[],t.destinationData),t.destinationRange),this.XLFormat.updateFormat(t.sourceFormat,t.sourceRange),this.XLFormat.updateFormat(t.destinationFormat,t.destinationRange),this.setActiveCell(t.sourceRange[0],t.sourceRange[1]),this.XLSelection.selectRange({rowIndex:t.sourceRange[0],colIndex:t.sourceRange[1]},{rowIndex:t.sourceRange[2],colIndex:t.sourceRange[3]},t.sheetIndex),i._startCell={rowIndex:t.sourceRange[0],colIndex:t.sourceRange[1]},i._endCell={rowIndex:t.sourceRange[2],colIndex:t.sourceRange[3]},this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()):(this.XLSelection.selectRange({rowIndex:t.sourceRange[0],colIndex:t.sourceRange[1]},{rowIndex:t.sourceRange[2],colIndex:t.sourceRange[3]},t.sheetIndex),this.XLComment.deleteComment(),this.clearRangeData(t.sourceRange),this.clearRangeData(t.destinationRange),this.XLFormat.clearFormat(t.sourceRange),this.XLFormat.clearFormat(t.destinationRange),this.updateData(n.extend(!0,[],t.sourceData),t.destinationRange),this.XLFormat.updateFormat(t.sourceFormat,t.destinationRange),this.setActiveCell(t.destinationRange[0],t.destinationRange[1]),this.XLSelection.selectRange({rowIndex:t.destinationRange[0],colIndex:t.destinationRange[1]},{rowIndex:t.destinationRange[2],colIndex:t.destinationRange[3]},t.sheetIndex),i._startCell={rowIndex:t.destinationRange[0],colIndex:t.destinationRange[1]},i._endCell={rowIndex:t.destinationRange[2],colIndex:t.destinationRange[3]},this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())},_undoForPivot:function(n){var t=this._isUndo?this._undoCollection:this._redoCollection,i={curOperation:n,prevOperation:t[t.length-1],isUndo:this._isUndo};this._trigger("_readUndoRedo",i)},_undoForResizeCol:function(n){this.XLResize.setColWidth(n.colIndex,n.oldWidth);var t=n.oldWidth;n.oldWidth=n.newWidth;n.newWidth=t},_undoForResizeRow:function(n){this.XLResize.setRowHeight(n.rowIndex,n.oldHeight);var t=n.oldHeight;n.oldHeight=n.newHeight;n.newHeight=t},_undoForResizeFHeight:function(n){this.XLResize.setRowHeight(n.rowIndex,n.newHeight);this.getFrozenRows(n.sheetIndex)>=n.rowIndex&&this._refreshFreezeColumns(n.sheetIndex,n.rowIndex,n.newHeight-n.oldHeight,"resize");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForResizeFWidth:function(n){var t=this.getCell(0,n.colIndex).get(0),i=n.newWidth;n.newWidth=t.offsetWidth===n.oldWidth?n.newWidth:n.oldWidth;n.oldWidth=i;this.XLResize._applyWidth(n.target,n.sheetIndex,n.colIndex,n.newWidth);this.getFrozenColumns(n.sheetIndex)>=this._currentHCell&&this._refreshFreezeColumns(n.sheetIndex,n.colIndex,n.newWidth-n.oldWidth,"resize");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForShape:function(i){var u,r,v,d,g=0,nt=this.XLRibbon._chartThemes,ot=this.getSheet(i.sheetIndex)._shapeMngr,y,p,c,l,rt,h,ut,w,ft,k,s,e,a,et;i.action!=="create"&&i.action!=="remove"&&i.action!=="edit"&&i.action!=="border"&&i.action!=="resetpic"&&i.action!=="changepic"&&i.action!=="picturesize"&&i.action!=="chartTheme"&&i.action!=="chartType"&&i.action!=="selectData"&&(u=n("#"+i.cid).data("ejChart"),r=this.getSheet(i.sheetIndex)._shapeMngr.chart[this.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"chart")[0]]);switch(i.action){case"remove":this.XLShape._picCellIdx=this.XLShape._getCellIndexFromOffset(i.position.top,i.position.left);this.XLShape._deleteShape(i.sheetIndex,n("#"+i.id));i.action="create";break;case"create":i.shapeType==="picture"?(this.XLShape._createPicture(i.sheetIndex,i.actCell,i.img,i.position.top,i.position.left,i.position.width,i.position.height,i.cnt),n(i.actCell).addClass("e-activecell")):(this.XLSelection.selectRange({rowIndex:i.range[0],colIndex:i.range[1]},{rowIndex:i.range[0],colIndex:i.range[1]},i.sheetIndex),this.getCell(i.range[0],i.range[1],i.sheetIndex).addClass("e-activecell"),this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,i.range[0],i.range[1],i.range[2],i.range[3]),i.options,i.id),this.XLShape._updateShapeMngr(this.getCell(i.range[0],i.range[1],i.sheetIndex)[0],{chart:i.options},"chart"),this.getCell(i.range[0],i.range[1],i.sheetIndex).addClass("e-activecell"));i.action="remove";break;case"edit":var tt,s=this._dataContainer.sheets[i.sheetIndex],o=i.id.split("_")[1].replace(/[0-9]/g,""),b={},it,f;n("#"+i.id).css({left:i.prev.left,top:i.prev.top,height:i.prev.height,width:i.prev.width});o==="chart"&&this.XLChart.resizeChart(i.id,i.prev.height,i.prev.width);i.visualImg.hide();this.XLShape._picCellIdx=this.XLShape._getCellIndexFromOffset(i.prev.top,i.prev.left);f=this.XLShape._getCellIndexFromOffset(i.cur.top,i.cur.left);tt=this._getShapePositionInManager(f.rowIndex,f.colIndex,i.id,o);b[o]=i.obj[o][tt];this.XLEdit._updateDataContainer(this.getCell(this.XLShape._picCellIdx.rowIndex,this.XLShape._picCellIdx.colIndex,i.sheetIndex)[0],b);i.actionType!="resize"&&(this.getObjectLength(s[f.rowIndex][f.colIndex])<2&&s[f.rowIndex][f.colIndex][o].length<2?delete s[f.rowIndex][f.colIndex]:s[f.rowIndex][f.colIndex][o].length<2?delete s[f.rowIndex][f.colIndex][o]:(s[f.rowIndex][f.colIndex][o].some(function(n,t){if(b.id===n.id)return it=t,!0}),s[f.rowIndex][f.colIndex][o].splice(it,1)));this.getCell(this.XLShape._picCellIdx.rowIndex,this.XLShape._picCellIdx.colIndex,i.sheetIndex).addClass("e-activecell");this.model.showRibbon&&(o==="picture"?this.XLRibbon._toggleFormatTab():this.XLRibbon._toggleChartDesignTab());this._swapVal(i);break;case"PHAxis":case"PVAxis":y=i.action=="PHAxis"?"primaryXAxis":"primaryYAxis";p=i.action==="PHAxis"?"xAxis":"yAxis";i.visibility=!i.visibility;u.option(y,{visible:i.visibility});r[p].visible=i.visibility;break;case"PX":case"PY":y=i.action=="PX"?"primaryXAxis":"primaryYAxis";p=i.action==="PX"?"xAxis":"yAxis";t.isNullOrUndefined(i.prev.text)&&(i.prev.text="");u.option(y,{title:{text:i.prev.text}});r[p].title.text=i.prev.text;this._swapVal(i);break;case"CT":u.option("title",{textAlignment:i.prev.align,text:i.prev.text});r.title={text:i.prev.text,textAlignment:i.prev.align};this._swapVal(i);break;case"DLNone":u.option({series:i.prev.series});r.dataLabel={visible:i.prev.series[0].marker.dataLabel.visible};this._swapVal(i);break;case"DL":u.option({series:i.prev.series});r.dataLabel={visible:i.prev.series[0].marker.dataLabel.visible,vAlign:i.prev.series[0].marker.dataLabel.verticalTextAlignment,tPosn:i.prev.series[0].marker.dataLabel.textPosition};this._swapVal(i);break;case"PMajorH":i.visibility=!i.visibility;u.option("primaryYAxis",{majorGridLines:{visible:i.visibility}});r.yAxis.majorGridLines={visible:i.visibility};break;case"PMajorV":i.visibility=!i.visibility;u.option("primaryXAxis",{majorGridLines:{visible:i.visibility}});r.xAxis.majorGridLines={visible:i.visibility};break;case"PMinorH":i.visibility=!i.visibility;u.option("primaryYAxis",{minorGridLines:{visible:i.visibility},minorTicksPerInterval:5,minorTickLines:{visible:i.visibility}});r.yAxis.minorGridLines={visible:i.visibility};break;case"PMinorV":i.visibility=!i.visibility;u.option("primaryXAxis",{minorGridLines:{visible:i.visibility},minorTicksPerInterval:5,minorTickLines:{visible:i.visibility}});r.xAxis.minorGridLines={visible:i.visibility};break;case"LNone":i.visibility=!i.visibility;u.option("legend",{visible:i.visibility});r.legend.visible=i.visibility;break;case"Legend":u.option("legend",{position:i.prev.position});r.legend.position=i.prev.position;this._swapVal(i);break;case"width":c={width:i.prev.width,height:i.prev.height};l=n("#"+u._id);u.option("size",n.extend(!0,{},c));l[0].style.height=i.prev.height+"px";l[0].style.width=i.prev.width+"px";r.width=i.prev.width;r.height=i.prev.height;this.XLRibbon._setChartWidthHeight(c);this._swapVal(i);break;case"height":c={width:i.prev.width,height:i.prev.height};l=n("#"+u._id);u.option("size",n.extend(!0,{},c));l[0].style.height=i.prev.height+"px";l[0].style.width=i.prev.width+"px";r.width=i.prev.width;r.height=i.prev.Height;this.XLRibbon._setChartWidthHeight(c);this._swapVal(i);break;case"srcolumn":u.model.series.length=0;r.isRowColSwitched=!r.isRowColSwitched;rt={xRange:r.xRange,yRange:r.yRange,lRange:r.lRange,isRowColSwitched:r.isRowColSwitched,dataSheetIdx:r.dataSheetIdx};h=this.XLChart._processChartSeries(rt);u.option({series:h.series});this.getActiveSheetIndex()===r.dataSheetIdx&&this.XLChart._focusChartRange(h.xRange,h.yRange,h.lRange);r.xAxis.range=h.xRange;r.yAxis.range=h.yRange;r.legend.range=h.lRange;break;case"border":ft=this._dataContainer.sheets[i.sheetIndex][i.cellIdx.rowIndex][i.cellIdx.colIndex].picture[i.picIdx];e=n("#"+i.id);this._removeClass(e[0],i.curClass);this.addClass(e[0],i.prevClass);w=this.XLShape._getImgStyleFromHashCode(i.prevClass);ft={bcolor:w["border-color"],bstyle:w["border-style"],bwidth:w["border-width"]};ut=i.prevClass;i.prevClass=i.curClass;i.curClass=ut;break;case"resetpic":e=n("#"+i.id);k=new RegExp("\\be-shapebdr.*?\\b","g");this._isUndo?t.isNullOrUndefined(e[0].className.match(k))&&this.XLShape._updateImgBorder(e[0],i.prev.bwidth,i.prev.bstyle,i.prev.bcolor):e[0].className=e[0].className.replace(k,"");i.actionType!=="resetpicture"&&(e.css({width:i.prev.width,height:i.prev.height}),this.XLShape._selectImg(e),this.XLShape._updateShapeObj(e[0]));this._swapVal(i);break;case"changepic":s=this._dataContainer;n("#"+i.id).css("background-image","url('"+i.prev.img+"')");ot.picture[i.prev.pcIdx].data=i.prev.data;this._swapVal(i);break;case"picturesize":e=n("#"+i.id);e.css({width:i.prev.width,height:i.prev.height});this._swapVal(i);break;case"chartTheme":for(v=this.element.find("#"+this._id+"_chart").val(),d=n("#"+this._id+"_Ribbon_chartTheme").data("ejDropDownList"),i.prev.theme.indexOf("dark")>-1?n("#"+v).addClass("e-ss-charttheme"):n("#"+v).removeClass("e-ss-charttheme"),this.XLChart.refreshChart(v,{theme:i.prev.theme}),a=0,et=nt.length;et>a;a++)if(i.prev.theme===nt[a].value.toLowerCase()){g=a;break}d.option({selectedItemIndex:g});this._swapVal(i);break;case"chartType":this.XLChart.refreshChart(i.chartId,{type:i.prev.chartType,enable3D:i.prev.enable3D,marker:i.prev.marker});this._swapVal(i);break;case"selectData":this.XLChart._processChartRange(i.prev.xRange,i.prev.yRange,i.prev.lRange,document.getElementById(this._id+"_chart").value);this._swapVal(i)}},_undoForShowHide:function(t){var i,r,u=n(this.getRows(t.sheetIndex)[0]).find("td"),f=this._getJSSheetHeader(t.sheetIndex).find("th"),e,o,s;if(t.operation==="row"){for(i=0,r=t.hideRows.length;i<r;i++)t.action==="show"?this.hideRow(t.hideRows[i],t.hideRows[i]):this.showRow(t.hideRows[i],t.hideRows[i]);for(i=0,r=t.remBRows.length;i<r;i++)this.addClass(u[t.remBRows[i]],"e-hrow");for(i=0,r=t.addBRows.length;i<r;i++)this._removeClass(u[t.addBRows[i]],"e-hrow");this.setActiveCell(t.bSelect.startRow,0);t.bSelect.startRow===t.bSelect.endRow?this.XLSelection.selectRow(t.bSelect.startRow,t.sheetIndex):this.XLSelection.selectRows(t.bSelect.startRow,t.bSelect.endRow,t.sheetIndex);e=t.addBRows;t.addBRows=t.remBRows;t.remBRows=e}else{for(i=0,r=t.hideCols.length;i<r;i++)t.action==="show"?this.hideColumn(t.hideCols[i],t.hideCols[i]):this.showColumn(t.hideCols[i],t.hideCols[i]);for(i=0,r=t.remBCols.length;i<r;i++)this.addClass(f[t.remBCols[i]],"e-hcol");for(i=0,r=t.addBCols.length;i<r;i++)this._removeClass(f[t.addBCols[i]],"e-hcol");t.bSelect.startCol===t.bSelect.endCol?this.XLSelection.selectColumn(t.bSelect.startCol,t.sheetIndex):this.XLSelection.selectColumns(t.bSelect.startCol,t.bSelect.endCol,t.sheetIndex);o=t.addBCols;t.addBCols=t.remBCols;t.remBCols=o}t.action=t.action==="show"?"hide":"show";s=t.bSelect;t.bSelect=t.aSelect;t.aSelect=s;this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForSort:function(n){var f=this.XLEdit.getColumnIndexByField(n.columnName),i,t,r,u;n.colSelected<1&&(r=n.range[0],n.range[0]>0&&(r=n.range[0]-1),i=this.getCell(r,f),t=i.find(".e-filterspan")[0]);n.operation==="unsort"?(this.XLComment.deleteComment(n.range,null,!0),this._isSort=!0,this._removeHyperlink(null,null,!0),this._isSort=!1,this.clearRangeData(n.range,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0),this.XLFormat.clearFormat(n.range,"format",!0),this.XLEdit.updateCellWithContainer(n.rangeData,n.range,n.sheetIndex,!0),n.operation="sort",!this.isUndefined(t)&&n.isSortByFilter&&(t.className=t.className.indexOf("-asc")>1?t.className.replace("-asc",n.prevIcon):t.className.replace("-dsc",n.prevIcon))):(this.XLSort._isSortByFilter=n.isSortByFilter,this.XLSort.sortByRange(n.range,n.columnName,n.direction),n.operation="unsort",!this.isUndefined(t)&&n.isSortByFilter&&this.model.allowFiltering&&this.XLFilter._changeSortIcon(i,n.direction));u=n.prevIcon;n.prevIcon=n.currIcon;n.currIcon=u},_undoForSortByColor:function(n){var t=n.range,r=n.prev.data,u=this.getCell(t[0]-1,t[1]),i;this.XLComment.deleteComment(t,null,!0);this._isSort=!0;this._removeHyperlink(null,null,!0);this._isSort=!1;this.clearRangeData(t,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0);this.XLFormat.clearFormat(t,"format",!0);this.XLEdit.updateCellWithContainer(r,t,n.sheetIndex,!0);i=u.find(".e-filterspan");i.length>0&&(i[0].className=i[0].className.replace(n.cur.icon,n.prev.icon));this._swapVal(n)},_undoForStyle:function(n){this.XLFormat.clearFormat(n.range);this.XLFormat.updateFormat(n.beforeFormat,n.range);var t=this.changePosition(n.beforeFormat,n.afterFormat);this._refreshRangeTRHght(this.getActiveSheetIndex(),n.range);n.beforeFormat=t[1];n.afterFormat=t[0];this._isUndoRedo=!0;n.status="undo-cellstyles"},_undoForTextWrap:function(n){n.operation==="wrap"?(this.setWrapText(n.range,"unwrap"),n.operation="unwrap"):(this.setWrapText(n.range,"wrap"),n.operation="wrap");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForValidation:function(n){var u,i,e,o=this.getRangeIndices(n.range),f,r,h,s;if(this.performSelection({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]}),n.operation==="cl-hl-data")this.XLValidate.highlightInvalidData(n.range),n.operation="hl-data";else if(n.operation==="apply-validation"){for(f=n.selectedCells,s=[],i=0,e=f.length;i<e;i++)u=this.getCell(f[i].rowIndex,f[i].colIndex),h=this.XLEdit.getPropertyValueByElem(u,"rule"),r=this.changePosition(f[i].prevRule,h),n.selectedCells[i].prevRule=r[1],t.isNullOrUndefined(r[0])||(r[0].customVal=r[0].customVal,this.XLEdit._updateDataContainer(u[0],{rule:r[0]})),s.push(u[0]);t.isNullOrUndefined(r[0])&&this.clearRangeData(null,["rule"],s)}else if(n.operation==="hl-data")this.XLValidate.clearHighlightedValData(n.range),n.operation="cl-hl-data";else if(this._isUndo)for(i=0,e=n.selCells.length;i<e;i++)u=this.getCell(n.selCells[i].rowIndex,n.selCells[i].colIndex),this.XLEdit._updateDataContainer(u[0],{rule:n.selCells[i].rules});else this.XLValidate.clearDV(n.range)},_applyCommentLink:function(i,r,u,f){var h=this._dataContainer,o,c,e,s,l;if(cFormatData=h.cFormatData,n(r).removeClass("e-redft e-yellowft e-greenft e-redf e-redt"),i&&(this.XLEdit.updateCellValue(n(r),h.sharedData[i.value]),"hyperlink"in i&&(o=i.hyperlink,o?o.webAddr?n(r).html(t.buildTag("a",this.XLEdit.getPropertyValue(r.parentNode.rowIndex,r.cellIndex,"value2"),"",{href:o.webAddr,target:"_blank","class":"e-hyperlinks"})):n(r).html(t.buildTag("a",this.XLEdit.getPropertyValue(r.parentNode.rowIndex,r.cellIndex,"value2"),"",{href:"#","class":"e-hyperlinks"})):0),"comment"in i&&(n(r).removeClass("e-commentcell"),this.XLComment.setComment(n(r),null,!1)),"cFormatRule"in i))for(c=i.cFormatRule,s=0,l=c.length;s<l;s++)e=cFormatData[s].split("_"),this.XLCFormat._cFormat(e[0],e[2],e[3],e[4],null,null,[u,f,u,f])},changePosition:function(n,i){var r=[];return r.push(i),r.push(n),t.swap(r,0,1),r},_addValidationRule:function(t,i){var u=[],r,f;for(n.extend(!0,u,t),r=0,f=t.length;r<f;r++)t[r].customVal!==i.customVal&&t[r].required!==i.required&&t[r].Number!==i.number&&u.push(i);return u},_addCondFormatRule:function(t,i){var f=!1,u=[],r,e;for(n.extend(!0,u,t),r=0,e=t.length;r<e;r++)if(i=i.indexOf("true")>-1?i.replace("_true",""):i.replace("_false",""),t[r]===i){f=!0;break}return f||u.push(i),u},getCellClass:function(n){var t=this._formatRegx;return n&&n.className.indexOf("e-format")>-1?n.className.match(t)[0]:""},_renderInsertDeleteDialog:function(){var n=this._id+"_insertdeletedlg",i,e,r,u,f,o;i=t.buildTag("div#"+n,"",{display:"none"});e=t.buildTag("div#"+n+"_content.e-dlg-fields e-dlgctndiv");i.append(e);f=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");o=t.buildTag("div");r=t.buildTag("input#"+n+"_okbtn","",{"margin-left":4});u=t.buildTag("input#"+n+"_cantn");r.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:"40%",click:t.proxy(this._insertDeleteOk,this),enabled:!0});u.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._insertDeleteCancel,this),showRoundedCorner:!0,width:"40%"});f.append(o.append(r,u));i.append(f);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,width:187,height:"auto",cssClass:"e-ss-dialog",minWidth:150})},_renderInsertDialog:function(){var t=n("#"+this._id+"_insertdeletedlg"),i,r;t.ejDialog({title:this._getLocStr("Insert")});t.ejDialog("open");this._insDelStatus="insert";i=n("#"+t[0].id+"_content");r=["shiftright","shiftbottom","entirerow","entirecolumn"];i.children().empty();this._createRadioButton(t,i,r);n("#"+t[0].id+"_shiftbottom").ejRadioButton({checked:!0});t.find("input[type='submit']:first").focus()},_renderDeleteDialog:function(){var t=n("#"+this._id+"_insertdeletedlg"),i,r;t.ejDialog({title:this._getLocStr("Delete")});t.ejDialog("open");this._insDelStatus="delete";i=n("#"+t[0].id+"_content");r=["shiftleft","shiftup","entirerow","entirecolumn"];i.children().empty();this._createRadioButton(t,i,r);n("#"+t[0].id+"_shiftleft").ejRadioButton({checked:!0});t.find("input[type='submit']:first").focus()},_createRadioButton:function(n,i,r){var o,h,s,e,u,f,c;for(s=t.buildTag("table"),f=0,c=r.length;f<c;f++)e=t.buildTag("tr"),u=t.buildTag("td"),h=t.buildTag("label",this._getLocStr(r[f]),{"padding-bottom":4},{"for":n[0].id+"_"+r[f]}),o=t.buildTag("input#"+n[0].id+"_"+r[f],"",{},{type:"radio",name:"inserdelete"}),u.append(o),e.append(u),u=t.buildTag("td"),u.append(h),o.ejRadioButton({size:"medium"}),e.append(u),s.append(e);i.append(s)},_getSelectedOption:function(t){for(var u,f=this._id+"_insertdeletedlg",r=0,i=0;i<4;i++)if(u=n("#"+f+"_"+t[i]).data("ejRadioButton"),u.model.checked){r=i;break}return r},_insertDeleteOk:function(){var o,f;this._isUndo=!1;this._isUndoRedo=!1;var t,i,e=this.getActiveSheetIndex(),r=this.model.sheets[e]._selectedCells[0],u=this.model.sheets[e]._selectedCells[this.model.sheets[e]._selectedCells.length-1];for(this._insDelStatus.indexOf("insert")>-1?(t=["shiftright","shiftbottom","entirerow","entirecolumn"],i=this._getSelectedOption(t),t[i].indexOf("shiftright")>-1?this.insertShiftRight(r,u):t[i].indexOf("shiftbottom")>-1?this.insertShiftBottom(r,u):t[i].indexOf("entirerow")>-1?this.insertEntireRow(r,u):this.insertEntireColumn(r,u)):(t=["shiftleft","shiftup","entirerow","entirecolumn"],i=this._getSelectedOption(t),t[i].indexOf("shiftleft")>-1?this.deleteShiftLeft(r,u):t[i].indexOf("shiftup")>-1?this.deleteShiftUp(r,u):t[i].indexOf("entirerow")>-1?this.deleteEntireRow(r,u):this.deleteEntireColumn(r,u)),n("#"+this._id+"_insertdeletedlg").ejDialog("close"),o=this.model.sheets[this.model.activeSheetIndex]._shapeMngr.chart,f=0;f<o.length;f++)this.XLChart._refreshChart(o[f])},_insertDeleteCancel:function(){n("#"+this._id+"_insertdeletedlg").ejDialog("close")},_undoredoDetails:function(n,t,i,r,u){var f={sheetIndex:n,startCell:t,endCell:i,reqType:r,action:u,delCells:this._delCells,text:this._deletedText};this.importSheet||this._completeAction(f)},_getRangeFrmFormula:function(n){var t=n.substring(n.indexOf("(")+1,n.indexOf(")")),i=new RegExp("^\\b[a-zA-Z][0-9]*:[a-zA-Z][0-9]*\\b$","g");if(i.test(t))return t;if(t.indexOf(",")>1){if(i.test(t.split(",")[1]))return t.split(",")[1];if(i.test(t.replace(",",":")))return t.replace(",",":")}},_refreshFormula:function(n,i,r,u,f,e,o){var a=this.getActiveSheetIndex(),c,h,v=this.XLEdit.getPropertyValue(n,i,"value"),l,y,s,p,w=this.getSheet(a);if((!this._isUndo||this._formulaChanged.pop()!=="true")&&this.isFormula(v)){if(l=this._getRangeFrmFormula(v),t.isNullOrUndefined(l))return;s=this.getRangeIndices(l);c=f==="column"?u==="insert"?s[3]+r:s[3]-r:u==="insert"?s[2]+r:s[2]-r;h=f==="column"?u==="insert"?s[1]+r:s[1]-r:u==="insert"?s[0]+r:s[0]-r;f==="column"?e>s[1]&&(h=s[1]):e>s[0]&&(h=s[0]);f==="column"?e>s[3]&&(c=s[3]):e>s[2]&&(c=s[2]);o&&(s[1]===s[3]||s[0]!==s[2]||(f==="column"?s[1]===s[3]&&(c=s[3],h=s[1]):s[0]===s[2]&&(c=s[2],h=s[0])),f==="column"?c<s[1]&&(c=s[3]):c<s[0]&&(c=s[2]),f==="column"?h<s[1]&&(h=s[1]):h<s[0]&&(h=s[0]),f==="row"&&(u==="delete"?h<s[2]&&s[1]!=i&&(c=s[2],h=s[0]):s[1]!=i&&(c=s[2],h=s[0])),f==="column"&&(u==="delete"?h<s[3]&&s[0]!=n&&(c=s[3],h=s[1]):s[0]!=n&&(c=s[3],h=s[1])));y=f==="column"?this._getAlphaRange(a,s[0],h,s[2],c):this._getAlphaRange(a,h,s[1],c,s[3]);n===s[0]&&i===s[1]&&(y="#REF!",this._ref.push(l));this._isUndo&&l==="#REF!"&&(y=this._ref.pop());v=v.replace(l,y);p=new ValueChangedArgs(n+1,i+1,v);this._sheets[a]._calcEngine.valueChanged(w._sheetName.value,p);this.XLEdit._updateDataContainer(this.getCell(n,i,a)[0],{value:v});this._applyFormula(a,n,i);this._isUndo||(l===y?this._formulaChanged.push("true"):this._formulaChanged.push("false"))}},_applyFormula:function(n,i,r){t.isNullOrUndefined(this.model.sheets[n]._formulaCollection[i])&&(this.model.sheets[n]._formulaCollection[i]={});var u=this._sheets[n]._calcEngine.getFormulaInfoTable().values();this.model.sheets[n]._formulaCollection[i][r]=u[u.length-1]},_clearFormula:function(n,t){var f,e,i,r=this.getActiveSheetIndex(),s=this.XLEdit.getPropertyValue(n,t,"value"),u,o;if(this.isFormula(s)){for(f=this.model.sheets[r]._formulaCollection[n][t],i=this._sheets[r]._calcEngine.getFormulaInfoTable().values(),e=i.indexOf(f),i.splice(e,1),this._sheets[r]._calcEngine.getFormulaInfoTable().clear(),u=0,o=i.length;u<o;u++)this._sheets[r]._calcEngine.getFormulaInfoTable().add(i[u]);delete this.model.sheets[r]._formulaCollection[n][t]}},_refreshValAndCF:function(n,t,i,r){var u=this._dataContainer.sheets[this.getActiveSheetIndex()];this.isUndefined(i)&&this.isUndefined(r)?delete u[n][t]:(this.isUndefined(i)||(u[n][t]={rule:i}),this.isUndefined(r)||(u[n][t]={cFormatRule:r}))},_refreshDataContainer:function(i,r){for(var a,rt,v,ut,k,d,f,o,c,it,b=0,ft=0,et,e=this._dataContainer.sheets[i],ot,tt,st,s,h,l,g,y,p,w,nt=parseInt(this.getObjectKeys(e)[this.getObjectLength(e)-1]),u=0;u<=nt;u++)t.isNullOrUndefined(e[u])||(et=this.getObjectKeys(e[u]),ft=parseInt(et[et.length-1]),ft>b&&(b=ft));st=r.startCol<=b?r.colCount+r.startCol:b-1;ot=r.status.indexOf("shift")>-1?st:b-1;tt=r.status.indexOf("shift")>-1?r.rowCount+r.startRow:nt;a=r.startRow;rt=r.startRow+r.rowCount-1;v=r.startCol;ut=r.startCol+r.colCount-1;switch(r.status){case"insertRow":for(u=nt,c=r.startRow;u>=c;u--)if(!t.isNullOrUndefined(e[u])){if(e[u+r.rowCount]=n.extend(!0,{},e[u]),!t.isNullOrUndefined(e[u+r.rowCount]))for(l=this.getObjectKeys(e[u+r.rowCount]),f=0,it=l.length;f<it;f++)this._clearFormula(u,l[f]),u>=a&&u<=rt?(this._checkIndicesInContainer(i,a,l[f],"rule")&&(k=this._dataContainer.sheets[i][a][l[f]].rule),this._checkIndicesInContainer(i,a,l[f],"cFormatRule")&&(d=this._dataContainer.sheets[i][a][l[f]].cFormatRule),this._refreshValAndCF(u,l[f],k,d,r.rowCount,0),a<1||this.addClass(this.getCell(u,l[f])[0],this.XLFormat.getFormatClass(this.getCell(a-1,l[f])[0].className,!1))):delete e[u][l[f]],this._refreshFormula(u+r.rowCount,parseInt(l[f]),r.rowCount,"insert","row",r.startRow,!1),this.XLEdit._refreshCalcEngine(u+r.rowCount,parseInt(l[f])),this.XLComment._updateCmntFrmCntnr(u+r.rowCount,parseInt(l[f]));this.getObjectLength(e[u])<1&&delete e[u]}if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,g=s[s.length-1].row-s[0].row,u=0,c=s.length;u<c;u++)for(e[s[u].row]=s[u].value,l=this.getObjectKeys(e[s[u].row]),f=0,it=l.length;f<it;f++)this._refreshFormula(s[u].row,parseInt(l[f]),g,"insert","row","",!1),this.XLEdit._refreshCalcEngine(s[u].row,parseInt(l[f]));break;case"insertColumn":for(u=0;u<=tt;u++)for(f=b,c=r.startCol;f>=c;f--)y=p=null,t.isNullOrUndefined(e[u])||(t.isNullOrUndefined(e[u][f])||(t.isNullOrUndefined(e[u][f+r.colCount])||(t.isNullOrUndefined(e[u][f+r.colCount].picture)||(y=e[u][f+r.colCount].picture),t.isNullOrUndefined(e[u][f+r.colCount].chart)||(p=e[u][f+r.colCount].chart)),e[u][f+r.colCount]=e[u][f],t.isNullOrUndefined(e[u][f].picture)&&t.isNullOrUndefined(e[u][f].chart)||(t.isNullOrUndefined(e[u][f].picture)||(y=e[u][f].picture),t.isNullOrUndefined(e[u][f].chart)||(p=e[u][f].chart)),t.isNullOrUndefined(e[u][f+r.colCount])||(t.isNullOrUndefined(y)||(e[u][f+r.colCount].picture=y),t.isNullOrUndefined(p)||(e[u][f+r.colCount].chart=p))),this._clearFormula(u,f),f>=v&&f<=ut?(this._checkIndicesInContainer(i,u,v,"rule")&&(k=this._dataContainer.sheets[i][u][v].rule),this._checkIndicesInContainer(i,u,v,"cFormatRule")&&(d=this._dataContainer.sheets[i][u][v].cFormatRule),this._refreshValAndCF(u,f,k,d,0,r.colCount),!v<1&&this.addClass(this.getCell(u,f)[0],this.XLFormat.getFormatClass(this.getCell(u,v-1)[0].className,!1))):delete e[u][f],!t.isNullOrUndefined(e[u][f])||t.isNullOrUndefined(y)&&t.isNullOrUndefined(p)||(e[u][f]={}),t.isNullOrUndefined(y)||(e[u][f].picture=y),t.isNullOrUndefined(p)||(e[u][f].chart=p),this._refreshFormula(u,f+r.colCount,r.colCount,"insert","column",r.startCol,!1),this.XLEdit._refreshCalcEngine(u,f+r.colCount),this.XLComment._updateCmntFrmCntnr(u,f+r.colCount));if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,g=s[s.length-1].col-s[0].col,o=0,c=s.length;o<c;o++)t.isNullOrUndefined(e[s[o].row])&&(e[s[o].row]={}),e[s[o].row][s[o].col]=s[o].value,this._refreshFormula(s[o].row,s[o].col,g,"insert","column","",!1),this.XLEdit._refreshCalcEngine(s[o].row,s[o].col),this.XLComment._updateCmntFrmCntnr(s[o].row,s[o].col);break;case"deleteRow":for(this._delCells=[],h=[],u=r.startRow;u<=nt;u++){if(u<r.startRow+r.rowCount){if(this._delCells.push({row:u,value:n.extend(!0,{},e[u])}),!t.isNullOrUndefined(e[u]))for(l=this.getObjectKeys(e[u]),f=0,c=l.length;f<c;f++)this._clearFormula(u,l[f]),e[u][l[f]]={};e[u]={};h.push({row:u})}if(!t.isNullOrUndefined(e[u+r.rowCount])){for(e[u]=n.extend(!0,{},e[u+r.rowCount]),l=this.getObjectKeys(e[u]),f=0,c=l.length;f<c;f++)this._clearFormula(u+r.rowCount,l[f]),e[u+r.rowCount][l[f]]={},this._refreshFormula(u,parseInt(l[f]),r.rowCount,"delete","row",r.startRow,!1),this.XLComment._updateCmntFrmCntnr(u,parseInt(l[f]));e[u+r.rowCount]={};h.push({row:u+r.rowCount})}}for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row])===0&&(this._clearFormula(h[o].row,h[o].col),delete e[h[o].row]);break;case"deleteColumn":for(this._delCells=[],h=[],u=0;u<=tt;u++){for(f=r.startCol;f<=b;f++)y=p=null,f<r.startCol+r.colCount&&(t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f])}),this._clearFormula(u,f),e[u][f]={},t.isNullOrUndefined(this._delCells[this._delCells.length-1])||(w=this._delCells.length-1,t.isNullOrUndefined(this._delCells[w].value.picture)||(e[u][f].picture=this._delCells[w].value.picture),t.isNullOrUndefined(this._delCells[w].value.chart)||(e[u][f].chart=this._delCells[w].value.chart)),h.push({row:u,col:f}))),t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f+r.colCount])||(e[u][f]=n.extend(!0,{},e[u][f+r.colCount]),t.isNullOrUndefined(e[u][f+r.colCount].picture)||(y=e[u][f+r.colCount].picture),t.isNullOrUndefined(e[u][f+r.colCount].chart)||(p=e[u][f+r.colCount].chart),this._clearFormula(u,f+r.colCount),e[u][f+r.colCount]={},t.isNullOrUndefined(y)||(e[u][f+r.colCount].picture=y),t.isNullOrUndefined(p)||(e[u][f+r.colCount].chart=p),t.isNullOrUndefined(this._delCells[this._delCells.length-1])||(w=this._delCells.length-1,t.isNullOrUndefined(this._delCells[w].value.picture)||(e[u][f].picture=this._delCells[w].value.picture),t.isNullOrUndefined(this._delCells[w].value.chart)||(e[u][f].chart=this._delCells[w].value.chart)),h.push({row:u,col:f+r.colCount}),this._refreshFormula(u,f,r.colCount,"delete","column",r.startCol,!1),this.XLComment._updateCmntFrmCntnr(u,f));for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row][h[o].col])===0&&(this._clearFormula(h[o].row,h[o].col),delete e[h[o].row][h[o].col]);h=[]}break;case"shiftRight":for(u=r.startRow;u<tt;u++)for(f=b,c=r.startCol;f>=c;f--)t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(e[u][f+r.colCount]=n.extend(!0,{},e[u][f]),this._clearFormula(u,f),f>=v&&f<=ut?(this._checkIndicesInContainer(i,u,v,"rule")&&(k=this._dataContainer.sheets[i][u][v].rule),this._checkIndicesInContainer(i,u,v,"cFormatRule")&&(d=this._dataContainer.sheets[i][u][v].cFormatRule),this._refreshValAndCF(u,f,k,d,0,r.colCount),v<1||this.addClass(this.getCell(u,f)[0],this.XLFormat.getFormatClass(this.getCell(u,v-1)[0].className,!1))):delete e[u][f],this._refreshFormula(u,f+r.colCount,r.colCount,"insert","column",r.startCol,!0),this.XLEdit._refreshCalcEngine(u,f+r.colCount),this.XLEdit._refreshCalcEngine(u,f),this.XLComment._updateCmntFrmCntnr(u,f+r.rowCount));if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,g=s[s.length-1].col-s[0].col,o=0,c=s.length;o<c;o++)e[s[o].row][s[o].col]=s[o].value,this._refreshFormula(s[o].row,s[o].col,g,"insert","column",r.startRow,!1),this.XLEdit._refreshCalcEngine(s[o].row,s[o].col),this.XLComment._updateCmntFrmCntnr(s[o].row,s[o].col);break;case"shiftLeft":for(this._delCells=[],h=[],u=r.startRow;u<tt;u++){for(f=r.startCol;f<=b;f++)f<r.startCol+r.colCount&&!t.isNullOrUndefined(e[u])&&(t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f])}),this._clearFormula(u,f),e[u][f]={},h.push({row:u,col:f}))),t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f+r.colCount])||(e[u][f]=n.extend(!0,{},e[u][f+r.colCount]),this.clearTextNode(this.getCell(u,f+r.colCount)),this.clearTextNode(this.getCell(u,f),this.XLEdit.getPropertyValue(u,f,"value2")),h.push({row:u,col:f+r.colCount}),this._clearFormula(u,f+r.colCount),e[u][f+r.colCount]={},this._refreshFormula(u,f,r.colCount,"delete","column",r.startCol,!0),this.XLComment._updateCmntFrmCntnr(u,f)),this.XLEdit._refreshCalcEngine(u,f);for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row][h[o].col])===0&&(this._clearFormula(h[o].row,h[o].col),this.XLEdit._refreshCalcEngine(h[o].row,h[o].col),delete e[h[o].row][h[o].col]);h=[]}break;case"shiftBottom":for(u=nt,c=r.startRow;u>=c;u--){for(f=r.startCol;f<ot;f++)t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(t.isNullOrUndefined(e[u+r.rowCount])&&(e[u+r.rowCount]={}),e[u+r.rowCount][f]=n.extend(!0,{},e[u][f]),this._clearFormula(u,f),u>=a&&u<=rt?(this._checkIndicesInContainer(i,a,f,"rule")&&(k=this._dataContainer.sheets[i][a][f].rule),this._checkIndicesInContainer(i,a,f,"cFormatRule")&&(d=this._dataContainer.sheets[i][a][f].cFormatRule),this._refreshValAndCF(u,f,k,d,r.rowCount,0),a<1||this.addClass(this.getCell(u,f)[0],this.XLFormat.getFormatClass(this.getCell(a-1,f)[0].className,!1))):delete e[u][f],this._refreshFormula(u+r.rowCount,f,r.rowCount,"insert","row",r.startRow,!0),this.XLComment._updateCmntFrmCntnr(u+r.rowCount,f)),this.XLEdit._refreshCalcEngine(u,f),this.XLEdit._refreshCalcEngine(u+r.rowCount,f);t.isNullOrUndefined(e[u])||this.getObjectLength(e[u])===0&&delete e[u]}if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,g=s[s.length-1].row-s[0].row,u=0,c=s.length;u<c;u++)t.isNullOrUndefined(e[s[u].row])&&(e[s[u].row]={}),e[s[u].row][s[u].col]=s[u].value,this._refreshFormula(s[u].row,s[u].col,g,"insert","row",r.startRow,!0),this.XLEdit._refreshCalcEngine(s[u].row,s[u].col),this.XLComment._updateCmntFrmCntnr(s[u].row,s[u].col);break;case"shiftUp":for(h=[],u=r.startRow;u<=nt;u++)for(f=r.startCol;f<ot;f++)u<r.startRow+r.rowCount&&!t.isNullOrUndefined(e[u])&&(t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f])}),this._clearFormula(u,f),e[u][f]={},h.push({row:u,col:f}))),t.isNullOrUndefined(e[u+r.rowCount])||t.isNullOrUndefined(e[u+r.rowCount][f])||(t.isNullOrUndefined(e[u])&&(e[u]={}),e[u][f]=n.extend(!0,{},e[u+r.rowCount][f]),this.clearTextNode(this.getCell(u+r.rowCount,f)),this.clearTextNode(this.getCell(u,f),this.XLEdit.getPropertyValue(u,f,"value2")),this._clearFormula(u+r.rowCount,f),e[u+r.rowCount][f]={},h.push({row:u+r.rowCount,col:f}),this._refreshFormula(u,f,r.rowCount,"delete","row",r.startRow,!0),this.XLComment._updateCmntFrmCntnr(u,f)),this.XLEdit._refreshCalcEngine(u,f);for(o=0,c=h.length;o<c;o++)this.getObjectLength(e[h[o].row][h[o].col])===0&&(this._clearFormula(h[o].row,h[o].col),delete e[h[o].row][h[o].col]),this.getObjectLength(e[h[o].row])===0&&delete e[h[o].row]}},insertShiftRight:function(t,i){var l,o,s=this.getActiveSheetIndex(),a,h=i.colIndex-t.colIndex+1,f=this.getRows(s)[1],v=this._getJSSheetHeader(s).find("tr").eq(0).parent().prev(),y=n(this._getContent(s).find("tbody").get(0)).prev(),r,u,e,c;if(!(this.element.find(".e-selected").filter(".e-merge").length>0)&&!(this.element.find(".e-selected").filter(".e-mc-hide").length>0)){if(this._isUndo){for(r=t.rowIndex;r<=i.rowIndex;r++)for(o=n(f[r]).find("td").length-1,u=t.colIndex;u<=o-h;u++)n(f[r]).find("td:eq("+u+")")[0].outerHTML=n(f[r]).find("td:eq("+(u+h)+")")[0].outerHTML;for(e=o;e>o-h;e--)for(n(v).find("col").eq(e).remove(),n(y).find("col").eq(e).remove(),c=0;c<f.length;c++)n(f[c]).find("td:eq("+e+")").remove();l="shiftLeft";this._insDelStatus="delete"}else{for(e=0;e<h;e++)this.XLScroll._createNewColumn(s,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert");for(r=t.rowIndex;r<=i.rowIndex;r++)for(o=n(f[r]).find("td").length-1,u=o-h;u>=t.colIndex;u--)n(f[r]).find("td:eq("+(u+h)+")")[0].outerHTML=n(f[r]).find("td:eq("+u+")")[0].outerHTML,n(f[r]).find("td:eq("+u+")")[0].innerHTML="";l="shiftRight";this._insDelStatus="insert"}this.performSelection(t,i);a={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:l};this._refreshDataContainer(s,a);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._isUndoRedo||this._undoredoDetails(s,t,i,"insert","insertShiftRight")}},insertShiftBottom:function(t,i){var u,r,s,c,e=this.getActiveSheetIndex(),l,o,v,h,a,y=this.getRows(e),f=y[1],p=y[0];if(!(this.element.find(".e-selected").filter(".e-merge").length>0)&&!(this.element.find(".e-selected").filter(".e-mc-hide").length>0)){if(this._isUndo){for(f=this._getContent(e).find("tbody").get(0).rows,u=t.rowIndex,c=f.length;u<c;u++)if(o=u+(i.rowIndex-t.rowIndex+1),o<f.length)for(r=t.colIndex;r<=i.colIndex;r++)n(f[u]).find("td").get(r).outerHTML=n(f[o]).find("td").get(r).outerHTML,n(f[o]).find("td").get(r).innerHTML="";for(r=t.colIndex;r<=i.colIndex;r++)for(s=c-1,length=c-1-(i.rowIndex-t.rowIndex+1);s>length;s--)n(f[s]).remove(),n(p[s]).remove(),this.model.sheets[e].rowCount=this.model.sheets[e].rowCount-1;this.XLScroll._refreshScroller(1,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"all");l="shiftUp"}else{for(u=t.rowIndex;u<=i.rowIndex;u++)this.XLScroll._createNewRow(e,-1,-1,"insert");for(u=f.length-1;u>=t.rowIndex;u--)if(o=u-(i.rowIndex-t.rowIndex+1),o>=t.rowIndex)for(r=t.colIndex;r<=i.colIndex;r++)h=n(f[o]).find("td").get(r),a=n(f[u]).find("td").get(r),a.outerHTML=h.outerHTML,h.innerHTML="",a.className=h.className,h.className="e-rowcell";l="shiftBottom"}this.performSelection(t,i);v={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:l};this._refreshDataContainer(e,v);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._isUndoRedo||this._undoredoDetails(e,t,i,"insert","insertShiftBottom")}},insertEntireRow:function(t,i){var r,h,e,u=this.getActiveSheetIndex(),c,o,l,f,a=this._getJSSheetRowHeaderContent(u).find(".e-rowselected"),s;if(!(this.element.find(".e-selected").filter(".e-merge").length>0)&&!(this.element.find(".e-selected").filter(".e-mc-hide").length>0)){if(this._isUndo){for(c=this._getContent(u).find("tbody").get(0).rows,o=this._getJSSheetRowHeaderContent(u).find("tbody").get(0).rows,l=this._getJSSheetRowHeaderContent(u).find("tbody").get(0),r=i.rowIndex;r>=t.rowIndex;r--)n(c[r]).remove(),n(o[r]).remove(),this.model.sheets[u].rowCount=this.model.sheets[u].rowCount-1,this.XLScroll._getRowHeights(u,t.rowIndex),this._refreshFreezeRows(u,r,parseInt(o[r].style.height),"delete");for(s=n(l).find("td"),r=0,h=s.length;r<h;r++)n(s[r]).text(r+1);e="deleteRow"}else{for(r=t.rowIndex;r<=i.rowIndex;r++)this.XLScroll._createNewRow(u,r,t.colIndex,"insert"),this._refreshFreezeRows(u,r,this.model.rowHeight,"insert");e="insertRow"}a.length?this.XLSelection.selectRows(t.rowIndex,i.rowIndex):this.performSelection(t,i);this.model.allowComments&&this.XLComment._updateCmntArrowPos();f={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:e};this._refreshDataContainer(u,f);this._isUndo?this._refreshAllMergeCells(u,t.rowIndex,f.rowCount,-1,0,"delete"):this._refreshAllMergeCells(u,t.rowIndex,f.rowCount,-1,0,"insert");this._isUndoRedo||this._undoredoDetails(u,t,i,"insert","insertRow")}},insertEntireColumn:function(n,t){var u,i=this.getActiveSheetIndex(),r,f=this._getJSSheetHeader(i).find(".e-colselected");this.element.find(".e-selected").filter(".e-merge").length>0||this.element.find(".e-selected").filter(".e-mc-hide").length>0||(this._isUndo?(this._insDelStatus="delete",u="deleteColumn"):(u="insertColumn",this._insDelStatus="insert"),this.XLScroll._createNewColumn(i,n,t,"insert"),f.length?this.XLSelection.selectColumns(n.colIndex,t.colIndex):this.performSelection(n,t),this.model.allowComments&&this.XLComment._updateCmntArrowPos(),r={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:u},this._refreshDataContainer(i,r),this._isUndo?this._refreshAllMergeCells(i,-1,0,n.colIndex,r.colCount,"delete"):this._refreshAllMergeCells(i,-1,0,n.colIndex,r.colCount,"insert"),this._isUndoRedo||this._undoredoDetails(i,n,t,"insert","insertColumn"))},deleteShiftLeft:function(t,i){var r,f,u,o=i.colIndex-t.colIndex+1,h=this.getActiveSheetIndex(),e=this.getRows(h)[1],c,s=[],l,a;if(!(this.element.find(".e-selected").filter(".e-merge").length>0)&&!(this.element.find(".e-selected").filter(".e-mc-hide").length>0)){if(this._isUndo){for(n.extend(!0,s,this._deletedText),this._insDelStatus="insert",r=t.rowIndex;r<=i.rowIndex;r++){for(a=n(e[r]).find("td").length-1,u=a-o;u>t.colIndex-1;u--)n(e[r]).find("td:eq("+(u+o)+")")[0].outerHTML=n(e[r]).find("td:eq("+u+")")[0].outerHTML;for(f=t.colIndex;f<=i.colIndex;f++)n(e[r]).find("td").get(f).outerHTML=s.shift()}c="shiftRight"}else{for(this._insDelStatus="delete",r=t.rowIndex;r<=i.rowIndex;r++){for(f=t.colIndex;f<=i.colIndex;f++)s.push(n(e[r]).find("td").get(f).outerHTML);for(u=t.colIndex,length=n(e[r]).find("td").length;u<length-o;u++)n(e[r]).find("td:eq("+u+")")[0].outerHTML=n(e[r]).find("td:eq("+(u+o)+")")[0].outerHTML}c="shiftLeft"}this.performSelection(t,i);l={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:c};this._refreshDataContainer(h,l);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._deletedText=s;this._isUndoRedo||this._undoredoDetails(h,t,i,"delete","deleteShiftLeft")}},deleteShiftUp:function(t,i){var u,r,c,s=this.getActiveSheetIndex(),f=this.getRows(s)[1],h,o=[],e,l;if(!(this.element.find(".e-selected").filter(".e-merge").length>0)&&!(this.element.find(".e-selected").filter(".e-mc-hide").length>0)){if(this._isUndo){for(n.extend(!0,o,this._deletedText),u=f.length-1;u>=t.rowIndex;u--)if(e=u-(i.rowIndex-t.rowIndex+1),e>=t.rowIndex)for(r=t.colIndex;r<=i.colIndex;r++)n(f[u]).find("td").get(r).outerHTML=n(f[e]).find("td").get(r).outerHTML,n(f[e]).find("td").get(r).innerHTML="";for(u=t.rowIndex;u<=i.rowIndex;u++)for(r=t.colIndex;r<=i.colIndex;r++)n(f[u]).find("td").get(r).outerHTML=o.shift();h="shiftBottom"}else for(h="shiftUp",u=t.rowIndex,c=f.length;u<c;u++)if(e=u+(i.rowIndex-t.rowIndex+1),e<f.length)for(r=t.colIndex;r<=i.colIndex;r++)o.push(n(f[u]).find("td").get(r).outerHTML),n(f[u]).find("td").get(r).outerHTML=n(f[e]).find("td").get(r).outerHTML,n(f[e]).find("td").get(r).innerHTML="";this.performSelection(t,i);l={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:h};this._refreshDataContainer(s,l);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._deletedText=o;this._isUndoRedo||this._undoredoDetails(s,t,i,"delete","deleteShiftUp")}},deleteEntireRow:function(t,i){var r,p,w,h,c,f,l,e=[],u=this.getActiveSheetIndex(),o,s,a,v,y;if(w=this._getContent(u).find("table"),a=this.getRows(u),v=a[1],y=a[0],f=this._getJSSheetRowHeaderContent(u).find("table"),selRowHdr=f.find(".e-rowselected"),!(this.element.find(".e-selected").filter(".e-merge").length>0)&&!(this.element.find(".e-selected").filter(".e-mc-hide").length>0)){if(this._isUndo)for(l="insertRow",n.extend(!0,e,this._deletedText),r=t.rowIndex;r<=i.rowIndex;r++)o=e.pop(),n(v[r]).before(o),c=this.XLScroll._rowHeaderTemplate(1),n(c).height(n(o).height()),f.find("tr").eq(r).before(c),this.model.sheets[u].rowCount=this.model.sheets[u].rowCount+1,this.XLScroll._getRowHeights(u,t.rowIndex+1),this._refreshFreezeRows(u,r,n(o).height(),"insert");else for(l="deleteRow",r=i.rowIndex;r>=t.rowIndex;r--)e.push(w.find("tr").get(r).outerHTML),this._refreshFreezeRows(u,r,parseInt(y[r].style.height),"delete"),n(v[r]).remove(),n(y[r]).remove(),this.model.sheets[u].rowCount=this.model.sheets[u].rowCount-1,this.XLScroll._getRowHeights(u,t.rowIndex+1),this.XLScroll._createNewRow(u,-1,-1,"insert");for(h=f.find("td"),r=0,p=h.length;r<p;r++)n(h[r]).text(r+1);s={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:l};this._refreshDataContainer(u,s);this._isUndo?this._refreshAllMergeCells(u,t.rowIndex,s.rowCount,-1,0,"insert"):this._refreshAllMergeCells(u,t.rowIndex,s.rowCount,-1,0,"delete");selRowHdr.length?this.XLSelection.selectRows(t.rowIndex,i.rowIndex):this.performSelection(t,i);this._deletedText=e;this._isUndoRedo||this._undoredoDetails(u,t,i,"delete","deleteRow")}},deleteEntireColumn:function(t,i){var u,r,l,f=this.getActiveSheetIndex(),o,v,h,s,c,y,p,e=[],a,w;if(o=this._getContent(f).find("tbody").get(0),h=this._getJSSheetHeader(f).find("tr").eq(0),s=n(o).prev(),c=h.parent().prev(),y=this.XLScroll._colGroupTemplate(1),colHdrSel=h.find(".e-colselected"),!(this.element.find(".e-selected").filter(".e-merge").length>0)&&!(this.element.find(".e-selected").filter(".e-mc-hide").length>0)){if(this._isUndo){for(e=n.extend(!0,e,this._deletedText),p="insertColumn",u=o.rows.length-1;u>=0;u--)for(r=t.colIndex;r<=i.colIndex;r++)n(o.rows[u]).find("td").eq(r).before(e.pop());for(r=t.colIndex;r<=i.colIndex;r++)n(s).find("col").eq(r).before(e.pop()),h.parent().find("th").eq(r).before("<th class='e-headercell'><div class='e-headercelldiv'><\/div><\/th>"),n(c).find("col").eq(r).before(e.pop()),this._refreshFreezeColumns(f,r,parseInt(s.find("col")[r].style.width),"insert")}else{for(p="deleteColumn",r=i.colIndex;r>=t.colIndex;r--)e.push(n(c).find("col").get(r).outerHTML),e.push(n(s).find("col").get(r).outerHTML),this._refreshFreezeColumns(f,r,parseInt(s.find("col")[r].style.width),"delete"),n(c).find("col").eq(r).remove(),n(s).find("col").eq(r).remove(),n(c).append(y),n(s).append(y);for(u=0,l=o.rows.length;u<l;u++)for(r=i.colIndex;r>=t.colIndex;r--)w=this.XLScroll._columnTemplate(),n(o.rows[u]).append(w),e.push(n(o.rows[u]).find("td").get(r).outerHTML),n(o.rows[u]).find("td").eq(r).remove()}for(v=n(h).find("th"),u=0,l=v.length;u<l;u++)n(v[u]).find("div").text(this._generateHeaderText(f,u+1));a={startCol:t.colIndex,colCount:i.colIndex-t.colIndex+1,startRow:t.rowIndex,rowCount:i.rowIndex-t.rowIndex+1,status:p};this._refreshDataContainer(f,a);this._isUndo?this._refreshAllMergeCells(f,-1,0,t.colIndex,a.colCount,"insert"):this._refreshAllMergeCells(f,-1,0,t.colIndex,a.colCount,"delete");colHdrSel.length?this.XLSelection.selectColumns(t.colIndex,i.colIndex):this.performSelection(t,i);this._deletedText=e;this._isUndoRedo||this._undoredoDetails(f,t,i,"delete","deleteColumn")}},_refreshFreezeRows:function(n,t,i,r){if(t<this.getFrozenRows(n)){var u=parseInt(this._getContent(n).find(".e-frow")[0].style.top);r==="hide"||r==="delete"?(this._getContent(n).find(".e-frow")[0].style.top=u-i+"px",this._getJSSheetRowHeaderContent(n).find(".e-frow")[0].style.top=u-i+"px",r==="delete"&&(this.getSheet(n)._frozenRows=this.getSheet(n)._frozenRows-1)):r==="unhide"||r==="insert"?(this._getContent(n).find(".e-frow")[0].style.top=u+i+"px",this._getJSSheetRowHeaderContent(n).find(".e-frow")[0].style.top=u+i+"px",r==="insert"&&(this.getSheet(n)._frozenRows=this.getSheet(n)._frozenRows+1)):(this._getContent(n).find(".e-frow")[0].style.top=u+i+"px",this._getJSSheetRowHeaderContent(n).find(".e-frow")[0].style.top=u+i+"px")}this.getSheet(n)._currentTopFrozenRow=this.getSheet(n)._frozenRows},_refreshFreezeColumns:function(n,t,i,r){if(t<this.getFrozenColumns(n)){var u=parseInt(this._getContent(n).find(".e-fcol")[0].style.left);r==="hide"||r==="delete"?(this._getContent(n).find(".e-fcol")[0].style.left=u-i+"px",this._getJSSheetHeader(n).find(".e-fcol")[0].style.left=u-i+"px",r==="delete"&&(this.getSheet(n)._frozenColumns=this.getSheet(n)._frozenColumns-1)):r==="unhide"||r==="insert"?(this._getContent(n).find(".e-fcol")[0].style.left=u+i+"px",this._getJSSheetHeader(n).find(".e-fcol")[0].style.left=u+i+"px",r==="insert"&&(this.getSheet(n)._frozenColumns=this.getSheet(n)._frozenColumns+1)):(this._getContent(n).find(".e-fcol")[0].style.left=u+i+"px",this._getJSSheetHeader(n).find(".e-fcol")[0].style.left=u+i+"px")}this.getSheet(n)._currentLeftFrozenColumn=this.getSheet(n)._frozenColumns},performSelection:function(n,t){var r=this.getActiveSheetIndex(),i;typeof n=="string"&&(i=this.getRangeIndices(n),n={rowIndex:i[0],colIndex:i[1]},t={rowIndex:i[2],colIndex:i[3]});this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(r,"refresh","all");this.XLSelection.selectRange(n,t);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this.model.sheets[r]._startCell=n;this.model.sheets[r]._endCell=t},_checkRowCol:function(n,i){if(n!==0&&i!==0)return t.isNullOrUndefined(i)&&(i=n),{start:n,end:i}},hideRow:function(n,t){var i=this._checkRowCol(n,t);this._hideRow(i.start-1,i.end-1)},showRow:function(n,t){var i=this._checkRowCol(n,t);this._showRow(i.start-1,i.end-1)},hideColumn:function(n,t){var i=this._checkRowCol(n,t);this._hideColumn(i.start-1,i.end-1)},showColumn:function(n,t){var i=this._checkRowCol(n,t);this._showColumn(i.start-1,i.end-1)},_hideRow:function(n,t){for(var s,a,i=this.getActiveSheetIndex(),u=this.getSheet(i),h=this.getRows(i),f=h[1],v=h[0],c=u.hideRowsCollection,e=u._hiddenHeight,o,l=[],r=n;r<=t;r++)f[r].className.indexOf("e-r-hide")===-1&&(this.addClass(f[r],"e-r-hide"),this.addClass(v[r],"e-r-hide"),c.push(r),l.push(r),o=parseInt(f[r].style.height),e=e+o,this.model.sheets[i]._importRendered||this._refreshFreezeRows(i,r,o,"hide"),this.model.scrollSettings.allowScrolling&&!this.model.sheets[i]._importRendered&&this.XLScroll._createNewRow(i,-1,-1,"insert"));u.hideRowsCollection=c;!this._isUndoRedo&&n>0?this.addClass(this._getJSSheetRowHeaderContent(i).find(".e-rowheader")[n-1],"e-hrow"):n===0&&(s=this.element.find(".e-spreadsheetcolumnheader"),s.height(19.5),this.addClass(s[0],"e-hfrow"));u._importRendered||(this.model.allowComments&&this.XLComment._updateCmntArrowPos(),u._hiddenHeight=e,this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(i,"refresh","vertical"),this._isUndoRedo||(this.getSheet(i)._activeCell.rowIndex=t+1,this.XLSelection.selectRow(t+1,i),this.model.allowAutoFill&&this.XLDragFill.hideAutoFillElement(),a={sheetIndex:i,reqType:"show-hide",action:"hide",operation:"row",bSelect:{startRow:n,endRow:t},aSelect:{startRow:t+1,endRow:t+1},addBRows:[n-1],remBRows:[],hideRows:l},this._completeAction(a)))},_showRow:function(i,r){var u=this.getActiveSheetIndex(),l=i-1>0?i-1:0,f=this.getSheet(u),a=this.getRows(u),e=a[1],s=a[0],v=[],y=[],p=f.hideRowsCollection,h=f._hiddenHeight,k=n(this._getJSSheetHeader(u).find("colgroup")[0].outerHTML).attr("id","ss"),o=t.buildTag("table#wrapTable.e-table",{}),w=this.element.find(".e-spreadsheetcolumnheader"),c,b;if(o.append(k),this.element[0].insertBefore(o[0],this.element[0].childNodes[0]),this._isUndoRedo||i!==r||this._hasClass(e[l],"e-r-hide")){for(j=l;j<=r;j++)hideValue=p.indexOf(j),hideValue>-1&&(this._removeClass(e[j],"e-r-hide"),this._removeClass(s[j],"e-r-hide"),rowHt=parseInt(e[j].style.height),h=h+rowHt,this.model.sheets[u]._importRendered||this._refreshFreezeRows(u,j,rowHt,"unhide"),p.splice(hideValue,1),v.push(j),!this._isUndoRedo&&j>0?(y.push(j-1),this._removeClass(n(s[j-1]).find("td")[0],"e-hrow")):j===0&&(w.height(20.5),this._removeClass(w[0],"e-hfrow"))),this._setWrapHeight(u,j,e,s,o,"visible"),o.remove(),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();f._importRendered||this._isUndoRedo||(i<r?(this.setActiveCell(i,0),this.XLSelection.selectRows(i,r,u),c={startRow:i,endRow:r}):(this.setActiveCell(i-1,0),this.XLSelection.selectRow(i-1,u),c={startRow:i-1,endRow:i-1}),this.XLDragFill.positionAutoFillElement(),b={sheetIndex:u,reqType:"show-hide",action:"show",operation:"row",bSelect:{startRow:i,endRow:r},aSelect:c,addBRows:[],remBRows:y,hideRows:v},this._completeAction(b));!f._importRendered&&this.model.allowComments&&this.XLComment._updateCmntArrowPos();f._hiddenHeight=h;this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(u,"refresh","vertical")}},_colgroupRefresh:function(t){var i,r,u,f;this.model.allowResizing&&(i=this._getJSSheetHeader(t).find("colgroup"),r=this._getContent(t).find("colgroup"));u=n(i).clone();f=n(r).clone();n(r).remove();n(i).remove();n(u).prependTo(this._getJSSheetHeader(t).find(".e-table"));n(f).prependTo(this._getContent(t).find(".e-table"))},_hideColumn:function(n,t){for(var u,l,r=this.getActiveSheetIndex(),o=this._getContent(r).find("col"),b=this._getJSSheetHeader(r).find("col"),f=this.getSheet(r),k=f.hideColsCollection,s=f._hiddenWidth,h,a=[],v=[],y,p=this.element.find(".e-spreadsheetcolumnheader"),c,w,e=this._getContent(r).find(".e-filterspan"),i=n;i<=t;i++)if(!this._hasClass(o[i],"e-c-hide"))for(this.addClass(o[i],"e-c-hide"),this.addClass(b[i],"e-c-hide"),f._importRendered||(k.push(i),a.push(i)),y=this.getRange(0,i,this.model.rowCount-1,i),y.filter(".e-sswraptext").hide(),h=parseInt(o[i].style.width),s=s+h,this.model.sheets[r]._importRendered||this._refreshFreezeColumns(r,i,h,"hide"),u=0,l=e.length;u<l;u++)parTdIdx=e[u].parentNode.cellIndex,parTdIdx===i&&this.addClass(e[u],"e-hide");this._isUndoRedo||(v.push(n-1),n===0?(p.width(28),this.addClass(p[0],"e-hfcol")):this.addClass(this._getJSSheetHeader(r).find("th:eq("+(n-1)+")")[0],"e-hcol"));f._hiddenWidth=s;this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(r,"refresh","horizontal");f._importRendered?this.setActiveCell(0,0):(this._getJSSheetHeader(r).find("col").length-1===t?(this.XLSelection.selectColumn(t-1,r),c={startCol:t-1,endCol:t-1}):(c={startCol:t+1,endCol:t+1},this.XLSelection.selectColumn(t+1,r)),this.XLDragFill.positionAutoFillElement(),this._isUndoRedo||(w={sheetIndex:r,reqType:"show-hide",action:"hide",operation:"column",bSelect:{startCol:n,endCol:t},aSelect:c,hideCols:a,addBCols:v,remBCols:[]},this._completeAction(w)),this.model.allowComments&&this.XLComment._updateCmntArrowPos());this.getBrowserDetails().browser.indexOf("msie")>-1&&this._colgroupRefresh(r)},_showColumn:function(n,t){var r=this.getActiveSheetIndex(),f=n-1>0?n-1:0,e=this.getSheet(r),c=e.hideColsCollection,o=this._getContent(r).find("col"),l=[],p=[],a=[],w=this._getJSSheetHeader(r).find("col"),u,s=e._hiddenWidth,b=this._getJSSheetHeader(r).find("th"),h,l=[],p=[],v,y=this.element.find(".e-spreadsheetcolumnheader"),k;if(this._isUndoRedo||n!==t||this._hasClass(o[f],"e-c-hide")){for(u=this._getContent(r).find(".e-filterspan"),j=f;j<=t;j++)if(hideValue=c.indexOf(j),hideValue>-1){for(h=parseInt(o[j].style.width),s=s+h,this.model.sheets[r]._importRendered||this._refreshFreezeColumns(r,j,h,"unhide"),this._removeClass(o[j],"e-c-hide"),this._removeClass(w[j],"e-c-hide"),i=0,len=u.length;i<len;i++)parTdIdx=u[i].parentNode.cellIndex,parTdIdx===j&&this._hasClass(u[i],"e-hide")&&this._removeClass(u[i],"e-hide");c.splice(hideValue,1);l.push(j);v=this.getRange(0,j,this.model.rowCount-1,j);v.filter(".e-sswraptext").show();!this._isUndoRedo&&j>0?(this._removeClass(b.get(j-1),"e-hcol"),a.push(j-1)):j===0&&(y.width(29),this._removeClass(y[0],"e-hfcol"))}this._isUndoRedo||e._importRendered||(n<t?(this.XLSelection.selectColumns(n,t,r),aSelect={startCol:n,endCol:t}):(this.XLSelection.selectColumn(f,r),aSelect={startCol:f,colIdx:t}),this.XLDragFill.positionAutoFillElement(),k={sheetIndex:r,reqType:"show-hide",action:"show",operation:"column",bSelect:{startCol:n,endCol:t},aSelect:aSelect,addBCols:p,remBCols:a,hideCols:l});this.getBrowserDetails().browser.indexOf("msie")>-1&&this._colgroupRefresh(r);!this.model.sheets[r]._importRendered&&this.model.allowComments&&this.XLComment._updateCmntArrowPos();this.getSheet(r)._hiddenWidth=s;this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(r,"refresh","horizontal")}},_destroySheet:function(n){this.element.find("#"+this._id+"_"+this.model.sheets[n]._sheetName.value).empty()},_destroy:function(){var t=1,i;for(this._unWireEvents(),this.element.find(".e-spreadsheet-list").empty(),n("#"+this._id+"_sscustomformat").remove();t<=this.model.sheetCount;)i=this.getSheet(t)._sheetName.value,delete n.templates[this._id+"JSONTemplate"+t],CalcEngine.unregisterGridAsSheet(i,i),t++;this.model.sheets=[];this.model.nameManager=[];n("#"+this._id+"_nmgrid").ejGrid("option",{dataSource:[]});this.XLRibbon._updateUseInFormulaTrgt();CalcEngine._tokenCount=0},_unWireEvents:function(){var i=this.element,r=t.eventType,u=this._id;this._off(i,r.mouseDown,".e-ribbon, .e-spreadsheetcontentcontainer .e-vscroll, .e-spreadsheetcontentcontainer .e-hscroll",this._rClickHandler);this._off(i,r.mouseDown,".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel",this._mouseDownHandler);this._off(i,"keydown",this._keyDownHandler);this._off(i,"click",".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel, .e-ss-object",this._cellClick);this._off(i,"dblclick",".e-spreadsheetcontentcontainer,.e-spreadsheetheader,.e-spreadsheetrowheader",this._recorddblClickHandler);this._off(i,"dblclick",".e-numericcontainer .e-numericitem",this._pagerdblClickHandler);this._off(i,r.mouseMove,this._mouseMove);this._off(i,r.mouseUp,this._sheetMouseUp);this.model.allowResizing&&this._off(i,r.mouseLeave,".e-spreadsheetrowheader,.e-spreadsheetheader",this._mouseLeave);this._off(i,r.click,".e-ssfiltered, .e-ssfilter, .e-ssfiltered-asc, .e-ssfilter-asc, .e-ssfiltered-dsc, .e-ssfilter-dsc",this._filterDownHandler);this._off(i,r.mouseDown,".e-ssddl",this._ddlopen);this._off(i,"mouseover",".e-rowcell",this._cellHoverHandler);this._off(i,"mouseover",".e-viewhdrlbl, .e-vheading",this._headingchkboxHover);this._off(i,"mouseover",".e-viewlinlbl, .e-vgridlines",this._gridlineschkboxHover);this._off(i,"mouseleave",".e-viewhdrlbl, .e-vheading",this._headingchkboxLeave);this._off(i,"mouseleave",".e-viewlinlbl, .e-vgridlines",this._gridlineschkboxLeave);this._off(this._getInputBox(),"input",this.XLEdit._formulaBoxInputChange);this._off(n("#"+u+"_cellstyles"),r.click,this._cellStyleClick);this._off(n("#"+u+"_formatastable"),r.click,this._formatAsTableClick);this._off(n("#"+u+"_nmuseinformula"),r.click,".e-nmuseinformularow",this._useInFormulaClick);this.element.find(".e-spreadsheet-list").unbind("mousewheel DOMMouseScroll",n.proxy(this.XLScroll._spreadMouseWheel,this.XLScroll));this._off(n(".e-menu .e-chartcontent .e-chartcell"),r.click,this._chartClickHandler);this._off(n("#"+u+"_allchart").find(".e-chartimg"),r.click,this._allChartType);this.model.scrollSettings.isResponsive&&n(window).unbind("resize",n.proxy(this._spreadsheetonresize,this))},getValueRowCol:function(n,t,i){var u=this._dataContainer,r=u.sheets;return t=t-1,i=i-1,n in r&&t in r[n]&&i in r[n][t]?u.sharedData[r[n][t][i].value]:void 0},setValueRowCol:function(n,t,i,r){var u,f,e=i-1,o=r-1,s=this.getCell(e,o,n)[0];u=this.getRangeData([e,o,e,o],!1,["formatStr","type","thousandSeparator","decimalPlaces"],n)[0];u.formatStr&&(f=this.XLFormat._format(t,{formatStr:u.formatStr,type:u.type,thousandSeparator:u.thousandSeparator,decimalPlaces:u.decimalPlaces}));u.type=="fraction"&&(f=this.XLFormat._format(t,{type:u.type}));this.XLEdit._updateDataContainer(s,{value2:f||t,calcValue:this.XLEdit._parseValue(t).value});this.XLEdit._refreshCellAlignment(s,t,u.type)},getActiveCellElem:function(n){return this._getContent(this.isNumber(n)?n:this.getActiveSheetIndex()).find("td.e-activecell")},_hlDlgOpen:function(){var s=this.getActiveSheetIndex(),i=this.getActiveCellElem(s);if(!i.length)return!1;var t=this._id,h,c=n("#"+t+"_Ribbon_webAddress"),l=n("#"+t+"_Ribbon_cellAddress"),e=n("#"+t+"_Ribbon_findText"),r,u=this.XLEdit.getPropertyValue(i.parent("tr").index(),i[0].cellIndex,"hyperlink",s),a,o,f=n("#"+t+"_Ribbon_cellText");n("#"+t+"_HLDialog").ejDialog("open");o=n("#"+t+"_Ribbon_sheentName").data("ejTreeView");o.option("fields",{dataSource:this.XLRibbon._sheetData()});h=n("#"+t+"_HLDialogTab").data("ejTab");f.attr("disabled",!1);e.attr("disabled",!1);this.isUndefined(u)?h.model.selectedItemIndex===0?(c.val("http://"),f.val("")):(o.selectNode(s+1),f.val(o.getText(s+1)+"!A1"),l.val("A1")):(this.isUndefined(u.webAddr)?h.option({selectedItemIndex:1}):h.option({selectedItemIndex:0}),this.isUndefined(u.cellAddr)?(c.val(u.webAddr),l.val("A1")):(l.val(u.cellAddr.split("_")[0]),a=parseInt(u.cellAddr.split("_")[1])+1,o.selectNode(a),c.val("http://")));n("#"+t+"_Form_Ribbon_cellAddress").validate().resetForm();n("#"+t+"_Form_Ribbon_webAddress").validate().resetForm();e.val("");r=this.XLEdit.getPropertyValueByElem(i);this.isUndefined(r)||(this.isFormula(r)||this.XLEdit.getPropertyValueByElem(i,"type")&&this.XLEdit.getPropertyValueByElem(i,"type").indexOf("date")>-1||n.isNumeric(r)?(f.val(this._getLocStr("HyperLinkHide")),e.val(this._getLocStr("HyperLinkHide")),f.attr("disabled",!0),e.attr("disabled",!0)):(f.val(r),e.val(r)))},_setLink:function(i){var o,h,s,c,e,y,l,a=this.getActiveSheetIndex(),p,r,u=this.getActiveCellElem(a),f,v;e=this.getSheet(a).selectedRange;v=n("#"+this._id+"_HLDialogTab").ejTab("option","selectedItemIndex");o=n("#"+this._id+"_Ribbon_cellText").val();h=n("#"+this._id+"_Ribbon_cellAddress").val();s=n("#"+this._id+"_Ribbon_findText").val();c=n("#"+this._id+"_Ribbon_webAddress").val();l=n("#"+this._id+"_Ribbon_sheentName").data("ejTreeView");y=this._getSheetIndexByName(l.getSelectedNode().text());o.length||s.length||(o=l.getSelectedNode().text()+"!"+h,s=c);f=this.XLEdit.getPropertyValueByElem(u);this._prevText=t.isNullOrUndefined(f)?"":f;r=this.XLEdit.getPropertyValueByElem(u,"type")&&this.XLEdit.getPropertyValueByElem(u,"type").indexOf("date")>-1?this.XLEdit.getPropertyValueByElem(u,"value2"):n.isNumeric(f)||this.isFormula(f)?f:v===0?s:o;this.XLEdit.updateCellValue(u,r);(this.isFormula(r)||n.isNumeric(r))&&(r=this.XLEdit.getPropertyValueByElem(u,"value2"));p=v===0?{webAddr:c,text:r}:{cellAddr:h,text:r};this.setHyperlink(this._getAlphaRange(a,e[0],e[1],e[2],e[3]),p,y,i)},setHyperlink:function(i,r,u,f){var c;if(this.model.allowHyperlink){if(c={range:i,address:r.webAddr,text:r.text,sheetIndex:u,reqType:"hyperlink",action:"add"},this._trigActionBegin(c))return;i=c.range;r.webAddr=c.address;r.text=c.text;u=c.sheetIndex;var y,s,p,v,g=this.getActiveSheetIndex(),w,l=[],b,h,e,a,o=this._getAlphaRangeCells(i),k={sheetIndex:this.getActiveSheetIndex(),reqType:"hyperlink"},d;if(k.action=t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(n(o[0]),"hyperlink"))?"add":"edit",this._isUndoRedo)for(e=0,a=o.length;e<a;e++)t.isNullOrUndefined(f[e].prevLink)||(this.XLEdit._updateDataContainer(o[e],{hyperlink:f[e].prevLink}),e===0?(n(o[e]).find("a").remove(),t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").cellAddr)?n(o[e]).text("").append(t.buildTag("a",f[e].prevText,"",{href:this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").webAddr,target:"_blank"})):n(o[e]).text("").append(t.buildTag("a",f[e].prevText,"",{href:"#"}))):(d=n(o[e]).text(),n(o[e]).find("a").remove(),t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").cellAddr)?n(o[e]).text("").append(t.buildTag("a",d,"",{href:this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").webAddr,target:"_blank"})):n(o[e]).text("").append(t.buildTag("a",d,"",{href:"#"}))),n(o[e]).find("a").addClass("e-hyperlinks"),this._dupDetails=!0,this.XLFormat.format({style:{color:"#428bca"}}),this._dupDetails=!1);else{for(t.isNullOrUndefined(r.webAddr)?(s=r.cellAddr,y=t.isNullOrUndefined(r.text)?o.eq(0).text():r.text,s.indexOf("!")>-1&&(w=s.split("!"),u=this._getSheetIndexByName(w[0]),s=w[1]),s.indexOf("$")>-1&&(s=s.split("$").join(""))):(v=r.webAddr,p=t.isNullOrUndefined(r.text)?o.eq(0).text():r.text,v.indexOf("http")===-1&&(v="http://"+v)),e=0,a=o.length;e<a;e++)l.push({rowIndex:n(o[e]).parent().index(),colIndex:o[e].cellIndex,prevLink:this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink")});for(this.isUndefined(s)?this.updateUniqueData({hyperlink:{webAddr:v}},null,o):this.updateUniqueData({hyperlink:{cellAddr:s+"_"+u}},null,o),e=0,a=o.length;e<a;e++)h=o.eq(e).text(),l[e].prevText=e===0?this._prevText:h,n(o.eq(e).find("a")).remove(),n(o.eq(e).contents()[0]).remove(),o.eq(e).hasClass("e-commentcell")&&o.eq(e).removeClass("e-commentcell")&&this.XLComment.setComment(o.eq(e),null,!1),b=this.XLEdit.getPropertyValue(o.eq(e).closest("tr").index(),o.eq(e)[0].cellIndex,"hyperlink",g),b.cellAddr?(h=e===0?y:h,o.eq(e).append(t.buildTag("a",h,"",{href:"#"})),l[e].curText=y):(h=e===0?p:h,o.eq(e).append(t.buildTag("a",h,"",{href:b.webAddr,target:"_blank"})),l[e].curText=p),l[e].curLink=this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink");n(o.find("a")).addClass("e-hyperlinks");this._dupDetails=!0;this.XLFormat.format({style:{color:"#428bca"}},i);this._dupDetails=!1;k.selCells=l;this.model.sheets[g]._importRendered||this._completeAction(k)}}},removeHyperlink:function(i,r,u,f,e){var o,c,l=[],y=this.getActiveSheetIndex(),h=[],a,s=this._getAlphaRangeCells(i),v={sheetIndex:y,reqType:"hyperlink",action:"delete"};for(s.find("a").contents().unwrap(),s.find("a").removeClass("e-hyperlinks"),o=0,c=s.length;o<c;o++)e&&this._isHiddenRow(n(s[o]).parent().index())||(h.push({rowIndex:n(s[o]).parent().index(),colIndex:s[o].cellIndex,prevLink:this.XLEdit.getPropertyValueByElem(n(s[o]),"hyperlink"),prevText:s.eq(o).text()}),this._dupDetails=!0,this.XLEdit.getPropertyValueByElem(n(s[o]),"hyperlink")&&(r?this.XLFormat.format({style:{"text-decoration":"underline"}},this._getAlphaRange(1,s[o].parentNode.rowIndex,s[o].cellIndex,s[o].parentNode.rowIndex,s[o].cellIndex)):this.XLFormat.format({style:{color:"#444445"}},this._getAlphaRange(1,s[o].parentNode.rowIndex,s[o].cellIndex,s[o].parentNode.rowIndex,s[o].cellIndex))),this._dupDetails=!1,this.clearRangeData(null,["hyperlink"],[s[o]]),h[h.length-1].curLink=t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(n(s[o]),"hyperlink"))?"":this.XLEdit.getPropertyValueByElem(n(s[o]),"hyperlink")(this._isUndoRedo&&!this._isSort)&&s.eq(o).text(f[o].prevText),h[h.length-1].curText=s.eq(o).text(),!this._isUndoRedo||this._isSort||t.isNullOrUndefined(f[o].prevLink)||(this.XLEdit._updateDataContainer(s[o],{hyperlink:f[o].prevLink}),a={rowIndex:f[o].rowIndex,colIndex:f[o].colIndex},this.XLSelection.selectRange(a,a),this._setLink([f[o]]),l.push(o)));for(o=0,c=l.length;o<c;o++)s.splice(l[o],1);v.selCells=h;v.reqType=t.isNullOrUndefined(u)?"hyperlink":"clear-link";this.model.sheets[y]._importRendered||this._isUndoRedo||this._isSort||this._completeAction(v)},_removeHyperlink:function(n,t,i){var u=this.getActiveSheetIndex(),r=this.getSheet(u).selectedRange;this.removeHyperlink(this._getAlphaRange(u,r[0],r[1],r[2],r[3]),n==="clear",n,t,i)},_openLink:function(){var n=this.getActiveSheetIndex(),t=this.getSheetElement(n).find(".e-activecell");this._hlClick(this.XLEdit.getPropertyValue(t.closest("tr").index(),t[0].cellIndex,"hyperlink",n))},_hlClick:function(n){var r,u,t,f,i=this.getActiveSheetIndex();this.model.enableContextMenu&&this.XLCMenu.hideCMenu();n.cellAddr?(r=this.getRangeIndices(n.cellAddr),t={rowIndex:r[0],colIndex:r[1]},f={rowIndex:r[2],colIndex:r[3]},u=n.cellAddr.split("_")[1]===0?i:Number(n.cellAddr.split("_")[1]),this.gotoPage(u,!1),this.getSheet(i)._activeCell=t,this.XLSelection.selectRange(t,f,u),this.getSheet(i)._startCell=t,this.getSheet(i)._endCell=f,this.XLScroll._scrollSelectedPosition(u,t),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()):(t={rowIndex:this.getSheet(i)._activeCell.rowIndex,colIndex:this.getSheet(i)._activeCell.colIndex},this.getSheet(i)._startCell=t,this.getSheet(i)._endCell=t,this._isValidUrl(n.webAddr)?window.open(n.webAddr,"_blank"):this._showAlertDlg("Alert","HyperLinkAlert"))},_isValidUrl:function(n){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(n)},showWaitingPopUp:function(){n("#"+this._id).data("ejWaitingPopup").show()},hideWaitingPopUp:function(){n("#"+this._id).data("ejWaitingPopup").hide()},_getSelRange:function(n){var t,i,r=this.getActiveSheetIndex();return t=n[0],i=n[n.length-1],this._generateHeaderText(r,t.colIndex+1)+(t.rowIndex+1)+":"+this._generateHeaderText(r,i.colIndex+1)+(i.rowIndex+1)},_getSelectedCells:function(n,i){var u,r;return t.isNullOrUndefined(i)?(u=this.model.sheets[n]._selectedCells,u.length>0&&(i=this._getSelRange(u),r=this.getRangeIndices(i))):(r=this.getRangeIndices(i),u=this.XLSelection._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]})),this.model.sheets[n]._selectedCells=u,r},_getHiddenCells:function(i,r,u,f){var e=this._dataContainer.sheets[i];return t.isNullOrUndefined(f[u.rowIndex])&&(f[u.rowIndex]={}),t.isNullOrUndefined(f[u.rowIndex][u.colIndex])&&(f[u.rowIndex][u.colIndex]={value:{},text:""}),t.isNullOrUndefined(e[u.rowIndex])||(f[u.rowIndex][u.colIndex].value=n.extend(!0,{},e[u.rowIndex][u.colIndex]),delete e[u.rowIndex][u.colIndex],r.removeClass("e-merge"),r[0].rowSpan=1,r[0].colSpan=1,f[u.rowIndex][u.colIndex].text=t.isNullOrUndefined(r[0].lastChild)?"":r[0].lastChild.nodeValue),r.empty(),f},_getRowSpan:function(n,t){for(var r=this.getRows(n)[0],u=0,i=t[0].rowIndex,f=t[t.length-1].rowIndex;i<=f;i++)this._hasClass(r[i],"e-fr-hide")||this._hasClass(r[i],"e-r-hide")||this._hasClass(r[i],"e-hide")||(u=u+1);return u},_getColSpan:function(n,t){for(var r=0,u=this._getJSSheetHeader(n).find("col"),i=t[0].colIndex,f=t[t.length-1].colIndex;i<=f;i++)this._hasClass(u[i],"e-fc-hide")||this._hasClass(u[i],"e-c-hide")||(r=r+1);return r},_getHiddenRowColumnCount:function(t,i){for(var f=this.getRangeIndices(i),e=0,o=0,u,s=this.getRows(t)[0],h=this._getContent(t).find("col"),r=f[0];r<=f[2];r++)(n(s[r]).hasClass("e-fr-hide")||n(s[r]).hasClass("e-r-hide"))&&(e=e+1);for(u=f[1];u<=f[3];u++)(n(h[u]).hasClass("e-fc-hide")||n(h[u]).hasClass("e-c-hide"))&&(o=o+1);return{hRow:e,hCol:o}},mergeCells:function(i,r){var f,c,a=[],e=this.getActiveSheetIndex(),v=n("#"+this._id+"_alertdlg"),u,o,h=!1,s,l;if((!t.isNullOrUndefined(i)||!(this.XLSelection.getSelectedCells(e).length<2))&&!(this._getAlphaRangeCells(i).length<2)&&(this._selMergeCells=[],this._mergeType="merge-cells",o=this._getSelectedCells(e,i),!this.isUndefined(o))){if(u=t.isNullOrUndefined(i)?this.model.sheets[e]._selectedCells:this.XLSelection._getSelectedRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]}),!this.model.sheets[e]._importRendered)if(this._mergeCenter){for(h=!1,f=0,c=u.length;f<c;f++)s=this.getCell(u[f].rowIndex,u[f].colIndex),(s[0].rowSpan>1||s[0].colSpan>1)&&(l=this._getHiddenRowColumnCount(e,this.XLEdit.getPropertyValueByElem(s,"mRange")),a=this._unMergeAllCells(e,f,u,[],l.hRow,l.hCol),this._dupDetails||this._isUndoRedo||(details={sheetIndex:e,cells:u,range:i,reqType:"merge-cells",action:"un-merge",operation:"un-merge",mCells:a},this._completeAction(details)),h=!0);this.performSelection(u[0],u[u.length-1])}else for(f=0,c=u.length;f<c;f++)if(s=this.getCell(u[f].rowIndex,u[f].colIndex),s[0].rowSpan===1&&s[0].colSpan===1){h=!1;break}!this.model.sheets[e]._importRendered&&!this._isUndoRedo&&this._rangeHasData(o)&&!r&&!h&&u.length>1?this._showAlertDlg("","MergeCellsAlert","MergeCells",498):h||this._mergeCells(e,u,{},[]);this.XLRibbon._updateRibbonIcons()}},_mergeCells:function(i,r,u,f){var a=this._dataContainer.sheets[i],v,y,s,o,p={},e,h,l=this._rcRegx,w=this._getContent(i).find("col"),b,c,k;if(s=r[0].rowIndex,o=r[0].colIndex,e=this.getCell(s,o),!e.parent().hasClass("e-fr-hide")&&w.eq(o).hasClass("e-fc-hide")||!e.parent().hasClass("e-r-hide")&&w.eq(o).hasClass("e-c-hide"))return{hideCell:[],mCells:[]};for(e.get(0).colSpan=r[r.length-1].colIndex-r[0].colIndex+1,e.get(0).rowSpan=this._getRowSpan(i,r),e.hasClass("e-mc-hide")&&(e.removeClass("e-mc-hide"),e[0].className.match(l[0])&&(e[0].className=e[0].className.replace(l,""))),this._selMergeCells.push(r[0]),this._mergeCenter&&e.addClass("e-calign"),b="e-rc-"+s+":"+o,e.addClass("e-merge"),c=1,k=r.length;c<k;c++)h=this.getCell(r[c].rowIndex,r[c].colIndex),h.hasClass("e-mc-hide")&&(h.removeClass("e-mc-hide"),h[0].className.match(l[0])&&(h[0].className=h[0].className.replace(l,""))),h.addClass("e-mc-hide "+b),u=this._getHiddenCells(i,h,r[c],u),this._selMergeCells.push(r[c]);return e.hasClass("e-commentcell")&&this.model.allowComments&&this.XLComment._updateCmntFrmCntnr(null,null,e),t.isNullOrUndefined(a[s])||n.extend(!0,p,a[s][o]),y=this._getSelRange(r),this.model.sheets[i]._activeCell=r[0],this.model.sheets[i]._importRendered||(this.performSelection(r[0],r[r.length-1]),this.XLEdit._updateDataContainer(e[0],{isMerge:!0,mRange:y,isCenterAlign:this._mergeCenter})),f.push({rowIndex:s,colIndex:o,prevObj:p,curObj:n.extend(!0,{},a[s][o])}),this.model.sheets[i]._importRendered||this._isUndoRedo||this._dupDetails||this._paste||this._dupDetails||this._mergeType==="merge-cells"&&(v={sheetIndex:i,cells:[{rowIndex:s,colIndex:o}],range:y,reqType:"merge-cells",action:"merge-all",hideCells:u,mCells:f},v.operation=this._mergeCenter?"merge-center":"merge-all",this._paste||this._completeAction(v)),this._mergeCenter=!1,this._paste=!1,{hideCells:u,mCells:f}},mergeAcrossCells:function(i,r){var e=this.getActiveSheetIndex(),s=n("#"+this._id+"_alertdlg"),u,f,o;t.isNullOrUndefined(i)&&this.XLSelection.getSelectedCells(e).length<2||this._getAlphaRangeCells(i).length<2||(this._selMergeCells=[],f=this._getSelectedCells(e,i),this.isUndefined(f))||(u=t.isNullOrUndefined(i)?this.model.sheets[e]._selectedCells:this.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]}),o=this._getAlphaRange(e,u[0].rowIndex,u[0].colIndex,u[u.length-1].rowIndex,u[u.length-1].colIndex),!this._isUndoRedo&&this._rangeHasData(f)&&!this.model.sheets[e]._importRendered&&!r&&u.length>1&&u[0].colIndex!=u[u.length-1].colIndex?this._showAlertDlg("","MergeCellsAlert","MergeAcrossCells",498):(u[0].colIndex!=u[u.length-1].colIndex||this._getAlphaRangeCells(o).filter(".e-merge").length)&&this._mergeAcrossCells(e,u),this.performSelection(u[0],u[u.length-1]),this.XLRibbon._updateRibbonIcons())},_mergeAcrossCells:function(t,i){var r,f,h,o=!0,e,c,l,a,v,y,s=[],u={mCells:[],hideCells:{}};for(this._mergeType="merge-across",r=0,h=i.length;r<h;r++)if(e=this.getCell(i[r].rowIndex,i[r].colIndex),e[0].rowSpan===1&&e[0].colSpan===1){o=!1;break}else e[0].rowSpan>1&&(o=!1);if(!o)for(v=i[0].rowIndex,y=i[i.length-1].rowIndex,l=i[0].colIndex,a=i[i.length-1].colIndex,r=v;r<=y;r++){for(s=[],f=l;f<=a;f++)s.push({rowIndex:r,colIndex:f});u=this._mergeCells(t,s,u.hideCells,u.mCells)}this.model.sheets[t]._importRendered||this._isUndoRedo||this._dupDetails||(c={sheetIndex:t,cells:n.extend(!0,[],this._selMergeCells),range:this._getSelRange(this._selMergeCells),reqType:"merge-cells",action:"merge-across",operation:"merge-across",hideCells:u.hideCells,mCells:u.mCells},this._paste||this._completeAction(c),this._paste=!1);this.performSelection(i[0],i[i.length-1])},unmergeCells:function(n){var r=this.getActiveSheetIndex(),e=[],i,h,u,o,s,f,c;if(u=this._getSelectedCells(r,n),!this.isUndefined(u)){for(this._selMergeCells=[],i=t.isNullOrUndefined(n)?this.model.sheets[r]._selectedCells:this.XLSelection._getSelectedRange({rowIndex:u[0],colIndex:u[1]},{rowIndex:u[2],colIndex:u[3]}),f=0,c=i.length;f<c;f++)s=this.XLEdit.getPropertyValue(i[f].rowIndex,i[f].colIndex,"mRange",r),this.isUndefined(s)||(o=this._getHiddenRowColumnCount(r,s),e=this._unMergeAllCells(r,f,i,e,o.hRow,o.hCol));n=this._getSelRange(i);this.performSelection(i[0],i[i.length-1]);this.model.sheets[r]._importRendered||this._isUndoRedo||this._dupDetails||(h={sheetIndex:r,cells:i,range:n,reqType:"merge-cells",action:"un-merge",operation:"un-merge",mCells:e},this._completeAction(h));this.XLRibbon._updateRibbonIcons()}},_unMergeAllCells:function(i,r,u,f,e,o){var s,h,e,o,p,l=this._dataContainer.sheets[i],w=this._rcRegx,nt,d={},y,b,k,c,a,v,g,tt=this.getRows(i)[0],it=this._getContent(i).find("col");if(a=u[r].rowIndex,v=u[r].colIndex,rowhdrrows=this._getJSSheetRowHeader(i).find(".e-table").get(0).rows,y=this.getCell(a,v),b=y.get(0).colSpan,k=y.get(0).rowSpan,b>1||k>1)for(y.hasClass("e-calign")&&(nt="center",y.removeClass("e-calign")),y.removeClass("e-merge"),n.extend(!0,d,l[a][v]),y.get(0).colSpan=1,y.get(0).rowSpan=1,t.isNullOrUndefined(l[a])||t.isNullOrUndefined(l[a][v])||(this.XLEdit.getPropertyValueByElem(y,"isMerge",i)&&n(rowhdrrows[a]).height()<y[0].offsetHeight&&this._setRowHdrHeight(i,a),delete l[a][v].isMerge,delete l[a][v].mRange,delete l[a][v].isCenterAlign),f.push({rowIndex:a,colIndex:v,prevObj:d,curObj:n.extend(!0,{},l[a][v])}),g=[],s=a;s<a+k+e;s++)for(h=v;h<v+b+o;h++)c=this.getCell(s,h),this._selMergeCells.push({rowIndex:s,colIndex:h}),c.hasClass("e-mc-hide")&&(this._isUndoRedo&&(c[0].rowSpan>1||c[0].colSpan>1)&&(g.push({rowIndex:s,colIndex:h,rowSpan:c[0].rowSpan,colSpan:c[0].colSpan}),c[0].rowSpan=1,c[0].colSpan=1),p=c[0].className.match(w)[0].replace("e-rc-","").split(":"),p.length>0&&parseInt(p[0])===a&&parseInt(p[1])===v&&(c.removeClass("e-mc-hide"),c[0].className.match(w)&&(c[0].className=c[0].className.replace(w,"")))),this._isUndoRedo&&!t.isNullOrUndefined(this._delCells)&&(t.isNullOrUndefined(this._delCells[s])||t.isNullOrUndefined(this._delCells[s][h])||t.isNullOrUndefined(l[s])||(l[s][h]=this._delCells[s][h].value,c.text(this._delCells[s][h].text),!t.isNullOrUndefined(l[s][h].isMerge)&&l[s][h].isMerge&&this.mergeCells(l[s][h].mRange,!0),!t.isNullOrUndefined(l[s][h].isMerge)&&l[s][h].isMerge&&this.mergeCells(l[s][h].mRange,!0))),c.hasClass("e-commentcell")&&this.model.allowComments&&this.XLComment._updateCmntFrmCntnr(null,null,c);return f},showHeaders:function(t){var i=this.getActiveSheetIndex(),r={};this.model.sheets[i].showHeader=t;this._isDisplayHeader=!0;n.extend(!0,r,this.model.scrollSettings);this.model.sheets[i].showHeader?(this._getJSSheetRowHeader(i).show(),this._getJSSheetHeader(i).show(),this._getContent(i).find(".e-content").removeClass("e-viewbrdr")):(this._getJSSheetRowHeader(i).hide(),this._getJSSheetHeader(i).hide(),this._getContent(i).find(".e-content").addClass("e-viewbrdr"));this.XLRibbon._heightWidthCalculation(i,r,{action:""})},showGridlines:function(n){var t=this.getActiveSheetIndex();this.model.sheets[t].showGridlines=n;this.model.sheets[t].showGridlines?this._getContent(t).find(".e-rowcell").removeClass("e-hborder"):this._getContent(t).find(".e-rowcell").addClass("e-hborder")},setSheetFocus:function(){n("#"+this._id).focus()},_diffNumbers:function(n,t){return n-t},_isValidDate:function(n){var t,i;return/^\d{1,4}[\.|\/|-]\d{1,2}[\.|\/|-]\d{1,4}$/.test(n)?(n=n.replace(/0*(\d*)/gi,"$1"),t=n.split(/[\.|\/|-]/),t[1]=t[1]-1,t[2].length<4&&(t[2]=parseInt(t[2])<50?2e3+parseInt(t[2]):1900+parseInt(t[2])),i=new Date(t[2],t[1],t[0]),i.getDate()!=t[0]||i.getMonth()!=t[1]||i.getFullYear()!=t[2]?!1:!0):!1},_isValidTime:function(n){for(var t,r,i=0,o=!1,f,e,u=0,s=n.length;u<s;u++){if(t=n.substring(u,u+1),(t<"0"||t>"9")&&t!=":"&&t!=" "&&t!="a"&&t!="A"&&t!="p"&&t!="P"&&t!="m"&&t!="M")return!1;t==":"&&i++;(t=="p"||t=="P"||t=="a"||t=="A")&&(o=!0)}return i<1||i>2?!1:(r=n.substring(0,n.indexOf(":")),parseFloat(r)<0||parseFloat(r)>23)?!1:o&&(parseFloat(r)<1||parseFloat(r)>12)?!1:(f=i==2?n.substring(n.indexOf(":")+1,n.lastIndexOf(":")):n.substring(n.indexOf(":")+1,n.length),parseFloat(f)<0||parseFloat(f)>59)?!1:(e=i==2?n.substring(n.lastIndexOf(":")+1,n.length):"00",parseFloat(e)<0||parseFloat(e)>59)?!1:!0},_setXY:function(n){var t=0,i=0;return n.type==="mousemove"||n.type==="mousedown"?(t=n.clientX,i=n.clientY):n.type==="touchmove"?(t=n.originalEvent.changedTouches[0].clientX,i=n.originalEvent.changedTouches[0].clientY):n.type==="MSPointerMove"&&(t=n.originalEvent.clientX,i=n.originalEvent.clientY),[t,i]},getBrowserDetails:function(){var t=navigator.userAgent.match(/(firefox|chrome|opera|msie|safari)\s?\/?(\d+(.\d+)*)/i);return!navigator.userAgent.match(/Trident\/7\./)?{browser:t[1].toLowerCase(),version:t[2]}:{browser:"msie",version:n.uaMatch(navigator.userAgent).version}},_getSelectedItems:function(n,i,r){var f,e,o,u;return n=n?n:this.getActiveSheetIndex(),u=this.getSheet(n),t.isNullOrUndefined(r)&&t.isNullOrUndefined(i)?(f=u._selectedCells,e=u._startCell,o=u._endCell,r=this._generateHeaderText(n,e.colIndex+1)+(e.rowIndex+1)+":"+this._generateHeaderText(n,o.colIndex+1)+(o.rowIndex+1)):(i=this.isUndefined(i)?this.getRangeIndices(r):i,f=this.getRange(i[0],i[1],i[2],i[3],n),r=this._generateHeaderText(n,i[1]+1)+(i[0]+1)+":"+this._generateHeaderText(n,i[3]+1)+(i[2]+1)),[f,r]},setBorder:function(n,t){var r="",s=n.style,f=n.ID,e=n.hexaCode,l,a,v,h,c,u,y,o=this._getContent(this.getActiveSheetIndex()).find("div:first-child");l=["bottomborder","topborder","leftborder","rightborder","outsideborder"];a=["thickboxborder","thickbottomborder","topandbottomborder","topandthickbottomborder"];v=["allborder"];h={topborder:{top:""},rightborder:{right:""},bottomborder:{bottom:""},leftborder:{left:""},outsideborder:{top:"",right:"",bottom:"",left:""},thickboxborder:{top:"2px solid",right:"2px solid",bottom:"2px solid",left:"2px solid"},thickbottomborder:{bottom:"2px solid"},topandbottomborder:{top:"1px solid",bottom:"1px solid"},topandthickbottomborder:{top:"1px solid",bottom:"2px solid"}};c={solid:"1px solid",dashed:"1px dashed",dotted:"1px dotted"};this._isGridBordering=this._isOutsideBordering=!1;switch(!0){case l.indexOf(f)>-1:u=h[f];for(i in u)r="",r=r+c[s]+" "+e,u[i]=r;this.XLFormat.applyBorder(u,t);break;case a.indexOf(f)>-1:u=h[f];for(i in u)r="",y=u[i].split(" "),r=y.length===2?r+u[i]+" "+e:r+u[i]+" "+s+" "+e,u[i]=r;this.XLFormat.applyBorder(u,t);break;case v.indexOf(f)>-1:r=r+c[s]+" "+e;this.XLFormat.applyBorder(r,t);break;case f==="noborder":this.XLFormat.applyBorder("noborder");break;case f==="drawborder":this.XLSelection._isOutsideBordering=!0;o.removeClass("e-ss-cursor");o.addClass("e-ss-drwbrdrcursor");break;case f==="drawbordergrid":this.XLSelection._isGridBordering=!0;o.removeClass("e-ss-cursor");o.addClass("e-ss-drwbrdrgridcursor")}},clearBorder:function(n){n=this.getRangeIndices(n);this.XLFormat.clearFormat(n,"border")},clearAllFormat:function(n){var a=this.getActiveCellElem(),u,f;if(a.length){var h=this.getActiveSheetIndex(),r=this.isUndefined(n)?this.getSheet(h).selectedRange:this.getRangeIndices(n),i=[],c={sheetIndex:h,reqType:"clear-format",range:r,bFormat:this.model.allowCellFormatting&&this.XLFormat.getHashCodeClassAsArray(r),wRange:[],hRange:[],cFormatRule:[]},e,o,s,l;for(this._dupDetails=!0,this.model.allowCellFormatting&&this.XLFormat.format({type:"general"}),e=this.getObjectKeys(this._dataContainer.sheets[h]),i[0]=r[0]>parseInt(e[0])?r[0]:parseInt(e[0]),i[2]=r[2]<parseInt(e[e.length-1])?r[2]:parseInt(e[e.length-1]),u=i[0];u<i[2]+1;u++)for(o=this.getObjectKeys(this._dataContainer.sheets[h][u]),i[1]=r[1]>parseInt(o[0])?r[1]:parseInt(o[0]),i[3]=r[3]<parseInt(o[o.length-1])?r[3]:parseInt(o[o.length-1]),f=i[1];f<i[3]+1;f++)s=this.getCell(u,f),s[0].className.indexOf("e-sswraptext")>-1&&c.wRange.push({rowIndex:u,colIndex:f}),l=t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(s,"cFormatRule"))?"":this.model.allowConditionalFormats&&this.XLCFormat.getCFRule(u,f)[this.XLCFormat.getCFRule(u,f).length-1],c.cFormatRule.push({rowIndex:u,colIndex:f,rule:l}),s.find("a").hasClass("e-hyperlinks")&&(c.hRange.push({rowIndex:u,colIndex:f,rowIndex:u,colIndex:f}),s.find("a").css({color:"#444445","text-decoration":"none"}).removeClass("e-hyperlinks")),s.hasClass("e-commentcell")&&s.removeClass("e-commentcell")&&this.XLComment.setComment(s,null,!1);t.isNullOrUndefined(e)||t.isNullOrUndefined(o)||this._checkTableRange(this._getAlphaRange(h,i[0],i[1],i[2],i[3]))&&(this.model.allowCellFormatting&&this.XLFormat.clearFormat(r),this.model.allowConditionalFormats&&this.XLCFormat.clearCF(!0),this.setWrapText(n,"unwrap"),this.XLRibbon._updateRibbonIcons(),this._dupDetails=!1,this._isUndoRedo||this._completeAction(c))}},clearContents:function(n){var f=this.getActiveCellElem(),t,i;if(f.length){n=this.isUndefined(n)?this.getSheet(r).selectedRange:this.getRangeIndices(n);var r=this.getActiveSheetIndex(),e=this.getRangeData(n),o={sheetIndex:r,reqType:"clear-content",range:n,bData:e},u;for(t=n[0];t<n[2]+1;t++)for(i=n[1];i<n[3]+1;i++)u=this.XLEdit.getPropertyValue(t,i,"hyperlink",r),this.isUndefined(u)||this.model.allowCellFormatting&&this.XLFormat.format({style:{"text-decoration":"underline"}},this._getAlphaRange(r,t,i,t,i)),this.model.allowComments&&this.XLComment._updateCmntFrmCntnr(t,i);this.clearRangeData(n,["value","value2","hyperlink"]);this._completeAction(o);this.setSheetFocus()}},clearAll:function(n){var v=this.getActiveCellElem(),i,u;if(v.length){var o=this.getActiveSheetIndex(),p=new RegExp("\\be-table.*?\\b","g"),f=[],r=this.isUndefined(n)?this.getSheet(o).selectedRange:this.getRangeIndices(n),w=this.getRangeData(r),e={sheetIndex:o,reqType:"clear-all",range:r,bFormat:this.model.allowCellFormatting&&this.XLFormat.getHashCodeClassAsArray(r),bData:w,selCells:[]},c=this._dataContainer.sheets[o],s,h,l,y,a=this.model.sheets[o].filterSettings.tableRange;for(this._dupDetails=!0,s=this.getObjectKeys(this._dataContainer.sheets[o]),f[0]=r[0]>parseInt(s[0])?r[0]:parseInt(s[0]),f[2]=r[2]<parseInt(s[s.length-1])?r[2]:parseInt(s[s.length-1]),i=f[0];i<f[2]+1;i++)for(h=this.getObjectKeys(this._dataContainer.sheets[o][i]),f[1]=r[1]>parseInt(h[0])?r[1]:parseInt(h[0]),f[3]=r[3]<parseInt(h[h.length-1])?r[3]:parseInt(h[h.length-1]),u=f[1];u<f[3]+1;u++)l=this.getCell(i,u),y=t.isNullOrUndefined(this.XLEdit.getPropertyValueByElem(l,"cFormatRule"))?"":this.model.allowConditionalFormats&&this.XLCFormat.getCFRule(i,u)[this.XLCFormat.getCFRule(i,u).length-1],t.isNullOrUndefined(c[i][u])||e.selCells.push({rowIndex:i,colIndex:u,prevLink:this.XLEdit.getPropertyValueByElem(l,"hyperlink"),curLink:{},prevText:l.text(),prevComment:this.XLEdit.getPropertyValueByElem(l,"comment"),mRange:t.isNullOrUndefined(c[i][u].mRange)?"":c[i][u].mRange,mergeCenter:!t.isNullOrUndefined(c[i][u].mRange)&&c[i][u].isCenterAlign,wrap:t.isNullOrUndefined(c[i][u].wrap)?"":c[i][u].wrap,cFormatRule:y});if(!t.isNullOrUndefined(s)&&!t.isNullOrUndefined(h)&&this._checkTableRange(this._getAlphaRange(o,f[0],f[1],f[2],f[3]))){if(v[0].className.indexOf("e-table")>-1&&(e.tabId=parseInt(v[0].className.match(p)[0].replace("e-table",""))),e.tabId>-1){for(e.tableObj=this.model.sheets[o]._tableManager[e.tabId],delete this.model.sheets[o]._tableManager[e.tabId],i=0,len=a.length;i<len;i++)if(a[i].tableID===e.tabId){e.filterObj=a[i];a.splice(i,1);break}this.element.find(".e-selected").removeClass("e-filterhdr e-table"+e.tabId);this.XLRibbon._toggleDesignTab()}this.model.allowComments&&this.XLComment.deleteComment(r);this.clearRangeData(r);this.model.allowCellFormatting&&this.XLFormat.clearFormat(r);this.model.allowConditionalFormats&&this.XLCFormat.clearCF(!0);this.unmergeCells(n);this.setWrapText(n,"unwrap");this._dupDetails=!1;this.XLRibbon._updateRibbonIcons();this._completeAction(e)}}},_checkTableRange:function(n){var u,f=this.getActiveSheetIndex(),e=new RegExp("\\be-table.*?\\b","g"),r,i=this.getRangeIndices(n);return(this.getCell(i[0],i[1])[0].className.indexOf("e-table")>-1&&(r=parseInt(this.getCell(i[0],i[1])[0].className.match(e)[0].replace("e-table",""))),t.isNullOrUndefined(r))?!0:(tRange=this.model.sheets[f]._tableManager[r].range,u=this._getAlphaRange(f,tRange[0],tRange[1],tRange[2],tRange[3]),n===u)?!0:void 0},clearTextNode:function(n,i){var r=this.getActiveSheetIndex(),u=n[0].parentNode.rowIndex,f=n[0].cellIndex,o=this._dataContainer.sheets[r],e=n[0].childNodes[n[0].childNodes.length-1];(i=i||"",this._checkIndicesInContainer(r,u,f,"rule")&&o[u][f].rule.type==="list")||t.isNullOrUndefined(e)||e.hasChildNodes("a")||(n[0].lastChild.textContent=i)},sheetRename:function(n){this._updateSheetNames(n)},_isSubMenuOpen:function(){for(var i=["_formatastable","_cellstyles","_Ribbon_CElement","_contextMenuCell","_contextMenuColumnHeader","_contextMenuRowHeader","_contextMenuFooter"],t=0,r=i.length;t<r;){if(n("#"+this._id+i[t]).is(":visible"))return!0;t++}return!1},copySheet:function(n,i,r){var y=this._getSheetIndex(y),u,f,a,e,v=!1,c=2,h,o=this.element.find("#NumericContainer").children().eq(n-1),l=i,s=this.model.sheets;if(!r&&s[l]._sheetName.text===o.text()){this.setSheetFocus();return}for(f=1,a=s.length;f<a;f++)s.length-1!==l&&s[l]._sheetName.text===s[f]._sheetName.text&&(u=f),o.text()===s[f]._sheetName.text&&(h=f);if(r){for(o.text().match(".*[ ]+[(]+[0-9]+[)]$")===null?e=o.text()+" ("+c+")":o.text().lastIndexOf(" ")>-1&&(c=parseInt(o.text().substring(o.text().lastIndexOf("(")+1,o.text().lastIndexOf(")"))),e=o.text().substring(0,o.text().lastIndexOf(" "))+" ("+c+")");!v;){for(e=e.substring(0,e.lastIndexOf(" "))+" ("+c+")",f=1,a=s.length;f<a;f++)e===s[f]._sheetName.text&&c++;c===parseInt(e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")")))&&(v=!0)}this._copySheetProcess(h,e);h=this.model.sheetCount;t.isNullOrUndefined(u)&&(u=h)}else!t.isNullOrUndefined(u)&&u>h&&(u=u-1);t.isNullOrUndefined(u)&&(u=l);r||u!==h?(this._swapSheetDtCntr(h,u),this.getPager().ejPager("option",{currentPage:l}),this.gotoPage(l,!1),this.setSheetFocus()):this.setSheetFocus()},getHyperlink:function(n){return this.XLEdit.getPropertyValueByElem(n,"hyperlink",this.getActiveSheetIndex())},getComment:function(n){return this.XLEdit.getPropertyValueByElem(n,"comment",this.getActiveSheetIndex())},_isvalidRange:function(n){var t=new RegExp(/^\$?(?:\b[a-z]{1,3})\$?(?:\d{1,7}):\$?(?:\b[a-z]{1,3})\$?(?:\d{1,7})$/i);return t.test(n)}});t.Spreadsheet.locale={};t.Spreadsheet.locale["en-US"]={Cut:"Cut",Copy:"Copy",FormatPainter:"Format Painter",Paste:"Paste",PasteValues:"Paste Values Only",PasteSpecial:"Paste",Filter:"Filter",FilterContent:"Turn on filtering for the selected cells.",FilterSelected:"Filter by Selected Cell's value",Sort:"Sort",Clear:"Clear",ClearContent:"Delete everything in the cell, or remove just the formatting, contents, comments or hyperlinks.",ClearFilter:"Clear Filter",ClearFilterContent:"Clear the filter and sort state for the current range of data.",SortAtoZ:"Sort A to Z",SortAtoZContent:"Lowest to Highest.",SortZtoA:"Sort Z to A",SortZtoAContent:"Highest to Lowest.",SortSmallesttoLargest:"Sort Smallest to Largest",SortLargesttoSmallest:"Sort Largest to Smallest",SortOldesttoNewest:"Sort Oldest to Newest",SortNewesttoOldest:"Sort Newest to Oldest",Insert:"Insert",InsertTitle:"Insert Cells",InsertContent:"Add new cells, rows, or columns to your workbook.<br /><br />FYI: To insert multiple rows or columns at a time, select multiple rows or columns in the sheet, and click Insert.",InsertSBContent:"Add cells, rows, columns, or sheets to your workbook.",Delete:"Delete",DeleteTitle:"Delete Cells",DeleteContent:"Delete cells, rows, columns, or sheets from your workbook.<br /><br />FYI: To delete multiple rows or columns at a time, select multiple rows or columns in the sheet, and click Delete.",FindSelectTitle:"Find & Select",FindSelectContent:"Click to see options for finding text in your document.",Title:"Spreadsheet",Ok:"OK",Cancel:"Cancel",Alert:"We couldn't do this for the selected range of cells. Select a single cell within a range of data and then try again.",HeaderAlert:"The command could not be completed as you are attempting to filter with the filter header. Select a single cell in the filter range and try the command again.",FlashFillAlert:"All the data next to your selection was checked and there was no pattern for filling in values.",Formatcells:"Format Cells",FontFamily:"Font",FFContent:"Pick a new font for your text.",FontSize:"Font Size",FSContent:"Change the size of your text.",IncreaseFontSize:"Increase Font Size",IFSContent:"Make your text a bit bigger.",DecreaseFontSize:"Decrease Font Size",DFSContent:"Make your text a bit smaller.",Bold:"Bold",Italic:"Italic",Underline:"Underline",Linethrough:"Linethrough",FillColor:"Fill Color",FontColor:"Font Color",TopAlign:"Top Align",TopAlignContent:"Align text to the top.",MiddleAlign:"Middle Align",MiddleAlignContent:"Align text so that it is centered between the top and bottom of the cell.",BottomAlign:"Bottom Align",BottomAlignContent:"Align text to the bottom.",WrapText:"Wrap Text",WrapTextContent:"Wrap extra-long text into multiple lines so you can see all of it.",AlignLeft:"Align Left",AlignLeftContent:"Align your content to the left.",AlignCenter:"Center",AlignCenterContent:"Center your content.",AlignRight:"Align Right",AlignRightContent:"Align your content to the right.",Undo:"Undo",Redo:"Redo",NumberFormat:"Number Format",NumberFormatContent:"Choose the format for your cells, such as percentage, currency, date or time.",AccountingStyle:"Accounting Style",AccountingStyleContent:"Format as dollar accounting number format.",PercentageStyle:"Percent Style",PercentageStyleContent:"Format as a percent.",CommaStyle:"Comma Style",CommaStyleContent:"Format with a thousands separator.",IncreaseDecimal:"Increase Decimal",IncreaseDecimalContent:"Show more decimal places for a more precise value.",DecreaseDecimal:"Decrease Decimal",DecreaseDecimalContent:"Show fewer decimal places.",AutoSum:"AutoSum",AutoSumTitle:"Sum",AutoSumContent:"Automatically add a quick calculation to your worksheet, such as sum or average.",Fill:"Fill",ExportXL:"Excel",ExportCsv:"CSV",SaveXml:"Save XML",BackgroundColor:"Fill Color",BGContent:"Color the background of the cells to make them stand out.",Color:"Font Color",ColorContent:"Change the color of your text.",Border:"Border",BorderContent:"Apply borders to the currently selected cells.",BottomBorder:"Bottom Border",TopBorder:"Top Border",LeftBorder:"Left Border",RightBorder:"Right Border",OutsideBorder:"Outside Borders",NoBorder:"No Border",AllBorder:"All Borders",ThickBoxBorder:"Thick Box Border",ThickBottomBorder:"Thick Bottom Border",TopandThickBottomBorder:"Top and Thick Bottom Border",DrawBorderGrid:"Draw Border Grid",DrawBorder:"Draw Border",TopandBottomBorder:"Top and Bottom Border",BorderColor:"Line Color",BorderStyle:"Line Style",Number:"Number is used for general display of numbers.",General:"General format cells have no specific number format.",Currency:"Currency format is used for general monetary values.",Accounting:"Accounting format lines up the currency symbols and decimal points.",Text:"Text format cell is displayed exactly as entered.",Percentage:"This Format multiplies the cell value by 100 and displays with percent symbol.",CustomMessage:"Type number format code, using one of existing codes as a starting point.",Fractions:"",Scientific:"",Type:"Type",CustomFormatAlert:"Enter a valid format",Date:"Date formats display date and time serial numbers as date values",File:"FILE",New:"New",Open:"Open",SaveAs:"Save As",Print:"Print",PrintContent:"Print the current sheet.",PrintSheet:"Print Sheet",PrintSelected:"Print Selected",PrintSelectedContent:"Select an area on the sheet you would like to print.",HighlightVal:"Format Invalid Data",ClearVal:"Clear Validation",Validation:"Validation",DataValidation:"Data Validation",DVContent:"Pick from a list of rules to limit the type of data that can be entered in a cell.",A4:"A4",A3:"A3",Letter:"Letter",PageSize:"Page Size",PageSizeContent:"Choose a page size for your document.",FormatCells:"FormatCells",ConditionalFormat:"Conditional Formatting",CFContent:"Easily spot trends and patterns in your data using colors to visually highlight important values.",And:"and",With:"with",GTTitle:"Greater Than",GTContent:"Format cells that are GREATER THAN:",LTTitle:"Less Than",LTContent:"Format cells that are LESS THAN:",BWTitle:"Between",BWContent:"Format cells that are BETWEEN:",EQTitle:"Equal To",EQContent:"Format cells that are EQUAL TO:",DateTitle:"A Date Occurring",DateContent:"Format cells that contain a DATE:",ContainsTitle:"Text That Contains",ContainsContent:"Format cells that contain the text:",GreaterThan:"Greater Than",LessThan:"Less Than",Between:"Between",EqualTo:"Equal To",TextthatContains:"Text that Contains",DateOccurring:"A Date Occurring",ClearRules:"Clear Rules",ClearRulesfromSelected:"Clear Rules from Selected Cells",ClearRulesfromEntireSheets:"Clear Rules from Entire Sheet",CellStyles:"Cell Styles",CellStylesContent:"A colorful style is a great way to make important data stand out on the sheet.",CellStyleHeaderText:"Good, Bad and Neutral/Titles and Headings/Themed Cell Styles",Custom:"Custom",CellStyleGBN:"Normal/Bad/Good/Neutral",CellStyleTH:"Heading 4/Title",CellsStyleTCS:"20% - Accent1/20% - Accent2/20% - Accent3/20% - Accent4/60% - Accent1/60% - Accent2/60% - Accent3/60% - Accent4/Accent1/Accent2/Accent3/Accent4",Style:"Style",FormatAsTable:"Format As Table",FormatasTable:"Format as Table",FATContent:"Quickly convert a range of cells to a table with its own style.",FATHeaderText:"Light/Medium/Dark",FATNameDlgText:"Table Name :/My table has headers",InvalidReference:"The range you have specified is invalid",ResizeAlert:"The specified range is invalid. The top of the table must remain in the same row, and the resulting table must overlap the original table. Specify a valid range.",RangeNotCreated:"Increasing the row beyond the maximum sheet rowcount is restricted in Format as Table.",ResizeRestrictAlert:"Increase or decrease of column count and decrease of row count is restricted in Format as Table.",FATResizeTableText:"Enter new data range for your table:",FATReizeTableNote:"Note: The headers must remain in the same row, and the resulting table range must overlap the original table range.",FormatAsTableAlert:"Cannot create a table with a single row. A table must have at least two rows, one for the table header, and one for data",FormatAsTableTitle:"Light 1/Light 2/Light 3/Light 4/Light 5/Light 6/Light 7/Light 8/Light 9/Light 10/Light 11/Light 12/Medium 1/Medium 2/Medium 3/Medium 4/Medium 5/Medium 6/Medium 7/Medium 8/Dark 1/Dark 2/Dark 3/Dark 4",NewTableStyle:"New Table Style",ResizeTable:"Resize Table",ResizeTableContent:"Resize this table by adding or removing rows and columns.",ConvertToRange:"Convert to Range",ConvertToRangeContent:"Convert this table into a normal range of cells.",ConverToRangeAlert:"Do you want to convert the table to a normal range?",TableID:"Table ID:",Table:"Table",TableContent:"Create a table to organize and analyze related data.",TableStyleOptions:"First Column/Last Column/Total Row/Filter Button",Format:"Format",NameManager:"Name Manager",NameManagerContent:"Create, edit, delete and find all the names used in the workbook.<br /><br />Names can be used in formulas as substitutes for cell references.",DefinedNames:"Defined Names",DefineName:"Define Name",DefineNameContent:"Define and apply names.",UseInFormula:"Use In Formula",UseInFormulaContent:"Choose a name used in this workbook and insert it into the current formula.",Refersto:"Refers to",RefersTo:"Refers To",Name:"Name",Scope:"Scope",NMNameAlert:"The name that you entered is not valid./Reason for this can include:/The name does not begin with a letter or an underscore/The name contains a space or other invalid characters/The name conflicts with a spreadsheet built-in name or the name of another object in the workbook",NMUniqueNameAlert:"The name entered already exists. Enter a unique name.",NMRangeAlert:"Enter a valid range",FORMULAS:"FORMULAS",Value:"Values",DataValue:"Values:",Formula:"Formulas",MissingParenthesisAlert:"Your formula is missing a parenthesis--) or (. Check the formula, and then add the parenthesis in the appropriate place.",UnsupportedFile:"Unsupported File",IncorrectPassword:"Unable to open the file or worksheet with the given password",InvalidUrl:"Please specify proper URL",Up:"Up",Down:"Down",Sheet:"Sheet",Workbook:"Workbook",Rows:"By Rows",Columns:"By Columns",FindReplace:"Find Replace",FindnReplace:"Find and Replace",Find:"Find",Replace:"Replace",FindLabel:"Find what:",ReplaceLabel:"Replace with:",ReplaceAll:"Replace All",Close:"Close",FindNext:"Find Next",FindPrev:"Find Prev",Settings:"Settings",MatchCase:"Match case",MatchAll:"Match entire cell contents",Within:"Within:",Search:"Search:",Lookin:"Look in:",shiftright:"Shift cells right",shiftbottom:"Shift cells down",entirerow:"Entire row",entirecolumn:"Entire column",shiftup:"Shift cells up",shiftleft:"Shift cells left",Direction:"Direction:",GoTo:"Go To",GoToName:"Go to:",Reference:"Reference:",Special:"Special",Select:"Select",Comments:"Comments",Formulas:"Formulas",Constants:"Constants",RowDiff:"Row differences",ColDiff:"Column differences",LastCell:"Last cell",CFormat:"Conditional formats",Blanks:"Blanks",GotoError:"Error",GotoLogicals:"Logicals",GotoNumbers:"Numbers",GotoText:"Text",FindSelect:"Find & Select",Comment:"Comment",NewComment:"New",InsertComment:"Insert Comment",EditComment:"Edit",DeleteComment:"Delete Comment",DeleteCommentContent:"Delete the selected comment.",HideComment:"Hide Comment",Next:"Next",NextContent:"Jump to the next comment.",Previous:"Previous",PreviousContent:"Jump to the previous comment.",ShowHide:"Show/Hide Comment",ShowHideContent:"Show or hide the comment on the active cell.",ShowAll:"Show All Comments",ShowAllContent:"Display all comments in the sheet.",UserName:"User Name",Hide:"Hide",Unhide:"Unhide",Add:"Add",DropAlert:"Do you want to replace the existing data?",PutCellColor:"Put Selected Cell Color To The Top",PutFontColor:"Put Selected Font Color To The Top",WebPage:"Web Page",WorkSheet:"Worksheet Reference",SheetReference:"Sheet Reference",InsertHyperLink:"Insert Hyperlink",HyperLink:"Hyperlink",EditLink:"Editlink",OpenLink:"Openlink",HyperlinkText:"Text:",RemoveLink:"Removelink",WebAddress:"Web Address:",CellAddress:"Cell Reference:",SheetIndex:"Select a place in this document",ClearAll:"Clear All",ClearFormats:"Clear Formats",ClearContents:"Clear Contents",ClearComments:"Clear Comments",ClearHyperLinks:"Clear Hyperlinks",SortFilter:"Sort & Filter",SortFilterContent:"Organize your data so it's easier to analyze.",NumberStart:"Minimum:",NumberEnd:"Maximum:",DecimalStart:"Minimum",DecimalEnd:"Maximum:",DateStart:"Start Date:",DateEnd:"End Date:",ListStart:"Source:",FreeText:"Show error alert after invalid data is entered",ListEnd:"Cell Reference:",TimeStart:"Start Time:",TimeEnd:"End Time:",TextLengthStart:"Minimum:",TextLengthEnd:"Maximum:",CommentFindEndAlert:"Spreadsheet reached the end of the workbook. Do you want to continue reviewing from the beginning of the workbook?",InsertSheet:"Insert",DeleteSheet:"Delete",RenameSheet:"Rename",MoveorCopy:"Move or Copy",HideSheet:"Hide",UnhideSheet:"Unhide",SheetRenameAlert:"That name is already taken. Try a different one.",SheetRenameEmptyAlert:"You typed an invalid name for a sheet. Make sure that:<ul><li>The name that you type does not exceed 31 characters.<\/li><li>The name does not contain any of the following characters:  / ? * [ or  ]<\/li><li>You did not leave the name blank.<\/li><\/ul>",SheetDeleteAlert:"You can't undo deleting sheets, and you might be removing some data. If you don't need it, click OK to delete.",SheetDeleteErrorAlert:"A workbook must contain at least one visible worksheet. To hide, delete, or move the selected sheet, you must first insert a new sheet or unhide a sheet that is already hidden.",CtrlKeyErrorAlert:"That command cannot be used on  multiple selections.",MoveToEnd:"Move To End",Beforesheet:"Before sheet:",CreateaCopy:"Create a copy",AutoFillOptions:"Copy Cells/Fill Series/Fill Formatting Only/Fill Without Formatting/Flash Fill",NumberValidationMsg:"Enter only digits",DateValidationMsg:"Enter only date",Required:"Required",TimeValidationMsg:"The time you entered for the Time is invalid.",cellAddrsValidationMsg:"Reference is not valid.",PivotTable:"Pivot Table",PivotTableContent:"Easily arrange and summarize complex data in a PivotTable.",NumberTab:"Number",AlignmentTab:"Alignment",FontTab:"Font",BorderTab:"Border",FillTab:"Fill",textalignment:"Text alignment",horizontal:"Horizontal:",vertical:"Vertical:",indent:"Indent",textcontrol:"Text Control",wraptext:"Wrap text",fontgroup:"Font:",fontstyle:"Font style:",size:"Size:",Size:"Page size",effects:"Effects:",underline:"Underline",strikethrough:"Strikethrough",overline:"Overline",color:"Color:",normalfont:"Normal font",preview:"Preview",previewtext:"AaBbCcYyZz",line:"Line",style:"Style:",presets:"Presets",none:"None",outline:"Outline",border:"Border",allside:"All sides",backgroundcolor:"Background Color:",inscells:"Insert Cells",insrows:"Insert Sheet Rows",inscols:"Insert Sheet Columns",inssheet:"Insert Sheet",delcells:"Delete Cells",delrows:"Delete Sheet Rows",delcols:"Delete Sheet Columns",delsheet:"Delete Sheet",HyperLinkAlert:"The address of this site is not valid.Check the address and try again.",ReplaceData:"All done. We made / replacements.",NotFound:"We couldn't find what you were looking for. Select settings tab for more ways to search",Data:"Data:",Allow:"Allow:",IgnoreBlank:"Ignore blank",NotFind:"Unable to find the match to replace",freezePanes:"Freeze Panes",FreezeRow:"Freeze Top Row",FreezeColumn:"Freeze First Column",unfreezePanes:"Unfreeze Panes",DestroyAlert:"Are you sure you want to destroy the current workbook without saving and create a new workbook?",ImageValAlert:"Upload image files only",Pictures:"Pictures",PicturesTitle:"From File",PicturesContent:"Insert pictures from computer or from other computers that you are connected to.",ImportAlert:"Are you sure you want to destroy the current workbook without saving and open a new workbook?",UnmergeCells:"Unmerge Cells",MergeCells:"Merge Cells",MergeAcross:"Merge Across",MergeAndCenter:"Merge & Center",MergeAndCenterContent:"Combine and center the contents of the selected cells in a new larger cell.",MergeCellsAlert:"Merging Cells keeps only upper left cell value and discards the other values",Axes:"Axes",PHAxis:"Primary Horizontal",PVAxis:"Primary Vertical",AxisTitle:"Axis Title",CTNone:"None",CTCenter:"Center",CTFar:"Far",CTNear:"Near",DataLabels:"Data Labels",DLNone:"None",DLCenter:"Center",DLIEnd:"Inside End",DLIBase:"Inside Base",DLOEnd:"Outside End",ErrorBar:"Error Bars",Gridline:"Gridlines",PMajorH:"Primary Major Horizontal",PMajorV:"Primary Major Vertical",PMinorH:"Primary Minor Horizontal",PMinorV:"Primary Minor Vertical",Legend:"Legends",LNone:"None",LLeft:"Left",LRight:"Right",LBottom:"Bottom",LTop:"Top",ChartTitleDlgText:"Enter Title",ChartTitle:"Title",InvalidTitle:"You typed an invalid name for the Title.",CorrectFormat:"Select the correct Format File",ResetPicture:"Reset Picture",ResetPictureContent:"Discard all of the formatting changes made to this picture.",PictureBorder:"Picture Border",PictureBorderContent:"Pick the color, width, and line style for the outline of your shape.",ResetSize:"Reset Picture & Size",Height:"Height",Width:"Width",ThemeColor:"Theme Colors",NoOutline:"No Outline",Weight:"Weight",Dashes:"Dashes",ColumnChart:"2-D Column/3-D Column",ColumnChartTitle:"Insert Column Chart",ColumnChartContent:"Use this chart type to visually compare values across a few categories.",BarChart:"2-D Bar/3-D Bar",BarChartTitle:"Insert Bar Chart",BarChartContent:"Use this chart type to visually compare values across a few categories when the chart shows duration or the category text is long.",StockChart:"Radar",StockChartTitle:"Insert Radar Chart",StockChartContent:"Use this chart type to show values relative to a center point.",LineChart:"2-D Line",LineChartTitle:"Insert Line Chart",LineChartContent:"Use this chart type to show trends over time (years, months, and days) or categories.",AreaChart:"2-D Area/3-D Area",AreaChartTitle:"Insert Area Chart",AreaChartContent:"Use this chart type to show trends over time (years, months, and days) or categories. Use it to highlight the magnitude of change over time.",ComboChart:"Combo",PieChart:"Pie",PieChartTitle:"Insert Pie/Doughnut Chart",PieChartContent:"Use this chart type to show proportions of a whole. Use it when the total of your numbers is 100%.",ScatterChart:"Scatter",ScatterChartTitle:"Insert Scatter (X, Y) Chart",ScatterChartContent:"Use this chart type to show the relationship between sets of values.",ClusteredColumn:"Clustered&nbsp;Column",StackedColumn:"Stacked&nbsp;Column",Stacked100Column:"100%&nbsp;Stacked&nbsp;Column",Cluster3DColumn:"3-D&nbsp;Clustered&nbsp;Column",Stacked3DColumn:"3-D&nbsp;Stacked&nbsp;Column",Stacked100Column3D:"3-D&nbsp;100%&nbsp;Stacked&nbsp;Column",ClusteredBar:"Clustered&nbsp;Bar",StackedBar:"Stacked&nbsp;Bar",Stacked100Bar:"100%&nbsp;Stacked&nbsp;Bar",Cluster3DBar:"3-D&nbsp;Clustered&nbsp;Bar",Stacked3DBar:"3-D&nbsp;Stacked&nbsp;Bar",Stacked100Bar3D:"3-D&nbsp;100%&nbsp;Stacked&nbsp;Bar",Radar:"Radar",RadarMarkers:"Radar&nbsp;with&nbsp;Markers",Line:"Line",LineMarkers:"Line&nbsp;with&nbsp;Markers",Area:"Area",StackedArea:"Stacked&nbsp;Area",Stacked100Area:"100%&nbsp;Stacked&nbsp;Area",Pie:"Pie",Pie3D:"3-D&nbsp;Pie",Doughnut:"Doughnut",Scatter:"Scatter",ChartRange:"Chart Range",XAxisRange:"Enter X-axis range:",YAxisRange:"Enter Y-axis range:",LegendRange:"Enter legend range:",YAxisMissing:"Enter Y-axis range to create chart",InvalidYAxis:"Y-axis range must be within the selected range",InvalidXAxis:"X-axis range must be within the selected range",InvalidLegend:"Legend range must be within the selected range",InvalidXAxisColumns:"X-axis range should be within a single column",FreezePanes:"Freeze Panes",FreezePanesContent:"Freeze a portion of the sheet to keep it visible while you scroll through the rest of the sheet.",PasteTitle:"Paste (Ctrl+V)",PasteContent:"Add content on the Clipboard to your document.",PasteSplitContent:"Pick a paste option, such as keeping formatting or pasting only content.",CutTitle:"Cut (Ctrl+X)",CutContent:"Remove the selection and put it on the Clipboard so you can paste it somewhere else.",CopyTitle:"Copy (Ctrl+C)",CopyContent:"Put a copy of the selection on the Clipboard so you can paste it somewhere else.",FPTitle:"Format Painter",FPContent:"Like the look of a particular selection? You can apply that look to other content in the document.",BoldTitle:"Bold (Ctrl+B)",BoldContent:"Make your text bold.",ItalicTitle:"Italic (Ctrl+I)",ItalicContent:"Italicize your text.",ULineTitle:"Underline (Ctrl+U)",ULineContent:"Underline your text.",LineTrTitle:"Strike Through (Ctrl+L)",LineTrContent:"Cross something out by drawing a strike through it.",UndoTitle:"Undo (Ctrl+Z)",UndoContent:"Undo your last action.",RedoTitle:"Redo (Ctrl+Y)",RedoContent:"Redo your last action.",TableTitle:"Table (Ctrl+T)",HyperLinkTitle:"Add a Hyperlink (Ctrl+K)",HyperLinkContent:"Create a link in your document for quick access to webpages and files. <br /><br />Hyperlinks can also take you to places in your document.",NewCommentTitle:"Insert a Comment",NewCommentContent:"Add a note about this part of the document.",AddChartElement:"Add Chart Element",AddChartElementContent:"Add elements to the created chart.",SwitchRowColumn:"Switch Row/ Column",SwitchRowColumnContent:"Swap the data over the axis.",MergeAlert:"We can't do that to a merged cell.",UnhideDlgText:"Unhide Sheet:",ChartThemes:"Chart Themes",ChartThemesContent:"Pick a new theme for your chart.",ChangePicture:"Change Picture",ChangePictureContent:"Change to a different picture, preserving the formatting and size of the current picture.",ChangeChartType:"Change Chart Type",SelectData:"Select Data",SelectDataContent:"Change the data range included in the chart.",Sum:"Sum",Average:"Average",CountNumber:"Count Numbers",Max:"Max",Min:"Min",ChartType:"Change Chart Type",ChartTypeContent:"Change to a different chart type.",AllCharts:"All Charts",defaultfont:"Default",LGeneral:"General",LCurrency:"Currency",LAccounting:"Accounting",LDate:"Date",LTime:"Time",LPercentage:"Percentage",LFraction:"Fraction",LScientific:"Scientific",LText:"Text",LCustom:"Custom",Top:"Top",Center:"Center",Bottom:"Bottom",Left:"Left (Indent)",Right:"Right",Justify:"Justify",GeneralTxt:"General format cells have no specific number format.",NegativeNumbersTxt:"Negative Numbers",ThousandSeparatorTxt:"Use 1000 Separator by (,)",DecimalPlacesTxt:"Decimal Places:",TextTxt:"Text format cells are treated as text even when a number is in the cell. The cell is displayed exactly as entered.",BoldItalic:"Bold Italic",Regular:"Regular",HyperLinkHide:"<<Selection in Document>>",InvalidSheetIndex:"Specify proper SheetIndex",HugeDataAlert:"File too large to open.",TitleColumnChart:"Clustered Column/Stacked Column/100% Stacked Column/3D Clustered Column/3D Stacked Column/ 3D 100% Stacked Column",TitleBarChart:"Clustered Bar/Stacked Bar/100% Stacked Bar/3D Clustered Bar/3D Stacked Bar/3D 100% Stacked Bar",TitleRadarChart:"Radar/Radar with Markers",TitleLineChart:"Line/Line with Markers",TitleAreaChart:"Area/Stacked Area/100% Stacked Area",TitlePieChart:"Pie/3D Pie/Doughnut",TitleScatterChart:"Scatter",BetweenAlert:"The Maximum must be greater or equal to the Minimum.",BorderStyles:"Solid/Dashed/Dotted",FPaneAlert:"Freeze Pane is not applied for the First Cell",ReplaceNotFound:"Spreadsheet cannot find a match.",BlankWorkbook:"Blank workbook",SaveAsExcel:"Save As Excel",SaveAsCsv:"Save As CSV",PrintSheet:"Print Sheet",PrintSelected:"Print Selected",Design:"DESIGN",NewName:"New Name",FormulaBar:"Formula Bar",NameBox:"Name Box",NumberValMsg:"Decimal values cannot be used for number conditions.",NumberAlertMsg:"Enter only digits.",ListAlert:"Cell range is incorrect, Please enter correct cell range.",ListValAlert:"The list source must be a delimited list, or a reference to single row or column.",ListAlertMsg:"The value you entered is not valid",AutoFillTitle:"AutoFillOptions",NewSheet:"New Sheet",FullSheetCopyPasteAlert:"We can't paste because the Copy area and paste area aren't the same size.",Heading:"Headings",Gridlines:"Gridlines",Firstsheet:"Scroll to the first sheet",Lastsheet:"Scroll to the last sheet",Nextsheet:"Scroll to the next sheet",Prevsheet:"Scroll to the previous sheet"};t.Spreadsheet.scrollMode={Normal:"normal",Infinite:"infinite"};t.Spreadsheet.AutoFillOptions={CopyCells:"copycells",FillSeries:"fillseries",FillFormattingOnly:"fillformattingonly",FillWithoutFormatting:"fillwithoutformatting",FlashFill:"flashfill"};t.Spreadsheet.autoFillDirection={Up:"up",Right:"right",Down:"down",Left:"left"};t.Spreadsheet.pageSize={A4:"A4",A3:"A3",Letter:"Letter"};t.Spreadsheet.Actions={Sorting:"sorting",Selection:"selection",AutoFill:"autofill",CellNavigation:"cellnavigation",Filtering:"filtering"};t.Spreadsheet.exportType={Excel:"Excel",Csv:"Csv"};t.Spreadsheet.CellType={String:"string",Number:"number",Custom:"custom",Formula:"formula",Time:"time",LongDate:"longdate",ShortDate:"shortdate",Scientific:"scientific",Fraction:"fraction",Text:"text",General:"general",Accounting:"accounting",Currency:"currency",Percentage:"percentage",Date:"date",DateTime:"datetime"};t.Spreadsheet.SupportedStyles={FontFamily:"font-family",FontSize:"font-size",FontStyle:"font-style",FontWeight:"font-weight",TextAlign:"text-align",TextDecoration:"text-decoration",TextIndent:"text-indent",VerticalAlign:"vertical-align"};t.Spreadsheet.Validation={">":"GreaterThan",">=":"GreaterOrEqualTo","<":"LessThan","<=":"LessThanOrEqualTo","==":"EqualTo","!=":"NotEqualTo","!":"Not","=":""};t.Spreadsheet.ValidationText={">":"greater than",">=":"greater than or equal to","<":"less than","<=":"less than or equal to","==":"equal to","!=":"not equal to","!":" not","=":""};t.Spreadsheet.msg=" ";t.Spreadsheet.getMsg=function(){return t.Spreadsheet.msg};t.Spreadsheet.SelectionType={Row:"row",Column:"column",Default:"default"};t.Spreadsheet.SelectionUnit={Single:"single",Range:"range",MultiRange:"multirange"}})(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.selection=function(n){this.XLObj=n;this._isRightClick=!1;this._colhdrClick=!1;this._rowhdrClick=!1;this._aFillDownHandler=!1;this._isOutsideBordering=!1;this._isGridBordering=!1;this._isRowSelected=!1;this._isColSelected=!1;this._isSheetSelected=!1;this._isEndReached=!0};t.spreadsheetFeatures.selection.prototype={_selectionMouseDownHandler:function(i){i.preventDefault();var u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex()),r=i.target;u._on(n(document),"mouseup",this._mouseUpHandler);i.which===3||i.button===2||u.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.Single?this._isRightClick=!0:u._on(u.element,"mousemove",this._mouseMoveHandler);r.tagName=="TD"?(u.XLEdit._isFormulaEdit?(i.ctrlKey&&(this._clearBorder(u._arrayAsString(u._ctrlFormulaBorder)),u._ctrlKeyCount=u._formulaRange.length),u._dStartCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex}):i.shiftKey&&f._startCell.rowIndex!=-1?f._endCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex}:(f._startCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},f._activeCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex}),r.className.indexOf("e-rowheader")>-1&&(this._rowhdrClick=!0)):r.parentNode.tagName=="TH"?(i.shiftKey&&f._startCell.rowIndex!=-1?f._endCell={rowIndex:0,colIndex:r.parentNode.cellIndex}:(f._startCell={rowIndex:0,colIndex:r.parentNode.cellIndex},f._activeCell={rowIndex:0,colIndex:r.parentNode.cellIndex}),r.className.indexOf("e-headercelldiv")>-1&&(this._colhdrClick=!0)):r.className=="e-autofill"&&(this._aFillDownHandler=!0)},_mouseMoveHandler:function(i){var o,f=this,e=f.XLSelection,s=f.getActiveSheetIndex(),u=f.getSheet(s),r=i.target,h,c=f.model.selectionSettings.selectionType,l=t.Spreadsheet.SelectionType;if(r.tagName=="TD"){if(this.XLSelection._isEndReached=!1,f._getContent(s).find("td").removeClass(f._ctrlFormulaBorder[f._ctrlKeyCount%6].join(" ")),f.XLEdit._isFormulaEdit){i.ctrlKey?(f._dEndCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},e._processFormulaRange(f._ctrlFormulaBorder,!0)):(f._dEndCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},e._processFormulaRange(f._ctrlFormulaBorder,!0));return}if(e._aFillDownHandler&&n(r).parents(".e-rowheadercontent").length===0){f.model.allowAutoFill&&f.XLDragFill._selectAutoFillRange(r);return}if(u._startCell=u._activeCell,u._endCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},e._processBoundary(),n(r).parents(".e-spreadsheetcontentcontainer").length>0){if(i.ctrlKey&&f.model.selectionSettings.selectionType===t.Spreadsheet.SelectionType.Default&&f.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.MultiRange){f._getContent(f.getActiveSheetIndex()).find("td").removeClass("e-activecell e-focusright e-focusbottom");h=f.swapRange([u._startCell.rowIndex,u._startCell.colIndex,u._endCell.rowIndex,u._endCell.colIndex]);f.getRange(h[0],h[1],h[2],h[3]).addClass("e-ctrlselected");e._focusRange(u._startCell,u._endCell,f._selectionBorder);f.model.allowAutoFill&&f.XLDragFill.hideAutoFillElement();return}c===l.Row||e._rowhdrClick?e.selectRows(u._startCell.rowIndex,u._endCell.rowIndex):c===l.Column||e._colhdrClick?e.selectColumns(u._startCell.colIndex,u._endCell.colIndex):e.selectRange(u._startCell,u._endCell,r)}else if(n(r).parents(".e-rowheadercontent").length>0)e._colhdrClick||e._rowhdrClick?c===l.Column?e.selectColumns(0,u.colCount-1):e.selectRows(u._startCell.rowIndex,u._endCell.rowIndex):(o={position:"horizontal",action:"Decrement"},e._scrollCalculation(s,r,o));else return}else if(t.isNullOrUndefined(r.parentNode)||r.parentNode.tagName!="TH")if(r.className.indexOf("e-hhandlespace")>-1||r.className.indexOf("e-hhandle")>-1||r.className.indexOf("e-hup")>-1||r.className.indexOf("e-hdown")>-1)o={position:"vertical",action:"Increment"},e._scrollCalculation(s,r,o);else if(r.className.indexOf("e-vhandlespace")>-1||r.className.indexOf("e-vhandle")>-1||r.className.indexOf("e-vup")>-1||r.className.indexOf("e-vdown")>-1)o={position:"horizontal",action:"Increment"},e._scrollCalculation(s,r,o);else return;else u._endCell={rowIndex:0,colIndex:r.parentNode.cellIndex},u._startCell=u._activeCell,e._processBoundary(),e._colhdrClick||e._rowhdrClick?c===l.Row?e.selectRows(0,u.rowCount-1):e.selectColumns(u._startCell.colIndex,u._endCell.colIndex):(o={position:"vertical",action:"Decrement"},e._scrollCalculation(s,r,o))},_mouseUpHandler:function(i){var l,y,s,h,o,r=this,u=r.XLSelection,p=r.getActiveSheetIndex(),f=r.getSheet(p),c=f.selectedRange,k=r.getSheetElement(p),e=i.target,a=r.model.selectionSettings.selectionType,v=t.Spreadsheet.SelectionType,w,b;if(r._off(n(document),"mouseup",u._mouseUpHandler)._off(r.element,"mousemove",u._mouseMoveHandler),e.tagName=="TD"||e.tagName=="INPUT"||e.tagName=="DIV"&&u._aFillDownHandler){if(n(e).parents(".e-rowheadercontent").length>0&&(u._isOutsideBordering=u._isGridBordering=!1),r._preventctrlkey=i.ctrlKey?!0:!1,r.XLEdit._isFormulaEdit){r._getContent(r.getActiveSheetIndex()).find("td").removeClass(r._ctrlFormulaBorder.join(" ").replace(/,/g," "));i.ctrlKey?(r._dEndCell={rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex},u._processFormulaRange(r._formulaBorder)):(u._clearBorder(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")),r._ctrlKeyCount=0,r._dEndCell={rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex},u._processFormulaRange(r._formulaBorder),r._formulaRange=[]);r._formulaRange.push(r._getProperAlphaRange(p,r._dStartCell.rowIndex,r._dStartCell.colIndex,r._dEndCell.rowIndex,r._dEndCell.colIndex));return}if(u._aFillDownHandler){if(y=e.tagName==="DIV",h=y?f._endCell:{rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex},o=r.model.allowAutoFill&&r.XLDragFill._getAutoFillRange(h),o)"direction"in o?(r._pStartCell=f._startCell,r._pEndCell=y?f._selectedCells[f._selectedCells.length-1]:f._endCell,r._pFillCell=h,r.inRange(f.selectedRange,h.rowIndex,h.colIndex)?r.clearRangeData(null,null,n(u.getSelectedCells()).not(".e-autofillcell")):r.model.allowAutoFill&&r.XLDragFill.autoFill({dataRange:f.selectedRange,fillRange:o.fillRange,direction:o.direction}),f._startCell=o.startCell,f._endCell=o.endCell):u._aFillDownHandler=!1;else return;u.refreshSelection(r.swapRange([o.startCell.rowIndex,o.startCell.colIndex,o.endCell.rowIndex,o.endCell.colIndex]))}else if(u._isOutsideBordering||u._isGridBordering)if(s="1px "+r._borderStyle+" "+r._borderColor,f._endCell=u._isRightClick?f._startCell:{rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex},n(e).parents(".e-spreadsheetcontentcontainer").length>0)u._isGridBordering?r.XLFormat.applyBorder(s):r.XLFormat.applyBorder({top:s,right:s,bottom:s,left:s}),u._cleanUp(),r.model.allowAutoFill&&r.XLDragFill.hideAutoFillElement();else return;else if(e.tagName=="INPUT"&&n(e).parents("tr").length>0?f._endCell=u._isRightClick?f._startCell:{rowIndex:n(e).parents("tr")[0].rowIndex,colIndex:n(e).parents("td")[0].cellIndex}:u._isRightClick?f._endCell=f._startCell:(f._startCell=f._activeCell,f._endCell={rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex},u._processBoundary()),n(e).parents(".e-spreadsheetcontentcontainer").length>0){if(i.ctrlKey&&r.model.selectionSettings.selectionType===t.Spreadsheet.SelectionType.Default&&r.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.MultiRange){r._getContent(r.getActiveSheetIndex()).find("td").removeClass("e-activecell e-focustop e-focusleft e-ctrlselected");c=r.swapRange([f._startCell.rowIndex,f._startCell.colIndex,f._endCell.rowIndex,f._endCell.colIndex]);r.getRange(c[0],c[1],c[2],c[3]).addClass("e-selected");r.getCell(f._activeCell.rowIndex,f._activeCell.colIndex).addClass("e-activecell");u._focusRange(f._startCell,f._endCell,r._selectionBorder);r.model.allowAutoFill&&r.XLDragFill.hideAutoFillElement();r.getSheet(r.getActiveSheetIndex())._selectedCells.push(u._getSelectedRange(r.getSheet(1)._startCell,r.getSheet(1)._endCell));r.model.showRibbon&&r.model.allowComments&&k.find(".e-selected.e-commentcell").length>0&&r.XLRibbon._enableButtons(["deleteComment"],"ejButton");return}a===v.Row||u._rowhdrClick?u.selectRows(f._startCell.rowIndex,f._endCell.rowIndex):a===v.Column||u._colhdrClick?u.selectColumns(f._startCell.colIndex,f._endCell.colIndex):u.selectRange(f._startCell,f._endCell,e)}else if(n(e).parents(".e-rowheadercontent").length>0)(u._colhdrClick||u._rowhdrClick)&&(a===v.Column?u.selectColumns(0,f.colCount-1):u.selectRows(f._startCell.rowIndex,f._endCell.rowIndex),u._hdrClick=!1),u._isOutsideBordering=u._isGridBordering=!1;else return;e.tagName==="TD"&&r.model.showRibbon&&(w=n("#"+r._id+"_Ribbon_clearfilter").data("ejButton"),t.isNullOrUndefined(w)||r.XLRibbon._changeClrFltrStatus(w,"button",e))}else if(u._aFillDownHandler||t.isNullOrUndefined(e.parentNode)||e.parentNode.tagName!="TH")if(typeof e.className!="object"&&e.className&&e.className.indexOf("e-spreadsheetcolumnheader")>-1)u.selectSheet(),u._isOutsideBordering=u._isGridBordering=!1;else{r.model.showRibbon&&r.XLRibbon._updateRibbonIcons();return}else f._startCell=f._activeCell,f._endCell=u._isRightClick?f._startCell:{rowIndex:0,colIndex:e.parentNode.cellIndex},u._processBoundary(),(u._colhdrClick||u._rowhdrClick)&&(a===v.Row?u.selectRows(0,f.rowCount-1):u.selectColumns(f._startCell.colIndex,f._endCell.colIndex)),u._isOutsideBordering=u._isGridBordering=!1;r.model.allowCellFormatting&&r.XLFormat._formatEnable&&r.XLFormat._fPMouseUp(i);r.model.showRibbon&&(r.XLEdit._isEdit?r.XLRibbon._disableRibbonIcons():r.XLRibbon._updateRibbonIcons());r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement(u._aFillDownHandler);u._isRightClick=u._aFillDownHandler=!1;u._colhdrClick=u._rowhdrClick=!1;r.setSheetFocus();r.model.showRibbon&&(l=n("#"+r._id+"_Ribbon_merge").data("ejSplitButton"),t.isNullOrUndefined(l)||(r._getContent(r.getActiveSheetIndex()).find(".e-selected").is('[class*="e-table"]')?l.option("enabled",!1):l.option("enabled",!0)));r.model.allowEditing&&this.XLEdit._isEdit&&(b=r.getSheet(r.getActiveSheetIndex())._startCell,r.getCell(b.rowIndex,b.colIndex).find(".e-ss-input").focus())},_processBoundary:function(){var h,e,u,f,c,r,o=[],l="e-rc-",i=this.XLObj,y=i._rcRegx,s=i.getSheet(i.getActiveSheetIndex()),a=s._startCell,v=s._endCell,t=i.swapRange([a.rowIndex,a.colIndex,v.rowIndex,v.colIndex]);for(s._startCell={rowIndex:t[0],colIndex:t[1]},s._endCell={rowIndex:t[2],colIndex:t[3]},f=n.makeArray(i.getRange(t[0],t[1],t[0],t[3])),f=f.concat(n.makeArray(i.getRange(t[0],t[3],t[2],t[3]))),f=f.concat(n.makeArray(i.getRange(t[2],t[1],t[2],t[3]))),f=f.concat(n.makeArray(i.getRange(t[0],t[1],t[2],t[1]))),h=f.length;h--;)if(u=f[h],c=u.className,r=(u.parentNode.rowIndex+":"+u.cellIndex).toString(),e=(i.hasSpan(u.rowSpan)||i.hasSpan(u.colSpan))&&o.indexOf(r)===-1&&(o.push(r),this._updateRange(u,t)),c.indexOf(l)>-1&&(r=c.match(y)[0].split(" ")[0].replace(l,""),o.indexOf(r)===-1&&(o.push(r),r=r.split(":"),u=i.getCell(Number(r[0]),Number(r[1]))[0],e=this._updateRange(u,t))),e)break;e&&this._processBoundary()},_updateRange:function(n,t){var f=this.XLObj,e=f.getSheet(f.getActiveSheetIndex()),i=t.slice(0),r=n.parentNode.rowIndex,u=n.cellIndex,o=r+(n.rowSpan-1),s=u+(n.colSpan-1);return r<t[0]&&(t[0]=r),u<t[1]&&(t[1]=u),o>t[2]&&(t[2]=o),s>t[3]&&(t[3]=s),t[0]!=i[0]||t[1]!=i[1]||t[2]!=i[2]||t[3]!=i[3]?(e._startCell={rowIndex:t[0],colIndex:t[1]},e._endCell={rowIndex:t[2],colIndex:t[3]},!0):void 0},_getSpanIndex:function(n){var t,i,r="e-rc-";if(n.indexOf(r)>-1)return i=this.XLObj._rcRegx,t=n.match(i)[0].split(" ")[0].replace(r,"").split(":"),{rowIndex:Number(t[0]),colIndex:Number(t[1])}},selectRange:function(n,i,r){var u=this.XLObj,f;if(u.model.allowSelection){typeof n=="string"&&(f=u.getRangeIndices(n),n={rowIndex:f[0],colIndex:f[1]},i={rowIndex:f[2],colIndex:f[3]});var o,s,c,e=u.getSheet(u.getActiveSheetIndex()),h,a=u._rcRegx,l="e-rc-";(f=e.selectedRange,u.importSheet||e._importRendered||(h={prevRange:f,prevCells:u.getRange(f[0],f[1],f[2],f[3]),rangeData:u.getRangeData([n.rowIndex,n.colIndex,i.rowIndex,i.colIndex]),cells:u.getRange(n.rowIndex,n.colIndex,i.rowIndex,i.colIndex)},r&&(h.target=r),!u._trigger("beforeCellSelect",h)))&&(u._dStartCell=n,u._dEndCell=i,f=e.selectedRange=u.swapRange([n.rowIndex,n.colIndex,i.rowIndex,i.colIndex]),this._cleanUp(!1),c=u.getRange(f[0],f[1],f[2],f[3]),c.addClass("e-selected"),s=u.getCell(e._activeCell.rowIndex,e._activeCell.colIndex),s[0].className.indexOf(l)>-1&&(o=s[0].className.match(a)[0].split(" ")[0].replace(l,"").split(":"),s=u.getCell(Number(o[0]),Number(o[1])),e._activeCell={rowIndex:Number(o[0]),colIndex:Number(o[1])}),s.addClass("e-activecell"),this._focusRange(n,i,u._selectionBorder),this._highlightHeader(f),u.model.allowDragAndDrop&&t.spreadsheetFeatures.dragAndDrop&&u.XLDragDrap._initDragAndDropRange([n.rowIndex,n.colIndex,i.rowIndex,i.colIndex]),e._selectedCells=this._getSelectedRange(n,i),u.model.enableContextMenu&&u.XLRibbon._dirtySelect(c),this._isRowSelected=this._isColSelected=this._isSheetSelected=!1,u.importSheet||e._importRendered||(h={rangeData:u.getRangeData([n.rowIndex,n.colIndex,i.rowIndex,i.colIndex]),selectedCells:u.getRange(f[0],f[1],f[2],f[3]),target:r},u._trigger("cellSelected",h)))}},selectRow:function(n){var i=this.XLObj,t;i.model.allowSelection&&(t=i.getSheet(i.getActiveSheetIndex()),t._startCell={rowIndex:n,colIndex:0},t._endCell={rowIndex:n,colIndex:t.colCount-1},this.selectRange(t._startCell,t._endCell),this._selectRow(n,"e-rowselected"),this._isRowSelected=!0)},selectRows:function(n,t){var r=this.XLObj,i;r.model.allowSelection&&(i=r.getSheet(r.getActiveSheetIndex()),i._startCell={rowIndex:n,colIndex:0},i._endCell={rowIndex:t,colIndex:i.colCount-1},this.selectRange(i._startCell,i._endCell),this._markHeaderSelection([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],"row"),this._isRowSelected=!0)},selectColumn:function(n){var i=this.XLObj,t;i.model.allowSelection&&(t=i.getSheet(i.getActiveSheetIndex()),t._startCell={rowIndex:0,colIndex:n},t._endCell={rowIndex:t.rowCount-1,colIndex:n},this.selectRange(t._startCell,t._endCell),this._selectColumn(n,"e-colselected"),this._isColSelected=!0)},selectColumns:function(n,t){var r=this.XLObj,i;r.model.allowSelection&&(i=r.getSheet(r.getActiveSheetIndex()),i._startCell={rowIndex:0,colIndex:n},i._endCell={rowIndex:i.rowCount-1,colIndex:t},this.selectRange(i._startCell,i._endCell),this._markHeaderSelection([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],"column"),this._isColSelected=!0)},selectSheet:function(){var t=this.XLObj,n;t.model.allowSelection&&(n=t.getSheet(t.getActiveSheetIndex()),n._activeCell={rowIndex:0,colIndex:0},n._startCell={rowIndex:0,colIndex:0},n._endCell={rowIndex:n.rowCount-1,colIndex:n.colCount-1},this.selectRange(n._startCell,n._endCell),t.element.find(".e-spreadsheetcolumnheader").addClass("e-sheetselected"),t.model.allowAutoFill&&t.XLDragFill.hideAutoFillElement(),this._isSheetSelected=!0)},refreshSelection:function(n){var t=this.XLObj,n=n?n:t.getSheet(t.getActiveSheetIndex()).selectedRange,i=n[0],r=n[1],u=n[2],f=n[3];this._isRowSelected?this.selectRows(i,u):this._isColSelected?this.selectColumns(r,f):this._isSheetSelected?this.selectSheet():this.selectRange({rowIndex:i,colIndex:r},{rowIndex:u,colIndex:f})},getSelectedCells:function(n){return this.XLObj._getContent(this.XLObj._getSheetIndex(n))[0].querySelectorAll("td.e-selected")},_select:function(n,t){var i=this.XLObj.getCell(n.rowIndex,n.colIndex);i&&i.addClass(t)},_selectRow:function(n,t){var i=this.XLObj._getJSSheetRowHeaderContent(this.XLObj.getActiveSheetIndex()).find("td:eq("+n+")");i&&i.addClass(t)},_selectRows:function(n,t,i){var r=this.XLObj._getJSSheetRowHeaderContent(this.XLObj.getActiveSheetIndex()).find("td");r=t!==n?r.slice(n,t+1):r.eq(t);r&&r.addClass(i)},_selectColumn:function(n,t){var i=this.XLObj._getJSSheetHeader(this.XLObj.getActiveSheetIndex()).find("th:eq("+n+")");i&&i.addClass(t)},_selectColumns:function(n,t,i){var r=this.XLObj._getJSSheetHeader(this.XLObj.getActiveSheetIndex()).find("th");r=t!==n?r.slice(n,t+1):r.eq(t);r&&r.addClass(i)},_focusBorder:function(n,t,i){var r=this.XLObj,e=r.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]),u=e[0],f=e[1],o=e[2],s=e[3];u-1>=0&&r.getRange(u-1,f,u-1,s).addClass(i[1]);r.getRange(u,s,o,s).addClass(i[0]);r.getRange(o,f,o,s).addClass(i[1]);f-1>=0&&r.getRange(u,f-1,o,f-1).addClass(i[0])},_focusRange:function(n,t,i){var r=this.XLObj;r.getFocusTopElem().removeClass().addClass("e-focustop "+i[0]);r.getFocusRightElem().removeClass().addClass("e-focusright "+i[1]);r.getFocusBottomElem().removeClass().addClass("e-focusbottom "+i[2]);r.getFocusLeftElem().removeClass().addClass("e-focusleft "+i[3]);this._refreshBorder(r.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]))},_refreshBorder:function(n){n=n?n:this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).selectedRange;var u,f,i="e-hide",r=this.XLObj,s=n[0],h=n[1],t=this._focusInfo(n),e=r.getFocusTopElem().removeClass(i),c=r.getFocusRightElem().removeClass(i),l=r.getFocusBottomElem().removeClass(i),o=r.getFocusLeftElem().removeClass(i),a=t.topLeft.top,v=t.topLeft.left,y=t.topRight.left+t.topRight.width-t.topLeft.left,p=t.topRight.top,w=t.topRight.left+t.topRight.width,b=t.bottomRight.top+t.bottomRight.height-t.topRight.top,k=t.bottomLeft.top+t.bottomLeft.height,d=t.topLeft.left,g=t.bottomRight.left+t.bottomRight.width-t.bottomLeft.left,nt=t.topLeft.top,tt=t.topLeft.left,it=t.bottomLeft.top+t.bottomLeft.height-t.topLeft.top;r.model.selectionSettings.enableAnimation?(u=r.model.selectionSettings.animationType,f=r.model.selectionSettings.animationTime,s?e.animate({top:a.toString(),left:v.toString(),width:y.toString()},f,u):e.addClass(i),c.animate({top:p.toString(),left:w.toString(),height:b.toString()},f,u),l.animate({top:k.toString(),left:d.toString(),width:g.toString()},f,u),h?o.removeClass(i).animate({top:nt.toString(),left:tt.toString(),height:it.toString()},f,u):o.addClass(i)):(s?e.css({top:a,left:v,width:y}):e.addClass(i),c.css({top:p,left:w,height:b}),l.css({top:k,left:d,width:g}),h?o.css({top:nt,left:tt,height:it}):o.addClass(i))},_focusInfo:function(n){var u="e-rc-",i={},r=this.XLObj,t=r.getCell(n[0],n[1])[0];return i.topLeft=this._getCellProp(t),t=r.getCell(n[0],n[3])[0],i.topRight=t.className.indexOf(u)===-1?this._getCellProp(t):this._getCellProp(this._getMergedCell(t.className)),t=r.getCell(n[2],n[1])[0],i.bottomLeft=t.className.indexOf(u)===-1?this._getCellProp(t):this._getCellProp(this._getMergedCell(t.className)),t=r.getCell(n[2],n[3])[0],i.bottomRight=t.className.indexOf(u)===-1?this._getCellProp(t):this._getCellProp(this._getMergedCell(t.className)),i},_getMergedCell:function(n){var t=this.XLObj,i=n.match(t._rcRegx)[0].split(" ")[0].replace("e-rc-","").split(":");return t.getCell(Number(i[0]),Number(i[1]))[0]},_getCellProp:function(n){return{top:n.offsetTop-1,left:n.offsetLeft-1,height:n.offsetHeight,width:n.offsetWidth}},_highlightHeader:function(n){this._selectRows(n[0],n[2],"e-rowhighlight");this._selectColumns(n[1],n[3],"e-colhighlight")},_markHeaderSelection:function(n,t){var r=this.XLObj,i;if(n=r.swapRange(n),i=n[0],t==="row")while(i<=n[2])this._selectRow(i,"e-rowselected"),i++;else for(i=n[1];i<=n[3];)this._selectColumn(i,"e-colselected"),i++},_getSelectedRange:function(n,t){for(var r,u=[],f=this.XLObj,i=f.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]);i[0]<=i[2];){for(r=i[1];r<=i[3];)u.push({rowIndex:i[0],colIndex:r}),r=r+1;i[0]=i[0]+1}return u},_processFormulaRange:function(n){var u,t=this.XLObj,f=t.getActiveSheetIndex(),i=t._dStartCell,r=t._dEndCell,e=t._getContent(f).find(".e-editedcell");this._focusBorder(i,r,n[t._ctrlKeyCount%6]);t.model.allowAutoFill&&t.XLDragFill.hideAutoFillElement();u=t._getAlphaRange(f,i.rowIndex,i.colIndex,r.rowIndex,r.colIndex);t.model.allowAutoFill&&t.XLEdit._updateFormulaCellRange(u);t.XLEdit._isCellEdit?t.XLEdit._focusElements(e):t._getInputBox().focus()},_scrollCalculation:function(n,t,i){var e,r=this.XLObj,u=r.getSheet(r.getActiveSheetIndex()),f;r.XLSelection._isEndReached=!0;e=setInterval(function(){var h,o=r._getContent(n).find("#hscrollBar").data("ejScrollBar"),s=r._getContent(n).find("#vscrollBar").data("ejScrollBar");if(!r.XLSelection._isEndReached){clearInterval(e);return}if(i.position==="horizontal")i.action=="Increment"?(h=Math.ceil(parseFloat(o.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(o.element.find(".e-hhandle").width()))>=o.element.find(".e-hhandlespace").width()-1,h?r.XLScroll._scrollX(n):o.scroll(o.value()+r.model.columnWidth,!0),r.XLShape._shapeROStart||r.XLShape._shapeRSStart||(u._endCell.colIndex=u.colCount-1)):(f=o.value()-r.model.columnWidth,f<0&&(f=0),o.value()>=0&&o.scroll(f,!0),r.XLSelection._aFillDownHandler&&(u._endCell.colIndex=u._leftCol.idx));else if(i.position==="vertical")if(i.action=="Increment")h=Math.ceil(parseFloat(s.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(s.element.find(".e-vhandle").height()))>=s.element.find(".e-vhandlespace").height()-1,h?r.XLScroll._scrollY(n):s.scroll(s.value()+r.model.rowHeight,!0),r.XLShape._shapeROStart||r.XLShape._shapeRSStart||(u._endCell.rowIndex=u.rowCount-1);else if(f=s.value()-r.model.rowHeight,f<0&&(f=0),s.value()>0&&s.scroll(f,!0),!r.XLShape._shapeROStart&&!r.XLShape._shapeRSStart){if(u._topRow.idx<1)return;u._startCell=u._activeCell;u._endCell.rowIndex=u._topRow.idx-1;u._endCell.colIndex=t.parentNode.cellIndex}r.XLShape._shapeROStart||r.XLShape._shapeRSStart||(r.XLSelection._aFillDownHandler?r.XLDragFill._selectAutoFillRange(null,u._endCell):r.XLSelection.selectRange(u._startCell,u._endCell),r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement(r.XLSelection._aFillDownHandler))},200);t.addEventListener("mouseup",function(){clearInterval(e)});document.addEventListener("mouseup",function(){clearInterval(e)})},_cleanUp:function(n){var r,i="e-hide",t=this.XLObj,f=t.getActiveSheetIndex(),u;for(t.model.allowAutoFill&&t.XLDragFill._autoFillCleanUp(),r=t.getSheetElement(f)[0].querySelectorAll(".e-selected,.e-rowselected,.e-colselected,.e-rowhighlight,.e-colhighlight,.e-sheetselected,.e-activecell"),u=r.length;u--;)t._removeClass(r[u],"e-activecell|e-selected|e-rowhighlight|e-colhighlight|e-rowselected|e-colselected|e-ddcell|e-sheetselected");n&&(t.addClass(t.getFocusTopElem()[0],i),t.addClass(t.getFocusRightElem()[0],i),t.addClass(t.getFocusBottomElem()[0],i),t.addClass(t.getFocusLeftElem()[0],i));t.getSheet(f)._selectedCells=[]},_clearBorder:function(n){var t=this.XLObj;t._getContent(t.getActiveSheetIndex()).find("td").removeClass(n)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.filter=function(n){this.XLObj=n;this._isSearchEdit=!1;this._isDecimal=!1};t.spreadsheetFeatures.filter.prototype={_renderExcelFilter:function(){var n=this.XLObj,i={instance:n,showSortOptions:!0,maxFilterLimit:n.model.sheets[n.getActiveSheetIndex()].filterSettings.maxFilterChoices,filterHandler:t.proxy(this._filterHandler,this),cancelHandler:t.proxy(this._cancelHandler,this),customFilterHandler:t.proxy(this._customFilterHandler,this)};n._excelFilter=new t.excelFilter(i)},_customFilterHandler:function(){var t=this.XLObj;this._isDecimal&&(n("#"+t._id+"number_CustomValue1").ejNumericTextbox("option",{decimalPlaces:2}),n("#"+t._id+"number_CustomValue2").ejNumericTextbox("option",{decimalPlaces:2}))},_renderFilterDialogs:function(){var n=this.XLObj;n._excelFilter.renderDialog("string");n._excelFilter.renderDialog("number");n._excelFilter.renderDialog("date");n.element.find(".e-excelfilter.e-dlgcontainer").hide()},_createSelection:function(t,i,r,u,f){for(var o=this.XLObj,s=o.getRows(t)[1],h,c=0,e=r,l=s.length;e<l;e++){if(h=o.getCell(e,u),!n(s[e]).hasClass("e-hide")&&h.text().length===0&&e>r)return e<=i&&(e=e+(i-e)+1),{endRowIndex:e,filteredIndex:f};c=e+1;f.push(e)}return{endRowIndex:c,filteredIndex:f}},_getSelectedRangeData:function(n,i,r,u){var f=this.XLObj,e=f.getActiveSheetIndex(),tt=f.model.sheets[e]._multipleFiltering,w=[],v,it=0,o,s,b=f._formatRegx,k=[],d,y,c,g,h;r===-1&&(f.model.sheets[e].filterSettings.range=f._generateHeaderText(e,n.colIndex+1)+n.rowIndex+":"+f._generateHeaderText(e,i.colIndex+1)+(i.rowIndex+1));tt&&(i.colIndex=f.model.sheets[e]._multifilterIdx[f.model.sheets[e]._multifilterIdx.length-1],it=f.model.sheets[e]._multifilterIdx);var l,nt=[],a=f._dataContainer,p=a.sheets[e];for(o=n.rowIndex;o<=i.rowIndex;o++){for(l={},s=n.colIndex;s<=i.colIndex;s++)c=f.getCell(o,u),v=f._generateHeaderText(e,s+1),c.parent()[0].className.indexOf("e-fr-hide")<0&&c.parent()[0].className.indexOf("e-r-hide")<0&&(t.isNullOrUndefined(c[0].className.match(b))||(d=c[0].className.match(b)[0],y=f._getColorFromFormat(d),g={id:s,background:y[0],foreground:y[1]},k.push(g)),o in p&&s in p[o]?(h=p[o][s],l[v]=t.isNullOrUndefined(a.sharedData[h.value])?"":f._isDateTime(a.sharedData[h.value])||f.isFormula(a.sharedData[h.value])?h.value2:a.sharedData[h.value]):l[v]="");f.getObjectLength(l)>0&&(nt.push(l),w.push(o))}f.model.sheets[e]._selectedCellColors=k;f.model.sheets[e]._selectedRange={startRow:n.rowIndex,endRow:i.rowIndex,dataSourceIndexes:w};f.model.sheets[e].filterSettings.filteredRange=nt},_getColumnType:function(t,i,r,u){for(var o="string",f,e=i;e<r;e++)if(f=this.XLObj.XLEdit.getPropertyValue(e,u,"value",t),n.isNumeric(f))this._isDecimal||(this._isDecimal=f%1!=0),o="number";else return"string";return o},_getColumnByField:function(n,t){for(var r=this.XLObj,i=0;i<r.model.sheets[n].columns.length;i++)if(r.model.sheets[n].columns[i].field===t)break;return i===r.model.sheets[n].columns.length?null:r.model.sheets[n].columns[i]},_checkEmptyText:function(n){for(var i=this.XLObj,r=i.model.sheets[n]._selectedCells,u=!1,t=0,f=r.length;t<f;t++)if(i.getCell(r[t].rowIndex,r[t].colIndex).text().length>0)return u=!0,!0;if(!u)return i._showAlertDlg("Alert","Alert",null,440),!1},_getFilterIcon:function(){var n=t.buildTag("span .e-icon","",{});return n.addClass("e-spanfilter e-filterspan e-ssfilter"),n},filterByActiveCell:function(){var n=this.XLObj,i=n.getActiveSheetIndex(),t;if(n.model.allowFiltering){var r=n.model.sheets[i]._activeCell,u=n.getCell(r.rowIndex,r.colIndex),f=n.model.sheets[i]._selectedCells;this._checkEmptyText(i)&&(u.find("span").is(".e-ssfiltered, .e-ssfilter, .e-ssfilter-asc, .e-ssfiltered-asc, .e-ssfilter-dsc, .e-ssfiltered-dsc")?n._showAlertDlg("Alert","HeaderAlert","",440):(t=n.XLEdit.getPropertyValueByElem(u,"value"),t=n._isDateTime(t)?n.XLEdit.getPropertyValueByElem(u,"value2"):t,this._filterActiveCell(i,r,f,t)))}},_filterActiveCell:function(n,t,i,r){var u=this.XLObj;u.model.sheets[n]._activeCell=t;u.model.sheets[n]._selectedCells=i;this._filterByValue(n,null,u.model.sheets[n].columns[t.colIndex].field,"or","equal",r);u.model.allowComments&&u.XLComment._updateCmntArrowPos()},_filterByValue:function(i,r,u,f,e,o){var s=this.XLObj,a,c,l,p,k,d,w,b=-1,h,g,v,y,nt=s.XLEdit.getColumnIndexByField(u),tt=s.getRows(i)[1];if(t.isNullOrUndefined(r)?a=s.model.sheets[i]._selectedCells:(c=s.getRangeIndices(r),a=s.XLSelection._getSelectedRange({rowIndex:c[0],colIndex:c[1]},{rowIndex:c[2],colIndex:c[3]})),l=a[0],!t.isNullOrUndefined(r)&&s.getCell(l.rowIndex,l.colIndex).text()!==o)for(h=c[0];h<c[2];h++)if(n(tt[h].cells[nt]).text()===o){l={rowIndex:h,colIndex:nt};break}for(y={currentFilteringColumn:u,action:"filter",predicated:f,requestType:"filterbycell",reqType:"filter",filteredValue:o,selCells:n.extend(!0,[],a),activeCell:l},v=this._applyFilterByValue(i,l,a,o),s._excelFilter._predicates[i]={},p={field:u,value:o,predicate:f,operator:e,matchcase:!1},{}.currentFilterCollection=o,s._excelFilter._predicates[i][u]=t.Predicate(u,e,o),s.model.sheets[i].filterSettings.filteredColumns.push(p),k=t.DataManager(s.model.sheets[i].filterSettings.filteredColumns),d=(new t.Query).where("field",t.FilterOperators.equal,u),w=k.executeLocal(d),h=0,g=w.length;h<g;h++)b=n.inArray(w[h],s.model.sheets[i].filterSettings.filteredColumns),b>-1&&s.model.sheets[i].filterSettings.filteredColumns.splice(b,1);s.model.sheets[i].filterSettings.filteredColumns.push(p);y.filteredcolumns=v.filteredColumns=s.model.sheets[i].filterSettings.filteredColumns;v.predicate=s._excelFilter._predicates[i];y.tableID=v.tableID;y.filteredCells=v.filteredCells;s.XLSelection._refreshBorder();s._processBindings(y)&&(s.model.sheets[i].filterSettings.filteredColumns=temp)},_applyFilterByValue:function(n,i,r){var f=this.XLObj,y=[],l,e,a,k,p,v,w=f.getCell(i.rowIndex,i.colIndex)[0].className,o=f.model.sheets[n].filterSettings.tableRange,d=[],s,h,g=!1,b,c,u;for(v=w.indexOf("e-table")>-1?parseInt(w.substr(w.indexOf("e-table")+7,w.indexOf("")+1)):-1,u=0,c=o.length;u<c;u++)if(o[u].tableID===v){h=u;break}if(!t.isNullOrUndefined(h)&&o[h].tableID===v&&o[h].selectedCellIndexes.indexOf(i.colIndex)!==-1&&o[u].startRow<=i.rowIndex&&o[u].endRow>=i.rowIndex)s=o[h],f.model.sheets[n].filterSettings.filteredRange=o[h].filteredRange,f.model.sheets[n]._selectedRange=o[h].selectedRange;else{for(f.model.sheets[n]._multipleFiltering=!1,f.model.sheets[n]._multifilterIdx=[],f._dupDetails=!0,this.clearFilter("remove"),f._dupDetails=!1,p=f._getContent(n).find(".e-ssfilter, .e-ssfiltered, .e-ssfilter-asc, .e-ssfiltered-asc, .e-ssfilter-dsc, .e-ssfiltered-dsc"),u=0,c=p.length;u<c;u++)p[u].className.indexOf("e-ft")===-1&&p[u].remove();if(f._getContent(n).find(".e-filterhdr").removeClass("e-filterhdr"),r.length<2||r[0].rowIndex===r[r.length-1].rowIndex){for(e=-1,a=r[r.length-1].rowIndex,u=r[0].rowIndex;u>=0;u--)if(f.getCell(u,r[0].colIndex).text().length<1){e=u;break}e=e===-1?1:e+2;a=this._createSelection(n,e,a,r[0].colIndex,[]).endRowIndex-1;l={rowIndex:a,colIndex:i.colIndex};this._getSelectedRangeData({rowIndex:e,colIndex:i.colIndex},l,-1,i.colIndex)}else e=i.rowIndex,a=this._createSelection(n,e,r[r.length-1].rowIndex,r[0].colIndex,[]).endRowIndex-1,l={rowIndex:a,colIndex:i.colIndex},this._getSelectedRangeData({rowIndex:e,colIndex:i.colIndex},l,-1,i.colIndex);for(u=r[0].colIndex,c=r[r.length-1].colIndex;u<=c;u++)y.push(u),k=this._getFilterIcon(),e=e===0?1:e,b=f.getCell(e-1,u),this._applyFilterIcon(b,k),d.push(b);for(y.length>1&&(f.model.sheets[n]._multipleFiltering=!0),f.model.sheets[n]._multifilterIdx=y,f.model.sheets[n]._selectedCellIndexes=y,u=0,c=o.length;u<c;u++)if(o[u].tableID===v){h=u;g=!0;break}g?(s=o[h],s.startRow=i.rowIndex,s.endRow=l.rowIndex,s.multiFiltering=f.model.sheets[n]._multipleFiltering,s.multifilterIdx=f.model.sheets[n]._multifilterIdx,s.selectedCellIndexes=f.model.sheets[n]._multifilterIdx,s.selectedRange=f.model.sheets[n]._selectedRange,s.filteredRange=f.model.sheets[n].filterSettings.filteredRange,s.hiddenIdx=[],s.tableID=v):(f.model.sheets[n].filterSettings.tableRange.push({startRow:e,endRow:l.rowIndex,tableID:-1,multiFiltering:f.model.sheets[n]._multipleFiltering,multifilterIdx:f.model.sheets[n]._multifilterIdx,selectedCellIndexes:f.model.sheets[n]._multifilterIdx,selectedRange:f.model.sheets[n]._selectedRange,filteredRange:f.model.sheets[n].filterSettings.filteredRange,hiddenIdx:[]}),s=o[o.length-1]);s.filteredCells=d}return s},clearFilter:function(t){for(var r=this.XLObj,f=r.getActiveSheetIndex(),s,e=r._getContent(f).find(".e-ssfiltered, .e-ssfiltered-asc, .e-ssfiltered-dsc"),h=r.model.sheets[f].filterSettings.tableRange,c=-1,l,u,a,i=0,o=e.length;i<o;i++)e.get(i).className.indexOf("e-ft")===-1&&(s=r.model.sheets[f].columns[e.eq(i).parent()[0].cellIndex].field,delete r._excelFilter._predicates[f][s],this._clearFilterColumn(s,"","","Or","","",-1),t==="remove"&&(n.isNumeric(n(e[i]).parent().text())&&n(e[i]).parent().addClass(r._rAlign),n(e[i]).remove(),e.parent().removeClass("e-filterhdr")));for(u=r._getContent(f).find(".e-ssfilter, .e-ssfilter-asc, .e-ssfilter-dsc"),filteredCells=[],i=0,o=u.length;i<o;i++)u.get(i).className.indexOf("e-ft")===-1&&t==="remove"&&(n.isNumeric(n(u[i]).parent().text())&&n(u[i]).parent().addClass(r._rAlign),filteredCells.push(n(u[i]).parent()),n(u[i]).remove(),u.parent().removeClass("e-filterhdr"));if(t==="remove"){for(i=0;i<h.length;i++)if(h[i].tableID===-1){c=i;break}c>-1&&(l=h.splice(c,1)[0]);r.model.allowComments&&r.XLComment._updateCmntArrowPos();r._isUndoRedo||r._dupDetails||(a={sheetIndex:f,operation:"remove-filter",process:"apply-filter",requestType:"filter",reqType:"filter",filteredCells:filteredCells,fRange:r.getSheet(f).filterSettings.range,filterRange:l},r._completeAction(a))}},filter:function(n){var t=this.XLObj,h,r;if(t.model.allowFiltering){var i=t.getActiveSheetIndex(),e=!1,u=t.model.sheets[i]._activeCell,c=t._getContent(i).find(".e-ssfilter, .e-ssfiltered, .e-ssfilter-asc, .e-ssfilter-dsc, .e-ssfiltered-asc, .e-ssfiltered-dsc"),f,o,s=t.getSheet(i).filterSettings.tableRange;for(t.model.sheets[i]._multipleFiltering=!1,t.model.sheets[i]._multifilterIdx=[],r=0,h=s.length;r<h;r++)if(s[r].tableID===-1){e=!0;break}if(c.length>0&&!(t.getCell(u.rowIndex,u.colIndex,i)[0].className.indexOf("e-table")>-1)&&(t._dupDetails=!0,this.clearFilter("remove"),t._dupDetails=!1,t.model.sheets[i].filterSettings.filteredRange=[],t.model.sheets[i]._selectedRange={},t.model.sheets[i]._selectedCellIndexes=[],t.model.sheets[i].filterSettings.filteredColumns=[],t._excelFilter._predicates[i]={}),t.getCell(u.rowIndex,u.colIndex,i)[0].className.indexOf("e-table")>-1){for(f=t._getTableID(t.getCell(u.rowIndex,u.colIndex,i)[0].className),o=t.model.sheets[i].filterSettings.tableRange[f].multifilterIdx.length,r=0;r<o;r++)t.getCell(t.model.sheets[i].filterSettings.tableRange[f].startRow,t.model.sheets[i].filterSettings.tableRange[f].multifilterIdx[r],i)[0].className.indexOf("e-ssfiltered")>-1&&this._clearFilterColumn(t.model.sheets[i].columns[r].field,"","","","","",f);this._clearFilterTableIcon(i,f);e=!0}e||this._filterCellRange(i,n);t.model.allowComments&&t.XLComment._updateCmntArrowPos()}},_applyFilterIcon:function(n,t){var r=this.XLObj._rAlign,i=this.XLObj,u=i.getActiveSheetIndex(),f=n.index(),e=i._getContent(u).find("col:eq("+f+")");i.isNumber(i.model.allowFiltering&&i.XLEdit.getPropertyValueByElem(n))&&i._removeClass(n[0],r);n[0].insertBefore(t[0],n[0].childNodes[n[0].childNodes.length-1]);n.addClass("e-filterhdr")},_postionFilterIcon:function(n,t){var r=this.XLObj,i=n||r.getActiveCellElem(),e=t||i.find(".e-filterspan"),u,f;r.model.allowResizing&&(u=r.XLResize._getContentWidth(i.index(),null,i.parent()),f=r.XLResize._getContentHeight(null,i));e.css("margin-top",r._hasClass(i[0],"e-sswraptext")&&u>i.width()?Math.floor(f-25):"")},_filterCellRange:function(n,i){var r=this.XLObj,o,l=!1,et,ot,tt,st=0,a,it,e,u,k,p,ht,d,ct,h,v,f,s,w=[],b=-1,y=0,g=0,lt=!1,at=!1,c,rt=[],nt,ut=!1,vt={sheetIndex:n,reqType:"filter",operation:"apply-filter"},pt=r.model.sheets[n]._multifilterIdx,wt=r.getRows(n)[1],yt=[],ft;for(t.isNullOrUndefined(i)?o=r.model.sheets[n]._selectedCells:(d=r.getRangeIndices(i),o=r.XLSelection._getSelectedRange({rowIndex:d[0],colIndex:d[1]},{rowIndex:d[2],colIndex:d[3]})),e=o[0].colIndex,p=o[o.length-1].colIndex;e<=p;e++){if(w.push(e),a=this._getFilterIcon(),c=o[0].rowIndex,o.length<2){if(pt.push(e),f=r.getCell(c,e),f.text().length<1){for(u=c;u>=0;u--)if(f=r.getCell(u,e),f.is(":visible")&&f.text().length>0){at=!0;break}if(!at)for(u=c;u<c+2;u++)if(f=r.getCell(u,e),f.is(":visible")&&f.text().length>0){this._applyFilterIcon(f,a);l=!0;y=g=u;break}if(!l){for(it=!1,u=c;u>c-2;u--)u>-1&&(f=r.getCell(u,e),f.text().length===0&&u>0&&(f=r.getCell(u-1,e),f.text().length==0&&(it=!0)));if(!it)for(u=c-2;u>=0;u--)if(f=r.getCell(u,e),f.is(":visible")&&(f.text().length===0||u===0)){k=u===0?u:u+1;f=r.getCell(k,e);this._applyFilterIcon(f,a);l=!0;y=g=k;break}}}else{for(u=c;u>=0;u--)if(f=r.getCell(u,e),f.is(":visible")&&f.text().length===0){k=u+1;f=r.getCell(u+1,e);this._applyFilterIcon(f,a);l=!0;y=g=k;break}l||(f=r.getCell(0,e),this._applyFilterIcon(f,a),l=!0,y=g=0)}l||r._showAlertDlg("Alert","Alert")}else{if(!lt||w.length>0)for(u=c,ht=o[o.length-1].rowIndex;u<=ht;u++)f=r.getCell(u,e),f.text().length>0&&((b===-1||b>u)&&(b=u),lt=!0,l=!0,ut=!0),b<u&&st===0&&yt.push(u);ut&&(rt.push(e),r.model.sheets[n]._multifilterIdx.push(e),ut=!1)}st++}if(w.length>1&&(r.model.sheets[n]._multipleFiltering=!0),nt=[],l){if(o.length>1){for(e=0,p=rt.length;e<p;e++)a=this._getFilterIcon(),f=r.getCell(b,rt[e]),this._applyFilterIcon(f,a),nt.push(f);h={rowIndex:b+1,colIndex:o[0].colIndex};v={rowIndex:o[o.length-1].rowIndex};r.model.sheets[n]._selectedRange={startRow:h.rowIndex,endRow:v.rowIndex,dataSourceIndexes:yt};this._getSelectedRangeData(h,o[o.length-1],-1,h.colIndex);r.model.sheets[n]._selectedCellIndexes=w}else o.length===1&&(f=r.getCell(y,w[0]),nt.push(f)),ft=this._createSelection(n,y+1,g,w[0],[]),ct=ft.endRowIndex-1,h={rowIndex:y+1,colIndex:o[0].colIndex},v={rowIndex:ct,colIndex:o[0].colIndex},r.model.sheets[n]._selectedRange={startRow:h.rowIndex,endRow:v.rowIndex,dataSourceIndexes:ft.filteredIndex},this._getSelectedRangeData(h,v,-1,h.colIndex),r.model.sheets[n]._selectedCellIndexes.push(o[0].colIndex);for(vt={sheetIndex:n,filteredCells:nt,reqType:"filter",operation:"apply-filter",tableID:-1},tt=r.model.sheets[n].filterSettings.tableRange,e=0,p=tt.length;e<p;e++)tt[e].tableID===-1&&(et=!0,ot=e);et?(s=r.model.sheets[n].filterSettings.tableRange[ot],s.startRow=h.rowIndex,s.endRow=v.rowIndex,s.multiFiltering=r.model.sheets[n]._multipleFiltering,s.multifilterIdx=r.model.sheets[n]._multifilterIdx,s.selectedCellIndexes=r.model.sheets[n]._multifilterIdx,s.selectedRange=r.model.sheets[n]._selectedRange,s.filteredRange=r.model.sheets[n].filterSettings.filteredRange,s.filteredColumns=r.model.sheets[n].filterSettings.filteredColumns,s.predicate=r._excelFilter._predicates[n],s.hiddenIdx=[]):r.model.sheets[n].filterSettings.tableRange.push({startRow:h.rowIndex,endRow:v.rowIndex,tableID:-1,multiFiltering:r.model.sheets[n]._multipleFiltering,multifilterIdx:r.model.sheets[n]._multifilterIdx,selectedCellIndexes:r.model.sheets[n]._multifilterIdx,selectedRange:r.model.sheets[n]._selectedRange,filteredRange:r.model.sheets[n].filterSettings.filteredRange,filteredColumns:r.model.sheets[n].filterSettings.filteredColumns,predicate:{},hiddenIdx:[]});r.model.sheets[n]._importRendered||(r.XLSelection._refreshBorder(),r._completeAction(vt))}else r._showAlertDlg("Alert","Alert","",440)},_filterClickHandler:function(t){var i=this.XLObj,s=n(t.target),u=i.getActiveSheetIndex(),k=!1,l,a,v,st,h,d,c,ht,g,o,e,f,nt=[],ct={},tt,it,y,rt,p,w,ut,r,ft,et,ot,b;if(a=i.model.sheets[u].columns[t.target.parentNode.cellIndex].field,this._isDecimal=!1,s[0].className.indexOf("e-ssfiltered")>-1&&(k=!0),s[0].className.indexOf("e-ssfilter")>-1){for(f=i.model.sheets[u].filterSettings.tableRange,o=s[0].className.indexOf("e-ft")!==-1?parseInt(s[0].className.substr(s[0].className.indexOf("e-ft")+4,s[0].className.length)):-1,r=0,h=f.length;r<h;r++)f[r].tableID===o&&(w=r,f[r].multiFiltering?(d=f[r].multifilterIdx[0],c=f[r].multifilterIdx[f[r].multifilterIdx.length-1]):d=c=t.target.parentNode.cellIndex,rt={rowIndex:f[r].startRow,colIndex:d},p={rowIndex:f[r].endRow,colIndex:c},i.model.sheets[u]._multipleFiltering=f[r].multiFiltering,i.model.sheets[u]._multifilterIdx=f[r].multifilterIdx,e=i.model.sheets[u]._selectedRange=f[r].selectedRange,i.model.sheets[u].filterSettings.filteredRange=f[r].filteredRange,i.model.sheets[u]._selectedCellIndexes=f[r].selectedCellIndexes);if(o===-1){if(ut=this._createSelection(u,e.startRow,e.endRow,c,e.dataSourceIndexes),l=ut.endRowIndex-1,e.endRow!=l)for(r=e.endRow+1;r<=l;r++)ht=i.getCell(r,c),g={field:a,value:ht.text(),matchcase:!1,operator:"equal",predicate:"or"},i.model.sheets[u].filterSettings.filteredColumns.push(g),f[w].filteredColumns.push(g),f[w].selectedRange.endRow=l;p={rowIndex:l,colIndex:c};f[w].selectedRange=i.model.sheets[u]._selectedRange={startRow:rt.rowIndex,endRow:p.rowIndex,dataSourceIndexes:ut.filteredIndex}}for(this._getSelectedRangeData(rt,p,o,t.target.parentNode.cellIndex),v=i.model.sheets[u].columns,st=this._getColumnType(u,e.startRow,e.endRow,t.target.parentNode.cellIndex),r=0,h=v.length;r<h;r++)if(v[r].field===a){i._$colType=st;i._$curFieldName=v[r].field;break}for(ft=i.element.find(".e-excelfilter.e-dlgcontainer"),ot=i.element.height(),tt=i.element.width(),et=ft.height(),it=ft.width(),y=t.clientX,b=t.clientY,tt-t.clientX<=it&&(y=tt-it),ot-t.clientY<=et&&(b=ot-(et+20)),f=i.model.sheets[u].filterSettings.tableRange,r=0,h=f.length;r<h;r++)f[r].tableID===o&&(nt=f[r].filteredColumns,ct=f[r].predicate);i._excelFilter._predicates[u]=ct;this._isSearchEdit=!0;i.model.sheets[u].filterSettings.filteredRange==null?i._excelFilter.openXFDialog({field:a,dataSource:i.model.sheets[u].dataSource,position:{X:y,Y:b},type:i._$colType,format:i._$colFormat,filteredColumns:nt,sortedColumns:[],key:u,tableID:o,selectedColors:i.model.sheets[u]._selectedCellColors,isFiltered:k,blank:"",enableColor:!0,filteredByColor:i.model.sheets[u]._filteredByColor}):i._excelFilter.openXFDialog({field:a,dataSource:i.model.sheets[u].filterSettings.filteredRange,position:{X:y,Y:b},type:i._$colType,format:i._$colFormat,filteredColumns:nt,sortedColumns:[],key:u,tableID:o,selectedColors:i.model.sheets[u]._selectedCellColors,isFiltered:k,blank:"",enableColor:!0,filteredByColor:i.model.sheets[u]._filteredByColor})}},_cancelHandler:function(){this._isSearchEdit=!1},_filterHandler:function(i){var c,f,l,y,d,g,nt;if(t.isNullOrUndefined(i.sortDetails)||i.sortDetails.operation!=="filtercolorhdr"&&i.sortDetails.operation!=="sortcolorhdr"){var f,l,h,tt=!1,a=-1,w,v,u={},it,r=this.XLObj,o=r.getActiveSheetIndex(),rt,b,k,e=[],p={},s;for(u.requestType=i.action==="sorting"||i.action==="filterbycolor"?i.action:"filtering",h=r.model.sheets[o].filterSettings.tableRange,r.XLFilter._isSearchEdit=!1,f=0,l=h.length;f<l;f++)h[f].tableID===i.tableID&&(n.extend(!0,e,h[f].filteredColumns),p=h[f].predicate,tt=!0,a=f);if(u.tableID=i.tableID,i.action==="filtering"||i.action==="clearfiltering"){for(it=t.DataManager(e),rt=(new t.Query).where("field",t.FilterOperators.equal,i.fieldName),b=it.executeLocal(rt),u.filteredColumns=e,f=0,l=b.length;f<l;f++)k=n.inArray(b[f],e),k>=0&&e.splice(k,1);i.action==="clearfiltering"?delete r._excelFilter._predicates[o][i.fieldName]:t.merge(e,i.filterCollection);p=r._excelFilter._predicates[o]}if(tt&&(h[a].filteredColumns=e,h[a].predicate=p),i.action==="filtering"||i.action==="clearfiltering")u.currentFilteringColumn=i.fieldName,u.ejpredicate=i.ejpredicate,u.filterCollection=n.extend(!0,[],i.filterCollection),u.action=i.action,u.reqType="filter",u.sheetIndex=o,u.filteredcolumns=e,u.predicate=p;else if(i.action==="sorting")for(u.requestType=u.action=i.action,w=r.XLEdit.getColumnIndexByField(i.sortDetails.field),v=r.model.sheets[o].filterSettings.tableRange[a].selectedRange,c=r.model.sheets[o].filterSettings.tableRange[a].selectedCellIndexes,r.XLSort._isSortByFilter=!0,r.XLSort.sortByRange(r.swapRange([v.startRow,c[0],v.endRow,c[c.length-1]]),i.sortDetails.field,i.sortDetails.direction),this._changeSortIcon(r.getCell(v.startRow-1,w),i.sortDetails.direction),f=0,l=c.length;f<l;f++)s=r.getCell(v.startRow-1,c[f]).find(".e-filterspan")[0],c[f]!=w&&(r._hasClass(s,"e-ssfilter-asc")||r._hasClass(s,"e-ssfilter-dsc"))&&(r._hasClass(s,"e-ssfilter-asc")&&r._removeClass(s,"e-ssfilter-asc"),r._hasClass(s,"e-ssfilter-dsc")&&r._removeClass(s,"e-ssfilter-dsc"),r.addClass(s,"e-ssfilter"));else u.requestType=u.action=i.action,u.range=r.model.sheets[o]._selectedRange,i.action==="sortbycolor"?(u.sortColumn=i.sortDetails.field,u.operation=i.sortDetails.operation,y=i.sortDetails.color.replace("rgb(","").replace(")","").split(",")):(r._isUndoRedo?(u.filterColumn=i.columnName,u.operation=i.operation):(u.filterColumn=i.filterDetails.field,u.operation=i.filterDetails.operation,y=i.filterDetails.color.replace("rgb(","").replace(")","").split(",")),u.tableID=i.tableID,r.model.sheets[o]._filteredByColor=u.filterColumn),r._isUndoRedo||(d=y[0],g=y[1],nt=y[2]),u.operation==="sortbgcolor"||u.operation==="filterbgcolor"?u.bgcolor=r._isUndoRedo?i.bgcolor:this._convertrgbtohex(parseInt(d),parseInt(g),parseInt(nt)):u.fgcolor=r._isUndoRedo?i.fgcolor:this._convertrgbtohex(parseInt(d),parseInt(g),parseInt(nt));i.action!=="sorting"&&r._processBindings(u)&&(e=temp);r.model.allowComments&&r.XLComment._updateCmntArrowPos();r.XLSelection._refreshBorder()}},_convertrgbtohex:function(n,t,i){return"#"+(16777216+(n<<16)+(t<<8)+i).toString(16).slice(1)},_clearFilterColumn:function(i,r,u,f,e,o,s){var w,a={},c,b,h=this.XLObj,l=h.getActiveSheetIndex(),nt=!1,k={},tt,it,d,g,v=h.model.sheets[l].filterSettings.tableRange,y=[],p,rt;for(a.requestType=t.Grid.Actions.Filtering,a.currentFilterObject=[],n.isArray(r)||(r=n.makeArray(r)),n.isArray(u)||(u=n.makeArray(u)),this._currentFilterColumn=this._getColumnByField(l,i),p=0,rt=r.length;p<rt;p++)if(k={field:i,operator:r[p],value:u[p],matchcase:e,predicate:f,actualFilterValue:o},!nt){for(c=0,b=v.length;c<b;c++)v[c].tableID===s&&(w=v[c],n.extend(!0,y,v[c].filteredColumns),h._excelFilter._predicates[l]=v[c].predicate,h.model.sheets[l].filterSettings.filteredRange=h.model.sheets[l].filterSettings.tableRange[c].filteredRange,h.model.sheets[l]._selectedCellIndexes=v[c].selectedCellIndexes,h.model.sheets[l]._selectedRange=v[c].selectedRange,h.model.sheets[l]._multifilterIdx=v[c].multifilterIdx);for(tt=t.DataManager(y),it=(new t.Query).where("field",t.FilterOperators.equal,k.field),d=tt.executeLocal(it),c=0,b=d.length;c<b;c++)g=n.inArray(d[c],y),g!==-1&&y.splice(g,1)}h._isUndoRedo&&h.isUndefined(w)||(nt=!0,delete h._excelFilter._predicates[l][i],w.filteredColumns=y,w.predicate=h._excelFilter._predicates[l],a.currentFilterObject.push(k),a.filterCollection=y,a.currentFilteringColumn=i,a.filteredcolumns=y,a.action="clearfiltering",a.reqType="filter",a.tableID=s,h._processBindings(a)&&(h.model.sheets[l].filterSettings.filteredColumns.reverse().splice(0,r.length),h.model.sheets[l].filterSettings.filteredColumns.reverse()),h.model.allowComments&&h.XLComment._updateCmntArrowPos(),this.XLObj.XLSelection._refreshBorder())},_filterTable:function(t,i){var r=this.XLObj,o=[],l=!1,a=!1,e,v,h,y,u,p;r.model.sheets[t]._multipleFiltering=!1;r.model.sheets[t]._multifilterIdx=[];var c=n.extend(!0,[],r.getSheet(t)._selectedCells),s=c[c.length-1],f=c[0],w=r._getContent(t).find("tbody").get(0).rows,b=n(w).eq(f.rowIndex);for(u=f.colIndex;u<=s.colIndex;u++)b.find("td").eq(u).find(".e-ssfilter, .e-ssfiltered, .e-ssfilter-asc, .e-ssfiltered-asc, .e-ssfilter-dsc, .e-ssfiltered-dsc").length>0?l=!0:(v=r.getCell(f.rowIndex,u),h=this._getFilterIcon(),y="e-ft"+i,h.addClass(y),this._applyFilterIcon(v,h),o.push(u),r.model.sheets[t]._multifilterIdx.push(u));if(!l)if(o.length>1&&(r.model.sheets[t]._multipleFiltering=!0,a=!0),f.rowIndex=f.rowIndex+1,this._getSelectedRangeData(f,s,i,f.colIndex),r._isFATResize){if(e=r.model.sheets[t].filterSettings.tableRange,e.length)for(u=0,p=e.length;u<p;u++)if(e[u].tableID===i){e[u].endRow=s.rowIndex;break}r._isFATResize=!1}else r.model.sheets[t].filterSettings.tableRange.push({startRow:f.rowIndex,endRow:s.rowIndex,tableID:i,multiFiltering:a,multifilterIdx:o,selectedCellIndexes:o,selectedRange:r.model.sheets[t]._selectedRange,filteredRange:r.model.sheets[t].filterSettings.filteredRange,filteredColumns:r.model.sheets[t].filterSettings.filteredColumns,predicate:{},hiddenIdx:[]})},_clearFilterTable:function(t,i,r){for(var s,y,o=this.XLObj,u=o.model.sheets[t].filterSettings.tableRange,h,c,e,l,a,f=0,v=u.length;f<v;f++)if(u[f].tableID===i){for(o.model.sheets[t]._selectedRange=u[f].selectedRange,s=u[f].multifilterIdx,y=u[f].startRow,e=0,l=s.length;e<l;e++)a=o.model.sheets[t].columns[s[e]].field,this._clearFilterColumn(a,"","","Or","","",u[f].tableID),r||(h=o.getCell(y-1,s[e]),c=h.find(".e-filterspan"),n(c).remove(),h.removeClass("e-filterhdr"));r||(u.splice(f,1),v=u.length)}},_clearFilterTableIcon:function(n,t){for(var u=this.XLObj,r=u.model.sheets[n].filterSettings.tableRange,o,s,f,h,e,i=0,c=r.length;i<c;i++)if(r[i].tableID===t)for(u.model.sheets[n]._selectedRange=r[i].selectedRange,u.model.sheets[n].filterSettings.filteredRange=r[i].filteredRange,o=r[i].multifilterIdx,s=r[i].startRow,f=0,h=o.length;f<h;f++)e=u.getCell(s-1,o[f]).find(".e-filterspan"),e.is(":visible")?e.hide():e.show()},_insertFilterIcon:function(n,t,i,r,u){var e,f,o;u&&n===r&&(e=this.XLObj.getCell(n,t-1),f=this._getFilterIcon(),o="e-ft"+i.tableID,f.addClass(o),i.multifilterIdx.push(i.multifilterIdx[i.multifilterIdx.length-1]+1),this._applyFilterIcon(e,f))},_changeFilterIcon:function(n,t){var i=n.find(".e-filterspan");t==="filter"?i.hasClass("e-ssfilter")?i.removeClass("e-ssfilter").addClass("e-ssfiltered"):i.hasClass("e-ssfilter-asc")?i.removeClass("e-ssfilter-asc").addClass("e-ssfiltered-asc"):i.hasClass("e-ssfilter-dsc")&&i.removeClass("e-ssfilter-dsc").addClass("e-ssfiltered-dsc"):i.hasClass("e-ssfiltered")?i.removeClass("e-ssfiltered").addClass("e-ssfilter"):i.hasClass("e-ssfiltered-asc")?i.removeClass("e-ssfiltered-asc").addClass("e-ssfilter-asc"):i.hasClass("e-ssfiltered-dsc")&&i.removeClass("e-ssfiltered-dsc").addClass("e-ssfilter-dsc")},_changeSortIcon:function(n,t){var i=n.find(".e-filterspan");t==="ascending"?i.hasClass("e-ssfilter")?i.removeClass("e-ssfilter").addClass("e-ssfilter-asc"):i.hasClass("e-ssfilter-dsc")?i.removeClass("e-ssfilter-dsc").addClass("e-ssfilter-asc"):i.hasClass("e-ssfiltered")?i.removeClass("e-ssfiltered").addClass("e-ssfiltered-asc"):i.hasClass("e-ssfiltered-dsc")&&i.removeClass("e-ssfiltered-dsc").addClass("e-ssfiltered-asc"):i.hasClass("e-ssfilter")?i.removeClass("e-ssfilter").addClass("e-ssfilter-dsc"):i.hasClass("e-ssfilter-asc")?i.removeClass("e-ssfilter-asc").addClass("e-ssfilter-dsc"):i.hasClass("e-ssfiltered")?i.removeClass("e-ssfiltered").addClass("e-ssfiltered-dsc"):i.hasClass("e-ssfiltered-asc")&&i.removeClass("e-ssfiltered-asc").addClass("e-ssfiltered-dsc")},_extendFilterRange:function(n,t){var o=this.XLObj,u,s=o.getActiveSheetIndex(),r=o.model.sheets[s].filterSettings.tableRange,i,e,f;if(r.length)for(i=0,f=r.length;i<f;i++)if(r[i].tableID==n){if(r[i].endRow<t[2]&&(u=r[i].selectedRange.dataSourceIndexes,r[i].endRow=r[i].selectedRange.endRow=t[2],u[u.length-1]<r[i].endRow))for(e=u[u.length-1],f=r[i].endRow;e<f;e++)u.push(e+1);break}},_checkFilteredCells:function(t){for(var r,b,v=this.XLObj,e=v.getSheet(t),s=e._selectedCells,h,k=new RegExp("\\be-table.*?\\b","g"),c,f=[-1],u=e.filterSettings.tableRange,o=e.selectedRange,l=!1,y=[],p,w,d=e._tableManager,i=0,a=s.length;i<a;i++)h=v.getCell(s[i].rowIndex,s[i].colIndex,t),h[0].className.indexOf("e-table")>-1&&(c=parseInt(h[0].className.match(k)[0].replace("e-table","")),f.indexOf(c)>-1&&f.push(c));for(i=0,a=f.length;i<a;i++)for(r=0,b=u.length;r<b;r++)if(u[r].tableID===f[i]){u[r].startRow===o[0]&&u[r].multifilterIdx[0]===o[1]&&u[r].endRow===o[2]&&u[r].multifilterIdx[u[r].multifilterIdx.length]===o[3]?(l=!0,p=n.extend(!0,{},d[f[i]]),w=n.extednd(!0,{},u[r]),y.push({tableID:f[i],tabObj:p,tabObj2:w})):l=!1;break}return tabDetails={isApplied:l,clrTable:y}},_moveFilteredCells:function(n,t){for(var r=t.clrTable,f,e,u=this.XLObj,i=0,o=r.length;i<o;i++)if(r[i].tableID>-1)u.XLFormat.removeTable(r[i].tableID),u.XLFormat.createTable(r[i].tableObj,newRng);else for(tabObj2=r[i].tabObj2,j=tabObj2.multifilterIdx[0],o=tabObj2.multifilterIdx[tabObj2.multifilterIdx.length-1];j<=o;j++)f=u._generateHeaderText(n,tabObj2.multifilterIdx[j]),delete u._excelFilter._predicates[n][f],u.XLFilter._clearFilterColumn(f,"","","Or",null,null,r[i].tableID),e=u.getCell(tabObj2.startRow-1,j,n),e.find("span.e-ssfilter").remove(),e.addClass(this._rAlign)},_updateFilterIcons:function(t,i,r,u){for(var f,o=this.XLObj,s=o._rAlign,e=t;e<=i;e++)if(f=o.getCell(e,r),f.find(".e-filterspan").length){f.find(".e-ssfilter, .e-ssfilter-asc, .e-ssfilter-dsc").length>0&&u!="clearfiltering"?(f.removeClass(s),this._changeFilterIcon(f,"filter")):f.find(".e-ssfiltered, .e-ssfiltered-asc, .e-ssfiltered-dsc").length>0&&(u=="clearfiltering"||n('span[id $="SelectAll"]').find("span.e-chk-act").length>0)&&(f.removeClass(s),this._changeFilterIcon(f,"filtered"));break}}}}(jQuery,Syncfusion),function(n,t,r){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.ribbon=function(n){this.XLObj=n;this._appTabCollection=null;this._tabCollection=[];this._contextualTabCollection=[];this._smallBtnHeight=25;this._mediumBtnHeight=35;this._bigBtnHeight=75;this._splitBtnHeight=75;this._dropDownHeight=25;this._ribbonState=!0;this._isSetModel=!1;this._isDesignTab=!0;this._isDirtySelect=!1;this._hasTitle="";this._pageLaySptBtnIds=["sizesbtn"];this._dataBtnIds=["sortAtoZ","sortZtoA","filter","clearfilter","validationbtn"];this._dataSptBtnIds=["validationsbtn"];this._toggleBtnIds=["bold","italic","underline","line-through","left","right","center","top","middle","bottom","wraptext","formatpainter"];this._homeBtnIds=["pastebtn","increasefontsize","decreasefontsize","increment","decrement","undo","redo","accounting","usegrouping","percentage","cut","copy","resizebtn_Editing","resizebtn_Styles","resizebtn_Number","resizebtn_Actions","resizebtn_Alignment","resizebtn_Font","resizebtn_Clipboard"];this._homeSptBtnIds=["pastesbtn","border","cFormat","formatastable","cellstyles","find","clear","merge","autosum"];this._insertBtnIds=["pivotTable","table","hyperlink","pictures"];this._insertSptBtnIds=["columnchart","barchart","stockchart","linechart","areachart","combochart","piechart","scatterchart"];this._pageLayBtnIds=["sizebtn","print","printselected"];this._pageLayChckBxIds=["Vheading","Vgridlines"];this._ddIds=["cellformat","fontsize","font-family"];this._cpIds=["background-color","color"];this._splitBtnIds=["border","paste","cFormat","formatastable","cellstyles","find","clear","sortfilter"];this._pasteMenuData=[{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:null},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:null}];this._fontFamily=[{value:"1",text:"Angsana New"},{value:"2",text:"Arial"},{value:"3",text:"Arial Black"},{value:"4",text:"Batang"},{value:"5",text:"Book Antiqua"},{value:"6",text:"Browallia New"},{value:"7",text:"Calibri"},{value:"8",text:"Cambria"},{value:"9",text:"Candara"},{value:"10",text:"Century"},{value:"11",text:"Comic Sans MS"},{value:"12",text:"Consolas"},{value:"13",text:"Constantia"},{value:"14",text:"Corbel"},{value:"15",text:"Cordia New"},{value:"16",text:"Courier"},{value:"17",text:"Courier New"},{value:"18",text:"DilleniaUPC"},{value:"19",text:"Dotum"},{value:"20",text:"FangSong"},{value:"21",text:"Garamond"},{value:"22",text:"Georgia"},{value:"23",text:"Gulim"},{value:"24",text:"GungSuh"},{value:"25",text:"KaiTi"},{value:"26",text:"JasmineUPC"},{value:"27",text:"Malgun Gothic"},{value:"28",text:"Mangal"},{value:"29",text:"Meiryo"},{value:"30",text:"Microsoft JhengHei"},{value:"31",text:"Microsoft YaHei"},{value:"32",text:"MingLiu"},{value:"33",text:"MingLiU_HKSCS"},{value:"34",text:"MS Gothic"},{value:"35",text:"MS Mincho"},{value:"36",text:"MS PGothic"},{value:"37",text:"MS PMincho"},{value:"38",text:"PMingliU"},{value:"39",text:"PMingLiU-ExtB"},{value:"40",text:"SimHei"},{value:"41",text:"SimSun"},{value:"42",text:"SimSun-ExtB"},{value:"43",text:"Tahoma"},{value:"44",text:"Times New Roman"},{value:"45",text:"Trebuchet MS"},{value:"46",text:"Verdana"},{value:"47",text:"Yu Gothic"},{value:"48",text:"Yu Mincho"}];this._fontSize=[{value:"8pt",text:"8"},{value:"9pt",text:"9"},{value:"10pt",text:"10"},{value:"11pt",text:"11"},{value:"12pt",text:"12"},{value:"14pt",text:"14"},{value:"16pt",text:"16"},{value:"18pt",text:"18"},{value:"20pt",text:"20"},{value:"22pt",text:"22"},{value:"24pt",text:"24"},{value:"26pt",text:"26"},{value:"28pt",text:"28"},{value:"36pt",text:"36"},{value:"48pt",text:"48"},{value:"72pt",text:"72"}];this._mergeMenuData=[{id:"MergeAndCenter",text:n._getLocStr("MergeAndCenter"),parentId:null,sprite:"e-icon e-ss-mergecenter"},{id:"MergeAcross",text:n._getLocStr("MergeAcross"),parentId:null,sprite:"e-icon e-ss-mergeacross"},{id:"MergeCells",text:n._getLocStr("MergeCells"),parentId:null,sprite:"e-icon e-ss-merge"},{id:"UnmergeCells",text:n._getLocStr("UnmergeCells"),parentId:null,sprite:"e-icon e-ss-unmerge"}];this._sortFltrMenuData=[{id:"SortAtoZ",text:this.XLObj._getLocStr("SortAtoZ"),parentId:null,sprite:"e-icon e-ssdrop-sortatoz"},{id:"SortZtoA",text:this.XLObj._getLocStr("SortZtoA"),parentId:null,sprite:"e-icon e-ssdrop-sortztoa"},{id:"Filter",text:this.XLObj._getLocStr("Filter"),parentId:null,sprite:"e-icon e-ssdrop-filter"},{id:"ClearFilter",text:this.XLObj._getLocStr("ClearFilter"),parentId:null,sprite:"e-icon e-ssdrop-clearfilter"}];this._findMenuData=[{id:"Find",text:n._getLocStr("Find")+"...",parentId:null,sprite:"e-icon e-ss-find"},{id:"Replace",text:n._getLocStr("Replace")+"...",parentId:null,sprite:"e-icon e-ss-replace"},{id:"GoTo",text:n._getLocStr("GoTo")+"...",parentId:null,sprite:"e-icon e-ss-goto"},{id:"GoToSpecial",text:n._getLocStr("GoTo")+" "+n._getLocStr("Special")+"...",parentId:null},{id:"Formulas",text:n._getLocStr("Formulas"),parentId:null},{id:"Comments",text:n._getLocStr("Comments"),parentId:null},{id:"CFormat",text:n._getLocStr("ConditionalFormat"),parentId:null},{id:"Constants",text:n._getLocStr("Constants"),parentId:null},{id:"DataValidation",text:n._getLocStr("DataValidation"),parentId:null}];this._valMenuData=[{id:"Validation",text:n._getLocStr("DataValidation")+"...",parentId:null,sprite:"e-icon e-ss-validation"},{id:"HighlightVal",text:n._getLocStr("HighlightVal"),parentId:null,sprite:"e-icon e-ss-hlval"},{id:"ClearHLVal",text:n._getLocStr("ClearFormats"),parentId:null,sprite:"e-icon e-ss-clearval"},{id:"ClearVal",text:n._getLocStr("ClearVal"),parentId:null,sprite:"e-icon e-ss-clearval"}];this._pageSizes=[{id:"A4",text:n._getLocStr("A4"),parentId:null,sprite:"e-icon e-ss-A4size"},{id:"A3",text:n._getLocStr("A3"),parentId:null,sprite:"e-icon e-ss-A3size"},{id:"Letter",text:n._getLocStr("Letter"),parentId:null,sprite:"e-icon e-ss-lettersize"}];this._viewMenuData=[{id:"freezePanes",text:n._getLocStr("freezePanes"),parentId:null,sprite:"e-icon e-ss-frzpane"},{id:"FreezeRow",text:n._getLocStr("FreezeRow"),parentId:null,sprite:"e-icon e-ss-frzrow"},{id:"FreezeColumn",text:n._getLocStr("FreezeColumn"),parentId:null,sprite:"e-icon e-ss-frzcln"}];this._insertMenuData=[{id:"InsertCells",text:n._getLocStr("inscells")+"...",parentId:null,sprite:"e-icon e-ssr-inscell"},{id:"InsertSheetRows",text:n._getLocStr("insrows"),parentId:null,sprite:"e-icon e-ssr-insrow"},{id:"InsertSheetColumns",text:n._getLocStr("inscols"),parentId:null,sprite:"e-icon e-ssr-inscol"},{id:"InsertSheet",text:n._getLocStr("inssheet"),parentId:null,sprite:"e-icon e-ssr-inssheet"}];this._resetPicture=[{id:"resetpicture",text:n._getLocStr("ResetPicture"),parentId:null,sprite:"e-icon e-ss-resetpicture"},{id:"resetsize",text:n._getLocStr("ResetSize"),parentId:null,sprite:"e-icon e-ss-resetpicture"}];var t=n._getLocStr("BorderStyles").split("/");this._borderMenuData=[{id:"bottomborder",text:n._getLocStr("BottomBorder"),parentId:null,sprite:"e-icon e-ss-bottomborder"},{id:"topborder",text:n._getLocStr("TopBorder"),parentId:null,sprite:"e-icon e-ss-topborder"},{id:"leftborder",text:n._getLocStr("LeftBorder"),parentId:null,sprite:"e-icon e-ss-leftborder"},{id:"rightborder",text:n._getLocStr("RightBorder"),parentId:null,sprite:"e-icon e-ss-rightborder"},{id:"noborder",text:n._getLocStr("NoBorder"),parentId:null,sprite:"e-icon e-ss-noborder"},{id:"allborder",text:n._getLocStr("AllBorder"),parentId:null,sprite:"e-icon e-ss-allborder"},{id:"outsideborder",text:n._getLocStr("OutsideBorder"),parentId:null,sprite:"e-icon e-ss-outsideborder"},{id:"thickboxborder",text:n._getLocStr("ThickBoxBorder"),parentId:null,sprite:"e-icon e-ss-thickboxborder"},{id:"thickbottomborder",text:n._getLocStr("ThickBottomBorder"),parentId:null,sprite:"e-icon e-ss-thickbottomborder"},{id:"topandbottomborder",text:n._getLocStr("TopandBottomBorder"),parentId:null,sprite:"e-icon e-ss-topandbottomborder"},{id:"topandthickbottomborder",text:n._getLocStr("TopandThickBottomBorder"),parentId:null,sprite:"e-icon e-ss-topandthickbottomborder"},{id:"drawborder",text:n._getLocStr("DrawBorder"),parentId:null,sprite:"e-icon e-ss-drawborder"},{id:"drawbordergrid",text:n._getLocStr("DrawBorderGrid"),parentId:null,sprite:"e-icon e-ss-drawbordergrid"},{id:n._id+"_bordercolor",text:n._getLocStr("BorderColor"),parentId:null,sprite:"e-iconcolor"},{id:n._id+"_Ribbon_bordercolor",text:"",parentId:n._id+"_bordercolor"},{id:n._id+"_Ribbon_borderstyle",text:n._getLocStr("BorderStyle"),parentId:null},{id:"solid",text:t[0],parentId:n._id+"_Ribbon_borderstyle"},{id:"dashed",text:t[1],parentId:n._id+"_Ribbon_borderstyle"},{id:"dotted",text:t[2],parentId:n._id+"_Ribbon_borderstyle"},];this._cFormatMenuData=[{id:n._id+"_HLCellRules",text:"Highlight Cell Rules",parentId:null,sprite:"e-icon e-ss-hlcellrules"},{id:"greaterthan",text:n._getLocStr("GreaterThan")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-greaterthan"},{id:"lessthan",text:n._getLocStr("LessThan")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-lessthan"},{id:"between",text:n._getLocStr("Between")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-between"},{id:"equalto",text:n._getLocStr("EqualTo")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-equalto"},{id:"textcontains",text:n._getLocStr("TextthatContains")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-textcontains"},{id:"dateoccur",text:n._getLocStr("DateOccurring")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-dateoccur"},{id:n._id+"_ClearRules",text:n._getLocStr("ClearRules"),parentId:null,sprite:"e-icon e-ss-clearrules"},{id:"clearselected",text:n._getLocStr("ClearRulesfromSelected"),parentId:n._id+"_ClearRules"},{id:"clearall",text:n._getLocStr("ClearRulesfromEntireSheets"),parentId:n._id+"_ClearRules"},];this._textAlign=[{value:"1",text:"Left"},{value:"2",text:"Center"},{value:"3",text:"Right"}];this._verticalAlign=[{value:"1",text:"Top"},{value:"2",text:"Middle"},{value:"3",text:"Bottom"}];this._actions=[{value:"Greater",text:"greater than"},{value:"GreaterOrEqual",text:"greater or equal to"},{value:"Less",text:"less than"},{value:"LessOrEqual",text:"less than or equal to"},{value:"Equal",text:"equal to"},{value:"NotEqual",text:"not equal to"},{value:"Between",text:"between"},{value:"NotBetween",text:"not between"}];this._types=[{value:"number",text:"Number"},{value:"decimal",text:"Decimal"},{value:"date",text:"Date"},{value:"time",text:"Time"},{value:"text",text:"TextLength"},{value:"list",text:"List"}];this._cFormatData={greaterthan:["GTTitle","GTContent"],lessthan:["LTTitle","LTContent"],between:["BWTitle","BWContent"],equalto:["EQTitle","EQContent"],textcontains:["ContainsTitle","ContainsContent"],dateoccur:["DateTitle","DateContent"]};this._styles=[{value:"redft",text:"Light Red Fill with Dark Red Text"},{value:"yellowft",text:"Yellow Fill with Dark Yellow Text"},{value:"greenft",text:"Green Fill with Dark Green Text"},{value:"redf",text:"Red Fill"},{value:"redt",text:"Red Text"}];this._currentCFormat="";this._addrList=[];this._within=[{value:"sheet",text:n._getLocStr("Sheet")},{value:"workbook",text:n._getLocStr("Workbook")}];this._sType=[{value:"columns",text:n._getLocStr("Columns")},{value:"rows",text:n._getLocStr("Rows")}];this._vType=[{value:"value",text:n._getLocStr("Value")},{value:"formula",text:n._getLocStr("Formula")},{value:"comment",text:n._getLocStr("Comments")}];this._direction=[{value:"down",text:n._getLocStr("Down")},{value:"up",text:n._getLocStr("Up")}];this._gotoRBtnSet1=["Comments","Blanks","LastCell","Formulas","Constants"];this._gotoRBtnSet2=["RowDiff","ColDiff","CFormat","DataValidation"];this._gotoChkBox=["GotoNumbers","GotoText","GotoLogicals","GotoError"];this._othersSptBtnIds=["inssbtn","delsbtn","find","fPane"];this._contextualBtnIds=["resizetable","convertorange"];this._contextualInputIds=["tableid","tablename"];this._contextualCheckBoxIds=["tsofirstcolumn","tsolastcolumn","tsototalrow","tsofiltercolumn"];this._numberFormat=[{value:"1",text:"General"},{value:"2",text:"Number"},{value:"3",text:"Currency"},{value:"4",text:"Accounting"},{value:"5",text:"Percentage"},{value:"6",text:"Text"},{value:"7",text:"Shortdate"},{value:"8",text:"Longdate"},{value:"9",text:"Time"},{value:"10",text:"Scientific"},{value:"11",text:"Fraction"}];this._othersBtnIds=["insbtn","delbtn","namemanager","definename"];this._deleteMenuData=[{id:"DeleteCells",text:n._getLocStr("delcells")+"...",parentId:null,sprite:"e-icon e-ssr-delcell"},{id:"DeleteSheetRows",text:n._getLocStr("delrows"),parentId:null,sprite:"e-icon e-ssr-delrow"},{id:"DeleteSheetColumns",text:n._getLocStr("delcols"),parentId:null,sprite:"e-icon e-ssr-delcol"},{id:"DeleteSheet",text:n._getLocStr("delsheet"),parentId:null,sprite:"e-icon e-ssr-delsheet"}];this._clearMenuData=[{id:"Clear_All",text:n._getLocStr("ClearAll"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Clear_Formats",text:n._getLocStr("ClearFormats"),parentId:null,sprite:"e-icon e-ss-clearformat"},{id:"Clear_Contents",text:n._getLocStr("ClearContents"),parentId:null},{id:"Clear_Comments",text:n._getLocStr("ClearComments"),parentId:null},{id:"Clear_Hyperlinks",text:n._getLocStr("ClearHyperLinks"),parentId:null}];this._autosumMenuData=[{id:"Sum",text:n._getLocStr("Sum"),parentId:null,sprite:"e-icon e-ss-autosum"},{id:"Average",text:n._getLocStr("Average"),parentId:null},{id:"Count",text:n._getLocStr("CountNumber"),parentId:null},{id:"Max",text:n._getLocStr("Max"),parentId:null},{id:"Min",text:n._getLocStr("Min"),parentId:null}];this._cmntTglBtnIds=["showAllComments"];this._cmntBtnIds=["newComment","deleteComment","previousComment","nextComment","showHideComment"];this._chartThemes=[{value:"flatlight",text:"Flat Light"},{value:"flatdark",text:"Flat Dark"},{value:"azure",text:"Azure"},{value:"azuredark",text:"Azure Dark"},{value:"lime",text:"Lime"},{value:"limedark",text:"Lime Dark"},{value:"saffron",text:"Saffron"},{value:"saffrondark",text:"Saffron Dark"}];this._isCustomCellStyleReset=!1};t.spreadsheetFeatures.ribbon.prototype={_renderChartTypeDialog:function(){var i=this.XLObj,r=i._id+"_charttypedlg",u,s,f,e,o,h,c,l,a;u=t.buildTag("div#"+r+".e-chartdialog");s=t.buildTag("div#"+r+"_allcharttab.e-chtdlgtab");a=t.buildTag("div.e-dlg-fields e-dlgctndiv");h=t.buildTag("ul","","");l=t.buildTag("a",i._getLocStr("AllCharts"),{},{href:"#"+i._id+"_allchart"});c=t.buildTag("li",l);u.append(a.append(s.append(h.append(c))));o=t.buildTag("div#"+r+"_btndiv.e-dlg-btnfields");$btnctnr=t.buildTag("div.e-dlg-btnctnr");f=t.buildTag("input#"+r+"_okbtn");e=t.buildTag("input#"+r+"_cantn");f.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._chartTypeOk,this),enabled:!0});e.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._chartTypeCancel,this),showRoundedCorner:!0,width:60});o.append($btnctnr.append(f,e));u.append(o);i.element.append(u);u.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("ChartType"),width:510,height:"auto",cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)});n("#"+r+"_allcharttab").ejTab({cssClass:"e-ss-dlgtab",width:480});this._renderAllChartTab()},_renderAllChartTab:function(){var b=this.XLObj,r=b._id,u=r+"_chartdlg_charttab",v,y,e,o,k="",i,p,d,f,s,g,h,c,l,w="",a=["Column-6","Bar-6","Radar-2","Line-2","Area-3","Pie-3","Scatter-1"];for(v=t.buildTag("div#"+u+"_right.e-chtdlgright"),y=t.buildTag("div#"+u+"_left.e-chtdlgleft"),e=t.buildTag("div#"+u+"_content.e-chtdlgcontent",{"border-bottom":0}),o=t.buildTag("ul#"+u+"_list"),h=0,c=a.length;h<c;h++)i=a[h].split("-")[0],k+="<li><span class='e-icon e-ss-dlg"+i.toLowerCase()+"chart'><\/span>"+i+"<\/li>";for(o.append(k),o.ejListBox({width:"240",selectIndexChanged:n.proxy(this._onChartChange,this),height:"300",allowMultiSelection:!1,selectedItemIndex:0}),y.append(o),e=t.buildTag("div#"+u+"_content.e-chtdlgcontent"),v.append(e),n("#"+r+"_allchart").append(y).append(v),s=0,c=a.length;s<c;s++){for(l=a[s].split("-"),d=b._getLocStr("Title"+l[0]+"Chart").split("/"),i=l[0].toLowerCase(),p=t.buildTag("div#"+r+"_"+i+"chart"),f=1,g=parseInt(l[1]);f<=g;f++)w+="<div class='e-chartimg e-dlg"+i+"chart"+f+"' title='"+d[f-1]+"'><\/div>";e.append(p.append(w));n("#"+r+"_"+i+"chart").find(".e-dlg"+i+"chart1").addClass("e-chartselect");p.hide();w=""}n("#"+r+"_columnchart").show()},_onChartChange:function(t){for(var r=this.XLObj,u=t.model.value.toLowerCase(),f=["column","bar","radar","line","area","pie","scatter"],i=0;i<f.length;i++)n("#"+r._id+"_"+f[i]+"chart").hide();n("#"+r._id+"_"+u+"chart").show();n("#"+r._id+"_allchart").find(".e-chartimg").removeClass("e-chartselect");n("#"+r._id+"_"+u+"chart").find(".e-dlg"+u+"chart1").addClass("e-chartselect")},_initValDialog:function(){var i,r,u,f,e,o,s,h,n=this.XLObj,c,l;i=t.buildTag("div#"+n._id+"_ValDialog");r=t.buildTag("div#"+n._id+"_ValDialog_valDlgTab");c=t.buildTag("div.e-dlg-fields e-dlgctndiv");o=t.buildTag("ul");h=t.buildTag("a","Settings",{},{href:"#"+n._id+"_Validation"});s=t.buildTag("li",h);o.append(s);r.append(o);r.ejTab({width:325,height:320,cssClass:"e-ss-dlgtab"});i.append(c.append(r));e=t.buildTag("div#"+n._id+"btnDiv.e-dlg-btnfields");l=t.buildTag("div.e-dlg-btnctnr");u=t.buildTag("input#"+n._id+"Dialog_OkBtn");f=t.buildTag("input#"+n._id+"Dialog_CancelBtn");u.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:"19%",click:t.proxy(this._valDlgBtnClick,this,"ok"),enabled:!0});f.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._valDlgBtnClick,this,"cancel"),showRoundedCorner:!0,width:"19%"});e.append(l.append(u,f));i.append(e);i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("DataValidation"),width:355,height:"auto",cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_initCFDialog:function(){var n=this.XLObj,i,e,r,u,f,o;i=t.buildTag("div#"+n._id+"_CFDialog");n.element.append(i);e=t.buildTag("div#"+n._id+"_CondFormat.e-dlgctndiv");i.append(e);f=t.buildTag("div#"+n._id+"cfBtnDiv.e-dlg-btnfields");o=t.buildTag("div.e-dlg-btnctnr");r=t.buildTag("input#"+n._id+"cfDialog_OkBtn");u=t.buildTag("input#"+n._id+"cfDialog_CancelBtn");r.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._dlgCFOk,this),enabled:!0});u.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._dlgCFCancel,this),showRoundedCorner:!0,width:"25%"});f.append(o.append(r,u));i.append(f);i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("ConditionalFormat"),width:275,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_initHLDialog:function(){var i=this.XLObj,r,u,f,e,o,s,h,c,l;r=t.buildTag("div#"+i._id+"_HLDialog");u=t.buildTag("div#"+i._id+"_HLDialogTab");l=t.buildTag("div.e-dlg-fields e-dlgctndiv");f=t.buildTag("ul");o=t.buildTag("a",i._getLocStr("WebPage"),{},{href:"#"+i._id+"_Web"});e=t.buildTag("li",o);f.append(e);o=t.buildTag("a",i._getLocStr("WorkSheet"),{},{href:"#"+i._id+"_Doc"});e=t.buildTag("li",o);f.append(e);u.append(f);u.ejTab({width:350,itemActive:t.proxy(this._hlTabChange,this),cssClass:"e-ss-dlgtab"});r.append(l.append(u));s=t.buildTag("div#"+i._id+"hlBtnDiv.e-dlg-btnfields");$btnctnr=t.buildTag("div.e-dlg-btnctnr");h=t.buildTag("input#"+i._id+"hlDialog_OkBtn");c=t.buildTag("input#"+i._id+"hlDialog_CancelBtn");h.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgHLOk,this),enabled:!0});c.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._dlgHLCancel,this),showRoundedCorner:!0,width:60});s.append($btnctnr.append(h,c));r.append(s);r.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("InsertHyperLink"),width:380,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_Ribbon_webAddress"),r=n("#"+i._id+"_Ribbon_cellAddress");t.focus().setInputPos(t.val().length);r.focus().setInputPos(r.val().length)})})},_initFRDialog:function(){var i=this.XLObj,e,o,s,h,c,l,y,f,r,p,u,a,v;e=t.buildTag("div#"+i._id+"_FRDialog");o=t.buildTag("div#"+i._id+"_FRDialog_FPDlgTab");p=t.buildTag("div.e-dlg-fields e-dlgctndiv");f=t.buildTag("ul");u=t.buildTag("a",i._getLocStr("Find"),{},{href:"#"+i._id+"_Find"});r=t.buildTag("li",u);f.append(r);u=t.buildTag("a",i._getLocStr("Replace"),{},{href:"#"+i._id+"_Replace"});r=t.buildTag("li",u);f.append(r);u=t.buildTag("a",i._getLocStr("Settings"),{},{href:"#"+i._id+"_Settings"});r=t.buildTag("li",u);f.append(r);o.append(f);o.ejTab({width:390,height:110,itemActive:t.proxy(this._findTabChange,this),cssClass:"e-ss-dlgtab"});e.append(p.append(o));l=t.buildTag("div#"+i._id+"btnFRDiv.e-dlg-btnfields");y=t.buildTag("div.e-dlg-btnctnr");a=t.buildTag("input#"+i._id+"FR_ReplaceBtn","",{"margin-left":0});v=t.buildTag("input#"+i._id+"FR_ReplaceAllBtn");s=t.buildTag("input#"+i._id+"FR_NextBtn");h=t.buildTag("input#"+i._id+"FR_PrevBtn");c=t.buildTag("input#"+i._id+"FR_CloseBtn");a.ejButton({text:i._getLocStr("Replace"),showRoundedCorner:!0,width:55,height:17,click:t.proxy(this._btnFROnClick,this,"FR_ReplaceBtn"),enabled:!0}).css("display","none");v.ejButton({text:i._getLocStr("ReplaceAll"),showRoundedCorner:!0,width:70,height:17,click:t.proxy(this._btnFROnClick,this,"FR_ReplaceAllBtn"),enabled:!0}).css("display","none");s.ejButton({text:i._getLocStr("FindNext"),showRoundedCorner:!0,width:69,height:17,click:t.proxy(this._btnFROnClick,this,"FR_NextBtn"),enabled:!0});h.ejButton({text:i._getLocStr("FindPrev"),showRoundedCorner:!0,width:69,height:17,click:t.proxy(this._btnFROnClick,this,"FR_PrevBtn"),enabled:!0});c.ejButton({text:i._getLocStr("Close"),click:t.proxy(this._btnFROnClick,this,"FR_CloseBtn"),showRoundedCorner:!0,width:47,height:17});l.append(y.append(a,v,s,h,c));e.append(l);e.ejDialog({showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("FindnReplace"),width:420,height:"auto",cssClass:"e-ss-dialog e-ss-frdlg",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_Ribbon_textFind");t.focus().setInputPos(t.val().length)})})},_initGoToDialog:function(){var i=this.XLObj,r,u,c,f,e,o,s,h,l;r=t.buildTag("div#"+i._id+"_GoDialog");u=t.buildTag("div#"+i._id+"_GoToDlgTab");l=t.buildTag("div.e-dlg-fields e-dlgctndiv");f=t.buildTag("ul");o=t.buildTag("a",i._getLocStr("GoTo"),{},{href:"#"+i._id+"_GoTo"});e=t.buildTag("li",o);f.append(e);o=t.buildTag("a",i._getLocStr("GoTo")+" "+i._getLocStr("Special"),{},{href:"#"+i._id+"_GoToSp"});e=t.buildTag("li",o);f.append(e);u.append(f);u.ejTab({width:288,height:340,itemActive:t.proxy(this._gotoTabChange,this),cssClass:"e-ss-dlgtab"});r.append(l.append(u));c=t.buildTag("div#"+i._id+"btnDiv.e-dlg-btnfields");$btnctnr=t.buildTag("div.e-dlg-btnctnr");r.append(c.append($btnctnr));s=t.buildTag("input#"+i._id+"Dialog_GoOkBtn");h=t.buildTag("input#"+i._id+"Dialog_GoCancelBtn");s.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:"21.5%",click:t.proxy(this._gotoBtnClick,this,"ok")});h.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._gotoBtnClick,this,"cancel"),showRoundedCorner:!0,width:"21.5%"});$btnctnr.append(s,h);i.element.append(r);r.ejDialog({showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("GoTo"),width:318,height:"auto",cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_textRef");t.focus().setInputPos(t.val().length)})})},_dialogClose:function(){this.XLObj.setSheetFocus()},_beforeDlgClose:function(t){var i=n("#"+this.XLObj._id+"_nmgrid_dialogEdit_overLay");i.length&&(t.cancel=!0)},_setButtonHeights:function(){this._smallBtnHeight=25;this._mediumBtnHeight=35;this._bigBtnHeight=75;this._splitBtnHeight=75;this._drpDownHeight=25},_homeTabObj:function(){var n,f=this.XLObj,u="imagetop",r={id:"home",text:"HOME",groups:[]},i=f._id,e=f.model;n={text:"Clipboard",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("pastebtn","paste","textandimage","e-icon e-ssr-paste",45,this._mediumBtnHeight,"PasteTitle","PasteContent",!1,u),this._generateSplitBtn("pastesbtn","Paste","textandimage",i+"_Ribbon_Paste",{dataSource:this._pasteMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,45,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-pastesbtn","PasteTitle","PasteSplitContent")]},{groups:[this._generateBtn("cut","Cut","textandimage","e-icon e-ssr-cut",58,this._smallBtnHeight,"CutTitle","CutContent"),this._generateBtn("copy","Copy","textandimage","e-icon e-ssr-copy",67,this._smallBtnHeight,"CopyTitle","CopyContent"),this._generateToggleBtn("formatpainter","FormatPainter","textandimage","e-icon e-ss-formatpainter","FPTitle",110,this._smallBtnHeight,"FPContent")]}]};r.groups.push(n);n={text:"Font",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateDD("font-family","FontFamily",this._fontFamily,"7",150,this._smallBtnHeight,"FontFamily","FFContent"),this._generateDD("fontsize","FontSize",this._fontSize,"11pt",65,this._smallBtnHeight,"FontSize","FSContent"),this._generateBtn("increasefontsize","IncreaseFontSize","imageonly","e-icon e-ss-increasefontsize","",this._smallBtnHeight,"IncreaseFontSize","IFSContent"),this._generateBtn("decreasefontsize","DecreaseFontSize","imageonly","e-icon e-ss-decreasefontsize","",this._smallBtnHeight,"DecreaseFontSize","DFSContent")]},{groups:[this._generateToggleBtn("bold","Bold","imageonly","e-icon e-ss-bold","BoldTitle","",this._smallBtnHeight,"BoldContent"),this._generateToggleBtn("italic","Italic","imageonly","e-icon e-ss-italic","ItalicTitle","",this._smallBtnHeight,"ItalicContent"),this._generateToggleBtn("underline","Underline","imageonly","e-icon e-ss-underline","ULineTitle","",this._smallBtnHeight,"ULineContent"),this._generateToggleBtn("line-through","Linethrough","imageonly","e-icon e-ss-linethrough","LineTrTitle",25,this._smallBtnHeight,"LineTrContent",!0),this._generateSplitBtn("border","Border","imageonly",i+"_Ribbon_Border",{dataSource:this._borderMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-bottomborder",!0,37,this._smallBtnHeight,"","","","e-borderbtn","Border","BorderContent"),this._generateCustomControl(i+"_Ribbon_background-color","BackgroundColor","BackgroundColor","BGContent"),this._generateCustomControl(i+"_Ribbon_color","Color","Color","ColorContent")]}]};r.groups.push(n);n={text:"Alignment",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateToggleBtn("top","TopAlign","imageonly","e-icon e-ss-topalign","TopAlign","","","TopAlignContent"),this._generateToggleBtn("middle","MiddleAlign","imageonly","e-icon e-ss-middlealign","MiddleAlign","","","MiddleAlignContent"),this._generateToggleBtn("bottom","BottomAlign","imageonly","e-icon e-ss-bottomalign","BottomAlign","","","BottomAlignContent",!0),this._generateToggleBtn("wraptext","WrapText","textandimage","e-icon e-ss-wraptext","WrapText",85,25,"WrapTextContent")]},{groups:[this._generateToggleBtn("left","AlignLeft","imageonly","e-icon e-ss-alignleft","AlignLeft","","","AlignLeftContent"),this._generateToggleBtn("center","AlignCenter","imageonly","e-icon e-ss-aligncenter","AlignCenter","","","AlignCenterContent"),this._generateToggleBtn("right","AlignRight","imageonly","e-icon e-ss-alignright","AlignRight","","","AlignRightContent",!0),this._generateSplitBtn("merge","MergeAndCenter","textandimage",i+"_Ribbon_Merge",{dataSource:this._mergeMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-merge",!1,136,25,"right","","","e-spreadsheet e-mergebtn","MergeAndCenter","MergeAndCenterContent")]}]};r.groups.push(n);n={text:"Actions",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("undo","Undo","textandimage","e-ss-undo",40,this._bigBtnHeight,"UndoTitle","UndoContent",!1,u,""),this._generateBtn("redo","Redo","textandimage","e-ss-redo",40,this._bigBtnHeight,"RedoTitle","RedoContent",!1,u,"")]}]};r.groups.push(n);n={text:"Number",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateDD("cellformat","NumberFormat",this._numberFormat,"1",125,this._smallBtnHeight,"NumberFormat","NumberFormatContent")]},{groups:[this._generateBtn("accounting","AccountingStyle","imageonly","e-icon e-ss-accounting","",this._smallBtnHeight,"AccountingStyle","AccountingStyleContent"),this._generateBtn("percentage","PercentageStyle","imageonly","e-icon e-ss-percentage","",this._smallBtnHeight,"PercentageStyle","PercentageStyleContent"),this._generateBtn("usegrouping","CommaStyle","imageonly","e-icon e-ss-comma","",this._smallBtnHeight,"CommaStyle","CommaStyleContent",!0),this._generateBtn("increment","IncreaseDecimal","imageonly","e-icon e-ss-increasedecimal","",this._smallBtnHeight,"IncreaseDecimal","IncreaseDecimalContent"),this._generateBtn("decrement","DecreaseDecimal","imageonly","e-icon e-ss-decreasedecimal","",this._smallBtnHeight,"DecreaseDecimal","DecreaseDecimalContent")]}]};r.groups.push(n);n={text:"Styles",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("cFormat","ConditionalFormat","textandimage",i+"_CFormat",{dataSource:this._cFormatMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-condformat",!1,75,this._splitBtnHeight,"bottom",u,"dropdown","e-spreadsheet e-cformatbtn","ConditionalFormat","CFContent"),this._generateSplitBtn("formatastable","FormatasTable","textandimage",i+"_formatastable","","e-icon e-ssr-formatastable",!1,65,this._splitBtnHeight,"bottom",t.ImagePosition.ImageTop,"dropdown","e-spreadsheet e-formatastablebtn","FormatAsTable","FATContent"),this._generateSplitBtn("cellstyles","CellStyles","textandimage",i+"_cellstyles","","e-icon e-ssr-cellstyles",!1,55,this._splitBtnHeight,"bottom",t.ImagePosition.ImageTop,"dropdown","e-spreadsheet e-cellstylebtn","CellStyles","CellStylesContent")]}]};r.groups.push(n);n={text:"Editing",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("sortfilter","SortFilter","textandimage",i+"_Ribbon_SortFilter",{dataSource:this._sortFltrMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-sortfilter",!1,50,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-sortfltrbtn","SortFilter","SortFilterContent")]},{groups:[this._generateSplitBtn("autosum","AutoSum","textandimage",i+"_Ribbon_AutoSum",{dataSource:this._autosumMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-autosum",!1,100,25,"right","","dropdown","e-spreadsheet e-autosumbtn","AutoSumTitle","AutoSumContent"),this._generateSplitBtn("clear","Clear","textandimage",i+"_Ribbon_Clear",{dataSource:this._clearMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-clear",!1,80,25,"right","","dropdown","e-spreadsheet e-clearbtn","Clear","ClearContent")]}]};r.groups.push(n);this._tabCollection.push(r)},_insertTabObj:function(){var n,f=this.XLObj,u="imagetop",r={id:"insert",text:"INSERT",groups:[]},i=f._id;n={text:"Tables",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("pivotTable","PivotTable","textandimage","e-icon e-ssr-pivottable",65,this._bigBtnHeight,"PivotTable","PivotTableContent",!1,u),this._generateBtn("table","Table","textandimage","e-icon e-ssr-table",50,this._bigBtnHeight,"Table","TableContent",!1,u)]}]};r.groups.push(n);n={text:"Illustrations",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("pictures","Pictures","textandimage","e-icon e-ssr-pictures",50,this._bigBtnHeight,"PicturesTitle","PicturesContent",!1,u,"")]}]};r.groups.push(n);n={text:"Links",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("hyperlink","HyperLink","textandimage","e-icon e-ssr-hyperlink",60,this._bigBtnHeight,"HyperLinkTitle","HyperLinkContent",!1,u,"")]}]};r.groups.push(n);n={text:"Charts",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("columnchart","ColumnChart","imageonly",i+"_Ribbon_ColumnChart","","e-icon e-ss-colchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","ColumnChartTitle","ColumnChartContent"),this._generateSplitBtn("barchart","BarChart","imageonly",i+"_Ribbon_BarChart","","e-icon e-ss-barchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","BarChartTitle","BarChartContent"),this._generateSplitBtn("stockchart","StockChart","imageonly",i+"_Ribbon_StockChart","","e-icon e-ss-stockchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","StockChartTitle","StockChartContent")]},{groups:[this._generateSplitBtn("linechart","LineChart","imageonly",i+"_Ribbon_LineChart","","e-icon e-ss-linechart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","LineChartTitle","LineChartContent"),this._generateSplitBtn("areachart","AreaChart","imageonly",i+"_Ribbon_AreaChart","","e-icon e-ss-areachart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","AreaChartTitle","AreaChartContent"),this._generateSplitBtn("piechart","PieChart","imageonly",i+"_Ribbon_PieChart","","e-icon e-ss-piechart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","PieChartTitle","PieChartContent")]},{groups:[this._generateSplitBtn("scatterchart","ScatterChart","imageonly",i+"_Ribbon_ScatterChart","","e-icon e-ss-scterchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","ScatterChartTitle","ScatterChartContent")]}]};r.groups.push(n);this._tabCollection.push(r)},_dataTabObj:function(){var n,r=this.XLObj,i={id:"data",text:"DATA",groups:[]};n={text:"Sort & Filter",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("sortAtoZ","SortAtoZ","textandimage","e-icon e-ssr-sortatoz",90,this._smallBtnHeight,"SortAtoZ","SortAtoZContent",!1,"","e-datapadding"),this._generateBtn("sortZtoA","SortZtoA","textandimage","e-icon e-ssr-sortztoa",90,this._smallBtnHeight,"SortZtoA","SortZtoAContent",!1,"","e-datapadding")]},{groups:[this._generateBtn("filter","Filter","textandimage","e-icon e-ssr-filter",60,this._smallBtnHeight,"Filter","FilterContent",!1,"","e-datapadding"),this._generateBtn("clearfilter","ClearFilter","textandimage","e-icon e-ss-clearfilter",90,this._smallBtnHeight,"ClearFilter","ClearFilterContent",!1,"","e-datapadding")]}]};i.groups.push(n);n={text:"Data Tools",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("validationbtn","Validation","imageonly","e-icon e-ssr-validation",70,39,"DataValidation","DVContent",!1,"imagetop"),this._generateSplitBtn("validationsbtn","DataValidation","textandimage",r._id+"_Ribbon_Validation",{dataSource:this._valMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,70,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-validationsbtn","DataValidation","DVContent")]}]};i.groups.push(n);this._tabCollection.push(i)},_pageTabObj:function(){var n,u=this.XLObj,r="imagetop",i={id:"pagelayout",text:"PAGE LAYOUT",groups:[]};n={text:"Show",alignType:t.Ribbon.alignType.rows,width:105,content:[{groups:[{contentID:u._id+"_Ribbon_pagesetupleft",type:t.Ribbon.type.custom,height:80},]}]};i.groups.push(n);n={text:"Page Layout",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("sizebtn","size","imageonly","e-icon e-ssr-pagesize",65,44,"size","PageSizeContent",!1,r,""),this._generateSplitBtn("sizesbtn","PageSize","textandimage",u._id+"_Ribbon_PageSize",{dataSource:this._pageSizes,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,65,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-pagesizesbtn","PageSize","PageSizeContent")]}]};i.groups.push(n);n={text:"Print",alignType:t.Ribbon.alignType.columns,width:120,content:[{groups:[this._generateBtn("print","Print","textandimage","e-icon e-ssr-print",50,this._bigBtnHeight,"Print","PrintContent",!1,r,"")]},{groups:[this._generateBtn("printselected","PrintSelected","textandimage","e-icon e-ssr-printselected",55,this._bigBtnHeight,"PrintSelected","PrintSelectedContent",!0,r,"")]}]};i.groups.push(n);this._tabCollection.push(i)},_reviewTabObj:function(){var i,u=this.XLObj,n="imagetop",r={id:"review",text:"REVIEW",groups:[]};i={text:"Comments",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("newComment","New","textandimage","e-icon e-ssr-newcmnt",49,this._bigBtnHeight,"NewCommentTitle","NewCommentContent",!1,n)]},{groups:[this._generateBtn("deleteComment","Delete","textandimage","e-icon e-ssr-deletecmnt",49,this._bigBtnHeight,"DeleteComment","DeleteCommentContent",!1,n)]},{groups:[this._generateBtn("previousComment","Previous","textandimage","e-icon e-ssr-previouscmnt",49,this._bigBtnHeight,"Previous","PreviousContent",!1,n)]},{groups:[this._generateBtn("nextComment","Next","textandimage","e-icon e-ssr-nextcmnt",49,this._bigBtnHeight,"Next","NextContent",!1,n)]},{groups:[this._generateBtn("showHideComment","ShowHide","textandimage","e-icon e-ssr-showhidecmnt",160,this._smallBtnHeight,"ShowHide","ShowHideContent",!1,"imageLeft","e-ssr-cmntcolbtn"),this._generateToggleBtn("showAllComments","ShowAll","textandimage","e-icon e-ssr-showallcmnt","ShowAll",155,this._smallBtnHeight,"ShowAllContent",!1,"e-ssr-cmntcolbtn")]}]};r.groups.push(i);this._tabCollection.push(r)},_otherTabObj:function(){var n,r=this.XLObj,u="imagetop",i={id:"others",text:"OTHERS",groups:[]},f=r._id,e=t.ContentType;n={text:"Window",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("fPane","FreezePanes","textandimage",r._id+"_Ribbon_FPane",{dataSource:this._viewMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-frzpane",!1,55,this._splitBtnHeight,"bottom",u,"dropdown","e-spreadsheet e-fpanebtn","FreezePanes","FreezePanesContent")]}]};i.groups.push(n);n={text:r._getLocStr("Formula"),alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("namemanager","NameManager",e.TextAndImage,"e-icon e-ssr-namemngr",55,this._bigBtnHeight,"NameManager","NameManagerContent",!1,u,"")]},{groups:[this._generateBtn("definename","DefineName",e.TextAndImage,"e-icon e-ssr-definename",110,25,"DefineName","DefineNameContent"),this._generateSplitBtn("useinformula","UseInFormula","textandimage",r._id+"_nmuseinformula","","e-icon e-ssr-useformula",!1,125,25,t.ArrowPosition.Bottom,t.ImagePosition.ImageLeft,"dropdown","e-spreadsheet e-useinformulabtn","UseInFormula","UseInFormulaContent")]}]};i.groups.push(n);n={text:"Cells",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("insbtn","Insert","imageonly","e-icon e-ssr-insert",54,40,"InsertTitle","InsertContent",!1,u),this._generateSplitBtn("inssbtn","Insert","textandimage",f+"_Ribbon_Ins",{dataSource:this._insertMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,54,this._mediumBtnHeight,"bottom","","dropdown","e-insertsbtn","InsertTitle","InsertSBContent")]},{groups:[this._generateBtn("delbtn","Delete","imageonly","e-icon e-ssr-delete",54,40,"DeleteTitle","DeleteContent",!1,u),this._generateSplitBtn("delsbtn","Delete","textandimage",f+"_Ribbon_Del",{dataSource:this._deleteMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,54,this._mediumBtnHeight,"bottom","","dropdown","e-deletesbtn","DeleteTitle","DeleteContent")]}]};i.groups.push(n);n={text:"Editing",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("find","FindSelect","textandimage",f+"_Ribbon_FindRep",{dataSource:this._findMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-findselect",!1,55,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-findbtn","FindSelectTitle","FindSelectContent")]}]};i.groups.push(n);this._tabCollection.push(i)},_renderRibbon:function(){var u=this.XLObj,i=u._id,r=u.element,f=u.model,e,o,s,h,w,c,l,a,b,v,y,p;r.prepend(t.buildTag("div","","",{id:i+"_Ribbon"}));r.append(t.buildTag("ul","","",{id:i+"_Menu"}));this._renderChartTypeDialog();f.allowCellFormatting&&(r.append(t.buildTag("input","","",{id:i+"_Ribbon_background-color",type:"text"})),r.append(t.buildTag("input","","",{id:i+"_Ribbon_BorderColor",type:"text"})));r.append(this._borderPicture());f.allowCharts&&r.append(this._chartElementTag());f.allowFormatAsTable&&r.append(this._renderFormatAsTable());r.append(u.XLRibbon._renderCellStyles());r.append(t.buildTag("ul","","",{id:i+"_Ribbon_FPane"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Merge"}));b="<input id="+i+'_chart type="text" style="display:none;"/><input id='+i+'_tableid type="text" style="display:none;"/>';r.append(b);this._renderNameManagerDlg();f.allowCharts&&(v=t.buildTag("div.e-ss-numeric","",{width:"180",height:"80"},{id:i+"_Ribbon_chartsize"}),e=t.buildTag("table"),o=t.buildTag("tr"),c=t.buildTag("tr"),s=t.buildTag("td","",{width:"100%"}),h=t.buildTag("td"),l=t.buildTag("td"),a=t.buildTag("td"),s.append(t.buildTag("label.e-icon e-ssr-chartheight","",{width:"25",height:"25",display:"visible"},{id:i+"_Ribbon_chartheightlbl"})),h.append(t.buildTag("input","",{type:"text"},{id:i+"_Ribbon_chartheight"})),o.append(s).append(h),l.append(t.buildTag("label.e-icon e-ssr-chartwidth","",{width:"25",height:"25",display:"visible"},{id:i+"_Ribbon_chartwidthlbl"})),a.append(t.buildTag("input","",{type:"text"},{id:i+"_Ribbon_chartwidth"})),c.append(l).append(a),e.append(o).append(c),v.append(e),r.append(v));y=t.buildTag("div","",{width:"140",height:"80"},{id:i+"_Ribbon_pagesetup"});p=t.buildTag("div","",{width:"70",height:"80",float:"left"},{id:i+"_Ribbon_pagesetupleft"});e=t.buildTag("table");o=t.buildTag("tr");c=t.buildTag("tr");s=t.buildTag("td","",{padding:"6px 0px 6px 6px"});h=t.buildTag("td","",{padding:"6px 0px 6px 6px"});l=t.buildTag("td","",{padding:"6px 0px 6px 6px"});a=t.buildTag("td","",{padding:"6px 0px 6px 6px"});var k=t.buildTag("label.e-viewlinlbl","",{width:"40"},{id:i+"_Ribbon_pagesetup_viewgrdlnlbl","for":i+"_Ribbon_Vgridlines"}),d=t.buildTag("label.e-viewhdrlbl","",{width:"40",display:"visible"},{id:i+"_Ribbon_pagesetup_viewhdrlbl","for":i+"_Ribbon_Vheading"}),g=t.buildTag("input","","",{id:i+"_Ribbon_Vheading"}),nt=t.buildTag("input","","",{id:i+"_Ribbon_Vgridlines"});s.append(nt);h.append(k);o.append(s).append(h);l.append(g);a.append(d);c.append(l).append(a);e.append(c).append(o);p.append(e);y.append(p);r.append(y);n("#"+i+"_Ribbon_pagesetup_viewhdrlbl").text(u._getLocStr("Heading"));n("#"+i+"_Ribbon_pagesetup_viewgrdlnlbl").text(u._getLocStr("Gridlines"));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_PageSize"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Paste"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_FindRep"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Validation"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Border"}));r.append(t.buildTag("ul.e-spreadsheet","","",{id:i+"_CFormat"}));f.allowCellFormatting&&r.append(t.buildTag("input","","",{id:i+"_Ribbon_color",type:"text"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_Clear"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_SortFilter"}));r.append(t.buildTag("ul","",{width:"auto"},{id:i+"_Ribbon_Ins"}));r.append(t.buildTag("ul","",{width:"auto"},{id:i+"_Ribbon_Del"}));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_ResetPic"}));r.append(this._chartType("ColumnChart",6,2,2,["column","stackingcolumn","stackingcolumn100","column","stackingcolumn","stackingcolumn100"],["ClusteredColumn","StackedColumn","Stacked100Column","Cluster3DColumn","Stacked3DColumn","Stacked100Column3D"]));r.append(this._chartType("BarChart",6,2,2,["bar","stackingbar","stackingbar100","bar","stackingbar","stackingbar100"],["ClusteredBar","StackedBar","Stacked100Bar","Cluster3DBar","Stacked3DBar","Stacked100Bar3D"]));r.append(this._chartType("StockChart",2,2,2,["radar","radar"],["Radar","RadarMarkers"]));r.append(this._chartType("LineChart",2,2,3,["line","line"],["Line","LineMarkers"]));r.append(this._chartType("AreaChart",3,3,3,["Area","stackingarea","stackingarea100"],["Area","StackedArea","Stacked100Area"]));r.append(this._chartType("PieChart",3,3,4,["pie","pie","doughnut"],["Pie","Pie3D","Doughnut"]));r.append(this._chartType("ScatterChart",1,2,2,["scatter"],["Scatter"]));r.append(t.buildTag("ul","","",{id:i+"_Ribbon_AutoSum"}));this._renderAppTab();f.allowFormatAsTable&&this._renderDesignTab();this._renderFormatTab();this._homeTabObj();this._insertTabObj();this._dataTabObj();this._pageTabObj();this._reviewTabObj();this._otherTabObj();this._contextualTabObj();n("#"+i+"_Ribbon").ejRibbon({width:"100%",allowResizing:!0,applicationTab:this._appTabCollection,tabs:this._tabCollection,contextualTabs:this._contextualTabCollection,tabClick:n.proxy(this._onTabClick,this),tabSelect:n.proxy(this._onTabSelect,this),create:n.proxy(this._onControlCreated,this),toggleButtonClick:n.proxy(this._onToggleButtonClick,this),collapse:n.proxy(this._onCollapse,this),backstageItemClick:n.proxy(this._onBackStageItemClick,this)});n("#"+i+"_bordercolor ul li").find("a").remove();n("#"+i+"_bordercolor ul li").append(n("#"+i+"_Ribbon_BorderColor_popup"));n("#"+i+"picturecolor ul li").find("a").remove();n("#"+i+"picturecolor ul li").append(n("#"+i+"_Ribbon_PictureColor_popup"));n("#"+i+"_Ribbon_review_Comments_5").css("vertical-align","middle");f.scrollSettings.isResponsive&&n("#"+i+"_Ribbon").ejRibbon("option",{allowResizing:!0});this._hideTabs();f.allowComments||u._setAllowComments(!1);w=t.SplitButton.prototype._documentClick;t.SplitButton.prototype._documentClick=function(t){n(t.target).is(".e-formatastable")||w.call(this,t)};u.model.allowFormatAsTable&&(n("#"+u._id+"_formatastable").data("ejMenu").model.open=function(){n("#"+u._id+"_formatastable").scrollTop(0)});this._updateRibCustomCss()},_updateRibCustomCss:function(){var u=this.XLObj,r=u._id,i=u.element;i.find("#"+r+"_Ribbon_background-colorWrapper .e-in-wrap, #"+r+"_Ribbon_colorWrapper .e-in-wrap").addClass("e-ssr-colpickHprt");i.find(".e-ssr-colpickHprt .e-color-container,.e-ssr-colpickHprt .e-select").addClass("e-ssr-colorcontainer");i.find(".e-mergebtn, .e-borderbtn").parent().addClass("e-ssr-horizontalprt");i.find("#"+r+"_Ribbon_font-family").parents(".e-controlpadding").addClass("e-ssr-fontfamily");i.find("#"+r+"_Ribbon_fontsize").parents(".e-controlpadding").addClass("e-ssr-fontsize");i.find("#"+r+"_Ribbon_insbtn").parent().parent().prepend(t.buildTag("span.e-ssr-verticalHparent e-ssr-insertbtnHprt","",{display:"inherit"}));i.find("#"+r+"_Ribbon_insbtn").parent().appendTo(n("span.e-ssr-verticalHparent.e-ssr-insertbtnHprt"));i.find("#"+r+"_Ribbon_inssbtn").closest("div").appendTo(n("span.e-ssr-verticalHparent.e-ssr-insertbtnHprt"));i.find("#"+r+"_Ribbon_delbtn").parent().parent().prepend(t.buildTag("span.e-ssr-verticalHparent e-ssr-deletebtnHprt","",{display:"inherit"}));i.find("#"+r+"_Ribbon_delbtn").parent().appendTo(n("span.e-ssr-verticalHparent.e-ssr-deletebtnHprt"));i.find("#"+r+"_Ribbon_delsbtn").closest("div").appendTo(n("span.e-ssr-verticalHparent.e-ssr-deletebtnHprt"));i.find("#"+r+"_Ribbon_sizebtn").parent().parent().prepend(t.buildTag("span.e-ssr-verticalHparent e-ssr-sizebtnHprt","",{display:"inherit"}));i.find("#"+r+"_Ribbon_sizebtn").parent().appendTo(n("span.e-ssr-verticalHparent.e-ssr-sizebtnHprt"));i.find("#"+r+"_Ribbon_sizesbtn").closest("div").appendTo(n("span.e-ssr-verticalHparent.e-ssr-sizebtnHprt"));i.find("#"+r+"_Ribbon_validationbtn").parent().parent().prepend(t.buildTag("span.e-ssr-verticalHparent e-ssr-dtvaldtnHprt","",{display:"inherit"}));i.find("#"+r+"_Ribbon_validationbtn").parent().appendTo(n("span.e-ssr-verticalHparent.e-ssr-dtvaldtnHprt"));i.find("#"+r+"_Ribbon_validationsbtn").closest("div").appendTo(n("span.e-ssr-verticalHparent.e-ssr-dtvaldtnHprt"));i.find("#"+r+"_Ribbon_pastebtn").parent().parent().prepend(t.buildTag("span.e-ssr-verticalHparent e-ssr-pastebtnHprt","",{display:"inherit"}));i.find("#"+r+"_Ribbon_pastebtn").parent().appendTo(n("span.e-ssr-verticalHparent.e-ssr-pastebtnHprt"));i.find("#"+r+"_Ribbon_pastesbtn").closest("div").appendTo(n("span.e-ssr-verticalHparent.e-ssr-pastebtnHprt"));i.find("#ej"+r+"_Ribbon_Vheading").addClass("e-vheading");i.find("#ej"+r+"_Ribbon_Vgridlines").addClass("e-vgridlines")},_renderAppTab:function(){var i,n=this.XLObj,r=[];i="<div id='"+n._id+"_backstagetabnew' class='e-ssr-bstabnew'><div class='e-ssr-bscontent' title='"+n._getLocStr("BlankWorkbook")+"'><div class='e-ssr-bsnewtmpl' ><button id='"+n._id+"_bstab_new_blank' ><\/button><\/div><\/div><\/div>";i=i.concat("<div id='"+n._id+"_backstagetabsaveas' class='e-ssr-bstabsaveas'><div class='e-ssr-bscontent'><div class='e-ssr-bssaveasopt'><button id='"+n._id+"_bstab_saveas_excel'><\/button><span>"+n._getLocStr("SaveAsExcel")+"<\/span><\/div><div class='e-ssr-bssaveasopt'><button id='"+n._id+"_bstab_saveas_csv'><\/button><span>"+n._getLocStr("SaveAsCsv")+"<\/span><\/div><\/div><\/div>");i=i.concat("<div id='"+n._id+"_backstagetabprint' class='e-ssr-bstabprint'><div class='e-ssr-bscontent'><div class='e-ssr-bsprintopt'><button id='"+n._id+"_bstab_print_sheet'><\/button><span>"+n._getLocStr("PrintSheet")+"<\/span><\/div><div class='e-ssr-bsprintopt'><button id='"+n._id+"_bstab_print_selected'><\/button><span>"+n._getLocStr("PrintSelected")+"<\/span><\/div><\/div><\/div>");n.element.append(i);r.push({id:"new",text:n._getLocStr("New"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabnew"});r.push({id:"open",text:n._getLocStr("Open")+"...",itemType:t.Ribbon.itemType.button});r.push({id:"saveas",text:n._getLocStr("SaveAs"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabsaveas"});r.push({id:"print",text:n._getLocStr("Print"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabprint"});this._appTabCollection={type:t.Ribbon.applicationTabType.backstage,backstageSettings:{text:n._getLocStr("File"),headerWidth:124,height:n.model.scrollSettings.height,width:n.model.scrollSettings.width,pages:r}}},_onBackStageItemClick:function(t){var i=this.XLObj,r={element:t.target};(i.XLEdit._isEdit&&i.XLEdit.saveCell(),i._trigger("menuClick",r))||t.id==="open_backStageBtn"&&(i._isSheetsDirty()?i._showAlertDlg("confirm","ImportAlert","Open",470):n("#"+i._id+"_file .e-uploadinput").click())},_bSBtnClickHandler:function(){var r,u=this._id.split("_"),i=n("#"+u[0]).data("ejSpreadsheet"),e=u[2],f=u[3];n("#"+i._id+"_Ribbon").ejRibbon("hideBackstage");switch(e){case"new":switch(f){case"blank":i._isSheetsDirty()&&i._showAlertDlg("confirm","DestroyAlert","New",470)}break;case"saveas":i.XLExport["export"](f==="excel"?t.Spreadsheet.exportType.Excel:t.Spreadsheet.exportType.Csv);break;case"print":r=i.getActiveSheetIndex();switch(f){case"sheet":i.XLPrint.printSheet(r);break;case"selected":i.XLPrint.printSelection(r)}}},_renderFUpload:function(){var i=this.XLObj,r=i.getBrowserDetails();i.element.append(t.buildTag("div","","",{id:i._id+"_file",style:r.browser==="safari"?"visibility:hidden":"display:none"}));n("#"+i._id+"_file").ejUploadbox({dialogAction:{content:i.element},saveUrl:i.model.importSettings.importMapper,fileSelect:n.proxy(this._fileSelect),complete:n.proxy(this._changeImport),uploadName:"file",autoUpload:!0,showFileDetails:!1,error:n.proxy(i._importFailed,i)});n("#"+i._id+"_file_SelectButton").hide()},_contextualTabObj:function(){var r=this.XLObj,n=r._id,u="imagetop",i;r.model.allowFormatAsTable&&(i={backgroundColor:"#FCFBEB",borderColor:"#F2CC1C",tabs:[{id:"design",text:r._getLocStr("Design"),groups:[{text:"Properties",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_tableproperties"},{text:"Tools",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("resizetable","ResizeTable","textandimage","e-icon e-ssr-resizetable",101,this._smallBtnHeight,"ResizeTable","ResizeTableContent"),this._generateBtn("convertorange","ConvertToRange","textandimage","e-icon e-ssr-range",130,this._smallBtnHeight,"ConvertToRange","ConvertToRangeContent")]}]},{text:"Table Style Options",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_tablestyleoptions"}]}]},this._contextualTabCollection.push(i));r.model.allowCharts&&(i={backgroundColor:"#EAF6BD",borderColor:"#90AA3C",tabs:[{id:"cdesign",text:"Chart Design",groups:[{text:"Chart Layouts",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("cElement","AddChartElement","textandimage",n+"_Ribbon_CElement","","e-icon e-ssr-celements",!0,65,this._bigBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-chartlayoutbtn","AddChartElement","AddChartElementContent")]}]},{text:"Data",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("srcolumn","SwitchRowColumn","textandimage","e-icon e-ssr-srcolumn",72,this._bigBtnHeight,"SwitchRowColumn","SwitchRowColumnContent","","imagetop"),this._generateBtn("selectData","SelectData","textandimage","e-icon e-ssr-selectdata",50,this._bigBtnHeight,"SelectData","SelectDataContent",!1,u)]}]},{text:"Type",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("charttype","ChartType","textandimage","e-icon e-ssr-charttype",65,this._bigBtnHeight,"ChartType","ChartTypeContent",!1,u)]}]},{text:"Chart Themes",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateDD("chartTheme","ChartThemes",this._chartThemes,"1",130,this._smallBtnHeight,"ChartThemes","ChartThemesContent")]}]},{text:"Size",alignType:t.Ribbon.alignType.columns,content:[{groups:[{contentID:n+"_Ribbon_chartsize",enableSeparator:!0,type:t.Ribbon.type.custom,height:80}]}]}]}]},this._contextualTabCollection.push(i));r.model.pictureSettings.allowPictures&&(i={backgroundColor:"#FCFBEB",borderColor:"#F2CC1C",tabs:[{id:"format",text:"Format",groups:[{text:"Adjust",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("changepic","ChangePicture","textandimage","e-icon e-ssr-changepicture",120,this._mediumBtnHeight,"ChangePicture","ChangePictureContent"),this._generateSplitBtn("resetpic","ResetPicture","textandimage",n+"_Ribbon_ResetPic",{dataSource:this._resetPicture,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-resetpicture",!1,120,this._mediumBtnHeight,"left","","dropdown","e-ss-resetpictbtn","ResetPicture","ResetPictureContent")]}]},{text:"Border",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("pictureborder","PictureBorder","textandimage",n+"_Ribbon_PictureBorder","","e-icon e-ssr-pictureborder",!1,120,this._mediumBtnHeight,"left","","dropdown","e-ss-pictbrdrbtn","PictureBorder","PictureBorderContent")]}]},{text:"Size",alignType:t.Ribbon.alignType.columns,type:"custom",contentID:n+"_picturesize"}]}]},this._contextualTabCollection.push(i))},_onToggleButtonClick:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);this._ribbonState=!(t.action==="collapse");t.action==="expand"&&(t.action="tabClick",this._heightWidthCalculation(i.getActiveSheetIndex(),r,t))},_heightWidthCalculation:function(t,i,r){var f,u=this.XLObj,e=u.getActivationPanel(),o=e.is(":visible");i.width.toString().indexOf("%")!==-1&&(i.width=u.getMainPanel().width());u._isDisplayHeader?(f=n("#"+u._id+"_Ribbon").height(),u._isDisplayHeader=!1):f=this._ribbonState?u.element.find(".e-ribbon .e-header").height()+109:u.element.find(".e-ribbon .e-header").height();u._setSheetWidthHeight(t,{width:o?i.width-u.model.apWidth:i.width,height:i.height},f,"resize",r.action);o&&e.height(u.getMainPanel().height())},_hideTabs:function(){for(var r=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("instance"),i=["",this.XLObj._getLocStr("Design"),"Chart Design","Format"],t=i.length;t=t-1;)r.hideTab(i[t])},_renderDesignTab:function(){var n=this.XLObj,t="",i=n._getLocStr("TableStyleOptions").split("/");t="<div id="+n._id+'_tableproperties ><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell">Table Name:<\/div><\/div><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell"><input type="text" id='+n._id+'_tablename class="ejinputtext" style="width:86px;opacity:0.7;height: 18px;text-indent: 3px;" disabled="disabled" /><\/div><\/div><\/div>';t=t+"<div id="+n._id+'_tablestyleoptions ><div class="e-tablestyleoptionsrow" ><div class="e-tablestyleoptionscell"><input id='+n._id+'_Ribbon_tsofirstcolumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsofirstcolumn">'+i[0]+'<\/label><\/div><div class="e-tablestyleoptionscell" ><input id='+n._id+'_Ribbon_tsolastcolumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsolastcolumn">'+i[1]+'<\/label><\/div><\/div><div class="e-tablestyleoptionsrow" ><div class="e-tablestyleoptionscell"><input id='+n._id+'_Ribbon_tsototalrow type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsototalrow">'+i[2]+'<\/label><\/div><div class="e-tablestyleoptionscell" ><input id='+n._id+'_Ribbon_tsofiltercolumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+n._id+'_Ribbon_tsofiltercolumn">'+i[3]+"<\/label><\/div><\/div><\/div>";n.element.append(t)},_renderFormatTab:function(){var n=this.XLObj;n.element.append("<div id="+n._id+"_picturesize class= e-ss-numeric><table><tr><td style='padding-right:4px;'>"+n._getLocStr("Height")+": <\/label><\/td><td style='padding-bottom:3px;'><input id='"+n._id+"_pictureheight' type='text' /><\/td><\/tr><tr><td><labe>"+n._getLocStr("Width")+": <\/label><\/td><td><input id='"+n._id+"_picturewidth' type='text' /><\/td><\/tr><\/table><\/div>")},_renderNameManagerDlg:function(){var i=this.XLObj,r="<div id = '"+i._id+"_nmdlg' ><div class='e-dlgctndiv' ><div class='e-dlg-fields'><div id='"+i._id+"_nmgrid' ><\/div><\/div><div class='e-dlg-fields'><label class='e-dlg-fields'>"+i._getLocStr("Refersto")+":<\/label><input type='text' class='e-nmrange ejinputtext' id='"+i._id+"_nmrange' disabled='true' /><\/div><div class='e-dlg-btnfields' ><div class='e-dlg-btnctnr'><button id='"+i._id+"_nmclose' >"+i._getLocStr("Close")+"<\/button><\/div><\/div><\/div><\/div>";r=r+"<div id='"+i._id+"_nmeditortemplate' class='e-hide' ><div class='e-dlg-fields e-dlgctndiv'><table cellpadding='0' cellspacing='0'><tr><td>"+i._getLocStr("Name")+":<\/td><td><input id='name' type='text' class='ejinputtext' value='{{: name}}'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+i._getLocStr("Scope")+":<\/td><td><input class='e-nmscope ejinputtext' id='scope' type='text' readonly value='Workbook'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+i._getLocStr("Comment")+":<\/td><td><textarea id='comment' style='resize:none;height:44px;width:100%;' value='{{: comment}}'>{{: comment}}<\/textarea><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+i._getLocStr("Refersto")+":<\/td><td><input type='text' class='ejinputtext' id='refersto' value='{{: refersto}}' /><\/td><\/tr><\/table><\/div><\/div>";r=r+"<div id='"+i._id+"_nmuseinformula' class='e-nmuseinformula' style='width:125px'><\/div>";i.element.append(r);n("#"+i._id+"_nmclose").ejButton({showRoundedCorner:!0,width:68,click:n.proxy(this._nmdlgClose,i)});n("#"+i._id+"_nmgrid").ejGrid({dataSource:i.model.nameManager.slice(0),height:162,width:505,allowScrolling:!0,allowSorting:!0,enableAltRow:!1,cssClass:"e-ss-dialog ej-ssgrid",selectionType:t.Grid.SelectionType.Single,editSettings:{allowAdding:!0,editMode:t.Grid.EditMode.DialogTemplate,dialogEditorTemplateID:"#"+i._id+"_nmeditortemplate"},toolbarSettings:{showToolbar:!0,toolbarItems:[t.Grid.ToolBarItems.Add]},actionBegin:n.proxy(this._nmActionBegin,i),actionComplete:n.proxy(this._nmActionComplete,i),rowSelected:n.proxy(this._nmRecordSelected,i),columns:[{field:"name",headerText:i._getLocStr("Name"),isPrimaryKey:!0,width:120},{field:"refersto",headerText:i._getLocStr("RefersTo"),width:120},{field:"scope",headerText:i._getLocStr("Scope"),width:80},{field:"comment",headerText:i._getLocStr("Comment"),width:160}]});n("#"+i._id+"_nmdlg").ejDialog({showOnInit:!1,title:i._getLocStr("NameManager"),enableModal:!0,enableResize:!1,width:"537px",cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this),beforeClose:t.proxy(this._beforeDlgClose,this)})},_updateNMRange:function(){var t=this.XLObj;n("#"+t._id+"_nmgridEditForm").find("#refersto").val("="+t._getDollarAlphaRange(t.getSheet(t.getActiveSheetIndex()).selectedRange,!0))},_nmdlgClose:function(){n("#"+this._id+"_nmdlg").ejDialog("close")},_nmRecordSelected:function(t){n("#"+this._id+"_nmdlg").find(".e-nmrange").val(t.data.refersto)},_nmActionBegin:function(n){var t=0,u=!1,f,e,r,i=this.getSheet(this.getActiveSheetIndex());if(n.requestType==="save"){if(r=n.data,r.sheetIndex=this._getSheetIdxFromName(n.data.refersto.split("!")[0].replace("=","")),n.cancel=!0,r.sheetIndex===-1){this._showAlertDlg("Alert","InvalidSheetIndex",null,275);return}if(i._nmEdit)for(e in i._nmValue){for(f=this.model.nameManager.length;t<f;){if(this.model.nameManager[t].name===i._nmValue.name){this.model.nameManager.splice(t,1);this._sheets[this.getActiveSheetIndex()]._calcEngine.removeNamedRange(i._nmValue.name);break}t++}for(t=this._formulaCollection.length;t--;)if(this._formulaCollection[t].display===i._nmValue.name){u=!0;this._formulaCollection.splice(t,1);break}if(u)break}this.XLRibbon._validateNamedRange(r.name,r.refersto)?n.cancel=!1:u&&this.model.nameManager.push(i._nmValue)}n.requestType==="beginedit"&&(i._nmEdit=!0,i._nmValue={name:n.model.dataSource[n.model.selectedRowIndex].name,refersto:n.model.dataSource[n.model.selectedRowIndex].refersto,comment:n.model.dataSource[n.model.selectedRowIndex].comment,sheetIndex:n.model.dataSource[n.model.selectedRowIndex].sheetIndex,scope:n.model.dataSource[n.model.selectedRowIndex].scope})},_nmActionComplete:function(t){var r=n("#"+this._id+"_nmgrid").data("ejGrid"),f=t.requestType,i,u;switch(f){case"add":i=n("#"+this._id+"_nmgrid_dialogEdit").data("ejDialog");i.model.open=n.proxy(this.XLRibbon._updateNMRange(),this);i.option("allowDraggable",!1);i.option("title",this._getLocStr("NewName"));u=n("#"+this._id+"_nmgridEditForm").find("input[type='button']:first");u.data("ejButton").option("text","OK");u.parent().addClass("e-dlg-btnfields").css("text-align","right");break;case"save":this.XLRibbon._addNamedRange(r,t.data.name,t.data.refersto);break;case"delete":this.XLRibbon._removeNamedRange(r,t.data.name);break;case"cancel":r.element.focus()}},_updateNamedRanges:function(t,i){var r=this.XLObj;r._sheets[r.getActiveSheetIndex()]._calcEngine.addNamedRange(t,i.replace("=",""));r._formulaCollection.push({text:"="+t,display:t});n("#"+r._id+"_inputbox").data("ejAutocomplete").option("dataSource",r._formulaCollection)},_updateUseInFormulaTrgt:function(){for(var i=0,t=this.XLObj,r="",e=n("#"+t._id+"_nmuseinformula"),u=t.model.nameManager,f=u.length;i<f;)r=r+"<div class='e-nmuseinformularow' style = 'color:#333333'>"+u[i].name+"<\/div>",i++;f?n("#"+t._id+"_Ribbon_useinformula").ejSplitButton("enable"):n("#"+t._id+"_Ribbon_useinformula").ejSplitButton("disable");e.html("<div>"+r+"<\/div>")},addNamedRange:function(t,i,r,u){var f=n("#"+this.XLObj._id+"_nmgrid").data("ejGrid");this._validateNamedRange(t,i)&&(f.addRecord({name:t,refersto:i,comment:r?r:"",scope:"WorkBook",sheetIndex:u}),f.refreshContent())},_addNamedRange:function(n,t,i){var r=this.XLObj;r.model.nameManager=n.model.dataSource.slice(0);this._updateNamedRanges(t,i);this._updateUseInFormulaTrgt()},removeNamedRange:function(t){if(t){var i=n("#"+this.XLObj._id+"_nmgrid").data("ejGrid");i.deleteRecord("name",{name:t})}},_removeNamedRange:function(n,t){var r,u,i=this.XLObj,f=i.model.nameManager[i.model.nameManager.length-1];if(i.model.nameManager=n.model.dataSource.slice(0),u=i.model.nameManager,i._sheets[i.getActiveSheetIndex()]._calcEngine.removeNamedRange(t),i._updateFormulaCollection(),r=u.length,r)while(r--)i._formulaCollection.push({text:"="+u[r].name,display:u[r].name});this._updateUseInFormulaTrgt()},_validateNamedRange:function(t,i){var u,f,e,s,o,r=this.XLObj;if(u=this._validateDollarRange(i),f=/^[a-zA-Z_]+$/.test(t)&&this._validateLibraryFunctions(t),e=this._validateNameManager(t),u&&f&&e)return!0;s=n("#"+r._id+"_alertdlg");o=u?f?r._getLocStr("NMUniqueNameAlert"):r._getLocStr("NMNameAlert").split("/")[0]:r._getLocStr("NMRangeAlert");r._showAlertDlg("Alert","T-"+o,null,370)},_validateLibraryFunctions:function(n){var i,r=[],u=(new CalcEngine).getLibraryFunctions();n=t.isNullOrUndefined(n)?"":n.toString().toUpperCase();for(i in u.items)r.push(i);for(i=r.length;i--;)if(r[i]===n)return!1;return!0},_validateNameManager:function(n){var i=0,r=this.XLObj.model.nameManager,u=r.length;for(n=t.isNullOrUndefined(n)?"":n.toString().toUpperCase();i<u;){if(r[i].name.toUpperCase()===n)return!1;i++}return!0},_validateDollarRange:function(n){try{if(n&&n.indexOf("!")>-1)return n=n.split("!")[1].replace(/\$/g,""),this.XLObj.getRangeIndices(n),!0}catch(t){return!1}},_renderFormatAsTable:function(){for(var p,a,l=this.XLObj,u=0,at=[11,19],w=0,c="",b="",r="w:bold",f="c:#FFFFFF",i="c:#000000",k="c:#2F75B5",d="c:#ED7D31",g="c:#FFC000",e="1px solid #000000",o="1px solid #2f75b5",s="1px solid #ED7D31",h="1px solid #FFC000",nt="b:#D9D9D9",v="b:#DDEBF7",tt="b:#FCE4D6",it="b:#FFF2CC",et="b:#000000",ot="b:#FFE2C6",st="b:#FFF1BF",y="b:#000000",ht="b:#D7D7D7",rt="b:#FFC000",ut="b:#5B9BD5",ct="b:#Ed7D31",ft="hl?"+r+";"+i+";bo:tb-"+e+"&cl?"+nt+";"+i+","+i+"&cb?b-"+e+"/hl?"+r+";bo:tb-"+o+";"+k+"&cl?"+v+";"+k+","+k+"&cb?b-"+o+"/hl?"+r+";bo:tb-"+s+";"+d+"&cl?"+tt+";"+d+","+d+"&cb?b-"+s+"/hl?"+r+";bo:tb-"+h+";"+g+"&cl?"+it+";"+g+","+g+"&cb?b-"+h+"/hl?"+r+";"+et+";"+f+";bo:o-"+e+"&cl?bo:t-"+e+";"+i+"&cb?o-"+e+"/hl?bo:o-"+o+";"+r+";"+ut+";"+f+"&cl?bo:t-"+o+";"+i+"&cb?o-"+o+"/hl?"+r+";b:#EB7E2F;"+f+";bo:o-"+s+"&cl?bo:t-"+s+";"+i+"&cb?o-"+s+"/hl?"+r+";"+rt+";"+f+";bo:o-"+h+"&cl?bo:t-"+h+";"+i+"&cb?o-"+h+"/hl?"+r+";bo:gb-"+e+";"+i+"&cl?"+nt+";"+i+","+i+"&cb?gb-"+e+"/hl?"+r+";bo:gb-"+o+";"+i+"&cl?"+v+";"+i+","+i+"&cb?gb-"+o+"/hl?"+r+";bo:gb-"+s+";"+i+"&cl?"+tt+";"+i+","+i+"&cb?gb-"+s+"/hl?"+r+";bo:gb-"+h+";"+i+"&cl?"+it+";"+i+","+i+"&cb?gb-"+h+"/hl?"+r+";"+et+";"+f+"&cl?b:#A6A6A6;"+i+","+nt+";"+i+"/hl?"+r+";"+ut+";"+f+"&cl?b:#BDD7EE;"+i+","+v+";"+i+"/hl?"+r+";"+ct+";"+f+"&cl?b:#F8CBAD;"+i+","+tt+";"+i+"/hl?"+r+";"+rt+";"+f+"&cl?b:#FFE699;"+i+","+it+";"+i+"/hl?"+r+";"+ht+";"+i+";bo:gb-"+e+"&cl?b:#A7A7A7;"+i+","+ht+";"+i+"&cb?gb-"+e+"/hl?"+r+";b:#DBECF6;"+i+";bo:gb-"+o+"&cl?b:#BED8F1;"+i+","+v+";"+i+"&cb?gb-"+o+"/hl?"+r+";"+ot+";"+i+";bo:gb-"+s+"&cl?b:#F6CAAD;"+i+","+ot+";"+i+"&cb?gb-"+s+"/hl?"+r+";"+st+";"+i+";bo:gb-"+h+"&cl?b:#FDE18D;"+i+","+st+";"+i+"&cb?gb-"+h+"/hl?"+r+";"+y+";"+f+"&cl?b:#404040;"+f+",b:#737373;"+f+"/hl?"+r+";"+y+";"+f+"&cl?b:#2F75B5;"+f+","+ut+";"+f+"/hl?"+r+";"+y+";"+f+"&cl?b:#C65911;"+f+","+ct+";"+f+"/hl?"+r+";"+y+";"+f+"&cl?b:#BF8F00;"+f+","+rt+";"+f,lt=l._getLocStr("FATHeaderText").split("/"),vt=l._getLocStr("FormatAsTableTitle").split("/"),yt=["Light1","Light2","Light3","Light5","Light8","Light9","Light10","Light12","Light15","Light16","Light17","Light19","Medium8","Medium9","Medium10","Medium12","Medium22","Medium23","Medium24","Medium26","Dark1","Dark2","Dark3","Dark5"],ft=ft.split("/");u<24;)c=c+l._renderDIV("e-formatastablecell",'<div class="e-ss-cellstyles-'+(u+1)+'" />'),u===at[w]&&(w=w+1,c=c+"<\/br>"),u=u+1;for(u=0,c=c.split("<\/br>");u<lt.length*2;)b=b+l._renderDIV(u%2==0?"e-formatastableheader":"e-formatastablecontent",u%2==0?lt[u/2]:c[0]),u%2!=0&&c.shift(),u=u+1;for(p=n("<div id="+l._id+'_formatastable class="e-spreadsheet e-formatastable" style="display:none;" >'+b+"<\/div>"),a=p.find(".e-formatastablecell"),u=0;u<a.length;)n(a[u]).data({format:this._getFormatAsTableInput(ft[u]),formatName:"TableStyle"+yt[u]}).attr("title","Table Style "+vt[u]),u=u+1;return t.isNullOrUndefined(l.XLFormat)||(l.XLFormat._formatAsTableStyle=n(a[0]).data()),this._renderFATNameDlg(),this._renderChartNameDlg(),this._renderFATResizeTableDlg(),p},_renderFATNameDlg:function(){var r,i=this.XLObj,u=i._getLocStr("FATNameDlgText").split("/"),f={showRoundedCorner:!0,width:"27%",click:n.proxy(this._fatNameDlgBtnClick,this)};r="<div id="+i._id+'_fatnamedlg><div class="e-dlg-fields e-dlgctndiv"><table cellspacing="0" cellpadding="0"><tr><td>'+u[0]+'<\/td><td><input id="'+i._id+'_fatname" class="ejinputtext" /><\/td><\/tr><tr class="e-dlgtd-fields"><td><\/td><td><input type="checkbox" id="'+i._id+'_fatheader" style="background-color:#ffffff"/> <label for="'+i._id+'_fatheader" style="margin-left: 4px;">'+u[1]+'<\/label><\/td><\/tr><\/table><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_fatnamedlgok>"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_fatnamedlgcancel>"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(r);n("#"+i._id+"_fatheader").ejCheckBox();n("#"+i._id+"_fatnamedlgok").ejButton(f);n("#"+i._id+"_fatnamedlgcancel").ejButton(f);n("#"+i._id+"_fatnamedlg").ejDialog({showOnInit:!1,width:"286px",showRoundedCorner:!0,title:i._getLocStr("FormatAsTable"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_renderChartNameDlg:function(){var r,i=this.XLObj,f=i._getLocStr("ChartTitleDlgText"),u={showRoundedCorner:!0,width:"23%",click:n.proxy(this._chartNameDlgBtnClick,this)};r="<div id="+i._id+'_chartnamedlg ><div class="e-dlg-fields e-dlgctndiv"><table cellpadding="0" cellspacing="0"><tr><td>'+f+'<\/td><td><input id="'+i._id+'_chartname" class="ejinputtext" /><\/td><\/tr><\/table><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_chartnamedlgok >"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_chartnamedlgcancel>"+i._getLocStr("Cancel")+"<\/button><\/div><\/div>";i.element.append(r);n("#"+i._id+"_chartnamedlgok").ejButton(u);n("#"+i._id+"_chartnamedlgcancel").ejButton(u);n("#"+i._id+"_chartnamedlg").ejDialog({showOnInit:!1,width:"334px",minHeight:"auto",showRoundedCorner:!0,title:i._getLocStr("ChartTitle"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_renderFATResizeTableDlg:function(){var i=this.XLObj,r={showRoundedCorner:!0,width:"15%",click:n.proxy(this._fatResizeTableBtnClick,this)},u="<div id="+i._id+'_fatresizetabledlg ><div class="e-dlgctndiv"><table><tr><td>'+i._getLocStr("FATResizeTableText")+'<\/td><td style="width: 50%;"><input id="'+i._id+'_fatresizetablerange" class="ejinputtext" style="margin-left: 2px;"><\/td><\/tr><\/table><div class="e-dlg-fields">'+i._getLocStr("FATReizeTableNote")+'<\/div><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_fatresizetabledlgok >"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_fatresizetabledlgcancel >"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(u);n("#"+i._id+"_fatresizetabledlgok").ejButton(r);n("#"+i._id+"_fatresizetabledlgcancel").ejButton(r);n("#"+i._id+"_fatresizetabledlg").ejDialog({showOnInit:!1,width:"494px",showRoundedCorner:!0,title:i._getLocStr("ResizeTable"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog",close:t.proxy(this._dialogClose,this)})},_fatResizeTableBtnClick:function(t){var i=this.XLObj,o,u=document.getElementById(i._id+"_fatresizetablerange").value,s=i.getActiveSheetIndex(),f,r=document.getElementById(i._id+"_tableid").value,e=i.getSheet(s)._tableManager;f={sheetIndex:s,reqType:"format-table",action:"resizetable",beforeRange:e[r].range,tableId:r};canclose=!0;t.model.text===i._getLocStr("Ok")&&(i._isvalidRange(u)?(u=u.indexOf(":")!=-1?i.getRangeIndices(u):[],o=this._validateResizeRange(u,e[r].range),o?i._showAlertDlg("Alert",o,"",500):(e[r].range=u,i.XLFormat._createTable(r,{format:e[r].format}),i.XLFilter._extendFilterRange(r,u),f.afterRange=u,f.format=e[r].format,f.formatName=e[r].formatName,f.header=n.extend(!0,{},i.model.sheets[s]._header),i._completeAction(f))):(canclose=!1,i._showAlertDlg("Alert","InvalidReference","",375)));canclose&&n("#"+i._id+"_fatresizetabledlg").ejDialog("close")},_fatNameDlgBtnClick:function(t){var r,i=this.XLObj,u=i._id;n("#"+u+"_fatnamedlg").ejDialog("close");t.model.text===i._getLocStr("Ok")&&(r={header:n("#"+u+"_fatheader").ejCheckBox("checked"),name:document.getElementById(u+"_fatname").value,format:i.XLFormat._formatAsTableStyle.format},i.XLFormat._formatAsTableStyle.formatName&&(r.formatName=i.XLFormat._formatAsTableStyle.formatName),i.XLFormat.createTable(r))},_validateResizeRange:function(n,t){var i=this.XLObj;if(n.length){if(n[0]!=t[0]||n[1]!=t[1])return"ResizeAlert";if(n[3]!=t[3]||n[2]<t[2])return"ResizeRestrictAlert";if(n[2]>i.getSheet(i.getActiveSheetIndex()).rowCount)return"RangeNotCreated"}else return"InvalidReference"},_chartNameDlgBtnClick:function(t){var f,r,i=this.XLObj,s=i.getActiveSheetIndex(),o=i.getSheet(s)._shapeMngr.chart[i.XLEdit.getPropertyValue(i.XLShape._picCellIdx.rowIndex,i.XLShape._picCellIdx.colIndex,"chart")[0]],u,e=i._id,h=document.getElementById(e+"_chart").value;if(f=n("#"+h).data("ejChart"),r={sheetIndex:s,reqType:"shape",shapeType:"chart",cid:h,rowIndex:i.XLShape._picCellIdx.rowIndex,colIndex:i.XLShape._picCellIdx.colIndex,prev:{},cur:{}},u=document.getElementById(e+"_chartname").value,t.model.text===i._getLocStr("Ok")){if(!u.length){i._showAlertDlg("Alert","InvalidTitle","InvalidChartTitleActn",375);return}switch(i._hasTitle){case"PX":f.option("primaryXAxis",{title:{text:u}});o.xAxis.title.text=u;r.action="PX";break;case"PY":f.option("primaryYAxis",{title:{text:u}});o.yAxis.title.text=u;r.action="PY";break;case"CT":f.option("title",{text:u});o.title.text=u;r.action="CT"}}r.prev.text=i._cOpt.prevText;i._hasTitle=="CT"&&(r.prev.align=i._cOpt.prevAlign,r.cur.align=i._cOpt.curAlign);r.cur.text=u;i._completeAction(r);i._cOpt={};document.getElementById(e+"_chartname").value="";n("#"+e+"_chartnamedlg").ejDialog("close")},_designTabUpdate:function(t,i){var r=this.XLObj;if(r.model.showRibbon){var f=r._id,o,e=n("#"+r._id+"_Ribbon").ejRibbon("instance"),u=r.getSheet(r.getActiveSheetIndex())._tableManager;e.showTab(r._getLocStr("Design"));this._isDesignTab&&!e._isCollapsed&&e.option({selectedItemIndex:this._getTabIndex("design")});document.getElementById(r._id+"_tablename").value=u[t].name;document.getElementById(r._id+"_tableid").value=t;this._isSetModel=!0;n("#"+f+"_Ribbon_tsototalrow").data("ejCheckBox").option({checked:u[t].totalRow?!0:!1});n("#"+f+"_Ribbon_tsofirstcolumn").data("ejCheckBox").option({checked:u[t].firstColumn?!0:!1});n("#"+f+"_Ribbon_tsolastcolumn").data("ejCheckBox").option({checked:u[t].lastColumn?!0:!1});n("#"+f+"_Ribbon_tsofiltercolumn").data("ejCheckBox").option({checked:u[t].isFilter?!0:!1});this._isSetModel=!1;o=n("#"+r._id+"_Ribbon_clearfilter").data("ejButton");this._changeClrFltrStatus(o,"button",i)}},_formatTabUpdate:function(){var t=this.XLObj,i;t.model.showRibbon&&(i=n("#"+t._id+"_Ribbon").ejRibbon("instance"),i.showTab("Format"),t._shapeChange=!0,t.element.find("#"+t._id+"_pictureheight").ejNumericTextbox("option","value",t.element.find(".e-ss-activeimg").height()),t.element.find("#"+t._id+"_picturewidth").ejNumericTextbox("option","value",t.element.find(".e-ss-activeimg").width()),t.model.showRibbon&&!i._isCollapsed&&i.option({selectedItemIndex:t.XLRibbon._getTabIndex("format")}),t._shapeChange=!1)},_chartDesignTabUpdate:function(t){var i=this.XLObj;if(i.model.showRibbon){var r=n("#"+i._id+"_Ribbon").data("ejRibbon"),u=t.get(0).id,f=t.get(0).offsetLeft,e=t.get(0).offsetTop;i.XLShape._picCellIdx=i.XLShape._getCellIndexFromOffset(e,f);r.showTab("Chart Design");r._isCollapsed||r.option({selectedItemIndex:i.XLRibbon._getTabIndex("cdesign")});document.getElementById(i._id+"_chart").value=u;this._isSetModel=!0;this._setChartWidthHeight({height:t.height(),width:t.width()});r.element.find("#"+i._id+"_Ribbon_chartTheme").ejDropDownList("setSelectedValue",t.ejChart("option","theme"));this._isSetModel=!1}},_setChartWidthHeight:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_chartwidth").data("ejNumericTextbox"),u=n("#"+i._id+"_Ribbon_chartheight").data("ejNumericTextbox");i._shapeChange=!0;u.option({value:t.height});r.option({value:t.width});i._shapeChange=!1},_toggleDesignTab:function(i){var r=this.XLObj,f,u;r.model.showRibbon&&(u=n("#"+r._id+"_Ribbon").data("ejRibbon"),(t.isNullOrUndefined(i)||!t.isNullOrUndefined(i)&&i.className.indexOf("e-ft")<0)&&(u.hideTab(r._getLocStr("Design")),u._isCollapsed||u.option({selectedItemIndex:1})));f=n("#"+r._id+"_Ribbon_clearfilter").data("ejButton");t.isNullOrUndefined(i)&&(i=r.getCell(r.getActiveCell().rowIndex,r.getActiveCell().colIndex)[0]);this._changeClrFltrStatus(f,"button",i)},_toggleChartDesignTab:function(){var i=this.XLObj,t;i.model.showRibbon&&(t=n("#"+i._id+"_Ribbon").data("ejRibbon"),t.hideTab("Chart Design"),t._isCollapsed||t.option({selectedItemIndex:1}))},_toggleFormatTab:function(){var i=this.XLObj,t;i.model.showRibbon&&(t=n("#"+i._id+"_Ribbon").data("ejRibbon"),t.hideTab("Format"),t._isCollapsed||t.option({selectedItemIndex:1}))},_getTabIndex:function(t){if(this.XLObj.model.showRibbon){for(var u=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("model"),r=u.tabs,f=u.contextualTabs,i=0;i<f.length;)r=r.concat(f[i].tabs),i++;for(i=r.length;i--;)if(r[i].id===t)return++i}},_getFormatAsTableInput:function(n){var h=this.XLObj,t,u,o,i,f=0,r=0,c=[],s={hl:"headerLayout",cl:"contentLayout",hb:"headerBorder",cb:"contentBorder"},e={};for(n=n.split("&");f<n.length;){if(o=n[f].split("?"),t=o[0],u=o[1],t==="hl")e[s[t]]=h._getStyleAsJSON(u,!0);else if(t==="cl"){for(i=u.split(",");r<i.length;)c.push(i[r].length?h._getStyleAsJSON(i[r],!0):{}),r=r+1;e[s[t]]=c}else t==="cb"&&(i=u.split("-"),e[s[t]]={border:this._getBorderObj(i[0],i[1])});f=f+1}return e},_getBorderObj:function(n,t){var r,i={t:{top:""},r:{right:""},b:{bottom:""},l:{left:""},o:{top:"",right:"",bottom:"",left:""},tb:{top:"",bottom:""}};if(n==="gb")return t;for(r in i[n])i[n][r]=t;return i[n]},_renderCellStyles:function(){for(var r,t=0,e=[],i="",o=[4,2,12],u=this.XLObj,f=u._dataContainer.hashCode,s=u._getLocStr("CellStyleHeaderText").split("/"),c=u._getLocStr("CellStyleGBN").split("/"),l=[f[0],f[1],f[2],f[3]],a=u._getLocStr("CellStyleTH").split("/"),h=f.slice(4,6),v=u._getLocStr("CellsStyleTCS").split("/"),y=f.slice(6,18);t<o[0];)r=c[t],i=i+u._renderDIV("e-cellstylecell "+l[t],r,r),t=t+1;for(e.push(i),i="",t=0;t<o[1];)r=a[t],i=t===1?i+'<div class="e-cellstylecell '+h[t]+'"  style="font-size: 11pt;" title='+r+">"+r+"<\/div>":i+u._renderDIV("e-cellstylecell "+h[t],r,r),t=t+1;for(e.push(i),i="",t=0;t<o[2];)r=v[t],i=i+u._renderDIV("e-cellstylecell "+y[t],r,r),t=t+1;for(e.push(i),i="",t=0;t<s.length*2;)i=i+u._renderDIV(t%2==0?"e-cellstyleheader":"e-cellstylecontent",t%2==0?s[t/2]:e[0]),t%2!=0&&e.shift(),t++;return n("<div id="+u._id+'_cellstyles class="e-spreadsheet e-cellstyles">'+i+"<\/div>")},_onTabClick:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);t.prevActiveIndex!==-1&&i.model.allowComments&&i.model.allowEditing&&(i.XLEdit._isEdit||i.XLComment._isCommentEdit||i._isSheetRename)&&this._enableRibbonIcons();i._trigger("tabClick",t)},_onCollapse:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);this._ribbonState=!1;t.action="toggleBtn";this._heightWidthCalculation(i.getActiveSheetIndex(),r,t)},_onTabSelect:function(n){var t=this.XLObj,i=t.getActiveCellElem(t.getActiveSheetIndex());(t.XLEdit._isEdit||t.model.allowComments&&t.XLComment._isCommentEdit||t._isSheetRename)&&this._disableRibbonIcons();this._updateRibbonIcons();i.length&&i[0].className.indexOf("e-table")!=-1&&(this._isDesignTab=n.activeIndex==this._getTabIndex("design"));t._trigger("tabSelect",n)},_valDTypeOnChange:function(t){var i=this.XLObj;n("#"+i._id+"_Form_ValDialog").validate().resetForm();t.value==="Between"||t.value==="NotBetween"?(n("#"+i._id+"_Ribbon_lbMax").show(),n("#"+i._id+"_Ribbon_btnMax").show(),n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr("NumberStart"))):(n("#"+i._id+"_Ribbon_lbMax").hide(),n("#"+i._id+"_Ribbon_btnMax").hide(),n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr("DataValue")));this._dialogValidate("_ValDialog")},_valTypeOnChange:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList");r.enable();t.value==="List"?(n("#"+i._id+"_Ribbon_lbMax").hide(),n("#"+i._id+"_Ribbon_btnMax").hide(),r.disable()):(r._selectedValue==="Between"||r._selectedValue==="NotBetween")&&(n("#"+i._id+"_Ribbon_lbMax").show(),n("#"+i._id+"_Ribbon_btnMax").show());n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr(t.selectedText+"Start"));n("#"+i._id+"_Ribbon_lbMax").text(i._getLocStr(t.selectedText+"End"));this._dialogValidate("_ValDialog")},_valDlgBtnClick:function(t){var i=this.XLObj,f,e;if(t==="ok"&&n("#"+i._id+"_Form_ValDialog").valid()){var s=n("#"+i._id+"_Ribbon_blank").data("ejCheckBox"),h=n("#"+i._id+"_Ribbon_freetext").data("ejCheckBox").isChecked(),o=n("#"+i._id+"_Ribbon_ddType").data("ejDropDownList"),v=n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList");if(o._selectedValue==="List"){var r=n("#"+i._id+"_Ribbon_btnMin").val(),a=r,c,u,f=n("#"+i._id+"_alertdlg"),l;if(r.indexOf("=")>-1){if(r=r.split("=")[1],r.indexOf("!")>-1&&(c=r.split("!"),e=i._getSheetIndexByName(c[0]),r=c[1]),e===!1){i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}if(r.indexOf("$")>-1&&(r=r.split("$").join("")),r.indexOf(":")<0&&(r=r+":"+r),e=i.isUndefined(e)?i.getActiveSheetIndex():e,l=i.getSheet(e),u=i.getRangeIndices(r),isNaN(u[0])||isNaN(u[1])||isNaN(u[2])||isNaN(u[3])||l.colCount<=u[3]||l.rowCount<=u[2]){i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}if(u[2]===u[0]||u[3]===u[1])i.XLValidate.applyDVRules(null,["list",a],this._types[o.selectedIndexValue].value,s.isChecked(),h);else{i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListValAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}}else i.XLValidate.applyDVRules(null,["list",a],this._types[o.selectedIndexValue].value,s.isChecked(),h)}else i.XLValidate.applyDVRules(null,[this._actions[v.selectedIndexValue].value,n("#"+i._id+"_Ribbon_btnMin").val(),n("#"+i._id+"_Ribbon_btnMax").val()],this._types[o.selectedIndexValue].value,s.isChecked(),h);i._setddlCell()}(t==="cancel"||t==="ok"&&n("#"+i._id+"_Form_ValDialog").valid())&&(n("#"+i._id+"_Ribbon_ddType").data("ejDropDownList").option({selectedItemIndex:0}),n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList").option({selectedItemIndex:6}),n("#"+i._id+"_Ribbon_blank").data("ejCheckBox").option({checked:!0}),n("#"+i._id+"_Ribbon_freetext").data("ejCheckBox").option({checked:!0}),n("#"+i._id+"_Ribbon_btnMin").val(""),n("#"+i._id+"_Ribbon_btnMax").val(""),n("#"+i._id+"_ValDialog").ejDialog("close"),i.setSheetFocus())},_renderValDialog:function(){var i=this.XLObj,h,e,v,o,c,a,y,p;if(n("#"+i._id+"_Ribbon_MainDiv").length<1){h=t.buildTag("div.e-dlgctndiv");e=t.buildTag("div.e-dlg-fields","",{},{id:i._id+"_Ribbon_MainDiv"});n("#"+i._id+"_Validation").append(e);o=t.buildTag("label.e-dlg-fields",i._getLocStr("Allow"));e.append(o);c=t.buildTag("input","","",{id:i._id+"_Ribbon_ddType",type:"text"});e.append(c);c.ejDropDownList({dataSource:this._types,fields:{id:"Types",text:"text",value:"text"},selectedItemIndex:1,width:235,height:25,change:n.proxy(this._valTypeOnChange,this)});var s=t.buildTag("input#"+i._id+"_Ribbon_blank"),l=t.buildTag("label",i._getLocStr("IgnoreBlank"),{},{"for":i._id+"_Ribbon_blank"}),f=t.buildTag("table"),u=t.buildTag("tr"),r=t.buildTag("td");r.append(s);u.append(r);r=t.buildTag("td");r.append(l);u.append(r);f.append(u);s.ejCheckBox();s=t.buildTag("input#"+i._id+"_Ribbon_freetext");l=t.buildTag("label#"+i._id+"_Ribbon_lblfreetext",i._getLocStr("FreeText"),{},{"for":i._id+"_Ribbon_lblfreetext"});u=t.buildTag("tr");r=t.buildTag("td");r.append(s);u.append(r);r=t.buildTag("td");r.append(l);u.append(r);f.append(u);e.append(f);s.ejCheckBox({checked:!0});o=t.buildTag("label.e-dlg-fields").text(i._getLocStr("Data"));e.append(o);a=t.buildTag("input","","",{id:i._id+"_Ribbon_ddAction",type:"text"});e.append(a);a.ejDropDownList({dataSource:this._actions,fields:{id:"Types",text:"text",value:"value"},selectedItemIndex:6,width:235,height:25,change:n.proxy(this._valDTypeOnChange,this)});v=t.buildTag("div.e-dlgctndiv e-dlg-fields","",{},{id:i._id+"_Ribbon_SubDiv"});f=t.buildTag("table");u=t.buildTag("tr");r=t.buildTag("td");o=t.buildTag("label.e-dlg-fields","","",{id:i._id+"_Ribbon_lbMin"}).text(i._getLocStr("NumberStart"));f.append(u.append(r.append(o)));u=t.buildTag("tr");r=t.buildTag("td");y=t.buildTag("input.ejinputtext","",{width:235},{id:i._id+"_Ribbon_btnMin",type:"text",name:i._id+"_valMin"});f.append(u.append(r.append(y)));u=t.buildTag("tr");r=t.buildTag("td");o=t.buildTag("label.e-dlg-fields","","",{id:i._id+"_Ribbon_lbMax"}).text(i._getLocStr("NumberEnd"));f.append(u.append(r.append(o)));u=t.buildTag("tr");r=t.buildTag("td");p=t.buildTag("input.ejinputtext","",{width:235},{id:i._id+"_Ribbon_btnMax",type:"text",name:i._id+"_valMax"});f.append(u.append(r.append(p)));h.append(e,v.append(f)).height(294);n("#"+i._id+"_Validation").append(h);n("#"+i._id+"_Ribbon_SubDiv").wrapInner('<form id="'+i._id+'_Form_ValDialog" onsubmit="return false"><\/form>');this._dialogValidate("_ValDialog")}},_dialogValidate:function(t,i){var f=this.XLObj,e=f._id,l,nt=n("#"+e+"_Form"+t),o,r,a,v,s,y,p,u,w,b,h,k=!0,c,d,g;nt.validate({errorElement:"div",wrapper:"div",errorPlacement:function(n,t){n.insertAfter(t.closest("input"));n.children().addClass("e-dlg-field-validation-error");n.css({position:"relative"});n.offset({left:t.offset().left,top:t.offset().top+19})},onfocusout:function(n){this.element(n)}});c=n("#"+e+"_Ribbon_ddAction").ejDropDownList("getValue");switch(t){case"_ValDialog":l=n("#"+e+"_Ribbon_ddType").data("ejDropDownList");o=l.getSelectedValue();break;case"_CFDialog":o=i.charAt(0).toUpperCase()+i.slice(1).toLowerCase();break;case"_GoToDiv":o="cellAddr";break;case"_Ribbon_cellAddress":o="cellAddr";break;case"_Ribbon_webAddress":o="webAddr"}for(n("#"+e+"_Form"+t).validate().resetForm(),u=[],p=n("#"+e+"_Form"+t).find("input").length,y={required:!0,date:!0,messages:{date:f._getLocStr("DateValidationMsg"),required:f._getLocStr("RequiredField")}},v={required:!0,celladdr:!0},w={required:!0,numberVal:!0},g={required:!0,number:!0,messages:{required:f._getLocStr("RequiredField"),number:f._getLocStr("NumberValidationMsg")}},b={required:!0,time:!0},s={required:!0},d={required:!0,betweentype:!0},n.validator.addMethod("time",function(n){return n===""||n.match(/^(([0-1]?[0-9])|([2][0-3])):([0-5]?[0-9])(:([0-5]?[0-9]))?(\s(AM|am|PM|pm))?$/)},f._getLocStr("TimeValidationMsg")),n.validator.addMethod("date",function(n,t){var i=n.split("/");return this.optional(t)||!/Invalid|NaN/.test(new Date(/chrom(e|ium)/.test(navigator.userAgent.toLowerCase())?i[1]+"/"+i[0]+"/"+i[2]:n))},f._getLocStr("DateValidationMsg")),n.validator.addMethod("celladdr",function(t,i){var r,u=n("#"+i.id.split("_")[0]).data("ejSpreadsheet"),f=n("#"+u._id+"_Ribbon_sheentName").ejTreeView("option","selectedNode"),e;return f=f<0?u.getActiveSheetIndex():f,e=u.getSheet(f),t.indexOf("=")>-1&&(t=t.split("=")[1]),t.indexOf("!")>-1&&(h=t.split("!"),k=n("#"+i.id.split("_textRef")[0]).data("ejSpreadsheet")._getSheetIndexByName(h[0]),t=h[1]),t.indexOf("$")>-1&&(t=t.split("$").join("")),r=u.getRangeIndices(t),r=e.colCount<=r[3]||e.rowCount<=r[2]?null:t,(t.match(/^(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9]):(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9])$/)||t.match(/^(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9])$/)&&k)&&r},f._getLocStr("cellAddrsValidationMsg")),n.validator.addMethod("betweentype",function(t,i){var e=i.id.split("_")[0],f=n("#"+i.id.split("_")[0]+"_Ribbon_ddType").ejDropDownList("getSelectedValue"),r=n("#"+e+"_Ribbon_btnMin").val(),u=n("#"+i.id.split("_")[0]+"_Ribbon_btnMax").val();return(r===""||u===""||parseFloat(r)>parseFloat(u))&&(t=null),f==="Date"&&Date.parse(r)>Date.parse(u)&&(t=null),f==="Time"&&new Date("01/01/1990 "+r).getTime()>new Date("01/01/1990 "+u).getTime()&&(t=null),t},f._getLocStr("BetweenAlert")),n.validator.addMethod("numberVal",function(t){if(n.isNumeric(t))return parseFloat(t)%1!=0&&(t=null),n.validator.messages.numberVal=f._getLocStr("NumberValMsg"),t;n.validator.messages.numberVal=f._getLocStr("NumberAlertMsg")},n.validator.messages.numberVal),r=0,a=p;r<a;r++){u[r]=n("#"+e+"_Form"+t).find("input")[r].id;switch(o){case"Date":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",y);break;case"Time":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",b);break;case"Number":case"TextLength":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",w);break;case"Decimal":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",g);break;case"List":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",s);break;case"cellAddr":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",v);break;case"webAddr":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",s)}o!=="List"&&(c==="between"||c==="not between")&&n("#"+e+"_Ribbon_btnMax").rules("add",d)}},_renderCFDialog:function(i){var f,o,e,u,h,r=this.XLObj,s;h=n("#"+r._id+"_CFDialog").data("ejDialog");h.option({title:r._getLocStr(this._cFormatData[i.ID][0])});n("#"+r._id+"_Ribbon_CFSubDiv").length<1&&(o=t.buildTag("div.e-dlg-fields","",{},{id:r._id+"_Ribbon_CFSubDiv"}),e=t.buildTag("label.e-dlg-fields").text(r._getLocStr("With")),o.append(e),s=t.buildTag("input","",{},{id:r._id+"_Ribbon_ddStyle",type:"text"}),o.append(s),s.ejDropDownList({dataSource:this._styles,fields:{id:"Types",text:"text",value:"value"},selectedItemIndex:0,width:"100%",height:25,change:n.proxy(this._ddOnChange,this)}),n("#"+r._id+"_CondFormat").append(o),n("#"+r._id+"_CondFormat").addClass("e-cfdiv"));n("#"+r._id+"_Ribbon_CFMainDiv").length>0&&n("#"+r._id+"_Ribbon_CFMainDiv").remove();f=t.buildTag("div.e-dlg-fields","","",{id:r._id+"_Ribbon_CFMainDiv"});n("#"+r._id+"_CondFormat").prepend(f);i.ID=="between"&&(u=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_input2",type:"text"}),f.prepend(u),e=t.buildTag("label.e-dlg-fields").text(r._getLocStr("And")).css("display","table"),f.prepend(e));u=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_input1",type:"text"});f.prepend(u);e=t.buildTag("label.e-dlg-fields").text(r._getLocStr(this._cFormatData[i.ID][1]));f.prepend(e);(i.ID==="aboveavg"||i.ID==="belowavg")&&u.hide();n("#"+r._id+"_Ribbon_CFMainDiv").wrapInner('<form id="'+r._id+'_Form_CFDialog" onsubmit="return false"><\/form>');u.is(":visible")&&u.focus().setInputPos(u.val().length);this._dialogValidate("_CFDialog",i.ID)},_dlgCFOk:function(){var t=this.XLObj,i;n("#"+t._id+"_Form_CFDialog").valid()&&(i=n("#"+t._id+"_Ribbon_ddStyle").data("ejDropDownList"),t.XLCFormat._cFormat(t.XLRibbon._currentCFormat,n("#"+t._id+"_Ribbon_input1").val(),n("#"+t._id+"_Ribbon_input2").val(),i.getSelectedValue()),n("#"+t._id+"_CFDialog").ejDialog("close"),t.setSheetFocus())},_dlgCFCancel:function(){var t=this.XLObj;n("#"+t._id+"_CFDialog").ejDialog("close");t.setSheetFocus()},_sheetData:function(){var r=this.XLObj,u=[],t=[],n,f,i=r._getSheetNames();for(t[0]={id:1,name:r._getLocStr("SheetReference"),hasChild:!0,expanded:!0},n=1,f=i.length;n<=f;n++)i[n-1].isVisible&&(u[n]=i[n-1].text,t[n]={id:n+1,pid:1,name:u[n],hasChild:!0,expanded:!0});return t},_renderHLDialog:function(){var i=this.XLObj,c,u,f,s,h,o,e,r,l;n("#"+i._id+"_Ribbon_WebDiv").length<1&&(c=t.buildTag("div.e-dlgctndiv","",{},{id:i._id+"_Ribbon_WebDiv"}),e=t.buildTag("table","",{},{cellpadding:0,cellspacing:0}),r=t.buildTag("tr"),$td=t.buildTag("td","",{width:"32%"}),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("HyperlinkText")),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_findText",type:"text"}),r.append($td.append(f)),r=t.buildTag("tr.e-dlgtd-fields"),$td=t.buildTag("td"),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("WebAddress"),"",{id:i._id+"_Ribbon_address"}),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_webAddress",type:"text"}),r.append($td.append(f)),n("#"+i._id+"_Web").append(c.append(e)),s=t.buildTag("div.e-dlgctndiv","","",{id:i._id+"_Ribbon_DocDiv"}),l=t.buildTag("div.e-dlg-fields"),e=t.buildTag("table"),r=t.buildTag("tr"),$td=t.buildTag("td","",{width:"32%"}),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("HyperlinkText")),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_cellText",type:"text"}),r.append($td.append(f)),r=t.buildTag("tr.e-dlgtd-fields"),$td=t.buildTag("td"),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("CellAddress")),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_cellAddress",type:"text"}),r.append($td.append(f)),o=t.buildTag("div.e-dlg-fields","","",{id:i._id+"_Ribbon_Sheet"}),s.append(l.append(e),o),u=t.buildTag("label",i._getLocStr("SheetIndex")),o.append(u),h=t.buildTag("div","","",{id:i._id+"_Ribbon_sheentName"}),o.append(h),h.ejTreeView({fields:{id:"id",parentId:"pid",text:"name",hasChild:"hasChild",dataSource:this._sheetData(),expanded:"expanded"},nodeSelect:n.proxy(this._sheetSelect,i),height:140}),n("#"+i._id+"_Doc").append(s),n("#"+i._id+"_Ribbon_cellAddress").wrap("<form id='"+i._id+"_Form_Ribbon_cellAddress' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_cellAddress"),n("#"+i._id+"_Ribbon_webAddress").wrap("<form id='"+i._id+"_Form_Ribbon_webAddress' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_webAddress"))},_sheetSelect:function(t){var i,u,f=this._getSheetNames(),r=n("#"+this._id+"_Ribbon_cellAddress"),e=n("#"+this._id+"hlDialog_OkBtn").data("ejButton"),o=n("#"+this._id+"_Ribbon_cellText");if(t.model.selectedNode>0)for(r.attr("disabled",!1),e.enable(),r.focus().setInputPos(1),i=0,u=f.length;i<u;i++)f[i].text===o.val().split("!")[0]&&o.val(t.value+"!"+r.val());else r.attr("disabled",!0),e.disable()},_dlgHLOk:function(){var t=this.XLObj;n("#"+t._id+"_Form_Ribbon_cellAddress").valid()&&n("#"+t._id+"_Form_Ribbon_webAddress").valid()&&(t._setLink(),this._dlgHLCancel())},_dlgHLCancel:function(){n("#"+this.XLObj._id+"_HLDialog").ejDialog("close")},_renderFRDialog:function(){var h,f,c,l,s,e,a,r=this.XLObj,o,u,i;n("#"+r._id+"_Ribbon_FindDiv").length<1&&(h=t.buildTag("div.e-dlgctndiv","",{height:63},{id:r._id+"_Ribbon_FindDiv"}),n("#"+r._id+"_Find").append(h),o=t.buildTag("table"),u=t.buildTag("tr"),i=t.buildTag("td","",{width:"26%"}),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("FindLabel")),i.append(f),i=t.buildTag("td"),c=t.buildTag("input.ejinputtext","","",{id:r._id+"_Ribbon_textFind",type:"text"}),i.append(c),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("ReplaceLabel"),"",{id:r._id+"_Ribbon_lbReplace"}),i.append(f),i=t.buildTag("td"),l=t.buildTag("input.ejinputtext","","",{id:r._id+"_Ribbon_textReplace",type:"text"}),i.append(l),u.append(i),h.append(o),n("#"+r._id+"_Ribbon_lbReplace").hide(),n("#"+r._id+"_Ribbon_textReplace").hide(),a=t.buildTag("div.e-dlgctndiv","",{},{id:r._id+"_Ribbon_SettingsDiv"}),o=t.buildTag("table"),u=t.buildTag("tr"),i=t.buildTag("td","",{width:"50%"}),o.append(u.append(i)),s=t.buildTag("input#"+r._id+"_Ribbon_Case"),f=t.buildTag("label",r._getLocStr("MatchCase"),{},{"for":r._id+"_Ribbon_Case"}),i.append(s),i.append(f),s.ejCheckBox(),i=t.buildTag("td"),s=t.buildTag("input#"+r._id+"_Ribbon_AllContent"),f=t.buildTag("label",r._getLocStr("MatchAll"),{},{"for":r._id+"_Ribbon_AllContent"}),i.append(s),s.ejCheckBox(),i.append(f),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label").text(r._getLocStr("Within")),i.append(f),i=t.buildTag("td"),f=t.buildTag("label").text(r._getLocStr("Search")),i.append(f),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddWithin",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._within,{id:"Types",text:"text",value:"value"},0,125,25)),i=t.buildTag("td"),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddSearch",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._sType,{id:"Types",text:"text",value:"value"},0,125,25)),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("Lookin")),i.append(f),i=t.buildTag("td"),f=t.buildTag("label",r._getLocStr("Replace")+" "+r._getLocStr("Direction")),u.append(i.append(f)),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddLookin",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._vType,{id:"Types",text:"text",value:"value"},0,125,25,"Type")),i=t.buildTag("td"),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddDirection",type:"text"}),u.append(i.append(e)),e.ejDropDownList(r._generateEJDD(this._direction,{id:"Types",text:"text",value:"value"},0,125,25)),n("#"+r._id+"_Settings").append(a.append(o)),n("#"+r._id+"_Ribbon_FindRep").css("width",174))},_frTypeChange:function(t,i){t==="Type"&&(i.value==="comment"||i.value==="formula")?(n("#"+this._id+"_Ribbon_textReplace").attr("disabled",!0),n("#"+this._id+"FR_ReplaceBtn").ejButton("disable"),n("#"+this._id+"FR_ReplaceAllBtn").ejButton("disable")):(n("#"+this._id+"_Ribbon_textReplace").removeAttr("disabled"),n("#"+this._id+"FR_ReplaceBtn").ejButton("enable"),n("#"+this._id+"FR_ReplaceAllBtn").ejButton("enable"))},_hlTabChange:function(t){var i=this.XLObj,e=n("#"+i._id+"_Ribbon_sheentName").data("ejTreeView"),o=i.getActiveSheetIndex(),s=n("#"+i._id+"_Doc"),h=n("#"+i._id+"_Web"),c=n("#"+i._id+"_Ribbon_webAddress"),u=n("#"+i._id+"_Ribbon_findText"),r=n("#"+i._id+"_Ribbon_cellAddress"),f=n("#"+i._id+"_Ribbon_cellText");switch(t.activeIndex){case 0:c.focus().setInputPos(c.val().length);u.val(f.val());s.hide();h.show();n("#"+i._id+"hlDialog_OkBtn").ejButton("enable");break;case 1:r.val().length||r.val("A1");s.show();h.hide();e.selectNode(o+1);u.val().length?f.val(u.val()):f.val(e.getText(o+1)+"!A1");r.focus().setInputPos(r.val().length)}},_findTabChange:function(t){var r,i=this.XLObj;switch(t.activeIndex){case 0:r=n("#"+i._id+"_Ribbon_FindDiv");n("#"+i._id+"_Ribbon_lbReplace").hide();n("#"+i._id+"_Ribbon_textReplace").hide();n("#"+i._id+"FR_ReplaceBtn").hide();n("#"+i._id+"FR_ReplaceAllBtn").hide();n("#"+i._id+"_Find").append(r);n("#"+i._id+"FR_PrevBtn").show();n("#"+i._id+"FR_NextBtn").show();n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length);break;case 1:r=n("#"+i._id+"_Ribbon_FindDiv");n("#"+i._id+"_Ribbon_lbReplace").show();n("#"+i._id+"_Ribbon_textReplace").show();n("#"+i._id+"FR_ReplaceBtn").show();n("#"+i._id+"FR_ReplaceAllBtn").show();n("#"+i._id+"FR_PrevBtn").show();n("#"+i._id+"FR_NextBtn").show();n("#"+i._id+"_Replace").append(r);n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length);break;case 2:n("#"+i._id+"FR_PrevBtn").hide();n("#"+i._id+"FR_NextBtn").hide();n("#"+i._id+"FR_ReplaceBtn").hide();n("#"+i._id+"FR_ReplaceAllBtn").hide();n("#"+i._id+"_Ribbon_ddWithin").focus()}},_gotoTabChange:function(t){var i=this.XLObj;t.activeIndex==0&&n("#"+i._id+"_textRef").focus().setInputPos(n("#"+i._id+"_textRef").val().length)},_btnFROnClick:function(t){var i=this.XLObj;i.element.ejWaitingPopup("show");var r=i.getActiveSheetIndex(),c=i.getSheet(r)._startCell.rowIndex,l=i.getSheet(r)._startCell.colIndex,u=n("#"+i._id+"_Ribbon_Case").data("ejCheckBox").isChecked(),f=n("#"+i._id+"_Ribbon_AllContent").data("ejCheckBox").isChecked(),e=this._within[n("#"+i._id+"_Ribbon_ddWithin").data("ejDropDownList").selectedIndexValue].value,s=this._sType[n("#"+i._id+"_Ribbon_ddSearch").data("ejDropDownList").selectedIndexValue].value,o=this._vType[n("#"+i._id+"_Ribbon_ddLookin").data("ejDropDownList").selectedIndexValue].value,a=this._direction[n("#"+i._id+"_Ribbon_ddDirection").data("ejDropDownList").selectedIndexValue].value,h;switch(t){case"FR_NextBtn":case"FR_PrevBtn":i.XLFndRp._findCount=0;h=t==="FR_NextBtn"?i.XLFndRp._findNext(n("#"+i._id+"_Ribbon_textFind").val(),r,u,f,o,e,s):i.XLFndRp._findPrev(n("#"+i._id+"_Ribbon_textFind").val(),r,u,f,o,e,s);h||(i.XLFndRp._updateSelection(c,l,r),i.element.ejWaitingPopup("hide"),i._showAlertDlg("Alert","NotFound"));break;case"FR_ReplaceBtn":i.XLFndRp._replaceData(n("#"+i._id+"_Ribbon_textFind").val(),n("#"+i._id+"_Ribbon_textReplace").val(),r,u,f,o,a,e,s);break;case"FR_ReplaceAllBtn":i.XLFndRp._replaceAllData(n("#"+i._id+"_Ribbon_textFind").val(),n("#"+i._id+"_Ribbon_textReplace").val(),u,f,o,e);break;case"FR_CloseBtn":n("#"+i._id+"_FRDialog").ejDialog("close");i.setSheetFocus()}i.element.ejWaitingPopup("hide")},_renderGoToDialog:function(){var f,e,u,o,s,i=this.XLObj,r;n("#"+i._id+"_GoToDiv").length<1&&(f=t.buildTag("div.e-dlgctndiv","",{},{id:i._id+"_GoToDiv"}),n("#"+i._id+"_GoTo").append(f),r=t.buildTag("div.e-dlg-fields"),u=t.buildTag("label.e-dlg-fields",i._getLocStr("GoToName")),o=t.buildTag("ul#"+i._id+"_GotoAddr"),f.append(r.append(u,o)),n("#"+i._id+"_GotoAddr").ejListBox({dataSource:this._addrList,height:"190px",width:"247px",selected:n.proxy(this._gotoValChange,this),fields:{id:"Types",text:"text",value:"value"}}),r=t.buildTag("div.e-dlg-fields"),u=t.buildTag("label.e-dlg-fields",i._getLocStr("Reference")),s=t.buildTag("input.ejinputtext","","",{id:i._id+"_textRef",type:"text"}),f.append(r.append(u,s)),e=t.buildTag("div#"+i._id+"_GoToSpDiv.e-dlgctndiv"),r=t.buildTag("div.e-dlg-fields e-dlgctndiv"),n("#"+i._id+"_GoToSp").append(e.append(r)),u=t.buildTag("label.e-dlg-fields").text(i._getLocStr("Select")).css("display","table"),r.append(u),this._renderGotoSp(r,this._gotoRBtnSet1,this._gotoRBtnSet2,this._gotoChkBox),n("#"+i._id+"_GoToDiv").wrapInner('<form id="'+i._id+'_Form_GoToDiv" onsubmit="return false"><\/form>'),this._dialogValidate("_GoToDiv"))},_renderGotoSp:function(i,r,u,f){for(var l,c,s,e,h=this.XLObj,v=h._id+"_gotoSpDiv",a,y=t.buildTag("table"),o=0;o<r.length;o++)s=t.buildTag("tr","",{height:35}),e=t.buildTag("td"),l=t.buildTag("input#"+v+"_"+r[o],"",{},{type:"radio",name:"gotospecial"}),e.append(l),s.append(e),l.ejRadioButton({size:"medium",change:n.proxy(this._rBtnOnClick,this,r[o])}),e=t.buildTag("td","",{width:100}),c=t.buildTag("label",h._getLocStr(r[o]),{},{"for":v+"_"+r[o]}),e.append(c),s.append(e),h.isUndefined(u[o])||(e=t.buildTag("td"),l=t.buildTag("input#"+v+"_"+u[o],"",{},{type:"radio",name:"gotospecial"}),e.append(l),s.append(e),l.ejRadioButton({size:"medium",change:n.proxy(this._rBtnOnClick,this,u[o])}),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(u[o]),{},{"for":v+"_"+u[o]}),e.append(c),s.append(e)),y.append(s);for(o=0;o<f.length;o=o+2)s=t.buildTag("tr"),e=t.buildTag("td"),a=t.buildTag("input#"+h._id+"_"+f[o]),e.append(a),s.append(e),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(f[o]),{},{"for":h._id+"_"+f[o]}),e.append(c),s.append(e),a.ejCheckBox({checked:!0,enabled:!1}),e=t.buildTag("td"),a=t.buildTag("input#"+h._id+"_"+f[o+1]),e.append(a),s.append(e),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(f[o+1]),{},{"for":h._id+"_"+f[o+1]}),e.append(c),s.append(e),a.ejCheckBox({checked:!0,enabled:!1}),y.append(s);i.append(y);n("#"+v+"_Blanks").ejRadioButton("option",{checked:!0})},_rBtnOnClick:function(t){var r=this.XLObj,i;if(t==="Formulas"||t==="Constants")for(i=0;i<this._gotoChkBox.length;i++)n("#"+r._id+"_"+this._gotoChkBox[i]).data("ejCheckBox").option({enabled:!0});else for(i=0;i<this._gotoChkBox.length;i++)n("#"+r._id+"_"+this._gotoChkBox[i]).data("ejCheckBox").option({enabled:!1})},_gotoValChange:function(t){n("#"+this.XLObj._id+"_textRef").val(t.model.value)},_gotoBtnClick:function(t){var i=this.XLObj,v,e,u;switch(t){case"ok":if(n("#"+i._id+"_Form_GoToDiv").valid())if(v=n("#"+i._id+"_GoToDlgTab").data("ejTab"),v.model.selectedItemIndex)i.XLFndRp._applyGoToRule(n("#"+i._id+"_GoToSpDiv").find(".e-rad-active").parents("div")[0].id.split("ej"+i._id+"_gotoSpDiv_")[1].toLowerCase(),n("#"+i._id+"_"+this._gotoChkBox[0]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[1]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[2]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[3]).data("ejCheckBox").isChecked()),n("#"+i._id+"_GoDialog").ejDialog("close");else{var y,o,p=i.getActiveSheetIndex(),s=i.getSheet(p),f,h,r=n.trim(n("#"+i._id+"_textRef").val().toString()),c,l,a=i._getDollarAlphaRange(s.selectedRange);r.indexOf("!")>-1&&(l=r.split("!"),c=i._getSheetIndexByName(l[0]),r=l[1]);r.indexOf("$")>-1&&(r=r.split("$").join(""));r.indexOf(":")<0&&(r=r+":"+r);r=r.replace("=","");c&&i.gotoPage(c,!1);e=i.getRangeIndices(r);u=i.getRange(e[0],e[1],e[2],e[3]);f={rowIndex:n(u[0]).parent("tr").index(),colIndex:n(u[0]).index()};h={rowIndex:n(u[u.length-1]).parent("tr").index(),colIndex:n(u[u.length-1]).index()};i.setActiveCell(f.rowIndex,f.colIndex);i.XLSelection.selectRange(f,h);i.XLScroll._scrollSelectedPosition(i.getActiveSheetIndex(),f);i.XLDragFill.positionAutoFillElement();s._startCell=f;s._endCell=h;i.setSheetFocus();y=n.grep(this._addrList,function(n){return n.value===a});y.length<1&&(this._addrList.push({value:a,text:a}),o=n("#"+i._id+"_GotoAddr").data("ejListBox"),this._addrList=JSON.parse(JSON.stringify(this._addrList)),o.model.dataSource=this._addrList,o.option("fields",{dataSource:this._addrList}));n("#"+i._id+"_GoDialog").ejDialog("close")}break;case"cancel":n("#"+i._id+"_Form_GoToDiv").validate().resetForm();n("#"+i._id+"_GoDialog").ejDialog("close")}i.setSheetFocus()},_borderPicture:function(){var n=this.XLObj;return"<ul id="+n._id+"_Ribbon_PictureBorder><li id='"+n._id+"picturecolor'><a>"+n._getLocStr("ThemeColor")+"<\/a><ul><li><input id='"+n._id+"_Ribbon_PictureColor'><\/input><\/li><\/ul><\/li><li id='nooutline' class='picturecolor'><a>"+n._getLocStr("NoOutline")+"<\/a><\/li><li id='weight' class='picturecolor'><a>"+n._getLocStr("Weight")+"<\/a><ul><li id='1px'><a>1px<\/a><\/li><li id='2px'><a>2px<\/a><\/li><li id='3px'><a>3px<\/a><\/li><\/ul><\/li><li id='dashes' class='picturecolor'><a>"+n._getLocStr("Dashes")+"<\/a><ul><li id='solid'><a><div style='top:9px;border:1px solid black;width:40px'><\/div><\/a><\/li><li id='dotted'><a><div style='top:9px;border:1px dotted black;width:40px'><\/div><\/a><\/li><li id='dashed'><a><div style='top:9px;border:1px dashed black;width:40px'><\/div><\/a><\/li><\/ul><\/li><\/ul>"},_chartElementTag:function(){var n=this.XLObj,t="<ul id="+n._id+'_Ribbon_CElement class="e-spreadsheet">';return t+='<li class="axes" id="Axes"><a><span class="e-ss-chartimg e-icon e-ss-axes"><\/span>'+n._getLocStr("Axes")+'<\/a><ul><li class="phaxis e-ss-cmenuitem" id="PHAxis"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-phaxis"><\/span>'+n._getLocStr("PHAxis")+'<\/a><\/li><li class="pvaxis e-ss-cmenuitem" id="PVAxis"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pvaxis"><\/span>'+n._getLocStr("PVAxis")+"<\/a><\/li><\/ul><\/li>",t+='<li class="axistitle" id="AxisTitle"><a><span class="e-ss-chartimg e-icon e-ss-axistitle"><\/span>'+n._getLocStr("AxisTitle")+'<\/a><ul><li class="phaxistitle e-ss-cmenuitem" id="PHAxisTitle"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-phaxistitle"><\/span>'+n._getLocStr("PHAxis")+'<\/a><\/li><li class="pvaxistitle e-ss-cmenuitem" id="PVAxisTitle"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pvaxistitle"><\/span>'+n._getLocStr("PVAxis")+"<\/a><\/li><\/ul><\/li>",t+='<li class="charttitle" id="ChartTitle"><a><span class="e-ss-chartimg e-icon e-ss-charttitle"><\/span>'+n._getLocStr("ChartTitle")+'<\/a><ul><li class="ctnone e-ss-cmenuitem" id="CTNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctnone"><\/span>'+n._getLocStr("CTNone")+'<\/a><\/li><li class="ctcenter e-ss-cmenuitem" id="CTCenter"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctcenter"><\/span>'+n._getLocStr("CTCenter")+'<\/a><\/li><li class="ctfar e-ss-cmenuitem" id="CTFar"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctfar"><\/span>'+n._getLocStr("CTFar")+'<\/a><\/li><li class="ctnear e-ss-cmenuitem" id="CTNear"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctnear"><\/span>'+n._getLocStr("CTNear")+"<\/a><\/li><\/ul><\/li>",t+='<li class="datalabels" id="DataLabels"><a><span class="e-ss-chartimg e-icon e-ss-datalabels"><\/span>'+n._getLocStr("DataLabels")+'<\/a><ul><li class="dlnone e-ss-cmenuitem" id="DLNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlnone"><\/span>'+n._getLocStr("DLNone")+'<\/a><\/li><li class="dlcenter e-ss-cmenuitem" id="DLCenter"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlcenter"><\/span>'+n._getLocStr("DLCenter")+'<\/a><\/li><li class="dliend e-ss-cmenuitem" id="DLIEnd"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dliend"><\/span>'+n._getLocStr("DLIEnd")+'<\/a><\/li><li class="dlibase e-ss-cmenuitem" id="DLIBase"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlibase"><\/span>'+n._getLocStr("DLIBase")+'<\/a><\/li><li class="dloend e-ss-cmenuitem" id="DLOEnd"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dloend"><\/span>'+n._getLocStr("DLOEnd")+"<\/a><\/li><\/ul><\/li>",t+='<li class="gridline" id="Gridline"><a><span class="e-ss-chartimg e-icon e-ss-gridline"><\/span>'+n._getLocStr("Gridline")+'<\/a><ul><li class="pmajorh e-ss-cmenuitem" id="PMajorH"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pmajorh"><\/span>'+n._getLocStr("PMajorH")+'<\/a><\/li><li class="pmajorv e-ss-cmenuitem" id="PMajorV"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pmajorv"><\/span>'+n._getLocStr("PMajorV")+'<\/a><\/li><li class="pminorh e-ss-cmenuitem" id="PMinorH"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon  e-ss-pminorh"><\/span>'+n._getLocStr("PMinorH")+'<\/a><\/li><li class="pminorv e-ss-cmenuitem" id="PMinorV"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pminorv"><\/span>'+n._getLocStr("PMinorV")+"<\/a><\/li><\/ul><\/li>",t+('<li class="legend" id="Legend"><a><span class="e-ss-chartimg e-icon e-ss-legend"><\/span>'+n._getLocStr("Legend")+'<\/a><ul><li class="lnone e-ss-cmenuitem" id="LNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lnone"><\/span>'+n._getLocStr("LNone")+'<\/a><\/li><li class="lright e-ss-cmenuitem" id="LRight"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lright"><\/span>'+n._getLocStr("LRight")+'<\/a><\/li><li class="lleft e-ss-cmenuitem" id="LLeft"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lleft"><\/span>'+n._getLocStr("LLeft")+'<\/a><\/li><li class="lbottom e-ss-cmenuitem" id="LBottom"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lbottom"><\/span>'+n._getLocStr("LBottom")+'<\/a><\/li><li class="ltop e-ss-cmenuitem" id="LTop"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ltop"><\/span>'+n._getLocStr("LTop")+"<\/a><\/li><\/ul><\/li>")},_changeImport:function(i){var r=n("#"+n("#"+this._id).parents("div")[0].id).data("ejSpreadsheet"),u=t.browserInfo(),f;((u.name==="msie"&&parseInt(u.version)<10)?i.files[0].extension.indexOf("jpg")>-1||i.files[0].extension.indexOf("png")>-1||i.files[0].extension.indexOf("jpeg")>-1||i.files[0].extension.indexOf("gif")>-1:i.files.rawFile.type.indexOf("image")>-1)?(this.updialog.ejDialog("close"),r.XLShape._insertPicture(i),r.XLRibbon._formatTabUpdate()):(f=u.name==="msie"&&parseInt(u.version)<10?i.responseText:i.xhr.response,this.updialog.ejDialog("close"),r.importSheet=!0,r._importSuccess(f),r.importSheet=!1);r.hideWaitingPopUp()},_cpClickHandler:function(t){var i=this.XLObj;i._isApply=!0;t==="Ribbon_background-color"?i.XLFormat.format({style:{"background-color":n("#"+i._id+"_Ribbon_background-color").ejColorPicker("option","value")}}):t==="Ribbon_color"&&i.XLFormat.format({style:{color:n("#"+i._id+"_Ribbon_color").ejColorPicker("option","value")}})},_ribbonClickHandler:function(i){var st,ci,ii,vt,w,b,li,f,y,ut,ct,lt,dt,ft,c,l,s,yt={},u=n("#"+this._id.split("_Ribbon")[0]).data("ejSpreadsheet"),h=u.getActiveSheetIndex(),it=u.getSheet(h),p={},v={},d=this._id.split("_"),rt=t.Spreadsheet.SupportedStyles,ai,pt,ki,o,nt,vi,yi,gt,ri,et,ni,ui,fi,pi,wi,at,ei,oi,wt,a,ti,tt,bt,si,g,k,e,ot,ht,kt;if(!u._shapeChange&&!u.XLRibbon._isSetModel){if(pt=u._getContent(h).find("div:first-child"),ki=u.getMainPanel(),st=n("#"+u._id+"_Ribbon_cellformat").data("ejDropDownList"),ft=n("#"+u._id+"_Ribbon_fontsize").data("ejDropDownList"),dt=n(u.getCell(it._activeCell.rowIndex,it._activeCell.colIndex)),u.model.allowSelection&&u.model.allowFormatAsTable&&u.model.allowCellFormatting&&(u.XLFormat._formatEnable||u.XLSelection._isOutsideBordering||u.XLSelection._isGridBordering)&&(u._id+"_Ribbon_BorderColor"===this._id||u._id+"_Ribbon_bordercolor"===i.ID||u._borderStyles.indexOf(i.ID)>-1||(u.XLSelection._isGridBordering=u.XLSelection._isOutsideBordering=u.XLFormat._formatEnable=!1,n("#"+u._id+"_Ribbon_formatpainter").ejToggleButton("option",{toggleState:!1}),i.type!=="itemSelected"||u.isUndefined(i.model.prefixIcon)||i.model.prefixIcon.split("e-ss-")[1]!==i.ID||(u.XLSelection._isGridBordering=u.XLSelection._isOutsideBordering=!0),i.type==="click"&&!u.isUndefined(i.model.prefixIcon)&&(i.model.prefixIcon.indexOf("e-ss-drawborder")>-1||i.model.prefixIcon.indexOf("e-ss-drawbordergrid")>-1)&&(u.XLSelection._isGridBordering=u.XLSelection._isOutsideBordering=!0),pt.addClass("e-ss-cursor"),pt.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor e-ss-fpcursor"))),ai={Id:this._id,isChecked:i.isChecked,status:i.status,prop:i.model,model:u.model},u._trigger("ribbonClick",ai)){u.XLRibbon._updateRibbonIcons();return}!t.isNullOrUndefined(u._getAutoFillOptElem())&&u.model.autoFillSettings.showFillOptions&&(u._getAutoFillOptElem().addClass("e-hide"),n("#"+u._id+"_ctxtmenu").hide());switch(this._id){case u._id+"_Ribbon_cut":u.XLClipboard.cut();break;case u._id+"_Ribbon_copy":u.XLClipboard.copy();break;case u._id+"_Ribbon_pastebtn":case u._id+"_Ribbon_pastesbtn":u.XLClipboard._isSpecial=!(i.ID==="PasteValues");u.XLClipboard.paste();break;case u._id+"_Ribbon_undo":u.XLClipboard._triggerKeyDown(90,!0);break;case u._id+"_Ribbon_redo":u.XLClipboard._triggerKeyDown(89,!0);break;case u._id+"_Ribbon_wraptext":u._textFormatting("wrapText");break;case u._id+"_Ribbon_exportXL":u.XLExport["export"](t.Spreadsheet.exportType.Excel);break;case u._id+"_Ribbon_exportCsv":u.XLExport["export"](t.Spreadsheet.exportType.Csv);break;case u._id+"_Ribbon_print":u.XLPrint.printSheet(h);break;case u._id+"_Ribbon_printselected":u.XLPrint.printSelection(h);break;case u._id+"_Ribbon_new":u._cellFormatHandler(this._id.replace(u._id+"_Ribbon_",""),i.selectedText);break;case u._id+"_Ribbon_bold":v[rt.FontWeight]=i.model.toggleState?"bold":"normal";p.style=v;u.XLFormat.format(p);break;case u._id+"_Ribbon_italic":v[rt.FontStyle]=i.model.toggleState?"italic":"normal";p.style=v;u.XLFormat.format(p);break;case u._id+"_Ribbon_underline":case u._id+"_Ribbon_line-through":nt=u.XLFormat.getFormatFromHashCode(u.XLFormat.getFormatClass(dt[0].className))["text-decoration"]||"";i.model.toggleState?(nt=nt.replace("none",""),v[rt.TextDecoration]=nt?nt.indexOf("underline")===-1?nt+" "+d[d.length-1]:d[d.length-1]+" "+nt:d[d.length-1]):(nt=n.trim(nt.replace(d[d.length-1],"")),v[rt.TextDecoration]=nt.length?nt:"none");p.style=v;u.XLFormat.format(p);break;case u._id+"_Ribbon_fontsize":v[rt.FontSize]=i.value;p.style=v;u.XLFormat.format(p);break;case u._id+"_Ribbon_increasefontsize":case u._id+"_Ribbon_decreasefontsize":this._id==u._id+"_Ribbon_increasefontsize"?(lt=t.isNullOrUndefined(ft.selectedIndexValue)?6:ft.selectedIndexValue+1,t.isNullOrUndefined(u.XLRibbon._fontSize[lt])||ft.option({selectedItemIndex:lt})):this._id==u._id+"_Ribbon_decreasefontsize"&&(lt=t.isNullOrUndefined(ft.selectedIndexValue)?4:ft.selectedIndexValue-1,t.isNullOrUndefined(u.XLRibbon._fontSize[lt])||ft.option({selectedItemIndex:lt}));v[rt.FontSize]=ft.value();p.style=v;u.XLFormat.format(p);break;case u._id+"_Ribbon_left":case u._id+"_Ribbon_right":case u._id+"_Ribbon_center":ut=n(this.element.parents("div").eq(1)).find(".e-text-align");t.isNullOrUndefined(ut[0])||(n("#"+ut[0].id).ejToggleButton("option","toggleState",!1),ut.removeClass("e-text-align"));this.element.addClass("e-text-align");v[rt.TextAlign]=i.model.toggleState?d[d.length-1]:"left";p.style=v;u.XLFormat.format(p);break;case u._id+"_Ribbon_top":case u._id+"_Ribbon_middle":case u._id+"_Ribbon_bottom":ut=n(this.element.parents("div").eq(1)).find(".e-vertical-align");t.isNullOrUndefined(ut[0])||(n("#"+ut[0].id).ejToggleButton("option","toggleState",!1),ut.removeClass("e-vertical-align"));this.element.addClass("e-vertical-align");v[rt.VerticalAlign]=i.model.toggleState?d[d.length-1]:"bottom";p.style=v;u.XLFormat.format(p);break;case u._id+"_Ribbon_font-family":v[rt.FontFamily]=i.text;p.style=v;u.XLFormat.format(p);break;case u._id+"_Ribbon_Vheading":u.showHeaders(i.isChecked);break;case u._id+"_Ribbon_Vgridlines":u.showGridlines(i.isChecked);break;case u._id+"_Ribbon_sizebtn":case u._id+"_Ribbon_sizesbtn":vi=t.isNullOrUndefined(i.ID)?i.model.prefixIcon.substring(12):i.ID;u.XLPrint._printSetting(vi);break;case u._id+"_Ribbon_cellformat":p.type=i.text.toLowerCase();u.XLFormat.format(p);break;case u._id+"_Ribbon_increment":case u._id+"_Ribbon_decrement":dt.data("type")!="number"&&n.isNumeric(u.XLEdit.getPropertyValueByElem(dt))&&(u.XLRibbon._isSetModel=!0,st.option({selectedItemIndex:1}),u.XLRibbon._isSetModel=!1);u.XLFormat.updateDecimalPlaces(d[d.length-1]);break;case u._id+"_Ribbon_accounting":case u._id+"_Ribbon_percentage":this._id===u._id+"_Ribbon_accounting"?st.option({selectedItemIndex:3}):st.option({selectedItemIndex:4});p.type=st.selectedTextValue.toLowerCase();u.XLFormat.format(p);break;case u._id+"_Ribbon_usegrouping":st.option({selectedItemIndex:1});p.type=st.selectedTextValue.toLowerCase();u.XLFormat.format(p);break;case u._id+"_Ribbon_sortAtoZ":u.XLSort._sortHandler("SortAtoZ");break;case u._id+"_Ribbon_sortZtoA":u.XLSort._sortHandler("SortZtoA");break;case u._id+"_Ribbon_filter":u.XLFilter.filter();break;case u._id+"_Ribbon_clearfilter":ct=u.getCell(u.getActiveCell().rowIndex,u.getActiveCell().colIndex)[0].className;ct.indexOf("e-table")<0?u.XLFilter.clearFilter():(c=u._getTableID(ct),u.XLFilter._clearFilterTable(u.getActiveSheetIndex(),parseInt(c),!0));break;case u._id+"_Ribbon_BorderColor":yt=n("#"+u._id+"_Ribbon_BorderColor").data("ejColorPicker");t.isNullOrUndefined(yt)||yt.hide();t.isNullOrUndefined(i.value)||(u._borderColor=i.value);break;case u._id+"_Ribbon_border":u._borderStyles.indexOf(i.ID)<0?t.isNullOrUndefined(i.ID)?i.ID=i.model.prefixIcon.substring(12):i.ID.indexOf("bordercolor")<0&&n(this.element).find(".e-icon ").removeClass().addClass("e-icon e-ss-"+i.ID)&&this.option({prefixIcon:"e-icon e-ss-"+i.ID}):u.XLRibbon._updateBordeStyle(i);ci=u._borderColor||"#000000";w=it._startCell;b=it._endCell;yi=u._getAlphaRange(h,w.rowIndex,w.colIndex,b.rowIndex,b.colIndex);u.XLSelection._isOutsideBordering||u.XLSelection._isGridBordering?!(u._borderStyles.indexOf(i.ID)>-1)&&i.ID.indexOf("bordercolor")<0&&(u.XLSelection._isOutsideBordering=u.XLSelection._isGridBordering=!1):u.setBorder({ID:i.ID,hexaCode:ci,style:u._borderStyle},yi);break;case u._id+"_Ribbon_validationsbtn":case u._id+"_Ribbon_validationbtn":i.ID=="ClearVal"?u.XLValidate.clearDV():i.ID=="HighlightVal"?u.XLValidate.highlightInvalidData():i.ID=="ClearHLVal"?u.XLValidate.clearHighlightedValData():(n("#"+u._id+"_ValDialog").ejDialog("open"),n("#"+u._id+"_Form_ValDialog").validate().resetForm(),n("#"+u._id+"_Ribbon_ddType_wrapper").focus(),gt=u.XLEdit.getPropertyValueByElem(u.getActiveCellElem(h),"rule"),gt?(ri=gt.customVal,et=ri.split("_"),ri.indexOf("list")>-1?(n("#"+u._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",5),n("#"+u._id+"_Ribbon_btnMin").val(et[0])):(u.XLRibbon._types.some(function(n,t){if(et[4]===n.value)return ni=t,!0}),n("#"+u._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",ni),u.XLRibbon._actions.some(function(n,t){if(et[0]===n.value)return ni=t,!0}),n("#"+u._id+"_Ribbon_ddAction").ejDropDownList("option","selectedItemIndex",ni),n("#"+u._id+"_Ribbon_btnMin").val(et[1].replace("^","")),n("#"+u._id+"_Ribbon_btnMax").val(et[2].replace("^",""))),n("#"+u._id+"_Ribbon_blank").ejCheckBox("option","checked",!gt.required),n("#"+u._id+"_Ribbon_freetext").ejCheckBox("option","checked",JSON.parse(et[et.length-3]))):(n("#"+u._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",1),n("#"+u._id+"_Ribbon_ddAction").ejDropDownList("option","selectedItemIndex",6),n("#"+u._id+"_Ribbon_btnMin").val(""),n("#"+u._id+"_Ribbon_btnMax").val(""),n("#"+u._id+"_Ribbon_blank").ejCheckBox("option","checked",!0),n("#"+u._id+"_Ribbon_freetext").ejCheckBox("option","checked",!0)));break;case u._id+"_Ribbon_cFormat":if(!i.ID.length)break;u.XLRibbon._currentCFormat=i.ID;i.ID.startsWith("clear")?u.XLCFormat.clearCF(i.ID==="clearselected"):i.ID.indexOf("_HLCellRules")>0||i.ID.indexOf("_ClearRules")>0||(n("#"+u._id+"_CFDialog").ejDialog("open"),u.XLRibbon._renderCFDialog(i));break;case u._id+"_Ribbon_find":ii=n("#"+u._id+"_GoToDlgTab").data("ejTab");ui=n("#"+u._id+"_FRDialog_FPDlgTab").data("ejTab");switch(i.ID){case"Find":n("#"+u._id+"_FRDialog").ejDialog("open");ui.option({selectedItemIndex:0});n("#"+u._id+"_Ribbon_textFind").focus().setInputPos(n("#"+u._id+"_Ribbon_textFind").val().length);break;case"Replace":n("#"+u._id+"_FRDialog").ejDialog("open");ui.option({selectedItemIndex:1});n("#"+u._id+"_Ribbon_textFind").focus().setInputPos(n("#"+u._id+"_Ribbon_textFind").val().length);break;case"GoTo":n("#"+u._id+"_GoDialog").ejDialog("open");ii.option({selectedItemIndex:0});n("#"+u._id+"_textRef").focus().setInputPos(n("#"+u._id+"_Ribbon_textFind").val().length);n("#"+u._id+"_Form_GoToDiv").validate().resetForm();break;case"GoToSpecial":n("#"+u._id+"_GoDialog").ejDialog("open");ii.option({selectedItemIndex:1});n("#"+u._id+"_Blanks").focus();break;default:u.XLFndRp._applyGoToRule(i.ID.toLowerCase(),!0,!0,!0,!0)}break;case u._id+"_Ribbon_formatpainter":if(!i.model.toggleState)return!1;u.XLFormat._formatEnable=!0;pt.removeClass("e-ss-cursor");pt.addClass("e-ss-fpcursor");u.XLFormat._formatPainter();break;case u._id+"_Ribbon_convertorange":if(confirm(u._getLocStr("ConverToRangeAlert"))){for(c=parseInt(document.getElementById(u._id+"_tableid").value),l=u.getSheet(h)._tableManager,fi=u.model.sheets[h].filterSettings.tableRange,a=0;a<fi.length;a++)fi[a].tableID==c&&(pi=a);f={sheetIndex:h,reqType:"format-table",action:"convertorange",beforeFormat:u.XLFormat.getHashCodeClassAsArray()};f.tableID=c;f.format=l[c].format;f.formatName=l[c].formatName;f.tableRange=u.model.sheets[h].filterSettings.tableRange[pi];f.beforeRange=l[c].range;f.isFilter=l[c].isFilter;f.firstColumn=l[c].firstColumn;f.lastColumn=l[c].lastColumn;f.totalRow=l[c].totalRow;u.isNumber(c)&&u.XLFormat.removeTable(c);wi=u.getCell(u.getActiveCell().rowIndex,u.getActiveCell().colIndex)[0];u.XLRibbon._toggleDesignTab(wi);u._completeAction(f)}break;case u._id+"_Ribbon_resizetable":c=parseInt(document.getElementById(u._id+"_tableid").value);s=u.model.sheets[h]._tableManager[c].range;n("#"+u._id+"_fatresizetablerange").val(u._getAlphaRange(h,s[0],s[1],s[2],s[3]));n("#"+u._id+"_fatresizetabledlg").ejDialog("open");break;case u._id+"_Ribbon_tsofirstcolumn":case u._id+"_Ribbon_tsolastcolumn":l=it._tableManager;c=document.getElementById(u._id+"_tableid").value;c in l&&(s=l[c].range,s=this._id===u._id+"_Ribbon_tsofirstcolumn"?u._getProperAlphaRange(h,s[0]+1,s[1],s[2],s[1]):u._getProperAlphaRange(h,s[0]+1,s[3],s[2],s[3]),this._id===u._id+"_Ribbon_tsofirstcolumn"?i.isChecked?l[c].firstColumn=!0:delete l[c].firstColumn:i.isChecked?l[c].lastColumn=!0:delete l[c].lastColumn,u._dupDetails=!0,u.XLFormat.format({style:{"font-weight":i.isChecked?"bold":"normal"}},s),u._dupDetails=!1,f={sheetIndex:h,reqType:"format-table",action:"firstlastcolumn",range:s,check:i.isChecked,id:i.model.id},u._completeAction(f));break;case u._id+"_Ribbon_tsototalrow":if(oi=[],ti=!1,l=it._tableManager,c=document.getElementById(u._id+"_tableid").value,c in l){if(s=l[c].range,at=u.getRange(s[2]+1,s[1],s[2]+1,s[3]),oi.push(u.getRangeData([s[2]+1,s[1],s[2]+1,s[3]])),ei=u._getProperAlphaRange(h,s[0]+1,s[3],s[2],s[3]),s=i.isChecked?u._getProperAlphaRange(h,s[0]+1,s[3],s[2],s[3]):"",at.length>1&&u.XLEdit.updateCellValue(n(at[0]),i.isChecked?"Total":""),!l[c].fnNumber&&i.isChecked){if(wt=t.distinct(u.getRangeData(u.getRangeIndices(ei),!0)),wt=wt.filter(Boolean),a=wt.length,a){while(a--)if(!u.isNumber(wt[a])){ti=!0;break}}else ti=!0;l[c].fnNumber=ti?103:109}u.XLEdit.updateCellValue(n(at[at.length-1]),i.isChecked?"=SUBTOTAL("+l[c].fnNumber+","+s+")":"");i.isChecked?l[c].totalRow=!0:"totalRow"in l[c]&&delete l[c].totalRow;f={sheetIndex:h,reqType:"format-table",action:"totalrow",range:ei,check:i.isChecked,id:i.model.id,cell:at,tmgr:l,tid:c,pcells:oi[0]};u._completeAction(f)}break;case u._id+"_Ribbon_tsofiltercolumn":l=it._tableManager;c=document.getElementById(u._id+"_tableid").value;u.XLFilter._clearFilterTableIcon(h,parseInt(document.getElementById(u._id+"_tableid").value));l[c].isFilter=i.isChecked;f={sheetIndex:h,reqType:"format-table",action:"filtericon",tableId:document.getElementById(u._id+"_tableid").value,id:i.model.id,check:i.isChecked};u._completeAction(f);break;case u._id+"_Ribbon_table":u.XLRibbon._openFATDlg();break;case u._id+"_Ribbon_newComment":n("#"+u._id+"_Ribbon_newComment").text()===u._getLocStr("NewComment")?u.XLComment.setComment():u.XLComment.editComment();break;case u._id+"_Ribbon_deleteComment":u.XLComment.deleteComment();break;case u._id+"_Ribbon_showAllComments":u.XLComment.showAllComments();break;case u._id+"_Ribbon_showHideComment":u.XLComment.showHideComment();break;case u._id+"_Ribbon_nextComment":u.XLComment.findNextComment();break;case u._id+"_Ribbon_previousComment":u.XLComment.findPrevComment();break;case u._id+"_Ribbon_hyperlink":u._hlDlgOpen();break;case u._id+"_Ribbon_sortfilter":switch(i.ID){case"SortAtoZ":case"SortZtoA":u.model.allowSorting&&u.XLSort._sortHandler(i.ID);break;case"Filter":u.model.allowFiltering&&u.XLFilter.filter();break;default:ct=u.getCell(u.getActiveCell().rowIndex,u.getActiveCell().colIndex)[0].className;ct.indexOf("e-table")<0?u.XLFilter.clearFilter():(c=u._getTableID(ct),u.XLFilter._clearFilterTable(u.getActiveSheetIndex(),parseInt(c),!0))}break;case u._id+"_Ribbon_insbtn":case u._id+"_Ribbon_inssbtn":if(tt=u.model.sheets[h]._selectedCells,tt.length<1)return;w=tt[0];b=tt[tt.length-1];switch(i.ID){case"InsertCells":u._getJSSheetRowHeaderContent(h).find(".e-rowselected").length?u.insertEntireRow(w,b):u._getJSSheetHeader(h).find(".e-colselected").length?(u._insDelStatus="insert",u.insertEntireColumn(w,b)):u._renderInsertDialog();break;case"InsertSheetRows":u.insertEntireRow(w,b);break;case"InsertSheetColumns":u._insDelStatus="insert";u.insertEntireColumn(w,b);break;case"InsertSheet":u.insertSheet();break;default:u.element.find(".e-rowselected").length>0?u.insertEntireRow(w,b):u.element.find(".e-colselected").length>0?(u._insDelStatus="insert",u.insertEntireColumn(w,b)):u.insertShiftBottom(w,b)}break;case u._id+"_Ribbon_delbtn":case u._id+"_Ribbon_delsbtn":if(tt=u.model.sheets[h]._selectedCells,tt.length<1)return;w=tt[0];b=tt[tt.length-1];switch(i.ID){case"DeleteCells":u._getJSSheetRowHeaderContent(h).find(".e-rowselected").length?u.deleteEntireRow(w,b,[]):u._getJSSheetHeader(h).find(".e-colselected").length?(u._insDelStatus="delete",u.deleteEntireColumn(w,b,[])):u._renderDeleteDialog();break;case"DeleteSheetRows":u.deleteEntireRow(w,b,[]);break;case"DeleteSheetColumns":u._insDelStatus="delete";u.deleteEntireColumn(w,b,[]);break;case"DeleteSheet":u.deleteSheet(h);break;default:u.element.find(".e-rowselected").length>0?u.deleteEntireRow(w,b):u.element.find(".e-colselected").length>0?(u._insDelStatus="insert",u.deleteEntireColumn(w,b)):u.deleteShiftUp(w,b)}break;case u._id+"_Ribbon_clear":s=it.selectedRange;switch(i.ID){case"Clear_All":s=u._getAlphaRange(h,s[0],s[1],s[2],s[3]);u.clearAll(s);break;case"Clear_Formats":s=u._getAlphaRange(h,s[0],s[1],s[2],s[3]);u.clearAllFormat(s);break;case"Clear_Contents":s=u._getAlphaRange(h,s[0],s[1],s[2],s[3]);u.clearContents(s);break;case"Clear_Comments":u.model.allowComments&&u.XLComment.deleteComment(r,"clear");break;default:u._removeHyperlink("clear")}u.XLSelection._clearBorder(u._arrayAsString(u._cutFocus),h);break;case u._id+"_Ribbon_pivotTable":if(li={sheetIndex:h,model:u.model.sheets},u._trigger("_createPivotTable",li))return;break;case u._id+"_Ribbon_charttype":n("#"+u._id+"_charttypedlg").ejDialog("open");break;case u._id+"_Ribbon_pictures":u._uploadImage=!0;n("#"+u._id+"_file .e-uploadinput").click();u.XLRibbon._toggleFormatTab();break;case u._id+"_Ribbon_namemanager":u.XLRibbon._openNameManagerDlg();break;case u._id+"_Ribbon_definename":bt=n("#"+u._id+"_nmgrid").data("ejGrid");bt.getContentTable().find("td").addClass("e-ss-emptyrecord");bt.model.dataSource.length<1?bt.getContentTable().find("td").addClass("e-ss-emptyrecord"):bt.getContentTable().find(".e-ss-emptyrecord").removeClass("e-ss-emptyrecord");n("#"+u._id+"_nmdlg").ejDialog("open");n("#"+u._id+"_nmgrid").ejGrid("instance").addRecord();n("#"+u._id+"_nmgridEditForm input")[0].focus();break;case u._id+"_Ribbon_fPane":switch(i.ID){case"freezePanes":u.XLFreeze.freezePanes(u.model.sheets[h]._activeCell);break;case"FreezeRow":u.XLFreeze.freezeTopRow();break;case"FreezeColumn":u.XLFreeze.freezeLeftColumn();break;case"unfreezePanes":u.XLFreeze.unfreezePanes()}break;case u._id+"_Ribbon_merge":t.isNullOrUndefined(i.ID)&&(u._mergeCenter=!0,u.mergeCells());switch(i.ID){case"MergeCells":u.mergeCells();break;case"MergeAcross":u.mergeAcrossCells();break;case"MergeAndCenter":u._mergeCenter=!0;u.mergeCells();break;case"UnmergeCells":u.unmergeCells()}break;case u._id+"_Ribbon_autosum":vt=it.selectedRange;u.XLRibbon.autoSum(i.ID.toUpperCase(),u._getAlphaRange(h,vt[0],vt[1],vt[2],vt[3]));break;case u._id+"_Ribbon_cElement":o=u.getSheet(h)._shapeMngr.chart[u.XLEdit.getPropertyValue(u.XLShape._picCellIdx.rowIndex,u.XLShape._picCellIdx.colIndex,"chart")[0]];g=document.getElementById(u._id+"_chart").value;e=n("#"+g).ejChart("instance");f={sheetIndex:h,reqType:"shape",shapeType:"chart",cid:g,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex};switch(i.ID){case"PHAxis":f.visibility=!e.model.primaryXAxis.visible;e.option("primaryXAxis",{visible:f.visibility});o.xAxis.visible=f.visibility;f.action=i.ID;break;case"PVAxis":f.visibility=!e.model.primaryYAxis.visible;e.option("primaryYAxis",{visible:f.visibility});o.yAxis.visible=f.visibility;f.action=i.ID;break;case"PHAxisTitle":u._cOpt.prev={text:o.xAxis.title.text};e.model.primaryXAxis.title.text.length!=0?(e.option("primaryXAxis",{title:{text:""}}),o.xAxis.title.text="",f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"PX",cid:g,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,prev:{text:u._cOpt.prev.text},cur:{text:""}},u._completeAction(f)):(u._hasTitle="PX",document.getElementById(u._id+"_chartname").value=o.xAxis.title.text,n("#"+u._id+"_chartnamedlg").ejDialog("open"),n("#"+u._id+"_chartname").focus().setInputPos(o.xAxis.title.text.length),u._cOpt={prevText:o.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"PVAxisTitle":u._cOpt.prev={text:o.yAxis.title.text};e.model.primaryYAxis.title.text.length!=0?(e.option("primaryYAxis",{title:{text:""}}),o.yAxis.title.text="",f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"PY",cid:g,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,prev:{text:u._cOpt.prev.text},cur:{text:""}},u._completeAction(f)):(u._hasTitle="PY",document.getElementById(u._id+"_chartname").value=o.yAxis.title.text,n("#"+u._id+"_chartnamedlg").ejDialog("open"),n("#"+u._id+"_chartname").focus().setInputPos(o.yAxis.title.text.length),u._cOpt={prevText:o.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"CTNone":u._cOpt.prev={text:o.title.text};e.model.title.text.length&&(e.option("title",{text:""}),o.title.text="",f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"CT",cid:g,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,prev:{text:u._cOpt.prev.text},cur:{text:""}},u._completeAction(f));break;case"CTCenter":u._hasTitle="CT";u._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(u._id+"_chartname").value=o.title.text;n("#"+u._id+"_chartnamedlg").ejDialog("open");n("#"+u._id+"_chartname").focus().setInputPos(o.title.text.length);e.option("title",{textAlignment:"center"});u._cOpt.curAlign=e.model.title.textAlignment;o.title.align="center";break;case"CTFar":u._hasTitle="CT";u._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(u._id+"_chartname").value=o.title.text;n("#"+u._id+"_chartnamedlg").ejDialog("open");n("#"+u._id+"_chartname").focus().setInputPos(o.title.text.length);e.option("title",{textAlignment:"far"});u._cOpt.curAlign=e.model.title.textAlignment;o.title.align="far";break;case"CTNear":u._hasTitle="CT";u._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(u._id+"_chartname").value=o.title.text;n("#"+u._id+"_chartnamedlg").ejDialog("open");n("#"+u._id+"_chartname").focus().setInputPos(o.title.text.length);e.option("title",{textAlignment:"near"});u._cOpt.curAlign=e.model.title.textAlignment;o.title.align="near";break;case"DLNone":for(k=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},si=e.model.series[0].marker.dataLabel.visible?!1:!0,a=0;a<e.model.series.length;a++)k.push({marker:{dataLabel:{visible:si,verticalTextAlignment:"far",textPosition:"top"}}});e.option({series:k});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:si};break;case"DLCenter":for(k=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},a=0;a<e.model.series.length;a++)k.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"center",textPosition:"middle"}}});e.option({series:k});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"center",tPosn:"middle"};break;case"DLIBase":for(k=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},a=0;a<e.model.series.length;a++)k.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"far",textPosition:"bottom"}}});e.option({series:k});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"far",tPosn:"bottom"};break;case"DLIEnd":for(k=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},a=0;a<e.model.series.length;a++)k.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"near",textPosition:"top"}}});e.option({series:k});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"near",tPosn:"top"};break;case"DLOEnd":for(k=[],f.action="DL",f.prev={series:n.extend(!0,[],e.model.series)},a=0;a<e.model.series.length;a++)k.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"far",textPosition:"top"}}});e.option({series:k});f.cur={series:n.extend(!0,[],e.model.series)};o.dataLabel={visible:!0,vAlign:"far",tPosn:"top"};break;case"PMajorH":f.visibility=!e.model.primaryYAxis.majorGridLines.visible;e.option("primaryYAxis",{majorGridLines:{visible:f.visibility}});o.yAxis.majorGridLines={visible:f.visibility};f.action=i.ID;break;case"PMajorV":f.visibility=!e.model.primaryXAxis.majorGridLines.visible;e.option("primaryXAxis",{majorGridLines:{visible:f.visibility}});o.xAxis.majorGridLines={visible:f.visibility};f.action=i.ID;break;case"PMinorH":f.visibility=!e.model.primaryYAxis.minorGridLines.visible;e.option("primaryYAxis",{minorGridLines:{visible:f.visibility},minorTicksPerInterval:5,minorTickLines:{visible:f.visibility}});o.yAxis.minorGridLines={visible:f.visibility};f.action=i.ID;break;case"PMinorV":f.visibility=!e.model.primaryXAxis.minorGridLines.visible;e.option("primaryXAxis",{minorGridLines:{visible:f.visibility},minorTicksPerInterval:5,minorTickLines:{visible:f.visibility}});o.xAxis.minorGridLines={visible:f.visibility};f.action=i.ID;break;case"LNone":f.visibility=!e.model.legend.visible;e.option("legend",{visible:f.visibility});o.legend.visible=f.visibility;f.action=i.ID;break;case"LLeft":f.prev={position:e.model.legend.position};e.option("legend",{position:"left",visible:!0});o.legend.position="left";f.cur={position:e.model.legend.position};f.action="Legend";break;case"LRight":f.prev={position:e.model.legend.position};e.option("legend",{position:"right",visible:!0});o.legend.position="right";f.cur={position:e.model.legend.position};f.action="Legend";break;case"LBottom":f.prev={position:e.model.legend.position};e.option("legend",{position:"bottom",visible:!0});o.legend.position="bottom";f.cur={position:e.model.legend.position};f.action="Legend";break;case"LTop":f.prev={position:e.model.legend.position};e.option("legend",{position:"top"});o.legend.position="top";f.cur={position:e.model.legend.position};f.action="Legend"}t.isNullOrUndefined(f.action)||u._completeAction(f);break;case u._id+"_Ribbon_chartwidth":u.XLRibbon._changeChartSize("height",i.value);break;case u._id+"_Ribbon_chartheight":u.XLRibbon._changeChartSize("width",i.value);break;case u._id+"_Ribbon_srcolumn":g=document.getElementById(u._id+"_chart").value;e=n("#"+g).ejChart("instance");o=u.XLChart._getShapeObj(g,"chart");f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"srcolumn",cid:g,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex};e.model.series.length=0;o.isRowColSwitched=!o.isRowColSwitched;yt={xRange:o.xRange,yRange:o.yRange,lRange:o.lRange,isRowColSwitched:o.isRowColSwitched,dataSheetIdx:o.dataSheetIdx};ot=u.XLChart._processChartSeries(yt);e.option({series:ot.series});u.getActiveSheetIndex()===o.dataSheetIdx&&u.XLChart._focusChartRange(ot.xRange,ot.yRange,ot.lRange);o.xAxis.range=ot.xRange;o.yAxis.range=ot.yRange;o.legend.range=ot.lRange;u._completeAction(f);break;case u._id+"_Ribbon_PictureColor":case u._id+"_Ribbon_pictureborder":if(["weight","dashes",u._id+"picturecolor",""].indexOf(i.ID)===-1){y=u.element.find(".e-ss-activeimg");ht=new RegExp("\\be-shapebdr.*?\\b","g");v=y[0].className.match(ht)?u.XLShape._getImgStyleFromHashCode(y[0].className.match(ht)[0]):{"border-color":"transparent","border-width":"1px","border-style":"solid"};var hi=v["border-color"],bi=v["border-width"],v=v["border-style"];if(y[0]){switch(!0){case this._id.indexOf("PictureColor")>-1:hi=i.value;break;case i.ID.indexOf("px")>-1:bi=i.ID;break;case i.ID==="nooutline":hi="transparent";break;default:v=i.ID}u.XLShape._updateImgBorder(y[0],bi,v,hi)}}break;case u._id+"_Ribbon_resetpic":y=u.element.find(".e-ss-activeimg");ht=new RegExp("\\be-shapebdr.*?\\b","g");f={sheetIndex:h,reqType:"shape",shapeType:"picture",action:"resetpic",id:n(y).attr("id"),actionType:i.ID};u._dupDetails=!0;t.isNullOrUndefined(y[0].className.match(ht))||(imgStyle=u.XLShape._getImgStyleFromHashCode(y[0].className.match(ht)[0]));f.prev={bcolor:imgStyle["border-color"],bstyle:imgStyle["border-style"],bwidth:imgStyle["border-width"]};y[0].className=y[0].className.replace(ht,"");f.cur={bcolor:y.css("border-color"),bstyle:y.css("border-style"),bwidth:y.css("border-width")};y[0].className=y[0].className+" "+u.XLShape._getImgBorderHashCode({"border-color":f.cur.bcolor,"border-style":f.cur.bstyle,"border-width":f.cur.bwidth});i.ID!=="resetpicture"&&(f.prev.width=y.css("width"),f.prev.height=y.css("height"),y.css({width:u.model.pictureSettings.width,height:u.model.pictureSettings.height}),f.cur.width=y.css("width"),f.cur.height=y.css("height"),u.XLShape._updateShapeObj(y[0]),u.XLRibbon._formatTabUpdate());u._dupDetails=!1;u._completeAction(f);break;case u._id+"_Ribbon_changepic":u._uploadImage=!0;u.XLShape._changePicture=!0;u.element.find("#"+u._id+"_file .e-uploadinput").click();u.XLRibbon._toggleFormatTab();break;case u._id+"_Ribbon_selectData":g=document.getElementById(u._id+"_chart").value;o=u.XLChart._getShapeObj(g,"chart");n("#"+u._id+"_crxaxis").val(o.xRange?u._getAlphaRange(h,o.xRange[0],o.xRange[1],o.xRange[2],o.xRange[3]):"");n("#"+u._id+"_cryaxis").val(o.yRange?u._getAlphaRange(h,o.yRange[0],o.yRange[1],o.yRange[2],o.yRange[3]):"");n("#"+u._id+"_crlaxis").val(o.lRange?u._getAlphaRange(h,o.lRange[0],o.lRange[1],o.lRange[2],o.lRange[3]):"");u._selectDataval={xRange:n("#"+u._id+"_crxaxis").val(),yRange:n("#"+u._id+"_cryaxis").val(),lRange:n("#"+u._id+"_crlaxis").val()};n("#"+u._id+"_chartrangedlg").ejDialog("open");n("#"+u._id+"_crxaxis").focus().setInputPos(0);break;case u._id+"_Ribbon_chartTheme":kt=u.element.find("#"+u._id+"_chart").val();f={sheetIndex:h,reqType:"shape",action:"chartTheme"};f.prev={theme:n("#"+kt).data("ejChart").model.theme};this.selectedTextValue.indexOf("Dark")>-1?n("#"+kt).addClass("e-ss-charttheme"):n("#"+kt).removeClass("e-ss-charttheme");u.XLChart.refreshChart(kt,{theme:this._selectedValue});f.cur={theme:this._selectedValue};u._completeAction(f)}}},_changeChartSize:function(t,i){var r=this.XLObj,h,o=r.XLEdit.getPropertyValue(r.XLShape._picCellIdx.rowIndex,r.XLShape._picCellIdx.colIndex,"chart")[0],f=document.getElementById(r._id+"_chart").value,u=n("#"+f).ejChart("instance"),s=n("#"+f),e={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:t,cid:f,rowIndex:r.XLShape._picCellIdx.rowIndex,colIndex:r.XLShape._picCellIdx.colIndex,prev:{width:u.model.size.width,height:u.model.size.height}};h=u.model.size;t==="height"?(u.option("size",{width:i.toString()}),o.width=i,s[0].style.width=i+"px",e.cur={width:i.toString(),height:u.model.size.height}):(u.option("size",{height:i.toString()}),o.height=i,s[0].style.height=i+"px",e.cur={width:u.model.size.width,height:i.toString()});r._completeAction(e)},_updateBordeStyle:function(n){var t=this.XLObj;t._borderStyle=n.ID&&n.ID.length>0&&n.ID},_colorPickerHandler:function(t,i){var u,r=this.XLObj,f;i.type==="open"?(n("#"+r._id+"_"+t+"_popup").find(".e-buttons, .e-button").hide(),n("#"+r._id+"_"+t+"_popup").focus()):i.type==="change"&&(u=r.XLFormat,f=n("#"+r._id+"_"+t).data("ejColorPicker"),t==="Ribbon_color"?(u.format({style:{color:i.value}}),n("#"+r._id+"_Ribbon_home_Font_Color").find(".e-selected-color").css("background-color",i.value)):(u.format({style:{"background-color":i.value}}),n("#"+r._id+"_Ribbon_home_Font_Background").find(".e-selected-color").css("background-color",i.value)),f.hide(),f.setValue(i.value))},updateRibbonIcons:function(){this._updateRibbonIcons()},_updateRibbonIcons:function(){if(this.XLObj.model.showRibbon){var i=this.XLObj,e=n("#"+i._id+"_Ribbon_cellformat").data("ejDropDownList"),o=n("#"+i._id+"_Ribbon_fontsize").data("ejDropDownList");n("#"+i._id+"_Ribbon_fontsize").css("width","auto");var s=n("#"+i._id+"_Ribbon_font-family").data("ejDropDownList"),u=-1,f,l=n("#"+i._id+"_Ribbon").data("ejRibbon");switch(l.getTabText(l.model.selectedItemIndex)){case"HOME":var y=i.getActiveSheetIndex(),a=i.getSheet(y),h=n(i.getCell(a._activeCell.rowIndex,a._activeCell.colIndex)),c=i.XLEdit.getPropertyValueByElem(h,"wrap"),p=i.XLEdit.getPropertyValueByElem(h,"isMerge"),r=!t.isNullOrUndefined(i.XLFormat)&&i.XLFormat.getFormatFromHashCode(i.XLFormat.getFormatClass(h[0].className)),v=i.XLEdit.getPropertyValueByElem(h,"type");i.isUndefined(c)&&(c=!1);n("#"+i._id+"_Ribbon_wraptext").ejToggleButton("option",{toggleState:c});p?(n("#"+i._id+"_Ribbon_merge").addClass("e-ss-active"),n("#"+i._id+"_Ribbon_mergedrpbtn").addClass("e-ss-active")):(n("#"+i._id+"_Ribbon_merge").removeClass("e-ss-active"),n("#"+i._id+"_Ribbon_mergedrpbtn").removeClass("e-ss-active"));v&&this._numberFormat.some(function(n,t){return v===n.text.toLowerCase()?(u=t,!0):!1});t.isNullOrUndefined(e)||(e._initValue=!0,u>-1?e.option({selectedItemIndex:u}):!t.isNullOrUndefined(e.selectedIndexValue)&&e.selectedIndexValue!=0&&e.option({selectedItemIndex:0}),e._initValue=!1);r&&(t.isNullOrUndefined(r["font-size"])?u=-1:this._fontSize.some(function(n,t){return r["font-size"]===n.value?(u=t,!0):!1}),o._initValue=!0,u>-1?o.option({selectedItemIndex:u})||(u=-1):!t.isNullOrUndefined(o.selectedIndexValue)&&o.selectedIndexValue!=3&&o.option({selectedItemIndex:3}),o._initValue=!1,t.isNullOrUndefined(r["font-family"])?u=-1:this._fontFamily.some(function(n,t){return r["font-family"]===n.text.toLowerCase()?(u=t,!0):!1}),s._initValue=!0,u>-1?s.option({selectedItemIndex:u}):!t.isNullOrUndefined(s.selectedIndexValue)&&s.selectedIndexValue!=6&&s.option({selectedItemIndex:6}),s._initValue=!1,r["font-weight"]=="bold"?n("#"+i._id+"_Ribbon_bold").data("ejToggleButton").option("toggleState",!0):n("#"+i._id+"_Ribbon_bold").data("ejToggleButton").option("toggleState",!1),r["font-style"]=="italic"?n("#"+i._id+"_Ribbon_italic").data("ejToggleButton").option("toggleState",!0):n("#"+i._id+"_Ribbon_italic").data("ejToggleButton").option("toggleState",!1),r["text-decoration"]=r["text-decoration"]||"",n("#"+i._id+"_Ribbon_underline").data("ejToggleButton").option("toggleState",r["text-decoration"].indexOf("underline")!==-1),n("#"+i._id+"_Ribbon_line-through").data("ejToggleButton").option("toggleState",r["text-decoration"].indexOf("line-through")!==-1),f=n(i.element).find(".e-text-align"),t.isNullOrUndefined(f[0])||(n("#"+f[0].id).data("ejToggleButton").option("toggleState",!1)||f.removeClass("e-text-align")),t.isNullOrUndefined(r["text-align"])||(n("#"+i._id+"_Ribbon_"+r["text-align"]).data("ejToggleButton").option("toggleState",!0)||n("#"+i._id+"_Ribbon_"+r["text-align"]).addClass("e-text-align")),f=n(i.element).find(".e-vertical-align"),t.isNullOrUndefined(f[0])||(n("#"+f[0].id).data("ejToggleButton").option("toggleState",!1)||f.removeClass("e-vertical-align")),t.isNullOrUndefined(r["vertical-align"])?n("#"+i._id+"_Ribbon_bottom").data("ejToggleButton").option("toggleState",!0)||n("#"+i._id+"_Ribbon_bottom").addClass("e-vertical-align"):n("#"+i._id+"_Ribbon_"+r["vertical-align"]).data("ejToggleButton").option("toggleState",!0)||n("#"+i._id+"_Ribbon_"+r["vertical-align"]).addClass("e-vertical-align"));break;case"REVIEW":!i.model.allowComments||i.XLComment._isCommentEdit||i.XLEdit._isEdit||i._isSheetRename||i.XLComment._updateCmntRibIcons(i.getActiveCellElem())}}},_disableButtons:function(n,i){for(var u,e=this.XLObj,r=0,f=n.length;r<f;r++)u=e.element.find("#"+e._id+"_Ribbon_"+n[r]),u.length&&!t.isNullOrUndefined(u.data(i))&&u.data(i).disable()},_enableButtons:function(n,i){for(var u,e=this.XLObj,r=0,f=n.length;r<f;r++)u=e.element.find("#"+e._id+"_Ribbon_"+n[r]),u.length&&!t.isNullOrUndefined(u.data(i))&&u.data(i).enable()},_disableInputs:function(t,i){for(var r=0,u=t.length;r<u;r++)n("#"+this.XLObj._id+"_"+t[r]).attr("disabled",i)},_enableRibbonIcons:function(){if(this.XLObj.model.showRibbon){var t=this.XLObj,i=n("#"+t._id+"_Ribbon").data("ejRibbon");switch(i.getTabText(i.model.selectedItemIndex)){case"HOME":this._enableButtons(this._homeBtnIds,"ejButton");this._enableButtons(this._toggleBtnIds,"ejToggleButton");this._enableButtons(this._ddIds,"ejDropDownList");this._enableButtons(this._cpIds,"ejColorPicker");this._enableButtons(this._splitBtnIds,"ejSplitButton");this._enableButtons(this._homeSptBtnIds,"ejSplitButton");break;case"INSERT":this._enableButtons(this._insertBtnIds,"ejButton");this._enableButtons(this._insertSptBtnIds,"ejSplitButton");break;case"DATA":this._enableButtons(this._dataBtnIds,"ejButton");this._enableButtons(this._dataSptBtnIds,"ejSplitButton");break;case"PAGE LAYOUT":this._enableButtons(this._pageLaySptBtnIds,"ejSplitButton");this._enableButtons(this._pageLayBtnIds,"ejButton");this._enableButtons(this._pageLayChckBxIds,"ejCheckBox");n("#"+i._id+"_pagesetup_viewhdrlbl").eq(0).removeClass("e-disable");n("#"+i._id+"_pagesetup_viewgrdlnlbl").eq(0).removeClass("e-disable");break;case"FORMULAS":this._enableButtons(this._formulaBtnIds,"ejButton");this._enableButtons(this._formulaSptBtnIds,"ejSplitButton");break;case"REVIEW":t.model.allowComments&&!t.XLComment._isCommentEdit&&t.XLComment._updateCmntRibIcons();break;case"OTHERS":this._enableButtons(this._othersSptBtnIds,"ejSplitButton");this._enableButtons(this._othersBtnIds,"ejButton");break;case t._getLocStr("Design"):this._enableButtons(this._contextualBtnIds,"ejButton");this._enableButtons(this._contextualCheckBoxIds,"ejCheckBox");this._disableInputs(this._contextualInputIds,!1)}t.XLClipboard._copyBackup.cells||(t.XLRibbon._disableButtons(["pastebtn"],"ejButton")||t.XLRibbon._disableButtons(["pastesbtn"],"ejSplitButton"));t._updateUndoRedoIcons()}},_disableRibbonIcons:function(){if(this.XLObj.model.showRibbon){var t=n("#"+this.XLObj._id+"_Ribbon").data("ejRibbon");switch(t.getTabText(t.model.selectedItemIndex)){case"HOME":this._disableButtons(this._homeBtnIds,"ejButton");this._disableButtons(this._toggleBtnIds,"ejToggleButton");this._disableButtons(this._ddIds,"ejDropDownList");this._disableButtons(this._cpIds,"ejColorPicker");this._disableButtons(this._splitBtnIds,"ejSplitButton");this._disableButtons(this._homeSptBtnIds,"ejSplitButton");break;case"INSERT":this._disableButtons(this._insertBtnIds,"ejButton");this._disableButtons(this._insertSptBtnIds,"ejSplitButton");break;case"DATA":this._disableButtons(this._dataBtnIds,"ejButton");this._disableButtons(this._dataSptBtnIds,"ejSplitButton");break;case"PAGE LAYOUT":this._disableButtons(this._pageLaySptBtnIds,"ejSplitButton");this._disableButtons(this._pageLayBtnIds,"ejButton");this._disableButtons(this._pageLayChckBxIds,"ejCheckBox");n("#"+t._id+"_pagesetup_viewhdrlbl").eq(0).addClass("e-disable");n("#"+t._id+"_pagesetup_viewgrdlnlbl").eq(0).addClass("e-disable");break;case"FORMULAS":this._disableButtons(this._formulaBtnIds,"ejButton");this._disableButtons(this._formulaSptBtnIds,"ejSplitButton");break;case"REVIEW":this._disableButtons(this._cmntBtnIds,"ejButton");this._disableButtons(this._cmntTglBtnIds,"ejToggleButton");break;case"OTHERS":this._disableButtons(this._othersSptBtnIds,"ejSplitButton");this._disableButtons(this._othersBtnIds,"ejButton");break;case this.XLObj._getLocStr("Design"):this._disableButtons(this._contextualBtnIds,"ejButton");this._disableButtons(this._contextualCheckBoxIds,"ejCheckBox");this._disableInputs(this._contextualInputIds,!0)}}},_capitalize:function(n){return n[0].toUpperCase()+n.slice(1)},_generateToggleBtn:function(i,r,u,f,e,o,s,h,c,l){return{id:i,toolTip:this.XLObj._getLocStr(r),type:t.Ribbon.type.toggleButton,enableSeparator:c,toggleButtonSettings:{width:o,height:s,contentType:u,cssClass:l,defaultPrefixIcon:f,activePrefixIcon:f,defaultText:this.XLObj._getLocStr(r),activeText:this.XLObj._getLocStr(r),click:n.proxy(this._ribbonClickHandler)},customToolTip:{title:this.XLObj._getLocStr(e),content:"<h6>"+this.XLObj._getLocStr(h)+"<\/h6>"}}},_generateBtn:function(i,r,u,f,e,o,s,h,c,l,a){return{id:i,text:this.XLObj._getLocStr(r),toolTip:this.XLObj._getLocStr(r),cssClass:a,enableSeparator:c,type:t.Ribbon.type.button,buttonSettings:{contentType:u,width:e,height:o,imagePosition:l=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,prefixIcon:f,click:n.proxy(this._ribbonClickHandler)},customToolTip:{title:this.XLObj._getLocStr(s),content:"<h6>"+this.XLObj._getLocStr(h)+"<\/h6>"}}},_generateDD:function(i,r,u,f,e,o,s,h){return{id:i,text:this.XLObj._getLocStr(r),toolTip:this.XLObj._getLocStr(r),type:t.Ribbon.type.dropDownList,dropdownSettings:{dataSource:u,value:f,popupHide:n.proxy(this._ribbonClickHandler),width:e,height:o-1},customToolTip:{title:this.XLObj._getLocStr(s),content:"<h6>"+this.XLObj._getLocStr(h)+"<\/h6>"}}},_generateCustomControl:function(i,r,u,f){return{type:t.Ribbon.type.custom,contentID:i,toolTip:this.XLObj._getLocStr(r),click:n.proxy(this._ribbonClickHandler),change:n.proxy(this._ribbonClickHandler),customToolTip:{title:this.XLObj._getLocStr(u),content:"<h6>"+this.XLObj._getLocStr(f)+"<\/h6>"}}},_generateSplitBtn:function(i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){return{id:i,toolTip:this.XLObj._getLocStr(r),text:this.XLObj._getLocStr(r),type:t.Ribbon.type.splitButton,cssClass:y,enableSeparator:s,splitButtonSettings:{contentType:u,targetID:f,arrowPosition:l=="bottom"?t.ArrowPosition.Bottom:t.ArrowPosition.Right,imagePosition:a=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,buttonMode:v=="dropdown"?t.ButtonMode.Dropdown:t.ButtonMode.Split,fields:e,prefixIcon:o,click:n.proxy(this._ribbonClickHandler),itemSelected:n.proxy(this._ribbonClickHandler),height:c,width:h,beforeOpen:n.proxy(this._splitBeforeOpen,this,i),close:i==="inssbtn"||i==="delsbtn"||i==="validationsbtn"||i==="pastesbtn"?n.proxy(this._splitbtnClose,this,i):null},customToolTip:{title:this.XLObj._getLocStr(p),content:"<h6>"+this.XLObj._getLocStr(w)+"<\/h6>"}}},_splitBeforeOpen:function(n,t){var i=this.XLObj;n==="sortfilter"?this._sfbeforeOpen(t):n==="inssbtn"||n==="delsbtn"?this._insdelbeforOpen(t):n==="fPane"?this._fpbeforeOpen(t):n==="cElement"?this._celementpbeforeOpen(t):(n==="validationsbtn"||n==="pastesbtn")&&this._validpasteOpen(t)},_splitbtnClose:function(n){this.XLObj.element.find("#"+this.XLObj._id+"_Ribbon_"+n).parents("div.e-controlpadding").siblings().children("button").removeClass("e-active")},_fpbeforeOpen:function(){var t=this.XLObj,r=t.getActiveSheetIndex(),u=n("#"+t._id+"_Ribbon_FPane").data("ejMenu"),i=u.model.fields.dataSource.slice(0);t.getFrozenRows(r)>0||t.getFrozenColumns(r)>0?(i[0].id="unfreezePanes",i[0].text=t._getLocStr("unfreezePanes")):(i[0].id="freezePanes",i[0].text=t._getLocStr("freezePanes"));u.option("fields",{id:"id",dataSource:i,parentId:"parentId"})},_sfbeforeOpen:function(){var t=this.XLObj,i=n("#"+t._id+"_Ribbon_SortFilter").data("ejMenu"),r;r=t.getCell(t.getActiveCell().rowIndex,t.getActiveCell().colIndex)[0];t.model.allowFiltering||i.disableItemByID("Filter");t.model.allowSorting||(i.disableItemByID("SortAtoZ"),i.disableItemByID("SortZtoA"));this._changeClrFltrStatus(i,"menu",r)},_validpasteOpen:function(n){var t=this.XLObj;n.model.targetID===t._id+"_Ribbon_Validation"?t.element.find("#"+t._id+"_Ribbon_validationbtn").addClass("e-active"):t.element.find("#"+t._id+"_Ribbon_pastebtn").addClass("e-active")},_insdelbeforOpen:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_Ins").data("ejMenu"),u=n("#"+i._id+"_Ribbon_Del").data("ejMenu");t.model.targetID===i._id+"_Ribbon_Ins"?i.element.find("#"+i._id+"_Ribbon_insbtn").addClass("e-active"):i.element.find("#"+i._id+"_Ribbon_delbtn").addClass("e-active");i.element.find(".e-colselected").length?(r.disableItemByID("InsertSheetRows"),u.disableItemByID("DeleteSheetRows")):(r.enableItemByID("InsertSheetRows"),u.enableItemByID("DeleteSheetRows"));i.element.find(".e-rowselected").length?(r.disableItemByID("InsertSheetColumns"),u.disableItemByID("DeleteSheetColumns")):(r.enableItemByID("InsertSheetColumns"),u.enableItemByID("DeleteSheetColumns"))},_celementpbeforeOpen:function(){var t=this.XLObj;for(chartEle=n("#"+t._id+"_chart").val(),chType=t.XLChart._getShapeObj(chartEle,"chart").type,cEleMenuObj=n("#"+t._id+"_Ribbon_CElement").data("ejMenu"),pieChart=["Axes","AxisTitle","Gridline"],radarChart=["AxisTitle","PMinorH","PMinorV"],menuEle=["Axes","AxisTitle","Gridline","PMinorH","PMinorV"],i,len=0,i=0,len=menuEle.length;i<len;i++)cEleMenuObj.enableItemByID(menuEle[i]);if(chType==="pie"||chType==="doughnut")for(i=0,len=pieChart.length;i<len;i++)cEleMenuObj.disableItemByID(pieChart[i]);else if(chType==="radar")for(i=0,len=radarChart.length;i<len;i++)cEleMenuObj.disableItemByID(radarChart[i])},_changeClrFltrStatus:function(n,t,i){var f=this.XLObj,s=f.getActiveSheetIndex(),e=!1,u,r,o;for(t==="menu"?n.disableItemByID("ClearFilter"):n.disable(),i.className.indexOf("e-table")<0&&(e=!0),u=f._getContent(s).find("span.e-ssfiltered, span.e-ssfiltered-asc, span.e-ssfiltered-dsc"),r=0,o=u.length;r<o;r++)if(e){if(u[r].className.indexOf("e-ft")<0){t==="menu"?n.enableItemByID("ClearFilter"):n.enable();break}}else if(u[r].className.indexOf("e-ft")>0){t==="menu"?n.enableItemByID("ClearFilter"):n.enable();break}},_onControlCreated:function(){var u,f,i=this.XLObj,t=i._id,r={height:154,width:163,text:i._getLocStr("BlankWorkbook"),contentType:"textandimage",imagePosition:"imagetop",prefixIcon:"e-ss-blank",click:n.proxy(this._bSBtnClickHandler)};u=(i.isNumber(i.model.scrollSettings.height)?i.model.scrollSettings.height:i.element.height())-(n("#"+t+"_Ribbon").height()-i.element.find(".e-ribbon .e-content").eq(0).height()+i._formulaHeight)-40;f=i.isNumber(i.model.scrollSettings.width)?i.model.scrollSettings.width-40:i.element.width()-40;n("#"+t+"_bstab_new_blank").ejButton(r);delete r.text;r.height=r.width=72;r.prefixIcon="e-ss-exportxl";n("#"+t+"_bstab_saveas_excel").ejButton(r);r.prefixIcon="e-ss-exportcsv";n("#"+t+"_bstab_saveas_csv").ejButton(r);r.prefixIcon="e-ss-print";n("#"+t+"_bstab_print_sheet").ejButton(r);r.prefixIcon="e-ss-printselected";n("#"+t+"_bstab_print_selected").ejButton(r);this._hideRibbonElem();n("#"+t+"_Ribbon_background-color").ejColorPicker({value:"#FFFF00",modelType:"palette",showSwitcher:!1,cssClass:"e-ss-colorpicker",toolIcon:"e-ss-backgroundcolor",open:n.proxy(this._colorPickerHandler,this,"Ribbon_background-color"),change:n.proxy(this._colorPickerHandler,this,"Ribbon_background-color"),select:n.proxy(this._cpClickHandler,this,"Ribbon_background-color")});n("#"+t+"_Ribbon_color").ejColorPicker({value:"#FF0000",modelType:"palette",showSwitcher:!1,cssClass:"e-ss-colorpicker",toolIcon:"e-ss-fontcolor",open:n.proxy(this._colorPickerHandler,this,"Ribbon_color"),change:n.proxy(this._colorPickerHandler,this,"Ribbon_color"),select:n.proxy(this._cpClickHandler,this,"Ribbon_color")});n("#"+t+"_Ribbon_BorderColor").ejColorPicker({modelType:"palette",presetType:"basic",cssClass:"e-ss-colorpicker e-ss-menuclrpkr",change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_BorderColorWrapper").hide();n("#"+t+"_Ribbon_BorderColor_popup").css({"padding-left":"10px",width:"197px",display:"block"});n("#"+t+"_Ribbon_BorderCP").ejColorPicker({value:"#278787",displayInline:!0,modelType:"picker"});n("#"+t+"_Ribbon_BorderCP_Presets").hide();n("#"+t+"_Ribbon_Border").width(200);n("#"+t+"_CFormat").width(200);n("#"+t+"_Ribbon_Border").addClass("e-spreadsheet e-border");n("#"+t+"_Ribbon_color_Presets").css("width","119px");n("#"+t+"_Ribbon_background-color_Presets").css("width","119px");n("#"+t+"_Ribbon_pagesetupleft").show();n("#"+t+"_Ribbon_Vheading").ejCheckBox({change:n.proxy(this._ribbonClickHandler),checked:!0});n("#"+t+"_Ribbon_Vgridlines").ejCheckBox({change:n.proxy(this._ribbonClickHandler),checked:!0});n("#"+t+"_Ribbon_tsofirstcolumn").ejCheckBox({change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_tsolastcolumn").ejCheckBox({change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_tsototalrow").ejCheckBox({change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_tsofiltercolumn").ejCheckBox({change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_chartwidth").ejNumericTextbox({name:"numeric",value:5,minValue:0,maxValue:f,decimalPlaces:1,incrementStep:5,change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_chartheight").ejNumericTextbox({name:"numeric",value:5,minValue:0,maxValue:u,decimalPlaces:1,incrementStep:5,change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_pictureheight").ejNumericTextbox({name:"numeric",value:100,minValue:25,incrementStep:5,change:n.proxy(this._pictureSizeChange,this,"picturewidth")});n("#"+t+"_picturewidth").ejNumericTextbox({name:"numeric",value:100,minValue:25,incrementStep:5,change:n.proxy(this._pictureSizeChange,this,"pictureheight")});n("#"+t+"_Ribbon_PictureColor").ejColorPicker({modelType:"palette",presetType:"basic",cssClass:"e-ss-colorpicker e-ss-menuclrpkr",change:n.proxy(this._ribbonClickHandler)});n("#"+t+"_Ribbon_PictureColorWrapper").hide();n("#"+t+"_Ribbon_PictureColor_popup").css({"padding-left":"10px",width:"197px",display:"block"});!i.model.allowInsert&&i.model.scrollSettings.allowScrolling&&(this._disableButtons(["inssbtn"],"ejSplitButton"),this._disableButtons(["insbtn"],"ejButton"));!i.model.allowDelete&&i.model.scrollSettings.allowScrolling&&(this._disableButtons(["delsbtn"],"ejSplitButton"),this._disableButtons(["delbtn"],"ejButton"));n("#"+t+"_Ribbon_Validation").width(160);this._disableButtons(["pastebtn"],"ejButton");this._disableButtons(["pastesbtn","useinformula"],"ejSplitButton");n("#"+t+"_Ribbon_background-color_popup").find(".e-buttons, .e-button").hide();n("#"+t+"_Ribbon_color_popup").find(".e-buttons, .e-button").hide()},_hideRibbonElem:function(){var i=this.XLObj,u=n("#"+i._id+"_Ribbon").ejRibbon("instance"),t=i.model,r=u.element;t.allowAutoSum||t.allowFiltering||t.allowUndoRedo||t.allowSorting||t.allowClipboard||t.allowFormatPainter||t.allowCellFormatting||t.allowMerging||t.allowWrap||t.allowConditionalFormats||t.allowFormatAsTable||u.hideTab("HOME");t.allowFormatAsTable||t.allowPictures||t.allowHyperlink||t.allowCharts||u.hideTab("INSERT");t.allowDataValidation||t.allowFiltering||t.allowSorting||u.hideTab("DATA");t.allowPrinting||u.hideTab("PAGELAYOUT");t.allowComments||u.hideTab("REVIEW");t.allowFreezing||t.allowInsert||t.allowDelete||t.allowSearching||u.hideTab("OTHERS");t.allowClipboard||t.allowFormatPainter?t.allowFormatPainter?t.allowClipboard||(r.find("#"+i._id+"_Ribbon_home_Clipboard_1").hide(),r.find("#"+i._id+"_Ribbon_home_Clipboard_cut").hide(),r.find("#"+i._id+"_Ribbon_home_Clipboard_copy").hide()):r.find("#"+i._id+"_Ribbon_home_Clipboard_formatpainter").hide():r.find("#"+i._id+"_Ribbon_home_Clipboard").hide();t.allowCellFormatting||(r.find("#"+i._id+"_Ribbon_home_Font").hide(),r.find("#"+i._id+"_Ribbon_home_Number").hide(),r.find("#"+i._id+"_Ribbon_home_Alignment_top").hide(),r.find("#"+i._id+"_Ribbon_home_Alignment_middle").hide(),r.find("#"+i._id+"_Ribbon_home_Alignment_bottom").hide(),r.find("#"+i._id+"_Ribbon_separator_bottom").hide(),r.find("#"+i._id+"_Ribbon_home_Alignment_left").hide(),r.find("#"+i._id+"_Ribbon_home_Alignment_center").hide(),r.find("#"+i._id+"_Ribbon_home_Alignment_right").hide(),r.find("#"+i._id+"_Ribbon_separator_right").hide(),r.find("#"+i._id+"_Ribbon_home_Styles_cellstyles").hide(),t.allowConditionalFormats||t.allowFormatAsTable||r.find("#"+i._id+"_Ribbon_home_Styles").hide());t.allowCellFormatting&&(t.formatSettings.allowFontFamily||r.find("#"+i._id+"_Ribbon_home_Font_font-family").hide(),t.formatSettings.allowDecimalPlaces||(r.find("#"+i._id+"_Ribbon_home_Number_increment").hide(),r.find("#"+i._id+"_Ribbon_home_Number_decrement").hide(),r.find("#"+i._id+"_Ribbon_separator_usegrouping").hide()),t.formatSettings.allowCellBorder||(r.find("#"+i._id+"_Ribbon_home_Font_border").hide(),r.find("#"+i._id+"_Ribbon_home_Font_border").hide()));t.allowMerging||r.find("#"+i._id+"_Ribbon_home_Alignment_merge").hide();t.allowWrap||r.find("#"+i._id+"_Ribbon_home_Alignment_wraptext").hide();t.allowUndoRedo||r.find("#"+i._id+"_Ribbon_home_Actions").hide();t.allowPivotTable||t.allowFormatAsTable?t.allowPivotTable?t.allowFormatAsTable||(r.find("#"+i._id+"_Ribbon_home_Styles_formatastable").hide(),r.find("#"+i._id+"_Ribbon_insert_Tables_table").hide()):r.find("#"+i._id+"_Ribbon_insert_Tables_pivotTable").hide():r.find("#"+i._id+"_Ribbon_insert_Tables").hide();t.allowConditionalFormats||t.allowFormatAsTable||t.allowCellFormatting||r.find("#"+i._id+"_Ribbon_home_Styles").hide();t.allowConditionalFormats||r.find("#"+i._id+"_Ribbon_home_Styles_cFormat").hide();t.allowEditing&&(t.allowAutoSum||r.find("#"+i._id+"_Ribbon_home_Editing_autosum").hide(),t.allowSorting||t.allowFiltering||r.find("#"+i._id+"_Ribbon_home_Editing_1").hide());t.pictureSettings.allowPictures||r.find("#"+i._id+"_Ribbon_insert_Illustrations").hide();t.allowHyperlink||r.find("#"+i._id+"_Ribbon_insert_Links").hide();t.allowCharts||r.find("#"+i._id+"_Ribbon_insert_Charts").hide();t.allowFiltering||r.find("#"+i._id+"_Ribbon_data_SortFilter_2").hide();t.allowSorting||r.find("#"+i._id+"_Ribbon_data_SortFilter_1").hide();t.allowDataValidation||r.find("#"+i._id+"_Ribbon_data_DataTools").hide();t.printSettings.allowPrinting||(r.find("#"+i._id+"_Ribbon_pagelayout_Print").hide(),r.find("#print_backStageTab").hide());t.printSettings.allowPageSize||r.find("#"+i._id+"_Ribbon_pagelayout_PageLayout").hide();t.allowComments||u.hideTab("REVIEW");t.allowFreezing||r.find("#"+i._id+"_Ribbon_others_Window").hide();t.allowFormulaBar||(r.find("#"+i._id+"_Ribbon_others_Formulas").hide(),i.hideFormulaBar());t.allowInsert||t.allowDelete?t.allowInsert?t.allowDelete||r.find("#"+i._id+"_Ribbon_others_Cells_2").hide():r.find("#"+i._id+"_Ribbon_others_Cells_1").hide():r.find("#"+i._id+"_Ribbon_others_Cells").hide();t.allowFiltering||t.allowSorting||r.find("#"+i._id+"_Ribbon_data_Sort").hide();t.allowSearching||r.find("#"+i._id+"_Ribbon_others_Editing").hide();t.allowFormatAsTable||t.allowPivotTable||r.find("#"+i._id+"_Ribbon_insert_Tables").hide();t.allowImport||r.find("#open_backStageBtn").hide();t.exportSettings.allowExporting||r.find("#saveas_backStageTab").hide()},_fileSelect:function(i){var r=n("#"+n("#"+this._id).parents("div")[0].id).data("ejSpreadsheet"),f=t.browserInfo(),e=i.files[0],u=e.extension;if(r._uploadImage&&u===".xlsx"||!r._uploadImage&&((f.name==="msie"&&parseInt(f.version)<10)?u.indexOf("jpg")>-1||u.indexOf("png")>-1||u.indexOf("jpeg")>-1||u.indexOf("gif")>-1:e.rawFile.type.indexOf("image")>-1))return r._showAlertDlg("Alert","CorrectFormat","",290),!1;r._uploadImage=!1;r.showWaitingPopUp()},_pictureSizeChange:function(t,i){var u=this.XLObj,f,r=u.element.find(".e-ss-activeimg"),e={sheetIndex:u.getActiveSheetIndex(),reqType:"shape",shapeType:"picture",action:"picturesize",name:t,id:n(r).attr("id"),prev:{},cur:{}};u._shapeChange||u.XLRibbon._isSetModel||(e.prev={width:r.width(),height:r.height()},t==="pictureheight"?(f=parseInt(r.height()*i.value/r.width()),r.css({width:i.value,height:f}),e.cur={width:i.value,height:f}):(f=parseInt(r.width()*i.value/r.height()),r.css({height:i.value,width:f}),e.cur={height:i.value,width:f}),u.XLRibbon._isSetModel=!0,n("#"+u._id+"_"+t).ejNumericTextbox("option",{value:f}),u.XLRibbon._isSetModel=!1,u._completeAction(e),u.XLShape._updateShapeObj(r[0]))},_chartTypeOk:function(){var r=this.XLObj,o=r.element.find("#"+r._id+"_chart").val(),u=n("#"+o).data("ejChart"),e,t,f,s,h,i;f=n("#"+r._id+"_allchart").find(".e-chartselect")[0].classList[1];t=f.split("e-dlg")[1].split("chart");s=["e-dlgcolumnchart4","e-dlgcolumnchart5","e-dlgcolumnchart6","e-dlgbarchart4","e-dlgbarchart5","e-dlgbarchart6","e-dlgpiechart2"];h=["e-dlgstockchart2","e-dlglinechart2","dlgradarchart2"];i={type:t[0],enable3D:!1,marker:{visible:!1}};(t[0]==="column"||t[0]==="bar"||t[0]==="area")&&(t[1]==="1"||t[1]==="4"?i.type=t[0]:t[1]==="2"||t[1]==="5"?i.type="stacking"+t[0]:(t[1]==="3"||t[1]==="6")&&(i.type="stacking"+t[0]+"100"));s.indexOf(f)>-1&&(i.enable3D=!0);h.indexOf(f)>-1&&(i.marker={visible:!0});f==="e-dlgpiechart3"&&(i.type="doughnut");e={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:"chartType",chartId:o};e.prev={chartType:u.model.series[0].type,enable3D:u.model.enable3D,marker:u.model.series[0].marker.visible};r.XLChart.refreshChart(o,i);e.cur={chartType:u.model.series[0].type,enable3D:u.model.enable3D,marker:u.model.series[0].marker.visible};n("#"+r._id+"_charttypedlg").ejDialog("close");r._completeAction(e)},_chartTypeCancel:function(){var t=this.XLObj;n("#"+t._id+"_charttypedlg").ejDialog("close");t.setSheetFocus()},_chartType:function(i,r,u,f,e,o){var c,s,a=0,l=this.XLObj,v=l._getLocStr(i).split("/"),y=i.toLowerCase(),h;for(c=t.buildTag("div#"+l._id+"_Ribbon_"+i+".e-ss-dialog","",{width:"auto",padding:"4px"}),c.append("<div class='e-chartheader'><span>"+v[0]+"<\/span><\/div>"),h=t.buildTag("div.e-chartcontent"),s=0;s<r;s++)h.append("<div class='e-chartcell e-"+y+(s+1)+"' title="+l._getLocStr(o[s])+"><\/div>"),n(h).children().eq(s).data({type:e[s],enable3D:!1,marker:{visible:!1}}),s===u&&(c.append(h).append("<div class='e-chartheader'><span>"+v[1]+"<\/span><\/div>"),h=t.buildTag("div.e-chartcontent")),s>f&&(n(h).children().eq(a).data({type:e[s],enable3D:!0,marker:{visible:!1}}),a++);c.append(h);h=n(c).find(".e-"+y+"2");(i==="StockChart"||i==="LineChart")&&h.data({marker:{visible:!0}});i==="PieChart"&&h.data({enable3D:!0});l.element.append(c)},autoSum:function(i,r){if(this.XLObj.model.allowAutoSum){var e=this.XLObj,k=e.XLEdit,c=e.getActiveSheetIndex(),y=e.getActiveCellElem(c),d=!1;if(y.length){var a,p,g,nt=e.getActiveCell(c),w,b=e.getRangeIndices(r),u=e.XLSelection._getSelectedRange({rowIndex:b[0],colIndex:b[1]},{rowIndex:b[2],colIndex:b[3]}),h=u.length-1,tt=u[h].rowIndex-u[0].rowIndex,it=u[h].colIndex-u[0].colIndex,v={sheetIndex:c,range:r,reqType:"auto-sum",oprType:i,updCell:[]},f,o,l,rt=e.getRange(u[0].rowIndex,u[0].colIndex,u[h].rowIndex,u[h].colIndex).text().length,s=e._dataContainer.sheets[c];if(h!==0&&rt)if(tt===0&&it>0)w=e._getAlphaRange(c,u[0].rowIndex,u[0].colIndex,u[h].rowIndex,u[h].colIndex),f=u[h].rowIndex,o=u[h].colIndex+1,o===e.getSheet(c).colCount&&e.XLScroll._createNewColumn(c,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert"),l=e.getCell(f,o,c),v.updCell.push({rowIndex:f,colIndex:o,pObj:{},pValue:l.text()}),t.isNullOrUndefined(s[f])&&(s[f]={}),t.isNullOrUndefined(s[f][o])&&(s[f][o]={}),n.extend(!0,v.updCell[0].pObj,s[f][o]),k.updateCellValue(l,"="+i+"("+w+")"),l.addClass("e-ralign");else for(g=u[h].colIndex-u[0].colIndex,a=0;a<=g;a++)w=e._getAlphaRange(c,u[0].rowIndex,u[a].colIndex,u[h].rowIndex,u[a].colIndex),f=u[h].rowIndex+1,o=u[a].colIndex,u[h].rowIndex===e.getSheet(c).rowCount-1&&e.XLScroll._createNewRow(c,-1,-1,"insert"),l=e.getCell(f,o,c),v.updCell.push({rowIndex:f,colIndex:o,pObj:{},pValue:l.text()}),t.isNullOrUndefined(s[f])&&(s[f]={}),t.isNullOrUndefined(s[f][o])&&(s[f][o]={}),n.extend(!0,v.updCell[a].pObj,s[f][o]),k.updateCellValue(l,"="+i+"("+w+")"),l.addClass("e-ralign");else f=y.parent().index(),o=y[0].cellIndex,v.updCell.push({rowIndex:f,colIndex:o,pObj:{},pValue:y.text()}),t.isNullOrUndefined(s[f])&&(s[f]={}),t.isNullOrUndefined(s[f][o])&&(s[f][o]={}),n.extend(!0,v.updCell[0].pObj,s[f][o]),k.editCell(nt.rowIndex,nt.colIndex,!0),p=y.find("input"),p.val("="+i+"()"),e._getInputBox().val("="+i+"()"),d=!0,p.focus().setInputPos(p.val().length-1);e._isUndoRedo||d||e._completeAction(v)}}},_openNameManagerDlg:function(){var i=this.XLObj,t=n("#"+i._id+"_nmgrid").data("ejGrid");t.getContentTable().find("td").addClass("e-ss-emptyrecord");t.model.dataSource.length<1?t.getContentTable().find("td").addClass("e-ss-emptyrecord"):t.getContentTable().find(".e-ss-emptyrecord").removeClass("e-ss-emptyrecord");n("#"+i._id+"_nmdlg").ejDialog("open");n("#"+i._id+"_nmgrid").focus()},_openFATDlg:function(){var t=this.XLObj;n("#"+t._id+"_fatnamedlg").ejDialog("open");n("#"+t._id+"_fatheader").ejCheckBox("option","checked",!1);n("#"+t._id+"_fatname").val("Table "+t.getObjectLength(t.getSheet(t.getActiveSheetIndex())._tableManager)).focus().setInputPos(n("#"+t._id+"_fatname").val().length)},_dirtySelect:function(t){var h,i=this.XLObj,c=i.getActiveSheetIndex(),u=n("#"+i._id+"_contextMenuCell").data("ejMenu"),a=["sortfilter","clear"],v=["formatastable"],y=["convertorange","filter","clearfilter"],p=["table"],k=i.getActiveCellElem(c),e=n("#"+i._id+"_contextMenuColumnHeader").data("ejMenu"),o=n("#"+i._id+"_contextMenuRowHeader").data("ejMenu"),w,b,l=!1,s=i.getSheet(c).filterSettings.tableRange,f,r;if(t.length>0)for(b=n(t[t.length-1]).parent().index(),w=t[t.length-1].cellIndex,r=0,f=s.length;r<f;r++){if(s[r].endRow>b){l=!0;break}if(s[r].multifilterIdx[s[r].multifilterIdx.length-1]>w){l=!0;break}}if(l?(i.model.allowInsert&&i.model.scrollSettings.allowScrolling&&(u.disableItemByID("Insert"),o.disableItemByID("Insert"),e.disableItemByID("Insert"),this._disableButtons(["inssbtn"],"ejSplitButton"),this._disableButtons(["insbtn"],"ejButton")),i.model.allowDelete&&i.model.scrollSettings.allowScrolling&&(this._disableButtons(["delsbtn"],"ejSplitButton"),this._disableButtons(["delbtn"],"ejButton"),u.disableItemByID("Delete"),o.disableItemByID("Delete"),e.disableItemByID("Delete"))):(i.model.allowInsert&&i.model.scrollSettings.allowScrolling&&(u.enableItemByID("Insert"),o.enableItemByID("Insert"),e.enableItemByID("Insert"),this._enableButtons(["inssbtn"],"ejSplitButton"),this._enableButtons(["insbtn"],"ejButton")),i.model.allowDelete&&i.model.scrollSettings.allowScrolling&&(u.enableItemByID("Delete"),o.enableItemByID("Delete"),e.enableItemByID("Delete"),this._enableButtons(["delsbtn"],"ejSplitButton"),this._enableButtons(["delbtn"],"ejButton"))),t.not("[class*='e-table']").length>0&&t.is("[class*='e-table']")?(this._disableButtons(a,"ejSplitButton"),i._hasClass(k[0],"e-table")||this._disableButtons(v,"ejSplitButton"),this._disableButtons(y,"ejButton"),u.disableItemByID("Sort")):(this._enableButtons(a,"ejSplitButton"),this._enableButtons(v,"ejSplitButton"),this._enableButtons(y,"ejButton"),i.model.allowSorting&&u.enableItemByID("Sort")),t.is("[class*='e-table']")?(this._disableButtons(p,"ejButton"),this._isDirtySelect=!0):(this._enableButtons(p,"ejButton"),this._isDirtySelect=!1),h=i._getContent(c).find(".e-ssfiltered, .e-ssfiltered-asc, .e-ssfiltered-dsc"),f=h.length,!t.not("[class*='e-table']").length<1&&!t.is("[class*='e-table']"))if(f>0){for(r=0;r<f;r++)if(h[r].parentNode.className.indexOf("e-table")>-1)t.not("[class*='e-table']").length<1&&t.is("[class*='e-table']")?this._enableButtons(["clearfilter"],"ejButton"):this._disableButtons(["clearfilter"],"ejButton");else if(this._enableButtons(["clearfilter"],"ejButton"),t.has("[class*='e-table']").length<1)return}else this._disableButtons(["clearfilter"],"ejButton")}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.freezepane=function(n){this.XLObj=n;this._isFirstRow=!1;this._isFirstColumn=!1};t.spreadsheetFeatures.freezepane.prototype={freezeTopRow:function(){var t=this.XLObj,n=t.getSheet(t.getActiveSheetIndex());t.model.allowFreezing&&(this._getFirstFreezeRow(),this._isFirstRow=!0,n._firstRow.idx===0&&(n._firstRow={idx:1,value:n._rowHeightCollection[1]}),this.freezeRows(n._firstRow.idx))},_getFirstFreezeRow:function(){var n,o;this._updateRowHeightCollection(0);var r=this.XLObj,f=r.getActiveSheetIndex(),t=r.getSheet(f),i=t._rHeightCollection,u=r._getContent(f).find(".e-content").scrollTop(),s=t.rowsHeightCollection,e;if(u===0)t._firstRow={idx:1,value:i[1].value};else for(n=0,o=i.length;n<o;n++)if(i[n].value>=u){e=i[n].value-u<s[n]?2:1;t._firstRow={idx:n+e,value:i[n+1].value};break}t._firstRow.idx!==0&&this._updateRowHeightCollection(t._firstRow.idx)},freezeLeftColumn:function(){var t=this.XLObj,n=t.getSheet(t.getActiveSheetIndex());t.model.allowFreezing&&(this._getFirstFreezeColumn(),this._isFirstColumn=!0,n._firstCol.idx===0&&(n._firstCol={idx:1,value:n._colWidthCollection[1]}),this.freezeColumns(n._firstCol.idx))},_getFirstFreezeColumn:function(){var n,e;this._updateColWidthCollection(0);var r=this.XLObj,u=r.getActiveSheetIndex(),t=r.getSheet(u),i=t._cWidthCollection,f=r._getContent(u).find(".e-content").scrollLeft();if(f===0)t._firstCol={idx:1,value:i[1].value};else for(n=0,e=i.length;n<e;n++)if(i[n].value>=f){t._firstCol={idx:n+1,value:i[n+1].value};break}t._firstCol.idx!==0&&this._updateColWidthCollection(t._firstCol.idx)},freezeRows:function(n){var t=this.XLObj,u,e;if(t.model.allowFreezing){this._isFirstRow||this._getFirstFreezeRow();var i=t.getActiveSheetIndex(),r=t.getSheet(i),o=t.model.sheets[i]._firstRow,s=t.getRows(i),h=s[1],f=t.XLScroll._vScroller(i);for(!r._importRendered&&(t.getFrozenRows(i)>0||t.getFrozenColumns(i)>0)&&this.unfreezePanes(),r._frozenHeight=0,f.element.find(".e-vhandle").css("top",0),f.value(0),n>0&&(t.setFrozenRows(n,i),this._updateRowHeightCollection(n),r._currentTopFrozenRow=n,this._applyFreeze(i,n,0)),u=0,e=o.idx;u<e;u++)r._frozenHeight+=parseInt(h[u].style.height);t.XLScroll._refreshScroller(i,"refresh","vertical")}},freezeColumns:function(n){var t=this.XLObj,u,e;if(t.model.allowFreezing){this._isFirstColumn||this._getFirstFreezeColumn();var i=t.getActiveSheetIndex(),o=t.model.sheets[i]._firstCol,r=t.getSheet(i),f=t.XLScroll._hScroller(i),s=t._getContent(i).find(".e-table").find("col");if(!r._importRendered&&(t.getFrozenRows(i)>0||t.getFrozenColumns(i)>0)&&this.unfreezePanes(i),this._updateColWidthCollection(n),r._frozenWidth=0,f.element.find(".e-hhandle").css("left",0),f.value(0),n>0)for(t.setFrozenColumns(n,i),r._currentLeftFrozenColumn=n,this._applyFreeze(i,0,n),u=0,e=o.idx;u<e;u++)r._frozenWidth+=parseInt(s[u].style.width);t.XLScroll._refreshScroller(i,"refresh","horizontal")}},freezePanes:function(i){var u=this.XLObj;if(u.model.allowFreezing){var c,l,r,h,f=u.getActiveSheetIndex(),y=u.getRows(f)[1],e=u.getSheet(f),a=e._rowHeightCollection,v=e._colWidthCollection,p,w,b,k,o=0,s=0;if(this._isFirstRow=!1,this._isFirstColumn=!1,!e._importRendered&&(u.getFrozenRows(f)>0||u.getFrozenColumns(f)>0)&&this.unfreezePanes(f),c=u.XLScroll._vScroller(f),l=u.XLScroll._hScroller(f),t.isNullOrUndefined(i)||(typeof i=="string"?(i=u.getRangeIndices(i),o=i[0],s=i[1]):(o=i.rowIndex,s=i.colIndex)),o>0&&s>0){for(e._frozenHeight=0,e._frozenWidth=0,p=c.element.find(".e-vhandle")[0].offsetTop*c._scrollData.onePx,r=0,h=a.length;r<h;r++)if(a[r].value>=p){b=e._firstRow={idx:r,value:a[r].value};break}for(w=l.element.find(".e-hhandle")[0].offsetLeft*l._scrollData.onePx,r=0,h=v.length;r<h;r++)if(v[r].value>=w){k=e._firstCol={idx:r,value:v[r].value};break}for(r=0,h=b.idx;r<h;r++)e._frozenHeight+=parseInt(y[r].style.height);for(r=0,h=k.idx;r<h;r++)e._frozenWidth+=n(y[0]).find("td")[r].offsetWidth;u.setFrozenColumns(s,f);u.setFrozenRows(o,f);e._currentTopFrozenRow=o;e._currentLeftFrozenColumn=s;this._updateRowHeightCollection(o);this._updateColWidthCollection(s);this._applyFreeze(f,o,s);u.XLScroll._refreshScroller(f,"refresh","all");c.element.find(".e-vhandle").css("top",0);c.value(0);l.element.find(".e-hhandle").css("left",0);l.value(0)}else o<1&&s>0?this.freezeColumns(s):s<1&&o>0&&this.freezeRows(o)}},_applyFreeze:function(t,i,r){var u=this.XLObj,o,s="",h="",c="",l="",f,a=u._getContent(t).find(".e-table").width(),e,v=u._getContent(t).find(".e-table").height(),y=u.getFrozenRows(t),p=u.getFrozenColumns(t);this._isFirstColumn||this._isFirstRow?(y&&(e=u.model.sheets[t]._firstRow.value),p&&(f=u.model.sheets[t]._firstCol.value)):(o=u.getCell(i,r),f=o[0].offsetLeft,e=o[0].offsetTop);y&&(s=String.format("<div class=\"{0}\" style='width:{1}px; left: {2}px; top: {3}px;'><\/div>","e-frow",a,0,e),h=String.format("<div class=\"{0}\" style='width:{1}px; left: {2}px; top: {3}px;'><\/div>","e-frow",a,0,e),u._getContent(t).find(".e-content").append(n(s)),u._getJSSheetRowHeaderContent(t).append(n(h)));p&&(c=String.format("<div class=\"{0}\" style='height:{1}px; left: {2}px; top: {3}px;'><\/div>","e-fcol",v,f,0),l=String.format("<div class=\"{0}\" style='height:{1}px; left: {2}px; top: {3}px;'><\/div>","e-fcol",v,f,0),u._getContent(t).find(".e-content").append(n(c)),u._getJSSheetHeader(t).find(".e-headercontent").append(n(l)));u.setSheetFocus()},unfreezePanes:function(){var t=this.XLObj,i=t.getActiveSheetIndex(),e=t.getRows(i),r=t._getSelectedCells(i),u,f;t.model.allowFreezing&&(u=t.XLScroll._vScroller(i),f=t.XLScroll._hScroller(i),u.element.find(".e-vhandle").css("top",0),u.value(0),f.element.find(".e-hhandle").css("left",0),f.value(0),t.setFrozenColumns(0,i),t.setFrozenRows(0,i),t._getContent(i).find(".e-fcol, .e-frow").remove(),t._getJSSheetRowHeaderContent(i).find(".e-frow").remove(),t._getJSSheetHeader(i).find(".e-fcol").remove(),n(e[0]).removeClass("e-fr-hide"),n(e[1]).removeClass("e-fr-hide"),t._getContent(i).find("col").removeClass("e-fc-hide"),n(t._getJSSheetHeader(i).find("col")).removeClass("e-fc-hide"),t.model.sheets[i]._frozenHeight=0,t.model.sheets[i]._frozenWidth=0,u.scroll(0),t.performSelection({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}))},_getTopRow:function(n,t){for(var f=this.XLObj,r=f.getSheet(t),u=f.getFrozenRows(t),e=0,i=0,o=r._rowHeightCollection.length;i<o;i++)if(e=i,r._rowHeightCollection[i].value>n){u=r._rowHeightCollection[i].idx;break}return{imaginaryIndex:u,actualIndex:u,i:e}},_getLeftColumn:function(n,t){for(var f=this.XLObj,r=f.getSheet(t),u=f.getFrozenColumns(t),e=0,i=0,o=r._colWidthCollection.length;i<o;i++)if(e=i,r._colWidthCollection[i].value>n){u=r._colWidthCollection[i].idx;break}return{imaginaryIndex:u,actualIndex:u,i:e}},_showHideRow:function(t,i,r,u,f,e,o,s){var c=this.XLObj,h,l=c.getSheet(t),v=0,p=l._firstRow,a=l._fpHiddenHeight,y;if(u==="hide")for(h=i;h<=r;h++)y=n(e[0][h]).height(),o>s-(p.value+y)&&c.XLScroll._createNewRow(t,-1,-1,"insert"),c._hasClass(e[0][h],"e-fr-hide")||(a=a+y),c.addClass(e[0][h],"e-fr-hide"),c.addClass(e[1][h],"e-fr-hide"),l._currentTopFrozenRow=h;else{for(h=i;h<=r;h++)c._hasClass(e[0][h],"e-fr-hide")&&(c._removeClass(e[0][h],"e-fr-hide"),c._removeClass(e[1][h],"e-fr-hide"),v=n(e[0][h]).height(),a=a-v<=0?0:a-v);l._currentTopFrozenRow=i}l._fpHiddenHeight=a;l._currentTopPosition=f},_hideRow:function(t){var r=this.XLObj,i=r.getSheet(t),u=r.getRows(t),f=i._fpHiddenHeight;r._hasClass(u[0][i._currentTopFrozenRow],"e-fr-hide")||(r.addClass(u[0][i._currentTopFrozenRow],"e-fr-hide"),r.addClass(u[1][i._currentTopFrozenRow],"e-fr-hide"),i._fpHiddenHeight=f+n(u[0][i._currentTopFrozenRow]).height());i._currentTopFrozenRow=i._currentTopFrozenRow+1},_showHideColumn:function(n,t,i,r,u,f,e,o,s){var h=this.XLObj,p,b=h._rcRegx,w=i,c,l,a,v,y=h.getSheet(n);if(r==="hide"){for(c=t;c<=i;c++)if(w=c,a=h.getCell(0,c),h._hasClass(a[0],"e-merge"))for(v=h.getRangeIndices(h.XLEdit.getPropertyValueByElem(a,"mRange")),l=v[1];l<=v[3];l++)this._refreshHideColumn(n,l,f,e,o,s,"hide"),c=l;else this._refreshHideColumn(n,c,f,e,o,s,"hide");y._currentLeftFrozenColumn=w}else{for(c=t;c<=w;c++)if(a=h.getCell(0,c),h._hasClass(a[0],"e-mc-hide"))for(p=a[0].className.match(b)[0].split(" ")[0].replace("e-rc-","").split(":"),a=h.getCell(p[0],p[1]),v=h.getRangeIndices(h.XLEdit.getPropertyValueByElem(a,"mRange")),l=v[1];l<=v[3];l++)this._refreshHideColumn(n,l,f,e,o,s,"show"),c=l;else this._refreshHideColumn(n,c,f,e,o,s,"show");y._currentLeftFrozenColumn=t}y._currentLeftFrozenColumn<=h.getFrozenColumns(n)&&(y._currentLeftFrozenColumn=h.getFrozenColumns(n));y._currentLeftPosition=u},_hideColumn:function(n){var t=this.XLObj,f,e,i=0,r,l=t._rcRegx,s=t.getSheet(n),o=s._currentLeftFrozenColumn,h=t._getContent(n).find("col"),c=t._getJSSheetHeader(n).find("col"),u;if(r=t.getCell(0,o),t._hasClass(r[0],"e-mc-hide"))for(f=r[0].className.match(l)[0].split(" ")[0].replace("e-rc-","").split(":"),r=t.getCell(f[0],f[1]),e=t.getRangeIndices(t.XLEdit.getPropertyValueByElem(r,"mRange")),u=e[1];u<=e[3];u++)this._refreshHideColumn(n,u,h,c,0,0,"hide"),i=i+1;else this._refreshHideColumn(n,o,h,c,0,0,"hide"),i=i+1;s._currentLeftFrozenColumn=o+i},_refreshHideColumn:function(t,i,r,u,f,e,o){var s,h=this.XLObj,l,a,v=h.getSheet(t)._fpHiddenWidth,c=h._getContent(t).find(".e-filterspan"),w=h.model.sheets[t]._firstCol,p={rowIndex:-1,colIndex:-1},y;if(o==="hide")for(a=h.getRange(0,i,h.model.rowCount-1,i),a.filter(".e-sswraptext").hide(),n(r[i]).addClass("e-fc-hide"),n(u[i]).addClass("e-fc-hide"),v=v+n(r[i]).width(),f>e-(w.value+h.model.columnWidth)&&h.XLScroll._createNewColumn(t,p,p,"insert"),s=0,l=c.length;s<l;s++)y=n(c[s]).parent()[0].cellIndex,y===i&&n(c[s]).addClass("e-hide");else for(a=h.getRange(0,i,h.model.rowCount-1,i),a.filter(".e-sswraptext").show(),n(r[i]).removeClass("e-fc-hide"),n(u[i]).removeClass("e-fc-hide"),v=v-n(r[i]).width(),s=0,l=c.length;s<l;s++)y=n(c[s]).parent()[0].cellIndex,y===i&&n(c[s]).removeClass("e-hide")},_changevHandlerPosition:function(n){var i=this.XLObj,t=i.XLScroll._vScroller(i.getActiveSheetIndex());t.value(n);n=t!==null&&n>=t._scrollData.scrollable?t._scrollData.scrollable:n;t!==null&&n>=0&&n<=t._scrollData.scrollable&&(n=n/t._scrollData.onePx,t.element.find(".e-vhandle").css("top",n-1))},_changehHandlerPosition:function(n){var i=this.XLObj,t=i.XLScroll._hScroller(i.getActiveSheetIndex());t.value(n);n=t!==null&&n>=t._scrollData.scrollable?t._scrollData.scrollable:n;t!==null&&n>=0&&n<=t._scrollData.scrollable&&(n=n/t._scrollData.onePx,t.element.find(".e-hhandle").css("left",n-1))},_updateRowHeightCollection:function(i){var e=this.XLObj,o=e.getActiveSheetIndex(),f=e.getRows(o)[1],u=e.getSheet(o),r,s;if(!t.isNullOrUndefined(f))for(u._rHeightCollection=[{idx:i,value:1}],u._rowHeightCollection=[{idx:i,value:1}],r=i+1,s=f.length;r<s;r++)u._rHeightCollection.push({idx:r,value:f[r].offsetTop}),u._rowHeightCollection.push({idx:r,value:u._rowHeightCollection[u._rowHeightCollection.length-1].value+n(f[r]).height()})},_updateColWidthCollection:function(n){var u=this.XLObj,f=u.getActiveSheetIndex(),r=u.getSheet(f),s=u._getJSSheetHeader(f).find("col"),e=u.getRows(f)[1],i,o;if(!t.isNullOrUndefined(e))for(r._colWidthCollection=[{idx:n,value:1}],r._cWidthCollection=[{idx:n,value:1}],i=n+1,o=e[0].cells.length;i<o;i++)r._colWidthCollection.push({idx:i,value:r._colWidthCollection[r._colWidthCollection.length-1].value+parseInt(s[i].style.width)}),r._cWidthCollection.push({idx:i,value:e[0].cells[i].offsetLeft})},_refreshFreezeDiv:function(n,t,i){var f=this.XLObj,r,u;t==="horizontal"?(r=f._getContent(n).find(".e-frow"),r.width(r.width()+i)):(u=f._getContent(n).find(".e-fcol"),u.height(u.height()+i))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.math={toFraction:function(n){if(this.isNumber(n)){var r=n.toString(),e=r.split(".")[0],t=r.split(".")[1];if(!t)return{integer:n};var i=(+t).toString(),u=this.getPlaceValue(t,i),f=this.getGcd(i,u);return{integer:e,numerator:Number(i)/f,denominator:Number(u)/f}}return null},toExponential:function(n,t){var r,i;return this.isNumber(n)?(r=Number(n),t=this.isNumber(t)?t:2,i=r.toExponential(t).split("e+"),i[0]+"E+"+this.padZeros(i[1])):null},toAccounting:function(i,r,u){if(this.isNumber(r)&&i){var e,o,s=t.widgetBase.formatting(i,r,u),f=this._currencySymbol,h=n.trim(s.replace(f,"")),c=s.indexOf(f);!c||r<0&&c===1?(e=f,o=Number(r)?h:"-"):(e=Number(r)?h:"-",o=f);r=e+"   "+o}return r},intToDate:function(n){return new Date((Number(n)-2)*864e5+new Date("01/01/1900").getTime())},getGcd:function(n,t){return(n=Number(n),t=Number(t),!t)?n:this.getGcd(t,n%t)},isNumber:function(n){return n-parseFloat(n)>=0},isTime:function(n){return n?n.toString().indexOf(":")!==-1:!1},isFormula:function(n){var t,i;return n&&!n.toString().indexOf("=")&&n.length>1?(t=n.split("(").length-1,i=n.split(")").length-1,t===i):!1},getPlaceValue:function(n,t){var i=n.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},padZeros:function(n,i,r){return this.isNumber(n)?(i=this.isNumber(i)?i:2,r=t.isNullOrUndefined(t.Spreadsheet.autoFillDirection[r])?t.Spreadsheet.autoFillDirection.Left:t.Spreadsheet.autoFillDirection[r],r===t.Spreadsheet.autoFillDirection.Left?n<=this.maxValue(i)?Array(i-this.getDigits(n)+1).join("0")+n.toString():n.toString():n<this.minValue(i)?n.toString()+Array(i-this.getDigits(n)+1).join("0"):n.toString()):null},maxValue:function(n){return this.isNumber(n)?Number(Array(n+1).join("9")):null},minValue:function(n){return this.isNumber(n)?Number("1"+Array(n).join("0")):null},getDigits:function(n){return this.isNumber(n)?n.toString().length:null},_round:function(n,t){return Number(Math.round(n+"e"+t)+"e-"+t)},_parseTime:function(n){var u,t,i=0,r=3,f={},e;if(this.isTime(n))for(n=n.toString(),t=n.split(" "),u=t.length;i<u;){if(this.isTime(t[i]))for(e=t[i].split(":");r<6;)f[this._datePattern[r]]=e[r-3]||"0",r++;i++}return f},_dateToInt:function(n){var t=new Date("01/01/1900"),i=this._isDateTime(n)?n:new Date(n),r=i.getTime()-t.getTime();return r/864e5+2},_defTimeFormat:function(n){return[n.getHours(),n.getMinutes(),n.getSeconds()].join(":")},_isDate:function(n){var i={};return t.isNullOrUndefined(Globalize.parseDate(n.toString()))||(n=this._dateToInt(n.toString())),/^((0?[1-9]|1[012])[-.](0?[1-9]|[12][0-9]|3[01])[-.](19|20)?[0-9]{2})*$/.test(n.toString())?(n=n.toString().replace("-","/","g"),n=this._dateToInt(n.toString()),i.text=n,i.isDate=!0):(i.text=n,i.isDate=!1),i},_defDateFormat:function(n){return[n.getMonth()+1,n.getDate(),n.getFullYear()].join("/")},_isCellReference:function(n){return/^[a-z]+[0-9]+$/gi.test(n)},_isDateTime:function(n){return Object.prototype.toString.call(n)==="[object Date]"&&!isNaN(n.valueOf())}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.resizing=function(t){this.XLObj=t;this._$visualElem=n();this._currentHCell=-1;this._colMinWidth=15;this._rowMinHeight=20;this._allowStart=!1;this._resizeStart=!1;this._resizeType="";this._tableY=null;this._oldWidth=null;this._orgX=null;this._orgY=null;this._extra=null;this._initialTableWidth=null;this._resizeElt=null;this._tableX=null;this._oldHeight=null;this._initialTableHeight=null};t.spreadsheetFeatures.resizing.prototype={getColWidth:function(n){return this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).columnsWidthCollection[n]},getRowHeight:function(n){return this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).rowsHeightCollection[n]},setColWidth:function(n,t){this.XLObj.model.allowResizing&&(this._currentHCell=n,this._resizeColumnUsingDiff(t,this.XLObj._getJSSheetHeader(this.XLObj.getActiveSheetIndex()).find(".e-columnheader").find(".e-headercell")[this._currentHCell].offsetWidth))},setRowHeight:function(n,t){this.XLObj.model.allowResizing&&(this._currentHCell=n,this._resizeRowUsingDiff(t,this.XLObj._getJSSheetRowHeaderContent(this.XLObj.getActiveSheetIndex()).find("tbody").find(".e-rowheader")[this._currentHCell].offsetHeight))},_headerMouseDown:function(n){n.preventDefault();this._colMouseDown(n)},_colMouseDown:function(t){if(this._allowStart&&n(t.target).css("cursor")==="col-resize"){var i=t.clientX,r=t.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(i=t.pageX,r=t.pageY);i+=document.documentElement.scrollLeft;t.button!==2&&this._start(i,r);this._resizeType="Col";t.preventDefault()}},_mouseHover:function(t){var s,e=this.XLObj,c=e.getActiveSheetIndex(),o=e._getJSSheetHeader(c),i;if(!this._$visualElem.is(":visible")&&(i=n(t.target),i.is(".e-headercelldiv")&&(i=n(i.get(0).parentNode)),i.hasClass("e-headercell"))){var f=i.get(0),r=f.getBoundingClientRect(),h=e._setXY(t),u=h[0],l=h[1];if(s=n(o.find(".e-table").get(0)).width()+n(o.find(".e-columnheader").get(0)).offset().left,(u>=r.left+document.documentElement.scrollLeft+f.offsetWidth-5||u<=r.left+3)&&u<s&&u>=r.left&&l<=r.top+document.documentElement.scrollTop+t.target.offsetHeight){if(this._currentHCell=o.find(".e-headercell").index(f),this._currentHCell<1&&u<r.left+f.offsetWidth-5)return;i.addClass("e-ss-colresize");this._allowStart=!0}else n(".e-ss-colresize").removeClass("e-ss-colresize"),this._allowStart=!1,this._currentHCell=-1}},_start:function(i,r){var u=this.XLObj,e,o=u.getActiveSheetIndex(),s=u._getJSSheetHeader(o),l=s.find(".e-columnheader"),h=l.find(".e-headercell"),f,c;(this._currentHCell>-1&&this._currentHCell<h.length&&(f=h[this._currentHCell]),t.isNullOrUndefined(f))||(c=f.getBoundingClientRect(),this._tableY=c.top+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart?(this._$visualElem=n(document.createElement("div")),e=u._getJSSheetContent(o).height()+s.height(),this._$visualElem.addClass("e-reSizeColbg").appendTo(u.element).css({height:e+"px"}).addClass("e-ss-colresize"),this._$visualElem.css({left:i-1,top:this._tableY}),this._oldWidth=f.offsetWidth,this._orgX=i,this._orgY=r,this._extra=i-this._orgX,this._resizeStart=!0):this._currentHCell=-1)},_cMouseMove:function(t){if(this._resizeStart){var r=this.XLObj._setXY(t),i=r[0];navigator.userAgent.indexOf("WebKit")>-1&&(i=t.pageX);i+=document.documentElement.scrollLeft;t.preventDefault();this._moveVisual(i);n(t.target).addClass("e-ss-colresize")}else this._mouseHover(t)},_reSize:function(t){var u,i=this.XLObj,r=i.getActiveSheetIndex();this._initialTableWidth=i._getJSSheetHeader(r).find(".e-headercontent").width();this._getResizableCell();this._currentHCell>-1&&this._resizeStart&&(u=i._getJSSheetHeader(r).find(".e-columnheader").find(".e-headercell")[this._currentHCell].offsetWidth,this._resizeColumnUsingDiff(t-this._orgX+u,u),i.model.scrollSettings.allowScrolling&&(i.XLScroll._getColWidths(r,this._currentHCell+1),i.XLScroll._refreshScroller(r,"refresh","all")),i.model.allowAutoFill&&(i.XLDragFill.positionAutoFillElement(),i.XLDragFill.hideAutoFillOptions()),n("#"+i._id+"ddl").length&&i._ddlPosition());this._currentHCell>0&&i._setRowHdrHeightResize(r,this._currentHCell);i.model.allowSelection&&i.XLSelection._refreshBorder();this._removeVisualElem()},_resizeColumnUsingDiff:function(t,i){var r=this.XLObj,o={},u=r.getActiveSheetIndex(),s=r._getJSSheetHeader(u),h,c,e,f,l,a;if(t>0){for(t=t>this._colMinWidth?t:this._colMinWidth,h=s.find("col").eq(this._currentHCell),c=r._getJSSheetContent(u).find(".e-spreadsheetcontentcontainer").find("col").eq(this._currentHCell),h.outerWidth(t),c.width(t),e=r._getContent(u).find(".e-filterspan"),f=0,l=e.length;f<l;f++)a=n(e[f]).parent(),r.XLFilter._postionFilterIcon(a,n(e[f]));this._findColumnsWidth();s.find(".e-columnheader").css("cursor","default");o={sheetIndex:u,colIndex:this._currentHCell,newWidth:t,oldWidth:i,reqType:"resize-column"};i!==t&&r._completeAction(o);r.getFrozenColumns(u)>=this._currentHCell&&r._refreshFreezeColumns(u,this._currentHCell,t-i,"resize")}},_findColumnsWidth:function(){for(var i=this.XLObj,u=i.getActiveSheetIndex(),r=i.getSheet(u),f=i._getJSSheetHeader(u).find("col"),n=0,e=r.columns.length;n<e;n++)t.isNullOrUndefined(r.columns[n])||(r.columnsWidthCollection[n]=f.eq(n).width())},_calculateWidth:function(){for(var t=this.XLObj,i=t._getJSSheetHeader(t.getActiveSheetIndex()).find("col"),r=0,n=0;n<i.length;n++)r+=i.eq(n).width();return r},_cMouseUp:function(n){if(this._resizeStart){var t=n.clientX,i=this.XLObj;navigator.userAgent.indexOf("WebKit")>-1&&(t=n.pageX);t+=document.documentElement.scrollLeft;this._reSize(t);i.element.find("#"+i._id+"ddl").ejDropDownList("hidePopup")}},_getResizableCell:function(n){for(var i=this.XLObj,r=i.getActiveSheetIndex(),o=i._getJSSheetHeader(r).find(".e-columnheader"),u=o.find(".e-headercell").not(".e-hide"),s=navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollLeft:document.documentElement.scrollLeft,f,e,t=0,h=u.length;t<h;t++)if(e=u[t].getBoundingClientRect(),f=e.left+s+5,f>this._orgX){i.isUndefined(n)?this._currentHCell=t-1:n.target=i._getJSSheetHeader(r).find("th:eq("+(t-1)+")")[0];return}},_moveVisual:function(n){var i=this.XLObj,t=i._getJSSheetHeader(i.getActiveSheetIndex()).find(".e-headercontent")[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<n||n<t.left+document.documentElement.scrollLeft?this._$visualElem.remove():this._currentHCell>-1&&this._$visualElem.css({left:n-1,top:this._tableY})},_rowMouseDown:function(t){if(this._allowStart&&n(t.target).css("cursor")==="row-resize"){var r=t.clientX,i=t.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(r=t.pageX,i=t.pageY);i+=document.documentElement.scrollTop;t.button!==2&&this._rowStart(r,i);this._resizeType="Row";t.preventDefault()}return!1},_rowMouseHover:function(t){var i;if(!this._$visualElem.is(":visible")&&(i=n(t.target),i.hasClass("e-rowheader"))){var f=this.XLObj,o=f.getActiveSheetIndex(),s=f._getJSSheetRowHeaderContent(o),e=i.get(0),r=e.getBoundingClientRect(),h=f._setXY(t),c=h[0],u=h[1],l=f._getJSSheetRowHeader(o).find(".e-table").height()+s.find("tbody").offset().top;if((u>=r.top+document.documentElement.scrollTop+e.offsetHeight-5||u<=r.top+3)&&u<l&&u>=r.top&&c<=r.left+document.documentElement.scrollLeft+t.target.offsetWidth){if(this._resizeElt=i.parent(),this._currentHCell=s.find(".e-rowheader").index(e),this._currentHCell<1&&u<r.top+e.offsetHeight-5)return;i.addClass("e-ss-rowresize");this._allowStart=!0}else n(".e-ss-rowresize").removeClass("e-ss-rowresize"),this._allowStart=!1,this._currentHCell=-1}},_rowStart:function(t,i){var r=this.XLObj,f=r.getActiveSheetIndex(),e=r._getJSSheetRowHeader(f).find(".e-rowheader"),u,o,s;(this._currentHCell>-1&&this._currentHCell<e.length&&(u=e[this._currentHCell]),u)&&(o=u.getBoundingClientRect(),this._tableX=o.left+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollLeft:document.documentElement.scrollLeft),this._allowStart?(this._$visualElem=n(document.createElement("div")),s=r._getJSSheetContent(f).width(),this._$visualElem.addClass("e-reSizeRowbg").appendTo(r.element).css({width:s+"px"}).addClass("e-ss-rowresize"),this._$visualElem.css({top:i-1,left:this._tableX}),this._oldHeight=u.offsetHeight,this._orgX=t,this._orgY=i,this._extra=i-this._orgY,this._resizeStart=!0):this._currentHCell=-1)},_rMouseMove:function(t){if(this._resizeStart){var r=this.XLObj._setXY(t),i=r[1];navigator.userAgent.indexOf("WebKit")>-1&&(i=t.pageY);i+=document.documentElement.scrollTop;t.preventDefault();n(t.target).addClass("e-ss-rowresize");this._moveRowVisual(i)}else this._rowMouseHover(t)},_rowResize:function(t,i){var u,r=this.XLObj,f=r.getActiveSheetIndex(),o=r.getRows(f)[1],e=!1;this._initialTableHeight=r._getJSSheetRowHeader(f).find(".e-rowheadercontent").height();this._getResizableRowCell();e=n(o[this._currentHCell]).find(".e-sswraptext").length>0;this._currentHCell>-1&&this._resizeStart&&(u=r._getJSSheetRowHeaderContent(f).find("tbody").find(".e-rowheader")[this._currentHCell].offsetHeight,(!e||e&&i-this._orgY+u>u)&&this._resizeRowUsingDiff(i-this._orgY+u,u),r.model.scrollSettings.allowScrolling&&(r.XLScroll._getRowHeights(f,this._currentHCell+1),r.XLScroll._refreshScroller(f,"refresh","all")),r.model.allowAutoFill&&(r.XLDragFill.positionAutoFillElement(),r.XLDragFill.hideAutoFillOptions()));r.XLSelection._refreshBorder();this._removeVisualElem()},_resizeRowUsingDiff:function(t,i){var r=this.XLObj,u=r.getActiveSheetIndex(),s={},o=r._getJSSheetRowHeaderContent(u),h,y=r.getRows(u)[1][this._currentHCell].cells,c=this._getContentHeight(this._currentHCell,y,u)-4,l,a,e,f,v;if(t>0){for(t=t>c?t>this._rowMinHeight?t:this._rowMinHeight:c,l=o.find("tbody").children().eq(this._currentHCell),a=r._getJSSheetContent(u).find(".e-content").find("tr").eq(this._currentHCell),l.outerHeight(t),a.height(t),o.find("tbody").css("cursor","default"),o.find("tbody").children().css("cursor","default"),this._findRowsHeight(),e=r._getContent(u).find(".e-filterspan"),f=0,v=e.length;f<v;f++)h=n(e[f]).parent(),r.XLFilter._postionFilterIcon(h,n(e[f]));s={sheetIndex:u,rowIndex:this._currentHCell,newHeight:t,oldHeight:i,reqType:"resize-row"};i!==t&&r._completeAction(s);r.getFrozenRows(u)>=this._currentHCell&&r._refreshFreezeRows(u,this._currentHCell,t-i,"resize")}},_findRowsHeight:function(){for(var n=this.XLObj,i=n.getActiveSheetIndex(),r=n.getSheet(i),u=n._getJSSheetContent(i).find("tbody").children(),t=0,f=r.rowCount;t<f;t++)n._sheets[i]._Rows[0]&&(r.rowsHeightCollection[t]=u.eq(t).height())},_calculateHeight:function(){for(var t=this.XLObj,i=t._getJSSheetRowHeaderContent(t.getActiveSheetIndex()).find("tbody").children(),r=0,n=0,u=i.length;n<u;n++)r+=i.eq(n).height();return r},_rMouseUp:function(t){if(this._resizeStart){var r=t.clientX,i=t.clientY;navigator.userAgent.indexOf("WebKit")>-1&&(r=t.pageX,i=t.pageY);i+=document.documentElement.scrollTop;this._rowResize(r,i);n("#"+this.XLObj._id+"ddl").length&&this.XLObj._ddlPosition()}},_getResizableRowCell:function(t){for(var r=this.XLObj,e=r.getActiveSheetIndex(),u=r._getJSSheetContent(e).find(".e-rowheader"),h=navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop,o,f,s=1,i=0,c=u.length;i<c;i++)if(f=u[i].getBoundingClientRect(),f.top===0&&s++,o=f.top+h+5,o>this._orgY){r.isUndefined(t)?this._currentHCell=n(u[i-1]).is(":visible")?i-1:i-s:t.target=r._getJSSheetRowHeader(e).find("tr:eq("+(i-1)+")").find("td")[0];return}},_moveRowVisual:function(n){var i=this.XLObj,t=i._getJSSheetContent(i.getActiveSheetIndex()).find(".e-rowheadercontent")[0].getBoundingClientRect();t.top+document.documentElement.scrollTop+t.height<n||n<t.top+document.documentElement.scrollTop?this._$visualElem.remove():this._currentHCell>-1&&this._$visualElem.css({top:n-1,left:this._tableX})},_apMouseDown:function(t){if(this._allowStart&&n(t.target).closest("div").css("cursor")==="col-resize"){var i=t.clientX;navigator.userAgent.indexOf("WebKit")>-1&&(i=t.pageX);i+=document.documentElement.scrollLeft;t.button!==2&&this._apStart(i);this._resizeType="AP";t.preventDefault()}return!1},_apMouseHover:function(t){var i=this.XLObj;if(!this._$visualElem.is(":visible")){var r=n(t.target),e=r.get(0),u=e.getBoundingClientRect(),o=i._setXY(t),f=o[0];f<=u.left+4&&f>=u.left?(r.parent().addClass("e-ss-apresize"),this._allowStart=!0):(i.element.find(".e-ss-apresize").removeClass("e-ss-apresize"),this._allowStart=!1)}},_apStart:function(t){var i=this.XLObj,f=i.getActivationPanel()[0],e=f.getBoundingClientRect(),r=i.getActiveSheetIndex(),u;this._tableY=e.top+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop);this._allowStart&&(this._$visualElem=n(document.createElement("div")),u=i._getJSSheetContent(r).height()+i.getJSSheetHeader(r).height(),this._$visualElem.addClass("e-reSizeAPbg").appendTo(i.element).css({height:u+"px"}).addClass("e-ss-apresize"),this._$visualElem.css({left:t,top:this._tableY}),this._resizeStart=!0)},_apMouseMove:function(n){if(this._resizeStart){var i=this.XLObj._setXY(n),t=i[0];t+=document.documentElement.scrollLeft;n.preventDefault();this._apMoveVisual(t)}else this._apMouseHover(n)},_apMouseUp:function(n){if(this._resizeStart){var t=n.clientX;navigator.userAgent.indexOf("WebKit")>-1&&(t=n.pageX);t+=document.documentElement.scrollLeft;this._apReSize(t)}},_apMoveVisual:function(n){this._$visualElem.css({left:n,top:this._tableY})},_apReSize:function(t){var i=this.XLObj;i.model.apWidth=Math.abs(i.model.scrollSettings.width-t);n(i.getActivationPanel()).width(i.model.apWidth);i.setSheetWidthHeight(i.getActiveSheetIndex(),{width:t,height:i.model.scrollSettings.height});this._removeVisualElem()},_removeVisualElem:function(){var n=this.XLObj;this._$visualElem.remove();n.element.find(".e-reSizeRowbg").remove();this._resizeStart=!1;this._currentHCell=-1;this._resizeType="";this._allowStart=!1;n.model.allowComments&&n.XLComment._updateCmntArrowPos()},fitWidth:function(n){for(var t=this.XLObj,r=t.getActiveSheetIndex(),i=0,u=n.length;i<u;i++)this._fitWidth(n[i],t._sheets[r]._Rows[1]);t.model.scrollSettings.allowScrolling&&(t.XLScroll._getColWidths(t.getActiveSheetIndex(),n[0]+1),t.XLScroll._refreshScroller(r,"refresh","horizontal"));t.model.allowSelection&&t.XLSelection._refreshBorder()},_resizeToFitWidth:function(t){var i=this.XLObj,r,u=i.getActiveSheetIndex();n(t.target).css("cursor")==="col-resize"&&(n(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),this._getResizableCell(t),r=n(t.target),r.hasClass("e-headercell")&&this._fitWidth(t.target.cellIndex,i._sheets[i.model.activeSheetIndex]._Rows[1]));this._mouseHover(t);i.model.scrollSettings.allowScrolling&&(i.XLScroll._getColWidths(i.getActiveSheetIndex(),t.target.cellIndex+1),i.XLScroll._refreshScroller(u,"refresh","horizontal"));i.model.allowSelection&&i.XLSelection._refreshBorder()},_fitWidth:function(t,i){var r=this.XLObj,f=r.getActiveSheetIndex(),e=r._getJSSheetHeader(f).find(".e-headercell")[t],c=n(e).children(".e-headercelldiv"),u=0,s=0,o=0,h;i=i?i:r.sheets[f]._Rows[1];o=this._getContentWidth(t,f,i);s=this._getHeaderContentWidth(c,f);o>1&&(u=s>o?s:o,u=u+10,h={target:e,sheetIndex:r.getActiveSheetIndex(),colIndex:t,newWidth:u,oldWidth:e.offsetWidth,reqType:"resize-fit-width"},u>0&&(u<20&&(u=30),this._applyWidth(e,f,t,u),r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement(),r.model.allowComments&&r.XLComment._updateCmntArrowPos(),r.model.sheets[f]._importRendered||r._isUndoRedo||r._completeAction(h),r.getFrozenColumns(f)>=t&&r._refreshFreezeColumns(f,t,u-h.oldWidth,"resize")))},_applyWidth:function(n,t,i,r){var u=this.XLObj;u._getJSSheetHeader(t).find("col").eq(i).width(r);u._getJSSheetContent(t).find("col").eq(i+1).width(r);u.getSheet(t).columnsWidthCollection[i]=r;u.getSheet(t).columns[i].width=r},_getContentWidth:function(i,r,u){for(var e,g,p=0,w,l,a,v,b,k,s,h=this.XLObj,nt,f,o,tt=h._formatRegx,y=h.element.find("span:last"),c=0,d=u.length;c<d;c++){for(f=n(u[c]).find("td:eq("+i+")"),o=f.find("span:not(.e-comment,.e-celltoparrow)"),w=0,l=0,e=0,g=o.length;e<g;e++)o[e].className.indexOf("e-icon")>-1&&(b=parseInt(o[e].style.marginLeft),k=parseInt(o[e].style.marginRight),w+=n(o[e]).outerWidth(!0)+(isNaN(b)?0:b)+(isNaN(k)?0:k));nt="<span style='display:none'>"+(t.isNullOrUndefined(f[0].lastChild)?"":f[0].lastChild.nodeValue)+"<\/span>";h.element.append(nt);f[0].className.indexOf("e-sswraptext")>-1&&h.addClass(y[0],"e-sswraptext");f[0].className.indexOf("e-format")>-1&&h.addClass(y[0],f[0].className.match(tt)[0]);s=y.width();y.remove();a=parseInt(f[0].style.paddingLeft);a>-1&&(l+=isNaN(a)?0:a);v=parseInt(f[0].style.paddingRight);v>-1&&(l+=isNaN(v)?0:v);s=s+w+l;s>p&&(p=s)}return p},_getHeaderContentWidth:function(n){var i=0,r=t.buildTag("span",{},{}),u=n.html();return r.html(u),n.html(r),i=n.find("span:first").width(),i=i+10,n.html(u),i},fitHeight:function(n){var t=this.XLObj,r,u,i,f;if(t.model.allowResizing){for(r=t.getActiveSheetIndex(),u=t.getRows(t.getActiveSheetIndex())[0],i=0,f=n.length;i<f;i++)u[i].className.indexOf("e-sswraprow")<0&&this._fitHeight(n[i]);t.model.scrollSettings.allowScrolling&&(t.XLScroll._getRowHeights(r,n[0]+1),t.XLScroll._refreshScroller(r,"refresh","vertical"));t.model.allowSelection&&t.XLSelection._refreshBorder()}},_resizeToFitHeight:function(n){var t=this.XLObj,i=t.getActiveSheetIndex();this._getResizableRowCell(n);this._fitHeight(parseInt(n.target.textContent));t.model.scrollSettings.allowScrolling&&(t.XLScroll._getRowHeights(t.getActiveSheetIndex(),n.target.parentNode.rowIndex),t.XLScroll._refreshScroller(i,"refresh","vertical"));t.model.allowSelection&&t.XLSelection._refreshBorder()},_fitHeight:function(i){var r=this.XLObj,u=r.getActiveSheetIndex(),s=r._getJSSheetRowHeader(u).find(".e-rowheader")[i-1],f=0,e,h=0,o,l=t.buildTag("span",{},{}),a=r.getRows(u)[1][i-1].cells,c;h=this._getContentHeight(i,a,u);e=n(s);l.html(e.text());e.html(l);o=e.find("span:first").height();o=o+parseInt(n(e).css("padding-top"))+parseInt(n(e).css("padding-bottom"))+1;f=h<o?o:h;f<r.model.rowHeight&&(f=r.model.rowHeight);c={target:s,sheetIndex:r.getActiveSheetIndex(),rowIndex:i,newHeight:f,oldHeight:s.offsetHeight,reqType:"resize-fit-height"};n(s.parentElement).height(f);n(r._getContent(u).find("tr")[i-1]).height(f);r.getSheet(u).columns[i].height=f;r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement();r.model.allowComments&&r.XLComment._updateCmntArrowPos();r.model.scrollSettings.allowScrolling&&r.XLScroll._refreshScroller(u,"refresh","all");r.model.sheets[u]._importRendered||r._completeAction(c);r.getFrozenRows(u)>=i&&r._refreshFreezeRows(u,i-1,f-c.oldHeight,"resize")},_getContentHeight:function(i,r){for(var h=this.XLObj,f=0,o=t.buildTag("span.e-rowcell e-tspan",{},{}),s,c="",a=h._formatRegx,e,l,u=0,v=r.length;u<v;u++)e=n(r[u]),l=e.text(),r[u].className.indexOf("e-format")>-1&&(c=r[u].className.match(a)[0]),r[u].className.indexOf("e-sswraptext")>-1&&o.addClass("e-sswraptext"),o.addClass(c),o.append(l),e.append(o),s=e.find("span.e-tspan").height(),s>f&&(f=s),e.find("span:last").remove();return f>h.model.rowHeight?f+5:f}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.editing=function(n){this.XLObj=n;this._EditCellDetails={value:null,rowIndex:-1,columnIndex:-1,fieldName:null,cell:null};this._tdsOffsetWidth=[];this._isEdit=!1;this._isFormulaEdit=!1;this._isFBarFocused=!1;this._skipHTML=!1;this._EditTemplate=null;this._filterIcon=null;this._isCellEdit=!0;this._validOperators=["+","-","*","/",","];this._invalidOperators=["%"];this._validCharacters=["+","-","*","/",",","(","="];this._textDecoration=!1};t.spreadsheetFeatures.editing.prototype={getCurrentEditCellData:function(){var i=this.XLObj,r,t;return this._isEdit&&n("#"+i._id+"EditForm").length?(r=n("#"+i._id+"_"+this._EditCellDetails.fieldName),t=r.val(),typeof t=="string"&&t.length&&i.getSheet(i.getActiveSheetIndex()).columns[this._EditCellDetails.columnIndex].type==="number"&&(t=parseFloat(t)),t):null},getColumnIndexByField:function(n){for(var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),t=0,u=r.columns.length;t<u;t++)if(r.columns[t].field===n)break;return t},_processEditing:function(){this._addEditTemplate()},_addEditTemplate:function(){var r=this.XLObj,e=r.getActiveSheetIndex(),u=r.getSheet(e),i,n,o,f;if(u.columns.length!==0){for(i=t.buildTag("div","",{display:"none"},{id:r._id+"_EditTemplate"}),n=0,o=u.columns.length;n<o;n++)f=t.buildTag("div","",{},{id:u.columns[n].field+"_Edit"}),this._initCellEditType(n,f,e),i.append(f);i.children().length&&(this._EditTemplate=i)}},_initCellEditType:function(n,i,r){var f=this.XLObj,u=f.getSheet(r).columns[n].field;i.html(t.buildTag("input.e-field e-ss-input","",{},{value:"{{:"+u+"}}",id:f._id+"_"+u,name:u}))},editCell:function(i,r,u){var f=this.XLObj;if(f.model.allowEditing&&f.model.allowSelection){this._textDecoration=f.getCell(i,r).find("a").css("text-decoration")==="none";var s=f.getActiveSheetIndex(),o=f.getSheet(s),l=f.getActiveCell(s),a,y=f.getRows(s)[1],p=n(y[i]),w=o.columns[r].field,h=p.find(".e-rowcell").eq(r),v=f.getSheet(s).columns[r],e={columnName:v.field,value:this.getPropertyValueByElem(h),columnObject:v,cell:h},c={rowIndex:i,colIndex:r};(typeof e.value=="object"&&(e.value=this.getPropertyValueByElem(h,"value2")),f._trigger("cellEdit",e))||(f._cureditedCell=t.isNullOrUndefined(e.value)?"":e.value,(l.rowIndex!==i||l.colIndex!==r)&&(o._activeCell=c,o._startCell.rowIndex<=i&&o._startCell.colIndex<=r&&o._endCell.rowIndex>=i&&o._endCell.colIndex>=r?f.XLSelection.selectRange(o._startCell,o._endCell):f.XLSelection.selectRange(c,c),f.model.allowAutoFill&&f.XLDragFill.positionAutoFillElement()),this._EditCellDetails={rowIndex:i,value:e.value,columnIndex:r,fieldName:w,cell:h},a=e.value,u||(e.value=""),this._renderBulkEditObject(e,h,a),this.getPropertyValueByElem(f.getCell(o._activeCell.rowIndex,o._activeCell.colIndex),"rule")&&f.XLValidate._setValidation(),this.getPropertyValue(e.cell.parent().index(),e.cell[0].cellIndex,"hyperlink",s)&&n("#"+f._id+"_"+this._EditCellDetails.fieldName).addClass("e-hyperlinks"),this._textDecoration&&n("#"+f._id+"_"+this._EditCellDetails.fieldName).css("text-decoration","none"),e.cell.addClass(f.getBrowserDetails().browser==="msie"?"e-editedcell e-msie-edit":"e-editedcell"),f.isFormula(e.value)&&this._processFormulaEditRange(e.value))}},_renderBulkEditObject:function(i,r,u){var s=this.XLObj,o=t.buildTag("form","",{},{id:s._id+"EditForm"}),y=this._EditTemplate,h={},c=r.height(),f=r.find(".e-filterspan"),l,e,a,v;h[i.columnObject.field]=i.value;f.length>0&&(l={filterIcon:f,rowIndex:f.parentsUntil("table").eq(1).index(),colIndex:f.parent().index()},this._filterIcon=l);e=r.height();r.empty();r.hasClass("e-sswraptext")&&c!==e&&r.height(c);a=y.find("#"+i.columnObject.field+"_Edit").html();v=n(n.templates(a).render(h));o.append(v.height(e));r.append(o);this._setoffsetWidth(o);this._refreshEditForm(r,i.value,u,e);this._isEdit=!0;s.XLRibbon._disableRibbonIcons()},_setoffsetWidth:function(n){for(var i=n.closest("td"),t=0,r=i.length;t<r;t++)this._tdsOffsetWidth[t]=i.get(t).offsetWidth},_refreshEditForm:function(t,i,r,u){var e=this.XLObj,k=document.getElementById(e._id+"EditForm"),a=n(k).find("input,select"),f,o,s=e._dataContainer.sheets[e.getActiveSheetIndex()],h={},v=t.parent().index(),p,y,c,w,l,b;for(s&&s[v]&&s[v][t[0].cellIndex]&&(h=s[v][t[0].cellIndex]),c=0,w=a.length;c<w;c++){if(f=a.eq(c),e.isNumber(r)&&f.addClass("e-ralign"),this.getPropertyValueByElem(t,"type")&&(this.getPropertyValueByElem(t,"type").indexOf("date")>-1||this.getPropertyValueByElem(t,"type").indexOf("time")>-1)&&f.addClass("e-ralign"),f.css({border:"none",outline:"none"}),o=this.XLObj.model.allowCellFormatting&&e.XLFormat.getFormatClass(f.closest("td")[0].className),f.addClass(o),e.model.allowCellFormatting&&(e.XLFormat.getFormatFromHashCode(o).color||f.css({color:"#333333"}),e.XLFormat.getFormatFromHashCode(o)["background-color"]||f.css({"background-color":"#ffffff"})),h&&"cFormatRule"in h)for(y=n.extend(!0,[],h.cFormatRule),l=0,b=y.length;l<b;l++)p=e._dataContainer.cFormatData[y[l]].split("_"),n.parseJSON(p[7])&&f.css({"background-color":t.css("background-color"),color:t.css("color")});f.on("input",function(t){var i=n("#"+this.id.split("_")[0]).data("ejSpreadsheet");i.XLEdit._isFormulaEdit=!t.target.value.indexOf("=");i.XLEdit._isFormulaEdit&&i.XLEdit._processFormulaEditRange(t.target.value);i._getInputBox().val(t.target.value);i.XLEdit._isCellEdit=!0});f.on("focus",function(){var t=n("#"+this.id.split("_")[0]).data("ejSpreadsheet");t.XLEdit._isCellEdit=!0});this._renderAutoComplete(f,i,u);e._setFormulaSuggElem(n("#"+a[0].id+"_suggestion"))}this._focusElements(f.closest("td"))},_renderAutoComplete:function(t,i,r){var u=this.XLObj;t.ejAutocomplete({dataSource:u._formulaCollection,value:i,cssClass:"e-ss-autocomplete e-ss-editinput",width:"100%",height:r,delaySuggestionTimeout:10,minCharacter:2,popupWidth:"170px",popupHeight:"150px",showEmptyResultText:!1,autoFocus:!0,template:"<span class='e-icon e-ss-function'> <\/span><div> ${display} <\/div>",select:n.proxy(this._formulaSelect,u),open:n.proxy(this._formulaSuggestionStatus,u),close:n.proxy(this._formulaSuggestionStatus,u)});t.data("ejAutocomplete")._bubbleEvent(!0)},saveCell:function(){var o,i=this.XLObj,r,b,c;if(i.model.allowEditing&&this._isEdit){var f=i.getActiveSheetIndex(),s,k=i.getSheet(f),l=n("#"+i._id+"EditForm"),d=l.closest("td"),h,a=k.columns[this._EditCellDetails.columnIndex],u,v=n("#"+i._id+"_"+this._EditCellDetails.fieldName),e,y,p,w;if(i.model.allowDataValidation&&!l.validate().element(v[0]))return!1;if(r={columnName:a.field,value:this.getCurrentEditCellData(),pValue:this._EditCellDetails.value,columnObject:a,cell:d},i._trigger("cellSave",r))return;if(this.updateCellValue(r.cell,r.value),s=this.getPropertyValue(r.cell.parent().index(),r.cell[0].cellIndex,"hyperlink",f),s&&(s.webAddr?r.cell.html(t.buildTag("a",r.cell.text(),"",{href:s.webAddr,target:"_blank","class":"e-hyperlinks"})):r.cell.html(t.buildTag("a",r.cell.text(),"",{href:"#","class":"e-hyperlinks"}))),this._textDecoration&&r.cell.find("a").css("text-decoration","none"),n("#"+v[0].id+"_suggestion").remove(),b=t.isNullOrUndefined(this._EditCellDetails.value)?"":this._EditCellDetails.value,p=r.cell.parent().index(),w=r.cell.index(),c={sheetIndex:f,rowIndex:p,colIndex:w,cValue:r.value,reqType:"edit",iconName:"",pValue:b},r.value.toString().indexOf("=")===0&&(c.operation="formula"),i._setRowHdrHeight(f,r.cell.parent().index()),this._isFormulaEdit&&i._getContent(f).find("td").removeClass(i._formulaBorder.join(" ").replace(/,/g," ")+" "+i._ctrlFormulaBorder.join(" ").replace(/,/g," ")),this._isEdit=this._isFormulaEdit=!1,r.cell.removeClass("e-editedcell e-msie-edit"),t.isNullOrUndefined(i.XLCellNav)||(i.XLCellNav._isNavigate=!0),i.model.showRibbon&&(i.XLRibbon._enableRibbonIcons(),i.XLRibbon._updateRibbonIcons()),i._updateUndoRedoIcons(),i.model.allowInsert||(i.XLRibbon._disableButtons(["inssbtn"],"ejSplitButton"),i.XLRibbon._disableButtons(["insbtn"],"ejButton")),i.model.allowDelete||(i.XLRibbon._disableButtons(["delsbtn"],"ejSplitButton"),i.XLRibbon._disableButtons(["delbtn"],"ejButton")),c.cFormatRule=e=this.getPropertyValueByElem(r.cell,"cFormatRule"),i._dupDetails=!0,i.model.allowConditionalFormats&&e&&e.length)for(h=0,y=e.length;h<y;h++)u=e[h].split("_"),i.XLCFormat._cFormat(u[0],u[2],u[3],u[4],u[5]);return i._dupDetails=!1,(t.isNullOrUndefined(r.pValue)||r.value!==r.pValue.toString())&&i._completeAction(c),o=i.getActiveCellElem(),i._hasComment=!0,o.hasClass("e-commentcell")&&i.XLComment._updateCmntFrmCntnr(null,null,o),o.hasClass("e-hlcell")&&i.XLValidate.highlightInvalidData(),i._hasComment=this._shiftKeyEnabled=this._isFBarFocused=!1,i._ctrlKeyCount=0,i.model.allowSelection&&i.XLSelection._clearBorder(i._formulaBorder.join(" ").replace(/,/g," ")+" "+i._ctrlFormulaBorder.join(" ").replace(/,/g," ")),i.setSheetFocus(),!0}},updateCellValue:function(n,i,r,u){if(n){var f=this.XLObj,e=n[0].cellIndex,o=n[0].parentNode.rowIndex,s=f._rAlign;u=f.getActiveSheetIndex();f.isFormula(i)?(this._refreshCalcEngine(o,e,!0,i),this._updateDataContainer(n[0],{value:i,type:t.Spreadsheet.CellType.Formula}),f._applyFormula(u,o,e),this._updateUsedRange(o,e),f._isFormulaSuggestion=!1):(this.updateCell(n,i),this._refreshCalcEngine(o,e));f.model.allowCellFormatting&&f.XLFormat._hasFormat(r)&&f.XLFormat._updateFormatClass(n[0],r);t.isNullOrUndefined(this._filterIcon)||this._filterIconHandler(o,e,n)}},updateCell:function(n,i,r){if(n){var c=this.XLObj,e=n[0],o=e.parentNode.rowIndex,s=e.cellIndex,h=t.Spreadsheet.CellType,f=this._parseValue(i),u=c.getRangeData([o,s,o,s],!1,["formatStr","type","thousandSeparator","decimalPlaces"],r)[0];u.type&&u.type!=h.General&&(f.type=u.type,delete f.formatStr);(u.formatStr||u.type===h.Scientific||u.type===h.Fraction)&&(f.value2=c.XLFormat._format(f.value,{formatStr:u.formatStr,type:u.type,thousandSeparator:u.thousandSeparator,decimalPlaces:u.decimalPlaces}));this._updateDataContainer(e,f,r);this._updateUsedRange(o,s)}},_parseValue:function(i){i=this.XLObj.isNumber(i)?Number(i):i||"";var s,u,h,f=this.XLObj,e=f.model.locale,o=t.Spreadsheet.CellType,r=i+"",a=o.General,v=Globalize.culture(e).numberFormat["."],y=Globalize.culture(e).numberFormat[","],c=Globalize.culture(e).calendar.patterns,l=r.indexOf(f._currencySymbol);if((l===0||l>-1&&l===r.length-1)&&(u=Globalize.parseFloat(r,10,e),u))return{value:u,value2:r,type:o.Currency};if(n.trim(r).indexOf(f._percentSymbol)>-1&&(u=n.trim(r).replace(f._percentSymbol,""),f.isNumber(u)))return{value:Number(u),value2:r,type:o.Percentage};if((r.indexOf(v)>-1&&r.indexOf(y)===-1||r.indexOf(v)>-1&&r.indexOf(y)>-1)&&(u=Globalize.parseFloat(r,10,e),u))return{value:u,value2:r,type:a};for(s in c)if(u=Globalize.parseDate(r,c[s],e),u)return h="{0:"+c[s]+"}",r=f.XLFormat._format(u,{type:o.DateTime,formatStr:h}),{value:u,value2:r,type:o.DateTime,formatStr:h};return(r.toLowerCase()==="true"||r.toLowerCase()==="false")&&(i=r=r.toUpperCase()),{value:i,value2:r,type:a}},updateCellWithContainer:function(i,r,u,f){var s=this.XLObj;u=u?u:s.getActiveSheetIndex();r=r?r:s.getSheet(u).selectedRange;for(var l,h,e,o,a=s.getRange(r[0],r[1],r[2],r[3],u),c=0,v=0,y=a.length;c<y;)o=a[c],h=o.parentNode.rowIndex,f&&s._isHiddenRow(h)||(l=o.cellIndex,e=i[v],this._updateDataContainer(o,e),o.innerHTML=t.isNullOrUndefined(e.value2)?"":e.value2.toString(),this._refreshCellAlignment(o,e.value),this._refreshCalcEngine(h,l,s.isFormula(e.value),e.value),e.format&&s.addClass(o,e.format),e.hyperlink&&("cellAddr"in e.hyperlink?n(o).html(t.buildTag("a.e-hyperlinks",e.value2,"",{href:"#"})):n(o).html(t.buildTag("a.e-hyperlinks",e.value2,"",{href:e.hyperlink.webAddr,target:"_blank"}))),e.comment&&s.XLComment.setComment(o,null,!1),e.border&&s.XLFormat.applyBorder(s._getBorderInput(e.border),s._getAlphaRange(u,o.parentNode.rowIndex,o.cellIndex,o.parentNode.rowIndex,o.cellIndex)),v++),c++;s.model.allowConditionalFormats&&s.XLCFormat.refreshCFormat(r)},_refreshCellAlignment:function(i,r,u){var f=this.XLObj,o=f._rAlign,s=f._cAlign,e=n(i);r=t.isNullOrUndefined(r)?this.getPropertyValueByElem(e,"value"):r;f.isFormula(r)&&(r=f.XLEdit.getPropertyValue(i.parentNode.rowIndex,i.cellIndex,"calcValue"));u=u?u:this.getPropertyValueByElem(e,"type");this.getPropertyValueByElem(e,"isCenterAlign")||i.className.indexOf(s)>-1&&e.removeClass(s);i.className.indexOf(o)>-1&&e.removeClass(o);(f.isNumber(r)||typeof r=="object")&&u!==t.Spreadsheet.CellType.Text?f.addClass(i,o):f._isBool(r)&&f.addClass(i,s)},_filterIconHandler:function(n,t,i){this._filterIcon.rowIndex===n&&this._filterIcon.colIndex===t&&(i[0].className.indexOf(this.XLObj._rAlign)>-1&&i.removeClass(this.XLObj._rAlign),i[0].insertBefore(this._filterIcon.filterIcon[0],i[0].childNodes[i[0].childNodes.length-1]),this.XLObj.XLFilter._postionFilterIcon(i),this._filterIcon=null)},_editingHandler:function(i){var r=this.XLObj,e,o,u,it,p,h,c,v,d,a,tt;if(!(i.keyCode===61||!i.shiftKey&&i.keyCode===32||i.keyCode>=48&&i.keyCode<=59||i.keyCode>=65&&i.keyCode<=90||i.keyCode>=96&&i.keyCode<=111||i.keyCode===173||i.keyCode>=186&&i.keyCode<=192||i.keyCode>=219&&i.keyCode<=222||i.keyCode>=226)||i.ctrlKey||i.altKey)if(i.keyCode!==113||i.shiftKey||i.ctrlKey)if(i.keyCode===27&&this._isEdit)e=r.getActiveSheetIndex(),o=r.getSheet(e),c=o._activeCell.rowIndex,v=o._activeCell.colIndex,u=r.getCell(c,v),p=r._dataContainer.sheets[e],h=c in p&&v in p[c]?p[c][v]:h,u.removeClass("e-editedcell e-msie-edit"),u.get(0).textContent=r.isUndefined(h)?"":typeof h.value2=="string"?h.value2:r._dataContainer.sharedData[h.value],r.setSheetFocus(),r._setRowHdrHeight(e,o._selectedCells[0].rowIndex),this._isEdit=this._isFormulaEdit=this._isFBarFocused=!1,r._getContent(e).find("td").removeClass(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")),r.model.allowComments&&u.hasClass("e-commentcell")&&r.XLComment._updateCmntFrmCntnr(null,null,u),r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement(),r.model.showRibbon&&r.XLRibbon._enableRibbonIcons(),t.isNullOrUndefined(this._filterIcon)||this._filterIconHandler(c,v,u),t.isNullOrUndefined(r.XLCellNav)||(r.XLCellNav._isNavigate=!0);else if(i.keyCode===46)if(this._isEdit)r._ctrlKeyCount>0&&(r._ctrlKeyCount=0,r._formulaRange=[],r.XLSelection._clearBorder(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")));else{if(r._preventctrlkey){r._showAlertDlg("Alert","CtrlKeyErrorAlert","CtrlKeyErrorAction",450);return}e=r.getActiveSheetIndex();o=r.getSheet(e);u=r.getCell(o._activeCell.rowIndex,o._activeCell.colIndex);var s,w,g,b,k,l,nt,ut=new RegExp("\\be-format.*?\\b","g"),y,f=o._selectedCells,rt=r.getRangeData([f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex]);if(!this._isEdit){for(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),d=r.model.sheets[e]._tableManager,b=0,k=r.getObjectLength(d);b<k;b++)if(a=d[b].range,r.XLClipboard._compareRange([f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex],a)){nt=r._getAlphaRange(e,a[0],a[1],a[2],a[3]);r.clearAll(nt);return}for(u.hasClass("e-readonly")||r.clearRangeData(null,["value2","value"]),s=0,g=f.length;s<g;s++)if(u=r.getCell(f[s].rowIndex,f[s].colIndex),!u.hasClass("e-readonly")){if(r._getInputBox().val(""),r.model.allowComments&&r.XLComment._updateCmntFrmCntnr(f[s].rowIndex,f[s].colIndex),y=this.getPropertyValueByElem(u,"cFormatRule"),r.model.allowConditionalFormats&&y&&y.length)for(w=0,k=y.length;w<k;w++)l=y[w].split("_"),r.XLCFormat._cFormat(l[0],l[2],l[3],l[4],l[5]);r._setRowHdrHeight(e,f[s].rowIndex)}r.XLSelection._refreshBorder()}tt={sheetIndex:e,range:[f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex],bData:rt,reqType:"clear-content"};r._completeAction(tt)}else i.ctrlKey||i.shiftKey||i.keyCode!==8?(i.keyCode===13||i.keyCode===9)&&this._isEdit&&r.model.allowKeyboardNavigation&&!r.XLCellNav._isNavigate&&!this._isFormulaEdit&&(i.preventDefault(),t.isNullOrUndefined(r.XLCellNav)||(r.XLCellNav._isNavigate=!0)):(e=r.getActiveSheetIndex(),o=r.getSheet(e),u=r.getCell(o._activeCell.rowIndex,o._activeCell.colIndex),this._isEdit||u.hasClass("e-readonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),u=r.getCell(o._activeCell.rowIndex,o._activeCell.colIndex),u.empty(),this.editCell(n.inArray(u.closest("tr").get(0),r.getRows(e)[1]),u.index(),!1),r._setRowHdrHeight(e,o._activeCell.rowIndex),r._getInputBox().val("")));else e=r.getActiveSheetIndex(),o=r.getSheet(e),u=r.getCell(o._activeCell.rowIndex,o._activeCell.colIndex),this._isEdit||u.hasClass("e-readonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),this.editCell(n.inArray(u.closest("tr").get(0),r.getRows(e)[1]),u.index(),!0),r.XLCellNav._isNavigate=!1);else e=r.getActiveSheetIndex(),o=r.getSheet(e),u=r.getCell(o._activeCell.rowIndex,o._activeCell.colIndex),this._isEdit||u.hasClass("e-readonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),it=n("#"+r._id+"EditForm"),this.editCell(n.inArray(u.closest("tr").get(0),r.getRows(e)[1]),u.index(),!1))},_focusElements:function(t){n(t).find("input,select").not(":hidden").focus().setInputPos(n(t).find("input,select").val().length)},_updateUsedRange:function(n,t){var r=this.XLObj,i=r.model.sheets[r.getActiveSheetIndex()]._usedRange;i.rowIndex<n&&(i.rowIndex=n);i.colIndex<t&&(i.colIndex=t)},_updateDataContainer:function(i,r,u){var c=this.XLObj,y,d;if(c.getObjectLength(r)){var e,o,a,s,p,b=t.Spreadsheet.CellType,f=c._dataContainer,k=!1;u=c._getSheetIndex(u);$cell=n(i);var v=i.cellIndex,l=i.parentNode.rowIndex,h=["value","value2","type","cFormatRule","range","thousandSeparator","rule","format","border","picture","chart","calcValue"],w;l in f.sheets[u]||(f.sheets[u][l]={});(v in f.sheets[u][l])?o=f.sheets[u][l][v]:f.sheets[u][l][v]=o={};for(e in r){s=r[e];switch(e){case h[0]:case h[4]:case h[5]:case h[11]:f.sharedData.indexOf(s)===-1&&f.sharedData.push(s);a=f.sharedData.indexOf(s);o[e]=a;c.model.sheets[u]._importRendered||c._initialLoad||e===h[0]&&c.model.allowCharts&&(k=!0);break;case h[1]:[b.General,b.Text].indexOf(r.type)===-1?o[e]=r.value2:(f.sharedData.indexOf(r.value2)===-1&&f.sharedData.push(r.value2),o[e]=f.sharedData.indexOf(r.value2));w=i.getElementsByTagName("a");w.length?w[0].innerHTML=r.value2:i.innerHTML=this._skipHTML?i.innerHTML.concat(r.value2):r.value2;this._refreshCellAlignment(i,r.value,r.type);o.isDirty=!0;break;case h[2]:o[e]=f.cellType.indexOf(r.type);break;case h[3]:for(y=0,d=s.length;y<d;)f.cFormatData.indexOf(s[y])===-1&&f.cFormatData.push(s[y]),a=f.cFormatData.indexOf(s[y]),o[e]?o[e].indexOf(a)<0&&o[e].push(a):o[e]=[a],y++;break;case h[6]:f.valData.indexOf(s.customVal)===-1&&f.valData.push(s.customVal);o[e]=JSON.parse(JSON.stringify(s));o[e].customVal=f.valData.indexOf(s.customVal);break;case h[7]:case h[8]:f.hashCode.indexOf(s)===-1&&f.hashCode.push(s);o[e]=f.hashCode.indexOf(s);break;case h[9]:case h[10]:o[e]?o[e].indexOf(s)<0&&o[e].push(s):o[e]=[s];break;default:o[e]=s}}c.getObjectLength(o)===3&&(p=c.getRangeData([l,v,l,v],!1,h.slice(0,3))[0],p.value===""&&p.value2===""&&p.type===t.Spreadsheet.CellType.General&&c.clearRangeData(null,h.slice(0,3),$cell));k&&c.XLChart._refreshChartElements(l,v,u)}else i.innerHTML=""},getPropertyValue:function(i,r,u,f){var o,e,v=t.Spreadsheet.CellType,c=this.XLObj,s=c._dataContainer,l=s.sheets,h,a;if(f=f?f:c.getActiveSheetIndex(),f in l&&i in l[f]&&r in l[f][i]&&(e=l[f][i][r],!t.isNullOrUndefined(e))){u=u?u:"value";switch(u){case"value":case"range":case"thousandSeparator":case"calcValue":o=s.sharedData[e[u]];break;case"format":case"border":o=s.hashCode[e[u]];break;case"value2":o=[v.General,v.Text].indexOf(s.cellType[e.type])===-1?e.value2:s.sharedData[e.value2];break;case"type":o=s.cellType[e.type];break;case"cFormatRule":for(h=0,a=0,o=[],c.isUndefined(e[u])||(a=e[u].length);h<a;)e[u][h]in s.cFormatData&&o.push(s.cFormatData[e[u][h]]),h++;break;case"rule":c.isUndefined(e[u])||(o=[],n.extend(!0,o,e[u]),o.customVal=s.valData[o.customVal]);break;default:o=e[u]}}return o},getPropertyValueByElem:function(n,i,r){if(!t.isNullOrUndefined(n[0]))return this.getPropertyValue(n[0].parentNode.rowIndex,n[0].cellIndex,i,r)},_refreshCalcEngine:function(n,t,i,r){var h,o,f,u=this.XLObj,e=u.getActiveSheetIndex(),s=u.getSheet(e);i?(h=new ValueChangedArgs(n+1,t+1,r),u._sheets[e]._calcEngine.valueChanged(s._sheetName.value,h)):(o=CalcEngine.getSheetFamilyItem(s._sheetName.value),f=RangeInfo.getAlphaLabel(t+1)+(n+1),u._sheets[e]._calcEngine.isSheetMember()&&o.parentObjectToToken!=null&&(f=o.parentObjectToToken.getItem(s._sheetName.value)+f),u._sheets[e]._calcEngine.refresh(f))},_formulaSelect:function(n){var u=this.model.nameManager.length,t=0,f=!1,i,r=n.text;if(u)while(t<u){if(this.model.nameManager[t].name===r.slice(1)){f=!0;break}t=t+1}i=f?r:r+"(";this.getActiveCellElem().find("input").val(i);this._getInputBox().val(i);this.XLCellNav._canKeyBoardNavigate=!1},_formulaBoxInputChange:function(n){var r=this.getActiveSheetIndex(),t=this.getSheet(r)._activeCell,u=this.getCell(t.rowIndex,t.colIndex,r),i=u.find("input:visible");this.XLEdit._isFormulaEdit=!n.target.value.indexOf("=");this.XLEdit._isFormulaEdit&&this.XLEdit._processFormulaEditRange(n.target.value,!0);i.length||(this.XLEdit.editCell(t.rowIndex,t.colIndex,!0),i=u.find("input:visible"));i.val(n.target.value);n.target.focus();this.XLEdit._isCellEdit=!1},_formulaSuggestionStatus:function(n){this._isFormulaSuggestion=n.type==="open"},_updateFormulaCellRange:function(n,t){var r,u=this.XLObj,f=u._getContent(u.getActiveSheetIndex()).find(".e-editedcell input").not(":hidden"),i=f.val(),e=i[i.length-1];t&&this._validCharacters.indexOf(e)===-1?i=i+",":(r=this._getCharPosition(i),r>-1&&(i=i.substr(0,[r+1])));n=i+n;f.val(n);u._getInputBox().val(n)},_getCharPosition:function(n){for(var t=n.length;t--;)if(this._validCharacters.indexOf(n[t])>-1)return t;return-1},_processFormulaEditRange:function(t,i){var f,e,u=0,r=this.XLObj,o=r.XLDragFill._parseFormula(t),s=o.length;for(r._ctrlKeyCount=0,r._formulaRange=[],r._ctrlKeyEnabled=!1,r.XLSelection._clearBorder(r._arrayAsString(r._ctrlFormulaBorder.concat(r._formulaBorder)));u<s;){if(f=o[u],this._invalidOperators.indexOf(f)>-1)break;r._isCellReference(f)&&(o[u+1]===":"&&(u++,r._isCellReference(o[u+1])&&(f=f+":"+o[u+1],u++)),this._updateFormulaEditRange(f,r._ctrlKeyCount),r._ctrlKeyCount++);u++}e=t.charAt(t.length-1);e==="("&&t.split("(").length===2?(r._isFormulaSuggestion=!1,r._getInputBox().val(t),i?n("#"+r._id+"_inputbox_suggestion").hide():r._getFormulaSuggElem().hide()):e===")"&&r.isFormula(t)&&(r.XLEdit._isFormulaEdit=!1,r._formulaRange=[],r._ctrlKeyCount=0);e===":"?(r._shiftKeyEnabled=!0,r._ctrlKeyCount--):this._validOperators.indexOf(e)>-1&&(r._dStartCell=r.getSheet(r.getActiveSheetIndex())._activeCell,r._ctrlKeyEnabled=!0,r._shiftKeyEnabled=!1)},_updateFormulaEditRange:function(n,t){var i=this.XLObj,r=i.getRangeIndices(n);i._formulaRange[t]=n;i._dStartCell={rowIndex:r[0],colIndex:r[1]};i._dEndCell={rowIndex:r[2],colIndex:r[3]};i.XLSelection._focusBorder(i._dStartCell,i._dEndCell,i._formulaBorder[t%6])},saveEditingValue:function(){var r,u,t,f,n,i,c,l,e,o={},s,a,v,p=this.XLObj,y=p._dataContainer,h;for(f=Object.getOwnPropertyNames(y.sheets),o.EditedData=[],t=0,c=f.length;t<c;t++)for(conSheet=y.sheets[f[t]],e=Object.getOwnPropertyNames(conSheet),r=0,a=e.length;r<a;r++)for(n=parseInt(e[r]),s=Object.getOwnPropertyNames(conSheet[n]),u=0,v=s.length;u<v;u++)i=parseInt(s[u]),conSheet[n][i].isDirty&&(h=parseInt(f[t]),l={SheetIndex:h,Value:this.getPropertyValue(n,i,"value2",h),CellIndex:{RowIndex:n,ColIndex:i}},delete conSheet[n][i].isDirty,o.EditedData.push(l));return o}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.validation=function(n){this.XLObj=n;this._ruleSymbols={Greater:">",GreaterOrEqual:">=",Less:"<",LessOrEqual:"<=",Equal:"==",NotEqual:"!=",Between:">=&&<=&&=",NotBetween:">=&&<=&&!"}};t.spreadsheetFeatures.validation.prototype={_setValidation:function(){this.XLObj.model.allowDataValidation&&(this._initValidator(),this._setValidationToField())},_initValidator:function(){var i=n("#"+this.XLObj._id+"EditForm");i.validate({errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(i,r){var u=r.closest("td"),f=n(i).addClass("e-error");u.find(".e-error").remove();f.insertAfter(r.closest(".e-widget"));f.prepend(t.buildTag("div.e-errortail e-toparrow"));f.css({left:u[0].offsetLeft,top:u[0].offsetTop+r.height()})}})},_setValidationToField:function(){var n=this.XLObj,i=n.XLEdit.getPropertyValueByElem(n.getActiveCellElem(),"rule"),r;delete i.type;n.element.find("#"+n._id+"_"+n.XLEdit._EditCellDetails.fieldName).rules("add",i);r=n.element.find("#"+n._id+"EditForm").validate();t.isNullOrUndefined(i.required)||(r.settings.messages[name]={},r.settings.messages[name].required=n.XLEdit._EditCellDetails.fieldName+(n.XLEdit._EditCellDetails.rowIndex+1)+" is required")},applyDVRules:function(i,r,u,f,e){var o=this.XLObj,l=o.getActiveSheetIndex(),w=!1,c,b,k,s,h,a,d,y,p,v,g;if(o.model.allowDataValidation){typeof i=="string"&&(i=o.getRangeIndices(i));k=o._getSelectedItems(l,i);s=k[0];h={};h.required=!f;switch(u){case"number":r.push("parseInt");h.digits=!0;r.push("number");break;case"decimal":r.push("parseFloat");h.number=!0;r.push("decimal");break;case"date":r.push("parseDate");h.date=!0;r.push("date");break;case"time":r.push("parseTime");r.push("time");break;case"text":r[1]="^"+r[1];r[2]="^"+r[2];r.push("length");r.push("text");break;case"list":d=r[1];r=[];r.push(d);r.push("list")}for(r.push(e),r.push(o._getSelectedItems(l,i)[1]),r.push(l),h.customVal=r.join("_"),h.type=u,y=[],p={},c=0,b=s.length;c<b;c++)v=t.isNullOrUndefined(s[c].colIndex)?{rowIndex:n(s[c]).parent().index(),colIndex:s[c].cellIndex}:s[c],a=o.getCell(v.rowIndex,v.colIndex),p={rowIndex:v.rowIndex,colIndex:v.colIndex,prevRule:o.XLEdit.getPropertyValueByElem(a,"rule")},a.hasClass("e-hlcell")&&(w=!0),a.removeData("rule"),a.removeClass("e-hlcell"),o.XLEdit._updateDataContainer(a[0],{rule:h}),y.push(p);w===!0&&this.highlightInvalidData();o.model.sheets[l]._importRendered||o._isUndoRedo||(g={sheetIndex:l,reqType:"validation",operation:"apply-validation",selectedCells:y,range:o._getAlphaRange(l,s[0].rowIndex,s[0].colIndex,s[s.length-1].rowIndex,s[s.length-1].colIndex)},o._completeAction(g))}},clearDV:function(n){var r=this.XLObj,u,o,i,s,h,e,f,c;if(r.model.allowDataValidation){for(s=r.getActiveSheetIndex(),h={sheetIndex:s,reqType:"validation",operation:"clear-validation",selCells:[]},t.isNullOrUndefined(n)?(u=r.model.sheets[s]._selectedCells,i=r.XLSelection._getSelectedRange({rowIndex:u[0].rowIndex,colIndex:u[0].colIndex},{rowIndex:u[u.length-1].rowIndex,colIndex:u[u.length-1].colIndex})):(e=r.getRangeIndices(n),i=r.XLSelection._getSelectedRange({rowIndex:e[0],colIndex:e[1]},{rowIndex:e[2],colIndex:e[3]})),f=0,c=i.length;f<c;f++)o=r.getCell(i[f].rowIndex,i[f].colIndex),h.selCells.push({rowIndex:i[f].rowIndex,colIndex:i[f].colIndex,rules:r.XLEdit.getPropertyValueByElem(o,"rule")}),r.clearRangeData(null,["rule"],o),o.removeClass("e-hlcell");h.range=r._getAlphaRange(s,i[0].rowIndex,i[0].colIndex,i[i.length-1].rowIndex,i[i.length-1].colIndex);r._isUndoRedo||r._completeAction(h)}},clearHighlightedValData:function(n){var r=this.XLObj,i,s,u,o,f,e,h,c;if(r.model.allowDataValidation){for(o=r.getActiveSheetIndex(),t.isNullOrUndefined(n)?(i=r.model.sheets[o]._selectedCells,u=r.XLSelection._getSelectedRange({rowIndex:i[0].rowIndex,colIndex:i[0].colIndex},{rowIndex:i[i.length-1].rowIndex,colIndex:i[i.length-1].colIndex})):(f=r.getRangeIndices(n),u=r.XLSelection._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]})),e=0,h=u.length;e<h;e++)s=r.getCell(u[e].rowIndex,u[e].colIndex),s.removeClass("e-hlcell");r._isUndoRedo||(c={sheetIndex:o,reqType:"validation",operation:"cl-hl-data",range:t.isNullOrUndefined(n)?this.XLObj._getAlphaRange(1,i[0].rowIndex,i[0].colIndex,i[i.length-1].rowIndex,i[i.length-1].colIndex):n},r._completeAction(c))}},_checkValidation:function(n,i){var r=this.XLObj,c,h,o,s,u,f,e;if(!JSON.parse(i[i.length-3]))return!0;if(n=this._convertValueByType(n,i[4]),i[1]=this._convertValueByType(i[1],i[4]),i[2]=this._convertValueByType(i[2],i[4]),n.length){if(i[i.length-4]==="list"){for(s=!1,h=i[0].indexOf(",")>-1?i[0].split(","):i[0].indexOf("=")>-1?r.getRangeData(r.getRangeIndices(i[0].split("=")[1]),!0):n,o=0,c=h.length;o<c;o++)if(s=h[o].toString()===n,s)break;return t.Spreadsheet.msg=r._getLocStr("ListAlertMsg"),s}return i[0]=this._ruleSymbols[i[0]],i[1].indexOf("=")>-1&&(u=i[1].replace("=",""),f=this.getRangeIndices(u+":"+u),i[1]=r.XLEdit.getPropertyValue(f[0],f[1]).toString()),i[2].indexOf("=")>-1&&(u=i[2].replace("=",""),f=this.getRangeIndices(u+":"+u),i[2]=r.XLEdit.getPropertyValue(f[0],f[1]).toString()),i[0].length<=2?(t.Spreadsheet.msg="The "+i[4]+" should be "+t.Spreadsheet.ValidationText[i[0]]+" "+i[1].replace("^",""),r.operators[i[0]](r.parse[i[3]](n),r.parse[i[3]](i[1]))):(e=[],e=i[0].split("&&"),t.Spreadsheet.msg="The "+i[4]+" should"+t.Spreadsheet.ValidationText[e[2]]+" be between "+i[1].replace("^","")+" and "+i[2].replace("^",""),r.operators[e[2]](r.operators[e[0]](r.parse[i[3]](n),r.parse[i[3]](i[1]))&&r.operators[e[1]](r.parse[i[3]](n),r.parse[i[3]](i[2]))))}return!0},_convertValueByType:function(t,i){if(t.length){var r=this.XLObj;switch(i){case"number":case"decimal":r._isValidDate(t)&&(t=r._dateToInt(t));break;case"date":n.isNumeric(t)&&(t=r.intToDate(t).toString())}}return t},highlightInvalidData:function(i){var r=this.XLObj,a,v,u,f,c,e,s,l,h,o,y;if(r.model.allowDataValidation){for(h=r.getActiveSheetIndex(),t.isNullOrUndefined(i)?(u=r.model.sheets[h]._selectedCells,i=r._getAlphaRange(h,u[0].rowIndex,u[0].colIndex,u[u.length-1].rowIndex,u[u.length-1].colIndex)):(s=r.getRangeIndices(i),u=r.XLSelection._getSelectedRange({rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]})),e=0,a=u.length;e<a;e++)l=t.isNullOrUndefined(u[e].colIndex)?{rowIndex:n(u[e]).parent().index(),colIndex:u[e].cellIndex}:u[e],f=r.getCell(l.rowIndex,l.colIndex),o=r.XLEdit.getPropertyValueByElem(f,"rule"),r.XLEdit.getPropertyValueByElem(f)&&!t.isNullOrUndefined(o)?(v=r.XLEdit.getPropertyValueByElem(f,"type")==="datetime"?r.XLEdit.getPropertyValueByElem(f,"value2").toString():r.XLEdit.getPropertyValueByElem(f).toString(),c=o?!this._checkValidation(v,o.customVal.split("_")):!1):t.isNullOrUndefined(o)||(c=o.required),c?f.addClass("e-hlcell"):f.removeClass("e-hlcell");r._isUndoRedo||(y={sheetIndex:h,reqType:"validation",operation:"hl-data",range:i},r._completeAction(y))}},_replaceRule:function(n,t){this.XLObj._dataContainer.cFormatData[n]=t}};t.isNullOrUndefined(n.validator)||n.validator.addMethod("customVal",function(t,i,r){var u=n("#"+n(i).parents("div")[7].id).data("ejSpreadsheet");return n("#"+u._id+"_Ribbon_freetext").data("ejCheckBox").isChecked()?u.XLValidate._checkValidation(t,r.split("_")):!0},t.Spreadsheet.getMsg)}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.dragFill=function(n){this.XLObj=n;this._customList=[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]];this._fillInfo=null;this._verticalFill=!1;this._uniqueOBracket=String.fromCharCode(129);this._uniqueCBracket=String.fromCharCode(130);this._uniqueCSeparator=String.fromCharCode(131);this._uniqueCOperator=String.fromCharCode(132);this._uniquePOperator=String.fromCharCode(133);this._uniqueSOperator=String.fromCharCode(134);this._uniqueMOperator=String.fromCharCode(135);this._uniqueDOperator=String.fromCharCode(136);this._uniqueModOperator=String.fromCharCode(137)};t.spreadsheetFeatures.dragFill.prototype={positionAutoFillElement:function(t){if(this.XLObj.model.allowAutoFill&&this.XLObj.model.allowSelection){var e,u,f,r,a=0,s=0,h=0,o=0,c,i=this.XLObj,v="e-hide",l=i.getActiveSheetIndex(),y=i._getJSSheetRowHeaderContent(l)[0].querySelectorAll("td.e-rowselected"),p=i._getJSSheetHeader(l)[0].querySelectorAll("th.e-colselected");y.length?(r=y,s=2,h=5,o=4):p.length?(r=p,o=5):(r=i.XLSelection.getSelectedCells(),a=-3,s=0,h=1,o=3);c=r.length;c&&(r=r[c-1],e=i.XLSelection._getSpanIndex(r.className),e&&(r=i.getCell(e.rowIndex,e.colIndex)[0]),u=n(r),f=u.offset(),i.getAutoFillElem().removeClass(v).offset({top:f.top+u.height()+a,left:f.left+u.width()+s}),i.model.autoFillSettings.showFillOptions&&t&&i._getAutoFillOptElem().removeClass(v).offset({top:f.top+u.height()+h,left:f.left+u.width()+o}),i.getSheet(l)._autoFillCell={rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex});i.model.allowFormulaBar&&i.updateFormulaBar()}},hideAutoFillElement:function(){t.isNullOrUndefined(this.XLObj._getAutoFillOptElem())||this.XLObj.getAutoFillElem().addClass("e-hide")},hideAutoFillOptions:function(){t.isNullOrUndefined(this.XLObj._getAutoFillOptElem())||(this.XLObj._getAutoFillOptElem().find("button").data("ejSplitButton")._hidePopup(),this.XLObj._getAutoFillOptElem().addClass("e-hide"))},autoFill:function(n){var i,u,r;if((n=n||{},this.XLObj.model.allowAutoFill&&n.dataRange&&n.fillRange&&n.direction)&&(i=this.XLObj,u=t.Spreadsheet.AutoFillOptions,this._fillInfo=this._getFillInfo(n),n.fillType=n.fillType?n.fillType:this._fillInfo.fillType,this._verticalFill=n.direction==="down"||n.direction==="up",n.sheetIndex=i.getActiveSheetIndex(),r={sheetIndex:n.sheetIndex,reqType:"auto-fill",range:n.fillRange,bRange:n.dataRange,bData:i.getRangeData(n.fillRange),bFormat:i.model.allowCellFormatting&&i.XLFormat.getHashCodeClassAsArray(n.fillRange)},r.rowSel=i._getJSSheetRowHeaderContent(n.sheetIndex)[0].querySelectorAll("td.e-rowselected").length>0?!0:!1,r.colSel=i._getJSSheetHeader(n.sheetIndex)[0].querySelectorAll("th.e-colselected").length>0?!0:!1,!i._trigger("autoFillBegin",n))){switch(n.fillType){case u.FillSeries:case u.FillWithoutFormatting:this._fillSeries(n);break;case u.CopyCells:case u.FillFormattingOnly:this._copyCells(n);break;case u.FlashFill:r.actionType="flash-fill";r.bdData=i.getRangeData(n.dataRange);this._flashFill(n);r.adData=i.getRangeData(n.dataRange)}r.aData=i.getRangeData(n.fillRange);r.aFormat=i.model.allowCellFormatting&&i.XLFormat.getHashCodeClassAsArray(n.fillRange);i._completeAction(r);i._trigger("autoFillComplete",n)}},_fillSeries:function(i){for(var u,st,o,r,rt,s,h,p,ht,w,ut,v,ct,b,k,c,l,a,lt,e=0,f=this.XLObj,yt=f.getActiveSheetIndex(),d=t.Spreadsheet.autoFillDirection,g=t.Spreadsheet.CellType,nt=i.dataRange[0],tt=i.dataRange[1],at=i.dataRange[2],vt=i.dataRange[3],ft=i.fillRange[0],et=i.fillRange[1],pt=i.fillRange[2],wt=i.fillRange[3],it=[d.Down,d.Up].indexOf(i.direction)>-1,y=[d.Up,d.Left].indexOf(i.direction)>-1,bt=it?vt-tt:at-nt,ot=i.fillType===t.Spreadsheet.AutoFillOptions.FillSeries;e<=bt;){if(it?(b={rowIndex:nt,colIndex:tt+e},k={rowIndex:at,colIndex:tt+e},c={rowIndex:ft,colIndex:et+e},l={rowIndex:pt,colIndex:et+e}):(b={rowIndex:nt+e,colIndex:tt},k={rowIndex:nt+e,colIndex:vt},c={rowIndex:ft+e,colIndex:et},l={rowIndex:ft+e,colIndex:wt}),rt=[b.rowIndex,b.colIndex,k.rowIndex,k.colIndex],o=this._getPattern(rt,{isRFill:y,isVFill:it}),!o)return;for(st=o.length,ot&&(f.model.allowCellFormatting&&f.XLFormat.clearFormat([c.rowIndex,c.colIndex,l.rowIndex,l.colIndex]),v=f.getRangeData(rt,null,["format"]),ct=v.length),a=f.getRange(c.rowIndex,c.colIndex,l.rowIndex,l.colIndex),lt=a.length,y&&(a=a.toArray().reverse(),o=o.reverse(),o=this._ensurePattern(o),ot&&(v=v.reverse())),h=0;h<lt;){r=o[h%st];f.isNumber(r)&&(r=o[r]);switch(r.type){case g.Number:u=f._round(r.regVal.a+r.regVal.b*r.i,5);y?r.i--:r.i++;break;case g.String:u=r.val[r.i%r.val.length];r.i++;break;case g.Formula:for(ut=!1,u="=",p=0,ht=r.val.length;p<ht;)s=r.val[p],f._isObject(s)?(ut=!0,w=f._round(s.a+s.b*r.i,0),u+=w<1?"#REF!":it?s.c+w:f._generateHeaderText(yt,w)+s.c):u+=s,p++;ut&&y?r.i--:r.i++;break;case g.Custom:u=f._round(r.regVal.a+r.regVal.b*r.i,0);u<0&&(u=u%r.len+r.len);u>=r.len&&(u=u%r.len);u=r.val[u];y?r.i--:r.i++}f.XLEdit.updateCellValue(n(a[h]),u,ot?v[h%ct].format:null);f.model.allowComments&&f.XLComment._updateCmntFrmCntnr(null,null,n(a[h]));h++}e++}},_ensurePattern:function(n){for(var i,u=-1,r=n.length;r--;)i=n[r],this.XLObj._isObject(i)?(u=r,i.type===t.Spreadsheet.CellType.String&&(i.val=i.val.reverse())):n[r]=u;return n},_copyCells:function(i){for(var r,w,o,s,c,l,a,b,h,e,k,u=this.XLObj,f=0,v=t.Spreadsheet.autoFillDirection,y=i.dataRange[0],p=i.dataRange[1],it=i.dataRange[2],rt=i.dataRange[3],d=i.fillRange[0],g=i.fillRange[1],ft=i.fillRange[2],et=i.fillRange[3],ut=[v.Down,v.Up].indexOf(i.direction)>-1,ot=[v.Up,v.Left].indexOf(i.direction)>-1,st=ut?rt-p:it-y,nt=i.fillType===t.Spreadsheet.AutoFillOptions.FillFormattingOnly,tt;f<=st;){if(ut?(c={rowIndex:y,colIndex:p+f},l={rowIndex:it,colIndex:p+f},o={rowIndex:d,colIndex:g+f},s={rowIndex:ft,colIndex:g+f}):(c={rowIndex:y+f,colIndex:p},l={rowIndex:y+f,colIndex:rt},o={rowIndex:d+f,colIndex:g},s={rowIndex:d+f,colIndex:et}),w=[c.rowIndex,c.colIndex,l.rowIndex,l.colIndex],u.model.allowCellFormatting&&u.XLFormat.clearFormat([o.rowIndex,o.colIndex,s.rowIndex,s.colIndex]),nt||(a=u.getRangeData(w,!0,null,null,!0)),h=u.getRangeData(w,null,["format"]),b=h.length,e=u.getRange(o.rowIndex,o.colIndex,s.rowIndex,s.colIndex),k=e.length,r=0,ot&&(e=e.toArray().reverse(),h=h.reverse(),nt||(a=a.reverse())),nt)while(r<k)u.model.allowCellFormatting&&u.XLFormat._updateFormatClass(e[r],h[r%b].format),r++;else while(r<k)tt=r%b,u.XLEdit.updateCellValue(n(e[r]),a[tt],h[tt].format),u.model.allowComments&&u.XLComment._updateCmntFrmCntnr(null,null,n(e[r])),r++;f++}},_flashFill:function(t){var r,o,s,i=this.XLObj,h=t.dataRange[0],c=t.dataRange[2],u=t.fillRange[0],l=t.fillRange[1],f=t.fillRange[2],a=t.fillRange[3],e=this._getFlashFillPattern(t.dataRange,"left");if(e)for(o=i.getRangeData([u,e.colIndex,f,e.colIndex],!0,null,null,!0),e.subStr>-1&&(o=this._splitString(o," ",e.subStr)),r=i.getRange(u,l,f,a),s=r.length;s--;)i.XLEdit.updateCellValue(n(r[s]),o[s]);else u>h&&(u=h),f<c&&(f=c),r=i.getRange(u,l,f,a),i._getAutoFillOptElem().addClass("e-hide"),i.updateUniqueData({value:"",value2:"",type:"general"},null,r),i._showAlertDlg("Alert","FlashFillAlert")},_getFlashFillPattern:function(n,i){var u,f,h,a,e,r=0,o=-1,v=this.XLObj,s=v.getRangeData(n,!0,null,null,!0),y=s.length,c=n[0],p=t.Spreadsheet.autoFillDirection.Right,w=i===p,l;if(s.join().replace(/,/g,"").length&&(l=s[0].toString(),r=n[1],r)){while(w?r++:r--)if(f=v.XLEdit.getPropertyValue(c,r),f=t.isNullOrUndefined(f)?"":f.toString(),f.length){if(f===l)if(y>1){if(u=this._matchData(c,r,s),u)return u}else return{colIndex:r,subStr:o};for(h=f.split(" "),a=h.length,e=0;e<a;){if(l===h[e])if(o=e,y>1){if(u=this._matchData(c,r,s),u)return o>u.subStr&&(u.subStr=o),u}else return{colIndex:r,subStr:o};e++}}else break;if(!w)return this._getFlashFillPattern(n,p)}},_matchData:function(n,i,r){for(var u,o=!1,s,f,h,l,e=1,c=-1,a=r.length;e<a;){if(o=!1,s=r[e].toString(),f=this.XLObj.XLEdit.getPropertyValue(n+e,i),f=t.isNullOrUndefined(f)?"":f.toString(),s===f){o=!0;e++;continue}for(h=f.split(" "),l=h.length,u=0;u<l;){if(s===h[u]){c<u&&(c=u);o=!0;break}u++}e++}if(o&&e===a)return{colIndex:i,subStr:c}},_splitString:function(n,t,i){for(var e,u,f=n.length,r;f--;){for(r=i,e=n[f].split(t);r>-1;){if(u=e[r],u)break;r--}n[f]=u}return n},_getPattern:function(n,i){var u,o,s,a,l,v,w,b,h,e,y=0,f=[],k=this.XLObj,c=t.Spreadsheet.CellType,p=this._getDataPattern(n),d=p.length,r;if(p){while(y<d){r=p[y];switch(r.type){case c.Number:for(o=f.length,e=r.val.length,h=i.isRFill?-1:e,e===1&&r.val.push(r.val[0]+1),a=this._getPredictionValue(r.val),s={regVal:a,type:r.type,i:h},f.push(s),u=1;u<e;)f.push(o),u++;break;case c.String:for(o=f.length,s={val:r.val,type:r.type,i:0},f.push(s),u=1,e=r.val.length;u<e;)f.push(o),u++;break;case c.Formula:if(e=r.val.length,r=this._getFormulaPattern(r.val,i),h=i.isRFill?-1:e,r.isInPattern)for(o=f.length,s={val:r.val,type:c.Formula,i:h},f.push(s),u=1;u<e;)f.push(o),u++;else for(u=0,h=i.isRFill?-1:1;u<e;)f.push({val:r.val[u],type:c.Formula,i:h}),u++;break;default:if(r.type.indexOf(c.Custom)>-1)for(o=f.length,e=r.val.length,h=i.isRFill?-1:e,l=this._customList[Number(r.type.replace(c.Custom,""))],b=l.indexOf(r.val[0])===-1,v=k.toArrayLowerCase(l.slice(0)),w=k.toArrayLowerCase(r.val),a=this._getCustomPredictionValue(w,v),s={val:b?v:l,regVal:a,i:h,type:c.Custom,len:l.length},f.push(s),u=1;u<e;)f.push(o),u++}y++}return f}},_getCustomPredictionValue:function(n,t){for(var r=0,i=[],u=n.length;r<u;)i.push(t.indexOf(n[r])),r++;return i.length===1&&i.push(i[0]+1),this._getPredictionValue(i)},_getDataPattern:function(n){var i,r,u=0,t={},f=[],e=this.XLObj.getRangeData(n,!0,null,null,!0),o=e.length;if(o){while(u<o)i=e[u],r=this._getType(i),u===0?t={val:[i],type:r}:r===t.type?t.val.push(i):(f.push(t),t={val:[i],type:r}),u++;return f.push(t),f}},_getFormulaPattern:function(n,t){for(var r,e,u,h=this.XLObj,f=[],i=0,s=n.length,o;i<s;)f.push(this._parseFormula(n[i])),i++;if(o=this._isInPattern(f,t.isVFill),o){for(r=f[0],i=r.length;i--;)u=r[i],h._isCellReference(u)&&(r[i]=this._getCellRefPrediction(u,t));return{isInPattern:o,val:r}}for(i=0;i<s;){for(r=f[i],e=r.length;e--;)u=r[e],h._isCellReference(u)&&(f[i][e]=this._getCellRefPrediction(u,t,s));i++}return{isInPattern:o,val:f}},_getCellRefPrediction:function(n,t,i){n=n.toUpperCase();var u=[],e=new RegExp("[a-z]","gi"),o=new RegExp("[0-9]","g"),f="",s=t.isVFill?n.replace(o,f):n.replace(e,f),r=t.isVFill?Number(n.replace(e,f)):this.XLObj._generateColCount(n.replace(o,f));return i&&i!==1?(u.push(r),u.push(r+i)):(u.push(r),u.push(r+1)),r=this._getPredictionValue(u),r.c=s,r},_isInPattern:function(n,t){var o,i,s,a,r,u,h,c,f=this.XLObj,e="",v=0,l=1,y=n.length,p=new RegExp("[0-9]","g"),w=new RegExp("[a-z]","gi");if(y===1)return!1;while(l<y){if(o=n[v],s=n[l],i=o.length,a=s.length,i!==a)return!1;while(i--)if(r=o[i],u=s[i],f._isCellReference(r)===f._isCellReference(u)){if(t?(h=Number(r.replace(w,e)),c=Number(u.replace(w,e))):(h=f._generateColCount(r.replace(p,e)),c=f._generateColCount(u.replace(p,e))),h!==c-1)return!1}else if(r!==u)return!1;v++;l++}return!0},_parseFormula:function(n){var t,u,r=0,i=[],f;for(n=this._markSpecialChar(n.replace("=","")),n=n.split(/\(|\)|,|:|\+|-|\*|\/|%/g),f=n.length;r<f;){if(t=n[r],!t){r++;continue}t.length===1?i.push(this._isUniqueChar(t)?this._getUniqueCharVal(t):t):(u=t[0],this._isUniqueChar(u)?(i.push(this._getUniqueCharVal(u)),i.push(t.substr(1))):i.push(t));r++}return i},_getUniqueCharVal:function(n){switch(n){case this._uniqueOBracket:return"(";case this._uniqueCBracket:return")";case this._uniqueCSeparator:return",";case this._uniqueCOperator:return":";case this._uniquePOperator:return"+";case this._uniqueSOperator:return"-";case this._uniqueMOperator:return"*";case this._uniqueDOperator:return"/";case this._uniqueModOperator:return"%"}return""},_isUniqueChar:function(n){var t=n.charCodeAt(n);return t>=129&&t<=137},_markSpecialChar:function(n){return n=n.replace(/\(/g,"("+this._uniqueOBracket).replace(/\)/g,")"+this._uniqueCBracket),n=n.replace(/,/g,","+this._uniqueCSeparator).replace(/:/g,":"+this._uniqueCOperator),n=n.replace(/\+/g,"+"+this._uniquePOperator).replace(/-/g,"-"+this._uniqueSOperator),n=n.replace(/\*/g,"*"+this._uniqueMOperator).replace(/\//g,"/"+this._uniqueDOperator),n.replace(/%/g,"%"+this._uniqueModOperator)},_getPredictionValue:function(n){for(var t=0,i=0,u=0,f=0,r=0,e=n.length,o,s;t<e;)i=i+t,u=u+Number(n[t]),f=f+t*Number(n[t]),r=r+t*t,t++;return o=this.XLObj._round((u*r-i*f)/(e*r-i*i),5),s=this.XLObj._round((e*f-i*u)/(e*r-i*i),5),{a:o,b:s}},_getType:function(n){var i=this._isCustomType(n),r=t.Spreadsheet.CellType,u=this.XLObj;return i?i=i:u.isFormula(n)?i=r.Formula:u.isNumber(n)&&(i=r.Number),i||r.String},_isCustomType:function(n){n=n+"";n=n.toLowerCase();for(var i=this._customList.length;i--;)if(this.XLObj.toArrayLowerCase(this._customList[i].slice(0)).indexOf(n)>-1)return t.Spreadsheet.CellType.Custom+i;return!1},_selectAutoFillRange:function(n,t){var u,r,i,f;if(n&&(t={rowIndex:n.parentNode.rowIndex,colIndex:n.cellIndex}),r=this.XLObj,i=this._getAutoFillRange(t),i){for(this._autoFillCleanUp(),f=r.getRange(i.startCell.rowIndex,i.startCell.colIndex,i.endCell.rowIndex,i.endCell.colIndex),u=f.length;u--;)r.addClass(f[u],"e-autofillcell");r.XLSelection._focusRange(i.startCell,i.endCell,r._autofillBorder)}},_getAutoFillRange:function(n){var e=t.Spreadsheet.autoFillDirection,v=this.XLObj,l=this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()),y=l._startCell,p=l._endCell,o=l._autoFillCell,h=l.selectedRange,u=h[0],f=h[1],r=h[2],i=h[3],a=v.inRange(h,n.rowIndex,n.colIndex),s={rowIndex:u,colIndex:f},c={rowIndex:r,colIndex:i};if(n.rowIndex<o.rowIndex){if(u-n.rowIndex>n.colIndex-i&&u-n.rowIndex>f-n.colIndex)return a?{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i}}:{startCell:c,endCell:{rowIndex:n.rowIndex,colIndex:f},fillRange:[n.rowIndex,f,u-1,i],direction:e.Up};if(n.colIndex>o.colIndex)return{startCell:s,endCell:{rowIndex:r,colIndex:n.colIndex},fillRange:[u,i+1,r,n.colIndex],direction:e.Right};if(n.colIndex<o.colIndex)return a?{startCell:s,endCell:c}:{startCell:c,endCell:{rowIndex:u,colIndex:n.colIndex},fillRange:[u,n.colIndex,r,f-1],direction:e.Left}}else{if(n.colIndex>o.colIndex)return n.rowIndex-r>n.colIndex-i?{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[r+1,f,n.rowIndex,i],direction:e.Down}:{startCell:s,endCell:{rowIndex:r,colIndex:n.colIndex},fillRange:[u,i+1,r,n.colIndex],direction:e.Right};if(n.colIndex<o.colIndex)return n.rowIndex-r>i-n.colIndex||n.rowIndex-u>i-n.colIndex?{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[r+1,f,n.rowIndex,i],direction:e.Down}:a?{startCell:s,endCell:c}:{startCell:c,endCell:{rowIndex:u,colIndex:n.colIndex},fillRange:[u,n.colIndex,r,f-1],direction:e.Left};if(n.rowIndex>o.rowIndex)return{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[r+1,f,n.rowIndex,i],direction:e.Down};if(n.rowIndex===o.rowIndex&&n.colIndex===o.colIndex)return{startCell:y,endCell:p}}},_getDirection:function(n,i,r){var u=t.Spreadsheet.autoFillDirection;if(r=this.XLObj.isUndefined(r)?this._verticalFill:r,r){if(i.rowIndex<n.rowIndex)return u.Up;if(i.rowIndex>n.rowIndex)return u.Down;if(i.colIndex>n.colIndex)return u.Right;if(i.colIndex<n.colIndex)return u.Left}else{if(i.colIndex>n.colIndex)return u.Right;if(i.colIndex<n.colIndex)return u.Left;if(i.rowIndex<n.rowIndex)return u.Up;if(i.rowIndex>n.rowIndex)return u.Down}return null},_getFillRange:function(n,i,r,u){var f=t.Spreadsheet.autoFillDirection;switch(u){case f.Up:return[r.rowIndex,n.colIndex,n.rowIndex-1,i.colIndex];case f.Right:return[n.rowIndex,i.colIndex+1,i.rowIndex,r.colIndex];case f.Down:return[i.rowIndex+1,n.colIndex,r.rowIndex,i.colIndex];case f.Left:return[n.rowIndex,r.colIndex,i.rowIndex,n.colIndex-1]}return null},_autoFillOptionClick:function(t){var e=n("#"+t.model.targetID),o=e.find("#"+t.ID).find(">>"),u=this.getActiveSheetIndex(),s=this._getJSSheetHeader(u)[0].querySelectorAll("th.e-colselected"),h=this._getJSSheetRowHeaderContent(u)[0].querySelectorAll("td.e-rowselected");if(!this._hasClass(o[0],"e-ss-fillselect")){var r=this.XLDragFill,i=this.getSheet(this.getActiveSheetIndex()),f=r._getDirection(this._pEndCell,this._pFillCell),c=this.swapRange([this._pStartCell.rowIndex,this._pStartCell.colIndex,this._pEndCell.rowIndex,this._pEndCell.colIndex]),l=r._getFillRange(this._pStartCell,this._pEndCell,this._pFillCell,f),a=i._startCell,v=i._endCell;this._isUndo=!0;this._performUndoRedo();s.length<1&&h.length<1&&(i._startCell=a,i._endCell=v,this.XLSelection.selectRange(i._startCell,i._endCell));r.positionAutoFillElement(!0);r.autoFill({dataRange:c,fillRange:l,direction:f,fillType:t.ID});r._fillInfo.fillType=t.ID;this._isUndo=!1}},_autoFillCleanUp:function(){var i,n,r,f="e-hide",t=this.XLObj,e=t.getAutoFillElem(),o=t._getAutoFillOptElem(),u;for(e&&t.addClass(e[0],f),o&&t.addClass(o[0],f),u=t._getContent(t.getActiveSheetIndex())[0].querySelectorAll("td.e-autofillcell"),i=u.length;i--;)r=u[i],n=r.className,n=n.replace(/e-autofillcell|e-blur/g,""),n=n.replace(/ +/g," "),r.className=n},_autoFillClick:function(){var f,r=0,i=n("#"+this._id+"_ctxtmenu").find("li"),u="e-ss-fillselect",t;for(t=i.find("."+u),t.length&&(t=t[0],this._removeClass(t,u),this.addClass(t,"e-ss-filloption")),i.show(),f=this.XLDragFill._fillInfo.disableItems.length;r<f;)n(i[this.XLDragFill._fillInfo.disableItems[r]]).hide(),r++;i.filter("#"+this.XLDragFill._fillInfo.fillType).find("span").addClass(u)},_fillRange:function(n,i){var f,o,r={},e=this.XLObj,s=e.getSheet(e.getActiveSheetIndex()),u=t.Spreadsheet.autoFillDirection;if(i=i?i:s.selectedRange,f=this._getDirection({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]},n),o=n?f===u.Down:f===u.Right,e.isRange(i)&&o)n?(r.dataRange=[i[0],i[1],i[0],i[3]],r.fillRange=[i[0]+1,i[1],i[2],i[3]]):(r.dataRange=[i[0],i[1],i[2],i[1]],r.fillRange=[i[0],i[1]+1,i[2],i[3]]);else{if(n){if(!i[0])return;r.dataRange=[i[0]-1,i[1],i[0]-1,i[3]]}else{if(!i[1])return;r.dataRange=[i[0],i[1]-1,i[2],i[1]-1]}r.fillRange=i}r.direction=n?u.Down:u.Right;r.fillType=t.Spreadsheet.AutoFillOptions.CopyCells;this.autoFill(r)},_getFillInfo:function(n){var f,i,e=!0,s=t.Spreadsheet.AutoFillOptions.CopyCells,o=[],r=this.XLObj,h=t.Spreadsheet.autoFillDirection,c=[h.Down,h.Up].indexOf(n.direction)>-1,u=r.getRangeData(n.dataRange,!0,null,null,!0),l=u.join().replace(/,/g,"").length;if(r.isRange(n.dataRange)&&l){for(f=u.length;f--;)if(i=u[f],r.isNumber(i)||r.isFormula(i)||this._isCustomType(i)){e=!1;s=t.Spreadsheet.AutoFillOptions.FillSeries;break}}else i=u[0],(r.isNumber(i)||r.isFormula(i)||this._isCustomType(i))&&(e=!1);return(!l||e)&&o.push(1),(!c||c&&n.dataRange[1]!==n.dataRange[3])&&o.push(4),{fillType:s,disableItems:o}}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellNavigation=function(n){this.XLObj=n;this._canKeyBoardNavigate=!0;this._isNavigate=!0;this._scrollReverse=!1};t.spreadsheetFeatures.cellNavigation.prototype={_selectionKeyDownHandler:function(n){var l,v,f,o,c,w,b,t=this.XLObj,h=t.getActiveSheetIndex(),r=t.getSheet(h),i=n.keyCode,a=n.shiftKey,k=n.ctrlKey,e={keyCode:i,shiftKey:a,ctrlKey:k,altKey:n.altKey},u=r._activeCell,s=r._endCell,y=r.rowCount,p=r.colCount;if((i===9&&this._canKeyBoardNavigate||i===13)&&!k){if(n.preventDefault(),l=n.target.value,t.XLEdit._isFormulaEdit&&!t._isFormulaSuggestion)if(l.length>1)if(this._isValidParameter(l))t.isFormula(l)||(l=l+")",t.getActiveCellElem(h).find("input:visible").val(l),t._getInputBox().val(l)),t.XLEdit.saveCell(),t._getContent(h).find("td").removeClass(t._formulaBorder.join(" ").replace(/,/g," ")+" "+t._ctrlFormulaBorder.join(" ").replace(/,/g," ")),t.XLSelection._cleanUp(),t.XLSelection.selectRange(r._activeCell,r._activeCell),t.XLEdit._isFormulaEdit=!1,t._formulaRange=[],t._ctrlKeyCount=0;else{t._showAlertDlg("Alert","MissingParenthesisAlert","MissingParenthesis",440);return}else t.XLEdit.saveCell(),t.XLEdit._isFormulaEdit=!1;v=t._getJSSheetRowHeaderContent(h).find(".e-rowselected").length>0?t._getJSSheetRowHeaderContent(h).find(".e-rowselected"):t._getJSSheetHeader(h).find(".e-colselected").length>0?t._getJSSheetHeader(h).find(".e-colselected"):t._getContent(h).find(".e-selected");v.length&&(w=v[0].className,v.length===1||v.length-1===v.filter(".e-mc-hide").length?w.indexOf("e-rowcell")>-1?a?i===9&&u.colIndex>0?this._navigateCell(u.rowIndex,u.colIndex-1,e):i===13&&u.rowIndex>0&&this._navigateCell(u.rowIndex-1,u.colIndex,e):i===9&&u.colIndex<p?this._navigateCell(u.rowIndex,u.colIndex+1,e):i===13&&u.rowIndex<y&&this._navigateCell(u.rowIndex+1,u.colIndex,e):w.indexOf("e-rowselected")>-1?a?u.colIndex>0&&this._navigateRow("Backward",e):u.colIndex<39&&this._navigateRow("Forward",e):w.indexOf("e-colselected")>-1&&(a?u.rowIndex>0&&this._navigateCol("Backward",e):u.rowIndex<39&&this._navigateCol("Forward",e)):a?i===9?this._navigateRange("ShiftTab",e):this._navigateRange("ShiftEnter",e):i===9?this._navigateRange("Tab",e):this._navigateRange("Enter",e))}else if((i===37||i===38&&!t._isFormulaSuggestion||i===39||i===40&&!t._isFormulaSuggestion)&&this._isNavigate)if(n.preventDefault(),t.XLEdit._isFormulaEdit)c=t.swapRange([t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex]),t.getRange(c[0]?c[0]-1:c[0],c[1]?c[1]-1:c[1],c[2],c[3]).removeClass(t._formulaBorder[t._ctrlKeyCount%6].join(" ")+" "+t._ctrlFormulaBorder[t._ctrlKeyCount%6].join(" ")),k&&(f=t._dStartCell,i===37&&f.colIndex>0?t._dStartCell=t._dEndCell={rowIndex:f.rowIndex,colIndex:0}:i===38&&f.rowIndex>0?t._dStartCell=t._dEndCell={rowIndex:0,colIndex:f.colIndex}:i===39&&f.colIndex<r.colCount?t._dStartCell=t._dEndCell={rowIndex:f.rowIndex,colIndex:r.colCount}:i===40&&f.rowIndex<y&&(t._dStartCell=t._dEndCell={rowIndex:r.colCount,colIndex:f.colIndex})),a||t._shiftKeyEnabled?(o=t._dEndCell,i===37&&o.colIndex>0?t._dEndCell={rowIndex:o.rowIndex,colIndex:o.colIndex-1}:i===38&&o.rowIndex>0?t._dEndCell={rowIndex:o.rowIndex-1,colIndex:o.colIndex}:i===39&&o.colIndex<r.colCount?t._dEndCell={rowIndex:o.rowIndex,colIndex:o.colIndex+1}:i===40&&o.rowIndex<r.rowCount&&(t._dEndCell={rowIndex:o.rowIndex+1,colIndex:o.colIndex})):(f=t._dStartCell,i===37&&f.colIndex>0?t._dStartCell=t._dEndCell={rowIndex:f.rowIndex,colIndex:f.colIndex-1}:i===38&&f.rowIndex>0?t._dStartCell=t._dEndCell={rowIndex:f.rowIndex-1,colIndex:f.colIndex}:i===39&&f.colIndex<r.colCount?t._dStartCell=t._dEndCell={rowIndex:f.rowIndex,colIndex:f.colIndex+1}:i===40&&f.rowIndex<r.rowCount&&(t._dStartCell=t._dEndCell={rowIndex:f.rowIndex+1,colIndex:f.colIndex})),t.XLSelection._processFormulaRange(t._ctrlFormulaBorder),t._formulaRange[t._ctrlKeyCount]=t._getProperAlphaRange(h,t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex);else if(k)i===37&&u.colIndex>0?this._navigateCell(u.rowIndex,0,e):i===38&&u.rowIndex>0?this._navigateCell(0,u.colIndex,e):i===39&&u.colIndex<p-1?this._navigateCell(u.rowIndex,p-1,e):i===40&&u.rowIndex<y-1&&this._navigateCell(y-1,u.colIndex,e);else if(a){if(i===37&&s.colIndex>0?r._endCell={rowIndex:s.rowIndex,colIndex:s.colIndex-1}:i===38&&s.rowIndex>0?r._endCell={rowIndex:s.rowIndex-1,colIndex:s.colIndex}:i===39&&s.colIndex<p?r._endCell={rowIndex:s.rowIndex,colIndex:s.colIndex+1}:i===40&&s.rowIndex<y&&(r._endCell={rowIndex:s.rowIndex+1,colIndex:s.colIndex}),(r.rowCount===r._endCell.rowIndex||r.colCount===r._endCell.colIndex)&&t.model.scrollSettings.scrollMode==="normal")return;if((r.rowCount===r._endCell.rowIndex||r.colCount===r._endCell.colIndex)&&!t.model.scrollSettings.allowScrolling)return;t.model.scrollSettings.allowScrolling&&(r.rowCount===r._endCell.rowIndex&&t.XLScroll._scrollY(h),r.colCount===r._endCell.colIndex&&t.XLScroll._scrollX(h));this._isHiddenCell(t.getCell(r._endCell.rowIndex,r._endCell.colIndex))&&(b={rowIndex:r._endCell.rowIndex,colIndex:r._endCell.colIndex},this._skipHiddenRowsAndCols(b,e),r._endCell.rowIndex=b.rowIndex,r._endCell.colIndex=b.colIndex);t.XLSelection.selectRange(r._startCell,r._endCell);t.model.allowAutoFill&&t.XLDragFill.positionAutoFillElement()}else if(e={keyCode:i,shiftKey:!1,ctrlKey:!1,altKey:!1},i===37&&u.colIndex>0)this._navigateCell(u.rowIndex,u.colIndex-1,e);else if(i===38&&u.rowIndex>0)this._navigateCell(u.rowIndex-1,u.colIndex,e);else if(i===39&&u.colIndex<p)this._navigateCell(u.rowIndex,u.colIndex+1,e);else if(i===40&&u.rowIndex<y)this._navigateCell(u.rowIndex+1,u.colIndex,e);else return!1},_navigateCell:function(i,r,u){var p,k,h,b,s={rowIndex:i,colIndex:r},f=this.XLObj,c=f.getActiveSheetIndex(),e=f.getSheet(c),l=f._getContent(c),v=l.find("#hscrollBar").data("ejScrollBar"),y=l.find("#vscrollBar").data("ejScrollBar"),a=l.find(".e-content"),o,w=!1;if((e.rowCount!==s.rowIndex&&e.colCount!==s.colIndex||f.model.scrollSettings.scrollMode!=="normal")&&(e.rowCount!==s.rowIndex&&e.colCount!==s.colIndex||f.model.scrollSettings.allowScrolling)){e.rowCount===s.rowIndex&&(f.XLScroll._scrollY(c),w=!0);e.colCount===s.colIndex&&(f.XLScroll._scrollX(c),w=!0);o=f.getCell(s.rowIndex,s.colIndex);this._isHiddenCell(o)&&this._skipHiddenRowsAndCols(s,u);h=f.getCell(s.rowIndex,s.colIndex)[0];b=a.find(".e-activecell");b.hasClass("e-merge")&&h.className.indexOf("e-rc-")>-1&&this._updateMergeRange(b,s,u);o.length>0&&(e._activeCell=e._endCell=e._startCell=s);!t.isNullOrUndefined(h)&&(h.className.indexOf("e-rc-")>-1||f.hasSpan(h.rowSpan)||f.hasSpan(h.colSpan))&&(f.XLSelection._processBoundary(),e._activeCell=e._startCell,o=f.getCell(e._activeCell.rowIndex,e._activeCell.colIndex),k=!0);o.length<1?u.keyCode==40||u.keyCode==13?f.XLScroll._scrollY(c):(u.keyCode==39||u.keyCode==9)&&f.XLScroll._scrollX(c):(f.model.scrollSettings.allowScrolling&&a.offset().top+a[0].offsetHeight<=o.offset().top+o[0].offsetHeight&&(u.keyCode==40||u.keyCode==13&&!u.shiftKey)&&!w?(y._scrollData.step=1,u.ctrlKey&&u.keyCode==40?f.XLScroll._scrollSelectedPosition(c,f.getActiveCell(c)):y.scroll(y.value()+parseInt(o.parent()[0].style.height),!0)):f.model.scrollSettings.allowScrolling&&o.offset().top-e._frozenHeight<=a.offset().top&&(u.keyCode==38||u.keyCode==13&&u.shiftKey)&&!w&&!f._hasClass(l.find("tr").eq(o[0].parentNode.rowIndex)[0],"e-fr-hide")&&(y._scrollData.step=-1,o.parent().index()>0?y.scroll(y.value()-parseInt(o.parent()[0].style.height),!0):y.scroll(0)),f.model.scrollSettings.allowScrolling&&a[0].offsetWidth<=o.offset().left+o[0].offsetWidth&&(u.keyCode==39||u.keyCode==9&&!u.shiftKey)&&!w?(v._scrollData.step=1,u.ctrlKey&&u.keyCode==39?f.XLScroll._scrollSelectedPosition(c,f.getActiveCell(c)):v.scroll(v.value()+o[0].offsetWidth,!0)):f.model.scrollSettings.allowScrolling&&o.offset().left-e._frozenWidth<=a.offset().left&&(u.keyCode==37||u.keyCode==9&&u.shiftKey)&&!w&&(v._scrollData.step=-1,o.get(0).cellIndex>0?v.scroll(v.value()-o[0].offsetWidth,!0):v.scroll(0)));p=l.find("col");var nt=n(f.getRows(c)[1]),d=e._startCell.rowIndex,g=e._startCell.colIndex;for(h=f.getCell(d,g),h.length>0&&((a[0].offsetWidth>=h.offset().left||a.offset().left+a[0].offsetWidth>=h.offset().left+h[0].offsetWidth)&&(u.keyCode==39||u.keyCode==9&&!u.shiftKey)&&(f.XLSelection.selectRange(e._startCell,e._startCell),f.model.showRibbon&&f.XLRibbon._updateRibbonIcons(),f.model.allowAutoFill&&f.XLDragFill.positionAutoFillElement()),(!p.eq(g).hasClass("e-fc-hide")||u.keyCode==37||u.keyCode==9&&u.shiftKey)&&(f.XLSelection.selectRange(e._startCell,e._endCell),f.model.showRibbon&&f.XLRibbon._updateRibbonIcons(),f.model.allowAutoFill&&f.XLDragFill.positionAutoFillElement()),!nt.eq(d).hasClass("e-fr-hide")&&(u.keyCode==38||u.keyCode==13&&u.shiftKey)&&(f.XLSelection.selectRange(e._startCell,e._endCell),f.model.showRibbon&&f.XLRibbon._updateRibbonIcons(),f.model.allowAutoFill&&f.XLDragFill.positionAutoFillElement()),(a.offset().top+a[0].offsetHeight>=h.offset().top||a.offset().top+a[0].offsetHeight>=h.offset().top+h[0].offsetHeight)&&(u.keyCode==40||u.keyCode==13&&!u.shiftKey)&&(f.XLSelection.selectRange(e._startCell,e._endCell),f.model.showRibbon&&f.XLRibbon._updateRibbonIcons(),f.model.allowAutoFill&&f.XLDragFill.positionAutoFillElement())),k&&(u.keyCode===37||u.shiftKey&&u.keyCode===9?s.colIndex=e._startCell.colIndex:u.keyCode===38||u.shiftKey&&u.keyCode===13?s.rowIndex=e._startCell.rowIndex:u.keyCode===39||u.keyCode===9?s.colIndex=e._endCell.colIndex:(u.keyCode===40||u.keyCode===13)&&(s.rowIndex=e._endCell.rowIndex),e._activeCell=s),e._startCell={rowIndex:o[0].parentNode.rowIndex,colIndex:o[0].cellIndex};(u.keyCode===37||u.shiftKey&&u.keyCode===9)&&f._hasClass(p[e._startCell.colIndex],"e-c-hide");)f._removeClass(p[e._startCell.colIndex],"e-fc-hide"),e._startCell.colIndex--;while((u.keyCode===38||u.shiftKey&&u.keyCode===13)&&f._hasClass(l.find("tr")[e._startCell.rowIndex],"e-r-hide"))f._removeClass(l.find("tr")[e._startCell.rowIndex],"e-fr-hide"),e._startCell.rowIndex--;while((u.keyCode===39||u.keyCode===9)&&f._hasClass(p[e._startCell.colIndex],"e-c-hide"))e._startCell.colIndex++;while((u.keyCode===40||u.keyCode===13)&&f._hasClass(l.find("tr")[e._startCell.rowIndex],"e-r-hide"))e._startCell.rowIndex++;rIdx=e._startCell.rowIndex;cIdx=e._startCell.colIndex;(f._hasClass(p[cIdx],"e-fc-hide")||f._hasClass(l.find("tr")[rIdx],"e-fr-hide"))&&(e._activeCell=e._endCell={rowIndex:rIdx,colIndex:cIdx},f._hasClass(p[cIdx],"e-fc-hide")&&(u.keyCode===37||u.shiftKey&&u.keyCode===9)?(this._scrollReverse=!0,f._removeClass(p[cIdx],"e-fc-hide"),f._removeClass(f._getJSSheetHeader(c).find("col")[cIdx],"e-fc-hide"),v.scroll(v.value()-e.columnsWidthCollection[cIdx],!0),(v.value()<0||!f._hasClass(p[cIdx-1],"e-fc-hide"))&&v.scroll(0)):f._hasClass(l.find("tr")[rIdx],"e-fr-hide")&&(u.keyCode==38||u.shiftKey&&u.keyCode===13)?(this._scrollReverse=!0,f._removeClass(l.find("tr")[rIdx],"e-fr-hide"),f._removeClass(f._getJSSheetRowHeader(c).find("tr")[rIdx],"e-fr-hide"),y.scroll(y.value()-e.rowsHeightCollection[rIdx],!0),(y.value()<0||!f._hasClass(l.find("tr")[rIdx-1],"e-fr-hide"))&&y.scroll(0)):f._hasClass(p[cIdx],"e-fc-hide")&&(u.keyCode===39||u.keyCode===9)?f.XLScroll._scrollDirection("hscrollBar",0):f._hasClass(l.find("tr")[rIdx],"e-fr-hide")&&(u.keyCode===40||u.keyCode===13)&&f.XLScroll._scrollDirection("vscrollBar",0),f.XLSelection.selectRange({rowIndex:rIdx,colIndex:cIdx},{rowIndex:rIdx,colIndex:cIdx}),f.model.allowAutoFill&&f.XLDragFill.positionAutoFillElement())}},_navigateRange:function(n,t){var c=this.XLObj,h=c.getSheet(c.getActiveSheetIndex()),r=h._startCell,u=h._endCell,i=h._activeCell,f=r.rowIndex<u.rowIndex?r.rowIndex:u.rowIndex,e=r.rowIndex>u.rowIndex?r.rowIndex:u.rowIndex,o=r.colIndex<u.colIndex?r.colIndex:u.colIndex,s=r.colIndex>u.colIndex?r.colIndex:u.colIndex;if(n=="Tab")if(i.colIndex<s)this._navigateRow("Forward",t);else if(i.rowIndex<e)this._updateActiveCell(i.rowIndex+1,o,t,n);else if(i.rowIndex==e&&i.colIndex==s)this._updateActiveCell(f,o,t,n);else return!1;else if(n=="Enter")if(i.rowIndex<e)this._navigateCol("Forward",t);else if(i.colIndex<s)this._updateActiveCell(f,i.colIndex+1,t,n);else if(i.rowIndex==e&&i.colIndex==s)this._updateActiveCell(f,o,t,n);else return!1;else if(n=="ShiftTab")if(i.colIndex>o)this._navigateRow("Backward",t);else if(i.rowIndex>f)this._updateActiveCell(i.rowIndex-1,s,t,n);else if(i.rowIndex==f&&i.colIndex==o)this._updateActiveCell(e,s,t,n);else return!1;else if(i.rowIndex>f)this._navigateCol("Backward",t);else if(i.colIndex>o)this._updateActiveCell(e,i.colIndex-1,t,n);else if(i.rowIndex==f&&i.colIndex==o)this._updateActiveCell(e,s,t,n);else return!1},_navigateRow:function(n,t){var i,r,u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex())._activeCell;n==="Forward"?(i=1,r="Tab"):(i=-1,r="ShiftTab");this._updateActiveCell(f.rowIndex,f.colIndex+i,t,r)},_navigateCol:function(n,t){var i,r,u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex())._activeCell;n==="Forward"?(i=1,r="Enter"):(i=-1,r="ShiftEnter");this._updateActiveCell(f.rowIndex+i,f.colIndex,t,r)},_updateActiveCell:function(n,t,i,r){var f=this.XLObj,u=f.getSheet(f.getActiveSheetIndex()),e=u._activeCell;f.getCell(e.rowIndex,e.colIndex).removeClass("e-activecell");u._activeCell={rowIndex:n,colIndex:t};i&&this._isHiddenCell(f.getCell(u._activeCell.rowIndex,u._activeCell.colIndex))&&this._skipHiddenRowsAndCols(u._activeCell,i,!0,r);this._isMergedCell(f.getCell(u._activeCell.rowIndex,u._activeCell.colIndex))&&this._skipMergedCells(u._activeCell,i);f.getCell(u._activeCell.rowIndex,u._activeCell.colIndex).addClass("e-activecell");f.updateFormulaBar();f.setSheetFocus()},_isValidParameter:function(n){var t=n.indexOf("(");return t>-1?(n=n.split("("),n[1].length>0):!0},_skipHiddenRowsAndCols:function(n,t,i,r){var f=this.XLObj,u=f.getSheet(f.getActiveSheetIndex()),e=!0;i?this._navigateRange(r,t):((t.keyCode===37||t.keyCode===9&&t.shiftKey||t.keyCode===39&&t.ctrlKey)&&n.colIndex?n.colIndex--:(t.keyCode===38||t.keyCode===13&&t.shiftKey||t.keyCode===40&&t.ctrlKey)&&n.rowIndex?n.rowIndex--:(t.keyCode===39||t.keyCode===9||t.keyCode===37&&t.ctrlKey)&&n.colIndex<u.colCount?n.colIndex++:(t.keyCode===40||t.keyCode===13||t.keyCode===38&&t.ctrlKey)&&n.rowIndex<u.rowCount?n.rowIndex++:e=!1,this._isHiddenCell(f.getCell(n.rowIndex,n.colIndex))&&e?this._skipHiddenRowsAndCols(n,t):e||((t.keyCode===37||t.keyCode===9&&t.shiftKey)&&!n.colIndex?n.colIndex=t.keyCode===37&&t.shiftKey?u._endCell.colIndex+1:u._startCell.colIndex:(t.keyCode===38||t.keyCode===13&&t.shiftKey)&&!n.rowIndex&&(n.rowIndex=t.keyCode===38&&t.shiftKey?u._endCell.rowIndex+1:u._startCell.rowIndex)))},_isHiddenCell:function(n){return!n.hasClass("e-mc-hide")&&n.width()<=0},_isMergedCell:function(n){return n.hasClass("e-mc-hide")},_skipMergedCells:function(n,t){var u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex()),i=f._startCell,r=f._endCell,e=!0,o=u._rcRegx;minr=i.rowIndex<r.rowIndex?i.rowIndex:r.rowIndex;maxr=i.rowIndex>r.rowIndex?i.rowIndex:r.rowIndex;minc=i.colIndex<r.colIndex?i.colIndex:r.colIndex;maxc=i.colIndex>r.colIndex?i.colIndex:r.colIndex;t.shiftKey&&t.keyCode===9?n.colIndex--:t.keyCode===9?n.colIndex++:t.shiftKey&&t.keyCode===13?n.rowIndex--:t.keyCode===13?n.rowIndex++:e=!1;n.colIndex>maxc?(n.colIndex=minc,n.rowIndex=n.rowIndex===maxr?minr:n.rowIndex+1):n.colIndex<minc?(n.colIndex=maxc,n.rowIndex=n.rowIndex===minr?maxr:n.rowIndex-1):n.rowIndex>maxr?(n.rowIndex=minr,n.colIndex=n.colIndex===maxc?minc:n.colIndex+1):n.rowIndex<minr&&(n.rowIndex=maxr,n.colIndex=n.colIndex===minc?maxc:n.colIndex-1);this._isMergedCell(u.getCell(n.rowIndex,n.colIndex))&&e&&this._skipMergedCells(n,t)},_updateMergeRange:function(n,t,i){var e=this.XLObj,r=n[0],u=r.colSpan-1,f=r.rowSpan-1;i.shiftKey||i.keyCode!==39&&i.keyCode!==9?i.shiftKey||i.keyCode!==40&&i.keyCode!==13||(t.rowIndex=t.rowIndex+f):t.colIndex=t.colIndex+u}}}(jQuery,Syncfusion),function(n,t,i){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellFormatting=function(n){this.XLObj=n;this._formatEnable=!1;this._thousandSeparator=Globalize.culture(this.XLObj.model.locale).numberFormat[","];this._formatAsTableStyle={};this._rowLength=null;this._colLength=null;this._getFormat=null;this._getEformatClass=null;this._borderPosition=["top","right","bottom","left"];this._cellObj=null};t.spreadsheetFeatures.cellFormatting.prototype={format:function(i,r){if(this.XLObj.model.allowCellFormatting){var f,e,l,v,o,a,u=this.XLObj,y={},p=0,g=[],nt="style",h={reqType:"cell-format"},s=u.getActiveSheetIndex(),w=u._rAlign,c=u._dataContainer,tt="format",b=u._getAlphaRangeCells(r),it=b.length;if(!u._trigger("beforeCellFormat",{sheetIndex:s,format:i,cells:b})&&it>0){if(i=this._getFormatObj(i),nt in i||tt in i){for(h.beforeFormat=u.isUndefined(r)?this.getHashCodeClassAsArray():this.getHashCodeClassAsArray(u.getRangeIndices(r));p<it;){if(e=b[p],l=n(e),a={sheetIndex:s,format:i,cell:e},f={rowIndex:e.parentNode.rowIndex,colIndex:e.cellIndex,beforeFormat:{},afterFormat:{},bRowHeight:u.model.allowResizing&&u.XLResize.getRowHeight(e.parentNode.rowIndex)},y=t.isNullOrUndefined(c.sheets[s][f.rowIndex])?{}:t.isNullOrUndefined(c.sheets[s][f.rowIndex][f.colIndex])?{}:c.sheets[s][f.rowIndex][f.colIndex],n.extend(!0,f.beforeFormat,y),nt in i){if(f.prevClass=e.className,v=this._getExtendedClass(e.className,i.style),this._updateFormatClass(e,v),f.className=v,("font-family"in i.style||"font-size"in i.style)&&e.className.indexOf("e-mc-hide")<0&&!u._hasClass(e,"e-merge")){var rt=l.outerHeight(),k,ut=u.getRows(s)[0],d=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex);n(ut[f.rowIndex]).outerHeight(rt);u.getSheet(s).rowsHeightCollection[f.rowIndex]=rt;u.model.allowResizing&&(u.isNumber(d)||u._isDateTime(d)||u.isTime(d))&&(k=u.XLResize._getContentWidth(f.colIndex,s,[e.parentElement])+2,k>l.width()&&u.setWidthToColumns([{cellIndex:f.colIndex,width:k}]));u.XLSelection._refreshBorder()}a.cssClass=v}tt in i&&i.type&&(o=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex),o=t.isNullOrUndefined(o)?"":o,this._cellObj={value:o,type:i.type,formatStr:i.format.formatStr,decimalPlaces:i.format.decimalPlaces,thousandSeparator:i.format["thousandSeparator"]?!0:!1,canUpdate:!0},u.isFormula(o)&&(o=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"calcValue"),this._cellObj.canUpdate=!1),["text","general"].indexOf(this._cellObj.type)!==-1?(u._isDateTime(o)&&(o=u._dateToInt(o),this._cellObj.value=o),this._cellObj.type===t.Spreadsheet.CellType.Text?l.removeClass(w):u.isNumber(o)&&e.className.indexOf(w)===-1&&l.addClass(w)):o=this._format(o,{formatStr:this._cellObj.formatStr,type:this._cellObj.type,thousandSeparator:this._cellObj.thousandSeparator,decimalPlaces:this._cellObj.decimalPlaces,cellObj:this._cellObj}),a.value=this._cellObj.value,a.value2=this._cellObj.value2=o+"",delete this._cellObj.canUpdate,u.XLEdit._updateDataContainer(e,this._cellObj),f.beforeFormat.Oprtype=this._cellObj.type,this._cellObj=null);y=t.isNullOrUndefined(c.sheets[s][f.rowIndex])?{}:t.isNullOrUndefined(c.sheets[s][f.rowIndex][f.colIndex])?{}:c.sheets[s][f.rowIndex][f.colIndex];f.afterFormat=n.extend(!0,{},y);f.afterFormat.Oprtype=f.beforeFormat.Oprtype;f.aRowHeight=u.model.allowResizing&&u.XLResize.getRowHeight(e.parentNode.rowIndex);g.push(f);u._trigger("cellFormatting",a);p++}h.selCell=g;h.afterFormat=u.isUndefined(r)?this.getHashCodeClassAsArray():this.getHashCodeClassAsArray(u.getRangeIndices(r));h.range=u.model.sheets[u.getActiveSheetIndex()].selectedRange;h.sheetIndex=u.getActiveSheetIndex()}"border"in i?this.applyBorder(i.border,r,h):u.model.sheets[s]._importRendered||u._isUndoRedo||u._dupDetails||u._isSort||u._completeAction(h)}}},_format:function(n,i){var u=this.XLObj,e=i.formatStr,r=u.isUndefined(n)?"":n,s=i.type||"",f=t.Spreadsheet.CellType,o=u.model.locale,h=["."].indexOf(this._thousandSeparator)>-1?"\\":"",c=new RegExp(h+this._thousandSeparator,"g");n=r.toString();switch(s){case f.Accounting:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toAccounting(e,r,o));break;case f.Currency:case f.Number:case f.Percentage:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.formatting(e,r,o),!i.thousandSeparator&&[f.Number,f.Percentage].indexOf(s)>-1&&this._thousandSeparator&&(r=r.replace(c,"")));break;case f.Scientific:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toExponential(r,i.decimalPlaces));break;case f.Fraction:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toFraction(r),r="numerator"in r?r.integer+" "+r.numerator+"/"+r.denominator:r.integer);break;case f.LongDate:case f.ShortDate:case f.Date:case f.Time:case f.DateTime:u.isNumber(r)?(r=u.intToDate(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r)):u._isDateTime(r)||(r=Globalize.parseDate(r));u._isDateTime(r)&&(r=u.formatting(e,r,o))}return t.isNullOrUndefined(r)?n:r},createTable:function(t,i){if(this.XLObj.model.allowFormatAsTable){var o,v,u,y,e,r=this.XLObj,a={format:t.format},s=r.getActiveSheetIndex(),p,f=r.getSheet(s),l=t.name||"",w=f._tableManager,h=f._startCell,c=f._endCell,b="formatName",k={sheetIndex:s,tableStyle:t,reqType:"format-table"};r._trigActionBegin(k)||(t=k.tableStyle,r._isFAT=!0,u=r._isUndoRedo?n.extend(!0,[],i):i?r.getRangeIndices(i):r.swapRange([h.rowIndex,h.colIndex,c.rowIndex,c.colIndex]),y=r.getCell(u[0],u[1])[0].className,f._importRendered||(p=r.getRange(u[0],u[1],u[0],u[3]),o={sheetIndex:r.getActiveSheetIndex(),reqType:"format-table",beforeFormat:this.getHashCodeClassAsArray(),beforeRange:n.extend(!0,[],u),pcells:p,beforeRangeHeader:r.getRangeData([u[0],u[1],u[0],u[3]])},o.beforeRangeData=t.header?r.getRangeData([u[0],u[1],u[2],u[3]]):r.getRangeData([u[0],u[1],u[2]+1,u[3]])),b in t&&(a[b]=t.formatName),y.indexOf("e-table")===-1?(e=r._isUndoRedo&&r.XLClipboard._isCut?parseInt(l.replace("Table","")):f._importRendered?this._getTableIdxFromName(t.name):r.getObjectLength(w),l=l.length?l:"Table "+e,r.model.sheets[s]._header[e]={header:t.header},t.header?(i?(i=r._isUndoRedo?i:r.getRangeIndices(i),f._startCell={rowIndex:i[0],colIndex:i[1]},f._endCell={rowIndex:i[2],colIndex:i[3]},r.XLSelection.selectRange(f._startCell,f._endCell),r.model.allowAutoFill&&!f._importRendered&&r.XLDragFill.positionAutoFillElement()):i=r.swapRange([h.rowIndex,h.colIndex,c.rowIndex,c.colIndex]),i[0]===i[2]&&(u=i,u[2]=u[2]+1)):(r._isUndoRedo?u=n.extend(!0,[],i):(u=i?r.getRangeIndices(i):r.swapRange([h.rowIndex,h.colIndex,c.rowIndex,c.colIndex]),i=u),r.model.allowDragAndDrop&&r.XLDragDrap.moveRangeTo(u,[u[0]+1,u[1],u[2]+1,u[3]]),f._startCell={rowIndex:u[0],colIndex:u[1]},f._endCell={rowIndex:u[2]+1,colIndex:u[3]},r.XLSelection.selectRange(f._startCell,f._endCell),r.model.allowAutoFill&&!f._importRendered&&r.XLDragFill.positionAutoFillElement(),u[2]=u[2]+1),"dataSource"in t&&r.updateRange(s,{showHeader:"showHeader"in t?t.showHeader:!0,startCell:r._getAlphaRange(s,i[0],i[1],i[0],i[1]),dataSource:t.dataSource}),v=r.getRange(i[0],i[1],i[2],i[3]),v.addClass("e-table"+e),f._importRendered||(w[e]={name:l,range:u}),r.XLRibbon._isDesignTab=!0,this._createTable(e,a),r.XLFilter._filterTable(s,e),this._updateTblStyleOptns(e,t),f._importRendered||t.hideTab||r.XLRibbon._designTabUpdate(e,v[0]),r.model.allowComments&&r.XLComment._updateCmntArrowPos()):(this._formatAsTableStyle=a,this._createTable(r._getTableID(y),a),r._undoCollection.pop(),r._undoCollection.pop()),r._isFAT=!1,f._importRendered||(r.XLRibbon._dirtySelect(r.getRange(i[0],i[1],i[2],i[3])),o.tableID=e,o.tableStyle=t,o.afterRange=u,r._isPaste||r._isUndoRedo||r._completeAction(o)),r.XLSelection._refreshBorder())}},_createTable:function(t,r){var e,a,h,o,s,v,c,p,b,k,g=0,f=this.XLObj,l=r.format,w="border",y=f.getActiveSheetIndex(),nt=f.getSheet(y),d=f.getSheet(y)._tableManager,u=d[t].range;for(d[t].format=l,!nt._importRendered&&r.formatName&&(d[t].formatName=r.formatName),h=f.getRange(u[0]-1,u[1]-1,u[2],u[3]),e=h.length;e--;)o=h[e],n(o).removeClass(this.getFormatClass(o.className,!0));if("contentLayout"in l)for(e=u[0]+1,p=l.contentLayout.length;e<=u[2];){if(s=n.extend(!0,{},l.contentLayout[g%p]),w in s&&(v=f._getProperAlphaRange(y,e,u[1],e,u[3]),c=s.border,delete s[w]),f.getObjectLength(s))for(h=f.getRange(e,u[1],e,u[3]),h.hasClass("e-table"+t)||h.addClass("e-table"+t),a=h.length;a--;)o=h[a],f.XLEdit.getPropertyValue(o.parentNode.rowIndex,o.cellIndex,"hyperlink")&&delete s.color,this._updateFormatClass(o,this._getExtendedClass(o.className,s));c&&(c.tableID=t,this.applyBorder(c,v),c=i);g++;e++}for(e=0,a=1,s=i,h=f.getRange(u[0],u[1],u[0],u[3]),("headerLayout"in l)&&(s=n.extend(!0,{},l.headerLayout),w in l.headerLayout&&(v=f._getProperAlphaRange(y,u[0],u[1],u[0],u[3]),c=s.border,delete s[w])),p=h.length;e<p;)o=h[e],b=f.XLEdit.getPropertyValue(o.parentNode.rowIndex,o.cellIndex,"value2")||"",k="Column"+a,b.length?b.toLowerCase()===k.toLowerCase()&&a++:(f.XLEdit.updateCell(n(o),k),a++),f.getObjectLength(s)&&this._updateFormatClass(o,this._getExtendedClass(o.className,s)),e++;c&&(c.tableID=t,this.applyBorder(c,v),c=i);"contentBorder"in l&&(l.contentBorder.border.tableID=t,v=f._getProperAlphaRange(y,u[0]+1,u[1],u[2],u[3]),this.applyBorder(l.contentBorder.border,v));n("#"+f._id+"_Ribbon_tsofiltercolumn").ejCheckBox("option",{checked:!0})},_updateTblStyleOptns:function(n,t){var u=this.XLObj,f=u._getSheetIndex(),o=u.getSheet(f),e=o._tableManager,i,r;n in e&&(i=e[n],r=i.range,i.isFilter="isFilter"in t?t.isFilter:!0,i.isFilter||u.XLFilter._clearFilterTableIcon(f,n),u._dupDetails=!0,"firstColumn"in t&&(i.firstColumn=t.firstColumn,this.format({style:{"font-weight":i.firstColumn?"bold":"normal"}},u._getProperAlphaRange(f,r[0]+1,r[1],r[2],r[1]))),"lastColumn"in t&&(i.lastColumn=t.lastColumn,this.format({style:{"font-weight":i.lastColumn?"bold":"normal"}},u._getProperAlphaRange(f,r[0]+1,r[3],r[2],r[3]))),u._dupDetails=!1,"totalRow"in t&&(i.totalRow=t.totalRow))},removeTable:function(t){if(this.XLObj.model.allowFormatAsTable){var r,i=this.XLObj,u=i.getActiveSheetIndex(),f=i.getSheet(u)._tableManager;t in f&&(r="e-table"+t,i.element.find("."+r).removeClass(r),i._isFATResize||i.XLFilter._clearFilterTable(u,parseInt(t)),delete f[t],delete i.model.sheets[u]._header[t],n("#"+i._id+"_Ribbon_tsofiltercolumn").ejCheckBox("option",{checked:!1}),i.XLRibbon._toggleDesignTab())}},_getTableLayoutFromName:function(t){if(t)for(var i,r=n("#"+this.XLObj._id+"_formatastable").find(".e-formatastablecell"),u=r.length-1;u--;)if(i=n(r[u]).data(),i.formatName===t)return i},_getTableIdxFromName:function(n){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex())._tableManager,t=i.getObjectLength(r);if(t)while(t--)if(r[t].name===n)return t;return-1},customFormatParser:function(n){if(this.XLObj.model.allowCellFormatting){var i,f,e,h={},s=t.Spreadsheet.CellType,r="{0:",u="}",c="N",a="P",o=".",l="0";return n=t.isNullOrUndefined(n)?"":n.toString(),Number(n)===0?(n.indexOf(o)>-1?(e=n.split(o),i=r+c+e[1].length+u):i=r+"D"+n.length+u,f=s.Number):!n.indexOf("#")&&n.indexOf(",")>-1&&n.lastIndexOf(l)===n.length-1?(n.indexOf(o)>-1?(e=n.split(o),i=r+c+e[1].length+u):i=r+c+l+u,h.thousandSeparator=!0,f=s.Number):n.lastIndexOf("%")===n.length-1&&Number(n.replace(/%/g,""))===0?(n.indexOf(o)>-1?(e=n.split(o),i=r+a+--e[1].length+u):i=r+a+l+u,f=s.Percentage):/^[dMy/-]+$/.test(n)?(i=r+n+u,f=s.Date):/^[hmst:\s]+$/.test(n)&&(i=r+n+u,f=s.Time),i&&(h.formatStr=i,h.type=f),h}},applyBorder:function(i,r,u){if(this.XLObj.model.allowCellFormatting&&(!this.XLObj.model.allowCellFormatting||this.XLObj.model.formatSettings.allowCellBorder)&&(this.XLObj.getObjectLength(i)||n.type(i)==="string")){var f=this.XLObj,o=f.getActiveSheetIndex(),e=f.getSheet(o),s=e._startCell,h=e._endCell;r=r?f.getRangeIndices(r):f.swapRange([s.rowIndex,s.colIndex,h.rowIndex,h.colIndex]);e._importRendered||(u||(u={sheetIndex:o,reqType:"cell-format",process:"border"}),u.range=r,u.beforeFormat=this.getHashCodeClassAsArray(r));f.getObjectLength(i)?this._applyBorderCss(i,r,u):i==="noborder"?this.clearFormat(r,"border"):this._applyAllBorderCss(i,r,u);f._refreshRangeTRHght(o,r);e._importRendered||f._isUndoRedo||t.isNullOrUndefined(i.tableID)&&!this._dupDetails&&(u.afterFormat=this.getHashCodeClassAsArray(r),f._completeAction(u))}},updateDecimalPlaces:function(i,r){if(this.XLObj.model.allowCellFormatting&&(!this.XLObj.model.allowCellFormatting||this.XLObj.model.formatSettings.allowDecimalPlaces)){var h,e,s,y,u,p,a=0,f={},v={},o=this.XLObj,c=o.getActiveSheetIndex(),l=o._dataContainer,w={action:"decimal",reqType:"cell-format",sheetIndex:c},b=[];if(r=o._getAlphaRangeCells(r),y=r.length,y)while(a<y)e=r[a].parentNode.rowIndex,s=r[a].cellIndex,u=o.getRangeData([e,s,e,s])[0],h={rowIndex:e,colIndex:s,afterFormat:{},beforeFormat:{}},v=t.isNullOrUndefined(l.sheets[c][e])?{}:t.isNullOrUndefined(l.sheets[c][e][s])?{}:l.sheets[c][e][s],n.extend(!0,h.beforeFormat,v),o.isNumber(u.value)&&(o.isUndefined(u.decimalPlaces)&&(u.decimalPlaces=0),f.type=u.type===t.Spreadsheet.CellType.General?t.Spreadsheet.CellType.Number:u.type,f.decimalPlaces=u.decimalPlaces=i==="decrement"?u.decimalPlaces>0?u.decimalPlaces-1:0:u.decimalPlaces+1,f.formatStr=this._getFormatString(f.type,f.decimalPlaces),p=this._format(u.value,{formatStr:f.formatStr,type:f.type,thousandSeparator:u.thousandSeparator,decimalPlaces:f.decimalPlaces}),f.value2=p,o.XLEdit._updateDataContainer(r[a],f),h.beforeFormat.Oprtype=f.type),v=t.isNullOrUndefined(l.sheets[c][e])?{}:t.isNullOrUndefined(l.sheets[c][e][s])?{}:l.sheets[c][e][s],n.extend(!0,h.afterFormat,v),h.afterFormat.Oprtype=h.beforeFormat.Oprtype,b.push(h),a++;w.selCell=b;o._isUndoRedo||o._completeAction(w)}},getFormatClass:function(n,t){var i=t?"e-border":"e-format",r=new RegExp("\\b"+i+".*?\\b","g");return n.indexOf(i)!==-1?n.match(r)[0]:""},getHashCodeClassAsArray:function(n){var t=0,r={format:[]},i=this.XLObj,e=["topborder","leftborder"],u,f,o;for(n=n?i.swapRange(n):i.getSheet(i.getActiveSheetIndex()).selectedRange,f=i.getRange(n[0],n[1],n[2],n[3]),o=f.length;t<o;)u=f[t].className,r.format.push(this.getFormatClass(u)+" "+this.getFormatClass(u,!0)),t++;for(t=2;t--;)r[e[t]]=this._getBorderArray(n,e[t]);return r},_getBorderArray:function(n,t){var i,r=0,u=[],o=this.XLObj,f="topborder",s=t===f?n[0]-1:n[1]-1,e;if(s>=0)for(e=t===f?o.getRange(n[0]-1,n[1],n[0]-1,n[3]):o.getRange(n[0],n[1]-1,n[2],n[1]-1),i=e.length;r<i;)u.push(this.getFormatClass(e[r].className,!0)),r++;else for(i=t===f?n[3]-n[1]+1:n[2]-n[0]+1;i--;)u.push("");return u},clearFormat:function(t,i,r){var o;if(this.XLObj.model.allowCellFormatting){var u,e,s,h,f=this.XLObj,c=[],p=["topborder","leftborder"],a="format",v="border",y=!i||i===a,l=!i||i===v;for(t=t?f.swapRange(t):f.getSheet(f.getActiveSheetIndex()).selectedRange,o=f.getRange(t[0],t[1],t[2],t[3]),u=o.length;u--;)s=o[u],e=n(s),r&&f._isHiddenRow(e.parent().index())||(h=s.className,y&&e.removeClass(this.getFormatClass(h)),l&&e.removeClass(this.getFormatClass(h,!0)));if(y&&c.push(a),l&&c.push(v),f.clearRangeData(null,c,o,r),l)for(u=2;u--;)this._clearBorderClass(t,p[u],r)}},_clearBorderClass:function(t,i,r){var h,c,o,u,f,s,e=this.XLObj,l="topborder",a=i===l?t[0]-1:t[1]-1;if(a>=0)for(c=i===l?e.getRange(t[0]-1,t[1],t[0]-1,t[3]):e.getRange(t[0],t[1]-1,t[2],t[1]-1),h=c.length;h--;)o=c[h],r&&e._isHiddenRow($cell.parent().index())||(s=this.getFormatClass(o.className,!0),s.length&&(f=s.split("S"),u=this._getBorderFromHashCode(f[1]),"border"in u&&(delete u.border[i===l?"bottom":"right"],f[1]=this._getBorderHashCode(u.border),!e.getObjectLength(u.border)&&delete u.border),n.extend(!0,u,this._getBorderFromHashCode(f[0].replace("e-border",""))),e.getObjectLength(u)?this._updateFormatClass(o,this._createFormatClass(u,f[0]+"S"+f[1]),!0):(n(o).removeClass(s),e.clearRangeData(null,["border"],[o],r))))},updateFormat:function(n,t){var i,f=["topborder","leftborder"],r=this.XLObj,u,e;for(t=t?r.swapRange(t):r.getSheet(r.getActiveSheetIndex()).selectedRange,u=r.getRange(t[0],t[1],t[2],t[3]),e=n.format,i=u.length;i--;)this._updateHashCodeClass(u[i],e[i]);for(i=2;i--;)this._updateBorderClass(t,n[f[i]],f[i])},_updateBorderClass:function(n,t,i){var r,u,f=this.XLObj,e="topborder",o=i===e?n[0]-1:n[1]-1;if(o>=0)for(u=i===e?f.getRange(n[0]-1,n[1],n[0]-1,n[3]):f.getRange(n[0],n[1]-1,n[2],n[1]-1),r=u.length;r--;)this._updateFormatClass(u[r],t[r],!0)},updateUniqueFormat:function(n,t){for(var i=this.XLObj,u=i.getActiveSheetIndex(),t=t?t:i.getSheet(u).selectedRange,f=i._getArrayRangeCells(t),r=f.length+1;r=r-1;)this._updateFormatClass(f[r-1],n);i._refreshRangeTRHght(u,i.swapRange(t))},_hasFormat:function(n){return n?!t.isNullOrUndefined(n.match(/e-format|e-border/)):!1},getFormatHashCode:function(n){var i="";return i="background-color"in n?n["background-color"].replace("#",""):"6N",i="color"in n?i+n.color.replace("#",""):i+"6N",i="font-family"in n?t.isNullOrUndefined(this._getStyleCode("FontFamily",n["font-family"]))?i+"2N":i+this._getStyleCode("FontFamily",n["font-family"]):i+"2N",i="font-size"in n?i+this._getFontCode(n["font-size"]):i+"2N",i="font-style"in n?t.isNullOrUndefined(this._getStyleCode("FontStyle",n["font-style"]))?i+"1N":i+this._getStyleCode("FontStyle",n["font-style"]):i+"1N",i="text-decoration"in n?t.isNullOrUndefined(this._getStyleCode("TextDecoration",n["text-decoration"]))?i+"1N":i+this._getStyleCode("TextDecoration",n["text-decoration"]):i+"1N",i="vertical-align"in n?t.isNullOrUndefined(this._getStyleCode("VerticalAlign",n["vertical-align"]))?i+"1N":i+this._getStyleCode("VerticalAlign",n["vertical-align"]):i+"1N",i="text-align"in n?t.isNullOrUndefined(this._getStyleCode("TextAlign",n["text-align"]))?i+"1N":i+this._getStyleCode("TextAlign",n["text-align"]):i+"1N",i="text-indent"in n?i+this._getTextIndentCode(n["text-indent"]):i+"2N",i="font-weight"in n?t.isNullOrUndefined(this._getStyleCode("FontWeight",n["font-weight"]))?i+"1N":i+this._getStyleCode("FontWeight",n["font-weight"]):i+"1N","e-format"+i},getFormatFromHashCode:function(n){var r={},i,t=0,u="e-format";return n=n||"",n.indexOf(u)||(i=n.replace(u,"").split("N"),i[t].length===1?t=t+1:(r["background-color"]="#"+i[t].slice(0,6),i[t]=i[t].substr(6)),i[t].length===1?t=t+1:(r.color="#"+i[t].slice(0,6),i[t]=i[t].substr(6)),i[t].length===1?t=t+1:i[t].length===2?(r["font-family"]=this._getCodeStyle("FontFamily",i[t].slice(0,1)+"1N"),t=t+1):(r["font-family"]=this._getCodeStyle("FontFamily",i[t].slice(0,2)),i[t]=i[t].substr(2)),i[t].length===1?t=t+1:i[t].length===2?(r["font-size"]=i[t].slice(0,1)+"pt",t=t+1):(r["font-size"]=i[t].slice(0,2)+"pt",i[t]=i[t].substr(2)),i[t].length===1?t=t+1:(r["font-style"]=this._getCodeStyle("FontStyle",i[t].slice(0,1)),i[t]=i[t].substr(1)),i[t].length===1?t=t+1:(r["text-decoration"]=this._getCodeStyle("TextDecoration",i[t].slice(0,1)),i[t]=i[t].substr(1)),i[t].length===1?t=t+1:(r["vertical-align"]=this._getCodeStyle("VerticalAlign",i[t].slice(0,1)),i[t]=i[t].substr(1)),i[t].length===1?t=t+1:(r["text-align"]=this._getCodeStyle("TextAlign",i[t].slice(0,1)),i[t]=i[t].substr(1)),i[t].length===1?t=t+1:i[t].length===2?(r["text-indent"]=i[t].slice(0,1)+"px",t=t+1):(r["text-indent"]=i[t].slice(0,2)+"px",i[t]=i[t].substr(2)),i[t]==="2"&&(r["font-weight"]="bold")),r},getBorderFromHashCode:function(n,t){var i={};return n=n||"",n.indexOf("e-border")||(n=n.replace("e-border","").split("S")[t?1:0],i=this._getBorderFromHashCode(n)),i},_getBorderFromHashCode:function(n){var i,t=0,r={};return n=n||"",n.length>12&&(i=n.split("N"),r={border:{}},i[t].length>1?(r.border.right=this._concatBorderCode(i[t]),i[t]=i[t].substr(8)):t=t+3,i[t].length>1&&(r.border.bottom=this._concatBorderCode(i[t]))),r},_formatPainter:function(){var n=this.XLObj,e,o,h;if(n.model.allowFormatPainter&&n.model.allowCellFormatting){var s=n.getActiveSheetIndex(),r,u,f=0,t=n.getSheet(s)._startCell,i=n.getSheet(s)._endCell;for(this._rowLength=i.rowIndex-t.rowIndex+1,this._colLength=i.colIndex-t.colIndex+1,e=this._rowLength,o=this._colLength,this._getFormat=this.getHashCodeClassAsArray([t.rowIndex,t.colIndex,i.rowIndex,i.colIndex]),h=n.getRangeData([t.rowIndex,t.colIndex,i.rowIndex,i.colIndex],null,["value","value2","type","wrap","formatStr","thousandSeparator","decimalPlaces","cFormatRule","hyperlink"]),this._getEformatClass=new Array(e),r=0;r<e;r++)for(this._getEformatClass[r]=new Array(o),u=0;u<o;u++)this._getEformatClass[r][u]={eFormat:this._getFormat.format[f],rangeData:h[f]},f++}},_fPMouseUp:function(){for(var v,u=this.XLObj,h=u.getActiveSheetIndex(),ht=u.getSheet(h),tt=u._getContent(h).find("div:first-child"),nt=0,it,y,o=ht._selectedCells,p=o[0],w=o[o.length-1],f,r=0,rt=0,c,b,ut,g,e=u._getArrayRangeCells([p.rowIndex,p.colIndex,w.rowIndex,w.colIndex]),l=u.XLSelection._getSelectedRange(p,w),ft=w.rowIndex-p.rowIndex,et=w.colIndex-p.colIndex,a=new Array(l.length),ot={sheetIndex:h,reqType:"format-painter"},k=[],s,st=u._formatRegx,ct=u._borderRegx,i=0,d=l.length;i<d;i++)a[i]=u._generateHeaderText(h,l[i].colIndex+1)+(l[i].rowIndex+1)+":"+u._generateHeaderText(h,l[i].colIndex+1)+(l[i].rowIndex+1);for(u._dupDetails=!0,i=0;i<=ft;i++){for(rt++,f=0;f<=et;f++){if(nt++,s={rowIndex:n(e[r]).parent().index(),colIndex:e[r].cellIndex},s.bVal=n(e[r]).text(),n.extend(!0,s.bData,n(e[r]).data()),s.bFormat=e[r].className.indexOf("e-format")!==-1?e[r].className.match(st)[0]:"",this._getEformatClass[i][f].eFormat===" "&&this.clearFormat([o[r].rowIndex,o[r].colIndex,o[r].rowIndex,o[r].colIndex],"format"),y=this._getEformatClass[i][f].eFormat.split(" "),y[0].indexOf("e-format")>-1?this._updateFormatClass(e[r],y[0]):y[1].indexOf("e-format")>-1&&this._updateFormatClass(e[r],y[1]),v={type:this._getEformatClass[i][f].rangeData.type?this._getEformatClass[i][f].rangeData.type:"general"},this._getEformatClass[i][f].rangeData.formatStr&&(v.formatStr=this._getEformatClass[i][f].rangeData.formatStr),this._getEformatClass[i][f].rangeData.decimalPlaces&&(v.decimalPlaces=this._getEformatClass[i][f].rangeData.decimalPlaces),this._getEformatClass[i][f].rangeData.thousandSeparator&&(v.thousandSeparator=this._getEformatClass[i][f].rangeData.thousandSeparator),this.format(v,a[r]),u.XLEdit.updateCell(e.eq(r),e.eq(r).text()),!t.isNullOrUndefined(this._getEformatClass[i][f].rangeData.cFormatRule))for(g=0,d=this._getEformatClass[i][f].rangeData.cFormatRule.length;g<d;g++)it=this._getEformatClass[i][f].rangeData.cFormatRule[g],b=it.split("_"),ut=b[5],b[b.indexOf(ut)]=a[r],u._dataContainer.cFormatRule=b.join("_"),c=u._dataContainer.cFormatRule.split("_"),u.XLCFormat._cFormat(c[0],c[2],c[3],c[4],c[5]);if(e[r].className.indexOf("e-sswraptext")>-1&&t.isNullOrUndefined(this._getEformatClass[i][f].rangeData.wrap)?u.setWrapText(a[r],"unwrap"):e[r].className.indexOf("e-sswraptext")<0&&!t.isNullOrUndefined(this._getEformatClass[i][f].rangeData.wrap)&&u.setWrapText(a[r],"wrap"),!t.isNullOrUndefined(this._getEformatClass[i][f].rangeData.hyperlink)&&u.isUndefined(u.XLEdit.getPropertyValue(o[r].rowIndex,o[r].colIndex,"hyperlink",h))?this.format({style:{"text-decoration":"underline"}},a[r]):u.isUndefined(this._getEformatClass[i][f].rangeData.hyperlink)&&!u.isUndefined(u.XLEdit.getPropertyValue(o[r].rowIndex,o[r].colIndex,"hyperlink",h))&&e.eq([r]).find("a").css("text-decoration","none"),s.aVal=n(e[r]).text(),s.aData=n(e[r]).data(),s.aFormat=e[r].className.indexOf("e-format")!==-1?e[r].className.match(st)[0]:"",k.push(s),r++,nt===et+1){nt=0;break}this._colLength===f+1&&(f=-1)}if(rt===ft+1)break;this._rowLength===i+1&&(i=-1)}e=u.getCell(k[i].rowIndex,k[i].colIndex)[0];k[i].aBorder=e.className.indexOf("e-border")!==-1?e.className.match(ct)[0]:"";this._formatEnable=!1;tt.addClass("e-ss-cursor");tt.removeClass("e-ss-fpcursor");n("#"+u._id+"_Ribbon_formatpainter").ejToggleButton("option",{toggleState:!1});ot.selCells=k;u._dupDetails=!1;u.XLSelection.refreshSelection();u.XLDragFill.positionAutoFillElement();u._isUndoRedo||u._completeAction(ot)},_getFormatObj:function(n){if("type"in n||"formatStr"in n){var t={},i="thousandSeparator";t.formatStr="formatStr"in n?n.formatStr:this._getFormatString(n.type,n.decimalPlaces);t.decimalPlaces="decimalPlaces"in n?n.decimalPlaces:["currency","accounting","number"].indexOf(n.type)!==-1?parseInt(t.formatStr.replace(/{0:|[A-Z]|}/g,"")):0;i in n?t[i]=n[i]:n.type==="number"&&(t[i]=!0);n.format=t}return"style"in n&&n.style.border&&(n.border=n.style.border,delete n.style.border,this.XLObj.getObjectLength(n.style)||delete n.style),n},_getFormatString:function(n,i){var r=t.Spreadsheet.CellFormat[n];return this.XLObj.isNumber(i)&&!t.isNullOrUndefined(r)&&(r="{0:"+r.substr(3,1)+i+"}"),r||""},_createFormatClass:function(n,t){var i=this.XLObj._dataContainer.hashCode,r;return(t=t?t:this.getFormatHashCode(n),i.indexOf(t)!==-1)?t:(r=this._getCssPropertyAsString(n),this._writeCssRules(t,r),i.push(t),t)},_writeCssRules:function(n,t){var i=document.getElementById(this.XLObj._id+"_sscustomformat"),r=".e-spreadsheet ."+n+" {"+t+"}";i.styleSheet?i.styleSheet.cssText+=r:i.appendChild(document.createTextNode(r))},_getCssPropertyAsString:function(n){var t="",i,r,u;if("border"in n){i=n.border;for(r in i)n["border-"+r]=i[r];delete n.border}for(u in n)t=t+(u+":"+n[u]+";");return t},_splitBorderCode:function(n){return n=n.split(" "),n[0].replace("px","")+this._getStyleCode("BorderStyle",n[1])+n[2].replace("#","")},_concatBorderCode:function(n){return n.substr(0,1)+"px "+this._getCodeStyle("BorderStyle",n.substr(1,1))+" #"+n.substr(2,6)},_getCodeStyle:function(n,i){n=t.Spreadsheet[n];for(var r in n)if(n.hasOwnProperty(r)&&n[r]===i)return r},_getStyleCode:function(n,i){return i=i||"",t.Spreadsheet[n][i.toLowerCase()]},_getFontCode:function(n){var t=n.replace(/pt|-|\+/g,"");return t.length===2?t:t.length===1?t+"1N":"2N"},_getTextIndentCode:function(n){var t=n.replace(/px|-|\+/g,"");return t.length===2?t:t.length===1?t+"1N":"2N"},_getExtendedClass:function(t,i){var r=this.getFormatFromHashCode(this.getFormatClass(t));return n.extend(!0,r,i),this._createFormatClass(r)},_updateHashCodeClass:function(i,r){var u,f,e=this.XLObj,o={},s=e._formatRegx,h=e._borderRegx;t.isNullOrUndefined(r)||(i.className=i.className.replace(s,"").replace(h,""),u=r.indexOf("e-format")>-1,f=r.indexOf("e-border")>-1,u&&(o.format=r.match(s)[0]),f&&(o.border=r.match(h)[0]),n(i).addClass(r),(u||f)&&e.XLEdit._updateDataContainer(i,o))},_updateFormatClass:function(n,t,i){var r,u,f=this.XLObj,e="e-format",o="e-border";t&&(t.indexOf(e)>-1||t.indexOf(o)>-1)&&(r=i?o:e,u=new RegExp("\\b"+r+".*?\\b","g"),n.className=n.className.replace(u,""),f.addClass(n,t),f.XLEdit._updateDataContainer(n,i?{border:t}:{format:t}))},_applyBorderCss:function(n,t){var i=this._borderPosition;i[0]in n&&t[0]-1>=0&&this._updateBorder([t[0]-1,t[1],t[0]-1,t[3]],this._parseBorder(i[2],n.top),!0);i[1]in n&&this._updateBorder([t[0],t[3],t[2],t[3]],this._parseBorder(i[1],n.right));i[2]in n&&this._updateBorder([t[2],t[1],t[2],t[3]],this._parseBorder(i[2],n.bottom));i[3]in n&&t[1]-1>=0&&this._updateBorder([t[0],t[1]-1,t[2],t[1]-1],this._parseBorder(i[1],n.left),!0)},_applyAllBorderCss:function(n,t){var i=this._borderPosition;this._updateBorder(t,this._parseBorder(i[1]+" "+i[2],n));t[0]-1>=0&&this._updateBorder([t[0]-1,t[1],t[0]-1,t[3]],this._parseBorder(i[2],n),!0);t[1]-1>=0&&this._updateBorder([t[0],t[1]-1,t[2],t[1]-1],this._parseBorder(i[1],n),!0)},_updateBorder:function(n,t,i){for(var e,r,u=0,f=this.XLObj,o=f.getRange(n[0],n[1],n[2],n[3]),s=o.length;u<s;)r=o[u],i&&(f.hasSpan(r.rowSpan)||f.hasSpan(r.colSpan))||(e=this._extendBorder(this.getFormatClass(r.className,!0),t,i),this._updateFormatClass(r,e,!0)),u++},_extendBorder:function(t,i,r){var u;return t=t.length?t.replace("e-border","").split("S"):"1N1N6N1N1N6NS1N1N6N1N1N6N".split("S"),r?(u=this._getBorderFromHashCode(t[1]),n.extend(!0,u,i),t[1]=this._getBorderHashCode(u.border),u=n.extend(!0,this._getBorderFromHashCode(t[0]),u)):(u=this._getBorderFromHashCode(t[0]),n.extend(!0,u,i),t[0]=this._getBorderHashCode(u.border),u=n.extend(!0,this._getBorderFromHashCode(t[1]),u)),this._createFormatClass(u,"e-border"+t[0]+"S"+t[1])},_getBorderHashCode:function(n){var t="";return t="right"in n?this._splitBorderCode(n.right):"1N1N6N",t+("bottom"in n?this._splitBorderCode(n.bottom):"1N1N6N")},_parseBorder:function(n,t){var i=0,r={border:{}};for(n=n.split(" ");i<n.length;)r.border[n[i]]=t,i++;return r}};t.Spreadsheet.FontFamily={"angsana new":"11N",arial:"21N","arial black":"31N",batang:"41N","book antiqua":"51N","browallia new":"61N",calibri:"71N",cambria:"81N",candara:"91N",century:"10","comic sans ms":"11",consolas:"12",constantia:"13",corbel:"14","cordia new":"15",courier:"16","courier new":"17",dilleniaupc:"18",dotum:"19",fangsong:"20",garamond:"21",georgia:"22",gulim:"23",gungsuh:"24",kaiti:"25",jasmineupc:"26","malgun gothic":"27",mangal:"28",meiryo:"29","microsoft jhenghei":"30","microsoft yahei":"31",mingliu:"32",mingliu_hkscs:"33","ms gothic":"34","ms mincho":"35","ms pgothic":"36","ms pmincho":"37",pmingliu:"38","pmingliu-extb":"39",simhei:"40",simsun:"41","simsun-extb":"42",tahoma:"43",times:"44","times new roman":"45","trebuchet ms":"46",verdana:"47","yu gothic":"48","yu mincho":"49"};t.Spreadsheet.FontStyle={normal:"1",italic:"2",oblique:"3"};t.Spreadsheet.TextAlign={left:"1",right:"2",center:"3",justify:"4"};t.Spreadsheet.VerticalAlign={top:"1",middle:"2",bottom:"3"};t.Spreadsheet.TextDecoration={none:"1",underline:"2",overline:"3","line-through":"4","line-through underline":"5"};t.Spreadsheet.FontWeight={normal:"1",bold:"2"};t.Spreadsheet.BorderStyle={solid:"1",dashed:"2",dotted:"3"};t.Spreadsheet.CellFormat={number:"{0:N2}",currency:"{0:C2}",accounting:"{0:C2}",percentage:"{0:P2}",shortdate:"{0:MM/dd/yyyy}",longdate:"{0:dddd, MMMM dd, yyyy}",time:"{0:T}",scientific:"{0:N2}"}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cFormat=function(n){this.XLObj=n};t.spreadsheetFeatures.cFormat.prototype={getCFRule:function(n,t){var u=this.XLObj,f=u._dataContainer.sheets[u.getActiveSheetIndex()][n][t].cFormatRule,e=[],s=u._dataContainer.cFormatData,i,r,o;if(f)for(r=0,o=f.length;r<o;r++)i=s[f[r]].split("_"),e.push({action:i[0],input1:i[2],input2:i[3],color:i[4],range:i[5],isApplied:JSON.parse(i[7])});return e},setCFRule:function(n){var t=this.XLObj;t.model.allowConditionalFormats&&this._cFormat(n.action,n.input1,n.input2,n.color,n.range,t.getActiveSheetIndex())},_updateCFormatRule:function(n,t){return n.indexOf("true")>-1?n.replace("true",t):n.replace("false",t)},_getRuleIndex:function(n,i){if(t.isNullOrUndefined(i))return-1;for(var r=0,u=i.length;r<u;r++)if(i[r]===n)return r;return-1},_cFormat:function(n,t,i,r,u,f,e,o){var s=this.XLObj;if(s.model.allowConditionalFormats){s.element.ejWaitingPopup("show");f=f?f:s.getActiveSheetIndex();var h=s.getSheet(f),c=h.selectedRange,l={sheetIndex:f,reqType:"cond-format",action:"add",range:c};switch(n){case"greaterthan":this._applyGLEValues(">",t,r,n,u,f,e);break;case"greaterequalto":this._applyGLEValues(">=",t,r,n,u,f,e);break;case"lessthan":this._applyGLEValues("<",t,r,n,u,f,e);break;case"lessequalto":this._applyGLEValues("<=",t,r,n,u,f,e);break;case"equalto":this._applyGLEValues("==",t,r,n,u,f,e);break;case"notequalto":this._applyGLEValues("!=",t,r,n,u,f,e);break;case"between":this._applyBetweenValues("=",t,i,r,n,u,f,e);break;case"notbetween":this._applyBetweenValues("!",t,i,r,n,u,f,e);break;case"textcontains":this._applyContainsValues(t,r,n,u,f,e);break;case"dateoccur":this._applyDateContainsValues(t,r,n,u,f,e)}h._importRendered||s._isUndoRedo||o==="paste"||s._dupDetails||s._completeAction(l);s.element.ejWaitingPopup("hide")}},clearCF:function(i,r){var u=this.XLObj,o=u.getActiveSheetIndex(),c={sheetIndex:o,reqType:"cond-format",action:"clear",selection:i,rule:[]},f,l,s,e,h;if(u.model.allowConditionalFormats){for(s=u._dataContainer.cFormatData,e=u.isUndefined(r)?i?u.element.find(".e-selected"):u.element.find(".e-rowcell"):u._getSelectedItems(o,r)[0],e.removeClass("e-redft e-yellowft e-greenft e-redf e-redt"),f=0,l=e.length;f<l;f++)t.isNullOrUndefined(u._dataContainer.sheets[o][n(e[f]).parent().index()])||t.isNullOrUndefined(u._dataContainer.sheets[o][n(e[f]).parent().index()][e[f].cellIndex])||t.isNullOrUndefined(u._dataContainer.sheets[o][n(e[f]).parent().index()][e[f].cellIndex].cFormatRule)||(c.rule.push(this.getCFRule(n(e[f]).parent().index(),e[f].cellIndex)),u.clearRangeData(null,["cFormatRule"],n(e[f])));h=i?"clear_"+o+"_"+u._getSelectedItems()[1]:"clear_"+o+"_entire";s.indexOf(h)===-1&&s.push(h);u._isUndoRedo||u._dupDetails||u._completeAction(c)}},_getValueForCFormat:function(n,t){var r=this.XLObj,f=n.parent().index(),e=n[0].cellIndex,o=r.getRangeData([f,e,f,e],!1,null,t),i=r.XLEdit.getPropertyValueByElem(n),u=r.XLEdit.getPropertyValueByElem(n,"value2");return i=i?i.toString():"",(u&&typeof u=="string"&&!o.formatStr&&i[0]==="="||r.XLEdit.getPropertyValueByElem(n,"type")==="datetime")&&(i=u),i},_applyGLEValues:function(i,r,u,f,e,o,s){var h=this.XLObj,c,v,y,b,l,k,d,g,p,w=new RegExp(/[^.0-9]+/g),tt=new RegExp(/[^.-a-zA-Z 0-9]+/g),a,nt;for(b=h._getSelectedItems(o,s,e),y=b[0],e=b[1],a=0,nt=y.length;a<nt;a++)if(v=t.isNullOrUndefined(y[a].rowIndex)?n(y[a]):h.getCell(y[a].rowIndex,y[a].colIndex),!v.hasClass("e-hidecell")){if(c=this._getValueForCFormat(v,o),p=h.XLEdit.getPropertyValueByElem(v,"type")?h.XLEdit.getPropertyValueByElem(v,"type"):"general",k=!0,g=-1,t.isNullOrUndefined(c)||!c.length)l=f==="lessthan"||f==="lessequalto";else if(n.isNumeric(r))if(n.isNumeric(c))c=parseFloat(c),l=h.operators[i](c,parseFloat(r.replace(tt,""))),p==="percentage"&&(l=h.operators[i](c,0));else if(h._isValidDate(c))l=h.operators[i](h._dateToInt(c),parseFloat(r));else if(h._isValidTime(c))continue;else l=h.operators[i](c.toLowerCase(),r.toLowerCase());else r.lastIndexOf("%")===r.length-1&&n.isNumeric(r.replace(w,""))?l=p==="percentage"?h.operators[i](parseFloat(c),parseFloat(r.replace(w,""))):n.isNumeric(c)?h.operators[i](parseFloat(c),0):h.operators[i](c.length,0):r.indexOf("$")===0&&n.isNumeric(r.replace(w,""))?l=p==="accounting"||p!=="currency"||n.isNumeric(c)?h.operators[i](parseFloat(c),parseFloat(r.replace(w,""))):(h.operators[i](c.length,0)||h._isValidDate(c))&&!h._isValidTime(c):h._isValidDate(r)?h._isValidDate(c)?l=h.operators[i](h._dateToInt(new Date(c)),h._dateToInt(new Date(r))):h._isValidTime(c)||(l=n.isNumeric(c)?h.operators[i](parseFloat(c),h._dateToInt(r)):h.operators[i](c.length,h._dateToInt(r))):l=h._isValidTime(r)?h._isValidTime(c)?h.operators[i](h.parse.parseTime(c),h.parse.parseTime(r)):n.isNumeric(c)?h.operators[i](parseFloat(c),0):h.operators[i](c.length,0):h.operators[i](c.toLowerCase(),r.toLowerCase());d=f+"_"+i+"_"+r+"__"+u+"_"+e+"_"+h.getActiveSheetIndex();this._applyCFormatRule(v,d,g,l,k,u)}},_applyBetweenValues:function(i,r,u,f,e,o,s,h){var c=this.XLObj,l,w,b,k,a,g,nt,tt,y,v=new RegExp(/[^.0-9]+/g),d=new RegExp(/[^.-a-zA-Z 0-9]+/g),ut,p,it;for(k=c._getSelectedItems(s,h,o),b=k[0],o=k[1],c.operators["<"](r,u)||(k=u,u=r,r=k),p=0,it=b.length;p<it;p++)if(w=t.isNullOrUndefined(b[p].rowIndex)?n(b[p]):c.getCell(b[p].rowIndex,b[p].colIndex),!w.hasClass("e-hidecell")){if(l=this._getValueForCFormat(w,s),y=c.XLEdit.getPropertyValueByElem(w,"type")?c.XLEdit.getPropertyValueByElem(w,"type"):"general",g=!0,tt=-1,t.isNullOrUndefined(l)||!l.length)a=!1;else if(n.isNumeric(r.replace(d,""))&&n.isNumeric(u.replace(d,""))&&y!=="percentage"&&y!=="currency"&&y!=="accounting")if(r=r.replace(d,""),u=u.replace(d,""),n.isNumeric(l))a=c.operators[i](parseFloat(l)>=parseFloat(r)&&parseFloat(l)<=parseFloat(u));else if(c._isValidDate(l))a=c.operators[i](c._dateToInt(l)>=parseFloat(r)&&ut<=parseFloat(u));else if(c._isValidTime(l))continue;else a=c.operators[i](l.toLowerCase()>=r.toLowerCase()&&l.toLowerCase()<=u.toLowerCase());else if(r.lastIndexOf("%")===r.length-1&&n.isNumeric(r.replace(v,""))&&u.lastIndexOf("%")===u.length-1&&n.isNumeric(u.replace(v,""))&&y==="percentage")a=c.operators[i](parseFloat(l)>=parseFloat(r.replace(v,""))&&parseFloat(l)<=parseFloat(u.replace(v,"")));else if(r.indexOf("$")===0&&n.isNumeric(r.replace(v,""))&&u.indexOf("$")===0&&n.isNumeric(u.replace(v,""))&&(y==="accounting"||y!=="currency"))a=c.operators[i](parseFloat(l)>=parseFloat(r.replace(v,""))&&parseFloat(l)<=parseFloat(u.replace(v,"")));else if(c._isValidDate(r)&&c._isValidDate(u)){var rt=c._dateToInt(new Date(l)),ft=c._dateToInt(new Date(r)),et=c._dateToInt(new Date(u));a=c.operators[i](rt>=ft&&rt<=et)}else a=c._isValidTime(r)&&c._isValidTime(u)&&c._isValidTime(l)?c.operators[i](c.parse.parseTime(l)>=c.parse.parseTime(r)&&c.parse.parseTime(l)<=c.parse.parseTime(u)):c.operators[i](l.toLowerCase()>=r.toLowerCase()&&l.toLowerCase()<=u.toLowerCase());nt=e+"_"+i+"_"+r+"_"+u+"_"+f+"_"+o+"_"+c.getActiveSheetIndex();this._applyCFormatRule(w,nt,tt,a,g,f)}},_applyContainsValues:function(i,r,u,f,e,o){var h=this.XLObj,s,v,l,y,a,p,w,b,k=new RegExp(/[^.-a-zA-Z 0-9]+/g),c,d;for(y=h._getSelectedItems(e,o,f),l=y[0],f=y[1],c=0,d=l.length;c<d;c++)(v=t.isNullOrUndefined(l[c].rowIndex)?n(l[c]):h.getCell(l[c].rowIndex,l[c].colIndex),v.hasClass("e-hidecell"))||(s=this._getValueForCFormat(v,e),p=!0,b=-1,t.isNullOrUndefined(s)||!s.length?a=!1:n.isNumeric(i.replace(k,""))?(i=i.replace(k,""),h._isValidDate(s)&&(s=h._dateToInt(s).toString()),a=s.indexOf(i)>-1):h._isValidDate(i)?(h._isValidDate(s)&&(s=h._dateToInt(s).toString()),a=s.indexOf(h._dateToInt(i))>-1):h._isValidTime(i)?(h._isValidTime(s)&&(s=h._dateToInt("01/01/1990 "+s).toString()),a=s.indexOf(h._dateToInt("01/01/1990 "+i))>-1):a=s.toLowerCase().indexOf(i.toLowerCase())>-1,w=u+"__"+i+"__"+r+"_"+f+"_"+h.getActiveSheetIndex(),this._applyCFormatRule(v,w,b,a,p,r))},_applyDateContainsValues:function(i,r,u,f,e,o){var c=this.XLObj,l,a,v=!1,y,p,w=c._getSelectedItems(e,o,f),h=w[0],s,b,k,d;for(f=w[1],s=0,b=h.length;s<b;s++)(a=t.isNullOrUndefined(h[s].rowIndex)?n(h[s]):c.getCell(h[s].rowIndex,h[s].colIndex),a.hasClass("e-hidecell"))||(l=this._getValueForCFormat(a,e),p=-1,t.isNullOrUndefined(l)||!l.length?v=!1:c._isValidDate(i)&&(k=new Date(l),d=new Date(i),v=k-d==0),y=u+"__"+i+"__"+r+"_"+f+"_"+c.getActiveSheetIndex(),this._applyCFormatRule(a,y,p,v,!0,r))},refreshCFormat:function(t){var u=this.XLObj;if(u.model.allowConditionalFormats){for(var i,o=[],l=u.getActiveSheetIndex(),e,s=u._getSelectedItems(l,t)[0],r,h,f=0,c=s.length;f<c;f++){if(r=u.XLEdit.getPropertyValueByElem(n(s[f]),"cFormatRule"),!u.isUndefined(r))for(i=0,h=r.length;i<h;i++)r[i]=r[i].replace("_true","").replace("_false",""),o.indexOf(r[i])<0&&o.push(r[i]);n(s[f]).removeClass("e-redft e-yellowft e-greenft e-redf e-redt");u.clearRangeData(null,["cFormatRule"],n(s[f]))}for(i=0,h=o.length;i<h;i++)e=o[i].split("_"),this._cFormat(e[0],e[2],e[3],e[4],e[5])}},_applyCFormatRule:function(n,t,i,r,u,f){var o=this.XLObj,e=o.XLEdit.getPropertyValueByElem(n,"cFormatRule"),s,c,h,l;if(this._getRuleIndex(t+"_true",e)>-1&&(i=this._getRuleIndex(t+"_true",e)),this._getRuleIndex(t+"_false",e)>-1&&(i=this._getRuleIndex(t+"_false",e)),i>-1&&(s=e[i],c=o._dataContainer.cFormatData.indexOf(this._updateCFormatRule(s,r)),c>-1?o._dataContainer.sheets[o.getActiveSheetIndex()][n.parent().index()][n[0].cellIndex].cFormatRule[i]=c:(o._dataContainer.cFormatData.push(this._updateCFormatRule(s,r)),o._dataContainer.sheets[o.getActiveSheetIndex()][n.parent().index()][n[0].cellIndex].cFormatRule[i]=o._dataContainer.cFormatData.length-1)),e=o.XLEdit.getPropertyValueByElem(n,"cFormatRule"),!o.isUndefined(e)&&e.length>0&&(!(t+"_true"===e[i]||t+"_false"===e[i])||e.length>1)){for(h=0,l=e.length;h<l;h++)s=e[h].split("_"),s[7]==="true"&&s[4]===f&&(u=!1);r?n.removeClass("e-redft e-yellowft e-greenft e-redf e-redt").addClass("e-"+f):u&&n.removeClass("e-"+f)}else r?n.removeClass("e-redft e-yellowft e-greenft e-redf e-redt").addClass("e-"+f):n.removeClass("e-"+f);this._getRuleIndex(t+"_true",e)<0&&this._getRuleIndex(t+"_false",e)<0&&o.XLEdit._updateDataContainer(n[0],{cFormatRule:[t+"_"+r]})}}}(jQuery,Syncfusion),function(n,t,i){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.clipboard=function(n){this.XLObj=n;this._cutCells=[];this._copyCells=[];this._copyBackup={};this._cData="";this._isCut=!1;this._copyRange=[];this._isSpecial=!0;this._isShape=!1};t.spreadsheetFeatures.clipboard.prototype={copy:function(){this._triggerKeyDown(67,!0)},cut:function(){this._triggerKeyDown(88,!0)},paste:function(){this._triggerKeyDown(86,!0)},_initCopyPaste:function(){var i=this.XLObj._id,r=t.buildTag("div",{},{position:"fixed",top:-1e3,left:-1e3},{id:i+"_copyPaste"});n("body").append(r);r.append(t.buildTag("textarea ."+i+"_copyTxt",{},{width:1,height:1,overflow:"hidden",opacity:0,resize:"none",cursor:"default"},{id:i+"_hiddenTxt"}))},_copyPasteHandler:function(t){var i=this.XLObj;if(i._isUndoRedo=!1,(t.keyCode===67||t.keyCode===88||t.keyCode===86)&&i._preventctrlkey){i._showAlertDlg("Alert","CtrlKeyErrorAlert","CtrlKeyErrorAction",450);return}t.ctrlKey?t.keyCode===67?(this._getClipboard(t),this._cutCells=[],n.extend(!0,this._copyCells,i.getSheet(i.getActiveSheetIndex())._selectedCells),this._copyCells.length||(this._copyCells=[i.XLShape._picCellIdx]),setTimeout(function(){i.setSheetFocus()},0)):t.keyCode===88?(n.extend(!0,this._cutCells,i.getSheet(i.getActiveSheetIndex())._selectedCells),this._cutCells.length||(this._cutCells=[i.XLShape._picCellIdx]),this._getClipboard(t),setTimeout(function(){i.setSheetFocus()},0)):t.keyCode===86&&(i.isUndefined(t.bubbles)||(this._isSpecial=!0),n("#"+i._id+"_hiddenTxt").select(),setTimeout(function(){i.XLClipboard._setClipboard()},0)):t.keyCode===27&&i.element.find(".e-cdata").length&&i.element.find("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom")},_triggerKeyDown:function(t,i){var u=this.XLObj,r;u.setSheetFocus();r=n.Event("keydown");r.keyCode=t;r.ctrlKey=i;n("#"+u._id).trigger(r)},_getClipboard:function(t){var i=this.XLObj,r=i.getActiveSheetIndex(),e=i.getSheet(r),o=e._startCell,s=e._endCell,f=i._getContent(r).find(".e-selected"),h=i.getActiveCellElem(r)[0],u;i.XLClipboard._copyBackup.cells||(i.XLRibbon._enableButtons(["pastebtn"],"ejButton"),i.XLRibbon._enableButtons(["pastesbtn"],"ejSplitButton"));f.length?(this._copyBackup={cells:[],border:i.model.allowCellFormatting&&i.XLFormat.getHashCodeClassAsArray(),table:[],filterRange:[]},u=this._getSelectedData(o,s),i.element.find(".e-cdata").length&&i.element.find("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),n(f).addClass("e-cdata"),i.XLSelection._focusBorder(o,s,i._cutFocus),this._cData=f.length<2&&!u.length?u=" ":u,this._isCut=!1,n("#"+i._id+"_hiddenTxt").val(u).select(),this._copyBackup.actCellPos={top:h.offsetTop,left:h.offsetLeft},this._isShape=!1):(this._isShape=!0,this._copyBackup={elem:i.getSheetElement(r).find(".e-ss-activeimg"),isCut:t.keyCode===88,sIdx:r})},_getSelectedData:function(t,i){var r=this.XLObj,l="",f,e,u,h,a=r.getActiveSheetIndex(),w,c,y,p;for(t.rowIndex>=i.rowIndex&&(w=t,t=i,i=w),this._copyRange=[],this._copyRange.push(r.getActiveSheetIndex()),this._copyRange.push(r._getSelectedItems()[1]),e=t.rowIndex;e<=i.rowIndex;e++)if(e!==t.rowIndex&&(l+="\n"),t.colIndex<=i.colIndex)for(u=t.colIndex;u<=i.colIndex;u++)f=r.getCell(e,u)[0],h=r.XLEdit.getPropertyValueByElem(n(f))?r.XLEdit.getPropertyValueByElem(n(f)):"",this._updateCBackupData(e,u,f),f&&(l+=u!==i.colIndex?h+"\t":h);else for(u=i.colIndex;u<=t.colIndex;u++)f=r.getCell(e,u)[0],h=r.XLEdit.getPropertyValueByElem(n(f))?r.XLEdit.getPropertyValueByElem(n(f)):"",this._updateCBackupData(e,u,f),f&&(l+=u!==t.colIndex?h+"\t":h);var v=r.model.sheets[a]._tableManager,o,s,b=[],k=r.model.sheets[a].selectedRange;for(c=0,y=r.getObjectLength(v);c<y;c++)o=n.extend(!0,{},v[c]),s=o.range,this._compareRange(k,o.totalRow?[s[0],s[1],s[2]+1,s[3]]:s)&&(b.push(o.name),o.header=!0,o.name="Table"+(parseInt(n.trim(v[y-1].name.replace("Table","")))+c),this._copyBackup.table.push({tblName:b,tblObj:o,range:s}));return p=r.getRangeIndices(r.model.sheets[a].filterSettings.range),this._compareRange(k,p)&&(this._copyBackup.filterRange=p),l},_updateCBackupData:function(t,i,r){var u=this.XLObj;if(u.model.allowClipboard){var f=u._dataContainer,e=u.getActiveSheetIndex(),o,s=new RegExp("\\be-format.*?\\b","g");o=t in f.sheets[e]&&i in f.sheets[e][t]?n.extend(!0,{},f.sheets[e][t][i]):{};this._copyBackup.cells.push({cell:o,format:r.className.indexOf("e-format")>-1?r.className.match(s)[0]:""})}},_setClipboard:function(){var r=this.XLObj,e,rt=[],o=[],dt,ai=new RegExp("\\be-format.*?\\b","g"),s,lt=!1,k,f=r.getActiveSheetIndex(),b={cSheetIndex:this._copyRange[0],pSheetIndex:f,sheetIndex:f},ir=[],at=r.getSheet(f)._startCell,vt=r.getSheet(f)._endCell,a,g,ut=0,h,it,yt,vi,gt,c={},d,yi,ht,rr=new RegExp("\\be-shapebdr.*?\\b","g"),ur=["solid","dashed","dotted"],y=at.rowIndex<vt.rowIndex?at.rowIndex:vt.rowIndex,fr,pi=this._copyBackup.table,et,ri,p=at.colIndex<vt.colIndex?at.colIndex:vt.colIndex,v=r._dataContainer,u,ot,sr,kt,ni,ct,hr,bi,ui,fi,l,w,yr,pr,ei,oi,cr,si,st,ki,di,li,nr,ti,ar,tr,ii;if(y===0&&p===0&&this._copyCells.length===this.XLObj.model.rowCount*this.XLObj.model.columnCount||this._copyCells.length!==this.XLObj.model.rowCount*this.XLObj.model.columnCount){var vr=r.model.sheets[f],pt=r.getSheetElement(f).find(".e-activecell"),ft=r.getSheet(this._copyBackup.sIdx||this._copyRange[0]||f)._shapeMngr,wt,nt,bt,er,or,wi,tt;if(this._isShape)ni=r.XLShape._picCellIdx,ct=r.getActiveCell(f),d=this._copyBackup.elem,kt=d[0].id,dt=kt.indexOf("picture")>-1?"picture":"chart",ft[dt].some(function(n,t){return kt===n.id?(sr=t,!0):!1}),b={sheetIndex:f,cSheetIndex:this._copyBackup.sIdx,pSheetIndex:f,operation:"shape",cShapeId:kt,reqType:this._copyBackup.isCut?"cut-paste":"copy-paste"},e=n.extend(!0,{},v.sheets[this._copyBackup.sIdx][ni.rowIndex][ni.colIndex]),b.cutCell={rowIndex:ni.rowIndex,colIndex:ni.colIndex,obj:e},o=r.getCell(ct.rowIndex,ct.colIndex),n.extend(!0,c,ft[dt][sr]),d=r.element.find("#"+c.id),dt==="picture"?(nt=d[0].className,nt.indexOf("e-shapebdr")>-1?(nt=d[0].className.match(rr)[0],et=nt.replace("e-shapebdr","").split("N"),ri=et[2],r.XLShape._createPicture(f,o[0],ft.sharedPics[c.data],o[0].offsetTop,o[0].offsetLeft,c.width,c.height,null,"#"+ri,ur[parseInt(et[1])-1],et[0]+"px")):r.XLShape._createPicture(f,o[0],ft.sharedPics[c.data],o[0].offsetTop,o[0].offsetLeft,c.width,c.height)):(u=c.range,u=r._getAlphaRange(f,u[0],u[1],u[2],u[3]),u.indexOf(":")===-1&&(u=u+":"+u),c.top=o[0].offsetTop,c.left=o[0].offsetLeft,r.XLChart.createChart(u,n.extend(!0,{},c))),this._copyBackup.isCut&&d.remove(),this._isShape=this._copyBackup.isCut?!1:!0,this._cutCells=[],r._isUndoRedo||(hr=r._id+"_"+dt,kt=this.XLObj.XLChart._shapeCnt-1,b.pShapeId=hr+kt,b.pasteCell={rowIndex:ct.rowIndex,colIndex:ct.colIndex,obj:n.extend(!0,{},v.sheets[f][ct.rowIndex][ct.colIndex])},r._completeAction(b));else{if(b.reqType=this._cutCells.length>0?"cut-paste":"copy-paste",r.element.find(".e-selected").hasClass("e-readonly")){r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom");return}if(b.text=rt=n("#"+r._id+"_hiddenTxt").val().split("\n"),lt=this._cData===n("#"+r._id+"_hiddenTxt").val(),this._cData.length<1&&b.text.length<1)return;if(lt||rt[rt.length-1]!==""||rt.splice(rt.length-1,1),bi=[],lt?(b.isSpecial=this._isSpecial,u=r.getRangeIndices(this._copyRange[1]),r.setActiveSheetIndex(this._copyRange[0]),b.cutBorder={range:u,prevBorder:r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(u)},r.setActiveSheetIndex(f)):b.isSpecial=!1,this._cutCells.length){for(wi=[],tt=this._copyRange[0],a=0,bt=this._cutCells.length;a<bt;a++)l=this._cutCells[a].rowIndex,w=this._cutCells[a].colIndex,s=r.getCell(l,w,tt),o={rowIndex:l,colIndex:w,prevObj:{},newObj:{}},t.isNullOrUndefined(v.sheets[tt][l])?o.prevObj={}:n.extend(!0,o.prevObj,v.sheets[tt][l][w]),s[0]&&("isMerge"in o.prevObj||r.XLEdit.updateCellValue(s,""),e=t.isNullOrUndefined(v.sheets[tt][l])?{}:n.extend(!0,{},v.sheets[tt][l][w]),"wrap"in e&&e.wrap&&(yt=r._generateHeaderText(tt,w+1)+(l+1),r.setWrapText(yt+":"+yt,"wrap")),s.removeClass("e-commentcell e-hyperlinks e-redft e-yellowft e-greenft e-redf e-redt e-hlcell"),l in v.sheets[tt]&&w in v.sheets[tt][l]&&delete v.sheets[tt][l][w],s[0].className.match(ai)&&(s[0].className=s[0].className.replace(ai,"")),t.isNullOrUndefined(v.sheets[tt][l])?o.newObj={}:n.extend(!0,o.newObj,v.sheets[tt][l][w]),r._setRowHdrHeight(tt,n(s[0]).parent().index())),wi.push(o);for(h=0,it=pi.length;h<it;h++)fr=n.trim(pi[h].tblName),r.XLFormat.removeTable(n.trim(pi[h].tblName[0].replace("Table","")));r.model.allowCellFormatting&&r.XLFormat.clearFormat(u,"format");r.setActiveSheetIndex(tt);r.setActiveSheetIndex(f);b.cutCells=wi;b.cfat={table:fr,range:u};or=!0;r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom")}else{if(oi=[],this._isSpecial)for(a=0,bt=this._copyCells.length;a<bt;a++)l=this._copyCells[a].rowIndex,w=this._copyCells[a].colIndex,o={rowIndex:l,colIndex:w},t.isNullOrUndefined(v.sheets[f][l])?o.prevObj={}:n.extend(!0,o.prevObj,v.sheets[f][l][w]),oi.push(o);else oi=this._copyCells;b.cutCells=oi}for(rt.length?wt=[y,p,y+rt.length-1,p+rt[0].split("\t").length-1]:(wt=[y,p,y,p],a=g=1),b.pasteBorder={range:wt,prevBorder:r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(wt)},cr=r._getContent(f).find(".e-table")[0].tBodies[0],a=0,bt=rt.length;a<bt;a++){for(o=rt[a].split("\t"),g=0,er=o.length;g<er;g++){if(s=cr.rows[y+a]?r.getCell(y+a,p+g)[0]:i,t.isNullOrUndefined(s)?(vr.colCount<=p+g?r.XLScroll._createNewColumn(f,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert"):r.XLScroll._createNewRow(f,-1,-1,"insert"),r.XLScroll._refreshScroller(f,"refresh","all"),s=r.getCell(y+a,p+g)):s=n(s),k={rowIndex:y+a,colIndex:p+g},k.prevObj=t.isNullOrUndefined(v.sheets[f][y+a])?{}:n.extend(!0,{},v.sheets[f][y+a][p+g]),this._isCut&&lt)return;if(this._isSpecial&&lt)if(u=r.getRangeIndices(this._copyRange[1]),ei=r.getRange(u[0],u[1],u[2],u[3],this._copyRange[0]),l=s.parent("tr").index(),w=s[0].cellIndex,yr=n(ei[ut]).parent("tr").index(),pr=ei[ut].cellIndex,s[0].className=s[0].className.replace(ai,""),nt=this._copyBackup.cells[ut].format,"isMerge"in this._copyBackup.cells[ut].cell||t.isNullOrUndefined(nt)||s.addClass(nt),e=n.extend(!0,{},this._copyBackup.cells[ut].cell),e){if(l in v.sheets[f]||(v.sheets[f][l]={}),w in v.sheets[f][l]?"comment"in v.sheets[f][l][w]&&r.getCell(l,w).removeClass("e-commentcell"):v.sheets[f][l][w]={},v.sheets[f][l][w]=e,fi=e.value2&&typeof e.value2=="string"&&!e.formatStr?v.sharedData[e.value][0]==="="?v.sharedData[e.value]:e.value2:v.sharedData[e.value],"isMerge"in e||r.XLEdit.updateCellValue(s,fi),"isMerge"in e){si=0;u=r.getRangeIndices(e.mRange);var hi=u[2]-u[0],ci=u[3]-u[1],wr=r.getSheet(f)._selectedCells,gi=r._getAlphaRange(f,k.rowIndex,k.colIndex,k.rowIndex+hi,k.colIndex+ci),lr=r.getRange(u[0],u[1],u[2],u[3],f).eq(0).attr("rowspan"),br=vt.rowIndex-at.rowIndex,kr=vt.colIndex-at.colIndex;if(st=r.getRange(k.rowIndex,k.colIndex,k.rowIndex+hi,k.colIndex+ci,f),ei.length>=wr.length||!((kr+1)%(ci+1)==0&&(br+1)%(hi+1)==0)){for(h=0,it=st.length;h<it;h++)st[h].className.indexOf("e-mc-hide")<0&&(si++,ki=st[h].getAttribute("rowspan"),di=st[h].getAttribute("colspan"),t.isNullOrUndefined(ki)||t.isNullOrUndefined(di)||(si+=parseInt(ki)*parseInt(di)-1),e.isCenterAlign&&(st.addClass("e-calign"),st.removeClass("e-ralign")));if(st.length===si)this._cutCells.length&&(r.XLEdit.updateCellValue(r._getAlphaRangeCells(e.mRange),""),r.setActiveSheetIndex(tt),r._unMergeAllCells(this._copyRange[0],0,r.XLSelection._getSelectedRange({rowIndex:u[0],colIndex:u[1]},{rowIndex:u[2],colIndex:u[3]}),[],0,0),r.setActiveSheetIndex(f)),r._paste=!0,r.isUndefined(k.prevObj.mRange)||r.unmergeCells(k.prevObj.mRange),r.unmergeCells(gi),r._mergeCenter=e.isCenterAlign,r.isUndefined(lr)||lr!=="1"?r.mergeCells(gi,!0):r.mergeAcrossCells(gi,!0),r.XLEdit.updateCellValue(s,fi),t.isNullOrUndefined(nt)||s.addClass(nt);else{li=n.extend(!0,{},e);nr=r.getCell(u[0],u[1],this._copyRange[0]);li.value=li.value2=fi;t.isNullOrUndefined(nt)||nr.addClass(nt);r.XLEdit._updateDataContainer(nr[0],li);r._showAlertDlg("Alert","MergeAlert","",250);return}}r.performSelection({rowIndex:k.rowIndex,colIndex:k.colIndex},{rowIndex:k.rowIndex+hi,colIndex:k.colIndex+ci})}if("hyperlink"in e&&(ui=e.hyperlink,ui&&!ui.webAddr?s.html(t.buildTag("a.e-hyperlinks",s.text(),"",{href:"#"})):s.html(t.buildTag("a.e-hyperlinks",s.text(),"",{href:ui.webAddr,target:"_blank"}))),"comment"in e&&(s.removeClass("e-commentcell"),r.XLComment.setComment(s,null,!1)),"cFormatRule"in e)for(vi=n.extend(!0,[],e.cFormatRule),e.cFormatRule=[],h=0,it=vi.length;h<it;h++)gt=r._dataContainer.cFormatData[vi[h]].split("_"),r.XLCFormat._cFormat(gt[0],gt[2],gt[3],gt[4],null,null,[l,w,l,w],"paste");if("wrap"in e&&e.wrap&&(yt=r._generateHeaderText(f,w+1)+(l+1),r.setWrapText(yt+":"+yt,"wrap")),r._isPaste=!0,"picture"in e)for(h=0,it=e.picture.length;h<it;h++)o=this._copyCells.length?this._copyCells[ut]:this._cutCells[ut],ot=this._copyBackup.actCellPos,ht=r.getRangeData([o.rowIndex,o.colIndex,o.rowIndex,o.colIndex],"","",this._copyRange[0])[0],(!r.isUndefined(ht.picture)&&ht.picture.indexOf(e.picture[h])>-1||!this._copyCells.length)&&(n.extend(!0,c,ft.picture[e.picture[h]]),d=r.element.find("#"+c.id),c.rowIndex===o.rowIndex&&c.colIndex===o.colIndex&&(d=r.element.find("#"+c.id),nt=d[0].className,nt.indexOf("e-shapebdr")>-1?(nt=d[0].className.match(rr)[0],et=nt.replace("e-shapebdr","").split("N"),ri=et[2],r.XLShape._createPicture(f,s[0],ft.sharedPics[c.data],parseInt(d.css("top"))-ot.top+pt[0].offsetTop,parseInt(d.css("left"))-ot.left+pt[0].offsetLeft,c.width,c.height,null,"#"+ri,ur[parseInt(et[1])-1],et[0]+"px")):r.XLShape._createPicture(f,s[0],ft.sharedPics[c.data],parseInt(d.css("top"))-ot.top+pt[0].offsetTop,parseInt(d.css("left"))-ot.left+pt[0].offsetLeft,c.width,c.height),this._copyRange[0]===f&&(v.sheets[f][y+a][p+g].picture[h]=ft.picture.length-1),this._cutCells.length&&d.remove()));if("chart"in e)for(ht=r.getRangeData([l,w,l,w]),h=0,it=e.chart.length;h<it;h++)o=this._copyCells.length?this._copyCells[ut]:this._cutCells[ut],ot=this._copyBackup.actCellPos,ht=r.getRangeData([o.rowIndex,o.colIndex,o.rowIndex,o.colIndex])[0],(!r.isUndefined(ht.chart)&&ht.chart.indexOf(e.chart[h])>-1||!this._copyCells.length)&&(n.extend(!0,c,ft.chart[e.chart[h]]),d=r.element.find("#"+c.id),c.rowIndex===o.rowIndex&&c.colIndex===o.colIndex&&(u=c.range,u=r._getAlphaRange(f,u[0],u[1],u[2],u[3]),u.indexOf(":")<0&&(u=u+":"+u),c.top=parseInt(d.css("top"))-ot.top+pt[0].offsetTop,c.left=parseInt(d.css("left"))-ot.left+pt[0].offsetLeft,r.XLChart.createChart(u,c),v.sheets[f][y+a][p+g].chart[h]=ft.chart.length-1,this._cutCells.length&&d.remove()))}else r.XLEdit.updateCellValue(s,""),delete v.sheets[f][l][w];else r.XLEdit.updateCellValue(s,o[g]),s.hasClass("e-commentcell")&&r.XLComment._updateCmntFrmCntnr(null,null,s),o[g].indexOf("=")>-1&&r.XLEdit.updateCellValue(s,s.html());ut++;k.newObj=t.isNullOrUndefined(v.sheets[f][y+a])?{}:n.extend(!0,{},v.sheets[f][y+a][p+g]);t.isNullOrUndefined(k.newObj)&&(k.newObj={});bi.push(k)}r._setRowHdrHeight(f,s.parent().index())}if(rt.length<1&&(a=1),this._cutCells.length&&(this._isCut=or,this._cutCells=[]),this._isSpecial&&lt){for(ar=this._copyBackup.table,u=r.getRangeIndices(this._copyRange[1]),h=0,it=ar.length;h<it;h++)ti=this._copyBackup.table[h].range,tr=n.extend(!0,{},this._copyBackup.table[h].tblObj),tr.name="",r.XLFormat.createTable(tr,r._getAlphaRange(this._copyRange[0],ti[0]+y-u[0],ti[1]+p-u[1],y-u[0]+ti[2],p-u[1]+ti[3])),ir.push(this.XLObj.model.sheets[f]._tableManager[this.XLObj.getObjectLength(this.XLObj.model.sheets[f]._tableManager)-1]);wt=[y,p,a+y-1,g+p-1];this._cutCells.length&&this._copyBackup.filterRange.length>0&&this._copyRange[0]===f&&(ii=this._copyBackup.filterRange,r.XLFilter.clearFilter(),yi=r._generateHeaderText(f,ii[1]+p-u[1]+1)+(ii[0]+y-u[0]+1)+":"+r._generateHeaderText(f,p-u[1]+ii[3]+1)+(y-u[0]+ii[2]+1),r.XLFilter.filter(yi));b.pasteBorder.newBorder=r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(wt);r.setActiveSheetIndex(this._copyRange[0]);b.cutBorder.newBorder=r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(u);r.setActiveSheetIndex(f)}b.pfat={table:this._copyBackup.table,range:u,minRowIdx:y,minColIdx:p,ptable:ir};b.pfilter=yi;b.pasteCells=bi;r.XLSelection.selectRange({rowIndex:y,colIndex:p},{rowIndex:a+y-1,colIndex:g+p-1});r.getSheet(f)._startCell={rowIndex:y,colIndex:p};r.getSheet(f)._endCell={rowIndex:a+y-1,colIndex:g+p-1};r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement();b.sheetIndex=f;r.setSheetFocus();r.XLRibbon._updateRibbonIcons();r._isUndoRedo||r._completeAction(b)}}else r._showAlertDlg("Alert","FullSheetCopyPasteAlert","",375)},_compareRange:function(n,t){return n[0]<=t[0]&&n[1]<=t[1]&&n[2]>=t[2]&&n[3]>=t[3]}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.comments=function(n){this.XLObj=n;this._isCommentEdit=!1;this._isShowAllComments=!1;this._curCommentHCell=null};t.spreadsheetFeatures.comments.prototype={setComment:function(i,r,u,f){var e=this.XLObj;if(e.model.allowComments){var s=e.getActiveSheetIndex(),o=t.isNullOrUndefined(i)?e.getActiveCellElem(s):n(i),a=o.parent().index(),v=o.index(),l,h,c;u=t.isNullOrUndefined(u)?!0:u;f=t.isNullOrUndefined(f)?!0:f;c=(e.model.userName.length>0?e.model.userName:e._getLocStr("UserName"))+":\n";t.isNullOrUndefined(r)||(f&&(r=c+r),e.XLEdit._updateDataContainer(o[0],{comment:{value:r,isVisible:t.isNullOrUndefined(e.XLEdit.getPropertyValueByElem(o,"comment",s))?!1:e.XLEdit.getPropertyValueByElem(o,"comment",s).isVisible}}));l=t.isNullOrUndefined(e.XLEdit.getPropertyValueByElem(o,"comment",s))?c:e.XLEdit.getPropertyValueByElem(o,"comment",s).value;e.model.allowComments&&o.length>0&&!o.hasClass("e-commentcell")&&!e.XLEdit._isEdit&&!e._isSheetRename&&(o.prepend(t.buildTag("span.e-comment",t.buildTag("span.e-celltoparrow")).append(t.buildTag("textarea.e-comment-txtarea",l,{"z-index":10}))).addClass("e-commentcell"),h=o.find(".e-comment-txtarea"),e.model.sheets[s]._importRendered||(this._updateCmntArrowPos(o),h.focus().setInputPos(h.val().length)),this._updateCmtAreaPos(o,h),e.model.sheets[s]._importRendered&&(e.XLEdit.getPropertyValueByElem(o,"comment",s).value=h.val()),u?(h.focus(),!this._curCommentHCell||t.isNullOrUndefined(e.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment"))||e.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment").isVisible||(this._curCommentHCell.find(".e-comment-txtarea").hide(),this._curCommentHCell=null),e.XLDragDrap._isDragAndDropped||this._updateCurrentCell(a,v),this._isCommentEdit=!0,e.model.showRibbon&&e.XLRibbon._disableRibbonIcons()):(e._isShowAllComments||e.XLEdit.getPropertyValueByElem(o,"comment",s).isVisible||h.hide(),e.model.sheets[s]._importRendered||e.XLDragDrap._isDragAndDropped||this._updateCmntRibIcons(e.XLClipboard._isSpecial?e.getActiveCellElem():o)))}},_updateCmtAreaPos:function(n,t){var r=this.XLObj,u=r.getActiveSheetIndex(),s=r._getContent(u).find("#hscrollBar").offset(),f=r._getContent(u).find("#vscrollBar").offset(),h=r._getJSSheetHeader(u).offset(),i=t.offset(),e=t.height(),o=t.width();r.model.scrollSettings.allowScrolling&&(i.top+e+5>s.top&&i.left+o<f.left?t.css({top:-77}):i.left+o>f.left&&i.top+e+5>s.top?t.css({left:-136,top:-81}):i.top+e>h.top&&i.left+o>f.left&&t.css({left:-137,top:n.height()+8}))},deleteComment:function(i,r,u){var f=this.XLObj,o;if(f.model.allowComments){var s,l=[],h=f.getActiveSheetIndex(),e,c={sheetIndex:h,reqType:"comment",action:"delete"};if(typeof i=="string"&&(i=f.getRangeIndices(i)),e=t.isNullOrUndefined(i)?f.getSheetElement(h).find(".e-selected.e-commentcell"):f.getRange(i[0],i[1],i[2],i[3],h).filter(".e-commentcell"),f.model.allowComments&&e.hasClass("e-commentcell")){for(o=0;o<e.length;o++){if(s=n(e[o]),u&&f._isHiddenRow(s.parent().index())){e.splice(o,1);continue}t.isNullOrUndefined(f.XLEdit.getPropertyValueByElem(s,"comment"))||l.push({rowIndex:s.parent().index(),colIndex:e[o].cellIndex,prevComment:f.XLEdit.getPropertyValueByElem(s,"comment"),currComment:{}})}c.selCells=l;e.find(".e-comment").parent("td").removeClass("e-commentcell").end().remove();f.clearRangeData(null,["comment"],e);f.model.showRibbon&&!f.XLDragDrap._isDragAndDropped&&f.XLComment._updateCmntRibIcons();c.reqType=t.isNullOrUndefined(r)?"comment":"clear-comment";f._isUndoRedo||f._dupDetails||f._completeAction(c)}}},editComment:function(i){var r=this.XLObj,u;r.model.allowComments&&(u=t.isNullOrUndefined(i)?r.getActiveCellElem():n(i),r.XLEdit._isEdit||r._isSheetRename||(r.model.allowComments&&u.hasClass("e-commentcell")&&(u.find(".e-comment-txtarea").css("display","inline-table").focus(),this._isCommentEdit=!0),r.model.showRibbon&&r.XLRibbon._disableRibbonIcons()))},showHideComment:function(i){var r=this.XLObj,u=t.isNullOrUndefined(i)?r.getActiveCellElem():n(i),e=u.find(".e-comment-txtarea"),f=!1;r.model.allowComments&&(u.hasClass("e-commentcell")&&(r.XLEdit.getPropertyValueByElem(u,"comment").isVisible?(e.hide(),f=!1):(e.css("display","inline-table"),this._curCommentHCell=null,f=!0)),r.isUndefined(f)||(r.XLEdit.getPropertyValueByElem(u,"comment").isVisible=f))},showAllComments:function(){var t=this.XLObj,e=t.getMainPanel().find(".e-comment-txtarea"),h=n("#"+t._id+"_Ribbon_showAllComments").data("ejToggleButton"),o=["previousComment","nextComment"],i,s,r,u,f;if(t.model.allowComments){for(this._isShowAllComments?(e.hide(),r=!1):(e.css("display","inline-table"),r=!0),this._isShowAllComments=r,i=1;i<=t.model.sheetCount;i++)for(u=0,f=t.getSheetElement(i).find(".e-commentcell"),s=f.length;u<s;)t.XLEdit.getPropertyValueByElem(n(f[u]),"comment",i).isVisible=r,u++;t.model.showRibbon&&h.model.toggleState?t.XLRibbon._disableButtons(o,"ejButton"):t.model.showRibbon&&t.getMainPanel().find(".e-commentcell").length>0&&t.XLRibbon._enableButtons(o,"ejButton")}},findPrevComment:function(){var i=this.XLObj,s=i.model.activeSheetIndex,a,h,c,l,u,f,e,r,v=n("#"+i._id+"_Ribbon_newComment"),o;if(!i.model.allowComments||i.getMainPanel().find(".e-commentcell").length<1)return!1;for(u=s;u>0;u--)for(u!==s&&i.gotoPage(u,!1),i.model.showRibbon&&n("#"+i._id+"_Ribbon").ejRibbon("option","selectedItemIndex",5),a=i.model.sheets[i.model.activeSheetIndex].rowCount-1,h=i.model.sheets[i.model.activeSheetIndex].colCount-1,u!==s&&this._updateCurrentCell(a-1,h-1),c=i.getSheet(i.model.activeSheetIndex)._activeCell.rowIndex,l=i.getSheet(i.model.activeSheetIndex)._activeCell.colIndex,f=c;f>=0;f--)for(f!==c&&(l=h-1),e=l;e>=0;e--){if(r=n(i.getCell(f,e)),o=n(r.find(".e-comment-txtarea")),i.getActiveCellElem()[0]!==r[0]&&!t.isNullOrUndefined(i.XLEdit.getPropertyValueByElem(r,"comment"))&&i.XLEdit.getPropertyValueByElem(r,"comment").isVisible&&o.hide(),r.hasClass("e-commentcell")&&!o.is(":visible"))return o.css("display","inline-table").focus()&&this._updateCurrentCell(f,e),i.model.showRibbon&&(i.XLRibbon._enableButtons(["deleteComment","showHideComment"],"ejButton"),v.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt"),v.find(".e-btntxt").text(i._getLocStr("EditComment"))),i.setSheetFocus(),!0;this._isShowAllComments||this._isCommentEdit||!r.hasClass("e-commentcell")||i.XLEdit.getPropertyValueByElem(r,"comment").isVisible||o.hide()}u===0&&i._showAlertDlg("","CommentFindEndAlert","findPrevComment",630)},findNextComment:function(){var i=this.XLObj,s=i.model.activeSheetIndex,h,c,l,a,u,f,e,r,o,v=n("#"+i._id+"_Ribbon_newComment");if(!i.model.allowComments||i.getMainPanel().find(".e-commentcell").length<1)return!1;for(u=s;u<=i.model.sheetCount;u++)for(u!==s&&i.gotoPage(u,!1),i.model.showRibbon&&n("#"+i._id+"_Ribbon").ejRibbon("option","selectedItemIndex",5),u!==s&&this._updateCurrentCell(0,0),h=i.getSheet(i.model.activeSheetIndex)._activeCell.rowIndex,c=i.getSheet(i.model.activeSheetIndex)._activeCell.colIndex,l=i.model.sheets[i.model.activeSheetIndex].rowCount-1,a=i.model.sheets[i.model.activeSheetIndex].colCount-1,f=h;f<l;f++)for(f!==h&&(c=0),e=c;e<a;e++){if(r=n(i.getCell(f,e)),o=n(r.find(".e-comment-txtarea")),i.getActiveCellElem()[0]!==r[0]&&!t.isNullOrUndefined(i.XLEdit.getPropertyValueByElem(r,"comment"))&&i.XLEdit.getPropertyValueByElem(r,"comment").isVisible&&o.hide(),r.hasClass("e-commentcell")&&!o.is(":visible"))return o.css("display","inline-table").focus(),this._updateCurrentCell(f,e),i.model.showRibbon&&(i.XLRibbon._enableButtons(["deleteComment","showHideComment"],"ejButton"),v.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt"),v.find(".e-btntxt").text(i._getLocStr("EditComment"))),i.setSheetFocus(),!0;this._isShowAllComments||this._isCommentEdit||!r.hasClass("e-commentcell")||i.XLEdit.getPropertyValueByElem(r,"comment").isVisible||o.hide()}u===i.model.sheetCount+1&&i._showAlertDlg("","CommentFindEndAlert","findNextComment",630)},_commentMouseMove:function(i){var f=this.XLObj,r=n(i.target),e=r.find(".e-comment-txtarea"),u;this._isCommentEdit||(t.isNullOrUndefined(this._curCommentHCell)||r!==this._curCommentHCell&&(u=f.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment"),t.isNullOrUndefined(u)||u.isVisible||(this._curCommentHCell.find(".e-comment-txtarea").hide(),this._curCommentHCell=null)),i.target.tagName==="TD"&&r.hasClass("e-commentcell")&&(e.css("display","inline-table"),this._curCommentHCell=r))},_commentMouseDownHandler:function(t){var i=this.XLObj,r=i.getActiveCellElem(),u,f=n(r.find(".e-comment-txtarea"));r.hasClass("e-commentcell")&&f.get()[0]!==t.target&&(u=i.XLEdit.getPropertyValueByElem(r,"comment"),this._isCommentEdit&&this._updateCurCmntVal(),this._isShowAllComments||i.isUndefined(u)||u.isVisible||f.hide());n(t.target).hasClass("e-comment-txtarea")&&(n(t.target).focus().css("z-index",10)&&(this._isCommentEdit=!0),this._updateCurrentCell(n(t.target).parents("td").parent().index(),n(t.target).parents("td").index()),i.model.showRibbon&&i.XLRibbon._disableRibbonIcons())},_updateCmntRibIcons:function(t){var i=this.XLObj,f=["showHideComment","deleteComment"],e=i.getActiveSheetIndex(),o=i.getSheetElement(e),r=n("#"+i._id+"_Ribbon_newComment"),s=i.getActiveCellElem(),u=o.find(".e-selected");t=i.model.allowDragandDrop&&!i.XLDragDrap._isDragAndDropped?t?t:s:i.getCell(i._dStartCell.rowIndex,i._dStartCell.colIndex);i.XLRibbon._enableButtons(["newComment"],"ejButton");i.XLRibbon._enableButtons(i.XLRibbon._cmntTglBtnIds,"ejToggleButton");t.hasClass("e-commentcell")?(i.XLRibbon._enableButtons(f,"ejButton"),r.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt"),r.find(".e-btntxt").text(i._getLocStr("EditComment"))):(r.find(".e-icon").removeClass("e-ssr-editcmnt").addClass("e-ssr-newcmnt"),r.find(".e-btntxt").text(i._getLocStr("NewComment")),i.XLRibbon._disableButtons(f,"ejButton"));this._isShowAllComments||i.element.find(".e-commentcell").length===0?i.XLRibbon._disableButtons(["previousComment","nextComment"],"ejButton"):i.XLRibbon._enableButtons(["previousComment","nextComment"],"ejButton");u.length>1&&u.is(t)&&u.filter(".e-commentcell").length>0&&i.XLRibbon._enableButtons(["deleteComment"],"ejButton")},_updateCurCmntVal:function(i,r){r=t.isNullOrUndefined(r)?"":r;var u=this.XLObj,f=t.isNullOrUndefined(i)?u.getActiveCellElem():n(i),o=n(f.find(".e-comment-txtarea")),s,h=[],e={sheetIndex:u.getActiveSheetIndex(),reqType:"comment"},c=f.parent().index(),l=f.index();h.push({rowIndex:c,colIndex:l});e.action=t.isNullOrUndefined(u.XLEdit.getPropertyValueByElem(f,"comment"))?"add":"edit";e.selCells=h;e.selCells[0].prevComment=u.XLEdit.getPropertyValueByElem(f,"comment");s=o.css("z-index",9).val();u.XLEdit._updateDataContainer(f.get(0),{comment:{value:s,isVisible:u.isUndefined(u.XLEdit.getPropertyValueByElem(f,"comment"))?this._isShowAllComments:u.XLEdit.getPropertyValueByElem(f,"comment").isVisible}});this._isShowAllComments||u.XLEdit.getPropertyValueByElem(f,"comment").isVisible||o.hide();u.setSheetFocus();this._isCommentEdit=!1;u.XLCellNav._isNavigate=!0;u.model.showRibbon&&u.XLRibbon._enableRibbonIcons();u.XLEdit._updateUsedRange(c,l);e.selCells[0].curComment=u.XLEdit.getPropertyValueByElem(f,"comment");u._isUndoRedo||u._hasComment||r==="paste"||u._completeAction(e)},_updateCurrentCell:function(n,t,i){var r=this.XLObj,u={rowIndex:n,colIndex:t},f;i=i?i:r.model.activeSheetIndex;f=r.getSheet(i);f._activeCell=u;r.XLSelection.selectRange(u,u,i);f._startCell=f._endCell=u;r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement()},_updateCmntArrowPos:function(t){var f=this.XLObj,e=t?t:f.getSheetElement(f.getActiveSheetIndex()).find(".e-commentcell"),u,i,o,r;if(f.model.allowComments)for(u=0,o=e.length;u<o;u++)if(i=n(e[u]),r=i.find(".e-comment"),r.length){if(i.width()<5){r.hide();continue}r.is(":hidden")&&r.show();r.css({top:i.get()[0].offsetTop+"px",left:i.get()[0].offsetLeft+i.get()[0].offsetWidth-5+"px"})}},_updateCmntFrmCntnr:function(n,t,i){var r=this.XLObj,u=i||r.getCell(n,t);r.XLEdit.getPropertyValueByElem(u,"comment")&&(r._removeClass(u[0],"e-commentcell"),this.setComment(u,null,!1))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.contextmenu=function(n){this.XLObj=n;this._clrFltrEnable=!1;this._isMenuOpened=!1;this._rowCellMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,sprite:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert")+"...",parentId:null},{id:"Delete",text:n._getLocStr("Delete")+"...",parentId:null},{id:"Filter",text:n._getLocStr("Filter"),parentId:null,sprite:"e-icon e-ss-filter"},{id:"Sort",text:n._getLocStr("Sort"),parentId:null,sprite:"e-icon e-ss-sortatoz"},{id:"SortAtoZ",parentId:"Sort",text:n._getLocStr("SortAtoZ"),sprite:"e-icon e-ss-sortatoz"},{id:"SortZtoA",parentId:"Sort",text:n._getLocStr("SortZtoA"),sprite:"e-icon e-ss-sortztoa"},{id:"ctxComment",parentId:null,text:n._getLocStr("Comment")},{id:"ctxInsrtCmnt",text:n._getLocStr("InsertComment"),parentId:"ctxComment",sprite:"e-icon e-ss-newcmnt"},{id:"ctxEditCmnt",text:n._getLocStr("EditComment"),parentId:"ctxComment",sprite:"e-icon e-ss-editcmnt"},{id:"ctxDeleteCmnt",text:n._getLocStr("DeleteComment"),parentId:"ctxComment",sprite:"e-icon e-ss-deletecmnt"},{id:"ctxShwHdCmnt",text:n._getLocStr("ShowHide"),parentId:"ctxComment",sprite:"e-icon"},{id:"PutCellColor",parentId:"Sort",text:n._getLocStr("PutCellColor"),sprite:""},{id:"PutFontColor",parentId:"Sort",text:n._getLocStr("PutFontColor"),sprite:""},{id:"CmHyperLink",text:n._getLocStr("HyperLink"),parentId:null,sprite:"e-icon e-ss-hyperlink"},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"ClearFilter",parentId:"Filter",text:n._getLocStr("ClearFilter"),sprite:"e-icon e-ss-filternone"},{id:"FilterSelected",parentId:"Filter",text:n._getLocStr("FilterSelected"),sprite:"e-icon e-ss-filter"},{id:"HyperLink",text:n._getLocStr("HyperLink")+"...",parentId:"CmHyperLink",sprite:"e-icon e-ss-hyperlink"},{id:"EditLink",text:n._getLocStr("EditLink")+"...",parentId:"CmHyperLink"},{id:"OpenLink",text:n._getLocStr("OpenLink"),parentId:"CmHyperLink"},{id:"RemoveLink",text:n._getLocStr("RemoveLink"),parentId:"CmHyperLink",sprite:"e-icon e-ss-removelink"}];this._columnHeaderMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,sprite:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert"),parentId:null},{id:"Delete",text:n._getLocStr("Delete"),parentId:null},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Hide",text:n._getLocStr("Hide"),parentId:null},{id:"Unhide",text:n._getLocStr("Unhide"),parentId:null},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"}];this._rowHeaderMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,sprite:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert"),parentId:null},{id:"Delete",text:n._getLocStr("Delete"),parentId:null},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Hide",text:n._getLocStr("Hide"),parentId:null},{id:"Unhide",text:n._getLocStr("Unhide"),parentId:null},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"}];this._footerMenuData=[{id:"InsertSheet",text:n._getLocStr("InsertSheet"),parentId:null},{id:"DeleteSheet",text:n._getLocStr("DeleteSheet"),parentId:null,sprite:"e-icon e-ss-delete"},{id:"RenameSheet",text:n._getLocStr("RenameSheet"),parentId:null,sprite:"e-icon "},{id:"MoveorCopy",text:n._getLocStr("MoveorCopy")+"...",parentId:null,sprite:"e-icon "},{id:"HideSheet",text:n._getLocStr("HideSheet"),parentId:null,sprite:"e-icon "},{id:"UnhideSheet",text:n._getLocStr("UnhideSheet"),parentId:null,sprite:"e-icon "}];this._chartMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"ChartType",text:n._getLocStr("ChangeChartType")+"...",parentId:null},{id:"SelectData",text:n._getLocStr("SelectData")+"...",parentId:null}];this._imgMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,sprite:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,sprite:"e-icon e-ss-copy"},{id:"ChangePicture",text:n._getLocStr("ChangePicture"),parentId:null}]};t.spreadsheetFeatures.contextmenu.prototype={_initContextMenu:function(){var n=t.buildTag("ul .e-spreadsheet"," ",{display:"none"},{id:this.XLObj._id+"_contextMenuCell"});this._createMenu(n,this._rowCellMenuData,".e-spreadsheetcontentcontainer");n=t.buildTag("ul .e-spreadsheet"," ",{display:"none"},{id:this.XLObj._id+"_contextMenuColumnHeader"});this._createMenu(n,this._columnHeaderMenuData,".e-columnheader");n=t.buildTag("ul .e-spreadsheet"," ",{display:"none"},{id:this.XLObj._id+"_contextMenuRowHeader"});this._createMenu(n,this._rowHeaderMenuData,".e-rowheadercontent")},_initCMenuFooter:function(){var n=t.buildTag("ul .e-spreadsheet"," ",{display:"none"},{id:this.XLObj._id+"_contextMenuFooter"});this._createMenu(n,this._footerMenuData,".e-pagercontainer")},_createMenu:function(i,r,u){i.ejMenu({fields:{dataSource:r,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},menuType:t.MenuType.ContextMenu,openOnClick:!1,beforeOpen:n.proxy(this._beforeOpen,this),close:n.proxy(this._menuClose,this),click:n.proxy(this._menuClick,this),contextMenuTarget:u})},hideCMenu:function(){var t=this.XLObj;t.model.enableContextMenu&&(n("#"+t._id+"_contextMenuCell").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuColumnHeader").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuRowHeader").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuFooter").data("ejMenu").element.hide())},_beforeOpen:function(i){var r=this.XLObj,nt,b,st,rt,k,v,ht,d,ut,g,y;this._clrFltrEnable=!1;r.model.enableContextMenu||(i.cancel=!0);this.hideCMenu();var a=i.target,ct={target:a},u=n(a),h=r.getActiveSheetIndex(),ft=r.getSheet(h),lt=r.getActiveCellElem().length>0?r.getActiveCellElem():u,e=this._rowCellMenuData,f=n("#"+r._id+"_contextMenuCell").data("ejMenu"),o=n("#"+r._id+"_contextMenuFooter").data("ejMenu"),l=r.getActiveCell(h),et,c,s;if(!r._trigger("beforeOpen",ct))if((r.XLEdit._isEdit||r.model.allowComments&&r.XLComment._isCommentEdit||u.hasClass("e-filterspan")||i.events.which===1&&u.hasClass("e-hyperlinks")||u.parents("div").hasClass("e-vscroll")||u.parents("div").hasClass("e-hscroll")||n(a.parentNode).hasClass("e-pagercontainer")&&!u.hasClass("e-link")||!t.isNullOrUndefined(r.XLResize)&&r.XLResize._resizeStart||i.target.id.indexOf("Sheet_RenamePanel")>-1||u.parents().hasClass("e-grid")||u.hasClass("e-autofill"))&&(i.cancel=!0),u.hasClass("e-rowcell")||u.hasClass("e-hyperlinks")){var tt=[],ot=r._getJSSheetHeader(h).find("th"),at=r._getJSSheetRowHeader(h).find("td"),p=n("#"+r._id+"_contextMenuColumnHeader").data("ejMenu"),w=n("#"+r._id+"_contextMenuRowHeader").data("ejMenu"),it=r.XLEdit.getPropertyValueByElem(r.getCell(ft._activeCell.rowIndex,ft._activeCell.colIndex));if(this._isMenuOpened=!0,u.hasClass("e-hyperlinks")&&(u=u.parent("td"),a=u[0]),t.isNullOrUndefined(r.XLEdit.getPropertyValueByElem(u,"range")))if(n(ot[u.index()]).hasClass("e-colselected")||n(at[u.parent().index()]).hasClass("e-rowselected"))e=n(ot[u.index()]).hasClass("e-colselected")?this._columnHeaderMenuData:this._rowHeaderMenuData,JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&f.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"});else{if(JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&f.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"}),r.model.allowHyperlink?(this._enableMenuOpt(["CmHyperLink"]),st=r.XLEdit.getPropertyValue(u.parent().index(),a.cellIndex,"hyperlink",h),rt=["EditLink","OpenLink","RemoveLink"],t.isNullOrUndefined(st)?(this._disableMenuOpt(rt),this._enableMenuOpt(["HyperLink"])):(this._enableMenuOpt(rt),this._disableMenuOpt(["HyperLink"]))):this._disableMenuOpt(["CmHyperLink"]),r.model.allowFiltering){if(f.enableItemByID("Filter"),s=r.model.sheets[h].filterSettings.tableRange,k=r.getCell(l.rowIndex,l.colIndex,h)[0],s.length>0){for(et=k.className.indexOf("e-table")>-1?k.className[k.className.indexOf("e-table")+7]:-1,v=0,ht=s.length;v<ht;v++)if(s[v].tableID===parseInt(et)){c=v;break}!t.isNullOrUndefined(c)&&l.rowIndex<s[c].selectedRange.endRow+1&&l.rowIndex>s[c].selectedRange.startRow-2&&l.colIndex<s[c].multifilterIdx[s[c].multifilterIdx.length-1]+1&&l.colIndex>s[c].multifilterIdx[0]-1&&(nt=r.getCell(s[c].selectedRange.startRow-1,l.colIndex,h).find("span"),nt.length&&nt[0].className.indexOf("e-ssfiltered")>-1&&(f.enableItemByID("ClearFilter"),this._clrFltrEnable=!0))}this._clrFltrEnable||f.disableItemByID("ClearFilter")}else f.disableItemByID("Filter");r.model.allowInsert&&r.model.scrollSettings.allowScrolling?(w.enableItemByID("Insert"),p.enableItemByID("Insert"),f.enableItemByID("Insert"),r.XLRibbon._enableButtons(["inssbtn"],"ejSplitButton"),r.XLRibbon._enableButtons(["insbtn"],"ejButton")):r.model.allowInsert&&r.model.scrollSettings.allowScrolling||(w.disableItemByID("Insert"),p.disableItemByID("Insert"),f.disableItemByID("Insert"),r.XLRibbon._disableButtons(["inssbtn"],"ejSplitButton"),r.XLRibbon._disableButtons(["insbtn"],"ejButton"));r.model.allowDelete&&r.model.scrollSettings.allowScrolling?(w.enableItemByID("Delete"),p.enableItemByID("Delete"),f.enableItemByID("Delete"),r.XLRibbon._enableButtons(["delsbtn"],"ejSplitButton"),r.XLRibbon._enableButtons(["delbtn"],"ejButton")):r.model.allowDelete&&r.model.scrollSettings.allowScrolling||(w.disableItemByID("Delete"),p.disableItemByID("Delete"),f.disableItemByID("Delete"),r.XLRibbon._disableButtons(["delsbtn"],"ejSplitButton"),r.XLRibbon._disableButtons(["delbtn"],"ejButton"));r.model.allowInsert?o.enableItemByID("InsertSheet"):o.disableItemByID("InsertSheet");r.model.allowDelete?o.enableItemByID("DeleteSheet"):o.disableItemByID("DeleteSheet");r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem?this._enableMenuOpt(["Paste"]):this._disableMenuOpt(["Paste"]);r.model.allowSorting?this._enableMenuOpt(["Sort"]):this._disableMenuOpt(["Sort"]);r.model.allowClipboard?this._enableMenuOpt(["Cut","Copy"]):this._disableMenuOpt(["Cut","Copy"]);tt=!t.isNullOrUndefined(it)&&n.isNumeric(it)?[r._getLocStr("SortSmallesttoLargest"),r._getLocStr("SortLargesttoSmallest")]:t.isNullOrUndefined(Globalize.parseDate(it))?[r._getLocStr("SortAtoZ"),r._getLocStr("SortZtoA")]:[r._getLocStr("SortOldesttoNewest"),r._getLocStr("SortNewesttoOldest")];r.model.allowComments?(f.element.find("#ctxComment").hasClass("e-disable-item")&&this._enableMenuOpt(["ctxComment"]),d=r.getSheetElement(r.getActiveSheetIndex()).find(".e-selected"),ut=d.length>1?lt:u,ut.hasClass("e-commentcell")?(this._disableMenuOpt(["ctxInsrtCmnt"]),e["13"].text=r.XLEdit.getPropertyValueByElem(ut,"comment").isVisible?r._getLocStr("HideComment"):r._getLocStr("ShowHide"),this._enableMenuOpt(["ctxEditCmnt","ctxDeleteCmnt","ctxShwHdCmnt"])):(this._enableMenuOpt(["ctxInsrtCmnt"]),this._disableMenuOpt(["ctxEditCmnt","ctxDeleteCmnt","ctxShwHdCmnt"])),d.filter(a).length>0&&d.filter(".e-commentcell").length>0&&this._enableMenuOpt(["ctxDeleteCmnt"])):this._disableMenuOpt(["ctxComment"]);e["7"].text=tt[0];e["8"].text=tt[1];JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&f.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"})}else b=r.model.sheets[h].rangeSettings[r.XLEdit.getPropertyValueByElem(u,"range")],f.option("fields",{dataSource:b.contextMenuSettings.dataSource,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"}),f.option("width",b.contextMenuSettings.width),f.option("height",b.contextMenuSettings.height);r.XLRibbon._dirtySelect(r._getContent(r.getActiveSheetIndex()).find(".e-selected"))}else if(u.hasClass("e-ss-imgvisual")||u.hasClass("e-ss-object")||u.closest("div").hasClass("e-ss-object"))g=n.extend(!0,[],this._chartMenuData),this._isMenuOpened=!0,g=this.XLObj.model.showRibbon?this._chartMenuData:g.splice(0,2),e=r.XLShape._shapeType==="chart"?g:this._imgMenuData,JSON.stringify(e)!==JSON.stringify(i.model.fields.dataSource)&&f.option("fields",{dataSource:e,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"});else if(u.hasClass("e-link")){if(r._isSheetRename&&!r._updateSheetNames()){i.cancel=!0;return}this._isMenuOpened=!0;r._isCommentEdit&&r.XLComment._updateCurCmntVal();u.not("a.e-currentitem, a.e-PP, a.e-NP").hasClass("e-numericitem")&&r.gotoPage(u.data("index"));r._getSheetNames(!1).length>0?o.enableItemByID("UnhideSheet"):o.disableItemByID("UnhideSheet");r._getSheetNames(!0).length>1?(o.enableItemByID("DeleteSheet"),o.enableItemByID("HideSheet"),o.enableItemByID("MoveorCopy")):(o.disableItemByID("DeleteSheet"),o.disableItemByID("HideSheet"),o.disableItemByID("MoveorCopy"))}else(u.hasClass("e-headercelldiv")||u.hasClass("e-headercell")||u.hasClass("e-rowheader"))&&(y=u.hasClass("e-rowheader")?"contextMenuRowHeader":"contextMenuColumnHeader",r.model.allowClipboard?this._enableMenuOpt(["Cut","Copy"],y):this._disableMenuOpt(["Cut","Copy"],y),r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem?this._enableMenuOpt(["Paste"],y):this._disableMenuOpt(["Paste"],y),r.XLRibbon._dirtySelect(r._getContent(r.getActiveSheetIndex()).find(".e-selected")))},_menuClick:function(n){this.XLObj._trigger("contextMenuClick",n)||this._processCMenu(n.ID,n.events.element)},_menuClose:function(){this._isMenuOpened=!1},_processCMenu:function(t,i){var v,o,r=this.XLObj,e=r.getActiveSheetIndex(),h,c,u,f,l,a,s;switch(t){case"Cut":r.XLClipboard.cut();break;case"Copy":r.XLClipboard.copy();break;case"PasteSpecial":case"PasteValues":r.XLClipboard._isSpecial=!(t==="PasteValues");r.XLClipboard.paste();break;case"Insert":r._insDelStatus="insert";u=r._getJSSheetHeader(e).find(".e-colselected");f=r._getJSSheetRowHeader(e).find(".e-rowselected");u.length?r.insertEntireColumn({rowIndex:0,colIndex:u[0].cellIndex},{rowIndex:0,colIndex:u[u.length-1].cellIndex}):f.length?r.insertEntireRow({rowIndex:n(f[0]).parent().index(),colIndex:0},{rowIndex:n(f[f.length-1]).parent().index(),colIndex:0}):r._renderInsertDialog();break;case"Delete":u=n(r._getJSSheetHeader(e).find("tr")[0]).find(".e-colselected");f=n(r.getRows(e)[0]).find(".e-rowselected");i.parentElement.id.indexOf("ColumnHeader")>-1||u.length>0?r.deleteEntireColumn({rowIndex:0,colIndex:u[0].cellIndex},{rowIndex:0,colIndex:u[u.length-1].cellIndex},[]):i.parentElement.id.indexOf("RowHeader")>-1||f.length>0?r.deleteEntireRow({rowIndex:n(f[0]).parent().index(),colIndex:0},{rowIndex:n(f[f.length-1]).parent().index(),colIndex:0},[]):r._renderDeleteDialog();break;case"FilterSelected":r.XLFilter.filterByActiveCell();this._clrFltrEnable=!1;break;case"ClearFilter":h=r.getActiveCell(e);l=r.getCell(h.rowIndex,h.colIndex,e)[0].className;a=l.indexOf("e-table");a>-1?(c=r.model.sheets[e].columns[h.colIndex].field,r.XLFilter._clearFilterColumn(c,"","","","","",parseInt(l[a+7])),delete r._excelFilter._predicates[e][c]):r.XLFilter.clearFilter("apply");this._clrFltrEnable=!1;break;case"SortAtoZ":case"SortZtoA":case"SortSmallesttoLargest":case"SortLargesttoSmallest":case"SortOldesttoNewest":case"SortNewesttoOldest":case"PutCellColor":case"PutFontColor":r.model.allowSorting&&r.XLSort._sortHandler(t);break;case"ClearContents":s=r.model.sheets[e].selectedRange;r.clearContents(r._getAlphaRange(e,s[0],s[1],s[2],s[3]));break;case"InsertSheet":r.insertSheet();break;case"DeleteSheet":r.deleteSheet(e);break;case"RenameSheet":r._renameSheet();break;case"MoveorCopy":r._renderMoveCopyDlg();break;case"Hide":u=r._getJSSheetHeader(e).find(".e-colselected");f=r._getJSSheetRowHeader(e).find(".e-rowselected");u.length&&r._hideColumn(u[0].cellIndex,u[u.length-1].cellIndex);f.length&&r._hideRow(n(f[0]).parent().index(),n(f[f.length-1]).parent().index());break;case"Unhide":u=r._getJSSheetHeader(e).find(".e-colselected");f=r._getJSSheetRowHeader(e).find(".e-rowselected");u.length&&r._showColumn(u[0].cellIndex,u[u.length-1].cellIndex);f.length&&r._showRow(n(f[0]).parent().index(),n(f[f.length-1]).parent().index());break;case"HyperLink":case"EditLink":r._hlDlgOpen();break;case"RemoveLink":r._removeHyperlink();break;case"OpenLink":r._openLink();break;case"ctxInsrtCmnt":r.XLComment.setComment();break;case"ctxEditCmnt":r.XLComment.editComment();break;case"ctxDeleteCmnt":r.XLComment.deleteComment();break;case"ctxShwHdCmnt":r.XLComment.showHideComment();break;case"ChangePicture":r._uploadImage=!0;r.XLShape._changePicture=!0;r.element.find("#"+r._id+"_file .e-uploadinput").click();break;case"ChartType":n("#"+r._id+"_charttypedlg").ejDialog("open");break;case"SelectData":v=document.getElementById(r._id+"_chart").value;o=r.XLChart._getShapeObj(v,"chart");n("#"+r._id+"_crxaxis").val(o.xRange?r._getAlphaRange(e,o.xRange[0],o.xRange[1],o.xRange[2],o.xRange[3]):"");n("#"+r._id+"_cryaxis").val(o.yRange?r._getAlphaRange(e,o.yRange[0],o.yRange[1],o.yRange[2],o.yRange[3]):"");n("#"+r._id+"_crlaxis").val(o.lRange?r._getAlphaRange(e,o.lRange[0],o.lRange[1],o.lRange[2],o.lRange[3]):"");n("#"+r._id+"_chartrangedlg").ejDialog("open");break;case"HideSheet":r.hideSheet();break;case"UnhideSheet":r._renderUnhideDlg()}},_disableMenuOpt:function(t,i){for(var u=i||"contextMenuCell",f=n("#"+this.XLObj._id+"_"+u).data("ejMenu"),r=0,e=t.length;r<e;r++)f.disableItemByID(t[r])},_enableMenuOpt:function(t,i){for(var u=i||"contextMenuCell",f=n("#"+this.XLObj._id+"_"+u).data("ejMenu"),r=0,e=t.length;r<e;r++)f.enableItemByID(t[r])}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.sorting=function(n){this.XLObj=n;this._isSortByFilter=!1};t.spreadsheetFeatures.sorting.prototype={_sortHandler:function(i){var e,l,a,v,y,p,s,r=this.XLObj,w="",u={},b=r._formatRegx,h=r.getActiveSheetIndex(),f=r.getSheet(h),o,c;if(w=f.columns[f._activeCell.colIndex].field,this._isSortByFilter=!1,i!="PutCellColor"&&i!="PutFontColor"){if(!r.model.allowSorting||f._selectedCells.length==0)return;if(p=i==="SortZtoA"?t.sortOrder.Descending:t.sortOrder.Ascending,s=r._getTableID(r.getActiveCellElem()[0].className),s)u=f._tableManager[s].range.slice(0),u[0]++;else{if(u=f.selectedRange.slice(0),o=u[0],c=u[1],o===u[2])return;for(v=r.XLEdit.getPropertyValue(o,c),e=o+1;e<=u[2];e++)if(!r._isHiddenRow(e)){y=r.XLEdit.getPropertyValue(e,c);break}l=r.isNumber(v)?t.Spreadsheet.CellType.Number:t.Spreadsheet.CellType.String;a=r.isNumber(y)?t.Spreadsheet.CellType.Number:t.Spreadsheet.CellType.String;(l!=a||n(this.XLObj.getCell(u[0],u[1]))[0].className.indexOf("e-sswraptext")>-1)&&u[0]++}this.sortByRange(u,w,p)}else{var k,d=f._activeCell,g,nt=r.getCell(d.rowIndex,d.colIndex),tt=r.getSheet(h),it=tt._startCell,rt=tt._endCell;nt.get(0).className.match(b)!=null&&(g=r._getColorFromFormat(nt.get(0).className.match(b)[0]));k=r._getAlphaRange(h,it.rowIndex,it.colIndex,rt.rowIndex,rt.colIndex);this.sortByColor(i,g,k)}},sortByColor:function(n,i,r){var f=this.XLObj;if(f.model.allowSorting){var o=f.getActiveSheetIndex(),u={},e,s,c=f.getSheet(o),h;r=f.getRangeIndices(r);h=c.columns[r[1]].field;t.isNullOrUndefined(i)||(i=i.length===2&&n==="PutCellColor"?i[0]:i[1],n==="PutCellColor"?(u.operation="sortbgcolor",u.bgcolor=i):(u.operation="sortfgcolor",u.fgcolor=i),u.requestType=u.action="sortbycolor",u.sortColumn=h,u.selRange={startCell:{rowIndex:r[0],colIndex:r[1]},endCell:{rowIndex:r[2],colIndex:r[3]}},u.rangeData=f.getRangeDataAsObject(u.selRange.startCell,u.selRange.endCell,!0)[0],e=r[0],t.isNullOrUndefined(e)||(s=f.XLFilter._createSelection(o,e,r[0],r[1],[]).endRowIndex,e=n==="PutCellColor"||n==="PutFontColor"?e+1:e,u.range=f.model.sheets[o]._selectedRange={startRow:e,endRow:s,dataSourceIndexes:[]},f._processBindings(u)))}},_getSortColorRange:function(n){var r=this.XLObj,i=r.getCell(n.rowIndex,n.colIndex),u=!1,s,t,e=0,h=!1,f=n.rowIndex,o=n.colIndex;if(i.text().length<1){for(t=f;t<f+2;t++)if(i=r.getCell(t,o),i.is(":visible")&&i.text().length>0){u=!0;e=t;break}if(!u){for(t=f;t>f-2;t--)t>-1&&(i=r.getCell(t,o),i.text().length===0&&t>0&&(i=r.getCell(t-1,o),i.text().length==0&&(h=!0)));if(!h)for(t=f-2;t>0;t--)if(i=r.getCell(t,o),i.is(":visible")&&i.text().length===0){s=t+1;u=!0;e=s;break}}}else for(t=f;t>=0;t--){if(i=r.getCell(t,o),i.is(":visible")&&i.text().length===0){s=t+1;u=!0;e=s;break}u||t!=0||(e=t,u=!0)}if(u)return e;r._showAlertDlg("Alert","Alert",null,630)},sortByRange:function(n,i,r){var u=this.XLObj;if(u.model.allowSorting){var c,l=u.getActiveSheetIndex(),o=0,a=[],f={},v=[],e,y,s=u._getJSSheetHeader(l).find(".e-colselected").length,h;if(typeof n=="string"&&(n=u.getRangeIndices(n)),this._isSortByFilter&&s<1){for(h=this._isSortByFilter?n[0]-1:n[0],y=u._getAlphaRange(l,h,n[1],h+1,n[1]),e=u._getAlphaRangeCells(y).find(".e-filterspan"),c=e.length;o<c;)v.push({filterIcon:e.eq(o),colIndex:e.eq(o).parent().index(),rowIndex:e.eq(o).parents("tr").index()}),o++;e.length&&(n[0]=this._isSortByFilter?n[0]:n[0]+1)}a=u.getRangeDataAsObject({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]},!0)[0];f.requestType=t.Spreadsheet.Actions.Sorting;f.range=n;f.columnName=i;f.rangeData=a;f.action="sorting";f.sortDirection=r;f.filterIcon=v;f.isSortByFilter=this._isSortByFilter;f.colSelected=s;u._processBindings(f);s&&this._isSortByFilter&&u.XLFilter._changeSortIcon(u.getCell(n[0]-1,n[1]),r)}},_sortComplete:function(n){var t=this.XLObj,r=n.range,u=this._swapSortedDatas(n),e=u[1],i,f;for(t._isSort=!0,n.rangeData=u[0],t.XLComment.deleteComment(r,null,!0),t._isSort=!0,t._removeHyperlink(null,null,!0),t._isSort=!1,t.clearRangeData(r,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0),t.XLFormat.clearFormat(r,"format",!0),t.XLEdit.updateCellWithContainer(e,r,null,!0),i=0,f=n.filterIcon.length;i<f;i++)t.XLFilter._applyFilterIcon(t.getCell(n.filterIcon[i].rowIndex,n.filterIcon[i].colIndex),n.filterIcon[i].filterIcon);t._isSort=!1},_swapSortedDatas:function(t){var h,c,i,f=0,l=[],e=[],o=[],a=t.model.currentViewData,y=a.length,p=this.XLObj._generateColCount(t.columnName)-1,v,r=t.range,s=r[3]-r[1]+1,w=p-r[1],u=this.XLObj.getRangeData(r,!1,["value","value2","type","thousandSeparator","range","format","comment","hyperlink"],null,!1,!1,!0);for(n.extend(!0,l,u),e.push(l);f<y;){for(h=a[f][t.columnName],i=w,v=u.length;i<v;){if(u[i].value===h){c=this._getMinIdx(i,s);o=o.concat(u.splice(c,s));break}i+=s}f++}return e.push(o),e},_getMinIdx:function(n,t){var i,r;if(i=r=t,n<t)return 0;while(i<=n){if(r+=t,r>n)return i;i+=t}}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.dragAndDrop=function(n){this.XLObj=n;this._isDragAndDropStart=!1;this._dragAndDropCell={rowIndex:0,colIndex:0};this._isDragAndDropped=!1;this._allowDragAndDrop=!1};t.spreadsheetFeatures.dragAndDrop.prototype={moveRangeTo:function(t,i){var r=this.XLObj,f,o;if(r.model.allowDragAndDrop){f=r.getActiveSheetIndex();o=r.getSheet(f);t=r.swapRange(t);i=r.swapRange(i);var u={rowIndex:i[0],colIndex:i[1]},e={rowIndex:i[2],colIndex:i[3]},s=r.getRangeData(t),h=r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(t),l={sheetIndex:f,reqType:"reorder-cells",sourceData:n.extend(!0,[],s),sourceRange:t,destinationRange:i,sourceFormat:h,destinationFormat:r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(i),destinationData:r.getRangeData(i)},c=r.model.allowFiltering&&r.XLFilter._checkFilteredCells(f);r.model.allowComments&&r.XLComment.deleteComment();c.isApplied?r.XLFilter._moveFilteredCells(f,c):(r.clearRangeData(t),r.clearRangeData(i),r.model.allowCellFormatting&&r.XLFormat.clearFormat(t),r.updateData(s,i),r.model.allowCellFormatting&&r.XLFormat.updateFormat(h,i));r.setActiveCell(u.rowIndex,u.colIndex);u.rowIndex===0&&e.rowIndex===o.rowCount-1?r.XLSelection.selectColumns(u.colIndex,e.colIndex):u.colIndex===0&&e.colIndex===o.colCount-1?r.XLSelection.selectRows(u.rowIndex,e.rowIndex):r.XLSelection.selectRange(u,e);r._isUndoRedo||r._isFAT||r._completeAction(l)}},_dMouseHover:function(n){var i=this.XLObj,f,e,o,s,t,h,r,u,c=n.target,l=c.className;if(l.indexOf("e-ddcell")>-1&&(t=n.target.getBoundingClientRect(),h=i._setXY(n),r=h[0],u=h[1],f=r-i.getFocusLeftElem().offset().left,f=f>=0&&f<=5,e=u-i.getFocusTopElem().offset().top,e=e>=0&&e<=5,o=i.getFocusRightElem().offset().left-r,o=o>=0&&o<=5,s=i.getFocusBottomElem().offset().top-u,s=s>=0&&s<=5,f&&r<=t.left+5&&r>=t.left||e&&u<=t.top+5&&u>=t.top||o&&r>=t.right-5&&r<=t.right||s&&u>=t.bottom-5&&u<=t.bottom)){i.addClass(c,"e-cursormove");this._isDragAndDropStart=!0;return}this._isDragAndDropStart&&(i._getContent(i.getActiveSheetIndex()).find(".e-cursormove").removeClass("e-cursormove"),this._isDragAndDropStart=!1)},_dMouseDown:function(n){var t=this.XLObj,u=t.getActiveSheetIndex(),i=t.getSheet(u),r;(n.preventDefault(),n.stopImmediatePropagation(),r=t.swapRange([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]),this._dragAndDropCell={rowIndex:n.target.parentNode.rowIndex,colIndex:n.target.cellIndex},t._dStartCell={rowIndex:r[0],colIndex:r[1]},t._dEndCell={rowIndex:r[2],colIndex:r[3]},t._trigger("dragStart",{sheetIndex:u,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}}))||(this._allowDragAndDrop=!0)},_dMouseMove:function(n){if(this._allowDragAndDrop){var r={rowIndex:n.target.parentNode.rowIndex,colIndex:n.target.cellIndex},t=this.XLObj,u=t.getActiveSheetIndex(),i=t.getSheet(u);if(t._trigger("drag",{sheetIndex:u,target:n.target,currentCell:r,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}}))return;t.XLSelection._focusBorder(i._startCell,i._endCell,t._thinBorder);this._updateDCells(r);t.XLSelection._focusRange(t._dStartCell,t._dEndCell,t._autofillBorder)}else this._dMouseHover(n)},_dMouseUp:function(n){if(this._isDragAndDropped){var t=this.XLObj,u=t.getActiveSheetIndex(),i=t.getSheet(u),f=!0,r=!1,e=[t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex],o={sheetIndex:u,preventAlert:!1,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}};t._isUniqueRange(i.selectedRange,t.swapRange(e))?this._preventDrop(i):(r=t._trigger("beforeDrop",o),o.preventAlert||r||!t._rangeHasData(e)||(f=confirm(t._getLocStr("DropAlert"))),!r&&f?(this.moveRangeTo([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],[t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex]),i._startCell=t._dStartCell,i._endCell=t._dEndCell):this._preventDrop(i),!r&&f&&t._trigger("drop",{sheetIndex:u,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}}));t.XLSelection._clearBorder(t._arrayAsString(t._thinBorder));t.model.allowAutoFill&&t.XLDragFill.positionAutoFillElement()}this._allowDragAndDrop=this._isDragAndDropStart=this._isDragAndDropped=!1},_preventDrop:function(n){var t=this.XLObj;t.XLSelection._focusRange(n._startCell,n._endCell,t._selectionBorder);t._dStartCell=n._startCell;t._dEndCell=n._endCell},_updateDCells:function(n){var t=this.XLObj,r,u,f,e,i;r=t.getActiveSheetIndex();u=t.getSheet(r);i=u._selectedCells.length;f=t._getJSSheetHeader(r).find(".e-headercontent th");e=t._getJSSheetRowHeaderContent(r).find("td");f[u._startCell.colIndex].className.indexOf("e-colselected")===-1&&(n.rowIndex<this._dragAndDropCell.rowIndex&&t._dStartCell.rowIndex?(t._dStartCell.rowIndex=t._dStartCell.rowIndex-(this._dragAndDropCell.rowIndex-n.rowIndex),t._dEndCell.rowIndex=i===1?t._dStartCell.rowIndex:t._dEndCell.rowIndex-(this._dragAndDropCell.rowIndex-n.rowIndex)):n.rowIndex>this._dragAndDropCell.rowIndex&&(t._dStartCell.rowIndex=t._dStartCell.rowIndex+(n.rowIndex-this._dragAndDropCell.rowIndex),t._dEndCell.rowIndex=i===1?t._dStartCell.rowIndex:t._dEndCell.rowIndex+(n.rowIndex-this._dragAndDropCell.rowIndex)));e[u._startCell.rowIndex].className.indexOf("e-rowselected")===-1&&(n.colIndex<this._dragAndDropCell.colIndex&&t._dStartCell.colIndex?(t._dStartCell.colIndex=t._dStartCell.colIndex-(this._dragAndDropCell.colIndex-n.colIndex),t._dEndCell.colIndex=i===1?t._dStartCell.colIndex:t._dEndCell.colIndex-(this._dragAndDropCell.colIndex-n.colIndex)):n.colIndex>this._dragAndDropCell.colIndex&&(t._dStartCell.colIndex=t._dStartCell.colIndex+(n.colIndex-this._dragAndDropCell.colIndex),t._dEndCell.colIndex=i===1?t._dStartCell.colIndex:t._dEndCell.colIndex+(n.colIndex-this._dragAndDropCell.colIndex)));this._dragAndDropCell=n;this._isDragAndDropped=!0},_initDragAndDropRange:function(n){var t=0,u="e-ddcell",r=this.XLObj;n=r.swapRange(n);for(var f=r.getRange(n[0],n[1],n[2],n[3]),e=n[2]-n[0]+1,i=n[3]-n[1]+1;t<i;)r.addClass(f[t],u),t++;for(t=i-1;t<e*i;)r.addClass(f[t],u),t+=i;for(t=(e-1)*i;t<e*i;)r.addClass(f[t],u),t++;for(t=0;t<e*i;)r.addClass(f[t],u),t=t+i}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.exporting=function(n){this.XLObj=n};t.spreadsheetFeatures.exporting.prototype={"export":function(i){var o=this.XLObj,u,c,r,f,e,s,h;o.model.exportSettings.allowExporting&&(u=o.model.exportSettings,s=i===t.Spreadsheet.exportType.Excel?u.excelUrl:u.csvUrl,u.allowExporting&&!o.isUndefined(s))&&(c={action:s,method:"post"},r=t.buildTag("form","",null,c),h=this.getExportProps(),f={name:"sheetData",type:"hidden",value:h.data},e=t.buildTag("input","",null,f),r.append(e),f={name:"sheetModel",type:"hidden",value:h.model},e=t.buildTag("input","",null,f),r.append(e),n("body").append(r),r.submit())},_dropElements:function(n){var r=n.sheets,f=["_spreadSheetPager","datasource"],u,t,i;for(n.undoCollection=[];u in r;)for(i=r[u];t in i;)f.indexOf(t)>-1&&(i[t]=null);return n},getExportProps:function(){var e=this.XLObj,i,f,r,h,c,o,s,u,l=n.extend(!0,{},e._dataContainer),t={};for(e._refreshHashCode(l.hashCode),n.extend(!0,t,e.model),i=1;i<t.sheets.length;i++)for(t.sheets[i].chart=[],n.extend(!0,t.sheets[i].chart,t.sheets[i]._shapeMngr.chart),t.sheets[i]._shapeMngr.chart=[],f=0,h=t.sheets[i].chart.length;f<h;f++)if(o=n("#"+t.sheets[i].chart[f].id).data("ejChart"),o){for(s=n.extend(!0,{},o.model),u=s.series,r=0,c=u.length;r<c;r++)delete u[r].dataSource,delete u[r].query,u[r].fill=jQuery.type(u[r].fill)=="array"?u[r].fill[0].color:u[r].fill;t.sheets[i]._shapeMngr.chart.push(s)}return t.sheets.shift(),{model:JSON.stringify(this._dropElements(t)),data:JSON.stringify(l)}}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.findnreplace=function(n){this.XLObj=n;this._findCount=0;this.caseSen={"true":function(n){return n.toString()},"false":function(n){return n.toString().toLowerCase()}};this.isEMatch={"true":function(n,t){return n==t},"false":function(n,t){return n.indexOf(t)>-1}}};t.spreadsheetFeatures.findnreplace.prototype={replaceAllBySheet:function(n,t,i,r){this.XLObj.model.allowSearching&&this._replaceAllData(n,t,i,r,"value","sheet")},replaceAllByBook:function(n,t,i,r){this.XLObj.model.allowSearching&&this._replaceAllData(n,t,i,r,"value","workbook")},_findNext:function(n,t,i,r,u,f,e){var l=this.XLObj,h={sheetIndex:t,value:n,isCaseSensitive:i,isEntireMatch:r,searchBy:e,mode:f,findType:u,reqType:"findNext"};if(l._trigActionBegin(h))return!0;n=h.value;t=h.sheetIndex;i=h.isCaseSensitive;r=h.isEntireMatch;u=h.findType;f=h.mode;e=h.searchBy;var w=t?t:l.model.activeSheetIndex,tt=l.getSheet(w),a=tt._activeCell.rowIndex,v=tt._activeCell.colIndex,p=tt._usedRange,b=p.rowIndex+1,k=p.colIndex+1,d,o,s,y,g,c=e==="rows",nt,it;if(c||(nt=a,a=v,v=nt,nt=b,b=k,k=nt),f==="sheet"){for(o=a;o<b;o++)for(o!==a&&(v=0),s=v;s<k;s++)if(d=this._compareValues(c?o:s,c?s:o,w,n,i,r,u),d&&!(o===a&&s===v))return this._updateSelection(c?o:s,c?s:o),this._findCount++,h={reqType:"findNext",activeCell:l.getActiveCellElem()},l._trigActionComplete(h),!0}else for(y=w,it=l.model.sheetCount;y<=it;y++)for(p=l.model.sheets[y]._usedRange,y!==w&&(v=0,a=0,b=c?p.rowIndex:p.colIndex,k=c?p.colIndex:p.rowIndex),o=a;o<b+1;o++)for(o!==a&&(v=0),s=v;s<k+1;s++)if(d=this._compareValues(c?o:s,c?s:o,y,n,i,r,u),d&&!(y===w&&o===a&&s===v))return this._updateSelection(c?o:s,c?s:o,y),this._findCount++,h={reqType:"findNext",activeCell:l.getActiveCellElem()},l._trigActionComplete(h),!0;return this._findCount?!1:(g=f==="sheet"?w:1,this._updateSelection(0,0,g),this._findCount++,this._compareValues(0,0,g,n,i,r,u)?!0:this._findNext(n,g,i,r,u,f,e))},_findPrev:function(n,t,i,r,u,f,e){var c=this.XLObj,h={sheetIndex:t,value:n,isCaseSensitive:i,isEntireMatch:r,searchBy:e,mode:f,findType:u,reqType:"findPrevious"};if(c._trigActionBegin(h))return!0;n=h.value;t=h.sheetIndex;i=h.isCaseSensitive;r=h.isEntireMatch;u=h.findType;f=h.mode;e=h.searchBy;var k=t?t:c.model.activeSheetIndex,tt=c.getSheet(k),a=tt._activeCell.rowIndex,v=tt._activeCell.colIndex,w=tt._usedRange,b=w.rowIndex+1,y=w.colIndex+1,g,o,s,p,d,l=e==="rows",nt;if(l||(nt=a,a=v,v=nt,nt=b,b=y,y=nt),f==="sheet"){for(o=a;o>=0;o--)for(o!==a&&(v=y),s=v;s>=0;s--)if(g=this._compareValues(l?o:s,l?s:o,k,n,i,r,u),g&&!(o===a&&s===v))return this._updateSelection(l?o:s,l?s:o),this._findCount++,h={reqType:"findPrevious",activeCell:c.getActiveCellElem()},c._trigActionComplete(h),!0}else for(p=k;p>=1;p--)for(w=c.model.sheets[p]._usedRange,p!==k&&(b=l?w.rowIndex:w.colIndex,y=l?w.colIndex:w.rowIndex,v=y,a=b),o=a;o>=0;o--)for(o!==a&&(v=y+1),s=v;s>=0;s--)if(g=this._compareValues(l?o:s,l?s:o,p,n,i,r,u),g&&!(p===k&&o===a&&s===v))return this._updateSelection(l?o:s,l?s:o,p),this._findCount++,h={reqType:"findPrevious",activeCell:c.getActiveCellElem()},c._trigActionComplete(h),!0;return this._findCount?!1:(d=f==="sheet"?k:c.model.sheetCount,b=c.model.sheets[d]._usedRange.rowIndex,y=c.model.sheets[d]._usedRange.colIndex,this._updateSelection(b,y,d),this._findCount++,this._compareValues(b,y,d,n,i,r,u)?!0:this._findPrev(n,d,i,r,u,f,e))},_compareValues:function(n,i,r,u,f,e,o){var s=this.XLObj,c=s.getCell(n,i,r),h=s.XLEdit.getPropertyValueByElem(c,null,r)?s.XLEdit.getPropertyValueByElem(c,null,r).toString():"",l=!t.isNullOrUndefined(h)&&h.charAt(0)==="="&&!t.isNullOrUndefined(s.XLEdit.getPropertyValueByElem(c,"value2",r))&&typeof s.XLEdit.getPropertyValueByElem(c,"value2",r)=="string";return h=o==="value"?h&&!l?this.caseSen[f](h):"":o==="formula"?l?this.caseSen[f](h):"":s.XLEdit.getPropertyValueByElem(c,"comment",r)?this.caseSen[f](s.XLEdit.getPropertyValueByElem(c,"comment",r).value):"",u=this.caseSen[f](u),this.isEMatch[e](h,u)},_replace:function(n,t,i,r,u){var f=this.XLObj,o=f.getActiveSheetIndex(),e=f.XLEdit.getPropertyValueByElem(n,null,t)?f.XLEdit.getPropertyValueByElem(n,null,t).toString():"",s=new RegExp(i.toString(),"ig"),h=e!==""&&i!==""?u?e.replace(i,r):e.replace(s,r):r;t===o||f.gotoPage(t);f.XLEdit.updateCellValue(n,h);n.hasClass("e-commentcell")&&(n.removeClass("e-commentcell"),f.XLComment.setComment(n,null,!1))},_replaceData:function(n,t,i,r,u,f,e,o,s){var a,c,l=this.XLObj,h=i?i:l.model.activeSheetIndex,p=l.getSheet(h),v=p._activeCell.rowIndex,y=p._activeCell.colIndex,w;this._compareValues(v,y,h,n,r,u,f)?(c=l.getCell(v,y,h),a={sheetIndex:h,reqType:"find-replace",operation:"replace",rowIndex:c.parent().index(),colIndex:c.index(),sIndex:i},a.prevData={value:c.text()},this._replace(c,i,n,t,r),a.newData={value:c.text()},this._findCount=0,w=e==="up"?this._findPrev(n,h,r,u,f,o,s):this._findNext(n,h,r,u,f,o,s),w||this._updateSelection(v,y,h),l._isUndoRedo||l._completeAction(a)):l._showAlertDlg("Alert","ReplaceNotFound","")},_replaceAllData:function(t,i,r,u,f,e){var k,o,a,d=[],s=this.XLObj,v=s.model.activeSheetIndex,g=s.getSheet(v),y=g._usedRange,tt=g._activeCell.rowIndex,it=g._activeCell.colIndex,h,c,l,w,b,nt=0,p;if(k={sheetIndex:v,reqType:"find-replace",operation:"replaceAll"},e==="sheet")for(h=0,w=y.rowIndex+1;h<w;h++)for(c=0,b=y.colIndex+1;c<b;c++)this._compareValues(h,c,v,t,r,u,f)&&(o=s.getCell(h,c,v),a={rowIndex:o.parent().index(),colIndex:o.index(),prevData:{value:o.text()},sheetIndex:v},this._replace(o,v,t,i,r),nt++,a.newData={value:o.text()},d.push(a));else for(l=1;l<=s.model.sheetCount;l++)for(y=s.model.sheets[l]._usedRange,h=0,w=y.rowIndex+1;h<w;h++)for(c=0,b=y.colIndex+1;c<b;c++)this._compareValues(h,c,l,t,r,u,f)&&(o=s.getCell(h,c,l),a={rowIndex:o.parent().index(),colIndex:o.index(),prevData:{value:o.text()},sheetIndex:l},this._replace(o,l,t,i,r),nt++,a.newData={value:o.text()},d.push(a));k.selCells=d;this._updateSelection(tt,it);s._isUndoRedo||s._completeAction(k);s.element.ejWaitingPopup("hide");p=s._getLocStr("ReplaceData").split("/");p="T-"+p[0]+nt+" "+p[1];n("#"+s._id+"_FRDialog").ejDialog("close");s._showAlertDlg("Alert",p,"",325)},_updateSelection:function(n,t,i){var u={rowIndex:n,colIndex:t},r=this.XLObj,f=r.getActiveSheetIndex(),e=r.getSheet(f);i||(i=f);i&&i!==f&&r.gotoPage(i,!1);r.getSheetElement(f).find(".e-selected:visible").length<2?(r.setActiveCell(u.rowIndex,u.colIndex,i),r.XLSelection.selectRange(u,u),e._startCell=u,e._endCell=u):r.XLCellNav._updateActiveCell(n,t);r.model.scrollSettings.allowScrolling&&r.XLScroll._scrollSelectedPosition(i,r.getActiveCell(i));r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement()},_fRKeyDownHandler:function(t){var i=this.XLObj;t.ctrlKey&&(t.keyCode===70?(t.preventDefault(),n("#"+i._id+"_FRDialog").ejDialog("open"),n("#"+i._id+"_FRDialog_FPDlgTab").ejTab("option","selectedItemIndex",0)):t.keyCode===72?(t.preventDefault(),n("#"+i._id+"_FRDialog").ejDialog("open"),n("#"+i._id+"_FRDialog_FPDlgTab").ejTab("option","selectedItemIndex",1)):t.keyCode===71&&(t.preventDefault(),n("#"+i._id+"_GoDialog").ejDialog("open"),n("#"+i._id+"_GoToDlgTab").ejTab("option","selectedItemIndex",0)))},_getSelRangeDetails:function(n){var t=n[n.length-1].rowIndex-n[0].rowIndex,i=n[n.length-1].colIndex-n[0].colIndex,r=n[0].rowIndex,u=n[0].colIndex;return[t,i,r,u]},_applyGoToRule:function(n,t,i,r,u){var e=this.XLObj,o,f;e.element.ejWaitingPopup("show");switch(n){case"blanks":this._applyGotoBlanks();break;case"formulas":this._applyGotoFormulas(t,i,r,u);break;case"comments":this._applyGotoComments();break;case"datavalidation":this._applyGotoValidation();break;case"cformat":this._applyGotoCFormat();break;case"lastcell":o=e.getActiveSheetIndex();f=e.model.sheets[o]._usedRange;e.XLSelection.selectRange({rowIndex:f.rowIndex,colIndex:f.colIndex},{rowIndex:f.rowIndex,colIndex:f.colIndex});this._updateSelection(f.rowIndex,f.colIndex,o);break;case"constants":this._applyGotoConstants(t,i,r,u);break;case"rowdiff":this._applyGotoRowDiff();break;case"coldiff":this._applyGotoColDiff()}e.element.ejWaitingPopup("hide")},_applyGotoBlanks:function(){var t,i,r,s=[],u,n=this.XLObj,f=n.getActiveSheetIndex(),h=n.model.sheets[f]._usedRange,c,l=h.rowIndex,a=h.colIndex,v=n.getSheet(f)._selectedCells,e=0,o=0,y={sheetIndex:f,reqType:"find-replace",operation:"blanks"};for(v.length>1&&(u=this._getSelRangeDetails(v),l=u[0],a=u[1],e=u[2],o=u[3]),t=0;t<=l;t++)for(i=0;i<=a;i++)r=n.getCell(t+e,i+o,f),c=n.XLEdit.getPropertyValueByElem(r)?n.XLEdit.getPropertyValueByElem(r).toString():"",c.length?r.removeClass("e-selected"):(r.addClass("e-selected"),s.push({rowIndex:t+e,colIndex:i+o,isApply:!0}));y.selCells=s;n._isUndoRedo||n._completeAction(y)},_applyGotoComments:function(){var i,r,f,h=[],u,n=this.XLObj,e=n.getActiveSheetIndex(),c=n.model.sheets[e]._usedRange,l,a=c.rowIndex,v=c.colIndex,y=n.getSheet(e)._selectedCells,o=0,s=0,p={sheetIndex:e,reqType:"find-replace",operation:"comments"};for(y.length>1&&(u=this._getSelRangeDetails(y),a=u[0],v=u[1],o=u[2],s=u[3]),i=0;i<=a;i++)for(r=0;r<=v;r++)f=n.getCell(i+o,r+s,e),l=n.XLEdit.getPropertyValueByElem(f,"comment"),t.isNullOrUndefined(l)?f.removeClass("e-selected"):(f.addClass("e-selected"),h.push({rowIndex:i+o,colIndex:r+s,isApply:!0}));p.selCells=h;n._isUndoRedo||n._completeAction(p)},_applyGotoFormulas:function(i,r,u,f){var h,c,s,p=[],l,o=this.XLObj,a=o.getActiveSheetIndex(),w,e,b,k=o.model.sheets[a]._usedRange,d=k.rowIndex,g=k.colIndex,nt=o.getSheet(a)._selectedCells,v=0,y=0,tt={sheetIndex:a,reqType:"find-replace",operation:"formulas"};for(nt.length>1&&(l=this._getSelRangeDetails(nt),d=l[0],g=l[1],v=l[2],y=l[3]),h=0;h<=d;h++)for(c=0;c<=g;c++)s=o.getCell(h+v,c+y,a),w=t.isNullOrUndefined(o.XLEdit.getPropertyValueByElem(s))?"":o.XLEdit.getPropertyValueByElem(s).toString(),e=t.isNullOrUndefined(o.XLEdit.getPropertyValueByElem(s,"value2"))?"":o.XLEdit.getPropertyValueByElem(s,"value2").toString(),b=w.charAt(0)==="="&&typeof e=="string",b&&(i&&n.isNumeric(e)||r&&!(e.toLowerCase()==="true"||e.toLowerCase()==="false")&&!n.isNumeric(e)&&!(e.length!==0&&e.indexOf("#")===0&&e.lastIndexOf("?")===e.length-1&&e.length>0)||u&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")||f&&e.length!==0&&o._sheets[a]._calcEngine.getErrorStrings().indexOf("#VALUE!")>-1)?(s.addClass("e-selected"),p.push({rowIndex:h+v,colIndex:c+y,isApply:!0})):s.removeClass("e-selected");tt.selCells=p;o._isUndoRedo||o._completeAction(tt)},_applyGotoValidation:function(){var i,r,f,h=[],u,n=this.XLObj,e=n.getActiveSheetIndex(),c=n.model.sheets[e]._usedRange,l,a=c.rowIndex,v=c.colIndex,y=n.getSheet(e)._selectedCells,o=0,s=0,p={sheetIndex:e,reqType:"find-replace",operation:"validations"};for(y.length>1&&(u=this._getSelRangeDetails(y),a=u[0],v=u[1],o=u[2],s=u[3]),i=0;i<=a;i++)for(r=0;r<=v;r++)f=n.getCell(i+o,r+s,e),l=n.XLEdit.getPropertyValueByElem(f,"rule"),t.isNullOrUndefined(l)?f.removeClass("e-selected"):(f.addClass("e-selected"),h.push({rowIndex:i+o,colIndex:r+s,isApply:!0}));p.selCells=h;n._isUndoRedo||n._completeAction(p)},_applyGotoCFormat:function(){var i,r,f,c=[],u,n=this.XLObj,e=n.getActiveSheetIndex(),l=n.model.sheets[e]._usedRange,o,a=l.rowIndex,v=l.colIndex,y=n.getSheet(e)._selectedCells,s=0,h=0,p={sheetIndex:e,reqType:"find-replace",operation:"conditions"};for(y.length>1&&(u=this._getSelRangeDetails(y),a=u[0],v=u[1],s=u[2],h=u[3]),i=0;i<=a;i++)for(r=0;r<=v;r++)f=n.getCell(i+s,r+h,e),o=n.XLEdit.getPropertyValueByElem(f,"cFormatRule"),!t.isNullOrUndefined(o)&&o.length?(f.addClass("e-selected"),c.push({rowIndex:i+s,colIndex:r+h,isApply:!0})):f.removeClass("e-selected");p.selCells=c;n._isUndoRedo||n._completeAction(p)},_applyGotoConstants:function(i,r,u,f){var c,l,s,nt=[],w,a,o=this.XLObj,v=o.getActiveSheetIndex(),e,h,b=o.model.sheets[v]._usedRange,k=b.rowIndex,d=b.colIndex,g=o.getSheet(v)._selectedCells,y=0,p=0;for(g.length>1&&(a=this._getSelRangeDetails(g),k=a[0],d=a[1],y=a[2],p=a[3]),c=0;c<=k;c++)for(l=0;l<=d;l++)s=o.getCell(c+y,l+p,v),e=t.isNullOrUndefined(o.XLEdit.getPropertyValueByElem(s))?"":o.XLEdit.getPropertyValueByElem(s).toString(),h=t.isNullOrUndefined(o.XLEdit.getPropertyValueByElem(s,"value2"))?"":o.XLEdit.getPropertyValueByElem(s,"value2").toString(),w=e.charAt(0)==="="&&typeof h=="string",!w&&(i&&n.isNumeric(e)||r&&!(e.toLowerCase()==="true"||e.toLowerCase()==="false")&&!n.isNumeric(e)&&e.length>0||u&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")||f&&h.length!==0&&h.indexOf("#")===0&&h.lastIndexOf("?")===h.length-1)?(s.addClass("e-selected"),nt.push({rowIndex:c+y,colIndex:l+p,isApply:!0})):s.removeClass("e-selected")},_applyGotoColDiff:function(){var t,r,u,s=[],f,n=this.XLObj,i=n.getActiveSheetIndex(),h=n.model.sheets[i]._usedRange,c,l=h.rowIndex,a=h.colIndex,v=n.getSheet(i)._selectedCells,e=0,o=0,y={sheetIndex:i,reqType:"find-replace",operation:"coldiff"},p;if(v.length>1)for(f=this._getSelRangeDetails(v),l=f[0],a=f[1],e=f[2],o=f[3],t=0;t<=a;t++)for(p=n.XLEdit.getPropertyValueByElem(n.getCell(e,t+o,i))?n.XLEdit.getPropertyValueByElem(n.getCell(e,t+o,i)).toString():"",r=0;r<=l;r++)u=n.getCell(r+e,t+o,i),c=n.XLEdit.getPropertyValueByElem(u)?n.XLEdit.getPropertyValueByElem(u).toString():"",c===p?u.removeClass("e-selected"):(u.addClass("e-selected"),s.push({rowIndex:r+e,colIndex:t+o,isApply:!1}));y.selCells=s;n._isUndoRedo||n._completeAction(y)},_applyGotoRowDiff:function(){var t,r,u,s=[],f,n=this.XLObj,i=n.getActiveSheetIndex(),h=n.model.sheets[i]._usedRange,c,l=h.rowIndex,a=h.colIndex,v=n.getSheet(i)._selectedCells,e=0,o=0,y,p={sheetIndex:i,reqType:"find-replace",operation:"rowdiff"};if(v.length>1)for(f=this._getSelRangeDetails(v),l=f[0],a=f[1],e=f[2],o=f[3],t=0;t<=l;t++)for(y=n.XLEdit.getPropertyValueByElem(n.getCell(t+e,o,i))?n.XLEdit.getPropertyValueByElem(n.getCell(t+e,o,i)).toString():"",r=0;r<=a;r++)u=n.getCell(t+e,r+o,i),c=n.XLEdit.getPropertyValueByElem(u)?n.XLEdit.getPropertyValueByElem(u).toString():"",c===y?u.removeClass("e-selected"):(u.addClass("e-selected"),s.push({rowIndex:t+e,colIndex:r+o,isApply:!1}));p.selCells=s;n._isUndoRedo||n._completeAction(p)}}}(jQuery,Syncfusion);$.fn.setInputPos=function(n,t){return t||(t=n),$(this).is(":visible")?this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(n,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",n);i.select()}}):void 0},function($,ej){ej.spreadsheetFeatures=ej.spreadsheetFeatures||{};ej.spreadsheetFeatures.shape=function(n){this.XLObj=n;this._imgX=0;this._imgY=0;this._imgOffsetleft=0;this._imgOffsetTop=0;this._shapeType="Img";this._shapeROStart=!1;this._shapeRSStart=!1;this._imgRSWStart=!1;this._imgRSEStart=!1;this._imgRSNStart=!1;this._imgRSSStart=!1;this._changePicture=!1;this._picCellIdx={};this._insertPic=!1};ej.spreadsheetFeatures.shape.prototype={_insertPicture:function(n){var t=this.XLObj,v=ej.browserInfo(),r=v.name==="msie"&&parseInt(v.version)<10?n.responseText:n.xhr.response,s,h,c,i,a,u,f,l,e;if(r.startsWith("Invalid"))t._showAlertDlg("Alert","ImageValAlert");else if(s=t.getActiveSheetIndex(),this._changePicture)i=t.element.find(".e-ss-activeimg").get(0),h=i.offsetLeft,c=i.offsetTop,e=this._getCellIndexFromOffset(c,h),u=t.getSheet(s)._shapeMngr,$(i).css("background-image","url('"+r+"')"),u.picture.some(function(n,t){if(i.id===n.id)return l=t,!0}),f=u.picture[l],a={sheetIndex:s,reqType:"shape",shapeType:"picture",action:"changepic",id:$(i).attr("id"),cell:e,prev:{img:u.sharedPics[f.data],data:f.data,pcIdx:l},cur:{img:r,pcIdx:l}},u.sharedPics.indexOf(r)===-1&&u.sharedPics.push(r),f.data=u.sharedPics.indexOf(r),a.cur.data=f.data,this._changePicture=!1,t.setSheetFocus(),t._completeAction(a);else{var o=t.getActiveCellElem()[0],y=t.model.pictureSettings,p=y.height,w=y.width;ej.isNullOrUndefined(o)&&(i=t.element.find(".e-ss-activeimg").get(0),e=this._getCellIndexFromOffset(i.offsetTop,i.offsetLeft),o=t.getCell(e.rowIndex,e.colIndex)[0]);h=o.offsetLeft;c=o.offsetTop;this._insertPic=!0;this._createPicture(s,o,r,c,h,w,p)}},setPicture:function(n,t,i,r,u,f){var e=this.XLObj;if(e.model.pictureSettings.allowPictures){var h=e.getActiveSheetIndex(),n=e.getRangeIndices(n),o=e.getCell(n[0],n[1])[0],s=e.model.pictureSettings;r=r?r:s.height;i=i?i:s.width;this._createPicture(h,o,t,u?u:o.offsetTop,f?f:o.offsetLeft,i,r)}},_createPicture:function(n,t,i,r,u,f,e,o,s,h,c){var l,a,y,p,b,k,v,w;(s=s?s:"transparent",h=h?h:"solid",c=c?c:"1px",l=this.XLObj,a={sheetIndex:n,targetCell:t,top:r,left:u,width:f,height:e,bcolor:s,bstyle:h,bwidth:c,reqType:"picture",add:"add"},l._trigActionBegin(a))||(r=a.top,u=a.left,f=a.width,e=a.height,o=ej.isNullOrUndefined(o)?l.model.allowCharts&&l.XLChart._shapeCnt:o,b=$(t).parent().index(),k=t.cellIndex,l._getContent(n).find(".e-content").append(ej.buildTag("div.e-ss-object","","",{id:l._id+"_picture"+o})),y=$("#"+l._id+"_picture"+o),y.css({"background-image":"url('"+i+"')",height:e,width:f,left:u,top:r}),v=c+" "+h+" "+s,w=this._getImgBorderHashCode({"border-color":s,"border-style":h,"border-width":c}),l.model.allowCellFormatting&&l.XLFormat._writeCssRules(w,l.XLFormat._getCssPropertyAsString({border:{left:v,right:v,top:v,bottom:v}})),y.addClass(w),!l._isUndoRedo&&l.model.allowCharts&&l.XLChart._shapeCnt++,l.model.sheets[n]._importRendered?l.model.sheets[n]._shapeMngr.picture[o].id=l._id+"_picture"+o:this._updateShapeMngr(t,{picture:{data:i,id:l._id+"_picture"+o,height:e,width:f,left:u,top:r,rowIndex:b,colIndex:k}},"picture"),this._selectImg(y),l.setSheetFocus(),l.model.sheets[n]._importRendered||l._isUndoRedo||l._isPaste||l.XLClipboard._isShape||(p={sheetIndex:n,reqType:"shape",shapeType:"picture",action:"remove",id:l._id+"_picture"+o,actCell:t,img:i,cnt:o},p.position={top:r,left:u,height:e,width:f},l._completeAction(p)))},_shapeMouseDown:function(n){var t,u;n.preventDefault();t=this.XLObj;u=document.activeElement.id;(u.indexOf("pictureheight")>-1||u.indexOf("picturewidth")>-1)&&t.setSheetFocus();var r,o=n.target.id,i=$(n.target),s=i.get(0),f=s.offsetLeft,e=s.offsetTop,h=t._setXY(n);this._selectImg(i);this._picCellIdx=this._getCellIndexFromOffset(e,f);this._imgOffsetleft=f;this._imgOffsetTop=e;this._imgX=h[0];this._imgY=h[1];this._shapeType=o.indexOf("chart")>-1?"chart":"Img";i.css("cursor")==="move"?this._shapeROStart=!0:(i.css("cursor")==="col-resize"||i.css("cursor")==="row-resize")&&(this._shapeRSStart=!0,t._getContent(t.getActiveSheetIndex()).find(".e-ss-imgvisual").css({left:f,top:e,height:i.height(),width:i.width()}));this._shapeType==="chart"&&(r=t.XLChart._getShapeObj(o,this._shapeType),t.getActiveSheetIndex()===r.dataSheetIdx&&t.XLChart._focusChartRange(r.xAxis.range,r.yAxis.range,r.legend.range))},_imgKeyDown:function(n){var r=this.XLObj,s=r.getActiveSheetIndex(),t=r._getContent(s).find(".e-ss-activeimg"),i=t.get(0),e=i.offsetLeft,o=i.offsetTop,u,f,h;if(this._shapeType=t[0].id.indexOf("chart")>-1?"chart":"Img",this._picCellIdx=this._getCellIndexFromOffset(o,e),n.shiftKey||n.ctrlKey)n.shiftKey&&!n.ctrlKey&&(n.keyCode===39||n.keyCode===38?(n.preventDefault(),u=t.height()+2,f=t.width()+2,u<400&&f<600&&t.css({width:f,height:u}),this._updateShapeObj(i),r.XLRibbon._formatTabUpdate()):(n.keyCode===37||n.keyCode===40)&&(n.preventDefault(),u=t.height()-2,f=t.width()-2,u>40&&f>60&&t.css({width:f,height:u}),this._updateShapeObj(i),r.XLRibbon._formatTabUpdate()));else{switch(n.keyCode){case 39:n.preventDefault();t.css({left:e+2});this._updateShapeObj(i);break;case 37:n.preventDefault();e>1&&t.css({left:e-2});this._updateShapeObj(i);break;case 38:n.preventDefault();o>1&&t.css({top:o-2});this._updateShapeObj(i);break;case 40:n.preventDefault();t.css({top:o+2});this._updateShapeObj(i)}this._onKeyscrollShape(s,t,n)}n.keyCode===46&&(n.preventDefault(),h=!1,r.XLClipboard._isShape&&(r.XLClipboard._isShape=!1,h=!0),this._deleteShape(s,t),h&&(r.XLClipboard._isShape=!0))},_shapeMouseUp:function(n){var s="chart",f,r=this.XLObj,o=r.getActiveSheetIndex(),h=r._getContent(o),i=h.find(".e-ss-activeimg"),e=h.find(".e-ss-imgvisual"),u=$(n.target),t=u.get(0);(u.hasClass("e-ss-picture")||u[0].id.indexOf(r._id+"_picture")>-1)&&r.XLRibbon._formatTabUpdate();(t.id.indexOf(s)>-1||t.id.indexOf("Ribbon")<0)&&(t=t.id.indexOf("_svg")>-1?$(t).parents(".e-ss-object").get(0):t);t.className.indexOf("e-ss-imgvisual")>-1||t.className.indexOf("e-ss-object")>-1||(this._shapeROStart&&(t=i),this._shapeRSStart&&(t=e[0]));n.target.id.indexOf("_svg")<0&&n.target.parentNode.className.indexOf("e-content")<0&&(t=e[0]);this._shapeROStart?(r._isUndoRedo||(parseInt(i.css("top"))!==t.offsetTop||parseInt(i.css("left"))!==t.offsetLeft)&&(f={sheetIndex:o,reqType:"shape",shapeType:"chart",action:"edit",actionType:"reorder",id:$(i).attr("id"),visualImg:e,trgt:u},f.prev={top:parseInt(i.css("top")),left:parseInt(i.css("left")),height:parseInt(i.css("height")),width:parseInt(i.css("width"))},f.cur={top:t.offsetTop,left:t.offsetLeft,height:u.height(),width:u.width()}),r._isUndoRedo||(parseInt(i.css("top"))!==t.offsetTop||parseInt(i.css("left"))!==t.offsetLeft)&&r._checkIndicesInContainer(o,this._picCellIdx.rowIndex,this._picCellIdx.colIndex)&&(f.obj=$.extend(!0,{},r._dataContainer.sheets[o][this._picCellIdx.rowIndex][this._picCellIdx.colIndex]),r._completeAction(f)),i.css({left:t.offsetLeft,top:t.offsetTop}),this._updateShapeObj(t),e.removeClass("e-ss-picture").hide()):this._shapeRSStart&&(r._isUndoRedo||(t.className.indexOf("e-ss-imgvisual")<0&&e.length>0&&this._shapeROStart&&(t=e[0]),u=$(t),(parseInt(i.css("height"))!==u.height()||parseInt(i.css("width"))!==u.width())&&r._checkIndicesInContainer(o,this._picCellIdx.rowIndex,this._picCellIdx.colIndex)&&(f={sheetIndex:o,reqType:"shape",shapeType:"chart",action:"edit",actionType:"resize",id:$(i).attr("id"),visualImg:e,trgt:u},f.prev={top:parseInt(i.css("top")),left:parseInt(i.css("left")),height:parseInt(i.css("height")),width:parseInt(i.css("width"))},f.cur={top:t.offsetTop,left:t.offsetLeft,height:u.height(),width:u.width()},f.obj=$.extend(!0,{},r._dataContainer.sheets[o][this._picCellIdx.rowIndex][this._picCellIdx.colIndex]),r._completeAction(f))),i.css({left:t.offsetLeft,top:t.offsetTop,height:u.height(),width:u.width()}),this._updateShapeObj(t),e.removeClass("e-ss-picture").hide(),this._shapeType==="Img"&&r.model.showRibbon&&r.XLRibbon._formatTabUpdate(),this._shapeType===s&&(r.XLChart.resizeChart(i.attr("id"),u.height(),u.width()),r.model.showRibbon&&r.XLRibbon._chartDesignTabUpdate($("#"+i.attr("id")))));this._refreshImgResizing();this._shapeType="Img";this._shapeROStart=this._shapeRSStart=!1},_imgMouseMove:function(n){var o=this.XLObj;if(o._getContent(o.getActiveSheetIndex()).find(".e-ss-activeimg").length){n.preventDefault();var k=o.getActiveSheetIndex(),s=o._getContent(k),r=s.find(".e-ss-activeimg"),t=s.find(".e-ss-imgvisual"),l=r.get(0),e=l.getBoundingClientRect(),y=o._setXY(n),u=y[0],f=y[1],i,h,c;if(this._shapeROStart)t.show(),l.id.indexOf("picture")>-1&&t.addClass("e-ss-picture"),h=u-(this._imgX-this._imgOffsetleft),c=f-(this._imgY-this._imgOffsetTop),h>-1&&c>-1&&t.css({left:h,top:c,height:r.height(),width:r.width()});else{var a=t.width(),v=t.height(),p=l.offsetWidth,w=l.offsetHeight,b=s.find(".e-content"),d=s.find(".e-hscrollbar").data("ejScrollBar"),g=s.find(".e-vscrollbar").data("ejScrollBar");if(this._shapeRSStart){if(t.show(),l.id.indexOf("picture")>-1&&t.addClass("e-ss-picture"),r.css("cursor")==="col-resize"||r.css("cursor")==="row-resize")switch(!0){case this._imgRSWStart:i=this._imgX-u;h=t[0].offsetLeft-i;h>-1&&(t.css({width:a+i,left:h}),this._imgX=u);break;case this._imgRSEStart:i=this._imgX-u;o.model.scrollSettings.allowScrolling&&a-i+t[0].offsetLeft+5<b.width()+d.value()&&(t.css({width:a-i}),this._imgX=u);break;case this._imgRSNStart:i=this._imgY-f;c=t[0].offsetTop-i;c>-1&&(t.css({height:v+i,top:c}),this._imgY=f);break;case this._imgRSSStart:i=this._imgY-f;o.model.scrollSettings.allowScrolling&&v-i+t[0].offsetTop+5<b.height()+g.value()&&(t.css({height:v-i}),this._imgY=f)}}else this._refreshImgResizing(),u<=e.left+4&&u>=e.left?(r.addClass("e-ss-imgcresize"),this._imgRSWStart=!0):u<=e.left+p&&u>=e.left+p-4?(r.addClass("e-ss-imgcresize"),this._imgRSEStart=!0):s.find(".e-ss-imgcresize").removeClass("e-ss-imgcresize"),f<=e.top+4&&f>=e.top?(r.addClass("e-ss-imgrresize"),this._imgRSNStart=!0):f<=e.top+w&&f>=e.top+w-4?(r.addClass("e-ss-imgrresize"),this._imgRSSStart=!0):s.find(".e-ss-imgrresize").removeClass("e-ss-imgrresize")}}},_deleteShape:function(n,t){var h,i=this.XLObj,f=this._picCellIdx,y=i._dataContainer,l=i.getSheet(n),s=l._shapeMngr,u=y.sheets[n][f.rowIndex][f.colIndex],o,r=t.get(0).id.split("_")[1].replace(/[0-9]/g,""),c=t.get(0),a,v,e=s[r][u[r][0]];s[r].some(function(n,t){return c.id===n.id?(v=t,!0):!1});i._isUndoRedo||i._isPaste||i.XLClipboard._isShape||(o={sheetIndex:n,id:c.id,picIndex:v,reqType:"shape",shapeType:r,action:"create",options:e,range:e.range,img:s.sharedPics[e.data]},o.actCell=i.getCell(f.rowIndex,f.colIndex,n)[0],o.position={height:e.height,width:e.width,top:e.top,left:e.left},o.cnt=t.get(0).id.split("_")[1].replace(/[a-z]/g,""),i._completeAction(o));u[r].some(function(n,t){return c.id===s[r][u[r][t]].id?(a=t,!0):!1});Object.keys(u).length<2&&u[r].length<2?delete u:u[r].length<2?delete u[r]:u[r].splice(a,1);h={rowIndex:f.rowIndex,colIndex:f.colIndex};n===i._getSheetIndex()&&(i.setActiveCell(f.rowIndex,f.colIndex),i.performSelection(h,h));t.remove();i.updateFormulaBar();i.model.showRibbon&&(r==="picture"?i.XLRibbon._toggleFormatTab():i.XLRibbon._toggleChartDesignTab());l._isChartBorderDrawn&&i.XLChart._clearChartRange(i._arrayAsString(i._chartBorder))},_selectImg:function(n){this.XLObj._getContent(this.XLObj.getActiveSheetIndex()).find(".e-ss-activeimg").removeClass("e-ss-activeimg");n.addClass("e-ss-activeimg");this.XLObj.XLSelection._cleanUp(!0)},_refreshImgResizing:function(){this._imgRSEStart=!1;this._imgRSWStart=!1;this._imgRSNStart=!1;this._imgRSSStart=!1},_getShapePropeties:function(n,t,i){for(var r,u=this.XLObj.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,i);r in u;)return u[r].id===t?u[r]:void 0},_updateShapeMngr:function(n,t,i){var u=this.XLObj,s=u.getActiveSheetIndex(),e=u.getSheet(s)._shapeMngr,o=!1,h,c,l={},r=e[i],f;if(u.model.sheets[s]._importRendered&&i==="chart")for(f=0;f<r.length;f++)r[f].dummyId===t.chart._id&&(o=!0,r[f]=t.chart,c=f);o||r.push($.extend(!0,{},t[i]));i==="picture"&&(e.sharedPics.indexOf(t[i].data)<0&&e.sharedPics.push(t[i].data),h=e.sharedPics.indexOf(t[i].data),r[r.length-1].data=h);(!u._isPaste||this._insertPic||u.XLClipboard._isShape)&&(l[i]=o?c:r.length-1,u.XLEdit._updateDataContainer(n,l),this._insertPic=!1)},_updateShapeObj:function(n){var f,u=this.XLObj,e=u.getActiveSheetIndex(),s=u._dataContainer,o,r,l,i=this._shapeType==="Img"?"picture":"chart",t=this._picCellIdx,h=u.getSheet(e)._shapeMngr,c,a={};(u.getObjectLength(this._picCellIdx)||(t=this._picCellIdx=this._getCellIndexFromOffset(n.offsetTop,n.offsetLeft)),f=u._getContent(e).find(".e-ss-activeimg"),r=s.sheets[e][t.rowIndex][t.colIndex],r&&r[i])&&(h[i].some(function(n,t){return f[0].id===n.id?(l=t,!0):!1}),o=h[i][l],r[i].some(function(n,t){return f[0].id===h[i][r[i][t]].id?(c=t,!0):!1}),a[i]=r[i][c],u.getObjectLength(r)<2&&r[i].length<2?delete s.sheets[e][t.rowIndex][t.colIndex]:r[i].length<2?delete s.sheets[e][t.rowIndex][t.colIndex][i]:s.sheets[e][t.rowIndex][t.colIndex][i].splice(c,1),this._picCellIdx=t=this._getCellIndexFromOffset(n.offsetTop,n.offsetLeft),o.height=f.height(),o.width=f.width(),o.left=f[0].offsetLeft,o.top=f[0].offsetTop,o.rowIndex=t.rowIndex,o.colIndex=t.colIndex,u.XLEdit._updateDataContainer(u.getCell(t.rowIndex,t.colIndex,e)[0],a))},_updateImgBorder:function(n,t,i,r){var u=this.XLObj,l=u.getActiveSheetIndex(),v=n.offsetLeft,y=n.offsetTop,s,p=this._getCellIndexFromOffset(y,v),a=u.getSheet(l)._shapeMngr,e,h,c=new RegExp("\\be-shapebdr.*?\\b","g"),f,o;a.picture.some(function(t,i){return n.id===t.id?(h=i,!0):!1});e=a.picture[h];s={sheetIndex:l,reqType:"shape",shapeType:"picture",action:"border",id:$(u.element.find(".e-ss-activeimg")).attr("id"),prevClass:n.className.match(c)[0],picIdx:h,cellIdx:p};f=t+" "+i+" "+r;o=this._getImgBorderHashCode({"border-color":r,"border-style":i,"border-width":t});u.model.allowCellFormatting&&u.XLFormat._writeCssRules(o,u.XLFormat._getCssPropertyAsString({border:{left:f,right:f,top:f,bottom:f}}));e.bcolor=r;e.bstyle=i;e.bwidth=t;n.className.match(c)&&(n.className=n.className.replace(c,""));$(n).addClass(o);s.curClass=o;u._dupDetails||u._isUndoRedo||u._completeAction(s)},_getCellIndexFromOffset:function(n,t){for(var e=this.XLObj,h=e.getActiveSheetIndex(),f=e.getSheet(h),o=0,s=0,r=0,i=0,u=f.rowsHeightCollection.length;i<u;i++)if(r+=f.rowsHeightCollection[i],r>n){o=i;break}for(i=0,r=0,u=f.columnsWidthCollection.length;i<u;i++)if(r+=f.columnsWidthCollection[i],r>t){s=i;break}return{rowIndex:o,colIndex:s}},_getImgBorderHashCode:function(n){var i=this.XLObj,t="";return"border-width"in n&&(t=parseInt(n["border-width"])+"N"),i.model.allowCellFormatting&&"border-style"in n&&(t=t+i.XLFormat._getStyleCode("BorderStyle",n["border-style"])+"N"),"border-color"in n&&(t=t+n["border-color"].replace("#","")),"e-shapebdr"+t},_getImgStyleFromHashCode:function(n){var i=this.XLObj,t={};return n=n||"",n=n.replace("e-shapebdr","").split("N"),n.length>1&&(t["border-width"]=n[0]+"px",t["border-style"]=["","solid","dashed","dotted"][n[1]],t["border-color"]="#"+n[2]),t},_copyImages:function(cell,pics,sheetIdx){var sheet=this.XLObj.model.sheets[sheetIdx],shapeMngr=sheet._shapeMngr,i,len,picObj;for(sheet._importRendered&&(pics=eval(pics)),i=0,len=pics.length;i<len;i++)picObj=shapeMngr.picture[pics[i]],this._createPicture(sheetIdx,cell,shapeMngr.sharedPics[picObj.data],picObj.top,picObj.left,picObj.width,picObj.height,pics[i],picObj.bcolor,picObj.bstyle,picObj.bwidth)},_scrollShape:function(n,t,i,r){var f={position:"none",action:"none"},u=this.XLObj,e=u._getContent(n);parseInt(t.css("width"))+(t.offset().left-u._getContent(n).find(".e-content").offset().left)>u._getContent(n).find(".e-content").width()&&this._imgX<=i?f={position:"horizontal",action:"Increment"}:t.offset().left-e.find(".e-content").offset().left<=0?f={position:"horizontal",action:"Decrement"}:parseInt(t.css("height"))+(t.offset().top-u._getContent(n).find(".e-content").offset().top)>u._getContent(n).find(".e-content").height()&&this._imgY<=r?f={position:"vertical",action:"Increment"}:t.offset().top-e.find(".e-content").offset().top<=0&&(f={position:"vertical",action:"Decrement"});u.XLSelection._scrollCalculation(n,t.get(0),f)},_onKeyscrollShape:function(n,t,i){var r=this.XLObj,u=r._getContent(n).find(".e-content"),f=r._getContent(n).find("#hscrollBar").ejScrollBar("instance"),e=r._getContent(n).find("#vscrollBar").ejScrollBar("instance");u.offset().top+u[0].offsetHeight<=t.offset().top+t[0].offsetHeight&&(i.keyCode===40||i.keyCode===13&&!i.shiftKey)?e.scroll(e.value()+2,!0):t.offset().top-r.model.sheets[n]._frozenHeight<=u.offset().top&&(i.keyCode===38||i.keyCode===13&&i.shiftKey)&&e.value()-2>=0&&e.scroll(e.value()-2,!0);u[0].offsetWidth<=t.offset().left+t[0].offsetWidth&&(i.keyCode===39||i.keyCode===9&&!i.shiftKey)?f.scroll(f.value()+2,!0):t.offset().left-r.model.sheets[n]._frozenWidth<=u.offset().left&&(i.keyCode===37||i.keyCode===9&&i.shiftKey)&&f.value()-2>=0&&f.scroll(f.value()-2,!0)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.chart=function(n){this.XLObj=n;this._shapeCnt=1};t.spreadsheetFeatures.chart.prototype={createChart:function(n,i){if(this.XLObj.model.allowCharts){i=i||{};var h,e,f,a,u,c,r=this.XLObj,l="chart",o=r._getSheetIndex(i.sheetIdx),v=r.getSheet(o),s=r.getActiveCellElem(o)[0];(r._isUndoRedo&&(h=i.id.split("_")[1].replace(/[a-z]/g,"")),n=n?r.getRangeIndices(n):v.selectedRange,t.isNullOrUndefined(i.top)||t.isNullOrUndefined(i.left)||(i.activeCell=r.XLShape._getCellIndexFromOffset(i.top,i.left)),i.activeCell&&(s=r.getCell(i.activeCell.rowIndex,i.activeCell.colIndex,o)[0]),r.isRange(n)&&s)&&(i.id=h?r._id+"_"+l+h:r._id+"_"+l+this._shapeCnt,i.type=i.type?i.type:"column",i.animation=i.animation?i.animation:!1,i.range=n,i.dataSheetIdx=i.dataSheetIdx?i.dataSheetIdx:o,i.height=i.height?i.height:r.model.chartSettings.height,i.width=i.width?i.width:r.model.chartSettings.width,i.top=i.top?i.top:s.offsetTop,i.left=i.left?i.left:s.offsetLeft,i.isRowColSwitched=i.isRowColSwitched?i.isRowColSwitched:!1,r.isUndefined(i.xRange)&&(c=this._processChartrange(n,i.dataSheetIdx),i.xRange=c.xRange,i.yRange=c.yRange,i.lRange=c.lRange),f=this._processChartSeries(i),i.xRange=f.xRange,i.yRange=f.yRange,i.lRange=f.lRange,r.getActiveSheetIndex()===i.dataSheetIdx&&this._focusChartRange(f.xRange,f.yRange,f.lRange),e=this._renderBaseElem(l,i.top,i.left,h),e.ejChart(this._processChartOptions(i,f.series)),u=e.ejChart("model"),i.theme=u.theme,i.title={text:u.title.text.length?u.title.text:""},i.xAxis={min:u.primaryXAxis.range.min,max:u.primaryXAxis.range.max,interval:u.primaryXAxis.range.interval,title:{text:u.primaryXAxis.title.text.length?u.primaryXAxis.title.text:""},range:f.xRange},i.yAxis={min:u.primaryYAxis.range.min,max:u.primaryYAxis.range.max,interval:u.primaryYAxis.range.interval,title:{text:u.primaryYAxis.title.text.length?u.primaryYAxis.title.text:""},range:f.yRange},i.legend={visible:u.legend.visible,range:f.lRange},r._isUndoRedo||r.XLShape._updateShapeMngr(s,{chart:i},"chart"),i.theme.indexOf("dark")>-1&&e.addClass("e-ss-charttheme"),r.model.showRibbon&&!i.hideTab&&r.XLRibbon._chartDesignTabUpdate(e),r._on(e,t.eventType.mouseDown,r._mouseDownHandler),r._on(e,t.eventType.mouseMove,r._mouseMove),v._importRendered||r._isUndoRedo||r._isPaste||r.XLClipboard._isShape||(a={sheetIndex:o,reqType:"shape",shapeType:"chart",action:"remove",options:i,range:i.range,id:i.id,position:{top:i.top,left:i.left}},r._completeAction(a)))}},resizeChart:function(i,r,u){var f={},e=n("#"+i);e.length&&(t.isNullOrUndefined(r)||(f.height=r.toString()),t.isNullOrUndefined(u)||(f.width=u.toString()),e.ejChart("option",{size:f}))},refreshChart:function(t,i){if(this.XLObj.model.allowCharts){var r,u="marker",f=this._getShapeObj(t,"chart");if(f){for(r in i)f[r]=i[r];i.type&&(i.commonSeriesOptions={type:i.type},delete i.type);u in i&&(i.commonSeriesOptions?i.commonSeriesOptions.marker={visible:i.marker.visible}:i.commonSeriesOptions={marker:i.marker},delete i[u]);n("#"+t).ejChart("option",i)}}},_processChartOptions:function(n,t){var i={commonSeriesOptions:{type:n.type,enableAnimation:n.animation},series:t,canResize:!0,size:{height:n.height.toString(),width:n.width.toString()},enableRotation:!1,depth:100,wallSize:2,tilt:0,rotation:34,perspectiveAngle:90,sideBySideSeriesPlacement:!0,seriesRendering:this.XLObj.model.seriesRendering};return n.enable3D&&(i.enable3D=!0),n.marker&&(i.commonSeriesOptions.marker=n.marker),n.theme&&(i.theme=n.theme),i.title=n.title||{},i.legend=n.legend||{},i.primaryYAxis=n.primaryYAxis||{minorTicksPerInterval:5,minorGridLines:{visible:!1},minorTickLines:{visible:!1}},i.primaryXAxis=n.primaryXAxis||{minorTicksPerInterval:5,minorGridLines:{visible:!1},minorTickLines:{visible:!1},valueType:"category"},i},_processChartrange:function(n,i){var s=this.XLObj,l,f,h,r=n[0],u=n[1],o=n[2],e=n[3],c=s.XLEdit.getPropertyValue(r,e,null,i),y=s.XLEdit.getPropertyValue(o,u,null,i),p=s.XLEdit.getPropertyValue(r,u,null,i),a=r===o,v=u===e;return!s.isUndefined(p)||a||v?t.isNullOrUndefined(y)||s.isNumber(y)||a||v?(f=[r,u,o,e],t.isNullOrUndefined(c)||s.isNumber(c)||s._isDateTime(c)?t.isNullOrUndefined(p)&&(a||v)&&(h=[r,u,r,e],a?(f[1]=f[1]+1,h[3]=h[1]):f[0]=f[0]+1):(h=[r,u,r,e],f[0]=f[0]+1)):t.isNullOrUndefined(c)||s.isNumber(c)?(l=[r,u,o,u],f=[r,u+1,o,e]):(l=[r+1,u,o,u],f=[r+1,u+1,o,e],h=[r,u+1,r,e]):(l=[r+1,u,o,u],f=[r+1,u+1,o,e],h=[r,u+1,r,e]),{xRange:l,yRange:f,lRange:h}},_processChartSeries:function(n){n=n||{};var t=this.XLObj,a,b,i=n.xRange,r=n.yRange,u=n.lRange,f,k,e,o,v,y,p,w,s,d,h=0,c=0,g=[],l=["value2"];for(k=t.getRangeData(r,!0,null,n.dataSheetIdx,!1,!0),v=r[2]-r[0]+1,y=r[3]-r[1]+1,n.isRowColSwitched?(f=u?t._toArrayData(t.getRangeData(u,!1,l,n.dataSheetIdx)):this._getVirtualXValues(y+1),i&&(e=t._toArrayData(t.getRangeData(i,!1,l,n.dataSheetIdx))),o=v):(f=i?t._toArrayData(t.getRangeData(i,!1,l,n.dataSheetIdx)):this._getVirtualXValues(v+1),u&&(e=t._toArrayData(t.getRangeData(u,!1,l,n.dataSheetIdx))),o=y),b=f.length,d=n.isRowColSwitched?1:o;h<o;){for(s=0,p=[],c=n.isRowColSwitched?c:h;s<b;)a=k[c],p.push({x:f[s],y:t.isNumber(a)?a:0}),c+=d,s++;w={points:p};e&&(w.name=e[h]);g.push(w);h++}return{series:g,xRange:n.isRowColSwitched?u:i,yRange:r,lRange:n.isRowColSwitched?i:u}},_getVirtualXValues:function(n){for(var t=1,i=[];t<n;)i.push(t.toString()),t++;return i},_focusChartRange:function(n,t,i){var r=this.XLObj,u=r._chartBorder;this._clearChartRange(r._arrayAsString(u));i&&r.XLSelection._focusBorder({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]},u[0]);n&&r.XLSelection._focusBorder({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]},u[1]);r.XLSelection._focusBorder({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]},u[2]);r.getSheet(r.getActiveSheetIndex())._isChartBorderDrawn=!0},_clearChartRange:function(n){var t=this.XLObj;t.XLSelection._clearBorder(n);t.getSheet(t.getActiveSheetIndex())._isChartBorderDrawn=!1},_renderBaseElem:function(i,r,u,f){f=t.isNullOrUndefined(f)?this._shapeCnt:f;var e=this.XLObj,o=n("<div id='"+e._id+"_"+i+f+"' class='e-ss-object' style='top:"+r+"px;left:"+u+"px' ><\/div>");return e._getContent(e.getActiveSheetIndex()).find(".e-content").append(o),e.XLShape._selectImg(o),e._isUndoRedo||this._shapeCnt++,o},_refreshChartElements:function(n,t,i){for(var f,r,u,o=this.XLObj,e=1,s=o.model.sheetCount+1;e<s;){if(f=o.getSheet(e)._shapeMngr.chart,r=f.length,r)while(r--)u=f[r],u.dataSheetIdx===i&&this.XLObj.inRange(u.range,n,t)&&this._refreshChart(u);e++}},_refreshChart:function(t){if(n("#"+t.id).length!==0){var i=n("#"+t.id).data("ejChart"),u={xRange:t.xRange,yRange:t.yRange,lRange:t.lRange,isRowColSwitched:t.isRowColSwitched,dataSheetIdx:t.dataSheetIdx},r;i.model.series.length=0;r=this._processChartSeries(u);i.option({series:r.series})}},_getShapeObj:function(n,t){var i,u=this.XLObj.getSheet(this.XLObj.getActiveSheetIndex())._shapeMngr[t],r=u.length;if(r)while(r--)if(i=u[r],i.id===n)return i},_validateChartRange:function(n,t,i,r){var u=this.XLObj;if(!i)return{msg:u._getLocStr("YAxisMissing")};if(!(u.inRange(n,i[0],i[1])||u.inRange(n,i[2],i[3])))return{msg:u._getLocStr("InvalidYAxis")};if(t)if(u.inRange(n,t[0],t[1])||u.inRange(n,n[2],n[3])){if(t[3]-t[1]!=0)return{msg:u._getLocStr("InvalidXAxisColumns")}}else return{msg:u._getLocStr("InvalidXAxis")};return r&&!(u.inRange(n,r[0],r[1])||u.inRange(n,r[2],r[3]))?{msg:u._getLocStr("InvalidLegend")}:{status:!0}},_renderChartRangeDialog:function(){var t=this.XLObj,i={width:"25%",showRoundedCorner:!0,click:n.proxy(this._chartRangeDlgBtnClick,this)},r=n("<div id='"+t._id+"_chartrangedlg'><div class='e-dlgctndiv e-dlg-fields'><table cellpadding='0' cellspacing='0'><tr class='e-dlgtd-fields'><td>"+t._getLocStr("XAxisRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_crxaxis'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+t._getLocStr("YAxisRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_cryaxis' /><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+t._getLocStr("LegendRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_crlaxis'/><\/td><\/tr><\/table><\/div><div class='e-dlg-btnfields' ><div class='e-dlg-btnctnr'><button id='"+t._id+"_crok' >"+t._getLocStr("Ok")+"<\/button><button id='"+t._id+"_crcancel'>"+t._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>");t.element.append(r);r.ejDialog({width:310,height:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,cssClass:"e-ss-dialog",title:t._getLocStr("ChartRange")});n("#"+t._id+"_crok").ejButton(i);n("#"+t._id+"_crcancel").ejButton(i)},_chartRangeDlgBtnClick:function(t){var r,u,f,e,i=this.XLObj,o=i._getSheetIndex(i.getActiveSheetIndex()),c=i.getSheet(o),s,h;t.model.text===i._getLocStr("Ok")&&(r=document.getElementById(i._id+"_chart").value,u=n("#"+i._id+"_crxaxis").val(),f=n("#"+i._id+"_cryaxis").val(),e=n("#"+i._id+"_crlaxis").val(),h={xRange:u,yRange:f,lRange:e},this._processChartRange(u,f,e,r));!0&&n("#"+i._id+"_chartrangedlg").ejDialog("close");c._importRendered||i._isUndoRedo||(s={sheetIndex:o,reqType:"shape",shapeType:"chart",action:"selectData",id:r,prev:i._selectDataval,cur:h},i._completeAction(s))},_processChartRange:function(t,i,r,u){var l,e,o=this.XLObj,a,s,h,c,f;e=this._getShapeObj(u,"chart");t.length&&(s=o.getRangeIndices(t));i.length&&(h=o.getRangeIndices(i));r.length&&(c=o.getRangeIndices(r));l=this._validateChartRange(e.range,s,h,c);l.status?(e.xRange=s,e.yRange=h,e.lRange=c,this._refreshChart(e),f=n("#"+u).ejChart("model"),e.xAxis={min:f.primaryXAxis.range.min,max:f.primaryXAxis.range.max,interval:f.primaryXAxis.range.interval,title:{text:f.primaryXAxis.title.text.length?f.primaryXAxis.title.text:""},range:s},e.yAxis={min:f.primaryYAxis.range.min,max:f.primaryYAxis.range.max,interval:f.primaryYAxis.range.interval,title:{text:f.primaryYAxis.title.text.length?f.primaryYAxis.title.text:""},range:h},e.legend={visible:f.legend.visible,range:c},o.getActiveSheetIndex()===e.dataSheetIdx&&this._focusChartRange(s,h,c)):(a=!1,o._showAlertDlg("Alert","T-"+l.msg,"",400))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.print=function(n){this.XLObj=n;this._printHeight=800;this._pageHeight=820;this._pageWidth=750;this._marginTop=30;this._marginBottom=150;this._printRowLabels=!1;this._isPrintSelection=!1;this._stRow=0;this._stColumn=0};t.spreadsheetFeatures.print.prototype={_printSetting:function(n){this.XLObj.model.pageSize=n;switch(n){case t.Spreadsheet.pageSize.A4:this._printHeight=800;this._pageHeight=820;this._pageWidth=750;this._marginTop=30;this._marginBottom=150;break;case t.Spreadsheet.pageSize.A3:this._printHeight=1350;this._pageHeight=1330;this._pageWidth=860;this._marginTop=30;this._marginBottom=150;break;case t.Spreadsheet.pageSize.Letter:this._printHeight=1e3;this._pageHeight=970;this._pageWidth=860;this._marginTop=30;this._marginBottom=60}},printSelection:function(){var i=this.XLObj,s;if(i.model.printSettings.allowPrinting){var o,r,e=i.getActiveSheetIndex(),u=i.getSheet(e)._selectedCells,l=u[u.length-1],w=l.rowIndex,a=l.colIndex,h,f,c=t.buildTag("table"),v=t.buildTag("colgroup"),y=i._getContent(e).find("col"),p=t.buildTag("div#printDiv");for(i._detachTable=i._getContent(e).find(".e-content >table"),i._detachTable.detach(),i._isPrint=!0,r=u[0].colIndex;r<a;r++)n(y[r].outerHTML).attr("id","cc").appendTo(v);for(c.append(v),o=u[0].rowIndex;o<=w;o++){for(f=i.getCell(o,0),h=f.parent().hasClass("e-fr-hide")?t.buildTag("tr.e-fr-hide","",{height:parseInt(f[0].parentNode.style.height)}):t.buildTag("tr","",{height:parseInt(f[0].parentNode.style.height)}),r=u[0].colIndex;r<=a;r++)f=i.getCell(o,r),n(y[r]).hasClass("e-fc-hide")&&i.addClass(f[0],"e-fc-hide"),n(f[0].outerHTML).attr("id","s").appendTo(h);c.append(h)}this._stRow=u[0].rowIndex;this._stCol=u[0].colIndex;this._isPrintSelection=!0;s=n(c[0].outerHTML).attr("id","print");i._getContent(e).find(".e-content").append(i._detachTable);i._isPrint=!1;this._printRowLabels?this._calculateTabCount(p,e,s):this._constructSheet(p,e,s,s.get(0).rows)}},printSheet:function(){var i=this.XLObj;if(i.model.printSettings.allowPrinting){var u=t.buildTag("div#printDiv"),r=i.getActiveSheetIndex(),f=n(i._getContent(r).find(".e-content .e-table")[0].outerHTML).attr("id","print");this._printRowLabels?this._calculateTabCount(u,r,f):this._constructSheet(u,r,f,n(i._getContent(r).find(".e-content .e-table")).get(0).rows)}},_calculateTabCount:function(t,i,r){for(var s,e=[],f=0,o=n(this.XLObj.getRows(i)[1]).parents("table").find("col"),u=0,h=o.length;u<h;u++)f+=parseInt(o[u].style.width),f>=this._pageWidth&&(e.push({tCount:1,cellCount:u}),f=0);s={xlObj:this.XLObj,element:e,table:r,printDiv:t,Index:i};this.XLObj._trigger("beforePrint",s)},_calculateCellRowCount:function(n,t,i){for(var f=this.XLObj,e,p=[],w=[],s=0,h=0,c=12,l=40,a=0,v=0,u,y=f._getContent(f.getActiveSheetIndex()).find("col"),r=t,o=n[0].cells.length;r<o;r++)if(s+=parseInt(y[r].style.width),p.push(parseInt(y[r].style.width)),s>=this._pageWidth){v=c=r;break}else e=Math.floor((this._pageWidth-s)/f.model.columnWidth),v=c=n[i].cells.length+e;for(u=i,o=n.length;u<o;u++)if(h+=parseInt(n[u].style.height),w.push(parseInt(n[u].style.height)),h>=this._pageHeight){a=l=u;break}else e=Math.floor((this._pageHeight-h)/f.model.rowHeight),a=l=n.length+e;return{startCell:t,endCell:v,startRow:i,endRow:a,cellCount:c,rowCount:l}},_constructSheet:function(n,i,r,u){var h=t.buildTag("div .e-spreadsheet","",{}),e=0,f=this._calculateCellRowCount(u,0,0),o=u[0].cells.length,s=u.length;e=Math.ceil(o/f.cellCount);e=e*Math.ceil(s/f.rowCount);e==1&&(f.rowCount=u.length);this._constructPrintableElement(i,n,h,r,u,s,o,e,f.cellCount,f.rowCount,f.startRow,f.startCell,f.endRow,f.endCell)},_constructPrintableElement:function(i,r,u,f,e,o,s,h,c,l,a,v,y,p){for(var ut,ot,g,st,ft=!1,rt,k=this.XLObj,ht=t.buildTag("div"),nt,ct,et=!1,lt=0,tt,w,it,d,at,b,yt=k._getContent(i).find("col"),vt=h;vt>0;vt--){for(nt=this._calculateCellRowCount(e,v,a),v=nt.startCell,p=nt.endCell,a=nt.startRow,y=nt.endRow,c=nt.cellCount,l=nt.rowCount,rt=this._constructTable(i,v,p),k.model.sheets[i].showHeader&&this._constructHeaders(v,p,y,rt),ct=this._isPrintSelection?a<this._stRow?this._stRow:a:a,w=a;w<y;w++){for(t.isNullOrUndefined(f[0].rows[w])?(d=n(f[0].rows[0].cells[0]),g=t.buildTag("tr","",{height:k.model.rowHeight})):(d=n(f[0].rows[w].cells[0]),g=d.parent().height()>0?t.buildTag("tr","",{height:d.parent().height()}):t.buildTag("tr","",{height:k.model.rowHeight})),d.parent().hasClass("e-fr-hide")&&g.addClass("e-fr-hide"),it=v;it<p;it++)k.model.sheets[i].showHeader&&!ft&&(st='<td class="{0}">{1}<\/td>',n(String.format(st,"e-rowcell e-header",ct+w+1)).appendTo(g),ft=!0),n(e[w]).length>0&&n(e[w].cells[it]).length>0?(d=n(e[w].cells[it].outerHTML).attr("id","ss"),n(yt[it]).hasClass("e-fc-hide")&&d.addClass("e-fc-hide"),d.appendTo(g)):t.buildTag("td.e-rowcell").appendTo(g);ft=!1;rt.append(g)}if(r.append(rt),y<o)a=y,y=y+l;else if(y>=o){if(p>=s)break;a=0;y=l;v=p;p=p+c}}for(w=r.find("table").length-1;w>=0;--w)tt=n(r.find("table")[w]),et||this._checkEmptyRow(i,tt,"first"),lt=k.model.sheets[i].showHeader?tt.find("tr.empty").length+1:tt.find("tr.empty").length,(tt.find("tr").length!==lt||et)&&(n(tt.get(0).outerHTML).attr("id","cc").appendTo(ht),et=!0);for(b=ht.find("table"),w=b.length-1;w>=0;--w)b.length-1!==w?(k.model.pageSize===t.Spreadsheet.pageSize.A4&&b.eq(w).css({"margin-top":300,"margin-bottom":300}),k.model.pageSize===t.Spreadsheet.pageSize.A3&&b.eq(w).css({"margin-top":120,"margin-bottom":110}),k.model.pageSize===t.Spreadsheet.pageSize.Letter&&(k.model.sheets[i].showHeader?b.eq(w).css({"margin-top":70,"margin-bottom":50}):b.eq(w).css({"margin-top":0,"margin-bottom":50}))):b.length-1===w&&(k.model.sheets[i].showHeader?b.eq(w).css({"margin-top":30,"margin-bottom":20}):b.eq(w).css({"margin-top":30,"margin-bottom":0})),w===0&&(b.length>1&&b.eq(w).css({"margin-top":120,"margin-bottom":0}),this._checkEmptyRow(i,b.eq(w),"last")),n(b[w].outerHTML).attr("id","cc").appendTo(u);for(ut=n("head").find("link"),ot=[],w=0,at=ut.length;w<at;w++)if(ut[w].href.indexOf("ej.pivotintegration.css")>-1){ot.push(ut[w]);break}k._trigger("_pivotPrint",{element:u});this._isPrintSelection=!1;this.print(u,ot,i)},_checkEmptyRow:function(t,i,r){for(var o,e,f=i.find("tr"),s,h,u=f.length-1;u>=0;--u)if(o=n(f[u]).find(".e-rowcell").length,e=n(f[u]).find(".e-rowcell:empty").length,e=this.XLObj.model.sheets[t].showHeader?e+1:e,s=n(f[u]).find('td[class *= "e-format"]').length,h=n(f[u]).find('td[class *= "e-border"]').length,e===o&&s<1&&h<1)n(f[u]).addClass("empty");else{n(f[u]).addClass("nonempty");break}r==="last"&&(i.find("tr.empty").find("td").removeClass("e-rowcell"),i.find("tr.empty").find("td.e-header").text(""))},_constructTable:function(i,r,u){var e=t.buildTag("colgroup"),s=this.XLObj,h=t.buildTag("table.e-table","",{height:this._printHeight,"margin-top":this._marginTop,"margin-bottom":this._marginBottom}),c=s._getContent(s.getActiveSheetIndex()).find("col"),o,f;for(s.model.sheets[i].showHeader&&(o='<col class="{0}" style= "width: 30px;" >{1}<\/col>',n(o).appendTo(e)),f=r;f<u;f++)n(c[f]).length>0?n(c[f].outerHTML).attr("id","cc").appendTo(e):(o='<col class="{0}" style= "width: 60px;" >{1}<\/col>',n(o).appendTo(e));return h.append(e),h},_constructHeaders:function(i,r,u,f){var h=t.buildTag("tr","",{height:30}),c,l,s,a,v,o=this.XLObj,y=!1,w=o._getContent(o.getActiveSheetIndex()).find("col"),p="e-rowcell",e;for(this._isPrintSelection&&i<this._stCol&&(r=r+(this._stCol-i),i=this._stCol),c='<td class="{0}" style= "width: 30px;" >{1}<\/td>',l='<div class = "{0}" > {1}<\/div>',e=i;e<=r;e++)y?(s=o._generateHeaderText(o.getActiveSheetIndex(),e),p=n(w[e-1]).hasClass("e-fc-hide")?"e-rowcell e-fc-hide":"e-rowcell e-headercell"):(s="",y=!0),a=String.format(l,"e-headercelldiv",s),v=String.format(c,p,a),n(h[0]).append(v);f.append(h)},print:function(i,r,u){var h=this.XLObj,f,e,c,o,s,l;h.model.printSettings.allowPrinting&&((f=window.open("","print","'height=452,width=1024,tabbar=no"),h.isUndefined(f))||(s=t.buildTag("div"),l=i.clone(),s.append(l),f.document.write("<!DOCTYPE html>"),t.browserInfo().name==="msie"?(o="",r.length>0&&n(r).each(function(t,i){n(i).attr("href",i.href);o+=i.outerHTML}),f.document.write("<html><head><\/head><body>"+o+s[0].innerHTML+"<\/body><\/html>")):(o="",f.document.write("<html><head>"),r.length>0&&n(r).each(function(t,i){n(i).attr("href",i.href);o+=i.outerHTML}),f.document.writeln(o+"<\/head><body>"),f.document.writeln(s[0].innerHTML+"<\/body><\/html>")),n(f.document.head).append("<style><\/style>"),e=h.model.sheets[u].showGridlines?".e-spreadsheet .e-rowcell {border: 1px solid #000000;line-height: 14px;width: auto;cursor:cell;overflow:hidden;white-space: pre;}.e-spreadsheet .e-table{border-collapse: collapse}":".e-spreadsheet .e-rowcell {line-height: 14px;width: auto;cursor:cell;overflow:hidden;white-space: pre;}.e-spreadsheet .e-table{border-collapse: collapse}",e=e.concat(n(document).find("style#"+this.XLObj._id+"_sscustomformat").text()),c=n(f.document.head).find("style"),e=e.concat(".e-spreadsheet .e-fr-hide { display: none !important;}.e-spreadsheet .e-fc-hide { display: none !important;}.e-spreadsheet .e-sswraptext {word-break: break-all; white-space: normal;}.e-spreadsheet .e-headercell{text-align:center;}.e-spreadsheet .e-ralign{text-align:right;}"),c.append(e),f.focus(),n("#print").remove(),setTimeout(function(){t.isNullOrUndefined(f.window)||(t.isNullOrUndefined(f.location)||(f.print(),f.location.reload()),setTimeout(function(){f.close()},2e3))},2e3)))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.scroller=function(n){this.XLObj=n};t.spreadsheetFeatures.scroller.prototype={_getColWidths:function(n,i){var f=this.XLObj,u=f.getSheet(n),e=f.getRows(n)[1],o=f._getContent(n).find("col"),r,s;if(!t.isNullOrUndefined(e)){for(r=i,s=e[0].cells.length;r<s;r++)u._cWidthCollection[r]={idx:r,value:e[0].cells[r].offsetLeft},u._colWidthCollection[r]={idx:r,value:u._colWidthCollection[r-1].value+parseInt(o[r-1].style.width)};u._colWidthCollection[u._colWidthCollection.length-1].value=u._colWidthCollection[u._colWidthCollection.length-2].value+parseInt(o[o.length-1].style.width)}return f._colWidthCollection},_getRowHeights:function(n,i){var e=this.XLObj,u=e.getSheet(n),f=e.getRows(n)[1],r,o;if(!t.isNullOrUndefined(f)){for(r=i,o=f.length;r<o;r++)u._rHeightCollection[r]={idx:r,value:f[r].offsetTop},u._rowHeightCollection[r]={idx:r,value:u._rowHeightCollection[r-1].value+parseInt(f[r-1].style.height)};u._rowHeightCollection[u._rowHeightCollection.length-1].value=u._rowHeightCollection[u._rowHeightCollection.length-2].value+parseInt(f[f.length-1].style.height)}return e._rowHeightCollection},_createScroller:function(i,r){var o=this.XLObj,u=o._getContent(i),f=t.buildTag("div#vscrollBar"),e=t.buildTag("div#hscrollBar");u.append(f).append(e);u.find(".e-content").width(r.width-18).height(r.height-19);f.ejScrollBar({orientation:"vertical",height:r.height-18,minimum:0,viewportsize:r.height,infiniteScrolling:!0,scroll:n.proxy(this._scrollSpreadY,this)});e.ejScrollBar({orientation:"horizontal",width:r.width-17,minimum:0,infiniteScrolling:!0,viewportsize:r.width,scroll:n.proxy(this._scrollSpreadX,this)});this._refreshScroller(i,"initial","all")},_hScroller:function(n){return this.XLObj._getContent(n).find("#hscrollBar").data("ejScrollBar")},_vScroller:function(n){return this.XLObj._getContent(n).find("#vscrollBar").data("ejScrollBar")},_refreshScroller:function(n,t,i){var y=this.XLObj,o=y.getSheet(n),r=this._hScroller(n),p,w,l=o.columnWidth,a=o.rowHeight,u=this._vScroller(n),s,f,h,e,v=y._getContent(n),c;if(i==="all"||i==="horizontal"){if(s=v.find(".e-content").width(),f=o._colWidthCollection[o._colWidthCollection.length-1].value+18-o._frozenWidth,f=f-o._hiddenWidth,f<s+2*l)for(p=Math.floor((s+l*5-f)/l),c=0;c<p;c++)this._createNewColumn(n,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert"),f=f+l;r._scrollData.handleSpace=s-2*r.model.buttonSize;r._scrollData.handle=Math.floor((s-18)/f*r._scrollData.handleSpace);r._scrollData.handle<15&&(r._scrollData.handle=15);r.model.maximum=f-s;r._scrollData.scrollable=f-s;r._scrollData.onePx=r._scrollData.scrollable/(r._scrollData.handleSpace-r._scrollData.handle);r["e-hhandle"].width(r._scrollData.handle);r.model.scrollLeft=r._scrollData.handleSpace-r._scrollData.handle}if(i==="all"||i==="vertical"){if(h=v.find(".e-content").height(),e=v.find(".e-content .e-table").height()-o._frozenHeight+o._fpHiddenHeight,e=e-o._hiddenHeight,e<h+2*a)for(w=Math.floor((h+a*5-e)/a),c=0;c<w;c++)this._createNewRow(n,-1,-1,"insert"),e=e+a;u._scrollData.handleSpace=h-2*u.model.buttonSize;u._scrollData.handle=Math.floor((h-18)/e*u._scrollData.handleSpace);u._scrollData.handle<15&&(u._scrollData.handle=15);u.model.maximum=e-h;u._scrollData.scrollable=e-h;u._scrollData.onePx=u._scrollData.scrollable/(u._scrollData.handleSpace-u._scrollData.handle);u["e-vhandle"].height(u._scrollData.handle);u.model.scrollTop=u._scrollData.handleSpace-u._scrollData.handle}},_changeTopSpread:function(n,t,i,r){var f=n.value(),u=f+i;t.step=i;(t.enableRTL?u<t.scrollable:u>t.scrollable)&&(u=t.scrollable);(t.enableRTL?u>0:u<0)&&(u=0);n.scroll(u,r)},_spreadMouseWheel:function(n){var i=this.XLObj;if(n.stopImmediatePropagation(),n.preventDefault(),!i.element.find(".e-excelfilter.e-dlgcontainer").is(":visible")&&!i._isSubMenuOpen()&&!i._isSheetRename){var t=0,u=n,r=this._vScroller(i.getActiveSheetIndex());(n=n.originalEvent,n.wheelDelta?(t=-n.wheelDelta/120,window.opera&&parseFloat(window.opera.version,10)<10&&(t=-t)):n.detail&&(t=n.detail/3),t)&&this._changeTopSpread(r,r._scrollData,t*r._scrollData.scrollOneStepBy,"wheel")&&(n.preventDefault?n.preventDefault():u.preventDefault())}},_scrollSpreadX:function(n){this._spreadHS(n)},_scrollDirection:function(n,t){var i=this.XLObj,n=i._getContent(i.getActiveSheetIndex()).find("#"+n).ejScrollBar("instance");n.value()<t?n._scrollData.step=1:n.value()>t&&(n._scrollData.step=-1);n.scroll(t)},_spreadHS:function(n){var i=this.XLObj,r=i.getActiveSheetIndex(),e,u=this._hScroller(r),f=i._getContent(r),c=f.find("col"),o=i.model.sheets[r];if(n.reachedEnd=Math.ceil(parseFloat(u.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(u.element.find(".e-hhandle").width()))>=i.element.find(".e-hhandlespace").width()-2,e=n.scrollLeft,i.model.enableContextMenu&&i.XLCMenu.hideCMenu(),i.getFrozenColumns(r)>0&&!i.XLCellNav._scrollReverse&&(n.cancel=!0,n.scrollData!=null&&n.scrollData.dimension!="height"&&(!n.reachedEnd||n.scrollData.step<0))){var l=i.XLFreeze._getLeftColumn(e,r),s=l.imaginaryIndex,v=i._getJSSheetHeader(r).find("col"),y=f.find(".e-table").height(),p=f.height();i.XLFreeze._changehHandlerPosition(e);s>o._currentLeftFrozenColumn?f.find(".e-content").width()<=f.find(".e-table").width()-i.model.columnWidth&&i.XLFreeze._showHideColumn(r,o._currentLeftFrozenColumn,s,"hide",o._colWidthCollection[l.i].value,c,v,p,y):s<o._currentLeftFrozenColumn&&i.XLFreeze._showHideColumn(r,s,o._currentLeftFrozenColumn+1,"show",o._colWidthCollection[l.i].value,c,v,p,y)}if(i.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&n.reachedEnd&&n.scrollData.step>-1&&!(i.XLCellNav&&i.XLCellNav._scrollReverse)){var w=!1,b=!1,a=this,h;i.isUndefined(n.scrollData.target)||(h=setInterval(function(){w=!0;for(var n=0;n<5;n++)a._scrollRight(r),i.getFrozenColumns(r)<1&&i.getFrozenRows(r)>0&&i.XLFreeze._refreshFreezeDiv(r,"horizontal",20*i.getSheet(r).columnWidth),i.getFrozenColumns(r)>0&&f.find(".e-content").width()<=f.find(".e-table").width()-i.model.sheets[r]._firstCol.value&&i.XLFreeze._hideColumn(r);e=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx;a._refreshScroller(r,"refresh","horizontal");u.element.find(".e-hhandle").css("left",u._scrollData.handleSpace-(u._scrollData.handle+1));u.scroll(e);clearInterval(h);return},1e3),u.element.find(".e-hdown")[0].addEventListener("mouseup",function(){clearInterval(h);return}),document.addEventListener("mouseup",function(){clearInterval(h);return}),b=!0);n.cancel=!0;w&&b||(this._scrollRight(r),i.getFrozenColumns(r)<1&&i.getFrozenRows(r)>0&&i.XLFreeze._refreshFreezeDiv(r,"horizontal",i.getSheet(r).columnWidth),i.getFrozenColumns(r)>0&&f.find(".e-content").width()<=f.find(".e-table").width()-i.model.sheets[r]._firstCol.value&&i.XLFreeze._hideColumn(r),e=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,a._refreshScroller(r,"refresh","horizontal"),u.element.find(".e-hhandle").css("left",u._scrollData.handleSpace-(u._scrollData.handle+1)),u.value(e))}n.scrollLeft=e;i.model.allowKeyboardNavigation&&(i.XLCellNav._scrollReverse=!1);i.getFrozenColumns(r)<1&&(f.find(".e-content").scrollLeft(n.scrollLeft,n.scrollData.onePx),u.value(n.scrollLeft),i.model.allowAutoFill&&i._getJSSheetHeader(r)[0].querySelectorAll("th.e-colselected").length<1&&i.XLDragFill.positionAutoFillElement());this._getFirstColumn(r);i.getFrozenColumns(r)>0&&(i.model.allowComments&&i.XLComment._updateCmntArrowPos(),i.XLSelection.refreshSelection(),i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement(),c.get(i.getActiveCellElem(r).index()).className.indexOf("e-fc-hide")>-1&&i.model.allowAutoFill&&i.XLDragFill.hideAutoFillElement())},_scrollSpreadY:function(n){this._spreadVS(n)},_spreadVS:function(n){var i=this.XLObj,r=i.getActiveSheetIndex(),f,u=this._vScroller(r),e=i.model.sheets[r],o=i._getContent(r);if(n.reachedEnd=Math.ceil(parseFloat(u.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(u.element.find(".e-vhandle").height()))>=u.element.find(".e-vhandlespace").height()-2,f=n.scrollTop,i.model.enableContextMenu&&i.XLCMenu.hideCMenu(),i.getFrozenRows(r)>0&&!(i.XLCellNav&&i.XLCellNav._scrollReverse)&&n.scrollData!=null&&n.scrollData.dimension!="width"&&(n.cancel=!0,i.XLFreeze._changevHandlerPosition(f),!n.reachedEnd||n.scrollData.step<0)){var c=i.XLFreeze._getTopRow(f,r),s=c.imaginaryIndex,a=i.getRows(r),v=i._getContent(r).find(".e-content").height(),y=i._getContent(r).find(".e-table").height();s>e._currentTopFrozenRow?o.find(".e-content").height()<=o.find(".e-table").height()-i.model.rowHeight&&i.XLFreeze._showHideRow(r,e._currentTopFrozenRow,s,"hide",e._rowHeightCollection[c.i].value,a,v,y):s<e._currentTopFrozenRow&&i.XLFreeze._showHideRow(r,s,e._currentTopFrozenRow+1,"show",e._rowHeightCollection[c.i].value,a,v,y)}if(i.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&n.reachedEnd&&n.scrollData.step>-1&&!(i.XLCellNav&&i.XLCellNav._scrollReverse)){var p=!1,w=!1,l=this,h;!i.isUndefined(n.scrollData.target)&&i._hasClass(n.scrollData.target,"e-vdown")&&(h=setInterval(function(){p=!0;for(var n=0;n<20;n++)l._scrollBottom(r),i.getFrozenRows(r)<1&&i.getFrozenColumns(r)>0&&i.XLFreeze._refreshFreezeDiv(r,"vertical",i.getSheet(r).rowHeight),i.getFrozenRows(r)>0&&o.find(".e-content").height()<=o.find(".e-table").height()-e._firstRow.value&&i.XLFreeze._hideRow(r);f=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx;l._refreshScroller(r,"refresh","vertical");u.element.find(".e-vhandle").css("top",u._scrollData.handleSpace-u._scrollData.handle);u.scroll(f);clearInterval(h);return},1e3),u.element.find(".e-vdown")[0].addEventListener("mouseup",function(){clearInterval(h);return}),document.addEventListener("mouseup",function(){clearInterval(h);return}),w=!0);n.cancel=!0;p&&w||(this._scrollBottom(r),i.getFrozenRows(r)<1&&i.getFrozenColumns(r)>0&&i.XLFreeze._refreshFreezeDiv(r,"vertical",i.getSheet(r).rowHeight),i.getFrozenRows(r)>0&&o.find(".e-content").height()<=o.find(".e-table").height()-e._firstRow.value&&i.XLFreeze._hideRow(r),f=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,l._refreshScroller(r,"refresh","vertical"),u.element.find(".e-vhandle").css("top",u._scrollData.handleSpace-u._scrollData.handle),u.value(f))}n.scrollTop=f;i.model.allowKeyboardNavigation&&(i.XLCellNav._scrollReverse=!1);i.getFrozenRows(r)<1&&o.find(".e-content").scrollTop(n.scrollTop,u._scrollData.onePx);i.model.allowAutoFill&&i._getJSSheetRowHeaderContent(r)[0].querySelectorAll("td.e-rowselected").length<1&&i.XLDragFill.positionAutoFillElement();this._getFirstRow(r);i.getFrozenRows(r)>0&&(i.model.allowComments&&i.XLComment._updateCmntArrowPos(),i.XLSelection.refreshSelection(),i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement(),i.getActiveCellElem(r).parent()[0].className.indexOf("e-fr-hide")>-1&&i.model.allowAutoFill&&i.XLDragFill.hideAutoFillElement())},_scrollX:function(i){var r=this.XLObj,u=this._hScroller(i),o,f=[1],h=r._getContent(i).find("tbody").eq(0).prev(),e,s;for(r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&this._scrollRight(i),u.model.maximum=u.model.maximum+r.model.columnWidth,u._scrollData.scrollable=u._scrollData.scrollable+r.model.columnWidth,this._refreshScroller(i,"refresh","horizontal"),u.element.find(".e-hhandle").css("left",u._scrollData.handleSpace-(u._scrollData.handle+1)),o=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,u.value(o),e=0,s=r.model.sheets[i]._fCol;e<s;e++)f.push(f[f.length-1]+n(h.find("col")[e]).width());r.getFrozenColumns(i)>0&&r._getContent(i).find(".e-content").width()<=r._getContent(i).find(".e-table").width()-(f[f.length-1]+r.model.columnWidth)&&r.XLFreeze._hideColumn(i);r.getFrozenColumns(i)<1&&r._getContent(i).find(".e-content").scrollLeft(o,u._scrollData.onePx);this._getFirstColumn(i)},_scrollY:function(i){var r=this.XLObj,u=this._vScroller(i),o,f=[1],h=r.getRows(i)[1],e,s;for(r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&this._scrollBottom(i),u.model.maximum=u.model.maximum+r.model.rowHeight,u._scrollData.scrollable=u._scrollData.scrollable+r.model.rowHeight,this._refreshScroller(i,"refresh","vertical"),u.element.find(".e-vhandle").css("top",u._scrollData.handleSpace-(u._scrollData.handle+1)),o=(u._scrollData.handleSpace-u._scrollData.handle)*u._scrollData.onePx,u.value(o),e=0,s=r.model.sheets[i]._fRow;e<s;e++)f.push(f[f.length-1]+n(h[e]).height());r.getFrozenRows(i)>0&&r._getContent(i).find(".e-content").height()<=r._getContent(i).find(".e-table").height()-(f[f.length-1]+r.model.rowHeight)&&r.XLFreeze._hideRow(i);r.getFrozenRows(i)<1&&r._getContent(i).find(".e-content").scrollTop(o,u._scrollData.onePx);this._getFirstRow(i)},_getFirstRow:function(n){var r=this.XLObj,u,f=this._vScroller(n),i=r.model.sheets[n]._rowHeightCollection,t,e;for(u=parseInt(f.element.find(".e-vhandle").css("top"))*f._scrollData.onePx,t=0,e=i.length;t<e;t++)if(i[t].value>=u){r.model.sheets[n]._topRow={idx:t,value:i[t].value};break}},_getFirstColumn:function(n){var r=this.XLObj,u,f=this._hScroller(n),i=r.model.sheets[n]._colWidthCollection,t,e;for(u=parseInt(f.element.find(".e-hhandle").css("left"))*f._scrollData.onePx,t=0,e=i.length;t<e;t++)if(i[t].value>=u){r.model.sheets[n]._leftCol={idx:t,value:i[t].value};break}},_scrollSelectedPosition:function(n,t){var e,u,r=this.XLObj,o=this._hScroller(n),f=this._vScroller(n),i=r.getCell(t.rowIndex,t.colIndex);(parseInt(i.width())+(i.offset().left-r._getContent(n).find(".e-content").offset().left)>r._getContent(n).find(".e-content").width()||i.offset().left-r._getContent(n).find(".e-content").offset().left<=0)&&(e=i.offset().left-(o._scrollData.handleSpace+o.model.buttonSize),e<0&&(e=0),o.scroll(e));(parseInt(i.height())+(i.offset().top-r._getContent(n).find(".e-content").offset().top)>r._getContent(n).find(".e-content").height()||i.offset().top-r._getContent(n).find(".e-content").offset().top<=0)&&(u=i.offset().top-(f._scrollData.handleSpace+f.model.buttonSize),u<0&&(u=0),u>f._scrollData.scrollable&&(u=f._scrollData.scrollable),f.scroll(u))},_rowTemplate:function(n){for(var u="",t=this.XLObj,r="e-rowcell",i=0,f=t.model.sheets[n].colCount;i<f;i++)t.getSheet(n).showGridlines||(r=r.concat(" e-hborder")),u+=String.format('<td class="{0}" style="{2}"  >{1}<\/td>',r,"");return String.format("<tr style='{0}'>"+u+"<\/tr>","height:"+t.model.rowHeight+"px;")},_rowHeaderTemplate:function(n){var t;return t=String.format('<td class="{0}"  >{1}<\/td>',"e-rowheader",n),String.format("<tr style='{0}'>"+t+"<\/tr>","height:"+this.XLObj.model.rowHeight+"px;")},_columnTemplate:function(){var n="e-rowcell",t=this.XLObj,i=t.getActiveSheetIndex();return t.getSheet(i).showGridlines||(n=n.concat(" e-hborder")),String.format('<td class="{0}" style="{2}" >{1}<\/td>',n,"")},_colGroupTemplate:function(n){return String.format("<col style = '{0}'><\/col>","width:"+this.XLObj.getSheet(n).columnWidth+"px;")},_columnHeaderTemplate:function(n,t){var i,r;return i=this.XLObj._generateHeaderText(t,n),r=String.format('<div class = "{0}" > {1}<\/div>',"e-headercelldiv",i),String.format('<th class="{0}"  >{1}<\/th>',"e-headercell",r)},_createNewRow:function(t,i,r,u){var o,s,l,h,a,f=this.XLObj,v=f.XLSelection,e=f.getSheet(t),c,y;if(l=this._rowTemplate(t),o=f._getContent(t).find("tbody").get(0),h=f._getJSSheetRowHeaderContent(t).find("tbody").get(0),i===-1||r>-1&&i>-1&&u==="shift"?(n(h).append(this._rowHeaderTemplate(parseInt(h.lastChild.textContent)+1)),n(o).append(l),u=="shift"&&(n(o).find("tr:last td:last").remove(),n(o).find("tr: eq(' + rowIdx + ') td:eq(' + (colIdx - 1) + ')").after(this._columnTemplate()))):(s=o.insertRow(i),n(s).height(f.model.rowHeight),n(s).append(n(l)[0].innerHTML),s=h.insertRow(i),n(s).height(f.model.rowHeight),n(s).append("<td class='e-rowheader'><\/td>")),e.rowCount=f.model.sheets[t].rowCount+1,e.rowsHeightCollection.push(f.model.rowHeight),f.model.sheets[t].dataSource.push({}),i>-1){for(a=n(h).find("td"),c=0,y=a.length;c<y;c++)n(a[c]).text(c+1);f.XLScroll._getRowHeights(t,i+1)}e._rHeightCollection.push({idx:e.rowCount-1,value:o.rows[e.rowCount-1].offsetTop});e._rowHeightCollection.push({idx:e.rowCount-1,value:e._rowHeightCollection[e._rowHeightCollection.length-1].value+f.model.rowHeight});f.model.allowSelection&&(v._isColSelected||v._isSheetSelected)&&v.refreshSelection()},_createNewColumn:function(i,r,u,f){var e,s,l,o=this.XLObj,h=o.getSheet(i),rt=o.XLSelection,c,p,w,k,ut,v,a,b,d,ft,st,et,ot,g,nt=!1,tt,y,it;for(c=o._getContent(i).find("tbody").get(0),p=o._getJSSheetHeader(i).find("tr").get(0),w=n(c).prev(),k=n(p).parent().prev(),ut=o._generateColCount(n.trim(p.lastChild.textContent)),y=o.model.sheets[i].filterSettings.tableRange,e=0,l=y.length;e<l;e++)if(g=y[e].multifilterIdx,r.colIndex>g[0]&&u.colIndex<g[g.length-1]){nt=!0;tt=y[e].startRow-1;y=y[e];break}if(r.colIndex===-1||r.colIndex>-1&&r.rowIndex>-1&&f==="shift"){if(r.colIndex===-1&&f==="insert"){for(b=this._columnHeaderTemplate(ut+1,i),n(p).append(b),v=this._colGroupTemplate(i),n(k).append(v),e=0,l=c.rows.length;e<l;e++)a=this._columnTemplate(e),n(c.rows[e]).append(a);w.append(v)}if(f==="shift"){for(it=ut,e=r.colIndex;e<=u.colIndex;e++)b=this._columnHeaderTemplate(it+1,i),n(p).append(b),v=this._colGroupTemplate(i),k.append(v),w.append(v),it=it+1;for(e=0,l=c.rows.length;e<l;e++)for(s=r.colIndex;s<=u.colIndex;s++)a=this._columnTemplate(e),n(c.rows[e]).append(a);if(o._insDelStatus.indexOf("insert")>-1)for(e=r.rowIndex;e<=u.rowIndex;e++){for(s=r.colIndex;s<=u.colIndex;s++)n(c).find("tr:eq("+e+") td:last").remove(),a=this._columnTemplate(e),n(c).find("tr").eq(e).find("td:eq("+s+")").before(a);o.model.allowFiltering&&o.XLFilter._insertFilterIcon(e,s,y,tt,nt)}else for(e=r.rowIndex;e<=u.rowIndex;e++){for(s=u.colIndex;s>=r.colIndex;s--)n(c).find("tr:eq("+e+") td:eq("+s+")").remove(),a=this._columnTemplate(e),n(c).find("tr:eq("+e+")").append(a);o.model.allowFiltering&&o.XLFilter._insertFilterIcon(e,s,y,tt,nt)}}h.colCount=h.colCount+1}else{if(o._insDelStatus.indexOf("insert")>-1){for(e=r.colIndex;e<=u.colIndex;e++)b=this._columnHeaderTemplate(e+1,i),n(p).find("th:eq("+e+")").before(b),v=this._colGroupTemplate(i),k.find("col:eq("+e+")").before(v),w.find("col:eq("+e+")").before(v),o._refreshFreezeColumns(i,e,parseInt(w.find("col")[e].style.width),"insert");for(e=0,l=c.rows.length;e<l;e++){for(s=r.colIndex;s<=u.colIndex;s++)a=this._columnTemplate(e),n(c.rows[e]).find("td:eq("+s+")").before(a);o.model.allowFiltering&&o.XLFilter._insertFilterIcon(e,s,y,tt,nt)}h.colCount=h.colCount+1}else{for(e=u.colIndex;e>=r.colIndex;e--)o._refreshFreezeColumns(i,e,parseInt(w.find("col")[e].style.width),"delete"),n(p).find("th:eq("+e+")").remove(),k.find("col:eq("+e+")").remove(),w.find("col:eq("+e+")").remove();for(e=0,l=c.rows.length;e<l;e++)for(s=u.colIndex;s>=r.colIndex;s--)n(c.rows[e]).find("td:eq("+s+")").remove();h.colCount=h.colCount-1}for(ft=n(p).find("th"),e=0,l=ft.length;e<l;e++)n(ft[e]).find(".e-headercelldiv").text(o._generateHeaderText(i,e+1))}st=n.trim(n(b).text());d=n(a).text();o.model.sheets[i].columns.push({field:st,type:d!=null?d.getDay?"date":typeof d:null,width:n(a).width()});et=o.XLEdit._EditTemplate;ot=t.buildTag("div","",{},{id:h.columns[h.columns.length-1].field+"_Edit"});o.XLEdit._initCellEditType(h.columns.length-1,ot,i);et.append(ot);o.XLEdit._EditTemplate=et;h.columnsWidthCollection.push(o.model.columnWidth);h._cWidthCollection.push({idx:h.colCount,value:c.rows[0].cells[h.colCount-1].offsetLeft});h._colWidthCollection.push({idx:h.colCount,value:h._colWidthCollection[h._colWidthCollection.length-1].value+o.model.columnWidth});r.colIndex>-1&&o.XLScroll._getColWidths(i,r.colIndex+1);o.model.allowSelection&&(rt._isRowSelected||rt._isSheetSelected)&&rt.refreshSelection()},_insertColHeaders:function(t,i,r){var f=this._columnHeaderTemplate(i+1,t),u;n(r).append(f);u=this._colGroupTemplate(t);n(r.parentNode.previousSibling).append(u)},_scrollBottom:function(n){this._createNewRow(n,-1,-1,"insert")},_scrollRight:function(n){var t={rowIndex:-1,colIndex:-1};this._createNewColumn(n,t,t,"insert")},_refreshRowCol:function(n,t){t=this.XLObj._getSheetIndex(t);var i,r=this.XLObj.getSheet(t),u=!1;if(r.colCount<n[3]+1){for(i=n[3]-(r.colCount-1);i--;)this._scrollRight(t);u=!0}if(r.rowCount<n[2]+1){for(i=n[2]-(r.rowCount-1);i--;)this._scrollBottom(t);u=!0}u&&this._refreshScroller(t,"refresh","all")}}}(jQuery,Syncfusion)});