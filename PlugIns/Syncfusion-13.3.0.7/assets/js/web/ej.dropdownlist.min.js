/*!
*  filename: ej.dropdownlist.min.js
*  version : 13.3.0.7
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.scroller.min","./ej.checkbox.min"],n):n()})(function(){(function(n,t){t.widget("ejDropDownList","ej.DropDownList",{element:null,model:null,validTags:["select","input"],_ignoreOnPersist:["fields","dataSource","query","create","popupHide","popupShown","beforePopupShown","beforePopupHide","change","select","checkChange","destroy"],_setFirst:!1,_rootCSS:"e-dropdownlist",defaults:{cssClass:"",value:"",htmlAttributes:{},text:"",itemValue:"",itemsCount:0,dataSource:null,delimiterChar:",",query:null,fields:{id:null,text:null,value:null,category:null,groupBy:null,imageUrl:null,imageAttributes:null,spriteCssClass:null,htmlAttributes:null,selected:null,tableName:null},watermarkText:null,height:"",width:"",popupHeight:"152px",popupWidth:"auto",maxPopupHeight:null,minPopupHeight:0,maxPopupWidth:null,minPopupWidth:0,targetID:null,template:null,selectedItemIndex:null,selectedIndex:null,disableItemsByIndex:null,enableItemsByIndex:null,selectedItems:[],selectedIndices:[],cascadeTo:null,enablePopupResize:!1,allowVirtualScrolling:!1,virtualScrollMode:"normal",showRoundedCorner:!1,showPopupOnLoad:!1,enableRTL:!1,enabled:!0,filterType:"contains",sortOrder:"ascending",caseSensitiveSearch:!1,showCheckbox:!1,checkAll:!1,uncheckAll:!1,enablePersistence:!1,enableFilterSearch:!1,enableIncrementalSearch:!0,readOnly:!1,enableAnimation:!1,multiSelectMode:"none",allowGrouping:!1,enableSorting:!1,validationRules:null,validationMessage:null,actionComplete:null,actionFailure:null,actionSuccess:null,create:null,popupHide:null,popupShown:null,beforePopupShown:null,beforePopupHide:null,popupResizeStart:null,popupResize:null,popupResizeStop:null,change:null,select:null,dataBound:null,search:null,checkChange:null,cascade:null,destroy:null},dataTypes:{cssClass:"string",itemsCount:"number",watermarkText:"string",template:"string",disableItemsByIndex:"string",enableItemsByIndex:"string",enableIncrementalSearch:"boolean",cascadeTo:"string",delimiterChar:"string",showRoundedCorner:"boolean",showPopupOnLoad:"boolean",enableRTL:"boolean",enablePersistence:"boolean",allowVirtualScrolling:"boolean",virtualScrollMode:"enum",enabled:"boolean",readOnly:"boolean",multiSelectMode:"enum",dataSource:"data",query:"data",fields:"data",selectedItems:"array",enableAnimation:"boolean",allowGrouping:"boolean",enableSorting:"boolean",validationRules:"data",validationMessage:"data",htmlAttributes:"data"},observables:["value","selectedItemIndex","selectedIndex"],value:t.util.valueFunction("value"),selectedItemIndex:t.util.valueFunction("selectedItemIndex"),selectedIndex:t.util.valueFunction("selectedIndex"),enable:function(){this.element.hasClass("e-disable")&&(this.target.disabled=!1,this.model.enabled=!0,this.element.removeClass("e-disable"),this.dropdownbutton.removeClass("e-disable"),this.popupListWrapper.removeClass("e-disable"),this._isIE8&&this.drpbtnspan.removeClass("e-disable"),this.container.bind("mousedown",n.proxy(this._OnDropdownClick,this)),this.model.multiSelectMode=="visualmode"&&this._ulBox.removeClass("e-disable"))},disable:function(){this.element.hasClass("e-disable")||(this.target.disabled=!0,this.model.enabled=!1,this.element.addClass("e-disable"),this.popupListWrapper.addClass("e-disable"),this.dropdownbutton.addClass("e-disable"),this._isIE8&&this.drpbtnspan.addClass("e-disable"),this.model.multiSelectMode=="visualmode"&&this._ulBox.addClass("e-disable"),this.container.unbind("mousedown",n.proxy(this._OnDropdownClick,this)),this._isPopupShown()&&this._hideResult())},getValue:function(){return this.target.value},_setValue:function(n){n&&(this.unselectItemByText(this.model.text),this.selectItemByValue(n))},_setText:function(n){var i,t,r;if(n)if(this.model.showCheckbox||this.model.multiSelectMode!="none"){for(i=this.model.text.split(this.model.delimiterChar),t=0;t<i.length;t++)this.unselectItemByText(i[t]);for(r=n.split(this.model.delimiterChar),t=0;t<r.length;t++)this.selectItemByText(r[t])}else this.selectItemByText(n)},_setItemValue:function(n){this.model.itemValue=n},_changeWatermark:function(n){if(!this.model.enabled)return!1;this._isWatermark?this.element.attr("placeholder",n):this._hiddenSpan.text(n)},hidePopup:function(){if(!this.model.enabled)return!1;this.ultag.find("li").length>0&&this._hideResult()},showPopup:function(){if(!this.model.enabled)return!1;this.ultag.find("li").length>0&&this._showResult()},clearText:function(){this._clearTextboxValue();this._isWatermark||this._setWatermark()},addItem:function(t){var r,i,u,e,f,o;if(!this.model.enabled||!t||(this._mapFields(),r=n.isArray(t)?t:[t],r.length<1))return!1;if(i=this.mapFld,u={_id:null,_imageUrl:null,_imageAttributes:null,_spriteCSS:null,_text:null,_value:null,_htmlAttributes:null,_selected:null,_category:null},u._id=r[0][i._id]?i._id:"id",u._imageUrl=r[0][i._imageUrl]?i._imageUrl:"imageUrl",u._imageAttributes=r[0][i._imageAttributes]?i._imageAttributes:"imageAttributes",u._spriteCSS=r[0][i._spriteCSS]?i._spriteCSS:"spriteCssClass",u._text=r[0][i._text]?i._text:"text",u._value=r[0][i._value]?i._value:"value",u._htmlAttributes=r[0][i._htmlAttributes]?i._htmlAttributes:"htmlAttributes",u._selected=r[0][i._selected]?i._selected:"selected",u._category=r[0][i._category]?i._category:"groupBy",this._generateLi(r,u),this.ultag.append(this.dummyUl),e=this.dummyUl,this.model.showCheckbox)for(this._addCheckbox(e),f=0;f<e.length;f++)n(e[f]).hasClass("chkselect")&&(n(e[f]).find(".listcheckbox").ejCheckBox({checked:!0}),this._activeItem=f+this.popupListItems.length,this.checkedStatus=!0,this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model}),this._enterTextBoxValue(),n(e[f]).removeClass("chkselect"));for(f=0;f<r.length;f++)this._listItem(r[f],"add");this._renderBoxModel();this._isPopupShown()&&(o=this.scrollerObj?this.scrollerObj.scrollTop():0,this._refreshScroller(),this.scrollerObj&&this.scrollerObj.option("scrollTop",o))},_toArray:function(i,r){var u;return typeof i=="function"&&(i=t.util.getVal(i)),n.isArray(i)?u=i:typeof i=="string"?r&&(this.model.multiSelectMode=="visualmode"||this.model.multiSelectMode=="delimiter"||this.model.showCheckbox)?(u=i.split(this.model.delimiterChar),u.length==0&&(u=[i])):r?u=[i]:(u=i.split(this.model.delimiterChar),u.length==0&&(u=[i])):u=[i],u},selectItemByIndex:function(n){this._selectItemByIndex(n)},selectItemsByIndices:function(n){this._selectItemByIndex(n)},_selectItemByIndex:function(t){var f,i,u,r;for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),this._selectedIndices=n.map(this._selectedIndices,function(n){return parseInt(n)}),this.model.selectedItems=this.model.selectedIndices=this._selectedIndices,f=this._toArray(t,!0),u=0;u<f.length;u++)if(i=parseInt(f[u]),i!=null&&i>=0){if(n.inArray(i,this._selectedIndices)==-1)for(r=0;r<this.listitems.length;r++)n(this.listitems[r]).hasClass("e-disable")||r==i&&(this.selectedIndexValue=r,this._activeItem=i,this._enterTextBoxValue())}else this.model.showCheckbox||this.model.multiSelectMode!="none"||this._clearTextboxValue()},unselectItemsByIndices:function(n){this._unselectItemByIndex(n)},unselectItemByIndex:function(n){this._unselectItemByIndex(n)},_unselectItemByIndex:function(t){var i,u,f,r;for(this._selectedIndices=n.map(this._selectedIndices,function(n){return parseInt(n)}),this.model.selectedItems=this.model.selectedIndices=this._selectedIndices,u=this._toArray(t,!0),this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),r=0;r<u.length;r++)for(f=parseInt(u[r]),i=0;i<this.listitems.length;i++)i==f&&(this.selectedIndexValue=i,this._activeItem=f,this._activeItem==this._aselectedItem&&(this._aselectedItem=null),this._removeTextBoxValue())},setSelectedValue:function(n){this.selectItemByValue(n)},selectItemByValue:function(i){var r,f,u;if(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),t.isNullOrUndefined(i)||i==="")this._clearTextboxValue();else for(f=this._toArray(i,!0),u=0;u<f.length;u++)for(r=0;r<this.listitems.length;r++)if(!n(this.listitems[r]).hasClass("e-disable")&&(this._getAttributeValue(this.listitems[r])||n(this.listitems[r]).text())&&(this._selectedValue=this._getAttributeValue(this.listitems[r])||n(this.listitems[r]).text(),this._selectedValue==n.trim(f[u]))){this._activeItem=r;this._aselectedItem=this._activeItem;this._enterTextBoxValue();break}},unselectItemByValue:function(t){var i,u=this._toArray(t,!0),r;for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),r=0;r<u.length;r++)for(i=0;i<this.listitems.length;i++)if(this._getAttributeValue(this.listitems[i])&&(this._selectedValue=this._getAttributeValue(this.listitems[i]),this._selectedValue==n.trim(u[r]))){this._activeItem=i;this._activeItem==this._aselectedItem&&(this._aselectedItem=null);this._removeTextBoxValue();break}},setSelectedText:function(n){this.selectItemByText(n)},selectItemByText:function(i){var r,f,u;if(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),t.isNullOrUndefined(i)||i==="")this._clearTextboxValue();else for(f=this._toArray(i,!0),u=0;u<f.length;u++)for(r=0;r<this.listitems.length;r++)if(!n(this.listitems[r]).hasClass("e-disable")&&(this.selectedTextValue=this.model.template?this._getField(this.popupListItems[r],this.mapFld._text):n(this.listitems[r]).text(),this.selectedTextValue==n.trim(f[u]))){this._activeItem=r;this._aselectedItem=this._activeItem;this._enterTextBoxValue();break}},unselectItemByText:function(t){var i,u=this._toArray(t,!0),r;for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),r=0;r<u.length;r++)for(i=0;i<this.listitems.length;i++)if(this.unselectedTextValue=this.model.template?this._getField(this.popupListItems[i],this.mapFld._text):n(this.listitems[i]).text(),this.unselectedTextValue==n.trim(u[r])){this._activeItem=i;this._activeItem==this._aselectedItem&&(this._aselectedItem=null);this._removeTextBoxValue();break}},getSelectedValue:function(){return this._hiddenInput.val()},getSelectedItem:function(){var n,t=[];for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),n=0;n<this._selectedIndices.length;n++)t.push(this.listitems[this._selectedIndices[n]]);return t},getListData:function(){return this._rawList},getSelectedItemsID:function(){return this._selectedItemsID},disableItemsByIndices:function(n){this._disableItemByIndex(n)},disableItemByIndex:function(n){this._disableItemByIndex(n)},_disableItemByIndex:function(t){var i,r,u;if(!this.model.enabled)return!1;for(i=this._toArray(t,!1),r=0;r<i.length;r++)i[r]!=null&&i.length>0&&!(n.inArray(parseInt(i[r]),this._disabledItems)>-1)&&(index=n.inArray(i[r],this._disabledItems),u=n(this.ultag.children("li:not('.e-category')")[parseInt(i[r])]).addClass("e-disable"),u.find(".listcheckbox").ejCheckBox("disable"),this._disabledItems.push(parseInt(i[r])),this.model.disableItemsByIndex=String(this._disabledItems.join(",")))},enableItemsByIndices:function(n){this._enableItemByIndex(n)},enableItemByIndex:function(n){this._enableItemByIndex(n)},_enableItemByIndex:function(t){var r=this._toArray(t,!1),u,i,f;for(this.model.enableItemsByIndex=t,i=0;i<r.length;i++)r.length>0&&n.inArray(parseInt(r[i]),this._disabledItems)>-1&&(u=n.inArray(parseInt(r[i]),this._disabledItems),f=n(this.ultag.children("li:not('.e-category')")[parseInt(r[i])]).removeClass("e-disable"),f.find(".listcheckbox").ejCheckBox("enable"),this._disabledItems.splice(u,1));this.model.enableItemsByIndex=null;this.model.disableItemsByIndex=this._disabledItems.join(this.model.delimiterChar)},_validateDelimiter:function(t){if(n.trim(t).length==1)if(!/^[a-zA-Z0-9]+$/.test(t))return t;return","},_removeText:function(t){var i=this.element[0].value.split(this.model.delimiterChar),u=this._hiddenInput[0].value.split(this.model.delimiterChar),r=n.inArray(t,i);r>=0&&(i.splice(r,1),u.splice(r,1));this.element[0].value=i.join(this.model.delimiterChar);this._hiddenInput[0].value=u.join(this.model.delimiterChar)},_addText:function(n){var i,r,t,u;if(this._checkContains(n))return!1;for(i=["element","_hiddenInput"],t=0;t<i.length;t++)r=i[t]=="element"?n:this._hiddenValue,this[i[t]][0].value&&this[i[t]][0].value!=""?(u=this[i[t]][0].value.split(this.model.delimiterChar),u.push(r),this[i[t]][0].value=u.join(this.model.delimiterChar)):this[i[t]][0].value=r},_checkContains:function(n){var r=n,i=this.element[0].value.split(this.model.delimiterChar),t;for(this.contains=!1,t=0;t<i.length;t++)i[t]==r&&(this.contains=!0);return this.contains},_init:function(){var n=t.browserInfo();this._isIE8=n.name=="msie"&&n.version=="8.0"?!0:!1;(this.element.is("input")&&(this.element.is("input[type=text]")||!this.element.attr("type"))||this.element.is("select"))&&(this._isWatermark="placeholder"in document.createElement("input"),this._id=this.element[0].id,this._initialize(),this._render(),this._addAttr(this.model.htmlAttributes),this._enabled(this.model.enabled),this._wireEvents(),this._initValue=!1,this._checkboxValue=!1,this.model.validationRules!=null&&(this._initValidator(),this._setValidation()))},_initValidator:function(){var t=this;this.element.closest("form").validate({ignore:".e-hidden",errorClass:"e-validation-error",errorElement:"span",errorPlacement:function(t,i){n(t).insertAfter(i.closest(".e-widget"))}})},_setValidation:function(){var u,i,r,f;if(this.element.closest("form").length!=0){this._hiddenInput.rules("add",this.model.validationRules);u=this.element.closest("form").validate();name=this._hiddenInput.attr("name");u.settings.messages[name]={};for(i in this.model.validationRules)if(r=null,!t.isNullOrUndefined(this.model.validationRules[i])){if(t.isNullOrUndefined(this.model.validationRules.messages&&this.model.validationRules.messages[i])){u.settings.messages[name][i]=n.validator.messages[i];for(f in this.model.validationMessage)i==f?r=this.model.validationMessage[i]:""}else r=this.model.validationRules.messages[i];u.settings.messages[name][i]=r!=null?r:n.validator.messages[i]}}},_setInitialPopup:function(n){this.model.enabled&&!this.model.readOnly&&(n==!1?this._hideResult():this._showResult())},_changeSkin:function(n){this.wrapper.removeClass(this.model.cssClass).addClass(n);this.popupListWrapper.removeClass(this.model.cssClass).addClass(n)},_setRTL:function(n){this.model.enableRTL!=n&&(this.model.enableRTL=n,this._RightToLeft(),this._dropbtnRTL())},_changeHeight:function(n){this.wrapper.height(n);this._setListHeight()},_changeWidth:function(n){this.wrapper.width(n);this._setListWidth()},_setModel:function(n){var i,f,r,u;for(i in n)switch(i){case"dataSource":this._isEqualDataSource(n[i])||this._checkModelDataBinding(n[i],this.model.query);break;case"query":this._checkModelDataBinding(this.model.dataSource,n[i]);break;case"fields":this.model.fields=n[i];this._checkModelDataBinding(this.model.dataSource,this.model.query);break;case"itemsCount":this.model.itemsCount=n[i];this._checkModelDataBinding(this.model.dataSource,this.model.query);break;case"template":this.model.template=n[i];this._checkModelDataBinding(this.model.dataSource,this.model.query);break;case"value":t.isNullOrUndefined(n[i])||n[i]===""?this._clearTextboxValue():(this._setValue(t.util.getVal(n[i])),n[i]=this.model.value);break;case"delimiterChar":f=this.model.delimiterChar;n[i]=this._validateDelimiter(n[i]);this.model.delimiterChar=n[i];this.element.val(this.model.text.split(f).join(this.model.delimiterChar));this.model.text=this.element.val();break;case"text":t.isNullOrUndefined(n[i])||n[i]===""?this._clearTextboxValue():(this._setText(n[i]),n[i]=this.model.text);break;case"itemValue":this._setItemValue(n[i]);break;case"enableRTL":this._setRTL(n[i]);break;case"enabled":this._enabled(n[i]);break;case"height":this._changeHeight(n[i]);break;case"width":this._changeWidth(n[i]);break;case"popupHeight":this.model.popupHeight=n[i];this._setListHeight(n[i]);break;case"popupWidth":this.model.popupWidth=n[i];this._setListWidth();break;case"minPopupHeight":this.model.minPopupHeight=n[i];this._setListHeight(n[i]);break;case"minPopupWidth":this.model.minPopupWidth=n[i];this._setListWidth();break;case"maxPopupHeight":this.model.maxPopupHeight=n[i];this._setListHeight(n[i]);break;case"maxPopupWidth":this.model.maxPopupWidth=n[i];this._setListWidth();break;case"cssClass":this._changeSkin(n[i]);break;case"showCheckbox":this.model.showCheckbox=n[i];r=this.model.text;u=this.model.text.split(this.model.delimiterChar);this._clearTextboxValue();this._checkboxHideShow(n[i]);this.model.showCheckbox||this.model.multiSelectMode!="none"?(this.model.multiSelectMode=="visualmode"&&this._renderBoxModel(),this._setText(r)):this._setText(u[0]);this._isPopupShown()&&this._setListPosition();break;case"checkAll":return this._setCheckAll(n[i]),!1;case"uncheckAll":return this._setUncheckAll(n[i]),!1;case"watermarkText":this._changeWatermark(n[i]);break;case"validationRules":this.element.closest("form").length!=0&&(this.model.validationRules!=null&&(this._hiddenInput.rules("remove"),this.model.validationMessage=null),this.model.validationRules=n[i],this._setValidation());break;case"validationMessage":this.element.closest("form").length!=0&&(this.model.validationMessage=n[i],this._setValidation());break;case"showRoundedCorner":this._roundedCorner(n[i]);this.model.showRoundedCorner=n[i];break;case"showPopupOnLoad":this._setInitialPopup(n[i]);break;case"targetID":this.model.targetID=n[i];this._showFullList();break;case"selectedItemIndex":case"selectedIndex":this._selectItemByIndex(n[i]);this.model.selectedItemIndex=this.model.selectedIndex=n[i];break;case"unselectItemByIndex":this._unselectItemByIndex(n[i]);break;case"disableItemsByIndex":this._disableItemByIndex(n[i]);break;case"enableItemsByIndex":this._enableItemByIndex(n[i]);break;case"selectedItems":case"selectedIndices":this._selectCheckedItem(n[i]);this.model.selectedItems=this.model.selectedIndices=this._selectedIndices;break;case"multiSelectMode":this.model.multiSelectMode=="visualmode"&&(this._swapUlandInput(!1),this._ulBox.remove());this.model.multiSelectMode=n[i];r=this.model.text;u=this.model.text.split(this.model.delimiterChar);this._clearTextboxValue();this.model.showCheckbox||this.model.multiSelectMode!="none"?(this.model.multiSelectMode=="visualmode"&&this._renderBoxModel(),this._setText(r)):(this._setText(u[0]),this.wrapper.find("input[name="+this._name+"]").remove());this._isPopupShown()&&this._setListPosition();break;case"allowGrouping":this._setGroupingAndSorting("allowGrouping",n[i]);break;case"enableSorting":this._setGroupingAndSorting("enableSorting",n[i]);break;case"htmlAttributes":this._addAttr(n[i]);break;case"enablePopupResize":this.model.enablePopupResize=n[i];n[i]?this._enablePopupResize():this.popupListWrapper.find(".e-resize-handle").remove();break;case"enableFilterSearch":if(n[i]){this.model.enableFilterSearch=!0;this._enableSearch();break}else this._removeSearch()}},_clearTextboxValue:function(){this.element.val("");this._hiddenInput.val("");this.value("");this.model.text=this.selectedTextValue=this._selectedValue=this._hiddenValue="";this.selectedIndexValue=this._hiddenDelimiterIndex=this._activeItem=-1;this._selectedItemsID=[];this._selectedIndices=[];this.model.selectedItems=[];this.selectedIndex(null);this.ultag.children("li").removeClass("e-hover").removeClass("e-active");this.model.showCheckbox&&this.ultag.children("li").find(".listcheckbox").ejCheckBox({checked:!1});this.wrapper.find("ul.e-ul.e-boxes").length!=0&&(this._ulBox.children("li").remove(),this.wrapper.find("input:hidden[id^='#'][name="+this._id+"]").remove(),n(this._hiddenInput).attr("name",this._name))},_destroy:function(){this._destroyDropdown();this.element.removeClass("e-input "+this.model.cssClass);this.element.attr({accesskey:this.wrapper.attr("accesskey"),name:this._hiddenInput.attr("name")});this._isWatermark&&this.element.removeAttr("placeholder");this.element[0].value="";this.model.dataSource||(this.selectOptions?this.docbdy.append(this.selectOptions)&&this.element.remove()&&this.selectOptions.removeClass("e-dropdownlist e-js"):this.docbdy.append(this.ultag.html()));this._hideResult();this.popupPanelWrapper.remove()},_finalize:function(){this.selectedIndex(this.selectedIndex()!=null?this.selectedIndex():this.selectedItemIndex());this.selectedIndex()!=null?this._selectItemByIndex(this.selectedIndex()):this._selectedIndices.length>0&&this._selectCheckedItem(this._selectedIndices);this.model.disableItemsByIndex!=null&&this._disableItemByIndex(this.model.disableItemsByIndex);this.model.enableItemsByIndex!=null&&this._enableItemByIndex(this.model.enableItemsByIndex)},_initialize:function(){this._selectedIndices=this.model.selectedIndices.length>0?this.model.selectedIndices:this.model.selectedItems;this.model.selectedItems=this.model.selectedIndices=this._selectedIndices;this.model.selectedIndex=this.model.selectedIndex!=null?this.model.selectedIndex:this.model.selectedItemIndex;this.element.is("select")&&(this.selectelement=!0,this._renderSelectToDropdown());this._selectedItemsID=[];this.target=this.element[0];this._disabledItems=[];this._queryString=null;this.suggLen=0;this._itemId=null;this.checkedStatus=!1;this._incqueryString="";this._activeItem=null;this.ddWidth=0;this._initValue=!0;this._virtualCount=0},_renderSelectToDropdown:function(){var i,f,u,r;for(this.inputElement=t.buildTag("input.e-dropdownlist#"+this._id+"_input","",{},{type:"text","data-role":"none"}),this.inputElement.insertAfter(this.element),this.optionDiv=t.buildTag("div#"+this._id+"_list"),this.optionDiv.insertAfter(this.inputElement),this.optionUl=t.buildTag("ul"),this.optionDiv.append(this.optionUl),this.element.attr("name")&&(this.inputElement.attr("name",this.element.attr("name")),this.element.removeAttr("name")),this.selectOptions=this.element,this.selectOptions.attr("id",this._id),this.selectOptionItems=this.element.children("option"),f=this.selectOptionItems.length,this.optionDummyUl=n(),i=0;i<f;i++)r=this.selectOptionItems[i],u=n(r).attr("label")?n(r).attr("label"):r.innerHTML,u!=null&&(this.optionLi=t.buildTag("li",u,{},{"data-value":r.value,unselectable:"on"}),this.optionDummyUl.push(this.optionLi[0]),n(r).attr("selected")&&this.model.showCheckbox&&(n.inArray(i,this._selectedIndices)==-1?(this._selectedIndices.push(i),this.model.selectedItems=this.model.selectedIndices=this._selectedIndices):t.isNullOrUndefined(this.selectedIndex())&&this.selectedIndex(i)));this.optionUl.append(this.optionDummyUl);this.element.css("display","none");this.element=this.inputElement},_render:function(){this._renderDropdown();this._setWatermark();this._renderPopupPanelWrapper();this._showFullList();this.model.text&&this.selectItemByText(this.model.text);this.value()==""&&this.element[0].value!==""&&this.value(this.element[0].value);this._setValue(this.value());this._roundedCorner(this.model.showRoundedCorner);t.DataManager&&this.model.dataSource instanceof t.DataManager||this._finalize();this._setCheckAll(this.model.checkAll)},_isEqualDataSource:function(n){var i,t,r;if(!this.model.dataSource||!n||!(this.model.dataSource.length===n.length))return!1;for(i=!0,t=0,r=this.model.dataSource.length;t<r;t++)if(this.model.dataSource[t]!==n[t]){i=!1;break}return i},_checkModelDataBinding:function(n,t){this.element.val("");this._hiddenInput.val("");this.value("");this.model.text=this.selectedTextValue=this._selectedValue=this._hiddenValue="";this.selectedIndexValue=this._hiddenDelimiterIndex=this._activeItem=-1;this._selectedItemsID=[];this._selectedIndices=[];this.model.selectedItems=[];this.model.multiSelectMode=="visualmode"&&this._destroyBoxModel();this.model.dataSource=n;this.model.query=t;this.ultag.empty();this._showFullList()},_initDataSource:function(n){var i=this,r;t.DataManager&&n instanceof t.DataManager&&(i._addLoadingClass(),r=n.executeQuery(this._getQuery()),r.done(function(n){i._trigger("actionSuccess",n);i._totalCount=n.count;i._listItem(n.result);i._removeLoadingClass();i._renderPopupList();i._finalize()}).fail(function(n){i.model.dataSource=null;i._addLoadingClass();i._trigger("actionFailure",n)}).always(function(n){i._trigger("actionComplete",n)}))},_listItem:function(t,i){i=="add"?(this.popupListItems.push(t),this._rawList.push(t)):n.isArray(t)&&(this.popupListItems=t.slice(0),this._rawList=t.slice(0))},_getQuery:function(){var n,i=this.model.fields,r=t.Query(),u,f;if(t.isNullOrUndefined(this.model.query)&&!this.model.template){u=[];for(f in i)f!=="tableName"&&i[f]&&u.push(i[f]);u.length>0&&r.select(u)}else this.model.query&&(r=this.model.query.clone());return this.model.allowVirtualScrolling&&this.model.virtualScrollMode=="normal"&&r.requiresCount(),this.model.itemsCount>0&&r.take(this.model.itemsCount),n=this.model.dataSource.dataSource,(n&&n.url&&!n.url.match(i.tableName+"$")||n&&!n.url||!n)&&(t.isNullOrUndefined(i.tableName)||r.from(i.tableName)),r},_addLoadingClass:function(){this._isPopupShown()?this.popupListWrapper.addClass("e-load"):(this.dropdownbutton.addClass("e-load"),this.drpbtnspan.removeClass("e-icon e-down-arrow"));this.model.readOnly=!0},_removeLoadingClass:function(){this.dropdownbutton.removeClass("e-load");this.drpbtnspan.addClass("e-icon e-down-arrow");this.model.readOnly=!1;this.popupListWrapper.removeClass("e-load")},_renderDropdown:function(){this.element.addClass("e-input "+this.model.cssClass);this.wrapper=t.buildTag("span.e-ddl e-widget "+this.model.cssClass+"#"+this._id+"_wrapper","",{},{tabindex:"0",accesskey:this.element.attr("accesskey")});this.container=t.buildTag("span.e-in-wrap e-box "+this.model.cssClass+"#"+this._id+"_container");this.element.removeAttr("accesskey");this.element.attr({readonly:!0,tabindex:-1,role:"combobox","aria-expanded":!1,"aria-autocomplete":"list","aria-haspopup":!0,"aria-owns":this._id+"_popup"});this.drpbtnspan=t.buildTag("span.e-icon e-down-arrow","",{},{"aria-label":"select",unselectable:"on"});this.dropdownbutton=t.buildTag("span.e-select#"+this._id+"_dropdown","",{},{role:"button",unselectable:"on"}).append(this.drpbtnspan);this.container.insertAfter(this.element);this.container.append(this.element);this.container.append(this.dropdownbutton);this.wrapper.insertBefore(this.container);this.wrapper.append(this.container);this.selectelement&&this.selectOptions.insertBefore(this.element);this._hiddenInput=t.buildTag("input#"+this._id+"_hidden","",{},{type:"hidden"}).insertBefore(this.element);this._isWatermark||(this._hiddenSpan=t.buildTag("span.e-input e-placeholder ").insertAfter(this.element),this._hiddenSpan.text(this.model.watermarkText),this._hiddenSpan.css("display","none"),this._hiddenSpan.bind("mousedown",n.proxy(this._OnDropdownClick,this)));this._checkNameAttr();this._setDimentions();this._RightToLeft();this.ddWidth=this.dropdownbutton.outerWidth()>0?this.dropdownbutton.outerWidth():24;this.container.bind("mousedown",n.proxy(this._OnDropdownClick,this))},_checkNameAttr:function(){this._name=t.isNullOrUndefined(this.element.attr("name"))?this._id:this.element.attr("name");this._hiddenInput.attr("name",this._name)},_addAttr:function(t){var i=this;n.map(t,function(n,t){t=="class"?i.wrapper.addClass(n):t=="required"?i.element.attr(t,n):t=="disabled"&&n=="disabled"?i.disable():t=="readOnly"&&n=="readOnly"?i.model.readOnly=!0:i.wrapper.attr(t,n)})},_renderBoxModel:function(){if(this.model.multiSelectMode!="visualmode")return!1;this._ulBox=t.buildTag("ul.e-ul e-boxes");this.container.prepend(this._ulBox);this._ulBox.css("min-height","30px");this._ulBox.css("display","none");this._on(this.container,"click",function(t){if(!this.model.enabled)return!1;var i=n(t.target);i.hasClass("e-options")&&(!t.ctrlKey&&i.siblings().hasClass("e-active")&&this._removeActive(),i.hasClass("e-active")?i.removeClass("e-active"):i.addClass("e-active"));!t.ctrlKey&&i.hasClass("e-boxes")&&this._removeActive()})},_renderPopupPanelWrapper:function(){var i=n("#"+this.element.context.id+"_popup_wrapper").get(0);i&&n(i).remove();this.popupPanelWrapper=t.buildTag("div#"+this._id+"_popup_wrapper");n("body").append(this.popupPanelWrapper);this.popupListWrapper=t.buildTag("div.e-ddl-popup e-box e-widget  e-popup#"+this._id+"_popup_list_wrapper","",{display:"none",overflow:"hidden"});this.popupList=t.buildTag("div#"+this._id+"_popup",{tabIndex:0});this.popupList.addClass(this.model.cssClass);this.popup=this.popupList;this.popupScroller=t.buildTag("div");this.ultag=t.buildTag("ul.e-ul","",{},{role:"listbox"});this.popupScroller.append(this.ultag);this.popupList.append(this.popupScroller);this.popupListWrapper.append(this.popupList);this.popupPanelWrapper.append(this.popupListWrapper);this.ultag.on({mouseenter:n.proxy(this._OnMouseEnter,this),mouseleave:n.proxy(this._OnMouseLeave,this),click:n.proxy(this._OnMouseClick,this)},"li:not('.e-category')");n(window).on("resize",n.proxy(this._OnWindowResize,this))},_setGroupingAndSorting:function(n,t){var r,u,i;if(this.model[n]=t,r=this.model.text,this.value(""),this._selectedIndices=[],this.ultag.empty(),this._showFullList(),this.model.showCheckbox)for(u=r.split(this.model.delimiterChar),i=0;i<u.length;i++)this.selectItemByText(u[i]);else this.selectItemByText(r)},_setSortingList:function(){var t=document.createElement("ul"),r,i;if(n(t).append(this.itemsContainer.children()),this.model.allowGrouping||n(t).find(">.e-category").length>0)for(this.popupListWrapper.addClass("e-atc-popup"),r=0;r<n(t).find(">.e-category").length;r++)i=n(t).find(">.e-category").eq(0).first().nextUntil(".e-category").get(),this._setSortList(t,i);else n(t).children(">.e-category").remove(),i=n(t).children("li").get(),this._setSortList(t,i);this.itemsContainer=n(t)},_setSortList:function(t,i){i.sort(function(t,i){var r=n(t).text().toUpperCase(),u=n(i).text().toUpperCase();return r<u?-1:r>u?1:0});this.model.sortOrder=="descending"&&i.reverse();(this.model.allowGrouping||n(t).find(">.e-category").length>0)&&(n(t).append(n("<li>").text(n(t).find(">.e-category").eq(0).text()).addClass("e-category")),n(t).find(">.e-category").eq(0).remove());n.each(i,function(i,r){n(t).append(r)})},_renderPopupList:function(){this._doDataBind();this._renderRemaining()},_renderRemaining:function(){var t=this;this._dropbtnRTL();this.model.enableFilterSearch&&this._enableSearch();this.model.enablePopupResize&&this._enablePopupResize();this.model.allowVirtualScrolling&&this.model.virtualScrollMode=="normal"&&this._totalCount&&this._totalCount>0&&(this._totalHeight=this._totalCount*29,this._totalPages=this._totalCount/(this.model.itemsCount*29),this._loadedItemHeight=this.ultag.find("li:not('.e-category')").length*29,this.ultag.find("li:not('.e-category')").attr("page",0),this._virtualPages=[0],this.ultag.append(n("<span>").addClass("e-virtual").css({height:this._totalHeight-this._loadedItemHeight,display:"block"})),this._virtualUl=this.ultag.clone());this._setListWidth();this._setListHeight();this._setListPosition();this.popupScroller.css({height:"",width:""});this.popupList.ejScroller({height:this._getPopupHeight(),width:0,scrollerSize:20,scroll:function(n){t.model.allowVirtualScrolling&&t._onScroll(n)}});this.scrollerObj=this.popupList.ejScroller("instance");this.popupList.find("div.e-scrollbar div").attr("unselectable","on");this.popupListWrapper.css({display:"none",visibility:"visible"});this.model.showCheckbox&&this._checkboxHideShow(this.model.showCheckbox);this._renderBoxModel();this._setUncheckAll(this.model.uncheckAll);this._changeSkin(this.model.cssClass);this.model.showPopupOnLoad&&this._showResult()},_enableSearch:function(){this.model.enableFilterSearch&&(this.inputSearch||(this.inputSearch=t.buildTag("input#"+this._id+"_inputSearch.e-input","",{},{type:"text","data-role":"none"}),this.popupListWrapper.prepend(n("<span>").addClass("e-atc e-search").append(n("<span>").addClass("e-in-wrap ").append(this.inputSearch).append(n("<span>").addClass(" e-icon e-isearch")))),this._on(this.inputSearch,"keyup",this._OnSearchEnter),this._on(this.popupListWrapper.find(".e-isearch"),"mousedown",this._OnSearchEnter)))},_removeSearch:function(){this.model.enableFilterSearch=!1;this.popupListWrapper.find(".e-atc.e-search").remove();this._isPopupShown()&&this.hidePopup();this.inputSearch=null},_OnSearchEnter:function(i){var f=this,e=t.browserInfo().name=="mozilla"?i.charCode:i.keyCode,u,r;if(n.inArray(e,[38,40])!=-1)this._OnKeyDown(i);else if(n.inArray(e,[13])!=-1&&this.popupList.find("li").length>0)this._OnKeyUp(i);else{if(this._queryString=this.inputSearch.val(),this._queryString==""&&this.model.allowVirtualScrolling&&this.model.virtualScrollMode=="normal"&&this._virtualUl)return this.ultag.empty().append(this._virtualUl.children().clone()),this._setText(this.getValue()),this._renderBoxModel(),this._refreshScroller(),!1;this._mapFields();u=this._addSearchQuery(t.Query(),!this._isPlainType(this._rawList));r={searchString:this._queryString,items:this._rawList};this._trigger("search",r)?window.setTimeout(function(){f._filterSearch(u,r)},1e3):f._filterSearch(u,r)}},_filterSearch:function(n,i){var r=i.result?i.result:t.DataManager(this._rawList).executeLocal(n);this.popupListItems=r;this.ultag.empty();this._isPlainType(this.popupListItems)?this._plainArrayTypeBinding(r):this._objectArrayTypeBinding(r,"search");this.model.showCheckbox&&this._addCheckbox(this.ultag.children("li:not('.e-category')"));this._setText(this.getValue());this._refreshScroller();this._setListPosition()},_addSearchQuery:function(n,t){var r="",i;return t&&(i=this.model.fields,r=i&&i.text?i.text:"text"),this._queryString&&n.where(r,this.model.filterType,this._queryString,!this.model.caseSensitiveSearch),this.model.itemsCount>0&&n.take(this.model.itemsCount),n},_targetElementBinding:function(){var u=this.element.parents().last(),t,r,i;if(this.docbdy=this.model.targetID?u.find("#"+this.model.targetID):this.optionDiv?this.optionDiv:!1,!this.docbdy)return!1;if(this.itemsContainer=this.docbdy[0].nodeName=="UL"?this.docbdy:this.docbdy.children("ol,ul"),(this.model.allowGrouping||this.itemsContainer.find(">.e-category").length>0)&&!this.model.enableSorting)for(this.popupListWrapper.addClass("e-atc-popup"),t=0;t<this.itemsContainer.find(">.e-category").length;t++)r=this.itemsContainer.find(">.e-category").eq(t),r.replaceWith(n("<li>").text(r.text()).addClass("e-category"));else this.model.enableSorting&&this._setSortingList();for(this.itemsContainer.children("ol,ul").remove(),this.items=this.itemsContainer.children("li"),this.items.children("img,div").addClass("e-align"),this._listItem([]),i=0;i<this.items.length;i++)this._listItem({text:n(this.items[i]).text()},"add");this.ultag.empty().append(this.itemsContainer.children());this.ultag.children("li").attr({role:"option",unselectable:"on"});this.docbdy.css({display:"none"}).children("ol,ul").remove()},_plainArrayTypeBinding:function(i){if(this.dummyUl=n(),this.model.enableSorting&&(i.sort(),this.model.sortOrder=="descending"&&i.reverse()),i.length>0){for(var r=0;r<i.length;r++)t.isNullOrUndefined(i[r])||(litag=t.buildTag("li",i[r],{},{"data-value":i[r],unselectable:"on"}),this.dummyUl.push(litag[0]));this.ultag.append(this.dummyUl);this._trigger("dataBound",{data:i})}},_mapFields:function(){this.model.fields.groupBy=this.model.fields.groupBy?this.model.fields.groupBy:this.model.fields.category;var n=this.model.fields;this.mapFld={_id:null,_imageUrl:null,_imageAttributes:null,_spriteCSS:null,_text:null,_value:null,_htmlAttributes:null,_selected:null};this.mapFld._id=n&&n.id?n.id:"id";this.mapFld._imageUrl=n&&n.imageUrl?n.imageUrl:"imageUrl";this.mapFld._imageAttributes=n&&n.imageAttributes?n.imageAttributes:"imageAttributes";this.mapFld._spriteCSS=n&&n.spriteCssClass?n.spriteCssClass:"spriteCssClass";this.mapFld._text=n&&n.text?n.text:"text";this.mapFld._value=n&&n.value?n.value:"value";this.mapFld._htmlAttributes=n&&n.htmlAttributes?n.htmlAttributes:"htmlAttributes";this.mapFld._selected=n&&n.selected?n.selected:"selected";this.mapFld._category=n&&n.groupBy?n.groupBy:"groupBy"},_doDataBind:function(){var t=this.model.dataSource,n=this.popupListItems;!t||!n||!n.length||n.length<1?this._targetElementBinding():this._isPlainType(n)?this._plainArrayTypeBinding(n):this._objectArrayTypeBinding(n)},_isPlainType:function(n){return typeof n[0]!="object"},_objectArrayTypeBinding:function(i,r){var s,h,u,o,f,e;if(this.dummyUl=n(),this._mapFields(),this.model.enableSorting&&(s=t.Query().sortBy(this.mapFld._text,this.model.sortOrder,!0),i=t.DataManager(i).executeLocal(s)),this.model.allowGrouping||this.model.fields.groupBy)for(this.popupListWrapper.addClass("e-atc-popup"),h=this.mapFld._category,o=t.Query().group(h),this.model.enableSorting||o.queries.splice(0,1),u=t.DataManager(i).executeLocal(o),this._swapUnCategorized(u),r=="search"?this.popupListItems=[]:this._listItem([]),f=0;f<u.length;f++)for(u[f].key&&this.ultag.append(t.buildTag("li.e-category",u[f].key).attr("role","option")[0]),this._generateLi(u[f].items,this.mapFld),this.ultag.append(this.dummyUl),e=0;e<u[f].items.length;e++)r=="search"?this.popupListItems.push(u[f].items[e]):this._listItem(u[f].items[e],"add");else this._generateLi(i,this.mapFld),this.ultag.append(this.dummyUl);this._trigger("dataBound",{data:i})},_onScroll:function(i){var f,r,e,o,u;i.scrollTop&&(f=i.scrollTop,r=this,r.model.allowVirtualScrolling&&r.model.virtualScrollMode=="continuous"?(u=t.Query().skip(r._rawList.length).take(r.model.itemsCount).clone(),f>=n(r.popupList).find("ul,ol").height()-n(r.popupList).height()&&(r._addLoadingClass(),t.DataManager&&r.model.dataSource instanceof t.DataManager?(u=r._getQuery().skip(r._rawList.length).take(r.model.itemsCount).clone(),o=r.model.dataSource.executeQuery(u),o.done(function(n){r.addItem(n.result);r._removeLoadingClass();r._trigger("actionSuccess",n)}).fail(function(){r.model.dataSource=null;r._removeLoadingClass();r._trigger("actionFailure",i)}).always(function(n){r._trigger("actionComplete",n)})):(e=t.DataManager(r.model.dataSource).executeLocal(u),r.addItem(e),r._removeLoadingClass()))):r.model.allowVirtualScrolling&&r.model.virtualScrollMode=="normal"&&window.setTimeout(function(){r._virtualCount==0&&r._loadList()},300))},_loadList:function(){var r,h,u,c,l,a;this._virtualCount++;var v=this.scrollerObj.scrollTop(),i=this,o=0,f,s=null;if(this._currentPage=Math.round(v/(29*this.model.itemsCount)),n.inArray(this._currentPage,this._virtualPages.sort(function(n,t){return n-t}))!=-1)if(this._currentPage==0){if(n.inArray(this._currentPage+1,this._virtualPages)!=-1)return this._virtualCount--,!1;this._currentPage=this._currentPage+1}else if(n.inArray(this._currentPage-1,this._virtualPages)!=-1){if(n.inArray(this._currentPage+1,this._virtualPages)!=-1)return this._virtualCount--,!1;this._currentPage=this._currentPage+1}else this._currentPage=this._currentPage-1;for(f=!(n.inArray(this._currentPage-1,this._virtualPages)!=-1),this._addLoadingClass(),r=this._virtualPages.length-1;r>=0;r--)if(this._virtualPages[r]<this._currentPage){o=this._virtualPages[r];r+1==this._virtualPages.length||(s=this._virtualPages[r+1]);break}if(h=f?(this._currentPage-1)*this.model.itemsCount:this._currentPage*this.model.itemsCount,u=t.Query().range(h,this._currentPage*this.model.itemsCount+this.model.itemsCount),t.DataManager&&i.model.dataSource instanceof t.DataManager){if(a=f?(this._currentPage-1)*this.model.itemsCount:this._currentPage*this.model.itemsCount,u=this._getQuery().skip(a),f){for(r=0;r<u.queries.length;r++)if(u.queries[r].fn=="onTake"){u.queries.splice(r,1);break}u.take(2*this.model.itemsCount)}c=i.model.dataSource.executeQuery(u);c.done(function(n){i._appendVirtualList(n.result,o,i._currentPage,s,f);i._removeLoadingClass();i._trigger("actionSuccess",n)}).fail(function(){i._virtualCount--;i._removeLoadingClass();i._trigger("actionFailure",e)}).always(function(n){i._trigger("actionComplete",n)})}else l=t.DataManager(i.model.dataSource).executeLocal(u),this._appendVirtualList(l,o,this._currentPage,s,f),i._removeLoadingClass()},_appendVirtualList:function(t,i,r,u,f){var e,s,c,o,l,h;if(this._virtualCount--,n.inArray(r,this._virtualPages.sort(function(n,t){return n-t}))!=-1)return!1;for(f&&n.inArray(r-1,this._virtualPages.sort())!=-1&&(t.splice(0,this.model.itemsCount),f=!1),e=this.model.itemsCount,s=n("<ul>"),c=f?(r-1)*e*29-(i*e+e)*29:r*e*29-(i*e+e)*29,c!=0&&s.append(n("<span>").addClass("e-virtual").css({display:"block",height:c})),this._mapFields(),this._generateLi(t,this.mapFld),n(this.dummyUl).attr("page",r),f&&n(this.dummyUl).slice(0,e).attr("page",r-1),this.model.showCheckbox&&this._addCheckbox(this.dummyUl),s.append(this.dummyUl),o=(r*e+e)*29,o=u!=null?u*e*29-o:this.ultag.height()-o,o!=0&&s.append(n("<span>").addClass("e-virtual").css({display:"block",height:o})),l=this.ultag.find("li[page="+i+"]").last(),l.next().remove(),s.children().insertAfter(l),this._virtualPages.push(r),f&&this._virtualPages.push(r-1),h=0;h<t.length;h++)this._listItem(t[h],"add");this._virtualUl=this.ultag.clone();this._renderBoxModel()},_generateLi:function(i,r){var u,o,v;if(this.mapFld=r,this.dummyUl=[],!i||!i.length||i.length<1)return!1;for(u=0;u<i.length;u++){var y=this._getField(i[u],this.mapFld._id),h=this._getField(i[u],this.mapFld._imageUrl),c=this._getField(i[u],this.mapFld._imageAttributes),l=this._getField(i[u],this.mapFld._spriteCSS),s=this._getField(i[u],this.mapFld._text),e=this._getField(i[u],this.mapFld._value),a=this._getField(i[u],this.mapFld._htmlAttributes),p=this._getField(i[u],this.mapFld._selected),f=document.createElement("li");!t.isNullOrUndefined(e)&&e.toString().length>0&&f.setAttribute("data-value",typeof e=="object"?JSON.stringify(e):e);y&&f.setAttribute("id",y);a&&a!=""&&this._setAttr(f,a);this.model.template?n(f).append(this._getTemplatedString(i[u])):(h&&h!=""&&(o=document.createElement("img"),this._setClass(o,"e-align")._setAttr(o,{src:h,alt:s}),c&&c!=""&&this._setAttr(o,c),f.appendChild(o)),l&&l!=""&&(v=document.createElement("div"),this._setClass(v,"div.e-align "+l+" sprite-image"),f.appendChild(v)),s&&s!=""&&(f.innerHTML+=s),p&&this._setClass(f,"chkselect"));this._setAttr(f,{role:"option",unselectable:"on"});this.dummyUl.push(f)}},_setAttr:function(n,t){var r,i,u;if(typeof t=="string")r=t.replace(/['"]/g,"").split("="),r.length==2&&n.setAttribute(r[0],r[1]);else for(i in t)if((i=="styles"||i=="style")&&typeof t[i]=="object")for(u in t[i])n.style[u]=t[i][u];else n.setAttribute(i,t[i]);return this},_setClass:function(n,t){return n.className+=" "+t,this},_swapUnCategorized:function(t){n(t).each(function(n,i){if(!i.key){for(var r=n;r>0;r--)t[r]=t[r-1];return t[r]=i,!1}})},_getField:function(n,i){return t.pvt.getObject(i,n)},_getTemplatedString:function(n){for(var t=this.model.template,i=t.indexOf("${"),r=t.indexOf("}"),u,f;i!=-1&&r!=-1;)u=t.substring(i,r+1),f=u.replace("${","").replace("}",""),t=t.replace(u,this._getField(n,f)),i=t.indexOf("${"),r=t.indexOf("}");return t},_setWatermark:function(){this.model.watermarkText!=null&&this.element.val()==""&&n.trim(this._hiddenInput.val())==""&&(this._isWatermark?this.element.attr("placeholder",this.model.watermarkText):this._hiddenSpan.css("display","block").text(this.model.watermarkText),this.model.multiSelectMode=="visualmode"&&this._ulBox&&this._ulBox.find("li").length==0&&this._swapUlandInput(!1))},_checkboxHideShow:function(n){if(n){this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')");var t=this.listitems.find("input[type=checkbox]");t.length==0&&this._createCheckbox(this.listitems)}else this._removeCheckbox();this.model.showCheckbox=n},_createCheckbox:function(t){for(this._addCheckbox(t),this.element.val(""),this._setWatermark(),i=0;i<t.length;i++)n(t[i]).hasClass("chkselect")&&(n(t[i]).find(".listcheckbox").ejCheckBox({checked:!0}),this._activeItem=i,this.checkedStatus=!0,this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model}),this._enterTextBoxValue(),n(t[i]).removeClass("chkselect"))},_addCheckbox:function(t){for(var u,r,i=0;i<t.length;i++)u=!0,r=document.createElement("input"),this._setAttr(r,{type:"checkbox",name:"list"+i,"data-role":"none",id:this._id+"_check"+i})._setClass(r,"listcheckbox e-align"),t[i].insertBefore(r,t[i].childNodes[0]),n.inArray(i,this._disabledItems)!=-1&&(u=!1),n(r).ejCheckBox({cssClass:this.model.cssClass,enabled:u,change:n.proxy(this._OnClickCheckList,this)});this.popupList.find("span.e-chkbox-wrap,div.e-chkbox-small,span.e-chk-inact,span.e-chk-image").attr("unselectable","on")},_removeCheckbox:function(){var n;this.listitems=this.popupList.find("ol,ul").children("li");n=this.listitems.find(".listcheckbox");n.length>0&&(this.listitems.find(".listcheckbox").ejCheckBox("destroy"),this.listitems.find("input[type=checkbox]").remove())},_setCheckAll:function(n){(this.model.showCheckbox||!this.model.showCheckbox&&this.model.multiSelectMode!="none")&&n?this.checkAll():this.model.checkAll=!1},_setUncheckAll:function(n){(this.model.showCheckbox||!this.model.showCheckbox&&this.model.multiSelectMode!="none")&&n?this.uncheckAll():this.model.uncheckAll=!1},checkAll:function(){var r=this._selectedIndices;for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),this._isWatermark||this._hiddenSpan.css("display","none"),i=0;i<this.listitems.length;i++)n(this.listitems[i]).hasClass("e-disable")||n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("isChecked")!=!1&&(this.model.showCheckbox||this.model.multiSelectMode=="none"||n(this.listitems[i]).hasClass("e-active"))||(n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this.currentValue=this.model.template?this._getField(this.popupListItems[i],this.mapFld._text):n.trim(n(this.listitems[i]).text()),this._itemID=n(this.listitems[i]).attr("id"),t.isNullOrUndefined(this._itemID)||this._itemID==""||this._selectedItemsID.push(this._itemID),this._hiddenValue=this._getAttributeValue(this.listitems[i])||this.currentValue,this.checkedStatus=!0,this._createListHidden(this._hiddenValue,i),this.model.multiSelectMode=="visualmode"&&(this._ulBox.append(this._createBox(this.currentValue)),this._isPopupShown()&&this._setListPosition()),this.model.showCheckbox||this.model.multiSelectMode=="none"||n(this.listitems[i]).addClass("e-active"),this._addText(this.currentValue),n.inArray(i,r)==-1&&(this._selectedIndices.push(i),this.model.selectedItems=this.model.selectedIndices=this._selectedIndices),this._selectedValue=this._getAttributeValue(this.listitems[i])||"",this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model}),args={text:this.element[0].value,selectedText:this.currentValue,itemId:i,selectedValue:this._selectedValue,value:this._selectedValue,isChecked:this.checkedStatus},this._initValue||this._trigger("change",args),this._activeItem=i,this.activeItem=this._getActiveItem(),this._cascadeAction());this.value(this._hiddenInput.val());this.model.text=this.element.val();this.model.itemValue=this._selectedValue;this.model.uncheckAll=!1;this.model.checkAll=!0;this._setWatermark()},_createListHidden:function(t,i){var r=document.createElement("input");this._setAttr(r,{type:"hidden",name:this._name,value:t,id:"#"+t+i});n("#"+this._id+"_container").append(r);n(this._hiddenInput).attr("name","hiddenEle")},_removeListHidden:function(t,i){var r=document.getElementById("#"+t+i);n(r).remove()},_getAttributeValue:function(n){return n?n.getAttribute("data-value")||n.getAttribute("value"):null},_selectSingleItem:function(t){this.currentValue=n.trim(n(this.listitems[t]).text());this._hiddenValue=this._getAttributeValue(this.listitems[t])||this.currentValue;this._addText(this.currentValue);this._selectedValue=this._getAttributeValue(this.listitems[t])||"";this.value(this._hiddenInput.val());this.model.itemValue=this._selectedValue;this.model.text=this.element.val();this.model.showCheckbox||n(this.listitems[t]).addClass("e-active")},_selectCheckedItem:function(t){var i,r;if(t.length>0){if(this._isWatermark||this._hiddenSpan.css("display","none"),this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),!this.listitems.length>0)return!1;for(i=0;i<t.length;i++)this.listitems.length>t[i]&&(n(this.listitems[t[i]].firstChild).find(".listcheckbox").ejCheckBox("isChecked")!=!1&&(this.model.showCheckbox||this.model.multiSelectMode=="none"||n(this.listitems[t[i]]).hasClass("e-active"))||(n(this.listitems[t[i]].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this.checkedStatus=!0,this.model.multiSelectMode=="visualmode"&&this._ulBox.append(this._createBox(n.trim(n(this.listitems[t[i]]).text()))),this._selectSingleItem(t[i]),this._createListHidden(this._hiddenValue,t[i]),n.inArray(t[i],this._selectedIndices)==-1&&(this._selectedIndices.push(t[i]),this.model.selectedItems=this.model.selectedIndices=this._selectedIndices),this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model}),r={text:this.element[0].value,selectedText:this.currentValue,itemId:this.selectedIndexValue,selectedValue:this._selectedValue,value:this._selectedValue,isChecked:this.checkedStatus},this._initValue||this._trigger("change",r),this._cascadeAction()));this.model.showCheckbox||this.model.multiSelectMode!="none"||n(this.listitems[t[i]]).hasClass("e-active")||(this._selectSingleItem(t[0]),this._selectedIndices[0]=t[0],r={text:this.element[0].value,selectedText:this.currentValue,itemId:this.selectedIndexValue,value:this._selectedValue,selectedValue:this._selectedValue},this._initValue||this._trigger("change",r),this._cascadeAction());this._setWatermark()}},unCheckAll:function(){this.uncheckAll()},uncheckAll:function(){for(this.listitems=this.popupList.find("ol,ul").children("li:not('.e-category')"),i=0;i<this.listitems.length;i++){(n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("isChecked")||!this.model.showCheckbox&&this.model.multiSelectMode!="none"&&n(this.listitems[i]).hasClass("e-active"))&&(n(this.listitems[i].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!1),this.currentValue=this.model.template?this._getField(this.popupListItems[i],this.mapFld._text):n.trim(n(this.listitems[i]).text()),this._hiddenValue=this._getAttributeValue(this.listitems[i])||this.currentValue,this.model.multiSelectMode=="visualmode"&&(this._deleteBoxCheck(this.currentValue),this._isPopupShown()&&this._setListPosition()),this.model.showCheckbox||this.model.multiSelectMode=="none"||n(this.listitems[i]).removeClass("e-active"),this._activeItem=i,this.activeItem=this._getActiveItem(),this._removeText(this.currentValue),this._removeListHidden(this._hiddenValue,i));this.checkedStatus=!1;var r=this._selectedIndices;n.inArray(i,r)>-1&&(this._selectedIndices.splice(n.inArray(i,r),1),this.model.selectedItems=this.model.selectedIndices=this._selectedIndices);this._selectedValue=this._getAttributeValue(this.listitems[i])||"";this._itemID=n(this.listitems[i]).attr("id");t.isNullOrUndefined(this._itemID)||this._itemID==""||this._removeSelectedItemsID();this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model});args={text:this.element[0].value,selectedText:this.currentValue,itemId:i,selectedValue:this._selectedValue,value:this._selectedValue,isChecked:this.checkedStatus};this._initValue||this._trigger("change",args);this._cascadeAction()}this.value(this._hiddenInput.val());this.model.text=this.element.val();this.model.itemValue=this._selectedValue;this.model.checkAll=!1;this.model.uncheckAll=!0;this._setWatermark()},_removeSelectedItemsID:function(){var n;n=this._selectedItemsID.indexOf(this._itemID);this._selectedItemsID.splice(n,1);this._itemID=""},_refreshScroller:function(){this.popupList.find(".e-content, .e-vhandle").removeAttr("style");this.popupList.find(".e-vhandle div").removeAttr("style");this.popupList.children(".e-content").removeClass("e-content");this.model.enablePopupResize||(this.popupList.css("height","auto"),this.popupListWrapper.css("height","auto"));var n=this._isPopupShown();this.popupListWrapper.css("display","block");this.popupList.css({display:"block"});this.scrollerObj.model.height=this._getPopupHeight();this.scrollerObj.refresh();this.scrollerObj.option("scrollTop",0);n||this.popupListWrapper.css("display","none")},_enablePopupResize:function(){this.model.enablePopupResize&&(this.popupListWrapper.addClass("e-resizable").append(t.buildTag("div.e-icon e-resize-handle")).find(".e-resize-handle").addClass(this.model.enableRTL?"e-rtl-resize":""),this._resizePopup())},_resizePopup:function(){var t=this,i=!1;this.popupListWrapper.find("div.e-resize-handle").ejResizable({minHeight:t.model.minPopupHeight,minWidth:t.model.minPopupWidth,maxHeight:t.model.maxPopupHeight,maxWidth:t.model.maxPopupWidth,handle:"e-ddl-popup",resizeStart:function(n){if(!t.model.enabled)return!1;i||t._trigger("popupResizeStart",{event:n});i=!0},resize:function(i){var r=n(i.element).parents("div.e-ddl-popup");t._refreshPopupOnResize(n(r).outerHeight(),n(r).outerWidth());t._trigger("popupResize",{event:i})},resizeStop:function(n){i&&(t._refreshPopupOnResize(t.model.popupHeight,t.model.popupWidth),i&&t._trigger("popupResizeStop",{event:n}),i=!1)},helper:function(i){var r=n(i.element).parents("div.e-ddl-popup");return t._refreshPopupOnResize(n(r).outerHeight(),n(r).outerWidth()),n(t.popupListWrapper)}})},_refreshPopupOnResize:function(n,t){n&&(this.model.popupHeight=n);t&&(this.model.popupWidth=t);this.popupListWrapper.css({height:this.model.popupHeight,"min-height":this.model.minPopupHeight,"max-height":this.model.maxPopupHeight});this._setListWidth();this._refreshScroller()},_setListWidth:function(){var n=this.model.popupWidth;n!="auto"?this.popupListWrapper.css({width:n}):this.popupListWrapper.css({"min-width":this.model.minPopupWidth});this.popupListWrapper.css({"max-width":this.model.maxPopupWidth})},_setListHeight:function(){this.model.enablePopupResize?this.popupListWrapper.css({"min-height":this.model.minPopupHeight,"max-height":this.model.maxPopupHeight,height:this.model.popupHeight}):this.popupListWrapper.css({"max-height":this.model.popupHeight,"min-height":this.model.minPopupHeight})},_getPopupHeight:function(){var t=this.popupListWrapper.height(),n;return this.model.enablePopupResize&&(t-=this.popupListWrapper.find(">div.e-resize-handle").height()),this.model.enableFilterSearch&&this.inputSearch&&(n=this.inputSearch.parent(".e-in-wrap"),t-=parseInt(n.css("height"))+parseInt(n.css("margin-top"))+parseInt(n.css("margin-bottom"))),t},_refreshPopup:function(){this.model.popupWidth=="auto"&&this.popupListWrapper.css({"min-width":this.wrapper.width()});this._refreshScroller();this._setListPosition()},_setListPosition:function(){var t=this.wrapper,i=this._getOffset(t),f,h=n(document).scrollTop()+n(window).height()-(i.top+n(t).outerHeight()),c=i.top-n(document).scrollTop(),u=this.popupListWrapper.outerHeight(),e=this.popupListWrapper.outerWidth(),r=i.left,o=t.outerHeight(),l=(o-t.height())/2,a=this._getZindexPartial(),s=3,v=(u<h||u>c?i.top+o+s:i.top-u-s)-l;f=n(document).scrollLeft()+n(window).width()-r;(this.model.enableRTL||e>f&&e<r+t.outerWidth())&&(r-=this.popupListWrapper.outerWidth()-t.outerWidth());this.popupListWrapper.css({left:r+"px",top:v+"px","z-index":a})},_getOffset:function(n){return t.util.getOffset(n)},_getZindexPartial:function(){return t.util.getZindexPartial(this.element,this.popupList)},_showResult:function(){var i=this;this._trigger("beforePopupShown",{text:this.element[0].value,value:this._selectedValue})||(this._refreshPopup(),n(this.popupListWrapper).slideDown(this.model.enableAnimation?200:1,"easeOutQuad",function(){n(document).on("mousedown",n.proxy(i._OnDocumentClick,i));i._on(t.getScrollableParents(i.wrapper),"scroll",i._hideResult)}),this.element[0].setAttribute("aria-expanded",!0),this._listSize=this.ultag.children("li:not('.e-category')").size(),this._trigger("popupShown",{text:this.element[0].value,value:this._selectedValue}),this.scrollerObj.setModel({scrollTop:this._calcScrollTop("active")}))},_OnWindowResize:function(){!t.isNullOrUndefined(this.model)&&this._isPopupShown()&&this._refreshPopup()},_hideResult:function(){if(this.model&&this._isPopupShown()){var i=this;if(this._trigger("beforePopupHide",{text:this.element[0].value,value:this._selectedValue}))return;n(this.popupListWrapper).slideUp(this.model.enableAnimation?100:0,"easeOutQuad",function(){n(document).off("mousedown",n.proxy(i._OnDocumentClick,i))});this.element!=null&&this.element.attr({"aria-expanded":!1});this._off(t.getScrollableParents(this.wrapper),"scroll",this._hideResult);this.element!=null&&this._trigger("popupHide",{text:this.element[0].value,value:this._selectedValue})}},_isPopupShown:function(){return this.popupListWrapper.css("display")=="block"},_enterTextBoxValue:function(){var t,i,r;this.removeID=!1;this._isWatermark||this._hiddenSpan.css("display","none");this._chooseSelectionType();t={text:this.currentValue,selectedText:this.currentValue,itemId:this.selectedIndexValue,value:this._selectedValue,isChecked:this.checkedStatus};this._initValue||this._trigger("select",t);!this.selectedIndexValue!=this._activeItem&&(this.model.multiSelectMode!="none"||this.model.showCheckbox?this._checkContains(this.currentValue)?(this._removeTextBoxValue(),this._removeListHidden(this._hiddenValue,this.selectedIndexValue),this._selectedIndices!=null&&(r=this._selectedIndices.indexOf(this.selectedIndexValue),this._selectedIndices.splice(r,1),this.model.selectedItems=this.model.selectedIndices=this._selectedIndices)):(this.model.showCheckbox&&this.activeItem.find(".listcheckbox").ejCheckBox("isChecked")==!1&&(this.activeItem.find(".listcheckbox").ejCheckBox("option","checked",!0),this.checkedStatus=!0),this.model.multiSelectMode=="visualmode"&&(this._ulBox.append(this._createBox(this.currentValue)),this._isPopupShown()&&this._setListPosition()),this.model.showCheckbox||this.activeItem.addClass("e-active"),this._maintainHiddenValue(),this._addText(this.currentValue),this._createListHidden(this._hiddenValue,this.selectedIndexValue),i=this._selectedIndices,n.inArray(this.selectedIndexValue,i)==-1&&(this._selectedIndices.push(this.selectedIndexValue),this.model.selectedItems=this.model.selectedIndices=this._selectedIndices)):(this.ultag.children("li").removeClass("e-hover").removeClass("e-active"),this.activeItem.addClass("e-active"),this.element.val(this.currentValue),this._maintainHiddenValue(),this._hiddenInput.val(this._hiddenValue),this.selectedItemIndex(this.selectedIndexValue),this.selectedIndex(this.selectedIndexValue),this._selectedIndices[0]=this.selectedIndexValue),t={text:this.element[0].value,selectedText:this.currentValue,itemId:this.selectedIndexValue,selectedValue:this._selectedValue,value:this._selectedValue,isChecked:this.checkedStatus},this._initValue||this._trigger("change",t),this._cascadeAction(),this.value(this._hiddenInput.val()),this.model.itemValue=this._selectedValue,this.model.text=this.element.val(),this.selectelement&&n("#"+this._id).children().length>this.selectedIndexValue&&(n("#"+this._id).children()[this.selectedIndexValue].selected=!0));this.model.uncheckAll=!1;this._setWatermark()},_chooseSelectionType:function(){this.activeItem=this._getActiveItem();this.selectedIndexValue=this._activeItem;this._mapFields();this.model.dataSource!=null&&typeof this.model.dataSource[0]=="object"?(this.currentValue=n.trim(this._getField(this.popupListItems[this._activeItem],this.mapFld._text)),this.currentValue=this.currentValue==""?n.trim(this.activeItem.text()):this.currentValue,this.hidelement=this._getField(this.popupListItems[this._activeItem],this.mapFld._value),this._selectedValue=this.hidelement,this._itemID=this._getField(this.popupListItems[this._activeItem],this.mapFld._id)):(this.currentValue=n.trim(this.activeItem.text()),this._getAttributeValue(this.activeItem[0])?this._selectedValue=this._getAttributeValue(this.activeItem[0]):this.currentValue!=null?(this.activeItem[0].setAttribute("value",this.currentValue),this._selectedValue=this.currentValue):this._selectedValue="",this._itemID=n(this.activeItem).attr("id"));t.isNullOrUndefined(this._itemID)||this._itemID==""||(this.model.showCheckbox?this.removeID?this._removeSelectedItemsID():this._selectedItemsID.push(this._itemID):(this._selectedItemsID=[],this.removeID||this._selectedItemsID.push(this._itemID)));this.selectedTextValue=this.currentValue},_maintainHiddenValue:function(){this._hiddenValue=this._getAttributeValue(this.activeItem[0])||this.currentValue},_removeTextBoxValue:function(){if(this.removeID=!0,this._chooseSelectionType(),this._maintainHiddenValue(),this._removeText(this.currentValue),this._removeListHidden(this._hiddenValue,this.selectedIndexValue),this.activeItem.removeClass("e-active"),this.model.showCheckbox&&this.activeItem.find(".listcheckbox").ejCheckBox("isChecked")==!0&&(this.activeItem.find(".listcheckbox").ejCheckBox("option","checked",!1),this.checkedStatus=!1),this.model.multiSelectMode!="none"||this.model.showCheckbox){var t=this._selectedIndices;n.inArray(this.selectedIndexValue,t)>-1&&(this._selectedIndices.splice(n.inArray(this.selectedIndexValue,t),1),this.model.selectedItems=this.model.selectedIndices=this._selectedIndices);this.model.multiSelectMode=="visualmode"&&(this._deleteBoxCheck(this.currentValue),this._isPopupShown()&&this._setListPosition())}this.model.cascadeTo!=null&&this.model.showCheckbox&&this._cascadeAction();args={text:this.currentValue,selectedText:this.currentValue,itemId:this.selectedIndexValue,value:this._selectedValue,isChecked:this.checkedStatus};this._initValue||this._trigger("select",args);args={text:this.element[0].value,selectedText:this.currentValue,itemId:this.selectedIndexValue,selectedValue:this._selectedValue,value:this._selectedValue,isChecked:this.checkedStatus};this._initValue||this._trigger("change",args);this.value(this._hiddenInput.val());this.model.itemValue=this._selectedValue;this.model.text=this.element.val();this.model.checkAll=!1;this._setWatermark()},_createBox:function(i){if(!this._checkContains(i)){this._ulBox.css("display")=="none"&&this.element.css("display")!="none"&&this._swapUlandInput(!0);var r=t.buildTag("span.e-icon e-close","",{},{unselectable:"on"}),u=t.buildTag("li.e-options",i).append(r);return this._on(r,"click",function(t){var i,r;if(!this.model.enabled)return!1;if(this._deleteBox(n(t.target).parent()),this._isFocused||this._isPopupShown()||this._setWatermark(),!this.model.showCheckbox){for(i=0;i<this.ultag.children("li").length;i++)this.ultag.children("li")[i].innerText==n(t.target).parent()[0].textContent&&n(this.ultag.children("li")[i]).removeClass("e-active").removeClass("e-hover");this._removeText(n(t.target).parent()[0].textContent)}this.model.multiSelectMode!="none"&&(r=this._selectedIndices.indexOf(this.selectedIndexValue),this._selectedIndices.splice(r,1),this.model.selectedItems=this.model.selectedIndices=this._selectedIndices)}),u}},_deleteBoxCheck:function(t){for(var r=this._ulBox.children("li"),i=0;i<r.length;i++)n(r[i]).text()==t&&n(r[i]).remove()},_deleteLastBox:function(){var t=this._ulBox.children("li:not(.e-search-box)"),n=t.last();n.hasClass("e-active")?this._deleteBox(n):(this._removeActive(),n.addClass("e-active"))},_deleteBox:function(t){for(var f,u,i,r=0;r<t.length;r++){for(f=n(t[r]),deltext=f.text(),u=this.ultag.children("li:not('.e-category')"),i=0;i<u.length;i++)n(u[i]).text()==deltext&&(this._activeItem=i,this._uncheckboxModel(this._activeItem),hidval=this._getAttributeValue(u[i])||deltext,this._removeListHidden(hidval,this._activeItem));f.remove()}},_swapUlandInput:function(n){n?(this.element.css("display","none"),this._ulBox.css("display","block"),this.wrapper.css({height:"auto"})):(this.element.css("display","block"),this._ulBox.css("display","none"),this.wrapper.css({height:this.model.height}))},_removeActive:function(){this._ulBox.children("li").removeClass("e-active")},_adjustWidth:function(){var n=t.buildTag("span",this.element.val());this.container.append(n);this.element.width(n.width()+30);n.remove()},_uncheckboxModel:function(t){var i=this.ultag.children("li:not('.e-category')");n(i[t].firstChild).find(".listcheckbox").ejCheckBox("isChecked")&&(n(i[t].firstChild).find(".listcheckbox").ejCheckBox("option","checked",!1),this._removeTextBoxValue(),this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model}))},_destroyBoxModel:function(){this.container.prepend(this.element);this.element.css("display","block");this.wrapper.height(this.model.height);this._ulBox.remove();this._off(this.container,"click")},_removeListHover:function(){this.ultag.children("li").removeClass("e-hover")},_addListHover:function(){var n=this._getActiveItem();n.addClass("e-hover");this.scrollerObj.setModel({scrollTop:this._calcScrollTop("hover")});n.focus()},_calcScrollTop:function(n){for(var e=this.ultag.outerHeight(),u=this.ultag.find("li"),f=0,r,i=this._selectedIndices&&this._selectedIndices.length>0&&n=="active"?this._selectedIndices[this._selectedIndices.length-1]:this.ultag.find("li.e-"+n).index(),t=0;t<i;t++)f+=u.eq(t).outerHeight();return r=f-(this.popupList.outerHeight()-u.eq(i).outerHeight())/2,r<0?0:r},_getActiveItem:function(){return n(this.ultag.children("li:not('.e-category')")[this._activeItem])},_setDimentions:function(){this.model.height&&this.wrapper.height(this.model.height);this.model.width&&this.wrapper.width(this.model.width)},_roundedCorner:function(n){n?(this.container.addClass("e-corner"),this.popupListWrapper.addClass("e-corner"),this.inputSearch&&this.inputSearch.parent(".e-in-wrap").addClass("e-corner")):(this.container.removeClass("e-corner"),this.popupListWrapper.removeClass("e-corner"),this.inputSearch&&this.inputSearch.parent(".e-in-wrap").removeClass("e-corner"))},_enabled:function(n){n?this.enable():this.disable()},_destroyDropdown:function(){this.element.insertAfter(this.wrapper);this.element.width(this.element.width()+this.dropdownbutton.outerWidth());this.wrapper.remove();this.container.remove();this.container.unbind("mousedown",n.proxy(this._OnDropdownClick,this))},_RightToLeft:function(){this.model.enableRTL?this.wrapper.addClass("e-rtl"):this.wrapper.removeClass("e-rtl")},_dropbtnRTL:function(){this.model.enableRTL?(this.popupListWrapper.addClass("e-rtl"),this.popupList.addClass("e-rtl")):(this.popupListWrapper.removeClass("e-rtl"),this.popupList.removeClass("e-rtl"))},_OnDropdownClick:function(t){if((t.preventDefault(),n(t.target).is("li")&&n(t.target).parent().hasClass("e-boxes")||n(t.target).parents("ul").hasClass("e-boxes")&&n(t.target).hasClass("e-icon e-close"))||this.model.readOnly)return!1;(this.ultag.find("li").length>0||this.model.enableFilterSearch&&this._rawList.length>0)&&this._OnPopupHideShow()},_OnPopupHideShow:function(){this._isPopupShown()?this._hideResult():(this._showResult(),this.wrapper.focus())},_showFullList:function(){var n=this.model.dataSource,i;t.DataManager&&n instanceof t.DataManager?n.dataSource.offline||n.dataSource.json&&n.dataSource.json.length>0?this._getFilteredList(n.dataSource.json):(i=this,i._initDataSource(n)):this._getFilteredList(n)},_getFilteredList:function(n){if(!n||!n.length||n.length<1)this._targetElementBinding(),this._renderRemaining();else{var i=t.DataManager(n).executeLocal(this._isPlainType(n)?t.Query():this._getQuery());this._totalCount=i.count;this._listItem(i.result?i.result:i);this._renderPopupList()}},_cascadeAction:function(){if(this.model.cascadeTo)for(var r=this.model.cascadeTo.split(","),i=0;i<r.length;i++)if(n("#"+r[i]).hasClass("e-dropdownlist"))this._doCascadeAction(r[i],this,this.checkedStatus);else n("#"+r[i]).on("ejDropDownListcreate",{Obj:this,status:this.checkedStatus},function(n){t.isNullOrUndefined(n.data.Obj.getValue())||n.data.Obj.getValue()==""||n.data.Obj._doCascadeAction(this.id,n.data.Obj,n.data.status)})},_doCascadeAction:function(i,r,u){r._currentValue=r._getField(r.popupListItems[r._activeItem],r.mapFld._value);r.selectDropObj=n("#"+i).ejDropDownList("instance");var f={cascadeModel:r.selectDropObj.model,cascadeValue:r._currentValue,requiresDefaultFilter:!0};this._trigger("cascade",f);t.isNullOrUndefined(r[i])&&(r[i]=r.selectDropObj.model.dataSource);t.DataManager&&r[i]instanceof t.DataManager?r._cascadeOdataInit(r[i],f.requiresDefaultFilter,u):r._cascadeJsonInit(r.selectDropObj,r[i],r.mapFld._value,f.requiresDefaultFilter,u)},_cascadeOdataInit:function(n,i,r){var u=this,e,f;u._dQuery=this.selectDropObj._getQuery().clone();f=u._dQuery.clone();i&&f.where(u.mapFld._value,"equal",u._currentValue);u.selectDropObj._addLoadingClass();e=n.executeQuery(f);e.fail(function(n){u._changedSource=null;u.selectDropObj.setModel({dataSource:u._changedSource,enabled:!1});u._trigger("actionFailure",n)}).done(function(n){u._trigger("actionSuccess",n);u._cascadeDataBind(u.selectDropObj,n.result,r);u.selectDropObj._removeLoadingClass();!t.isNullOrUndefined(u.selectDropObj.model.selectedIndex)&&u._setSelectedItem&&u.selectDropObj._selectItemByIndex(u.selectDropObj.model.selectedIndex);u._setSelectedItem=!1}).always(function(n){u._trigger("actionComplete",n)})},_cascadeJsonInit:function(n,i,r,u,f){var e=t.Query(),o;u&&e.where(r,"==",this._currentValue);o=t.DataManager(i).executeLocal(e);this._cascadeDataBind(n,o,f)},_cascadeDataBind:function(i,r,u){var f,e,o,h,s;if(this.model.showCheckbox&&u||this.model.multiSelectMode!="none"&&this.activeItem.hasClass("e-active"))this._changedSource=t.isNullOrUndefined(this._changedSource)?r:this._changedSource.concat(r);else if(this.model.showCheckbox||this.model.multiSelectMode!="none"){for(f=0;f<r.length;f++)if(this._isPlainType(r)&&this._isPlainType(this._changedSource))this._changedSource.splice(this._changedSource.indexOf(r[f]),1);else for(e=0;e<this._changedSource.length;e++)JSON.stringify(this._changedSource[e])==JSON.stringify(r[f])&&this._changedSource.splice(e,1);i.setModel({dataSource:null})}else this._changedSource=r;for(o=JSON.parse(JSON.stringify(i.model)),i.setModel({dataSource:this._changedSource,enabled:!0}),(i.model.showCheckbox||i.model.multiSelectMode!="none")&&(n("input:hidden[id^='#'][name="+i._id+"]").remove(),i._hiddenInput.attr("name",i._name)),h=["dataSource","query","fields","itemsCount","template"],s=0;s<h.length;s++)delete o[h[s]];o.enabled=!0;i.setModel(o)},_OnMouseEnter:function(t){var i,r;if(!this.model.enabled||this.model.readOnly)return!1;this.ultag.children("li").removeClass("e-hover");n(t.target).is("li:not('.e-category')")&&n(t.target).addClass("e-hover");n(t.target).hasClass("e-disable")?n(t.target).removeClass("e-hover"):t.target.tagName!="li"&&(i=n(t.target).parents("li:not('.e-category')"),n(i).addClass("e-hover"));this.ultag.children("li:not('.e-category')").each(function(t){if(n(this).hasClass("e-hover"))return r=t,!1});this._activeItem=r},_OnMouseLeave:function(){if(!this.model.enabled||this.model.readOnly)return!1;this.ultag.children("li").removeClass("e-hover")},_OnMouseClick:function(t){if(!this.model.enabled||this.model.readOnly)return!1;if(n(t.target).is("li")&&!n(t.target).hasClass("e-disable")||!n(t.target).is("li")&&!n(t.target).closest("li").hasClass("e-disable"))if(this.model.showCheckbox){if(n(t.currentTarget).is("li")&&(n(t.target).is("li")||n(t.target.parentElement).is("li.e-hover"))&&n(t.currentTarget.firstChild).find(".listcheckbox")){n(t.target.parentElement).is("li.e-hover")&&(t.target=t.target.parentElement);var i=this.popupPanelWrapper.find(".e-popup").find("li:not('.e-category')");this._activeItem=n.inArray(t.target,i);n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("isChecked")?(n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("option","checked",!1),this.checkedStatus=!1,this._checkboxValue=!0,this._removeTextBoxValue()):(n(t.currentTarget.firstChild).find(".listcheckbox").ejCheckBox("option","checked",!0),this.checkedStatus=!0,this._checkboxValue=!0,this._enterTextBoxValue())}!this._initValue&&this._checkboxValue&&this._trigger("checkChange",{isChecked:this.checkedStatus,text:this.element.val(),itemId:this.selectedIndexValue,selectedText:this.currentValue,selectedValue:this._selectedValue,value:this._selectedValue,data:this.model})}else this._enterTextBoxValue(),this.model.multiSelectMode=="none"&&this._hideResult()},_OnClickCheckList:function(t){var i=this.popupPanelWrapper.find(".e-popup").find("li:not('.e-category')");this._activeItem=n.inArray(n(t.event.target).parents("li")[0],i);t.isChecked?(this.checkedStatus=!0,this._checkboxValue=!0,this._enterTextBoxValue()):(this.checkedStatus=!1,this._checkboxValue=!0,this._removeTextBoxValue())},_OnListSelect:function(t){t.preventDefault();activeItem=this._getActiveItem();n(activeItem).find(".listcheckbox").ejCheckBox("isChecked")?(n(activeItem).find(".listcheckbox").ejCheckBox("option","checked",!1),this.checkedStatus=!1,this._removeTextBoxValue()):(n(activeItem).find(".listcheckbox").ejCheckBox("option","checked",!0),this.checkedStatus=!0,this._enterTextBoxValue());this._initValue||this._trigger("checkChange",{isChecked:this.checkedStatus,data:this.model})},_OnDocumentClick:function(t){if(this.model&&(!this.model.enabled||this.model.readOnly))return!1;n(t.target).is(this.popupList)||n(t.target).parents(".e-ddl-popup").is(this.popupListWrapper)||n(t.target).is(this.element)||n(t.target).parents(".e-ddl").is(this.wrapper)?n(t.target).is(this.inputSearch)?this.inputSearch.focus():(n(t.target).is(this.popupList)||n(t.target).parents(".e-ddl-popup").is(this.popupListWrapper))&&t.preventDefault():this._hideResult()},_disableItemSelectUp:function(){var n=this.model.disableItemsByIndex.split(",").sort().reverse(),t;this._activeItem==0&&(this._activeItem=this._listSize);for(t in n)this._activeItem==parseInt(n[t])&&this._activeItem--},_disableItemSelectDown:function(){var n=this.model.disableItemsByIndex.split(",").sort(),t;this._listSize==this._activeItem&&(this._activeItem=0);for(t in n)this._activeItem==parseInt(n[t])&&this._activeItem++},_OnKeyPress:function(n){this.model.enableIncrementalSearch&&this._OnTextEnter(t.browserInfo().name=="mozilla"?n.charCode:n.keyCode)},_OnTextEnter:function(t){_proxy=this;this._incqueryString+=String.fromCharCode(t);this._incqueryString.length>0&&setTimeout(function(){_proxy._incqueryString=""},1e3);var f=this.popupList.find("ol,ul").children("li:not('.e-category')"),i,o=this.model.caseSensitiveSearch,h=this.model.fields,r,e=this._incqueryString,s=this._incqueryString.length,u=!1;for(o||(e=e.toLowerCase()),i=0;i<f.length;i++)if(r=n.trim(n(f[i]).text()),r=o?r:r.toLowerCase(),r.substr(0,s)==e?(this._isPopupShown()?(this._removeListHover(),this._activeItem=i,this.model.showCheckbox||this.model.multiSelectMode!="none"||this._enterTextBoxValue(),this._addListHover()):(this._activeItem=i,this.model.showCheckbox||this.model.multiSelectMode!="none"||this._enterTextBoxValue()),u=!0):i==f.length-1&&u==!1&&(this.model.itemValue==""&&(this._activeItem=null,this.model.showCheckbox||this.model.multiSelectMode!="none"||this.element.val("")),u=!0),u)break},_OnKeyDown:function(n){var f,r,u,i,t;if(!this.model.enabled||this.model.readOnly)return!1;this._itemId=null;f=this.ultag.children("li:not('.e-category')");this._listSize=this.ultag.children("li:not('.e-category')").size();u=this.popupList.height();r=this.ultag.children("li").outerHeight();i=Math.round(u/r);switch(n.keyCode){case 38:if(n.altKey){this.ultag.find("li").length>0&&this._hideResult();break}case 33:return t=n.keyCode==38?1:i,this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem<=0||this._activeItem==null||this._activeItem>this._listSize-1?this._activeItem=this._listSize-1:this._activeItem-=t,this.model.disableItemsByIndex!=null&&this._disableItemSelectUp(),this._addListHover(),this.model.showCheckbox||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem<=0||this._activeItem==null||this._activeItem>this._listSize-1?this._activeItem=this._listSize-1:this._activeItem-=t,this.model.showCheckbox||this._enterTextBoxValue()),n.preventDefault(),!1;case 40:if(n.altKey){this.ultag.find("li").length>0&&this._showResult();break}case 34:return t=n.keyCode==40?1:i,this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem>=this._listSize-1||this._activeItem==null||this._activeItem<0?this._activeItem=0:this._activeItem+=t,this.model.disableItemsByIndex!=null&&this._disableItemSelectDown(),this._addListHover(),this.model.showCheckbox||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem>=this._listSize-1||this._activeItem==null||this._activeItem<0?this._activeItem=0:this._activeItem+=t,this.model.showCheckbox||this._enterTextBoxValue()),n.preventDefault(),!1;case 37:return this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem<=0||this._activeItem==null||this._activeItem>this._listSize-1?this._activeItem=this._listSize-1:this._activeItem-=1,this.model.disableItemsByIndex!=null&&this._disableItemSelectUp(),this._addListHover(),this.model.showCheckbox||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem<=0||this._activeItem==null||this._activeItem>this._listSize-1?this._activeItem=this._listSize-1:this._activeItem-=1,this.model.showCheckbox||this._enterTextBoxValue()),n.preventDefault(),!1;case 39:return this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem>=this._listSize-1||this._activeItem==null||this._activeItem<0?this._activeItem=0:this._activeItem+=1,this.model.disableItemsByIndex!=null&&this._disableItemSelectDown(),this._addListHover(),this.model.showCheckbox||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem>=this._listSize-1||this._activeItem==null||this._activeItem<0?this._activeItem=0:this._activeItem+=1,this.model.showCheckbox||this._enterTextBoxValue()),n.preventDefault(),!1;case 8:return(this.model.multiSelectMode=="visualmode"||this.model.showCheckbox)&&this._ulBox&&this._deleteLastBox(),n.preventDefault(),!1;case 9:this._hideResult();break;case 35:return this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem=this._listSize-1,this._addListHover(),this.model.showCheckbox||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem=this._listSize-1,this.model.showCheckbox||this._enterTextBoxValue()),n.preventDefault(),!1;case 36:return this._isPopupShown()?(this._removeListHover(),this.ultag.children("li").removeClass("e-active"),this._activeItem=0,this._addListHover(),this.model.showCheckbox||this._enterTextBoxValue()):(this.ultag.children("li").removeClass("e-active"),this._activeItem=0,this.model.showCheckbox||this._enterTextBoxValue()),n.preventDefault(),!1;case 27:this._isPopupShown()&&n.stopPropagation();this._hideResult();break;case 32:return n.preventDefault(),!1}},_OnKeyUp:function(t){if(!this.model.enabled||this.model.readOnly)return!1;t.preventDefault();var i=t.target;if(n.trim(this.element.val())==""&&t.keyCode==38&&t.keyCode==40)return this._hideResult(),!1;switch(t.keyCode){case 13:return t.preventDefault(),this.model.showCheckbox?this._OnListSelect(t):(this._enterTextBoxValue(),this._hideResult()),!1;case 32:return t.preventDefault(),this.model.showCheckbox?this._OnListSelect(t):(this._enterTextBoxValue(),this._hideResult()),!1;case 8:this._hideResult();break;case 46:if(this.model.multiSelectMode=="visualmode"||this.model.showCheckbox){this._deleteBox(this._ulBox.children("li.e-active"));break}}},_targetFocus:function(){this.model.enabled&&!this._isFocused&&(this._isWatermark||this._hiddenSpan.css("display","none"),this.wrapper.addClass("e-focus"),this._isFocused=!0,this._trigger("focusIn"))},_targetBlur:function(){this.model.enabled&&(this._isFocused=!1,this.wrapper.removeClass("e-focus"),this._setWatermark(),this._trigger("focusOut"))},_wireEvents:function(){this._on(this.wrapper,"focus",this._targetFocus);this._on(this.wrapper,"blur",this._targetBlur);this._on(this.wrapper,"keydown",this._OnKeyDown);this._on(this.popupList,"keydown",this._OnKeyDown);this._on(this.popupList,"keyup",this._OnKeyUp);this._on(this.wrapper,"keyup",this._OnKeyUp);this._on(this.popupList,"keypress",this._OnKeyPress);this._on(this.wrapper,"keypress",this._OnKeyPress)}});t.MultiSelectMode={None:"none",Delimiter:"delimiter",VisualMode:"visualmode"};t.FilterType={Contains:"contains",StartsWith:"startsWith"}})(jQuery,Syncfusion)});