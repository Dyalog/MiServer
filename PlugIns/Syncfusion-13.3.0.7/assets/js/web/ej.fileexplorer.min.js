/*!
*  filename: ej.fileexplorer.min.js
*  version : 13.3.0.7
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.draggable.min","./../common/ej.scroller.min","./ej.button.min","./ej.treeview.min","./ej.uploadbox.min","./ej.waitingpopup.min","./ej.dialog.min","./ej.splitter.min","./ej.toolbar.min","./ej.menu.min","./ej.grid.min"],n):n()})(function(){(function(n,t,i){t.widget("ejFileExplorer","ej.FileExplorer",{element:null,model:null,validTags:["div"],_rootCSS:"e-fileexplorer",defaults:{fileTypes:"*.*",filterSettings:{caseSensitiveSearch:!1,filterType:"contains"},showToolbar:!0,showNavigationPane:!0,showContextMenu:!0,showFooter:!0,layout:"grid",locale:"en-US",selectedFolder:"",selectedItems:"",gridSettings:{allowSorting:!0,columns:[{field:"name",headerText:"Name",width:"25%"},{field:"type",headerText:"Type",width:"20%"},{field:"dateModified",headerText:"Date Modified",width:"35%"},{field:"size",headerText:"Size",width:"15%",textAlign:"right",headerTextAlign:"left"}]},tools:{creation:["NewFolder"],navigation:["Back","Forward","Upward"],addressBar:["Addressbar"],editing:["Refresh","Upload","Delete","Rename","Download"],copyPaste:["Cut","Copy","Paste"],getProperties:["Details"],searchBar:["Searchbar"]},toolsList:["creation","navigation","addressBar","editing","copyPaste","getProperties","searchBar"],path:"",height:400,width:850,minWidth:"400px",maxWidth:null,minHeight:"250px",maxHeight:null,isResponsive:!1,uploadSettings:{allowMultipleFile:!0,maxFileSize:31457280,autoUpload:!1},enableResize:!1,cssClass:"",enableRTL:!1,ajaxAction:"",ajaxDataType:"json",ajaxSettings:{read:{},createFolder:{},remove:{},rename:{},paste:{},getDetails:{},download:{},upload:{},getImage:{}},allowMultiSelection:!0,layoutChange:null,select:null,createFolder:null,remove:null,cut:null,copy:null,paste:null,open:null,beforeOpen:null,beforeUpload:null,beforeDownload:null,beforeAjaxRequest:null,resizeStart:null,resize:null,resizeStop:null},dataTypes:{filterSettings:"data",showToolbar:"boolean",showNavigationPane:"boolean",showContextMenu:"boolean",showFooter:"boolean",layout:"enum",gridSettings:"data",tools:{creation:"array",navigation:"array",addressBar:"array",editing:"array",copyPaste:"array",getProperties:"array",searchBar:"array"},toolsList:"array",uploadSettings:"data",ajaxSettings:"data"},_setModel:function(i){var r,u,e,f;for(r in i)switch(r){case"showToolbar":this.model.showToolbar||(this._paneHeight=this._toolBarItems.outerHeight());i[r]?t.isNullOrUndefined(this._toolBarItems)?this._renderToolBar():this._toolBarItems.show():this._toolBarItems.hide();this.element.outerHeight(this.model.showToolbar?this.element.outerHeight()+this._paneHeight:this.element.outerHeight()-this._paneHeight);this.model.height=this.element.outerHeight();break;case"showNavigationPane":case"showTreeview":this.model.showNavigationPane=this.model.showTreeview=i[r];this._showHideSplitBar(!1);break;case"showContextMenu":this._showHideContextMenu();break;case"height":this.element.css("height",this._getProperValue(this.model.height));this.adjustSize();break;case"width":this.element.css("width",this._getProperValue(this.model.width));this.adjustSize();break;case"layout":this._switchLayoutView();break;case"path":i[r]?this._setPath(i[r]):this._getPath();break;case"enableRTL":this._enableRTL(i[r]);break;case"showFooter":i[r]?(this._statusbar.hasClass("e-statusbar")?(u=this._splittag.find(".e-cont2").outerHeight()-this._statusbar.outerHeight(),this._tileView.height(u),this._gridtag.height(u),this._statusbar.show()):(this._createStatusBar(),this._updateData(),this.model.enableResize&&this._resizeFileExplorer(),this._on(n("#"+this._ExplorerId+"_switchGridView"),"click",this._switchView),this._on(n("#"+this._ExplorerId+"_swithListView"),"click",this._switchView)),e=this._splittag.height()-this._gridtag.find(".e-gridheader").outerHeight(),this._tileContent.parent(".e-tile-wrapper").ejScroller({height:this._splittag.outerHeight()-this._statusbar.outerHeight(),scrollerSize:this._scrollerSize})):(this._tileView.height("auto"),this._gridtag.height("auto"),this._statusbar.hide(),e=this._splittag.height()-this._gridtag.find(".e-gridheader").outerHeight(),this._tileContent.parent(".e-tile-wrapper").ejScroller({height:this._splittag.outerHeight(),scrollerSize:this._scrollerSize}));break;case"gridSettings":this._gridtag.ejGrid(i[r]);break;case"locale":this.model.locale=i[r];this.element.html("");this._init();break;case"cssClass":this._changeSkin(i[r]);break;case"fileTypes":f=this;n.each(f._fileExplorer,function(n){f._fileExplorer[n]=""});this._removeOldSelectionDetails();this._refreshItems(this._selectedNode,this._currentPath);this._uploadtag.ejUploadbox("option",{extensionsAllow:this.model.fileTypes=="*.*"?"":this.model.fileTypes.replace(/\*/g,"")});this._updateItemStatus(this._fileExplorer[this._currentPath]);break;case"selectedFolder":this._selectedFolder(this.model.selectedFolder);break;case"selectedItems":this._setSelectedItems(i[r]);break;case"allowMultiSelection":this._gridtag.find(".e-gridheader").length&&this._gridtag.ejGrid("option",{selectionType:i[r]?"multiple":"single"});break;case"isResponsive":this.model.isResponsive=i[r];this.model.showToolbar&&(this._toolBarObj.option("height",this.model.isResponsive?"":"auto"),this._toolBarObj.option("isResponsive",this.model.isResponsive));this._wireResizing();break;case"tools":n.extend(this.model.tools,i[r]);break;case"toolsList":this.model.toolsList=i[r];this._toolBarObj.destroy();this.element.find("#"+this._ExplorerId+"_toolbar").remove();this.model.showToolbar&&this._renderToolBar();break;case"enableResize":i[r]?i[r]&&this.model.showFooter&&(this._resizeItem=t.buildTag("div.e-icon e-fe-resize e-resize-handle"),this._resizeItem.insertBefore(this.element.find(".e-switchView")),this._resizeFileExplorer()):this._resizeItem&&this._resizeItem.remove();break;case"minHeight":this.element.css("min-height",this._getProperValue(this.model.minHeight));this._refreshResizeHandler();break;case"maxHeight":this.element.css("max-height",this._getProperValue(this.model.maxHeight));this._refreshResizeHandler();break;case"minWidth":this.element.css("min-width",this._getProperValue(this.model.minWidth));this._refreshResizeHandler();break;case"maxWidth":this.element.css("max-width",this._getProperValue(this.model.maxWidth));this._refreshResizeHandler()}},_init:function(){this._cloneElement=this.element.clone();t.isNullOrUndefined(this.model.uploadBoxSettings)||(this.model.uploadSettings=this.model.uploadBoxSettings);t.isNullOrUndefined(this.model.showTreeview)||(this.model.showNavigationPane=this.model.showTreeview);t.isNullOrUndefined(this.model.move)||(this.model.cut=this.model.move);this._initialize();this._render()},_postInit:function(){this._enablePostInit=!1;this._enableRTL(this.model.enableRTL);this._wireEvents();this._wireResizing();this._setMinMaxSizeInInteger();this.model.enableResize&&this.model.showFooter&&this._resizeFileExplorer()},_initialize:function(){this._ExplorerId=this.element[0].id;this._fileExplorer={};this._updateImages={};this._selectedStates=[];this._updateOnNodeSelection=!1;this._isClicked=!0;this._tileView=null;this._originalPath=null;this._initPath="";this._initUpdate=!1;this._scrollerSize=8;this._editingToolsState=!0;this.element.css({height:this._getProperValue(this.model.height),width:this._getProperValue(this.model.width),"min-width":this._getProperValue(this.model.minWidth),"max-width":this._getProperValue(this.model.maxWidth),"min-height":this._getProperValue(this.model.minHeight),"max-height":this._getProperValue(this.model.maxHeight)});this._customCssClass=this.model.cssClass;this.element.addClass(this.model.cssClass);this._isTreeNode=!1;this._selectedItems=[];this._selectedTileItems=[];this._downloadDialog=null;this._newFolderDialog=null;this._renameDialog=null;this._openDialog=null;this._detailsDialog=null;this._alertDialog=null;this._enablePostInit=!0;this._initialTime=(new Date).getTime();this._currentPath=this.model.path.replace(/\\/g,"/");this._rootPath=this._currentPath=this._currentPath.endsWith("/")?this._currentPath:this._currentPath+"/";this._gridObj=null;this._setUploadLocalization();this._restrictedToolbarOptions=[];this._restrictedMenuOption=[];this._contextMenu={navbar:["NewFolder","Upload","|","Delete","Rename","|","Cut","Copy","Paste","|","Getinfo"],cwd:["Refresh","Paste","|","NewFolder","Upload","|","Getinfo"],files:["Open","Download","|","Upload","|","Delete","Rename","|","Cut","Copy","Paste","|","Getinfo"]}},_initContextMenuOptions:function(n){for(var i=[],r={"class":"e-fe-separator"},t=0;t<this._contextMenu[n].length;t++)this._contextMenu[n][t]!="|"&&(this["_menu"+this._contextMenu[n][t]]=this._getLocalizedLabels("ContextMenu"+this._contextMenu[n][t]),i.push({text:this["_menu"+this._contextMenu[n][t]],sprite:"e-fileexplorer-toolbar-icon "+this._contextMenu[n][t],htmlAttr:this._contextMenu[n][t+1]=="|"?r:""}));return i},_render:function(){var n=this.model.selectedFolder,t=this.model.selectedItems;this.element.addClass("e-widget e-box").attr({role:"fileexplorer",tabindex:0});this.model.showToolbar&&this._renderToolBar();this._createSplitPane();this._read();n&&this._currentPath!=n&&this._selectedFolder(n);t.length&&(this._isClicked=!1,this._setSelectedItems(t),this._isClicked=!0)},_read:function(){var t=this,r={data:{ActionType:"Read",Path:this._currentPath,ExtensionsAllow:this.model.fileTypes,SelectedItems:this._getSelectedItemDetails(this._getFolderPath(),this._selectedContent)},url:this.model.ajaxAction,type:"POST",async:!1,success:function(n){n.hasOwnProperty("d")&&(n=n.d);t._readSuccess(n.files);t._enablePostInit&&t._postInit()},successAfter:this.model.ajaxSettings.read.success};this.model.ajaxSettings.read.success=i;n.extend(!0,r,this.model.ajaxSettings.read);this._sendAjaxRequest(r)},_sendAjaxRequest:function(i,r){var e,f,u;(!i.dataType&&this.model.ajaxDataType&&(i.dataType=this.model.ajaxDataType),this.model.ajaxAction!=""&&this._currentPath!="")&&((i.data.ActionType!="Read"&&(this._selectedItemDetails=i.data.SelectedItems),e={Name:"",ActionType:"",Path:"",ExtensionsAllow:"",LocationFrom:"",LocationTo:"",Action:"",NewName:"",Names:[],FileUpload:null,CommonFiles:null},r||this._waitingPopup.show(),n.extend(!0,e,i.data),f={data:e},u=this,this._trigger("beforeAjaxRequest",f))||n.ajax({data:i.dataType&&i.dataType.toLowerCase()=="jsonp"?{json:JSON.stringify(f.data)}:JSON.stringify(f.data),url:i.url,type:i.type,async:i.async,success:function(n){i.success.call(this,n);typeof i.successAfter=="function"&&i.successAfter.apply(this,arguments)},contentType:i.contentType?i.contentType:"application/json",dataType:i.dataType,jsonpCallback:i.jsonpCallback?i.jsonpCallback:i.dataType&&i.dataType.toLowerCase()=="jsonp"?"MyCallbackFunction":"",error:i.error?i.error:function(n){var i=n.responseJSON?n.responseJSON.ExceptionType+", "+n.responseJSON.ExceptionMessage:n.statusText;u._alertDialog=u._createDialog(t.buildTag("div.e-fe-dialog-label",i),{width:400,height:"auto",title:u._getLocalizedLabels("Error")});u._alertDialogObj=u._alertDialog.data("ejDialog")},beforeSend:i.beforeSend,complete:function(){u._waitingPopup.hide();i.complete}}))},_onBeforeOpen:function(){var t,n=[],i;return t=this._nodeType=="File"?this._currentPath.replace("~","..")+this._selectedFile:this._currentPath,this._selectedFile?n=this._getSelectedItemDetails(this._currentPath,this._selectedFile):this._selectedContent&&(n=this._getSelectedItemDetails(this._getFolderPath(),this._selectedContent)),i={path:t,itemType:this._nodeType,selectedItems:n},this._trigger("beforeOpen",i)},_readSuccess:function(n){var i,t;for(this._update=!1,i=0,t=0;t<n.length;t++)i+=n[t].size,n[t].sizeInByte=n[t].size,n[t].size=n[t].isFile?this._bytesToSize(n[t].size):"";i=this._bytesToSize(i);this._fileExplorer[this._currentPath]=n;this._itemStatus&&this._itemStatus.html(n.length+" "+(n.length==1?this._getLocalizedLabels("Item"):this._getLocalizedLabels("Items"))+", "+this._getLocalizedLabels("Size")+": "+i);this._treetag.hasClass("e-treeview")||(this._renderTreeView(n),this._updateOnNodeSelection=!0);this.model.layout=="grid"?this._renderGridView(n):this._renderTileView(n)},_bytesToSize:function(n){var t,i;return n==0?"0 Byte":(t=parseInt(Math.floor(Math.log(n)/Math.log(1024))),i=n/Math.pow(1024,t),i.toFixed(2)+" "+["Bytes","KB","MB","GB","TB"][t])},_setPath:function(n){this.model.path=n;this._treetag.remove();this._treetag=t.buildTag("div#"+this._ExplorerId+"_treeView");this._splittag.find(".e-cont1 > .e-tree-wrapper").append(this._treetag);this._fileExplorer=this._updateImages={};this._selectedStates=this._selectedItems=this._selectedTileItems=[];this._initUpdate=!1;this._initPath="";this._currentPath=this.model.path.replace(/\\/g,"/");this._originalPath=this._rootPath=this._currentPath=this._currentPath.endsWith("/")?this._currentPath:this._currentPath+"/";this._read()},_getPath:function(){return this.model.path},_changeSkin:function(n){this.element.removeClass(this._customCssClass).addClass(n);this._customCssClass=n;this._waitingPopup.option("cssClass",n);this._subControlsSetModel("cssClass",n)},_enableRTL:function(n){var t,i;if(n){if(this._gridObj){for(t=this._gridObj.option("model.columns"),this._oldFormat=JSON.parse(JSON.stringify(t)),i=0;i<t.length;i++)t[i].textAlign=t[i].headerTextAlign="right";this._gridObj.columns(t)}this.element.addClass("e-rtl");this.element.find(".e-scroller").addClass("e-rtl")}else this._gridObj&&this._oldFormat&&this._gridObj.columns(this._oldFormat),this.element.removeClass("e-rtl"),this.element.find(".e-scroller").removeClass("e-rtl"),this._gridtag&&this._gridtag.removeClass("e-rtl");this._subControlsSetModel("enableRTL",n)},_destroy:function(){this.element.html("");n(this._cloneElement).removeClass("e-fileexplorer e-js");this.element.replaceWith(this._cloneElement);this._treeContextMenutag&&this._treeContextMenutag.parent().remove();this._tileContextMenutag&&this._tileContextMenutag.parent().remove();this._downloadDialog&&this._downloadDialog.parents(".e-dialog").remove();this._newFolderDialog&&this._newFolderDialog.parents(".e-dialog").remove();this._renameDialog&&this._renameDialog.parents(".e-dialog").remove();this._openDialog&&this._openDialog.parents(".e-dialog").remove();this._detailsDialog&&this._detailsDialog.parents(".e-dialog").remove();this._waitingPopup&&this._waitingPopup.destroy()},_createFolder:function(t){var r=this,u={data:{ActionType:"CreateFolder",Name:t,Path:this._originalPath,SelectedItems:this._getSelectedItemDetails(this._originalPath,this._treeObj.getText(this._selectedNode))},url:this.model.ajaxAction,type:"POST",success:function(n){var t,i,u;n.hasOwnProperty("d")&&(n=n.d);t=r._selectedNode;i=[{id:n.files[0].name,name:n.files[0].name,spriteCssClass:"e-tree-foldericon",hasChild:!1}];r._treetag.ejTreeView("isExpanded",t)||t.find(".e-icon").click();r._nodeExpanded=!0;r._treeObj.addNode(i,t);r._nodeExpanded=!1;r._update=!0;r._treeObj.selectNode(t);r._setSelectedItems([n.files[0].name]);r._refreshTreeScroller();r._treetag.find("li").removeAttr("tabindex");u={data:n,selectedItems:r._selectedItemDetails};r._trigger("createFolder",u)},successAfter:this.model.ajaxSettings.createFolder.success};this.model.ajaxSettings.createFolder.success=i;n.extend(!0,u,this.model.ajaxSettings.createFolder);this._sendAjaxRequest(u)},_cut_copy:function(){var n,r,i;if(this._sourcePath==this._currentPath&&this._option=="move"){this.element.find(".e-blur").removeClass("e-blur");this._setSelectedItems(this._fileName);return}for(n=this._fileExplorer[this._currentPath],r=typeof this._fileName=="string"?[this._fileName]:this._fileName,i=0;i<r.length;i++)if(!this._isNameExist(this._fileExplorer[this._sourcePath],r[i]))return;t.isNullOrUndefined(n)&&(this._getFileDetails(this._currentPath),n=this._fileExplorer[this._currentPath]);this._existingItems=[];this._sourcePath!=this._currentPath&&n.length?(this._getDuplicateItems(this._sourcePath,this._currentPath,typeof this._fileName=="string"?[this._fileName]:this._fileName),this._existingItems.length?this._createReplaceConformationDiaolg("_pasteOperation","ReplaceAlert"):this._pasteOperation()):this._pasteOperation()},_createReplaceConformationDiaolg:function(i,r){var u=this,f=0,v=String.format(this._getLocalizedLabels(r),this._existingItems[f].Path),o=t.buildTag("div.e-get-name"),y=t.buildTag("div.e-fe-dialog-label",v),s=t.buildTag("div.e-fe-dialog-btn e-replace"),e=t.buildTag("button.e-fe-btn-yes ",this._getLocalizedLabels("YesButton")),h=t.buildTag("button.e-fe-btn-yes e-all ",this._getLocalizedLabels("YesToAllButton")),c=t.buildTag("button.e-fe-btn-no ",this._getLocalizedLabels("NoButton")),l=t.buildTag("button.e-fe-btn-no e-all ",this._getLocalizedLabels("NoToAllButton")),a;e.ejButton({type:"button",click:function(){/\.(gif|jpg|jpeg|tiff|png|bmp)$/i.test(u._existingItems[f].Name)&&(u._updateImages[u._existingItems[f].Path]=(new Date).getTime());u._existingItems[f].IsReplace=!0;f++;f<u._existingItems.length?u._alertDialog.find(".e-fe-dialog-label").text(String.format(u._getLocalizedLabels(r),u._existingItems[f].Path)):u._destroyReplaceConformationDiaolg(i)}});c.ejButton({type:"button",click:function(){u._existingItems[f].IsReplace=!1;f++;f<u._existingItems.length?u._alertDialog.find(".e-fe-dialog-label").text(String.format(u._getLocalizedLabels(r),u._existingItems[f].Path)):u._destroyReplaceConformationDiaolg(i)}});h.ejButton({type:"button",click:function(){for(var n=f;n<u._existingItems.length;n++)/\.(gif|jpg|jpeg|tiff|png|bmp)$/i.test(u._existingItems[n].Name)&&(u._updateImages[u._existingItems[n].Path]=(new Date).getTime()),u._existingItems[n].IsReplace=!0;u._destroyReplaceConformationDiaolg(i)}});l.ejButton({type:"button",click:function(){for(var n=f;n<u._existingItems.length;n++)u._existingItems[n].IsReplace=!1;u._destroyReplaceConformationDiaolg(i)}});s.append(e,h,c,l);n(o).append(y,s);a=function(){e.focus()};this._alertDialog=this._createDialog(o,{width:500,height:"auto",title:this._getLocalizedLabels("Error"),open:a});this._alertDialogObj=this._alertDialog.data("ejDialog")},_destroyReplaceConformationDiaolg:function(n){this._removeDialog(this._alertDialogObj);this[n]()},_pasteOperation:function(){var h,e;this._removeBlurEffect();var r=this,u=this._currentPath.split("/"),c=this._sourcePath+this._fileName+"/";if(this._sourceType=="Directory"&&this._currentPath.indexOf(c)!=-1){var l=this._getLocalizedLabels("CancelPasteAction"),o=t.buildTag("div"),a=t.buildTag("div.e-fe-dialog-label",l),s=t.buildTag("div.e-fe-dialog-centerbtn"),f=t.buildTag("button.e-fe-btn-cancel ",this._getLocalizedLabels("CancelButton"));f.ejButton({type:"button",click:function(){r._removeDialog(r._alertDialogObj)}});s.append(f);n(o).append(a,s);h=function(){f.focus()};this._alertDialog=this._createDialog(o,{width:400,height:"auto",title:this._getLocalizedLabels("Error"),open:h});this._alertDialogObj=this._alertDialog.data("ejDialog");this._alertDialogObj.initialRender=!1;this._alertDialogObj.open()}else e={data:{ActionType:"Paste",LocationFrom:this._sourcePath,LocationTo:this._currentPath,Names:typeof this._fileName=="string"?[this._fileName]:this._fileName,Action:this._option,CommonFiles:this._existingItems,SelectedItems:this._getSelectedItemDetails(this._sourcePath,this._fileName),TargetFolder:this._getSelectedItemDetails(this._getFolderPath(),u[u.length-2])},url:this.model.ajaxAction,type:"POST",success:function(){var f,e,t,i,o,s;if(typeof r._fileName=="string"&&(r._fileName=[r._fileName]),r._existingItems&&r._existingItems.filter(function(t){if(t.IsReplace==!1){var i=n.inArray(items.Name,r._fileName);i>-1&&r._fileName.splice(i,1)}}),r._existingItems=[],f=r._originalPath,e=r._selectedNode,r._option=="move"){for(t=0;t<r._fileName.length;t++)r._modifySelectedStates(r._sourcePath+r._fileName[t],"");if(r._fileName.length==1)r._sourceType=="Directory"&&r._treeObj.removeNode(r._refreshNode);else for(u=r._refreshNode.siblings(),r._sourceType=="Directory"&&r._treeObj.removeNode(r._refreshNode),t=0;t<r._fileName.length;t++)for(i=0;i<u.length;i++)r._fileName[t]==n(u[i]).text()&&r._treeObj.removeNode(u[i]);r._fileExplorer[r._sourcePath]=""}n.each(r._fileExplorer,function(n){n.startsWith(f)&&(r._fileExplorer[n]="")});r._currentPath=r._originalPath;r._highlightedNodes=r.model.selectedItems.length?r.model.selectedItems:r._fileName;r._refreshItems(e,f);r._updateItemStatus(r._fileExplorer[f]);o=r._getFolderPath();r._option=="move"&&(r._fileName="",r._option=null,r._toolBarItems&&r._toolBarItems.ejToolbar("disableItemByID",r._ExplorerId+"Paste"),r.model.showContextMenu&&(r._viewMenuObj.disableItem(r._menuPaste),r._treeMenuObj.disableItem(r._menuPaste)));s={name:r._fileName,targetPath:r.model.path,selectedItems:r._selectedItemDetails,targetFolder:r._getSelectedItemDetails(o,r._selectedContent)};r._trigger("paste",s)},successAfter:this.model.ajaxSettings.paste.success},this.model.ajaxSettings.paste.success=i,n.extend(!0,e,this.model.ajaxSettings.paste),this._sendAjaxRequest(e)},_deletion:function(t,r){var u=this,e=this._treeObj.getSelectedNode(),f;this._treeObj.isExpanded(e)||e.find(".e-icon").click();f={data:{ActionType:"Remove",Names:typeof t=="string"?[t]:t,Path:r,SelectedItems:this._getSelectedItemDetails(r,t)},traditional:!0,url:this.model.ajaxAction,type:"POST",success:function(i){var e,o,s;for(u._selectedItemsTag&&u._selectedItemsTag.html(""),u._fileExplorer[u._ajax_folderPath]="",n.each(u._fileExplorer,function(n){n.startsWith(u._ajax_folderPath)&&(u._fileExplorer[n]="")}),e=0;e<f.data.SelectedItems.length;e++)f.data.SelectedItems[e].isFile==!1&&u._modifySelectedStates(r+f.data.SelectedItems[e].name,"");u._currentPath=u._ajax_folderPath;o=u._selectedContent==u._selectedTreeText?u._parentNode:u._selectedNode;u._refreshItems(o,u._ajax_folderPath);u._updateItemStatus(u._fileExplorer[u._currentPath]);u._treeObj.getSelectedNode().length==0?u._treeObj.selectNode(u._parentNode):u.model.layout=="tile"?u._tileViewWrapper.click():u.model.layout=="grid"&&u._gridtag.find(".e-gridcontent").click();s={data:i,path:u._ajax_folderPath,name:t,selectedItems:u._selectedItemDetails};u._trigger("remove",s)},successAfter:this.model.ajaxSettings.remove.success};this.model.ajaxSettings.remove.success=i;n.extend(!0,f,this.model.ajaxSettings.remove);this._sendAjaxRequest(f)},_rename:function(){var t=this,r={data:{ActionType:"Rename",Path:t._currentPath,Name:t._selectedContent,NewName:t._ajax_person,CommonFiles:t._existingItems,SelectedItems:this._getSelectedItemDetails(t._currentPath,this._selectedContent)},url:this.model.ajaxAction,type:"POST",success:function(){t._existingItems=[];t._fileExplorer[t._currentPath]="";var i=t._selectedContent==t._selectedTreeText?t._parentNode:t._selectedNode;t._nodeType!="File"&&t._modifySelectedStates(t._currentPath+t._selectedContent,t._currentPath+t._ajax_person);t._splittag.find(".e-cont2 .e-active").length<=0?(n.each(t._fileExplorer,function(n){n.startsWith(t._currentPath+t._selectedContent+"/")&&(t._fileExplorer[n]="")}),i.find("> div > .e-text")[0].lastChild.nodeValue=t._ajax_person,t._originalPath=t._currentPath+=t._ajax_person+"/",t._updateAddressBar()):(t.model.selectedItems.length>0&&(t.model.selectedItems[t.model.selectedItems.length-1]=t._ajax_person,t._highlightedNodes=t.model.selectedItems),t._refreshItems(i,t._currentPath),t._treeObj.getSelectedNode().length==0&&n(t._parentNode).find("li a").each(function(){if(n(this).text()==t._ajax_person)return t._treeObj.selectNode(n(this).closest("li.e-item")),!1}))},successAfter:this.model.ajaxSettings.rename.success};this.model.ajaxSettings.rename.success=i;n.extend(!0,r,this.model.ajaxSettings.rename);this._sendAjaxRequest(r)},_downloadFile:function(){var t=this._getSelectedItemDetails(this._currentPath,this._selectedItems),i={Path:this._currentPath,ActionType:"Download",SelectedItems:JSON.stringify(t),Names:this._selectedItems},r=this.model.ajaxAction+"?"+n.param(i,!0),u;if(this.model.ajaxSettings.download.url&&(r=this.model.ajaxSettings.download.url.indexOf("{")>=0?String.format(this.model.ajaxSettings.download.url,"?"+n.param(i,!0)):this.model.ajaxSettings.download.url),u={path:this._currentPath,files:this._selectedItems,selectedItems:t},this._trigger("beforeDownload",u))return!1;window.location=r},_removeBlurEffect:function(){this._currntNode&&(this._currntNode.hasClass("e-active")&&this._currntNode.removeClass("e-blur"),this._currntNode.find(".e-active").length&&this._currntNode.find(".e-active").removeClass("e-blur"))},_renderTreeView:function(t){var e=t.length>0?!0:!1,i,r,u,f;for(this._collapse=!1,i=this,r=this._currentPath.split("/"),u=0;u<r.length-2;u++)this._initPath+=r[u]+"/";f=r[r.length-2];this._localData=[{id:1,name:f,spriteCssClass:"e-tree-foldericon",hasChild:e}];this._treetag._collapse=!1;this._treetag.ejTreeView({loadOnDemand:!0,cssClass:i.model.cssClass,enableRTL:i.model.enableRTL,fields:{dataSource:i._localData,id:"id",parentId:"pid",text:"name",hasChild:"hasChild",spriteCssClass:"spriteCssClass"},nodeCollapse:function(n){i._refreshTreeScroller(n)},nodeExpand:function(n){i._refreshTreeScroller(n)},nodeClick:function(n){i._treenodeClicked(n)},beforeExpand:function(n){i._treeNodeBeforeExpand(n)},nodeSelect:function(n){i._updateTreePath(n)},beforeCollapse:function(n){i._onBeforeCollapse(n)},beforeDelete:function(n){i._treeBeforeDelete(n)}});this._treeObj=this._treetag.data("ejTreeView");this._treeViewEvents("_off");this._treeViewEvents("_on");this._treetag.ejTreeView("selectNode",n(this._treetag).find("li")[0]);this._treeScroll=this._treetag.parent(".e-tree-wrapper").ejScroller({height:this._splittag.height(),width:this._splittag.find(".e-cont1").width(),buttonSize:0,scrollerSize:this._scrollerSize+10}).data("ejScroller");this._addChild(t)},_treeViewEvents:function(n){this[n](this._treetag,"focus",this._focusTreeView);this[n](this._treetag,"blur",this._blurTreeView)},_focusTreeView:function(){this._treetag.hasClass("e-focus")||(this._treetag.addClass("e-focus"),this._itemList=[],this._on(this._treetag,"keydown",this._OnKeyUp))},_blurTreeView:function(){this._treetag.removeClass("e-focus");this._off(this._treetag,"keydown",this._OnKeyUp)},_treeBeforeDelete:function(n){if(!t.isNullOrUndefined(n.event)){var i=this._getKeyCode(n.event);i==46&&(n.cancel=!0)}},_treeNodeBeforeExpand:function(n){if(!this._nodeExpanded){var t=this._updatePath(n.currentElement,n.value);this._fileExplorer[t]||this._getFileDetails(t,n.currentElement);this._treetag.ejTreeView("hasChildNode",n.currentElement)||this._fileExplorer[t]&&this._addChild(this._fileExplorer[t],n.currentElement)}},_treenodeClicked:function(t){if(n(t.currentElement).hasClass("e-text")&&t.currentElement!=this._selectedNode.find("> div > .e-text")[0]){this._selectedContent=t.currentElement.text;this._selectedNode=n(t.currentElement).closest("li.e-item");var i=n(this._selectedNode.parents("li.e-item")[0]);this._parentNode=i.length!=0?i:this._selectedNode;this._nodeType="Directory";this._parentNode?this._enableEditingTools():this._disableEditingTools();this._isTreeNode=!0}},_showHideContextMenu:function(){if(this.model.showContextMenu){var i={beforeOpen:"",click:""},u,r={id:"",targetId:""};u=this._initContextMenuOptions("navbar");r.id=this._ExplorerId+"_treeView";r.targetId="#"+this._ExplorerId+"_treeView";i.beforeOpen=n.proxy(this._beforeOpenContextMenu,this);i.close=n.proxy(this._onHideContextMenu,this);i.click=n.proxy(this._contextMenuClick,this);this._treeContextMenutag=this._createContextMenuTag(u,r,i);this._treeMenuObj=this._treeContextMenutag.ejMenu("instance");this._cwdMenuOptions=this._initContextMenuOptions("cwd");r.id=this._ExplorerId+"_tileView";r.targetId=".e-tile-wrapper,#"+this._ExplorerId+"_grid";i.beforeOpen=n.proxy(this._beforeOpenTileContextMenu,this);i.click=n.proxy(this._fileContextMenuClick,this);this._tileContextMenutag=this._createContextMenuTag(this._cwdMenuOptions,r,i);this._viewMenuObj=this._tileContextMenutag.ejMenu("instance");(t.isNullOrUndefined(this._fileName)||this._fileName=="")&&(this._treeMenuObj.disableItem(this._menuPaste),this._viewMenuObj.disableItem(this._menuPaste));this._fileMenuOptions=this._initContextMenuOptions("files")}else this._treeContextMenutag&&this._tileContextMenutag&&(this._treeMenuObj.destroy(),this._viewMenuObj.destroy())},enableMenuItem:function(n){n=this._findCommand(n,this._contextMenu);for(var t=0;t<this._restrictedMenuOption.length;t++)if(this._restrictedMenuOption[t]==n){this._restrictedMenuOption.splice(t,1);break}this._treeMenuObj.enableItem(n);this._viewMenuObj.enableItem(n)},disableMenuItem:function(n){n=this._findCommand(n,this._contextMenu);this._restrictedMenuOption.push(n);this._treeMenuObj.disableItem(n);this._viewMenuObj.disableItem(n)},_renderGridView:function(n){var i=this,t=this.model.gridSettings.columns[this.model.gridSettings.columns.length-1];t&&(t.customAttributes?t.customAttributes["class"]?t.customAttributes["class"].search("e-rowcell e-last-rowcell")==-1&&(t.customAttributes["class"]=t.customAttributes["class"]+" e-rowcell e-last-rowcell"):t.customAttributes["class"]=" e-rowcell e-last-rowcell":t.customAttributes={"class":"e-rowcell e-last-rowcell"});this._gridObj?this._gridObj.option("dataSource",n):this._gridtag.ejGrid({cssClass:i.model.cssClass,enableRTL:i.model.enableRTL,dataSource:n,selectionType:i.model.allowMultiSelection?"multiple":"single",allowSorting:i.model.gridSettings.allowSorting,columns:i.model.gridSettings.columns,isResponsive:!0,scrollSettings:{width:186,height:200},allowScrolling:!0,enableResponsiveRow:!1,rowSelected:function(n){i._updatePathFromGrid(n)},recordDoubleClick:function(n){i._openAction(n)}});this._gridObj=this._gridtag.ejGrid("instance");this.gridItems=this._gridObj.getRows();this._reSizeHandler();this._gridtag.attr("tabindex",-1);this._gridViewEvents("_off");this._gridViewEvents("_on")},_gridViewEvents:function(n){this[n](this._gridtag.find(".e-gridcontent"),"focusin",this._focusGridView);this[n](this._gridtag.find(".e-gridcontent"),"focusout",this._blurGridView)},_focusGridView:function(){this._gridtag.find(".e-gridcontent").hasClass("e-focus")||(this._gridtag.find(".e-gridcontent").addClass("e-focus"),this._itemList=[],this._on(this._gridtag.find(".e-gridcontent"),"keydown",this._OnKeyUp))},_blurGridView:function(){this._gridtag.find(".e-gridcontent").removeClass("e-focus");this._off(this._gridtag.find(".e-gridcontent"),"keydown",this._OnKeyUp)},_setThumbImageHeight:function(){var i=1,t,f,r,u;if(this.items){for(t=0;t<this.items.length-1;t++)if(this.items[t].getBoundingClientRect().top==this.items[t+1].getBoundingClientRect().top)i++;else break;if(this.items.find(".e-thumb-image.e-image").css("height","auto"),i==null||i<2)return!0;for(t=0,f=this.items.length;t<f;t+=i)r=0,u=this.items.slice(t,t+i),u.each(function(){var t=parseInt(n(this).find(".e-thumb-image").outerHeight());t>r&&(r=t)}),u.find(".e-thumb-image.e-image").css("height",r);this._tileContent.parent(".e-tile-wrapper").ejScroller("refresh")}this._perRow=i},_renderTileView:function(i){var r,u,e,s,o,f;if(this._tileView.children()&&this._tileView.children().remove()&&this._tileView.removeClass("e-tileview"),this._tileView.appendTo(this._tileContent),this._tileView.addClass("e-tileview").attr("role","tileview"),i.length==0?this._tileView.html("No items to display"):this._tileView.html(""),r=this,u=null,n.each(i,function(i,f){var e=n("<li class='e-tilenode'><\/li>"),o,s,h,c,l;f.isFile?/\.(bmp|dib|jpg|jpeg|jpe|jfif|gif|tif|tiff|png|ico)$/i.test(f.name)?(o=r._currentPath.replace("~","..")+f.name,s=n("<div class='e-thumb-image e-image ' unselectable='on'><\/div>"),s.appendTo(e),h=r._getImage(o,f.name),c=t.buildTag("img.e-thumbImage","","",{src:h?h:o+"?"+(r._updateImages[o]?r._updateImages[o]:r._initialTime),unselectable:"on"}),c.appendTo(s)):(u=n("<span class='e-thumb-image e-nonImage-icon' unselectable='on'><\/span>"),u.appendTo(e)):(u=n("<span class='e-thumb-image e-folder-icon' unselectable='on'><\/span>"),u.appendTo(e));l=n("<div class='e-name' unselectable='on'>"+f.name+"<\/div>");e.attr({"aria-selected":!1,title:f.isFile?f.dateModified+" ("+f.size+")":f.dateModified,role:"tileitem"});l.appendTo(e);e.appendTo(r._tileView)}),this._activeItem=0,this.items=this._tileView.find("li.e-tilenode"),this._tileViewEvents("_off"),this._tileViewEvents("_on"),this._tileContent.addClass("e-content"),this._tileContent.parent(".e-tile-wrapper").hasClass("e-scroller")||this._tileContent.parent(".e-tile-wrapper").ejScroller({height:this.model.showFooter?this._splittag.outerHeight()-this._statusbar.outerHeight():this._splittag.outerHeight(),width:"100%",buttonSize:0,scrollerSize:this._scrollerSize}),r._tileView.find(".e-image"))for(e=r._tileView.find(".e-image > img"),s=0,o=0;o<e.length;o++)f=new Image,f.onload=f.onabort=f.onerror=function(){++s==e.length&&r._setThumbImageHeight()},f.src=n(e[o]).attr("src");else r._setThumbImageHeight()},_getImage:function(n,t){if(this._currentPath.indexOf(":")==1||this.model.ajaxSettings.getImage.url){var r=this._getSelectedItemDetails(this._currentPath,t),i=this.model.ajaxAction+"?Path="+n+"&ActionType=GetImage&SelectedItems="+JSON.stringify(r);this.model.ajaxSettings.getImage.url&&(i=this.model.ajaxSettings.getImage.url.indexOf("{")>=0?String.format(this.model.ajaxSettings.getImage.url,"?Path="+n+"&SelectedItems="+JSON.stringify(r)):this.model.ajaxSettings.getImage.url)}return i?i:""},_gridtagClick:function(t){t.stopPropagation();(n(t.target).hasClass("e-gridcontent")||n(t.target).hasClass("e-content")||n(t.target).hasClass("e-table"))&&(this._addFocus(this._gridtag.find(".e-gridcontent")),this._gridObj.clearSelection(),this._removeOldSelectionDetails())},_updateGridSelection:function(t){t.events&&!t.events.ctrlKey&&n(t.target)[0]!=null&&this._gridObj.selectRows(n(t.target).parent().index(),null,n(t.target))},_updateTileSelection:function(t){t.events&&!t.events.ctrlKey&&n(t.target)[0]!=null&&n(t.target).click()},_tileViewEvents:function(n){this[n](this.items,"click",this._upDatePathFromTileView);this[n](this.items,"dblclick",this._openAction);this[n](this.items,"mouseenter",this._onItemHover);this[n](this.items,"mouseleave",this._onItemLeave);this[n](this._tileViewWrapper,"focusin",this._focusTileView);this[n](this._tileViewWrapper,"focusout",this._blurTileView)},_tileViewWrapperClick:function(t){(n(t.target).hasClass("e-tile-wrapper")||n(t.target).hasClass("e-tile-content")||n(t.target).hasClass("e-tileview"))&&(this._lastItemIndex=this._lastItemIndex?this._lastItemIndex:this._itemList.filter(".e-active").index(),this._addFocus(this._tileViewWrapper),this.items.hasClass("e-active")&&this.items.removeClass("e-active").attr("aria-selected",!1),this._removeOldSelectionDetails())},_onItemHover:function(t){var i=t.currentTarget,r=t.target;n(i).hasClass("e-disable")||(this.items.removeClass("e-hover"),n(i).addClass("e-hover"))},_onItemLeave:function(t){var i=t.currentTarget,r=t.target;n(i).hasClass("e-disable")||n(i).removeClass("e-hover")},_focusTileView:function(){this._tileViewWrapper.hasClass("e-focus")||(this._tileViewWrapper.addClass("e-focus"),this._itemList=this.items,this._on(this._tileViewWrapper,"keydown",this._OnKeyUp),this._on(this._tileViewWrapper,"keydown",this._OnKeyDown))},_blurTileView:function(){this._tileViewWrapper.removeClass("e-focus");this._off(this._tileViewWrapper,"keydown",this._OnKeyUp);this._off(this._tileViewWrapper,"keydown",this._OnKeyDown)},_OnKeyDown:function(n){var t=this._itemList.length-1,i;this._activeItem=this._lastItemIndex?this._lastItemIndex:this._itemList.filter(".e-active").index();i=this._getKeyCode(n);switch(i){case 38:if(n.preventDefault(),this._activeItem<this._perRow-1)return;this._activeItem-=this._perRow;this._beforeListHover(n.shiftKey);break;case 37:if(n.preventDefault(),this._activeItem==0)return;this._activeItem<0||this._activeItem==null||this._activeItem>t?this._activeItem=0:this._activeItem==0?this._activeItem=t:this._activeItem-=1;this._beforeListHover(n.shiftKey);break;case 40:if(n.preventDefault(),this._activeItem+this._perRow>=this._itemList.length)return;this._activeItem+=this._perRow;this._beforeListHover(n.shiftKey);break;case 39:if(n.preventDefault(),this._activeItem==t)return;this._activeItem>t||this._activeItem==null||this._activeItem<0?this._activeItem=t:this._activeItem==t?this._activeItem=0:this._activeItem+=1;this._beforeListHover(n.shiftKey);break;case 33:case 36:n.preventDefault();this._activeItem=0;this._beforeListHover(n.shiftKey);break;case 34:case 35:n.preventDefault();this._activeItem=t;this._beforeListHover(n.shiftKey)}this._lastItemIndex=n.shiftKey?this._activeItem:null},_OnKeyUp:function(i){var s=this._getKeyCode(i),f,u,o,r,e;switch(s){case 13:i.preventDefault();i.altKey?(this._lastFocusedElement=i.currentTarget,this._getDetails()):(i.preventDefault(),this._lastFocusedElement=i.currentTarget,n(i.currentTarget).hasClass("e-treeview")||(f=!1,n(i.currentTarget).hasClass("e-tile-wrapper")?f=this.items.hasClass("e-active"):n(i.currentTarget).hasClass("e-gridcontent")&&(f=n(this.gridItems).find("td").hasClass("e-active")),f&&this._selectedContent&&this._openAction()));break;case 86:i.ctrlKey&&(i.preventDefault(),!t.isNullOrUndefined(this._option)&&this._selectedContent&&(this._currentPath!=this._originalPath&&(this._currentPath=this._originalPath),this._lastFocusedElement=i.currentTarget,this._cut_copy()));break;case 46:case 67:case 68:case 88:case 113:if(i.preventDefault(),this._lastFocusedElement=i.currentTarget,f=!1,n(i.currentTarget).hasClass("e-treeview")?this._rootPath!=this._currentPath&&(f=this._treetag.find(".e-active").length>0?!0:!1):n(i.currentTarget).hasClass("e-tile-wrapper")?f=this.items.hasClass("e-active"):n(i.currentTarget).hasClass("e-gridcontent")&&(f=n(this.gridItems).find("td").hasClass("e-active")),f&&this._selectedContent)switch(s){case 46:this._deleteFolder();break;case 67:i.ctrlKey&&this._copyMoveNode("copy");break;case 68:i.ctrlKey&&this._deleteFolder();break;case 88:i.ctrlKey&&this._copyMoveNode("move");break;case 113:this._renameFolder()}break;case 93:case 121:if((i.shiftKey||s==93)&&this.model.showContextMenu)if(i.preventDefault(),this._lastFocusedElement=i.currentTarget,u=null,n(i.currentTarget).hasClass("e-treeview"))r=this._treeObj.getSelectedNode().find(".e-active"),u=this._getMenuPosition(r),this._treeMenuObj.show(u.left,u.top,r,i,!0);else{if(n(i.currentTarget).hasClass("e-tile-wrapper")){for(e=0;e<this.items.length;e++)if(r=n(this.items[e]),r.text()==this._selectedContent){u=this._getMenuPosition(r);o=r;break}}else if(n(i.currentTarget).hasClass("e-gridcontent"))for(e=0;e<this.gridItems.length;e++)if(r=n(this.gridItems[e]).find("td:first"),r.text()==this._selectedContent){u=this._getMenuPosition(r);o=r;break}u==null&&(u=n(i.currentTarget).offset(),o=n(i.currentTarget));this._viewMenuObj.show(u.left,u.top,o,i,!0)}}},_getMenuPosition:function(n){var i=n.outerHeight()/2,r=n.outerWidth()/2,t=n.offset();return{top:t.top+i,left:t.left+r}},_beforeListHover:function(n){if(activeItem=this._getActiveItem(),!activeItem.hasClass("e-disable")){var t=jQuery.Event("click",{keyCode:91,shiftKey:n,innerEvent:!0});activeItem.trigger(t)}},_getActiveItem:function(){return n(n(this._itemList)[this._activeItem])},_getURL:function(){var n=this.model.ajaxAction+"?Path="+this._currentPath+"&ActionType=Upload"+(this._selectedContent?"&SelectedItems="+JSON.stringify(this._getSelectedItemDetails(this._getFolderPath(),[this._selectedContent])):"");return this.model.ajaxSettings.upload.url&&(n=this.model.ajaxSettings.upload.url.indexOf("{")>=0?String.format(this.model.ajaxSettings.upload.url,"?Path="+this._currentPath+(this._selectedContent?"&SelectedItems="+JSON.stringify(this._getSelectedItemDetails(this._getFolderPath(),[this._selectedContent])):"")):this.model.ajaxSettings.upload.url),n},_renderUploadBox:function(){var n=this,i=this._getURL();this._uploadtag.ejUploadbox({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,height:"0px",width:"0px",uploadName:"FileUpload",autoUpload:this.model.uploadSettings.autoUpload,showFileDetails:!this.model.uploadSettings.autoUpload,dialogText:{title:n._getLocalizedLabels("Upload")},showRoundedCorner:!1,extensionsAllow:this.model.fileTypes=="*.*"?"":this.model.fileTypes.replace(/\*/g,""),multipleFilesSelection:this.model.uploadSettings.allowMultipleFile,fileSize:this.model.uploadSettings.maxFileSize,buttonText:{browse:"Upload file"},saveUrl:i,removeUrl:this.model.ajaxAction+"?Path="+this._currentPath+"&ActionType=Remove",locale:t.Uploadbox.Locale[this.model.locale]?this.model.locale:"en-US",complete:function(t){n._uploadSuccess(t)},remove:function(t){n._uploadSuccess(t)},fileSelect:function(t){var f,r,i,u;for(n._fileExplorer[n._currentPath]||n._getFileDetails(n._currentPath),f=n._fileExplorer[n._currentPath],n._existingItems=[],r=n._files=t.files,i=0;i<r.length;i++)for(u=0;u<f.length;u++)if(r[i].name==f[u].name){n._existingItems.push({Name:r[i].name,Path:n._currentPath+r[i].name,IsReplace:!0});break}n._existingItems.length&&(n._createReplaceConformationDiaolg("_customUpload","ReplaceAlert"),t.cancel=!0)},error:function(i){n._alertDialog&&n._alertDialog.is(":visible")||(n._alertDialog=n._createDialog(t.buildTag("div.e-fe-dialog-label",i.error?i.error:i.responseText),{width:400,height:"auto",title:n._getLocalizedLabels("Error")}),n._alertDialogObj=n._alertDialog.data("ejDialog"),n._alertDialogObj.initialRender=!1,n._alertDialogObj.open())},begin:function(t){var i=n._currentPath.split("/"),r={path:n._currentPath,selectedItems:n._getSelectedItemDetails(n._getFolderPath(),i[i.length-2])};n._trigger("beforeUpload",r)&&(t.cancel=!0);n._uploadtag.ejUploadbox({saveUrl:n._getURL()})}})},_customUpload:function(){for(var t,n=0;n<this._existingItems.length;n++)if(!this._existingItems[n].IsReplace)for(t=0;t<this._files.length;t++)if(this._files[t].name==this._existingItems[n].Name){this._files.splice(t,1);break}this._uploadtag.ejUploadbox({pushFile:this._files})},_uploadSuccess:function(){this._uploadtag.find(".e-dialog.e-js .e-action-perform").remove();this._fileExplorer[this._currentPath]="";this._treeObj.selectNode(this._selectedNode)},_createAddressBar:function(){this._addresstag=t.buildTag("input.e-addressBar e-tool-input","",{},{id:this._ExplorerId+"_addressbar",type:"text"});this._addresstag.appendTo(this._toolBarItems.find("#"+this._ExplorerId+"Addressbar").html(""));var i=n("<span class='e-addressbar-foldericon'><\/span>");i.insertBefore(this._addresstag)},_updateAddressBar:function(){if(this._addresstag){var n=this._currentPath;this._addresstag.val(n.replace(this._initPath,""))}},_onEpand:function(t){proxy=n("#"+this.element.attr("id")).parents(".e-fileexplorer").ejFileExplorer("instance");proxy._reSizeHandler(t)},_createSplitPane:function(){var u=this,i=t.buildTag("div"),n=t.buildTag("div"),r;this._splittag=t.buildTag("div#"+this._ExplorerId+"_splitter");i.addClass("e-cont1");n.addClass("e-cont2");this._splittag.append(i,n);this.element.append(this._splittag);this._splitObj=this._splittag.ejSplitter({enableAutoResize:!0,width:this.element.width(),cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,height:Math.ceil(this.element.height()-(this._toolBarItems?this._toolBarItems.outerHeight():0)),properties:[{paneSize:"25%"},{}],resize:function(n){u._reSizeHandler(n)}}).data("ejSplitter");this._splitObj._bar=1;this._splitObj.refresh();this._splittag.ejSplitter("option","expandCollapse",this._onEpand);r=t.buildTag("div.e-tree-wrapper");i.append(r);this._treetag=t.buildTag("div#"+this._ExplorerId+"_treeView");r.append(this._treetag);this._gridtag=t.buildTag("div#"+this._ExplorerId+"_grid");n.append(this._gridtag);this._tileViewWrapper=t.buildTag("div.e-tile-wrapper","","",{tabindex:0});n.append(this._tileViewWrapper);this._tileViewWrapper.append("<div class='e-tile-content' unselectable='on'> <\/div>");this._tileContent=this._tileViewWrapper.find(".e-tile-content");this._tileView=t.buildTag("ul#"+this._ExplorerId+"_tileView","","",{unselectable:"on"});this._tileContent.append(this._tileView);this._statusbar=t.buildTag("div","","",{tabindex:0});this._statusbar.insertAfter(this._tileView);n.append(this._statusbar);this.model.showFooter&&this._createStatusBar();this._waitingPopup=this._splittag.find(".e-cont2").ejWaitingPopup({showOnInit:!1,cssClass:this.model.cssClass}).data("ejWaitingPopup");this._showHideSplitBar(!0);this._showHideContextMenu();this.model.layout=="grid"?this._tileContent.parent().hide():this._gridtag.hide();this._createUploadBox()},_selectedFolder:function(n){var e=n.replace(this._initPath,""),r=this._treeObj.getSelectedNode(),f=e.split("/"),t,u,i;for(e&&this._treeObj.selectNode(this._treeObj.element.find("li:first")),t=0;t<f.length;t++)if(f[t]!="")for(r=this._treeObj.getSelectedNode(),this._treeObj.isExpanded(r)||r.find(".e-icon").click(),u=r.find("ul:first>li").find("div:first .e-text"),i=0;i<u.length;i++)u[i].text==f[t]&&this._treeObj.selectNode(u[i].parentNode.parentNode)},_setSelectedItems:function(t){var f,r,u,i,e;if(typeof t=="string"&&(t=[t]),this._removeOldSelectionDetails(),this.model.layout=="grid"){for(this._gridObj.clearSelection(),f=this._gridObj.multiSelectCtrlRequest,this._gridObj.multiSelectCtrlRequest=!0,r=this._gridtag.find(".e-gridcontent tr"),u=0;u<t.length;u++)for(i=0;i<r.length;i++)t[u]==n(r[i]).find("td:first").text()&&this._gridObj.selectRows(i,null,n(r[i]).find("td:first"));this._gridObj.multiSelectCtrlRequest=f}else for(this.items.removeClass("e-active").attr("aria-selected",!1),r=this._tileView.find(".e-tilenode"),u=0;u<t.length;u++)for(i=0;i<r.length;i++)t[u]==n(r[i]).text()&&(e=jQuery.Event("click",{keyCode:91,ctrlKey:!0,innerEvent:!0}),n(r[i]).trigger(e))},_refreshTreeScroller:function(){this._treetag.hasClass("e-content")&&this._treetag.addClass("e-content");this._treeScroll&&this._treeScroll.refresh()},_createStatusBar:function(){var i,n;this._statusbar.addClass("e-statusbar");this._itemStatus=t.buildTag("div.e-itemStaus");this._selectedItemsTag=t.buildTag("div.e-itemStaus e-selected-items");this._switchBtn=t.buildTag("div.e-switchView");this._statusbar.append(this._switchBtn,this._itemStatus,this._selectedItemsTag);this.model.enableResize&&(this._resizeItem=t.buildTag("div.e-icon e-fe-resize e-resize-handle"),this._resizeItem.insertBefore(this._switchBtn));i=this._splittag.find(".e-cont2").outerHeight()-this._statusbar.outerHeight();this._gridtag.height(i);n=t.buildTag("button.e-switchGridView#"+this._ExplorerId+"_switchGridView","",{},{title:this._getLocalizedLabels("Grid"),tabindex:0});this._switchBtn.append(n);n.ejButton({type:"button",size:"normal",contentType:"imageonly",prefixIcon:"e-switchGridView-icon"});n=t.buildTag("button.e-swithListView#"+this._ExplorerId+"_swithListView","",{},{title:this._getLocalizedLabels("Tile"),tabindex:0});this._switchBtn.append(n);n.ejButton({type:"button",size:"normal",contentType:"imageonly",prefixIcon:"e-swithListView-icon"});this.model.layout=="grid"?this._statusbar.find(".e-switchGridView").addClass("e-active"):this._statusbar.find(".e-swithListView").addClass("e-active");this._statusBarEvents("_off");this._statusBarEvents("_on")},_statusBarEvents:function(n){this[n](this._statusbar,"focus",this._focusStatusBar);this[n](this._statusbar,"blur",this._blurStatusBar)},_focusStatusBar:function(){this._statusbar.hasClass("e-focus")||(this._statusbar.addClass("e-focus"),this._itemList=this._switchBtn.find("button"),this._on(this._statusbar,"keydown",this._OnKeyDown))},_blurStatusBar:function(){this._statusbar.removeClass("e-focus");this._off(this._statusbar,"keydown",this._OnKeyDown)},_refreshResizeHandler:function(){this._setMinMaxSizeInInteger();this.adjustSize();this.model.showFooter&&this.model.enableResize&&this._resizeFileExplorer()},_refreshResizeEventHandler:function(t){var i=n(t.element).parents("div.e-fileexplorer");this.model.height=n(i).outerHeight();this.model.width=n(i).outerWidth();this.element.css({height:this.model.height,width:this.model.width});this.adjustSize()},_convertPercentageToPixel:function(n,t){return Math.round(t*n/100)},_getProperValue:function(n){return n==null?null:isNaN(n)?n:n},_setMinMaxSizeInInteger:function(){var t;this._minWidth=parseInt(this.model.minWidth);this._minHeight=parseInt(this.model.minHeight);this._maxWidth=parseInt(this.model.maxWidth);this._maxHeight=parseInt(this.model.maxHeight);t=this.element.parent()[0].nodeName=="BODY"?n(window):n(this.element.parent()[0]);isNaN(this.model.minWidth)&&this.model.minWidth.indexOf("%")>0&&(this._minWidth=this._convertPercentageToPixel(t.outerWidth(),this._minWidth));isNaN(this.model.minHeight)&&this.model.minHeight.indexOf("%")>0&&(this._minHeight=this._convertPercentageToPixel(t.outerHeight(),this._minHeight));isNaN(this.model.maxWidth)&&this.model.maxWidth.indexOf("%")>0&&(this._maxWidth=this._convertPercentageToPixel(t.innerWidth(),this._maxWidth));isNaN(this.model.maxHeight)&&this.model.maxHeight.indexOf("%")>0&&(this._maxHeight=this._convertPercentageToPixel(t.innerHeight(),this._maxHeight))},_resizeFileExplorer:function(){var t=this;this.element.find("div.e-fe-resize").ejResizable({minHeight:t._minHeight,minWidth:t._minWidth,maxHeight:t._maxHeight,maxWidth:t._maxWidth,resizeStart:function(n){t._trigger("resizeStart",{event:n})},resize:function(n){t._refreshResizeEventHandler(n);t._trigger("resize",{event:n})},resizeStop:function(n){t._refreshResizeEventHandler(n);t._trigger("resizeStop",{event:n})},helper:function(){return n(t.element)}})},_showHideSplitBar:function(n){if(this._splittag.show(),this._splitObj.model.properties[1].paneSize==0)this.element.find(".e-splitbar").show(),this._splitObj.expand(1),!this._gridtag.hasClass("e-grid")&&n&&this._updateData();else if(this._splitObj.model.properties[0].paneSize==0){this.element.find(".e-splitbar").show();var t=proxy._splittag.outerWidth();proxy.element.find(".e-cont2").width(t-this.element.find(".e-splitbar").outerWidth()-1);this._splitObj.expand(0)}this.model.showNavigationPane||(this._splitObj.collapse(0),this.element.find(".e-splitbar").hide(),!this._gridtag.hasClass("e-grid")&&n&&this._updateData())},_updateTreePath:function(i){var r,u,i;if(this._removeBlurEffect(),this._searchbar&&this._searchbar.val(""),this._selectedTreeText=this._selectedContent=i.value,this._selectedNode=i.currentElement,r=n(this._selectedNode.parents("li.e-item")[0]),this._parentNode=r.length!=0?r:this._selectedNode,this._nodeType="Directory",this._initUpdate?this._currentPath=this._updatePath(i.currentElement,i.value):this._initUpdate=!0,this._updateOnNodeSelection&&this._updateData(),this._originalPath=this._currentPath,!this._isStateNavigation){if(!t.isNullOrUndefined(this._currentState)){for(u=this._selectedStates.length-1;u>this._currentState;u--)this._selectedStates.pop();this._toolBarItems&&this._disableToolbarItem("Forward")}this._selectedStates[this._selectedStates.length-1]!=this._originalPath&&(this._currentState=this._selectedStates.length,this._selectedStates.push(this._originalPath),this._selectedStates.length==2&&this._toolBarItems&&this._enableToolbarItem("Back"))}this.model.selectedFolder=this._currentPath;this._updateAddressBar();this._currntNode=this._selectedNode.find("> div > .e-text");this.model.selectedItems=[];this._selectedItems=[];this._selectedTileItems=[];i={name:"",path:this._currentPath,selectedItems:this._getSelectedItemDetails(this._getFolderPath(),this._selectedContent)};this._trigger("select",i);this._toolBarItems&&this._disableToolbarItem("Download")},_modifySelectedStates:function(t,i){var r=this;n.each(r._selectedStates,function(n,u){u&&u.startsWith(t)&&(r._selectedStates[n]=i?r._selectedStates[n].replace(t,i):i)})},_onBeforeCollapse:function(){this._collapse=!0},_updatePath:function(t,i){for(var u="",r=0;r<t.parents("ul").length-1;r++)n(t.parents("ul")[r]).siblings("div").find("a").text()&&(u=n(t.parents("ul")[r]).siblings("div").find("a").text()+"/"+u);return this._initPath+u+i+"/"},_updatePathFromGrid:function(t){var o=this,f=n(t.target),s,r,e,i,u,t;for(this._addFocus(this._gridtag.find(".e-gridcontent")),r=!0,this._isTreeNode=!1,this._selectedItems=[],e=0,i=this._gridtag.ejGrid("getSelectedRecords"),u=0;u<i.length;u++)this._selectedItems.push(i[u].name),e+=i[u].sizeInByte,i[u].isFile||(r=!1);this._currentPath!=this._originalPath&&(this._currentPath=this._originalPath);n.each(o._fileExplorer[o._originalPath],function(n,i){i.name!=t.data.name||i.isFile||(s=!0)});s?(this._nodeType="Directory",f.hasClass("e-active")&&this._updateNode(t.data.name)):this._nodeType="File";this._currntNode=f[0]!=null&&f.parent("tr");this._selectedContent=t.data.name;!f.hasClass("e-active")&&i.length>0&&(this._selectedContent=i[i.length-1].name,this._nodeType=i[i.length-1].isFile?"File":"Directory",this._nodeType=="Directory"&&this._updateNode(this._selectedContent));this._selectedItemsTag&&this._selectedItemsTag.html((this._selectedItems.length>1?this._selectedItems.length+" items Selected":i[0]?i[0].name:"")+(e?r?",  "+this._bytesToSize(e):"":""));this.model.selectedItems=this._selectedItems;t={name:this._selectedItems,path:this.model.selectedFolder,selectedItems:this._getSelectedItemDetails(this.model.selectedFolder,this._selectedItems)};this._urlTag&&this._urlTag.find("input").val(t.path);this._nameTag&&this._nameTag.find("input").val(t.name);this._selectedItems.length==0?this._removeOldSelectionDetails():(this._toolBarItems&&(r?this._enableToolbarItem("Download"):this._disableToolbarItem("Download")),this._viewMenuObj&&(r?this._restrictedMenuOption.indexOf(this._menuDownload)<0&&this._viewMenuObj.enableItem(this._menuDownload):this._viewMenuObj.disableItem(this._menuDownload)),this._enableEditingTools());this._isClicked&&this._trigger("select",t);this._isupdate=r},_enableEditingTools:function(){var t,n;if(!this._editingToolsState&&this._toolBarItems){for(t=["Rename","Delete","Cut","Copy"],n=0;n<t.length;n++)this._enableToolbarItem(t[n]);this._editingToolsState=!0}},_enableToolbarItem:function(n){if(this._restrictedToolbarOptions.indexOf(n)<0){var t=this._ExplorerId+n.replace(/ /g,"");this._toolBarObj&&this._toolbar.find("li#"+t).hasClass("e-disable")&&this._toolBarObj.enableItemByID(t)}},_disableToolbarItem:function(n){var t=this._ExplorerId+n.replace(/ /g,"");this._toolBarObj&&!this._toolbar.find("li#"+t).hasClass("e-disable")&&this._toolBarObj.disableItemByID(t)},_disableEditingTools:function(){var t,n;if(this._toolBarItems){for(t=["Rename","Delete","Cut","Copy"],n=0;n<t.length;n++)this._disableToolbarItem(t[n]);this._editingToolsState=!1}},_upDatePathFromTileView:function(t){var f,c,o,s,a,u,r;if(t.innerEvent||(this._lastItemIndex=n(t.currentTarget).index()),this._addFocus(this._tileViewWrapper),this._isTreeNode=!1,t.shiftKey){for(this._selectItems=[],this._startNode||(this._startNode=this._currntNode),o=n(t.currentTarget).index(),s=this._startNode.index(),o>s&&(a=o,o=s,s=a),u=this._tileContent.find(".e-tilenode"),u.removeClass("e-active").attr("aria-selected",!1),r=o;r<=s;r++)this._selectItems.push(n(u.get(r)).find(".e-name").text());this._setSelectedItems(this._selectItems)}else{t.ctrlKey&&this.model.allowMultiSelection||(this._sizeInByte=0,this._selectedItems=[],this._selectedTileItems=[],n(t.currentTarget).siblings().removeClass("e-active").attr("aria-selected",!1),n(t.currentTarget).removeClass("e-active").attr("aria-selected",!1));n(t.currentTarget).hasClass("e-active")?n(t.currentTarget).removeClass("e-active").attr("aria-selected",!1):n(t.currentTarget).addClass("e-active").attr("aria-selected",!0);var h="File",e=!0,l=n(t.currentTarget).find(".e-name").text();if(this._currentPath!=this._originalPath&&(this._currentPath=this._originalPath),u=this._fileExplorer[this._currentPath],u)for(r=0;r<u.length;r++)if(u[r].name==l){n(t.currentTarget).hasClass("e-active")?(this._sizeInByte+=u[r].sizeInByte,this._selectedTileItems.push(u[r])):t.ctrlKey&&(this._sizeInByte-=u[r].sizeInByte,f=n.inArray(u[r],this._selectedTileItems),f>-1&&this._selectedTileItems.splice(f,1));break}n.each(this._selectedTileItems,function(n,t){if(!t.isFile)return this._update=e=!1,!1});n(t.currentTarget).find(".e-folder-icon").length&&(h="Directory",n(t.currentTarget).hasClass("e-active")&&this._updateNode(l));this._currntNode=n(t.currentTarget);this._selectedContent=l;n(t.currentTarget).hasClass("e-active")?this._selectedItems.push(this._selectedContent):(f=n.inArray(this._selectedContent,this._selectedItems),f>-1&&this._selectedItems.splice(f,1),this._selectedTileItems.length>0&&(this._selectedContent=this._selectedTileItems[this._selectedTileItems.length-1].name,h=this._selectedTileItems[this._selectedTileItems.length-1].type,h=="Directory"&&this._updateNode(this._selectedContent)));this._startNode&&this._selectItems.length!=0&&this._selectItems.length!=this._selectedItems.length||((!this._selectItems||this._selectItems.length<=0)&&(this._startNode=null),this._selectedItemsTag&&this._selectedItemsTag.html(this._selectedItems.length>0?(this._selectedItems.length>1?this._selectedItems.length+" items Selected ":this._tileView.find(".e-active").text())+(this._sizeInByte?",  "+this._bytesToSize(this._sizeInByte):""):""),this._nodeType=h,this.model.selectedItems=this._selectedItems,c={name:this._selectedItems,path:this.model.selectedFolder,selectedItems:this._getSelectedItemDetails(this.model.selectedFolder,this._selectedItems)},this._urlTag&&this._urlTag.find("input").val(c.url),this._nameTag&&this._nameTag.find("input").val(c.name),this._selectedItems.length==0?this._removeOldSelectionDetails():(this._toolBarItems&&(e?this._enableToolbarItem("Download"):this._disableToolbarItem("Download")),this._viewMenuObj&&(e?this._restrictedMenuOption.indexOf(this._menuDownload)<0&&this._viewMenuObj.enableItem(this._menuDownload):this._viewMenuObj.disableItem(this._menuDownload)),this._enableEditingTools()),this._isClicked&&this._trigger("select",c),this._selectItems=[])}e!=i&&(this._isupdate=e)},_updateNode:function(n){this._currentPath+=n+"/"},_getFileURL:function(){return this._nodeType=="File"?(/\.(gif|jpg|jpeg|tiff|png|bmp)$/i.test(this._selectedContent)?(this._widthTag&&this._widthTag.show().removeClass("e-hide"),this._heightTag&&this._heightTag.show().removeClass("e-hide")):(this._widthTag&&this._widthTag.hide().addClass("e-hide"),this._heightTag&&this._heightTag.hide().addClass("e-hide")),this._currentPath.replace("~","..")+this._selectedContent):""},_updateData:function(){var n=this._fileExplorer[this._currentPath],t=0,i;if(n)for(i=0;i<n.length;i++)t+=n[i].sizeInByte;this._selectedItemsTag&&this._selectedItemsTag.html("");t=this._bytesToSize(t);n&&!this._update?(this._itemStatus&&this._itemStatus.html(n.length+" "+(n.length==1?this._getLocalizedLabels("Item"):this._getLocalizedLabels("Items"))+(t?", "+this._getLocalizedLabels("Size")+": "+t:"")),this.model.layout=="grid"?this._renderGridView(n):this._renderTileView(n)):this._read()},_addChild:function(t,i){var f=[],r,u;if(t)for(r=0;r<t.length;r++)t[r].isFile||(t[r].id=t[r].name,t[r].spriteCssClass="e-tree-foldericon",f.push(t[r]));this._nodeExpanded=!0;u=i?n(i).closest("li.e-item"):this._treeObj.getSelectedNode();f.length&&this._treeObj.addNode(f,u);u.find(".e-load")&&u.find(".e-load").removeClass("e-load");this._nodeExpanded=!1;this._treetag.find("li").removeAttr("tabindex")},_createContextMenuTag:function(i,r,u){var e=n("body").find("#"+r.id+"ContextMenu"),f=e.length?e:t.buildTag("ul.fe-context-menu #"+r.id+"ContextMenu");return f.ejMenu({menuType:t.MenuType.ContextMenu,enableSeparator:!0,enableRTL:this.model.enableRTL,cssClass:this.model.cssClass,contextMenuTarget:r.targetId,beforeOpen:u.beforeOpen,close:u.close,click:u.click,fields:{dataSource:i,id:"text",text:"text",htmlAttribute:"htmlAttr",spriteCssClass:"sprite"}}),f.hide(),f},_beforeOpenContextMenu:function(t){n(t.target).hasClass("e-text")?(this._menuNode=n(t.target).closest("li.e-item"),this._treeObj&&this._treeObj.element.find(".e-node-focus").removeClass("e-node-focus"),this._menuNode.find("> div > .e-text:first").addClass("e-node-focus"),n(t.target).parents("li.e-item:first").attr("id")==1?(this._treeMenuObj.disableItem(this._menuCut),this._treeMenuObj.disableItem(this._menuCopy),this._treeMenuObj.disableItem(this._menuDelete),this._treeMenuObj.disableItem(this._menuRename)):(this._restrictedMenuOption.indexOf(this._menuCut)<0&&this._treeMenuObj.enableItem(this._menuCut),this._restrictedMenuOption.indexOf(this._menuCopy)<0&&this._treeMenuObj.enableItem(this._menuCopy),this._restrictedMenuOption.indexOf(this._menuDelete)<0&&this._treeMenuObj.enableItem(this._menuDelete),this._restrictedMenuOption.indexOf(this._menuRename)<0&&this._treeMenuObj.enableItem(this._menuRename))):t.cancel=!0},_beforeOpenTileContextMenu:function(t){if(n(t.target).hasClass("e-scrollbar")||n(t.target).parents().hasClass("e-scrollbar")){t.cancel=!0;return}n(t.target).hasClass("e-rowcell")&&!n(t.target).hasClass("e-active")&&t.events&&(t.events.button==2||t.events.which==3)?this._updateGridSelection(t):!(n(t.target).is(".e-tilenode")||n(t.target).closest("li").hasClass("e-tilenode"))||n(t.target).is(".e-tilenode.e-active")||n(t.target).closest(".e-tilenode").hasClass("e-active")||this._updateTileSelection(t);n(t.target).is(".e-tilenode.e-active")||n(t.target).closest(".e-tilenode").hasClass("e-active")||n(t.target).is(".e-rowcell.e-active")||t.events.ctrlKey&&(n(this.items).hasClass("e-active")||n(this.gridItems).find("td").hasClass("e-active"))?JSON.stringify(this._viewMenuObj.model.fields.dataSource)==JSON.stringify(this._cwdMenuOptions)&&this._viewMenuObj.option("fields",{dataSource:this._fileMenuOptions,id:"text",text:"text",htmlAttribute:"htmlAttr",spriteCssClass:"sprite"}):(JSON.stringify(this._viewMenuObj.model.fields.dataSource)==JSON.stringify(this._fileMenuOptions)&&this._viewMenuObj.option("fields",{dataSource:this._cwdMenuOptions,id:"text",text:"text",htmlAttribute:"htmlAttr",spriteCssClass:"sprite"}),n(t.events.currentTarget).hasClass("e-grid")&&(n(t.target).hasClass("e-gridcontent")||n(t.target).hasClass("e-content")||n(t.target).hasClass("e-table")||!n(t.target).is(".e-rowcell.e-active"))&&this._gridObj.clearSelection(),n(t.events.currentTarget).hasClass("e-tile-wrapper")&&(n(t.target).hasClass("e-tile-wrapper")||n(t.target).hasClass("e-tile-content")||n(t.target).hasClass("e-tileview")||!(n(t.target).is(".e-tilenode.e-active")||n(t.target).parent(".e-tilenode").hasClass("e-active")))&&this.items.hasClass("e-active")&&this.items.removeClass("e-active").attr("aria-selected",!1),this._removeOldSelectionDetails());for(var i=0;i<this._restrictedMenuOption.length;i++)this._viewMenuObj&&this._viewMenuObj.disableItem(this._restrictedMenuOption[i]);/\.(bmp|dib|jpg|jpeg|jpe|jfif|gif|tif|tiff|png|ico)$/i.test(this.model.selectedItems)||this._nodeType!="File"?this._viewMenuObj&&this._viewMenuObj.enableItem("Open"):this._viewMenuObj&&this._viewMenuObj.disableItem("Open");this._option||this._viewMenuObj.disableItem(this._menuPaste);this._isupdate?this._restrictedMenuOption.indexOf(this._menuDownload)<0&&this._viewMenuObj.enableItem(this._menuDownload):this._viewMenuObj.disableItem(this._menuDownload)},_removeOldSelectionDetails:function(){this._currentPath!=this._originalPath&&(this._currentPath=this._originalPath);this._sizeInByte=0;this._selectedItems=[];this._selectedTileItems=[];this.model.selectedItems=[];this._selectedContent=this._selectedTreeText;this._nodeType="Directory";this._selectedItemsTag&&this._selectedItemsTag.html("");this._toolBarItems&&this._disableToolbarItem("Download");this._viewMenuObj&&this._viewMenuObj.disableItem(this._menuDownload);this._disableEditingTools()},_contextMenuClick:function(n){this._treeObj.selectNode(this._menuNode);this._fileContextMenuClick(n)},_fileContextMenuClick:function(n){if(this.model.ajaxAction!=""&&this._currentPath!="")switch(n.text){case this._menuOpen:this._openAction();break;case this._menuNewFolder:this._createNewFolder();break;case this._menuDelete:this._deleteFolder();break;case this._menuRefresh:this.refresh();break;case this._menuRename:this._renameFolder();break;case this._menuUpload:this.element.find(".e-uploadinput").click();break;case this._menuDownload:this._downloadFile();break;case this._menuCut:this._copyMoveNode("move");break;case this._menuCopy:this._copyMoveNode("copy");break;case this._menuPaste:this._cut_copy();break;case this._menuGetinfo:this._getDetails()}},_createNewFolder:function(){var i=this,r="",c=this._getLocalizedLabels("NewFolderAlert"),e=t.buildTag("div.e-get-name"),l=t.buildTag("div.e-fe-dialog-label",c),u=t.buildTag("input.e-fe-dialog-text e-ejinputtext","","",{type:"text"}),h;u.val("New folder");var o=t.buildTag("div.e-fe-dialog-btn"),f=t.buildTag("button.e-fe-btn-ok ",this._getLocalizedLabels("OkButton")),s=t.buildTag("button.e-fe-btn-cancel ",this._getLocalizedLabels("CancelButton"));f.ejButton({type:"button",click:function(){var f,e,l;if(i._removeDialog(i._newFolderDialogObj),r=u.val(),n.trim(r)||(r="New folder"),i._fileExplorer[i._currentPath]||i._getFileDetails(i._currentPath),f=i._fileExplorer[i._currentPath],f.length)for(e=0;e<f.length;e++)if(f[e].isFile||f[e].name!=r)e==f.length-1&&r&&i._createFolder(r);else{var s=t.buildTag("div.e-get-name"),a=t.buildTag("div.e-fe-dialog-label",String.format(i._getLocalizedLabels("ErrorOnFolderCreation"),r)),h=t.buildTag("div.e-fe-dialog-btn"),o=t.buildTag("button.e-fe-btn-ok ",i._getLocalizedLabels("YesButton")),c=t.buildTag("button.e-fe-btn-cancel ",i._getLocalizedLabels("NoButton"));o.ejButton({type:"button",click:function(){i._removeDialog(i._alertDialogObj)}});c.ejButton({type:"button",click:function(){i._removeDialog(i._alertDialogObj);i._createFolder(i._getDuplicateName(f,"New folder"))}});h.append(o,c);n(s).append(a,h);l=function(){o.focus()};i._alertDialog=i._createDialog(s,{width:400,height:"auto",title:i._getLocalizedLabels("Error"),open:l});i._alertDialogObj=i._alertDialog.data("ejDialog");i._alertDialogObj.initialRender=!1;i._alertDialogObj.open();break}else r&&i._createFolder(r)}});s.ejButton({type:"button",click:function(){i._removeDialog(i._newFolderDialogObj)}});o.append(f,s);n(e).append(l,u,o);h=function(){u.focus();u.select();u.keyup(function(n){var t=i._getKeyCode(n);t==13&&f.click()})};this._newFolderDialog=this._createDialog(e,{width:350,height:"auto",open:h,title:this._getLocalizedLabels("NewFolder")});this._newFolderDialogObj=this._newFolderDialog.data("ejDialog");this._newFolderDialogObj.initialRender=!1;this._newFolderDialogObj.open()},_deleteFolder:function(){var i,f;this._alertWindow=t.buildTag("div#e-fe_deleteAlert");i=this._selectedItems.length>1?String.format(this._getLocalizedLabels("DeleteMultipleFolder"),this._selectedItems.length):this._getLocalizedLabels("DeleteFolder")+this._selectedContent+"?";var e=t.buildTag("div.e-fe-dialog-label",i),r=t.buildTag("div.e-fe-dialog-btn"),n=t.buildTag("button.e-fe-btn-ok",this._getLocalizedLabels("OkButton")),u=t.buildTag("button.e-fe-btn-cancel",this._getLocalizedLabels("CancelButton"));r.append(n,u);this._alertWindow.append(e,r);proxy=this;n.ejButton({type:"button",click:function(){proxy._removeDialog(proxy._alertWindowObj);proxy._ajax_folderPath=proxy._nodeType=="Directory"?proxy._getFolderPath():proxy._currentPath;proxy._deletion(proxy._selectedItems.length>1?proxy._selectedItems:proxy._selectedContent,proxy._ajax_folderPath);proxy._disableEditingTools()}});u.ejButton({type:"button",click:function(){proxy._removeDialog(proxy._alertWindowObj)}});f=function(){n.focus()};this._alertWindow=this._createDialog(this._alertWindow,{width:350,height:"auto",title:this._getLocalizedLabels("Delete"),open:f});this._alertWindowObj=this._alertWindow.data("ejDialog");this._alertWindowObj.initialRender=!1;this._alertWindowObj.open()},_getFileDetails:function(t,r,u){var f=this,e={data:{ActionType:"Read",Path:t,ExtensionsAllow:this.model.fileTypes,SelectedItems:this._getSelectedItemDetails(this._getFolderPath(t),this.model.selectedItems.length?this.model.selectedItems:this._selectedContent)},url:this.model.ajaxAction,type:"POST",async:!1,success:function(i){i=i.hasOwnProperty("d")?i.d:i;for(var e=0;e<i.files.length;e++)i.files[e].sizeInByte=i.files[e].size,i.files[e].size=i.files[e].size?f._bytesToSize(i.files[e].size):"";f._fileExplorer[t]=i.files;r&&f._addChild(f._fileExplorer[t],n(r));u&&(f.model.layout=="grid"?f._renderGridView(i.files):f._renderTileView(i.files));f._highlightedNodes&&(f._setSelectedItems(f._highlightedNodes),f._highlightedNodes="")},successAfter:this.model.ajaxSettings.read.success};this.model.ajaxSettings.read.success=i;n.extend(!0,e,this.model.ajaxSettings.read);this._sendAjaxRequest(e)},_getDuplicateName:function(n,t){for(var i=0,r=t;this._isNameExist(n,t);)i++,t=r.split(".")[0]+(i>0?"("+i+")":"")+(t.split(".")[1]?"."+t.split(".")[1]:"");return t},_isNameExist:function(n,t){for(var i=0;i<n.length;i++)if(t==n[i].name)return!0;return!1},_renameFolder:function(){var i=this,h=this._getLocalizedLabels("RenameAlert"),f=t.buildTag("div.e-rename"),c=t.buildTag("div.e-fe-dialog-label",h),r=t.buildTag("input.e-fe-dialog-text e-ejinputtext","","",{type:"text",value:this._nodeType=="File"?this._selectedContent.split(".")[0]:this._selectedContent}),e=t.buildTag("div.e-fe-dialog-btn"),u=t.buildTag("button.e-fe-btn-ok",this._getLocalizedLabels("OkButton")),o=t.buildTag("button.e-fe-btn-cancel",this._getLocalizedLabels("CancelButton")),s;u.ejButton({type:"button",click:function(){var u=r.val(),v=i._nodeType=="File"?i._selectedContent.split(".")[0]:i._selectedContent,o,e,f,a;if(i._removeDialog(i._renameDialogObj),n.trim(u)&&u!=v)for(o=i._nodeType=="File"?i._selectedContent.split(".")[1]:"",u=o?u+"."+o:u,i._currentPath=i._nodeType=="Directory"?i._getFolderPath():i._currentPath,i._fileExplorer[i._currentPath]||i._getFileDetails(i._currentPath),e=i._fileExplorer[i._currentPath],i._ajax_person=u,f=0;f<e.length;f++)if(e[f].name==u){i._nodeType=="File"&&(u=i._getDuplicateName(i._fileExplorer[i._currentPath],u),i._ajax_person=u);var h=t.buildTag("div.e-get-name"),y=t.buildTag("div.e-fe-dialog-label",String.format(i._getLocalizedLabels(i._nodeType=="File"?"DuplicateFileCreation":"ErrorOnFolderCreation"),u)),c=t.buildTag("div.e-fe-dialog-btn"),s=t.buildTag("button.e-fe-btn-ok ",i._getLocalizedLabels("OkButton")),l=t.buildTag("button.e-fe-btn-cancel ",i._getLocalizedLabels("CancelButton"));s.ejButton({type:"button",click:function(){i._removeDialog(i._alertDialogObj);i._nodeType=="File"?i._rename():(i._existingItems=[],i._getDuplicateItems(i._currentPath+i._selectedContent+"/",i._currentPath+u+"/",!0),i._existingItems.length?i._createReplaceConformationDiaolg("_rename","DuplicateAlert"):i._rename())}});l.ejButton({type:"button",click:function(){i._removeDialog(i._alertDialogObj)}});c.append(s,l);n(h).append(y,c);a=function(){s.focus()};i._alertDialog=i._createDialog(h,{width:400,height:"auto",title:i._getLocalizedLabels("Error"),open:a});i._alertDialogObj=i._alertDialog.data("ejDialog");i._alertDialogObj.initialRender=!1;i._alertDialogObj.open();break}else f==e.length-1&&i._rename()}});o.ejButton({type:"button",click:function(){i._removeDialog(i._renameDialogObj)}});e.append(u,o);n(f).append(c,r,e);s=function(){r.focus();r.select();r.keyup(function(n){var t=i._getKeyCode(n);t==13&&u.click()})};this._renameDialog=this._createDialog(f,{width:350,height:"auto",open:s,title:this._getLocalizedLabels("Rename")});this._renameDialogObj=this._renameDialog.data("ejDialog");this._renameDialogObj.initialRender=!1;this._renameDialogObj.open()},_isSelectedFile:function(n,t){for(var i=0;i<n.length;i++)if(t==n[i])return!0;return!1},_refreshItems:function(t,i){var f,u,r;for(t=n(t),this._fileExplorer[i]="",f=this,n.each(f._fileExplorer,function(n){n.startsWith(i)&&(f._fileExplorer[n]="")}),u=t.find("ul:first > li"),r=0;r<u.length;r++)t.find(u[r]).length&&this._treeObj.removeNode(n(u[r]));this._getFileDetails(i,t.find("> div > .e-text"),!0)},_getDuplicateItems:function(n,t,i){var u,e,f,r;for(this._fileExplorer[t]||this._getFileDetails(t),u=this._fileExplorer[t],this._fileExplorer[n]||this._getFileDetails(n),e=this._fileExplorer[n],f=0;f<e.length;f++)for(r=0;r<u.length;r++)e[f].name==u[r].name&&(i==!0||this._isSelectedFile(i,u[r].name))&&(this._existingItems[this._existingItems.length]={Name:u[r].name,Path:t+u[r].name+(u[r].isFile?"":"/"),IsReplace:!0},u[r].isFile||this._getDuplicateItems(n+e[f].name+"/",t+u[r].name+"/",!0))},_backward:function(){var i;if(this._currentState>0){var n=!0,t=0;for(this._isStateNavigation=!0,i=this._currentState,--this._currentState;this._selectedStates[this._currentState]==""||this._selectedStates[this._currentState]==this._selectedStates[i];)this._currentState?--this._currentState:n=!1;n&&this._selectedFolder(this._selectedStates[this._currentState]);this._isStateNavigation=!1;(this._currentState==t||this._selectedStates.length-2==this._currentState)&&this._toolBarItems&&this._enableToolbarItem("Forward");this._currentState==t&&this._toolBarItems&&this._disableToolbarItem("Back")}},_forward:function(){var t;if(this._currentState+1<this._selectedStates.length){var n=!0;for(this._isStateNavigation=!0,t=this._currentState,++this._currentState;this._selectedStates[this._currentState]==""||this._selectedStates[this._currentState]==this._selectedStates[t];)this._currentState<this._selectedStates.length-1?++this._currentState:n=!1;n&&this._selectedFolder(this._selectedStates[this._currentState]);this._isStateNavigation=!1;this._selectedStates.length-1==this._currentState&&this._toolBarItems&&this._disableToolbarItem("Forward");this._currentState==0&&this._toolBarItems&&this._disableToolbarItem("Back");this._currentState==1&&this._toolBarItems&&this._enableToolbarItem("Back")}},_copyMoveNode:function(n){var t,i;n=="move"&&(this.element.find(".e-blur").removeClass("e-blur"),t=this.element.find(".e-splitter .e-active"),t.length&&t.length==1?t.addClass("e-blur"):this.element.find(".e-cont2 .e-active").addClass("e-blur"));this._option=n;this._sourcePath=this._nodeType=="Directory"?this._getFolderPath():this._currentPath;this._sourceType=this._nodeType;this._fileName=this._selectedItems.length>1?this._selectedItems:this._selectedContent;this._refreshNode=this._originalPath!=this._currentPath?this._findMatchingElement(this._selectedNode.find("ul:first"),this._selectedContent):this._selectedNode;this._toolBarItems&&this._enableToolbarItem("Paste");this.model.showContextMenu&&(this._restrictedMenuOption.indexOf(this._menuPaste)<0&&this._viewMenuObj.enableItem(this._menuPaste),this._restrictedMenuOption.indexOf(this._menuPaste)<0&&this._treeMenuObj.enableItem(this._menuPaste));i={name:this._fileName,sourcePath:this._sourcePath,selectedItems:this._getSelectedItemDetails(this._sourcePath,this._fileName)};n=="move"?this._trigger("cut",i):this._trigger("copy",i)},_openAction:function(){var i=this,s,r,o,e,u,f,c,l;if(!this._onBeforeOpen()){if(this._nodeType=="Directory"){for(r=this._treeObj.getSelectedNode(),o=this._selectedContent,this._treeObj.isExpanded(r)||r.find(".e-icon").click(),e=r.find("ul:first>li").find("div:first .e-text"),this._treeObj.hasChildNode(r)||(u=this._isTreeNode==!0?this._currentPath:this._currentPath.replace(this._selectedContent+"/",""),this._isTreeNode=!1,this._addChild(this._fileExplorer[u])),f=0;f<e.length;f++)if(n(e[f]).text()==o){this._treeObj.selectNode(e[f].parentNode.parentNode);break}s=this._getSelectedItemDetails(this._getFolderPath(),o);this._selectedItems=[];this._selectedTileItems=[]}else if(this._nodeType=="File"&&(this._selectedFile=this._selectedContent,/\.(bmp|dib|jpg|jpeg|jpe|jfif|gif|tif|tiff|png|ico)$/i.test(this._selectedFile))){i._openDialog=t.buildTag("div.e-imageViewer","","",{id:i._ExplorerId+"_basicDialog",title:i._selectedFile});var u=i._currentPath.replace("~","..")+this._selectedFile,h=this._getImage(u,this._selectedFile),a=t.buildTag("img","","",{src:h?h:u});n(i._openDialog).append(a);n(i.element).append(i._openDialog);i._openDialog.ejDialog({width:450,height:350,minHeight:200,minWidth:300,closeIconTooltip:i._getLocalizedLabels("DialogCloseToolTip"),enableRTL:i.model.enableRTL,cssClass:i.model.cssClass,close:function(n){i._onDialogClose(n)}}).parents(".e-dialog-wrap").addClass("e-imageViewer-wrap");i._openDialog.css("height","90%");i._openDialogObj=i._openDialog.data("ejDialog")}c=this._nodeType=="File"?u:this._currentPath;l={path:c,itemType:this._nodeType,selectedItems:s};this._trigger("open",l)}},_getSelectedItemDetails:function(n,t){var f,i,u,r;if(typeof t=="string"&&(t=[t]),f=[],i=this._fileExplorer[n],i)for(u=0;u<t.length;u++)for(r=0;r<i.length;r++)i[r].name==t[u]&&f.push(i[r]);return f},_getDetails:function(){var u=this._nodeType=="Directory"?this._getFolderPath():this._currentPath,r=this,f={data:{ActionType:"GetDetails",Path:u,Names:typeof this._selectedContent=="string"?[this._selectedContent]:this._selectedContent,SelectedItems:this._getSelectedItemDetails(u,this.model.selectedItems.length?this.model.selectedItems:this._selectedContent)},url:this.model.ajaxAction,type:"POST",async:!1,success:function(i){i.hasOwnProperty("d")&&(i=i.d);var s=t.buildTag("div.e-fe-table"),h=t.buildTag("table"),f,c,e,u,o,l;n.each(i.details[0],function(i,s){f=t.buildTag("tr");c=t.buildTag("td",t.isNullOrUndefined(r._getLocalizedLabels(i))?i:r._getLocalizedLabels(i));e=t.buildTag("td");i=="Name"||i=="Location"?(u=t.buildTag("div"),o=t.buildTag("input.e-readonly","","",{style:"border:none;",type:"text",value:s,title:s,readonly:!0}),o.focus(function(){n(this).blur()}),u.append(o)):i=="Size"?(l=r._bytesToSize(s),u=t.buildTag("span",l+" ("+s+" Bytes)")):u=t.buildTag("span",s);e.append(u);n(h).append(f);n(f).append(c,e);(i=="Name"||i=="Size")&&f.addClass("e-border")});n(s).append(h);r._detailsDialog=r._createDialog(s,{width:500,height:"auto",title:r._getLocalizedLabels("Details")});r._detailsDialogObj=r._detailsDialog.data("ejDialog");r._detailsDialogObj.initialRender=!1;r._detailsDialogObj.open()},successAfter:this.model.ajaxSettings.getDetails.success};this.model.ajaxSettings.getDetails.success=i;n.extend(!0,f,this.model.ajaxSettings.getDetails);this._sendAjaxRequest(f,!0)},_uploadFile:function(){proxy=this.element.find(".e-uploadbox");proxy=proxy.ejUploadbox("instance")},_getFolderPath:function(n){for(var i=n?n.split("/"):this._currentPath.split("/"),r="",t=0;t<i.length-2;t++)r+=i[t]+"/";return r},_renderToolBar:function(){this._crateToolbarTemplate();this._initToolbarItems();this._toolbar=this._toolBarItems;var t={};t.click=n.proxy(this._toolBarClick,this);t.cssClass=this.model.cssClass;t.enableRTL=this.model.enableRTL;t.enableSeparator=!0;t.isResponsive=this.model.isResponsive;t.height=t.isResponsive?"":"auto";t.cssClass=this.model.cssClass+" e-fe-toolbar";t.enableRTL=this.model.enableRTL;this._toolBarItems.ejToolbar(t);this._toolBarObj=this._toolBarItems.ejToolbar("instance");this._disableToolbarItem("Paste");this._disableToolbarItem("Download");this._disableToolbarItem("Back");this._disableToolbarItem("Forward");this._disableEditingTools()},_initToolbarItems:function(){this._toolBarItems.find("#"+this._ExplorerId+"Addressbar").length>0&&this._createAddressBar();this._toolBarItems.find("#"+this._ExplorerId+"Searchbar").length>0&&this._searchDetails()},_createUploadBox:function(){this._uploadtag=t.buildTag("div#"+this._ExplorerId+"FileUpload","",{padding:"0px",height:"0px",width:"0px"});this.element.prepend(this._uploadtag);this._renderUploadBox();this._uploadtag.find(".e-inputbtn").hide();this._uploadtag.find(".e-uploadinput").attr("tabindex",-1)},_searchDetails:function(){this._searchbar=t.buildTag("input.e-searchBar e-tool-input","",{},{id:this._ExplorerId+"_searchbar",type:"text",placeholder:this._getLocalizedLabels("Search")});this._searchbar.appendTo(this._toolBarItems.find("#"+this._ExplorerId+"Searchbar").html(""))},_setUploadLocalization:function(){n.each(t.FileExplorer.Locale,function(n,i){i.UploadSettings&&(t.Uploadbox.Locale[n]=i.UploadSettings)})},_getLocalizedLabels:function(n){return t.FileExplorer.Locale[this.model.locale][n]===i?t.FileExplorer.Locale["en-US"][n]?t.FileExplorer.Locale["en-US"][n]:n:t.FileExplorer.Locale[this.model.locale][n]},_crateToolbarTemplate:function(){this._toolBarItems=t.buildTag("div#"+this._ExplorerId+"_toolbar").prependTo(this.element);for(var n=0;n<this.model.toolsList.length;n++)items=this.model.toolsList[n],t.isNullOrUndefined(this.model.tools[items])||(items=="customTool"?t.isNullOrUndefined(this.model.tools[items])||this._customTools(this.model.tools[items]):this.model.tools[items].length>0&&this._createToolsItems(this.model.tools[items],items))},_createToolsItems:function(i,r){var f=t.buildTag("ul#"+(this._ExplorerId+r)),e,u;for(f.addClass("e-ul-"+r),u=0;u<i.length;u++)e=n("<li id='"+(this._ExplorerId+i[u].replace(/ /g,""))+"' class='e-feItem-"+i[u]+"' title='"+this._getLocalizedLabels(i[u].replace(/ /g,""))+"' ><div class='e-fileexplorer-toolbar-icon "+i[u]+"'><\/div><\/li>"),e.appendTo(f);f.appendTo(this._toolBarItems)},_customTools:function(i){for(var e,f,u,r=0;r<i.length;r++)e=t.buildTag("ul"),f=n("<li id='"+(this._ExplorerId+i[r].name.replace(/ /g,""))+"' title='"+i[r].tooltip+"' ><div class='"+(t.isNullOrUndefined(i[r].css)?"":i[r].css)+"'><\/div><\/li>"),u=i[r].action,typeof u=="string"&&(u=t.util.getObject(u,window)),t.isNullOrUndefined(i[r].action)||this._on(f,"click",u),n(i[r].template).appendTo(f.find("div")),f.appendTo(e),e.appendTo(this._toolBarItems)},_toolBarClick:function(t){if(t.event.which&&(t.event.which==3||t.event.which==2)||t.event.button&&t.event.button==2)return!1;if(this.model.ajaxAction!=""&&this._currentPath!=""){this._lastFocusedElement=n(t.currentTarget);var i=n(t.currentTarget),r=i.attr("id");switch(r){case this._ExplorerId+"Addressbar":case this._ExplorerId+"Searchbar":i.find("input").focus();i.find("input").select();break;case this._ExplorerId+"Download":this._downloadFile();break;case this._ExplorerId+"Upward":this._upward();break;case this._ExplorerId+"NewFolder":this._createNewFolder();break;case this._ExplorerId+"Delete":this._deleteFolder();break;case this._ExplorerId+"Rename":this._renameFolder();break;case this._ExplorerId+"Refresh":this._currentPath=this._originalPath;this._highlightedNodes=this.model.selectedItems;this._refreshItems(this._treeObj.getSelectedNode(),this._originalPath);break;case this._ExplorerId+"Back":this._backward();break;case this._ExplorerId+"Forward":this._forward();break;case this._ExplorerId+"Cut":this._copyMoveNode("move");break;case this._ExplorerId+"Copy":this._copyMoveNode("copy");break;case this._ExplorerId+"Paste":this._currentPath=this._originalPath;this._cut_copy();break;case this._ExplorerId+"Open":this._openAction();break;case this._ExplorerId+"Details":this._getDetails();break;case this._ExplorerId+"Upload":this.element.find(".e-uploadinput").click()}}},_upward:function(){this._treeObj&&this._treeObj.selectNode(this._treeObj.getSelectedNode().parent().closest("li.e-item"))},_getFilteredList:function(n){if(!n||!n.length||n.length<1)this.suggestionListItems=[];else{var i=t.Query();this._addQuery(i,typeof n[0]=="object");this.suggestionListItems=t.DataManager(n).executeLocal(i)}this.model.layout=="grid"?this._renderGridView(this.suggestionListItems):this._renderTileView(this.suggestionListItems);this._updateItemStatus(this.suggestionListItems)},_addQuery:function(n,t){var i="";t&&(i="name");this._queryString&&n.where(i,this.model.filterSettings.filterType,this._queryString,!this.model.filterSettings.caseSensitiveSearch)},_updateItemStatus:function(n){var t,i;if(n){for(t=0,i=0;i<n.length;i++)t+=n[i].sizeInByte;t=this._bytesToSize(t);this._itemStatus&&this._itemStatus.html(n.length+" "+(n.length==1?this._getLocalizedLabels("Item"):this._getLocalizedLabels("Items"))+", "+this._getLocalizedLabels("Size")+": "+t)}},_validateKeyCode:function(n){var t;switch(n.which){case 38:case 40:case 37:case 39:case 20:case 16:case 17:case 18:case 35:case 36:case 144:break;case 27:this._searchbar.val("");this._queryString="";t=this._addresstag.val();this._removeOldSelectionDetails();this._currentPath=this._currentPath.split(t)[0]+t;this._getFilteredList(this._fileExplorer[this._currentPath]);this.model.layout=="grid"?this._addFocus(this._gridtag.find(".e-gridcontent")):this._addFocus(this._tileViewWrapper);break;case 9:case 46:case 8:case 13:default:this._queryString=n.currentTarget.value;t=this._addresstag.val();this._removeOldSelectionDetails();this._currentPath=this._currentPath.split(t)[0]+t;this._getFilteredList(this._fileExplorer[this._currentPath])}},_onDialogClose:function(){n("body").find("#"+this._ExplorerId+"_basicDialog_wrapper").remove();this._lastFocusedElement&&this._lastFocusedElement.focus()},_switchView:function(n){var t=!1;n.currentTarget.getAttribute("id")==this._ExplorerId+"_swithListView"?this.model.layout!="tile"&&(this.model.layout="tile",t=!0):this.model.layout!="grid"&&(this.model.layout="grid",t=!0);t&&this._switchLayoutView()},_switchLayoutView:function(){var n=!1,t;this._currentPath=this._originalPath;this.model.layout=="tile"?(this._gridtag.hide(),this._tileContent.parent().show(),this._renderTileView(this._fileExplorer[this._currentPath]),this._statusbar&&(this._statusbar.find(".e-swithListView").addClass("e-active"),this._statusbar.find(".e-switchGridView").removeClass("e-active")),n=!0):this.model.layout=="grid"&&(this._tileView&&this._tileContent.parent().hide(),this._gridtag.show(),this._renderGridView(this._fileExplorer[this._currentPath]),this._statusbar&&(this._statusbar.find(".e-swithListView").removeClass("e-active"),this._statusbar.find(".e-switchGridView").addClass("e-active")),n=!0);n&&(this._updateItemStatus(this._fileExplorer[this._currentPath]),this._setSelectedItems(this.model.selectedItems),this._searchbar&&this._searchbar.val(""),t={layoutType:this.model.layout},this._trigger("layoutChange",t))},_wireEvents:function(){this._on(n("#"+this._ExplorerId+"_newFolder"),"click",this._createNewFolder);this._on(n("#"+this._ExplorerId+"_switchGridView"),"click",this._switchView);this._on(n("#"+this._ExplorerId+"_swithListView"),"click",this._switchView);this._on(n("#"+this._ExplorerId+"_addressbar"),"keydown",this._searchPath);this._on(n("#"+this._ExplorerId+"_addressbar"),"blur",this._addressbarFocusout);this._on(n("#"+this._ExplorerId+"_searchbar"),"keyup",this._validateKeyCode);this._on(this.element,"keydown",this._keyDownOnInput);this._on(this._gridtag,"click",this._gridtagClick);this._on(this._tileViewWrapper,"click",this._tileViewWrapperClick)},_onHideContextMenu:function(){this._treeObj&&this._treeObj.element.find(".e-node-focus").removeClass("e-node-focus")},_adjustSize:function(n){this._isWindowResized=n?!0:!1;this.adjustSize()},_closeDialog:function(t){this._unwireDialogEvent(t);n(t.target).closest("div.e-dialog").find(".e-dialog").ejDialog("close")},_searchPath:function(i){var o=this._getKeyCode(i),r;switch(o){case 13:this._searchbar.val("");var e=this._addresstag.val(),f=e.split("/"),u=this._treetag;for(r=0;r<f.length;r++)f[r]&&(u=this._findMatchingElement(n(u).children("ul"),f[r]),u.length?this._treetag.ejTreeView("selectNode",u):(this._alertDialog=this._createDialog(t.buildTag("div.e-fe-dialog-label",String.format(this._getLocalizedLabels("ErrorPath"),e)),{width:400,height:"auto",title:this._getLocalizedLabels("Error")}),this._alertDialogObj=this._alertDialog.data("ejDialog"),this._alertDialogObj.initialRender=!1,this._alertDialogObj.open()));break;case 27:i.preventDefault();this._updateAddressBar();this._toolBarItems.focus()}},_addressbarFocusout:function(){this._updateAddressBar()},_createDialog:function(i,r){var f=this,u=t.buildTag("div#"+this._ExplorerId+"_basicDialog.e-fe-dialog");return n(i).css("overflow","hidden"),n(u).append(i),u.ejDialog({title:r.title?r.title:"",width:r.width,closeIconTooltip:f._getLocalizedLabels("DialogCloseToolTip"),height:r.height,enableModal:!0,showHeader:!0,showOnInit:!1,enableResize:!1,enableAnimation:!1,allowKeyboardNavigation:!1,enableRTL:this.model.enableRTL,cssClass:this.model.cssClass+" e-fe-dialog",open:r.open,close:function(n){f._onDialogClose(n)}}),u},_findMatchingElement:function(t,i){return n(t).children("li").filter(function(){if(n(this).find(".e-text:first").text()==i)return n(this)})},_getKeyCode:function(n){return n.keyCode?n.keyCode:n.which?n.which:n.charCode},_keyDownOnInput:function(t){var u,i,r,t;if(!n(t.target).hasClass("e-tool-input")){u=this._getKeyCode(t);switch(u){case 49:t.shiftKey&&t.ctrlKey&&this.model.showToolbar&&(t.preventDefault(),this._addFocus(this._toolBarItems));break;case 50:t.shiftKey&&t.ctrlKey&&this.model.showNavigationPane&&(t.preventDefault(),this._addFocus(this._treetag));break;case 51:t.shiftKey&&t.ctrlKey&&(t.preventDefault(),this._addFocus(n(this._splittag.find(".e-splitbar")[0])));break;case 52:t.shiftKey&&t.ctrlKey&&(t.preventDefault(),this._addFocus(this._gridtag.find(".e-gridcontent")));break;case 53:t.shiftKey&&t.ctrlKey&&(t.preventDefault(),this._addFocus(this._tileViewWrapper));break;case 54:t.shiftKey&&t.ctrlKey&&this.model.showFooter&&(t.preventDefault(),this._addFocus(this._statusbar));break;case 65:if(t.ctrlKey)if(t.preventDefault(),this.model.layout=="grid")i=this.gridItems,this._gridObj.clearSelection(),this._removeOldSelectionDetails(),this._addFocus(this._gridtag.find(".e-gridcontent")),this._gridObj.selectRows(0,i.length-1,n(i[i.length-1]).find("td:first"));else for(i=this.items,this.items.hasClass("e-active")&&this.items.removeClass("e-active").attr("aria-selected",!1),this._removeOldSelectionDetails(),this._addFocus(this._tileViewWrapper),r=0;r<i.length;r++)t=jQuery.Event("click",{keyCode:91,ctrlKey:!0}),n(i[r]).trigger(t);break;case 78:t.altKey&&(t.preventDefault(),this._createNewFolder());break;case 85:t.ctrlKey&&(t.preventDefault(),this.element.find(".e-uploadinput").click());break;case 116:t.preventDefault();this._currentPath=this._originalPath;this._highlightedNodes=this.model.selectedItems;this._refreshItems(this._treeObj.getSelectedNode(),this._originalPath)}}},_getFocusedElement:function(){var t=this.element.find(".e-focus");return t?t:n(":focus")},_addFocus:function(n){n.hasClass("e-focus")||(this._removeFocus(),n.focus())},_removeFocus:function(){var n=this._getFocusedElement();n.length>0&&n.blur()},_subControlsSetModel:function(n,t){this._treeObj&&this._treeObj.option(n,t);this._downloadDialogObj&&this._downloadDialogObj.isOpen()&&this._downloadDialogObj.option(n,t);this._newFolderDialogObj&&this._newFolderDialogObj.isOpen()&&this._newFolderDialogObj.option(n,t);this._renameDialogObj&&this._renameDialogObj.isOpen()&&this._renameDialogObj.option(n,t);this._openDialogObj&&this._openDialogObj.isOpen()&&this._openDialogObj.option(n,t);this._detailsDialogObj&&this._detailsDialogObj.isOpen()&&this._detailsDialogObj.option(n,t);this._alertDialogObj&&this._alertDialogObj.isOpen()&&this._alertDialogObj.option(n,t);this._alertWindowObj&&this._alertWindowObj.isOpen()&&this._alertWindowObj.option(n,t);this._treeContextMenutag&&this._treeMenuObj.option(n,t);this._tileContextMenutag&&this._viewMenuObj.option(n,t);this._toolBarObj&&this._toolBarObj.option(n,t);this._uploadtag&&this._uploadtag.data("ejUploadbox").option(n,t);this._splitObj&&this._splitObj.option(n,t)},_removeDialog:function(n){n.close();var t=n._overLay;t&&t.remove();n._ejDialog.remove()},_reSizeHandler:function(){if(this.model.ajaxAction!=""&&this._currentPath!=""){if(this.model.layout=="grid"){var n=this._splittag.outerHeight()-this._gridtag.find(".e-gridheader").outerHeight();this._gridtag.ejGrid({scrollSettings:{height:this.model.showFooter?n-this._statusbar.outerHeight():n,width:this._splittag.find(".e-cont2").width()}});this._gridtag.find(".e-gridcontent").hasClass("e-scroller")&&this._gridtag.find(".e-gridcontent").ejScroller({buttonSize:0,scrollerSize:this._scrollerSize});this._gridObj.getContentTable().css("width",this._gridObj.getContent().find(".e-content").width())}else this._setThumbImageHeight();this._treetag.parent(".e-tree-wrapper").ejScroller({width:this._splittag.find(".e-cont1").width()});this._waitingPopup&&this._waitingPopup.refresh()}},_findCommand:function(t,i){return n.each(i,function(n,i){for(var r=0,u=i.length;r<u;r++)if(i[r].toLowerCase()==t.toLowerCase())return t=i[r],!1}),t},_getElement:function(t){return typeof t=="string"&&(t=this._findCommand(t,this.model.tools)),typeof t!="object"&&(t=typeof t=="string"?this._toolBarObj.itemsContainer.find("li#"+t).length>0?this._toolBarObj.itemsContainer.find("li#"+t):this._toolBarObj.itemsContainer.find("li#"+this._ExplorerId+t.replace(/ /g,"")):this._toolbar.find("li").eq(t)),t=n(t),n(t[0])},_unwireEvents:function(){this._off(n("#"+this._ExplorerId+"_newFolder"),"click",this._createNewFolder);this._off(n("#"+this._ExplorerId+"_switchGridView"),"click",this._switchView);this._off(n("#"+this._ExplorerId+"_swithListView"),"click",this._switchView);this._off(n("#"+this._ExplorerId+"_addressbar"),"keydown",this._searchPath);this._off(n("#"+this._ExplorerId+"_addressbar"),"blur",this._addressbarFocusout);this._off(n("#"+this._ExplorerId+"_searchbar"),"keyup",this._validateKeyCode);this._off(this.element,"keydown",this._keyDownOnInput);this._off(this._gridtag,"click");this._off(this._tileViewWrapper,"click")},_wireResizing:function(){this.model.isResponsive?n(window).bind("resize",n.proxy(this._adjustSize,this)):n(window).unbind("resize",n.proxy(this._adjustSize,this))},adjustSize:function(){!this._isWindowResized&&this.model.showToolbar&&this.model.isResponsive&&this._toolBarObj._reSizeHandler();this._isWindowResized=!1;this._splittag.css("height",this.element.height()-(this._toolBarItems?this._toolBarItems.outerHeight():0));this._splittag.css("width",this.element.width());var n=this._splittag.outerHeight()-(this.model.showFooter?this._statusbar.outerHeight():0);this._tileContent&&this._tileContent.parent(".e-tile-wrapper").height(n).ejScroller({height:n});this._gridtag&&this._gridtag.height(n);this._splitObj&&this._splitObj._windowResized();this._treetag.parent(".e-tree-wrapper").ejScroller("option",{height:this._splittag.height(),width:this._splittag.find(".e-cont1").width()});this._reSizeHandler()},refresh:function(){this._refreshItems(this._selectedNode,this._currentPath)},enableToolbarItem:function(n){this._removeResrictedToolItem(n);n=this._getElement(n);n[0]!=null&&this._toolBarObj&&this._toolBarObj.enableItem(n)},disableToolbarItem:function(n){if(n=this._getElement(n),n[0]!=null&&this._toolBarObj){var t=n.attr("id").replace(this._ExplorerId,"");this._restrictedToolbarOptions.push(t);this._toolBarObj.disableItem(n)}},removeToolbarItem:function(n){this._removeResrictedToolItem(n);n=this._getElement(n);n[0]!=null&&this._toolBarObj&&this._toolBarObj.removeItem(n)},_removeResrictedToolItem:function(n){for(var i=typeof n=="string"?n:n.attr("id").replace(this._ExplorerId,""),t=0;t<this._restrictedToolbarOptions.length;t++)if(this._restrictedToolbarOptions[t]==i){this._restrictedToolbarOptions.splice(t,1);break}}});t.FileExplorer.Locale={};t.FileExplorer.Locale["en-US"]={Back:"Backward",Forward:"Forward",Upward:"Upward",Refresh:"Refresh",Addressbar:"Address bar",Upload:"Upload",Rename:"Rename",Delete:"Delete",Download:"Download",Error:"Error",Cut:"Cut",Copy:"Copy",Paste:"Paste",Details:"Details",Searchbar:"Search bar",Open:"Open",Search:"Search",NewFolder:"New Folder",Size:"Size",RenameAlert:"Please enter new name",NewFolderAlert:"Please enter new folder name",ContextMenuOpen:"Open",ContextMenuNewFolder:"New Folder",ContextMenuDelete:"Delete",ContextMenuRename:"Rename",ContextMenuUpload:"Upload",ContextMenuDownload:"Download",ContextMenuCut:"Cut",ContextMenuCopy:"Copy",ContextMenuPaste:"Paste",ContextMenuGetinfo:"Get info",ContextMenuRefresh:"Refresh",Item:"item",Items:"items",ErrorOnFolderCreation:"This destination already contains a folder named '{0}'. Do you want to merge this folder content with already existing folder '{0}'?",GeneralError:"Please see browser console window for more information",ErrorPath:"FileExplorer can't find '{0}'. Check the spelling and try again.",ReplaceAlert:"File named '{0}' already exists. Replace old file with new one?",DuplicateAlert:"There is already a file with the same name '{0}'. Do you want to create file with duplicate name",DuplicateFileCreation:"There is already a file with the same name in this location. Do you want to rename '{0}' to '{1}'?",DeleteFolder:" Are you sure you want to delete ",DeleteMultipleFolder:"Are you sure you want to delete these {0} items?",CancelPasteAction:"The destination folder is a subfolder of source folder.",OkButton:"Ok",CancelButton:"Cancel",YesToAllButton:"Yes to all",NoToAllButton:"No to all",YesButton:"Yes",NoButton:"No",Grid:"Grid View",Tile:"Tile View",Name:"Name",Location:"Location",Type:"Item type",Created:"Created",Accessed:"Accessed",Modified:"Modified",DialogCloseToolTip:"close",UploadSettings:{buttonText:{upload:"Upload",browse:"Browse",cancel:"Cancel",close:"Close"},dialogText:{title:"Upload Box",name:"Name",size:"Size",status:"Status"},dropAreaText:"Drop files or click to upload",filedetail:"The selected file size is too large. Please select a file within the valid size.",denyError:"Files with #Extension extensions are not allowed.",allowError:"Only files with #Extension extensions are allowed.",cancelToolTip:"Cancel",removeToolTip:"Remove",retryToolTip:"Retry",completedToolTip:"Completed",failedToolTip:"Failed",closeToolTip:"Close"}};t.FileExplorer.filterType={StartsWith:"startswith",Contains:"contains",EndsWith:"endswith"};t.FileExplorer.layoutType={Tile:"tile",Grid:"grid"}})(jQuery,Syncfusion)});