/*!
*  filename: ej.kanban.min.js
*  version : 14.1.0.46
*  Copyright Syncfusion Inc. 2001 - 2016. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["jquery-easing","./../common/ej.globalize.min","jsrender","./../common/ej.core.min","./../common/ej.data.min","./../common/ej.touch.min","./../common/ej.draggable.min","./../common/ej.scroller.min","./ej.button.min","./ej.waitingpopup.min","./ej.datepicker.min","./ej.datetimepicker.min","./ej.dropdownlist.min","./ej.dialog.min","./ej.editor.min","./ej.toolbar.min","./ej.rte.min","./ej.menu.min"],n):n()})(function(){"use strict";(function(n,t){t.kanbanFeatures=t.kanbanFeatures||{};t.kanbanFeatures.dragAndDrop={_addDragableClass:function(){this._dropped=!1;this._dragEle=this.element.find(".e-columnrow .e-kanbancard");this.element.find(".e-kanbancontent div:first");this._dropEle=this.element.find(".e-columnrow .e-rowcell");this._dropEle.addClass("e-droppable");this._dragEle.addClass("e-draggable e-droppable");this._enableDragDrop();this._on(this.element,"mouseup",n.proxy(this.element.focus(),this))},_enableDragDrop:function(){this._drag();n(this.element).find(".e-kanbancontent").ejDroppable({accept:n(this.element).find("div.e-kanbancard"),drop:function(t,i){n(i.helper).hide()}})},_selectedPrevCurrentCards:function(){var n,t;this._previousRowCellIndex.length>0&&(n=this._getCardbyIndexes(this._previousRowCellIndex),this._pCardId=n.attr("id"));this._previousRowCellIndex=this._currentRowCellIndex;this._pCardId=this._cCardId;this._currentRowCellIndex.length>0&&(t=this._getCardbyIndexes(this._currentRowCellIndex),this._cCardId=t.attr("id"))},_getPriorityIndex:function(n){for(var r=null,i=0;i<this._priorityCollection.length;i++)if(this._priorityCollection[i].primaryKey==n.attr("id")){r=this._priorityCollection[i];break}return t.isNullOrUndefined(r)?this._getPriorityKey(parseInt(n.attr("id"))):parseInt(r.dropKey)},_removeFromPriorirtyCollec:function(n){for(var r=null,i=0;i<this._priorityCollection.length;i++)if(this._priorityCollection[i].primaryKey==n){r=i;break}t.isNullOrUndefined(r)||this._priorityCollection.splice(r,1)},_columnDataOndrop:function(i,r){var c=t.DataManager(this._initialData),f,e,o,s,h,u=new t.Query;return e=this.model.keyField,o=this.model.fields.swimlaneKey,s=n(i).hasClass("e-rowcell")?n(i).attr("ej-mappingkey"):n(i).parents(".e-rowcell").attr("ej-mappingkey"),h=n(i).parents(".e-columnrow").prev(".e-swimlanerow").find(".e-slkey").text(),u=t.isNullOrUndefined(o)?u.where(e,t.FilterOperators.equal,s):u.where(e,t.FilterOperators.equal,s).where(o,t.FilterOperators.equal,h),f=c.executeLocal(u),f.sort(function(n,t){return n[r]-t[r]}),f},_dropToColumn:function(i,r){var c,f,e=[],l=!1,o=this.model.fields.priority,a,s,v,h,u,y;for(t.isNullOrUndefined(this._filterToolBar)||(a=this._filterToolBar.find(".e-select")),i.hasClass("e-targetclone")&&(i=i.parent()),this._selectedPrevCurrentCards(),o&&(!t.isNullOrUndefined(this._filterToolBar)&&a.length>0||this._searchBar!=null&&this._searchBar.find(".e-cancel").length>0)?(e=this._columnDataOndrop(i,o),l=e.length>0):l=n(i).children(".e-kanbancard").length>1,this.model.selectionType==t.Kanban.SelectionType.Multiple&&this._getSelectedCards(r).length>0&&n(r).hasClass("e-cardselection")&&(r=this._getSelectedCards(r)),s=0;s<r.length;s++)for(v=r[s],h=0;h<n(v).length;h++)u=n(v)[h],n(u).is(":visible")&&(o&&l&&(c=!t.isNullOrUndefined(this._filterToolBar)&&a.length>0||this._searchBar!=null&&this._searchBar.find(".e-cancel").length>0?e[e.length-1][o]:this._getPriorityIndex(i.find(".e-kanbancard").last()),f=this._getPriorityIndex(n(u)),c>=f&&(f=++c),this._removeFromPriorirtyCollec(n(u).attr("id")),this._priorityCollection.push({primaryKey:n(u).attr("id"),dropKey:f}),y=this._getKanbanCardData(this._currentJsonData,n(u)[0].id)[0],t.isNullOrUndefined(f)||(y[o]=f,e.push(y))),n(i).find(".e-customaddbutton").length>0?n(u).insertBefore(n(i).find(".e-customaddbutton")):n(i).append(u));this._updateDropAction(i,r)},_selectionOnRerender:function(){var h,o,i,s=!0,u,f,r,e,l,c;if(this.model.selectionType==t.Kanban.SelectionType.Single)this._selectedCards.length>0&&(f=n(this._selectedCards[0]),r=this.element.find("#"+f[0].id),r.hasClass("e-kanbancard")?(o=n(r).parents(".e-columnrow"),i=n(r).parents(".e-rowcell"),this._selectedCards=[],this._selectedCards=r.addClass("e-cardselection"),this._currentRowCellIndex=this._previousRowCellIndex=[],this._currentRowCellIndex.push([o.index(),[i.index()],[i.find(".e-kanbancard").index(i.find("#"+f[0].id))]]),this._currentRowCellIndex=this._previousRowCellIndex,this.selectedRowCellIndexes=[],this.selectedRowCellIndexes.push({rowIndex:this._currentRowCellIndex[0][0],cellIndex:this._currentRowCellIndex[0][1][0],cardIndex:this._currentRowCellIndex[0][2][0]})):(this._selectedCards=this._selectedCardData=this.selectedRowCellIndexes=[],this._currentRowCellIndex=this._previousRowCellIndex=[]));else{for(u=0;u<this._selectedCards.length;u++)if(n(this._selectedCards[u]).length>1)for(e=0;e<this._selectedCards[u].length;e++)f=n(this._selectedCards[u][e]),r=this.element.find("#"+f[0].id),o=n(r).parents(".e-columnrow"),i=n(r).parents(".e-rowcell"),r.hasClass("e-kanbancard")?(s=!0,this._selectedCards[u].splice(e,0,r[0]),r.addClass("e-cardselection"),this._selectedCards[u].splice(e+1,1),u==0&&e==0&&(this._currentRowCellIndex=this._previousRowCellIndex=[],this._currentRowCellIndex.push([o.index(),[i.index()],[i.find(".e-kanbancard").index(i.find("#"+f[0].id))]]),this._currentRowCellIndex=this._previousRowCellIndex,this.selectedRowCellIndexes=[]),l=[o.index(),[i.index()],[i.find(".e-kanbancard").index(i.find("#"+f[0].id))]],this._pushIntoSelectedArray([l])):(s=!1,this._selectedCards[u].splice(e,1),c=this._selectedCardData.indexOf(this._getKanbanCardData(this._selectedCardData,f[0].id)[0]),this._selectedCardData.splice(c,1),--e);else f=n(this._selectedCards[u]),r=this.element.find("#"+f[0].id),o=n(r).parents(".e-columnrow"),i=n(r).parents(".e-rowcell"),r.hasClass("e-kanbancard")?(s=!0,r.addClass("e-cardselection"),this._selectedCards[u]=r[0],u==0&&(this._currentRowCellIndex=this._previousRowCellIndex=[],this._currentRowCellIndex.push([o.index(),[i.index()],[i.find(".e-kanbancard").index(i.find("#"+f[0].id))]]),this._currentRowCellIndex=this._previousRowCellIndex,this.selectedRowCellIndexes=[]),l=[o.index(),[i.index()],[i.find(".e-kanbancard").index(i.find("#"+f[0].id))]],this._pushIntoSelectedArray([l])):(s=!1,this._selectedCards.splice(u,1),c=this._selectedCardData.indexOf(this._getKanbanCardData(this._selectedCardData,f[0].id)[0]),this._selectedCardData.splice(c,1),--u);!s&&this._selectedCards.length<=0&&(this._currentRowCellIndex=this._previousRowCellIndex=this.selectedRowCellIndexes=[])}h=this.element.find(".e-columnrow").index(this.element.find(".e-cardselection").eq(0).parents(".e-columnrow"));h>=0&&(this.selectedRowCellIndexes[0].rowIndex=this._currentRowCellIndex[0][0]=h,this._previousRowCellIndex.length>0&&(this._previousRowCellIndex[0][0]=h))},_updateDropAction:function(i,r){var v,u,e,o,h,l,f,c,a,s;for(v=n(i).hasClass("e-rowcell")?i:n(i).closest("td.e-rowcell"),this._selectedCardData=[],u=0;u<r.length;u++)if(t.isNullOrUndefined(r[u].length))n(r[u]).is(":visible")&&(e=n(r[u]).attr("id"),this._updateDropData(i,r[u],e),f=this.element.find("#"+e),f.parents(".e-rowcell").hasClass("e-shrink")&&f.addClass("e-hide"));else for(o=0;o<r[u].length;o++)n(r[u][o]).is(":visible")&&(e=r[u][o].id,this._updateDropData(i,r[u][o],e),f=this.element.find("#"+e),f.parents(".e-rowcell").hasClass("e-shrink")&&f.addClass("e-hide"));if(this.model.fields.priority&&this._priorityCollection.length>0)for(h=0;h<this._priorityCollection.length;h++)l=this._priorityCollection[h].primaryKey,f=this.element.find("#"+l),this._updateDropData(i,f,l);this._bulkUpdateData.length>0&&(this._dataManager instanceof t.DataManager&&!this._dataManager.dataSource.offline||this._dataSource().adaptor instanceof t.remoteSaveAdaptor)&&(s=this,a={added:[],deleted:[],changed:[]},a.changed=this._bulkUpdateData,n("#"+this._id).data("ejWaitingPopup").show(),c=this._dataManager.saveChanges(a,this.model.fields.primaryKey,this.model.query._fromTable),n.isFunction(c.promise)&&(c.done(function(){s._updateDataOndrop(s._bulkUpdateData)}),c.fail(function(n){var t={error:n.error};s._updateDataOndrop(s._failBulkData);s._trigger("actionFailure",t)})));(!t.isNullOrUndefined(r[0].length)&&r[0].length>1||r.length>1||r.length==1&&n(r).hasClass("e-cardselection"))&&(this._previousRowCellIndex=t.isNullOrUndefined(this._pCardId)?[]:this._updateRowCellIndexes(this._pCardId,this._previousRowCellIndex),this._currentRowCellIndex=t.isNullOrUndefined(this._cCardId)?[]:this._updateRowCellIndexes(this._cCardId,this._currentRowCellIndex),this._selectionOnRerender(),t.isNullOrUndefined(this._pCardId)&&(this._previousRowCellIndex=this._currentRowCellIndex),this.model.selectionType==t.Kanban.SelectionType.Single?this.selectedRowCellIndexes=this._currentRowCellIndex:this._updateSelectedCardIndexes(i));this._priorityCollection=[]},_updateDataOndrop:function(t){for(var r,i=0;i<t.length;i++)r=t[i][this.model.fields.primaryKey],this.element.find("#"+r).length>0&&this._renderSingleCard(r,t[i]);this._failBulkData=[];this._bulkUpdateData=[];this.refresh(!0);n("#"+this._id).data("ejWaitingPopup").hide()},_getKanbanCardData:function(n,i){return new t.DataManager(n).executeLocal((new t.Query).where(this.model.fields.primaryKey,t.FilterOperators.equal,i))},_getPriorityKey:function(n){var t=this._getKanbanCardData(this._currentJsonData,n);return t[0][this.model.fields.priority]},_dropAsSibling:function(i,r,u){var h=0,g=0,it=0,w,rt,e,d,nt,ut,ft,f=[],st,c=this.model.fields.priority,b,k,a,et,v,o,ht,ot,p,s,y,l,tt;for(t.isNullOrUndefined(this._filterToolBar)||(b=this._filterToolBar.find(".e-select")),k=this.model.fields.primaryKey,this._selectedPrevCurrentCards(),c&&(!t.isNullOrUndefined(this._filterToolBar)&&b.length>0||this._searchBar!=null&&this._searchBar.find(".e-cancel").length>0)&&(f=this._columnDataOndrop(i,c)),n(i).hasClass("e-targetclone")&&(ut=n(i).prevAll(".e-kanbancard")[0],ft=n(i).nextAll(".e-kanbancard")[0],n(i).hasClass("e-targetappend")?(u=!0,i=ut,t.isNullOrUndefined(i)&&(i=ft)):(u=!1,i=ft,t.isNullOrUndefined(i)&&(i=ut))),nt=i,this.model.selectionType==t.Kanban.SelectionType.Multiple&&this._getSelectedCards(r).length>0&&n(r).hasClass("e-cardselection")&&(r=this._getSelectedCards(r)),a=0;a<r.length;a++)for(et=r[a],v=0;v<n(et).length;v++)if(o=n(et)[v],n(o).is(":visible")&&(u&&(v>0&&r[a][v-1]!=nt?i=r[a][v-1]:v==0&&a>0&&r[a-1]!=nt&&(i=r[a-1])),o!=nt&&(u?n(o).insertAfter(i):n(o).insertBefore(i),c&&(!t.isNullOrUndefined(this._filterToolBar)&&b.length>0||this._searchBar!=null&&this._searchBar.find(".e-cancel").length>0)&&(ht=this._getKanbanCardData(f,n(i).attr("id")),l=f.indexOf(ht[0]),u?f.splice(l+1,0,this._getKanbanCardData(this._currentJsonData,n(o)[0].id)[0]):f.splice(l,0,this._getKanbanCardData(this._currentJsonData,n(o)[0].id)[0]),st=n(o)[0].id)),c)){if(!t.isNullOrUndefined(this._filterToolBar)&&b.length>0||this._searchBar!=null&&this._searchBar.find(".e-cancel").length>0)for(y=this._getKanbanCardData(f,n(i).attr("id")),h=y[0][c],y=this._getKanbanCardData(f,st),d=[],p=f.indexOf(y[0]);p<f.length;p++)d.push(f[p]);else h=this._getPriorityIndex(n(i)),d=n(o).nextAll(".e-kanbancard").andSelf();for(p=0;p<d.length;p++){if(s=d[p],!t.isNullOrUndefined(this._filterToolBar)&&b.length>0||this._searchBar!=null&&this._searchBar.find(".e-cancel").length>0?(e=s[c],!u&&parseInt(n(o)[0].id)==s[c]&&h<e&&(e=h),y=this._getKanbanCardData(f,s[k]),l=ot=f.indexOf(y[0]),l-1>=0&&(g=f[l-1][c]),y=this._getKanbanCardData(f,s[k]),l=ot=f.indexOf(y[0]),l+1<f.length?(it=f[l+1][c],w=f[l+1]):w=[]):(e=this._getPriorityKey(parseInt(n(s).attr("id"))),!u&&n(o)[0]==s&&h<e&&(e=h),rt=n(s).prevAll(".e-kanbancard"),rt.length>0&&(g=this._getPriorityIndex(rt.eq(0))),w=n(s).nextAll(".e-kanbancard"),w.length>0&&(it=this._getPriorityIndex(w.eq(0)))),!isNaN(g)&&g<e&&(e<it||w.length==0))break;!t.isNullOrUndefined(this._filterToolBar)&&b.length>0||this._searchBar!=null&&this._searchBar.find(".e-cancel").length>0?(!u&&parseInt(n(o)[0].id)==s[k]?!u&&parseInt(n(o)[0].id)==s[k]&&h<e||(e=h):e=++h,f[ot][c]=e,tt=s[k]):(!u&&n(o)[0]==s?!u&&n(o)[0]==s&&h<e||(e=h):e=++h,tt=n(s).attr("id"));this._removeFromPriorirtyCollec(tt);this._priorityCollection.push({primaryKey:tt,dropKey:e});h=e}}this._updateDropAction(i,r);this._dropTarget=null},_updateSelectedCardIndexes:function(t){var e,f,i,r,u;if(this.selectedRowCellIndexes.length>0)for(n(t).hasClass("e-rowcell")?f=n(t).index():(t=this.element.find("#"+n(t).attr("id")),f=n(t).parents(".e-rowcell").index()),e=n(t).parents(".e-columnrow"),n.inArray(f,this.selectedRowCellIndexes[0].cellIndex)==-1&&this.selectedRowCellIndexes[0].cellIndex.push(f),i=0;i<this.selectedRowCellIndexes[0].cellIndex.length;i++)if(r=e.find(".e-rowcell").eq(this.selectedRowCellIndexes[0].cellIndex[i]).find(".e-cardselection"),r.length>0)for(this.selectedRowCellIndexes[0].cardIndex.splice(i,1),this.element.find(".e-targetclone").remove(),u=0;u<r.length;u++)u>0?this.selectedRowCellIndexes[0].cardIndex[i].push(n(r[u]).index()):this.selectedRowCellIndexes[0].cardIndex.splice(i,0,[n(r[0]).index()]);else this.selectedRowCellIndexes[0].cellIndex.splice(i,1),this.selectedRowCellIndexes[0].cardIndex.splice(i,1),--i},_updateDropData:function(i,r,u){var a,o,c,f,s,l,h,e,v;if(!t.isNullOrUndefined(this.model.fields.primaryKey)){if(o=this.model.fields.priority,c=this.model.fields.primaryKey,t.isNullOrUndefined(u)&&(u=n(i).attr("id")),a=n(i).hasClass("e-rowcell")?n(i):n(i).parents(".e-rowcell"),a.index()<0&&(a=this.element.find("#"+n(i).attr("id")).parents(".e-rowcell")),f=this._getKanbanCardData(this._currentJsonData,u),(this._dataManager instanceof t.DataManager&&!this._dataManager.dataSource.offline||this._dataSource().adaptor instanceof t.remoteSaveAdaptor)&&this._failBulkData.push(n.extend(!0,{},f[0])),f.length>0&&(f[0][this.model.keyField]=this.model.columns[a.index()].key,this.model.fields.swimlaneKey&&(f[0][this.model.fields.swimlaneKey]=n(i).parents("tr.e-columnrow").prev().find("div.e-slkey").html())),this._dropped=!0,o&&this._priorityCollection.length>0){for(h=0;h<this._priorityCollection.length;h++)if(this._priorityCollection[h].primaryKey==u){s=this._priorityCollection[h];this._priorityCollection.splice(h,1);break}if(!t.isNullOrUndefined(s)&&f.length>0&&(f[0][o]=s.dropKey),!t.isNullOrUndefined(this._filterToolBar)&&this._filterToolBar.find(".e-select").length>0&&!t.isNullOrUndefined(s)||this._searchBar!=null&&this._searchBar.find(".e-cancel").length>0)for(e=0;e<this._initialData.length;e++)if(s.primaryKey==this._initialData[e][c]){f.length>0?this._initialData[e]=f[0]:this._initialData[e][o]=s.dropKey;l=this._initialData[e];break}}if(f.length>0){if(n(r).hasClass("e-cardselection")){for(e=0;e<this._selectedCardData.length;e++)if(f[0][c]==this._selectedCardData[e][c])break;this._selectedCardData.splice(e,1);this._selectedCardData.push(f[0])}this._dataManager instanceof t.DataManager&&!this._dataManager.dataSource.offline||this._dataSource().adaptor instanceof t.remoteSaveAdaptor?this._bulkUpdateData.push(f[0]):this._renderSingleCard(u,f[0])}else o&&(this._dataManager instanceof t.DataManager&&!this._dataManager.dataSource.offline||this._dataSource().adaptor instanceof t.remoteSaveAdaptor?this._getKanbanCardData(this._bulkUpdateData,l[c]).length<=0&&this._bulkUpdateData.push(l):this._dataSource()instanceof t.DataManager?(v=this._getKanbanCardData(this._dataSource().dataSource.json,u),v[0][o]=l[o]):(v=this._getKanbanCardData(this._dataSource(),u),v[0][o]=l[o]))}},_updateRowCellIndexes:function(i,r){var o,u,f=[],e;return t.isNullOrUndefined(i)?f=r:(e=this.element.find("#"+i),o=n(e).parents(".e-columnrow"),u=n(e).parents(".e-rowcell"),f.push([o.index(),[u.index()],[u.find(".e-kanbancard").index(u.find("#"+i))]])),f},_dragStop:function(t,i,r){var f=this,c,y,l,p,e,u,s,v,h;if(t.element.dropped||i&&i.remove(),t.target=this._getCursorElement(t),u=n(t.target).closest(".e-kanbancard").length>0?n(t.target).closest(".e-kanbancard")[0]:t.target,f._dropEle.removeClass("e-dropping e-dragged"),c={data:t.dragData,draggedElement:t.dragEle,dropTarget:n(u),event:t.event},f._trigger("cardDragStop",c))return!1;l=n(t.element).parents(".e-columnrow");y=l.find(".e-cardselection");p=l.find(".e-rowcell");e=f.element.find(".e-targetclone");var w=n(u).parent().children().hasClass("e-customaddbutton"),a=n(u).parent().children().hasClass("e-limits"),b=n(u).parent().children().hasClass("e-shrinkheader"),o=n(u).parent().children(),k=b?w?a?o.length==4:o.length==3:a?o.length==3:o.length==2:w?a?o.length==3:o.length==2:a?o.length==2:o.length==1;return(e.is(":visible")?u.nodeName=="TD"&&n(u).parent().hasClass("e-columnrow")&&e.is(":visible")||e.siblings().length<=0||k?(s=n(u).children().last(),s.hasClass("e-targetclone")&&(s=s.prev()),v=e.siblings().not(".e-shrinkheader").not(".e-customaddbutton").not(".e-limits"),(n(u).children().length==0||v.length<=0||n(s).offset().top+n(s).height()<n(e).offset().top)&&(s.next().hasClass("e-targetclone")||v.length<=0?f._dropToColumn(n(u),n(t.element)):(r=!1,f._dropAsSibling(n(e.next()),n(t.element),r)))):u.nodeName=="DIV"&&(n(u).hasClass("e-kanbancard")||n(u).hasClass("e-targetclone"))&&(e.is(":visible")||y.length>1)&&f._dropAsSibling(n(u),n(t.element),r):f._removeKanbanCursor(),f.element.find(".e-targetclone").remove(),p.height(l.find(u).parents(".e-rowcell").height()-f._tdHeightDiff),f._on(f.element,"mouseenter mouseleave",".e-columnrow .e-kanbancard",f._cardHover),n(i).length>0&&n(i).remove(),this._renderLimit(),this._totalCount(),this._eventBindings(),this.model.minWidth&&this.model.isResponsive&&this._kanbanWindowResize(),h=this.element.find("#"+t.element.attr("id")),n(h).hasClass("e-cardselection")&&(h=n(h).parents(".e-columnrow").find(".e-cardselection:visible")),c.draggedElement=h,f._trigger("cardDrop",c))?!1:!0},_getCursorElement:function(t){var r=n(t.target).closest(".dragClone"),i=t.event;return r.length>0&&(r.hide(),t.target=i.type=="touchmove"||i.type=="touchstart"||i.type=="touchend"?document.elementFromPoint(i.originalEvent.changedTouches[0].pageX,i.originalEvent.changedTouches[0].pageY):document.elementFromPoint(i.clientX,i.clientY),r.show()),t.target},_getSelectedCards:function(t){for(var r,i=0;i<this._selectedCards.length;i++)if(n(this._selectedCards[i]).length>1)for(r=0;r<this._selectedCards[i].length;r++)n(this._selectedCards[i][r])[0]==t[0]&&(this._selectedCards[i].splice(r,1),this._selectedCards[i].splice(0,0,t[0]),this._selectedCards.splice(0,0,this._selectedCards[i]),this._selectedCards.splice(i+1,1));else n(this._selectedCards[i])[0]==t[0]&&(this._selectedCards.splice(0,0,this._selectedCards[i]),this._selectedCards.splice(i+1,1));return this._selectedCards},_kanbanAutoScroll:function(n){var t=this,o=t.getContent(),r=o.data("ejScroller"),u=null,f=null,e=null,i=null,s=t.element.find(".e-draggedcard"),w,l,b,a,v,h,k,y,c,d,p;a=n.event.clientX;v=n.event.clientY;w=t.element.width();l=t.element.offset().left;b=t.element.offset().top;y=o.find(".e-hup");k=o.find(".e-hdown");p=o.find(".e-vup");d=o.find(".e-vdown");h=o.find(".e-hhandle.e-box");c=o.find(".e-vhandle.e-box");a>l+w-10?(t.element.removeClass("e-view-horizontal"),f=window.setInterval(function(){h.width()+h.offset().left<=k.offset().left&&!t.element.hasClass("e-view-horizontal")?r.scrollX(r.scrollLeft()+5,!0):f&&(f=window.clearInterval(f));s.length<=0&&f&&(f=window.clearInterval(f))},100)):a-10<l?(t.element.removeClass("e-view-horizontal"),r.scrollLeft()>0&&(u=window.setInterval(function(){h.offset().left>=y.offset().left+y.width()&&!t.element.hasClass("e-view-horizontal")?r.scrollX(r.scrollLeft()-5,!0):u&&(u=window.clearInterval(u));s.length<=0&&u&&(u=window.clearInterval(u))},100))):(t.element.addClass("e-view-horizontal"),f&&(f=window.clearInterval(f)),u&&(u=window.clearInterval(u)));v>b+t._headerContent.height()+(o.height()-15)?(t.element.removeClass("e-view-vertical"),i=window.setInterval(function(){c.height()+c.offset().top<=d.offset().top&&!t.element.hasClass("e-view-vertical")?r.scrollY(r.scrollTop()+5,!0):i&&(i=window.clearInterval(i));s.length<=0&&i&&(i=window.clearInterval(i))},100)):v-10<t.element.find(".e-kanbancontent").offset().top?r.scrollTop()>0&&(t.element.removeClass("e-view-vertical"),e=window.setInterval(function(){i&&(i=window.clearInterval(i));c.offset().top>=p.offset().top+p.height()&&!t.element.hasClass("e-view-vertical")?r.scrollY(r.scrollTop()-5,!0):e&&(e=window.clearInterval(e));s.length<=0&&e&&(i=window.clearInterval(e))},100)):(t.element.addClass("e-view-vertical"),i&&(i=window.clearInterval(i)),e&&(e=window.clearInterval(e)))},_changeKanbanCursor:function(t,i,r){var f=n(t).parents(".e-kanbancard"),e=n(t).hasClass("e-kanbancard"),u,o;f.length>0||e?(o=e?n(t):f,o[0].style.cursor="not-allowed"):(n(t).parents(".e-columnrow").has(r.element).length==0||n(t).parents(".e-swimlanerow").length>0)&&(document.body.style.cursor="not-allowed");u=n(i).find(".e-kanbancard");u.length>0&&(u[0].style.cursor="not-allowed")},_removeKanbanCursor:function(){document.body.style.cursor="";this.element.find(".e-kanbancard").css("cursor","")},_drag:function(){var i=this,r=null,u=null,c=null,l=null,a=null,v,s,e,o=[],f,h;this.element!=null&&(c=this.element.find(".e-kanbancontent div:first"));n(this.element).find(".e-kanbancontent div.e-kanbancard").not(".e-js").ejDraggable({dragArea:c,clone:!0,cursorAt:{left:-20,top:-20},dragStart:function(f){var c,s;for(i._off(i.element,"mouseenter mouseleave",".e-columnrow .e-kanbancard"),h=i.element.find(".e-draggedcard"),u=n(f.element).hasClass("e-cardselection")?n(f.element).parents(".e-columnrow").find(".e-cardselection:visible"):n(f.element),u.length>1&&(c=t.buildTag("div.e-dragmultiple"),c.append(u.length+"  Cards"),h.children().remove(),h.append(c).css("width","90px")),s=0;s<u.length;s++)u[s].id!=""&&(v=t.DataManager(i._currentJsonData),o.push(v.executeLocal((new t.Query).where(i.model.fields.primaryKey,t.FilterOperators.equal,parseInt(u[s].id)))));if(i&&!t.isNullOrUndefined(f.target)){if(e={draggedElement:u,dragTarget:f.target,data:o,event:f.event},i._trigger("cardDragStart",e))return f.cancel=!0,r&&r.remove(),!1}else return!1;return!0},drag:function(t){var h,c,b,w,v,y,p;return(s=!1,i.element.find(".e-kanbantooltip").hide(),n(".e-kanban-context").length>0&&n(".e-kanban-context").css("visibility","hidden"),i._kTouchBar.hide(),(i.model.allowScrolling||i.model.isResponsive)&&i._kanbanAutoScroll(t),n(t.target).closest(".dragClone").length>0&&(t.target=l,clearTimeout(a),a=setTimeout(function(){t.target=i._getCursorElement(t)},10)),n(t.target).hasClass("e-targetclone")||n(t.target).hasClass("e-rowcell")||n(f).remove(),h=n(t.target).closest(".e-kanbancard").length>0?n(t.target).closest(".e-kanbancard")[0]:t.target,b=n(t.element).closest("td.e-rowcell").addClass("e-dragged"),b.siblings().addClass("e-dropping"),e={draggedElement:u,data:o,dragTarget:h,event:t.event},l=c=n(h).closest("td.e-rowcell"),w=c.parents(".e-columnrow").find(".e-cardselection"),c&&c.hasClass("e-droppable")&&n(c).parent().has(t.element).length>0&&(h!=t.element[0]||w.length>1)?(document.body.style.cursor="",n(f).parents(".e-rowcell").index()!=c.index()&&n(f).remove(),c.find(".e-kanbancard").removeClass("e-hover"),v=c.children().last(),v.hasClass("e-shrinkheader")&&(v=v.prev()),n(h).hasClass("e-rowcell")&&(t.element[0]!=v[0]||w.length>1)&&!n(h).hasClass("e-shrink")?(v.length==0||c.children().length==0||v.offset().top+v.height()<n(r).offset().top)&&(y=n(h).height(),c.append(n(f).height(n(t.element[0]).height()).width(n(h).width()-28)),y<n(h).height()&&(c.height(c.height()),i._tdHeightDiff=n(h).height()-y)):(n(h).hasClass("e-kanbancard")||n(h).hasClass("e-targetclone"))&&(p=n(h).parents(".e-rowcell"),y=p.height(),n(h).offset().top+n(h).height()/2>=t.event.pageY?n(h).prev()[0]!=t.element[0]||w.length>1?n(h).hasClass("e-targetclone")||(i._removeKanbanCursor(),n(f).insertBefore(n(h)).height(n(t.element[0]).height()).width(n(h).width()).removeClass("e-targetappend")):i._changeKanbanCursor(h,r,t):n(h).next()[0]!=t.element[0]||w.length>1?(y=n(h).parents(".e-rowcell").height(),n(h).hasClass("e-targetclone")||(s=!0,i._removeKanbanCursor(),n(f).insertAfter(n(h)).height(n(t.element[0]).height()).width(n(h).width()).addClass("e-targetappend"))):i._changeKanbanCursor(h,r,t),y<p.height()&&(p.height(p.height()),i._tdHeightDiff=p.height()-y))):i._changeKanbanCursor(h,r,t),i._trigger("cardDrag",e))?!1:!0},dragStop:function(n){n.dragData=o;n.dragEle=u;i._dragStop(n,r,s)},helper:function(e){return!t.isNullOrUndefined(e.element)&&n(e.element).hasClass("e-draggable")&&(r=t.buildTag("div.e-draggedcard"),r.addClass(i.model.cssClass),u=n(e.element).clone().addClass("dragClone"),n(r).css({width:e.element.width()}),r.append(u),n(r).find("div:first").removeClass("e-hover"),r.appendTo(i.element),f=t.buildTag("div.e-targetclone"),n(f).css({width:e.element.width(),height:e.element.height()})),r}})}}})(jQuery,Syncfusion),function(n,t){t.kanbanFeatures=t.kanbanFeatures||{};t.kanbanFeatures.edit={_processEditing:function(){var n=this._columnToSelect(),i;this.model.query._fromTable!=""&&n.from(this.model.query._fromTable);this._dataSource()instanceof t.DataManager&&n.queries.length&&!this._dataManager.dataSource.offline?(i=this._dataSource().executeQuery(n),i.done(t.proxy(function(n){this._dropDownManager=t.DataManager(n.result);this._addDialogEditingTemplate()},this))):this._addDialogEditingTemplate()},_renderDialog:function(){return t.buildTag("div.e-dialog e-kanbandialog e-dialog-content e-shadow e-widget-content","",{display:"none"},{id:this._id+"_dialogEdit"})},_enableEditingEvents:function(){this.model.editSettings.allowEditing?this._on(this.element,"dblclick doubletap",".e-kanbancard",this._cardDblClickHandler):this._off(this.element,"dblclick doubletap",".e-kanbancard");this.model.editSettings.allowAdding?this._on(this.element,"dblclick",".e-kanbancontent .e-columnrow .e-rowcell",this._cellDblClickHandler):this._off(this.element,"dblclick",".e-kanbancontent .e-columnrow .e-rowcell");this.model.editSettings.allowEditing||this.model.editSettings.allowAdding?this._on(n("#"+this._id+"_dialogEdit"),"click keypress","#EditDialog_"+this._id+"_Save ,#EditDialog_"+this._id+"_Cancel",this._clickHandler):this._off(n("#"+this._id+"_dialogEdit"),"click","#EditDialog_"+this._id+"_Save ,#EditDialog_"+this._id+"_Cancel")},_columnToSelect:function(){for(var i=[],n=0;n<this.model.editSettings.editItems.length;n++)this.model.editSettings.editItems[n].editType=="dropdownedit"&&t.isNullOrUndefined(this.model.editSettings.editItems[n].dataSource)&&i.push(this.model.editSettings.editItems[n].field);return i.length?t.Query().select(i):t.Query()},cancelEdit:function(){if(this.model.editSettings.allowEditing||this.model.editSettings.allowAdding){n("#"+this._id+"_dialogEdit").ejDialog("close");this.refreshTemplate();var i={};i.requestType=t.Kanban.Actions.Cancel;this._processBindings(i)}},addCard:function(i,r){var f,o,s,e,u;if(this.model.editSettings.allowAdding)if(i&&r)o=this.model.query,s=o.clone(),f={data:r,requestType:t.Kanban.Actions.Save,action:t.Kanban.Actions.Add,primaryKeyValue:parseInt(i)},this._cAddedRecord=r,new t.DataManager(this._currentJsonData).insert(r),this._saveArgs=f,this._updateGroup(f.primaryKeyValue,f.data),this.getContentTable().find("colgroup").first().replaceWith(this._getMetaColGroup()),t.isNullOrUndefined(this.model.fields.swimlaneKey)||(o=o.group(this.model.fields.swimlaneKey),this.model.currentViewData=new t.DataManager(this._currentJsonData).executeLocal(o).result),this._renderAllCard(),this._enableDragandScroll(),this._dataSource()instanceof t.DataManager?this._dataSource().dataSource.json.push(r):this._dataSource(undefined,!0).splice(this._dataSource().length,0,r),this._cAddedRecord=null,this._renderLimit(),this._totalCount(),this._eventBindings(),o.queries=s.queries;else{for(e=this.model.editSettings.editItems,f={requestType:t.Kanban.Actions.Add},this._currentData={},this._isAddNewClick&&(this.model.fields.swimlaneKey&&(this._currentData[this.model.fields.swimlaneKey]=n(this._newCard).parent().prev(".e-swimlanerow").find(".e-slkey").text()),this.model.keyField&&(this._currentData[this.model.keyField]=this.model.columns[n(this._newCard).index()].key)),u=0;u<e.length;u++)this._currentData[e[u].field]=t.isNullOrUndefined(e[u].defaultValue)?t.isNullOrUndefined(this._currentData[e[u].field])?"":this._currentData[e[u].field]:e[u].defaultValue;this._currentData[this.model.fields.primaryKey]=this._currentJsonData[this._currentJsonData.length-1][this.model.fields.primaryKey]+1;f.data=this._currentData;this.element.find(".e-kanbandialog").removeAttr("data-id");this._processBindings(f)}},deleteCard:function(i){var r,s,o,h,f,u,e;if(s=this.element.find("#"+i),h=t.DataManager(this._currentJsonData),f=new t.Query,f=f.where(this.model.fields.primaryKey,t.FilterOperators.equal,i),o=h.executeLocal(f),r={div:s,data:o[0],requestType:t.Kanban.Actions.Delete,primaryKeyValue:parseInt(i)},this._trigger("actionBegin",r))return!0;this._cDeleteData=o;this._dataSource()instanceof t.DataManager&&!this._dataManager.dataSource.offline&&this._dataManager.dataSource.json!==undefined||this._dataSource().adaptor instanceof t.remoteSaveAdaptor?(u=this._dataManager.remove(this.model.fields.primaryKey,parseInt(i)),e=this,n.isFunction(u.promise)?(u.done(function(){e._processBindings(r);e._cDeleteData=null}),u.fail(function(n){r.error=n;e._trigger("actionFailure",r)})):this._processBindings(r)):this._processBindings(r);u!=undefined&&n.isFunction(u.promise)||(this._cDeleteData=null)},startEdit:function(i){if(n.type(i)!="object"&&(i=this.element.find("#"+i)),this.model.editSettings.allowEditing&&i.hasClass("e-kanbancard")){var f,r,o=i.hasClass("e-rowcell")?i.index():i.closest(".e-rowcell").index(),s=this.getIndexByRow(i.closest("tr")),e,u=new t.Query;f=i.closest(".e-kanbancard");e=t.DataManager(this._currentJsonData);u=u.where(this.model.fields.primaryKey,t.FilterOperators.equal,i.attr("id"));this._currentData=e.executeLocal(u);!t.isNullOrUndefined(this._cardEditClick)&&this._cardEditClick&&(this._dblArgs.data=this._currentData[0],this._trigger("cardDoubleClick",this._dblArgs));r={target:i,rowIndex:s,data:this._currentData[0],columnIndex:o,cardIndex:f.index(),primaryKeyValue:parseInt(i.attr("id"))};this._trigger("beginEdit",r);r.requestType=t.Kanban.Actions.BeginEdit;this._processBindings(r)}},_refreshEditForm:function(){var a=this.element.find("#"+this._id+"_dialogEdit_wrapper"),v,l,o,h,s,c,u,r,i,f,e;for(a.show(),v=95,h=n("#"+this._id+"_dialogEdit"),l=h.find("tr").find(".e-rowcell"),s=0;s<l.length;s++)this._tdsOffsetWidth[s]=l.get(s).offsetWidth;for(o=t.max(this._tdsOffsetWidth)*(v/100),c=0;c<this.model.editSettings.editItems.length;c++)u=this.model.editSettings.editItems[c],r=h.find("#"+this._id+"_"+u.field),u.editType=="stringedit"&&r.width(o-4),u.editType=="textarea"&&r.width(250).height(95),u.editType=="rteedit"?(i={width:"450px",height:"260px",minHeight:"240px",locale:this.model.locale,enableRTL:this.model.enableRTL},f=u.editParams,i.toolsList=["style","links"],i.tools={style:["bold","italic","underline"],casing:["upperCase","lowerCase"],links:["createLink"]},t.isNullOrUndefined(f)||n.extend(i,f),h.find("#"+this._id+"_"+u.field).ejRTE(i)):u.editType=="dropdownedit"?(i={width:o,enableIncrementalSearch:!0,enableRTL:this.model.enableRTL},e=r.val(),f=u.editParams,r.hasClass("e-disable")&&(i.enabled=!1),t.isNullOrUndefined(f)||n.extend(i,f),r.ejDropDownList(i),r.ejDropDownList("setSelectedValue",r.val())):u.editType=="numericedit"?(i={width:o},e=r.val(),f=u.editParams,i.cssClass=this.model.cssClass,i.showSpinButton=!0,i.enableRTL=this.model.enableRTL,i.locale=this.model.locale,e.length&&(i.value=parseFloat(e)),r.hasClass("e-disable")&&(i.enabled=!1),t.isNullOrUndefined(f)||n.extend(i,f),r.ejNumericTextbox(i)):u.editType=="datepicker"?(i={width:o},e=r.val(),f=u.editParams,i.cssClass=this.model.cssClass,i.displayDefaultDate=!0,i.enableRTL=this.model.enableRTL,i.locale=this.model.locale,e.length&&(i.value=new Date(e)),r.hasClass("e-disable")&&(i.enabled=!1),t.isNullOrUndefined(f)||n.extend(i,f),r.ejDatePicker(i)):u.editType=="datetimepicker"&&(i={width:o,cssClass:this.model.cssClass,locale:this.model.locale,showPopupButton:!1,enableRTL:this.model.enableRTL},e=r.val(),f=u.editParams,e.length&&(i.value=new Date(e)),r.hasClass("e-disable")&&(i.enabled=!1),t.isNullOrUndefined(f)||n.extend(i,f),r.ejDateTimePicker(i)),u.editType!="textarea"&&r.outerWidth(o).height(28),t.browserInfo().name=="msie"&&parseInt(t.browserInfo().version,10)==8&&r.css("line-height","26px");this._editForm=this.element.find(".kanbanform");a.hide()},_setKanbanDdlValue:function(i){for(var s,u,f=i.find("select.e-field"),e,o=i.find("input.e-field.e-dropdownlist"),r=0;r<f.length;r++)s={},s[this._id+"drpDownTempl"]="{{:"+f[r].name.replace(/[^a-z0-9\s]/gi,"")+"}}",n.templates(s),e=n.render[this._id+"drpDownTempl"](this._currentData),i.find("select").eq(r).val(e).attr("selected","selected"),f.eq(r).val(e);for(u=0;u<o.length;u++)o.eq(u).val(t.getObject(o.eq(u).attr("name"),this._currentData[0]))},_editAdd:function(i){var f,y=this.element.find(".e-kanbandialog"),e=n(i.target),a,h=new t.Query,c=document.createElement("div"),l=n(c),o,r,u,s,v;i.requestType==t.Kanban.Actions.Add?l.addClass("e-addedrow"):(this._currentData={},e.hasClass("e-kanbancard")?o=e.attr("id"):e.parents(".e-kanbancard").length>0&&(o=e.parents(".e-kanbancard").attr("id")),a=t.DataManager(this._currentJsonData),h=h.where(this.model.fields.primaryKey,t.FilterOperators.equal,parseInt(o,10)),this._currentData=a.executeLocal(h),l.addClass("e-editedrow"));c.innerHTML=n.render[this._id+"_dialogEditingTemplate"](this._currentData);this._setKanbanDdlValue(l);f=n("#"+this._id+"_dialogEdit");f.html(n(c));r={};r.cssClass=this.model.cssClass;r.enableRTL=this.model.enableRTL;r.width="auto";r.content="#"+this._id;r.close=n.proxy(this.cancelEdit,this);r.open=n.proxy(this._onKbnDialogOpen,this);r.enableModal=!0;r.enableResize=!1;i.requestType==t.Kanban.Actions.Add?t.isNullOrUndefined(this.model.fields.title)||n.isEmptyObject(this._newData)?r.title=this.localizedLabels.AddFormTitle:(u=this.model.fields.title,r.title=this.localizedLabels.EditFormTitle+this._newData[u]):(u=this.model.fields.primaryKey,t.isNullOrUndefined(this.model.fields.title)||(u=this.model.fields.title),r.title=this.localizedLabels.EditFormTitle+this._currentData[0][u]);f.ejDialog(r);f.ejDialog("open");y.attr("data-id",o);s=this.element.find("#"+this._id+"_dialogEdit_wrapper");s.css("left","0");v=self!=parent?t.browserInfo().name=="chrome"?n(window).scrollTop():-n(window.frameElement).offset().top:n(window).scrollTop();s.css("top",v);s.hide();this.initValidator();this.setValidation()},_onKbnDialogOpen:function(){var t=this.element.find("#"+this._id+"_dialogEdit_wrapper"),i,r,o,u,f,s,h,l,a,c,e;for(t.css("position","absolute"),o=n(this.element)[0],u=o.offsetTop,f=o.offsetLeft,s=o.offsetWidth,h=o.offsetHeight,window.pageYOffset>u?(i=u+h>window.pageYOffset+window.innerHeight?Math.max(0,(window.innerHeight-t.outerHeight())/2):Math.max(0,(u+h-window.pageYOffset-t.outerHeight())/2),i=window.pageYOffset+i):(i=u+h>window.pageYOffset+window.innerHeight?Math.max(0,(window.innerHeight-(u-window.pageYOffset)-t.outerHeight())/2):Math.max(0,(h-t.outerHeight())/2),i=u+i),window.pageXOffset>f?(r=f+s>window.pageXOffset+window.innerWidth?Math.max(0,(window.innerWidth-t.outerWidth())/2):Math.max(0,(f+s-window.pageXOffset-t.outerWidth())/2),r=window.pageXOffset+r):(r=f+s>window.pageXOffset+window.innerWidth?Math.max(0,(window.innerWidth-(f-window.pageXOffset)-t.outerWidth())/2):Math.max(0,(s-t.outerWidth())/2),r=f+r),t.css("top",i+"px"),t.css("left",r+"px"),t.show(),l=n(this._editForm).find("input,select,div.e-field,textarea.e-field"),a=!1,c=0;c<l.length;c++)e=l.eq(c),(e.is(":disabled")||a||e.is(":hidden")&&typeof(e.data("ejDropDownList")||e.data("ejNumericTextbox"))!="object")&&!e.hasClass("e-rte")||(this._focusKbnDialogEle(e),a=!0);this._editForm.find(".e-rte").length>0&&this.element.find("#"+this._id+"_dialogEdit").data("ejDialog")._resetScroller()},_focusKbnDialogEle:function(n){if(n.length)if((n[0].tagName.toLowerCase()!="select"||n.hasClass("e-field e-dropdownlist"))&&n[0].tagName.toLowerCase()!="input"&&(n[0].tagName.toLowerCase()!="textarea"||n.hasClass("e-numerictextbox")))n.hasClass("e-field e-dropdownlist")?n.closest(".e-ddl").focus():n.hasClass("e-numerictextbox")?n.siblings("input:visible").first().select().focus():n.find("input:visible,select").first().select().focus();else if(n.hasClass("e-rte")){var t=n.data("ejRTE");t.focus();t.selectAll()}else n.focus().select(),n[0].focus()},_cardDblClickHandler:function(t){this._cardEditClick=!0;this._dblArgs=t;this.startEdit(n(t.target).closest(".e-kanbancard"))},_cellDblClickHandler:function(t){n(t.target).hasClass("e-rowcell")&&(this._isAddNewClick=!0,this._newCard=n(t.target),this.addCard())},endEdit:function(){var c,s,u,i,l,a,r,f,e,h,v,o;if(this.model.editSettings.allowEditing||this.model.editSettings.allowAdding){if(c=this.element.find(".e-kanbandialog"),u={},!this.editFormValidate())return!0;for(i=document.getElementById(this._id+"EditForm"),l=n(i),a=l.closest("div"),t.isNullOrUndefined(c.attr("data-id"))?(s=this._currentJsonData[this._currentJsonData.length-1][this.model.fields.primaryKey]+1,u[this.model.fields.primaryKey]=s):s=parseInt(c.attr("data-id")),r=0;r<i.length;r++)if(!a.hasClass("e-addedrow")||!n(i[r]).hasClass("e-identity")){if(f=i[r].name,e=n(i[r]),e.hasClass("e-dropdownlist e-input")&&e.attr("id").indexOf("_input")!=-1||e.hasClass("e-dropdownlist")&&e.is(":hidden")){!t.isNullOrUndefined(l[1])&&t.isNullOrUndefined(i[r+1])&&(i=l[1],r=-1);continue}f!=undefined&&(f==""&&(i[r].id.indexOf("Save")!=-1||i[r].id.indexOf("Cancel")!=-1?f="":(f=i[r].id.replace(this._id+"_",""),f=f.replace("_hidden",""))),f!=""&&u[f]==null?(h=i[r].value,n(i[r]).hasClass("e-datepicker")?h=e.ejDatePicker("model.value"):n(i[r]).hasClass("e-datetimepicker")?h=e.ejDateTimePicker("model.value"):e.is(".e-numerictextbox")?(h=e.ejNumericTextbox("getValue"),h=h||""):e.data("ejDropDownList")&&(h=e.ejDropDownList("getSelectedValue")),v=i[r].type!="checkbox"?h:n(i[r]).is(":checked"),u[f]=v):f==this.model.fields.primaryKey&&(u[this.model.fields.primaryKey]=i[r].value))}if(this._editForm=this.element.find(".kanbanform"),u[this.model.fields.primaryKey]=isNaN(u[this.model.fields.primaryKey])?parseInt(s):s=parseInt(u[this.model.fields.primaryKey]),o={data:u},o.requestType=t.Kanban.Actions.Save,this._trigger("actionBegin",o))return!0;n(this._editForm).hasClass("e-formdestroy")?this.refresh(!0):t.isNullOrUndefined(c.attr("data-id"))?(o.action=t.Kanban.Actions.Add,o.primaryKeyValue=parseInt(s),this._cAddedRecord=u):(o.action=t.Kanban.Actions.Edit,o.primaryKeyValue=parseInt(s),this._cModifiedData=u);o.primaryKey=this.model.fields.primaryKey;this._saveArgs=o;this.updateCard(s,u);this.element.find(".e-kanbandialog").removeAttr("data-id");n("#"+this._id+"_dialogEdit").ejDialog("close")}},initValidator:function(){for(var i=this,u=this.element.find(".kanbanform"),r=0;r<u.length;r++)u.eq(r).validate({ignore:".e-hide,:hidden",errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(r,u){u.is(":hidden")&&(u=u.siblings("input:visible"));var e=u.closest("td"),f=n(r).addClass("e-error"),o=t.buildTag("div.e-errortail e-toparrow");i.model.editSettings.editMode!="dialog"&&e.find(".e-error").remove();u.parent().hasClass("e-in-wrap")?f.insertAfter(u.closest(".e-widget")):f.insertAfter(u);f.prepend(o);i.model.enableRTL?i.model.editSettings.editMode!="dialog"&&f.offset({top:u.offset().top+u.height()}):i.model.editSettings.editMode!="dialog"&&f.offset({left:u.offset().left,top:u.offset().top+u.height()});f.fadeIn("slow")}})},setValidation:function(){for(var n=0;n<this.model.editSettings.editItems.length;n++)t.isNullOrUndefined(this.model.editSettings.editItems[n].validationRules)||this.setValidationToField(this.model.editSettings.editItems[n].field,this.model.editSettings.editItems[n].validationRules)},setValidationToField:function(i,r){var u=i,e,f,o,s;t.isNullOrUndefined(i)||(u=u.replace(/[^a-z0-9\s_]/gi,""));o=this.element.find(".kanbanform");e=o.find("#"+this._id+"_"+u).length>0?o.find("#"+this._id+"_"+u):o.find("#"+u);e.attr("name")||e.attr("name",i);e.rules("add",r);s=n("#"+this._id+"EditForm").validate();s.settings.messages[i]=s.settings.messages[i]||{};t.isNullOrUndefined(r.required)||(f=t.isNullOrUndefined(r.messages&&r.messages.required)?n.validator.messages.required:r.messages.required,f.indexOf("This field")==0&&(f=f.replace("This field",i)),s.settings.messages[i].required=f)},editFormValidate:function(){return n.isFunction(n.validator)?n("#"+this._id+"EditForm").validate().form():!0},_addDialogEditingTemplate:function(){var o,f,v,y,p,u,w,b,s,h,r,i,c,g,k,nt,d,l,a,tt,e,it;if(this.model.columns.length!=0){if(o=t.buildTag("div"),f=t.buildTag("form.kanbanform","",{},{id:this._id+"EditForm"}),v=t.buildTag("table","",{},{cellspacing:"14px"}),t.isNullOrUndefined(this.model.editSettings.editMode)&&(this.model.editSettings.editMode=t.Kanban.EditMode.Dialog),this.model.editSettings.editMode==t.Kanban.EditMode.Dialog)for(h=0;h<this.model.editSettings.editItems.length;h++){r=this.model.editSettings.editItems[h];i=r.field;y=t.buildTag("tr");p=t.buildTag("td","",{"text-align":"right"}).addClass("e-label");u=t.buildTag("td","",{"text-align":"left"}).addClass("e-rowcell");y.append(p.get(0)).append(u.get(0));p.append("<label style='text-transform:capitalize' for='"+i+"'>"+i+"<\/label>");t.isNullOrUndefined(r.editType)&&(r.editType="stringedit");t.isNullOrUndefined(i)||(i=i.replace(/[^a-z0-9\s_]/gi,""));switch(r.editType){case"stringedit":this.model.fields.primaryKey==i?u.html(t.buildTag("input.e-field e-ejinputtext e-disable","",{},{value:"{{html:#data['"+i+"']}}",id:this._id+"_"+i,name:i,disabled:"disabled"})):u.html(t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{html:#data['"+i+"']}}",id:this._id+"_"+i,name:i}));break;case"numericedit":u.html(t.buildTag("input.e-numerictextbox e-field","",{},{type:"text",value:"{{:#data['"+i+"']}}",id:this._id+"_"+i,name:i}));break;case"dropdownedit":if(c=[],t.isNullOrUndefined(r.dataSource))for(a=(new t.Query).where(t.Predicate.or(this.keyPredicates)).select(r.field),t.isNullOrUndefined(this._dropDownManager)||!this._dataManager.dataSource.offline&&this._dataManager.dataSource.json.length?d=this._dataManager.executeLocal(a):(this._dataManager.adaptor instanceof t.JsonAdaptor&&r.field.indexOf(".")!=-1&&(tt=r.field.replace(/\./g,t.pvt.consts.complexPropertyMerge),a=(new t.Query).select(tt)),d=this._dropDownManager.executeLocal(a)),l=t.dataUtil.mergeSort(t.distinct(d)),e=0;e<l.length;e++)c.push({text:l[e],value:l[e]});else c=r.dataSource;k=t.buildTag("select");nt=t.buildTag("option","{{:text}}",{},{value:"{{html:#data['value']}}"});k.append(nt);g=n.templates(k.html());u.get(0).innerHTML=t.isNullOrUndefined(r.editParams)||t.isNullOrUndefined(r.dataSource)?["<select>",g.render(c),"<\/select>"].join(""):"<input>";u.find("select,input").prop({id:this._id+"_"+i,name:i}).addClass("e-field e-dropdownlist");break;case"rteedit":u.html(t.buildTag("textarea.e-field e-rte","{{html:#data['"+i+"']}}",{},{id:this._id+"_"+i,name:i}));break;case"textarea":u.html(t.buildTag("textarea.e-field e-kanbantextarea e-ejinputtext","{{html:#data['"+i+"']}}",{},{id:this._id+"_"+i,name:i}));break;case"datepicker":case"datetimepicker":u.html(t.buildTag("input.e-"+r.editType+" e-field","",{},{type:"text",value:"{{:#data['"+i+"']}}",id:this._id+"_"+i,name:i}))}v.append(y);f.append(v);f.appendTo(o)}else this.model.editSettings.editMode==t.Kanban.EditMode.DialogTemplate&&this.model.editSettings.dialogTemplate!=null&&(it=this.model.editSettings.dialogTemplate),f.html(n(it).html()),f.appendTo(o);w=t.buildTag("input.e-save","",{},{type:"button",id:this._id+"_Save"});w.ejButton({text:this.localizedLabels.SaveButton,width:"100"});b=t.buildTag("input.e-cancel","",{"margin-left":"15px","margin-right":"13px"},{type:"button",id:this._id+"_Cancel"});b.ejButton({text:this.localizedLabels.CancelButton,width:"100"});s=t.buildTag("div#"+this._id+"_EditBtnDiv","",{},{"class":"e-kanban-editdiv"});s.append(w);s.append(b);f.append(s);n.templates(this._id+"_dialogEditingTemplate",o.html())}}}}(jQuery,Syncfusion),function(n,t){t.widget("ejKanban","ej.Kanban",{_rootCSS:"e-kanban",element:null,_requiresID:!0,validTags:["div"],model:null,observables:["dataSource"],_tags:[{tag:"columns",attr:["headerTemplate","headerText","key","isCollapsed","visible","constraints.type","constraints.min","constraints.max"]},{tag:"stackedHeaderRows",attr:[[{tag:"stackedHeaderColumns",attr:["headerText","column"]}]]},{tag:"contextMenuSettings",attr:["customMenuItems","menuItems","disableDefaultItems"]},{tag:"filterSettings",attr:["text","query","description"]},{tag:"editSettings.editItems",attr:["field","editType","validationRules","editParams","defaultValue"]}],_dataSource:t.util.valueFunction("dataSource"),keyConfigs:{focus:"e",insertCard:"45",deleteCard:"46",editCard:"113",saveRequest:"13",cancelRequest:"27",firstCardSelection:"36",lastCardSelection:"35",upArrow:"38",downArrow:"40",rightArrow:"39",leftArrow:"37",swimlaneExpandAll:"ctrl+40",swimlaneCollapseAll:"ctrl+38",selectedGroupExpand:"alt+40",selectedGroupCollapse:"alt+38",selectedColumnCollapse:"ctrl+37",selectedColumnExpand:"ctrl+39",multiSelectionByUpArrow:"shift+38",multiSelectionByDownArrow:"shift+40",multiSelectionByLeftArrow:"shift+37",multiSelectionByRightArrow:"shift+39"},defaults:{htmlAttributes:{},cssClass:"",dataSource:null,tooltipSettings:{enable:!1,template:null},swimlaneSettings:{showCount:!0},currentViewData:null,allowSelection:!0,selectionType:"single",allowDragAndDrop:!0,allowKeyboardNavigation:!1,allowToggleColumn:!1,allowTitle:!1,enableTotalCount:!1,allowSearching:!1,allowHover:!0,allowScrolling:!1,enableRTL:!1,enableTouch:!0,stackedHeaderRows:[],filterSettings:[],scrollSettings:{width:"auto",height:0,allowFreezeSwimlane:!1},keyField:null,cardSettings:{colorMapping:{},template:null},columns:[],contextMenuSettings:{enable:!1,menuItems:[{menuItem:"Add Card"},{menuItem:"Edit Card"},{menuItem:"Delete Card"},{menuItem:"Top of Row"},{menuItem:"Bottom of Row"},{menuItem:"Move Up"},{menuItem:"Move Down"},{menuItem:"Move Left"},{menuItem:"Move Right"},{menuItem:"Move Swimlane"},{menuItem:"Hide Column"},{menuItem:"Visible Columns"}],customMenuItems:[]},fields:{primaryKey:null,color:null,tag:null,imageUrl:null,content:null,swimlaneKey:null},editSettings:{editItems:[],allowEditing:!1,allowAdding:!1,dialogTemplate:null},searchSettings:{fields:[],key:"",operator:"contains",ignoreCase:!0},locale:"en-US",query:null,create:null,actionBegin:null,actionComplete:null,actionFailure:null,load:null,destroy:null,beginEdit:null,endEdit:null,endAdd:null,endDelete:null,beforeCardSelect:null,cardSelect:null,toolbarClick:null,cardDoubleClick:null,cardDragStart:null,cardDrag:null,cardDragStop:null,cardDrop:null,contextClick:null,contextOpen:null},dataTypes:{dataSource:"data",query:"data",columns:"array",stackedHeaderRows:"array",contextMenuSettings:{disableDefaultItems:"array",menuItems:"array",customMenuItems:"array"},filterSettings:"array",editSettings:{editMode:"enum",editItems:"array"},searchSettings:{fields:"array"}},_destroy:function(){var u,i,f,r;if(this.element.off(),this.element.find(".e-kanbanheader").find(".e-headercontent").add(this.getContent().find(".e-content")).unbind("scroll"),t.isNullOrUndefined(this._filterToolBar)||this._filterToolBar.ejToolbar("destroy"),!t.isNullOrUndefined(this._editForm)){for(u=this._editForm.find(".e-field"),r=0;r<u.length;r++)i=n(u[r]),i.hasClass("e-ejinputtext")&&this.element.find(".e-ejinputtext").remove(),i.hasClass("e-kanbantextarea")&&this.element.find(".e-kanbantextarea").remove(),i.hasClass("e-dropdownlist")&&i.ejDropDownList("destroy"),i.hasClass("e-numerictextbox")&&i.ejNumericTextbox("destroy"),f=i.parent("div").find("textarea.e-rte"),f.length&&(f.ejRTE("destroy"),i.parent().find("textarea").remove());n("#"+this._id+"_dialogEdit").ejDialog("destroy")}this.element.ejWaitingPopup("destroy");this.model.contextMenuSettings.enable&&(n("#"+this._id+"_Context").ejMenu("destroy"),n("#"+this._id+"_Context").remove());this.element.children().remove()},_wireEvents:function(){this._on(this.element,n.isFunction(n.fn.tap)&&this.model.enableTouch?"tap":"click",this._clickHandler);this._on(n("#"+this._id+"_searchbar"),"keyup",this._onToolbarClick);this._on(n(document),"click touchstart",this._kbnTouchClick);t.kanbanFeatures.edit&&this._enableEditingEvents();this._enableCardHover();this.model.tooltipSettings.enable&&(this._on(this.element,"mouseover",".e-kanbancard",this._showToolTip),this._on(this.element,"mouseout",".e-kanbancard",this._hideToolTip));this.model.allowKeyboardNavigation&&(this.element[0].tabIndex=this.element[0].tabIndex==-1?0:this.element[0].tabIndex,this.element[0].accessKey=!t.isNullOrUndefined(this.element[0].accessKey)&&this.element[0].accessKey!=""?this.element[0].accessKey:"e",this._on(this.element,"keyup",this._keyDownHandler))},_initialize:function(){this._timeout=null},_initPrivateProperties:function(){this._headerContent=null;this._headerTable=null;this._contentTable=null;this._kanbanContent=null;this._dataManager=this._dataSource()instanceof t.DataManager?this._dataSource():this._dataSource()!=null?t.DataManager(this._dataSource()):null;this._kanbanWidth=this.element.width();this.keyPredicates=null;this._cloneQuery=null;this._kanbanRows=null;this._taskLists=null;this._isLocalData=!0;this._columnRows=null;this._tableBEle=null;this._previousRowCellIndex=[];this._currentRowCellIndex=[];this.selectedRowCellIndexes=[];this._bulkUpdateData=[];this._failBulkData=[];this._priorityCollection=[];this.templates={};this.initialRender=!1;this._columnsWidthCollection=[];this._slTemplate="";this._tdsOffsetWidth=[];this._scrollObject=null;this._templateRefresh=!1;this._action="";this._hiddenColumns=[];this._visibleColumns=[];this._filterCollection=[];this._collapsedColumns=[];this._expandedColumns=[];this._collapsedCards=[];this.templates={};this._originalWidth=this.element.width();this._recordsCount=this._dataSource()!==null?this._dataSource().length:0;this.localizedLabels=this._getLocalizedLabels();this._selectedCardData=[];this._selectedCards=[];this._pCardId=null;this._cCardId=null;this._freezeSlOrder=0;this._swimlaneRows=null;this._freezeSwimlaneRow=null;this._searchBar=null;this._enableMultiTouch=!1;this._enableSwimlaneCount=!0;this._kTouchBar=null},_init:function(){if(this._trigger("load"),!t.isNullOrUndefined(this.model.query)&&this.model.query instanceof t.Query||(this.model.query=t.Query()),this._initPrivateProperties(),this._initialize(),this.model.columns.length==0)return!1;this.element.removeClass("e-kanbanscroll");this._initScrolling();this._checkDataBinding()},_initKanbanRender:function(){this._addInitTemplate();this.model.keySettings&&n.extend(this.model.keyConfigs,this.model.keySettings);this._render();this._trigger("dataBound",{});(this.model.editSettings.allowEditing||this.model.editSettings.allowAdding)&&(this._processEditing(),this.element.append(this._renderDialog()));this._setResponsiveHeightWidth();this._renderKanbanTouchBar();this._wireEvents();this.model.tooltipSettings.enable&&(this.element.append(n("<div class='e-kanbantooltip'><\/div>")),this.element.find(".e-kanbantooltip").hide());this.initialRender=!1},_render:function(){this.element.addClass(this.model.cssClass+"e-widget");this._renderContent().insertAfter(this.element.children(".e-kanbanheader"));this._renderLimit();this._enableDragandScroll();this.initialRender&&this._addLastRow()},_renderLimit:function(){for(var i,h,c,o,s,f="",r=0;r<this.model.columns.length;r++)if(i=this.model.columns[r],!t.isNullOrUndefined(i.constraints)){h=!t.isNullOrUndefined(i.constraints.min);c=!t.isNullOrUndefined(i.constraints.max);(h||c)&&(f=this.getHeaderContent().find(".e-columnheader").not(".e-stackedHeaderRow").find(".e-headercell")[r]);o=this.getHeaderContent().find("span.e-totalcount");var l=i.key,e=n(n(this.element.find(".e-columnrow")).find("td[ej-mappingkey="+l+"]")),u=0;s=e.find(".e-kanbancard").length;n(o[r]).text(s);t.isNullOrUndefined(i.constraints.type)&&(i.constraints.type=t.Kanban.Type.Column);switch(i.constraints.type){case"column":this._validateLimit(i,f,u);break;case"swimlane":for(u=0;u<e.length;u++)this._validateLimit(i,f,u),this.getHeaderContent().find(".e-headercell").eq(r).hasClass("e-shrinkcol")||e.eq(u).find(".e-limits").removeClass("e-hide");t.isNullOrUndefined(this.model.fields.swimlaneKey)||n(f).find(".e-limits").addClass("e-hide")}}},refreshColumnConstraints:function(){this._renderLimit();var n={};n.requestType=t.Kanban.Actions.Refresh;this._filterCollection.length>0&&(n.filterCollection=this._filterCollection,this._filterLimitCard(n));this._swimlaneLimit(n);this._enableSwimlaneCount=!1},_validateLimit:function(i,r,u){var s=i.key,f=n(n(this.element.find(".e-columnrow")).find("td[ej-mappingkey="+s+"]")),e,h=!t.isNullOrUndefined(i.constraints.min),c=!t.isNullOrUndefined(i.constraints.max),o=!t.isNullOrUndefined(this.model.fields.swimlaneKey)&&u==0;i.constraints.type=="column"?e=f.find(".e-kanbancard").length:(e=n(f[u]).find(".e-kanbancard").length,f=n(f[u]));h&&(i.constraints.min>e?(f.addClass("e-deceed"),o&&n(r).addClass("e-deceed")):(f.removeClass("e-deceed"),o&&n(r).removeClass("e-deceed")));c&&(i.constraints.max<e?(f.addClass("e-exceed"),o&&n(r).addClass("e-exceed")):(f.removeClass("e-exceed"),o&&n(r).removeClass("e-exceed")));f.find(".e-limits").addClass("e-hide");n(r).find(".e-limits").removeClass("e-hide")},_swimlaneLimit:function(i){for(var r,c,o,l,s,a,f,v,h,u=0;u<this.model.columns.length;u++)if(r=this.model.columns[u].constraints,c=this.model.columns[u].key,!t.isNullOrUndefined(r)){var y=!t.isNullOrUndefined(r.min),p=!t.isNullOrUndefined(r.max),e=n(n(this.getContent().find(".e-columnrow")).find("td[ej-mappingkey="+c+"]"));if(r.type=="swimlane"&&!t.isNullOrUndefined(this.model.fields.swimlaneKey)&&(this._enableSwimlaneCount&&(i.requestType==t.Kanban.Actions.Filtering||i.requestType==t.Kanban.Actions.Refresh)||this._filterCollection.length>0&&this._enableSwimlaneCount))for(f=0;f<e.length;f++)v=t.buildTag("div.e-limits"),n(e).eq(f).prepend(v),h=n(e).eq(f).find(".e-limits"),y&&(o=t.buildTag("div.e-min",this.localizedLabels.Min+" [","",{}),l=t.buildTag("span.e-minlimit",r.min,"",{}),o.append(l).append("]"),h.append(o)),p&&(s=t.buildTag("div.e-max",this.localizedLabels.Max+" [","",{}),a=t.buildTag("span.e-maxlimit",r.max,"",{}),s.append(a).append("]"),h.append(s)),this.getHeaderContent().find(".e-headercell").eq(u).hasClass("e-shrinkcol")&&n(e).eq(f).find(".e-limits").addClass("e-hide")}},_filterLimitCard:function(i){for(var o,r,e,f,u=0;u<this.model.columns.length;u++)o=this.model.columns[u],r=this.getHeaderContent().find("span.e-totalcount"),this.model.enableTotalCount&&(r=r[u],e=n(r).text().indexOf(this.localizedLabels.FilterOfText),(!t.isNullOrUndefined(i)&&i.requestType==t.Kanban.Actions.Filtering||this.model.enableTotalCount)&&i.filterCollection.length>0?(f=this.getHeaderContent().find(".e-columnheader").not(".e-stackedHeaderRow").find(".e-headercell")[u],n(f).hasClass("e-exceed")?n(f).removeClass("e-exceed"):n(f).hasClass("e-deceed")&&n(f).removeClass("e-deceed"),e!=-1&&n(r).text(n(r).text().slice(e+3)),n(r).text(n(n(this.element.find(".e-columnrow")).find("td[ej-mappingkey="+o.key+"] > div.e-kanbancard")).length+" "+this.localizedLabels.FilterOfText+" "+n(r).text())):t.isNullOrUndefined(o.constraints)?n(r).text(n(r).text().slice(e+3)):this._renderLimit())},_enableDragandScroll:function(){this.model.allowDragAndDrop&&t.kanbanFeatures.dragAndDrop&&this._addDragableClass();this.model.allowScrolling&&(this.initialRender?(t.isNullOrUndefined(this.model.fields.swimlaneKey)||(this._swimlaneRows=this.element.find(".e-swimlanerow")),this._renderScroller()):this._refreshScroller({requestType:"refresh"}));this.model.enableTotalCount&&this._totalCount()},_refreshScroller:function(n){var i=this.getContent().first();t.isNullOrUndefined(i.data("ejScroller"))||(n.requestType=="beginedit"&&this.getScrollObject().scrollY(0,!0),i.ejScroller("refresh"),i.ejScroller("model.enableRTL",this.model.enableRTL),i.ejScroller("isVScroll")&&!this.getScrollObject().model.autoHide?(this.getHeaderContent().addClass("e-scrollcss"),this.getHeaderContent().find(".e-headercontent").hasClass("e-hscrollcss")||this.getHeaderContent().find(".e-headercontent").addClass("e-hscrollcss")):this.element.find(".e-kanbanheader").removeClass("e-scrollcss"))},_renderHeader:function(){var o=t.buildTag("div.e-kanbanheader"),l=t.buildTag("div"),k=n(document.createElement("colgroup")),h,g,r,p,it,e,rt,ut,w,ft,b,et;t.isNullOrUndefined(this.model.fields.swimlaneKey)||o.addClass("e-slheader");this.model.allowScrolling&&l.addClass("e-headercontent");o.append(l);var s=t.buildTag("table.e-table","",{},{cellspacing:"0.25px",role:"kanban"}),a=t.buildTag("thead"),d=t.buildTag("tbody.e-hide",{});for(h=0;h<this.model.stackedHeaderRows.length;h++)g=this._createStackedRow(this.model.stackedHeaderRows[h]),a.append(g);var nt=t.buildTag("tr.e-columnheader"),tt=n(document.createElement("tr")),u=this.model.columns;for(this._visibleColumns=[],this._expandedColumns=[],this._headerColumnNames={},r=0;r<u.length;r++){var i=u[r],f=t.buildTag("th.e-headercell","",{},{role:"columnheader"}),c=document.createElement("col"),ot=document.createElement("td"),v=t.buildTag("div.e-headercelldiv",{}),y=t.buildTag("div.e-headerdiv",i.headerText!=null?i.headerText:i.key,{},{});t.isNullOrUndefined(i.headerTemplate)||y.html(n(i.headerTemplate).hide().html());e="";this.model.enableTotalCount&&(p=t.buildTag("div.e-totalcard","",{}),it=t.buildTag("span.e-totalcount","",{}),p.append("[").append(it).append("]"),y.append(p));t.isNullOrUndefined(i.constraints)||(rt=!t.isNullOrUndefined(i.constraints.min),ut=!t.isNullOrUndefined(i.constraints.max),e=t.buildTag("div.e-limits","",{}),rt&&(w=t.buildTag("div.e-min",this.localizedLabels.Min+" [","",{}),ft=t.buildTag("span.e-minlimit",i.constraints.min,"",{}),w.append(ft).append("]"),e.append(w)),ut&&(b=t.buildTag("div.e-max",this.localizedLabels.Max+" [","",{}),et=t.buildTag("span.e-maxlimit",i.constraints.max,"",{}),b.append(et).append("]"),e.append(b)));v.append(y).append(e);f.append(v);this.model.allowToggleColumn&&(u[r].isCollapsed===!0?f.append(t.buildTag("div.e-icon e-clcollapse")).addClass("e-shrinkcol"):f.append(t.buildTag("div.e-icon e-clexpand")));u[r].isCollapsed===!0&&this.model.allowToggleColumn?(f.find(".e-headercelldiv").addClass("e-hide")&&n(c).addClass("e-shrinkcol"),n.inArray(u[r].headerText,this._collapsedColumns)==-1&&this._collapsedColumns.push(u[r].headerText)):(f.find(".e-headercelldiv").removeClass("e-hide")&&n(c).removeClass("e-shrinkcol"),this._expandedColumns.push(u[r].headerText),u[r].isCollapsed=!1);k.append(c);nt.append(f);tt.append(ot);i.visible===!1?(f.addClass("e-hide")&&n(c).css("display","none"),n.inArray(i.headerText,this._hiddenColumns)==-1&&this._hiddenColumns.push(i.headerText)):(this._visibleColumns.push(i.headerText),i.visible=!0);t.isNullOrUndefined(i.headerTemplate)||v.parent().addClass("e-headertemplate");this.initialRender&&(typeof i.width=="string"&&i.width.indexOf("%")!=-1?this._columnsWidthCollection.push(parseInt(i.width)/100*this.element.width()):this._columnsWidthCollection.push(i.width))}return a.append(nt),s.append(k).append(a),d.append(tt),s.append(d),l.append(s),this.setHeaderContent(o),this.setHeaderTable(s),o},_renderContent:function(){var i=t.buildTag("div.e-kanbancontent"),u=t.buildTag("div"),f=t.buildTag("tbody"),n=t.buildTag("table.e-table","",{},{cellspacing:"0.25px",role:"kanban"}),r;return n.append(this.getHeaderTable().find("colgroup").clone()).append(f),u.append(n),i.append(u),this.setContent(i),this.setContentTable(n),n.attr("role","kanban"),r={},r.requestType=t.Kanban.Actions.Refresh,this.sendDataRenderingRequest(r),i},_renderToolBar:function(){var i=t.buildTag("div.e-kanbantoolbar","",{},{id:this._id+"_toolbarItems"}),f,u,o,n,s;if(this.model.allowSearching){this._isWatermark="placeholder"in document.createElement("input");var e=t.buildTag("ul.e-searchbar"),r=t.buildTag("li.e-search","",{},{id:this._id+"_toolbarItems_search"}),a=t.buildTag("a.e-searchitem e-toolbaricons e-disabletool e-icon e-searchfind","",{position:"absolute"}),h=t.buildTag("input.e-ejinputtext e-input","",{},{type:"text",id:this._id+"_searchbar",placeholder:"Search",height:"33px"}),c=t.buildTag("div.e-searchdiv","",{display:"inline-table",width:"83%"});c.append(h);r.append(c);r.append(a);e.append(r);this._searchInput=h;t.isNullOrUndefined(this.model.searchSettings.key)||this._searchInput.val(this.model.searchSettings.key);this._searchBar=r;this._isWatermark||(this._hiddenSpan=t.buildTag("span.e-input e-placeholder","Search",{display:"block"}).insertAfter(this._searchInput))}for(t.isNullOrUndefined(this.model.customToolbarItems)||(f=t.buildTag("ul.e-customtoolbar"),this.model.filterSettings.length>0&&f.addClass("e-customtoolbarseparator"),!t.isNullOrUndefined(this.model.customToolbarItems)&&this.model.customToolbarItems.length&&this._renderCustomLi(f),i.append(f)),this.model.filterSettings.length>0&&(u=t.buildTag("ul"),o=t.buildTag("li","",{},{"class":"e-quickfilter"},{tabindex:"0"}),o.append("<label class='e-toolbartext e-text'>"+this.localizedLabels.FilterSettings+"<\/label>"),u.append(o)),n=0;n<this.model.filterSettings.length;n++){var l=this.model.filterSettings[n].description,r=t.buildTag("li","",{},{id:this._id+"_"+this.model.filterSettings[n].text,title:t.isNullOrUndefined(l)?this.model.filterSettings[n].text:l,tabindex:"0"}),v=t.buildTag("a.e-toolbartext e-text",this.model.filterSettings[n].text);r.html(v);u.append(r)}return t.isNullOrUndefined(u)||i.append(u),t.isNullOrUndefined(e)||i.append(e),s={},s.click=this._onToolbarClick,i.ejToolbar(s),this._filterToolBar=i,i},_renderCustomLi:function(i){for(var e,u,f,r=0;r<this.model.customToolbarItems.length;r++){f=this.model.customToolbarItems[r].template?this.model.customToolbarItems[r].template.replace("#",""):this.model.customToolbarItems[r];u=t.buildTag("li","",{},{id:this._id+"_"+f,title:f});switch(typeof this.model.customToolbarItems[r]){case"string":e=t.buildTag("a.e-toolbaricons e-icon","",{}).addClass(this.model.customToolbarItems[r]);break;case"object":u.attr("title",this.model.customToolbarItems[r].template.replace("#",""));e=n(this.model.customToolbarItems[r].template).hide().html()}u.html(e);i.append(u)}},_enableKanbanRTL:function(){this.model.enableRTL?this.element.addClass("e-rtl"):this.element.removeClass("e-rtl")},_enableCardHover:function(){this.model.allowHover?this._on(this.element,"mouseenter mouseleave",".e-columnrow .e-kanbancard",this._cardHover):this._off(this.element,"mouseenter mouseleave",".e-columnrow .e-kanbancard")},_createStackedRow:function(n){for(var l,a,s,e,u,v,r,h,o,f,p,w,y=t.buildTag("tr.e-columnheader e-stackedHeaderRow"),i=[],c=0;c<this.model.columns.length;c++)if(l=this.model.columns[c],l.visible!=!1){for(a="",s=n.stackedHeaderColumns,e=0;e<s.length;e++)s[e].column.indexOf(l.headerText)!=-1&&(a=s[e].headerText);i.push(a)}for(u=[],v="",r=0;r<i.length;r++){for(h=1,o=r+1;o<i.length;o++)if(i[r]!=""&&i[o]!=""&&i[r]==i[o])h++;else break;u.push({sapnCount:h,headerText:i[r],css:i[r]!=""?v:"e-sheader"});r+=h-1;v=""}for(f=0;f<u.length;f++)p=t.buildTag("div",u[f].headerText),w=t.buildTag("th.e-headercell e-stackedHeaderCell "+u[f].css+"",{},{},{colspan:u[f].sapnCount}).append(p),y.append(w);return y},getBrowserDetails:function(){var t=navigator.userAgent.match(/(firefox|chrome|opera|msie|safari)\s?\/?(\d+(.\d+)*)/i);return!navigator.userAgent.match(/Trident\/7\./)?{browser:t[1].toLowerCase(),version:t[2]}:{browser:"msie",version:n.uaMatch(navigator.userAgent).version}},refreshTemplate:function(){this._addInitTemplate();(this.model.editSettings.allowEditing||this.model.editSettings.allowAdding)&&this._addDialogEditingTemplate()},getContentTable:function(){return this._contentTable},setContentTable:function(n){this._contentTable=n},getVisibleColumnNames:function(){return this._visibleColumns},getHeaderContent:function(){return this._headerContent},setHeaderContent:function(n){this._headerContent=n},getHeaderTable:function(){return this._headerTable},setHeaderTable:function(n){this._headerTable=n},getContent:function(){return this._kanbanContent},setContent:function(n){this._kanbanContent=n},getScrollObject:function(){return(this._scrollObject==null||t.isNullOrUndefined(this._scrollObject.model))&&(this._scrollObject=this.getContent().ejScroller("instance")),this._scrollObject},getColumnByHeaderText:function(n){for(var i=this.model.columns,t=0;t<i.length;t++)if(i[t].headerText==n)break;return t==i.length?null:i[t]},_showToolTip:function(i){var s,h,e,o;if(this.model.tooltipSettings.enable){if(n(i.target).hasClass("e-kanbantooltip"))return;if(e=this.element.find(".e-kanbantooltip"),o=t.isNullOrUndefined(this.model.tooltipSettings.template),o&&!(n(i.target).hasClass("e-tag")||n(i.target).hasClass("e-text")||n(i.target).closest(".e-primarykey").length>0))return;o?e.html(n(i.target).text()).removeClass("e-tooltiptemplate"):(e.addClass("e-tooltiptemplate"),h=t.DataManager(this._currentJsonData),s=h.executeLocal((new t.Query).where(this.model.fields.primaryKey,t.FilterOperators.equal,n(i.currentTarget).attr("id"))),e.html(n(this.model.tooltipSettings.template).render(s[0])));var u=i.pageX,f=i.pageY,r=n(this.element.find(".e-kanbantooltip"));u=u+r.width()<this.element.width()?u:u-r.width();f=f+r.height()<this.element.height()?f:f-r.height();r.css("left",u);r.css("top",f);this.model.enableRTL==!0&&r.addClass("e-rtl");this.element.find(".e-kanbantooltip").show()}},_hideToolTip:function(){this.model.tooltipSettings.enable&&this.element.find(".e-kanbantooltip").hide()},_refreshStackedHeader:function(){for(var u,i=this.model.stackedHeaderRows,r=this.element.find(".e-stackedHeaderRow"),t=0;t<i.length;t++)u=this._createStackedRow(i[t],!1),r.length>0&&r.remove(),n(this.getHeaderTable().find(".e-columnheader").before(u));this.model.allowScrolling&&this._refreshScroller({requestType:"refresh"})},showColumns:function(n){var t,i="_visibleColumns";t=typeof n=="string"?this.getColumnByHeaderText(n):this.getColumnByHeaderText(n[0]);this._showExpandColumns(t,n,"_hiddenColumns",i);this._showhide(this[i],"show");this._renderLimit();this._totalCount();this.model.stackedHeaderRows.length>0&&this._refreshStackedHeader()},_hideCollapseColumns:function(i,r,u,f){var e,o;if(!t.isNullOrUndefined(i))if(n.isArray(r))for(e=0;e<r.length;e++)o=n.inArray(r[e],this[f]),o!=-1?(this[u].push(r[e]),this[f].splice(o,1)):o!=-1||n.inArray(r[e],this[u])!=-1||t.isNullOrUndefined(this.getColumnByHeaderText(r[e]))||(this[u].push(this.getColumnByHeaderText(r[e]).key)&&this[u].push(this.getColumnByHeaderText(r[e]).key),this[f].splice(n.inArray(this.getColumnByHeaderText(r[e]).key,this[f]),1)&&this[f].splice(n.inArray(r[e],this[f]),1));else o=n.inArray(r,this[f]),o!=-1?(this[u].push(r),this[f].splice(o,1)):o!=-1||f!=f||n.inArray(r,this[u])!=-1||t.isNullOrUndefined(this.getColumnByHeaderText(r))||(this[u].push(this.getColumnByHeaderText(r).key)&&this[u].push(this.getColumnByHeaderText(r).key),this[f].splice(n.inArray(this.getColumnByHeaderText(r).key,this[f]),1)&&this[f].splice(n.inArray(r,this[f]),1))},hideColumns:function(t){for(var r,u=0,f,e="_hiddenColumns",i=0;i<this._visibleColumns.length;i++)r=n.inArray(this._collapsedColumns[i],this._visibleColumns),r!=-1&&u++;if(this._visibleColumns.length-1>u)f=typeof t=="string"?this.getColumnByHeaderText(t):this.getColumnByHeaderText(t[0]),this._hideCollapseColumns(f,t,e,"_visibleColumns"),this._showhide(this[e],"hide"),this.model.stackedHeaderRows.length>0&&this._refreshStackedHeader();else{if(this._visibleColumns.length==1)return;this._visibleColumns[0]==t?this._expandColumns(this._visibleColumns[1]):this._expandColumns(this._visibleColumns[0]);this.hideColumns(t)}this._renderLimit();this._totalCount();this._stackedHeadervisible()},_showhide:function(i,r){var u,p=0,c,o=this.model.columns,s,f,h;c=r==="show"?"_visibleColumns":"_hiddenColumns";var w=this.getHeaderTable().find("thead"),l=w.find("tr").not(".e-stackedHeaderRow").find(".e-headercell"),a=this.getHeaderTable().find("colgroup").find("col"),v,y=this.getContentTable().find("colgroup").find("col"),e=this._columnRows;for(u=0;u<o.length;u++)n.inArray(o[u].headerText,this[c])!=-1&&(o[u].visible=r==="show"?!0:!1,p++),v=this.getColumnByHeaderText(i[u]),s=n.inArray(v,this.model.columns),s!=-1&&(r=="show"?(l.eq(s).removeClass("e-hide"),a.eq(s).css("display","")):(l.eq(s).addClass("e-hide"),a.eq(s).css("display","none")));for(u=0;u<o.length;u++)for(f=0;f<e.length;f++)t.isNullOrUndefined(this.model.fields.swimlaneKey)||(n(e[f]).is(":visible")?e.eq(f).prev().find(".e-rowcell").attr("colspan",this.getVisibleColumnNames().length):(e.eq(f).prev().prev(".e-swimlanerow").find(".e-rowcell").attr("colspan",this.getVisibleColumnNames().length),o[u].visible?e.eq(f).prev(".e-collapsedrow").find("td.e-rowcell").eq(u).removeClass("e-hide"):e.eq(f).prev(".e-collapsedrow").find("td.e-rowcell").eq(u).addClass("e-hide"))),h=e.eq(f).find("td.e-rowcell[ej-mappingkey='"+this.model.columns[u].key+"']"),o[u].visible?(h.removeClass("e-hide"),y.eq(u).removeClass("e-hide")):(h.addClass("e-hide"),y.eq(u).addClass("e-hide"))},_expandCollapse:function(t,i){var f,p=0,a,h=this.model.columns,r,c,l,e;a=i==="expand"?"_expandedColumns":"_collapsedColumns";var w=this.getHeaderTable().find("thead"),o=w.find("tr").not(".e-stackedHeaderRow").find(".e-headercell"),s=this.getHeaderTable().find("colgroup").find("col"),v,u,y=this.getContentTable().find("colgroup").find("col");for(f=0;f<h.length;f++)if(n.inArray(h[f].headerText,this[a])!=-1&&(h[f].isCollapsed=i==="expand"?!1:!0,p++),v=this.getColumnByHeaderText(t[f]),r=n.inArray(v,this.model.columns),c=i=="expand"?!0:!1,r!=-1&&(c?s.eq(r).hasClass("e-shrinkcol")&&(o.eq(r).find(".e-headercelldiv").removeClass("e-hide"),o.eq(r).removeClass("e-shrinkcol"),s.eq(r).removeClass("e-shrinkcol"),y.eq(r).removeClass("e-shrinkcol"),o.eq(r).find(".e-clcollapse").addClass("e-clexpand").removeClass("e-clcollapse")):s.eq(r).hasClass("e-shrinkcol")||(o.eq(r).find(".e-headercelldiv").addClass("e-hide"),o.eq(r).addClass("e-shrinkcol"),s.eq(r).addClass("e-shrinkcol"),y.eq(r).addClass("e-shrinkcol"),o.eq(r).find(".e-clexpand").addClass("e-clcollapse").removeClass("e-clexpand"))),l=this.model.columns[f].isCollapsed,c){if(!l)for(e=0;e<this._columnRows.length;e++)if(u=this._columnRows.eq(e).find("td.e-rowcell[ej-mappingkey='"+this.model.columns[f].key+"']"),u.hasClass("e-shrink"))u.removeClass("e-shrink").find(".e-shrinkheader").addClass("e-hide").parent().find(".e-kanbancard").removeClass("e-hide"),u.find(".e-customaddbutton").removeClass("e-hide"),u.find(".e-limits").removeClass("e-hide"),u.find(".e-shrinkcount").text(this._columnCardcount(this.model.currentViewData,this.model.columns[f].key,this.model.fields.swimlaneKey?e:null));else break}else if(l)for(e=0;e<this._columnRows.length;e++)if(u=this._columnRows.eq(e).find("td.e-rowcell[ej-mappingkey='"+this.model.columns[f].key+"']"),u.hasClass("e-shrink"))break;else u.addClass("e-shrink").find(".e-shrinkheader").removeClass("e-hide").parent().find(".e-kanbancard").addClass("e-hide"),u.find(".e-customaddbutton").addClass("e-hide"),u.find(".e-limits").addClass("e-hide"),u.find(".e-shrinkcount").text(this._columnCardcount(this.model.currentViewData,this.model.columns[f].key,this.model.fields.swimlaneKey?e:null))},_showExpandColumns:function(i,r,u,f){var e,s,o;if(!t.isNullOrUndefined(i)){if(i!=null)if(n.isArray(r))for(e=0;e<r.length;e++)s=this.getColumnByHeaderText(r[e]),r[e]=s!=null?s.headerText:r[e];else r=i.headerText;if(n.isArray(r))for(e=0;e<r.length;e++)o=n.inArray(r[e],this[u]),o!=-1?(this[u].splice(o,1),this[f].push(r[e])):o!=-1||n.inArray(r[e],this[f])!=-1||t.isNullOrUndefined(this.getColumnByHeaderText(r[e]))||(this[f].push(this.getColumnByHeaderText(r[e]).key)&&this[f].push(r[e]),this[u].splice(n.inArray(this.getColumnByHeaderText(r[e]).key,this[u]),1)&&this[u].splice(n.inArray(r[e],this[u]),1));else o=n.inArray(r,this[u]),o!=-1?(this[u].splice(o,1),this[f].push(r)):o!=-1||n.inArray(r,this[f])!=-1||t.isNullOrUndefined(this.getColumnByHeaderText(r))||(this[f].push(this.getColumnByHeaderText(r).key)&&this[f].push(r),this[u].splice(n.inArray(this.getColumnByHeaderText(r).key,this[u]),1)&&this[u].splice(n.inArray(r,this[u]),1))}},_expandColumns:function(n){var t,i="_expandedColumns";t=typeof n=="string"?this.getColumnByHeaderText(n):this.getColumnByHeaderText(n[0]);this._showExpandColumns(t,n,"_collapsedColumns",i);this._expandCollapse(this[i],"expand");this.model.allowScrolling&&this._setWidthToColumns();this.model.stackedHeaderRows.length>0&&this._refreshStackedHeader()},_toggleField:function(t){var u,i,f=0;if(n.isArray(t)){for(i=0;i<t.length;i++)u=n.inArray(t[i],this._collapsedColumns),u!=-1&&f++;f==t.length?this._expandColumns(t):this._collapseColumns(t)}else n.inArray(t,this._collapsedColumns)!=-1?this._expandColumns(t):this._collapseColumns(t);if(this.model.allowScrolling){var s=this.getContentTable().children("colgroup").find("col"),e=this.getHeaderTable().children("colgroup").find("col"),o=this._originalWidth-this._collapsedColumns.length*50;for(i=0;i<e.length;i++){var h=(o/this._expandedColumns.length).toFixed(2),c=(o/(this.model.scrollSettings.buttonSize||18)/100).toFixed(2),r=h-c;this.model.columns[i].isCollapsed||(s.eq(i).css("width",r+"px"),e.eq(i).css("width",r+"px"),this.model.columns[i].width=r)}}this._refreshScroller({requestType:"refresh"})},_collapseColumns:function(t){for(var r,u,f="_collapsedColumns",e=0,i=0;i<t.length;i++)r=n.inArray(t[i],this._expandedColumns),r!=-1&&e++;this._expandedColumns.length==e||this.getVisibleColumnNames().length-this._collapsedColumns.length==1||this.model.columns.length-this._collapsedColumns.length==1?(this._expandColumns(this._collapsedColumns[0]),this._collapseColumns(t)):(u=typeof t=="string"?this.getColumnByHeaderText(t):this.getColumnByHeaderText(t[0]),this._hideCollapseColumns(u,t,f,"_expandedColumns"),this._expandCollapse(this[f],"collapse"),this.model.allowScrolling&&this._setWidthToColumns(),this.model.stackedHeaderRows.length>0&&this._refreshStackedHeader())},_onToolbarClick:function(t){var c=n(this.itemsContainer).closest(".e-kanban"),i=c.ejKanban("instance"),r=t.currentTarget,u=t.target,s,e,h,o,f;if((u.tagName=="INPUT"&&(t.keyCode==13||n(u).parent().next().hasClass("e-cancel"))&&(t.keyCode==13&&n(u).val()!=""?(this.searchCards(n(u).val()),f=this._searchBar.find(".e-toolbaricons"),f.removeClass("e-searchfind").addClass("e-cancel")):n(u).val().length==0&&(this.clearSearch(),f=this._searchBar.find(".e-toolbaricons"),f.removeClass("e-cancel").addClass("e-searchfind"))),t.event==undefined)||n(r).hasClass("e-quickfilter"))return!1;for(s=n(r).text(),e=0;e<i.model.filterSettings.length;e++)if(i.model.filterSettings[e].text==s)break;return(h=e==i.model.filterSettings.length?null:i.model.filterSettings[e],o={itemName:r.title,itemId:r.id,target:u,currentTarget:r,itemIndex:n(r).index(),toolbarData:t,itemText:s},i._trigger("toolbarClick",o))?!1:(o.itemId==this._id+"_search"?(o.target.nodeName=="A"&&(i.searchCards(n(o.currentTarget).find("input").val()),i.model.allowSearching&&i._searchBar!=null&&i.model.searchSettings.key.length!=0&&(f=i._searchBar.find(".e-toolbaricons"),n(u).is(i._searchBar.find(".e-searchfind"))?f.removeClass("e-searchfind").addClass("e-cancel"):n(u).is(i._searchBar.find(".e-cancel"))&&(f.removeClass("e-cancel").addClass("e-searchfind"),i.clearSearch()))),i._isWatermark||(i._searchInput.blur(function(){i._searchInput.val()||i._hiddenSpan.css("display","block")}),i._hiddenSpan.css("display","none"))):n(r).parent().hasClass("e-customtoolbar")||i._filterHandler(h,r),!1)},searchCards:function(i){var r={},u=n("#"+this._id+"_toolbarItems_search");u.find("input").val()!=i;u.find("input").val(i);r.requestType=t.Kanban.Actions.Search;r.keyValue=i;(i!=""||this.model.searchSettings.key!="")&&(this.model.searchSettings.key=i,u.find(".e-searchfind").length>0&&(this._initialData=this._currentJsonData),this._processBindings(r))},_filterHandler:function(i,r){var u={},f,e,o;for(u.requestType=t.Kanban.Actions.Filtering,u.currentFilterObject=[],u.filterCollection=this._filterCollection,u.currentFilterObject.push(i),this._initialData=this._currentJsonData,f=0;f<this.model.filterSettings.length;f++)if(this.model.filterSettings[f].text==u.currentFilterObject[0].text){e=this.model.filterSettings[f].query.queries[0].e;t.isNullOrUndefined(u.filterCollection[0])?(u.filterCollection.push(e),n(r).addClass("e-select")):n(r).hasClass("e-select")?(n(r).removeClass("e-select"),o=n.inArray(e,u.filterCollection),u.filterCollection.splice(o,1)):(n(r).addClass("e-select"),u.filterCollection.push(e));break}this._processBindings(u)},filterCards:function(n){var i={},n;i.requestType=t.Kanban.Actions.Filtering;i.filterCollection=this._filterCollection;n=n.queries[0].e;i.filterCollection.push(n);this._processBindings(i)},clearFilter:function(){if(this._filterCollection.length!=0){var n={};n.requestType=t.Kanban.Actions.Filtering;this._filterCollection=[];this.element.find(".e-kanbantoolbar .e-tooltxt").removeClass("e-select");this._processBindings(n)}},_initDataSource:function(){this._isLocalData=!(this._dataSource()instanceof t.DataManager)||this._dataSource().dataSource.offline;this._ensureDataSource();this._trigger("actionBegin");var n=this._dataSource().executeQuery(this.model.query);this.element.is(":visible")||this.element.ejWaitingPopup("hide");n.done(t.proxy(function(n){this.element.ejWaitingPopup("hide");this._currentJsonData=this.model.currentViewData=n.result;this._recordsCount=n.count==0&&n.result.length?n.result.length:n.count;this._initKanbanRender()},this))},_initScrolling:function(){(this.model.width||this.model.height)&&(this.model.allowScrolling=!0,this.model.width&&(this.model.scrollSettings.width=this.model.width),this.model.height&&(this.model.scrollSettings.height=this.model.height));this._originalScrollWidth=this.model.scrollSettings.width},_setResponsiveHeightWidth:function(){typeof this.model.scrollSettings.width=="string"?this._originalScrollWidth=this.element.width():this.model.scrollSettings.width>0&&(this._originalScrollWidth=this.model.scrollSettings.width);typeof this.model.scrollSettings.height=="string"?this._originalScrollHeight=this.getContent().height():this.model.scrollSettings.height>0&&(this._originalScrollHeight=this.model.scrollSettings.height);this.model.minWidth&&this.model.isResponsive&&(n(window).bind("resize",n.proxy(this._kanbanWindowResize,this)),this._kanbanWindowResize())},_renderResponsiveKanban:function(n,i,r,u,f){var e;n?(this.model.scrollSettings.width=t.isNullOrUndefined(this._originalScrollWidth)?Math.min(r,f):Math.min(this._originalScrollWidth,Math.min(r,f)),e=Math.min(u,i),e=t.isNullOrUndefined(this._originalScrollHeight)?e:Math.min(this._originalScrollHeight,u),this.model.scrollSettings.height=e,this._renderScroller()):(this.model.scrollSettings.width="100%",t.isNullOrUndefined(this._originalScrollWidth)||(this.model.scrollSettings.width=Math.min(this._originalScrollWidth,r)),e=this.element.outerHeight(),t.isNullOrUndefined(this._originalScrollHeight)||(e=Math.min(this._originalScrollHeight,u)),this.model.scrollSettings.height=e,this._renderScroller())},_kanbanWindowResize:function(){var i,r,t,u,f=this.element.find(".e-kanbantoolbar"),e;this.model.scrollSettings.width=this._originalScrollWidth;this.element.outerWidth("100%");this.getContentTable().width("100%");this.getHeaderTable().width("100%");i=this.element.outerWidth();r=n(window).width()-this.element.offset().left;t=n(window).height()-this.element.offset().top;f.length>0&&(t=t-(f.outerHeight()+25));u=this._headerContent.outerHeight()+this.getContentTable().height();e=this.model.minWidth>i||r<=i||t<=u;this._renderResponsiveKanban(e,u,i,t,r)},_renderScroller:function(){var r,u,f,e,i,o;this.model.scrollSettings||(this.model.scrollSettings={});typeof this._originalScrollWidth=="string"&&(this.element.css("width","auto"),r=this.element.width(),(this.model.scrollSettings.width=="auto"||this._originalScrollWidth=="auto")&&(this._originalScrollWidth="100%"),this.model.scrollSettings.width=r*(parseFloat(this._originalScrollWidth)/100));typeof this.model.scrollSettings.height=="string"&&(u=this.element.height(),this.model.scrollSettings.height=="auto"&&(this.model.scrollSettings.height="100%"),this.model.scrollSettings.height=u*(parseFloat(this.model.scrollSettings.height)/100));(this.model.scrollSettings.width||this.model.width)&&this.element.width(this.model.scrollSettings.width||this.model.width);f=this.model.scrollSettings.height!=0?this.model.scrollSettings.height-this.getHeaderTable().height()-(!t.isNullOrUndefined(this._filterToolBar)&&this._filterToolBar.height()):this.model.scrollSettings.height;e=this.getContent().attr("tabindex","0");this.element.addClass("e-kanbanscroll");e.ejScroller({enableRTL:this.model.enableRTL,height:f,width:this.model.scrollSettings.width,thumbStart:function(t){var i=n(t.originalEvent.target);return i.hasClass("e-kanbancard")||i.parents(".e-kanbancard").hasClass("e-kanbancard"),!1},scroll:n.proxy(this._freezeSwimlane,this)});this.getContent().ejScroller("isVScroll")?(this.element.find(".e-kanbanheader").addClass("e-scrollcss"),this.getHeaderContent().find("div").first().addClass("e-headercontent")):this.element.find(".e-kanbanheader").removeClass("e-scrollcss");(this.model.scrollSettings.width||this.model.width)&&this.element.width(this.model.scrollSettings.width||this.model.width);i=this.getContent().data("ejScroller");o=i&&i.isVScroll()?"addClass":"removeClass";this.getHeaderContent().find(".e-headercontent")[o]("e-hscrollcss");this._refreshHeaderScroller()},_freezeSwimlane:function(n){var v,c,f,e,l,r,i,o,y,s,a,h,u;(this._freezeSwimlaneRow=this.element.find(".e-freezeswimlanerow"),this.model.scrollSettings.allowFreezeSwimlane||this._freezeSwimlaneRow.remove(),this.model.scrollSettings.allowFreezeSwimlane&&!t.isNullOrUndefined(this.model.fields.swimlaneKey)&&(t.isNullOrUndefined(n.scrollLeft)||this._freezeSwimlaneRow.length!=0))&&(this._freezeSwimlaneRow.length<=0?(this._freezeSwimlaneRow=t.buildTag("div.e-freezeswimlanerow e-swimlanerow","<div><\/div>",{}),v=this._headerContent.offset().top+this._headerContent.height(),this._freezeSwimlaneRow.appendTo(this.element).css({top:v}),c=this._swimlaneRows.eq(0),this._freezeSwimlaneRow.children().append(c.find(".e-slkey,.e-slcount").clone()),this._freezeSwimlaneRow.width(this._headerContent.width()-1).height(c.height()),this._freezeSlOrder=0,f=t.buildTag("table.e-table e-freeze-table","",{},{cellspacing:"0.25px"}),f.append(this.getContentTable().find("colgroup").clone()),e=t.buildTag("tbody"),f.append(e),e.append(this.getContentTable().find(".e-columnrow").eq(0).clone().removeClass("e-columnrow").addClass("e-collapsedrow")),l=e.find("td"),l.removeClass("e-droppable").removeAttr("ej-mappingkey").height(0),l.children().remove(),this._freezeSwimlaneRow.append(f)):(r=this.getContent().offset().top+this._freezeSwimlaneRow.height(),a=this._swimlaneRows.eq(this._freezeSlOrder),s=this._swimlaneRows.eq(this._freezeSlOrder+1),h=this._swimlaneRows.eq(this._freezeSlOrder-1),i=s.offset().top+s.height(),o=a.offset().top+a.height(),y=h.offset().top+h.height(),u=this.element.find(".e-freezeswimlanerow >div"),this._freezeScrollTop>n.scrollTop&&(o=o,r>=i&&(i=r+1)),this._freezeScrollTop<n.scrollTop&&(i=i),(n.source=="wheel"||n.source=="button")&&this._freezeScrollTop<n.scrollTop&&(i=i-n.model.scrollOneStepBy),r>=i?(u.children().remove(),u.append(s.find(".e-slkey,.e-slcount").clone()),++this._freezeSlOrder):r<o&&r>y&&this._freezeSlOrder>0&&(u.children().remove(),u.append(h.find(".e-slkey,.e-slcount").clone()),--this._freezeSlOrder),n.scrollTop==0&&this._freezeSwimlaneRow.remove(),t.isNullOrUndefined(n.scrollLeft)||(u.css({left:-n.scrollLeft}),this._freezeSwimlaneRow.find("table").css({left:-n.scrollLeft}))),this._freezeScrollTop=n.scrollTop)},_refreshHeaderScroller:function(){this.getContent().find(".e-content").scroll(t.proxy(function(t){this.getHeaderContent().find("div").first().scrollLeft(n(t.currentTarget).scrollLeft())},this));this.element.find(".e-kanbanheader").find(".e-headercontent").scroll(t.proxy(function(t){var i=n(t.currentTarget);this.getContent().find(".e-content").first().scrollLeft(i.scrollLeft())},this))},_setWidthToColumns:function(){for(var f=this.getContentTable().children("colgroup").find("col"),i=this.getHeaderTable().children("colgroup").find("col"),r=this._originalWidth-this._collapsedColumns.length*50,n=0;n<i.length;n++)if(t.isNullOrUndefined(this._columnsWidthCollection[n])||this.model.allowToggleColumn){if(this.model.allowScrolling){var o=(r/this._expandedColumns.length).toFixed(2),e=(r/(this.model.scrollSettings.buttonSize||18)/100).toFixed(2),u=o-e;this.model.columns[n].isCollapsed||(f.eq(n).css("width",u+"px"),i.eq(n).css("width",u+"px"),this.model.columns[n].width=u);this._columnsWidthCollection[n]=parseFloat((r/this.model.columns.length).toFixed(2)-e)}}else f.eq(n).width(this._columnsWidthCollection[n]),i.eq(n).width(this._columnsWidthCollection[n])},_addLastRow:function(){var u=this.getContentTable().find("tr:last").find("td"),r=0,i;if(this.model.allowScrolling&&!t.isNullOrUndefined(this.model.dataSource)&&!t.isNullOrUndefined(this._kanbanRows)){for(i=0;i<this._kanbanRows.length;i++)r+=n(this._kanbanRows[i]).height();r<this.getContent().height()-1&&u.addClass("e-lastrowcell")}},_checkDataBinding:function(){var i,r;(this.model.columns.length||(this._dataSource()!=null&&this._dataSource().length||this._dataSource()instanceof t.DataManager)&&(!(this._dataSource()instanceof t.DataManager)||this._dataManager.dataSource.url!=undefined||this._dataSource().dataSource.json.length))&&(t.isNullOrUndefined(this.model.keyField)||this._addColumnFilters(),this.initialRender=!0,this.model.cssClass!=null&&this.element.addClass(this.model.cssClass),(this.model.filterSettings.length>0||this.model.allowSearching||this.model.customToolbarItems)&&this.element.append(this._renderToolBar()),i=this.model.columns,i&&i.length&&(this.element.append(this._renderHeader()),this._stackedHeadervisible()),n.isFunction(n.fn.ejWaitingPopup)&&(this.element.ejWaitingPopup({showOnInit:!1}),n("#"+this._id+"_WaitingPopup").addClass("e-kanbanwaitingpopup")),this.model.contextMenuSettings.enable&&this.element.append(this._renderContext()),this._dataSource()instanceof t.DataManager?(this.element.ejWaitingPopup("show"),this._dataSource().ready!=undefined?(r=this,this._dataSource().ready.done(function(n){r._initDataSource();r.model.dataSource=t.DataManager(n.result)})):(this.element.ejWaitingPopup("show"),this._initDataSource())):(this._trigger("actionBegin"),this._ensureDataSource(),this._initKanbanRender(),this._enableKanbanRTL()))},_ensureDataSource:function(i){var r,o,f,u,c,p,l,s,a,e,v,h,y;if(this._dataSource()==null&&!(this._dataSource()instanceof t.DataManager)){if(t.isNullOrUndefined(i)||i.requestType!="add")return;this.dataSource([])}if(this.model.query.requiresCount(),r=this.model.query,e=r.clone(),this._dataSource()instanceof t.DataManager||(this._currentJsonData=this.model.currentViewData=this._dataSource()),this.model.filterSettings.length&&!t.isNullOrUndefined(i)&&i.requestType==t.Kanban.Actions.Filtering||!t.isNullOrUndefined(i)&&i.requestType==t.Kanban.Actions.Search||this.model.searchSettings.key.length){for(r.queries=r.queries.slice(r.queries.length),this.model.searchSettings.key.length!=0&&(f=this.model.searchSettings,f.fields.length==0&&(t.isNullOrUndefined(this.model.fields.content)||f.fields.push(this.model.fields.content),t.isNullOrUndefined(this.model.fields.swimlaneKey)||f.fields.push(this.model.fields.swimlaneKey),t.isNullOrUndefined(this.model.fields.primaryKey)||f.fields.push(this.model.fields.primaryKey),t.isNullOrUndefined(this.model.fields.title)||f.fields.push(this.model.fields.title)),r.search(f.key,f.fields,f.operator||"contains",f.ignoreCase)),u=0;u<this._filterCollection.length;u++)o=o!=undefined?o.and(this._filterCollection[u]):this._filterCollection[u];for(r.where(t.Predicate.or(this.keyPredicates)),u=0;u<r.queries.length;u++)r.queries[u].fn=="onWhere"&&o&&(r.queries[u].e=r.queries[u].e.and(o));this._isLocalData&&(this._filteredRecords=this._dataManager.executeLocal(r).result,this._filteredRecordsCount=this._filteredRecords.length);this._isLocalData&&this.model.filterSettings.length==0&&(!t.isNullOrUndefined(this._filteredRecordsCount)||this._filteredRecordsCount>0)&&(this._filteredRecordsCount=null,this._filteredRecords=[])}this._isLocalData&&(this.model.editSettings.allowEditing||this.model.editSettings.allowAdding)&&(!t.isNullOrUndefined(this._cModifiedData)||!t.isNullOrUndefined(this._cAddedRecord))&&(t.isNullOrUndefined(this._cAddedRecord)?(r=r.where(this.model.fields.primaryKey,t.FilterOperators.equal,i.primaryKeyValue),c=this._dataManager.executeLocal(r),p=this._dataSource()instanceof t.DataManager?n.extend(this._dataSource().dataSource.json[n.inArray(c.result[0],this._dataSource().dataSource.json)],this._cModifiedData):n.extend(this._dataSource()[n.inArray(c.result[0],this._dataSource())],this._cModifiedData),i.data=p):(l=this._cAddedRecord,this._cAddedRecord=null,this._dataSource()instanceof t.DataManager?this._dataSource().dataSource.json.push(l):this._dataSource(undefined,!0).splice(this._dataSource().length,0,l)),r.queries=e.queries);i&&i.requestType==t.Kanban.Actions.Delete&&!t.isNullOrUndefined(this._cDeleteData)&&this._isLocalData&&(this._dataSource()instanceof t.DataManager?(s=n.inArray(this._cDeleteData[0],this._dataSource().dataSource.json),this._dataSource().dataSource.json.splice(s,1)):(s=n.inArray(this._cDeleteData[0],this._dataSource()),this._dataSource(undefined,!0).splice(s,1)));this._cloneQuery=r.clone();this._isLocalData&&(!t.isNullOrUndefined(i)&&(i.requestType=="addcolumn"||i.requestType=="refresh")&&this._filterCollection.length<=0&&this._searchInput.val().length<=0?(e=r.clone(),e.queries=[],e.where(t.Predicate.or(this.keyPredicates)),a=e):a=r,v=this._dataManager.dataSource.json,h=this._dataSource().dataSource,!t.isNullOrUndefined(h)&&this._dataSource()instanceof t.DataManager&&(this._dataManager.dataSource.json=v!=h.json?h.json:v),y=this._dataManager.executeLocal(a),this.model.currentViewData=this._currentJsonData=y.result,this._recordsCount=y.count)},clearSearch:function(){this.element.find(".e-kanbantoolbar #"+this._id+"_toolbarItems_search").val("");this.searchCards("");n.extend(this.model.searchSettings,this.defaults.searchSettings)},_addColumnFilters:function(){for(var r=this.model.columns,n=[],u=this.model.query,i=0;i<r.length;i++)t.isNullOrUndefined(r[i].key)||n.push(new t.Predicate(this.model.keyField,"equal",r[i].key,!0));n.length>0&&u.where(t.Predicate.or(n));this.keyPredicates=n},sendDataRenderingRequest:function(n){this._templateRefresh&&(this.refreshTemplate(),this._templateRefresh=!1);var i=this.model.query,r=i.clone();if(this.model.currentViewData!=null&&this.model.currentViewData.length){switch(n.requestType){case t.Kanban.Actions.Save:this._updateGroup(n.primaryKeyValue,n.data);case t.Kanban.Actions.Delete:case t.Kanban.Actions.Refresh:case t.Kanban.Actions.Search:case t.Kanban.Actions.Filtering:case t.Kanban.Actions.Cancel:this.getContentTable().find("colgroup").first().replaceWith(this._getMetaColGroup());t.isNullOrUndefined(this.model.fields.swimlaneKey)||(i=i.group(this.model.fields.swimlaneKey),this.model.currentViewData.GROUPGUID||(this.model.currentViewData=new t.DataManager(this.model.currentViewData).executeLocal(i).result));this._renderAllCard();this._enableSwimlaneCount=!0;this._swimlaneLimit(n);this._eventBindings();break;case t.Kanban.Actions.BeginEdit:case t.Kanban.Actions.Add:this._editAdd(n)}i.queries=r.queries}else this.getContentTable().find("tbody").empty().first().append(this._getEmptyTbody());this._renderComplete(n);(t.Kanban.Actions.BeginEdit==n.requestType||t.Kanban.Actions.Add==n.requestType)&&this.model.editSettings.editMode==t.Kanban.EditMode.Dialog&&this._refreshEditForm(n);this._newData=null},_eventBindings:function(){var r,i,f,u,t,e;if(this._kanbanRows=this.getContentTable().get(0).rows,r=n(this._kanbanRows).not(".e-swimlanerow"),this._currentJsonData.length!=0&&this.model.queryCellInfo!=null)for(i=0;i<r.length;i++)for(f=r[i],u=this.model.columns,t=0;t<u.length;t++)e=n(f).find(".e-rowcell")[t],this._cellEventTrigger(e,u[t])},_cellEventTrigger:function(t,i){for(var u=n(t).find(".e-kanbancard"),r=0;r<u.length;r++){var f=u[r].id,e=this._getKanbanCardData(this._currentJsonData,f),o={card:u[r],cell:t,column:i,data:e[0]};this._trigger("queryCellInfo",o)}},_checkSkipAction:function(n){switch(n.requestType){case t.Kanban.Actions.Save:case t.Kanban.Actions.Delete:return!0}return!1},_processBindings:function(i){if(i.primaryKey=this.model.fields.primaryKey,!this._checkSkipAction(i)&&this._trigger("actionBegin",i))return!0;if(this._ensureDataSource(i),this._editForm=this.element.find(".kanbanform"),i.requestType=="beginedit"||this._editForm.length==0||(this._editForm.length>1&&i.requestType=="save"&&i.action=="edit"&&(this._editForm=this._editForm[0]),n(this._editForm).find("select.e-dropdownlist").ejDropDownList("destroy"),n(this._editForm).find("textarea.e-rte").ejRTE("destroy"),n(this._editForm).find(".e-datepicker").ejDatePicker("destroy"),n(this._editForm).find(".e-datetimepicker").ejDateTimePicker("destroy"),n(this._editForm).find(".e-numerictextbox").ejNumericTextbox("destroy"),n(this._editForm).addClass("e-formdestroy")),i&&i.requestType==t.Kanban.Actions.Delete&&i.div.remove(),this._dataSource()instanceof t.DataManager&&i.requestType!=t.Kanban.Actions.BeginEdit&&i.requestType!=t.Kanban.Actions.Cancel&&i.requestType!=t.Kanban.Actions.Add){this.element.ejWaitingPopup("show");var u=this._queryPromise=this._dataSource().executeQuery(this.model.query),r=this;r._dataSource().ready?r._dataSource().ready.done(function(){r._processDataRequest(r,i,u)}):r._processDataRequest(r,i,u)}else this.sendDataRenderingRequest(i)},_processDataRequest:function(n,i,r){r.done(t.proxy(function(t){n.element.ejWaitingPopup("hide");n._currentJsonData=n.model.currentViewData=t.result==null?[]:t.result;n._processData(t,i)}));r.fail(t.proxy(function(t){n.element.ejWaitingPopup("hide");i.error=t.error;t=[];n.model.currentViewData=[];n._processData(t,i);n._trigger("actionFailure",i)}))},_processData:function(n,i){t.isNullOrUndefined(this.model.filterSettings)||(i.requestType=="filtering"||this.model.filterSettings.length>0&&i.requestType==t.Kanban.Actions.Refresh)&&(this._filteredRecordsCount=n.count);this.sendDataRenderingRequest(i)},_renderComplete:function(i){i.requestType!="beginedit"&&this._setWidthToColumns();(i.requestType==t.Kanban.Actions.Save||i.requestType==t.Kanban.Actions.Cancel)&&(this._isAddNew=!1);(t.Kanban.Actions.Delete==i.requestType||t.Kanban.Actions.Save==i.requestType)&&this._editEventTrigger(i);this._tableBEle=this.getContentTable().get(0);this._kanbanRows=this._tableBEle.rows;this._columnRows=n(this._kanbanRows).not(".e-swimlanerow");this.model.allowScrolling&&!this.initialRender&&this.getContentTable().find("tr:last").find("td").addClass("e-lastrowcell");this._trigger("actionComplete",i);!this.initialRender&&this.model.allowScrolling&&(i.requestType==t.Kanban.Actions.Add||i.requestType==t.Kanban.Actions.Cancel||i.requestType==t.Kanban.Actions.Save||i.requestType==t.Kanban.Actions.Delete||i.requestType==t.Kanban.Actions.Filtering||i.requestType==t.Kanban.Actions.Refresh)&&this._refreshScroller(i);(i.requestType==t.Kanban.Actions.Cancel||i.requestType==t.Kanban.Actions.Delete)&&(this._renderLimit(),this._totalCount());i.requestType==t.Kanban.Actions.Filtering&&this._filterLimitCard(i);this.model.allowDragAndDrop&&t.kanbanFeatures.dragAndDrop&&this._addDragableClass()},_totalCount:function(){for(var i,t=0;t<this.model.columns.length;t++)if(i=this.model.columns[t],this.model.enableTotalCount){var r=this.getHeaderContent().find("span.e-totalcount")[t],u=i.key,f=n(n(this.element.find(".e-columnrow")).find("td[ej-mappingkey="+u+"]")),e=f.find(".e-kanbancard").length;n(r).text(e)}},_moveCurrentCard:function(i,r,u){var c,f,o,e,h,l,k,a,p,w,d,v,y,b,s;if(f=this.selectedRowCellIndexes[0],v=f.cardIndex,c=f.cellIndex[f.cellIndex.length-1],r=="down"||r=="up"){if(d=n(this._columnRows[i]).find("td.e-rowcell").eq(c),h=d.find(".e-kanbancard"),e=n(h).index(d.find(".e-cardselection")),a=h.length,r=="down")if(t.isNullOrUndefined(this.model.fields.swimlaneKey)?e=this.model.selectionType==t.Kanban.SelectionType.Multiple?v[f.cellIndex.length-1][v[f.cellIndex.length-1].length-1]:v[f.cellIndex.length-1]:(u.shiftKey||u.ctrlKey)&&this.model.selectionType==t.Kanban.SelectionType.Multiple&&(e=v[f.cellIndex.length-1][v[f.cellIndex.length-1].length-1]),e==a-1||a==0){if(i==this._columnRows.length-1)return;if((u.shiftKey||u.ctrlKey)&&this.model.selectionType!=t.Kanban.SelectionType.Single)return;this._moveCurrentCard(i+1,r,u)}else h.eq(e+1).hasClass("e-cardselection")?this._cardSelection([[i,[c],[e]]],n(h[e]),u):this._cardSelection([[i,[c],[e+1]]],n(h[e+1]),u);else if(r=="up")if(t.isNullOrUndefined(this.model.fields.swimlaneKey)?e=this.model.selectionType==t.Kanban.SelectionType.Multiple?f.cardIndex[f.cellIndex.length-1][f.cardIndex[f.cellIndex.length-1].length-1]:f.cardIndex[f.cellIndex.length-1]:(u.shiftKey||u.ctrlKey)&&this.model.selectionType==t.Kanban.SelectionType.Multiple&&(e=f.cardIndex[f.cellIndex.length-1][f.cardIndex[f.cellIndex.length-1].length-1]),a==0||e==0){if(i==0)return;if((u.shiftKey||u.ctrlKey)&&this.model.selectionType!=t.Kanban.SelectionType.Single)return;this._moveCurrentCard(i-1,r,u)}else h.eq(e-1).hasClass("e-cardselection")?this._cardSelection([[i,[c],[e]]],n(h[e]),u):e!=-1?this._cardSelection([[i,[c],[e-1]]],n(h[e-1]),u):this._cardSelection([[i,[c],[a-1]]],n(h[a-1]),u);(u.shiftKey||u.ctrlKey)&&!t.Kanban.SelectionType.Single||this.element.find(".e-cardselection").closest("tr.e-columnrow:visible").length==0&&this.toggleSwimlane(n(this._columnRows[this.selectedRowCellIndexes[0].rowIndex]).prev().prev(".e-swimlanerow").find(".e-slcollapse"))}else if(k=n(this._columnRows[f.rowIndex]),l=k.find("td.e-rowcell"),h=l.eq(i).find(".e-kanbancard"),o=l.eq(i).find(".e-kanbancard"),p=l.eq(i+1),w=l.eq(i-1),y=this.element.find(".e-kanbancard"),b=this.element.find(".e-cardselection"),w.is(":visible")&&p.is(":visible")||t.isNullOrUndefined(this.model.fields.swimlaneKey)||this.element.find(".e-cardselection").closest("tr.e-columnrow:visible").length==0&&this.toggleSwimlane(n(this._columnRows[this.selectedRowCellIndexes[0].rowIndex]).prev().prev(".e-swimlanerow").find(".e-slcollapse")),e=(u.shiftKey||u.ctrlKey)&&this.model.selectionType==t.Kanban.SelectionType.Multiple?f.cardIndex[f.cellIndex.length-1][f.cardIndex[f.cellIndex.length-1].length-1]:this.model.selectionType==t.Kanban.SelectionType.Single?f.cardIndex[0]:f.cardIndex[0][0],r=="right"){if(s=y.eq(y.index(b)+1),i==l.length-1){s.length>0&&(!u.shiftKey&&!u.ctrlKey||this.model.selectionType==t.Kanban.SelectionType.Single)&&!t.isNullOrUndefined(this.model.fields.swimlaneKey)&&(this._cardSelection([[this._columnRows.index(s.closest("tr.e-columnrow")),[s.closest("tr.e-columnrow").find("td.e-rowcell").index(s.closest("td.e-rowcell"))],[0]]],s,u),this.element.find(".e-cardselection").closest("tr:visible").length==0&&this.toggleSwimlane(n(this._columnRows[this.selectedRowCellIndexes[0].rowIndex]).prev().prev(".e-swimlanerow").find(".e-slcollapse")));return}p.find(".e-kanbancard:visible").length>0?(o=p.find(".e-kanbancard"),o.eq(e).length>0?this._cardSelection([[f.rowIndex,[i+1],[e]]],n(o[e]),u):this._cardSelection([[f.rowIndex,[i+1],[o.length-1]]],n(o[o.length-1]),u),(u.shiftKey||u.ctrlKey)&&this.model.selectionType!=t.Kanban.SelectionType.Single||t.isNullOrUndefined(this.model.fields.swimlaneKey)||this.element.find(".e-cardselection").closest("tr.e-columnrow:visible").length==0&&this.toggleSwimlane(n(this._columnRows[this.selectedRowCellIndexes[0].rowIndex]).prev().prev(".e-swimlanerow").find(".e-slcollapse"))):this._moveCurrentCard(i+1,r,u)}else if(r=="left"){if(y.index(b)!=0&&(s=y.eq(y.index(b)-1)),i==0){if(!u.shiftKey&&!u.ctrlKey&&!t.isNullOrUndefined(this.model.fields.swimlaneKey)){if(this.toggleSwimlane(n(k).prev().find(".e-slexpand")),t.isNullOrUndefined(s))return;(s.length>0&&!u.shiftKey&&!u.ctrlKey||this.model.selectionType==t.Kanban.SelectionType.Single)&&(this._cardSelection([[this._columnRows.index(s.closest("tr.e-columnrow")),[s.closest("tr.e-columnrow").find("td.e-rowcell").index(s.closest("td.e-rowcell"))],[0]]],s,u),this.element.find(".e-cardselection").closest("tr.e-columnrow:visible").length==0&&this.toggleSwimlane(n(this._columnRows[this.selectedRowCellIndexes[0].rowIndex]).prev().prev(".e-swimlanerow").find(".e-slcollapse")))}return}w.find(".e-kanbancard:visible").length>0?(o=w.find(".e-kanbancard"),o.eq(e).length>0?this._cardSelection([[f.rowIndex,[i-1],[e]]],n(o[e]),u):this._cardSelection([[f.rowIndex,[i-1],[o.length-1]]],n(o[o.length-1]),u),(u.shiftKey||u.ctrlKey)&&this.model.selectionType!=t.Kanban.SelectionType.Single||t.isNullOrUndefined(this.model.fields.swimlaneKey)||this.element.find(".e-cardselection").closest("tr.e-columnrow:visible").length==0&&this.toggleSwimlane(n(this._columnRows[this.selectedRowCellIndexes[0].rowIndex]).prev().prev(".e-swimlanerow").find(".e-slexpand"))):this._moveCurrentCard(i-1,r,u)}},_keyPressed:function(i,r,u){var f,h,e,c,l,o,s;f=this.element.find(".e-cardselection");h=this.element.find(".e-kanbancard:visible");e=this.selectedRowCellIndexes[0];u.shiftKey=!1;u.ctrlKey=!1;l=!t.isNullOrUndefined(this.model.fields.swimlaneKey);switch(i){case"editCard":f.length>0&&this.model.editSettings.allowEditing&&(c=e.cellIndex,f=this._columnRows.eq(e.rowIndex).find("td.e-rowcell").eq(c[c.length-1]).find(".e-kanbancard").eq(e.cardIndex[c.length-1]),this.startEdit(f));break;case"insertCard":this.model.editSettings.allowAdding&&this.addCard();break;case"swimlaneExpandAll":this.expandAll();break;case"swimlaneCollapseAll":this.collapseAll();break;case"downArrow":f.length>0&&document.activeElement.id==this._id&&this._moveCurrentCard(e.rowIndex,"down",u);break;case"upArrow":f.length>0&&document.activeElement.id==this._id&&this._moveCurrentCard(e.rowIndex,"up",u);break;case"leftArrow":f.length>0&&document.activeElement.id==this._id&&this._moveCurrentCard(e.cellIndex[e.cellIndex.length-1],"left",u);break;case"rightArrow":f.length>0&&document.activeElement.id==this._id&&this._moveCurrentCard(e.cellIndex[e.cellIndex.length-1],"right",u);break;case"multiSelectionByDownArrow":u.ctrlKey=!0;f.length>0&&this._moveCurrentCard(e.rowIndex,"down",u);break;case"multiSelectionByUpArrow":u.ctrlKey=!0;f.length>0&&this._moveCurrentCard(e.rowIndex,"up",u);break;case"multiSelectionByRightArrow":u.shiftKey=!0;f.length>0&&this._moveCurrentCard(e.cellIndex[e.cellIndex.length-1],"right",u);break;case"multiSelectionByLeftArrow":u.shiftKey=!0;f.length>0&&this._moveCurrentCard(e.cellIndex[e.cellIndex.length-1],"left",u);break;case"firstCardSelection":this.model.allowSelection&&(this.clearSelection(),h.eq(0).addClass("e-cardselection"),f=this.element.find(".e-cardselection"),o=n(this._columnRows).find(".e-cardselection").index(),s=n(this._columnRows).find(".e-cardselection").parent().children().eq(0).hasClass("e-limits")?o-1:o,this.model.selectionType==t.Kanban.SelectionType.Multiple?this.selectedRowCellIndexes.push({cardIndex:[[s]],cellIndex:[f.parent().index()],rowIndex:n(this._columnRows).index(f.parents(".e-columnrow"))}):this.selectedRowCellIndexes.push({cardIndex:[s],cellIndex:[f.parent().index()],rowIndex:n(this._columnRows).index(f.parents(".e-columnrow"))}));break;case"lastCardSelection":this.model.allowSelection&&(this.clearSelection(),h.eq(h.length-1).addClass("e-cardselection"),f=this.element.find(".e-cardselection"),o=n(this._columnRows).find(".e-cardselection").index(),s=n(this._columnRows).find(".e-cardselection").parent().children().eq(0).hasClass("e-limits")?o-1:o,this.model.selectionType==t.Kanban.SelectionType.Multiple?this.selectedRowCellIndexes.push({cardIndex:[[s]],cellIndex:[f.parent().index()],rowIndex:n(this._columnRows).index(f.parents(".e-columnrow"))}):this.selectedRowCellIndexes.push({cardIndex:[s],cellIndex:[f.parent().index()],rowIndex:n(this._columnRows).index(f.parents(".e-columnrow"))}));break;case"cancelRequest":n("#"+this._id+"_dialogEdit:visible").length>0?this.cancelEdit():f.length>0&&this.clearSelection();break;case"saveRequest":n("#"+this._id+"_dialogEdit:visible").length>0&&this.endEdit();break;case"deleteCard":f.length>0&&!n("#"+this._id+"_dialogEdit:visible").length>0&&!t.isNullOrUndefined(this.model.fields.primaryKey)&&this.deleteCard(f.attr("id"));break;case"selectedSwimlaneExpand":f.length>0&&l&&(f.is(":visible")||this.toggleSwimlane(n(this._columnRows[this.selectedRowCellIndexes[0].rowIndex]).prev().prev(".e-swimlanerow").find(".e-slexpandcollapse")));break;case"selectedSwimlaneCollapse":f.length>0&&l&&f.is(":visible")&&this.toggleSwimlane(n(this._columnRows[this.selectedRowCellIndexes[0].rowIndex]).prev().find(".e-slexpandcollapse"));break;case"selectedColumnCollapse":f.length>0&&this._toggleField(this.model.columns[this.selectedRowCellIndexes[0].cellIndex[0]].headerText);break;case"selectedColumnExpand":this._collapsedColumns.length!=0&&this._toggleField(this._collapsedColumns[this._collapsedColumns.length-1]);break;case"focus":this.element.find(".e-cardselection").focus()}},_editEventTrigger:function(n){if(n.requestType==t.Kanban.Actions.Save||n.requestType==t.Kanban.Actions.Delete){var i={data:n.data,action:n.action!==undefined?n.action:n.requestType};this._trigger("end"+i.action.charAt(0).toUpperCase()+i.action.slice(1),i)}},_createTemplate:function(t,i){var r=document.createElement("script");return r.id=this._id+i+"_Template",r.type="text/x-jsrender",r.text=t,n("body").append(r),r},_addInitTemplate:function(){var i=this,r={},f=!t.isNullOrUndefined(i.model.keyField),e=t.browserInfo().name=="msie"&&parseInt(t.browserInfo().version,10)==8,o=this.model.allowToggleColumn,u=!t.isNullOrUndefined(i.model.fields.swimlaneKey);this._slTemplate="";r[i._id+"Object"]=this;r["_"+i._id+"columnKeys"]=this._getColumnKeyItems;r["_"+i._id+"tagItems"]=this._gettagItems;r["_"+i._id+"colorMaps"]=this._getColorMaps;r["_"+i._id+"getId"]=this._removeIdSymbols;r["_"+i._id+"getData"]=this._columnData;r["_"+i._id+"getCardCount"]=this._columnCardcount;r["_"+i._id+"getStatus"]=this._columnStatus;n.views.helpers(r);u&&(this._slTemplate+="{{for dataSource ~columns=columns ~ds=dataSource}}",this._slTemplate+="<tr id='{{: ~_"+i._id+"getId(key)}}' class='e-swimlanerow' role='kanbanrow'><td class='e-rowcell' role='kanbancell'  colspan='"+i.getVisibleColumnNames().length+"'><div class='e-slexpandcollapse'><div class='e-icon e-slexpand'><\/div><\/div><div class='e-slkey'>{{:key}}<\/div>{{if "+this.model.swimlaneSettings.showCount+"}}<div class='e-slcount'>"+i.localizedLabels.SwimlaneCaptionFormat+"<\/div>{{/if}}<\/td><\/tr>");this._slTemplate+="<tr class='e-columnrow' role='kanbanrow'>";this._slTemplate+=u?"{{for ~columns ~items=#data.items}}":"{{for columns}}";this._slTemplate+="<td ej-mappingkey='{{:key}}' class='e-rowcell {{if !#data.visible}}  e-hide {{/if}}{{if (#data.isCollapsed && "+o+")}}e-shrink{{/if}}'role='kanbancell'>{{if "+f+"}}{{for ~_"+i._id+"columnKeys('"+i._id+"Object')}}";this._slTemplate+=this._cardCustomization()+"{{/for}}{{/if}}{{if "+this.model.allowToggleColumn+"}}<div class='e-shrinkheader{{if "+e+"}} IE{{/if}}{{if !#data.isCollapsed}}  e-hide {{/if}}'>{{:headerText}}<div class='e-shrinklabel'>[<div class='e-shrinkcount'>{{:~_"+i._id+"getCardCount(~root.dataSource,key,#parent.parent.index) }}<\/div>]<\/div><\/div>{{/if}}{{if "+this.model.editSettings.allowAdding+"}}{{if #data.showAddButton}} <div class='e-customaddbutton{{if #data.isCollapsed}}  e-hide {{/if}}'><div class='e-columnadd e-icon'><\/div><\/div>{{/if}}{{/if}}<\/td>{{/for}}<\/tr>";u&&(this._slTemplate+="{{/for}}");this.templates[this._id+"_JSONTemplate"]=n.templates(this._createTemplate(this._slTemplate,"_swinlaneContent"));this.templates[this._id+"_cardTemplate"]=n.templates(this._createTemplate(this._cardTemplate,"_cardTemplate"));n.templates(this.templates)},_cardCustomization:function(){var r=this,f=this.model.allowToggleColumn,u=this.model.cardSettings.template?!0:!1,e=this.model.fields.imageUrl?!0:!1,i=this.model.fields,h=!t.isNullOrUndefined(i.title),o=i.title?i.title:i.primaryKey?i.primaryKey:null,s=i.tag||i.content;return this._cardTemplate="<div id='{{:"+r.model.fields.primaryKey+"}}' class='e-kanbancard {{if ~_"+r._id+"getData(#parent)  && "+f+" }}e-hide{{/if}} {{if "+u+"}}e-templatecell{{/if}}'{{if "+i.color+" }} style='{{if "+r.model.enableRTL+"}}border-right-color{{else}}border-left-color{{/if}}:{{for  ~_"+r._id+"colorMaps('"+r._id+"Object',"+i.color+")}}{{:#data}}{{/for}}'{{/if}}>{{if "+u+"}}"+n(r.model.cardSettings.template).html()+"{{else}}{{if "+r.model.allowTitle+"}}<div class='e-cardheader'><div class='e-primarykey'>{{:"+o+"}}<\/div><div class='e-expandcollapse'><div class='e-icon e-cardexpand'><\/div><\/div><\/div>{{/if}}<div class='e-cardcontent'><table class='e-cardtable'><tbody><tr><td class='e-contentcell'>{{if "+s+"}}<div class='e-innercontent'><div class='e-text'>{{:"+i.content+"}}<\/div>{{if "+i.tag+"}}{{for ~_"+r._id+"tagItems("+i.tag+")}}{{:#data}}{{/for}}{{/if}}<\/div>{{/if}}<\/td><td class='e-imagecell'>{{if "+e+" }} <div class='e-card_image'>{{if "+i.imageUrl+"}}<img class='e-image' src='{{:"+i.imageUrl+"}}'><\/img>{{else}}<div class='e-image e-no-user'><\/div>{{/if}}{{/if}}<\/td><\/tr><\/tbody><\/table><\/div>{{/if}}<\/div><\/div>",this._cardTemplate},_removeIdSymbols:function(n){return n.replace(/[-\s']/g,"_")},_columnStatus:function(n){var t=this.getRsc("helpers",n),i=t.getBrowserDetails();return i.browser=="msie"?!0:!1},_columnCardcount:function(n,i,r){var f=0,u;if(t.isNullOrUndefined(r)){for(u=0;u<n.length;u++)n[u].Status===i&&f++;return f}for(u=0;u<n[r].items.length;u++)n[r].items[u].Status===i&&f++;return f},_columnData:function(n){return t.isNullOrUndefined(n)?!1:n.parent.data.isCollapsed},_getColorMaps:function(n,t){var e=this.getRsc("helpers",n),f,r=e.model.cardSettings.colorMapping,i,u;for(i in r){if(r[i].indexOf(",")==-1&&r[i]==t)return i;for(f=r[i].split(","),u=0;u<f.length;u++)if(f[u]==t)return i}return!1},_gettagItems:function(n){var i="<div class='e-tags'>",t;for(n=n.split(","),t=0;t<n.length;t++)i=i.concat("<div class='e-tag'>"+n[t]+"<\/div>");return i.concat("<\/div>")},_kbnTouchClick:function(i){this.model.selectionType==t.Kanban.SelectionType.Multiple&&this._kTouchBar.is(":visible")&&!n(i.target).hasClass("e-cardselection")&&n(i.target).parents(".e-cardselection").length<=0&&!n(i.target).hasClass("e-cardtouch")&&n(i.target).parents(".e-cardtouch").length<=0&&!this._kTouchBar.find(".e-cardtouch").hasClass("e-spanclicked")&&this._kTouchBar.hide()},_clickHandler:function(i){var r=n(i.target),u,o=r.hasClass("e-rowcell")?r.index():r.closest(".e-rowcell").index(),f=this.getIndexByRow(r.closest("tr.e-columnrow")),e;u=r.closest(".e-kanbancard");n(i.target).hasClass("e-columnadd")&&(this._isAddNewClick=!0,this._newCard=n(i.target).parents(".e-rowcell"),this.addCard());(r.hasClass("e-cardexpand")||r.hasClass("e-cardcollapse")||r.hasClass("e-expandcollapse"))&&this.toggleCard(r);(r.closest(".e-clexpand").length||r.closest(".e-clcollapse").length||r.closest(".e-shrink").length||r.closest(".e-stackedHeaderRow").length)&&this.model.allowToggleColumn&&this.toggleColumn(r);!t.isNullOrUndefined(this.model.fields.swimlaneKey)&&(r.hasClass("e-slexpandcollapse")||r.hasClass("e-slexpand")||r.hasClass("e-slcollapse"))&&this.toggleSwimlane(r);this.model.allowSelection&&u.length>0&&r.closest(".e-expandcollapse").length<=0&&(e=n(u.parent()).children().eq(0).hasClass("e-limits")?u.index()-1:u.index(),this.model.selectionType==t.Kanban.SelectionType.Single?this._cardSelection([[f,[o],[e]]],u,i):this.model.selectionType==t.Kanban.SelectionType.Multiple&&(i.shiftKey||i.ctrlKey||this._enableMultiTouch?(this._currentRowCellIndex.length==0||f==this._currentRowCellIndex[0][0])&&this._cardSelection([[f,[o],[e]]],u,i):this._cardSelection([[f,[o],[e]]],u,i)));u.length>0&&this._cardClick(r,u);r.attr("id")==this._id+"_Cancel"&&this.cancelEdit();r.attr("id")==this._id+"_Save"&&this.endEdit();r.hasClass("e-cardtouch")&&(r.hasClass("e-spanclicked")?(r.removeClass("e-spanclicked"),this._enableMultiTouch=!1,this._kTouchBar.hide()):(r.addClass("e-spanclicked"),this._enableMultiTouch=!0))},toggleCard:function(t){var i,r;if(typeof t=="string"||typeof t=="number")i=this.element.find("div.e-kanbancard[id="+t+"]"),this._toggleCardByTarget(n(i).find(".e-cardheader .e-icon"));else if(typeof t=="object"&&t[0].nodeName!="DIV")for(r=0;r<t.length;r++)i=this.element.find("div.e-kanbancard[id="+t[r]+"]"),this._toggleCardByTarget(n(i).find(".e-cardheader .e-icon"));else this._toggleCardByTarget(t)},_toggleCardByTarget:function(i){var e;if(i=i.hasClass("e-expandcollapse")?i.find("div:first"):i,i.hasClass("e-cardexpand")||i.hasClass("e-cardcollapse")){var r=i.closest("div.e-cardheader"),u=r.next(),f=r.find(".e-primarykey").text(),o=n(i).closest(".e-kanbancard");i.hasClass("e-cardexpand")?(i.removeClass("e-cardexpand").addClass("e-cardcollapse"),o.addClass("e-collapsedcard"),r.append(u.find(".e-text").clone()),u.hide(),n.inArray(f,this._collapsedCards)==-1&&this._collapsedCards.push(f)):(i.removeClass("e-cardcollapse").addClass("e-cardexpand"),o.removeClass("e-collapsedcard"),r.find(".e-text").remove(),u.show(),e=n.inArray(f,this._collapsedCards),e!=-1&&this._collapsedCards.splice(e));!this.model.allowScrolling||t.isNullOrUndefined(this._scrollObject&&this._scrollObject.model)||i.closest(".e-hscroll").length||this.getScrollObject().refresh()}},_cardClick:function(n,i){var r,u=null,f;t.isNullOrUndefined(i.attr("id"))||(f=t.DataManager(this._currentJsonData),u=f.executeLocal((new t.Query).where(this.model.fields.primaryKey,t.FilterOperators.equal,i.attr("id"))));r={target:n,currentCard:i,data:u};this._trigger("cardClick",r)},toggleColumn:function(t){if(typeof t=="string"||"object"&&t[0].nodeName!="DIV")this._toggleField(t.closest(".e-shrink").find(".e-shrinkheader").text().split("[")[0]);else{var f,r,e,i,u="",s=this.model.columns,o;if(this.model.stackedHeaderRows.length&&(u=this.model.stackedHeaderRows[0].stackedHeaderColumns),e=t.closest(".e-headercell").not(".e-stackedHeaderCell"),r=this.element.find(".e-columnheader").not(".e-stackedHeaderRow").find(".e-hide"),e.length>0)this._toggleField(s[e.index()].headerText);else if(t.closest(".e-shrink").find(".e-shrinkheader").length>0)for(i=0;i<r.length;i++)o=n(r[i]).find(".e-headerdiv").text().split("[")[0],o==t.closest(".e-shrink").find(".e-shrinkheader").text().split("[")[0]&&(n(r[i]).next().find(".e-clcollapse").addClass("e-clexpand"),n(r[i]).next().find(".e-clexpand").removeClass("e-clcollapse"),this._toggleField(o));else if(t.closest(".e-stackedHeaderRow").length>0)for(f=t.closest(".e-stackedHeaderCell"),i=0;i<u.length;i++)u[i].headerText==n(f).text()&&(f.hasClass("e-collapse")?this.element.find(".e-stackedHeaderCell").eq(i).removeClass("e-collapse"):this.element.find(".e-stackedHeaderCell").eq(i).addClass("e-collapse"),this._toggleField(u[i].column.split(",")))}},_getCardbyIndexes:function(t){return n(this.getRowByIndex(t[0][0]).find(".e-rowcell:eq("+t[0][1][0]+")").find("div.e-kanbancard:eq("+t[0][2][0]+")"))},_getColumnKeyItems:function(n){var r=this.getRsc("helpers",n),f,e=this.ctx.root.dataSource,u,o=r.model.query,i=o.clone();return r._filterCollection.length<=0&&r.model.allowSearching&&r._searchInput.val().length<=0?(i.queries=[],i.where(t.Predicate.or(r.keyPredicates))):i.queries=i.queries.slice(0,i.queries.length-1),i=i.where(r.model.keyField,"equal",this.data.key),f=e.GROUPGUID?new t.DataManager(this.ctx.items).executeLocal(i).result:new t.DataManager(e).executeLocal(i).result,u=r.model.fields.priority,u&&f.sort(function(n,t){return n[u]-t[u]}),f},_cardSelection:function(i,r,u){var l,c,e=null,s=null,b,a,g,y,p,h,w;if(l=r.parent("td.e-rowcell"),this._currentRowCellIndex.length>0&&!n(r).hasClass("e-cardselection")&&(this._previousRowCellIndex=[[this._currentRowCellIndex[0][0],[this._currentRowCellIndex[0][1][0]],[this._currentRowCellIndex[0][2][0]]]]),t.isNullOrUndefined(r.attr("id"))||(b=t.DataManager(this._currentJsonData),s=b.executeLocal((new t.Query).where(this.model.fields.primaryKey,t.FilterOperators.equal,r.attr("id")))),t.isNullOrUndefined(this._previousRowCellIndex)||this._previousRowCellIndex.length==0||(e=this._getCardbyIndexes(this._previousRowCellIndex)),c={currentCell:l,target:r,cellIndex:i[0][1][0],cardIndex:i[0][2][0],data:s,previousRowCellIndex:this._previousRowCellIndex,previousCard:e,selectedCardsData:this._selectedCardData},!this._trigger("beforeCardSelect",c)){if(n(r).hasClass("e-cardselection")||(this.model.selectionType!=t.Kanban.SelectionType.Multiple||this._kTouchBar.find(".e-cardtouch").hasClass("e-spanclicked")||this._kTouchBar.hide(),u.pointerType!="touch"||this._kTouchBar.find(".e-cardtouch").hasClass("e-spanclicked")||this.model.selectionType!=t.Kanban.SelectionType.Multiple||(a=n(r).offset(),this._kTouchBar.show(),this._kTouchBar.offset({top:a.top,left:a.left}))),this.model.selectionType==t.Kanban.SelectionType.Multiple&&u.shiftKey){var v,o,f=0,k=0,nt=r,d=[];for(t.isNullOrUndefined(e)?o=r.parents(".e-columnrow").find(".e-kanbancard"):(v=e.parents(".e-columnrow"),v.find(".e-cardselection").not(e).removeClass("e-cardselection"),o=v.find(".e-kanbancard"),f=o.index(e)),this._selectedCards=[],this._selectedCardData=[],this.selectedRowCellIndexes=[];k<=0;)p=[],g=n(o[f]).parents(".e-columnrow"),y=n(o[f]).parents(".e-rowcell"),n(o[f]).addClass("e-cardselection"),d.push(o[f]),this._selectedCardData.push(this._getKanbanCardData(this._currentJsonData,o[f].id)[0]),p=[[this.element.find(".e-columnrow").index(g),[y.index()],[y.find(n(o[f])).index()]]],o[f].id==nt.attr("id")&&(k=1),this._pushIntoSelectedArray(p),t.isNullOrUndefined(e)?++f:i[0][1][0]<this._previousRowCellIndex[0][1][0]?--f:i[0][1][0]==this._previousRowCellIndex[0][1][0]?i[0][2][0]<this._previousRowCellIndex[0][2][0]?--f:++f:++f;t.isNullOrUndefined(e)&&(this._previousRowCellIndex=this._currentRowCellIndex=[[0,[0],[0]]],e=this._getCardbyIndexes(this._previousRowCellIndex));this._selectedCards=[];this._selectedCards[this._selectedCards.length]=d;!t.isNullOrUndefined(e)||u.ctrlKey||u.shiftKey||this._enableMultiTouch||(n(r).addClass("e-cardselection"),this._selectedCards.push(r[0]),this._selectedCardData.push(this._getKanbanCardData(this._currentJsonData,r.id)[0]),this._pushIntoSelectedArray(i))}if(this.model.selectionType==t.Kanban.SelectionType.Multiple&&(u.ctrlKey||this._enableMultiTouch))if(n(r).hasClass("e-cardselection")){for(n(r).removeClass("e-cardselection"),this._popFromSelectedArray(i[0][0],i[0][1],i[0][2],u),h=0;h<this._selectedCardData.length;h++)if(s[0][this.model.fields.primaryKey]==this._selectedCardData[0][this.model.fields.primaryKey])break;this._selectedCardData.splice(h,1);this._selectedCards.splice(h,1);this._currentRowCellIndex=i}else n(r).addClass("e-cardselection"),this._selectedCards.push(r[0]),this._pushIntoSelectedArray(i),this._selectedCardData.push(s[0]);else this.model.selectionType==t.Kanban.SelectionType.Multiple&&u.shiftKey||(w=i[0][2],this.element.find(".e-cardselection").removeClass("e-cardselection"),this._selectedCards=[],this.selectedRowCellIndexes=[],n(r).addClass("e-cardselection"),this._selectedCardData=[],this._selectedCardData.push(s[0]),this._selectedCards.push(r[0]),this.model.selectionType==t.Kanban.SelectionType.Multiple&&(w=[i[0][2]]),this.selectedRowCellIndexes.push({rowIndex:i[0][0],cellIndex:i[0][1],cardIndex:w}));(c={currentCell:l,target:r,cellIndex:i[0][1][0],cardIndex:i[0][2][0],data:s,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCellIndex:this._previousRowCellIndex,previousCard:e,selectedCardsData:this._selectedCardData},this.model.selectionType==t.Kanban.SelectionType.Multiple&&u.shiftKey&&n(r).hasClass("e-cardselection")?(this._previousRowCellIndex.length==0&&(this._currentRowCellIndex=[[r.parents(".e-columnrow").index(),[0],[0]]]),this._currentRowCellIndex.length==0&&(this._currentRowCellIndex=i)):n(r).hasClass("e-cardselection")&&(this._currentRowCellIndex=i),this._trigger("cardSelect",c))||this.element.focus()}},_pushIntoSelectedArray:function(n){for(var i=0,u=!0,f=!0,r,e,t=0;t<this.selectedRowCellIndexes.length;t++)if(r=this.selectedRowCellIndexes[t],r.rowIndex==n[0][0]){for(u=!1,i=0;i<r.cellIndex.length;i++)if(e=r.cellIndex[i],e==n[0][1][0]){f=!1;break}break}u&&this.selectedRowCellIndexes.push({rowIndex:n[0][0],cellIndex:n[0][1],cardIndex:[n[0][2]]});f?u||(this.selectedRowCellIndexes[t].cellIndex.push(n[0][1][0]),this.selectedRowCellIndexes[t].cardIndex.push([n[0][2][0]])):this.selectedRowCellIndexes[t].cardIndex[i].push(n[0][2][0])},_popFromSelectedArray:function(n,i,r,u){var o,e,s,f,h,c;if(this.model.selectionType==t.Kanban.SelectionType.Multiple&&(u.ctrlKey||u.shiftKey||this._enableMultiTouch))for(o=0;o<this.selectedRowCellIndexes.length;o++)if(f=this.selectedRowCellIndexes[o],f.rowIndex==n)for(e=0;e<f.cellIndex.length;e++)if(h=f.cellIndex[e],h==i[0])if(u.shiftKey){f.cardIndex=[];break}else for(s=0;s<f.cardIndex[e].length;s++)if(c=f.cardIndex[e][s],c==r[0]){f.cardIndex[e].splice(s,1);f.cardIndex[e].length==0&&(f.cardIndex.splice(e,1),f.cellIndex.splice(e,1));f.cellIndex.length==0&&this.selectedRowCellIndexes.splice(o,1);break}},_renderKanbanTouchBar:function(){this._kTouchBar=t.buildTag("div.e-kanbantouchbar","",{display:"none"});var n=t.buildTag("div.e-content"),i=t.buildTag("div.e-downtail e-tail"),r=t.buildTag("span.e-cardtouch e-icon");n.append(r);this._kTouchBar.append(n);this._kTouchBar.append(i);this.element.append(this._kTouchBar)},clearSelection:function(){if(this.model.allowSelection){var t=n(this._kanbanRows).not(".e-swimlanerow");n(t).find(".e-rowcell .e-kanbancard").removeClass("e-cardselection");this.selectedRowCellIndexes=[];this._selectedCardData=[];this._selectedCards=[];this._previousRowCellIndex=[];this._currentRowCellIndex=[]}},getIndexByRow:function(t){return n(this._columnRows).index(t)},getRowByIndex:function(i){return t.isNullOrUndefined(i)?!1:n(this._columnRows[i])},_stackedHeadervisible:function(){for(var t=this.element.find(".e-columnheader .e-stackedHeaderCell "),n=0;n<t.length;n++)t[n].offsetWidth<t[n].scrollWidth&&t.eq(n).find("div").addClass("e-hide")},toggleSwimlane:function(t){var i,r,u;if(typeof t=="string"||typeof t=="number")i=this._removeIdSymbols(t),r=this.element.find("tr[id="+i+"]"),this._toggleSwimlaneRow(n(r).find(".e-rowcell .e-slexpandcollapse"));else if(typeof t=="object"&&t[0].nodeName!="DIV")for(u=0;u<t.length;u++)i=this._removeIdSymbols(t[u]),r=this.element.find("tr[id="+i+"]"),this._toggleSwimlaneRow(n(r).find(".e-rowcell .e-slexpandcollapse"));else this._toggleSwimlaneRow(t)},_toggleSwimlaneRow:function(n){var e,r,o,u,f,i,s;if(n=n.hasClass("e-slexpandcollapse")?n.find("div:first"):n,n.hasClass("e-slexpand")||n.hasClass("e-slcollapse")){if(e=n.closest("tr"),e.next(".e-collapsedrow").remove(),r=e.next(),n.hasClass("e-slexpand")){for(r.hide(),o=t.buildTag("tr","",{},{"class":"e-collapsedrow"}),u=this.model.columns,i=0;i<u.length;i++)f=t.buildTag("td","",{},{"class":"e-rowcell",role:"kanbancell"}),u[i].visible||f.addClass("e-hide"),u[i].isCollapsed&&f.addClass("e-shrink"),o.append(f);r.before(o);n.removeClass("e-slexpand").addClass("e-slcollapse")}else r.show(),n.removeClass("e-collapsedrow").removeClass("e-slcollapse").addClass("e-slexpand");this.model.allowScrolling&&(s=this._headerContent.find(".e-hscrollcss"),this._refreshScroller({requestType:"refresh"}),this.getContent().find(".e-vscrollbar").length>0?s.removeClass("e-vscroll-area"):s.addClass("e-vscroll-area"))}},expandAll:function(){var i=this.element.find(".e-swimlanerow .e-slcollapse"),t;if(i.length!=0)for(t=0;t<i.length;t++)this.toggleSwimlane(n(i[t]))},collapseAll:function(){var i=this.element.find(".e-swimlanerow .e-slexpand"),t;if(i.length!=0)for(t=0;t<i.length;t++)this.toggleSwimlane(n(i[t]))},_cardHover:function(i){var f=n(i.target),u=n(this._kanbanRows),r=n(f).closest(".e-kanbancard");return!r.length>0?!1:(this.model.allowHover&&(i.type=="mouseenter"?t.isNullOrUndefined(u)||r.index()!=-1&&r.addClass("e-hover"):u.find(".e-kanbancard").removeClass("e-hover")),!1)},columns:function(i,r,u){var e,f,o,h,s,c;if(!t.isNullOrUndefined(i)){for(e=!1,typeof i=="string"?(i=[i],e=!0):i instanceof Array&&i.length&&typeof i[0]=="string"&&(e=!0),f=0;f<i.length;f++)o=n.inArray(this.getColumnByHeaderText(e?i[f]:i[f].headerText),this.model.columns),u=="add"||t.isNullOrUndefined(u)?o==-1?this.model.columns.push(e?{headerText:i[f],key:r}:i[f]):this.model.columns[o]=e?{headerText:i[f],key:r}:i[f]:o!=-1&&this.model.columns.splice(o,1);for(h=this.element.find(".e-kanbanheader"),this._columnsWidthCollection=[],s=0;s<this.model.columns.length;s++)t.isNullOrUndefined(this.model.columns[s].width)||this._columnsWidthCollection.push(this.model.columns[s].width);this.element[0].replaceChild(this._renderHeader()[0],h[0]);this._addColumnFilters();c={requestType:"addcolumn"};this._ensureDataSource(c);this._renderAllCard();this.refresh(!0);this._refreshHeaderScroller();this._totalCount()}},_getMetaColGroup:function(){for(var r,u=t.buildTag("colgroup"),i=0;i<this.model.columns.length;i++)r=n(document.createElement("col")),this.model.allowToggleColumn&&this.model.columns[i].isCollapsed===!0&&r.addClass("e-shrinkcol"),this.model.columns[i].visible===!1&&r.addClass("e-hide"),u.append(r);return u},refresh:function(n){n&&this.refreshTemplate();var i={};i.requestType=t.Kanban.Actions.Refresh;this._processBindings(i)},_renderContext:function(){var c,l,a,s,r,u,i,e,y,v,f,p,h,o;for(c=this.model.contextMenuSettings.menuItems,f=t.buildTag("ul","",{},{id:this._id+"_Context"}),p=this.model.contextMenuSettings.disableDefaultItems,i=0;i<c.length;i++)r=c[i].menuItem,n.inArray(r,p)==-1&&(u=this._items(r,"menuItem")),f.append(u);for(h=this.model.contextMenuSettings.customMenuItems,e=0;e<h.length;e++)y=h[e].text,v=this._items(y,"custom"),h[e].template&&v.append(n(h[e].template).html()),f.append(v);for(o=t.buildTag("ul","",{},{id:this._id+"_SubContext"}),i=0;i<this.model.columns.length;i++)r=this.model.columns[i].headerText,l=t.buildTag("div","",{},{"class":"e-visiblecolumns"}),a=t.buildTag("input","",{},{type:"checkbox",name:r}),u=this._items(r,"subMenuItem"),l.append(a),u.prepend(l),o.append(u),a.ejCheckBox({checked:this.model.columns[i].visible});if(n(f).find("li.e-column.e-visiblecolumn").append(o),this.model.fields.swimlaneKey){for(o=t.buildTag("ul","",{},{id:this._id+"_SubContext"}),s=this._dataManager.executeLocal((new t.Query).select(this.model.fields.swimlaneKey)),s=t.dataUtil.mergeSort(t.distinct(s)),i=0;i<s.length;i++)r=s[i],u=this._items(r,"subMenuItem"),o.append(u);n(f).find("li.e-move.e-swimlane").append(o)}n(f).ejMenu({menuType:t.MenuType.ContextMenu,openOnClick:!1,contextMenuTarget:"#"+this._id,click:n.proxy(this._clickevent,this),width:"auto",cssClass:"e-kanban-context",beforeOpen:n.proxy(this._menu,this)});this._conmenu=f.data("ejMenu")},_clickevent:function(i){var e,f,r,u,o,s,h;if(e=i.parentText!=null?i.parentText:i.events.text,f=n(this._contexttarget),i.targetelement=this._contexttarget,r=f.closest(".e-kanbancard"),u=r.length,!this._trigger("contextClick",i))switch(e){case"Add Card":this._isAddNewClick=!0;this._newCard=n(this._contexttarget);this.addCard();break;case"Edit Card":u>0&&!t.isNullOrUndefined(this.model.fields.primaryKey)&&this.startEdit(r);break;case"Hide Column":f.closest(".e-headercell").find(".e-headercelldiv").length>0&&this.hideColumns(f.closest(".e-headercell").find(".e-headercelldiv").text());break;case"Delete Card":!t.isNullOrUndefined(this.model.fields.primaryKey)&&r.length>0&&this.deleteCard(r.attr("id"));break;case"Move Right":u>0&&this._dropToColumn(n(this._contexttarget).closest("td.e-rowcell").next(),r);break;case"Move Left":u>0&&this._dropToColumn(n(this._contexttarget).closest("td.e-rowcell").prev(),r);break;case"Move Up":u>0&&this._dropAsSibling(r.prev(),r,!1);break;case"Move Down":u>0&&this._dropAsSibling(r.next(),r,!0);break;case"Top of Row":u>0&&this._dropAsSibling(f.closest("td.e-rowcell").find(".e-kanbancard").first(),r,!1);break;case"Bottom of Row":u>0&&this._dropAsSibling(f.closest("td.e-rowcell").find(".e-kanbancard").last(),r,!0);break;case"Move Swimlane":e!=i.text&&u>0&&(o=f.closest(".e-kanbancard").attr("id"),s=new t.DataManager(this._currentJsonData).executeLocal((new t.Query).where(this.model.fields.primaryKey,"equal",o))[0],s[this.model.fields.swimlaneKey]=i.text,this.updateCard(o,s));break;case"Visible Columns":e!=i.text&&(h=n(i.element.parentElement).find("li").index(i.element),this.model.columns[h].visible?(this.hideColumns(i.text),n(n(i.element).find("input.e-checkbox")).ejCheckBox({checked:!1})):(this.showColumns(i.text),n(n(i.element).find("input.e-checkbox")).ejCheckBox({checked:!0})))}},_menu:function(i){var r,e,l,w,a,v,b,o,f,s,u,y,h,p,c;if(r=this._conmenu.element,this._contexttarget=i.target,e=n(i.target),l=n(this._contexttarget).closest("td.e-rowcell"),w=n(this._contexttarget).closest("tr.e-columnrow"),a=e.closest(".e-rowcell"),v=n(e).closest(".e-kanbancard"),b=this.model.contextMenuSettings.menuItems,r.css("visibility","visible"),r.find("li").hide(),e.closest(".e-kanban").attr("id")!==this._id){r.css("visibility","hidden");return}if(r.find(".e-customitem").length>0)for(o=this.model.contextMenuSettings.customMenuItems,f=r.find(".e-customitem"),u=0;u<f.length;u++)if(o[u].target||(o[u].target="all"),o[u].target&&o[u].text==r.find(".e-customitem").children("a").eq(u).text())switch(o[u].target){case"content":this.getContentTable().find(e).length>0?(n(f[u]).show(),n(f[u]).find("li").length>0&&n(f[u]).find("li").show()):n(f[u]).hide();break;case"header":this.getHeaderContent().find(e).length>0?(n(f[u]).show(),n(f[u]).find("li").length>0&&n(f[u]).find("li").show()):n(f[u]).hide();break;case"all":n(f[u]).show();n(f[u]).find("li").length>0&&n(f[u]).find("li").show()}if(this.getContentTable().find(e).length>0){if(a.length==0){r.css("visibility","hidden");return}if(n(e).closest(".e-swimlanerow").length>0){r.css("visibility","hidden");return}v.length>0?(p=n(e).closest("td.e-rowcell").find(".e-kanbancard"),h=p.index(v),y=p.length,n(r.find("li").not(".e-customitem")).hide(),n(r.find(".e-customitem li")).show(),!t.isNullOrUndefined(this.model.fields.primaryKey)&&this.model.editSettings.allowEditing&&r.find(".e-content.e-cardedit").show(),h>1&&r.find(".e-move.e-up").show(),h!=y-1&&r.find(".e-row.e-bottom").show(),h!=0&&r.find(".e-row.e-top").show(),y-1-h>1&&r.find(".e-move.e-down").show(),l.next().length>0&&r.find(".e-move.e-right").show(),l.prev().length>0&&r.find(".e-move.e-left").show(),t.isNullOrUndefined(this.model.fields.primaryKey)||r.find(".e-content.delete").show(),this.model.fields.swimlaneKey&&this.model.fields.primaryKey&&!r.find(".e-move.e-swimlane.e-target").length>0&&(r.find(".e-move.e-swimlane").show(),r.find(".e-move.e-swimlane").find("li").show(),r.find(".e-move.e-swimlane").find("li").eq(this._columnRows.index(w)).hide())):a.length>0&&(n(r.find("li").not(".e-customitem")).hide(),n(r.find(".e-customitem li")).show(),this.model.editSettings.allowAdding&&r.find(".e-add").show())}else if(this.getHeaderContent().find(e).length>0)if(c=r.find(".e-column"),n(e).closest(".e-headercell").not(".e-stackedHeaderCell").length>0){for(n(r.find("li").not(".e-customitem")).hide(),n(r.find(".e-customitem li")).show(),n(r.find("li.e-haschild").find("li")).show(),c.show(),s=0;s<r.find(".e-column.e-visiblecolumn").find("li").length;s++)this.element.find(".e-headercell").not(".e-stackedHeaderCell").eq(s).hasClass("e-hide")?c.find("li input.e-checkbox").eq(s).ejCheckBox({checked:!1}):c.find("li input.e-checkbox").eq(s).ejCheckBox({checked:!0});c.find("li").show()}else{r.css("visibility","hidden");return}else{r.css("visibility","hidden");return}this.model.contextOpen&&this._trigger("contextOpen",i)},_items:function(i,r){var u,f,e;return i==""||t.isNullOrUndefined(i)?!1:(r=="menuItem"?i.indexOf("Card")!=-1?(u=t.buildTag("li","",{},{"class":"e-content"}),u.css("display","none"),i.indexOf("Add")!=-1&&u.addClass("e-add"),i.indexOf("Edit")!=-1&&u.addClass("e-cardedit"),i.indexOf("Delete")!=-1&&u.addClass("delete"),u.css("display","none")):i.indexOf("Column")!=-1||i.indexOf("Columns")!=-1?(u=t.buildTag("li","",{},{"class":"e-column"}),i.indexOf("Hide")!=-1&&u.addClass("e-hidecolumn"),i.indexOf("Visible")!=-1&&u.addClass("e-visiblecolumn"),u.css("display","none")):i.indexOf("Row")!=-1?(u=t.buildTag("li","",{},{"class":"e-row"}),i.indexOf("Top")!=-1?u.addClass("e-top"):u.addClass("e-bottom"),u.css("display","none")):i.indexOf("Move")!=-1&&(u=t.buildTag("li","",{},{"class":"e-move"}),i.indexOf("Left")!=-1?u.addClass("e-left"):i.indexOf("Right")!=-1?u.addClass("e-right"):i.indexOf("Up")!=-1?u.addClass("e-up"):i.indexOf("Down")!=-1?u.addClass("e-down"):i.indexOf("Swimlane")!=-1&&u.addClass("e-swimlane"),u.css("display","none")):r=="subMenuItem"?u=t.buildTag("li","",{}):r=="custom"&&(u=t.buildTag("li","",{},{"class":"e-customitem"}),u.css("display","block")),f=document.createElement("a"),e="",e=i.indexOf("Move")!=-1?i.split(" ")[1].toLowerCase():i.split(" ")[0].toLowerCase(),f.innerHTML=i,n(f).append(t.buildTag("span","",{},{"class":"e-kanbancontext e-icon e-context"+e})),u.append(f),u)},_renderAllCard:function(){var i=document.createElement("div");i.innerHTML=["<table>",n.render[this._id+"_JSONTemplate"]({columns:this.model.columns,dataSource:this.model.currentViewData}),"<\/table>"].join("");t.isNullOrUndefined(i.firstChild)||t.isNullOrUndefined(i.firstChild.lastChild)||this.getContentTable().get(0).replaceChild(i.firstChild.lastChild,this.getContentTable().get(0).lastChild);this._cardCollapse();this._selectionOnRerender()},_renderSingleCard:function(i,r){var e=this.element.find("div[id='"+i+"']"),u=this,o="",s,l,h,c,f;if(this._dropped?(c=n.render[this._id+"_cardTemplate"](r),t.browserInfo().name=="msie"&&t.browserInfo().version=="8.0"?n(e).after(c):n(e).replaceWith(c)):(t.isNullOrUndefined(u.model.fields.swimlaneKey)?o=this.element.find(".e-columnrow:first"):(l=this._removeIdSymbols(r[u.model.fields.swimlaneKey]),h=this.element.find("tr[id='"+l+"']"),h.length>0&&(o=h.next())),s=n(o).find("td.e-rowcell[ej-mappingkey='"+r[u.model.keyField]+"']"),n(e).remove(),s.length>0&&n(s).append(n.render[this._id+"_cardTemplate"](r))),!t.isNullOrUndefined(u.model.swimlaneTemplate)){var a=this.element.find("tr[id='"+this._removeIdSymbols(r[u.model.fields.swimlaneKey])+"']"),y=a.find("td .e-count"),v=a.next().find("td");for(f=0;f<v.length;f++)y.eq(f).text(v.eq(f).find(".e-kanbancard").length)}this._cardCollapse();this._enableDragandScroll();this._selectionOnRerender()},_updateGroup:function(i,r){var u=this;t.isNullOrUndefined(this._saveArgs)&&new t.DataManager(u._currentJsonData).update(u.model.fields.primaryKey,r);n.type(r)&&!r.count&&u._renderSingleCard(i,r)},_cardCollapse:function(){var i,t,r;if(this._collapsedCards.length>0)for(i=this.element.find(".e-kanbancard"),t=0;t<i.length;t++)r=n(i[t]).find(".e-primarykey").text(),n.inArray(r,this._collapsedCards)!=-1&&this.toggleCard(r)},updateCard:function(i,r){t.isNullOrUndefined(r)&&i&&(r=new t.DataManager(this._currentJsonData).executeLocal((new t.Query).where(this.model.fields.primaryKey,"equal",i))[0]);r=t.isNullOrUndefined(r)?null:r;var e,o=r,u=this,f=this._saveArgs;this._dataSource()instanceof t.DataManager&&!this._dataManager.dataSource.offline||this._dataSource().adaptor instanceof t.remoteSaveAdaptor?(e=t.isNullOrUndefined(this._saveArgs)||this._saveArgs.action==t.Kanban.Actions.Edit?this._dataManager.update(this.model.fields.primaryKey,o):this._dataManager.insert(o),!t.isNullOrUndefined(e)&&n.isFunction(e.promise)&&this._dataSource()instanceof t.DataManager&&(e.done(function(e){!t.isNullOrUndefined(e)&&n.isPlainObject(e.record)&&(t.isNullOrUndefined(f)?r=e.record:(f.data=e.record,f.action=="add"&&(u._cAddedRecord=e.record),f.action=="edit"&&(u._cModifiedData=e.record)));t.isNullOrUndefined(f)?u._updateGroup(i,r):u._processBindings(f);u._cModifiedData=null;u._cAddedRecord=null;u._isAddNewClick=!1;u._currentData=null;u._newCard=null;u._saveArgs=null;u._cardEditClick=null;u._dblArgs=null}),e.fail(function(n){var i;t.isNullOrUndefined(f)?i=n:(f.error=n&&n.error?n.error:n,i=f);u._trigger("actionFailure",i)}))):t.isNullOrUndefined(this._saveArgs)?u._updateGroup(i,r):u._processBindings(this._saveArgs);e!=undefined&&n.isFunction(e.promise)||(u._cModifiedData=null,u._cAddedRecord=null,u._isAddNewClick=!1,u._currentData=null,u._newCard=null,u._saveArgs=null,u._cardEditClick=null,u._dblArgs=null)},_getEmptyTbody:function(){var i=t.buildTag("td.e-emptycard",this.localizedLabels.EmptyCard,{},{colSpan:this.model.columns.length});return n(document.createElement("tr")).append(i)},dataSource:function(n,t){t&&(this._templateRefresh=!0);this._dataSource(n);this._refreshDataSource(n);this._addLastRow()},_refreshDataSource:function(n){this._dataManager=n instanceof t.DataManager?n:t.DataManager(n);this._isLocalData=!(this._dataSource()instanceof t.DataManager)||this._dataManager.dataSource.offline||this._isRemoteSaveAdaptor;this.refresh(!0)},_setModel:function(i){var r,f,e,u;for(r in i)switch(r){case"columns":e=i.columns;this.model.columns=[];this.columns(e,"add");break;case"cssClass":this.element.removeClass(this.model.cssClass).addClass(i[r]);break;case"filterSettings":r=="filterSettings"&&(this.model.filterSettings=i[r]);this.model.filterSettings.length>0?(this.element.find(".e-kanbantoolbar").remove(),this.model._filterCollection=[],this._renderToolBar().insertBefore(this.element.find(".e-kanbanheader").first())):(this.element.find(".e-kanbantoolbar").remove(),this.model.filterSettings=[],this.model._filterCollection=[],this.refresh());break;case"allowHover":this.model.allowHover=i[r];this._enableCardHover();break;case"enableRTL":this.model.enableRTL=i[r];this._enableKanbanRTL();this.refresh(!0);this._refreshScroller({requestType:"refresh"});break;case"tooltipSettings":n.extend(this.model.tooltipSettings,i[r]);!t.isNullOrUndefined(this.model.tooltipSettings)&&this.model.tooltipSettings.enable?(this._on(this.element,"mouseover",".e-kanbancard",n.proxy(this._showToolTip,this)),this._on(this.element,"mouseout",".e-kanbancard",n.proxy(this._hideToolTip,this))):(this._off(this.element,"mouseover",".e-kanbancard",n.proxy(this._showToolTip,this)),this._off(this.element,"mouseout",".e-kanbancard",n.proxy(this._hideToolTip,this)));break;case"allowScrolling":case"scrollSettings":if(f=this.getContent(),r!="allowScrolling"){if(!t.util.isNullOrUndefined(i.scrollSettings)){if(n.isEmptyObject(i.scrollSettings))break;n.extend(this.model.scrollSettings,i.scrollSettings)}t.util.isNullOrUndefined(i.allowScrolling)||(this.model.allowScrolling=i.allowScrolling);t.util.isNullOrUndefined(f.data("ejScroller"))||f.ejScroller("destroy");this.model.allowScrolling?(this.getHeaderContent().find("div").first().addClass("e-headercontent"),this._originalScrollWidth=this.model.scrollSettings.width,this._renderScroller()):(this.element.children(".e-kanbanheader").removeClass("e-scrollcss"),this.element.get(0).style.width.length==0&&this.element.css("width","auto"))}break;case"allowFreezeSwimlane":this.model.scrollSettings.allowFreezeSwimlane=i[r];i[r]?this.getContent().data("ejScroller").scrollY(0):this._freezeSwimlaneRow.remove();break;case"dataSource":f=this.element.find(".e-kanbancontent").first();this._refreshDataSource(this._dataSource());this._addLastRow();break;case"editSettings":n.extend(this.model.editSettings,i[r]);this._processEditing();this._tdsOffsetWidth=[];n("#"+this._id+"_dialogEdit").data("ejDialog")&&n("#"+this._id+"_dialogEdit").ejDialog("destroy");n("#"+this._id+"_dialogEdit_wrapper,#"+this._id+"_dialogEdit").remove();(this.model.editSettings.allowEditing||this.model.editSettings.allowAdding)&&this.element.append(this._renderDialog());this._enableEditingEvents();break;case"allowSelection":i[r]&&(this._off(this.element,"click",this._clickHandler),this._on(this.element,"click",this._clickHandler));break;case"query":this.model.query=n.extend(!0,{},i[r]);break;case"stackedHeaderRows":r=="stackedHeaderRows"&&(this.model.stackedHeaderRows=i[r]);this.model.stackedHeaderRows.length>0?this._refreshStackedHeader():(this.element.find(".e-stackedHeaderRow").remove(),this.model.stackedHeaderRows=[]);break;case"template":this.model.cardSettings.template=i[r];this.element.find(".e-kanbancard").remove();this.refreshTemplate();this._renderAllCard();this._enableDragandScroll();break;case"allowToggleColumn":this.model.allowToggleColumn=i[r];this.refreshTemplate();this.getHeaderContent().replaceWith(this.getHeaderContent(),this._renderHeader());this.sendDataRenderingRequest({requestType:t.Kanban.Actions.Refresh});this.model.allowToggleColumn||this.element.find(".e-shrinkheader").not(".e-hide").addClass("e-hide");break;case"locale":this.model.locale=i[r];u=this.model;u.query.queries=u.query.queries.slice(0,u.query.queries.length-1);this.element.ejKanban("destroy").ejKanban(u)}},_getLocalizedLabels:function(){return t.getLocalizedConstants(this.sfType,this.model.locale)}});t.kanbanFeatures.dragAndDrop&&n.extend(t.Kanban.prototype,t.kanbanFeatures.dragAndDrop);t.kanbanFeatures.edit&&n.extend(t.Kanban.prototype,t.kanbanFeatures.edit);t.Kanban.Locale=t.Kanban.Locale||{};t.Kanban.Locale["default"]=t.Kanban.Locale["en-US"]={EmptyCard:"No cards to display",SaveButton:"Save",CancelButton:"Cancel",EditFormTitle:"Details of ",AddFormTitle:"Add New Card",SwimlaneCaptionFormat:"- {{:count}}{{if count == 1 }} item {{else}} items {{/if}}",FilterSettings:"Filters:",FilterOfText:"of",Max:"Max",Min:"Min",Cards:"  Cards"};t.Kanban.Actions={Filtering:"filtering",BeginEdit:"beginedit",Edit:"edit",Save:"save",Add:"add",Delete:"delete",Cancel:"cancel",Refresh:"refresh",Search:"searching"};t.Kanban.EditingType={String:"stringedit",Numeric:"numericedit",Dropdown:"dropdownedit",DatePicker:"datepicker",DateTimePicker:"datetimepicker",TextArea:"textarea",RTE:"rteedit"};t.Kanban.EditMode={Dialog:"dialog",DialogTemplate:"dialogtemplate"};t.Kanban.Type={Column:"column",Swimlane:"swimlane"};t.Kanban.Target={Header:"header",Content:"content",All:"all"};t.Kanban.MenuItem={AddCard:"Add Card",EditCard:"Edit Card",DeleteCard:"Delete Card",TopOfRow:"Top of Row",BottomOfRow:"Bottom of Row",MoveUp:"Move Up",MoveDown:"Move Down",MoveLeft:"Move Left",MoveRight:"Move Right",MoveToSwimlane:"Move to Swimlane",HideColumn:"Hide Column",VisibleColumns:"Visible Columns"};t.Kanban.SelectionType={Single:"single",Multiple:"multiple"}}(jQuery,Syncfusion)});
