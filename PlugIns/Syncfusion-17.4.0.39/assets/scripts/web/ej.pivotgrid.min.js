/*!
*  filename: ej.pivotgrid.min.js
*  version : 17.4.0.39
*  Copyright Syncfusion Inc. 2001 - 2019. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.touch.min","./ej.button.min","./ej.waitingpopup.min","./ej.pivotpager.min","./ej.pivotanalysis.base.min","./ej.treeview.min","./ej.olap.base.min","./ej.pivot.common.min"],n):n()})(function(){(function(n,t,r){t.olap=t.olap||{};t.widget("ejPivotGrid","ej.PivotGrid",{_rootCSS:"e-pivotgrid",element:null,model:null,_requiresID:!0,validTags:["div","span"],defaults:{url:"",cssClass:"",jsonRecords:"",currentReport:"",layout:"normal",analysisMode:"olap",operationalMode:"clientmode",filterType:"filterType",enablePivotFieldList:!0,enableGroupingBar:!1,enableDeferUpdate:!1,enableJSONRendering:!1,enableVirtualScrolling:!1,enablePaging:!1,enableColumnResizing:!1,resizeColumnsToFit:!0,enableContextMenu:!1,enableCellContext:!1,enableRTL:!1,enableDefaultValue:!1,enableToolTip:!0,enableToolTipAnimation:!0,enableCellSelection:!1,enableConditionalFormatting:!1,enableCellEditing:!1,enableColumnGrandTotal:!0,enableRowGrandTotal:!0,enableGrandTotal:!0,enableCollapseByDefault:!1,enableCellDoubleClick:!1,enableCellClick:!1,enableDrillThrough:!1,isResponsive:!1,enableAdvancedFilter:!1,showUniqueNameOnPivotButton:!1,enableMemberEditorPaging:!1,enableMemberEditorSorting:!1,enableXHRCredentials:!1,enableCompleteDataExport:!1,enableCheckStateOnSearch:!0,editCellsInfo:{},hyperlinkSettings:{enableValueCellHyperlink:!1,enableRowHeaderHyperlink:!1,enableColumnHeaderHyperlink:!1,enableSummaryCellHyperlink:!1},headerSettings:{showRowItems:!1,showColumnItems:!1},frozenHeaderSettings:{enableFrozenRowHeaders:!1,enableFrozenColumnHeaders:!1,enableFrozenHeaders:!1,scrollerSize:18},valueSortSettings:{headerText:"",headerDelimiters:"##",sortOrder:t.PivotAnalysis.SortOrder.None},conditionalFormatSettings:[],serviceMethodSettings:{initialize:"InitializeGrid",drillDown:"DrillGrid",exportPivotGrid:"Export",paging:"Paging",fetchMembers:"FetchMembers",nodeStateModified:"NodeStateModified",nodeDropped:"NodeDropped",filtering:"Filtering",sorting:"Sorting",valueSorting:"ValueSorting",deferUpdate:"DeferUpdate",memberExpand:"MemberExpanded",writeBack:"WriteBack",cellEditing:"CellEditing",saveReport:"SaveReport",loadReport:"LoadReportFromDB",calculatedField:"CalculatedField",drillThroughHierarchies:"DrillThroughHierarchies",drillThroughDataTable:"DrillThroughDataTable",removeButton:"RemoveButton"},customObject:{},locale:"en-US",dataSource:{data:null,sourceInfo:"",providerName:"ssas",enableAdvancedFilter:!1,isFormattedValues:!1,reportName:"Default",columns:[],cube:"",catalog:"",rows:[],values:[],filters:[],pagerOptions:{categoricalPageSize:0,seriesPageSize:0,categoricalCurrentPage:0,seriesCurrentPage:0}},pivotTableFieldListID:"",collapsedMembers:null,cellSelection:null,valueCellHyperlinkClick:null,rowHeaderHyperlinkClick:null,columnHeaderHyperlinkClick:null,summaryCellHyperlinkClick:null,beforeServiceInvoke:null,afterServiceInvoke:null,drillThrough:null,drillSuccess:null,cellContext:null,load:null,renderComplete:null,renderFailure:null,renderSuccess:null,cellDoubleClick:null,cellClick:null,applyFieldCaption:null,beforeExport:null,beforePivotEnginePopulate:null,pivotEnginePopulated:null,saveReport:null,loadReport:null,cellEdit:null,memberEditorPageSize:100,maxNodeLimitInMemberEditor:1e3},dataTypes:{dataSource:{data:"data",columns:"array",rows:"array",values:"array",filters:"array"},serviceMethodSettings:{initialize:"enum",drillDown:"enum",exportPivotGrid:"enum",paging:"enum",fetchMembers:"enum",nodeStateModified:"enum",nodeDropped:"enum",filtering:"enum",sorting:"enum",deferUpdate:"enum",memberExpand:"enum",writeBack:"enum",cellEditing:"enum",saveReport:"enum",loadReport:"enum",calculatedField:"enum",drillThroughHierarchies:"enum",drillThroughDataTable:"enum",removeButton:"enum"},customObject:"data"},observables:["layout","enableCellContext","hyperlinkSettings.enableValueCellHyperlink","hyperlinkSettings.enableRowHeaderHyperlink","hyperlinkSettings.enableColumnHeaderHyperlink","hyperlinkSettings.enableSummaryCellHyperlink"],layout:t.util.valueFunction("layout"),enableCellContext:t.util.valueFunction("enableCellContext"),enableValueCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableValueCellHyperlink"),enableRowHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableRowHeaderHyperlink"),enableColumnHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableColumnHeaderHyperlink"),enableSummaryCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableSummaryCellHyperlink"),locale:t.util.valueFunction("locale"),getOlapReport:function(){return this._olapReport},setOlapReport:function(n){this._olapReport=n},getJSONRecords:function(){return this._JSONRecords},setJSONRecords:function(t){this._JSONRecords=n.parseJSON(t)},_init:function(){this._initPrivateProperties();this._load()},_destroy:function(){n(this.element).next().length>0&&n(this.element).next()[0].className=="e-pGridTooltip"&&n(this.element).next().remove();this.element.empty().removeClass("e-pivotgrid"+this.model.cssClass).removeAttr("tabindex");this._waitingPopup!=r&&this._waitingPopup.destroy();this.element.attr("class")==""&&this.element.removeAttr("class")},_getExportModel:function(){var r="ExportControl",u={rowCellColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".rowheader").css("color"),rowCellBGColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".rowheader").css("background-color"),columnCellColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".colheader").css("color"),columnCellBGColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".colheader").css("background-color"),valueCellColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("color"))?"rgb(51, 51, 51)":this._cFormat.length<=0?this.element.find(".value").css("color"):"rgb(51, 51, 51)",valueCellBGColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("background-color"))?"rgb(255, 255, 255)":this._cFormat.length<=0?this.element.find(".value").css("background-color"):"rgb(255, 255, 255)",summaryCellColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("color"))?"rgb(51, 51, 51)":this.element.find(".summary").css("color"),summaryCellBGColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".summary").css("background-color")},modelClone=n.extend(!0,{},this.model),i={url:"",fileName:"PivotGrid",exportMode:t.PivotGrid.ExportMode.JSON,fileFormat:this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?".xls":".xlsx",title:"",description:"",exportType:"excel",controlName:this,exportWithStyle:!0,exportValueAsNumber:!1};return{args:{pGridData:this.exportRecords!=null&&this.exportRecords!=""?this.exportRecords:null,rowCount:this._excelLikeJSONRecords!=null?this._excelRowCount:this._rowCount,columnCount:this._excelLikeJSONRecords!=null?Math.floor(this._excelLikeJSONRecords.length/this._excelRowCount):this.getJSONRecords()!=null?Math.floor(this.getJSONRecords().length/this._rowCount):0,fileFormat:i.fileFormat+(i.fileFormat==".xls"||i.fileFormat==".xlsx"?"~"+i.exportValueAsNumber:""),fileName:t.isNullOrUndefined(r)?t.isNullOrUndefined(i.fileName)?"PivotGrid":i.fileName:r,colorSettings:u,Formatting:this._cFormat,title:i.title,description:i.description,language:this.model.locale,multiControlExport:!0,exportWithStyle:i.exportWithStyle,customObject:JSON.stringify(this.model.customObject)}}},_initPrivateProperties:function(){this._id=this.element.attr("id");this._olapReport="";this._JSONRecords=null;this._excelLikeJSONRecords=null;this._drillCaption="";this._drillAction="";this._startDrilldown=!1;this._pagerObj=null;this._seriesPageCount=null;this._categPageCount=null;this._seriesCurrentPage=1;this._categCurrentPage=1;this._drillHeaders={row:[],column:[]};this._collapsedRowHeaders=[];this._isDragging=!1;this._droppedClass="";this._dataModel="";this._ascdes="";this._filterUpdate=[];this._pivotRow=[];this._pivotColumn=[];this._pivotCalculation=[];this._pivotFilter=[];this._pivotTableFields=[];this._schemaData=null;this._waitingPopup=null;this._oriX=null;this._oriY=null;this._sortType="";this._startPosCell=null;this._startCellPosition=null;this._maxViewLoading=null;this._list=[];this._formatEdit=!1;this._formatName=[];this._formatName.push(this._getLocalizedLabels("AddNew"));this._rowCount=0;this._excelRowCount=0;this._dialogTitle="";this._selectedField="";this._selectedAxis="";this._isUpdateRequired=!1;this._isMembersFiltered=!1;this._selectedCell=null;this._onholdKey="";this._primaryCellPos="";this._prevDrillElements=[];this._currentReportItems=[];this._savedReportItems=[];this._rowHeader=[];this._colHeader=[];this._cellInfo=[];this._editorFlag=!0;this._isSubTotalHide=!1;this._isSubTotalhidden=!1;this._dimension;this._calculatedField=[];this._isFormatApply=!1;this._cFormat=[];this._curFocus={cell:null,tab:null,tree:null,cformat:null,grp:null,selection:null,filter:null,field:null,formula:null};this._index={index:0,grp:1,cell:1,dialog:1,paging:1,cformat:1,filter:0,field:0,formula:0};this._dataSet=[];this._currentCell=-1;this._target=null;this._orgX=null;this._orgY=null;this._expand=!1;this._excelFilterInfo=[];this._pagingSavedObjects={drillEngine:[],savedHdrEngine:[],curDrilledItem:{}};this._isSchemaInitialize=!0;this._fieldMembers={};this._fieldSelectedMembers={};this._allMember="";this._selectedMeasure="";this._selectedFormat="";this._dialogName="";this._pivotClientObj=null;this._memberPageSettings={currentMemeberPage:1,startPage:0,endPage:0};this._memberSearchPageSettings={currentMemberSearchPage:1,startSearchPage:0,endSearchPage:0};this._memberDrillPageSettings={currentMemberDrillPage:1,startDrillPage:0,endDrillPage:0};this._isAllMemberChecked=!0;this._editorTreeData=[];this._editorSearchTreeData=[];this._editorDrillTreeData={};this._editorDrillTreePageSettings={};this._lastSavedTree=[];this._onDemandNodeExpand=!0;this._isSearchApplied=!1;this._isEditorDrillPaging=!1;this._isEditorCollapseDrillPaging=!1;this._isSchemaClick=!1;this._memberPagingAvdData=[];this._table="";this._drillParams={currRow:"",currCol:"",currPos:""};this._croppedJson=[];this._compJson=[];this._isNavigation=!1;this._isOptionSearch=!1;this._isSelectSearchFilter=!0;this._currentFilterList={};this._rawData=[];this._colKeysCalcValues=[];this._rowKeysCalcValues=[];this._tableKeysCalcValues=[];this._isExporting=!1;this._fullExportedData={};this._pivotEngine=null;this._isXMLImport=!1;this._isFilterBtnClick=!1;this._parentNodeCollection={};this._parentSearchNodeCollection={};this._initialSlicerName=""},_load:function(){var f={element:this.element,customObject:this.model.customObject},u,r,i;if((this.model.enableAdvancedFilter||this.model.dataSource.enableAdvancedFilter)&&(this.model.dataSource.enableAdvancedFilter=this.model.enableAdvancedFilter=!0),this.model.enableCellEditing&&this.model.enableCellSelection&&(this.model.enableCellSelection=!1),this._trigger("load",f),this.element.addClass(this.model.cssClass),n(this.element).parents(".e-pivotclient").length>0?(this._pivotClientObj=n(this.element).parents(".e-pivotclient").data("ejPivotClient"),n("#"+this._pivotClientObj._id+"_maxView")[0]&&n("#"+this._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!0}),t.isNullOrUndefined(this._waitingPopup)&&!t.isNullOrUndefined(this._pivotClientObj._waitingPopup)&&(this._waitingPopup=this._pivotClientObj._waitingPopup),this._waitingPopup.show()):t.isNullOrUndefined(this._waitingPopup)&&(this.element.ejWaitingPopup({showOnInit:!0}),this._waitingPopup=this.element.data("ejWaitingPopup")),this._waitingPopup.show(),this.model.enableJSONRendering)this.setJSONRecords(this.model.jsonRecords),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON();else if(t.isNullOrUndefined(this.model.dataSource.data)&&this.model.url==""&&!t.isNullOrUndefined(this._pivotClientObj))this.renderControlFromJSON(),this._waitingPopup.hide();else if(this.model.dataSource.data==null&&this.model.url!=""||this.model.dataSource.data!=null&&this.model.url!=""&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)this.model.operationalMode=t.Pivot.OperationalMode.ServerMode,t.isNullOrUndefined(this.model.beforeServiceInvoke)||this._trigger("beforeServiceInvoke",{action:"initialize",element:this.element,customObject:this.model.customObject}),u=JSON.stringify(this.model.customObject),this.model.enableVirtualScrolling&&(this.model.layout=t.PivotGrid.Layout.NoSummaries),this.element[0]!=null&&this.element.parents().find(".e-controlPanel").length>0&&this.layout()!=""&&this.layout()!=t.PivotGrid.Layout.Normal?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",currentReport:this.model.currentReport,gridLayout:this.layout(),customObject:u}),this._renderControlSuccess):this.element[0]!=null&&this.element.parents().find(".e-controlPanel").length>0?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:this.model.enableCellDoubleClick||this.model.enableCellClick||this.model.enableDrillThrough?"initializeGrid:getDataSet":"initializeGrid",currentReport:this.model.currentReport,customObject:u}),this._renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:this.model.enableCellDoubleClick||this.model.enableCellClick||this.model.enableDrillThrough?this.model.enableCollapseByDefault&&(this.model.enablePaging||this.model.enableVirtualScrolling)?"initializeGrid:getDataSet:collapseByDefault":"initializeGrid:getDataSet":this.model.enableCollapseByDefault&&(this.model.enablePaging||this.model.enableVirtualScrolling)?"initializeGrid:collapseByDefault":"initializeGrid",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:u}),this._renderControlSuccess);else if(this.model.operationalMode=t.Pivot.OperationalMode.ClientMode,this.model.dataSource.cube!="")this.model.analysisMode=t.Pivot.AnalysisMode.Olap,this._trigger("beforePivotEnginePopulate",{pivotGridObj:this}),t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this);else if(this.model.dataSource.data!=null){for(r=!1,i=0;i<this.model.dataSource.rows.length;i++)r=this._applyGrouping("rows",i),r&&i--;for(i=0;i<this.model.dataSource.columns.length;i++)r=this._applyGrouping("columns",i),r&&i--;for(i=0;i<this.model.dataSource.values.length;i++)r=this._applyGrouping("values",i),r&&i--;for(i=0;i<this.model.dataSource.filters.length;i++)r=this._applyGrouping("filters",i),r&&i--;this.model.analysisMode=t.Pivot.AnalysisMode.Pivot;t.PivotAnalysis.setFieldCaptions(this.model.dataSource);this._populatePivotGrid()}},_formatChange:function(n,t,i){var u=t.split(i),r;return u[0].indexOf("M")>-1&&u[1].indexOf("d")>-1||u[1].indexOf("M")>-1&&u[2].indexOf("d")>-1?n:u[1].indexOf("M")>-1&&u[0].indexOf("d")>-1?(r=n.split(i),r[1]+i+r[0]+i+r[2]):u[2].indexOf("M")>-1&&u[0].indexOf("d")>-1?(r=n.split(i),r[2]+i+r[0]+i+r[1]):u[2].indexOf("M")>-1&&u[1].indexOf("d")>-1?(r=n.split(i),r[2]+i+r[1]+i+r[0]):u[0].indexOf("M")>-1&&u[2].indexOf("d")>-1?(r=n.split(i),r[0]+i+r[2]+i+r[1]):void 0},_applyGrouping:function(n,i){var u,f;this._rawData=this.model.dataSource.data;var e=this.model.dataSource.data,h=-1,c=!1;for(h=-1,u=0;this.model.dataSource[n][i].format=="date"&&this.model.dataSource[n][i].formatString!=r&&this.model.dataSource[n][i].delimiter!=r&&this.model.dataSource[n][i].groupByDate!=r&&u<this.model.dataSource[n][i].groupByDate.interval.length;u++){var l=this.model.dataSource[n][i].groupByDate.interval[u].indexOf("MM")>-1&&this.model.dataSource[n][i].groupByDate.interval[u].indexOf("dd")==-1?this._getLocalizedLabels("Months"):this.model.dataSource[n][i].groupByDate.interval[u].indexOf("dd")>-1?this._getLocalizedLabels("Days"):this.model.dataSource[n][i].groupByDate.interval[u].indexOf("qq")>-1?this._getLocalizedLabels("Quarters"):this._getLocalizedLabels("Years"),s=this.model.dataSource[n][i].formatString,o=this.model.dataSource[n][i].delimiter,a={fieldName:l+" ("+this.model.dataSource[n][i].fieldName+")",fieldCaption:l+" ("+this.model.dataSource[n][i].fieldName+")"};for(this.model.dataSource[n].push(a),f=0;f<e.length;f++)e[f][a.fieldName]=this.model.dataSource[n][i].groupByDate.interval[u].indexOf("MM")>-1&&this.model.dataSource[n][i].groupByDate.interval[u].indexOf("DD")==-1?t.PivotAnalysis._setFormat(this._formatChange(e[f][this.model.dataSource[n][i].fieldName],s,o),this.model.dataSource[n][i].format,this.model.dataSource[n][i].groupByDate.interval[u]):this.model.dataSource[n][i].groupByDate.interval[u].indexOf("dd")>-1?t.PivotAnalysis._setFormat(this._formatChange(e[f][this.model.dataSource[n][i].fieldName],s,o),this.model.dataSource[n][i].format,this.model.dataSource[n][i].groupByDate.interval[u]):this.model.dataSource[n][i].groupByDate.interval[u].indexOf("qq")>-1?(this.model.dataSource[n][i].groupByDate.interval[u]=="qq"?this._getLocalizedLabels("Qtr")+" "+o:this._getLocalizedLabels("Quarter")+" "+o)+this._getQuarter(this._formatChange(e[f][this.model.dataSource[n][i].fieldName],s,o)):t.PivotAnalysis._setFormat(this._formatChange(e[f][this.model.dataSource[n][i].fieldName],s,o),this.model.dataSource[n][i].format,this.model.dataSource[n][i].groupByDate.interval[u]);h=i}return h!=-1&&(this.model.dataSource[n].splice(i,1),c=!0),c},_getQuarter:function(n){if(jQuery.isNumeric(n))t=new Date((Number(n)-2)*864e5+new Date("01/01/1900").getTime());else if(new Date(n)!="Invalid Date")var t=new Date(n);else t=new Date((Number(0)-2)*864e5+new Date("01/01/1900").getTime());return Math.floor((t.getMonth()+3)/3)},refreshControl:function(){t.Pivot.openPreventPanel(this);this._trigger("beforePivotEnginePopulate",{pivotObject:this});this.model.enableGroupingBar&&this._createGroupingBar(this.model.dataSource);this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(t.PivotAnalysis._controlObj=this,this._pivotEngine=t.PivotAnalysis.pivotEnginePopulate(this.model),this.setJSONRecords(JSON.stringify(this._pivotEngine.json)),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(this._pivotEngine.json):this.renderControlFromJSON(this._pivotEngine.json),this._trigger("renderSuccess",this)):t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)},_setCaptions:function(){n.each(this.model.dataSource.rows,function(n,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)});n.each(this.model.dataSource.columns,function(n,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)});n.each(this.model.dataSource.filters,function(n,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)});n.each(this.model.dataSource.values,function(n,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)})},refreshFieldCaption:function(n,t,i){var r;if(i.indexOf("row")>=0)for(r=0;r<this.model.dataSource.rows.length;r++)n==this.model.dataSource.rows[r].fieldName&&(this.model.dataSource.rows[r].fieldCaption=t);else if(i.indexOf("calc")>=0)for(r=0;r<this.model.dataSource.values.length;r++)n==this.model.dataSource.values[r].fieldName&&(this.model.dataSource.values[r].fieldCaption=t);else if(i.indexOf("col")>=0)for(r=0;r<this.model.dataSource.columns.length;r++)n==this.model.dataSource.columns[r].fieldName&&(this.model.dataSource.columns[r].fieldCaption=t);else for(r=0;r<this.model.dataSource.filters.length;r++)n==this.model.dataSource.filters[r].fieldName&&(this.model.dataSource.filters[r].fieldCaption=t);for(r=0;r<this._pivotTableFields.length;r++)n==this._pivotTableFields[r].name&&(this._pivotTableFields[r].caption=t)},refreshPivotGrid:function(){this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(this.getOlapReport()&&(this.model.dataSource.rows&&(this.model.dataSource.rows=this.getOlapReport().rows),this.model.dataSource.columns&&(this.model.dataSource.columns=this.getOlapReport().columns),this.model.dataSource.filters&&(this.model.dataSource.filters=this.getOlapReport().filters),this.model.dataSource.values&&(this.model.dataSource.values=this.getOlapReport().values)),this.model.editCellsInfo={},this._populatePivotGrid()):(this._trigger("beforePivotEnginePopulate",{olapObject:this}),t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)):this._load()},_populatePivotGrid:function(){var f,r,i,u,e;for(this._trigger("beforePivotEnginePopulate",{pivotObject:this}),f=n(this.element).parents(".e-pivotclient").length>0?n(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,r=n.grep(this.model.dataSource.values,function(n){return n.isCalculatedField==!0}),this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1}),i=0;i<r.length;i++)u=r[i].formula,n.grep(this._calculatedField,function(n){return n.name==r[i].fieldName}).length==0&&(u=u.replace(/\s+|\s+$/gm,""),u=this._parenthesisAsterisk(u),u=u.replace(/[-+/^%*]/g,function(n){return" "+n+" "}),this._calculatedField.push({name:r[i].fieldName,formula:u,format:r[i].format,formatString:r[i].formatString})),r[i].formula=u,this.model.dataSource.values.push(r[i]);t.PivotAnalysis._controlObj=this;e=t.PivotAnalysis.pivotEnginePopulate(this.model);this.setJSONRecords(JSON.stringify(e.json));this.setOlapReport(this.model.dataSource);this._createGroupingBar(this.model.dataSource);this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(e.json):this.renderControlFromJSON();t.isNullOrUndefined(f)||(f._isTimeOut=!1);this._waitingPopup.hide();this._trigger("renderSuccess",this);t.isNullOrUndefined(this._pivotClientObj)||typeof this._pivotClientObj._pivotSchemaDesigner=="undefined"||(this._schemaData=this._pivotClientObj._pivotSchemaDesigner);this._schemaData!=null&&(t.isNullOrUndefined(this._schemaData._waitingPopup)?this._waitingPopup.hide():this._schemaData._waitingPopup.hide(),this._calculatedField.length>0&&this._schemaCalculatedField())},_setFirst:!1,_setModel:function(i){for(var r in i)switch(r){case"OlapReport":this.setOlapReport(i[r]);break;case"JsonData":this.setOlapReport(i[r]);break;case"RefreshOlapGrid":this.element.renderControlFromJSON(i[r]);break;case"layout":this.layout(t.util.getVal(i[r]));this._load();break;case"customObject":this.model.customObject=i[r];break;case"enableCellContext":this.enableCellContext(t.util.getVal(i[r]));this._load();break;case"enableDefaultValue":this.model.enableDefaultValue=i[r];break;case"hyperlinkSettings":!t.isNullOrUndefined(t.util.getVal(i[r]).enableValueCellHyperlink)&&n.isFunction(t.util.getVal(i[r]).enableValueCellHyperlink)?this.enableValueCellHyperlink(i[r].enableValueCellHyperlink()):t.isNullOrUndefined(i[r].enableValueCellHyperlink)||this.enableValueCellHyperlink(i[r].enableValueCellHyperlink);!t.isNullOrUndefined(t.util.getVal(i[r]).enableRowHeaderHyperlink)&&n.isFunction(t.util.getVal(i[r]).enableRowHeaderHyperlink)?this.enableRowHeaderHyperlink(i[r].enableRowHeaderHyperlink()):t.isNullOrUndefined(i[r].enableRowHeaderHyperlink)||this.enableRowHeaderHyperlink(i[r].enableRowHeaderHyperlink);!t.isNullOrUndefined(t.util.getVal(i[r]).enableColumnHeaderHyperlink)&&n.isFunction(t.util.getVal(i[r]).enableColumnHeaderHyperlink)?this.enableColumnHeaderHyperlink(i[r].enableColumnHeaderHyperlink()):t.isNullOrUndefined(i[r].enableColumnHeaderHyperlink)||this.enableColumnHeaderHyperlink(i[r].enableColumnHeaderHyperlink);!t.isNullOrUndefined(t.util.getVal(i[r]).enableSummaryCellHyperlink)&&n.isFunction(t.util.getVal(i[r]).enableSummaryCellHyperlink)?this.enableSummaryCellHyperlink(i[r].enableSummaryCellHyperlink()):t.isNullOrUndefined(i[r].enableSummaryCellHyperlink)||this.enableSummaryCellHyperlink(i[r].enableSummaryCellHyperlink);this._load();break;case"operationalMode":this.model.operationalMode=i[r];break;case"analysisMode":this.model.analysisMode=i[r];break;case"locale":this.locale(t.util.getVal(i[r]));this._load();break;case"dataSource":this.model.dataSource=n.extend({},this.model.dataSource,i[r]);this.refreshControl();this._schemaData&&this._schemaData._load();break;case"enableGroupingBar":this.model.enableGroupingBar=i[r];this._load();break;case"enableDeferUpdate":this.model.enableGroupingBar=i[r];this._load();break;case"enableJSONRendering":this.model.enableJSONRendering=i[r];this._load();break;case"enableVirtualScrolling":this.model.enableVirtualScrolling=i[r];this._load();break;case"enablePaging":this.model.enablePaging=i[r];this._load();break;case"enableColumnResizing":this.model.enableColumnResizing=i[r];this._load();break;case"resizeColumnsToFit":this.model.resizeColumnsToFit=i[r];this.renderControlFromJSON();break;case"enableContextMenu":this.model.enableContextMenu=i[r];this._load();break;case"enableRTL":this.model.enableRTL=i[r];this._load();break;case"enableToolTip":this.model.enableToolTip=i[r];break;case"enableToolTipAnimation":this.model.enableToolTipAnimation=i[r];break;case"enableCellSelection":this.model.enableCellSelection=i[r];this._load();break;case"enableConditionalFormatting":this.model.enableConditionalFormatting=i[r];this._load();break;case"enableCellEditing":this.model.enableCellEditing=i[r];this._load();break;case"enableColumnGrandTotal":this.model.enableColumnGrandTotal=i[r];this._load();break;case"enableRowGrandTotal":this.model.enableRowGrandTotal=i[r];this._load();break;case"enableGrandTotal":this.model.enableGrandTotal=i[r];this._load();break;case"enableCollapseByDefault":this.model.enableCollapseByDefault=i[r];this._load();break;case"enableCellDoubleClick":this.model.enableCellDoubleClick=i[r];this._load();break;case"enableDrillThrough":this.model.enableDrillThrough=i[r];this._load();break;case"isResponsive":this.model.isResponsive=i[r];this._load();break;case"enableAdvancedFilter":this.model.enableAdvancedFilter=i[r];this._load();break;case"showUniqueNameOnPivotButton":this.model.showUniqueNameOnPivotButton=i[r];this._load();break;case"enableMemberEditorPaging":this.model.enableMemberEditorPaging=i[r];this._load();break;case"frozenHeaderSettings":this.model.frozenHeaderSettings=n.extend({},this.model.frozenHeaderSettings,i[r]);this.refreshControl();break;case"valueSortSettings":this.model.valueSortSettings=n.extend({},this.model.valueSortSettings,i[r]);this.refreshControl()}},_wireEvents:function(){if(this.model.enableCellDoubleClick&&this._on(this.element,"dblclick",".value, .summary",this._cellRangeInfo),this.model.enableCellClick&&this._on(this.element,"click",".value, .summary",this._cellRangeInfo),this._on(this.element,"mouseover",".value,.rowheader,.colheader,.summary",t.proxy(function(i){var r,u,f;n(i.target).hasClass("cellValue")||n(i.target).children().hasClass("cellValue")||(r=n(i.target).contents().filter(function(){return this.nodeType==3}),t.isNullOrUndefined(r.text())||n.trim(r.text())==""||(u=n(i.target).find(".valueSorting").length>0?!0:!1,f=u?n(i.target).find(".valueSorting"):"",n(i.target).find(".valueSorting").remove(),n(i.target).contents().filter(function(){return this.nodeType==3}).remove(),n(i.target).append("<span class='cellValue'>"+r.text()+"<\/span>"),u&&(n(i.target).hasClass("colheader")||n(i.target).hasClass("summary"))&&n(i.target).hasClass("calc")&&!n(i.target).hasClass("rowheader")?n(i.target).append(f):""))})),this._on(this.element,"contextmenu",".value,.rowheader,.colheader,.summary",t.proxy(function(i){var o;if(this.model.enableContextMenu&&t.isNullOrUndefined(this._pivotClientObj)&&!this.model.enableCellContext){i.preventDefault();var r="",u="",f="",e="";e=this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?"<li><a>"+this._getLocalizedLabels("Layouts")+"<\/a><ul><li id='normalLayout'><a>"+this._getLocalizedLabels("NormalLayout")+"<\/a><li><li id='excelLikeLayout'><a>"+this._getLocalizedLabels("ExcelLikeLayout")+"<\/a><li><\/ul><\/li>":this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?"<li><a>"+this._getLocalizedLabels("Layouts")+"<\/a><ul><li id='normalLayout'><a>"+this._getLocalizedLabels("NormalLayout")+"<\/a><li><li id='excelLikeLayout'><a>"+this._getLocalizedLabels("ExcelLikeLayout")+"<\/a><li><li id='noSummariesLayout'><a>"+this._getLocalizedLabels("NoSummaries")+"<\/a><li><\/ul><\/li>":"<li><a>"+this._getLocalizedLabels("Layouts")+"<\/a><ul><li id='normalLayout'><a>"+this._getLocalizedLabels("NormalLayout")+"<\/a><li><li id='excelLikeLayout'><a>"+this._getLocalizedLabels("ExcelLikeLayout")+"<\/a><li><li id='noSummariesLayout'><a>"+this._getLocalizedLabels("NoSummaries")+"<\/a><li><li id='normalTopSummaryLayout'><a>"+this._getLocalizedLabels("NormalTopSummary")+"<\/a><li><\/ul><\/li>";r=((this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||this.model.analysisMode==t.Pivot.AnalysisMode.Olap)&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)?"":t.buildTag("li.e-advancedFiltering",t.buildTag("a",this._getLocalizedLabels("AdvancedFiltering"))[0].outerHTML)[0].outerHTML;this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(f=t.buildTag("li.e-collapseByDefault",t.buildTag("a",this._getLocalizedLabels("CollapseByDefault"))[0].outerHTML)[0].outerHTML);this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(u=t.buildTag("li.e-numberFormatting",t.buildTag("a",this._getLocalizedLabels("NumberFormatting"))[0].outerHTML)[0].outerHTML);var s="<li><a>"+this._getLocalizedLabels("HyperLink")+"<\/a><ul><li id='rowHeader'><a>"+this._getLocalizedLabels("EnableRowHeaderHyperlink")+"<\/a><\/li><li id='columnHeader'><a>"+this._getLocalizedLabels("EnableColumnHeaderHyperlink")+"<\/a><\/li><li id='valueCell'><a>"+this._getLocalizedLabels("EnableValueCellHyperlink")+"<\/a><\/li><li id='summaryCell'><a>"+this._getLocalizedLabels("EnableSummaryCellHyperlink")+"<\/a><\/li><\/ul><\/li>",h="<li><a>"+this._getLocalizedLabels("Exporting")+"<\/a><ul><li id='excel'><a>"+this._getLocalizedLabels("Excel")+"<\/a><\/li><li id='word'><a>"+this._getLocalizedLabels("Word")+"<\/a><\/li><li id='pdf'><a>"+this._getLocalizedLabels("PDF")+"<\/a><\/li><li id='csv'><a>"+this._getLocalizedLabels("CSV")+"<\/a><\/li><\/ul><\/li>",c="<li class='e-separator'><a>"+this._getLocalizedLabels("FrozenHeader")+"<\/a><ul><li id='row'><a>"+this._getLocalizedLabels("Row")+"<\/a><\/li><li id='column'><a>"+this._getLocalizedLabels("Column")+"<\/a><\/li><\/ul><\/li>",l=t.buildTag("ul#"+this._id+"contextMenu.e-pivotGridContextMenu",t.buildTag("li.e-cellSelect",t.buildTag("a",this._getLocalizedLabels("CellSelection"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-columnResize",t.buildTag("a",this._getLocalizedLabels("ColumnResize"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-toolTip",t.buildTag("a",this._getLocalizedLabels("ToolTip"))[0].outerHTML)[0].outerHTML+f+r+t.buildTag("li.groupingBar",t.buildTag("a",this._getLocalizedLabels("GroupingBar"))[0].outerHTML)[0].outerHTML+(this.model.analysisMode=="pivot"?t.buildTag("li.e-cellEditing",t.buildTag("a",this._getLocalizedLabels("CellEditing"))[0].outerHTML)[0].outerHTML:"")+t.buildTag("li.e-drillThrough",t.buildTag("a",this._getLocalizedLabels("DrillThrough"))[0].outerHTML)[0].outerHTML+t.buildTag("li.rtl",t.buildTag("a",this._getLocalizedLabels("RTL"))[0].outerHTML)[0].outerHTML+e+s+h+c+t.buildTag("li.e-summaryCustomize",t.buildTag("a",this._getLocalizedLabels("SummaryCustomization"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-conditionalFormat",t.buildTag("a",this._getLocalizedLabels("ConditionalFormatting"),{})[0].outerHTML)[0].outerHTML+(this.model.analysisMode=="pivot"?t.buildTag("li.e-calculatedField",t.buildTag("a",this._getLocalizedLabels("CalculatedField"))[0].outerHTML)[0].outerHTML+u+(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?t.buildTag("li.e-summaryTypes",t.buildTag("a",this._getLocalizedLabels("SummaryTypes"),{})[0].outerHTML)[0].outerHTML:""):""))[0].outerHTML;n("#"+this._id).append(l);n("li.rtl").addClass("e-separator");o=this.element.find(".e-pivotGridTable");this.element.find("#"+this._id+"contextMenu").ejMenu({width:"200px",menuType:t.MenuType.ContextMenu,contextMenuTarget:o,enableRTL:this.model.enableRTL,click:t.proxy(this._contextMenuClick,this)});this._stateMaintenance()}})),this._on(n(document),"keydown",this._keyDownPress),this._on(n(document),"keyup",this._keyUpPress),this._on(this.element.find("a.e-linkPanel"),"click",t.Pivot._editorLinkPanelClick),this.model.enableCellSelection&&(this._on(this.element,"mousedown touchstart",".value",this._initCellSelection),this._on(this.element,"click",".colheader,.rowheader",this._headerClickCellSelection)),this.enableCellContext()==!0&&(document.addEventListener?(document.removeEventListener("contextmenu",this._cellContext,!1),document.addEventListener("contextmenu",this._cellContext,!1)):(document.detachEvent("oncontextmenu",this._cellContext),document.attachEvent("oncontextmenu",this._cellContext))),this._on(this.element,"mouseover",".e-pivotButton",t.proxy(function(n){this._isDragging&&(this.element.append(t.buildTag("span.e-dropIndicator e-dropIndicatorActive")[0].outerHTML),n.target.className.indexOf("e-pivotButton")>=0?this.element.find(".e-dropIndicator").css("top",n.target.getBoundingClientRect().top-20).css("left",n.target.getBoundingClientRect().left-3):this.element.find(".e-dropIndicator").css("top",n.target.parentElement.getBoundingClientRect().top-20).css("left",n.target.parentElement.getBoundingClientRect().left-3))},this)),this._on(this.element,"mouseleave",".e-pivotButton",t.proxy(function(){this._isDragging&&this.element.find(".e-dropIndicator").removeClass("e-dropIndicatorActive")},this)),this._on(this.element,"click","#preventDiv",t.proxy(function(){this.element.find(".e-dialog.e-advancedFilterDlg:visible").length>0&&(this.element.find(".e-dialog.e-advancedFilterDlg").hide(),this.element.find("#preventDiv").remove())},this)),this.model.enableCellEditing&&this._on(this.element,"mousedown",".value",this._initCellEditing),this.drillDownHandler=n.proxy(this._drillDown,this),this.addHyperlinkHandler=n.proxy(this._addHyperlink,this),this.removeHyperlinkHandler=n.proxy(this._removeHyperlink,this),this.model.enableCellSelection){n(document).on("click",this._clearSelection);n(document).on("keyup",this._endCellSelection);n(document).on("keydown",this._startCellSelection)}this._on(this.element,"mouseover",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",this.addHyperlinkHandler);this._on(this.element,"mouseleave",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",this.removeHyperlinkHandler);this._on(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",function(i){if(i.target.className.indexOf("hyperlink")!=-1){var u=this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?n(i.target.parentElement).attr("data-i"):n(i.target.parentElement).attr("data-p"),f=this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelLikeJSONRecords[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Info:this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._excelRowCount+parseInt(u.split(",")[1]))].Info,r={cellValue:i.target.innerHTML,cellPosition:u,cellType:i.target.parentElement.className.split(" ")[0],uniqueName:f.split("::")[0],args:i,rawdata:f};this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&i.target.parentElement.className.indexOf("summary")>=0||i.target.parentElement.className.indexOf("summary value")>=0?t.isNullOrUndefined(this._pivotClientObj)?this._trigger("summaryCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("summaryCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):i.target.parentElement.className.indexOf("value")>=0?t.isNullOrUndefined(this._pivotClientObj)?this._trigger("valueCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("valueCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):i.target.parentElement.className.indexOf("rowheader")>=0?t.isNullOrUndefined(this._pivotClientObj)?this._trigger("rowHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("rowHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):i.target.parentElement.className.indexOf("colheader")>=0&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("columnHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("columnHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}));i.target.parentElement.className.indexOf("value")>=0&&this.model.enableDrillThrough&&(this._rowHeader=[],this._colHeader=[],this.model.analysisMode==t.Pivot.AnalysisMode.Olap?t.Pivot._drillThroughCellClick(i,this):this._cellRangeInfo(i))}});this._on(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?".rowheader, .colheader, .summary":".rowheader, .colheader",function(i){var r,e,s,o,h,u,c,f;if(this.model.enableCellSelection&&!(n(i.target).hasClass("cellValue")&&n(i.target).hasClass("hyperlinkHeaderCell")))if(r=n(i.target).hasClass("cellValue")?i.target.parentElement:i.target,i.shiftKey){if(window.getSelection().removeAllRanges(),n(this.element).find(".e-selected").removeClass("e-selected"),e=n(this._selectedCell).attr("data-p"),s=n(r).attr("data-p"),(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader")&&(n(this._selectedCell).hasClass("rowheader")||n(this._selectedCell).attr("role")=="rowheader"))for(u=Math.min(e.split(",")[1],s.split(",")[1]);u<=Math.max(e.split(",")[1],s.split(",")[1]);u++)this.element.find("[data-p='"+e.split(",")[0]+","+u+"']").addClass("e-selected");if((n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(n(this._selectedCell).hasClass("colheader")||n(this._selectedCell).attr("role")=="columnheader"))for(u=Math.min(e.split(",")[0],s.split(",")[0]);u<=Math.max(e.split(",")[0],s.split(",")[0]);u++)this.element.find("[data-p='"+u+","+e.split(",")[1]+"']").addClass("e-selected");if(o=n(this.element).find(".e-selected"),o.length>0){for(h=[],u=0;u<o.length;u++)c=n(o[u]).attr("data-p"),f=this.getJSONRecords()[parseInt(parseInt(c.split(",")[0])*this._rowCount+parseInt(c.split(",")[1]))],f.Value=n.trim(n(o[u]).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(f.Field=this._getFieldName(o[u])),h.push(f);t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:h}):this._pivotClientObj._trigger("cellSelection",h)}}else i.ctrlKey||n(this.element).find(".e-selected").removeClass("e-selected"),(n(r).hasClass("colheader")||n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).attr("role")=="columnheader")&&(i.ctrlKey?n(r).toggleClass("e-selected"):n(r).addClass("e-selected"),this._selectedCell=r,this._primaryCellPos=n(r).attr("data-p"),f=this.getJSONRecords()[parseInt(parseInt(this._primaryCellPos.split(",")[0])*this._rowCount+parseInt(this._primaryCellPos.split(",")[1]))],f.Value=n.trim(n(r).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(f.Field=this._getFieldName(r)),i.ctrlKey||(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:[f]}):this._pivotClientObj._trigger("cellSelection",{JSONRecords:[f]})))});t.isNullOrUndefined(this._pivotClientObj)?this._on(this.element,"click","table .e-expand,table .e-collapse",t.proxy(this._drillDown,this)):this._pivotClientObj.model.enableDeferUpdate||this._on(this.element,"click","table .e-expand,table .e-collapse",t.proxy(this._drillDown,this));this._on(this.element,"mouseover",".colheader, .rowheader, .e-expand, .e-collapse",function(t){if(t.target.className.indexOf("e-expand")>-1&&!n(t.target).hasClass("header-hover-expand"))n(t.target).addClass("header-hover-expand");else if(t.target.className.indexOf("e-collapse")>-1&&!n(t.target).hasClass("header-hover-collapse"))n(t.target).addClass("header-hover-collapse");else if((t.target.className.indexOf("e-expand")<0||t.target.className.indexOf("e-collapse")<0)&&n(t.target).children("span").length>0){var i=n(t.target).children("span")[0];!n(i).hasClass("header-hover-expand")&&i.className.indexOf("e-expand")>-1?n(i).addClass("header-hover-expand"):!n(i).hasClass("header-hover-collapse")&&i.className.indexOf("e-collapse")>-1&&n(i).addClass("header-hover-collapse")}});this._on(this.element,"mouseleave",".colheader, .rowheader, .e-expand, .e-collapse",function(){this.element.find(".e-expand, .e-collapse").removeClass("header-hover-expand header-hover-collapse")});this.model.enableToolTip&&(this._on(this.element,"mouseover",".value",this._applyToolTip),this._on(this.element,"mouseleave",".value",function(){this.model.enableToolTipAnimation?n("#"+this._id+"_gridTooltip").hide("slow"):n("#"+this._id+"_gridTooltip").hide()}));this.model.enableDrillThrough&&n.proxy(this._addHyperlink,this);this._on(this.element,"click",".filter",t.proxy(this._filterBtnClick,this));this._on(this.element,"click",".e-sorting",t.proxy(this._sortBtnClick,this));this._on(this.element,"click",".e-memberAscendingIcon, .e-memberDescendingIcon",t.proxy(t.Pivot._memberSortBtnClick,this));this._on(this.element,"click",".e-removeBtn",t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._removePvtBtn:this._clientRemovePvtBtn,this));this._on(this.element,"click",".e-ascOrder, .e-descOrder",t.proxy(this._sortField,this));this._on(this.element,"mouseover",".e-pvtBtn",function(t){n(t.target.parentElement).addClass("e-btn e-select")});this._on(this.element,"mouseleave",".e-pvtBtn",function(t){n(t.target.parentElement).removeClass("e-btn e-select");n(t.target).removeClass("e-hoverBtn")});this._on(this.element,"mouseover",".e-pivotButton",function(t){t.target.title=t.target.textContent;n(t.target).find("button").addClass("e-hoverBtn")});this._on(this.element,"mouseleave",".e-pivotButton",function(t){n(t.target).find("button").removeClass("e-hoverBtn")});this._on(this.element,"mouseover",".filter,.e-sorting,.e-removeBtn",function(t){n(t.target.parentElement).find("button").addClass("e-hoverBtn")});this._on(this.element,"mouseleave",".filter,.e-sorting,.e-removeBtn",function(t){n(t.target.parentElement).find("button").removeClass("e-hoverBtn")});this._on(this.element,"mouseleave",".value,.rowheader,.colheader,.summary",t.proxy(function(t){var r=n(t.target).find(".cellValue").contents().filter(function(){return this.nodeType==3}),i,u;r.text()!=0&&(i=n(t.target).find(".valueSorting").length>0?!0:!1,u=i?n(t.target).find(".valueSorting"):"",n(t.target).find(".valueSorting").remove(),n(t.target).find(".cellValue").remove(),n(t.target).append(r.text()),i&&(n(t.target).hasClass("colheader")||n(t.target).hasClass("summary"))&&n(t.target).hasClass("calc")&&!n(t.target).hasClass("rowheader")?n(t.target).append(u):"")}));this._on(this.element,"click",".e-close",t.proxy(function(){this.element.find("#preventDiv").remove()}));this._on(this.element,"click",".e-dialogOkBtn",t.proxy(this._dialogOKBtnClick,this));(this.model.enableContextMenu||n(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen)&&(this._on(this.element,"click",".e-cellSelect",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-columnResize",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-excelLikeLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-advancedFiltering",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-toolTip",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-collapseByDefault",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".rtl",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-calculatedField",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-cellEditing",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-conditionalFormat",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-summaryCustomize",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-summaryTypes",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-numberFormatting",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-rowHeaderHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-colHeaderHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-valueCellHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-summaryCellHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-rowFreeze",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-colFreeze",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-excel",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-word",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-pdf",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".csv",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-normalLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-normalTopSummaryLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-noSummariesLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-drillThrough",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".groupingBar",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-frozenHeaders",t.proxy(this._createMenuIcons,this)),this._on(this.element,"click",".e-exporting",t.proxy(this._createMenuIcons,this)),this._on(this.element,"click",".e-hyperlinkOptions",t.proxy(this._createMenuIcons,this)),this._on(this.element,"click",".e-layouts",t.proxy(this._createMenuIcons,this)),n(document).click(function(t){t.target.className.indexOf("e-hyperlinkOptions")==-1&&n(".e-hyperLinkDialog").remove();t.target.className.indexOf("e-exporting")==-1&&n(".e-exportDialog").remove();t.target.className.indexOf("e-frozenHeaders")==-1&&n(".e-frozenDialog").remove();t.target.className.indexOf("e-layouts")==-1&&n(".e-layoutsDialog").remove()}));this._on(this.element,"click",".e-dialogCancelBtn",t.proxy(function(){this.element.find(".e-dialog, .e-clientDialog").hide();n("#preventDiv").remove()}));this.model.enableColumnResizing&&(this._on(this.element,"mousemove",t.proxy(function(n){this._colResizing(n)})),this._on(this.element,"mousedown","thead,.pivotGridFrozenTable,.pivotGridColValueTable",t.proxy(function(n){this._startColResizing(n)})),this._on(this.element,"mouseup",".e-reSizeColbg",t.proxy(function(n){this._endColResizing(n)})));this._on(this.element,"click",".e-nextPage, .e-prevPage, .e-firstPage, .e-lastPage",t.proxy(this._navigateTreeData,this));this._on(this.element,"click",".e-searchEditorTree",t.proxy(function(n){t.Pivot._searchEditorTreeNodes(n,this)},this));this._on(this.element,"click",".colheader,.cstot,.cgtot,.calc,.stot,.gtot",t.proxy(function(i){var f,r,s,o,e,u;if(n(i.target).hasClass("e-collapse")||n(i.target).hasClass("e-expand"))return!1;if(!t.isNullOrUndefined(this.model.valueSortSettings)&&!t.isNullOrUndefined(this.model.valueSortSettings.sortOrder)&&this.model.valueSortSettings.sortOrder!="none"&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.dataSource.values.length>0||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&JSON.parse(this.getOlapReport()).PivotCalculations.length>0)){if(f=this.model.valueSortSettings.sortOrder,r=n(i.target).hasClass("cellValue")||n(i.target).hasClass("valueSorting")||n(i.target).hasClass("e-expand")||n(i.target).hasClass("e-collapse")?n(i.target).parent():n(i.target),r.hasClass("calc")||(r=n(this.element).find("[data-p='"+(Number(r.attr("data-p").split(",")[0])+Number(r.attr("colspan"))-1)+","+(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns.length:JSON.parse(this.getOlapReport()).PivotColumns.length)+"']")[0]),f=n(r).find(".valueSorting").length>0?n(r).find(".valueSorting").hasClass("descending")?"ascending":"descending":f,this.element.find(".valueSorting").remove(),n(r).find(".valueSorting").length!=0||n(r).hasClass("rowheader")?n(r).find(".valueSorting").removeClass("ascending").removeClass("descending").addClass(f):(s=t.buildTag("span.valueSorting e-icon "+f).css("margin-left","5px").attr("role","button").attr("aria-label","sort")[0].outerHTML,n(r).append(s)),o=JSON.stringify(this.model.customObject),t.PivotAnalysis._valueSorting=Number(n(r).attr("data-p").split(",")[0]),t.PivotAnalysis._sort=f,this._waitingPopup=t.isNullOrUndefined(this._pivotClientObj)?this.element.data("ejWaitingPopup"):this._pivotClientObj.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)this.refreshControl(),t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj.displayMode()=="gridOnly"||(this._pivotClientObj._pivotChart._labelCurrentTags.expandedMembers=null,this._pivotClientObj._pivotChart.setPivotEngine(this._pivotEngine.pivotEngine),this._pivotClientObj._pivotChart._generateData(this._pivotEngine.pivotEngine),this._pivotEngine=null);else{for(e="",u=0;u<this.getJSONRecords().length;u++)Number(this.getJSONRecords()[u].Index.split(",")[0])==t.PivotAnalysis._valueSorting&&Number(this.getJSONRecords()[u].Index.split(",")[1])<JSON.parse(this.getOlapReport()).PivotColumns.length+1&&(e=e==""?this.getJSONRecords()[u].Value.indexOf(".")==-1?this.getJSONRecords()[u].Value:this.getJSONRecords()[u].Value.split(".")[1]:e+this.model.valueSortSettings.headerDelimiters+(this.getJSONRecords()[u].Value.indexOf(".")==-1?this.getJSONRecords()[u].Value:this.getJSONRecords()[u].Value.split(".")[1]));this.model.valueSortSettings.index=t.PivotAnalysis._valueSorting;this.model.valueSortSettings.headerText=e;this.model.valueSortSettings.sortOrder=f;t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.valueSorting,JSON.stringify({action:"valueSorting",valueSorting:JSON.stringify(this.model.valueSortSettings),currentReport:JSON.parse(this.getOlapReport()).Report,customObject:o}),this._renderControlSuccess):this._pivotClientObj.doAjaxPost("POST",this._pivotClientObj.model.url+"/"+this._pivotClientObj.model.serviceMethodSettings.valueSorting,JSON.stringify({action:"valueSorting",valueSorting:JSON.stringify(this.model.valueSortSettings),currentReport:JSON.parse(this._pivotClientObj.getOlapReport()).Report,customObject:o}),this._pivotClientObj._renderControlSuccess);delete this.model.valueSortSettings.index}t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.model.valueSortSettings=this.model.valueSortSettings)}}))},_navigateTreeData:function(n){t.Pivot.editorTreeNavigatee(n,this)},_stateMaintenance:function(){var i=t.buildTag("span.e-enabledState").addClass("e-icon").attr("aria-label",this._getLocalizedLabels("EnabledState"))[0].outerHTML;this.model.dataSource.enableAdvancedFilter&&(this.element.parents(".e-pivotclient").length>0?n(".e-advancedFiltering").addClass("e-enabled"):n(".e-advancedFiltering a:eq(0)").append(i));this.model.enableDrillThrough&&(n(".e-drillThrough a:eq(0)").append(i),n("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CellEditing")));this.element.parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableDrillThrough&&(this.element.find(".e-drillThrough").addClass("e-enabled"),this.element.find(".toolBar").ejToolbar("disableItemByID","cellEditing"));!this.model.enableToolTip||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||(this.element.parents(".e-pivotclient").length>0?n(".e-toolTip").addClass("e-enabled"):n(".e-toolTip a:eq(0)").append(i));this.model.enableCellSelection&&(n(".e-cellSelect a:eq(0)").append(i),n("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CellEditing")));this.model.enableColumnResizing&&(this.element.parents(".e-pivotclient").length>0?(n(".e-columnResize").addClass("e-enabled"),n(".toolBar").ejToolbar("disableItemByID","collapseByDefault")):(n(".e-columnResize a:eq(0)").append(i),n("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CollapseByDefault"))));this.model.enableGroupingBar&&n(".groupingBar a:eq(0)").append(i);this.model.enableRTL&&(this.element.parents(".e-pivotclient").length>0?n(".rtl").addClass("e-enabled"):n(".rtl a:eq(0)").append(i));this.model.enableCollapseByDefault&&(this.element.parents(".e-pivotclient").length>0?(n(".toolBar").ejToolbar("disableItemByID","columnResize"),n(".e-collapseByDefault").addClass("e-enabled")):(n("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("ColumnResize")),n("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("FrozenHeader")),n(".e-collapseByDefault a:eq(0)").append(i)));this.model.enableCellEditing&&(this.element.parents(".e-pivotclient").length>0?(this.element.find(".e-cellEditing").addClass("e-enabled"),this.element.find(".toolBar").ejToolbar("disableItemByID","drillThrough")):n(".e-cellEditing a:eq(0)").append(i),n("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("DrillThrough")),n("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CellSelection")));this.model.frozenHeaderSettings.enableFrozenRowHeaders&&n("li#row a:eq(0)").append(i);this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&n("li#column a:eq(0)").append(i);this.model.hyperlinkSettings.enableRowHeaderHyperlink&&n("li#rowHeader a:eq(0)").append(i);this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&n("li#columnHeader a:eq(0)").append(i);this.model.hyperlinkSettings.enableValueCellHyperlink&&n("li#valueCell a:eq(0)").append(i);this.model.hyperlinkSettings.enableSummaryCellHyperlink&&n("li#summaryCell a:eq(0)").append(i);this.model.layout==t.PivotGrid.Layout.Normal&&n("li#normalLayout a:eq(0)").append(i);this.model.layout==t.PivotGrid.Layout.NoSummaries&&n("li#noSummariesLayout a:eq(0)").append(i);this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout&&n("li#excelLikeLayout a:eq(0)").append(i);this.model.layout==t.PivotGrid.Layout.NormalTopSummary&&n("li#normalTopSummaryLayout a:eq(0)").append(i);(this.model.layout==t.PivotGrid.Layout.NormalTopSummary||this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout||this.model.layout==t.PivotGrid.Layout.NoSummaries||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this.element.parents(".e-pivotclient").length>0?n(".toolBar").ejToolbar("disableItemByID","summaryCustomize"):n("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("SummaryCustomization")))},_contextMenuClick:function(i){var e=t.buildTag("span.e-enabledState").addClass("e-icon").attr("aria-label","")[0].outerHTML,o=this.element.parents(".e-pivotclient").length>0?n(i.target):n(i.element),u,f;(n(i.element).hasClass("e-numberFormatting")||n(i.target).hasClass("e-numberFormatting"))&&this._createMenuDialog(i);(n(i.element).hasClass("e-cellSelect")||n(i.target).hasClass("e-cellSelect"))&&(this.model.enableCellSelection=!this.model.enableCellSelection,this.model.enableCellEditing=!1,this.renderControlFromJSON());(n(i.element).hasClass("e-columnResize")||n(i.target).hasClass("e-columnResize"))&&!this.model.enableCollapseByDefault&&(this.model.enableColumnResizing=!this.model.enableColumnResizing,this.renderControlFromJSON());(n(i.element).hasClass("e-toolTip")||n(i.target).hasClass("e-toolTip"))&&(this.model.enableToolTip=!this.model.enableToolTip,this.renderControlFromJSON());!(n(i.element).hasClass("e-collapseByDefault")||n(i.target).hasClass("e-collapseByDefault"))||this.model.enableColumnResizing||this.model.enableFrozenColumnHeaders||this.model.enableFrozenRowHeaders||(this.model.enableCollapseByDefault?this.model.enableCollapseByDefault=!1:(this.model.enableCollapseByDefault=!0,this.model.collapsedMembers=null),this.renderControlFromJSON());(n(i.element).hasClass("rtl")||n(i.target).hasClass("rtl"))&&(this.model.enableRTL=!this.model.enableRTL,this.renderControlFromJSON());(n(i.element).hasClass("e-calculatedField")||n(i.target).hasClass("e-calculatedField"))&&this._createCalculatedField();(n(i.element).hasClass("e-cellEditing")||n(i.target).hasClass("e-cellEditing"))&&(this.model.enableCellEditing=!this.model.enableCellEditing,this.model.enableDrillThrough=!1,this.model.enableCellSelection=!1,this.renderControlFromJSON());(n(i.element).hasClass("e-drillThrough")||n(i.target).hasClass("e-drillThrough"))&&(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(dialogTitle="Cube Configuration",dialogContent="<p>Please configure cube!<\/p>",u=t.buildTag("div#clientDialog.e-clientDialog",{opacity:"1"}).attr("title",dialogTitle)[0].outerHTML,n(u).appendTo("#"+this._id),n(dialogContent).appendTo(this.element.find(".e-clientDialog")),this.element.find(".e-clientDialog").ejDialog({enableRTL:this.model.enableRTL,width:200,target:"#"+this._id,enableResize:!1,close:t.proxy(t.Pivot.closePreventPanel,this)})):this.element.parents(".e-pivotclient").length>0?(this._pivotClientObj.model.enableDrillThrough=!this._pivotClientObj.model.enableDrillThrough,this.model.enableDrillThrough=this._pivotClientObj.model.enableDrillThrough,this.model.enableCellEditing=!1,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this.renderControlFromJSON():this._pivotClientObj._load()):(this.model.enableDrillThrough=!this.model.enableDrillThrough,this.model.enableCellEditing=!1,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this.renderControlFromJSON():this._load()));(n(i.element).hasClass("e-summaryCustomize")||n(i.target).hasClass("e-summaryCustomize"))&&this._createMenuDialog(i);(n(i.element).hasClass("e-conditionalFormat")||n(i.target).hasClass("e-conditionalFormat"))&&(this.element.parents(".e-pivotclient").length>0&&this._pivotClientObj.model.operationalMode=="clientmode"&&this.setOlapReport(this._pivotClientObj.model.dataSource),this.model.enableConditionalFormatting=!0,this.openConditionalFormattingDialog(),t.Pivot.closePreventPanel(this));(n(i.element).hasClass("e-summaryTypes")||n(i.target).hasClass("e-summaryTypes"))&&this._createMenuDialog(i);(n(i.element).hasClass("e-advancedFiltering")||n(i.target).hasClass("e-advancedFiltering"))&&(this.model.dataSource.enableAdvancedFilter=!this.model.dataSource.enableAdvancedFilter,this.renderControlFromJSON());n(i.element).hasClass("groupingBar")&&(this.model.enableGroupingBar=!this.model.enableGroupingBar,this.renderControlFromJSON());(i.element!="undefined"&&i.parentText==this._getLocalizedLabels("Layouts")||n(i.target).parents().hasClass("e-layoutsDialog"))&&((i.ID=="normalLayout"||n(i.target).hasClass("e-normalLayout"))&&(this.model.layout=t.PivotGrid.Layout.Normal,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="normal")),(i.ID=="excelLikeLayout"||n(i.target).hasClass("e-excelLikeLayout"))&&(this.model.layout=t.PivotGrid.Layout.ExcelLikeLayout,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="excellikelayout")),(i.ID=="noSummariesLayout"||n(i.target).hasClass("e-noSummariesLayout"))&&(this.model.layout=t.PivotGrid.Layout.NoSummaries,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="nosummaries")),(i.ID=="normalTopSummaryLayout"||n(i.target).hasClass("e-normalTopSummaryLayout"))&&(this.model.layout=t.PivotGrid.Layout.NormalTopSummary,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="normaltopsummary")),i.ID=="excelLikeLayout"||n(i.target).hasClass("e-excelLikeLayout")?this.excelLikeLayout(this.getJSONRecords()):(this._excelLikeJSONRecords=null,this.refreshPivotGrid()));(i.element!="undefined"&&i.parentText==this._getLocalizedLabels("HyperLink")||n(i.target).parents().hasClass("e-hyperLinkDialog"))&&((i.ID=="rowHeader"||n(i.target).hasClass("e-rowHeaderHyperLink"))&&(this.model.hyperlinkSettings.enableRowHeaderHyperlink=!this.model.hyperlinkSettings.enableRowHeaderHyperlink),(i.ID=="columnHeader"||n(i.target).hasClass("e-colHeaderHyperLink"))&&(this.model.hyperlinkSettings.enableColumnHeaderHyperlink=!this.model.hyperlinkSettings.enableColumnHeaderHyperlink),(i.ID=="valueCell"||n(i.target).hasClass("e-valueCellHyperLink"))&&(this.model.hyperlinkSettings.enableValueCellHyperlink=!this.model.hyperlinkSettings.enableValueCellHyperlink),(i.ID=="summaryCell"||n(i.target).hasClass("e-summaryCellHyperLink"))&&(this.model.hyperlinkSettings.enableSummaryCellHyperlink=!this.model.hyperlinkSettings.enableSummaryCellHyperlink),this.renderControlFromJSON());(i.element!=r&&i.parentText==this._getLocalizedLabels("Exporting")||n(i.target).parents().hasClass("e-exportDialog"))&&(f=this.element.parents(".e-pivotclient").length>0?n(i.target).attr("class").split(" ")[0]:i.ID,this.element.parents(".e-pivotclient").length>0&&!t.isNullOrUndefined(this._pivotClientObj)&&(this.model.beforeExport=this._pivotClientObj.model.beforeExport),this.exportPivotGrid(f,"Sample"));(i.element!=r&&i.parentText==this._getLocalizedLabels("FrozenHeader")||n(i.target).parents().hasClass("e-frozenDialog"))&&((i.ID=="row"||n(i.target).hasClass("e-rowFreeze"))&&(this.model.frozenHeaderSettings.enableFrozenRowHeaders=this.model.frozenHeaderSettings.enableFrozenRowHeaders?!1:!0),(i.ID=="column"||n(i.target).hasClass("e-colFreeze"))&&(this.model.frozenHeaderSettings.enableFrozenColumnHeaders=this.model.frozenHeaderSettings.enableFrozenColumnHeaders?!1:!0),this.renderControlFromJSON());this._unWireEvents();this._wireEvents()},_createMenuIcons:function(i){var u,r,f,e;n(i.target).hasClass("e-exporting")&&(u=t.buildTag("div.e-exportDialog#exportDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-excel e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("Excel"),title:this._getLocalizedLabels("Excel"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-word e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("Word"),title:this._getLocalizedLabels("Word"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-pdf e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("PDF"),title:this._getLocalizedLabels("PDF"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.csv e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("CSV"),title:this._getLocalizedLabels("CSV"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,this.element.find("div .e-exportDialog").length==0&&(n(u).appendTo(this.element),n(".e-exportDialog").css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px")));n(i.target).hasClass("e-hyperlinkOptions")&&(r=t.buildTag("div.e-hyperLinkDialog#hyperLinkTypesDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-rowHeaderHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableRowHeaderHyperlink"),title:this._getLocalizedLabels("EnableRowHeaderHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-colHeaderHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableColumnHeaderHyperlink"),title:this._getLocalizedLabels("EnableColumnHeaderHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-valueCellHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableValueCellHyperlink"),title:this._getLocalizedLabels("EnableValueCellHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-summaryCellHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableSummaryCellHyperlink"),title:this._getLocalizedLabels("EnableSummaryCellHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),this.element.find("div.e-hyperLinkDialog").length==0&&(n(r).appendTo(this.element),n(r).css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"),this.model.hyperlinkSettings.enableRowHeaderHyperlink&&this.element.find(".e-rowHeaderHyperLink").addClass("e-enabled"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&this.element.find(".e-colHeaderHyperLink").addClass("e-enabled"),this.model.hyperlinkSettings.enableValueCellHyperlink&&this.element.find(".e-valueCellHyperLink").addClass("e-enabled"),this.model.hyperlinkSettings.enableSummaryCellHyperlink&&this.element.find(".e-summaryCellHyperLink").addClass("e-enabled")));n(i.target).hasClass("e-frozenHeaders")&&(f=t.buildTag("div.e-frozenDialog#frozenDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-rowFreeze e-frozenHeaderIcons").attr({"aria-label":this._getLocalizedLabels("Row"),title:this._getLocalizedLabels("Row"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-colFreeze e-frozenHeaderIcons").attr({"aria-label":this._getLocalizedLabels("Column"),title:this._getLocalizedLabels("Column"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,this.element.find("div.e-frozenDialog").length==0&&(n(f).appendTo(this.element),n(".e-frozenDialog").css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"),this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.element.find(".e-rowFreeze").addClass("e-enabled"),this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.element.find(".e-colFreeze").addClass("e-enabled"),this.model.frozenHeaderSettings.enableFrozenHeaders&&this.element.find(".bothFreeze").addClass("e-enabled")));n(i.target).hasClass("e-layouts")&&(e=t.buildTag("div.e-layoutsDialog#layoutsDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-normalLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("NormalLayout"),title:this._getLocalizedLabels("NormalLayout"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-excelLikeLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("ExcelLikeLayout"),title:this._getLocalizedLabels("ExcelLikeLayout"),tabindex:0})[0].outerHTML)[0].outerHTML+(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?t.buildTag("td",t.buildTag("div.e-noSummariesLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("NoSummaries"),title:this._getLocalizedLabels("NoSummaries"),tabindex:0})[0].outerHTML)[0].outerHTML:"")+(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?t.buildTag("td",t.buildTag("div.e-normalTopSummaryLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("NormalTopSummary"),title:this._getLocalizedLabels("NormalTopSummary"),tabindex:0})[0].outerHTML)[0].outerHTML:""))[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,this.element.find("div .e-layoutsDialog").length==0&&(n(e).appendTo(this.element),n(".e-layoutsDialog").css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"),this.model.layout==t.PivotGrid.Layout.Normal&&this.element.find(".e-normalLayout").addClass("e-enabled"),this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout&&this.element.find(".e-excelLikeLayout").addClass("e-enabled"),this.model.layout==t.PivotGrid.Layout.NoSummaries&&this.element.find(".e-noSummariesLayout").addClass("e-enabled"),this.model.layout==t.PivotGrid.Layout.NormalTopSummary&&this.element.find(".e-normalTopSummaryLayout").addClass("e-enabled")))},_createMenuDialog:function(i){var c,e,l,a,v,o,s,f,u,h,b,k,d,g;if(this._dialogName=t.isNullOrUndefined(i.target)?n(i.element).attr("class").split(" ")[0]:n(i.target).attr("class").split(" ")[0],t.Pivot.openPreventPanel(this),this.element.find(".e-dialog").remove(),c=t.buildTag("div#clientDialog.e-clientDialog",{opacity:"1"})[0].outerHTML,e=currentTag=dialogContent="",n(i.target).hasClass("e-numberFormatting")||n(i.element).hasClass("e-numberFormatting")){for(e=this._getLocalizedLabels("NumberFormatting"),currentTag="Number Formatting",l=t.buildTag("label",this._getLocalizedLabels("Measures"))[0].outerHTML,f="<select id='measureOption'>",u=0;u<this.model.dataSource.values.length;u++)f+="<option>"+this.model.dataSource.values[u].fieldName+"<\/option>";f+="<\/select>";a=t.buildTag("label",this._getLocalizedLabels("NumberFormats"))[0].outerHTML;v="<div class='summarTypes'><select id='numberFormatOption'><option value='Decimal'>Decimal<\/option><option value='Currency'>Currency<\/option><option value='Percentage'>Percentage<\/option><option value='Number'>Number<\/option><option value='Date'>Date<\/option><option value='Time'>Time<\/option><option value='Scientific'>Scientific<\/option><option value='Fraction'>Fraction<\/option><\/select><\/div>";dialogContent=t.buildTag("div#reportDlg.e-reportDlg","<table><tr><td>"+l+"<\/td><td>"+f+"<\/td><\/tr><tr><td>"+a+"<\/td><td>"+v+"<\/td><\/tr><\/table>")[0].outerHTML}if(n(i.target).hasClass("e-summaryCustomize")||n(i.element).hasClass("e-summaryCustomize")){e=this._getLocalizedLabels("SummaryCustomization");var s=t.buildTag("label",this._getLocalizedLabels("HideGrandTotal"))[0].outerHTML,h=t.buildTag("label",this._getLocalizedLabels("HideSubTotal"))[0].outerHTML,f="<div class='measures'><select id='hideSubTotal'>";if(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){for(u=0;u<this.model.dataSource.columns.length;u++)f+="<option>"+this.model.dataSource.columns[u].fieldCaption+"<\/option>";for(u=0;u<this.model.dataSource.rows.length;u++)f+="<option>"+this.model.dataSource.rows[u].fieldCaption+"<\/option>"}else if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){for(o=n(this.element).parents(".e-pivotclient").length>0?this._pivotClientObj.getOlapReport():this.getOlapReport(),u=0;u<JSON.parse(o).PivotRows.length;u++)f+="<option>"+JSON.parse(o).PivotRows[u].FieldName+"<\/option>";for(u=0;u<JSON.parse(o).PivotColumns.length;u++)f+="<option>"+JSON.parse(o).PivotColumns[u].FieldName+"<\/option>"}f+="<\/div>";var y=t.buildTag("input#rowSumCheckBox.rowSumCheckBox","",{},{name:"row",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.rowGrndlabel",this._getLocalizedLabels("Row"))[0].outerHTML+"<br/>",p=t.buildTag("input#colSumCheckBox.colSumCheckBox","",{},{name:"column",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.colGrndlabel",this._getLocalizedLabels("Column"))[0].outerHTML+"<br/>",w=t.buildTag("input#bothSumCheckBox.bothSumCheckBox","",{},{name:"both",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.bothGrndlabel",this._getLocalizedLabels("Both"))[0].outerHTML+"<br/>";dialogContent=this.model.analysisMode=="pivot"?t.buildTag("div#customizeDlg.customizeDlg","<table><tr><td style='vertical-align:top'>"+s+"<\/td><td>"+y+p+w+"<\/td><\/tr><tr><td>"+h+"<\/td><td>"+f+"<\/td><\/tr><\/table>")[0].outerHTML:t.buildTag("div#customizeDlg.customizeDlg","<table><tr><td>"+s+"<\/td><td>"+y+p+w+"<\/td><\/tr><\/table>")[0].outerHTML}if(n(i.target).hasClass("e-summaryTypes")||n(i.element).hasClass("e-summaryTypes")){if(e=this._getLocalizedLabels("SummaryTypes"),s=t.buildTag("label",this._getLocalizedLabels("Measures"))[0].outerHTML,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){for(f="<div class='measures'><select id='drillMeasure'>",u=0;u<this.model.dataSource.values.length;u++)f+="<option>"+this.model.dataSource.values[u].fieldCaption+"<\/option>";f+="<\/div>"}h=t.buildTag("label",this._getLocalizedLabels("SummaryType"))[0].outerHTML;b=t.buildTag("input#drillSum").attr("type","text")[0].outerHTML;dialogContent=t.buildTag("div#summaryDlg.#summaryDlg","<table><tr><td>"+s+"<\/td><td>"+f+"<\/td><\/tr><tr><td>"+h+"<\/td><td>"+b+"<\/td><\/tr><\/table>")[0].outerHTML}k=t.buildTag("div#EditorDiv.e-editorDiv","",{"margin-left":"5px"})[0].outerHTML;dialogContent+=k;d="<button id=OKBtn class='e-dialogOkBtn'>"+this._getLocalizedLabels("OK")+"<\/button>";g="<button id=CancelBtn class='e-dialogCancelBtn'>"+this._getLocalizedLabels("Cancel")+"<\/button>";dialogFooter=t.buildTag("div.e-dialogFooter",d+g,{float:this.model.enableRTL?"left":"right",margin:"20px 0px 6px"})[0].outerHTML;n(c).appendTo("#preventDiv");n(dialogContent+dialogFooter).appendTo(".e-clientDialog");n(".e-clientDialog").ejDialog({enableRTL:this.model.enableRTL,width:"auto",target:"#"+this._id,enableResize:!1,close:t.Pivot.closePreventPanel(this)});n(".e-titlebar").prepend(t.buildTag("div",e,{display:"inline"})[0].outerHTML)[0];n(".e-dialogOkBtn, .e-dialogCancelBtn").ejButton({width:"67px",enableRTL:this.model.enableRTL,type:t.ButtonType.Button});n(".e-dialogOkBtn, .e-dialogCancelBtn").css({"margin-left":"10px"});this._selectedFormat==""&&this._selectedMeasure==""&&(n("#numberFormatOption").ejDropDownList({enableRTL:this.model.enableRTL,selectedIndex:0,create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}}),n("#measureOption").ejDropDownList({enableRTL:this.model.enableRTL,selectedIndex:0,showCheckbox:!0,create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}}));this._selectedMeasure!=""&&this._selectedFormat!=""&&(n("#numberFormatOption").ejDropDownList({enableRTL:this.model.enableRTL,text:this._selectedFormat,create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}}),n("#measureOption").ejDropDownList({enableRTL:this.model.enableRTL,text:this._selectedMeasure,showCheckbox:!0,create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}}));n("#categoricalInput").ejMaskEdit({name:"mask",inputMode:t.InputMode.Text,watermarkText:"Column Page Size"});n("#seriesInput").ejMaskEdit({name:"mask",inputMode:t.InputMode.Text,watermarkText:"Row Page Size"});n("#rowSumCheckBox,#colSumCheckBox,#bothSumCheckBox").ejCheckBox({size:"small",showRoundedCorner:!0});this.rowCheckBox=n("#rowSumCheckBox").data("ejCheckBox");this.colCheckBox=n("#colSumCheckBox").data("ejCheckBox");this.bothCheckBox=n("#bothSumCheckBox").data("ejCheckBox");(n(i.target).hasClass("e-summaryCustomize")||n(i.element).hasClass("e-summaryCustomize"))&&(this.rowGrand==!1&&this.rowCheckBox.setModel({checked:"checked"}),this.colGrand==!1&&this.colCheckBox.setModel({checked:"checked"}),this.bothGrand==!1&&this.bothCheckBox.setModel({checked:"checked"}),n("#hideSubTotal").ejDropDownList({showCheckbox:!0,enableRTL:this.model.enableRTL,create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}}),this.dropmeasure=n("#hideSubTotal").data("ejDropDownList"),this.selval!=r&&this.dropmeasure.setModel({value:this.selval}));(n(i.target).hasClass("e-summaryTypes")||n(i.element).hasClass("e-summaryTypes"))&&(n("#_summaryOK,#_summaryCancel").ejButton({enableRTL:this.model.enableRTL}),n("#drillMeasure").ejDropDownList({selectedIndices:[0],enableRTL:this.model.enableRTL,create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}}),n("#drillSum").ejDropDownList({dataSource:[{option:"Sum",value:this._getLocalizedLabels("Sum")},{option:"Average",value:this._getLocalizedLabels("Average")},{option:"Count",value:this._getLocalizedLabels("Count")},{option:"Min",value:this._getLocalizedLabels("Min")},{option:"Max",value:this._getLocalizedLabels("Max")}],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}}),drilmes=n("#drillMeasure").data("ejDropDownList"),drilsum=n("#drillSum").data("ejDropDownList"),this.drilsumval!=r&&drilmes.setModel({value:this.drilsumval}),this.sumtyp!=null&&drilsum.setModel({value:this.sumtyp}))},_dialogOKBtnClick:function(){var o,f,e,i,h,s,c,l,u,a;if(this._dialogName=="e-numberFormatting"){for(this._selectedFormat=n("#numberFormatOption").ejDropDownList("getSelectedValue"),this._selectedMeasure=n("#measureOption").ejDropDownList("getSelectedValue"),o=this._selectedMeasure.split(","),this.element.find(".e-dialog").remove(),t.Pivot.closePreventPanel(this),u=0;u<this.model.dataSource.values.length;u++)for(f=0;f<o.length;f++)this.model.dataSource.values[u].fieldName==o[f]&&(this.model.dataSource.values[u].format=this._selectedFormat.toLowerCase());t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj.model.analysisMode!="pivot"||this._pivotClientObj.model.operationalMode!="clientmode"||(this.model.collapsedMembers=null);this._populatePivotGrid()}if(this._dialogName=="e-summaryCustomize"&&(pGridObj=this,t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj.model.analysisMode!="pivot"||this._pivotClientObj.model.operationalMode!="clientmode"||(pGridObj.model.collapsedMembers=null),pGridObj.rowCheckBox.model.checked?(pGridObj.model.enableColumnGrandTotal=pGridObj.model.enableGrandTotal=!0,pGridObj.model.enableRowGrandTotal=pGridObj.rowGrand=!1):pGridObj.model.enableRowGrandTotal=pGridObj.rowGrand=!0,pGridObj.colCheckBox.model.checked?(pGridObj.model.enableRowGrandTotal=pGridObj.model.enableGrandTotal=!0,pGridObj.model.enableColumnGrandTotal=pGridObj.colGrand=!1):pGridObj.model.enableColumnGrandTotal=pGridObj.colGrand=!0,pGridObj.bothCheckBox.model.checked||pGridObj.colCheckBox.model.checked&&pGridObj.rowCheckBox.model.checked?(pGridObj.model.enableRowGrandTotal=pGridObj.model.enableColumnGrandTotal=!0,pGridObj.model.enableGrandTotal=pGridObj.bothGrand=!1):pGridObj.model.enableGrandTotal=pGridObj.bothGrand=!0,n("#hideSubTotal").ejDropDownList("getSelectedValue")!=null&&this.model.analysisMode=="pivot"&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(pGridObj.selval=n("#hideSubTotal").ejDropDownList("getSelectedValue"),e=n("#hideSubTotal").ejDropDownList("getSelectedValue").split(","),pGridObj.model.dataSource.rows.length>0&&n.each(pGridObj.model.dataSource.rows,function(n,t){t.fieldName.length>0&&(t.showSubTotal=!0)}),pGridObj.model.dataSource.columns.length>0&&n.each(pGridObj.model.dataSource.columns,function(n,t){t.fieldName.length>0&&(t.showSubTotal=!0)}),n.each(e,function(t,i){pGridObj.model.dataSource.rows.length>0&&n.each(pGridObj.model.dataSource.rows,function(n,t){t.fieldName.length>0&&t.fieldName==i&&(t.showSubTotal=!1)});pGridObj.model.dataSource.columns.length>0&&n.each(pGridObj.model.dataSource.columns,function(n,t){t.fieldName.length>0&&t.fieldName==i&&(t.showSubTotal=!1)})}),pGridObj._populatePivotGrid()):this.model.analysisMode=="pivot"&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(pGridObj.selval=n("#hideSubTotal").ejDropDownList("getSelectedValue"),e=n("#hideSubTotal").ejDropDownList("getSelectedValue").split(","),i=n(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()):JSON.parse(pGridObj.getOlapReport()),i.PivotRows.length>0&&n.each(i.PivotRows,function(n,t){t.FieldName.length>0&&(t.showSubTotal=!0)}),i.PivotColumns.length>0&&n.each(i.PivotColumns,function(n,t){t.FieldName.length>0&&(t.showSubTotal=!0)}),n.each(e,function(t,r){i.PivotRows.length>0&&n.each(i.PivotRows,function(n,t){t.FieldName.length>0&&t.FieldName==r&&(t.showSubTotal=!1)});i.PivotColumns.length>0&&n.each(i.PivotColumns,function(n,t){t.FieldName.length>0&&t.FieldName==r&&(t.showSubTotal=!1)})}),h={JsonRecords:JSON.stringify(pGridObj.getJSONRecords()),PivotReport:JSON.stringify(i)},pGridObj._renderControlSuccess(h)):pGridObj._load(),t.Pivot.closePreventPanel(this)),this._dialogName=="e-summaryTypes"){if(n("#drillSum").val()!=r&&(this.drilsumval=n("#drillMeasure").ejDropDownList("getSelectedValue"),s=this.sumtyp=n("#drillSum").val(),s!=null&&(c=s.toLowerCase()),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)){for(l=n("#drillMeasure").ejDropDownList("getSelectedValue").split(",").length,u=0;u<l;u++)a=n("#drillMeasure").ejDropDownList("getSelectedValue").split(",")[u],n.grep(this.model.dataSource.values,function(n){return n.fieldName==a})[0].summaryType=c;t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj.model.analysisMode!="pivot"||this._pivotClientObj.model.operationalMode!="clientmode"||(this.model.collapsedMembers=null);this._populatePivotGrid()}t.Pivot.closePreventPanel(this)}},_keyUpPress:function(t){if(t.which===16&&this.model.enableCellSelection&&(this._completeCellSelection(t),n("#"+this._id).find(".value").removeClass("e-hoverCell"),this._startPosCell=null,this._startCellPosition=null),t.which===13&&this.model.enableCellEditing&&!this.model.enableCellSelection&&n("#"+this._id).find(".value.e-hoverCell").length){n("#"+this._id).find(".value.e-hoverCell").trigger("mouseover");this._startCellPosition=n(n("#"+this._id).find(".value.e-hoverCell")).attr("data-p");var i={target:n("#"+this._id).find(".value.e-hoverCell > span")[0]};this._completeCellEditing(i);t.preventDefault();n("#"+this._id).find(".value.e-hoverCell .curInput").focus();n("#"+this._id).find(".value").removeClass("e-hoverCell")}},_keyDownPress:function(i){var c,f,u,o,r,s,e,v,a,l;if(n(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&((document.activeElement.id=="Pager_CategCurrentPage"||document.activeElement.id=="Pager_SeriesCurrentPage")&&(i.which===35?(i.preventDefault(),document.activeElement.id=="Pager_CategCurrentPage"?n(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveLast").first().trigger("click"):document.activeElement.id=="Pager_SeriesCurrentPage"&&n(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveLast").last().trigger("click")):i.which==36&&(i.preventDefault(),document.activeElement.id=="Pager_CategCurrentPage"?n(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .moveFirst").first().trigger("click"):document.activeElement.id=="Pager_SeriesCurrentPage"&&n(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .moveFirst").last().trigger("click")),i.which===39?document.activeElement.id=="Pager_CategCurrentPage"?n(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveNext").first().trigger("click"):document.activeElement.id=="Pager_SeriesCurrentPage"&&n(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveNext").last().trigger("click"):i.which===37&&(document.activeElement.id=="Pager_CategCurrentPage"?n(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-movePrevious").first().trigger("click"):document.activeElement.id=="Pager_SeriesCurrentPage"&&n(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-movePrevious").last().trigger("click"))),i.stopImmediatePropagation()),i.which!==27||t.isNullOrUndefined(this._curFocus.grp)&&(t.isNullOrUndefined(this._curFocus.tab)||!this._curFocus.tab.hasClass("e-pivotButton"))?i.which===27&&(this._index.dialog=0):(this._curFocus.tab.mouseleave().removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("e-pivotButton")&&(l=this._curFocus.tab.attr("data-tag"),a=this._curFocus.tab=n("#"+this._id).find("[data-tag='"+l+"']")):(l=this._curFocus.grp.attr("data-tag"),a=this._curFocus.grp=n("#"+this._id).find("[data-tag='"+l+"']")),a.mouseover().addClass("e-hoverCell").focus(),this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._index.field=0),i.which===70&&i.ctrlKey&&(i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".filter").click():this._curFocus.grp.find(".filter").click()),i.which===83&&i.ctrlKey&&(i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(this._curFocus.tab.find(".e-sorting").click(),l=this._curFocus.tab.attr("data-tag"),a=this._curFocus.tab=n("#"+this._id).find("[data-tag='"+l+"']")):(this._curFocus.grp.find(".e-sorting").click(),l=this._curFocus.grp.attr("data-tag"),a=this._curFocus.grp=n("#"+this._id).find("[data-tag='"+l+"']")),a.mouseover().addClass("e-hoverCell").focus()),(i.which===46||i.which===82&&i.ctrlKey)&&(i.which!=46&&i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".e-removeBtn").click():this._curFocus.grp.find(".e-removeBtn").click()),i.shiftKey&&t.isNullOrUndefined(this._startPosCell)&&(this._startCellPosition=i.target.getAttribute("data-p"),this._startPosCell=i.target.getAttribute("data-p")),i.which===39&&n("#"+this._id).find(".e-dialog .e-hoverCell").length>0?n("#"+this._id).find(".e-dialog .e-hoverCell").parent().find(".e-plus").click():i.which===37&&n("#"+this._id).find(".e-dialog .e-hoverCell").length>0&&n("#"+this._id).find(".e-dialog .e-hoverCell").parent().find(".e-minus").click(),(i.which===40||i.which===39||i.which===38||i.which===37)&&i.shiftKey&&this.model.enableCellSelection){if(n("#"+this._id).find(".e-hoverCell").removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.attr("tabindex","0"),c=n(i.target),i.which=="40")for(f=c.attr("data-p"),u=parseInt(f.split(",")[1])+Number(c.attr("rowspan"));t.isNullOrUndefined(o)&&u<this._rowCount;)r=n(n("#"+this._id)).find("[data-p='"+f.split(",")[0]+","+u+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r),this._curFocus.selection=n(o),u++;else if(i.which=="38")for(f=c.attr("data-p"),u=parseInt(f.split(",")[1])-1;t.isNullOrUndefined(o)&&u>=0;)r=n(n("#"+this._id)).find("[data-p='"+f.split(",")[0]+","+u+"']")[0],t.isNullOrUndefined(r)&&(r=n(n("#"+this._id)).find("[data-p='"+(parseInt(f.split(",")[0])-1)+","+u+"']")[0]),!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r),this._curFocus.selection=n(o),u--;else if(i.which=="39")for(f=c.attr("data-p"),u=parseInt(f.split(",")[0])+Number(c.attr("colspan"));t.isNullOrUndefined(o)&&u<Math.ceil(this.getJSONRecords().length/this._rowCount);)r=n(n("#"+this._id)).find("[data-p='"+u+","+f.split(",")[1]+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r),this._curFocus.selection=n(o),u++;else if(i.which=="37"){for(var f=c.attr("data-p"),u=parseInt(f.split(",")[0])-1,o=n(n("#"+this._id)).find("[data-p='"+(parseInt(f.split(",")[0])-1)+","+f.split(",")[1]+"']")[0];t.isNullOrUndefined(o)&&u>=0;)r=n(n("#"+this._id)).find("[data-p='"+u+","+f.split(",")[1]+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r),u--;this._curFocus.selection=n(o)}if(this._curFocus.selection.attr("tabindex","-1").focus().addClass("e-hoverCell"),Number(this._startCellPosition.split(",")[0])<=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])<=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(u=Number(this._startCellPosition.split(",")[0]);u<=Number(this._curFocus.selection.attr("data-p").split(",")[0]);u++)for(h=Number(this._startCellPosition.split(",")[1]);h<=Number(this._curFocus.selection.attr("data-p").split(",")[1]);h++)n("#"+this._id).find("[data-p='"+u+","+h+"']").hasClass("value")&&n("#"+this._id).find("[data-p='"+u+","+h+"']").addClass("e-hoverCell");else if(Number(this._startCellPosition.split(",")[0])>=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])>=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(u=Number(this._startCellPosition.split(",")[0]);u>=Number(this._curFocus.selection.attr("data-p").split(",")[0]);u--)for(h=Number(this._startCellPosition.split(",")[1]);h>=Number(this._curFocus.selection.attr("data-p").split(",")[1]);h--)n("#"+this._id).find("[data-p='"+u+","+h+"']").hasClass("value")&&n("#"+this._id).find("[data-p='"+u+","+h+"']").addClass("e-hoverCell");else if(Number(this._startCellPosition.split(",")[0])<=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])>=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(u=Number(this._startCellPosition.split(",")[0]);u<=Number(this._curFocus.selection.attr("data-p").split(",")[0]);u++)for(h=Number(this._startCellPosition.split(",")[1]);h>=Number(this._curFocus.selection.attr("data-p").split(",")[1]);h--)n("#"+this._id).find("[data-p='"+u+","+h+"']").hasClass("value")&&n("#"+this._id).find("[data-p='"+u+","+h+"']").addClass("e-hoverCell");else if(Number(this._startCellPosition.split(",")[0])>=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])<=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(u=Number(this._startCellPosition.split(",")[0]);u>=Number(this._curFocus.selection.attr("data-p").split(",")[0]);u--)for(h=Number(this._startCellPosition.split(",")[1]);h<=Number(this._curFocus.selection.attr("data-p").split(",")[1]);h++)n("#"+this._id).find("[data-p='"+u+","+h+"']").hasClass("value")&&n("#"+this._id).find("[data-p='"+u+","+h+"']").addClass("e-hoverCell")}else if((i.which===40||i.which===38||i.which===37||i.which===39)&&n("#"+this._id).find(".e-calcFormulaDiv:visible").length>0)i.preventDefault(),s=n("#"+this._id).find(".e-calcFormulaDiv td:visible"),t.isNullOrUndefined(this._curFocus.formula)?(this._index.formula=i.which==39?0:i.which==37?s.length-1:0,this._curFocus.formula=s.eq(this._index.formula).addClass("e-hoverCell").mouseover()):(this._curFocus.formula.removeClass("e-hoverCell").mouseleave(),i.which===39?this._index.formula=this._index.formula+1>s.length-1?0:this._index.formula+1:i.which===37?this._index.formula=this._index.formula-1<0?s.length-1:this._index.formula-1:i.which===40?this._index.formula=this._index.formula+4>s.length-1?(this._index.formula+4)%10:this._index.formula+4:i.which===38&&(this._index.formula=this._index.formula-4<0?this._index.formula- -16:this._index.formula-4),this._curFocus.formula=s.eq(this._index.formula).addClass("e-hoverCell").mouseover());else if((i.keyCode===40||i.which===38)&&n("#"+this._id).find(".e-dialog:visible").length>0&&!t.isNullOrUndefined(n("#"+this._id).find(".e-dialog .e-text"))&&n(".e-dialog .e-text").hasClass("e-hoverCell"))n("#"+this._id).find(".e-dialog .e-hoverCell").removeClass("e-hoverCell"),i.preventDefault(),s=n("#"+this._id).find(".e-dialog .e-text:visible"),t.isNullOrUndefined(this._curFocus.filter)?(this._index.filter=i.which==40?1:i.which==38?s.length-1:0,this._curFocus.filter=s.eq(this._index.filter).attr("tabindex","-1")):(this._curFocus.filter.attr("tabindex","0").removeClass("e-hoverCell"),i.which===40?this._index.filter=this._index.filter+1>s.length-1?0:this._index.filter+1:i.which===38&&(this._index.filter=this._index.filter-1<0?s.length-1:this._index.filter-1),this._curFocus.filter=s.eq(this._index.filter).attr("tabindex","-1")),this._curFocus.filter.focus().addClass("e-hoverCell"),n(".e-node-focus").removeClass("e-node-focus");else if((i.which===40||i.which===38||i.which===37||i.which===39)&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("e-pivotButton")&&!n(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&!n("#"+this._id).find(".e-dialog:visible").length>0)i.preventDefault(),t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().attr("tabindex","0").removeClass("e-hoverCell"),s=n("#"+this._id).find(".e-pivotButton"),t.isNullOrUndefined(this._curFocus.grp)?i.which===40||i.which===39?this._curFocus.grp=s.eq(1).attr("tabindex","-1"):(i.which===38||i.which===37)&&(this._curFocus.grp=s.eq(s.length-1).attr("tabindex","-1")):(this._curFocus.grp.attr("tabindex","0").removeClass("e-hoverCell").mouseleave(),i.which===40||i.which===39?this._index.grp=this._index.grp+1>s.length-1?0:this._index.grp+1:(i.which===38||i.which===37)&&(this._index.grp=this._index.grp-1<0?s.length-1:this._index.grp-1),this._curFocus.grp=s.eq(this._index.grp)),this._curFocus.grp.addClass("e-hoverCell").mouseover().focus();else if((i.which===40||i.which===38||i.which===37||i.which===39)&&!n(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&(document.activeElement.getAttribute("role")=="columnheader"||document.activeElement.getAttribute("role")=="rowheader"||document.activeElement.getAttribute("role")=="gridcell")){if(t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.attr("tabindex","0"),t.isNullOrUndefined(this._curFocus.cell)||(this._curFocus.cell.attr("tabindex","0").removeClass("e-hoverCell"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&this._curFocus.cell.find("span").mouseleave()),this._index.menu=0,this._curFocus.cmenu=null,c=n(i.target),i.which=="40")for(f=c.attr("data-p"),u=parseInt(f.split(",")[1])+Number(c.attr("rowspan"));t.isNullOrUndefined(o)&&u<=this._rowCount;){if(r=n("#"+this._id).find("[data-p='"+f.split(",")[0]+","+u+"']")[0],t.isNullOrUndefined(r))for(k=parseInt(f.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[data-p='"+k+","+u+"']")[0]);!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r);t.isNullOrUndefined(o)||(this._curFocus.cell=n(o));u++}else if(i.which=="38")for(var f=c.attr("data-p"),u=parseInt(f.split(",")[1])-1,o,h=parseInt(f.split(",")[0]);t.isNullOrUndefined(o)&&u>=0;){if(r=n("#"+this._id).find("[data-p='"+f.split(",")[0]+","+u+"']")[0],t.isNullOrUndefined(r)&&(c.attr("role")=="gridcell"||c.hasClass("summary")&&c.hasClass("calc")))for(k=parseInt(f.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[data-p='"+h+","+k+"']")[0]);if(t.isNullOrUndefined(r))for(k=parseInt(f.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[data-p='"+k+","+u+"']")[0]);!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r);t.isNullOrUndefined(o)||n(o).hasClass("e-grpRow")||(this._curFocus.cell=n(o));u--;h--}else if(i.which=="39")for(f=c.attr("data-p"),u=parseInt(f.split(",")[0])+Number(c.attr("colspan"));t.isNullOrUndefined(o)&&u<=Math.ceil((Number(n("#"+this._id).find(".e-pivotGridTable td:last").attr("data-p").split(",")[0])+1)*(Number(n("#"+this._id).find(".e-pivotGridTable td:last").attr("data-p").split(",")[1])+1)/this._rowCount);){if(r=n("#"+this._id).find("[data-p='"+u+","+f.split(",")[1]+"']")[0],t.isNullOrUndefined(r))for(k=parseInt(f.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[data-p='"+u+","+k+"']")[0]);!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r);t.isNullOrUndefined(o)||(this._curFocus.cell=n(o));u++}else if(i.which=="37"){for(var f=c.attr("data-p"),u=parseInt(f.split(",")[0])-1,o=n("#"+this._id).find("[data-p='"+(parseInt(f.split(",")[0])-1)+","+f.split(",")[1]+"']")[0],h=parseInt(f.split(",")[1]);t.isNullOrUndefined(o)&&u>=0;){if(r=n("#"+this._id).find("[data-p='"+u+","+f.split(",")[1]+"']")[0],t.isNullOrUndefined(r)&&c.attr("role")=="gridcell")for(k=parseInt(f.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[data-p='"+k+","+h+"']")[0]);if(t.isNullOrUndefined(r))for(k=parseInt(f.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(r)&&(r=n("#"+this._id).find("[data-p='"+u+","+k+"']")[0]);!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"||n(r).hasClass("value")||n(r).attr("role")=="gridcell")&&(o=r);u--;h--}t.isNullOrUndefined(o)||n(o).hasClass("e-grpRow")||(this._curFocus.cell=n(o))}t.isNullOrUndefined(this._curFocus.cell)||(n(".e-hoverCell").removeClass("e-hoverCell"),this._curFocus.cell.attr("tabindex","-1").focus().addClass("e-hoverCell"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&(this._curFocus.cell.mouseover(),this._curFocus.cell.find("span").mouseover()))}else i.which==40&&n(".e-list").hasClass("e-hoverCell")&&n("#"+this._id).find(".e-hoverCell").removeClass("e-hoverCell");if(i.which===9&&n("#"+this._id).find(".colheader.e-hoverCell")&&(this._curFocus.cell=n("#"+this._id).find(".colheader.e-hoverCell")),(i.which===9&&i.shiftKey||i.which===9)&&n("#"+this._id).find("#"+this._id+"_clientDlg_wrapper :visible").length>0?(i.preventDefault(),s=n("#"+this._id+"_editCon_hidden").hasClass("e-disable")||n("#"+this._id+"_conTo").attr("disabled")=="disabled"?n("#"+this._id+"_conTo").attr("disabled")!="disabled"?n("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_conFrom,#"+this._id+"_conTo,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):n("#"+this._id+"_editCon_hidden").hasClass("e-disable")?n("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):n("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_editCon_wrapper,#"+this._id+"_removeBtn,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):n("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_editCon_wrapper,#"+this._id+"_removeBtn,#"+this._id+"_conFrom,#"+this._id+"_conTo,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"),t.isNullOrUndefined(this._curFocus.cformat)?(this._index.cformat=1,this._curFocus.cformat=s.eq(this._index.cformat).attr("tabindex","-1")):(this._curFocus.cformat.attr("tabindex","0").removeClass("e-hoverCell"),i.which===9&&i.shiftKey?this._index.cformat=this._index.cformat-1<0?s.length-1:this._index.cformat-1:i.which===9&&(this._index.cformat=this._index.cformat+1>s.length-1?0:this._index.cformat+1),this._curFocus.cformat=s.eq(this._index.cformat).attr("tabindex","-1")),this._curFocus.cformat.focus().addClass("e-hoverCell")):(i.which===9&&i.shiftKey||i.which===9)&&n("#"+this._id).find(".e-dlgCalculatedField:visible").length>0?(i.preventDefault(),n("#"+this._id).find(".e-calcFormulaDiv:visible").length>0&&n("#"+this._id).find(".e-calcFormulaDiv").css("display","none"),e=[],e.push(n("#"+this._id).find("#"+this._id+"_calculateFieldName:visible")),e.push(n("#"+this._id).find("#"+this._id+"_calculateFieldList_dropdown:visible")),e.push(n("#"+this._id).find(".calculatorFields:visible")),e.push(n("#"+this._id).find(".editFormula:visible")),e.push(n("#"+this._id).find("#"+this._id+"_fieldCollection_container:visible")),n("#"+this._id).find("#"+this._id+"_btnInsert:visible:not([aria-disabled='true'])").length>0&&e.push(n("#"+this._id).find("#"+this._id+"_btnInsert:visible:not([aria-disabled='true'])")),e.push(n("#"+this._id).find("#"+this._id+"_btnAdd:visible")),e.push(n("#"+this._id).find("#"+this._id+"_btnDelete:visible")),e.push(n("#"+this._id).find("#"+this._id+"_btnOk:visible")),e.push(n("#"+this._id).find("#"+this._id+"_btnCancel:visible")),t.isNullOrUndefined(this._curFocus.field)?(this._index.field=e.length>5?6:0,this._curFocus.field=e[this._index.field].attr("tabindex","-1")):(this._curFocus.field.attr("tabindex","0").removeClass("e-hoverCell").blur(),i.which===9&&i.shiftKey?this._index.field=this._index.field-1<0?e.length-1:this._index.field-1:i.which===9&&(this._index.field=this._index.field+1>e.length-1?0:this._index.field+1),this._curFocus.field=e[this._index.field].attr("tabindex","-1")),this._curFocus.field.focus().addClass("e-hoverCell")):(i.which===9&&i.shiftKey||i.which===9)&&n("#"+this._id).find(".e-dialog:visible").length>0?(i.preventDefault(),n("#"+this._id).find(".e-dialog .e-hoverCell").removeClass("e-hoverCell"),this._curFocus.filter=null,this._index.filter=0,e=n("#"+this._id).find(".e-dialogOKBtn:visible:not([aria-disabled='true']),.e-dialogCancelBtn:visible,.e-close:visible,#GroupLabelDrop_wrapper:visible,.filterElementTag:visible,.e-dialog .e-text:visible:first,.filterValues:visible,#filterMeasures_wrapper:visible,#filterOptions_wrapper:visible,#filterValue1:visible,#filterValue2:visible,.searchEditorTreeView"),t.isNullOrUndefined(this._curFocus.tree)?(this._index.dialog=this.model.dataSource.enableAdvancedFilter?1:2,this._curFocus.tree=e.eq(this._index.dialog).attr("tabindex","-1").focus()):(this._curFocus.tree.attr("tabindex","0").removeClass("e-hoverCell"),i.which===9&&i.shiftKey?this._index.dialog=this._index.dialog-1<0?e.length-1:this._index.dialog-1:i.which===9&&(this._index.dialog=this._index.dialog+1>e.length-1?0:this._index.dialog+1),this._curFocus.tree=e.eq(this._index.dialog).attr("tabindex","-1").focus()),this._curFocus.tree.hasClass("filterElementTag")?this._curFocus.tree.find(".e-list:first:visible").addClass("e-hoverCell"):this._curFocus.tree.addClass("e-hoverCell")):(i.which===9&&i.shiftKey||i.which===9)&&!n(".e-dialog:visible").length>0&&t.isNullOrUndefined(this._pivotClientObj)&&(i.preventDefault(),n("#"+this._id).find(".e-hoverCell").removeClass("e-hoverCell"),t.isNullOrUndefined(this._schemaData)||n("#"+this._schemaData._id).find(".e-hoverCell").removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)||this._curFocus.grp.mouseleave(),this._index.field=0,this._index.grp=1,this._index.cell=1,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,t.isNullOrUndefined(this._schemaData)||t.isNullOrUndefined(this._schemaData._curFocus)||(this._schemaData._curFocus.tree=null,this._schemaData._curFocus.node=null,this._schemaData._curFocus.button=null),this._curFocus.field=null,this._curFocus.cell=null,this._curFocus.grp=null,this._curFocus.tree=null,this._curFocus.cmenu=null,this._curFocus.cformat=null,this._curFocus.selection=null,e=[],this.model.enableGroupingBar&&n("#"+this._id).find(".e-pivotButton:visible").first().length>0&&e.push(n("#"+this._id).find(".e-pivotButton:visible").first()),n(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&n("[role='columnheader']:visible:not([p='0,0'])").first().length>0?e.push(n("[role='columnheader']:visible:not([p='0,0'])").first()):n("#"+this._id).find("[role='columnheader']:visible").first().length>0&&e.push(n("[role='columnheader']:not('.e-grpRow'):visible:first")),!t.isNullOrUndefined(this._schemaData)&&n("#"+this._schemaData._id).find(".e-text:visible").first().length>0&&e.push(n("#"+this._schemaData._id).find(".e-text:visible").first()),!t.isNullOrUndefined(this._schemaData)&&n("#"+this._schemaData._id).find(".e-pvtBtn:visible").first().length>0&&e.push(n("#"+this._schemaData._id).find(".e-pvtBtn:visible").first()),n(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&n("#Pager_CategCurrentPage:visible").length>0&&e.push(n("#Pager_CategCurrentPage:visible")),n(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&n("#Pager_SeriesCurrentPage:visible").length>0&&e.push(n("#Pager_SeriesCurrentPage:visible")),t.isNullOrUndefined(this._curFocus.tab)?this._curFocus.tab=e[0].attr("tabindex","-1"):(this._curFocus.tab.attr("tabindex","0").removeClass("e-hoverCell"),this._curFocus.tab.hasClass("e-active")&&this._curFocus.tab.removeClass("e-active"),t.isNullOrUndefined(this._schemaData)||(n("#"+this._schemaData._id).find(".e-active").removeClass("e-active"),n("#"+this._schemaData._id).find(".e-node-hover").removeClass("e-node-hover"),n("#"+this._schemaData._id).find(".e-node-focus").removeClass("e-node-focus")),this._curFocus.tab.hasClass("e-node-hover")&&this._curFocus.tab.removeClass("e-node-hover"),this._curFocus.tab.mouseleave(),i.which===9&&i.shiftKey?this._index.index=this._index.index-1<0?e.length-1:this._index.index-1:i.which===9&&(this._index.index=this._index.index+1>e.length-1?0:this._index.index+1),this._curFocus.tab=e[this._index.index].attr("tabindex","-1")),this._curFocus.tab.focus().addClass("e-hoverCell").mouseover(),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&(this._curFocus.tab.mouseover(),this._curFocus.tab.find("span").mouseover()),n(".e-node-focus").removeClass("e-node-focus"),i.stopImmediatePropagation()),i.which===93&&!n(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&this.model.enableGroupingBar&&(!t.isNullOrUndefined(this._curFocus.grp)||!t.isNullOrUndefined(this._curFocus.tab))&&(i.preventDefault(),document.activeElement.className.startsWith("e-pivotButton")&&(t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(v={x:n(this._curFocus.tab).offset().left+n(this._curFocus.tab).outerWidth(),y:n(this._curFocus.tab).offset().top+n(this._curFocus.tab).outerHeight()},this._curFocus.tab.find("button").trigger({type:"mouseup",which:3,clientX:v.x,clientY:v.y,pageX:v.x,pageY:v.y})):(v={x:n(this._curFocus.grp).offset().left+n(this._curFocus.grp).outerWidth(),y:n(this._curFocus.grp).offset().top+n(this._curFocus.grp).outerHeight()},this._curFocus.grp.find("button").trigger({type:"mouseup",which:3,clientX:v.x,clientY:v.y,pageX:v.x,pageY:v.y})))),i.which===13&&this.model.hyperlinkSettings.enableColumnHeaderHyperlink)t.isNullOrUndefined(this._curFocus.cell)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".cellValue").click():this._curFocus.cell.find(".cellValue").click();else if(i.which==13&&!n(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&!n(".e-waitpopup-pane:visible").length>0){if(n("#"+this._id).find(".e-dialog:visible").length>0){if(n(i.target).hasClass("e-memberCurrentPage")||n(i.target).hasClass("e-memberCurrentSearchPage")||n(i.target).hasClass("e-memberCurrentDrillPage")){t.Pivot.editorTreeNavigatee(i,this);return}if(n(i.target).hasClass("searchEditorTreeView")){t.Pivot._searchEditorTreeNodes(i,this);return}}n("#"+this._id).find(".e-dialog .e-hoverCell").length>0&&n("#"+this._id).find(".e-dialog .e-hoverCell").hasClass("e-text")?n("#"+this._id).find(".e-dialog .e-hoverCell").parent().find(".e-chkbox-small").click():document.activeElement.className.startsWith("e-pivotGridTable")||document.activeElement.getAttribute("role")=="rowheader"||document.activeElement.getAttribute("role")=="columnheader"?t.isNullOrUndefined(this._curFocus.cell)?t.isNullOrUndefined(this._curFocus.tab)||(this._curFocus.tab.find(".e-expand").length>0?this._curFocus.tab.find(".e-expand").click():this._curFocus.tab.find(".e-collapse").length>0&&this._curFocus.tab.find(".e-collapse").click(),this._curFocus.tab=n("#"+this._id).find("[role='"+this._curFocus.tab.attr("role")+"']:contains('"+this._curFocus.tab.text()+"'):visible").first(),this._curFocus.tab.attr("tabindex","-1").focus().addClass("e-hoverCell")):this._curFocus.cell.find(".e-expand,.e-collapse").length>0?(this._curFocus.cell.find(".e-expand,.e-collapse").click(),this._curFocus.cell.removeClass("e-hoverCell").attr("tabindex","0"),this._curFocus.cell=n("#"+this._id).find("[role='"+this._curFocus.cell.attr("role")+"']:contains('"+this._curFocus.cell.text()+"'):visible").first(),this._curFocus.cell.attr("tabindex","-1").focus().addClass("e-hoverCell")):(this._curFocus.cell.click(),this._curFocus.cell.removeClass("e-hoverCell").attr("tabindex","0"),this._curFocus.cell=n("#"+this._id).find("[data-p='"+this._curFocus.cell.attr("data-p")+"']"),this._curFocus.cell.attr("tabindex","-1").focus().addClass("e-hoverCell")):t.isNullOrUndefined(this._curFocus.tree)&&t.isNullOrUndefined(this._curFocus.formula)&&(t.isNullOrUndefined(this._curFocus.field)||!this._curFocus.field.hasClass("editFormula"))||n("#"+this._id).find(".e-dialog .e-hoverCell:visible").length>0&&(n("#"+this._id).find(".e-dialog .e-hoverCell:visible").click(),this._index.tree=1);n(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.attr("tabindex","-1").focus()}i.keyCode==79&&n("#"+this._id).find(".e-dialog").length>0&&i.ctrlKey&&(i.preventDefault(),n("#"+this._id).find(".e-dialogOKBtn:visible").click(),this._index.field=0,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._curFocus.tree=null,t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(l=this._curFocus.tab.attr("data-tag"),a=this._curFocus.tab=n("#"+this._id).find("[data-tag='"+l+"']")):(l=this._curFocus.grp.attr("data-tag"),a=this._curFocus.grp=n("#"+this._id).find("[data-tag='"+l+"']")),t.isNullOrUndefined(a)||a.mouseover().addClass("e-hoverCell").focus());i.keyCode==67&&n("#"+this._id).find(".e-dialog:visible").length>0&&i.ctrlKey&&(i.preventDefault(),n("#"+this._id).find(".e-dialogCancelBtn:visible").click(),this._index.field=0,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._curFocus.tree=null,t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(l=this._curFocus.tab.attr("data-tag"),a=this._curFocus.tab=n("#"+this._id).find("[data-tag='"+l+"']")):(l=this._curFocus.grp.attr("data-tag"),a=this._curFocus.grp=n("#"+this._id).find("[data-tag='"+l+"']")),t.isNullOrUndefined(a)||a.mouseover().addClass("e-hoverCell").focus())},_unWireEvents:function(){this._off(this.element,"mousedown",".value",this._initCellEditing);this._off(this.element,"click",".colheader,.cstot,.cgtot,.calc,.stot,.gtot");this._off(n(document),"keydown",this._keyDownPress);this._off(n(document),"keyup",this._keyUpPress);this._off(this.element.find("a.e-linkPanel"),"click",t.Pivot._editorLinkPanelClick);this._off(this.element,"click","#preventDiv");this._off(this.element,"click","table .e-expand,table .e-collapse");this._off(this.element,"dblclick",".value, .summary");this._off(this.element,"click",".value, .summary");this._off(this.element,"mouseover",".colheader, .rowheader, .e-expand, .e-collapse");this._off(this.element,"mouseleave",".colheader, .rowheader, .e-expand, .e-collapse");this._off(this.element,"mouseover",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary",this.addHyperlinkHandler);this._off(this.element,"mouseleave",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary",this.removeHyperlinkHandler);this._off(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary");this._off(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue");this._off(this.element,"mouseover",".value");this._off(this.element,"mouseleave",".value");this._off(this.element,"mousedown touchstart",".value");this._off(this.element,"mouseup touchend",".value");this._off(this.element,"click",".filter");this._off(this.element,"click",".e-sorting");this._off(this.element,"click",".e-removeBtn");this._off(this.element,"mouseover",".e-pvtBtn");this._off(this.element,"mouseleave",".e-pvtBtn");n(document).off("keyup",this._endCellSelection);n(document).off("keydown",this._startCellSelection);n(document).off("click",this._clearSelection);this._off(this.element,"click",".calculatedFieldPopup .menuItem ");this._off(this.element,"contextmenu",".values .e-pivotButton");this._off(this.element,"click",".filter",t.proxy(this._filterBtnClick,this));this._off(this.element,"click",".e-sorting",t.proxy(this._sortBtnClick,this));this._off(this.element,"click",".e-memberAscendingIcon, .e-memberDescendingIcon",t.proxy(t.Pivot._memberSortBtnClick,this));this._off(this.element,"click",".e-removeBtn",t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._removePvtBtn:this._clientRemovePvtBtn,this));this._off(this.element,"click",".e-ascOrder, .e-descOrder");this._off(this.element,"click",".clearAllFilters, .clearSorting");this._off(this.element,"contextmenu");this._off(this.element,"click",".e-dialogOkBtn");this._off(this.element,"click",".e-cellSelect");this._off(this.element,"click",".e-columnResize");this._off(this.element,"click",".e-excelLikeLayout");this._off(this.element,"click",".e-advancedFiltering");this._off(this.element,"click",".e-toolTip");this._off(this.element,"click",".e-collapseByDefault");this._off(this.element,"click",".rtl");this._off(this.element,"click",".e-calculatedField");this._off(this.element,"click",".e-cellEditing");this._off(this.element,"click",".groupingBar");this._off(this.element,"click",".e-conditionalFormat");this._off(this.element,"click",".e-summaryCustomize");this._off(this.element,"click",".e-summaryTypes");this._off(this.element,"click",".e-numberFormatting");this._off(this.element,"click",".e-rowHeaderHyperLink");this._off(this.element,"click",".e-colHeaderHyperLink");this._off(this.element,"click",".e-valueCellHyperLink");this._off(this.element,"click",".e-summaryCellHyperLink");this._off(this.element,"click",".e-rowFreeze");this._off(this.element,"click",".e-colFreeze");this._off(this.element,"click",".bothFreeze");this._off(this.element,"click",".e-excel");this._off(this.element,"click",".e-word");this._off(this.element,"click",".e-pdf");this._off(this.element,"click",".csv");this._off(this.element,"click",".e-frozenHeaders");this._off(this.element,"click",".e-exporting");this._off(this.element,"click",".e-layouts");this._off(this.element,"click",".e-hyperlinkOptions");this._off(this.element,"click",".e-normalLayout");this._off(this.element,"click",".e-normalTopSummaryLayout");this._off(this.element,"click",".e-noSummariesLayout");this._off(this.element,"click",".e-drillThrough");this._off(this.element,"mousedown touchstart",".value",this._initCellSelection);this._off(this.element,"click",".colheader,.rowheader",this._headerClickCellSelection);this._off(this.element,"click",".e-nextPage, .e-prevPage, .e-firstPage, .e-lastPage");this._off(this.element,"click",".e-searchEditorTree")},_getFieldName:function(i){var r;if(n(i).hasClass("colheader")||n(i).attr("role")=="columnheader"){var u=parseInt(n(i).attr("data-p").split(",")[1]),f=t.isNullOrUndefined(this.model.dataSource.data)||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(n(this.element).parents(".e-pivotclient").length>0||n(this.element).parents(".e-fullScreenView").length>0)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns:JSON.parse(this.getOlapReport()).PivotColumns:this.model.dataSource.columns,e=i.textContent.replace("expanded","");return u<f.length?this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?f[u].fieldName:f[u].FieldName:e}if(n(i).hasClass("rowheader")||n(i).attr("role")=="rowheader")return r=parseInt(n(i).attr("data-p").split(",")[0]),t.isNullOrUndefined(this.model.dataSource.data)||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(this.element.parents(".e-pivotclient").length>0||this.element.parents(".e-fullScreenView").length>0)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows[r].FieldName:JSON.parse(this.getOlapReport()).PivotRows[r].FieldName:t.isNullOrUndefined(this.model.dataSource.rows)?"":this.model.dataSource.rows[r].fieldName},_colResizing:function(t){var o,f;if(this.model.enableColumnResizing)if(this._expand){var i=t.clientX,s=t.clientY,u=this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable").first()[0].getBoundingClientRect();u.left+document.documentElement.scrollLeft+u.width<i||i<u.left+document.documentElement.scrollLeft?this.element.find(".e-reSizeColbg").remove():this._currentCell!=-1&&this.element.find(".e-reSizeColbg").css({left:i,top:this._tableY})}else{if(this.element.find(".e-reSizeColbg").is(":visible"))return;if(n(t.target).attr("role")=="columnheader"){var e=this.resCell=t.target,r=e.getBoundingClientRect(),i=t.clientX,s=t.clientY;o=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(".pivotGridFrozenTable,.pivotGridColValueTable").width()+n(".pivotGridFrozenTable,.pivotGridColValueTable").find("tr").offset().left:n(this.element).find("thead").width()+n(this.element).find("thead tr").offset().left;(i>=r.left+document.documentElement.scrollLeft+e.offsetWidth-5||i<=r.left+3)&&i<o&&i>=r.left&&s<=r.top+document.documentElement.scrollTop+t.target.offsetHeight?(i>r.left+3?(f=n(t.target).find("span"),this._currentCell=t.target):(f=n(t.target).prevAll("th:visible:first").find("span"),this._currentCell=n(t.target).prev()),f.length&&n(t.target).parents(".e-pivotGridTable tr").css("cursor","col-resize")):(n(t.target).parent("tr").css("cursor","pointer"),this._currentCell=null)}else this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable tr").css("cursor","pointer"),this._currentCell=null}},_startColResizing:function(t){var i,o,c,f,s,u;if(n(t.target).closest("tr").css("cursor")=="col-resize"&&(i=t.clientX,o=t.clientY,this._target=t.target,this._orgX=i,i+=document.documentElement.scrollLeft,t.button!=2))if(c=n(this._target).parent("tr").find("[role='columnheader']"),this._currentCell!=null&&(f=n(this._currentCell)[0].getBoundingClientRect()),s=this._tableY=(f==r?0:f.top)+document.documentElement.scrollTop,n(this._target).closest("tr").css("cursor")=="col-resize"){var h=n(document.createElement("div")),e=this.model.enableGroupingBar?this.element.height()-this.element.find(".groupingBarPivot").height():this.model.enableVirtualScrolling?this.element.height()-this.element.find(".e-hScrollPanel").parent().height():this.element.height(),l=this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable").find("tr[role='row']"),a=n(this._target).parent("tr")[0]==r?0:n(this._target).parent("tr")[0].rowIndex;for(u=0;u<a;u++)e=e-n(l[u]).height();h.addClass("e-reSizeColbg").appendTo(this.element).attr("unselectable","on").css("visibility","hidden");h.css({visibility:"visible",height:e+"px",cursor:"col-resize",left:i,top:s,position:"fixed"});this._orgX=i;this._orgY=o;this._expand=!0}else this._currentCell=null},_endColResizing:function(i){var h,k,p,w,u,f,r,a,v,s,y,b,o;if(this._expand&&(h=i.clientX,k=i.clientY),this.element.find(".e-reSizeColbg").remove(),h+=document.documentElement.scrollLeft,p=n(this._target).parents("thead,.pivotGridFrozenTable,.pivotGridColValueTable"),this._currentCell!=null&&this._expand){w=30;this._expand=!1;var e=this._currentCell,d=n(e)[0].offsetWidth,c=h-this._orgX,l=(this.model.frozenHeaderSettings.enableFrozenHeaders||!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&this._JSONRecords[0].CSS=="none";if(parseInt(c)+parseInt(d)>w&&c!=0){for(p.css("cursor","default"),f=0;f<2;f++)if(r=f==0?n(e):n(e).next(),a=f==0?parseInt(n(e).attr("colspan")):parseInt(n(e).next().attr("colspan")),r.length){if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)if(this.element.find(".e-pivotGridTable").find("[role='columnheader']").find(".e-expand").length>1||this.element.find(".e-pivotGridTable").find("[role='columnheader']").find(".e-collapse").length>1)if(l)u=parseInt(this.element.find(".pivotGridFrozenTable thead tr:last").find("[data-p^='"+r.attr("data-p").split(",")[0]+"']").index());else if(this.model.enableAdvancedFilter){for(v=0,s=0;s<parseInt(r.attr("data-p").split(",")[0]);s++)this.element.find(".e-pivotGridTable thead tr:last th:eq("+s+")").css("display")=="none"&&v++;u=parseInt(r.attr("data-p").split(",")[0])-(v+(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._JSONRecords[0].ColSpan-1:0))}else u=parseInt(this.element.find(".e-pivotGridTable thead tr:last").find("[data-p^='"+r.attr("data-p").split(",")[0]+"']").index())+(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?1:this._JSONRecords[0].ColSpan);else u=l?parseInt(r.attr("data-p").split(",")[0])-this._JSONRecords[0].ColSpan:this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?t.isNullOrUndefined(r.attr("data-i"))?parseInt(r.attr("data-p").split(",")[0]):parseInt(r.attr("data-i").split(",")[0]):parseInt(r.attr("data-p").split(",")[0]);else u=l?parseInt(r.attr("data-p").split(",")[0])-this._JSONRecords[0].ColSpan:this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?parseInt(r.attr("data-i").split(",")[0]):parseInt(r.attr("data-p").split(",")[0]);y=Math.round(c/a);b=this.element.find("col:eq("+u+")").width()+(f==0?y:-y);this._setWidthColResize(u,a,b)}this.element.find("tr").css("cursor","default")}}this.model.enableGroupingBar&&(this._createFields(null,n("#"+this._id).find(".e-pivotGridTable").width(),n("#"+this._id).find(".e-pivotGridTable th").outerWidth()),this.element.find(".groupingBarPivot").css({overflow:"hidden"}));(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(o=this.element.find(".e-scroller").data("ejScroller"),t.isNullOrUndefined(o)||o.refresh());!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders&&(o=this.element.find(".e-scroller").data("ejScroller"),o.model.enableTouchScroll=!1);this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.element.find("#coltable").width()<this.element.find(".valScrollArea").width()&&this.element.find("#coltable").width(this.element.find(".valScrollArea").width());this._target=null;this.element.find(".e-reSizeColbg").remove();this._expand=!1;this._currentCell=null},_setWidthColResize:function(n,t,i){for(var u=30,f=i>u?i:u,r=n;r<n+t;r++)this.element.find("colgroup").find("col:eq("+r+")").outerWidth(f)},_resizeColumnsWidth:function(){var u,e,r,f,o,i;if(!this.model.frozenHeaderSettings.enableFrozenHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!t.isNullOrUndefined(this._JSONRecords)){if(this.model.enableAdvancedFilter||this.element.find(".e-pivotGridTable").find("colgroup").remove(),u=n("<colgroup><\/colgroup>"),(this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode||t.isNullOrUndefined(this.model.dataSource.columns)||this.model.dataSource.columns.length!=0&&this.model.dataSource.columns.length!=1)&&(this.model.operationalMode!=t.Pivot.OperationalMode.ServerMode||t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotColumns)||JSON.parse(this.getOlapReport()).PivotColumns.length!=0&&JSON.parse(this.getOlapReport()).PivotColumns.length!=1))for(i=0;i<this._JSONRecords.length/this._rowCount;i++){if(t.isNullOrUndefined(this.element.find(".e-pivotGridTable tbody tr:first").children(":visible")[i]))break;f="<col style='width:"+this.element.find(".e-pivotGridTable tbody tr:first").children(":visible")[i].offsetWidth/Number(n(this.element.find(".e-pivotGridTable tbody tr:first").children(":visible")[i]).attr("colspan"))+"px'><\/col>";u.append(f)}else for(i=0;i<this.element.find(".e-pivotGridTable thead tr:first th").length;i++)for(e=0;e<Number(this.element.find(".e-pivotGridTable thead tr:first th:eq("+i+")").attr("colspan"));e++)r=this.element.find(".e-pivotGridTable thead tr:first th:eq("+i+")"),f="<col style='width:"+(t.isNullOrUndefined(r.offsetWidth)?r.outerWidth():r.offsetWidth)/Number(r.attr("colspan"))+"px'><\/col>",u.append(f);if(this.model.enableAdvancedFilter&&this.element.find(".e-pivotGridTable").find("colgroup").remove(),this.element.find(".e-pivotGridTable").prepend(u),this.model.enableColumnResizing&&this.model.resizeColumnsToFit&&this.element.find(".e-pivotGridTable").css("width","100%"),this.model.enableGroupingBar){if(o=this.element.find(".groupingBarPivot .values").width()>this.element.find(".e-grpRow .e-rows").width()?this.element.find(".groupingBarPivot .values").width():this.element.find(".e-grpRow .e-rows").width(),this._JSONRecords.length>0&&this._JSONRecords[0].ColSpan>=1&&!this.model.resizeColumnsToFit)for(i=0;i<this._JSONRecords[0].ColSpan;i++)this.element.find("colgroup col:eq("+i+")").css("width",o/this._JSONRecords[0].ColSpan);this.element.find(".groupingBarPivot .values").width()<this.element.find(".e-grpRow .e-rows").width()&&this.element.find(".groupingBarPivot .values").css("width",this.element.find(".e-grpRow .e-rows").width());this.element.find(".e-grpRow").length>0&&this.element.find("colgroup col:eq(0)").width()<140&&this.element.find("colgroup col:eq(0)").css("min-width","140px");this.element.find(".values").width(this.element.find(".e-grpRow").length>0?this.model.enableDeferUpdate&&this.element.find(".colheader").length==0?this.element.find(".e-grpRow").width():this.element.find(".e-grpRow").width()+4:140);this._createFields(null,this.element.find(".e-pivotGridTable").width(),n("#"+this._id).find(".e-pivotGridTable th").outerWidth())}}},_direction:function(n){return this.model.enableRTL&&!t.isNullOrUndefined(n)&&n.toString().indexOf("-")>-1?n.split("-").reverse().join("-"):n},_clearSelection:function(t){n(t.target).parents(".e-pivotGridTable").length==0&&n(this.element).find(".e-selected").removeClass("e-selected")},_startCellSelection:function(i){var f,e,u,o,r;if(this._onholdKey!="Control"&&!t.isNullOrUndefined(this._selectedCell))if(i.preventDefault(),this._onholdKey==""&&(this._onholdKey=i.which.toString()=="16"?"Shift":i.which.toString()=="17"?"Control":""),i.which=="40"){for(f=n(this._selectedCell).attr("data-p"),e=parseInt(f.split(",")[1])+this._selectedCell.rowSpan;t.isNullOrUndefined(u)&&e<this._rowCount;)r=n(this.element).find("[data-p='"+f.split(",")[0]+","+e+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(u=r),e++;t.isNullOrUndefined(u)||this._selectCells("Down",u)}else if(i.which=="38"){for(f=n(this._selectedCell).attr("data-p"),e=parseInt(f.split(",")[1])-1;t.isNullOrUndefined(u)&&e>=0;)r=n(this.element).find("[data-p='"+f.split(",")[0]+","+e+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(u=r),e--;if(t.isNullOrUndefined(u)&&this._onholdKey!="Shift"&&(n(this._selectedCell).hasClass("colheader")||n(this._selectedCell).attr("role")=="columnheader"))for(column=parseInt(f.split(",")[0])-1;column>0&&t.isNullOrUndefined(u);column--)for(row=parseInt(f.split(",")[1]-1);row>=0&&t.isNullOrUndefined(u);row--)r=n(this.element).find("[data-p='"+column+","+row+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(u=r);t.isNullOrUndefined(u)||this._selectCells("Up",u)}else if(i.which=="39"){for(f=n(this._selectedCell).attr("data-p"),e=parseInt(f.split(",")[0])+this._selectedCell.colSpan;t.isNullOrUndefined(u)&&e<Math.ceil(this.getJSONRecords().length/this._rowCount);)r=n(this.element).find("[data-p='"+e+","+f.split(",")[1]+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(u=r),e++;t.isNullOrUndefined(u)||this._selectCells("Right",u)}else if(i.which=="37"){for(var f=n(this._selectedCell).attr("data-p"),e=parseInt(f.split(",")[0])-1,u=n(this.element).find("[data-p='"+(parseInt(f.split(",")[0])-1)+","+f.split(",")[1]+"']")[0];t.isNullOrUndefined(u)&&e>=0;)r=n(this.element).find("[data-p='"+e+","+f.split(",")[1]+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader"||n(r).hasClass("colheader")||n(r).attr("role")=="columnheader")&&(u=r),e--;if(t.isNullOrUndefined(u)&&this._onholdKey!="Shift"&&(n(this._selectedCell).hasClass("rowheader")||n(this._selectedCell).attr("role")=="rowheader"))for(o=parseInt(f.split(",")[1])-1;t.isNullOrUndefined(u)&&o>0;)r=n(this.element).find("[data-p='"+parseInt(f.split(",")[0]-1)+","+o+"']")[0],!t.isNullOrUndefined(r)&&n(r).css("display")!="none"&&n(n(r).parents("tr")[0]).css("display")!="none"&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader")&&(u=r),o--;t.isNullOrUndefined(u)||this._selectCells("Left",u)}},_endCellSelection:function(i){var r,f,u,o,e;if(!t.isNullOrUndefined(this._selectedCell)&&(i.preventDefault(),(i.which==16||i.which==17)&&(this._onholdKey="",r=n(this.element).find(".e-selected"),r.length>0))){for(f=[],u=0;u<r.length;u++)o=n(r[u]).attr("data-p"),e=this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))],e.Value=n.trim(n(r[u]).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(e.Field=this._getFieldName(r[u])),f.push(e);t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:f}):this._pivotClientObj._trigger("cellSelection",{JSONRecords:f})}},_selectCells:function(i,r){var e,u,o,f,h,s,c;if(this._onholdKey=="Shift")((i=="Up"||i=="Down")&&(n(r).hasClass("rowheader")||n(r).attr("role")=="rowheader")||(i=="Right"||i=="Left")&&(n(r).hasClass("colheader")||n(r).attr("role")=="columnheader"))&&(e=i=="Up"||i=="Down"?1:0,(i=="Up"||i=="Left")&&parseInt(n(r).attr("data-p").split(",")[e])>=parseInt(this._primaryCellPos.split(",")[e])||(i=="Right"||i=="Down")&&parseInt(n(r).attr("data-p").split(",")[e])<=parseInt(this._primaryCellPos.split(",")[e])?n(this._selectedCell).removeClass("e-selected"):n(r).attr("data-p")!="0,0"&&n(r).addClass("selected"));else if(n(r).attr("data-p")!="0,0"&&(this.element.find(".e-selected").removeClass("e-selected"),n(r).addClass("e-selected"),this._primaryCellPos=n(r).attr("data-p"),u=n(this.element).find(".e-selected"),u.length>0)){for(o=[],f=0;f<u.length;f++)h=n(u[f]).attr("data-p"),s=this.getJSONRecords()[parseInt(parseInt(h.split(",")[0])*this._rowCount+parseInt(h.split(",")[1]))],s.Value=n.trim(n(u[f]).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(s.Field=this._getFieldName(u[f])),o.push(s);t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:o}):this._pivotClientObj._trigger("cellSelection",{JSONRecords:o})}c=i=="Up"||i=="Down"?!n(this._selectedCell).hasClass("colheader")&&n(this._selectedCell).attr("role")!="columnheader":!n(this._selectedCell).hasClass("rowheader")&&n(this._selectedCell).attr("role")!="rowheader";n(r).attr("data-p")!="0,0"&&(this._onholdKey!="Shift"||c)&&(this._selectedCell=r)},_sortBtnClick:function(i){var s,h,f,r,u,c,l,o,e,a;if(t.PivotAnalysis._valueSorting=null,t.isNullOrUndefined(this.model.valueSortSettings)||(this.model.valueSortSettings.headerText=""),this._isUpdateRequired=!0,n(i.delegateTarget).attr("id")==this._id&&(n(i.target).toggleClass("descending"),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".e-pivotButton[data-tag='"+n(i.target).parent().attr("data-tag")+"']").find(".e-sorting").toggleClass("descending")),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)s=n(i.target).siblings(".e-pvtBtn").attr("data-fieldName"),h=t.Pivot.getReportItemByFieldName(s,this.model.dataSource).item,h.sortOrder=i.target.className.indexOf("descending")>=0?t.PivotAnalysis.SortOrder.Descending:t.PivotAnalysis.SortOrder.Ascending,this.refreshControl();else{for(f=this._ascdes.split("##"),r=0,u=0;u<f.length;u++)f[u]==n(n(i.target).siblings(".e-pvtBtn")).attr("data-fieldName")?r=1:n(i.target).parents().hasClass("e-pivotschemadesigner")&&f[u]==n(n(i.target).siblings(".e-pvtBtn")).text()&&(r=1);c=i.target.className;l=new RegExp("descending");l.test(c)?r==0&&(this._ascdes+=n(i.target).parents().hasClass("e-pivotschemadesigner")?n(n(i.target).siblings(".e-pvtBtn")).text()+"##":n(n(i.target).siblings(".e-pvtBtn")).attr("data-fieldName")+"##"):r==1&&(this._ascdes=this._ascdes.replace(n(n(i.target).siblings(".e-pvtBtn")).attr("data-fieldName")+"##",""));e=JSON.stringify(this.model.customObject);try{o=JSON.parse(this.getOlapReport()).Report}catch(v){o=this.getOlapReport()}this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject});e=JSON.stringify(this.model.customObject);a=JSON.stringify({action:"sorting",sortedHeaders:this._ascdes,currentReport:o,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:e});this._waitingPopup=this.element.data("ejWaitingPopup");t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();this.model.enableDeferUpdate?this._waitingPopup.hide():this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.sorting,a,this._sortingSuccess)}},calculateCellWidths:function(){var f={rowHeight:0,columnWidths:[]},r,i,u,t;if(r=this._excelLikeJSONRecords!=null?this._excelLikeJSONRecords.length/this._excelRowCount:this.getJSONRecords()!=null?this.getJSONRecords().length/this._rowCount:0,i=1,u=!1,r>0)for(f.rowHeight=this.element.find("tbody tr:visible").length>0?this.element.find("tbody tr:visible")[0].getBoundingClientRect().height:0,t=0;t<r&&i<=r;t++)n(this._excelLikeJSONRecords!=null?this.element.find("th[data-i^="+t+"]:visible"):this.element.find("th[data-p^="+t+"]:visible")).each(function(){if(n(this).length>0&&n(this).attr("colspan")==i&&(n(this).attr("data-i")!=null?n(this).attr("data-i").split(",")[0]==t:n(this).attr("data-p").split(",")[0]==t))return f.columnWidths.push(this.getBoundingClientRect().width),t+=i-1,i=1,u=!0,!1;u=!1}),u||i==r?i=1:(t--,i++);return f},_deferUpdate:function(){var i,r,n,u,f;if(!this._isUpdateRequired)return!1;this._isUpdateRequired=!1;try{i=JSON.parse(this.getOlapReport()).Report}catch(e){i=this.getOlapReport()}for(r="",n=0;n<this._filterUpdate.length;n++)r+=this._filterUpdate[n]+"%%";u=JSON.stringify(this.model.customObject);f=JSON.stringify({action:"deferUpdate",sortedHeaders:this._ascdes,gridLayout:this.layout(),filterParams:r,currentReport:i,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:u});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.deferUpdate,f,this._renderControlSuccess);this._filterUpdate=[];this._waitingPopup=this.element.data("ejWaitingPopup");t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show()},_dialogBtnClick:function(i){var c,k,l,tt,a,it,d,v,s,ct,rt,ut,h,vt,w,u,lt,b,ft,et,at,y,ot;if(this.element.find(".e-dialog, .e-clientDialog").hide(),i.model.text.toLowerCase()!="cancel"&&this._isMembersFiltered)this._savedReportItems=n.extend(!0,[],this._currentReportItems);else return t.Pivot.closePreventPanel(this),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style"),!1;if(this.element.find(".e-editorTreeView").find("li span.e-searchfilterselection").length>0&&this.element.find(".e-editorTreeView").ejTreeView("removeNode",this.element.find(".e-editorTreeView").find("li span.e-searchfilterselection").closest("li")),this._isUpdateRequired=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)if(c=[],k=[],this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)t.PivotAnalysis._valueSorting=null,this.model.enableMemberEditorPaging||this._editorTreeData.length>0?(jQuery.each(this._editorTreeData,function(n,t){t.id!="All"&&t.checkedStatus&&c.push(t.name)}),jQuery.each(this._editorTreeData,function(n,t){t.checkedStatus||k.push(t.name=t.name=="(blank)"?"":t.name)})):(jQuery.each(this._memberTreeObj.element.find(":input.nodecheckbox:checked"),function(n,t){t.value!="All"&&c.push(t.value)}),jQuery.each(this._memberTreeObj.element.find(":input.nodecheckbox:not(:checked)"),function(t,i){k.push(i.value=i.value=="(blank)"?"":n(i).parents("li").find("a").text())})),this._pivotFilterItems(c,k),s=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item,s&&(s.advancedFilter=[]),this.model.editCellsInfo={},this._populatePivotGrid();else{if(tt=this.model.dataSource.providerName==t.olap.Providers.Mondrian,this._waitingPopup.show(),a=this._selectedField.toLocaleLowerCase(),this._currentReportItems=n.grep(this._currentReportItems,function(n){if(n["data-fieldName"]!=r&&n["data-fieldName"].toLocaleLowerCase()!=a)return n}),this._memberTreeObj=t.Pivot.updateTreeView(this),it=t.Pivot.getNodesState(this.model.enableMemberEditorPaging||this._editorTreeData.length>0?this._editorTreeData:this._memberTreeObj),this._schemaData!=null&&(this._schemaData._memberTreeObj=this._memberTreeObj),l=this.model.enableMemberEditorPaging||this._editorTreeData.length>0?n.extend(!0,[],this._editorTreeData):this._memberTreeObj.dataSource(),tt){for(d=2,v=0;v<l.length;v++)!t.isNullOrUndefined(l[v].level)&&l[v].level>d&&(d=l[v].level);this.model.dataSource._maxLevel=d}if(this._currentReportItems.push({filterItems:l,fieldName:this._selectedField,pageSettings:this._memberCount}),this.model.enableGroupingBar){var h=t.Pivot._getEditorMember(a,this,!1),st="selectedNodes",ht="include";this._fieldSelectedMembers[a]=n.map(this._fieldMembers[a],function(n){if(!n.checked)return n}).length==0?"All":h!="All"&&h!="multiple"?h:this._getLocalizedLabels("MultipleItems")}tt&&(st="unSelectedNodes",ht="exclude");c=n.map(it[st].split("::"),function(n){return{Id:n.split("||")[0],tag:n.split("||")[1],parentId:n.split("||")[2]}});s=t.Pivot.getReportItemByFieldName(a,this.model.dataSource).item;t.isNullOrUndefined(s)||(it.unSelectedNodes!=""?(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"filtering"},this),s.advancedFilter=[],s.filterItems={filterType:ht,values:this._removeSelectedNodes(c)},this.element.find(".e-pivotButton:contains('"+this._selectedField+"') .filter").addClass("filtered"),this._schemaData!=null&&this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedField+"'] .filter").length==0&&(this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedField+"'] div:first .e-text").after(t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").addClass("filtered"))):(delete s.filterItems,this._schemaData!=null&&(this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedField+"'] .filter").remove(),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").removeClass("filtered"))));this.getJSONData({action:"filtering"},this.model.dataSource,this)}else{ct="";rt="";rt=this.element.find(".e-editorTreeView :input.nodecheckbox");var f=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?ct=this._getUnSelectedNodes()+"FILTERED"+this._getSelectedNodes(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._curFilteredAxis=="Slicers"?!0:!1:this._curFilteredAxis=="Filter"?!0:!1):this.model.enableMemberEditorPaging||this._editorTreeData.length>0?this._editorTreeData:this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:not(:checked)"),g=!1,o=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.enableMemberEditorPaging||this._editorTreeData.length>0?t.Pivot._getUnSelectedTreeState(this)+"FILTERED"+t.Pivot._getSelectedTreeState(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._curFilteredAxis=="Slicers"?!0:!1:this._curFilteredAxis=="Filter"?!0:!1,this):f:this._curFilteredAxis+"::"+this._curFilteredText+"::FILTERED",e=this._curFilteredText,nt=[],p={};if(ut=this.model.enableMemberEditorPaging||this._editorTreeData.length>0?t.Pivot._getUnSelectedTreeState(this)!=""?!0:!1:this._getUnSelectedNodes()!=""?!0:!1,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){for(this.model.enableGroupingBar&&t.isNullOrUndefined(this._fieldMembers[e])&&(this._fieldMembers[e]=this._editorTreeData.length>0?n.map(this._editorTreeData,function(n){if(n.id!="(All)_0")return n.key||n.name}):t.Pivot._getEditorMember(rt,this,!1)),this._removeFilterTag(this._curFilteredText),f.length>0&&f[0].id=="(All)_0"&&f.splice(0,1),u=0;u<f.length;u++)this.model.enableMemberEditorPaging||this._editorTreeData.length!=0?f[u].checkedStatus==!1&&nt.push(f[u].key||f[u].name):nt.push(n(f[u].parentElement).siblings("a").text());for(p[e]=nt,t.isNullOrUndefined(this._tempFilterData)&&(this._tempFilterData=[]),u=0;u<this._tempFilterData.length;u++)t.isNullOrUndefined(this._tempFilterData[u][e])||(this._tempFilterData[u][e]=nt,g=!0);if(g||this._tempFilterData.push(p),this._schemaData!=null&&(this._schemaData._tempFilterData=this._tempFilterData),t.isNullOrUndefined(this._curFilteredAxis)||this._curFilteredAxis!="")for(u=0;u<f.length;u++)this.model.enableMemberEditorPaging||this._editorTreeData.length!=0?f[u].checkedStatus==!1&&(o+="##"+(f[u].key||f[u].name)):o+="##"+n(f[u].parentElement).siblings("a").text()}else{for(this.model.enableGroupingBar&&(h=t.Pivot._getEditorMember(e.split(":")[1],this,!1),this._fieldSelectedMembers[e.split(":")[1]]=n.map(this._fieldMembers[e.split(":")[1]],function(n){if(!n.checked)return n}).length==0?"All":h!="All"&&h!="multiple"?h:this._getLocalizedLabels("MultipleItems")),p[this._curFilteredText.split(":")[1]]=o,t.isNullOrUndefined(this._tempFilterData)&&(this._tempFilterData=[]),u=0;u<this._tempFilterData.length;u++)t.isNullOrUndefined(this._tempFilterData[u][this._curFilteredText.split(":")[1]])||(this._tempFilterData[u]=p,g=!0);g||this._tempFilterData.push(p)}if(vt=this.model.layout=="excel"?this.element.find(".e-schemaFieldTree li:contains('"+this._curFilteredText+"')"):this.element.find("."+this._curFilteredAxis+" .e-pivotButton:contains("+this._curFilteredText+") .filterBtn"),w=this._curFilteredText,this.model.layout==t.PivotGrid.Layout.Normal&&this._schemaData!=null){for(u=0;u<this._schemaData.element.find(".e-fieldTable").find("li").length;u++)this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._curFilteredText.split(":")[1]==n(this._schemaData.element.find(".e-fieldTable").find("li")[u]).attr("data-tag").replace(/\]/g,"").replace(/\[/g,"")&&(this._schemaData._selectedTreeNode=this._schemaData.element.find(".e-fieldTable").find("li")[u],w=this._curFilteredText.split(":")[1].split(".")[1]):this._curFilteredText==this._schemaData.element.find(".e-fieldTable").find("li")[u].id&&(this._schemaData._selectedTreeNode=this._schemaData.element.find(".e-fieldTable").find("li")[u],w=this._curFilteredText);if(n(this._schemaData._selectedTreeNode).parents("li:eq(0)").children().children("span").hasClass("e-hierarchyCDB")&&(this._schemaData._selectedTreeNode=n(n(this._schemaData._selectedTreeNode).parents("li:eq(0)"))),ut&&n(this._schemaData._selectedTreeNode).find(".filter").length<=0?(lt=t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML,n(n(this._schemaData._selectedTreeNode).find(".e-text")[0]).after(lt),this._schemaData.element.find(".e-pvtBtn:contains('"+w+"')").parent().find(".filter").addClass("filtered")):ut||(n(this._schemaData._selectedTreeNode).find(".filter").remove(),this._schemaData.element.find(".e-pvtBtn:contains('"+w+"')").parent().find(".filter").removeClass("filtered")),this._curFilteredAxis=="")return!1}try{b=JSON.parse(this.getOlapReport()).Report}catch(yt){b=this.getOlapReport()}if(this.model.enableAdvancedFilter&&this._selectedLevelUniqueName&&this._selectedLevelUniqueName.split("].").length==3&&(ft=this._getAdvancedFilterInfo(this._selectedLevelUniqueName.split("].").slice(0,2).join(".").replace(/\[/g,"")),ft.length>0&&this._removeFilterTag(ft[0].levelUniqueName)),this._dialogHead=="KPI"&&(o=f),this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject}),et=JSON.stringify(this.model.customObject),at=this.model.customObject!={}&&o!=""?JSON.stringify({action:"filtering",filterParams:o,sortedHeaders:this._ascdes,currentReport:b,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:et,gridLayout:this.model.layout}):this.model.customObject!={}?JSON.stringify({action:"filtering",currentReport:b,customObject:et,gridLayout:this.model.layout}):o!=""?JSON.stringify({action:"filtering",filterParams:o,sortedHeaders:this._ascdes,currentReport:b,gridLayout:this.model.layout}):JSON.stringify({action:"filtering"}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(n(this._schemaData.element).width()).height(n(this._schemaData.element).height()).css({top:n(this._schemaData.element).offset().top,left:n(this._schemaData.element).offset().left}),this.model.enableDeferUpdate){if(this._filterUpdate.push(o),n.each(this.element.find(".e-pivotButton .filter"),function(t,i){n(i).removeClass("filtered")}),!t.isNullOrUndefined(this._tempFilterData))for(y=0;y<this._tempFilterData.length;y++)for(ot in this._tempFilterData[y])this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?ot==e.split(":")[1]&&this._tempFilterData[y][e.split(":")[1]].split("FILTERED::")[0].length>0&&this.element.find(".e-pivotButton[data-tag='"+e+"']").find("span.filter").addClass("filtered"):ot==e&&this._tempFilterData[y][e].length>0&&this.element.find("#pivotButton"+e).next().addClass("filtered");t.Pivot.closePreventPanel(this);this.model.enableGroupingBar&&this._refreshGroupingBar(this);t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")}else this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,at,this._filterElementSuccess)}t.isNullOrUndefined(this._schemaData)||this._schemaData._refreshPivotButtons()},_refreshGroupingBar:function(){this._createGroupingBar(JSON.parse(this.getOlapReport()));this._createFields(null,n("#"+this._id).find(".e-pivotGridTable").width(),n("#"+this._id).find(".e-pivotGridTable th").outerWidth())},_removeSelectedNodes:function(t){for(var i,u=n.extend([],t),f=0;f<t.length;f++)for(i=0;i<u.length;i++)u[i].Id==t[f].parentId&&u.splice(i,1);return n.map(u,function(n){if(n.tag!=""&&n.tag!=r)return n.tag.replace(/\&/g,"&amp;")})},_pivotFilterItems:function(i,r){var s=this.model.dataSource[this._selectedAxis=="Slicers"?"filters":this._selectedAxis.toLowerCase()],f=t.PivotAnalysis.getMembers(this._selectedField),u,o;jQuery.each(f,function(n,t){t!=null&&t.toString().replace(/^\s+|\s+$/gm,"")||jQuery.each(r,function(n,i){i.toString().replace(/^\s+|\s+$/gm,"")||(r[n]=t)})});var h=this._selectedField,c=this._dialogTitle,e=n.grep(s,function(n){return n.fieldName==h});for(u=0;u<e.length;u++)e[u].filterItems=i.length==f.length?null:{filterType:t.PivotAnalysis.FilterType.Exclude,values:r};this._schemaData!=null&&(r.length>0&&this._schemaData.element.find(".e-schemaFieldTree li[id='"+this._selectedField+"']").find(".filter").length<=0?(o=t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML,this._schemaData.element.find(".e-schemaFieldTree li[id='"+this._selectedField+"']").find(".e-text").after(o),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").addClass("filtered")):r.length==0&&(this._schemaData.element.find(".e-schemaFieldTree li[id='"+this._selectedField+"']").find(".filter").remove(),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").removeClass("filtered")))},_getUnSelectedNodes:function(){var e=this.element.find(".e-editorTreeView")[0],f="",r=n(e).find(":input.nodecheckbox:not(:checked)"),i,u;if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)for(i=0;i<r.length;i++)n(r[i].parentElement).find("span:nth-child(1)").attr("class").indexOf("e-chk-act")>-1||n(r[i].parentElement).attr("aria-checked")=="mixed"||(u=n(r[i]).parents("li:eq(0)"),f+="::"+u[0].id+"||"+n(u).attr("data-tag")+(this._dialogHead=="KPI"?"~&"+n(n(r[i]).parents("ul:eq(1) li")[1]).attr("data-tag"):""));return f},_getSelectedNodes:function(i){var o,e,f,h,c,s,u,r;if(i){for(this.element.find(".e-editorTreeView").length>0?o=this.element.find(".e-editorTreeView")[0].childNodes[0]:t.isNullOrUndefined(this._schemaData)||(o=this._memberTreeObj.element[0].childNodes[0]),e=[],f=n(o).children(),u=0;u<f.length;u++){if(r=f[u],h={caption:n(r.firstChild).find("a").text(),parentId:r.parentElement.parentElement.className.indexOf("e-editorTreeView")>-1?"None":n(r).parents()[1].id,id:r.id,checked:n(r).find(":input.nodecheckbox")[0].checked||n(r).find("span:nth-child(1)").attr("class").indexOf("e-chk-indeter")>-1,expanded:n(r.firstChild).find(".e-minus").length>0?!0:!1,childNodes:[],tag:n(r).attr("data-tag")},n(r).find("ul:first").children().length>0)for(c=n(r).find("ul:first").children(),s=0;s<c.length;s++)h.childNodes.push(this._getNodeInfo(c[s]));e.push(h)}return JSON.stringify(e)}var o=this.element.find(".e-editorTreeView")[0],e="",f=n(o).find(":input.nodecheckbox");for(u=0;u<f.length;u++)(f[u].checked||n(f[u].parentElement).attr("aria-checked")=="mixed")&&(r=n(f[u]).parents("li:eq(0)"),e+="::"+r[0].id+"||"+n(r).attr("data-tag")+(this._dialogHead=="KPI"?"~&"+n(n(f[u]).parents("ul:eq(1) li")[1]).attr("data-tag"):""));return e},_getNodeInfo:function(t){var u={caption:n(t.firstChild).find("a").text(),parentId:t.parentElement.parentElement.className.indexOf("e-editorTreeView")>-1?"None":n(t).parents()[1].id,id:t.id,checked:n(t).find(":input.nodecheckbox")[0].checked||n(t).find("span:nth-child(1)").attr("class").indexOf("e-chk-indeter")>-1,expanded:n(t.firstChild).find(".e-minus").length>0?!0:!1,childNodes:[],tag:n(t).attr("data-tag")},r,i;if(n(t).find("ul:first").children().length>0)for(r=n(t).find("ul:first").children(),i=0;i<r.length;i++)u.childNodes.push(this._getNodeInfo(r[i]));return u},_getLevelInfo:function(t,i){var r=n.map(n(i).find("row"),function(i){if(parseInt(n(i).children("LEVEL_TYPE").text())!="1"&&n(i).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase()!="[measures]"&&n(i).find("HIERARCHY_UNIQUE_NAME").text()==t.hierarchy)return{value:n(i).find("LEVEL_UNIQUE_NAME").text(),text:n(i).find("LEVEL_CAPTION").text()}});this.olapCtrlObj._currentReportItems.push({fieldName:t.hierarchy,dropdownData:r})},_sortField:function(i){var u,f,e,s,o,r;if(this.element.find(".e-dialog, .e-clientDialog").remove(),t.Pivot.closePreventPanel(this),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)return u=this._selectedField,this._ascdes=this._ascdes+u+"##",n(i.element).attr("id")!="descOrder"&&(this._ascdes=n.grep(this._ascdes.split("##"),function(n){return n!=u}).join("##")),this._applySorting(),!1;r=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item;r.sortOrder=n(i.element).attr("id")=="descOrder"?t.PivotAnalysis.SortOrder.Descending:t.PivotAnalysis.SortOrder.Ascending;this.refreshControl()}else{if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){this._waitingPopup&&this._waitingPopup.show();try{f=JSON.parse(this.getOlapReport()).Report}catch(a){f=this.getOlapReport()}e=!1;this._excelFilterInfo.length>0&&(this._selectedField=this._selectedLevelUniqueName.split("].").splice(0,2).join("].")+"]",s=this._selectedLevelUniqueName,o=this._selectedField,this._excelFilterInfo=n.grep(this._excelFilterInfo,function(r){return(r.hierarchyUniqueName==o||t.isNullOrUndefined(o)||t.isNullOrUndefined(r.hierarchyUniqueName))&&r.levelUniqueName==s&&(e=!0,n(i.element).find(".e-clrSort").length==0?r.sortOrder=n(i.element).attr("id"):delete r.sortOrder),r}));e||this._excelFilterInfo.push({hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,sortOrder:n(i.element).attr("id")});this._selectedField=this._selectedLevelUniqueName.split("].").splice(0,2).join("].")+"]";var h=this._selectedField+"--"+n(i.element).attr("id"),c=JSON.stringify(this.model.customObject),l=JSON.stringify({action:"labelSorting",filterParams:h,currentReport:f,customObject:c,gridLayout:this.model.layout});return this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,l,this._filterElementSuccess),!1}t.olap.base._clearDrilledCellSet();(n(i.element).attr("id")=="descOrder"||n(i.element).attr("id")=="ascOrder")&&(r=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item,r.sortOrder=n(i.element).attr("id")=="descOrder"?t.olap.SortOrder.Descending:t.olap.SortOrder.Ascending,this._waitingPopup.show(),t.olap.base.getJSONData({action:"sorting"},this.model.dataSource,this))}},_applySorting:function(){var i=JSON.stringify(this.model.customObject),n,r;try{n=JSON.parse(this.getOlapReport()).Report}catch(u){n=this.getOlapReport()}this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject});i=JSON.stringify(this.model.customObject);r=JSON.stringify({action:"sorting",sortedHeaders:this._ascdes,currentReport:n,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:i});this._waitingPopup=this.element.data("ejWaitingPopup");t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();this.model.enableDeferUpdate?t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide():this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.sorting,r,this._sortingSuccess)},_createDialog:function(i,r){var f=this.model.enableAdvancedFilter||this.model.dataSource.enableAdvancedFilter,w=!1,o,h,v,rt,ut,ft,r,c,l,s,y,et,ot,p,u,a;f&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(this._selectedField=this._curFilteredText,this._curFilteredAxis!="Slicers"&&(w=this._getAdvancedFilterInfo(this._curFilteredText).length>0),f=this.element.find(".e-pivotButton button[data-fieldName='"+this._curFilteredText+"']").parents("div:eq(0)").hasClass("e-drag")?!1:!0):f=f&&!this.element.find(".e-pivotButton[data-tag='"+this._curFilteredText+"']").parents("div:eq(0)").hasClass("e-drag")?!0:!1:f=f&&t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).axis!="filters"?!0:!1);this.element.find(".e-dialog, .e-clientDialog").remove();this._isOptionSearch=!1;this._currentFilterList={};this._editorSearchTreeData=[];this._isEditorDrillPaging=!1;this._lastSavedTree=[];this._isSearchApplied=!1;var b=this._selectedField,e,k="",d="",g="",ht,nt,tt,it,yt=n(document).height();f&&(h=JSON.parse(r),h[0].name="(Select All)",this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?(e=this.model.enableMemberEditorPaging?this._memberPagingAvdData:h.splice(h.length-1,1),e=JSON.parse(e[0].levels)):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?(e=n.map(this._currentReportItems,function(n){if(n.fieldName==b)return n.dropdownData}),e.length==0&&(v=this._getConnectionInfo(this.model.dataSource.data),rt='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_LEVELS<\/RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+this.model.dataSource.catalog+"<\/CATALOG_NAME><CUBE_NAME>"+this.model.dataSource.cube+"<\/CUBE_NAME><\/RestrictionList><\/Restrictions><Properties><PropertyList><Catalog>"+this.model.dataSource.catalog+"<\/Catalog> <LocaleIdentifier>"+v.LCID+"<\/LocaleIdentifier> <\/PropertyList><\/Properties><\/Discover><\/Body><\/Envelope>",this.doAjaxPost("POST",v.url,{XMLA:rt},this._getLevelInfo,null,{pvtGridObj:this,action:"loadFieldElements",hierarchy:this._selectedField}),e=n.map(this._currentReportItems,function(n){if(n.fieldName==b)return n.dropdownData}))):e=[{value:this._selectedField,text:this._selectedField}],r=JSON.stringify(h),k=t.buildTag("div.e-ddlGroupWrap",this._getLocalizedLabels("SelectField")+t.buildTag("input#GroupLabelDrop.groupLabelDrop").attr("type","text")[0].outerHTML,{})[0].outerHTML,d=t.buildTag("ul.e-filterElementTag")[0].outerHTML,ut=t.Pivot.createAdvanceFilterTag({action:"filterTag"},this));g=t.buildTag("div.e-memberSearchEditorDiv",t.buildTag("input#searchEditorTreeView.searchEditorTreeView").attr("type","text")[0].outerHTML+(this.model.enableMemberEditorPaging&&n.parseJSON(r).length>=this.model.memberEditorPageSize?t.buildTag("span.e-icon e-searchEditorTree",{})[0].outerHTML:""),{padding:f?"5px 5px 0px 9px":"0px"})[0].outerHTML;var ct=t.buildTag("div#EditorDiv.e-editorDiv",k+t.buildTag("div",d+g+t.buildTag("div.e-memberEditorDiv",t.buildTag("div#editorTreeView.e-editorTreeView",{"margin-top":this.model.enableAdvancedFilter?"10px":"2px"})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML+(!t.isNullOrUndefined(r)&&this.model.enableMemberEditorPaging&&(n.parseJSON(r).length>=this.model.memberEditorPageSize||this.model.memberEditorPageSize<this._memberPageSettings.endPage)?"":"<\/br>"),lt=t.buildTag("div",t.buildTag("button#OKBtn.e-dialogOKBtn",this._getLocalizedLabels("OK")).attr({title:this._getLocalizedLabels("OK"),tabindex:0})[0].outerHTML+t.buildTag("button#CancelBtn.e-dialogCancelBtn",this._getLocalizedLabels("Cancel")).attr({title:this._getLocalizedLabels("Cancel"),tabindex:0})[0].outerHTML,{float:"right",margin:(f?"-9px 5px 11px ":"-13px 0px 7px ")+"  0px"})[0].outerHTML,ht=t.buildTag("div.e-memberPager",t.buildTag("div#"+this._id+"_NextpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentPage#memberCurrentPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberPageCount#memberPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML)[0].outerHTML,nt=t.buildTag("div.e-memberSearchPager",t.buildTag("div#"+this._id+"_NextSearchpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentSearchPage#memberCurrentSearchPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberSearchPageCount#memberSearchPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML,{}).css("display","none")[0].outerHTML,tt=t.buildTag("div.e-memberDrillPager",t.buildTag("div#"+this._id+"_NextDrillpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentDrillPage#memberCurrentDrillPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberDrillPageCount#memberDrillPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML,{}).css("display","none")[0].outerHTML;for(it=t.buildTag("div.e-linkOuterPanel",t.buildTag("span.e-infoImg e-icon","",{}).css({float:"left","margin-top":"4px","font-size":"16px"})[0].outerHTML+t.buildTag("a.e-linkPanel",this._getLocalizedLabels("NotAllItemsShowing")).css({display:"inline-block","margin-left":"3px","margin-top":"2px"})[0].outerHTML,{}).css({display:"none","margin-top":"-16px","margin-left":f?"8px":"0px"})[0].outerHTML,ft=t.buildTag("div#clientDialog.e-clientDialog",ct+(!t.isNullOrUndefined(r)&&this.model.enableMemberEditorPaging?n.parseJSON(r).length>=this.model.memberEditorPageSize||this.model.memberEditorPageSize<this._memberPageSettings.endPage?tt+nt+ht:tt+nt:it)+lt,{opacity:"1"}).attr("title",i)[0].outerHTML,r=JSON.parse(r),u=0;u<r.length;u++)r[u].name!=null&&r[u].name.toString().replace(/^\s+|\s+$/gm,"")||(r[u].name="(blank)",r[u].id="(blank)"),t.isNullOrUndefined(r[u].id)||typeof r[u].id!="string"||(r[u].id=r[u].id.replace(/ /g,"_"));if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?!t.isNullOrUndefined(this._fieldMembers):!t.isNullOrUndefined(this._tempFilterData)){if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(u=0;u<Object.keys(this._fieldMembers).length;u++)t.isNullOrUndefined(this._fieldMembers[this._curFilteredText.split(":")[1]])||(c=n.map(this._fieldMembers[this._curFilteredText.split(":")[1]],function(n){if(!n.checked)return n.name}));else for(u=0;u<this._tempFilterData.length;u++)t.isNullOrUndefined(this._tempFilterData[u][i])||(c=this._tempFilterData[u][i]);if(!t.isNullOrUndefined(c))for(u=0;u<c.length;u++)for(l=0;l<r.length;l++)c[u]==r[l].name&&(r[l].checkedStatus=!1)}for(n(ft).appendTo("#"+this._id),this.model.enableMemberEditorPaging&&(r.length>=this.model.memberEditorPageSize||this.model.memberEditorPageSize<this._memberPageSettings.endPage)&&(this.element.find(".e-prevPage, .e-firstPage").addClass("e-pageDisabled"),this.element.find(".e-nextPage, .e-lastPage").addClass("e-pageEnabled"),s=this._memberCount/this.model.memberEditorPageSize,s!=Math.round(s)&&(s=parseInt(s)+1),this.element.find(".e-memberPageCount").html("/ "+s),this.element.find(".e-memberCurrentPage").val(this._memberPageSettings.currentMemeberPage),this._memberPageSettings.currentMemeberPage>1?this.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):this.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),this._memberPageSettings.currentMemeberPage==parseInt(n.trim(this.element.find(".e-memberPageCount").text().split("/")[1]))?this.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):this.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),this.element.find(".e-nextPageDiv .e-pageDisabled").css("opacity","0.5")),this.element.find("#searchEditorTreeView").ejMaskEdit({name:"inputbox",width:"100%",inputMode:t.InputMode.Text,watermarkText:this._getLocalizedLabels("Search")+" "+i,maskFormat:"",textAlign:this.model.enableRTL?"right":"left",change:t.proxy(function(n){t.Pivot._searchEditorTreeNodes(n,this)},this)}),this.element.find(".e-editorTreeView").ejTreeView({showCheckbox:!0,loadOnDemand:!0,enableRTL:this.model.enableRTL,beforeDelete:function(n){if(!t.isNullOrUndefined(n.event)&&n.event.type=="keydown"&&n.event.originalEvent.key.toLowerCase()=="delete")return!1},height:this.model.enableMemberEditorSorting?"200px":f?"inherit":"245px",fields:{id:"id",text:"name",parentId:"pid",expanded:"expanded",isChecked:"checkedStatus",hasChild:"hasChildren",dataSource:t.Pivot._showEditorLinkPanel(r,this,this)}}),f&&(o=this.element.find("[data-tag*='"+(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this._selectedField:this._curFilteredText)+"']").offset(),this.element.find(".e-filterElementTag").ejMenu({fields:{dataSource:ut,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"},menuType:t.MenuType.NormalMenu,enableRTL:this.model.enableRTL,width:"100%",orientation:t.Orientation.Vertical,click:t.proxy(this._filterElementClick,this)}),this.element.find(".groupLabelDrop").ejDropDownList({width:"99%",enableRTL:this.model.enableRTL,dataSource:e,fields:{id:"id",text:"text",value:"value"},change:t.proxy(this._groupLabelChange,this),create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}}),y=this.element.find(".groupLabelDrop").data("ejDropDownList"),y.selectItemByText(y.model.dataSource[0].text),this.element.find(".e-memberEditorDiv").addClass("advancedFilter")),u=0;u<this._editorTreeData.length;u++)this._editorTreeData[u].name!=null&&this._editorTreeData[u].name.toString().replace(/^\s+|\s+$/gm,"")||(this._editorTreeData[u].name="(blank)",this._editorTreeData[u].id="(blank)"),t.isNullOrUndefined(this._editorTreeData[u].id)||typeof this._editorTreeData[u].id!="string"||(this._editorTreeData[u].id=this._editorTreeData[u].id.replace(/ /g,"_"));for(w&&(this.element.find(".e-editorTreeView").data("ejTreeView").checkAll(),this._editorTreeData=n.map(this._editorTreeData,function(n){return n.checkedStatus=!0,n}),this._editorDrillTreeData=n.map(this._editorTreeData,function(n){return n.checkedStatus=!0,n}),this._editorSearchTreeData=n.map(this._editorTreeData,function(n){return n.checkedStatus=!0,n})),et=this,this.model.enableMemberEditorPaging&&jQuery.isEmptyObject(this._currentFilterList)?this._currentFilterList=JSON.parse(JSON.stringify(this._editorTreeData)):!this.model.enableMemberEditorPaging&&jQuery.isEmptyObject(this._currentFilterList)&&n(r).each(function(n,t){et._currentFilterList[t.id]=t}),ot=n.grep(r,function(n){if(n.hasChildren==!0)return n}).length>0,ot||this.element.find(".e-memberEditorDiv").addClass("noChildNode"),p=this.element.find(".e-editorTreeView").find("li"),u=0;u<p.length;u++)p[u].setAttribute("data-tag",r[u].tag);this.element.find(".e-dialogOKBtn, .e-dialogCancelBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(this._dialogBtnClick,this)});this._dialogOKBtnObj=this.element.find(".e-dialogOKBtn").data("ejButton");this._memberTreeObj=this.element.find(".e-editorTreeView").data("ejTreeView");var at=this.element.find(".e-editorTreeView li:gt(0)"),st=n(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image"),vt=n(at).find(":input.nodecheckbox:not(:checked)");vt.length>0&&n(st).removeClass("e-checkmark").addClass("e-stop");this.model.enableMemberEditorPaging&&(this._isAllMemberChecked||(this._dialogOKBtnObj.disable(),this.element.find(".e-dialogOKBtn").attr("disabled","disabled"),n(st).removeClass("e-checkmark").removeClass("e-stop").addClass("e-chk-inact")));this.element.find(".e-clientDialog").ejDialog({width:f?"auto":265,target:"#"+this._id,enableResize:!1,enableRTL:this.model.enableRTL,close:t.proxy(t.Pivot.closePreventPanel,this)});this.element.find("#clientDialog_wrapper").css("top",this.element[0].offsetTop+20);this.element.find(".e-clientDialog").next(".e-scrollbar").hide();f&&(this.element.find("#clientDialog_wrapper").addClass("e-advancedFilterDlg"),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.element.find("#clientDialog_wrapper").addClass("advancedFilterDlgOSM"),a=n(".cols-sample-area").position(),a&&a.left>0?this.element.find("#clientDialog_wrapper").css({left:o.left+50-a.left,top:o.top}):t.isNullOrUndefined(o)||this.element.find("#clientDialog_wrapper").css({left:o.left+50,top:o.top}),this.element.find(".e-clientDialog").css({padding:"0px","min-width":"265px"}).parents().find(".e-titlebar").remove());this.model.enableMemberEditorSorting&&(this._sortType="",t.Pivot._separateAllMember(this),this.model.enableRTL&&this.element.find(".memberSortDiv, .e-insideDiv").addClass("e-rtl"));this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this);this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this);this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this._memberTreeObj.model.beforeExpand=t.proxy(this._beforeNodeExpand,this):this._memberTreeObj.model.nodeClick=t.proxy(this._nodeExpand,this));this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(this._memberTreeObj.model.beforeCollapse=t.proxy(t.Pivot._onNodeCollapse,this));this._memberTreeObj.element.find(".e-plus").length==0&&this._memberTreeObj.element.find(".e-item").css("padding","0px");this._isMembersFiltered=!1;this._unWireEvents();this._wireEvents();this.element.find(".e-dialog .e-close").attr("title",this._getLocalizedLabels("Close"));this.element.find(".e-dialog .e-close").click(function(){var i=n(this).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(i._schemaData)||i._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")})},_clearSorting:function(i){var u,s,f,e;if(n(i.target).parent().attr("disabled")=="disabled")return!1;if(t.Pivot.closePreventPanel(this),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._sortField(i):(u=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item,u.sortOrder=t.PivotAnalysis.SortOrder.None,this.refreshControl());else{if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){this._waitingPopup&&this._waitingPopup.show();this._selectedField=this._selectedLevelUniqueName.split("].").splice(0,2).join("].")+"]";this._excelFilterInfo.length>0&&(s=this._selectedLevelUniqueName,f=this._selectedField,this._excelFilterInfo=n.grep(this._excelFilterInfo,function(n){return(n.hierarchyUniqueName==f||t.isNullOrUndefined(f)||t.isNullOrUndefined(n.hierarchyUniqueName))&&n.levelUniqueName==s&&delete n.sortOrder,n}));try{e=JSON.parse(this.getOlapReport()).Report}catch(v){e=this.getOlapReport()}var c=this._selectedField+"--"+n(i.element).attr("id"),l=JSON.stringify(this.model.customObject),a=JSON.stringify({action:"labelSorting",filterParams:c,currentReport:e,customObject:l,gridLayout:this.model.layout});return this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,a,this._filterElementSuccess),!1}var o=this.model.dataSource,h=this._selectedField.toLowerCase(),u=n.map(o.columns,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==h)return n});u.length==0&&(u=n.map(o.rows,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==h)return n}));u.length>0&&delete u[0].sortOrder;this.model.dataSource=o;this.element.find(".e-dialog").remove();this.element.find("#preventDiv").remove();this._schemaData!=null&&this._schemaData.element.find(".e-dialog").remove();this._waitingPopup.show();this.getJSONData({action:"clearSorting"},this.model.dataSource,this)}},_clearAllFilters:function(i){var o,s,f,y,p,h,c,l,a;if(n(i.target).parent().attr("disabled")=="disabled")return!1;if(t.Pivot.closePreventPanel(this),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var v=this.model.dataSource,e=this._selectedField.toLowerCase(),u=n.map(v.columns,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==e)return n});u.length==0&&(u=n.map(v.rows,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==e)return n}));u.length>0&&(o=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):this._schemaData==null?null:this._schemaData.element.find(".groupLabelDrop").data("ejDropDownList"),o!=null?(u[0].advancedFilter&&(u[0].advancedFilter=n.map(u[0].advancedFilter,function(n){if(n.name!=r&&n.name.toLowerCase()!=o.getSelectedValue().toLowerCase())return n})),this._schemaData!=null&&(u[0].advancedFilter&&u[0].advancedFilter.length==0&&this._schemaData._tableTreeObj.element.find("li[data-tag ='"+u[0].fileName+"'] div:eq(0) .filter").remove(),this._schemaData._tableTreeObj.element.find("li[data-tag='"+o.getSelectedValue()+"'] div:eq(0) .filter").remove())):delete u[0].advancedFilter,delete u[0].filterItems);this._currentReportItems=n.grep(this._currentReportItems,function(n){if(n["data-fieldName"]!=r&&n["data-fieldName"].toLocaleLowerCase()!=e)return n});this.model.dataSource=v;this.element.find(".e-dialog").remove();this.element.find("#preventDiv").remove();this._schemaData!=null&&(this._schemaData._tableTreeObj.element.find("li[data-tag ='"+this._selectedField+"'] .filter").remove(),this._schemaData.element.find(".e-dialog").remove());this._waitingPopup.show();this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(t.PivotAnalysis._valueFilterArray=n.grep(t.PivotAnalysis._valueFilterArray,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()!=e)return n}),this.refreshControl()):this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this)}else{try{s=JSON.parse(this.getOlapReport()).Report}catch(w){s=this.getOlapReport()}if(this._removeFilterTag(this._curFilteredText),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)h=this._curFilteredAxis+"::"+this._curFilteredText+"## Clear Filter",c=this._curFilteredText,this._tempFilterData=n.map(this._tempFilterData,function(n){if(!n[c])return n}),l=JSON.stringify(this.model.customObject),a=JSON.stringify({action:"labelfiltering",filterParams:h,sortedHeaders:this._ascdes,currentReport:s,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:l,gridLayout:this.model.layout}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,a,this._filterElementSuccess);else{if(!t.isNullOrUndefined(this._tempFilterData))for(f=0;f<this._tempFilterData.length;f++)for(y in this._tempFilterData[f])y==this._curFilteredText.split(":")[1]&&this._tempFilterData[f][this._curFilteredText.split(":")[1]]!=""&&(this._tempFilterData.splice(f,1),delete this._fieldMembers[this._curFilteredText.split(":")[1]]);p=this._removeFilterTag(this._selectedLevelUniqueName);this._excelFilterInfo.push({hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,sortOrder:p});h=this._selectedLevelUniqueName+"--Clear Filter";c=this._curFilteredText;this._tempFilterData=n.map(this._tempFilterData,function(n){if(!n[c])return n});l=JSON.stringify(this.model.customObject);a=JSON.stringify({action:"labelfiltering",filterParams:h,sortedHeaders:this._ascdes,currentReport:s,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:l,gridLayout:this.model.layout});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,a,this._filterElementSuccess)}}},_removeFilterTag:function(i){var r=[],u=this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot,f;return(i&&i.indexOf("].")>=0||u)&&(f=i.split("].").length>2||u?"levelUniqueName":"hierarchyUniqueName",this._excelFilterInfo.length>0&&(levelName=this._selectedLevelUniqueName,hierarchyName=this._selectedFieldName,this._excelFilterInfo=n.grep(this._excelFilterInfo,function(n){if(n[f]==i)r=n.sortOrder;else return n}))),r},_groupLabelChange:function(i){var f=this.element.find(".e-filterElementTag").data("ejMenu"),w,b,a,k,c,d,o;if(f.disableItemByID("labelClearFilter"),f.disableItemByID("valueClearFilter"),f.disableItemByID("clearAllFilters"),f.disableItemByID("clearSorting"),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var e=this.element.hasClass("e-pivotschemadesigner")?this.model.pivotControl:this,g=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):[],u=e._getAdvancedFiltervalue(e._selectedField,g.getSelectedValue()),y=t.Pivot.getReportItemByFieldName(e._selectedField,e.model.dataSource).item,h=t.buildTag("span.e-filterState").addClass("e-icon").attr("aria-label","filter state")[0].outerHTML,p=t.buildTag("span.e-activeFilter").addClass("e-icon")[0].outerHTML,s=t.Pivot.getReportItemByFieldName(e._selectedField,e.model.dataSource).item,l;s&&s.sortOrder&&s.sortOrder!=t.Pivot.SortOrder.None&&(l=s&&s.sortOrder==t.Pivot.SortOrder.Descending?"desc":"asc",t.isNullOrUndefined(l)||l=="asc"?this.element.find(".e-clientDialog .ascImage").addClass("e-selectedSort"):this.element.find(".e-clientDialog .e-descImage").addClass("e-selectedSort"),f.enableItemByID("clearSorting"));this.element.find(".e-filterState,.e-activeFilter").remove();c=this.element.find("#clearAllFilters a").children().clone();this.element.find("#clearAllFilters a").text(this._getLocalizedLabels("ClearFilter")+' from "'+i.text+'"').append(c);u.length>0?(u[0].advancedFilterType==t.Pivot.AdvancedFilterType.LabelFilter?(this.element.find("#labelFilterBtn a:eq(0)").append(h),this.element.find("#labelFilterBtn .clearFilter").css("opacity","1").removeAttr("disabled"),w=u[0].labelFilterOperator=="equals"||u[0].labelFilterOperator=="notequals"||u[0].labelFilterOperator=="lessthanorequalto"||u[0].labelFilterOperator=="greaterthanorequalto"||u[0].labelFilterOperator=="greaterthan"||u[0].labelFilterOperator=="lessthan"?"_labelFilter":"",this.element.find("#labelFilterBtn li#"+u[0].labelFilterOperator+w+" a").append(p),f.enableItemByID("labelClearFilter")):(this.element.find("#valueFilterBtn a:eq(0)").append(h),this.element.find("#valueFilterBtn .clearFilter").css("opacity","1").removeAttr("disabled"),b=u[0].valueFilterOperator=="equals"||u[0].valueFilterOperator=="notequals"||u[0].valueFilterOperator=="lessthanorequalto"||u[0].valueFilterOperator=="greaterthanorequalto"||u[0].valueFilterOperator=="greaterthan"||u[0].valueFilterOperator=="lessthan"?"_valueFilter":"",this.element.find("#valueFilterBtn li#"+u[0].valueFilterOperator+b+" a").append(p),f.enableItemByID("valueClearFilter")),f.enableItemByID("clearAllFilters")):y&&y.filterItems&&(this.element.find(".e-memberEditorDiv").before(h),this.element.find(".e-filterState").addClass("memberFilter").css("visibility","hidden"),f.enableItemByID("clearAllFilters"))}else{var a=this._selectedLevelUniqueName=i.selectedValue,h=t.buildTag("span.e-filterState").addClass("e-icon").attr("aria-label","filter state")[0].outerHTML,r=[],v;this._excelFilterInfo.length>0&&(a=this._selectedLevelUniqueName,k=this._selectedFieldName,r=n.map(this._excelFilterInfo,function(n){if(n.hierarchyUniqueName==k&&n.levelUniqueName==a)return{action:n.action,operator:n.operator,value1:n.value1,sortInfo:n.sortOrder}}));c=this.element.find("#clearAllFilters a").children().clone();this.element.find("#clearAllFilters a").text(this._getLocalizedLabels("ClearFilter")+' from "'+i.text+'"').append(c);this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(d=n.grep(this._ascdes.split("##"),function(n){if(n==a)return n}),d.length>0?(this.element.find(".e-descImage").addClass("e-selectedSort"),f.enableItemByID("clearSorting")):this.element.find(".ascImage").addClass("e-selectedSort")):r.length>0&&(t.isNullOrUndefined(r[0].sortInfo)||!t.isNullOrUndefined(r[0].sortInfo)&&r[0].sortInfo.length==0)||r.length==0||r[0].sortInfo.length>0&&(this.element.find("#"+r[0].sortInfo+" span:eq(0)").addClass("e-selectedSort"),f.enableItemByID("clearSorting"));this.element.find(".e-filterElementTag .e-activeFilter,.e-filterIndicator").remove();r.length>0&&!t.isNullOrUndefined(r[0].operator)?(f.enableItemByID("clearAllFilters"),o="",r[0].action=="valuefiltering"?(o="valueFilterBtn",f.enableItemByID("valueClearFilter"),v=r[0].operator=="equals"||r[0].operator=="not equals"||r[0].operator=="less than or equal to"||r[0].operator=="greater than or equal to"||r[0].operator=="greater than"||r[0].operator=="less than"?"_valueFilter":""):(o="labelFilterBtn",f.enableItemByID("labelClearFilter"),v=r[0].operator=="equals"||r[0].operator=="not equals"||r[0].operator=="less than or equal to"||r[0].operator=="greater than or equal to"||r[0].operator=="greater than"||r[0].operator=="less than"?"_labelFilter":""),this.element.find("#"+o+" a:eq(0)").append(h),r[0].operator.replace(/ /g,"")=="BottomCount"?this.element.find("#"+o+" li#"+r[0].operator.replace(/ /g,"").replace("Bottom","top")+" a").append(n(t.buildTag("span.e-activeFilter e-icon")[0].outerHTML)):this.element.find("#"+o+" li#"+r[0].operator.replace(/ /g,"")+v+" a").append(n(t.buildTag("span.e-activeFilter e-icon")[0].outerHTML))):this._getUnSelectedNodes()!=""&&(this.element.find(".e-memberEditorDiv").before("<div class='e-filterState e-icon' style='margin-top:5px;position:absolute;visibility:hidden' />"),f.enableItemByID("clearAllFilters"))}},_getAdvancedFiltervalue:function(i,u){var f=t.Pivot.getReportItemByFieldName(i,this.model.dataSource).item,e=[];return f&&f.advancedFilter&&(e=n.map(f.advancedFilter,function(n){if(n.name!=r&&n.name.toLocaleLowerCase()==u.toLowerCase())return n})),e},_filterElementClick:function(i,u){var l,o,s,h,c,a,p,f,e;if(i.ID=="labelFilterBtn"||i.ID=="valueFilterBtn")return!1;if(l=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):u.element.find(".groupLabelDrop").data("ejDropDownList"),this._selectedLevelUniqueName=l.getSelectedValue(),i.ID=="clearAllFilters"||i.ID=="valueClearFilter"&&this.model.analysisMode=="pivot"&&this.model.operationalMode=="servermode"){if(this._clearAllFilters(i),i.ID=="valueClearFilter"&&this.model.analysisMode=="pivot"&&this.model.operationalMode=="servermode")return!1}else i.ID=="clearSorting"?this._clearSorting(i):(i.ID=="ascOrder"||i.ID=="descOrder")&&this._sortField(i);if(this.element.find(".e-dialog, .e-filterDialog, #preventDiv").remove(),this._schemaData!=null&&this._schemaData.element.find(".e-dialog").remove(),!n(i.element).parent().hasClass("e-filterElementTag")&&i.ID!="ascOrder"&&i.ID!="descOrder"&&i.ID!="clearSorting"&&i.ID!="clearAllFilters")if(o=this._selectedField,this._filterAction=t.isNullOrUndefined(i.element)?t.isNullOrUndefined(i.parentId)&&(t.isNullOrUndefined(i.menuId)||i.menuId=="")?n(i.selectedItem).attr("id")=="valueFilterBtn"?"valueFiltering":n(i.selectedItem).attr("id")=="labelFilterBtn"?"labelFiltering":"":i.parentId=="valueFilterBtn"?"valueFiltering":i.menuId=="labelFilterBtn"?"labelFiltering":"":n(i.element).parents("#valueFilterBtn").length==0?"labelFiltering":"valueFiltering",n.trim(i.text)==n.trim(this._getLocalizedLabels("ClearFilter")))if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){this._removeFilterTag(this._selectedLevelUniqueName);try{s=JSON.parse(this.getOlapReport()).Report}catch(b){s=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)h=JSON.stringify(this.model.customObject),c=JSON.stringify({action:this._filterAction.toLowerCase(),filterParams:this._selectedLevelUniqueName+"--Clear Filter",currentReport:s,customObject:h,gridLayout:this.model.layout}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,c,this._filterElementSuccess);else{a=this._curFilteredText;this._tempFilterData=n.map(this._tempFilterData,function(n){if(!n[a])return n});var w=this._curFilteredAxis+"::"+this._curFilteredText+"## Clear Filter",h=JSON.stringify(this.model.customObject),c=JSON.stringify({action:this._filterAction.toLowerCase(),filterParams:w,sortedHeaders:this._ascdes,currentReport:s,customObject:h,gridLayout:this.model.layout});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,c,this._filterElementSuccess)}}else{t.Pivot.closePreventPanel(this);var v=this._selectedLevelUniqueName.toLowerCase(),y=[],f=n.map(this.model.dataSource.columns,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==o.toLowerCase())return n});return f.length==0&&(f=n.map(this.model.dataSource.rows,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==o.toLowerCase())return n})),t.PivotAnalysis._valueFilterArray=n.grep(t.PivotAnalysis._valueFilterArray,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()!=o.toLowerCase())return n}),f.length>0&&(f[0].advancedFilter&&(y=n.map(f[0].advancedFilter,function(n){if(n.name!=r&&n.name.toLowerCase()!=v)return n})),f[0].advancedFilter=y,this._schemaData&&(f[0].advancedFilter.length==0&&this._schemaData._tableTreeObj.element.find("li[data-tag ='"+o+"'] div:eq(0) .filter").remove(),this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedLevelUniqueName+"'] div:eq(0) .filter").remove())),this._waitingPopup.show(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this.refreshControl():this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this),!1}else this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(e=[],p=this._selectedLevelUniqueName,this._excelFilterInfo.length>0&&n(i.element).siblings("li:eq(0)").attr("disable")!="true"&&(e=n.map(this._excelFilterInfo,function(n){if(n.levelUniqueName==p&&!t.isNullOrUndefined(n.operator))return{value1:n.value1,value2:n.value2,operator:n.operator,measure:n.measure}}),e.length>0&&i.ID.replace("_valueFilter","").replace("_labelFilter","")!=e[0].operator.replace(/ /g,"")&&(e=[])),t.Pivot.createAdvanceFilterTag({action:this._filterAction=="labelFiltering"?"labelFilterDlg":"valueFilterDlg",selectedArgs:i,filterInfo:e},this)):(f=n.map(this.model.dataSource.columns,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==o.toLowerCase())return n}),f.length==0&&(f=n.map(this.model.dataSource.rows,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()==o.toLowerCase())return n})),e=[],f[0].advancedFilter&&(e=n.map(f[0].advancedFilter,function(n){if(n.name!=r&&n.name.toLowerCase()!=v)return n})),t.Pivot.createAdvanceFilterTag({action:this._filterAction=="labelFiltering"?"labelFilterDlg":"valueFilterDlg",selectedArgs:i,filterInfo:e},this))},_filterOptionChanged:function(i){var r=this._getAdvancedFiltervalue(this._selectedField,this._selectedLevelUniqueName),u;r=r.length>0?r[0].advancedFilterType=="label"&&i.value.replace(/ /g,"")==r[0].labelFilterOperator?r[0].values:r[0].advancedFilterType=="value"&&i.value.replace(/ /g,"")==r[0].valueFilterOperator?r[0].values:[""]:[""];u=this.element.find(".filterValuesTd")[0];i.value.toLowerCase().indexOf("between")>=0&&n(u).html("<input type='text' id='filterValue1' class='e-filterValues' value='"+r[0]+"' style='display:inline'/> <span>"+this._getLocalizedLabels("and")+"<\/span> <input type='text' id='filterValue2' value='"+(t.isNullOrUndefined(r[1])?"":r[1])+"' class='e-filterValues' style='display:inline' /> <\/br>");i.value.toLowerCase().indexOf("between")<0&&n(u).html("<input type='text' id='filterValue1' class='e-filterValues' value='"+r[0]+"' style='display:inline'/>")},_filterElementOkBtnClick:function(){var c,a,v,p,b,y,tt,f;t.Pivot.closePreventPanel(this);var e=this.element.find(".filterOptions")[0].value,i=[this.element.find("#filterValue1")[0].value],u,l=[],s=this._selectedField;if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){var it=i[0].value,w=this.element.find("#filterValue2").length>0?this.element.find("#filterValue2")[0].value:"",u,o,h=this._filterAction.toLowerCase();if(o=this._selectedLevelUniqueName+"--"+e+"--"+i[0],this.element.find(".filterMeasures").length>0&&(this.element.find("#filterValue2").length>0&&(o=o+","+w),u=this.element.find(".filterMeasures").data("ejDropDownList").model.value,o=o+"--"+u,h="valuefiltering",u==null))return;try{c=JSON.parse(this.getOlapReport()).Report}catch(rt){c=this.getOlapReport()}if(a=JSON.stringify(this.model.customObject),v=JSON.stringify({action:h,filterParams:o,currentReport:c,customObject:a,gridLayout:this.model.layout}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(n(this._schemaData.element).width()).height(n(this._schemaData.element).height()).css({top:n(this._schemaData.element).offset().top,left:n(this._schemaData.element).offset().left}),p=this._curFilteredText.indexOf(":")>-1?this._curFilteredText.split(":")[1]:"",p!=""&&this._tempFilterData&&(this._tempFilterData=n.grep(this._tempFilterData,function(n){if(t.isNullOrUndefined(n[p]))return n})),b=this._removeFilterTag(this._selectedLevelUniqueName),this._excelFilterInfo.push({action:h,hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,operator:e,measure:u,value1:i[0],value2:w,sortOrder:b}),this.model.analysisMode==t.Pivot.AnalysisMode.Olap)this.model.enableDeferUpdate||this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,v,this._filterElementSuccess);else if(this._filterAction=="labelFiltering"){y=this._curFilteredText;this._tempFilterData=n.map(this._tempFilterData,function(n){if(!n[y])return n});var k=this._curFilteredAxis+"::"+this._curFilteredText+"##"+e+"::"+i[0],a=JSON.stringify(this.model.customObject),v=JSON.stringify({action:h,filterParams:k,sortedHeaders:this._ascdes,currentReport:c,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:a,gridLayout:this.model.layout});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,v,this._filterElementSuccess)}else{y=this._curFilteredText;this._tempFilterData=n.map(this._tempFilterData,function(n){if(!n[y])return n});this._measureDDL=this.element.find(".filterMeasures").data("ejDropDownList");u=this._measureDDL.getSelectedValue();var k=this._curFilteredText+"::"+e+"::"+u+"::"+i[0]+"::"+(this.element.find("#filterValue2").length>0?this.element.find("#filterValue2")[0].value:""),a=JSON.stringify(this.model.customObject),v=JSON.stringify({action:h,filterParams:k,sortedHeaders:this._ascdes,currentReport:c,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:a,gridLayout:this.model.layout});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,v,this._filterElementSuccess)}return!1}if(this._filterAction=="valueFiltering"){if(this._measureDDL=this.element.find(".filterMeasures").data("ejDropDownList"),u=this._measureDDL.getSelectedValue(),!(!isNaN(parseFloat(i[0]))&&isFinite(i[0]))||u=="")return;this.element.find("#filterValue2")[0]!=r?","+i.push(this.element.find("#filterValue2")[0].value):i}if(this.element.find(".e-dialog").remove(),this._schemaData){var d=t.buildTag("span.filter").addClass("e-icon")[0].outerHTML,g=this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedLevelUniqueName+"'] div:eq(0)"),nt=this._schemaData._tableTreeObj.element.find("li[data-tag ='"+s+"'] div:eq(0)");g.find(".filter").length==0&&g.append(d);nt.find(".filter").length===0&&nt.append(d)}tt=this._selectedLevelUniqueName.toLowerCase();f=n.map(this.model.dataSource.columns,function(n){if(n.fieldName!=r&&n.fieldName.toLocaleLowerCase()==s.toLowerCase())return n});f.length==0&&(f=n.map(this.model.dataSource.rows,function(n){if(n.fieldName!=r&&n.fieldName.toLocaleLowerCase()==s.toLowerCase())return n}));f.length>0&&(delete f[0].filterItems,f[0].advancedFilter&&(l=n.map(f[0].advancedFilter,function(n){if(n.name!=r&&n.name.toLocaleLowerCase()!=tt)return n})),this._filterAction.toLowerCase()=="labelfiltering"?l.push({name:this._selectedLevelUniqueName,labelFilterOperator:e.replace(/ /g,""),advancedFilterType:t.Pivot.AdvancedFilterType.LabelFilter,values:i}):l.push({name:this._selectedLevelUniqueName,valueFilterOperator:e.replace(/ /g,""),advancedFilterType:t.Pivot.AdvancedFilterType.ValueFilter,values:i,measure:u}),this._currentReportItems=n.grep(this._currentReportItems,function(n){if(n["data-fieldName"]!=s)return n}),f[0].advancedFilter=l,this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"filtering"},this)));this._waitingPopup.show();this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(t.PivotAnalysis._valueSorting=null,t.PivotAnalysis._valueFilterArray=n.grep(t.PivotAnalysis._valueFilterArray,function(n){if(n.fieldName!=r&&n.fieldName.toLowerCase()!=s.toLowerCase())return n}),this._filterAction=="valueFiltering"&&t.PivotAnalysis._valueFilterArray.push(f[0]),this.refreshControl()):this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this)},_nodeCheckChanges:function(i){var h,o,e,l,a,f;if(this._onDemandNodeExpand){this._isMembersFiltered=!0;var s=this,u=this.element.find(".e-editorTreeView"),c=null,v=!t.isNullOrUndefined(i.model.id)&&i.model.id.toLowerCase()=="allelement"&&!i.isChecked||!t.isNullOrUndefined(i.id)&&(i.id.toLowerCase()=="(all)_0"||i.id.toLowerCase()=="all")&&!t.isNullOrUndefined(i.type)&&i.type=="nodeUncheck",l=!t.isNullOrUndefined(i.model.id)&&i.model.id.toLowerCase()=="allelement"&&i.isChecked||!t.isNullOrUndefined(i.id)&&(i.id.toLowerCase()=="(all)_0"||i.id.toLowerCase()=="all")&&!t.isNullOrUndefined(i.type)&&i.type=="nodeCheck";if(v){if(this._memberTreeObj.model.nodeCheck="",this._memberTreeObj.model.nodeUncheck="",this._isOptionSearch?(c=n(u).find("li[data-isItemSearch='true']"),c.length>0&&n(c).each(function(t,i){n(u).ejTreeView("uncheckNode",n(i))})):this.model.enableMemberEditorPaging&&n(u).find("li span.e-searchfilterselection").length>0?(n(u).ejTreeView("unCheckAll"),this._isSelectSearchFilter?n(u).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"):n(u).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop")):n(u).ejTreeView("unCheckAll"),this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this),n(u).find("li").length>0&&!n(u).find("li").find("span.e-checkmark").length>0?this._dialogOKBtnObj.disable():n(u).find("li").length>0&&n(u).find("li").find("span.e-checkmark").length==1&&n(u).find("li span.e-searchfilterselection").closest("li").find("span.e-checkmark").length>0&&this._dialogOKBtnObj.disable(),this.model.enableMemberEditorPaging||this._editorTreeData.length>0){if(this.element.find(".e-dialogOKBtn").attr("disabled","disabled"),this._isAllMemberChecked=!1,this._editorSearchTreeData.length>0)for(f=0;f<this._editorSearchTreeData.length;f++)n(this._editorTreeData).each(function(n,t){if(s._editorSearchTreeData[f].id==t.id)return s._editorSearchTreeData[f].checkedStatus=!1,t.checkedStatus=!1,!1});else n(this._editorTreeData).each(function(n,t){t.checkedStatus=!1});n(this._editorTreeData).each(function(n,t){if(t.checkedStatus)return s._dialogOKBtnObj.enable(),s.element.find(".e-dialogOKBtn").removeAttr("disabled"),!1})}}else if(l){if(this._memberTreeObj.model.nodeCheck="",this._memberTreeObj.model.nodeUncheck="",this._isOptionSearch?(c=n(u).find("li[data-isItemSearch='true']"),c.length>0&&n(c).each(function(t,i){n(u).ejTreeView("checkNode",n(i))})):this.model.enableMemberEditorPaging&&n(u).find("li span.e-searchfilterselection").length>0?(n(u).ejTreeView("checkAll"),this._isSelectSearchFilter?n(u).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"):n(u).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop")):n(u).ejTreeView("checkAll"),n(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-stop"),this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this),n(u).find("li").length>0&&n(u).find("li").find("span.e-checkmark").length>0&&this._dialogOKBtnObj.enable(),this.model.enableMemberEditorPaging||this._editorTreeData.length>0)if(this.element.find(".e-dialogOKBtn").removeAttr("disabled"),this._isAllMemberChecked=!0,this._editorSearchTreeData.length>0)for(f=0;f<this._editorSearchTreeData.length;f++)n(this._editorTreeData).each(function(n,t){if(s._editorSearchTreeData[f].id==t.id)return s._editorSearchTreeData[f].checkedStatus=!0,t.checkedStatus=!0,!1});else n(this._editorTreeData).each(function(n,t){t.checkedStatus=!0})}else if(i.id.toLowerCase()=="searchfilterselection")t.Pivot._updateSearchFilterSelection(i,u,s);else if((t.isNullOrUndefined(i.model.id)||i.model.id.toLowerCase()!="allelement")&&(t.isNullOrUndefined(i.id)||i.id.toLowerCase()!="(all)_0"&&i.id.toLowerCase()=="all")||!(this.model.enableMemberEditorPaging||this._editorTreeData)){if(!t.isNullOrUndefined(i.model.id)&&i.model.id.toLowerCase()=="allelement"||!t.isNullOrUndefined(i.id)&&(i.id.toLowerCase()=="(all)_0"||i.id.toLowerCase()!="all"))if(o=this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:not(:checked)"),e=n(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image"),this._dialogHead=="KPI"){for(l=!0,a=this.element.find(".e-editorTreeView ul:eq(0)"),f=0;f<a.children("li").length;f++)if(a.children("li:eq("+f+")").find(".e-check-small").attr("aria-checked")=="false"){l=!1;break}l?this._dialogOKBtnObj.enable():(e.removeClass("e-checkmark").removeClass("e-stop"),this._dialogOKBtnObj.disable())}else o.length==0||o.length==1&&o[0].id[o[0].id.length-1]==0?(n(e).parent().removeClass("e-chk-inact").removeClass("e-chk-ind").addClass("e-chk-act"),e.removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark")):i.type=="nodeCheck"&&o.length==1&&o[0].id[o[0].id.length-1]==0?(e.removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark")):o.length>0&&(e.removeClass("e-checkmark").addClass("e-stop"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").addClass("e-stop")),this._dialogOKBtnObj.enable(),i.type=="nodeUncheck"&&(o.length+1==this._memberTreeObj.element.find("li").length?(e.removeClass("e-checkmark").removeClass("e-stop"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop"),this._dialogOKBtnObj.disable()):this._isOptionSearch&&n(u).find("li span.e-searchfilterselection").closest("li").find("span.e-checkmark").length>0&&this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:checked").length==1&&(e.removeClass("e-checkmark").removeClass("e-stop"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop"),this._dialogOKBtnObj.disable()))}else i.type=="nodeUncheck"?(this._isMembersFiltered=!0,h="",t.Pivot._memberPageNodeUncheck(i,this),h=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",null||r).where("checkedStatus","equal",!0)),!t.isNullOrUndefined(h)&&h.length>0&&(h[0].id=="All"||h[0].id=="(All)_0")&&h.splice(0,1),e=n(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image"),t.isNullOrUndefined(h)||h.length!=0?(n(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),n(this._editorTreeData).each(function(t,i){if(i.checkedStatus)return this._isAllMemberChecked=!1,n(s._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-checkmark").addClass("e-stop"),!1})):(this._dialogOKBtnObj.disable(),this.element.find(".e-dialogOKBtn").attr("disabled","disabled"),this._isAllMemberChecked=!1,e.removeClass("e-stop").removeClass("e-checkmark").addClass("e-chk-inact"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").addClass("e-chk-inact"))):i.type=="nodeCheck"&&(this._isMembersFiltered=!0,t.Pivot._memberPageNodeCheck(i,this),this.element.find(".e-dialogOKBtn").data("ejButton").enable(),this.element.find(".e-dialogOKBtn").removeAttr("disabled"),this._isAllMemberChecked=!0,n(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),n(this._editorTreeData).each(function(t,i){if(!i.checkedStatus)return this._isAllMemberChecked=!1,n(s._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-checkmark").addClass("e-stop"),!1}))}},_fetchMemberSuccess:function(i){i[0]!=r&&i.length>0?(this._currentMembers=i[0].Value,i[1]!=null&&i[1]!=r&&(this.model.customObject=i[1].Value)):i.d!=r&&i.d.length>0?(this._currentMembers=i.d[0].Value,i.d[1]!=null&&i.d[1]!=r&&(this.model.customObject=i.d[1].Value)):i!=r&&i.length>0?(this._currentMembers=i.EditorTreeInfo,i!=null&&i!=r&&(this.model.customObject=i.customObject)):i!=r&&(this._currentMembers=i.EditorTreeInfo);this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&!this.model.enableMemberEditorPaging&&(this._editorTreeData.length==0||this._isFilterBtnClick)&&(this._editorTreeData=JSON.parse(this._currentMembers),this.model.enableAdvancedFilter&&(this._editorTreeData=n.map(this._editorTreeData,function(n){if(t.isNullOrUndefined(n.levels))return n})));this._savedReportItems=n.extend(!0,[],this._currentReportItems);this._isFilterBtnClick=!1;this._createDialog(this._dialogHead,this._currentMembers);this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"fetchMembers",element:this.element,customObject:this.model.customObject});this.model.dataSource.enableAdvancedFilter?this.element.find(".e-dialog #GroupLabelDrop_wrapper:visible").first().attr("tabindex","-1").focus().addClass("e-hoverCell"):t.isNullOrUndefined(this.element.find(".e-dialog .e-text:visible").first())||this.element.find(".e-dialog .e-text:visible").first().attr("tabindex","-1").focus().addClass("e-hoverCell");this._waitingPopup.hide()},_filterElementSuccess:function(n){n[0]!=r?n[2]!=null&&n[2]!=r&&(this.model.customObject=n[2].Value):n.d!=r?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):n.customObject!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject});this._renderControlSuccess(n)},_sortingSuccess:function(n){n[0]!=r?n[2]!=r&&n.length>0&&(this.model.customObject=n[2].Value):n.d!=r&&n.d.length>0?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):n!=r&&n.length>0&&n.customObject!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject});this._renderControlSuccess(n)},_nodeExpand:function(i){var u=t.isNullOrUndefined(i.event)?i.targetElement:i.event.originalEvent!=r&&i.event.originalEvent.target!=r?i.event.originalEvent.target:i.event.target,o="",c,h,s,y,l,v,e,a,f,p;if(this._isSchemaClick=i._isSchemaClick?!0:!1,u!=r&&u.className!=r&&u.className!=""&&u.className.indexOf("e-minus")>-1){i.olapCtrlObj=i._isSchemaClick?this._schemaData:this;t.Pivot._onNodeCollapse(i);return}if(jQuery.each(this._isSchemaClick?this._schemaData._editorTreeData:this._editorTreeData,function(n,t){if(t.id==i.id)return t.expanded=!0,t.isChildMerged=!0,!1}),c=n(u).parents("li").first().children().find("li").length,h=i._isSchemaClick?this._schemaData._memberTreeObj.dataSource():this._memberTreeObj.dataSource(),this.model.enableMemberEditorPaging)for(s=0;s<h.length;s++)if(h[s].parentId==i.id||h[s].pid==i.id){i.isChildLoaded=!0;t.Pivot.closePreventPanel(this);return}if(!t.isNullOrUndefined(this)&&this.model.enableMemberEditorPaging&&t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",i.id)).length>0&&u!=r&&u.className!=r&&u.className!=""&&u.className.indexOf("e-plus")>-1&&c==0){i.isChildLoaded=!0;t.Pivot.closePreventPanel(this);this.pNode=u;this._fetchChildNodeSuccess({ChildNodes:JSON.stringify(t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",i.id))),customObject:this.model.customObject});return}if(u!=r&&u.className!=r&&u.className!=""&&u.className.indexOf("e-plus")>-1&&c==0){n(u).removeClass("e-plus").addClass("e-load");y=n(u).parent().find("input.e-checkbox").prop("checked");v=n(u).parents("li").first().attr("data-tag");this.pNode=u;try{l=JSON.parse(this.model.pivotControl!=r?this.model.pivotControl.getOlapReport():this.getOlapReport()).Report}catch(w){l=this.model.pivotControl!=r?this.model.pivotControl.getOlapReport():this.getOlapReport()}for(e=this.element.find(".e-pivotButton"),f=0;f<e.length>0;f++)n(e[f]).attr("data-tag").indexOf(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?"":this._schemaData._curFilteredText:this._curFilteredText)>-1&&n(e[f]).attr("data-tag").split(":")[1].length==(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?0:this._schemaData._curFilteredText.length:this._curFilteredText.length)?o=n(e[f]).attr("data-tag"):n(e[f]).attr("data-tag").indexOf(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?"":this._schemaData._curFilteredText:this._curFilteredText)>-1&&(a=n(e[f]).attr("data-tag"));o=o==""?t.isNullOrUndefined(a)?t.isNullOrUndefined(this._curFilteredText)?this._schemaData._curFilteredText:this._curFilteredText:a.split(":")[1]:o.split(":")[1];this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"memberExpanded",element:this.element,customObject:this.model.customObject});p=JSON.stringify(this.model.customObject);this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.memberExpand,JSON.stringify({action:"memberExpanded",checkedStatus:y,parentNode:n(u).parents("li")[0].id,tag:v,cubeName:JSON.parse(this._olapReport).CurrentCube+"##"+o,currentReport:l,customObject:p}),this._fetchChildNodeSuccess)}},_fetchChildNodeSuccess:function(i){var u,e,c,f,o,s,h;i.length>1&&i[0]!=r?(u=JSON.parse(i[0].Value),i[1]!=null&&i[1]!=r&&(this.model.customObject=i[1].Value)):i.d!=r?(u=JSON.parse(i.d[0].Value),i.d[1]!=null&&i.d[1]!=r&&(this.model.customObject=i.d[1].Value)):(u=JSON.parse(i.ChildNodes),i.customObject!=null&&i.customObject!=r&&(this.model.customObject=i.customObject));c={id:"id",parentId:"pid",hasChild:"hasChildren",text:"name",isChecked:"checkedStatus"};e=n(this.pNode).parents("li").length>1?n(this.pNode).parents("li").first():n(this.pNode).parents("li");n(n(e).find("input.nodecheckbox")[0]).ejCheckBox({checked:!1});f=this._isSchemaClick?this._schemaData:this;this.model.enableMemberEditorPaging?(o=t.Pivot._generateChildWithAncestors(f,e,this.model.enableMemberEditorPaging,this.model.memberEditorPageSize),u.length>=this.model.memberEditorPageSize||o.lstChildren.length>=this.model.memberEditorPageSize?(f.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),f._lastSavedTree=[],t.Pivot._makeAncestorsExpandable(f,e[0].id),f._isEditorDrillPaging=!0,s=o.allLvlLst.length>1&&o.lstChildren.length>=this.model.memberEditorPageSize?t.Pivot._getParentsTreeList(f,o.lstParents[0].id,f._editorTreeData):n.grep(f._editorTreeData,function(n){return n.id==e["0"].id})[0],h={childNodes:o.allLvlLst.length>1&&o.lstChildren.length>=this.model.memberEditorPageSize?o.lstChildren:u,parentNode:s},t.Pivot._drillEditorTreeNode(h,f,this.model.memberEditorPageSize)):t.isNullOrUndefined(this._memberTreeObj)||!this._editorFlag||this._isSchemaClick?t.isNullOrUndefined(this._schemaData._memberTreeObj)||this._schemaData._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(u,this._schemaData,this),e):this._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(u,this,this),e)):(t.isNullOrUndefined(this._memberTreeObj)||!this._editorFlag||this._isSchemaClick?t.isNullOrUndefined(this._schemaData._memberTreeObj)||this._schemaData._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(u,this._schemaData,this),e):this._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(u,this,this),e),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&n.merge(f._editorTreeData,n.extend(!0,[],u)));u.length>0&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.enableMemberEditorPaging&&!t.DataManager(f._editorTreeData).executeLocal(t.Query().where("pid","equal",u[0].pid)).length>0&&n.merge(f._editorTreeData,n.extend(!0,[],u));n.each(n(e).children().find("li"),function(n,t){t.setAttribute("data-tag",u[n].tag)});this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"memberExpanded",element:this.element,customObject:this.model.customObject});t.isNullOrUndefined(this._schemaData)||this.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")},_beforeNodeExpand:function(n){t.Pivot.getChildNodes(n,this._selectedField,this._currentReportItems,this.model.dataSource,this)},_generateAllMember:function(t,i){this.olapCtrlObj._allMember=n(n(i).find("Axis:eq(0) Tuple:eq(0)").children().children()[1]).text()},_generateMembers:function(i,u){var o=n(u).find("Axis:eq(0) Tuple"),e=[],h={},f,s,c,l;for(e.push({id:"All",name:"All",checkedStatus:!0,tag:""}),f=0;f<o.length;f++)s=n(n(u).find("Axis:eq(0) Tuple:eq("+f+")").children().children()[0]).text(),c=n(n(u).find("Axis:eq(0) Tuple:eq("+f+")").children().children()[1]).text(),h={hasChildren:n(o[f]).find("CHILDREN_CARDINALITY").text()!="0",checkedStatus:!0,id:s.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-").replace(/ /g,"_"),name:c,tag:s,level:parseInt(n(o[f]).find("LNum").text())},e.push(h);t.isNullOrUndefined(this.olapCtrlObj)||(this.olapCtrlObj._waitingPopup.hide(),this.olapCtrlObj._editorTreeData=e,this.olapCtrlObj._currentReportItems.push({filterItems:e,fieldName:this.olapCtrlObj._selectedField,dataSrc:this.olapCtrlObj.model.dataSource,pageSettings:this.olapCtrlObj._memberCount}),this.olapCtrlObj.model.enableMemberEditorPaging?(this.olapCtrlObj._memberCount=t.DataManager(this.olapCtrlObj._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All"))).length,l=t.DataManager(this.olapCtrlObj._editorTreeData).executeLocal(t.Query().where("pid","equal",null||r).page(this.olapCtrlObj._memberPageSettings.currentMemeberPage,this.olapCtrlObj.model.memberEditorPageSize+1)),this.olapCtrlObj._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(l)})):this.olapCtrlObj._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(e)}))},_filterBtnClick:function(i){var e,u,o,h,c;if(this._editorFlag=!0,t.Pivot.openPreventPanel(this),this._isAllMemberChecked=!0,this.model.operationalMode==t.Pivot.OperationalMode.ClientMode)if(this.model.enableMemberEditorPaging&&(this._memberPageSettings.endPage=this.model.memberEditorPageSize,this._memberPageSettings.startPage=0,this._memberPageSettings.currentMemeberPage=1),this.model.analysisMode==t.Pivot.AnalysisMode.Olap){var s=this._selectedField=n(i.currentTarget.parentNode).attr("data-tag").split(":")[1],u=[],f;this._dialogHead=n(i.target).siblings(".e-pvtBtn").attr("data-fieldCaption");u=n.map(this._currentReportItems,function(i){if(i.fieldName==s&&(f=i.pageSettings,!t.isNullOrUndefined(i.filterItems)))return n.map(i.filterItems,function(n){return n.expanded&&(n.expanded=!1),n})});this.model.enableMemberEditorPaging&&f&&f&&(this._memberCount=f);u.length>0?(this._editorTreeData=u,this.model.enableMemberEditorPaging&&(this._memberCount=t.DataManager(this._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All"))).length,u=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",null||r).page(this._memberPageSettings.currentMemeberPage,this.model.memberEditorPageSize+1))),this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(u)})):(this._waitingPopup.show(),t.olap._mdxParser.getMembers(this.model.dataSource,s,this))}else this._selectedField=n(i.target).siblings(".e-pvtBtn").attr("data-fieldName"),this._dialogHead=n(i.target).siblings(".e-pvtBtn").attr("data-fieldCaption"),this._selectedAxis=n(i.target).siblings(".e-pvtBtn").attr("data-axis"),e=this._getTreeViewData(this._selectedField,this._selectedAxis),this.model.enableMemberEditorPaging?(u=e,this._editorTreeData=u,this._memberCount=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("id","notequal","All")).length,u=t.DataManager(this._editorTreeData).executeLocal(t.Query().page(this._memberPageSettings.currentMemeberPage,this.model.memberEditorPageSize+1)),this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(u)})):this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(e)});else{this._isFilterBtnClick=!0;this._curFilteredAxis=i.target.parentElement.getAttribute("data-tag").split(":")[0];this._curFilteredText=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?i.target.parentElement.getAttribute("data-tag"):n(n(i.target).siblings()[1]).attr("data-fieldName");this._dialogTitle=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?i.target.parentElement.getAttribute("data-tag"):n(n(i.target).siblings()[1]).attr("data-fieldName");this._dialogHead=n(n(i.target).siblings("button")).attr("data-fieldCaption");try{o=JSON.parse(this.getOlapReport()).Report}catch(l){o=this.getOlapReport()}this._waitingPopup.show();t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(n(this._schemaData.element).width()).height(n(this._schemaData.element).height()).css({top:n(this._schemaData.element).offset().top,left:n(this._schemaData.element).offset().left});this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"fetchMembers",element:this.element,customObject:this.model.customObject});h=JSON.stringify(this.model.customObject);c=JSON.stringify({action:"fetchMembers",headerTag:this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.enableAdvancedFilter?this._dialogTitle+"##"+this.model.enableAdvancedFilter:this._dialogTitle,sortedHeaders:this._ascdes,currentReport:o,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:h});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchMembers,c,this.model.enableMemberEditorPaging?t.Pivot._fetchMemberPageSuccess:this._fetchMemberSuccess)}},_getTreeViewData:function(i){var e=t.Pivot.getReportItemByFieldName(i,this.model.dataSource).item,f=t.PivotAnalysis.getMembers(i),o=[{id:"All",name:"All",checkedStatus:!0}],u;if(e.filterItems!=null&&e.filterItems!=r)for(u=0;u<f.length;u++)o.push({id:f[u],name:f[u],checkedStatus:e.filterItems.filterType==t.PivotAnalysis.FilterType.Include?n.inArray(f[u],e.filterItems.values)>=0:n.inArray(f[u],e.filterItems.values)<0});else for(u=0;u<f.length;u++)o.push({id:f[u],name:f[u],checkedStatus:!0});return o},_applyToolTip:function(i){var g,b,l,f,nt,y,a,d,w;if(this.model.enableToolTip){var h,s,u,e="",o=n(i.target).hasClass("cellValue")?i.target.parentElement:i.target;if(n(o).find("input").length==0&&!n(o).hasClass("curInput")&&!t.isNullOrUndefined(n(o).attr("role"))){if(u=this.element.find(".summary[role!='gridcell'][data-p$=',"+n(o).attr("data-p").split(",")[1]+"'] , .rowheader[role!='gridcell'][data-p$=',"+n(o).attr("data-p").split(",")[1]+"']").last().attr("data-p"),u==null&&(u=n(o).parent("tr").find(".summary,.rowheader").attr("data-p")),u!=null)if(u[0]==0&&parseInt(u.split(",")[0])!=null)u==this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Index&&(s=this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Value);else while(u[0]>=0)u==this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Index&&(h=this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Value,u=parseInt(u.split(",")[0])-1+","+parseInt(u.split(",")[1])),s=s?h!=""?h+"-"+s:s:h;var tt=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,it=this.element.find(tt?".pivotGridFrozenTable ":'tr:has("[role=columnheader]")').length-1,v=n(o).attr("data-p");for(v!=r&&v==this.getJSONRecords()[parseInt(parseInt(v.split(",")[0])*this._rowCount+parseInt(v.split(",")[1]))].Index&&(g=parseInt(v.split(",")[0])),b=0;b<=it;b++)l=g+","+b,g!=null&&l==this.getJSONRecords()[parseInt(parseInt(l.split(",")[0])*this._rowCount+parseInt(l.split(",")[1]))].Index&&(h=this.getJSONRecords()[parseInt(parseInt(l.split(",")[0])*this._rowCount+parseInt(l.split(",")[1]))],h.CSS.indexOf("value")==-1&&(e==""?e=h.Value:h.Value!=""&&(e=e+"-"+h.Value)));n("#"+this._id+"_gridTooltip").remove();this.element.find("span#celval").remove();f=t.isNullOrUndefined(this._pivotClientObj)?o.getBoundingClientRect():n(o).position();(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(nt=this.element.find(".e-scroller").data("ejScroller"),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders||!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(f.left=f.left+this.element.find(".rowhead").width()-nt.model.scrollLeft,f.top=f.top-nt.model.scrollTop));n("#"+this._id).append('<div id="'+this._id+'_gridTooltip" class="e-pGridTooltip" role=\'tooltip\'><\/div>');n(o).find("span.cellValue").attr("aria-label","row- "+s+": column- "+e);y=n(o).find("span.cellValue:not('#celval')").text();this.model.enableRTL?(n("#"+this._id+"_gridTooltip").append('<p id="value" class="e-tooltipText">'+(y?y:this._getLocalizedLabels("NoValue"))+":"+this._getLocalizedLabels("ToolTipValue")+"<\/p>"),n("#"+this._id+"_gridTooltip").append('<p id="row" class="e-tooltipText">'+(s==r||this._rowCount==1?this._getLocalizedLabels("NoValue"):this._direction(s))+":"+this._getLocalizedLabels("ToolTipRow")+"<\/p>"),n("#"+this._id+"_gridTooltip").append('<p id="column" class="e-tooltipText">'+(e==r||e==""?this._getLocalizedLabels("NoValue"):this._direction(e))+":"+this._getLocalizedLabels("ToolTipColumn")+"<\/p>")):(n("#"+this._id+"_gridTooltip").append('<p id="value" class="e-tooltipText">'+this._getLocalizedLabels("ToolTipValue")+": "+(y?y:this._getLocalizedLabels("NoValue"))+"<\/p>"),n("#"+this._id+"_gridTooltip").append('<p id="row" class="e-tooltipText">'+this._getLocalizedLabels("ToolTipRow")+": "+(s==r||this._rowCount==1?this._getLocalizedLabels("NoValue"):s)+"<\/p>"),n("#"+this._id+"_gridTooltip").append('<p id="column" class="e-tooltipText">'+this._getLocalizedLabels("ToolTipColumn")+": "+(e==r||e==""?this._getLocalizedLabels("NoValue"):e)+"<\/p>"));a=0;a=t.isNullOrUndefined(this._pivotClientObj)?n("#"+this._id).parent().position().left+n("#"+this._id).parent().width():n("#"+this._id).parent().position().left+this._pivotClientObj.element.find(".e-gridContainer").width();var k=f.left+n("#"+this._id+"_gridTooltip").width(),p=0,c=0;t.isNullOrUndefined(this._pivotClientObj)?(p=(f.left>0?f.left:0)+(a-k<0?a-k-20:5),c=n(this.element).height()-f.top<100?f.top-n("#"+this._id+"_gridTooltip").outerHeight()-2:f.top+40,d=n(i.target).hasClass("cellValue")?i.target.parentElement:i.target,w=d.getBoundingClientRect().width/d.offsetWidth,w>1&&(c=n(d).position().top/w,c=n(this.element).height()-c*w<100*w?c-n("#"+this._id+"_gridTooltip").outerHeight():c+40)):(p=(f.left>0?f.left:0)+(a-k<50?a-k-40:5)+this._pivotClientObj.element.find(".e-gridContainer").scrollLeft(),c=(this._pivotClientObj.element.find(".e-gridContainer").height()-f.top<150?f.top-n("#"+this._id+"_gridTooltip").outerHeight()-2:f.top+40)+this._pivotClientObj.element.find(".e-gridContainer").scrollTop());!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableRTL&&(p=n("#"+this._pivotClientObj._id+"_PivotGrid").parent().hasClass("e-maximumView")?f.left:p-(n("#"+this._pivotClientObj._id+"_PivotGrid").position().left+this._pivotClientObj.element.find(".e-gridContainer").scrollLeft()));n("#"+this._id+"_gridTooltip").css({left:p,top:c});this.model.enableToolTipAnimation?n("#"+this._id+"_gridTooltip").show("fast"):n("#"+this._id+"_gridTooltip").show();t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj.controlPlacement()!="tile"||n("#"+this._id+"_gridTooltip").css("position","absolute")}}},_applyVScrolling:function(){var p,c=!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling,w=c?this._pivotClientObj.element.find(".e-pivotgrid"):n(this.element).find(".virtualScrollGrid"),r=c?this._pivotClientObj:this,i=c&&!t.isNullOrUndefined(this._pivotClientObj._pivotGrid)?this._pivotClientObj._pivotGrid:this,s=c&&this.model.isResponsive,h,v,f,l,e,y,u,o,a;if(i._seriesPageCount>1){h=function(){return s?Math.round(r.element.find(".e-vScrollPanel").offset().top)+1:Math.round(r.element.find(".e-vScrollPanel").offset().top)+1};v=n(r.element).find(".e-vScrollPanel");v.height(c?this._pivotClientObj.model.isResponsive?parseInt(this._pivotClientObj.element.find(".e-controlPanel").height()):this._pivotClientObj.controlPlacement()=="tile"?parseInt(this._pivotClientObj.element.find(".e-gridContainer").parents("table:eq(0)").height()):parseInt(this._pivotClientObj.element.find(".e-gridContainer").height()):n(w).height());v.html(t.buildTag("div.e-vScrollThumb")[0].outerHTML);f=v.find(".e-vScrollThumb");f.height(Math.max(Math.ceil((c?this._pivotClientObj.model.isResponsive?parseInt(this._pivotClientObj.element.find(".e-controlPanel").height()):parseInt(this._pivotClientObj.element.find(".e-gridContainer").height()):n(w).height())/i._seriesPageCount),15));l=v.height()-f.height()-2;f.offset({top:h()+(i._seriesCurrentPage-1)*(l/(i._seriesPageCount-1))});n(".e-vScrollPanel").on("mousewheel DOMMouseScroll",function(t){var u,e;n("body").on("mousewheel DOMMouseScroll",function(n){return n.preventDefault(),n.stopPropagation(),!1});initThumbPos=(s?f.offset().top:f.position().top)-h();u=i._seriesCurrentPage;movedDistance=t.originalEvent.wheelDelta<0||t.originalEvent.detail>0?t.target.offsetParent.offsetTop+10:-t.target.offsetParent.offsetTop-10;r.element.find(".e-seriesPageIndicator").removeClass("inActive").css({top:f.position().top,left:f.position().left+20});u=i._seriesCurrentPage;window.navigator.userAgent.indexOf("MSIE ")>-1?n(document).on("selectstart",function(n){n.preventDefault()}):window.getSelection().removeAllRanges();movedDistance>0&&initThumbPos+movedDistance<=l||movedDistance<0&&initThumbPos+movedDistance>=0?e=initThumbPos+movedDistance+h():initThumbPos+movedDistance>l?e=h()+l:initThumbPos+movedDistance<0?e=h():"";f.offset({top:e});u=Math.ceil(((s?f.offset().top:f.position().top)-h())/(l/i._seriesPageCount))==0?1:Math.ceil(((s?f.offset().top:f.position().top)-h())/(l/i._seriesPageCount));u>i._seriesPageCount&&(u=i._seriesPageCount);(movedDistance>0?i._seriesCurrentPage>u:i._seriesCurrentPage<u)&&(u=i._seriesCurrentPage);r.element.find(".e-seriesPageIndicator").css({top:f.position().top});r.element.find(".series_CurrentPage").html(u);u!=i._seriesCurrentPage&&(i._seriesCurrentPage=u,clearTimeout(p),p=setTimeout(function(){c?i._pivotClientObj.refreshPagedPivotClient("series",i._seriesCurrentPage):i.refreshPagedPivotGrid("series",i._seriesCurrentPage)},250))});n(f).on("mousedown touchstart",function(t){var o,e,a,u;n(this).addClass("dragging");o=t.pageY-h();e=(s?f.offset().top:f.position().top)-h();r.element.find(".e-seriesPageIndicator").removeClass("inActive").css({top:f.position().top,left:f.position().left+20});a=t.pageY-h()-o;u=i._seriesCurrentPage;n(document).on("mousemove touchmove",function(t){if(window.navigator.userAgent.indexOf("Trident")>-1)n(document).on("selectstart",function(n){n.preventDefault()});else window.getSelection().removeAllRanges();var c=t.pageY-h()-o;c!=0&&(c>0&&e+c<=l?f.offset({top:e+c+h()}):c<0&&e+c>=0?f.offset({top:e+c+h()}):e+c>l?f.offset({top:h()+l}):e+c<0&&f.offset({top:h()}),u=Math.floor((Math.round(s?f.offset().top:f.position().top)-h())/(l/i._seriesPageCount))==0?1:Math.floor((Math.round(s?f.offset().top:f.position().top)-h())/(l/i._seriesPageCount)),(a<c?u<i._seriesCurrentPage:u>i._seriesCurrentPage)&&(u=i._seriesCurrentPage));r.element.find(".e-seriesPageIndicator").css({top:f.position().top});r.element.find(".series_CurrentPage").html(u);r.element.find(".e-vScrollThumb").attr("title",r.element.find(".e-seriesPageIndicator").text())});n(document).on("mouseup touchend",function(){n(document).off("selectstart");n(this).off("mousemove touchmove").off("mouseup touchend");n(f).removeClass("dragging");u!=i._seriesCurrentPage?(i._seriesCurrentPage=u,c?i._pivotClientObj.refreshPagedPivotClient("series",i._seriesCurrentPage):i.refreshPagedPivotGrid("series",i._seriesCurrentPage)):r.element.find(".e-seriesPageIndicator").addClass("inActive")})})}if(i._categPageCount>1){e=function(){return s?Math.round(r.element.find(".e-hScrollPanel").offset().left)+1:Math.round(r.element.find(".e-hScrollPanel").offset().left)+1};this.element.parents(".e-pivotclient").length>0&&this._pivotClientObj.element.find(".childsplit").length>0&&this._pivotClientObj.element.find(".childsplit").data("ejSplitter").refresh();y=n(r.element).find(".e-hScrollPanel");y.width(c?this._pivotClientObj.model.enableSplitter?parseInt(this._pivotClientObj.element.find(".controlPanelTD").width()):parseInt(this._pivotClientObj.element.find(".e-controlPanel").width()):n(w).width());y.html(t.buildTag("div.e-hScrollThumb")[0].outerHTML);u=y.find(".e-hScrollThumb");u.width(Math.max(Math.ceil((c?this._pivotClientObj.model.enableSplitter?parseInt(this._pivotClientObj.element.find(".controlPanelTD").width()):parseInt(this._pivotClientObj.element.find(".e-controlPanel").width()):n(w).width())/i._categPageCount),15));o=y.width()-u.width()-2;this.model.enableRTL?u.css({right:(i._categCurrentPage-1)*(o/(i._categPageCount-1))}):u.offset({left:e()+(i._categCurrentPage-1)*(o/(i._categPageCount-1))});n(".e-hScrollPanel").on("mousewheel DOMMouseScroll",function(t){n("body").on("mousewheel DOMMouseScroll",function(n){return n.preventDefault(),n.stopPropagation(),!1});initThumbPos=r.model.enableRTL?r.element.find(".e-hScrollPanel").width()-((s?u.offset().left:u.position().left)+16-e()):(s?u.offset().left:u.position().left)-e();currentPage=i._categCurrentPage;movedDistance=t.originalEvent.wheelDelta<0||t.originalEvent.detail>0?c?t.target.offsetParent.children[1].offsetLeft+10:t.target.offsetParent.offsetLeft+10:c?-t.target.offsetParent.children[1].offsetLeft-10:-t.target.offsetParent.offsetLeft-10;movedDistance=r.model.enableRTL?-movedDistance:movedDistance;r.element.find(".e-categPageIndicator").removeClass("inActive").css({left:u.position().left,top:u.position().top+20});window.navigator.userAgent.indexOf("MSIE ")>-1?n(document).on("selectstart",function(n){n.preventDefault()}):window.getSelection().removeAllRanges();var f;r.model.enableRTL?movedDistance>0&&initThumbPos+movedDistance<=o||movedDistance<0&&initThumbPos+movedDistance>=0?f=initThumbPos+movedDistance:initThumbPos+movedDistance>o?f=o:initThumbPos+movedDistance<0?f=0:"":movedDistance>0&&initThumbPos+movedDistance<=o||movedDistance<0&&initThumbPos+movedDistance>=0?f=initThumbPos+movedDistance+e():initThumbPos+movedDistance>o?f=e()+o:initThumbPos+movedDistance<0?f=e():"";r.model.enableRTL?u.css("right",f):u.offset({left:f});currentPage=r.model.enableRTL?Math.floor((r.element.find(".e-hScrollPanel").width()-((s?u.offset().left:u.position().left)+16-e()))/(o/i._categPageCount))==0?1:Math.floor((r.element.find(".e-hScrollPanel").width()-((s?u.offset().left:u.position().left)+16-e()))/(o/i._categPageCount)):Math.floor((Math.round(s?u.offset().left:u.position().left)-e())/(o/i._categPageCount))==0?1:Math.floor((Math.round(s?u.offset().left:u.position().left)-e())/(o/i._categPageCount));currentPage=currentPage>i._categPageCount?i._categPageCount:currentPage<1?1:currentPage;(movedDistance>0?i._categCurrentPage>currentPage:i._categCurrentPage<currentPage)&&(currentPage=i._categCurrentPage);r.element.find(".e-categPageIndicator").css({left:u.position().left});r.element.find(".categ_CurrentPage").html(currentPage);currentPage!=i._categCurrentPage&&(i._categCurrentPage=currentPage,clearTimeout(p),p=setTimeout(function(){c?i._pivotClientObj.refreshPagedPivotClient("categ",i._categCurrentPage):i.refreshPagedPivotGrid("categ",i._categCurrentPage)},250))});n(u).on("mousedown touchstart",function(t){var l,h,a,f;n(this).addClass("dragging");l=r.model.enableRTL?r.element.find(".e-hScrollPanel").width()-(t.pageX-e()):t.pageX-e();h=r.model.enableRTL?r.element.find(".e-hScrollPanel").width()-((s?u.offset().left:u.position().left)+16-e()):(s?u.offset().left:u.position().left)-e();r.element.find(".e-categPageIndicator").removeClass("inActive").css({left:u.position().left,top:u.position().top+20});a=r.model.enableRTL?r.element.find(".e-hScrollPanel").width()-(t.pageX-e())-l:t.pageX-e()-l;f=i._categCurrentPage;n(document).on("mousemove touchmove",function(t){if(window.navigator.userAgent.indexOf("Trident")>-1)n(document).on("selectstart",function(n){n.preventDefault()});else window.getSelection().removeAllRanges();var c=r.model.enableRTL?r.element.find(".e-hScrollPanel").width()-(t.pageX-e())-l:t.pageX-e()-l;c!=0&&(c>0&&h+c<=o?r.model.enableRTL?u.css({right:h+c}):u.offset({left:h+c+e()}):c<0&&h+c>=0?r.model.enableRTL?u.css({right:h+c}):u.offset({left:h+c+e()}):h+c>o?r.model.enableRTL?u.css({right:o}):u.offset({left:e()+o}):h+c<0&&(r.model.enableRTL?u.css({right:"0px"}):u.offset({left:e()})),f=r.model.enableRTL?Math.floor((r.element.find(".e-hScrollPanel").width()-((s?u.offset().left:u.position().left)+16-e()))/(o/i._categPageCount))==0?1:Math.floor((r.element.find(".e-hScrollPanel").width()-((s?u.offset().left:u.position().left)+16-e()))/(o/i._categPageCount)):Math.floor((Math.round(s?u.offset().left:u.position().left)-e())/(o/i._categPageCount))==0?1:Math.floor((Math.round(s?u.offset().left:u.position().left)-e())/(o/i._categPageCount)),f=f>i._categPageCount?i._categPageCount:f<1?1:f,(a<c?f<i._categCurrentPage:f>i._categCurrentPage)&&(f=i._categCurrentPage));r.element.find(".e-categPageIndicator").css({left:u.position().left});r.element.find(".categ_CurrentPage").html(f);r.element.find(".e-hScrollThumb").attr("title",r.element.find(".e-categPageIndicator").text())});n(document).on("mouseup touchend",function(){n(document).off("selectstart");n(this).off("mousemove touchmove").off("mouseup touchend");n(u).removeClass("dragging");f!=i._categCurrentPage?(i._categCurrentPage=f,c?i._pivotClientObj.refreshPagedPivotClient("categ",i._categCurrentPage):i.refreshPagedPivotGrid("categ",i._categCurrentPage)):r.element.find(".e-categPageIndicator").addClass("inActive")})})}c&&(i._categPageCount<=1&&(a=this._pivotClientObj.element.find(".e-outerTable").height()-58,this._pivotClientObj.element.find(".e-gridContainer").height(a),this._pivotClientObj.element.find(".e-chartContainer").height(a)),i._seriesPageCount<=1&&(a=this._pivotClientObj.element.find("ul.clientTab").width()-2,this._pivotClientObj.element.find(".e-gridContainer").width(a),this._pivotClientObj.element.find(".e-chartContainer").width(a)),this._pivotClientObj.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(this._pivotClientObj.element.find(".e-hScrollThumb").length>0?this._pivotClientObj.element.find(".e-gridContainer,.e-chartContainer").height(this._pivotClientObj.element.find(".e-controlPanel").height()-(this._pivotClientObj.element.find("ul.clientTab").height()+23)):this._pivotClientObj.element.find(".e-gridContainer,.e-chartContainer").height(this._pivotClientObj.element.find(".e-controlPanel").height()-this._pivotClientObj.element.find("ul.clientTab").height()-2),this._pivotClientObj.element.find(".e-vScrollPanel").css("margin-left","7px")));n("body").off("mousewheel DOMMouseScroll")},_getLocalizedLabels:function(n){return t.isNullOrUndefined(t.PivotGrid.Locale[this.locale()])||t.PivotGrid.Locale[this.locale()][n]==r?t.PivotGrid.Locale["en-US"][n]:t.PivotGrid.Locale[this.locale()][n]},_drillDown:function(i){var u,e,v,k,d,c,h,ft,w,f,b,tt,g,rt,r,s,o;if(this._drillCaption=n(i.target).parent().find(".cellValue").text(),h=i.target.className,this._startDrilldown=!0,u=this,e=n(this.element).parents(".e-pivotclient").length>0?n(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,h=h.split(" "),n(i.target).hasClass("e-expand")?this._drillAction="drilldown":n(i.target).hasClass("e-collapse")&&(this._drillAction="drillup"),v=n(n(i.target).parent()).hasClass("rowheader")||n(n(i.target).parent()).attr("role")=="rowheader"?"rowheader":"colheader",this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){t.isNullOrUndefined(e)?this._waitingPopup.show():(e._isTimeOut=!0,setTimeout(function(){e._isTimeOut&&u._waitingPopup.show()},800));for(var y=n(i.target).parent().attr("data-p"),r=this.getJSONRecords()[parseInt(parseInt(y.split(",")[0])*this._rowCount+parseInt(y.split(",")[1]))].Info,ut=r.replace(/&/g,"&amp;"),p=parseInt(y.split(",")[0]),nt=parseInt(y.split(",")[1]);p>0;){for(p--,k=this.getJSONRecords()[p*this._rowCount+nt].Info,d=nt;k==""&&d>0;)d--,k=this.getJSONRecords()[p*this._rowCount+d].Info;r=k+">#>"+r}return c=this.element.parents(".e-pivotclient").length>0?this.element.parents(".e-pivotclient").data("ejPivotClient"):t.isNullOrUndefined(this._pivotClientObj)?this:this._pivotClientObj,c.pluginName=="ejPivotClient"&&v=="rowheader"&&c.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(c._drillInfo=r,c.setChartDrillParams(r,this._drillAction)),c._pivotRecords={records:this.getJSONRecords(),rowCount:this._rowCount},n(i.target).hasClass("e-collapse")?this.updateDrilledReport({uniqueName:ut,index:y,action:"collapse"},v,c):this.updateDrilledReport({uniqueName:ut,index:y},v,c),!1}if(this.element.find(".e-dialog").remove(),!this.model.enableDeferUpdate){this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this._off(this.element,"click",".e-expand, .e-collapse");this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.element.find(".colheader, .rowheader, .value").removeClass("e-droppable");h=i.target.className;ft=n(i.target).parent();this._startDrilldown=!0;h=h.split(" ");h[0]=="e-expand"?this._drillAction="drilldown":h[0]=="e-collapse"&&(this._drillAction="drillup");this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"drillDown",element:this.element,customObject:this.model.customObject});w=JSON.stringify(this.model.customObject);f=n(i.target).parent().attr("data-p");this._drillCaption=n(i.target).parent().find(".cellValue").text();t.isNullOrUndefined(u._pivotClientObj)||t.isNullOrUndefined(u._pivotClientObj._waitingPopup)?t.isNullOrUndefined(e)?this._waitingPopup.show():(e._isTimeOut=!0,setTimeout(function(){e._isTimeOut&&u._waitingPopup.show()},800)):(u._pivotClientObj._isTimeOut=!0,setTimeout(function(){u._pivotClientObj._isTimeOut&&(n("#"+u._pivotClientObj._id+"_maxView")[0]?(n("#"+u._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!0}),u._maxViewLoading=n("#"+u._pivotClientObj._id+"_maxView").data("ejWaitingPopup")):u._pivotClientObj._waitingPopup.show())},800));b=this.model.analysisMode=="relational"?this._drillHeaders.join("||"):this.getJSONRecords()[parseInt(parseInt(f.split(",")[0])*this._rowCount+parseInt(f.split(",")[1]))].Info;try{o=n(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?JSON.parse(this._pivotClientObj.getOlapReport()).Report:this._pivotClientObj.currentReport:JSON.parse(this.getOlapReport()).Report}catch(et){o=n(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this._pivotClientObj.getOlapReport():this._pivotClientObj.currentReport:this.getOlapReport()}if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){tt=null;!t.isNullOrUndefined(this.model.valueSortSettings)&&this.element.find(".valueSorting").length>0&&!t.isNullOrUndefined(t.PivotAnalysis._valueSorting)&&(tt=this.element.find(".valueSorting").parent());var l=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(this.model.enableAdvancedFilter||(n(this.element).parents(".e-pivotclient").length>0||n(this.element).parents(".e-fullScreenView").length>0)&&this._pivotClientObj.model.enableAdvancedFilter)?n(this.element).find(".e-pivotGridTable").detach():this._table,a=this._getFieldName(n(i.target).parent()[0]),it=n(n(i.target).parent()).hasClass("rowheader")||n(n(i.target).parent()).attr("role")=="rowheader"?"rowheader":n(n(i.target).parent()).hasClass("colheader")||n(n(i.target).parent()).attr("role")=="columnheader"?"columnheader":"";this.model.enablePaging||this.model.enableVirtualScrolling||(n(i.target).hasClass("e-collapse")?(t.isNullOrUndefined(this.model.collapsedMembers)&&(this.model.collapsedMembers={}),t.isNullOrUndefined(this.model.collapsedMembers[a])?this.model.collapsedMembers[a]=[n(n(i.target).parent()[0]).text().trim()]:this.model.collapsedMembers[a].push(n(n(i.target).parent()[0]).text().trim())):n(i.target).hasClass("e-expand")&&(this.model.collapsedMembers[a]=n.grep(this.model.collapsedMembers[a],function(t){return t!=n(n(i.target).parent()[0]).text().trim()})),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(this.model.enableAdvancedFilter||(n(this.element).parents(".e-pivotclient").length>0||n(this.element).parents(".e-fullScreenView").length>0)&&this._pivotClientObj.model.enableAdvancedFilter)?(this._collapseMember(l,i.target),n(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen?this.element.find("#"+this._id+"Toolbar").append(l):this.element.append(l)):(this._collapseMember(l,l.find("[data-p='"+f+"']").children("span")[0]),this._cropHtml(l),this.model.enableColumnResizing&&this.model.resizeColumnsToFit&&!this.model.isResponsive&&this.element.find(".e-pivotGridTable").removeAttr("style"),this._mergeHtml(it,f,l,this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(this.element).find(".e-pivotGridTable"):n(this.element).find("table")),(this.model.resizeColumnsToFit||!this.model.enableColumnResizing)&&(this.model.enableColumnResizing||this.model.resizeColumnsToFit)||this.element.find(".e-pivotGridTable").css("width","100%")),this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this._applyFrozenHeaderWidth(this._JSONRecords,this._drillAction,ft):(this.model.enableColumnResizing&&this.model.resizeColumnsToFit||this.model.enableColumnResizing&&!this.model.resizeColumnsToFit)&&this._resizeColumnsWidth(),this._hideGrandTotal(l),this.model.enableGroupingBar&&(g=n("#"+this._id).find(".e-pivotGridTable").width(),this.element.find(".groupingBarPivot .e-drag").width(g-5),rt=n("#"+this._id).find(".e-pivotGridTable").find("th").width(),this.element.find(".groupingBarPivot .values").width(rt-2),this.element.find(".groupingBarPivot .columns").width(g-rt),this.element.find(".groupingBarPivot .valueColumn").width(g)),this.element.find(".colheader, .rowheader, .value").addClass("e-droppable"),t.isNullOrUndefined(e)?t.isNullOrUndefined(u._pivotClientObj)||(u._pivotClientObj._isTimeOut=!1):e._isTimeOut=!1,this._waitingPopup.hide());var ot=i,p=parseInt(f.split(",")[0]),nt=parseInt(f.split(",")[1]);if(this._drillCaption==""&&(this._drillCaption=n.trim(n(i.target).parent(":not(span)").text().replace("expanded","").replace("collapsed",""))),r=this._drillCaption,r=n.trim(this._getMemberInfo(r,nt,p,it)),s=this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?!0:!1,it=="rowheader"?(this.model.enablePaging||this.model.enableVirtualScrolling)&&(this._drillAction=="drillup"?this.model.enableCollapseByDefault?this._drillHeaders.row=this._drillHeaders.row.filter(function(n){if(n!=(s?r:r.split(">#>").join(".")))return n}):this._drillHeaders.row.push(s?r:r.split(">#>").join(".")):this.model.enableCollapseByDefault?this._drillHeaders.row.push(s?r:r.split(">#>").join(".")):this._drillHeaders.row=this._drillHeaders.row.filter(function(n){if(n!=(s?r:r.split(">#>").join(".")))return n})):(this.model.enablePaging||this.model.enableVirtualScrolling)&&(r.startsWith(">#>")&&(r=r.substring(3,r.length)),this._drillAction=="drillup"?this.model.enableCollapseByDefault?this._drillHeaders.column=this._drillHeaders.column.filter(function(n){if(n!=(s?r:r.split(">#>").join(".")))return n}):this._drillHeaders.column.push(s?r:r.split(">#>").join(".")):this.model.enableCollapseByDefault?this._drillHeaders.column.push(s?r:r.split(">#>").join(".")):this._drillHeaders.column=this._drillHeaders.column.filter(function(n){if(n!=(s?r:r.split(">#>").join(".")))return n}),r=""),this.model.enableVirtualScrolling||this.model.enablePaging)if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){try{o=JSON.parse(this.getOlapReport()).Report}catch(et){o=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",drillHeaders:JSON.stringify(this._drillHeaders),currentReport:o,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),this._renderControlSuccess)}else this._refPaging();this.model.valueSortSettings&&this._refreshValueSortIcons(tt);t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("gridDrillSuccess",{gridObj:this,drillAction:this._drillAction,drilledMember:r,fieldName:a,axis:v,cellPosition:f});this._trigger("drillSuccess",{gridObj:this,drillAction:this._drillAction,drilledMember:r,fieldName:a,axis:v,cellPosition:f});this.model.enableGroupingBar&&this._createFields("drilldown",n("#"+this._id).find(".e-pivotGridTable").width(),n("#"+this._id).find(".e-pivotGridTable th").outerWidth());this._unWireEvents();this._wireEvents();this._drillAction=""}else this.layout()!=""||this.layout()!="normal"?t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:f,currentReport:o,headerInfo:b,layout:this.layout(),customObject:w}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:f,currentReport:o,clientReports:this._pivotClientObj.reports,headerInfo:b,layout:this.layout(),customObject:w}),this._drillDownSuccess):t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:f,currentReport:o,headerInfo:b,customObject:w}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:f,currentReport:o,clientReports:this._pivotClientObj.reports,headerInfo:b,customObject:w}),this._drillDownSuccess)}},_getMemberInfo:function(n,i,r,u){if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(this.model.paging||this.model.enableVirtualScrolling))n=this.getJSONRecords()[this._rowCount*r+i].Info;else while(u=="rowheader"?r>0:i>0){u=="rowheader"?r--:i--;for(var f=this.getJSONRecords()[this._rowCount*r+i].Value,e=i;f==""&&(u=="rowheader"?e>0:r>0);)u=="rowheader"?e--:r--,f=this.getJSONRecords()[this._rowCount*r+e].Value;n=f+">#>"+n}return n},_collapseMember:function(i,u){var tt,st,v,gt,f,c,p,ci,s,b,pi,a,ut,l,ft,ht,g,h,it,et,ri,yt,d,w,li,o,ti;if(!this.model.enablePaging&&!this.model.enableVirtualScrolling){var e=n(u).parent()[0],y=n(e).attr("data-p"),ct=n(u).attr("data-tag")!=r?parseInt(n(u).attr("data-tag"))+e.rowSpan:e.rowSpan,vt=this.model.enableAdvancedFilter&&!t.isNullOrUndefined(n(e).attr("vfcolspan"))?parseInt(n(e).attr("vfcolspan")):n(u).attr("data-tag")!=r?parseInt(n(u).attr("data-tag"))+e.colSpan:e.colSpan,f=n(u).closest("tr")[0],fi=null,ei=null,ot="false",oi=0;if(e.className.indexOf("rowheader")>=0||e.className.indexOf("summary")>=0&&n(e).attr("role")=="rowheader"){if(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout){var ai=this.getJSONRecords()[1].Index=="0,0"?1:0,ct=this.getJSONRecords()[parseInt(y.split(",")[0])*this._rowCount+parseInt(y.split(",")[1])+ai].RowSpan,pt=f;for(n(u).attr("class").indexOf("e-expand")>-1&&n(f).removeAttr("data-tag"),s=0;s<ct;s++)n(u).attr("class")&&n(u).attr("class").indexOf("e-collapse")>-1&&(n(n(f).next()).attr("data-tag")==r&&n(n(f).next()).attr("data-tag",y),n(n(f).next()).css("display","none"),(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&n(i).find(".pivotGridValueTable  td[data-i$=',"+n(n(f).next()).find("td").attr("data-i").split(",")[1]+"']").css("display","none")),n(u).attr("class").indexOf("e-expand")>-1&&(n(n(f).next()).attr("data-tag")==r||n(n(f).next()).attr("data-tag")==y)&&(n(n(f).next()).css("display","table-row"),n(n(f).next()).removeAttr("data-tag"),(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&n(f).parents().find(".pivotGridValueTable td[data-i$=',"+n(n(f).next()).find("td").attr("data-i").split(",")[1]+"']").css("display","")),f=n(f).next();var wt=this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders?"td":"th",bt=this.model.enableRTL?"margin-right":"margin-left",si=n(pt).find(wt+" span:not(.cellValue)").css(bt);n(pt).find(wt+" span:not(.cellValue)").remove();n(pt).find(wt).prepend(n(u).attr("class").indexOf("e-collapse")>-1?'<span style="'+bt+":"+si+'" class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;<\/span>':'<span style="'+bt+":"+si+'" class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;<\/span>');return}var hi=!n(e).index()>0,kt,vi,dt=kt=!1;if(n(u).attr("class")&&n(u).attr("class").indexOf("collapse")>-1){for(s=0;s<ct;s++){if(fi=n(f).next(),hi)n(f).find(".stot,.rstot").length>=1&&s==1&&n(n(f).find(".stot,.rstot")).find(".e-expand").length>=1&&(kt=!0),(n(n(f).find(".stot,.rstot")).find(".e-expand").length>=1||n(f).css("display")=="none")&&(dt=!0),n(f).css("display","none"),n(f).attr("data-tag",n(f).attr("data-tag")!=r?parseInt(n(f).attr("data-tag"))+1:1),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(n(i).find(".pivotGridValueTable tr:eq("+n(f).index()+")").css("display","none"),n(i).find(".pivotGridValueTable tr:eq("+n(f).index()+")").attr("data-tag",n(f).attr("data-tag")!=r?parseInt(n(f).attr("data-tag"))+1:1));else{if(v=e,this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)for(w=n(e).prevAll().length;w<n(i).find("[data-p$=',"+n(e).attr("data-p").split(",")[1]+"'] ").length;w++)n(v).css("display","none").attr("data-hc",n(v).attr("data-hc")==r?1:parseInt(n(v).attr("data-hc"))+1),v=n(n(i).find("[data-p$=',"+n(v).attr("data-p").split(",")[1]+"'] ")[w+1]);else for(w=0;w<=n(e).nextAll().length;w++)n(v).css("display","none").attr("data-hc",n(v).attr("data-hc")==r?1:parseInt(n(v).attr("data-hc"))+1),v=n(v).next();vi=!1;ot="true"}f=fi;hi=!0}for(tt=ot=="true"?e.rowSpan-1:e.rowSpan,n(f).css("display")!="none"&&kt&&(st=n(u).attr("subTag")!=r?parseInt(n(u).attr("subTag"))==-1?e.rowSpan+1:parseInt(n(u).attr("subTag"))+e.rowSpan:e.rowSpan),n(f).css("display")=="none"&&(n(f).css("display",""),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&n(i).find('td.value[data-p$=",'+parseInt(n(f).children().eq(0).attr("data-p").split(",")[1])+'"]').parent().css("display",""),dt=!0,tt=tt-1),dt&&t.isNullOrUndefined(st)&&(st=n(u).attr("subTag")!=r?parseInt(n(u).attr("subTag"))==-1?e.rowSpan:parseInt(n(u).attr("subTag"))+e.rowSpan:e.rowSpan),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&n(i).find(".pivotGridValueTable").length>0?(n(f).find("td").text(n(f).find("td").text().replace(" Total","")),n(f).find("td span:not(.cellValue)").remove(),n(f).find("td").prepend('<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" data-tag="'+ct+":"+ot+'">&nbsp;<\/span>')):(n(f).find("th").text(n(f).find("th").text().replace(" Total","")),n(f).find("th span:not(.cellValue)").remove(),n(f).find("th").prepend('<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" data-tag="'+ct+":"+ot+(t.isNullOrUndefined(st)?"":n(u).attr("isChildSubNode")=="true"?'" subTag="'+st+":"+ot+'" isChildSubNode="true':'" subTag="'+st+":"+ot)+'">&nbsp;<\/span>')),c=n(f).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)"),s=0;s<c.length;s++)parseInt(n(c[s]).attr("data-p").split(",")[0])<parseInt(y.split(",")[0])&&parseInt(n(c[s]).attr("data-p").split(",")[1])+c[s].rowSpan+(n(c[s]).find("span").attr("data-tag")!=r?parseInt(n(c[s]).find("span").attr("data-tag")):0)>=parseInt(y.split(",")[1])+ct&&(c[s].rowSpan-=tt,n(c[s]).find("span").attr("data-tag")==r&&n(c[s]).find("span").attr("isChildSubNode",!0),n(c[s]).find("span").attr("data-tag",n(c[s]).find("span").attr("data-tag")!=r?parseInt(n(c[s]).find("span").attr("data-tag"))+tt:tt),n(c[s]).find("span").attr("subTag",n(c[s]).find("span").attr("subTag")!=r?parseInt(n(c[s]).find("span").attr("subTag"))+tt:tt))}else if(n(u).attr("class")&&n(u).attr("class").indexOf("e-expand")>-1){var it=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,yi,rt=yi=this._isSubTotalhidden=!1,nt=0;for(s=parseInt(n(u).attr("data-tag").split(":")[0]);s>=0;s--)ei=n(f).prev(),n(f).attr("data-tag")==r||parseInt(n(f).attr("data-tag"))<=1?(this._hideSubTotal(n(f),nt,n(u)),this._isSubTotalHide?(rt=!0,this._isSubTotalHide=!1,n(f).css("display","none"),it&&n(i).find(".pivotGridValueTable tr:eq("+n(f).index()+")").css("display","none")):(n(f).css("display","table-row"),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&n(f).find("td[data-hc]").length==0&&n(i).find(".pivotGridValueTable tr:eq("+n(f).index()+")").css("display","table-row"))):oi++,nt=nt==0?1:nt,n(f).attr("data-tag")!=r&&(parseInt(n(f).attr("data-tag")-1)==0?n(f).removeAttr("data-tag"):n(f).attr("data-tag",parseInt(n(f).attr("data-tag"))-1)),f=ei;if(n(u).attr("data-tag").split(":")[1]=="true"){for(v=n(i).find((it?".pivotGridRowTable ":"th")+"[data-p='"+parseInt(n(e).attr("data-p").split(",")[0])+","+(parseInt(n(e).attr("data-p").split(",")[1])-parseInt(n(u).attr("data-tag").split(":")[0]))+"'], td[data-p='"+parseInt(n(e).attr("data-p").split(",")[0])+","+(parseInt(n(e).attr("data-p").split(",")[1])-parseInt(n(u).attr("data-tag").split(":")[0]))+"']"),gt=n(v).nextAll().length,it&&(gt=n.merge(n(v).nextAll(),n(i).find(".pivotGridValueTable tr:eq("+n(v).parent().index()+") td")).length),w=0;w<=gt;w++)n(v).attr("data-hc")==r||parseInt(n(v).attr("data-hc"))<=1?(n(v).removeAttr("data-hc"),n(v).attr("data-hc")==r&&n(v).css("display","")):n(v).attr("data-hc",parseInt(n(v).attr("data-hc"))-1),v=it?n.merge(n(v).nextAll(),n(i).find(".pivotGridValueTable tr:eq("+n(v).parent().index()+") td"))[0]:n(v).next();if(it)for(f=n(u).closest("tr")[0],s=parseInt(n(u).attr("data-tag").split(":")[0]);s>=0;s--)n(f).find("td[data-hc]").length==0&&n(i).find(".pivotGridValueTable tr:eq("+n(f).index()+")").css("display","table-row"),f=n(f).prev()}for(c=n(n(u).closest("tr")[0]).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)"),p=n(u).attr("subTag")!=r&&rt?n(u).attr("subTag").split(":")[1]=="true"?parseInt(n(u).attr("subTag").split(":")[0])-1:parseInt(n(u).attr("subTag").split(":")[0]):(n(u).attr("data-tag").split(":")[1]=="true"?parseInt(n(u).attr("data-tag").split(":")[0])-1:parseInt(n(u).attr("data-tag").split(":")[0]))-oi,ci=n(i).find("th[data-p='"+parseInt(n(e).attr("data-p").split(",")[0])+","+(parseInt(n(e).attr("data-p").split(",")[1])-parseInt(n(u).attr("data-tag").split(":")[0]))+"'], td[data-p='"+parseInt(n(e).attr("data-p").split(",")[0])+","+(parseInt(n(e).attr("data-p").split(",")[1])-parseInt(n(u).attr("data-tag").split(":")[0]))+"']"),rt&&(p=parseInt(n(ci).attr("rowspan")),p=n(u).attr("subTag")!=r?n(u).attr("subTag").split(":")[1]=="true"?p-1:p:n(u).attr("data-tag").split(":")[1]=="true"?p-1:p,p=n(u).attr("subTag")!=r?parseInt(n(u).attr("subTag").split(":")[0])==-1?p:this._isSubTotalhidden?p-1:p:p-1),s=0;s<c.length;s++)parseInt(n(c[s]).attr("data-p").split(",")[0])<parseInt(y.split(",")[0])&&parseInt(n(c[s]).attr("data-p").split(",")[1])+c[s].rowSpan+(n(c[s]).find("span").attr("data-tag")!=r?parseInt(n(c[s]).find("span").attr("data-tag")):0)>=parseInt(y.split(",")[1])&&(rt&&(this._isSubTotalhidden=rt=!1,n(u).attr("isChildSubNode")=="true"&&n(u).removeAttr("isChildSubNode")),c[s].rowSpan+=p,n(c[s]).find("span").attr("data-tag")!=r&&n(c[s]).find("span").attr("data-tag",parseInt(n(c[s]).find("span").attr("data-tag"))-p),parseInt(n(c[s]).find("span").attr("data-tag"))==0&&n(c[s]).find("span").removeAttr("data-tag"),n(c[s]).find("span").attr("subTag")!=r&&n(c[s]).find("span").attr("subTag",parseInt(n(c[s]).find("span").attr("subTag"))-p),parseInt(n(c[s]).find("span").attr("subTag"))==0&&n(c[s]).find("span").removeAttr("subTag"));n(e).find(".cellValue").length>0?n(e).find(".cellValue").text(n.trim(n(e).find(".cellValue").text())+" Total"):n(e).text(n.trim(n(e).text())+" Total");n(e).find(".e-expand").remove();n(e).prepend("<span style='margin-left:10px'><\/span>")}}if(e.className.indexOf("colheader")>=0||e.className.indexOf("summary")>=0&&n(e).attr("role")=="columnheader")if(b=parseInt(y.split(",")[0]),pi=n(i).find("tr"),n(u).attr("class")&&n(u).attr("class").indexOf("e-collapse")>-1){if(ut=e.colSpan,n(e).next().css("display")=="none"){var ni=n(e).next().attr("data-p"),k=parseInt(ni.split(",")[0]),wi=n(i).find("tr"),lt=parseInt(n(e).next().attr("colspan"));if(n(e).next().attr("class").indexOf("stot","cstot")>-1)for(o=0;o<lt;o++){for(l=n(f).nextAll().find("th[data-p^='"+(o+k)+",']"),h=0;h<n(l).length;h++)n(l[h]).css("display","");if(n(l[h]).attr("data-hc")==r||parseInt(n(l[h]).attr("data-hc"))<1)for(n(i).find("td[data-p^='"+(o+k)+",']").css("display",""),d=0;d<n(i).find("td[data-p^='"+(o+k)+",']").length;d++)(n(n(i).find("td[data-p^='"+(o+k)+",']")[d]).attr("data-hc")!=r||n(n(i).find("td[data-p^='"+(o+k)+",']")[d]).attr("data-hc")>-1)&&n(n(i).find("td[data-p^='"+(o+k)+",']")[d]).css("display","none")}n(e).next().css("display","");ut=e.colSpan-lt}for(o=0;o<vt;o++)if(l=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(f).nextAll().find("td[data-p^='"+(o+b)+",']"):n(f).nextAll().find("th[data-p^='"+(o+b)+",']"),l.length!=0){for(h=0;h<n(l).length;h++)n(l[h]).attr("data-hc",n(l[h]).attr("data-hc")!=r?parseInt(n(l[h]).attr("data-hc"))+1:1).css("display","none");(n(l[h]).attr("data-hc")==r||parseInt(n(l[h]).attr("data-hc"))<1)&&(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?(n(i).find(".pivotGridValueTable td[data-p^='"+(o+b)+",']").css("display","none"),n(i).find(".pivotGridValueTable td[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(o+b)+",']").attr("data-ch",1)):(n(i).find("td[data-p^='"+(o+b)+",']").css("display","none"),n(i).find("th[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(o+b)+",']").attr("data-ch",1)))}for(n(e).attr("data-hc",1).css("display","none"),n(e).next().text(n(e).next().text().replace(" Total","")),n(e).next().find("span:not(.cellValue)").remove(),n(e).next().prepend('<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" data-tag="'+vt+'">&nbsp;<\/span>'),a=n(f).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)"),o=0;o<a.length;o++)ti=this.model.enableAdvancedFilter&&!t.isNullOrUndefined(n(a[o]).attr("vfcolspan"))?parseInt(n(a[o]).attr("vfcolspan")):a[o].colSpan,parseInt(n(a[o]).attr("data-p").split(",")[1])<parseInt(y.split(",")[1])&&parseInt(n(a[o]).attr("data-p").split(",")[0])<=parseInt(y.split(",")[0])&&parseInt(n(a[o]).attr("data-p").split(",")[0])+ti+(n(a[o]).find("span").attr("data-tag")!=r?parseInt(n(a[o]).find("span").attr("data-tag")):0)>=parseInt(y.split(",")[0])+vt&&(a[o].colSpan-=ut,n(a[o]).find("span").attr("data-tag",n(a[o]).find("span").attr("data-tag")!=r?parseInt(n(a[o]).find("span").attr("data-tag"))+ut:ut))}else if(n(u).attr("class")&&n(u).attr("class").indexOf("e-expand")>-1){var ii=0,at,rt=at=this._isSubTotalhidden=!1,nt=0,lt=parseInt(n(e).attr("colspan"));if(this._hideSubTotal(n(f),nt,n(u)),this._isSubTotalHide){at=rt=!0;this._isSubTotalHide=!1;var ni=n(e).attr("data-p"),k=parseInt(ni.split(",")[0]),wi=n(i).find("tr");if(n(e).attr("class").indexOf("stot","cstot")>-1)for(o=0;o<lt;o++){for(g=n(f).nextAll().find("th[data-p^='"+(o+k)+",']"),h=0;h<n(g).length;h++)n(g[h]).css("display","none");(n(g[h]).attr("data-hc")==r||parseInt(n(g[h]).attr("data-hc"))<1)&&n(i).find("td[data-p^='"+(o+k)+",']").css("display","none")}n(e).css("display","none")}for(ut=vt-(lt-1),o=1;o<ut;o++){for(l=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(f).nextAll().find("td[data-p^='"+(b-o)+",']"):n(f).nextAll().find("th[data-p^='"+(b-o)+",']"),h=0;h<n(l).length;h++){for(at=!1,ft=0;ft<n(l[h]).length;ft++)(n(n(l[h])[ft]).hasClass("stot")||n(n(l[h])[ft]).hasClass("cstot"))&&!n(n(l[h])[ft]).hasClass("calc")&&this._hideSubTotal(n(n(l[h])[ft]),nt,n(u));if(this._isSubTotalHide){at=!0;this._isSubTotalHide=!1;var ni=n(l[h]).attr("data-p"),k=parseInt(ni.split(",")[0]),wi=n(i).find("tr"),lt=parseInt(n(l[h]).attr("colspan"));if(n(l[h]).attr("class").indexOf("stot","cstot")>-1&&!(n(l[h]).find(".e-expand").length>0))for(ht=0;ht<lt;ht++){for(g=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(f).nextAll().find("td[data-p^='"+(ht+k)+",']"):n(f).nextAll().find("th[data-p^='"+(ht+k)+",']"),h=0;h<n(g).length;h++)n(g[h]).css("display","none");n(g[h]).attr("data-hc")==r||parseInt(n(g[h]).attr("data-hc"))<1?n(i).find("td[data-p^='"+(ht+k)+",']").css("display","none"):ii++}n(l[h]).css("display","none")}n(l[h]).attr("data-hc")==r||parseInt(n(l[h]).attr("data-hc"))==1?(n(l[h]).css("display",""),n(l[h]).removeAttr("data-hc")):parseInt(n(l[h]).attr("data-hc"))-1==0?n(l[h]).removeAttr("data-hc"):n(l[h]).attr("data-hc",parseInt(n(l[h]).attr("data-hc"))-1)}if(nt=nt==0?1:nt,!at)if(n(l).last().attr("data-hc")==r){if(it=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,it?n(i).find("td[data-p^='"+(b-o)+",']").css("display",""):n(i).find("td[data-p^='"+(b-o)+",']").css("display",""),et=[],it){for(ri=n(i).find("[data-p^='0,']:not(.summary)").parent(),yt="",d=0;d<ri.length;d++)yt=yt+(d!=0?" , ":"")+"  .pivotGridValueTable td:eq("+n(ri[d]).index()+")";et=n(i).find(yt)}else et=n(i).find("[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(b-o)+",']");for(n(et).removeAttr("data-ch"),w=0;w<=n(et).length;w++)n(et[w]).attr("data-hc")!=r&&n(et[w]).css("display","none")}else ii++}n(e).prev().removeAttr("data-hc").css("display","");var bi=parseInt(n(e).prev().attr("colspan")),ui=parseInt(n(u).attr("data-tag"))-ii,a=n(f).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)");for(rt&&(rt=!1,li=n(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this._pivotClientObj.getOlapReport():this.getOlapReport(),ui=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?parseInt(n(e).prev().attr("colSpan"))-this.model.dataSource.values.length:parseInt(n(e).prev().attr("colSpan"))-JSON.parse(li).PivotCalculations.length),o=0;o<a.length;o++)ti=this.model.enableAdvancedFilter&&!t.isNullOrUndefined(n(a[o]).attr("vfcolspan"))?parseInt(n(a[o]).attr("vfcolspan")):a[o].colSpan,parseInt(n(a[o]).attr("data-p").split(",")[1])<parseInt(y.split(",")[1])&&parseInt(n(a[o]).attr("data-p").split(",")[0])<parseInt(y.split(",")[0])&&parseInt(n(a[o]).attr("data-p").split(",")[0])+a[o].colSpan+(n(a[o]).find("span").attr("data-tag")!=r?parseInt(n(a[o]).find("span").attr("data-tag")):0)>=parseInt(y.split(",")[0])&&(a[o].colSpan+=ui,n(a[o]).find("span").attr("data-tag")!=r&&n(a[o]).find("span").attr("data-tag",parseInt(n(a[o]).find("span").attr("data-tag"))-ui),parseInt(n(a[o]).find("span").attr("data-tag"))==0&&n(a[o]).find("span").removeAttr("data-tag"));n(e).find(".cellValue").length>0?n(e).find(".cellValue").text(n.trim(n(e).find(".cellValue").text())+" Total"):n(e).text(n.trim(n(e).text())+" Total");n(e).find(".e-expand").remove();n(e).prepend("<span style='margin-left:10px'><\/span>")}}},_generateTreeViewData:function(){var n={catalog:this.model.dataSource.catalog,cube:this.model.dataSource.cube,url:this.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"};this._getTreeData(n,this._loadDimensionElements,{pvtGridObj:this,action:"loadFieldElements"})},_dimensionsDetails:function(t,i){t.pvtGridObj._dimension=n(i).find("row")},_loadDimensionElements:function(t,i){var y,s,h,c,u,f,e;t.pvtGridObj._waitingPopup.show();var o,l={},a={},v=t.pvtGridObj._getConnectionInfo(t.pvtGridObj.model.dataSource.data);for(t.pvtGridObj.schemaTreeView=[],t.pvtGridObj.reportItemNames=[],y='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_DIMENSIONS<\/RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+t.pvtGridObj.model.dataSource.catalog+"<\/CATALOG_NAME><CUBE_NAME>"+t.pvtGridObj.model.dataSource.cube+"<\/CUBE_NAME><\/RestrictionList><\/Restrictions><Properties><PropertyList><Catalog>"+t.pvtGridObj.model.dataSource.catalog+"<\/Catalog> <LocaleIdentifier>"+v.LCID+"<\/LocaleIdentifier><\/PropertyList><\/Properties><\/Discover><\/Body><\/Envelope>",t.pvtGridObj.doAjaxPost("POST",v.url,{XMLA:y},t.pvtGridObj._dimensionsDetails,null,{pvtGridObj:t.pvtGridObj,action:"loadFieldElements"}),s=t.pvtGridObj._dimension,h=0;h<n(i).find("row").length;h++){if(c=n(n(i).find("row")[h]),u=c.find("DIMENSION_UNIQUE_NAME").text(),t.pvtGridObj.model.enableDrillThrough)for(f=0;f<s.length;f++)u==n(s[f]).find("DIMENSION_UNIQUE_NAME").text()&&(o=n(s[f]).find("DIMENSION_CAPTION").text());else o=c.find("DIMENSION_CAPTION").text();u.toLowerCase()=="[measures]"?a={hasChildren:!0,isSelected:!1,id:u,name:o,spriteCssClass:u.toLowerCase()=="[measures]"?"e-folderCDB e-icon":"e-dimensionCDB e-icon",tag:u}:!n(n(i).find("row")[0]).find("HIERARCHY_CAPTION").length>0&&(l={hasChildren:!0,isSelected:!1,id:u,name:o,spriteCssClass:"e-dimensionCDB e-icon",tag:u},t.pvtGridObj.schemaTreeView.push(l))}t.pvtGridObj.schemaTreeView.splice(0,0,a);e={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"};!t.pvtGridObj.model.enableDrillThrough||t.pvtGridObj._schemaData!=r&&t.pvtGridObj._schemaData.model.olap.showNamedSets?(e.request="MDSCHEMA_SETS",t.pvtGridObj._getTreeData(e,t.pvtGridObj._loadNamedSetElements,t)):(e.request="MDSCHEMA_HIERARCHIES",t.pvtGridObj._fieldData.hierarchySuccess==r?t.pvtGridObj._getTreeData(e,t.pvtGridObj._loadHierarchyElements,t):t.pvtGridObj._loadHierarchyElements(t,t.pvtGridObj._fieldData.hierarchySuccess))},_loadNamedSetElements:function(t,i){var f,u;t.pvtGridObj._waitingPopup.show();var s={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},e=t.pvtGridObj.model.dataSource,o=n.map(e.rows,function(n){if(n.fieldName!=r)return n.fieldName});for(n.merge(o,n.map(e.columns,function(n){if(n.fieldName!=r)return n.fieldName})),n.merge(o,n.map(e.filters,function(n){if(n.fieldName!=r)return n.fieldName})),measureGroupItems=[],f=0;f<n(i).find("row").length;f++)u=n(n(i).find("row")[f]),n.inArray(u.find("DIMENSIONS").text().split(".")[0],measureGroupItems)>=0||(treeNodeElement={hasChildren:!0,isSelected:!1,pid:u.find("DIMENSIONS").text().split(".")[0],id:u.find("SET_DISPLAY_FOLDER").text()+"_"+u.find("DIMENSIONS").text().split(".")[0],name:u.find("SET_DISPLAY_FOLDER").text(),spriteCssClass:"e-folderCDB e-icon namedSets"},t.pvtGridObj.schemaTreeView.push(treeNodeElement),measureGroupItems.push(u.find("DIMENSIONS").text().split(".")[0])),treeNodeElement={hasChildren:!0,isSelected:n.inArray("["+n.trim(u.children("SET_NAME").text())+"]",o)>=0,pid:u.find("SET_DISPLAY_FOLDER").text()+"_"+u.find("DIMENSIONS").text().split(".")[0],id:"["+n.trim(u.children("SET_NAME").text()).replace(/\&/g,"&amp;")+"]",name:u.children("SET_CAPTION").text(),spriteCssClass:"e-namedSetCDB e-icon",tag:u.find("EXPRESSION").text()},t.pvtGridObj.schemaTreeView.push(treeNodeElement);s.request="MDSCHEMA_HIERARCHIES";t.pvtGridObj._fieldData.hierarchySuccess==r?t.pvtGridObj._getTreeData(s,t.pvtGridObj._loadHierarchyElements,t):t.pvtGridObj._loadHierarchyElements(t,t.pvtGridObj._fieldData.hierarchySuccess)},_loadHierarchyElements:function(t,i){var h,a,f;t.pvtGridObj._waitingPopup.show();var l={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},o=t.pvtGridObj.model.dataSource,s=n.map(o.rows,function(n){if(n.fieldName!=r)return n.fieldName});for(n.merge(s,n.map(o.columns,function(n){if(n.fieldName!=r)return n.fieldName})),n.merge(s,n.map(o.filters,function(n){if(n.fieldName!=r)return n.fieldName})),h={},a="",f=0;f<n(i).find("row").length;f++){var u=n(n(i).find("row")[f]),c=u.find("DIMENSION_UNIQUE_NAME").text(),e=u.find("HIERARCHY_UNIQUE_NAME").text(),v=n(t.pvtGridObj.schemaTreeView).filter(function(n,t){return t.tag==c}).map(function(n,t){return t});v.length>0&&c!=e&&(h={hasChildren:!0,isSelected:n.inArray(e,s)>=0,pid:c,id:e,name:u.find("HIERARCHY_CAPTION").text(),spriteCssClass:u.find("HIERARCHY_ORIGIN").text()!="2"&&u.find("HIERARCHY_ORIGIN").text()!="6"?"e-hierarchyCDB e-icon":"e-attributeCDB e-icon",tag:e},t.pvtGridObj.schemaTreeView.push(h))}l.request="MDSCHEMA_LEVELS";t.pvtGridObj._getTreeData(l,t.pvtGridObj._loadLevelElements,t)},_loadLevelElements:function(i,r){var u,r;i.pvtGridObj._waitingPopup.show();u=n.map(n(r).find("row"),function(t){if(parseInt(n(t).children("LEVEL_TYPE").text())!="1"&&n(t).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase()!="[measures]")return treeNodeElement={hasChildren:!1,isChecked:!1,id:n(t).find("LEVEL_UNIQUE_NAME").text(),pid:n(t).find("HIERARCHY_UNIQUE_NAME").text(),name:n(t).find("LEVEL_CAPTION").text(),spriteCssClass:"level"+parseInt(n(t).children("LEVEL_NUMBER").text())+" e-icon",tag:n(t).find("LEVEL_UNIQUE_NAME").text()}});n.merge(i.pvtGridObj.schemaTreeView,u);!i.pvtGridObj.model.enableDrillThrough&&i.pvtGridObj._fieldData.measureSuccess?i.pvtGridObj._fieldData.measureSuccess?i.pvtGridObj._loadMeasureElements(i,i.pvtGridObj._fieldData.measureSuccess):(r={catalog:i.pvtGridObj.model.dataSource.catalog,cube:i.pvtGridObj.model.dataSource.cube,url:i.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_MEASURES"},i.pvtGridObj._getTreeData(r,i.pvtGridObj._loadMeasureElements,i)):t.Pivot._createDrillThroughDialog(i.pvtGridObj,i.pvtGridObj.schemaTreeView)},_loadMeasureGroups:function(t,i){t.pvtGridObj._fieldData.measuresGroups=n(i).find("row")},_loadMeasureElements:function(t,i){var e={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},a=t.pvtGridObj.model.dataSource,v=n.map(a.values,function(n){if(n.measures!=r)return n.measures}),s,y,h,o,l;for(this.reportItemNames=n.map(v,function(n){if(n.fieldName!=r)return n.fieldName}),s=[],y="",t.pvtGridObj.model.locale!="en-US"&&(e={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_MEASUREGROUPS"},t.pvtGridObj._getTreeData(e,this._loadMeasureGroups,{pvtGridObj:this,action:"loadFieldElements"})),o=0;o<n(i).find("row").length;o++){var c=n(n(i).find("row")[o]),u=c.children("MEASUREGROUP_NAME").text(),f=c.find("MEASURE_UNIQUE_NAME").text();n.inArray(u,s)>=0||(t.pvtGridObj.model.locale!="en-US"?(l=n.map(t.pvtGridObj._fieldData.measuresGroups,function(t){if(n(t).children("MEASUREGROUP_NAME").text()==u)return n(t).children("MEASUREGROUP_CAPTION").text()}),h=l.length>0?l[0]:u):h=u,treeNodeElement={hasChildren:!0,isChecked:!1,pid:"[Measures]",id:u,name:h,spriteCssClass:"e-measureGroupCDB e-icon",tag:u},t.pvtGridObj.schemaTreeView.push(treeNodeElement),s.push(u));treeNodeElement={hasChildren:!0,isSelected:n.inArray(f,this.reportItemNames)>=0,id:f,pid:u,name:c.children("MEASURE_CAPTION").text(),spriteCssClass:"measure",tag:f};t.pvtGridObj.schemaTreeView.push(treeNodeElement);n.inArray(f,t.pvtGridObj.reportItemNames)>=0&&t.pvtGridObj.reportItemNames.splice(t.pvtGridObj.reportItemNames.indexOf(f),1)}t.pvtGridObj._schemaData.model.olap.showKpi?(treeNodeElement={hasChildren:!0,isChecked:!1,id:"folderStruct",name:"KPI",spriteCssClass:"KPICDB e-folderCDB e-icon",tag:""},t.pvtGridObj.schemaTreeView.splice(1,0,treeNodeElement),e.request="MDSCHEMA_KPIS",t.pvtGridObj._getTreeData(e,t.pvtGridObj._loadKPIElements,t)):t.pvtGridObj._schemaData._createTreeView(this,t.pvtGridObj.schemaTreeView)},_loadKPIElements:function(t,i){for(var a=t.pvtGridObj.model.dataSource,f=this.reportItemNames,l=[],e=0;e<n(i).find("row").length;e++){var u=n(n(i).find("row")[e]),r=u.children("KPI_CAPTION").text(),o=u.children("KPI_goal").text(),s=u.children("KPI_STATUS").text(),h=u.children("KPI_TREND").text(),c=u.find("KPI_VALUE").text();n.inArray(u.children("KPI_NAME").text(),l)>=0||(treeNodeElement={hasChildren:!0,isChecked:!1,pid:"folderStruct",id:r,name:r,spriteCssClass:"e-measureGroupCDB e-icon",tag:r},t.pvtGridObj.schemaTreeView.push(treeNodeElement),l.push(r));treeNodeElement={hasChildren:!0,isSelected:n.inArray(o,f)>=0,id:o,pid:r,name:t.pvtGridObj._getLocalizedLabels("Goal"),spriteCssClass:"kpiGoal e-icon",tag:o};t.pvtGridObj.schemaTreeView.push(treeNodeElement);treeNodeElement={hasChildren:!0,isSelected:n.inArray(s,f)>=0,id:s,pid:r,name:t.pvtGridObj._getLocalizedLabels("Status"),spriteCssClass:"kpiStatus e-icon",tag:s};t.pvtGridObj.schemaTreeView.push(treeNodeElement);treeNodeElement={hasChildren:!0,isSelected:n.inArray(h,f)>=0,id:h,pid:r,name:t.pvtGridObj._getLocalizedLabels("Trend"),spriteCssClass:"kpiTrend e-icon",tag:h};t.pvtGridObj.schemaTreeView.push(treeNodeElement);treeNodeElement={hasChildren:!0,isSelected:n.inArray(c,f)>=0,id:c,pid:r,name:t.pvtGridObj._getLocalizedLabels("Value"),spriteCssClass:"kpiValue e-icon",tag:c};t.pvtGridObj.schemaTreeView.push(treeNodeElement)}t.pvtGridObj._schemaData._createTreeView(this,t.pvtGridObj.schemaTreeView);delete t.pvtGridObj.reportItemNames;delete t.pvtGridObj.schemaTreeView},_getTreeData:function(n,i,r){var u=t.olap.base._getConnectionInfo(n.url),f='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+n.request+"<\/RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+n.catalog+"<\/CATALOG_NAME><CUBE_NAME>"+n.cube+"<\/CUBE_NAME><\/RestrictionList><\/Restrictions><Properties><PropertyList><Catalog>"+n.catalog+"<\/Catalog><LocaleIdentifier>"+u.LCID+"<\/LocaleIdentifier> <\/PropertyList><\/Properties><\/Discover><\/Body><\/Envelope>";this.doAjaxPost("POST",u.url,{XMLA:f},i,null,r)},_addHyperlink:function(i){if(n(".hyperlinkValueCell")[0]&&n(n(".hyperlinkValueCell")[0]).removeClass("hyperlinkValueCell"),n(".hyperlinkHeaderCell")[0]&&n(n(".hyperlinkHeaderCell")[0]).removeClass("hyperlinkHeaderCell"),n(i.target).text()==""||n(i.target).text()==null)return!1;var r;i.target.parentElement.className.replace(/^\s+/,"").split(" ")[0]=="value"&&(this.enableValueCellHyperlink()||(t.isNullOrUndefined(this._pivotClientObj)?this.model.enableDrillThrough:this._pivotClientObj.model.enableDrillThrough))?n(i.target).addClass("hyperlinkValueCell"):n(i.target.parentElement).hasClass("summary value")&&this.enableSummaryCellHyperlink()?n(i.target).addClass("hyperlinkValueCell"):i.target.parentElement.className.split(" ")[0]=="rowheader"||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&n(i.target.parentElement).attr("role")=="rowheader"?this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enableDeferUpdate||n(this.element).parents(".e-pivotclient").length!=0?this.enableRowHeaderHyperlink()&&n(i.target).addClass("hyperlinkHeaderCell"):n(i.target.parentElement).hasClass("rgtot")||(r=n(i.target.parentElement).attr("data-p").split(",")[0],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&!t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotRows[r])&&JSON.parse(this.getOlapReport()).PivotRows[r].EnableHyperlink?n(i.target).addClass("hyperlinkHeaderCell"):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.dataSource.rows.length>0&&!t.isNullOrUndefined(this.model.dataSource.rows[r].enableHyperlink)&&this.model.dataSource.rows[r].enableHyperlink?n(i.target).addClass("hyperlinkHeaderCell"):this.enableRowHeaderHyperlink()&&n(i.target).addClass("hyperlinkHeaderCell")):(i.target.parentElement.className.split(" ")[0]=="colheader"||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&n(i.target.parentElement).attr("role")=="columnheader")&&(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enableDeferUpdate||n(this.element).parents(".e-pivotclient").length!=0?this.enableColumnHeaderHyperlink()&&n(i.target).addClass("hyperlinkHeaderCell"):n(i.target.parentElement).hasClass("calc")||n(i.target.parentElement).hasClass("cgtot")||n(i.target.parentElement).hasClass("gtot")||(r=n(i.target.parentElement).attr("data-p").split(",")[1],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&!t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotColumns[r])&&JSON.parse(this.getOlapReport()).PivotColumns[r].EnableHyperlink?n(i.target).addClass("hyperlinkHeaderCell"):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&!t.isNullOrUndefined(this.model.dataSource.columns[r].enableHyperlink)&&this.model.dataSource.columns[r].enableHyperlink?n(i.target).addClass("hyperlinkHeaderCell"):this.enableColumnHeaderHyperlink()&&n(i.target).addClass("hyperlinkHeaderCell")))},_removeHyperlink:function(t){n(t.target).removeClass("hyperlinkValueCell").removeClass("hyperlinkHeaderCell")},_cellContext:function(i){var r=n(i.target).parents(".e-pivotgrid").data("ejPivotGrid"),u=(n(i.target).hasClass("cellValue")?n(i.target).parent()[0]:i.target)||(n(i.srcElement).hasClass("cellValue")?n(i.srcElement).parent()[0]:i.srcElement),f;if(!t.isNullOrUndefined(r)&&r.enableCellContext()==!0&&n(u).parents("#"+r._id)[0]&&(f=n(u).attr("data-p"),f)){var f=r._excelLikeJSONRecords!=null&&r.model.layout.toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?n(u).attr("data-i"):n(u).attr("data-p"),o=r._excelLikeJSONRecords!=null&&r.model.layout.toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?r._excelLikeJSONRecords[parseInt(parseInt(f.split(",")[0])*r._excelRowCount+parseInt(f.split(",")[1]))].Info:r.getJSONRecords()[parseInt(parseInt(f.split(",")[0])*r._rowCount+parseInt(f.split(",")[1]))].Info,e={cellValue:u.innerHTML,cellPosition:f,cellType:u.className.split(" ")[0]!=""?u.className.split(" ")[0]:u.className.split(" ")[1],role:n(u).attr("role"),uniqueName:o.split("::")[0],args:i,rawdata:o};e.cellType!=""&&(t.isNullOrUndefined(r._pivotClientObj)?r._trigger("cellContext",{args:e}):r._pivotClientObj._trigger("cellContext",{args:e}));i.target?i.preventDefault():window.event.returnValue=!1}},_initCellSelection:function(i){var r,u;n("#"+this._id+" td,th").removeClass("e-highlighted");this._on(this.element,"mouseup touchend",".value",this._completeCellSelection);this._oriX=i.pageX;this._oriY=i.pageY;r=i.target||window.event.srcElement;n(r).hasClass("cellValue")&&(r=r.parentElement);n(".value").addClass("selection");n("#"+this._id).append(t.buildTag("div.e-cellSelection#"+this._id+"_cellSelection","",{}));this._startCellPosition=n(r)[0].attributes.getNamedItem("data-p").value;this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(u=this._excelLikeJSONRecords[0*this._rowCount+parseInt(n(r)[0].attributes.getNamedItem("data-i").value.split(",")[1])].Index,this._startCellPosition=this.getJSONRecords()[parseInt(n(r)[0].attributes.getNamedItem("data-p").value.split(",")[0])*this._rowCount+parseInt(u.split(",")[1])].Index);this._on(this.element,"mousemove touchmove",".value, .e-cellSelection",this._cellSelection)},_headerClickCellSelection:function(i){var r=n(i.target).attr("class").indexOf("colheader")&&n(i.target).attr("class").indexOf("rowheader")==-1?n(i.target).attr("class").indexOf("cellValue")!=-1?n(i.target).parent():null:n(i.target),s,o,h;if(r!=null){n("#"+this._id+" td,th").removeClass("e-highlighted");var f,e,u;for(f=r.attr("role"),u=f=="columnheader"?r.attr("data-p").split(",")[0]:r.attr("data-p").split(",")[1],e=f=="columnheader"?r.attr("colspan"):r.attr("rowspan"),this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(s=parseInt(r.attr("data-p").split(",")[0])*this._rowCount+parseInt(r.attr("data-p").split(",")[1]),e=f=="columnheader"?this._excelLikeJSONRecords[parseInt(r.attr("data-i").split(",")[0])*this._rowCount+parseInt(r.attr("data-i").split(",")[1])].ColSpan:this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.getJSONRecords()[s+this._rowCount]!=null&&this.getJSONRecords()[s+this._rowCount].CSS.indexOf("value")==-1?this.getJSONRecords()[s].RowSpan+1:this.getJSONRecords()[s].RowSpan),o=0;o<e;o++)f=="columnheader"?(n("#"+this._id+" [data-p^='"+(parseInt(o)+parseInt(u))+",']").addClass("e-highlighted"),n("#"+this._id+" [data-p^='"+(parseInt(o)+parseInt(u))+",'][role='columnheader']").each(function(t,i){(parseInt(i.attributes["data-p"].value.split(",")[1])<=parseInt(r.attr("data-p").split(",")[1])||parseInt(i.attributes.colspan.value)>parseInt(r.attr("colspan")))&&n(i).removeClass("e-highlighted")})):(n("#"+this._id+" [data-p$=',"+(parseInt(o)+parseInt(u))+"']").addClass("e-highlighted"),n("#"+this._id+" [data-p$=',"+(parseInt(o)+parseInt(u))+"'][role='rowheader']").each(function(t,i){(parseInt(i.attributes["data-p"].value.split(",")[0])<=parseInt(r.attr("data-p").split(",")[0])||parseInt(i.attributes.rowspan.value)>parseInt(r.attr("rowspan")))&&n(i).removeClass("e-highlighted")}));this._startCellPosition=f=="columnheader"?n("#"+this._id+" [data-p^='"+(0+parseInt(u))+",'].value").eq(0).attr("data-p"):n("#"+this._id+" [data-p$=',"+(0+parseInt(u))+"'].value").eq(0).attr("data-p");this._excelLikeJSONRecords==null||this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout||this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||(this._startCellPosition=f=="columnheader"?n("#"+this._id+" [data-p^='"+(0+parseInt(u))+",'].value:not(.summary)").eq(0).attr("data-p"):n("#"+this._id+" [data-p$=',"+(0+parseInt(u))+"'].value:not(.summary)").eq(0).attr("data-p"));h=f=="columnheader"?n("#"+this._id+" [data-p^='"+(parseInt(e)-1+parseInt(u))+",']").eq(n("#"+this._id+" [data-p^='"+(parseInt(e)-1+parseInt(u))+",']").length-1):n("#"+this._id+" [data-p$=',"+(parseInt(e)-1+parseInt(u))+"']").eq(n("#"+this._id+" [data-p$=',"+(parseInt(e)-1+parseInt(u))+"']").length-1);this._completeCellSelection(h)}},_cellSelection:function(i){n("#"+this._id+"_gridTooltip").hide();var r=n(i.target).parents(".e-pivotclient").length>0,u=i.pageX-this.element.offset().left-(this._oriX-this.element.offset().left),f=i.pageY-this.element.offset().top-(this._oriY-this.element.offset().top),e=this._oriX-this.element.offset().left,o=this._oriY-this.element.offset().top+3;u<0&&(u=Math.abs(u),e-=u-5);f<0&&(f=Math.abs(f),o-=f-12);i.pageX<this._oriX?n("#"+this._id+"_cellSelection").css({left:r?e:i.pageX+2,width:r?u:this._oriX-i.pageX}):n("#"+this._id+"_cellSelection").css({left:r?e:this._oriX-6,width:r?u:i.pageX-this._oriX});i.pageY<this._oriY?n("#"+this._id+"_cellSelection").css({top:r?o:i.pageY,height:r?f:this._oriY-i.pageY-7}):n("#"+this._id+"_cellSelection").css({top:r?o:this._oriY+7,height:r?f:i.pageY-this._oriY-11});n(".e-pivotGridTable").mouseleave(function(i){var r=n(i.target).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(i.toElement)||t.isNullOrUndefined(i.toElement.classList)||i.toElement.classList[0]!="e-pivotgrid"||(n("#"+r._id+"_cellSelection").remove(),n(".value").removeClass("selection"),r._off(r.element,"mouseup mouseend",".value"))})},_completeCellSelection:function(i){var s,e,k=[],tt=[],u,it=[],c,st,v,o,l,y,a,ut,p,h,b,g,ft,nt,et,lt,ot;if(this._off(this.element,"mousemove touchmove",".value"),n(".value").removeClass("selection"),s=n(i).hasClass("value")?i:i.target||window.event.srcElement,n(s).hasClass("cellValue")&&(s=s.parentElement),n(s)[0].attributes.getNamedItem("data-p")==null)return!1;for(e=n(s)[0].attributes.getNamedItem("data-p").value,this._excelLikeJSONRecords==null||this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout||n(i).hasClass("value")||(st=this._excelLikeJSONRecords[0*this._rowCount+parseInt(n(s)[0].attributes.getNamedItem("i").value.split(",")[1])].Index,e=this.getJSONRecords()[parseInt(n(s)[0].attributes.getNamedItem("data-p").value.split(",")[0])*this._rowCount+parseInt(st.split(",")[1])].Index),v=0,o=parseInt(this._startCellPosition.split(",")[1])<parseInt(e.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(e.split(",")[1]);o<=(parseInt(this._startCellPosition.split(",")[1])>parseInt(e.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(e.split(",")[1]));o++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||n("#"+this._id).find("td[data-p*=',"+o+"']").parent().is(":visible"))for(l=parseInt(this._startCellPosition.split(",")[0])<parseInt(e.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(e.split(",")[0]);l<=(parseInt(this._startCellPosition.split(",")[0])>parseInt(e.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(e.split(",")[0]));l++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||n("#"+this._id).find("[data-p*='"+l+",']").last("th").is(":Visible")){k[v]=this.getJSONRecords()[l*this._rowCount+o];var f,w="",rt,ht,d=0,ct=0;if(u=this.element.find(".summary[role!='gridcell'][data-p$=',"+o+"'] , .rowheader[role!='gridcell'][data-p$=',"+o+"']").last().attr("data-p"),u==r&&(u=n("#"+this._id).find("tbody").find('[data-p="'+l+","+o+'"]').parent("tr").find(".summary").first().attr("data-p")),rt=u,u!=null){while(u[0]>=0)u==this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Index&&(f=this.getJSONRecords()[parseInt(parseInt(u.split(",")[0])*this._rowCount+parseInt(u.split(",")[1]))].Value,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(f=n("#"+this._id).find("td[data-p*='"+l+","+o+"']").prevAll("th").children(".e-expand").length>0?f.replace(this._getLocalizedLabels("Total"),""):f),u=parseInt(u.split(",")[0])-1+","+parseInt(u.split(",")[1])),w&&f!=""?w=f+"##"+w:f!=""&&(w=f);tt[v]=w}for(y="",ut=this.element.find('tr:has(".colheader")').length-1,ht=ut,c=k[v].Index,c!=r&&c==this.getJSONRecords()[parseInt(parseInt(c.split(",")[0])*this._rowCount+parseInt(c.split(",")[1]))].Index&&(p=parseInt(c.split(",")[0])),h=0;h<=ut;h++){if(p!=null&&p+","+h==this.getJSONRecords()[parseInt(parseInt(p)*this._rowCount+h)].Index){if(a=this.getJSONRecords()[parseInt(parseInt(p)*this._rowCount+h)].Value,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(b=p;b>=0;b--)if(n("#"+this._id).find("th[data-p*='"+b+","+h+"']").length>0){a=n("#"+this._id).find("th[data-p*='"+b+","+h+"']").find(".e-expand").length>0?a.replace(this._getLocalizedLabels("Total"),""):a;break}y==""?y=a:a!=""&&(y=y+"##"+a)}it[v]=y}v++}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap){for(g=this.getJSONRecords()[parseInt(parseInt(rt.split(",")[0])*this._rowCount+parseInt(rt.split(",")[1]))].Info;g[0]>=0;)f=this.getJSONRecords()[parseInt(parseInt(g.split(",")[0])*this._rowCount+parseInt(g.split(",")[1]))].Info,(f.split("::")[0].indexOf("Measures")>0||f.split("::")[0].indexOf("MEASURES")>0)&&d++,u=parseInt(u.split(",")[0])-1+","+parseInt(u.split(",")[1]);if(ft=parseInt(c.split(",")[0]),d==0)for(nt=0;nt<=ht;nt++)ft!=null&&(et=this.getJSONRecords()[parseInt(parseInt(ft)*this._rowCount+nt)].Info),(et.split("::")[0].indexOf("Measures")>0||et.split("::")[0].indexOf("MEASURES")>0)&&ct++}else lt=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotCalculations.length:this.model.dataSource.values.length;ot={JSONRecords:k,rowHeader:tt,columnHeader:it,measureCount:d>0?"Row:"+d:"Column:"+ct};t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",ot):this._pivotClientObj._trigger("cellSelection",ot);k=tt=it=[];n("#"+this._id+"_cellSelection").remove();this._on(this.element,"mousemove touchmove",".value",this._applyToolTip);this._off(this.element,"mouseup touchend",".value")},exportPivotGrid:function(i,u){var o,a,nt,d,ht,b,g,ct,e,h,s,k,pt,wt,y,v;if(this._rowCount=t.isNullOrUndefined(this._rowLength)?this._rowCount:this._rowLength,this._isExporting=!0,o={},o=i.toLowerCase()=="excel"||i.toLowerCase()=="excelexport"?{url:"",fileName:"PivotGrid",exportMode:t.PivotGrid.ExportMode.JSON,fileFormat:this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?".xls":".xlsx",title:"",description:"",exportType:i,controlName:this,exportWithStyle:!0,exportValueAsNumber:!1}:{url:"",fileName:"PivotGrid",exportMode:t.PivotGrid.ExportMode.JSON,fileFormat:i.toLowerCase()=="word"?".docx":".pdf",title:"",description:"",exportType:i,controlName:this,exportWithStyle:!0},this._trigger("beforeExport",o),a={rowCellColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".rowheader").css("color"),rowCellBGColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".rowheader").css("background-color"),columnCellColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".colheader").css("color"),columnCellBGColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".colheader").css("background-color"),valueCellColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("color"))?"rgb(51, 51, 51)":this._cFormat.length<=0?this.element.find(".value").css("color"):"rgb(51, 51, 51)",valueCellBGColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("background-color"))?"rgb(255, 255, 255)":this._cFormat.length<=0?this.element.find(".value").css("background-color"):"rgb(255, 255, 255)",summaryCellColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("color"))?"rgb(51, 51, 51)":this.element.find(".summary").css("color"),summaryCellBGColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".summary").css("background-color")=="rgba(0, 0, 0, 0)"?"rgb(255, 255, 255)":this.element.find(".summary").css("background-color")},this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode||o.exportMode==t.PivotGrid.ExportMode.JSON){if(v={},this.model.enableCompleteDataExport&&(this.model.enablePaging||this.model.enableVirtualScrolling)){if(nt={paging:this.model.enablePaging,vScrolling:this.model.enableVirtualScrolling},d=0,this.model.enablePaging=this.model.enableVirtualScrolling=!1,this._isExporting=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(this._fullExportedData.jsonObj=t.PivotAnalysis.pivotEnginePopulate(this.model).json,this._fullExportedData.rowCount=0,e=0;e<this._fullExportedData.jsonObj.length;e++)if(parseInt(this._fullExportedData.jsonObj[e].Index.split(",")[0])==0)this._fullExportedData.rowCount++;else break;else t.olap.base.getJSONData({action:"loadFieldElements"},this.model.dataSource,this);else{try{y=JSON.parse(this.getOlapReport()).Report}catch(bt){y=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"export",currentReport:y,gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),function(n){if(this._fullExportedData.jsonObj=t.isNullOrUndefined(n[0])?t.isNullOrUndefined(n.d)?JSON.parse(n.JsonRecords):JSON.parse(n.d[0]):JSON.parse(n[0]),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){this._fullExportedData.rowCount=0;for(var i=0;i<this._fullExportedData.jsonObj.length;i++)if(parseInt(this._fullExportedData.jsonObj[i].Index.split(",")[0])==0)this._fullExportedData.rowCount++;else break}else this._fullExportedData.rowCount=t.isNullOrUndefined(n[1])?t.isNullOrUndefined(n.d)?JSON.parse(n.RowCount):JSON.parse(n.d[1]):JSON.parse(n[1])})}this.exportRecords=this._fullExportedData.jsonObj;d=this._fullExportedData.rowCount;v={args:JSON.stringify({pGridData:this.exportRecords!=null&&this.exportRecords!=""?this.exportRecords:null,rowCount:d,columnCount:this.exportRecords!=null?Math.floor(this.exportRecords.length/d):0,fileFormat:o.fileFormat+(o.fileFormat==".xls"||o.fileFormat==".xlsx"?"~"+o.exportValueAsNumber:""),fileName:t.isNullOrUndefined(u)?t.isNullOrUndefined(o.fileName)?"PivotGrid":o.fileName:u,colorSettings:a,Formatting:this._cFormat,title:o.title,description:o.description,language:this.model.locale,exportWithStyle:o.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})};this.model.enablePaging=nt.paging;this.model.enableVirtualScrolling=nt.vScrolling;this._isExporting=!1}else{var l,p,w,it=0,rt=!1,ut=!1,tt=0,c=0,ft=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap,et=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode!=t.Pivot.AnalysisMode.Olap,ot=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode,f=n.extend(!0,[],this.exportRecords),st=this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&JSON.parse(this.getOlapReport()).PivotRows.length>1;if((!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal||!this.model.enableRowGrandTotal)&&(!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)){if(!ft||ot)for(e=0;e<f.length;e++)(f[e].CSS=="summary cgtot"||f[e].CSS=="summary gtot"&&f[e].Index.split(",")[1]==0)&&f.splice(e);if(ft)for(e=0;e<f.length;e++)f[e].Index.split(",")[1]==0&&f[e].CSS=="summary col"&&f.splice(e);c=this._rowCount}if((this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)&&(!this.model.enableRowGrandTotal||!this.model.enableGrandTotal)&&!st){for(ht=this._rowCount-1,e=0;e<f.length;e++)f[e].Index.split(",")[1]==ht&&(f=f.slice(0,e).concat(f.slice(e+1,f.length)));c=this._rowCount-1}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(JSON.parse(this.getOlapReport()).PivotRows.length>1||JSON.parse(this.getOlapReport()).PivotColumns.length>1)){if(!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)for(e=0;e<f.length;e++)f[e].Index.split(",")[1]==0&&f[e].CSS=="summary"&&f.splice(e);if(!this.model.enableRowGrandTotal||!this.model.enableGrandTotal)for(l=this.exportRecords.length/this._rowCount,e=0;e<f.length;e++)if(f[e].Index.split(",")[0]==0&&f[e].CSS=="summary"){for(b=e,g=this._rowCount-b,s=0;s<f.length;s++)f=f.slice(0,b).slice(0,this._rowCount+tt).concat(f.slice(this._rowCount+it,f.length)),tt=b-1,b=b+this.element.find("tr").length-g,it=tt+1;break}c=g!=r?this.element.find("tr").length-g:this.element.find("tr").length}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(et?(p=this.model.dataSource.rows,w=this.model.dataSource.columns):this.getOlapReport()!=null&&(p=JSON.parse(this.getOlapReport()).PivotRows,w=JSON.parse(this.getOlapReport()).PivotColumns),c==0&&(c=this._rowCount),l=f.length/c,p.length>1&&this.layout()!="excellikelayout")for(h=0;h<p.length;h++)if(p[h].showSubTotal==!1)for(rt=!0,e=0;e<f.length;e++)if(f[e].Index.split(",")[0]==h&&f[e].CSS=="summary rstot"||f[e].CSS=="summary stot")for(ct=f[e].Index.split(",")[1],s=0;s<f.length;s++)f[s].Index.split(",")[1]==ct&&(f=f.slice(0,s).concat(f.slice(s+1,f.length)),e=0);if(p.length>1&&rt==!0)for(c=f.length/l,l=f.length/c,h=0;h<l-1;h++)for(s=f[0].RowSpan;s<f.length;s++)if(f[s].Index.split(",")[0]==h&&(f[s].CSS=="rowheader"||f[s].CSS=="summary rstot"||f[s].CSS=="summary stot"||f[s].CSS=="none")&&f[s].Expander==1){var lt=f[s].Index.split(",")[1],at=f[s].Index.split(",")[0],vt=0;for(j=0;j<f[s].RowSpan;j++)parseInt(lt)+f[s].RowSpan>f[s+j].Index.split(",")[1]&&at==f[s+j].Index.split(",")[0]&&vt++;f[s].RowSpan=vt}if(w.length>1&&this.layout()!="excellikelayout")for(et&&(valuedata=this.model.dataSource.values),ot&&(valuedata=JSON.parse(this.getOlapReport()).PivotCalculations),h=0;h<w.length;h++)if(w[h].showSubTotal==!1)for(ut=!0,e=0;e<f.length;e++)(f[e].Index.split(",")[1]==h&&f[e].CSS=="summary cstot"||f[e].CSS=="summary stot")&&(f=f.slice(0,e-h).slice(0,e+c*valuedata.length-h).concat(f.slice(e+c*valuedata.length-h,f.length)));if(w.length>1&&ut==!0)for(l=f.length/c,h=0;h<f.length;h++)for(s=f[0].ColSpan;s<f.length;s++)if(f[s].Index.split(",")[0]==h&&(f[s].CSS=="colheader"||f[s].CSS=="summary cstot"||f[s].CSS=="summary stot"||f[s].CSS=="none")&&f[s].Expander==1){var lt=f[s].Index.split(",")[1],at=f[s].Index.split(",")[0],yt=0;for(j=0;j<f.length;j++)s+j<f.length&&parseInt(at)+f[s].ColSpan>f[s+j].Index.split(",")[0]&&lt==f[s+j].Index.split(",")[1]&&(yt++,j+=c-1);f[s].ColSpan=yt}}k=f.length;v=c!=0?st?{args:JSON.stringify({pGridData:f!=null&&f!=""?f:null,rowCount:c,columnCount:JSON.parse(this.getOlapReport()).PivotRows.length>1&&!this.model.enableGrandTotal?k/c:this.model.enableColumnGrandTotal?t.isNullOrUndefined(l)?k/c:l:k/c,fileFormat:o.fileFormat+(o.fileFormat==".xls"||o.fileFormat==".xlsx"?"~"+o.exportValueAsNumber:""),fileName:t.isNullOrUndefined(u)?t.isNullOrUndefined(o.fileName)?"PivotGrid":o.fileName:u,colorSettings:a,Formatting:this._cFormat,title:o.title,description:o.description,language:this.model.locale,exportWithStyle:o.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})}:{args:JSON.stringify({pGridData:f!=null&&f!=""?f:null,rowCount:c,columnCount:k/c,fileFormat:o.fileFormat+(o.fileFormat==".xls"||o.fileFormat==".xlsx"?"~"+o.exportValueAsNumber:""),fileName:t.isNullOrUndefined(u)?t.isNullOrUndefined(o.fileName)?"PivotGrid":o.fileName:u,colorSettings:a,Formatting:this._cFormat,title:o.title,description:o.description,language:this.model.locale,exportWithStyle:o.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})}:{args:JSON.stringify({pGridData:this.exportRecords!=null&&this.exportRecords!=""?this.exportRecords:null,rowCount:this._excelLikeJSONRecords!=null?this._excelRowCount:this._rowCount,columnCount:this._excelLikeJSONRecords!=null?Math.floor(this._excelLikeJSONRecords.length/this._excelRowCount):this.getJSONRecords()!=null&&!t.isNullOrUndefined(this._rowLength)?k/this._rowLength:Math.floor(this.getJSONRecords().length/this._rowCount),fileFormat:o.fileFormat+(o.fileFormat==".xls"||o.fileFormat==".xlsx"?"~"+o.exportValueAsNumber:""),fileName:t.isNullOrUndefined(u)?t.isNullOrUndefined(o.fileName)?"PivotGrid":o.fileName:u,colorSettings:a,Formatting:this._cFormat,title:o.title,description:o.description,language:this.model.locale,exportWithStyle:o.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})}}t.raiseWebFormsServerEvents&&(i=="excelExport"||i=="wordExport"||i=="pdfExport"||i=="csvExport")&&o.exportMode==t.PivotGrid.ExportMode.JSON&&n.trim(o.url)==""?(pt={model:this.model,originalEventType:i},wt=v,t.raiseWebFormsServerEvents(i,pt,wt),setTimeout(function(){t.isOnWebForms=!0},1e3)):this.doPostBack(n.trim(o.url)!=""?o.url:i,v)}else{try{y=JSON.parse(this.getOlapReport()).Report}catch(bt){y=this.getOlapReport()}v={args:JSON.stringify({exportOption:i,fileFormat:o.fileFormat,currentReport:y,layout:this.layout(),colorSettings:a!=r?JSON.stringify(a):"",customObject:JSON.stringify(this.model.customObject),title:o.title,description:o.description,completeDataExport:this.model.enableCompleteDataExport,exportWithStyle:o.exportWithStyle})};this.doPostBack(n.trim(o.url)!=""?o.url:this.model.url+"/"+this.model.serviceMethodSettings.exportPivotGrid,v)}this._isExporting=!1},_createCalculatedField:function(){var i,r;t.Pivot.openPreventPanel(this);this.element.find(".calculatedFieldPopup",".e-clientDialog",".e-dialog").remove();var u=this._getLocalizedLabels("CalculatedField"),f=t.buildTag("label#"+this._id+"_lblCalFieldName",this._getLocalizedLabels("Name"))[0].outerHTML,e=t.buildTag("span.fieldDropDown",t.buildTag("input#"+this._id+"_calculateFieldList","",{},{type:"text"})[0].outerHTML+t.buildTag("input#"+this._id+"_calculateFieldName.calculateFieldName","",{"margin-left":this.model.enableRTL?"86px":"2px",outline:"none"},{type:"text"})[0].outerHTML,{})[0].outerHTML,o=t.buildTag("button#"+this._id+"_btnAdd",this._getLocalizedLabels("Add"),{},{name:this._getLocalizedLabels("Add")})[0].outerHTML,s=t.buildTag("label#"+this._id+"_lblCalFieldFormula",this._getLocalizedLabels("Formula"))[0].outerHTML,h=t.buildTag("input.calculatedFieldFormula#"+this._id+"_calculatedFieldFormula","",{width:"192px",height:"27px"},{type:"text",disabled:"disabled"})[0].outerHTML,c=t.buildTag("button#"+this._id+"_btnDelete",this._getLocalizedLabels("Delete"),{"margin-top":"-2px"},{name:this._getLocalizedLabels("Delete")})[0].outerHTML,l=t.buildTag("label#"+this._id+"_pivotGridValueFields",this._getLocalizedLabels("Fields"))[0].outerHTML,a=t.buildTag("ul#"+this._id+"_fieldCollection","")[0].outerHTML,v=t.buildTag("button.calculatorFields","",{"margin-left":this.model.enableRTL?"0px":"10px","margin-right":this.model.enableRTL?"10px":"0px"})[0].outerHTML,y=t.buildTag("span.editFormula e-icon e-cancel","",{padding:"3px","margin-left":"-54px","margin-right":this.model.enableRTL?"-54px":"0px",position:"relative"}).attr("aria-label","cancel")[0].outerHTML,p=t.buildTag("span",t.buildTag("button#"+this._id+"_btnInsert",this._getLocalizedLabels("InsertField"),{},{name:this._getLocalizedLabels("InsertField")})[0].outerHTML,{"margin-right":"150px","margin-left":"150px"})[0].outerHTML,w=t.buildTag("button#"+this._id+"_btnOk",this._getLocalizedLabels("OK"),{"margin-left":"10px"},{name:this._getLocalizedLabels("OK")})[0].outerHTML,b=t.buildTag("button#"+this._id+"_btnCancel",this._getLocalizedLabels("Cancel"),{"margin-left":this.model.enableRTL?"0px":"10px"},{name:this._getLocalizedLabels("Cancel")})[0].outerHTML,k=t.buildTag("div",w+b,{float:this.model.enableRTL?"left":"right","margin-bottom":"15px","margin-top":"4px"})[0].outerHTML,d=t.buildTag("div.e-calcFormulaDiv",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td","+")[0].outerHTML+t.buildTag("td","-")[0].outerHTML+t.buildTag("td","*")[0].outerHTML+t.buildTag("td","/")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","7")[0].outerHTML+t.buildTag("td","8")[0].outerHTML+t.buildTag("td","9")[0].outerHTML+t.buildTag("td","%")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","4")[0].outerHTML+t.buildTag("td","5")[0].outerHTML+t.buildTag("td","6")[0].outerHTML+t.buildTag("td","^")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","1")[0].outerHTML+t.buildTag("td","2")[0].outerHTML+t.buildTag("td","3")[0].outerHTML+t.buildTag("td","(")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",".")[0].outerHTML+t.buildTag("td","0")[0].outerHTML+t.buildTag("td","C")[0].outerHTML+t.buildTag("td",")")[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,{display:"none"})[0].outerHTML,g=t.buildTag("div#calculatedField.e-dlgCalculatedField",'<table class="outerTable"><tr><td>'+f+"<\/td><td>"+e+"<\/td><td>"+o+"<\/td><\/tr><tr><td>"+s+"<\/td><td>"+h+v+y+"<\/td><td>"+c+'<\/td><\/tr><\/table><p class="borderLine"><\/p><table class="e-fieldTable"><tr><td>'+l+"<\/td><\/tr><tr><td>"+a+"<\/td><\/tr><tr><td>"+p+"<\/td><\/tr><\/table>")[0].outerHTML,nt=t.buildTag("div#clientDialog.e-clientDialog",g+k+d,{opacity:"1"}).attr("title",u)[0].outerHTML;n(nt).appendTo("#"+this._id);this.element.find(".e-clientDialog").ejDialog({width:"auto",target:"#"+this._id,enableRTL:this.model.enableRTL,enableResize:!1,close:t.proxy(t.Pivot.closePreventPanel,this)});n("#"+this._id+"_btnAdd,#"+this._id+"_btnDelete,#"+this._id+"_btnOk,#"+this._id+"_btnCancel").ejButton({type:t.ButtonType.Button,width:"80",enableRTL:this.model.enableRTL});n("#"+this._id+"_btnInsert").ejButton({type:t.ButtonType.Button,enabled:!1,width:"100",enableRTL:this.model.enableRTL});n(".calculatorFields").ejButton({type:t.ButtonType.Button,contentType:"imageonly",prefixIcon:"e-icon e-sigma",htmlAttributes:{title:"Click Me"},enableRTL:this.model.enableRTL});n("#"+this._id+"_calculateFieldList").ejDropDownList({width:"230px",enableRTL:this.model.enableRTL,dataSource:this._calculatedField,fields:{text:"name",value:"name"},select:t.proxy(this._calculatedFieldListChange,this),create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}});i=[];this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n(JSON.parse(this.getOlapReport()).PivotCalculations).each(function(){this.CalculationType!=8&&this.CalculationType!="Formula"&&i.push({fields:this.FieldName})}):n(n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1})).each(function(){i.push({fields:this.fieldName})});r=n("#"+this._id+"_btnInsert").data("ejButton");this._calculatedField.length==0&&(n("#"+this._id+"_btnOk").ejButton("disable"),n("#"+this._id+"_btnOk").attr("disabled","disabled"));n("#"+this._id+"_fieldCollection").ejListBox({dataSource:i,enableRTL:this.model.enableRTL,select:function(){r.enable()},height:"130",width:"400"});r.disable();this.element.find(".e-dialog .e-close").attr("title",this._getLocalizedLabels("Close"));n(".calculatorFields").click(function(){n("div.e-calcFormulaDiv").removeAttr("style")});n(".editFormula").click(function(){var t=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),i=n("#"+t._id+"_calculatedFieldFormula").val().lastIndexOf(" ");n("#"+t._id+"_calculatedFieldFormula").val()!==""&&i>0?i+1==n("#"+t._id+"_calculatedFieldFormula").val().length?n("#"+t._id+"_calculatedFieldFormula").val(n("#"+t._id+"_calculatedFieldFormula").val().substring(0,i-2)):n("#"+t._id+"_calculatedFieldFormula").val(n("#"+t._id+"_calculatedFieldFormula").val().substring(0,i)+" "):n("#"+t._id+"_calculatedFieldFormula").val("")});this.model.pivotEnginePopulated!=null&&this._trigger("pivotEnginePopulated",{JSONRecords:jsonObj});n(document).click(function(t){n(t.target).hasClass("calculatorFields")||n(t.target).hasClass("e-sigma")||n(t.target).parents(".e-calcFormulaDiv").length>0||n("div.e-calcFormulaDiv").css("display","none")});n("div.e-calcFormulaDiv").on("click","td",function(){var t=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),i=this.textContent=="C"?n("#"+t._id+"_calculatedFieldFormula").val(""):n("#"+t._id+"_calculatedFieldFormula").val(n("#"+t._id+"_calculatedFieldFormula").val()+("+-/%^*".indexOf(this.textContent)>-1?" "+this.textContent+" ":this.textContent))});n("#"+this._id+"_btnInsert").click(function(){var t=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),i=n("#"+t._id+"_fieldCollection").data("ejListBox");n("#"+t._id+"_calculatedFieldFormula").val(n("#"+t._id+"_calculatedFieldFormula").val()+i.value())});n("#"+this._id+"_btnAdd").click(function(){var i=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),r=n("#"+i._id+"_calculatedFieldFormula").val().split(" "),o=-1,f,s,e,u;if(n("#"+i._id+"_calculateFieldName").val()==""||n("#"+i._id+"_calculatedFieldFormula").val()==""){t.Pivot._createErrorDialog(i._getLocalizedLabels("EmptyField"),i._getLocalizedLabels("Warning"),i);return}for(u=0;u<r.length;u++){if(o="+-/%^*".indexOf(r[u])>-1?u:-1,o>-1&&r.length>0&&(r[0]==""||r[0]=="."||r[r.length-1]==""||r[r.length-1]=="."||r[o+1]==""||r[o+1]==".")){t.Pivot._createErrorDialog(i._getLocalizedLabels("NotValid"),i._getLocalizedLabels("Warning"),i);return}if(r[u].indexOf("(")==r[u].length-1||r[u].indexOf(")")==0||n("#"+i._id+"_calculatedFieldFormula").val().replace(/[^\(_]/g,"").length!=n("#"+i._id+"_calculatedFieldFormula").val().replace(/[^\)_]/g,"").length){t.Pivot._createErrorDialog(i._getLocalizedLabels("NotValid"),i._getLocalizedLabels("Warning"),i);return}}for(f=[],i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n(JSON.parse(i.getOlapReport()).PivotCalculations).each(function(){this.CalculationType!=8&&this.CalculationType!="Formula"&&f.push({fields:this.FieldName})}):n(i.model.dataSource.values).each(function(){f.push({fields:this.fieldName})}),r=n("#"+i._id+"_calculatedFieldFormula").val().replace(/\(|\)/g," ").split(" "),u=0;u<r.length;u++){for(s=!1,e=0;e<f.length;e++)if(r[u].indexOf(f[e].fields)>-1&&r[u]!=f[e].fields)s=!0;else if(r[u]==f[e].fields){s=!1;break}if(s){t.Pivot._createErrorDialog(i._getLocalizedLabels("NotPresent"),i._getLocalizedLabels("Warning"),i);return}}for(u=0;u<i._calculatedField.length;u++)if(i._calculatedField[u].name==n("#"+i._id+"_calculateFieldName").val()){if(confirm(i._getLocalizedLabels("Confirm"))){i._calculatedField[u].formula=n("#"+i._id+"_calculatedFieldFormula").val();n("#"+i._id+"_calculatedFieldFormula").val("");n("#"+i._id+"_calculateFieldName").val("");n("#"+i._id+"_calculateFieldList").ejDropDownList({dataSource:i._calculatedField,fields:{text:"name",value:"name"},enableRTL:i.model.enableRTL,create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}});return}return}i._calculatedField.push({name:n("#"+i._id+"_calculateFieldName").val(),formula:n("#"+i._id+"_calculatedFieldFormula").val()});n("#"+i._id+"_calculatedFieldFormula").val("");n("#"+i._id+"_calculateFieldName").val("");n("#"+i._id+"_calculateFieldList").ejDropDownList({dataSource:i._calculatedField,fields:{text:"name",value:"name"},enableRTL:i.model.enableRTL,create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}});i._calculatedField.length>0&&(n("#"+i._id+"_btnOk").ejButton("enable"),n("#"+i._id+"_btnOk").removeAttr("disabled"))});n("#"+this._id+"_btnDelete").click(function(){var i=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),u,f,e,s,r,h,o;if(i._calculatedField.length==0){t.Pivot._createErrorDialog(i._getLocalizedLabels("CalculatedFieldNameNotFound"),i._getLocalizedLabels("Warning"),i);return}for(u=hederTag=n("#"+i._id+"_calculateFieldName").val(),r=0;r<i._calculatedField.length;r++)if(i._calculatedField[r].name==n("#"+i._id+"_calculateFieldName").val()){if(i.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)i.model.dataSource.values=n.grep(i.model.dataSource.values,function(n){return n.fieldCaption!=i._calculatedField[r].name}),i._calculatedField.splice(r,1),i._populatePivotGrid();else{for(i._calculatedField.splice(r,1),r=0;r<i._pivotTableFields.length;r++)i._pivotTableFields[r].name==u&&(i._pivotTableFields[r].isSelected=!1,headerTag=i._pivotTableFields[r],i._pivotTableFields.splice(r,1));try{f=JSON.parse(i.getOlapReport()).Report}catch(c){f=i.getOlapReport()}s="schemaRow::"+headerTag.id+"::FILTERED";i._schemaData==null&&(i.model.beforeServiceInvoke!=null&&i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&i._trigger("beforeServiceInvoke",{action:"nodeStateModified",element:i.element,customObject:i.model.customObject}),h=JSON.stringify(i.model.customObject),e=JSON.stringify({action:"nodeStateModified",headerTag:JSON.stringify(headerTag),dropAxis:"schemaValue::",sortedHeaders:i._ascdes,filterParams:s,currentReport:f,valueSorting:JSON.stringify(i.model.valueSortSettings),customObject:h}),i.model.enableDeferUpdate?i.doAjaxPost("POST",i.model.url+"/"+i.model.serviceMethodSettings.nodeStateModified,e.replace("nodeStateModified","nodeStateModifiedDeferUpdate"),i._nodeStateModifiedSuccess):i.doAjaxPost("POST",i.model.url+"/"+i.model.serviceMethodSettings.nodeStateModified,e,i._nodeStateModifiedSuccess))}i._schemaData!=null&&(o=i._schemaData._tableTreeObj.element.find("li[id='"+u+"']"),i._schemaData._tableTreeObj.uncheckNode(o),i._schemaData._tableTreeObj.model.beforeDelete=null,i._schemaData._tableTreeObj.removeNode(o),i._schemaData._tableTreeObj.model.beforeDelete=function(){return!1})}else if(r==i._calculatedField.length-1){t.Pivot._createErrorDialog(i._getLocalizedLabels("CalculatedFieldNameNotFound"),i._getLocalizedLabels("Warning"),i);return}});n("#"+this._id+"_btnOk").click(function(){var i=n(this).parents(".e-pivotgrid").data("ejPivotGrid"),r,f,u,h,e,o,c,s;for(i.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(i.model.dataSource.values=n.grep(i.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1})),r=0;r<i._calculatedField.length;r++){for(f=i._calculatedField[r].formula.replace(/\(|\)/g," ").replace(/[-+*/^%]/g," ").split(" "),u=0;u<f.length;u++)if(!n.isNumeric(f[u])&&f[u].replace(/\s+|\s+$/gm,"")!=""&&(h=i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.grep(JSON.parse(i.getOlapReport()).PivotCalculations,function(n){return n.FieldName==f[u]}).length:n.grep(i.model.dataSource.values,function(n){return n.fieldName==f[u]}).length,h==0)){t.Pivot._createErrorDialog(i._getLocalizedLabels("NotPresent"),i._getLocalizedLabels("Warning"),i);return}e=i._calculatedField[r].formula.replace(/\s+|\s+$/gm,"");e=i._parenthesisAsterisk(e);i.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&n.grep(i.model.dataSource.values,function(n){return n.fieldName==i._calculatedField[r].name&&(n.formula=i._calculatedField[r].formula),n.fieldName==i._calculatedField[r].name}).length==0&&(i.model.dataSource.values.push({fieldName:i._calculatedField[r].name,fieldCaption:i._calculatedField[r].name,isCalculatedField:!0,formula:e,format:i._calculatedField[r].format,formatString:i._calculatedField[r].formatString}),i._schemaData!=null&&i._schemaData._tableTreeObj.element.find("li[id='"+i._calculatedField[r].name+"']").find(".e-chk-inact").length>0&&i._schemaData._tableTreeObj.checkNode(i._calculatedField[r].name))}if(i.element.find(".e-dialog, .e-clientDialog").remove(),t.Pivot.closePreventPanel(i),i.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode)i._populatePivotGrid();else{t.isNullOrUndefined(i._waitingPopup)||i._waitingPopup.show();try{o=JSON.parse(i.getOlapReport()).Report}catch(l){o=i.getOlapReport()}i.model.beforeServiceInvoke!=null&&i._trigger("beforeServiceInvoke",{action:"calculatedField",element:i.element,customObject:i.model.customObject});c=JSON.stringify(i.model.customObject);s=JSON.stringify({action:"calculatedField",headerTag:JSON.stringify(i._calculatedField),currentReport:o,valueSorting:JSON.stringify(i.model.valueSortSettings),customObject:c});i.model.enableDeferUpdate?(t.isNullOrUndefined(i._waitingPopup)||i._waitingPopup.hide(),i.doAjaxPost("POST",i.model.url+"/"+i.model.serviceMethodSettings.calculatedField,s.replace("calculatedField","calculatedFieldDeferUpdate"),i._schemaData==null?i._renderControlSuccess:i._schemaCalculatedField)):i.doAjaxPost("POST",i.model.url+"/"+i.model.serviceMethodSettings.calculatedField,s,i._schemaData==null?i._renderControlSuccess:i._schemaCalculatedField)}});n("#"+this._id+"_btnCancel").click(function(){var i=n(this).parents(".e-pivotgrid").data("ejPivotGrid");i.element.find(".e-dialog, .e-clientDialog").remove();t.Pivot.closePreventPanel(i)});this._curFocus.field=this.element.find(".e-dialog .calculateFieldName").attr("tabindex","-1")},_schemaCalculatedField:function(i){var f,u,r;for(this._schemaData._tableTreeObj.model.nodeCheck=null,this._schemaData._tableTreeObj.model.nodeUncheck=null,r=0;r<this._calculatedField.length;r++)f=this._schemaData.element.find(".e-schemaFieldTree").data("ejTreeView"),this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").length==0?(u=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?{id:this._calculatedField[r].name,name:this._calculatedField[r].name,caption:this._calculatedField[r].name,isSelected:!0,spriteCssClass:""}:{id:this._calculatedField[r].name,name:this._calculatedField[r].name,isSelected:!0,calculationType:8,formula:this._calculatedField[r].formula,summaryType:6,format:null,allowRunTimeGroupByField:"false",pivotType:"PivotComputationInfo",spriteCssClass:""},this._pivotTableFields.push(u),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(this._pivotTableFields=t.PivotAnalysis.getTreeViewData(this.model.dataSource)),this._schemaData._setTableFields(this._pivotTableFields),f.addNode(u),this._schemaData._tableTreeObj.element.find(".e-item").css("padding","0px")):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._schemaData!=null&&this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").find(".e-chk-inact").length>0?this._schemaData._tableTreeObj.checkNode(this._calculatedField[r].name):this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").removeClass("filter").find(".treeDrop , .filter").remove();if(this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style"),this._schemaData._tableTreeObj.model.nodeCheck=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.proxy(this._schemaData._checkedStateModified,this._schemaData):t.proxy(this._schemaData._pivotCheckedStateModified,this._schemaData),this._schemaData._tableTreeObj.model.nodeUncheck=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.proxy(this._schemaData._checkedStateModified,this._schemaData):t.proxy(this._schemaData._pivotCheckedStateModified,this._schemaData),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(this.model.enableDeferUpdate?(this._isUpdateRequired=!0,this._deferUpdateSuccess(i)):this._renderControlSuccess(i)),n(this._schemaData.element.find(".e-schemaValue .e-pivotButton")).each(function(){n(this).remove()}),t.isNullOrUndefined(this._pivotClientObj)||typeof this._pivotClientObj._pivotSchemaDesigner=="undefined")if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(report=JSON.parse(this.getOlapReport()),r=0;r<report.PivotCalculations.length;r++)this._schemaData._createPivotButton({fieldName:report.PivotCalculations[r].FieldName,fieldCaption:report.PivotCalculations[r].FieldHeader},"value","","","");else for(r=0;r<this.model.dataSource.values.length;r++)this._schemaData._createPivotButton({fieldName:this.model.dataSource.values[r].fieldName,fieldCaption:this.model.dataSource.values[r].fieldCaption},"value","","","");else this._schemaData._refreshPivotButtons();this._schemaData._setPivotBtnWidth()},_calculatedFieldListChange:function(t){n("#"+this._id+"_calculateFieldName").val(t.selectedText);for(var i=0;i<this._calculatedField.length;i++)this._calculatedField[i].name==t.selectedText&&n("#"+this._id+"_calculatedFieldFormula").val(this._calculatedField[i].formula)},_parenthesisAsterisk:function(n){for(var t=1;t<n.length-1;t++)n[t]=="("&&"+-/%^*(".indexOf(n[t-1])==-1&&(n=n.substring(0,t)+"*"+n.substring(t),t--),n[t]==")"&&"+-/%^*)".indexOf(n[t+1])==-1&&(n=n.substring(0,t+1)+"*"+n.substring(t+1),t--);return n},_calcFieldNodeDrop:function(t){for(var r=n.grep(this.model.dataSource.values,function(n){return n.isCalculatedField==!0&&n.formula.indexOf(t.fieldName)>-1}),i=0;i<r.length;i++)this._schemaData._tableTreeObj.uncheckNode(r[i].fieldName)},_schemaButtonCreate:function(){if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){n(this._schemaData.element.find(".e-schemaValue .e-pivotButton")).each(function(){n(this).remove()});report=JSON.parse(this.getOlapReport());for(var i=0;i<report.PivotCalculations.length;i++)this._schemaData._createPivotButton({fieldName:report.PivotCalculations[i].FieldName,fieldCaption:report.PivotCalculations[i].FieldHeader},"value","","","")}this._schemaData._setPivotBtnWidth()},_calculatedFieldNodeRemove:function(i){for(var u=n.grep(JSON.parse(this.getOlapReport()).PivotCalculations,function(n){return n.CalculationType==8&&n.Formula.indexOf(i.id)>-1}),r=0;r<u.length;r++)this._schemaData._tableTreeObj.model.nodeUncheck=null,this._schemaData._tableTreeObj.uncheckNode(u[r].FieldName),this._schemaData._tableTreeObj.element.find("li[id='"+u[r].FieldName+"']").removeClass("filter").find(".treeDrop").remove(),this._schemaData._tableTreeObj.model.nodeUncheck=t.proxy(this._schemaData._checkedStateModified,this._schemaData)},createConditionalDialog:function(){this.openConditionalFormattingDialog()},openConditionalFormattingDialog:function(){var s,h,c,p,l,a,y,u,e;if(!this.model.enableConditionalFormatting)return!1;t.Pivot.openPreventPanel(this);this.element.find(".e-dialog").remove();s=t.buildTag("div#"+this._id+"_clientDlg.clientDialog",{opacity:"1"})[0].outerHTML;c=this._getLocalizedLabels("ConditionalFormatting");var w=t.buildTag("label#"+this._id+"_conLbl.e-conditionLbl",this._getLocalizedLabels("Condition"))[0].outerHTML,b=t.buildTag("input#"+this._id+"_conType.conditionType","",{},{type:"text",tabindex:0,accesskey:"f"})[0].outerHTML,k=t.buildTag("label#"+this._id+"_editcond.e-editcondition",this._getLocalizedLabels("FormatName"))[0].outerHTML,d=t.buildTag("label#"+this._id+"_value1.value1",this._getLocalizedLabels("Value1"))[0].outerHTML,g=t.buildTag("label#"+this._id+"_value2.e-value2",this._getLocalizedLabels("Value2"))[0].outerHTML,nt=t.buildTag("label#"+this._id+"_backcolorLbl.backcolorLbl",this._getLocalizedLabels("Backcolor"))[0].outerHTML,tt=t.buildTag("label#"+this._id+"_bordercolorLbl.bordercolorLbl",this._getLocalizedLabels("Bordercolor"))[0].outerHTML,it=t.buildTag("label#"+this._id+"_borderrangeLbl.e-borderrangeLbl",this._getLocalizedLabels("Borderrange"))[0].outerHTML,rt=t.buildTag("label#"+this._id+"_borderstyleLbl.e-borderstyleLbl",this._getLocalizedLabels("Borderstyle"))[0].outerHTML,ut=t.buildTag("label#"+this._id+"_fStyleLbl.fStyleLbl",this._getLocalizedLabels("Fontstyle"))[0].outerHTML,ft=t.buildTag("label#"+this._id+"_fSizeLbl.e-fSizeLbl",this._getLocalizedLabels("Fontsize"))[0].outerHTML,et=t.buildTag("label#"+this._id+"_fontcolorLbl.fontcolorLbl",this._getLocalizedLabels("Fontcolor"))[0].outerHTML,ot=t.buildTag("label#"+this._id+"_fValueLbl.fValueLbl",this._getLocalizedLabels("Measures"))[0].outerHTML,st=t.buildTag("input#"+this._id+"_editCon.editconditionDropDown","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,ht=t.buildTag("input#"+this._id+"_editConText.editconditionText","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,v=t.buildTag("button#"+this._id+"_editBtn",this._getLocalizedLabels("Edit"),{},{name:this._getLocalizedLabels("Edit")}).attr("title",this._getLocalizedLabels("Edit")).attr("role","button").attr("aria-label","edit")[0].outerHTML,p=t.buildTag("button#"+this._id+"_removeBtn.e-dialogremoveBtn e-icon","",{},{name:this._getLocalizedLabels("Remove")}).attr("title",this._getLocalizedLabels("RemoveFormat")).attr("role","button").attr("aria-label","remove")[0].outerHTML,ct=t.buildTag("input#"+this._id+"_conFrom.e-conditionFrom"+(t.isMobile()?" inputConditionMbl":""),"",{},{name:"inputVal",type:t.isMobile()?"number":"text",inputmode:t.isMobile()?"numeric":"",pattern:t.isMobile()?"[0-9]*":"",tabindex:2})[0].outerHTML,lt=t.buildTag("input#"+this._id+"_conTo.e-conditionTo"+(t.isMobile()?" inputConditionMbl":""),"",{},{name:"inputVal",type:t.isMobile()?"number":"text",inputmode:t.isMobile()?"numeric":"",pattern:t.isMobile()?"[0-9]*":"",tabindex:3})[0].outerHTML,at=t.buildTag("input#"+this._id+"_backcolor.backcolor","",{},{type:"text",tabindex:4,accesskey:"d"})[0].outerHTML,vt=t.buildTag("input#"+this._id+"_bordercolor.bordercolor","",{},{type:"text",tabindex:5,accesskey:"c"})[0].outerHTML,yt=t.buildTag("input#"+this._id+"_borderrange.borderrange","",{},{type:"text",tabindex:6,accesskey:"r"})[0].outerHTML,pt=t.buildTag("input#"+this._id+"_borderstyle.borderstyle","",{},{type:"text",tabindex:7,accesskey:"s"})[0].outerHTML,wt=t.buildTag("input#"+this._id+"_fStyle.fStyle","",{},{type:"text",tabindex:8,accesskey:"o"})[0].outerHTML,bt=t.buildTag("input#"+this._id+"_fSize.fSize","",{},{type:"text",tabindex:9,accesskey:"l"})[0].outerHTML,kt=t.buildTag("input#"+this._id+"_fontcolor.fontcolor","",{},{type:"text",tabindex:10,accesskey:"b"})[0].outerHTML,dt=t.buildTag("input#"+this._id+"_fValue.fValue","",{},{type:"text",tabindex:11,accesskey:"v"})[0].outerHTML,gt=t.buildTag("div#"+this._id+"_conditionDlg.e-conditionDlg","<table class='conditionformatTbl'><tr><td>"+w+"<\/td><td>"+b+"<\/td><td>"+k+"<\/td><td>"+(this.model.conditionalFormatSettings.length>0?st:ht)+"<\/td><td>"+v+"<\/td><td>"+p+"<\/td><\/tr><tr><td>"+d+"<\/td><td>"+ct+"<\/td><td>"+g+"<\/td><td>"+lt+"<\/td><\/tr><tr><td>"+ut+"<\/td><td>"+wt+"<\/td><td>"+it+"<\/td><td>"+yt+"<\/td><\/tr><tr><td>"+et+"<\/td><td>"+kt+"<\/td><td>"+rt+"<\/td><td>"+pt+"<\/td><\/tr><tr><td>"+nt+"<\/td><td>"+at+"<\/td><td>"+ft+"<\/td><td>"+bt+"<\/td><\/tr><tr><td>"+tt+"<\/td><td>"+vt+"<\/td><td>"+ot+"<\/td><td>"+dt+"<\/td><\/tr><\/table>")[0].outerHTML;h=gt;var ni=t.buildTag("button#"+this._id+"_OKBtn.e-dialogOKBtn","",{},{name:this._getLocalizedLabels("OK")}).attr("title",this._getLocalizedLabels("OK"))[0].outerHTML,ti=t.buildTag("button#"+this._id+"_CancelBtn.e-dialogCancelBtn","",{},{name:this._getLocalizedLabels("Cancel")}).attr("title",this._getLocalizedLabels("Cancel"))[0].outerHTML,ii=t.buildTag("div",ni+ti,{float:this.model.enableRTL?"left":"right",margin:"20px 0px 6px"})[0].outerHTML;n("#"+this._id).after(s);n("#"+this._id+"_clientDlg").append(h+ii);y=n(this.element).parents(".e-pivotclient").length>0?this.element.parents(".e-pivotclient")[0].id:this._id;n("#"+this._id+"_clientDlg").ejDialog({width:"auto",target:"#"+y,enableResize:!1,enableRTL:this.model.enableRTL,close:t.proxy(t.Pivot.closePreventPanel,this)});n(".e-titlebar").prepend(t.buildTag("div",c,{display:"inline"})[0].outerHTML)[0];n("#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,#"+this._id+"_removeBtn,#"+this._id+"_editBtn").ejButton({type:t.ButtonType.Button});n("#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn").css({margin:"0 0 0 10px",width:"67px"});n("#"+this._id+"_removeBtn").css({margin:this.model.enableRTL?"0px":"0 0 0 10px",width:"38px",height:"29px"});n("#"+this._id+"_editBtn").css({margin:"0 0 0 10px",width:"70px",height:"29px"});n("#"+this._id+"_conFrom,#"+this._id+"_conTo").css({width:"196px",height:"26px"});n("#"+this._id+"_conditionDlg").css({margin:"13px 0 0 0"});n("#"+this._id+"_editcond,#"+this._id+"_value2,#"+this._id+"_fValueLbl,#"+this._id+"_borderrangeLbl,#"+this._id+"_borderstyleLbl,#"+this._id+"_fSizeLbl").css({margin:"0 0 0 15px"});n("#"+this._id+"_editConText").length>0&&(this._formatEdit=!0);n("#"+this._id+"_editConText").ejMaskEdit({inputMode:t.InputMode.Text,width:"200px",height:"26px"});n("#"+this._id+"_conTo").attr("disabled","disabled");this.removeBtn=n("#"+this._id+"_removeBtn").data("ejButton");l=n("#"+this._id+"_OKBtn").data("ejButton");a=n("#"+this._id+"_CancelBtn").data("ejButton");v=n("#"+this._id+"_editBtn").data("ejButton");this.removeBtn.setModel({enabled:!1});l.setModel({text:this._getLocalizedLabels("OK")});a.setModel({text:this._getLocalizedLabels("Cancel")});n("#"+this._id+"_conType").ejDropDownList({change:"_activeConditionChange",dataSource:[{option:"Less Than",value:this._getLocalizedLabels("LessThan")},{option:"Less Than Or Equal To",value:this._getLocalizedLabels("LessThanOrEqualTo")},{option:"Greater Than",value:this._getLocalizedLabels("GreaterThan")},{option:"Greater Than Or Equal To",value:this._getLocalizedLabels("GreaterThanOrEqualTo")},{option:"Equals",value:this._getLocalizedLabels("Equals")},{option:"Not Equals",value:this._getLocalizedLabels("NotEquals")},{option:"Between",value:this._getLocalizedLabels("Between")},{option:"Not Between",value:this._getLocalizedLabels("NotBetween")},],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}});n("#"+this._id+"_editCon").ejDropDownList({change:"_editConditionChange",dataSource:this._formatName,selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}});n("#"+this._id+"_fontcolor").ejColorPicker({enableRTL:this.model.enableRTL});n("#"+this._id+"_backcolor").ejColorPicker({enableRTL:this.model.enableRTL});n("#"+this._id+"_bordercolor").ejColorPicker({enableRTL:this.model.enableRTL});n("#"+this._id+"_borderrange").ejDropDownList({dataSource:["1","2","3","4","5","6","7","8","9"],selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}});n("#"+this._id+"_borderstyle").ejDropDownList({dataSource:[{option:"Solid",value:this._getLocalizedLabels("Solid")},{option:"Dashed",value:this._getLocalizedLabels("Dashed")},{option:"Dotted",value:this._getLocalizedLabels("Dotted")},{option:"Double",value:this._getLocalizedLabels("Double")},{option:"Groove",value:this._getLocalizedLabels("Groove")},{option:"Inset",value:this._getLocalizedLabels("Inset")},{option:"Outset",value:this._getLocalizedLabels("Outset")},{option:"Ridge",value:this._getLocalizedLabels("Ridge")},{option:"None",value:this._getLocalizedLabels("None")},],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}});n("#"+this._id+"_fStyle").ejDropDownList({dataSource:[{option:"Algerian",value:this._getLocalizedLabels("Algerian")},{option:"Arial",value:this._getLocalizedLabels("Arial")},{option:"Bodoni MT",value:this._getLocalizedLabels("BodoniMT")},{option:"Britannic Bold",value:this._getLocalizedLabels("BritannicBold")},{option:"Cambria",value:this._getLocalizedLabels("Cambria")},{option:"Calibri",value:this._getLocalizedLabels("Calibri")},{option:"Courier New",value:this._getLocalizedLabels("CourierNew")},{option:"DejaVu Sans",value:this._getLocalizedLabels("DejaVuSans")},{option:"Forte",value:this._getLocalizedLabels("Forte")},{option:"Gerogia",value:this._getLocalizedLabels("Gerogia")},{option:"Impact",value:this._getLocalizedLabels("Impact")},{option:"Segoe UI",value:this._getLocalizedLabels("SegoeUI")},{option:"Tahoma",value:this._getLocalizedLabels("Tahoma")},{option:"Times New Roman",value:this._getLocalizedLabels("TimesNewRoman")},{option:"Verdana",value:this._getLocalizedLabels("Verdana")},{option:"None",value:this._getLocalizedLabels("None")},],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}});n("#"+this._id+"_fSize").ejDropDownList({dataSource:["12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}});var f=[],i=[],o;if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){if(n(this.element).parents(".e-pivotclient").length>0)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(u=0;u<this._JSONRecords.length;u++)this._JSONRecords[u].Info.indexOf("Measures")>-1&&n.inArray(this._JSONRecords[u].Value,i)==-1&&i.push(this._JSONRecords[u].Value);else i=JSON.parse(this._pivotClientObj.getOlapReport()).PivotCalculations;else i=JSON.parse(this.getOlapReport()).PivotCalculations;o="FieldHeader"}else if(o="fieldCaption",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)i=this.model.dataSource.values;else for(u=0;u<this.model.dataSource.values.length;u++)i=this.model.dataSource.values[u].measures;for(f=i.length>0?["All"]:f,e=0;e<i.length;e++)n(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap?f.push(i[e]):f.push(i[e][o]);return f=f.length>0?f:["No Measure"],n("#"+this._id+"_fValue").ejDropDownList({dataSource:f,selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){n(this.wrapper.find(".e-input")).focus(function(){n(this).blur()})}}),n("#"+this._id+"_conType").ejDropDownList("option","change",t.proxy(this._activeConditionChange,this)),n("#"+this._id+"_editCon").ejDropDownList("option","change",t.proxy(this._editConditionChange,this)),this.isNewFormat=!0,this.ddlEditCondition=n("#"+this._id+"_editCon").data("ejDropDownList"),this.ddlConditionType=n("#"+this._id+"_conType").data("ejDropDownList"),this.ddlFont=n("#"+this._id+"_fStyle").data("ejDropDownList"),this.ddlFontSize=n("#"+this._id+"_fSize").data("ejDropDownList"),this.ddlFontColor=n("#"+this._id+"_fontcolor").data("ejColorPicker"),this.ddlBackColor=n("#"+this._id+"_backcolor").data("ejColorPicker"),this.ddlBorderColor=n("#"+this._id+"_bordercolor").data("ejColorPicker"),this.ddlBorderStyle=n("#"+this._id+"_borderstyle").data("ejDropDownList"),this.ddlBorderWidth=n("#"+this._id+"_borderrange").data("ejDropDownList"),this.ddlFieldValue=n("#"+this._id+"_fValue").data("ejDropDownList"),this.element.find("#"+this._id+"_conFrom,#"+this._id+"_conTo").keypress(function(t){return t.which==8||t.which==0?!0:t.which<45||t.which==45&&(t.target.value!=""||t.target.value.indexOf("-")>-1)||t.which>58?!1:t.which==46&&n(this).val().indexOf(".")!=-1||t.which==47?!1:void 0}),n("#"+this._id+"_OKBtn").click(function(){var i=null,e=!1,f,u;if(i=n(this).parents(".e-pivotclient").length>0?n(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"):n(this).parents(".e-pivotgrid").data("ejPivotGrid"),!t.isNullOrUndefined(i.ddlEditCondition))for(f=0;f<i.ddlEditCondition.model.dataSource.length;f++)i.ddlEditCondition.model.dataSource[f]==n("#"+i._id+"_editConText").val()&&f!=i.ddlEditCondition.selectedIndexValue&&(e=!0);this.ddlEditCondition=n("#"+i._id+"_editCon").data("ejDropDownList");u=n(this).parents(".e-pivotclient").length>0?n(this).parents(".e-pivotclient").data("ejPivotClient"):i;n("#"+i._id+"_editConText").val()==""?t.Pivot._createErrorDialog(i._getLocalizedLabels("EnterFormatName"),i._getLocalizedLabels("Warning"),u):i._formatEdit&&n("#"+i._id+"_editConText").val()!=r&&n.inArray(n("#"+i._id+"_editConText").val(),i._formatName)!=-1||!t.isNullOrUndefined(n("#"+i._id+"_editConText").val())&&e?t.Pivot._createErrorDialog(i._getLocalizedLabels("DuplicateFormatName"),i._getLocalizedLabels("Warning"),u):n("#"+i._id+"_conFrom").val()==""?t.Pivot._createErrorDialog(i._getLocalizedLabels("EnterOperand1"),i._getLocalizedLabels("Warning"),u):n("#"+i._id+"_conTo").attr("disabled")||n("#"+i._id+"_conTo").val()!=""?n("#"+i._id+"_fValue").attr("disabled")&&n("#"+i._id+"_fValue").val()=="No Measure"?t.Pivot._createErrorDialog(i._getLocalizedLabels("NoMeasure"),i._getLocalizedLabels("Warning"),u):(i._applyFormatting(),t.Pivot.closePreventPanel(i)):t.Pivot._createErrorDialog(i._getLocalizedLabels("EnterOperand2"),i._getLocalizedLabels("Warning"),u)}),this.ddlEditCondition!=r&&(this.ddlEditCondition.getListData().length>1?n("#"+this._id+"_editCon").ejDropDownList("enable"):(n("#"+this._id+"_editCon").ejDropDownList("disable"),n("#"+this._id+"_editcond").css("color","#cbcbcb"))),this.ddlFieldValue.getListData().length==1&&this.ddlFieldValue._selectedValue=="No Measure"?(n("#"+this._id+"_fValue").ejDropDownList("disable"),n("#"+this._id+"_fValueLbl").css("color","#cbcbcb")):n("#"+this._id+"_fValue").ejDropDownList("enable"),this.model.conditionalFormatSettings.length>0&&(this.ddlEditCondition.selectItemByValue(this.model.conditionalFormatSettings[this.model.conditionalFormatSettings.length-1].name),this._editConditionChange()),n("#"+this._id+"_removeBtn").click(function(){var t=null,i,r;(t=n(this).parents(".e-pivotclient").length>0?n(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"):n(this).parents(".e-pivotgrid").data("ejPivotGrid"),t.removeBtn.option("enabled"))&&(i=confirm(t._getLocalizedLabels("ConditionalFormattingConformMsg")),i==!0&&(r=t.ddlEditCondition._selectedIndices[0],t._removeCellFormatting(r,i),n(this).parents(".e-pivotclient").length>0?n(this).parents(".e-pivotclient").find(".e-dialog, .clientDialog").remove():t.element.find(".e-dialog, .clientDialog").remove()))}),n("#"+this._id+"_CancelBtn").click(function(){var i=null;n(this).parents(".e-pivotclient").length>0?(i=n(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"),n(this).parents(".e-pivotclient").find(".e-dialog, .e-clientDialog").remove()):i=n(this).parents(".e-pivotgrid").data("ejPivotGrid");i.element.find(".e-dialog, .e-clientDialog").remove();t.Pivot.closePreventPanel(i)}),n("#"+this._id+"_editBtn").click(function(){var t=null;t=n(this).parents(".e-pivotclient").length>0?n(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"):n(this).parents(".e-pivotgrid").data("ejPivotGrid");t._editBtnAdd()}),!1},_editBtnAdd:function(){var i,u;n("#"+this._id+"_editConText").length==0&&(this._formatEdit=!0,i=t.buildTag("input#"+this._id+"_editConText.editconditionText","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,n(n(".editconditionDropDown").parents("td")[0]).before("<td>"+i+"<\/td>"),n(n(".editconditionDropDown").parents("td")[0]).css("display","none"),u=this.ddlEditCondition!=r&&this.ddlEditCondition.selectedTextValue!=r&&this.ddlEditCondition.selectedTextValue!=this._getLocalizedLabels("AddNew")?this.ddlEditCondition.selectedTextValue:"",this._formatEdit=this.ddlEditCondition!=r&&this.ddlEditCondition.selectedTextValue!=r&&this.ddlEditCondition.selectedTextValue==this._getLocalizedLabels("AddNew")?!0:!1,n("#"+this._id+"_editConText").ejMaskEdit({inputMode:t.InputMode.Text,value:u,width:"200px",height:"26px"}))},_activeConditionChange:function(t){t.selectedValue=="Between"||t.selectedValue=="Not Between"?n("#"+this._id+"_conTo").removeAttr("disabled"):(n("#"+this._id+"_conTo").attr("disabled","disabled"),n("#"+this._id+"_conTo").val(""))},_editConditionChange:function(){if(this.ddlEditCondition._selectedIndices[0]>0){var i=this.ddlEditCondition._selectedIndices[0]-1,t=this._cFormat[i].split(",");this.ddlConditionType.selectItemByValue(t[1]);n("#"+this._id+"_conFrom").val(t[9]);t[9]!="undefined"&&t[10]!="undefined"&&n("#"+this._id+"_conTo").val(t[10]);n("#"+this._id+"_fontcolor").ejColorPicker({value:t[2]});n("#"+this._id+"_backcolor").ejColorPicker({value:t[3]});n("#"+this._id+"_bordercolor").ejColorPicker({value:t[4]});this.ddlBorderStyle.selectItemByValue(t[8]);this.ddlBorderWidth.selectItemByValue(t[5]);this.ddlFont.selectItemByValue(t[6]);this.ddlFontSize.selectItemByValue(t[7]);this.ddlFieldValue.selectItemByValue(t[11]);this.removeBtn.option("enabled",!0);this._conditionTypeChange()}else this._editBtnAdd(),this.removeBtn.option("enabled",!1),this._clearWindow()},_clearWindow:function(){n("#"+this._id+"_clientDlg").find("#"+this._id+"_conFrom,#"+this._id+"_conTo").val("");n("#"+this._id+"_conTo").disabled=!0},_conditionTypeChange:function(){n("#"+this._id+"_conTo").disabled=!(this.ddlConditionType._selectedIndices[0]==4||this.ddlConditionType._selectedIndices[0]==5)},_removeCellFormatting:function(n,t){for(var i,r=n,u=0;u<this._cFormat.length&&n;u++)for(t&&(u=n-1,n=0),i=0;i<this._JSONRecords.length;i++)this._JSONRecords[i].CSS=this._JSONRecords[i].CSS.replace(" "+this._cFormat[u].split(",")[0].replace(/ /g,""),"");t?(this._cFormat.splice(r-1,1),this._list.splice(r-1,1),this.model.conditionalFormatSettings.splice(r-1,1),this._formatName.splice(r,1)):(this._cFormat=[],this._list=[],this.model.conditionalFormatSettings=[],this._formatName=[this._getLocalizedLabels("AddNew")]);this.renderControlFromJSON()},_applyStyle:function(i,r,u,f,e,o,s,h,c){var y=r.CSS,v=!1,a=i=="rows"?r.Index.split(",")[1]:i=="columns"?r.Index.split(",")[0]:null,l;c=c.replace(/ /g,"");(r.Value==u||u=="All")&&(n.inArray(Number(a),f)==-1?f.push(Number(a)):f);l=n.isNumeric(r.Value)==!0?r.Value:n.isNumeric(t.globalize.parseFloat(t.globalize.format(r.Value,"c",this.model.locale),this.model.locale))?t.globalize.parseFloat(t.globalize.format(r.Value,"c",this.model.locale),this.model.locale):r.Value.replace(/[^\d.\-]/g,"");v=n.inArray(Number(a),f)!=-1?!0:!1;this._getResult(Number(e),Number(o),l,s)&&!t.isNullOrUndefined(l)&&n.isNumeric(l)&&v&&r.CSS.indexOf("value")!=-1&&(r.CSS=y+" "+c)},_refreshCellFormatting:function(n){for(var u,t,i,f=this._getAxis(),r=0;r<this._cFormat.length;r++)for(u=[],t=this._cFormat[r].split(","),i=0;i<n.length;i++)n[i].CSS.indexOf(t[0].replace(/ /g,""))===-1&&this._applyStyle(f,n[i],t[11],u,t[9],t[10],t[1],i,this._cFormat[r].split(",")[0].replace(/ /g,""));return n},_createDynamicRule:function(n,t,i,r,u,f,e,o){var s=function(){var n=document.createElement("style");return n.appendChild(document.createTextNode("")),document.head.appendChild(n),n.sheet}(),h="color: "+n+"!important;background-color: "+t+" !important;border:"+i+" "+r+"px "+u+" !important;font:"+f+"px "+e+" !important;";s.insertRule("."+o.replace(/ /g,"")+"{"+h+"}",0)},_getMDXAxis:function(){for(var i="",n=0;n<this._JSONRecords.length;n++)if(!t.isNullOrUndefined(this._JSONRecords[n].Info)&&this._JSONRecords[n].Info.toLowerCase().indexOf("measures")>-1){i=this._JSONRecords[n].CSS.indexOf("colheader")>-1?"columns":this._JSONRecords[n].CSS.indexOf("rowheader")>-1?"rows":"";break}return i},_getAxis:function(){var f,u,i;if(n(this.element).parents(".e-pivotclient").length>0&&(typeof pivotGridObj!="undefined"&&this.element.hasClass("e-pivotgrid")&&(pivotGridObj=this),this._pivotClientObj.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.setOlapReport(n(this.element).parents(".e-pivotclient").data("ejPivotClient").model.dataSource)),this.getOlapReport())if(f=null,u="",this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){for(this.getOlapReport()!=r&&this.getOlapReport()!=""&&JSON.parse(this.getOlapReport()).PivotCalculations.length>0&&(f=JSON.parse(this.getOlapReport()).PivotCalculations[0].FieldHeader),i=0;i<this._JSONRecords.length;i++)if(this._JSONRecords[i].Value==f){u=this._JSONRecords[i].CSS.indexOf("colheader")>-1?"columns":this._JSONRecords[i].CSS.indexOf("rowheader")>-1?"rows":"";break}}else if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)u="columns";else for(i=0;i<this.getOlapReport().values.length;i++)u=this.getOlapReport().values[i].axis;return u==""&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(u=this._getMDXAxis()),u},_applyCodeBehindFormatting:function(i){var o,s,r,f,e,h,u,c;if(this._isFormatApply=!0,s=this._getAxis(),!t.isNullOrUndefined(this.model.conditionalFormatSettings))for(r=0;r<this.model.conditionalFormatSettings.length;r++)if(f=[],f=this.model.conditionalFormatSettings[r].measures.split(","),n.inArray(this.model.conditionalFormatSettings[r].name,this._formatName)==-1){for(this.model.conditionalFormatSettings[r].className=this._id+"_"+this.model.conditionalFormatSettings[r].name.trim().toLowerCase(),e=0;e<f.length;e++)for(h=[],o=f[e],u=0;u<i.length;u++)this._applyStyle(s,i[u],o,h,t.isNullOrUndefined(this.model.conditionalFormatSettings[r].value.split(",")[0])?"":this.model.conditionalFormatSettings[r].value.split(",")[0],t.isNullOrUndefined(this.model.conditionalFormatSettings[r].value.split(",")[1])?"":this.model.conditionalFormatSettings[r].value.split(",")[1],this.model.conditionalFormatSettings[r].condition,u,this.model.conditionalFormatSettings[r].className);c=this.model.conditionalFormatSettings[r].className+","+this.model.conditionalFormatSettings[r].condition+","+this.model.conditionalFormatSettings[r].style.color+","+this.model.conditionalFormatSettings[r].style.backgroundcolor+","+this.model.conditionalFormatSettings[r].style.bordercolor+","+this.model.conditionalFormatSettings[r].style.borderwidth+","+this.model.conditionalFormatSettings[r].style.fontstyle+","+this.model.conditionalFormatSettings[r].style.fontsize+","+this.model.conditionalFormatSettings[r].style.borderstyle+","+this.model.conditionalFormatSettings[r].value.split(",")[0]+","+this.model.conditionalFormatSettings[r].value.split(",")[1]+","+o;this._cFormat.push(c);this._list.push(this.model.conditionalFormatSettings[r].className);this._formatName.push(this.model.conditionalFormatSettings[r].name);this._createDynamicRule(this.model.conditionalFormatSettings[r].style.color,this.model.conditionalFormatSettings[r].style.backgroundcolor,this.model.conditionalFormatSettings[r].style.borderstyle,this.model.conditionalFormatSettings[r].style.borderwidth,this.model.conditionalFormatSettings[r].style.bordercolor,this.model.conditionalFormatSettings[r].style.fontsize,this.model.conditionalFormatSettings[r].style.fontstyle,this.model.conditionalFormatSettings[r].className)}return this._JSONRecords=i,i},_applyFormatting:function(){var w,i;this._isFormatApply=!0;var b,u,y,e,k=[],p,d,o,s,h,c,l,a,v,f=n("#"+this._id+"_editConText").val();if(t.isNullOrUndefined(n("#"+this._id+"_conFrom").val())||(this._formatValue1=n("#"+this._id+"_conFrom").val(),this._formatValue2=n("#"+this._id+"_conTo").val(),d=this.ddlConditionType._selectedValue,o=this.ddlFontColor.model.value,s=this.ddlBackColor.model.value,h=this.ddlBorderColor.model.value,c=this.ddlBorderWidth._selectedValue,l=this.ddlFont._selectedValue,a=this.ddlFontSize._selectedValue,v=this.ddlBorderStyle._selectedValue),e=this.ddlFieldValue._selectedValue!=r?this.ddlFieldValue._selectedValue:"",n(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap){for(i=0;i<this._JSONRecords.length;i++)if(this._JSONRecords[i].Info.indexOf("Measures")>-1&&(p=this._JSONRecords[i].CSS=="colheader"?"columns":this._JSONRecords[i].CSS=="rowheader"?"rows":""),p!="")break}else for(field=JSON.parse(this.getOlapReport()).PivotCalculations[0].FieldHeader,i=0;i<this._JSONRecords.length;i++)if(this._JSONRecords[i].Value==field){p=this._JSONRecords[i].CSS=="colheader calc"?"columns":this._JSONRecords[i].CSS=="rowheader"?"rows":"";break}}else p=this._getAxis();if(this._formatEdit)u=this._id+"_"+f.trim().toLowerCase(),b=u+","+this.ddlConditionType._selectedValue+","+o+","+s+","+h+","+c+","+l+","+a+","+v+","+this._formatValue1+","+this._formatValue2+","+e,this._cFormat.push(b),this._list.push(u),this._formatName.push(f),w={name:f,style:{fontcolor:o,backgroundcolor:s,bordercolor:h,borderstyle:v,borderwidth:c,fontsize:a,fontstyle:l},condition:this.ddlConditionType._selectedValue,value:this._formatValue1+","+this._formatValue2,measures:e,className:u},this.model.conditionalFormatSettings.push(w);else for(f=f!=""&&f!=r?f:this.ddlEditCondition._selectedValue,y=this.ddlEditCondition._selectedIndices[0]-1,this._formatName[y+1]=f,u=this.model.conditionalFormatSettings[y].className,this._cFormat[y]=u+","+this.ddlConditionType._selectedValue+","+o+","+s+","+h+","+c+","+l+","+a+","+v+","+this._formatValue1+","+this._formatValue2+","+e,w={name:f,style:{fontcolor:o,backgroundcolor:s,bordercolor:h,borderstyle:v,borderwidth:c,fontsize:a,fontstyle:l},condition:this.ddlConditionType._selectedValue,value:this._formatValue1+","+this._formatValue2,measures:e,className:u},this.model.conditionalFormatSettings[y]=w,i=0;i<this._JSONRecords.length;i++)this._JSONRecords[i].CSS=this._JSONRecords[i].CSS.replace(" "+u,"");for(i=0;i<this._JSONRecords.length;i++)this._applyStyle(p,this._JSONRecords[i],e,k,this._formatValue1,this._formatValue2,this.ddlConditionType._selectedValue,i,u);this._createDynamicRule(o,s,v,c,h,a,l,u);this.renderControlFromJSON();n(this.element).parents(".e-pivotclient").length>0&&n(this.element).parents(".e-pivotclient").find(".e-dialog, .e-clientDialog").remove();this.element.find(".e-dialog, .e-clientDialog").remove();this._formatEdit=!1},_getResult:function(n,t,i,r){switch(r){case"Less Than":return i<n;case"Less Than Or Equal To":if(i<=n)return i;break;case"Greater Than":return i>n;case"Greater Than Or Equal To":if(i>=n)return i;break;case"Equals":if(i==n)return i;break;case"Not Equals":return i!=n;case"Between":return n<t&&i>n&&i<t||n>t&&i<n&&i>t||i==n&&i==t;case"Not Between":return!(n<t&&i>n&&i<t||n>t&&i<n&&i>t||i==n&&i==t)}},_appendCssClassName:function(n){var s,h,a,v=!0,c=h=s=!1,l=!1,p=a=-1,y,u,e,o,f,r,i;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){for(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(y="FieldHeader",u="CssClass",e=JSON.parse(this.getOlapReport()).PivotRows,o=JSON.parse(this.getOlapReport()).PivotColumns,f=JSON.parse(this.getOlapReport()).PivotCalculations):(y="fieldCaption",u="cssClass",e=this.model.dataSource.rows,o=this.model.dataSource.columns,f=this.model.dataSource.values),i=0;i<e.length&&!c;i++)t.isNullOrUndefined(e[i].cssClass)||(c=!0);for(i=0;i<o.length&&!h;i++)t.isNullOrUndefined(o[i].cssClass)||(h=!0);for(i=0;i<f.length&&!s;i++)t.isNullOrUndefined(f[i].cssClass)||(s=!0);for(r=0;r<n.length&&(c||h||s);r++){for(i=0;i<e.length&&v&&c;i++)t.isNullOrUndefined(e[i][u])||Number(n[r].Index.split(",")[0])!=i||n[r].CSS.indexOf("none")!=-1||n[r].CSS.indexOf(e[i][u])!=-1||(n[r].CSS=n[r].CSS+" "+e[i][u]),v&&n[r].CSS.indexOf("colheader")>-1&&(v=!1);for(i=0;i<o.length&&h;i++)t.isNullOrUndefined(o[i][u])||Number(n[r].Index.split(",")[1])!=i||n[r].CSS.indexOf("none")!=-1||n[r].CSS.indexOf(o[i][u])!=-1||(n[r].CSS=n[r].CSS+" "+o[i][u]);for(i=0;i<f.length&&s;i++)l&&(n[r].CSS.indexOf("colheader")>-1||n[r].CSS.indexOf("cgtot")>-1||n[r].CSS.indexOf("cstot")>-1||n[r].CSS.indexOf("gtot")>-1||n[r].CSS.indexOf("stot")>-1)&&n[r].CSS.indexOf("calc")==-1&&(l=!1),f[i][y]==n[r].Value&&(l=!0,p=n[r].Index.split(",")[0],a=i),!t.isNullOrUndefined(f[i][u])&&l&&p==n[r].Index.split(",")[0]&&a==i&&n[r].CSS.indexOf(f[i][u])==-1&&(n[r].CSS=n[r].CSS+" "+f[i][u])}}return n},_updateReportSettings:function(i){var r=n.map(i,function(n){var t=n.Key;if(t=="JsonRecords"||t=="PivotRecords")return n}),f=n.map(i,function(n){var t=n.Key;if(t=="PivotReport"||t=="OlapReport")return n}),u=n.map(i,function(n){var t=n.Key;if(t=="SortColIndex")return n});this.setJSONRecords(r.length>0?r[0].Value:null);this.setOlapReport(f[0].Value);u.length>0?(t.PivotAnalysis._valueSorting=JSON.parse(u[0].Value),t.PivotAnalysis._sort=this.model.valueSortSettings.sortOrder):t.PivotAnalysis._valueSorting=null},_updatePageSettings:function(t,i){var r=n.map(t,function(n){var t=n.Key;if(t=="PageSettings")return n}),u=n.map(t,function(n){var t=n.Key;if(t=="HeaderCounts")return n});r.length>0&&i._pagerObj!=null&&(i._pagerObj.element.css("opacity","1"),i._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),i._pagerObj._unwireEvents(),i._pagerObj._wireEvents(),i._pagerObj.initPagerProperties(JSON.parse(u[0].Value),JSON.parse(r[0].Value)))},_removeCells:function(i){var p=[],w=[],a,c,b,o,f,v,st,d,u,g,nt,h,ht,e,l,ut,ct,tt,it,y,s;if(i[0]!=r&&i.length>0?(a=n.map(i,function(n){var t=n.Key;if(t=="FilteredColumnHeaders")return n}),c=n.map(i,function(n){var t=n.Key;if(t=="FilteredRowHeaders")return n}),a.length>0&&(p=JSON.parse(a[0].Value)),c.length>0&&(w=JSON.parse(c[0].Value))):i.d!=r?(a=n.map(i.d,function(n){var t=n.Key;if(t=="FilteredColumnHeaders")return n}),c=n.map(i.d,function(n){var t=n.Key;if(t=="FilteredRowHeaders")return n}),a.length>0&&(p=JSON.parse(a[0].Value)),c.length>0&&(w=JSON.parse(c[0].Value))):(i.FilteredColumnHeaders&&(p=JSON.parse(i.FilteredColumnHeaders)),i.FilteredRowHeaders&&(w=JSON.parse(i.FilteredRowHeaders))),p.length>0){for(h=p,e=0;e<h.length;e++)for(l=h[e].From;l<=h[e].To;l++)for(u=h[e].Level;u<this._rowCount;u++)this.element.find(".e-pivotGridTable  [data-p='"+l+","+u+"']").remove();for(c=this.element.find(".e-pivotGridTable thead").children(),b=c.length-2;b>=0;b--)for(o=n(c[b]).find("th.colheader:visible"),f=0;f<=o.length-1;f++){for(v=n(o[f]).attr("colSpan"),u=0;u<=parseInt(n(o[f]).attr("colSpan"))-1;u++)st=parseInt(n(o[f]).attr("data-p").split(",")[0])+u,d=this.element.find(".e-pivotGridTable  [data-p='"+st+","+(b+1)+"']:visible"),n(d).length>0?v=parseInt(v)+(n(d).attr("colspan")?parseInt(n(d).attr("colspan"))-1:0):v--;if(v==0&&n(o[f]).nextAll(".summary.stot:eq(0)").length>0){var k=n(o[f]).nextAll(".summary.stot:eq(0)").attr("data-p").split(",")[0],rt=[],h=[];for(u=0;u<this._rowCount;u++){if(g="[data-p='"+parseInt(k)+","+u+"'] ",h.push(g),this._JSONRecords[parseInt(k)*this._rowCount+u].ColSpan>1&&this.element.find(".e-pivotGridTable [data-p='"+parseInt(k)+","+u+"']:visible").length>0)for(nt=1;nt<=this._JSONRecords[parseInt(k)*this._rowCount+u].ColSpan-1;nt++)rt.push(parseInt(k)+nt);for(hc=0;hc<rt.length;hc++)g+=", [data-p='"+rt[hc]+","+u+"'] ";this.element.find(".e-pivotGridTable "+g).remove()}}t.isNullOrUndefined(n(o[f]).attr("vfColSpan"))&&n(o[f]).attr("vfColSpan",n(o[f]).attr("colSpan"));n(o[f]).attr("colSpan",v)}this.element.find(".colheader[colspan='0']:not(.gtot,.calc)").remove()}if(w.length>0){for(h=w,ht=parseInt(this.element.find(".e-pivotGridTable td:eq(0)").attr("data-p").split(",")[0])-2,e=0;e<h.length;e++)for(l=h[e].From;l<=h[e].To;l++)this.element.find(".e-pivotGridTable tr:eq("+l+") th:last").css("display","none"),this.element.find(".e-pivotGridTable tr:eq("+l+") td").css("display","none");for(s=ht;s>=0;s--)for(ut=this.element.find(".e-pivotGridTable tbody").find(" .rowheader[data-p^='"+s+",'] :visible"),ct=this.element.find(".e-pivotGridTable th.rowheader").parent(),tt=0;tt<=ut.length;tt++){var ft=n(ut[tt]).parent(),lt=parseInt(ft.attr("rowSpan")),et=ft.attr("data-p");if(et){var at=parseInt(et.split(",")[1]),vt=parseInt(et.split(",")[0]),ot=0;for(it=at;it<=at+lt;it++)y=ct.children(" [data-p='"+(s+1)+","+it+"']"),y.length>0&&!y.is(":visible")&&(ot=ot+parseInt(y.attr("rowSpan"))+(y.next("th.rowheader").length>0||parseInt(y.attr("rowSpan"))>1?1:0));ot==lt&&ft.css("display","none")}}for(s=0;s<n(this.element.find(".summary.stot")).length;s++)n(this.element.find(".summary.stot")[s]).nextAll().text()==""&&(n(this.element.find(".summary.stot")[s]).css("display","none"),n(this.element.find(".summary.stot")[s]).nextAll().css("display","none"))}this.model.enableGroupingBar&&this._createFields(null,n("#"+this._id).find(".e-pivotGridTable").width(),n("#"+this._id).find(".e-pivotGridTable th").outerWidth())},saveXMLReport:function(n,t){var i=JSON.parse(this.getOlapReport()).Report,r={clientReports:i,fileName:n};this.doPostBack(t,r)},_reportModelUpdate:function(i){t.isNullOrUndefined(i)||(this.model.enableGrandTotal=i.ShowGrandTotals,this.model.enableCollapseByDefault=i.enableCollapseByDefault,i.ShowSubTotals||(n.each(i.PivotRows,function(n,t){t.showSubTotal=!1}),n.each(i.PivotColumns,function(n,t){t.showSubTotal=!1})),this.setOlapReport(JSON.stringify(i)),this.model.enableColumnResizing=i.AllowResizeColumns,this.model.resizeColumnsToFit=i.ResizePivotGridToFit,this.model.enableCellSelection=i.AllowSelection,this.model.enableDeferUpdate=i.DeferLayoutUpdate,this.model.frozenHeaderSettings.enableFrozenHeaders=i.FreezeHeaders,this.model.enableGroupingBar=i.ShowGroupingBar,this.model.enablePivotFieldList=i.ShowFieldList,this.model.collapsedMembers={},this.model._isXMLImport=!1)},_renderControlSuccess:function(i){var f,c,l,e,a,s,v,y,u,o,h,p;try{if(i[0]!=r&&i.length>0?(this._updateReportSettings(i),i[2]!=null&&i[2]!=r&&(f=i[2].Key,f=="PageSettings"&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i[3].Value).Column/JSON.parse(i[2].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i[3].Value).Row/JSON.parse(i[2].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i[2].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i[2].Value).SeriesPageSize):n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&this._pagerObj!=null&&this._pagerObj.initPagerProperties(JSON.parse(i[3].Value),JSON.parse(i[2].Value)),t.isNullOrUndefined(i[4])||(f=i[4].Key,f=="DataSet"?(this._dataSet=i[4].Value,t.isNullOrUndefined(i[5])||(this.model.customObject=i[5].Value)):this.model.customObject=i[4].Value))),t.isNullOrUndefined(i[2])||(f=i[2].Key,f=="DataSet"?(this._dataSet=i[2].Value,t.isNullOrUndefined([3])||(this.model.customObject=i[3].Value)):this.model.customObject=i[2].Value),t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._pagerObj==null||this._updatePageSettings(i,this._pivotClientObj)):i.d!=r&&i.d.length>0?(this._updateReportSettings(i.d),i.d[2]!=null&&i.d[2]!=r?(f=i.d[2].Key,f=="PageSettings"&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.d[3].Value).Column/JSON.parse(i.d[2].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.d[3].Value).Row/JSON.parse(i.d[2].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i.d[2].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.d[2].Value).SeriesCurrentPage):this._pagerObj!=null&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&this._pagerObj.initPagerProperties(JSON.parse(i.d[3].Value),JSON.parse(i.d[2].Value)),t.isNullOrUndefined(i.d[4])||(f=i.d[4].Key,f=="DataSet"?(this._dataSet=i.d[4].Value,t.isNullOrUndefined(i.d[5])||(this.model.customObject=i.d[5].Value)):this.model.customObject=i.d[4].Value),t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._pagerObj==null||this._updatePageSettings(i.d,this._pivotClientObj))):t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._pagerObj==null||i.d.length!=2||(this._pivotClientObj._pagerObj.element.css("opacity","0.5"),this._pivotClientObj._pagerObj.element.find(".e-pagerTextBox").attr("disabled","disabled"),this._pivotClientObj._pagerObj._unwireEvents()),t.isNullOrUndefined(i[2])||i.d[2].Key=="PageSettings"||(f=i.d[2].Key,f=="DataSet"?(this._dataSet=i.d[2].Value,t.isNullOrUndefined([3])||(this.model.customObject=i.d[3].Value)):this.model.customObject=i.d[2].Value)):!t.isNullOrUndefined(i)&&t.isNullOrUndefined(i.d)&&(i.SortColIndex!=r?(t.PivotAnalysis._valueSorting=JSON.parse(i.SortColIndex)[0],t.PivotAnalysis._sort=this.model.valueSortSettings.sortOrder):t.PivotAnalysis._valueSorting=null,i.PivotRecords!=r?(this.setJSONRecords(i.PivotRecords),this.setOlapReport(i.OlapReport),i.HeaderCounts!=r&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling)?(this._categPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Column/JSON.parse(i.PageSettings).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Row/JSON.parse(i.PageSettings).SeriesPageSize),this._categCurrentPage=JSON.parse(i.PageSettings).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.PageSettings).SeriesCurrentPage):i.HeaderCounts!=r&&this._pagerObj!=null&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r?this._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings)):i.HeaderCounts==r||t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._pagerObj==null||this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))):i.JsonRecords!=r&&this.model.enableJSONRendering==!0?(this.setJSONRecords(JSON.stringify(i.JsonRecords)),this.setOlapReport(JSON.stringify(i.PivotReport)),i.DataSet!=null&&(this._dataSet=i.DataSet)):i.JsonRecords!=r?(this.setJSONRecords(i.JsonRecords),this.setOlapReport(i.PivotReport),i.DataSet!=null&&(this._dataSet=i.DataSet)):i.JsonRecords==r&&(this.setJSONRecords(null),i.PivotReport&&this.setOlapReport(i.PivotReport),i.OlapReport&&this.setOlapReport(i.OlapReport)),i.isXMLLoad!=r&&(this.model._isXMLImport=i.isXMLLoad),i.customObject!=null&&i.customObject!=r&&(this.model.customObject=i.customObject)),t.isNullOrUndefined(this.getJSONRecords())&&!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enablePaging&&(c={CategoricalCurrentPage:1,CategoricalPageSize:1,SeriesCurrentPage:1,SeriesPageSize:1},l={Column:1,Row:1},this._pivotClientObj._pagerObj.initPagerProperties(l,c)),(this.model.enableVirtualScrolling||n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r)&&this.layout("nosummaries"),this.getOlapReport()!=r&&this.getOlapReport()!=""&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)try{t.isNullOrUndefined(JSON.parse(this.getOlapReport()).DataModel)||(this.model.analysisMode=JSON.parse(this.getOlapReport()).DataModel=="Olap"?t.Pivot.AnalysisMode.Olap:t.Pivot.AnalysisMode.Pivot);!t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PagerOptions)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.enablePaging||this.model.enableVirtualScrolling)&&(this._categPageCount=this.model.enablePaging?JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageCount:Math.ceil(JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageCount/JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageSize),this._seriesPageCount=this.model.enablePaging?JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageCount:Math.ceil(JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageCount/JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageSize),this.model.dataSource.pagerOptions.categoricalPageSize=JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageSize,this.model.dataSource.pagerOptions.seriesPageSize=JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageSize,this.model.dataSource.pagerOptions.categoricalCurrentPage=JSON.parse(this.getOlapReport()).PagerOptions.CategoricalCurrentPage,this.model.dataSource.pagerOptions.seriesCurrentPage=JSON.parse(this.getOlapReport()).PagerOptions.SeriesCurrentPage);this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._pagerObj!=null&&(e=this,a=setInterval(function(){clearInterval(a);var n={CategoricalCurrentPage:e.model.dataSource.pagerOptions.categoricalCurrentPage,CategoricalPageSize:e.model.dataSource.pagerOptions.categoricalPageSize,SeriesCurrentPage:e.model.dataSource.pagerOptions.seriesCurrentPage,SeriesPageSize:e.model.dataSource.pagerOptions.seriesPageSize},t={Column:e._categPageCount,Row:e._seriesPageCount};e._pagerObj.element.css("opacity","1");e._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled");e._pagerObj._unwireEvents();e._pagerObj._wireEvents();e._pagerObj.initPagerProperties(t,n)},10))}catch(w){}if(i.isXMLLoad!=r&&i.isXMLLoad&&this._reportModelUpdate(t.isNullOrUndefined(this.getOlapReport())?null:JSON.parse(this.getOlapReport())),this.model.enableGroupingBar==!0&&(u=JSON.parse(this.getOlapReport()),s=t.isNullOrUndefined(u.ItemsProperties)?[]:JSON.parse(u.ItemsProperties),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(v=u.PivotRows.concat(u.PivotColumns,u.PivotCalculations,u.Filters),y=n.grep(s,function(t){return n.grep(v,function(n){t.id==(n.FieldHeader||n.DimensionHeader)&&(t.id=n.FieldName||n.DimensionName)}),t}),this._pivotTableFields=y):this._pivotTableFields=s,this._createGroupingBar(u)),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(u=JSON.parse(this.getOlapReport()),o=0;o<u.PivotCalculations.length;o++)(u.PivotCalculations[o].CalculationType==8||u.PivotCalculations[o].CalculationType=="Formula")&&n.grep(this._calculatedField,function(n){return n.name==u.PivotCalculations[o].FieldName}).length==0&&this._calculatedField.push({name:u.PivotCalculations[o].FieldName,formula:u.PivotCalculations[o].Formula});this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"initialize",element:this.element,customObject:this.model.customObject});this.getJSONRecords()!=null&&this.getJSONRecords().length>0?this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&this.model.enableVirtualScrolling==!1&&n(".e-pivotpager")[0]==null?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON(this.getJSONRecords()):this.renderControlFromJSON("");h=n(this.element).parents(".e-pivotclient").length>0?n(this.element).parents(".e-pivotclient").data("ejPivotClient"):null;t.isNullOrUndefined(h)||(h._isTimeOut=!1);t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._waitingPopup==null?this._waitingPopup.hide():n("#"+this._pivotClientObj._id+"_maxView")[0]&&this._maxViewLoading?this._maxViewLoading.hide():this._pivotClientObj._waitingPopup.hide();t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style");this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._schemaData!=null&&this._schemaButtonCreate();p={action:"initialize",customObject:this.model.customObject,element:this.element};this._trigger("renderSuccess",p);t.isNullOrUndefined(i.Exception)||t.Pivot._createErrorDialog(i,"Exception",this);this.model.enableAdvancedFilter&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._removeCells(i)}catch(w){}},_hideGrandTotal:function(i){var p=i.find(".pivotGridFrozenTable"),w,b,a,e,s,h,nt,c,tt,it,l,ut,y,u;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(this.model.enableRowGrandTotal&&this.model.enableGrandTotal||((this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders)&&i.find(".valueCell tr:last,.rowhead tr:last").hide(),i.find("tbody").children().length>0&&(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?i.find("tr:last .gtot").parent().hide():i.find("tr:last .rgtot").parent().hide())),(i.find("tr:first th.summary").attr("data-p")!=r||i.find(".pivotGridFrozenTable tr:first td.summary").attr("data-p")!=r)&&(!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(w=[],w=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?p.find(".gtot[role^='columnheader']"):p.find(".cgtot[role^='columnheader']"):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?i.find("th.gtot[role^='columnheader']"):i.find("th.cgtot[role^='columnheader']"),b=0;b<w.length;b++)i.find('[data-p^="'+parseInt(n(w[b]).attr("data-p").split(",")[0])+',"]').hide(),i.find('[data-p^="'+parseInt(n(w[b]).attr("data-p").split(",")[0])+',"]').hide()}else if(a=!0,e=0,this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||this.model.analysisMode==t.Pivot.AnalysisMode.Olap){if((!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)&&(h=n(i).find("thead tr").length||n(i).find(".pivotGridFrozenTable tr").length,h>1||h==1&&n(i).find("th.summary[data-p$=',"+e+"']").length>0)){while(a)s=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(i).find("td.summary[data-p$=',"+e+"']"):n(i).find("th.summary[data-p$=',"+e+"']"),s.length&&(a=!1),e++;for(l=0;l<s.length;l++){var d=e,v=s[l],o=n(v).attr("data-p"),f=parseInt(o.split(",")[1])-1,g=n(v).attr("colspan"),et=n(i).find("thead tr").length+n(i).find("tbody tr").length;for(nt=0;nt<parseInt(g);nt++)n(i).find(" [data-p^='"+(parseInt(o.split(",")[0])+nt)+",']").css("display","none");for(c=0;c<h;c++)this.model.frozenHeaderSettings.enableFrozenHeaders?n(p).find("tr:eq("+c+") td").length==1&&(tt=n(p).find(" tr:eq("+c+") td").attr("colspan"),n(p).find(" tr:eq("+c+") td").attr("colspan",parseInt(tt)-parseInt(g))):n(i).find("thead tr:eq("+c+") th").length==1&&(tt=n(i).find("thead tr:eq("+c+") th").attr("colspan"),n(i).find("thead tr:eq("+c+") th").attr("colspan",parseInt(tt)-parseInt(g)));if(f>=0)for(y=n(i).find(" [data-p^='"+o.split(",")[0]+","+f+"']")[0];d>1;){if(t.isNullOrUndefined(y))for(f=parseInt(o.split(",")[1])-1;f>=0;f--){if(u=n(i).find("[data-p='"+o.split(",")[0]+","+f+"']")[0],t.isNullOrUndefined(u))for(k=parseInt(o.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(u)&&(u=n(i).find("[data-p='"+k+","+f+"']")[0]);!t.isNullOrUndefined(u)&&n(u).css("display")!="none"&&n(n(u).parents("tr")[0]).css("display")!="none"&&(n(u).hasClass("rowheader")||n(u).attr("role")=="rowheader"||n(u).hasClass("colheader")||n(u).attr("role")=="columnheader"||n(u).hasClass("value")||n(u).attr("role")=="gridcell")&&(y=u);set_spn=parseInt(n(u).attr("colspan"))-parseInt(g);n(u).attr("colspan",set_spn)}t.isNullOrUndefined(u)||d--}}}if(a=!0,e=0,s="",!this.model.enableRowGrandTotal||!this.model.enableGrandTotal){if(it=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,h=n(i).find("tbody tr").length,h>1||h==1&&n(i).find(it?"":"th[data-p^='"+e+",']")=="summary")for(h=n(i).find("tbody tr").length;a;)s=it?n(i).find("td.summary[data-p^='"+e+",']"):n(i).find("th.summary[data-p^='"+e+",']"),s.length&&(a=!1),e++;if(h>0)for(l=0;l<s.length;l++){var d=e,v=s[l],o=n(v).attr("data-p"),f=parseInt(o.split(",")[0])-1,ft=n(v).attr("rowspan"),rt=n(v).parent();for(ut=0;ut<v.rowSpan;ut++)n(rt).css("display","none"),it&&n(i).find(".pivotGridValueTable tr:eq("+n(rt).index()+")").css("display","none"),rt=n(rt).next();if(f>=0)for(y=n(i).find(" [data-p^='"+f+","+o.split(",")[1]+"']")[0];d>1;){if(t.isNullOrUndefined(y))for(f=parseInt(o.split(",")[0])-1;f>=0;f--){if(u=n(i).find("[data-p='"+f+","+o.split(",")[1]+"']")[0],t.isNullOrUndefined(u))for(k=parseInt(o.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(u)&&(u=n(i).find("[data-p='"+f+","+k+"']")[0]);!t.isNullOrUndefined(u)&&n(u).css("display")!="none"&&n(n(u).parents("tr")[0]).css("display")!="none"&&(n(u).hasClass("rowheader")||n(u).attr("role")=="rowheader"||n(u).hasClass("colheader")||n(u).attr("role")=="columnheader"||n(u).hasClass("value")||n(u).attr("role")=="gridcell")&&(y=u);set_spn=parseInt(n(u).attr("rowspan"))-parseInt(ft);n(u).attr("rowspan",set_spn)}t.isNullOrUndefined(u)||d--}}}}},_hideSubTotal:function(i,u,f){var y,c,p,nt,tt,a,o,k,v,s,w,g,b,l,e;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){var et={},ot=!1,st={},ht=!1,y=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.rows:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows:JSON.parse(this.getOlapReport()).PivotRows,c,p=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns:JSON.parse(this.getOlapReport()).PivotColumns,it=i[0].querySelectorAll("tbody th.rowheader"),rt=i[0].querySelectorAll("thead th, tbody td");for(o=0;o<y.length;o++)y[o].showSubTotal==!1&&(ot=!0);if(ot==!0)for(s=0;s<it.length;s++)et[n(it[s]).attr("data-p")]=it[s];for(o=0;o<p.length;o++)p[o].showSubTotal==!1&&(ht=!0);if(ht==!0)for(s=0;s<rt.length;s++)st[n(rt[s]).attr("data-p")]=rt[s]}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(y=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.rows:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows:JSON.parse(this.getOlapReport()).PivotRows,p=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns:JSON.parse(this.getOlapReport()).PivotColumns,!t.isNullOrUndefined(y))for(o=0;o<y.length;o++)if(y[o].showSubTotal==!1)if(nt=o.toString(),n(i).attr("role")=="row"&&n(i).parent().is("tbody")){if(n(i).find(".stot,.rstot").length==0||this._isSubTotalhidden&&n(i).find(".stot,.rstot").find(".e-expand").length>=1||n(i).find(".stot,.rstot").attr("data-p").split(",")[0]==nt&&u==1&&n(i).find(".stot,.rstot").find(".e-expand").length>=1)break;else if(n(i).find(".stot,.rstot").attr("data-p").split(",")[0]==nt){n(f).parent().attr("data-p").split(",")[0]==nt&&(this._isSubTotalhidden=!0);this._isSubTotalHide=!0;break}}else if(n(i).find("tbody").length>0&&(c=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?i.find('.summary.rstot[data-p^="'+o+',"]'):i.find('.summary.stot[data-p^="'+o+',"]'),c.length>0))for(tt=0;tt<c.length;tt++){var ut=n(c[tt]).closest("tr"),h=n(ut).find(".stot,.rstot").attr("data-p"),l=parseInt(h.split(",")[0])-1,lt=parseInt(n(ut).find(".stot,.rstot").attr("rowspan"));for(n(ut).css("display","none"),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders)&&n(i).find(".valueCell td[data-p$=',"+h.split(",")[1]+"']").closest("tr").css("display","none"),a=parseInt(h.split(",")[1]);l>=0;){for(e=null;t.isNullOrUndefined(e)&&a>=0;){if(e=et[l+","+a],!t.isNullOrUndefined(e)&&n(n(e).closest("tr")[0]).css("display")!="none"&&n(e).hasClass("rowheader")&&n(e).attr("role")=="rowheader"&&parseInt(n(e).attr("data-p").split(",")[0])<parseInt(h.split(",")[0])&&parseInt(n(e).attr("data-p").split(",")[1])+e.rowSpan+(n(e).find("span").attr("data-tag")!=r?parseInt(n(e).find("span").attr("data-tag")):0)>=parseInt(h.split(",")[1])+lt){e.rowSpan-=1;n(e).find("span").attr("data-tag",n(e).find("span").attr("data-tag")!=r?parseInt(n(e).find("span").attr("data-tag"))+1:1);break}a--}l--}}if(!t.isNullOrUndefined(p))for(o=0;o<p.length;o++)if(p[o].showSubTotal==!1)if(k=o.toString(),(n(i).hasClass("stot")||n(i).hasClass("cstot"))&&n(i).attr("role")=="columnheader"){if(this._isSubTotalhidden&&n(i).find(".stot,.cstot").find(".e-expand").length>=1||n(i).attr("data-p").split(",")[1]==k&&u==1&&n(i).find(".e-expand").length>=1)break;else if(n(i).attr("data-p").split(",")[1]==k){this._isSubTotalhidden=this._isSubTotalHide=!0;break}}else if(n(i).attr("role")=="row"&&(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?n(i).parent().is("tbody")||n(i).parent().is("thead"):n(i).parent().is("thead"))){if(n(i).find(".stot,.cstot").length==0||this._isSubTotalhidden&&n(i).find(".stot,.cstot").find(".e-expand").length>=1||n(i).find(".stot,.cstot").attr("data-p").split(",")[1]==k&&u==1&&n(i).find(".stot,.cstot").find(".e-expand").length>=1)break;else if(n(i).find(".stot,.cstot").attr("data-p").split(",")[1]==k){this._isSubTotalhidden=this._isSubTotalHide=!0;break}}else if((n(i).find("thead").length>0||n(i).find(".colhead").length>0)&&(c=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?i.find('td.summary.cstot[data-p$=",'+o+'"]'):i.find('th.summary.cstot[data-p$=",'+o+'"]'):this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders?i.find('td.summary.stot[data-p$=",'+o+'"]'):i.find('th.summary.stot[data-p$=",'+o+'"]'),c.length>0))for(v=c,s=0;s<v.length;s++){var at=n(v[s]),ct=n(i),h=n(v[s]).attr("data-p"),vt=n(v[s]).closest("tr")[0],ft=parseInt(h.split(",")[0]),lt=parseInt(n(v[s]).attr("rowspan")),d=parseInt(n(v[s]).attr("colspan")),a=parseInt(h.split(",")[1])-1;for(w=0;w<d;w++){for(g=n(vt).nextAll().find("[data-p^='"+(w+ft)+",']"),b=0;b<n(g).length;b++)n(g[b]).css("display","none");(n(g[b]).attr("data-hc")==r||parseInt(n(g[b]).attr("data-hc"))<1)&&(n(ct).find("[data-p^='"+(w+ft)+",']").css("display","none"),n(ct).find("[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(w+ft)+",']").attr("data-ch",1))}for(n(at).css("display","none"),l=parseInt(h.split(",")[0]);a>=0;){for(e=null;t.isNullOrUndefined(e)&&l>=0;){if(e=st[l+","+a],!t.isNullOrUndefined(e)&&n(n(e).closest("tr")[0]).css("display")!="none"&&n(e).hasClass("colheader")&&n(e).attr("role")=="columnheader"&&parseInt(n(e).attr("data-p").split(",")[1])<parseInt(h.split(",")[1])&&parseInt(n(e).attr("data-p").split(",")[0])<=parseInt(h.split(",")[0])&&parseInt(n(e).attr("data-p").split(",")[0])+e.colSpan+(n(e).find("span").attr("data-tag")!=r?parseInt(n(e).find("span").attr("data-tag")):0)>=parseInt(h.split(",")[0])+d){e.colSpan-=d;n(e).find("span").attr("data-tag",n(e).find("span").attr("data-tag")!=r?parseInt(n(e).find("span").attr("data-tag"))+d:d);break}l--}a--}}}},_filterReport:function(n){for(var r,i=0;i<n.Filters.length;i++)if(n.PivotColumns.length>=1)for(r=0;r<n.PivotColumns.length;r++)n.Filters.length==0||t.isNullOrUndefined(n.Filters[i])||n.Filters[i].Tag!=n.PivotColumns[r].FieldName||(n.Filters.splice(i,1),i=-1);for(i=0;i<n.Filters.length;i++)if(n.PivotRows.length>=1)for(r=0;r<n.PivotRows.length;r++)n.Filters.length==0||t.isNullOrUndefined(n.Filters[i])||n.Filters[i].Tag!=n.PivotRows[r].FieldName||(n.Filters.splice(i,1),i=-1);for(i=0;i<n.Filters.length;i++)if(n.PivotCalculations.length>=1)for(r=0;r<n.PivotCalculations.length;r++)n.Filters.length==0||t.isNullOrUndefined(n.Filters[i])||n.Filters[i].Tag!=n.PivotCalculations[r].FieldName||(n.Filters.splice(i,1),i=-1);return n},_createGroupingBar:function(n){var i;this._pivotFilter=this._getLocalizedLabels("DragFieldHere");this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(n=this._filterReport(n),i=this._createPivotButtons(this._pivotFilter!=null&&n.Filters.length>1&&n.Filters[0].Tag==n.Filters[1].Tag?n.Filters.slice(1):n.Filters,"filter")):i=this._createPivotButtons(this._pivotFilter!=null&&n.filters.length>0?n.filters:"","filter");this._pivotFilter=i;this._pivotRow=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.PivotRows:n.rows,"row");this._pivotColumn=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.PivotColumns:n.columns,"column");this._pivotCalculation=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.PivotCalculations:n.values,"values");this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&n.values.length>0&&n.values[0].measures&&(n.values[0].axis=="columns"&&n.values[0].measures.length>0?this._pivotColumn=this._pivotColumn+this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.PivotColumns:[{fieldName:"Measures",fieldCaption:this._getLocalizedLabels("Measures")}],"column"):n.values[0].axis=="rows"&&n.values[0].measures.length>0&&(this._pivotRow=this._pivotRow+this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?n.PivotColumns:[{fieldName:"Measures",fieldCaption:this._getLocalizedLabels("Measures")}],"row")))},_contextOpen:function(n){t.Pivot._contextMenuOpen(n,this)},_pivotContextClick:function(i){var e,o;if(i.text!=this._getLocalizedLabels("CalculatedField"))if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var r=i.text==this._getLocalizedLabels("AddToColumn")?"column":i.text==this._getLocalizedLabels("AddToRow")?"row":i.text==this._getLocalizedLabels("AddToValues")?"value":i.text==this._getLocalizedLabels("AddToFilter")?"filter":"",u=n(this._selectedMember).attr("data-fieldName"),s=n(this._selectedMember).text(),f={droppedFieldName:u,droppedFieldCaption:s,droppedClass:r,droppedPosition:"",isMeasuresDropped:u.toLocaleLowerCase().indexOf("measures")==0};this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&r!="values"&&(this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1||n.isCalculatedField==!0&&n.formula.indexOf(f.droppedFieldName)==-1}));this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this));t.Pivot.addReportItem(this.model.dataSource,f);this.refreshControl();t.isNullOrUndefined(this._schemaData)||this._schemaData._refreshPivotButtons()}else e=i.text==this._getLocalizedLabels("AddToColumn")?this.element.find(".columns"):i.text==this._getLocalizedLabels("AddToRow")?this.element.find(".e-grpRow").length==0?this.element.find(".emptyRows").addClass("e-grpRow"):this.element.find(".e-grpRow"):i.text==this._getLocalizedLabels("AddToValues")?this.element.find(".values"):i.text==this._getLocalizedLabels("AddToFilter")?this.element.find(".e-drag"):"",o={element:this._selectedMember,target:e,cancel:!1},this._pvtBtnDropped(o);else this._createCalculatedField()},_getAdvancedFilterInfo:function(i){var r=[],u;return this._excelFilterInfo.length>0&&(u=i,r=n.grep(this._excelFilterInfo,function(n){try{if(n.levelUniqueName.replace(/]/g,"").replace(/\[/g,"").indexOf(i)>-1&&!t.isNullOrUndefined(n.operator))return n}catch(r){}})),r},_createPivotButtons:function(i,u){var c=this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?!0:!1,s,l,d,p,f,v,w,o,b,y,g;if(!t.isNullOrUndefined(i)){var a="",s=u=="column"?"Columns":u=="row"?"Rows":u=="filter"?"Slicers":"Values",h="";if(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)for(s=u=="column"?"Columns":u=="row"?"Rows":u=="filter"?"filters":"values",s=="values"&&c&&(i=n.map(i,function(n){return n.measures})),f=0;f<i.length;f++){h=i[f].fieldCaption;var nt=c?"":t.PivotAnalysis.getMembers(i[f].fieldName),k=t.Pivot.getReportItemByFieldName(i[f].fieldName,this.model.dataSource),e=i[f].filterItems!=null&&i[f].filterItems.values.length>0||!t.isNullOrUndefined(i[f].advancedFilter)&&i[f].advancedFilter.length>0&&k.item&&k.axis!="filters"?"filtered":"";u=="filter"&&(e=="filtered"?h=t.Pivot._getFilterState(c,nt,i[f],this):c?(t.olap._mdxParser.getAllMember(this.model.dataSource,i[f].fieldName,this),h=this._allMember):h=this._getLocalizedLabels("All"));l=c?"":i[f].sortOrder==t.PivotAnalysis.SortOrder.Descending?"descending":"";d=(i[f].fieldName||i[f]).replace(/[\(\)\[\]{}'"]/g,"").replace(/[\W]/g,"_");a+=t.buildTag("span.e-pivotButton",t.buildTag("button.e-pvtBtn#pivotButton_"+d,(this.model.showUniqueNameOnPivotButton?u!="values"?i[f].fieldName.replace(/\[/g,"").replace(/\]/g,""):i[f].fieldCaption==r?i[f].fieldName:i[f].fieldCaption||i[f]:i[f].fieldCaption==r?i[f].fieldName:i[f].fieldCaption||i[f])+(u=="filter"?" ("+h+")":""),{},{"data-fieldName":i[f].fieldName,"data-fieldCaption":i[f].fieldCaption,"data-axis":s})[0].outerHTML+(c&&(i[f].fieldName.toLowerCase()=="measures"||!t.isNullOrUndefined(i[f].isNamedSet)&&!i[f].isNamedSet)?"":t.buildTag("span.filter e-icon "+e).attr("role","button").attr("aria-label","filter")[0].outerHTML)+(c?" ":t.buildTag("span.e-sorting e-icon "+l).attr("role","button").attr("aria-label","sort").attr("aria-expanded","false")[0].outerHTML)+t.buildTag("span.e-removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("data-tag",s+":"+i[f].fieldName||i[f])[0].outerHTML}else for(s=="Values"&&u=="values"&&(p=this.element.find(".e-pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").length>0?this.element.find(".e-pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").parent()[0].className.split(" ")[0]:"e-schemaColumn",this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(s=p=="e-schemaColumn"||p=="columns"?"Columns":"Rows")),f=0;f<i.length;f++){for(v=this._ascdes.split("##"),w=0,l="",e="",o=0;o<v.length;o++)(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&v[o]==i[f].Tag||this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&v[o]==i[f])&&(w=1);if(w==1&&(l="descending"),!t.isNullOrUndefined(this._tempFilterData))for(o=0;o<this._tempFilterData.length;o++)for(b in this._tempFilterData[o])this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?b==(i[f].FieldName||i[f].DimensionName)&&this._tempFilterData[o][i[f].FieldName||i[f].DimensionName]!=""&&(e="filtered"):this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&b==(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?i[f].Tag:i[f])&&this._tempFilterData[o][i[f].Tag].indexOf("FILTERED")!=0&&(e="filtered");this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(i[f].FieldHeader=i[f].FieldHeader=="Measures"?this._getLocalizedLabels("Measures"):i[f].FieldHeader,e=u!="filter"&&this.model.enableAdvancedFilter&&this._getAdvancedFilterInfo(i[f].Tag).length>0?"filtered":e,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(y=t.isNullOrUndefined(this._tempFilterData)?[]:n.map(this._tempFilterData,function(n){return n[i[f].DimensionName]}),u=="filter"&&(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.enableAdvancedFilter&&this._getAdvancedFilterInfo(i[f].Tag).length>0&&(e="filtered"),h=y.length>0&&e&&this._fieldMembers[i[f].DimensionName]?this._fieldMembers[i[f].DimensionName].length-y.length==1?this._fieldMembers[i[f].DimensionName].filter(function(n){if(y.indexOf(n)==-1)return n}):this._getLocalizedLabels("MultipleItems"):this._getLocalizedLabels("All"))):u=="filter"&&(h=(this._fieldSelectedMembers[i[f].Tag]=="All"?i[f].AllMember:this._fieldSelectedMembers[i[f].Tag])||i[f].AllMember),g=i[f].FieldHeader=="Measures"||i[f].Tag=="Measures"||i[f].Tag.indexOf("::NAMEDSET")>-1?"":t.buildTag("span.filter e-icon "+(i[f].Filtered?"filtered":e)).attr("role","button").attr("aria-label","filter")[0].outerHTML,a+=t.buildTag("span.e-pivotButton",t.buildTag("span.e-dropIndicator")[0].outerHTML+t.buildTag("button.e-pvtBtn#pivotButton"+i[f].FieldHeader||i[f].FieldName||i[f].Name||i[f].DimensionHeader||i[f].DimensionName,(this.model.showUniqueNameOnPivotButton?u!="values"?i[f].Tag:i[f].FieldHeader||i[f].FieldName||i[f].Name||i[f].DimensionHeader||i[f].DimensionName:i[f].FieldHeader||i[f].FieldName||i[f].Name||i[f].DimensionHeader||i[f].DimensionName)+(u=="filter"?" ("+h+")":""),{},this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?{"data-fieldName":i[f].FieldName||i[f].DimensionName||i[f].FieldHeader||i[f].DimensionHeader,"data-fieldCaption":i[f].FieldHeader||i[f].DimensionHeader||i[f].FieldName||i[f].DimensionName}:{"data-fieldCaption":i[f].FieldHeader})[0].outerHTML+g+t.buildTag("span.e-sorting e-icon "+l).attr("role","button").attr("aria-label","sort")[0].outerHTML+t.buildTag("span.e-removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("data-tag",s+":"+i[f].Tag)[0].outerHTML):a+=t.buildTag("span.e-pivotButton",t.buildTag("span.e-dropIndicator")[0].outerHTML+t.buildTag("button.e-pvtBtn#pivotButton"+i[f],i[f])[0].outerHTML+t.buildTag("span.filter e-icon "+e).attr("role","button").attr("aria-label","filter")[0].outerHTML+t.buildTag("span.e-sorting e-icon "+l).attr("role","button").attr("aria-label","sort").attr("aria-expanded","false")[0].outerHTML+t.buildTag("span.e-removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("data-tag",s+":"+i[f])[0].outerHTML}return a}},_createFields:function(){var p,f,w,r,b,a,s,i,o,c,v,y,l,e,u,k,d;if(this.element.find(".groupingBarPivot").remove(),this.model.enableVirtualScrolling&&this.element.find(".virtualScrollGrid").length>0?this.element.find(".virtualScrollGrid").prepend(t.buildTag("div#groupingBarPivot.groupingBarPivot")[0].outerHTML):this.element.prepend(t.buildTag("div#groupingBarPivot.groupingBarPivot")[0].outerHTML),this.element.find(".groupingBarPivot").prepend(t.buildTag("div.valueColumn",t.buildTag("span.values").attr("aria-label","values")[0].outerHTML+t.buildTag("span.columns").attr("aria-label","column")[0].outerHTML,{width:"100%"})),this.element.find(".groupingBarPivot").prepend(t.buildTag("div.e-drag",t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("DragFieldHere"),{width:"100%"}).attr("aria-label","filter")[0].outerHTML),this._pivotFilter!=""&&this._pivotFilter!=null&&this.element.find(".e-drag").text("").attr("aria-label","filter"),this.element.find(".e-drag").append(this._pivotFilter),this.element.find(".values").append(this._pivotCalculation),this.element.find(".columns").append(this._pivotColumn),this.element.find(".values .e-pivotButton").length==0&&this.element.find(".values").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("ValueArea")),this.element.find(".columns .e-pivotButton").length==0&&this.element.find(".columns").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("ColumnArea")),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.element.find(".e-rows").length==0&&!t.isNullOrUndefined(this.getJSONRecords())&&this.getJSONRecords().length>0&&this.getJSONRecords()[0].CSS=="colheader"?(this.element.find(".e-pivotGridTable thead tr:first").prepend(t.buildTag("th.e-grpRow",t.buildTag("div.e-rows",t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("RowArea"))[0].outerHTML,{},{rowspan:this.element.find("thead tr").length})[0].outerHTML),this.element.find(".e-pivotGridTable tbody tr:first").prepend(t.buildTag("td.rowheader",this._getLocalizedLabels("Total"))[0].outerHTML)):this.element.find(".e-rows .e-pivotButton").length==0&&(this.element.find(".e-rows").text("").children("span").remove(),this.element.find(".e-rows").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("RowArea"))),(this.element.find(".rowheader").length==0&&this.element.find(".colheader").length==0&&this.element.find(".values .e-pivotButton").length==0||this.element.find(".e-pivotGridTable th").length==0)&&(p=t.buildTag("div.emptyRows",t.buildTag("span.e-rows",this._pivotRow!=""?this._pivotRow:this._getLocalizedLabels("RowArea"),{width:"5px"})[0].outerHTML,{width:140})[0].outerHTML,this.element.find(".e-rows").length==0?this.element.find(".groupingBarPivot").append(p):"",this.model.enableDeferUpdate&&this._pivotRow!=""&&(this.element.find(".e-rows").text(""),this.element.find(".e-rows").append(this._pivotRow)),(this.getJSONRecords()==null||this.getJSONRecords().length==0)&&this.element.find(".groupingBarPivot").addClass("emptyPivotGrid"),this.element.find(".emptyRows,.e-rows").ejDroppable({})),this.element.find(".values").find(".filter").remove(),this.element.find(".values").find(".e-sorting").remove(),this.element.find(".e-drag").find(".e-sorting").remove(),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.element.find(".e-pivotButton").find(".e-sorting").remove(),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this.element.find(".e-rows").width(this.element.find(".pivotGridRowTable").width()),this._setGroupingBarFrozenRowBtnWidth()),this.element.find(".e-pivotButton .e-pvtBtn").ejButton({size:"normal",type:t.ButtonType.Button}).ejDraggable({handle:"button",clone:!0,cursorAt:{left:-5,top:-5},dragStart:t.proxy(function(){this._isDragging=!0},this),dragStop:t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this._clientPvtBtnDropped:this._pvtBtnDropped,this),helper:t.proxy(function(t){return n(t.element).parent().addClass("dragHover"),n(t.element).addClass("dragHover"),t.sender.target.className.indexOf("e-btn")>-1?n(t.sender.target).clone().addClass("dragClone").appendTo(this.element):!1},this)}),t.browserInfo().name.indexOf("moz")>-1&&(this.element.find(".columns .e-btn, .e-rows .e-btn").addClass("e-pvtBtnIndent"),this.element.find(".columns .e-sorting,.e-rows .e-sorting").addClass("e-pvtBtnSort")),this.element.find(".e-drag, .values, .columns, .e-grpRow, .e-rows").ejDroppable({}),this.element.find(".e-pivotGridTable").find("thead th:eq(1), tbody td.value:eq(0)").length>0)this.element.find(".groupingBarPivot").width(this.element.find(".e-pivotGridTable").width());else if(this.element.find(".columns .e-pivotButton").length==0||this.element.find(".values .e-pivotButton").length==0&&this.element.find(".columns .e-pivotButton").length==1)this.element.find(".groupingBarPivot").width(300);else{for(f=0,u=0;u<n(this.element.find(".columns .e-pivotButton")).length;u++)f=Math.max(n(this.element.find(".columns .e-pivotButton")[u]).width(),f);f<140?this.element.find(".columns").css("min-width",f+"px"):"";w=f*n(this.element.find(".columns .e-pivotButton")).length+this.element.find(".values").width()+10;this.element.find(".groupingBarPivot").width(w)}for((this.element.find(".e-rows").width()>140||this.model.enableDeferUpdate&&this.element.find(".e-rows").width()<this.element.find(".e-grpRow").width()&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)&&(this.enableDeferUpdate?this.element.find(".e-rows").width(this.element.find(".colheader").length==0?this.element.find(".e-grpRow").width()-140:this.element.find(".e-grpRow").width()):this.model.isResponsive||this.element.find(".e-rows").width(this.model.enableDeferUpdate?this.element.find(".e-grpRow").width()-8:this.element.find(".e-grpRow").width())),(this.element.find(".e-pivotGridTable thead").length>0||this.model.enableDeferUpdate&&this.element.find(".e-pivotGridTable thead").length==0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this.model.isResponsive&&this.element.find(".values .e-pivotButton").length==0&&this.element.find(".columns .e-pivotButton").length==0?this.element.find(".values").width(140):this.element.find(".values").width(this.element.find(".e-grpRow").length>0?this.model.enableDeferUpdate&&this.element.find(".colheader").length==0?this.element.find(".e-grpRow").width():this.element.find(".e-grpRow").width()+3:140),this.model.enableDeferUpdate&&this.element.find(".colheader").length==0&&this.element.find(".e-pivotGridTable .rowheader").length!=0&&(e=this.element.find(".groupingBarPivot").width()-this.element.find(".values").width(),e<140&&this.element.find(".groupingBarPivot").width(this.element.find(".groupingBarPivot").width()+140)),this.element.find(".e-pivotGridTable").find("thead th:eq(1), tbody td.value:eq(0)").length>0||this.model.enableDeferUpdate&&this.element.find(".columns .e-pivotButton").length==0||this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?(r=this.element.find(".e-pivotGridTable").width()-this.element.find(".values").width()-4,this.element.find(".e-pivotGridTable").find("thead th:eq(2), tbody td:eq(1)").length==0?(this.element.find(".columns").css("min-width",r>=30&&this.element.find(".e-pivotGridTable .colheader").length==0&&this.element.find(".columns .e-pivotButton").length==0?140:r).width(r>=30&&this.element.find(".e-pivotGridTable .colheader").length==0&&this.element.find(".columns .e-pivotButton").length==0?82:r),this.element.find(".values").height(r>=30&&this.element.find(".e-pivotGridTable .colheader").length==0&&this.element.find(".columns .e-pivotButton").length==0?this.element.find(".columns").height():this.element.find(".values").height()),(this.element.find(".columns .e-pivotButton").length==0||this.model.enableDeferUpdate&&this.element.find(".e-pivotGridTable .colheader").length==0)&&(this.element.find(".columns .e-pivotButton").length==0&&(r=this.element.find(".groupingBarPivot").width()-this.element.find(".values").width()-5,this.element.find(".columns").width(r),r<140&&(n(".groupingBarPivot .values .e-pivotButton").length==1||n(".groupingBarPivot .values .e-pivotButton").length==0&&this.model.enableDeferUpdate)&&this.element.find(".columns").css("min-width",r+"px")),this.element.find(".columns").addClass("e-widthSetter"))):r<140?n(".columns .e-pivotButton").length<2?this.element.find(".columns").css("min-width",r).addClass("e-widthSetter"):(this.element.find(".columns").width(r).css("min-width",r),this.element.find(".values").height(this.element.find(".columns").height())):this.element.find(".columns").width(r)):this.element.find(".e-pivotGridTable").find("thead th:eq(1)").length!=0||this.model.enableDeferUpdate||(this.element.find(".columns .e-pivotButton").length==0&&this.element.find(".columns").addClass("e-widthSetter"),b=this.element.find(".columns .e-pivotButton").length<1?1:this.element.find(".columns .e-pivotButton").length,this.element.find(".columns").css("min-width",(this.element.find(".groupingBarPivot").width()-this.element.find(".values").width()-7)/b))),this.model.dataSource.data!=null&&this.model.url==""&&(a=0,n(".columns .e-pivotButton").each(function(){a+=parseInt(n(this).width()+10)}),n(".valueColumn").height()>30&&this.element.find(".values button").length==0&&this.element.find(".columns").width()<a&&(s=this.element.find(".columns .e-pivotButton").length,i=(this.element.find(".valueColumn").width()-this.element.find(".values").width())/(s==0?1:s)-70,this.element.find(".columns .e-pvtBtn").width(i).css({"text-overflow":"ellipsis"}))),this.element.find(".columns").height()>47?(i=this.model.isResponsive?this.element.find(".columns").width()/this.element.find(".columns .e-pivotButton").length-5:this.element.find(".columns").width()/2-60,this.element.find(".columns .e-pvtBtn").width(i).css({"text-overflow":"ellipsis"})):this.element.find(".columns .e-pivotButton").width()>this.element.find(".columns").width()&&(i=this.element.find(".columns").width()-(this.element.find(".columns .e-pivotButton").width()-this.element.find(".columns .e-pivotButton .e-pvtBtn").width()+40),this.element.find(".columns .e-pvtBtn").width(i).css({"text-overflow":"ellipsis"})),this.element.find(".e-drag").height()>47?(i=this.element.find(".groupingBarPivot").width()/4-35,this.element.find(".e-drag .e-pvtBtn").width(i).css({"text-overflow":"ellipsis"})):this.element.find(".e-drag .e-pivotButton").width()>this.element.find(".e-drag").width()&&(i=this.element.find(".e-drag").width()-(this.element.find(".e-drag .e-pivotButton").width()-this.element.find(".e-drag .e-pivotButton .e-pvtBtn").width()+40),this.element.find(".e-drag .e-pvtBtn").width(i).css({"text-overflow":"ellipsis"})),this.element.find(".values").height()>47?(i=this.model.isResponsive?this.element.find(".values").width()/this.element.find(".values .e-pivotButton").length-5:this.element.find(".values").width()/2-40,this.element.find(".values .e-pvtBtn").width(i).css({"text-overflow":"ellipsis"})):(this.element.find(".values .e-pivotButton").width()>this.element.find(".values").width()||!this.model.enableDeferUpdate&&this.element.find(".e-pivotGridTable").find("thead th:eq(1), tbody td.value:eq(0)").length==0&&this.element.find(".values .e-pivotButton").length>0)&&(i=this.element.find(".values").width()-(this.element.find(".values .e-pivotButton").width()-this.element.find(".values .e-pivotButton .e-pvtBtn").width()+20),this.element.find(".values .e-pvtBtn").width(i).css({"text-overflow":"ellipsis"})),o=0,u=0;u<this.element.find(".e-rows .e-pivotButton").length;u++)o=o+this.element.find(".e-rows .e-pivotButton:eq("+u+")").width();if(o-20>this.element.find(".e-rows").width()||this.element.find(".colfreeze").length-20>0&&o>this.element.find(".colfreeze").width()||this.element.find(".e-rows").parent(".emptyRows").length>0&&this.element.find(".e-rows").parent(".emptyRows").width()<o){var i=0,h=this.element.find(".colfreeze").length>0?".colfreeze":".e-rows",g=this.element.find(h).parent().height(),nt=this.element.find(h+" .e-pivotButton").eq(0).height(),s=this.element.find(h+" .e-pivotButton").length;i=g/(nt*s)>=1?"auto":this.element.find(h).width()/2-40;this.element.find(".e-rows .e-pvtBtn").width(i).css({"text-overflow":"ellipsis"})}if(this.model.layout=="normal"&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&((this.element.find(".values .e-pvtBtn").length==0||this.element.find(".columns .e-pvtBtn").length==0)&&(this.element.find(".e-rows").width()>this.element.find(".values").width()||this.element.find(".e-rows").width()>this.element.find(".columns").width())&&this.element.find(".emptyRows").width()==140||this.model.enableDeferUpdate&&this.element.find(".values .e-pvtBtn").length<=1&&this.element.find(".columns .e-pvtBtn").length<=1)&&(c=this.element.find(".e-rows").width(),v=this.element.find(".values").width()+this.element.find(".columns").width(),this.element.find(".values").css({"min-width":c,width:c}),y=this.element.find(".values").width(),this.element.find(".columns").css({"min-width":v-y,width:v-y}),this.element.find(".columns .e-pvtBtn,.values .e-pvtBtn").width("auto").css({"text-overflow":"ellipsis"}),this.element.find(".emptyRows").width(c)),this.model.enableDeferUpdate&&this.element.find(".columns .e-pivotButton").length!=0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){for(l=0,e=0,u=0;this.element.find(".columns .e-pivotButton").length>u;u++)l=this.element.find(".columns .e-pivotButton:eq("+u+")").width()+l+7;if(e=this.element.find(".e-pivotGridFrozenTable").width(),l>=e){var tt=this.element.find(".e-pivotGridTable .colheader").length>0?1:0,r=tt==0?140:e,i=r/(this.model.enableDeferUpdate?this.element.find(".columns .e-pivotButton").length:3)-15;this.model.enableDeferUpdate?this.element.find(".columns .e-pvtBtn").width(30).css({"text-overflow":"ellipsis"}):this.element.find(".columns .e-pvtBtn").width(i).css({"text-overflow":"ellipsis"})}}(this.element.find(".values").height()>this.element.find(".columns").height()||this.element.find(".columns").height()>this.element.find(".values").height())&&(this.element.find(".values").height()>this.element.find(".columns").height()?this.element.find(".columns").height(this.element.find(".values").height()):this.element.find(".values").height(this.element.find(".columns").height()));this.element.find(".colheader, .rowheader, .value").addClass("e-droppable");this.element.find(".summary").removeClass("e-droppable");this.model.enableGroupingBar&&(k=this.element.find(".e-pvtBtn"),d=t.buildTag("ul.pivotTree#pivotTree",(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?t.buildTag("li.e-calculatedFieldMenuItem",t.buildTag("a.menuItem",this._getLocalizedLabels("CalculatedField"))[0].outerHTML)[0].outerHTML:" ")+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToFilter"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToRow"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToColumn"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToValues"))[0].outerHTML)[0].outerHTML)[0].outerHTML,n(this.element).append(d),n("#pivotTree").ejMenu({menuType:t.MenuType.ContextMenu,enableRTL:this.model.enableRTL,openOnClick:!1,contextMenuTarget:k,click:t.proxy(this._pivotContextClick,this),beforeOpen:t.proxy(this._contextOpen,this),close:t.proxy(t.Pivot.closePreventPanel,this)}))},_clientPvtBtnDropped:function(i){var h,c,s,l,e;t.PivotAnalysis._valueSorting=null;this._isDragging=!1;t.Pivot.openPreventPanel(this);i.element.removeClass("dragHover").css("background-color","inherit");i.element.parent().removeClass("dragHover");this.element.find(".dragClone").remove();this.element.find(".e-dropIndicator").removeClass("e-dropIndicatorHover");this.element.find(".dragClone,.e-dropIndicator").remove();var r=n(i.target).hasClass("columns")||n(i.target).parents(".columns").length>0?"column":n(i.target).hasClass("e-grpRow")||n(i.target).parents(".e-grpRow").length>0||n(i.target).hasClass("e-rows")?"row":n(i.target).hasClass("values")||n(i.target).parents(".values").length>0?"value":n(i.target).hasClass("e-drag")||n(i.target).parents(".e-drag").length>0?"filter":"",o=i.element.text(),u=n(i.element).attr("data-fieldName");if(r!=""&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(u.toLowerCase().indexOf("[measures]")>=0&&r!="value"||u==this._getLocalizedLabels("Measures")&&r!="row"&&r!="column"||u.toLowerCase().indexOf("[measures]")<0&&r=="value")){t.Pivot._createErrorDialog(this._getLocalizedLabels("GroupingBarAlertMsg"),this._getLocalizedLabels("Warning"),this);return}if(r==""&&this._schemaData)if(o.toLowerCase()=="measures"&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(h=0;this.model.dataSource.values[0].measures.length>0;)selectedTreeNode=this._schemaData._tableTreeObj.element.find("li[data-tag='"+this.model.dataSource.values[0].measures[h].fieldName+"']"),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);else this._schemaData&&(c=this._schemaData._tableTreeObj.element.find("li:contains('"+o+"')"),this._schemaData._tableTreeObj.uncheckNode(c));if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&r!=""&&r!="value"&&n.grep(this._calculatedField,function(n){return n.name==u}).length>0){t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this);this.element.find(".dragClone,.e-dropIndicator").remove();return}var f=r==""?"":this._setSplitBtnTargetPos(i.event,r,"drop"),a=r==""?"":this._setSplitBtnTargetPos(i,r,"original"),v=n(i.element).hasClass("columns")||n(i.element).parents(".columns").length>0?"column":n(i.element).hasClass("e-grpRow")||n(i.element).parents(".e-grpRow").length>0||n(i.element).hasClass("e-rows")?"row":n(i.element).hasClass("values")||n(i.element).parents(".values").length>0?"value":n(i.element).hasClass("e-drag")||n(i.element).parents(".e-drag").length>0?"filter":"";r!=""&&r.toLowerCase()==v.toLowerCase()&&f>a&&(f=f-1);s={droppedFieldName:u,droppedFieldCaption:o,droppedClass:r,droppedPosition:f,isMeasuresDropped:u.toLocaleLowerCase().indexOf("measures")==0};this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&r!="value"?this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1||n.isCalculatedField==!0&&n.formula.indexOf(s.droppedFieldName)==-1}):this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this._fieldMembers={},this._fieldSelectedMembers={},this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this));t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();t.Pivot.addReportItem(this.model.dataSource,s);this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(l=n.grep(this.model.dataSource.values,function(n){return n.isCalculatedField==!0}),this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1}),n.merge(this.model.dataSource.values,l));(this.model.enableAdvancedFilter||this.model.dataSource.enableAdvancedFilter)&&r=="filter"&&(e=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item,e&&e.advancedFilter&&(e.advancedFilter=[]));this.refreshControl();t.isNullOrUndefined(this._schemaData)||(t.Pivot.getReportItemByFieldName(u,this.model.dataSource).item==null&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._schemaData._tableTreeObj.element.find("li[data-tag='"+u+"']").removeClass("filter").find(".treeDrop,.filter").remove(),this._schemaData._refreshPivotButtons())},_pvtBtnDropped:function(i){var w,r,c,u,a,v,g,l,y,b,p,nt,tt;t.Pivot.openPreventPanel(this);n(i.element).parent().removeClass("dragHover");n(i.element).removeClass("dragHover");this._isUpdateRequired=!0;w="";this._isDragging=!1;this.element.find(".e-dropIndicator").removeClass("e-dropIndicatorHover");var h=null,e="",o="",s,k=!1,d=!1;if(r=t.isNullOrUndefined(i.target.className)?n(i.target).hasClass("columns")?"columns":n(i.target).hasClass("e-grpRow")?"e-rows":n(i.target).hasClass("values")?"values":n(i.target).hasClass("e-drag")?"e-drag":"":i.target.className.indexOf("e-droppable")>=0?i.target.className.split(" ")[0]:"",r=r=="e-grpRow"?"e-rows":r,k=n(i.element).parent().find(".filtered").length>0?!0:!1,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(n(i.target).hasClass("e-pvtBtn")&&this.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&(r=n(i.target).attr("data-axis").toLowerCase()),s=t.isNullOrUndefined(i.element.attr("data-fieldCaption"))?i.element.text():i.element.attr("data-fieldCaption"),d=n(i.element).parent().find(".descending").length>0?!0:!1,r==""&&(i.target.tagName=="BUTTON"||i.target.tagName=="SPAN")&&(r=i.target.parentNode.parentElement.className.split(" ")[0]),c=0;c<this._pivotTableFields.length;c++)this._pivotTableFields[c].name==s&&(this._pivotTableFields[c].isSelected=!0,o=this._pivotTableFields[c]);else t.isNullOrUndefined(i.target.className)?(h=n(i.target),e=n(i.target).hasClass("columns")?"Categorical":n(i.target).hasClass("e-grpRow")?"Series":n(i.target).hasClass("e-drag")?"Slicer":"",r=n(i.target).hasClass("columns")?"columns":n(i.target).hasClass("e-grpRow")?"e-rows":n(i.target).hasClass("values")?"values":n(i.target).hasClass("e-drag")?"e-drag":""):(h=i.target.className.indexOf("e-pvtBtn")>-1?n(i.target).parents(".e-droppable")[0]:i.target.className.indexOf("e-droppable")?i.target:i.target[0].tagName.toLowerCase()=="td"?i.target.children(":last")[0]:i.target,e=h.className.split(" ")[0]=="columns"?"Categorical":h.className.split(" ")[0]=="e-rows"||h.className.split(" ")[0]=="e-grpRow"?"Series":h.className.split(" ")[0]=="filters"?"Slicer":"",r=h.className.split(" ")[0]),e==""&&(i.element.parent().attr("data-tag").indexOf("[Measures]")>-1||i.element.parent().attr("data-tag").indexOf("KPI")>-1)&&(e=this.element.find(".e-schemaRow .e-pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").length>0?"Series":"Categorical"),t.isNullOrUndefined(i.element.parent())||(w=i.element.parents(".values").length>0?"values":i.element.parents(".e-drag").length>0?"e-drag":i.element.parents(".e-grpRow").length>0?"e-rows":i.element.parents(".columns").length>0?"columns":""),o=n(i.element.parent()[0]).attr("data-tag"),r=r=="e-grpRow"?"e-rows":r,e=e=="e-grpRow"?"Series":e,s=i.element.text();if(this.element.find(".dragClone").remove(),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&((o.split(":")[1].toLocaleUpperCase()=="MEASURES"||o.split(":")[1].toLocaleUpperCase()=="KPI")&&(r!="columns"||r!="e-rows")&&(r=="e-drag"||r=="values")||o.toUpperCase().indexOf("[MEASURES]")>-1&&r!="values"&&(r=="e-rows"||r=="columns"||r=="e-drag")||(o.toUpperCase().indexOf("[MEASURES]")==-1||o.toUpperCase().indexOf("KPI")==-1)&&r=="values"&&r!=w))return t.Pivot._createErrorDialog(this._getLocalizedLabels("GroupingBarAlertMsg"),this._getLocalizedLabels("Error"),this),this.element.find(".dragClone,.e-dropIndicator").remove(),i.element.parent().removeAttr("style"),i.element.css("background-color","inherit"),!1;if(r=="e-rows"||r=="columns"||r=="values"||r=="e-drag"){if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&r!="values"&&(n.grep(this._calculatedField,function(n){return n.name==s}).length>0||n.grep(JSON.parse(this.getOlapReport()).PivotCalculations,function(n){return n.FieldHeader==s&&n.CalculationType==8}).length>0)){t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this);i.element.parent().removeAttr("style");i.element.css("background-color","inherit");return}u=this._setSplitBtnTargetPos(i,r,"drop");a=this._setSplitBtnTargetPos(i,r,"original");r=="e-drag"&&this.element.find(".e-drag").text("").attr("aria-label","filter");try{v=JSON.parse(this.getOlapReport()).Report}catch(rt){v=this.getOlapReport()}if(n(i.element.parent()).remove(),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)y=i.element.parents(".e-pivotButton").attr("data-tag").split(":")[0],this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),n.isNumeric(u)&&r==y.toLowerCase()&&u>a&&(u=u-1),r=r=="e-rows"?"schemaRow":r=="columns"?"schemaColumn":r=="e-drag"?"schemaFilter":r=="values"?"schemaValue":"",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(this.model.enableAdvancedFilter&&r=="schemaFilter"&&!t.isNullOrUndefined(this._curFilteredText)&&this._curFilteredText.indexOf(":")>-1&&(b=this._getAdvancedFilterInfo(this._curFilteredText.split(":")[1]),b.length>0&&this._removeFilterTag(b[0].levelUniqueName)),e=r=="schemaFilter"?"Slicer":e,g=JSON.parse(this._olapReport).CurrentCube+"--"+o+"--"+e+"--"+u,this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),p=JSON.stringify(this.model.customObject),l=JSON.stringify({action:"nodeDropped",dropType:"SplitButton",nodeInfo:g,currentReport:v,gridLayout:this.model.layout,customObject:p}),this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,l.replace("nodeDropped","nodeDroppedDeferUpdate"),this._pvtBtnDroppedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,l,this._pvtBtnDroppedSuccess)):(this._calculatedField.length>0&&r!="schemaValue"&&this._schemaData!=null&&this._calculatedFieldNodeRemove(o),this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),p=JSON.stringify(this.model.customObject),nt=t.Pivot._getFilterParams(r,this._tempFilterData,s),l=JSON.stringify({action:"nodeDropped",dropAxis:r+"::"+u,headerTag:JSON.stringify(o),sortedHeaders:this._ascdes,filterParams:nt,currentReport:v,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:p}),tt=this._renderControlSuccess,this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,l.replace("nodeDropped","nodeDroppedDeferUpdate"),this._pvtBtnDroppedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,l,this._pvtBtnDroppedSuccess));else{if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&r!="values"&&n.grep(this._calculatedField,function(n){return n.name==s}).length>0){t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this);this.model.editCellsInfo={};this._populatePivotGrid();return}var f=this._getDroppedItem(s),it={fieldName:f[0].fieldName,fieldCaption:f[0].fieldCaption},y=i.element.parents(".e-pivotButton").attr("data-tag").split(":")[0];this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&f.length>0&&r=="e-drag"&&(f[0].advancedFilter=[]);n.isNumeric(u)?r==y.toLowerCase()&&u>a?r=="e-rows"?this.model.dataSource.rows.splice(u-1,0,f[0]):r=="columns"?this.model.dataSource.columns.splice(u-1,0,f[0]):r=="values"?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.splice(u-1,0,f[0]):this.model.dataSource.values.splice(u,0,f[0]):this.model.dataSource.filters.splice(u,0,f[0]):r=="e-rows"?this.model.dataSource.rows.splice(u,0,f[0]):r=="columns"?this.model.dataSource.columns.splice(u,0,f[0]):r=="values"?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.splice(u,0,f[0]):this.model.dataSource.values.splice(u,0,f[0]):this.model.dataSource.filters.splice(u,0,f[0]):r=="e-rows"?this.model.dataSource.rows.push(f[0]):r=="columns"?this.model.dataSource.columns.push(f[0]):r=="values"?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.push(f[0]):this.model.dataSource.values.push(f[0]):this.model.dataSource.filters.push(f[0]);this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&r!="values"&&(this._schemaData!=null&&this._calcFieldNodeDrop(f[0]),this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return t.isNullOrUndefined(n.isCalculatedField)||n.isCalculatedField==!1||n.isCalculatedField==!0&&n.formula.indexOf(f[0].fieldName)==-1}));this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this));this._schemaData!=null&&(r==y&&u>a&&(u=u-1),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._schemaData.element.find("button[data-fieldName='"+s+"']").remove():this._schemaData.element.find("#pivotButton"+s).parent().remove(),this._schemaData._createPivotButton(it,r=="e-rows"?"row":r=="columns"?"column":r=="e-drag"?"filter":r=="values"?"value":"",k,d,u));this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.getJSONData({action:"pvtBtnDropped"},this.model.dataSource,this)):(this.model.editCellsInfo={},this._populatePivotGrid())}}else this._removePvtBtn(i);t.isNullOrUndefined(this._schemaData)||this._schemaData._setPivotBtnWidth()},_getDroppedItem1:function(i){var f=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?!0:!1,r=n.grep(this.model.dataSource.columns,function(n){return n.fieldName==i}),u;return r.length>0?this.model.dataSource.columns=n.grep(this.model.dataSource.columns,function(n){return n.fieldName!=i}):(r=n.grep(this.model.dataSource.rows,function(n){return n.fieldName==i}),r.length>0?this.model.dataSource.rows=n.grep(this.model.dataSource.rows,function(n){return n.fieldName!=i}):(u=this.model.dataSource.values,this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(u=this.model.dataSource.values[0].measures),r=n.grep(u,function(n){return n.fieldName==i}),r.length>0?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures=n.grep(u,function(n){return n.fieldName!=i}):this.model.dataSource.values=n.grep(u,function(n){return n.fieldName!=i}):(r=n.grep(this.model.dataSource.filters,function(n){return n.fieldName==i}),r.length>0&&(this.model.dataSource.filters=n.grep(this.model.dataSource.filters,function(n){return n.fieldName!=i}))))),r},_clearCollapsedItems:function(t,i,u){return t=="rowheader"?u.rows=n.map(u.rows,function(t){return t.drilledItems!=r&&t.drilledItems.length&&(t.drilledItems=n.map(t.drilledItems,function(n){if(n.join("").indexOf(i.repItms.replace(/&/g,"&amp;"))<0)return[n]})),t}):t=="colheader"&&(u.columns=n.map(u.columns,function(t){return t.drilledItems!=r&&t.drilledItems.length&&(t.drilledItems=n.map(t.drilledItems,function(n){if(n.join("").indexOf(i.repItms.replace(/&/g,"&amp;"))<0)return[n]})),t})),u},_setSplitBtnTargetPos:function(t,i,r){var e="",f,o,u;for(o=r=="drop"?n(t.target).parents(".e-pivotButton"):n(t.element).parents(".e-pivotButton"),i=i=="column"?"columns":i=="row"?"e-rows":i=="filter"?"e-drag":i=="value"?"values":i,f=this.element.find("."+i).children(".e-pivotButton"),u=0;u<f.length;u++)n(f[u]).attr("data-tag")==n(o).attr("data-tag")&&(e=u);return e},_pvtBtnDroppedSuccess:function(n){!t.isNullOrUndefined(n[0])&&n.length>0?n[2]!=null&&n[2]!=r&&(this.model.customObject=n[2].Value):!t.isNullOrUndefined(n.d)&&n.d.length>0?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):t.isNullOrUndefined(n)||t.isNullOrUndefined(n.OlapReport)||n!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject});this.model.enableDeferUpdate?this._deferUpdateSuccess(n):this._renderControlSuccess(n);this._schemaData!=null&&this._schemaData._refreshPivotButtons()},_deferUpdateSuccess:function(i){if(t.isNullOrUndefined(i.PivotReport)&&t.isNullOrUndefined(i.OlapReport)?(this.setOlapReport(i.d[0].Value),n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&this.model.pivotControl._pagerObj.initPagerProperties(JSON.parse(i.d[2].Value),JSON.parse(i.d[1].Value))):(t.isNullOrUndefined(i.PivotReport)?this.setOlapReport(i.OlapReport):this.setOlapReport(i.PivotReport),i.HeaderCounts!=r&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&this.model.pivotControl._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))),this.model.enableGroupingBar){var u=JSON.parse(this.getOlapReport());this._pivotTableFields=JSON.parse(u.ItemsProperties);this._createGroupingBar(u);this.element.find(".e-grpRow .e-rows").text("");this.element.find(".e-grpRow .e-rows").children().remove();this.element.find(".e-grpRow .e-rows").append(this._pivotRow);this._createFields(null,n("#"+this._id).find(".e-pivotGridTable").width(),n("#"+this._id).find(".e-pivotGridTable th").outerWidth())}this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._schemaData!=null&&this._schemaButtonCreate();t.Pivot.closePreventPanel(this)},_clientRemovePvtBtn:function(i){t.PivotAnalysis._valueSorting=null;t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();var r=n(n(i.target).siblings()[0]).attr("data-fieldName");delete this._fieldMembers[r.toLowerCase()];delete this._fieldSelectedMembers[r.toLowerCase()];this._calculatedField.length>0&&n.grep(this.model.dataSource.values,function(n){return n.fieldName==r}).length>0?this.model.dataSource.values=n.grep(this.model.dataSource.values,function(n){return(n.isCalculatedField==null||n.isCalculatedField==!1||n.formula.indexOf(r)==-1)&&n.fieldName!=r}):t.Pivot.removeReportItem(this.model.dataSource,r,r.toLocaleLowerCase().indexOf("measures")==0);this.refreshControl();t.isNullOrUndefined(this._schemaData)||(this._schemaData._tableTreeObj.element.find("li[data-tag='"+r+"']").removeClass("filter").find(".treeDrop,.filter").remove(),this._schemaData.refreshControl())},_removePvtBtn:function(i){var y,f,a,r,h,p,v,s,u,b,o,l,c;if(this._isUpdateRequired=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){if(i.type=="click"){var f=n(n(i.target).siblings()[0]).attr("data-fieldName"),e="",s="";y=n(n(i.target).siblings()[0]).text()}else{var f=i.element.attr("data-fieldName"),e="",s="";y=i.element.text()}for(u=0;u<this.element.find(".e-pivotButton").length;u++)s=n(this.element.find(".e-pivotButton")[u]).find("button").attr("data-fieldName"),s==f&&(e=n(this.element.find(".e-pivotButton")[u]));if(n(e).remove(),this._schemaData!=null){if(l=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._schemaData._tableTreeObj.element.find("li [data-tag='"+f+"']"):this._schemaData._tableTreeObj.element.find("li[id='"+f+"']"),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.length==0&&f.toLowerCase()=="measures"){for(this._schemaData.element.find("div[data-tag='"+e.attr("data-tag")+"']").remove(),u=0;u<this.model.dataSource.values[0].measures.length;u++)this._schemaData._nodeCheck=!0,selectedTreeNode=this._schemaData._tableTreeObj.element.find("li[data-tag='"+this.model.dataSource.values[0].measures[u].fieldName+"']"),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode),this.element.find("div[data-tag='values:"+this.model.dataSource.values[0].measures[u].fieldName+"']").remove(),this._schemaData.element.find("div[data-tag='values:"+this.model.dataSource.values[0].measures[u].fieldName+"']").remove();this.model.dataSource.values[0].measures=[];t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();this.getJSONData({action:"removeBtn"},this.model.dataSource,this)}this._schemaData._tableTreeObj.uncheckNode(l)}else this.model.dataSource.columns=n.grep(this.model.dataSource.columns,function(n){return n.fieldName!=f}),this.model.dataSource.rows=n.grep(this.model.dataSource.rows,function(n){return n.fieldName!=f}),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?e.attr("data-tag").split(":")[1].toLowerCase()=="measures"?this.model.dataSource.values[0].measures=[]:this._getItemPosition(this.model.dataSource.values[0].measures,e.attr("data-tag").split(":")[1]).length>0&&this.model.dataSource.values[0].measures.splice(this._getItemPosition(this.model.dataSource.values[0].measures,e.attr("data-tag").split(":")[1])[0],1):this.model.dataSource.values=this._calculatedField.length>0?n.grep(this.model.dataSource.values,function(n){return(n.isCalculatedField==null||n.isCalculatedField==!1||n.formula.indexOf(f)==-1)&&n.fieldName!=f}):n.grep(this.model.dataSource.values,function(n){return n.fieldName!=f}),this.model.dataSource.filters=n.grep(this.model.dataSource.filters,function(n){return n.fieldName!=f}),this.model.analysisMode!=t.Pivot.AnalysisMode.Olap&&this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode?(this.model.editCellsInfo={},this._populatePivotGrid()):(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"removeButton"},this),this.getJSONData({action:"removeButton"},this.model.dataSource,this))}else{if(i.type=="click"?(f=n(n(i.target).siblings("button")).attr("data-fieldCaption"),r=n(n(i.target).siblings("button")).parent().attr("data-tag")):(f=i.element.attr("data-fieldCaption"),r=i.element.parent().attr("data-tag")),!t.isNullOrUndefined(this._tempFilterData)&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(h=0;h<this._tempFilterData.length;h++)for(p in this._tempFilterData[h])p==r.split(":")[1]&&this._tempFilterData[h][r.split(":")[1]]!=""&&this._tempFilterData.splice(h,1);delete this._fieldMembers[r.split(":")[r.split(":").length-1]];delete this._fieldSelectedMembers[r.split(":")[r.split(":").length-1]];var w="",e="",r="",s="",a="";for(e=this.element.find(".e-pivotButton:contains("+f+")"),u=0;u<this._pivotTableFields.length;u++)this._pivotTableFields[u].name==f&&(this._pivotTableFields[u].isSelected=!1,r=this._pivotTableFields[u]);try{a=JSON.parse(this.getOlapReport()).Report}catch(k){a=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)if(r=n(e).attr("data-tag"),v=n(e).parents().hasClass("values")&&r.indexOf("[Measures]")==-1,s=r.indexOf("[Measures]")>-1||r.indexOf("KPI")>-1||v||r.indexOf("[")>-1?r.split(":")[1]:this._getNodeUniqueName(r),s=="[Measures]"||s=="KPI"||v){if(r=v?r+":KPI":r,e.remove(),!t.isNullOrUndefined(this._schemaData))for(this._schemaData.element.find(".e-pivotButton:contains("+f+")").remove(),u=0;u<this._schemaData.model.pivotCalculations.length&&(r.indexOf("Measures")>-1||r.indexOf("KPI")>-1||n(e).parents().hasClass("values")&&r.indexOf("[Measures]")==-1);u++)s=this._schemaData.model.pivotCalculations[u].Tag,this._schemaData._isMeasureBtnRemove=!0,selectedTreeNode=this._getNodeByUniqueName(s),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);this._waitingPopup.show();this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"removeButton",element:this.element,customObject:this.model.customObject});c=JSON.stringify(this.model.customObject);o=JSON.stringify({action:"removeButton",headerInfo:r,currentReport:a,gridLayout:this.model.layout,customObject:c});!t.isNullOrUndefined(this._schemaData)&&(r.indexOf("[Measures]")<0||r.indexOf("KPI")<0)&&(r.indexOf("Measures")>=0||r.indexOf("KPI")>=0)&&this._schemaData.element.find(".e-schemaValue .e-pivotButton").remove();this.model.enableDeferUpdate&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(this._removeButtonDeferUpdate=!0,this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,o.replace("removeButton","removeButtonDeferUpdate"),this._pvtBtnDroppedSuccess),this.element.find(".schemaNoClick").removeClass("freeze"),this._waitingPopup.hide()):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,o,this._pvtBtnDroppedSuccess)}else if(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)){if(c=JSON.stringify(this.model.customObject),o=JSON.stringify({action:"removeButton",headerInfo:r,currentReport:a,gridLayout:this.model.layout,customObject:c}),t.isNullOrUndefined(r))return!1;this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,o.replace("removeButton","removeButtonDeferUpdate"),this._pvtBtnDroppedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,o,this._pvtBtnDroppedSuccess)}else selectedTreeNode=this._getNodeByUniqueName(s),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);else w="schemaRow::"+r.id+"::FILTERED",b=this._droppedClass!=""?this._droppedClass:r.pivotType=="PivotItem"?"e-schemaRow":"e-schemaValue",this._droppedClass="",n(e).remove(),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this._schemaData!=null?(l=this._schemaData._tableTreeObj.element.find("li:contains('"+f+"')"),this._schemaData._tableTreeObj.uncheckNode(l)):(this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeStateModified",element:this.element,customObject:this.model.customObject}),c=JSON.stringify(this.model.customObject),o=JSON.stringify({action:"nodeStateModified",headerTag:JSON.stringify(r),dropAxis:b+"::",sortedHeaders:this._ascdes,filterParams:w,currentReport:a,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:c}),this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeStateModified,o.replace("nodeStateModified","nodeStateModifiedDeferUpdate"),this._nodeStateModifiedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeStateModified,o,this._nodeStateModifiedSuccess))}},_getNodeUniqueName:function(n){for(var t="",i=0;i<n.split(":")[1].split(".").length;i++)t!=""&&(t+="."),t+="["+n.split(":")[1].split(".")[i]+"]";return t},_getNodeByUniqueName:function(t){for(var r=null,i=0;i<n(this._schemaData._tableTreeObj.element.find("li")).length;i++)n(this._schemaData._tableTreeObj.element.find("li")[i]).attr("data-tag").toLowerCase()==t.toLowerCase()&&(r=n(this._schemaData._tableTreeObj.element.find("li")[i]));return r},_nodeStateModifiedSuccess:function(n){n[0]!=r?n[2]!=null&&n[2]!=r&&(this.model.customObject=n[2].Value):n.d!=r?n.d[2]!=null&&n.d[2]!=r&&(this.model.customObject=n.d[2].Value):n.customObject!=null&&n.customObject!=r&&(this.model.customObject=n.customObject);this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"nodeStateModified",element:this.element,customObject:this.model.customObject});this.model.enableDeferUpdate?this._deferUpdateSuccess(n):this._renderControlSuccess(n)},_drillDownSuccess:function(i){if(i[0]!=r)this.setJSONRecords(i[0].Value),this.setOlapReport(i[1].Value),t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.currentReport=JSON.parse(i[1].Value).Report,i[2].Value!=r&&i[2].Value!="undefined"&&(this._pivotClientObj.reports=i[2].Value)),i[3]!=null&&i[3]!=r&&i[3].Key=="PageSettings"&&(this.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i[4].Value).Column/JSON.parse(i[3].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i[4].Value).Row/JSON.parse(i[3].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i[3].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i[3].Value).SeriesPageSize):this._pagerObj!=null&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r?this._pagerObj.initPagerProperties(JSON.parse(i[4].Value),JSON.parse(i[3].Value)):t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._pagerObj==null||this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i[4].Value),JSON.parse(i[3].Value)),i[5]!=null&&i[5]!=r&&(this.model.customObject=i[5].Value)),i[3]!=null&&i[3]!=r&&i[3].Key!="PageSettings"&&(this.model.customObject=i[3].Value);else if(i.d!=r)this.setJSONRecords(i.d[0].Value),this.setOlapReport(i.d[1].Value),t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.currentReport=JSON.parse(i.d[1].Value).Report,i.d[2].Value!=r&&i.d[2].Value!="undefined"&&(this._pivotClientObj.reports=i.d[2].Value),this._updatePageSettings(i.d,this._pivotClientObj)),i.d[3]!=null&&i.d[3]!=r&&i.d[3].Key=="PageSettings"&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.d[4].Value).Column/JSON.parse(i.d[3].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.d[4].Value).Row/JSON.parse(i.d[3].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i.d[3].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.d[3].Value).SeriesCurrentPage):this._pagerObj!=null&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r?this._pagerObj.initPagerProperties(JSON.parse(i.d[4].Value),JSON.parse(i.d[3].Value)):t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._pagerObj==null||this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i.d[4].Value),JSON.parse(i.d[3].Value)),i.d[5]!=null&&i.d[5]!=r&&(this.model.customObject=i.d[5].Value)),i.d[3]!=null&&i.d[3]!=r&&i.d[3].Key!="PageSettings"&&(this.model.customObject=i.d[3].Value);else{if(t.isNullOrUndefined(i.PivotRecords))return t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._waitingPopup==null?t.isNullOrUndefined(this._pivotClientObj)?t.isNullOrUndefined(this._pivotClientObj)&&(this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.hide()):(this._pivotClientObj._isTimeOut=!1,this._pivotClientObj._waitingPopup.hide()):(this._pivotClientObj._isTimeOut=!1,this._pivotClientObj._waitingPopup.hide()),!1;this.setJSONRecords(i.PivotRecords);this.setOlapReport(i.OlapReport);t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.currentReport=JSON.parse(i.OlapReport).Report,i.ClientReports!=r&&i.ClientReports!="undefined"&&(this._pivotClientObj.reports=i.ClientReports),i.PageSettings!=r&&i.PageSettings!=null&&this._pivotClientObj._pagerObj!=null&&this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings)));i.PageSettings!=r&&i.PageSettings!=null&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Column/JSON.parse(i.PageSettings).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Row/JSON.parse(i.PageSettings).SeriesPageSize),this._categCurrentPage=JSON.parse(i.PageSettings).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.PageSettings).SeriesCurrentPage):this._pagerObj&&n(".e-pivotpager")[0]!=null&&n(".e-pivotpager")[0]!=r&&this._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings)));i.customObject!=null&&i.customObject!=r&&(this.model.customObject=i.customObject)}this.model.afterServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"drillDown",element:this.element,customObject:this.model.customObject});this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&this.model.enableVirtualScrolling==!1&&n(".e-pivotpager")[0]==null?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON(this.getJSONRecords());try{this.model.currentReport=JSON.parse(this.getOlapReport()).Report}catch(f){this.model.currentReport=this.getOlapReport()}t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("gridDrillSuccess",this.element);this._trigger("drillSuccess",this.element);t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._waitingPopup==null?t.isNullOrUndefined(this._pivotClientObj)?t.isNullOrUndefined(this._pivotClientObj)&&(this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.hide()):((!this._pivotClientObj||this._pivotClientObj._pivotGrid._startDrilldown||this._pivotClientObj._pivotChart._startDrilldown)&&this._pivotClientObj.model.displaySettings.mode!="gridOnly"||(this._pivotClientObj._isTimeOut=!1),this._pivotClientObj._waitingPopup.hide()):n("#"+this._pivotClientObj._id+"_maxView")[0]&&this._maxViewLoading?(this._maxViewLoading.hide(),this._pivotClientObj._waitingPopup.hide()):this._pivotClientObj.model.displaySettings.mode=="gridOnly"&&this._pivotClientObj._waitingPopup.hide();t.isNullOrUndefined(this._pivotClientObj)?this._waitingPopup.hide():(this._pivotClientObj._isTimeOut=!1,this._pivotClientObj._pivotGrid._startDrilldown=!1);var u={action:this._drillAction,customObject:this.model.customObject,element:this.element};this._trigger("renderSuccess",u)},saveReport:function(n,i,r){var u,f,e;i.toLowerCase()=="local"?this._trigger("saveReport",{report:this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource:this.getOlapReport()}):(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(f=JSON.stringify(this.model.dataSource),u="clientMode"):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(f=JSON.parse(this.getOlapReport()).Report,u="serverMode"),this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"saveReport",element:this.element,customObject:this.model.customObject}),e=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",r+"/"+this.model.serviceMethodSettings.saveReport,JSON.stringify({reportName:n,clientReports:f,operationalMode:u,customObject:e})))},loadReport:function(n,i,r){var e,f,o,u;if(this._waitingPopup.show(),i.toLowerCase()=="local")if(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)this._trigger("loadReport",{targetControl:this,dataModel:this.model.analysisMode}),this.refreshPivotGrid();else{this._trigger("loadReport",{targetControl:this,dataModel:this.model.analysisMode});try{o=JSON.parse(this.getOlapReport()).Report}catch(s){o=this.getOlapReport()}this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"loadReport",element:this.element,customObject:this.model.customObject});u=JSON.stringify(this.model.customObject);e=JSON.stringify({action:"loadReport",gridLayout:this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.layout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:n,operationalMode:"serverMode",clientReports:o,customObject:u});this.doAjaxPost("POST",r+"/"+this.model.serviceMethodSettings.loadReport,e,this._loadReportSuccess)}else this.model.beforeServiceInvoke!=null&&this._trigger("beforeServiceInvoke",{action:"loadReport",element:this.element,customObject:this.model.customObject}),u=JSON.stringify(this.model.customObject),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(f="clientMode",this.doAjaxPost("POST",r+"/"+this.model.serviceMethodSettings.loadReport,JSON.stringify({action:"loadReport",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:n,operationalMode:f,customObject:u}),this._loadReportSuccess)):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(f="serverMode",e=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?JSON.stringify({action:"loadReport",reportName:n,gridLayout:this.model.layout,enablePivotFieldList:this.model.enablePivotFieldList,operationalMode:f,customObject:u}):JSON.stringify({action:"loadReport",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:n,operationalMode:f,customObject:u}),this.doAjaxPost("POST",r+"/"+this.model.serviceMethodSettings.loadReport,e,this._loadReportSuccess))},_loadReportSuccess:function(n){this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(n.d!=r&&n.d.length>0?this.setOlapReport(JSON.parse(n.d[0].Value)):this.setOlapReport(JSON.parse(n.report)),this.model.dataSource=this.getOlapReport(),this.refreshPivotGrid(),this._unWireEvents(),this._wireEvents()):this._renderControlSuccess(n);!t.isNullOrUndefined(this._schemaData)&&this.model.enablePivotFieldList&&this._schemaData._load()},doAjaxPost:function(i,u,f,e,o,s){var c,l,a,h,v,y;t.isNullOrUndefined(f.XMLA)&&JSON.parse(f).action!="cellEditing"&&(this.model.editCellsInfo={});h=!0;v=this.model.enableXHRCredentials||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableXHRCredentials;f.XMLA==r?(c="application/json; charset=utf-8",l="json",a=n.proxy(e,this),h=t.browserInfo().name=="msie"&&t.browserInfo().version<=9||JSON.parse(f).action=="export"?!1:!0):(c="text/xml",l="xml",f=f.XMLA,a=n.proxy(e,t.olap.base,s),h=t.browserInfo().name=="msie"&&t.browserInfo().version<=9?!1:!t.isNullOrUndefined(s)&&s.action!="loadFieldElements"?!0:!1);y={type:i,url:u,contentType:c,async:h,dataType:l,data:f,success:a,xhrFields:{withCredentials:v},complete:t.proxy(function(i){if(n.proxy(i,this),this.model!=null){var r={action:!t.isNullOrUndefined(s)&&!t.isNullOrUndefined(s.action)?s.action:JSON.parse(f).action,customObject:this.model.customObject,element:this.element};this._trigger("renderComplete",r)}},this),error:t.proxy(function(n){typeof this._waitingPopup!="undefined"&&this._waitingPopup!=null&&this._waitingPopup.hide();t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._waitingPopup==null||this._pivotClientObj._waitingPopup.hide();var i={action:this._drillAction!=""?this._drillAction:"initialize",customObject:this.model.customObject,element:this.element,Message:n};this._trigger("renderFailure",i);this.renderControlFromJSON("");this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&t.Pivot._createErrorDialog(n.statusText,this._getLocalizedLabels("Error"),this);n.statusText},this)};v||delete y.xhrFields;n.ajax(y)},doPostBack:function(t,i){var r=n("<form>").attr({action:t,method:"POST",name:"export"}),f=function(t,i){var u=n('<input type="hidden" title="params">').attr({id:t,name:t,value:i}).appendTo(r)};for(var u in i)f(u,i[u]);r.appendTo(document.body).submit().remove()},_import:function(n){if(window.FormData&&this._isObject(n)){var t,i=new FormData;for(t in n)t!="async"&&i.append(t,n[t]);return i}return n},_isObject:function(n){return typeof n!="object"?!1:Object.prototype.toString.call(n)==="[object Object]"},refreshPagedPivotGrid:function(n,i){var r;if(this._isUpdateRequired=!0,t.isNullOrUndefined(this._pivotClientObj)&&(this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.show()),n=n.indexOf("categ")!=-1?"categorical":"series",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(this._isNavigation=!0,n=="categorical"?this.model.dataSource.pagerOptions.categoricalCurrentPage=parseInt(i):this.model.dataSource.pagerOptions.seriesCurrentPage=parseInt(i),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){try{r=JSON.parse(this.getOlapReport()).Report}catch(u){r=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"paging",axis:n,pageNo:i,drillHeaders:JSON.stringify(this._drillHeaders),currentReport:r,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),this._renderControlSuccess)}else this._refPaging();return!1}if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)n=="categorical"?this._categCurrentPage=parseInt(i):this._seriesCurrentPage=parseInt(i),t.olap.base.getJSONData({action:"navPaging"},this.model.dataSource,this);else{try{r=JSON.parse(this.getOlapReport()).Report}catch(u){r=this.getOlapReport()}this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"pagingDeferUpdate",pagingInfo:n+":"+i,currentReport:r,layout:this.layout(),customObject:JSON.stringify(this.model.customObject)}),this._deferUpdateSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"paging",pagingInfo:n+":"+i,currentReport:r,layout:this.layout(),customObject:JSON.stringify(this.model.customObject)}),this._renderControlSuccess)}},_refPaging:function(){t.PivotAnalysis._controlObj=this;t.PivotAnalysis._colKeysCalcValues=n.extend(!0,[],this._colKeysCalcValues);t.PivotAnalysis._rowKeysCalcValues=n.extend(!0,[],this._rowKeysCalcValues);t.PivotAnalysis._tableKeysCalcValues=n.extend(!0,[],this._tableKeysCalcValues);var i=t.PivotAnalysis._fillEngine(this.model);this.setJSONRecords(JSON.stringify(i.json));this.model.enableGroupingBar&&this._createGroupingBar(this.model.dataSource);this.renderControlFromJSON(i.json)},excelLikeLayout:function(i){var nt,v,g,rt,k,d,a,l,s,h,u,e,c;for(this._excelRowCount=0,u=0;u<i.length;u++)if(parseInt(i[u].Index.split(",")[0])==0)this._excelRowCount++;else break;this._rowCount=this._excelRowCount;var r=jQuery.extend(!0,[],i),f=[],w=[],o=null,y=0;if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(nt=n(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this._pivotClientObj.getOlapReport():this.getOlapReport()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.dataSource.rows.length==0&&this.model.dataSource.data!=null||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&nt!==""&&JSON.parse(nt).PivotRows.length==0)){this._excelLikeJSONRecords=null;this._isExporting||this.renderControlFromJSON();this._excelRowCount=0;return}if(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&r!=null&&r!=""){for(v=null,s=r[0].CSS!="colheader"?r[0].ColSpan*this._excelRowCount:0;s<r.length;s++){if(r[s].Info.toLowerCase().indexOf("[measure")>-1&&(v=parseInt(r[s].Index.split(",")[1])),r[s].CSS.indexOf("value")>-1)break;g=parseInt(r[s].Index.split(",")[1])}for(v!=null&&v!=g&&v!=0&&this._columnExcelLikeLayout(r,v,g),rt=r.length/this._excelRowCount,k=0;k<rt&&k<r.length;k++)for(d=0;d<=g&&d<r.length;d++)if(u=k*this._excelRowCount+d,r[u].CSS=="colheader"&&r[u].Span!="Block"&&(r[u].Info.toLowerCase().indexOf("[measure")==-1||r[u].Info.toLowerCase().indexOf("[measure")>-1&&v!=null&&v==0)&&r[u].ColSpan>1){for(e=u;e<u+r[u].RowSpan;e++){for(c=e+this._excelRowCount;c<e+r[u].ColSpan*this._excelRowCount;c=c+this._excelRowCount)r[c].Span="Block";e!=u&&(r[e].Span="Block")}if(a=u+(r[u].RowSpan-1)+(r[u].ColSpan-1)*this._excelRowCount+1,l=null,r[a].CSS.indexOf("summary")>-1&&r[a].Value==this._getLocalizedLabels("Total")&&r[a-this._excelRowCount].CSS.indexOf("summary")==-1)l=a;else if(r[a].CSS.indexOf("summary")>-1&&r[a-this._excelRowCount].CSS.indexOf("e-summary")>-1)for(e=a-this._excelRowCount;e>=0&&e<r.length;e=e-this._excelRowCount)if(r[e].ColSpan>1||r[e-this._excelRowCount].CSS.indexOf("e-summary")==-1&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){l=e;break}l!=null&&(r[l].ColSpan=this.model.operationalMode!=t.PivotGrid.OperationalMode.ClientMode?r[l].ColSpan:parseInt(r[a].Index.split(",")[0])-parseInt(r[l].Index.split(",")[0])+1,r[u].ColSpan=r[u].ColSpan-r[l].ColSpan,r[u+r[u].ColSpan*this._excelRowCount]=n.extend(!0,{},r[l]),r[u+r[u].ColSpan*this._excelRowCount].RowSpan=r[l].RowSpan+r[u].RowSpan,r[u+r[u].ColSpan*this._excelRowCount].Value=r[u].Value+" Total")}}if(r!=null&&r!=""&&r[0].CSS!="colheader"&&!(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)){if(r[0].Index=="0,0"&&r[0].CSS!="colheader")for(y=r[0].ColSpan,r[0].RowSpan==0&&(r[0].RowSpan=1),e=0;e<r[0].RowSpan&&e<r.length;e++)f.push(r[e]),r[e].Level=1,r[e].Span="Block";for(s=r[0].RowSpan;s<r.length&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.dataSource.rows.length>0;s=s+this._excelRowCount)if(r[s].Info.toLowerCase().indexOf("[measure")>-1){o=parseInt(r[s].Index.split(",")[0]);break}for(u=0;u<r.length&&u<this._excelRowCount;u++)if(r[u].CSS=="rowheader"&&parseInt(r[u].Index.split(",")[0])==0&&r[u].Span!="Block"){for(r[u].Level=1,r[u+this._excelRowCount]!=null&&r[u+this._excelRowCount].CSS.indexOf("value")==-1&&(r[u].itemIndex=r[u+r[u].RowSpan-(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?1:0)].Index),f.push(r[u]),o!=null&&o==0&&r[u].Info.toLowerCase().indexOf("[measure")>-1&&w.push(r[u]),e=u+1;e<u+r[u].RowSpan;e++)(r[e].Info.toLowerCase().indexOf("[measure")==-1||o!=null&&o!=y-1)&&(r[e].Span="Block");this._rowExcelLikeLayout(u,r,f,2,o,w,y)}else(r[u].CSS=="summary rgtot"||r[u].CSS=="summary gtot"||r[u].CSS=="summary calc gtot"||r[u].CSS=="colheader"&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||(r[u].CSS=="summary"&&r[u].Value.indexOf(this._getLocalizedLabels("Total"))>-1||r[u].CSS=="summary row")&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot)&&parseInt(r[u].Index.split(",")[0])==0&&(o!=null&&o==y-1&&(r[u].Value+=" "+r[u+this._excelRowCount*parseInt(r[u].ColSpan)].Value),r[u].Value=r[u].Value==this._getLocalizedLabels("Total")?this._getLocalizedLabels("GrandTotal"):r[u].Value,f.push(r[u]),r[u].Level=1);if(o!=null&&o==0){for(u=0;u<w.length;u++)f.push(n.extend(!0,{},w[u])),f[f.length-1].CSS="summary",f[f.length-1].Value=this._getLocalizedLabels("Total")+" "+f[f.length-1].Value;w.splice(0,w.length)}var p=f.length,b=0,tt,ut,it=!1;for(u=0;u<p;u++){for(b=b+u,tt=f[u].itemIndex!=null?f[u].itemIndex:f[u].Index,ut=parseInt(tt.split(",")[0])*this._excelRowCount+parseInt(tt.split(",")[1]),h=ut;h<r.length;h=h+this._excelRowCount)(r[h].CSS.indexOf("value")>-1||r[h].CSS.indexOf("colheader")>-1||r[h].CSS.indexOf("calc")>-1||r[h].CSS.indexOf("cstot")>-1||r[h].CSS.indexOf("cgtot")>-1||r[h].CSS.indexOf("none")>-1)&&parseInt(r[h].Index.split(",")[0])>=y&&(it=!0),it&&(b=b+(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?parseInt(p):this._excelRowCount),f[b]=n.extend(!0,{},r[h]));b=0;it=!1}for(u=0;u<p;u++)f[u]!=null&&(f[u].Span="none",isNaN(f[u].Level)&&(f[u].Level=1),f[u].Index=="0,0"&&f[u].CSS!="colheader"&&u==0||(f[u].RowSpan=1),f[u].ColSpan=o!=null&&o==y-1&&f[u].CSS=="rowheader"&&f[u].Info.toLowerCase().indexOf("[measure")==-1?f.length/p:o!=null&&o==0&&f[u].Info.toLowerCase().indexOf("[measure")>-1&&f[u].CSS=="rowheader"?f.length/p:o!=null&&o!=y-1&&o!=0&&(f[u].Info.toLowerCase().indexOf("[measure")>-1||f[u].CSS=="rowheader"&&parseInt(f[u].Index.split(",")[0])<o)?f.length/p:1);this._excelRowCount=p}for(r!=null&&f.length==0&&(f=r),e=0;e<f.length/this._excelRowCount;e++)for(c=0;c<this._excelRowCount;c++)f[e*this._excelRowCount+c].i=""+e+","+c+"",f[e*this._excelRowCount+c].Span="none";this._excelLikeJSONRecords=f;this._isExporting||this.renderControlFromJSON()},_rowExcelLikeLayout:function(n,i,r,u,f,e,o){for(var v,c,h,l=!1,s=n+(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?i[n].ColSpan*this._excelRowCount:this._excelRowCount),a=0;a<i[n].RowSpan&&s<i.length&&i[s].CSS.indexOf("value")==-1;s++,a++){if(f!=null&&f!=o-1&&f!=0&&i[s].Info.toLowerCase().indexOf("[measure")>-1&&i[s].Span!="Block"&&(l=!0),v=f!=null&&f==o-1?i[s].CSS=="summary row"&&(i[s+this._excelRowCount].CSS=="summary row"||i[s+this._excelRowCount].CSS=="none"||i[s+this._excelRowCount].Info.toLowerCase().indexOf("[measure")>-1):f!=null&&f!=o-1&&f!=0?i[s].CSS=="summary"&&(i[s+this._excelRowCount].CSS=="summary"||i[s+this._excelRowCount].CSS=="none"||i[s+this._excelRowCount].Info.toLowerCase().indexOf("[measure")>-1||parseInt(i[s].Index.split(",")[0])-1<=f):!1,(i[s].CSS=="rowheader"||i[s].CSS=="none"||v)&&i[s].Span!="Block"){for(h=s+1;h<s+i[s].RowSpan;h++)(i[h].Info.toLowerCase().indexOf("[measure")==-1||f!=null&&f!=o-1)&&(i[h].Span="Block");if(i[s].Level=u,i[s].CSS!="none")if(i[s+this._excelRowCount]!=null&&i[s+this._excelRowCount].CSS.indexOf("value")==-1&&(i[s].itemIndex=i[s+i[s].RowSpan-(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?1:0)].Index),v){for(c=s-i[n].ColSpan*this._excelRowCount;c>=0&&c<i.length;c--)if(i[c].Value!=""){i[s].Value=i[c].Value;i[s].Level=i[n].Level;break}f!=null&&f!=o-1&&f!=0&&parseInt(i[s].Index.split(",")[0])-1==f?e.push(i[s]):(i[s].Value+=" "+i[s+this._excelRowCount*parseInt(i[s].ColSpan)].Value,r.push(i[s]))}else r.push(i[s]);i[s].Span="Block";i[s].CSS!="summary row"&&i[s].CSS!="summary"&&this._rowExcelLikeLayout(s,i,r,u+1,f,e,o)}if(l&&a+1==i[n].RowSpan){for(l=!1,h=0;h<e.length;h++)e[h].Value=i[n].Value+" "+e[h].Value,r.push(e[h]);e.splice(0,e.length)}}},_columnExcelLikeLayout:function(t,i,r){for(var l,u,o,s,f,c,y,e,v,h,p=t.length/this._excelRowCount,a=0;a<p&&a<t.length;a++)for(l=0;l<=r&&l<t.length;l++)if(u=a*this._excelRowCount+l,t[u].CSS=="colheader"&&t[u].Span!="Block"&&t[u].Info.toLowerCase().indexOf("[measure")==-1&&t[u].ColSpan>1){for(f=u;f<u+t[u].RowSpan;f++){for(e=f+this._excelRowCount;e<f+t[u].ColSpan*this._excelRowCount;e=e+this._excelRowCount)t[e].Span="Block";f!=u&&(t[f].Span="Block")}if(o=u+(t[u].RowSpan-1)+(t[u].ColSpan-1)*this._excelRowCount+1,t[o].Info.toLowerCase().indexOf("[measure")>-1&&JSON.parse(this.getOlapReport()).PivotCalculations.length>1&&i!=null&&i!=r&&i!=0){for(s=[],f=u+t[u].RowSpan;f<=o;f=f+(t[f].ColSpan+1)*this._excelRowCount)if(c=f+(t[f].RowSpan-1)+(t[f].ColSpan-1)*this._excelRowCount+1,t[c].CSS.indexOf("summary")>-1){for(t[c-1].RowSpan=t[c-1].RowSpan+t[c].RowSpan,y=parseInt(t[c].Index.split(",")[0])*this._excelRowCount,e=0;e<this._excelRowCount;e++)t.splice(parseInt(t[o].Index.split(",")[0])*this._excelRowCount+this._excelRowCount+e+s.length*this._excelRowCount,0,n.extend(!0,{},t[y+e]));s.push(y);t[f].ColSpan=t[f].ColSpan-1}for(v=s.length-1;v>=0;v--)t.splice(parseInt(t[s[v]].Index.split(",")[0])*this._excelRowCount,this._excelRowCount);s.length>0&&(t[u].ColSpan=t[u].ColSpan-s.length,h=u+t[u].ColSpan*this._excelRowCount,t[h].ColSpan=s.length,t[h].RowSpan=t[u].RowSpan,t[h].Value=t[u].Value+" Total",t[h].CSS="summary",t[h].Span="none",t[h].State=0)}else t[o].Info.toLowerCase().indexOf("[measure")>-1&&t[o+1].CSS.indexOf("summary")>-1&&JSON.parse(this.getOlapReport()).PivotCalculations.length==1&&i!=null&&i!=r&&i!=0&&(t[u].ColSpan=t[u].ColSpan-1,t[u+t[u].ColSpan*this._excelRowCount]=n.extend(!0,{},t[o+1]),t[o+1].Value="",t[u+t[u].ColSpan*this._excelRowCount].Value=t[u].Value+" Total",t[u+t[u].ColSpan*this._excelRowCount].RowSpan=t[u].RowSpan)}},_getColumnIndices:function(t,i,r,u){var f=t=="rows"?i.Index.split(",")[1]:t=="columns"?i.Index.split(",")[0]:null;return i.Value==r&&(n.inArray(Number(f),u)==-1?u.push(Number(f)):u),u},_getParentPosition:function(i,r,u){for(var e="",f="",o="",r=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&!n.isNumeric(r)?parseInt(r.split(",")[0])*this._rowCount+parseInt(r.split(",")[1]):r;f==e&&!t.isNullOrUndefined(this.getJSONRecords()[r]);)f=this.getJSONRecords()[r].Value,(e==""&&f!=""||e==f+" Total"||e+" Total"==f)&&(e=f),i=="columnheader"&&u=="start"?r=r-this._rowCount:i=="rowheader"&&u=="end"&&r++,o=f==e?this.getJSONRecords()[r].Index:o,i=="columnheader"&&u=="end"?r=r+this._rowCount:i=="rowheader"&&u=="start"&&r--,f=f==""?e:f;return o},_updateRowCells:function(i,r,u,f,e,o){var h,s,a,v,l,c;o&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&r.find("tbody:eq(2) tr:empty").remove();do{if(this.model.enableRTL&&n(n(i).find(".summary,.rowheader,.colheader")).css("text-align","right"),h=n(i).next().children().first().attr("data-p"),s=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?"data-i":"data-p",t.isNullOrUndefined(h))h=n(i).children().first().attr("data-p"),u.find("[data-p='"+h+"']").length>0&&this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout?f!=""&&u.find("[data-p='"+f+"']").parent().length>0?(n(i).clone().insertBefore(u.find("[data-p='"+f+"']").parent()),u.find("[data-p='"+f+"']").parent().remove()):n(i).clone().insertAfter(u.find("[data-p='"+h+"']").parent()):o?(c=r.find("["+s+"$=',"+parseInt(n(i).children().first().attr(s).split(",")[1])+"']").parent(),n(c).eq(1).clone().insertAfter(u.find("tr:last")),n(c).eq(0).clone().insertAfter(u.find(".rowhead tr:last"))):n(i).clone().insertAfter(u.find("tr:last")),u.find("[data-p='"+n(i).children().first().attr("data-p")+"']").parent().last().prev().find("[data-p='"+n(i).children().first().attr("data-p")+"']").parent().remove();else if(o||this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?n(i).children().length>0&&u.find("["+s+"$=',"+parseInt(n(i).children().first().attr(s).split(",")[1])+"']").parent().remove():u.find("[data-p='"+n(i).children().first().attr("data-p")+"']:not('.e-grpRow')").parent().remove(),f!=""&&u.find("[data-p='"+f+"']").parent().length>0)if(o||n(i).clone().insertBefore(u.find("[data-p='"+f+"']").parent()),o){if(n(i).children().length>0){a=0;do v=u.find("["+s+"$=',"+parseInt(f.split(",")[1])+"']").parent().eq(a),c=r.find("["+s+"$=',"+parseInt(n(i).children().first().attr(s).split(",")[1])+"']").parent().eq(a).clone(),n(v).length>0?n(c).insertBefore(n(v)):n(c).insertAfter(u.find("["+s+"$=',"+parseInt(r.find("["+s+"$=',"+parseInt(n(i).children().first().attr(s).split(",")[1])+"']").parent().eq(a).prev().children().first().attr(s).split(",")[1])+"']").parent().eq(a)),a++;while(a<2);this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout&&u.find("["+s+"$=',"+parseInt(f.split(",")[1])+"']").parent().remove()}}else this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout&&u.find("[data-p='"+f+"']").parent().remove();else if(o){if(u.find("["+s+"$=',"+parseInt(h.split(",")[1])+"']").parent().length==0){l=n(i).next();do h=n(l).next().children().length>0?n(l).next().children().first().attr(s):h,l=n(l).next();while(u.find("["+s+"$=',"+parseInt(h.split(",")[1])+"']").parent().length==0&&n(l).children().length>0)}n(i).children().length>0&&(v=u.find("["+s+"$=',"+parseInt(h.split(",")[1])+"']").parent(),c=r.find("["+s+"$=',"+parseInt(n(i).children().first().attr(s).split(",")[1])+"']").parent(),n(v).length>0?(n(c).eq(0).clone().insertBefore(n(v).eq(0)),n(c).eq(1).clone().insertBefore(n(v).eq(1))):(n(c).eq(1).clone().insertAfter(u.find("tr:last")),n(c).eq(0).clone().insertAfter(u.find(".rowhead tr:last"))))}else if(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout)n(i).clone().insertAfter(u.find("tr:last"));else{if(u.find("[data-p='"+h+"']").parent().length==0){l=n(i).next();do h=n(l).next().children().first().attr("data-p"),l=n(l).next();while(u.find("[data-p='"+h+"']").parent().length==0&&n(l).children().length>0)}u.find("[data-p='"+h+"']").parent().length>0?n(i).clone().insertBefore(u.find("[data-p='"+h+"']").parent()):n(i).clone().insertAfter(u.find("tr:last"))}i=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?n(i).next():n(i).prev()}while(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?n(i).length>0&&n(i).children("[data-p='"+f+"']").length==0:n(i).next().children("[data-p='"+e+"']").length==0&&n(i).length>0&&n(i).next().children().length>0&&parseInt(n(i).next().children().first().attr("data-p").split(",")[1])>parseInt(e.split(",")[1]))},_getAdjacentRowPos:function(t,i,r){var f=[],u,e=r;do u=i+","+r,f=n(t.find("[data-p='"+u+"']")),r--,r<0&&(i=i-1,r=e+1,e=r);while(f.length==0&&i>-1);return u},_mergeHtml:function(i,r,u,f){var a=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,nt=u.find("[data-p='"+r+"']").children("span")[0],l,s,w,y,e,c,p,g;if(i=="rowheader"){var tt=parseInt(r.split(",")[1]),v="",o="",it="";if(v=this._getParentPosition(i,this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?r:tt,"start"),o=it=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._getParentPosition(i,r,"end"):o,o=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&f.find("[data-p='"+o+"']").parent().length==0?this._drillAction=="drilldown"?f.find("[data-p='"+r+"']").parent().next().children().first().attr("data-p"):u.find("[data-p='"+r+"']").parent().next().children().first().attr("data-p"):o,this._drillAction=="drilldown"){if(t.isNullOrUndefined(nt)){for(l=(parseInt(r.split(",")[0])+1)*this._rowCount+parseInt(r.split(",")[1])-1,o=r;!t.isNullOrUndefined(this._JSONRecords[l])&&this._JSONRecords[l].CSS.indexOf("summary")>-1&&n(u.find("[data-p='"+this._JSONRecords[l].Index+"']")).length==0;)l=l+this._rowCount-1;r=this._JSONRecords[l].Index;r=n(u.find("[data-p='"+r+"']")).length>0?r:this._getAdjacentRowPos(u,parseInt(r.split(",")[0]),parseInt(r.split(",")[1]))}s=n(u.find("[data-p='"+r+"']").children("span")[0]).closest("tr")[0];this._updateRowCells(s,u,f,o,v,a)}else{var s=n(f.find("[data-p='"+r+"']").closest("tr")[0]),rt=parseInt(f.find("[data-p='"+r+"']").attr("rowSpan")),k=0,ut=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?"data-i":"data-p";do w=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?n(s).children().first().attr("data-i"):n(s).children().first().attr("data-p"),s=n(s).next(),a||this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?f.find("["+ut+"$=',"+parseInt(w.split(",")[1])+"']").parent().remove():f.find("[data-p='"+w+"']:not('.e-grpRow')").parent().remove(),k++;while(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?n(s).children().first().attr("data-p")!=o:k<rt);s=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?u.find("[data-p='"+r+"']").parent():u.find("[data-p='"+n(s).children().first().attr("data-p")+"']").parent().length>0?u.find("[data-p='"+n(s).children().first().attr("data-p")+"']").parent():a?n(u).find(".rowhead tr:last"):n(u).find("tr:last");this._updateRowCells(s,u,f,o,v,a)}}else{var d=parseInt(r.split(",")[0])*this._rowCount,v="",o="";v=this._getParentPosition(i,d,"start");y=!1;this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotColumns.length>0&&n.each(JSON.parse(this.getOlapReport()).PivotColumns,function(n,t){if(t.showSubTotal==!1)return y=!0,!1}):this.model.dataSource.columns.length>0&&n.each(this.model.dataSource.columns,function(n,t){if(t.showSubTotal==!1)return y=!0,!1});(this._drillAction=="drillup"||y)&&(o=this._getParentPosition(i,d,"end"),r=o);var b=a?n(u).find(".pivotGridFrozenTable,.pivotGridValueTable").find("tr:not(.hdrTr)"):n(u).find("tr:not(.hdrTr)"),h=a?n(f).find(".pivotGridFrozenTable,.pivotGridValueTable").find("tr:not(.hdrTr)"):n(f).find("tr:not(.hdrTr)");for(this.model.enableRTL&&n(b).find(".summary,.rowheader,.colheader").css("text-align","right"),e=0;e<b.length;e++)c=n(b[e]).children().filter(function(){return n(this).attr("data-p").split(",")[0]>parseInt(v.split(",")[0])&&n(this).attr("data-p").split(",")[0]<=parseInt(r.split(",")[0])}),p=n(h[e]).children().filter(function(){return n(this).attr("data-p").split(",")[0]>parseInt(v.split(",")[0])&&n(this).attr("data-p").split(",")[0]<=parseInt(r.split(",")[0])}),n(h[e]).children().length==0?n(h[e]).append(c):n(h[e]).find("").eq(0).prev().length>0?(g=p.eq(0).prev(),p.remove(),c.insertAfter(g)):(p.remove(),n(h[e]).children(".colheader,.rowheader,.summary,.value").eq(0).length>0?c.eq(0).prev().length>0?c.insertAfter(n(h[e]).find('[data-p="'+c.eq(0).prev().attr("data-p")+'"]')):c.insertBefore(n(h[e]).children(".colheader,.rowheader,.summary,.value").eq(0)):n(h[e]).append(c))}},_cropHtml:function(t){return this._table=n(t).clone(),n(n(t)).find('[style*="display: none"]').remove(),t},renderControlFromJSON:function(){var k,oi,ni,o,ti,s,si,hi,ci,gi,ii,ot,it,vi,a,h,b,c,rt,fi,p,y,r,f,e,ei,st,dt,vt,gt,ht,g,l,pi,wi,rr,di;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(this.model.enablePaging||this.model.enableVirtualScrolling)&&this._isNavigation==!1&&(k=this,oi=setInterval(function(){if(k._pagerObj!=null){clearInterval(oi);var n={CategoricalCurrentPage:k.model.dataSource.pagerOptions.categoricalCurrentPage,CategoricalPageSize:k.model.dataSource.pagerOptions.categoricalPageSize,SeriesCurrentPage:k.model.dataSource.pagerOptions.seriesCurrentPage,SeriesPageSize:k.model.dataSource.pagerOptions.seriesPageSize},t={Column:k._categPageCount,Row:k._seriesPageCount};k._pagerObj.element.css("opacity","1");k._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled");k._pagerObj._unwireEvents();k._pagerObj._wireEvents();k._pagerObj.initPagerProperties(t,n)}},10)),this._isNavigation=!1,ni=null,!t.isNullOrUndefined(this.model.valueSortSettings)&&this.element.find(".valueSorting").length>0&&!t.isNullOrUndefined(t.PivotAnalysis._valueSorting)&&(ni=this.element.find(".valueSorting").parent()),o=this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelLikeJSONRecords:this.getJSONRecords(),!this.model.enableJSONRendering&&!this.model.enableDefaultValue&&!t.isNullOrUndefined(o)&&o.length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotCalculations.length==0&&t.isNullOrUndefined(JSON.parse(this.getOlapReport()).CalculatedMeasure):this.model.dataSource.values.length==0||this.model.dataSource.values[0].measures.length==0)&&(o=n.map(o,function(n){return n.CSS.indexOf("value")>-1&&(n.Value=""),n}),this.setJSONRecords(JSON.stringify(o))),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.dataSource.values.length==0&&this.model.dataSource.rows.length==0&&(o=o.filter(function(n){return n.Index=Number(n.Index.split(",")[0])-1+","+n.Index.split(",")[1],n.Index.split(",")[0]!=-1?n:void 0})),t.isNullOrUndefined(o)||(o=this._appendCssClassName(o)),this.model.enableConditionalFormatting&&this._isFormatApply&&!t.isNullOrUndefined(o)&&o.length>0&&(o=this._refreshCellFormatting(o)),this.model.enableConditionalFormatting&&!this._isFormatApply&&!t.isNullOrUndefined(o)&&o.length>0&&(o=this._applyCodeBehindFormatting(o)),n(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen&&(ti=n("<div id="+this._id+"Toolbar style='width:"+this._pivotClientObj._gridWidth+";height:"+this._pivotClientObj._gridHeight+";overflow:auto;margin-top:5px;margin-left:5px'><\/div>")),o!=null&&o!="")for(a=0;a<o.length;a++)o[a].Value=="Total"&&(o[a].Value=this._getLocalizedLabels("Total")),o[a].Value=="Grand Total"&&(o[a].Value=this._getLocalizedLabels("GrandTotal"));if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this._applyLocale(o),s=n("<table class=\"e-pivotGridTable\" role='grid'  aria-readonly='true'><\/table>"),this.model.isResponsive&&s.addClass("e-table"),this.model.enableColumnResizing&&this.model.resizeColumnsToFit&&s.addClass("e-column-resizeToContent"),(!this.model.enableColumnResizing||this.model.resizeColumnsToFit)&&(this.model.enableColumnResizing||this.model.resizeColumnsToFit)||s.addClass("e-column-resizeToSize"),o!=null&&o!=""||this.model.enableGroupingBar){if(o!=null&&o!=""){for(ci=this._rowCount,this._rowCount=0,gi=this,p=0;p<o.length;p++)if(parseInt(o[p].Index.split(",")[0])==0)this._rowCount++;else break;if(this._rowCount=this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelRowCount:this._rowCount,this.model.analysisMode==t.Pivot.AnalysisMode.Olap){var nt=this._rowCount,yt=!1,i,v,pt=!1,ct,ut,lt,ft,d,tt,et,wt,li=!1,ai=!1,u=n.extend(!0,[],o),w=t.isNullOrUndefined(this._pivotClientObj)?this.model.subTotalSettings:this._pivotClientObj.model.subTotalSettings,bt=this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotRows:this.model.dataSource.rows,kt=this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotColumns:this.model.dataSource.columns;if(!t.isNullOrUndefined(w))for(f=0;f<w.length;f++){for(e=0;e<bt.length;e++)w[f].name==(t.isNullOrUndefined(bt[e].Tag)?bt[e].fieldName:bt[e].Tag)&&(li=!0);for(e=0;e<kt.length;e++)w[f].name==(t.isNullOrUndefined(kt[e].Tag)?kt[e].fieldName:kt[e].Tag)&&(ai=!0)}if(ii=t.isNullOrUndefined(this._pivotClientObj)?this.layout():this._pivotClientObj.gridLayout(),!t.isNullOrUndefined(w)&&li==!0)for(ot=u.filter(function(n){return n.CSS=="rowheader"&&n.RowSpan!=1&&n.State==1}),ot==0&&(ot=u.filter(function(n){return n.CSS=="rowheader"&&n.RowSpan!=1})),a=0;a<w.length;a++)for(f=0;f<w[a].levels.length;f++)if(w[a].levels[f].showSubTotal==!1&&ii!="excellikelayout")for(e=0;e<ot.length;e++)if(w[a].levels[f].name==ot[e].Info.split("::")[1])for(ct=ot[e].Index.split(",")[0],ut=ot[e].ColSpan,lt=ot[e].Index.split(",")[1],h=0;h<u.length;h++)if((u[h].CSS=="summary"||u[h].CSS=="summary row")&&u[h].Value=="Total"&&!t.isNullOrUndefined(u[h].Value)&&!t.isNullOrUndefined(u[h+1])&&(u[h].Index.split(",")[0]==u[h+1].Index.split(",")[0]||parseInt(u[h].Index.split(",")[0])!=0)&&u[h].Index.split(",")[0]==(parseInt(ct)+ut).toString()&&parseInt(lt)<=parseInt(u[h].Index.split(",")[1])){if(yt=!0,ft=u[h].Index.split(",")[1],d=u[h],tt=u[h].RowSpan,u.splice(n.inArray(d,u),1),et=tt,et>1)while(et!=1)d=u[h],u.splice(n.inArray(d,u),1),et--;for(b=0;b<u.length;b++)if(u[b].Index.split(",")[1]==ft&&(d=u[b],et=tt,u.splice(n.inArray(d,u),1),et>1))while(et!=1)d=u[b],u.splice(n.inArray(d,u),1),et--;nt=nt-tt;break}if(!t.isNullOrUndefined(w)&&ai==!0)for(it=u.filter(function(n){return n.CSS=="colheader"&&n.ColSpan!=1&&n.State==1}),it==0&&(it=u.filter(function(n){return n.CSS=="colheader"&&n.ColSpan!=1})),vi=(u.length/this._rowCount-1).toString(),a=0;a<w.length;a++)for(f=0;f<w[a].levels.length;f++)if(w[a].levels[f].showSubTotal==!1&&ii!="excellikelayout")for(e=0;e<it.length;e++)if(w[a].levels[f].name==it[e].Info.split("::")[1])for(ft=it[e].Index.split(",")[1],tt=it[e].RowSpan,lt=it[e].Index.split(",")[0],ColSpan=parseInt(it[e].ColSpan)-1,h=0;h<u.length;h++)if((u[h].CSS=="summary"||u[h].CSS=="summary col")&&(parseInt(u[h].Index.split(",")[0])!=vi||parseInt(u[h].Index.split(",")[1])!=0)&&parseInt(u[h].Index.split(",")[1])==parseInt(ft)+tt&&parseInt(u[h].Index.split(",")[0])<=parseInt(lt)+ColSpan&&parseInt(lt)<=parseInt(u[h].Index.split(",")[0])){for(pt=!0,ct=u[h].Index.split(",")[0],d=u[h],ut=u[h].ColSpan,Index=h,u.splice(n.inArray(d,u),1),b=0;b<u.length;b++)parseInt(ct)<=parseInt(u[b].Index.split(",")[0])&&parseInt(u[b].Index.split(",")[0])<parseInt(ct)+ut&&(d=u[b],colSpancount=(ut-1)*nt,u.splice(n.inArray(d,u),1),b=b-1);h--}if(nt!=this._rowCount&&yt==!0)for(c=u[0].RowSpan;c<u.length;c++)if((u[c].CSS=="rowheader"||u[c].CSS=="summary"||u[c].CSS=="summary row")&&u[c].RowSpan!=1&&!t.isNullOrUndefined(u[c].State)){for(ft=u[c].Index.split(",")[1],wt=u[c].Index.split(",")[0],tt=0,e=0;e<u[c].RowSpan;e++)parseInt(ft)+u[c].RowSpan>u[c+e].Index.split(",")[1]&&wt==u[c+e].Index.split(",")[0]&&tt++;u[c].RowSpan=tt}if(pt==!0)for(c=0;c<u.length;c++)if((u[c].CSS=="colheader"||u[c].CSS=="summary"||u[c].CSS=="summary col")&&u[c].ColSpan!=1&&!t.isNullOrUndefined(u[c].State)){for(ft=u[c].Index.split(",")[1],wt=u[c].Index.split(",")[0],ut=0,e=0;e<u.length;e++)c+e<u.length&&parseInt(wt)+u[c].ColSpan>parseInt(u[c+e].Index.split(",")[0])&&ft==u[c+e].Index.split(",")[1]&&(ut++,e+=nt-1);u[c].ColSpan=ut}}yt==!0||pt==!0?(i=u,v=t.isNullOrUndefined(nt)?this._rowCount:nt,this._rowLength=t.isNullOrUndefined(nt)?this._rowCount:nt):(i=o,v=this._rowCount);var ri=n("<thead><\/thead>"),ui=n("<tbody><\/tbody>"),yi=!0,at=0;for(i[0].CSS=="none"?at=n(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&JSON.parse(this._pivotClientObj.getOlapReport()).PivotCalculations.length==0&&JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows.length==0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns.length-1:i[0].RowSpan-1:(jQuery.each(i,function(n){return at+=i[n].RowSpan,i[n].CSS=="colheader"}),at=at-2),rt=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,fi=!1,p=0;p<i.length;p++)if(p<v)if(yi){for(yi=p>=at?!1:!0,y="<tr role='row'>",this.model.enableGroupingBar&&i[p].Index=="0,0"&&i[p].CSS.indexOf("colheader")>-1&&(y=y+"<"+(rt?"td":"th")+" class='e-grpRow' data-p='-1,-1' colspan= 1 rowspan="+(v-1)+"> <div class=e-rows>"+this._getLocalizedLabels("DragFieldHere")+"<\/div><\/th>",fi=!0),r=p;r<i.length;r=r+v)if(i[r].Span!="Block")if(y=i[r].Index=="0,0"&&i[r].CSS.indexOf("colheader")==-1&&this.model.enableGroupingBar?y+"<"+(rt?"td":"th")+" class=e-grpRow data-p="+i[r].Index+" colspan="+i[r].ColSpan+" rowspan="+i[r].RowSpan+" role='columnheader' aria-label='row'"+(i[r].i==null?"":"data-i="+i[r].i)+">"+(i[r].State==0?'<span style="margin-left: 0px"><\/span>':i[r].State==2?'<span class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;<\/span>':i[r].State==1?'<span class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;<\/span>':"")+i[r].Value+t.buildTag("div.e-rows",this._pivotRow,{})[0].outerHTML+"<\/th>":y+"<"+(rt?"td":"th")+(i[r].CSS=="none"?"":' class="'+i[r].CSS)+(i[r].CSS=="none"?" data-p="+i[r].Index:'" data-p='+i[r].Index)+" colspan="+i[r].ColSpan+" rowspan="+i[r].RowSpan+" role='columnheader'"+(i[r].i==null?"":"data-i="+i[r].i)+">"+(i[r].State==0?'<span style="margin-left: 10px"><\/span>':i[r].State==2?'<span class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;<\/span>':i[r].State==1?'<span class="e-collapse e-icon" aria-label=\'expanded\' title=" '+this._getLocalizedLabels("Collapse")+'">&nbsp;<\/span>':"")+i[r].Value+"<\/th>",i[r].RowSpan>1&&i[r].ColSpan<=1)for(f=r+1;f<r+i[r].RowSpan;f++)t.isNullOrUndefined(i[f])||(i[f].Span="Block");else if(i[r].ColSpan>1&&i[r].RowSpan<=1)for(f=r+v;f<r+i[r].ColSpan*v;f=f+v)t.isNullOrUndefined(i[f])||(i[f].Span="Block");else if(i[r].ColSpan>1&&i[r].RowSpan>1)for(f=r;f<r+i[r].RowSpan;f++){for(e=f+v;e<f+i[r].ColSpan*v;e=e+v)t.isNullOrUndefined(i[e])||(i[e].Span="Block");f!=r&&(t.isNullOrUndefined(i[f])||(i[f].Span="Block"))}y+="<\/tr>";n(y).text()!=""&&n(ri).append(y)}else{for(y="<tr role='row'>",parseInt(i[p].Index.split(",")[0])==0&&parseInt(i[p].Index.split(",")[1])==v-1&&fi&&(y=y+"<td class='rowheader' data-p='-1,-2' colspan=1 rowspan=1>"+(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout?this._getLocalizedLabels("GrandTotal"):this._getLocalizedLabels("Total"))+"<\/td>"),r=p;r<i.length;r=r+v)if(i[r].Span!="Block")if(y=i[r].CSS.indexOf("rowheader")>-1||i[r].CSS=="summary"||i[r].CSS.indexOf("summary rstot")>-1||i[r].CSS.indexOf("summary stot")>-1||i[r].CSS=="summary row"||i[r].CSS.indexOf("summary rgtot")>-1?this.layout().toLowerCase()=="excellikelayout"?y+"<"+(rt?"td":"th")+(i[r].CSS=="none"?"":' class="'+i[r].CSS)+'" data-p='+i[r].Index+" colspan="+i[r].ColSpan+" rowspan="+i[r].RowSpan+" role='rowheader'"+(i[r].i==null?"":"data-i="+i[r].i)+">"+(i[r].State==2?'<span style="margin-'+(this.model.enableRTL?"right:":"left:")+i[r].Level*10+'px" class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;<\/span>':i[r].State==1?'<span style="margin-'+(this.model.enableRTL?"right:":"left:")+i[r].Level*10+'px" class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;<\/span>':'<span style="margin-'+(this.model.enableRTL?"right:":"left:")+(this._excelLikeJSONRecords!=null&&i[r].CSS=="summary row"?i[r].Level*10:(i[r].Level==1?1:i[r].Level+2)*10)+'px">&nbsp;<\/span>')+i[r].Value+"<\/th>":y+"<"+(rt?"td":"th")+(i[r].CSS=="none"?"":' class="'+i[r].CSS)+'" data-p='+i[r].Index+" colspan="+i[r].ColSpan+" rowspan="+i[r].RowSpan+" role='rowheader'>"+(i[r].State==0?'<span style="margin-left: 10px"><\/span>':i[r].State==2?'<span class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;<\/span>':i[r].State==1?'<span class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;<\/span>':"")+i[r].Value+"<\/th>":y+"<td"+(i[r].CSS=="none"?"":' class="'+i[r].CSS)+'" data-p='+i[r].Index+" colspan="+i[r].ColSpan+" rowspan="+i[r].RowSpan+" role='gridcell'"+(i[r].i==null?"":"data-i="+i[r].i)+">"+(i[r].State==2?'<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'">&nbsp;<\/span>':i[r].State==1?'<span class="e-collapse e-icon" title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;<\/span>':"")+i[r].Value+"<\/td>",i[r].RowSpan>1&&i[r].ColSpan<=1)for(f=r+1;f<r+i[r].RowSpan;f++)t.isNullOrUndefined(i[f])||(i[f].Span="Block");else if(i[r].ColSpan>1&&i[r].RowSpan<=1)for(f=r+v;f<r+i[r].ColSpan*v;f=f+v)t.isNullOrUndefined(i[f])||(i[f].Span="Block");else if(i[r].ColSpan>1&&i[r].RowSpan>1)for(f=r;f<r+i[r].RowSpan;f++){for(e=f+v;e<f+i[r].ColSpan*v;e=e+v)t.isNullOrUndefined(i[e])||(i[e].Span="Block");f!=r&&(t.isNullOrUndefined(i[f])||(i[f].Span="Block"))}y+="<\/tr>";n(y).text()!=""&&n(ui).append(y)}rt?this._renderFrozenGridTable(s,ri,ui):(n(s).append(ri),n(s).append(ui))}}else si=t.buildTag("tr",t.buildTag("th","",{width:"70px"})[0].outerHTML+t.buildTag("th","",{width:"70px"})[0].outerHTML+t.buildTag("th","",{width:"70px"})[0].outerHTML),hi=t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML,n(s).append(si),n(s).append(hi),this._rowCount=0;if(this._unWireEvents(),this._wireEvents(),ei=!1,this._pivotClientObj&&this._pivotClientObj.model.analysisMode=="olap"&&this._pivotClientObj.model.operationalMode=="clientmode"&&(ei=this._pivotClientObj.model.enableVirtualScrolling||this._pivotClientObj.model.enablePaging),this.model.enableVirtualScrolling||ei||!(n(s).find("tr:last > td").length>0)||n(s).find("tr:last").find("td").text()!=""||!n(s).find("tr:last").hasClass("summary")||this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||this._pagerObj!=null||n(s).find("tr:last").hide(),this.model.enablePaging||this.model.enableVirtualScrolling||(this._hideGrandTotal(s),this._hideSubTotal(s)),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.enableCollapseByDefault||!t.isNullOrUndefined(this.model.collapsedMembers))&&!t.isNullOrUndefined(i))if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.enableCollapseByDefault){var rt=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,nr=!t.isNullOrUndefined(this.model.dataSource.data)&&!t.isNullOrUndefined(this.model.dataSource.rows)?this.model.dataSource.rows.length:n(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows.length:JSON.parse(this.getOlapReport()).PivotRows.length,tr=!t.isNullOrUndefined(this.model.dataSource.data)&&!t.isNullOrUndefined(this.model.dataSource.columns)?this.model.dataSource.columns.length:n(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns.length:JSON.parse(this.getOlapReport()).PivotColumns.length;for(this.model.collapsedMembers={},vt=nr;vt>=0;vt--)for(st=rt?n(s).find(".pivotGridRowTable [data-p^='"+vt+",']:has('span.e-collapse')[class^='rowheader']"):n(s).find("th[data-p^='"+vt+",']:has('span.e-collapse')[class^='rowheader']"),ht=this._getFieldName(st[0]),this.model.collapsedMembers[ht]=[],g=0;g<st.length;g++)this.model.collapsedMembers[ht].push(n(st[g]).clone().children().remove().end().text()),this._collapseMember(s,n(st[g]).find(".e-collapse"));for(gt=tr;gt>=0;gt--)for(dt=n(s).find((rt?".pivotGridFrozenTable ":"th")+"[data-p$=',"+gt+"']:has('span.e-collapse')[class$='colheader']"),ht=this._getFieldName(dt[0]),this.model.collapsedMembers[ht]=[],g=0;g<dt.length;g++)this.model.collapsedMembers[ht].push(n(st[g]).clone().children().remove().end().text()),this._collapseMember(s,n(dt[g]).find(".e-collapse"))}else t.isNullOrUndefined(this.model.collapsedMembers)||(l=this,n.each(this.model.collapsedMembers,function(i,r){var r=r,h,c,a,v,u,f,o,e;if(l.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){for(u=0;u<l.model.dataSource.rows.length;u++)l.model.dataSource.rows[u].fieldName==i&&(h=u,c="row");for(u=0;u<l.model.dataSource.columns.length;u++)l.model.dataSource.columns[u].fieldName==i&&(h=u,c="column");if(!t.isNullOrUndefined(h))if(c=="row")for(u=l.model.dataSource.columns.length+1;u<l._rowCount;u+=t.isNullOrUndefined(f)?1:f.rowSpan){for(f=n(s).find("tBody th[data-p='"+h+","+u+"']")[0],o=!1,e=0;e<r.length;e++)if(n.trim(n(f).text().replace("expanded",""))==n.trim(r[e].toString())){o=!0;break}!t.isNullOrUndefined(f)&&(n(f).hasClass("rowheader")||n(f).attr("role")=="rowheader")&&o&&n(f).find(".e-collapse").length>0&&l._collapseMember(s,n(f).find(".e-collapse"))}else if(c=="column")for(u=l.model.dataSource.rows.length;u<Math.ceil(l.getJSONRecords().length/l._rowCount);u+=t.isNullOrUndefined(f)?1:f.colSpan){for(f=n(s).find("thead th[data-p='"+u+","+h+"']")[0],o=!1,e=0;e<r.length;e++)if(n.trim(n(f).text().replace("expanded",""))==n.trim(r[e].toString())){o=!0;break}!t.isNullOrUndefined(f)&&(n(f).hasClass("colheader")||n(f).attr("role")=="columnheader")&&o&&n(f).find(".e-collapse").length>0&&l._collapseMember(s,n(f).find(".e-collapse"))}}else{for(a=JSON.parse(l.getOlapReport()).PivotRows,v=JSON.parse(l.getOlapReport()).PivotColumns,u=0;u<a.length;u++)a[u].FieldName==i&&(h=u,c="row");for(u=0;u<v.length;u++)v[u].FieldName==i&&(h=u,c="column");if(!t.isNullOrUndefined(h))if(c=="row")for(u=v.length+1;u<l._rowCount;u+=t.isNullOrUndefined(f)?1:f.rowSpan){for(f=n(s).find("tBody th[data-p='"+h+","+u+"']")[0],o=!1,e=0;e<r.length;e++)if(n.trim(n(f).text().replace("expanded",""))==n.trim(r[e].toString())){o=!0;break}!t.isNullOrUndefined(f)&&(n(f).hasClass("rowheader")||n(f).attr("role")=="rowheader")&&o&&n(f).find(".e-collapse").length>0&&l._collapseMember(s,n(f).find(".e-collapse"))}else if(c=="column")for(u=a.length;u<Math.ceil(l.getJSONRecords().length/l._rowCount);u+=t.isNullOrUndefined(f)?1:f.colSpan){for(f=n(s).find("thead th[data-p='"+u+","+h+"']")[0],o=!1,e=0;e<r.length;e++)if(n.trim(n(f).text().replace("expanded",""))==n.trim(r[e].toString())){o=!0;break}!t.isNullOrUndefined(f)&&(n(f).hasClass("colheader")||n(f).attr("role")=="columnheader")&&o&&n(f).find(".e-collapse").length>0&&l._collapseMember(s,n(f).find(".e-collapse"))}}}));if(this.element.html(""),this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enablePaging||this.model.enableVirtualScrolling||(this.model.enableAdvancedFilter||n(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableAdvancedFilter)&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||(s=this._cropHtml(s)),this.model.enableGroupingBar?(this.element.append(s),(this._JSONRecords==null||this._JSONRecords.length==0)&&this.element.append(t.buildTag("span",this._getLocalizedLabels("NoRecordsToDisplay"),{display:"inline-block",padding:"10px 0px 0px 0px","font-family":"Segoe UI"})[0].outerHTML),this.model.enableRTL&&this.element.addClass("e-rtl"),this._createFields(s,n("#"+this._id).find(".e-pivotGridTable").width(),n("#"+this._id).find(".e-pivotGridTable th").outerWidth())):n(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen?(n(ti).append(s),this.element.append(n(ti))):this.element.append(s),(this.model.enableColumnResizing&&this.model.resizeColumnsToFit||this.model.enableColumnResizing&&!this.model.resizeColumnsToFit)&&this._resizeColumnsWidth(),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this._applyFrozenHeaderWidth(i),this.element.find(".e-pivotGridTable").width("auto")),this.model.enableVirtualScrolling&&t.isNullOrUndefined(this._pivotClientObj)&&(this._createVirtualPivotGrid(s),this.model.enableGroupingBar&&this._createFields(null,n("#"+this._id).find(".e-pivotGridTable").width(),n("#"+this._id).find(".e-pivotGridTable th").outerWidth()),this.model.enableRTL&&this.element.addClass("e-rtl"),this._applyVScrolling()),t.isNullOrUndefined(this._pivotClientObj)||!this._pivotClientObj.model.enableVirtualScrolling||this._pivotClientObj.model.enablePaging||(this._pivotClientObj.element.find(".e-categPageIndicator, .e-seriesPageIndicator , .e-vScrollThumb, .e-hScrollThumb").remove(),pi=t.buildTag("div.e-seriesPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("SeriesPage")+" : ")[0].outerHTML+t.buildTag("span.series_CurrentPage",this._seriesCurrentPage)[0].outerHTML+" / "+t.buildTag("span.series_pageCount",this._seriesPageCount)[0].outerHTML)[0].outerHTML,this._seriesPageCount>1?(this._pivotClientObj.element.find(".e-vScrollPanel").width()!=12&&this._pivotClientObj.element.width(this._pivotClientObj.element.width()+12),this._pivotClientObj.element.find(".e-vScrollPanel").width(12),this._pivotClientObj.element.find(".virtualScrolling").append(pi),this._pivotClientObj.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&this._pivotClientObj.model.displaySettings.mode==t.PivotClient.DisplayMode.ChartAndGrid?this._pivotClientObj.element.find(".virtualScrolling").css("padding-top","10px"):this._pivotClientObj.element.find(".virtualScrolling").css("padding-left","2px")):this._pivotClientObj.element.find(".e-vScrollPanel").width()==12&&(this._pivotClientObj.element.width(this._pivotClientObj.element.width()-12),this._pivotClientObj.element.find(".e-vScrollPanel").width(0)),wi=t.buildTag("div.e-categPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("CategoricalPage")+" : ")[0].outerHTML+t.buildTag("span.categ_CurrentPage",this._categCurrentPage)[0].outerHTML+" / "+t.buildTag("span.categ_pageCount",this._categPageCount)[0].outerHTML)[0].outerHTML,this._categPageCount>1?(this._pivotClientObj.element.find(".e-hScrollPanel").height()!=12&&this._pivotClientObj.element.find(".e-hScrollPanel").height(12),this._pivotClientObj.controlPlacement()==t.PivotClient.ControlPlacement.title&&this._pivotClientObj.element.find(".hsVirtualScrolling").css("margin-top","3px"),this._pivotClientObj.element.find(".hsVirtualScrolling").append(wi)):this._pivotClientObj.element.find(".e-hScrollPanel").height()==12&&(this._pivotClientObj.model.isResponsive?this._pivotClientObj.element.find(".e-categoricalAxis, .e-rowAxis,.e-slicerAxis").height(this._pivotClientObj.element.find(".e-categoricalAxis, .e-rowAxis,.e-slicerAxis").height()-6):this._pivotClientObj.element.find(".e-categoricalAxis, .e-rowAxis,.e-slicerAxis").height(150),this._pivotClientObj.model.enableSplitter||this._pivotClientObj.element.find(".e-cubeBrowser").height(this._pivotClientObj.element.find(".e-cubeBrowser").height()-20),this._pivotClientObj.element.find(".e-hScrollPanel").height(0)),this._applyVScrolling(),this._pivotClientObj.element.find(".e-chartContainer").length>0&&this._pivotClientObj.element.find(".e-gridContainer").height(this._pivotClientObj.element.find(".e-chartContainer").height()+5),this._pivotClientObj.model.enableSplitter&&(t.isNullOrUndefined(this._pivotClientObj.element.find(".e-childsplit").data("ejSplitter"))||this._pivotClientObj.element.find(".e-childsplit").data("ejSplitter").refresh(),t.isNullOrUndefined(this._pivotClientObj.element.find(".e-serverchildsplit").data("ejSplitter"))||this._pivotClientObj.element.find(".e-serverchildsplit").data("ejSplitter").refresh())),this.model.enableColumnResizing?this.element.addClass("e-column-resize"):this.element.removeClass("e-column-resize"),this.model.enableRTL?(this.element.addClass("e-rtl"),this.element.find(".groupingBarPivot").addClass("e-rtl"),this.element.find("table .rowheader,.colheader,.summary, .groupingBarPivot, .e-grpRow").css("text-align","right")):(this.element.removeClass("e-rtl"),this.element.find(".groupingBarPivot").removeClass("e-rtl"),this.element.find("table .rowheader,.colheader,.summary, .e-grpRow, .groupingBarPivot ").css("text-align","left")),n(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen){n("#"+this._id).prepend("<div class='toolBar' style='height:40px,width:"+this.element.find("#PivotGridToolbar").width()+"px'><\/div>");var bi="",ki="",ir=t.buildTag("li#frozenHeaders.e-frozenHeaders e-icon","",{}).attr("aria-label",this._getLocalizedLabels("FrozenHeader")).attr({title:this._getLocalizedLabels("FrozenHeader"),tabindex:0})[0].outerHTML,ur=t.buildTag("li.e-cellSelect e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CellSelection")).attr({title:this._getLocalizedLabels("CellSelection"),tabindex:0})[0].outerHTML;this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(ki=t.buildTag("li#collapseByDefault.e-collapseByDefault e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CollapseByDefault")).attr({title:this._getLocalizedLabels("CollapseByDefault"),tabindex:0})[0].outerHTML);bi=t.buildTag("li.e-numberFormatting e-icon","",{}).attr("aria-label",this._getLocalizedLabels("NumberFormatting")).attr({title:this._getLocalizedLabels("NumberFormatting"),tabindex:0})[0].outerHTML;rr=t.buildTag("li.e-calculatedField e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CalculatedField")).attr({title:this._getLocalizedLabels("CalculatedField"),tabindex:0})[0].outerHTML;di=t.buildTag("ul",(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?t.buildTag("li#cellEditing.e-cellEditing e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CellEditing")).attr({title:this._getLocalizedLabels("CellEditing"),tabindex:0})[0].outerHTML:" ")+t.buildTag("li#drillThrough.e-drillThrough e-icon","",{}).attr("aria-label",this._getLocalizedLabels("DrillThrough")).attr({title:this._getLocalizedLabels("DrillThrough"),tabindex:0})[0].outerHTML+(((this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||this.model.analysisMode==t.Pivot.AnalysisMode.Olap)&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)?"":t.buildTag("li.e-advancedFiltering e-icon","",{}).attr("aria-label",this._getLocalizedLabels("AdvancedFiltering")).attr({title:this._getLocalizedLabels("AdvancedFiltering"),tabindex:0})[0].outerHTML)+t.buildTag("li#columnResize.e-columnResize e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ColumnResize")).attr({title:this._getLocalizedLabels("ColumnResize"),tabindex:0})[0].outerHTML+t.buildTag("li.e-toolTip e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ToolTip")).attr({title:this._getLocalizedLabels("ToolTip"),tabindex:0})[0].outerHTML+(this._pivotClientObj.displayMode()==t.PivotClient.DisplayMode.GridOnly?ki:"")+t.buildTag("li.rtl e-icon","",{}).attr("aria-label",this._getLocalizedLabels("RTL")).attr({title:this._getLocalizedLabels("RTL"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("ul",t.buildTag("li.e-hyperlinkOptions e-icon","",{}).attr("aria-label",this._getLocalizedLabels("HyperLink")).attr({title:this._getLocalizedLabels("HyperLink"),tabindex:0})[0].outerHTML+t.buildTag("li.e-layouts e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Layouts")).attr({title:this._getLocalizedLabels("Layouts"),tabindex:0})[0].outerHTML+ir+t.buildTag("li.e-exporting e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Exporting")).attr({title:this._getLocalizedLabels("Exporting"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("ul",t.buildTag("li#summaryCustomize.e-summaryCustomize e-icon","",{}).attr("aria-label",this._getLocalizedLabels("SummaryCustomization")).attr({title:this._getLocalizedLabels("SummaryCustomization"),tabindex:0})[0].outerHTML+t.buildTag("li.e-conditionalFormat e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ConditionalFormatting")).attr({title:this._getLocalizedLabels("ConditionalFormatting"),tabindex:0})[0].outerHTML+(this._pivotClientObj.model.analysisMode=="pivot"&&this._pivotClientObj.model.operationalMode=="clientmode"?t.buildTag("li.e-summaryTypes e-icon","",{}).attr("aria-label",this._getLocalizedLabels("SummaryTypes")).attr({title:this._getLocalizedLabels("SummaryTypes"),tabindex:0})[0].outerHTML+bi:""))[0].outerHTML;n(".toolBar").append(di);n(".toolBar").ejToolbar({enableRTL:this.model.enableRTL,height:"35px",enableSeparator:!0})}this._stateMaintenance();n.trim(this.model.pivotTableFieldListID)!=""&&this._isSchemaInitialize&&this.model.enablePivotFieldList&&this._renderPivotSchemaDesigner();this.model._isXMLImport&&n.trim(this.model.pivotTableFieldListID)!=""&&(this.model.enablePivotFieldList?(n("#"+this.model.pivotTableFieldListID).css("display",""),this._renderPivotSchemaDesigner()):n("#"+this.model.pivotTableFieldListID).css("display","none"),this.model._isXMLImport=!1);this._schemaData!=null&&this.element.find(".colheader, .rowheader, .value").addClass("e-droppable");this.exportRecords=yt==!0||pt==!0?i:o;t.Pivot.closePreventPanel(this);this._schemaData&&t.Pivot.closePreventPanel(this._schemaData);this._excelLikeJSONRecords!=null&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(this._rowCount=ci);this.model.valueSortSettings&&this._refreshValueSortIcons(ni);this.model.enableGroupingBar&&this.element.find(".e-pivotGridTable").width()>0&&(!(this.element.find(".values .e-pvtBtn, .columns .e-pvtBtn").length==0&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)&&this.element.find("tbody .value").length>0&&this.element.find("thead tr").length>0&&this.element.find(".groupingBarPivot").width(this.element.find(".e-pivotGridTable").width()),this.model.enableColumnResizing&&(this.element.find(".groupingBarPivot").css({overflow:"hidden"}),this.element.find(".e-pivotGridTable").width()+1==this.element.width()&&this.element.find(".groupingBarPivot").css({width:"100%"})));(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&this._applyFrozenHeaderWidth(this._JSONRecords);this._applyHeaders()},_refreshValueSortIcons:function(i){var r,u;t.isNullOrUndefined(this.model.valueSortSettings.headerText)||this.model.valueSortSettings.headerText==""||t.isNullOrUndefined(t.PivotAnalysis._valueSorting)?t.isNullOrUndefined(i)||n(i).find(".rowheader").length!=0||this.element.find("[data-p='"+Number(n(i).attr("data-p").split(",")[0])+","+Number(n(i).attr("data-p").split(",")[1])+"']").html(i.html()):(r=this.element.find("[data-p='"+Number(t.PivotAnalysis._valueSorting)+","+(Number(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotColumns.length:this.model.dataSource.columns.length)+"']")),n(r).find(".valueSorting").length!=0||n(r).hasClass("rowheader")||(u=t.buildTag("span.valueSorting e-icon "+t.PivotAnalysis._sort).css("margin-left","5px").attr("role","button").attr("aria-label","sort")[0].outerHTML,n(r).append(u)))},_applyHeaders:function(){var l,h,a,c,i,f,u;if(this._JSONRecords!=null){var f=[],o=[],r={},s=[],e=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?!0:!1;if(this.model.analysisMode!=t.PivotGrid.AnalysisMode.Olap&&(this.model.headerSettings.showColumnItems||this.model.headerSettings.showRowItems)&&!this.model.enableGroupingBar){if(e&&(JSON.parse(this.getOlapReport()).PivotRows.length>0||JSON.parse(this.getOlapReport()).PivotColumns.length>0)&&JSON.parse(this.getOlapReport()).PivotCalculations.length>0||!e&&(this.model.dataSource.rows.length>0||this.model.dataSource.columns.length>0)&&this.model.dataSource.values.length>0){for(i=0;i<(e?JSON.parse(this.getOlapReport()).PivotRows.length:this.model.dataSource.rows.length);i++)f.push(e?JSON.parse(this.getOlapReport()).PivotRows[i].FieldHeader:this.model.dataSource.rows[i].fieldCaption);for(i=0;i<(e?JSON.parse(this.getOlapReport()).PivotColumns.length:this.model.dataSource.columns.length);i++)o.push(e?JSON.parse(this.getOlapReport()).PivotColumns[i].FieldHeader:this.model.dataSource.columns[i].fieldCaption);r={rows:f,columns:o}}}else if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&(this.model.headerSettings.showColumnItems||this.model.headerSettings.showRowItems)&&this.model.layout!="excellikelayout"&&!this.model.enableGroupingBar&&(e&&JSON.parse(this.getOlapReport()).PivotCalculations.length||!e&&this.model.dataSource.values[0].measures.length)&&(this._getAxis()=="columns"||this._getAxis()=="rows")){for(l=0,h=-1,i=0;i<Number(this.element.find(".value:first").attr("data-p").split(",")[1])-1;i++)o[i]="";for(i=0;i<this._JSONRecords.length;i++)if(this._JSONRecords[i].Info!=""&&this._JSONRecords[i].Info.split("::")[1].indexOf("Measures")>-1&&this._JSONRecords[i].CSS=="colheader"){h=Number(this._JSONRecords[i].Index.split(",")[1]);break}for(i=0;i<this._JSONRecords.length;i++)this._JSONRecords[i].CSS!="value"&&this._JSONRecords[i].CSS!=" value"&&(this._JSONRecords[i].CSS=="rowheader"&&this._JSONRecords[i].Info!=""&&n.inArray(n(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[i].Info.split("::")[1]+"'] a:eq(0)").text(),f)==-1&&n.inArray(this._JSONRecords[i].Info.split("::")[1].replace(/[\[\]]+/g,""),f)==-1&&this._JSONRecords[i].Info.indexOf("Measure")===-1&&(n(this.element).parents(".e-pivotclient").length>0?f.push(n(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[i].Info.split("::")[1]+"'] a:eq(0)").text()):f.push(this._JSONRecords[i].Info.split("::")[1].replace(/[\[\]]+/g,"")),this.element.find("[data-p*='"+this._JSONRecords[i].Index.split(",")[0]+",'] .collapse").parent().not(".colheader").length>0?s.push(n(this.element.find("[data-p*='"+this._JSONRecords[i].Index.split(",")[0]+",'] .collapse").parent().not(".colheader")[0]).width()):s.push(this.element.find("[data-p='"+this._JSONRecords[i].Index.split(",")[0]+","+this._JSONRecords[i].Index.split(",")[1]+"']").width()),i=i+(this._rowCount-i%this._rowCount)),this._JSONRecords[i].CSS=="colheader"&&this._JSONRecords[i].Info!=""&&(n.inArray(n(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[i].Info.split("::")[1]+"'] a:eq(0)").text(),o)==-1||n.inArray(this._JSONRecords[i].Info.split("::")[1].replace(/[\[\]]+/g,""),o)==-1)&&this._JSONRecords[i].Info.indexOf("Measure")===-1&&(l=h!=-1?h>Number(this._JSONRecords[i].Index.split(",")[1])?0:1:0,o[Number(this._JSONRecords[i].Index.split(",")[1])-l]=n(this.element).parents(".e-pivotclient").length>0?n(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[i].Info.split("::")[1]+"'] a:eq(0)").text():this._JSONRecords[i].Info.split("::")[1].replace(/[\[\]]+/g,"")));r={rows:f,columns:o}}if(!n.isEmptyObject(r)&&(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&r.rows.length>0||this.model.analysisMode=="pivot")){for(this.element.find(".e-pivotGridTable")&&(a=this.element.find(".e-pivotGridTable").find("tbody>tr:eq(0)"),t.isNullOrUndefined(a)||jQuery.each(n(a).find("th"),function(t,i){n(i).hasClass("rowheader")&&s.push(n(i).width())})),c=n("<table><\/table>").css({width:this.element.find(".colfreeze").length>0?this.element.find(".colfreeze").width()+10:this.element.find("[p='0,0']").width()+10,height:this.element.find(".colfreeze").length>0?this.element.find(".colfreeze").height()+10:this.element.find("[p='0,0']").height()+10}).attr({id:"hdrSec"}),i=0;i<r.columns.length+1;i++)if(f=n("<tr><\/tr>").attr({"class":"hdrTr"}).appendTo(c),r.rows.length>0)for(u=0;u<r.rows.length;u++)n('<td class="e-headerItem"><\/td>').css("width",u==r.rows.length-1&&i<r.columns.length?s[r.rows.length-1]:s[u]).text(u==r.rows.length-1&&i<r.columns.length&&this.model.headerSettings.showColumnItems?this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?r.columns[i].split(".")[r.columns[i].split(".").length-1]:r.columns[i]:i==r.columns.length&&this.model.headerSettings.showRowItems?this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?r.rows[u].split(".")[r.rows[u].split(".").length-1]:r.rows[u]:"").attr("title",u==r.rows.length-1&&i<r.columns.length&&this.model.headerSettings.showColumnItems?r.columns[i]:i==r.columns.length&&this.model.headerSettings.showRowItems?r.rows[u]:"").appendTo(f);else this.model.headerSettings.showColumnItems&&n('<td class="e-headerItem"><\/td>').css("width",s[0]).text(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?r.columns[i].split(".")[r.columns[i].split(".").length-1]:r.columns[i]).attr("title",r.columns[i]).appendTo(f);this.element.find(".colfreeze").length>0?(this.element.find(".colfreeze").css("visibility","visible").html(""),c.appendTo(this.element.find(".colfreeze"))):(this.element.find("[data-p='0,0']").css({padding:"0px"}).html(""),c.appendTo(this.element.find("[data-p='0,0']")))}}},_applyLocale:function(i){var c,o,u,s,h,f,v,y;if(this.model.dataSource.values.length!=0){for(c=!1,u=0;u<this.model.dataSource.values[0].measures.length;u++)if(this.model.dataSource.values[0].measures[u].format){c=!0;break}if(c)for(o=this._getAxis(),u=0;u<this.model.dataSource.values[0].measures.length;u++){var p=[],l=[],a=this.model.dataSource.values[0].measures[u].format,e;for(s=0;s<i.length;s++)l=this._getColumnIndices(o,i[s],this.model.dataSource.values[0].measures[u].fieldCaption,p);for(h=0;h<l.length;h++)for(f=0;f<i.length;f++)v=o=="rows"?i[f].Index.split(",")[1]:o=="columns"?i[f].Index.split(",")[0]:null,v==l[h]&&i[f].Value!=""&&(e=i[f].Value.replace(/[\s,%]/g,""),e=e.replace(t.preferredCulture(this.model.locale).numberFormat.currency.symbol,""),n.isNumeric(e)&&a!=r&&(y=t.olap.base._getFormatedValue(e,a),i[f].Value=y))}}},_renderPivotSchemaDesigner:function(){var r,i,u;n("#"+this.model.pivotTableFieldListID).length>0&&(r=n("#"+this.model.pivotTableFieldListID).data("ejPivotSchemaDesigner"),r!=null?(r.model.pivotControl=this,r.model.enableWrapper=!0,r._load(),this._waitingPopup&&this._waitingPopup.hide(),this._isSchemaInitialize=!1):(i=this,u=setInterval(function(){var r=n("#"+i.model.pivotTableFieldListID).data("ejPivotSchemaDesigner");r!=null&&(clearInterval(u),r.model.pivotControl=i,r.model.enableWrapper=!0,r._load(),i._waitingPopup&&i._waitingPopup.hide(),i._isSchemaInitialize=!1,t.isNullOrUndefined(r.model.pivotControl)||r.model.pivotControl.element.find(".colheader, .rowheader, .value").addClass("e-droppable"))},10)))},_renderFrozenGridTable:function(i,r,u){var nt,d,c,l,a,tt=n("<table class=\"pivotGridFrozenTable\" style='height:47px' ><\/table>"),k=n('<table class="pivotGridRowTable" ><\/table>'),f,e,v,y,b;d=n('<table class="pivotGridValueTable" ><\/table>');c=n("<thead><\/thead>");l=n("<tbody><\/tbody>");a=n("<tbody><\/tbody>");f=nt="<tr role='row'>";e=n("<div class='rowhead' style='position: relative; float: left;display: inline-block'>");n(c).append(n(r).children());v=u.children().clone();y=u.children().clone();n(y).find(".value").remove();n(l).append(n(y));n(k).append(l);n(e).append(k);n(v).find(".rowheader, .summary:not(.summary.value)").remove();n(a).append(n(v));var g=n(t.buildTag("div.colhead").css({position:"relative",overflow:"hidden"})[0].outerHTML),o=n(t.buildTag("div.colmovable")[0].outerHTML),s=n(t.buildTag("div.colfreeze").css({float:"left",height:"100%",visibility:this.model.enableGroupingBar?"visible":"hidden"})[0].outerHTML);n(g).append(n(tt).append(c));n(f).children().length==0&&(f=n("<tr role='row'><\/tr>"));n(f).length>0&&(n(o).append(g),n(s).append(n("<table id='colfretable' style='height:100%'><\/table>").append(f)));var p=n(t.buildTag("div#rowvaluecontent.valScrollArea")[0].outerHTML),h=n(t.buildTag("div.valueCell").css({position:"relative"})[0].outerHTML),w=n(t.buildTag("div.rowHeaderArea")[0].outerHTML);n(h).append(n(d).append(a));!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders?(n(i).append("<tr><td style='padding:0px'><\/td><\/tr><tr><td style='padding:0px'><\/td><\/tr>"),n(i).find("tr:first td:eq(0)").append(n("<div id='headerContent' class='headerContent'><\/div>")),n(n(i).find("tr:last td:eq(0)")).append(n(p)),n(i).find(".headerContent").append(o),n(i).find(".headerContent .colhead").prepend(s),n(i).find(".headerContent .colhead").append("<div class='headerTable'/>"),n(i).find(".pivotGridFrozenTable").appendTo(n(i).find(".headerTable")),n(i).find(".valScrollArea").append(n(w)),n(i).find(".rowHeaderArea").append(e,h)):this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders?(n(i).append("<tr ><td style='padding:0px;border-right:0px' ><\/td><td style='padding:0px;'><\/td><\/tr>"),n(i).find("tr:first td:eq(0)").append(n("<div id='headerContent' class='headerContent' style='position:relative'><\/div>")),n(i).find(".headerContent").append(s,e),n(i).find("tr td:last").append(n(p)),n(i).find(".valScrollArea").append(n(w)),n(i).find(".rowHeaderArea").append(o,h)):(n(i).append("<tr><td style='padding:0px'><\/td><td style='padding:0px;'><\/td><\/tr><tr><td style='padding:0px'><\/td><td style='padding:0px' class='valueArea'><\/td><\/tr>"),n(i).find("tr:first td:eq(0)").append(s),n(i).find("tr:first").children("td:eq(1)").append(o),n(i).find("tr:last td:eq(0)").append(n(w)),n(i).find(".rowHeaderArea").append(e),n(i).find(".valueArea").append(n(p)),n(i).find(".valScrollArea").append(h));this.model.enableGroupingBar?n(i).find(".e-grpRow").length>0&&(n(i).find(".e-grpRow").appendTo(n(i).find(".colfreeze table tr:eq(0)")),n(i).find(".e-grpRow").removeAttr("colspan").removeAttr("rowspan")):(n(i).find("[data-p='0,0']").length>0||n(i).find("[data-p='-1,-1']").length>0)&&(this.model.enablePaging||this.model.enableVirtualScrolling?n(i).find(".rowheader").length>0||n(i).find(".rstot").length>0||n(i).find(".rgtot").length>0:n(i).find(".rowheader").length>0)&&(b=n(i).find("[data-p='-1,-1']").length>0?"-1,-1":"0,0",n(i).find("[data-p='"+b+"']").appendTo(n(i).find(".colfreeze table tr:eq(0)")),n(i).find("[data-p='"+b+"']").removeAttr("colspan").removeAttr("rowspan"))},_applyFrozenHeaderWidth:function(i){var c=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,e,u,h,r,s;if(c&&!t.isNullOrUndefined(i)&&i.length>0){e=this.element.find(".e-scroller").data("ejScroller");e&&(e.destroy(),n(this.element).css("overflow",""),this.element.find(".pivotGridRowTable, .pivotGridValueTable , .pivotGridFrozenTable").removeAttr("style"));this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders?this.element.find(".pivotGridValueTable,.pivotGridFrozenTable").addClass("rowFrozenTable"):this.element.find(".pivotGridValueTable,.pivotGridFrozenTable").removeClass("rowFrozenTable");this.element.find(".pivotGridFrozenTable colgroup, .pivotGridValueTable colgroup").remove();var o=n("<colgroup><\/colgroup>"),l=this.element.find(".pivotGridFrozenTable"),a=this.element.find(".pivotGridRowTable tr:visible").index(),f=this.element.find(".pivotGridValueTable tr:eq("+a+") td");for(u=0;u<f.length;u++)h=n(f[u]).attr("data-p").split(",")[0],r=l.find("[data-p^='"+h+",']"),r=t.isNullOrUndefined(r.last().attr("colSpan"))||r.last().attr("colSpan")=="1"?n(r).last():r[r.length-2],n(f[u]).is(":visible")&&o.append("<col style='width:"+Math.max(n(r).outerWidth(),n(f[u]).outerWidth())+"px'>");this.element.find(".pivotGridFrozenTable, .pivotGridValueTable").prepend(o);this.model.enableColumnGrandTotal||this.element.find(".pivotGridValueTable tr:visible:eq(0) td:visible").length==n(o).children().length||(s=parseInt(this.element.find(".pivotGridFrozenTable tr:first td:last").attr("colspan")),this.element.find(".pivotGridFrozenTable colgroup col").slice(-s).remove(),this.element.find(".pivotGridValueTable colgroup col").slice(-s).remove());this._refreshScroller()}},_refreshScroller:function(){var h=t.isNullOrUndefined(this.model.frozenHeaderSettings.scrollerSize)?18:this.model.frozenHeaderSettings.scrollerSize,r=!t.isNullOrUndefined(this._pivotClientObj)&&n("#"+this._pivotClientObj._id+"_PivotGridToolbar").length>0,c=r?n("#"+this._pivotClientObj._id+"_PivotGridToolbar"):[],s,a,i,u,e,f,l;if(this.element.find(".values").width()>this.element.find(".pivotGridRowTable").width()&&this.element.find(".pivotGridRowTable").width(this.element.find(".values").width()),this.element.find(".pivotGridValueTable .value:visible").length>0){if(this.element.find(".pivotGridFrozenTable").height(this.element.find(".colfreeze").height()),!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders){if(this._removeFrozenBorders(),this.element.find(".headerContent").width(this.element.width()),this.element.find(".colfreeze").css({width:this.element.find(".pivotGridRowTable").width(),float:this.model.enableRTL?"right":"left"}),this.element.find(".pivotGridFrozenTable").height()>this.element.find(".colfreeze").height()?this.element.find(".colfreeze").height(this.element.find(".pivotGridFrozenTable").height()):this.element.find(".pivotGridFrozenTable").height(this.element.find(".colfreeze").height()),this.element.find(".valueCell").css({display:"inline-block",width:this.element.width()-this.element.find(".pivotGridRowTable").width()}),this.element.find(".pivotGridValueTable, .pivotGridFrozenTable").css({width:"100%","table-layout":"fixed"}),this.element.find(".headerContent").css({position:"relative",overflow:"hidden"}),this.element.find(".colmovable").css({display:"inline",position:"relative",overflow:"hidden"}),this.element.find(".headerContent").height(this.element.find(".headerTable").height()),f=0,i=0,this.element.find(".pivotGridValueTable").height()>0){var a=this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0,v=this.element.find(".headerContent").height(),y=this.element.find(".valueCell").height(),u=v+y+a,e=this.element.height(),o=this.element.find(".e-pivotGridTable").width(),s=this.element.find(".pivotGridValueTable").width()+this.element.find(".pivotGridRowTable").width();r&&(n(c).css("overflow","hidden"),e=n(c).height(),s=this.element.find(".pivotGridValueTable").width()+this.element.find(".pivotGridRowTable").width(),o=n(c).width());f=(e>u?u:e)-v-a;i=o>s?s:o;r&&(this.element.find(".valueCell").width(n(c).width()-this.element.find(".pivotGridRowTable").width()-5),i=this.element.find(c).width()-3,i<0&&(i=200))}this.element.find("#rowvaluecontent").ejScroller({scroll:this._applyScroll,scrollerSize:h,width:i,height:f,targetControl:this,enableRTL:this.model.enableRTL});this.model.enableRTL&&this.element.find(".rowhead").css({float:this.model.enableRTL?"right":"left"});this.element.find(".e-vscrollbar").length>0&&(this.element.find(".valueCell").width(this.element.find(".valueCell").width()-h),this.element.find(".headerContent").width(this.element.find(".headerContent").width()-(r?28.5:18)));this.element.find(".headerTable").css({display:"inline-block",width:this.element.find(".valueCell").width()});this.model.enableGroupingBar&&(this.element.find(" .groupingBarPivot").width("100%"),l=this.element.find(".pivotGridRowTable").width(),this.element.find(".e-grpRow ,.values").width(l),this.element.find(".rowhead").width()<this.element.find(".colfreeze").width()&&(this.element.find(".colfreeze").width(this.element.find(".rowhead").width()),this.element.find(".columns").width("auto")),this.element.find(".columns").css({height:"auto",width:"calc(100% -  "+this.element.find(".values").width()+")"}))}else if(this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders){if(this._removeFrozenBorders(r),a=this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0,this.element.find(".pivotGridValueTable, .pivotGridFrozenTable").css({width:"100%","table-layout":"fixed"}),this.element.find(".colfreeze").height(this.element.find(".pivotGridFrozenTable").height()),this.element.find(".colhead").css("overflow","visible"),f=0,i=0,this.element.find(".pivotGridValueTable").height()>0){u=this.element.height();r&&(u=n(c).height()-5);var e=this.element.find(".rowHeaderArea").height(),s=this.element.width()-this.element.find(".headerContent").width(),o=this.element.find(".pivotGridValueTable").width();i=o>s?s:o;f=(e>u?u:e)-a;r&&i<0&&(i=200)}this.element.find(".pivotGridRowTable").css({width:"100%","table-layout":"fixed"});this.element.find("#rowvaluecontent").ejScroller({scrollerSize:h,scroll:this._applyScroll,width:i,height:f,targetControl:this,enableRTL:this.model.enableRTL});this.element.find(".headerContent").css({height:this.element.find("#rowvaluecontent").height(),overflow:"hidden","border-right":"0px"});this.element.find(".rowhead").css("padding-bottom",this.element.find("#rowvaluecontent .e-hscrollbar").length>0?h:"0px");this.model.enableGroupingBar&&(this.element.find(" .groupingBarPivot,.colfreeze").width("100%"),l=this.element.find(".pivotGridRowTable").width(),this.element.find(".e-grpRow ,.values").width(l),this.element.find(".columns").width(this.element.find(".valueColumn").width()-this.element.find(".values").width()-5),this.element.find(".columns").css("height","auto"))}else{this._removeFrozenBorders();this.element.find(".rowhead").css({overflow:"hidden",width:this.element.find(".pivotGridRowTable").width()});u=this.element.height()-(this.element.find(".colhead").outerHeight()+(this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0));r&&(u=n(c).outerHeight()-(this.element.find(".colhead").outerHeight()+(this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0)));e=this.element.find(".pivotGridValueTable").height();this.element.find(".rowhead").height(e>u?u:e);this.element.find(".colfreeze").width(this.element.find(".pivotGridRowTable").width());this.element.find(".pivotGridFrozenTable, .pivotGridValueTable").css({width:"100%","table-layout":"fixed"});var s=this.element.width()-this.element.find(".pivotGridRowTable").width()-3,o=this.element.find(".pivotGridValueTable").width(),i=o>s?s:o,f=this.element.find(".rowhead").height()+(o>s?h:0);r&&(this.element.find(".rowhead").height(this.element.find(".rowhead").height()-10),this.element.find(".rowhead, .colfreeze").width(this.element.find(".pivotGridRowTable").width()-5),f=this.element.find(".rowhead").height(),i<0&&(i=200));this.element.find("#rowvaluecontent").ejScroller({scroll:this._applyScroll,width:i,height:f,targetControl:this,scrollerSize:h,enableRTL:this.model.enableRTL});r&&this.element.find(".rowhead, .pivotGridRowTable").width("100%");this.element.find(".colmovable").width(this.element.find(".valueCell").width());this.element.find("#rowvaluecontent .e-hscrollbar").length>0?(this.element.find(".rowhead").css("margin-bottom",h),this.element.find(".rowhead").addClass("frozenBorderBtmClr")):(this.element.find(".rowhead").css("margin-bottom","0px"),this.element.find(".rowhead").removeClass("frozenBorderBtmClr"));this.element.find(".colhead , .colfreeze").height(this.element.find(".pivotGridFrozenTable").height());this.element.find(".e-rows").height()>this.element.find(".colfreeze").height()&&this.element.find(".colmovable .colhead .pivotGridFrozenTable thead tr,.colfreeze").height(this.element.find(".e-rows").height()+15);this.element.find(".pivotGridFrozenTable").height("100%");this.element.find(".rowhead").height(this.element.find(".valueCell").height());this.element.find(".e-scroller .e-hscroll").length!=0||this.model.enableVirtualScrolling||this.element.find(".e-scroller").height("auto");this.model.enableGroupingBar&&(l=this.element.find(".pivotGridRowTable").width(),this.element.find(".e-grpRow ,.values").width(l),this._refreshGroupingBarLayout())}this.element.find(".rowhead").scrollTop(0);this.element.find(".groupingBarPivot ").width(this.element.find(".e-pivotGridTable").width())}else n(this.element).css("overflow","auto"),this.element.find(".headerTable").css("display","inline-block"),this.element.find(".valScrollArea").css("height","100%")},_removeFrozenBorders:function(t){var f=this.model.enableRTL,r=this.element,u,e,o;if(t&&(u=t?n("#"+this._pivotClientObj._id+"_PivotGridToolbar"):[],n(u).css("overflow","hidden"),u.width()<this.element.find(".pivotGridRowTable").width()&&n(u).css("overflow","auto"),u.height()<this.element.find(".e-pivotGridTable").height()&&n(u).css("overflow","auto")),this.model.frozenHeaderSettings.enableFrozenHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders){for(r.find(".colhead").css({"border-right":"1px solid rgb(200, 200, 200)"}),r.find(".pivotGridRowTable, .pivotGridRowTable tr td:first-child").css({"border-collapse":"collapse","border-spacing":"0"}),r.find(".pivotGridRowTable tr td:last-child").css({"border-collapse":"collapse","border-spacing":"0"}),r.find(".pivotGridValueTable, .pivotGridValueTable tr td:first-child").css({"border-collapse":"collapse","border-spacing":"0"}),r.find(".pivotGridFrozenTable,  .pivotGridFrozenTable tr:nth-child(1) td").css({"border-collapse":"collapse"," border-spacing":"0","border-top":"0px"}),r.find(".colfretable .e-grpRow").css({"border-top":"0px"}),r.find(".pivotGridValueTable tr:visible:eq(0) td, .pivotGridRowTable tr:visible:eq(0) td").css("border-top","0px"),f?(r.find(".pivotGridRowTable, .pivotGridRowTable tr td:first-child").css({"border-right":"0px"}),r.find(".pivotGridRowTable tr td:last-child").css({"border-left":"0px"}),r.find(".pivotGridValueTable, .pivotGridValueTable tr td:first-child").css({"border-right":"0px"}),r.find(".colfretable .e-grpRow").css({"border-right":"0px","border-left":"0px"})):(r.find(".pivotGridRowTable, .pivotGridRowTable tr td:first-child").css({"border-left":"0px"}),r.find(".pivotGridRowTable tr td:last-child").css({"border-right":"0px"}),r.find(".pivotGridValueTable, .pivotGridValueTable tr td:first-child").css({"border-left":"0px"}),r.find(".colfretable .e-grpRow").css({"border-left":"0px","border-right":"0px"})),e=r.find(".pivotGridValueTable tr").length,i=0;i<e;i++)f?(r.find(".pivotGridValueTable tr:eq("+i+") td:visible:eq(0)").css("border-right","0px"),r.find(".pivotGridValueTable tr:eq("+i+") td:visible:last").css("border-left","0px")):(r.find(".pivotGridValueTable tr:eq("+i+") td:visible:eq(0)").css("border-left","0px"),r.find(".pivotGridValueTable tr:eq("+i+") td:visible:last").css("border-right","0px"));for(r.find(".pivotGridFrozenTable td").css("border-bottom","0px"),o=this.element.find(".pivotGridFrozenTable tr").length,i=0;i<o;i++)f?(r.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:eq(0)").css("border-right","0px"),r.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:last").css("border-left","0px")):(r.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:eq(0)").css("border-left","0px"),r.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:last").css("border-right","0px"));r.find(".pivotGridRowTable tr:visible:last td").css("border-bottom","0");r.find(".pivotGridValueTable tr:visible:last td").css("border-bottom","0")}else this.element.find(".pivotGridFrozenTable tr:first td").css("border-top","0px"),this.element.find(".pivotGridRowTable tr td:first-child").css(this.model.enableRTL?"border-right":"border-left","0px"),this.element.find(".pivotGridRowTable tr td:last-child").css(this.model.enableRTL?"border-left":"border-right","0px"),this.element.find(".pivotGridFrozenTable tr:last td").css("border-bottom","0px"),!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders?(this.element.find(".pivotGridFrozenTable tr td:first-child").css(this.model.enableRTL?"border-right":"border-left","0px"),this.element.find(".pivotGridValueTable tr:last td").css("border-bottom","0px"),this.element.find(".pivotGridValueTable tr td:visible:eq(0)").attr("p")&&this.element.find(".pivotGridValueTable tr td[p^='"+this.element.find(".pivotGridValueTable tr td:visible:eq(0)").attr("p").split(",")[0]+",']").css(this.model.enableRTL?"border-right":"border-left","0")):this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&(this.element.find(".pivotGridRowTable  tr:eq(0) td").css("border-top","0px"),this.element.find(".pivotGridValueTable tr:eq(0) td").css("border-top","0px"))},_applyScroll:function(){this.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.targetControl.model.frozenHeaderSettings.enableFrozenHeaders&&!this.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders?(this.isVScroll()&&this.model.targetControl.element.find(".rowhead").scrollTop(this.model.scrollTop),this.isHScroll()&&this.model.targetControl.element.find(".colhead").scrollLeft(this.model.scrollLeft)):!this.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders?this.isHScroll()&&this.model.targetControl.element.find(".colhead").scrollLeft(this.model.scrollLeft):this.isVScroll()&&this.model.targetControl.element.find(".headerContent").scrollTop(this.model.scrollTop)},_setGroupingBarFrozenRowBtnWidth:function(){var u,o,s;(this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders&&!(this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders))&&this.element.find(".pivotGridRowTable").outerWidth()>=this.element.find(".e-grpRow").outerWidth()&&this.element.find(".pivotGridRowTable").css("min-width",this.element.find(".e-grpRow").outerWidth());this.element.find(".e-grpRow .e-removeBtn, .e-grpRow .filter, .e-grpRow .e-sorting ").css("position","inherit");this.element.find(".colfreeze .e-pivotButton").width("auto");var r=this.element.find(".pivotGridRowTable").width(),i=this.element.find(".colfreeze .e-pivotButton"),t=r/i.length;if(r<t&&(t=r-40),this.element.find(".e-rows").width()>r){var h=t*i.length,f=0,e=0;n.each(this.element.find(".e-rows .e-pivotButton"),function(t,i){f+=n(i).width()});n.each(this.element.find(".e-rows .e-pivotButton .e-pvtBtn"),function(t,i){e+=n(i).width()});u=(f-e)/i.length;t-u<40&&(t=u+40,h=t*i.length);this.element.find(".e-rows .e-pivotButton").width(t-20);this.element.find(".e-rows .e-pvtBtn").css({width:t-10-u,"text-overflow":"ellipsis"});this.element.find(".e-rows").css({"white-space":"nowrap"});o=this.element.find(".colfreeze .e-pivotButton:eq(0)").outerWidth();s=o*i.length+30;this.element.find(".pivotGridRowTable,.rowhead,.colfreeze table,.valueColumn span.values").width(s)}},_refreshGroupingBarLayout:function(){this.element.find(".e-pivotGridTable .value").length>0||this.element.find(".e-pivotGridTable .colheader").length>0?this.element.find(".groupingBarPivot ").width(this.element.find(".e-pivotGridTable").width()):this.element.find(".pivotGridRowTable").length>0?this.element.find(".groupingBarPivot ").width(this.element.find(".pivotGridRowTable").width()+140):this.element.find(".groupingBarPivot ").width(330);var n=this.element.find(".pivotGridRowTable").width();this.element.find(".e-grpRow ,.values").width(n);this.element.find(".columns").css({height:"auto",width:this.element.find(".valueColumn").width()-this.element.find(".values").width()-1});this._setGroupingBarFrozenRowBtnWidth()},_cellRangeInfo:function(i){var y=n(i.target).parents(".e-pivotgrid").data("ejPivotGrid"),p=n(this.element).parents(".e-pivotclient").length>0||n(this.element).parents(".e-maximumView").length>0,d,c,a,f,e,o,r,l,k;p&&this._pivotClientObj.model.enableDrillThrough&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&(this._dataSet=this._pivotClientObj.dataSet);n(i.target).hasClass("cellValue")&&(i.target=i.target.parentElement);var g=n("thead tr").length,s=[],b=0,u=n.grep(this.getJSONRecords(),function(t){return(t.CSS.indexOf("colheader")>-1||t.CSS.indexOf("summary cstot")>-1||t.CSS.indexOf(" calc")>-1)&&t.CSS.indexOf("colheader calc")==-1&&t.Index.split(",")[0]==n(i.target).attr("data-p").split(",")[0]}),h=n.grep(this.getJSONRecords(),function(t){return(t.CSS.indexOf("rowheader")>-1||t.CSS.indexOf("summary rstot")>-1)&&t.Index.split(",")[1]==n(i.target).attr("data-p").split(",")[1]});if(h.length==1&&u.length==1&&(h[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0||u[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0||u[0].CSS.indexOf(" calc")>-1))if(d=[],(u[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0||u[0].CSS.indexOf(" calc")>-1)&&h[0].Value.toString().indexOf("Grand")>=0)for(r=0;r<this.model.dataSource.data.length;r++)s[r]=this.model.dataSource.data[r];else for(h[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0?c=u[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0?u[0].Value.replace(" "+this._getLocalizedLabels("Total"),""):u[0].Value:(u[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0||u[0].CSS.indexOf(" calc")>-1)&&(c=h[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0?h[0].Value.replace(" "+this._getLocalizedLabels("Total"),""):h[0].Value),r=0;r<y.model.dataSource.data.length;r++)n.each(y.model.dataSource.data[r],function(n,t){t==c&&(s[b]=y.model.dataSource.data[r],b++)});else if(h.length>=1&&u.length>=1&&(h[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0||u[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0)){for(h[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0?(c=u,a=h):u[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0&&(c=h,a=u),f=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this.model.dataSource.data:this._dataSet.length>0?JSON.parse(this._dataSet):[],e=c.length-1;e>=0;e--){for(o=[],r=0;r<f.length;r++)n.each(f[r],function(n,t){t==c[e].Value&&o.push(f[r])});f=o}if(s=o,a[0].Value.toString().indexOf("Grand")<=0)for(o=[],r=0;r<f.length;r++)n.each(f[r],function(n,t){t==a[0].Value.replace(" Total","")&&(s=[],o.push(f[r]))});s=s.length==0?o:s}else{var w=h,v=u,f=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this.model.dataSource.data:this._dataSet.length>0?JSON.parse(this._dataSet):[];for(e=w.length-1;e>=0;e--){for(o=[],r=0;r<f.length;r++)n.each(f[r],function(n,t){(t==w[e].Key||t==w[e].Value)&&o.push(f[r])});f=o}for(e=v.length-1;e>=0;e--)if(v[e].CSS.indexOf("calc")==-1){for(o=[],r=0;r<f.length;r++)n.each(f[r],function(n,t){(t==v[e].Key||t==v[e].Value)&&o.push(f[r])});f=o}s=s.length==0?o:s}l={selectedData:s?s:[],element:this.element,customObject:this.model.customObject};this.model.enableCellDoubleClick&&this.model.enableCellDoubleClick!=null&&i.type=="dblclick"&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellDoubleClick",l):this._pivotClientObj._trigger("cellDoubleClick",l));this.model.enableCellClick&&this.model.enableCellClick!=null&&i.type=="click"&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellClick",l):this._pivotClientObj._trigger("cellClick",l));(this.model.enableDrillThrough||p&&this._pivotClientObj.model.enableDrillThrough)&&s.length>0&&(k=p&&this._pivotClientObj.model.enableDrillThrough?this._pivotClientObj:this,k._trigger("drillThrough",l))},_initCellEditing:function(i){if(i.target.tagName=="INPUT"||n(i.target).hasClass("summary")||n(i.target).parent().hasClass("summary"))this._off(this.element,"mouseup",".value",this._completeCellEditing);else{this._on(this.element,"mouseup",".value",this._completeCellEditing);var r;this._oriX=i.pageX;this._oriY=i.pageY;r=i.target||window.event.srcElement;n(r).hasClass("cellValue")&&(r=n(r).parent()[0]);n(".value").addClass("selection");n("#"+this._id).append(t.buildTag("div.e-cellSelection#"+this._id+"_cellSelection","",{}));this._startCellPosition=n(r)[0].attributes.getNamedItem("data-p").value;this._on(this.element,"mousemove",".value, .e-cellSelection",this._cellSelection)}},_completeCellEditing:function(i){var a,l,w=[],s,y,h,ut,e,o,g,p,v,f,c,u,ct,lt,tt,it,rt;if(i.target.tagName!="INPUT"){if(this._off(this.element,"mousemove",".value"),n(".value").removeClass("selection"),a=i.target||window.event.srcElement,n(a).hasClass("cellValue")&&(a=n(a).parent()[0]),l=n(a)[0].attributes.getNamedItem("data-p").value,h=0,ut=this.element.find(".curInput"),ut.length>0)return n(a).find(".curInput").length==0&&this._updateTableCell(),n("#"+this._id+"_cellSelection").remove(),this.model.enableToolTip&&this._on(this.element,"mousemove",".value",this._applyToolTip),this._off(this.element,"mouseup",".value"),!1;for(e=parseInt(this._startCellPosition.split(",")[1])<parseInt(l.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(l.split(",")[1]);e<=(parseInt(this._startCellPosition.split(",")[1])>parseInt(l.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(l.split(",")[1]));e++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||n("#"+this._id).find("td[data-p*=',"+e+"']").parent().is(":visible"))for(o=parseInt(this._startCellPosition.split(",")[0])<parseInt(l.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(l.split(",")[0]);o<=(parseInt(this._startCellPosition.split(",")[0])>parseInt(l.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(l.split(",")[0]));o++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||n("#"+this._id).find("[data-p*='"+o+",']").last("th").is(":Visible")||!this.model.enableGrandTotal||!this.model.enableRowGrandTotal){w[h]=this.getJSONRecords()[o*this._rowCount+e];this.element.find("[data-p='"+o+","+e+"']").hasClass("summary")||(this.element.find("[data-p='"+o+","+e+"'] span.cellValue").length>0?(g=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.element.find("[data-p='"+o+","+e+"'] span.cellValue").text()!=""?this.element.find("[data-p='"+o+","+e+"'] span.cellValue").text():this.element.find(".curInput").val():this.element.find("[data-p='"+o+","+e+"'] span.cellValue").text(),this.element.find("[data-p='"+o+","+e+"'] span.cellValue").html("<input type='text' class='curInput' value='"+g+"' />")):this.element.find("[data-p='"+o+","+e+"']").children().length>0?this.element.find("[data-p='"+o+","+e+"']").append("<input type='text' class='curInput' value='' />"):(g=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.element.find("[data-p='"+o+","+e+"']").text()!=""?this.element.find("[data-p='"+o+","+e+"']").text():this.element.find(".curInput").val():this.element.find("[data-p='"+o+","+e+"']").text(),this.element.find("[data-p='"+o+","+e+"']").html("<input type='text' class='curInput' value='"+g+"' />")));var b,k="",ot,st,ft=0;if(s=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this.element.find(".summary[role!='gridcell'][data-p$=',"+n(a).attr("data-p").split(",")[1]+"'] , .rowheader[role!='gridcell'][data-p$=',"+n(a).attr("data-p").split(",")[1]+"']").last().attr("data-p"):this.element.find(".summary[role!='gridcell'][data-p$=',"+e+"'] , .rowheader[role!='gridcell'][data-p$=',"+e+"']").last().attr("data-p"),s==r&&(s=n("#"+this._id).find("tbody").find('[data-p="'+o+","+e+'"]').parent("tr").find(".summary").first().attr("data-p")),ot=s,s!=null){while(s[0]>=0)s==this.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*this._rowCount+parseInt(s.split(",")[1]))].Index&&(b=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*this._rowCount+parseInt(s.split(",")[1]))].Info.split("::")[0]:this.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*this._rowCount+parseInt(s.split(",")[1]))].Value,s=parseInt(s.split(",")[0])-1+","+parseInt(s.split(",")[1])),k&&b!=""?k=b+"#"+k:b!=""&&(k=b);if(this._rowHeader[h]=k,f=this._rowHeader[h].toString().split("#"),f.length>1){for(u=0;u<f.length-1;u++)for(c=0;c<f[u].split(".").length;c++)if(f[u].split(".")[c]==f[u+1].split(".")[c]&&f[u].split(".")[c+1]==f[u+1].split(".")[c+1]){f.splice(u,1);break}for(this._rowHeader[h]="",u=0;u<f.length;u++)this._rowHeader[h]+=this._rowHeader[h]==""?f[u]:"#"+f[u]}}var d="",nt,ht=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,et=this.element.find((ht?".pivotGridFrozenTable ":"")+'tr:has(".colheader")').length-1;for(st=et,y=w[h].Index,y!=r&&y==this.getJSONRecords()[parseInt(parseInt(y.split(",")[0])*this._rowCount+parseInt(y.split(",")[1]))].Index&&(p=parseInt(y.split(",")[0])),v=0;v<=et;v++)p!=null&&p+","+v==this.getJSONRecords()[parseInt(parseInt(p)*this._rowCount+v)].Index&&(nt=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.getJSONRecords()[parseInt(parseInt(p)*this._rowCount+v)].Info.split("::")[0]:this.getJSONRecords()[parseInt(parseInt(p)*this._rowCount+v)].Value,d==""?d=nt:nt!=""&&(d=d+"#"+nt)),this._colHeader[h]=d;if(f=this._colHeader[h].split("#"),f.length>1){for(u=0;u<f.length-1;u++)for(c=0;c<f[u].split(".").length;c++)if(f[u].split(".")[c]==f[u+1].split(".")[c]&&f[u].split(".")[c+1]==f[u+1].split(".")[c+1]){f.splice(u,1);break}for(this._colHeader[h]="",u=0;u<f.length;u++)this._colHeader[h]+=this._colHeader[h]==""?f[u]:"#"+f[u]}h++}for(this._originalValue="",this._cellInfo=w,tt=0;tt<this.element.find(".curInput").length;tt++)it=this.element.find(".curInput")[tt],this._originalValue+=this._originalValue==""?it.value:"#"+it.value;rt={JSONRecords:w,rowHeader:this._rowHeader,columnHeader:this._colHeader,measureCount:ft>0?"Row:"+ft:"Column:0"};t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",rt):this._pivotClientObj._trigger("cellSelection",rt);w=lt=ct=[];n("#"+this._id+"_cellSelection").remove();this.model.enableToolTip&&this._on(this.element,"mousemove",".value",this._applyToolTip);this._off(this.element,"mouseup",".value")}this.element.find(".curInput").keypress(function(i){if(i.which==13){var r=n(i.target).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(r)||r._updateTableCell()}})},_updateTableCell:function(){var r="",f="",e=this.element.find(".curInput"),u,a,o,d,h,p,i;n.each(e,function(n,t){r+=n==0?t.value:"#"+t.value});var w=[],c=this._rowHeader,l=this._colHeader;for(f=r.split("#"),u=f.length-1;u>=0;u--)f[u]==this._originalValue.split("#")[u]?(c.splice(u,1),l.splice(u,1),f.splice(u,1),this._cellInfo.splice(u,1)):(w.push(this._originalValue.split("#")[u]),t.isNullOrUndefined(this._cellInfo[u])||(this._cellInfo[u].Value=f[u]=f[u]==""?"":f[u]));for(w=w.reverse(),r="",i=0;i<f.length;i++)r+=r==""?f[i]:"#"+f[i];if(r.length==0){for(i=e.length-1;i>=0;i--)n(e[i]).closest("td").text(this.element.find(".curInput")[i].value);return!1}if(this._waitingPopup.show(),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)try{a=JSON.parse(this.getOlapReport()).Report}catch(nt){a=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){(t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)||this.model.editCellsInfo.JSONRecords.length==0)&&(this.model.editCellsInfo={JSONRecords:[],rowHeader:[],columnHeader:[]});var g=this.model.editCellsInfo.rowHeader,s=this.model.editCellsInfo.columnHeader,b=this.model.editCellsInfo.JSONRecords,k=this._cellInfo;for(o=0;o<k.length;o++){for(d=0,h=0;h<b.length;h++)if(g[h]==c[o]&&s[h]==l[o]){b[h].Value=k[o].Value;d++;break}d==0&&(g.push(c[o]),s.push(l[o]),b.push(k[o]))}if(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}):this._pivotClientObj._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}),!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0)if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){var r="",v="",y="";for(n.each(this.model.editCellsInfo.JSONRecords,function(n,t){r=r==""?t.Value:r+":"+t.Value;v=v==""?t.Index:v+":"+t.Index;y=y==""?s[n].toString().split("#")[s[n].toString().split("#").length-1]:y+":"+s[n].toString().split("#")[s[n].toString().split("#").length-1]}),p=JSON.stringify({action:"cellEditing",index:v,valueHeaders:y,summaryValues:r,currentReport:a,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.cellEditing,p,this._renderControlSuccess),i=e.length-1;i>=0;i--)n(e[i]).closest("td").text(n(e[i]).val())}else this._populatePivotGrid();else{for(i=e.length-1;i>=0;i--)n(e[i]).closest("td").text(t.isNullOrUndefined(this._originalValue.split("#")[i])?"":this._originalValue.split("#")[i]);this._waitingPopup.hide()}}else if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)if(this.model.beforeServiceInvoke!=null&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"writeBack",element:this.element}),this.model.editCellsInfo.JSONRecords=this._cellInfo,this.model.editCellsInfo.rowHeader=c,this.model.editCellsInfo.columnHeader=l,t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}):this._pivotClientObj._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}),r="",!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0&&n.each(this.model.editCellsInfo.JSONRecords,function(n,t){r=r==""?t.Value:r+":"+t.Value}),p=JSON.stringify({action:"writeBack",value:r,rowUniqueName:JSON.stringify(this.model.editCellsInfo.rowHeader),columnUniqueName:JSON.stringify(this.model.editCellsInfo.columnHeader),currentReport:a,customObject:JSON.stringify(this.model.customObject)}),!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0)this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.writeBack,p,this._renderControlSuccess);else{for(i=e.length-1;i>=0;i--)n(e[i]).closest("td").text(t.isNullOrUndefined(this._originalValue.split("#")[i])?"":this._originalValue.split("#")[i]);this._waitingPopup.hide()}this._rowHeader=[];this._colHeader=[]},_createVirtualPivotGrid:function(n){var u=this._seriesPageCount>1?t.buildTag("div.e-vScrollPanel")[0].outerHTML:"",f=this._categPageCount>1?t.buildTag("div.e-hScrollPanel")[0].outerHTML:"",e=t.buildTag("td.virtualScrollGrid",n[0].outerHTML)[0],o=t.buildTag("td.virtualScrollElement",u),s=t.buildTag("td.virtualScrollElement",f),h=t.buildTag("tr.virtualScrollElement",e.outerHTML+o[0].outerHTML),c=t.buildTag("tr.virtualScrollElement",s[0].outerHTML+t.buildTag("td.virtualScrollElement")[0].outerHTML),l=t.buildTag("tbody.oGridOuterDiv.virtualScrollElement",h[0].outerHTML+c[0].outerHTML),i,r;this.element.html(t.buildTag("table.virtualScrollElement",l[0].outerHTML));i=t.buildTag("div.e-seriesPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("SeriesPage"))[0].outerHTML+t.buildTag("span.series_CurrentPage",this._seriesCurrentPage)[0].outerHTML+" / "+t.buildTag("span.series_pageCount",this._seriesPageCount)[0].outerHTML)[0].outerHTML;this._seriesPageCount>1&&this.element.append(i);r=t.buildTag("div.e-categPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("CategoricalPage"))[0].outerHTML+t.buildTag("span.categ_CurrentPage",this._categCurrentPage)[0].outerHTML+" / "+t.buildTag("span.categ_pageCount",this._categPageCount)[0].outerHTML)[0].outerHTML;this._categPageCount>1&&this.element.append(r)}});t.PivotGrid.Layout={Normal:"normal",NormalTopSummary:"normaltopsummary",NoSummaries:"nosummaries",ExcelLikeLayout:"excellikelayout"};t.PivotGrid.Locale=t.PivotGrid.Locale||{};t.PivotGrid.Locale["en-US"]={Sort:"Sort",Search:"Search",SelectField:"Select field",LabelFilterLabel:"Show the items for which the label",ValueFilterLabel:"Show the items for which",ClearSorting:"Clear Sorting",ClearFilterFrom:"Clear Filter From",SortAtoZ:"Sort A to Z",SortZtoA:"Sort Z to A",and:"and",LabelFilters:"Label Filters  ",BeginsWith:"Begins With",DoesNotBeginsWith:"Does Not Begin With",EndsWith:"Ends With",NotEndsWith:"Not Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",ValueFilters:"Value Filters",ClearFilter:"Clear Filter",Equals:"Equals",DoesNotEquals:"Does Not Equal",NotEquals:"Not Equals",GreaterThan:"Greater Than",IsGreaterThan:"Is Greater Than",IsGreaterThanOrEqualTo:"Is Greater Than Or Equal To",IsLessThan:"Is Less Than",IsLessThanOrEqualTo:"Is Less Than Or Equal To",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Top10:"Top Count",AddToFilter:"Add to Filter",AddToRow:"Add to Row",AddToColumn:"Add to Column",AddToValues:"Add to Values",Warning:"Warning",Error:"Error",GroupingBarAlertMsg:"The field you are moving cannot be placed in that area of the report",Measures:"Measures",Expand:"Expand",Collapse:"Collapse",ToolTipRow:"Row",ToolTipColumn:"Column",ToolTipValue:"Value",NoValue:"No value",SeriesPage:"Series Page",CategoricalPage:"Categorical Page",DragFieldHere:"Drag field here",ColumnArea:"Drop column here",RowArea:"Drop row here",ValueArea:"Drop values here",Close:"Close",OK:"OK",Cancel:"Cancel",Remove:"Remove",Goal:"Goal",Status:"Status",Trend:"Trend",Value:"Value",ConditionalFormattingErrorMsg:"The given value is not matched",ConditionalFormattingConformMsg:"Are you sure you want to remove the selected format?",EnterOperand1:"Enter Operand1",EnterOperand2:"Enter Operand2",ConditionalFormatting:"Conditional Formatting",Condition:"Conditional Type",Value1:"Value1",Value2:"Value2",Editcondtion:"Edit Condition",AddNew:"Add New",Format:"Format",Fontcolor:"Font Color",Backcolor:"Back Color",Borderrange:"Border Range",Borderstyle:"Border Style",Fontsize:"Font Size",Fontstyle:"Font Style",Bordercolor:"Border Color",NoMeasure:"Please add any measure",Solid:"Solid",Dashed:"Dashed",Dotted:"Dotted",Double:"Double",Groove:"Groove",Inset:"Inset",Outset:"Outset",Ridge:"Ridge",None:"None",Algerian:"Algerian",Arial:"Arial",BodoniMT:"Bodoni MT",BritannicBold:"Britannic Bold",Cambria:"Cambria",Calibri:"Calibri",CourierNew:"Courier New",DejaVuSans:"DejaVu Sans",Forte:"Forte",Gerogia:"Gerogia",Impact:"Impact",SegoeUI:"Segoe UI",Tahoma:"Tahoma",TimesNewRoman:"Times New Roman",Verdana:"Verdana",CubeDimensionBrowser:"Cube Dimension Browser",SelectHierarchy:"Select Hierarchy",CalculatedField:"Calculated Field",Name:"Name:",Add:"Add",Formula:"Formula:",Delete:"Delete",Fields:"Fields:",MultipleItems:"Multiple items",All:"All",CalculatedFieldNameNotFound:"Given CalculatedField name is not found",InsertField:"Insert Field",EmptyField:"Please enter Calculated field name or formula",NotValid:"Given formula is not valid",NotPresent:"Value field used in any of the Calculated Field formula is not present in the PivotGrid",Confirm:"Calculated field with the same name already exists. Do you want to Replace ?",CalcValue:"Calculated field can be inserted only in value area field",NoRecordsToDisplay:"No records to display.",NumberFormatting:"Number Formatting",FrozenHeaders:"Frozen Headers",CellSelection:"Cell Selection",CellContext:"Cell Context",ColumnResize:"Column Resize",Layouts:"Layouts",ExcelLikeLayout:"Excel Like Layout",NormalLayout:"Normal Layout",NormalTopSummary:"NormalTopSummary Layout",NoSummaries:"NoSummaries Layout",FrozenHeader:"Frozen Header",AdvancedFiltering:"Advanced Filtering",Amount:"Amount",Quantity:"Quantity",Measures:"Measures",NumberFormats:"Number Formats",Exporting:"Exporting",FileName:"File Name",ToolTip:"Tool Tip",RTL:"RTL",CollapseByDefault:"Collapse By Default",EnableDisablePaging:"Enable / Disable Paging",PagingOptions:"Paging Options",CategoricalPageSize:"Categorical Page Size",SeriesPageSize:"Series Page Size",HyperLink:"HyperLink",CellEditing:"Cell Editing",GroupingBar:"Grouping Bar",SummaryCustomization:"Summary Customization",SummaryTypes:"Summary Types",SummaryType:"Summary Type",EnableRowHeaderHyperlink:"Enable RowHeaderHyperLink",EnableColumnHeaderHyperlink:"Enable ColumnHeaderHyperLink",EnableValueCellHyperlink:"Enable ValueCellHyperLink",EnableSummaryCellHyperlink:"Enable SummaryCellHyperLink",HideGrandTotal:"Hide GrandTotal",HideSubTotal:"Hide SubTotal",Row:"Row",Column:"Column",Both:"Both",Sum:"Sum",Average:"Average",Count:"Count",Min:"Min",Max:"Max",Excel:"Excel",Word:"Word",PDF:"PDF",CSV:"CSV",Total:"Total",GrandTotal:"Grand Total",DrillThrough:"Drill Through",EnabledState:"Enabled State",Months:"Months",Days:"Days",Quarters:"Quarters",Years:"Years",Qtr:"Qtr",Quarter:"Quarter",AddCurrentSelectionToFilter:"Add current selection to filter",FormatName:"Format Name",RemoveFormat:"Remove Format",Edit:"Edit",DuplicateFormatName:"Duplicate Format Name",EnterFormatName:"Enter Format Name",NotAllItemsShowing:"Not all child nodes are shown",EditorLinkPanelAlert:"The members have more than 1000 items under one or more parent. Only the first 1000 items are displayed under each parent.",Exception:"Exception"};t.PivotGrid.ExportOptions={Excel:"excel",Word:"word",PDF:"pdf",CSV:"csv"};t.PivotGrid.ConditionalOptions={Equals:"Equals",NotEquals:"Not Equals",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between"};t.PivotGrid.AnalysisMode={Olap:"olap",Relational:"relational"};t.PivotGrid.ExportMode={JSON:"json",PivotEngine:"pivotengine"};t.PivotGrid.OperationalMode={ClientMode:"clientmode",ServerMode:"servermode"};t.olap.base&&n.extend(t.PivotGrid.prototype,t.olap.base);t.olap._mdxParser&&n.extend(t.PivotGrid.prototype,t.olap._mdxParser)})(jQuery,Syncfusion)});
