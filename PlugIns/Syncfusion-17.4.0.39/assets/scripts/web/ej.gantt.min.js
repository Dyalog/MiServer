/*!
*  filename: ej.gantt.min.js
*  version : 17.4.0.39
*  Copyright Syncfusion Inc. 2001 - 2019. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./ej.treegrid.min","./../common/ej.globalize.min","jsrender","./../common/ej.core.min","./../common/ej.touch.min","./../common/ej.data.min","./../common/ej.draggable.min","./../common/ej.scroller.min","./ej.button.min","./ej.splitter.min","./ej.dialog.min","./ej.datepicker.min","./ej.datetimepicker.min","./ej.checkbox.min","./ej.dropdownlist.min","./ej.editor.min","./ej.maskedit.min","./ej.toolbar.min","./ej.tooltip.min","./ej.tab.min","./ej.rte.min"],n):n()})(function(){(function(n,t,i){"use strict";t.ganttFeatures=t.ganttFeatures||{};t.ganttFeatures.predecessor={UpdatePredecessor:function(){var n=this;n._updatedRecordsDateByPredecessor();n._$ganttchartHelper.ejGanttChart("clearConnectorLines");n._connectorLinesCollection=[];n._createConnectorLinesCollection();n._$ganttchartHelper.ejGanttChart("renderConnectorLines",n._connectorLinesCollection)},_refreshConnectorLines:function(n,i,r){this.model.viewType!="resourceView"&&(this._isValidationEnabled=t.isNullOrUndefined(n)?!1:n,i&&this._$ganttchartHelper.ejGanttChart("clearConnectorLines"),this._connectorlineIds=[],this._connectorLinesCollection=[],this._createConnectorLinesCollection(),r&&this.isCriticalPathEnable==!0&&this._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId))},_ensurePredecessorCollection:function(){for(var n,i,f,r,t=this,e=t.model,o=t._predecessorsCollection,s=o.length-1,u=s;u>=0;u--)n=o[u],i=n.predecessorsName,i&&i.length&&(n.predecessor=n._calculatePredecessor(i,t._durationUnitEditText,e.durationUnit,t),t._isValidPredecessorString||(f=t._getPredecessorStringValue(n),n.predecessorsName=f,n.item.predecessor=f,t._isValidPredecessorString=!0),e.viewType=="resourceView"&&(r={},r.predecessor=n.predecessor,r.predecessorsName=n.predecessorsName,this._updateSharedResourceTask(n,r)))},_createConnectorLinesCollection:function(n){var u=this,r=this.model,e=r.currentViewData.length,i,f,t,s=u._predecessorsCollection,h=s.length,l=h/2,c=r.enableVirtualization,o;if(r.enableVirtualization&&n==="Load")for(e=r.updatedRecords.length,i=0;i<e;i++)t=r.updatedRecords[i],f=t.predecessor,f&&(o=t,u._addPredecessorsCollection(t,f));else for(i=0;i<e;i++)(t=r.currentViewData[i],c!==!1||t.isExpanded!==!1)&&r.currentViewData.indexOf(t)!==-1&&(f=t.predecessor,f&&(o=t,u._addPredecessorsCollection(t,f)));u._$ganttchartHelper&&u._$ganttchartHelper.ejGanttChart("renderConnectorLines",u._connectorLinesCollection)},_addPredecessorsCollection:function(t,i){var r=this,c,o,e,s,u,l=r.model,f={},a=l.updatedRecords,h,v;if(i){for(c=i.length,o=0;o<c;o++)(e=i[o],s=this._getRecordByTaskId(e.from),u=this._getRecordByTaskId(e.to),!l.enableVirtualization&&(s&&s.isExpanded===!1||u&&u.isExpanded===!1))||r._isValidationEnabled&&!r._isInExpandCollapse&&u&&r._validatePredecessorDates(u);if(!r._enableCreateCollection)return;for(h=0,n.each(i,function(n,i){return i.to===t.taskId.toString()&&h++,h}),o=0;o<c;o++)(e=i[o],h>1&&(e.isdrawn=!1),s=this._getRecordByTaskId(e.from),u=this._getRecordByTaskId(e.to),a.indexOf(s)!==-1&&a.indexOf(u)!=-1)&&(l.enableVirtualization||s.isExpanded!==!1&&u.isExpanded!==!1)&&s&&u&&(f=r._createConnectorLineObject(s,u,e),f&&(r._connectorlineIds.length>0&&r._connectorlineIds.indexOf(f.ConnectorLineId)==-1?(r._connectorLinesCollection.push(f),r._connectorlineIds.push(f.ConnectorLineId)):r._connectorlineIds.length==0?(r._connectorLinesCollection.push(f),r._connectorlineIds.push(f.ConnectorLineId)):r._connectorlineIds.indexOf(f.ConnectorLineId)!=-1&&(v=r._connectorlineIds.indexOf(f.ConnectorLineId),r._connectorLinesCollection[v]=f),e.isdrawn=!0))}},_createConnectorLineObject:function(i,r,u){var f={},l=this,v=l.model,a=v.updatedRecords,e=a.indexOf(i),o=a.indexOf(r),c=0,s=0,h,y,p;if(e!==-1&&o!==-1){if(!v.enableVirtualization)if(h=0,o>e){for(c=0;c<e;c++)a[c].isExpanded===!1&&++h;for(s=e,e-=h,s;s<o;s++)a[s].isExpanded===!1&&++h;o-=h}else if(e>o){for(c=0;c<o;c++)a[c].isExpanded===!1&&++h;for(s=o,o-=h,s;s<e;s++)a[s].isExpanded===!1&&++h;e-=h}return y=n("#ejGanttChart"+l._id).ejGanttChart("instance"),p=t.browserInfo().name=="msie"&&t.browserInfo().version<9?v.rowHeight:n("#"+y._$ganttViewTablebody[0].id).find("tr:first")[0].getBoundingClientRect().height,e!=-1&&o!=-1?(f.ParentLeft=i.isMilestone?i.left-l._milesStoneWidth/2:i.left,f.ChildLeft=r.isMilestone?r.left-l._milesStoneWidth/2:r.left,f.ParentWidth=i.width==0||i.isMilestone?Math.floor(l._milesStoneWidth*1.2):i.width,f.ChildWidth=r.width==0||r.isMilestone?Math.floor(l._milesStoneWidth*1.2):r.width,f.ParentIndex=e,f.ChildIndex=o,f.RowHeight=p,f.Type=u.predecessorsType,f.ConnectorLineId="parent"+i.taskId+"child"+r.taskId,f.milestoneParent=i.isMilestone?!0:!1,f.milestoneChild=r.isMilestone?!0:!1,t.isNullOrUndefined(i._isScheduledTask())||t.isNullOrUndefined(r._isScheduledTask())?null:f):void 0}},_updateDateByOffset:function(n,t,i,r){var u,f=t.offset,e=t.offsetDurationUnit;return f<0?u=this._getStartDate(this._checkEndDate(n,r),f*-1,e,r):(u=this._getEndDate(n,f,e,r,!1),i||(u=this._checkStartDate(u,r))),u},_validateChildGanttRecord:function(n,i,r,u){var f=this,o=f.model;if(f._editedTaskBarItem!==i&&!t.isNullOrUndefined(n._isScheduledTask())&&!t.isNullOrUndefined(i._isScheduledTask())&&(o.viewType!="resourceView"||!f._editedTaskBarItem||f._editedTaskBarItem.taskId!=i.taskId)){if(u&&(i.isAutoSchedule||o.validateManualTasksOnLinking))switch(r.predecessorsType){case"SS":var s=i.taskId.toString(),e=i.predecessor,h=e.filter(function(n){return n.to===s}),c=f._getPredecessorDate(i,h,r.predecessorsType);i.startDate=c;i._calculateEndDate(this);i.left=i._calculateLeft(this);i.width=i._calculateWidth(this);i.progressWidth=i._getProgressWidth(i.width,i.status);break;case"SF":var s=i.taskId.toString(),e=i.predecessor,h=e.filter(function(n){return n.to===s}),c=f._getPredecessorDate(i,h,r.predecessorsType);i.startDate=c;i._calculateEndDate(this);i.left=i._calculateLeft(this);i.width=i._calculateWidth(this);i.progressWidth=i._getProgressWidth(i.width,i.status);break;case"FS":var e=i.predecessor,s=i.taskId.toString(),h=e&&e.filter(function(n){return n.to===s}),l=f._getPredecessorDate(i,h,r.predecessorsType);i.startDate=l;i._calculateEndDate(this);i.left=i._calculateLeft(this);i.width=i._calculateWidth(this);i.progressWidth=i._getProgressWidth(i.width,i.status);break;case"FF":var s=i.taskId.toString(),e=i.predecessor,h=e&&e.filter(function(n){return n.to===s});i.startDate=f._getPredecessorDate(i,h,r.predecessorsType);i._calculateEndDate(this);i.left=i._calculateLeft(this);i.width=i._calculateWidth(this);i.progressWidth=i._getProgressWidth(i.width,i.status)}this._updateItemValueInRecord(i);o.viewType=="resourceView"?(f._updateSharedResourceTask(i),i.parentItem&&f._updateOverlappingValues(i.parentItem,!0),f._updateResourceParentItem(i)):i.parentItem&&i.parentItem.isAutoSchedule&&u?f._updateParentItem(i):i.parentItem&&!i.parentItem.isAutoSchedule&&u&&f._updateManualParentItem(i);(f._isTreeGridRendered||f._isGanttChartRendered)&&(o.viewType=="resourceView"&&i.eResourceTaskType=="resourceChildTask"?f.refreshGanttRecord(i.parentItem,i):f.refreshGanttRecord(i))}},_getValidatedStartDate:function(n,t,i){var e=i.predecessorsType,u=i.offset,r,f;t=this._updateToScheduledValue(t,!0);n=this._updateToScheduledValue(n);switch(e){case"FS":r=this._getValidEndDate(t);n.isMilestone&&u==0||(r=this._checkStartDate(r,n));u!=0&&(r=this._updateDateByOffset(r,i,n.isMilestone,n));f=n.isMilestone?new Date(r):this._checkStartDate(r,n);break;case"FF":r=this._getValidEndDate(t);u!=0&&(r=this._updateDateByOffset(r,i,n.isMilestone,n));n.isMilestone||(r=this._checkEndDate(r,n));f=this._getStartDate(r,n.duration,n.durationUnit,n);break;case"SF":r=this._getValidStartDate(t);u!=0&&(r=this._updateDateByOffset(r,i,n.isMilestone,n));n.isMilestone||(r=this._checkEndDate(r,n));f=this._getStartDate(r,n.duration,n.durationUnit,n);break;case"SS":r=this._getValidStartDate(t);u!=0&&(r=this._updateDateByOffset(r,i,n.isMilestone,n));f=n.isMilestone?r:this._checkStartDate(r,n)}return f},_getPredecessorDate:function(n,t){var c=this.model,i=null,o,r,u,s,h,e=t.filter(function(t){if(t.to===n.taskId.toString())return!0}),f;if(e)for(o=e.length,r=0;r<o;r++)f=e[r],s=this._getRecordByTaskId(f.from),h=this._getRecordByTaskId(f.to),u=this._getValidatedStartDate(h,s,f),i==null?i=u:this._compareDates(u,i)==1&&(i=u);return i},_removeConnectorLine:function(n,t){for(var o=this,h=this.model,u,r,f,i=0,s=n&&n.length,e=-1,i=0;i<s;i++)r=this._getRecordByTaskId(n[i].from),f=this._getRecordByTaskId(n[i].to),t.taskId.toString()===n[i].to.toString()&&(e=r.predecessor.indexOf(n[i]),e>=0&&r.predecessor.splice(e,1),this._updateResourcePredecessor(r)),r&&f&&(u="parent"+r.taskId+"child"+f.taskId,o._$ganttchartHelper.ejGanttChart("removeConnectorline",u),this._updateConnectorLineCollection(u))},_addConnectorLine:function(n){var f=this,r=0,o=f.model,u=n.predecessor,e,i,t;if(u)for(e=u.length,r=0;r<e;r++)i=u[r],i.to===n.taskId.toString()&&(t=this._getRecordByTaskId(i.from)),t&&(t.predecessor?t.predecessor.push(i):(t.predecessor=[],t.predecessor.push(i),f._predecessorsCollection.push(t)),this._updateResourcePredecessor(t))},_updatedRecordsDateByPredecessor:function(){var u=this,i=this.model,t,r,f=i.viewType=="resourceView",n;for(t=f?this._resourceUniqTasks:i.flatRecords,r=t.length,n=0;n<r;n++)t[n].predecessor&&t[n].item[i.predecessorMapping]&&u._validatePredecessorDates(t[n])},_validatePredecessorDates:function(n){var u=this,f=u.model,a;if(n.predecessor){for(var e=n.predecessor,o,r=null,i,s=n.taskId.toString(),h=e.filter(function(n){return n.to===s}),c=e.filter(function(n){return n.from===s}),l=h.length,t=0;t<l;t++)i=h[t],o=this._getRecordByTaskId(i.from),r=this._getRecordByTaskId(i.to),(r.isAutoSchedule||f.validateManualTasksOnLinking)&&u._validateChildGanttRecord(o,r,i,f.enablePredecessorValidation);a=c.length}},_validatePredecessor:function(n,t,r){var u=this,c=u.model,a=c.viewType=="resourceView"?!0:!1,g,y;if(n.predecessor){for(var w=n.predecessor,h,e=null,l,o,f,v=!1,b=n.taskId.toString(),p=w.filter(function(n){return n.to===b}),k=w.filter(function(n){return n.from===b}),d=p.length,s=0;s<d;s++)o=p[s],v=u._isOffsetChange(o,t,s),h=u._getRecordByTaskId(o.from),e=u._getRecordByTaskId(o.to),a||(l="parent"+h.taskId+"child"+e.taskId,u._$ganttchartHelper&&(u._$ganttchartHelper.ejGanttChart("removeConnectorline",l),this._updateConnectorLineCollection(l))),u._isValidationEnabled=c.enablePredecessorValidation&&(e.isAutoSchedule||c.validateManualTasksOnLinking)?!0:!1,n.taskId.toString()!==o.to&&n.taskId.toString()!==o.from||r&&r!="predecessor"||u._validateChildGanttRecord(h,e,o,c.enablePredecessorValidation,v);if(!a)for(s=0;s<d;s++)(o=p[s],h=u._getRecordByTaskId(o.from),e=u._getRecordByTaskId(o.to),c.enableVirtualization!==!1||h.isExpanded!==!1&&e.isExpanded!=!1)&&(f=u._createConnectorLineObject(h,e,o),f&&(u._connectorlineIds.length>0&&u._connectorlineIds.indexOf(f.ConnectorLineId)==-1?(u._updatedConnectorLineCollection.push(f),u._connectorlineIds.push(f.ConnectorLineId)):u._connectorlineIds.length==0?(u._updatedConnectorLineCollection.push(f),u._connectorlineIds.push(f.ConnectorLineId)):u._connectorlineIds.indexOf(f.ConnectorLineId)!=-1&&(y=u._connectorlineIds.indexOf(f.ConnectorLineId),u._updatedConnectorLineCollection[y]=f)));for(g=k.length,s=0;s<g;s++){if(o=k[s],h=u._getRecordByTaskId(o.from),e=u._getRecordByTaskId(o.to),v=u._isOffsetChange(o,t,s),u._isValidationEnabled=c.enablePredecessorValidation&&(e.isAutoSchedule||c.validateManualTasksOnLinking)?!0:!1,a||(l="parent"+h.taskId+"child"+e.taskId,u._$ganttchartHelper&&(u._$ganttchartHelper.ejGanttChart("removeConnectorline",l),this._updateConnectorLineCollection(l))),r!="predecessor"&&u._isValidationEnabled&&u._validateChildGanttRecord(h,e,o,c.enablePredecessorValidation,v),c.enableVirtualization===!1&&(h.isExpanded===!1||e.isExpanded==!1)){e&&u._validatePredecessor(e,i,"successor");continue}a||(f=u._createConnectorLineObject(h,e,o),f&&(u._connectorlineIds.length>0&&u._connectorlineIds.indexOf(f.ConnectorLineId)==-1?(u._updatedConnectorLineCollection.push(f),u._connectorlineIds.push(f.ConnectorLineId)):u._connectorlineIds.length==0?(u._updatedConnectorLineCollection.push(f),u._connectorlineIds.push(f.ConnectorLineId)):u._connectorlineIds.indexOf(f.ConnectorLineId)!=-1&&(y=u._connectorlineIds.indexOf(f.ConnectorLineId),u._updatedConnectorLineCollection[y]=f)));e&&u._validatePredecessor(e,i,"successor")}}},_updateConnectorLineCollection:function(n){var t,r,u,i;if(typeof n=="string"){for(t=0;t<this._connectorLinesCollection.length;t++)if(this._connectorLinesCollection[t].ConnectorLineId==n){this._connectorLinesCollection.splice(t,1);break}}else for(t=0;t<n.length;t++){for(u=0,i=0;i<this._connectorLinesCollection.length;i++)if(this._connectorLinesCollection[i].ConnectorLineId==n[t].ConnectorLineId){r=n[t];u=t;break}r?this._connectorLinesCollection[u]=r:this._connectorLinesCollection.push(n[t])}},_isOffsetChange:function(n,i,r){var e=this,o=e.model,u=!1;if(!o.enablePredecessorValidation)if(i&&i.length){var s=n.offset?parseInt(n.offset):0,f=i[r],h=f.offset?parseInt(f.offset):0;u=s!=h?!0:!1}else u=t.isNullOrUndefined(i)?!1:!0;return u},createWBSPredecessor:function(){var c=this,n=c.model,u,r,i,s,h,o;if(n.enableWBS&&n.enableWBSPredecessor&&n.predecessorMapping)for(u=n.flatRecords.filter(function(n){return n&&n.predecessor}),r=0;r<u.length;r++){var f=u[r],e=f.predecessor,t=null;for(i=0;i<e.length;i++)s=+e[i].from,h=n.flatRecords.filter(function(n){return n&&n.taskId==s}),o=h[0].WBS+e[i].predecessorsType,t=t?t+","+o:o;f.WBSPredecessor=t;f.item.WBSPredecessor=t}},calculateSerialNumberPredecessor:function(){var i=this,o=i.model,s,l,f,n,a,c,u,e;if(o.enableSerialNumber&&o.predecessorMapping)for(s=i._predecessorsCollection,l=s.length,f=0;f<l;f++){var h=s[f],t=h.predecessor,r=null;for(n=0;n<t.length;n++)a=+t[n].from,c=o.flatRecords.filter(function(n){return n&&n.taskId==a}),u=c.length&&c[0].serialNumber+t[n].predecessorsType,t[n].offset!=0&&(u+=t[n].offset>0?"+"+t[n].offset+" ":t[n].offset+" ",e=Math.abs(t[n].offset)!=1,u+=t[n].offsetDurationUnit=="day"?e?i._durationUnitTexts.days:i._durationUnitTexts.day:t[n].offsetDurationUnit=="hour"?e?i._durationUnitTexts.hours:i._durationUnitTexts.hour:e?i._durationUnitTexts.minutes:i._durationUnitTexts.minute),r=r?r+","+u:u;h.serialNumberPredecessor=r;h.item.serialNumberPredecessor=r}},_getRecordByTaskId:function(n){return this.model.viewType=="resourceView"?this._resourceUniqTasks[this._resourceUniqTaskIds.indexOf(n)]:this.model.flatRecords[this.model.ids.indexOf(n)]},_updatePredecessors:function(){var o=this,i=0,u=o._predecessorsCollection,h=u.length,f,e,r=0,n,s,t;for(i;i<h;i++)for(f=u[i],e=f.predecessor,s=e.length,r=0;r<s;r++)t=e[r],n=o._getRecordByTaskId(t.from),t.from!==f.taskId.toString()&&n&&(n.predecessor?n.predecessor.push(t):(n.predecessor=[],n.predecessor.push(t),u.push(n)),this._updateResourcePredecessor(n))},_updateConnectorlineWidth:function(n){var t=this;this.model.connectorlineWidth=n;t._$ganttchartHelper.ejGanttChart("updateConnectorlineWidth",n);t._$ganttchartHelper.ejGanttChart("clearConnectorLines");t._$ganttchartHelper.ejGanttChart("renderConnectorLines",t._connectorLinesCollection)},_updateConnectorLineBackground:function(n){var t=this;this.model.connectorLineBackground=n;t._$ganttchartHelper.ejGanttChart("updateConnectorLineBackground",n);t._$ganttchartHelper.ejGanttChart("clearConnectorLines");t._$ganttchartHelper.ejGanttChart("renderConnectorLines",t._connectorLinesCollection)},_validateAddRecordPrecessorValue:function(n){var u=this,i=n.data,t=this.model,r;return t.predecessorMapping&&i[t.predecessorMapping]&&i[t.predecessorMapping].length>0?(r={},r.currentRecord=n.currentRecord,r.predecessorString=i[t.predecessorMapping].split(","),u._editedPredecessorValidation(r)?!0:(i[t.predecessorMapping]="",n.currentRecord.predecessor=null,n.currentRecord.predecessorsName="",!1)):!0},_recordIdFromSerialnumber:function(n){var i=this,r=i.model,u=r.flatRecords,t;return t=u.filter(function(t){return t&&t.serialNumber==n}),t[0].taskId},_editedPredecessorValidation:function(i,r){var s=this,nt=this.model,p=i.currentRecord.taskId,e,a=i.predecessorString.join(","),f,h,c,l,v,y,k,o,d,u,g;if(a.length>0)for(f=s.model.enableSerialNumber&&r?s._idFromSerialPredecessor(a):s._idFromPredecessor(a),h=0;h<f.length;h++){if(c=i.currentRecord,nt.viewType=="projectView"){if(c&&c.parentItem&&f.indexOf(c.parentItem.taskId.toString())!==-1)return!1;for(l=0;l<f.length;l++)if(v=s.model.flatRecords.filter(function(n){return n&&n.taskId==f[l]}),v[0]&&v[0].hasChildRecords)return!1}var tt=f.slice(0),w=[],b=!0;if(n.each(tt,function(n,t){w.indexOf(t)===-1?w.push(t):b=!1}),b===!1)return!1;for(e=f[h],y=[],k=f.slice(0),k.splice(h,1);e!==null;)if(o=[],y.indexOf(e)===-1){if((u=s._getRecordByTaskId(e.toString()),t.isNullOrUndefined(u))||(!t.isNullOrUndefined(u.predecessor)&&u.predecessor.length>0&&n.each(u.predecessor,function(n,t){u.taskId.toString()!==t.from&&(o.push(t.from.toString()),d=n)}),p.toString()===u.taskId.toString()||o.indexOf(p.toString())!==-1))return!1;if(y.push(e),!t.isNullOrUndefined(u.predecessor)&&u.predecessor.length>0){if(o.length>1?g=this._predecessorValidation(o,i):o.length==1&&(e=u.predecessor[d].from),g===!1)return!1}else break}else break}return!0},_predecessorValidation:function(i,r){for(var o,c,s,l=this,h=r.currentRecord.taskId,f,u,e=0;e<i.length;e++)for(f=i[e],o=[],c=i.slice(0),c.splice(e,1);f!==null;)if(s=[],o.indexOf(f)===-1){if((u=l._recordReturnerByID(f),t.isNullOrUndefined(u))||(!t.isNullOrUndefined(u.predecessor)&&u.predecessor.length>0&&n.each(u.predecessor,function(n,t){u.taskId.toString()!==t.from&&s.push(t.from.toString())}),h.toString()===u.taskId.toString()||s.indexOf(h.toString())!==-1))return!1;if(o.push(f),!t.isNullOrUndefined(u.predecessor)&&u.predecessor.length>0)f=u.predecessor[0].from;else break}else break;return!0},_validationDialogTemplate:function(){var i=this,s=i.model,r=t.buildTag("div","",{},{"data-unselectable":"on"}),u=t.buildTag("form","",{height:"100%",width:"100%","font-size":"14px"},{id:i._id+"ValidationRuleForm"}),e=t.buildTag("div.e-validationHeader","",{padding:"10px"},{id:i._id+"_ValidationText"}),f=t.buildTag("div.e-ValidationContent","",{},{}),o="<table style='outline:none;border-spacing:2px;border-collapse:separate;padding:10px'><tr style='line-height:1.4'><td class='e-editLabel'><input type='radio' id='"+i._id+"_ValidationCancel' name='ValidationRule' checked='checked'/><label for='"+i._id+"_ValidationCancel' style='padding-left:10px;font-weight:normal;' id= '"+i._id+"_cancelLink'>"+i._validationRuleOptions.cancel+"<\/label><\/td><\/tr><tr style='line-height:1.4'><td class='e-editLabel'><input type='radio' id='"+i._id+"_ValidationRemoveline' name='ValidationRule'/><label for='"+i._id+"_ValidationRemoveline' style='padding-left:10px;font-weight:normal;' id='"+i._id+"_removeLink'>"+i._validationRuleOptions.removeLink+"<\/label><\/td><\/tr><tr style='line-height:1.4'><td class='e-editLabel'>{{if additionalButton}}<input type='radio' id='"+i._id+"_ValidationAddlineOffset' name='ValidationRule'/><label for='"+i._id+"_ValidationAddlineOffset' style='padding-left:10px;font-weight:normal;' id='"+i._id+"_preserveLink'>"+i._validationRuleOptions.preserveLink+"<\/label>{{/if}}<\/td><\/tr>  <\/table>";f.append(n(o));u.append(e).append(f);r=i._renderValidationDialogButton(u,r);n.templates(i._id+"_ValidationRuleTemplate",r.html())},_renderValidationDialogButton:function(n,i){var u="ValidationRuleDialog_",r=this,f=r.model,e=t.buildTag("input","",{"border-radius":"3px","min-width":"100px","max-width":"300px",float:"right"},{type:"button",id:u+r._id+"_validationOk"}),h=r._okButtonText,c=r._cancelButtonText,o=t.buildTag("input","",{"border-radius":"3px","min-width":"100px","max-width":"300px",float:"right","margin-left":"10px"},{type:"button",id:u+r._id+"_validationCancel"}),s=t.buildTag("div","",{},{"class":"e-gantt-validation-btn"});return e.ejButton({cssClass:f.cssClass,text:h,minwidth:"auto"}),o.ejButton({cssClass:f.cssClass,text:c,width:"auto"}),s.append(o).append(e),n.appendTo(i),s.appendTo(i),i},_validateTypes:function(i){var r=this,it=r.model,e=i.data,l=0,a=[],c={},w=[],f,g,v=r._$ganttchartHelper.ejGanttChart("taskbarEditedArguments"),s,nt,h,k,u,d,tt;if(i.editMode=="dialogEdit"){var y="#treegrid"+r._id+"predecessorEdit",o,f=[],b=[],p=r._predecessorCollectionText;if(n(y).length>0){for(n(y).ejTreeGrid("model.isEdit")&&n(y).ejTreeGrid("saveCell"),o=n(y).ejTreeGrid("option","dataSource"),u=0;u<o.length;u++){for(s={},s.from=it.enableSerialNumber?r._recordIdFromSerialnumber(o[u].id):o[u].id,s.to=e.taskId.toString(),s.isdrawn=!1,s.offset=o[u].offset,h=0;h<p.length;h++)if(o[u].type==p[h].text){s.predecessorsType=p[h].id;nt=p[h].id;break}k=s.from+nt;o[u].offset=parseFloat(o[u].offset);o[u].offset!==0&&(k+=o[u].offset<0?s.offset.toString():"+"+s.offset.toString());b.push(k)}b.length>0&&(f=e._calculatePredecessor(b.join(","),r._durationUnitEditText,r.model.durationUnit,r),t.isNullOrUndefined(e.predecessor)||e.predecessor.forEach(function(n){n.from==e.taskId.toString()&&f.push(n)}))}else f=e.predecessor}else f=e.predecessor;if(g=f&&f.length,r._editMode=i.editMode,i.cancel||t.isNullOrUndefined(f))return!0;for(u=0;u<g;u++)a=r._getRecordByTaskId(f[u].from),d=r._getPredecessorDate(e,f),f[u].predecessorsType=="FS"&&(f[u].to==e.taskId.toString()&&e.startDate<d&&e.startDate<a.endDate?(w[l]=f[u],l++,r._validationType=f[u].predecessorsType,c={parentTask:a,task:e,previousData:v.previousData,violationType:"taskBeforePredecessor",additionalButton:!1}):f[u].to==e.taskId.toString()&&e.startDate>d&&(w[l]=f[u],l++,r._validationType=f[u].predecessorsType,c={parentTask:a,task:e,previousData:v.previousData,violationType:"taskAfterPredecessor",additionalButton:!0}));return t.isNullOrUndefined(c.violationType)||i.validateMode.removeLink&&i.validateMode.respectLink&&i.validateMode.preserveLinkWithEditing?!0:(r._validationPredecessor=w,n("#"+r._id+"_dialogValidationRule").length===0&&(tt=t.buildTag("div.e-dialog e-dialog-content e-shadow e-widget-content","",{display:"none"},{id:r._id+"_dialogValidationRule"}),r.element.append(tt),r._on(n("#"+r._id+"_dialogValidationRule"),"click keypress","#ValidationRuleDialog_"+r._id+"_validationOk ,#ValidationRuleDialog_"+r._id+"_validationCancel",{args:i},r._validationDialogButtonClick)),i.editMode=="dialogEdit"||i.editMode=="cellEdit"||i.editMode=="recordUpdate"?i.validateMode.removeLink||i.validateMode.respectLink||i.validateMode.preserveLinkWithEditing?(i.validateMode.removeLink||i.validateMode.respectLink||i.validateMode.preserveLinkWithEditing)&&r._validationDialogButtonClick(i):r._renderValidationDialog(c):i.editMode!="dragging"||r.taskbarEdited(v)?r._$ganttchartHelper.ejGanttChart("taskbarEditedCancel",v):i.validateMode.removeLink||i.validateMode.respectLink||i.validateMode.preserveLinkWithEditing?(i.validateMode.removeLink||i.validateMode.respectLink||i.validateMode.preserveLinkWithEditing)&&r._validationDialogButtonClick(i):r._renderValidationDialog(c),!1)},_validationDialogButtonClick:function(r){var u=this,o=u.model,s=null,e,y=u._$ganttchartHelper.ejGanttChart("taskbarEditedArguments"),h,v,b;if(r.target.id=="ValidationRuleDialog_"+u._id+"_validationOk"||r.target.id=="ValidationRuleDialog_"+u._id+"_validationCancel"){if(e=r.data.args,s="dialog",r.keyCode!=0&&r.keyCode!==i&&r.keyCode!=13)return!0;e.editMode=="recordUpdate"&&(y.data=e.data)}else r.target.id==u._id+"_dialogValidationRule_closebutton"?s="dialog":(e=r,s="argument",e.editMode=="recordUpdate"&&(y.data=e.data));var f=t.isNullOrUndefined(y.data)?o.viewType=="projectView"?o.selectedItem:u._resourceEditedRecord:y.data,ut=f.predecessor,g=u._$treegridHelper.ejTreeGrid("instance"),l=y.previousData,c=u._endEditArgs;if(s=="dialog"||e.validateMode&&(e.validateMode.removeLink||e.validateMode.respectLink||e.validateMode.preserveLinkWithEditing))if(s=="dialog"&&r.target.id=="ValidationRuleDialog_"+u._id+"_validationOk"&&document.getElementById(u._id+"_ValidationCancel").checked||s=="dialog"&&(r.target.id=="ValidationRuleDialog_"+u._id+"_validationCancel"||r.target.id==u._id+"_dialogValidationRule_closebutton")||e.validateMode&&e.validateMode.respectLink){if(u._editMode=="dragging")f.startDate=l.startDate,o.startDateMapping&&(f.item[o.startDateMapping]=l.startDate),f.endDate=l.endDate,o.endDateMapping&&(f.item[o.endDateMapping]=l.endDate),f.left=f._calculateLeft(this),f.width=l.width,f.status=l.status,f.progressWidth=f._getProgressWidth(f.width,f.status),o.viewType=="resourceView"?(u._updateSharedResourceTask(f),f.parentItem&&u._updateOverlappingValues(f.parentItem,!0),u._updateResourceParentItem(f)):f.parentItem&&f.parentItem.isAutoSchedule?u._updateParentItem(f):f.parentItem&&!f.parentItem.isAutoSchedule&&u._updateManualParentItem(f),u._isLastRefresh=!1,u._connectorlineIds=[],u._updatedConnectorLineCollection=[],u._validatePredecessor(f),o.viewType!="resourceView"&&u._updatedConnectorLineCollection.length>0&&(u._$ganttchartHelper.ejGanttChart("appendConnectorLine",u._updatedConnectorLineCollection),this._updateConnectorLineCollection(u._updatedConnectorLineCollection)),u._isLastRefresh=!0,o.viewType=="resourceView"&&f.eResourceTaskType=="resourceChildTask"?u.refreshGanttRecord(f.parentItem):u.refreshGanttRecord(f);else if(u._editMode=="dialogEdit")this._editedDialogRecord=f,u._sendSaveRequest("Edit")||(u._isAddEditDialogSave=!0);else if(u._editMode=="cellEdit")c.data[c.columnName]=c.previousValue,u._triggerEndEdit(c);else if(u._editMode=="recordUpdate"){var p=e.actionCompleteArgs,a=p.modifiedRecord,nt=p.previousItem[o.startDateMapping],tt=p.previousItem[o.endDateMapping],it=p.previousItem[o.durationMapping];a.startDate=a.item[o.startDateMapping]=nt;a.endDate=a.item[o.endDateMapping]=tt;a.duration=a.item[o.durationMapping]=it;u.actionComplete(p)}s=="dialog"&&n("#"+u._id+"_dialogValidationRule").ejDialog("close")}else if(s=="dialog"&&document.getElementById(u._id+"_ValidationRemoveline").checked||e.validateMode&&e.validateMode.removeLink){if(h={},u._editMode=="dragging")h.ganttRecord=f,u._updatePredecessorValues(h),t.TreeGrid.refreshRow(g,o.updatedRecords.indexOf(f)),u._isLastRefresh=!0,o.viewType=="reourceView"&&f.eResourceTaskType=="resourceChildTask"?u.refreshGanttRecord(f.parentItem):u.refreshGanttRecord(f);else if(u._editMode=="dialogEdit"){var rt="#treegrid"+u._id+"predecessorEdit",w=n(rt).ejTreeGrid("option","dataSource"),k=0,d;for(v=0;v<u._validationPredecessor.length;v++)u._validationPredecessor[v].predecessorsType==u._validationType&&(u._validationPredecessor[v].from==w[k].id?(d=w.indexOf(w[k]),w.splice(d,1)):(v--,k++));h.ganttRecord=this._editedDialogRecord;u._updatePredecessorValues(h);this._editedDialogRecord=h.ganttRecord;u._sendSaveRequest("Edit")||(u._isAddEditDialogSave=!0)}else u._editMode=="cellEdit"?(h.ganttRecord=f,u._updatePredecessorValues(h),c.data=h.ganttRecord,u._triggerEndEdit(c)):u._editMode=="recordUpdate"&&(b=e.actionCompleteArgs,h.ganttRecord=f,u._updatePredecessorValues(h),e.data=h.ganttRecord,u.actionComplete(b));s=="dialog"&&n("#"+u._id+"_dialogValidationRule").ejDialog("close")}else s=="dialog"&&document.getElementById(u._id+"_ValidationAddlineOffset").checked||e.validateMode&&e.validateMode.preserveLinkWithEditing?(u._editMode=="dialogEdit"?u._sendSaveRequest("Edit")||(u._isAddEditDialogSave=!0):u._editMode=="cellEdit"?u._triggerEndEdit(c):u._editMode=="recordUpdate"&&(b=e.actionCompleteArgs,u.actionComplete(b)),s=="dialog"&&n("#"+u._id+"_dialogValidationRule").ejDialog("close")):s=="dialog"&&n("#"+u._id+"_dialogValidationRule").ejDialog("close");else s=="dialog"&&n("#"+u._id+"_dialogValidationRule").ejDialog("close")},_updatePredecessorValues:function(n){for(var t=this,l=t.model,r=t._validationPredecessor,e=n.ganttRecord,u={},s=r.length,f,i=0;i<s;i++)if(r[i].predecessorsType==t._validationType){var o=t._getRecordByTaskId(r[i].from),h=t._getRecordByTaskId(r[i].to),c="parent"+o.taskId+"child"+h.taskId;t._$ganttchartHelper.ejGanttChart("removeConnectorline",c);f=t._predecessorsCollection.indexOf(e);f!=0&&t._predecessorsCollection.splice(f,1);u.parentGanttRecord=o;u.predecessor=r[i];u.data=e;u.validationType=t._validationType;t._updateRecordCollection(u)}},_updateRecordCollection:function(n){var t=n.data,f=this,r=n.parentGanttRecord,i=t.item[f.model.predecessorMapping].split(","),o=t.predecessor.indexOf(n.predecessor),u,e;t.predecessor.splice(o,1);this._updateResourcePredecessor(t);u=i.indexOf(n.predecessor.from+"FS");u!=-1&&(i.splice(u,1),t.item[f.model.predecessorMapping]=i.join(","),t.predecessorsName=i.join(","),this._updateResourcePredecessor(t),e=r.predecessor.indexOf(n.predecessor),r.predecessor.splice(e,1),this._updateResourcePredecessor(r))},_renderValidationDialog:function(i){var r=this,f=r.model,o=document.createElement("div"),s,e,h,u;n(o).addClass("e-ValidationRules");o.innerHTML=n.render[r._id+"_ValidationRuleTemplate"](i);n("#"+r._id+"_dialogValidationRule").html(n(o));u={};u.cssClass=f.cssClass;u.enableResize=!1;u.width="auto";u.height="auto";u.contentSelector="#"+r._id;u.allowKeyboardNavigation=!1;s=r._validationDialogTitle;u.title=s;u.enableModal=!0;u.allowDraggable=!0;u.isResponsive=!0;u.close=function(){n("#"+r._id+"EditAreaNotes").data("ejRTE")&&n("#"+r._id+"EditAreaNotes").ejRTE("destroy")};e=t.isNullOrUndefined(i.task.taskName)?"ID "+i.task.taskId:i.task.taskName;h=t.isNullOrUndefined(i.parentTask.taskName)?"ID "+i.parentTask.taskId:i.parentTask.taskName;document.getElementById(r._id+"_removeLink").innerHTML=String.format(r._validationRuleOptions.removeLink,e,t.format(i.task.startDate,f.dateFormat,f.locale));document.getElementById(r._id+"_preserveLink")&&(document.getElementById(r._id+"_preserveLink").innerHTML=String.format(r._validationRuleOptions.preserveLink,e,t.format(i.task.startDate,f.dateFormat,f.locale)));document.getElementById(r._id+"_ValidationText").innerHTML=String.format(r._validationRuleText[i.violationType],e,h);n("#"+r._id+"_dialogValidationRule").ejDialog(u);n("#"+r._id+"_dialogValidationRule_wrapper").addClass("e-gantt-dialog");n("#"+r._id+"_dialogValidationRule").ejDialog("open");n("#"+r._id+"_dialogValidationRule_closebutton").click(function(n){r._validationDialogButtonClick(n)})},_removeChildRecordsPredecessor:function(n){var i=this,r,t;if(n.hasChildRecords)for(r=n.childRecords.length,t=0,t;t<r;t++)n.childRecords[t].predecessor&&i._removePredecessor(n.childRecords[t].predecessor,n.childRecords[t]),n.childRecords[t].hasChildRecords&&i._removeChildRecordsPredecessor(n.childRecords[t])},_validatePredecessorOnEditing:function(n,t){for(var d,a,i=this,h=i.model,y=n.taskId.toString(),h=this.model,p=n.predecessor,u,c,e,o,r,s,w=null,l=h.viewType=="resourceView"?!0:!1,v=p.filter(function(n){return n.to===y}),b=p.filter(function(n){return n.from===y}),k=v.length,f=0;f<k;f++)u=v[f],c=i._isOffsetChange(u,w,f),e=this._getRecordByTaskId(u.from),o=this._getRecordByTaskId(u.to),t&&(i._validateChildGanttRecord(e,o,u,h.enablePredecessorValidation,c),t=!1),l||(s="parent"+e.taskId+"child"+o.taskId,i._$ganttchartHelper&&(i._$ganttchartHelper.ejGanttChart("removeConnectorline",s),this._updateConnectorLineCollection(s)));if(!l)for(f=0;f<k;f++)(u=v[f],e=this._getRecordByTaskId(u.from),o=this._getRecordByTaskId(u.to),h.enableVirtualization!==!1||e.isExpanded!==!1&&o.isExpanded!=!1)&&(r=i._createConnectorLineObject(e,o,u),r&&(i._connectorlineIds.length>0&&i._connectorlineIds.indexOf(r.ConnectorLineId)==-1?(i._updatedConnectorLineCollection.push(r),i._connectorlineIds.push(r.ConnectorLineId)):i._connectorlineIds.length==0?(i._updatedConnectorLineCollection.push(r),i._connectorlineIds.push(r.ConnectorLineId)):i._connectorlineIds.indexOf(r.ConnectorLineId)!=-1&&(a=i._connectorlineIds.indexOf(r.ConnectorLineId),i._updatedConnectorLineCollection[a]=r)));for(d=b.length,f=0;f<d;f++)(u=b[f],e=this._getRecordByTaskId(u.from),o=this._getRecordByTaskId(u.to),c=i._isOffsetChange(u,w,f),l||(s="parent"+e.taskId+"child"+o.taskId,i._$ganttchartHelper&&(i._$ganttchartHelper.ejGanttChart("removeConnectorline",s),this._updateConnectorLineCollection(s))),t&&(i._validateChildGanttRecord(e,o,u,h.enablePredecessorValidation,c),t=!1),h.enableVirtualization!==!1||e.isExpanded!==!1&&o.isExpanded!=!1)&&(l||(r=i._createConnectorLineObject(e,o,u),r&&(i._connectorlineIds.length>0&&i._connectorlineIds.indexOf(r.ConnectorLineId)==-1?(i._updatedConnectorLineCollection.push(r),i._connectorlineIds.push(r.ConnectorLineId)):i._connectorlineIds.length==0?(i._updatedConnectorLineCollection.push(r),i._connectorlineIds.push(r.ConnectorLineId)):i._connectorlineIds.indexOf(r.ConnectorLineId)!=-1&&(a=i._connectorlineIds.indexOf(r.ConnectorLineId),i._updatedConnectorLineCollection[a]=r))))},_updatePredecessorValue:function(n,i){var u=this,f,a=this.model,o,v=0,h,c=[],s=0,r=t.isNullOrUndefined(n)?a.selectionMode=="row"?u.selectedItem():a.updatedRecords[u._rowIndexOfLastSelectedCell]:n,e,l;for(f=r.predecessor,i.length>0&&(o=r._calculatePredecessor(i,this._durationUnitEditText,this.model.durationUnit,u)),o&&(v=o.length),e=0,l=0,f&&(l=f.length),e=0;e<l;e++)h=f[e],h.from===r.taskId.toString()&&c.push(h);for(s=0;s<v;s++)c.push(o[s]);return r.predecessor=c,u.model.predecessorMapping&&(r.item[u.model.predecessorMapping]=i,r.predecessorsName=i),f},_updatePredecessorOnIndentOutdent:function(n){for(var u=this,h=n.predecessor.length,r=n.predecessor,e,t,o,f=u.model,i=0;i<h;i++){if(r[i].to===n.taskId.toString())t=this._getRecordByTaskId(r[i].from),e=t.predecessor.indexOf(r[i]),t.predecessor.splice(e,1),o="parent"+t.taskId+"child"+n.taskId;else if(r[i].from===n.taskId.toString()){t=this._getRecordByTaskId(r[i].to);var a=u._predecessorToString(t.predecessor,t),s=t.predecessorsName.split(","),c=r[i].from+r[i].predecessorsType,l=s.indexOf(c);s.splice(l,1);t.item[f.predecessorMapping]=s.join(",");t.predecessorsName=s.join(",");e=t.predecessor.indexOf(r[i]);t.predecessor.splice(e,1);f.enableWBS&&f.enableWBSPredecessor&&u._$treegridHelper.ejTreeGrid("updateWBSPredecessor",t);o="parent"+n.taskId+"child"+t.taskId;u._isLastRefresh=!1;u.refreshGanttRecord(t)}u._$ganttchartHelper.ejGanttChart("removeConnectorline",o);this._updateConnectorLineCollection(o)}n.predecessor=[];n.item[f.predecessorMapping]="";n.predecessorsName="";f.enableWBS&&f.enableWBSPredecessor&&(n.WBSPredecessor="",n.item.WBSPredecessor="")},_removePredecessor:function(t,i,r){var e=this,v=t.length,f=0,o=e.model,s,u,h=n.extend({},!0,t),c,a,l;for(f;f<v;f++){if(r){if(h[f].to!==i.taskId.toString())continue;s=e._getRecordByTaskId(h[f].from);u=e._getRecordByTaskId(h[f].to)}else t[f].from!==i.taskId.toString()?u=this._getRecordByTaskId(t[f].from):t[f].to!==i.taskId.toString()&&(u=this._getRecordByTaskId(t[f].to));u&&(c=u.predecessor.indexOf(t[f]),c!==-1&&u.predecessor.splice(c,1),u.item[o.predecessorMapping]&&(u.item[o.predecessorMapping]=e._predecessorToString(u.predecessor,u),u.predecessorsName=u.item[o.predecessorMapping],o.enableWBS&&o.enableWBSPredecessor&&e._$treegridHelper.ejTreeGrid("updateWBSPredecessor",u),o.enableSerialNumber&&e._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",u),this._updateResourcePredecessor(u),e.refreshGanttRecord(u)));r&&(a=s.predecessor.indexOf(t[f]),s.predecessor.splice(a,1),this._updateResourcePredecessor(s),l="parent"+s.taskId+"child"+u.taskId,e._$ganttchartHelper.ejGanttChart("removeConnectorline",l),e._updateConnectorLineCollection(l))}},_updateResourcePredecessor:function(n){if(this.model.viewType=="resourceView"&&n.eResourceTaskType=="resourceChildTask"&&n.resourceInfo.length>0){var t={};t.predecessor=n.predecessor;t.predecessorsName=n.predecessorsName;this._updateSharedResourceTask(n,t)}},_predecessorToString:function(n,t){var e=this,u=[],i=0,f=n.length,r;for(i;i<f;i++)t.taskId.toString()!==n[i].from&&(r=n[i].from+n[i].predecessorsType,n[i].offset=isNaN(n[i].offset)?0:n[i].offset,n[i].offset!==0&&(n[i].offset<0?r+=n[i].offset.toString()+"d":n[i].offset>0&&(r+="+"+n[i].offset.toString()+"d")),u.push(r));return u.join(",")},showCriticalPath:function(n,t){var h=this,tt=this.model.ids,c=this.model.flatRecords,y,e,g,yt,et,i,u,pt,ut,wt,a,ot,st;if(h._$treegridHelper.ejTreeGrid("cancelEditCell"),n==!0)if(this.isCriticalPathEnable=!0,c.length!=0){var r=[],ct,it,f=[],s=[],l=[],nt=[],lt=[],at=[],o=this.model.flatRecords,b=this.model.parentRecords,kt=[],ft=0,rt=0,vt=[],v,ht;for(v=this.model.parentRecords[0].endDate,this.model.parentRecords[0].manualEndDate>this.model.parentRecords[0].endDate&&!this.model.parentRecords[0].isAutoSchedule&&(v=this.model.parentRecords[0].manualEndDate),ht=this.model.parentRecords[0].taskId,y=1;y<b.length;y++)b[y].endDate>=v&&(v=b[y].endDate,ht=b[y].taskId),b[y].isAutoSchedule||b[y].manualEndDate>=v&&(v=b[y].manualEndDate,ht=b[y].taskId);for(e=0;e<o.length;e++)o[e].isCritical=!1,ft=h._getDuration(o[e].endDate,v,o[e].durationUnit,o[e].isAutoSchedule),o[e].slack=ft+" "+o[e].durationUnit,o[e].endDate>=v&&nt.push(o[e].taskId),o[e].predecessor&&o[e].predecessor.length!=0&&(r.push(o[e]),lt.push(o[e].taskId));for(g=0;g<nt.length;g++)lt.indexOf(nt[g])==-1?(rt=tt.indexOf(nt[g].toString()),c[rt].status<100&&(c[rt].isCritical=!0),c[rt].slack=0+c[rt].durationUnit,at.push(nt[g])):kt.push(nt[g]);for(yt=r.length,et=[],i=0;i<yt;i++){var p=-1,w=-1,k=-1,d=-1,dt=i;for(ct=r[i].predecessor.length,it=parseInt(r[i].taskId),u=0;u<ct;u++)r[i].predecessor[u].from==it&&(p==-1?r[i].predecessor[u].offset?(p=r[i].predecessor[u].to+":"+r[i].predecessor[u].offset+r[i].predecessor[u].offsetDurationUnit,k=r[i].predecessor[u].predecessorsType):(p=r[i].predecessor[u].to,k=r[i].predecessor[u].predecessorsType):r[i].predecessor[u].offset?(p=p+","+r[i].predecessor[u].to+":"+r[i].predecessor[u].offset+r[i].predecessor[u].offsetDurationUnit,k=k+","+r[i].predecessor[u].predecessorsType):(p=p+","+r[i].predecessor[u].to,k=k+","+r[i].predecessor[u].predecessorsType)),r[i].predecessor[u].to==it&&(w==-1?r[i].predecessor[u].offset?(w=r[i].predecessor[u].from+":"+r[i].predecessor[u].offset+r[i].predecessor[u].offsetDurationUnit,d=r[i].predecessor[u].predecessorsType):(w=r[i].predecessor[u].from,d=r[i].predecessor[u].predecessorsType):r[i].predecessor[u].offset?(w=w+","+r[i].predecessor[u].from+":"+r[i].predecessor[u].offset+r[i].predecessor[u].offsetDurationUnit,d=d+","+r[i].predecessor[u].predecessorsType):(w=w+","+r[i].predecessor[u].from,d=d+","+r[i].predecessor[u].predecessorsType));w==-1&&(w=null,d=null);p==-1&&(p=null,k=null);f.push({from:w,fromPredecessor:d,taskid:it,to:p,toPredecessor:k,currentIndex:dt,slack:null,ff:0,fs:0,enddate:null,fsslack:0});s.push(parseInt(it))}for(pt=f.length,ut=0,a=0;a<pt;a++)f[a].to||(wt=f[a].taskid,ut=tt.indexOf(wt.toString()),ft=h._getDuration(c[ut].endDate,v,"minute",c[ut].isAutoSchedule),f[a].slack=ft,f[a].fs=-1,f[a].enddate=c[ut].endDate,et.push({fromdata:f[a].from,todateID:f[a].taskid,fromDataPredecessor:f[a].fromPredecessor}));for(ot=0;ot<et.length;ot++)vt.push(et[ot]),h._slackCalculation(vt,f,s,v,c,tt);l=h._finalCriticalPath(f,at,c,tt);this.criticalPathCollection=l;this.detailPredecessorCollection=f;this.collectionTaskId=s;t?t&&this._$ganttchartHelper.ejGanttChart("criticalDataMapping",l,n,f,s):(this._$ganttchartHelper.ejGanttChart("criticalDataMapping",l,n,f,s),this._$ganttchartHelper.ejGanttChart("criticalPathColor",l,n,f,s),h._$treegridHelper.ejTreeGrid("refresh"));h._enableDisableCriticalIcon=!0}else{var l=[],f=[],s=[];t?t&&this._$ganttchartHelper.ejGanttChart("criticalDataMapping",l,n,f,s):(this._$ganttchartHelper.ejGanttChart("criticalDataMapping",l,n,f,s),this._$ganttchartHelper.ejGanttChart("criticalPathColor",l,n,f,s),this._$treegridHelper.ejTreeGrid("refresh"));h._enableDisableCriticalIcon=!0}if(n==!1){var l=[],f=[],s=[],bt=0;for(this.isCriticalPathEnable=!1,st=0;st<h.criticalPathCollection.length;st++)bt=tt.indexOf(h.criticalPathCollection[st].toString()),c[bt].isCritical=!1;t?t&&this._$ganttchartHelper.ejGanttChart("criticalDataMapping",l,n,f,s):(this._$ganttchartHelper.ejGanttChart("criticalDataMapping",l,n,f,s),this._$ganttchartHelper.ejGanttChart("criticalPathColor",l,n,f,s),this._$treegridHelper.ejTreeGrid("refresh"));h._enableDisableCriticalIcon=!1}},_finalCriticalPath:function(n,t,i,r){for(var o=this,e=[],u,f=0;f<n.length;f++)u=r.indexOf(n[f].taskid.toString()),i[u].durationUnit=="day"?(i[u].slack=n[f].slack/60/(o._secondsPerDay/3600),i[u].slack=i[u].slack%1!=0?i[u].slack.toFixed(2)+" day":i[u].slack+" day"):i[u].durationUnit=="hour"?(i[u].slack=n[f].slack/60,i[u].slack=i[u].slack%1!=0?i[u].slack.toFixed(2)+" hour":i[u].slack+" hour"):i[u].slack=n[f].slack+" minutes",n[f].slack<=0&&i[u].status<100&&(i[u].isCritical=!0,e.push(n[f].taskid));return e.concat(t)},_getSlackDuration:function(n,t,i,r){var u=this._checkStartDate(new Date(n)),f=this._checkEndDate(new Date(t));return this._getTimeDiff(u,f,!0)<=0?0:this._getDuration(u,f,i,r.isAutoSchedule,!0)},_slackCalculation:function(n,i,r,u,f,e){for(var a=this,d=n[0].fromdata.split(","),k=n[0].fromDataPredecessor.split(","),s=[],o,h,v,l,g=d.length,w,p,c,y,b=0;b<g;b++)s=d[b].split(":"),o=r.indexOf(parseInt(s[0])),l=r.indexOf(parseInt(n[0].todateID)),k[b]=="FS"&&(h=e.indexOf(s[0].toString()),v=e.indexOf(n[0].todateID.toString()),c=f[h].endDate>f[v].startDate?-a._getDuration(f[v].startDate,f[h].endDate,"minute",f[h].isAutoSchedule):a._getSlackDuration(f[h].endDate,f[v].startDate,"minute",f[h]),t.isNullOrUndefined(i[o].slack)?(s.length<=1?i[o].slack=i[l].slack+c<0?0:i[l].slack+c:s.length>1&&(y=s[1].indexOf("hour")!=-1?parseInt(s[1])*60:s[1].indexOf("day")!=-1?parseInt(s[1])*(a._secondsPerDay/3600)*60:parseInt(s[1]),i[o].slack=i[l].slack+c,i[o].slack=i[o].slack-y,i[o].slack<0&&(i[o].slack=0)),i[o].fs=1,i[o].fsslack=i[o].slack,i[o].enddate=f[h].startDate):i[o].slack>c&&i[o].slack!=0&&(s.length<=1?i[o].slack=i[l].slack+c<0?0:i[l].slack+c:s.length>1&&(y=s[1].indexOf("hour")!=-1?parseInt(s[1])*60:s[1].indexOf("day")!=-1?parseInt(s[1])*(a._secondsPerDay/3600)*60:parseInt(s[1]),i[o].slack=i[l].slack+c,i[o].slack=i[o].slack-y,i[o].slack<0&&(i[o].slack=0)),i[o].fs=1,i[o].fsslack=i[o].slack,i[o].enddate=f[h].startDate),f[h].endDate>=u&&f[h].endDate<=u&&(i[o].slack=0)),k[b]=="SS"&&(h=e.indexOf(s[0].toString()),f[h].isAutoSchedule?(v=e.indexOf(n[0].todateID.toString()),c=f[h].startDate>f[v].startDate?-a._getDuration(f[v].startDate,f[h].startDate,"minute",f[h].isAutoSchedule):a._getDuration(f[h].startDate,f[v].startDate,"minute",f[h].isAutoSchedule),t.isNullOrUndefined(i[o].slack)?(s.length<=1?i[o].slack=i[l].slack+c<0?0:i[l].slack+c:s.length>1&&(y=s[1].indexOf("hour")!=-1?parseInt(s[1])*60:s[1].indexOf("day")!=-1?parseInt(s[1])*(a._secondsPerDay/3600)*60:parseInt(s[1]),i[o].slack=i[l].slack+c,i[o].slack=i[o].slack-y,i[o].slack<0&&(i[o].slack=0)),i[o].fs=1,i[o].fsslack=i[o].slack,i[o].enddate=f[h].startDate):i[o].slack>c&&i[o].slack!=0&&(s.length<=1?i[o].slack=i[l].slack+c<0?0:i[l].slack+c:s.length>1&&(y=s[1].indexOf("hour")!=-1?parseInt(s[1])*60:s[1].indexOf("day")!=-1?parseInt(s[1])*(a._secondsPerDay/3600)*60:parseInt(s[1]),i[o].slack=i[l].slack+c,i[o].slack=i[o].slack-y,i[o].slack<0&&(i[o].slack=0)),i[o].fs=1,i[o].fsslack=i[o].slack,i[o].enddate=f[h].startDate)):f[h].isAutoSchedule||(c=a._getSlackDuration(f[h].endDate,u,"minute",f[h]),t.isNullOrUndefined(i[o].slack)?i[o].slack=c:i[o].slack>c&&i[o].slack!=0&&(i[o].slack=c)),f[h].endDate>=u&&f[h].endDate<=u&&(i[o].slack=0)),k[b]=="FF"&&(i[l].fs==1||i[l].ff==1||i[l].fs==-1?(h=e.indexOf(s[0].toString()),v=e.indexOf(n[0].todateID.toString()),i[l].fs==1?(w=f[v].endDate,p=i[l].slack):i[l].ff==1&&(w=f[v].endDate,p=i[l].slack),i[l].fs==-1&&(w=i[l].enddate,p=i[l].slack),c=w>f[h].endDate?-a._getSlackDuration(f[h].endDate,w,"minute",f[h]):a._getSlackDuration(w,f[h].endDate,"minute",f[h]),t.isNullOrUndefined(i[o].slack)?(s.length<=1?i[o].slack=p-c<0?0:p-c:s.length>1&&(y=s[1].indexOf("hour")!=-1?parseInt(s[1])*60:s[1].indexOf("day")!=-1?parseInt(s[1])*(a._secondsPerDay/3600)*60:parseInt(s[1]),i[o].slack=i[l].slack-c,i[o].slack=i[o].slack-y,i[o].slack<0&&(i[o].slack=0)),i[o].ff=1,i[o].enddate=w,i[o].fsslack=p):i[o].slack>c&&i[o].slack!=0&&(s.length<=1?i[o].slack=p-c<0?0:p-c:s.length>1&&(y=s[1].indexOf("hour")!=-1?parseInt(s[1])*60:s[1].indexOf("day")!=-1?parseInt(s[1])*(a._secondsPerDay/3600)*60:parseInt(s[1]),i[o].slack=i[l].slack-c,i[o].slack=i[o].slack-y,i[o].slack<0&&(i[o].slack=0)),i[o].ff=1,i[o].enddate=w,i[o].fsslack=p)):(h=e.indexOf(s[0].toString()),c=a._getSlackDuration(f[h].endDate,u,"minute",f[h]),t.isNullOrUndefined(i[o].slack)?s.length<=1?t.isNullOrUndefined(i[o].slack)?i[o].slack=c:i[o].slack>c&&(i[o].slack=c):s.length>1&&(y=s[1].indexOf("hour")!=-1?parseInt(s[1])*60:s[1].indexOf("day")!=-1?parseInt(s[1])*(a._secondsPerDay/3600)*60:parseInt(s[1]),i[o].slack=c,i[o].slack=i[o].slack-y,i[o].slack<0&&(i[o].slack=0)):i[o].slack>c&&i[o].slack!=0&&(s.length<=1?t.isNullOrUndefined(i[o].slack)?i[o].slack=c:i[o].slack>c&&(i[o].slack=c):s.length>1&&(y=s[1].indexOf("hour")!=-1?parseInt(s[1])*60:s[1].indexOf("day")!=-1?parseInt(s[1])*(a._secondsPerDay/3600)*60:parseInt(s[1]),i[o].slack=c,i[o].slack=i[o].slack-y,i[o].slack<0&&(i[o].slack=0))),i[o].ff=1),f[h].endDate>=u&&f[h].endDate<=u&&(i[o].slack=0)),k[b]=="SF"&&(h=e.indexOf(s[0].toString()),f[h].isAutoSchedule?t.isNullOrUndefined(i[o].slack)?(s.length<=1?t.isNullOrUndefined(i[l].to)?(h=e.indexOf(s[0].toString()),c=a._getSlackDuration(f[h].endDate,u,"minute",f[h]),i[o].slack=c):t.isNullOrUndefined(i[l].to)||(h=e.indexOf(s[0].toString()),v=e.indexOf(n[0].todateID.toString()),c=f[v].endDate>f[h].startDate?-a._getDuration(f[h].startDate,f[v].endDate,"minute",f[h].isAutoSchedule):a._getSlackDuration(f[v].endDate,f[h].startDate,"minute",f[h]),i[o].slack=i[l].slack+c<0?0:i[l].slack+c):s.length>1&&(h=e.indexOf(s[0].toString()),v=e.indexOf(n[0].todateID.toString()),c=f[v].endDate>f[h].endDate?f[h].startDate>f[v].endDate?-a._getSlackDuration(f[v].endDate,f[h].startDate,"minute",f[h]):a._getDuration(f[h].startDate,f[v].endDate,"minute",f[h].isAutoSchedule):a._getSlackDuration(f[h].endDate,u,"minute",f[h]),y=s[1].indexOf("hour")!=-1?parseInt(s[1])*60:s[1].indexOf("day")!=-1?parseInt(s[1])*(a._secondsPerDay/3600)*60:parseInt(s[1]),i[o].slack=i[l].slack+c,i[o].slack=i[o].slack-y,i[o].slack<0&&(i[o].slack=0)),i[o].fs=1,i[o].fsslack=i[o].slack,i[o].enddate=f[h].startDate):(s.length<=1?(t.isNullOrUndefined(i[l].to)?(h=e.indexOf(s[0].toString()),c=a._getSlackDuration(f[h].endDate,u,"minute",f[h])):t.isNullOrUndefined(i[l].to)||(h=e.indexOf(s[0].toString()),v=e.indexOf(n[0].todateID.toString()),c=f[v].endDate>f[h].startDate?-a._getDuration(f[h].startDate,f[v].endDate,"minute",f[h].isAutoSchedule):a._getSlackDuration(f[v].endDate,f[h].startDate,"minute",f[h])),i[o].slack>c&&i[o].slack!=0&&(t.isNullOrUndefined(i[l].to)?i[o].slack=c:t.isNullOrUndefined(i[l].to)||(i[o].slack=i[l].slack+c<0?0:i[l].slack+c))):s.length>1&&(h=e.indexOf(s[0].toString()),v=e.indexOf(n[0].todateID.toString()),c=f[v].endDate>f[h].endDate?f[h].startDate>f[v].endDate?-a._getSlackDuration(f[v].endDate,f[h].startDate,"minute",f[h]):a._getDuration(f[h].startDate,f[v].endDate,"minute",f[h].isAutoSchedule):a._getSlackDuration(f[h].endDate,u,"minute",f[h]),i[o].slack>c&&i[o].slack!=0&&(y=s[1].indexOf("hour")!=-1?parseInt(s[1])*60:s[1].indexOf("day")!=-1?parseInt(s[1])*(a._secondsPerDay/3600)*60:parseInt(s[1]),i[o].slack=i[l].slack+c,i[o].slack=i[o].slack-y,i[o].slack<0&&(i[o].slack=0))),i[o].fs=1,i[o].fsslack=i[o].slack,i[o].enddate=f[h].startDate):f[h].isAutoSchedule||(c=a._getSlackDuration(f[h].endDate,u,"minute",f[h]),t.isNullOrUndefined(i[o].slack)?i[o].slack=c:i[o].slack>c&&i[o].slack!=0&&(i[o].slack=c)),f[h].endDate>=u&&f[h].endDate<=u&&(i[o].slack=0)),i[o].from&&n.push({fromdata:i[o].from,todateID:i[o].taskid,fromDataPredecessor:i[o].fromPredecessor});n&&(n.splice(0,1),n.length>0&&a._slackCalculation(n,i,r,u,f,e))},deleteDependency:function(n,i){var r=this,o=r.model,u,e,f={fromId:n,toId:i,requestType:"deleteDependency"};if(!r._trigger("actionBegin",f)){if(u=!t.isNullOrUndefined(f.fromId)&&r._getRecordByTaskId(f.fromId.toString()),e=!t.isNullOrUndefined(f.toId)&&r._getRecordByTaskId(f.toId.toString()),!o.predecessorMapping||t.isNullOrUndefined(u)||t.isNullOrUndefined(e))return;u&&e&&u.predecessor&&(r._updatedConnectorLineCollection=[],r._connectorlineIds=[],r._isLastRefresh=!0,r._removePredecessor(u.predecessor,e,!0),this.isCriticalPathEnable==!0&&(r._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0)))}},updateDependency:function(n,i,r,u){var f=this,h=f.model,c,e,v,w,l,s={fromId:n,toId:i,requestType:"updateDependency",predecessorType:r,offset:u},o,y,p,a;if(!f._trigger("actionBegin",s)){if(c=!t.isNullOrUndefined(s.fromId)&&f._getRecordByTaskId(s.fromId.toString()),e=!t.isNullOrUndefined(s.toId)&&f._getRecordByTaskId(s.toId.toString()),!h.predecessorMapping||t.isNullOrUndefined(c)||t.isNullOrUndefined(e)||!c||!e)return;if(v=s.fromId.toString(),w=s.toId.toString(),r=s.predecessorType,u=s.offset,e.predecessor.length>0){if(o=e.predecessor.filter(function(n){return n.from==v}),t.isNullOrUndefined(o[0]))return;y=JSON.parse(JSON.stringify(e.predecessor));p=["FS","SS","SF","FF"];(t.isNullOrUndefined(r)||p.indexOf(r.toUpperCase())<0)&&(r=o[0].predecessorsType);t.isNullOrUndefined(u)||u.length==0?(u=o[0].offset,l=o[0].offsetDurationUnit):(a=e._getOffsetDurationUnit(u,this._durationUnitEditText,h.durationUnit),u=a.duration,l=a.durationUnit);(o[0].offset!=u||o[0].predecessorsType!=r)&&(o[0].predecessorsType=r,o[0].offset=u,o[0].offsetDurationUnit=l,f._updatedConnectorLineCollection=[],f._connectorlineIds=[],f._isLastRefresh=!1,f._validatePredecessor(e,y),f._$ganttchartHelper.ejGanttChart("appendConnectorLine",f._updatedConnectorLineCollection),f._updateConnectorLineCollection(f._updatedConnectorLineCollection),e.item[h.predecessorMapping]=f._predecessorToString(e.predecessor,e),e.predecessorsName=e.item[h.predecessorMapping],h.enableWBS&&h.enableWBSPredecessor&&f._$treegridHelper.ejTreeGrid("updateWBSPredecessor",e),h.enableSerialNumber&&f._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",e),f._isLastRefresh=!0,f.refreshGanttRecord(e),this.isCriticalPathEnable==!0&&(f._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0)))}}},_getVaildSuccessorTasks:function(n,t,i){var r=this,u=r.model,f,e;n.predecessor&&n.predecessor.length>0&&(f=n.predecessor,e=n.taskId,f.forEach(function(n){var o,f,s;n.from.toString()==e.toString()&&(o=n.to,u.enableSerialNumber?(s=u.flatRecords[u.ids.indexOf(o)],f=t.indexOf(s.serialNumber.toString())):f=t.indexOf(o),f>-1&&(t.splice(f,1),i.splice(f,1)),s=r._getRecordByTaskId(o),r._getVaildSuccessorTasks(s,t,i))}))}}})(jQuery,Syncfusion),function(n,t){"use strict";t.ganttChartFeatures=t.ganttChartFeatures||{};t.ganttChartFeatures.timescale={_getScheduleLength:function(n){var t=this,i=t.model;switch(n){case"week":return i.scheduleWeeks.length*t._scheduleWeekWidth;case"year":case"quarterYear":case"halfYear":return t._scheduleYearWidth;case"month":return t._scheduleMonthWidth;case"day":return i.scheduleDays.length*t.model.perHourWidth*24;case"hour":return i.scheduleHours.length*i.perMinuteWidth*t._totalInterval;default:return i.scheduleWeeks.length*t._scheduleWeekWidth}},_updateScheduleWidth:function(){var n=this;n._scheduleWeekWidth=n._getWeekWidth();n._numOfWeeks=n._getNumberOftWeeks(this.model.projectStartDate,this.model.projectEndDate);n._scheduleYearWidth=n._getYearWidth();n._scheduleMonthWidth=n._getMonthWidth();n._totalWeekWidth=n._scheduleWeekWidth*n._numOfWeeks.length;n._balanceWidth=n._totalWeekWidth-n._scheduleMonthWidth;n._scheduleMonthWidth+=n._balanceWidth},refreshChartHeader:function(i,r){var f=this,s=f.model,u=s.scheduleHeaderSettings.scheduleHeaderType,l,v,h,e,c,a,o,y,p;f._updateScheduleWidth();u=="hour"?f._createScheduleTopHourTemplate():u=="day"?f._createScheduleTopDayTemplate():u=="week"?f._createScheduleWeekTemplate():u=="month"?f._createScheduleTopMonthTemplate():(u=="year"||u=="quarterYear"||u=="halfYear")&&f._createScheduleYearTemplate();i=i==null?new Date:i;r=r==null?new Date(null):r;f._$scheduleDiv.empty();o=t.buildTag("table.e-schedule-headerrow-week e-zerospacing","",{display:"block"});l=t.buildTag("colgroup","",{},{});v=n(document.createElement("col"));v.css("width",f._getScheduleLength(u)+"px");l.append(v);h=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{});u=="week"?e=t.buildTag("tr",n.render[this._id+"ScheduleWeekTemplate"](s.scheduleWeeks),{},{}):u=="year"||u=="quarterYear"||u=="halfYear"?e=t.buildTag("tr",n.render[this._id+"ScheduleYearTemplate"](s.scheduleYears),{},{}):u=="month"?e=t.buildTag("tr",n.render[this._id+"ScheduleTopMonthTemplate"](s.scheduleMonths),{},{}):u=="day"?e=t.buildTag("tr",n.render[this._id+"ScheduleTopDayTemplate"](s.scheduleDays),{},{}):u=="hour"&&(e=t.buildTag("tr",n.render[this._id+"ScheduleTopHourTemplate"](s.scheduleHours),{},{}));c=t.buildTag("th.e-ganttchart-schedule","",{},{});a=t.buildTag("div.e-ganttchart-schedule","",{width:"20px"},{});c.append(a);e.append(c);h.append(e);o.append(l);o.append(h);f._$scheduleDiv.append(o);e=null;u=="hour"?f._createMinuteTemplate():u=="day"?f._createScheduleHourTemplate():u=="week"?f._createScheduleDayTemplate():u=="month"?f._createScheduleBottomWeekTemplate():u=="year"?f._createScheduleMonthTemplate():(u=="quarterYear"||u=="halfYear")&&f._createScheduleQuarterlyTemplate();o=t.buildTag("table.e-schedule-headerrow-day e-zerospacing","",{display:"block","border-collapse":"collapse"});h=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{});y=f._getScheduleMonth(new Date(s.scheduleYears[0]),r);p=u=="quarterYear"||u=="halfYear"?this._getQuarterHalfYearData(y,u):y;u=="week"&&(e=t.buildTag("tr",n.render[this._id+"_CustomTemplate1"](f.model.scheduleWeeks),{},{}));(u=="year"||u=="quarterYear"||u=="halfYear")&&(e=t.buildTag("tr",n.render[this._id+"ScheduleMonthTemplate"](p),{},{}));u=="month"&&(f._numOfWeeks=f._getNumberOftWeeks(this.model.projectStartDate,this.model.projectEndDate),e=t.buildTag("tr",n.render[this._id+"ScheduleBottomWeekTemplate"](f._numOfWeeks),{},{}));u=="day"&&(e=t.buildTag("tr",n.render[this._id+"scheduleHourTemplate"](f._getScheduleHours()),{},{}));u=="hour"&&(e=t.buildTag("tr",n.render[this._id+"scheduleMinuteTemplate"](f._getScheduleMinutes()),{},{}));c=t.buildTag("th.e-ganttchart-schedule","",{},{});a=t.buildTag("div.e-ganttchart-schedule","",{width:"20px"},{});c.append(a);e.append(c);h.append(e);o.append(l);o.append(h);f._$scheduleDiv.append(o)},_createScheduleTopDayTemplate:function(){var t=this,r=t.model,o=r.scheduleHeaderSettings.dayHeaderFormat==""&&r.scheduleHeaderSettings.scheduleHeaderType=="day"?"ddd":r.scheduleHeaderSettings.dayHeaderFormat,u={},i,e,f;u["_"+t._id+"renderDayTop"]=n.proxy(t._getFormattedDay,t);u["_"+t._id+"getDayWidth"]=n.proxy(t._getDayWidth,t);n.views.helpers(u);i="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;width:{{:~_"+t._id+"getDayWidth(#data)}}px;'>";e="<div class='e-schedule-week-headercell-content'  style='width:"+(t.model.perHourWidth*24-1)+"px;box-sizing:border-box;margin:auto;white-space:nowrap;'>{{:~_"+t._id+"renderDayTop('"+o+"',#data)}}<\/div><\/div>";i+=e;i+="<\/th>";f={};f[t._id+"ScheduleTopDayTemplate"]=i;n.templates(f)},_getFormattedDay:function(n,i){var r=new Date(i),u=this,f=u.model;switch(n){case"D":case"d":return r.getDate();default:return t.format(r,n,f.locale)}},_createScheduleTopMonthTemplate:function(){var t=this,f,e=t.model,o=e.scheduleHeaderSettings.monthHeaderFormat,i={},r,u;i["_"+t._id+"renderMonthTop"]=n.proxy(t._getFormattedMonth,t);i["_"+t._id+"setMonthWidth"]=n.proxy(t._setMonthWidth,t);i["_"+t._id+"isLastMonth"]=n.proxy(t._checkLastMonthWidth,t);n.views.helpers(i);r="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;width:{{:~_"+t._id+"setMonthWidth(#data)}}px;'>";f="<div class='e-schedule-week-headercell-content'  style='box-sizing:border-box;-moz-box-sizing:border-box;margin:auto;white-space:nowrap;width:{{:~_"+t._id+"setMonthWidth(#data)-1}}px;'>{{:~_"+t._id+"renderMonthTop('"+o+"',#data)}}<\/div>{{if ~_"+t._id+"isLastMonth(#data)}}<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;'><div class='e-schedule-week-headercell-content' style='box-sizing:border-box;-moz-box-sizing:border-box;margin:auto;white-space:nowrap;width:"+(t._balanceWidth-1)+"px;'><\/div><\/th>{{/if}}";r+=f;r+="<\/th>";u={};u[t._id+"ScheduleTopMonthTemplate"]=r;n.templates(u)},_setMonthWidth:function(n){var e=this,i,u,r,f;return(i=typeof n=="object"?new Date(n):t.parseDate(n,this.model.dateFormat,this.model.locale),u=new Date(i.getFullYear(),i.getMonth()+1,0),r=u.getDate(),i.getTime()===e.model.scheduleMonths[0].getTime())?(f=u.getDate()-i.getDate(),this.model.perDayWidth*(f+1)):r==31?this.model.perDayWidth*31:r==30?this.model.perDayWidth*30:r==28?this.model.perDayWidth*28:r==29?this.model.perDayWidth*29:void 0},_checkLastMonthWidth:function(n){var t=this;return n==t.model.scheduleMonths[t.model.scheduleMonths.length-1]&&t._balanceWidth>0?!0:!1},_getFormattedMonth:function(n,i){var r=new Date(i),u=this,f=u.model;return t.format(r,n,f.locale)},_createScheduleYearTemplate:function(){var t=this,f,e=t.model,o=e.scheduleHeaderSettings.yearHeaderFormat,r={},i,u;r["_"+t._id+"renderYear"]=n.proxy(t._getFormattedYear,t);r["_"+t._id+"getYearWidth"]=n.proxy(t._getTemplateYearWidth,t);n.views.helpers(r);i="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;width:{{:~_"+t._id+"getYearWidth(#data)}}px;'>";f="<div class='e-schedule-week-headercell-content' style='margin:auto;overflow:hidden;white-space:nowrap;width:{{:~_"+t._id+"getYearWidth(#data)-1}}px;box-sizing:border-box;-moz-box-sizing:border-box;'>{{:~_"+t._id+"renderYear('"+o+"',#data)}}<\/div>";i+=f;i+="<\/th>";u={};u[t._id+"ScheduleYearTemplate"]=i;n.templates(u)},_getFormattedYear:function(n,i){var r=new Date(i),u=this,f=u.model;return t.format(r,n,f.locale)},_getMonthWidthForYearMode:function(n){for(var u,o=this,e=o.model,n,i=0,f=n.getMonth();f<12;f++){u=n;n=typeof u=="object"?new Date(u):t.parseDate(u,e.dateFormat,e.locale);var s=new Date(n.getFullYear(),n.getMonth()+1,0),h=n.getDate(),r=s.getDate();h!=1?i+=r-n.getDate():r==31?i+=31:r==30?i+=30:r==28?i+=28:r==29&&(i+=29);n=new Date(n.getFullYear(),f+1,1)}return i},_getTemplateYearWidth:function(n){var i=n.getFullYear(),t=this._getMonthWidthForYearMode(n);return t*this.model.perDayWidth},_createScheduleWeekTemplate:function(){var t=this,u,e=t.model,o=e.scheduleHeaderSettings.weekHeaderFormat,f={},i,r;f["_"+t._id+"renderWeek"]=n.proxy(t._getFormattedWeek,t);n.views.helpers(f);i="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;width:"+t._scheduleWeekWidth+"px;'>";u="<div class='e-schedule-week-headercell-content'  style='width:"+(t._scheduleWeekWidth-1)+"px;box-sizing:border-box;margin:auto;white-space:nowrap;'>{{:~_"+t._id+"renderWeek('"+o+"',#data)}}<\/div>";i+=u;i+="<\/th>";r={};r[t._id+"ScheduleWeekTemplate"]=i;n.templates(r)},_getFormattedWeek:function(n,i){var u=new Date(i),f=this,e=f.model,r;return r=t.format(u,n,e.locale),r.toLowerCase().replace(/(-(\w)|(^| )(\w)|:(\w)|,(\w)|\/(\w)|\.(\w))/g,function(n){return n.toUpperCase()})},_createScheduleHourTemplate:function(){var t=this,e=t.model,u,o=e.scheduleHeaderSettings.hourHeaderFormat,f={},i,r;f["_"+t._id+"renderHour"]=n.proxy(t._getHourTemplate,t);n.views.helpers(f);i="<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perHourWidth+"px;'>";u="<div class='e-schedule-day-headercell-content' style='width:"+(t.model.perHourWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~_"+t._id+"renderHour('"+o+"',#data)}}<\/div>";i+=u;i+="<\/th>";r={};r[t._id+"scheduleHourTemplate"]=i;n.templates(r)},_createScheduleTopHourTemplate:function(){var t=this,e=t.model,r=e.minuteInterval,o,i,h=e.scheduleHeaderSettings.hourHeaderFormat,s={},u,f;s["_"+t._id+"renderHour"]=n.proxy(t._getHourTemplate,t);r==30&&(i=2);r==15&&(i=4);r==5&&(i=12);r==1&&(i=60);t._totalInterval=i;n.views.helpers(s);u="<th  class='e-schedule-hour-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perMinuteWidth*i+"px;'>";o="<div class='e-schedule-hour-headercell-content' style='width:"+(t.model.perMinuteWidth*i-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~_"+t._id+"renderHour('"+h+"',#data)}}<\/div>";u+=o;u+="<\/th>";f={};f[t._id+"ScheduleTopHourTemplate"]=u;n.templates(f)},_createMinuteTemplate:function(){var t=this,e=t.model,u,o=e.scheduleHeaderSettings.minuteHeaderFormat,f={},i,r;f["_"+t._id+"renderHour"]=n.proxy(t._getHourTemplate,t);n.views.helpers(f);i="<th class='e-schedule-hour-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perMinuteWidth+"px;'>";u="<div class='e-schedule-hour-headercell-content' style='width:"+(t.model.perMinuteWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~_"+t._id+"renderHour('"+o+"',#data)}}<\/div>";i+=u;i+="<\/th>";r={};r[t._id+"scheduleMinuteTemplate"]=i;n.templates(r)},_getHourTemplate:function(n,i){var r=new Date(i),u=this,f=u.model;return t.format(r,n,f.locale)},_createScheduleBottomWeekTemplate:function(){var t=this,u,e=t.model,o=e.scheduleHeaderSettings.weekHeaderFormat,f={},i,r;f["_"+t._id+"renderWeek"]=n.proxy(t._getMonthWeekTemplate,t);n.views.helpers(f);i="<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perWeekWidth+"px;'>";u="<div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;padding-left:2px;width:"+(t.model.perWeekWidth-1)+"px;'>{{:~_"+t._id+"renderWeek('"+o+"',#data)}}<\/div>";i+=u;i+="<\/th>";r={};r[t._id+"ScheduleBottomWeekTemplate"]=i;n.templates(r)},_getMonthWeekTemplate:function(n,i){var r=new Date(i),u=this,f=u.model;switch(n){case"d":return r.getDate();default:return t.format(r,n,f.locale)}},_createScheduleQuarterlyTemplate:function(){var t=this,u=t.model,r="<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:{{:width}}px;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~_"+t._id+"getMonthWidth(#data)-1}}px;'>{{:mode}}<\/div><\/th>",i={};i[t._id+"ScheduleMonthTemplate"]=r;n.templates(i)},_createScheduleMonthTemplate:function(){var t=this,f=t.model,e=f.scheduleHeaderSettings.monthHeaderFormat,i={},u,r;i["_"+t._id+"renderMonth"]=n.proxy(t._getMonthTemplate,t);i["_"+t._id+"getMonthWidth"]=n.proxy(t._setMonthWidthYearMode,t);n.views.helpers(i);u="<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:{{:~_"+t._id+"getMonthWidth(#data)}}px;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~_"+t._id+"getMonthWidth(#data)-1}}px;'>{{:~_"+t._id+"renderMonth('"+e+"',#data)}}<\/div><\/th>";r={};r[t._id+"ScheduleMonthTemplate"]=u;n.templates(r)},_getMonthTemplate:function(n,i){var r=new Date(i),u=this,f=u.model;switch(n){case"M":case"m":return r.getMonth()+1;default:return t.format(r,n,f.locale)}},_getMonthWidthForQuarterYear:function(n){for(var s=this,r=0,f=n.length,i=0;i<f;i++){var t=new Date(n[i]),e=new Date(t.getFullYear(),t.getMonth()+1,0),o=t.getDate(),u=e.getDate();r+=this.model.perDayWidth*(o!=1?u-t.getDate():u)}return r},_setMonthWidthYearMode:function(n){var f=this,i=new Date(n),r=new Date(i.getFullYear(),i.getMonth()+1,0),u=i.getDate(),t=r.getDate();return u!=1?this.model.perDayWidth*(t-i.getDate()):t==31?this.model.perDayWidth*31:t==30?this.model.perDayWidth*30:t==28?this.model.perDayWidth*28:t==29?this.model.perDayWidth*29:void 0},_getHeaderWeek:function(n,t){var i=new Date(t);return i.setDate(i.getDate()+n),this._nonWorkingDayIndex.indexOf(i.getDay())!=-1?!0:void 0},_getDayWidth:function(n){var t=new Date(n),r=0,i;return t.setHours(0,0,0,0),i=new Date(t),i.setHours(24,0,0,0),r=(i.getTime()-t.getTime())/36e5,r*this.model.perHourWidth},_createScheduleDayTemplate:function(){var t=this,o,u=t.model,i=u.scheduleHeaderSettings.dayHeaderFormat==""&&u.scheduleHeaderSettings.scheduleHeaderType=="day"?"ddd":u.scheduleHeaderSettings.dayHeaderFormat,f={},r,e;f["_"+t._id+"renderDay"]=n.proxy(t._getDayTemplate,t);f["_"+t._id+"getHeader"]=n.proxy(t._getHeaderWeek,t);n.views.helpers(f);r="<th  class='e-schedule-day-headercell {{if ~_"+t._id+"getHeader(0,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perDayWidth+"px;{{if ~_"+t._id+"getHeader(0,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>";o="<div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+t._id+"getHeader(0,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+t._id+"renderDay('"+i+"',0,#data)}}<\/div><th  class='e-schedule-day-headercell {{if ~_"+t._id+"getHeader(1,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perDayWidth+"px;{{if ~_"+t._id+"getHeader(1,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+t._id+"getHeader(1,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+t._id+"renderDay('"+i+"',1,#data)}}<\/div><th  class='e-schedule-day-headercell {{if ~_"+t._id+"getHeader(2,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perDayWidth+"px;{{if ~_"+t._id+"getHeader(2,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+t._id+"getHeader(2,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+t._id+"renderDay('"+i+"',2,#data)}}<\/div><th  class='e-schedule-day-headercell {{if ~_"+t._id+"getHeader(3,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perDayWidth+"px;{{if ~_"+t._id+"getHeader(3,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+t._id+"getHeader(3,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+t._id+"renderDay('"+i+"',3,#data)}}<\/div><th  class='e-schedule-day-headercell {{if ~_"+t._id+"getHeader(4,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perDayWidth+"px;{{if ~_"+t._id+"getHeader(4,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+t._id+"getHeader(4,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+t._id+"renderDay('"+i+"',4,#data)}}<\/div><th  class='e-schedule-day-headercell {{if ~_"+t._id+"getHeader(5,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perDayWidth+"px;{{if ~_"+t._id+"getHeader(5,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+t._id+"getHeader(5,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+t._id+"renderDay('"+i+"',5,#data)}}<\/div><th  class='e-schedule-day-headercell {{if ~_"+t._id+"getHeader(6,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+t.model.perDayWidth+"px;{{if ~_"+t._id+"getHeader(6,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(t.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+t._id+"getHeader(6,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+t._id+"renderDay('"+i+"',6,#data)}}<\/div>";r+=o;r+="<\/th>";e={};e[t._id+"_CustomTemplate1"]=r;n.templates(e)},_getDayTemplate:function(n,i,r){var u=new Date(r),e=this,f=e.model;u.setDate(u.getDate()+i);switch(n){case"D":case"d":return u.getDate();case"DD":case"dd":case"DDD":case"ddd":case"DDDD":case"dddd":return t.format(u,n,f.locale);case"":return n="ddd",t.format(u,n,f.locale)[0].toUpperCase();default:return t.format(u,n,f.locale).toUpperCase()}},_getNumberOftWeeks:function(n,t){var i=new Date(n),u=new Date(t),r=[];do r.push(new Date(i)),i.setDate(i.getDate()+7);while(!(i>u));return r},_getScheduleMonth:function(n,t){var f=this,i=f.model,r=[],e,u;for(t=t.getMonth()<11?new Date(t.getFullYear(),11,31):t,e=new Date(n.getFullYear(),11,31)<new Date(i.scheduleEndDate)?12:new Date(i.scheduleEndDate).getMonth()+1,u=n.getMonth();n<t;u++)r.push(n),n=new Date(n.getFullYear(),n.getMonth()+1,1);return r},_getQuarterHalfYearData:function(n,t){for(var c=[],o,s,a=n.length,l,f,e=this.model.ganttInstance,i=0;i<a;i++){var u=[],h={},r=n[i].getMonth();r/3<1?(o=1,s=1):r/3<2?(o=2,s=1):r/3<3?(o=3,s=2):r/3<4&&(o=4,s=2);r%3==0?(u.push(n[i]),u.push(n[i+1]),u.push(n[i+2]),i=i+2):r%3==1?(u.push(n[i]),u.push(n[i+1]),i=i+1):r%3==2&&u.push(n[i]);t=="halfYear"&&(r==0||r==1||r==2||r==6||r==7||r==8)&&(u.push(n[i+1]),u.push(n[i+2]),u.push(n[i+3]),i=i+3);h.width=this._getMonthWidthForQuarterYear(u);l=t=="halfYear"?"H"+s:"Q"+o;switch(l){case"Q1":f=e._quarterYearTexts.first;break;case"Q2":f=e._quarterYearTexts.second;break;case"Q3":f=e._quarterYearTexts.third;break;case"Q4":f=e._quarterYearTexts.fourth;break;case"H1":f=e._halfYearTexts.first;break;case"H2":f=e._halfYearTexts.second}h.mode=f;c.push(h)}return c},_createSchedule:function(i,r){var u=this,a=u.model,f=a.scheduleHeaderSettings.scheduleHeaderType,c,v,s,e,h,l,o,y,p;i=i==null?new Date:i;r=r==null?new Date(null):r;u._createScheduleWeekTemplate();u._createScheduleYearTemplate();u._createScheduleTopMonthTemplate();u._createScheduleTopDayTemplate();u._createScheduleTopHourTemplate();o=t.buildTag("table.e-schedule-headerrow-week e-zerospacing","",{display:"block"});c=t.buildTag("colgroup","",{},{});v=n(document.createElement("col"));v.css("width",u._getScheduleLength(f)+"px");c.append(v);s=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{});f=="week"?e=t.buildTag("tr",n.render[this._id+"ScheduleWeekTemplate"](u.model.scheduleWeeks),{},{}):f=="year"||f=="quarterYear"||f=="halfYear"?e=t.buildTag("tr",n.render[this._id+"ScheduleYearTemplate"](u.model.scheduleYears),{},{}):f=="month"?e=t.buildTag("tr",n.render[this._id+"ScheduleTopMonthTemplate"](u.model.scheduleMonths),{},{}):f=="day"?e=t.buildTag("tr",n.render[this._id+"ScheduleTopDayTemplate"](u.model.scheduleDays),{},{}):f=="hour"&&(e=t.buildTag("tr",n.render[this._id+"ScheduleTopHourTemplate"](u.model.scheduleHours),{},{}));h=t.buildTag("th.e-ganttchart-schedule","",{},{});l=t.buildTag("div.e-ganttchart-schedule","",{width:"20px"},{});h.append(l);e.append(h);s.append(e);o.append(c);o.append(s);u._$scheduleDiv.append(o);e=null;u._createScheduleDayTemplate();u._createScheduleMonthTemplate();u._createScheduleBottomWeekTemplate();u._createMinuteTemplate();u._createScheduleHourTemplate();(f=="quarterYear"||f=="halfYear")&&u._createScheduleQuarterlyTemplate();o=t.buildTag("table.e-schedule-headerrow-day e-zerospacing","",{display:"block","border-collapse":"collapse"});s=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{});y=u._getScheduleMonth(new Date(a.scheduleYears[0]),r);p=f=="quarterYear"||f=="halfYear"?this._getQuarterHalfYearData(y,f):y;f=="week"&&(e=t.buildTag("tr",n.render[this._id+"_CustomTemplate1"](a.scheduleWeeks),{},{}));(f=="year"||f=="quarterYear"||f=="halfYear")&&(e=t.buildTag("tr",n.render[this._id+"ScheduleMonthTemplate"](p),{},{}));f=="month"&&(e=t.buildTag("tr",n.render[this._id+"ScheduleBottomWeekTemplate"](u._numOfWeeks),{},{}));f=="day"&&(e=t.buildTag("tr",n.render[this._id+"scheduleHourTemplate"](u._getScheduleHours()),{},{}));f=="hour"&&(e=t.buildTag("tr",n.render[this._id+"scheduleMinuteTemplate"](u._getScheduleMinutes()),{},{}));h=t.buildTag("th.e-ganttchart-schedule","",{},{});l=t.buildTag("div.e-ganttchart-schedule","",{width:"20px"},{});h.append(l);e.append(h);s.append(e);o.append(c);o.append(s);u._$scheduleDiv.append(o);u._$headerContainer.append(u._$scheduleDiv);u._$ganttChartContainer.append(u._$headerContainer);n("#"+u._id).append(u._$ganttChartContainer)},_getScheduleHours:function(){var n=this,r=n.model,t=new Date(n.model.projectStartDate),i=new Date(r.projectEndDate);n._scheduleHours=[];i.setHours(24);do n._scheduleHours.push(new Date(t)),t.setTime(t.getTime()+36e5);while(!(t.getTime()>=i.getTime()));return n._scheduleHours},_getScheduleMinutes:function(){var n=this,i=n.model,t=new Date(n.model.projectStartDate),r=new Date(i.projectEndDate);r.setMinutes(60);t.setMinutes(0);n._scheduleMinutes=[];do n._scheduleMinutes.push(new Date(t)),t.setMinutes(t.getMinutes()+i.minuteInterval);while(!(t.getTime()>=r.getTime()));return n._scheduleMinutes}}}(jQuery,Syncfusion),function(n,t){t.ganttChartFeatures=t.ganttChartFeatures||{};t.ganttChartFeatures.resourceViewGantt={_unassignedTask:function(){return this.data.eResourceTaskType=="unassignedTask"?!0:!1},_getMarginTopValue:function(n){return(n.eOverlapIndex-1)*this.model.rowHeight+this._marginTop},_getRangeHeight:function(n){return this._getTemplateRowHeight(n)-this._marginTop*2},_getTemplateRowHeight:function(n){return this.model.viewType=="resourceView"?n.eOverlapIndex*this.model.rowHeight:this.model.rowHeight},_createResourceTaskbarTemplate:function(){var i=this,r=i.model,e,s=r.scheduleHeaderSettings.scheduleHeaderType,w,h=4,u,b,k,et=0,ot=!1,st=!1,ht="",ct="",yt=r.baselineColor,d=r.taskbarTemplate,c,l=!1,lt=!1,g=r.parentTaskbarTemplate,nt,tt=!1,pt=r.milestoneTemplate,it=r.leftTaskLabelTemplate,rt=!1,at="",ut=r.rightTaskLabelTemplate,ft=!1,vt="",f={},a,v,p;f["_"+i._id+"SelectState"]=n.proxy(i._SelectState,i);f["_"+i._id+"getType"]=i._getTypedata;f["_"+i._id+"expander"]=i._addRecordExpandCollapse;f["_"+i._id+"milestoneMapping"]=i._isMilestone;f["_"+i._id+"unassignedTask"]=i._unassignedTask;f["_"+i._id+"resources"]=n.proxy(i._getResourceInfo,i);f["_"+i._id+"rowClassName"]=t.TreeGrid._getrowClassName;f["_"+i._id+"expandStatus"]=n.proxy(i._getExpandStatusRecord,i);f["_"+i._id+"borderRadius"]=i._getBorderRadius;f["_"+i._id+"getRowHeight"]=n.proxy(i._getTemplateRowHeight,i);f["_"+i._id+"getMarginTop"]=n.proxy(i._getMarginTopValue,i);f["_"+i._id+"getRangeHeight"]=n.proxy(i._getRangeHeight,i);i._marginTop=(r.rowHeight-r.taskbarHeight)/2;i._fontSize=i._getFontSize();i._resizerRightAdjust=i._fontSize*.8;i._resizerMargin=i._getMargin();i._resizerLeftAdjust=i._getResizerLeftAdjust();s=="week"?e=r.scheduleWeeks.length*i._scheduleWeekWidth:s=="year"?e=i._scheduleYearWidth:s=="month"?e=i._scheduleMonthWidth:s=="day"?e=r.scheduleDays.length*r.perHourWidth*24:s=="hour"&&(e=r.scheduleHours.length*r.perMinuteWidth*i._totalInterval);r.renderBaseline?(r.taskbarHeight+h<=r.rowHeight?(a=r.taskbarHeight,b=0):(a=r.taskbarHeight-h,b=-4),u=a,k=r.rowHeight-h-5):(u=r.taskbarHeight,k=r.rowHeight-10);et=u/5;n.views.helpers(f);r.progressMapping||(this.model.showProgressStatus=!1);r.resourceInfoMapping||(r.showResourceNames=!1);d&&(l=!0,v=this._processTaskbarTemplate(d,u,"resourceTemplate"),c=v.template,lt=v.isProgressbarTemplate);g&&(tt=!0,nt=this._processParentTaskbarTemplate(g,u));it&&(at=this._processTaskLabelTemplate(it),rt=!0);ut&&(vt=this._processTaskLabelTemplate(ut),ft=!0);this.model.leftTaskLabelMapping&&rt==!1&&(ot=!0,ht=i._getLeftTaskLabel());this.model.rightTaskLabelMapping&&ft==!1&&(st=!0,ct=i._getRightTaskLabel());var wt=Math.round(-((this.model.rowHeight-1)/2)),y="<tr class='{{:~_"+i._id+"rowClassName()}}  {{if isSelected && ~_"+i._id+"SelectState()}}e-ganttrowcell {{:~_"+i._id+"expander()}} e-gantt-mouseclick{{else}}e-ganttrowcell {{:~_"+i._id+"expander()}}{{/if}}'style='display:{{:~_"+i._id+"expandStatus(#data)}};background-color:{{if rowBGColor }}{{:rowBGColor}}{{else}} none{{/if}};height:{{:~_"+i._id+"getRowHeight(#data)}}px;'>",o="{{:~_"+i._id+"borderRadius()}}";w="{{if ~_"+i._id+"getType()}}<td  class='e-chartcell' style='width:"+e+"px; vertical-align:middle;'><div class='e-parentContainer' style='{{if !startDate}}display:none;{{/if}}height:"+(this.model.taskbarHeight-1)+"px;z-index:3;'>{{if "+tt+"}}"+nt+"{{else}}<div class='e-gantt-parenttaskbar-innerdiv {{:~_"+i._id+"expander()}} e-parentTask' style='background-color:{{if parentTaskbarBackground }}{{:parentTaskbarBackground}}{{else}} "+this.model.parentTaskbarBackground+"{{/if}}; left:{{:left}}px;width:{{:width}}px;height:"+u+"px;'><div  class='e-gantt-parenttaskbar-progress {{:~_"+i._id+"expander()}} e-parentTask progressbar' style='top:-1px;border-style:{{if progressWidth}}solid{{else}}none{{/if}}; left:-1px;width:{{:progressWidth}}px;position:absolute;background-color:{{if parentProgressbarBackground }}{{:parentProgressbarBackground}}{{else}} "+this.model.parentProgressbarBackground+"{{/if}};z-index:3;border-top-right-radius:"+o+"px;border-bottom-right-radius:"+o+"px;height:"+u+"px;'><span class='e-rg-tasklabel e-tasklabel' style='line-height:"+(u-1)+"px;width:{{:width-10}}px;'>{{:eResourceName}}<\/span><\/div><\/div>{{/if}}<\/div><\/td>{{else ~_"+i._id+"unassignedTask()}}<td class='e-chartcell' style='vertical-align:top;width:"+e+"px;'><div  class='e-childContainer' style='left:{{:left}}px;width:{{:width}}px;margin-top:{{:~_"+i._id+"getMarginTop(#data)}}px;height:"+this.model.taskbarHeight+"px;position:absolute;'><div class='e-taskbarresizer-left e-icon' style='width:10px;margin-top:"+i._resizerMargin+"px;height:"+u+"px;font-size:"+i._fontSize+"px;'><\/div>{{if "+l+"}}"+c+"{{else}}<div  class='e-gantt-childtaskbar' style='width:{{:width}}px;height:"+u+"px;background-color:{{if taskbarBackground }}{{:taskbarBackground}}{{else}} "+this.model.taskbarBackground+"{{/if}};'><div  class='e-gantt-childtaskbar-progress progressbar' style='border-style:{{if progressWidth}}solid{{else}}none{{/if}};width:{{:progressWidth}}px;line-height:"+(u-1)+"px;height:"+this.model.progressbarHeight*(u/100)+"px; top:-1px;left:-1px;position:absolute;background-color:{{if progressbarBackground }}{{:progressbarBackground}}{{else}} "+this.model.progressbarBackground+"{{/if}};border-top-right-radius:"+o+"px;border-bottom-right-radius:"+o+"px;'><span class='e-rg-tasklabel e-tasklabel' style='line-height:"+(u-1)+"px;width:{{:width-10}}px;'>{{:taskName}}<\/span><\/div><\/div>{{/if}}<div class='e-taskbarresizer-right e-icon' style='left:{{:width-"+i._resizerRightAdjust+"}}px;width:10px;height:"+u+"px;font-size:"+i._fontSize+"px;position:absolute;z-index:2;margin-top:"+i._resizerMargin+"px;'><\/div><\/div><\/td>{{else}}<td class='e-chartcell' style='vertical-align:top;width:"+e+"px;'>{{for eResourceChildTasks}}<div  class='e-childContainer' style='margin-top:{{:~_"+i._id+"getMarginTop(#data)}}px;left:{{:left}}px;width:{{:width}}px;height:"+this.model.taskbarHeight+"px;position:absolute;'><div class='e-taskbarresizer-left e-icon' style='left:"+(2-i._resizerLeftAdjust)+"px;width:10px;margin-top:"+i._resizerMargin+"px;height:"+u+"px;font-size:"+i._fontSize+"px;'><\/div>{{if "+l+"}}"+c+"{{else}}<div  class='e-gantt-childtaskbar' style='width:{{:width}}px;height:"+u+"px;background-color:{{if taskbarBackground }}{{:taskbarBackground}}{{else}} "+this.model.taskbarBackground+"{{/if}};'><div  class='e-gantt-childtaskbar-progress progressbar' style='border-style:{{if progressWidth}}solid{{else}}none{{/if}};width:{{:progressWidth}}px;line-height:"+(u-1)+"px;height:"+this.model.progressbarHeight*(u/100)+"px; top:-1px;left:-1px;position:absolute;background-color:{{if progressbarBackground }}{{:progressbarBackground}}{{else}} "+this.model.progressbarBackground+"{{/if}};border-top-right-radius:"+o+"px;border-bottom-right-radius:"+o+"px;'><span class='e-rg-tasklabel e-tasklabel' style='line-height:"+(u-1)+"px;width:{{:width-10}}px;'>{{:taskName}}<\/span><\/div><\/div>{{/if}}<div class='e-taskbarresizer-right e-icon' style='left:{{:width-"+i._resizerRightAdjust+"}}px;width:10px;height:"+u+"px;font-size:"+i._fontSize+"px;position:absolute;z-index:2;margin-top:"+i._resizerMargin+"px;'><\/div><\/div>{{/for}}<div class='e-rangecontainer'>{{for eRangeValues ~height=~_"+i._id+"getRangeHeight(#data)}}<div class='e-rg-rangdiv' style='position:absolute;left:{{:left}}px;margin-top:"+i._marginTop+"px;height:{{>~height}}px;width:2px;'><\/div><div class='e-rg-rangdiv' style='position:absolute;left:{{:left}}px;margin-top:"+(i._marginTop-2)+"px;height:2px;width:12px'><\/div><div class='e-rg-rangdiv' style='position:absolute;left:{{:left}}px;margin-top:{{>~height +"+i._marginTop+"}}px;height:2px;width:12px'><\/div><div class='e-rg-rangdiv' style='position:absolute;left:{{:left + width}}px;margin-top:"+i._marginTop+"px;height:{{>~height}}px;width:2px;'><\/div><div class='e-rg-rangdiv' style='position:absolute;left:{{:left + width -10}}px;margin-top:"+(i._marginTop-2)+"px;height:2px;width:12px'><\/div><div class='e-rg-rangdiv' style='position:absolute;left:{{:left + width -10}}px;margin-top:{{>~height +"+i._marginTop+"}}px;height:2px;width:12px'><\/div>{{/for}}<\/div><\/td>{{/if}}";y+=w;y+="<\/tr>";p={};p[this._id+"_CustomTemplate2"]=y;n.templates(p)}}}(jQuery,Syncfusion),function(n,t,i){"use strict";t.ganttFeatures=t.ganttFeatures||{};t.widget("ejGantt","ej.Gantt",{_rootCSS:"e-gantt",element:null,validTags:["div"],_requiresID:!0,model:null,_tags:[{tag:"holidays",attr:["day","background","label"],content:"template"},{tag:"stripLines",attr:["day","label","lineStyle","lineColor","lineWidth"],content:"template"},{tag:"editDialogFields",attr:["field","editType","displayInGeneralTab"],content:"template"},{tag:"filterSettings.filteredColumns",attr:["field","value","operator","predicate"]},{tag:"addDialogFields",attr:["field","editType","displayInGeneralTab"],content:"template"},{tag:"sortSettings.sortedColumns",attr:["field","direction"]},{tag:"dayWorkingTime",attr:["from","to","background"],singular:"dayWorkingTime"}],_holidays:function(){this._$ganttchartHelper.ejGanttChart("refreshHolidays");this._trigger("refresh")},_stripLines:function(){this._$ganttchartHelper.ejGanttChart("refreshStripLines");this._trigger("refresh")},_editDialogFields:function(){this._trigger("refresh")},_addDialogFields:function(){this._trigger("refresh")},defaults:{viewType:"projectView",resourceCollectionMapping:"",taskCollectionMapping:"",groupIdMapping:"",groupCollection:[],groupNameMapping:"",expandStateMapping:"",allowSorting:!1,allowColumnResize:!1,allowSelection:!0,allowMultipleExporting:!1,allowDragAndDrop:!1,dragTooltip:{showTooltip:!1,tooltipItems:[],tooltipTemplate:""},dataSource:null,showColumnChooser:!1,showColumnOptions:!1,query:null,splitterSettings:{position:"",index:-1},splitterPosition:"",taskIdMapping:"",parentTaskIdMapping:"",taskNameMapping:"",startDateMapping:"",endDateMapping:"",baselineStartDateMapping:"",baselineEndDateMapping:"",childMapping:"",durationMapping:"",milestoneMapping:"",progressMapping:"",predecessorMapping:"",resourceInfoMapping:"",taskSchedulingModeMapping:"",workMapping:"",notesMapping:"",resources:[],holidays:[],searchSettings:{fields:[],key:"",operator:"contains",ignoreCase:!0},highlightWeekends:!0,scheduleStartDate:null,scheduleEndDate:null,enableProgressBarResizing:!0,rowHeight:30,includeWeekend:!0,taskSchedulingMode:"auto",validateManualTasksOnLinking:!1,toolbarSettings:{showToolbar:!1,toolbarItems:[],customToolbarItems:[]},filterSettings:{filteredColumns:[]},stripLines:[],workingTimeScale:"TimeScale8Hours",roundOffDayworkingTime:!0,durationUnit:"day",workUnit:"hour",taskType:"fixedUnit",perMinuteWidth:null,perHourWidth:null,perDayWidth:null,perWeekWidth:null,perMonthWidth:null,minuteInterval:null,nonWorkingBackground:"",highlightNonWorkingTime:!1,scheduleHeaderSettings:{weekHeaderFormat:"MMM dd , yyyy",dayHeaderFormat:"",yearHeaderFormat:"yyyy",monthHeaderFormat:"MMM",hourHeaderFormat:"HH",scheduleHeaderType:"week",minutesPerInterval:"auto",weekendBackground:"",timescaleStartDateMode:"auto",timescaleUnitSize:"100%",weekStartDay:0,updateTimescaleView:!0},taskbarBackground:"",progressbarBackground:"",connectorLineBackground:"",parentTaskbarBackground:"",parentProgressbarBackground:"",connectorlineWidth:1,readOnly:!1,showTaskNames:!0,leftTaskLabelMapping:"",rightTaskLabelMapping:"",leftTaskLabelTemplate:"",rightTaskLabelTemplate:"",showGridCellTooltip:!1,cellTooltipTemplate:null,showGridExpandCellTooltip:!1,showProgressStatus:!0,showResourceNames:!0,enableTaskbarDragTooltip:!0,enableTaskbarTooltip:!0,enableWBS:!1,enableWBSPredecessor:!1,editSettings:{allowEditing:!1,allowAdding:!1,allowDeleting:!1,allowIndent:!1,editMode:"normal",beginEditAction:"dblclick",rowPosition:"belowselectedrow",showDeleteConfirmDialog:!1},flatRecords:[],parentRecords:[],currentViewData:[],updatedRecords:[],selectedItems:[],ids:[],allowKeyboardNavigation:!0,cssClass:"",locale:"en-US",allowMultiSorting:!1,sortSettings:{sortedColumns:[]},enableAltRow:!0,enableVirtualization:!1,progressbarHeight:100,taskbarTooltipTemplate:"",progressbarTooltipTemplate:"",taskbarTooltipTemplateId:"",dateFormat:"",resourceIdMapping:"",resourceNameMapping:"",resourceUnitMapping:"",progressbarTooltipTemplateId:"",taskbarEditingTooltipTemplateId:"",taskbarEditingTooltipTemplate:"",selectedRowIndex:-1,allowGanttChartEditing:!0,sizeSettings:{height:"",width:""},selectedItem:null,selectionType:"single",selectionMode:"row",selectedCellIndexes:[],weekendBackground:"",baselineColor:"#fba41c",treeColumnIndex:0,editDialogFields:[],addDialogFields:[],columnDialogFields:[],renderBaseline:!1,enableContextMenu:!1,enableResize:!0,isResponsive:!0,enableCollapseAll:!1,enablePredecessorValidation:!0,taskbarTemplate:"",parentTaskbarTemplate:"",milestoneTemplate:"",durationUnitMapping:"",dayWorkingTime:[{from:"08:00 AM",to:"12:00 PM"},{from:"01:00 PM",to:"05:00 PM"}],exportToExcelAction:"",exportToPdfAction:"",workWeek:["Monday","Tuesday","Wednesday","Thursday","Friday"],rowSelecting:null,rowSelected:null,rowDragStart:null,rowDrag:null,rowDragStop:null,cellSelecting:null,cellSelected:null,queryCellInfo:null,queryTaskbarInfo:null,beginEdit:null,endEdit:null,rowDataBound:null,expanding:null,expanded:null,collapsing:null,collapsed:null,actionBegin:null,actionComplete:null,taskbarEditing:null,taskbarEdited:null,load:null,create:null,splitterResized:null,contextMenuOpen:null,enableSerialNumber:!1,taskbarClick:null,taskbarHeight:20,criticalTask:"",toolbarClick:null,predecessorTooltipTemplate:"",allowUnscheduledTask:!1},dataTypes:{viewType:"string",resourceCollectionMapping:"string",taskCollectionMapping:"string",groupIdMapping:"string",groupCollection:"array",groupNameMapping:"string",nonWorkingBackground:"string",highlightNonWorkingTime:"boolean",allowSorting:"boolean",allowColumnResize:"boolean",allowSelection:"boolean",searchSettings:{fields:"array"},dragTooltip:{tooltipItems:"array"},columnDialogFields:"array",dataSource:"data",query:"data",taskIdMapping:"string",parentTaskIdMapping:"string",taskNameMapping:"string",startDateMapping:"string",endDateMapping:"string",baselineStartDateMapping:"string",baselineEndDateMapping:"string",childMapping:"string",durationMapping:"string",milestoneMapping:"string",progressMapping:"string",predecessorMapping:"string",resourceInfoMapping:"string",taskSchedulingModeMapping:"string",notesMapping:"string",workMapping:"string",resources:"array",holidays:"array",dayWorkingTime:"array",highlightWeekends:"boolean",scheduleStartDate:"data",scheduleEndDate:"data",enableProgressBarResizing:"boolean",rowHeight:"number",includeWeekend:"boolean",taskSchedulingMode:"string",validateManualTasksOnLinking:"boolean",toolbarSettings:{showToolbar:"boolean",toolbarItems:"array",customToolbarItems:"array"},stripLines:"array",scheduleHeaderSettings:"data",roundOffDayworkingTime:"boolean",taskbarBackground:"string",progressbarBackground:"string",connectorLineBackground:"string",parentTaskbarBackground:"string",parentProgressbarBackground:"string",connectorlineWidth:"number",readOnly:"boolean",showTaskNames:"boolean",leftTaskLabelMapping:"string",rightTaskLabelMapping:"string",leftTaskLabelTemplate:"string",rightTaskLabelTemplate:"string",showProgressStatus:"boolean",showResourceNames:"boolean",enableTaskbarDragTooltip:"boolean",enableTaskbarTooltip:"boolean",editSettings:"data",flatRecords:"array",parentRecords:"array",currentViewData:"array",ids:"array",updatedRecords:"array",allowKeyboardNavigation:"boolean",cssClass:"string",locale:"string",allowMultiSorting:"boolean",showGridExpandCellTooltip:"boolean",sortSettings:{sortedColumns:"array"},filterSettings:{filteredColumns:"array",filterType:"string"},enableAltRow:"boolean",enableVirtualization:"boolean",progressbarHeight:"number",taskbarTooltipTemplate:"string",progressbarTooltipTemplate:"string",taskbarTooltipTemplateId:"string",dateFormat:"string",resourceIdMapping:"string",resourceNameMapping:"string",resourceUnitMapping:"string",progressbarTooltipTemplateId:"string",taskbarEditingTooltipTemplateId:"string",taskbarEditingTooltipTemplate:"string",allowGanttChartEditing:"boolean",size:{height:"string",width:"string"},weekendBackground:"string",baselineColor:"string",renderBaseline:"boolean",enableContextMenu:"boolean",showGridCellTooltip:"boolean",treeColumnIndex:"number",editDialogFields:"array",addDialogFields:"array",showColumnChooser:"boolean",enableResize:"boolean",isResponsive:"boolean",enableCollapseAll:"boolean",enablePredecessorValidation:"boolean",enableSerialNumber:"boolean",durationUnitMapping:"string",taskbarTemplate:"string",parentTaskbarTemplate:"string",milestoneTemplate:"string",taskbarHeight:"number",criticalTask:"string",workWeek:"array",predecessorTooltipTemplate:"string",allowUnscheduledTask:"boolean"},ignoreOnExport:["isEdit","toolbarClick","query","queryCellInfo","selectionType","currentViewData","enableRTL","rowDataBound","editSettings","localization","cssClass","dataSource","allowKeyboardNavigation"],observables:["selectedItem","selectedRowIndex","selectedCellIndexes","splitterPosition","dataSource","splitterSettings.position"],selectedItem:t.util.valueFunction("selectedItem"),selectedRowIndex:t.util.valueFunction("selectedRowIndex"),selectedCellIndexes:t.util.valueFunction("selectedCellIndexes"),splitterPosition:t.util.valueFunction("splitterSettings.position"),dataSource:t.util.valueFunction("dataSource"),_splitterPosition:t.util.valueFunction("splitterPosition"),getColumns:function(){return this._columns},setColumns:function(n){this._columns=n},getResourceViewEditColumns:function(){return this._resourceViewColumns},customColumnFields:function(){for(var i,t=this,r=t._columns,u=r.length,n=0;n<u;n++)t._columnHeaderTexts[r[n].field]||(t._columnHeaderTexts[r[n].field]=r[n].headerText);if(this.model.viewType=="resourceView")for(n=0;n<t._resourceViewColumns.length;n++)i=t._resourceViewColumns[n],t._columnHeaderTexts[i.field]||(t._columnHeaderTexts[i.field]=i.headerText),i.editType||(i.editType="stringedit")},_init:function(){var i=this,n=i.model,r=n.scheduleHeaderSettings.minutesPerInterval,u=n.durationUnit;n.isdesignMode&&(n.taskIdMapping="Id",n.taskNameMapping="Name",n.startDateMapping="StartDate",n.durationMapping="Duration",n.progressMapping="Progress",n.scheduleStartDate="02/23/2014",n.scheduleEndDate="03/10/2014",this.dataSource([{Id:1,Name:"Task 1",StartDate:"02/23/2014",Duration:5,Progress:40},{Id:2,Name:"Task 2",StartDate:"02/24/2014",Duration:5,Progress:40},{Id:3,Name:"Task 3",StartDate:"02/25/2014",Duration:5,Progress:40}]),n.sizeSettings.height="300px",n.sizeSettings.width="800px");n.scheduleStartDate||n.scheduleEndDate||r!="auto"||(n.scheduleHeaderSettings.minutesPerInterval=t.Gantt.minutesPerInterval.FiveMinutes);n.workMapping!=""&&(n.taskType=t.Gantt.TaskType.FixedWork);i._initPrivateProperties();i._trigger("load");i.element.addClass("e-gantt-core");n.workWeek.length==0&&(n.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"]);i._getNonWorkingDayIndex();this._updateProperties();this.isProjectViewData&&n.viewType==t.Gantt.ViewType.HistogramView?(n.viewType=t.Gantt.ViewType.ProjectView,n.readOnly=!0):this.isProjectViewData===!1&&n.viewType==t.Gantt.ViewType.HistogramView&&(n.viewType=t.Gantt.ViewType.ResourceView,n.readOnly=!0);this.dataSource()!==null&&n.viewType==t.Gantt.ViewType.ProjectView?this._checkDataBinding():this.dataSource()!==null&&n.viewType==t.Gantt.ViewType.ResourceView?this._checkResourceDataBinding():i._initialize()},_updateProperties:function(){var n=this.model;n.viewType=="resourceView"&&(n.enableWBS=!1,n.enableWBSPredecessor=!1)},_setTaskbarHeight:function(n){this.taskbarHeight=n<this.model.rowHeight?n:this.model.rowHeight;this._milesStoneWidth=Math.floor(this.taskbarHeight/2)*2},_deSelectRowItem:function(){var n=this,t=n.model;n._$ganttchartHelper.ejGanttChart("selectRows",-1);n._$treegridHelper.ejTreeGrid("selectRows",-1);this.selectedRowIndex(-1);t.selectedItem=null;t.selectedItems=[]},_initResourceDataSource:function(){var n=this,u=n.model,i=this._columnToSelect(),r=this.dataSource().executeQuery(i);r.done(t.proxy(function(t){n._retrivedData=t.result;n._isFlatResourceData?n._reConstructResourceData(n._retrivedData):n.secondaryDatasource=n._retrivedData;n._createResourceRecords(n.secondaryDatasource);n._initialize();n._trigger("actionComplete",{requestType:"create"})}))},_reConstructResourceData:function(t){var i=this.model,u,r,a,h,e,f,o,p,c,l,v,y,w,s;if(i.groupIdMapping.length>0&&this._groupCollection&&this._groupCollection.length>0&&i.resources.length>0){for(u=n.extend(!0,[],this._groupCollection),a=0;a<u.length;a++)this._groupIds.push(u[a][i.groupIdMapping]);this.secondaryDatasource=u}if(i.resourceIdMapping.length>0&&i.resources&&i.resources.length>0){for(r=n.extend(!0,[],i.resources),e=-1,i.resourceCollectionMapping||(i.resourceCollectionMapping="eResourceCollection"),h=i.resourceCollectionMapping,f=0;f<r.length;f++)this._resourceIds.push(r[f][i.resourceIdMapping]),i.groupIdMapping&&this._groupIds.length>0&&(e=this._groupIds.indexOf(r[f][i.groupIdMapping]),e!=-1?u[e][h]?u[e][h].push(r[f]):(u[e][h]=[],u[e][h].push(r[f])):this.secondaryDatasource.push(r[f]));this.secondaryDatasource.length==0&&(this.secondaryDatasource=r)}for(o=0;o<t.length;o++)if(p=t[o],c=t[o][i.resourceInfoMapping],i.taskCollectionMapping||(i.taskCollectionMapping="eTaskCollections"),l=i.taskCollectionMapping,c&&c.length>0)for(v=0;v<c.length;v++)y=c[v],s=-1,w=typeof y=="object"?y[i.resourceIdMapping]:y,i.resourceIdMapping.length>0&&i.resources&&i.resources.length>0&&(s=this._resourceIds.indexOf(w),s!=-1&&r.length>0?r[s][l]?r[s][l].push(p):(r[s][l]=[],r[s][l].push(p)):this.secondaryDatasource.push(t[o]));else this.secondaryDatasource.push(t[o]);return this.secondaryDatasource},_checkHistoGramDataBinding:function(){var r=this,i=r.model,v=i.flatRecords,s=n.extend(!0,[],i.resources),h,u,c,y,f,o,l,a,e;for(i.ids=[],s.forEach(function(n,t){n.eResourceChildTasks=[];n.level=0;n.taskId=n[i.resourceIdMapping];n.index=t;n.isAltRow=t%2==0?!1:!0;n.eResourceName=i.resources[t][i.resourceNameMapping];n.expanded=!0;n.hasChildRecords=!1;n.item=i.resources[t];i.ids.push(n.taskId.toString())}),r._histoGramChildTasks=[],r._histoGramChildTaskIds=[],h=0;h<v.length;h++)if(u=v[h],this.isProjectViewData){if(o=u.resourceInfo,r._histoGramChildTasks.indexOf(u)==-1&&r._histoGramChildTaskIds.indexOf(u.taskId.toString())==-1&&(r._histoGramChildTasks.push(u),r._histoGramChildTaskIds.push(u.taskId.toString())),!o||o&&o.length==0)continue;for(l=0;l<o.length;l++)a=o[l],e=s[i.ids.indexOf(a[i.resourceIdMapping].toString())],a[i.resourceIdMapping]==e.item[i.resourceIdMapping]&&e.eResourceChildTasks.push(u)}else{if(t.isNullOrUndefined(u.item[i.resourceIdMapping])||u.item[i.resourceIdMapping].length==0)continue;for(e=s[i.ids.indexOf(u.item[i.resourceIdMapping].toString())],e.eResourceChildTasks=[],c=0;c<u.eResourceChildTasks.length;c++)f=u.eResourceChildTasks[c],r._histoGramChildTasks.indexOf(f)==-1&&r._histoGramChildTaskIds.indexOf(f.taskId.toString())==-1?(r._histoGramChildTasks.push(f),r._histoGramChildTaskIds.push(f.taskId.toString())):(y=r._histoGramChildTaskIds.indexOf(f.taskId.toString()),f=r._histoGramChildTasks[y]),e.eResourceChildTasks.push(f)}i.flatRecords=s;i.allowSelection=!1;i.updatedRecords=i.flatRecords.slice();i.currentViewData=i.flatRecords.slice();i.parentRecords=i.flatRecords.slice();this._updateHistoData()},_updateHistoData:function(){for(var i,r=this.model,t=r.flatRecords,u=t.length,n=0;n<u;n++)i=t[n],this._updateHistoWorkValues(i)},_validateRanges:function(n,t){var i=this._getItemByFieldValue(n,"rangeId",t.rangeId);i?this._pushUniqueValue(i.tasks,t.tasks):n.push(t)},_updateHistoWorkValues:function(n){var i=this._setSortedChildTasks(n),s=i.length,r=[],u={},r=[],f,o,e;if(i&&i.length==0){n.workTimelineRanges=r;return}for(f=i[0].startDate,o=t.max(i,"endDate").endDate;f.getTime()<o.getTime();)e=this._getMinDateForRange(i,f),u={},u.startDate=new Date(f),u.endDate=new Date(e),u.tasks=this._getTaskByRange(f,e,i),f=new Date(e),u.tasks.length>0&&r.push(u);r=this._splitRangeCollection(r,"startDate","endDate",!0);this._calculateWorkWithRanges(r,n);n.workTimelineRanges=r},_calculateWorkWithRanges:function(n,t){for(var e,u=this.model,a=u.rowHeight-7,o=0;o<n.length;o++){var i=n[o],v=i.startDate,y=i.endDate,f=this._checkStartDate(v,t,!1),s=this._checkEndDate(y,t),c=f.getTime()<s.getTime()?this._getDuration(f,s,"day",!0):0,p=this._getTaskLeft(f,!1),l=i.tasks,w=this._getTaskWidth(f,s),h=this._secondsPerDay/3600,r=0;for(e=0;e<l.length;e++){var b=l[e],k=b.resourceInfo,d=k.filter(function(n){return n[u.resourceIdMapping]==t[u.resourceIdMapping]}),g=d[0][u.resourceUnitMapping],nt=h*(g/100);r+=nt}i.left=p;i.width=w;i.duration=c;i.workPerDay=r;i.height=a*(r/h);i.totalWork=c*r;i.totalWork%1!=0&&(i.totalWork=parseFloat(i.totalWork.toFixed(2)));i.isOverAllocated=r>h?!0:!1}},updateHistogramTask:function(r,u){var p=this.model,a,c,h,l,f,e,o,w,v,s,k,d,b,y;switch(u){case"update":if(c=r instanceof t.Gantt.GanttRecord,h=c?r.taskId:r[p.taskIdMapping],t.isNullOrUndefined(h))break;for(l=this._histoGramChildTaskIds.indexOf(h.toString()),f=this._histoGramChildTasks[l],e=c?r:this._createGanttRecord(r,f.level,f.parentItem,i),o=["startDate","endDate","duration","resourceInfo","item","taskName","resourceNames"],w=this._getGanttColumnDetails(),v=0;v<w.customColDetails.length;v++)o.push(w.customColDetails[v].field);for(a=f.resourceInfo,s=0;s<o.length;s++)o[s]=="item"?(k=n.extend({},e.item),n.each(k,function(n,t){f.item[n]=t})):o[s]=="resourceInfo"&&e[o[s]]?f[o[s]]=n.extend(!0,[],e[o[s]]):t.isNullOrUndefined(e[o[s]])||(f[o[s]]=e[o[s]]);this._validateResourceInfoValues(f,a);break;case"add":if(c=r instanceof t.Gantt.GanttRecord,h=c?r.taskId:r.item[p.taskIdMapping],t.isNullOrUndefined(h))break;if(this._histoGramChildTaskIds.indexOf(h.toString())!=-1)break;d=new t.Gantt.GanttRecord;e=c?n.extend(d,r):this._createGanttRecord(r,0,null,i);e.resourceInfo&&(e.resourceInfo=n.extend(!0,[],r.resourceInfo));this._histoGramChildTaskIds.push(h.toString());this._histoGramChildTasks.push(e);this._validateResourceInfoValues(e);break;case"delete":if(c=r instanceof t.Gantt.GanttRecord,h=c?r.taskId:r[p.taskIdMapping],t.isNullOrUndefined(h))break;if(l=this._histoGramChildTaskIds.indexOf(h.toString()),f=this._histoGramChildTasks[l],a=n.extend([],f.resourceInfo),delete f.resourceInfo,this._histoGramChildTaskIds.splice(l,1),this._histoGramChildTasks.splice(l,1),this._validateResourceInfoValues(f,a),r.hasChildRecords==!0)for(b=r.childRecords,y=0;y<b.length;y++)this.updateHistogramTask(b[y],u)}},_getUpdatingResourceDetails:function(t,i){for(var r=i?n.extend([],i):[],f=[],e=this.model,u={},o=0;o<t.length;o++){var s=t[o],c=s[e.resourceIdMapping],l=s[e.resourceUnitMapping],h=i.filter(function(n){return n[e.resourceIdMapping]==c});h.length==0?f.push(s):r.splice(r.indexOf(h[0]),1)}return r.length>0||f.length>0?(u.added=r,u.removed=f,u.isUpdated=!0,u):!1},_validateResourceInfoValues:function(n,t){var e=this.model,l=e.flatRecords,h=n.resourceInfo?n.resourceInfo:[],u=[],f,i,t=t?t:[],c=this._getUpdatingResourceDetails(t,h),o,s,r;if(c){if(o=c.added,s=c.removed,o.length>0)for(r=0;r<o.length;r++)f=o[r],i=this._getRecordByTaskId(f[e.resourceIdMapping].toString()),i.eResourceChildTasks.push(n),u.indexOf(i)==-1&&u.push(i);if(s.length>0)for(r=0;r<s.length;r++)f=s[r],i=this._getRecordByTaskId(f[e.resourceIdMapping].toString()),i.eResourceChildTasks.splice(i.eResourceChildTasks.indexOf(n),1),u.indexOf(i)==-1&&u.push(i)}for(r=0;r<h.length;r++)f=h[r],i=this._getRecordByTaskId(f[e.resourceIdMapping].toString()),u.indexOf(i)==-1&&u.push(i);this._updateRefreshHistogramTask(u)},_updateRefreshHistogramTask:function(n){for(var t=0;t<n.length;t++)this._updateHistoWorkValues(n[t]),this.refreshGanttRecord(n[t])},_getTaskByRange:function(n,t,i){for(var f=[],r=0;r<i.length;r++){var u=i[r],e=u.startDate,o=u.endDate;(e.getTime()==n.getTime()&&t.getTime()<=o.getTime()||e.getTime()<n.getTime()&&t.getTime()<=o.getTime())&&f.push(u)}return f},_getMinDateForRange:function(n,t){for(var i,f=0;f<n.length;f++){var e=n[f],r=e.startDate,u=e.endDate;(t.getTime()<r.getTime()||t.getTime()<u.getTime())&&(i||(i=t.getTime()<r.getTime()?new Date(r):new Date(u)),t.getTime()<r.getTime()&&i.getTime()>r.getTime()&&(i=new Date(r)),t.getTime()<u.getTime()&&i.getTime()>u.getTime()&&(i=new Date(u)))}return i},_pushUniqueValue:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n.indexOf(r)==-1&&n.push(r)},_getItemByFieldValue:function(n,i,r){var f=t.Query().where(i,"equal",r),u=t.DataManager(n).executeLocal(f);return u.length>0?u[0]:null},_checkResourceDataBinding:function(){var n=this,i=n.model,r;this.dataSource()==null&&this.dataSource([]);this.dataSource()instanceof t.DataManager?this._initResourceDataSource():this.dataSource().length>0||i.resources&&i.resources.length>0?(this._isFlatResourceData?(r=this._reConstructResourceData(this.dataSource()),this._createResourceRecords(r)):this._createResourceRecords(this.dataSource()),this._initialize()):this._initialize();n.model.allowSelection&&n.model.selectionType=="multiple"&&n.model.selectionMode=="row"&&n._renderMultiSelectionPopup()},_isInStartDateRange:function(n,t,i){var r=!1;return n.getTime()>=t.getTime()&&n.getTime()<i.getTime()&&(r=!0),r},_isInEndDateRange:function(n,t,i){var r=!1;return n.getTime()>t.getTime()&&n.getTime()<=i.getTime()&&(r=!0),r},_setSortedChildTasks:function(n){var i=[],r=t.Query().sortBy("startDate",t.sortOrder.Ascending);return i=t.DataManager(n.eResourceChildTasks).executeLocal(r),n.eResourceChildTasks=i.slice(),n.eResourceChildTasks},_mergeRangeCollections:function(n,i){for(var a=t.Query().sortBy("from",t.sortOrder.Ascending),f=[],h={},l={},c,r,u,s,o=t.DataManager(n).executeLocal(a),e=0;e<o.length;e++){if(f.length==0&&e==0){f.push(o[e]);continue}if(h=f[f.length-1],c=h.from,r=h.to,l=o[e],u=l.from,s=l.to,c.getTime()==u.getTime()&&r.getTime()>=s.getTime()||c.getTime()<u.getTime()&&r.getTime()>=s.getTime())continue;else c.getTime()<=u.getTime()&&r.getTime()>=u.getTime()&&r.getTime()<s.getTime()||r.getTime()<u.getTime()&&this._checkStartDate(r).getTime()==u.getTime()?h.to=s:r.getTime()<u.getTime()&&this._checkStartDate(r).getTime()!=u.getTime()&&f.push(o[e])}return i&&(f=this._splitRangeCollection(f)),f},_getRangeWithWeekSplit:function(n,t,i,r){for(var u=[],f=0;f<n.length;f++)u.push.apply(u,this._splitRangeForWeekMode(n[f],t,i,r));return u},_splitRangeCollection:function(n,i,r,u){var f=[],o=this.model.scheduleHeaderSettings.scheduleHeaderType,e;switch(o){case t.Gantt.ScheduleHeaderType.Month:if(u)f=this._getRangeWithWeekSplit(n,i,r);else return n;case t.Gantt.ScheduleHeaderType.Year:case t.Gantt.ScheduleHeaderType.QuarterYear:case t.Gantt.ScheduleHeaderType.HalfYear:if(u)f=this._getRangeWithWeekSplit(n,i,r,!0);else return n;break;case t.Gantt.ScheduleHeaderType.Week:f=this._getRangeWithWeekSplit(n,i,r);break;case t.Gantt.ScheduleHeaderType.Day:if(this._workingTimeRanges[0].from==0&&this._workingTimeRanges[0].to==86400)f=this._getRangeWithWeekSplit(n,i,r);else for(e=0;e<n.length;e++)f.push.apply(f,this._splitRangeForDayMode(n[e],i,r));break;case t.Gantt.ScheduleHeaderType.Hour:if(this._workingTimeRanges[0].from==0&&this._workingTimeRanges[0].to==86400)f=this._getRangeWithWeekSplit(n,i,r);else for(e=0;e<n.length;e++)f.push.apply(f,this._splitRangeForHourMode(n[e],i,r))}return f},_isOnHolidayOrWeekEnd:function(n,i){var f,r,u,e;if(i=t.isNullOrUndefined(i)?this.model.includeWeekend:i,!i&&this._nonWorkingDayIndex.indexOf(n.getDay())!=-1)return!0;for(f=this.model.holidays,r=0;r<f.length;r++)if(u=this._getDateFromFormat(f[r].day),e=new Date(u),u.setHours(0,0,0,0),e.setHours(23,59,59,59),n.getTime()>=u.getTime()&&n.getTime()<e.getTime())return!0},_splitRangeForWeekMode:function(t,i,r,u){var c=i?i:"from",a=r?r:"to",o=new Date(t[c]),e=new Date(t[c]),l=new Date(t[a]),v=!1,h=[],f={},s;if(e.setDate(e.getDate()+1),e.getTime()<l.getTime()){do this._isOnHolidayOrWeekEnd(e,u)?(s=new Date(e),s.setDate(e.getDate()-1),this._setTime(this._defaultEndTime,s),f={},f[c]=o,f.isSplit=!0,f[a]=s,t.tasks&&(f.tasks=n.extend([],t.tasks)),o.getTime()!=s.getTime()&&h.push(f),o=this._checkStartDate(s),e=new Date(o),v=!0):e.setDate(e.getDate()+1);while(e.getTime()<l.getTime());v?o.getTime()!=l.getTime()&&(f={},t.tasks&&(f.tasks=n.extend([],t.tasks)),f[c]=o,f[a]=l,f.isSplit=!0,h.push(f)):h.push(t)}else h.push(t);return h},_splitRangeForDayMode:function(t,i,r){var o=i?i:"from",c=r?r:"to",a=new Date(t[o]),f=new Date(t[o]),s=new Date(t[c]),h=[],u={},l,e;if(f.getTime()<s.getTime()){do l=new Date(f),e=new Date(f),this._setTime(this._defaultEndTime,e),e.getTime()<s.getTime()?(u={},t.tasks&&(u.tasks=n.extend([],t.tasks)),u[o]=l,u[c]=e,u.isSplit=!0,h.push(u)):(u={},t.tasks&&(u.tasks=n.extend([],t.tasks)),u[o]=l,u[c]=s,u.isSplit=!0,h.push(u)),f=this._checkStartDate(e);while(f.getTime()<s.getTime())}else h.push(t);return h},_splitRangeForHourMode:function(t,i,r){var s=i?i:"from",a=r?r:"to",b=new Date(t[s]),f=new Date(t[s]),h=new Date(t[a]),c=[],u,o,y;if(f.getTime()<h.getTime()){do{var p=new Date(f),e=new Date(f),l,v=-1,w=0;for(l=this._getSecondsInDecimal(f),o=0;o<this._workingTimeRanges.length;o++)if(y=this._workingTimeRanges[o],l>=y.from&&l<=y.to){v=o;break}v!=-1&&(w=Math.round(this._workingTimeRanges[v].to-l),e.setSeconds(e.getSeconds()+w));e.getTime()<h.getTime()?(u={},t.tasks&&(u.tasks=n.extend([],t.tasks)),u[s]=p,u[a]=e,u.isSplit=!0,c.push(u)):(u={},t.tasks&&(u.tasks=n.extend([],t.tasks)),u[s]=p,u[a]=h,u.isSplit=!0,c.push(u));f=this._checkStartDate(e)}while(f.getTime()<h.getTime())}else c.push(t);return c},_calculateRangeLeftWidth:function(n){for(var t=0;t<n.length;t++)n[t].left=this._getTaskLeft(n[t].from),n[t].width=this._getTaskWidth(n[t].from,n[t].to)},_updateOverlappingIndex:function(n){for(var a,t,c,l,s,u,i=[],f=1,h=0;h<n.length;h++){var r=n[h],e=new Date(r.startDate),o=new Date(r.endDate);if(r.eOverlapIndex=1,i.length==0){i.push({from:e,to:o});continue}else for(a=i.length,t=0;t<a;t++)if(c=i[t].from,l=i[t].to,this._isInStartDateRange(e,c,l)||this._isInEndDateRange(o,c,l))r.eOverlapIndex=t+2,f<r.eOverlapIndex&&(f=r.eOverlapIndex,i.push({from:e,to:o}));else{r.eOverlapIndex=t+1;s=[];u=[];s.push(i[t]);s.push({from:e,to:o});u=this._mergeRangeCollections(s);u.length>1?i[t]=u[1]:u.length==1&&(i[t]=u[0]);f<r.eOverlapIndex&&(f=r.eOverlapIndex);break}}},_updateOverlappingValues:function(n,t){var i=n.eResourceChildTasks,s,c=1,a=[],y=n.eOverlapIndex,l,h,u,f;if(i.length<=1){i.length==1&&(i[0].eOverlapIndex=1,i[0].eOverlapped=!1);n.eRangeValues=[];n.eOverlapIndex=1;n.eOverlapped=!1;return}for(i=this._setSortedChildTasks(n),this._updateOverlappingIndex(i),l=1;l<i.length;l++){s=i[l];var e=new Date(s.startDate),o=new Date(s.endDate),p=!1,v=[],r={};for(h=0;h<l;h++)u=i[h].startDate,f=i[h].endDate,r={},(this._isInStartDateRange(e,u,f)||this._isInEndDateRange(o,u,f))&&(u.getTime()>e.getTime()&&u.getTime()<o.getTime()&&f.getTime()>e.getTime()&&f.getTime()>o.getTime()||e.getTime()==u.getTime()&&o.getTime()<=f.getTime()?(r.from=u,r.to=o):e.getTime()==u.getTime()&&o.getTime()>f.getTime()?(r.from=u,r.to=f):e.getTime()>u.getTime()&&o.getTime()>=f.getTime()?(r.from=e,r.to=f):e.getTime()>u.getTime()&&o.getTime()<f.getTime()&&(r.from=e,r.to=o),r.task1=i[h],r.task2=s,v.push(r),p=!0,s.eOverlapWithIndex=h,s.eOverlapped=i[h].eOverlapped=!0,c<s.eOverlapIndex&&(c=s.eOverlapIndex));a.push.apply(a,this._mergeRangeCollections(v))}n.eRangeValues=this._mergeRangeCollections(a,!0);this._calculateRangeLeftWidth(n.eRangeValues);n.eOverlapIndex=c;n.eOverlapped=c>1?!0:!1;t&&!this._isOverlapIndexChanged&&c!=y&&(this._isOverlapIndexChanged=!0)},_removeResources:function(n){var u=[],t=n.data,f=[],o=[],s=[],e,r,i;if(this._resourceUpdatedTasksIds=[],t.eResourceTaskType=="resourceTask"&&t.parentItem&&t.parentItem.childRecords.length==1&&(t=t.parentItem),t.eResourceTaskType=="groupTask"?(u=t.childRecords,this._removeFromResourceCollection(t,"group")):t.eResourceTaskType=="resourceTask"?u.push(t):t.eResourceTaskType=="unassignedTask"&&(this._isFlatResourceData&&this._removeDataFromDataSource(t.item),e=this._resourceUniqTaskIds.indexOf(t.taskId.toString()),e!=-1&&(this._resourceUniqTaskIds.splice(e,1),this._resourceUniqTasks.splice(e,1))),u&&u.length>0)for(r=0;r<u.length;r++)this._deleteResources(u[r],f),this._removeFromResourceCollection(u[r],"resource");for(r=0;r<f.length;r++)i=f[r],i.parentItem=null,i.level=0,i.index=i.taskId,i.eOverlapIndex=1,i.eResourceTaskType="unassignedTask",i.eResourceName=this._unassignedText,o.push(i.taskId.toString()),s.push(i.item),this._removeResourceChildTask(i);n.returnObj={tasks:f,ids:o,unAssignedTasksItems:s};this._isFlatResourceData||this._updateResourceData(t,n);n.returnObj.dataSource=this.dataSource();n.returnObj.jsondata=this._jsonData;this._triggerResourceUpdate();this._resourceUpdatedTasksIds=[]},_triggerResourceUpdate:function(n){var r=n?n:this._resourceUpdatedTasksIds,u,t={},i;if(r&&r.length>0){for(t.requestType="recordUpdate",i=0;i<r.length;i++)u=this._getRecordByTaskId(r[i]),i==0?t.data=u:(t.updatedRecords||(t.updatedRecords=[]),t.updatedRecords.push(u));this._trigger("actionComplete",t)}},_removeFromResourceCollection:function(n,t){for(var u=this.model,r=t=="resource"?this._resourceCollection:this._groupCollection,f=t=="resource"?u.resourceIdMapping:u.groupIdMapping,i=0;i<r.length;i++)if(r[i][f]==n.taskId){r.splice(i,1);break}},_updateResourceData:function(n,i){var u=this,r=u.dataSource(),e=u.model,f=-1;n.eResourceTaskType=="groupTask"||n.eResourceTaskType=="resourceTask"&&t.isNullOrUndefined(n.parentItem)||n.eResourceTaskType=="unassignedTask"?r instanceof t.DataManager?r.dataSource.offline&&r.dataSource.json?(f=r.dataSource.json.indexOf(n.item),f!==-1&&r.dataSource.json.splice(f,1)):this._isDataManagerUpdate&&(u._jsonData.indexOf(n.item)!=-1,u._jsonData.splice(u._jsonData.indexOf(n.item),1)):r.indexOf(n.item)!=-1&&r.splice(r.indexOf(n.item),1):n.eResourceTaskType=="resourceTask"&&n.parentItem&&n.parentItem.item[e.resourceCollectionMapping].splice(n.parentItem.childRecords.indexOf(n),1);i.returnObj.unAssignedTasksItems.length>0&&(r instanceof t.DataManager?r.dataSource.offline&&r.dataSource.json?r.dataSource.json.push.apply(r.dataSource.json,i.returnObj.unAssignedTasksItems):this._isDataManagerUpdate&&u._jsonData.push.apply(u._jsonData,i.returnObj.unAssignedTasksItems):r.push.apply(r,i.returnObj.unAssignedTasksItems))},_removeResourceChildTask:function(n){var i,r,t;if(this._resourceChildTasks.indexOf(n)!=-1&&(i=this._resourceChildTasks.splice(this._resourceChildTasks.indexOf(n),1),r=this._resourceUniqTasks.indexOf(i[0]),r!=-1))for(t=0;t<this._resourceChildTasks.length;t++)if(this._resourceChildTasks[t].taskId==i[0].taskId){this._resourceUniqTasks[r]=this._resourceChildTasks[t];break}},_deleteResources:function(n,i,r){for(var e,o,c,l,h=t.isNullOrUndefined(r)?n.taskId:r,f=n.eResourceChildTasks,s=this.model,u=0;u<f.length;u++){if(t.isNullOrUndefined(r)&&this._removeResourceChildTask(f[u]),e=f[u].resourceInfo,e.length>0){for(o=0;o<e.length;o++)c=e[o][s.resourceIdMapping],c==h?(e.splice(o,1),o--,this._resourceUpdatedTasksIds.indexOf(f[u].taskId.toString())==-1&&this._resourceUpdatedTasksIds.push(f[u].taskId.toString())):t.isNullOrUndefined(r)&&(l=s.flatRecords[s.ids.indexOf("R_"+e[o][s.resourceIdMapping])],this._deleteResources(l,i,h));e.length==0&&i.push(f[u])}this._updateResourceName(f[u]);this._updateResourceRelatedFields(f[u])}},deleteResourceChildTask:function(n){var o=this.model,f,c,h,i,l,t,r,e,a,u,v,s;if(n&&(t={},t.data=n,t.modifiedRecord=n,t.isCompleteRemove=n.resourceInfo.length<=1,t.requestType=t.isCompleteRemove?"delete":"save",t.item=n.item,!this._trigger("actionBegin",t))){if(this._isOverlapIndexChanged=!1,i=n.parentItem,l=i.eOverlapIndex,n.resourceInfo.length>0)for(f=this._getExistingTaskWithID(n,!0),r=0;r<f.length;r++){if(c=f[r],e=c.resourceInfo,a=i.taskId,e.length>0)for(u=0;u<e.length;u++)v=e[u][o.resourceIdMapping],v==a&&(e.splice(u,1),u--);this._updateResourceName(f[r]);this._updateResourceRelatedFields(f[r])}n.resourceInfo.length==0&&(s=this._resourceUniqTaskIds.indexOf(n.taskId.toString()),s!=-1&&(this._resourceUniqTasks.splice(s,1),this._resourceUniqTaskIds.splice(s,1),o.predecessorMapping&&n.predecessor&&this._removePredecessor(n.predecessor,n)));i.eResourceChildTasks.splice(i.eResourceChildTasks.indexOf(n),1);this._removeResourceChildTask(n);this._isFlatResourceData&&n.resourceInfo.length<1?this._removeDataFromDataSource(n.item):this._isFlatResourceData||(h=i.item[o.taskCollectionMapping].indexOf(n.item),h!=-1&&i.item[o.taskCollectionMapping].splice(h,1));this._updateOverlappingValues(i);this._updateResourceParentItem(i);this.refreshGanttRecord(i);l!=i.eOverlapIndex&&this._refreshGanttHeightWithRecords();t={};t.data=n;t.item=n.item;t.modifiedRecord=n;t.isCompleteRemove=n.resourceInfo.length==0;t.requestType=t.isCompleteRemove?"delete":"save";this._trigger("actionComplete",t)}},_createResourceRecords:function(n){var t=this,u=t.model,s=u.flatRecords,e=n.length,f=0,r,h=u.parentRecords,c=t.model.ids,o;for(f;f<e;f++){if(o=n.length,r=t._createResourceRecord(n[f],0,null,i,"Load"),r==null){o!=n.length&&(f--,e--);continue}t._storedIndex++;c[t._storedIndex]=this._getFormattedTaskId(r);r.isAltRow=t._storedIndex%2==0?!1:!0;r.index=t._storedIndex;s.push(r);h.push(r);r.childRecords&&t._addNestedGanttRecords(r.childRecords,!0)}this._isFlatResourceData||this._updateResourceInfo();u.predecessorMapping&&t._ensurePredecessorCollection();u.enableWBS&&u.enableWBSPredecessor&&t.createWBSPredecessor()},_getItemValueByUsingId:function(n,t,i){return i[t.indexOf(n)]},_createResourceRecord:function(n,r,u){var e=this.model,p=n[e.groupNameMapping],w=n[e.resourceNameMapping],s=[],f=new t.Gantt.GanttRecord,v,y,h,o,c,l,b,a;if(p){if(s=n[e.resourceCollectionMapping],s||(s=[]),s.length==0)return this._removeDataFromDataSource(n),null;if(f.taskName=f.eResourceName=p,f.level=r,f.taskId=e.groupIdMapping?n[e.groupIdMapping]:null,f.eResourceTaskType="groupTask",f.durationUnit=e.durationUnitMapping&&n[e.durationUnitMapping]?this._validateDurationUnitMapping(n[e.durationUnitMapping]):e.durationUnit,f.item=this._isFlatResourceData?this._getItemValueByUsingId(n[e.groupIdMapping],this._groupIds,this._groupCollection):n,this._updateCustomField(f.item,f),this._isFlatResourceData||(v={},v[e.groupIdMapping]=t.isNullOrUndefined(f.taskId)?this._groupCollection.length+1:f.taskId,v[e.groupNameMapping]=f.taskName,this._groupCollection.push(v),f.taskId=v[e.groupIdMapping]),s.length>0)for(f.hasChildRecords=!0,f.expanded=!0,y=0;y<s.length;y++)o=this._createResourceRecord(s[y],r+1,f),f.childRecords||(f.childRecords=[]),o&&f.childRecords.push(o);this._updateExpandStateMappingValue(f.item,f)}else if(w)for(h=n[e.taskCollectionMapping],h||(h=[]),f.eResourceName=f.taskName=w,f.item=this._isFlatResourceData?this._getItemValueByUsingId(n[e.resourceIdMapping],this._resourceIds,this._resourceCollection):n,f.level=r,f.parentItem=u,f.taskId=e.resourceIdMapping?n[e.resourceIdMapping]:null,f.eResourceTaskType="resourceTask",this._updateCustomField(f.item,f),this._isFlatResourceData||(c={},c[e.resourceIdMapping]=t.isNullOrUndefined(f.taskId)?this._resourceCollection.length+1:f.taskId,c[e.resourceNameMapping]=f.eResourceName,c[e.groupIdMapping]=f.parentItem?f.parentItem.taskId:null,this._resourceCollection.push(c),f.taskId=c[e.resourceIdMapping]),l=0;l<h.length;l++){if(a=this._getExistingTaskWithID(h[l]),b=[],a)o=this._createGanttRecord(a[0].item,r,f,i,"Load"),h[l]=a[0].item,this._predecessorsCollection.indexOf(o)!=-1&&this._predecessorsCollection.splice(this._predecessorsCollection.indexOf(o),1);else{if(o=this._createGanttRecord(h[l],r,f,i,"Load"),o.duration==0)continue;this._resourceUniqTaskIds.push(o.taskId.toString());this._resourceUniqTasks.push(o);this._updateLastInsertedId(o.taskId,!1)}this._resourceChildTasks.push(o);o.eResourceTaskType="resourceChildTask";f.eResourceChildTasks.push(o)}else w||p||(a=this._getExistingTaskWithID(n),a?(f=null,this._removeDataFromDataSource(n)):(f=this._createGanttRecord(n,0,null,i,"Load"),f.duration!=0?(f.eResourceName=this._unassignedText,f.eResourceTaskType="unassignedTask",this._resourceUniqTaskIds.push(f.taskId.toString()),this._resourceUniqTasks.push(f),this._updateLastInsertedId(f.taskId,!1)):f=null));return f},_removeDataFromDataSource:function(n){var i=this.dataSource();i instanceof t.DataManager?i.dataSource.offline&&i.dataSource.json&&i.dataSource.json.indexOf(n)!=-1?i.dataSource.json.splice(i.dataSource.json.indexOf(n),1):this._isDataManagerUpdate&&this._jsonData.indexOf(n)!=-1&&this._jsonData.splice(this._jsonData.indexOf(n),1):i.indexOf(n)!=-1&&i.splice(i.indexOf(n),1)},_insertDataInDataSource:function(n){var i=this.dataSource();i instanceof t.DataManager?i.dataSource.offline&&i.dataSource.json?i.dataSource.json.push(n):this._isDataManagerUpdate&&this._jsonData.push(n):i&&i.push(n)},_getCombinedResource:function(n){for(var r=[],t,u=this.model,i=0;i<n.length;i++)t={},t[u.resourceIdMapping]=n[i].parentItem.taskId,t[u.resourceNameMapping]=n[i].parentItem.eResourceName,r.push(t);return r},_updateResourceInfo:function(){for(var e,u,i,o=this.model,f=t.DataManager(this._resourceChildTasks).executeLocal(t.Query().group("taskId")),r=0;r<f.length;r++)if(f[r].count>0)for(e=this._getCombinedResource(f[r].items),u=f[r].items,i=0;i<u.length;i++)u[i].resourceInfo=n.extend(!0,[],e),this._updateResourceName(u[i]),o.workMapping||u[i]._updateWorkWithDuration(this)},_getExistingTaskWithID:function(n,i){var r=this.model,u=[];return(r.taskIdMapping&&n[r.taskIdMapping]||!t.isNullOrUndefined(n))&&(u=this._resourceChildTasks.filter(function(t){return!i&&n[r.taskIdMapping]==t.taskId||i&&n.taskId==t.taskId?!0:!1})),u.length>0?u:null},_checkDataBinding:function(){var i=this,r=i.model,e,o,u,f;if(this.dataSource()==null&&this.dataSource([]),this.dataSource()instanceof t.DataManager)this._initDataSource();else if(this.dataSource().length>0){if(r.taskIdMapping.length>0&&r.parentTaskIdMapping.length>0){for(e=i._retrivedData=i.dataSource(),o=[],i._taskIds=[],u=0;u<e.length;u++)f=e[u],o.push(n.extend(!0,{},f)),t.isNullOrUndefined(f[r.taskIdMapping])||i._taskIds.push(f[r.taskIdMapping]);r.childMapping||(r.childMapping="Children");i._reconstructDatasource(o);i._createGanttRecords(i.secondaryDatasource)}else i._createGanttRecords(this.dataSource());i._initialize()}else i._initialize();i.model.allowSelection&&i.model.selectionType=="multiple"&&i.model.selectionMode=="row"&&i._renderMultiSelectionPopup()},_initDataSource:function(){var i=this,r=i.model,u=this._columnToSelect(),f=this.dataSource().executeQuery(u);f.done(t.proxy(function(t){var e,o,u,f,s;if(i._retrivedData=t.result,r.taskIdMapping.length>0&&r.parentTaskIdMapping.length>0){for(e=t.result,o=[],i._taskIds=[],u=0;u<e.length;u++)f=e[u],o.push(n.extend(!0,{},f)),f[r.taskIdMapping]&&i._taskIds.push(f[r.taskIdMapping]);r.childMapping||(r.childMapping="Children");i._reconstructDatasource(o)}else i.secondaryDatasource=i._retrivedData;i._createGanttRecords(i.secondaryDatasource);i._initialize();s={requestType:"create"};i._trigger("actionComplete",s)}))},_columnToSelect:function(){var i=this,n=i.model,r=t.Query();return n.query?n.query:r},_intersectionObjects:function(n,t){for(var r=[],i;n.length>0&&t.length>0;)i=t.indexOf(n[0]),i==-1?n.shift():(r.push(n.shift()),t.splice(i,1));return r},_reconstructDatasource:function(n){var u=this,e=u.model,r,s,f,i,o;for(s=t.Predicate(e.parentTaskIdMapping,t.FilterOperators.notEqual,"null"),r=t.DataManager(n).executeLocal(t.Query().where(s).group(e.parentTaskIdMapping)),f=[],i=0;i<r.length;i++){if(!t.isNullOrUndefined(r[i].key)&&(o=u._taskIds.indexOf(r[i].key),o>-1)){n[o][e.childMapping]=r[i].items;continue}f.push.apply(f,r[i].items)}u.secondaryDatasource=u._intersectionObjects(n,f)},updateScheduleDates:function(n,t){var i=this,u=this.model,f=u.scheduleHeaderSettings.scheduleHeaderType,e,r;u.scheduleStartDate=n;u.scheduleEndDate=t;i._scheduleDays=[];i._scheduleMonths=[];i._scheduleWeeks=[];i._scheduleYears=[];i._scheduleHours=[];i._scheduleMinutes=[];i._calculateHeaderDates();e=i._$ganttchartHelper.ejGanttChart("instance");r=e.model;i._isTreeGridRendered=!1;i._isGanttChartRendered=!1;i._isChartRendering=!0;i._updateGanttRecords();u.viewType=="histogramView"&&i._updateHistoData();r.projectStartDate=i._getDateFromFormat(i._projectStartDate);r.projectEndDate=i._getDateFromFormat(i._projectEndDate);r.scheduleDays=i._scheduleDays;r.scheduleMonths=i._scheduleMonths;r.scheduleWeeks=i._scheduleWeeks;r.scheduleYears=i._scheduleYears;r.scheduleHours=i._scheduleHours;r.scheduleMinutes=i._scheduleMinutes;r.renderBaseline=u.renderBaseline;r.scheduleHeaderSettings.scheduleHeaderType=f;r.dateFormat=u.dateFormat;r.perDayWidth=i._perDayWidth;r.durationUnit=u.durationUnit;r.scheduleHeaderSettings.weekHeaderFormat=u.scheduleHeaderSettings.weekHeaderFormat;r.scheduleHeaderSettings.dayHeaderFormat=u.scheduleHeaderSettings.dayHeaderFormat;r.scheduleHeaderSettings.hourHeaderFormat=u.scheduleHeaderSettings.hourHeaderFormat;r.scheduleHeaderSettings.minutesPerInterval=u.scheduleHeaderSettings.minutesPerInterval;r.scheduleHeaderSettings.monthHeaderFormat=u.scheduleHeaderSettings.monthHeaderFormat;r.scheduleHeaderSettings.yearHeaderFormat=u.scheduleHeaderSettings.yearHeaderFormat;f=="day"?r.perHourWidth=i._perHourWidth:f=="hour"?(r.workingTimeScale=u.workingTimeScale,r.minuteInterval=i._minuteInterval,r.perMinuteWidth=i._perMinuteWidth):f=="month"?r.perWeekWidth=i._perWeekWidth:(f=="year"||f=="quarterYear"||f=="halfYear")&&(r._perMonthWidth=i._perMonthWidth);i._$ganttchartHelper.ejGanttChart("refreshChartHeader",i._getDateFromFormat(n),i._getDateFromFormat(t));i._$ganttchartHelper.ejGanttChart("refreshContainersWidth");i._$ganttchartHelper.ejGanttChart("refreshHelper",i.model.currentViewData,i.model.updatedRecords,i._totalCollapseRecordCount);u.predecessorMapping&&i._refreshConnectorLines(!1,!0,!0);e._$bodyContainer.ejScroller("refresh");i._updateScrollerBorder();i._isTreeGridRendered=!0;i._isGanttChartRendered=!0;i._isChartRendering=!1},reRenderChart:function(i){var r=this,u=r.model,e=r._getDateFromFormat(u.scheduleStartDate),o=r._getDateFromFormat(u.scheduleEndDate),f,s;u.flatRecords=[];u.parentRecords=[];n("#ejGanttChart"+r._id).empty();switch(i){case t.Gantt.ScheduleHeaderType.Week:u.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Week;r._perDayWidth=u.perDayWidth;r._calculateWeekSplit(e,o);break;case t.Gantt.ScheduleHeaderType.Day:u.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Day;r._perHourWidth=u.perHourWidth;r._perDayWidth=r._perHourWidth*24;r._calculateDaySplit(e,o);break;case t.Gantt.ScheduleHeaderType.Month:u.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Month;r._perDayWidth=u.perDayWidth;r._perWeekWidth=u.perWeekWidth;r._calculateMonthSplit(e,o);break;case t.Gantt.ScheduleHeaderType.Year:case t.Gantt.ScheduleHeaderType.QuarterYear:case t.Gantt.ScheduleHeaderType.HalfYear:u.scheduleHeaderSettings.scheduleHeaderType=i;r._perDayWidth=u.perDayWidth;r._perMonthWidth=u.perMonthWidth;r._calculateYearSplit(e,o);break;case t.Gantt.ScheduleHeaderType.Hour:if(u.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Hour,f=u.scheduleHeaderSettings.minutesPerInterval,s=t.Gantt.minutesPerInterval,r._perMinuteWidth=u.perMinuteWidth,f)if(f==s.Auto){var h=o-e;h>864e6?(r._minuteInterval=30,r._perDayWidth=r._perMinuteWidth*48):h>6048e5?(r._minuteInterval=15,r._perDayWidth=r._perMinuteWidth*96):h>1728e5?(r._minuteInterval=5,r._perDayWidth=r._perMinuteWidth*288):(r._minuteInterval=1,r._perDayWidth=r._perMinuteWidth*1440)}else f==s.OneMinute?(r._minuteInterval=1,r._perDayWidth=r._perMinuteWidth*1440):f==s.FiveMinutes?(r._minuteInterval=5,r._perDayWidth=r._perMinuteWidth*288):f==s.FifteenMinutes?(r._minuteInterval=15,r._perDayWidth=r._perMinuteWidth*96):f==s.ThirtyMinutes&&(r._minuteInterval=30,r._perDayWidth=r._perMinuteWidth*48);r._calculateHourSplit(e,o)}r.element.ejGantt("destroy").ejGantt(u);r._isTreeGridRendered=!1;r._isGanttChartRendered=!1},changeTaskMode:function(n,i){var r=this,f=r.model,u={};u.data=n;r._isValidationEnabled=!0;i==t.Gantt.TaskSchedulingMode.Manual?(n.isAutoSchedule=!1,n.item[f.taskSchedulingModeMapping]=!0):i==t.Gantt.TaskSchedulingMode.Auto&&(n.isAutoSchedule=!0,n.item[f.taskSchedulingModeMapping]=!1);u.columnName="taskMode";r._updateEditedGanttRecords(u,!0);r._isValidationEnabled=!1},autoSchedule:function(n){var i=this,u=i.model,r,f=u.updatedRecords;r=f.filter(function(t){return t.taskId===n});i.changeTaskMode(r[0],t.Gantt.TaskSchedulingMode.Auto)},manualSchedule:function(n){var i=this,u=i.model,r,f=u.updatedRecords;r=f.filter(function(t){return t.taskId===n});i.changeTaskMode(r[0],t.Gantt.TaskSchedulingMode.Manual)},_updateGanttRecords:function(){for(var f,n,i=this,s=i.model,h=s.flatRecords,c=h.length,t,r,e,u,o=0;o<c;o++){for(t=h[o],u=[],t.eResourceChildTasks.length>0?(u=t.eResourceChildTasks,this._updateOverlappingValues(t)):u.push(t),f=0;f<u.length;f++)n=u[f],n.hasChildRecords===!1&&(n.left=n._calculateLeft(this),n.width=n._calculateWidth(this),n.width=n.isMilestone==!0?i._milesStoneWidth:n.width,n.progressWidth=n._getProgressWidth(n.width,n.status)),n.baselineStartDate&&n.baselineEndDate?(n.baselineLeft=n._calculateBaselineLeft(this),n.baselineRight=n._calculateBaselineRight(this),n.baselineWidth=n._calculateBaseLineWidth(this)):(n.baselineLeft=0,n.baselineRight=0,n.baselineWidth=0);r=t.parentItem;e=r&&r.childRecords;r&&e.indexOf(t)==e.length-1&&t.hasChildRecords===!1&&(s.viewType=="resourceView"?i._updateResourceParentItem(t):r.isAutoSchedule?i._updateParentItem(t):i._updateManualParentItem(t))}},_initPrivateProperties:function(){var n=this,i=n.model,r=i.scheduleHeaderSettings.scheduleHeaderType;n._unassingedTasksParent=null;n._isFromGantt=!0;n._disabledToolItems=[];n._id=n.element.attr("id");n._scheduleWeeks=[];n._taskIds=[];n._currentFilterColumn=[];n._duplicate=!1;n._wrongenddate=!1;n._addPosition=null;n._datePickerChangeEvent=!1;n._scheduleYears=[];n._enableMonthStart=!0;n._scheduleMonths=[];n._splitterOnResize=!1;n._scheduleYears=[];n._scheduleDays=[];n._scheduleHours=[];n._projectStartDate;n._projectEndDate;n._groupIds=[];n._resourceIds=[];n._resourceCollection=[];n._groupCollection=[];i.viewType=="resourceView"&&i.resourceIdMapping.length>0&&i.resources&&i.resources.length>0||i.groupIdMapping&&i.groupIdMapping.length>0&&i.groupCollection&&i.groupCollection.length>0?(n._isFlatResourceData=!0,n._groupCollection=i.groupCollection,n._resourceCollection=i.resources):i.viewType=="resourceView"?n._isFlatResourceData=!1:n._resourceCollection=i.resources;i.viewType=="resourceView"&&(i.resourceIdMapping||(i.resourceIdMapping="eResourceId"),i.groupIdMapping||(i.groupIdMapping="eGroupId"),i.resourceInfoMapping||(i.resourceInfoMapping="eResourceInfo"));this._resourceChildTasks=[];this._resourceUniqTasks=[];this._resourceUniqTaskIds=[];n._columns=[];n._storedIndex=-1;n._perDayWidth;n._prevDayWidth=0;n._rowIndexOfLastSelectedCell=-1;n._perMonthWidth;n._perWeekWidth;n._$treegridPane=null;n._$ganttchartPane=null;n._$treegridHelper=null;n._$ganttchartHelper=null;n._$ejGantt=null;n._tdsOffsetWidth=[];n._subPosx=[];n._predecessorsCollection=[];n._connectorLinesCollection=[];n._updatedConnectorLineCollection=[];n._connectorlineIds=[];n._gridRows=null;n._collapsedRecordCount=0;n._expandedRecordsCount=0;n._totalCollapseRecordCount=0;n._isInExpandCollapse=!1;n._hiddenRecordCount=0;n._validationRuleOptions=null;n._validationDialogTitle=null;n._validationRuleText=null;n.prevPredecessorTO=null;n.prevPredecessorFrom=null;n.prevPredecessorcount=0;n._isValidationEnabled=!0;n._isTreeGridRendered=!1;n._isGanttChartRendered=!1;n._isChartRendering=!1;n._holidaysList=n._getHoliday();n._stringHolidays=n._getStringHolidays();n._isinBeginEdit=!1;n._isMileStoneEdited=!1;n._cellEditColumn=null;n._isinAddnewRecord=!1;n._contextMenuItems=null;n._totalBorderWidth=2;n._totalBorderHeight=t.browserInfo().name=="msie"&&t.browserInfo().version<9?i.toolbarSettings.showToolbar?3:2:i.toolbarSettings.showToolbar?1:0;n._columnHeaderTexts=null;n._predecessorEditingTexts=null;n._editDialogTexts=null;n._toolboxTooltipTexts=null;n._durationUnitTexts=null;n._durationUnitEditText=null;n._workUnitTexts=null;n._taskTypeTexts=null;n._effortDrivenTexts=null;n._contextMenuTexts=null;n._columnMenuTexts=null;n._editTypeText=null;n._clipModeText=null;n._textAlignTypeText=null;n._columnDialogTitle=null;n._deleteColumnText=null;n._okButtonText=null;n._cancelButtonText=null;n._confirmDeleteText=null;n._columnDialogTexts=null;n._newTaskTexts=null;n._months=null;n._days=null;n._dialogTabTitleTexts=null;n._isLoad=!0;n._updatedColumn="";n._isExistingUnitIsUpdated=!1;n._isDurationUpdated=!1;n._isResourceAddedOrRemoved=!1;n._newRecordResourceCollection=[];n._ganttTouchTrigger=!1;n._alertTexts=null;n._commonColumnWidth=150;n._searchString="";n._emptyDataColumns=[];n.secondaryDatasource=[];n._datasourceChildItems=[];n._$predecessorTable=null;n._mappingItems=[];n._editedDialogRecord=null;n._calculateDimensions();n._retrivedData=this.dataSource();n._isInExpandCollapseAll=!1;n._preTableCollection=[];n._defaultStartTime=null;n._defaultEndTime=null;n._workingTimeRanges=[];n._nonWorkingTimeRanges=[];n._nonWorkingHours=[];n._quarterYearTexts=null;n._halfYearTexts=null;this._validateTimeRange();JSON.stringify(i.dayWorkingTime)=='[{"from":"08:00 AM","to":"12:00 PM"},{"from":"01:00 PM","to":"05:00 PM"}]'&&(i.dayWorkingTime=i.workingTimeScale!=t.Gantt.workingTimeScale.TimeScale8Hours?[{from:"12:00 AM",to:"12:00 AM"}]:[{from:"08:00 AM",to:"12:00 PM"},{from:"01:00 PM",to:"05:00 PM"}]);n._secondsPerDay=n._getSecondsPerDay();n._timelineWidthCalculation();n._localizedLabels=n._getLocalizedLabels();n._setCultureInfo();n._resourceViewColumns=[];n.setColumns(i.columns&&i.columns.length?i.columns:n.createTreeGridColumns());i.isRerender&&n._updateColumnDropDownData();n._updateColumnLocaleText();n._isRefreshAddedRecord=!1;n._isInAdd=!1;n._activeMenuItemId=null;n._isAddEditDialogSave=!1;n._setTaskbarHeight(i.taskbarHeight);n.isCriticalPathEnable=!1;n.criticalPathCollection=[];n.detailPredecessorCollection=[];n.collectionTaskId=[];n._isValidPredecessorString=!0;n._enableDisableCriticalIcon=!1;n._generalTabColumnFields=[];n._addDialogGeneralColumns=[];n._addDialogcustomColumns=[];n._editDialogGeneralColumns=[];n._editDialogCustomColumns=[];i.resourceUnitMapping==""&&(i.resourceUnitMapping="unit");n._dialogTab=["General","Predecessors","Resources","Custom Fields","Notes"];n._cssClass=i.cssClass;n._actionCompleteData=[];n._isLastRefresh=!1;n._nonWorkingDayIndex=[];n._serialCount=0;n._lastInsertedId=-1;n._isTriggerActionComplete=!0;n._expandCollapseSettings={state:i.expandStateMapping?"":i.enableCollapseAll?"collapseAll":"expandAll",level:0};n._contextMenuHandler=!1;n._ganttTouchEvent=!1;n._histoGramChildTasks=[];n._histoGramChildTaskIds=[];i.allowSearching=!0;n._unscheduledTaskWidth=7;n._isPredecessorEdited=!1},_updateModelsWidth:function(){var n=this,t=n.model;t.perDayWidth=n._perDayWidth?n._perDayWidth:null;t.perMonthWidth=n._perMonthWidth?n._perMonthWidth:null;t.perWeekWidth=n._perWeekWidth?n._perWeekWidth:null;t.perHourWidth=n._perHourWidth?n._perHourWidth:null;t.perMinuteWidth=n._perMinuteWidth?n._perMinuteWidth:null;t.minuteInterval=n._minuteInterval?n._minuteInterval:null},_timelineWidthCalculation:function(n){var r=this,e=r.model,f=!0,o=e.scheduleHeaderSettings.scheduleHeaderType,a=e.scheduleHeaderSettings.timescaleUnitSize,c=a.toString(),u,l,s,h;if(n==i&&a!="100%"&&(f=!1,l=c.indexOf("-"),u=l!=-1?100:+c.match(/\d+/)[0],u<50?u=50:u>500&&(u=500),e.scheduleHeaderSettings.timescaleUnitSize=u+"%"),n!=i&&(f=!1,l=c.indexOf("-"),u=l!=-1?a:+c.match(/\d+/)[0],u<50?u=50:u>500&&(u=500),e.scheduleHeaderSettings.timescaleUnitSize=u+"%"),o=="week")r._perDayWidth=f?30:Math.round(u*.3),r._perMinuteWidth=r._perDayWidth/1440;else if(o=="year")r._perDayWidth=f?3:Math.round(u*.03),r._perMonthWidth=r._perDayWidth*30,r._perMinuteWidth=r._perDayWidth/1440;else if(o=="quarterYear")r._perDayWidth=f?1:Math.round(u*.01),r._perMonthWidth=r._perDayWidth*30,r._perMinuteWidth=r._perDayWidth/1440;else if(o=="halfYear")r._perDayWidth=f?.5:Math.round(u*.005),r._perMonthWidth=r._perDayWidth*30,r._perMinuteWidth=r._perDayWidth/1440;else if(o=="month")r._perDayWidth=f?10:Math.round(u*.1),r._perWeekWidth=r._perDayWidth*7,r._perHourWidth=r._perDayWidth/24,r._perMinuteWidth=r._perDayWidth/1440;else if(o=="day")r._perHourWidth=f?20:Math.round(u*.2),r._perMinuteWidth=r._perHourWidth/60,r._perDayWidth=r._perHourWidth*24;else if(o=="hour"&&(s=e.scheduleHeaderSettings.minutesPerInterval,h=t.Gantt.minutesPerInterval,r._perMinuteWidth=f?20:Math.round(u*.2),s))if(s==h.Auto){var y=r._getDateFromFormat(e.scheduleStartDate),p=r._getDateFromFormat(e.scheduleEndDate),v=p-y;v>864e6?(r._minuteInterval=30,r._perDayWidth=r._perMinuteWidth*48):v>6048e5?(r._minuteInterval=15,r._perDayWidth=r._perMinuteWidth*96):v>1728e5?(r._minuteInterval=5,r._perDayWidth=r._perMinuteWidth*288):(r._minuteInterval=1,r._perDayWidth=r._perMinuteWidth*1440)}else s==h.OneMinute?(r._minuteInterval=1,r._perDayWidth=r._perMinuteWidth*1440):s==h.FiveMinutes?(r._minuteInterval=5,r._perDayWidth=r._perMinuteWidth*288):s==h.FifteenMinutes?(r._minuteInterval=15,r._perDayWidth=r._perMinuteWidth*96):s==h.ThirtyMinutes&&(r._minuteInterval=30,r._perDayWidth=r._perMinuteWidth*48);r._updateModelsWidth()},_updateTimescaleUnitSize:function(n){var t=this,i=t.model,u=i.scheduleHeaderSettings,f=u.timescaleUnitSize,r;u.timescaleUnitSize=n;t._timelineWidthCalculation(n);t.updateScheduleDates(i.scheduleStartDate,i.scheduleEndDate);r=t.selectedRowIndex();r>=0&&t.focusOnTask(r)},_validateTimeRange:function(){for(var n,o="01/01/2016",a=this,f=this.model,l=f.dayWorkingTime.length,r=!0,u=null,e=0;e<l;e++)if(n=f.dayWorkingTime[e],n.from&&n.to){var s=t.parseDate(o+" "+n.from,"MM/dd/yyyy h:mm tt","en-US"),h=n.to!="12:00 AM"?t.parseDate(o+" "+n.to,"MM/dd/yyyy h:mm tt","en-US"):t.parseDate("01/02/2016 "+n.to,"MM/dd/yyyy h:mm tt","en-US"),v=h.getTime()-s.getTime(),c=this._getSecondsInDecimal(s),i=this._getSecondsInDecimal(h);i==0&&(i=86400);c>=i?r=!1:u==null?u=i:(u>c||u>=i)&&(r=!1)}else r=!1;r||(f.dayWorkingTime=[{from:"08:00 AM",to:"12:00 PM"},{from:"01:00 PM",to:"05:00 PM"}])},_getParsedDate:function(n,i,r){return t.parseDate(n,i,r)},_setTime:function(n,t){var i=parseInt(n/3600),r=parseInt((n-i*3600)/60),u=n-i*3600-r*60;t.setHours(i,r,u,0)},_checkStartDate:function(n,i,r){var e,s,v,y,h,c,l;if(t.isNullOrUndefined(n))return null;var u=new Date(n),o=this.model,f=this._getSecondsInDecimal(u),a=t.isNullOrUndefined(r)?t.isNullOrUndefined(i)?!1:i.isMilestone:r;if(f<this._defaultStartTime)this._setTime(this._defaultStartTime,u);else if(f!=this._defaultEndTime||i&&a){if(f>this._defaultEndTime)u.setDate(u.getDate()+1),this._setTime(this._defaultStartTime,u);else if(f>this._defaultStartTime&&f<this._defaultEndTime)for(e=0;e<this._workingTimeRanges.length;e++)if(s=this._workingTimeRanges[e],f>=s.to&&this._workingTimeRanges[e+1]&&f<this._workingTimeRanges[e+1].from){f!=s.to||i&&a?f!=s.to&&this._setTime(this._workingTimeRanges[e+1].from,u):this._setTime(this._workingTimeRanges[e+1].from,u);break}}else u.setDate(u.getDate()+1),this._setTime(this._defaultStartTime,u);do if(v=new Date(u),!t.isNullOrUndefined(i)&&i.isAutoSchedule&&(!o.includeWeekend||o.holidays.length>0)||t.isNullOrUndefined(i)&&(!o.includeWeekend||o.holidays.length>0))for(o.includeWeekend||(y=new Date(u),u=this._getNextWorkingDay(u),y.getTime()!=u.getTime()&&this._setTime(this._defaultStartTime,u)),h=0;h<o.holidays.length;h++)c=this._getDateFromFormat(o.holidays[h].day),l=new Date(c),c.setHours(0,0,0,0),l.setHours(23,59,59,59),u.getTime()>=c.getTime()&&u.getTime()<l.getTime()&&(u.setDate(u.getDate()+1),this._setTime(this._defaultStartTime,u));while(v.getTime()!=u.getTime());return new Date(u)},_checkEndDate:function(n,i){var f,l,a,v,s;if(t.isNullOrUndefined(n))return null;var r=new Date(n),u=this.model,e=this._getSecondsInDecimal(r);if(e>this._defaultEndTime)this._setTime(this._defaultEndTime,r);else if(e<=this._defaultStartTime)r.setDate(r.getDate()-1),this._setTime(this._defaultEndTime,r);else if(e>this._defaultStartTime&&e<this._defaultEndTime)for(f=0;f<this._workingTimeRanges.length;f++)if(l=this._workingTimeRanges[f],e>l.to&&this._workingTimeRanges[f+1]&&e<=this._workingTimeRanges[f+1].from){this._setTime(this._workingTimeRanges[f].to,r);break}do if(a=new Date(r),!t.isNullOrUndefined(i)&&i.isAutoSchedule&&(!u.includeWeekend||u.holidays.length>0)||t.isNullOrUndefined(i)&&(!u.includeWeekend||u.holidays.length>0))for(u.includeWeekend||(v=new Date(r),r=this._getPrevWorkingDay(r),v.getTime()!=r.getTime()&&this._setTime(this._defaultEndTime,r)),s=0;s<u.holidays.length;s++){var o=this._getDateFromFormat(u.holidays[s].day),h=new Date(o),c=new Date(r);c.setMinutes(r.getMinutes()-2);o.setHours(0,0,0,0);h.setHours(23,59,59,59);(r.getTime()>=o.getTime()&&r.getTime()<h.getTime()||c.getTime()>=o.getTime()&&c.getTime()<h.getTime())&&(r.setDate(r.getDate()-1),r.getTime()==o.getTime()&&this._defaultEndTime==86400&&this._getSecondsInDecimal(r)==0||this._setTime(this._defaultEndTime,r))}while(a.getTime()!=r.getTime());return new Date(r)},_checkBaseLineStartDate:function(n){var i=new Date(n),e=this.model,u=this._getSecondsInDecimal(i),r,f;if(t.isNullOrUndefined(n))return"";if(u<this._defaultStartTime)this._setTime(this._defaultStartTime,i);else if(u>=this._defaultEndTime)i.setDate(i.getDate()+1),this._setTime(this._defaultStartTime,i);else if(u>this._defaultStartTime&&u<this._defaultEndTime)for(r=0;r<this._workingTimeRanges.length;r++)if(f=this._workingTimeRanges[r],u>=f.to&&this._workingTimeRanges[r+1]&&u<this._workingTimeRanges[r+1].from){this._setTime(this._workingTimeRanges[r+1].from,i);break}return i},_checkBaseLineEndDate:function(n){var i=new Date(n),e=this.model,u=this._getSecondsInDecimal(i),r,f;if(t.isNullOrUndefined(n))return"";if(u>this._defaultEndTime)this._setTime(this._defaultEndTime,i);else if(u<=this._defaultStartTime)i.setDate(i.getDate()-1),this._setTime(this._defaultEndTime,i);else if(u>this._defaultStartTime&&u<this._defaultEndTime)for(r=0;r<this._workingTimeRanges.length;r++)if(f=this._workingTimeRanges[r],u>f.to&&this._workingTimeRanges[r+1]&&u<=this._workingTimeRanges[r+1].from){this._setTime(this._workingTimeRanges[r].to,i);break}return i},_getTaskLeft:function(n,i){var r=new Date(n),f=this.model,u=f.scheduleHeaderSettings.scheduleHeaderType;return(u==t.Gantt.ScheduleHeaderType.Week||u==t.Gantt.ScheduleHeaderType.Month||u==t.Gantt.ScheduleHeaderType.Year||u==t.Gantt.ScheduleHeaderType.QuarterYear||u==t.Gantt.ScheduleHeaderType.HalfYear)&&(this._getSecondsInDecimal(r)==this._defaultStartTime?r.setHours(0,0,0,0):i&&this._getSecondsInDecimal(r)==this._defaultEndTime&&r.setHours(24)),this._projectStartDate?(r.getTime()-this._projectStartDate.getTime())/864e5*this._perDayWidth:0},_getTaskWidth:function(n,i){var u=new Date(n),f=new Date(i),o=this.model,r=o.scheduleHeaderSettings.scheduleHeaderType,e;return(r==t.Gantt.ScheduleHeaderType.Week||r==t.Gantt.ScheduleHeaderType.Month||r==t.Gantt.ScheduleHeaderType.Year||r==t.Gantt.ScheduleHeaderType.QuarterYear||r==t.Gantt.ScheduleHeaderType.HalfYear)&&(this._getSecondsInDecimal(u)==this._defaultStartTime&&u.setHours(0,0,0,0),this._getSecondsInDecimal(f)==this._defaultEndTime&&f.setHours(24)),e=f.getTime()-u.getTime(),e/864e5*this._perDayWidth},_getHolidaysCount:function(n,t){var o=this,s=o.model,h=this.model.holidays,f=0,i=new Date(n),e=new Date(t),r,u;if(i.setDate(i.getDate()+1),i.setHours(0,0,0,0),e.setHours(0,0,0,0),i.getTime()<e.getTime())for(r=0;r<h.length;r++)u=this._getDateFromFormat(h[r].day),i.getTime()<=u.getTime()&&e.getTime()>u.getTime()&&(s.includeWeekend||o._nonWorkingDayIndex.indexOf(u.getDay())!=-1?s.includeWeekend&&(f+=1):f+=1);return f},_getWeekendCount:function(n,t){var i=new Date(n),r=new Date(t),u=0,f=this;for(i.setHours(0,0,0,0),i.setDate(i.getDate()+1),r.setHours(0,0,0,0);i.getTime()<r.getTime();)f._nonWorkingDayIndex.indexOf(i.getDay())!=-1&&(u+=1),i.setDate(i.getDate()+1);return u},_getDayDiff:function(n,t){return(t.getTime()-n.getTime())/864e5},_getNumberOfSeconds:function(n,t,i){var u=new Date(n),f=new Date(t),r=0;return u.setDate(u.getDate()+1),u.setHours(0,0,0,0),f.setHours(0,0,0,0),u.getTime()<f.getTime()&&(r=this._getTimeDiff(u,f,i)/1e3),r%86400!=0&&(r=r-r%86400+86400),r},_updateDateWithTimeZone:function(n,t){var e=n.getTimezoneOffset(),o=t.getTimezoneOffset(),r,u,i,f;e!=o&&(i=new Date((new Date).getFullYear(),0,1).getTimezoneOffset(),i!=e?(r=n,u=e):i!=o&&(r=t,u=o),i<0?(f=i-u,r.setTime(r.getTime()+f*6e4)):i>0&&(f=u-i,r.setTime(r.getTime()-f*6e4)))},_getTimeDiff:function(n,t,i){var n=new Date(n),t=new Date(t);return i&&this._updateDateWithTimeZone(n,t),t.getTime()-n.getTime()},_getNonworkingTime:function(n,i,r,u){u=t.isNullOrUndefined(u)?!0:u;var c=this._getTimeDiff(n,i,u)/1e3,f=!this.model.includeWeekend&&r?this._getWeekendCount(n,i):0,o=this._getNumberOfSeconds(n,i,u),e=r?this._getHolidaysCount(n,i):0,s=(o-f*86400-e*86400)/86400,h=this._getNonWorkingSecondsOnDate(n,i,r);return s*(86400-this._secondsPerDay)+f*86400+e*86400+h},_getEndDate:function(n,i,r,u,f){for(var o=0,h=new Date(n),e=new Date(n),o=r&&r!=t.Gantt.DurationUnit.Day?r==t.Gantt.DurationUnit.Hour?i*3600:i*60:this._secondsPerDay*i,s=0;o>0;)e.setSeconds(e.getSeconds()+o),s=this._getNonworkingTime(h,e,u.isAutoSchedule,!0),o=s,o>0&&(e=this._checkStartDate(e,u,f)),h=new Date(e);return e},_getStartDate:function(n,i,r,u){for(var e=0,o=new Date(n),f=new Date(n),e=r&&r!=t.Gantt.DurationUnit.Day?r==t.Gantt.DurationUnit.Hour?i*3600:i*60:this._secondsPerDay*i,s=0;e>0;)f.setSeconds(f.getSeconds()-e),s=this._getNonworkingTime(f,o,u.isAutoSchedule,!0),e=s,e>0&&(o=this._checkEndDate(f,u)),o=new Date(f);return f},_getDuration:function(n,i,r,u,f){if(t.isNullOrUndefined(n)||t.isNullOrUndefined(i))return null;f=t.isNullOrUndefined(f)?!0:f;var s=this._getTimeDiff(n,i,f)/1e3,o,h=this._getNonworkingTime(n,i,u,f),e=s-h;return o=r&&r!=t.Gantt.DurationUnit.Day?r==t.Gantt.DurationUnit.Minute?e/60:e/3600:e/this._secondsPerDay,parseFloat(o)},_getSecondsInDecimal:function(n){return n.getHours()*3600+n.getMinutes()*60+n.getSeconds()+n.getMilliseconds()/1e3},_getNonWorkingSecondsOnDate:function(n,t,i){for(var h,l,v=this,f=this._getSecondsInDecimal(n),e=this._getSecondsInDecimal(t),o=-1,s=-1,u=0,a=i?this._isOnHolidayOrWeekEnd(n):!1,c=i?this._isOnHolidayOrWeekEnd(t):!1,r=0;r<this._nonWorkingTimeRanges.length;r++)h=this._nonWorkingTimeRanges[r],f>=h.from&&f<=h.to&&(o=r),e>=h.from&&e<=h.to&&(s=r);if(n.getDate()!=t.getDate()||n.getMonth()!=t.getMonth()||n.getFullYear()!=t.getFullYear()){if(a)u+=86400-f;else for(r=o;r<this._nonWorkingTimeRanges.length;r++)this._nonWorkingTimeRanges[r].isWorking||(u+=r==o?this._nonWorkingTimeRanges[r].to-f:this._nonWorkingTimeRanges[r].interval);if(c)u+=e;else for(r=0;r<=s;r++)this._nonWorkingTimeRanges[r].isWorking||(u+=r==s?e-this._nonWorkingTimeRanges[r].from:this._nonWorkingTimeRanges[r].interval)}else if(o!=s)if(c)u+=e-f;else for(r=o;r<=s;r++)this._nonWorkingTimeRanges[r].isWorking||(u+=r==o?this._nonWorkingTimeRanges[r].to-f:r==s?e-this._nonWorkingTimeRanges[r].from:this._nonWorkingTimeRanges[r].interval);else c?u+=e-f:(l=this._nonWorkingTimeRanges[o],l.isWorking||(u=e-f));return u},_getSecondsPerDay:function(){for(var u,e="01/01/2016",n=this,o=this.model,s=o.dayWorkingTime.length,h=0,i=0;i<s;i++)if(u=o.dayWorkingTime[i],u.from&&u.to){var c=t.parseDate(e+" "+u.from,"MM/dd/yyyy h:mm tt","en-US"),l=u.to!="12:00 AM"?t.parseDate(e+" "+u.to,"MM/dd/yyyy h:mm tt","en-US"):t.parseDate("01/02/2016 "+u.to,"MM/dd/yyyy h:mm tt","en-US"),a=l.getTime()-c.getTime(),r=this._getSecondsInDecimal(c),f=this._getSecondsInDecimal(l);f==0&&(f=86400);h+=a/1e3;i==0&&(n._defaultStartTime=r);i==s-1&&(n._defaultEndTime=f);i>0?(n._nonWorkingHours.push(n._nonWorkingHours[n._nonWorkingHours.length-1]+r-n._workingTimeRanges[i-1].to),n._workingTimeRanges[i-1].to<r&&n._nonWorkingTimeRanges.push({from:n._workingTimeRanges[i-1].to,to:r,isWorking:!1,interval:r-n._workingTimeRanges[i-1].to})):(n._nonWorkingHours.push(0),n._nonWorkingTimeRanges.push({from:0,to:r,isWorking:!1,interval:r}));n._workingTimeRanges.push({from:r,to:f});n._nonWorkingTimeRanges.push({from:r,to:f,isWorking:!0,color:u.background,interval:f-r})}return n._defaultEndTime/3600!=24&&n._nonWorkingTimeRanges.push({from:n._defaultEndTime,to:86400,isWorking:!1,interval:86400-n._defaultEndTime}),h},_updateColumnLocaleText:function(){var i=this.model,n=i.columns,t;if(n&&n.length>0)for(t=0;t<n.length;t++)n[t].field&&this._columnHeaderTexts[n[t].field]&&(n[t].headerText=this._columnHeaderTexts[n[t].field])},_calculateDimensions:function(){var t=this,u=this.model.sizeSettings,i=u.height,r=u.width,n=t.element,f=n[0].style.height,e=n[0].style.width,o=n.parent().height(),s=n.parent().width();r&&n.css("width",r);i&&n.css("height",i);i||f||(f="450px",n.css("height","450px"));r||e||(e="100%",t.element.css("width","100%"));t._ganttHeight=n.height();t._ganttWidth=n.width();t._ganttHeight===0&&(t._ganttHeight=450,n.css("450px"))},_setCultureInfo:function(){var r=this,e=r.model,f=e.locale,i=n.extend({},r._localizedLabels,t.isNullOrUndefined(t.cultures[f])?t.cultures["default"]:t.cultures[f]),u=n.extend({},t.cultures["default"],t.Gantt.Locale["default"]);e.dateFormat=e.dateFormat?e.dateFormat:i&&i.calendars&&i.calendars.standard.patterns?i.calendars.standard.patterns.d:t.preferredCulture(f)?t.preferredCulture(f).calendars.standard.patterns.d:u.calendars.standard.patterns.d;r._emptyRecordText=i&&i.emptyRecord?i.emptyRecord:u.emptyRecord;r._unassignedText=i&&i.unassignedTask?i.unassignedTask:u.unassignedTask;r._columnHeaderTexts=i&&i.columnHeaderTexts?i.columnHeaderTexts:u.columnHeaderTexts;r._columnHeaderTexts=n.extend({},u.columnHeaderTexts,r._columnHeaderTexts);r._columnHeaderTexts.eResourceName=r._columnHeaderTexts.resourceName;r._taskModeTexts=i&&i.taskModeTexts?i.taskModeTexts:u.taskModeTexts;r._taskModeTexts=n.extend({},u.taskModeTexts,r._taskModeTexts);r._editDialogTexts=i&&i.editDialogTexts?i.editDialogTexts:u.editDialogTexts;r._editDialogTexts=n.extend({},u.editDialogTexts,r._editDialogTexts);r._columnDialogTexts=i&&i.columnDialogTexts?i.columnDialogTexts:u.columnDialogTexts;r._toolboxTooltipTexts=i&&i.toolboxTooltipTexts?i.toolboxTooltipTexts:u.toolboxTooltipTexts;r._toolboxTooltipTexts=n.extend({},u.toolboxTooltipTexts,r._toolboxTooltipTexts);r._durationUnitTexts=i&&i.durationUnitTexts?i.durationUnitTexts:u.durationUnitTexts;r._durationUnitTexts=n.extend({},u.durationUnitTexts,r._durationUnitTexts);r._durationUnitEditText=i&&i.durationUnitEditText?i.durationUnitEditText:u.durationUnitEditText;r._durationUnitEditText=n.extend({},u.durationUnitEditText,r._durationUnitEditText);r._workUnitTexts=i&&i.workUnitTexts?i.workUnitTexts:u.workUnitTexts;r._workUnitTexts=n.extend({},u.workUnitTexts,r._workUnitTexts);r._taskTypeTexts=i&&i.taskTypeTexts?i.taskTypeTexts:u.taskTypeTexts;r._taskTypeTexts=n.extend({},u.taskTypeTexts,r._taskTypeTexts);r._effortDrivenTexts=i&&i.effortDrivenTexts?i.effortDrivenTexts:u.effortDrivenTexts;r._effortDrivenTexts=n.extend({},u.effortDrivenTexts,r._effortDrivenTexts);r._contextMenuTexts=i&&i.contextMenuTexts?i.contextMenuTexts:u.contextMenuTexts;r._contextMenuTexts=n.extend({},u.contextMenuTexts,r._contextMenuTexts);r._newTaskTexts=i&&i.newTaskTexts?i.newTaskTexts:u.newTaskTexts;r._months=i&&i.calendars?i.calendars.standard.months.namesAbbr:t.preferredCulture(f)?t.preferredCulture(f).calendars.standard.months.namesAbbr:u.calendars.standard.months.namesAbbr;r._days=i&&i.calendars?i.calendars.standard.months.namesAbbr:t.preferredCulture(f)?t.preferredCulture(f).calendars.standard.days.namesAbbr:u.calendars.standard.days.namesAbbr;r._columnMenuTexts=i&&i.columnMenuTexts?i.columnMenuTexts:u.columnMenuTexts;r._columnMenuTexts=n.extend({},u.contextMenuTexts,r._columnMenuTexts);r._columnDialogTitle=i&&i.columnDialogTitle?i.columnDialogTitle:u.columnDialogTitle;r._deleteColumnText=i&&i.deleteColumnText?i.deleteColumnText:u.deleteColumnText;r._okButtonText=i&&i.okButtonText?i.okButtonText:u.okButtonText;r._cancelButtonText=i&&i.cancelButtonText?i.cancelButtonText:u.cancelButtonText;r._confirmDeleteText=i&&i.confirmDeleteText?i.confirmDeleteText:u.confirmDeleteText;r._predecessorEditingTexts=i&&i.predecessorEditingTexts?i.predecessorEditingTexts:u.predecessorEditingTexts;r._predecessorEditingTexts=n.extend({},u.contextMenuTexts,r._predecessorEditingTexts);r._alertTexts=i&&i.alertTexts?i.alertTexts:u.alertTexts;r._alertTexts=n.extend({},u.alertTexts,r._alertTexts);r._dialogTabTitleTexts=i&&i.dialogTabTitleTexts?i.dialogTabTitleTexts:u.dialogTabTitleTexts;r._dialogTabTitleTexts=n.extend({},u.dialogTabTitleTexts,r._dialogTabTitleTexts);r._predecessorCollectionText=i&&i.predecessorCollectionText?i.predecessorCollectionText:u.predecessorCollectionText;r._editTypeText=i&&i.editTypeTexts?i.editTypeTexts:u.editTypeTexts;r._textAlignTypeText=i&&i.textAlignTypes?i.textAlignTypes:u.textAlignTypes;r._clipModeText=i&&i.clipModeTexts?i.clipModeTexts:u.clipModeTexts;r._validationRuleText=i&&i.linkValidationRuleText?i.linkValidationRuleText:u.linkValidationRuleText;r._validationDialogTitle=i&&i.linkValidationDialogTitle?i.linkValidationDialogTitle:u.linkValidationDialogTitle;r._validationRuleOptions=i&&i.linkValidationRuleOptions?i.linkValidationRuleOptions:u.linkValidationRuleOptions;r._connectorLineDialogText=i&&i.connectorLineDialogText?i.connectorLineDialogText:u.connectorLineDialogText;r._nullText=i&&i.nullText?i.nullText:u.nullText;r._quarterYearTexts=i&&i.quarterYearTexts?i.quarterYearTexts:u.quarterYearTexts;r._halfYearTexts=i&&i.halfYearTexts?i.halfYearTexts:u.halfYearTexts},_getMappingItems:function(){for(var n=this,f=n.model,r=[],u=f.viewType==t.Gantt.ViewType.ProjectView?n._columns:n._resourceViewColumns,e=u.length,i=0;i<e;i++)r.push(u[i].mappingName);return r},_getContextMenuItems:function(){var t=this,n=this._contextMenuTexts;return[{headerText:n.taskDetailsText,eventHandler:null,isDefault:!0,menuId:"Task"},{headerText:n.addNewTaskText,eventHandler:null,isDefault:!0,menuId:"Add"},{headerText:n.indentText,eventHandler:null,isDefault:!0,menuId:"Indent"},{headerText:n.outdentText,eventHandler:null,isDefault:!0,menuId:"Outdent"},{headerText:n.deleteText,eventHandler:null,isDefault:!0,menuId:"Delete"},{iconPath:null,headerText:n.aboveText,eventHandler:null,menuId:"Above",parentMenuId:"Add"},{iconPath:null,headerText:n.belowText,eventHandler:null,menuId:"Below",parentMenuId:"Add"}]},_initialize:function(){var n,i,f,u,r,e;if(!this._isFromSetModel){if(n=this,i=n.model,i.cssClass&&n.element.addClass(i.cssClass),n._$treegridPane=t.buildTag("div.e-treegridPane"),n._$ganttchartPane=t.buildTag("div.e-ganttchartPane"),n._$ejGantt=t.buildTag("div.e-gantt-Spliter#e-ejSpliter"+n._id,"",{},{"data-unselectable":"on"}),i.predecessorMapping&&n._updatePredecessors(),n._render(),i.updatedRecords=i.flatRecords.slice(),i.currentViewData=i.flatRecords.slice(),i.predecessorMapping&&i.enablePredecessorValidation&&n._updatedRecordsDateByPredecessor(),n._calculateScheduleDates(),n._calculateHeaderDates(),n._updateGanttRecords(),n._checkDataManagerUpdate(),i.filterSettings&&i.filterSettings.filteredColumns.length>0)for(f=i.filterSettings.filteredColumns,u=0;u<f.length;u++)r=f[u].field,e=t.TreeGrid.getColumnByMappingName(n._columns,r),e!=null&&(r=r==i.resourceInfoMapping?"resourceNames":r==i.predecessorMapping?"predecessorsName":e.field),f[u].field=r;t.isNullOrUndefined(this.isProjectViewData)||(i.viewType=t.Gantt.ViewType.HistogramView,this._checkHistoGramDataBinding());n._renderTreeGrid();i.updatedRecords=n.getUpdatedRecords();i.currentViewData=n.getCurrentViewData();n._renderGanttChart();n._enableCreateCollection=!0;n._isValidationEnabled=!1;n._isLoad=!1;i.viewType=="projectView"&&i.predecessorMapping&&n._createConnectorLinesCollection();n._isValidationEnabled=!0;n._$treegridPane.css({overflow:"hidden"});n._initiateDialogTemplates();i.predecessorMapping&&i.enablePredecessorValidation&&n._validationDialogTemplate();n._isTreeGridRendered=!0;n._isGanttChartRendered=!0;n._gridRows=n.getRows();n._ganttChartRows=n.getGanttChartRows();n._createContextMenuTemplate();n._wireEvents();n._updateScrollerBorder();n._initialEndRendering();n._getLocalizedLabels();i.viewType==t.Gantt.ViewType.HistogramView&&(n._$ganttchartHelper.ejGanttChart("instance")._isCalendarExist=null)}},_getLocalizedLabels:function(){return t.getLocalizedConstants(this.sfType,this.model.locale)},_initialEndRendering:function(){var n=this,t=this.model,i,r;t.enableCollapseAll?(this.selectedRowIndex()!=-1&&n._deSelectRowItem(),n._collapseAll()):t.expandStateMapping&&n._collapseRecordOnLoad();n.selectedRowIndex()>=0&&n.selectedRowIndex()<n.model.updatedRecords.length&&t.selectionMode=="row"&&(i={},i.recordIndex=n.selectedRowIndex(),i.previousIndex=t.selectedItem?t.updatedRecords.indexOf(t.selectedItem):-1,n.rowSelecting(i)&&(n.selectRows(n.selectedRowIndex()),n._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement")));r=n._$treegridHelper.ejTreeGrid("instance");r._jsonData=r.model.dataManagerUpdate.jsonData=n._jsonData},_checkDataManagerUpdate:function(){var n=this,i=this.dataSource();n._isDataManagerUpdate=!1;n._jsonData=null;i instanceof t.DataManager&&(i.dataSource.offline&&i.dataSource.json?(n._isDataManagerUpdate=!0,n._jsonData=i.dataSource.json):i.dataSource.offline||(n._isDataManagerUpdate=!0,n._jsonData=n._retrivedData))},_initiateDialogTemplates:function(){var i=this,r=this.model,u;i.customColumnFields();(r.editSettings.allowEditing||r.editSettings.editMode=="normal"||r.editSettings.editMode=="dialogTemplate")&&(i.editDialogTemplate(),n("#"+this._id+"_dialogEdit").length===0&&i.element.append(i._renderDialog()));r.editSettings.allowAdding&&(i.addDialogTemplate(),n("#"+this._id+"_dialogAdd").length===0&&(u=t.buildTag("div.e-dialog e-dialog-content e-shadow e-widget-content","",{display:"none","overflow-x":"hidden"},{id:this._id+"_dialogAdd"}),i.element.append(u)))},_render:function(){var n=this,i=n.element,r=n.model;n.model.toolbarSettings.showToolbar&&i.append(n._renderToolBar());n._ganttHeight=parseInt(n._ganttHeight)-n._getToolBarHeight()-n._totalBorderHeight;n._$treegridHelper=t.buildTag("div.ejTreeGrid#ejTreeGrid"+n._id,"",{height:n._ganttHeight},{});n._$ganttchartHelper=t.buildTag("div.ejGanttChart#ejGanttChart"+n._id,"",{height:n._ganttHeight},{});n._$ganttchartPane.append(n._$ganttchartHelper);n._$treegridPane.append(n._$treegridHelper);n._$ejGantt.append(n._$treegridPane);n._$ejGantt.append(n._$ganttchartPane);i.append(n._$ejGantt);n._renderGantt()},_renderDialog:function(){return t.buildTag("div.e-dialog e-dialog-content e-shadow e-widget-content","",{display:"none","overflow-x":"hidden"},{id:this._id+"_dialogEdit"})},editDialogTemplate:function(){var i=this,u=i.model,f=u.viewType==t.Gantt.ViewType.ProjectView?n.extend([],i._columns):n.extend([],i._resourceViewColumns),et=u.viewType==t.Gantt.ViewType.ProjectView?i._columns:i._resourceViewColumns,a=f.length,kt=-1,dt=-1,ui=i._$treegridHelper.data("ejTreeGrid"),gt,ni=i._dialogTab,fi=ni.length,ot,p,w,b,c,d,st,ht,r,rt,lt,at,ut,vt,yt,ft,pt,wt,bt;if(i._editDialogGeneralColumns=[],i._editDialogCustomColumns=[],i._generalTabColumnFields=["taskId","taskMode","taskName","startDate","endDate","duration","resourceInfo","status","work","taskType","effortDriven","baselineStartDate","baselineEndDate","predecessor","WBS","notesText","serialNumber","serialNumberPredecessor"],i._mappingItems=i._getMappingItems(),a!=0){if(u.editDialogFields.length>0){for(ot=[],p=0;p<u.editDialogFields.length;p++)w=n.grep(et,function(n){return n.mappingName===u.editDialogFields[p].field}),w.length>0&&(ot.push(w[0]),i._generalTabColumnFields.indexOf(w[0].mappingName)==-1&&u.editDialogFields[p].displayInGeneralTab&&i._generalTabColumnFields.push(w[0].mappingName));f=ot}else u.enableWBS&&(u.enableWBSPredecessor&&(b=f.filter(function(n){return n.mappingName!="WBSPredecessor"})),b&&b.length&&(f=b));for(c=n.map(f,function(n,t){if(n.mappingName==u.taskNameMapping)return t}),(c[0]+1)%3==0&&f.splice(c[0]-1,0,f.splice(c[0],1)[0]),a=f.length,r=0;r<a;r++)if(n.inArray(f[r].mappingName,i._mappingItems)!=-1){if(!u.resourceInfoMapping&&(f[r].field=="work"||f[r].field=="taskType"||f[r].field=="effortDriven"))continue;if(f[r].mappingName!==u.predecessorMapping&&f[r].mappingName!=u.resourceInfoMapping&&f[r].mappingName!=u.notesMapping&&f[r].mappingName!="serialNumberPredecessor"){if(u.enableSerialNumber&&f[r].field=="taskId")continue;c=n.map(i._generalTabColumnFields,function(n,t){if(n==f[r].field)return t});c.length>0?i._editDialogGeneralColumns.push(f[r]):i._editDialogCustomColumns.push(f[r])}else f[r].mappingName!==u.baselineStartDateMapping&&f[r].mappingName!==u.baselineEndDateMapping&&(f[r].mappingName==u.resourceInfoMapping?dt=r:(f[r].mappingName==u.predecessorMapping||f[r].mappingName=="serialNumberPredecessor")&&(kt=r))}var k=t.buildTag("div","",{},{}),l=t.buildTag("div","",{},{id:i._id+"EditTab"}),v=t.buildTag("ul","",{},{}),e,o,s,h,y;for(l.append(v),k.append(l),d=0;d<fi;d++)switch(ni[d]){case"General":if(i._editDialogGeneralColumns.length>0){v.append("<li><a href='#"+i._id+"EditGeneral'>"+i._dialogTabTitleTexts.generalTabText+"<\/a><\/li>");st=t.buildTag("div.e-gantt-editor-container","",{},{id:i._id+"EditGeneral"});ht=t.buildTag("form","",{height:"auto",width:"auto","font-size":"14px"},{id:i._id+"GeneralEditForm"});st.append(ht);l.append(st);var ct=t.buildTag("table.e-general-edit-div","",{"border-spacing":"2px","border-collapse":"separate","margin-top":"0px"},{}),g=t.buildTag("tr"),nt,tt=0,it=i._editDialogGeneralColumns,a=it.length;for(r=0;r<a;r++)tt<3?(it[r].mappingName!==u.taskNameMapping?(tt++,nt=t.buildTag("td.e-property-container","",{},{})):(tt+=2,nt=t.buildTag("td.e-property-container","",{},{colspan:"2"})),rt=t.buildTag("table","",{outline:"none","border-spacing":"2px","border-collapse":"separate","margin-top":"0px"},{}),e=t.buildTag("tr","",{"line-height":"1.4"},{}),o=t.buildTag("td.e-editLabel","",{},{}),o.append("<label>"+i._columnHeaderTexts[it[r].field]+"<\/label>"),e.append(o),rt.append(e),s=t.buildTag("tr"),h=t.buildTag("td.e-editValue","",{},{}),gt=et.indexOf(it[r]),t.TreeGrid._initCellEditType(ui,h,i._id,gt,"Edit",u.viewType==t.Gantt.ViewType.ProjectView?!1:!0,et),s.append(h),rt.append(s),nt.append(rt),g.append(nt)):(ct.append(g),g=t.buildTag("tr"),r--,tt=0);ct.append(g);ht.append(ct)}break;case"Predecessors":u.predecessorMapping&&kt!=-1&&(v.append("<li><a href='#"+i._id+"EditPredecessors'>"+i._dialogTabTitleTexts.predecessorsTabText+"<\/a><\/li>"),lt=t.buildTag("div.e-gantt-predecessor-container","",{},{id:i._id+"EditPredecessors"}),at=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:i._id+"PredecessorEditForm"}),lt.append(at),l.append(lt),ut=t.buildTag("table#"+i._id+"predecessoreditTable","",{width:"100%",outline:"none","border-collapse":"collapse","margin-top":"0px",position:"relative",left:"-2px",top:"2px"},{}),e=t.buildTag("tr","",{"border-collapse":"collapse",height:"40px"},""),o=t.buildTag("td.e-editLabel","",{outline:"none","border-collapse":"collapse",padding:"1px"},{}),o.append("<span id='"+i._id+"EditDialog_PredecesorAdd' class='e-addpre e-icon e-enable e-edit-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+i._editDialogTexts.addPredecessor+"<\/span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='"+i._id+"EditDialog_PredecesorDelete' class='e-deletepre e-icon e-disable e-edit-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+i._editDialogTexts.removePredecessor+"<\/span>"),e.append(o),ut.append(e),s=t.buildTag("tr","",{"border-collapse":"collapse"},{}),h=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),y=t.buildTag("div#treegrid"+i._id+"predecessorEdit","",{width:"100%",height:"150px"},{}),h.append(y),s.append(h),ut.append(s),at.append(ut));break;case"Resources":u.resourceInfoMapping&&dt!=-1&&(v.append("<li><a href='#"+i._id+"EditResources'>"+i._dialogTabTitleTexts.resourcesTabText+"<\/a><\/li>"),vt=t.buildTag("div.e-gantt-resource-container","",{},{id:i._id+"EditResources"}),yt=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:i._id+"ResourceEditForm"}),vt.append(yt),l.append(vt),ft=t.buildTag("table#"+i._id+"resourceeditTable","",{width:"100%",outline:"none","border-collapse":"collapse","margin-top":"0px",position:"relative",left:"-2px",top:"2px"},{}),e=t.buildTag("tr","",{"border-collapse":"collapse",height:"40px"},{}),o=t.buildTag("td.e-editLabel","",{outline:"none","border-collapse":"collapse",padding:"1px"},{}),o.append("<span id='"+i._id+"EditDialog_ResourceAdd' class='e-addpre e-icon e-enable e-edit-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+i._editDialogTexts.addPredecessor+"<\/span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='"+i._id+"EditDialog_ResourceDelete' class='e-deletepre e-icon e-disable e-edit-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+i._editDialogTexts.removePredecessor+"<\/span>"),e.append(o),ft.append(e),s=t.buildTag("tr","",{"border-collapse":"collapse"},{}),h=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),y=t.buildTag("div#treegrid"+i._id+"resourceEdit","",{width:"100%",height:"150px"},{}),h.append(y),s.append(h),ft.append(s),yt.append(ft));break;case"Custom Fields":i._editDialogCustomColumns.length>0&&(v.append("<li><a href='#"+i._id+"EditCustomFields'>"+i._dialogTabTitleTexts.customFieldsTabText+"<\/a><\/li>"),pt=t.buildTag("div.e-gantt-csfield-container","",{},{id:i._id+"EditCustomFields"}),wt=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:i._id+"CustomFieldsEditForm"}),pt.append(wt),l.append(pt),bt=t.buildTag("table#"+i._id+"customFieldeditTable","",{width:"100%",outline:"none",position:"relative",left:"-2px",top:"4px","border-collapse":"collapse","margin-top":"0px"},{}),e=t.buildTag("tr","",{"border-collapse":"collapse"},""),o=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),y=t.buildTag("div#treegrid"+i._id+"customFieldEdit","",{},{}),o.append(y),e.append(o),bt.append(e),wt.append(bt));break;case"Notes":var ti=u.editDialogFields,a=ti.length,c=n.map(ti,function(n,t){if(n.field==u.notesMapping)return t});if(u.notesMapping&&a==0||a>0&&c.length>0){v.append("<li><a href='#"+i._id+"EditNotes'>"+i._dialogTabTitleTexts.notesTabText+"<\/a><\/li>");var ii=t.buildTag("div.e-gantt-notes-container","",{},{id:i._id+"EditNotes"}),ri=t.buildTag("div","",{padding:"0px",position:"relative",top:"5px",left:"-1px"},{}),ei=t.buildTag("textarea","",{},{id:i._id+"EditAreaNotes"});ri.append(ei);ii.append(ri);l.append(ii)}}k=i.renderDiaglogButton("edit",k);n.templates(i._id+"_JSONDialogEditingTemplate",k.html())}},addDialogTemplate:function(){var i=this,f=i.model,u=f.viewType==t.Gantt.ViewType.ProjectView?n.extend([],i._columns):n.extend([],i._resourceViewColumns),et=f.viewType==t.Gantt.ViewType.ProjectView?i._columns:i._resourceViewColumns,a=u.length,kt=-1,dt=-1,ui=i._$treegridHelper.data("ejTreeGrid"),gt,ni=i._dialogTab,fi=ni.length,ot,p,w,b,c,d,st,ht,r,rt,lt,at,ut,vt,yt,ft,pt,wt,bt;if(i._addDialogGeneralColumns=[],i._addDialogCustomColumns=[],i._generalTabColumnFields=["taskId","taskMode","taskName","startDate","endDate","duration","resourceInfo","status","work","taskType","effortDriven","baselineStartDate","baselineEndDate","predecessor","WBS","notesText","serialNumber","serialNumberPredecessor"],i._mappingItems=i._getMappingItems(),a!=0){if(f.addDialogFields.length>0){for(ot=[],p=0;p<f.addDialogFields.length;p++)w=n.grep(et,function(n){return n.mappingName===f.addDialogFields[p].field}),w.length>0&&(ot.push(w[0]),i._generalTabColumnFields.indexOf(w[0].mappingName)==-1&&f.addDialogFields[p].displayInGeneralTab&&i._generalTabColumnFields.push(w[0].mappingName));u=ot}else f.enableWBS&&(f.enableWBSPredecessor&&(b=u.filter(function(n){return n.mappingName!="WBSPredecessor"})),b&&b.length&&(u=b));c=n.map(u,function(n,t){if(n.mappingName==f.taskNameMapping)return t});(c[0]+1)%3==0&&u.splice(c[0]-1,0,u.splice(c[0],1)[0]);var k=t.buildTag("div","",{},{}),l=t.buildTag("div","",{},{id:i._id+"AddTab"}),v=t.buildTag("ul","",{},{}),e,o,s,h,y;for(l.append(v),k.append(l),a=u.length,r=0;r<a;r++)if(n.inArray(u[r].mappingName,i._mappingItems)!=-1){if(!u[r].mappingName&&u[r].field=="work"||u[r].field=="taskType"||u[r].field=="effortDriven")continue;u[r].mappingName!==f.predecessorMapping&&u[r].mappingName!=f.resourceInfoMapping&&u[r].mappingName!=f.notesMapping&&u[r].mappingName!="serialNumberPredecessor"?(c=n.map(i._generalTabColumnFields,function(n,t){if(n==u[r].field)return t}),c.length>0?i._addDialogGeneralColumns.push(u[r]):i._addDialogCustomColumns.push(u[r])):u[r].mappingName===f.predecessorMapping||u[r].mappingName==="serialNumberPredecessor"?kt=r:u[r].mappingName===f.resourceInfoMapping&&(dt=r)}for(d=0;d<fi;d++)switch(ni[d]){case"General":if(i._addDialogGeneralColumns.length>0){v.append("<li><a href='#"+i._id+"AddGeneral'>"+i._dialogTabTitleTexts.generalTabText+"<\/a><\/li>");st=t.buildTag("div.e-gantt-editor-container","",{},{id:i._id+"AddGeneral"});ht=t.buildTag("form","",{height:"auto",width:"auto","font-size":"14px"},{id:i._id+"GeneralAddForm"});st.append(ht);l.append(st);var ct=t.buildTag("table.e-general-edit-div","",{"border-spacing":"2px","border-collapse":"separate","margin-top":"0px"},{}),g=t.buildTag("tr"),nt,tt=0,it=i._addDialogGeneralColumns,a=it.length;for(r=0;r<a;r++)tt<3?(it[r].mappingName!==f.taskNameMapping?(tt++,nt=t.buildTag("td.e-property-container","",{},{})):(tt+=2,nt=t.buildTag("td.e-property-container","",{},{colspan:"2"})),rt=t.buildTag("table","",{outline:"none","border-spacing":"2px","border-collapse":"separate","margin-top":"0px"},{}),e=t.buildTag("tr","",{"line-height":"1.4"},{}),o=t.buildTag("td.e-editLabel","",{},{}),o.append("<label>"+i._columnHeaderTexts[it[r].field]+"<\/label>"),e.append(o),rt.append(e),s=t.buildTag("tr"),h=t.buildTag("td.e-editValue","",{},{}),gt=et.indexOf(it[r]),t.TreeGrid._initCellEditType(ui,h,i._id,gt,"Add",f.viewType==t.Gantt.ViewType.ProjectView?!1:!0,et),s.append(h),rt.append(s),nt.append(rt),g.append(nt)):(ct.append(g),g=t.buildTag("tr"),r--,tt=0);ct.append(g);ht.append(ct)}break;case"Predecessors":f.predecessorMapping&&kt!=-1&&(v.append("<li><a href='#"+i._id+"AddPredecessors'>"+i._dialogTabTitleTexts.predecessorsTabText+"<\/a><\/li>"),lt=t.buildTag("div.e-gantt-predecessor-container","",{},{id:i._id+"AddPredecessors"}),at=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:i._id+"PredecessorAddForm"}),lt.append(at),l.append(lt),ut=t.buildTag("table#"+i._id+"predecessoraddTable","",{width:"100%",outline:"none","border-collapse":"collapse",position:"relative",left:"-2px",top:"2px","margin-top":"0px"},{}),e=t.buildTag("tr","",{"border-collapse":"collapse",height:"40px"},{}),o=t.buildTag("td.e-editLabel","",{outline:"none","border-collapse":"collapse",padding:"1px"},{}),o.append("<span id='"+i._id+"AddDialog_PredecesorAdd' class='e-addpre e-icon e-enable e-add-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+i._editDialogTexts.addPredecessor+"<\/span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='"+i._id+"AddDialog_PredecesorDelete' class='e-deletepre e-icon e-disable e-add-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+i._editDialogTexts.removePredecessor+"<\/span>"),e.append(o),ut.append(e),s=t.buildTag("tr","",{"border-collapse":"collapse"},{}),h=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),y=t.buildTag("div#treegrid"+i._id+"predecessorAdd","",{width:"100%",height:"150px"},{}),h.append(y),s.append(h),ut.append(s),at.append(ut));break;case"Resources":f.resourceInfoMapping&&dt!=-1&&(v.append("<li><a href='#"+i._id+"AddResources'>"+i._dialogTabTitleTexts.resourcesTabText+"<\/a><\/li>"),vt=t.buildTag("div.e-gantt-resource-container","",{},{id:i._id+"AddResources"}),yt=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:i._id+"ResourceAddForm"}),vt.append(yt),l.append(vt),ft=t.buildTag("table#"+i._id+"resourceaddTable","",{width:"100%",outline:"none","border-collapse":"collapse",position:"relative",left:"-2px",top:"2px","margin-top":"0px"},{}),e=t.buildTag("tr","",{"border-collapse":"collapse",height:"40px"},{}),o=t.buildTag("td.e-editLabel","",{outline:"none","border-collapse":"collapse",padding:"1px"},{}),o.append("<span id='"+i._id+"AddDialog_ResourceAdd' class='e-addpre e-icon e-enable e-add-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+i._editDialogTexts.addPredecessor+"<\/span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='"+i._id+"AddDialog_ResourceDelete' class='e-deletepre e-icon e-disable e-add-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+i._editDialogTexts.removePredecessor+"<\/span>"),e.append(o),ft.append(e),s=t.buildTag("tr","",{"border-collapse":"collapse"},{}),h=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),y=t.buildTag("div#treegrid"+i._id+"resourceAdd","",{width:"100%",height:"150px"},{}),h.append(y),s.append(h),ft.append(s),yt.append(ft));break;case"Custom Fields":i._addDialogCustomColumns.length>0&&(v.append("<li><a href='#"+i._id+"AddCustomFields'>"+i._dialogTabTitleTexts.customFieldsTabText+"<\/a><\/li>"),pt=t.buildTag("div.e-gantt-csfield-container","",{},{id:i._id+"AddCustomFields"}),wt=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:i._id+"CustomfFieldsAddForm"}),pt.append(wt),l.append(pt),bt=t.buildTag("table#"+i._id+"customfieldaddTable","",{width:"100%",outline:"none","border-collapse":"collapse",position:"relative",left:"-2px",top:"4px"},{}),e=t.buildTag("tr","",{"border-collapse":"collapse"},{}),o=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),y=t.buildTag("div#treegrid"+i._id+"customFieldAdd","",{},{}),o.append(y),e.append(o),bt.append(e),wt.append(bt));break;case"Notes":var ti=f.addDialogFields,a=ti.length,c=n.map(ti,function(n,t){if(n.field==f.notesMapping)return t});if(f.notesMapping&&a==0||a>0&&c.length>0){v.append("<li><a href='#"+i._id+"AddNotes'>"+i._dialogTabTitleTexts.notesTabText+"<\/a><\/li>");var ii=t.buildTag("div.e-gantt-notes-container","",{},{id:i._id+"AddNotes"}),ri=t.buildTag("div","",{padding:"0px",position:"relative",top:"5px",left:"-1px"},{}),ei=t.buildTag("textarea","",{},{id:i._id+"AddAreaNotes"});ri.append(ei);ii.append(ri);l.append(ii)}}k=i.renderDiaglogButton("add",k);n.templates(i._id+"_JSONDialogAddingTemplate",k.html())}},_clearContextMenu:function(){n(".e-tgcontextmenu").remove();n(".e-tginnerContextmenu").remove()},_createContextMenuTemplate:function(){var t=this,u={},i,f,r;u["_"+t._id+"getHeaderName"]=n.proxy(t._getHeaderName,t);n.views.helpers(u);i="<li style='list-style-type:none;margin:0px;'>";f="<div class='e-menuitem{{if disable}} e-disable{{/if}}{{if ~_"+t._id+"getHeaderName(#data)}} e-parent-menuitem{{/if}}' id={{:menuId}}  style='display:table;cursor:pointer;min-width:100px;'>{{if iconPath}}<div class='e-icon e-tgcontextmenu-image' style='background-image:{{:iconPath}};background-repeat:no-repeat;'/>{{else}}<div class='e-icon {{:iconClass}} e-tgcontextmenu-icon'/>{{/if}}<div class='e-tgcontextmenu-label'><span>{{:headerText}}<\/span><\/div>{{if ~_"+t._id+"getHeaderName(#data)}}<div class='e-icon e-expander e-tgcontextmenu-icon'/> {{/if}}";i+=f;i+="<\/div><\/li>";r={};r[t._id+"contextMenuTemplate"]=i;n.templates(r)},_getHeaderName:function(n){var t=this._contextMenuItems.filter(function(t){if(n.menuId!=null&&n.menuId==t.parentMenuId)return!0});return t.length>0?!0:!1},initCellEditType:function(i,r,u){var f=this,o=f.model,e,s={},h,c,l,a;e=u?u:"";t.isNullOrUndefined(i.editType)&&(i.editType="stringedit");switch(i.editType){case"stringedit":i.mappingName===o.predecessorMapping?(s["_"+f._id+"predecessor"]=f._getPredecessorsValue,n.views.helpers(s),r.html(t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+f._id+"predecessor('"+f._id+"Object','"+o.predecessorMapping+"','"+i.field+"')}}",id:f._id+i.field,name:i.field}))):r.html(t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:#data['"+i.field+"']}}",id:f._id+i.field+e,name:i.field,"data-dialog":u}));break;case"booleanedit":r.html("{{if "+i.field+'}} <input class="e-field e-checkbox" type ="checkbox" id='+f._id+i.field+" name="+i.field+' checked="checked"><\/input>{{else}} <input class="e-field e-checkbox" type ="checkbox" id='+f._id+i.field+" name="+i.field+" > {{/if}}");break;case"numericedit":h=t.buildTag("input.e-numerictextbox e-field","",{},{type:"text",value:"{{:#data['"+i.field+"']}}",id:f._id+i.field+e,name:i.field,"data-dialog":u});r.append(h);break;case"datepicker":case"datetimepicker":c=t.buildTag("input.e-"+i.editType+" e-field","",{},{type:"text",value:"{{:#data['"+i.field+"']}}",id:f._id+i.field+e,name:i.field,"data-dialog":u});r.append(c);break;case"dropdownedit":l=t.buildTag("input.e-field e-dropdownlist e-field","",{},{type:"text",value:"{{:#data['"+i.field+"']}}",id:f._id+i.field+e,name:i.field,"data-dialog":u});r.append(l);break;case"maskedit":a=t.buildTag("input .e-field e-maskedit","",{},{value:"{{:#data['"+i.field+"']}}",id:f._id+i.field+e,name:i.field,"data-dialog":u});r.append(a)}},_getPredecessorsValue:function(n,t){return this.data.item?this.data.item[t]:""},_getDurationValues:function(n,i){var r="",s=this.model,u=null,h,c,f,e,l,o;return typeof n=="string"?(h=t.globalize.findCulture(s.locale),c=h.numberFormat,f=c[","]!=","?n.match(/(\d*\.*\,*\d+|[A-z]+)/g):n.match(/(\d*\.*\d+|[A-z]+)/g),f&&f.length<=2&&(r=t.parseFloat(f[0],null,s.locale),e=f[1]?f[1].toLowerCase():null,l=r!=1?!0:!1,this._durationUnitEditText.minute.indexOf(e)!=-1?u=t.Gantt.DurationUnit.Minute:this._durationUnitEditText.hour.indexOf(e)!=-1?u=t.Gantt.DurationUnit.Hour:this._durationUnitEditText.day.indexOf(e)!=-1&&(u=t.Gantt.DurationUnit.Day))):(r=n,u=null),isNaN(r)&&(r=i?this._editedDialogRecord.duration:null,u=i?this._editedDialogRecord.durationUnit:null),o={},o.duration=r,o.durationUnit=u,o},_editStartDateChange:function(i,r){var f=this,o=f._id,h=f.model,a=i.attr("id"),ot=this.model.holidays,ft=i.attr("data-dialog"),st=h.selectionMode=="row"?this.selectedItem():h.updatedRecords[f._rowIndexOfLastSelectedCell],u=this._editedDialogRecord,it=u.effortDriven=="true"?!0:!1,rt,ut,b,l,c,y,k,d,p,w,tt,g,nt;if(!this._editedDialogRecord.isUpdatedFromDialog){this._editedDialogRecord.isUpdatedFromDialog=!0;ft==="Add"?(l="#"+o+"startDateAdd",c="#"+o+"endDateAdd",y="#"+o+"durationAdd",rt="#"+o+"effortDrivenAdd",ut="#"+o+"taskTypeAdd",b="#"+o+"workAdd",k="#"+o+"baselineStartDateAdd",d="#"+o+"baselineEndDateAdd"):(l="#"+o+"startDateEdit",c="#"+o+"endDateEdit",y="#"+o+"durationEdit",rt="#"+o+"effortDrivenEdit",ut="#"+o+"taskTypeEdit",b="#"+o+"workEdit");var s=n(l).val(),e=n(c).val(),v=n(y).val(),et=n(b).val();s&&s!=""||(s=h.allowUnscheduledTask?null:u.startDate);v&&v!=""||(v=h.allowUnscheduledTask?null:u.duration);e&&e!=""||(e=h.allowUnscheduledTask?null:u.endDate);a===o+"startDateEdit"||a===o+"startDateAdd"?(s=f._getDateFromFormat(s),s=f._checkStartDate(s,u),t.isNullOrUndefined(s)?(u.startDate=null,u.duration=null,u.isMilestone=!1,v=f._getDurationStringValue(u),n(y).val(v),t.isNullOrUndefined(u.endDate)||(u.endDate.getHours()==0&&this._defaultEndTime!=86400&&this._setTime(this._defaultEndTime,u.endDate),u.endDate=this._checkEndDate(u.endDate,u))):t.isNullOrUndefined(v)?t.isNullOrUndefined(e)?t.isNullOrUndefined(s)||(u.startDate=s):f._getDateFromFormat(s)<u.endDate?(u.startDate=s,u.duration=this._getDuration(u.startDate,u.endDate,u.durationUnit,u.isAutoSchedule),u.isMilestone=u.duration==0?!0:!1,f._updateResourceRelatedFields(u),it||n(b).ejNumericTextbox("option","value",u.work),n(y).val(f._getDurationStringValue(u)),u.taskType=="fixedWork"&&f._updateResourceDataSource(u)):t.isNullOrUndefined(s)||(u.startDate=s):(u.endDate=f._getEndDate(s,u.duration,u.durationUnit,u),u.startDate=s,h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(c).ejDateTimePicker("option","value",u.endDate):n(c).ejDatePicker("option","value",u.endDate)),f.getFormatedDate(s)!=r.value&&(h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(l).ejDateTimePicker("option","value",s):n(l).ejDatePicker("option","value",s))):a===o+"endDateEdit"||a===o+"endDateAdd"?(e=f._getDateFromFormat(e),t.isNullOrUndefined(e)||e.getHours()!=0||this._defaultEndTime==86400||this._setTime(this._defaultEndTime,e),e=this._checkEndDate(e,u),t.isNullOrUndefined(e)?(u.endDate=null,u.duration=null,u.isMilestone=!1,v=f._getDurationStringValue(u),n(y).val(v)):t.isNullOrUndefined(s)?t.isNullOrUndefined(v)?t.isNullOrUndefined(e)||(u.endDate=e):(u.endDate=e,u.startDate=f._getStartDate(u.endDate,u.duration,u.durationUnit,u),u.isMilestone&&(u.startDate=this._checkStartDate(u.startDate,u)),f.getFormatedDate(u.startDate)!=s&&(h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(l).ejDateTimePicker("option","value",u.startDate):n(l).ejDatePicker("option","value",u.startDate))):u.startDate<e?(u.endDate=e,u.duration=this._getDuration(u.startDate,e,u.durationUnit,u.isAutoSchedule),u.isMilestone=u.duration==0?!0:!1,f._updateResourceRelatedFields(u),it||n(b).ejNumericTextbox("option","value",u.work),n(y).val(f._getDurationStringValue(u)),u.taskType=="fixedWork"&&f._updateResourceDataSource(u)):e=u.endDate,f.getFormatedDate(e)!=r.value&&(h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(c).ejDateTimePicker("option","value",e):n(c).ejDatePicker("option","value",e))):a===o+"durationEdit"||a===o+"durationAdd"?(tt=f._getDurationValues(v,!0),p=tt.duration,w=t.isNullOrUndefined(tt.durationUnit)?u.durationUnit:tt.durationUnit,(u.duration!=p||u.durationUnit!=w)&&(p===""||p===null?(u.endDate=null,u.duration=null,u.isMilestone=!1,u.durationUnit=w,h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(c).ejDateTimePicker("option","value",u.endDate):n(c).ejDatePicker("option","value",u.endDate)):t.isNullOrUndefined(s)?t.isNullOrUndefined(e)?t.isNullOrUndefined(p)||(u.duration=p,u.durationUnit=w):(u.duration=p,u.durationUnit=w,u.startDate=f._getStartDate(u.endDate,u.duration,u.durationUnit,u),u.isMilestone&&(u.startDate=this._checkStartDate(u.startDate,u)),f.getFormatedDate(u.startDate)!=s&&(h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(l).ejDateTimePicker("option","value",u.startDate):n(l).ejDatePicker("option","value",u.startDate))):(u.duration=p,u.durationUnit=w,u.isMilestone=u.duration==0?!0:!1,u.endDate=f._getEndDate(u.startDate,u.duration,u.durationUnit,u),h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(c).ejDateTimePicker("option","value",u.endDate):n(c).ejDatePicker("option","value",u.endDate))),f._updateResourceRelatedFields(u),it||n(b).ejNumericTextbox("option","value",u.work),n(y).val(f._getDurationStringValue(u)),u.taskType=="fixedWork"&&f._updateResourceDataSource(u)):a===o+"workEdit"||a===o+"workAdd"?(u.work=parseInt(et),f._updateResourceRelatedFields(u),u.taskType!="fixedDuration"&&u.isAutoSchedule?(n(y).val(f._getDurationStringValue(u)),u.isMilestone&&(u.duration>0&&(u.isMilestone=!1),u.startDate=this._checkStartDate(u.startDate,u),f.getFormatedDate(u.startDate)!=s&&(h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(l).ejDateTimePicker("option","value",u.startDate):n(l).ejDatePicker("option","value",u.startDate))),h.viewType=="resourceView"&&(u.duration=u.duration==0?1:u.duration),e=this._getEndDate(u.startDate,u.duration,w,u),u.endDate=e,h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(c).ejDateTimePicker("option","value",e):n(c).ejDatePicker("option","value",e)):f._updateResourceDataSource(u)):a===o+"baselineStartDateAdd"?n(d).length>0&&(g=f._getDateFromFormat(n(k).val()),nt=f._getDateFromFormat(n(d).val()),g&&nt&&g.getTime()>nt.getTime()&&(h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(k).ejDateTimePicker("option","value",r.prevDate):n(k).ejDatePicker("option","value",r.prevDate))):a===o+"baselineEndDateAdd"&&n(k).length>0&&(g=f._getDateFromFormat(n(k).val()),nt=f._getDateFromFormat(n(d).val()),g&&nt&&g.getTime()>nt.getTime()&&(h.dateFormat.toLowerCase().indexOf("hh")!=-1?n(d).ejDateTimePicker("option","value",r.prevDate):n(d).ejDatePicker("option","value",r.prevDate)));this._editedDialogRecord.isUpdatedFromDialog=!1}},_taskNameCollection:function(){var i=this,u=this.model,t=u.viewType=="resourceView"?this._resourceUniqTasks:i.model.flatRecords,n,r;for(i._preTableCollection=[],i._preTaskIds=[],n=0;n<t.length;n++)t[n].hasChildRecords||(r=i.model.enableSerialNumber?{id:t[n].taskId.toString(),text:t[n].serialNumber.toString()+"-"+t[n].taskName,value:t[n].serialNumber.toString()}:{id:t[n].taskId.toString(),text:t[n].taskId.toString()+"-"+t[n].taskName,value:t[n].taskId.toString()},i._preTaskIds.push(r.value),i._preTableCollection.push(r))},_getPredecessorDropdownData:function(n,t){var i=this,e=i.model,f=i._preTableCollection,r=i._preTaskIds,u=-1,o=e.enableSerialNumber?t.serialNumber:t.taskId;u=r.indexOf(o.toString());f.splice(u,1);r.splice(u,1);i._getVaildSuccessorTasks(t,r,f)},_idFromPredecessor:function(t){for(var f,r,u=n.map(t.split(","),n.trim),e=[],i=0;i<u.length;i++){for(f=[],r=0;r<u[i].length;r++)if(isNaN(u[i].charAt(r)))break;else f.push(u[i].charAt(r));e.push(f.join(""))}return e},_idFromSerialPredecessor:function(t){for(var i,u,f=n.map(t.split(","),n.trim),e=[],o=this.model.flatRecords,r=0;r<f.length;r++)i=f[r].match(/(\d+|[A-z]+)/g),i&&i[0]&&(n.map(o,function(n){if(n.serialNumber==i[0])return u=n.taskId,!1}),u&&e.push(u));return e},_preEditDialogChangeEvent:function(i,r,u,f){var o=n(i).data("ejTreeGrid"),s=t.TreeGrid.getRowByIndex(o,o.selectedRowIndex()),e,h;u=="name"?(e=n(s).find("td:eq(0)"),n(e).html(f.value)):(e=n(s).find("td:eq(1)"),h=f.model.dataSource[f.itemId],n(e).html(h.text))},_preBeginEdit:function(t,i,r){for(var o,s,u=this,h=r.model,c=h.columns,f=n.extend(!0,[],u._preTableCollection),l=n.extend(!0,[],u._preTaskIds),a=h.dataSource,v=a.length,y=r.data.item.id,e=0;e<v;e++)o=a[e],o.id!=y&&(s=l.indexOf(o.id),l.splice(s,1),f.splice(s,1));c[0].dropdownData=c[1].dropdownData=f;f.length<=1&&u._enbleDisablePredecessorAddButton("disable",i.requestType)},_preEndEdit:function(i,r,u){var s=this,o=u.model.dataSource,f=u.model.selectedItem,e,h=u.model.preIds;u.value!==null&&(u.columnName==="name"||u.columnName==="id")&&(u.value.length>0&&(f.id=f.name=u.value,e=o.indexOf(f.item),e===-1&&(o.push(f.item),e=o.indexOf(f.item)),o[e].id=o[e].name=u.value),f.type||t.isNullOrUndefined(e)||(f.type="Finish-Start",o[e].type="Finish-Start"),n(i).ejTreeGrid("refreshRow",u.model.selectedRowIndex))},_enableDisablePredecessorDelete:function(t){var i=this,r;r=t=="add"?n("#"+i._id+"AddDialog_PredecesorDelete"):n("#"+i._id+"EditDialog_PredecesorDelete");n(r).unbind("click",n.proxy(i._deletepredecessor,i)).bind("click",n.proxy(i._deletepredecessor,i));n(r).removeClass("e-disable").addClass("e-enable")},_enableDisableResouceDelete:function(t){var i=this,r;r=t=="add"?n("#"+i._id+"AddDialog_ResourceDelete"):n("#"+i._id+"EditDialog_ResourceDelete");n(r).unbind("click",n.proxy(i._deleteResource,i)).bind("click",n.proxy(i._deleteResource,i));n(r).removeClass("e-disable").addClass("e-enable")},_predecessorEditCollection:function(n){var f=this,a=f.model,h,d,c,v=[],u,i,e,w,b,y,o,s,l,p,k;if(d="#"+f._id+"predecessor",c=f._predecessorCollectionText,v=[],u=n?n:a.selectedItem,h=f._preTableCollection,!t.isNullOrUndefined(u)&&!t.isNullOrUndefined(u.predecessor)&&!t.isNullOrUndefined(u.item[a.predecessorMapping])){var r=u.predecessor,g=r.length,nt=c.length,tt=h.length;for(i=0;i<g;i++)if(e=a.enableSerialNumber?f._snoFromTaskId(r[i].from):r[i].from,e=e.toString(),u.taskId.toString()!==r[i].from.toString()){for(y=0,o=0;o<tt;o++)if(h[o].value===e){w=h[o].value;break}for(s=0;s<nt;s++)c[s].id==r[i].predecessorsType&&(b=c[s].text);l=Math.abs(r[i].offset)!=1;p="";p+=r[i].offsetDurationUnit=="day"?l?this._durationUnitTexts.days:this._durationUnitTexts.day:r[i].offsetDurationUnit=="hour"?l?this._durationUnitTexts.hours:this._durationUnitTexts.hour:l?this._durationUnitTexts.minutes:this._durationUnitTexts.minute;y=r[i].offset+" "+p;k={id:e,name:w,type:b,offset:y};v.push(k)}}return v},_getResourceInfoIndex:function(n,t){var i=0,r=[];if(n&&t)for(i;i<n.length;i++)t[n[i]]&&r.push(n[i]);return r},_getNewSerialNumber:function(){var u=this,i=u.model,f=i.flatRecords,r,n,e=i.editSettings.rowPosition.toLowerCase(),o;if(r=i.selectionMode=="row"?i.selectedItem:i.updatedRecords[u._rowIndexOfLastSelectedCell],n=r?i.updatedRecords.indexOf(r)+1:e=="bottom"?f.length+1:1,r)switch(e){case t.Gantt.RowPosition.BelowSelectedRow:r.hasChildRecords?(o=u._$treegridHelper.ejTreeGrid("getChildCount",r,0),n=n+o+1):n=n+1;break;case t.Gantt.RowPosition.Top:n=1;break;case t.Gantt.RowPosition.Bottom:n=f.length+1;break;case t.Gantt.RowPosition.Child:n=n+1}return n},_snoFromTaskId:function(t){var r=this,u=r.model,f=u.flatRecords,i;return n.map(f,function(n){if(n.taskId==t)return i=n.serialNumber,!1}),i},_refreshEditForm:function(r){var u=this,kt=!1,lt,s=0,ci,f,p="165px",e=u.model,dt,o={},h,gt,at,ni,ti,k,w=e.viewType=="resourceView"?r.data:e.selectionMode=="row"?e.selectedItem:e.updatedRecords[u._rowIndexOfLastSelectedCell],vt=e.viewType=="resourceView"?u._resourceViewColumns:u._columns,tt,ii,ri,nt,st,ui,yt,pt,d,l,c,rt,fi,ei,ft,si,wt,b,g,oi,v,y,hi;if(r.requestType=="add"){var ai=document.getElementById(u._id+"AddTab"),li=n("#"+u._id+"_dialogAdd_wrapper"),ci=document.getElementById(u._id+"GeneralAddForm"),k="#treegrid"+u._id+"predecessorAdd",it="#"+u._id+"AddAreaNotes",et="#treegrid"+u._id+"resourceAdd",ot="#treegrid"+u._id+"customFieldAdd";!t.isNullOrUndefined(this.dataSource())&&this.dataSource().length==0&&e.predecessorMapping&&n(k).length>0?(tt=[],tt[0]=u._dialogTab.indexOf("Predecessors"),n("#"+u._id+"AddTab").ejTab("option","disabledItemIndex",tt)):(tt=[],tt[0]=u._dialogTab.indexOf("Predecessors"),n("#"+u._id+"AddTab").ejTab("option","enabledItemIndex",tt));at=u._getNewTaskId();u.model.enableWBS&&(ii=e.editSettings.rowPosition.toLowerCase(),ri=u._getNewWBSid(ii));ni=e.enableSerialNumber&&u._getNewSerialNumber()}else{var ai=document.getElementById(u._id+"EditTab"),li=n("#"+u._id+"_dialogEdit_wrapper"),ci=document.getElementById(u._id+"GeneralEditForm"),k="#treegrid"+u._id+"predecessorEdit",it="#"+u._id+"EditAreaNotes",et="#treegrid"+u._id+"resourceEdit",ot="#treegrid"+u._id+"customFieldEdit";e.flatRecords.length<=2&&e.parentRecords.length==1&&e.predecessorMapping&&n(k).length>0&&n("#"+u._id+"EditTab").ejTab("removeItem",1)}for(lt=n(ci).find("input,select"),g=lt.length,s;s<g;s++){if(f=lt.eq(s),o={},p=180,h=t.TreeGrid.getColumnByField(vt,f.prop("name")),h)y=r.data[h.field];else continue;if(f.hasClass("e-numerictextbox"))dt=p,o.width=dt,o.showSpinButton=!0,o.cssClass=e.cssClass,l=f[0].id,l=l.replace(u._id,""),!t.isNullOrUndefined(w)&&w.hasChildRecords&&(l=="statusEdit"||l=="workEdit")&&(o.readOnly=!0,f.closest("td").css("opacity",.5)),(l=="statusEdit"||l=="statusAdd")&&(o.maxValue=100,o.minValue=0),l=="workEdit"&&(o.change=function(){u._updatedColumn="work";u._editStartDateChange(n(this.element[0]))}),o.value=y&&y.toString().length?parseFloat(y):0,t.isNullOrUndefined(h.editParams)||n.extend(o,h.editParams),f.ejNumericTextbox(o),f.prop("name",f.prop("name").replace(u._id,""));else if(f.hasClass("e-datepicker"))o.width=p,o.cssClass=e.cssClass,o.dateFormat=e.dateFormat,o.locale=e.locale,o.startDay=e.scheduleHeaderSettings.weekStartDay,o.change=function(n){this.option("value",n.value);u._updatedColumn=this.element[0].name;u._editStartDateChange(this.element,n);var t=this.element[0].id;t=t.replace(u._id,"");(t=="startDateEdit"||t=="endDateEdit")&&(u._datePickerChangeEvent=!0)},l=f[0].id,l=l.replace(u._id,""),!t.isNullOrUndefined(w)&&w.hasChildRecords&&w.isAutoSchedule&&(l=="startDateEdit"||l=="endDateEdit")&&r.requestType!=="add"&&(o.readOnly=!0,f.closest("td").css("opacity",.5)),y&&y.toString().length||e.allowUnscheduledTask&&r.requestType=="beginedit"?o.value=u._getDateFromFormat(y):(nt=u._getDateFromFormat(e.scheduleStartDate),h.field=="endDate"&&e.viewType==t.Gantt.ViewType.ResourceView&&nt.setDate(nt.getDate()+1),o.value=nt),h.format!==i&&h.format.length>0&&(gt=new RegExp("\\{0(:([^\\}]+))?\\}","gm"),ti=gt.exec(h.format),o.dateFormat=ti[2],o.value=t.isNullOrUndefined(o.value)?null:t.format(new Date(o.value),o.dateFormat,o.locale),f.val(o.value)),t.isNullOrUndefined(h.editParams)||n.extend(o,h.editParams),f.ejDatePicker(o);else if(f.hasClass("e-datetimepicker"))o={width:p,rtl:e.rtl,locale:e.locale,cssClass:e.css,dateTimeFormat:e.dateFormat,startDay:e.scheduleHeaderSettings.weekStartDay},o.change=function(n){u._updatedColumn=this.element[0].name;this._prevDateTimeVal&&u._editStartDateChange(this.element,n);var t=this.element[0].id;t=t.replace(u._id,"");(t=="startDateEdit"||t=="endDateEdit")&&(u._datePickerChangeEvent=!0)},l=f[0].id,l=l.replace(u._id,""),!t.isNullOrUndefined(w)&&w.hasChildRecords&&w.isAutoSchedule&&w.isAutoSchedule&&(l=="startDate"||l=="endDate")&&r.requestType!=="add"&&(o.readOnly=!0,f.closest("td").css("opacity",.5)),e.viewType==t.Gantt.ViewType.ResourceView&&y.toString().length==0?(nt=u._getDateFromFormat(e.scheduleStartDate),h.field=="endDate"&&nt.setDate(nt.getDate()+1),o.value=nt):o.value=u._getDateFromFormat(y),t.isNullOrUndefined(h.editParams)||n.extend(o,h.editParams),f.ejDateTimePicker(o);else if(f.hasClass("e-dropdownlist"))st=h.dropdownData,h.field==="resourceInfo"?f.ejDropDownList({cssClass:e.cssClass,width:p,showCheckbox:!0,dataSource:st,fields:{id:e.resourceIdMapping,text:e.resourceNameMapping,value:e.resourceNameMapping},selectedItems:r.requestType=="add"?u._getResourceInfoIndex(r.data.resourceInfo,this._resourceCollection):u.getIndexofresourceInfo(st,r.data)}):(c={},c.cssClass=e.cssClass,c.width=p,c.dataSource=st,c.value=y,c.change=function(){u._updateEditDialogFields(this)},t.isNullOrUndefined(h.editParams)||n.extend(c,h.editParams),f.val.length&&(h.field=="taskMode"?(y=r.requestType=="beginedit"?!r.data.isAutoSchedule:e.taskSchedulingMode=="manual"?!0:!1,c.value=y.toString()):h.field=="taskType"?c.value=r.requestType=="beginedit"?r.data.taskType:u.model.taskType:h.field=="effortDriven"&&(c.value=r.requestType=="beginedit"?r.data.effortDriven:e.taskType=="fixedWork"?!0:!1)),r.requestType!="beginedit"||r.data.isAutoSchedule||h.field!="taskType"&&h.field!="effortDriven"||(c.enabled=!1),r.data.taskType=="fixedWork"&&h.field=="effortDriven"&&(c.enabled=!1),r.requestType=="add"&&h.field=="effortDriven"&&e.taskType=="fixedWork"&&(c.enabled=!1),(h.field=="taskType"||h.field=="effortDriven")&&r.data.hasChildRecords&&(c.enabled=!1),h.field=="taskMode"&&e.taskSchedulingMode!=t.Gantt.TaskSchedulingMode.Custom&&(c.enabled=!1),f.val(c.value),f.ejDropDownList(c),ui=f.ejDropDownList("instance"),ui._setValue(f.val()));else if(f.hasClass("e-maskedit"))c={},c.locale=e.locale,c.cssClass=e.cssClass,c.width=p,t.isNullOrUndefined(h.editParams)||n.extend(c,h.editParams),f.ejMaskEdit(c);else switch(f.prop("tagName")){case"INPUT":f.attr("type")!="checkbox"?(f.attr("name")==="taskId"?r.requestType!=="add"?(f.attr("readonly","readonly"),f.css("opacity",.5),f.val(r.data.taskId)):r.requestType==="add"&&(r.data.taskId==""||t.isNullOrUndefined(r.data.taskId)?f.val(at):f.val(r.data.taskId)):f.attr("name")==="taskName"?r.requestType==="add"?r.data.taskName==""||t.isNullOrUndefined(r.data.taskName)?f.val(u._newTaskTexts.newTaskName+" "+at):f.val(r.data.taskName):f.val(r.data.taskName):f.attr("name")==="duration"?(r.data&&f.val(u._getDurationStringValue(r.data)),yt=u._getDurationValues(r.data.duration),pt=t.isNullOrUndefined(yt.durationUnit)?t.isNullOrUndefined(r.data.durationUnit)?e.durationUnit:r.data.durationUnit:yt.durationUnit,r.requestType!=="add"&&r.data.hasChildRecords&&r.data.isAutoSchedule?(f.attr("readonly","readonly"),f.css("opacity",.5)):r.requestType=="add"&&r.data.duration==""?f.val((e.viewType==t.Gantt.ViewType.ResourceView?"1 ":"0 ")+u._durationUnitTexts[pt]):(d=r.data.duration,typeof d=="string"&&(d=parseFloat(d)),d=isNaN(d)?null:d,t.isNullOrUndefined(d)?f.val(""):f.val(parseFloat(d.toFixed(2))+" "+u._durationUnitTexts[pt])),f.change(function(){u._updatedColumn="duration";u._editStartDateChange(n(this))}),f.keyup(function(t){t.keyCode==13&&u._editStartDateChange(n(this))})):f.attr("name")==="WBS"?r.requestType!=="add"?(f.attr("readonly","readonly").css("opacity",.5),f.val(r.data.WBS)):r.requestType==="add"&&(f.val(ri),f.attr("readonly","readonly").css("opacity",.5)):f.attr("name")==="WBSPredecessor"?f.attr("readonly","readonly").css("opacity",.5):f.attr("name")==="serialNumber"&&(r.requestType!=="add"?(f.attr("readonly","readonly").css("opacity",.5),f.val(r.data.serialNumber)):r.requestType==="add"&&(f.val(ni),f.attr("readonly","readonly").css("opacity",.5))),f.attr("name")==="taskName"&&(p=380),l=f[0].id,l=l.replace(u._id,""),f.css("text-align",f.attr("name")!=null&&t.TreeGrid.getColumnByField(vt,f.prop("name"))!=null?t.TreeGrid.getColumnByField(vt,f.attr("name")).textAlign:"center"),f.outerWidth(p)):(c={},c.cssClass=e.cssClass,c.size="medium",t.isNullOrUndefined(h.editParams)||n.extend(o,h.editParams),f.ejCheckBox(c));break;case"SELECT":f.width(p).height(23)}f.is(":disabled")||kt||f.is(":hidden")&&typeof f.data("ejDropDownList")!="object"||u._isEnterKeyPressed||(u._focusElements(f.closest("td")),kt=!0)}if(e.predecessorMapping&&n(k).length&&(rt=[],u._taskNameCollection(),r.requestType!=="add"&&(rt=u._predecessorEditCollection(w),u._getPredecessorDropdownData(rt,r.data)),fi=u._predecessorCollectionText,ei=e.enableSerialNumber?u._columnHeaderTexts.serialNumber:u._columnHeaderTexts.taskId,n(k).ejTreeGrid({dataSource:rt,allowSorting:!1,columns:[{headerText:ei,field:"id",editType:t.TreeGrid.EditingType.Dropdown,dropdownData:u._preTableCollection,width:"89px",editParams:{fields:{text:"value",value:"value"},change:n.proxy(u._preEditDialogChangeEvent,u,k,r.requestType,"id")}},{headerText:u._columnHeaderTexts.taskName,field:"name",editType:t.TreeGrid.EditingType.Dropdown,dropdownData:u._preTableCollection,width:"300px",editParams:{fields:{text:"text",value:"value"},change:n.proxy(u._preEditDialogChangeEvent,u,k,r.requestType,"name"),create:function(){var r=n(k).data("ejTreeGrid"),u=r.model.selectedItem,i,t;u.id==""&&(i=this.model.fields,t=this.model.dataSource[0],t&&n(this.element).attr("data-cellvalue",t[i.value]))}}},{headerText:u._columnHeaderTexts.type,field:"type",editType:t.TreeGrid.EditingType.Dropdown,dropdownData:fi,width:"141px"},{headerText:u._columnHeaderTexts.offset,field:"offset",editType:t.TreeGrid.EditingType.String,width:"88px"}],enableAltRow:!1,allowColumnResize:!0,editSettings:{allowAdding:!0,allowDeleting:!0,allowEditing:!0,editMode:"cellEditing",rowPosition:"bottom",beginEditAction:t.TreeGrid.BeginEditAction.Click},locale:e.locale,endEdit:n.proxy(u._preEndEdit,u,k,r.requestType),beginEdit:n.proxy(u._preBeginEdit,u,k,r),rowSelected:n.proxy(u._enableDisablePredecessorDelete,u,r.requestType),actionBegin:function(n){(n.requestType=="delete"||n.requestType=="sorting")&&(this.model.columns[0].dropdownData=u._preTableCollection,this.model.columns[1].dropdownData=u._preTableCollection)},actionComplete:function(n){n.requestType=="delete"&&(u._enbleDisablePredecessorAddButton("enable",r.requestType),n.model.updatedRecords.length>0?u._enbleDisablePredecessorDeleteButton("enable",r.requestType):u._enbleDisablePredecessorDeleteButton("disable",r.requestType))},treeColumnIndex:5,predecessorTable:u._isFromGantt,sizeSettings:{width:"620px",height:"198px"},isResponsive:!1,cssClass:e.cssClass}),e.selectedItem&&e.selectedItem.hasChildRecords&&r.requestType!=="add"?(u._enbleDisablePredecessorDeleteButton("disable",r.requestType),u._enbleDisablePredecessorAddButton("disable",r.requestType)):r.requestType!=="add"&&u._preTableCollection.length==rt.length?u._enbleDisablePredecessorAddButton("disable",r.requestType):(u._enbleDisablePredecessorDeleteButton("disable",r.requestType),u._enbleDisablePredecessorAddButton("enable",r.requestType))),e.resourceInfoMapping&&n(et).length){var ht=[],ut=this._resourceCollection,oi=n.extend(!0,[],ut);if(r.requestType!="add")for(b=r.data.resourceInfo,g=b?b.length:0,s=0;s<g;s++)ht.push({name:b[s][e.resourceIdMapping],unit:b[s][e.resourceUnitMapping]});else if(r.data.resourceInfo.length!=0)for(ft=new t.Gantt.GanttRecord,ft.item=r.data,si=ut,wt=r.data.resourceInfo,ft.resourceInfo=wt&&ft._setResourceInfo(wt,e.resourceIdMapping,e.resourceNameMapping,e.resourceUnitMapping,si),b=ft.resourceInfo,g=b?b.length:0,s=0;s<g;s++)ht.push({name:b[s][e.resourceIdMapping],unit:b[s][e.resourceUnitMapping]});oi=n.extend(!0,[],ut);n(et).ejTreeGrid({dataSource:ht,columns:[{headerText:u._columnHeaderTexts.resourceInfo,field:"name",width:"309px",editType:t.TreeGrid.EditingType.Dropdown,dropdownData:oi,editParams:{fields:{text:e.resourceNameMapping,value:e.resourceIdMapping},create:function(){var r=n(et).data("ejTreeGrid"),u=r.model.selectedItem,i,t;u.name==""&&(i=this.model.fields,t=this.model.dataSource[0],t&&n(this.element).attr("data-cellvalue",t[i.value]))}}},{headerText:u._columnHeaderTexts.unit,field:"unit",width:"309px",editType:t.TreeGrid.EditingType.Numeric,visible:e.viewType==t.Gantt.ViewType.ResourceView?!1:!0,headerTextAlign:"center"}],enableAltRow:!1,allowColumnResize:!0,editSettings:{allowAdding:!0,allowDeleting:!0,allowEditing:!0,editMode:"cellEditing",beginEditAction:t.TreeGrid.BeginEditAction.Click},locale:e.locale,beginEdit:n.proxy(u._resourceBeginEdit,u,et,r.requestType),rowSelected:n.proxy(u._enableDisableResouceDelete,u,r.requestType),actionBegin:function(t){(t.requestType=="delete"||t.requestType=="sorting")&&(this.model.columns[0].dropdownData=n.extend(!0,[],ut))},actionComplete:function(n){n.requestType=="delete"&&(u.enbleDisableAddResourceButton("enable",r.requestType),n.model.updatedRecords.length>0?u.enbleDisableDeleteResourceButton("enable",r.requestType):u.enbleDisableDeleteResourceButton("disable",r.requestType))},treeColumnIndex:3,resourceTable:u._isFromGantt,sizeSettings:{width:"620px",height:"198px"},isResponsive:!1,cssClass:e.cssClass});r.requestType!=="add"&&ht.length==ut.length?(u.enbleDisableDeleteResourceButton("enable",r.requestType),u.enbleDisableAddResourceButton("disable",r.requestType)):(u.enbleDisableDeleteResourceButton("disable",r.requestType),u.enbleDisableAddResourceButton("enable",r.requestType))}if(n(ot).length){if(r.requestType=="add"){var a=u._addDialogCustomColumns,bt=[],ct=0,g=a.length;for(s=0;s<g;s++)ct++,v={},v.id=ct,v.field=a[s].field,v.headerText=a[s].headerText,v.value=r.data[a[s].field],v.text=r.data[a[s].field],v.editType=a[s].editType?a[s].editType.toLowerCase():"stringedit",bt.push(v)}else{var a=u._editDialogCustomColumns,bt=[],ct=0,g=a.length;for(s=0;s<g;s++)ct++,v={},v.id=ct,v.field=a[s].field,v.headerText=a[s].headerText,v.value=r.data[a[s].field],v.editType=a[s].editType?a[s].editType.toLowerCase():"stringedit",v.text=a[s].editType.toLowerCase()=="dropdownedit"?t.isNullOrUndefined(r.data[a[s].field])?"":u._getDropDownText(a[s],r.data[a[s].field]):r.data[a[s].field],bt.push(v)}n(ot).ejTreeGrid({dataSource:bt,allowSorting:!1,locale:e.locale,enableAltRow:!1,rowHeight:30,columns:[{headerText:u._columnHeaderTexts.dialogCustomFieldName,field:"headerText",allowEditing:!1},{headerText:"Original Value",field:"value",visible:!1},{headerText:"Field",field:"field",visible:!1},{headerText:u._columnHeaderTexts.dialogCustomFieldValue,field:"text",editTemplate:{create:function(){return"<input style='width:100%;'>"},read:n.proxy(u._customColumnRead,u,ot),write:n.proxy(u._customColumnWrite,u,a,ot)}}],allowColumnResize:!0,editSettings:{allowAdding:!0,allowDeleting:!0,allowEditing:!0,editMode:"cellEditing",beginEditAction:t.TreeGrid.BeginEditAction.Click},sizeSettings:{width:"620px",height:"234px"},isResponsive:!1,cssClass:e.cssClass})}e.notesMapping&&n(it).length&&(r.requestType=="add"?y=r.data.notes:(hi=r.data.item[e.notesMapping],y=hi),n(it).ejRTE({width:"620px",isResponsive:!1,height:"281px",value:y,locale:e.locale,cssClass:e.cssClass,tools:{font:["fontName","fontSize","fontColor","backgroundColor"],style:["bold","italic","underline","strikethrough"],alignment:["justifyLeft","justifyCenter","justifyRight","justifyFull"],doAction:["undo","redo"],indenting:[],clear:[],links:["createLink","removeLink"],images:[],media:[],tables:[],lists:["unorderedList"],clipboard:[],edit:[],formatStyle:[],view:[]}}),n(it+"_wrapper").find(".e-toolbar.e-toolbarspan").css("border-bottom","none"),n(it+"_editor").height("208"),n(it+"_Iframe")[0].style.height="203px",n(li).removeClass("e-rte"))},_enbleDisablePredecessorDeleteButton:function(t,i){var r=this,u;u=i=="add"?n("#"+r._id+"AddDialog_PredecesorDelete"):n("#"+r._id+"EditDialog_PredecesorDelete");t==="enable"?(n(u).unbind("click",n.proxy(r._deletepredecessor,r)).bind("click",n.proxy(r._deletepredecessor,r)),n(u).addClass("e-enable").removeClass("e-disable")):(n(u).unbind("click",n.proxy(r._deletepredecessor,r)),n(u).addClass("e-disable").removeClass("e-enable"))},_enbleDisablePredecessorAddButton:function(t,i){var r=this,u="";u=i=="add"?n("#"+r._id+"AddDialog_PredecesorAdd"):n("#"+r._id+"EditDialog_PredecesorAdd");t==="enable"?(n(u).unbind("click",n.proxy(r._addpredecessor,r)).bind("click",n.proxy(r._addpredecessor,r)),n(u).addClass("e-enable").removeClass("e-disable")):(n(u).unbind("click",n.proxy(r._addpredecessor,r)),n(u).addClass("e-disable").removeClass("e-enable"))},_disablePredecessorAddButton:function(t,i){var f=this,e=n(t+"e-table"),o=!1,s=e[0].rows.length,r,u;for(f._enbleDisablePredecessorAddButton("disable",i),r=0;r<s;r++)u=e[0].rows[r],u.cells.length===4&&u.cells[1].innerText===""&&(o=!0);o||f._enbleDisablePredecessorAddButton("enable",i)},_updateEditDialogFields:function(i){var f=this,u,r,e=n(i.element).attr("data-dialog");e=="Add"?(r=n("#"+f._id+"effortDrivenAdd").data("ejDropDownList"),u=n("#"+f._id+"taskTypeAdd").data("ejDropDownList")):(r=n("#"+f._id+"effortDrivenEdit").data("ejDropDownList"),u=n("#"+f._id+"taskTypeEdit").data("ejDropDownList"));t.isNullOrUndefined(r)||i._name!="taskType"||(i.model.value=="fixedWork"?(r.selectItemByValue("true"),r.disable()):r.enable(),f._editedDialogRecord[i._name]=i.model.value);i._name=="taskMode"&&(i.model.text=="Auto"&&(t.isNullOrUndefined(r)||t.isNullOrUndefined(u)||u.model.value=="fixedWork"||r.enable(),t.isNullOrUndefined(u)||u.enable(),f._editedDialogRecord.isAutoSchedule=!0),i.model.text=="Manual"&&(t.isNullOrUndefined(r)||r.disable(),t.isNullOrUndefined(u)||u.disable(),f._editedDialogRecord.isAutoSchedule=!1))},_customColumnWrite:function(t,r,u){var e=this,o=u.rowdata!==i?u.rowdata.text:"",s=n(r).ejTreeGrid("instance").model,h=t[s.selectedRowIndex],f={},c,l;h.editParams&&(f=n.extend(!0,{},h.editParams));f.value=o;f.locale=e.model.locale;switch(u.rowdata.editType.toLowerCase()){case"numericedit":f.height="25px";u.element.ejNumericTextbox(f);break;case"stringedit":n(u.element).val(o).css({padding:"0px",border:"0px",height:"25px"}).addClass("e-ejinputtext");break;case"datepicker":f.width="100%";f.height="25px";f.startDay=e.model.scheduleHeaderSettings.weekStartDay;u.element.ejDatePicker(f);break;case"datetimepicker":f.width="100%";f.height="25px";f.startDay=e.model.scheduleHeaderSettings.weekStartDay;u.element.ejDateTimePicker(f);break;case"maskedit":f.width="100%";f.height="25px";u.element.ejMaskEdit(f);break;case"dropdownedit":f.width="100%";f.height="25px";f.dataSource=h.dropdownData;f.value=s.currentViewData[s.selectedRowIndex].value;u.element.ejDropDownList(f);break;case"booleanedit":f.cssClass=e.model.cssClass;f.size="small";f.checked=o;u.element.ejCheckBox(f);c=u.element.parent(".e-chkbox-wrap");l=c.parent("form");l.length>0?l.css("margin-left","45%"):c.css("margin-left","45%")}},_customColumnRead:function(i,r){var f,u,s=n(i).ejTreeGrid("instance"),e=s.model.selectedRowIndex,o=s.model.updatedRecords;return n(r).blur(),n(r).focusout(),n(r[0]).hasClass("e-numerictextbox")?f=u=n(r).ejNumericTextbox("getValue"):n(r[0]).hasClass("e-datepicker")?f=u=n(r).ejDatePicker("getValue"):n(r[0]).hasClass("e-datepicker")?f=u=n(r).ejDatePicker("getValue"):n(r[0]).hasClass("e-dattimeepicker")?f=u=n(r).ejDateTimePicker("getValue"):n(r[0]).hasClass("e-maskedit")?f=u=n(r[0]).ejMaskEdit("model.value"):n(r[0]).hasClass("e-dropdownlist")?(u=n(r[0]).ejDropDownList("model.text"),f=n(r[0]).ejDropDownList("model.showCheckbox")==!1&&n(r[0]).ejDropDownList("model.multiSelectMode")==t.MultiSelectMode.None?n(r[0]).ejDropDownList("model.itemValue"):n(r[0]).ejDropDownList("getSelectedValue")):f=n(r[0]).hasClass("e-checkbox")?u=n(r[0]).ejCheckBox("isChecked"):u=n(r).val(),o[e].value=o[e].item.value=f,o[e].text=o[e].item.text=u,s.refreshRow(e),u},_enableDisableResourceAddButton:function(t,i,r){var u=this,f=t.model.dataSource,e=!1,o;u.enbleDisableAddResourceButton("disable",r);i&&(o=n.map(f,function(n,t){if(n.name==""||n.name==null)return t}),o.length>0&&f.length>0&&(e=!0),e||u.enbleDisableAddResourceButton("enable",r))},_addpredecessor:function(t){var u=this,f,i,r;f=n(t.target).hasClass("e-edit-dialog")?"#treegrid"+u._id+"predecessorEdit":"#treegrid"+u._id+"predecessorAdd";i=n(f).ejTreeGrid("instance");r=i.model;i.saveCell();i.clearSelection(r.selectedRowIndex);i.addRow({id:"",name:"",type:"Finish-Start",offset:"0"},"bottom");i.cellEdit(r.selectedRowIndex,r.columns[1].field)},_deletepredecessor:function(i){var o=this,s,h,f,e;s=n(i.target).hasClass("e-edit-dialog")?"#treegrid"+o._id+"predecessorEdit":"#treegrid"+o._id+"predecessorAdd";var r=n(s).data("ejTreeGrid"),h=r.model,u=r.selectedRowIndex();({}).requestType=t.TreeGrid.Actions.Delete;u!==-1&&(r.deleteRow(),f=h.updatedRecords.length,e=f>u?u:f-1,e>-1&&r.selectRows(e))},enbleDisableDeleteResourceButton:function(t,i){var r=this,u;u=i=="add"?n("#"+r._id+"AddDialog_ResourceDelete"):n("#"+r._id+"EditDialog_ResourceDelete");t==="enable"?(n(u).unbind("click",n.proxy(r._deleteResource,r)).bind("click",n.proxy(r._deleteResource,r)),n(u).addClass("e-enable").removeClass("e-disable")):(n(u).unbind("click",n.proxy(r._deleteResource,r)),n(u).addClass("e-disable").removeClass("e-enable"))},enbleDisableAddResourceButton:function(t,i){var r=this,u;u=i=="add"?n("#"+r._id+"AddDialog_ResourceAdd"):n("#"+r._id+"EditDialog_ResourceAdd");t==="enable"?(n(u).unbind("click",n.proxy(r._addResource,r)).bind("click",n.proxy(r._addResource,r)),n(u).addClass("e-enable").removeClass("e-disable")):(n(u).unbind("click",n.proxy(r._addResource,r)),n(u).addClass("e-disable").removeClass("e-enable"))},_addResource:function(t){var u=this,f,i,r;f=n(t.target).hasClass("e-edit-dialog")?"#treegrid"+u._id+"resourceEdit":"#treegrid"+u._id+"resourceAdd";i=n(f).ejTreeGrid("instance");r=i.model;i.saveCell();i.clearSelection(r.selectedRowIndex);i.addRow({name:"",unit:100},"bottom");i.cellEdit(r.selectedRowIndex,r.columns[0].field)},_deleteResource:function(i){var o=this,s,f,e;s=n(i.target).hasClass("e-edit-dialog")?"#treegrid"+o._id+"resourceEdit":"#treegrid"+o._id+"resourceAdd";var r=n(s).data("ejTreeGrid"),h=r.model,u=r.selectedRowIndex();({}).requestType=t.TreeGrid.Actions.Delete;u!==-1&&(r.deleteRow(),f=h.updatedRecords.length,e=f>u?u:f-1,e>-1&&r.selectRows(e))},_resourceBeginEdit:function(t,i,r){for(var h,o=this,c=o.model.resourceIdMapping,s=r.model,l=s.columns,a=this._resourceCollection,f=l[0].dropdownData=n.extend(!0,[],a),e=s.dataSource,v=e.length,y=r.data.item.name,u=0;u<v;u++)y!=e[u].name&&(h=n.map(f,function(n,t){if(n[c].toString()==e[u].name)return t}),f.splice(h[0],1));f.length<=1&&o.enbleDisableAddResourceButton("disable",i)},getColumnIndexByField:function(n){var r=this,i=r.model.columns,u=i.length,t=0;for(t;t<u;t++)if(i[t].field==n)break;return t},getIndexofresourceInfo:function(n,t){var r=t.resourceInfo,i=0,f=r?r.length:0,u=[];for(i;i<f;i++)n.indexOf(r[i])!=-1&&u.push(n.indexOf(r[i]));return u},_focusElements:function(n){if(n.length){n.focus();var t=n.children();t[0].tagName.toLowerCase()=="select"||t[0].tagName.toLowerCase()=="input"?(t.focus().select(),t[0].focus()):t.find(".e-field.e-dropdownlist").length?t.find(".e-ddl").focus():t.find("input,select").select().focus()}},renderDiaglogButton:function(n,i){var e,r=this,u=r.model,o,l,a,s,v,h,f,c;return e=n=="edit"?"EditDialog_":"AddDialog_",o=t.buildTag("input","",{"border-radius":"3px","min-width":"70px"},{type:"button",id:e+r._id+"_Save"}),l=n=="edit"?r._editDialogTexts.saveButton:r._editDialogTexts.addButton,o.ejButton({cssClass:u.cssClass,text:l,width:"auto"}),a=r._editDialogTexts.cancelButton,s=t.buildTag("input","",{"margin-left":"18px","border-radius":"3px","min-width":"70px"},{type:"button",id:e+r._id+"_Cancel"}),s.ejButton({cssClass:u.cssClass,text:a,width:"auto"}),v=r._editDialogTexts.deleteButton,h=t.buildTag("input","",{"border-radius":"3px","min-width":"90px"},{type:"button",id:"EditDialog_"+r._id+"_Delete"}),h.ejButton({cssClass:u.cssClass,text:v,width:"auto"}),f=t.buildTag("div","",{float:"right","z-index":"10"},{"class":"e-editform-btn e-editfrom-btn-right"}),c=t.buildTag("div","",{float:"left","z-index":"10"},{"class":"e-editform-btn e-editfrom-btn-left"}),f.append(o),n=="edit"&&u.editSettings.allowDeleting&&c.append(h),f.append(s),f.appendTo(i),c.appendTo(i),i},_renderToolBar:function(){var i=this,u=i.model,f=t.buildTag("div.e-gantttoolbar#e-gantttoolbar"+i._id,"",{height:"50px"},{id:i._id+"_toolbarItems"}),e,o,s,h,r;return!t.isNullOrUndefined(u.toolbarSettings.toolbarItems)&&u.toolbarSettings.toolbarItems.length&&(e=t.buildTag("ul","",{},{}),i._renderLi(e),f.append(e)),!t.isNullOrUndefined(u.toolbarSettings.customToolbarItems)&&u.toolbarSettings.customToolbarItems.length&&(o=t.buildTag("ul","",{},{}),i._renderCustomLi(o),f.append(o)),u.toolbarSettings.toolbarItems.indexOf(t.Gantt.ToolbarItems.Search)!=-1&&(s=t.buildTag("ul.e-gantt-search-container","",{float:"right"},{}),h=t.buildTag("li","",{},{id:i._id+"_"+t.Gantt.ToolbarItems.Search,tabindex:"0"}),i._renderLiContent(h,t.Gantt.ToolbarItems.Search),s.append(h),f.append(s)),r={},r.click=i._toolBarClick,r.cssClass=u.cssClass,r.rtl=!1,r.itemSeparator=!1,r.width=i._ganttWidth,r.fields={id:"",tooltipText:"",imageUrl:"",text:"",imageAttributes:"",spriteCSS:"",htmlAttributes:""},f.ejToolbar(r),f.ejToolbar("disableItem",i._disabledToolItems),i._disabledToolItems=n(),f},_renderCustomLi:function(i){for(var e,o=this,h=o.model,f,s,u=h.toolbarSettings.customToolbarItems,r=0;r<u.length;r++)(u[r].text||u[r].templateID)&&(u[r].text?(e=u[r].tooltipText?u[r].tooltipText:u[r].text,f=t.buildTag("li","",{},{id:o._id+"_"+u[r].text,title:e}),s=t.buildTag("a.e-toolbaricons e-icon e-ganttcustomtoolbaritem","",{}).addClass(u[r].text),f.addClass("e-gantttoolbaritem")):(e=u[r].tooltipText?u[r].tooltipText:u[r].templateID.replace("#",""),f=t.buildTag("li","",{},{id:o._id+"_"+u[r].templateID.replace("#",""),title:e}),s=n(u[r].templateID).hide().html()),f.html(s),i.append(f))},_updateToolbarItems:function(){var n=this.model.toolbarSettings.toolbarItems;n.indexOf("edit")!=-1&&n.splice(n.indexOf("edit"),1);n.indexOf("indent")!=-1&&n.splice(n.indexOf("indent"),1);n.indexOf("outdent")!=-1&&n.splice(n.indexOf("outdent"),1);n.indexOf("excelExport")!=-1&&n.splice(n.indexOf("excelExport"),1);n.indexOf("pdfExport")!=-1&&n.splice(n.indexOf("pdfExport"),1);n.indexOf("criticalPath")!=-1&&n.splice(n.indexOf("criticalPath"),1)},_renderLi:function(n){var r=this,u=r.model.toolbarSettings.toolbarItems,e,i=0,f;for(this.model.viewType=="resourceView"&&r._updateToolbarItems(),e=u.length,i;i<e;i++)f=t.buildTag("li","",{},{id:r._id+"_"+u[i],tabindex:"0"}),u[i]!=="search"&&(f.addClass("e-gantttoolbaritem"),r._renderLiContent(f,u[i]),n.append(f))},_renderLiContent:function(i,r){var e,u,o=this.model.selectionMode,f=this.selectedRowIndex(),it=this.model.editSettings,h,c,l,a,v,y,p,w,b,k,d,g,s,nt,tt;switch(r){case"add":e=t.buildTag("a.e-addnewitem e-toolbaricons e-icon e-gantt-add","",{});h=this._toolboxTooltipTexts.addTool;i.attr("title",h);this.model.readOnly!=!0&&this.model.editSettings.allowAdding||this._disabledToolItems.push(i.get(0));break;case"edit":e=t.buildTag("a.e-edititem e-toolbaricons e-icon e-gantt-edit","",{});c=this._toolboxTooltipTexts.editTool;i.attr("title",c);this.model.readOnly!=!0&&this.model.allowSelection&&this.model.editSettings.allowEditing&&f!=-1&&(f==-1||o!="cell")&&this.model.editSettings.beginEditAction!="click"||this._disabledToolItems.push(i.get(0));break;case"delete":l=this._toolboxTooltipTexts.deleteTool;i.attr("title",l);e=t.buildTag("a.e-deleteitem e-toolbaricons e-icon e-gantt-delete","",{});this.model.readOnly!=!0&&this.model.allowSelection&&this.model.editSettings.allowDeleting&&f!=-1&&(f==-1||o!="cell")||this._disabledToolItems.push(i.get(0));break;case"update":a=this._toolboxTooltipTexts.saveTool;i.attr("title",a);e=t.buildTag("a.e-saveitem e-toolbaricons e-icon e-gantt-save e-disabletool","",{});this._disabledToolItems.push(i.get(0));break;case"cancel":v=this._toolboxTooltipTexts.cancelTool;i.attr("title",v);e=t.buildTag("a.e-cancel e-toolbaricons e-icon e-gantt-cancel e-disabletool","",{});this._disabledToolItems.push(i.get(0));break;case"indent":y=this._toolboxTooltipTexts.indentTool;i.attr("title",y);u=t.buildTag("a.e-indent e-toolbaricons e-icon e-disabletool e-gantt-indent","",{},{});i.append(u);this.model.readOnly!=!0&&this.model.allowSelection&&this.model.editSettings.allowIndent&&f!=-1&&(f==-1||o!="cell")||this._disabledToolItems.push(i.get(0));break;case"outdent":p=this._toolboxTooltipTexts.outdentTool;i.attr("title",p);u=t.buildTag("a.e-outdent e-toolbaricons e-icon e-disabletool e-gantt-outdent","",{},{});i.append(u);this.model.readOnly!=!0&&this.model.allowSelection&&this.model.editSettings.allowIndent&&f!=-1&&(f==-1||o!="cell")||this._disabledToolItems.push(i.get(0));break;case"expandAll":w=this._toolboxTooltipTexts.expandAllTool;i.attr("title",w);u=t.buildTag("a.e-expandall e-toolbaricons e-icon e-gantt-expandall","",{},{});i.append(u);break;case"collapseAll":b=this._toolboxTooltipTexts.collapseAllTool;i.attr("title",b);u=t.buildTag("a.e-collapseall e-toolbaricons e-icon e-gantt-collapseall","",{},{});i.append(u);break;case"prevTimeSpan":k=this._toolboxTooltipTexts.prevTimeSpanTool;i.attr("title",k);u=t.buildTag("a.e-prevtimespan e-toolbaricons e-icon e-gantt-prevtimespan","",{},{});i.append(u);break;case"nextTimeSpan":d=this._toolboxTooltipTexts.nextTimeSpanTool;i.attr("title",d);u=t.buildTag("a.e-nexttimespan e-toolbaricons e-icon e-gantt-nexttimespan","",{},{});i.append(u);break;case"criticalPath":g=this._toolboxTooltipTexts.criticalPathTool;i.attr("title",g);u=t.buildTag("a.e-criticaltask e-toolbaricons e-icon e-gantt-criticaltask","",{},{});i.append(u);break;case"search":s=this._toolboxTooltipTexts.searchTool;u=t.buildTag("input.e-ejinputtext","",{margin:"4px","text-indent":"4px",width:"auto",padding:"1px 4px 1px 0px"},{type:"text",placeholder:s},{color:"#E8E9E9"});i.css({float:"right",padding:"2px"});i.attr("title",s);i.addClass("e-search");i.append(u);u.keydown(n.proxy(this._keyDown,this));break;case"excelExport":nt=this._toolboxTooltipTexts.excelExportTool;i.attr("title",nt);u=t.buildTag("a.e-excelIcon e-toolbaricons e-icon e-gantt-excelexport","",{},{});i.append(u);break;case"pdfExport":tt=this._toolboxTooltipTexts.pdfExportTool;i.attr("title",tt);u=t.buildTag("a.e-pdfIcon e-toolbaricons e-icon","",{},{});i.append(u)}i.append(e)},_keyDown:function(n){if(n.which===13)return this._toolbarOperation(this._id+"_search",n.currentTarget.value),n.preventDefault(),!1},_updateToolbarOptions:function(){var v=this,e=v.model,o=e.editSettings,i=n("#"+v._id+"_toolbarItems"),f=n(i).find(".e-addnewitem").parent()[0],r=n(i).find(".e-edititem").parent()[0],u=n(i).find(".e-deleteitem").parent()[0],s=n(i).find(".e-indent").parent()[0],h=n(i).find(".e-outdent").parent()[0],c=n(i).find(".e-saveitem").parent()[0],l=n(i).find(".e-cancel").parent()[0],t=[],a=[];e.readOnly==!0?(f&&t.push(n(f)),r&&t.push(n(r)),u&&t.push(n(u)),s&&t.push(n(s)),h&&t.push(n(h)),c&&t.push(n(c)),l&&t.push(n(l)),n(i).ejToolbar("disableItem",t)):(o.allowAdding?f&&a.push(f):f&&t.push(n(f)),e.selectedItem?(o.allowEditing&&e.editSettings.beginEditAction!="click"?r&&a.push(r):r&&t.push(n(r)),o.allowDeleting?u&&a.push(u):u&&t.push(n(u)),v.updateIndentOutdentOption(e.selectedItem)):(o.allowEditing&&r&&t.push(n(r)),o.allowDeleting&&u&&t.push(n(u)),c&&c&&t.push(n(c)),l&&l&&t.push(n(l)),s&&s&&t.push(n(s)),h&&h&&t.push(n(h))),n(i).ejToolbar("disableItem",t),n(i).ejToolbar("enableItem",a))},_renderGantt:function(){var r=this,v=r.model,i,h,u=parseInt(r._ganttWidth),e=r.splitterPosition(),s=!1,o,c=v.splitterSettings.index,f;if(e||(e=r._splitterPosition(),r.splitterPosition(e)),e||c>-1){if(e)typeof e=="string"&&e.indexOf("%")!=-1?(i=parseInt(e),s=!0):(i=parseInt(e)/u*100,s=!1);else{var y=r.getColumns(),o=0,a=c,l=y.filter(function(n){return n.visible!=!1});for(a>=l.length&&(a=l.length-1),f=0;f<=a;f++)o+=l[f].width;if(o<=u)i=parseInt(o)/u*100,c=f-1;else for(o=0,f=0;f<=a;f++)if(o+l[f].width<=u)o+=l[f].width,c=f;else{i=parseInt(o)/u*100;break}v.splitterSettings.index=c}(isNaN(i)||i<0)&&(i=0);i>100&&(i=(2*r._commonColumnWidth+3)/u*100,i=i<30?i:30,s=!0)}else i=(2*r._commonColumnWidth+3)/u*100,i=i<30?i:30,s=!0;h=100-i-900/u;h<=0?(s?r.splitterPosition("100%"):r.splitterPosition(u.toString()),i=100-900/u,h=0):h>0&&(s?r.splitterPosition(Math.round(i)+"%"):r.splitterPosition(Math.round(i*u/100).toString()));r._splitterPosition(r.splitterPosition());n("#e-ejSpliter"+r._id).ejSplitter({height:r._ganttHeight,width:u,orientation:t.Orientation.Horizontal,properties:[{paneSize:i+"%",collapsible:!1},{paneSize:h+"%",collapsible:!1}],enableAutoResize:!1,resize:n.proxy(r._onResize,r),cssClass:v.cssClass})},_renderTreeGrid:function(){var t=this,n=t.model;t._$treegridHelper.ejTreeGrid({enableAltRow:n.enableAltRow,allowColumnResize:n.allowColumnResize,enableVirtualization:n.enableVirtualization,allowSorting:n.allowSorting,showColumnChooser:n.showColumnChooser,showColumnOptions:n.showColumnOptions,allowMultiSorting:n.allowMultiSorting,sortSettings:n.sortSettings,filterSettings:n.filterSettings,allowSelection:n.allowSelection,selectionType:n.selectionType,selectionMode:n.selectionMode,selectedRowIndex:this.selectedRowIndex(),allowDragAndDrop:n.viewType=="projectView"?n.allowDragAndDrop:!1,dragTooltip:n.dragTooltip,allowSearching:n.allowSearching,parentIdMapping:n.parentTaskIdMapping,baselineStartDateMapping:n.baselineStartDateMapping,baselineEndDateMapping:n.baselineEndDateMapping,allowKeyboardNavigation:n.allowKeyboardNavigation,cssClass:n.cssClass,locale:n.locale,columns:t.getColumns(),editSettings:n.editSettings,toolbarSettings:n.toolbarSettings,rowTemplate:n.rowTemplate,rowDataBound:n.rowDataBound,queryCellInfo:n.queryCellInfo,cellSelecting:n.cellSelecting,cellSelected:n.cellSelected,selectedCellIndexes:this.selectedCellIndexes(),dataSource:this.dataSource(),flatRecords:n.flatRecords,parentRecords:n.parentRecords,ids:t.model.ids,dateFormat:n.dateFormat,resourceInfoMapping:n.resourceInfoMapping,resourceNameMapping:n.resourceNameMapping,resourceIdMapping:n.resourceIdMapping,resourceUnitMapping:n.resourceUnitMapping,idMapping:n.taskIdMapping,readOnly:n.readOnly,notesMapping:n.notesMapping,showGridCellTooltip:n.showGridCellTooltip,cellTooltipTemplate:n.cellTooltipTemplate,showGridExpandCellTooltip:n.showGridExpandCellTooltip,taskNameMapping:n.taskNameMapping,taskSchedulingModeMapping:n.taskSchedulingModeMapping,startDateMapping:n.startDateMapping,endDateMapping:n.endDateMapping,childMapping:n.childMapping,durationMapping:n.durationMapping,durationUnitMapping:n.durationUnitMapping,durationUnit:n.durationUnit,progressMapping:n.progressMapping,predecessorMapping:n.predecessorMapping,rowHeight:n.rowHeight,emptyRecordText:t._emptyRecordText,isFromGantt:t._isFromGantt,treeColumnIndex:n.treeColumnIndex,workingTimeScale:n.workingTimeScale,enableWBS:n.enableWBS,enableWBSPredecessor:n.enableWBSPredecessor,columnMenuTexts:t._columnMenuTexts,editTypeText:t._editTypeText,clipModeText:t._clipModeText,textAlignTypeText:t._textAlignTypeText,columnDialogTitle:t._columnDialogTitle,deleteColumnText:t._deleteColumnText,okButtonText:t._okButtonText,cancelButtonText:t._cancelButtonText,confirmDeleteText:t._confirmDeleteText,columnDialogFields:n.columnDialogFields,columnDialogTexts:t._columnDialogTexts,enableSerialNumber:n.enableSerialNumber,workMapping:n.workMapping,workUnit:t._workUnitTexts[n.workUnit],taskTypeTexts:t._taskTypeTexts,effortDrivenTexts:t._effortDrivenTexts,dataManagerUpdate:{isDataManagerUpdate:t._isDataManagerUpdate,jsonData:[]},durationUnitEditText:this._durationUnitEditText,durationUnitTexts:t._durationUnitTexts,enableCollapseAll:n.enableCollapseAll,weekStartDay:n.scheduleHeaderSettings.weekStartDay,indentLevelWidth:this.indentLevelWidth,ganttElement:this.element,groupNameMapping:n.groupNameMapping,viewType:n.viewType,nullText:t._nullText,allowUnscheduledTask:n.allowUnscheduledTask})},_renderGanttChart:function(){var t=this,n=this.model;t._$ganttchartHelper.ejGanttChart({dataSource:this.dataSource(),scheduleStartDate:n.scheduleStartDate,scheduleEndDate:n.scheduleEndDate,startDateMapping:n.startDateMapping,endDateMapping:n.endDateMapping,taskNameMapping:n.taskNameMapping,taskIdMapping:n.taskIdMapping,progressMapping:n.progressMapping,durationMapping:n.durationMapping,childPropertyName:n.childMapping,predecessorMapping:n.predecessorMapping,enableVirtualization:n.enableVirtualization,highlightWeekends:n.highlightWeekends,allowDragAndDrop:n.allowDragAndDrop,milestoneMapping:n.milestoneMapping,perDayWidth:t._perDayWidth,workingTimeScale:n.workingTimeScale,roundOffDayworkingTime:n.roundOffDayworkingTime,durationUnit:n.durationUnit,isCriticalPathEnable:this.isCriticalPathEnable,criticalPathCollection:this.criticalPathCollection,perMonthWidth:t._perMonthWidth,perWeekWidth:t._perWeekWidth,perHourWidth:t._perHourWidth,perMinuteWidth:t._perMinuteWidth,perTopHourWidth:t._perTopHourWidth,minuteInterval:t._minuteInterval,includeWeekend:n.includeWeekend,connectorlineWidth:n.connectorlineWidth,workingTimeRanges:t._workingTimeRanges,secondsPerDay:t._secondsPerDay,scheduleHeaderSettings:n.scheduleHeaderSettings,taskbarBackground:n.taskbarBackground,progressbarBackground:n.progressbarBackground,connectorLineBackground:n.connectorLineBackground,parentTaskbarBackground:n.parentTaskbarBackground,parentProgressbarBackground:n.parentProgressbarBackground,holidays:n.holidays,dateFormat:n.dateFormat,locale:n.locale,_durationUnitEditText:this._durationUnitEditText,enableTaskbarTooltip:n.enableTaskbarTooltip,enableTaskbarDragTooltip:n.enableTaskbarDragTooltip,flatRecords:n.flatRecords,parentRecords:n.parentRecords,scheduleWeeks:t._scheduleWeeks,projectStartDate:t._projectStartDate,projectEndDate:t._projectEndDate,scheduleYears:t._scheduleYears,scheduleMonths:t._scheduleMonths,scheduleDays:t._scheduleDays,scheduleHours:t._scheduleHours,progressbarHeight:n.progressbarHeight,tooltipTemplate:n.taskbarTooltipTemplate,tooltipTemplateId:n.taskbarTooltipTemplateId,progressbarTooltipTemplate:n.progressbarTooltipTemplate,progressbarTooltipTemplateId:n.progressbarTooltipTemplateId,queryTaskbarInfo:n.queryTaskbarInfo,readOnly:n.readOnly,showTaskNames:n.showTaskNames,leftTaskLabelMapping:n.leftTaskLabelMapping,rightTaskLabelMapping:n.rightTaskLabelMapping,leftTaskLabelTemplate:n.leftTaskLabelTemplate,rightTaskLabelTemplate:n.rightTaskLabelTemplate,showProgressStatus:n.showProgressStatus,showResourceNames:n.showResourceNames,resourceInfoMapping:n.resourceInfoMapping,resourceNameMapping:n.resourceNameMapping,resourceUnitMapping:n.resourceUnitMapping,enableProgressBarResizing:n.enableProgressBarResizing,allowGanttChartEditing:n.allowGanttChartEditing,taskbarEditingTooltipTemplateId:n.taskbarEditingTooltipTemplateId,taskbarEditingTooltipTemplate:n.taskbarEditingTooltipTemplate,ids:t.model.ids,stripLines:n.stripLines,_predecessorCollection:t._predecessorsCollection,_columns:t._columns,_nonWorkingTimeRange:t._nonWorkingTimeRanges,nonWorkingBackground:n.nonWorkingBackground,highlightNonWorkingTime:n.highlightNonWorkingTime,weekendBackground:n.weekendBackground,allowKeyboardNavigation:n.allowKeyboardNavigation,updatedRecords:t.model.updatedRecords,renderBaseline:n.renderBaseline,baselineColor:n.baselineColor,editSettings:n.editSettings,columnHeaderTexts:t._columnHeaderTexts,durationUnitTexts:t._durationUnitTexts,predecessorEditingTexts:t._predecessorEditingTexts,localizedDays:t._days,localizedMonths:t._months,rowHeight:n.rowHeight,allowSelection:n.allowSelection,selectionMode:n.selectionMode,selectionType:n.selectionType,taskbarTemplate:n.taskbarTemplate,parentTaskbarTemplate:n.parentTaskbarTemplate,milestoneTemplate:n.milestoneTemplate,durationUnitEditText:this._durationUnitEditText,taskbarClick:n.taskbarClick,predecessorText:t._getPredecessorText(),taskbarHeight:t.taskbarHeight,cssClass:n.cssClass,workWeek:n.workWeek,viewType:n.viewType,resourceIdMapping:n.resourceIdMapping,ganttInstance:t,enableSerialNumber:n.enableSerialNumber,predecessorCollectionText:t._predecessorCollectionText,predecessorTooltipTemplate:n.predecessorTooltipTemplate,connectorLineDialogText:t._connectorLineDialogText,allowUnscheduledTask:n.allowUnscheduledTask})},_getPredecessorText:function(){var n=this._predecessorCollectionText[1],t={};return n=n.value.split("-"),t.Start=n[0],t.Finish=n[1],t},_updateColumnDropDownData:function(){for(var n=this,r=n.model,i=r.columns,u=i.length,t=0;t<u;t++)i[t].field=="taskMode"&&(i[t].dropdownData=[{id:1,text:n._taskModeTexts.manual,value:"true"},{id:2,text:n._taskModeTexts.auto,value:"false"}]),i[t].field=="taskType"&&(i[t].dropdownData=[{id:1,text:n._taskTypeTexts.fixedWork,value:"fixedWork"},{id:2,text:n._taskTypeTexts.fixedUnit,value:"fixedUnit"},{id:3,text:n._taskTypeTexts.fixedDuration,value:"fixedDuration"}]),i[t].field=="effortDriven"&&(i[t].dropdownData=[{id:1,text:n._effortDrivenTexts.yes,value:"true"},{id:2,text:n._effortDrivenTexts.no,value:"false"}])},createTreeGridColumns:function(){var r=this,u=r.model,n,f=[],h,e=!1,s,i,o;return(u.viewType==t.Gantt.ViewType.ResourceView||u.viewType==t.Gantt.ViewType.HistogramView)&&(e=!0,s=u.groupNameMapping||u.resourceNameMapping,s.length>0&&(n={field:"eResourceName",headerText:r._columnHeaderTexts.eResourceName,editType:t.Gantt.EditingType.String,mappingName:s,allowEditing:u.viewType==t.Gantt.ViewType.HistogramView?!1:!0,allowCellSelection:!0},f.push(n))),i=u.taskIdMapping,i.length&&(u.enableSerialNumber&&(h={field:"serialNumber",headerText:r._columnHeaderTexts.serialNumber,width:40,allowEditing:!1,allowSorting:!1,mappingName:"serialNumber",showInColumnChooser:!1},f.push(h)),n=u.showColumnChooser?{field:"taskId",headerText:r._columnHeaderTexts.taskId,width:40,editType:t.Gantt.EditingType.String,mappingName:i,allowEditing:!1,allowCellSelection:!0}:{field:"taskId",headerText:r._columnHeaderTexts.taskId,width:30,editType:t.Gantt.EditingType.String,mappingName:i,allowEditing:!1,allowCellSelection:!0},u.enableSerialNumber&&(n.visible=!1),e?r._resourceViewColumns.push(n):f.push(n)),i=u.taskNameMapping,i.length&&(n={field:"taskName",headerText:r._columnHeaderTexts.taskName,width:150,editType:t.Gantt.EditingType.String,mappingName:i,allowCellSelection:!0},e?r._resourceViewColumns.push(n):f.push(n)),i=u.startDateMapping,i.length&&(n={field:"startDate",headerText:r._columnHeaderTexts.startDate,width:150,editType:u.dateFormat.toLowerCase().indexOf("hh")==-1?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:i,allowCellSelection:!0,format:"{0:"+u.dateFormat+"}",showNullText:!0},e?r._resourceViewColumns.push(n):f.push(n)),i=u.endDateMapping,i.length&&(n={field:"endDate",headerText:r._columnHeaderTexts.endDate,width:150,editType:u.dateFormat.toLowerCase().indexOf("hh")==-1?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:i,allowCellSelection:!0,format:"{0:"+u.dateFormat+"}",showNullText:!0},e?r._resourceViewColumns.push(n):f.push(n)),i=u.resourceInfoMapping,i.length&&(n={field:"resourceInfo",headerText:r._columnHeaderTexts.resourceInfo,width:150,editType:t.Gantt.EditingType.Dropdown,mappingName:i,allowCellSelection:!0,dropdownData:this._resourceCollection},e?r._resourceViewColumns.push(n):f.push(n)),i=u.durationMapping,i.length&&(n={field:"duration",headerText:r._columnHeaderTexts.duration,width:150,editType:t.Gantt.EditingType.String,allowCellSelection:!0,mappingName:i,showNullText:!0},e?r._resourceViewColumns.push(n):f.push(n)),i=u.progressMapping,i.length&&(n={field:"status",headerText:r._columnHeaderTexts.status,width:150,editType:t.Gantt.EditingType.Numeric,mappingName:i,allowCellSelection:!0},e?r._resourceViewColumns.push(n):f.push(n)),i=u.predecessorMapping,i.length&&(n=u.enableSerialNumber?{field:"serialNumberPredecessor",headerText:r._columnHeaderTexts.predecessor,width:150,editType:t.Gantt.EditingType.String,mappingName:"serialNumberPredecessor",allowCellSelection:!0}:{field:"predecessor",headerText:r._columnHeaderTexts.predecessor,width:150,editType:t.Gantt.EditingType.String,mappingName:i,allowCellSelection:!0},e?r._resourceViewColumns.push(n):f.push(n)),u.renderBaseline&&u.baselineStartDateMapping&&u.baselineEndDateMapping&&(i=u.baselineStartDateMapping,i.length&&(n={field:"baselineStartDate",headerText:r._columnHeaderTexts.baselineStartDate,width:150,editType:u.dateFormat.toLowerCase().indexOf("hh")==-1?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:i,format:"{0:"+u.dateFormat+"}",allowEditing:!0,allowCellSelection:!0},e||f.push(n)),i=u.baselineEndDateMapping,i.length&&(n={field:"baselineEndDate",headerText:r._columnHeaderTexts.baselineEndDate,width:150,editType:u.dateFormat.toLowerCase().indexOf("hh")==-1?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:i,format:"{0:"+u.dateFormat+"}",allowEditing:!0,allowCellSelection:!0},e||f.push(n))),u.enableWBS&&(i="WBS",i.length&&(n={field:"WBS",headerText:r._columnHeaderTexts.WBS,width:150,editType:t.Gantt.EditingType.String,allowEditing:!1,mappingName:i},e||f.push(n))),u.enableWBS&&u.enableWBSPredecessor&&(i="WBSPredecessor",i.length&&(n={field:"WBSPredecessor",headerText:r._columnHeaderTexts.WBSPredecessor,width:150,editType:t.Gantt.EditingType.String,allowEditing:!1,mappingName:i},e||f.push(n))),i=u.notesMapping,i.length&&(n={field:"notesText",headerText:r._columnHeaderTexts.notes,width:150,editType:"stringedit",mappingName:i,allowEditing:!0,allowCellSelection:!0},e?r._resourceViewColumns.push(n):f.push(n)),i=u.taskSchedulingModeMapping,i.length&&(o=!1,u.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Custom&&(o=!0),n={field:"taskMode",headerText:r._columnHeaderTexts.taskMode,width:100,editType:t.Gantt.EditingType.Dropdown,allowCellSelection:o,allowEditing:o,mappingName:i,dropdownData:[{id:1,text:r._taskModeTexts.manual,value:"true"},{id:2,text:r._taskModeTexts.auto,value:"false"}],editParams:{field:{text:"text",value:"value"}}},e?r._resourceViewColumns.push(n):f.push(n)),i=u.workMapping,n={field:"work",headerText:r._columnHeaderTexts.work,width:150,editType:t.Gantt.EditingType.Numeric,allowEditing:!0,allowCellSelection:!0,visible:i?!0:!1},i.length&&(n.mappingName=i),e||f.push(n),n={field:"taskType",headerText:r._columnHeaderTexts.taskType,width:150,editType:t.Gantt.EditingType.Dropdown,dropdownData:[{id:1,text:r._taskTypeTexts.fixedWork,value:"fixedWork"},{id:2,text:r._taskTypeTexts.fixedUnit,value:"fixedUnit"},{id:3,text:r._taskTypeTexts.fixedDuration,value:"fixedDuration"}],editParams:{field:{text:"text",value:"value"}},allowEditing:!0,allowCellSelection:!0,visible:!1},e||f.push(n),n={field:"effortDriven",headerText:r._columnHeaderTexts.effortDriven,width:150,editType:t.Gantt.EditingType.Dropdown,dropdownData:[{id:1,text:r._effortDrivenTexts.yes,value:"true"},{id:2,text:r._effortDrivenTexts.no,value:"false"}],editParams:{field:{text:"text",value:"value"}},allowEditing:!0,allowCellSelection:!0,visible:!1},e||f.push(n),f},_createGanttRecords:function(n){var t=this,r=t.model,e=r.flatRecords,o=n.length,f=0,u,s=r.parentRecords,c=r.allowSorting,l=r.enableAltRow,h=t.model.ids;for(f;f<o;f++)r.enableWBS&&(n[f].WBS=(f+1).toString()),u=t._createGanttRecord(n[f],0,null,i,"Load"),t._storedIndex++,u.isAltRow=t._storedIndex%2==0?!1:!0,u.index=t._storedIndex,h[t._storedIndex]=u.taskId.toString(),t._updateLastInsertedId(u.taskId,!0),e.push(u),s.push(u),u.childRecords&&t._addNestedGanttRecords(u.childRecords);r.predecessorMapping&&t._ensurePredecessorCollection();r.enableWBS&&r.enableWBSPredecessor&&t.createWBSPredecessor();r.enableSerialNumber&&t.calculateSerialNumberPredecessor()},_calculateScheduleDates:function(t){var u=this,r,i,s,h,e,o,f=this.model,c=f.flatRecords,l;(!f.scheduleEndDate||!f.scheduleStartDate)&&c.length>0||t?(n.each(c,function(n,t){var l=[],a,c;for(t.eResourceChildTasks.length>0?l=t.eResourceChildTasks:t.eResourceTaskType!="groupTask"&&t.eResourceTaskType!="resourceTask"&&l.push(t),a=0;a<l.length;a++)c=l[a],s=u._getValidStartDate(c),h=u._getValidEndDate(c),e=c.baselineStartDate?new Date(c.baselineStartDate):null,o=c.baselineEndDate?new Date(c.baselineEndDate):null,r?(s&&u._compareDates(r,s)==1&&(r=s),e&&f.renderBaseline&&u._compareDates(r,e)==1?r=e:o&&f.renderBaseline&&u._compareDates(r,o)==1&&(r=o)):r=e&&f.renderBaseline&&u._compareDates(s,e)==1?e:o&&f.renderBaseline&&u._compareDates(s,o)==1?o:s,i?(h&&u._compareDates(i,h)==-1&&(i=h),o&&f.renderBaseline&&u._compareDates(i,o)==-1?i=o:e&&f.renderBaseline&&u._compareDates(i,e)==-1&&(i=e)):(o&&f.renderBaseline&&u._compareDates(h,o)==-1&&(i=o),i=e&&f.renderBaseline&&u._compareDates(h,e)==-1?e:h)}),r&&i||(r=u._getDateFromFormat(new Date),i=u._getDateFromFormat(new Date(r)),i.setDate(i.getDate()+20)),l=u._updateScheduleDatesByTaskLables(r,i),r=l.minStartDate,i=l.maxEndDate):f.scheduleEndDate&&f.scheduleStartDate||c.length!==0||(r=u._getDateFromFormat(new Date),i=u._getDateFromFormat(new Date(r)),i.setDate(i.getDate()+20));t?(t.minStartDate=r,t.maxEndDate=i):(f.scheduleStartDate=r?u.getFormatedDate(r):f.scheduleStartDate,f.scheduleEndDate=i?u.getFormatedDate(i):f.scheduleEndDate)},_updateScheduleDatesByTaskLables:function(n,i){var f=this,e=this.model,s=e.scheduleHeaderSettings.scheduleHeaderType,h=t.Gantt.ScheduleHeaderType,r=f._getResourceStringWidth(),o,u={},c=e.scheduleEndDate&&this._getDateFromFormat(e.scheduleEndDate),l;return s==h.Week&&(e.scheduleEndDate&&c.getTime()===i.getTime()||(o=r>0?r/f._perDayWidth+7:7,i.setDate(i.getDate()+o))),(s==h.Year||s==h.QuarterYear||s==h.HalfYear)&&(e.scheduleEndDate&&c.getTime()===i.getTime()||(o=r>0?r/f._perMonthWidth+1:1,i.setMonth(i.getMonth()+o))),s==h.Month&&(e.scheduleEndDate&&c.getTime()===i.getTime()||(o=r>0?r/f._perDayWidth+7:7,i.setDate(i.getDate()+o))),s==h.Day&&(e.scheduleEndDate&&c.getTime()===i.getTime()||(o=r>0?r/f._perHourWidth+7:7,i.setHours(i.getHours()+o))),s==h.Hour&&(e.scheduleEndDate&&c.getTime()===i.getTime()||(l=r>0?r/f._perMinuteWidth+5:5,i.setHours(i.getHours()+l),n.setHours(n.getHours()-1))),u=f._updateScheduleDatesByStripLines(n,i),n=u.startDate,i=u.endDate,u=f._updateScheduleDatesByHolidays(n,i),n=u.startDate,i=u.endDate,u.minStartDate=n,u.maxEndDate=i,u},_updateScheduleDatesByHolidays:function(t,i){var u=this,f=this.model,r={};return u._holidaysList.length>0&&n.each(u._holidaysList,function(n,r){r.getTime()>t.getTime()&&r.getTime()<i.getTime()||(r.getTime()<t.getTime()?t=new Date(r):i=new Date(r))}),r.startDate=t,r.endDate=i,r},_updateScheduleDatesByStripLines:function(t,i){var f=this,u=this.model,r={};return u.stripLines.length>0&&n.each(u.stripLines,function(n,r){var u=f._getDateFromFormat(r.day);u.getTime()>t.getTime()&&u.getTime()<i.getTime()||(u.getTime()<=t.getTime()?t=new Date(u):i=new Date(u))}),r.startDate=t,r.endDate=i,r},_getResourceStringWidth:function(){var s=this,f=this.model,u=this._resourceCollection,e="",o,r,i;if(u.length>0&&f.showResourceNames){for(r=0;r<u.length;r++)e+=u[r][f.resourceNameMapping]+" ,";return i=t.buildTag("span","",{"font-family":"Segoe UI","font-size":"12px"},{}),i.text(e),n(document.body).append(i),o=i.width(),i.remove(),o}return 0},_calculateHeaderDates:function(){var n=this,e=this.model,u=n._getDateFromFormat(e.scheduleStartDate),f=n._getDateFromFormat(e.scheduleEndDate),i=e.scheduleHeaderSettings.scheduleHeaderType,r=t.Gantt.ScheduleHeaderType;i==r.Week&&n._calculateWeekSplit(u,f);(i==r.Year||i==r.QuarterYear||i==r.HalfYear)&&n._calculateYearSplit(u,f);i==r.Month&&n._calculateMonthSplit(u,f);i==r.Day&&n._calculateDaySplit(u,f);i==r.Hour&&n._calculateHourSplit(u,f)},_getFormattedTaskId:function(n){var i="";return n.eResourceTaskType=="groupTask"?i="G_":n.eResourceTaskType=="resourceTask"&&(i="R_"),i+(t.isNullOrUndefined(n.taskId)?n.taskId:n.taskId.toString())},_addNestedGanttRecords:function(n,t){var i=this,h=i.model.ids,s=i.model,c=s.flatRecords,f=0,l=n.length,e=[],u,v=s.viewType,y=s.enableAltRow;for(f;f<l;f++)if(u=n[f],i._storedIndex++,u.isAltRow=i._storedIndex%2==0?!1:!0,u.index=i._storedIndex,h[i._storedIndex]=this._getFormattedTaskId(u),t||i._updateLastInsertedId(u.taskId,!0),c.push(u),e=u.childRecords,e){var o=0,a=e.length,r=null;for(o;o<a;o++)r=e[o],i._storedIndex++,r.isAltRow=i._storedIndex%2==0?!1:!0,r.index=i._storedIndex,h[i._storedIndex]=this._getFormattedTaskId(r),i._updateLastInsertedId(r.taskId,!0),c.push(r),r.childRecords&&i._addNestedGanttRecords(r.childRecords)}},_createGanttRecord:function(n,r,u,f,e){var h=this,o,s=h.model,b=h._columns,tt=b.length,c=n[s.childMapping],p=n[s.progressMapping]?isNaN(parseFloat(n[s.progressMapping]))?0:parseFloat(n[s.progressMapping]):0,k=n[s.resourceInfoMapping],l=n[s.predecessorMapping],v=n[s.notesMapping],d=h._getDateFromFormat(n[s.baselineStartDateMapping]),a=h._getDateFromFormat(n[s.baselineEndDateMapping]),g=n.WBS?n.WBS:null,nt=s.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Auto?!0:s.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Manual?!1:s.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Custom?n[s.taskSchedulingModeMapping]==!0?!1:!0:s.taskSchedulingMode,w,y;return o=new t.Gantt.GanttRecord,o.taskId=n[s.taskIdMapping],o.taskName=n[s.taskNameMapping],h._addItemValue(o,n,e),o.isAutoSchedule=nt,w=h._isinAddnewRecord?h._newRecordResourceCollection:this._resourceCollection,o.resourceInfo=k&&o._setResourceInfo(n[s.resourceInfoMapping],s.resourceIdMapping,s.resourceNameMapping,s.resourceUnitMapping,w),h._updateResourceName(o),h._calculateScheduledValues(o,n),e||s.viewType!="resourceView"||o.duration==0&&(o.duration=1,o._calculateEndDate(this)),o.baselineStartDate=this._checkBaseLineStartDate(d),a&&a.getHours()==0&&this._defaultEndTime!=86400&&this._setTime(this._defaultEndTime,a),o.baselineEndDate=this._checkBaseLineEndDate(a),o.WBS=g,o.notes=v,o.notesText=v?h._getPlainText(v):"",h._updateCustomField(n,o),o.status=p,o.predecessorsName=l,e||(o.predecessor=l&&o._calculatePredecessor(l,this._durationUnitEditText,s.durationUnit,h),h._isValidPredecessorString||(y=h._getPredecessorStringValue(o),o.predecessorsName=y,o.item.predecessor=y,h._isValidPredecessorString=!0),s.enableSerialNumber&&n.serialNumberPredecessor&&(o.serialNumberPredecessor=n.serialNumberPredecessor)),e&&(h._serialCount++,o.serialNumber=h._serialCount),o.parentItem=u,o.level=r,e||(o.width=o._calculateWidth(this),o.left=o._calculateLeft(this),o.progressWidth=o._getProgressWidth(o.width,p),o.baselineStartDate&&o.baselineEndDate&&(o.baselineLeft=o._calculateBaselineLeft(this),o.baselineRight=o._calculateBaselineRight(this),o.baselineWidth=o._calculateBaseLineWidth(this))),h._updateItemValueInRecord(o),o.childRecords=c&&c.length>0&&h._createChildRecords(c,r+1,o),o.hasChildRecords=c&&c.length>0?!0:!1,o.isMilestone=o.hasChildRecords?!1:o.isMilestone,h._updateExpandStateMappingValue(n,o),o.expanded=f!==i?f:c?c.length>0:!1,s.enableVirtualization===!1&&(o.isExpanded=!0),o.hasChildRecords&&(o.manualStartDate=o.startDate,o.manualEndDate=o.endDate,o.manualDuration=o.duration),o.taskType=n.taskType?n.taskType:s.taskType,o.effortDriven=n.effortDriven?n.effortDriven:o.taskType!="fixedWork"?"false":"true",s.workMapping||o._updateWorkWithDuration(h),l&&h._predecessorsCollection.push(o),o},_calculateScheduledValues:function(n,i){var u=this,r=u.model,e=t.isNullOrUndefined(i[r.durationMapping])?null:i[r.durationMapping],s=u._getDateFromFormat(i[r.startDateMapping]),o=u._getDateFromFormat(i[r.endDateMapping]),h=t.isNullOrUndefined(i[r.workMapping])?0:i[r.workMapping],c=r.milestoneMapping&&i[r.milestoneMapping],f;if(n.durationUnit=u._validateDurationUnitMapping(i[r.durationUnitMapping]),o||s||!t.isNullOrUndefined(e))s?(n.startDate=this._checkStartDate(s,n),!o&&t.isNullOrUndefined(e)?r.allowUnscheduledTask?(n.endDate=null,n.duration=null):(n.duration=1,n._calculateEndDate(this)):t.isNullOrUndefined(e)||o?o&&t.isNullOrUndefined(e)?(o.getHours()==0&&this._defaultEndTime!=86400&&this._setTime(this._defaultEndTime,o),n.endDate=this._checkEndDate(o,n),u._compareDatesFromRecord(n)==1?(n.endDate=new Date(n.startDate),n.isMilestone=!0,n.duration=0):n._calculateDuration(this)):(f=u._getDurationValues(e),n.duration=f.duration,n.durationUnit=t.isNullOrUndefined(f.durationUnit)?n.durationUnit:f.durationUnit,n._calculateEndDate(this)):(f=u._getDurationValues(e),n.duration=f.duration,n.durationUnit=t.isNullOrUndefined(f.durationUnit)?n.durationUnit:f.durationUnit,n._calculateEndDate(this))):o?(o.getHours()==0&&this._defaultEndTime!=86400&&this._setTime(this._defaultEndTime,o),n.endDate=this._checkEndDate(o,n),t.isNullOrUndefined(e)?r.allowUnscheduledTask?(n.startDate=null,n.duration=null):(n.duration=1,n.startDate=u._getStartDate(n.endDate,n.duration,n.durationUnit,n)):t.isNullOrUndefined(e)||(f=u._getDurationValues(e),n.duration=f.duration,n.durationUnit=t.isNullOrUndefined(f.durationUnit)?n.durationUnit:f.durationUnit,n.startDate=this._getStartDate(n.endDate,e,n.durationUnit,n))):t.isNullOrUndefined(e)||(f=u._getDurationValues(e),n.duration=f.duration,n.durationUnit=t.isNullOrUndefined(f.durationUnit)?n.durationUnit:f.durationUnit,r.allowUnscheduledTask?(n.startDate=null,n.endDate=null):t.isNullOrUndefined(r.scheduleStartDate)||(n.startDate=u._getScheduledStartDate(n),n._calculateEndDate(this)));else{if(r.allowUnscheduledTask)return;n.duration=1;t.isNullOrUndefined(r.scheduleStartDate)||(n.startDate=u._getScheduledStartDate(n),n._calculateEndDate(this))}n.duration==0&&(n.isMilestone=!0,n.endDate=u._getDateFromFormat(n.startDate));!t.isNullOrUndefined(c)&&c?(n.duration=0,n.isMilestone=!0,n.endDate=u._getDateFromFormat(n.startDate)):r.workMapping&&(n.durationUnit=r.durationUnit,isNaN(h)||t.isNullOrUndefined(h)?(n.work=0,n.duration=0,n.isMilestone=!0,n.endDate=u._getDateFromFormat(n.startDate)):(n.work=h,n._updateDurationWithWork(u),n.duration==0?(n.isMilestone=!0,n.endDate=u._getDateFromFormat(n.startDate)):t.isNullOrUndefined(n.startDate)||t.isNullOrUndefined(n.duration)||(n.endDate=this._getEndDate(n.startDate,n.duration,n.durationUnit,n))),t.isNullOrUndefined(i[r.durationMapping])||(i[r.durationMapping]=n.duration),t.isNullOrUndefined(i[r.durationMapping])||(i[r.endDateMapping]=n.endDate))},_getScheduledStartDate:function(n){var i=this,r=i.model,u,s,h,f,e,o;if(t.isNullOrUndefined(r.scheduleStartDate))if(i._isLoad){if(t.isNullOrUndefined(i._minStartDate)){for(h=r.flatRecords.length,f=r.flatRecords[0].startDate,e=0;e<h;e++)o=r.flatRecords[e].startDate,t.isNullOrUndefined(o)||i._compareDates(o,f)!=-1||(f=o);i._minStartDate=f;u=i._checkStartDate(i._minStartDate,n)}else u=i._checkStartDate(i._minStartDate,n);r.allowUnscheduledTask||(n.startDate=u,n.item[r.startDateMapping]=n.startDate,n._calculateEndDate(this))}else return null;else s=i._getDateFromFormat(r.scheduleStartDate),u=i._checkStartDate(s,n);return new Date(u)},_updateCustomField:function(n,t){var u=this.model.viewType=="resourceView"&&t.eResourceTaskType!="groupTask"&&t.eResourceTaskType!="resourceTask"?this.getResourceViewEditColumns():this.getColumns(),f=u.length,r;if(f)for(r=0;r<f;r++)t[u[r].field]==i&&(t[u[r].field]=n[u[r].mappingName])},_updateExpandStateMappingValue:function(n,i){var r=this.model;r.expandStateMapping&&i.hasChildRecords&&(t.isNullOrUndefined(n[r.expandStateMapping])?t.isNullOrUndefined(n[r.expandStateMapping])&&!r.enableCollapseAll?i[r.expandStateMapping]=i.item[r.expandStateMapping]=n[r.expandStateMapping]=!0:t.isNullOrUndefined(n[r.expandStateMapping])&&r.enableCollapseAll&&(i[r.expandStateMapping]=i.item[r.expandStateMapping]=n[r.expandStateMapping]=!1):i[r.expandStateMapping]=i.item[r.expandStateMapping]=n[r.expandStateMapping])},_validateDurationUnitMapping:function(n){var i=n;return this._durationUnitEditText.minute.indexOf(i)!=-1?i=t.Gantt.DurationUnit.Minute:this._durationUnitEditText.hour.indexOf(i)!=-1?i=t.Gantt.DurationUnit.Hour:this._durationUnitEditText.day.indexOf(i)!=-1&&(i=t.Gantt.DurationUnit.Day),i==t.Gantt.DurationUnit.Day||i==t.Gantt.DurationUnit.Hour||i==t.Gantt.DurationUnit.Minute?i:this.model.durationUnit},_updateItemValueInRecord:function(n){var t=this.model,i;n.item&&(i=n.item,t.startDateMapping&&(i[t.startDateMapping]=n.startDate),t.endDateMapping&&(i[t.endDateMapping]=n.endDate),t.durationMapping&&(i[t.durationMapping]=n.duration),t.durationUnitMapping&&(i[t.durationUnitMapping]=n.durationUnit),t.workMapping&&(i[t.workMapping]=n.work),t.taskSchedulingModeMapping&&(i[t.taskSchedulingModeMapping]=!n.isAutoSchedule),t.baselineStartDateMapping&&(i[t.baselineStartDateMapping]=n.baselineStartDate),t.baselineEndDateMapping&&(i[t.baselineEndDateMapping]=n.baselineEndDate),i.serialNumber=n.serialNumber)},_addItemValue:function(n,i,r){var f=this,e=this.model,o,u;e.parentTaskIdMapping&&r?(o=i[e.taskIdMapping],u=f._taskIds.indexOf(o),n.item=u>-1?f._retrivedData[u]:[]):this.dataSource()instanceof t.DataManager&&this.dataSource().dataSource.json&&this.dataSource().dataSource.offline&&r?e.parentTaskIdMapping?(o=i[e.taskIdMapping],u=f._taskIds.indexOf(o),n.item=u>-1?f._retrivedData[u]:[]):n.item=i:n.item=i},_getPlainText:function(n){var t=document.createElement("DIV");return t.innerHTML=n,t.textContent||t.innerText||""},_updateResourceName:function(n){var s=this,r=n.resourceInfo,u=this.model,e=[],o,i,f;if(r){for(o=r.length,n.item?n.item[u.resourceInfoMapping]=[]:null,i=0;i<o;i++)e.push(r[i][u.resourceNameMapping]),n.item&&(u.resourceUnitMapping&&!t.isNullOrUndefined(r[i][u.resourceUnitMapping])&&r[i][u.resourceUnitMapping]!=100?(f={},f[u.resourceIdMapping]=r[i][this.model.resourceIdMapping],f[u.resourceUnitMapping]=r[i][this.model.resourceUnitMapping],n.item[this.model.resourceInfoMapping].push(f)):n.item[this.model.resourceInfoMapping].push(r[i][this.model.resourceIdMapping]));n.resourceNames=e.join(",")}},_updateResourceRelatedFields:function(n){var i=this,u=i.model,e=n.taskType,r=n.isAutoSchedule,f=n.effortDriven==="true";if(!t.isNullOrUndefined(n.resourceInfo))if(n.work>0||i._updatedColumn=="work")switch(e){case"fixedUnit":r&&n.resourceInfo.length&&(i._updatedColumn=="work"||f&&i._updatedColumn=="resourceInfo")?n._updateDurationWithWork(i):r||i._updatedColumn!="work"?n._updateWorkWithDuration(i):n._updateUnitWithWork(i);break;case"fixedWork":if(n.resourceInfo.length==0)return;r?i._updatedColumn=="duration"||i._updatedColumn=="endDate"?(n._updateUnitWithWork(i),n.duration==0&&(n.work=0,u.workMapping&&(n.item[u.workMapping]=0))):n._updateDurationWithWork(i):i._updatedColumn=="work"?n._updateUnitWithWork(i):n._updateWorkWithDuration(i);break;case"fixedDuration":n.resourceInfo.length&&(i._updatedColumn=="work"||r&&f&&i._updatedColumn=="resourceInfo")?n._updateUnitWithWork(i):n._updateWorkWithDuration(i)}else n._updateWorkWithDuration(i)},_updateResourceDataSource:function(t){for(var o,f,i,s,e=this,r=[],h=t.resourceInfo?t.resourceInfo.length:0,u=0;u<h;u++)r.push({name:t.resourceInfo[u][e.model.resourceIdMapping],unit:t.resourceInfo[u][e.model.resourceUnitMapping]});for(o="#treegrid"+e._id+"resourceEdit",f=n(o).data("ejTreeGrid").model.dataSource,i=0;i<f.length;i++)s=r.filter(function(n){return n.name===parseInt(f[i].name)}),s&&s.length==0&&r.push(f[i]);n(o).ejTreeGrid("option","dataSource",r)},_getHolidayByDay:function(n){var i=this._holidaysList,r=!1,t,u,f;if(i)for(t=0;t<i.length;t++)if(u=i[t],f=this._isInThisDay(n,u),f){r=!0;break}return r},_isInThisDay:function(n,t){var i=new Date(t),r=new Date(t);return i.setHours(0,0,0,0),r.setHours(23,59,59,59),n.getTime()>=i.getTime()&&n.getTime()<r.getTime()?!0:!1},_getHoliday:function(){var n;if(this.model.holidays!=null){var t=this.model.holidays,i=[],r=t.length;if(r>0){for(n=0;n<r;n++)i[n]=this._getDateFromFormat(t[n].day);return i}}return!1},_getStringHolidays:function(){var n;if(this._holidaysList!=null&&this._holidaysList.length>0){var i=this._holidaysList,r=[],u=i.length;if(u>0){for(n=0;n<u;n++)r[n]=t.format(i[n],this.model.dateFormat,this.model.locale);return r}}return[]},_createChildRecords:function(n,t,r){for(var f=[],e=this,h=e.model,u=0,c=n.length,o,s,u=0;u<c;u++)h.enableWBS&&(o=r.WBS,n[u].WBS=o+"."+(u+1)),n[u]&&(s=e._createGanttRecord(n[u],t,r,i,"Load"),f.push(s));return f},_createResourceInfoCollection:function(n){var i=this,t=0,r=n.length;for(t;t<r;t++)i._resourceInfoCollection.push(i._createResourceInfo(n[t]))},_createResourceInfo:function(n){var i=this.model,t={};return t.resourceId=n[i.resourceIdMapping],t.resourceName=n[i.resourceNameMapping],t},_calculateWeekSplit:function(n,t){var i=this,u=i.model,f=u.scheduleHeaderSettings.weekStartDay,e,r,o;e=u.scheduleHeaderSettings.timescaleStartDateMode=="month"?new Date(n.getFullYear(),n.getMonth(),1):u.scheduleHeaderSettings.timescaleStartDateMode=="year"?new Date(n.getFullYear(),0,1):n;n=e;r=f>=0&&f<7?f:0;o=n.getDay()<=r?n.getDate()-(7-r+n.getDay()):n.getDate()-n.getDay()+r;n.setDate(o);n.setHours(0,0,0,0);do i._scheduleWeeks.push(new Date(n)),n.setDate(n.getDate()+7);while(!(n>t));i._projectStartDate=new Date(i._scheduleWeeks[0]);i._projectEndDate=new Date(i._scheduleWeeks[i._scheduleWeeks.length-1])},_calculateYearSplit:function(n,t){var i=this,r=i.model,u,f,e,o;if(r.scheduleHeaderSettings.timescaleStartDateMode=="month"){u=new Date(n.getFullYear(),n.getMonth(),1);n=u;do i._scheduleYears.push(new Date(n)),n=new Date(n.getFullYear()+1,0,1);while(!(n>=t));i._projectStartDate=new Date(i._scheduleYears[0].getFullYear(),i._scheduleYears[0].getMonth(),1);i._projectEndDate=new Date(i._scheduleYears[i._scheduleYears.length-1].getFullYear(),11,31)}else if(r.scheduleHeaderSettings.timescaleStartDateMode=="week"){f=n.getDay()==0?n.getDate()-7:n.getDate()-n.getDay();n.setDate(f);do i._scheduleYears.push(new Date(n)),n=new Date(n.getFullYear()+1,0,1);while(!(n>=t));i._projectStartDate=new Date(i._scheduleYears[0]);i._projectEndDate=new Date(i._scheduleYears[i._scheduleYears.length-1].getFullYear(),11,31)}else{n.setMonth(0);n.setDate(1);n.setHours(0,0,0,0);do i._scheduleYears.push(new Date(n)),n.setMonth(n.getMonth()+12);while(!(n>=t));i._projectStartDate=new Date(i._scheduleYears[0].getFullYear(),i._scheduleYears[0].getMonth(),1);i._projectEndDate=new Date(i._scheduleYears[i._scheduleYears.length-1].getFullYear(),11,31)}},_calculateDaySplit:function(n,t){var i=this,u=i.model,f,r;u.scheduleHeaderSettings.timescaleStartDateMode=="week"?(f=n.getDay()==0?n.getDate()-7:n.getDate()-n.getDay(),n.setDate(f)):u.scheduleHeaderSettings.timescaleStartDateMode=="month"?(r=new Date(n.getFullYear(),n.getMonth(),1),n=r):u.scheduleHeaderSettings.timescaleStartDateMode=="year"?(r=new Date(n.getFullYear(),0,1),n=r):n.setHours(0,0,0,0);do i._scheduleDays.push(new Date(n)),n.setDate(n.getDate()+1),n.setHours(0,0,0,0);while(n<=t);i._projectStartDate=new Date(i._scheduleDays[0]);i._projectEndDate=new Date(i._scheduleDays[i._scheduleDays.length-1])},_calculateHourSplit:function(n,t){var i=this,u=i.model,f,r;u.scheduleHeaderSettings.timescaleStartDateMode=="week"?(f=n.getDay()==0?n.getDate()-7:n.getDate()-n.getDay(),n.setDate(f)):u.scheduleHeaderSettings.timescaleStartDateMode=="month"?(r=new Date(n.getFullYear(),n.getMonth(),1),n=r):u.scheduleHeaderSettings.timescaleStartDateMode=="year"?(r=new Date(n.getFullYear(),0,1),n=r):n.setMinutes(0);do i._scheduleHours.push(new Date(n)),n.setTime(n.getTime()+36e5);while(n<=t);i._projectStartDate=new Date(i._scheduleHours[0]);i._projectEndDate=new Date(i._scheduleHours[i._scheduleHours.length-1])},_calculateMonthSplit:function(n,t){var r=this,s=r.model,h=s.scheduleHeaderSettings.weekStartDay,u=h>=0&&h<7?h:0,o,f,i,c,e;if(s.scheduleHeaderSettings.timescaleStartDateMode=="week"){f=n.getDay()<=u?n.getDate()-(7-u+n.getDay()):n.getDate()-n.getDay()+u;n.setDate(f);n.setHours(0,0,0,0);do r._scheduleMonths.push(new Date(n)),n=n.getDate()==29&&n.getMonth()==0&&n.getFullYear()%4!=0?new Date(n.getFullYear(),n.getMonth()+1,n.getDate()-1):new Date(n.getFullYear(),n.getMonth()+1,n.getDate());while(!(n>=t))}else if(s.scheduleHeaderSettings.timescaleStartDateMode=="year"){o=new Date(n.getFullYear(),0,1);n=o;this._enableMonthStart||(f=n.getDay()<=u?n.getDate()-(7-u+n.getDay()):n.getDate()-n.getDay()+u,n.setDate(f),n.setHours(0,0,0,0));do r._scheduleMonths.push(new Date(n)),n.getMonth()==0||n.getMonth()==2||n.getMonth()==4||n.getMonth()==6||n.getMonth()==7||n.getMonth()==9||n.getMonth()==11?n.getDate()==1?n.setDate(n.getDate()+31):(i=32-n.getDate(),n.setDate(n.getDate()+i)):n.getMonth()==3||n.getMonth()==5||n.getMonth()==8||n.getMonth()==10?n.setDate(n.getDate()+30):n.getMonth()==1&&(n.getFullYear()%4==0?n.setDate(n.getDate()+29):n.setDate(n.getDate()+28));while(!(n>=t))}else{o=new Date(n.getFullYear(),n.getMonth(),1);n=o;this._enableMonthStart||(f=n.getDay()<=u?n.getDate()-(7-u+n.getDay()):n.getDate()-n.getDay()+u,n.setDate(f),n.setHours(0,0,0,0));do r._scheduleMonths.push(new Date(n)),n.getMonth()==0||n.getMonth()==2||n.getMonth()==4||n.getMonth()==6||n.getMonth()==7||n.getMonth()==9||n.getMonth()==11?n.getDate()==1?n.setDate(n.getDate()+31):(i=32-n.getDate(),n.setDate(n.getDate()+i)):n.getMonth()==3||n.getMonth()==5||n.getMonth()==8||n.getMonth()==10?n.getDate()==1?n.setDate(n.getDate()+30):(i=31-n.getDate(),n.setDate(n.getDate()+i)):n.getMonth()==1&&(n.getFullYear()%4==0?n.getDate()==1?n.setDate(n.getDate()+29):(i=30-n.getDate(),n.setDate(n.getDate()+i)):n.getDate()==1?n.setDate(n.getDate()+28):(i=29-n.getDate(),n.setDate(n.getDate()+i)));while(!(n>=t))}c=new Date(r._scheduleMonths[0]);e=new Date(r._scheduleMonths[r._scheduleMonths.length-1]);e=new Date(e.getFullYear(),e.getMonth()+1,0);r._projectStartDate=c;r._projectEndDate=e},getDateType:function(n){if(n!=null){if(typeof n=="object")return n;var t=new RegExp("\\-","g"),i=new RegExp("\\.","g");return n=n.replace(t,"/"),n=n.replace(i,"/"),new Date(n)}return null},getFormatedDate:function(n){return t.format(n,this.model.dateFormat,this.model.locale)},_getProgressWidth:function(n,t){return n*t/100},_wireEvents:function(){var t=this,u=t.model,i=n("#ejTreeGrid"+t._id),r=n("#ejGanttChart"+t._id),f=t._$ejGantt;t._on(t.element,"click",t.clickHandler);t._on(t.element,"touchstart",".e-gridcontent,.e-ganttviewerbodyContianerparent",t._updateTouchCtrlFlag);t._on(t.element,"click",".e-ejinputtext",t._searchTextFocusIn);t._on(t.element,"focusout",".e-ejinputtext",t._searchTextFocusOut);u.enableContextMenu&&(t._on(t.element,"contextmenu taphold",t._contextMenuEventBinding),t._on(t.element,"touchend",t._mouseupHandler),t._on(t.element,"keyup",this._preventContextMenu));u.enableResize&&u.isResponsive&&t._on(n(window),"resize",t.windowResize);i.ejTreeGrid({rowSelecting:n.proxy(t.rowSelecting,t)});i.ejTreeGrid({rowSelected:n.proxy(t.rowSelected,t)});i.ejTreeGrid({cellSelecting:n.proxy(t.cellSelecting,t)});i.ejTreeGrid({cellSelected:n.proxy(t.cellSelected,t)});i.ejTreeGrid({rowDrag:n.proxy(t.rowDrag,t)});i.ejTreeGrid({rowDragStart:n.proxy(t.rowDragStart,t)});i.ejTreeGrid({rowDragStop:n.proxy(t.rowDragStop,t)});i.ejTreeGrid({actionBegin:n.proxy(t.actionBegin,t)});i.ejTreeGrid({actionComplete:n.proxy(t.actionComplete,t)});i.ejTreeGrid({expandAllCollapseAllRequest:n.proxy(t.expandAllCollapseAllRequest,t)});i.ejTreeGrid({contextMenuAction:n.proxy(t.contextMenuAction,t)});i.ejTreeGrid({subContextMenuAction:n.proxy(t.subContextMenuAction,t)});i.ejTreeGrid({setInitialData:n.proxy(t.setInitialData,t)});i.ejTreeGrid({refreshScrollCss:n.proxy(t._updateScrollerBorder,t)});i.ejTreeGrid({getCtrlRequestValue:n.proxy(t._getCtrlRequestValue,t)});u.queryCellInfo&&i.ejTreeGrid({queryCellInfo:n.proxy(t._queryCellInfo,t)});u.rowDataBound&&i.ejTreeGrid({rowDataBound:n.proxy(t._rowDataBound,t)});i.ejTreeGrid({beginEdit:n.proxy(t._beginEdit,t)});i.ejTreeGrid({endEdit:n.proxy(t._endEdit,t)});i.ejTreeGrid({expanding:n.proxy(t.expanding,t)});i.ejTreeGrid({collapsing:n.proxy(t.collapsing,t)});i.ejTreeGrid({expanded:n.proxy(t.expanded,t)});i.ejTreeGrid({collapsed:n.proxy(t.collapsed,t)});i.ejTreeGrid({refreshRow:n.proxy(t.refreshRow,t)});i.ejTreeGrid({cancelEditCell:n.proxy(t.cancelEditCell,t)});u.viewType=="resourceView"&&i.ejTreeGrid({updateResource:n.proxy(t._removeResources,t)});r.ejGanttChart({rowSelecting:n.proxy(t.rowSelecting,t)});r.ejGanttChart({rowSelected:n.proxy(t.rowSelected,t)});r.ejGanttChart({rowHover:n.proxy(t._ganttChartRowHover,t)});r.ejGanttChart({actionBegin:n.proxy(t.actionBegin,t)});r.ejGanttChart({actionComplete:n.proxy(t.chartactionComplete,t)});r.ejGanttChart({refreshRow:n.proxy(t.refreshRowData,t)});r.ejGanttChart({zooming:n.proxy(t.zoomingChart,t)});r.ejGanttChart({queryTaskbarInfo:n.proxy(t.queryTaskbarInfo,t)});r.ejGanttChart({expanding:n.proxy(t.expanding,t)});r.ejGanttChart({collapsing:n.proxy(t.collapsing,t)});r.ejGanttChart({expanded:n.proxy(t.expanded,t)});r.ejGanttChart({collapsed:n.proxy(t.collapsed,t)});r.ejGanttChart({expandAllCollapseAllRequest:n.proxy(t.expandAllCollapseAllRequest,t)});r.ejGanttChart({taskbarEditing:n.proxy(t.taskbarEditing,t)});r.ejGanttChart({taskbarEdited:n.proxy(t.taskbarEdited,t)});r.ejGanttChart({calculateEndDate:n.proxy(t.calculateEndDate,t)});r.ejGanttChart({calculateDuration:n.proxy(t.calculateDuration,t)});r.ejGanttChart({clearColumnMenu:n.proxy(t.clearColumnMenu,t)});r.ejGanttChart({deleteRow:n.proxy(t.deleteRow,t)});r.ejGanttChart({cancelEditCell:n.proxy(t.cancelEditCell,t)});r.ejGanttChart({getCtrlRequestValue:n.proxy(t._getCtrlRequestValue,t)});r.ejGanttChart({taskbarEditedCancel:n.proxy(t._taskbarEditedCancel,t)});f.ejSplitter({allowResizing:n.proxy(t._onResize,t)});t._on(t.element,"mousedown",t._mousedownhandler);t._enableEditingEvents()},_preventContextMenu:function(n){if(n.keyCode==93)return n.preventDefault(),n.stopPropagation(),!1},_onResize:function(i){var r=this,f=!1,u={},e=r.splitterPosition();r._splitterOnResize=!0;r._isinBeginEdit&&n("#ejTreeGrid"+r._id+"EditForm").length>0&&(r._$treegridHelper.ejTreeGrid("cancelEditCell"),r._isinBeginEdit=!1);f=e.indexOf("%")!=-1?!0:!1;f?r.splitterPosition(Math.round(i.prevPane.size/r._ganttWidth*100)+"%"):r.splitterPosition(Math.round(i.prevPane.size).toString());r._splitterPosition(r.splitterPosition());r._$treegridHelper.ejTreeGrid("refreshScroller",i.prevPane.size);r._$ganttchartHelper.ejGanttChart("refreshScroller",i.nextPane.size-1);r._updateScrollerBorder();u={prevSplitterPosition:e,customSplitterPosition:null,isSplitterIndex:!1,isOnResize:!0,currentSplitterPosition:r.splitterPosition()};r._trigger("splitterResized",u)?r.setSplitterPosition(u.prevSplitterPosition):t.isNullOrUndefined(u.customSplitterPosition)||(u.isSplitterIndex?r.setSplitterIndex(u.customSplitterPosition):r.setSplitterPosition(u.customSplitterPosition));r._splitterOnResize=!1},_searchTextFocusOut:function(t){var r=this,u=this._toolboxTooltipTexts.searchTool,i=n(t.target);n(i).closest("li")&&n(i).closest("li").attr("id")==r._id+"_search"&&n(i).attr("placeholder",u)},_searchTextFocusIn:function(t){var u=this,i=n(t.target),r=n(i).attr("placeholder");i.hasClass("e-ejinputtext")&&r&&i.removeAttr("placeholder")},clickHandler:function(t){var r=this,f=r.model,i=n(t.target),u;(f.allowSelection&&f.selectionType=="multiple"&&f.selectionMode=="row"&&(i.hasClass("e-rowselect")?i.hasClass("e-spanclicked")?r._clearMultiSelectPopup():i.addClass("e-spanclicked"):n("#"+r._id+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")||this._multiSelectPopup.hide(),(i.hasClass("e-rowcell")||i.parent().hasClass("e-rowcell")||i.closest("td").hasClass("e-rowcell")||i.closest("td").hasClass("e-rowcell")&&i.hasClass("e-cell")||i.hasClass("e-rowcell")||i.parent().hasClass("e-chartcell")||i.closest("td").hasClass("e-chartcell")||i.closest("td").hasClass("e-chartcell"))&&(r._ganttTouchTrigger!=!0||this._multiSelectPopup==null||this._multiSelectPopup.find(".e-rowselect").hasClass("e-spanclicked")||(this._multiSelectPopup.removeAttr("style"),i.closest(".e-rowcell").length!=0?(u=i.closest(".e-rowcell").offset(),this._multiSelectPopup.offset({top:0,left:0}).offset({left:u.left+(i.closest(".e-rowcell").outerWidth()/2-this._multiSelectPopup.width()/2),top:u.top-this._multiSelectPopup.outerHeight()-10}).show()):(u=i.closest(".e-chartcell").offset(),this._multiSelectPopup.offset({top:0,left:0}).offset({left:t.pageX+this._multiSelectPopup.width()/2,top:u.top-this._multiSelectPopup.outerHeight()-10}).show())),r._ganttTouchTrigger=!1)),r._clearContextMenu(),i.hasClass("e-vhandle")||i.hasClass("e-vscrollbar")||i.hasClass("e-vup")||i.hasClass("e-vhandlespace")||i.hasClass("e-vdown"))||i.hasClass("e-hhandle")||i.hasClass("e-hscrollbar")||i.hasClass("e-hup")||i.hasClass("e-hdown")||i.hasClass("e-hhandlespace")||(r._isinBeginEdit&&document.getElementById(r._id).contains(i[0])&&(i.closest("td").hasClass("e-editedcell")||i.hasClass("e-date")||i.hasClass("e-arrow")||i.hasClass("e-down-arrow")||i.closest("form#ejTreeGrid"+r._id+"EditForm").length!=0||!(n("#ejTreeGrid"+r._id+"EditForm").length>0)||(r._$treegridHelper.ejTreeGrid("saveCell"),r._isinBeginEdit=!1)),r.clearColumnMenu())},windowResize:function(){var tt,it,rt,ut,ft,v,et,b,e,h,k,ct,y,ot;if(this.element.is(":visible")){var i=this,p="#e-ejSpliter"+this._id,l="#"+this._id+"_toolbarItems",d="#ejGanttChart"+this._id,st="#ejTreeGrid"+this._id,o=n("#"+this._id).find(".e-ganttviewerbodyContianer"),w=n("#"+this._id).find(".e-ganttviewerheaderContainer"),ht="#ejTreeGrid"+this._id,c="#ejTreeGrid"+this._id+"e-gridcontent",s=i.model.sizeSettings.width,a=i.model.sizeSettings.height,g=i.element[0].style.height,nt=i.element[0].style.width,r,u,f;s&&typeof s!="number"&&s.indexOf("%")!=-1||nt.indexOf("%")!=-1?(v=s?s:nt,tt=n(i.element).parent().width()?n(i.element).parent().width():n(i.element).width(),r=tt/100*parseInt(v)):r=n(i.element).width();i.splitterPosition().indexOf("%")==-1?(it=parseInt(i.splitterPosition())+7+2,i._ganttWidth=r=Math.max(r,it)):i._ganttWidth=r;a&&typeof s!="number"&&a.indexOf("%")!=-1||g.indexOf("%")!=-1?(rt=a?a:g,ut=n(i.element).parent().height()?n(i.element).parent().height():n(i.element).height(),ft=n(i.element).parent().height()?ut/100*parseInt(rt):n(i.element).height(),u=ft):u=n(i.element).height();u=u-i._totalBorderHeight;r=Math.round(r);h=n(l).length?n(l).height():0;n(p).css("width",r);n(p).css("height",u-h);n(p).ejSplitter("refresh");n(l).length&&n(l).css("width",r);v=n(d).width();et=n(st).width();n(d).height(u-h);b=o.ejScroller("option","scrollTop");e=o.ejScroller("option","scrollLeft");o.ejScroller({width:v,height:u-h-w.height()-parseInt(w.css("border-bottom-width"))});o.ejScroller("refresh");f=i._$ganttchartHelper.ejGanttChart("getMaxScrollWidth");e>f&&(e=f>0?f:0);o.ejScroller("option","scrollTop",b);o.ejScroller("option","scrollLeft",e);n(ht).height(u-h);n(c).height(u-h-w.height()-i._totalBorderHeight);e=n(c).ejScroller("option","scrollLeft");n(c).width(et);n(c).ejScroller("refresh");f=i._$treegridHelper.ejTreeGrid("getMaxScrollWidth");e>f&&(e=f>0?f:0);n(c).ejScroller("option","scrollLeft",e);i._$treegridHelper.ejTreeGrid("updateViewPortHeight");i._$ganttchartHelper.ejGanttChart("updateViewPortHeight");i.model.enableVirtualization&&(i._$treegridHelper.ejTreeGrid("instance")._searchString.length>0&&i.model.selectionType=="multiple"&&i.model.selectionMode=="row"&&(k=[],ct=i.model.selectedItems.filter(function(n){k.push(i.model.updatedRecords.indexOf(n))})),i._$treegridHelper.ejTreeGrid("cancelRowEditCell"),y={},y.requestType=t.TreeGrid.Actions.Refresh,i._$treegridHelper.ejTreeGrid("processBindings",y),i._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",y),i._$ganttchartHelper.ejGanttChart("refreshHelper",i.model.currentViewData,i.model.updatedRecords),i._$ganttchartHelper.ejGanttChart("onScrollHelper",b),i.model.selectionMode=="row"?i.model.selectionType=="multiple"?i.selectMultipleRows(k):i.selectRows(this.selectedRowIndex()):(ot=i.model.selectionType=="multiple"?!0:!1,i.selectCells(i.model.selectedCellIndexes,ot)));i.model.viewType!="resourceView"&&(i._$ganttchartHelper.ejGanttChart("clearConnectorLines"),i._updateRowHeightInConnectorLine(i._connectorLinesCollection),i._$ganttchartHelper.ejGanttChart("renderConnectorLines",i._connectorLinesCollection));i.setSplitterPosition(i.splitterPosition());i.model.allowSelection&&i.model.selectionType=="multiple"&&i._multiSelectPopup&&i._multiSelectPopup.is(":visible")&&i._alignMultiSelectPopup();i.isCriticalPathEnable==!0&&i.model.predecessorMapping&&i._$ganttchartHelper.ejGanttChart("criticalConnectorLine",i.criticalPathCollection,i.detailPredecessorCollection,!0,i.collectionTaskId)}},_updateRowHeightInConnectorLine:function(t){var u,i,r;if(t&&t.length&&(u=n("#ejGanttChart"+this._id).ejGanttChart("instance"),i=n("#"+u._$ganttViewTablebody[0].id).find("tr:first")[0].getBoundingClientRect().height,i&&!isNaN(i)))for(r=0;r<t.length;r++)t[r].RowHeight=i},setScrollTop:function(n){var t=this,i=t._$treegridHelper.ejTreeGrid("getMaxScrollHeight");t._isinBeginEdit&&t._$treegridHelper.ejTreeGrid("saveCell");(typeof n=="number"||typeof parseInt(n)=="number")&&(n=parseInt(n),n>=0&&(i>=n?t._$ganttchartHelper.ejGanttChart("onScrollHelper",n):t._$ganttchartHelper.ejGanttChart("onScrollHelper",i)))},_getCoordinate:function(n){var i=n;return t.isNullOrUndefined(n.originalEvent.changedTouches)||n.type!="touchmove"&&n.type!="touchstart"&&n.type!="touchend"&&n.type!="taphold"&&n.type!="tap"||(i=n.originalEvent.changedTouches[0]),i},_mouseupHandler:function(n){var t=this,f=t.model,i=t._getCoordinate(n),r,u;f.enableContextMenu&&t._contextMenuHandler&&(r=Math.abs(t._posX1-i.pageX),u=Math.abs(t._posY1-i.pageY),(r<=10||u<=10)&&t._rightClick(n));t._contextMenuHandler=!1;t._ganttTouchEvent=!1},_contextMenuEventBinding:function(n){var t=this,i=t._getCoordinate(n);if(t._posX1=i.pageX,t._posY1=i.pageY,n.which!=3||t._ganttTouchEvent){if(t._ganttTouchEvent)return t._contextMenuHandler=!0,!0}else t._rightClick(n)},_rightClick:function(i){var l;i.preventDefault();var r=this,f=r.model,o=n(i.target),a=o.closest("tr"),s,v,e,h,y,u={},c;r._$treegridHelper.ejTreeGrid("disableTooltip");r.clearColumnMenu();n(a).hasClass("e-chartcell")||n(a).hasClass("e-ganttrowcell")?(s=r._$ganttchartHelper.ejGanttChart("getGanttChartRows"),c=f.viewType=="resourceView"?r._$ganttchartHelper.ejGanttChart("getRecordByTarget",i):null,u.target="ejTreeGrid"):(s=n(r._$treegridHelper.ejTreeGrid("getRows")),u.target="ejGanttChart");v=o.closest("tr");e=s.index(v);r.model.currentViewData=r.getCurrentViewData();h=r.model.currentViewData[e];e=r.model.updatedRecords.indexOf(h);u.data=c?c:h;u.recordIndex=e;u.data&&r.model.enableContextMenu?(r._contextMenuItems=[],r._contextMenuItems=r._getContextMenuItems(),r._updateIndentOutdentContextmenuOption(u.data),r._clearContextMenu(),f.selectionMode=="cell"&&(r._rowIndexOfLastSelectedCell=e,y=r._$treegridHelper.ejTreeGrid("getCellIndex",i),n(o.closest("td")).hasClass("e-chartcell")||r.selectCells([{rowIndex:e,cellIndex:y}],null,!1)),r._contextMenuItems.length>0&&(r.model.readOnly!=!0&&r.model.editSettings.allowAdding||(r._removeContextMenuItem("Below"),r._removeContextMenuItem("Above")),r._renderContextMenu(i,e,u.data)),f.viewType=="resourceView"&&(u.data.eResourceTaskType=="resourceChildTask"||u.data.eResourceTaskType=="unassignedTask")&&r._$ganttchartHelper.ejGanttChart("selectTaskbar",u.data),f.selectionMode=="row"&&(e!=r.model.selectedRowIndex&&r.rowSelected(u),f.selectionType==t.Gantt.SelectionType.Multiple&&(r._$treegridHelper.ejTreeGrid("instance")._multiSelectCtrlRequest=r._$ganttchartHelper.ejGanttChart("instance")._multiSelectCtrlRequest=!1,r._clearMultiSelectPopup()),r._$treegridHelper.ejTreeGrid("selectRows",e),r._$ganttchartHelper.ejGanttChart("selectRows",e),l=r._$treegridHelper.ejTreeGrid("instance"),f.selectedItems=l.model.selectedItems,f.selectedItem=l.model.selectedItem,r.selectedRowIndex(f.updatedRecords.indexOf(f.selectedItem)),r.updateIndentOutdentOption(f.selectedItem)),f.editSettings.beginEditAction=="click"&&n("#ejTreeGrid"+r._id+"EditForm").length>0&&(r._$treegridHelper.ejTreeGrid("saveCell"),r._isinBeginEdit=!1)):r.model.flatRecords.length===0&&r.model.enableContextMenu&&(r._contextMenuItems=[],r._contextMenuItems=r._getContextMenuItems(),r._contextMenuItems.splice(5,2),r._updateIndentOutdentContextmenuOption(u.data),r._clearContextMenu(),r._contextMenuItems.length>0&&r._renderContextMenu(i,e,u.data))},_mousedownhandler:function(t){var i=n(t.target),r=this;r._clearContextMenu();r.model.predecessorMapping&&r._$ganttchartHelper.ejGanttChart("closePredecessorDialog");(i.hasClass("e-vhandle")||i.hasClass("e-vscrollbar")||i.hasClass("e-vup")||i.hasClass("e-vdown")||i.hasClass("e-vhandlespace")||i.hasClass("e-hhandle")||i.hasClass("e-hscrollbar")||i.hasClass("e-hdown")||i.hasClass("e-hhandlespace")||i.hasClass("e-splitbar"))&&(r._clearMultiSelectPopup(),r.clearColumnMenu())},_removeContextMenuItem:function(n){var u=this,r,t=u._contextMenuItems,i;i=t.filter(function(t){if(t.menuId===n)return!0});i.length>0&&(r=t.indexOf(i[0]),t.splice(r,1))},_updateIndentOutdentContextmenuOption:function(n){var t=this,i=t.model,u=this.model.flatRecords,r=u.indexOf(n),f;t.model.readOnly==!0?(t._removeContextMenuItem("Add"),t._removeContextMenuItem("Task"),t._removeContextMenuItem("Delete"),t._removeContextMenuItem("Indent"),t._removeContextMenuItem("Outdent")):(r===0?(t._removeContextMenuItem("Indent"),t._removeContextMenuItem("Outdent")):r>0?n.level===0?t._removeContextMenuItem("Outdent"):(f=u[r-1],n.level-f.level==1&&t._removeContextMenuItem("Indent")):r<0&&!n&&(t._removeContextMenuItem("Task"),t._removeContextMenuItem("Delete"),t._removeContextMenuItem("Indent"),t._removeContextMenuItem("Outdent")),i.editSettings.allowAdding||t._removeContextMenuItem("Add"),i.editSettings.allowDeleting||t._removeContextMenuItem("Delete"),i.editSettings.allowEditing||t._removeContextMenuItem("Task"),i.editSettings.allowIndent||(t._removeContextMenuItem("Indent"),t._removeContextMenuItem("Outdent")),i.viewType=="resourceView"&&(t._removeContextMenuItem("Indent"),t._removeContextMenuItem("Outdent"),t._removeContextMenuItem("Above"),t._removeContextMenuItem("Below"),n&&(n.eResourceTaskType=="groupTask"||n.eResourceTaskType=="resourceTask")&&t._removeContextMenuItem("Task")))},queryTaskbarInfo:function(n){this._trigger("queryTaskbarInfo",n)},zoomingChart:function(n){var t=this;t.reRenderChart(n.delta)},refreshRowData:function(n){var i=this,r=i._$treegridHelper.ejTreeGrid("instance");t.TreeGrid.refreshRow(r,n.index)},expanding:function(n){var i=this;if(!i._trigger("expanding",n)){if(i._expandCollapseSettings.state="",i.model.enableVirtualization)t.TreeGrid.sendExpandCollapseRequest(i,n);else{if(i._isInExpandCollapse=!0,i._isRefreshAddedRecord){n.data.expanded=!0;i._$treegridHelper.ejTreeGrid("updateExpandStatus",n.data,!0);i._refreshChartAndGridRows();i._isRefreshAddedRecord=!1;return}t.TreeGrid.sendExpandCollapseRequest(i,n);i._isInExpandCollapse=!1}i.updateSelectedItemIndex()}},collapsing:function(i){var r=this,o=this.model,u=n("#"+r._id+"_toolbarItems"),f,e;if(!r._trigger("collapsing",i)){if(r._expandCollapseSettings.state="",r.model.enableVirtualization)t.TreeGrid.sendExpandCollapseRequest(r,i);else{if(r._isInExpandCollapse=!0,r._isRefreshAddedRecord){i.data.expanded=!1;r._$treegridHelper.ejTreeGrid("updateExpandStatus",i.data,!1);r._refreshChartAndGridRows();r._isRefreshAddedRecord=!1;return}r._gridRows=r.getRows();t.TreeGrid.sendExpandCollapseRequest(r,i);r._isInExpandCollapse=!1}f=r.selectedItem();f&&(e=r.getExpandStatus(f),e||i.expanded||i.model.selectedItems.length!=1?r.updateSelectedItemIndex():(r._deSelectRowItem(),o.toolbarSettings.showToolbar&&r.model.toolbarSettings.toolbarItems.indexOf("delete")!==-1&&(n(u).ejToolbar("disableItem",n(u).find(".e-deleteitem").parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("indent")!==-1&&n(u).ejToolbar("disableItem",n(u).find(".e-indent").parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("outdent")!==-1&&n(u).ejToolbar("disableItem",n(u).find(".e-outdent").parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("edit")!==-1&&n(u).ejToolbar("disableItem",n(u).find(".e-edititem").parent()[0]))))}},refreshRow:function(n){var t=this;t._$ganttchartHelper.ejGanttChart("refreshRow",n.recordIndex)},_enableEditingEvents:function(){var t=this,i=t.model;t._off(n("#"+t._id+"_dialogEdit"),"click keypress","#EditDialog_"+t._id+"_Save ,#EditDialog_"+t._id+"_Cancel,#EditDialog_"+t._id+"_Delete",t._buttonClick);t._off(n("#"+t._id+"_dialogAdd"),"click keypress","#AddDialog_"+t._id+"_Save ,#AddDialog_"+t._id+"_Cancel",t._buttonClick);(i.editSettings.allowEditing||i.editSettings.editMode=="dialogTemplate"||i.toolbarSettings.showToolbar&&(i.editSettings.allowAdding&&i.toolbarSettings.toolbarItems.indexOf("add")!==-1||i.editSettings.allowEditing&&i.toolbarSettings.toolbarItems.indexOf("index")!==-1))&&(t._on(n("#"+t._id+"_dialogEdit"),"click keypress","#EditDialog_"+t._id+"_Save ,#EditDialog_"+t._id+"_Cancel,#EditDialog_"+t._id+"_Delete",t._buttonClick),t._on(n("#"+t._id+"_dialogAdd"),"click keypress","#AddDialog_"+t._id+"_Save ,#AddDialog_"+t._id+"_Cancel",t._buttonClick))},cancelEditCell:function(){var t=this;n("#ejTreeGrid"+t._id+"EditForm").length>0&&t._$treegridHelper.ejTreeGrid("cancelEditCell")},_taskbarEditedCancel:function(n){this._updateOverlappingValues(n.parentItem);this._updateResourceParentItem(n);this.refreshGanttRecord(n.parentItem);this._updateSharedResourceTask(n);(!n.predecessor||n.predecessor&&n.predecessor.length==0)&&this._refreshGanttHeightWithRecords()},_keyPressed:function(){},_buttonClick:function(r){var u=this,f=u.model,e,s,o;return r.type!="click"&&r.keyCode!==i&&r.keyCode!=13?!0:(n(r.target).css("pointer-events","none"),f.editSettings.allowEditing||f.editSettings.editMode=="dialogTemplate"||f.toolbarSettings.showToolbar&&(f.editSettings.allowAdding&&f.toolbarSettings.toolbarItems.indexOf("add")!==-1||f.editSettings.allowEditing&&f.toolbarSettings.toolbarItems.indexOf("edit")!==-1)?r.target.id=="EditDialog_"+u._id+"_Save"?u.model.predecessorMapping?(e={},s={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},e.editMode="dialogEdit",e.data=this._editedDialogRecord,e.requestType="validateLinkedTask",e.validateMode=s,u._trigger("actionBegin",e)||(u._datePickerChangeEvent&&(this._editedDialogRecord.isAutoSchedule||f.validateManualTasksOnLinking)?(u._datePickerChangeEvent=!1,!f.enablePredecessorValidation||f.enablePredecessorValidation&&u._validateTypes(e)?u._sendSaveRequest("Edit")?n(r.target).css("pointer-events","auto"):(u._isAddEditDialogSave=!0,n("#"+u._id+"_dialogEdit").ejDialog("close")):n("#"+u._id+"_dialogEdit").ejDialog("close")):u._sendSaveRequest("Edit")?n(r.target).css("pointer-events","auto"):(u._isAddEditDialogSave=!0,n("#"+u._id+"_dialogEdit").ejDialog("close")))):u._sendSaveRequest("Edit")?n(r.target).css("pointer-events","auto"):(u._isAddEditDialogSave=!0,n("#"+u._id+"_dialogEdit").ejDialog("close")):r.target.id=="EditDialog_"+u._id+"_Cancel"?n("#"+u._id+"_dialogEdit").ejDialog("close"):r.target.id=="EditDialog_"+u._id+"_Delete"?(this.model.viewType=="resourceView"&&u._resourceEditedRecord&&u._resourceEditedRecord.eResourceTaskType=="resourceChildTask"?(o=this.deleteResourceChildTask(u._resourceEditedRecord),u._resourceEditedRecord=null):o=f.allowSelection!=!1||t.isNullOrUndefined(u._contextMenuSelectedIndex)?u._$treegridHelper.ejTreeGrid("deleteRow"):u._$treegridHelper.ejTreeGrid("deleteRow",null,!0,u._contextMenuSelectedIndex),o==!0?n(r.target).css("pointer-events","auto"):(u._isAddEditDialogSave=!0,n("#"+u._id+"_dialogEdit").ejDialog("close"))):r.target.id=="AddDialog_"+u._id+"_Save"?u._sendSaveRequest("Add")?n(r.target).css("pointer-events","auto"):this._duplicate||this._wrongenddate?n(r.target).css("pointer-events","auto"):(u._isAddEditDialogSave=!0,n("#"+u._id+"_dialogAdd").ejDialog("close")):r.target.id=="AddDialog_"+u._id+"_Cancel"&&n("#"+u._id+"_dialogAdd").ejDialog("close"):u._sendCancelRequest(),!1)},rowDrag:function(n){var t=this;t.model.selectedCellIndexes=[];t._trigger("rowDrag",n)},rowDragStart:function(n){var t=this;t._trigger("rowDragStart",n)},rowDragStop:function(n){var t=this;t._trigger("rowDragStop",n)},cellSelecting:function(n){var t=this,i=t.model;t._trigger("cellSelecting",n)},cellSelected:function(n){var t=this,i=t.model;t._trigger("cellSelected",n);i.selectedCellIndexes=t._$treegridHelper.ejTreeGrid("instance").model.selectedCellIndexes;t._rowIndexOfLastSelectedCell=i.selectedCellIndexes[0].rowIndex},rowSelecting:function(n){var u=this,i={},r=this.model;return u.model.rowSelecting&&r.selectionMode=="row"&&(i.recordIndex=n.recordIndex,i.previousIndex=n.previousIndex,i.previousData=r.updatedRecords[n.previousIndex],i.data=r.updatedRecords[n.recordIndex],i.previousChartRow=u._$ganttchartHelper.ejGanttChart("getRowByIndex",n.previousIndex),i.previousGridRow=t.TreeGrid.getRowByIndex(this,n.previousIndex),i.targetChartRow=u._$ganttchartHelper.ejGanttChart("getRowByIndex",n.recordIndex),i.targetGridRow=t.TreeGrid.getRowByIndex(this,n.recordIndex),r.selectedItems.length>1&&(i.selectedItems=r.selectedItems),u._trigger("rowSelecting",i))?!1:!0},_getCtrlRequestValue:function(t){var i=this,u=i.model,r=i._id,f=i._$treegridHelper.ejTreeGrid("instance"),e=i._$ganttchartHelper.ejGanttChart("instance");n("#"+r+"_selectionpopup").is(":visible")&&n("#"+r+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")&&u.selectionMode=="row"&&(t.ctrlKey=f._multiSelectCtrlRequest=e._multiSelectCtrlRequest=!0);t.requestType=="expandCollapse"&&(i._ganttTouchTrigger=!1)},_updateTouchCtrlFlag:function(n){var t=this,i=t.model;n.type=="touchstart"&&(t._ganttTouchTrigger=!0,t._ganttTouchEvent=!0)},_renderMultiSelectionPopup:function(){this._multiSelectPopup=t.buildTag("div.e-ganttpopup#"+this._id+"_selectionpopup","",{display:"none"});var n=t.buildTag("div.e-popupcontent"),i=t.buildTag("div.e-downtail e-tail"),r=t.buildTag("span.e-rowselect e-icon");n.append(r);this._multiSelectPopup.append(n);this._multiSelectPopup.append(i);this.element.append(this._multiSelectPopup)},_clearMultiSelectPopup:function(){var t=this,u=t.model,i=t._$treegridHelper.ejTreeGrid("instance"),r=t._$ganttchartHelper.ejGanttChart("instance");u.allowSelection&&t._multiSelectPopup&&t._multiSelectPopup.is(":visible")&&(n("#"+t._id+"_selectionpopup").find(".e-rowselect").removeClass("e-spanclicked"),t._multiSelectPopup.hide(),i._multiSelectCtrlRequest=r._multiSelectCtrlRequest=!1,t._ganttTouchTrigger=i._ganttTouchTrigger=r._ganttTouchTrigger=!1)},_alignMultiSelectPopup:function(){var t=this,u=n(t.element).offset().top+n(t.element).outerHeight(),f=n(t.element).offset().left+n(t.element).outerWidth(),i,r;(t._multiSelectPopup.offset().top+t._multiSelectPopup.outerHeight()+10>u||t._multiSelectPopup.offset().left+t._multiSelectPopup.outerWidth()>f)&&(i=n(t.element).offset().top+n(t.element).outerHeight()/2,r=n(t.element).offset().left+n(t.element).outerWidth()/2,n(t.element).find(".e-hscrollbar").length>0&&(i=i-n(t.element).find(".e-hscrollbar").outerHeight()),n(t.element).find(".e-vscrollbar").length>0&&(r=r-n(t.element).find(".e-vscrollbar").outerWidth()),t._multiSelectPopup.offset({top:i-this._multiSelectPopup.height()/2-5,left:r-this._multiSelectPopup.width()/2}))},rowSelected:function(i){var r=this,u=this.model,f=n("#"+r._id+"_toolbarItems"),o=r._$treegridHelper.ejTreeGrid("instance"),l=r._$ganttchartHelper.ejGanttChart("instance"),a,s,h,e,c;u.allowSelection&&(i.target=="ejTreeGrid"&&(l._multiSelectCtrlRequest=o._multiSelectCtrlRequest,r._$ganttchartHelper.ejGanttChart("selectRows",i.recordIndex,i.toIndex)),i.target=="ejGanttChart"&&(o._multiSelectCtrlRequest=l._multiSelectCtrlRequest,r._$treegridHelper.ejTreeGrid("selectRows",i.recordIndex,i.toIndex)),l._multiSelectCtrlRequest=o._multiSelectCtrlRequest=!1);a=i.recordIndex;u.selectedItems=o.model.selectedItems;u.selectedItem=o.model.selectedItem;this.selectedRowIndex(u.updatedRecords.indexOf(u.selectedItem));r.model.toolbarSettings.showToolbar&&i.requestType!="rowDragAndDrop"&&(r.model.readOnly==!0?(s=[],n(f).find(".e-deleteitem").parent()[0]&&s.push(n(f).find(".e-deleteitem").parent()[0]),n(f).find(".e-addnewitem").parent()[0]&&s.push(n(f).find(".e-addnewitem").parent()[0]),n(f).find(".e-edititem").parent()[0]&&s.push(n(f).find(".e-edititem").parent()[0]),n(f).ejToolbar("disableItem",s)):((r.model.toolbarSettings.toolbarItems.indexOf("indent")!==-1||r.model.toolbarSettings.toolbarItems.indexOf("outdent")!==-1)&&r.model.allowSelection&&(u.selectedItems.length>1?r._multipleIndentOutdentOption(u.selectedItems):r.updateIndentOutdentOption(u.selectedItem)),h=[],r.model.editSettings.allowDeleting&&r.model.allowSelection&&r.model.toolbarSettings.toolbarItems.indexOf("delete")!==-1&&u.selectedItems.length>0&&h.push(n(f).find(".e-deleteitem").parent()[0]),r.model.editSettings.allowAdding&&r.model.toolbarSettings.toolbarItems.indexOf("add")!==-1&&h.push(n(f).find(".e-addnewitem").parent()[0]),r.model.editSettings.allowEditing&&r.model.allowSelection&&u.editSettings.beginEditAction!="click"&&r.model.toolbarSettings.toolbarItems.indexOf("edit")!==-1&&u.selectedItems.length==1&&h.push(n(f).find(".e-edititem").parent()[0]),n(f).ejToolbar("enableItem",h)));e={};e.recordIndex=i.recordIndex;c=n.extend({},u.updatedRecords[i.recordIndex]);delete c.childRecords;delete c.parentItem;e.data=c;e.targetChartRow=r._$ganttchartHelper.ejGanttChart("getRowByIndex",i.recordIndex);e.targetGridRow=t.TreeGrid.getRowByIndex(this,i.recordIndex);u.selectedItems.length>1&&(e.selectedItems=u.selectedItems);u.allowSelection&&u.selectionMode=="row"&&r._trigger("rowSelected",e)},_multipleIndentOutdentOption:function(t){for(var e=this,r=!1,u=!1,i=n("#"+e._id+"_toolbarItems"),o=n(i).find(".e-indent").parent()[0],s=n(i).find(".e-outdent").parent()[0],f=0;f<t.length;f++)if(e.updateIndentOutdentOption(t[f]),n(n(i).find(".e-indent").parent()[0]).hasClass("e-disable")||(r=!0),n(n(i).find(".e-outdent").parent()[0]).hasClass("e-disable")||(u=!0),r&&n(i).ejToolbar("enableItem",o),u&&n(i).ejToolbar("enableItem",s),u&&r)break},updateIndentOutdentOption:function(i){var r=this,s=r.model.flatRecords,o=s.indexOf(i),h,u=n("#"+r._id+"_toolbarItems"),f=n(u).find(".e-indent").parent()[0],e=n(u).find(".e-outdent").parent()[0];o===0||r.model.editSettings.allowIndent==!1||r.model.readOnly==!0||!r.model.allowSelection||t.isNullOrUndefined(i)||o==-1?(f&&n(u).ejToolbar("disableItem",f),e&&n(u).ejToolbar("disableItem",e)):i.level===0&&r.model.editSettings.allowIndent==!0?(f&&n(u).ejToolbar("enableItem",f),e&&n(u).ejToolbar("disableItem",e)):(h=s[o-1],i.level-h.level==1&&r.model.editSettings.allowIndent==!0&&r.selectedRowIndex()!=-1?(e&&n(u).ejToolbar("enableItem",e),f&&n(u).ejToolbar("disableItem",f)):r.model.editSettings.allowIndent==!0&&r.selectedRowIndex()!=-1&&(f&&n(u).ejToolbar("enableItem",f),e&&n(u).ejToolbar("enableItem",e)))},_ganttChartRowHover:function(n){var t=this;n.reason=="mouseenter"?t._$treegridHelper.ejTreeGrid("addRowHover",n.index):n.reason=="mouseleave"&&t._$treegridHelper.ejTreeGrid("removeRowHover")},getExpandedRecordCount:function(n,t){var i,u=this,r;if(!n.hasChildRecords)return 0;for(r=0;r<n.childRecords.length;r++)i=n.childRecords[r],u.getExpandStatus(i)&&t++,i.hasChildRecords&&(t=u.getExpandedRecordCount(i,t));return t},_updateExpandStatus:function(){for(var i=this,t=this.model.flatRecords,r=t.length,u,n=0;n<r;n++)u=t[n].isExpanded,i.getExpandStatus(t[n])!==t[n].isExpanded&&(t[n].isExpanded=i.getExpandStatus(t[n]),t[n].isExpanded?i._totalCollapseRecordCount--:i._totalCollapseRecordCount++)},actionComplete:function(r){var u=this,f=u.model,a=null,w,b,c,l,e,o,v,s,y,h,p;if(u.model.updatedRecords=u.getUpdatedRecords(),u.model.currentViewData=u.getCurrentViewData(),u._gridRows=u.getRows(),u._ganttChartRows=u.getGanttChartRows(),u._totalCollapseRecordCount=u._$treegridHelper.ejTreeGrid("getCollapsedRecordCount"),(r.requestType==="searching"||r.requestType==="sorting"||r.requestType=="filtering")&&(u._isRefreshAddedRecord=!1,u._$ganttchartHelper.ejGanttChart("clearConnectorLines"),u._$ganttchartHelper.ejGanttChart("refreshHelper",u.model.currentViewData,u.model.updatedRecords,u._totalCollapseRecordCount),this._refreshConnectorLines(!1,!0,!0)),r.requestType=="sorting"&&u._deSelectRowItem(),r.requestType==="delete"){for(u._isRefreshAddedRecord=!1,this.dataSource(u._$treegridHelper.ejTreeGrid("getDataSource")),u._isDataManagerUpdate&&(this._jsonData=u._$treegridHelper.ejTreeGrid("getUpdatedDataManagerData")),u.model.flatRecords=u._$treegridHelper.ejTreeGrid("getFlatRecords"),u.model.ids=u._$treegridHelper.ejTreeGrid("getUpdatedIds"),u.model.updatedRecords=u.getUpdatedRecords(),f.selectedItem=null,this.selectedRowIndex(-1),u.model.selectedItems=[],u._$ganttchartHelper.ejGanttChart("instance")._prevSelectedItem=null,u._clearMultiSelectPopup(),w=0,b=0,c=0;c<r.deletedItems.length;c++)r.data=r.deletedItems[c],(t.isNullOrUndefined(r.data.parentItem)||r.data.parentItem&&f.flatRecords.indexOf(r.data.parentItem)!=-1)&&(f.parentRecords.indexOf(r.data)!==-1&&f.parentRecords.splice(f.parentRecords.indexOf(r.data),1),r.data.hasChildRecords&&u._removeChildRecordsPredecessor(r.data),!r.isDragAndDropDelete&&u._isTriggerActionComplete&&r.data.predecessor&&u._removePredecessor(r.data.predecessor,r.data),r.data.parentItem&&(l=r.data.parentItem,r.data.parentItem.childRecords&&r.data.parentItem.childRecords.length>0?r.data.eResourceTaskType=="resourceTask"?u._updateResourceParentItem(r.data):r.data.parentItem.isAutoSchedule?u._updateParentItem(r.data):r.data.parentItem.isAutoSchedule||u._updateManualParentItem(r.data):(l.expanded=!1,l.hasChildRecords=!1,u.refreshGanttRecord(l))));if(f.viewType=="resourceView"&&(f.parentRecords=r.model.parentRecords.slice()),r.isDragAndDropDelete)return;u.model.predecessorMapping&&u._refreshConnectorLines(!1,!0,!1);this.isCriticalPathEnable==!0&&this.showCriticalPath(!0,!0);u._$ganttchartHelper.ejGanttChart("refreshHelper",u.getCurrentViewData(),u.getUpdatedRecords(),u._totalCollapseRecordCount);u._updateToolbarOptions();u.updateAltRow(u.getUpdatedRecords(),0,1);this.isCriticalPathEnable==!0&&u._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId)}if(r.requestType==="selection"&&u._$ganttchartHelper.ejGanttChart("selectRows",r.recordIndex),r.requestType==="rowHover"&&u._$ganttchartHelper.ejGanttChart("addRowHover",r.index),r.requestType==="scroll"&&u._$ganttchartHelper.ejGanttChart("onScrollHelper",r.delta),r.requestType=="dragAndDrop"&&(f.parentRecords=u._$treegridHelper.ejTreeGrid("instance").model.parentRecords,u._isRefreshAddedRecord=!1,this.dataSource(u._$treegridHelper.ejTreeGrid("getDataSource")),u._isDataManagerUpdate&&(this._jsonData=u._$treegridHelper.ejTreeGrid("getUpdatedDataManagerData")),f.flatRecords=u._$treegridHelper.ejTreeGrid("getFlatRecords"),f.ids=u._$treegridHelper.ejTreeGrid("getUpdatedIds"),f.updatedRecords=u.getUpdatedRecords(),e=r.draggedRow.parentItem,r.droppedPosition=="insertAsChild"&&e&&(e.taskType=t.Gantt.TaskType.FixedDuration,e.effortDriven="false"),f.predecessorMapping&&(r.isFromRevertDragging&&u._addRemovedPredecessor(r.clonedTarget),r.droppedPosition=="insertAsChild"&&(e.predecessor&&u._removePredecessor(e.predecessor,e),e.item[f.predecessorMapping]=i,e.predecessorsName=i,e.predecessor=i,f.enableSerialNumber&&u._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",e)),u._refreshConnectorLines(!1,!0,!1)),r.draggedRow.parentItem&&r.draggedRow.parentItem.isAutoSchedule?u._updateParentItem(r.draggedRow):r.draggedRow.parentItem&&!r.draggedRow.parentItem.isAutoSchedule&&u._updateManualParentItem(r.draggedRow),o=r.previousParentItem?this._getRecordByTaskId(r.previousParentItem.taskId.toString()):null,o&&o.childRecords&&o.childRecords.length>0&&(o.isAutoSchedule?u._updateParentItem(o.childRecords[0]):o.isAutoSchedule||u._updateManualParentItem(o.childRecords[0])),this.isCriticalPathEnable==!0&&this.showCriticalPath(!0,!0),r.draggedRow&&u._$ganttchartHelper.ejGanttChart("refreshHelper",u.getCurrentViewData(),u.getUpdatedRecords(),u._totalCollapseRecordCount),this.isCriticalPathEnable==!0&&u._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId)),r.requestType==="save"&&(r._cAddedRecord?(v=-1,v=f.viewType=="resourceView"&&r._cAddedRecord.eResourceTaskType=="resourceChildTask"?f.updatedRecords.indexOf(r._cAddedRecord.parentItem):f.updatedRecords.indexOf(r._cAddedRecord),f.enableWBS&&f.enableWBSPredecessor&&f.predecessorMapping&&f.viewType=="projectView"&&u._$treegridHelper.ejTreeGrid("updateWBSPredecessor",r._cAddedRecord),u._renderAddedRow(r.index,r._cAddedRecord),r._cAddedRecord.parentItem&&r._cAddedRecord.parentItem.isAutoSchedule&&r._cAddedRecord.parentItem.eResourceTaskType!="resourceTask"?u._updateParentItem(r._cAddedRecord):r._cAddedRecord.parentItem&&!r._cAddedRecord.parentItem.isAutoSchedule&&r._cAddedRecord.parentItem.eResourceTaskType!="resourceTask"&&u._updateManualParentItem(r._cAddedRecord),f.enableAltRow&&t.TreeGrid.updateAltRow(u,f.currentViewData[0],0,0),f.selectionType==t.Gantt.SelectionType.Multiple&&(u._$treegridHelper.ejTreeGrid("instance")._multiSelectCtrlRequest=u._$ganttchartHelper.ejGanttChart("instance")._multiSelectCtrlRequest=!1),u.selectRows(v),a=r._cAddedRecord,f.enableVirtualization||(s={},s.index=s.recordIndex=f.currentViewData.indexOf(r._cAddedRecord),u.refreshRowData(s),u.refreshRow(s))):r._cModifiedData&&(r._cModifiedData.hasChildRecords&&r._cModifiedData.isAutoSchedule?(r._cModifiedData.startDate=u._checkStartDate(r._cModifiedData.manualStartDate,r._cModifiedData),r._cModifiedData.left=r._cModifiedData._calculateManualLeft(this),r._cModifiedData.width=r._cModifiedData._calculateManualWidth(this),r._cModifiedData.progressWidth=r._cModifiedData._getProgressWidth(r._cModifiedData.width,r._cModifiedData.status),r._cModifiedData.endDate=r._cModifiedData.manualEndDate,r._cModifiedData._calculateDuration(this)):r._cModifiedData.hasChildRecords&&!r._cModifiedData.isAutoSchedule?(r._cModifiedData.left=r._cModifiedData._calculateLeft(this),r._cModifiedData.width=r._cModifiedData._calculateWidth(this),r._cModifiedData._calculateDuration(this),r._cModifiedData.manualStartDate=r._cModifiedData.startDate,r._cModifiedData.manualEndDate=r._cModifiedData.endDate,u._updateManualParentItem(r._cModifiedData,null,!0)):(r._cModifiedData.startDate=u._checkStartDate(r._cModifiedData.startDate,r._cModifiedData),t.isNullOrUndefined(r._cModifiedData.startDate)||t.isNullOrUndefined(r._cModifiedData.duration)||(r._cModifiedData.endDate=u._getEndDate(r._cModifiedData.startDate,r._cModifiedData.duration,r._cModifiedData.durationUnit,r._cModifiedData)),r._cModifiedData.left=r._cModifiedData._calculateLeft(this),r._cModifiedData.width=r._cModifiedData._calculateWidth(this),r._cModifiedData.progressWidth=r._cModifiedData._getProgressWidth(r._cModifiedData.width,r._cModifiedData.status)),f.enableWBS&&f.enableWBSPredecessor&&f.predecessorMapping&&u._$treegridHelper.ejTreeGrid("updateWBSPredecessor",r._cModifiedData),f.viewType==t.Gantt.ViewType.ProjectView&&u.refreshGanttRecord(r._cModifiedData),r._cModifiedData.parentItem&&r._cModifiedData.parentItem.isAutoSchedule&&r._cModifiedData.parentItem.eResourceTaskType!="resourceTask"?u._updateParentItem(r._cModifiedData):r._cModifiedData.parentItem&&!r._cModifiedData.parentItem.isAutoSchedule&&r._cModifiedData.parentItem.eResourceTaskType!="resourceTask"?u._updateManualParentItem(r._cModifiedData):r._cModifiedData.parentItem&&r._cModifiedData.parentItem.eResourceTaskType=="resourceTask"&&(y=r._cModifiedData.parentItem.eOverlapIndex,this._updateOverlappingValues(r._cModifiedData.parentItem),this._updateResourceParentItem(r._cModifiedData)),f.viewType==t.Gantt.ViewType.ResourceView&&(r._cModifiedData.eResourceTaskType=="resourceChildTask"?u.refreshGanttRecord(r._cModifiedData.parentItem):r._cModifiedData.eResourceTaskType=="unassignedTask"&&(t.isNullOrUndefined(r._cModifiedData.resourceInfo)||r._cModifiedData.resourceInfo&&r._cModifiedData.resourceInfo.length==0)&&u.refreshGanttRecord(r._cModifiedData)),r._cModifiedData.eResourceTaskType=="resourceChildTask"&&(this._updateSharedResourceTask(r._cModifiedData),u._previousResource&&u._previousResource.length>0&&this._updateSharedResourceTask(r._cModifiedData,null,u._previousResource)),f.viewType==t.Gantt.ViewType.ResourceView&&u._updateResource(u._previousResource,r._cModifiedData.resourceInfo,r._cModifiedData),r._cModifiedData.eResourceTaskType=="resourceChildTask"&&(y!=r._cModifiedData.parentItem.eOverlapIndex||this._isOverlapIndexChanged)&&(this._refreshGanttHeightWithRecords(),this._isOverlapIndexChanged=!1),r._cModifiedData.predecessor&&r.previousValue&&u._removeConnectorLine(r.previousValue,r._cModifiedData)),u.model.predecessorMapping&&(u._isValidationEnabled=r._cModifiedData&&r._cModifiedData.predecessor?!0:!1,r._cAddedRecord?(r._cAddedRecord.predecessor&&(u._isPredecessorEdited=!0,u._validatePredecessorDates(r._cAddedRecord),u._addConnectorLine(r._cAddedRecord),u._isPredecessorEdited=!1),u._refreshConnectorLines(!1,!0,!1)):r._cModifiedData&&(r.previousValue&&u._removeConnectorLine(r.previousValue,r._cModifiedData),u._addConnectorLine(r._cModifiedData),r._cModifiedData.predecessor&&(u._isUpdateOffset&&(u._editedTaskBarItem=r._cModifiedData),u._isMileStoneEdited=r._cModifiedData.isMilestone,u._updatedConnectorLineCollection=[],u._connectorlineIds=[],u._validatePredecessor(r._cModifiedData,r.previousValue),u._isUpdateOffset&&(u._editedTaskBarItem=null),u._updatedConnectorLineCollection.length>0&&f.viewType=="projectView"&&(u._$ganttchartHelper.ejGanttChart("appendConnectorLine",u._updatedConnectorLineCollection),this._updateConnectorLineCollection(u._updatedConnectorLineCollection))),r._cModifiedData.parentItem&&r._cModifiedData.parentItem.isAutoSchedule&&r._cModifiedData.parentItem.eResourceTaskType!="resourceTask"?u._updateParentItem(r._cModifiedData):r._cModifiedData.parentItem&&!r._cModifiedData.parentItem.isAutoSchedule&&r._cModifiedData.parentItem.eResourceTaskType!="resourceTask"&&u._updateManualParentItem(r._cModifiedData))),r._cModifiedData&&r._cModifiedData.hasChildRecords&&!r._cModifiedData.isAutoSchedule&&r.previousStartDate&&u._compareDates(r.previousStartDate,r._cModifiedData.startDate)!=0&&(h={},h.previousData=n.extend({},r._cModifiedData),h.previousData.startDate=r.previousStartDate,h.data=r._cModifiedData,u._validateAutoChildRecords(h)),this.isCriticalPathEnable==!0&&(u._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0))),r.requestType==="validatePredecessor"||r.requestType==="validateSerialPredecessor"){p=r.requestType==="validateSerialPredecessor"?u._editedPredecessorValidation(r,!0):u._editedPredecessorValidation(r);r.result=p;return}u._isTriggerActionComplete&&(f.viewType=="resourceView"&&r.requestType=="delete"&&(r.data&&r.data.eResourceTaskType=="groupTask"?r.requestType="groupDelete":r.data&&r.data.eResourceTaskType=="resourceTask"&&(r.requestType="resourceDelete")),u._ganttActionCompleteTrigger(r));a&&u.focusOnTask(a)},_addRemovedPredecessor:function(n){var u=this,r=n.predecessor,e=r.length,i=-1,f=u.model,t;for(i;i<e;i++)i==-1?t=this._getRecordByTaskId(n.taskId.toString()):r[i].from!==n.taskId.toString()?t=this._getRecordByTaskId(r[i].from):r[i].to!==n.taskId.toString()&&(t=this._getRecordByTaskId(r[i].to)),t&&(i==-1?t.predecessor=r:t.predecessor.push(r[i]),t&&(t.item[f.predecessorMapping]=u._predecessorToString(t.predecessor,t),t.predecessorsName=t.item[f.predecessorMapping],this._updateResourcePredecessor(t),f.enableWBS&&f.enableWBSPredecessor&&u._$treegridHelper.ejTreeGrid("updateWBSPredecessor",t),f.enableSerialNumber&&u._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",t),u.refreshGanttRecord(t)))},_updateResource:function(i,r,u,f){var o=this,h=o.model,k=h.ids,d=h.flatRecords,v=r?r.length:0,it=i?i.length:0,ut=o.dataSource(),g=u.predecessor,nt=u.predecessorsName,b=null,e,y,l,s,p,tt,c,w,a;if(v!=0||it!=0){for(c=0;c<v;c++)y=r[c][h.resourceIdMapping],l=n.map(i,function(n,t){if(n[h.resourceIdMapping]==y)return t}),l.length==0?(s=d[k.indexOf("R_"+y)],b||(b=o._createGanttRecord(u.item,s.level+1)),s&&(e=new t.Gantt.GanttRecord,e=n.extend(!0,e,b),e.eResourceTaskType="resourceChildTask",e.parentItem=s,e.predecessor=n.extend([],g),e.predecessorsName=nt,s.eResourceChildTasks.push(e),this._updateResourceUniqIndex(e),o._isFlatResourceData||(s.item[h.taskCollectionMapping]||(s.item[h.taskCollectionMapping]=[]),s.item[h.taskCollectionMapping].push(e.item)),this._resourceChildTasks.push(e),this._updateOverlappingValues(e.parentItem),this._updateResourceParentItem(e),o.refreshGanttRecord(e.parentItem),this._updateSharedResourceTask(e),this._refreshGanttHeightWithRecords(),f&&(f.data=e))):(i.splice(l[0],1),p={},p.resourceInfo=u.resourceInfo,p.resourceNames=u.resourceNames,this._updateSharedResourceTask(u,p));for(tt=i?i.length:0,c=0;c<tt;c++){var rt=u.taskId,y=i[c][h.resourceIdMapping],s=d[k.indexOf("R_"+y)],l=n.map(s.eResourceChildTasks,function(n,t){if(n.taskId==rt)return t});l.length&&(w=s.eResourceChildTasks[l[0]],this._removeResourceChildTask(w),s.eResourceChildTasks.splice(l[0],1),this._updateOverlappingValues(s),this._updateResourceParentItem(w),o.refreshGanttRecord(s),this._updateSharedResourceTask(w),this._refreshGanttHeightWithRecords())}u.eResourceTaskType=="unassignedTask"&&v>0&&(o._isTriggerActionComplete=!1,o._$treegridHelper.ejTreeGrid("deleteRow",null,!0,h.updatedRecords.indexOf(u)),e&&(this._resourceUniqTaskIds.push(e.taskId.toString()),this._resourceUniqTasks.push(e),this._insertDataInDataSource(e.item)),o._isTriggerActionComplete=!0);u.eResourceTaskType=="resourceChildTask"&&v==0&&(o._isTriggerActionComplete=!1,o._isOnResourceUpdate=!0,o.addRecord(u.item,"bottom"),o._isOnResourceUpdate=!1,a=h.updatedRecords[h.updatedRecords.length-1],f&&(f.data=a),a&&(a.predecessor=n.extend([],g),a.predecessorsName=nt,this._updateResourceUniqIndex(a)),o._isTriggerActionComplete=!0)}},_removeResourceInfo:function(n,t){var o=this.model,r,u,f,e,i;if(n.resourceInfo&&n.resourceInfo.length>1){if(r=this._getExistingTaskWithID(n,!0),r==null)return;for(f=0;f<r.length;f++)for(u=r[f],e=u.resourceInfo,i=0;i<e.length;i++)if(e[i][this.model.resourceIdMapping]==t){e.splice(i,1);this._updateResourceName(u);this._updateResourceRelatedFields(u);break}}},_updateResourceUniqIndex:function(n){var t=this._resourceUniqTaskIds.indexOf(n.taskId.toString());t!=-1?this._resourceUniqTasks[t]=n:(this._resourceUniqTaskIds.push(n.taskId.toString()),this._resourceUniqTasks.push(n))},focusOnTask:function(n){var r=this,o=r.model,s=r.element.find(".e-ganttviewerbodyContianer"),u=s.ejScroller("instance"),f=n&&n.left?n.left:o.updatedRecords[n]?o.updatedRecords[n].left:0,h=u.model.width,i=u.model.scrollLeft,e=u._hScrollbar,t;e&&(e.model.maximum<i&&(i=e.model.maximum),(i>f||i+h<f)&&(t=f-h/2,t=t<0?0:t,s.ejScroller("scrollX",t,!0)));r._$ganttchartHelper.ejGanttChart("updateScrollBar")},calculateEndDate:function(n){var t=this,i=this._getEndDate(t._checkStartDate(n.startDate,n.record),n.duration,n.durationUnit,n.record);t._$ganttchartHelper.ejGanttChart("updateEditedRecordEndDate",t._checkEndDate(i,n.record))},calculateDuration:function(n){var t=this,i=this._getDuration(t._checkStartDate(n.startDate,n.record),t._checkEndDate(n.endDate,n.record),n.durationUnit,n.record.isAutoSchedule);t._$ganttchartHelper.ejGanttChart("updateEditedRecordDuration",i)},expandAllCollapseAllRequest:function(t){var r=this,i=n(r.element),u=i.ejGantt("instance"),f=i.attr("id");u._toolbarOperation(f+"_"+t.requestType)},setChartScrollLeft:function(n){t.isNullOrUndefined(n)||this._$ganttchartHelper.ejGanttChart("setScrollLeft",n)},chartactionComplete:function(n){var r=this,f=this.model,e,s,u,h,o;r.model.updatedRecords=r.getUpdatedRecords();r.model.currentViewData=r.getCurrentViewData();n.requestType==="updateConnectors"&&(r.model.predecessorMapping&&(e=n.ganttRecord,r._isMileStoneEdited=e.isMilestone,r._updatedConnectorLineCollection=[],r._connectorlineIds=[],r._editedTaskBarItem=e,r._validatePredecessor(e),r._updatedConnectorLineCollection.length>0&&(r._$ganttchartHelper.ejGanttChart("appendConnectorLine",r._updatedConnectorLineCollection),this._updateConnectorLineCollection(r._updatedConnectorLineCollection)),r._editedTaskBarItem=null),f.viewType=="resourceView"&&n.ganttRecord.eResourceTaskType=="resourceChildTask"&&this._refreshGanttHeightWithRecords());n.requestType==="rowHover"&&r._$treegridHelper.ejTreeGrid("addRowHover",n.index);n.requestType==="scroll"&&n.scrollDirection=="vertical"&&(r._isTreeGridRendered=!1,r._isGanttChartRendered=!1,n.vscrollExsist&&n.delta!==i&&r._$treegridHelper.ejTreeGrid("onScrollHelper",n.delta),r.model.updatedRecords=r.getUpdatedRecords(),r.model.currentViewData=r.getCurrentViewData(),r.model.enableVirtualization&&r.model.predecessorMapping&&r._refreshConnectorLines(!1,!0,!1),r._isTreeGridRendered=!0,r._isGanttChartRendered=!0);n.requestType==="selection"&&r._$treegridHelper.ejTreeGrid("selectRows",n.recordIndex);n.requestType==="validatePredecessor"&&(s=r._editedPredecessorValidation(n),n.predecessorValidation=s);n.requestType==="drawConnectorLine"&&(u=n.toItem._calculatePredecessor(n.predecessor,this._durationUnitEditText,this.model.durationUnit,r),n.toItem.item[r.model.predecessorMapping]=n.predecessorString[0],n.toItem.predecessorsName=n.toItem.item[r.model.predecessorMapping],f.enableWBS&&f.enableWBSPredecessor&&r._$treegridHelper.ejTreeGrid("updateWBSPredecessor",n.toItem),f.enableSerialNumber&&r._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",n.toItem),n.fromItem.predecessor?n.fromItem.predecessor.push(u[0]):n.fromItem.predecessor=u,n.toItem.predecessor?n.toItem.predecessor.push(u[0]):(n.toItem.predecessor=[],n.toItem.predecessor.push(u[0])),r._isMileStoneEdited=n.toItem.isMilestone,r._updatedConnectorLineCollection=[],r._connectorlineIds=[],r._isValidationEnabled=r.model.enablePredecessorValidation&&(n.toItem.isAutoSchedule||r.model.validateManualTasksOnLinking)?!0:!1,r._isPredecessorEdited=!0,r._validatePredecessor(n.toItem),r._isPredecessorEdited=!1,r._updatedConnectorLineCollection.length>0&&(r._$ganttchartHelper.ejGanttChart("appendConnectorLine",r._updatedConnectorLineCollection),this._updateConnectorLineCollection(r._updatedConnectorLineCollection)),n.toItem.isAutoSchedule||r.model.validateManualTasksOnLinking||(h=r._$treegridHelper.ejTreeGrid("instance"),t.TreeGrid.refreshRow(h,r.model.currentViewData.indexOf(n.toItem))),o={},o.data=n.toItem,r._updateScheduleDatesOnEditing(o),this.isCriticalPathEnable==!0&&(r._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0)));r._ganttActionCompleteTrigger(n)},hideColumn:function(n){var t=this;t._$treegridHelper.ejTreeGrid("hideColumn",n)},showColumn:function(n){var t=this;t._$treegridHelper.ejTreeGrid("showColumn",n)},clearColumnMenu:function(){var n=this;n._$treegridHelper.ejTreeGrid("clearColumnMenu")},deleteRow:function(){var n=this;n._$treegridHelper.ejTreeGrid("deleteRow")},taskbarEditing:function(n){this._trigger("taskbarEditing",n)},setInitialData:function(){this._setInitialData()},sortColumn:function(n,t){var i=this;i._$treegridHelper.ejTreeGrid("sortColumn",n,t)},clearSorting:function(){var n=this,t=n.model;n._$treegridHelper.ejTreeGrid("clearSorting")},"export":function(i,r,u){var f=this,s=f.model,h,e,l;if(f._$treegridHelper.ejTreeGrid("contextMenuOperations","Cancel"),h={action:i,method:"post","data-ajax":"false"},n("form#"+f._id+"export").remove(),e=t.buildTag("form#"+f._id+"export","",null,h),t.raiseWebFormsServerEvents){var o=f._getExportModel(s),c={durationText:f._durationUnitTexts,quarterYearTexts:f._quarterYearTexts,halfYearTexts:f._halfYearTexts,durationEditText:f._durationUnitEditText,taskTypeTexts:f._taskTypeTexts,effortDrivenTexts:f._effortDrivenTexts,taskModeTexts:f._taskModeTexts,nullText:f._nullText},a={model:o,originalEventType:r},v={model:JSON.stringify(o),locale:JSON.stringify(c)};t.raiseWebFormsServerEvents(r,a,v)}else{if(l={},u)n("body").find(".e-gantt").each(function(i,r){var o=n(r).data("ejGantt"),s,u,h,c;t.isNullOrUndefined(o)||(s=o.model,u=f._getExportModel(s),l[i]=JSON.stringify(u),h={name:"GanttModel",type:"hidden",value:JSON.stringify(u)},c=t.buildTag("input","",null,h),e.append(c))});else{var o=f._getExportModel(s),y={name:"GanttModel",type:"hidden",value:JSON.stringify(o)},p=t.buildTag("input","",null,y);e.append(p);e.append(this)}var c={durationText:f._durationUnitTexts,quarterYearTexts:f._quarterYearTexts,halfYearTexts:f._halfYearTexts,durationEditText:f._durationUnitEditText,taskTypeTexts:f._taskTypeTexts,effortDrivenTexts:f._effortDrivenTexts,taskModeTexts:f._taskModeTexts,nullText:f._nullText},w={name:"locale",type:"hidden",value:JSON.stringify(c)},b=t.buildTag("input","",null,w);e.append(b);n("body").append(e);e.submit()}return!0},_getExportModel:function(n){var h=this,r=n,p=r.updatedRecords,w=r.currentViewData,b=r.flatRecords,k=r.parentRecords,d=r.selectedItem,g=r.selectedItems,nt=r.workUnit,tt=r.updatedGanttRecords,f,e,v,s,c,o,l,a,y,u;for(r.criticalTask=h.criticalPathCollection.join(),delete r.updatedRecords,delete r.currentViewData,delete r.flatRecords,delete r.parentRecords,delete r.selectedItem,delete r.selectedItems,delete r.workUnit,delete r.updatedGanttRecords,f=JSON.parse(JSON.stringify(r)),r.updatedRecords=p,r.currentViewData=w,r.flatRecords=b,r.parentRecords=k,r.selectedItem=d,r.selectedItems=g,r.workUnit=nt,r.updatedGanttRecords=tt,e=f.columns,v=e.length,u=0;u<v;u++)if(f.columns[u].editType!=i)switch(e[u].editType){case"stringedit":e[u].editType="string";break;case"numericedit":e[u].editType="numeric";break;case"dropdownedit":e[u].editType="dropdown";break;case"booleanedit":e[u].editType="boolean"}if(s=f.filterSettings.filteredColumns,c=s.length,c>0)for(u=0;u<c;u++)o=s[u].field,l=t.TreeGrid.getColumnByField(h._columns,o),l!=null&&(o=o!="resourceNames"&&o!="predecessorsName"?l.mappingName:o),r.filterSettings.filteredColumns[u].field=o,s[u].operator=="equal"?s[u].operator="equals":f.filterSettings.filteredColumns[u].operator=="notequal"&&(s[u].operator="notequals");if(a=h.ignoreOnExport,y=a.length,this.ignoreOnExport)for(u=0;u<y;u++)delete f[a[u]];return f},_refreshParent:function(n){this.refreshGanttRecord(n);n.parentItem&&this._refreshParent(n.parentItem)},_getDefaultTZOffset:function(){var n=new Date((new Date).getFullYear(),0,1),t=new Date((new Date).getFullYear(),6,1);return Math.max(n.getTimezoneOffset(),t.getTimezoneOffset())},_isInDst:function(n){return n.getTimezoneOffset()<this._getDefaultTZOffset()},_getDateByLeft:function(n){var u=this,i=new Date(this._projectStartDate),r=864e5/this._perDayWidth;return i.setTime(i.getTime()+n*r),(this.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week||this.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Month||this.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Year||this.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.QuarterYear||this.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.HalfYear)&&(this._isInDst(this._projectStartDate)&&!this._isInDst(i)?i.setTime(i.getTime()+36e5):!this._isInDst(this._projectStartDate)&&this._isInDst(i)&&i.setTime(i.getTime()-36e5)),i},_getRoundOffStartLeft:function(n,r){var o=this,c=o.model,s=n.left,u=c.scheduleHeaderSettings.scheduleHeaderType,f=t.Gantt.ScheduleHeaderType,e=n.left%o._perDayWidth,h=e/o._perDayWidth;return r==i&&(r=!1),r?r&&(u==f.Week||u==f.Month||u==f.Year||u==f.QuarterYear||u==f.HalfYear?s=n.left-e:u==f.Day?(e=n.left%o._perHourWidth,h=e/o._perHourWidth,s=n.left-e):u==f.Hour&&(e=n.left%o._perMinuteWidth,h=e/o._perMinuteWidth,s=n.left-e)):(u==f.Week||u==f.Month||u==f.Year||u==f.QuarterYear||u==f.HalfYear)&&(h<=.5?s=n.left-e:h>.5&&(s=n.left-e+o._perDayWidth/2)),s},_getRoundOffEndLeft:function(n,r){var c=this,e=c.model,o=e.scheduleHeaderSettings.scheduleHeaderType,s=t.Gantt.ScheduleHeaderType,u=n.width+n.left,f=u%e.perDayWidth,h=f/e.perDayWidth;return r==i&&(r=!1),r?r&&((o==s.Week||o==s.Month||o==s.Year||o==s.QuarterYear||o==s.HalfYear)&&f!=0&&(u=u-f+e.perDayWidth),o==s.Day&&(f=u%e.perHourWidth,h=f/e.perHourWidth,f!=0&&(u=u-f+e.perHourWidth)),o==s.Hour&&(f=u%e.perMinuteWidth,h=f/e.perMinuteWidth,f!=0&&(u=u-f+e.perMinuteWidth))):(o==s.Week||o==s.Month||o==s.Year||o==s.QuarterYear||o==s.HalfYear)&&(h==0?u=u:h>.5?u=u-f+e.perDayWidth:h<.5&&(u=u-f+e.perDayWidth/2)),u},taskbarEdited:function(i){var u=this,r=i.data,f=u.model,c=new Date(u._projectStartDate),h,nt=f.scheduleHeaderSettings.scheduleHeaderType,tt=t.Gantt.ScheduleHeaderType,lt=t.Gantt.DurationUnit,it,st,v=!1,rt=!1,at=u.dataSource(),ut,p,e,ht,w,s,b,y,ct,o,a,ft,k,et,ot,l,d,g;if(u._isValidationEnabled=!1,i.dragging){if(l="dragging",i.previousData.left!==r.left&&(h=u._getRoundOffStartLeft(r,i.roundOffDuration),c=u._getDateByLeft(h),!t.isNullOrUndefined(r.endDate)&&t.isNullOrUndefined(r.startDate)?(ut=u._checkStartDate(c,r,null),r.endDate=u._checkEndDate(ut,r),f.endDateMapping&&(r.item[f.endDateMapping]=r.endDate)):(r.startDate=u._checkStartDate(c,r),t.isNullOrUndefined(r.duration)||r._calculateEndDate(u),f.startDateMapping&&(r.item[f.startDateMapping]=r.startDate)),r.left=r._calculateLeft(this),r.width=r._calculateWidth(this),r.hasChildRecords||(r.progressWidth=r._getProgressWidth(r.width,r.status)),u._isValidationEnabled=!0),u.model.viewType=="resourceView"&&this.model.allowDragAndDrop)for(y=-1,st=n.extend(!0,[],r.resourceInfo),p=r.top,e=this.model.currentViewData,ht=e.indexOf(r),ct=r.eResourceTaskType,y=this.model.updatedRecords.indexOf(r),o=0;o<e.length;o++)if(w=e[o].eOverlapIndex*this.model.rowHeight,u.getExpandStatus(e[o]))if(p>w)p-=w;else{v=u._checkSharedTasks(r,e[o]);e[o].eResourceTaskType!="groupTask"&&e[o].eResourceTaskType!="unassignedTask"&&r.eResourceTaskType=="unassignedTask"&&o!=e.indexOf(r)&&y!=-1&&(u._isTriggerActionComplete=!1,u._$treegridHelper.ejTreeGrid("deleteRow",null,!0,y));e[o].eResourceTaskType=="resourceTask"&&(i.assignedResource=e[o].item,(r.eResourceTaskType=="unassignedTask"||r.parentItem&&r.parentItem.taskId!=e[o].taskId)&&(r.parentItem&&(s=r.parentItem,a=e.indexOf(s),b=e[a].eResourceChildTasks,ft=b.indexOf(r),b.splice(ft,1),k=s.taskId,u._isFlatResourceData||e[a].item[f.taskCollectionMapping]&&e[a].item[f.taskCollectionMapping].splice(e[a].item[f.taskCollectionMapping].indexOf(r.item),1)),v?this._removeResourceInfo(v,k):(e[o].eResourceChildTasks.push(r),r.parentItem=e[o],r.eResourceTaskType=="unassignedTask"&&(this._resourceChildTasks.push(r),this._resourceUniqTaskIds.push(r.taskId.toString()),this._resourceUniqTasks.push(r),this._insertDataInDataSource(r.item)),r.eResourceTaskType="resourceChildTask",u._updateResourceParentItem(r),u._updateResourceResourceDetails(r,k),u._isFlatResourceData||(e[o].item[f.taskCollectionMapping]||(e[o].item[f.taskCollectionMapping]=[]),e[o].item[f.taskCollectionMapping].push(r.item)))));t.isNullOrUndefined(s)||(s.isAutoSchedule&&s.eResourceTaskType!="resourceTask"?u._updateParentItem(r):s.isAutoSchedule||s.eResourceTaskType=="resourceTask"?s.eResourceTaskType=="resourceTask"&&(et=s.eOverlapIndex,this._updateOverlappingValues(s),this.refreshGanttRecord(s),t.isNullOrUndefined(s.parentItem)||u._updateResourceParentItem(s.parentItem),rt=et!=s.eOverlapIndex):u._updateManualParentItem(r));this._updateResourceName(r);this._updateResourceRelatedFields(r);break}i.previousData.left!==r.left&&f.viewType=="resourceView"&&r.eResourceTaskType=="resourceChildTask"&&this._updateSharedResourceTask(r)}else i.rightResizing?(l="Resizing",i.previousData.width!==r.width&&(h=u._getRoundOffEndLeft(r,i.roundOffDuration),ot=u._getDateByLeft(h),r.endDate=u._checkEndDate(ot,r),f.endDateMapping&&(r.item[f.endDateMapping]=r.endDate),r._calculateDuration(this),r.width=r._calculateWidth(this),r.hasChildRecords||(r.progressWidth=r._getProgressWidth(r.width,r.status)),u._updatedColumn="duration",u._updateResourceRelatedFields(r),f.viewType=="resourceView"&&r.eResourceTaskType=="resourceChildTask"&&this._updateSharedResourceTask(r))):i.leftResizing&&(l="Resizing",i.previousData.left!==r.left&&(h=u._getRoundOffStartLeft(r,i.roundOffDuration),c=u._getDateByLeft(h),r.startDate=u._checkStartDate(c,r),f.startDateMapping&&(r.item[f.startDateMapping]=r.startDate),r.endDate=u._checkEndDate(r.endDate,r),r.isAutoSchedule&&f.includeWeekend==!1&&(nt==tt.Hour||nt==tt.Day)&&r._calculateEndDate(this),r._calculateDuration(this),r.left=r._calculateLeft(this),r.width=r._calculateWidth(this),r.hasChildRecords||(r.progressWidth=r._getProgressWidth(r.width,r.status)),u._updatedColumn="duration",u._updateResourceRelatedFields(r),f.viewType=="resourceView"&&r.eResourceTaskType=="resourceChildTask"&&this._updateSharedResourceTask(r)));i.progressResizing?i.previousData.status!=i.data.status&&(r.status=r._getProgressPercent(r.width,r.progressWidth),r.parentItem&&r._updateParentProgress(r.parentItem,f.progressMapping,this),u._refreshParent(r)):(u._isValidationEnabled=!0,u._isOverlapIndexChanged=!1,u._updateEditedGanttRecord(r),r.predecessor&&(u._isMileStoneEdited=r.isMilestone,u._updatedConnectorLineCollection=[],u._connectorlineIds=[],u._editedTaskBarItem=r,f.enablePredecessorValidation?u._validatePredecessor(r):u._validatePredecessorOnEditing(r),f.viewType!="resourceView"&&u._updatedConnectorLineCollection.length>0&&(u._$ganttchartHelper.ejGanttChart("appendConnectorLine",u._updatedConnectorLineCollection),this._updateConnectorLineCollection(u._updatedConnectorLineCollection))),u._editedTaskBarItem=null,r.isAutoSchedule||!r.hasChildRecords||i.isChildren||i.rightResizing||u._validateAutoChildRecords(i),r.parentItem&&r.parentItem.isAutoSchedule&&r.parentItem.eResourceTaskType!="resourceTask"?u._updateParentItem(r,l):r.parentItem&&!r.parentItem.isAutoSchedule&&r.parentItem.eResourceTaskType!="resourceTask"?u._updateManualParentItem(r,l):r.parentItem&&r.parentItem.eResourceTaskType=="resourceTask"&&(it=r.parentItem.eOverlapIndex,this._updateOverlappingValues(r.parentItem),this._updateResourceParentItem(r)));u._isLastRefresh=i.isFromAutoChildUpdate?!1:!0;r.eResourceTaskType=="resourceChildTask"?u.refreshGanttRecord(r.parentItem,r):u.refreshGanttRecord(r);i.isFromAutoChildUpdate||u._trigger("taskbarEdited",i);f.viewType=="resourceView"&&i.dragging&&i.cancel&&(!i.previousResource||i.assignedResource&&i.assignedResource[f.resourceIdMapping]!=i.previousResource[f.resourceIdMapping])&&(d=[],g=[],i.previousResource&&d.push(i.previousResource),v||g.push(i.assignedResource),u._updateResource(g,d,r,i));i.cancel||r.eResourceTaskType!="resourceChildTask"||this._updateSharedResourceTask(r);!i.cancel&&(i.leftResizing||i.rightResizing||i.dragging)&&u._isValidationEnabled&&u._updateScheduleDatesOnEditing(i);this.isCriticalPathEnable==!0&&(u._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0));!i.cancel&&(this._isOverlapIndexChanged||rt||r.eResourceTaskType=="resourceChildTask"&&it!=r.parentItem.eOverlapIndex)&&this._refreshGanttHeightWithRecords();this._isOverlapIndexChanged=!1},_updateSharedResourceTask:function(i,r,u){var p=this.model,a=u?u:i.resourceInfo,o,e,c,l;if(a&&a.length>0){var s=this._getExistingTaskWithID(i,!0),f,v,h=this._getGanttColumnDetails().customColDetails,y=h.length;if(s==null)return;for(o=0;o<s.length;o++)if(f=s[o],f.parentItem.taskId!=i.parentItem.taskId&&t.isNullOrUndefined(r)){if(f.startDate=new Date(i.startDate),f.endDate=new Date(i.endDate),f.duration=i.duration,f.left=i.left,f.width=i.width,f.status=i.status,f.work=i.work,f.effortDriven=i.effortDriven,f.taskType=i.taskType,f.progressWidth=i.progressWidth,f.taskName=i.taskName,f.eResourceName=i.eResourceName,f.baselineLeft=i.baselineLeft,f.baselineRight=i.baselineRight,f.baselineWidth=i.baselineWidth,f.predecessor=i.predecessor,y)for(e=0;e<y;e++)f[h[e].field]=i[h[e].field];v=f.parentItem.eOverlapIndex;this._updateOverlappingValues(f.parentItem);v==f.parentItem.eOverlapIndex||this._isOverlapIndexChanged||(this._isOverlapIndexChanged=!0);this._updateResourceParentItem(f);this.refreshGanttRecord(f.parentItem)}else if(f.parentItem.taskId!=i.parentItem.taskId&&!t.isNullOrUndefined(r)){c={};n.extend(!0,c,r);for(l in c)f[l]=r[l]}}},_refreshGanttHeightWithRecords:function(){var n=this._$treegridHelper.ejTreeGrid("getRecordsHeight");this._$treegridHelper.ejTreeGrid("updateHeight");this._$ganttchartHelper.ejGanttChart("updateHeight",n)},_getUpdatableChildRecords:function(n,t){for(var r=n.childRecords,i=0;i<r.length;i++)r[i].isAutoSchedule&&!r[i].predecessorsName&&(r[i].hasChildRecords?this._getUpdatableChildRecords(r[i],t):t.push(r[i]))},_validateAutoChildRecords:function(t){var v=this,a=t.data,i=[],h=new Date(t.previousData.startDate),c=new Date(a.startDate),u={},l=!0,f,e,o,s=0,r;if(this._getUpdatableChildRecords(a,i),i.length!=0)for(h.getTime()>c.getTime()?(f=this._checkStartDate(c),e=this._checkEndDate(h),l=!1):(f=this._checkStartDate(h),e=this._checkEndDate(c),l=!0),s=f.getTime()>=e.getTime()?0:this._getDuration(f,e,"minute",!0),r=0;r<i.length;r++)i[r].isAutoSchedule&&!i[r].hasChildRecords&&s>0&&(u.previousData=n.extend({},i[r]),l?(o=this._getEndDate(new Date(i[r].startDate),s,"minute",i[r]),i[r].left=this._getTaskLeft(this._checkStartDate(new Date(o)))):(o=this._getStartDate(this._checkEndDate(new Date(i[r].startDate)),s,"minute",i[r]),i[r].left=this._getTaskLeft(o)),u.data=i[r],u.dragging=!0,u.isChildren=!0,u.isFromAutoChildUpdate=!0,v.taskbarEdited(u))},actionBegin:function(t){var i=this,u=this.model,r;return u.viewType=="resourceView"&&t.requestType=="delete"?(r=n.extend({},t),t.data&&t.data.eResourceTaskType=="groupTask"?r.requestType="groupDelete":t.data&&t.data.eResourceTaskType=="resourceTask"&&(r.requestType="resourceDelete"),i._trigger("actionBegin",r),t.cancel=r.cancel):i._trigger("actionBegin",t),!t.cancel&&(t.requestType==="beginedit"&&i._sendEditRequest(null,t),t.requestType=="validateLinkedTask")?t.cancel=i.model.enablePredecessorValidation&&(t.data.isAutoSchedule||i.model.validateManualTasksOnLinking)&&i.model.predecessorMapping?i._validateTypes(t):!0:void 0},_ganttActionCompleteTrigger:function(t){var i=this,u=i.model,f,r;(t.requestType==="save"||t.requestType==="drawConnectorLine"||t.requestType==="delete"||t.requestType==="dragAndDrop")&&(t.requestType==="dragAndDrop"?(r=n.map(i._actionCompleteData,function(n,i){if(n.taskId==t.draggedRow.taskId)return i}),r.length&&i._actionCompleteData.splice(r[0],1),r=null,r=n.map(i._actionCompleteData,function(n,i){if(n.taskId==t.targetRow.taskId)return i}),r.length&&i._actionCompleteData.splice(r[0],1)):t.requestType=="save"?(f=t.addedRecord?t.addedRecord:t.modifiedRecord,r=n.map(i._actionCompleteData,function(n,t){if(n.taskId==f.item[u.taskIdMapping])return t}),r.length&&i._actionCompleteData.splice(r[0],1)):t.requestType==="drawConnectorLine"&&(r=n.map(i._actionCompleteData,function(n,i){if(n.taskId==t.fromItem.taskId)return i}),r.length&&i._actionCompleteData.splice(r[0],1),r=n.map(i._actionCompleteData,function(n,i){if(n.taskId==t.toItem.taskId)return i}),r.length&&i._actionCompleteData.splice(r[0],1)),i._actionCompleteData.length&&(t.updatedRecords=i._actionCompleteData,i._actionCompleteData=[]));i._trigger("actionComplete",t);t.cancel||t.requestType!=="save"||(t._cModifiedData&&(t.data=t._cModifiedData,i._updateLastInsertedId(t.data.taskId)),t._cAddedRecord&&(t.data=t._cAddedRecord,i._updateLastInsertedId(t.data.taskId,!0)),i._updateScheduleDatesOnEditing(t))},_queryCellInfo:function(n){this._trigger("queryCellInfo",n)},_beginEdit:function(t){var i=this,r=n("#"+i._id+"_toolbarItems"),u;if(!i._trigger("beginEdit",t)&&(i._isinBeginEdit=!0,i.model.toolbarSettings.showToolbar)){var f=[],e=n(r).find(".e-cancel").parent()[0],o=n(r).find(".e-saveitem").parent()[0];e&&f.push(e);o&&f.push(o);n(r).ejToolbar("enableItem",f);u=[];i.model.editSettings.allowAdding&&i.model.toolbarSettings.toolbarItems.indexOf("add")!==-1&&u.push(n(r).find(".e-addnewitem").parent()[0]);i.model.editSettings.allowEditing&&i.model.toolbarSettings.toolbarItems.indexOf("edit")!==-1&&u.push(n(r).find(".e-edititem").parent()[0]);i.model.editSettings.allowDeleting&&i.model.toolbarSettings.toolbarItems.indexOf("delete")!==-1&&u.push(n(r).find(".e-deleteitem").parent()[0]);n(r).ejToolbar("disableItem",u)}},_triggerEndEdit:function(i){var r=this,o=this.model,c=n("#"+r._id+"_toolbarItems"),s,u,l,e,f,a,v,y,p,h;if(r._trigger("endEdit",i))s="",i.data[i.columnName]=i.previousValue,i.columnName==="predecessor"?(s=r._predecessorToString(i.data.predecessor,i.data),i.data.item[i.columnObject.mappingName]=s,i.data.predecessorsName=s):(i.data.item[i.columnObject.mappingName]=i.previousValue,i.columnName==="resourceInfo"&&(r._updateResourceName(i.data),r._updateResourceRelatedFields(i.data)));else{if(r._updatedColumn=i.columnName,i.columnName=="taskType"&&i.value=="fixedWork"&&(i.data.effortDriven="true"),(i.columnName==="duration"||i.columnName=="work")&&r._updateResourceRelatedFields(i.data),i.columnName==="resourceInfo"&&(r._updateResourceName(i.data),r._updateResourceRelatedFields(i.data),r._isDurationUpdated==!1&&(u=i.data,l=i.data.hasChildRecords?!0:!1,l&&u.isAutoSchedule?r._updateParentItem(u,null,!0):l&&!u.isAutoSchedule&&r._updateManualParentItem(u,null,!0),u.parentItem&&u.parentItem.isAutoSchedule?r._updateParentItem(u,null,!1):u.parentItem&&!u.parentItem.isAutoSchedule&&r._updateManualParentItem(u,null,!1))),i.columnName=="predecessor"&&o.predecessorMapping)for(e=i.value.replace(/[a-z]/gi,"").split(","),f=0;f<e.length;f++)a=o.flatRecords.filter(function(n){return n&&n.taskId==e[f]}),a[0]&&a[0].hasChildRecords&&(v=i.data.predecessor.filter(function(n){if(n&&(n.from==e[f]||n.to==e[f]))return n}),y=i.data.predecessor.indexOf(v[0]),i.data.predecessor.splice(y,1),p=r._$treegridHelper.ejTreeGrid("instance"),t.TreeGrid.refreshRow(p,o.flatRecords.indexOf(i.data)));(i.isModified||r._isDurationUpdated)&&(r.model.currentViewData=r._$treegridHelper.ejTreeGrid("getCurrentViewData"),r._isValidationEnabled=i.data.isAutoSchedule||o.validateManualTasksOnLinking?!0:!1,r._updateEditedGanttRecords(i,!1))}r._isDurationUpdated=!1;r._isinBeginEdit=!1;r._isLastRefresh=!0;r.refreshGanttRecord(i.data);delete i.isModified;r.model.toolbarSettings.showToolbar&&(h=[],r.model.toolbarSettings.toolbarItems.indexOf("cancel")!==-1&&h.push(n(c).find(".e-cancel").parent()[0]),r.model.toolbarSettings.toolbarItems.indexOf("update")!==-1&&h.push(n(c).find(".e-saveitem").parent()[0]),n(c).ejToolbar("disableItem",h));i.cancel||i.columnName!=="startDate"&&i.columnName!=="endDate"&&i.columnName!=="duration"&&i.columnName!=="baselineStartDate"&&i.columnName!=="baselineEndDate"||r._updateScheduleDatesOnEditing(i);i.cancel||i.columnName!=="taskMode"&&i.columnName!=="startDate"&&i.columnName!=="endDate"&&i.columnName!=="duration"&&i.columnName!=="status"&&i.columnName!=="predecessor"||this.isCriticalPathEnable==!0&&(r._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0))},filterColumn:function(i,r,u,f,e){var c=this,a=c.model,l=c.model.filterSettings.filteredColumns,o={},v,y,h,s;for(o.requestType="filtering",o.currentFilterObject=[],Array.isArray(r)||(r=n.makeArray(r)),Array.isArray(u)||(u=n.makeArray(u)),v=!1,y=this._filterCollection,(this._currentFilterColumn.length<=0||t.util.isNullOrUndefined(this._currentFilterColumn))&&(this._currentFilterColumn=t.TreeGrid.getColumnByMappingName(c._columns,i)),i=i==a.resourceInfoMapping?"resourceNames":i==a.predecessorMapping?"predecessorsName":this._currentFilterColumn.field,h=0;h<r.length;h++)s={field:i,operator:r[h],value:u[h],matchcase:e,predicate:f},this._$colType="string",l.length==0&&s.value!==""&&(this._$colType=="date"&&(r=="equal"||r=="notequal")&&typeof s.value!="string"?this._setDateFilters(s):l.push(s)),v=!0,o.currentFilterObject.push(s);o.filterCollection=l;o.currentFilteringColumn=i;o.fieldName=i;c._refreshFilteredRecords(o)},clearFilter:function(){var n=this,t={};t.requestType="filtering";n.model.filterSettings.filteredColumns=[];n._refreshFilteredRecords(t);n._currentFilterColumn=[]},_refreshFilteredRecords:function(t){var i=this,r=i.model,u=n("#ejTreeGrid"+i._id).data("ejTreeGrid");u.model.filterSettings.filteredColumns=r.filterSettings.filteredColumns;i._$treegridHelper.ejTreeGrid("processBindings",t)},filterContent:function(n){var i=this,f=i.model,e=f.filterSettings.filteredColumns,r,u;if(!(n instanceof t.Predicate))return!1;r=[];r.push(n.toJSON());i._addPredicateObject(r,e);u={requestType:"filtering"};i._refreshFilteredRecords(u)},_addPredicateObject:function(n,i,r){for(var u,f,o=this.model,s=n.length,e=0;e<s;e++)u=n[e],u.isComplex?t.isNullOrUndefined(u.predicates)||this._addPredicateObject(u.predicates,i,u.condition):(f={},f.field=u.field==o.resourceInfoMapping?"resourceNames":u.field==o.predecessorMapping?"predecessorsName":u.field,f.operator=u.operator,f.value=u.value,f.matchcase=!u.ignoreCase,f.predicate=r,i.push(f))},_endEdit:function(n){var t=this,r=this.model,i,u;if(t.model.predecessorMapping){if(i={},u={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},i.editMode="cellEdit",i.data=n.data,i.requestType="validateLinkedTask",i.validateMode=u,t._endEditArgs=n,!t._trigger("actionBegin",i)){if(r.enablePredecessorValidation&&(n.columnName=="startDate"||n.columnName=="endDate")&&t.getFormatedDate(n.value)!=t.getFormatedDate(n.previousValue)&&t.model.predecessorMapping&&(n.data.isAutoSchedule||r.validateManualTasksOnLinking)&&!t._validateTypes(i))return;t._triggerEndEdit(n)}}else t._endEditArgs=n,t._triggerEndEdit(n)},_updateScheduleDatesOnEditing:function(n){var i=this,r=this.model,f=i._getValidStartDate(n.data),c=i._getValidEndDate(n.data),l=i._projectStartDate,a=i._getDateFromFormat(r.scheduleEndDate),y,p,w,b,e=!1,u=r.scheduleStartDate,k,o=r.scheduleEndDate,s;if(!t.isNullOrUndefined(n.data._isScheduledTask(n.data))&&r.scheduleHeaderSettings.updateTimescaleView)if(n.data.hasChildRecords&&!n.data.isAutoSchedule&&(f=i._getDateFromFormat(n.data.manualStartDate),c=i._getDateFromFormat(n.data.manualEndDate)),i._calculateDatesForScheduleCheck(f),r.predecessorMapping)s={},s.onEditing=!0,i._calculateScheduleDates(s),i._calculateDatesForScheduleCheck(s.minStartDate),i._compareDates(s.minStartDate,l)==-1&&(u=n.data._getFormatedDate(s.minStartDate,r.dateFormat,r.locale),e=!0),i._compareDates(s.maxEndDate,a)==1&&(o=n.data._getFormatedDate(s.maxEndDate,r.dateFormat,r.locale),e=!0),e&&i.updateScheduleDates(u,o);else{if(i._compareDates(f,l)==-1?(y=f,l=f):i._compareDates(f,a)==1&&(p=f,a=f),i._compareDates(c,l)==-1?y=c:i._compareDates(c,a)==1&&(p=c),p&&(e=!0,o=n.data._getFormatedDate(p,r.dateFormat,r.locale)),y&&(e=!0,u=n.data._getFormatedDate(y,r.dateFormat,r.locale)),r.renderBaseline&&n.data.baselineStartDate&&n.data.baselineEndDate){var h=i._getDateFromFormat(n.data.baselineStartDate),v=i._getDateFromFormat(n.data.baselineEndDate),u=i._getDateFromFormat(u),o=i._getDateFromFormat(o);h.getTime()>=u.getTime()&&h.getTime()<=o.getTime()||(h.getTime()<u.getTime()?(w=h,l=h):(b=h,a=h));v.getTime()>=u.getTime()&&v.getTime()<=o.getTime()||(v.getTime()<u.getTime()?w=v:b=v)}b&&(e=!0,o=n.data._getFormatedDate(b,r.dateFormat,r.locale));w&&(e=!0,u=n.data._getFormatedDate(w,r.dateFormat,r.locale));e&&(k=i._updateScheduleDatesByTaskLables(i._getDateFromFormat(u),i._getDateFromFormat(o)),i.updateScheduleDates(n.data._getFormatedDate(k.minStartDate,r.dateFormat,r.locale),n.data._getFormatedDate(k.maxEndDate,r.dateFormat,r.locale)))}},_calculateDatesForScheduleCheck:function(n){var f=this,u=this.model,i=u.scheduleHeaderSettings.scheduleHeaderType,r=t.Gantt.ScheduleHeaderType;t.isNullOrUndefined(n)||(i==r.Week&&n.setDate(n.getDate()-3),(i==r.Year||i==r.QuarterYear||i==r.HalfYear)&&n.setDate(n.getDate()-5),i==r.Month&&n.setDate(n.getDate()-3),i==r.Day&&n.setHours(n.getHours()-2),i==r.Hour&&n.setMinutes(n.getMinutes()-5))},_updateScheduleDatesByToolBar:function(i){var r=this,e=this.model,u=i==="prevTimeSpan"?r._projectStartDate:r._getDateFromFormat(r.model.scheduleStartDate),f=r._getDateFromFormat(r.model.scheduleEndDate),h=n("#ejGanttChart"+r._id).ejGanttChart("instance"),o=e.scheduleHeaderSettings.scheduleHeaderType,s=t.Gantt.ScheduleHeaderType,c=0;h._isCalendarExist=null;o==s.Week&&(i==="prevTimeSpan"?u.setDate(u.getDate()-6):f.setDate(f.getDate()+7));(o==s.Year||o==s.QuarterYear||o==s.HalfYear)&&(i==="prevTimeSpan"?u.setDate(u.getDate()-360):f.setDate(f.getDate()+365));o==s.Month&&(i==="prevTimeSpan"?u.setMonth(u.getMonth()-1):f.setDate(f.getDate()+30));o==s.Day&&(i==="prevTimeSpan"?u.setDate(u.getDate()-1):f.setDate(f.getDate()+1));o==s.Hour&&(i==="prevTimeSpan"?u.setHours(u.getHours()-1):f.setHours(f.getHours()+1));i==="prevTimeSpan"?(r.updateScheduleDates(r._getFormatedDate(u,e.dateFormat,e.locale),r._getFormatedDate(f,e.dateFormat,e.locale)),h._$bodyContainer.ejScroller("scrollX",0,!0),r.isCriticalPathEnable==!0&&e.predecessorMapping&&r._$ganttchartHelper.ejGanttChart("criticalConnectorLine",r.criticalPathCollection,r.detailPredecessorCollection,!0,r.collectionTaskId)):i==="nextTimeSpan"&&(r.updateScheduleDates(r._getFormatedDate(u,e.dateFormat,e.locale),r._getFormatedDate(f,e.dateFormat,e.locale)),c=h.getMaxScrollWidth(),h._$bodyContainer.ejScroller("scrollX",c,!0),r.isCriticalPathEnable==!0&&e.predecessorMapping&&r._$ganttchartHelper.ejGanttChart("criticalConnectorLine",r.criticalPathCollection,r.detailPredecessorCollection,!0,r.collectionTaskId))},_rowDataBound:function(n){this._trigger("rowDataBound",n)},_refreshToolBar:function(){var t=n("#"+this._id+"_toolbarItems");t.find("li").removeClass("e-hover")},_toolBarClick:function(t){var e=this,c=e.model,f=n(this.itemsContainer).closest(".e-gantt"),u=f.ejGantt("instance"),r=f.attr("id"),o=n("#"+u._id+"_toolbarItems");if(u._clearContextMenu(),t.event==i&&t.target.tagName=="INPUT"&&t.currentTarget.id==r+"_search")return!1;u.model.dateFormat.toLowerCase().indexOf("hh")!=-1?n.isFunction(n.fn.ejDateTimePicker)&&n("#"+r+"EditForm").find(".e-datetimepicker").ejDateTimePicker("hide"):n.isFunction(n.fn.ejDatePicker)&&n("#"+r+"EditForm").find(".e-datepicker").ejDatePicker("hide");var s=t.currentTarget,l=t.target,h={itemName:t.text,currentTarget:s,model:u.model};if(f.ejGantt("instance")._trigger("toolbarClick",h))return!1;n(o).ejToolbar("deselectItem",t.currentTarget);switch(t.currentTarget.id){case r+"_excelExport":u._toolbarOperation(r+"_excelExport");break;case r+"_pdfExport":u._toolbarOperation(r+"_pdfExport");break;case r+"_add":u._toolbarOperation(r+"_add");break;case r+"_edit":u._toolbarOperation(r+"_edit");break;case r+"_delete":u._toolbarOperation(r+"_delete");break;case r+"_update":u._toolbarOperation(r+"_update");break;case r+"_cancel":u._toolbarOperation(r+"_cancel");break;case r+"_search":u._toolbarOperation(r+"_search",n(t.currentTarget).find("input").val());break;case r+"_indent":u._toolbarOperation(r+"_indent");break;case r+"_outdent":u._toolbarOperation(r+"_outdent");break;case r+"_expandAll":u._toolbarOperation(r+"_expandAll");break;case r+"_criticalPath":u._enableDisableCriticalIcon?u._enableDisableCriticalIcon&&u._toolbarOperation(r+"_criticalDisable"):u._toolbarOperation(r+"_criticalEnable");break;case r+"_collapseAll":u._toolbarOperation(r+"_collapseAll");break;case r+"_prevTimeSpan":u._toolbarOperation(r+"_prevTimeSpan");break;case r+"_nextTimeSpan":u._toolbarOperation(r+"_nextTimeSpan")}return!1},_toolbarOperation:function(t,i){var o=this.element,f=o.ejGantt("instance"),u=o.attr("id"),r=this,s=r.selectedRowIndex(),e;f._exportTo=f["export"];e=n("#"+r._id+"_toolbarItems");switch(t){case u+"_add":r._sendAddRequest();break;case u+"_edit":r._sendEditRequest();break;case u+"_delete":r._$treegridHelper.ejTreeGrid("deleteRow");r._isRefreshAddedRecord=!1;break;case u+"_update":r._$treegridHelper.ejTreeGrid("endEdit");r.model.toolbarSettings.toolbarItems.indexOf("cancel")!==-1&&r._disabledToolItems.push(n(e).find(".e-cancel").parent()[0]);r.model.toolbarSettings.toolbarItems.indexOf("update")!==-1&&r._disabledToolItems.push(n(e).find(".e-saveitem").parent()[0]);n(e).ejToolbar("disableItem",r._disabledToolItems);r._disabledToolItems=[];break;case u+"_cancel":r._$treegridHelper.ejTreeGrid("cancelEditCell");r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case u+"_criticalEnable":r.showCriticalPath(!0);r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case u+"_criticalDisable":r.showCriticalPath(!1);r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case u+"_search":r.cancelEditCell();r._searchString!=i&&(r._$treegridHelper.ejTreeGrid("search",i),r.clearSelection(),r._clearMultiSelectPopup(),r._searchString=i,r.updateSelectedItemIndex(),r._updateToolbarOptions(),r._isRefreshAddedRecord=!1);break;case u+"_indent":r._sendIndentRequest();r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");r._isRefreshAddedRecord=!1;break;case u+"_outdent":r._sendOutdentRequest();r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");r._isRefreshAddedRecord=!1;break;case u+"_expandAll":r._expandAll();r.updateSelectedItemIndex();r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case u+"_collapseAll":r._collapseAll();r.updateSelectedItemIndex();r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case u+"_prevTimeSpan":r._updateScheduleDatesByToolBar("prevTimeSpan");r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case u+"_nextTimeSpan":r._updateScheduleDatesByToolBar("nextTimeSpan");r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case u+"_excelExport":r._exportTo(f.model.exportToExcelAction,"excelExporting",f.model.allowMultipleExporting);break;case u+"_pdfExport":r._exportTo(f.model.exportToPdfAction,"pdfExporting",f.model.allowMultipleExporting)}return r._refreshToolBar(),!1},updateSelectedItemIndex:function(){var n=this,i=this.model,u=i.updatedRecords,r;i.selectedItems.length>1||(i.allowSelection&&!t.isNullOrUndefined(this.selectedItem())?n.getExpandStatus(this.selectedItem())?(r=u.indexOf(this.selectedItem()),n.selectRows(r)):n.selectRows(-1):i.allowSelection||t.isNullOrUndefined(this.selectedItem())||n.selectRows(-1))},clearSelection:function(n){var t=this,r=t.model,i;r.selectedCellIndexes=[];t._$treegridHelper.ejTreeGrid("clearSelection",n);t._$ganttchartHelper.ejGanttChart("clearSelection",n);i=t._$treegridHelper.ejTreeGrid("instance");r.selectedItems=i.model.selectedItems;t.selectedItem(i.model.selectedItem);t.selectedRowIndex(i.model.selectedRowIndex);t._clearMultiSelectPopup()},selectCells:function(n,t){var i=this,r=i.model;r.selectionMode=="cell"&&r.allowSelection&&i._$treegridHelper.ejTreeGrid("selectCells",n,t)},selectRows:function(n){var r=this,u=this.model,i;u.selectionMode!="cell"&&(n!==-1&&!t.isNullOrUndefined(n)&&n<u.updatedRecords.length?(i={},i.recordIndex=n,i.data=u.updatedRecords[i.recordIndex],i.target="ejTreeGrid",r.rowSelecting(i)&&(r._$treegridHelper.ejTreeGrid("selectRows",i.recordIndex),r.rowSelected(i))):n===-1&&(r._deSelectRowItem(),r._updateToolbarOptions()))},_setModel:function(i){var r=this,u,f=r.model,o,s,h,e;for(u in i)switch(u){case"sortSettings":r._sendSortingRequest(i[u]);break;case"allowSorting":r._sortingRequest(i[u]);f.showColumnChooser&&f.showColumnOptions&&r._$treegridHelper.ejTreeGrid("columnAddDialogTemplate");break;case"allowMultiSorting":f.allowMultiSorting=i[u];r._$treegridHelper.ejTreeGrid("model.allowMultiSorting",f.allowMultiSorting);break;case"destroy":r.destroy();break;case"treeColumnIndex":r._columnIndex(i[u]);break;case"allowGanttChartEditing":r._ganttChartEditing(i[u]);break;case"enableProgressBarResizing":r._resizeProgressbar(i[u]);break;case"enableTaskbarTooltip":r._showTooltip(i[u]);break;case"enableTaskbarDragTooltip":r._showEditingTooltip(i[u]);break;case"validateManualTasksOnLinking":f.validateManualTasksOnLinking=i[u];break;case"enableAltRow":r._updateAltRow(i[u]);break;case"locale":f.flatRecords=[];f.parentRecords=[];r._clearContextMenu();f.locale=i[u];f.isRerender=!0;r.element.ejGantt("destroy").ejGantt(f);break;case"allowSelection":f.allowSelection=i[u];f.allowSelection?(r._$treegridHelper.ejTreeGrid("instance").model.allowSelection=!0,r._$ganttchartHelper.ejGanttChart("instance").model.allowSelection=!0):(r._deSelectRowItem(),r._$treegridHelper.ejTreeGrid("instance").model.allowSelection=!1,r._$ganttchartHelper.ejGanttChart("instance").model.allowSelection=!1);r._updateToolbarOptions();break;case"editSettings":n.extend(f.editSettings,i[u]);r._updateEditSettings(i[u]);r._initiateDialogTemplates();r._enableEditingEvents();this.cancelEditCell();r._$treegridHelper.ejTreeGrid("setModel",{editSettings:{showDeleteConfirmDialog:f.editSettings.showDeleteConfirmDialog}});break;case"taskbarBackground":r._updateTaskbarBackground(i[u]);break;case"progressbarBackground":r._updateProgressbarBackground(i[u]);break;case"parentTaskbarBackground":r._updateParentTaskbarBackground(i[u]);break;case"parentProgressbarBackground":r._updateParentProgressbarBackground(i[u]);break;case"showTaskNames":r._updateRenderTaskNames(i[u]);break;case"leftTaskLabelMapping":r._refreshLeftTaskLabelMapping(i[u]);break;case"rightTaskLabelMapping":r._refreshRightTaskLabelMapping(i[u]);break;case"leftTaskLabelTemplate":r._refreshLeftTaskLabelTemplate(i[u]);break;case"rightTaskLabelTemplate":r._refreshRightTaskLabelTemplate(i[u]);break;case"showProgressStatus":r._updateRendeProgressStatus(i[u]);break;case"showResourceNames":r._updateRenderResourceNames(i[u]);break;case"progressbarHeight":r._updateProgressbarHeight(i[u]);break;case"baselineColor":r._updateBaselineColor(i[u]);break;case"renderBaseline":r._updateRenderBaseline(i[u]);break;case"allowColumnResize":r._updateAllowColumnResize(i[u]);break;case"allowKeyboardNavigation":r._updateAllowKeyboardNavigation(i[u]);break;case"selectedItem":r._updateSelectedItem(i[u]);break;case"dataSource":f.viewType!=t.Gantt.ViewType.HistogramView&&(r._deSelectRowItem(),r._updateToolbarOptions());this.isProjectViewData&&f.viewType==t.Gantt.ViewType.HistogramView?f.viewType=t.Gantt.ViewType.ProjectView:this.isProjectViewData===!1&&f.viewType==t.Gantt.ViewType.HistogramView&&(f.viewType=t.Gantt.ViewType.ResourceView);this._refreshDataSource(i[u]);r._enableDisableCriticalIcon&&r.showCriticalPath(!0);r._updateScrollerBorder();break;case"readOnly":r._updateReadOnly(i[u]);break;case"showGridCellTooltip":r._updateShowGridCellTooltip(i[u]);break;case"showGridExpandCellTooltip":r._updateShowGridExpandCellTooltip(i[u]);break;case"highlightWeekends":r._updateHighlightWeekends(i[u]);break;case"highlightNonWorkingTime":r._updateHighlightNonWorkingTime(i[u]);break;case"nonWorkingBackground":r._updateNonWorkingBackground(i[u]);break;case"connectorLineBackground":r._updateConnectorLineBackground(i[u]);r._enableDisableCriticalIcon&&r._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId);break;case"connectorlineWidth":r._updateConnectorlineWidth(i[u]);r._enableDisableCriticalIcon&&r._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId);break;case"weekendBackground":r._updateWeekendBackground(i[u]);break;case"scheduleHeaderSettings":o=i[u];for(s in o)switch(s){case"timescaleUnitSize":r._updateTimescaleUnitSize(o[s]);r._updateScrollerBorder();break;case"scheduleHeaderType":r._changeChartSchedule(o[s]);r._updateScrollerBorder()}break;case"enableContextMenu":f.enableContextMenu=i[u];r._clearContextMenu();r._off(r.element,"contextmenu",r._rightClick);f.enableContextMenu&&r._on(r.element,"contextmenu",r._rightClick);break;case"enableResize":f.enableResize?(r.model.enableResize=i[u],r._on(n(window),"resize",r.windowResize)):r._off(n(window),"resize",r.windowResize);break;case"isResponsive":f.isResponsive?(r.model.isResponsive=i[u],r._on(n(window),"resize",r.windowResize)):r._off(n(window),"resize",r.windowResize);break;case"selectedRowIndex":this.selectedRowIndex()===-1||this.selectedRowIndex()===""?(r._deSelectRowItem(),r._updateToolbarOptions()):this.selectedRowIndex()!==-1&&!t.isNullOrUndefined(this.selectedRowIndex())&&this.selectedRowIndex()<r.model.updatedRecords.length&&(h={},h.recordIndex=r.selectedRowIndex(),h.previousIndex=f.selectedItem?f.updatedRecords.indexOf(f.selectedItem):-1,r.rowSelecting(h)&&(e={},e.recordIndex=this.selectedRowIndex(),e.data=r.model.updatedRecords[e.recordIndex],e.target="ejTreeGrid",r._$treegridHelper.ejTreeGrid("selectRows",e.recordIndex),r.rowSelected(e)));break;case"selectedCellIndexes":f.allowSelection&&f.selectionMode=="cell"&&r.selectCells(i[u]);break;case"selectionMode":f.allowSelection&&(r.clearSelection(),r._$treegridHelper.ejTreeGrid("selectRows",-1),r._$ganttchartHelper.ejGanttChart("selectRows",-1),f.selectedItem=null,f.selectionMode=i[u],r._$treegridHelper.ejTreeGrid("option","selectionMode",i[u]),r._$ganttchartHelper.ejGanttChart("option","selectionMode",i[u]),r._updateToolbarOptions(),r.model.selectionType=="multiple"&&r.model.selectionMode=="row"&&(n("#"+this._id+"_selectionpopup").remove(),r._renderMultiSelectionPopup()));break;case"selectionType":f.allowSelection&&(r.clearSelection(),f.selectionType=i[u],r._$treegridHelper.ejTreeGrid("option","selectionType",i[u]),r._$ganttchartHelper.ejGanttChart("option","selectionType",i[u]),r.model.selectionType=="multiple"&&r.model.selectionMode=="row"&&(n("#"+this._id+"_selectionpopup").remove(),r._renderMultiSelectionPopup()));break;case"showColumnChooser":f.showColumnChooser=i[u];r._$treegridHelper.ejTreeGrid("setModel",{showColumnChooser:f.showColumnChooser});break;case"showColumnOptions":f.showColumnOptions=i[u];r._$treegridHelper.ejTreeGrid("setModel",{showColumnOptions:f.showColumnOptions});break;case"splitterPosition":r.setSplitterPosition(r._splitterPosition());break;case"addDialogFields":f.editSettings.allowAdding&&(f.addDialogFields=i[u],r.addDialogTemplate());break;case"dragTooltip":r._$treegridHelper.ejTreeGrid("setModel",{dragTooltip:i[u]});break;case"allowDragAndDrop":f.allowDragAndDrop=i[u];r._$ganttchartHelper.ejGanttChart("updateDragAndDrop",f.allowDragAndDrop);r._$treegridHelper.ejTreeGrid("setModel",{allowDragAndDrop:f.allowDragAndDrop});break;case"editDialogFields":f.editSettings.allowEditing&&(f.editDialogFields=i[u],r.editDialogTemplate());break;case"toolbarSettings":n.extend(r.model.toolbarSettings,i[u]);r._updateToolbar();break;case"holidays":f.holidays=i[u];r._refreshHolidays();r._updateScrollerBorder();break;case"stripLines":f.stripLines=i[u];r._updateStripLines();r._updateScrollerBorder();break;case"splitterSettings":n.extend(f.splitterSettings,i[u]);!t.isNullOrUndefined(i[u].index)&&t.isNullOrUndefined(i[u].position)?r.setSplitterIndex(f.splitterSettings.index):r.setSplitterPosition(r.splitterPosition());break;case"enablePredecessorValidation":f.enablePredecessorValidation=i[u];break;case"enableSerialNumber":f.enableSerialNumber=i[u];r._updateSerialColumns();r._$treegridHelper.ejTreeGrid("model.enableSerialNumber",i[u]);r._$treegridHelper.ejTreeGrid("updateColumns",r._columns);break;case"sizeSettings":this._calculateDimensions();this.windowResize();break;case"milestoneTemplate":r._milestoneTemplate(i[u]);break;case"taskbarTemplate":r._taskbarTemplate(i[u]);break;case"parentTaskbarTemplate":r._parentTaskbarTemplate(i[u]);break;case"dayWorkingTime":f.dayWorkingTime=i[u].slice();f.flatRecords=[];f.parentRecords=[];f.updatedRecords=[];f.ids=[];f.scheduleStartDate=f.scheduleStartDate;f.scheduleEndDate=f.scheduleEndDate;r._storedIndex=-1;r._lastInsertedId=-1;r.selectedRowIndex(-1);r._predecessorsCollection=[];r.element.ejGantt("destroy").ejGantt(f);break;case"workUnit":f.workUnit=i[u];this._updateWorkUnit();break;case"resources":r._updateResourcesData(i[u]);break;case"cssClass":this.element.removeClass(r._cssClass).addClass(i[u]);f.toolbarSettings.showToolbar&&n("#"+r._id+"_toolbarItems").ejToolbar("model.cssClass",i[u]);n("#e-ejSpliter"+r._id).data("ejSplitter")&&n("#e-ejSpliter"+r._id).ejSplitter("model.cssClass",i[u]);r._$treegridHelper.ejTreeGrid("model.cssClass",i[u]);r._$ganttchartHelper.removeClass(r._cssClass).addClass(i[u]);r._$ganttchartHelper.ejGanttChart("model.cssClass",i[u]);r.addDialogTemplate();r.editDialogTemplate();this._cssClass=i[u];break;case"workWeek":f.workWeek=i[u].slice();f.workWeek.length==0&&(f.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"]);r._getNonWorkingDayIndex();r._$ganttchartHelper.ejGanttChart("updateWorkWeek",f.workWeek);r._refreshDataSource(f.dataSource);break;case"enableVirtualization":f.enableVirtualization=i[u];r._$treegridHelper.ejTreeGrid("setModel",{enableVirtualization:f.enableVirtualization});r._updateExpandStatus();r._totalCollapseRecordCount=r._$treegridHelper.ejTreeGrid("getCollapsedRecordCount");f.selectedItem&&this.selectedRowIndex(f.updatedRecords.indexOf(f.selectedItem));r._$ganttchartHelper.ejGanttChart("updateVirtualization",f.enableVirtualization,this._totalCollapseRecordCount);r._refreshConnectorLines(!1,!0,!0)}},_updateResourcesData:function(i){var u=this,r=u.model,o,f=-1,s=u.getColumns(),e;r.resources=n.extend(!0,[],i);this._resourceCollection=r.resources;n.each(s,function(n,t){if(t.mappingName==r.resourceInfoMapping){f=n;return}});f>-1&&(s[f].dropdownData=r.resources);e=r.flatRecords.slice();e.reverse();o=t.Gantt.GanttRecord.prototype;n.each(e,function(n,t){t.resourceInfo&&t.resourceInfo.length>0&&(t.resourceInfo=o._setResourceInfo(t.item[r.resourceInfoMapping],r.resourceIdMapping,r.resourceNameMapping,r.resourceUnitMapping,r.resources),u._updateResourceName(t),u._updateResourceRelatedFields(t),t.hasChildRecords?t.isAutoSchedule?u._updateParentItem(t,null,!0):t.isAutoSchedule||u._updateManualParentItem(t,null,!0):u.refreshGanttRecord(t))})},_updateSerialColumns:function(){var r=this,u=r.model,i=u.columns,s=u.flatRecords,h,c,l,e,o,a,v,f;if(u.enableSerialNumber){for(l=s.length,e=0;e<l;e++)o=s[e],o.predecessorsName&&r._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",o);n.map(i,function(n){if(n.field=="taskId")return n.visible=!1,!1});h={field:"serialNumber",headerText:r._columnHeaderTexts.serialNumber,width:40,allowEditing:!1,allowSorting:!1,mappingName:"serialNumber",showInColumnChooser:!1};i.splice(0,0,h);c=i.filter(function(n){return n&&n.field=="predecessor"});f={field:"serialNumberPredecessor",headerText:r._columnHeaderTexts.predecessor,width:150,editType:t.Gantt.EditingType.String,mappingName:"serialNumberPredecessor",allowCellSelection:!0};i.splice(i.indexOf(c[0]),1,f)}else n.map(i,function(n){if(n.field=="taskId")return n.visible=!0,!1}),a=i.filter(function(n){return n&&n.field=="serialNumber"}),i.splice(i.indexOf(a[0]),1),f=i.filter(function(n){return n&&n.field=="serialNumberPredecessor"}),v={field:"predecessor",headerText:r._columnHeaderTexts.predecessor,width:150,editType:t.Gantt.EditingType.String,mappingName:u.predecessorMapping,allowCellSelection:!0},i.splice(i.indexOf(f[0]),1,v)},_changeChartSchedule:function(n){var i=this,r=i.model,o=i._getDateFromFormat(r.scheduleStartDate),s=i._getDateFromFormat(r.scheduleEndDate),u,f;switch(n){case t.Gantt.ScheduleHeaderType.Week:r.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Week;i._perDayWidth=30;break;case t.Gantt.ScheduleHeaderType.Day:r.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Day;i._perHourWidth=20;r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours?i._perDayWidth=i._perHourWidth*24:r.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(i._perDayWidth=i._perHourWidth*24);break;case t.Gantt.ScheduleHeaderType.Month:r.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Month;i._perDayWidth=10;i._perWeekWidth=70;break;case t.Gantt.ScheduleHeaderType.Year:r.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Year;i._perDayWidth=3;i._perMonthWidth=90;break;case t.Gantt.ScheduleHeaderType.QuarterYear:r.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.QuarterYear;i._perDayWidth=1;i._perMonthWidth=30;break;case t.Gantt.ScheduleHeaderType.HalfYear:r.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.HalfYear;i._perDayWidth=.5;i._perMonthWidth=15;break;case t.Gantt.ScheduleHeaderType.Hour:if(r.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Hour,u=r.scheduleHeaderSettings.minutesPerInterval,f=t.Gantt.minutesPerInterval,i._perMinuteWidth=20,u)if(u==f.Auto){var e=s-o;e>864e6?(i._minuteInterval=30,i._perDayWidth=i._perMinuteWidth*48):e>6048e5?(i._minuteInterval=15,i._perDayWidth=i._perMinuteWidth*96):e>1728e5?(i._minuteInterval=5,i._perDayWidth=i._perMinuteWidth*288):(i._minuteInterval=1,i._perDayWidth=i._perMinuteWidth*1440)}else u==f.OneMinute?(i._minuteInterval=1,i._perDayWidth=i._perMinuteWidth*1440):u==f.FiveMinutes?(i._minuteInterval=5,i._perDayWidth=i._perMinuteWidth*288):u==f.FifteenMinutes?(i._minuteInterval=15,i._perDayWidth=i._perMinuteWidth*96):u==f.ThirtyMinutes&&(i._minuteInterval=30,i._perDayWidth=i._perMinuteWidth*48)}i._updateModelsWidth();i.updateScheduleDates(r.scheduleStartDate,r.scheduleEndDate)},_updateWorkUnit:function(){var n=this,f=n.model,e=f.flatRecords,s=n.getCurrentViewData(),o=n._$treegridHelper.ejTreeGrid("instance"),r,i,u;for(o.model.workUnit=n._workUnitTexts[f.workUnit],r=0;r<e.length;r++)i=e[r],u=s.indexOf(i),i._updateWorkWithDuration(n),i.parentItem&&n._updateParentItem(i),u!=-1&&t.TreeGrid.refreshRow(o,u)},_resourceDataBindingForSetModel:function(){var n=this,i=n.model,r,u,f;i.resourceIdMapping.length>0&&i.resources&&i.resources.length>0||i.groupIdMapping&&i.groupIdMapping.length>0&&i.groupCollection&&i.groupCollection.length>0?(n._isFlatResourceData=!0,n._groupCollection=i.groupCollection,n._resourceCollection=i.resources):n._isFlatResourceData=!1;i.resourceIdMapping||(i.resourceIdMapping="eResourceId");i.groupIdMapping||(i.groupIdMapping="eGroupId");i.resourceInfoMapping||(i.resourceInfoMapping="eResourceInfo");n.dataSource()==null&&n.dataSource([]);n.dataSource()instanceof t.DataManager?(r=n._columnToSelect(),u=n.dataSource().executeQuery(r),u.done(t.proxy(function(t){n._retrivedData=t.result;n._isFlatResourceData?n._reConstructResourceData(n._retrivedData):n.secondaryDatasource=n._retrivedData;n._createResourceRecords(n.secondaryDatasource);n._refreshGanttWithNewRecords()}))):n.dataSource().length>0||i.resources&&i.resources.length>0?(n._isFlatResourceData?(f=n._reConstructResourceData(n.dataSource()),n._createResourceRecords(f)):n._createResourceRecords(n.dataSource()),n._refreshGanttWithNewRecords()):n._refreshGanttWithNewRecords()},_dataBindingForSetModel:function(){var i=this,r=i.model,s,h,e,o,u,f;if(this.dataSource()==null&&this.dataSource([]),this.dataSource()instanceof t.DataManager)s=this._columnToSelect(),h=this.dataSource().executeQuery(s),h.done(t.proxy(function(t){var e,o,u,f;if(i._retrivedData=t.result,r.taskIdMapping.length>0&&r.parentTaskIdMapping.length>0){for(e=i._retrivedData,o=[],i._taskIds=[],u=0;u<e.length;u++)f=e[u],o.push(n.extend(!0,{},f)),f[r.taskIdMapping]&&i._taskIds.push(f[r.taskIdMapping]);r.childMapping||(r.childMapping="Children");i._reconstructDatasource(o)}else i.secondaryDatasource=i._retrivedData;i._createGanttRecords(i.secondaryDatasource);i._refreshGanttWithNewRecords()}));else if(this.dataSource().length>0){if(r.taskIdMapping.length>0&&r.parentTaskIdMapping.length>0){for(e=i.dataSource(),o=[],i._taskIds=[],u=0;u<e.length;u++)f=e[u],o.push(n.extend(!0,{},f)),f[r.taskIdMapping]&&i._taskIds.push(f[r.taskIdMapping]);r.childMapping||(r.childMapping="Children");i._reconstructDatasource(o);i._createGanttRecords(i.secondaryDatasource)}else i._createGanttRecords(this.dataSource());this._refreshGanttWithNewRecords()}else this._refreshGanttWithNewRecords();r.expandStateMapping&&i._collapseRecordOnLoad()},_refreshGanttWithNewRecords:function(){var n=this,i=this.model,u={},r;this._updatePredecessors();i.predecessorMapping&&i.enablePredecessorValidation&&n._updatedRecordsDateByPredecessor();t.isNullOrUndefined(this.isProjectViewData)||(this._calculateScheduleDates(),this.updateScheduleDates(i.scheduleStartDate,this.model.scheduleEndDate),this._checkDataManagerUpdate(),r=n._$treegridHelper.ejTreeGrid("instance"),r._isDataManagerUpdate=r.model.dataManagerUpdate.isDataManagerUpdate=n._isDataManagerUpdate,r._jsonData=r.model.dataManagerUpdate.jsonData=n._jsonData,i.viewType=t.Gantt.ViewType.HistogramView,this._checkHistoGramDataBinding());this._$treegridHelper.ejTreeGrid("setUpdatedRecords",i.flatRecords,i.updatedRecords,i.ids,i.parentRecords,this.dataSource());this._$treegridHelper.ejTreeGrid("processBindings");n.model.updatedRecords=n.getUpdatedRecords();n.model.currentViewData=n.getCurrentViewData();n._gridRows=n.getRows();n._totalCollapseRecordCount=n._$treegridHelper.ejTreeGrid("getCollapsedRecordCount");this._$ganttchartHelper.ejGanttChart("setUpdatedRecords",i.currentViewData,i.updatedRecords,i.flatRecords,i.ids);i.viewType!=t.Gantt.ViewType.HistogramView?(this._calculateScheduleDates(),this.updateScheduleDates(i.scheduleStartDate,this.model.scheduleEndDate)):(n._$ganttchartHelper.ejGanttChart("refreshContainersWidth"),n._$ganttchartHelper.ejGanttChart("refreshHelper",n.model.currentViewData,n.model.updatedRecords,n._totalCollapseRecordCount),n._$ganttchartHelper.ejGanttChart("instance")._$bodyContainer.ejScroller("refresh"));u.requestType=t.TreeGrid.Actions.Refresh;n._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",u);n.model.viewType==t.Gantt.ViewType.ResourceView&&(n._$treegridHelper.ejTreeGrid("updateHeight"),this._updateResourceColumn());i.viewType!=t.Gantt.ViewType.HistogramView&&(this._checkDataManagerUpdate(),r=n._$treegridHelper.ejTreeGrid("instance"),r._isDataManagerUpdate=r.model.dataManagerUpdate.isDataManagerUpdate=n._isDataManagerUpdate,r._jsonData=r.model.dataManagerUpdate.jsonData=n._jsonData);this._isFromSetModel=!1},_refreshDataSource:function(n){var i=this;this.resetModelCollections();this.dataSource(n);this._isFromSetModel=!0;i.secondaryDatasource=[];i._retrivedData=this.dataSource();i.model.viewType==t.Gantt.ViewType.ResourceView?(i._resourceChildTasks=[],i._groupIds=[],i._resourceIds=[],i._resourceCollection=[],i._groupCollection=[],this._resourceUniqTasks=[],this._resourceUniqTaskIds=[],this._resourceDataBindingForSetModel()):this._dataBindingForSetModel()},_updateResourceColumn:function(){for(var n=0;n<this._resourceViewColumns.length;n++)if(this._resourceViewColumns[n].field=="resourceInfo"){this._resourceViewColumns[n].mappingName=this.model.resourceInfoMapping;this._resourceViewColumns[n].dropdownData=this._resourceCollection;break}},resetModelCollections:function(){var t=this,n=t.model;n.dataSource=[];n.flatRecords=[];n.parentRecords=[];n.updatedRecords=[];n.ids=[];n.scheduleStartDate=n.scheduleStartDate;n.scheduleEndDate=n.scheduleEndDate;t._storedIndex=-1;t._lastInsertedId=-1;t.selectedRowIndex(-1);t._predecessorsCollection=[];t._serialCount=0},_refreshHolidays:function(){var n=this,i=this.model,t,r;n._holidaysList=n._getHoliday();n._stringHolidays=n._getStringHolidays();t=n._updateScheduleDatesByHolidays(new Date(n._projectStartDate),new Date(n._projectEndDate));t.startDate.getTime()!==n._projectStartDate.getTime()||t.endDate.getTime()!==n._projectEndDate.getTime()?(r=n._$ganttchartHelper.data("ejGanttChart"),r.model.holidays=i.holidays,n.updateScheduleDates(t.startDate,t.endDate)):(n._isTreeGridRendered=!1,n._isGanttChartRendered=!1,n._updateGanttRecords(),n._$ganttchartHelper.ejGanttChart("refreshHelper",n.model.currentViewData,n.model.updatedRecords,n._totalCollapseRecordCount),i.predecessorMapping&&n._refreshConnectorLines(!1,!0,!0),this._$ganttchartHelper.ejGanttChart("refreshHolidays",i.holidays),n._isTreeGridRendered=!0,n._isGanttChartRendered=!0);n._$treegridHelper.ejTreeGrid("renderRecords")},_updateStripLines:function(){var n=this,r=this.model,t,i;t=n._updateScheduleDatesByStripLines(new Date(n._projectStartDate),new Date(n._projectEndDate));t.startDate.getTime()!==n._projectStartDate.getTime()||t.endDate.getTime()!==n._projectEndDate.getTime()?(i=n._$ganttchartHelper.data("ejGanttChart"),i.model.stripLines=r.stripLines,n.updateScheduleDates(t.startDate,t.endDate)):this._$ganttchartHelper.ejGanttChart("refreshStripLines",this.model.stripLines)},_updateWeekendBackground:function(n){var t=this;this.model.weekendBackground=n;t._$ganttchartHelper.ejGanttChart("updateWeekendBackground",n)},_updateNonWorkingBackground:function(n){var t=this;t.model.nonWorkingBackground=n;t._$ganttchartHelper.ejGanttChart("updateNonWorkingBackground",n)},_updateHighlightNonWorkingTime:function(n){var t=this;t.model.highlightNonWorkingTime=n;t._$ganttchartHelper.ejGanttChart("updateHighlightNonWorkingTime",n)},_updateHighlightWeekends:function(n){var t=this;this.model.highlightWeekends=n;t._$ganttchartHelper.ejGanttChart("updateHighlightWeekends",n)},_updateReadOnly:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateReadOnly",n);t._$ganttchartHelper.ejGanttChart("updateReadOnly",n);t._updateToolbarOptions()},_updateShowGridCellTooltip:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateShowGridCellTooltip",n)},_updateShowGridExpandCellTooltip:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateShowGridExpandCellTooltip",n)},_updateSelectedItem:function(n){var t=this,i={};n[t.model.taskIdMapping]!=null&&(i.recordIndex=t.model.ids.indexOf(n[t.model.taskIdMapping].toString()),i.item=t.model.flatRecords[i.recordIndex],i.target="ejTreeGrid",t.rowSelected(i),t._$treegridHelper.ejTreeGrid("selectRows",i.recordIndex),t._$ganttchartHelper.ejGanttChart("selectRows",i.recordIndex),t._$ganttchartHelper.ejGanttChart("updateSelectedItem",i.recordIndex))},_updateAllowKeyboardNavigation:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateAllowKeyboardNavigation",n);t._$ganttchartHelper.ejGanttChart("updateAllowKeyboardNavigation",n)},_updateAllowColumnResize:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateAllowColumnResize",n)},_updateProgressbarHeight:function(n){var t=this;this.model.progressbarHeight=n;t._$ganttchartHelper.ejGanttChart("updateProgressbarHeight",n)},_updateBaselineColor:function(n){var t=this;this.model.baselineColor=n;t._$ganttchartHelper.ejGanttChart("updateBaselineColor",n)},_showBaselineColumns:function(){var r=this,n=r.model,u,i;n.renderBaseline&&n.baselineStartDateMapping&&n.baselineEndDateMapping&&(i=n.baselineStartDateMapping,i.length&&(u={field:"baselineStartDate",headerText:r._columnHeaderTexts.baselineStartDate,width:150,editType:n.dateFormat.toLowerCase().indexOf("hh")==-1?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:i,format:"{0:"+n.dateFormat+"}",allowEditing:!0,allowCellSelection:!0},r._columns.push(u)),i=n.baselineEndDateMapping,i.length&&(u={field:"baselineEndDate",headerText:r._columnHeaderTexts.baselineEndDate,width:150,editType:n.dateFormat.toLowerCase().indexOf("hh")==-1?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:i,format:"{0:"+n.dateFormat+"}",allowEditing:!0,allowCellSelection:!0},r._columns.push(u)))},_updateRenderBaseline:function(n){var t=this,i=t.model,r,u;this.model.renderBaseline=n;t._$ganttchartHelper.ejGanttChart("updateRenderBaseline",n);i.renderBaseline&&(t._showBaselineColumns(),t._trigger("load"));i.renderBaseline||(r=t._getbaselineColumnIndex(t._columns).indexOf("baselineStartDate"),t._columns.splice(r,1),u=t._getbaselineColumnIndex(t._columns).indexOf("baselineEndDate"),t._columns.splice(u,1));t._$treegridHelper.ejTreeGrid("updateColumns",t._columns)},_getbaselineColumnIndex:function(n){for(var r=this,i=[],t=0;t<n.length;t++)i[t]=n[t].field;return i},_updateRenderTaskNames:function(n){var t=this;this.model.showTaskNames=n;t._$ganttchartHelper.ejGanttChart("updateRenderTaskNames",n)},_refreshLeftTaskLabelMapping:function(n){var t=this;this.model.leftTaskLabelMapping=n;t._$ganttchartHelper.ejGanttChart("refreshLeftTaskLabelMapping",n)},_refreshRightTaskLabelMapping:function(n){var t=this;this.model.rightTaskLabelMapping=n;t._$ganttchartHelper.ejGanttChart("refreshRightTaskLabelMapping",n)},_refreshLeftTaskLabelTemplate:function(n){var t=this;this.model.leftTaskLabelTemplate=n;t._$ganttchartHelper.ejGanttChart("refreshLeftTaskLabelTemplate",n)},_refreshRightTaskLabelTemplate:function(n){var t=this;this.model.rightTaskLabelTemplate=n;t._$ganttchartHelper.ejGanttChart("refreshRightTaskLabelTemplate",n)},_updateRendeProgressStatus:function(n){var t=this;this.model.showProgressStatus=n;t._$ganttchartHelper.ejGanttChart("updateRendeProgressStatus",n)},_updateRenderResourceNames:function(n){var t=this;this.model.showResourceNames=n;t._$ganttchartHelper.ejGanttChart("updateRenderResourceNames",n)},_updateTaskbarBackground:function(n){var t=this;this.model.taskbarBackground=n;t._$ganttchartHelper.ejGanttChart("updateTaskbarBackground",n)},_updateProgressbarBackground:function(n){var t=this;this.model.progressbarBackground=n;t._$ganttchartHelper.ejGanttChart("updateProgressbarBackground",n)},_updateParentTaskbarBackground:function(n){var t=this;this.model.parentTaskbarBackground=n;t._$ganttchartHelper.ejGanttChart("updateParentTaskbarBackground",n)},_updateParentProgressbarBackground:function(n){var t=this;this.model.parentProgressbarBackground=n;t._$ganttchartHelper.ejGanttChart("updateParentProgressbarBackground",n)},_updateEditSettings:function(n){var t=this;t._$ganttchartHelper.ejGanttChart("updateEditSettings",n);t._$treegridHelper.ejTreeGrid("updateEditSettings",n);t._updateToolbarOptions()},_updateRowSelection:function(n){var t=this;t._$treegridHelper.ejTreeGrid("updateRowSelection",n)},_updateAltRow:function(n){var t=this;t._$treegridHelper.ejTreeGrid("option","enableAltRow",n)},_renderAddedRow:function(n,i){var r=this,u=this.model,f;u.currentViewData=r._$treegridHelper.ejTreeGrid("getUpdatedCurrentViewData");r._$ganttchartHelper.ejGanttChart("setUpdatedRecords",u.currentViewData,u.updatedRecords,u.flatRecords,u.ids);i.eResourceTaskType!="resourceChildTask"&&(u.enableVirtualization?(f={},f.requestType=t.TreeGrid.Actions.Refresh,r._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",f),r._$ganttchartHelper.ejGanttChart("refreshHelper",u.currentViewData,u.updatedRecords,r._totalCollapseRecordCount)):(r._$treegridHelper.ejTreeGrid("renderNewAddedRow",n,i),r._$ganttchartHelper.ejGanttChart("renderNewAddedRow",n,i)));r._$treegridHelper.ejTreeGrid("updateHeight");r._gridRows=r.getRows();r._ganttChartRows=r.getGanttChartRows()},_getVisibleChildRecordCount:function(n,t,i){var e=this,o=this.model,u,f,r;if(n.hasChildRecords)for(u=n.childRecords,f=u.length,r=0;r<f;r++)i.indexOf(u[r])!==-1&&t++,u[r].hasChildRecords&&(t=e._getVisibleChildRecordCount(u[r],t,i));else i.indexOf(n)!==-1&&t++;return t},openAddDialog:function(){this.cancelEditCell();this._sendAddRequest()},openEditDialog:function(){this.cancelEditCell();this._sendEditRequest()},searchItem:function(t){var i=this;i.cancelEditCell();i._searchString!=t&&(i._$treegridHelper.ejTreeGrid("search",t),i._searchString=t,n("#gantt_search input").val(t))},selectMultipleRows:function(n){var r=this,u=r.model,e,f=r._$treegridHelper.ejTreeGrid("instance"),o=r._$ganttchartHelper.ejGanttChart("instance"),i;if(u.selectionMode!="cell"&&u.selectionType!=t.Gantt.SelectionType.Single&&!t.isNullOrUndefined(n)){for(n.length!=0&&r.clearSelection(),e=r.getUpdatedRecords(),i=0;i<n.length;i++)!t.isNullOrUndefined(e[n[i]])&&(!u.enableVirtualization&&r.getExpandStatus(e[n[i]])||u.enableVirtualization)&&(f._rowSelectingEventTrigger(this.selectedRowIndex(),n[i])||(o._multiSelectCtrlRequest=f._multiSelectCtrlRequest=!0,r._$treegridHelper.ejTreeGrid("selectRows",n[i]),f._rowSelectedEventTrigger(n[i])));o._multiSelectCtrlRequest=f._multiSelectCtrlRequest=!1}},addRecord:function(i,r){var f=this,e=this.model,ft=e.selectionMode=="row"?this.selectedRowIndex():f._rowIndexOfLastSelectedCell,o=e.updatedRecords[ft],u,ut=e.taskIdMapping,l=e.updatedRecords,w=e.flatRecords,d=e.parentRecords,g=e.ids,a=this.dataSource(),et,p=0,k,c={},s,lt,st,ht,nt,tt,h,b,v,y,it,ot,rt,ct;if(f.clearSelection(),f.cancelEditCell(),n.type(a)==="array"||a instanceof t.DataManager||(this.dataSource([]),a=this.dataSource()),Object.prototype.toString.call(i)!=="[object Object]"&&(i={}),(ft!==-1||r!==t.Gantt.RowPosition.AboveSelectedRow&&r!==t.Gantt.RowPosition.BelowSelectedRow&&r!==t.Gantt.RowPosition.Child)&&r||(r=t.Gantt.RowPosition.Top),e.viewType==t.Gantt.ViewType.ResourceView&&r!==t.Gantt.RowPosition.Top&&r!==t.Gantt.RowPosition.Bottom&&(r=t.Gantt.RowPosition.Top),i[ut]&&(lt=e.viewType=="projectView"?e.ids:this._resourceUniqTaskIds,i[ut]=lt.indexOf(i[ut].toString())==-1||this._isOnResourceUpdate?isNaN(parseInt(i[ut]))?null:parseInt(i[ut]):null),f._updateAddData(i,r),f._isDataManagerUpdate&&(f._jsonData=f._$treegridHelper.ejTreeGrid("getUpdatedDataManagerData")),e.viewType==t.Gantt.ViewType.ResourceView&&i[e.resourceInfoMapping]&&i[e.resourceInfoMapping].length>0){for(u=f._createGanttRecord(i,1),st=i[e.resourceInfoMapping],ht=st.length,nt=0;nt<ht;nt++)tt=w[g.indexOf("R_"+st[nt])],tt&&(h=new t.Gantt.GanttRecord,h=n.extend(!0,h,u),h.item=u.item,nt==0&&this._updateResourceUniqIndex(h),h.eResourceTaskType="resourceChildTask",h.level=tt.level,h.parentItem=tt,tt.eResourceChildTasks.push(h),this._resourceChildTasks.push(h),this._updateOverlappingValues(h.parentItem),this._updateResourceParentItem(h),f.refreshGanttRecord(h.parentItem),this._updateSharedResourceTask(h),nt==ht-1&&(f._isDataManagerUpdate&&this._isFlatResourceData?this._jsonData.push(h.item):f._isFlatResourceData?a.push(h.item):tt.item[e.taskCollectionMapping].push(h.item),this._refreshGanttHeightWithRecords()));u=h?h:u}else switch(r){case t.Gantt.RowPosition.Top:if(p=0,s=null,u=f._createGanttRecord(i,p),e.viewType==t.Gantt.ViewType.ResourceView&&(u.eResourceName=this._unassignedText,u.eResourceTaskType="unassignedTask",this._updateResourceUniqIndex(u)),u.index=u.taskId,c.data=i,c.currentRecord=u,!f._validateAddRecordPrecessorValue(c)&&f._isinAddnewRecord)return!1;w.splice(0,0,u);l.splice(0,0,u);g.splice(0,0,u.taskId.toString());d.splice(0,0,u);f._isDataManagerUpdate?f._jsonData.splice(0,0,u.item):a.splice(0,0,u.item);k=0;break;case t.Gantt.RowPosition.Bottom:if(p=0,s=null,u=f._createGanttRecord(i,p),e.viewType==t.Gantt.ViewType.ResourceView&&(u.eResourceName=this._unassignedText,u.eResourceTaskType="unassignedTask",this._updateResourceUniqIndex(u)),u.index=u.taskId,c.data=i,c.currentRecord=u,!f._validateAddRecordPrecessorValue(c)&&f._isinAddnewRecord)return!1;w.push(u);l.push(u);g.push(u.taskId.toString());d.push(u);f._isDataManagerUpdate?f._jsonData.push(u.item):a.push(u.item);k=l.indexOf(u);break;case t.Gantt.RowPosition.AboveSelectedRow:if(p=o.level,s=o.parentItem,u=f._createGanttRecord(i,p,s),u.index=u.taskId,c.data=i,c.currentRecord=u,!f._validateAddRecordPrecessorValue(c)&&f._isinAddnewRecord)return!1;v=w.indexOf(o);y=l.indexOf(o);w.splice(v,0,u);l.splice(y,0,u);g.splice(v,0,u.taskId.toString());t.isNullOrUndefined(s)?(d.splice(d.indexOf(o),0,u),f._isDataManagerUpdate?f._jsonData.splice(f._jsonData.indexOf(o.item),0,u.item):a.splice(a.indexOf(o.item),0,u.item)):(b=s.childRecords.indexOf(o),s.childRecords.splice(b,0,u),e.parentTaskIdMapping?(u.item[e.parentTaskIdMapping]=u.parentItem.taskId,f._isDataManagerUpdate?f._jsonData.push(u.item):a.push(u.item)):s.item[e.childMapping].splice(b,0,u.item));k=y;break;case t.Gantt.RowPosition.BelowSelectedRow:if(p=o.level,s=o.parentItem,u=f._createGanttRecord(i,p,s),u.index=u.taskId,c.data=i,c.currentRecord=u,!f._validateAddRecordPrecessorValue(c)&&f._isinAddnewRecord)return!1;it=w.indexOf(o);o.hasChildRecords?(et=f._$treegridHelper.ejTreeGrid("getChildCount",o,0),v=it+et+1,y=l.indexOf(o)+f._getVisibleChildRecordCount(o,0,l)+1):(v=it+1,y=l.indexOf(o)+1);w.splice(v,0,u);l.splice(y,0,u);g.splice(v,0,u.taskId.toString());t.isNullOrUndefined(s)?(d.splice(d.indexOf(o)+1,0,u),f._isDataManagerUpdate?f._jsonData.splice(f._jsonData.indexOf(o.item)+1,0,u.item):a.splice(a.indexOf(o.item)+1,0,u.item)):(b=s.childRecords.indexOf(o),s.childRecords.splice(b+1,0,u),e.parentTaskIdMapping?(u.item[e.parentTaskIdMapping]=u.parentItem.taskId,f._isDataManagerUpdate?f._jsonData.push(u.item):a.push(u.item)):s.item[e.childMapping].splice(b+1,0,u.item));k=y;break;case t.Gantt.RowPosition.Child:if(p=o.level+1,s=o,u=f._createGanttRecord(i,p,s),u.index=u.taskId,c.data=i,c.currentRecord=u,!f._validateAddRecordPrecessorValue(c)&&f._isinAddnewRecord)return!1;it=w.indexOf(o);o.hasChildRecords?(et=f._$treegridHelper.ejTreeGrid("getChildCount",o,0),v=it+et+1,o.expanded||(ot={},ot.expanded=!0,ot.data=o,f._isInAdd=!0,f.expanding(ot),f._isInAdd=!1,l=f.getUpdatedRecords()),y=l.indexOf(o)+f._getVisibleChildRecordCount(o,0,l)+1):(o.hasChildRecords=!0,o.childRecords=[],o.expanded=!0,e.parentTaskIdMapping||(o.item[e.childMapping]=[]),o.isMilestone=!1,v=it+1,y=l.indexOf(o)+1,o.predecessor&&f._updatePredecessorOnIndentOutdent(o));w.splice(v,0,u);l.splice(y,0,u);g.splice(v,0,u.taskId.toString());t.isNullOrUndefined(s)||(b=s.childRecords.indexOf(o),s.childRecords.splice(b+1,0,u),e.parentTaskIdMapping?(u.item[e.parentTaskIdMapping]=u.parentItem.taskId,f._isDataManagerUpdate?f._jsonData.push(u.item):a.push(u.item)):s.item[e.childMapping].splice(b+1,0,u.item));k=y}return f._deSelectRowItem(),f._$treegridHelper.ejTreeGrid("setUpdatedRecords",e.flatRecords,e.updatedRecords,e.ids,e.parentRecords,this.dataSource()),e.enableWBS&&e.viewType=="projectView"&&f.updateWBSdetails(u),e.viewType=="projectView"&&(f._$treegridHelper.ejTreeGrid("updateSerialNumber",k),e.enableSerialNumber&&f._$treegridHelper.ejTreeGrid("updateSerialNumberPredecessors",k)),rt={},rt.requestType="save",rt._cAddedRecord=rt.addedRecord=u,rt.index=k,f.actionComplete(rt),ct=f._$treegridHelper.ejTreeGrid("instance"),e.enableVirtualization===!1&&(ct.model.sortSettings.sortedColumns.length>0||ct._searchString.length>0)&&(f._isRefreshAddedRecord=!0),e.selectionMode=="cell"?(ft=e.updatedRecords.indexOf(u),f._$treegridHelper.ejTreeGrid("updateScrollBar",ft)):f._$treegridHelper.ejTreeGrid("updateScrollBar"),!0},updateWBSdetails:function(n,t,i){var c=this,e=c.model,r=n?n:e.selectionMode=="row"?e.selectedItem:e.updatedRecords[c._rowIndexOfLastSelectedCell],o=r.WBS,l,s,a,u,h,v,y,f,p;r.parentItem?(l=r.parentItem.childRecords,s=l.indexOf(r),u=l,h=u.length):e.flatRecords.length&&(v=e.flatRecords,y=v.filter(function(n){return n&&n.level==0}),u=y,s=u.indexOf(r),h=u.length);a=t?u.slice(s,h):u.slice(s+1,h);a.length&&(f=o.lastIndexOf(".")!=-1?parseInt(o.substr(o.lastIndexOf(".")+1)):parseInt(o),p=r.parentItem?r.parentItem.WBS:null,t&&!i?f--:t&&i?f=f:f++,c.reCalculateWBS(a,f,p))},deleteItem:function(){var n=this;n.cancelEditCell();n._$treegridHelper.ejTreeGrid("deleteRow")},expandAllItems:function(){this.cancelEditCell();this._expandAll();this.updateSelectedItemIndex();this._$treegridHelper.focus()},collapseAllItems:function(){this._collapseAll();this.updateSelectedItemIndex();this._$treegridHelper.focus()},indentItem:function(){var e=this,n=this.model,u=e.model.flatRecords,t=n.selectedItem,i=!0,r,f;if(n.editSettings.allowIndent==!1||n.selectionMode=="cell"&&n.selectionType!="single")return!0;if(t&&n.selectedItems==1&&(r=u.indexOf(t),r===0?i=!1:t.level===0?i=!0:(f=u[r-1],i=t.level-f.level==1?!1:!0)),i)this._sendIndentRequest();else return!1},outdentItem:function(){if(this.model.selectionMode=="cell"&&this.model.selectionType!="single")return!0;this._sendOutdentRequest()},updateGanttColumns:function(n){var t=this,i=t.model;i.columns=n;t._columns=n},cancelEdit:function(){this.sendCancelRequest()},expandCollapseRecord:function(i){var e=this,u={},r,o=this.model,h,s,f;r=o.flatRecords[o.ids.indexOf(i.toString())];!t.isNullOrUndefined(r)&&r.hasChildRecords&&(u={},u.expanded=r.expanded==!0?!1:!0,h=e.getExpandStatus(r),h?(u.data=r,u.expanded?e.expanding(u):e.collapsing(u)):(r.expanded=u.expanded,s=o.currentViewData.indexOf(r),s==-1||o.enableVirtualization||(f=n(e.getRows()[s]),r.expanded?(f.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),f.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand")):(f.find(".e-treegridexpand").removeClass("e-treegridexpand").addClass("e-treegridcollapse"),f.removeClass("e-treegridrowexpand").addClass("e-treegridrowcollapse")))))},saveEdit:function(){var n=this;n._$treegridHelper.ejTreeGrid("endEdit")},setSplitterIndex:function(t){var r=this,o=r.model,h=r.getColumns(),u=0,s=n("#ejTreeGrid"+r._id+"e-gridcontent"),f=parseInt(t),e=h.filter(function(n){return n.visible!=!1}),i;if(f>-1&&f<e.length){for(i=0;i<=f;i++)u+=e[i].width;if(u>r._ganttWidth)for(u=0,i=0;i<=f;i++)if(u+e[i].width<=r._ganttWidth)u+=e[i].width,t=i;else{o.splitterSettings.index=t;break}else o.splitterSettings.index=f;s.ejScroller("isHScroll")&&s.ejScroller("scrollLeft",0);r.setSplitterPosition(u.toString())}},setSplitterPosition:function(i){var r=this,a=r.model,u=0,e=0,f,o=parseInt(r._ganttWidth)-r._totalBorderWidth,s=!1,l=r.splitterPosition(),h,c;t.isNullOrUndefined(i)||(i.indexOf("%")!=-1?(u=parseInt(i),s=!0):(u=parseInt(i)/r._ganttWidth*100,s=!1),u=isNaN(u)?0:u,u<=100?(u=u<0?0:u,e=100-u-900/o,e<=0?(s?r.splitterPosition("100%"):r.splitterPosition(o.toString()),u=100-900/o,e=0):e>0&&(s?r.splitterPosition(Math.round(u)+"%"):r.splitterPosition(Math.round(u*r._ganttWidth/100).toString())),f=n("#e-ejSpliter"+r._id).ejSplitter("instance"),f.model.properties[0].paneSize=u+"%",f.model.properties[1].paneSize=e+"%",f.refresh(),r._$treegridHelper.ejTreeGrid("refreshScroller",Math.round(u*o/100)),h=parseFloat(f.model.properties[1].paneSize)>0?f.model.properties[1].paneSize-1:0,r._$ganttchartHelper.ejGanttChart("refreshScroller",h),r._clearContextMenu(),r._updateScrollerBorder()):(f=n("#e-ejSpliter"+r._id).ejSplitter("instance"),u=f.model.properties[0].paneSize,e=f.model.properties[1].paneSize,parseInt(e)==0?s?r.splitterPosition("100%"):r.splitterPosition(o.toString()):s?r.splitterPosition(Math.round(parseInt(u)/o*100)+"%"):r.splitterPosition(u.toString())),r._splitterPosition(r.splitterPosition()),r._splitterOnResize==!1&&(c={prevSplitterPosition:l,isOnResize:!1,currentSplitterPosition:r.splitterPosition()},r._trigger("splitterResized",c)))},_updateScrollerBorder:function(){var e=this,s=n("#ejTreeGrid"+this._id+"e-gridcontent").data("ejScroller"),i=n("#ganttviewerbodyContianerejGanttChart"+this._id),r=n("#ganttviewerbodyContianerejGanttChart"+this._id).data("ejScroller"),u=!1,f=!1,o=n("#ejTreeGrid"+this._id+"e-gridcontent"),h=n("#ganttviewerbodyContianerejGanttChart"+this._id).find("div.e-content"),t;s&&s.isHScroll()&&(u=!0);r&&r.isHScroll()&&(f=!0);o.removeClass("e-borderbox");i.removeClass("e-borderbox");t=e._$ganttchartHelper.ejGanttChart("getViewportHeight");u&&!f?(o.removeClass("e-borderbox"),i.addClass("e-borderbox"),r.option("height",t-18),i.height(t-16),e._$ganttchartHelper.ejGanttChart("setViewPortHeight")):!u&&f?(o.addClass("e-borderbox"),i.removeClass("e-borderbox"),r.option("height",t),i.height(t),e._$ganttchartHelper.ejGanttChart("updateViewPortHeight")):u&&f?(r.option("height",t),i.height(t),e._$ganttchartHelper.ejGanttChart("updateViewPortHeight")):u||f||(r.option("height",t),i.height(t))},_showTooltip:function(n){var t=this;this.model.enableTaskbarTooltip=n;t._$ganttchartHelper.ejGanttChart("showTooltip",n)},_showEditingTooltip:function(n){var t=this;this.model.enableTaskbarDragTooltip=n;t._$ganttchartHelper.ejGanttChart("showEditingTooltip",n)},_ganttChartEditing:function(t){var i=this;i.model.allowGanttChartEditing=t;i._$ganttchartHelper.ejGanttChart("ganttChartEditing",t);t?(n(".e-gantt-childtaskbar, .e-tasklabel, .progressbar").css({cursor:"move"}),n(".taskbarresizer-right").css({cursor:"w-resize"}),n(".taskbarresizer-left").css({cursor:"e-resize"})):n(".e-gantt-childtaskbar, .e-tasklabel, .progressbar, .taskbarresizer-right, .taskbarresizer-left").css({cursor:"auto"})},_resizeProgressbar:function(n){var t=this;t.model.enableProgressBarResizing=n;t._$ganttchartHelper.ejGanttChart("resizeProgressbar",n)},_milestoneTemplate:function(n){var t=this;t.model.milestoneTemplate=n;t._$ganttchartHelper.ejGanttChart("changeMilestoneTemplate",t.model.milestoneTemplate)},_taskbarTemplate:function(n){var t=this;t.model.taskbarTemplate=n;t._$ganttchartHelper.ejGanttChart("changeTaskbarTemplate",t.model.taskbarTemplate)},_parentTaskbarTemplate:function(n){var t=this;t.model.parentTaskbarTemplate=n;t._$ganttchartHelper.ejGanttChart("changeParentTaskbarTemplate",t.model.parentTaskbarTemplate)},_sendSortingRequest:function(n){var t=this;t.model.sortSettings=n;t._$treegridHelper.ejTreeGrid("option","sortSettings",n)},_sortingRequest:function(n){var i=this,t=i.model;t.allowSorting=n;t.allowSorting||(t.sortSettings.sortedColumns=[]);i._$treegridHelper.ejTreeGrid("sortSetting",n)},_columnIndex:function(n){var t=this;t._$treegridHelper.ejTreeGrid("columnIndex",n)},sendCancelRequest:function(){var t=this,i=n("#"+t._id+"_toolbarItems");t._$treegridHelper.ejTreeGrid("cancelEditCell");t.model.toolbarSettings.toolbarItems.indexOf("cancel")!==-1&&t._disabledToolItems.push(n(i).find(".e-cancel").parent()[0]);t.model.toolbarSettings.toolbarItems.indexOf("save")!==-1&&t._disabledToolItems.push(n(i).find(".e-saveitem").parent()[0]);n(i).ejToolbar("disableItem",t._disabledToolItems);t._disabledToolItems=[]},_sendAddRequest:function(){var n=this,r=n.model.viewType==t.Gantt.ViewType.ProjectView?n._columns:n._resourceViewColumns,e=r.length,i=0,f={},u={};for(n._clearMultiSelectPopup(),i;i<e;i++)r[i].mappingName&&(f[r[i].mappingName]="");u.data=f;u.requestType="add";n.renderedEditDialog(u)},_sendEditRequest:function(i,r){var u=this,f=u.model,e={},o;(u._clearMultiSelectPopup(),r&&r.isResourceView?e.data=r.data:(t.isNullOrUndefined(i)?(u._currentTrIndex=f.selectionMode=="row"?this.selectedRowIndex():u._rowIndexOfLastSelectedCell,u._$currentTr=n(u._$treegridHelper.ejTreeGrid("getRows")).eq(this.selectedRowIndex())):(u._currentTrIndex=i.index(),u._$currentTr=i),o=u.getUpdatedRecords()[u._currentTrIndex],e.data=o),(f.selectionMode!="row"||f.selectedItems.length==1)&&(f.selectionMode!="cell"||f.selectedCellIndexes.length==1))&&(e.requestType="beginedit",e.data&&u.renderedEditDialog(e))},_updateAddData:function(n,i){var u=this,r=this.model,e,f;n[r.taskIdMapping]||(e=u._getNewTaskId(),n[r.taskIdMapping]=e);r.taskNameMapping&&!n[r.taskNameMapping]&&(n[r.taskNameMapping]=u._newTaskTexts.newTaskName+" "+n[r.taskIdMapping]);r.allowUnscheduledTask||n[r.startDateMapping]||(n[r.startDateMapping]=r.scheduleStartDate);!r.allowUnscheduledTask&&r.durationMapping&&t.isNullOrUndefined(n[r.durationMapping])&&(n[r.endDateMapping]||(n[r.durationMapping]="5"));r.progressMapping&&(n[r.progressMapping]=n[r.progressMapping]?n[r.progressMapping]>100?100:n[r.progressMapping]:0);r.allowUnscheduledTask||n[r.endDateMapping]||!r.endDateMapping||n[r.durationMapping]||(f=u._getDateFromFormat(r.scheduleStartDate),f.setDate(f.getDate()+4),n[r.endDateMapping]=t.format(f,this.model.dateFormat,this.model.locale));r.enableWBS&&!n.WBS&&(n.WBS=u._getNewWBSid(i));r.enableWBS&&!n.WBS&&(n.WBS=u._getNewWBSid(i));t.isNullOrUndefined(r.selectedItem)||(n.taskType=r.workMapping?t.Gantt.TaskType.FixedWork:r.selectedItem.taskType,n.effortDriven=r.workMapping?"true":r.selectedItem.effortDriven)},_sendSaveRequest:function(i){var e={},ri=document,r=this,f=r.model,w,ui,pi,d,fi,et,a,ot,it,rt,g,ut,u={},c,yt,nt,pt,st=this._resourceCollection,v,o,wt,ei,ht,bt,h,ni,l,p,tt,k,at,li,vt,ai,ii,vi,ft,yi;if(this._duplicate=!1,this._wrongenddate=!1,i==="Add"){if(w=ri.querySelectorAll("#"+r._id+"GeneralAddForm","#"+r._id+"PredecessorAddForm","#"+r._id+"ReosurceAddForm","#"+r._id+"CustomFieldsAddForm"),ui=w&&w.length,ot="Add",it="#treegrid"+r._id+"predecessorAdd",rt="#treegrid"+r._id+"resourceAdd",g="#treegrid"+r._id+"customFieldAdd",ut="#"+r._id+"AddAreaNotes",d=n("#"+r._id+"taskId"+ot),et=t.TreeGrid.getColumnByField(r._columns,"taskId"),r._cellEditColumn=et,c=r._addDialogGeneralColumns,yt=c.length,nt=r._addDialogCustomColumns,pt=nt.length,et&&d.length>0&&(a=r.getCurrentEditCellData(d,et.dropdownData)),r.model.ids.indexOf(a)!=-1&&a?this._duplicate=!0:a&&(this._duplicate=!1),!this.addFormValidate())return!0}else if(w=ri.getElementById(r._id+"GeneralEditForm"),ui=w&&w.length,it="#treegrid"+r._id+"predecessorEdit",rt="#treegrid"+r._id+"resourceEdit",g="#treegrid"+r._id+"customFieldEdit",ut="#"+r._id+"EditAreaNotes",ot="Edit",c=r._editDialogGeneralColumns,yt=c.length,nt=r._editDialogCustomColumns,pt=nt.length,!this.editFormValidate())return!0;if(pi=n(w).closest("div"),this._duplicate)return alert(r._alertTexts.idValidationAlert),!0;for(o=0;o<yt;o++)if(d=n(w).find("#"+r._id+c[o].field+ot),d.length>0){if(r._cellEditColumn=c[o],r._cellEditColumn.field=="duration"||r._cellEditColumn.field=="startDate"||r._cellEditColumn.field=="endDate"){e[c[o].mappingName]=this._editedDialogRecord[r._cellEditColumn.field];r._cellEditColumn.field=="duration"&&f.durationUnitMapping&&(e[f.durationUnitMapping]=this._editedDialogRecord.durationUnit);continue}a=r.getCurrentEditCellData(d,c[o].dropdownData);r._isinAddnewRecord===!1&&c[o].mappingName===r.model.predecessorMapping&&(u.previousValue=r._updatePredecessorValue(null,a));c[o].mappingName===r.model.progressMapping&&t.isNullOrUndefined(a)&&(a=0);(f.workMapping||r._cellEditColumn.field!="work")&&r._cellEditColumn.field!="taskType"&&r._cellEditColumn.field!="effortDriven"?e[c[o].mappingName]=a:e[c[o].field]=a}if(n(g).length)for(n(g).ejTreeGrid("model.isEdit")&&n(g).ejTreeGrid("saveCell"),v=n(g).ejTreeGrid("model.updatedRecords"),o=0;o<pt;o++)e[nt[o].mappingName]=nt[o].editType=="dropdownedit"?v[o].value:v[o].text;wt=n(ut);wt.length&&(ei=n(ut).data("ejRTE"),t.isNullOrUndefined(ei)&&n(ut).ejRTE({}),e[f.notesMapping]=wt.ejRTE("getHtml"));var oi=r._getDateFromFormat(e[f.startDateMapping]),si=r._getDateFromFormat(e[f.endDateMapping]),hi=0;if(oi&&si&&(hi=si.getTime()-oi.getTime()),this._wrongenddate=hi<0?!0:!1,this._wrongenddate)return alert(r._alertTexts.dateValidationAlert),!0;if(ht=n(rt),bt=!0,ht.length>0){n(ht).ejTreeGrid("model.isEdit")&&n(ht).ejTreeGrid("saveCell");var kt=[],v=n(rt).ejTreeGrid("option","dataSource"),bi=n(rt).ejTreeGrid("option","selectedRowIndex"),b,y=r._editedDialogRecord,s=[],ci=f.resourceIdMapping;if(i!="Add"&&(t.isNullOrUndefined(r._editedDialogRecord.resourceInfo)&&(r._editedDialogRecord.resourceInfo=[]),n.extend(!0,s,r._editedDialogRecord.resourceInfo)),n.each(v,function(u,o){var h,c,l,a,p;if(o.name!==null&&o.name!==""){for(h=0;h<st.length;h++)if(st[h][f.resourceIdMapping].toString()==o.name){b=n.extend({},st[h]);break}if(i==="Add")kt.push(b[f.resourceIdMapping]),b[f.resourceUnitMapping]=o.unit,r._newRecordResourceCollection.push(b);else{if((t.isNullOrUndefined(s)||s.length!=v.length)&&(r._isResourceAddedOrRemoved=!0),s.length>0)for(c=0;c<s.length;c++)if(s[c][ci]===b[ci]){l=c;break}else l=-1;(t.isNullOrUndefined(l)||l==-1)&&s.length!=v.length&&(a=n.extend({},b),y._updateResourceUnit(b,a,f.resourceUnitMapping),a[f.resourceUnitMapping]=100,s.push(a));s[u]&&s[u][f.resourceUnitMapping]!=v[u].unit&&f.viewType=="projectView"&&(r._isExistingUnitIsUpdated=!0);p=st.filter(function(n){return typeof n[f.resourceIdMapping]=="number"?n&&n[f.resourceIdMapping]==parseInt(v[u].name):n&&n[f.resourceIdMapping]==v[u].name});s[u]=n.extend({},p[0]);s[u][f.resourceUnitMapping]=v[u].unit;kt.push(s[u]);r._isExistingUnitIsUpdated&&(y.isAutoSchedule&&y.taskType!="fixedDuration"?y._updateDurationWithWork(r,s):y._updateWorkWithDuration(r,s),e.Duration=y.duration,f.workMapping?e[f.workMapping]=y.work:e.work=y.work,r._editedDialogRecord.duration=y.duration,r._editedDialogRecord.work=y.work,r._isExistingUnitIsUpdated=!1)}}else return bt=!1,!1}),bt)e[f.resourceInfoMapping]=kt;else return alert(r._alertTexts.dialogResourceAlert),!0}e[f.taskIdMapping]||i!=="Edit"||(e[f.taskIdMapping]=r._editedDialogRecord.taskId);u.data=e;u.currentRecord=f.viewType=="resourceView"?r._resourceEditedRecord:f.selectionMode=="row"?this.selectedItem():f.updatedRecords[r._rowIndexOfLastSelectedCell];var dt=[],gt=!1;if(f.predecessorMapping&&(i==="Edit"?(gt=f.editDialogFields.length===0?!0:!1,dt=n.grep(f.editDialogFields,function(n){return n.field===f.predecessorMapping})):i==="Add"&&(gt=f.addDialogFields.length===0?!0:!1,dt=n.grep(f.addDialogFields,function(n){return n.field===f.predecessorMapping}))),dt.length>0||gt){if(h=[],ni=!0,n(it).ejTreeGrid("model.isEdit")&&n(it).ejTreeGrid("saveCell"),h=n(it).ejTreeGrid("option","dataSource"),n.each(h,function(n,i){(t.isNullOrUndefined(i.id)||t.isNullOrUndefined(i.name)||t.isNullOrUndefined(i.type)||!(i.id.length>0&&i.name.length&&i.type.length))&&(ni=!1)}),ni){var wi=[],ct=[],lt=r._predecessorCollectionText,li=[],ti;for(l=0;l<h.length;l++){for(p={},p.from=e.taskID,p.to=f.enableSerialNumber?r._recordIdFromSerialnumber(h[l].id):h[l].id,p.isdrawn=!1,p.offset=h[l].offset,tt=0;tt<lt.length;tt++)if(h[l].type==lt[tt].text){p.predecessorType=lt[tt].id;ti=lt[tt].id;break}k=p.to+ti;h[l].offset=parseFloat(h[l].offset);h[l].offset!==0&&(k+=h[l].offset<0?p.offset.toString():"+"+p.offset.toString());ct.push(k);wi.push(p);f.enableSerialNumber&&(at="",vt=+h[l].id,k.indexOf("+")!=-1?at="+"+k.split("+")[1]:k.indexOf("-")!=-1&&(at="-"+k.split("-")[1]),+u.data.serialNumber<=vt&&i==="Add"&&(vt+=1),li.push(vt+ti+at))}u.predecessorString=ct}else return alert(r._alertTexts.predecessorAddingValidationAlert),!0;if(r._isinAddnewRecord===!1)if(r._editedPredecessorValidation(u))ai=t.isNullOrUndefined(u.currentRecord.predecessorsName)?"":u.currentRecord.predecessorsName,ii=ct.join(","),ai!=ii&&(r._isPredecessorEdited=!0),u.previousValue=r._updatePredecessorValue(u.currentRecord,ii);else return alert(r._alertTexts.predecessorEditingValidationAlert),!0;e[f.predecessorMapping]=ct.join(",");f.enableSerialNumber&&(e.serialNumberPredecessor=li.join(","))}if(u.requestType=t.TreeGrid.Actions.Save,u.recordIndex=this.selectedRowIndex()!==-1?this.selectedRowIndex():-1,r._trigger("actionBegin",u))return!0;if(i==="Edit")f.viewType=="resourceView"?r._previousResource=n.extend(!0,[],r._resourceEditedRecord.resourceInfo):fi=u.currentRecord?new Date(u.currentRecord.startDate):null,u._cModifiedData=r._updateRecord(e,r._resourceEditedRecord),r._editedDialogRecord&&(u._cModifiedData.startDate=r._getDateFromFormat(r._editedDialogRecord.startDate),u._cModifiedData.endDate=r._getDateFromFormat(r._editedDialogRecord.endDate),u._cModifiedData.duration=r._editedDialogRecord.duration,u._cModifiedData.durationUnit=r._editedDialogRecord.durationUnit,u._cModifiedData.work=r._editedDialogRecord.work,f.workMapping&&(u._cModifiedData.item[f.workMapping]=r._editedDialogRecord.work),r._isResourceAddedOrRemoved&&r._updateResourceRelatedFields(u._cModifiedData),f.durationUnitMapping&&(u._cModifiedData.item[f.durationUnitMapping]=r._editedDialogRecord.durationUnit),r._editedDialogRecord=null),u.data[f.endDateMapping]&&(t.isNullOrUndefined(u.data[f.durationMapping])||u.data[f.durationMapping]==="")&&r._isDurationUpdated==!1&&(u._cModifiedData.startDate=r._checkStartDate(u._cModifiedData.startDate,u._cModifiedData),u._cModifiedData.endDate=r._checkEndDate(u._cModifiedData.endDate,u._cModifiedData),u._cModifiedData._calculateDuration(this)),u._cModifiedData.isMilestone=u._cModifiedData.duration==0&&r._compareDatesFromRecord(u._cModifiedData)==0?!0:!1,u.data[f.baselineStartDateMapping]&&u.data[f.baselineEndDateMapping]&&(vi=r._getDateFromFormat(u.data[f.baselineStartDateMapping]),ft=r._getDateFromFormat(u.data[f.baselineEndDateMapping]),ft&&ft.getHours()==0&&this._defaultEndTime!=86400&&this._setTime(this._defaultEndTime,ft),u._cModifiedData.baselineStartDate=this._checkBaseLineStartDate(vi),u._cModifiedData.baselineEndDate=this._checkBaseLineEndDate(ft),u._cModifiedData.baselineLeft=u._cModifiedData._calculateBaselineLeft(this),u._cModifiedData.baselineRight=u._cModifiedData._calculateBaselineRight(this),u._cModifiedData.baselineWidth=u._cModifiedData._calculateBaseLineWidth(this)),u.modifiedRecord=u._cModifiedData,u.previousStartDate=fi,r.actionComplete(u),r._isPredecessorEdited=!1;else if(i==="Add"&&(yi=r._addPosition!=null?r._addPosition:f.editSettings.rowPosition,!r.addRecord(e,yi)))return alert(r._alertTexts.predecessorEditingValidationAlert),!0;return r._cModifiedData=null,r._cAddedRecord=null,r._primaryKeyValues=[],r._isinAddnewRecord=!1,r._isResourceAddedOrRemoved=!1,!1},_recordReturnerByID:function(n){for(var r=this,i=r.model.flatRecords,t=0;t<i.length;t++)if(i[t].taskId.toString()===n.toString())return i[t];return null},_sendCancelRequest:function(){var i=this,u=i.model,r={};u.dateFormat.toLowerCase().indexOf("hh")!=-1?n("#"+i._id+"EditForm").find(".e-datepicker").ejDateTimePicker("destroy"):n("#"+i._id+"EditForm").find(".e-datepicker").ejDatePicker("destroy");r.requestType=t.TreeGrid.Actions.Cancel;i._$treegridHelper.ejTreeGrid("processBindings",r);i._primaryKeyValues=[];i.model.currentData=null},getCurrentEditCellData:function(i,r){var u=this,o=u.model,e,f;if(n("#"+u._id+"EditForm").length||n("#"+u._id+"GeneralAddForm").length||n("#"+u._id+"GeneralEditForm").length){f="";switch(u._cellEditColumn.editType){case t.TreeGrid.EditingType.String:f=i.val();break;case t.TreeGrid.EditingType.Numeric:f=i.ejNumericTextbox("getValue");break;case t.TreeGrid.EditingType.Dropdown:f=i.attr("id").indexOf("resourceInfo")>0?u._getSelectedItem(i.ejDropDownList("model.selectedItems"),r):i.attr("id").indexOf("taskMode")>0?i.ejDropDownList("model.value")=="true"?!0:!1:i.ejDropDownList("model.value");break;case t.TreeGrid.EditingType.Boolean:f=i.is(":checked");break;case t.TreeGrid.EditingType.DatePicker:e=i.ejDatePicker("model.value");f=u._cellEditColumn&&!u._cellEditColumn.format?u.getFormatedDate(e):e;break;case t.TreeGrid.EditingType.DateTimePicker:e=i.ejDateTimePicker("model.value");f=u._cellEditColumn&&!u._cellEditColumn.format?f=u.getFormatedDate(e):e;break;case t.TreeGrid.EditingType.Maskedit:f=i.ejMaskEdit("model.value")}return f}return null},_getSelectedItem:function(t,i){var r=0,f=t.length,u=[];if(i)for(r=0;r<f;r++)n.each(i,function(n,i){t[r]===n&&u.push(i)});return u},_getDropDownText:function(i,r){var s,u=i.editParams,e,f,l=i.dropdownData,a,h=u&&!t.isNullOrUndefined(u.delimiterChar)?u.delimiterChar:",",c=[],o;if(typeof r=="string"&&r.indexOf(h)>-1&&(r=r.split(h),s=r.length),u&&u.fields?(f=u.fields.text?u.fields.text:"text",e=u.fields.value?u.fields.value:"value"):(e="value",f="text"),s){for(o=0;o<s;o++)n.each(l,function(n,i){if(t.isNullOrUndefined(i[e])){if(r[o]===i[f].toString())return c.push(i[f].toString()),!1}else if(r[o]===i[e].toString())return c.push(i[f]),!1});return c.join(h)}return n.each(l,function(n,i){if(!t.isNullOrUndefined(i[e])&&r.toString()===i[e].toString()||r===i[f])return a=i[f],!1}),a},_updateRecord:function(i,r){var o=this,s=this.model,u=s.viewType==t.Gantt.ViewType.ProjectView?o._columns:o._resourceViewColumns,a,f=0,v=s.selectionMode=="row"?this.selectedRowIndex():o._rowIndexOfLastSelectedCell,e=r?r:o.getUpdatedRecords()[v],c,h,l;if(o._isUpdateOffset=!1,s.editDialogFields.length>0){for(c=[],h=0;h<s.editDialogFields.length;h++)l=n.grep(u,function(n){return n.mappingName===s.editDialogFields[h].field}),l.length&&c.push(l[0]);u=c}for(a=u.length,f=0;f<a;f++)u[f].field.toString()!=="predecessor"&&(t.isNullOrUndefined(i[u[f].mappingName])||(u[f].field=="startDate"&&o._compareDates(e[u[f].field],i[u[f].mappingName])!=0&&(o._isUpdateOffset=!0),u[f].field=="endDate"&&o._compareDates(e[u[f].field],i[u[f].mappingName])!=0&&(o._isUpdateOffset=!0),u[f].field=="duration"&&e[u[f].field]!=i[u[f].mappingName]&&(o._isUpdateOffset=!0),u[f].field!="work"&&u[f].field!="taskType"&&(e[u[f].field]=i[u[f].mappingName],e.item[u[f].mappingName]=i[u[f].mappingName]),u[f].field=="work"&&(s.workMapping?(e[u[f].field]=i[u[f].mappingName],e.item[u[f].mappingName]=i[u[f].mappingName]):e[u[f].field]=i[u[f].field]),s.enableSerialNumber&&u[f].field=="serialNumberPredecessor"&&(e[u[f].field]=i[u[f].field])),u[f].field=="taskMode"&&(e.isAutoSchedule=!i[s.taskSchedulingModeMapping]),(u[f].field=="taskType"||u[f].field=="effortDriven")&&(e[u[f].field]=i[u[f].field]),u[f].field.toString()==="resourceInfo"&&o._updateResourceName(e),u[f].field.toString()==="notesText"&&(e.notes=i[s.notesMapping],e.notesText=o._getPlainText(i[s.notesMapping]),e.item[s.notesMapping]=i[s.notesMapping]));return e},updateRecordByTaskId:function(n){var u=this,i=u.model,f,r=n[i.taskIdMapping],o=typeof r=="number"?r.toString():typeof r=="string"?r:null,s,e;i.viewType=="resourceView"?u._updateResourceTask(n):t.isNullOrUndefined(o)||(f=i.ids.indexOf(o),f>-1&&(s=i.flatRecords[f],e=i.updatedRecords.indexOf(s),u.updateRecordByIndex(e,n)))},updateRecordByIndex:function(r,u){var h=this,o=h.model,k=o.updatedRecords,c={},w=r,d=!1,s=w>-1?k.length>0?k[w]:null:null,v=u,f,nt,a,e,b,y,r,g,l,p;if(h.cancelEditCell(),!t.isNullOrUndefined(s)){for(l=n.extend({},s.item),c.previousItem=n.extend(!0,{},s.item),n.each(u,function(n,t){(o.startDateMapping==n||o.endDateMapping==n||o.durationMapping==n)&&l[n]!=t&&(d=!0);l[n]=t}),u=l,nt=h.getColumns(),u[o.taskIdMapping]=s.item[o.taskIdMapping],f=h._createGanttRecord(u,s.level,s.parentItem,i),!f._isScheduledTask()||t.isNullOrUndefined(v[o.endDateMapping])||v[o.startDateMapping]||!t.isNullOrUndefined(v[o.durationMapping])||(a=h._getDateFromFormat(v[o.endDateMapping]),a.getHours()==0&&this._defaultEndTime!=86400&&this._setTime(this._defaultEndTime,a),a.getTime()>(!t.isNullOrUndefined(f.startDate)&&f.startDate.getTime())?(f.endDate=this._checkEndDate(a,f),f._calculateDuration(this)):(f.endDate=this._checkEndDate(a,f),f.startDate=this._getStartDate(f.endDate,f.duration,f.durationUnit,f))),s.isAutoSchedule=f.isAutoSchedule,s.isMilestone=f.isMilestone,e=["WBS","baselineEndDate","effortDriven","endDate","baselineStartDate","baselineStartDate","duration","manualEndDate","durationUnit","manualStartDate","notes","notesText","predecessorsName","resourceInfo","resourceNames","startDate","isAutoSchedule","manualDuration","taskType","taskName","work","status","item","predecessor"],b=h._getGanttColumnDetails(),y=0;y<b.customColDetails.length;y++)e.push(b.customColDetails[y].field);for(r=0;r<e.length;r++)e[r]!="taskId"&&(s.hasChildRecords&&s.isAutoSchedule&&(e[r]=="startDate"||e[r]=="endDate"||e[r]=="duration"||e[r]=="status"||e[r]=="predecessor")||(e[r]=="predecessor"?(g=t.isNullOrUndefined(f.item[o.predecessorMapping])?"":f.item[o.predecessorMapping],c.previousValue=h._updatePredecessorValue(s,g)):e[r]=="item"?(l=n.extend({},f.item),n.each(l,function(n,t){s.item[n]=t})):(!t.isNullOrUndefined(f[e[r]])||o.allowUnscheduledTask&&(e[r]=="startDate"||e[r]=="endDate"||e[r]=="duration"))&&(s[e[r]]=f[e[r]])));c.requestType=t.TreeGrid.Actions.Save;c.recordIndex=w;c.modifiedRecord=s;c._cModifiedData=c.modifiedRecord;h._isUpdateOffset=!0;d&&(s.isAutoSchedule||o.validateManualTasksOnLinking)?(p=h._getLinkedTaskArgs(s,"recordUpdate"),h._trigger("actionBegin",p)||(p.actionCompleteArgs=c,(!o.enablePredecessorValidation||o.enablePredecessorValidation&&h._validateTypes(p))&&h.actionComplete(c))):h.actionComplete(c)}},_updateResourceTask:function(r){var l=this,o=l.model,h={},c=r[o.taskIdMapping],u,a,s,d,p,f,w,v,e,b,k,y;if((c=typeof c=="number"?c.toString():typeof c=="string"?c:null,t.isNullOrUndefined(c))||(u=this._getRecordByTaskId(c),t.isNullOrUndefined(u))||u.eResourceTaskType=="unassignedTask"&&o.updatedRecords.indexOf(u)==-1)return!1;for(this.cancelEditCell(),a=n.extend({},u.item),p=!1,h.previousItem=n.extend(!0,{},u.item),n.each(r,function(n,t){(o.startDateMapping==n||o.endDateMapping==n||o.durationMapping==n)&&a[n]!=t&&(p=!0);a[n]=t}),d=this.getResourceViewEditColumns(),a[o.taskIdMapping]=u.item[o.taskIdMapping],s=this._createGanttRecord(a,u.level,u.parentItem,i),this.model.viewType=="resourceView"&&s.duration==0&&(s.duration=1,s._calculateEndDate(this)),u.isAutoSchedule=s.isAutoSchedule,u.isMilestone=s.isMilestone,f=["WBS","baselineEndDate","effortDriven","endDate","baselineStartDate","baselineStartDate","duration","manualEndDate","durationUnit","manualStartDate","notes","notesText","predecessorsName","resourceInfo","resourceNames","startDate","isAutoSchedule","manualDuration","taskType","taskName","work","status","item","predecessor"],w=this._getGanttColumnDetails(),v=0;v<w.customColDetails.length;v++)f.push(w.customColDetails[v].field);for(e=0;e<f.length;e++)f[e]!="taskId"&&(u.hasChildRecords&&u.isAutoSchedule&&(f[e]=="startDate"||f[e]=="endDate"||f[e]=="duration"||f[e]=="status"||f[e]=="predecessor")||(f[e]=="predecessor"?(b=t.isNullOrUndefined(s.item[o.predecessorMapping])?"":s.item[o.predecessorMapping],h.previousValue=this._updatePredecessorValue(u,b)):f[e]=="item"?(k=n.extend({},s.item),n.each(k,function(n,t){u.item[n]=t})):f[e]=="resourceInfo"?(this._previousResource=n.extend(!0,[],u[f[e]]),u[f[e]]=s[f[e]]):t.isNullOrUndefined(s[f[e]])||(u[f[e]]=s[f[e]])));h.requestType=t.TreeGrid.Actions.Save;h.modifiedRecord=u;h._cModifiedData=h.modifiedRecord;this._isUpdateOffset=!0;p&&(u.isAutoSchedule||o.validateManualTasksOnLinking)?(y=l._getLinkedTaskArgs(u,"recordUpdate"),l._trigger("actionBegin",y)||(y.actionCompleteArgs=h,(!o.enablePredecessorValidation||o.enablePredecessorValidation&&l._validateTypes(y))&&l.actionComplete(h))):this.actionComplete(h)},_getLinkedTaskArgs:function(n,t){var i={};return i.editMode=t,i.data=n,i.requestType="validateLinkedTask",i.validateMode={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},i},_getGanttColumnDetails:function(){var t={},r,i,f=this.model,u=-1,e=["taskId","taskMode","taskName","startDate","endDate","duration","resourceInfo","status","work","taskType","effortDriven","baselineStartDate","baselineEndDate","predecessor","WBS","notesText"],n;for(i=f.viewType=="projectView"?this.getColumns():this.getResourceViewEditColumns(),t.customColDetails=[],t.generalColDetails=[],r=i.length,n=0;n<r;n++)u=e.indexOf(i[n].field),u!=-1?t.generalColDetails.push(i[n]):t.customColDetails.push(i[n]);return t},_splitAndReplace:function(n,i,r,u){var o,f,e;if(!t.isNullOrUndefined(u)&&u.length>0){for(o=u.shift(),f=n.split(o),e=0;e<f.length;e++)u.length>0?f[e]=this._splitAndReplace(f[e],i,r,u):f[e]==i&&(f[e]=r);return f.join(o)}},_updateDetailPredecessorCollection:function(n,i){for(var r,f,e=this.detailPredecessorCollection,u=0;u<e.length;u++)r=this.detailPredecessorCollection[u],r.taskid==parseInt(n)&&(r.taskid=parseInt(i)),f=[",",":"],t.isNullOrUndefined(r.from)?t.isNullOrUndefined(r.to)||(r.to=this._splitAndReplace(r.to,n,i,f)):r.from=this._splitAndReplace(r.from,n,i,f)},_updateConnectorLineId:function(n,t,i){var r=this,u=r._createConnectorLineObject(n,t,i);u&&(r._connectorlineIds.length>0&&r._connectorlineIds.indexOf(u.ConnectorLineId)==-1?(r._updatedConnectorLineCollection.push(u),r._connectorlineIds.push(u.ConnectorLineId)):r._connectorlineIds.length==0&&(r._updatedConnectorLineCollection.push(u),r._connectorlineIds.push(u.ConnectorLineId)),r._$ganttchartHelper.ejGanttChart("appendConnectorLine",r._updatedConnectorLineCollection),this._updateConnectorLineCollection(r._updatedConnectorLineCollection))},updateTaskId:function(n,i){var r=this,u=this.model,v=u.ids,y=u.flatRecords,p=u.currentViewData,h=typeof n=="number"?n.toString():n,o=typeof i=="number"?i.toString():i,c,tt,s,it,rt,k,ut,w,d,g,ft,b,f,e,l,a,nt;if(!t.isNullOrUndefined(h)&&!t.isNullOrUndefined(o)){if(c=v.indexOf(h),tt=v.indexOf(o),c==-1||tt>-1)return!1;if(s=y[c],s.taskId=s.item[u.taskIdMapping]=i,v[c]=o,(this.criticalPathCollection.length>0||this.collectionTaskId.length>0)&&(it=this.criticalPathCollection.indexOf(parseInt(h)),rt=this.collectionTaskId.indexOf(parseInt(h)),this.criticalPathCollection[it]=parseInt(o),this.collectionTaskId[rt]=parseInt(o)),this.detailPredecessorCollection.length>0&&r._updateDetailPredecessorCollection(h,o),s.hasChildRecords&&u.parentTaskIdMapping)for(k=s.childRecords,ut=k.length,w=0;w<ut;w++)d=k[w],d.item[u.parentTaskIdMapping]=i,r.refreshGanttRecord(d);if(u.predecessorMapping&&!t.isNullOrUndefined(s.predecessor))for(g=s.predecessor,ft=g.length,b=0;b<ft;b++)f=g[b],f.to==h?(l=y[v.indexOf(f.from)],e=y[c],r._connectorlineIds=[],r._updatedConnectorLineCollection=[],p.indexOf(l)>-1&&p.indexOf(e)>-1?(a="parent"+f.from+"child"+f.to,r._$ganttchartHelper.ejGanttChart("removeConnectorline",a),r._updateConnectorLineCollection(a),f.to=o,r._updateConnectorLineId(l,e,f)):f.to=o):f.from==h&&(l=y[c],e=y[v.indexOf(f.to)],r._connectorlineIds=[],r._updatedConnectorLineCollection=[],p.indexOf(l)>-1&&p.indexOf(e)>-1?(a="parent"+f.from+"child"+f.to,r._$ganttchartHelper.ejGanttChart("removeConnectorline",a),r._updateConnectorLineCollection(a),f.from=o,r._updateConnectorLineId(l,e,f)):f.from=o,t.isNullOrUndefined(e)||(nt=r._predecessorToString(e.predecessor,e),e.predecessorsName=nt,e.item[u.predecessorMapping]=nt,r.refreshGanttRecord(e)));return r._isLastRefresh=!0,r._$treegridHelper.ejTreeGrid("setUpdatedRecords",u.flatRecords,u.updatedRecords,u.ids,u.parentRecords,this.dataSource()),r._$ganttchartHelper.ejGanttChart("setUpdatedRecords",u.currentViewData,u.updatedRecords,u.flatRecords,u.ids),r.refreshGanttRecord(s),r._updateLastInsertedId(s.taskId),r.isCriticalPathEnable==!0&&(r._$ganttchartHelper.ejGanttChart("criticalDataMapping",r.criticalPathCollection,!0,r.detailPredecessorCollection,r.collectionTaskId),r._$ganttchartHelper.ejGanttChart("criticalConnectorLine",r.criticalPathCollection,r.detailPredecessorCollection,!0,r.collectionTaskId)),!0}},_selectedChildRecord:function(n,t){for(var r=this,i=0;i<n.length;i++)n[i].isSelected&&t.push(n[i]),n[i].hasChildRecords&&r._selectedChildRecord(n[i].childRecords,t)},_checkIndentOutdent:function(n,t){var r=this,i;return n.hasChildRecords&&(i=[],r._selectedChildRecord(n.childRecords,i),t=t+i.length),t},_sendIndentRequest:function(){var r=this,u=r.model,o=r.getCurrentData(),e={},a={},f,l=!1,y=r._$treegridHelper.ejTreeGrid("instance"),s,g,p,c,h,nt,v,w,i,b,tt,k,ft,d;if(r.cancelEditCell(),t.isNullOrUndefined(o)||o.length==0)alert(r._alertTexts.indentAlert);else{if(e.data=o,e.requestType="indent",r._trigger("actionBegin",e))return;for(s=0;s<o.length;s++){if(i=o[s],e.data=i,f=u.flatRecords[u.flatRecords.indexOf(i)-1],t.isNullOrUndefined(f)){s=r._checkIndentOutdent(i,s);continue}if(g=n.inArray(i,f.childRecords),g!=-1){s=r._checkIndentOutdent(i,s);continue}if(i.parentItem?(p=i.parentItem.childRecords.indexOf(i),i.parentItem.childRecords.splice(p,1),u.parentTaskIdMapping||i.parentItem.item[u.childMapping].splice(p,1)):this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json?(c=this.dataSource().dataSource.json.indexOf(i.item),u.parentTaskIdMapping||this.dataSource().dataSource.json.splice(c,1)):r._isDataManagerUpdate&&(c=r._jsonData.indexOf(i.item),u.parentTaskIdMapping||(r._jsonData=r._$treegridHelper.ejTreeGrid("getUpdatedDatamanagerData"),r._jsonData.splice(c,1))):(c=this.dataSource().indexOf(i.item),u.parentTaskIdMapping||this.dataSource().splice(c,1)),i.level===f.level?f.childRecords?f.expanded||(f.childRecords.splice(f.childRecords.length,0,i),i.parentItem=f,u.parentTaskIdMapping?i.item[u.parentTaskIdMapping]=f.taskId:f.item[u.childMapping].splice(f.childRecords.length,0,i.item)):(f.childRecords=[],f.childRecords.push(i),f.expanded=!0,f.taskType=t.Gantt.TaskType.FixedDuration,f.effortDriven="false",i.parentItem=f,f.item[u.childMapping]=[],u.parentTaskIdMapping?i.item[u.parentTaskIdMapping]=f.taskId:f.item[u.childMapping].push(i.item)):f.level-i.level==1?(f.parentItem.childRecords.splice(f.parentItem.childRecords.length,0,i),u.parentTaskIdMapping?i.item[u.parentTaskIdMapping]=f.parentItem.taskId:f.parentItem.item[u.childMapping].splice(f.parentItem.childRecords.length,0,i.item),i.parentItem=f.parentItem):f.level-i.level>1&&(h=r.getParentItem(f,i.level),h.childRecords.splice(h.childRecords.length,0,i),u.parentTaskIdMapping?i.item[u.parentTaskIdMapping]=h.taskId:h.item[u.childMapping].splice(h.childRecords.length,0,i.item),i.parentItem=h),i.parentItem.isMilestone&&(i.parentItem.isMilestone=!1),f.hasChildRecords=f.childRecords?f.childRecords.length>0:!1,i.level+=1,(y._searchString.length>0||y.model.sortSettings.sortedColumns.length>0)&&(l=!0),r.updateLevel(i,1,l),l||r.refreshGanttRecord(i),f.level===0&&u.parentRecords.indexOf(f)===-1&&u.parentRecords.push(f),i.level>0&&u.parentRecords.indexOf(i)!==-1&&(nt=u.parentRecords.indexOf(i),u.parentRecords.splice(nt,1)),i.parentItem&&i.parentItem.isAutoSchedule?r._updateParentItem(i):i.parentItem&&!i.parentItem.isAutoSchedule&&r._updateManualParentItem(i),i.parentItem&&i.parentItem.predecessor&&u.predecessorMapping&&r._updatePredecessorOnIndentOutdent(i.parentItem),l||r.refreshGanttRecord(f),r.getExpandStatus(i)||(v={},v.expanded=!0,v.data=i.parentItem,r.expanding(v)),u.enableWBS){var it=i.parentItem.WBS,rt=i.parentItem.childRecords.length,ut=[i];r.reCalculateWBS(ut,rt,it);r.updateWBSdetails(i.parentItem)}s=r._checkIndentOutdent(i,s)}r._$treegridHelper.ejTreeGrid("setUpdatedRecords",u.flatRecords,u.updatedRecords,u.ids,u.parentRecords,this.dataSource());l&&(e.requestType="indent",r._$treegridHelper.ejTreeGrid("processBindings",e),w={},w.requestType=t.TreeGrid.Actions.Refresh,r._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",w),r.model.updatedRecords=r.getUpdatedRecords(),r.model.currentViewData=r.getCurrentViewData(),r._$ganttchartHelper.ejGanttChart("setUpdatedRecords",u.currentViewData,u.updatedRecords,u.flatRecords,u.ids),r._$ganttchartHelper.ejGanttChart("refreshHelper",u.currentViewData,u.updatedRecords,r._totalCollapseRecordCount),r.updateAltRow(u.updatedRecords,0,1));u.predecessorMapping&&r._refreshConnectorLines(!1,!0,!1);i=o[o.length-1];o.length!=1||r._$treegridHelper.ejTreeGrid("instance")._multiSelectCtrlRequest||u.selectionMode=="cell"||(b=u.updatedRecords.indexOf(i),tt=r.getGanttChartRows(),e={rowElement:tt.eq(b),data:r.model.selectedItem,recordIndex:b},r._$ganttchartHelper.ejGanttChart("selectRows",e.recordIndex),r._$treegridHelper.ejTreeGrid("selectRows",e.recordIndex),this.selectedItem(e.data),this.selectedRowIndex(e.recordIndex),u.allowSelection&&r.updateIndentOutdentOption(i));o.length>1&&(y._searchString.length>0&&(k=[],ft=o.filter(function(n){k.push(u.updatedRecords.indexOf(n))}),r.selectMultipleRows(k)),r._multipleIndentOutdentOption(u.selectedItems));a.data=i;a.requestType="indent";d=n.map(r._actionCompleteData,function(n,t){if(n.taskId==e.data.taskId)return t});d.length&&r._actionCompleteData.splice(d[0],1);r._actionCompleteData.length&&(a.updatedRecords=r._actionCompleteData,r._actionCompleteData=[]);this._trigger("actionComplete",a);this.isCriticalPathEnable==!0&&(r._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0))}},getParentItem:function(n,t){var i=this;return n.parentItem.level===t?n.parentItem:i.getParentItem(n.parentItem,t)},getSubChangeIndex:function(n,t,i){for(var u=this,f,r=0;r<u.model.updatedRecords.length;r++)if(u.model.updatedRecords[r].level==n&&u.model.updatedRecords[r].index>t){i.parentItem&&u.model.updatedRecords[r].parentItem.taskId==i.parentItem.taskId&&(f=u.model.updatedRecords[r].index);break}return f},_nextSameLevelItem:function(n,t){for(var e=this,r=n.parentItem.level,f=t.indexOf(n),u,i=f;i<t.length;i++)if(r===t[i].level||r>t[i].level){u=t[i];break}return u},_getOutdentItem:function(){var n=this,e=n.model,i=[],u=[],r,f=n.getUpdatedRecords(),t;if(n.model.selectionMode=="row"){for(i=e.flatRecords.filter(function(n){return n.isSelected}),t=i.length-1;t>=0;t--)u.push(i[t]);return u}if(r=n._rowIndexOfLastSelectedCell,r!=-1)return f&&[f[r]]},_getParentSelectionStatus:function(n){var i=t.isNullOrUndefined(n)?null:n.parentItem;if(i!=null)return i.isSelected===!0?!0:this._getParentSelectionStatus(i.parentItem)},_sendOutdentRequest:function(){var r=this,u=r.model,e=r._getOutdentItem(),f={},w={},l,a,y,b,k,o,p,g,s,nt,d,h,v,tt,i,rt,ut,it,ft,c;if(r.cancelEditCell(),t.isNullOrUndefined(e)||e.length==0)alert(r._alertTexts.outdentAlert);else{if(f.data=e,f.requestType="outdent",r._trigger("actionBegin",f)||u.editSettings.allowIndent==!1)return;for(d=0;d<e.length;d++)if(i=e[d],f.data=i,r._getParentSelectionStatus(i)||i.level==0)continue;else{if(l=r._nextSameLevelItem(i,u.flatRecords),y=u.flatRecords.indexOf(i),b=i.parentItem,k=i.parentItem.childRecords.indexOf(i),o=i.parentItem.parentItem,p=o&&i.parentItem.parentItem.childRecords.indexOf(l),i.parentItem.childRecords.splice(k,1),u.parentTaskIdMapping||i.parentItem.item[u.childMapping].splice(k,1),i.parentItem.childRecords.length==0?(i.parentItem.childRecords=null,i.parentItem.expanded=!1,i.parentItem.hasChildRecords=!1,i.parentItem._updateWorkWithDuration(r)):i.parentItem&&i.parentItem.isAutoSchedule?r._updateParentItem(i.parentItem.childRecords[0]):i.parentItem&&!i.parentItem.isAutoSchedule&&r._updateManualParentItem(i.parentItem.childRecords[0]),o?(p!=-1?o.childRecords.splice(p,0,i):o.childRecords.push(i),u.parentTaskIdMapping?i.item[u.parentTaskIdMapping]=o.taskId:p!=-1?o.item[u.childMapping].splice(p,0,i.item):o.item[u.childMapping].push(i.item),i.parentItem=o):(this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json?u.parentTaskIdMapping||this.dataSource().dataSource.json.push(i.item):r._isDataManagerUpdate&&(u.parentTaskIdMapping||(r._jsonData=r._$treegridHelper.ejTreeGrid("getUpdatedDatamanagerData"),r._jsonData.push(i.item))):u.parentTaskIdMapping||(l?(c=this.dataSource().indexOf(l.item),this.dataSource().splice(c,0,i.item)):this.dataSource().push(i.item)),i.parentItem=null,u.parentTaskIdMapping&&(i.item[u.parentTaskIdMapping]=null)),g=r._$treegridHelper.ejTreeGrid("getChildCount",i,0),s=u.flatRecords.splice(y,g+1),nt=u.ids.splice(y,g+1),a=l?u.flatRecords.indexOf(l):u.flatRecords.length,i.hasChildRecords&&i.childRecords.length>0)for(h=0;h<s.length;h++)u.flatRecords.splice(a,0,s[h]),u.ids.splice(a,0,nt[h]),s[h].level-=1,a++,c=n.map(r._actionCompleteData,function(n,t){if(n.taskId==s[h].taskId)return t}),c.length?r._actionCompleteData[c[0]]=s[h]:r._actionCompleteData.push(s[h]);else u.flatRecords.splice(a,0,s[0]),u.ids.splice(a,0,nt[0]),s[0].level-=1;i.parentItem&&(i.parentItem.isMilestone&&(i.parentItem.isMilestone=!1),i.parentItem&&i.parentItem.isAutoSchedule?r._updateParentItem(i):i.parentItem&&!i.parentItem.isAutoSchedule&&r._updateManualParentItem(i));i.hasChildRecords&&(i.isAutoSchedule?r._updateParentItem(i,null,!0):r._updateManualParentItem(i,null,!0));i.level===0&&u.parentRecords.indexOf(i)===-1&&u.parentRecords.push(i);i.predecessor&&i.predecessor.length>0&&u.predecessorMapping&&i.hasChildRecords&&r._updatePredecessorOnIndentOutdent(i);u.updatedRecords=u.enableVirtualization?r._$treegridHelper.ejTreeGrid("getExpandedRecords",u.flatRecords):u.flatRecords.slice();v=b.childRecords&&b.childRecords[k];u.enableWBS&&(v&&r.updateWBSdetails(v,!0),r.updateWBSdetails(b),v&&r.updateWBSdetails(v,!0,!0));r._$treegridHelper.ejTreeGrid("setUpdatedRecords",u.flatRecords,u.updatedRecords,u.ids,u.parentRecords,this.dataSource());v&&(r._$treegridHelper.ejTreeGrid("updateSerialNumber",y),u.enableSerialNumber&&r._$treegridHelper.ejTreeGrid("updateSerialNumberPredecessors",y))}f.requestType="outdent";r._$treegridHelper.ejTreeGrid("processBindings",f);tt={};tt.requestType=t.TreeGrid.Actions.Refresh;r._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",tt);r.model.updatedRecords=r.getUpdatedRecords();r.model.currentViewData=r.getCurrentViewData();r._$ganttchartHelper.ejGanttChart("setUpdatedRecords",u.currentViewData,u.updatedRecords,u.flatRecords,u.ids);r.model.predecessorMapping&&r._refreshConnectorLines(!1,!0,!1);r._$ganttchartHelper.ejGanttChart("refreshHelper",u.currentViewData,u.updatedRecords,r._totalCollapseRecordCount);r.updateAltRow(u.updatedRecords,0,1);i=e[e.length-1];e.length==1&&u.selectionMode!="cell"&&(rt=u.updatedRecords.indexOf(i),ut=r.getGanttChartRows(),f={data:r.model.selectedItem,recordIndex:rt},r._$ganttchartHelper.ejGanttChart("selectRows",f.recordIndex),r._$treegridHelper.ejTreeGrid("selectRows",f.recordIndex),this.selectedItem(f.data),this.selectedRowIndex(f.recordIndex),u.allowSelection&&r.updateIndentOutdentOption(i));u.selectionMode=="cell"&&u.selectionType=="single"&&(r._rowIndexOfLastSelectedCell=u.updatedRecords.indexOf(i),r.selectCells([{rowIndex:u.updatedRecords.indexOf(i),cellIndex:u.selectedCellIndexes[0].cellIndex}]));e.length>1&&(r._$treegridHelper.ejTreeGrid("instance")._searchString.length>0&&(it=[],ft=e.filter(function(n){it.push(u.updatedRecords.indexOf(n))}),r.selectMultipleRows(it)),r._multipleIndentOutdentOption(u.selectedItems));w.data=i;w.requestType="outdent";c=n.map(r._actionCompleteData,function(n,t){if(n.taskId==i.taskId)return t});c.length&&r._actionCompleteData.splice(c[0],1);r._actionCompleteData.length&&(w.updatedRecords=r._actionCompleteData,r._actionCompleteData=[]);this._trigger("actionComplete",w);this.isCriticalPathEnable==!0&&(this.showCriticalPath(!0,!0),r._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId))}},_refreshChildLevel:function(n){for(var r=this,t=0,u=n.childRecords,f=u.length,i,t=0;t<f;t++)i=u[t],r.refreshGanttRecord(i),i.hasChildRecords&&r._refreshChildLevel(i)},_updateChildLevel:function(n){for(var u=this,i=0,r=n.childRecords,f=r.length,t,i=0;i<f;i++)t=r[i],t.level=t.level-1,t.hasChildRecords&&u._updateChildLevel(t)},_removeChildRecords:function(n,t){if(n.parentItem){for(var s=this,i=s.model,u=0,r,f=0,e=0,o=n.parentItem.childRecords,h=o&&o.length,u=t;u<h;u++)r=o[u],r&&(n.childRecords?(e=n.childRecords.length,n.childRecords.splice(e,0,r),i.parentTaskIdMapping?r.item[i.parentTaskIdMapping]=n.taskId:n.item[i.childMapping].splice(e,0,r.item)):(n.childRecords=[],n.item[i.childMapping]=[],n.childRecords.push(r),i.parentTaskIdMapping?r.item[i.parentTaskIdMapping]=n.taskId:n.item[i.childMapping].push(r.item)),r.parentItem=n,f++);n.parentItem.childRecords&&(n.parentItem.childRecords.splice(t,f),i.parentTaskIdMapping||n.parentItem.item[i.childMapping].splice(t,f),n.parentItem.childRecords.length==0&&(n.parentItem.childRecords=null,n.parentItem.expanded=!1,n.parentItem.hasChildRecords=!1,s.refreshGanttRecord(n.parentItem)))}},updateChildGanttRecordLevel:function(n,t){for(var r=0,u=this,f=u.model,e=n.parentItem&&n.parentItem.parentItem&&n.parentItem.parentItem.childRecords,s=e&&e.length,o=0,i,r=t;r<s;r++)i=e[r],i.childRecords?(i.childRecords.splice(i.childRecords.length,0,i),i.item[f.childMapping].splice(i.childRecords.length,0,i.item)):(i.childRecords=[],i.item[f.childMapping]=[],i&&(i.childRecords.push(i),i.item[f.childMapping].push(i.item))),u.refreshGanttRecord(n.parentItem),n.parentItem=i,++o;n.parentItem.childRecords.splice(t,o);n.parentItem.childRecords.length==0&&(n.parentItem.childRecords=null,n.parentItem.expanded=!1,n.parentItem.hasChildRecords=!1);u.refreshGanttRecord(n.parentItem)},updateLevel:function(n,t,i){var e=this,u=0,f=n.childRecords,o=f&&f.length,r;for(u;u<o;u++)r=f[u],r.level+=t,i||e.refreshGanttRecord(r),r.childRecords&&e.updateLevel(r,t,i)},getExpandStatus:function(n){var t=n.parentItem;return t!=null?t.expanded===!1?!1:t.parentItem?t.parentItem.expanded===!1?!1:this.getExpandStatus(t.parentItem):!0:!0},subContextMenuAction:function(i){var f=this,r=f.model,u=n.extend(!0,{},f._contextMenuSelectedItem.item),e;!r.durationUnitMapping&&r.durationMapping&&(u[r.durationMapping]=this._getDurationStringValue(this._contextMenuSelectedItem));delete u[r.childMapping];delete u[r.predecessorMapping];delete u.WBSPredecessor;delete u[r.taskNameMapping];e=i.position==="Below"?t.Gantt.RowPosition.BelowSelectedRow:t.Gantt.RowPosition.AboveSelectedRow;r.enableWBS&&(u.WBS=f._getNewWBSid(e));f.addRecord(u,e)},reCalculateWBS:function(n,t,i){var u=this,e=u.model,f,r;if(i)for(r=0;r<n.length;r++)f=t+r,n[r].WBS=i+"."+f,n[r].item.WBS=i+"."+f,e.enableWBSPredecessor&&e.predecessorMapping&&u._getPredecessorIds(n[r]),u.refreshGanttRecord(n[r]),n[r].hasChildRecords&&u._updateChildWBS(n[r]);else for(r=0;r<n.length;r++)f=(t+r).toString(),n[r].WBS=f,n[r].item.WBS=f,e.enableWBSPredecessor&&e.predecessorMapping&&u._getPredecessorIds(n[r]),u.refreshGanttRecord(n[r]),n[r].hasChildRecords&&u._updateChildWBS(n[r])},_updateChildWBS:function(n){for(var r=this,u=r.model,i=n.childRecords,f=n.WBS,t=0;t<i.length;t++)i[t].WBS=f+"."+(t+1),i[t].item.WBS=f+"."+(t+1),u.enableWBSPredecessor&&u.predecessorMapping&&r._getPredecessorIds(i[t]),r.refreshGanttRecord(i[t]),i[t].hasChildRecords&&r._updateChildWBS(i[t])},_getPredecessorIds:function(n){var r=this,u=r.model,f=n.taskId,e=u.flatRecords,i=e.filter(function(n){var i,t,r,u;if(n.predecessorsName)for(i=n.predecessorsName.split(","),t=0;t<i.length;t++)if(r=i[t].match(/(\d+|[A-z]+)/g),u=+r[0],u==f)return n}),t;if(i.length)for(t=0;t<i.length;t++)r._$treegridHelper.ejTreeGrid("updateWBSPredecessor",i[t]),r.refreshGanttRecord(i[t])},_getNewWBSid:function(n){var e=this,u=e.model,r=u.selectionMode=="row"?u.selectedItem:u.updatedRecords[e._rowIndexOfLastSelectedCell],i,o,f,s,h;if(i=r?r.WBS:1,r)switch(n){case t.Gantt.RowPosition.BelowSelectedRow:o=i.lastIndexOf(".")!=-1?parseInt(i.substr(i.lastIndexOf(".")+1)):parseInt(i);f=o+1;r.parentItem?(s=r.parentItem?r.parentItem.WBS:null,i=s+"."+f):i=f;break;case t.Gantt.RowPosition.Top:i=1;break;case t.Gantt.RowPosition.Bottom:i=(u.parentRecords?u.parentRecords.length:0)+1;break;case t.Gantt.RowPosition.Child:h=r.childRecords?r.childRecords.length:0;i=i+"."+(h+1)}return i.toString()},_getNewTaskId:function(n){var i=this,u=i.model.viewType==t.Gantt.ViewType.ResourceView?i._resourceUniqTaskIds:i.model.ids,r=t.isNullOrUndefined(n)?i._lastInsertedId>0?i._lastInsertedId+1:1:n;return u.indexOf(r.toString())>-1?i._getNewTaskId(r+1):r},_updateLastInsertedId:function(n,t){var i=this,r=isNaN(parseInt(n))?i._lastInsertedId<1?1:i._lastInsertedId:parseInt(n);i._lastInsertedId=t?i._lastInsertedId<r?r:i._lastInsertedId+1:i._lastInsertedId<r?r:i._lastInsertedId},contextMenuAction:function(n){var t=this,i;n.requestType=="contextMenuAdd"&&t._sendAddRequest();n.requestType=="contextMenuIndent"&&t._sendIndentRequest();n.requestType=="contextMenuOutdent"&&t._sendOutdentRequest();n.requestType=="contextMenuDelete"&&(this.model.viewType=="resourceView"&&n.data.eResourceTaskType=="resourceChildTask"?this.deleteResourceChildTask(n.data):t._$treegridHelper.ejTreeGrid("deleteRow",null,!0,t._contextMenuSelectedIndex));n.requestType=="contextMenuTaskDetails"&&(i={},i.isResourceView=this.model.viewType=="resourceView",i.data=n.data,t._sendEditRequest(null,i))},_renderContextMenu:function(r,u,f){var e=this,c={},l,o,s,b,y=e._getCoordinate(r),k,h,d,tt,w;if((e._contextMenuSelectedIndex=u,e._contextMenuSelectedItem=f,e._contextMenuEvent=r,k=e._$treegridHelper.ejTreeGrid("getCellIndex",r),r||(r=window.event),y.pageX||y.pageY?(l=y.pageX,o=y.pageY):(r.clientX||r.clientY)&&(l=r.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=r.clientY+document.body.scrollTop+document.documentElement.scrollTop),h=this._$treegridHelper.ejTreeGrid("getOffsetRect",e.element[0]),h.bottom=h.top+this.element[0].offsetHeight,h.right=h.left+n(this.element).width(),c.requestType="ContextMenuOpen",c.contextMenuItems=e._contextMenuItems,c.columnIndex=k,c.item=e._contextMenuSelectedItem,c.targetElement=r,c.index=u,!e._trigger("contextMenuOpen",c))&&(e._activeMenuItemId=null,e._contextMenuItems=c.contextMenuItems,e._contextMenuItems.length!=0)){s=t.buildTag("div.e-tgcontextmenu e-js","",{position:"absolute","z-index":e._$treegridHelper.ejTreeGrid("getMaxZIndex")+1},{id:e._id+"_ContextMenu"});e.model.cssClass&&s.addClass(e.model.cssClass);d=c.contextMenuItems.filter(function(n){if(n.parentMenuId==null||n.parentMenuId==i)return!0});b=t.buildTag("ul.e-gantt-contextmenu",n.render[e._id+"contextMenuTemplate"](d),{margin:"0px","padding-left":"0px","list-style-type":"none"},{"data-icon":!1,"data-role":"list-divider"});s.append(b);n(document.body).append(s);var a=n(s).outerHeight(),v=n(s).outerWidth(),p=s.find(".e-menuitem");if(p.width(v+2),v=n(s).outerWidth(),(h.left>l||h.right<l+v)&&(h.right<l+v&&(l=l-v),l<0&&(l=h.left+10)),h.bottom<o+a){var g=o-a,it=o+a-h.bottom,nt=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;g>h.top?o=g:o+a>nt+window.innerHeight&&(tt=o+a-(nt+window.innerHeight),w=o-tt,w>0&&(o=parseInt(w)))}else n(window).height()+n(window).scrollTop()<o+a&&(o=o-a);s.css({left:l+"px",top:o+"px"});e._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");n(s).css({height:"auto"});e._on(s,"contextmenu",function(n){n.preventDefault()});n(p).click(function(){e._contextMenuClickHandler(this)});n(p).mouseenter(function(){n(this).hasClass("e-disable")||(s.find(".e-tgcontextmenu-mouseover").removeClass("e-tgcontextmenu-mouseover"),n(this).addClass("e-tgcontextmenu-mouseover"),e._activeMenuItemId=n(this).attr("id"),e._showSubContextMenu(this,c.contextMenuItems))});r.preventDefault()}},_showSubContextMenu:function(i,r){var a=this.model,f=this,e=[],s=n(i).attr("id"),u,v,h=[],o,c,l;h=r.filter(function(n){return n.menuId==s&&(e=n),n.parentMenuId==s?!0:void 0});e.parentMenuId||n(".e-tginnerContextmenu").remove();e.parentMenuId&&this._removeContextMenu(e,r);h.length>0&&(u=t.buildTag("div.e-tginnerContextmenu e-js","",{position:"absolute","z-index":f._$treegridHelper.ejTreeGrid("getMaxZIndex")+1},{id:this._id+"_SubContextMenu"+s}),a.cssClass&&u.addClass(a.cssClass),v=t.buildTag("ul.e-gantt-innercontextmenu",n.render[f._id+"contextMenuTemplate"](h),{margin:"0px","padding-left":"0px"},{"data-icon":!1,type:"none","data-role":"list-divider"}),u.append(v),n(document.body).append(u),o=u.find(".e-menuitem"),c=n(u).outerWidth(),o.width(c>100?c:100),l=f._getSubContextMenuPosition(i,u),n(u).css({top:l.top,left:l.left}),n(o).mouseenter(function(){n(this).hasClass("e-disable")||(f._showSubContextMenu(this,r),n(this).closest(".e-tginnerContextmenu").find(".e-tgcontextmenu-mouseover").removeClass("e-tgcontextmenu-mouseover"),n(this).addClass("e-tgcontextmenu-mouseover"),f._activeMenuItemId=n(this).attr("id"))}),f._on(u,"contextmenu",function(n){n.preventDefault()}),n(o).click(function(){f._contextMenuClickHandler(this)}))},_removeContextMenu:function(t,i){var e=n("#"+this._id+"_SubContextMenu"+t.parentMenuId),r=n(e).find(".e-tgcontextmenu-mouseover"),u,f;n(r).length>0&&(u=i.filter(function(t){if(t.menuId==n(r).attr("id"))return!0}),u.length>0&&(f=i.filter(function(n){if(n.parentMenuId==u[0].menuId)return!0}),f.length>0&&this._removeContextMenu(f[0],i)),n("#"+this._id+"_SubContextMenu"+n(r).attr("id")).remove())},_getSubContextMenuPosition:function(t,i){var p=this.model,s=n(i).outerWidth(),e=n(i).outerHeight(),c=this._$treegridHelper.ejTreeGrid("getOffsetRect",t),r={top:"",left:""},o=n(t).closest(".e-tgcontextmenu"),f,l,u,y,h;if(o.length==0&&(o=n(t).closest(".e-tginnerContextmenu")),l=n(o).outerWidth(),r.top=c.top-1,r.left=c.left+n(o).width()+1,r.bottom=r.top+n(t).outerHeight(),f=r.left,u=this._$treegridHelper.ejTreeGrid("getOffsetRect",this.element[0]),u.bottom=u.top+this.element[0].offsetHeight,u.right=u.left+n(this.element).width(),(u.left>f||u.right<f+s)&&(u.right<f+s&&(f=f-l-s),f>0&&(r.left=f)),u.bottom<r.top+e){var a=r.bottom-e,w=r.top+e-u.bottom,v=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;a>u.top?r.top=a+2:r.top+e>v+window.innerHeight&&(y=r.top+e-(v+window.innerHeight),h=r.top-y,h>0&&(r.top=parseInt(h)))}return r},_contextMenuClickHandler:function(t){var u=n(t).attr("id"),i=this,f=this.model,r={};if(!n(t).hasClass("e-disable")&&n(t).find(".e-expander").length==0)switch(u){case"Task":r.requestType="contextMenuTaskDetails";r.data=i._contextMenuSelectedItem;i.contextMenuAction(r);i._clearContextMenu();break;case"Indent":r.requestType="contextMenuIndent";i.contextMenuAction(r);i._clearContextMenu();i._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Outdent":r.requestType="contextMenuOutdent";i.contextMenuAction(r);i._clearContextMenu();i._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Delete":r.requestType="contextMenuDelete";r.data=i._contextMenuSelectedItem;i.contextMenuAction(r);i._clearContextMenu();i._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Above":r.requestType="save";r.position="Above";i.subContextMenuAction(r);i._clearContextMenu();i._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Below":r.requestType="save";r.position="Below";i.subContextMenuAction(r);i._clearContextMenu();i._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Open":r.requestType="contextMenuAdd";i.contextMenuAction(r);i._clearContextMenu();i._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Add":f.viewType=="resourceView"?this.openAddDialog():i._setInitialData();break;default:r.data=i._contextMenuSelectedItem;i._triggerMenuEventHandler(u,r);i._clearContextMenu()}},_triggerMenuEventHandler:function(i,r){var h=this,e=h._contextMenuItems,f,o,u,s;t.isNullOrUndefined(e)||(f=e.filter(function(n){if(n.menuId.toString()===i)return!0}),f.length>0&&(o=f[0],r.menuId=i,u=o.eventHandler,u&&(typeof u=="string"&&(u=t.util.getObject(u,window)),n.isFunction(u)&&(s=t.event("customContextMenuHandler",this.model,r),u.call(this,s)))))},_setInitialData:function(){var n=this,t=n.model;t.flatRecords.length==0&&(n.addRecord(),n._clearContextMenu())},updateAltRow:function(t,i,r){var f=this;if(f.model.enableAltRow)for(var u=0,h=f.model.currentViewData,c=h.length,e=t.isAltRow,o,s=n(f._gridRows),u=i+r;u<c;u++)n(s[u]).css("display")!=="none"&&(o=h[u],o.isAltRow=!e,e=o.isAltRow,e?n(s[u]).addClass("e-alt-row"):n(s[u]).removeClass("e-alt-row"))},renderedEditDialog:function(i){var r=this,f=this.model,b=f.viewType==t.Gantt.ViewType.ProjectView?f.columns:r._resourceViewColumns,g=b.length,k={},l,p,d,h,o,u,w,a,s,c,v,e,y;switch(i.requestType){case t.TreeGrid.Actions.Add:if(h=document.createElement("div"),o=n("#"+r._id+"_dialogAdd"),n(h).addClass("e-addedrow"),h.innerHTML=n.render[r._id+"_JSONDialogAddingTemplate"](i.data),n(o).html(n(h)),u={},u.cssClass=f.cssClass,u.enableModal=!0,u.width="650px",u.height="auto",u.enableResize=!1,u.isResponsive=!1,u.contentSelector="#"+r._id,u.rtl=f.rtl,u.showOnInit=!1,u.allowKeyboardNavigation=!1,u.close=function(){n("#"+r._id+"AddAreaNotes").data("ejRTE")&&n("#"+r._id+"AddAreaNotes").ejRTE("destroy")},u.beforeClose=function(t){r._closeAddEditDialog(t,"Add")?(t.cancel=!0,n("#AddDialog_"+r._id+"_Cancel").css("pointer-events","auto")):r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement")},a=r._editDialogTexts.addFormTitle,u.title=a,r._editedDialogRecord={},s=n("#"+r._id+"AddTab"),n(s).ejTab({headerSize:"25px",height:"310px",heightAdjustMode:t.Tab.HeightAdjustMode.None,locale:f.locale,cssClass:f.cssClass,allowKeyboardNavigation:f.allowKeyboardNavigation,enableAnimation:!1,itemActive:function(t){var u=n(t.activeHeader).find("a").attr("href"),i;u=="#"+r._id+"AddNotes"?n("#"+r._id+"AddAreaNotes_Iframe").height("202"):u=="#"+r._id+"AddCustomFields"?(i=n("#treegrid"+r._id+"customFieldAdd").ejTreeGrid("instance"),i.setModel({sizeSettings:{width:"620",height:"280px"}})):u=="#"+r._id+"AddPredecessors"?(i=n("#treegrid"+r._id+"predecessorAdd").ejTreeGrid("instance"),i.setModel({sizeSettings:{width:"620",height:"240px"}})):u=="#"+r._id+"AddResources"&&(i=n("#treegrid"+r._id+"resourceAdd").ejTreeGrid("instance"),i.setModel({sizeSettings:{width:"620",height:"240px"}}))}}),n(s).find("div.e-hidebottom.e-addborderbottom.e-content").css("min-height","283px"),n(s).find("div.e-content").css("overflow","visible"),c=n(s).find(".e-addborderbottom .e-bottom-line .e-link"),v=n(s).find(".e-addborderbottom.e-header").outerHeight()/2-(parseFloat(c.css("padding-top"))+parseFloat(c.css("padding-bottom"))),c.css("margin-top",v+"px"),n(o).ejDialog(u),n(o).ejDialog("instance").contentDiv.ejScroller("setModel",{scrollerSize:0}),e={},e.data=i.data,e.rowPosition=f.editSettings.rowPosition,e.requestType="beforeOpenAddDialog",e.element=n("#"+r._id+"_dialogAdd"),!r._trigger("actionBegin",e)){for(r._isinAddnewRecord=!0,l=0;l<g;l++)k[b[l].field]=e.data[b[l].mappingName];i.data=k;r._refreshEditForm(i);e.data=i.data;e.requestType="OpenAddDialog";e.element=n("#"+r._id+"_dialogAdd");r._trigger("actionBegin",e)||(y=n("#"+r._id+"_dialogAdd_wrapper"),n(o).find(".e-addedrow").css("overflow","visible"),y.addClass("e-ganttdialog"),n(o).ejDialog("refresh"),n(o).addClass("e-content"),n(o).ejDialog("open"))}n(s).find("div#"+r._id+"AddGeneral.e-content").css({"overflow-y":"auto","overflow-x":"hidden"});r._addPosition=e.rowPosition;p=this._getDateFromFormat(f.scheduleStartDate);this._getSecondsInDecimal(p)!=this._defaultStartTime&&this._setTime(this._defaultStartTime,p);this._editedDialogRecord.isUpdatedFromDialog=!1;d=f.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Auto?!0:f.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Manual?!1:f.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Custom?i.data.taskMode==!0?!1:!0:f.taskSchedulingMode;r._editedDialogRecord.isAutoSchedule=d;r._editedDialogRecord.startDate=i.data.startDate?this._checkStartDate(new Date(i.data.startDate)):this._checkStartDate(new Date(p));r._editedDialogRecord.endDate=i.data.endDate?r._editedDialogRecord.startDate.getTime()>new Date(i.data.endDate).getTime()?new Date(r._editedDialogRecord.startDate):new Date(i.data.endDate):new Date(r._editedDialogRecord.startDate);r._editedDialogRecord.duration=i.data.duration!=""?i.data.duration:f.viewType==t.Gantt.ViewType.ResourceView?1:0;r._editedDialogRecord.durationUnit=f.durationUnit;break;case t.TreeGrid.Actions.BeginEdit:h=document.createElement("div");o=n("#"+r._id+"_dialogEdit");n(h).addClass("e-editedrow");h.innerHTML=n.render[r._id+"_JSONDialogEditingTemplate"](i.data);n(o).html(n(h));u={};u.cssClass=r.model.cssClass;u.rtl=f.rtl;u.width="650px";u.height="auto";u.enableResize=!1;u.isResponsive=!1;u.contentSelector="#"+r._id;u.enableModal=!0;u.showOnInit=!1;u.allowKeyboardNavigation=!1;u.close=function(){n("#"+r._id+"EditAreaNotes").data("ejRTE")&&n("#"+r._id+"EditAreaNotes").ejRTE("destroy")};u.beforeClose=function(t){r._closeAddEditDialog(t,"Edit")?(t.cancel=!0,n("#EditDialog_"+r._id+"_Cancel").css("pointer-events","auto")):r._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement")};f.viewType==t.Gantt.ViewType.ResourceView?(w=i.data,r._resourceEditedRecord=i.data):w=f.selectionMode=="row"?r.selectedItem():r.model.updatedRecords[r._rowIndexOfLastSelectedCell];a=r._editDialogTexts.editFormTitle;u.open=function(){var r=this,i=this._id,t=n("#"+i+"_title").children(".e-title");t.width("450px");t.css({"word-wrap":"normal","text-overflow":"ellipsis","white-space":"nowrap",display:"inline-block","overflow-x":"hidden",float:"left"});t.attr("title",a)};u.title=a;s=n("#"+r._id+"EditTab");n(s).ejTab({headerSize:"25px",height:"310px",heightAdjustMode:t.Tab.HeightAdjustMode.None,locale:f.locale,allowKeyboardNavigation:f.allowKeyboardNavigation,cssClass:f.cssClass,enableAnimation:!1,itemActive:function(t){var u=n(t.activeHeader).find("a").attr("href"),i;u=="#"+r._id+"EditNotes"?n("#"+r._id+"EditAreaNotes_Iframe").height("202"):u=="#"+r._id+"EditCustomFields"?(i=n("#treegrid"+r._id+"customFieldEdit").ejTreeGrid("instance"),i.setModel({sizeSettings:{width:"620",height:"279px"}})):u=="#"+r._id+"EditPredecessors"?(i=n("#treegrid"+r._id+"predecessorEdit").ejTreeGrid("instance"),i.setModel({sizeSettings:{width:"620",height:"240px"}})):u=="#"+r._id+"EditResources"&&(i=n("#treegrid"+r._id+"resourceEdit").ejTreeGrid("instance"),i.setModel({sizeSettings:{width:"620",height:"240px"}}))}});n(s).find("div.e-content").css("overflow","visible");n(s).find("div#"+r._id+"EditGeneral.e-content").css({"overflow-y":"auto","overflow-x":"hidden"});n(s).find("div.e-hidebottom.e-addborderbottom.e-content").css("min-height","283px");c=n(s).find(".e-addborderbottom .e-bottom-line .e-link");v=n(s).find(".e-addborderbottom.e-header").outerHeight()/2-(parseFloat(c.css("padding-top"))+parseFloat(c.css("padding-bottom")));c.css("margin-top",v+"px");n(o).ejDialog(u);n(o).ejDialog("instance").contentDiv.ejScroller("setModel",{scrollerSize:0});e={};e.data=i.data;e.requestType="beforeOpenEditDialog";e.element=n("#"+r._id+"_dialogEdit");r._trigger("actionBegin",e)||(r._editedDialogRecord=jQuery.extend({},w),r._editedDialogRecord.resourceInfo&&(r._editedDialogRecord.resourceInfo=jQuery.extend(!0,[],w.resourceInfo)),this._editedDialogRecord.isUpdatedFromDialog=!1,r._refreshEditForm(i),e.data=i.data,e.requestType="openEditDialog",e.element=n("#"+r._id+"_dialogEdit"),r._trigger("actionBegin",e)||(y=n("#"+r._id+"_dialogEdit_wrapper"),n(o).find(".e-editedrow").css("overflow","visible"),y.addClass("e-ganttdialog"),n(o).ejDialog("refresh"),n(o).addClass("e-content"),n(o).ejDialog("open")));this._editedDialogRecord&&(this._editedDialogRecord.isUpdatedFromDialog=!1)}},_closeAddEditDialog:function(n,t){var i=this,r;if(i._isAddEditDialogSave)i._isAddEditDialogSave=!1;else return r={},r.requestType=t==="Add"?"closeAddDialog":"closeEditDialog",i._trigger("actionBegin",r)},editFormValidate:function(){return n.isFunction(n.validator)&&n("#"+this._id+"GeneralEditForm").length>0?n("#"+this._id+"GeneralEditForm").validate().form():!0},addFormValidate:function(){return n.isFunction(n.validator)&&n("#"+this._id+"GeneralAddForm").length>0?n("#"+this._id+"GeneralAddForm").validate().form():!0},getCurrentData:function(){var n=this,t,i=n.getUpdatedRecords();return n.model.selectionMode=="row"?n.model.selectedItems:(t=n._rowIndexOfLastSelectedCell,t!=-1)?i&&[i[t]]:void 0},getCurrentViewData:function(){return this._$treegridHelper.ejTreeGrid("getCurrentViewData")},getUpdatedCurrentViewData:function(){return this._$treegridHelper.ejTreeGrid("getUpdatedCurrentViewData")},getRows:function(){return this._$treegridHelper.ejTreeGrid("getRows")},getSelectedCells:function(){return this._$treegridHelper.ejTreeGrid("getSelectedCells")},getGanttChartRows:function(){return this._$ganttchartHelper.ejGanttChart("getGanttChartRows")},getUpdatedRecords:function(){return this._$treegridHelper.ejTreeGrid("getUpdatedRecords")},_getToolBarHeight:function(){var n=0;return this.model.toolbarSettings.showToolbar&&(n=this.element.find(".e-gantttoolbar").height()),n},_initValidator:function(){var i=this;n("#"+this._id+"EditForm").validate({errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(r,u){var e=u.closest("td"),f=n(r).addClass("e-error"),o=t.buildTag("div.e-errortail e-toparrow");e.find(".e-error").remove();u.hasClass("e-numerictextbox")?f.insertAfter(u.closest(".e-numeric")):f.insertAfter(u);f.prepend(o);i.model.editSettings.editMode!="normal"&&f.offset({left:u.offset().left});f.fadeIn("slow")}})},setValidation:function(){this._initValidator();for(var n=0;n<this._columns.length;n++)t.isNullOrUndefined(this._columns[n].validationRules)||this.setValidationToField(this._columns[n].field,this._columns[n].validationRules)},setValidationToField:function(i,r){var f=n("#"+this._id+i).length>0?n("#"+this._id+i):n("#"+i),u;f.rules("add",r);u=n("#"+this._id+"EditForm").validate();t.isNullOrUndefined(r.required)||(u.settings.messages.Name={},u.settings.messages.Name.required=t.TreeGrid.getColumnByField(this._columns,i).headerText+" is required")},_updateEditedGanttRecords:function(r,u){var e=this,o=e.model,f=r.data,h=e._getDateFromFormat(f.startDate),k=f.isAutoSchedule,a,p,c,v,y,s,w,l,b;r.columnName==="startDate"?(p=n.extend({},r.data),h=e._checkStartDate(h,f),f.startDate=e._getDateFromFormat(h),t.isNullOrUndefined(f.startDate)?(f.duration=null,f.item[o.durationMapping]=null,f.isMilestone=!1):(f.endDate||!t.isNullOrUndefined(f.duration))&&f._calculateEndDate(this),o.startDateMapping&&(f.item[o.startDateMapping]=f.startDate),f.isMilestone=f.duration==0?!0:!1,f.left=f._calculateLeft(this),f.width=f._calculateWidth(this),f.hasChildRecords?!f.isAutoSchedule&&f.hasChildRecords&&r.previousValue.getTime()!=f.startDate.getTime()&&(c={},c.previousData=p,c.previousData.startDate=r.previousValue,c.data=f,e._validateAutoChildRecords(c)):f.progressWidth=f._getProgressWidth(f.width,f.status),f.parentItem&&f.parentItem.isAutoSchedule?e._updateParentItem(f):f.parentItem&&!f.parentItem.isAutoSchedule&&e._updateManualParentItem(f)):r.columnName==="endDate"?(s=e._getDateFromFormat(f.endDate),v=f.duration,t.isNullOrUndefined(s)?(f.endDate=s,f.duration=null,f.item[o.durationMapping]=null,f.isMilestone=!1):(s.getHours()==0&&this._defaultEndTime!=86400&&this._setTime(this._defaultEndTime,s),f.endDate=this._checkEndDate(s,f),!t.isNullOrUndefined(h)&&t.isNullOrUndefined(v)?e._compareDates(f.endDate,h)==-1&&(f.endDate=new Date(h),this._setTime(this._defaultEndTime,f.endDate)):!t.isNullOrUndefined(v)&&t.isNullOrUndefined(h)&&(f.startDate=this._getStartDate(f.endDate,v,f.durationUnit,f))),e._compareDatesFromRecord(f)==-1?f._calculateDuration(this):t.isNullOrUndefined(f.endDate)||(f.endDate=r.previousValue,f.item[o.endDateMapping]=r.previousValue),f.isMilestone=f.duration==0?!0:!1,f.width=f._calculateWidth(this),f.left=f._calculateLeft(this),f.hasChildRecords||(f.progressWidth=f._getProgressWidth(f.width,f.status)),e._updateResourceRelatedFields(f),o.endDateMapping&&(f.item[o.endDateMapping]=f.endDate),f.isMilestone&&(f.startDate=this._checkStartDate(f.startDate,f),o.startDateMapping&&(f.item[o.startDateMapping]=f.startDate)),f.parentItem&&f.parentItem.isAutoSchedule?e._updateParentItem(f):f.parentItem&&!f.parentItem.isAutoSchedule&&e._updateManualParentItem(f)):r.columnName=="duration"||e._isDurationUpdated?(y=f.duration,s=f.endDate,t.isNullOrUndefined(y)?(f.isMilestone=!1,f.endDate=null,o.endDateMapping&&(f.item[o.endDateMapping]=null)):(t.isNullOrUndefined(h)&&!t.isNullOrUndefined(s)&&(f.startDate=e._getStartDate(s,y,f.durationUnit,f),o.startDateMapping&&(f.item[o.startDateMapping]=f.startDate)),y!=0&&f.isMilestone&&(f.isMilestone=!1,f.startDate=this._checkStartDate(f.startDate,f),o.startDateMapping&&(f.item[o.startDateMapping]=f.startDate)),f.isMilestone=f.duration==0?!0:!1,f._calculateEndDate(this)),f.width=f._calculateWidth(this),f.left=f._calculateLeft(this),f.hasChildRecords||(f.progressWidth=f._getProgressWidth(f.width,f.status)),f.parentItem&&f.parentItem.isAutoSchedule?e._updateParentItem(f):f.parentItem&&!f.parentItem.isAutoSchedule&&e._updateManualParentItem(f)):r.columnName=="predecessor"||r.columnName=="serialNumberPredecessor"?(a=r.columnName=="serialNumberPredecessor"?r.prevDefaultPredecessors:r.previousValue,a&&e._removeConnectorLine(a,f),e._addConnectorLine(f)):r.columnName=="status"?(f.status=f.status>100?100:f.status,f.hasChildRecords||(f.progressWidth=e._getProgressWidth(f.width,f.status)),f.parentItem&&f.parentItem.isAutoSchedule?e._updateParentItem(f):f.parentItem&&!f.parentItem.isAutoSchedule&&e._updateManualParentItem(f)):r.columnName=="taskMode"?e._updateGanttRecord(f):(r.columnName=="baselineStartDate"||r.columnName=="baselineEndDate")&&(w=e._getDateFromFormat(f.baselineStartDate),l=e._getDateFromFormat(f.baselineEndDate),l&&l.getHours()==0&&this._defaultEndTime!=86400&&this._setTime(this._defaultEndTime,l),f.baselineStartDate=this._checkBaseLineStartDate(w),f.baselineEndDate=this._checkBaseLineEndDate(l),f.baselineStartDate&&f.baselineEndDate&&(f.baselineLeft=f._calculateBaselineLeft(this),f.baselineRight=f._calculateBaselineRight(this),f.baselineWidth=f._calculateBaseLineWidth(this)));f.predecessor&&(e._isMileStoneEdited=f.isMilestone,e._updatedConnectorLineCollection=[],e._connectorlineIds=[],r.columnName==="predecessor"||r.columnName==="serialNumberPredecessor"?(e._isPredecessorEdited=!0,o.enablePredecessorValidation?e._validatePredecessor(f,a):(b=!0,e._validatePredecessorOnEditing(f,b)),e._isPredecessorEdited=!1):e._validatePredecessor(f,i,"successor"),e._updatedConnectorLineCollection.length>0&&o.viewType=="projectView"&&(e._$ganttchartHelper.ejGanttChart("appendConnectorLine",e._updatedConnectorLineCollection),this._updateConnectorLineCollection(e._updatedConnectorLineCollection)));e._isValidationEnabled=!1;u&&e.refreshGanttRecord(f)},_updateEditedGanttRecord:function(n){var t=this;if(n.predecessor&&this.model.viewType=="projectView")for(var o=n.predecessor,r=0,l=o.length,i,u,f,e,s=t.model,h=s.flatRecords,c=s.ids,r=0;r<l;r++)t._updatedConnectorLineCollection=[],t._connectorlineIds=[],i=o[r],i.to===n.taskId.toString()&&(u=h[c.indexOf(i.from)],f=h[c.indexOf(i.to)],u&&f&&(e="parent"+u.taskId+"child"+f.taskId,t._$ganttchartHelper.ejGanttChart("removeConnectorline",e),this._updateConnectorLineCollection(e),t._updateConnectorLineId(u,f,i)))},_updateTargetGanttRecord:function(n){var t=this,i=t.model;n.startDate=t._checkStartDate(n.startDate,n);n.endDate=this._getEndDate(n.startDate,n.duration,n.durationUnit,n);n.left=n._calculateLeft(this);n.width=n._calculateWidth(this);n.progressWidth=n._getProgressWidth(n.width,n.status);n.parentItem&&(n.parentItem.isAutoSchedule==!0?t._updateParentItem(n):t._updateManualParentItem(n));t.refreshGanttRecord(n)},_updateGanttRecord:function(n){var t=this,i=t.model;n.hasChildRecords&&n.isAutoSchedule?(n.startDate=t._checkStartDate(n.manualStartDate,n),n.left=n._calculateManualLeft(this),n.width=n._calculateManualWidth(this),n.progressWidth=n._getProgressWidth(n.width,n.status),n.endDate=n.manualEndDate,n._calculateDuration(this)):n.hasChildRecords&&!n.isAutoSchedule?(n.left=n._calculateLeft(this),n.width=n._calculateWidth(this),n._calculateDuration(this),n.manualStartDate=n.startDate,n.manualEndDate=n.endDate,t._updateManualParentItem(n,null,!0)):(n.startDate=t._checkStartDate(n.startDate,n),n._calculateEndDate(this),n.left=n._calculateLeft(this),n.width=n._calculateWidth(this),n.progressWidth=n._getProgressWidth(n.width,n.status));n.parentItem&&n.parentItem.isAutoSchedule&&t._updateParentItem(n);n.parentItem&&!n.parentItem.isAutoSchedule&&t._updateManualParentItem(n);t.refreshGanttRecord(n)},refreshGanttRecord:function(i,r,u){var f=this,s,o,e;f._isTreeGridRendered&&(f.model.currentViewData=f.getCurrentViewData(),e=f.model.currentViewData.indexOf(i),s=f._$treegridHelper.ejTreeGrid("instance"),s.model.allowSelection=f.model.allowSelection,t.TreeGrid.refreshRow(s,e),f._isGanttChartRendered&&f._$ganttchartHelper.ejGanttChart("refreshRow",e),r=r?r:i,f._isLastRefresh||r.eResourceTaskType=="groupTask"||r.eResourceTaskType=="resourceTask"?r.eResourceTaskType!="groupTask"&&r.eResourceTaskType!="resourceTask"&&(o={},o.data=r,o.item=r.item,o.requestType="recordUpdate",e=n.map(f._actionCompleteData,function(n,t){if(n==r)return t}),e.length&&f._actionCompleteData.splice(e[0],1),f._actionCompleteData.length&&(o.updatedRecords=f._actionCompleteData,f._actionCompleteData=[]),f._isLastRefresh=!1,f._trigger("actionComplete",o)):(e=n.map(f._actionCompleteData,function(n,t){if(n==r)return t}),e.length?f._actionCompleteData[e[0]]=r:(t.isNullOrUndefined(u)||u&&f.model.enableSerialNumber)&&f._actionCompleteData.push(r)))},_updateManualParentItem:function(n,i,r){for(var nt,b,f=this,u=r?n:n.parentItem,l=f.model,tt=u.manualStartDate,it=u.manualEndDate,a=0,v,y=u.childRecords,k=y&&y.length,o=null,s=null,d=0,p=0,g=0,w=0;w<k;w++){var e=y[w],h=f._getValidStartDate(e),c=f._getValidEndDate(e);if(!e.isAutoSchedule&&e.hasChildRecords)var rt=e.manualStartDate,ut=e.manualEndDate,ft=h,et=c,h=f._compareDates(rt,ft)==-1?e.manualStartDate:e.startDate,c=f._compareDates(ut,et)==1?e.manualEndDate:e.endDate;o===null&&(o=f._getDateFromFormat(h));s===null&&(s=f._getDateFromFormat(c));t.isNullOrUndefined(c)||f._compareDates(c,s)!=1||(s=f._getDateFromFormat(c));t.isNullOrUndefined(h)||f._compareDates(h,o)!=-1||(o=f._getDateFromFormat(h));g+=parseInt(e.work);(!e.isMilestone||e.hasChildRecords)&&e._isScheduledTask()?(v=f._getParentProgress(e),p+=v.totalProgress,a+=v.totalDuration):d++}f._compareDates(tt,o)!=0&&(u.manualStartDate=f._getDateFromFormat(o));f._compareDates(it,s)!=0&&(u.manualEndDate=f._getDateFromFormat(s));(f._isLoad||f._isChartRendering)&&(u._calculateDuration(this),u.width=u._calculateWidth(this));u.left=u._calculateLeft(this);u.manualLeft=u._calculateManualLeft(this);u._calculateManualDuration(this);u.manualWidth=u._calculateManualWidth(this);u._updateWorkWithDuration(f);u.work+=g;l.workMapping&&(u.item[l.workMapping]=u.work);nt=k-d;b=nt>0?Math.round(p/a):0;u.progressWidth=f._getProgressWidth(u.manualWidth,b);u.status=Math.floor(b);u.totalProgress=p;u.totalDuration=a;l.progressMapping&&(u.item[l.progressMapping]=u.status);(f._isTreeGridRendered||f._isGanttChartRendered)&&f.refreshGanttRecord(u);u.parentItem&&u.parentItem.isAutoSchedule&&!r?f._updateParentItem(u):!u.parentItem||u.parentItem.isAutoSchedule||r||f._updateManualParentItem(u,i)},_getMaxValues:function(n){for(var o=0,s=n,l=s&&s.length,t,r=null,u=null,a=0,h=0,v=0,y=0,i={},f,e,c,o=0;o<l;o++)t=s[o],f=t.startDate,e=t.endDate,t.hasChildRecords&&!t.isAutoSchedule&&(f=t.startDate.getTime()>t.manualStartDate.getTime()?t.manualStartDate:t.startDate),t.hasChildRecords&&!t.isAutoSchedule&&(e=t.endDate.getTime()<t.manualEndDate.getTime()?t.manualEndDate:t.endDate),r===null&&(r=new Date(f)),u===null&&(u=new Date(e)),e.getTime()>u.getTime()&&(u=new Date(e)),f.getTime()<r.getTime()&&(r=new Date(f)),y+=parseInt(t.work),t.isMilestone?h++:v+=parseInt(t.status);return c=l-h,a=c>0?v/c:0,i.startDate=r,i.endDate=u,i.status=a,i.work=y,i.milestoneCount=h,i},_checkSharedTasks:function(n,t){var f=this.model,r,u,i;if(r=t.eResourceChildTasks,u=r.length,t.eResourceTaskType=="resourceChildTask"||t.eResourceTaskType=="resourceTask")for(i=0;i<u;i++)if(n.taskId==r[i].taskId)return r[i]},_updateResourceResourceDetails:function(n,i){var e=this.model,r=n,u,o={},s,f;if(n.resourceInfo=t.isNullOrUndefined(n.resourceInfo)?[]:n.resourceInfo,u=n.resourceInfo,n.eResourceTaskType=="resourceChildTask"){if(r=n.parentItem,o[e.resourceIdMapping]=r.taskId,o[e.resourceNameMapping]=r.eResourceName,o[e.resourceUnitMapping]=100,u.length>0&&!t.isNullOrUndefined(i))for(s=u.length,f=0;f<s;f++)if(u[f][e.resourceIdMapping]==i){u.splice(f,1);break}n.resourceInfo.push(o)}else n.eResourceTaskType=="resourceTask"?r=n.parentItem:n.eResourceTaskType=="groupTask"&&(r=n)},_updateResourceParentItem:function(n){var f=this.model,t=n,u=[],r,i;if(n.eResourceTaskType=="resourceChildTask"?t=n.parentItem.parentItem:n.eResourceTaskType=="resourceTask"?t=n.parentItem:n.eResourceTaskType=="groupTask"&&(t=n),t&&t.hasChildRecords&&t.childRecords.length>0){for(r=0;r<t.childRecords.length;r++)u.push.apply(u,t.childRecords[r].eResourceChildTasks);i=this._getMaxValues(u);t.startDate=new Date(i.startDate);t.endDate=new Date(i.endDate);t._calculateDuration(this);t.left=t._calculateLeft(this);t.width=t._calculateWidth(this);i.milestoneCount==t.childRecords.length&&(t.startDate.getTime()==t.endDate.getTime()?t.width=Math.floor((f.rowHeight-6)/2)*2:t.width+=Math.floor((f.rowHeight-6)/2)*2);t.progressWidth=this._getProgressWidth(t.width,i.status);t.status=Math.floor(i.status);t.work+=i.work;(this._isTreeGridRendered||this._isGanttChartRendered)&&this.refreshGanttRecord(t)}},_getParentProgress:function(n){var t=0,i={};switch(n.durationUnit){case"hour":t=n.duration/(this._secondsPerDay/3600);break;case"minute":t=n.duration/(this._secondsPerDay/60);break;default:t=n.duration}return n.hasChildRecords?(i.totalProgress=n.totalProgress,i.totalDuration=n.totalDuration):(i.totalProgress=n.status*t,i.totalDuration=t),i},_updateParentItem:function(n,i,r){for(var nt,k,f=this,u=r?n:n.parentItem,o=f.model,tt=u.startDate,it=u.endDate,a=u.childRecords,d=a&&a.length,v=0,y,s=null,h=null,p=0,w=0,g=0,b=0;b<d;b++){var e=a[b],c=f._getValidStartDate(e),l=f._getValidEndDate(e);e.hasChildRecords&&!e.isAutoSchedule&&(c=f._compareDates(e.startDate,e.manualStartDate)==1?e.manualStartDate:e.startDate);e.hasChildRecords&&!e.isAutoSchedule&&(l=f._compareDates(e.endDate,e.manualEndDate)==-1?e.manualEndDate:e.endDate);s===null&&(s=f._getDateFromFormat(c));h===null&&(h=f._getDateFromFormat(l));t.isNullOrUndefined(l)||f._compareDates(l,h)!=1||(h=f._getDateFromFormat(l));t.isNullOrUndefined(c)||f._compareDates(c,s)!=-1||(s=f._getDateFromFormat(c));g+=parseInt(e.work);!e.isMilestone&&e._isScheduledTask()?(y=f._getParentProgress(e),w+=y.totalProgress,v+=y.totalDuration):p++}f._compareDates(tt,s)!=0&&(u.startDate=f._getDateFromFormat(s),o.startDateMapping&&(u.item[o.startDateMapping]=u.startDate));f._compareDates(it,h)!=0&&(u.endDate=f._getDateFromFormat(h),o.endDateMapping&&(u.item[o.endDateMapping]=u.endDate));u._calculateDuration(this);u.left=u._calculateLeft(this);u.width=u._calculateWidth(this);(p==u.childRecords.length||u.duration==0)&&f._compareDatesFromRecord(u)==0&&(u.width=Math.floor((o.rowHeight-6)/2)*2);nt=d-p;k=nt>0?Math.round(w/v):0;u.progressWidth=f._getProgressWidth(u.width,k);u.status=Math.floor(k);u.totalProgress=w;u.totalDuration=v;u._updateWorkWithDuration(f);u.work+=g;o.workMapping&&(u.item[o.workMapping]=u.work);u.taskType=t.Gantt.TaskType.FixedDuration;u.effortDriven="false";u.manualStartDate=u.startDate;u.manualEndDate=u.endDate;o.progressMapping&&(u.item[o.progressMapping]=u.status);(f._isTreeGridRendered||f._isGanttChartRendered)&&f.refreshGanttRecord(u);u.parentItem&&u.parentItem.isAutoSchedule&&!r?f._updateParentItem(u):!u.parentItem||u.parentItem.isAutoSchedule||r||f._updateManualParentItem(u)},_daydiff:function(n,t){return(new Date(t)-new Date(n))/864e5},_refreshChartAndGridRows:function(){var n=this,i=this.model,r,f,u;n._$treegridHelper.ejTreeGrid("processBindings");u={};u.requestType=t.TreeGrid.Actions.Refresh;n._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",u);n.model.updatedRecords=n.getUpdatedRecords();n.model.currentViewData=n.getCurrentViewData();r=n._$treegridHelper.ejTreeGrid("getCollapsedRecordCount");n._totalCollapseRecordCount=r;f=n._$treegridHelper.ejTreeGrid("getRecordsHeight");n._$ganttchartHelper.ejGanttChart("setUpdatedRecords",i.currentViewData,i.updatedRecords,i.flatRecords,i.ids);n._$ganttchartHelper.ejGanttChart("refreshHelper",i.currentViewData,i.updatedRecords,n._totalCollapseRecordCount);n._isInAdd||(n._$treegridHelper.ejTreeGrid("updateHeight"),n._$ganttchartHelper.ejGanttChart("updateHeight",f),n._$ganttchartHelper.ejGanttChart("setCollapsedRecordCount",r),n._$ganttchartHelper.ejGanttChart("refreshGridLinesTable",n.model.updatedRecords.length-r),i.enableAltRow&&i.currentViewData.length>0&&t.TreeGrid.updateAltRow(n,i.currentViewData[0],0,0),i.predecessorMapping&&n._refreshConnectorLines(!1,!0,!1))},_refreshGanttOnExpandCollapseAll:function(){var n=this,u={},i=this.model,r=0,f=0;if(i.enableVirtualization)u.requestType=t.TreeGrid.Actions.ExpandCollapse,n._$treegridHelper.ejTreeGrid("updateAltRowOnCollapseAll"),n._$treegridHelper.ejTreeGrid("updateAltRowOnRendering"),n._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",u),i.updatedRecords=n.getUpdatedRecords(),i.currentViewData=n.getCurrentViewData(),n._$ganttchartHelper.ejGanttChart("clearConnectorLines"),n._$ganttchartHelper.ejGanttChart("refreshHelper",n.model.currentViewData,n.model.updatedRecords),n._$treegridHelper.ejTreeGrid("updateHeight");else{if(n._isRefreshAddedRecord){n._refreshChartAndGridRows();n._isRefreshAddedRecord=!1;return}r=n._$treegridHelper.ejTreeGrid("getCollapsedRecordCount");n._totalCollapseRecordCount=r;f=n._$treegridHelper.ejTreeGrid("getRecordsHeight");n._$ganttchartHelper.ejGanttChart("clearConnectorLines");n._$treegridHelper.ejTreeGrid("updateHeight");n._$ganttchartHelper.ejGanttChart("setCollapsedRecordCount",r);n._$ganttchartHelper.ejGanttChart("updateHeight",f);n._$ganttchartHelper.ejGanttChart("refreshGridLinesTable",n.model.updatedRecords.length-r);i.enableAltRow&&i.currentViewData.length>0&&t.TreeGrid.updateAltRow(n,i.currentViewData[0],0,0)}i.predecessorMapping&&n._refreshConnectorLines(!1,!1,!0)},_collapsedRecords:function(){var i=this,n=i.model;return n.updatedRecords.filter(function(i){return i.parentItem==null?i:i.parentItem[n.expandStateMapping]||t.isNullOrUndefined(i.parentItem[n.expandStateMapping])?i:void 0})},_collapseRecordOnLoad:function(){var n=this,r=n.model,u=0,i,f={},e,s=r.enableVirtualization,o=n.getRows();for(n._gridRows=o,n._isInExpandCollapseAll=!0,e=n._collapsedRecords(),u=0;u<e.length;u++)if(i=e[u],!i[r.expandStateMapping]){if(i[r.expandStateMapping]||t.isNullOrUndefined(i[r.expandStateMapping]))continue;f.data=i;f.recordIndex=u;f.expanded=!1;i.hasChildRecords&&(i[r.expandStateMapping]||t.TreeGrid.sendExpandCollapseRequest(n,f))}r.flatRecords.length>0&&n._refreshGanttOnExpandCollapseAll();n._isInExpandCollapseAll=!1},_collapseAll:function(){var n=this,o=n.model,r=0,f,e,u,i={},s=n.getRows();for(f=n._getAllParentRecord(o.parentRecords),e=f.length,n._expandCollapseSettings.state="collapseAll",n._expandCollapseSettings.level=0,n._$treegridHelper.ejTreeGrid("cancelEditCell"),n._gridRows=s,n._isInExpandCollapse=!0,n._isInExpandCollapseAll=!0,i.isFromExpandCollapse=!0,n._clearMultiSelectPopup(),r=0;r<e;r++)r+1==e&&(i.isLastRefresh=!0),u=f[r],i.data=u,i.recordIndex=r,i.expanded=!1,u.hasChildRecords&&(n._expandCollapseInnerLevelRecord(u,i.expanded,i.isLastRefresh),(u.expanded||i.isLastRefresh)&&t.TreeGrid.sendExpandCollapseRequest(n,i));o.flatRecords.length>0&&n._refreshGanttOnExpandCollapseAll();n._isInExpandCollapse=!1;n._isInExpandCollapseAll=!1},_expandCollapseInnerLevelRecord:function(n,i,r){var e=this,o=n.childRecords.length,f={},u;for(r&&(f.isLastRefresh=r),f.isFromExpandCollapse=!0,u=0;u<o;u++)n.childRecords[u].hasChildRecords&&(e._expandCollapseInnerLevelRecord(n.childRecords[u],i,f.isLastRefresh),f.data=n.childRecords[u],f.expanded=i,n.childRecords[u].expanded!==i&&t.TreeGrid.sendExpandCollapseRequest(e,f))},_expandAll:function(){var n=this,f=n.model,r=0,u,i={},e=n._getAllParentRecord(f.parentRecords),o=e.length;for(n._expandCollapseSettings.state="expandAll",n._expandCollapseSettings.level=0,n._isInExpandCollapse=!0,n._isInExpandCollapseAll=!0,i.isFromExpandCollapse=!0,n._clearMultiSelectPopup(),r=0;r<o;r++)r+1==o&&(i.isLastRefresh=!0),u=e[r],i.data=u,i.recordIndex=r,i.expanded=!0,u.hasChildRecords&&(n._expandCollapseInnerLevelRecord(u,i.expanded,i.isLastRefresh),(!u.expanded||i.isLastRefresh)&&t.TreeGrid.sendExpandCollapseRequest(n,i));f.flatRecords.length>0&&n._refreshGanttOnExpandCollapseAll();n._isInExpandCollapse=!1;n._isInExpandCollapseAll=!1},_getAllParentRecord:function(n){return n.filter(function(n){if(n.hasChildRecords)return n})},_expandLevelData:function(){var r=this,i={},f=r.model,e,o,n,s=r._expandCollapseSettings.level,u;for(e=f.enableVirtualization?r._getAllParentRecord(f.flatRecords):r._getAllParentRecord(f.updatedRecords),o=e.length,i.isFromExpandCollapse=!0,u=0;u<o;u++)u+1==o&&f.enableVirtualization&&(i.isLastRefresh=!0),n=e[u],(n.level==s||i.isLastRefresh)&&(i.data=n,i.expanded=n.level==s?!0:n.expanded,t.TreeGrid.sendExpandCollapseRequest(r,i),n.level==s&&(n.parentItem&&r._expandParentLevelRecord(n.parentItem,i.expanded,i.isLastRefresh),n.hasChildRecords&&r._expandCollapseInnerLevelRecord(n,!1)))},expandAtLevel:function(n){var i=this,r=i.model;if(i._expandCollapseSettings.state=="expandAll")return!0;i._expandCollapseSettings.state="expandAtLevel";i._expandCollapseSettings.level=n;i._isInExpandCollapseAll=!0;i._expandLevelData(),{}.requestType=t.TreeGrid.Actions.ExpandCollapse;r.flatRecords.length>0&&i._refreshGanttOnExpandCollapseAll();i._isInExpandCollapseAll=!1},_expandParentLevelRecord:function(n,i,r){var f=this,u={},e=f.getExpandStatus(n);u.isLastRefresh=r;n.expanded&&e||(u.data=n,u.expanded=i,u.isFromExpandCollapse=!0,t.TreeGrid.sendExpandCollapseRequest(f,u),u.data.parentItem&&f._expandParentLevelRecord(u.data.parentItem,i,u.isLastRefresh))},_collapseLevelData:function(){var i=this,r={},f=i.model,e=i._expandCollapseSettings.level,o,s,h,n,u;for(o=f.enableVirtualization?i._getAllParentRecord(f.flatRecords):i._getAllParentRecord(f.updatedRecords),s=o.length,r.isFromExpandCollapse=!0,u=0;u<s;u++)u+1==s&&f.enableVirtualization&&(r.isLastRefresh=!0),n=o[u],h=i.getExpandStatus(n),(n&&n.level==e||r.isLastRefresh)&&(r.data=n,r.expanded=n.level==e?!1:n.expanded,t.TreeGrid.sendExpandCollapseRequest(i,r),h||n.level!=e||i._expandParentLevelRecord(n.parentItem,!0,r.isLastRefresh))},collapseAtLevel:function(n){var i=this,r=i.model;if(i._expandCollapseSettings.state=="collapseAll")return!0;i._expandCollapseSettings.state="collapseAtLevel";i._expandCollapseSettings.level=n;i._isInExpandCollapseAll=!0;i._collapseLevelData(),{}.requestType=t.TreeGrid.Actions.ExpandCollapse;r.flatRecords.length>0&&i._refreshGanttOnExpandCollapseAll();i._isInExpandCollapseAll=!1},_getDateFromFormat:function(n){return n==null||n==""?null:typeof n=="object"?new Date(n):n?t.parseDate(n,this.model.dateFormat,this.model.locale)==null?new Date(n):t.parseDate(n,this.model.dateFormat,this.model.locale):void 0},_getFormatedDate:function(n,i,r){return t.format(n,i,r)},_getNonWorkingDayIndex:function(){for(var i=this,u=i.model,r=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],f=r.length,t=u.workWeek.slice(),e=t.length,n=0;n<e;n++)t[n]=t[n].toLowerCase();for(i._nonWorkingDayIndex=[],n=0;n<f;n++)t.indexOf(r[n])==-1&&i._nonWorkingDayIndex.push(n)},_getNextWorkingDay:function(n){var t=this,r=t.model,i=n.getDay();return t._nonWorkingDayIndex.indexOf(i)!=-1?(n.setDate(n.getDate()+1),t._getNextWorkingDay(n)):n},_getPrevWorkingDay:function(n){var t=this,u=t.model,i=n.getDay(),r=i==0?6:i-1;return t._nonWorkingDayIndex.indexOf(i)!=-1||t._nonWorkingDayIndex.indexOf(r)!=-1&&this._defaultEndTime==86400&&this._getSecondsInDecimal(n)==0?(n.setDate(n.getDate()-1),t._nonWorkingDayIndex.indexOf(n.getDay())!=-1&&(n=t._getPrevWorkingDay(n)),n):n},_destroy:function(){var t=this,i,r;this.element.off();t._off(n(window),"resize",t.windowResize);n("#"+this._id+"_dialogEdit_wrapper").clearQueue();n("#"+this._id+"_dialogEdit_wrapper").stop();n("#"+this._id+"_dialogAdd_wrapper").clearQueue();n("#"+this._id+"_dialogAdd_wrapper").stop();n("#"+t._id+"_dialogAdd").find(".e-treegrid").ejTreeGrid("destroy");n("#"+t._id+"_dialogEdit").find(".e-treegrid").ejTreeGrid("destroy");n("#"+t._id+"_dialogEdit").data("ejDialog")&&n("#"+t._id+"_dialogEdit").data("ejDialog").destroy();n("#"+t._id+"_dialogAdd").data("ejDialog")&&n("#"+t._id+"_dialogAdd").data("ejDialog").destroy();n("#"+t._id+"_dialogAdd").remove();n("#"+t._id+"_dialogEdit").remove();n("#"+this._id+"_toolbarItems_Main").remove();n("#"+this._id+"_dialogEdit_wrapper").remove();n("#"+this._id+"startDateEdit_popup").remove();n("#"+this._id+"endDateEdit_popup").remove();n("#"+this._id+"startDateAdd_popup").remove();n("#"+this._id+"endDateAdd_popup").remove();n("#"+this._id+"taskTypeEdit_popup_wrapper").remove();n("#"+this._id+"_dialogAdd_wrapper").remove();n("#"+this._id+"effortDrivenEdit_popup_wrapper").remove();n("#"+this._id+"_dialogValidationRule_wrapper").remove();i=t._$ganttchartHelper.ejGanttChart("instance");i.destroy();r=t._$treegridHelper.ejTreeGrid("instance");r.destroy();t.element.empty().removeClass("e-gantt-core e-gantt "+t.model.cssClass)},_updateToolbar:function(){var i=this,f=i.model,u,o;n("#"+i._id+"_toolbarItems").remove();n("#"+i._id+"_toolbarItems_Main").remove();f.toolbarSettings.showToolbar&&(i._renderToolBar().insertBefore(n("#e-ejSpliter"+i._id)),i._updateToolbarOptions(""));i._totalBorderHeight=t.browserInfo().name=="msie"&&t.browserInfo().version<9?f.toolbarSettings.showToolbar?3:2:f.toolbarSettings.showToolbar?1:0;i._$treegridHelper.ejTreeGrid("cancelEditCell");var s=n("#"+i._id+"_toolbarItems"),r=i.element.find(".e-ganttviewerbodyContianer"),a=i.element.find(".e-ganttviewerheaderContainer"),h="#ejTreeGrid"+i._id+"e-gridcontent",v=n("#e-ejSpliter"+i._id),c=n(i.element).height()-i._totalBorderHeight,e=c-a.height()-2-s.height(),l=r.ejScroller("option","scrollTop"),y=r.ejScroller("option","scrollLeft");r.ejScroller({height:e});u=c-s.height();v.height(u);n("#ejTreeGrid"+i._id).height(u);n("#ejGanttChart"+i._id).height(u);n(h).height(e);r.height(e);n(h).ejScroller("refresh");r.ejScroller("option","scrollTop",l);r.ejScroller("option","scrollLeft",y);i._$treegridHelper.ejTreeGrid("updateViewPortHeight");i._$ganttchartHelper.ejGanttChart("updateViewPortHeight");i.model.enableVirtualization&&(i._$treegridHelper.ejTreeGrid("processBindings"),o={},o.requestType=t.TreeGrid.Actions.Refresh,i._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",o),i._$ganttchartHelper.ejGanttChart("refreshHelper",i.model.currentViewData,i.model.updatedRecords),i._$ganttchartHelper.ejGanttChart("onScrollHelper",l));i._clearContextMenu()},_removeSeparator:function(n){var i=n.toString(),r=t.preferredCulture(this.model.locale).numberFormat;return i.replace(".",r["."])},_getDurationStringValue:function(n){var t="",u,r;return n.duration!=null&&n.duration!=i&&n.duration!==""&&(typeof n.duration=="string"?(u=parseFloat(n.duration),t+=isNaN(u)?"":this._removeSeparator(parseFloat(u.toFixed(2)))+" "):t+=this._removeSeparator(parseFloat(n.duration.toFixed(2)))+" ",n.durationUnit!=null&&n.durationUnit!=i&&(r=n.duration!=1,t+=n.durationUnit=="day"||n.durationUnit=="days"?r?this._durationUnitTexts.days:this._durationUnitTexts.day:n.durationUnit=="hour"||n.durationUnit=="hours"?r?this._durationUnitTexts.hours:this._durationUnitTexts.hour:n.durationUnit=="minute"||n.durationUnit=="minutes"?r?this._durationUnitTexts.minutes:this._durationUnitTexts.minute:this.model.selectedItem.durationUnit)),t},_getPredecessorStringValue:function(n){var i=this,o=n.predecessor,s,u,f,t,r,e;if(o)for(s=o.length,u="",f=0;f<s;f++)t=o[f],r="",t.from!=n.taskId&&(r=t.from+t.predecessorsType,t.offset!=0&&(r+=t.offset>0?"+"+t.offset+" ":t.offset+" ",e=Math.abs(t.offset)!=1,r+=t.offsetDurationUnit=="day"?e?i._durationUnitTexts.days:i._durationUnitTexts.day:t.offsetDurationUnit=="hour"?e?i._durationUnitTexts.hours:i._durationUnitTexts.hour:e?i._durationUnitTexts.minutes:i._durationUnitTexts.minute),u=u.length>0?u+","+r:r);return u},_getValidStartDate:function(n){var r=this,i;return t.isNullOrUndefined(n.startDate)?t.isNullOrUndefined(n.endDate)?t.isNullOrUndefined(n.duration)?null:(i=r._getScheduledStartDate(n),i?i:null):(i=new Date(n.endDate),r._setTime(r._defaultStartTime,i),i):new Date(n.startDate)},_getValidEndDate:function(n){var r=this,i,u;return t.isNullOrUndefined(n.endDate)?t.isNullOrUndefined(n.startDate)?t.isNullOrUndefined(n.duration)?null:(u=r._getValidStartDate(n),u?(i=r._getEndDate(u,n.duration,n.durationUnit,n),new Date(i)):null):(n.isMilesStone?i=r._checkStartDate(n.startDate,n):(i=new Date(n.startDate),r._setTime(r._defaultEndTime,i)),new Date(i)):new Date(n.endDate)},_compareDates:function(n,i){return t.isNullOrUndefined(n)||t.isNullOrUndefined(i)?!t.isNullOrUndefined(n)&&t.isNullOrUndefined(i)?1:t.isNullOrUndefined(n)&&!t.isNullOrUndefined(i)?-1:!1:n.getTime()>i.getTime()?1:n.getTime()<i.getTime()?-1:0},_compareDatesFromRecord:function(n){var t=this._getValidStartDate(n),i=this._getValidEndDate(n);return this._compareDates(t,i)},_updateToScheduledValue:function(n,i){var r=this;return n._isScheduledTask()||!r._isPredecessorEdited||!n.isAutoSchedule&&!this.model.validateManualTasksOnLinking?n:(n.startDate?(n.duration=1,n._calculateEndDate(this)):n.endDate?(n.duration=1,n.startDate=r._getStartDate(n.endDate,n.duration,n.durationUnit,n)):(n.duration=t.isNullOrUndefined(n.duration)?1:n.duration,n.startDate=r._getValidStartDate(n),n._calculateEndDate(this)),n.left=n._calculateLeft(this),n.width=n._calculateWidth(this),n.progressWidth=r._getProgressWidth(n.width,n.status),r._updateItemValueInRecord(n),r._validatePredecessorOnEditing(n),r.refreshGanttRecord(n),i&&(n.parentItem&&n.isAutoSchedule?r._updateParentItem(n):r._updateManualParentItem(n)),n)}});t.ganttFeatures.predecessor&&n.extend(t.Gantt.prototype,t.ganttFeatures.predecessor);t.Gantt.ViewType={ProjectView:"projectView",ResourceView:"resourceView",HistogramView:"histogramView"};t.Gantt.EditingType={String:"stringedit",Boolean:"booleanedit",Numeric:"numericedit",Dropdown:"dropdownedit",DatePicker:"datepicker",DateTimePicker:"datetimepicker",Maskedit:"maskedEdit"};t.Gantt.ToolbarItems={Add:"add",Edit:"edit",Delete:"delete",Update:"update",Cancel:"cancel",Search:"search",Indent:"indent",Outdent:"outdent",ExpandAll:"expandAll",CollapseAll:"collapseAll",PrevTimeSpan:"prevTimeSpan",NextTimeSpan:"nextTimeSpan",CriticalPath:"criticalPath",ExcelExport:"excelExport",PdfExport:"pdfExport"};t.Gantt.ScheduleHeaderType={Year:"year",Month:"month",Week:"week",Day:"day",Hour:"hour",QuarterYear:"quarterYear",HalfYear:"halfYear"};t.Gantt.minutesPerInterval={Auto:"auto",OneMinute:"oneMinute",FiveMinutes:"fiveMinutes",FifteenMinutes:"fifteenMinutes",ThirtyMinutes:"thirtyMinutes"};t.Gantt.DurationUnit={Day:"day",Hour:"hour",Minute:"minute"};t.Gantt.WorkUnit={Day:"day",Hour:"hour",Minute:"minute"};t.Gantt.TaskType={FixedUnit:"fixedUnit",FixedWork:"fixedWork",FixedDuration:"fixedDuration"};t.Gantt.workingTimeScale={TimeScale8Hours:"TimeScale8Hours",TimeScale24Hours:"TimeScale24Hours"};t.Gantt.RowPosition={Top:"top",Bottom:"bottom",AboveSelectedRow:"aboveselectedrow",BelowSelectedRow:"belowselectedrow",Child:"child"};t.Gantt.BeginEditAction={DblClick:"dblClick",Click:"click"};t.Gantt.SelectionType={Single:"single",Multiple:"multiple"};t.Gantt.TimescaleRoundMode={Auto:"auto",Year:"year",Month:"month",Week:"week"};t.Gantt.SelectionMode={Row:"row",Cell:"cell"};t.Gantt.TaskSchedulingMode={Auto:"auto",Manual:"manual",Custom:"custom"};t.Gantt.Locale=t.Gantt.Locale||{};t.Gantt.Locale["default"]=t.Gantt.Locale["en-US"]={emptyRecord:"No records to display",unassignedTask:"Unassigned Task",alertTexts:{indentAlert:"There is no Gantt record is selected to perform the indent",outdentAlert:"There is no Gantt record is selected to perform the outdent",predecessorEditingValidationAlert:"Cyclic dependency occurred, please check the predecessor",predecessorAddingValidationAlert:"Fill all the columns in predecessor table",idValidationAlert:"Duplicate ID",dateValidationAlert:"Invalid end date",dialogResourceAlert:"Fill all the columns in resource table"},quarterYearTexts:{first:"Q1",second:"Q2",third:"Q3",fourth:"Q4"},halfYearTexts:{first:"H1",second:"H2"},columnHeaderTexts:{serialNumber:"S.No",taskId:"ID",taskName:"Task Name",startDate:"Start Date",endDate:"End Date",resourceInfo:"Resources",duration:"Duration",status:"Progress",taskMode:"Task Mode",subTasksStartDate:"SubTasks Start Date",subTasksEndDate:"SubTasks End Date",scheduleStartDate:"Schedule Start Date",scheduleEndDate:"Schedule End Date",predecessor:"Predecessors",type:"Type",offset:"Offset",baselineStartDate:"Baseline Start Date",baselineEndDate:"Baseline End Date",WBS:"WBS",WBSPredecessor:"WBS Predecessor",dialogCustomFieldName:"Column Name",dialogCustomFieldValue:"Value",notes:"Notes",taskType:"Task Type",work:"Work",unit:"Unit",effortDriven:"Effort Driven",resourceName:"Resource Name"},editDialogTexts:{addFormTitle:"New Task",editFormTitle:"Task Information",saveButton:"Save",deleteButton:"Delete Task",cancelButton:"Cancel",addPredecessor:"Add New",removePredecessor:"Remove",addButton:"Add"},columnDialogTexts:{field:"Field",headerText:"Header Text",editType:"Edit Type",filterEditType:"Filter Edit Type",allowFiltering:"Allow Filtering",allowFilteringBlankContent:"Allow Filtering Blank Content",allowSorting:"Allow Sorting",visible:"Visible",width:"Width",textAlign:"Text Alignment",headerTextAlign:"Header Text Alignment",columnsDropdownData:"Column Dropdown Data",dropdownTableText:"Text",dropdownTableValue:"Value",addData:"Add",deleteData:"Remove",allowCellSelection:"Allow Cell Selection",displayAsCheckbox:"Display As Checkbox",clipMode:"Clip Mode",tooltip:"Tooltip",showInColumnChooser:"Show In Column Chooser",headerTooltip:"Header Tooltip"},toolboxTooltipTexts:{addTool:"Add",editTool:"Edit",saveTool:"Update",deleteTool:"Delete",cancelTool:"Cancel",searchTool:"Search",indentTool:"Indent",outdentTool:"Outdent",expandAllTool:"Expand All",collapseAllTool:"Collapse All",nextTimeSpanTool:"Next Timespan",prevTimeSpanTool:"Previous Timespan",criticalPathTool:"Critical Path",excelExportTool:"Excel Export",pdfExportTool:"PDF Export"},durationUnitTexts:{days:"days",hours:"hours",minutes:"minutes",day:"day",hour:"hour",minute:"minute"},durationUnitEditText:{minute:["m","min","minute","minutes"],hour:["h","hr","hour","hours"],day:["d","dy","day","days"]},workUnitTexts:{day:"days",hour:"hours",minute:"minutes"},taskTypeTexts:{fixedWork:"Fixed Work",fixedUnit:"Fixed Units",fixedDuration:"Fixed Duration"},effortDrivenTexts:{yes:"Yes",no:"No"},contextMenuTexts:{taskDetailsText:"Task Details...",addNewTaskText:"Add New Task",indentText:"Indent",outdentText:"Outdent",deleteText:"Delete",aboveText:"Above",belowText:"Below"},newTaskTexts:{newTaskName:"New Task"},columnMenuTexts:{sortAscendingText:"Sort Ascending",sortDescendingText:"Sort Descending",columnsText:"Columns",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",renameColumn:"Rename Column"},taskModeTexts:{manual:"Manual",auto:"Auto"},editTypeTexts:{string:"String",numeric:"Numeric",datePicker:"Date Picker",dateTimePicker:"Date Time Picker",dropdown:"Dropdown",boolean:"Boolean"},textAlignTypes:{right:"Right",left:"Left",center:"Center"},clipModeTexts:{clip:"Clip",ellipsis:"Ellipsis"},columnDialogTitle:{insertColumn:"Insert Column",deleteColumn:"Delete Column",renameColumn:"Rename Column"},deleteColumnText:"Are you sure you want to delete this column?",okButtonText:"OK",cancelButtonText:"Cancel",confirmDeleteText:"Confirm Delete",predecessorEditingTexts:{fromText:"From",toText:"To"},dialogTabTitleTexts:{generalTabText:"General",predecessorsTabText:"Predecessors",resourcesTabText:"Resources",customFieldsTabText:"Custom Fields",notesTabText:"Notes"},predecessorCollectionText:[{id:"SS",text:"Start-Start",value:"Start-Start"},{id:"SF",text:"Start-Finish",value:"Start-Finish"},{id:"FS",text:"Finish-Start",value:"Finish-Start"},{id:"FF",text:"Finish-Finish",value:"Finish-Finish"}],linkValidationRuleText:{taskBeforePredecessor:"You moved '{0}' to start before '{1}' finishes and the two tasks are linked. As the result, the links cannot be honored. Select one action below to perform",taskAfterPredecessor:"You moved '{0}' away from '{1}' and the two tasks are linked. As the result, the links cannot be honored. Select one action below to perform"},linkValidationDialogTitle:"Validate Editing",linkValidationRuleOptions:{cancel:"Cancel, keep the existing link",removeLink:"Remove the link and move '{0}' to start on '{1}'.",preserveLink:"Move the '{0}' to start on '{1}' and keep the link."},connectorLineDialogText:{from:"From",to:"To",taskLink:"Task Link",type:"Type",lag:"Lag",okButtonText:"Ok",cancelButtonText:"Cancel",deleteButtonText:"Delete",title:"Task Dependency"},nullText:"Null"};t.Gantt.GanttRecord=function(){var n=this;n.eResourceName="";n.eResourceChildTasks=[];n.eResourceTaskType="";n.eOverlapIndex=1;n.eOverlapWithIndex=-1;n.eOverlapped=!1;n.taskId=null;n.taskName=null;n.startDate=null;n.endDate=null;n.duration=null;n.isMilestone=!1;n.status=null;n.predecessor=null;n.resourceInfo=null;n.parentItem=null;n.isSelected=!1;n.childRecords=null;n.hasChildRecords=!1;n.expanded=!1;n.level=0;n.left=0;n.width=0;n.progressWidth=0;n.item=null;n.baselineLeft=0;n.baselineWidth=0;n.baselineStartDate=null;n.baselineEndDate=null;n.isCritical=!1;n.slack=null;n.isReadOnly=!1;n.hasFilteredChildRecords=!0;n.taskbarBackground=null;n.progressbarBackground=null;n.parentProgressbarBackground=null;n.cellBackgroundColor=null;n.rowBackgroundColor=null;n.treeMappingName=[];n.dragState=!0;n.isSelected=!1;n.durationUnit="";n.isAutoSchedule=!0;n.manualStartDate=null;n.manualEndDate=null;n.manualLeft=0;n.manualDuration=0;n.manualWidth=0;n.serialNumber=null;n.serialNumberPredecessor=null;n.totalProgress=0;n.totalDuration=0};t.Gantt.GanttRecord.prototype={_calculateLeft:function(n){var i,r=0,u=-300,f=this.isMilestone;return this.startDate?i=new Date(this.startDate):this.endDate?(i=new Date(this.endDate),r=n._unscheduledTaskWidth,f=!0):i=n._getValidStartDate(this),t.isNullOrUndefined(i)||(u=n._getTaskLeft(i,f)-r),u},_calculateManualLeft:function(n){return n._getTaskLeft(this.manualStartDate)},_calculateBaselineLeft:function(n){var t=new Date(this.baselineStartDate),i=new Date(this.baselineEndDate);return t&&i?n._getTaskLeft(t,this.isMilestone):0},_calculateBaselineRight:function(n){var i=new Date(this.baselineStartDate),t=new Date(this.baselineEndDate);return i&&t?n._getTaskLeft(t):0},_calculateWidth:function(n){var i,r;return t.isNullOrUndefined(this.startDate)&&t.isNullOrUndefined(this.endDate)?(i=n._getValidStartDate(this),r=n._getValidEndDate(this)):(i=this.startDate,r=this.endDate),t.isNullOrUndefined(i)||t.isNullOrUndefined(r)?n._unscheduledTaskWidth:n._getTaskWidth(i,r)},_calculateManualWidth:function(n){var t=this,i=new Date(t.manualStartDate),r=new Date(t.manualEndDate);return n._getTaskWidth(i,r)},_calculateBaseLineWidth:function(n){var r=this,t=new Date(this.baselineStartDate),i=new Date(this.baselineEndDate);return n._getTaskWidth(t,i)},_getFormatedDate:function(n,i,r){return t.format(n,i,r)},_getDateFromFormat:function(n,i,r){if(n)return t.parseDate(n,i,r)==null?new Date(n):t.parseDate(n,i,r)},_setResourceInfo:function(i,r,u,f,e){var l=this,o=0,c=[],s,h;for(o;o<i.length;o++)s=e.filter(function(n){return typeof i[o]=="object"&&i[o][r]===n[r]?!0:i[o]===n[r]}),h=n.extend({},s[0]),s.length?(c.push(h),f==""||t.isNullOrUndefined(i[o][f])?l._updateResourceUnit(s[0],h,f):h[f]=i[o][f]):(i.splice(o,1),o--);return c},_updateResourceUnit:function(n,i,r){r!=""?t.isNullOrUndefined(n[r])&&(i[r]=100):i.unit=100},_updateParentProgress:function(n,t,i){var f=0,h=i,r=n.childRecords,e=0,o,c=r?r.length:0,s=0,l=0,a=0,u,v;if(r){for(u=0;u<c;u++)!r[u].isMilestone||r[u].hasChildRecords?(o=h._getParentProgress(r[u]),s+=o.totalProgress,e+=o.totalDuration):l+=1;a=c-l;f=a>0?Math.round(s/e):0;n.totalProgress=s;n.totalDuration=e;isNaN(f)&&(f=0);v=n.isAutoSchedule?n.width:n.manualWidth;n.progressWidth=this._getProgressWidth(v,f);n.status=Math.floor(f);t&&(n.item[t]=n.status)}n.parentItem&&this._updateParentProgress(n.parentItem,t,h)},_getProgressWidth:function(n,t){return n*t/100},_calculatePredecessor:function(n,t,i,r){var a=[],e,f={},o,p=this.taskId.toString(),h,v=this,y,u=r,s,c,l;return y=u.model.viewType=="resourceView"?u._resourceUniqTaskIds:u.model.ids,typeof n=="string"&&n.split(",").forEach(function(n){var r,w;if(o=n.split("+"),h="+",n.indexOf("-")>=0&&(o=n.split("-"),h="-"),e=o[0].match(/(\d+|[A-z]+)/g),e[0]&&y.indexOf(e[0])!=-1)e.length>1?(r=e[1].toUpperCase(),r=="FS"||r=="FF"||r=="SF"||r=="SS"?s=r:(u._isValidPredecessorString&&(u._isValidPredecessorString=!1),s="FS")):(u._isValidPredecessorString&&(u._isValidPredecessorString=!1),s="FS");else{u._isValidPredecessorString&&(u._isValidPredecessorString=!1);return}f={from:e[0],predecessorsType:s,offset:o.length>1?h+""+o[1]:"0",isdrawn:!1,to:p};c=u._getRecordByTaskId(f.from);l=u._getRecordByTaskId(f.to);c&&(c.hasChildRecords||(l?l.hasChildRecords:v.hasChildRecords)||(w=v._getOffsetDurationUnit(f.offset,t,i),f.offset=w.duration,f.offsetDurationUnit=w.durationUnit,a.push(f)))}),a},_getOffsetDurationUnit:function(i,r,u){var o=0,e=u,f,s,h;if(typeof i=="string"){for(f=i.match(/[^0-9]+|[0-9]+/g),s=0;s<f.length;s++)f[s]=n.trim(f[s]);f[0]=="-"&&f[1]?(f[1]=f[0]+f[1],f.shift()):f[0]=="+"&&f.shift();f[1]!="."||isNaN(parseInt(f[2]))||(f[0]+=f[1]+f[2],f.splice(1,2));f&&f.length<=2&&(o=parseFloat(f[0]),e=f[1]?n.trim(f[1].toLowerCase()):"",e=r.minute.indexOf(e)!=-1?t.Gantt.DurationUnit.Minute:r.hour.indexOf(e)!=-1?t.Gantt.DurationUnit.Hour:r.day.indexOf(e)!=-1?t.Gantt.DurationUnit.Day:u)}else o=i,e=u;return isNaN(o)&&(o=0,e=t.Gantt.DurationUnit.Day),h={},h.duration=o,h.durationUnit=e,h},_calculateEndDate:function(n){var i=n.model,r=null;t.isNullOrUndefined(this.startDate)||(!t.isNullOrUndefined(this.endDate)&&t.isNullOrUndefined(this.duration)&&(n._compareDates(this.startDate,this.endDate)==1&&(this.startDate=new Date(this.endDate),n._setTime(n._defaultStartTime,this.startDate)),this._calculateDuration(n)),t.isNullOrUndefined(this.duration)||(r=n._getEndDate(this.startDate,this.duration,this.durationUnit,this)),this.endDate=r);i.endDateMapping&&(this.item[i.endDateMapping]=this.endDate)},_calculateDuration:function(n){var t=n.model,i=n._getDuration(this.startDate,this.endDate,this.durationUnit,this.isAutoSchedule);this.duration=i;t.durationMapping&&this.item&&(this.item[t.durationMapping]=i,t.durationUnitMapping&&(this.item[t.durationUnitMapping]=this.durationUnit))},_calculateManualDuration:function(n){var t=n._getDuration(this.manualStartDate,this.manualEndDate,this.durationUnit,this.isAutoSchedule);this.manualDuration=t},_updateDurationWithWork:function(n,i){for(var s,a,f=n.model,h,e=i?i:this.resourceInfo,c=e?e.length:0,l=0,r=0,u=n._secondsPerDay/3600,o=0;o<c;o++)s=e[o][f.resourceUnitMapping],a=s>0?u*s/100:u,l+=a;h=this._getTotalWorksInHours(f,u);c!=0&&(r+=h/l);this.durationUnit=="minute"&&(r=r*u*60);this.durationUnit=="hour"&&(r=r*u);r%1!=0&&(r=parseFloat(r.toFixed(2)));t.isNullOrUndefined(this.duration)||(n._isDurationUpdated=!0,this.duration=r,f.durationMapping&&(this.item[f.durationMapping]=this.duration))},_updateWorkWithDuration:function(n,t){for(var o,s,r=n.model,f=t?t:this.resourceInfo,h=f?f.length:0,i=0,u=n._secondsPerDay/3600,c=this._getDurationInDays(u),e=0;e<h;e++)o=f[e][r.resourceUnitMapping],s=o>0?u*o/100:u,i+=s*c;r.workUnit=="minute"&&(i=i*60);r.workUnit=="day"&&(i=i/u);i%1!=0&&(i=i.toFixed(2));this.work=parseFloat(i);r.workMapping&&(this.item[r.workMapping]=this.work)},_updateUnitWithWork:function(n){var e=n.model,r=this.resourceInfo,u=r?r.length:0,f=n._secondsPerDay/3600,i;if(u!=0){var o=this._getDurationInDays(f),h=this._getTotalWorksInHours(e,f),s=o>0?h/(o*f)*100:0,t=s>0?s/u:100;for(t%1!=0&&(t=parseFloat(t.toFixed(2))),i=0;i<u;i++)r[i][e.resourceUnitMapping]=t;n._updateResourceName(this)}},_getTotalWorksInHours:function(n,t){var i=this;return n.workUnit=="day"?i.work*t:n.workUnit=="minute"?i.work/60:i.work},_getDurationInDays:function(n){var r=this,i=t.isNullOrUndefined(r.duration)?0:r.duration;return this.durationUnit=="hour"?i/n:this.durationUnit=="minute"?i/(n*60):i},_getProgressPercent:function(n,t){return Math.ceil((t/n*100).toFixed(2))},_setTime:function(n,t){var i=parseInt(n/3600),r=parseInt((n-i*3600)/60),u=n-i*3600-r*60;t.setHours(i,r,u,0)},_endDateUpdate:function(n,t,i,r,u){i||(i=0);var f=new Date(n.getFullYear(),n.getMonth(),n.getDate()+t,n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds());return u=="day"||u=="hour"?(f.setHours(24),f.setMinutes(i)):r.length&&(i>0?(f.setHours(24),this._setTime(r[0].from,f),f.setMinutes(i)):this._setTime(r[r.length-1].to,f)),f},_startDateUpdate:function(n,t,i,r,u){i||(i=0);var f=new Date(n.getFullYear(),n.getMonth(),n.getDate()+t,n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds());return u=="day"||u=="hour"?f.setMinutes(i):r.length&&(i>0?(this._setTime(r[0].from,f),f.setMinutes(i)):this._setTime(r[0].from,f)),f},_isScheduledTask:function(){return t.isNullOrUndefined(this.startDate)&&t.isNullOrUndefined(this.endDate)&&t.isNullOrUndefined(this.duration)?null:t.isNullOrUndefined(this.startDate)||t.isNullOrUndefined(this.endDate)||t.isNullOrUndefined(this.duration)?!1:!0}};t.Gantt._getDurationStringValue=function(n){var t="",u,r;return n.duration!=null&&n.duration!=i&&n.duration!==""&&(typeof n.duration=="string"?(u=parseFloat(n.duration),t+=isNaN(u)?"":parseFloat(u.toFixed(2))+" "):t+=parseFloat(n.duration.toFixed(2))+" ",n.durationUnit!=null&&n.durationUnit!=i&&(r=n.duration!=1,t+=n.durationUnit=="day"?r?this.model.durationUnitTexts.days:this.model.durationUnitTexts.day:n.durationUnit=="hour"?r?this.model.durationUnitTexts.hours:this.model.durationUnitTexts.hour:r?this.model.durationUnitTexts.minutes:this.model.durationUnitTexts.minute)),t};t.Gantt._getCellValue=function(n){var t=this.data[n];return t?t:this.data.item&&this.data.item[n]}}(jQuery,Syncfusion),function(n,t,i){"use strict";t.ganttChartFeatures=t.ganttChartFeatures||{};t.widget("ejGanttChart","ej.GanttChart",{element:null,model:null,_rootCSS:"e-ganttchart",keyConfigs:{focus:"e",insertRecord:"45",deleteRecord:"46",editRecord:"113",saveRequest:"13",cancelRequest:"27",firstRowSelection:"36",lastRowSelection:"35",leftArrow:"37",rightArrow:"39",upArrow:"38",downArrow:"40",moveCellRight:"9",moveCellLeft:"shift+9",selectedRowExpand:"alt+40",totalRowExpand:"ctrl+40",selectedRowCollapse:"alt+38",totalRowCollapse:"ctrl+38",shiftDownArrow:"shift+40",shiftUpArrow:"shift+38"},defaults:{childPropertyName:"",taskIdMapping:"",taskNameMapping:"",startDateMapping:"",endDateMapping:"",childMapping:"",finishDateMapping:"",durationMapping:"",milestoneMapping:"",progressMapping:"",predecessorMapping:"",resourceInfoMapping:"",resourceNameMapping:"",resourceCollection:[],holidays:[{day:null,label:null,background:null}],stripLines:[{day:null,label:null,lineStyle:"dotted",lineColor:"#169dd7",lineWidth:2}],enableTaskbarTooltip:!0,enableTaskbarDragTooltip:!0,highlightWeekends:!0,scheduleStartDate:null,scheduleEndDate:null,enableProgressBarResizing:!0,rowHeight:30,progressbarHeight:100,connectorlineWidth:1,dateFormat:"MM/dd/yyyy",locale:"en-US",taskbarBackground:"#DE8080",progressbarBackground:"#C44647",weekendBackground:"#F2F2F2",connectorLineBackground:"#383838",parentTaskbarBackground:"#383838",parentProgressbarBackground:"#1C1C1C",selectedItem:null,selectedRowIndex:-1,perDayWidth:null,perMonthWidth:null,perWeekWidth:null,perHourWidth:null,queryTaskbarInfo:null,taskbarTemplate:"",progressbarTemplate:null,parenttaskbarTemplate:"",parentprogressbarTemplate:null,milestoneTemplate:"",flatRecords:[],updatedRecords:[],selectedItems:[],ids:[],currentViewData:[],scheduleWeeks:[],scheduleYears:[],scheduleMonths:[],scheduleDays:[],scheduleHours:[],projectStartDate:null,projectEndDate:null,tooltipTemplate:"",tooltipTemplateId:"",progressbarTooltipTemplateId:"",taskbarEditingTooltipTemplateId:"",taskbarEditingTooltipTemplate:"",progressbarTooltipTemplate:"",showTaskNames:!0,leftTaskLabelMapping:"",rightTaskLabelMapping:"",LeftTaskLabelTemplate:"",rightTaskLabelTemplate:"",showProgressStatus:!0,showResourceNames:!0,includeWeekend:!1,allowZooming:!1,readOnly:!1,allowGanttChartEditing:!0,allowKeyboardNavigation:!0,allowDragAndDrop:!1,renderBaseline:!1,baselineColor:"#fba41c ",editSettings:{allowEditing:!1,allowAdding:!1,allowDeleting:!1,editMode:"normal",dialogEditorTemplateId:null},scheduleHeaderSettings:{weekHeaderFormat:"MMM dd , yyyy",dayHeaderFormat:"",weekendBackground:"#F2F2F2",yearHeaderFormat:"yyyy",monthHeaderFormat:"MMM",hourHeaderFormat:"HH",minuteHeaderFormat:"mm",scheduleHeaderType:"week",weekStartDay:0},workingTimeScale:"TimeScale8Hours",roundOffDayworkingTime:!0,durationUnit:"day",localizedDays:null,localizedMonths:null,columnHeaderTexts:null,predecessorEditingTexts:null,enablePredecessorEditing:!0,taskbarClick:null,predecessorTooltipTemplate:""},updateHighlightNonWorkingTime:function(n){var i=this;i.model.highlightNonWorkingTime=n;i.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&i._renderDayWorkColor()},updateNonWorkingBackground:function(n){var t=this;(t.model.nonWorkingBackground=n,t.model.nonWorkingBackground)&&t._renderDayWorkColor()},updateHighlightWeekends:function(n){var i=this;i.model.highlightWeekends=n;i.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day?i._renderDayWorkColor():i.model.highlightWeekends==!0?i._renderWeekends():i._$weekendsContainer.remove()},updateWeekendBackground:function(n){var i=this;i.model.weekendBackground=n;i.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day?i._renderDayWorkColor():(i._$weekendsContainer.remove(),i._renderWeekends())},showTooltip:function(n){var t=this;t.model.enableTaskbarTooltip=n;t._createChartTaskbarTemplate();t._refresh()},showEditingTooltip:function(n){var t=this;t.model.enableTaskbarDragTooltip=n;t._createChartTaskbarTemplate();t._refresh()},updateConnectorLineBackground:function(n){var t=this;t.model.connectorLineBackground=n;t._createConnectorLineTemplate()},updateConnectorlineWidth:function(n){var t=this;t.model.connectorlineWidth=parseInt(n);t._createConnectorLineTemplate()},updateTaskbarBackground:function(n){var t=this;t.model.taskbarBackground=n;this._createChartTaskbarTemplate();this._refresh()},updateProgressbarBackground:function(n){this.model.progressbarBackground=n;this._createChartTaskbarTemplate();this._refresh()},updateParentTaskbarBackground:function(n){this.model.parentTaskbarBackground=n;this._createChartTaskbarTemplate();this._refresh()},updateParentProgressbarBackground:function(n){this.model.parentProgressbarBackground=n;this._createChartTaskbarTemplate();this._refresh()},updateRenderTaskNames:function(n){var t=this;t.model.showTaskNames=n;t._createChartTaskbarTemplate();t._refresh()},refreshLeftTaskLabelMapping:function(n){var t=this;t.model.leftTaskLabelMapping=n;t._createChartTaskbarTemplate();t._refresh()},refreshRightTaskLabelMapping:function(n){var t=this;t.model.rightTaskLabelMapping=n;t._createChartTaskbarTemplate();t._refresh()},refreshLeftTaskLabelTemplate:function(n){var t=this;t.model.leftTaskLabelTemplate=n;t._createChartTaskbarTemplate();t._refresh()},refreshRightTaskLabelTemplate:function(n){var t=this;t.model.rightTaskLabelTemplate=n;t._createChartTaskbarTemplate();t._refresh()},updateRendeProgressStatus:function(n){var t=this;t.model.showProgressStatus=n;t._createChartTaskbarTemplate();t._refresh()},updateRenderResourceNames:function(n){var t=this;t.model.showResourceNames=n;t._createChartTaskbarTemplate();t._refresh()},changeMilestoneTemplate:function(n){var t=this;t.model.milestoneTemplate=n;t._createChartTaskbarTemplate();t._refresh()},changeTaskbarTemplate:function(n){var t=this;t.model.taskbarTemplate=n;t._createChartTaskbarTemplate();t._refresh()},changeParentTaskbarTemplate:function(n){var t=this;t.model.parentTaskbarTemplate=n;t._createChartTaskbarTemplate();t._refresh()},ganttChartEditing:function(n){var t=this;t.model.allowGanttChartEditing=n},updateReadOnly:function(n){var t=this;t.model.readOnly=n},resizeProgressbar:function(n){var t=this;t.model.enableProgressBarResizing=n},updateAllowKeyboardNavigation:function(n){this.model.allowKeyboardNavigation=n},updateProgressbarHeight:function(n){var t=this;this.model.progressbarHeight=n;t._createChartTaskbarTemplate();t._refresh()},updateBaselineColor:function(n){var t=this;this.model.baselineColor=n;t._createChartTaskbarTemplate();t._refresh()},updateRenderBaseline:function(n){var t=this;this.model.renderBaseline=n;t._createChartTaskbarTemplate();t._refresh();t._createConnectorLineTemplate()},focusGanttElement:function(){if(t.browserInfo().name=="msie")try{this.element[0].setActive()}catch(r){}else{var i=n(window).scrollTop();this.element[0].focus();n(window).scrollTop(i)}},_getYearWidth:function(){for(var i=this,n=0,t=0,n=0;n<this.model.scheduleYears.length;n++)t+=this._getTemplateYearWidth(this.model.scheduleYears[n]);return t},_getMonthWidth:function(){for(var r,e,u,h,o=this,c=o.model,n,s=c.scheduleMonths,i=0,f=0;f<s.length;f++)r=s[f],n=typeof r=="object"?new Date(r):t.parseDate(r,this.model.dateFormat,this.model.locale),e=new Date(n.getFullYear(),n.getMonth()+1,0),u=e.getDate(),n.getTime()===o.model.scheduleMonths[0].getTime()?(h=e.getDate()-n.getDate(),i+=this.model.perDayWidth*(h+1)):u==31?i+=this.model.perDayWidth*31:u==30?i+=this.model.perDayWidth*30:u==28&&(i+=this.model.perDayWidth*28);return i},_getWeekWidth:function(){return this.model.perDayWidth*7},_getHeight:function(){return this._containerHeight},_setHeight:function(n){this._containerHeight=n},getGanttChartRows:function(){return this._ganttChartRows},getUpdatedRecords:function(){return this.model.flatRecords},setUpdatedRecords:function(n,t,i,r){var u=this;u.model.currentViewData=n;u.model.updatedRecords=t;u.model.flatRecords=i;u.model.ids=r},_getFormatedDate:function(n,i,r){return t.format(n,i,r)},_getViewportHeight:function(){var n=this,t=n._$headerContainer;return n.element.height()-t.height()-parseFloat(t.css("border-bottom-width"))},getViewportHeight:function(){return this._getViewportHeight()},setViewPortHeight:function(){this._viewportHeight=this._getViewportHeight()-18},updateViewPortHeight:function(){var n=this;n._viewportHeight=n._getViewportHeight()},_init:function(){var r=this,u=r.model,e=!1,f=u.scheduleHeaderSettings.scheduleHeaderType,o;r.element.addClass("e-ganttchart-core");r.element.attr("tabindex","0");u.cssClass&&r.element.addClass(u.cssClass);r._initPrivateProperties();r._initialize();r._getNonWorkingDayIndex();r._renderGanttChart();r._$bodyContainerParent.append(r._$bodyContainer);r._$bodyContainer.append(r._$bodyContent);r._$ganttChartContainer.append(r._$bodyContainerParent);r._setHeight(this.getRecordsHeight());n(r._$bodyContainer).css({height:r._viewportHeight+"px"});this._containerHeight>0?n(r._$bodyContent).css({height:this._containerHeight+"px"}):n(r._$bodyContent).css({height:"1px"});f=="week"?n(r._$bodyContent).css({width:u.scheduleWeeks.length*r._scheduleWeekWidth+"px"}):f=="year"||f=="quarterYear"||f=="halfYear"?n(r._$bodyContent).css({width:r._scheduleYearWidth+"px"}):f=="month"?n(r._$bodyContent).css({width:r._scheduleMonthWidth+"px"}):f=="day"?n(r._$bodyContent).css({width:u.scheduleDays.length*u.perHourWidth*24+"px"}):f=="hour"&&n(r._$bodyContent).css({width:u.scheduleHours.length*u.perMinuteWidth*r._totalInterval+"px"});r.createGridLinesTable();r.renderGanttRecords();o=t.buildTag("div");o.append(r._$bodyContent);r._$bodyContainer.append(o);r._$bodyContent.width()<r._$bodyContainerParent.width()?(e=!0,r._viewportHeight=r._getViewportHeight()-18):(e=!1,r._viewportHeight=r._getViewportHeight());r._$bodyContainer.ejScroller({width:r.element.width()-1,enableTouchScroll:!1,height:e?r._getViewportHeight()-18:r._getViewportHeight(),scroll:function(n){var t=n.scrollTop;n.requestType="scroll";n.delta=t;t!=i?r.onScrollHelper(t,!0)===!1&&(n.cancel=!0):r._handleScroll(n)}});e=!1;r._$bodyContainer.ejScroller("model.keyConfigs",{up:"",down:"",left:"",right:""});r._$bodyContainer.ejScroller("refresh");r._wireEvents()},reRenderGanttChart:function(t,i){var r=this,u=r.model,f=u.scheduleHeaderSettings.scheduleHeaderType;r._wireEvents();u.perDayWidth=t;u.flatRecords=i;r._scheduleWeekWidth=r._getWeekWidth();r._scheduleYearWidth=r._getYearWidth();r._scheduleMonthWidth=r._getMonthWidth();n(r._$headerContainer).empty();n(r._$scheduleDiv).empty();r._renderGanttChart();r._$bodyContainerParent.append(r._$bodyContainer);r._$bodyContainer.append(r._$bodyContent);r._$ganttChartContainer.append(r._$bodyContainerParent);f=="week"?n(r._$bodyContent).css({width:u.scheduleWeeks.length*r._scheduleWeekWidth+"px"}):f=="year"||f=="quarterYear"||f=="halfYear"?n(r._$bodyContent).css({width:r._scheduleYearWidth+"px"}):f=="month"?n(r._$bodyContent).css({width:r._scheduleMonthWidth+"px"}):f=="day"?n(r._$bodyContent).css({width:u.scheduleDays.length*u.perHourWidth*24+"px"}):f=="hour"&&n(r._$bodyContent).css({width:u.scheduleHours.length*u.perMinuteWidth*r._totalInterval+"px"})},_initPrivateProperties:function(){var t=this;t._viewportHeight=0;t._prevScrollTop=0;t._scrollTop=0;t._vScrollDir=1;t._scrollLeft=0;t._maxZIndex=0;t._taskbarEditedArgs={};t._$ganttChartContainer=null;t._$headerContainer=null;t._$bodyContainer=null;t._$bodyContent=null;t._$dependencyViewContainer=null;t._$secondaryCanvas=null;t._$ganttViewTable=null;t._nonWorkingTimeRanges=[];t._$ganttViewTablebody=null;t._weekdays=[];t._rowMargin=0;t._renderedRange=null;t._visibleRange=null;t._vTop=null;t._vBottom=null;t._rTop=null;t._rBottom=null;t._vscrollDist=0;t._containerHeight=0;t._id=this.element.attr("id");t._ganttChartRows=null;t._filteredRecords=[];t._sortedRecords=[];t._tempSortedRecords=[];t._scheduleHours=[];t._scheduleMinutes=[];t._updateScheduleWidth();t._totalMonthWidth=0;t._tempFilteredRecords=[];t._prevLeft=0;t._allowDragging=!1;t._leftResizing=!1;t._rightResizing=!1;t._progressResizing=!1;t._editingContainer=null;t._allowExpandCollapse=!0;t._leftResizer=null;t._taskbarItem=null;t._progressbarItem=null;t._progressResizer=null;t._rightResizer=null;t._manualRightResizer=null;t._tasknameContainer=null;t._prevSelectedItem=null;t._multiSelectCtrlRequest=!1;t._ganttTouchTrigger=!1;t._mousePosX=0;t._currMousePosX=0;t._currMousePosY=0;t._resMousePosX=0;t._resMousePosY=0;t._currentItemTop=0;t._currentItemPrevTop=0;t._prevItem={};t._parentCollectionPreviousValues=[];t._mouseTarget=null;t._mouseDown=!1;t._$scheduleDiv=null;t._leftResizerGripper=null;t._rightResizerGripper=null;t._progressHandle=null;t._progressHandleChild=null;t._mouseHoverTooltip=document.getElementById(this.model.tooltipTemplate);t._progressBarTooltipID=document.getElementById(this.model.progressbarTooltipTemplateId);t._taskbarEditingTooltipID=document.getElementById(this.model.taskbarEditingTooltipTemplateId);t._scrollBarHeight=18;t._windowWidth=n(window).width();t._windowHeight=n(window).height();t._editingItem=null;t._editingTarget=null;t.tooltipState=null;t._visibleRecordsCount=0;t._tooltipTimer;t._isCalendarExist=null;t._$gridLinesTablebody=null;t._leftConnectorPoint=null;t._rightConnectorPoint=null;t._childLeftConnectorPoint=null;t._childRightConnectorPoint=null;t._editPredecessor=!1;t._connectorPointX=null;t._connectorPointY=null;t._predecessorTooltip=null;t._totalCollapsedRecordCount=0;t._milesStoneWidth=0;t._connectorPointWidth=0;t._newXYPos=!0;t._posX1=null;t._posY1=null;t._posY=null;t._posX=null;t._nonWorkingDayIndex=[];t._mousePosY=0;t.dragPosX=0;t._timerDragVertical=null;t._timerDragHorizontal=null;this._shiftSelectedRecord=null;t._roundOffDuration=!1;t._connectorDrawElement=null;t._isPredecessorEditOpen=!1;t._hoverConnectorLineElement=null;t._predecessorInfo=null},_initialize:function(){var n=this;n._$ganttChartContainer=t.buildTag("div.e-ganttviewercontainer#ganttviewercontainer"+n._id,"",{width:"100%"},{});n._$headerContainer=t.buildTag("div.e-ganttviewerheaderContainer#ganttviewerheaderContainer"+n._id,"",{"border-right-style":"solid","border-right-width":"1px"},{});n._$bodyContainer=t.buildTag("div.e-ganttviewerbodyContianer#ganttviewerbodyContianer"+n._id,"",{"-ms-touch-action":"none"},{});n._$bodyContainerParent=t.buildTag("div.e-ganttviewerbodyContianerparent#ganttviewerbodyContianerParent"+n._id,"",{"-ms-touch-action":"none","border-right-style":"solid","border-right-width":"1px","box-sizing":"border-box",width:"auto",height:"auto"},{});n._$bodyContent=t.buildTag("div.e-ganttviewerbodyContent#ganttviewerbodyContent"+n._id,"",{},{});n._$dependencyViewContainer=t.buildTag("div.e-ganttviewerbodyContianer-dependencyViewContainer#dependencyViewContainer"+n._id,"",{"z-index":"5",position:"absolute"},{});n._$secondaryCanvas=t.buildTag("div.e-ganttviewerbodyContianer-secondaryCanvas","",{"z-index":"3",position:"absolute"},{});n._$stripLineContainer=t.buildTag("div.e-ganttviewerbodyContianer-stripLines","",{"z-index":"6",position:"absolute"},{});n._$weekendsContainer=t.buildTag("div.e-ganttviewerbodyContianer-weekendsContainer","",{"z-index":"1",position:"absolute"},{});n._$ganttViewTable=t.buildTag("table.e-ganttviewerbodyContianer-ganttViewTable e-zerospacing#ganttViewTable"+n._id,"",{"z-index":"5",position:"absolute"});n._$scheduleDiv=t.buildTag("div.e-gantt-schedule-container#gantt-schedule"+n._id+"","",{},{})},_createChartTaskbarTemplate:function(){this.model.viewType=="resourceView"?this._createResourceTaskbarTemplate():this.model.viewType=="histogramView"?this._createHistogramTaskbarTemplate():this._createTaskbarTemplate()},_renderDayWorkColor:function(){for(var t=this,n=t.model,r=!1,i=0;i<n._nonWorkingTimeRange.length;i++)if(n._nonWorkingTimeRange[i].color){r=!0;break}n.highlightNonWorkingTime||r||n.highlightWeekends?t._renderCustomDaySchedule():t._$weekendsContainer.children(".e-secondary_canvas").remove()},_renderGanttChart:function(){var i=this,r=i.model,f,e,o=r.scheduleHeaderSettings.scheduleHeaderType,s,u;if(i._createSchedule(i._getDateType(r.scheduleStartDate),i._getDateType(r.scheduleEndDate)),i._viewportHeight=i._getViewportHeight(),i._$ganttViewTable.css("width",i._getScheduleLength(o)+"px"),f=t.buildTag("colgroup","",{},{}),e=n(document.createElement("col")),e.css("width",i._getScheduleLength(o)+"px"),f.append(e),i._$ganttViewTable.append(f),i._createTooltipTemplate(),i._createEditingTooltipTemplate(),i._createProgressbarTooltipTemplate(),this._createChartTaskbarTemplate(),i._createConnectorLineTemplate(),i._createPredecessorTooltipTemplate(),i._updateCurrentViewData(),i.model.highlightWeekends==!0&&r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&i._renderWeekends(),r.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&i._renderDayWorkColor(),i._$stripLineContainer.empty(),i.model.stripLines!=null&&this._renderStripLines(i.model.stripLines),i._$secondaryCanvas.empty(),i.model.holidays!=null)for(s=i.model.holidays.length,u=0;u<s;u++)i._renderHoliday(i.model.holidays[u])},renderConnectorLines:function(t){var i=this,r=n.render[i._id+"ConnectorLineTemplate"](t);n(i._$dependencyViewContainer).empty();i._$dependencyViewContainer.append(r);i._$bodyContent.append(i._$dependencyViewContainer)},clearConnectorLines:function(){n(this._$dependencyViewContainer).empty()},clearSelection:function(i){var u=this,r=u.model,f;if(r.selectedRowIndex!=-1&&(i==-1||t.isNullOrUndefined(i)))f=u.getGanttChartRows(),f.removeClass("e-gantt-mouseclick"),r.selectedRowIndex=-1,r.selectedItem=null,r.selectedItems=[];else if(r.selectedRowIndex!=-1&&i!=-1){var s=u.getRowByIndex(i),e=r.updatedRecords[i],o=n.inArray(e,r.selectedItems);o!=-1&&(s.removeClass("e-gantt-mouseclick"),r.selectedItems.splice(o,1),e.isSelected=!1,r.selectedItem=r.selectedItems.length>0?r.selectedItems[r.selectedItems.length-1]:null,r.selectedRowIndex=r.updatedRecords.indexOf(r.selectedItem))}},appendConnectorLine:function(t){var i=this,r=n.render[i._id+"ConnectorLineTemplate"](t);i._$dependencyViewContainer.append(r)},setCollapsedRecordCount:function(n){this._totalCollapsedRecordCount=n},getCollapsedRecordCount:function(){return this._totalCollapsedRecordCount},removeConnectorline:function(n){this.element.find("#ConnectorLine"+n).remove()},_wireEvents:function(){var i=this,r=jQuery.uaMatch(navigator.userAgent);t.isTouchDevice()?(i._on(i.element,"touchstart",".e-gantt-milestone-container,.e-childContainer",this._mouseHover),i._on(i.element,"touchstart",".e-childContainer,.e-gantt-milestone-container,.e-parentContainer",i._mousedown),n(document.body).bind("touchmove",n.proxy(i.handleMouseMove,i)),i._on(i.element,"touchleave",".e-gantt-milestone-container,.e-childContainer, .e-parentContainer",this._mouseLeave),n(i._$bodyContainer).bind("touchend",n.proxy(i._handleMouseUp,i)),i._on(i.element,"tap",i._cellClickHandler)):(i._on(i.element,"mouseenter",".e-gantt-milestone-container,.e-childContainer,.e-parentContainer,.e-connectorlineContainer",this._mouseHover),i._on(i.element,"mouseleave",".e-gantt-milestone-container,.e-childContainer,.e-parentContainer,.e-connectorlineContainer",this._mouseLeave),i._on(i.element,"click",i._cellClickHandler),i._on(i.element,"mouseenter",".e-taskbarresizer-left",i._resizerleftOver),i._on(i.element,"mouseenter",".e-taskbarresizer-right",i._resizerrightOver),i._on(i.element,"mouseenter",".e-progressbarresizer-right",i._progressresizerOver),i._on(i.element,"mouseenter",".e-connectorpoint-left",i._dragLeftOver),i._on(i.element,"mouseenter",".e-connectorpoint-right",i._dragRightOver),t.browserInfo().name!="msie"?i._on(i.element,"mousedown",".e-parentContainer,.e-childContainer,.e-gantt-milestone-container",i._mousedown):i._on(i.element,"mousedown",".e-parentContainer,.e-childContainer,.e-gantt-milestone-container",i._mousedown),n(i._$bodyContainer).bind("mouseup",n.proxy(i._handleMouseUp,i)),n(document).bind("mouseup",n.proxy(i._tooltipMouseup,i)),i._on(i.element,"mouseenter",".e-stripline",i._stripLineMouseOver),i._on(i.element,"mouseleave",".e-stripline",i._stripLineMouseLeave),r.browser.toLowerCase()=="chrome"&&(i._on(i.element,"touchstart",".e-gantt-milestone-container,.e-childContainer, .e-parentContainer",this._mouseHover),i._on(i.element,"touchstart",".e-childContainer,.e-gantt-milestone-container",i._mousedown),i._on(i.element,"touchleave",".e-gantt-milestone-container,.e-childContainer, .e-parentContainer",this._mouseLeave),n(document.body).bind("touchmove",n.proxy(i.handleMouseMove,i)),i._on(i.element,"touchleave",".e-parentContainer,.e-childContainer,.e-gantt-milestone-container",i._handleMouseUp),n(i._$bodyContainer).bind("touchend",n.proxy(i._handleMouseUp,i)),n(i._$bodyContainer).bind("touchleave",n.proxy(i._handleMouseUp,i)),n(i._$bodyContainer).bind("touchstart",n.proxy(i._updateTouchCtrlFlag,i))));i._enableEditingEvents()},_enableEditingEvents:function(){var n=this,i=n.model;!i.readOnly&&i.editSettings.allowEditing?t.isTouchDevice()?n._on(this.element,"doubletap",".e-ganttviewerbodyContent",n._editdblClickHandler):n._on(this.element,"dblclick",".e-ganttviewerbodyContent",n._editdblClickHandler):t.isTouchDevice()?n._off(this.element,"doubletap",".e-ganttviewerbodyContent",n._editdblClickHandler):n._off(this.element,"dblclick",".e-ganttviewerbodyContent",n._editdblClickHandler)},updateEditSettings:function(n){var i=this;n&&(n.editMode&&(i.model.editSettings.editMode=n.editMode),t.isNullOrUndefined(n.allowAdding)||(i.model.editSettings.allowAdding=n.allowAdding),t.isNullOrUndefined(n.allowEditing)||(i.model.editSettings.allowEditing=n.allowEditing),t.isNullOrUndefined(n.allowDeleting)||(i.model.editSettings.allowDeleting=n.allowDeleting),t.isNullOrUndefined(n.beginEditAction)||(i.model.editSettings.beginEditAction=n.beginEditAction),i._enableEditingEvents())},_editdblClickHandler:function(i){var r=this,o=this.model,f={},s=n(i.target),u,e;if(o.allowGanttChartEditing&&n(s).is(".e-line, .e-connectorline-rightarrow, .e-connectorline-leftarrow")){u=s.parent();n(u).find(".e-line").addClass("e-connectorline-hover");n(u).find(".e-connectorline-rightarrow").length>0?n(u).find(".e-connectorline-rightarrow").addClass("e-connectorline-rightarrow-hover"):n(u).find(".e-connectorline-leftarrow").addClass("e-connectorline-leftarrow-hover");r._hoverConnectorLineElement=u;r._predecessorInfo=r._getPredecessorTooltipData(u);r._renderConnectorDialog(i);return}if(r.model.editSettings.editMode==="normal"&&!o.readOnly&&r.model.editSettings.allowEditing&&!i.ctrlKey){if(f.requestType=t.TreeGrid.Actions.BeginEdit,o.viewType=="resourceView")if(e=r.getRecordByTarget(i),e.eResourceTaskType=="resourceChildTask"||e.eResourceTaskType=="unassignedTask")f.data=e,f.isResourceView=!0;else return!0;r._trigger("actionBegin",f)}},_stripLineMouseLeave:function(){window.clearTimeout(this._tooltipTimer);this._clearTooltip()},_stripLineMouseOver:function(i){i.target.style.cursor="pointer";var r=this,u=r.model,f=n(i.target),c,e,o,l,s=0,h=0;r._clearTooltip();c=f.hasClass("e-striplinespan")?f[0].parentNode:f[0];e=c.id.match(/(\d+|[A-z]+)/g);(i.type=="mouseenter"||i.type=="mousemove")&&(i||(i=window.event),i.originalEvent.pageX||i.originalEvent.pageY?(s=i.originalEvent.pageX,h=i.originalEvent.pageY):(i.originalEvent.clientX||i.originalEvent.clientY)&&(s=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,h=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop),o=t.buildTag("table.e-tooltiptable","",{width:"auto","margin-top":"0px"},{cellspacing:"2px",cellpadding:"2px"}),l=t.buildTag("tbody","<tr><td>"+u.stripLines[e[1]].day+"<\/td><\/tr><tr><td>"+u.stripLines[e[1]].label+"<\/td><\/tr>",{},{}),o.append(l),r._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+r._id+"",o,{position:"absolute","z-index":r._getMaxZIndex()+1},{}),u.cssClass&&r._mouseHoverTooltip.addClass(u.cssClass),setTimeout(function(){n(document.body).append(r._mouseHoverTooltip);r._updateTooltipPosition(r._mouseHoverTooltip,s,h)},700))},_tooltipMouseup:function(){var i=this,f=i.getGanttChartRows();if(i._mouseTarget!=null&&!t.isTouchDevice()){if(i.model.allowGanttChartEditing&&i.model.readOnly==!1&&i._editingTarget&&i._editingItem){var e=i._editingTarget,r=e.closest("tr.e-ganttrowcell"),o=f.index(r),u=i._editingItem;n(r).hasClass("e-editmode")&&(n(r).removeClass("e-editmode"),i._mouseTarget=null);i._getPrevItem(u,o)}i._timerDragHorizontal&&(i._timerDragHorizontal=window.clearInterval(i._timerDragHorizontal));i._timerDragVertical&&(i._timerDragVertical=window.clearInterval(i._timerDragVertical));i._dummyElementRemoved&&(i._connectorDrawElement.remove(),i._dummyElementRemoved=!1,i._connectorDrawElement=null);n(i._$dependencyViewContainer).css("z-index")=="4"&&n(i._$dependencyViewContainer).css("z-index","5");n("#ganttviewerbodyContianer"+i._id).unbind("mousemove");i._trigger("cancelEditCell");i._mouseDown=!1;i._clearTooltip();i._newXYPos=!1;i._$ganttChartContainer[0].style.cursor="auto";i._allowDragging=!1;i._falseLine&&i._falseLine.remove();i._falseLine=null;i._trigger("clearColumnMenu");u&&i.model.enableTaskbarTooltip&&(i._predecessorTooltip&&i._predecessorTooltip.remove(),i._predecessorTooltip=null)}},_clearTooltip:function(){var t=this;t._mouseHoverTooltip&&n(t._mouseHoverTooltip).remove();n(".e-editingtooltip").remove();n("#tooltipgantt").remove();n(".e-progressbartooltip").remove();t._mouseHoverTooltip=null;t._connectorLineTooltip&&n(t._connectorLineTooltip).remove();t._connectorLineTooltip=null},_resizerrightOver:function(n){var t=this,i=n.target,r=i.parentNode;t.model.allowGanttChartEditing==!0&&t.model.readOnly==!1&&(this._mouseDown==!1&&(n.target.style.cursor="w-resize"),t._setEditingElements(r))},_resizerrightLeave:function(){var n=this;n.model.allowGanttChartEditing==!0&&n.model.readOnly==!1&&n._removeEditingElements()},_resizerleftOver:function(n){var t=this,i=n.target,r=i.parentNode;t.model.allowGanttChartEditing==!0&&t.model.readOnly==!1&&(this._mouseDown==!1&&(n.target.style.cursor="e-resize"),t._setEditingElements(r))},_resizerleftLeave:function(){var n=this;n.model.allowGanttChartEditing==!0&&n.model.readOnly==!1&&n._removeEditingElements()},_progressresizerOver:function(t){var i=this,r=t.target,u=r.parentNode;i.model.allowGanttChartEditing==!0&&i.model.readOnly==!1&&(i.model.enableProgressBarResizing?(i._mouseDown==!1&&n(r).prev(".e-gantt-childtaskbar").has(".e-gantt-childtaskbar-progress").length>0&&(r.style.cursor="col-resize"),i._setEditingElements(u)):r.style.cursor="move")},_progressresizerLeave:function(){var n=this;n.model.allowGanttChartEditing==!0&&n.model.readOnly==!1&&n._removeEditingElements()},_secondMouseOverConnectorPoint:function(i,r){var u=this,b,k,y,l,o,f,w;if(u._mouseDown&&u._falseLine||r&&u._falseLine){var s=n(i.target),d=u.getGanttChartRows(),b=s.closest("tr.e-ganttrowcell"),k=d.index(b),y=u.model.currentViewData[k],a=u._editingItem,v=y,e,p,h,c=u.model.predecessorText;if(u._prevItem.predecessorTarget==="Start"?e=a.taskId+"S":u._prevItem.predecessorTarget==="Finish"&&(e=a.taskId+"F"),s.hasClass("e-connectortouchpoint")?s.parent().hasClass("e-connectorpoint-left")?(e+="S",h=c.Start):s.parent().hasClass("e-connectorpoint-right")&&(e+="F",h=c.Finish):s.hasClass("e-connectorpoint-left")?(e+="S",h=c.Start):s.hasClass("e-connectorpoint-right")&&(e+="F",h=c.Finish),t.isNullOrUndefined(y))return;if(u._predecessorTooltip&&(l=u._predecessorTooltip.find("table"),o=l.find("tbody").find("tr:eq(1)").find("td:eq(2)").text(v.taskName),o=l.find("tbody").find("tr:eq(1)").find("td:eq(3)").text(h)),f={},f.requestType="validatePredecessor",f.fromItem=a,f.toItem=v,p=f.toItem.item[u.model.predecessorMapping]?f.toItem.item[u.model.predecessorMapping]+","+e:e,f.predecessor=e,f.currentRecord=v,f.predecessorString=[],f.predecessorString.push(p),w=u._completeAction(f),u._predecessorTooltip&&(o=l.find("tbody").find("tr:eq(0)").find("td:eq(0)"),w?(o.removeClass(),o.addClass("e-predecessor-true")):(o.removeClass(),o.addClass("e-predecessor-false"))),r)return f}},_dragLeftOver:function(t){var i=this,r=t.target,u=r.parentNode;t.type=="touchmove"&&n(t.target).hasClass("e-connectortouchpoint")&&(u=r.parentNode.parentNode);i.model.predecessorMapping&&i.model.allowGanttChartEditing&&i.model.enablePredecessorEditing&&i.model.readOnly==!1&&(this._mouseDown==!1&&(r.style.cursor="pointer"),i._setEditingElements(u));n(u).hasClass("e-parentContainer")||i._secondMouseOverConnectorPoint(t)},_dragLeftLeave:function(){var n=this;n.model.allowGanttChartEditing==!0&&n.model.enablePredecessorEditing&&n.model.readOnly==!1&&n._removeEditingElements()},_dragRightOver:function(t){var i=this,r=t.target,u=r.parentNode;t.type=="touchmove"&&n(t.target).hasClass("e-connectortouchpoint")&&(u=r.parentNode.parentNode);i.model.predecessorMapping&&i.model.allowGanttChartEditing&&i.model.enablePredecessorEditing&&i.model.readOnly==!1&&(this._mouseDown==!1&&(r.style.cursor="pointer"),i._setEditingElements(u));n(u).hasClass("e-parentContainer")||i._secondMouseOverConnectorPoint(t)},_dragRightLeave:function(){var n=this;n.model.allowGanttChartEditing==!0&&n.model.enablePredecessorEditing&&n.model.readOnly==!1&&n._removeEditingElements()},_setEditingElements:function(t){var i=this,r;if(i._editingTarget&&!i._editPredecessor&&n(t).find(i._editingTarget).length==0)return!0;n(t).hasClass("e-childContainer")&&(i._leftResizerGripper=t.querySelector(".e-taskbarresizer-left"),i._rightResizerGripper=t.querySelector(".e-taskbarresizer-right"),r=t.querySelector(".e-progressbarresizer-right"),i._progressHandle=r&&r.firstChild,i._progressHandleChild=r&&r.childNodes[1],n(i._leftResizerGripper).addClass("e-gripper"),n(i._rightResizerGripper).addClass("e-gripper"),i.model.progressMapping&&i.model.enableProgressBarResizing&&(n(i._progressHandle).addClass("e-progresshandle"),n(i._progressHandleChild).addClass("e-progresshandleafter")));i.model.enablePredecessorEditing&&(n(t).hasClass("e-childContainer")&&i.model.predecessorMapping&&!i._falseLine?(i._leftConnectorPoint=t.querySelector(".e-connectorpoint-left"),i._rightConnectorPoint=t.querySelector(".e-connectorpoint-right"),n(i._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(i._rightConnectorPoint).addClass("e-connectorpoint-hover")):n(t).hasClass("e-gantt-milestone-container")&&i.model.predecessorMapping&&!i._falseLine?(i._leftConnectorPoint=t.querySelector(".e-connectorpoint-left"),i._rightConnectorPoint=t.querySelector(".e-connectorpoint-right"),n(i._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(i._rightConnectorPoint).addClass("e-connectorpoint-hover")):n(t).hasClass("e-childContainer")&&i.model.predecessorMapping&&i._falseLine?(i._childLeftConnectorPoint=t.querySelector(".e-connectorpoint-left"),i._childRightConnectorPoint=t.querySelector(".e-connectorpoint-right"),n(i._childLeftConnectorPoint).addClass("e-connectorpoint-hover"),n(i._childRightConnectorPoint).addClass("e-connectorpoint-hover")):n(t).hasClass("e-gantt-milestone-container")&&i.model.predecessorMapping&&i._falseLine?(i._childLeftConnectorPoint=t.querySelector(".e-connectorpoint-left"),i._childRightConnectorPoint=t.querySelector(".e-connectorpoint-right"),n(i._childLeftConnectorPoint).addClass("e-connectorpoint-hover"),n(i._childRightConnectorPoint).addClass("e-connectorpoint-hover")):n(t).hasClass("e-parentContainer")&&i.model.predecessorMapping&&!i._falseLine&&(i._leftConnectorPoint=t.querySelector(".e-connectorpoint-left"),i._rightConnectorPoint=t.querySelector(".e-connectorpoint-right"),n(i._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(i._rightConnectorPoint).addClass("e-connectorpoint-hover"),n(t).hasClass("e-manualparenttaskbar")&&(n(i._leftConnectorPoint).addClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),n(i._rightConnectorPoint).addClass("e-gantt-manualparenttaskbar-connectorpoint-hover"))))},_removeEditingElements:function(){var t=this,i,r;n(t._leftResizerGripper).removeClass("e-gripper");n(t._rightResizerGripper).removeClass("e-gripper");t.model.progressMapping&&(n(t._progressHandle).removeClass("e-progresshandle"),n(t._progressHandleChild).removeClass("e-progresshandleafter"));t.model.enablePredecessorEditing&&(t.model.predecessorMapping&&t._mouseDown==!1&&(n(t._leftConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),n(t._rightConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),t._leftConnectorPoint=null,t._rightConnectorPoint=null),(t.model.predecessorMapping&&t._leftConnectorPoint!==null&&t._mouseDown==!0||t._childLeftConnectorPoint)&&(n(t._childLeftConnectorPoint).removeClass("e-connectorpoint-hover"),n(t._childRightConnectorPoint).removeClass("e-connectorpoint-hover"),t._predecessorTooltip&&(i=t._predecessorTooltip.find("table"),i.find("tbody").find("tr:eq(1)").find("td:eq(2)").text(""),i.find("tbody").find("tr:eq(1)").find("td:eq(3)").text(""),r=i.find("tbody").find("tr:eq(0)").find("td:eq(0)").removeClass(),r.addClass("e-predecessor-false"))))},refreshHeight:function(){var n=this;n._$bodyContainer.ejScroller("refresh")},_mousedown:function(i){var r,a,h,v,p,c,o,s,l;if(i.which==2||i.which==3)return!1;r=this;p={};r._clearTooltip();r._mouseDown=!0;r._currentItemTop=0;var e=n(i.target),w=e.closest("tr.e-ganttrowcell"),f=this.getRecordByTarget(i),u=e[0].parentNode,y=this.model;t.isNullOrUndefined(f)||(i.type=="touchstart"&&(i.preventDefault(),n(".e-connectortouchpoint").addClass("e-enableconnectortouchpoint")),r._editingItem=f,r._editingTarget=e,r._allowExpandCollapse=!0,u=n(u).hasClass("e-progressbarresizer-right")?u.parentNode:n(u).hasClass("e-gantt-childtaskbar-progress")?n(u).closest("div.e-childContainer"):n(u).hasClass("e-progressbarhandler")?e.closest(".e-childContainer")[0]:n(u).closest("div.e-childContainer,div.e-parentContainer,.e-gantt-milestone,div.e-gantt-milestone-container"),(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone")||n(u).hasClass("e-parentContainer")||n(u).hasClass("e-gantt-milestone-container"))&&(n(w).addClass("e-editmode"),r._mouseTarget=i),r.model.allowGanttChartEditing&&r.model.readOnly==!1&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone")||n(u).hasClass("e-gantt-milestone-container")||n(u).hasClass("e-parentContainer"))&&(n(u).is(".e-childContainer,.e-parentContainer,.e-gantt-milestone,.e-gantt-milestone-container")&&n(r._$dependencyViewContainer).css("z-index","4"),(i.target.style.cursor=="e-resize"&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone"))||i.type=="touchstart"&&i.target.className=="e-taskbarresizer-left")&&(r._updateEditingType(),r._leftResizing=!0),(i.target.style.cursor=="w-resize"&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone")||n(u).hasClass("e-parentContainer"))||i.type=="touchstart"&&i.target.className=="e-taskbarresizer-right")&&(r._updateEditingType(),r._rightResizing=!0),c=n(i.target).closest(".e-progressbarresizer-right"),((i.target.style.cursor=="col-resize"||c.length&&c[0].style.cursor=="col-resize")&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone"))||i.type=="touchstart"&&i.target.className=="e-progressbarresizer-right")&&(r._updateEditingType(),r._progressResizing=!0),o=n(i.target).closest("[style*='cursor: move']"),((i.target.style.cursor=="move"||o.length&&o[0].style.cursor=="move")&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone")||n(u).hasClass("e-gantt-milestone-container"))||n(e[0]).hasClass("e-gantt-manualparenttaskbar"))&&(r._updateEditingType(),r._allowDragging=!0),(i.target.style.cursor==""&&(o.length&&o[0].style.cursor==""||o.length==0)&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone")||n(u).hasClass("e-gantt-milestone-container"))||f.isAutoSchedule&&n(e).hasClass("e-gantt-manualparenttaskbar"))&&(r._updateEditingType(),i.target.className=="e-taskbarresizer-left e-icon"||i.target.className=="e-taskbarresizer-left e-icon e-gripper"?r._leftResizing=!0:i.target.className=="e-taskbarresizer-right e-icon"||i.target.className=="e-taskbarresizer-right e-icon e-gripper"?r._rightResizing=!0:i.target.className=="e-progressbarhandler e-progresshandle"||i.target.className=="e-progresshandler-element"||i.target.className=="e-progresshandlerafter-element"||i.target.className=="e-progressbarresizer-right"?r._progressResizing=!0:(i.target.className=="e-gantt-childtaskbar-progress  progressbar"||i.target.className=="e-tasklabel"||i.target.className=="e-gantt-childtaskbar"||i.target.className=="e-gantt-milestone e-milestone-top"||i.target.className=="e-gantt-milestone e-milestone-bottom"||n(i.target).hasClass("e-gantt-milestone")||n(i.target).closest(".e-gantt-milestone").length>0||n(i.target).closest(".e-gantt-childtaskbar").length>0)&&(r._allowDragging=!0)),r.model.enablePredecessorEditing&&(i.target.style.cursor=="pointer"&&(n(u).hasClass("e-childContainer")||n(u).hasClass("e-gantt-milestone")||n(u).hasClass("e-gantt-milestone-container")||n(u).hasClass("e-parentContainer"))||i.type=="touchstart"&&(i.target.className=="e-connectorpoint-right"||i.target.className=="e-connectorpoint-left"||i.target.className=="e-connectorpoint-right e-connectorpoint-hover"||i.target.className=="e-connectorpoint-left e-connectorpoint-hover"))&&(r._updateEditingType(),s={},s.currentRecord=f,s.requestType="drawConnectorLine",r._trigger("actionBegin",s)?r._removeEditingElements():(r._editPredecessor=!0,r._connectorDrawElement=e.closest("tr")),e.hasClass("e-connectorpoint-left")||e.hasClass("e-connectorpoint-left e-connectorpoint-hover")?r._prevItem.predecessorTarget="Start":(e.hasClass("e-connectorpoint-right")||e.hasClass("e-connectorpoint-right e-connectorpoint-hover"))&&(r._prevItem.predecessorTarget="Finish")),i||(i=window.event),t.browserInfo().name=="msie"&&t.browserInfo().version<9&&(i.originalEvent.pageX=i.originalEvent.clientX,i.originalEvent.pageY=i.originalEvent.clientY),i.originalEvent.pageX||i.originalEvent.pageY?(r._posX1=r._resMousePosX=r._currMousePosX=i.originalEvent.pageX,r.dragPosX=i.originalEvent.pageX,r._currMousePosY=r._resMousePosY=i.originalEvent.pageY,r._posY1=r.dragPosY=i.originalEvent.pageY-r._$bodyContainer.offset().top):i.originalEvent.clientX||i.originalEvent.clientY?(r._posX1=r._resMousePosX=r.dragPosX=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r._currMousePosY=r._resMousePosY=i.originalEvent.clientY,r._posY1=r.dragPosY=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop-r._$bodyContainer.offset().top):i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches.length>0&&(r._posX1=r._resMousePosX=r._currMousePosX=i.originalEvent.changedTouches[0].pageX,r.dragPosX=i.originalEvent.changedTouches[0].pageX,r._currMousePosY=r._resMousePosY=i.originalEvent.changedTouches[0].pageY,r._posY1=r.dragPosY=i.originalEvent.changedTouches[0].pageY-r._$bodyContainer.offset().top),r._prevItem.left=f.left,r._prevItem.status=f.status,r._prevItem.duration=f.duration,r._prevItem.startDate=f.startDate,r._prevItem.endDate=f.endDate,r._prevItem.width=f.width,this.model.viewType=="resourceView"&&this.model.allowDragAndDrop&&(a=r._posY1%this.model.rowHeight,h=y.rowHeight,v=(h-y.taskbarHeight)/2,l=r._$bodyContainer.offset().top-n("#ganttViewTablebody"+r._id+"").offset().top,f.top=a>0?r._posY1+l-(r._posY1+l)%h+v:r._posY1,r._prevItem.top=r._currentItemTop=f.top,r._currentItemPrevTop=f.top),f.eResourceTaskType=="resourceChildTask"&&(r._prevItem.eOverlapIndex=f.eOverlapIndex,r._prevItem.eOverlapped=f.eOverlapped,r._prevOverlapOrders=r._getPrevOverlapValues(f)),r._parentCollectionPreviousValues=r._getParentCollectionPreviousValues(f),r.model.enablePredecessorEditing&&(r._connectorPointX=r._currMousePosX-r._$bodyContent.offset().left,r._connectorPointY=r._currMousePosY-r._$bodyContent.offset().top),n(r._$bodyContainer).bind("mousemove",n.proxy(r.handleMouseMove,r))),r._appendTooltip(e,f),r._trigger("clearColumnMenu"))},_getPrevOverlapValues:function(n){var f=[],u=n.parentItem,i=[],t,r;if(u&&u.eResourceChildTasks.length>0)for(i=u.eResourceChildTasks,t=0;t<i.length;t++)r={},r.data=i[t],r.overlapIndex=i[t].eOverlapIndex,f.push(r);return f},_getParentCollectionPreviousValues:function(n){var u=n,r={},f=[],i;do i=u.parentItem,t.isNullOrUndefined(i)||(r.left=i.left,r.status=i.status,r.duration=i.duration,r.startDate=i.startDate,r.endDate=i.endDate,r.width=i.width,r.index=i.index,i.eRangeValues&&(r.eRangeValues=i.eRangeValues.slice()),r.eOverlapIndex=i.eOverlapIndex,r.isAutoSchedule||(r.manualLeft=i.manualLeft,r.manualStartDate=i.manualStartDate,r.manualEndDate=i.manualEndDate,r.manualDuration=i.manualDuration),f.push(r),u=i,r={});while(u.parentItem);return f},handleMouseMove:function(n){this._updateOnmouseMove(n)},taskbarEditedArguments:function(){var n=this;return n._taskbarEditedArgs},taskbarEditedCancel:function(n){var i=n.data,f=n.recordIndex,r=this,u=r.model,t=r._taskbarEditedArgs;i.eResourceTaskType=="resourceChildTask"&&t.previousResource&&t.assignedResource&&t.assignedResource[u.resourceIdMapping]==t.previousResource[u.resourceIdMapping]&&this._updateResourceChildTasks(i);r._getPrevItem(i,f);i.eResourceTaskType=="resourceChildTask"&&r._trigger("taskbarEditedCancel",i);i.parentItem&&r._getParentPreviousValue();r.model.predecessorMapping&&(t.dragging||t.rightResizing||t.leftResizing)&&(t.requestType="updateConnectors",t.ganttRecord=i,r._trigger("actionComplete",t))},_updateTouchCtrlFlag:function(n){var t=this;n.type=="touchstart"&&(t._ganttTouchTrigger=!0)},_getElementByPosition:function(n,t){return document.elementFromPoint(n-window.pageXOffset,t-window.pageYOffset)},_handleMouseUp:function(i){var r=this,u={},d=r.getGanttChartRows(),p,l,y=0,f,g=r._posX1,w=r._posY1,o,h,a,b,v,s,e,k,c;r._timerDragHorizontal&&(r._timerDragHorizontal=window.clearInterval(r._timerDragHorizontal));r._timerDragVertical&&(r._timerDragVertical=window.clearInterval(r._timerDragVertical));r._dummyElementRemoved&&(r._connectorDrawElement.remove(),r._dummyElementRemoved=!1,r._connectorDrawElement=null);t.isNullOrUndefined(i.pageX)?(o=i.originalEvent.changedTouches[0].pageX,h=i.originalEvent.changedTouches[0].pageY,a=i.originalEvent.changedTouches[0].pageY-r._$bodyContainer.offset().top,t.isNullOrUndefined(r._predecessorTooltip)||(i.target=this._getElementByPosition(o,h))):(o=i.pageX,h=i.pageY,a=i.pageY-r._$bodyContainer.offset().top);n(r._$dependencyViewContainer).css("z-index")=="4"&&n(r._$dependencyViewContainer).css("z-index","5");(n(i.target).hasClass("e-connectorpoint-left")||n(i.target).hasClass("e-connectorpoint-right")||n(i.target).hasClass("e-connectortouchpoint"))&&r._falseLine&&!n(i.target).parent().hasClass("e-parentContainer")&&(r._trigger("cancelEditCell"),n(i.target).hasClass("e-connectortouchpoint")&&(i.target=n(i.target).parent()),e=r._secondMouseOverConnectorPoint(i,!0),t.isNullOrUndefined(e)||(u.data=e.currentRecord,u.currentRecord=e.currentRecord,u.fromItem=e.fromItem,u.toItem=e.toItem,u.predecessor=e.predecessor,u.predecessorString=e.predecessorString,u.requestType="validatePredecessor",r._trigger("actionBegin",u)||e.predecessorValidation&&(e.requestType="drawConnectorLine",r._completeAction(e))));u.data&&(s=u.data,r._prevItem.left=s.left,r._prevItem.status=s.status,r._prevItem.duration=s.duration,r._prevItem.startDate=s.startDate,r._prevItem.endDate=s.endDate,r._prevItem.width=s.width);r._editingTarget!=null&&r._editingItem!=null&&(p=r._editingTarget,l=p.closest("tr.e-ganttrowcell"),y=d.index(l),f=r._editingItem,n(l).hasClass("e-editmode")&&(n(l).removeClass("e-editmode"),r._mouseTarget=null));n("#ganttviewerbodyContianer"+r._id).unbind("mousemove");r._mouseDown=!1;r._clearTooltip();g!=o||Math.abs(w-a)>=(this.model.rowHeight-this.model.taskbarHeight)/2?(r._editingTarget=null,r._editingItem=null,r._$ganttChartContainer[0].style.cursor="auto",f!=null&&(r._allowDragging||r._leftResizing||r._rightResizing||r._progressResizing)&&(u.editingFields={startdate:f.startDate,enddate:f.endDate,progress:f.status,duration:f.duration,durationunit:f.durationUnit},u.data=f,u.recordIndex=y,u.previousData=r._prevItem,u.dragging=r._allowDragging,u.leftResizing=r._leftResizing,u.rightResizing=r._rightResizing,u.progressResizing=r._progressResizing,u.roundOffDuration=r._roundOffDuration,this.model.viewType=="resourceView"&&(u.isVerticalDragging=Math.abs(w-a)>=r.model.rowHeight,u.previousResource=f.parentItem?f.parentItem.item:null),r.model.predecessorMapping?(e={},k={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},e.editMode="dragging",e.data=f,e.recordIndex=y,e.requestType="validateLinkedTask",e.validateMode=k,r._taskbarEditedArgs=u,r._trigger("actionBegin",e),e.cancel&&r._taskbarEdited(u)):(r._taskbarEditedArgs=u,r._taskbarEdited(u))),u.cancel&&r.taskbarEditedCancel(u),r._updateEditingType(),r._falseLine&&r._falseLine.remove(),r._falseLine=null,r._predecessorTooltip&&r._predecessorTooltip.remove(),r._predecessorTooltip=null,n(r._leftConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),n(r._rightConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),n(r._childRightConnectorPoint).removeClass("e-connectorpoint-hover"),n(r._childLeftConnectorPoint).removeClass("e-connectorpoint-hover"),r._leftConnectorPoint=null,r._rightConnectorPoint=null,r._childRightConnectorPoint=null,r._childLeftConnectorPoint=null,r._trigger("clearColumnMenu")):(r._newXYPos=!1,r._$ganttChartContainer[0].style.cursor="auto",r._allowDragging=!1,r._falseLine&&r._falseLine.remove(),r._falseLine=null,f&&r.model.enableTaskbarTooltip&&(r._predecessorTooltip&&r._predecessorTooltip.remove(),r._predecessorTooltip=null,b={ttipstartDate:this._getFormatedDate(f.startDate,this.model.dateFormat,this.model.locale),ttipendDate:this._getFormatedDate(f.endDate,this.model.dateFormat,this.model.locale),ttipduration:f.duration,ttipprogress:f.status.toString(),ttiptaskname:f.taskName,ttipdurationunit:f.durationUnit},v=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"5"}),r.model.tooltipTemplate||r.model.tooltipTemplateId?r.model.tooltipTemplate?(r._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+r._id+"","",{position:"absolute","z-index":r._getMaxZIndex()+1,"border-radius":"5px"},{}),r.model.cssClass&&r._mouseHoverTooltip.addClass(r.model.cssClass),r.tooltipState="Template",c=t.buildTag("tbody",n.render[r._id+"tooltipTemplate"](f),{},{}),r._mouseHoverTooltip[0].innerHTML="<table>"+c[0].innerHTML+"<\/table>",r._tooltipTimer=setTimeout(function(){n(document.body).append(r._mouseHoverTooltip);r._updateTooltipPosition(r._mouseHoverTooltip,o,h+20)},300)):r.model.tooltipTemplateId&&(r._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+r._id+"","",{position:"absolute","z-index":r._getMaxZIndex()+1,"border-radius":"5px"},{}),r.model.cssClass&&r._mouseHoverTooltip.addClass(r.model.cssClass),r.tooltipState="TemplateID",c=t.buildTag("tbody",n.render[r._id+"tooltipTemplate"](f),{},{}),r._mouseHoverTooltip[0].innerHTML="<table>"+c[0].innerHTML+"<\/table>",r._tooltipTimer=setTimeout(function(){n(document.body).append(r._mouseHoverTooltip);r._updateTooltipPosition(r._mouseHoverTooltip,o,h+20)},300)):(r.tooltipState="",c=t.buildTag("tbody",n.render[r._id+"tooltipTemplate"](b),{},{}),v.append(c),r._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+r._id+"",v,{position:"absolute","z-index":r._getMaxZIndex()+1,"border-radius":"5px"},{}),r.model.cssClass&&r._mouseHoverTooltip.addClass(r.model.cssClass),r._mouseHoverTooltip.innerHTML="<table>"+v[0].innerHTML+"<\/table>",r._tooltipTimer=setTimeout(function(){n(document.body).append(r._mouseHoverTooltip);r._updateTooltipPosition(r._mouseHoverTooltip,o,h+20)},300)),n(r._mouseHoverTooltip).addClass("e-customTooltip"),r._trigger("clearColumnMenu")));i.type=="touchend"&&n(".e-connectortouchpoint").removeClass("e-enableconnectortouchpoint")},getChildCount:function(n,t){var r,u=this,i;if(!n.hasChildRecords)return 0;for(i=0;i<n.childRecords.length;i++)r=n.childRecords[i],t++,r.hasChildRecords&&(t=u.getChildCount(r,t));return t},criticalDataMapping:function(n,i,r,u){i==!0&&(this.model.isCriticalPathEnable=!0,t.isNullOrUndefined(n)||(this.model.criticalPathCollection=n,this.model.detailPredecessorCollection=r,this.collectionTaskId=u));i==!1&&(this.model.isCriticalPathEnable=!1)},criticalPathColor:function(n,i,r,u){i==!0&&(t.isNullOrUndefined(n)||(this._refresh(),t.isNullOrUndefined(r)||this.criticalConnectorLine(n,r,!0,u)));i==!1&&(this.criticalConnectorLine(n,r,!1,u),this._refresh())},criticalConnectorLine:function(n,t,i,r){var e,u,o,f,s,h;if(i==!1)this.element.find(".e-line").removeClass("e-criticalconnectorline"),this.element.find(".e-connectorline-rightarrow").removeClass("e-criticalconnectorlinerightarrow"),this.element.find(".e-connectorline-leftarrow").removeClass("e-criticalconnectorlineleftarrow");else if(t.length!=0)for(e=0,o=[],s=0;s<this.model.criticalPathCollection.length;s++)if(e=r.indexOf(this.model.criticalPathCollection[s]),u=t[e],e!=-1&&u.to)for(o=u.to.split(","),h=0;h<o.length;h++)f=parseInt(o[h]),n.indexOf(f)!=-1&&(this.element.find("#ConnectorLineparent"+u.taskid+"child"+f).find(".e-line").addClass("e-criticalconnectorline"),this.element.find("#ConnectorLineparent"+u.taskid+"child"+f).find(".e-connectorline-rightarrow").addClass("e-criticalconnectorlinerightarrow"),this.element.find("#ConnectorLineparent"+u.taskid+"child"+f).find(".e-connectorline-leftarrow").addClass("e-criticalconnectorlineleftarrow"))},_getCollapsedParentItem:function(n){var t=n.parentItem;return t?this._getExpandStatus(t)===!0?t:this._getCollapsedParentItem(t):null},updateScrollBar:function(){var n=this,i=n.model,r,u,f,s,e;if(u=n.getExpandedRecords(i.updatedRecords),f=u.indexOf(i.selectedItem),i.selectedItem&&f!=-1){var h=this._getRecordTopPosition(u,f),t=h.top,c=h.bottom,o,l=n._$bodyContainer.children(".e-content").length;o=l?n._$bodyContainer.children(".e-content").scrollTop():n._$bodyContainer.scrollTop();(n._$bodyContainer.ejScroller("isHScroll")||n.element.find(".e-borderbox").length>0)&&(r=18);s=t<o;e=o+n._viewportHeight-r<c;(s||e)&&(t+n._viewportHeight>n._containerHeight&&(t=n._containerHeight-n._viewportHeight,e&&(t+=r)),n._$bodyContainer.ejScroller("scrollY",t,!0),i.enableVirtualization&&n.focusGanttElement())}},getExpandedRecords:function(n){var t=this;return n.filter(function(n){return t._getExpandStatus(n)==!0})},_selectedItemDown:function(){var n=this,i=this.model,r,t,e=i.updatedRecords,f=n.getExpandedRecords(e),u;r=n._prevSelectedItem&&this._getExpandStatusRecord(n._prevSelectedItem)?i.updatedRecords.indexOf(n._prevSelectedItem):0;n._shiftSelectedRecord&&this._getExpandStatusRecord(n._shiftSelectedRecord)?(u=f.indexOf(n._shiftSelectedRecord),t=i.updatedRecords.indexOf(f[u+1])):(u=f.indexOf(i.updatedRecords[r]),t=i.updatedRecords.indexOf(f[u+1]));(t>=i.updatedRecords.length||t==-1)&&(t=i.updatedRecords.length-1);n.updateScrollBar(t);n._multiSelectShiftRequest=!0;n.selectRows(r,t);n._rowSelectedEventTrigger(r,t);n._multiSelectShiftRequest=!1;n._shiftSelectedRecord=i.updatedRecords[t]},_selectedItemUp:function(){var n=this,i=this.model,r,t,e=i.updatedRecords,f=n.getExpandedRecords(e),u;r=n._prevSelectedItem&&this._getExpandStatusRecord(n._prevSelectedItem)?i.updatedRecords.indexOf(n._prevSelectedItem):0;n._shiftSelectedRecord&&this._getExpandStatusRecord(n._shiftSelectedRecord)?(u=f.indexOf(n._shiftSelectedRecord),t=i.updatedRecords.indexOf(f[u-1])):(u=f.indexOf(i.updatedRecords[r]),t=i.updatedRecords.indexOf(f[u-1]));t<0&&(t=0);n.updateScrollBar(t);n._multiSelectShiftRequest=!0;n.selectRows(r,t);n._rowSelectedEventTrigger(r,t);n._multiSelectShiftRequest=!1;n._shiftSelectedRecord=i.updatedRecords[t]},_keyPressed:function(n,t,i,r){var u=this,f=this.model,e,v,s=f.updatedRecords,l=u.getExpandedRecords(s),c;if(r.stopImmediatePropagation(),r.preventDefault(),!f.allowKeyboardNavigation)return!0;switch(n){case"downArrow":s.length>0&&f.selectedItem&&(v=s.length-1,f.selectedRowIndex!=v&&(e=l.indexOf(f.selectedItem),c=l[e+1],e=s.indexOf(c),c&&e<=v&&!u._rowSelectingEventTrigger(f.selectedRowIndex,e)&&(u.selectRows(e),u.focusGanttElement(),u.updateScrollBar(),u._rowSelectedEventTrigger(f.selectedRowIndex))));break;case"upArrow":f.selectedRowIndex!==0&&s.length>0&&f.selectedItem&&(e=l.indexOf(f.selectedItem),c=l[e-1],e=s.indexOf(c),u._rowSelectingEventTrigger(f.selectedRowIndex,e)||(u.selectRows(e),u.focusGanttElement(),u.updateScrollBar(),u._rowSelectedEventTrigger(f.selectedRowIndex)));break;case"firstRowSelection":s.length>0&&(u._rowSelectingEventTrigger(f.selectedRowIndex,0)||(u.selectRows(0),u.focusGanttElement(),u.updateScrollBar(),u._rowSelectedEventTrigger(0)));break;case"lastRowSelection":s.length>0&&(v=l.length-1,c=l[v],e=s.indexOf(c),u._rowSelectingEventTrigger(f.selectedRowIndex,e)||(u.selectRows(e),u.focusGanttElement(),u.updateScrollBar(),u._rowSelectedEventTrigger(e)));break;case"rightArrow":var a=u.model.selectedRowIndex,h=u.model.updatedRecords[a],o={},y;o.data=h;o.recordIndex=a;o.expanded=!0;h&&(u._rowSelectingEventTrigger()||!h.hasChildRecords||h.expanded||(a>=0&&(y=u._trigger("expanding",o)),f.enableVirtualization&&u.focusGanttElement()));break;case"leftArrow":var a=u.model.selectedRowIndex,h=u.model.updatedRecords[a],o={},y;o.data=h;o.recordIndex=a;o.expanded=!1;h&&!u._rowSelectingEventTrigger()&&h.hasChildRecords&&h.expanded&&(a>=0&&u._trigger("collapsing",o),f.enableVirtualization&&u.focusGanttElement());break;case"deleteRecord":f.editSettings.allowDeleting&&f.selectedRowIndex>=0&&(u._trigger("deleteRow"),u.focusGanttElement());break;case"totalRowCollapse":o={};o.requestType="collapseAll";u._trigger("expandAllCollapseAllRequest",o);break;case"totalRowExpand":o={};o.requestType="expandAll";u._trigger("expandAllCollapseAllRequest",o);break;case"shiftDownArrow":f.allowSelection&&f.selectionMode=="row"&&f.selectionType=="multiple"&&u._selectedItemDown();break;case"shiftUpArrow":f.allowSelection&&f.selectionMode=="row"&&f.selectionType=="multiple"&&u._selectedItemUp()}return!0},_rowSelectingEventTrigger:function(n,t){var r=this,u=r.model,i={};if(u.selectionMode=="row")return i.previousIndex=n,i.recordIndex=t,r._trigger("rowSelecting",i)},_rowSelectedEventTrigger:function(n,i){var r=this,u;r.model.selectionMode=="row"&&(u={data:r.model.updatedRecords[n],target:"ejGanttChart",recordIndex:n},t.isNullOrUndefined(i)||(u.toIndex=i),u.selectedItems=r.model.selectedItems,r._trigger("rowSelected",u))},_updateEditingType:function(){var n=this;n._leftResizing=!1;n._allowDragging=!1;n._rightResizing=!1;n._progressResizing=!1;n._editPredecessor=!1},_updateResourceChildTasks:function(n){if(n.parentItem&&this._prevOverlapOrders&&this._prevOverlapOrders.length>0){n.parentItem.eResourceChildTasks=[];for(var t=0;t<this._prevOverlapOrders.length;t++)this._prevOverlapOrders[t].data.eOverlapIndex=this._prevOverlapOrders[t].overlapIndex,n.parentItem.eResourceChildTasks.push(this._prevOverlapOrders[t].data)}},_getPrevItem:function(n,t){var i=this,r;n.left=i._prevItem.left;n.width=i._prevItem.width;n.startDate=i._prevItem.startDate;n.endDate=i._prevItem.endDate;n.duration=i._prevItem.duration;n.status=i._prevItem.status;n.eOverlapIndex=i._prevItem.eOverlapIndex;n.eOverlapped=i._prevItem.eOverlapped;n.progressWidth=this._getProgressWidth(n.width,n.status);this.refreshRow(t);r={};r.index=t;this._refreshRow(r)},_getParentPreviousValue:function(){for(var f,r=this,t,i,e=r.model,n,o=r._parentCollectionPreviousValues.length,u=0;u<o;u++)t=r._parentCollectionPreviousValues[u],i=t.index,n=e.updatedRecords[i],n.left=t.left,n.width=t.width,n.startDate=t.startDate,n.endDate=t.endDate,n.duration=t.duration,n.status=t.status,n.progressWidth=this._getProgressWidth(n.width,n.status),t.eRangeValues&&(n.eRangeValues=t.eRangeValues.slice()),n.eOverlapIndex=t.eOverlapIndex,this.refreshRow(i),f={},f.index=i,this._refreshRow(f)},_enableLeftResizing:function(i,r){var u=this,o=this.model,f=o.scheduleHeaderSettings.scheduleHeaderType,e=t.Gantt.ScheduleHeaderType;i.target.style.cursor="e-resize";n(u._leftResizer).addClass("e-gripper");n(u._rightResizer).addClass("e-gripper");u.dragPosX>u._mousePosX?(u._mousePosX=u.dragPosX-u._mousePosX,r.left>0&&(r.left-=u._mousePosX,r.width+=u._mousePosX)):(u._mousePosX-=u.dragPosX,r.left+30<r.left+r.width&&r.left+u._mousePosX<=this._prevItem.left+this._prevItem.width&&(r.left+=u._mousePosX,r.width-=u._mousePosX));this.dragPosX=t.isNullOrUndefined(i.originalEvent.pageX)?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX;r.width=f==e.Day?r.width<u.model.perHourWidth?u.model.perHourWidth:r.width:f==e.Hour?r.width<u.model.perMinuteWidth?u.model.perMinuteWidth:r.width:r.width<u.model.perDayWidth?u.model.perDayWidth:r.width;r.progressWidth=u._getProgressWidth(r.width,r.status);r.left=this._prevItem.left+this._prevItem.width-r.width;u._setItemPosition(r)},_enableProgressResizing:function(i,r){var u=this,f,e;i.target.style.cursor="col-resize";n(u._leftResizer).addClass("e-gripper");n(u._rightResizer).addClass("e-gripper");u._progressResizer&&(u._progressHandle=u._progressResizer&&u._progressResizer.firstChild,u._progressHandleChild=u._progressResizer&&u._progressResizer.childNodes[1]);u.dragPosX>u._mousePosX?(u._mousePosX=u.dragPosX-u._mousePosX,r.left>0&&(r.progressWidth-=u._mousePosX)):(u._mousePosX-=u.dragPosX,r.progressWidth+=u._mousePosX);this.dragPosX=t.isNullOrUndefined(i.originalEvent.pageX)?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX;r.progressWidth=r.progressWidth>r.width?r.width:r.progressWidth;r.progressWidth=r.progressWidth<0?0:r.progressWidth;f=r.width-r.progressWidth;e=f<=4?4-f:0;n(u._progressbarItem).css({width:r.progressWidth+"px","border-top-right-radius":e+"px","border-bottom-right-radius":e+"px"});n(u._progressResizer).css({left:r.left+r.progressWidth-10+"px"});n(u._progressHandle).addClass("e-progresshandle");n(u._progressHandleChild).addClass("e-progresshandleafter")},_enableRightResizing:function(i,r){var u=this,f=this.model;i.target.style.cursor="w-resize";n(u._leftResizer).addClass("e-gripper");n(u._rightResizer).addClass("e-gripper");u.dragPosX>u._mousePosX?(u._mousePosX=u.dragPosX-u._mousePosX,r.width>0&&(r.width-=u._mousePosX)):(u._mousePosX-=u.dragPosX,r.width+=u._mousePosX);this.dragPosX=t.isNullOrUndefined(i.originalEvent.pageX)?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX;r.width=f.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day?r.width<u.model.perHourWidth?u.model.perHourWidth:r.width:f.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Hour?r.width<u.model.perMinuteWidth?u.model.perMinuteWidth:r.width:r.width<u.model.perDayWidth?u.model.perDayWidth:r.width;r.eResourceTaskType!="resourceChildTask"?(r.hasChildRecords?n(u._manualRightResizer).css({left:r.width-parseInt(u._manualRightResizer.style.borderRightWidth.replace("px",""))+"px"}):(r.progressWidth=u._getProgressWidth(r.width,r.status),n(u._tasknameContainer).css({left:r.left+"px",width:r.width+"px"})),n(u._taskbarItem).css({width:r.width+"px"}),n(u._progressbarItem).css({width:r.progressWidth+"px"}),n(u._rightResizer).css({left:r.left+r.width-u._resizerRightAdjust+"px"}),n(u._progressResizer).css({left:r.left+r.progressWidth-10+"px"}),n(u._leftConnectorPoint).css({left:r.left-u._connectorPointWidth+"px"}),n(u._rightConnectorPoint).css({left:r.left+r.width+"px"})):r.eResourceTaskType=="resourceChildTask"&&(r.progressWidth=u._getProgressWidth(r.width,r.status),n(u._currentEditTaskBar).css({left:r.left+"px",width:r.width+"px"}),n(u._taskbarItem).css({width:r.width+"px"}),n(u._progressbarItem).css({width:r.progressWidth+"px"}),n(u._rightResizer).css({left:r.width-u._resizerRightAdjust+"px"}))},_enableDragging:function(i,r){var u=this,f=this.model,o,e;i.target.style.cursor="move";n(i.target.parentNode).hasClass("e-parentContainer")&&(u._allowExpandCollapse=!1);this.dragPosX>u._mousePosX?(u._mousePosX=u.dragPosX-u._mousePosX,r.left>0&&(r.left-=u._mousePosX)):(u._mousePosX-=u.dragPosX,r.left+=u._mousePosX);this.dragPosX=t.isNullOrUndefined(i.originalEvent.pageX)?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX;this.model.viewType=="resourceView"&&this.model.allowDragAndDrop&&(o=(f.rowHeight-f.taskbarHeight)/2,e=u._$bodyContainer.offset().top,n(u._currentEditTaskBar).css("margin-top",0),this.dragPosY>u._mousePosY?(u._mousePosY=u.dragPosY-u._mousePosY,u._currentItemTop=u._currentItemTop-u._mousePosY):(u._mousePosY-=u.dragPosY,u._currentItemTop=u._currentItemTop+u._mousePosY),this.dragPosY=t.isNullOrUndefined(i.originalEvent.pageY)?i.originalEvent.targetTouches[0].pageY-e:i.originalEvent.pageY-e,r.top=u._currentItemTop%f.rowHeight<=f.taskbarHeight/2&&u._currentItemTop%f.rowHeight>=o?u._currentItemTop:u._currentItemPrevTop,u._currentItemPrevTop=u._currentItemPrevTop==0||r.top==u._currentItemTop?r.top:u._currentItemPrevTop,r.top=r.top<0?0:r.top);r.left=r.left<0?0:r.left;this._setItemPosition(r)},_appendTooltip:function(i,r){var u=this,h,s,l=n(i),o=this.model,e=r,b=u.model.columnHeaderTexts,a=u.model.predecessorEditingTexts,c,v,y,p,w,f;e!=null&&(c=l[0],n(l[0]).hasClass("e-progressbarresizer-right")&&(c=l.closest(".e-childContainer")[0]),(n(c).hasClass("e-parentContainer")||n(c).hasClass("e-childContainer"))&&(u._editingContainer=c,u._leftResizer=u._editingContainer.querySelector(".e-connectorpoint-left"),u._taskbarItem=u._editingContainer.querySelector(".e-taskbarresizer-left"),u._progressbarItem=u._editingContainer.querySelector(".e-gantt-childtaskbar"),u._progressResizer=u._editingContainer.querySelector(".e-gantt-childtaskbar-progress"),u._rightResizer=u._editingContainer.querySelector(".e-progressbarresizer-right")),this.model.enableTaskbarDragTooltip&&!l.hasClass("e-parentContainer")&&(this._progressResizing==!0?(u._$ganttChartContainer[0].style.cursor="col-resize",s=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"2px",cellpadding:"2px"}),f=t.buildTag("tbody","",{},{}),f[0].innerHTML="<tr><td>"+b.status+" : "+e.status+"%<\/td><\/tr>",s.append(f),u.model.progressbarTooltipTemplate?(u._progressBarTooltipID=t.buildTag("div.e-progressbartooltip#progressbartooltip"+u._id+"","",{position:"absolute","z-index":u._getMaxZIndex()+1},{}),u.model.cssClass&&u._progressBarTooltipID.addClass(u.model.cssClass),f=t.buildTag("tbody",n.render[u._id+"progressbarTooltipTemplate"](e),{},{}),u._progressBarTooltipID[0].innerHTML="<table>"+f[0].innerHTML+"<\/table>"):u.model.progressbarTooltipTemplateId?(u._progressBarTooltipID=t.buildTag("div.e-progressbartooltip#progressbartooltip"+u._id+"","",{position:"absolute","z-index":u._getMaxZIndex()+1},{}),u.model.cssClass&&u._progressBarTooltipID.addClass(u.model.cssClass),f=t.buildTag("tbody",n.render[u._id+"progressbarTooltipTemplate"](e),{},{}),u._progressBarTooltipID[0].innerHTML="<table>"+f[0].innerHTML+"<\/table>"):(u._progressBarTooltipID=t.buildTag("div.e-progressbartooltip e-js#progressbartooltip"+u._id+"",s,{position:"absolute","z-index":u._getMaxZIndex()+1},{onselectstart:"return false"}),u.model.cssClass&&u._progressBarTooltipID.addClass(u.model.cssClass)),u._progressBarTooltipID&&(n(document.body).append(u._progressBarTooltipID),u._updateTooltipPosition(u._progressBarTooltipID,u._currMousePosX,u._currMousePosY,!0))):this._editPredecessor===!0&&u.model.enablePredecessorEditing?(v=o.predecessorText,u._predecessorTooltip===null&&(u._predecessorTooltip=t.buildTag("div.e-tooltipganttpredecessor e-js#predecessortooltip"+u._id+"","",{top:u._currMousePosY+10+"px",left:u._currMousePosX+10+"px",position:"absolute","z-index":u._getMaxZIndex()+1},{onselectstart:"return false"}),u.model.cssClass&&u._predecessorTooltip.addClass(u.model.cssClass),s=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"2px",cellpadding:"2px"}),f=t.buildTag("tbody","",{},{}),y="<tr><td class='e-predecessor-false'><\/td><td >"+a.fromText+":<\/td><td class='e-tooltiptaskname'>"+e.taskName+"<\/td><td>"+v[u._prevItem.predecessorTarget]+"<\/td> <\/tr><tr><td><\/td><td>"+a.toText+":<\/td><td class='e-tooltiptaskname'><\/td><td><\/td><\/tr>",n(f).html(y),s.append(f),u._predecessorTooltip.append(s),n(document.body).append(u._predecessorTooltip),u._updateTooltipPosition(u._predecessorTooltip,u._currMousePosX,u._currMousePosY))):(u._leftResizing==!0||u._rightResizing==!0||u._allowDragging==!0)&&(u._leftResizing==!0?(u._$ganttChartContainer[0].style.cursor="e-resize",h={ttipstartDate:this._getFormatedDate(e.startDate,o.dateFormat,o.locale),ttipduration:e.duration,ttipdurationunit:e.durationUnit}):u._rightResizing==!0?(u._$ganttChartContainer[0].style.cursor="w-resize",h={ttipendDate:this._getFormatedDate(e.endDate,o.dateFormat,o.locale),ttipduration:e.duration,ttipdurationunit:e.durationUnit}):u._allowDragging==!0&&(u._$ganttChartContainer[0].style.cursor="move",p=o.ganttInstance._getValidStartDate(e),w=o.ganttInstance._getValidEndDate(e),h={ttipstartDate:this._getFormatedDate(p,o.dateFormat,o.locale),ttipendDate:this._getFormatedDate(w,o.dateFormat,o.locale)}),s=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"2px",cellpadding:"2px"}),u.model.taskbarEditingTooltipTemplate?(u._taskbarEditingTooltipID=t.buildTag("div.e-editingtooltip e-js#editingtooltip"+u._id+"","",{position:"absolute","z-index":u._getMaxZIndex()+1},{}),u.model.cssClass&&u._taskbarEditingTooltipID.addClass(u.model.cssClass),u.tooltipState="editingTemplateID",f=t.buildTag("tbody",n.render[u._id+"editingTooltipTemplate"](e),{},{}),u._taskbarEditingTooltipID[0].innerHTML="<table>"+f[0].innerHTML+"<\/table>"):u.model.taskbarEditingTooltipTemplateId?(u._taskbarEditingTooltipID=t.buildTag("div.e-editingtooltip e-js#editingtooltip"+u._id+"","",{position:"absolute","z-index":u._getMaxZIndex()+1},{}),u.model.cssClass&&u._taskbarEditingTooltipID.addClass(u.model.cssClass),u.tooltipState="editingTemplate",f=t.buildTag("tbody",n.render[u._id+"editingTooltipTemplate"](e),{},{}),u._taskbarEditingTooltipID[0].innerHTML="<table>"+f[0].innerHTML+"<\/table>"):(u.tooltipState="",h&&(f=t.buildTag("tbody",n.render[u._id+"editingTooltipTemplate"](h),{},{}),s.append(f)),u._taskbarEditingTooltipID=t.buildTag("div.e-editingtooltip e-js#editingtooltip"+u._id+"",s,{position:"absolute","z-index":u._getMaxZIndex()+1},{}),u.model.cssClass&&u._taskbarEditingTooltipID.addClass(u.model.cssClass)),u._taskbarEditingTooltipID&&(n(document.body).append(u._taskbarEditingTooltipID),this.model.viewType=="resourceView"&this.model.allowDragAndDrop?u._updateTooltipPosition(u._taskbarEditingTooltipID,u._resMousePosX,u._resMousePosY,!0):u._updateTooltipPosition(u._taskbarEditingTooltipID,u._currMousePosX,u._currMousePosY,!0)))))},_setItemPosition:function(t){var i=this;t.eResourceTaskType!="resourceChildTask"&&t.eResourceTaskType!="unassignedTask"?(n(i._leftResizer).css({left:t.left+2+"px"}),n(i._rightResizer).css({left:t.left+t.width-i._resizerRightAdjust+"px"}),n(i._taskbarItem).css({left:t.left+"px",width:t.width+"px"}),n(i._progressbarItem).css({width:t.progressWidth+"px"}),n(i._progressResizer).css({left:t.left+t.progressWidth-10+"px"}),n(i._tasknameContainer).css({left:t.left+"px",width:t.width+"px"}),n(i._leftConnectorPoint).css({left:t.left-i._connectorPointWidth+"px"}),n(i._rightConnectorPoint).css({left:t.left+t.width+"px"})):(t.eResourceTaskType=="resourceChildTask"||t.eResourceTaskType=="unassignedTask")&&(i._allowDragging&&this.model.allowDragAndDrop?(n(i._leftResizer).css({left:"2px"}),n(i._rightResizer).css({left:t.width-i._resizerRightAdjust+"px"}),n(i._currentEditTaskBar).css({left:t.left+"px",width:t.width+"px",top:t.top+"px"})):(n(i._leftResizer).css({left:"2px"}),n(i._rightResizer).css({left:t.width-i._resizerRightAdjust+"px"}),n(i._progressbarItem).css({width:t.progressWidth+"px"}),n(i._currentEditTaskBar).css({left:t.left+"px",width:t.width+"px"}),n(i._taskbarItem).css({width:t.width+"px"})))},_updateOnmouseMove:function(r){var u=this,o={},a,l=u._editingTarget?u._editingTarget:null,g=l?l.closest("tr.e-ganttrowcell"):null,f=u._editingItem,e=l?l[0].parentNode:null,nt,st,k,d;if(u._newXYPos=!0,e=n(e).hasClass("e-progressbarresizer-right")?e.parentNode:n(e).hasClass("e-gantt-childtaskbar-progress")?n(e).closest("div.e-childContainer")[0]:n(e).hasClass("e-progressbarhandler")?l.closest(".e-childContainer")[0]:n(e).closest("div.e-childContainer,div.e-parentContainer,.e-gantt-milestone,div.e-gantt-milestone-container")[0],u._currentEditTaskBar=e,f!=null&&(u._trigger("cancelEditCell"),n(u._currentEditTaskBar).css("z-index",1),o.editingFields={startdate:f.startDate,enddate:f.endDate,progress:f.status,duration:f.duration,durationunit:f.durationUnit},o.rowData=f,o.roundOffDuration=!1,o.dragging=u._allowDragging,o.leftResizing=u._leftResizing,o.rightResizing=u._rightResizing,o.progressResizing=u._progressResizing,this.model.viewType=="resourceView"&&(nt=t.isNullOrUndefined(r.pageY)?r.originalEvent.changedTouches[0].pageY-n("#ganttViewTablebody"+u._id+"").offset().top:r.pageY-n("#ganttViewTablebody"+u._id+"").offset().top,o.isVerticalDragging=Math.abs(u._posY1-nt)>=u.model.rowHeight),u._taskbarEditing(o),u._roundOffDuration=o.roundOffDuration,!o.cancel)){if(r||(r=window.event),t.browserInfo().name=="msie"&&t.browserInfo().version<9&&(r.originalEvent.pageX=r.originalEvent.clientX,r.originalEvent.pageY=r.originalEvent.clientY),r.originalEvent.pageX||r.originalEvent.pageY?(u._resMousePosX=u._mousePosX=r.originalEvent.pageX,u._resMousePosY=r.originalEvent.pageY,u._posX=r.originalEvent.pageX,u._posY=r.originalEvent.pageY,u._mousePosY=r.originalEvent.pageY-u._$bodyContainer.offset().top):r.originalEvent.clientX||r.originalEvent.clientY?(u._resMousePosX=u._mousePosX=r.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,u._resMousePosY=r.originalEvent.clientY,u._posX=r.originalEvent.clientX,u._posY=r.originalEvent.clientY,u._mousePosY=r.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop-u._$bodyContainer.offset().top):(r.originalEvent.touches[0].pageX||r.originalEvent.touches[0].pageY)&&(u._resMousePosX=u._mousePosX=r.originalEvent.targetTouches[0].pageX,u._posX=r.originalEvent.targetTouches[0].pageX,u._posY=r.originalEvent.targetTouches[0].pageY,u._resMousePosY=r.originalEvent.targetTouches[0].pageY,u._mousePosY=r.originalEvent.targetTouches[0].pageY-u._$bodyContainer.offset().top),l.hasClass("e-gantt-milestone")||n(e).hasClass("e-gantt-milestone"))n(g).hasClass("e-editmode")&&this._editMilestone(r);else if(n(e).hasClass("e-childContainer")?(u._editingContainer=e,u._leftResizer=u._editingContainer.querySelector(".e-taskbarresizer-left"),u._taskbarItem=u._editingContainer.querySelector(".e-gantt-childtaskbar"),u._progressbarItem=u._editingContainer.querySelector(".e-gantt-childtaskbar-progress"),u._progressResizer=u._editingContainer.querySelector(".e-progressbarresizer-right"),u._rightResizer=u._editingContainer.querySelector(".e-taskbarresizer-right"),u.model.predecessorMapping&&u.model.enablePredecessorEditing&&(u._leftConnectorPoint=e.querySelector(".e-connectorpoint-left"),u._rightConnectorPoint=e.querySelector(".e-connectorpoint-right"),u.model.allowGanttChartEditing&&(n(u._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(u._rightConnectorPoint).addClass("e-connectorpoint-hover")))):n(e).hasClass("e-parentContainer")&&!f.isAutoSchedule&&(u._editingContainer=e,u._taskbarItem=u._editingContainer.querySelector(".e-gantt-manualparenttaskbar"),u._rightResizer=u._editingContainer.querySelector(".e-taskbarresizer-right"),u._manualRightResizer=u._editingContainer.querySelector(".e-gantt-manualparenttaskbar-right")),n(g).hasClass("e-editmode")&&(n(l[0]).closest("e-gantt-manualparenttaskbar")||n(e).hasClass("e-gantt-milestone-container")||n(e).hasClass("e-childContainer")))if(u._leftResizing==!0)u._enableLeftResizing(r,f),u._updateEditedItem(f,"leftResizing");else if(u._progressResizing==!0&&u.model.enableProgressBarResizing&&u.model.progressMapping)(u._editingTarget.hasClass("e-progresshandlerafter-element")||u._editingTarget.hasClass("e-progressbarhandler e-progresshandle")||u._editingTarget.hasClass("e-progresshandler-element")||u._editingTarget.hasClass("e-progressbarresizer-right"))&&u._editingTarget.prev(".e-gantt-childtaskbar").find(".e-tasklabel").text(""),u._enableProgressResizing(r,f),u._updateEditedItem(f,"progressResizing");else if(u._rightResizing==!0)u._enableRightResizing(r,f),u._updateEditedItem(f,"rightResizing");else if(u._allowDragging==!0)u._enableDragging(r,f),u._updateEditedItem(f,"dragging");else if(u._editPredecessor==!0){u._drawFalseLine(r,f);var tt=u._getOffsetRect(n("#"+u._id)[0]),it=Math.round(u.element.height()),rt=Math.round(u.element.width()),y=tt.top,p=tt.left,ht=u._$headerContainer.height()+y,a=u._posY,v=u._posX,h,c,vt=u._id.replace("ejGanttChart",""),s=u.element.find(".e-ganttviewerbodyContianer"),ct=s.ejScroller("instance")._vScrollbar,lt=s.ejScroller("isVScroll"),w=lt?s.find(".e-content").get(0).scrollHeight-1:0,ut=s.ejScroller("isHScroll")?it+y-u.model.rowHeight/2-18:it+y-u.model.rowHeight/2,ft=ht+u.model.rowHeight/2,at=s.ejScroller("isHScroll"),b=at?s.find(".e-content").get(0).scrollWidth:0,et=s.ejScroller("isVScroll")?rt+p-38:rt+p-20,ot=p+20;a>ut||a<ft&&u._scrollTop!=0?u._timerDragVertical||(u.model.enableVirtualization&&u._connectorDrawElement&&(u._dummyElementRemoved=!0,st=u._connectorDrawElement.clone(),u._connectorDrawElement.before(st),u._connectorDrawElement.hide(),n(u._$bodyContainer).append(u._connectorDrawElement)),u._timerDragVertical=window.setInterval(function(){a>ut&&w>u._scrollTop?(h=u._scrollTop+20,h=h>w?w:h,ct.model.maximum>u._scrollTop&&s.ejScroller("scrollY",h,!0),u._drawFalseLine(r)):a<ft&&u._scrollTop>0&&(h=u._scrollTop-20,h=h<0?0:h,s.ejScroller("scrollY",h,!0),u._drawFalseLine(r))},100)):u._timerDragVertical&&(u._timerDragVertical=window.clearInterval(u._timerDragVertical));v>et||v<ot&&u._scrollLeft!=0?u._timerDragHorizontal||(u._timerDragHorizontal=window.setInterval(function(){u._timerDragVertical||(v>et&&b>u._scrollLeft?u._timerDragHorizontal!=i&&(c=u._scrollLeft+20,c=c>b?b:c,s.ejScroller("scrollX",c,!0),u._drawFalseLine(r)):v<ot&&u._scrollLeft>0&&u._timerDragHorizontal!=i&&(c=u._scrollLeft-20,c=c<0?0:c,s.ejScroller("scrollX",c,!0),u._drawFalseLine(r)))},100)):u._timerDragHorizontal&&(u._timerDragHorizontal=window.clearInterval(u._timerDragHorizontal))}u._clearTooltip();u._appendTooltip(l,f)}t.isNullOrUndefined(r.pageX)&&r.type=="touchmove"&&u._predecessorTooltip&&(t.isNullOrUndefined(r.pageX)?(k=r.originalEvent.changedTouches[0].pageX,d=r.originalEvent.changedTouches[0].pageY,r.target=this._getElementByPosition(k,d)):(k=r.pageX,d=r.pageY),n(r.target).hasClass("e-connectorpoint-left")||n(r.target).hasClass("e-connectortouchpoint")?u._dragLeftOver(r):n(r.target).hasClass("e-connectorpoint-right")?u._dragRightOver(r):(u._mouseLeave(),n(u._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(u._rightConnectorPoint).addClass("e-connectorpoint-hover")))},_editMilestone:function(i){var r=this,f=r._editingTarget,o=f.hasClass("e-milestone-top")||f.hasClass("e-milestone-bottom")?f[0].parentNode:f.closest(".e-gantt-milestone"),s=r.getGanttChartRows(),h=f.closest("tr.e-ganttrowcell"),u=r._editingItem,e;u!=null&&(i||(i=window.event),i.originalEvent.pageX||i.originalEvent.pageY?r._mousePosX=i.originalEvent.pageX:i.originalEvent.clientX||i.originalEvent.clientY?r._mousePosX=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft:(i.originalEvent.touches[0].pageX||i.originalEvent.touches[0].pageY)&&(r._mousePosX=i.originalEvent.targetTouches[0].pageX),i.target.style.cursor="move",r.dragPosX>r._mousePosX?(r._mousePosX=r.dragPosX-r._mousePosX,u.left>0&&(u.left-=r._mousePosX)):(r._mousePosX-=r.dragPosX,u.left+=r._mousePosX),this.dragPosX=t.isNullOrUndefined(i.originalEvent.pageX)?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX,u.left=u.left<0?0:u.left,e=Math.floor(this.model.taskbarHeight/2),n(o).css({left:u.left-e+"px"}),n(r._leftConnectorPoint).css({left:u.left-r._connectorPointWidth-e+"px"}),n(r._rightConnectorPoint).css({left:u.left+r._milesStoneWidth-e+"px"}),r._updateEditedItem(u,"dragging"),r._appendTooltip(f,u))},_updateEditedItem:function(n,i){var s=this,r=s.model,f=n._getFormatedDate(r.projectStartDate,r.dateFormat,r.locale),f=n._getDateFromFormat(f,r.dateFormat,r.locale),h,e,o,u=this.model.ganttInstance,c,l;switch(i){case"dragging":o=u._getRoundOffStartLeft(n,s._roundOffDuration);f=this.model.ganttInstance._getDateByLeft(o);!t.isNullOrUndefined(n.endDate)&&t.isNullOrUndefined(n.startDate)?(e=u._checkStartDate(f,n,null),n.endDate=u._checkEndDate(e,n)):(n.startDate=u._checkStartDate(f,n,null),t.isNullOrUndefined(n.duration)||n._calculateEndDate(u));r.startDateMapping&&(n.item[r.startDateMapping]=n.startDate);r.endDateMapping&&(n.item[r.endDateMapping]=n.endDate);break;case"leftResizing":c="Resizing";o=u._getRoundOffStartLeft(n,s._roundOffDuration);f=u._getDateByLeft(o);t.isNullOrUndefined(n.endDate)&&(e=u._getValidEndDate(n),n.endDate=e,r.endDateMapping&&(n.item[r.endDateMapping]=n.endDateMapping));h=u._checkStartDate(f,n,null);n.startDate=new Date(h);u._compareDates(n.startDate,n.endDate)==0&&t.isNullOrUndefined(n.isMilestone)&&n.isMilestone==!1&&n.duration==0&&(n.duration=1);n._calculateDuration(u);r.startDateMapping&&(n.item[r.startDateMapping]=n.startDate);break;case"rightResizing":c="Resizing";o=this.model.ganttInstance._getRoundOffEndLeft(n,s._roundOffDuration);l=this.model.ganttInstance._getDateByLeft(o);t.isNullOrUndefined(n.startDate)&&(h=u._getValidStartDate(n),n.startDate=h,r.startDateMapping&&(n.item[r.startDateMapping]=n.startDateMapping));e=this.model.ganttInstance._checkEndDate(l,n);n.endDate=new Date(e);n._calculateDuration(u);r.endDateMapping&&(n.item[r.endDateMapping]=n.endDate);break;case"progressResizing":n.status=s._getProgressPercent(n.width,n.progressWidth);r.progressMapping&&(n.item[r.progressMapping]=n.status)}},_drawFalseLine:function(n){var i=this,s=n.pageX,h=n.pageY,c=i._posX,l=i._posY,e=i._connectorPointX,o=i._connectorPointY,r,u;t.isNullOrUndefined(n.pageX)?(r=n.originalEvent.changedTouches[0].pageX-i._$bodyContent.offset().left,u=n.originalEvent.changedTouches[0].pageY-i._$bodyContent.offset().top,s=Math.round(n.originalEvent.changedTouches[0].pageX),h=Math.round(n.originalEvent.changedTouches[0].pageY)):(r=n.pageX-i._$bodyContent.offset().left,u=n.pageY-i._$bodyContent.offset().top);t.isNullOrUndefined(i._timerDragHorizontal||i._timerDragVertical)||(r=c-i._$bodyContent.offset().left,u=l-i._$bodyContent.offset().top);var a=Math.sqrt((e-r)*(e-r)+(o-u)*(o-u)),v=Math.atan2(u-o,r-e)*180/Math.PI,f="rotate("+v+"deg)";i._falseLine&&i._falseLine.remove();i._falseLine=t.buildTag("div.e-gantt-falseLine#ganttfalseline"+i._id,"",{},{});i._falseLine.css({"transform-origin":"0% 100%",right:"auto",position:"absolute",transform:f,"-ms-transform":f,"-moz-transform":f,"-webkit-transform":f,"-o-transform":f,"border-top-width":"2px","border-top-style":"dashed","z-index":"5"}).width(a-3).offset({left:e,top:o});t.browserInfo().name=="msie"&&t.browserInfo().version<9||i._$bodyContent.append(i._falseLine);t.isNullOrUndefined(i._timerDragHorizontal||i._timerDragVertical)?i._updateTooltipPosition(i._predecessorTooltip,s,h):i._updateTooltipPosition(i._predecessorTooltip,c,l)},_mouseLeave:function(){var i=this;n(".e-progressbarresizer-right").css({"background-image":"none"});window.clearTimeout(i._tooltipTimer);i._clearTooltip();this._mouseDown==!1&&i._newXYPos?(n(i._leftResizerGripper).removeClass("e-gripper"),n(i._rightResizerGripper).removeClass("e-gripper"),i.model.progressMapping&&(n(i._progressHandle).removeClass("e-progresshandle"),n(i._progressHandleChild).removeClass("e-progresshandleafter")),i.model.predecessorMapping&&i.model.enablePredecessorEditing&&(n(i._leftConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),n(i._rightConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),i._leftConnectorPoint=null,i._rightConnectorPoint=null)):i._mouseDown&&i._falseLine&&i.model.allowGanttChartEditing==!0&&i.model.enablePredecessorEditing&&i.model.readOnly==!1&&i._removeEditingElements();i._mouseDown==!1&&n(i._$dependencyViewContainer).css("z-index")=="4"&&n(i._$dependencyViewContainer).css("z-index","5");t.isNullOrUndefined(i._hoverConnectorLineElement)||i._isPredecessorEditOpen||i._clearConnectorLineSelection()},_getMaxZIndex:function(){var u=document.getElementsByTagName("div"),i=0,f=u.length,n,r,t;if(this._maxZIndex==0){for(n=0;n<f;n++)r=u[n].style.zIndex,t=parseInt(r),t>i&&r!="auto"&&!isNaN(t)&&(i=t);this._maxZIndex=i}return this._maxZIndex},_getOffsetRect:function(n){var r=n.getBoundingClientRect(),t=document.body,i=document.documentElement,u=window.pageYOffset||i.scrollTop||t.scrollTop,f=window.pageXOffset||i.scrollLeft||t.scrollLeft,e=i.clientTop||t.clientTop||0,o=i.clientLeft||t.clientLeft||0,s=r.top+u-e,h=r.left+f-o;return{top:Math.round(s),left:Math.round(h)}},_updateTooltipPosition:function(t,i,r,u){var s;if(t&&t.length>0){var e=this,h=e._getOffsetRect(e._$bodyContainer[0]),c=h.top+e._$bodyContainer.height(),l=h.left+e._$bodyContainer.width(),o=e.model.rowHeight,f=0;i+t.width()+30>l?(f=i-t.width()-30,t.css("left",f+"px")):u?t.css("left",i+"px"):t.css("left",i+15+"px");u||r+t.height()+30>c?(f=u?r-t.height()-o:r-t.height()-30,s=n(window).scrollTop(),f<s&&(f=s),u&&f+t.height()+o>r&&(f=r+o/2),t.css("top",f+"px")):t.css("top",r+10+"px")}},getRecordByTarget:function(t,i){var u=n(t.target),o=this.getGanttChartRows(),f=u.closest("tr.e-ganttrowcell"),s=o.index(f),r=this.model.currentViewData[s],e;return this.model.viewType=="histogramView"&&f.length!=0&&r.workTimelineRanges.length!=0?(e=f.find(".e-gantthistobar").index(u.closest(".e-gantthistobar")),r=r.workTimelineRanges[e]):r&&r.eResourceTaskType=="resourceTask"&&this.model.viewType=="resourceView"&&u.closest(".e-childContainer").length==1&&(e=f.find(".e-childContainer").index(u.closest(".e-childContainer")),r=r.eResourceChildTasks[e],i&&(this.element.find(".e-gantt-taskbarSelection").removeClass("e-gantt-taskbarSelection"),u.closest(".e-childContainer").addClass("e-gantt-taskbarSelection"))),r},_getPredecessorTooltipData:function(t){var h=this,r=h.model,c=n(t).parent()[0].id,f=c.match(/\d+/g),e=r.flatRecords[r.ids.indexOf(f[0])],o=r.flatRecords[r.ids.indexOf(f[1])],l=e.predecessor,s,i,u;return i=l.filter(function(n){return n.to==f[1]}),s=r.predecessorCollectionText.filter(function(n){return n.id==i[0].predecessorsType}),u={linkType:i[0].predecessorsType,linkText:s[0].text,offset:i[0].offset,offsetUnit:i[0].offsetDurationUnit,fromId:i[0].from,toId:i[0].to,fromName:e.taskName,toName:o.taskName},r.enableSerialNumber&&(u.fromSno=e.serialNumber,u.toSno=o.serialNumber),u},_mouseHover:function(i){var e=n(i.target),r=this,w=r.model,s=0,h=0,f=e[0].parentNode,a,u=this.getRecordByTarget(i),y,c,v,p,l,o;if(i.target.className=="e-parentContainer"||i.target.className=="e-gantt-milestone-container"||i.target.className=="e-childContainer")return!0;f=n(f).hasClass("e-gantt-childtaskbar-progress")?n(f).closest("div.e-childContainer")[0]:e.hasClass("e-tasklabel")?e.closest(".e-childContainer")[0]:f.className=="e-connectorlineContainer"?f:n(f).closest("div.e-childContainer,div.e-parentContainer,.e-gantt-milestone,div.e-gantt-milestone-container")[0];n(f).is(".e-childContainer,.e-parentContainer,.e-gantt-milestone,.e-gantt-milestone-container")&&n(r._$dependencyViewContainer).css("z-index","4");r._clearTooltip();r._newXYPos||(r._newXYPos=!0,r._mouseLeave());r._rightResizing==!1&&r._leftResizing==!1&&r._progressResizing==!1&&r._mouseDown==!1&&(r.model.allowGanttChartEditing&&r.model.readOnly==!1&&(e.is(".e-gantt-childtaskbar,.e-tasklabel, .e-gantt-manualparenttaskbar")||e.closest(".e-gantt-childtaskbar").length)&&(i.target.style.cursor="move"),(i.type=="mouseenter"||i.type=="mousemove"||i.type=="touchstart")&&(i||(i=window.event),t.browserInfo().name=="msie"&&t.browserInfo().version<9&&(i.originalEvent.pageX=i.originalEvent.clientX,i.originalEvent.pageY=i.originalEvent.clientY),i.originalEvent.pageX||i.originalEvent.pageY?(s=i.originalEvent.pageX,h=i.originalEvent.pageY):i.originalEvent.clientX||i.originalEvent.clientY?(s=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,h=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop):i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches.length>0&&(s=i.originalEvent.changedTouches[0].pageX,h=i.originalEvent.changedTouches[0].pageY),r._posX1=s,r._posY1=h,n(f).hasClass("e-childContainer")&&r.model.allowGanttChartEditing&&r.model.readOnly==!1&&(r._leftResizerGripper=f.querySelector(".e-taskbarresizer-left"),r._rightResizerGripper=f.querySelector(".e-taskbarresizer-right"),a=f.querySelector(".e-progressbarresizer-right"),r._progressHandle=a&&a.firstChild,r._progressHandleChild=a&&a.childNodes[1],n(r._leftResizerGripper).addClass("e-gripper"),n(r._rightResizerGripper).addClass("e-gripper"),r.model.progressMapping&&r.model.enableProgressBarResizing&&(n(r._progressHandle).addClass("e-progresshandle"),n(r._progressHandleChild).addClass("e-progresshandleafter"))),(n(f).hasClass("e-childContainer")||n(f).hasClass("e-parentContainer"))&&r.model.predecessorMapping&&r.model.allowGanttChartEditing&&r.model.enablePredecessorEditing&&r.model.readOnly==!1?(r._leftConnectorPoint=f.querySelector(".e-connectorpoint-left"),r._rightConnectorPoint=f.querySelector(".e-connectorpoint-right"),n(r._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(r._rightConnectorPoint).addClass("e-connectorpoint-hover"),n(f).hasClass("e-parentContainer")&&!u.isAutoSchedule&&(n(r._leftConnectorPoint).addClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),n(r._rightConnectorPoint).addClass("e-gantt-manualparenttaskbar-connectorpoint-hover"))):(n(f).hasClass("e-gantt-milestone")||n(f).hasClass("e-gantt-milestone-container"))&&r.model.predecessorMapping&&r.model.allowGanttChartEditing&&r.model.enablePredecessorEditing&&r.model.readOnly==!1&&(p=f.parentNode,r._leftConnectorPoint=p.querySelector(".e-connectorpoint-left"),r._rightConnectorPoint=p.querySelector(".e-connectorpoint-right"),n(r._leftConnectorPoint).addClass("e-connectorpoint-hover"),n(r._rightConnectorPoint).addClass("e-connectorpoint-hover")),u&&r.model.enableTaskbarTooltip&&!t.isTouchDevice()&&!n(e).hasClass("e-connectorpoint-hover")?(r._predecessorTooltip&&r._predecessorTooltip.remove(),r._predecessorTooltip=null,y=(n(e).hasClass("e-gantt-parenttaskbar-innerdiv")||n(e[0].parentNode).hasClass("e-gantt-parenttaskbar-innerdiv"))&&!u.isAutoSchedule?{ttipscheduleStartDate:this._getFormatedDate(u.manualStartDate,this.model.dateFormat,this.model.locale),ttipscheduleEndDate:this._getFormatedDate(u.manualEndDate,this.model.dateFormat,this.model.locale),ttipduration:u.manualDuration,ttipprogress:u.status.toString(),ttiptaskname:u.taskName,ttipdurationunit:u.durationUnit}:n(e).hasClass("e-gantt-manualparenttaskbar")||n(e).hasClass("e-gantt-manualparenttaskbar-left")||n(e).hasClass("e-gantt-manualparenttaskbar-right")&&!u.isAutoSchedule?{ttipstartDate:this._getFormatedDate(u.startDate,this.model.dateFormat,this.model.locale),ttipsubtaskStartDate:this._getFormatedDate(u.manualStartDate,this.model.dateFormat,this.model.locale),ttipendDate:this._getFormatedDate(u.endDate,this.model.dateFormat,this.model.locale),ttipsubtaskEndDate:this._getFormatedDate(u.manualEndDate,this.model.dateFormat,this.model.locale),ttipduration:u.duration,ttiptaskname:u.taskName,ttipdurationunit:u.durationUnit}:{ttipstartDate:this._getFormatedDate(u.startDate,this.model.dateFormat,this.model.locale),ttipendDate:this._getFormatedDate(u.endDate,this.model.dateFormat,this.model.locale),ttipduration:u.duration,ttipprogress:u.status.toString(),ttiptaskname:u.taskName,ttipdurationunit:u.durationUnit}):!w.allowGanttChartEditing||t.isNullOrUndefined(f)||f.className!="e-connectorlineContainer"||r._isPredecessorEditOpen||(l=f,n(l).find(".e-line").addClass("e-connectorline-hover"),n(l).find(".e-connectorline-rightarrow").length>0?n(l).find(".e-connectorline-rightarrow").addClass("e-connectorline-rightarrow-hover"):n(l).find(".e-connectorline-leftarrow").addClass("e-connectorline-leftarrow-hover"),r._hoverConnectorLineElement=l,v=r._getPredecessorTooltipData(l)),y&&(c=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"5"}),r.model.tooltipTemplate||r.model.tooltipTemplateId?r.model.tooltipTemplate?(r._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+r._id+"","",{position:"absolute","z-index":r._getMaxZIndex()+1,"border-radius":"5px"},{}),r.model.cssClass&&r._mouseHoverTooltip.addClass(r.model.cssClass),r.tooltipState="Template",o=t.buildTag("tbody",n.render[r._id+"tooltipTemplate"](u),{},{}),r._mouseHoverTooltip[0].innerHTML="<table>"+o[0].innerHTML+"<\/table>",r._tooltipTimer=setTimeout(function(){n(document.body).append(r._mouseHoverTooltip);r._updateTooltipPosition(r._mouseHoverTooltip,s,h)},700)):r.model.tooltipTemplateId&&(r._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+r._id+"","",{position:"absolute","z-index":r._getMaxZIndex()+1,"border-radius":"5px"},{}),r.model.cssClass&&r._mouseHoverTooltip.addClass(r.model.cssClass),r.tooltipState="TemplateID",o=t.buildTag("tbody",n.render[r._id+"tooltipTemplate"](u),{},{}),r._mouseHoverTooltip[0].innerHTML="<table>"+o[0].innerHTML+"<\/table>",r._tooltipTimer=setTimeout(function(){n(document.body).append(r._mouseHoverTooltip);r._updateTooltipPosition(r._mouseHoverTooltip,s,h)},700)):(r.tooltipState="",o=t.buildTag("tbody",n.render[r._id+"tooltipTemplate"](y),{},{}),c.append(o),r._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+r._id+"",c,{position:"absolute","z-index":r._getMaxZIndex()+1,"border-radius":"5px"},{}),r.model.cssClass&&r._mouseHoverTooltip.addClass(r.model.cssClass),r._mouseHoverTooltip.innerHTML="<table>"+c[0].innerHTML+"<\/table>",r._tooltipTimer=setTimeout(function(){n(document.body).append(r._mouseHoverTooltip);r._updateTooltipPosition(r._mouseHoverTooltip,s,h)},700)),n(r._mouseHoverTooltip).addClass("e-customTooltip")),r.model.enableTaskbarTooltip&&v&&(c=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"5"}),r.model.predecessorTooltipTemplate?(r._connectorLineTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+r._id+"","",{position:"absolute","z-index":r._getMaxZIndex()+1,"border-radius":"5px"},{}),r.model.cssClass&&r._connectorLineTooltip.addClass(r.model.cssClass),o=t.buildTag("tbody",n.render[r._id+"predecessorTooltipTemplate"](v),{},{}),r._connectorLineTooltip[0].innerHTML="<table>"+o[0].innerHTML+"<\/table>",r._tooltipTimer=setTimeout(function(){n(document.body).append(r._connectorLineTooltip);r._updateTooltipPosition(r._connectorLineTooltip,s,h)},700)):(o=t.buildTag("tbody",n.render[r._id+"predecessorTooltipTemplate"](v),{},{}),c.append(o),r._connectorLineTooltip=t.buildTag("div.e-tooltipgantt e-js#"+r._id+"_predecessortooltip",c,{position:"absolute","z-index":r._getMaxZIndex()+1,"border-radius":"5px"},{}),r.model.cssClass&&r._connectorLineTooltip.addClass(r.model.cssClass),r._connectorLineTooltip.innerHTML="<table>"+c[0].innerHTML+"<\/table>",r._tooltipTimer=setTimeout(function(){n(document.body).append(r._connectorLineTooltip);r._updateTooltipPosition(r._connectorLineTooltip,s,h)},700)),n(r._connectorLineTooltip).addClass("e-customTooltip"))))},_createEditingTooltipTemplate:function(){var t=this,r=t.model.columnHeaderTexts,s=t.model.durationUnitTexts,f=t.model.taskbarEditingTooltipTemplateId,e=t.model.taskbarEditingTooltipTemplate,i={},o,u;i["_"+t._id+"getStartDate"]=t._tooltipStartDate;i["_"+t._id+"getEndDate"]=t._tooltipEndDate;i["_"+t._id+"getTaskName"]=t._tooltipTaskName;i["_"+t._id+"getProgress"]=t._tooltipProgress;i["_"+t._id+"checkDuration"]=t._checkDuration;i["_"+t._id+"getDuration"]=n.proxy(t._tooltipDuration,t);n.views.helpers(i);o=f?n("#"+f)[0].innerHTML:e?e:"{{if ~_"+t._id+"getTaskName()}}<tr><td class='e-tooltiptaskname' style='width:40px;text-align:left;' colspan='3';>{{:ttiptaskname}}<\/td><\/tr>{{/if}}{{if ~_"+t._id+"getStartDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.startDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipstartDate}}<\/td><\/tr>{{/if}}{{if ~_"+t._id+"getEndDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.endDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipendDate}}<\/td><\/tr>{{/if}}{{if ~_"+t._id+"checkDuration()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.duration+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:~_"+t._id+"getDuration(#data)}}<\/td><\/tr>{{/if}}{{if ~_"+t._id+"getProgress()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.status+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipprogress}}%<\/td><\/tr>{{/if}}";u={};u[t._id+"editingTooltipTemplate"]=o;n.templates(u)},_createProgressbarTooltipTemplate:function(){var t=this,u=t.model.progressbarTooltipTemplateId,f=t.model.progressbarTooltipTemplate,i,r;u?i=n("#"+t.model.progressbarTooltipTemplateId)[0].innerHTML:t.model.progressbarTooltipTemplate&&(i=t.model.progressbarTooltipTemplate);r={};r[t._id+"progressbarTooltipTemplate"]=i;n.templates(r)},_createTooltipTemplate:function(){var t=this,e,r=t.model.columnHeaderTexts,s=t.model.durationUnitTexts,i={},o=t.model.tooltipTemplateId,h=t.model.tooltipTemplate,u,f;i["_"+t._id+"getStartDate"]=t._tooltipStartDate;i["_"+t._id+"getSubtaskStartDate"]=t._tooltipSubtaskStartDate;i["_"+t._id+"getScheduleStartDate"]=t._tooltipScheduleStartDate;i["_"+t._id+"getEndDate"]=t._tooltipEndDate;i["_"+t._id+"getSubtaskEndDate"]=t._tooltipSubtaskEndDate;i["_"+t._id+"getScheduleEndDate"]=t._tooltipScheduleEndDate;i["_"+t._id+"getTaskName"]=t._tooltipTaskName;i["_"+t._id+"getProgress"]=t._tooltipProgress;i["_"+t._id+"checkDuration"]=t._checkDuration;i["_"+t._id+"getDuration"]=n.proxy(t._tooltipDuration,t);n.views.helpers(i);o?u=n("#"+t.model.tooltipTemplateId)[0].innerHTML:t.model.tooltipTemplate?u=t.model.tooltipTemplate:(u="<tr class='e-tooltip_rowcell'>",e="{{if ~_"+t._id+"getTaskName()}}<td class='e-tooltiptaskname' style='width:40px;text-align:left;' colspan='3';>{{:ttiptaskname}}<\/td>{{/if}}<\/tr>{{if ~_"+t._id+"getStartDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.startDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipstartDate}}<\/td> {{/if}}<\/tr>{{if ~_"+t._id+"getSubtaskStartDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.subTasksStartDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipsubtaskStartDate}}<\/td><\/tr>{{/if}}{{if ~_"+t._id+"getScheduleStartDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.scheduleStartDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipscheduleStartDate}}<\/td><\/tr>{{/if}}{{if ~_"+t._id+"getEndDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.endDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipendDate}}<\/td>{{/if}}<\/tr>{{if ~_"+t._id+"getSubtaskEndDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.subTasksEndDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipsubtaskEndDate}}<\/td><\/tr>{{/if}}{{if ~_"+t._id+"getScheduleEndDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.scheduleEndDate+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipscheduleEndDate}}<\/td><\/tr>{{/if}}{{if ~_"+t._id+"checkDuration()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.duration+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:~_"+t._id+"getDuration(#data)}}<\/td>{{/if}}<\/tr>{{if ~_"+t._id+"getProgress()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.status+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipprogress}}%<\/td>{{/if}}",u+=e,u+="<\/tr>");f={};f[t._id+"tooltipTemplate"]=u;n.templates(f)},_createPredecessorTooltipTemplate:function(){var t=this,e=t.model,o,r={},u=e.connectorLineDialogText,i=e.predecessorTooltipTemplate,f;r["_"+t._id+"getFromTask"]=t._tooltipFromTask;r["_"+t._id+"getToTask"]=t._tooltipToTask;r["_"+t._id+"getOffsetValue"]=n.proxy(t._getOffsetValue,t);n.views.helpers(r);i?i.charAt(0)=="#"&&(i=n(i)[0].innerHTML):(o="{{if ~_"+t._id+"getFromTask()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+u.from+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:~_"+t._id+"getFromTask()}}<\/td><\/tr>{{/if}}{{if ~_"+t._id+"getToTask()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+u.to+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:~_"+t._id+"getToTask()}}<\/td><\/tr>{{/if}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+u.taskLink+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:linkText}}<\/td><\/tr><tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+u.lag+"<\/td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:<\/td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:~_"+t._id+"getOffsetValue(#data)}}<\/td><\/tr>",i+=o);f={};f[t._id+"predecessorTooltipTemplate"]=i;n.templates(f)},_checkDuration:function(){return this.data.ttipduration},_tooltipTaskName:function(){return this.data.ttiptaskname},_tooltipProgress:function(){return this.data.ttipprogress},_tooltipStartDate:function(){return this.data.ttipstartDate},_tooltipSubtaskStartDate:function(){return this.data.ttipsubtaskStartDate},_tooltipScheduleStartDate:function(){return this.data.ttipscheduleStartDate},_tooltipEndDate:function(){return this.data.ttipendDate},_tooltipSubtaskEndDate:function(){return this.data.ttipsubtaskEndDate},_tooltipScheduleEndDate:function(){return this.data.ttipscheduleEndDate},_tooltipFromTask:function(){var n=this.data,i=t.isNullOrUndefined(n.fromSno)?n.fromId:n.fromSno;return n.fromName+" ("+i+")"},_tooltipToTask:function(){var n=this.data,i=t.isNullOrUndefined(n.toSno)?n.toId:n.toSno;return n.toName+" ("+i+")"},_getOffsetValue:function(n){var i=this,t={};return t.ttipduration=n.offset,t.ttipdurationunit=n.offsetUnit,i._tooltipDuration(t)},_removeSeparator:function(n){var i=n.toString(),r=t.preferredCulture(this.model.locale).numberFormat;return i.replace(".",r["."])},_tooltipDuration:function(n){var r="",t;return n.ttipduration!=null&&n.ttipduration!=i&&(r+=this._removeSeparator(parseFloat(n.ttipduration.toFixed(2)))+" "),n.ttipdurationunit!=null&&n.ttipdurationunit!=i&&(t=n.ttipduration!=1,r+=n.ttipdurationunit=="day"?t?this.model.durationUnitTexts.days:this.model.durationUnitTexts.day:n.ttipdurationunit=="hour"?t?this.model.durationUnitTexts.hours:this.model.durationUnitTexts.hour:t?this.model.durationUnitTexts.minutes:this.model.durationUnitTexts.minute),r},_getDurationUnits:function(){var n=this;return n.model.durationUnit==t.Gantt.DurationUnit.Hour?"hours":n.model.durationUnit==t.Gantt.DurationUnit.Minute?"minutes":"days"},_cellClickHandler:function(i){var o=n(i.target),p=o.closest("tr.e-ganttrowcell"),u=this,r=this.model,e={},s,f,h,w=o[0],a=u.getGanttChartRows(),c,v,y;if(h=f=a.index(o.parent()),u._multiSelectCtrlRequest=i.ctrlKey,u._multiSelectShiftRequest=i.shiftKey,f==-1&&(h=f=a.index(p)),r.allowSelection&&u._ganttTouchTrigger&&r.selectionMode=="row"&&r.selectionType=="multiple"&&(e={target:o,ctrlKey:i.ctrlKey},u._trigger("getCtrlRequestValue",e),i.ctrlKey=e.ctrlKey),(r.viewType=="resourceView"||r.viewType=="histogramView")&&(c=this.getRecordByTarget(i)),!(n(w).hasClass("e-parentTask")||n(w).closest(".e-parentTask").length>0)||o.hasClass("e-connectorpoint-left")||o.hasClass("e-connectorpoint-right")||i.ctrlKey||i.shiftKey){if(f!=-1&&r.allowSelection){if(s=r.currentViewData[f],f=r.updatedRecords.indexOf(s),r.selectionMode=="row"){if(u._rowSelectingEventTrigger(r.selectedRowIndex,f))return;r.selectionType==t.Gantt.SelectionType.Multiple&&i.shiftKey&&r.allowSelection==!0&&(u._prevSelectedItem!=null&&u._getExpandStatus(u._prevSelectedItem)?u.selectRows(r.updatedRecords.indexOf(u._prevSelectedItem),f):u._prevSelectedItem==null&&u.selectRows(0,f),u._rowSelectedEventTrigger(f,t.isNullOrUndefined(u._prevSelectedItem)?0:r.updatedRecords.indexOf(u._prevSelectedItem)));i.shiftKey||(u.selectRows(f),u._rowSelectedEventTrigger(f));u.focusGanttElement()}r.selectionMode=="cell"&&(u.model.selectedItem=s);r.viewType==t.Gantt.ViewType.ResourceView&&c&&(c.eResourceTaskType=="unassignedTask"||c.eResourceTaskType=="resourceChildTask")&&this.selectTaskbar(c)}}else{var b=a.index(p),s=r.currentViewData[b],l=r.updatedRecords.indexOf(s);u._allowExpandCollapse&&s&&s.hasChildRecords&&(u._trigger("cancelEditCell"),(r.selectedRowIndex!==l&&r.allowSelection&&l!==-1||!u._multiSelectCtrlRequest&&r.selectedRowIndex==l&&r.selectionType=="multiple")&&(u._rowSelectingEventTrigger(r.selectedRowIndex,l)||(u.selectRows(l),u._rowSelectedEventTrigger(l))),u._expandCollapse(b),e={requestType:"expandCollapse"},u._trigger("getCtrlRequestValue",e))}r.taskbarClick&&(o.is(".e-childContainer,.e-gantt-milestone-container,.e-parentContainer")||(v=o.closest(".e-childContainer,.e-gantt-milestone-container,.e-parentContainer,.e-gantthistobar"),v.length&&(e={},y=r.viewType=="projectView"?r.currentViewData[h]:c,h=r.viewType=="histogramView"?r.updatedRecords.indexOf(r.currentViewData[h]):r.updatedRecords.indexOf(y),e.data=y,e.index=h,e.taskbarElement=v[0],e.target=o[0],this._trigger("taskbarClick",e))))},getRowByIndex:function(i,r){var e,o;try{var u=this,f=u.getGanttChartRows(),s=n(f),h=n();return u.model.enableVirtualization&&(e=u.model.updatedRecords[i],i=u.model.currentViewData.indexOf(e)),t.isNullOrUndefined(r)?(u.model.enableVirtualization&&(o=u.model.updatedRecords[r],r=u.model.currentViewData.indexOf(o)),n(f[i])):n(s.slice(i,r))}catch(c){return n()}},selectTaskbar:function(t){var r=this.model,u,i=-1,f=0,e;r.viewType=="resourceView"&&(t.eResourceTaskType=="resourceChildTask"||t.eResourceTaskType=="unassignedTask")&&(t.eResourceTaskType=="resourceChildTask"&&t.parentItem?(u=t.parentItem,i=r.updatedRecords.indexOf(u),f=u.eResourceChildTasks.indexOf(t)):i=r.updatedRecords.indexOf(t),i!=-1&&(e=this.getRowByIndex(i),this.element.find(".e-gantt-taskbarSelection").removeClass("e-gantt-taskbarSelection"),n(e.find(".e-childContainer")[f]).addClass("e-gantt-taskbarSelection")))},_applySelection:function(n){if(n!=-1){var i=this,t=i.model,u=i.getRowByIndex(n),r=t.updatedRecords[n];r.isSelected=!0;t.selectedItems.push(r);u.addClass("e-gantt-mouseclick");t.selectedItem=t.updatedRecords[n];t.selectedRowIndex=n}},selectRows:function(i,r){var u=this,f=this.model,c=u.getGanttChartRows(),o,e,h,s;if(f.allowSelection&&f.selectionMode!="cell"){if(f.selectionType!=t.Gantt.SelectionType.Multiple||t.isNullOrUndefined(i)||t.isNullOrUndefined(r))switch(f.selectionType){case t.Gantt.SelectionType.Multiple:if(u._multiSelectCtrlRequest&&i!=-1){u._prevSelectedItem=f.updatedRecords[i];u._shiftSelectedRecord=null;s=n.inArray(f.updatedRecords[i],f.selectedItems);s!=-1&&u.clearSelection(i);s==-1&&u._applySelection(i);break}case t.Gantt.SelectionType.Single:u._prevSelectedItem&&(u._prevSelectedItem.isSelected=!1);u.clearSelection(-1);u._applySelection(i);u._prevSelectedItem=f.selectedItem;u._shiftSelectedRecord=null}else for(u.clearSelection(-1),o=i-r<0?f.updatedRecords.slice(i,r+1):f.updatedRecords.slice(r,i+1),e=0;e<o.length;e++)u._getExpandStatus(o[e])&&(h=f.updatedRecords.indexOf(o[e]),u._applySelection(h));f.selectedItems.length==0&&f.selectedRowIndex!=-1&&(f.selectedRowIndex=-1)}},updateSelectedItem:function(t){var i=this,r=n(i.getGanttChartRows());r.removeClass("e-gantt-mouseclick");i.model.updatedRecords[t].isSelected=!0;i.model.selectedItem=i.model.updatedRecords[t];this._refresh();i._rowSelectedEventTrigger(t)},_getRecordTopPosition:function(n,t){var i={},u=0,f=this.model,r;if(this.model.viewType=="resourceView"){for(r=0;r<=t;r++)r==t?i.bottom=u+this._getTemplateRowHeight(n[r]):u+=this._getTemplateRowHeight(n[r]);i.top=u}else i.top=t*f.rowHeight,i.bottom=i.top+f.rowHeight;return i},_getHeightforResourceView:function(n){for(var i=0,t=0;t<n.length;t++)i+=this._getTemplateRowHeight(n[t]);return i},getRecordsHeight:function(){var n=this.model;return n.viewType=="resourceView"?n.enableVirtualization?this._getHeightforResourceView(n.updatedRecords):this._getHeightforResourceView(this.getExpandedRecords(n.updatedRecords)):n.enableVirtualization?n.updatedRecords.length*n.rowHeight:n.rowHeight*(n.updatedRecords.length-this.getCollapsedRecordCount())},updateHeight:function(i){var r=this,f=r.model,u,i;r._setScrollTop();r._containerHeight=i;n("#ganttviewerbodyContent"+r._id+"").css({height:r._containerHeight+"px"});f.stripLines&&n(r.element).find(".e-stripline,.e-stripLines").css({height:i+"px"});f.holidays&&n(r.element).find(".e-holidays,.e-holiday").css({height:i+"px"});n(".e-secondary_canvas").css({height:i+"px"});n(r.element).find(".e-weekends").css({height:i+"px"});n(r.element).find(".e-ganttworkingtime").css({height:i+"px"});u=".e-holiday-label";t.browserInfo().name=="msie"&&t.browserInfo().version<9&&(u=".e-holiday-label-ie8");i<r._viewportHeight?i<=f.rowHeight?n(r.element).find(u).css({top:-i-30}):n(r.element).find(u).css({top:i/2}):n(r.element).find(u).css({top:r._viewportHeight/2});i==0&&r._$bodyContent.css({height:"1px"});r._$bodyContainer.ejScroller("refresh");parseInt(r._$bodyContainer.css("height"))!=r._viewportHeight&&(i=r._$bodyContent.width()<r._$bodyContainerParent.width()?r._viewportHeight+18:r._viewportHeight,r._$bodyContainer.css("height",i))},_completeAction:function(n){var t=this;return n.vscrollExsist=t._$bodyContainer.ejScroller("isVScroll"),t._trigger("actionComplete",n),n.requestType==="validatePredecessor"?n.predecessorValidation:void 0},_taskbarEditing:function(n){var t=this;t._trigger("taskbarEditing",n)},_taskbarEdited:function(n){var t=this;t._trigger("taskbarEdited",n)},_queryTaskbarinfo:function(n,t){this._trigger("queryTaskbarInfo",n);this._updateTaskbarItems(n,t)},_refreshRow:function(n){var t=this;t._trigger("refreshRow",n)},_updateManualTaskbarItem:function(n,i){var p=i.querySelector(".e-gantt-parenttaskbar-innerdiv"),s=i.querySelector(".e-gantt-parenttaskbar-progress"),h=i.querySelector(".e-gantt-manualparenttaskbar"),c=i.querySelector(".e-gantt-manualparenttaskbar-left"),l=i.querySelector(".e-gantt-manualparenttaskbar-right"),a=i.querySelector(".e-taskbarresizer-right"),u=p.style,e=s&&s.style,f=h&&h.style,w=c&&c.style,v=l&&l.style,b=a&&a.style,o=this.model,y,r;y=o.renderBaseline?o.taskbarHeight-9:o.taskbarHeight-10;r=y/5;t.isNullOrUndefined(n.manualParentTaskbarBackground)||f.backgroundColor==n.manualParentTaskbarBackground||(f.backgroundColor=n.manualParentTaskbarBackground,w.borderColor=n.manualParentTaskbarBackground,v.borderColor=n.manualParentTaskbarBackground);f.width=n.data.width+"px";f.left=n.data.left+"px";v.left=n.data.width-parseInt(r)+"px";b.left=n.data.width-parseInt(r)+"px";n.data.width==n.data.manualWidth&&n.data.left==n.data.manualLeft?(e.width=n.data.progressWidth-r*2+"px",u.width=n.data.manualWidth-r*2+"px",u.left=n.data.manualLeft+r+"px"):n.data.left==n.data.manualLeft?(u.left=n.data.manualLeft+r+"px",e.width=n.data.progressWidth-r+"px",u.width=n.data.manualWidth-r+"px"):(e.width=n.data.progressWidth+"px",u.width=n.data.manualWidth+"px",u.left=n.data.manualLeft+"px")},_updateTaskbarItems:function(i,r){var e,o,a,s,y,p,w,b,k,d,g,nt,tt,it;if(r){if(n(r).hasClass("e-gantt-milestone-container")&&(o=n(r).closest("div")[0]),n(r).next().hasClass("e-baseline-gantt-milestone-container")&&(s=n(r).next().find(".e-baseline-gantt-milestone").closest("div")[0]),n(r).next().hasClass("e-baselinebar")&&(a=n(r).next().closest("div")[0]),n(r).hasClass("e-parentContainer")){var e=n(r).closest("div")[0],ft=e.querySelector(".e-gantt-parenttaskbar-innerdiv"),rt=e.querySelector(".e-gantt-parenttaskbar-progress"),h=ft.style,u=rt&&rt.style;h.backgroundColor!=i.parentTaskbarBackground&&(h.backgroundColor=i.parentTaskbarBackground);u&&u.backgroundColor!=i.parentProgressbarBackground&&(u.backgroundColor=i.parentProgressbarBackground);h.borderColor!=i.parentTaskbarBorder&&(h.borderColor=i.parentTaskbarBorder);u&&u.borderColor!=i.parentProgressbarBorder&&(u.borderColor=i.parentProgressbarBorder);!i.data.isAutoSchedule&&i.data.hasChildRecords&&this._updateManualTaskbarItem(i,e);u&&u.borderColor!=i.parentProgressbarBorder&&(u.borderColor=i.parentProgressbarBorder)}else if(n(r).hasClass("e-childContainer")){var e=n(r).closest("div")[0],et=e.querySelector(".e-gantt-childtaskbar"),f=e.querySelector(".e-gantt-childtaskbar-progress"),c=et.style,l=f&&f.style,ut=f&&f.querySelector(".e-tasklabel"),v=ut&&ut.style;c.backgroundColor==i.taskbarBackground||t.isNullOrUndefined(i.data.duration)||(c.backgroundColor=i.taskbarBackground);f&&l.backgroundColor!=i.progressbarBackground&&(l.backgroundColor=i.progressbarBackground);c.borderColor!=i.taskbarBorder&&(c.borderColor=i.taskbarBorder);f&&l.borderColor!=i.progressbarBorder&&(l.borderColor=i.progressbarBorder);v&&v.color!=i.taskbarTextColor&&(v.color=i.taskbarTextColor)}n(o).length>0&&(y=o.querySelector(".e-gantt-milestone.e-milestone-top"),p=o.querySelector(".e-gantt-milestone.e-milestone-bottom"),y&&p?(w=y.style,b=p.style,b.borderBottomColor!=i.milestoneBackground&&w.borderTopColor!=i.milestoneBackground&&(b.borderTopColor=i.milestoneBackground,w.borderBottomColor=i.milestoneBackground)):this.model.milestoneTemplate&&(k=o.querySelector(".e-gantt-milestone"),k.style.backgroundColor!=i.milestoneBackground&&(k.style.backgroundColor=i.milestoneBackground)));n(a).hasClass("e-baselinebar")&&(d=a.style,d.backgroundColor!=i.baselineBackground&&(d.backgroundColor=i.baselineBackground));n(s).hasClass("e-baseline-gantt-milestone")&&(g=s.querySelector(".e-baseline-milestone-top"),nt=s.querySelector(".e-baseline-milestone-bottom"),g&&nt&&(tt=g.style,it=nt.style,it.borderTopColor!=i.baselineBackground&&tt.borderBottomColor!=i.baselineBackground&&(it.borderTopColor=i.baselineBackground,tt.borderBottomColor=i.baselineBackground)))}},_expandCollapse:function(n){var i=this,t={},r=i.model.currentViewData[n];t.data=r;t.recordIndex=i.model.updatedRecords&&i.model.updatedRecords.indexOf(r);t.source="ganttChart";t.expanded=!r.expanded;r&&(t.expanded?i._trigger("expanding",t):i._trigger("collapsing",t))},_getExpandStatus:function(n){var t=n.parentItem;return t!=null?t.expanded===!1?!1:t.parentItem?t.parentItem.expanded===!1?!1:this._getExpandStatus(t.parentItem):!0:!0},onScrollHelper:function(t,i){var r=this,f,u,e;if(!r._$bodyContainer.ejScroller("isVScroll"))return!1;r._mouseLeave();r.closePredecessorDialog();i||r._$bodyContainer.ejScroller("option","scrollTop",t);f=r.model.rowHeight;n("#"+this._$ganttViewTablebody[0].id).find("tr:first")[0]&&(f=n("#"+this._$ganttViewTablebody[0].id).find("tr:first")[0].getBoundingClientRect().height);u=parseInt(this.getRecordsHeight())-(r._viewportHeight-18);t>u&&(t=u);t<0&&(t=0);e={scrollTop:t};r._handleScroll(e);this.model.isCriticalPathEnable==!0&&this.model.enableVirtualization==!0&&this.criticalConnectorLine(this.model.criticalPathCollection,this.model.detailPredecessorCollection,!0,this.collectionTaskId)},_handleScroll:function(n){var t=this,n=n||{},f=t._$headerContainer,e=t._prevScrollTop,o=t._prevLeft,r,u;n.scrollTop!==i&&(t._scrollTop=n.scrollTop);n.scrollLeft!==i&&(t._scrollLeft=n.scrollLeft);r=t._scrollLeft-t._prevLeft;u=t._scrollTop-t._prevScrollTop;r?f.scrollLeft(t._scrollLeft):f.scrollLeft(t._prevLeft);t.model.enableVirtualization&&(t._vscrollDist=Math.abs(t._scrollTop-t._prevScrollTop),t._vscrollDist&&(t._vScrollDir=t._prevScrollTop<=t._scrollTop?1:-1,t._updateCurrentViewData(),t.renderGanttRecords(),t._prevScrollTop=t._scrollTop));t._prevLeft=t._scrollLeft;t._prevScrollTop=t._scrollTop;n.requestType="scroll";r===0&&u!==0?(n.prevScrollTop=e,n.scrollDirection="vertical",n.delta=t._scrollTop,t._completeAction(n)):r!==0&&u===0&&(n.prevScrollLeft=o,n.isScrollByMethod=this._isScrollByMethod,n.scrollDirection="horizontal",t._completeAction(n))},_getMaxScrollWidth:function(){return this._$bodyContainer.children(".e-content").find(".e-ganttviewerbodyContent").width()-this._$bodyContainer.children(".e-content").width()},setScrollLeft:function(n){var t=this._getMaxScrollWidth();n>t&&(n=t);n!=this._prevLeft&&(this._isScrollByMethod=!0,this._$bodyContainer.ejScroller("scrollX",n,!0));this._isScrollByMethod=!1},refreshHelper:function(n,t,r){var u=this;u.model.currentViewData=n;u.model.updatedRecords=t;u._totalCollapsedRecordCount=r!=i?r:0;t&&(u._refresh(),u._setHeight(this.getRecordsHeight()),u.updateHeight(u._containerHeight))},_setScrollTop:function(){var t=this,n=this.model,u=t._scrollTop,r,i;r=n.viewType=="resourceView"?this._getHeightforResourceView(n.currentViewData):n.currentViewData.length*n.rowHeight;n.enableVirtualization&&u!==0&&r<t._viewportHeight&&(i=u-(t._viewportHeight-r),i<0&&(i=0),t._$bodyContainer.ejScroller("scrollY",i,!0))},refreshGridLinesTable:function(n){var t=this,i;t._$gridLinesTablebody.empty().append(t._createGridLinesTableRow(n));t._$bodyContainer.ejScroller("refresh");parseInt(t._$bodyContainer.css("height"))!=t._viewportHeight&&(i=t._$bodyContent.width()<t._$bodyContainerParent.width()?t._viewportHeight+18:t._viewportHeight,t._$bodyContainer.css("height",i))},_refresh:function(){var i=this,r=i.model,u=n.render[i._id+"_CustomTemplate2"](i.model.currentViewData);i._$ganttViewTablebody=n("#ganttViewTablebody"+i._id+"");i._$ganttViewTablebody.empty().append(u);r.enableVirtualization?i._$gridLinesTablebody.empty().append(i._createGridLinesTableRow(i.model.currentViewData.length)):i._$gridLinesTablebody.empty().append(i._createGridLinesTableRow(i.model.currentViewData.length-i._totalCollapsedRecordCount));i._$ganttViewTablebody[0]!=null?this._ganttChartRows=n(i._$ganttViewTablebody[0].childNodes):(i._$ganttViewTablebody=t.buildTag("tbody.e-gantt-viewer-ganttViewTablebody#ganttViewTablebody"+i._id+"",u,{},{}),i._ganttChartRows=n(i._$ganttViewTablebody[0].childNodes));r.queryTaskbarInfo&&i._eventBindings()},refreshRow:function(t){var r=this,u=this.model,s=n(r.getGanttChartRows()[t]),i=r.model.currentViewData[t],f=u.viewType=="resourceView"?!0:!1,e,o;f&&i&&(o=u.enableVirtualization?t:this.getExpandedRecords(this.model.updatedRecords).indexOf(i),e=n(this._$gridLinesTablebody[0].childNodes[o]));!u.allowSelection&&i&&(i.isSelected=!1);t!=-1&&i&&(s.replaceWith(n.render[r._id+"_CustomTemplate2"](i)),r._setGanttChartRows(n(r._$ganttViewTablebody[0].childNodes)),f&&e.height(this._getTemplateRowHeight(i)));u.queryTaskbarInfo&&r._refreshedRowEventBinding(t)},_refreshedRowEventBinding:function(t){var c=n(this.getGanttChartRows()),o=c[t],s=this.model.currentViewData[t],f,u,e={},r,h,i;if(e.taskbar=o,n(o).hasClass("e-ganttrowcell"))if(this.model.viewType=="histogramView")for(f=n(o).find("div.e-gantthistobar"),i=0;i<n(f).length;i++)r={},u=n(f)[i],h=u.querySelector(".e-gantthistoworklabel"),r.taskbar=u,r.data=s.workTimelineRanges[i],r.taskbarBackground=u.style.backgroundColor,r.labelColor=h.style.color,this._trigger("queryTaskbarInfo",r),u.style.backgroundColor!=r.taskbarBackground&&(u.style.backgroundColor=r.taskbarBackground),h.style.color!=r.labelColor&&(h.style.color=r.labelColor);else if(f=n(o).find("div.e-childContainer,div.e-parentContainer,div.e-gantt-milestone-container"),n(f).length>0&&s.eResourceTaskType=="resourceTask")for(i=0;i<n(f).length;i++)u=n(f)[i],e.taskbar=u,e.data=s.eResourceChildTasks[i],this._prepareQueryTaskbar(u,e);else e.data=s,this._prepareQueryTaskbar(f,e)},refreshScroller:function(n){var t=this,r,u,i,f;t._$bodyContainer.find("div.e-content").removeClass("e-borderbox");u=t._$bodyContainer.ejScroller("option","scrollTop");i=t._$bodyContainer.ejScroller("option","scrollLeft");t._$bodyContainer.ejScroller("option",{width:n});t._$bodyContainer.ejScroller("refresh");r=t.getMaxScrollWidth();i>r&&(i=r>0?r:0);f=t._$bodyContainer.ejScroller("isVScroll");f&&t._$bodyContainer.ejScroller("scrollY",u,!0);t._$bodyContainer.ejScroller("option","scrollLeft",i);t._$headerContainer.scrollLeft(i)},getMaxScrollWidth:function(){var n=this;return n._$bodyContainer.children(".e-content").children().width()-n._$bodyContainer.children(".e-content").width()},refreshStripLines:function(n){var t=this;n&&(this.model.stripLines=n);t._$stripLineContainer.empty();this._renderStripLines(this.model.stripLines)},refreshHolidays:function(n){var t=this,r,i;if(n&&(t.model.holidays=n),t._$secondaryCanvas.empty(),t.model.holidays!=null)for(r=t.model.holidays.length,i=0;i<r;i++)t._renderHoliday(t.model.holidays[i])},renderNewAddedRow:function(t,i){var r=this,f=r.model,u=n.render[this._id+"_CustomTemplate2"](i);r._ganttChartRows.length!=0?r._ganttChartRows.length==t?r.getGanttChartRows().eq(t-1).after(u):r.getGanttChartRows().eq(t).before(u):r._refresh();r._setGanttChartRows(n(r._$ganttViewTablebody[0].childNodes));r._$gridLinesTablebody.empty().append(r._createGridLinesTableRow(r.model.updatedRecords.length-r._totalCollapsedRecordCount));r._setHeight(this.getRecordsHeight());r.updateHeight(r._containerHeight)},_setGanttChartRows:function(n){this._ganttChartRows=n},refreshContainersWidth:function(){var i=this,r,s=this.model,e=s.scheduleHeaderSettings.scheduleHeaderType,f,o,u;if(r=i._getScheduleLength(e),f=n("#ganttgridLinesTable"+i._id),i._$bodyContent.width(r),e==t.Gantt.ScheduleHeaderType.Day?i._renderDayWorkColor():i.refreshWeekEndContainer(),f.width(r),f.children("col").width(r),i._$ganttViewTable.width(r),i._$ganttViewTable.children("col").width(r),i._createChartTaskbarTemplate(),i._updateCurrentViewData(),i._$secondaryCanvas.empty(),i._$stripLineContainer.empty(),i.model.stripLines!=null&&this._renderStripLines(i.model.stripLines),i.model.holidays!=null)for(o=i.model.holidays.length,u=0;u<o;u++)i._renderHoliday(i.model.holidays[u])},refreshWeekEndContainer:function(){var n=this,a=n.model,r=0,v=n.model.perDayWidth+1,y=n.model.updatedRecords.length*this.model.rowHeight,p=n.model.scheduleWeeks.length,h,u=a.scheduleHeaderSettings.weekStartDay,c=u>=0&&u<7?u:0,l=6-c,f=n._$weekendsContainer.children(".e-secondary_canvas"),w=n._nonWorkingDayIndex.length,e,o,i,s;for(f.empty(),e=0;e<p;e++){for(i=0;i<w;i++)n._nonWorkingDayIndex[i]!=6?(s=l+n._nonWorkingDayIndex[i]+1,o=s>=7?n._nonWorkingDayIndex[i]-c:s):o=l,h=t.buildTag("div.e-weekends","",{left:r+n.model.perDayWidth*o+"px",width:v+"px",height:y+"px","background-color":this.model.weekendBackground},{}),f.append(h);r=r+this._scheduleWeekWidth}n._$weekendsContainer.append(f)},deleteChartRows:function(n,t){for(var r=this,u=r.getGanttChartRows(),i=n;i<n+t;i++)u.splice(i,1)},_prepareQueryTaskbar:function(i,r){var u=n(i)[0],c,l,h,e,o,a,f,v,s,y,p;n(u).hasClass("e-gantt-milestone-container")&&(c=n(u).find(".e-gantt-milestone.e-milestone-top")[0]);n(u).next().hasClass("e-baselinebar")&&(l=n(u).next().closest("div")[0]);n(u).next().hasClass("e-baseline-gantt-milestone-container")&&(h=n(u).next().find(".e-baseline-gantt-milestone").closest("div")[0]);n(u).hasClass("e-parentContainer")?(e=u.querySelector(".e-gantt-parenttaskbar-innerdiv"),o=u.querySelector(".e-gantt-parenttaskbar-progress"),a=u.querySelector(".e-gantt-manualparenttaskbar")):n(u).hasClass("e-childContainer")&&(s=u.querySelector(".e-gantt-childtaskbar"),f=u.querySelector(".e-gantt-childtaskbar-progress"),v=f&&f.querySelector(".e-tasklabel"));r.taskbarBackground=s!=null?s.style.backgroundColor:null;r.progressbarBackground=f!=null?f.style.backgroundColor:null;r.parentTaskbarBackground=e!=null?e.style.backgroundColor:null;r.parentProgressbarBackground=o!=null?o.style.backgroundColor:null;r.parentProgressbarBorder=o!=null?o.style.border:null;r.progressbarBorder=f!=null?f.style.border:null;r.taskbarBorder=s!=null?s.style.border:null;r.parentTaskbarBorder=e!=null?e.style.border:null;r.taskbarTextColor=v!=null?v.style.color:null;r.data.isMilestone&&!t.isNullOrUndefined(h)?(y=h.querySelector(".e-baseline-milestone-top"),p=h.querySelector(".e-baseline-milestone-bottom"),y&&p&&(r.baselineBackground=y.style.borderBottomColor)):r.baselineBackground=l!=null?l.style.backgroundColor:null;r.milestoneBackground=c!=null?c.style.borderBottomColor:null;r.data.hasChildRecords&&!r.data.isAutoSchedule&&(r.manualParentTaskbarBackground=a!=null?a.style.backgroundColor:null);this._queryTaskbarinfo(r,u)},_eventBindings:function(){var c=n(this.getGanttChartRows()),l=c.length,e,o,f={},u,r,s,i,h,t;if(l!=0)for(s=0;s<l;s++)if(e=c[s],o=this.model.currentViewData[s],f.taskbar=e,n(e).hasClass("e-ganttrowcell"))if(this.model.viewType=="histogramView")for(u=n(e).find("div.e-gantthistobar"),t=0;t<n(u).length;t++)i={},r=n(u)[t],h=r.querySelector(".e-gantthistoworklabel"),i.taskbar=r,i.data=o.workTimelineRanges[t],i.taskbarBackground=r.style.backgroundColor,i.labelColor=h.style.color,this._trigger("queryTaskbarInfo",i),r.style.backgroundColor!=i.taskbarBackground&&(r.style.backgroundColor=i.taskbarBackground),h.style.color!=i.labelColor&&(h.style.color=i.labelColor);else if(u=n(e).find("div.e-childContainer,div.e-parentContainer,div.e-gantt-milestone-container"),n(u).length>0&&o.eResourceTaskType=="resourceTask")for(t=0;t<n(u).length;t++)r=n(u)[t],f.taskbar=r,f.data=o.eResourceChildTasks[t],this._prepareQueryTaskbar(r,f);else f.data=o,this._prepareQueryTaskbar(u,f)},_updateCurrentViewData:function(){var t=this,i=0;this.model.enableVirtualization?(this._getRenderedRowRange(),this.model.currentViewData=this.model.updatedRecords.slice(t._renderedRange.top,t._renderedRange.bottom),t._vscrollDist!==0&&(i=t._scrollTop,i-=t._rowMargin,n("#ganttViewTable"+t._id+"").css({top:i+"px"}),n("#ganttgridLinesTable"+t._id+"").css({top:i+"px"})),t._vTop=t._visibleRange.top,t._vBottom=t._visibleRange.bottom,t._rTop=t._renderedRange.top,t._rBottom=t._renderedRange.bottom):this.model.currentViewData=this.model.updatedRecords},renderGanttRecords:function(){var n=this;n._refresh();n._$ganttViewTable.append(n._$ganttViewTablebody);n._$bodyContent.append(n._$ganttViewTable)},_getRenderedRowRange:function(){var n=this,t,i;return n._getVisibleRowRange(),t=n._visibleRange.top,i=n._visibleRange.bottom,n._renderedRange={top:t,bottom:i},n._renderedRange},_getVisibleRangeForResourceGantt:function(n){for(var f={},c=this.model,h=n+this._viewportHeight,o=0,l=n,i,s,r,e=c.updatedRecords,u=0;u<e.length;u++)if(o=this._getTemplateRowHeight(e[u]),l==0&&t.isNullOrUndefined(i)?(i=0,s=0,n*-1):n<0&&t.isNullOrUndefined(i)&&(i=u-1,s=this._getTemplateRowHeight(e[i])-n*-1),h<=0&&t.isNullOrUndefined(r)&&(r=u),n-=o,h-=o,!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(r))break;return f.top=i,f.topOffset=s,f.bottom=t.isNullOrUndefined(r)?e.length:r,f},_getVisibleRowRange:function(){var n=this,t,f,r,i,e,u;this.model.viewType=="resourceView"?(u=this._getVisibleRangeForResourceGantt(n._scrollTop),t=u.top,n._rowMargin=u.topOffset,i=u.bottom):(t=n._scrollTop/n.model.rowHeight,f=t-Math.floor(t),i=n._getrowposition(n._scrollTop+n._viewportHeight),n._rowMargin=f*n.model.rowHeight);r=Math.floor(t);e=n.model.updatedRecords.length;r=Math.max(0,r);i=Math.min(e,i);n._visibleRange={top:r,bottom:i}},_getrowposition:function(n){return Math.ceil(n/this.model.rowHeight)},_getDateType:function(n){return n instanceof Date?n:n!=null?t.parseDate(n,this.model.dateFormat,this.model.locale):null},_getDateFromFormat:function(n){return typeof n=="object"?new Date(n):n?t.parseDate(n,this.model.dateFormat,this.model.locale)==null?new Date(n):t.parseDate(n,this.model.dateFormat,this.model.locale):void 0},createGridLinesTable:function(){var i=this,u=i.model,f,c=u.scheduleHeaderSettings.scheduleHeaderType,r,s,o,e,h;f=t.buildTag("table.e-ganttgridLinesTable e-zerospacing#ganttgridLinesTable"+i._id,"",{"z-index":"2",position:"absolute"});o=t.buildTag("colgroup","",{},{});e=n(document.createElement("col"));switch(c){case"week":r=u.scheduleWeeks.length;f.css("width",r*i._scheduleWeekWidth+"px");e.css("width",r*this._scheduleWeekWidth+"px");break;case"year":case"quarterYear":case"halfYear":r=u.scheduleYears.length;f.css("width",i._scheduleYearWidth+"px");e.css("width",this._scheduleYearWidth+"px");break;case"month":r=u.scheduleMonths.length;f.css("width",i._scheduleMonthWidth+"px");e.css("width",this._scheduleMonthWidth+"px");break;case"day":r=u.scheduleDays.length;f.css("width",r*i.model.perHourWidth*24+"px");e.css("width",r*i.model.perHourWidth*24+"px");break;case"hour":r=u.scheduleHours.length;f.css("width",r*i.model.perMinuteWidth*i._totalInterval+"px");e.css("width",r*i.model.perMinuteWidth*i._totalInterval+"px")}o.append(e);f.append(o);s=i._createGridLinesTableRow(u.enableVirtualization?u.currentViewData.length:u.updatedRecords.length);h=t.buildTag("tbody.e-gantt-viewer-gridLinesTablebody#gridLinesTablebody"+i._id+"",s,{},{});i._$gridLinesTablebody=h;f.append(i._$gridLinesTablebody);i._$bodyContent.append(f)},_createGridLinesTableRow:function(n){var f=this,t=this.model,u="",r=[],i;for(t.viewType=="resourceView"&&t.enableVirtualization?r=t.currentViewData:t.viewType!="resourceView"||t.enableVirtualization||(r=this.getExpandedRecords(this.model.updatedRecords)),i=0;i<n;i++)u+=t.viewType=="resourceView"?"<tr style='display:table-row;height:"+this._getTemplateRowHeight(r[i])+"px'><td class='e-ganttgridlines'><\/td><\/tr>":"<tr style='display:table-row;height:"+t.rowHeight+"px'><td class='e-ganttgridlines'><\/td><\/tr>";return u},_SelectState:function(){var t=this,n=this.model;return n.allowSelection?!0:!1},_getFontSize:function(){var i=this,r=i.model,u=r.taskbarHeight,n,t;return n=70*u/100,t=n%1,t==.5?n:t<.5?Math.floor(n):Math.ceil(n)},_getLeftTaskLabel:function(){var r=this,i=r.model,n="",u=i._columns.length,t;if(this.model.leftTaskLabelMapping==this.model.resourceNameMapping)n="{{:~_"+r._id+"resources(#data)}}";else if(this.model.leftTaskLabelMapping==this.model.predecessorMapping)n="{{:predecessorsName}}";else for(t=0;t<u;t++)if(this.model.leftTaskLabelMapping==i._columns[t].mappingName){n="{{:"+i._columns[t].field+"}}";break}return n==""&&(n="{{:"+this.model.leftTaskLabelMapping+"}}"),n},_getRightTaskLabel:function(){var r=this,i=r.model,n="",u=i._columns.length,t;if(this.model.rightTaskLabelMapping==this.model.resourceNameMapping)n="{{:~_"+r._id+"resources(#data)}}";else if(this.model.rightTaskLabelMapping==this.model.predecessorMapping)n="{{:predecessorsName}}";else for(t=0;t<u;t++)if(this.model.rightTaskLabelMapping==i._columns[t].mappingName){n="{{:"+i._columns[t].field+"}}";break}return n==""&&(n="{{:"+this.model.rightTaskLabelMapping+"}}"),n},_getMargin:function(){var t=this,i=this.model.taskbarHeight,n;return n=(i-t._fontSize-3)/2,Math.floor(n)},_getResizerLeftAdjust:function(){var t=this,r=this.model.taskbarHeight,u=t._fontSize,f=t._resizerMargin,n,i;return n=r/50,i=n%1,n=i<.5?Math.floor(n):Math.ceil(n),n<0?0:n},_processTaskbarTemplate:function(i,r,u){var o=this,l=this.model,s=t.buildTag("div","",{},{}),f="",h=!1,e,c="";return u!=="resourceTemplate"&&(c="left:{{:left}}px;"),e=i.charAt(0)=="#"?n(i)[0].innerHTML:i,e=e.replace(/src/gi,o._id+"src"),n(s[0]).html(e),n(s[0].childNodes).each(function(){var s,u,i,e,o;n(this).hasClass("e-gantt-template-taskbar")?(s="e-gantt-childtaskbar "+n(this).attr("class"),n(this).css({height:r+"px"}).attr("class",s),u="",n(this.childNodes).each(function(){var f,t,i;n(this).hasClass("e-gantt-template-progressbar")?(h=!0,f="e-gantt-childtaskbar-progress  "+n(this).attr("class"),n(this).css({height:l.progressbarHeight*(r/100)+"px",position:"absolute",top:"-1px",left:"-1px"}).attr("class",f),t=this.outerHTML,i=t.indexOf("style"),t=t.substr(0,i+7)+"border-style:{{if progressWidth}}solid{{else}}none{{/if}};width:{{:progressWidth}}px;"+t.substr(i+7),u+=t):u+=this.nodeName=="#comment"?"":this.nodeName=="#text"?this.textContent?this.textContent.replace(/(\r\n|\n|\r)/gm,""):this.nodeValue.replace(/(\r\n|\n|\r)/gm,""):this.outerHTML}),i=n(this).clone().empty()[0].outerHTML,e=i.indexOf("style"),i=i.substr(0,e+7)+c+"width:{{:width}}px;"+i.substr(e+7),o=t.browserInfo().name=="msie"&&t.browserInfo().version<9?i.indexOf("<\/"+this.tagName+">"):i.indexOf("<\/"+this.tagName.toLowerCase()+">"),i=i.substr(0,o)+u+i.substr(o),f+=i):f+=this.nodeName=="#comment"?"":this.textContent?this.textContent.replace(/(\r\n|\n|\r)/gm,""):this.nodeValue.replace(/(\r\n|\n|\r)/gm,"")}),f=f.replace(RegExp((o._id+"src").toLowerCase(),"g"),"src"),{template:f,isProgressbarTemplate:h}},_processParentTaskbarTemplate:function(i,r){var e=this,s=this.model,o=t.buildTag("div","",{},{}),u="",f;return f=i.charAt(0)=="#"?n(i)[0].innerHTML:i,f=f.replace(/src/gi,e._id+"src"),n(o[0]).html(f),n(o[0].childNodes).each(function(){var h,f,i,e,o;n(this).hasClass("e-gantt-template-taskbar")?(n(this).addClass("e-parentTask"),h="e-gantt-parenttaskbar-innerdiv e-parentTask"+n(this).attr("class"),n(this).css({height:r+"px"}).attr("class",h),f="",n(this.childNodes).each(function(){var u,t,i;n(this).hasClass("e-gantt-template-progressbar")?(u="e-gantt-parenttaskbar-progress e-parentTask "+n(this).attr("class"),n(this).css({height:s.progressbarHeight*(r/100)+"px",top:"-1px",left:"-1px",position:"absolute","z-index":"3"}).attr("class",u),t=this.outerHTML,i=t.indexOf("style"),t=t.substr(0,i+7)+"border-style:{{if progressWidth}}solid{{else}}none{{/if}};width:{{:progressWidth}}px;"+t.substr(i+7),f+=t):f+=this.nodeName=="#comment"?"":this.nodeName=="#text"?this.textContent?this.textContent.replace(/(\r\n|\n|\r)/gm,""):this.nodeValue.replace(/(\r\n|\n|\r)/gm,""):this.outerHTML}),i=n(this).clone().empty()[0].outerHTML,e=i.indexOf("style"),i=i.substr(0,e+7)+"left:{{:left}}px;width:{{:width}}px;"+i.substr(e+7),o=t.browserInfo().name=="msie"&&t.browserInfo().version<9?i.indexOf("<\/"+this.tagName+">"):i.indexOf("<\/"+this.tagName.toLowerCase()+">"),i=i.substr(0,o)+f+i.substr(o),u+=i):u+=this.nodeName=="#comment"?"":this.textContent?this.textContent.replace(/(\r\n|\n|\r)/gm,""):this.nodeValue.replace(/(\r\n|\n|\r)/gm,"")}),u=u.replace(RegExp((e._id+"src").toLowerCase(),"g"),"src")},_processMilestoneTemplate:function(i,r){var e=this,s=this.model,o=t.buildTag("div","",{},{}),u,f="";return u=i.charAt(0)=="#"?n(i)[0].innerHTML:i,u=u.replace(/src/gi,e._id+"src"),n(o[0]).html(u),n(o[0].childNodes).each(function(){var u,t,i;n(this).hasClass("e-gantt-template-milestone")?(u="e-gantt-milestone "+n(this).attr("class"),n(this).css({width:s.taskbarHeight-3+"px",position:"absolute","z-index":"3"}).attr("class",u),t=this.outerHTML,i=t.indexOf("style"),t=t.substr(0,i+7)+"left:{{:left -"+r+"}}px;"+t.substr(i+7),f+=t):f+=this.nodeName=="#comment"?"":this.textContent?this.textContent.replace(/(\r\n|\n|\r)/gm,""):this.nodeValue.replace(/(\r\n|\n|\r)/gm,"")}),f=f.replace(RegExp((e._id+"src").toLowerCase(),"g"),"src")},_processTaskLabelTemplate:function(t){var i="";return t.charAt(0)=="#"?n(t)[0]&&(i=n(t)[0].innerHTML):i=document.getElementById(t)?n("#"+t)[0].innerHTML:t,i},_sortHolidays:function(n){var i=t.Query().sortBy("day",t.sortOrder.Ascending);return t.DataManager(n).executeLocal(i)},_rendercalendar:function(n,i,r,u,f,e){var h=this,c=h.model,s=c.rowHeight-6,o={};return u=t.buildTag("div.e-gantthistocalender.e-rverticalline"),f=t.buildTag("div.e-gantthistocalender.e-lverticalline"),e=t.buildTag("div.e-gantthistocalender.e-horizontalline"),f.css({left:n+"px",width:"1px",height:s+"px","border-left-width":"1px","border-left-style":"solid",position:"absolute","margin-top":"6px"}),o.leftVerticalDiv=f,u.css({left:i+"px",width:"1px",height:s+"px","border-left-width":"1px","border-left-style":"solid",position:"absolute","margin-top":"6px"}),o.rightVerticalDiv=u,e.css({left:n+"px",width:r+"px",top:"6px","border-top-style":"solid","border-top-width":"1px",position:"absolute"}),o.horiDiv=e,o},_processWeekHistoMode:function(i){var h=this,u=h.model,c=0,a,b=this.model.ganttInstance,o=u.perDayWidth,k=u.rowHeight,v=[],d=h.model.scheduleWeeks.length,p=n.extend(!0,[],h._nonWorkingDayIndex),l=new Date(u.projectStartDate),r=n("<div><\/div>"),f,s,e,y=new Date(u.projectEndDate),w;if(u.scheduleHeaderSettings.scheduleHeaderType=="week"&&y.setDate(y.getDate()+6),t.isNullOrUndefined(h._isCalendarExist)){do u.includeWeekend==!0&&(p=[]),w=p.indexOf(l.getDay()),w!=-1||b._getHolidayByDay(l)?(f!=null&&s!=null&&e!=null&&(r.append(s),r.append(e),r.append(f),f=s=e=null,c+=o,o=u.perDayWidth),c+=u.perDayWidth):o==u.perDayWidth&&e==null&&f==null&&s==null?(a=c+o,v=h._rendercalendar(c,a,o,f,s,e),f=v.rightVerticalDiv,s=v.leftVerticalDiv,e=v.horiDiv,r.append(s),r.append(e),r.append(f)):(o+=u.perDayWidth,a=c+o,f.css("left",a),e.css("width",o)),l.setDate(l.getDate()+1);while(l.getTime()<=y.getTime());r.append(s);r.append(e);r.append(f);h._isCalendarExist=r.html();i+=r.html()}else i+=h._isCalendarExist;return i},_processYearHistoMode:function(i){var u=this,y=u.model,h,c,p,w=u.model.ganttInstance,o=y.holidays,f=[],s=[],l,a,v,e=n("<div><\/div>"),r;if(o=u._sortHolidays(o),t.isNullOrUndefined(u._isCalendarExist)){for(r=0;r<o.length;r++)f.push(w._getTaskLeft(o[r].day,!1));for(f.push(u._scheduleYearWidth),r=0;r<f.length;r++)h=r==0?0:f[r-1]+y.perDayWidth,c=f[r]-1,p=c-h,s=u._rendercalendar(h,c,p,l,a,v),l=s.rightVerticalDiv,a=s.leftVerticalDiv,v=s.horiDiv,e.append(a),e.append(v),e.append(l);u._isCalendarExist=e.html();i+=e.html()}else i+=u._isCalendarExist;return i},_processHourHistoMode:function(t){var o=this.model,c=0,k=o.rowHeight-6,s,l=n("<div><\/div>"),a=[],i,u,r,h=0,b=o.ganttInstance,v=o.scheduleHours,y="",f=o.perMinuteWidth*this._totalInterval,p=n.extend(!0,[],this._nonWorkingDayIndex),e,w;if(this._isCalendarExist)return t+this._isCalendarExist;for(o.includeWeekend==!0&&(p=[]),e=0;e<v.length;e++)if(w=p.indexOf(v[e].getDay()),w!=-1||b._getHolidayByDay(v[e])||!this._checkIsWorkingHour(v[e])){i&&u&&r&&(l.append(u),l.append(r),l.append(i),y+=l.html(),i=u=r=null,h=s=0);c+=f;continue}else i&&u&&r?(s+=f,h+=f,i.css("left",s),r.css("width",h)):(s=c+f,h+=f,a=this._rendercalendar(c,s,h,i,u,r),i=a.rightVerticalDiv,u=a.leftVerticalDiv,r=a.horiDiv),c+=f;return this._isCalendarExist=y,t+y},_processDayHistoMode:function(t){var o=this,r=o.model,f=0,d=r.ganttInstance,g=r.rowHeight-6,w,s=n("<div><\/div>"),l,a,v,y=o.model.scheduleDays,i,h=r._nonWorkingTimeRange,p="",c=[],b=n.extend(!0,[],o._nonWorkingDayIndex),e,k,u;if(this._isCalendarExist)return t+this._isCalendarExist;for(r.includeWeekend==!0&&(b=[]),e=0;e<y.length;e++){if(k=b.indexOf(y[e].getDay()),k!=-1||d._getHolidayByDay(y[e])){i=r.perDayWidth;f+=i;continue}for(u=0;u<h.length;u++){if(i=(h[u].to-h[u].from)*r.perHourWidth,h[u].isWorking==!1){f+=i;continue}w=f+i;c=o._rendercalendar(f,w,i,l,a,v);l=c.rightVerticalDiv;a=c.leftVerticalDiv;v=c.horiDiv;s.append(a);s.append(v);s.append(l);p+=s.html();f+=i}}return this._isCalendarExist=p,t+p},_checkIsWorkingHour:function(n){for(var i,r=this.model.ganttInstance,u=r._workingTimeRanges,f=r._getSecondsInDecimal(n),e=!1,t=0;t<u.length;t++)if(i=u[t],f>=i.from&&f<i.to){e=!0;break}return e},_processHistoTemplate:function(n){for(var f=this,e=f.model,s,r=n.workTimelineRanges,h,o,u=e.scheduleHeaderSettings.scheduleHeaderType,t="",i=0;i<r.length;i++)o=e.rowHeight<=r[i].height?e.rowHeight-1:r[i].height,h=e.rowHeight-o-1,s=r[i].isOverAllocated?"e-ganttoverallocate":"e-ganttnonoverallocate",t+="<div  class='e-gantthistobar "+s+"' style='left:"+r[i].left+"px;width: "+r[i].width+"px;height: "+o+"px;top:"+h+"px'><span class='e-gantthistoworklabel'>"+r[i].workPerDay+e._durationUnitEditText.hour[0]+"<\/span><\/div>";return u=="week"||u=="month"?t=f._processWeekHistoMode(t):u=="year"||u=="quarterYear"||u=="halfYear"?t=f._processYearHistoMode(t):u=="day"?t=f._processDayHistoMode(t):u=="hour"&&(t=f._processHourHistoMode(t)),t},_createHistogramTaskbarTemplate:function(){var i=this,o=i.model,e,r={},u,f;r["_"+i._id+"SelectState"]=n.proxy(i._SelectState,i);r["_"+i._id+"histoTemplate"]=n.proxy(i._processHistoTemplate,i);r["_"+i._id+"rowClassName"]=t.TreeGrid._getrowClassName;r["_"+i._id+"expandStatus"]=n.proxy(i._getExpandStatusRecord,i);n.views.helpers(r);u="<tr class='{{:~_"+i._id+"rowClassName()}} e-ganttrowcell'style='display:{{:~_"+i._id+"expandStatus(#data)}};background-color:{{if rowBGColor }}{{:rowBGColor}}{{else}} none{{/if}};height:"+o.rowHeight+"px;'>";e="<td class='e-gantthistocell'>{{:~_"+i._id+"histoTemplate(#data)}}<\/td>";u+=e;u+="<\/tr>";f={};f[this._id+"_CustomTemplate2"]=u;n.templates(f)},_createTaskbarTemplate:function(){var i=this,u=i.model,c,l=u.scheduleHeaderSettings.scheduleHeaderType,vt,y=4,r,d,ui=0,f,e=0,s=0,p=0,w=0,o=0,a=!1,v=!1,g="",ft="",et="",nt="",tt=u.baselineColor,yt=u.taskbarTemplate,pt,ot=!1,wt=!1,bt=u.parentTaskbarTemplate,kt,dt=!1,gt=u.milestoneTemplate,ni=!1,ti="",ii=u.leftTaskLabelTemplate,b=!1,it="",ri=u.rightTaskLabelTemplate,k=!1,rt="",h={},st,ht,at;h["_"+i._id+"SelectState"]=n.proxy(i._SelectState,i);h["_"+i._id+"getType"]=i._getTypedata;h["_"+i._id+"expander"]=i._addRecordExpandCollapse;h["_"+i._id+"milestoneMapping"]=i._isMilestone;h["_"+i._id+"taskNameWidth"]=i._taskNameContainerWidth;h["_"+i._id+"resources"]=n.proxy(i._getResourceInfo,i);h["_"+i._id+"rowClassName"]=t.TreeGrid._getrowClassName;h["_"+i._id+"expandStatus"]=n.proxy(i._getExpandStatusRecord,i);h["_"+i._id+"borderRadius"]=i._getBorderRadius;i._fontSize=i._getFontSize();i._resizerRightAdjust=i._fontSize*.8;i._resizerMargin=i._getMargin();i._resizerLeftAdjust=i._getResizerLeftAdjust();l=="week"?c=u.scheduleWeeks.length*i._scheduleWeekWidth:l=="year"||l=="quarterYear"||l=="halfYear"?c=i._scheduleYearWidth:l=="month"?c=i._scheduleMonthWidth:l=="day"?c=u.scheduleDays.length*u.perHourWidth*24:l=="hour"&&(c=u.scheduleHours.length*u.perMinuteWidth*i._totalInterval);u.renderBaseline?(u.taskbarHeight+y<=u.rowHeight?(st=u.taskbarHeight,d=0):(st=u.taskbarHeight-y,d=-4),r=st,ui=0,f=u.rowHeight-y-5):(r=u.taskbarHeight,f=u.rowHeight-10);o=r/5;e=Math.floor(u.taskbarHeight/2);i._milesStoneWidth=e*2;i._connectorPointWidth=s=r/2;p=s/2;w=s-s/2;n.views.helpers(h);u.progressMapping||(this.model.showProgressStatus=!1);u.resourceInfoMapping||(u.showResourceNames=!1);yt&&(ot=!0,ht=this._processTaskbarTemplate(yt,r),pt=ht.template,wt=ht.isProgressbarTemplate);bt&&(dt=!0,kt=this._processParentTaskbarTemplate(bt,r));gt&&(ni=!0,ti=this._processMilestoneTemplate(gt,e));ii&&(it=this._processTaskLabelTemplate(ii),b=!0);ri&&(rt=this._processTaskLabelTemplate(ri),k=!0);this.model.leftTaskLabelMapping&&b==!1&&(a=!0,g=i._getLeftTaskLabel());this.model.rightTaskLabelMapping&&k==!1&&(v=!0,nt=i._getRightTaskLabel());this.model.taskbarHeight<45&&(ft="<div class='e-connectortouchpoint' style='right:0px;width:20px;margin-top:"+(s-20)/2+"px;height:20px;border-radius:10px'><\/div>",et="<div class='e-connectortouchpoint' style='left:0px;width:20px;margin-top:"+(s-20)/2+"px;height:20px;border-radius:10px'><\/div>");var ct=Math.round(-((this.model.rowHeight-1)/2)),lt="<tr class='{{:~_"+i._id+"rowClassName()}}  {{if isSelected && ~_"+i._id+"SelectState()}}e-ganttrowcell {{:~_"+i._id+"expander()}} e-gantt-mouseclick{{else}}e-ganttrowcell {{:~_"+i._id+"expander()}}{{/if}}'style='display:{{:~_"+i._id+"expandStatus(#data)}};background-color:{{if rowBGColor }}{{:rowBGColor}}{{else}} none{{/if}};height:"+u.rowHeight+"px;'>",ut="{{:~_"+i._id+"borderRadius()}}";vt="{{if ~_"+i._id+"getType()}}<td class='e-chartcell'><div class='e-tasknameContainer' style='height:"+(this.model.rowHeight-1)+"px;width:{{:~_"+i._id+"taskNameWidth()}};overflow:hidden;text-overflow: ellipsis;'><div class='e-taskbarname'  style='overflow: hidden;text-overflow: ellipsis;margin-top:5px;margin-right:30px;height:"+f+"px;font-weight:bold'>{{if "+b+"}}"+it+"{{else "+this.model.showTaskNames+" && left > 0 && !"+a+" }}<span style='line-height:"+f+"px;'>{{:taskName}}<\/span>{{else "+a+"}}<span style='line-height:"+f+"px;'>"+g+"<\/span>{{/if}}<\/div><\/div><\/td><td  class='e-chartcell' style='width:"+c+"px; vertical-align:middle;'><div class='e-parentContainer{{if !isAutoSchedule}} e-manualParenttaskbar{{/if}}' style='height:"+(this.model.taskbarHeight-1)+"px;z-index:3;'>{{if !isAutoSchedule}}<div class='e-gantt-manualparenttaskbar {{:~_"+i._id+"expander()}}' style='left: {{:left}}px;height:"+o+"px; width: {{:width}}px;'><div class='e-gantt-manualparenttaskbar-left' style='height:"+r+"px;border-left-width:"+o+"px;border-bottom:"+o+"px solid transparent;'><\/div><div class='e-gantt-manualparenttaskbar-right' style='left:{{:width - "+parseInt(o)+"}}px;height:"+r+"px;border-right-width:"+o+"px;border-bottom:"+o+"px solid transparent;'><\/div><div class='e-taskbarresizer-right' style='left:{{:width -"+o+"}}px;width:"+o+"px;height:"+r+"px;font-size:"+i._fontSize+"px;position:absolute;z-index:10;'><\/div><\/div>{{/if}}{{if "+dt+"}}"+kt+"{{else}}<div class='e-gantt-parenttaskbar-innerdiv {{:~_"+i._id+"expander()}} e-parentTask' style='margin-top:{{if !isAutoSchedule}}"+o*2+"{{/if}}px;background-color:{{if parentTaskbarBackground }}{{:parentTaskbarBackground}}{{else}} "+this.model.parentTaskbarBackground+"{{/if}}; left:{{if isAutoSchedule}}{{:left}}{{else}}{{:manualLeft}}{{/if}}px;width:{{if isAutoSchedule}}{{:width}}{{else}}{{:manualWidth}}{{/if}}px;height:{{if isAutoSchedule}}"+r+"{{else}}"+o*3+"{{/if}}px;'><div  class='e-gantt-parenttaskbar-progress {{:~_"+i._id+"expander()}} e-parentTask progressbar' style='top:-1px;border-style:{{if progressWidth}}solid{{else}}none{{/if}}; left:-1px;width:{{:progressWidth}}px;position:absolute;background-color:{{if parentProgressbarBackground }}{{:parentProgressbarBackground}}{{else}} "+this.model.parentProgressbarBackground+"{{/if}};z-index:3;border-top-right-radius:{{if isAutoSchedule}}"+ut+"{{else}}"+o+"{{/if}}px;border-bottom-right-radius:{{if isAutoSchedule}}"+ut+"{{else}}"+o+"{{/if}}px;height:{{if isAutoSchedule}}"+r+"{{else}}"+o*3+"{{/if}}px;'><\/div><\/div>{{/if}}<\/div>{{if "+this.model.renderBaseline+" && baselineStartDate && baselineEndDate }}<div  class='e-baselinebar' style='margin-top:"+d+"px;left:{{:baselineLeft}}px;width:{{:baselineWidth}}px;height:"+y+"px;background-color: "+tt+";position:absolute;z-index:3;box-sizing:border-box;-moz-box-sizing:border-box;'><\/div>{{/if}}<\/td><td class='e-chartcell' ><div class='e-resourceinfo' style='left:{{if isAutoSchedule}}{{:left+width+30}}{{else}}{{if (left+width)>(manualLeft+manualWidth)}}{{:left+width+30}}{{else}}{{:manualLeft+manualWidth+30}}{{/if}}{{/if}}px;margin:0;margin-left:5px;margin-top:"+ct+"px;position:absolute;background-color:transparent;font-weight:bold;height:"+(this.model.rowHeight-1)+"px;'><div class='e-resourcename'  style='overflow-y:hidden;margin-top:5px;height:"+f+"px;margin-right:30px;outline:none;'>{{if "+k+"}}"+rt+"{{else "+this.model.showResourceNames+" && left > 0 && !"+v+" }}<span style='line-height:"+f+"px;'>{{:~_"+i._id+"resources(#data)}}<\/span>{{else "+v+"}}<span style='line-height:"+f+"px;'>"+nt+"<\/span>{{/if}}<\/div><\/div><\/td>{{else ~_"+i._id+"milestoneMapping()}}<td class='e-chartcell'><div class='e-tasknameContainer' style='height:"+(this.model.rowHeight-1)+"px;width:{{:~_"+i._id+"taskNameWidth()}};overflow:hidden;text-overflow:ellipsis;'><div class='e-taskbarname'  style='overflow: hidden;text-overflow: ellipsis;margin-top:5px;height:"+f+"px;margin-right:30px;'>{{if "+b+"}}"+it+"{{else "+this.model.showTaskNames+" && left > 0 && !"+a+" }}<span style='line-height:"+f+"px;'>{{:taskName}}<\/span>{{else "+a+"}}<span style='line-height:"+f+"px;'>"+g+"<\/span>{{/if}}<\/div><\/div><\/td><td class='e-chartcell' style='width:"+c+"px;'><div class='e-gantt-milestone-container' style=height:"+(this.model.taskbarHeight-1)+"px;><div class='e-connectorpoint-left' style='left:{{:left-"+(s+e)+"}}px;width:"+s+"px;margin-top:"+w+"px;height:"+r/2+"px;border-radius:"+p+"px;'>"+ft+"<\/div>{{if "+ni+"}}"+ti+"{{else}}<div class='e-gantt-milestone' style='position:absolute;left:{{:left-"+e+"}}px;'><div class='e-gantt-milestone e-milestone-top{{if startDate == null && endDate == null}} e-unscheduletaskbar{{/if}}'  style='border-right-width:"+e+"px;border-left-width:"+e+"px;border-bottom-width:"+e+"px; border-right-color:transparent;border-left-color:transparent;border-style:none solid solid;border-top: none;'><\/div><div class='e-gantt-milestone e-milestone-bottom{{if startDate == null && endDate == null}} e-unscheduletaskbar{{/if}}'  style='top:"+e+"px;border-right-width:"+e+"px; border-left-width:"+e+"px; border-top-width:"+e+"px; border-right-color:transparent;border-left-color:transparent;border-style:solid solid none; border-bottom: none;'><\/div><\/div>{{/if}}<div class='e-connectorpoint-right' style='left:{{:(left+"+e+")}}px;width:"+s+"px;margin-top:"+w+"px;height:"+r/2+"px;border-radius:"+p+"px;'>"+et+"<\/div><\/div>{{if "+this.model.renderBaseline+" && baselineStartDate && baselineEndDate}}<div class='e-baseline-gantt-milestone-container' ><div class='e-baseline-gantt-milestone' style='position:absolute;left:{{:baselineLeft -"+e+"}}px;z-index:2;'><div class='e-baseline-gantt-milestone e-baseline-milestone-top'  style='z-index:2;top:"+-this.model.taskbarHeight+"px;border:"+e+"px solid transparent;border-top: none;border-bottom-color: "+tt+";'><\/div><div class='e-baseline-gantt-milestone e-baseline-milestone-bottom'  style='z-index:2;top:"+(e-this.model.taskbarHeight)+"px;border:"+e+"px solid transparent;border-bottom: none;border-top-color: "+tt+";'><\/div><\/div><\/div>{{/if}}<\/td><td class='e-chartcell' ><div class='e-resourceinfo' style='margin-top:5px;left:{{:left+56}}px;margin:0;margin-left:5px;margin-top:"+ct+"px;height:"+(this.model.rowHeight-1)+"px;position:absolute;background-color:transparent;'><div class='e-resourcename'  style='overflow-y:hidden;margin-top:5px;height:"+f+"px;margin-right:30px;'>{{if "+k+"}}"+rt+"{{else "+this.model.showResourceNames+" && left > 0 && !"+v+" }}<span style='line-height:"+f+"px;'>{{:~_"+i._id+"resources(#data)}}<\/span>{{else "+v+"}}<span style='line-height:"+f+"px;'>"+nt+"<\/span>{{/if}}<\/div><\/div><\/td>{{else}}<td class='e-chartcell'><div class='e-tasknameContainer' style='height:"+(this.model.rowHeight-1)+"px;width:{{:~_"+i._id+"taskNameWidth()}};overflow:hidden;text-overflow: ellipsis;'><div class='e-taskbarname'  style='overflow: hidden;text-overflow: ellipsis;margin-top:5px;height:"+f+"px;margin-right:30px;'>{{if "+b+"}}"+it+"{{else "+this.model.showTaskNames+" && left > 0 && !"+a+" }}<span style='line-height:"+f+"px;'>{{:taskName}}<\/span>{{else "+a+"}}<span style='line-height:"+f+"px;'>"+g+"<\/span>{{/if}}<\/div><\/div><\/td><td class='e-chartcell' style='width:"+c+"px;'>{{if (startDate != null || endDate != null || duration != null)}}<div  class='e-childContainer' style='height:"+(this.model.taskbarHeight-1)+"px;'><div class='e-connectorpoint-left' style='left:{{:left-"+s+"}}px;width:"+s+"px;margin-top:"+w+"px;height:"+r/2+"px;border-radius:"+p+"px'>"+ft+"<\/div>{{if (endDate == null && duration == null)}}<div  class='e-gantt-childtaskbar {{if !isAutoSchedule}} e-manualchildtaskbar{{/if}} e-gantt-unscheduletaskbar-left' style='left:{{:left}}px;height:"+r+"px;'><\/div>{{/if}}{{if (startDate == null && duration == null)}}<div  class='e-gantt-childtaskbar {{if !isAutoSchedule}} e-manualchildtaskbar{{/if}} e-gantt-unscheduletaskbar-right' style='left:{{:left}}px;height:"+r+"px;'><\/div>{{/if}}{{if (startDate == null && endDate == null)}}<div class='e-taskbarresizer-left e-icon' style='left:{{:left+2-"+i._resizerLeftAdjust+"}}px;width:10px;margin-top:"+i._resizerMargin+"px;height:"+r+"px;font-size:"+i._fontSize+"px;'><\/div><div  class='e-gantt-childtaskbar {{if !isAutoSchedule}} e-manualchildtaskbar{{/if}} e-gantt-unscheduletaskbar' style='left:{{:left}}px;height:"+r+"px;width:{{:width}}px;'><\/div><div class='e-taskbarresizer-right e-icon' style='left:{{:left+width-"+i._resizerRightAdjust+"}}px;width:10px;height:"+r+"px;font-size:"+i._fontSize+"px;position:absolute;z-index:2;margin-top:"+i._resizerMargin+"px;'><\/div>{{/if}}{{if (startDate != null && endDate != null && duration != null)}}<div class='e-taskbarresizer-left e-icon' style='left:{{:left+2-"+i._resizerLeftAdjust+"}}px;width:10px;margin-top:"+i._resizerMargin+"px;height:"+r+"px;font-size:"+i._fontSize+"px;'><\/div>{{if "+ot+"}}"+pt+"{{else}}<div  class='e-gantt-childtaskbar {{if isCritical}} e-criticaltaskbar{{/if}} {{if !isAutoSchedule}} e-manualchildtaskbar{{/if}}' style='left:{{:left}}px;width:{{:width}}px;height:"+r+"px;background-color:{{if taskbarBackground }}{{:taskbarBackground}}{{else}} "+this.model.taskbarBackground+"{{/if}};'><div  class='e-gantt-childtaskbar-progress  {{if isAutoSchedule}} progressbar{{else}} e-manualprogressbar{{/if}} {{if isCritical}} e-criticalprogressbar{{/if}}' style='border-style:{{if progressWidth}}solid{{else}}none{{/if}};width:{{:progressWidth}}px;text-align:right;line-height:"+(r-1)+"px;height:"+this.model.progressbarHeight*(r/100)+"px; top:-1px;left:-1px;position:absolute;background-color:{{if progressbarBackground }}{{:progressbarBackground}}{{else}} "+this.model.progressbarBackground+"{{/if}};border-top-right-radius:"+ut+"px;border-bottom-right-radius:"+ut+"px;'>{{if "+this.model.showProgressStatus+"}}<span class='e-tasklabel' style='line-height:"+(r-1)+"px'>{{:status}}%<\/span>{{/if}}<\/div><\/div>{{/if}}{{if "+(!ot||wt)+"}}<div class='e-progressbarresizer-right' style='left:{{:left+progressWidth-10}}px;width:20px;margin-top:"+(r-5)+"px;height:15px;position:absolute;z-index:5;'><div class='e-progressbarhandler' style='top:10px;position:absolute;z-index:-1;'><div class='e-progresshandler-element'><\/div><\/div><div class='e-progressbarhandler' style='top:5px;position:absolute;z-index:-1;'><div class='e-progresshandlerafter-element'><\/div><\/div><\/div>{{/if}}<div class='e-taskbarresizer-right e-icon' style='left:{{:left+width-"+i._resizerRightAdjust+"}}px;width:10px;height:"+r+"px;font-size:"+i._fontSize+"px;position:absolute;z-index:2;margin-top:"+i._resizerMargin+"px;'><\/div>{{/if}}<div class='e-connectorpoint-right' style='left:{{:left+width}}px;width:"+s+"px;margin-top:"+w+"px;height:"+r/2+"px;border-radius:"+p+"px'>"+et+"<\/div>{{/if}}<\/div>{{if "+this.model.renderBaseline+" && baselineStartDate && baselineEndDate }}<div  class='e-baselinebar' style='margin-top:"+d+"px;left:{{:baselineLeft}}px;width:{{:baselineWidth}}px;height:"+y+"px;background-color: "+tt+";position:absolute;z-index:3;box-sizing:border-box;-moz-box-sizing:border-box;'><\/div>{{/if}}<\/td><td class='e-chartcell' ><div class='e-resourceinfo' style='left:{{:left+width+30}}px;margin:0;margin-left:5px;margin-top:"+ct+"px;height:"+(this.model.rowHeight-1)+"px;position:absolute;text-align:left;background-color:transparent;'><div class='e-resourcename'  style='overflow-y:hidden;margin-top:5px;height:"+f+"px;margin-right:30px;'>{{if "+k+"}}"+rt+"{{else "+this.model.showResourceNames+" && left > 0 && !"+v+" }}<span style='line-height:"+f+"px;'>{{:~_"+i._id+"resources(#data)}}<\/span>{{else "+v+"}}<span style='line-height:"+f+"px;'>"+nt+"<\/span>{{/if}}<\/div><\/div><\/td>{{/if}}";lt+=vt;lt+="<\/tr>";at={};at[this._id+"_CustomTemplate2"]=lt;n.templates(at)},_getResourceInfo:function(n){var t=null,u,i,r;if(n.resourceInfo!=null){if(u=n.resourceInfo.length,u>0){for(i=0;i<u;i++)r=n.resourceInfo[i][this.model.resourceUnitMapping],t==null?(t=n.resourceInfo[i][this.model.resourceNameMapping],r!=100&&(t+="["+r+"%]")):(t+=" , "+n.resourceInfo[i][this.model.resourceNameMapping],r!=100&&(t+="["+r+"%]"));return t}return String.empty}return String.empty},_getrowClassName:function(){var n="gridrowtaskId",t=this;return t.data.parentItem&&(n+=t.data.parentItem.taskId.toString()),n+="level",n+t.data.level.toString()},_getExpandStatusRecord:function(n){var t=this;return t._getExpandStatus(n)?"table-row":"none"},_isMilestone:function(){return this.data.isMilestone?!0:!1},_taskNameContainerWidth:function(){var n;return n=this.data.hasChildRecords&&!this.data.isAutoSchedule?this.data.left<this.data.manualLeft?this.data.left-10:this.data.manualLeft-10:this.data.left-10,n<0&&(n=0),n+"px"},_addRecordExpandCollapse:function(){return this.data.expanded?"e-chartexpand":!this.data.expanded&&this.data.hasChildRecords?"e-chartcollapse":!1},_getTypedata:function(){return this.data.hasChildRecords||this.data.eResourceTaskType=="groupTask"},_getBorderRadius:function(){var n=this,t=n.data.width-n.data.progressWidth;return t<=4?4-t:0},_getHeightValue:function(){return this.data.ParentIndex*this.data.RowHeight>this.data.ChildIndex*this.data.RowHeight?this.data.ParentIndex*this.data.RowHeight-this.data.ChildIndex*this.data.RowHeight:this.data.ChildIndex*this.data.RowHeight-this.data.ParentIndex*this.data.RowHeight},_createConnectorLineTemplate:function(){var i=this,t=i.model.connectorlineWidth>4?4:i.model.connectorlineWidth,s,u,r=i.model.connectorLineBackground,f={},e,h,o;f["_"+i._id+"getWidthVal"]=i._getWidth;f["_"+i._id+"getTop"]=i._getPredecessorTop;f["_"+i._id+"getPosition"]=i._getParentPosition;f["_"+i._id+"setContainerWidthSSType2"]=i._getContainerWidthSSType2;f["_"+i._id+"setInnerChildWidthSSType2"]=i._getInnerChildWidthSSType2;f["_"+i._id+"setInnerElementLeftSSType2"]=i._getInnerElementLeftSSType2;f["_"+i._id+"setInnerElementWidthSSType2"]=i._getInnerElementWidthSSType2;f["_"+i._id+"isMilestone"]=i._isTaskMilestone;f["_"+i._id+"isMilestoneParent"]=i._isMilestoneParent;f["_"+i._id+"getHeightValue"]=i._getHeightValue;i.model.renderBaseline?(s=0,u=i.model.rowHeight/2-s):u=i.model.rowHeight/2;n.views.helpers(f);e="<div  id='ConnectorLine{{:ConnectorLineId}}' style='background-color=black'>";h="{{if ~_"+i._id+"getPosition()=='FSType1'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft+ParentWidth}}px;top:{{:(ParentIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='FSType1'><div class='e-line' style='left:{{if milestoneParent}}-7px{{else}}0px{{/if}};width:{{if milestoneParent}}{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+t+"-2}}px{{else}}{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+t+"-10}}px{{/if}};border-top:"+t+"px solid "+r+";position:relative'><\/div><div class='e-line' style='left:{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+t+"-10}}px;width:0px;border-right:"+t+"px solid "+r+";border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid "+r+";position:relative'><\/div><div class='e-line' style='left:{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+t+"-10}}px;width:10px;border-top:"+t+"px solid "+r+";position:relative'><\/div><div class='e-connectorline-rightarrow' style='left:{{:(ChildLeft - (ParentLeft + ParentWidth + 10))}}px;border-left: 10px solid "+r+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else  ~_"+i._id+"getPosition()=='FSType2'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft}}px;top:{{:(ParentIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='FSType2'><div class='e-line' style='left:{{if milestoneParent}}{{:ParentWidth-7}}px{{else}}{{:ParentWidth}}px{{/if}};width:{{if milestoneParent}}17px{{else}}10px{{/if}};border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{:ParentWidth+10-"+t+"}}px;border-left:"+t+"px solid;width:0px;border-top:{{:~_"+i._id+"getHeightValue()-14-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 20))}}px;width:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 30 )}}px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 20))}}px;width:0px;border-top:{{:14-"+t+"}}px solid;border-left:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 20))}}px;width:10px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-connectorline-rightarrow' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 10))}}px;border-left: 10px solid "+r+";border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;top:{{:-6-"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='FSType3'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft-20}}px;top:{{:(ChildIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='FSType3'><div class='e-connectorline-rightarrow' style='left:10px;border-left: 10px solid "+r+";border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;top:{{:-5-"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='width:10px;border-top:"+t+"px solid;border-color:"+r+";position:relative;top:-"+(13+(t-1)*2)+"px;'><\/div><div class='e-line' style='width:"+t+"px;border-top:{{:~_"+i._id+"getHeightValue()-14-"+t+"}}px solid;border-color:"+r+";position:relative;top:-"+(13+(t-1)*2)+"px'><\/div><div class='e-line' style='width:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 30)}}px;border-top:"+t+"px solid;border-color:"+r+";position:relative;top:-"+(13+(t-1)*2)+"px;'><\/div><div class='e-line' style='left:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 30)}}px;width:0px;border-left:"+t+"px solid;height:{{:14-"+t+"}}px;border-color:"+r+";position:relative;top:-"+(13+(t-1)*2)+"px;'><\/div><div class='e-line' style='{{if ~_"+i._id+"isMilestoneParent()}}left:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 14)}}px;width:16px;{{else}}left:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 20)}}px;width:10px;{{/if}}border-top:"+t+"px solid;border-color:"+r+";position:relative;top:-"+(13+(t-1)*2)+"px;'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='FSType4'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft+ParentWidth}}px;top:{{:(ChildIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='FSType4'><div class='e-connectorline-rightarrow' style='left:{{:(ChildLeft - (ParentLeft + ParentWidth + 10))}}px;border-left: 10px solid "+r+";top:{{:-5-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='left:{{:(ChildLeft - (ParentLeft + ParentWidth) - 20)}}px;top:-"+(13+(t-1)*2)+"px;width:10px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='top:-"+(13+(t-1)*2)+"px;left:{{:(ChildLeft - (ParentLeft + ParentWidth) - 20)}}px;width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='{{if ~_"+i._id+"isMilestoneParent()}}left:-6px;{{/if}}top:-"+(13+(t-1)*2)+"px;width:{{if ~_"+i._id+"isMilestoneParent()}}{{:(ChildLeft-(ParentLeft + ParentWidth+20 )+ 6)+"+t+"}}px;{{else}}{{:(ChildLeft-(ParentLeft + ParentWidth + 20))+"+t+"}}px;{{/if}}border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='SSType4'}}<div class='e-connectorlineContainer'  style='left:{{:ParentLeft-10}}px;top:{{:(ChildIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='SSType4'><div class='e-connectorline-rightarrow' style='left:{{:ChildLeft-ParentLeft}}px;border-left: 10px solid "+r+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='top:-"+(13+(t-1)*2)+"px;width:{{:ChildLeft-ParentLeft}}px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='top:-"+(13+(t-1)*2)+"px;width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='top:-"+(13+(t-1)*2)+"px;width:10px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='SSType3'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft-20}}px;top:{{:(ChildIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='SSType3'><div class='e-connectorline-rightarrow' style='left:10px;border-left: 10px solid "+r+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='top:-"+(13+(t-1)*2)+"px;width:10px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='top:-"+(13+(t-1)*2)+"px;width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='top:-"+(13+(t-1)*2)+"px;width:{{:ParentLeft-ChildLeft+20}}px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='SSType2'}}<div class='e-connectorlineContainer' style='left:{{:~_"+i._id+"setInnerElementLeftSSType2()}}px;top:{{:(ParentIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='SSType2'><div class='e-line' style='width:{{:~_"+i._id+"setInnerChildWidthSSType2()}}px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='width:{{:~_"+i._id+"setInnerElementWidthSSType2()}}px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-connectorline-rightarrow' style='left:{{:~_"+i._id+"setInnerElementWidthSSType2()}}px;border-left: 10px solid "+r+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='SSType1'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft-20}}px;top:{{:(ParentIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='SSType1'><div class='e-line' style='width:{{:ParentLeft-ChildLeft+20}}px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='width:10px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-connectorline-rightarrow' style='left:10px;border-left: 10px solid "+r+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='FFType1'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft+ChildWidth}}px;top:{{:(ParentIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='FFType1'><div class='e-line' style='left:{{if ~_"+i._id+"isMilestoneParent()}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))-10}}px;{{else}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))}}px;{{/if}}width:{{if ~_"+i._id+"isMilestoneParent()}}30px;{{else}}20px;{{/if}}border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{if ~_"+i._id+"isMilestoneParent()}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;{{else}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;{{/if}}width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{if ~_"+i._id+"isMilestone()}}4px;{{else}}10px;{{/if}}width:{{if ~_"+i._id+"isMilestone()}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+16}}px;{{else}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+10}}px;{{/if}}border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-connectorline-leftarrow' style='{{if ~_"+i._id+"isMilestone()}}left:-6px;{{/if}}border-right: 10px solid "+r+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='FFType2'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft+ParentWidth}}px;top:{{:(ParentIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='FFType2'><div class='e-line' style='{{if ~_"+i._id+"isMilestoneParent()}}left:-6px;{{/if}}width:{{if ~_"+i._id+"isMilestoneParent()}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+26}}px;{{else}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;{{/if}}border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{if ~_"+i._id+"isMilestone()}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+4}}px;{{else}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+10}}px;{{/if}}width:{{if ~_"+i._id+"isMilestone()}}16px;{{else}}10px;{{/if}}border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-connectorline-leftarrow' style='left:{{if ~_"+i._id+"isMilestone()}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))-6}}px;{{else}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))}}px;{{/if}}border-right: 10px solid "+r+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='FFType3'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft+ChildWidth}}px;top:{{:(ChildIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='FFType3'><div class='e-connectorline-leftarrow' style='{{if ~_"+i._id+"isMilestone()}}left:-6px;{{/if}}border-right: 10px solid "+r+";top:{{:-5-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='{{if ~_"+i._id+"isMilestone()}}left:4px;width:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+16}}px;{{else}}left:10px;width:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+10}}px;{{/if}}top:-"+(13+(t-1)*2)+"px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;top:-"+(13+(t-1)*2)+"px;width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='{{if ~_"+i._id+"isMilestoneParent()}}left:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))-6}}px;width:26px;{{else}}left:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))}}px;width:20px;{{/if}}top:-"+(13+(t-1)*2)+"px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='FFType4'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft+ParentWidth}}px;top:{{:(ChildIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='FFType4'><div  class='e-connectorline-leftarrow' style='{{if ~_"+i._id+"isMilestone()}}left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))-6}}px;{{else}}left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))}}px;{{/if}}border-right: 10px solid "+r+";top:{{:-5-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='{{if ~_"+i._id+"isMilestone()}}left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+4}}px;width:16px;{{else}}left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+10}}px;width:10px;{{/if}}top:-"+(13+(t-1)*2)+"px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;top:-"+(13+(t-1)*2)+"px;width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='{{if ~_"+i._id+"isMilestoneParent()}}left:-6px;width:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+26}}px;{{else}}width:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;{{/if}}top:-"+(13+(t-1)*2)+"px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><\/div>{{else  ~_"+i._id+"getPosition()=='SFType4'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft-10}}px;top:{{:(ChildIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='SFType4'><div class='e-connectorline-leftarrow' style='left:{{if ~_"+i._id+"isMilestone()}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+4}}px;{{else}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+10}}px;{{/if}}border-right: 10px solid "+r+";top:{{:-5-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='left:{{if ~_"+i._id+"isMilestone()}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+14}}px;width:16px;{{else}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+20}}px;width:10px;{{/if}}top:-"+(13+(t-1)*2)+"px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;top:-"+(13+(t-1)*2)+"px;width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-15-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='top:-"+(13+(t-1)*2)+"px;width:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='top:-"+(13+(t-1)*2)+"px;width:0px;border-left:"+t+"px solid;border-top:{{:15-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='top:-"+(13+(t-1)*2)+"px;width:10px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='SFType3'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft+ChildWidth}}px;top:{{:(ChildIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='SFType3'><div class='e-connectorline-leftarrow' style='{{if ~_"+i._id+"isMilestone()}}left:-6px;{{/if}}border-right: 10px solid "+r+";top:{{:-5-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><div class='e-line' style='{{if ~_"+i._id+"isMilestone()}}left:4px;width:16px;{{else}}left:10px;width:10px;{{/if}}top:-"+(13+(t-1)*2)+"px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:20px;top:-"+(13+(t-1)*2)+"px;width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:20px;top:-"+(13+(t-1)*2)+"px;width:{{:(ParentLeft-(ChildLeft + ChildWidth + 20))+"+t+"}}px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><\/div>{{else  ~_"+i._id+"getPosition()=='SFType1'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft-10}}px;top:{{:(ParentIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='SFType1'><div class='e-line' style='width:10px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-15-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='width:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;width:0px;border-left:"+t+"px solid;border-top:{{:15-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='{{if ~_"+i._id+"isMilestone()}}left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+(15-"+t+")}}px;width:16px;{{else}}left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+20}}px;width:10px;{{/if}}border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-connectorline-leftarrow' style='left:{{if ~_"+i._id+"isMilestone()}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+4}}px;{{else}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+10}}px;{{/if}}border-right: 10px solid "+r+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{else ~_"+i._id+"getPosition()=='SFType2'}}<div class='e-connectorlineContainer'  style='left:{{:ChildLeft+ChildWidth}}px;top:{{:(ParentIndex * RowHeight) +"+u+"}}px;width:1px;height:{{:~_"+i._id+"getHeightValue()}}px;position:absolute' data-connectortype='SFType2'><div class='e-line' style='left:{{:((ParentLeft) - (ChildLeft + ChildWidth))-10}}px;width:10px;border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='left:{{:((ParentLeft) - (ChildLeft + ChildWidth))-10}}px;width:0px;border-left:"+t+"px solid;border-top:{{:~_"+i._id+"getHeightValue()-"+t+"}}px solid;border-color:"+r+";position:relative'><\/div><div class='e-line' style='{{if ~_"+i._id+"isMilestone()}}left:0px;width:{{:((ParentLeft) - (ChildLeft + ChildWidth))-10}}px;{{else}}left:10px;width:{{:((ParentLeft) - (ChildLeft + ChildWidth))-20}}px;{{/if}}border-top:"+t+"px solid;border-color:"+r+";position:relative'><\/div><div class='e-connectorline-leftarrow' style='left:{{if ~_"+i._id+"isMilestone()}}-6px;{{else}}0px;{{/if}}border-right: 10px solid "+r+";top:{{:-6-"+t+"}}px;border-bottom-width:{{:5+"+t+"}}px;border-top-width:{{:5+"+t+"}}px;width:0;height:0;position:relative'><\/div><\/div>{{/if}}";e+=h;e+="<\/div>";o={};o[this._id+"ConnectorLineTemplate"]=e;n.templates(o)},_isTaskMilestone:function(){return this.data.milestoneChild?!0:!1},_isMilestoneParent:function(){return this.data.milestoneParent?!0:!1},_getInnerChildWidthSSType2:function(){return this.data.ParentLeft+this.data.ParentWidth<this.data.ChildLeft?10:this.data.ParentLeft==this.data.ChildLeft?20:this.data.ParentLeft+this.data.ParentWidth>=this.data.ChildLeft?10:this.data.ChildLeft-this.data.ParentLeft},_getInnerElementLeftSSType2:function(){return this.data.ParentLeft==this.data.ChildLeft?this.data.ParentLeft-20:this.data.ParentLeft-10},_getInnerElementWidthSSType2:function(){return this.data.ParentLeft==this.data.ChildLeft?10:this.data.ChildLeft-this.data.ParentLeft},_getContainerWidthSSType2:function(){return this.data.ParentLeft==this.data.ChildLeft?20:this.data.ChildLeft-this.data.ParentLeft},_getPredecessorTop:function(){return this.data.ParentIndex>this.data.ChildIndex?!0:!1},_getParentPosition:function(){if(this.data.ParentIndex<this.data.ChildIndex){if(this.data.Type=="FF")return this.data.ChildLeft+this.data.ChildWidth>=this.data.ParentLeft+this.data.ParentWidth?"FFType2":"FFType1";if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft>this.data.ParentLeft+this.data.ParentWidth+25){if(this.data.Type=="FS")return"FSType1";if(this.data.Type=="SF")return"SFType1";if(this.data.Type=="SS")return"SSType2";if(this.data.Type=="FF")return"FFType2"}else if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft<this.data.ParentLeft+this.data.ParentWidth||this.data.ParentLeft==this.data.ChildLeft||this.data.ParentLeft>this.data.ChildLeft){if(this.data.ParentLeft>this.data.ChildLeft+this.data.ChildWidth+25&&this.data.Type=="SF")return"SFType2";if(this.data.ParentLeft>this.data.ChildLeft){if(this.data.Type=="SS")return"SSType1";if(this.data.Type=="SF")return"SFType1";if(this.data.Type=="FF")return"FFType1"}else if(this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth&&this.data.Type=="FF")return"FFType2";if(this.data.Type=="FS")return"FSType2";if(this.data.Type=="SS")return"SSType2";if(this.data.Type=="FF")return"FFType1";if(this.data.Type=="SF")return"SFType1"}else if(this.data.ParentLeft<this.data.ChildLeft){if(this.data.Type=="FS")return"FSType2";if(this.data.Type=="FF")return"FFType2";if(this.data.Type=="SS")return"SSType2";if(this.data.Type=="SF")return"SFType1"}}else if(this.data.ParentIndex>this.data.ChildIndex)if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft>this.data.ParentLeft+this.data.ParentWidth){if(this.data.Type=="FS")return 30>=this.data.ChildLeft-(this.data.milestoneParent?this.data.ParentLeft+this.data.ParentWidth+4:this.data.ParentLeft+this.data.ParentWidth)?"FSType3":"FSType4";if(this.data.ParentLeft<this.data.ChildLeft||this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth){if(this.data.Type=="SS")return"SSType4";if(this.data.Type=="FF")return"FFType4";if(this.data.Type=="SF")return"SFType4"}else if(this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth&&this.data.Type=="FF")return"FFType4"}else if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft<this.data.ParentLeft+this.data.ParentWidth||this.data.ParentLeft==this.data.ChildLeft||this.data.ParentLeft>this.data.ChildLeft){if(this.data.ChildLeft+this.data.ChildWidth<=this.data.ParentLeft+this.data.ParentWidth){if(this.data.Type=="FF")return"FFType3";if(this.data.Type=="SF")return this.data.ChildLeft+this.data.ChildWidth+25<this.data.ParentLeft?"SFType3":"SFType4";if(this.data.Type=="SS")return this.data.ChildLeft<=this.data.ParentLeft?"SSType3":"SSType4"}else if(this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth){if(this.data.Type=="FF")return"FFType4";if(this.data.Type=="SF")return"SFType4";if(this.data.Type=="SS")return this.data.ChildLeft<=this.data.ParentLeft?"SSType3":"SSType4"}if(this.data.Type=="FS")return"FSType3"}else if(this.data.ParentLeft<this.data.ChildLeft){if(this.data.Type=="FS")return"FSType3";if(this.data.Type=="SS")return"SSType4";if(this.data.Type=="FF")return"FFType4";if(this.data.Type=="SF")return"SFType4"}return!1},_getWidth:function(){return this.data.ChildLeft+this.data.ChildWidth<this.data.ParentLeft+this.data.ParentWidth?this.data.ParentWidth:this.data.ChildWidth+this.data.ParentWidth},_renderCustomDaySchedule:function(){var n=this,r=n.model,o=0,s,l,a=this.getRecordsHeight(),w=n.model.scheduleDays.length,v=n._$weekendsContainer.children(".e-secondary_canvas").length==0?!1:!0,f=v?n._$weekendsContainer.children(".e-secondary_canvas"):t.buildTag("div.e-secondary_canvas","",{height:a+"px"},{}),u=r._nonWorkingTimeRange,y=n._nonWorkingDayIndex,h,c,e,i;for(v&&f.empty(),h=0;h<w;h++){if(r.highlightWeekends){for(l=!1,c=0;c<=y.length;c++)n.model.scheduleDays[h].getDay()==y[c]&&(e=n.model.perDayWidth,s=t.buildTag("div.e-ganttworkingtime e-ganttdayweekend","",{left:o+"px",width:e+"px",background:this.model.weekendBackground,height:a+"px"},{}),f.append(s),o+=e,l=!0);if(l)continue}for(i=0;i<u.length;i++){var p=u[i].isWorking?u[i].color:r.highlightNonWorkingTime?r.nonWorkingBackground:null,b=u[i].isWorking?"e-ganttworkingrange":r.highlightNonWorkingTime?"e-ganttnonworkingrange":"",e=(u[i].to/3600-u[i].from/3600)*r.perHourWidth;s=t.buildTag("div.e-ganttworkingtime "+b,"",{left:o+"px",width:e+"px",background:p,height:a+"px"},{});t.isNullOrUndefined(p)||f.append(s);o+=e}}v?n._$weekendsContainer.append(f):(n._$weekendsContainer.html(f),n._$bodyContent.append(n._$weekendsContainer))},_renderWeekends:function(){for(var f,i,e,n=this,v=n.model,r=0,y=n.model.perDayWidth+1,o=this.getRecordsHeight(),p=n.model.scheduleWeeks.length,s,h=t.buildTag("div.e-secondary_canvas","",{height:o+"px"},{}),u=v.scheduleHeaderSettings.weekStartDay,c=u>=0&&u<7?u:0,l=6-c,w=n._nonWorkingDayIndex.length,a=0;a<p;a++){for(i=0;i<w;i++)n._nonWorkingDayIndex[i]!=6?(e=l+n._nonWorkingDayIndex[i]+1,f=e>=7?n._nonWorkingDayIndex[i]-c:e):f=l,s=t.buildTag("div.e-weekends","",{left:r+n.model.perDayWidth*f+"px",width:y+"px",height:o+"px","background-color":this.model.weekendBackground},{}),h.append(s);r=r+this._scheduleWeekWidth}n._$weekendsContainer.html(h);n._$bodyContent.append(n._$weekendsContainer)},_renderStripLines:function(n){for(var u,h,r=this,f=this.getRecordsHeight(),c=n.length,e,o,l=r.model.projectStartDate,a=this.model.perDayWidth,s=t.buildTag("div.e-stripLines","",{height:f+"px"},{}),i=0;i<c;i++)e=this._getDateFromFormat(n[i].day),o=(e-this._getDateFromFormat(l))/864e5*a,n[i].lineWidth=n[i].lineWidth>30?30:n[i].lineWidth,u=t.buildTag("div.e-stripline#stripline"+[i]+"","",{left:o+"px",width:"1px",height:f+"px","border-left-width":n[i].lineWidth+"px","border-left-color":n[i].lineColor,"border-left-style":n[i].lineStyle},{}),h=t.buildTag("span.e-striplinespan",n[i].label,{"background-color":n[i].lineColor},{}),n[i].day&&n[i].day.length>0&&(n[i].label&&n[i].label.length>0&&u.append(h),s.append(u));r._$stripLineContainer.append(s);r._$bodyContent.append(r._$stripLineContainer)},_getProgressWidth:function(n,t){return n*t/100},_getProgressPercent:function(n,t){return Math.ceil((t/n*100).toFixed(2))},_renderHoliday:function(n){var i=this,l=i.model.scheduleHeaderSettings.scheduleHeaderType,c=this._getDateFromFormat(n.day),a=i.model.scheduleWeeks.length,v=i.model.scheduleMonths.length,y=i.model.scheduleYears.length,p=i.model.scheduleDays.length,o=0,u,s,f,e,w=i.model.updatedRecords.length,h,r;o=(c-this._getDateFromFormat(i.model.projectStartDate))/864e5*this.model.perDayWidth;h=this.getRecordsHeight();u=n.label!=null?n.label.length:0;n.background==null&&(n.background="white");r=".e-holiday-label";t.browserInfo().name=="msie"&&t.browserInfo().version<9&&(r=".e-holiday-label-ie8");s=i.model.scheduleHeaderSettings.scheduleHeaderType!="day"?t.buildTag("div"+r,n.label,{top:i._getHolidayLabelHeight(u)+"px"},{}):t.buildTag("div"+r,n.label,{bottom:i._getHolidayLabelHeight(u)+"px"},{});f=t.buildTag("div.e-secondary-canvas-holiday");e=t.buildTag("div.e-holidays","",{left:o+"px",width:i.model.perDayWidth+"px",height:h+"px",background:n.background},{});n.label!=null&&e.append(s);f.append(e);i._$secondaryCanvas.append(f);i._$bodyContent.append(i._$secondaryCanvas)},_getHolidayLabelHeight:function(){var n=this,r=n.model,t=n._getHeight(),i=r.updatedRecords.length*n.model.rowHeight;return t>0?t/2:n._viewportHeight<i?n._viewportHeight/2:i/2},updateWorkWeek:function(n){var t=this,i=t.model;i.workWeek=n;t._getNonWorkingDayIndex()},updateDragAndDrop:function(n){var t=this,i=t.model;i.allowDragAndDrop=n},updateVirtualization:function(t,i){var r=this,u=this.model,f=this.model.ganttInstance,e;u.enableVirtualization=t;r.setUpdatedRecords(f.model.currentViewData,f.model.updatedRecords,f.model.flatRecords,f.model.ids);r._totalCollapsedRecordCount=i;u.enableVirtualization?u.enableVirtualization&&r._scrollTop!=0&&(r._getVisibleRowRange(),e=r._scrollTop,e-=r._rowMargin,n("#ganttViewTable"+r._id+"").css({top:e+"px"}),n("#ganttgridLinesTable"+r._id+"").css({top:e+"px"})):(r._$ganttViewTable.css({top:0}),n("#ganttgridLinesTable"+r._id).css({top:0}));u.selectedRowIndex=f.selectedRowIndex();r.refreshHelper(u.currentViewData,u.updatedRecords,r._totalCollapsedRecordCount)},_getNonWorkingDayIndex:function(){for(var i=this,u=i.model,r=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],f=r.length,t=u.workWeek.slice(),e=t.length,n=0;n<e;n++)t[n]=t[n].toLowerCase();for(i._nonWorkingDayIndex=[],n=0;n<f;n++)t.indexOf(r[n])==-1&&i._nonWorkingDayIndex.push(n)},_destroy:function(){var t=this;t.element.off();n(document.body).unbind("touchmove",n.proxy(t.handleMouseMove,t));n(document).unbind("mouseup",n.proxy(t._tooltipMouseup,t));t.element.empty().removeClass("e-ganttchart-core e-ganttchart"+t.model.cssClass);n("#"+this._id+"_connectorLineEdit_wrapper").clearQueue();n("#"+this._id+"_connectorLineEdit_wrapper").stop();n("#"+t._id+"_connectorLineEdit").data("ejDialog")&&n("#"+t._id+"_connectorLineEdit").data("ejDialog").destroy();n("#"+t._id+"_connectorLineEdit").remove();n("#"+this._id+"_connectorLineEdit_wrapper").remove();n("#"+this._id+"_connectorLineEdit_type_popup_wrapper").remove()},_renderConnectorDialog:function(i){var r=this,tt=r.model,f={},y,p,e=tt.connectorLineDialogText,o=t.buildTag("div.e-connectordialog","",{width:"300px"},{id:this._id+"_connectorLineEdit"}),w=t.buildTag("div","",{},{id:this._id+"_connectorLineEditForm"}),d=t.buildTag("table.e-zerospace","",{}),s=t.buildTag("tbody","",{}),h,c,l,a,v,k,nt,u;d.append(s);h=t.buildTag("tr","",{});s.append(h);h.append("<td class='e-editlabel'><div>"+e.from+"<\/div><\/td>");h.append("<td class='e-editlabel'>:<\/td>");h.append("<td class='e-editvalue' ><div id='"+this._id+"_connectorLineEdit_from'><\/div><\/td>");c=t.buildTag("tr","",{});s.append(c);c.append("<td class='e-editlabel'><div>"+e.to+"<\/div><\/td>");c.append("<td class='e-editlabel'>:<\/td>");c.append("<td class='e-editvalue'><div id='"+this._id+"_connectorLineEdit_to'><\/div><\/td>");l=t.buildTag("tr","",{});s.append(l);l.append("<td class='e-editlabel'><div>"+e.type+"<\/div><\/td>");l.append("<td class='e-editlabel'>:<\/td>");l.append("<td class='e-editvalue'><input id='"+this._id+"_connectorLineEdit_type'/><\/td>");a=t.buildTag("tr","",{});s.append(a);a.append("<td class='e-editlabel'><div>"+e.lag+"<\/div><\/td>");a.append("<td class='e-editlabel'>:<\/td>");a.append("<td class='e-editvalue'><input class='e-field e-ejinputtext' id='"+this._id+"_connectorLineEdit_lag'/><\/td>");w.append(d);var it=t.buildTag("input.e-editform-btn","",{},{type:"button",value:e.okButtonText,id:this._id+"_connectorLineEdit_ok"}),rt=t.buildTag("input.e-editform-btn","",{"margin-left":"15px"},{type:"button",value:e.cancelButtonText,id:this._id+"_connectorLineEdit_cancel"}),ut=t.buildTag("button","",{"border-radius":"3px"},{title:e.deleteButtonText,id:this._id+"_connectorLineEdit_delete"}),g=t.buildTag("table","",{width:"100%"}),b=t.buildTag("tbody");if(g.append(b),v=t.buildTag("div","",{float:"right","z-index":"10","margin-top":"10px"}),k=t.buildTag("div","",{float:"left","z-index":"10","margin-top":"10px"}),v.append(it),k.append(ut),v.append(rt),v.appendTo(b),k.appendTo(b),w.append(g),o.append(w),f.requestType="beforeDependencyEditDialogOpen",f.data=r._predecessorInfo,r._trigger("actionBegin",f)){r._clearConnectorLineSelection();return}o.insertAfter(r.element);r._renderConnectorDialogElements(o,f.data);i.pageX&&i.pageY&&(y=i.pageX,p=i.pageY);nt=e.title;u={};u.enableResize=!1;u.enableRTL=!1;u.maxWidth=300;u.width=300;u.title=nt;u.position={X:y,Y:p};u.enableAnimation=!1;u.cssClass=r.model.cssClass;u.beforeOpen=function(){var i=n("#"+r._id+"_connectorLineEdit_wrapper"),t={};i.addClass("e-ganttdialog");t.x=y;t.y=p;r._calculateConnectorDialogPosition(this,i,t)};u.beforeClose=function(){r._clearConnectorLineSelection()};o.ejDialog(u);r._isPredecessorEditOpen=!0;f.requestType="afterDependencyEditDialogOpen";f.element=o;r._trigger("actionBegin",f)||(n(o).ejDialog("refresh"),o=f.element)},_calculateConnectorDialogPosition:function(t,i,r){var a=this,y=a.model,v=y.ganttInstance,u={},p={},s,h,f;u=a._getOffsetRect(v.element[0]);u.bottom=u.top+v.element[0].offsetHeight;u.right=u.left+n(v.element).width();s=n(i).outerHeight();h=n(i).outerWidth();p=a._getOffsetRect(i[0]);var e=r.x,o=r.y,c=o+s,l=e+h;u.right<l?e-h>u.left?e-=h:(f=Math.abs(l-u.right),e-=f):n(window).width()+n(window).scrollLeft()<l&&(f=Math.abs(l-(n(window).width()+n(window).scrollLeft())),e-=f);u.bottom<c?o-s>u.top?o-=s:(f=Math.abs(c-u.bottom),o-=f):n(window).height()+n(window).scrollTop()<c&&(f=Math.abs(c-(n(window).height()+n(window).scrollTop())),o-=f);t.setModel({position:{X:e,Y:o}})},_renderConnectorDialogElements:function(i,r){var u=this,h=u.model,c=h.predecessorCollectionText;n(i).find("#"+this._id+"_connectorLineEdit_delete").ejButton({size:"normal",contentType:"imageonly",prefixIcon:"e-icon e-deleteline",cssClass:u.model.cssClass,click:function(){r.requestType="delete";u._predecessorEdited(r);u.closePredecessorDialog()}});n(i).find("#"+this._id+"_connectorLineEdit_ok").ejButton({size:"normal",cssClass:u.model.cssClass,click:function(){var t=n("#"+u._id+"_connectorLineEdit_lag").val();r.offset=t;r.requestType="updateDependencyValue";u._predecessorEdited(r);u.closePredecessorDialog()}});n(i).find("#"+this._id+"_connectorLineEdit_cancel").ejButton({size:"normal",cssClass:u.model.cssClass,click:function(){u.closePredecessorDialog()}});n(i).find("#"+this._id+"_connectorLineEdit_type").ejDropDownList({dataSource:c,fields:{text:"text",value:"id"},value:r.linkType,cssClass:u.model.cssClass,change:function(n){r.linkType=n.value;r.linkText=n.text},width:"100%"});var l=u._getOffsetValue(r),a=t.isNullOrUndefined(r.fromSno)?r.fromId:r.fromSno,v=t.isNullOrUndefined(r.toSno)?r.toId:r.toSno,f=r.fromName,o=f.length>25?f.substring(0,20)+"...":f,o=o+" ("+a+")",e=r.toName,s=e.length>25?e.substring(0,20)+"...":e,s=s+" ("+v+")";n(i).find("#"+this._id+"_connectorLineEdit_lag").css("width","50%").val(l);n(i).find("#"+this._id+"_connectorLineEdit_from").text(o);n(i).find("#"+this._id+"_connectorLineEdit_from").attr({title:f});n(i).find("#"+this._id+"_connectorLineEdit_to").text(s);n(i).find("#"+this._id+"_connectorLineEdit_to").attr({title:e})},closePredecessorDialog:function(){var t=this;n("#"+t._id+"_connectorLineEdit").ejDialog("close");t._isPredecessorEditOpen=!1;t._clearConnectorLineSelection()},_predecessorEdited:function(n){n.requestType=="delete"?this.model.ganttInstance.deleteDependency(n.fromId,n.toId):n.requestType=="updateDependencyValue"&&this.model.ganttInstance.updateDependency(n.fromId,n.toId,n.linkType,n.offset)},_clearConnectorLineSelection:function(){var t=this;n(t._hoverConnectorLineElement).find(".e-line").removeClass("e-connectorline-hover");n(t._hoverConnectorLineElement).find(".e-connectorline-rightarrow").length>0?n(t._hoverConnectorLineElement).find(".e-connectorline-rightarrow").removeClass("e-connectorline-rightarrow-hover"):n(t._hoverConnectorLineElement).find(".e-connectorline-leftarrow").removeClass("e-connectorline-leftarrow-hover")}});t.ganttChartFeatures.timescale&&n.extend(t.GanttChart.prototype,t.ganttChartFeatures.timescale);t.ganttChartFeatures.resourceViewGantt&&n.extend(t.GanttChart.prototype,t.ganttChartFeatures.resourceViewGantt);jQuery.uaMatch=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}}}(jQuery,Syncfusion),function(n,t){t.gridFeatures=t.gridFeatures||{};t.gridFeatures.gridResize=function(t){this.$headerTable=t.getHeaderTable();this.gridInstance=t;this._colMinWidth=15;this._$visualElement=n();this._currentCell=-1;this._allowStart=!1;this._oldWidth=null;this._orgX=null;this._orgY=null;this._extra=null;this._expand=!1;this._target=null;this._cellIndex=-1};t.gridFeatures.gridResize.prototype={_mouseHover:function(t){var r,h,o,c,s;if(!this._$visualElement.is(":visible")&&(this._allowStart=!1,n(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),r=n(t.target),n(t.target).hasClass("e-filtericon")&&(n(t.target).css("cursor")=="col-resize"||n(t.target).closest("tr").css("cursor")=="col-resize")&&(n(t.target).css("cursor","pointer"),n(t.target).closest("tr").css("cursor","pointer")),r.hasClass("e-headercell"))){var f=t.target,u=f.getBoundingClientRect(),i=0,e=0;(t.type="mousemove")?(i=t.clientX,e=t.clientY):(t.type="touchmove")?(i=evt.originalEvent.changedTouches[0].clientX,e=evt.originalEvent.changedTouches[0].clientY):(t.type="MSPointerMove")&&(i=t.originalEvent.clientX,e=t.originalEvent.clientY);h=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderContent().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left:this.gridInstance.getHeaderTable().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left;(i>=u.left+document.documentElement.scrollLeft+f.offsetWidth-5||i<=u.left+3)&&i<h&&i>=u.left&&e<=u.top+document.documentElement.scrollTop+t.target.offsetHeight?(o=i>u.left+3?n(t.target).find(".e-headercelldiv"):n(t.target).prevAll("th:visible:first").find(".e-headercelldiv"),c=window.pageXOffset||document.documentElement.scrollTop||document.body.scrollTop,s=this.gridInstance.element.find(".e-headercell").not(".e-detailheadercell").offset().left+10-c,(this.gridInstance.model.enableRTL&&i<=s||!this.gridInstance.model.enableRTL&&i>=s)&&((this.gridInstance.model.showStackedHeader||o.length)&&n.inArray(n(o).attr("data-ej-mappingname"),this.gridInstance._disabledResizingColumns)==-1?(this.gridInstance.model.showStackedHeader&&n(r.parents("thead")).find("tr").addClass("e-resizedragicon"),this.gridInstance.model.showStackedHeader||r.parent().addClass("e-resizedragicon"),this._currentCell=n(t.target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell:visible").index(f):this.gridInstance.getHeaderContent().find(".e-headercell:visible").not(".e-stackedHeaderCell,.e-detailheadercell").index(f),this.gridInstance.model.enableRTL&&(this._currentCell=this._currentCell-1),this._allowStart=!0):(r.parent().css("cursor","pointer"),this._currentCell=-1))):(this.gridInstance.element.find(".e-columnheader").removeClass("e-resizedragicon"),this._currentCell=-1)}},_start:function(t,i){var s=this.gridInstance.getHeaderTable().find(".e-columnheader"),h,e,r,c,o,u,f;if(e=n(this._target).hasClass("e-stackedHeaderCell")?s.find(".e-headercell").not(".e-hide"):s.find(".e-headercell").not(".e-stackedHeaderCell,.e-hide"),this._currentCell!=-1&&this._currentCell<e.length&&(r=e[this._currentCell]),typeof r!="undefined")if(c=r.getBoundingClientRect(),h=this._tableY=c.top+parseInt(navigator.userAgent.indexOf("WebKit")!=-1?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart){if(o=this._$visualElement=n(document.createElement("div")),u=this.gridInstance.element.find(".e-gridcontent").first().height()+this.gridInstance.element.find(".e-gridheader").height(),this.gridInstance.model.showStackedHeader&&this.gridInstance.model.stackedHeaderRows.length>0){var l=this.gridInstance.getHeaderTable().find("tr.e-columnheader"),v=l.length,a=n(this._target).parent("tr")[0].rowIndex;for(f=0;f<a;f++)u=u-n(l[f]).height()}o.addClass("e-reSizeColbg").appendTo(this.gridInstance.element).attr("unselectable","on").css("visibility","hidden");this.gridInstance._resizeTimeOut=setTimeout(function(){o.css({visibility:"visible",height:u+"px",cursor:"col-resize",left:t,top:h,position:"fixed"})},100);this._oldWidth=r.offsetWidth;this._orgX=t;this._orgY=i;this._extra=t-this._orgX;this._expand=!0}else this._currentCell=-1},_mouseMove:function(n){if(this._expand){var t=0,i=0;n.type=="mousemove"?(t=n.clientX,i=n.clientY):n.type=="MSPointerMove"?(t=n.originalEvent.clientX,i=n.originalEvent.clientY):n.type=="touchmove"&&(t=n.originalEvent.changedTouches[0].clientX,i=n.originalEvent.changedTouches[0].clientY);t==0&&i==0&&navigator.userAgent.indexOf("WebKit")!=-1&&(t=n.pageX,i=n.pageY);t+=document.documentElement.scrollLeft;n.preventDefault();this._moveVisual(t)}else this._mouseHover(n)},_touchStart:function(t){var f,o,c,s,l,h,a;if(!this._$visualElement.is(":visible")){if(this._allowStart=!1,n(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),f=n(t.target),f.hasClass("e-headercell")){var u=t.target,r=u.getBoundingClientRect(),i=0,e=0;t.type=="touchstart"&&(i=t.originalEvent.changedTouches[0].clientX,e=t.originalEvent.changedTouches[0].clientY);o=this.gridInstance.element.children(".e-gridheader");c=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderContent().width()+o.find(".e-columnheader").offset().left:this.gridInstance.getHeaderTable().width()+o.find(".e-columnheader").offset().left;(i>=r.left+document.documentElement.scrollLeft+u.offsetWidth-10||i<=r.left+8)&&i<c&&i>=r.left&&e<=r.top+document.documentElement.scrollTop+t.target.offsetHeight?(s=i>r.left+8?n(t.target).find(".e-headercelldiv"):n(t.target).prevAll("th:visible:first").find(".e-headercelldiv"),l=window.pageXOffset||document.documentElement.scrollTop||document.body.scrollTop,h=this.gridInstance.element.find(".e-headercell").not(".e-detailheadercell").offset().left+10-l,(this.gridInstance.model.enableRTL&&i<=h||!this.gridInstance.model.enableRTL&&i>=h)&&((this.gridInstance.model.showStackedHeader||s.length)&&n.inArray(n(s).attr("data-ej-mappingname"),this.gridInstance._disabledResizingColumns)==-1?(this._currentCell=n(t.target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell:visible").index(u):this.gridInstance.getHeaderContent().find(".e-headercell:visible").not(".e-stackedHeaderCell,.e-detailheadercell").index(u),this.gridInstance.model.enableRTL&&(this._currentCell=this._currentCell-1),this._allowStart=!0):this._currentCell=-1)):this._currentCell=-1}if(this._allowStart){if(this._target=f,this.gridInstance.pluginName=="ejGrid"&&this.gridInstance.model.allowResizing){if(this._triggerResizeEvents("resizeStart",i))return}else if(this.gridInstance.pluginName=="ejTreeGrid"&&this.gridInstance.model.allowColumnResize&&this.gridInstance._triggerColumnResize("columnResizeStart",i,t))return;return a=this,i+=document.documentElement.scrollLeft,t.button!=2&&this._start(i,e),!1}return!0}},_getCellIndex:function(t){var o=n(t._target),i=t._target,f=i.getBoundingClientRect(),e=navigator.userAgent.indexOf("WebKit")!=-1?document.body.scrollLeft:document.documentElement.scrollLeft,r,u;return this._orgX<f.left+5+e&&(i=n(i).prevAll(":visible:first")[0]),r=i.cellIndex,u=r,t.gridInstance.model.groupSettings.groupedColumns.length&&(u=r-t.gridInstance.model.groupSettings.groupedColumns.length),u},_reSize:function(i){var ii=this,o,k,rt,v,d,vt,s,ut,y,ft,g,p,ot,st,tt,r,at;if(this._initialTableWidth=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderTable().first().parent().width()+this.gridInstance.getHeaderTable().last().parent().width():this.gridInstance.getHeaderTable().parent().width(),this.gridInstance.model.enableRTL&&(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell=this._currentCell-1:this.gridInstance.model.enableRTL||this._getResizableCell(),k=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns>0?this.gridInstance.getHeaderTable().find("thead"):n(this._target).parents("thead"),this._currentCell!=-1&&this._expand){this._expand=!1;var gt=n(this._target).hasClass("e-stackedHeaderCell")?k.find(".e-headercell:not(.e-detailheadercell)").filter(":visible"):k.find(".e-headercell:not(.e-detailheadercell,.e-stackedHeaderCell)").filter(":visible"),it=gt[this._currentCell],a=it.offsetWidth,u=i-this._orgX;if(this.gridInstance.model.enableRTL&&(u=-u),parseInt(u)+parseInt(a)>this._colMinWidth){if(u!=0&&k.css("cursor","default"),t.getObject("resizeSettings.resizeMode",this.gridInstance.model)=="nextcolumn"&&(rt=this.gridInstance.getHeaderTable().find("colgroup").find("col"),t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),rt=this.gridInstance._$headerCols),v=rt.filter(this._diaplayFinder).eq(!this.gridInstance.model.allowGrouping||!t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell:this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length),d=parseInt(v[0].style.width)),this._resizeColumnUsingDiff(a,u),o=this.gridInstance.element.find(".e-gridcontent").first(),vt=o.find("div").hasClass("e-content"),s=!t.isIOSWebView()&&this.gridInstance.getBrowserDetails(),s&&s.browser=="msie"&&this.gridInstance.model.allowScrolling&&(ut=this.gridInstance.getContentTable().width(),y=this.gridInstance._calculateWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns>0?this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterTable().last().width(y-this.gridInstance.getFooterContent().find(".e-frozenfootertdiv").width()):y>ut&&this.gridInstance.model.showSummary&&this.gridInstance.getFooterTable().width(y),parseInt(s.version,10)>8&&this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length&&(y>ut?this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",2e3/o.find("table").first().width()+"%"):(this.gridInstance.getContentTable().css("width","100%"),this.gridInstance._groupingAction(!0),this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",(this.gridInstance.getHeaderTable().find("colgroup").find("col").first().width()/o.find("table").first().width()*100).toFixed(2)+"%"))),this.gridInstance.getHeaderTable().parent().scrollLeft(o.find(".e-content").scrollLeft()-1)),this.gridInstance._colgroupRefresh(),this.gridInstance.model.allowTextWrap&&(this.gridInstance._isResized=!0,this.gridInstance.rowHeightRefresh()),this.gridInstance.model.groupSettings.groupedColumns.length&&!this.gridInstance.model.isEdit&&this.gridInstance._recalculateIndentWidth(),t.getObject("resizeSettings.resizeMode",this.gridInstance.model)!="normal")if(t.getObject("resizeSettings.resizeMode",this.gridInstance.model)=="nextcolumn"){ft=this.gridInstance.getHeaderTable().find("colgroup").find("col");g=this.gridInstance.getContentTable().find("colgroup").find("col");t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),ft=this.gridInstance._$headerCols,g=this.gridInstance._$contentCols);var f=this._currentCell+1,yt=ft.filter(this._diaplayFinder).eq(!this.gridInstance.model.allowGrouping||!t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)?f:f+this.gridInstance.model.groupSettings.groupedColumns.length),e=parseInt(yt[0].style.width)+(d-parseInt(v[0].style.width)),et;if(e<this._colMinWidth&&(e=this._colMinWidth),yt.width(e),this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length){var pt=this.gridInstance.getContentTable().find(".e-recordtable"),nt=pt.find("colgroup"),wt=this.gridInstance.getVisibleColumnNames().length;for(this.gridInstance.getContentTable().find(".e-detailrow").length&&(nt=nt.not(pt.find(".e-detailrow").find("colgroup")).get()),r=0;r<nt.length;r++)p=n(nt[r]).find("col").filter(this._diaplayFinder),p.length>wt&&p.splice(0,p.length-wt),n(p[f]).width(e)}if(this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){if(f>=0&&f<this.gridInstance.model.scrollSettings.frozenColumns&&this._getFrozenResizeWidth()+u>this.gridInstance.element.find(".e-headercontent").first().width())return;et=g.filter(this._diaplayFinder).eq(f)}else et=g.filter(this._diaplayFinder).eq(!this.gridInstance.model.allowGrouping||!t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)?f:f+this.gridInstance.model.groupSettings.groupedColumns.length);if(et.width(e),this.gridInstance._findColumnsWidth(),this.gridInstance.model.scrollSettings.frozenColumns>0&&n(it).is(":last-child")&&this.gridInstance.pluginName=="ejGrid"){var h=v.width()-d,c=this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width()+h,w=this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width()-h,l=parseInt(this.gridInstance.getHeaderContent().find(".e-movableheader")[0].style["margin-left"])+h;this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(c);this.gridInstance.getContent().find(".e-frozencontentdiv").width(c);this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(c);this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width(w);this.gridInstance.getContent().find(".e-movablecontentdiv").width(w);this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooterdiv").width(w);this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",l);this.gridInstance.getContent().find(".e-movablecontent").css("margin-left",l);this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooter").css("margin-left",l)}if(this.gridInstance.model.scrollSettings.frozenColumns>0&&n(it).is(":last-child")&&this.gridInstance.pluginName=="ejTreeGrid"){var h=v.width()-d,c=this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width()+h,w=this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width()-h,l=parseInt(this.gridInstance.getHeaderContent().find(".e-movableheader")[0].style["margin-left"])+h;this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(c);this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",l);this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width(w);this.gridInstance.getContent().find(".e-frozencontainer").width(c).next().css("margin-left",l+"px");this.gridInstance.getContent().find(".e-movablecontent").width(w);this.gridInstance.model.showTotalSummary&&(this.gridInstance._$totalSummaryRowContainer.find(".e-frozenfooterdiv").width(c),this.gridInstance._$totalSummaryRowContainer.find(".e-movablefooter").css("margin-left",l+"px"));this.gridInstance._renderScroller(!0)}this.gridInstance.model.scrollSettings.frozenColumns>0&&n(this._target).parent("tr").parents("div:first").hasClass("e-frozenheaderdiv")&&this.gridInstance.pluginName=="ejGrid"&&(this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(this._newWidth),this.gridInstance.getContent().find(".e-frozencontentdiv").width(this._newWidth),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(this._newWidth))}else this.gridInstance.model.scrollSettings.frozenColumns||(ot=this.gridInstance.getHeaderTable().width(),this.gridInstance.pluginName=="ejTreeGrid"||this.gridInstance.model.allowScrolling||this.gridInstance.model.isResponsive?this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().css("width",ot+parseInt(u)):n("#"+this.gridInstance._id).css("width",ot+parseInt(u)),this.gridInstance.model.scrollSettings.width+=parseInt(u),this.gridInstance.getContent().width()>this.gridInstance.getContentTable().width()?(this.gridInstance.getContentTable().addClass("e-tableLastCell"),this.gridInstance.getHeaderTable().addClass("e-tableLastCell")):(this.gridInstance.getContentTable().removeClass("e-tableLastCell"),this.gridInstance.getHeaderTable().removeClass("e-tableLastCell")));if(s.browser=="msie"||!s||!this.gridInstance.model.allowScrolling||this.gridInstance.model.scrollSettings.frozenColumns!=0||(this.gridInstance.model.columnLayout!="fixed"&&(this.gridInstance.getHeaderTable().width("100%"),this.gridInstance.getContentTable().width("100%")),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().width("100%"),st=this.gridInstance._calculateWidth(),(st<=this.gridInstance.getContentTable().width()||this.gridInstance.getHeaderTable().width()>this.gridInstance.getContentTable().width())&&this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().width(st)),this.gridInstance.model.allowResizing&&this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor")=="default"){var bt=this._currentCell,ht=n(this._target),kt=[],dt=[],e=a+u,ct={};if(this.gridInstance.model.showStackedHeader&&ht.hasClass("e-stackedHeaderCell")){var ni=ht.parent(".e-stackedHeaderRow").index(),ti=ht.text(),lt=this.gridInstance.model.stackedHeaderRows[ni].stackedHeaderColumns,b;for(r=0;r<lt.length;r++)lt[r].headerText==ti&&(b=lt[r].column);for(tt=b|[],t.isNullOrUndefined(b)||b instanceof Array||(tt=b.split(",")),r=0;r<tt.length;r++)at=this.gridInstance.getColumnIndexByField(tt[r]),kt.push(at),dt.push(this.gridInstance.model.columns[at]);ct={columnIndex:kt,column:dt,oldWidth:a,newWidth:e}}else ct={columnIndex:bt,column:this.gridInstance.model.columns[bt],oldWidth:a,newWidth:e};this.gridInstance._trigger("resized",ct)}this.gridInstance.model.allowScrolling&&(this.gridInstance.getScrollObject().refresh(this.gridInstance.model.scrollSettings.frozenColumns>0),this.gridInstance.model.isResponsive&&this.gridInstance.model.minWidth&&this.gridInstance.windowonresize(),!vt&&o.find("div").hasClass("e-content")&&this.gridInstance.refreshScrollerEvent(),this.gridInstance._isHscrollcss())}}this._target=null;this._$visualElement.remove();this._expand=!1;this._currentCell=-1;this._allowStart=!1},_getFrozenResizeWidth:function(){for(var t=this.gridInstance.getHeaderTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumns:0),i=0,n=0;n<t.length;n++)t.eq(n).css("display")!="none"&&(i+=parseInt(t[n].style.width.replace("px","")));return i},_diaplayFinder:function(){return n(this).css("display")!="none"},_resizeColumnUsingDiff:function(i,r){var lt=this,v,g,r,h,y,a,p,o,w,b,nt,ct,tt,ft,f,c,it,et,ot,st,k,rt,u;this._currntCe=this._currentCell;this._widthchanges(i,r);var e=this._newWidth,l=this._extra,ht=this._$headerCols,ut=this._$ContentCols,d,s=this._$headerCol,at=this._$frozenCols,a;if((this.gridInstance.pluginName!="ejTreeGrid"||!(r>0)||t.isNullOrUndefined(this.gridInstance._currentCell)||this.gridInstance.model.columns[this.gridInstance._currentCell].isFrozen!=!0||(u=this.gridInstance._frozenWidth(),!(u>this.gridInstance._gridWidth-68)))&&e>0&&r!=0){if(e<this._colMinWidth&&(e=this._colMinWidth),t.getObject("resizeSettings.resizeMode",this.gridInstance.model)=="nextcolumn"&&(v=s.next(),g=this.gridInstance.model.scrollSettings.frozenColumns&&this._currentCell==this.gridInstance.model.scrollSettings.frozenColumns-1?!0:!1,g&&(v=ht.eq(this.gridInstance.model.scrollSettings.frozenColumns)),(g||!s.is(":last-child"))&&v.width()+(s.width()-e)<=this._colMinWidth&&(e=s.width()+(v.width()-this._colMinWidth))),r=e-i,this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){if(this._currentCell>=0&&this._currentCell<this.gridInstance.model.scrollSettings.frozenColumns&&this._getFrozenResizeWidth()+r>this.gridInstance.element.find(".e-headercontent").first().width())return;d=ut.filter(this._diaplayFinder).eq(this._currentCell)}else d=ut.filter(this._diaplayFinder).eq(!this.gridInstance.model.allowGrouping||!t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell:this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length);if(n(this._target).parent("tr").hasClass("e-stackedHeaderRow")?this._resizeStackedHeaderColumn(n(this._target).parent("tr"),l,this._currntCe):s.outerWidth(e),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable()))if(this._$footerCols=this.gridInstance.getFooterTable().find("colgroup").find("col"),h=this.gridInstance.model.columns.length,this._$footerCols.length>h&&this._$footerCols.splice(0,this._$footerCols.length-h),y=this._$footerCols,a=y.filter(this._diaplayFinder).eq(this._currentCell),n(this._target).parent("tr").hasClass("e-stackedHeaderRow"))for(f=0;f<this._changedcell.length;f++)a=y.filter(this._diaplayFinder).eq(f),u=parseInt(l)+parseInt(y[f].style.width),u<this._colMinWidth&&(u=this._colMinWidth),a.outerWidth(u);else a.outerWidth(e);if(n(this._target).parent("tr").hasClass("e-stackedHeaderRow")){if(this.gridInstance.model.groupSettings.groupedColumns.length)for(p=this.gridInstance.getContentTable().find(".e-recordtable"),o=p.find("colgroup"),f=0;f<this._changedcell.length;f++)for(w=this._changedcell[f],b=0;b<o.length;b++)nt=n(o[b]).children().filter(this._diaplayFinder),u=parseInt(l)+parseInt(nt[w].style.width),u<this._colMinWidth&&(u=this._colMinWidth),n(nt[w]).width(u);for(ct=this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder).length,f=0;f<this._changedcell.length;f++)tt=this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder)[this._changedcell[f]],u=parseInt(l)+parseInt(tt.style.width),u<this._colMinWidth&&(u=this._colMinWidth),n(tt).outerWidth(u),this.gridInstance.model.isEdit&&this.gridInstance.model.allowGrouping&&this.gridInstance.model.groupSettings.groupedColumns.length==0&&(ft=this.gridInstance.getContentTable().find(".gridform").find("colgroup col").filter(this._diaplayFinder)[this._changedcell[f]],n(ft).outerWidth(u))}else{if(this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length){var p=this.gridInstance.getContentTable().find(".e-recordtable"),o=p.find("colgroup"),w=this._currentCell,h=this.gridInstance.getVisibleColumnNames().length;for(this.gridInstance.getContentTable().find(".e-detailrow").length&&(o=o.not(p.find(".e-detailrow").find("colgroup")).get()),f=0;f<o.length;f++)c=n(o[f]).find("col").filter(this._diaplayFinder),c.length>h&&c.splice(0,c.length-h),n(c[w]).width(e)}d.outerWidth(e);this.gridInstance.model.isEdit&&(it=this.gridInstance.getContentTable().find(".e-editedrow,.e-addedrow"),et=it.find("table").find("colgroup col"),ot=it.hasClass("e-addedrow")&&this.gridInstance.model.groupSettings.groupedColumns.length?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length-1:this._currentCell,st=et.filter(this._diaplayFinder).eq(ot),st.outerWidth(e))}if(this.gridInstance._findColumnsWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns&&t.getObject("resizeSettings.resizeMode",this.gridInstance.model)!="nextcolumn"&&this.gridInstance.pluginName=="ejGrid"){for(k=this.gridInstance.getContentTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings.frozenColumns),u=0,f=0;f<k.length;f++)u+=k[f].style.display=="none"?0:parseInt(k[f].style.width.replace("px",""));this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(u);rt=this.gridInstance.model.enableRTL?"margin-right":"margin-left";this.gridInstance.getContent().find(".e-frozencontentdiv").width(u).next().css(rt,u+"px");this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(u).next().css(rt,u+"px");this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(u)}this.gridInstance.pluginName=="ejTreeGrid"&&(!t.isNullOrUndefined(this.gridInstance._currentCell)&&this.gridInstance.model.columns[this.gridInstance._currentCell].isFrozen==!0&&t.getObject("resizeSettings.resizeMode",this.gridInstance.model)!="nextcolumn"||!this.gridInstance._isFrozenStackedResize&&this.gridInstance._isStackedResize&&this.gridInstance._frozenColumnsLength>0)&&(u=this.gridInstance._frozenWidth(),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(u),this.gridInstance.getContent().find(".e-frozencontainer").width(u).next().css("margin-left",u+"px"),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(u).next().css("margin-left",u+"px"),this.gridInstance.model.showTotalSummary&&(this.gridInstance._$totalSummaryRowContainer.find(".e-frozenfooterdiv").width(u),this.gridInstance._$totalSummaryRowContainer.find(".e-movablefooter").css("margin-left",u+"px")),this.gridInstance._findColumnsWidth(),this.gridInstance._renderScroller(!0));this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")||this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor","default")}},_resizeStackedHeaderColumn:function(t,i,r){var v,y,f,c,o;this._changedcell=[];var p=this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-detailheadercell"),u=0,e=0,s=p[r],l=n(s).attr("colspan"),w=i/l,a=n(s).parent("tr"),b=a.next(),h=s.cellIndex;for(this.gridInstance.model.groupSettings.showGroupedColumn&&(e=this.gridInstance.model.groupSettings.groupedColumns.length,u+=e);h>e;)h--,v=n(a).children("th").not(".e-detailheadercell")[h],u+=parseInt(n(v).attr("colspan"));for(this._currentCell=u,y=u+parseInt(l),f=u;f<y;f++)c=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder)[f],this._changedcell.push(f-e),o=parseInt(i)+parseInt(c.style.width),o<this._colMinWidth&&(o=this._colMinWidth),n(c).outerWidth(o)},_triggerResizeEvents:function(i,r){var k=this.gridInstance.getHeaderTable().find(".e-columnheader"),d=k.find(".e-headercell").filter(":visible"),s=this._cellIndex,v,f=n(this._target),y=[],p=[],h,e,l,u,b,tt,a,o;if(i=="resizeStart"&&(this._orgX=r,s=this._cellIndex=this._getCellIndex(this,r)),this.gridInstance.model.enableRTL&&(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?v=this._currentCell-1:(this.gridInstance.model.enableRTL||this._getResizableCell(),v=this._currentCell),h=d[v],e=h.offsetWidth,this.gridInstance.model.showStackedHeader&&f.hasClass("e-stackedHeaderCell")){var g=f.parent(".e-stackedHeaderRow").index(),nt=f.text(),w=this.gridInstance.model.stackedHeaderRows[g].stackedHeaderColumns,c;for(u=0;u<w.length;u++)w[u].headerText==nt&&(c=w[u].column);for(l=c|[],t.isNullOrUndefined(c)||c instanceof Array||(l=c.split(",")),u=0;u<l.length;u++)b=this.gridInstance.getColumnIndexByField(l[u]),y.push(b),p.push(this.gridInstance.model.columns[b])}return i=="resizeStart"?(o={},o=this.gridInstance.model.showStackedHeader&&f.hasClass("e-stackedHeaderCell")?{columnIndex:y,column:p,target:f,oldWidth:e}:{columnIndex:s,column:this.gridInstance.model.columns[s],target:n(h),oldWidth:e},this.gridInstance._trigger("resizeStart",o)):(tt=k.find(".e-headercell").not(".e-detailheadercell").filter(":visible"),a=r-this._orgX,this._widthchanges(e,a),this.gridInstance._colgroupRefresh(),o={},o=this.gridInstance.model.showStackedHeader&&f.hasClass("e-stackedHeaderCell")?{columnIndex:y,column:p,target:n(h),oldWidth:e,newWidth:this._newWidth,extra:a}:{columnIndex:s,column:this.gridInstance.model.columns[s],target:n(h),oldWidth:e,newWidth:this._newWidth,extra:a},this.gridInstance._trigger("resizeEnd",o))},_widthchanges:function(i,r){var u=this._$headerCols=this.gridInstance.getHeaderTable().find("colgroup").find("col"),s=this._$ContentCols=this.gridInstance.getContentTable().find("colgroup").find("col");t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),u=this._$headerCols=this.gridInstance._$headerCols,s=this._$ContentCols=this.gridInstance._$contentCols);var h=this._$headerCol=u.filter(this._diaplayFinder).eq(!this.gridInstance.model.allowGrouping||!t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell:this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length),l=this._$frozenCols=u.slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumns:0),f=h[0].style.width,e=f.indexOf("%")!=-1,o=!f||e?n(this._target).outerWidth():f,c=e?1:i/parseInt(o);this._extra=r/c;this._newWidth=parseInt(r)+parseInt(o)},_mouseUp:function(n){var i,r;if(this.gridInstance._resizeTimeOut&&(clearTimeout(this.gridInstance._resizeTimeOut),this.gridInstance._resizeTimeOut=0),this._expand){if(i=n.clientX,r=n.clientY,navigator.userAgent.indexOf("WebKit")!=-1&&(i=n.pageX,r=n.pageY),n.type=="touchend"&&(i=n.originalEvent.changedTouches[0].clientX,r=n.originalEvent.changedTouches[0].clientY),this.gridInstance.model.allowResizing&&(this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")||n.type=="touchend")&&this._triggerResizeEvents("resizeEnd",i)){this.gridInstance.element.find(".e-reSizeColbg").remove();return}if(i+=document.documentElement.scrollLeft,this._reSize(i,r),!t.isNullOrUndefined(this._currntCe)&&this._currntCe>=0){var u=t.DataManager(this.gridInstance.model.columns).executeLocal((new t.Query).where("visible","equal",!0)),e=u[this._currntCe],f=this.gridInstance.model.columns.indexOf(e);u.length!=this.gridInstance.model.columns.length?this.gridInstance.model.columns[f].width=this.gridInstance.columnsWidthCollection[f]:this.gridInstance.model.columns[this._currntCe].width=this.gridInstance.columnsWidthCollection[this._currntCe]}}},_getResizableCell:function(){var r,u=this.gridInstance.model.scrollSettings.frozenColumns,f,o,s,h,i,t,e,c;if(r=n(this._target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderTable().find(".e-columnheader"):this.gridInstance.getHeaderTable().find(".e-columnheader").not(".e-stackedHeaderRow"),i=r.find(".e-headercell").not(".e-hide,.e-detailheadercell"),f=navigator.userAgent.indexOf("WebKit")!=-1?document.body.scrollLeft:document.documentElement.scrollLeft,u&&this._currentCell!=-1&&this._currentCell==u-1&&(o=i[this._currentCell].getBoundingClientRect().left+f+5,s=o>this._orgX?!0:!1),!u||this._currentCell!=u-1||s)for(h=n(this._target).closest(".e-columnheader").index(),r=n(this._target).hasClass("e-stackedHeaderCell")?r[h]:r,i=n(r).find(".e-headercell").not(".e-hide,.e-detailheadercell"),t=0;t<i.length;t++){if(e=i[t].getBoundingClientRect(),c=e.left+f+5,c>this._orgX&&i[t].offsetHeight+e.top>=this._orgY){this._currentCell=t-1;return}if(t==i.length-1||this.gridInstance.model.showStackedHeader&&n(this._target).get(0)===i[t]){this._currentCell=t;return}}},_moveVisual:function(n){var t=this.gridInstance.getHeaderContent().find("div").first()[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<n||n<t.left+document.documentElement.scrollLeft?this._$visualElement.remove():this._currentCell!=-1&&this._$visualElement.css({left:n,top:this._tableY})},_mouseDown:function(t){var i,r,u;return this._allowStart&&n(t.target).closest("tr").hasClass("e-resizedragicon")?(this._target=t.target,i=t.clientX,r=t.clientY,navigator.userAgent.indexOf("WebKit")!=-1&&(i=t.pageX,r=t.pageY-(window.pageYOffset||document.body.scrollTop||0)),this.gridInstance.model.allowResizing&&this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")&&(n(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),this._target=t.target,this._triggerResizeEvents("resizeStart",i)))?void 0:(u=this,i+=document.documentElement.scrollLeft,t.button!=2&&this._start(i,r),!1):!0},_columnResizeToFit:function(i){var pt=this.gridInstance.getHeaderTable().find(".e-columnheader").filter(function(){return n(this).css("cursor")=="col-resize"}),at,tt,e,h,b,v,et,vt,yt,ot,ht,k,st,ct,r;if(this.gridInstance.model.allowResizeToFit&&pt.length){n(i.target).is(".e-headercelldiv")&&(i.target=i.target.parentNode);var y=n(i.target),c,f=0,o=0;if(c=y.hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-detailheadercell"):this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-stackedHeaderCell,.e-detailheadercell"),this._target=y,y.hasClass("e-headercell")){var d=i.target,p=n.inArray(d,c),w=p;this._orgX=i.pageX;this.gridInstance.model.enableRTL?this._currentCell=p:this._getResizableCell();p!=this._currentCell&&(p=w=this._currentCell,d=i.target.previousSibling);var l=c.filter(":visible")[w],s=[],a=[],g=[];if(o=this.gridInstance.model.groupSettings.groupedColumns.length,t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)&&t.isNullOrUndefined(this.gridInstance.model.childGrid)||(o+=1),n(d).parent("tr").hasClass("e-stackedHeaderRow")){for(var wt=n(l).attr("colspan"),lt=n(l).parent("tr"),nt=l.cellIndex,bt=lt.next();nt>o;)nt--,at=n(lt).children("th")[nt],f+=parseInt(n(at).attr("colspan"));tt=f+parseInt(wt)}else f=w,tt=w+1;var u=0,it=0,rt=0,ut=[],ft=[];if(f!=-1)for(e=c.slice(0,f+1).filter(".e-hide").length,h={columnIndex:f+e,column:this.gridInstance.model.columns[f+e],target:y,oldWidth:v},this.gridInstance._trigger("resizeStart",h),r=f;r<tt;r++){if(e=c.slice(0,r+1).filter(".e-hide").length,rt=this._getContentWidth(r+e),b=this.gridInstance.getHeaderTable().find(".e-headercell:not(.e-hide, .e-stackedHeaderCell)").children(".e-headercelldiv").eq(r),it=this._getHeaderContentWidth(b),u=it>rt?it:rt,u+=parseInt((b.css("padding-left"),10)+(b.css("padding-right"),10)),v=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder).eq(r+o).width(),u=v>u?u:this._colMinWidth<u?u:this._colMinWidth,et=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder),(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)&&et.splice(0,1),et.eq(r+o).width(u),this.gridInstance.model.groupSettings.groupedColumns.length&&(vt=this.gridInstance.getContentTable().find(".e-recordtable").find("colgroup"),yt=this,n.each(vt,function(t,i){n(i).find("col").filter(yt._diaplayFinder).eq(r).width(u)})),ot=this.gridInstance.getContentTable().find("col").filter(this._diaplayFinder),(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)&&ot.splice(0,1),ot.eq(r+o).width(u),this.gridInstance.model.isEdit)for(st=this.gridInstance.getContentTable().find(".e-editedrow").find("col"),ht=this.gridInstance.element.find(".gridform"),k=0;k<ht.length;k++)st=n(ht[k]).find("col"),st.eq(r+o).width(u);ut.push(this.gridInstance.model.columns[r+e]);ft.push(Math.abs(u-v));s.push(r+e);a.push(u);g.push(v);(this.gridInstance.model.scrollSettings.frozenColumns>0||this.gridInstance.model.groupSettings.groupedColumns.length&&this.gridInstance.model.isEdit)&&(ct=r+e,this.gridInstance.columnsWidthCollection[ct]=u,this.gridInstance.setWidthToColumns(),this.gridInstance.model.scrollSettings.frozenColumns<=ct+1&&(this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",u),this.gridInstance.getContent().find(".e-movablecontent").css("margin-left",u),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooter").css("margin-left",u)))}for(this.gridInstance._colgroupRefresh(),this.gridInstance._recalculateIndentWidth(),h={columnIndex:s,column:ut,target:l,oldWidth:g,newWidth:a,extra:ft},this.gridInstance._trigger("resizeEnd",h),r=0;r<s.length;r++)this.gridInstance.columnsWidthCollection[s[r]]=a[r],this.gridInstance.model.columns[s[r]].width=a[r];h={columnIndex:s,column:ut,target:l,oldWidth:g,newWidth:a,extra:ft};this.gridInstance._trigger("resized",h);this.gridInstance.model.summaryRows.length>0&&this.gridInstance._summaryColRrefresh();this.gridInstance._findColumnsWidth()}}},_getContentWidth:function(i){var e=0,u=t.buildTag("span",{},{}),r=this.gridInstance,o,f;return t.isNullOrUndefined(r._gridRows)||(f=r._gridRows,r.model.scrollSettings.frozenColumns&&r.model.currentViewData.length&&i>=r.model.scrollSettings.frozenColumns&&(f=f[1],i=i-r.model.scrollSettings.frozenColumns),n.each(f,function(t,f){if(n(f).is(".e-row,.e-alt_row")&&!n(f).is(".e-editedrow")){var s=n(f).find("td.e-rowcell").eq(i),h=n(s).html();r.model.columns[i].commands?u.html(n(h).children()):s.hasClass("e-validError")?u.html(n(h).attr("value")):u.html(h);n(s).html(u);o=s.find("span:first").width()>0?s.find("span:first").width()+parseFloat(s.css("padding-left"))+parseFloat(s.css("padding-right")):s.find("span:first").width();o>e&&(e=o);n(s).html(h)}})),r._refreshUnboundTemplate(this.gridInstance.getContentTable()),e},_getHeaderContentWidth:function(n){var i=0,u=t.buildTag("span",{},{}),e=this.gridInstance.getBrowserDetails().browser=="msie",f,r;return e&&u.css("position","absolute"),f=n.html(),u.html(f),n.html(u),i=n.find("span:first").width()+parseFloat(n.css("padding-left"))+parseFloat(n.css("padding-right")),e&&(i+=2),this.gridInstance.model.allowFiltering&&(this.gridInstance.model.filterSettings.filterType=="menu"||this.gridInstance.model.filterSettings.filterType=="excel")&&(r=n.parent().find(".e-filtericon"),i=i+r.width()+10,r.length&&(i+=parseFloat(r.css("margin-left")))),n.html(f),i}}}(jQuery,Syncfusion)});
