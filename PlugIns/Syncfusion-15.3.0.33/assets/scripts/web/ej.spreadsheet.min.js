/*!
*  filename: ej.spreadsheet.min.js
*  version : 15.3.0.33
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["jsrender","jquery-validation","./../common/ej.core.min","./../common/ej.data.min","./ej.grid.min","./../common/ej.scroller.min","./../common/ej.globalize.min","./ej.calculate.min","./ej.waitingpopup.min","./../datavisualization/ej.chart.min","./ej.dialog.min","./ej.tab.min","./ej.button.min","./ej.splitbutton.min","./ej.togglebutton.min","./ej.checkbox.min","./ej.radiobutton.min","./ej.autocomplete.min","./ej.datepicker.min","./ej.dropdownlist.min","./ej.listbox.min","./ej.editor.min","./ej.pager.min","./ej.menu.min","./ej.treeview.min","./ej.uploadbox.min","./ej.colorpicker.min","./ej.excelfilter.min","./ej.ribbon.min","./ej.pivotschemadesigner.min","./ej.pivotgrid.min"],n):n()})(function(){(function(n,t,i){t.widget("ejSpreadsheet","ej.Spreadsheet",{_rootCSS:"e-spreadsheet",element:null,_excelFilter:null,validTags:["div"],model:null,_requiresID:!0,defaults:{allowFreezing:!0,enableContextMenu:!0,allowEditing:!0,allowResizing:!0,allowMerging:!0,allowWrap:!0,allowUndoRedo:!0,allowClipboard:!0,allowDataValidation:!0,allowConditionalFormats:!0,allowSearching:!0,allowKeyboardNavigation:!0,allowAutoFill:!0,allowSelection:!0,allowSorting:!0,allowDragAndDrop:!0,allowCellType:!0,allowAutoCellType:!1,allowCharts:!0,enablePersistence:!1,allowCellFormatting:!0,allowFormulaBar:!0,showRibbon:!0,showPager:!0,allowComments:!0,allowFiltering:!0,allowInsert:!0,allowDelete:!0,allowFormatPainter:!0,allowHyperlink:!0,allowImport:!0,allowFormatAsTable:!0,allowAutoSum:!0,enablePivotTable:!1,allowLockCell:!0,enableTouch:!0,allowOverflow:!0,allowClear:!0,isReadOnly:!1,columnCount:21,rowCount:20,rowHeight:20,columnWidth:64,sheetCount:1,undoRedoStep:20,activeSheetIndex:1,apWidth:300,activationPanelWidth:300,_isActPanelVisible:!1,cssClass:"",userName:"",locale:"en-US",pageSize:"A4",sheets:[],nameManager:[],customFormulas:[],currentViewData:null,query:null,create:null,actionBegin:null,actionComplete:null,beforeCellFormat:null,cellFormatting:null,beforeOpen:null,beforeDrop:null,drop:null,cellEdit:null,pagerClick:null,cellClick:null,_pivotPrint:null,tabClick:null,tabSelect:null,_createPivotTable:null,beforePanelOpen:null,load:null,loadComplete:null,editRangeBegin:null,editRangeComplete:null,cellHover:null,menuClick:null,contextMenuClick:null,ribbonClick:null,dragStart:null,drag:null,cellSave:null,beforeCellSelect:null,cellSelected:null,autoFillBegin:null,autoFillComplete:null,openFailure:null,onImport:null,onExport:null,beforeImport:null,beforeBatchSave:null,keyUp:null,keyDown:null,dragShape:null,resizeStart:null,resizeEnd:null,refresh:null,beforeEditComment:null,beforeTabClick:null,scrollStop:null,scrollSettings:{width:"100%",height:"100%",allowScrolling:!0,scrollMode:"infinite",isResponsive:!0,allowVirtualScrolling:!0,allowSheetOnDemand:!1},pageSettings:{pageCount:10,currentPage:1,pagerHeight:26},exportSettings:{allowExporting:!0,excelUrl:null,csvUrl:null,pdfUrl:null,password:null},pictureSettings:{allowPictures:!0,height:220,width:440},selectionSettings:{selectionType:"default",selectionUnit:"multirange",enableAnimation:!1,animationType:"linear",animationTime:.001,activeCell:""},chartSettings:{height:220,width:440},formatSettings:{allowFontFamily:!0,allowDecimalPlaces:!0,allowCellBorder:!0},autoFillSettings:{fillType:"fillseries",showFillOptions:!0},importSettings:{importMapper:"",importUrl:"",password:"",allowSheetOnDemand:!1,importOnLoad:!1},printSettings:{allowPageSetup:!0,allowPageSize:!1,allowPrinting:!0},ribbonSettings:{enableOnDemand:!1,applicationTab:{type:t.Ribbon.ApplicationTabType.Backstage,menuSettings:{isAppend:!1,dataSource:[]}}}},dataTypes:{pageSize:"enum",sheets:"array",nameManager:"array",scrollSettings:{scrollMode:"enum"},selectionSettings:{selectionType:"enum",selectionUnit:"enum",animationType:"enum"},autoFillSettings:{fillType:"enum"}},_dataSource:function(n){return this.getSheet(n).dataSource},getSheet:function(n){return this.model.sheets[this._getSheetIndex(n)]},getSheets:function(){return this.model.sheets},getSheetElement:function(n){return this.element.find("#"+this._id+"_"+this.getSheet(n).sheetInfo.value)},getDataSettings:function(n){var i,r=[],t=this.getSheet(n),u=t.rangeSettings.length;if(u)while(u--)i=t.rangeSettings[u],i.dataSource&&r.push(i);return r.length?r:t.dataSource?[t]:null},_getJSSheetHeader:function(n){return this._sheets[n]._sheetHeader},_setJSSheetHeader:function(n,t){this._sheets[t]._sheetHeader=n},_getInputBox:function(){return this._inputBox},_setInputBox:function(n){this._inputBox=n},_getIndexBox:function(){return this._indexBox},_setIndexBox:function(n){this._indexBox=n},_getJSSheetRowHeader:function(n){return this._sheets[n]._sheetRowHeader},_setJSSheetRowHeader:function(n,t){this._sheets[t]._sheetRowHeader=n},_getJSSheetRowHeaderContent:function(n){return this._sheets[n]._sheetRowHeaderContent},_setJSSheetRowHeaderContent:function(n,t){this._sheets[t]._sheetRowHeaderContent=n},_getJSSheetContent:function(n){return this._sheets[n]._sheetContent},_setJSSheetContent:function(n,t){this._sheets[t]._sheetContent=n},_getContent:function(n){return this._sheets[n]._content},_setContent:function(n,t){this._sheets[t]._content=n},getPager:function(){return this._spreadSheetPager},setPager:function(n){this._spreadSheetPager=n},getFooter:function(){return this._footer},setFooter:function(n){this._footer=n},getMainPanel:function(){return this._mainPanel},setMainPanel:function(n){this._mainPanel=n},getGroupPanel:function(){return this._groupPanel},setGroupPanel:function(n){this._groupPanel=n},getActivationPanel:function(){return this._activationPanel},setActivationPanel:function(n){this._activationPanel=n},getActiveSheetIndex:function(){return this.model.activeSheetIndex},setActiveSheetIndex:function(n){this.model.activeSheetIndex=n},getRows:function(n){return this._sheets[n]._Rows},setRows:function(n,t){this._sheets[t]._Rows=n},getFrozenRows:function(n){return this.getSheet(this._getSheetIndex(n)).frozenRows},setFrozenRows:function(n,t){this.model.isReadOnly||(this.getSheet(this._getSheetIndex(t)).frozenRows=n)},getFrozenColumns:function(n){return this.getSheet(n).frozenColumns},setFrozenColumns:function(n,t){this.model.isReadOnly||(this.getSheet(t).frozenColumns=n)},setFocusTopElem:function(n){this._focusTopElem=n},getFocusTopElem:function(){return this._focusTopElem},setFocusRightElem:function(n){this._focusRightElem=n},getFocusRightElem:function(){return this._focusRightElem},setFocusBottomElem:function(n){this._focusBottomElem=n},getFocusBottomElem:function(){return this._focusBottomElem},setFocusLeftElem:function(n){this._focusLeftElem=n},getFocusLeftElem:function(){return this._focusLeftElem},setAutoFillElem:function(n){this._autoFillElem=n},getAutoFillElem:function(){return this._autoFillElem},_setAutoFillOptElem:function(n){this._autoFillOptElem=n},_getAutoFillOptElem:function(){return this._autoFillOptElem},_getColWidth:function(n,t){return this.getSheet(t).columnsWidthCollection[n]},_getRowHeight:function(n,t){return this.getSheet(t).rowsHeightCollection[n]},setActiveCell:function(n,i,r){var f=this.getSheet(r?r:this.getActiveSheetIndex()),u;typeof n=="string"&&(u=this.getRangeIndices(n),n=u[0],i=u[1]);f._activeCell=t.isNullOrUndefined(n)&&t.isNullOrUndefined(i)?f._startCell:{rowIndex:n,colIndex:i}},getActiveCell:function(n){return this.getSheet(this._getSheetIndex(n))._activeCell},_setFormulaSuggElem:function(n){this._formulaSuggElem=n},_getFormulaSuggElem:function(){return this._formulaSuggElem},_setRowHdrTBody:function(n,t){this._sheets[t]._rowHdrTBody=n},_getRowHdrTBody:function(n){return this._sheets[n]._rowHdrTBody},_setContTBody:function(n,t){this._sheets[t]._contTBody=n},_getContTBody:function(n){return this._sheets[n]._contTBody},_init:function(){var n=this.model.importSettings,t;this._initBegin();this.model.allowImport&&(n.importUrl.length||n.importOnLoad)?this["import"]({url:n.importUrl,password:n.password,allowSheetOnDemand:n.allowSheetOnDemand}):(this.showWaitingPopUp(),this._initBase(),this._initComplete());this._isAutoWHMode&&(t=this._getElementDimension(),this.element.css({height:t.height,width:t.width}));this.addClass(this.element,this.model.cssClass);this._cssClass=this.model.cssClass},_initBegin:function(){var r="touch-action",i=this.model.scrollSettings,f=i.width,e=i.height,u;t.support.stableSort=!1;this._isInitLoad=!0;this._isAutoWHMode=!i.allowScrolling;this._isAutoWHMode&&(i.isResponsive=!1,i.scrollMode="normal",i.allowVirtualScrolling=!1);this._minWidth=280;this._minHeight=200;this._isAutoWHMode||this.element.css({"min-height":this._minHeight,"min-width":this._minWidth,height:i.height,width:i.width});this._updateResponsiveSettings();this._isAutoWHMode||i.isResponsive||(i.width.toString().indexOf("%")>-1&&(i.width=this._responsiveWidth),i.height.toString().indexOf("%")>-1&&(i.height=this._responsiveHeight),this.element.css({height:i.height,width:i.width}));this._browserDetails=t.browserInfo();this.localizedLabels=t.getLocalizedConstants(this.sfType,this.model.locale);this.element.attr("tabindex",0);this._browserDetails.name==="msie"&&(r="-ms-"+r);this.element.css(r,"double-tap-zoom pinch-zoom");u=t.buildTag("div#"+this._id+"_wait","",{position:"absolute"});n(document.body).append(u);u.ejWaitingPopup({showOnInit:!1,target:this.element})},_initBase:function(){this._refreshModel(this.isImport?this._impData.model:null);this._initProps();this._initCSSTag();this._initLayout();this._wireEvents("_on");this._isInitLoad=!1},_initProps:function(){var r=this.model,i=t.spreadsheetFeatures;this.XLClipboard=new i.clipboard(this);this.XLEdit=new i.editing(this);this.XLPrint=new i.print(this);this.XLRibbon=new i.ribbon(this);this.XLScroll=new i.scroller(this);r.allowDragAndDrop&&(this.XLDragDrop=new i.dragAndDrop(this));r.allowKeyboardNavigation&&(this.XLCellNav=new i.cellNavigation(this));r.allowFiltering&&(this.XLFilter=new i.filter(this));r.allowAutoFill&&(this.XLDragFill=new i.dragFill(this));(r.allowCellFormatting||r.allowFormatAsTable||r.allowFormatPainter)&&(this.XLFormat=new i.cellFormatting(this));r.allowCellFormatting&&(this.XLCellFrmtDlg=new i.formatCellDialog(this));r.allowConditionalFormats&&(this.XLCFormat=new i.cFormat(this));r.allowSearching&&(this.XLSearch=new i.findnreplace(this));r.allowCharts&&(this.XLChart=new i.chart(this));r.exportSettings.allowExporting&&(this.XLExport=new i.exporting(this));r.allowSorting&&(this.XLSort=new i.sorting(this));r.allowFreezing&&(this.XLFreeze=new i.freezepane(this));r.allowComments&&(this.XLComment=new i.comments(this));r.allowSelection&&(this.XLSelection=new i.selection(this));(r.allowCharts||r.pictureSettings.allowPictures)&&(this.XLShape=new i.shape(this));r.allowResizing&&(this.XLResize=new i.resizing(this));r.enableContextMenu&&(this.XLCMenu=new i.contextmenu(this));r.allowDataValidation&&(this.XLValidate=new i.validation(this));r.allowCellType&&(this.XLCellType=new i.cellType(this));r.enablePivotTable&&(this.XLPivot=new i.pivot(this));i.math&&n.extend(t.Spreadsheet.prototype,i.math);this._initPvtProps();this._initFATProps();this.model.customFormulas.length&&this._updateCustomFormulas(this.model.customFormulas,"add");this.model.nameManager.length&&this._refreshNameMngr(this.model.nameManager)},_initPvtProps:function(){var u=1,i={rowIndex:0,colIndex:0},r=this._getLocStr("AutoFillOptions").split("/"),e=this.getActiveSheetIndex(),f=t.preferredCulture(this.model.locale).numberFormat;for(this._dataContainer=this.isImport?n.extend(!0,{},this._impData.dataContainer):{sheets:{},sheetCellType:{},hashCode:[],sharedData:[],cellType:[],valData:[],cFormatData:[]},this._newSIndex=1,this.isImport=this.isImport||!1,this.mergeCenter=!1,this.isDirty=!1,this._calcID=CalcEngine.createSheetFamilyID(),this._calcEngine=new CalcEngine(this,this._calcID),this._calcEngine.setUseDependencies(!0),this._calcEngine.setExcelLikeComputations(!0),this._calcEngine.setUseDatesInCalculations(!0),this._calcEngine.setEnableFormulaErrorValidation(!0),this._calcEngine.setCalculatingSuspended(n("#"+this._id+"_CalcManual").find("span").hasClass("e-ss-calcauto")),this._sheets=[],this._cellProp=["value","value2","type","cFormatRule","range","thousandSeparator","rule","format","border","picture","chart","calcValue","align","hyperlink","formats","borders","tformats","tborders","isFilterHeader","filterState","tableName","comment","formatStr","decimalPlaces","cellType","isFilterHighlight","pivot"],this.isImport||(this.model.sheets.splice(0,0,{}),this._updateCellType());u<=this.model.sheetCount;)this.isImport||(this._dataContainer.sheets[u]={}),this._sheetSettings(u),this._newSIndex++,u++;this._detachTable=null;this._isPrint=!1;this._isSheetInsert=!1;this._isSheetRename=!1;this._isTableRename=!1;this._tableClassName=null;this._isSheetNavigate=!1;this._sheetCopy={isSheetCopy:!1,sheetContent:null};this._alertDialog={element:null,action:null};this._dataManager=null;this._isUndo=!1;this._undoCollection=[];this._redoCollection=[];this._ctrlKeyCount=0;this._formulaRange=[];this._formulaHeight=36;this._isSort=!1;this._isPaste=!1;this._isFATResize=!1;this._isDisplayHeader=!1;this._currencySymbol=f.currency.symbol||"$";this._percentSymbol=f.percent.symbol||"%";this._decimalSeparator=f["."]||".";this.operators={"<":function(n,t){return n<t},">":function(n,t){return n>t},">=":function(n,t){return n>=t},"<=":function(n,t){return n<=t},"==":function(n,t){return n===t},"!=":function(n,t){return n!==t},"!":function(n){return!n},"=":function(n){return n}};this.parse={parseInt:function(n){return parseInt(n)},parseFloat:function(n){return parseFloat(n)},parseDate:function(n){return new Date(n).getTime()},parseTime:function(n){return new Date("01/01/1990 "+n).getTime()},length:function(n){return n.charAt(0)==="^"?parseInt(n.split("^")[1]):n.length}};this._selMergeCells=[];this._mergeType="merge-cells";this._delCells=[];this._deletedText=[];this._removeMergeColl=[];this._insData={};this._deletedDimension=[];this._insDelStatus="";this._isUndoRedo=!1;this._indexBox=null;this._inputBox=null;this._focusTopElem=null;this._focusRightElem=null;this._focusBottomElem=null;this._focusLeftElem=null;this._dStartCell=i;this._dEndCell=i;this._pStartCell=i;this._pEndCell=i;this._pFillCell=i;this._borderFocus=["e-focusright","e-focusbottom"];this._cutFocus=["e-cutright","e-cutbottom"];this._autoFillFocus=["e-autofillright","e-autofillbottom"];this._formulaBorder=[["e-bborderright","e-bborderbottom"],["e-rborderright","e-rborderbottom"],["e-vborderright","e-vborderbottom"],["e-gborderright","e-gborderbottom"],["e-pborderright","e-pborderbottom"],["e-oborderright","e-oborderbottom"]];this._ctrlFormulaBorder=[["e-bctrlborderright","e-bctrlborderbottom"],["e-rctrlborderright","e-rctrlborderbottom"],["e-vctrlborderright","e-vctrlborderbottom"],["e-gctrlborderright","e-gctrlborderbottom"],["e-pctrlborderright","e-pctrlborderbottom"],["e-octrlborderright","e-octrlborderbottom"]];this._borderTypes=[{id:"bottomborder",text:this._getLocStr("BottomBorder"),parentId:null,sprite:"e-icon e-ss-bottomborder"},{id:"topborder",text:this._getLocStr("TopBorder"),parentId:null,sprite:"e-icon e-ss-topborder"},{id:"leftborder",text:this._getLocStr("LeftBorder"),parentId:null,sprite:"e-icon e-ss-leftborder"},{id:"rightborder",text:this._getLocStr("RightBorder"),parentId:null,sprite:"e-icon e-ss-rightborder"},{id:"noborder",text:this._getLocStr("NoBorder"),parentId:null,sprite:"e-icon e-ss-noborder"},{id:"allborder",text:this._getLocStr("AllBorder"),parentId:null,sprite:"e-icon e-ss-allborder"}];this._datePattern=["year","month","day","hours","minutes","seconds"];this._styleColl={};this._borderStyle="solid";this._borderColor="#000000";this._borderStyles=["solid","dashed","dotted"];this._ddlCell=null;this._cOpt={};this._shapeChange=!1;this._dupDetails=!1;this._paste=!1;this._autoFillElem=null;this._autoFillOptElem=null;this._fillOptionMenuData=[{id:"copycells",text:r[0],parentId:null,sprite:"e-icon e-ss-fillselect"},{id:"fillseries",text:r[1],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"fillformattingonly",text:r[2],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"fillwithoutformatting",text:r[3],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"flashfill",text:r[4],parentId:null,sprite:"e-icon e-ss-filloption"}];this._formulaSuggElem=null;this._isFormulaSuggestion=!1;this._shiftKeyEnabled=!1;this._preventctrlkey=!1;this._rAlign="e-ralign";this._cAlign="e-calign";this._chartBorder=[["e-rcbright","e-rcbbottom"],["e-vcbright","e-vcbbottom"],["e-bcbright","e-bcbbottom"]];this._selectionBorder=["e-selecttop","e-selectright","e-selectbottom","e-selectleft"];this._autofillBorder=["e-autofilltop","e-autofillright","e-autofillbottom","e-autofillleft"];this._thinBorder=["e-thinright","e-thinbottom"];this._rcRegx=new RegExp("\\be-rc.*\\b","g");this._formatRegx=new RegExp("\\be-format.*?\\b","g");this._borderRegx=new RegExp("\\be-border.*?\\b","g");this._formulaChanged=[];this._ref=[];this._prevText="";this._prevVal="";this._dlgHLClick=!1;this._selectDataval={};this._undoInputobj={};this._cureditedCell="";this._colHeaderHeight=22;this._rowHeaderWidth=30;this._scrollerHeight=18;this._scrollerWidth=18;this._bufferCnt=5;this._maxRowCnt=1048576;this._maxColCnt=16384;this._impData=this._impData||null;this._isNew=!1;this._isSheetReq=!1;this._intrnlReq=!1;this._isFilterApplied=!1;this._commentCount=0;this._tableCnt=1;this._uploadImage=!1;this._responsiveWidth=0;this._responsiveHeight=0;this._celltypes=[];this._reqCnt=0;this._resCnt=0;this._pageClickArgs=null;this._gotoPageArgs=null;this._updateFormulaCollection();this._isRibbonClick=!1;this._intrnlUpdate=!1;this._isPvtNameEdit=!1;this._hlColor="#428bca";this._isFilter=!1;this._isShowHide=!1;this._insRows={};this._isTotalRow=!1;this._scrollReverse=!1;this._phoneMode=this.model.scrollSettings.isResponsive&&document.documentElement.clientWidth<420;this._tabMode=this.model.scrollSettings.isResponsive&&document.documentElement.clientWidth>419&&document.documentElement.clientWidth<617;this._dlgHeight=this._responsiveHeight-2;this._dlgWidth=this._responsiveWidth-2;this._isTouchEvt=!1;this._isTouchMoveSel=!1;this._isTouchScroll=!1;this._isScrolling=!1;this._startXY=null;this._touchArgs=null;this._isResized=!1;this._isRibbonDestroyed=!1;this._resizeColl=[];this._delWrapColl={};this._isInsdel=!1;this._canOverflow=!0;this.preventFilterPopup=!1;this._FATStyles={};this._isFiltered=!1;this._dautoFillCell={rowIndex:0,colIndex:0};this._isPublic=!1;this._fRow={rowAdj:!0,fRowCnt:0};this._fCol={colAdj:!0,fColCnt:0};this.isPasteValuesOnly=!1;this._isSaveAsJSON=!1;this._cssClass="";this._hideRowColl=[];this._isSort=!1;this._isKeyCtrlShftF2=!1},_initFATProps:function(){var o,g,t="w:bold",i="c:#FFFFFF",n="c:#000000",l="c:#2F75B5",a="c:#ED7D31",v="c:#FFC000",r="1px solid #000000",u="1px solid #2f75b5",f="1px solid #ED7D31",e="1px solid #FFC000",y="b:#D9D9D9",s="b:#DDEBF7",p="b:#FCE4D6",w="b:#FFF2CC",nt="b:#000000",tt="b:#FFE2C6",it="b:#FFF1BF",h="b:#000000",rt="b:#D7D7D7",b="b:#FFC000",k="b:#5B9BD5",ut="b:#Ed7D31",d="hl?"+t+";"+n+";bo:tb-"+r+"&cl?"+y+";"+n+","+n+"&cb?b-"+r+"/hl?"+t+";bo:tb-"+u+";"+l+"&cl?"+s+";"+l+","+l+"&cb?b-"+u+"/hl?"+t+";bo:tb-"+f+";"+a+"&cl?"+p+";"+a+","+a+"&cb?b-"+f+"/hl?"+t+";bo:tb-"+e+";"+v+"&cl?"+w+";"+v+","+v+"&cb?b-"+e+"/hl?"+t+";"+nt+";"+i+";bo:o-"+r+"&cl?bo:t-"+r+";"+n+"&cb?o-"+r+"/hl?bo:o-"+u+";"+t+";"+k+";"+i+"&cl?bo:t-"+u+";"+n+"&cb?o-"+u+"/hl?"+t+";b:#EB7E2F;"+i+";bo:o-"+f+"&cl?bo:t-"+f+";"+n+"&cb?o-"+f+"/hl?"+t+";"+b+";"+i+";bo:o-"+e+"&cl?bo:t-"+e+";"+n+"&cb?o-"+e+"/hl?"+t+";bo:gb-"+r+";"+n+"&cl?"+y+";"+n+","+n+"&cb?gb-"+r+"/hl?"+t+";bo:gb-"+u+";"+n+"&cl?"+s+";"+n+","+n+"&cb?gb-"+u+"/hl?"+t+";bo:gb-"+f+";"+n+"&cl?"+p+";"+n+","+n+"&cb?gb-"+f+"/hl?"+t+";bo:gb-"+e+";"+n+"&cl?"+w+";"+n+","+n+"&cb?gb-"+e+"/hl?"+t+";"+nt+";"+i+"&cl?b:#A6A6A6;"+n+","+y+";"+n+"/hl?"+t+";"+k+";"+i+"&cl?b:#BDD7EE;"+n+","+s+";"+n+"/hl?"+t+";"+ut+";"+i+"&cl?b:#F8CBAD;"+n+","+p+";"+n+"/hl?"+t+";"+b+";"+i+"&cl?b:#FFE699;"+n+","+w+";"+n+"/hl?"+t+";"+rt+";"+n+";bo:gb-"+r+"&cl?b:#A7A7A7;"+n+","+rt+";"+n+"&cb?gb-"+r+"/hl?"+t+";b:#DBECF6;"+n+";bo:gb-"+u+"&cl?b:#BED8F1;"+n+","+s+";"+n+"&cb?gb-"+u+"/hl?"+t+";"+tt+";"+n+";bo:gb-"+f+"&cl?b:#F6CAAD;"+n+","+tt+";"+n+"&cb?gb-"+f+"/hl?"+t+";"+it+";"+n+";bo:gb-"+e+"&cl?b:#FDE18D;"+n+","+it+";"+n+"&cb?gb-"+e+"/hl?"+t+";"+h+";"+i+"&cl?b:#404040;"+i+",b:#737373;"+i+"/hl?"+t+";"+h+";"+i+"&cl?b:#2F75B5;"+i+","+k+";"+i+"/hl?"+t+";"+h+";"+i+"&cl?b:#C65911;"+i+","+ut+";"+i+"/hl?"+t+";"+h+";"+i+"&cl?b:#BF8F00;"+i+","+b+";"+i,c=["Light1","Light2","Light3","Light5","Light8","Light9","Light10","Light12","Light15","Light16","Light17","Light19","Medium8","Medium9","Medium10","Medium12","Medium22","Medium23","Medium24","Medium26","Dark1","Dark2","Dark3","Dark5"];for(d=d.split("/"),o=0,g=c.length;o<g;)this._FATStyles["TableStyle"+c[o]]={format:this.XLRibbon._getFormatAsTableInput(d[o]),formatName:"TableStyle"+c[o]},o++;this.XLFormat._formatAsTableStyle=this._FATStyles["TableStyle"+c[0]]},_updateResponsiveSettings:function(){var i=t.browserInfo().name==="msie"&&t.browserInfo().version==="8.0",n=this.element[0].getClientRects()[0];this._responsiveHeight=Math.floor(i?this.element[0].offsetHeight:n?n.height:0);this._responsiveWidth=Math.floor(i?this.element[0].offsetWidth:n?n.width:0)},_getElementDimension:function(){var f=0,t,e=0,o=0,i,r,u;return this.model.showRibbon&&(i=n("#"+this._id+"_Ribbon").data("ejRibbon"),t=i.element[0].offsetWidth,f=i.element[0].offsetHeight),this.model.allowFormulaBar&&(r=n("#"+this._id+"_formulabar")[0],e=r.offsetHeight,t||(t=r.offsetWidth)),u=this.element.find(".e-spreadsheetmainpanel")[0],o=u.offsetHeight,t||(t=u.offsetWidth),{width:t+2,height:f+e+o+1}},_sheetSettings:function(i){var o,f,u,s,c,r,a,e,l,h;if(this._isSheetReq?f=this.getSheet(i):(r=this.getSheet(i),c=this._generateSheetName(this._newSIndex),f=this.model.sheets[i]={colCount:r&&r.colCount||this.model.columnCount,rowCount:r&&r.rowCount||this.model.rowCount,_formulaCollection:{},columnsWidthCollection:[],_colWidthCollection:[],_ofColWidthColl:[],rowsHeightCollection:[],_rowHeightCollection:[],_rowIdxColl:[],_spreadSheetPager:null,showHeadings:r&&!this.isUndefined(r.showHeadings)?r.showHeadings:!0,showGridlines:r&&!this.isUndefined(r.showGridlines)?r.showGridlines:!0,dataSource:r&&r.dataSource||null,_jsonData:r?r.dataSource instanceof t.DataManager?null:r.dataSource:null,_dataManager:r&&r.dataSource instanceof t.DataManager?r.dataSource:null,query:r&&r.query||null,primaryKey:r&&r.primaryKey||"",startCell:r&&r.startCell||"A1",topLeftCell:r&&r.topLeftCell||"A1",fieldAsColumnHeader:r&&r.fieldAsColumnHeader||!1,showHeader:r&&r.showHeader===!1?!1:!0,headerStyles:r&&r.headerStyles||null,batchChanges:{added:[],changed:[],deleted:[]},range:[0,0,0,0],fields:[],_isDataManager:!1,_isOffline:!1,_hasDataSrc:!1,columns:r&&r.columns||[],_columnStyles:{},_rowStyles:{},cellTypes:r&&r.cellTypes||[],rows:r&&r.rows||null,_excelFilter:null,filterSettings:{filteredColumns:[],maxFilterChoices:1e3,filteredRange:[],range:"",tableRange:[]},frozenRows:r&&r.frozenRows||0,frozenColumns:r&&r.frozenColumns||0,_frozenRows:r&&r.frozenRows&&r.frozenRows+1||1,_frozenColumns:r&&r.frozenColumns&&r.frozenColumns+1||1,_fHMergeRows:[],_fHMergeCols:[],paneTopLeftCell:r&&r.paneTopLeftCell||"A1",_selectedRange:{},_selectedCellColors:[],columnWidth:r&&r.columnWidth||this.model.columnWidth,rowHeight:this.model.rowHeight,_frozenHeight:0,_frozenWidth:0,_firstRow:{idx:0,value:0},_firstCol:{idx:0,value:0},_topRow:{idx:0,value:0},_bottomRow:{idx:0,value:0},_leftCol:{idx:0,value:0},_rightCol:{idx:0,value:0},_filterColl:{},_filteredColumns:[],_commentColl:{},_mergeColl:{},_unmergeColl:{},_delmergeColl:{},_hideMergeColl:{},_clrMergeColl:[],_clrWrapColl:[],_selectedCells:[],selectedRange:[0,0,0,0],tableManager:{},_header:{},_selectedCellIndexes:[],_startCell:{rowIndex:0,colIndex:0},_endCell:{rowIndex:0,colIndex:0},_activeCell:{rowIndex:0,colIndex:0},_autoFillCell:{rowIndex:0,colIndex:0},rangeSettings:r&&r.rangeSettings||[],sheetInfo:{text:c,value:this._getLocStr("Sheet")+this._newSIndex,isVisible:!0},_multipleFiltering:!1,_multifilterIdx:[],_filteredByColor:"",staticWidth:0,_fRow:0,_fCol:0,hideColsCollection:{},hideRowsCollection:r&&r.hideRowsCollection||[],_hiddenFreezeRows:[],_hiddenFreezeCols:[],_filterHRowsColl:[],_restrictedHeightRows:[],filteredRowsCollection:[],_rHeightCollection:[],_frHiddenHeight:0,_fpHiddenHeight:0,_fpHiddenWidth:0,_pTarget:{},_cSpan:1,_rSpan:1,usedRange:{rowIndex:0,colIndex:0},mergedCells:[],shapeMngr:{picture:{},chart:{},sharedPics:[]},pivotMngr:{pivot:{}},_nmValue:{},_nmEdit:!1,_wrapHtCollection:{},_isChartBorderDrawn:!1,_virtualBlockCnt:0,_virtualBlockRowCnt:0,_virtualContBlockIdx:1,_virtualTopTBodyHgt:0,_virtualBottomTBodyHgt:0,_virtualTBodyHgt:0,_scrollTop:0,_scrollLeft:0,_virtualRowIdx:[],_virtualTopTBodyOffset:{top:0,bottom:0},_virtualContTBodyOffset:{top:0,bottom:0},_virtualBottomTBodyOffset:{top:0,bottom:0},_virtualDataLoadedBlks:[],_virtualDataMngrLoadedBlks:[1,2],_isVirtualTopReached:!0,_isVirtualEndReached:!1,_isLoaded:!1,_isImpSLoad:!1,_isRowSelected:!1,_isColSelected:!1,_isSheetSelected:!1,isSheetProtected:!1,_contWidth:0,_isRangeSelected:!1,_isEmptyActiveCell:!1,_isMultiSelect:!1,_isImported:this.isImport,_isRequested:!1,_goToCollection:{multiple:!1,selected:[]},_showLockCellAlert:!1,_reqCnt:0,_resCnt:0,_templateColCount:0,_isTemplate:!1,_cFormatFormula:{},_isVPRendered:!1,_isDataMoved:!1,_vPortHgt:0,_vPortWth:0,cFormatRule:r&&r.cFormatRule||[],mergeCells:r&&r.mergeCells||[],hideRows:r&&r.hideRows||[],hideColumns:r&&r.hideColumns||[],border:r&&r.border||[],isResized:!1,_isOpened:!1,_wrapColl:{},_formatColl:{},_isFreezed:!1,_ftopRowIdx:0,_fleftColIdx:0,_contScrollTop:0,_contScrollLeft:0,_fDivTop:0,_fDivLeft:0,_isRibCollapsed:!1},this._initRangeSettings(i),s=f.sheetInfo.value,a=this._sheets[i]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null,_contTBody:null,_rowHdrTBody:null},this._calcEngine.registerGridAsSheet(s,s,this._calcID)),this.isImport&&(u=this._impData.model.sheets[i],o=this.getRangeIndices(u.topLeftCell||"A1"),f.sheetInfo.text=u.sheetInfo.text,f.sheetInfo.isVisible=this.isUndefined(u.sheetInfo.isVisible)?!0:u.sheetInfo.isVisible,this.model.importSettings.allowSheetOnDemand&&i!==this.getActiveSheetIndex()||(f._isRequested=!0),f._isRequested)){if(u.usedRange&&(u.usedRange.rowIndex&&(f.usedRange.rowIndex=u.usedRange.rowIndex),u.usedRange.colIndex&&(f.usedRange.colIndex=u.usedRange.colIndex)),u._startCell&&(u._startCell.rowIndex&&(f._startCell.rowIndex=u._startCell.rowIndex),u._startCell.colIndex&&(f._startCell.colIndex=u._startCell.colIndex)),u._endCell&&(u._endCell.rowIndex&&(f._endCell.rowIndex=u._endCell.rowIndex),u._endCell.colIndex&&(f._endCell.colIndex=u._endCell.colIndex)),u._activeCell&&(u._activeCell.rowIndex&&(f._activeCell.rowIndex=u._activeCell.rowIndex),u._activeCell.colIndex&&(f._activeCell.colIndex=u._activeCell.colIndex)),u.columnsWidthCollection&&(f.columnsWidthCollection=u.columnsWidthCollection),u.rowsHeightCollection){for(h=u.hideRowsCollection||[],e=0,l=h.length;e<l;e++)u.rowsHeightCollection[parseInt(h[e])]=0;f.rowsHeightCollection=n.extend(!0,[],u.rowsHeightCollection)}t.isNullOrUndefined(u.showGridlines)||(f.showGridlines=u.showGridlines);u.hideRowsCollection&&(f.hideRowsCollection=u.hideRowsCollection||[]);u.shapeMngr.picture.length&&(f.shapeMngr.sharedPics=u.shapeMngr.sharedPics);u.isSheetProtected&&(f.isSheetProtected=u.isSheetProtected);u._restrictedHeightRows&&(f._restrictedHeightRows=u._restrictedHeightRows||[]);u._isColSelected&&(f._isColSelected=u._isColSelected);u._isRowSelected&&(f._isRowSelected=u._isRowSelected);u.showHeadings===!1&&(f.showHeadings=!1);u.frozenRows&&(f.frozenRows=f._frozenRows=o[0]+u.frozenRows,f._frozenRows=f.frozenRows+1);u.frozenColumns&&(f.frozenColumns=f._frozenColumns=o[1]+u.frozenColumns,f._frozenColumns=f.frozenColumns+1)}},_generateSheetName:function(n){var t,f,r,o=1,u=this.model.sheets,e=this._getLocStr("Sheet"),i=u[n];for(r=i&&i.sheetName||e+n,t=1,f=u.length;t<f;t++)u[t].sheetInfo&&r===u[t].sheetInfo.text&&(t=0,r=i&&i.sheetName?i.sheetName+o++:e+ ++n);return r},_initRangeSettings:function(n){var i,u=this.getSheet(n),r=u.rangeSettings.length;if(r)while(r--)i=u.rangeSettings[r],i.dataSource&&(i._jsonData=i._dataManager=null,i.dataSource instanceof t.DataManager?i._dataManager=i.dataSource:i._jsonData=i.dataSource,i.showHeader!=!1&&(i.showHeader=!0))},_initCSSTag:function(){if(!document.getElementById(this._id+"_sscustomformat")){this.isImport&&(this._dataContainer.hashCode=[]);var n,r,i=0,t;if(t=this._renderStyleTag("custom"),this.isImport)this._refreshImpStyles(this._impData.dataContainer.hashCode);else if(this.XLFormat)for(n="s:11pt/b:#FFC7CE;c:#82012A;f:calibri;s:11pt/b:#C6EED2;c:#0A7043;f:calibri;s:11pt/b:#FEEC9B;c:#826717;f:calibri;s:11pt/f:Calibri;w:bold;v:top;s:11pt/f:calibri;s:18pt/b:#DDE5F6;f:calibri;s:11pt/b:#FDE0D2;f:calibri;s:11pt/b:#EEEEEC;f:calibri;s:11pt/b:#FEF4CD;f:calibri;s:11pt/b:#9CC0E7;f:calibri;s:11pt/b:#F9AD7B;f:calibri;s:11pt/b:#C9C9C9;f:calibri;s:11pt/b:#FED965;f:calibri;s:11pt/b:#559AD9;c:#FFFFFF;f:calibri;s:11pt/b:#EB7E2F;c:#FFFFFF;f:calibri;s:11pt/b:#A5A5A5;c:#FFFFFF;f:calibri;s:11pt/b:#FDBF01;c:#FFFFFF;f:calibri;s:11pt".split("/"),r=n.length;i<r;)this.XLFormat._createFormatClass(this._getStyleAsJSON(n[i]),null,!0),i++;n=".e-spreadsheet .e-hide, .e-spreadsheet .e-mc-hide, .e-spreadsheet .e-fr-hide, .e-spreadsheet .e-fc-hide, .e-spreadsheet .e-c-hide, .e-spreadsheet .e-r-hide, .e-spreadsheet .e-col-hide{ display: none}";n+=".e-spreadsheet .e-rowcell.e-redft { background-color: #FFC7CE; color: #9C0055;} .e-spreadsheet .e-rowcell.e-yellowft { background-color: #FFEB9C; color: #9C6500;}";n+=".e-spreadsheet .e-rowcell.e-greenft { background-color: #C6EFCE;   color: #006100;} .e-spreadsheet .e-rowcell.e-redf { background-color: #FFC7CE;} .e-spreadsheet .e-rowcell.e-redt { color: #9C0055;}";n+=".e-spreadsheet .e-rowcell.e-hlcell { background-color: #FFFF00; color: #FF0000;} .e-spreadsheet .e-rowcell.e-goto-blank { background-color: #C6C6C6;}";t.styleSheet?t.styleSheet.cssText+=n:t.appendChild(document.createTextNode(n))}this._renderStyleTag("showhide")},_initEditForm:function(){var n,i,r;n=t.buildTag("input","",{display:"none"},{id:this._id+"_AutoComplete"});n.addClass("e-hide");this.element.append(n);this.XLEdit._renderAutoComplete(n,"",null,!0);n.data("ejAutocomplete")._setListPosition=function(){};i=t.buildTag("form","",{width:1,height:1,display:"none"},{id:this._id+"EditForm"});r=t.buildTag("input","",{width:1,height:1,overflow:"hidden",opacity:0},{id:this._id+"_ValElem"});i.append(r);r.data("id",this._id);this.element.append(i)},_getStyleAsJSON:function(n){var t,r,i=0,u={},f={b:"background-color",c:"color",f:"font-family",s:"font-size",w:"font-weight",v:"vetical-align",bo:"border"};for(n=n.split(";"),r=n.length;i<r;)t=n[i].split(":"),u[f[t[0]]]=t[0]==="bo"?this.XLRibbon._getBorderObj(t[1].split("-")[0],t[1].split("-")[1]):t[1],i++;return u},_initLayout:function(){this.model.showRibbon&&(this.XLRibbon._renderRibbon(),this._tabMode&&n("#"+this._id+"_Ribbon").ejRibbon("collapse"));this.model.allowFormulaBar&&this._renderFormulaBar();this._renderFUpload();this._renderLayout()},_renderLayout:function(){var n,t;for(this._renderPanel(),this._initTags(),this._initDependencies(),this._renderFooter(),this._refreshSheetLayout(),this.model.scrollSettings.allowVirtualScrolling||this.model.scrollSettings.allowSheetOnDemand?n=t=this.getActiveSheetIndex():(n=1,t=this.model.sheetCount);n<=t;)this._initSheet(n),n++},_renderPanel:function(){var i,n,r=this.model.scrollSettings;i=t.buildTag("div.e-spreadsheetgrppanel","",{},{id:this._id+"GroupPanel"});this.setGroupPanel(i);n=t.buildTag("div.e-spreadsheetmainpanel",this._renderDIV("e-spreadsheet-list",""),{},{id:this._id+"MainPanel"});i.append(n);this.setMainPanel(n);n=t.buildTag("div.e-spreadsheetactpanel","",{height:r.height,width:this.model.activationPanelWidth-1,display:"none"},{id:this._id+"ActivationPanel"});i.append(n);this.setActivationPanel(n);this.element.append(i)},_refreshSheetLayout:function(){var i,r,t,u,f=-1,e=this.model.pageSettings.pagerHeight+1;this._updateResponsiveSettings();this.XLRibbon._ribbonState&&(f=n("#"+this._id+"_Ribbon").find(".e-content:eq(1)").height());t=this._phoneMode?n("#"+this._id+"_Ribbon").height():n("#"+this._id+"_Ribbon").find(".e-header").height()+f+2;r=this.model.allowFormulaBar?this._formulaHeight:0;u=t&&this.model.showRibbon&&n("#"+this._id+"_Ribbon").is(":visible")?t:0;this.model.showPager&&this.element.find(".e-spreadsheetfooter").is(":visible")||(e=1);i=this._responsiveHeight-(u+r+2);this._browserDetails.name=="msie"||this._isAutoWHMode||this.element.find(".e-spreadsheet-list").height(i-e)},_initTags:function(){var n=t.buildTag("span#"+this._id+"_emptySpan"),i=t.buildTag("div#"+this._id+"_emptyDiv");this.element.find(".e-spreadsheetmainpanel")[0].insertBefore(n[0],this.element.find(".e-spreadsheetmainpanel").find(".e-spreadsheet-list")[0]);this.element.find(".e-spreadsheetmainpanel")[0].insertBefore(i[0],this.element.find(".e-spreadsheetmainpanel").find(".e-spreadsheet-list")[0]);this._refreshGlobalSpan()},_refreshGlobalSpan:function(t,i){t=t||document.getElementById(this._id+(i?"_emptyDiv":"_emptySpan"));t.textContent="";t.className="";this._browserDetails.name==="msie"&&this._browserDetails.version==="8.0"?n(t).removeAttr("style").text(""):t.removeAttribute("style")},_initSheet:function(n){var u,t=0,i=this.getSheet(n),r=this.getDataSettings(n);if(this._updateResponsiveSettings(),this._initViewPort(n),r&&!this._sheetCopy.isSheetCopy)for(u=r.length;t<u;)this._initDataSrc(n,i,r[t]),t++;i._reqCnt===i._resCnt&&this._renderSheet(n)},_initViewPort:function(t){var c=-1,u,i,f,e,o,s,h,l=this.model.scrollSettings,r=this.getSheet(t);u=i=f=e=o=s=h=0;l.allowScrolling&&(f=this._scrollerHeight,e=this._scrollerWidth);r.showHeadings&&(o=this._colHeaderHeight,s=this._rowHeaderWidth);this.model.showRibbon&&(i=n("#"+this._id+"_Ribbon").height(),i=i<189?i:188);this.model.allowFormulaBar&&(h=this._formulaHeight);this.model.showPager&&this.element.find(".e-spreadsheetfooter").is(":visible")&&(c=this.model.pageSettings.pagerHeight);this.getActivationPanel().is(":visible")&&(u=this.getActivationPanel().width());r._vPortHgt=this._responsiveHeight-(i+h+o+c+f);r._vPortWth=this._responsiveWidth-(u+e+s);l.allowVirtualScrolling&&(r._virtualBlockRowCnt=Math.ceil(r._vPortHgt/r.rowHeight)+this._bufferCnt)},_initDataSrc:function(n,i,r){if(r._dataManager){if(r._dataManager instanceof t.DataManager)if(r._dataManager.ready){var u=this;i._reqCnt++;this._reqCnt++;r._dataManager.ready.done(function(){u._initDataMngr(n,i,r)})}else this._initDataMngr(n,i,r)}else r._jsonData&&(r.count=r._jsonData.length)},_initDataMngr:function(n,i,r){var u,f,h,s,c,e,o=0,l=this;if(r._isDataManager=!0,r._isOffline=r._dataManager.dataSource.offline,r.query||(r.query=new t.Query),r.query.requiresCount(),this.model.scrollSettings.allowVirtualScrolling){if(s=r.query.queries,u=s.length,u)while(u--)f=s[u],f.fn==="onTake"?(o=f.e.nos,s.splice(u,1)):f.fn==="onSkip"&&(r._skip=f.e.nos);e=i._virtualBlockRowCnt*2;r.startCell&&(h=this.getRangeIndices(r.startCell),h[0]&&(e-=h[0]-0));o&&o<e&&(e=o);r.query.take(e)}c=r._dataManager.executeQuery(r.query);c.done(function(t){u=t.count||t.result.length;u&&(r._jsonData=t.result,r.count=o||u);l._respHandler(n)});c.fail(function(){l._respHandler(n)});r._dataManager.isDataAvailable||(i._reqCnt++,this._reqCnt++)},_respHandler:function(n){var t=this.getSheet(n);t._resCnt++;this._resCnt++;t._reqCnt===t._resCnt&&this._renderSheet(n);this._initComplete()},_renderSheet:function(i){var u,e,c,o,f=this.getActiveSheetIndex(),r=this.getSheet(i),l=r.sheetInfo.value,s={},h=this.element.find("#"+this._id+"_"+l);this._resizeColl[i-1]=!1;this._isInitLoad&&this._trigger("load",{sheetIndex:i});this._initTmplColumns(i);u=h.length===1?h:t.buildTag("div.e-sheet e-hide ","",{},{id:this._id+"_"+l});u.append(this._renderContent(i));h.length||(this.model.allowFreezing&&(o=this.XLFreeze._getHFreeze()),o?o.before(u):this.element.find(".e-spreadsheet-list").append(u));r.showGridlines===!1&&n("#"+this._id+"_Ribbon_PageLayout_Show_Gridlines").ejCheckBox({checked:r.showGridlines});this.model.enableContextMenu&&(this.XLCMenu._initContextMenu(),this.XLCMenu._initColorDialog(),this.XLCMenu._initCMenuFooter());this._updateResponsiveSettings();this._removeClass(u,"e-hide");s.width=this._responsiveWidth;s.height=this._responsiveHeight;this.model.showRibbon&&!this._isAutoWHMode&&(this._tabMode||this._responsiveHeight<280)&&n("#"+this._id+"_Ribbon").ejRibbon("collapse");this._setSheetWidthHeight(i,s,null,"refresh","initial");this._refreshCellBinding(i);this._refreshImpResRowHght(i);this.refreshContent(i);i===f&&this._updateHiddenRows(f);this._initializePicture(i);this.isImport&&this.model.allowCellType&&this.model.allowAutoCellType&&this._celltypes.length&&this._processCellTypes(this._celltypes,i);this.model.allowCellType&&!this.model.scrollSettings.allowVirtualScrolling&&this.XLCellType._rangeCellTypes(r.cellTypes,i);r._isImported&&!this._sheetCopy.isSheetCopy&&(this.setActiveSheetIndex(i),this._refreshImpSheets(i),this.setActiveSheetIndex(f));i!==f?u.hide():this._initSelection();this._initSheetModel(i);this.isImport&&r._isFreezed&&(c=this._impData.model.sheets[i],e=this.getRangeIndices(c.paneTopLeftCell),this._isFrozen(r.frozenRows)&&this.XLScroll._vScroller(i).scroll(this._getRowOffsetTop(r,e[0])-r._frozenHeight),this._isFrozen(r.frozenColumns)&&this.XLScroll._hScroller(i).scroll(this._getColOffsetLeft(r,e[1])-r._frozenWidth));r._isLoaded=!0;!this._isSheetInsert&&(this._pageClickArgs||this._gotoPageArgs)&&this._pageLoadComplete(i);this.getSheet(f)._isOpened=!0;this.model.showRibbon&&(n("#"+this._id+"_Ribbon")[0].style.overflow==="hidden"&&(n("#"+this._id+"_Ribbon")[0].style.overflow="",this.model.showRibbon&&this.XLRibbon._refreshBackstageHeight()),r._isRibCollapsed=!this.XLRibbon._ribbonState);this._isAutoWHMode&&this._autoSSWidthHeight(i)},_initSheetModel:function(n){var u,f,e,o,t=this.getSheet(n),i=this.getFrozenRows(n),r=this.getFrozenColumns(n);t.showHeadings===!1&&this.showHeadings(t.showHeadings);t._isImported&&(o=this._impData.model.sheets[n],u=this.getRangeIndices(o.topLeftCell||"A1"));f=t._isImported?u[0]:this._isFrozen(i)&&t._bottomRow.idx<=i?i-1:0;e=t._isImported?u[1]:this._isFrozen(r)&&t._rightCol.idx<=r?r-1:0;this.model.scrollSettings.allowScrolling&&(f>0&&this.XLScroll._vScroller(n).scroll(this._getRowOffsetTop(t,f)),e>0&&this.XLScroll._hScroller(n).scroll(this._getColOffsetLeft(t,e)));this.model.allowFreezing&&(this._isFrozen(i)&&this._isFrozen(r)?this.XLFreeze.freezePanes(i,r):this._isFrozen(i)?this.XLFreeze._freeze(i):this._isFrozen(r)&&this.XLFreeze._freeze(null,r))},_initTmplColumns:function(n){var u,f,i,r,e,t=this.getSheet(n);if(!this._sheetCopy.isSheetCopy&&!t.rangeSettings.length&&t.dataSource&&t._jsonData&&t.fieldAsColumnHeader&&(r=t._jsonData[0],e=this.getRangeIndices(t.startCell),u=e[1]+1,r)){for(i in r)r.hasOwnProperty(i)&&(f=r[i],typeof r[i]=="object"&&(i=this._iterateComplxObj(r[i],i).prop),t.columns[u-1]={field:this._generateHeaderText(u),text:i,type:f!=null?f.getDay?"date":typeof f:null},u++);t.colCount=t._templateColCount=t.columns.length;t._isTemplate=!0}},_refreshCellBinding:function(n){var t,r,f,l=this.getSheet(n),e=l.mergeCells,o=l.hideRows,u,i,s,h,c;if(e.length)for(u=0,f=e.length;u<f;u++)for(i=this.getRangeIndices(e[u]),s=i[2]-i[0]+1,h=i[3]-i[1]+1,c,t=0;t<s;t++)for(r=0;r<h;r++)c=t==0&&r==0?{merge:{isMerge:!0,mRange:e[u],isCenterAlign:!1,mSpan:{colSpan:h,rowSpan:s}}}:{isMHide:!0,mergeIdx:{rowIndex:i[0],colIndex:i[1]}},this.XLEdit._updateDataContainer({rowIndex:i[0]+t,colIndex:i[1]+r},{dataObj:c,sheetIdx:n,skipCell:!0});if(o.length&&this.model.scrollSettings.allowVirtualScrolling)for(t=0,f=o.length;t<f;t++)this._cellBindHiddenRows(o[t],o,n)},_cellBindHiddenRows:function(n,t,i){var r,u,e=this.getSheet(i),f=this.XLEdit;e.hideRowsCollection.push(n);this.XLScroll._getRowHeights(i,t.sort()[0]);u=n===0?{rowIndex:n,colIndex:0}:{rowIndex:n-1,colIndex:0};r={rowIndex:n,colIndex:0};f._updateDataContainer(u,{dataObj:{hRow:!0},sheetIdx:i,skipCell:!0});f._updateDataContainer(r,{dataObj:{isRHide:!0},sheetIdx:i,skipCell:!0})},_updateHiddenRows:function(n){var i,r,h,a,c,u=this.getSheet(n),s=u.hideRows,f,v=u.cFormatRule,e,o=u.hideColumns,l=u.border;if(s.length&&!this.model.scrollSettings.allowVirtualScrolling)for(i=0,r=s.length;i<r;i++)f=s[i],h=this.getRows(n),a=h[1],c=h[0],this.addClass(a[f],"e-r-hide"),this.addClass(c[f],"e-r-hide"),f>0&&this.addClass(c.eq(f-1).find("td")[0],"e-hrow"),this._cellBindHiddenRows(f,s,n);if(o.length&&!this.model.scrollSettings.allowVirtualScrolling){for(i=0,r=o.length;i<r;i++)u.hideColsCollection[o[i]]||this._updateHiddenColumns({rowIndex:0,colIndex:o[i]},n);this.XLScroll._getColWidths(n,o.sort()[0])}if(!t.isNullOrUndefined(v)&&v.length)for(i=0,r=u.cFormatRule.length;i<r;i++)e=u.cFormatRule[i],this.XLCFormat._cFormat(e.action,e.inputs[0],e.inputs[1],e.color,e.range,n);if(l.length&&!this.model.scrollSettings.allowVirtualScrolling)for(i=0,r=l.length;i<r;i++)this._updateCellBorder(l[i],n)},_updateHiddenColumns:function(n,t){var h=n.rowIndex,i=n.colIndex,u=this.getSheet(t),f={isCHide:!0},r=this._getJSSheetHeader(t),e=r.find("th"),o=r.find("col"),s=this._getContent(t).find("col");u.hideColsCollection[i]=u.columnWidth;u.columnsWidthCollection[i]=0;i===0&&(f.hCol=!0);this._writeRule(i,t);this.addClass(e[i],"e-hide");this.addClass(o[i],"e-hide");this.addClass(s[i],"e-hide");r.find("th:eq("+(i-1)+")").hasClass("e-hide")||this.addClass(r.find("th:eq("+(i-1)+")")[0],"e-hcol");this.XLEdit._updateDataContainer({rowIndex:0,colIndex:i},{dataObj:f,sheetIdx:t,skipCell:!0});i>0&&this.isUndefined(this.XLEdit.getPropertyValue(0,i-1,"isCHide"))&&this.XLEdit._updateDataContainer({rowIndex:0,colIndex:i-1},{dataObj:{hCol:!0},sheetIdx:t,skipCell:!0})},_renderContent:function(n){var r=[],i=t.buildTag("div.e-spreadsheetheader"),o=t.buildTag("div.e-headercontent"),h=t.buildTag("div.e-spreadsheetcolumnheader e-icon e-ss-selectall  e-ss-cursor","",{},{}),u=t.buildTag("div.e-spreadsheetcontentcontainer","",{"-webkit-tap-highlight-color":"rgba(0,0,0,0)"}),s=t.buildTag("div.e-content e-ss-cursor"),f=t.buildTag("div.e-spreadsheetrowheader","",{float:"left",width:"30px"},{}),e=t.buildTag("div.e-rowheadercontent");return this._isAutoWHMode&&(s.addClass("e-rmvbtmbdr"),o.addClass("e-rmvrghtbdr"),e.addClass("e-rmvbtmbdr")),this._setJSSheetHeader(i,n),i.append(h),i.append(o),r.push(i),i=t.buildTag("div.e-spreadsheetcontent"),this._setJSSheetContent(i,n),this._setContent(u,n),this._setJSSheetRowHeader(f,n),this._setJSSheetRowHeaderContent(e,n),f.append(e),u.append(s),i.append(f),i.append(u),r.push(i),r},refreshContent:function(n){n=n||this.getActiveSheetIndex();var t,i,e=this.getSheet(n),u=this.model.scrollSettings,f=u.allowVirtualScrolling,r=this._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content");this._initDataRange(n);this._refreshRowColCnt(n);this._getJSSheetHeader(n).find(".e-headercontent").html(this._renderHeaderColumns(n));this._refreshTemplates(n);this._getJSSheetRowHeaderContent(n).html(this._renderHdrRows(n));r.find(".e-table").remove();r.prepend(this._renderContTable(n));this._initViewPortCont(n);this._isAutoWHMode?this._isInitLoad||this._autoSSWidthHeight(n):this.XLScroll._refreshScroller(n,"refresh","all");f||(this.XLScroll._getFirstRow(n),this.XLScroll._getFirstColumn(n));t=this._getContTBody(n).find("tr");i=this._getRowHdrTBody(n).find("tr");this.setRows([i,t],n)},_autoSSWidthHeight:function(t,i){var r={},f=this.model.scrollSettings,u=n("#"+this._id+"_Ribbon").data("ejRibbon");t=t||this._getSheetIndex();this._responsiveWidth=this._dlgWidth=r.width=this._getContTBody(t).width()+this._getJSSheetRowHeader(t).width();this.model.showRibbon&&r.width<=480?(r.width=480,this._getContent(t).find(".e-content").removeClass("e-rmvrghtbdr")):i||this._getContent(t).find(".e-content").addClass("e-rmvrghtbdr");i||this._setSheetWidthHeight(t,r,null,"refresh");this.model.showRibbon&&(r.width<=480&&this._alignFormulaBar(r.width),this.XLRibbon._refreshBackstageHeight(),u.setModel({width:r.width}));this._responsiveHeight=this._dlgHeight=r.height=this.element.height()},_initDataRange:function(n){var c,r,t,e,o,u,f,s=0,i=this.getSheet(n),h=this.getDataSettings(n);if(h)for(c=h.length;s<c;)t=h[s],t._jsonData&&(t.batchChanges={added:[],changed:[],deleted:[]},t.fields=this.getObjectKeys(t._jsonData[0]),r=t.startCell?this._toIntrnlRange(t.startCell,n):[0,0,0,0],r[2]=r[0]+(!t.fieldAsColumnHeader&&t.showHeader?t.count:t.count-1),r[3]=r[1]+this.getObjectLength(t._jsonData[0])-1,t.range=r,u=r[2],f=r[3],(this._isAutoWHMode||i.usedRange.rowIndex<u)&&(i.usedRange.rowIndex=u),(this._isAutoWHMode||i.usedRange.colIndex<f)&&(i.usedRange.colIndex=f),e=u+1,o=f+1,(this._isAutoWHMode||i.rowCount<e)&&(i.rowCount=e),(this._isAutoWHMode||i.colCount<=o)&&(i.colCount=o),i._hasDataSrc=!0),s++},_renderStyleTag:function(n){var i,t;return i=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],t=document.createElement("style"),t.type="text/css",n=="custom"?(t.setAttribute("id",this._id+"_sscustomformat"),i.appendChild(t)):n!=="showhide"||document.getElementById(this._id+"_sshide")||(t.setAttribute("id",this._id+"_sshide"),i.appendChild(t)),t},_renderHeaderColumns:function(i){var f,r,e,u,o=document.createElement("thead");return u=this._renderHeaderCol(i,0,this.getSheet(i).colCount),r=t.buildTag("table.e-table")[0],this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal?n(r).width(this._getEntireColWidth(i)):this.addClass(r,"e-ss-hdrspacing"),e=u[1],f=u[0],o.appendChild(f),r.appendChild(e),r.appendChild(o),r},_renderHeaderCol:function(n,i,r){var e,h,c,b,l,a,v,y,o,s=0,p=[],f=i,u=this.getSheet(n),w=document.createElement("tr"),k=document.createElement("colgroup");for(w.className="e-columnheader",this.isImport||(u._colWidthCollection.length=0,u._ofColWidthColl.length=0),u._colWidthCollection.push(s),u._ofColWidthColl.push(s);f<r;)e="e-headercell",l="col",o=u.columnsWidthCollection[f],this.isUndefined(o)&&(o=u.columnsWidthCollection[f]=u.columnWidth),f!=r-1&&(s=u._colWidthCollection[u._colWidthCollection.length-1]+o,u._colWidthCollection.push(s),u._ofColWidthColl.push(s)),this.model.allowSelection&&this._inColumn(u.selectedRange,f)&&(e+=" e-colhighlight",u._isColSelected&&(e+=" e-colselected")),o<1?(l+=".e-hide",e+=" e-hide"):u._hiddenFreezeCols.indexOf(f)>-1&&(l+=".e-fcol-hide",e+=" e-fcol-hide"),(this.IsImport||u._isLoaded)&&this.XLEdit.getPropertyValue(0,f,"hCol")&&(e+=" e-hcol"),h=document.createElement("th"),h.className=e,a=v=this._generateHeaderText(f+1),u.fieldAsColumnHeader&&u.columns[f]&&(a=u.columns[f].text),c=document.createElement("div"),c.className="e-headercelldiv",c.innerHTML=a,h.appendChild(c),b=t.buildTag(l,"",{width:o},{}),w.appendChild(h),k.appendChild(b[0]),this._sheetCopy.isSheetCopy||u.columns[f]||(u.columns[f]={field:v,text:v,type:y!=null?y.getDay?"date":typeof y:null}),f++;return p.push(w),p.push(k),p},_getWidth:function(n,t,i){for(var r=0,u=this.getSheet(i);n<=t;n++)r+=u.columnsWidthCollection[n];return r},_getEntireColWidth:function(n){var t=this.getSheet(n),i=this._getIdxWithOffset(null,this._getLastColIdx(t)).xOffset;return i+t.columnsWidthCollection[t.columnsWidthCollection.length-1]},_getLastColIdx:function(n){for(var t=n.colCount-1;t>-1;){if(!(t in n.hideColsCollection)&&n._hiddenFreezeCols.indexOf(t)===-1)break;t--}return t},_getIdxWithOffset:function(n,i,r,u,f){u=u||[];var s,h,p,e,c,l,a,y={},v=t.Spreadsheet.HideTypes,o=this.getSheet(f);if(e=c=l=a=0,!t.isNullOrUndefined(n)){if(r)for(p=o.rowsHeightCollection.length;e<p;){if(s=h=!1,u.indexOf(v.Default)===-1&&o.hideRowsCollection.indexOf(e)>-1&&(s=!0),u.indexOf(v.Freeze)===-1&&o._hiddenFreezeRows.indexOf(e)>-1&&(h=!0),!s&&!h){if(l+=o.rowsHeightCollection[e],l>n){c=e;break}a=l}e++}else{while(e<n)s=h=!1,u.indexOf(v.Default)===-1&&o.hideRowsCollection.indexOf(e)>-1&&(s=!0),u.indexOf(v.Freeze)===-1&&o._hiddenFreezeRows.indexOf(e)>-1&&(h=!0),s||h||(a+=o.rowsHeightCollection[e]),e++;c=n}y.rowIdx=c;y.yOffset=a}if(!t.isNullOrUndefined(i)){if(r)for(e=c=l=a=0,p=o.columnsWidthCollection.length;e<p;){if(s=h=!1,u.indexOf(v.Default)===-1&&e in o.hideColsCollection&&(s=!0),u.indexOf(v.Freeze)===-1&&o._hiddenFreezeCols.indexOf(e)>-1&&(h=!0),!s&&!h){if(l+=o.columnsWidthCollection[e],l>i){c=e;break}a=l}e++}else{while(e<i)s=h=!1,u.indexOf(v.Default)===-1&&e in o.hideColsCollection&&(s=!0),u.indexOf(v.Freeze)===-1&&o._hiddenFreezeCols.indexOf(e)>-1&&(h=!0),s||h||(a+=o.columnsWidthCollection[e]),e++;c=i}y.colIdx=c;y.xOffset=a}return y},_getEntireRowHeight:function(n){var t=this.getSheet(n);return t._rowHeightCollection[t._rowHeightCollection.length-1]+t.rowsHeightCollection[t.rowsHeightCollection.length-1]},_renderHdrRows:function(n){var r,a,v,b,k,p,d,u,o,s,c,g,h,l,f,e,y,i=this.getSheet(n),w=this.model.scrollSettings.allowVirtualScrolling;if(h=t.buildTag("table.e-table","<colgroup><col style='width: 30px;'><\/colgroup>",{}),this.addClass(h[0],"e-ss-rowhdrspacing"),!this._sheetCopy.isSheetCopy){for(u=f=0,y=i.rows,r=0,p=i.rowCount,i._rowHeightCollection=[],i._rowIdxColl=[],i._rowHeightCollection.push(u);r<p;)l=i.rowsHeightCollection[r],l||(l=i.rowsHeightCollection[r]=i.rowHeight),w&&(i.hideRowsCollection.indexOf(r)!==-1||i._hiddenFreezeRows.indexOf(r)!==-1)?l=0:i._rowIdxColl.push(r),r!=p-1&&i._rowHeightCollection.push(i._rowHeightCollection[i._rowHeightCollection.length-1]+l),r++;if(y){for(e=-1,k=y.length,g=this._browserDetails.name==="mozilla"?2:1,a=0;a<k;a++){for(o=y[a],b=o.cells.length,this.isUndefined(o.index)||(f=o.index),u=o.height||i.rowHeight,i.rowHeight<u&&(i.rowsHeightCollection[f]=u,e===-1&&(e=f)),v=0;v<b;v++)s=o.cells[v],s.style&&s.style["font-size"]&&(c=document.getElementById(this._id+"_emptySpan"),d=this.XLFormat._createFormatClass(s.style),this.addClass(c,d),c.textContent=s.value,u=c.offsetHeight+g,u>i.rowsHeightCollection[f]&&(i.rowsHeightCollection[f]=u,e===-1&&(e=f)),this._refreshGlobalSpan(c)),this.isUndefined(s.value)||(i._hasDataSrc=!0);f++}e!==-1&&this.XLScroll._getRowHeights(n,e,!0)}}return w?h.append("<tbody class='e-ss-virtualtop'><\/tbody><tbody><\/tbody><tbody class='e-ss-virtualbottom'><\/tbody>"):h.append("<tbody>"+this._renderRowHdr(i._rowIdxColl,n)+"<\/tbody>"),this._setRowHdrTBody(h.find("tbody").eq(w?1:0),n),h},_renderRowHdr:function(i,r){for(var u,f,o=0,h=[],e=this.getSheet(r),s=i?i.length:e.rowCount;o<s;)u=i?i[o]:o,(t.isNullOrUndefined(this.XLEdit.getPropertyValue(u,0,"isFilterHide",r))||t.isNullOrUndefined(this.XLEdit.getPropertyValue(u,0,"isRHide",r)))&&(f={height:e.rowsHeightCollection[u]<this.model.rowHeight?this.model.rowHeight:e.rowsHeightCollection[u],rowidx:u},f.className=this.XLEdit.getPropertyValue(u,0,"hRow",r)?"e-rowheader e-hrow ":"e-rowheader",this.XLEdit.getPropertyValue(u,0,"isFilterHighlight",r)&&(f.className+=" e-filterhiglight"),f.wrap=this.XLEdit.getPropertyValue(u,0,"wrapRow",r)?" e-sswraprow":"",this.model.allowSelection&&this._inRow(e.selectedRange,u)&&(f.className+=" e-rowhighlight",e._isRowSelected&&(f.className+=" e-rowselected")),h.push(f)),o++;return n.render[this._id+"JSONRowHdrTemplate"+r](h)},_refreshDataSrc:function(n,t){var r,e,f,o,c,u,i,w,l,s,a,h,v,y=0,b=this.getSheet(t),p=this.getDataSettings(t);if(h=v=!1,!b.rangeSettings.length&&b.dataSource&&(v=!0),p)for(w=p.length;y<w;){if(i=p[y],i.range)if(s=i.range,h=v?!i.fieldAsColumnHeader&&i.showHeader:i.showHeader,this.getObjectLength(i.headerStyles)&&this.model.allowCellFormatting&&(l=this.XLFormat._createFormatClass(i.headerStyles)),n)for(r=n[0],e=n[2],o=n[3];r<=e;){if(this._inRow(s,r))for(f=n[1];f<=o;)this._inColumn(s,f)&&(a=i.fields[f-i.range[1]],h&&r===s[0]?(u=i._jsonData[r-i.range[0]],u&&this._refreshCell(r,f,t,i,u,a,!1,l)):(u=i._jsonData[r-(i.range[0]+(h?1:0))],u&&this._refreshCell(r,f,t,i,u,a,!0))),f++;r++}else{if(r=0,e=s[0],o=s[1],f=s[2],h){u=i._jsonData[r];for(c in u)this._refreshCell(e,o,t,i,u,c,!1,l),o++;e++}while(e<=f){u=i._jsonData[r];o=s[1];for(c in u)this._refreshCell(e,o,t,i,u,c,!0),o++;r++;e++}}y++}},_refreshCell:function(n,t,i,r,u,f,e,o){var s,h=this._iterateComplxObj(u[f],f),c=this.getSheet(i);s=this.XLEdit._parseValue(e?h.value:h.prop,{rowIndex:n,colIndex:t});s.sheetIdx=i;r.rangeName&&(s.rangeName=r.rangeName);e?r.primaryKey===f&&(s.isReadOnly=!0):(o&&(s.format=o,s.formats=r.headerStyles),!c.rangeSettings.length&&c.dataSource&&(s.isReadOnly=!0));this.XLEdit._updateDataContainer({rowIndex:n,colIndex:t},{dataObj:s,sheetIdx:i,skipCell:!0})},_iterateComplxObj:function(n,t,i){var r,u,e,o=i||t,f={prop:o,value:n};if(this._isObject(n)){e=".";for(r in n){if(u=n[r],this.isUndefined(u))return f;if(n.hasOwnProperty(r)&&this._isObject(u)&&!this._isDateTime(u))o+=e+r,f=this._iterateComplxObj(u,r,o);else return f.prop+=e+r,f.value=u,f}}return f},_refreshCellData:function(t,i){var f,l,w,u,a,e,r,k,v,y,h,d,o=0,s=this.getSheet(i),p=s.rows,c=s.hideColumns,b=s.border;if(p){for(f=0,h=p.length;f<h;f++){if(e=0,w=p[f],a=p[f].cells,w.index&&(o=w.index),(!t||this._inRow(t,o))&&a)for(l=0,d=a.length;l<d;l++)u=a[l],u.index&&(e=u.index),(!t||this._inColumn(t,e))&&(r=this.isUndefined(u.value)?{}:this.XLEdit._parseValue(u.value,{rowIndex:o,colIndex:e}),r.value=this.isUndefined(r.value)?this.isUndefined(this.XLEdit.getPropertyValue(o,e))?"":this.XLEdit.getPropertyValue(o,e):r.value,v=this.isFormula(r.value),v&&(this.XLEdit._refreshCalcEngine(o,e,!0,r.value,i),this._applyFormula(i,o,e)),u.format&&(y=this.XLFormat._getFormatObj(u.format),r.type=u.format.type,r.formatStr=y.format.formatStr,r.decimalPlaces=y.format.decimalPlaces,r.thousandSeparator=y.format.thousandSeparator?!0:!1),r.value2=this.XLFormat._format(v?this.XLEdit.getPropertyValue(o,e,"value2"):r.value,{formatStr:r.formatStr,type:r.type,thousandSeparator:r.thousandSeparator,decimalPlaces:r.decimalPlaces,cellObj:r}),u.hyperlink&&(r.hyperlink=u.hyperlink.webAddr?u.hyperlink.webAddr.indexOf("http")===-1?{webAddr:"http://"+u.hyperlink.webAddr}:{webAddr:u.hyperlink.webAddr}:{cellAddr:u.hyperlink.cellAddr+"_"+u.hyperlink.sheetIndex||i},r.formats={color:this._hlColor}),u.comment&&(k=(this.model.userName.length?this.model.userName:this._getLocStr("UserName"))+":\n",r.comment={value:k+(u.comment.value||""),isVisible:u.comment.isVisible||!1}),u.isLocked&&(r.isLocked=!0,this.protectSheet(!0)),u.style&&(r.formats=n.extend(r.formats,u.style)),r.formats&&(r.format=this.XLFormat._createFormatClass(r.formats)),this.XLEdit._updateDataContainer({rowIndex:o,colIndex:e},{dataObj:r,sheetIdx:i,skipCell:!0}),this.XLEdit._refreshCellAlignment({cellIdx:{rowIndex:o,colIndex:e},value:r.value,type:r.type}),v||this.XLEdit._refreshCalcEngine(o,e,!1,null,i)),e++;o++}this.model.scrollSettings.allowVirtualScrolling&&(s._virtualTBodyHgt=s._rowHeightCollection[s._rowHeightCollection.length-1]+s.rowsHeightCollection[s.rowsHeightCollection.length-1])}if(c.length&&this.model.scrollSettings.allowVirtualScrolling){for(f=0,h=c.length;f<h;f++)s.hideColsCollection[c[f]]||this._updateHiddenColumns({rowIndex:0,colIndex:c[f]},i);this.XLScroll._getColWidths(i,c.sort()[0])}if(b.length&&this.model.scrollSettings.allowVirtualScrolling)for(f=0,h=b.length;f<h;f++)this._updateCellBorder(b[f],i)},_updateCellBorder:function(n,t){var r,f,e,i,u,o=this.getRangeIndices(n.range);if(e={top:{top:"1px solid"},right:{right:"1px solid"},bottom:{bottom:"1px solid"},left:{left:"1px solid"},outside:{top:"1px solid",right:"1px solid",bottom:"1px solid",left:"1px solid"},allborder:{top:"1px solid",right:"1px solid",bottom:"1px solid",left:"1px solid"},thickbox:{top:"2px solid",right:"2px solid",bottom:"2px solid",left:"2px solid"},thickbottom:{bottom:"2px solid"},topandbottom:{top:"1px solid",bottom:"1px solid"},topandthickbottom:{top:"1px solid",bottom:"2px solid"}},i=e[n.type],u=this.getObjectKeys(i),u.length)for(r=0,f=u.length;r<f;r++)i[u[r]]=i[u[r]].concat(" "+n.color);i.skipCell=!0;i.sheetIdx=t;n.type==="allborder"?this.XLFormat._applyAllBorderCss(i,o):this.XLFormat._applyBorderCss(i,o)},_renderContTable:function(i){var r;return this._sheetCopy.isSheetCopy?r=n(this._sheetCopy.sheetContent):(r=t.buildTag("table.e-table",this._sheets[i]._contentColGroup.outerHTML),this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal?n(r).width(this._getEntireColWidth(i)):this.addClass(r,"e-ss-rowhdrspacing"),this.model.scrollSettings.allowVirtualScrolling?r.append("<tbody class='e-ss-virtualtop'><\/tbody><tbody><\/tbody><tbody class='e-ss-virtualbottom'><\/tbody>"):r.append("<tbody><\/tbody>")),this._setContTBody(r.find("tbody").eq(this.model.scrollSettings.allowVirtualScrolling?1:0),i),r},_initViewPortCont:function(n){var i,t=this.getSheet(n);this.model.scrollSettings.allowVirtualScrolling?this._refreshViewport(this._initLoad?0:this._isFrozen(this.getFrozenRows())?t._contScrollTop:t._scrollTop,n):(i=this.getRangeData({property:["value","value2","comment","hyperlink","format","border","type","isFilterHide","isRHide","isFHide","isFilterHeader","isFilterVisible","filterState","isMHide","merge","hRow","isLocked","wrap","isOverflow","align","picture","cFormatRule","isOfBrdr","formatStr"],sheetIdx:n,rowIdxs:t._rowIdxColl,withRowIdx:!0}),this._getContTBody(n).html(this._renderData(i,n)),this.model.allowComments&&this.XLComment._updateCmntArrowPos(null,n));t._isVPRendered=!0},_processCellTypes:function(n,t){for(var r=[],i=0,u=n.length;i<u;i++)n[i].cellType.type==="DatePicker"?r.push({range:this._getAlphaRange(t,n[i].rowIndex,n[i].colIndex,n[i].rowIndex,n[i].colIndex),settings:{type:n[i].cellType.type,value:n[i].value}}):r.push({range:this._getAlphaRange(t,n[i].rowIndex,n[i].colIndex,n[i].rowIndex,n[i].colIndex),settings:{type:n[i].cellType.type,isChecked:n[i].cellType.isChecked}});this.XLCellType._rangeCellTypes(r,t);this._celltypes=[]},_initDependencies:function(){var t=this.model;this._renderAlertdlg();this._renderAlertDlgContent(n("#"+this._id+"_alertdlg"),"Alert","");this._initEditForm();t.allowClipboard&&this.XLClipboard._initCopyPaste();t.allowEditing&&(this.XLEdit._processEditing(),this.getMainPanel().append(this.XLEdit._editElem),this.XLEdit._editElem.hide());this._renderDDownList();this.clearUndoRedo();t.showRibbon&&this.XLRibbon._disableButtons(["clearfilter"],"ejButton");t.allowDataValidation&&this.XLValidate._addDVMethod();t.enableContextMenu&&this.XLCMenu._initCMenuFooter();t.allowFiltering&&this.XLFilter._renderExcelFilter();t.allowFreezing&&this.XLFreeze._initFreeze()},_initComplete:function(){this._reqCnt===this._resCnt&&(this._trigger("loadComplete",{}),this.isDirty=!1,this.clearUndoRedo(),this.hideWaitingPopUp(),this.XLRibbon.updateRibbonIcons())},_showDialog:function(t,i){var e,u="e-dialog",f=this.model,r;switch(t){case this._id+"_Ribbon_Home_Styles_ConditionalFormatting":r=n("#"+this._id+"_CFDialog");!r.length&&f.allowConditionalFormats&&(r=this.XLRibbon._initCFDialog());r.ejDialog("open");break;case this._id+"_chartname":r=n("#"+this._id+"_chartnamedlg");r.length||this.XLRibbon._renderChartNameDlg();break;case this._id+"_Ribbon_ChartDesign_Type_ChangeChartType":r=n("#"+this._id+"_charttypedlg");r.length||(r=this.XLRibbon._renderChartTypeDialog());break;case this._id+"_ImportPasswordDialog":r=n("#"+this._id+"_ImportPasswordDialog");r.length||(r=this._importPasswordDlg());r.ejDialog("open");break;case this._id+"_Ribbon_Insert_Links_Hyperlink":this.model.isReadOnly||(f.allowHyperlink&&!this._hasClass(document.getElementById(this._id+"_HLDialog"),u)&&this.XLRibbon._initHLDialog(),this._hlDlgOpen());break;case this._id+"_Ribbon_Others_Cells_InsertCellOptions":f.allowInsert&&(this._hasClass(document.getElementById(this._id+"_insertdeletedlg"),u)||this._renderInsertDeleteDialog(),this._refreshInsDelDialog("Insert"));break;case this._id+"_Ribbon_Others_Cells_DeleteCellOptions":f.allowDelete&&(this._hasClass(document.getElementById(this._id+"_insertdeletedlg"),u)||this._renderInsertDeleteDialog("delete"),this._refreshInsDelDialog("Delete"));break;case this._id+"_FormatCells":f.allowCellFormatting&&!this._hasClass(document.getElementById(this._id+"_formatdlg"),u)&&this.XLCellFrmtDlg._renderCellFrmtDlg();this.XLCellFrmtDlg._initFormatCellDlg();break;case this._id+"_MoveorCopy":this._hasClass(document.getElementById(this._id+"_moveCopyDlg",u))||this._initMoveCopyDlg();this._renderMoveCopyDlg();break;case this._id+"_UnhideSheet":this._hasClass(document.getElementById(this._id+"_UnhideDlg",u))||this._initUnhideDlg();this._renderUnhideDlg();break;case this._id+"_Ribbon_Data_DataTools_DataValidation":case this._id+"_Ribbon_Data_DataTools_DataValidationOptions":this.model.allowDataValidation&&!this._hasClass(document.getElementById(this._id+"_ValDialog"),u)&&(e=this.XLRibbon._initValDialog(),this.XLRibbon._renderValDialog(e));break;case this._id+"_Filter":document.getElementById(this._id+i+"_excelDlg")||document.getElementById(this._id+"_filter_custom_"+i)||this.XLFilter._renderFilterDialogs(i);break;case this._id+"_Ribbon_Review_Changes_ProtectWorkbook":this._hasClass(document.getElementById(this._id+"_PasswordDialog"),u)||this._passwordDlg();break;case this._id+"_Ribbon_Insert_Tables_Table":f.allowFormatAsTable&&!this._hasClass(document.getElementById(this._id+"_fatnamedlg"),u)&&this.XLRibbon._renderFATNameDlg();break;case this._id+"_Ribbon_Insert_Tables_PivotTable":f.enablePivotTable&&!this._hasClass(document.getElementById(this._id+"_PvtDialog"),u)&&(this.XLRibbon._initPvtDialog(),this.XLRibbon._renderPvtDialog());break;case this._id+"_Ribbon_Others_Editing_FindSelect":f.allowSearching&&!this._hasClass(document.getElementById(this._id+"_FRDialog"),u)&&(this.XLRibbon._initFRDialog(),this.XLRibbon._renderFRDialog(),this.model.isReadOnly||(e=this.XLRibbon._initGoToDialog(),this.XLRibbon._renderGoToDialog(e)));this.model.isReadOnly?n("#"+this._id+"_FRDialog_FPDlgTab").ejTab("option",{disabledItemIndex:[1,2]}):n("#"+this._id+"_FRDialog_FPDlgTab").ejTab("option",{enabledItemIndex:[1,2]});break;case this._id+"_Ribbon_ChartDesign_Data_SelectData":f.allowCharts&&!this._hasClass(document.getElementById(this._id+"_chartrangedlg",u))&&this.XLChart._renderChartRangeDialog();break;case this._id+"_Ribbon_Others_NameManager":document.getElementById(this._id+"_nmdlg")?n("#"+this._id+"_nmgrid").ejGrid("option",{dataSource:this.model.nameManager}):this.XLRibbon._renderNameManagerDlg();break;case this._id+"_Ribbon_Design_Tools_ResizeTable":document.getElementById(this._id+"_fatresizetabledlg")||this.XLRibbon._renderFATResizeTableDlg();break;case"exportxl":case"exportcsv":case"exportpdf":document.getElementById(this._id+"_ExportFileNameDialog")||this.XLExport._exportFileNameDlg()}},_generateHeaderText:function(n){var t="Z";return n/26>1?this._generateHeaderText(n%26==0?n/26-1:Math.floor(n/26))+String.fromCharCode(n%26==0?t.charCodeAt(t):64+n%26):String.fromCharCode(64+n)},_generateColCount:function(n){var i=0,t;for(n=n.split("").reverse().join(""),t=n.length-1;t>=0;t--)i+=(n[t].charCodeAt(n[t])-64)*Math.pow(26,t);return i},_getSheetIndex:function(n){return n||this.getActiveSheetIndex()},_getSheetIdxFromSheetValue:function(n){for(var t=1,i=this.model.sheets,r=i.length-1;t<=r;){if(i[t].sheetInfo.value.toLowerCase()===n.toLowerCase())return t;t++}return-1},getAlphaRange:function(n,t,i,r){return this.isUndefined(i)&&this.isUndefined(r)&&(i=n,r=t),this._getAlphaRange(null,n,t,i,r)},_getAlphaRange:function(n,t,i,r,u){return t=t+1,i=i+1,r=r+1,u=u+1,t===r&&i===u?this._generateHeaderText(i)+t:this._generateHeaderText(i)+t+":"+this._generateHeaderText(u)+r},_getProperAlphaRange:function(n,t,i,r,u){var f=this._getAlphaRange(n,t,i,r,u);return f.indexOf(":")===-1?f+":"+f:f},_getDollarAlphaRange:function(n,t){var u=this.getActiveSheetIndex(),i=this.getSheet(u).sheetInfo.text,r=i.match(/\s/g)?"'"+i+"'":i;return t&&!this.isRange(n)?r+"!$"+this._generateHeaderText(n[1]+1)+"$"+(n[0]+1):r+"!$"+this._generateHeaderText(n[1]+1)+"$"+(n[0]+1)+":$"+this._generateHeaderText(n[3]+1)+"$"+(n[2]+1)},_toIntrnlRange:function(n,t){return n?this._isString(n)&&(n=this.getRangeIndices(n)):n=this.getSheet(t).selectedRange,n},_getMaxRowColCnt:function(n,t,i){for(var u,f,r,e=0,o=0,n=n?n:this.model.sheets,s=i?i:1,h=i?i+1:n.length;s<h;)r=n[s],t&&r.usedRange?(u=r.usedRange.rowIndex,f=r.usedRange.colIndex):(u=r.rowCount,f=r.colCount),e<u&&(e=u),o<f&&(o=f),s++;return{rowCount:e,colCount:o}},_generateEJMenu:function(n,i,r){return{menuType:n==="normal"?t.MenuType.NormalMenu:t.MenuType.ContextMenu,orientation:i==="vertical"?t.Orientation.Vertical:t.orientation.Horizontal,cssClass:r}},_generateEJDD:function(t,i,r,u,f,e){return{dataSource:t,fields:i,selectedItemIndex:r,width:u,cssClass:"e-"+this._id+"-ddl",change:n.proxy(this.XLRibbon._frTypeChange,this,e)}},_heightWidthCalculation:function(t,i){var r,u=this.getActivationPanel(),f=u.is(":visible");this._isDisplayHeader?(r=n("#"+this._id+"_Ribbon").height(),this._isDisplayHeader=!1):r=this.XLRibbon._ribbonState?this.element.find(".e-ribbon").height()-1:this.element.find(".e-ribbon .e-header").height();this._refreshSheetWithScreen(t);this._updateResponsiveSettings();this._initViewPort(t);this._setSheetWidthHeight(t,{width:this._responsiveWidth,height:this._responsiveHeight},r,"refresh",i.action);f&&u.height(this.getMainPanel().height()-1);this.refreshContent(t)},_refreshSheetWithScreen:function(t){n("#"+this._id+"GroupPanel")[0].style.height="0px";n("#"+this._id+"MainPanel")[0].style.height="0px";this.model.allowFormulaBar&&(this.element.find(".e-formulabar")[0].style.width="0px");this.getSheetElement(t).find(".e-spreadsheetcontentcontainer")[0].style.height="0px";this.getSheetElement(t).find(".e-spreadsheetrowheader")[0].style.height="0px"},_refreshWidthHeight:function(i,r,u,f){var s,y=1,p=0,e=this._getContent(i),h,c,w=this.model.pageSettings.pagerHeight+1,b,l=this.getSheet(i),a=this._getJSSheetRowHeader(i),v,k,d=-1,g=n("#"+this._id+"_Ribbon").ejRibbon("instance"),o,nt;return b=this.model.showRibbon?g.model.selectedItemIndex<1?1:g.model.selectedItemIndex:0,this.XLRibbon._ribbonState&&(d=n("#"+this._id+"_Ribbon").find(".e-content:eq("+b+")").height()),v=this._phoneMode?n("#"+this._id+"_Ribbon").height():n("#"+this._id+"_Ribbon").find(".e-header").height()+d+2,c=this.model.allowFormulaBar&&this.element.find("#"+this._id+"_formulabar").is(":visible")?this._formulaHeight:0,u=v&&this.model.showRibbon&&n("#"+this._id+"_Ribbon").is(":visible")?v:0,l.showHeadings&&(y=22,p=a.width()),this._isAutoWHMode||(h=r.height-(u+c+1),this.getGroupPanel().height(h-1),this.getMainPanel().height(h-1),this.model.showPager&&(f==="initial"||this.element.find(".e-spreadsheetfooter").is(":visible"))||(w=1),k=this._browserDetails.name==="chrome"?1:2,r.height=r.height-(y+w+c+u+k),this.element.find(".e-spreadsheet-list")[0].style.height=""),this.model._isActPanelVisible?r.width=r.width-(this.model.activationPanelWidth+2):t.isNullOrUndefined(r.isActPanel)||r.isActPanel||(r.width=r.width+this.model.activationPanelWidth+2),o=this.model.scrollSettings,this.getMainPanel().width(!this.model._isActPanelVisible&&o.isResponsive?"100%":r.width),e.find("#hscrollBar").length>0&&(e.find("#hscrollBar").remove(),a.removeClass("e-scrollrowcss"),this._getJSSheetRowHeaderContent(i).height(r.height),this._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").height(r.height-1)),e.find("#vscrollBar").length>0&&(nt=l._scrollTop,e.find("#vscrollBar").data("ejScrollBar").scroll(0),l._scrollTop=nt,e.find("#vscrollBar").remove(),this._getJSSheetHeader(i).removeClass("e-scrollcss"),this._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").width(o.isResponsive?r.width-2:r.width)),this._isAutoWHMode||(e.height(r.height),a.height(r.height)),this._getJSSheetContent(i).width(o.isResponsive?"100%":r.width),s=this.getFooter(),s&&s.width(o.isResponsive?"100%":r.width),this._alignFormulaBar(this._responsiveWidth),this._initViewPort(i),this.model.allowFreezing&&this.XLFreeze._refreshFreeze(),r.width=r.width-p,r.height=r.height,r},_setSheetWidthHeight:function(t,i,r,u,f){var e=this.getSheet(t),b=n(document),o=this._getContent(t),s,h,a,v,c,l=this._getJSSheetRowHeader(t),y,p=this.model.scrollSettings.isResponsive,k=e.showHeadings?l.width():0,w;p?(f!="initial"&&u!="resize"&&(this._refreshSheetWithScreen(t),this._updateResponsiveSettings(),i={width:this._responsiveWidth,height:this._responsiveHeight}),this._resizeColl[t-1]=this._isResized,u!=="resize"||this.model.allowResizing&&(!this.model.allowResizing||this.XLResize._resizeStart)||f=="toggleBtn"||(this.model.activationPanelWidth=Math.floor(i.width/3)),u==="refresh"&&(w=this._browserDetails,w.name.indexOf("msie")>-1&&(b=this.model.showRibbon?n(document):n("body"))),y=this._refreshWidthHeight(t,n.extend(!0,{},i),r,f,u),this._updateResponsiveSettings(),u!=="resize"||this.model.allowResizing&&(!this.model.allowResizing||this.XLResize._resizeStart)||f=="toggleBtn"||(this.model.activationPanelWidth=Math.floor(i.width/3)),i=y):(this._isAutoWHMode||(i.width=i.width-2),i=this._refreshWidthHeight(t,n.extend(!0,{},i),r,f,u));this.getMainPanel().width(!this.model._isActPanelVisible&&p?"100%":i.width+k);this.model.scrollSettings.allowScrolling&&(this.model._isActPanelVisible&&(i.width+=2),this._renderScroller(t,n.extend(!0,{},i),f),h=o.find("#vscrollBar"),s=o.find("#hscrollBar"),h.length>0&&this._getJSSheetHeader(t).addClass("e-scrollcss"),s.length>0&&(c=o.height(),l.height(c-18),this._getJSSheetRowHeaderContent(t).height(c-(s[0].style.display==="none"?0:18)),l.addClass("e-scrollrowcss")),f!="initial"&&(v=h.data("ejScrollBar"),a=s.data("ejScrollBar"),v.scroll(e._scrollTop),a.scroll(e._scrollLeft)));e.showHeadings||o.find(".e-content")[this.model.allowFormulaBar?"addClass":"removeClass"]("e-viewbrdr");this._isAutoWHMode||(this._dlgWidth=this._phoneMode||this._tabMode||this._responsiveWidth<350?this._responsiveWidth-2:this._responsiveWidth/2,this._dlgHeight=this._phoneMode||this._tabMode||this._responsiveHeight<350?this._responsiveHeight-2:this._responsiveHeight/1.5)},setWidthToColumns:function(n,t){var o,f=t||this.getActiveSheetIndex(),i=this.getSheet(f),a,v,h=0,u,r,c=!1,l,e,y,s;if(!this.isUndefined(i)){for(typeof n[0]=="object"&&(c=!0),i._isLoaded&&(a=this._getContent(f).find("col"),v=this._getJSSheetHeader(f).find("col")),e=0,y=n.length;e<y;e++){if(u=c?n[e].width:n[e],r=c?n[e].colIndex:e,l=this.XLEdit._getPropWithCellIdx([0,r,i.rowCount-1,r],"isOfBrdr",f),u===0&&(u=64),u<i.columnsWidthCollection[r]&&this.XLEdit.getPropertyValue(0,r,"wrapCol")){h+=u;continue}for(i._isLoaded&&(v[r].style.width=u+"px",a[r].style.width=u+"px"),h+=u,this.XLEdit.getPropertyValue(0,r,"isCHide",f)?(i.hideColsCollection[r]=u,i.columnsWidthCollection[r]=0):i.columnsWidthCollection[r]=u,this.XLScroll._getColWidths(f,r),s=0;s<l.length;s++)o=l[s],this._textClip(o.rowIdx,o.colIdx,"delete","",!0),this._textClip(o.rowIdx,o.colIdx,"add","",!0)}i.staticWidth=h;i._isLoaded&&this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(f,"refresh","horizontal");i._isFreezed&&(this.XLFreeze._refreshFreezeRowDiv(),this.XLFreeze._refreshFreezeColDiv());(!i._isImported||i._isLoaded)&&(this.model.allowSelection&&this.XLSelection._refreshBorder(),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),this.model.allowComments&&this.XLComment._updateCmntArrowPos(),this._isAutoWHMode&&this._autoSSWidthHeight())}},setHeightToRows:function(n){var e,t,i,r=this.getActiveSheetIndex(),s=0,f=this.getSheet(r),o=!1,h=this.getRows(r),l=h[1],a=h[0],u,c;for(typeof n[0]=="object"&&(o=!0),u=0,c=n.length;u<c;u++){if(t=o?n[u].height:n[u],i=o?n[u].rowIndex:u,t===0&&(t=22),t<f.rowsHeightCollection[i]&&this.XLEdit.getPropertyValue(i,0,"wrapRow")){s+=t;continue}this._isRowViewable(r,i)&&i!=-1&&(e=this._getRowIdx(i,r),l[e].style.height=t+"px",a[e].style.height=t+"px");s+=t;f.rowsHeightCollection[i]=t}this.model.scrollSettings.allowScrolling&&!this._isScrolling&&(this.XLScroll._getRowHeights(r,1),this.XLScroll._refreshScroller(r,"refresh","vertical"),this.XLScroll._getFirstRow(r));this.model.allowSelection&&(!f._isImported||f._isLoaded)&&(this.XLSelection._refreshBorder(),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())},_refreshRowColCnt:function(n){var f,h,u,e,r,o,s,a,v,y,l=this.model.scrollSettings,p,w,b,k,d,c=l.scrollMode===t.Spreadsheet.scrollMode.Infinite,i=this.getSheet(n),g=this._responsiveHeight,nt=this._responsiveWidth;r=o=s=a=v=y=p=w=b=k=d=0;i.rowCount>this._maxRowCnt&&(i.rowCount=this._maxRowCnt);f=this._getMaxHgt(n,this.isImport);c&&(o=i._vPortHgt+this._bufferCnt*i.rowHeight,f<o&&(u=o-f,r=Math.ceil(u/i.rowHeight),i.rowCount+=r,f+=r*i.rowHeight));l.allowVirtualScrolling&&(e=i.rowCount-(i.hideRowsCollection.length+(this.isImport?i._hiddenFreezeRows.length:0)),c&&(u=e%i._virtualBlockRowCnt,u&&(r=i._virtualBlockRowCnt-u,i.rowCount+=r,e+=r,f+=r*i.rowHeight)),i._virtualBlockCnt=Math.ceil(e/i._virtualBlockRowCnt),i._virtualTBodyHgt=f);i.colCount>this._maxColCnt?i.colCount=this._maxColCnt:c&&(s=i._vPortWth+this._bufferCnt*i.columnWidth,h=this.isImport?this._getMaxWth(n):i.colCount*i.columnWidth,h<s&&(u=s-h,i.colCount+=Math.ceil(u/i.columnWidth)))},_getMaxHgt:function(n,t,i){var e,u,f,r=this.getSheet(n);if(u=f=0,t)for(e=r.rowsHeightCollection.length;u<e;)i&&r.hideRowsCollection.indexOf(u)!==-1||(f+=r.rowsHeightCollection[u]),u++;else f=(r.rowCount-(r.hideRowsCollection.length+r._hiddenFreezeRows.length))*r.rowHeight;return f},_getMaxWth:function(n){for(var i=0,t=0,r=this.getSheet(n),u=r.columnsWidthCollection.length;t<u;)i+=r.columnsWidthCollection[t],t++;return i},_refreshTemplates:function(i,r,u,f){for(var h,e,o,s=t.isNullOrUndefined(u)?0:u,l={},a=this.getSheet(i),v=t.buildTag("colgroup"),y=this.model.scrollSettings.allowVirtualScrolling,p=t.isNullOrUndefined(f)?a.colCount:f,c=y?"<tr style = 'height: {{:height}}px' data-idx = '{{:rowidx}}'>":"<tr style = 'height: {{:height}}px'>";s<p;)h=a.columnsWidthCollection[s],o=this._generateHeaderText(s+1),e=document.createElement("col"),h<1?e.setAttribute("class","e-hide"):a._hiddenFreezeCols.indexOf(s)>-1&&e.setAttribute("class","e-fcol-hide"),e.style.width=h+"px",c+="<td class='{{:"+o+"_className}}' rowspan= {{:"+o+"_rspan}} colspan= {{:"+o+"_cspan}}>{{:"+o+"_value}}<\/td>",v.append(e),s++;l[this._id+"JSONTemplate"+i]=c+"<\/tr>";r||(l[this._id+"JSONRowHdrTemplate"+i]=y?"<tr class='{{:wrap}}' style='height:{{:height}}px' data-idx='{{:rowidx}}'><td class='{{:className}}'>{{:rowidx + 1}}<\/td><\/tr>":"<tr class='{{:wrap}}' style='height:{{:height}}px'><td class='{{:className}}'>{{:rowidx + 1}}<\/td><\/tr>");n.templates(l);this._sheets[i]._contentColGroup=v.get(0)},_renderData:function(i,r,u,f,e,o,s){var b,l,w,c,h,tt,ot,st,ht,ct,rt,a,v,it,wt,k,lt,ft,bt,p,kt,d,et,g=" ",at=[],y=this.getSheet(r),vt=e?f:y.colCount,ut=y._goToCollection,dt=ut.selected.length,yt,pt,gt,nt;if(et=0,d=o?o:0,i)for(ot=i.data,rt=ot.length/vt;d<rt;){for(c={},b=et,a=i.rowIdx[d],v=e?u:0;b<et+vt;){if(h=ot[b],h){if(it=this._generateHeaderText(v+1),l=it+"_className",w=it+"_value",c[l]="e-rowcell e-wrapword ",y.showGridlines||(c[l]+=" e-hborder"),!e&&!ut.multiple&&dt&&ut.selected.indexOf(a+":"+v)>-1&&(c[l]+=" e-selected"),v in y.hideColsCollection&&(c[l]+=" e-soverflow"),y._hiddenFreezeCols.indexOf(v)>-1&&(c[l]+=" e-fcol-hide"),!e&&this.model.allowSelection&&this.inRange(y.selectedRange,a,v)&&(ft=!0,ut.multiple&&(ft=!1,dt&&ut.selected.indexOf(a+":"+v)>-1&&(ft=!0)),ft&&(c[l]+=" e-selected"),y._activeCell.rowIndex===a&&y._activeCell.colIndex===v&&(c[l]+=" e-activecell")),this.isImport&&this.model.allowCellType&&this.model.allowAutoCellType&&((h.type=="shortdate"||h.type=="longdate")&&this._celltypes.push({rowIndex:a,colIndex:v,sheetIndex:r,cellType:{type:"DatePicker"},value:h.value2}),h.value2&&["true","yes","false","no"].indexOf(h.value2.toLowerCase())>-1&&this._celltypes.push({rowIndex:a,colIndex:v,sheetIndex:r,cellType:{type:"CheckBox",isChecked:["yes","true"].indexOf(h.value2.toLowerCase())>-1?!0:!1}})),this.isImport&&h.type=="date"&&this.XLFormat.addCustomFormatSpecifier(null,h.formatStr.replace(/^\{0\:|\}$/g,""),h.type),h.format&&(c[l]+=g+h.format,this._isClassHasProperty(h.format,"text-align","right")&&(c[l]+=" e-rightalign")),h.border&&(c[l]+=g+h.border),h.align?h.align===t.Spreadsheet.Align.Center?c[l]+=g+this._cAlign:h.align===t.Spreadsheet.Align.Right&&(typeof h.value=="object"&&this._isDateTime(h.value)||this.isNumber(h.value))&&(c[l]+=g+this._rAlign):this._isGeneral(h.type)&&(typeof h.value=="object"&&this._isDateTime(h.value)||this.isNumber(h.value))&&(c[l]+=g+this._rAlign),h.isMHide&&(c[l]+=" e-mc-hide",c[l]+=" e-moverflow"),h.isOfBrdr&&(c[l]+=" e-ofbrdr"),h.isOverflow===!1&&(c[l]+=" e-overflow"),st=it+"_rspan",ht=it+"_cspan",h.merge?(ct=h.merge.mSpan,c[st]=ct.rowSpan,c[ht]=ct.colSpan,c[l]+=" e-moverflow",h.merge.isCenterAlign&&(c[l]+=g+this._cAlign)):(c[st]=1,c[ht]=1),h.cFormatRule)for(nt=0,gt=h.cFormatRule.length;nt<gt;nt++)lt=h.cFormatRule[nt].split("_"),lt[7]==="true"&&(c[l]+=" e-"+lt[4]);if(tt=h.value2||"",this.isUndefined(h.wrap)&&tt.toString().match(/\n/g)&&(h.wrap=!0),h.wrap&&(y._isImported&&!this.isFormula(h.value)||!y._isImported)&&(c[l]+=" e-sswraptext",p=this._dataContainer.sheets[r],this.isUndefined(p[a])&&(p[a]={}),this.isUndefined(p[a][0])&&(p[a][0]={}),p[a][v].wrap||(p[a][v].wrap=!0),p[a][0].wrapRow=!0,this.isUndefined(p[0])&&(p[0]={}),this.isUndefined(p[0][v])?p[0][v]={wrapCol:!0,wrapWidth:y.columnsWidthCollection[v]}:(p[0][v].wrapCol=!0,p[0][v].wrapWidth=y.columnsWidthCollection[v]),y._wrapColl[a]&&(!y._wrapColl[a]||y._wrapColl[a][v])||this._wrapCollection(a,v,this._detailsFromGlobalSpan(a,v,"height",this.XLEdit.getPropertyValue(a,v,"value2"),y.columnsWidthCollection[v]),r)),h.hyperlink)e?(c[l]+=" e-hyperlinks",c[w]=tt):c[w]=h.hyperlink.webAddr?String.format("<a href={0} class='e-hyperlinks' target='_blank'>{1}<\/a>",h.hyperlink.webAddr,tt):String.format("<a class='e-hyperlinks'>{0}<\/a>",tt);else if(h.merge&&h.wrap){for(pt=0,yt=this.getRangeIndices(h.merge.mRange),nt=yt[0];nt<=yt[2];nt++)i.rowIdx.indexOf(nt)<0&&pt++;c[w]="<div id ="+this._id+"_MergeWrap style = 'border :0px;overflow: hidden;max-height:"+(Math.floor(y._rowHeightCollection[a+(h.merge.mSpan.rowSpan-pt)]-y._rowHeightCollection[a])-1)+"px'>"+tt+"<\/div>"}else c[w]=tt;h.comment&&(c[l]+=" e-commentcell",kt=h.comment.isVisible?"visible":"none",c[w]=String.format("<span class='e-comment'><span class='e-celltoparrow'><\/span><textarea class='e-comment-txtarea' style='display:{0};z-index:9;text-align:left'>{1}<\/textarea><\/span>",kt,h.comment.value)+c[w]);h.rule&&h.rule.isApply&&!this.XLValidate._checkValidation(c[w],h.rule.customVal.split("_"),!0,r)&&(c[l]+=" e-hlcell");!h.isFilterHeader||this.isUndefined(y._filterColl[a])||this.isUndefined(y._filterColl[a][v])||(wt="e-icon e-spanfilter e-filterspan "+y._filterColl[a][v].status,bt=h.isFilterVisible?"display: visible":"display: none",c[w]=String.format('<span class="{0}" style="{1}"><\/span>',wt,bt)+c[w],c[l]=c[l].replace("e-ralign",""),g=g.replace("e-ralign",""));h.altTxt&&!h.wrap&&(c[l]+=" e-alt-unwrap")}v++;b++}c.rowidx=a;k=y.rowsHeightCollection[a];c.height=this.isUndefined(k)||k<this.model.rowHeight?this.model.rowHeight:k;at.push(c);et=b;d++}else for(rt=this.model.scrollSettings.allowVirtualScrolling?y._virtualBlockRowCnt:s?s:y.rowCount,rt=d+rt;d<rt;){for(c={},b=0;b<vt;)it=this._generateHeaderText(b+1),l=it+"_className",c[l]="e-rowcell e-wrapword ",b++;k=y.rowsHeightCollection[d];c.height=this.isUndefined(k)||k<this.model.rowHeight?this.model.rowHeight:k;c.rowidx=a;at.push(c);d++}return n.render[this._id+"JSONTemplate"+r](at)},_isGeneral:function(n){return this.isUndefined(n)&&(n=t.Spreadsheet.CellType.General),n===t.Spreadsheet.CellType.General},_isFormulaError:function(n){for(var r=["#NA","#DIV/0!","#NAME?","circular reference","TypeError","wrong"],t=0,i=r.length;t<i;t++)if(typeof n=="string"&&n.indexOf(r[t])>-1)return!0;return!1},_refreshViewport:function(n,t){var e,f,o,a,c,s,l,r,h,u,i=this.getSheet(t),v=this.XLShape._getCellIndexFromOffset(n,0);i._virtualContBlockIdx=this._getVirtualBlockIdx(t,v.rowIndex).idx;o=(i._virtualContBlockIdx-1)*i._virtualBlockRowCnt;a=this._getRowIdx(o,t,!0);s=i._virtualContBlockIdx*i._virtualBlockRowCnt;l=this._getRowIdx(s,t,!0);i._virtualContTBodyOffset.top=this._getRowOffsetTop(i,a);i._virtualBlockCnt===1?(i._virtualTopTBodyOffset.top=i._virtualTopTBodyOffset.bottom=i._virtualTopTBodyHgt=0,i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom=i._virtualBottomTBodyHgt=0,i._virtualContTBodyOffset.bottom=this._getRowOffsetBottom(i._rowIdxColl[i._rowIdxColl.length-1],t),f=i._rowIdxColl,i._isVirtualTopReached=i._isVirtualEndReached=!0):i._virtualContBlockIdx===1?(i._virtualTopTBodyOffset.top=i._virtualTopTBodyOffset.bottom=i._virtualTopTBodyHgt=0,i._virtualContTBodyOffset.bottom=i._virtualBottomTBodyOffset.top=this._getRowOffsetTop(i,l),r=this._getRowIdx(s+(i._virtualBlockRowCnt-1),t,!0),i._virtualBottomTBodyOffset.bottom=this._getRowOffsetBottom(r,t),i._virtualBottomTBodyHgt=i._virtualTBodyHgt-(i._virtualContTBodyOffset.bottom-i._virtualContTBodyOffset.top+(i._virtualBottomTBodyOffset.bottom-i._virtualBottomTBodyOffset.top)),f=i._rowIdxColl.slice(0,i._rowIdxColl.indexOf(r)+1),i._isVirtualTopReached=!0,i._isVirtualEndReached=!1):i._virtualContBlockIdx===i._virtualBlockCnt?(h=(i._virtualContBlockIdx-2)*i._virtualBlockRowCnt,i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom=i._virtualBottomTBodyHgt=0,c=this._getRowIdx(o+(i._virtualBlockRowCnt-1),t,!0),i._virtualContTBodyOffset.bottom=this._getRowOffsetBottom(c,t),u=this._getRowIdx(h,t,!0),i._virtualTopTBodyOffset.top=this._getRowOffsetTop(i,u),i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.top,i._virtualTopTBodyHgt=i._virtualTBodyHgt-(i._virtualContTBodyOffset.bottom-i._virtualContTBodyOffset.top+(i._virtualTopTBodyOffset.bottom-i._virtualTopTBodyOffset.top)),f=i._rowIdxColl.slice(i._rowIdxColl.indexOf(u),i._rowIdxColl.indexOf(c)+1),i._isVirtualEndReached=!0,i._isVirtualTopReached=!1):(h=o-i._virtualBlockRowCnt,u=this._getRowIdx(h,t,!0),i._virtualTopTBodyOffset.top=this._getRowOffsetTop(i,u),i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.top,i._virtualContTBodyOffset.bottom=i._virtualBottomTBodyOffset.top=this._getRowOffsetTop(i,l),r=this._getRowIdx(s+(i._virtualBlockRowCnt-1),t,!0),i._virtualBottomTBodyOffset.bottom=this._getRowOffsetBottom(r,t),i._virtualTopTBodyHgt=n-(i._virtualTopTBodyOffset.bottom-i._virtualTopTBodyOffset.top+(n-i._virtualContTBodyOffset.top)),i._virtualBottomTBodyHgt=i._virtualTBodyHgt-i._virtualBottomTBodyOffset.bottom,f=i._rowIdxColl.slice(i._rowIdxColl.indexOf(u),i._rowIdxColl.indexOf(r)+1),i._isVirtualTopReached=i._isVirtualEndReached=!1);e=this.getRangeData({property:["value","value2","comment","hyperlink","rule","cFormatRule","format","border","type","isFilterHide","isRHide","isFHide","isFilterHeader","isFilterVisible","filterState","isMHide","merge","hRow","isLocked","wrap","isOverflow","align","isOfBrdr","altTxt","formatStr"],sheetIdx:t,rowIdxs:f,withRowIdx:!0});this._getRowHdrTBody(t).html(this._renderRowHdr(e.rowIdx,t));this._getContTBody(t).html(this._renderData(e,t));this._refreshRows(t);this._refreshTBodiesHgt(t);this.model.allowComments&&this.XLComment._updateCmntArrowPos(null,t);i._virtualRowIdx=e.rowIdx;this.model.allowCellType&&this.XLCellType._rangeCellTypes(i.cellTypes,t);this._refreshViewVar(n,i._isLoaded?null:0,t)},refreshOverflow:function(n,t){this._refreshOverflow(n,t)},_refreshOverflow:function(n,t){t=this._getSheetIndex(t);var r,e,i,u,f,o=this.getSheet(t);for(n=n||[0,0,o.usedRange.rowIndex,o.usedRange.colIndex],f=this.XLEdit._getPropWithCellIdx(n,"value2"),r=f.length-1;r>-1;r--)i=f[r].rowIdx,u=f[r].colIdx,this.model.allowOverflow?this._textClip(i,u,"add","",!0):(this._isRowViewable(t,i)&&(e=this.getCell(i,u)[0]),this._removeClass(e,"e-overflow"),this._textClip(i,u,"delete","",!0),this.addClass(e,"e-overflow"),this.XLEdit._updateDataContainer({rowIndex:i,colIndex:u},{dataObj:{isOverflow:!1},skipCell:!0}))},_getVirtualBlockIdx:function(n,t,i){for(var r=1,u={},f=this.getSheet(n),e=this._getRowIdx(t,n,!1,!0);r<=f._virtualBlockCnt;){if(e<r*f._virtualBlockRowCnt){u.idx=r;break}r++}if(i)for(r=0;++r;)if(t<r*f._virtualBlockRowCnt){u.orgIdx=r;break}return u},_getBlockInfo:function(n,t,i){var r,f=this.getSheet(t),u=[0,0,0,f.colCount-1];return r=this._getVirtualBlockIdx(t,n,i),u[0]=f._virtualBlockRowCnt*(r.idx-1),u[2]=f._virtualBlockRowCnt*r.idx-1,r.range=u,i&&(u=[0,0,0,f.colCount-1],u[0]=f._virtualBlockRowCnt*(r.orgIdx-1),u[2]=f._virtualBlockRowCnt*r.orgIdx-1,r.orgRange=u),r},_getRowOffsetTop:function(n,t){return n._rowHeightCollection[t]},_getRowOffsetBottom:function(n,t){return this.getSheet(t)._rowHeightCollection[n]+this.getSheet(t).rowsHeightCollection[n]},_getColOffsetLeft:function(n,t){return n._colWidthCollection[t]},_getCellIdx:function(n){return{rowIndex:this.model.scrollSettings.allowVirtualScrolling?Number(n.parentNode.attributes.getNamedItem("data-idx").value):n.parentNode.rowIndex,colIndex:n.cellIndex}},_getMidCell:function(){var t,i={},n=this.getSheet();return t=n._bottomRow.idx-n._topRow.idx+1,i.rowIdx=n._topRow.idx+Math.floor(t/2),t=n._rightCol.idx-n._leftCol.idx+1,i.colIdx=n._leftCol.idx+Math.floor(t/2),i},_removeRange:function(t,i){var r=this.getActiveSheetIndex(),e=this._getRowHdrTBody(r),u=n(this._getRowHdrTBody(r)[0].rows),o=this._getContTBody(r),f=n(this._getContTBody(r)[0].rows);u.splice(t,i);f.splice(t,i);this.setRows([u,f],r);o.html(f);e.html(u)},_refreshTBodiesHgt:function(n){var t="px",n=this._getSheetIndex(n),i=this.getSheet(n),r=this._getJSSheetRowHeaderContent(n)[0].getElementsByTagName("tbody"),u=this._getContent(n)[0].getElementsByTagName("tbody");r[0].style.height=u[0].style.height=i._virtualTopTBodyHgt+t;r[2].style.height=u[2].style.height=i._virtualBottomTBodyHgt+t},_renderTD:function(n,t,i){return String.format("<td class='{0}' style='{1}' >{2}<\/td>",n,t,i)},_renderDIV:function(n,t,i){return i?String.format("<div class='{0}' title='{2}'>{1}<\/div>",n,t,i):String.format("<div class='{0}'>{1}<\/div>",n,t)},_renderTR:function(n,t,i){var r=this._sheetCopy.isSheetCopy?this.getSheet(i).rowsHeightCollection[t]:this.model.rowHeight,u="height:"+r+"px";return String.format("<tr style='{0}'>"+n+"<\/tr>",u)},_renderFooter:function(){var h=this.model.scrollSettings,i,r=t.buildTag("div.e-spreadsheetfooter","",{display:this.model.showPager?"block":"none"}),e=t.buildTag("table.e-table","",{},{}),o=n(document.createElement("tbody")),s=n(document.createElement("tr")),f=n(document.createElement("td")),c=this.model.scrollSettings,u;this._updateResponsiveSettings();i=h.isResponsive?"100%":this._responsiveWidth-2;f.append(this._renderSpreadSheetPager());f.find(".e-pagercontainer").append(t.buildTag("div#"+this._id+"_AddSheet.e-new e-icon e-default","",null,{title:this._getLocStr("NewSheet")}));s.append(f);o.append(s);e.append(o);r.append(e);this.getMainPanel().append(r);this.model.scrollSettings.isResponsive||this._isAutoWHMode||(i=i);this._refreshSpreadSheetPager();u=this.element.find(".e-spreadsheetfooter").outerHeight();this.model.showPager&&u>this.model.pageSettings.pagerHeight&&(this.model.pageSettings.pagerHeight=u<37?u:36);r.width(i).height(this.model.showPager?this.model.pageSettings.pagerHeight:0);this.element.find(".e-spreadsheetfooter .e-table").height(this.model.pageSettings.pagerHeight);this.setFooter(r)},gotoPage:function(t,r){var w;if((r||!(t>this.model.sheetCount))&&!(t<1)){var o,u,s=this.model.sheets,h=this.getPager(),c={},l=this._impData,a,v,f={reqType:"gotoSheet",gotoIndex:t,newSheet:r,prevSheetIdx:this.getActiveSheetIndex()},y,p,b=!this.XLRibbon._ribbonState,d={reqType:f.reqType,gotoSheetIndex:f.gotoIndex,isNewSheet:f.newSheet,prevSheetIndex:f.prevSheetIdx},k=h.ejPager("option","totalRecordsCount"),e=this.model.sheetCount;(r&&(r=t<=e?!1:!0),r&&(e+1<t&&(t=e+1),k==e&&h.ejPager("option",{totalRecordsCount:k+1})),this._gotoPageArgs=n.extend(!0,{},f),this._isSheetNavigate=r?!1:!0,this._trigActionBegin(d))||(this.setActiveSheetIndex(t),this.model.pageSettings.currentPage=t,u=s[t],r||u._isRequested||!u._isImported?(this.element.find(".e-sheet").hide(),r&&(this._addSheet(t),u=s[t]),this._isSheetInsert&&(o=h.ejPager("option","currentPage"),this._swapSheetDtCntr(s.length-1,o),this.model.activeSheetIndex=t=o,this._isSheetInsert=!1),this._isNew||(this.model.scrollSettings.allowVirtualScrolling||this.model.scrollSettings.allowSheetOnDemand)&&!u._isLoaded?(this.showWaitingPopUp(),this._initSheet(t)):(this.element.find("#"+this._id+"_"+u.sheetInfo.value).show(),r||this._initSelection(),this._isAutoWHMode&&(this._autoSSWidthHeight(),u._isOpened||this._refreshOverflow(i,t)),this._gotoPageArgs&&this._pageLoadComplete(t)),u._isResized&&(this._refreshSheetWithScreen(t),this._updateResponsiveSettings(),c.width=this._responsiveWidth,c.height=this._responsiveHeight,this._setSheetWidthHeight(t,c,null,"refresh"),u._isResized=!1),this.model.scrollSettings.allowVirtualScrolling||u._isOpened||this._updateHiddenRows(t),this.model.allowFreezing&&this.XLFreeze._refreshFreeze(),this._isSheetNavigate=!1):this._importSheet(t),u._isOpened=!0,this.isImport||this.hideActivationPanel(),l&&!this._isExport&&!u._isImpSLoad&&u._isImported&&(a=l.model.sheets[t]._scrollTop,v=l.model.sheets[t]._scrollLeft,a>0&&this.XLScroll._vScroller(t).scroll(a),v>0&&this.XLScroll._hScroller(t).scroll(v),u._isImpSLoad=!0),y=this.getActiveCell(t),p=this.XLEdit.getPropertyValue(y.rowIndex,y.colIndex,"rule",t),p&&p.type==="list"&&this._setddlCell(),u._isRibCollapsed!=b&&(this._heightWidthCalculation(this.getActiveSheetIndex(),n.extend(!0,{},this.model.scrollSettings)),u._isRibCollapsed=b),this._isAutoWHMode&&(w=this._getElementDimension(),this.element.css({height:w.height,width:w.width})))}},insertSheet:function(){if(this.model.allowInsert&&!this.model.isReadOnly){var n=this.getPager(),t=n.ejPager("option","totalRecordsCount")+1;n.ejPager("option",{totalRecordsCount:t});this._isSheetInsert=!0;this.gotoPage(t,!0);this.setSheetFocus()}},_renameSheet:function(i){var r=this.element.find(".e-currentitem"),u=t.buildTag("input#"+this._id+"_Sheet_RenamePanel","",{width:r.width()+5+"px",padding:0},{type:"input",value:i||r.text(),maxlength:"31"});r.hide();u.insertAfter(r).select().focus();this._isSheetRename=!0;this.model.showRibbon&&this.XLRibbon._disableRibbonIcons();this.model.enableContextMenu&&n("#"+this._id+"_contextMenuFooter").data("ejMenu")._contextMenuEvents("_off")},deleteSheet:function(n){if(this.model.allowDelete&&!this.model.isReadOnly){var t=this.getActiveSheetIndex(),i=this._getSheetNames(!0).length;n=n||t;i>1?(n!==t&&this.gotoPage(n,!1),this.getObjectLength(this._dataContainer.sheets[n])?this._showAlertDlg("","SheetDeleteAlert","sheetDeleteActn",470):this._removeSheet(n)):this._showAlertDlg("Alert","SheetDeleteErrorAlert","",430)}},hideSheet:function(t){if(!this.model.isReadOnly){var i=this._getSheetNames(!0),u=this._getSheetNames(),r=n.isNumeric(t)?t:this._getSheetIndexByName(t)||this.getActiveSheetIndex();i.length>1?(u[r-1].isVisible=!1,this.gotoPage(this._getNxtVisibleSheet(r,null,i))):this._showAlertDlg("Alert","SheetDeleteErrorAlert","",377)}},unhideSheet:function(t){if(!this.model.isReadOnly){var r=this._getSheetNames(),i=n.isNumeric(t)?t:this._getSheetIndexByName(t);r[i-1].isVisible||(r[i-1].isVisible=!0,this.gotoPage(i));this.hideWaitingPopUp()}},_getNxtVisibleSheet:function(n,t,i){var r=this._getSheetNames(),u=r.length,f="<=",e=1,o=this._getSheetNames(!0),s=r[n-1].value===(i&&i[i.length-1].value||o[o.length-1].value);for((t||s)&&(u=0,f=">=",e=-1);this.operators[f](n,u);){if(r[n-1].isVisible)return n;n=n+e}},_renderSpreadSheetPager:function(){var i,u,r={},t=n(document.createElement("div"));return this.model.pageSettings.change=n.proxy(this._spreadSheetPagerClickHandler,this),this.model.pageSettings.totalRecordsCount=this.model.sheetCount,this.model.pageSettings.locale=this.model.locale,n.extend(r,this.model.pageSettings),r.currentPage=this.getActiveSheetIndex(),r.pageSize=1,r.showGotoPage=!1,this.setPager(t),t.ejPager(r),i=t.data("ejPager"),i._$first[0].title=this._getLocStr("Firstsheet"),i._$last[0].title=this._getLocStr("Lastsheet"),i._$next[0].title=this._getLocStr("Nextsheet"),i._$prev[0].title=this._getLocStr("Prevsheet"),t.find(".e-parentmsgbar").remove(),u=t.find(".e-pagercontainer")[0],u.appendChild(t.find("a.e-PP")[0]),u.appendChild(t.find(".e-numericcontainer")[0]),u.appendChild(t.find("a.e-NP")[0]),t},_getPageCount:function(){var y=this.model.scrollSettings.isResponsive,p=this.model.pageSettings.pageCount;if(y){var r=0,h,i,u,c=this.getPager(),l,f,e=c.find(".e-currentitem"),w=c.find(".e-numericcontainer"),o=this._getSheetNames(),a=c.width(),s=250,b=w.children(":visible"),t=this.getActiveSheetIndex(),k=n(b[0]).data("index"),v=!0;for(i=this._browserDetails.name==="msie"&&this._browserDetails.version==="8.0",i?(u=n("#"+this._id+"_emptySpan"),u.css({"font-size":e.css("font-size"),"font-family":e.css("font-family")})):(l=document.createElement("canvas"),f=l.getContext("2d"),f.font=e.css("font-size")+" "+e.css("font-family"));t>k-1;){if(s+=i?u.text(o[t-1].text).width()+19:f.measureText(o[t-1].text).width+19,a<=s)return r||1;t--;r++}for(t=this.getActiveSheetIndex();v;){if(h=this.isUndefined(o[t])?this._getLocStr("Sheet")+t:o[t].text,s+=i?u.text(h).width()+19:f.measureText(h).width+19,a<=s){v=!1;break}t++;r++}return i&&this._refreshGlobalSpan(),r||1}return p},_spreadsheetPagerCustomBtnHandler:function(n){var t=this.getPager().ejPager("option","currentPage");this._spreadSheetPagerClickHandler({currentPage:t,event:n,isInteraction:!0})},_spreadSheetPagerClickHandler:function(i){if(i.isInteraction){var o,e,s=!1,r=this,f,u=n(i.event.target),h=r.getPager().data("ejPager");if(r._filterClose(u),!u.hasClass("e-new")||!r.model.exportSettings.password)return(r.model.allowComments&&r.XLComment._isCommentEdit||r.XLEdit._isEdit||!r.model.allowInsert||r.model.isReadOnly)&&(i.event&&(u.hasClass("e-pager")||u.hasClass("e-new"))||r.element.find(".e-field-validation-error").length)?void 0:(r.model.allowComments&&r.XLComment._isCommentEdit&&r.XLComment._updateCurCmntVal(),r.XLEdit._isEdit&&r.XLEdit.saveCell(),!t.isNullOrUndefined(i.event)&&(u.hasClass("e-prevpage")||u.hasClass("e-nextpage")||u.hasClass("e-firstpage")||u.hasClass("e-lastpage"))&&(i.currentPage=r._getNxtVisibleSheet(i.currentPage,u.hasClass("e-prevpage")||u.hasClass("e-lastpage"))),f={activeSheet:r.getActiveSheetIndex(),gotoSheet:i.currentPage,newSheet:i.event&&u.hasClass("e-new")},f.newSheet?(o=r.getPager(),e=o.ejPager("option","totalRecordsCount")+1,f.gotoSheet=e):f.gotoSheet=i.currentPage,i.currentPage=f.gotoSheet,!t.isNullOrUndefined(i.event)&&i.event.target.id.indexOf("_Sheet_RenamePanel")>-1||r._isSheetRename&&!r._updateSheetNames(null,!1)||h._prevPageNo===i.currentPage)?void 0:(f.newSheet&&(o.ejPager("option",{totalRecordsCount:e,currentPage:e}),i.currentPage=e,s=!0),r._pageClickArgs=n.extend(!0,{},f),r.gotoPage(i.currentPage,s),n(i.event.target).hasClass("e-pager")||(r._completeAction({reqType:"paging",sheetIndex:f.activeSheet,nSheetIndex:i.currentPage}),r._trigActionComplete({reqType:"paging",sheetIndex:f.activeSheet,newSheetIndex:i.currentPage})),!1)}},_pageLoadComplete:function(t){var u,f,r=this.getSheet(t),e="option",o="checked",i=this._gotoPageArgs,s=this.model.allowSelection;if(s&&t!==i.prevSheetIdx&&(this.XLSelection._isGridBordering||this.XLSelection._isOutsideBordering)&&(this._getContent(i.prevSheetIdx).find("div:first-child").removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor").addClass("e-ss-cursor"),this.XLSelection._isGridBordering=this.XLSelection._isOutsideBordering=!1),(!r._isImported||r._isLoaded)&&this.model.enableContextMenu&&this.XLCMenu.hideCMenu(),this._refreshSpreadSheetPager(i.newSheet),s&&this.getSheetElement(t).find(".e-ss-activeimg").length&&this.XLSelection._cleanUp(!0),this.model.showRibbon&&(this._updateRibbonTab(r._activeCell),this.isImport||(this.model.allowLockCell&&(r.isSheetProtected?this.XLRibbon._disableRibbonIcons():this.XLRibbon._enableRibbonIcons(),this.XLRibbon._updateRibbonIcons()),this.model.allowComments&&this.XLComment._updateCmntRibIcons()),n("#"+this._id+"_Ribbon_PageLayout_Show_Headings").ejCheckBox(e,o,r.showHeadings),n("#"+this._id+"_Ribbon_PageLayout_Show_Gridlines").ejCheckBox(e,o,r.showGridlines)),this.model.allowCellFormatting&&(u=this.getSheetElement(t).find(".e-content")[0],this.XLFormat._formatEnable?(this._removeClass(u,"e-ss-cursor"),this.addClass(u,"e-ss-fpcursor")):(this.addClass(u,"e-ss-cursor"),this._removeClass(u,"e-ss-fpcursor"))),this._pageClickArgs){if(this._pageClickArgs.activeSheet=this.getActiveSheetIndex(),this._trigger("pagerClick",this._pageClickArgs))return;this.model.scrollSettings.isResponsive&&this._isResized&&!this._resizeColl[t-1]&&(this._refreshSheetonResize(),this._resizeColl.toString().indexOf("f")<0&&(this._isResized=!1,this._resizeColl.fill(!1)))}this.hideWaitingPopUp();this._pageClickArgs=this._gotoPageArgs=null;f={gotoSheetIndex:i.gotoIndex,isNewSheet:i.newSheet,prevSheetIndex:i.prevSheetIdx,reqType:i.reqType};this._trigActionComplete(f)},_createTemplateElement:function(t,i){var r=document.createElement("script");return r.id=(this._id+t+i.field+n.inArray(i,this.getSheet(t).columns)+"_Template").split(" ").join(""),r.type="text/x-jsrender",r.text=i.templateContent?i.templateContent:n(i.templateID).html(),n("body").append(r),n(i.templateID).hide(),r},_refreshSpreadSheetPager:function(n){var t=this.getPager(),i={currentPage:this.getActiveSheetIndex()},u=t.height(),r;(this.isImport||this._isNew||t===null)&&(i.totalRecordsCount=this.model.sheetCount);(n||this._isInitLoad||this._isSheetInsert||this._isNew)&&(this.model.pageSettings.pageCount=i.pageCount=this._getPageCount());t.ejPager("option",i).ejPager("refreshPager");this._updatePageContainer(t,i.currentPage);r=t.height();u!==r&&(i.pageCount=this._getPageCount(),t.ejPager("option",i).ejPager("refreshPager"),this._updatePageContainer(t,i.currentPage));this.model.allowInsert||this.addClass(document.getElementById(this._id+"_AddSheet"),"e-disable")},_updatePageContainer:function(t,i){var l,w,s,f,e,h,r=0,o=0,u=t.data("ejPager"),et=this.model.sheets,b=t.find(".e-numericcontainer").children(":visible"),k=u.model.pageCount,d=[u._$first[0],u._$prev[0]],g=["e-firstpagedisabled e-disable","e-firstpage e-default","e-prevpagedisabled e-disable","e-prevpage e-default"],nt=[u._$last[0],u._$next[0]],tt=["e-lastpagedisabled e-disable","e-lastpage e-default","e-nextpagedisabled e-disable","e-nextpage e-default"],it=b.length,ot=r+1===it;for(u._$next[0].className=u._$next[0].className.replace("-2x",""),u._$prev[0].className=u._$prev[0].className.replace("-2x","");r<it;){if(f=n(b[r]),s=f.data("index"),h=et[s].sheetInfo,e=h.text,ot){for(var v,st=t.outerWidth(),y,rt,p,ut=!0,c=e,ft=3,a=this._browserDetails.name==="msie"&&this._browserDetails.version==="8.0";ut;){if(a?(v=n("#"+this._id+"_emptySpan"),v.css({"font-size":f.css("font-size"),"font-family":f.css("font-family")}),y=248+(v.text(c).width()+19)):(rt=document.createElement("canvas"),p=rt.getContext("2d"),p.font=f.css("font-size")+" "+f.css("font-family"),y=248+(p.measureText(c).width+19)),st<=y&&e.length>=ft){c=e.slice(0,e.length-ft++)+"...";continue}ut=!1;e=c}a&&this._refreshGlobalSpan()}f.text(e);h.isVisible?w=s%k:f.hide();!l&&h.isVisible&&(l=s%k);r++}if(l===i)for(r=0;r<2;r++)this.addClass(d[r],g[o]),this._removeClass(d[r],g[o+1]),o+=2;if(o=0,w===i)for(r=0;r<2;r++)this.addClass(nt[r],tt[o]),this._removeClass(nt[r],tt[o+1]),o+=2},_updateSheetNames:function(i,r){var l,a,nt,s,v,k,lt=this.getPager(),ft,y=lt.find(".e-currentitem"),p=this.model.sheets,tt=n("#"+this._id+"_Sheet_RenamePanel"),et=!0,d=[],it,h,c,f,ot,st,ht,w,rt,u,o,e,b,ct=[],g,ut;if(t.isNullOrUndefined(i)&&(i=tt.val().trim()),a=p[y.data("index")].sheetInfo.text,l={reqType:"renameSheet",prevName:a,newName:i},this._trigActionBegin(l)&&(r=!0),i=l.newName,r)return tt.remove(),y.show(),this.model.showRibbon&&this.XLRibbon._enableRibbonIcons(),this.model.enableContextMenu&&n("#"+this._id+"_contextMenuFooter").data("ejMenu")._contextMenuEvents("_on"),this._isSheetRename=!1,!1;if(i.match(new RegExp(".*[\\[\\]\\*\\\\/\\?].*"))&&(i=!1),!i)return this._showAlertDlg("Alert",["SheetRenameEmptyAlert","SheetRenameEmptyCharExceedAlert","SheetRenameEmptySplCharAlert","SheetRenameEmptyBlankAlert"],"sheetRenameActn",500),!1;for(u=1,ft=p.length;u<ft;u++)y.text()!==p[u].sheetInfo.text&&i.toLowerCase()===p[u].sheetInfo.text.toLowerCase()&&(et=!1);if(et){if(this.model.enablePivotTable&&this.XLPivot._updateSheetName(i),p[y.data("index")].sheetInfo.text=i){tt.remove();y.show();v=this._calcEngine;g=v.getDependentCells().items;for(ut in g)g.hasOwnProperty(ut)&&ct.push(ut);for(it=ct,h=this._getSheetNames(),u=0;u<it.length;u++)for(c=g[it[u]],o=0;o<c.length;o++){if(f=v.getFormulaInfoTable().items[c[o]],f)for(f=f.getFormulaText(),e=0;e<h.length;e++)h[e].text!==h[e].value&&(w=new RegExp(h[e].value+'(?=[\'!])(?=[^"]*(?:"[^"]*"[^"]*)*$)',"gi"),f.match(w)&&(f=f.replace(w,e+"/"),d.push(e),rt=!0));if(rt){for(b=0;b<d.length;)w=new RegExp(d[b]+'/(?=[\'!])(?=[^"]*(?:"[^"]*"[^"]*)*$)',"gi"),f=f.replace(w,h[d[b]].text),b++;ot=v.rowIndex(c[o])-1;st=v.colIndex(c[o])-1;ht=this._getSheetIdxFromSheetValue(this._getLocStr("Sheet")+(parseInt(c[o].split("!")[1])+1));this.XLEdit._updateDataContainer({rowIndex:ot,colIndex:st},{dataObj:{value:f},sheetIdx:ht});rt=!1}}this._isSheetRename=!1}this._refreshSpreadSheetPager(!0);this.model.allowFormulaBar&&this.updateFormulaBar();k=this.model.nameManager;for(u in k)s=k[u].refersto,s&&s.indexOf(a)>-1&&(s=s.replace(/[\']/g,""),k[u].refersto=s.replace(a,i.match(/\s/g)?"'"+i+"'":i));return this.model.showRibbon&&(this.XLRibbon._enableRibbonIcons(),nt=n("#"+this._id+"_nmgrid").data("ejGrid"),nt&&(nt.refreshContent(),n("#"+this._id+"_nmrange").val(""))),this.model.enableContextMenu&&n("#"+this._id+"_contextMenuFooter").data("ejMenu")._contextMenuEvents("_on"),l={reqType:"renameSheet",prevName:a,newName:i},this._trigActionComplete(l),!0}this._showAlertDlg("Alert","SheetRenameAlert","sheetRenameActn",325)},_getSheetIndexByName:function(n){var i=this._getSheetNames(),t,r;for(n=n&&n.replace(/^'|'$/g,""),n&&(n=n.toLowerCase()),t=0,r=i.length;t<r;t++)if(i[t].text.toLowerCase()===n)return t+1;return!1},_removeSheet:function(t){var r=this.model.sheetCount,k=this._dataContainer.sheets,i,a=this.model.sheets,d,u,e,s,o,v=[],y,p,g,c,h,nt,w=[],f,b,l;if(r>1){if(c=a[t].sheetInfo.value,this._getAutoFillOptElem().appendTo(this.element),this.element.find("#"+this._id+"_"+c).remove(),r===this.getActiveSheetIndex()){for(i=1;i<r;i++)if(a[t-i].sheetInfo.isVisible){this.setActiveSheetIndex(t-i);break}}else this.setActiveSheetIndex(t);this._swapSheetDtCntr(t,r);r in k&&delete k[r];this._sheets.splice(r,1);a.splice(r,1);r=--this.model.sheetCount;this.getPager().ejPager("option",{totalRecordsCount:r,pageCount:this._getPageCount()});this.gotoPage(this.getActiveSheetIndex(),!1);this._getAutoFillOptElem().appendTo(this._getJSSheetContent(this.getActiveSheetIndex()).find(".e-spreadsheetcontentcontainer > .e-content"));this._rebindScrollEvnt();h=this.model.nameManager;for(i in h)nt=h[i].refersto,nt.indexOf(c)>-1&&(w.push(h[i].name),h[i].refersto="#REF!");f=this._calcEngine;l=f.getDependentCells().items;for(i in l)l.hasOwnProperty(i)&&v.push(i);for(i=0;i<v.length;i++)for(e=l[v[i]],u=0;u<e.length;u++)if(s=f.getFormulaInfoTable().items[e[u]],p=this._getSheetIdxFromSheetValue(this._getLocStr("Sheet")+(parseInt(e[u].split("!")[1])+1)),s&&p>-1){o=s.getFormulaText();y=new RegExp(c+'(?=[\'!])(?=[^"]*(?:"[^"]*"[^"]*)*$)',"gi");o.match(y)&&(o=o.replace(y,"#REF"),this.XLEdit._updateDataContainer({rowIndex:f.rowIndex(e[u])-1,colIndex:f.colIndex(e[u])-1},{dataObj:{value:o},sheetIdx:p}),f.refresh(s.getParsedFormula()));for(g in w)o.indexOf(w[g])>-1&&f.refresh(s.getParsedFormula())}if(this.model.showRibbon&&(b=n("#"+this._id+"_nmgrid").data("ejGrid"),b&&(b.refreshContent(),n("#"+this._id+"_nmrange").val(""))),d={sheetIndex:t,reqType:"remove-sheet"},this.clearUndoRedo(),this._trigActionComplete(d))return}},_rebindScrollEvnt:function(){for(var n=1;n<=this.model.sheetCount;n++)this.getSheet(n)._isLoaded&&(this._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content").off("scroll"),this.element.find("#"+this._id+"_"+this.model.sheets[n].sheetInfo.value).find(".e-headercontent").off("scroll"),this._refreshScrollerEvent(n))},_getSheetNames:function(n){for(var u=[],i=this.model.sheets,t=1,r=i.length;t<r;t++)(this.isUndefined(n)||(!n||i[t].sheetInfo.isVisible)&&(n||!i[t].sheetInfo.isVisible))&&u.push(i[t].sheetInfo);return u},_initMoveCopyDlg:function(){var n=this._id+"_moveCopyDlg",i,r,f,e,o,s,u,h,c;i=t.buildTag("div#"+n,"",{display:"none"});r=t.buildTag("div#"+n+"_sheetContent.e-dlgctndiv e-dlg-fields",t.buildTag("label.e-dlg-fields",this._getLocStr("Beforesheet")));h=t.buildTag("div.e-dlg-fields");s=t.buildTag("ul#"+n+"_list");r.append(h.append(s));u=t.buildTag("input#"+n+"_createcopy");r.append(u);u.ejCheckBox({cssClass:"e-dlg-fields"});u.parent().append(t.buildTag("label",this._getLocStr("CreateaCopy"),{"margin-left":6}));i.append(r);o=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");c=t.buildTag("div.e-dlg-btnctnr");f=t.buildTag("input#"+n+"_okbtn","");e=t.buildTag("input#"+n+"_cnlbtn");f.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,click:t.proxy(this._moveCopyBtnClick,this,"ok"),cssClass:"e-ss-okbtn",width:60});e.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._moveCopyBtnClick,this,"cancel"),showRoundedCorner:!0,width:60});o.append(c.append(f,e));i.append(o);this.element.append(i);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("MoveorCopy"),width:"auto",height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg e-ss-movedlg"});s.ejListBox({dataSource:this._getSheetNames(),height:"197px",width:"250px",fields:{text:"text",value:"value"}})},_renderMoveCopyDlg:function(){var r=n("#"+this._id+"_moveCopyDlg"),t=n("#"+this._id+"_moveCopyDlg_list").data("ejListBox"),i=this._getSheetNames();i.push({text:this._getLocStr("MoveToEnd"),value:this._getLocStr("MoveToEnd")});r.ejDialog("open");t.model.dataSource=i;t.option("fields",{dataSource:i});t.unSelectAll();t.selectItemByIndex(0)},_initUnhideDlg:function(){var n=this._id+"_UnhideDlg",i,r,u,f,e,o,s;i=t.buildTag("div#"+n,"",{display:"none"});r=t.buildTag("div#"+n+"_sheetContent.e-dlgctndiv e-dlg-fields",t.buildTag("label.e-dlg-fields",this._getLocStr("UnhideDlgText")));o=t.buildTag("ul#"+n+"_list");r.append(o);i.append(r);e=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");s=t.buildTag("div.e-dlg-btnctnr");u=t.buildTag("input#"+n+"_okbtn");f=t.buildTag("input#"+n+"_cnlbtn");u.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._unhideBtnClick,this,"ok"),cssClass:"e-ss-okbtn"});f.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._unhideBtnClick,this,"cancel"),showRoundedCorner:!0,width:"25%"});e.append(s.append(u,f));i.append(e);this.element.append(i);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("UnhideSheet"),width:280,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg"});o.ejListBox({dataSource:this._getSheetNames(),height:"197px",width:"250px",fields:{text:"text",value:"value"}})},_renderUnhideDlg:function(){var r=n("#"+this._id+"_UnhideDlg"),t=n("#"+this._id+"_UnhideDlg_list").data("ejListBox"),i=this._getSheetNames(!1);i.length>0&&(r.ejDialog("open"),t.model.dataSource=i,t.option("fields",{dataSource:i}),t.unselectAll(),t.selectItemByIndex(0))},_moveCopyBtnClick:function(i){switch(i){case"ok":var c,r,u,y,e,p=!1,l=2,f,o=n(this.element).find(".e-currentitem"),w=n("#"+this._id+"_moveCopyDlg_list").data("ejListBox"),h=n("#"+this._id+"_moveCopyDlg_createcopy").data("ejCheckBox"),v=w.getSelectedItems()[0].text,s=w.getIndexByText(v),a=this.model.sheets;if(!h.isChecked()&&v===o.text()){n("#"+this._id+"_moveCopyDlg").ejDialog("close");this.setSheetFocus();return}for(u=1;u<a.length;u++)v===a[u].sheetInfo.text&&(r=u),o.text()===a[u].sheetInfo.text&&(f=u);if(c={reqType:"moveSheet",toSheetIndex:s,fromSheetIndex:f,isCopy:h.isChecked()},this._trigActionBegin(c))return n("#"+this._id+"_moveCopyDlg").ejDialog("close"),!1;if(s=c.toSheetIndex,f=c.fromSheetIndex,h.isChecked()){for(o.text().match(".*[ ]+[(]+[0-9]+[)]$")===null?e=o.text()+" ("+l+")":o.text().lastIndexOf(" ")!==-1&&(l=parseInt(o.text().substring(o.text().lastIndexOf("(")+1,o.text().lastIndexOf(")"))),e=o.text().substring(0,o.text().lastIndexOf(" "))+" ("+l+")");!p;){for(e=e.substring(0,e.lastIndexOf(" "))+" ("+l+")",u=1,y=a.length;u<y;u++)e===a[u].sheetInfo.text&&l++;l===parseInt(e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")")))&&(p=!0)}this._copySheetProcess(f,e);f=this.model.sheetCount;t.isNullOrUndefined(r)&&(r=f)}else!t.isNullOrUndefined(r)&&r>f&&(r=r-1);if(t.isNullOrUndefined(r)&&(r=s),!h.isChecked()&&r===f){n("#"+this._id+"_moveCopyDlg").ejDialog("close");this.setSheetFocus();break}this._swapSheetDtCntr(f,r);n("#"+this._id+"_moveCopyDlg").ejDialog("close");r<=f&&(s=s+1);this.getPager().ejPager("option",{currentPage:s});this.gotoPage(s,!1);this._rebindScrollEvnt();c={reqType:"moveSheet",toSheetIndex:s,fromSheetIndex:f,isCopy:h.isChecked()};this._trigActionComplete(c);h._unChecked();h._isChecked=!1;this.setSheetFocus();break;case"cancel":n("#"+this._id+"_moveCopyDlg").ejDialog("close")}},_unhideBtnClick:function(t){if(t==="ok"){var i=n("#"+this._id+"_UnhideDlg_list").data("ejListBox");this.unhideSheet(i.getSelectedItems()[0].text)}n("#"+this._id+"_UnhideDlg").ejDialog("close")},_swapSheetDtCntr:function(n,t){var f=this._dataContainer.sheets,i=this.model.sheets,e=this._sheets,o=this._getLocStr("Sheet"),s=[{}],h,l=this._getSheetNames(),u,r,c;for(u in f)f.hasOwnProperty(u)&&(s[parseInt(i[u].sheetInfo.value.replace(o,""))]=f[u]);for(i.splice(t,0,i.splice(n,1)[0]),e.splice(t,0,e.splice(n,1)[0]),r=1,c=i.length;r<c;r++)h=parseInt(i[r].sheetInfo.value.replace(o,"")),this._dataContainer.sheets[r]=s[h];this.clearUndoRedo()},_copySheetProcess:function(t,i){var o,p,r,h,c,u,a=this.getPager(),v=a.ejPager("option","totalRecordsCount")+1,e=this.model.sheets,l,y,f,s;for(this._impData&&this.XLExport._renderAll(),a.ejPager("option",{totalRecordsCount:v,currentPage:v}),e.push(jQuery.extend(!0,{},e[t])),e[e.length-1]._isImported=!1,this._sheetCopy={isSheetCopy:!0,sheetContent:this._getContent(t).find(".e-table").clone(!0).get(0)},r=this.model.sheetCount+1,e[r].sheetInfo.text=i,h=e[r].sheetInfo.value=this._getLocStr("Sheet")+this._newSIndex,this._newSIndex++,this.setActiveSheetIndex(r),this._dataContainer.sheets[r]=n.extend(!0,{},this._dataContainer.sheets[t]),p=this._sheets[r]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null},this._initSheet(r),this.model.sheetCount++,this._sheetCopy={isSheetCopy:!1,sheetContent:null},this._calcEngine.registerGridAsSheet(h,h,this._calcID),c=e[r].shapeMngr.picture,s=this.getObjectLength(c),f=1;f<=s;f++)u=c[this._id+"_picture"+f],this.XLShape._createPicture(r,{rowIndex:u.rowIndex,colIndex:u.colIndex},this.getSheet(r).shapeMngr.sharedPics[u.data],u.top,u.left,u.width,u.height,null,u.bcolor,u.bstyle,u.bwidth);if(!this.model.scrollSettings.allowVirtualScrolling)for(l=this._getContent(r).find(".e-commentcell"),f=0,s=l.length;f<s;f++)y=n(l[f]),o=this._getCellIdx(n(".e-commentcell")[0]),y.removeClass("e-commentcell")&&this.XLComment.setComment([o.rowIndex,o.colIndex,o.rowIndex,o.colIndex],null,!1);this.model.allowComments&&this.XLComment._updateCmntArrowPos()},showActivationPanel:function(n){var i,t=this.getActiveSheetIndex(),r=this.getActivationPanel(),u=this.model.scrollSettings;if(!this.model.enablePivotTable||this._phoneMode)return!1;if(this.isUndefined(n))this._getContent(t).find(".e-ss-activepivot").length&&this.XLPivot._displayActPanel&&(this.model._isActPanelVisible=!0,this._setSheetWidthHeight(t,{width:this._responsiveWidth,height:this._responsiveHeight,isActPanel:!0},null,"refresh"),this._refreshActivationPanel());else if(i=this.getSheet(t).rangeSettings[n],i.showPanel){if(this._trigger("beforePanelOpen",{activationPanel:r,range:i,sheetIndex:t}))return;this.model._isActPanelVisible=!0;this._setSheetWidthHeight(t,{width:this._responsiveWidth,height:this._responsiveHeight,isActPanel:!0},null,"refresh");this._refreshActivationPanel()}this.model.showPager&&this._refreshSpreadSheetPager(!0)},_refreshActivationPanel:function(){var n=this.getActivationPanel(),i=this.getMainPanel().height(),t=n.data("ejScroller"),r;n.width(this.model.activationPanelWidth-1).height(i);n.find(".e-ss-pivotfield").hide();n.find("#"+this._id+"_PivotTableSchema_"+this._getContent(this.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id).show();n.find(".e-ss-pivotfield").width(this.model.activationPanelWidth-20);n.show();r=this.getActivationPanel().find("#"+this._id+"_PivotTableSchema_"+this._getContent(this.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id).data("ejPivotSchemaDesigner");r._reSizeHandler();t&&(t.option({width:this.model.activationPanelWidth-1,height:i}),t.refresh())},hideActivationPanel:function(){var n=this.getActivationPanel(),t=this.model.scrollSettings;n.is(":visible")&&(n.find(".e-ss-pivotfield").hide(),this.model._isActPanelVisible=!1,n.hide(),this._isNew||this._setSheetWidthHeight(this.getActiveSheetIndex(),{width:this._responsiveWidth,height:this._responsiveHeight},null,"refresh"),this.model.showPager&&this._refreshSpreadSheetPager(!0))},_addSheet:function(n){this._sheetSettings(n);this._dataContainer.sheets[n]={};this._initSheet(n);this._newSIndex++;this.model.sheetCount++},addNewSheet:function(){this.model.allowInsert&&!this.model.isReadOnly&&this.element.find(".e-pager .e-new").click()},_createFocusElement:function(){this.setFocusTopElem(n("<div class='e-focustop e-hide' ><\/div>"));this.setFocusRightElem(n("<div class='e-focusright e-hide' ><\/div>"));this.setFocusBottomElem(n("<div class='e-focusbottom e-hide' ><\/div>"));this.setFocusLeftElem(n("<div class='e-focusleft e-hide' ><\/div>"))},_createAutoFillElement:function(){var i,r=this._getJSSheetContent(this.getActiveSheetIndex()).find(".e-spreadsheetcontentcontainer > .e-content");this.model.allowAutoFill&&(i=n("<div class='e-autofill e-hide'><\/div>"),r.append(i),this.setAutoFillElem(i));this.element.append(t.buildTag("ul.e-spreadsheet","",{width:"auto"},{id:this._id+"_ctxtmenu"}));i=n("<div class='e-splitspan e-hide' title="+this._getLocStr("AutoFillTitle")+"><button id="+this._id+"_dragfilloptionbtn type='button'><\/button><\/div>");r.append(i);this._setAutoFillOptElem(i);this._initializeSplitButton()},_initializeSplitButton:function(){this._getAutoFillOptElem().find("button").ejSplitButton({size:"normal",contentType:"imageonly",targetID:this._id+"_ctxtmenu",prefixIcon:"e-icon e-ss-autofill",isSeparator:!1,buttonMode:t.ButtonMode.Dropdown,imagePosition:t.ImagePosition.ImageLeft,arrowPosition:t.ArrowPosition.Right,fields:{dataSource:this._fillOptionMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},beforeOpen:n.proxy(this.model.allowAutoFill&&this.XLDragFill._autoFillClick,this),itemSelected:n.proxy(this.model.allowAutoFill&&this.XLDragFill._autoFillOptionClick,this),width:"42px",height:"24px",cssClass:"e-spreadsheet e-autofillbtn"})},_renderFormulaBar:function(t){var i,r="<div id="+this._id+"_formulabar class='e-formulabar' ><div id="+this._id+"_indexbox class='e-indexbox' title='"+this._getLocStr("NameBox")+"'><\/div><div class='e-inputbox' ><input id="+this._id+"_inputbox type='text' title='"+this._getLocStr("FormulaBar")+"'/><\/div><\/div>",u;t?this.model.showRibbon?n("#"+this._id+"_Ribbon").after(r):this.element.prepend(r):this.element.append(r);this._setIndexBox(n("#"+this._id+"_indexbox"));i=n("#"+this._id+"_inputbox");this._setInputBox(i);this.XLEdit._renderAutoComplete(i,"",26);this._alignFormulaBar();u=this.element.find(".e-formulabar").height();u>36&&(this._formulaHeight=u);this.model.isReadOnly&&(this.element.find(".e-formulabar")[0].disabled=!0)},_alignFormulaBar:function(n){var u=this.model.scrollSettings,i,r,t;n=n||this._responsiveWidth;this.element.find(".e-formulabar").width(u.isResponsive?n-2:n);n=parseInt(n);i=n/10;r=n-(i+24);t=this.element.find(".e-inputbox");t.hide();t.width(Math.floor(r));this.element.find(".e-indexbox").width(Math.floor(i));t.show()},hideFormulaBar:function(){n("#"+this._id+"_formulabar").hide();this._isInitLoad||this._setSheetWidthHeight(this._getSheetIndex(),{width:this._responsiveWidth,height:this._responsiveHeight})},showFormulaBar:function(){this.model.allowFormulaBar&&(n("#"+this._id+"_formulabar").show(),this._setSheetWidthHeight(this._getSheetIndex(),{width:this._responsiveWidth,height:this._responsiveHeight}),this.updateFormulaBar())},_getlocaleNumVal:function(n,i){if(n=typeof n!="object"&&Number(n)?Number(n):!t.isNullOrUndefined(n)&&typeof n!="object"?t.parseFloat(n+"",this.model.locale):null,n&&i){var r=t.preferredCulture(this.model.locale).numberFormat,u=n.toString();r["."]!="."&&u.indexOf(r["."])<0&&(n=u.replace(".",r["."]))}return n},updateFormulaBar:function(){if(!this.model.isReadOnly){var i,r,s,e=this.getActiveSheetIndex(),u=this.getSheet(e)._activeCell,f=this._getContent(e).find(".e-ss-activeimg")[0],o,h;r=this.getRangeData({range:[u.rowIndex,u.colIndex,u.rowIndex,u.colIndex],property:["value","value2","isLocked"]})[0];i=t.isNullOrUndefined(r)?"":t.isNullOrUndefined(r.value)?"":r.value;this._isDateTime(i)&&(i=r.value2);this.model.locale!=="en-US"&&this.isNumber(i)&&(o=t.preferredCulture(this.model.locale).numberFormat,h=new RegExp("\\"+o[","]+"\\d{3}"),i=i+"",o[","]=="."&&(h.test(i)||r.value!=r.value2)&&(i=this._getlocaleNumVal(i,!0)));this._getInputBox().val(i);this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"isReadOnly")||this.model.allowLockCell&&this.getSheet(e).isSheetProtected&&r.isLocked?this._getInputBox().attr("readonly","readonly"):this._getInputBox().prop("readonly",!1);s=f&&(f.id.indexOf(this._id+"_picture")>-1||f.id.indexOf(this._id+"_chart")>-1)?f.id.replace(n(f).data("parentID")+"_",""):this._generateHeaderText(u.colIndex+1)+(u.rowIndex+1);this._getIndexBox().html(s)}},_initSelection:function(){var r,i=this.model,f=this.getActiveSheetIndex(),n=this.getSheet(f),u=this._getJSSheetContent(f).find(".e-spreadsheetcontentcontainer > .e-content"),e=i.selectionSettings.selectionType,o=t.Spreadsheet.SelectionType,s=i.selectionSettings.activeCell;i.allowSelection&&(this.getFocusTopElem()||this._createFocusElement(),u.append(this.getFocusTopElem(),this.getFocusRightElem(),this.getFocusBottomElem(),this.getFocusLeftElem()),s&&(r=this.getRangeIndices(s),!this.isRange(r)&&r[0]<n.rowCount&&r[1]<n.colCount&&(n._startCell=n._endCell=n._activeCell={rowIndex:r[0],colIndex:r[1]})),(!n._isImported||n._isLoaded)&&n._selectedCells.length?(this.XLSelection.selectRange(n._selectedCells[0],n._selectedCells[n._selectedCells.length-1]),this.XLSelection._refreshBorder()):(this.XLSelection._processBoundary(),e===o.Row||n._isRowSelected?this.XLSelection.selectRows(n._startCell.rowIndex,n._endCell.rowIndex):e===o.Column||n._isColSelected?this.XLSelection.selectColumns(n._startCell.colIndex,n._endCell.colIndex):this.XLSelection.selectRange(n._startCell,n._endCell)));i.allowAutoFill&&(this.getAutoFillElem()||this._createAutoFillElement(),this.getAutoFillElem().appendTo(u),this.XLDragFill.positionAutoFillElement(),i.autoFillSettings.showFillOptions&&i.allowAutoFill&&(this._getAutoFillOptElem().appendTo(u),this.XLDragFill.hideAutoFillOptions()));i.allowSelection&&n._isFreezed&&this.XLFreeze._refreshSelection()},_updateRibbonTab:function(t){var i,u,r=this.getActiveSheetIndex(),o=n("#"+this._id+"_Ribbon").data("ejRibbon"),f=this.XLRibbon,s=this.element.find(".e-ribbon .e-contextual a:visible"),e=s.length,h=o.element.find("#"+this._id+"_Ribbon_togglebutton");if(t&&(u=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"tableName",r)),e)while(e--)o.hideTab(s[e].text);f._toggleAnalyzeTab();h.is(":visible")&&h.hasClass("e-ribbonpin")&&this._refreshSheetonResize();i=this._getContent(r).find(".e-ss-activeimg");i.length?i[0].id.indexOf("chart")>-1?this.XLRibbon._chartDesignTabUpdate(i):this.XLRibbon._formatTabUpdate():u?f._designTabUpdate(this._getTableID(u),t):this._getContent(r).find(".e-ss-activepivot").length&&(f._analyzeTabUpdate(),this.XLSelection._cleanUp(!0),this.getActivationPanel().find("#"+this._id+"_PivotTableSchema_"+this._getContent(r).find(".e-ss-activepivot")[0].id).show(),this.showActivationPanel())},_updateCellType:function(){var n,i=t.Spreadsheet.CellType;for(n in i)this._dataContainer.cellType.push(i[n])},_updateFormulaCollection:function(){var n,i=this._calcEngine.getLibraryFunctions(),t=[];for(n in i.items)t.push({text:"="+n,display:n});this._formulaCollection=t},_renderScroller:function(n,t,i){this.XLScroll._createScroller(n,t,i);this._refreshScrollerEvent(n)},_refreshScrollerEvent:function(i){this._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").scroll(t.proxy(function(t){var i=this.getActiveSheetIndex(),r=this.getSheet(i),u=this._isFrozen(this.getFrozenColumns(i))?n(t.target).scrollLeft():r._scrollLeft;this._getJSSheetHeader(i).find(".e-headercontent").scrollLeft(u);this._getJSSheetRowHeaderContent(i).scrollTop(n(t.currentTarget).scrollTop())},this));this.element.find("#"+this._id+"_"+this.model.sheets[i].sheetInfo.value).find(".e-headercontent").scroll(t.proxy(function(t){var i=this.getActiveSheetIndex(),r=this._isFrozen(this.getFrozenColumns(i))?n(t.target).scrollLeft():this.getSheet(i)._scrollLeft;this._getContent(i).find(".e-content").scrollLeft(r);this.getSheet(i)._scrollLeft=this._getContent(i).find(".e-content").scrollLeft()},this))},_clickHandler:function(i){if(this.XLEdit._isFEdit=!1,this._hasClass(i.target,"e-ssfilter"))this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")?this._excelFilter.closeXFDialog():this.XLFilter._filterClickHandler(i);else{if(this._isExport||!this.model.cellClick)return!1;var o,r=i.target,s=this.getActiveSheetIndex(),u,f,e;if(i.target.tagName==="TD"&&n(i.target).parents("div")[0].className.indexOf("e-content")>-1&&i.target.className.indexOf("e-rowcell")>-1&&n(i.target).find(".e-chk-image").length<1){if(u=r.cellIndex,f=n.inArray(n(r).closest("tr").get(0),this.getRows(s)[1]),e=this.getSheet(s).columns[u],o={columnName:e.field,value:this.XLEdit.getPropertyValue(f,u),columnIndex:u,rowIndex:f,columnObject:e,cell:r,eventArgs:i,event:i,target:i.target},this._trigger("cellClick",o))return}else if(!t.isNullOrUndefined(n(i.target).parents("div"))&&n(i.target).parents("div")[0].className.indexOf("e-content")>-1&&i.target.className.indexOf("e-rowcell")>-1&&n(i.target).find(".e-chk-image").length<1&&(r=n(i.target).parents("td").get(0),!t.isNullOrUndefined(r)&&(u=r.cellIndex,f=n.inArray(n(r).closest("tr").get(0),this.getRows(s)[1]),e=this.getSheet(s).columns[u],o={columnName:e.field,value:this.XLEdit.getPropertyValue(f,u),columnIndex:u,rowIndex:f,columnObject:e,cell:r,eventArgs:i,event:i,target:i.target},this._trigger("cellClick",o))))return}},_wireEvents:function(t){var i=this.element,r=this._id;this.model.enableTouch&&parseInt(this._browserDetails.version)>8?this._wireTouchEvts("_on"):this._wireTouchEvts("_off");this[t](i,"mousedown",".e-spreadsheetcontentcontainer .e-content, .e-spreadsheetrowheader, .e-spreadsheetheader, .e-spreadsheetactpanel, .e-ribbon, .e-spreadsheetcontentcontainer .e-vscroll, .e-spreadsheetcontentcontainer .e-hscroll",this._mouseDownHandler);this[t](i,"mousemove",this._mouseMoveHandler);this[t](i,"mouseup",this._mouseUpHandler);this[t](i,"keydown",this._keyDownHandler);this[t](i,"keyup",this._keyUpHandler);this[t](i,"click",".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel, .e-ss-object",this._clickHandler);this[t](i,n.isFunction(n.fn.doubletap)&&this.model.enableTouch&&parseInt(this._browserDetails.version)>8&&!this._browserDetails.isMSPointerEnabled?"doubletap":"dblclick",".e-spreadsheetcontentcontainer, .e-spreadsheetheader, .e-spreadsheetrowheader, .e-numericcontainer .e-numericitem",this._dblClickHandler);this[t](i,"mouseleave",".e-spreadsheetrowheader, .e-spreadsheetheader, .e-viewhdrlbl, .e-vheading, .e-viewlinlbl, .e-vgridlines",this._mouseLeaveHandler);this[t](i,"mouseover",".e-spreadsheetcontentcontainer .e-content .e-rowcell, .e-viewhdrlbl, .e-vheading, .e-viewlinlbl, .e-vgridlines, .e-rowheadercontent, .e-vscrollbar, .e-hscrollbar, .e-spreadsheetfooter, .e-spreadsheetheader",this._mouseHoverHandler);this.model.allowFormulaBar&&this.XLEdit&&this[t](this._getInputBox(),"input",this.XLEdit._formulaBoxInputChange);this[t](n(".e-"+r+".e-chartcell"),"click",this._chartClickHandler);this[t](n("#"+r+"_cellstyles"),"click",this._cellStyleClick);this[t](n("#"+r+"_formatastable"),"click",this._formatAsTableClick);this[t](n("#"+r+"_nmuseinformula"),"click",".e-nmuseinformularow",this._useInFormulaClick);this[t](n("#"+r+"_AddSheet"),"click",this._spreadsheetPagerCustomBtnHandler);this.model.scrollSettings.allowScrolling&&this.XLScroll&&this[t](this.element.find(".e-spreadsheet-list"),"mousewheel DOMMouseScroll",n.proxy(this.XLScroll._spreadMouseWheel,this.XLScroll));this.model.scrollSettings.isResponsive&&this[t](n(window),"resize",n.proxy(this._resizeHandler,this))},_wireTouchEvts:function(n){(this._browserDetails.name!="msie"||["11.0","10.0"].indexOf(this._browserDetails.version)===-1)&&this[n](this.element,this._getBrowserEvt(),".e-spreadsheetcontentcontainer .e-content, .e-spreadsheetrowheader, .e-spreadsheetheader, .e-spreadsheetactpanel, .e-ribbon, .e-spreadsheetcontentcontainer .e-vscroll, .e-spreadsheetcontentcontainer .e-hscroll",this._mouseDownHandler);this[n](this.element,this._getBrowserEvt("move"),this._mouseMoveHandler);this[n](this.element,this._getBrowserEvt("end"),this._mouseUpHandler);this[n](this.element,"swipeleft swiperight",".e-spreadsheetfooter",this._swipeHandler)},_getBrowserEvt:function(n,t){return n==="move"?this._browserDetails.isMSPointerEnabled?this._browserDetails.pointerEnabled?"pointermove":"MSPointerMove":t?"mousemove":"touchmove":n==="end"?this._browserDetails.isMSPointerEnabled?this._browserDetails.pointerEnabled?"pointerup":"MSPointerUp":t?"mouseup":"touchend":this._browserDetails.isMSPointerEnabled?this._browserDetails.pointerEnabled?"pointerdown":"MSPointerDown":"touchstart"},_swipeHandler:function(n){var t=this.getActiveSheetIndex();this.gotoPage(n.type==="swiperight"?--t:++t)},_isTouchEvent:function(n){return this.model.enableTouch&&(n.type.indexOf("touch")>-1||n.type.indexOf("pointer")>-1)&&n.originalEvent.pointerType!=="mouse"&&n.originalEvent.pointerType!==4?!0:!1},_getOriginalEvt:function(n){return n.originalEvent.changedTouches?n.originalEvent.changedTouches[0]:n.originalEvent},_allChartType:function(t){n("#"+this._id+"_allchart").find(".e-chartimg").removeClass("e-chartselect");n(t.target).addClass("e-chartselect")},refreshSpreadsheet:function(){this._responsiveHeight>350&&(this._refreshSheetonResize(),this.model.showRibbon&&n("#"+this._id+"_Ribbon").data("ejRibbon")._ribbonResize())},_resizeHandler:function(){var t,n=this;n.element.is(":hidden")||(t&&clearTimeout(t),t=setTimeout(function(){n._refreshSheetonResize();for(var t=1,i=n.model.sheets.length;t<i;t++)n.getSheet(t)._isResized=t!=n.getActiveSheetIndex()},100))},_refreshSheetonResize:function(){var h,c,i=this.getActiveSheetIndex(),u,l=n(".e-menu:visible[id^="+this._id+"], .e-ddl-popup:visible[id^="+this._id+"]"),t,r,a=["CFormat","Validation","PageSize","FPane","Ins","Del","FindRep"],e,v,p=this._phoneMode,o,s,f,y;if(this._resizeColl[i-1]=this._isResized=!0,this.element.find(".e-inputbox").hide(),this.model.enablePivotTable&&this.hideActivationPanel(),this._phoneMode=this.model.scrollSettings.isResponsive&&document.documentElement.clientWidth<420,this._tabMode=this.model.scrollSettings.isResponsive&&document.documentElement.clientWidth>419&&document.documentElement.clientWidth<617,u={width:this._responsiveWidth,height:this._responsiveHeight},this.model.showRibbon&&(this._tabMode||this._responsiveHeight<280)&&n("#"+this._id+"_Ribbon").ejRibbon("collapse"),this._refreshSheetWithScreen(i),this._updateResponsiveSettings(),this._initViewPort(i),this.refreshContent(i),u.width=this._responsiveWidth,u.height=this._responsiveHeight,this._setSheetWidthHeight(i,u,null,"refresh"),h=this._getContTBody(i).find("tr"),c=this._getRowHdrTBody(i).find("tr"),this.setRows([c,h],i),this._dlgWidth=this._phoneMode||this._tabMode||this._responsiveWidth<350?this._responsiveWidth-2:this._responsiveWidth/1.5,this._dlgHeight=this._phoneMode||this._tabMode||this._responsiveHeight<350?this._responsiveHeight-2:this._responsiveHeight/1.2,this.model._isActPanelVisible&&this._refreshActivationPanel(),this.element.find(".e-inputbox").show(),this.model.showPager&&(this._isSheetRename&&(e=this.getPager().find("#"+this._id+"_Sheet_RenamePanel"),v=e.val(),e.remove()),this._refreshSpreadSheetPager(!0),this._isSheetRename&&this._renameSheet(v)),this._phoneMode&&(n("#"+this._id+"_CFormat").css("width",""),n("#"+this._id+"_Ribbon_Border").css("width",""),n("#"+this._id+"_indexbox").css({"text-overflow":"ellipsis",overflow:"hidden"})),this.model.showRibbon&&(this.XLRibbon._refreshBackstageHeight(),this._phoneMode&&!p&&this.XLRibbon._hideRibbonElem()),l.length&&(t=l[0].id.split("_",3),t.indexOf("Ribbon")===-1&&t.splice(1,0,"Ribbon"),t[2]=a.indexOf(t[2])>-1?["Home_Styles_ConditionalFormatting","Data_DataTools_DataValidationOptions","PageLayout_PageLayout_PageSizeOptions","Others_Window_FreezePanes","Others_Cells_InsertCellOptions","Others_Cells_DeleteCellOptions","Others_Editing_FindSelect"][a.indexOf(t[2])]:t[2].toLowerCase(),t=t.join("_"),t.length&&(r=n("#"+t),r.hasClass("e-splitbutton")&&r.ejSplitButton("hide"),r.hasClass("e-dropdownlist")&&r.ejDropDownList("hidePopup"))),this._isResized=!1,this._isRibbonDestroyed){if(o=n("#"+this._id+"_Ribbon").ejRibbon("instance"),this.model.ribbonSettings.enableOnDemand)tabText=o.getTabText(o.model.selectedItemIndex),this.XLRibbon._createTabControls(tabText);else for(s=[this._getLocStr("HOME"),this._getLocStr("DATATAB"),this._getLocStr("PAGELAYOUT"),this._getLocStr("OTHERS")],f=0,y=s.length;f<y;f++)this.XLRibbon._updateRibCustomCss(s[f]);this._on(n(".e-"+this._id+".e-chartcell"),"click",this._chartClickHandler);this._on(n("#"+this._id+"_cellstyles"),"click",this._cellStyleClick);this._on(n("#"+this._id+"_formatastable"),"click",this._formatAsTableClick)}this._isRibbonDestroyed=!1;this._trigger("refresh")},_chartClickHandler:function(t){var i=n(t.target),r=n.extend(!0,{},n(t.target).data());i.parents().eq(1).hide();this.XLChart.createChart(null,r)},_useInFormulaClick:function(t){var i,r,e="=",o=!1,u=t.target.textContent,c=this.getActiveSheetIndex(),s=this.getActiveCell(c),f=this.XLEdit._editElem,h=f.text();if(this.XLEdit.editCell(s.rowIndex,s.colIndex,!0),h===e)f.text(e+u);else{if(r=this.XLDragFill._parseFormula(h),i=r.length,i){while(i--)if(r[i]===","||r[i]==="("){r.splice(i+1,0,u);o=!0;break}else if(this._isCellReference(r[i])||this.isNumber(r[i])){r[i]=u;o=!0;break}u=o?r.join(""):u}f.text(e+u)}f.focusEnd();n("#"+this._id+"_nmuseinformula").hide()},_formatAsTableClick:function(t){var u,f,i=t.target,e=this.getActiveSheetIndex(),o=this.getSheet(e),r=o._selectedCells;r.length!==0&&(i.parentNode.className==="e-formatastablecell"&&(u=this.XLEdit.getPropertyValue(r[0].rowIndex,r[0].colIndex,"tableName",e),this._showDialog(this._id+"_Ribbon_Insert_Tables_Table"),u?(this.XLFormat._formatAsTableStyle=this._FATStyles[i.parentNode.id.replace(/ /g,"")],this.XLFormat._createTable(this._getTableID(u),this.XLFormat._formatAsTableStyle)):r.length>1?(f=n("#"+this._id+"_fatname"),n("#"+this._id+"_fatnamedlg").ejDialog("open"),n("#"+this._id+"_fatheader").data("ejCheckBox").option("checked",!1),f.val("Table"+this._tableCnt).focus().setInputPos(f.val().length),this.model.allowCellFormatting&&(this.XLFormat._formatAsTableStyle=this._FATStyles[i.parentNode.id.replace(/ /g,"")])):this._showAlertDlg("Alert","FormatAsTableAlert",null,445)),(i.className.indexOf("back")>-1||i.parentNode.className==="e-formatastablecell")&&n("#"+this._id+"_Ribbon_Home_Styles_FormatAsTable").length&&n("#"+this._id+"_Ribbon_Home_Styles_FormatAsTable").data("ejSplitButton")._hidePopup())},_borderSelectionClick:function(t){var r={ID:t.target.parentNode.id},u,f=t.target,e=this.getActiveSheetIndex(),i=this.getSheet(e)._selectedCells;i.length!==0&&(this._borderStyles.indexOf(r.ID)>-1&&this.XLRibbon._updateBordeStyle(r),hexcode=this._borderColor||"#000000",u=this._getAlphaRange(e,i[0].rowIndex,i[0].colIndex,i[i.length-1].rowIndex,i[i.length-1].colIndex),this.model.allowSelection&&(this.XLSelection._isOutsideBordering||this.XLSelection._isGridBordering)?!(this._borderStyles.indexOf(r.ID)>-1)&&r.ID.indexOf("bordercolor")<0&&(this.XLSelection._isOutsideBordering=this.XLSelection._isGridBordering=!1):this.setBorder({type:r.ID,color:hexcode,style:this._borderStyle},u),(f.className.indexOf("back")>-1||f.parentNode.className==="e-bordercell")&&n("#"+this._id+"_bordercontainer").hide())},_getTableID:function(n,t){var i,r=this.getSheet(this.getActiveSheetIndex()).tableManager;if(t){for(i in r)if(t===r[i].name)return Number(i)}else for(i in r)if(n.indexOf("e-table"+i)>-1)return Number(i)},_cellStyleClick:function(t){var i=this.model.sheets[this.getActiveSheetIndex()].selectedRange,r=t.target.className,f=this.XLFormat.getFormatClass(r),u={range:i,sheetIndex:this.getActiveSheetIndex(),reqType:"cell-styles",opr:t.target.innerText,beforeFormat:this.getRangeData({range:i,property:["format","formats"]})};r.indexOf("e-cellstylecell")>-1&&this.XLFormat.updateUniqueFormat(f,i,t.target.innerText);(r.indexOf("e-cellstylecell")>-1||r.indexOf("back")>-1)&&n("#"+this._id+"_Ribbon_Home_Styles_CellStyles").length&&n("#"+this._id+"_Ribbon_Home_Styles_CellStyles").data("ejSplitButton")._hidePopup();u.afterFormat=this.getRangeData({range:i,property:["format","formats"]});this.isUndoRedo||(this._completeAction(u),this._trigActionComplete(u));this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()},_mouseHoverHandler:function(t){var i=t.target,r;this._hasClass(t.target,"e-viewhdrlbl")||this._hasClass(t.target,"e-vheading")?this.element.find(".e-vheading .e-chk-act, .e-vheading .e-chk-inact").addClass("e-chkhover"):this._hasClass(t.target,"e-viewlinlbl")||this._hasClass(t.target,"e-vgridlines")?this.element.find(".e-vgridlines .e-chk-act, .e-vgridlines .e-chk-inact").addClass("e-chkhover"):this.model.allowDragAndDrop&&this.XLDragDrop._allowDragAndDrop&&(n(t.target).parents(".e-vscrollbar").length>0||t.target.className.indexOf("e-rowheader")>-1||n(t.target).parents(".e-spreadsheetfooter").length>0||t.target.className.indexOf("e-headercell")>-1||t.target.className.indexOf("e-spreadsheetfooter")>-1||n(t.target).parents(".e-hscrollbar").length>0||this.getSheet()._isFreezed&&t.target.className.indexOf("e-rowcell")>-1)?this.XLDragDrop._scrollHover(t):this._hasClass(t.target,"e-rowcell")&&(r=this._getCellIdx(i),this._trigger("cellHover",{target:i,event:t,cellIndex:r}))},_mouseDownHandler:function(i){var o,a,y,p,f,s,h,w,b,k,g=!0,nt=!0,v="e-ss-object",c="e-ss-pivot",r=i.target,u=n(r),e=this.getActiveSheetIndex(),d=this.getSheet(e),tt=this.getSheetElement(e),l=n("#"+this._id+"_Ribbon").data("ejRibbon");if(i.currentTarget.className.indexOf("e-ribbon")<0&&this.element.find(".e-bordercontainer").hide(),this.element.find("#"+this._id+"ddl_popup").has(r).length)return!1;if(this._isTouchEvt=this._isTouchEvent(i),this._isTouchEvt&&(this._touchArgs=i,this._startXY=this._setXY(i,navigator.userAgent.indexOf("WebKit")>-1),this.model.allowDragAndDrop&&this.XLDragDrop._dragtouch(this._startXY[0],this._startXY[1]),!this._hasClass(r,"e-autofill")&&this.model.allowAutoFill&&(y=this._hasClass(r,"e-headercell")?10:20,o=this._setXY(i),a=o[1],o=o[0],o=Math.abs(o-this.getAutoFillElem().offset().left),a=Math.abs(a-this.getAutoFillElem().offset().top),o<=y&&o>=0&&a<=y&&a>=0&&(u=this.getAutoFillElem(),r=i.target=u[0]))),u.parents(".e-ribbon").length||u.parents(".e-vscroll").length||u.parents(".e-hscroll").length)this._excelFilter&&(this.XLFilter._isSearchEdit=!1,this._excelFilter.closeXFDialog());else if(this._hasClass(r,"e-ssddl"))this._ddlopen(i);else{if(i.target=this._changeTargetWithOffset(i),this.model.allowCharts&&d._isChartBorderDrawn&&this.XLChart._clearChartRange(this._arrayAsString(this._chartBorder)),(this.model.pictureSettings.allowPictures||this.model.allowCharts)&&(u.hasClass(v)||n(u).parents("."+v).length)?(u.hasClass(v)||(r=i.target=n(u).parents("."+v)[0]),this.XLShape._shapeMouseDown(i)):(nt=!1,this.XLShape._shapeROStart&&this.XLShape._shapeRSStart||this._getContent(e).find(".e-ss-activeimg").removeClass("e-ss-activeimg e-ss-imgcresize e-ss-imgrresize")),(r.nodeName==="TD"||r.nodeName==="TH")&&(this.XLRibbon._isPanelVisible=!1),this.model.enablePivotTable&&(this._isPvtNameEdit&&(this._isPvtNameEdit=!1,this.XLPivot._changePvtName()),u.hasClass(c)||u.parents("."+c).length?(u.hasClass(c)||(r=i.target=u.parents("."+c)[0]),this.XLPivot._pivotMouseDown(i)):u.parents(".e-ss-pivotfield").length||u.hasClass("e-ss-pivotfield")||u.hasClass("e-vhandle")||u.hasClass("e-hhandle")||u.css("cursor")==="col-resize"||(this.hideActivationPanel(),this.getSheetElement(e).find(".e-ss-activepivot").removeClass("e-ss-activepivot"))),w=r.className,r.id.indexOf("picture")===-1&&this.model.showRibbon&&(l.model.selectedItemIndex===this.XLRibbon._getTabIndex("format")||l.isVisible(this._getLocStr("FORMAT")))&&this.XLRibbon._toggleFormatTab(),this.model.showRibbon&&r.id.indexOf("chart")>-1?this.XLRibbon._chartDesignTabUpdate(n(r)):this.model.showRibbon&&(l.model.selectedItemIndex===this.XLRibbon._getTabIndex("cdesign")||l.isVisible(this._getLocStr("CHARTDESIGN")))&&this.XLRibbon._toggleChartDesignTab(),this.XLEdit._isEdit&&r.nodeName!="TD"&&!this._hasClass(r,"e-autofill"))return;if(this.model.allowDragAndDrop&&this.XLDragDrop._isDragAndDropStart&&w!=="e-autofill"&&w.indexOf("e-filterspan")<0&&this.XLDragDrop._dMouseDown(i),this.model.allowResizing&&!this.XLEdit._isEdit&&(n(r).hasClass("e-headercelldiv")||n(r).hasClass("e-headercell")?this.XLResize._headerMouseDown(i):n(r).hasClass("e-rowheader")?this.XLResize._rowMouseDown(i):(n(r).hasClass("e-spreadsheetactpanel")||n(r).parents(".e-spreadsheetactpanel").length)&&this.XLResize._apMouseDown(i)),n(r).parents("div.e-spreadsheetactpanel").length>0)return;if(this.model.allowEditing&&this.XLEdit._editElem.html()==="="&&(this._isFormulaSuggestion=!1,this.XLEdit._isFormulaEdit=!0),g=this.XLEdit._isEdit?(this._isFormulaSuggestion||!this.XLEdit._isFormulaEdit)&&this.XLEdit.saveCell():!0,!g&&!this.XLEdit._isFormulaEdit)return!1;this.model.allowComments&&!u.hasClass("e-pager")&&this.getSheetElement(e).find(".e-commentcell").length&&this.XLComment._commentMouseDownHandler(i);r.tagName!=="SPAN"&&r.tagName!=="A"||t.isNullOrUndefined(u.parent("td")[0])?r.tagName==="TD"&&this._hasClass(r,"e-rowcell")?(s=r,f=this._getCellIdx(s),this.model.showRibbon&&this.XLRibbon.updateRibbonIcons()):f=this.getActiveCell():(s=u.parent("td")[0],f=this._getCellIdx(s));r.tagName==="A"?(d._activeCell=f,this.model.allowSelection&&(this.XLSelection.selectRange(f,f),this.XLDragFill.positionAutoFillElement()),i.which!==3&&this._hlClick(this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"hyperlink",e))):(i.button!==2||i.which!==3||this.getSheetElement(e).find(".e-selected, .e-colselected .e-headercelldiv, .e-rowselected").index(r)===-1)&&this.model.allowSelection&&!nt&&(t.isNullOrUndefined(this.XLDragDrop)||!this.XLDragDrop._allowDragAndDrop)&&(this.XLResize&&this.XLResize._resizeStart||u.hasClass("e-comment-txtarea")||u.hasClass(c)||n(u).parents("."+c).length||this.XLSelection._selectionMouseDownHandler(i));this._filterClose(i.target);this._undoInputobj={};r.tagName==="TD"&&n(r).parents("div")[0].className==="e-content"&&this.displayActivationPanel(this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"range"));r.tagName==="TD"&&r.className.indexOf("e-rowheader")<0&&(t.isNullOrUndefined(this._ddlCell)||(this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup"),this.element.find("#"+this._id+"ddlspan").remove(),this._ddlCell=null));r.tagName==="TD"&&this._hasClass(r,"e-rowcell")&&(k=this._getCellIdx(r),t.isNullOrUndefined(this.XLEdit.getPropertyValue(k.rowIndex,k.colIndex,"rule",e))||this._setddlCell(i));this._isTableRename&&(this.XLFormat._renameTable(this._tableClassName),this._isTableRename=!1);this._isSheetRename&&this._updateSheetNames(null,!1);this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup");this._hasClass(r,"e-rowcell")&&(b=this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"tableName",e));b?(p=this._getTableID(b),this.isNumber(p)&&this.XLRibbon._designTabUpdate(p,f)):this.model.showRibbon&&(l.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||l.isVisible(this._getLocStr("Design")))&&this.XLRibbon._toggleDesignTab(f);this.model.allowEditing&&(s=d._activeCell,this.XLEdit._isEdit&&i.target.id!==this._id+"_inputbox"&&(h=n(i.target).hasClass("e-ss-input")||!this.XLEdit._isFBarFocused?this.element.find("#"+this._id+"_Edit"):this._getInputBox(),h&&(i.target.id!==h[0].id&&h.focus().setInputPos(h[0].selectionStart,h[0].selectionEnd),h.hasClass("e-ss-input")&&(this.XLEdit._isFBarFocused=!1))),this.model.allowComments&&this.XLComment._isCommentEdit||this._isSheetRename||i.target.id!==this._id+"_inputbox"||(i.target.readOnly?this.setSheetFocus():(this.XLEdit._isEdit||this.XLEdit.editCell(s.rowIndex,s.colIndex,!0),this._getInputBox().focus(),this.XLEdit._isFBarFocused=!0)))}},_renderDDownList:function(){this.element.append(t.buildTag("input.e-"+this._id+"-ddl","","",{id:this._id+"ddl",style:"display:none"}));n("#"+this._id+"ddl").ejDropDownList({fields:{id:"Types",text:"text",value:"text"},beforePopupShown:n.proxy(this._drppopupshow,this),cssClass:"e-"+this._id+"-ddl e-ss-ddlwrap",width:.1,height:.1,change:n.proxy(this._changeddl,this)});n(document.body).append(n("#"+this._id+"ddl_popup_wrapper"))},_setddlCell:function(i){var v,d,f=[],h=[],g=[],y,a,u,p,w=this.getActiveSheetIndex(),nt,b,e,r,l,o,k,s,c;if((t.isNullOrUndefined(i)||i.type!=="mousedown"?(u=this.getActiveCell(),p=n("#"+this._id+"GroupPanel").find("div.e-content")[0]):(u=this._getCellIdx(i.target),p=i.currentTarget),a=this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"rule",w),a)&&(y=a.customVal.split("_"),a&&y[1]==="list")){if(this._ddlCell=u,e=y[0],o=[],e.startsWith("=")&&e.indexOf(",")<0){for(f=n.trim(e.replace("=","")),f.indexOf("!")>-1&&(k=f.split("!"),w=this._getSheetIndexByName(k[0]),f=k[1]),f.indexOf("$")>-1&&(f=f.split("$").join("")),f.indexOf(":")<0&&(f=f+":"+f),d=this.getRangeIndices(f),s=this._getMultiRangeCells(d),c=this.getRangeData({range:[s[0].rowIndex,s[0].colIndex,s[s.length-1].rowIndex,s[s.length-1].colIndex],property:["value","value2"],sheetIdx:w}),r=0,l=c.length;r<l;r++)t.isNullOrUndefined(c[r].value)||t.isNullOrUndefined(c[r].value2)?(o.push(""),h.push("")):(o.push(c[r].value),h.push(c[r].value2));o.length||(o.push(e),h.push(e))}else e.indexOf(",")>-1?h=o=e.split(","):(o=[],o.push(e),h.push(e));for(r=0,l=o.length;r<l;r++)g[r]={id:r+1,text:h[r],value:o[r]};u=this.getCell(u.rowIndex,u.colIndex);u&&(v={top:u[0].offsetTop,left:u[0].offsetLeft},p.insertAdjacentHTML("beforeEnd","<span id='"+this._id+"ddlspan' class='e-icon e-ssddl e-spanddl e-ddlspan' role='button'><\/span>"),b=n("#"+this._id+"ddlspan"),nt=u.height()-(b.height()+3),b.css({top:v.top+nt,left:v.left+u.width()+3}),n("#"+this._id+"ddl").ejDropDownList("option","dataSource",g))}},_drppopupshow:function(){if(this._ddlCell){var t=this.getCell(this._ddlCell.rowIndex,this._ddlCell.colIndex);n("#"+this._id+"ddl_popup").css({width:this.getActiveCellElem().width()+20,"font-size":"11",top:t.position().top,left:t.position().left})}},_ddlPosition:function(){if(this._ddlCell){var i,t=this.getCell(this._ddlCell.rowIndex,this._ddlCell.colIndex),r={top:t[0].offsetTop,left:t[0].offsetLeft};i=n("#"+this._id+"ddlspan");i.css({top:r.top+t.height()-(i.height()+3),left:r.left+t.width()+3})}},_changeddl:function(n){if(this._ddlCell&&this.model.allowEditing){var t=this.getActiveCell(),i=n.model.dataSource[n.itemId].value,r=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex);this.XLEdit._updateCellValue(t,i);this.getActiveCellElem().hasClass("e-hlcell")&&this.XLValidate.highlightInvalidData();this._trigrDdlActnCmplt(i,r,n.itemId);this.model.allowFormulaBar&&this.updateFormulaBar()}},_trigrDdlActnCmplt:function(n,t,i){if(this.model.actionComplete!==null){var a,e,r,s=this.getActiveCell(),c=this.getActiveSheetIndex(),h,o,u,f,l;if(h=this.XLEdit.getPropertyValue(s.rowIndex,s.colIndex,"rule",c),o={reqType:"edit",sheetIndex:c,currValue:n,prevValue:t,rowIndex:s.rowIndex,colIndex:s.colIndex,hasValidation:!0,rule:h,isRefreshVal:!1,isDropDownAction:!0},h.type=="list"&&n!==""&&(u=h.customVal.split("_")[0],u[0]=="="&&u.indexOf(",")<0)){if(o.isRefrsVal=!0,u=u.replace("=",""),f=u.split("!"),o.refrValSheetIdx=a=f.length==1?c:this._getSheetIndexByName(f[0]),e=f.length==1?f[0]:f[1],e.indexOf("$")>-1&&(e=e.replace(/\$/g,"")),r=this.getRangeIndices(e),this.isUndefined(i)){l=this.getRangeData({range:r});for(idx in l)l[idx].value==n&&(i=parseInt(idx))}o.refrValCellAddr=r[0]===r[2]?this.getAlphaRange(r[0],r[1]+i):this.getAlphaRange(r[0]+i,r[1])}this._trigActionComplete(o)}},_ddlopen:function(i){var e=this.getActiveSheetIndex(),u=this.getActiveCell(e),o=this.getSheet(e).rowsHeightCollection[u.rowIndex],r,s,f;if(this.XLEdit._isEdit&&this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"rule").customVal.split("_")[2]==="true")return!1;this.XLEdit.saveCell();r=n("#"+this._id+"ddl").data("ejDropDownList");s=this.getCell(this._ddlCell.rowIndex,this._ddlCell.colIndex);i.stopPropagation();t.isNullOrUndefined(r)||(r._isPopupShown()?r._hideResult():(r._showResult(),n("#"+this._id+"ddl_popup").css({width:this.getActiveCellElem().width()+20,"font-size":"11",top:20,left:100}),f=this._getXYPos(s,n("#"+this._id+"ddl_popup"),o,0),n("#"+this._id+"ddl_popup_list_wrapper").css({top:f.yPos+o,left:f.xPos})))},_mouseMoveHandler:function(i){i.target=this._changeTargetWithOffset(i);var r=n(i.target),u,f;this._isTouchEvt=this._isTouchEvent(i);this._isTouchEvt&&(i.preventDefault(),u=this._setXY(i,navigator.userAgent.indexOf("WebKit")>-1),this.model.allowDragAndDrop&&this.XLDragDrop._dragtouch(u[0],u[1]));!this.model.allowResizing||!(this.XLResize._resizeType==="Col"||r.hasClass("e-headercelldiv")||r.hasClass("e-headercell")||r.hasClass("e-reSizeColbg"))||this.XLEdit._isEdit||this.XLCMenu&&this.XLCMenu._isMenuOpened?!this.model.allowResizing||!(this.XLResize._resizeType==="Row"||r.hasClass("e-rowheader")||r.hasClass("e-reSizeRowbg"))||this.XLEdit._isEdit||this.XLCMenu&&this.XLCMenu._isMenuOpened?this.model.allowResizing&&(this.XLResize._resizeType==="AP"||r.hasClass("e-spreadsheetactpanel")||r.parents(".e-spreadsheetactpanel").length>0)?this.XLResize._apMouseMove(i):(this.model.pictureSettings.allowPictures||this.model.allowCharts)&&(r.hasClass("e-ss-object")||r.parents(".e-ss-object").length||this.XLShape._shapeROStart||this.XLShape._shapeRSStart||r.hasClass("e-ss-imgvisual"))&&this.XLShape._imgMouseMove(i):this.XLResize._rMouseMove(i):this.XLResize._cMouseMove(i);this.model.allowSelection&&this.model.allowDragAndDrop&&t.spreadsheetFeatures.dragAndDrop&&r.parents(".e-spreadsheetmainpanel").length&&r.hasClass("e-rowcell")&&!this.XLEdit._isEdit&&this._getJSSheetHeader(this.getActiveSheetIndex())[0].querySelector(".e-spreadsheetcolumnheader").className.indexOf("e-sheetselected")===-1&&this.XLDragDrop._dMouseMove(i);this.model.allowComments&&!this.XLComment._isCommentEdit&&this.getSheetElement(this.getActiveSheetIndex()).find(".e-commentcell").length>0&&this.XLComment._commentMouseMove(i);t.isNullOrUndefined(i.target.parentNode)||i.target.id.indexOf("_svg")<0&&i.target.parentNode.className.indexOf("e-content")<0&&!n(i.target).is("td.e-rowcell")&&this.XLShape._shapeMouseUp(i);this._isTouchEvt&&!this._isSelected(i.target)&&!this._isTouchMoveSel&&this._touchArgs&&!this._isUniqueTarget(this._touchArgs,i)&&r.parents(".e-table").length&&r.parents(".e-spreadsheetcontentcontainer").length&&!this.XLDragDrop._allowDragAndDrop&&(f=this._getClientDiff(this._startXY,u),this._scrollContent(f),this._startXY=u,this._touchArgs=i,this._isTouchScroll=!0)},_mouseLeaveHandler:function(t){this._hasClass(t.target,"e-viewhdrlbl")||this._hasClass(t.target,"e-vheading")?this.element.find(".e-vheading .e-chk-act, .e-vheading .e-chk-inact").removeClass("e-chkhover"):this._hasClass(t.target,"e-viewlinlbl")||this._hasClass(t.target,"e-vgridlines")?this.element.find(".e-vgridlines .e-chk-act,.e-vgridlines .e-chk-inact").removeClass("e-chkhover"):this.model.allowResizing&&n(".e-ss-colresize, .e-ss-rowresize").removeClass("e-ss-colresize e-ss-rowresize")},_mouseUpHandler:function(t){var i=n(t.target),u=this.getActiveSheetIndex(),r=this.XLScroll._vScroller(u),f=this.XLScroll._hScroller(u);if(this.model.allowResizing&&(this.XLResize._resizeType==="Col"?this.XLResize._cMouseUp(t):this.XLResize._resizeType==="Row"?this.XLResize._rMouseUp(t):this.XLResize._resizeType==="AP"&&this.XLResize._apMouseUp(t)),this.model.showRibbon&&!this._phoneMode&&this.element.find(".e-ribbonpin").is(":visible")&&n(t.target).parents(".e-ribbon").length<=0&&n("#"+this._id+"_Ribbon").ejRibbon("collapse"),this.model.allowDragAndDrop&&this.XLDragDrop._allowDragAndDrop&&this.XLDragDrop._dMouseUp(t),this.model.allowComments&&this.XLComment._isCommentEdit&&this.getActiveCellElem().find("textarea").focus(),this._isSheetRename&&n("#"+this._id+"_Sheet_RenamePanel").focus(),this.model.pictureSettings.allowPictures&&this.XLShape._shapeMouseUp(t),this.model.enablePivotTable&&this.XLPivot._pivotMouseUp(t),this.XLEdit._isEdit&&i[0].id!==this.XLEdit._editElem[0].id&&this.XLEdit._editElem.setCursorPosition(this._browserDetails.version==="8.0"?document.selection.anchorOffset:window.getSelection().anchorOffset),this._hasClass(i[0],"e-vhandle")||this._hasClass(i[0],"e-vhandlespace")||this._hasClass(i[0],"e-vup")||this._hasClass(i[0],"e-vdown")){this._trigger("scrollStop",{scrollData:r._scrollData,position:r.model.value,reqType:"vertical"});return}if(this._hasClass(i[0],"e-hhandle")||this._hasClass(i[0],"e-hhandlespace")||this._hasClass(i[0],"e-hdown")||this._hasClass(i[0],"e-hup")){this._trigger("scrollStop",{scrollData:r._scrollData,position:f.model.value,reqType:"horizontal"});return}},_scrollContent:function(n,i){var r,u,e=this.getActiveSheetIndex(),f=this.getSheet(e);n.x&&(r=i?n.x:f._scrollLeft+n.x,u=this.XLScroll._hScroller(e),r<0?r=0:this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal?n.x>0&&u.model.maximum<r+u._scrollData.handle&&(r=u.model.maximum):u._scrollData.step=n.x<0?-1:1,f._scrollLeft!=r&&u.scroll(r));n.y&&(r=i?n.y:f._scrollTop+n.y,u=this.XLScroll._vScroller(e),r<0?r=0:this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal?n.y>0&&u.model.maximum<r&&(r=u.model.maximum):u._scrollData.step=n.y<0?-1:1,(r||f._scrollTop!=r)&&u.scroll(r))},_keyDownHandler:function(i){var s,e,h,c,o,a=!0,l=!1,f=this.getActiveSheetIndex(),r=this.element.find("#"+this._id+"_AutoComplete").data("ejAutocomplete"),v=n("#"+this._id+"_Ribbon").data("ejRibbon"),u=this.getSheet(f)._activeCell;if(!this._trigger("keyDown",{event:i,isEdit:this.model.allowEditing&&this.XLEdit._isEdit,isCommentEdit:this.model.allowComments&&this.XLComment._isCommentEdit,isSheetRename:this._isSheetRename,sheetIndex:this._getSheetIndex()})){if(this._getContent(f).find(".e-ss-activeimg").length&&(n(i.target).hasClass("e-numerictextbox")&&i.keyCode===13&&i.preventDefault(),l=!0,c=document.activeElement.id,c.indexOf(this._id+"_Ribbon_Format_Size_PictureHeight")<0&&c.indexOf(this._id+"_Ribbon_Format_Size_PictureWidth")<0&&this.XLShape._imgKeyDown(i)),navigator.platform.toLowerCase().indexOf("mac")>-1&&i.metaKey){i.keyCode==67?this.XLClipboard.copy():i.keyCode==86?this.XLClipboard.paste():i.keyCode==88&&this.XLClipboard.cut();return}if(r.showSuggestionBox&&r.suggestionList){if(i.keyCode===38){r._removeListHover();r._activeItem=r._activeItem>1?r._activeItem-1:r._listSize;r._addListHover();r._targetFocus();return}if(i.keyCode===40){r._removeListHover();r._activeItem=r._activeItem<r._listSize?r._activeItem+1:1;r._addListHover();return}}if(i.target.id.indexOf("_Edit")>-1&&this.model.allowKeyboardNavigation&&(this.XLCellNav._canKeyBoardNavigate=!0),this.XLEdit._editElem&&(o=this.XLEdit._editElem.text()),i.target.id.indexOf("_Edit")>-1&&i.keyCode===9&&o.indexOf("=")===0&&o.indexOf(")")!=o.length-1){if(i.preventDefault(),!r.suggestionList.is(":visible")&&this.model.allowKeyboardNavigation){this._isFormulaSuggestion&&(i.keyCode===39||i.keyCode===37||i.keyCode===13&&!i.altKey)&&this.XLEdit.saveCell();this.XLCellNav._selectionKeyDownHandler(i);u=this.getSheet(f)._activeCell;return}e=r.getActiveText();this.XLEdit._isNamedRange(e)||(e+="(");this.XLEdit._editElem.text(e);this.model.allowFormulaBar&&this._getInputBox().val(e);i.target.id.indexOf("_Edit")>-1&&this.XLEdit._editElem.focusEnd();this.XLCellNav._canKeyBoardNavigate=!1;return}if(this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"wrap")&&this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"merge")&&i.keyCode===46&&(this.getCell(u.rowIndex,u.colIndex,f).find("#"+this._id+"_MergeWrap")[0].textContent=""),i.target.id.indexOf("_Custom")<0&&i.target.id.indexOf("_Ribbon")<0){if((i.stopImmediatePropagation(),this.model.allowFiltering&&this.XLFilter._isSearchEdit&&i.keyCode!==27)||(n(i.target).parents(".e-formulabar").length&&this.XLEdit._isEdit&&this.model.allowKeyboardNavigation&&(this.XLCellNav._isNavigate=i.keyCode===13),this._isSheetRename||this.XLEdit._isEdit||this.XLComment&&this.XLComment._isCommentEdit||!this.model.allowClipboard||this.XLClipboard._copyPasteHandler(i),l||this._isSheetRename||((this.XLComment&&this.XLComment._isCommentEdit)?this.model.allowKeyboardNavigation&&(this.XLCellNav._isNavigate=!1):this.model.allowEditing&&(document.activeElement.id.indexOf("_inputbox")===-1||i.keyCode===27)&&this.XLEdit._editingHandler(i)),this._isFormulaSuggestion&&(i.keyCode===39||i.keyCode===37||i.keyCode===13&&!i.altKey)?this.XLEdit.saveCell():this.XLEdit._isFormulaEdit||i.keyCode!==9&&(i.keyCode!==13||i.altKey)&&i.keyCode!==37&&i.keyCode!==38&&i.keyCode!==39&&i.keyCode!==40||(a=this.XLEdit._isEdit&&this.model.allowKeyboardNavigation&&this.XLCellNav._isNavigate?this.XLEdit.saveCell():!0),n(i.target).hasClass("e-field-validation-error")||i.target.id==this._id+"_Ribbon_Home_Font_FontFamily_wrapper"||i.target.id==this._id+"_Ribbon_Home_Number_NumberFormat_wrapper"||i.target.id==this._id+"_Ribbon_Home_Font_FontSize_wrapper"))return!0;if(this.model.allowDataValidation&&this.XLValidate._isErrorVisible&&(i.keyCode===37||i.keyCode===39||i.keyCode===38||i.keyCode===40))return this.XLValidate._isErrorVisible=!1,!0;if(!a&&!this.XLEdit._isFormulaEdit||i.keyCode===13&&i.altKey)return!1;!this.model.allowKeyboardNavigation||l||this._isSheetRename||(this.model.allowComments&&this.XLComment._isCommentEdit||n(i.target).parents(".e-formulabar").length&&i.keyCode!==9&&(i.keyCode!==13||i.altKey)||this.XLCellNav._selectionKeyDownHandler(i),u=this.getSheet(f)._activeCell,this._keyboardShortCuts(i));this.model.allowUndoRedo&&(this.model.allowComments&&!this.XLComment._isCommentEdit?this._undoRedoOperation(i):this.model.allowComments||this._undoRedoOperation(i));this.XLEdit._isFormulaEdit&&i.keyCode===9&&!this.XLCellNav._canKeyBoardNavigate&&(this.XLCellNav._canKeyBoardNavigate=!0)}if(i.target.id===this._id+"_Ribbon_Analyze_PivotTable_PivotTableName")return this._isPvtNameEdit=!0,!0;if(this._isPvtNameEdit&&(this._isPvtNameEdit=!1,this.XLPivot._changePvtName()),i.target.tagName!=="DIV"||this.XLEdit._isEdit||t.isNullOrUndefined(this._ddlCell)||(this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup"),this.element.find("#"+this._id+"ddlspan").remove(),this._ddlCell=null),h=this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"tableName",f),i.target.id===this._id+"_Ribbon_Design_Properties_TableName")if(this._isTableRename=!0,this._tableClassName=this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"tableName")||"",this._isTableRename&&(i.keyCode===13||i.keyCode===9||i.keyCode===27))i.keyCode===13&&i.preventDefault(),this.XLFormat._renameTable(this._tableClassName);else return;h&&this._getContent(f).find(".e-ss-activeimg").length===0?(s=this._getTableID(h),this.isNumber(s)&&this.XLRibbon._designTabUpdate(s,u)):this.model.showRibbon&&(v.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||v.isVisible(this._getLocStr("Design")))&&this.XLRibbon._toggleDesignTab(u);this.XLEdit._isEdit||t.isNullOrUndefined(this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"rule",f))||this._setddlCell(i);this._isSheetRename&&(i.keyCode===13||i.keyCode===9||i.keyCode===27)&&(i.preventDefault(),this._updateSheetNames(null,i.keyCode===27)&&this.setSheetFocus());r.suggestionList.is(":visible")&&(this.XLEdit._editElem.text()===""||i.keyCode===13)&&r._hideResult();this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()}},_keyUpHandler:function(n){var t=this.element.find("#"+this._id+"_Edit").text();this.model.allowEditing&&this.XLEdit._isEdit&&t.indexOf("=")>-1&&t.length>0&&t.indexOf(")")==-1&&(this.XLEdit._isFEdit||(this.XLCellNav._isNavigate=!0),n.keyCode!==40&&n.keyCode!==38&&t.length>1&&this.XLEdit._captureEditing(n));this._trigger("keyUp",{event:n,isEdit:this.model.allowEditing&&this.XLEdit._isEdit,isCommentEdit:this.model.allowComments&&this.XLComment._isCommentEdit,isSheetRename:this._isSheetRename,sheetIndex:this._getSheetIndex()})},_dblClickHandler:function(t){var i,e,r,u,f;if(this.XLEdit._isFEdit=!1,t.target.tagName!=="A")if(this._hasClass(t.target,"e-numericitem")){if(this.XLEdit&&this.XLEdit._isEdit&&this.getActiveCellElem().find(".e-error").length)return;this._isSheetRename||this._renameSheet()}else{if(t.target.id.indexOf("chart")>-1||this._hasClass(t.target,"e-comment-txtarea")||this._hasClass(t.target,"e-filterspan")||n(t.target).parents(".e-ss-pivot").length)return;if(u=this.getActiveSheetIndex(),f=this.getSheet(u),t.target=this._changeTargetWithOffset(t),!this.model.allowEditing||!this.model.allowSelection)return;if(this.XLSelection._isOutsideBordering||this.XLSelection._isGridBordering){i=this._getContent(u).find("div:first-child");i.addClass("e-ss-cursor");i.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor");this.XLSelection.selectRange(f._startCell,f._endCell);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this.XLSelection._isOutsideBordering=this.XLSelection._isGridBordering=!1;return}if(!this.XLEdit._isEdit&&(n(t.target).hasClass("e-rowcell")||n(t.target).parents("td").hasClass("e-rowcell"))&&!this._hasClass(n(t.target),"e-readonly")&&!n(t.target).hasClass("e-cellreadonly")){if(this._isTouchEvt&&t.preventDefault(),n(".e-cdata").length&&n(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),e=n(t.target),e.closest("#"+this._id+"EditForm").length)return;r=t.target.id.length<1?this._getCellIdx(t.target):this._getCellIdx(n(t.target).parents("td")[0]);this.XLEdit.editCell(r.rowIndex,r.colIndex,!0)}this.model.allowResizing&&(n(t.target).hasClass("e-headercell")||n(t.target).hasClass("e-headercelldiv"))&&(n(t.target).css("cursor")==="col-resize"||this._isTouchEvt)&&(n(t.target).hasClass("e-headercelldiv")&&(t.target=t.target.parentNode),this.XLResize._resizeToFitWidth(t));this.model.allowResizing&&(n(t.target).hasClass("e-ss-rowresize")||this._isTouchEvt&&n(t.target).hasClass("e-rowheader"))&&this.XLResize._resizeToFitHeight(t)}},_setAndSelectActiveCell:function(n,t,i){this.setActiveCell(n,t);this._selectActiveCell(n,t,"",i)},_selectActiveCell:function(n,t,i,r){var e=this.getActiveSheetIndex(),f=i?{rowIndex:i.rowIndex,colIndex:i.colIndex}:{rowIndex:n,colIndex:t},u=this.getSheet(e);if(this.model.allowSelection&&this.model.allowKeyboardNavigation&&this.model.scrollSettings.allowScrolling){this.XLEdit.getPropertyValue(n,t,"mergeIdx")?(u._activeCell=u._endCell=u._startCell=f,this.XLSelection._processBoundary(),u._activeCell=u._startCell,this.XLSelection.selectRange(u._startCell,u._endCell)):this.XLSelection.selectRange(this._getAlphaRange(e,n,t,f.rowIndex,f.colIndex));this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();switch(r){case"Home":this._scrollContent({x:[i?i.colIndex*u.columnWidth:0]-u._scrollLeft});break;case"End":u._isFreezed?this.XLCellNav._navToCell(n,t):(n<u._topRow.idx||n>u._bottomRow.idx||t<u._leftCol.idx||t>u._rightCol.idx)&&this.XLScroll.scrollToCell(this._getAlphaRange(e,n,t,f.rowIndex,f.colIndex));break;case"Ctrl + Home":case"Ctrl + Shift + Home":this.XLScroll.scrollToCell(this._getAlphaRange(e,n,t,f.rowIndex,f.colIndex))}this.XLScroll._getFirstColumn(e)}},_pageUpDown:function(n){if(!this._isAutoWHMode){var u,h,o,e,c,f=0,s,r=this.getActiveCell(),l=this.getActiveSheetIndex(),i=this.getSheet(l),a=this.model.scrollSettings.allowVirtualScrolling;(o=i._rowHeightCollection[r.rowIndex],i.rowCount-1===i._bottomRow.idx&&n===1||(this._isFrozen(i.frozenRows)?r.rowIndex>i.frozenRows&&i._ftopRowIdx===i.frozenRows:i._topRow.idx===0)&&n===-1)||(e=i._bottomRow.value+i.rowsHeightCollection[i._bottomRow.idx],this._isFrozen(i.frozenRows)&&(r.rowIndex<i.frozenRows&&n===1&&(o=i._rowHeightCollection[i.frozenRows]),f=n===1?this._getRowOffsetTop(i,i.frozenRows):this._getIdxWithOffset(i._ftopRowIdx,null,!1,["freeze"]).yOffset),c=n*(e-(f?f:i._topRow.value)),u=o+c>0?o+c:0,f?n===1?(s=r.rowIndex>i._ftopRowIdx?this._getIdxWithOffset(r.rowIndex).yOffset-i._frozenHeight:0,r.rowIndex<i.frozenRows?this._scrollContent({y:n*(e-i.rowsHeightCollection[i._bottomRow.idx]-f)+1}):this._scrollContent({y:this._getIdxWithOffset(i._bottomRow.idx,null,!1,["freeze"]).yOffset-i._frozenHeight},!0),u=this._getIdxWithOffset(i._ftopRowIdx).yOffset+s):(s=r.rowIndex>i._ftopRowIdx?this._getIdxWithOffset(r.rowIndex).yOffset-i._frozenHeight:0,r.rowIndex>i.frozenRows&&a?this._scrollContent({y:f-(e-i.rowsHeightCollection[i._bottomRow.idx])+1},!0):this._scrollContent({y:u+i.rowsHeightCollection[i._bottomRow.idx]-i._frozenHeight+1},!0),u=this._getIdxWithOffset(i._ftopRowIdx).yOffset+s):n===1&&this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal&&i._bottomRow.value+this.model.rowHeight+i._vPortHgt>=i._rowHeightCollection[i._rowHeightCollection.length-1]?u=i._rowHeightCollection[i._rowHeightCollection.length-1]:this._scrollContent({y:n*(e-i._scrollTop)}),h=this._getIdxWithOffset(u,i._colWidthCollection[r.colIndex],!0),this._setAndSelectActiveCell(h.rowIdx,h.colIdx))}},_keyboardShortCuts:function(i){var v,p,c,y,w,a;if(this.model.allowEditing&&this.XLEdit._isEdit||this.model.allowComments&&this.XLComment._isCommentEdit&&i.keyCode!==27)return!1;var h,s,e,o=this.XLFormat,l=this.getActiveSheetIndex(),u=this.getSheet(l),f=u._selectedCells,r=!1;if(this.model.allowLockCell&&u.isSheetProtected&&(r=!0),!i.ctrlKey&&!i.shiftKey)switch(i.keyCode){case 33:i.preventDefault();this._pageUpDown(-1);break;case 34:i.preventDefault();this._pageUpDown(1);break;case 36:i.preventDefault();this._setAndSelectActiveCell(this.getActiveCell(l).rowIndex,this._isFrozen(u.frozenColumns)?u._frozenColumns-1:0,"Home")}if(i.ctrlKey&&!i.shiftKey){if(!this.element.find("#"+this._id+"_Ribbon .e-ribbonbackstagepage").is(":visible"))switch(i.keyCode){case 65:i.preventDefault();this.model.allowSelection&&(h=this.getActiveCellElem(),this.selectAll(),t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(n(h[0]).closest("tr").index(),h[0].cellIndex,{keyCode:i.keyCode}),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement());break;case 66:i.preventDefault();r||this._toggleFontPrpty("bold");break;case 68:case 82:i.preventDefault();this.model.allowAutoFill&&this.XLDragFill._fillRange(i.keyCode===68);break;case 73:i.preventDefault();r||this._toggleFontPrpty("italic");break;case 75:i.preventDefault();this.model.allowHyperlink&&!r&&this._showDialog(this._id+"_Ribbon_Insert_Links_Hyperlink");break;case 85:i.preventDefault();r||this._toggleFontPrpty("underline");break;case 32:if(i.preventDefault(),!this.model.allowSelection)return;v=f[0].colIndex;p=f[f.length-1].colIndex;s={rowIndex:0,colIndex:v};e={rowIndex:u.rowCount-1,colIndex:p};this.model.allowSelection&&this.XLSelection.selectRange(s,e);u._startCell=s;u._endCell=e;u._isColSelected=!0;t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(f[0].rowIndex,v);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();break;case 35:i.preventDefault();e=this._getUsedRangeFromSheet(l).endCell;this._setAndSelectActiveCell(e.rowIndex,e.colIndex,"End");break;case 36:i.preventDefault();this._setAndSelectActiveCell(this._isFrozen(u.frozenRows)?u._frozenRows-1:0,this._isFrozen(u.frozenColumns)?u._frozenColumns-1:0,"Ctrl + Home");break;case 49:i.preventDefault();this._showDialog(this._id+"_FormatCells");break;case 53:i.preventDefault();r||this._toggleFontPrpty("line-through");break;case 56:i.shiftKey||r||(i.preventDefault(),this._hideColumn(u._startCell.colIndex,u._endCell.colIndex));break;case 57:i.shiftKey||(i.preventDefault(),r||this._hideRow(u._startCell.rowIndex,u._endCell.rowIndex,"isRHide"));break;case 220:i.shiftKey||(i.preventDefault(),this.model.allowSearching&&this.XLSearch._applyGotoRowDiff());break;case 90:i.preventDefault();break;case 89:i.preventDefault();break;case 114:i.preventDefault();this.model.showRibbon&&!r&&this.XLRibbon._openNameManagerDlg();break;case 70:i.preventDefault();this._showDialog(this._id+"_Ribbon_Others_Editing_FindSelect");n("#"+this._id+"_FRDialog").ejDialog("open");this.XLRibbon._refreshFRDlg();n("#"+this._id+"_FRDialog_FPDlgTab").ejTab("option","selectedItemIndex",0);break;case 71:i.preventDefault();this._showDialog(this._id+"_Ribbon_Others_Editing_FindSelect");n("#"+this._id+"_GoDialog").ejDialog("open");n("#"+this._id+"_GoToDlgTab").ejTab("option","selectedItemIndex",0);break;case 72:i.preventDefault();this._showDialog(this._id+"_Ribbon_Others_Editing_FindSelect");n("#"+this._id+"_FRDialog").ejDialog("open");this.XLRibbon._refreshFRDlg();n("#"+this._id+"_FRDialog_FPDlgTab").ejTab("option","selectedItemIndex",1)}switch(i.keyCode){case 80:i.preventDefault();this.XLPrint.printSheet();break;case 79:if(i.preventDefault(),this.model.allowImport){if(this.model.importSettings.importMapper.length<1){this._showAlertDlg("Alert","ImportExportUrl","",266);return}this.isDirty&&this._browserDetails.name!=="msie"?this._showAlertDlg("","ImportAlert","Open",470,135):n("#"+this._id+"_file .e-uploadinput").click()}break;case 83:i.preventDefault();this.model.exportSettings.allowExporting&&(this._showDialog("exportxl"),n("#"+this._id+"_ExportFileNameDialog").ejDialog("open"),this.XLExport._exportType="Excel")}}if(i.ctrlKey&&i.shiftKey){if(!this.element.find("#"+this._id+"_Ribbon .e-ribbonbackstagepage").is(":visible")){this._browserDetails.name==="mozilla"&&i.keyCode===173&&(i.keyCode=189);switch(i.keyCode){case 192:i.preventDefault();r||o.format({type:"general"});break;case 52:i.preventDefault();r||o.format({type:"currency"});break;case 53:i.preventDefault();r||o.format({type:"percentage"});break;case 54:i.preventDefault();r||o.format({type:"scientific"});break;case 51:i.preventDefault();r||o.format({type:"shortdate"});break;case 50:i.preventDefault();r||o.format({type:"time"});break;case 49:i.preventDefault();r||o.format({type:"number"});break;case 55:i.preventDefault();this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder&&!r&&this.XLFormat.applyBorder({top:"1px solid #000000",right:"1px solid #000000",bottom:"1px solid #000000",left:"1px solid #000000"});break;case 189:i.preventDefault();this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder&&!r&&this.XLFormat.applyBorder("noborder");break;case 73:i.preventDefault();this.model.allowInsert&&!r&&this._showDialog(this._id+"_Ribbon_Others_Cells_InsertCellOptions");break;case 68:i.preventDefault();this.model.allowDelete&&!r&&this._showDialog(this._id+"_Ribbon_Others_Cells_DeleteCellOptions");break;case 113:i.preventDefault();c=n("#"+this._id+"_Ribbon").data("ejRibbon");this.model.showRibbon&&(c._isCollapsed?(c.expand(),c._removeRibbonPin(),this._isKeyCtrlShftF2=!0):c.collapse());break;case 56:i.preventDefault();!r&&this.model.allowSelection&&this._showColumn(f[0].colIndex,f[f.length-1].colIndex);break;case 57:i.preventDefault();!r&&this.model.allowSelection&&this._showRow(f[0].rowIndex,f[f.length-1].rowIndex,"isRHide");break;case 79:i.preventDefault();this.XLSearch._applyGotoComments();break;case 220:i.preventDefault();this.XLSearch._applyGotoColDiff();break;case 36:i.preventDefault();e=this.getActiveCell(l);this._selectActiveCell(0,0,e,"Ctrl + Shift + Home")}}}else if(i.shiftKey)i.keyCode===32?(i.preventDefault(),this.model.allowSelection&&(y=f[0].rowIndex,w=f[f.length-1].rowIndex,s={rowIndex:y,colIndex:0},e={rowIndex:w,colIndex:u.colCount-1},this.XLSelection.selectRange(s,e),u._startCell=s,u._endCell=e,u._isRowSelected=!0,t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(y,f[0].colIndex),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())):i.keyCode===113?(this._dupDetails=!0,i.preventDefault(),h=this.getActiveCellElem(),this.model.allowComments&&!r&&(this._isRibbonClick=!0,h.hasClass("e-commentcell")?this.XLComment.editComment():this.XLComment.setComment(),this._isRibbonClick=!1),this._dupDetails=!1):i.keyCode===122&&(i.preventDefault(),this.addNewSheet());else if(i.keyCode===27){if(this.model.allowComments&&this.XLComment._isCommentEdit&&(this.XLComment._updateCurCmntVal(),this.XLComment._updateCmntRibIcons()),this.model.allowContextMenu&&(this.XLCMenu._isMenuOpened||n("#"+this._id+"_contextMenuColumnHeader").is(":visible")||n("#"+this._id+"_contextMenuRowHeader").is(":visible"))&&this.XLCMenu.hideCMenu(),this.model.allowFiltering&&this._excelFilter&&this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")){if(a=this._excelFilter._menuWrap.data("ejMenu"),a.element.find(".e-mhover li:visible").length){a._isContextMenuOpen||a._closeMenu();return}this.XLFilter._isSearchEdit=!1;this._excelFilter.closeXFDialog()}this.setSheetFocus()}else i.altKey&&(i.keyCode===112&&this.model.showRibbon&&this.model.allowCharts&&!r?(i.preventDefault(),this.XLChart.createChart(null,{type:"column",enable3D:!1,marker:{visible:!1}})):i.keyCode===84&&this.model.showRibbon&&!this.XLRibbon._isDirtySelect&&!r&&this.model.allowFormatAsTable&&(this._showDialog(this._id+"_Ribbon_Insert_Tables_Table"),i.preventDefault(),this.XLRibbon._openFATDlg()))},_triggerTBtnClick:function(t){var i=n("#"+t).data("ejToggleButton");i.buttontag.click()},_toggleFontPrpty:function(n){var e=this.getActiveCell(),o=this.XLFormat,u={style:{}},f,t,i,r;f=this.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"format");i=!this.isUndefined(f)&&this.XLFormat.getFormatFromHashCode(f);t=n==="bold"?"font-weight":n==="italic"?"font-style":"text-decoration";r=n.charAt(0).toUpperCase()+n.slice(1).toLowerCase();r==="Line-through"&&(r="StrikeThrough");i[t]===n?(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).length&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).ejToggleButton("option","toggleState",!1),u.style[t]="none"):t==="text-decoration"&&(i[t]==="underline"||i[t]==="line-through")?(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).length&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).ejToggleButton("option","toggleState",!0),u.style[t]=i[t]==="underline"?n+" "+i[t]:i[t]+" "+n):t==="text-decoration"&&(i[t]==="line-through underline"||i[t]==="underline line-through")?(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).length&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).ejToggleButton("option","toggleState",!1),i[t]=i[t].split(" ").join(""),u.style[t]=i[t].replace(n,"")):(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).length&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).ejToggleButton("option","toggleState",!0),u.style[t]=n);o.format(u)},_getLocStr:function(n){return this.localizedLabels[n]},_checkIndicesInContainer:function(n,t,i,r){var u=this._dataContainer.sheets;return n in u&&t in u[n]&&i in u[n][t]?r?r in u[n][t][i]?!0:!1:!0:!1},_textFormatting:function(t){switch(t){case"wrapText":var i=n("#"+this._id+"_Ribbon_Home_Alignment_WrapText").data("ejToggleButton");i&&this.setWrapText(i.model.toggleState?"wrap":"unwrap",null)}},wrapText:function(n){this.model.allowWrap&&!this.model.isReadOnly&&this.setWrapText("wrap",n)},unWrapText:function(n){this.model.allowWrap&&!this.model.isReadOnly&&this.setWrapText("unwrap",n)},setWrapText:function(n,i){var u,tt,k;if(this.model.allowWrap&&!this.model.isReadOnly){var r,v,f,o=this.getActiveSheetIndex(),y,s,c,e=this.getSheet(o),h=0,p,a=this.model.rowHeight,w,d=this.getRows(o),ot=d[1],it=d[0],g,nt=e.rowsHeightCollection,st=e.columnsWidthCollection,a=0,b=e._wrapHtCollection,l=!1,rt,ut=this.model.scrollSettings.allowVirtualScrolling,ft=e._clrWrapColl,et;if(v=this._getRangeArgs(i,"object"),r=this._getSelectedCells(o,v).selCells,r.length!==0){for(g=r.length>1?this._getProperAlphaRange(o,r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex):this._getAlphaRange(o,r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex),u=0,tt=r.length;u<tt;u++)if(rt=ut?this._getRowIdx(r[u].rowIndex):r[u].rowIndex,et=r[r.length-1],l=this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"wrap"),this._isPaste||(n!=="unwrap"||l)&&(n!=="wrap"||!l)){if(n==="unwrap"&&l)this._isUndoRedo||ft.push({rowIdx:r[u].rowIndex,colIdx:r[u].colIndex}),this._isRowViewable(o,r[u].rowIndex)&&(f=this.getCell(r[u].rowIndex,r[u].colIndex),this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"merge")&&!this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"cellType")&&(y=f.find("#"+this._id+"_MergeWrap"),y.length&&(f[0].innerHTML=y[0].innerHTML,y.remove())),s=r[u].rowIndex,c=r[u].colIndex,f&&this._removeClass(f[0],"e-sswraptext"),this._removeClass(it[s],"e-sswraprow"),this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"altTxt")&&this.addClass(f[0],"e-alt-unwrap"),s in e._wrapColl&&c in e._wrapColl[s]&&(delete e._wrapColl[s][c],p=t.max(this._getObjectValues(e._wrapColl[s])),e._formatColl[s]&&e._formatColl[s][c]&&p<e._formatColl[s][c]&&(p=e._formatColl[s][c]),this.getObjectLength(e._wrapColl[s])||delete e._wrapColl[s]),f.find(".e-filterspan").length>0&&(w=f.find(".e-filterspan"),this.model.allowFiltering&&this.XLFilter._postionFilterIcon(f,w))),this.XLEdit._clearDataContainer({cellIdx:r[u],property:["wrap"]}),this.XLEdit._clearDataContainer({cellIdx:{rowIndex:r[u].rowIndex,colIndex:0},property:["wrapRow"]}),this.XLEdit._clearDataContainer({cellIdx:{rowIndex:0,colIndex:r[u].colIndex},property:["wrapCol","wrapWidth"]}),h=this._getWrapCellHeight(o,r[u].rowIndex,r[u].colIndex,p),this._textClip(r[u].rowIndex,r[u].colIndex,"add");else if(n==="wrap"&&!l){if(this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"isFilterHeader"))continue;this._textClip(r[u].rowIndex,r[u].colIndex,"delete");this._wrapCollection(r[u].rowIndex,r[u].colIndex,nt[r[u].rowIndex],o);this.XLEdit._updateDataContainer({rowIndex:r[u].rowIndex,colIndex:r[u].colIndex},{dataObj:{wrap:!0}});this._isRowViewable(o,r[u].rowIndex)&&(f=this.getCell(r[u].rowIndex,r[u].colIndex),(f.is(":visible")||this._isPaste)&&this.model.allowResizing&&!this.XLResize._preventRowResize(r[u].rowIndex)&&(this.addClass(f[0],"e-sswraptext"),this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"altTxt")&&this._removeClass(f[0],"e-alt-unwrap"),f.find(".e-filterspan").length>0&&(w=f.find(".e-filterspan"),this.model.allowFiltering&&this.XLFilter._postionFilterIcon(f,w))));h=this._getWrapCellHeight(o,r[u].rowIndex,r[u].colIndex);h.rowHt<a&&(h.rowHt=a);a=h.rowHt;this._wrapCollection(r[u].rowIndex,r[u].colIndex,h.cellHt,o);this.XLEdit._updateDataContainer({rowIndex:r[u].rowIndex,colIndex:r[u].colIndex},{dataObj:{wrap:!0}});b[r[u].rowIndex]=u>0&&r[u].rowIndex===r[u-1].rowIndex?b[r[u-1].rowIndex]:b[r[u].rowIndex]=nt[r[u].rowIndex];t.isNullOrUndefined(this.XLEdit.getPropertyValue(r[u].rowIndex,0,"wrapCol"))&&this.XLEdit._updateDataContainer({rowIndex:0,colIndex:r[u].colIndex},{dataObj:{wrapCol:!0,wrapWidth:this.getSheet(o).columnsWidthCollection[r[u].colIndex]}})}h.rowHt>0&&(r[u].colIndex===v[3]||this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"merge"))&&(this.setHeightToRows([{rowIndex:r[u].rowIndex,height:h.rowHt}]),a=0,n!=="wrap"||l||t.isNullOrUndefined(this.XLEdit.getPropertyValue(r[u].rowIndex,0,"wrapRow"))&&this.XLEdit._updateDataContainer({rowIndex:r[u].rowIndex,colIndex:0},{dataObj:{wrapRow:!0}}));this.model.allowFreezing&&(this.XLFreeze._refreshFRowResize(r[u].rowIndex),this.XLFreeze._refreshSelection());r[u].colIndex===v[3]&&(a=0);h=0}this.model.allowComments&&this.XLComment._updateCmntArrowPos();this.model.scrollSettings.allowScrolling&&this.XLScroll._getRowHeights(o,r[0].rowIndex+1);(!e._isImported||e._isLoaded)&&(k={sheetIndex:o,selectedCell:r,reqType:"textwrap",operation:n,range:g},this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(o,"refresh","all"),this.model.allowSelection&&this.XLSelection._refreshBorder(),this._isUndoRedo||this._dupDetails||(this._completeAction(k),this._trigActionComplete(k)))}}},_getWrapCellHeight:function(n,t,i,r){var u,o,f=0,s=0,e,h=this.getSheet(n),c=h.rowsHeightCollection,l=h.columnsWidthCollection;if(o=this.XLEdit.getPropertyValue(t,i,"merge"),f=c[t],s=l[i],o){for(u=t+1;u<t+o.mSpan.rowSpan;u++)f=f+c[u];for(u=i+1;u<i+o.mSpan.colSpan;u++)s=s+l[u]}return o?(f=this._getRowHeight(t,n),e=r?r:f):(e=r?r:this._detailsFromGlobalSpan(t,i,"height",this.XLEdit.getPropertyValue(t,i,"value2"),s),e=e<this.model.rowHeight?this.model.rowHeight:e,f=e),{cellHt:e,rowHt:f}},_wrapCollection:function(n,t,i,r){var u=this.getSheet(r?r:this.getActiveSheetIndex());u._wrapColl[n]||(u._wrapColl[n]={});this.getObjectLength(u._wrapColl[n])>-1&&(u._wrapColl[n][t]=i);u.rowsHeightCollection[n]<i&&!this._isInMrgeRnge(n,t,!u._isLoaded)&&(u.rowsHeightCollection[n]=i,this.model.scrollSettings.allowScrolling&&this.XLScroll._getRowHeights(r,n,!0),this._getRowHdrTBody(r).find('tr[idx="'+n+'"]').height(i))},_isInMrgeRnge:function(n,t,i){if(!i)return this.XLEdit.getPropertyValue(n,t,"merge");var u,r,e=this._getSheetIndex(),f=this._impData?this._impData.model.sheets[e].mergedCells:[];for(f||(f=[]),u=0;u<f.length;u++)if(r=this.getRangeIndices(f[u].range),r[0]<=n&&r[2]>=n&&r[1]<=t&&r[3]>=t)return!0;return!1},_setWrapHeight:function(t,i,r,u,f,e){var o,h,c=r[i],s=this.getSheet(t),l=s.rowsHeightCollection;l[i]>0?o=l[i]:(s.hideRowsCollection.indexOf(i)===-1||e==="visible")&&(h=n(r[i].outerHTML).attr("id","ss"),f[0].insertBefore(h[0],f[0].childNodes[0]),o=f[0].rows[0].getBoundingClientRect().height,f[0].rows[0].parentNode.removeChild(f[0].rows[0]));o=o<20?20:o;parseInt(c.style.height)<o&&(c.style.height=o+"px",n(u[i])[0].style.height=o+"px",s.rowsHeightCollection[i]=o)},_setRowHdrHeight:function(n,t){var r=this._getRowIdx(t),u,f,i=this.getSheet(n),e=this.getRows(n),o=i.rowsHeightCollection[t];this._isRowViewable(n,t)&&(f=parseInt(e[0][r].style.height),f!=o&&(e[0][r].style.height=o+"px",this.model.allowSelection&&(u=this._intrnlReq,this._intrnlReq=!0,this.XLSelection.refreshSelection(),i._isFreezed&&this.XLFreeze._refreshSelection(),this._intrnlReq=u),(!i._isImported||i._isLoaded)&&this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()))},_refreshRangeTRHght:function(n,t){for(var r=t[0]<1?t[0]:t[0]-1,u=this.getSheet(n),i=r;i<=t[2];i++)this._setRowHdrHeight(n,i);this.XLScroll._getRowHeights(n,r);(!u._isImported||u._isLoaded)&&this.model.allowSelection&&this.XLSelection._refreshBorder()},_renderAlertdlg:function(){var u,f,e,o,s,r,h="<div class='e-dlg-btnctnr' id=",i=this._id+"_alertdlg",c={text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertOkClick,this),enabled:!0,cssClass:"e-ss-okbtn"};document.getElementById(this._id+"_alertdlg")||(o="<input id="+this._id+"_dialog_Ok ><\/input><input id="+this._id+"_dialog_Can style= 'margin-left: 10'; ><\/input>",u="<input id="+this._id+"_dialog_alertOk > <\/input>",e=h+i+"_condiv >"+o+"<\/div>",f=h+i+"_alertdiv >"+u+"<\/div>",r="<div class='e-alertdlgcontent' id="+i+"_dlgcontent > <\/div>",r=r+"<div class='e-dlg-btnfields' id="+i+"_dlgbtncontent >"+e+f+"<\/div>",s=n("<div id="+i+" class='e-alertdlg' style= 'display : none;'>"+r+"<\/div>"),this.element[0].appendChild(s[0]),n("#"+this._id+"_dialog_alertOk").ejButton(c),n("#"+this._id+"_dialog_Ok").ejButton(c),n("#"+this._id+"_dialog_Can").ejButton({text:this._getLocStr("Cancel"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertCanClick,this)}))},alert:function(t){var i=n("#"+this._id+"_alertdlg");this._renderAlertDlgContent(i,"Alert",t);i.ejDialog("open")},_renderAlertDlgContent:function(n,i,r,u,f,e){var o=n.find("#"+this._id+"_alertdlg_dlgcontent"),s=n.find("#"+this._id+"_alertdlg_condiv"),h=n.find("#"+this._id+"_alertdlg_alertdiv");this._tabMode||this._phoneMode?f>this._responsiveWidth/1.2&&(f=this._responsiveWidth/1.2):f=f||400;e=e||"";i==="Alert"?(s.hide(),h.show()):(s.show(),h.hide());o.text("");o.html(r);n.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,enableAnimation:!1,allowKeyboardNavigation:!1,title:this._getLocStr("Title"),width:f,height:"auto",minHeight:0,cssClass:"e-ss-dialog e-"+this._id+"-dlg"+e,open:t.proxy(this._alertDlgOpen)});this._alertDialog={element:n,action:u}},_alertDlgOpen:function(){this.element.find("input:visible:first").focus()},_alertOkClick:function(){var u,r=1,i=this.getActiveSheetIndex(),f,e=this._isUndoRedo,t;this._alertDialog.element.ejDialog("close");switch(this._alertDialog.action){case"findPrevComment":this.gotoPage(this.model.sheetCount,!1);u=this.model.sheets[this.model.sheetCount];this.XLComment._updateCurrentCell(u.rowCount-1,u.colCount-1);this.XLComment.findPrevComment();this._alertDialog.action=null;break;case"findNextComment":this.gotoPage(1,!1);this.XLComment._updateCurrentCell(0,0);this.XLComment.findNextComment();this._alertDialog.action=null;break;case"sheetRenameActn":n("#"+this._id+"_Sheet_RenamePanel").select().focus();break;case"sheetDeleteActn":this._removeSheet(i);this._alertDialog.action=null;break;case"New":this._isNew=!0;this._destroy();this._dataContainer.sheets[r]={};this.clearUndoRedo();this._updateCellType();this.model.sheetCount=r;this.model.activeSheetIndex=r;this._sheetSettings(r);this._newSIndex++;this._initCSSTag();this.gotoPage(r,!1);this.model.allowLockCell&&this.protectSheet(!1);f=n("#"+this._id+"_Ribbon_Review_Changes_ProtectWorkbook").data("ejToggleButton");f&&(f.option("toggleState",!1),this.model.exportSettings.password=null,n("#"+this._id+"_AddSheet").removeClass("e-disable"));this.XLRibbon._toggleFormatTab();this.XLRibbon._toggleChartDesignTab();this.XLRibbon._toggleAnalyzeTab();this._refreshSpreadSheetPager();this.hideWaitingPopUp();this._isNew=!1;break;case"Open":n("#"+this._id+"_file .e-uploadinput").click();break;case"MergeCells":this._mergeCells(i,this.model.sheets[i]._selectedCells,{},[]);this._alertDialog.action=null;break;case"MergeAcrossCells":this._mergeAcrossCells(i,this.model.sheets[i]._selectedCells);this._alertDialog.action=null;break;case"MergeInsertDelete":this._refreshMergeCells();this._alertDialog.action=null;break;case"InvalidChartTitleActn":n("#"+this._id+"_chartnamedlg").find("input:first").focus();break;case"ConvertToRange":this.XLFormat._convertToRange({});break;case"TotalRow":this._isUndoRedo=this._dupDetails=!0;this.insertEntireRow(this._insRows.startRow,this._insRows.endRow);this.XLFormat._calculateTotalRow(i,null,!0,!1,!0);this._isUndoRedo=e;break;case"Drop":t=this.getSheet(i);this.XLDragDrop.moveRangeTo([t._startCell.rowIndex,t._startCell.colIndex,t._endCell.rowIndex,t._endCell.colIndex],[this._dStartCell.rowIndex,this._dStartCell.colIndex,this._dEndCell.rowIndex,this._dEndCell.colIndex]);t._startCell=this._dStartCell;t._endCell=this._dEndCell;this._trigger("drop",{sheetIndex:i,target:this.XLDragDrop._target,currentCell:this.XLDragDrop._dragAndDropCell,dragAndDropRange:{startCell:t._startCell,endCell:t._endCell}});break;case"FormulaAlert":this.XLEdit._editElem.focus();break;case"NMUniqueNameAlert":case"NMNameAlert":document.getElementById(this._id+"_nmgridname")&&document.getElementById(this._id+"_nmgridname").focus();break;case"NMRangeAlert":document.getElementById(this._id+"_nmgridrefersto")&&document.getElementById(this._id+"_nmgridrefersto").focus();break;case"OpenValDlg":n("#"+this._id+"_ValDialog").ejDialog("open");break;default:this.setSheetFocus()}},_alertCanClick:function(){var t=this._alertDialog,i;(t.action=="findNextComment"||t.action=="findPrevComment")&&n(this.getActiveCellElem()).find(".e-comment-txtarea").css("display","inline-table");t.action=="TotalRow"&&n("#"+this._id+"_Ribbon_Design_TableStyleOptions_TotalRow").length&&(this.XLRibbon._isSetModel=!0,n("#"+this._id+"_Ribbon_Design_TableStyleOptions_TotalRow").data("ejCheckBox").option("checked",!1),this.XLRibbon._isSetModel=!1);t.element&&t.element.ejDialog("close");switch(t.action){case"Drop":i=this.getSheet(this.getActiveSheetIndex());this.performSelection(i._startCell,i._endCell)}this.hideWaitingPopUp()},_showAlertDlg:function(t,i,r,u,f){var o=n("#"+this._id+"_alertdlg"),s="Alert",e,h={reqType:"alert",action:r};if(i instanceof Array?i[0]==="SheetRenameEmptyAlert"?e="<ul><li>"+this._getLocStr(i[0])+"<\/li><li>"+this._getLocStr(i[1])+"<\/li><li>"+this._getLocStr(i[2])+"\\ / ? * ["+this._getLocStr("OR")+"  ] <\/li><li>"+this._getLocStr(i[3])+"<\/li><\/ul>":i[0]==="ClipboardAccessError"&&(e=this._getLocStr(i[0])+"<br /><br />"+this._getLocStr(i[1])+"<br />"+this._getLocStr(i[2])+"<br />"+this._getLocStr(i[3])):e=i.indexOf("T-")===0?i.slice(2):this._getLocStr(i),this._trigActionBegin(h)){this._alertDialog.action=r;this._alertCanClick();return}t===s?this._renderAlertDlgContent(o,s,e,r,u,f):this._renderAlertDlgContent(o,"",e,r,u,f);o.ejDialog("open")},_isSheetsDirty:function(){var n=1,t=this._dataContainer.sheets,i=this.getObjectLength(t)+1;if(this.model.nameManager.length||this.getObjectLength(t)>1)return!0;while(n<i){if(this.getObjectLength(t[n]))return!0;n++}return!1},getCell:function(t,i,r){var u=0,r=this._getSheetIndex(r),f=this.getSheet(r);return this.model.scrollSettings.allowVirtualScrolling&&(u=1,t=this._getRowIdx(t,r),t===-1)?null:(this.isImport||f._isImported||this._isPrint)&&this._detachTable?n(this._detachTable[0].tBodies[u].rows[t].cells[i]):this._getContTBody(r)?n(this._getContTBody(r)[0].rows[t].cells[i]):null},getRange:function(i,r,u){i=this._getRangeArgs(i,"object",r);var l=i[0],e=i[1],h=i[2],f=i[3],o,y,c,s,a,w,v,p=[],r=this._getSheetIndex(r),b=this.getSheet(r);if(c=(this.isImport||b._isImported)&&this._detachTable?n(this._detachTable[0].tBodies[1].rows):n(this._getContTBody(r)[0].rows),l>h&&(a=l,l=h,h=a),e>f&&(a=e,e=f,f=a),this.model.scrollSettings.allowVirtualScrolling)for(o=l;o<=h;o++)y=this._getRowIdx(o),y>-1&&(s=n(c[y].cells),v=f===e?[s[f]]:this._browserDetails.version==="8.0"?s.slice(e,f+1).toArray():s.slice(e,f+1),t.merge(p,v));else for(c=h!==l?c.slice(l,h+1):c.eq(h),w=c.length,o=0;o<w;o++)u&&this._isHiddenRow(o,r)||(s=n(c[o].cells),v=f===e?[s[f]]:this._browserDetails.version==="8.0"?s.slice(e,f+1).toArray():s.slice(e,f+1),t.merge(p,v));return n(p)},getRangeIndices:function(n){n=n.indexOf(":")===-1?n+":"+n:n;var r=n.split(":"),t,i=[];return t=r[0].split(/[A-Z]/i),i.push(parseInt(t[t.length-1])-1),i.push(this._generateColCount(r[0].split(/[0-9]/)[0].toUpperCase())-1),t=r[1].split(/[A-Z]/i),i.push(parseInt(t[t.length-1])-1),i.push(this._generateColCount(r[1].split(/[0-9]/)[0].toUpperCase())-1),this.swapRange(i),i},swapRange:function(n){return n[0]>n[2]&&t.dataUtil.swap(n,0,2),n[1]>n[3]&&t.dataUtil.swap(n,1,3),n},updateRange:function(n,t){var v;if(!this.model.isReadOnly){var u,o,y,s,p,h,c,f,l,r=[],a=[],e=t.dataSource,w=e.length,b=this.getObjectLength(e[0]);if(c=t.startCell,t.range?r=t.range:(h=c.split(/[A-Z]/i),r.push(parseInt(h[h.length-1])-1),r.push(this._generateColCount(c[0].split(/[0-9]/)[0].toUpperCase())-1),r.push(r[0]+w-(t.showHeader?0:1)),r.push(r[1]+b-1)),f=this._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),p=this._getContent(n),l=this._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content >table"),this.model.allowAutoCellType&&this.model.allowCellType||l.detach(),t.showHeader)for(s in e[0])a.push(s);for(o=0;o<w;o++)if(e[o]!=i)for(s in e[0])a.push(e[o][s]);for(this._dupDetails=!0,u=0,y=f.length;u<y;u++)this.XLEdit._updateCell(f[u],a[u],n),t.showHeader&&u<b&&(r=t.startCell+":"+(this._generateHeaderText(f[f.length-1].colIndex+1)+(f[0].rowIndex+1)),t.headerStyles&&this.XLFormat.format({style:t.headerStyles},r));this._dupDetails=!1;this.model.allowAutoCellType&&this.model.allowCellType||p.find(".e-content").append(l);this._isUndoRedo||(v={sheetIndex:n,reqType:"update-range",rangeSettings:t},this._completeAction(v),this._trigActionComplete(v))}},editRange:function(t,i){var o,s,v,r,y,u,a,h,f=this.getActiveSheetIndex(),e=this.getSheet(f).rangeSettings[t],c=this.getRangeIndices(e.range),l=this.getRange(c);for(this._trigger("editRangeBegin",{range:e,sheetIndex:f}),e.cssClass&&l.addClass(e.cssClass),e.readOnly&&l.addClass("e-readonly"),y=this._getContent(f),a=this._getJSSheetContent(f).find(".e-spreadsheetcontentcontainer > .e-content >table"),a.detach(),o=0,v=l.length;o<v;o++)r=l[o],h=n(r),n.trim(t).length&&this.XLEdit._updateDataContainer({rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},{dataObj:{range:t}}),u=i(r,r.cellIndex,o),typeof u=="string"?this.XLEdit._updateCell({rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},u):typeof u=="object"&&(u.Value.indexOf("=")!==0?this.XLEdit._updateCell({rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},u.Value):this.XLEdit._updateCellValue({rowIndex:r.parentNode.rowIndex,colIndex:r.cellIndex},u.Value),h.data("value2",u.Value2),h.data("type",u.NumberFormat),u.StyleIndex>1&&h.addClass(this._styleColl[u.StyleIndex]));for(y.find(".e-content").append(a),s=c[0];s<c[2]+1;s++)this._setRowHdrHeight(f,s);this._trigger("editRangeComplete",{range:e,sheetIndex:f});this.XLScroll._getRowHeights(f,c[0])},removeRange:function(n){this.clearRange(n);delete this.getSheet(this.getActiveSheetIndex()).rangeSettings[n]},clearRange:function(n){if(!this.model.isReadOnly){var r,t,i=this.getSheet(this.getActiveSheetIndex()).rangeSettings[n];r=this.getRangeIndices(i.range);t=this.getRange(r);i.cssClass&&t.removeClass(i.cssClass);i.readOnly&&t.removeClass("e-readonly");this.clearRangeData(null,["range","value","type","value2"],t);t.empty()}},getObjectLength:function(n){var t,i=0;if(n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{},Object.keys)return Object.keys(n).length;for(t in n)n.hasOwnProperty(t)&&i++;return i},getObjectKeys:function(n){var t,i=[];if(n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{},!Object.keys){for(t in n)n.hasOwnProperty(t)&&i.push(t);return i}if(Object.keys)return Object.keys(n)},toArrayLowerCase:function(n){for(var t=0;t<n.length;t++)n[t]=n[t].toString().toLowerCase();return n},_isValueAlreadyExist:function(n,t,i){for(var r=0,u=n.length;r<u;){if(n[r][t]===i)return!0;r++}return!1},addClass:function(n,t){if(n){(n instanceof jQuery||n instanceof Array)&&(n=n[0]);var i=n.className;i.indexOf(t)===-1&&(n.className=i+" "+t)}},_removeClass:function(n,t){n&&((n instanceof jQuery||n instanceof Array)&&(n=n[0]),n.className=t?n.className.replace(new RegExp(t,"g"),"").replace(/ +/g," "):"")},_hasClass:function(n,t){return n?((n instanceof jQuery||n instanceof Array)&&(n=n[0]),!n||this._isAnimatedString(n.className))?!1:n.className.indexOf(t)>-1:!1},isUndefined:function(n){return n===i},_isString:function(n){return typeof n=="string"},_isEmptyString:function(n){return!n.toString().length},_isObject:function(n){return typeof n!="object"?!1:Object.prototype.toString.call(n)==="[object Object]"},_getObjectValues:function(n){var t,i=[];n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{};for(t in n)n.hasOwnProperty(t)&&i.push(n[t]);return i},_isAnimatedString:function(n){return Object.prototype.toString.call(n)==="[object SVGAnimatedString]"},_isBool:function(n){return n=n+"",n=n.toUpperCase(),n==="TRUE"||n==="FALSE"},isRange:function(n){return n&&(n[0]!==n[2]||n[1]!==n[3])},_isMultiRange:function(n){return!this._isString(n)&&!this.isNumber(n[0])},inRange:function(n,t,i){return n&&t>=n[0]&&t<=n[2]&&i>=n[1]&&i<=n[3]},_inRow:function(n,t){return n&&t>=n[0]&&t<=n[2]},_inColumn:function(n,t){return n&&t>=n[1]&&t<=n[3]},_isUniqueRange:function(n,t){return n.toString()===t.toString()},_isUniqueTarget:function(n,t){var i=this._getOriginalEvt(t),r=document.elementFromPoint(i.clientX,i.clientY);return n.target===r},_getClientDiff:function(n,t){return{x:n[0]-t[0],y:n[1]-t[1]}},hasSpan:function(n){return this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"merge")?!0:!1},_isFrozen:function(n){return n>0},_isSelected:function(t){return this._hasClass(t,"e-selected")||this._hasClass(t,"e-rowselected")||this._hasClass(t,"e-colselected")||n(t).parents(".e-colselected").length?!0:!1},_getMergedIdx:function(n,t){var u,e,o,s,h,i,c,l,a,f=this.getActiveSheetIndex(),r=this.XLEdit.getPropertyValue(n,t,"merge",f);if(l=a=0,r){if(r.mRange){if(u=this.getRangeIndices(r.mRange),c=this.getSheet(f),c.hideRowsCollection.length&&(e=u[0],o=u[2],o-e>1))for(i=e+1;i<o;)this.XLEdit.getPropertyValue(i,0,["isRHide"],f)&&l++,i++;if(this.getObjectLength(c.hideColsCollection)&&(s=u[1],h=u[3],h-s>1))for(i=s+1;i<h;)this.XLEdit.getPropertyValue(0,i,["isCHide"],f)&&a++,i++}if(r.mSpan)return{rowIndex:n+r.mSpan.rowSpan+l-1,colIndex:t+r.mSpan.colSpan+a-1}}return{rowIndex:n,colIndex:t}},_getMergeParent:function(n,t){var i=this.XLEdit.getPropertyValue(n,t,"mergeIdx");return i?{rowIndex:i.rowIndex,colIndex:i.colIndex}:{rowIndex:n,colIndex:t}},_getCellInfo:function(n,t){var i=this.getSheet(this._getSheetIndex(t)),s,h,u,f=0,e=0,o,r;if(s=n.rowIndex>=i._frozenRows?i._rowHeightCollection[n.rowIndex]-(i._rowHeightCollection[i._ftopRowIdx]-i._rowHeightCollection[i._frozenRows-1]):i._rowHeightCollection[n.rowIndex],h=n.colIndex>=i._frozenColumns?i._colWidthCollection[n.colIndex]-(i._colWidthCollection[i._fleftColIdx]-i._colWidthCollection[i._frozenColumns-1]):i._colWidthCollection[n.colIndex],u=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"merge"),u){for(o=u.mSpan,r=0;r<o.rowSpan;r++)e+=i.hideRowsCollection.indexOf(n.rowIndex+r)===-1?i.rowsHeightCollection[n.rowIndex+r]:0;for(r=0;r<o.colSpan;r++)f+=i.columnsWidthCollection[n.colIndex+r]}else e=i.hideRowsCollection.indexOf(n.rowIndex)===-1?i.rowsHeightCollection[n.rowIndex]:0,f=i.columnsWidthCollection[n.colIndex];return{top:s-1,left:h-1,height:e,width:f}},_getRowIdx:function(n,t,i,r){var u,f=this.getSheet(t);return i?(u=f._rowIdxColl[n],n=this.isUndefined(u)?f._rowIdxColl[f._rowIdxColl.length-1]:u):r?(u=f._rowIdxColl.indexOf(n),n=u===-1?n:u):this.model.scrollSettings.allowScrolling&&this.model.scrollSettings.allowVirtualScrolling&&(n=f._virtualRowIdx.indexOf(n)),n},_getMinRowIdx:function(n){for(var t=0;t<n.rowCount;t++)if(n.hideRowsCollection.indexOf(t)===-1&&n._hiddenFreezeRows.indexOf(t)===-1)return t;return 0},_arrayAsString:function(n){return n.join(" ").replace(/,/g," ")},_rangeHasData:function(n){var t,i,r;for(n=this.swapRange(n),t=this._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]}),i=t.length;i--;)if(r=t[i],this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex))return!0;return!1},_isTableRange:function(n,t,i){i=this._getSheetIndex(i);var r,u=this.getSheet(i).tableManager;for(r in u)if(this.inRange(u[r].range,n,t))return!0;return!1},_hasCellStyle:function(n,t,i){for(var r,u=["borders","formats"],f=u.length;f--;)if(r=this.XLEdit.getPropertyValue(n,t,u[f],i),r)return!0;return!1},_isHiddenRow:function(n,t){return this.XLEdit.getPropertyValue(n,0,"isFilterHide",t)||this.XLEdit.getPropertyValue(n,0,"isRHide",t)||!1},_refreshViewVar:function(n,i,r){r=this._getSheetIndex(r);var u=this.getSheet(r);t.isNullOrUndefined(n)||(u._topRow.idx=this.XLShape._getCellIndexFromOffset(n,null,r).rowIndex,u._topRow.value=this._getRowOffsetTop(u,u._topRow.idx),u._bottomRow.idx=u._rowIdxColl[u._topRow.idx+(u._virtualBlockRowCnt-this._bufferCnt-1)],u._bottomRow.value=this._getRowOffsetTop(u,u._bottomRow.idx),u.topLeftCell=this.getAlphaRange(u._topRow.idx,u._leftCol.idx));t.isNullOrUndefined(i)||(u._leftCol.idx=this.XLShape._getCellIndexFromOffset(null,i,r).colIndex,u._leftCol.value=this._getColOffsetLeft(u,u._leftCol.idx),u._rightCol.idx=this.XLShape._getCellIndexFromOffset(null,i+u._vPortWth,r).colIndex||u.colCount-1,u._rightCol.value=this._getColOffsetLeft(u,u._rightCol.idx),u.topLeftCell=this.getAlphaRange(u._topRow.idx,u._leftCol.idx))},_getFormatString:function(n,i){var r=t.Spreadsheet.CellFormat[n];return this.isNumber(i)&&!t.isNullOrUndefined(r)&&(r="{0:"+r.substr(3,1)+i+"}"),r||""},_refreshVrtlBlocks:function(n){for(var r,u,f=["_virtualTopTBodyOffset","_virtualContTBodyOffset","_virtualBottomTBodyOffset"],n=this._getSheetIndex(n),t=this.getSheet(n),i=u=0;i<3;)(i||t._isVirtualTopReached)&&i!==1&&(i!==2||t._isVirtualEndReached)||(r=t._virtualRowIdx[u],t[f[i]].top=this._getRowOffsetTop(t,r),u+=t._virtualBlockRowCnt,r=t._virtualRowIdx[u-1],t[f[i]].bottom=this._getRowOffsetBottom(r,n)),i++;t._virtualTBodyHgt=t._rowHeightCollection[t._rowHeightCollection.length-1]+t.rowsHeightCollection[t.rowsHeightCollection.length-1]},getRangeDataAsObject:function(n,i,r){var f,s,e,h,c,w=t.Spreadsheet.CellType,o=this._dataContainer,d=this.getActiveSheetIndex(),l=o.sheets[this.getActiveSheetIndex()],u,a,v,y,b=[],k=[],p=[];for(n.rowIndex>i.rowIndex?(u=i.rowIndex,a=n.rowIndex):(u=n.rowIndex,a=i.rowIndex),n.colIndex>i.colIndex?(v=i.colIndex,y=n.colIndex):(v=n.colIndex,y=i.colIndex);u<=a;){if(!r||!this._isHiddenRow(u)){for(h={},c={},f=v;f<=y;f++)s=this._generateHeaderText(f+1),u in l&&f in l[u]&&(e=l[u][f],h[s]=o.sharedData[e.value],c[s]=[w.General,w.Text].indexOf(o.cellType[e.type])===-1?e.value2:o.sharedData[e.value2]);b.push(h);k.push(c)}u++}return p.push(b),p.push(k),p},getRangeDataAsJSON:function(n,i,r,u){var o,y,e,h,a=t.Spreadsheet.CellType,c=this._dataContainer,s=c.sheets[u?u:this.getActiveSheetIndex()],f,p,w,b,k=[],v=!0,d=[],l;for(n.rowIndex>i.rowIndex?(f=i.rowIndex,p=n.rowIndex):(f=n.rowIndex,p=i.rowIndex),n.colIndex>i.colIndex?(w=i.colIndex,b=n.colIndex):(w=n.colIndex,b=i.colIndex);f<=p;){if(!r||!this._isHiddenRow(f)){for(h={},o=w;o<=b;o++)v?f in s&&o in s[f]&&(e=s[f][o],d[o]=this.isUndefined(e.type)||[a.General,a.Text].indexOf(c.cellType[e.type])!==-1?c.sharedData[e.value2]:e.value2):(y=d[o],f in s&&o in s[f]?(e=s[f][o],l=this.isUndefined(e.type)||[a.General,a.Text].indexOf(c.cellType[e.type])!==-1?c.sharedData[e.value2]:e.value2,h[y]=t.isNullOrUndefined(l)?"":this.isNumber(l)?parseInt(l):l):h[y]="");!v&&this.getObjectLength(h)&&k.push(h)}f++;v&&(v=!1)}return k},_getColorFromFormat:function(n){var r=[],i,u,f;return t.isNullOrUndefined(n)||(i=n.replace("e-format","").toLowerCase(),u=i.startsWith("6n")?"#"+i.substr(2,6):"#"+i.substr(6,6),f="#"+i.substr(0,6),r.push(f),r.push(u)),r},getRangeData:function(n){n=n||{};n.sheetIdx=this._getSheetIndex(n.sheetIdx);n.range=this._toIntrnlRange(n.range,n.sheetIdx);n.property=n.property||["value","value2","type","formatStr","decimalPlaces","thousandSeparator","range","format","border","comment","hyperlink","picture","cFormatRule","rule","chart","isLocked","wrap","formats","cellType","altTxt"];var e=0,c,l,i,r,o,s,u,h=[],f=[],a=this.getSheet(n.sheetIdx);if(n.rowIdxs)for(c=n.rowIdxs.length;e<c;)this._pushRowData(n,n.rowIdxs[e],0,a.colCount-1,f,h),e++;else for(u=!1,this.model.scrollSettings.allowVirtualScrolling&&n.skipHiddenRow&&!t.isNullOrUndefined(n.virtualRowIdx)?(u=!0,i=n.virtualRowIdx,r=i+(n.virtualRowCount-1),o=a.colCount-1):(i=n.range[0],r=n.range[2],o=n.range[3]);i<=r;)s=this._isHiddenRow(i,n.sheetIdx),u&&s?r++:n.skipHiddenRow&&s||(l=u?0:n.range[1],this._pushRowData(n,i,l,o,f,h,!0)),i++;return n.withRowIdx?{rowIdx:h,data:f}:f},_pushRowData:function(n,t,i,r,u,f,e){var o,h,c,s,a,v="value",p=this._intrnlUpdate,y=this._dataContainer,l=y.sheets[n.sheetIdx];if(e||this.XLEdit._refreshContainer(t,n.sheetIdx),l[t])if(n.valueOnly)while(i<=r)o="",s=l[t][i],s&&v in s&&(a=y.sharedData,o=a[s[v]],n.skipDateTime&&this._isDateTime(o)?o=this.XLEdit.getPropertyValue(t,i,"value2",n.sheetIdx):n.skipFormula&&this.isFormula(o)&&(o=this.XLEdit.getPropertyValue(t,i,"calcValue",n.sheetIdx),this.isUndefined(o)&&(o=this.XLEdit.getPropertyValue(t,i,"value2",n.sheetIdx),o=this.XLEdit._parseValue(o).value))),n.skipEmptyCell&&(this.isUndefined(o)||!o.toString().length)||u.push(o),i++;else{for(this._intrnlUpdate=!0;i<=r;){if(s=l[t][i],s){h={};for(c in s)n.property.indexOf(c)>-1&&(h[c]=this.XLEdit.getPropertyValue(t,i,c,n.sheetIdx));(!n.skipEmptyCell||this.getObjectLength(h))&&u.push(h)}else n.skipEmptyCell||u.push({});i++}this._intrnlUpdate=p}else if(!n.skipEmptyCell)while(i<=r)n.valueOnly?u.push(""):u.push({}),i++;f.push(t)},_processBindings:function(n){if(this.model.query=new t.Query,this._trigger("actionBegin",n))return!0;this._ensureDataSource(n);n.action==="sorting"?(this.XLSort._sortComplete(n),this._isUndoRedo||(this._completeAction(n),this._trigActionComplete(n))):(this._completeAction(n),this._trigActionComplete(n))},_ensureDataSource:function(n){var r,v,o,u,s,h,f,c,l=this.getActiveSheetIndex(),a=this.getSheet(l),e,y;if(n.action==="filtering"||n.action==="clearfiltering"||n.requestType==="filterbycell"){for(r=a.filterSettings.filteredRange==null?this._dataSource(l):a.filterSettings.filteredRange,c=a.filterSettings.tableRange,e=0,y=c.length;e<y;e++)if(c[e].tableID===n.tableID){c[e].filteredRange=r;break}if(this._dataManager=t.DataManager(r),r instanceof t.DataManager||(this.model.currentViewData=r),this.model.query.requiresCount(),n.filteredcolumns.length){s=this._excelFilter._predicates[l];v=r[0];for(o in s)v.hasOwnProperty(o)&&(h=s[o]),h=s[o],u=u!=i?u.and(h):h;t.isNullOrUndefined(u)||this.model.query.where(u);r instanceof t.DataManager||(f=this._dataManager.executeLocal(this.model.query),this._filteredRecordsCount=f.count,this.model.currentViewData=f.result)}}else n.requestType==="sorting"&&(this._dataManager=t.DataManager(n.rangeData),n.rangeData instanceof t.DataManager||(this.model.currentViewData=n.rangeData),this.model.query.sortBy(n.columnName,n.sortDirection),n.rangeData instanceof t.DataManager||(f=this._dataManager.executeLocal(this.model.query),this.model.currentViewData=f));this._dataManager=null},_toArrayData:function(n){for(var u,t,i=0,r=[],f=n.length;i<f;){if(t=n[i],this.getObjectLength(t))for(u in t)r.push(t[u]);else r.push("");i++}return r},_updateRangeStyle:function(n,t,i){for(var u=this._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]}),r=0;r<u.length;r++)this.model.allowCellFormatting&&this.XLFormat._hasFormat(t[r].format)&&(this.XLFormat._updateFormatClass(u[r],t[r].format),this.XLEdit._updateDataContainer(u[r],{dataObj:{formats:t[r].formats},sheetIdx:this.getActiveSheetIndex(),status:i}))},updateRangeData:function(n,i){var u,f,r;if(!this.model.isReadOnly&&(n=this._getRangeArgs(n,"object"),n.length&&(n.startCell={rowIndex:n[0],colIndex:n[1]},n.endCell={rowIndex:n[2],colIndex:n[3]}),u=this._getSelectedRange(n.startCell,n.endCell),f=this._toArrayData(i),f.length===u.length))for(r=0;r<u.length;r++)t.isNullOrUndefined(f[r])||this.XLEdit._updateCellValue(this.getCell(u[r].rowIndex,u[r].colIndex),f[r])},updateData:function(n,i,r){if(!this.model.isReadOnly){var f,v,e,y,l,o,a,u,h,p=0,w="clear-format",s={},c=this._cellProp,b=this.getActiveSheetIndex(),k=this.getSheet(b);for(i=this._getRangeArgs(i,"object"),f=i[0],v=i[2],y=i[3];f<=v;){for(e=i[1];e<=y;)u=n[p],o=this.getCell(f,e,b),"wrap"in u&&(a=!0,delete u.wrap),this.XLEdit._updateDataContainer({rowIndex:f,colIndex:e},{dataObj:u}),a&&this.setWrapText("wrap",i),a=!1,o&&(c[13]in u&&(h=u.hyperlink,h&&(r===w?o.find("a").css({color:this._hlColor,"text-decoration":"underline"}).addClass("e-hyperlinks"):h.webAddr?o.html(t.buildTag("a",u.value2,"",{href:h.webAddr,target:"_blank","class":"e-hyperlinks"})):o.html(t.buildTag("a",u.value2,"",{"class":"e-hyperlinks"})))),c[6]in u&&(u.rule.isApply?this.addClass(o[0],"e-hlcell"):this._removeClass(o[0],"e-hlcell")),r===w&&(u.formatStr&&(s.formatStr=u.formatStr),u.type&&(s.type=u.type),t.isNullOrUndefined(u.decimalPlaces)||(s.decimalPlaces=u.decimalPlaces),t.isNullOrUndefined(u.thousandSeparator)||(s.thousandSeparator=u.thousandSeparator),this.XLFormat.format(s,[f,e,f,e])),c[21]in u&&this.XLComment._updateCmntFrmCntnr(f,e),c[0]in u&&(l=u.value,this.XLEdit._refreshCalcEngine(f,e,this.isFormula(l),l))),p++,e++;f++}}},updateUniqueData:function(n,t,i,r){if(!this.model.isReadOnly){t=this._getRangeArgs(t,"object");var u,f={dataObj:n},e=t[0],o=t[2],s=t[3];for(i&&(f.skipCell=i),f.sheetIdx=r;e<=o;){for(u=t[1];u<=s;)this.XLEdit._updateDataContainer({rowIndex:e,colIndex:u},f),u++;e++}}},clearRangeData:function(n,t,i,r,u,f){if(!this.model.isReadOnly){var e,o,s,h,c=this.getActiveSheetIndex();for(n=this._getRangeArgs(n,"object",c),t=t?t:["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","isFilterHighlight"],e=n[0],s=n[2],h=n[3];e<=s;){if(!r||!this._isHiddenRow(e))for(o=n[1];o<=h;)this.XLEdit._clearDataContainer({cellIdx:{rowIndex:e,colIndex:o},property:t,status:u,skipCell:f}),o++;t.indexOf("wrap")>-1&&this._setRowHdrHeight(c,e);e++}}},_getArrayRangeCells:function(n){return n?(n=this.swapRange(n),this.getRange(n)):this._getContent(this.getActiveSheetIndex()).find(".e-selected")},_getAlphaRangeCells:function(n){return n?(n=this.getRangeIndices(n),this.getRange(n)):this._getContent(this.getActiveSheetIndex()).find(".e-selected")},_getMultiRangeCells:function(n){var i,t,u,r,f;if(n){if(i=0,u=[],r=[],this._isString(n))r.push(this.getRangeIndices(n));else if(this.isNumber(n[0]))r.push(n);else for(f=n.length;i<f;)t=n[i],r.push(Array.isArray(t)?t:this.getRangeIndices(t)),i++;for(i=0,f=r.length;i<f;)t=r[i],u=u.concat(this._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]})),i++}else n=this._getRangeArgs(n,"object"),u=this._getSelectedCells(this.getActiveSheetIndex(),n).selCells;return u},_completeAction:function(n){var v,u=this.getActiveSheetIndex(),e=this.getSheet(u),i,s,y,p,h,c,l,r,f,o,a;if(n.reqType==="filter"||n.reqType==="filterbycolor"){if(n.operation!=="apply-filter"&&n.operation!=="remove-filter"&&n.operation!=="clearfilter")for(s=n.model.currentViewData,i={sheetIndex:u,range:e._selectedRange,currentViewData:s,fieldName:n.currentFilteringColumn,ejpredicate:n.ejpredicate,activeCell:n.activeCell,filteredValue:n.filteredValue,filterCollection:n.filteredcolumns,requestType:n.requestType,reqType:n.reqType,selectedCell:n.selectedCell,action:n.action,operation:"filter",selectedDataSource:e.selectedDataSource,tableID:n.tableID,filteredCells:n.filteredCells,fltrdIdxes:[],selRange:n.selRange},r=0,v=s.length;r<v;r++)i.fltrdIdxes.push(i.range.startRow+e.filterSettings.filteredRange.indexOf(s[r]));else i=n.operation==="remove-filter"||n.operation==="clearfilter"?n:{sheetIndex:u,filteredCells:n.filteredCells,reqType:"filter",operation:"apply-filter",tableID:n.tableID,fRange:this.getSheet(u).filterSettings.range};i.rowIndex=n.rowIndex;i.colIndex=n.colIndex}else if(n.requestType===t.Spreadsheet.Actions.Sorting){for(l=[],c=n.filterIcon.length>0?n.range[0]-1:n.range[0],r=0;r<n.filterIcon.length;r++)h=this.XLFilter._getFilterHeader(u,c,n.filterIcon[r].colIndex),y=t.isNullOrUndefined(h)?"":h.status.indexOf("-asc")>-1?"-asc":h.status.indexOf("-dsc")>-1?"-dsc":"",p=n.filterIcon[r].colIndex===this._generateColCount(n.columnName)-1?n.sortDirection==="ascending"?"-asc":"-dsc":"",l.push({rowIdx:c,colIdx:n.filterIcon[r].colIndex,prevIcon:y,currIcon:p});i={sheetIndex:u,filterIcons:l,isSortByFilter:n.isSortByFilter,colSelected:n.colSelected,range:n.range,columnName:n.columnName,rangeData:n.rangeData,reqType:"sort",direction:n.sortDirection,operation:"unsort"}}else if(n.requestType==="sortbycolor"||n.requestType==="filterbycolor"){if(i={sheetIndex:u,operation:n.operation,oprType:n.oprType,requestType:n.requestType,action:n.action,bgcolor:n.bgcolor,fgcolor:n.fgcolor,tableID:n.tableID,reqType:n.requestType,sortRange:n.sortRange},i.columnName=n.requestType==="sortbycolor"?n.sortColumn:n.filterColumn,n.requestType==="filterbycolor"){for(o=[],a=this._generateColCount(i.columnName),r=n.range.endRow;r>=n.range.startRow;r--)f=this.XLEdit.getPropertyValue(r,a-1,"formats"),t.isNullOrUndefined(f)||(n.operation==="filterbgcolor"?t.isNullOrUndefined(f["background-color"])||n.bgcolor.toLowerCase()===f["background-color"].toLowerCase()&&o.push(r):t.isNullOrUndefined(f.color)||n.fgcolor.toLowerCase()===f.color.toLowerCase()&&o.push(r));i.fltrdIdxes=o;i.rowIndex=n.range.startRow-1;i.colIndex=a-1}}else i=n;!this.model.allowUndoRedo||i.requestType==="sortbycolor"||this._dupDetails||this.updateUndoRedoCollection(i);(n.requestType==="filtering"||n.requestType==="filterbycolor"||n.requestType==="sortbycolor"||n.requestType==="filterbycell")&&n.operation!=="apply-filter"&&n.operation!=="remove-filter"&&this.sendDataRenderingRequest(i,this.getActiveSheetIndex());this.model.allowAutoFill&&n.reqType!=="find-replace"&&this.element.find(".e-ss-activeimg").length<1&&!e._isFreezed&&this.XLDragFill.positionAutoFillElement();this.XLComment&&this.XLComment._isCommentEdit||this._updateUndoRedoIcons();n.reqType!=="paging"&&n.reqType==="edit"&&n.hasValidation&&this._trigrDdlActnCmplt(n.cValue,n.pValue)},updateUndoRedoCollection:function(n){this._isUndoRedo||n.reqType==="update-range"||(this._undoCollection.push(n),this._redoCollection=[]);this._undoCollection.length>this.undoRedoStep&&this._undoCollection.splice(0,1);this.model.showRibbon&&this.XLRibbon._updateRibbonIcons();this._updateUndoRedoIcons()},_trigActionBegin:function(n){return!this._isSaveAsJSON&&this._trigger("actionBegin",n)},_trigActionComplete:function(n){return!this._isSaveAsJSON&&this._trigger("actionComplete",n)},_updateUndoRedoIcons:function(){if(!this.model.showRibbon||!this.model.allowUndoRedo){this.XLComment&&this.XLComment._isCommentEdit||this.setSheetFocus();return}if(n("#"+this._id+"_Ribbon_Home_Actions_Undo").length&&n("#"+this._id+"_Ribbon_Home_Actions_Redo").length&&!this.model.isReadOnly){var t=n("#"+this._id+"_Ribbon_Home_Actions_Undo").data("ejButton"),i=n("#"+this._id+"_Ribbon_Home_Actions_Redo").data("ejButton");t&&(this._undoCollection.length?t.enable():t.disable());i&&(this._redoCollection.length?i.enable():i.disable());this.XLEdit._isEdit||this.XLComment&&this.XLComment._isCommentEdit||this._isSheetRename||!document.activeElement||!(document.activeElement.id.indexOf(this._id+"_Ribbon")<0)||this.setSheetFocus()}},_filterMergeCells:function(n,t){for(var s=this.getActiveSheetIndex(),h=this._dataContainer.sheets[s],e=this.getObjectKeys(h[n]),r,i,o=!1,u,f=0;f<e.length;f++)u=this.XLEdit.getPropertyValue(n,e[f],"mergeIdx"),u&&(r=u,o=!0);o&&(i=this.getCell(r.rowIndex,r.colIndex)[0],i.rowSpan=t==="incr"?i.rowSpan+1:i.rowSpan-1)},_isRowVisible:function(n,t){var i=this._dataContainer.sheets[n];return t in i?0 in i[t]&&(i[t][0].isRHide||i[t][0].isFRHide)?!1:!0:!0},_selectFirstCell:function(n,t,i,r){var u=this.getSheet(n);return u._isImported&&!u._isLoaded||r||(r=!r,this.performSelection({rowIndex:t,colIndex:i},{rowIndex:t,colIndex:i})),r},_clearAllMergeCells:function(t,i,r,u,f,e){var l,v=this.getSheet(t),p=!1,k=this._dupDetails,w,y=v._mergeColl,d=v._unmergeColl,g=this._removeMergeColl,o,c,nt=this._dataContainer.sheets[t],a={isCancel:!1,isAlert:!0},s,b,h;for(this._dupDetails=!0,o=this.getObjectKeys(y),o.length<1&&(p=!0),s=0,b=o.length;s<b;s++)for(c=this.getObjectKeys(y[o[s]]),h=0;h<c.length;h++)l=n.extend(!0,{},this.XLEdit.getPropertyValue(o[s],c[h],"merge")),w=this.getRangeIndices(l.mRange),a=this._checkFilterMerge(t,w,i,r,u,f,e,"merge",p,o[s],c[h],l),a.isClear&&(o[s]in d||(v._unmergeColl[o[s]]={}),v._unmergeColl[o[s]][c[h]]={type:y[o[s]][c[h]],merge:l,isClear:!0},this.unmergeCells(l.mRange,!0)),a.isClear=!1;return this._dupDetails=k,{isCancel:a.isCancel,isAlert:a.isAlert}},_checkFilterMerge:function(n,t,i,r,u,f,e,o,s,h,c,l){var v,p=this.getSheet(n),y=this._getSelectedCells(n,[i,u,i+r-1,u+f-1]).range,a=!1,w=p._mergeColl;return e.indexOf("shift")>-1||o!="merge"&&(e.indexOf("insert")>-1||e.indexOf("delete")>-1)?(o==="merge"&&(this._removeMergeColl=[]),e.indexOf("Bottom")>-1||e.indexOf("Up")>-1||o!="merge"&&e.indexOf("Row")>-1?(u>=t[1]||t[3]>=u+f-1||e.indexOf("Row")>-1?(i>=t[2]||i<=t[2])&&(u<t[1]&&u+f-1<t[1]?s=!0:u>t[3]&&u+f-1>t[3]?s=!0:this._isTotalRow||u!==t[1]||t[3]!==u+f-1||(a=!0,s=!0),!s&&i>=t[2]&&(s=!0)):u<t[1]&&t[3]<u+f-1&&(s=!0,a=!0),o!=="merge"||this._isUndoRedo||e.indexOf("Up")>-1&&this.XLEdit._rangeHasProperty(y,"merge")&&(this._showAlertDlg("Alert","MergePreventInsertDelete","MergePreventInsertDelete",450),a=!1,v=!0)):(e.indexOf("Right")>-1||e.indexOf("Left")>-1||o!="merge"&&e.indexOf("Column")>-1)&&(i>=t[0]||t[2]>=i+r-1||e.indexOf("Column")>-1?(u>=t[3]||u<=t[3])&&(i<t[0]&&i+r-1<t[0]?s=!0:i>t[2]&&i+r-1>t[2]?s=!0:i===t[0]&&t[2]===i+r-1&&(a=!0,s=!0),!s&&u>t[3]&&(s=!0)):i<t[0]&&t[2]<i+r-1&&(s=!0,a=!0),o!=="merge"||this._isUndoRedo||e.indexOf("Left")>-1&&this.XLEdit._rangeHasProperty(y,"merge")&&(this._showAlertDlg("Alert","CtrlKeyErrorAlert","CtrlKeyErrorAction",450),a=!1,v=!0)),o!=="merge"||s||a||this._removeMergeColl.push({type:w[h][c],merge:l})):(this._isUndoRedo&&(s=!0),(i===-1||i!=-1&&t[0]<=i&&t[2]>i)&&(a=!0),(u===-1||u!=-1&&t[1]<=u&&t[3]>u)&&(a=!0)),{isClear:a,isAlert:s,isCancel:v}},_checkTableApplied:function(n,t,i,r,u,f){var o,a=this.getSheet(n),s,h=a.tableManager,c=this.getObjectKeys(h),e,l;for(this._isTableApplied=!1,e=0,l=c.length;e<l;e++)if(s=h[c[e]].range,o=this._checkFilterMerge(n,s,t,i,r,u,f,"filter",!1),this._isTableApplied=!o.isAlert,this._isTableApplied)return!0;return!1},_refreshAllMergeCells:function(n,i,r,u,f,e){var w,k,nt,p=this.getSheet(n),y=!1,d=p._unmergeColl,tt=this._dupDetails,it,rt,h,l,o,ut=this._dataContainer.sheets[n],a,v,b,s,g,c;for(h=this.getObjectKeys(d),this._dupDetails=!0,s=0,g=h.length;s<g;s++)for(it=parseInt(h[s])>i?e.indexOf("insert")>-1?parseInt(h[s])+r:parseInt(h[s])-r:h[s],l=this.getObjectKeys(d[h[s]]),c=0;c<l.length;c++)rt=parseInt(l[c])>u?e.indexOf("insert")>-1?parseInt(l[c])+f:parseInt(l[c])-f:l[c],w=p._unmergeColl[h[s]][l[c]].merge,this.mergeCenter=p._unmergeColl[h[s]][l[c]].type==="center",b=p._unmergeColl[h[s]][l[c]].isClear,o=this.getRangeIndices(w.mRange),(i>-1||u>-1)&&(t.isNullOrUndefined(o)||(e.indexOf("Shift")>-1?(this._unMergeRange=w.mRange,this._showAlertDlg("","MergeCellsAlert","MergeCellsInsertAlert",498)):(i>-1&&(o[0]===o[2]&&(y=!0),(!y||b)&&(a=o[0],v=o[2],i<=o[0]&&(a=e==="insert"?o[0]+r:o[0]-r),i<=o[2]&&(v=e==="insert"?o[2]+r:o[2]-r),a<=v&&(o[0]=a),v>=a&&(o[2]=v))),u>-1&&(o[1]===o[3]&&(y=!0),(!y||b)&&(a=o[1],v=o[3],u<=o[1]&&(a=e==="insert"?o[1]+f:o[1]-f),u<=o[3]&&(v=e==="insert"?o[3]+f:o[3]-f),a<=v&&(o[1]=a),v>=a&&(o[3]=v))),!y||y&&e==="insert"?(k=this._getAlphaRange(n,o[0],o[1],o[2],o[3]),this.mergeCells(k,!0),delete p._unmergeColl[h[s]][l[c]],y=!1,nt=!1):p._unmergeColl[h[s]][l[c]].isClear=!1)));this._dupDetails=tt},_clearMergeColl:function(n,t,i){n[t]&&delete n[t][i];this.getObjectKeys(n[t]).length<1&&delete n[t]},_refreshSHMergeCells:function(i,r,u,f,e){var gt,et,ei,oi,si,rt,ut,tt,nt,ni,l=this.getSheet(i),c,p,k=n.extend(!0,{},l._mergeColl),h,y,yt=0,w,o,ot,st,pt=!1,ht,ti,hi=[],b,d,ct,lt,wt=!1,bt,at,ft,it,kt,dt,ii,ri,s,ui,a,fi,v,vt,g;if(h=this.getObjectKeys(k),et=l._isFreezed?f==="column"?l._fHMergeCols:l._fHMergeRows:f==="column"?this.getObjectKeys(l.hideColsCollection):l.hideRowsCollection,e==="hide")for(s=0,ii=h.length;s<ii;s++)for(y=this.getObjectKeys(k[h[s]]),a=0,ri=y.length;a<ri;a++)if(ei=!1,ot=!1,oi=0,si=!1,rt=!1,w=this.XLEdit.getPropertyValue(h[s],y[a],"merge"),!(this.getObjectKeys(w).length<1)){for(o=this.getRangeIndices(w.mRange),c=f==="column"?o[1]:o[0],p=f==="column"?o[3]:o[2],v=c;v<=p;v++)if(r.indexOf(v)>-1){rt=!0;break}if(rt){if(this._dupDetails=!0,ut=r[0],tt=r[r.length-1],nt=tt-ut+1,this.mergeCenter=k[h[s]][y[a]].type==="center",it=k[h[s]][y[a]].oldRange,at=it?it:w.mRange,this.unmergeCells(w.mRange),tt<c)ot=!0,c=c+nt,p=p+nt;else if(p<ut)ot=!1;else{for(yt=0,st=!1,bt=0,v=0,vt=r.length;v<vt;v++)r[v]>=c&&r[v]<=p&&yt++,r[v]===c&&(st=!0),ti=f==="column"?r[v].toString():r[v],et.indexOf(ti)>-1&&bt++;for(r.indexOf(c)>-1&&(st=!0),ht=0,g=c;g<=p;g++)f==="column"&&(g=g.toString()),et.indexOf(g)>-1&&ht++;(c===p||ht===p-c+1)&&(pt=!0);st&&!pt&&(c=c+yt+(ht-bt))}gt=this.XLEdit.getPropertyValue(parseInt(h[s]),parseInt(y[a]),"value2");b=f==="row"?c:o[0];ct=f==="row"?p:o[2];d=f==="column"?c:o[1];lt=f==="column"?p:o[3];pt?h[s]in l._delmergeColl?l._delmergeColl[h[s]][y[a]]={type:k[h[s]][y[a]].type,merge:w,oldRange:at}:(l._delmergeColl[h[s]]={},l._delmergeColl[h[s]][y[a]]={type:k[h[s]][y[a]].type,merge:w,oldRange:at}):(this.mergeCells(this._getAlphaRange(i,b,d,ct,lt),!0),l._mergeColl[b]&&l._mergeColl[b][d]&&(l._mergeColl[b][d].oldRange=at),this._updateMergeColl(i,b,d,k[h[s]][y[a]].type,e==="hide"),(tt+1===b&&f==="row"||tt+1===d&&f==="column")&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(b,d))&&(this.XLEdit.updateCellValue({rowIndex:b,colIndex:d},gt),l._wrapColl[parseInt(h[s])]&&l._wrapColl[parseInt(h[s])][parseInt(y[a])]&&(this._wrapCollection(b,d,l._wrapColl[parseInt(h[s])][parseInt(y[a])],i),this._isRowViewable(i,b)?hi.push({rowIndex:b,height:l.rowsHeightCollection[parseInt(h[s])]}):l.rowsHeightCollection[b]=l.rowsHeightCollection[parseInt(h[s])])));this.mergeCenter=!1}}if(e==="show")for(this.getObjectLength(l._delmergeColl)>0&&(k=n.extend(!0,k,l._delmergeColl)),h=this.getObjectKeys(k),s=0,ui=h.length;s<ui;s++)for(y=this.getObjectKeys(k[h[s]]),a=0,fi=y.length;a<fi;a++){if(rt=!1,ni=k[h[s]][y[a]].mergeType,w=k[h[s]][y[a]].merge,this.getObjectKeys(w).length<1&&(w=this.XLEdit.getPropertyValue(h[s],y[a],"merge")),this.getObjectKeys(w).length>0){for(o=this.getRangeIndices(w.mRange),c=f==="column"?o[1]:o[0],p=f==="column"?o[3]:o[2],it=k[h[s]][y[a]].oldRange,it?(ft=this.getRangeIndices(it),kt=f==="column"?ft[1]:ft[0],dt=f==="column"?ft[3]:ft[2]):(kt=c,dt=p),ut=r[0],tt=r[r.length-1],v=ut;v<=tt;v++)if(v>=kt&&v<=dt){rt=!0;break}if(!rt)continue;for(ni==="merge-cells"&&(this._dupDetails=!0,nt=tt-ut+1,tt<c&&(this.mergeCenter=w.isCenterAlign,this.unmergeCells(w.mRange),ot=!0,nt!=u&&(p=p-nt),c=c-nt,b=f==="row"?c:o[0],ct=f==="row"?p:o[2],d=f==="column"?c:o[1],lt=f==="column"?p:o[3],this.mergeCells(this._getAlphaRange(i,b,d,ct,lt),!0),this._updateMergeColl(i,b,d,k[h[s]][y[a]].type,e==="hide"),l._mergeColl[b][d].oldRange=it)),wt=!1,v=0,vt=r.length;v<vt;v++)if(f==="row"&&o[0]<=r[v]||f==="column"&&o[1]<=r[v]){wt=!0;break}if(wt){for(this.mergeCenter=w.isCenterAlign,this.unmergeCells(w.mRange),o=this.getRangeIndices(w.mRange),nt=0,g=c;g<=p;g++)if(f==="column"&&(g=g.toString()),et.indexOf(g)>-1)nt++;else break;c=c+nt;f==="column"?o[1]=c:o[0]=c;this.mergeCells(this._getAlphaRange(i,o[0],o[1],o[2],o[3]),!0);this._updateMergeColl(i,o[0],o[1],k[h[s]][y[a]].type,!0);l._mergeColl[o[0]][o[1]].oldRange=it;this._clearMergeColl(l._delmergeColl,h[s],y[a])}}this.mergeCenter=!1}this.model.showRibbon&&this._isScrolling&&this.XLRibbon._updateRibbonIcons();this._dupDetails=!1},_getSpanFromMCells:function(n,t,i){var u=this.getSheet(this.getActiveSheetIndex()),r=u._hideMergeColl;return!this.isUndefined(r[n])&&!this.isUndefined(r[n][t])?i==="row"?r[n][t].rowspan:r[n][t].colspan:0},_setSpanToMCells:function(n,t,i,r){var f=this.getSheet(this.getActiveSheetIndex()),u=f._hideMergeColl;this.isUndefined(u[n])&&(u[n]={});this.isUndefined(u[n][t])&&(u[n][t]={});i==="row"?u[n][t].rowspan=r:u[n][t].colspan=r},sendDataRenderingRequest:function(r,u){for(var f,it,rt=!1,oi,nt,vt,at,si=this._rAlign,o=this.getSheet(u),g=this.model.scrollSettings.allowVirtualScrolling,e=o._selectedRange,k=[],h,hi,dt,l=o.filteredRowsCollection,v,et,y,p=o.filterSettings.tableRange,ot=[],gt,st,b=[],ht,ti=this.getSheetElement(u)[0].querySelectorAll(".e-spreadsheetcolumnheader"),ii=n(this._getJSSheetHeader(u)[0].querySelectorAll("colgroup")[0].outerHTML).attr("id","ss"),ri=this.getSheetElement(u)[0].querySelectorAll(".e-rowheadercontent td"),ft,w,wt,ni,s,bt,kt,d,ui,lt,fi,ei,a=0,ut=p.length;a<ut;a++)if(p[a].tableID==r.tableID){y=a;break}if(g&&(oi=o.rowsHeightCollection,nt=o.hideRowsCollection),this._dupDetails=!0,!t.isNullOrUndefined(r)&&(r.reqType=="filter"||r.action.indexOf("clearfiltering")>-1&&r.reqType=="filterbycolor")){if(h=this._generateColCount(r.fieldName)-1,it=n.inArray(r.fieldName,o._filteredColumns),r.action.indexOf("clearfiltering")>-1?o._filteredColumns.splice(it,1):it<0&&o._filteredColumns.push(r.fieldName),e=r.range,ot=p[y].hiddenIdx,vt=r.currentViewData,r.requestType.indexOf("filtering")>-1||r.requestType.indexOf("filterbycell")>-1||r.action.indexOf("clearfiltering")===-1||r.action.indexOf("clearfiltering")>-1&&r.reqType=="filterbycolor"){for(at=o.filterSettings.filteredRange,vt.length<1&&k.push(at[at.length-1].idx+1),a=0,ut=vt.length;a<ut;a++)it=at.indexOf(vt[a]),it>-1&&k.push(at[it].idx);for(p[y].fltrdIdxes=k,v=e.startRow===0?0:e.startRow,f=v;f<=e.endRow;f++){for(ht=!1,s=0,ft=k.length;s<ft;s++)k[s]==f&&(ht=!0);ht?(t.isNullOrUndefined(this._dataContainer.sheets[u][f])||t.isNullOrUndefined(this._dataContainer.sheets[u][f][0])||(delete this._dataContainer.sheets[u][f][0].isFilterHide,delete this._dataContainer.sheets[u][f][0].filterID,o._filterHRowsColl.indexOf(f)>-1&&o._filterHRowsColl.splice(o._filterHRowsColl.indexOf(f),1)),g?(nt.indexOf(f)>-1&&(this._refreshSHMergeCells(u,[f],1,"row","show"),nt.splice(nt.indexOf(f),1)),v=f===0?0:f-1,this.XLEdit.getPropertyValue(v,0,"hRow")&&(delete this._dataContainer.sheets[u][v][0].hRow,l.indexOf(f)>-1&&l.splice(l.indexOf(f),1))):(this._dupDetails=this._isFilter=!0,this._showRow(f+1,f,i,i,ti,ii,ri),this._dupDetails=this._isFilter=!1,l.indexOf(f)>-1&&l.splice(l.indexOf(f),1),o._isImported&&!o._isLoaded||rt||(rt=!rt,this.performSelection({rowIndex:f,colIndex:h},{rowIndex:f,colIndex:h})))):(t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isRHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFilterHide"))&&(this.XLEdit._updateDataContainer({rowIndex:f,colIndex:0},{dataObj:{isFilterHide:!0,filterID:r.tableID}}),l.indexOf(f)<0&&l.push(f),et=!0),g?(et&&(nt.push(f),et=!1,this._refreshSHMergeCells(u,[f],1,"row","hide")),v=f===0?0:f-1,this.XLEdit._updateDataContainer({rowIndex:v,colIndex:0},{dataObj:{hRow:!0}}),l.indexOf(f)<0&&l.push(f)):(this._dupDetails=this._isFilter=!0,this._hideRow(f,f,"isFilterHide"),this._dupDetails=this._isFilter=!1,l.indexOf(f)===-1&&l.push(f)))}v=e.startRow===0?0:e.startRow-1;g&&(!o._isImported||o._isLoaded)&&(this.refreshContent(u),this.performSelection({rowIndex:v,colIndex:h},{rowIndex:v,colIndex:h}));!g&&this._hideRowColl.length&&(this._getRowHdrTBody(u).append(this._renderRowHdr(this._hideRowColl,u)),this._getContTBody(u).append(n(this._renderData(i,u,0,o.colCount,!1,this._hideRowColl[0],this._hideRowColl.length))),this._hideRowColl=[]);this.XLScroll._getRowHeights(u,v);hi=o.columns;r.action==="clearfiltering"&&(o._filteredByColor=-1,this._excelFilter.closeXFDialog());this.model.allowFiltering&&this.XLFilter._updateFilterIcons(v,e.startRow,h,r.action);p[y].hiddenIdx=n.extend(!0,[],ot);ot=[]}}else if(!t.isNullOrUndefined(r)&&(r.requestType==="sortbycolor"||r.requestType==="filterbycolor")){var ci=e.startRow,yt=[],ct,pt=[],h=this._generateColCount(r.columnName)-1,c,tt;if(r.prev={},r.cur={},r.oprType.indexOf("Put")<0&&(o._filterColl[e.startRow-1][h].status.indexOf("e-ssfilter")>-1&&r.requestType==="filterbycolor"?this._isRowViewable(u,e.startRow-1)&&(dt=this.getCell(e.startRow-1,h),dt.removeClass(si),this.XLFilter._changeFilterIcon({rowIndex:e.startRow-1,colIndex:h},"filter",this.XLEdit.getPropertyValue(e.startRow-1,h,"filterState"))):o._filterColl[e.startRow-1][h].status.indexOf("-asc")&&(r.prev.icon=o._filterColl[e.startRow-1][h].status,this._isRowViewable(u,e.startRow-1)&&(dt=this.getCell(e.startRow-1,h),this.XLFilter._changeSortIcon({rowIndex:e.startRow-1,colIndex:h},"ascending")),r.cur.icon=o._filterColl[e.startRow-1][h].status)),r.requestType==="sortbycolor"){for(c=[e.startRow,h,e.endRow,h],tt=this.getRangeData({range:c,skipHiddenRow:!0}),a=0,ft=tt.length;a<ft;a++)ct=tt[a].formats,t.isNullOrUndefined(ct)||(r.operation==="sortbgcolor"?t.isNullOrUndefined(ct["background-color"])||r.bgcolor===ct["background-color"].toLowerCase()&&yt.push(a):t.isNullOrUndefined(ct.color)||r.fgcolor===ct.color.toLowerCase()&&yt.push(a));if((r.oprType==="PutCellColor"||r.oprType==="PutFontColor")&&(c=r.sortRange),this.isUndefined(r.tableID))for(w=[],kt=c[1];kt<=c[3];kt++)w.push(kt);else w=p[y].multifilterIdx;for(c=[e.startRow,w[0],e.endRow,w[w.length-1]],tt=this.getRangeData({range:c,skipHiddenRow:!0}),r.prev.data=n.extend(!0,[],tt),c.colIndex=h,r.range=c,s=0,ut=w.length;s<ut;s++){for(wt=[],ni=[],c=[e.startRow,w[s],e.endRow,w[s]],tt=this.getRangeData({range:c,skipHiddenRow:!0}),bt=yt.length-1;bt>=0;bt--)wt.push(tt.splice(yt[bt],1)[0]);ni=wt.reverse().concat(tt);wt.length>0&&(this._isSort=!0,this._dupDetails=!0,this.XLComment.deleteComment(c,null,!0,null),this._removeHyperlink(null,null,!0,c),this.clearRangeData(c,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0),this.XLFormat.removeStyle(c,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0}),this._isSort=!1,this._dupDetails=!1,this.XLEdit.updateCellWithContainer(ni,c,u,!0))}c=[e.startRow,w[0],e.endRow,w[w.length-1]];r.cur.data=n.extend(!0,[],this.getRangeData({range:c,skipHiddenRow:!0}));this.updateUndoRedoCollection(r)}else{for(pt=[],ot=[],p[y].fltrdIdxes=k=r.fltrdIdxes,v=e.startRow===0?0:e.startRow,f=v;f<=e.endRow;f++){for(ht=!1,s=0,ft=k.length;s<ft;s++)k[s]==f&&(ht=!0);ht?(lt=this.XLEdit.getPropertyValue(f,h,"value2"),lt=t.isNullOrUndefined(lt)?"":lt,gt={field:r.columnName,value:lt,predicate:"or",operator:"equal",matchcase:!1},st=t.Predicate(r.columnName,"equal",lt),this.XLEdit.getPropertyValue(f,0,"filterID")===r.tableID&&(delete this._dataContainer.sheets[u][f][0].isFilterHide,delete this._dataContainer.sheets[u][f][0].filterID,g?(nt.splice(nt.indexOf(f),1),this._refreshSHMergeCells(u,[f],1,"row","show")):(this._dupDetails=this._isFilter=!0,this._showRow(f+1,f,i,i,ti,ii,ri),this._dupDetails=this._isFilter=!1,l.indexOf(f)>-1&&l.splice(l.indexOf(f),1),o._isImported&&!o._isLoaded||rt||(rt=!rt,this.performSelection({rowIndex:f,colIndex:h},{rowIndex:f,colIndex:h})))),pt.push(gt),b.push(gt),d=b[0],ui=d.from):(t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isRHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFilterHide"))&&(this.XLEdit._updateDataContainer({rowIndex:f,colIndex:0},{dataObj:{isFilterHide:!0,filterID:r.tableID}}),et=!0),g?et&&(nt.push(f),this._refreshSHMergeCells(u,[f],1,"row","hide")):(this._dupDetails=this._isFilter=!0,this._hideRow(f,f,"isFilterHide"),this._dupDetails=this._isFilter=!1,l.indexOf(f)===-1&&l.push(f)),et=!1)}for(g&&(!o._isImported||o._isLoaded)&&(this.refreshContent(u),this.performSelection({rowIndex:k[0],colIndex:h},{rowIndex:k[0],colIndex:h})),!g&&this._hideRowColl.length&&(this._getRowHdrTBody(u).append(this._renderRowHdr(this._hideRowColl,u)),this._getContTBody(u).append(n(this._renderData(i,u,0,o.colCount,!1,this._hideRowColl[0],this._hideRowColl.length))),this._hideRowColl=[]),this.XLScroll._getRowHeights(u,v),r.filterCollection=pt,st=d.ejpredicate?d.ejpredicate:t.Predicate(d.field,d.operator,d.value,!d.matchcase),s=1;s<b.length;s++)st=b[s].ejpredicate!=i?st[b[s].predicate](b[s].ejpredicate):st[b[s].predicate](b[s].field,b[s].operator,b[s].value,!b[s].matchcase);t.isNullOrUndefined(p[y].predicate[r.columnName])&&(p[y].predicate[r.columnName]={});p[y].filteredColumns=pt;p[y].predicate[r.columnName]=ui?{from:d.from,take:d.take}:st;p[y].hiddenIdx=n.extend(!0,[],ot);ot=[]}}t.isNullOrUndefined(r)||r.action!=="filter"&&r.action!=="filtering"&&r.action!=="filterbycolor"?r.action==="clearfiltering"&&(r.tableID>-1&&o.filterSettings.tableRange[y].filterColumnName.pop(r.fieldName),this.XLFilter._fltrRowHighlight(e.startRow,e.endRow,"clear",r.tableID,r.filterCollection.length)):(r.tableID>-1&&o.filterSettings.tableRange[y].filterColumnName.push(r.fieldName),this.XLFilter._fltrRowHighlight(e.startRow,e.endRow,"add",r.tableID,r.filterCollection.length));this._dupDetails=!1;this.model.showRibbon&&this.model.allowFiltering&&(fi=n("#"+this._id+"_Ribbon_Data_SortFilter_ClearFilter").data("ejButton"),ei={rowIndex:this.getActiveCell().rowIndex,colIndex:this.getActiveCell().colIndex},this.XLRibbon._changeClrFltrStatus(fi,"button",ei));this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(u,"refresh","vertical","filter")},_filterClose:function(t){this.model.allowFiltering&&!this._hasClass(t,"e-filterspan")&&n(t).parents(".e-excelfilter").length<1&&this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")&&(this._excelFilter.closeXFDialog(),this.XLFilter._isSearchEdit=!1)},showPager:function(n){var t;this.model.showPager=n;t=this.model.scrollSettings;this.element.find(".e-spreadsheetfooter").css("display",n?"block":"none");this._setSheetWidthHeight(this.getActiveSheetIndex(),{width:this._responsiveWidth,height:this._responsiveHeight})},_refreshClipboard:function(n,t){var r=this.model,i=this._id;n.length&&(r.allowFormatPainter&&r.allowCellFormatting||n.find("#"+i+"_Ribbon_home_Clipboard")[t](),n.find("#"+i+"_Ribbon_home_Clipboard_1")[t](),n.find("#"+i+"_Ribbon_home_Clipboard_Home_Clipboard_Cut")[t](),n.find("#"+i+"_Ribbon_home_Clipboard_Home_Clipboard_Copy")[t]())},_setModel:function(i){var f,v,g,c,w,d,b,l=this.getActiveSheetIndex(),e=this.model,p=e.scrollSettings,u=this._id,s=n("#"+u+"_Ribbon").ejRibbon("instance"),r=this.model.showRibbon?s.element:[],k,a,o,it,rt,ut,h,y;for(v in i){f=i[v];switch(v){case"allowClipboard":f?(this._refreshClipboard(r,"show"),t.isNullOrUndefined(this.XLClipboard)&&(this.XLClipboard=new t.spreadsheetFeatures.clipboard(this)),this.XLClipboard._initCopyPaste()):this._refreshClipboard(r,"hide");break;case"activeSheetIndex":this.gotoPage(f,!1);break;case"pageSettings":this.isUndefined(i.pageSettings.currentPage)||this.gotoPage(i.pageSettings.currentPage,!1);this.isUndefined(i.pageSettings.pageCount)||(this.getPager().ejPager("option","pageCount",i.pageSettings.pageCount),this._refreshSpreadSheetPager(!0));break;case"allowComments":f?(t.isNullOrUndefined(this.XLComment)&&(this.XLComment=new t.spreadsheetFeatures.comments(this)),r.length&&r.find("#"+u+"_Ribbon_review_Comments").show(),this.XLComment._updateCmntRibIcons()):this.model.showRibbon&&r.find("#"+u+"_Ribbon_review_Comments").hide();break;case"allowFormatPainter":e.allowCellFormatting&&(f?(e.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").show(),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(this)),r.length&&r.find("#"+u+"_Ribbon_home_Clipboard_Home_Clipboard_FormatPainter").show()):r.length&&(e.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").hide(),r.length&&r.find("#"+u+"_Ribbon_home_Clipboard_Home_Clipboard_FormatPainter").hide()));break;case"allowFormulaBar":f?(g=n("#"+this._id+"_formulabar"),g.length?this.showFormulaBar():(this._renderFormulaBar(!0),this._setSheetWidthHeight(l,{width:this._responsiveWidth,height:this._responsiveHeight}))):this.hideFormulaBar();break;case"allowHyperlink":r.length&&(f?r.find("#"+u+"_Ribbon_insert_Links").show():r.find("#"+u+"_Ribbon_insert_Links").hide());break;case"enableContextMenu":f&&t.isNullOrUndefined(this.XLCMenu)&&(this.XLCMenu=new t.spreadsheetFeatures.contextmenu(this),this.XLCMenu._initContextMenu(),this.XLCMenu._initColorDialog(),this.XLCMenu._initCMenuFooter());break;case"allowEditing":f?(t.isNullOrUndefined(this.XLEdit)&&(this.XLEdit=new t.spreadsheetFeatures.editing(this)),this.model.showRibbon&&r.length&&r.find("#"+u+"_Ribbon_home_Editing").show(),this.XLEdit._processEditing(),this.model.enableContextMenu&&this.XLCMenu._enableMenuOpt(["RenameSheet"],"contextMenuFooter")):(r.length&&r.find("#"+u+"_Ribbon_home_Editing").hide(),this.model.enableContextMenu&&this.XLCMenu._disableMenuOpt(["RenameSheet"],"contextMenuFooter"));break;case"allowResizing":f&&t.isNullOrUndefined(this.XLResize)&&(this.XLResize=new t.spreadsheetFeatures.resizing(this));break;case"allowDataValidation":f?(r.find("#"+u+"_Ribbon_data_DataTools").show(),t.isNullOrUndefined(this.XLValidate)&&(this.XLValidate=new t.spreadsheetFeatures.validation(this),this.XLRibbon._renderValDialog(this.XLRibbon._initValDialog()),this.XLValidate._addDVMethod())):r.length&&r.find("#"+u+"_Ribbon_data_DataTools").hide();break;case"allowConditionalFormats":f?(r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_ConditionalFormatting").show(),this.XLRibbon._initCFDialog(),t.isNullOrUndefined(this.XLCFormat)&&(this.XLCFormat=new t.spreadsheetFeatures.cFormat(this))):r.length&&r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_ConditionalFormatting").hide();break;case"allowSearching":this.model.allowSearching=f;f?(t.isNullOrUndefined(this.XLSearch)&&(this.XLSearch=new t.spreadsheetFeatures.findnreplace(this)),r.length&&r.find("#"+u+"_Ribbon_others_Editing").show()):r.length&&r.find("#"+u+"_Ribbon_others_Editing").hide();break;case"pictureSettings":for(w in f)switch(w){case"allowPictures":e.pictureSettings.allowPictures=f[w];f[w]?(t.isNullOrUndefined(this.XLShape)&&(this.XLShape=new t.spreadsheetFeatures.shape(this)),r.length&&r.find("#"+u+"_Ribbon_insert_Illustrations").show()):r.length&&r.find("#"+u+"_Ribbon_insert_Illustrations").hide()}break;case"showRibbon":this.model.showRibbon=f;k=n("#"+u+"_Ribbon");f?(k.length?k.show():this.XLRibbon._renderRibbon(!0),s=n("#"+u+"_Ribbon").ejRibbon("instance"),r=s.element,r[0].style.overflow==="hidden"&&(r[0].style.overflow="")):k.hide();this.refreshSpreadsheet();break;case"exportSettings":for(c in f)switch(c){case"allowExporting":e.exportSettings.allowExporting=f[c];f[c]?((e.exportSettings.excelUrl||e.exportSettings.csvUrl||e.exportSettings.pdfUrl)&&r.length&&r.find("#saveas_backStageTab").show(),t.isNullOrUndefined(this.XLExport)&&(this.XLExport=new t.spreadsheetFeatures.exporting(this))):(r.length&&r.find("#saveas_backStageTab").hide(),r.length&&r.find("#"+u+"_Ribbon_BackStage_saveas").hide());break;case"excelUrl":e.exportSettings.excelUrl=f[c];f[c]?(r.length&&r.find("#saveas_backStageTab").show(),r.find("#"+u+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(0)").show()):r.find("#"+u+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(0)").hide();break;case"csvUrl":e.exportSettings.csvUrl=f[c];f[c]?(r.length&&r.find("#saveas_backStageTab").show(),r.find("#"+u+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(1)").show()):r.find("#"+u+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(1)").hide();break;case"pdfUrl":e.exportSettings.pdfUrl=i[v][c];f[c]?(r.length&&r.find("#saveas_backStageTab").show(),r.find("#"+u+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(2)").show()):r.find("#"+u+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(2)").hide()}break;case"allowKeyboardNavigation":f&&t.isNullOrUndefined(this.XLCellNav)&&(this.XLCellNav=new t.spreadsheetFeatures.cellNavigation(this));break;case"enablePivotTable":f?(t.isNullOrUndefined(this.XLPivot)&&(this.XLPivot=new t.spreadsheetFeatures.pivot(this)),r.length&&r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_PivotTable").show()):(r.length&&r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_PivotTable").hide(),this.hideActivationPanel(),this.XLRibbon._toggleAnalyzeTab(),this.getSheetElement(l).find(".e-ss-activepivot").removeClass("e-ss-activepivot"));break;case"allowAutoFill":f?(t.isNullOrUndefined(this.XLDragFill)?(this.XLDragFill=new t.spreadsheetFeatures.dragFill(this),this._createAutoFillElement()):this.getAutoFillElem().show(),this.XLDragFill.positionAutoFillElement()):(this.getAutoFillElem().hide(),this.XLDragFill.hideAutoFillOptions());break;case"autoFillSettings":for(d in f)switch(d){case"fillType":e.allowAutoFill&&(e.autoFillSettings.fillType=f[d]);break;case"showFillOptions":e.allowAutoFill&&(f.showFillOptions?this._removeClass(this._getAutoFillOptElem(),"e-hide"):this.XLDragFill.hideAutoFillOptions(),e.autoFillSettings.showFillOptions=f.showFillOptions)}break;case"allowSelection":f&&t.isNullOrUndefined(this.XLSelection)&&(this.XLSelection=new t.spreadsheetFeatures.selection(this),this._initSelection());break;case"allowDragAndDrop":f&&t.isNullOrUndefined(this.XLDragDrop)&&(this.XLDragDrop=new t.spreadsheetFeatures.dragAndDrop(this));break;case"allowCellFormatting":f?((e.allowConditionalFormats||e.allowFormatAsTable)&&r.find("#"+u+"_Ribbon_home_Styles").show(),r.length&&(r.find("#"+u+"_Ribbon_home_Font").show(),r.find("#"+u+"_Ribbon_home_Number").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_TopAlign").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_MiddleAlign").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_BottomAlign").show(),r.find("#"+u+"_Ribbon_separator_Home_Alignment_BottomAlign").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignLeft").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignCenter").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignRight").show(),r.find("#"+u+"_Ribbon_separator_Home_Alignment_AlignRight").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_DecreaseIndent").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_IncreaseIndent").show(),r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_CellStyles").show(),e.allowFormatPainter&&r.find("#"+u+"_Ribbon_home_Clipboard_Home_Clipboard_FormatPainter").show(),e.allowClipboard&&r.find("#"+u+"_Ribbon_home_Clipboard").show()),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(this)),t.isNullOrUndefined(this.XLCellFrmtDlg)&&(this.XLCellFrmtDlg=new t.spreadsheetFeatures.formatCellDialog(this)),n("#"+u+"_formatdlg").length===0&&this.XLCellFrmtDlg._renderCellFrmtDlg()):r.length&&(r.find("#"+u+"_Ribbon_home_Font").hide(),r.find("#"+u+"_Ribbon_home_Number").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_TopAlign").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_MiddleAlign").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_BottomAlign").hide(),r.find("#"+u+"_Ribbon_separator_Home_Alignment_BottomAlign").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignLeft").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignCenter").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignRight").hide(),r.find("#"+u+"_Ribbon_separator_Home_Alignment_AlignRight").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_DecreaseIndent").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_IncreaseIndent").hide(),r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_CellStyles").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_Home_Clipboard_FormatPainter").hide(),e.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").hide(),e.allowConditionalFormats||e.allowFormatAsTable||r.find("#"+u+"_Ribbon_home_Styles").hide());break;case"allowImport":r.length&&(f?r.find("#open_backStageTab").show():r.find("#open_backStageTab").hide());break;case"importSettings":for(b in f)switch(c){case"importMapper":e.importSettings.importMapper=f[b];break;case"importUrl":e.importSettings.importUrl=f[b];break;case"password":e.importSettings.password=f[b]}break;case"allowSorting":var nt=document.getElementById(u+"number_MenuItem"),tt=document.getElementById(u+"string_MenuItem"),h=n("#"+u+"_Ribbon_SortFilter").data("ejMenu");if(f?(t.isNullOrUndefined(this.XLSort)&&(this.XLSort=new t.spreadsheetFeatures.sorting(this)),r.length&&(r.find("#"+u+"_Ribbon_data_SortFilter_1").show(),r.find("#"+u+"_Ribbon_data_Sort").show(),r.find("#"+u+"_Ribbon_home_Editing_1").show()),h&&h.enableItemByID("Ribbon_SortAtoZ"),h&&h.enableItemByID("Ribbon_SortZtoA")):r.length&&(r.find("#"+u+"_Ribbon_data_SortFilter_1").hide(),this.model.allowFiltering||(r.find("#"+u+"_Ribbon_data_Sort").hide(),r.find("#"+u+"_Ribbon_home_Editing_1").hide()),h&&h.disableItemByID("Ribbon_SortAtoZ"),h&&h.disableItemByID("Ribbon_SortZtoA")),this.model.allowFiltering)for(o=0;o<3;o++)t.isNullOrUndefined(nt)||(nt.childNodes[o].style.display=this.model.allowSorting?o===2?"block":"inline":"none"),t.isNullOrUndefined(tt)||(tt.childNodes[o].style.display=this.model.allowSorting?o===2?"block":"inline":"none");break;case"formatSettings":if(e.allowCellFormatting)for(a in f)switch(a){case"allowFontFamily":e.formatSettings.allowFontFamily=f[a];r.length&&(f[a]?r.find("#"+u+"_Ribbon_home_Font_Home_Font_FontFamily").show():r.find("#"+u+"_Ribbon_home_Font_Home_Font_FontFamily").hide());break;case"allowDecimalPlaces":e.formatSettings.allowDecimalPlaces=f[a];r.length&&(f[a]?(r.find("#"+u+"_Ribbon_home_Number_Home_Number_IncreaseDecimal").show(),r.find("#"+u+"_Ribbon_home_Number_Home_Number_DecreaseDecimal").show(),r.find("#"+u+"_Ribbon_separator_Home_Number_CommaStyle").show()):(r.find("#"+u+"_Ribbon_home_Number_Home_Number_IncreaseDecimal").hide(),r.find("#"+u+"_Ribbon_home_Number_Home_Number_DecreaseDecimal").hide(),r.find("#"+u+"_Ribbon_separator_Home_Number_CommaStyle").hide()));break;case"allowCellBorder":e.formatSettings.allowCellBorder=f[a];r.length&&(f[a]?(r.find("#"+u+"_Ribbon_separator_border").show(),r.find("#"+u+"_Ribbon_home_Font_Home_Font_Border").show()):(r.find("#"+u+"_Ribbon_separator_border").hide(),r.find("#"+u+"_Ribbon_home_Font_Home_Font_Border").hide()))}break;case"sheets":for(o=0,it=f.length;o<it;o++)for(rt in f[o]){if(this.model.sheetCount<o+1&&f.length>l)return;switch(rt){case"showGridlines":o+1===l?this._showGridlines(f[o].showGridlines,l):this.getSheet(o+1).showGridlines=f[o].showGridlines;break;case"showHeadings":o+1===l?this._showHeadings(f[o].showHeadings,l):this.getSheet(o+1).showHeadings=f[o].showHeadings}}break;case"scrollSettings":p={};ut=e.scrollSettings.isResponsive;t.isNullOrUndefined(i.scrollSettings)||(t.isNullOrUndefined(i.scrollSettings.allowScrolling)||(e.scrollSettings.allowScrolling=i.scrollSettings.allowScrolling),t.isNullOrUndefined(i.scrollSettings.allowVirtualScrolling)||(e.scrollSettings.allowVirtualScrolling=i.scrollSettings.allowVirtualScrolling),t.isNullOrUndefined(i.scrollSettings.isResponsive)||(ut=e.scrollSettings.isResponsive=i.scrollSettings.isResponsive),t.isNullOrUndefined(i.scrollSettings.scrollMode)||(e.scrollSettings.scrollMode=i.scrollSettings.scrollMode==="normal"?t.Spreadsheet.scrollMode.Normal:t.Spreadsheet.scrollMode.Infinite),t.isNullOrUndefined(i.scrollSettings.width)||(e.scrollSettings.width=i.scrollSettings.width),t.isNullOrUndefined(i.scrollSettings.height)||(e.scrollSettings.height=i.scrollSettings.height));e.scrollSettings.isResponsive||(n.extend(!0,p,this.model.scrollSettings),this.element.height(p.height).width(p.width),n("#"+this._id+"_Ribbon").ejRibbon("option",{width:p.width}),this._updateResponsiveSettings(),this._setSheetWidthHeight(l,{height:this._responsiveHeight,width:this._responsiveWidth}));break;case"allowFiltering":h=n("#"+u+"_Ribbon_SortFilter").data("ejMenu");f?(r.length&&(r.find("#"+u+"_Ribbon_data_SortFilter_2").show(),r.find("#"+u+"_Ribbon_data_Sort").show(),r.find("#"+u+"_Ribbon_home_Editing_1").show()),h&&h.enableItemByID("Ribbon_Filter"),t.isNullOrUndefined(this.XLFilter)&&(this.XLFilter=new t.spreadsheetFeatures.filter(this)),this.XLFilter._renderExcelFilter()):r.length&&(this.model.allowSorting||(r.find("#"+u+"_Ribbon_data_Sort").hide(),r.find("#"+u+"_Ribbon_home_Editing_1").hide()),r.find("#"+u+"_Ribbon_data_SortFilter_2").hide(),h&&h.disableItemByID("Ribbon_Filter"));break;case"allowInsert":f?(r.length&&!e.allowDelete&&r.find("#"+u+"_Ribbon_others_Cells").show(),r.length&&r.find("#"+u+"_Ribbon_others_Cells_1").show(),this.getPager().find(".e-new").removeClass("e-disable"),e.enableContextMenu&&(this.XLCMenu._enableMenuOpt(["InsertSheet","MoveorCopy"],"contextMenuFooter"),this.XLCMenu._enableMenuOpt(["Insert"],"contextMenuCell"),this.XLCMenu._enableMenuOpt(["Insert"],"contextMenuColumnHeader"),this.XLCMenu._enableMenuOpt(["Insert"],"contextMenuRowHeader"))):(r.length&&!e.allowDelete&&r.find("#"+u+"_Ribbon_others_Cells").hide(),r.length&&r.find("#"+u+"_Ribbon_others_Cells_1").hide(),this.getPager().find(".e-new").addClass("e-disable"),e.enableContextMenu&&(this.XLCMenu._disableMenuOpt(["InsertSheet","MoveorCopy"],"contextMenuFooter"),this.XLCMenu._disableMenuOpt(["Insert"],"contextMenuCell"),this.XLCMenu._disableMenuOpt(["Insert"],"contextMenuColumnHeader"),this.XLCMenu._disableMenuOpt(["Insert"],"contextMenuRowHeader")));break;case"allowDelete":f?(!e.allowInsert&&r.length&&r.find("#"+u+"_Ribbon_others_Cells").show(),r.length&&r.find("#"+u+"_Ribbon_others_Cells_2").show(),e.enableContextMenu&&this._getSheetNames(!0).length>1&&(this.XLCMenu._enableMenuOpt(["DeleteSheet"],"contextMenuFooter"),this.XLCMenu._enableMenuOpt(["Delete"],"contextMenuCell"),this.XLCMenu._enableMenuOpt(["Delete"],"contextMenuColumnHeader"),this.XLCMenu._enableMenuOpt(["Delete"],"contextMenuRowHeader"))):(!e.allowInsert&&r.length&&r.find("#"+u+"_Ribbon_others_Cells").hide(),r.length&&r.find("#"+u+"_Ribbon_others_Cells_2").hide(),e.enableContextMenu&&(this.XLCMenu._disableMenuOpt(["DeleteSheet"],"contextMenuFooter"),this.XLCMenu._disableMenuOpt(["Delete"],"contextMenuCell"),this.XLCMenu._disableMenuOpt(["Delete"],"contextMenuColumnHeader"),this.XLCMenu._disableMenuOpt(["Delete"],"contextMenuRowHeader")));break;case"allowFreezing":f?(t.isNullOrUndefined(this.XLFreeze)&&(this.XLFreeze=new t.spreadsheetFeatures.freezepane(this),this.XLFreeze._initFreeze()),r.length&&r.find("#"+u+"_Ribbon_others_Window").show()):r.length&&r.find("#"+u+"_Ribbon_others_Window").hide();break;case"allowMerging":r.length&&(f?r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_Merge").show():r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_Merge").hide());break;case"allowWrap":r.length&&(f?r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_WrapText").show():r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_WrapText").hide());break;case"allowUndoRedo":r.length&&(f?r.find("#"+u+"_Ribbon_home_Actions").show():r.find("#"+u+"_Ribbon_home_Actions").hide());break;case"frozenRows":e.allowFreezing&&this.XLFreeze.freezeRows(f);break;case"frozenColumns":e.allowFreezing&&this.XLFreeze.freezeColumns(f);break;case"freezePanes":e.allowFreezing&&this.XLFreeze.freezePanes(f.rowIndex,f.colIndex);case"allowFormatAsTable":f?(e.enablePivotTable||r.find("#"+u+"_Ribbon_insert_Tables").show(),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(this)),r.length&&(r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_FormatAsTable").show(),r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_Table").show())):r.length&&(e.enablePivotTable||r.find("#"+u+"_Ribbon_insert_Tables").hide(),r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_FormatAsTable").hide(),r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_Table").hide());break;case"enablePivotTable":r.length&&(f?(!e.allowFormatAsTable&&r.length&&r.find("#"+u+"_Ribbon_insert_Tables").show(),r.length&&r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_PivotTable").show()):(!e.allowFormatAsTable&&r.length&&r.find("#"+u+"_Ribbon_insert_Tables").hide(),r.length&&r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_PivotTable").hide()));break;case"allowAutoSum":r.length&&(f?r.find("#"+u+"_Ribbon_home_Editing_Home_Editing_AutoSum").show():r.find("#"+u+"_Ribbon_home_Editing_Home_Editing_AutoSum").hide());break;case"allowCharts":f?((t.isNullOrUndefined(this.XLChart)||t.isNullOrUndefined(this.XLShape))&&(this.XLShape=new t.spreadsheetFeatures.shape(this),this.XLChart=new t.spreadsheetFeatures.chart(this)),r.length&&r.find("#"+u+"_Ribbon_insert_Charts").show()):r.length&&r.find("#"+u+"_Ribbon_insert_Charts").hide();break;case"printSettings":for(y in f)switch(y){case"allowPrinting":e.printSettings.allowPrinting=f[y];f[y]?(this.XLPrint=new t.spreadsheetFeatures.print(this),r.length&&(r.find("#"+u+"_Ribbon_pagelayout_Print").show(),r.find("#print_backStageTab").show())):r.length&&(r.find("#print_backStageTab").hide(),r.find("#"+u+"_Ribbon_pagelayout_Print").hide());break;case"allowPageSize":e.printSettings.allowPageSize=f[y];r.length&&(f[y]?r.find("#"+u+"_Ribbon_pagelayout_PageLayout").show():r.find("#"+u+"_Ribbon_pagelayout_PageLayout").hide())}break;case"allowLockCell":r.length&&(f?(r.find("#"+u+"_Ribbon_review_Changes_Review_Changes_ProtectSheet").show(),r.find("#"+u+"_Ribbon_review_Changes_Review_Changes_LockCell").show()):(r.find("#"+u+"_Ribbon_review_Changes_Review_Changes_ProtectSheet").hide(),r.find("#"+u+"_Ribbon_review_Changes_Review_Changes_LockCell").hide()));break;case"undoRedoStep":this.undoRedoStep=f;break;case"enableTouch":this._wireTouchEvts(f?"_on":"_off");break;case"showPager":this.showPager(i[v]);this._refreshSpreadSheetPager();break;case"allowOverflow":this._refreshOverflow();break;case"allowClear":r.length&&(f?r.find("#"+u+"_Ribbon_home_Editing_Home_Editing_Clear").show():r.find("#"+u+"_Ribbon_home_Editing_Home_Editing_Clear").hide());break;case"isReadOnly":this._readOnly();break;case"locale":this.model.locale=i[v];this._destroy();this.model.sheets.splice(0,1);this.addClass(this.element[0],this._rootCSS);this._init();break;case"allowCellType":f&&(this.XLCellType=new t.spreadsheetFeatures.cellType(this));break;case"activationPanelWidth":this.model.apWidth=f;this.getActivationPanel().width(f-1);break;case"cssClass":this.element.removeClass(this._cssClass).addClass(i[v]);break;case"ribbonSettings":this.model.ribbonSettings.applicationTab.type=i.ribbonSettings.applicationTab.type;n("#"+this._id+"_Menu")[0].style.display=i.ribbonSettings.applicationTab.type==="menu"?"block":"none";this.XLRibbon._refreshBSItems(i.ribbonSettings.applicationTab.type);this.XLRibbon._menuCustomize();s.setModel({applicationTab:this.XLRibbon._appTabCollection});i.ribbonSettings.applicationTab.type==="backstage"&&(this.XLRibbon._isAppTabCreate=!1)}}r.length&&s.model&&(e.allowAutoSum||e.allowFiltering||e.allowUndoRedo||e.allowSorting||e.allowClipboard||e.allowFormatPainter||e.allowCellFormatting||e.allowMerging||e.allowWrap||e.allowConditionalFormats||e.allowFormatAsTable?s.showTab(this._getLocStr("HOME")):s.hideTab(this._getLocStr("HOME")),e.allowFormatAsTable||e.allowPictures||e.allowHyperlink||e.allowCharts?s.showTab(this._getLocStr("INSERT")):s.hideTab(this._getLocStr("INSERT")),e.allowDataValidation||e.allowFiltering||e.allowSorting?s.showTab(this._getLocStr("DATATAB")):s.hideTab(this._getLocStr("DATATAB")),e.printSettings.allowPrinting?s.showTab(this._getLocStr("PAGELAYOUT")):s.hideTab(this._getLocStr("PAGELAYOUT")),e.allowComments||e.allowLockCell?s.showTab(this._getLocStr("REVIEW")):s.hideTab(this._getLocStr("REVIEW")),e.allowFreezing||e.allowInsert||e.allowDelete||e.allowSearching?s.showTab(this._getLocStr("OTHERS")):s.hideTab(this._getLocStr("OTHERS")))},"import":function(t){var i,r,u;if(this.model.allowImport){if(i={},!t.dataContainer&&this.model.allowCellFormatting&&this.XLFormat&&this.getObjectLength(this.XLFormat._customFontFamily)>0&&(t.dataContainer=JSON.stringify({customFontFamily:this.XLFormat._customFontFamily})),t.password&&t.password.length&&(i.password=t.password),this.model.beforeImport&&this._trigger("beforeImport",i))return!1;i.password&&i.password.length&&(t.password=i.password);r=this;u={type:"POST",data:this._import(t),async:this.isUndefined(t.async)?!0:t.async,url:this.model.importSettings.importMapper,success:function(n){r.element&&r._importSuccess(n)},error:function(n,t){r._importFailed({type:t,xhr:{status:n.status,statusText:n.statusText}})}};(this._browserDetails.name!=="msie"||this._browserDetails.version!=="9.0"||u.data.append)&&(u.processData=!1,u.contentType=!1);n("#"+this._id+"_Ribbon_BackStage").hide();r.showWaitingPopUp();n.ajax(u)}},_import:function(n){if(window.FormData&&this._isObject(n)){var t,i=new FormData;for(t in n)t!="async"&&i.append(t,n[t]);return i}return n},_importSuccess:function(n){var t=["UnsupportedFile","IncorrectPassword","InvalidUrl","NeedPassword"],i;if(this._renderAlertdlg(),t.indexOf(n)>-1){switch(n){case t[0]:case t[1]:case t[2]:this._showAlertDlg("Alert",n,"",null,110);break;case t[3]:this._showDialog(this._id+"_ImportPasswordDialog");this.model.importSettings.password=""}this.hideWaitingPopUp()}else{if(i={data:n,reqType:"importing"},this._trigActionBegin(i)){this.hideWaitingPopUp();return}n=i.data;this.loadFromJSON(JSON.parse(n))}},loadFromJSON:function(t){this.isImport=!0;n("#"+this._id+"_file").ejUploadbox("option","autoUpload",!0);var i,f,r=1,o,u=t.model&&t.model.nameManager,e;if(u&&u.length)for(e in u)u[e].refersto=this._decode(u[e].refersto);if(this._isSheetReq)i=Number(this.getObjectKeys(t.dataContainer.sheets)[0]),this._refreshImpStyles(t.dataContainer.hashCode),this._impData.dataContainer=n.extend(!0,{},t.dataContainer),this._impData.dataContainer.sheets=this._dataContainer.sheets,this._impData.dataContainer.cellType=this._dataContainer.cellType,this._impData.dataContainer.sheets[i]=t.dataContainer.sheets[i],this._impData.model.sheets[i]=t.sheet,this._dataContainer=n.extend(!0,{},this._impData.dataContainer),this._dataContainer.sheetCellType={},this._refreshModel(t.sheet,!0,i),this._sheetSettings(i),this._intrnlReq||this.gotoPage(i,!1),this._isSheetReq=!1;else if(this.model.scrollSettings.allowVirtualScrolling||(f=this._getMaxRowColCnt(t.model.sheets,!0)),this.model.scrollSettings.allowVirtualScrolling||t.dataContainer.sharedData.length<50001&&f.rowCount<10001&&f.colCount<126){if(this._impData=t,o={importData:t},this._trigger("onImport",o))return;if(this._isInitLoad)this._initBase();else{for(this._destroy(),this._refreshModel(t.model),this._dataContainer=n.extend(!0,{},t.dataContainer),this._dataContainer.sheetCellType={},this._initCSSTag();r<=this.model.sheetCount;)this._sheetSettings(r),this._newSIndex++,r++;for(r=1;r<=this.model.sheetCount;)this.model.scrollSettings.allowVirtualScrolling||this.model.importSettings.allowSheetOnDemand||this._initSheet(r),r++;this._refreshNameMngr(t.model.nameManager);this.gotoPage(this.getActiveSheetIndex(),!1);this._isRibbonDestroyed=!1}this._trigger("loadComplete");this.clearUndoRedo()}else this._showAlertDlg("Alert","HugeDataAlert");this._intrnlReq||(this.isImport=!1);this._intrnlReq=!1;this._renderDDownList();this.hideWaitingPopUp();this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()},_importFailed:function(n){var t={failureType:n.type};n.xhr?(t.status=n.xhr.status,t.statusText=n.xhr.statusText):t.statusText=n.error;this.hideWaitingPopUp();this._trigger("openFailure",t)},_importSheet:function(n,t){var i={},r=this.model.importSettings;this._isSheetReq=!0;i={sheetIndex:n,allowSheetOnDemand:r.allowSheetOnDemand,password:r.password,async:t};i.dataContainer=JSON.stringify({hashCode:this._dataContainer.hashCode,sharedData:this._dataContainer.sharedData,valData:this._dataContainer.valData,cFormatData:this._dataContainer.cFormatData});this["import"](i);this.getSheet(n)._isRequested=!0},_decode:function(t){return n("<div/>").html(t).text()},_refreshModel:function(n,t,i){var u,e,r,f=1;if(n)if(t)r=this.model.sheets[this._getSheetIndex(i)],r.rowCount=n.rowCount||this.defaults.rowCount,r.colCount=n.colCount||this.defaults.colCount;else{for(this.model.sheetCount=n.sheetCount||this.defaults.sheetCount,this.model.activeSheetIndex=n.activeSheetIndex||this.defaults.activeSheetIndex,this.model.rowHeight=n.rowHeight||this.defaults.rowHeight,this.model.columnWidth=n.columnWidth||this.defaults.columnWidth,this.model.sheets=[{}],u=n.sheets.length;f<u;)r=n.sheets[f],e={rowCount:r.rowCount||this.defaults.rowCount,colCount:r.colCount||this.defaults.colCount},this.model.sheets.push(e),f++;n.nameManager&&n.nameManager.length&&(this.model.nameManager=n.nameManager)}else u=this.model.sheets.length,this.model.sheetCount<u&&(this.model.sheetCount=u);this.model.apWidth===300&&this.model.activationPanelWidth!==300?this.model.apWidth=this.model.activationPanelWidth:this.model.apWidth!==300&&this.model.activationPanelWidth===300&&(this.model.activationPanelWidth=this.model.apWidth)},_refreshImpStyles:function(n){for(var r,t,i=0,u=n.length;i<u;)t=n[i],this._dataContainer.hashCode.indexOf(t)===-1&&(t.indexOf("e-format")===-1?(this._dataContainer.hashCode.push(t),t.length<25&&this.XLFormat._writeCssRules(t,this.XLFormat._getCssPropertyAsString({border:this.XLFormat.getBorderFromHashCode(t)}))):(r=this.XLFormat.getFormatFromHashCode(t),this.XLFormat._createFormatClass(r))),i++},_refreshImpSheets:function(t){var i=this._impData.model.sheets[t];this._refreshImpCells(t);this._refreshImpCF(t);this.model.allowMerging&&i.mergedCells&&this._refreshImpMC(i.mergedCells);this.model.allowFiltering&&i.filterSettings&&i.filterSettings.range&&this.XLFilter._filterCellRange(t,i.filterSettings.range);this._refreshImpHC(i.hideColsCollection);this._refreshImpHR(i.hideRowsCollection);this._refreshImpTable(i.tableManager);this._refreshOverflow();this.model.allowCellType&&this._refreshSheetCellTypes(this._impData.dataContainer.sheetCellType,t);this._refreshShapePosOnImp(i.shapeMngr,t);this._refreshImpCharts(i.shapeMngr.chart);this._refreshImpPics(i.shapeMngr,t);this._refreshImpPvts(i.pivotMngr,t);i.showGridlines===!1&&n("#"+this._id+"_Ribbon_PageLayout_Show_Gridlines").ejCheckBox({checked:i.showGridlines});i.isSheetProtected&&this.protectSheet(!0)},_refreshImpCells:function(n){for(var t,i=0,u=this.getSheet(n).usedRange,r=this.XLEdit._getPropWithCellIdx([0,0,u.rowIndex,u.colIndex],"value",n,!0),f=r.length;i<f;)t=r[i],this.XLEdit._refreshCalcEngine(t.rowIdx,t.colIdx,!0,t.value,n),i++;if(this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder)for(i=0,r=this.XLEdit._getPropWithCellIdx([0,0,u.rowIndex,u.colIndex],"borders",n),f=r.length;i<f;)t=r[i],this.XLFormat.applyBorder(t.value,[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]),i++},_refreshSheetCellTypes:function(n,t){var r=[],i,u;if(!(this.getObjectLength(n)<1)){for(i=1,u=this.getObjectLength(n[t]);i<=u;i++)r.push({range:n[t][i].settings.range,settings:n[t][i].settings});this.XLCellType._rangeCellTypes(r,t,!0)}},_refreshImpCF:function(n){if(this.model.allowConditionalFormats)for(var t,r,u=this._impData.dataContainer.cFormatData.length,i=0;i<u;i++)t=this._impData.dataContainer.cFormatData[i].split("_"),r=Number(t[4]),r===n&&(this.XLCFormat._cFormat(t[0],t[1],t[2],t[3],t[5],r,this.getRangeIndices(t[5])),this._impData.dataContainer.cFormatData.splice(i,1),u=this._impData.dataContainer.cFormatData.length,i--)},_refreshImpMC:function(n){var t,i=n.length;if(i)while(i--)t=n[i],t.isCenterAlign&&(this.mergeCenter=!0),this.mergeCells(t.range,!0),this.mergeCenter=!1},_refreshImpHC:function(n){var t,r=this.getObjectKeys(n),i=r.length;if(i)while(i--)t=parseInt(r[i]),this._hideColumn(t,t)},_refreshImpResRowHght:function(n){for(var o,f,c,t,u,l,e,s=this.getSheet(n),p=s._restrictedHeightRows,b=this._dataContainer.sheets[n],k=this._dataContainer.hashCode,i,a,v=!0,w=this._impData&&this._impData.model.sheets[n]&&this._impData.model.sheets[n].mergedCells?this._impData.model.sheets[n].mergedCells:[],y=[],h,r=0;r<w.length;r++)i=this.getRangeIndices(w[r].range),y.push(i);for(f=this.element.find("#"+this._id+"_emptyDiv"),o=0;o<p.length;o++){u=p[o];e=b[u];for(t in e)if((h=this._dataContainer.sharedData[e[t].value],h&&!this.isFormula(h))&&(l=e[t].formats,l)){if(c=k[l],e[t].wrap){for(r in y)if(i=y[r],i[0]<=u&&i[2]>=u&&i[1]<=t&&i[3]>=t){v=!1;break}v&&(f.width(s.columnsWidthCollection[t]-3),c+=" e-sswraptext")}this.addClass(f[0],c);f.text(h);a=f[0].offsetHeight+1;s.rowsHeightCollection[u]<a&&(s.rowsHeightCollection[u]=a);this._refreshGlobalSpan(null,!0);v=!0}}},_refreshImpHR:function(n){for(var t,i,u=this.getActiveSheetIndex(),s=this.getSheet(u),n=n||[],f=this.getRows(u),h=f[1],c=f[0],e=this._getJSSheetRowHeaderContent(u),l=e.find("tr"),r=0,o=n.length;r<o;r++)t=parseInt(n[r]),i=t?t-1:0,this.isUndefined(this.XLEdit.getPropertyValue(i,0,"isRHide"))&&this.XLEdit._updateDataContainer({rowIndex:i,colIndex:0},{dataObj:{hRow:!0}}),this.model.scrollSettings.allowVirtualScrolling?this.addClass(e.find("[idx ="+i+"] .e-rowheader")[0],"e-hrow"):(this.addClass(l.find(".e-rowheader")[i],"e-hrow"),this.addClass(h[t],"e-r-hide"),this.addClass(c[t],"e-r-hide")),this.XLScroll._getRowHeights(u,s.hideRowsCollection.sort()[0])},_refreshImpTable:function(n){var i,r,t,u=this.getObjectLength(n);if(this.model.allowFormatAsTable&&u)while(u--)t=n[u],i=t.range,r=this.XLFormat._getTableLayoutFromName(t.formatName),r||(r=this.XLFormat._formatAsTableStyle,t.formatName=r.formatName),this.XLFormat.createTable({header:!0,name:"Table"+this._tableCnt,format:r.format,formatName:t.formatName,showHeaderRow:t.showHeaderRow},this._getAlphaRange(this.getActiveSheetIndex(),i[0],i[1],i[2],i[3]))},_refreshImpCharts:function(n){if(this.model.allowCharts)for(var i,t,r=0,u=this.getObjectLength(n);r<u;)t=n["chart"+r],i=this.getSheet(t.dataSheetIdx),t.dataSheetIdx!=this.getActiveSheetIndex()&&i._isImported&&!i._isRequested&&(this._intrnlReq=!0,this._importSheet(t.dataSheetIdx,!1)),this.XLChart.createChart(t.series?null:t.range,{type:t.commonSeriesOptions.type,enable3D:t.enable3D,marker:t.commonSeriesOptions.marker,top:t.top,left:t.left,height:t.size.height,width:t.size.width,title:t.title,legend:t.legend,primaryYAxis:t.primaryYAxis,primaryXAxis:t.primaryXAxis,dataSheetIdx:t.dataSheetIdx,series:t.series,seriesRange:t.seriesRange,isRowColSwitched:t.isRowColSwitched}),r++},_refreshImpPics:function(n,t){if(this.model.pictureSettings.allowPictures)for(var i,r=0,u=this.getObjectKeys(n.picture),f=u.length;r<f;)i=n.picture[u[r]],i.sheetIdx=t,this.getSheet(t)._isUpdated?(i.imgData=n.sharedPics[i.data],this.XLShape._refreshPictureElement(i)):this.XLShape._createPicture(t,null,n.sharedPics[i.data],i.top,i.left,i.width,i.height,null,i.bcolor,i.bstyle,i.bwidth,i),r++},_refreshShapePosOnImp:function(n,t){var f=n.chart,e=n.picture,i,o,r,s,u,c=this.getSheet(t),a=c._rowHeightCollection,l=c.rowsHeightCollection,h=this._impData?this._impData.model.sheets[t].rowsHeightCollection:[];if(!this.getObjectLength(e)&&!this.getObjectLength(f))return!1;for(i=0;i<h.length;i++)if(h[i]!==l[i]){o=l[i]-h[i];s=a[i+1]-o;for(r in e)u=e[r].top,u>s&&(e[r].top=u+o);for(r in f)u=f[r].top,u>s&&(f[r].top=u+o)}},_refreshImpPvts:function(n,t){if(this.model.enablePivotTable&&n)for(var i,r=0,e=this.getObjectLength(n.pivot),u=this.getObjectKeys(n.pivot),f;r<e;)i=n.pivot[u[r]],f={rows:i.rows,columns:i.columns,values:i.values,filters:i.filters},this.getSheet(t)._isUpdated?this.XLPivot._refreshPivotElement(i.dataSheetName+"!"+this._getProperAlphaRange(this._getSheetIndexByName(i.dataSheetName),i.dataRange[0],i.dataRange[1],i.dataRange[2],i.dataRange[3]),this.getSheet(i.sheetIdx).sheetInfo.text+"!"+this._getProperAlphaRange(i.sheetIdx,i.rowIndex,i.colIndex,i.rowIndex,i.colIndex),u[r],f,i):this.XLPivot.createPivotTable(i.dataSheetName+"!"+this._getProperAlphaRange(this._getSheetIndexByName(i.dataSheetName),i.dataRange[0],i.dataRange[1],i.dataRange[2],i.dataRange[3]),this.getSheet(i.sheetIdx).sheetInfo.text+"!"+this._getProperAlphaRange(i.sheetIdx,i.rowIndex,i.colIndex,i.rowIndex,i.colIndex),u[r],f,i),r++;this._isExport||this._getContent(t).find(".e-ss-activepivot").removeClass("e-ss-activepivot");this.hideActivationPanel()},_refreshNameMngr:function(n){n=n||this.model.nameManager;var t=n.length;if(this.model.showRibbon){if(t)while(t--)this.XLRibbon._updateNamedRanges(n[t].name,n[t].refersto,!0);this.XLRibbon._updateUseInFormulaTrgt()}this.model.nameManager=n;this.XLEdit._refreshAutoComplete()},_getBorderInput:function(n){n=n.split("_");for(var t=4,i={},r=["top","right","bottom","left"];t--;)n[t].length&&(i[r[t]]=n[t]);return i},_refreshHashCode:function(n){n=n||this._dataContainer.hashCode;for(var t,i=n.length;i--;)t=n[i],t.indexOf("e-format")===-1&&t.indexOf("e-border")===-1&&(n[i]="")},clearUndoRedo:function(){this._undoCollection=[];this._redoCollection=[];this._updateUndoRedoIcons()},_initializePicture:function(n){this._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content").append(t.buildTag("div.e-ss-imgvisual"))},_getShapePositionInManager:function(n,t,i,r){for(var o=this.getActiveSheetIndex(),f=this._dataContainer.sheets[o][n][t],u=0,e=f.length;u<e;u++)if(f[r][u].id===i)break;return u},_swapVal:function(n){var t=n.prev;n.prev=n.cur;n.cur=t},_getValue:function(n,t){for(var i,r=n.length;r--;)if(i=n[r],i.value===t)return i.value},_isRowViewable:function(n,t){var i=this.getSheet(n),r=i._isVPRendered;return this.model.scrollSettings.allowVirtualScrolling&&(r=i._virtualRowIdx.indexOf(t)>-1),r},_isColumnViewable:function(){return!0},_undoRedoOperation:function(t){var r,u,i=this.getActiveCell();(t.which===90||t.keyCode===90)&&t.ctrlKey?(t.preventDefault(),t.target.id.indexOf("_Edit")>-1||t.target.id.indexOf("_input")>-1?(r=this.XLEdit.getCurrentEditCellData(),r!==this._cureditedCell&&(u=r,t.target.id.indexOf("_Edit")>-1?t.target.textContent=this._cureditedCell:n("#"+this._id+"_Edit")[0].textContent=this._cureditedCell,this.model.allowFormulaBar&&this._getInputBox().val(this._cureditedCell),this._undoInputobj={value:u,rowIndex:i.rowIndex,colIndex:i.colIndex})):(this._isUndo=!0,this._performUndoRedo())):(t.which===89||t.keyCode===89)&&t.ctrlKey&&(t.preventDefault(),t.target.id.indexOf("_Edit")>-1||t.target.id.indexOf("_input")>-1?i.rowIndex===this._undoInputobj.rowIndex&&i.colIndex===this._undoInputobj.colIndex&&(t.target.id.indexOf("_Edit")>-1?t.target.textContent=this._undoInputobj.value:n("#"+this._id+"_Edit")[0].textContent=this._undoInputobj.value,this.model.allowFormulaBar&&this._getInputBox().val(this._undoInputobj.value)):(this._isUndo=!1,this._performUndoRedo()))},_performUndoRedo:function(){var n=this._isUndo?this._undoCollection.pop():this._redoCollection.pop(),i,r;if(!t.isNullOrUndefined(n)){n.sheetIndex!==this.getActiveSheetIndex()&&this.gotoPage(n.sheetIndex,null);this._isUndoRedo=!0;switch(n.reqType){case"auto-fill":this._undoForAutoFill(n);break;case"auto-sum":this._undoForAutoSum(n);break;case"cell-format":this._undoForFormat(n);break;case"cell-styles":this._undoForStyle(n);break;case"clear-all":this._undoForClAll(n);break;case"clear-comment":this._undoForClComment(n);break;case"clear-content":this._undoForClContent(n);break;case"clear-format":this._undoForClFormat(n);break;case"clear-link":this._undoForCLLink(n);break;case"comment":this._undoForComment(n);break;case"cond-format":this._undoForCondFormat(n);break;case"copy-paste":this._undoForCopyPaste(n);break;case"cut-paste":this._undoForCutPaste(n);break;case"delete":this._undoForDel(n);break;case"edit":this._undoForEdit(n);break;case"filter":this._undoForFilter(n);break;case"filterbycolor":this._undoForFilterByColor(n);break;case"find-replace":this._undoForFind(n);break;case"format-painter":this._undoForFormatPaint(n);break;case"format-table":this._undoForFormatTable(n);break;case"hyperlink":this._undoForHyperlink(n);break;case"insert":this._undoForIns(n);break;case"merge-cells":this._undoForMerge(n);break;case"paging":r=n.nSheetIndex;n.nSheetIndex=n.sheetIndex;n.sheetIndex=r;break;case"pivotgrid":this._undoForPivot(n);break;case"resize-column":this._undoForResizeCol(n);break;case"resize-row":this._undoForResizeRow(n);break;case"resize-fit-height":this._undoForResizeFHeight(n);break;case"resize-fit-width":this._undoForResizeFWidth(n);break;case"reorder-cells":this._undoForReOrder(n);break;case"show-hide":this._undoForShowHide(n);break;case"shape":this._undoForShape(n);break;case"sort":this._undoForSort(n);break;case"sortbycolor":this._undoForSortByColor(n);break;case"textwrap":this._undoForTextWrap(n);break;case"validation":this._undoForValidation(n)}if(this._isUndo?this._redoCollection.push(n):this._undoCollection.push(n),i={sheetIdx:n.sheetIndex,reqType:this._isUndo?"undo":"redo",operation:n},this._undoCollection.length>this.undoRedoStep&&this._undoCollection.splice(0,1),this._redoCollection.length>this.undoRedoStep&&this._redoCollection.splice(0,1),this._updateUndoRedoIcons(),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),this._isUndoRedo=!1,this._isUndo=!1,this.model.allowSelection&&n.reqType!="shape"&&this.XLSelection._refreshBorder(),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),this._trigActionComplete(i))return}},_undoForAutoFill:function(t){var r=this.getSheet(t.sheetIndex),i;if(this._isUndo){if(this.clearRangeData(t.range,this._cellProp),this.model.allowCellFormatting)for(this.XLFormat.removeStyle(t.range),this.XLFormat.updateFormat(t.bFormat,t.range),i=t.range[0];i<=t.range[2];i++)this.XLResize.setRowHeight(i,t.bHeight[i]);this.updateData(n.extend(!0,[],t.bData),t.range);t.actionType=="flash-fill"&&this.updateData(n.extend(!0,[],t.bdData),t.bRange);t.colSel?this.XLSelection.selectColumns(r._startCell.colIndex,r._endCell.colIndex):t.rowSel?this.XLSelection.selectRows(r._startCell.rowIndex,r._endCell.rowIndex):this.performSelection({rowIndex:t.bRange[0],colIndex:t.bRange[1]},{rowIndex:t.bRange[2],colIndex:t.bRange[3]})}else{for(this.model.allowCellFormatting&&(this.XLFormat.removeStyle(t.range),this.XLFormat.updateFormat(t.aFormat,t.range)),this.updateData(n.extend(!0,[],t.aData),t.range),this.XLCFormat.refreshCFormat(),t.actionType=="flash-fill"&&this.updateData(n.extend(!0,[],t.adData),t.bRange),i=t.range[0];i<=t.range[2];i++)this.XLResize.setRowHeight(i,t.aHeight[i]);this.performSelection({rowIndex:t.bRange[0],colIndex:t.bRange[1]},{rowIndex:t.range[2],colIndex:t.range[3]})}},_undoForAutoSum:function(t){var e=this._dataContainer.sheets[t.sheetIndex],r,u,i,f;if(this._isUndo){for(i=0,f=t.updCell.length;i<f;i++)r=this.getCell(t.updCell[i].rowIndex,t.updCell[i].colIndex,t.sheetIndex),this._clearFormula(t.updCell[i].rowIndex,t.updCell[i].colIndex),this.clearRangeData([t.updCell[i].rowIndex,t.updCell[i].colIndex,t.updCell[i].rowIndex,t.updCell[i].colIndex],["value2"],null,!0),u=n.extend(!0,{},t.updCell[i].pObj),e[t.updCell[i].rowIndex][t.updCell[i].colIndex]=u,r.text(t.updCell[i].pValue);this.performSelection(t.range)}else this.XLRibbon.autoSum(t.oprType,t.range)},_undoForClAll:function(t){var u=this.model.sheets[t.sheetIndex],i,r;if(this._isPaste=this._dupDetails=!0,this._isUndo){for(this.updateData(n.extend(!0,[],t.bData),t.range),this.XLFormat.updateFormat(n.extend(!0,[],t.bBorder),t.range),i=0,r=t.wrapColl.length;i<r;i++)this.setWrapText("wrap",[t.wrapColl[i].rowIdx,t.wrapColl[i].colIdx,t.wrapColl[i].rowIdx,t.wrapColl[i].colIdx]);for(i=0,r=t.mergeColl.length;i<r;i++)this.mergeCenter=t.mergeColl[i].mergeObj.isCenterAlign,this.mergeCells(t.mergeColl[i].mergeObj.mRange,!0)}else this.model.showRibbon&&this.XLRibbon._isMergeSelect&&this.XLRibbon._isFilterSelect.status?(this.clearRangeData(t.range,["value","value2","hyperlink","cFormatRule","comment"],"",!1),this.XLFormat.removeStyle(null,{cellStyle:!0,format:!0})):this.clearRangeData(t.range,["value","value2","format","formats","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","comment","cFormatRule","border"]),this.setWrapText("unwrap",t.range),this.unmergeCells(t.range);this._isPaste=this._dupDetails=!1;t.tblObj&&(this._isUndo?(this.XLClipboard._isCut=!0,this.XLFormat.createTable(t.tblObj,t.tblObj.range),this.XLClipboard._isCut=!1):(this.XLFormat.removeTable(t.tblObj.tblId),this.clearRangeData(t.range,["value","value2","format","formats","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","comment","cFormatRule"]),this.XLFormat.removeStyle(t.range,{cellStyle:!0,tableStyle:!0,format:!0,border:!0}),this.XLRibbon._toggleDesignTab(this.getActiveCell())));this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t.range);this.model.allowDataValidation&&!this._isUndo&&this.XLValidate.clearDV();this.model.allowFormulaBar&&this.updateFormulaBar()},_undoForClComment:function(n){var r,u,f,t,e;if(n.selectedCell.length){if(u={rowIndex:n.selectedCell[0].rowIndex,colIndex:n.selectedCell[0].colIndex},f={rowIndex:n.selectedCell[n.selectedCell.length-1].rowIndex,colIndex:n.selectedCell[n.selectedCell.length-1].colIndex},this._isUndo)for(t=0,e=n.selectedCell.length;t<e;t++)r={rowIndex:n.selectedCell[t].rowIndex,colIndex:n.selectedCell[t].colIndex},this.XLEdit._updateDataContainer({rowIndex:n.selectedCell[t].rowIndex,colIndex:n.selectedCell[t].colIndex},{dataObj:{comment:n.selectedCell[t].prevComment}}),this.XLSelection.selectRange(r,r),this.XLComment.setComment(),this.XLComment._updateCurCmntVal();else this.XLSelection.selectRange(u,f),this.XLComment.deleteComment(i,null,!1,"clear");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()}},_undoForClContent:function(t){this._isUndo?this.updateData(n.extend(!0,[],t.bData),t.range):this.clearRangeData(t.range,["value","value2","type","hyperlink"],t.reqType);this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t.range);this.model.allowFormulaBar&&this.updateFormulaBar()},_undoForClFormat:function(t){var u=this._dataContainer.sheets[t.sheetIndex],i,r;if(this._isUndo){for(i=0,r=t.wrapColl.length;i<r;i++)this.setWrapText("wrap",[t.wrapColl[i].rowIdx,t.wrapColl[i].colIdx,t.wrapColl[i].rowIdx,t.wrapColl[i].colIdx]);for(i=0,r=t.mergeColl.length;i<r;i++)this.mergeCenter=t.mergeColl[i].mergeObj.isCenterAlign,this.mergeCells(t.mergeColl[i].mergeObj.mRange,!0);this.updateData(n.extend(!0,[],t.bData),t.range,t.reqType)}else this.XLRibbon._isMergeSelect&&this.XLRibbon._isFilterSelect.status?(this.clearRangeData(t.range,["decimalPlaces","thousandSeparator","hyperlink","cFormatRule"],"",!1,details.reqType),this.XLFormat.removeStyle(null,{cellStyle:!0,format:!0})):this.clearRangeData(t.range,["format","formats","border","type","formatstr","decimalPlaces","thousandSeparator","hyperlink","cFormatRule"],"",!1,t.reqType),this.setWrapText("unwrap",t.range),this.unmergeCells(t.range);this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t.range)},_undoForCLLink:function(n){var f={rowIndex:n.selectedCell[0].rowIndex,colIndex:n.selectedCell[0].colIndex},e,u,o={rowIndex:n.selectedCell[n.selectedCell.length-1].rowIndex,colIndex:n.selectedCell[n.selectedCell.length-1].colIndex},i,r;if(this.setActiveCell(n.selectedCell[0].rowIndex,n.selectedCell[0].colIndex),this.XLSelection.selectRange(f,o),this._isUndo)for(i=0,r=n.selectedCell.length;i<r;i++)n.selectedCell[i].prevLink&&(u=this.getCell(n.selectedCell[i].rowIndex,n.selectedCell[i].colIndex),n.selectedCell[i].prevLink.webAddr?u.html(t.buildTag("a.e-hyperlinks",n.selectedCell[i].prevText,"",{href:n.selectedCell[i].prevLink.webAddr,target:"_blank"})):u.html(t.buildTag("a.e-hyperlinks",n.selectedCell[i].prevText,"")),this.isUndefined(n.selectedCell[i].prevLink.cellAddr)?this.XLEdit._updateDataContainer({rowIndex:n.selectedCell[i].rowIndex,colIndex:n.selectedCell[i].colIndex},{dataObj:{hyperlink:{webAddr:n.selectedCell[i].prevLink.webAddr}}}):this.XLEdit._updateDataContainer({rowIndex:n.selectedCell[i].rowIndex,colIndex:n.selectedCell[i].colIndex},{dataObj:{hyperlink:{cellAddr:n.selectedCell[i].prevLink.cellAddr}}}));else this._removeHyperlink("clear",n.selectedCell);for(this.XLSelection.selectRange(f,o),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),i=0,r=n.selectedCell.length;i<r;i++)e=n.selectedCell[i].prevLink,n.selectedCell[i].prevLink=n.selectedCell[i].curLink,n.selectedCell[i].curLink=e},_undoForComment:function(n){var t,u,f,r,i,e;for(u={rowIndex:n.selectedCell[0].rowIndex,colIndex:n.selectedCell[0].colIndex},f={rowIndex:n.selectedCell[n.selectedCell.length-1].rowIndex,colIndex:n.selectedCell[n.selectedCell.length-1].colIndex},i=0,e=n.selectedCell.length;i<e;i++)t={rowIndex:n.selectedCell[i].rowIndex,colIndex:n.selectedCell[i].colIndex},this.XLSelection.selectRange(t,t),this.getSheet(n.sheetIndex)._startCell=t,n.action==="add"?(n.selectedCell[i].prevComment=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"comment"),this.XLComment&&this.XLComment.deleteComment()):n.action==="edit"?(this._isRowViewable(n.sheetIndex,t.rowIndex)&&this.getCell(t.rowIndex,t.colIndex).find(".e-comment-txtarea").val(n.selectedCell[i].prevComment.value),this.XLComment._updateCurCmntVal(),r=n.selectedCell[i].prevComment,n.selectedCell[i].prevComment=n.selectedCell[i].curComment,n.selectedCell[i].curComment=r):(this.XLEdit._updateDataContainer(t,{dataObj:{comment:n.selectedCell[i].prevComment}}),this.XLComment.setComment([t.rowIndex,t.colIndex,t.rowIndex,t.colIndex],null,!1),this.XLSelection.selectRange(t,t),this.XLComment._updateCurCmntVal(),r=n.selectedCell[i].prevComment,n.selectedCell[i].prevComment=n.selectedCell[i].curComment,n.selectedCell[i].curComment=r);n.action==="add"?n.action="delete":n.action==="delete"&&(n.action="add");this.XLSelection.selectRange(u,f);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForCondFormat:function(n){var i,e,l,s,c,r,o=[],h,a,u,f,v;if(n.range=n.data,this._isUndo){if(n.action==="add"){for(u=this._getSelectedRange({rowIndex:n.range[0],colIndex:n.range[1]},{rowIndex:n.range[2],colIndex:n.range[3]}),c=this.XLEdit.getPropertyValue(u[0].rowIndex,u[0].colIndex,"cFormatRule"),n.poppedRule=c[c.length-1],i=0,e=u.length;i<e;i++){if(h=this.XLEdit.getPropertyValue(u[i].rowIndex,u[i].colIndex,"cFormatRule"),!this.isUndefined(h))for(h.pop(),f=0,l=h.length;f<l;f++)s=h[f],o.length===0?(r=s.indexOf("true")>-1?s.replace("_true",""):s.replace("_false",""),o.push(r)):o=this._addCondFormatRule(o,s);this._isRowViewable(n.sheetIndex,u[i].rowIndex)&&(a=this.getCell(u[i].rowIndex,u[i].colIndex,n.sheetIndex),a.removeClass("e-redft e-yellowft e-greenft e-redf e-redt"))}for(this.clearRangeData(n.range,["cFormatRule"],u),i=0,e=o.length;i<e;i++)r=o[i].split("_"),this.XLCFormat._cFormat(r[0],r[2],r[3],r[4],r[5],n.sheetIndex,n.range)}else if(n.action==="clear")for(i=0,e=n.rule.length;i<e;i++)for(f=0,v=n.rule[i].length;f<v;f++)this.XLCFormat.setCFRule(n.rule[i][f])}else n.action==="add"?t.isNullOrUndefined(n.poppedRule)||(r=n.poppedRule.split("_"),this.XLCFormat._cFormat(r[0],r[2],r[3],r[4],r[5],n.sheetIndex,n.range)):n.action==="clear"&&(n.selection?this.XLCFormat.clearCF(n.range):this.XLCFormat.clearCF())},_getCopyText:function(n){for(var i,u,e=[],r,t=0,f=n.length;t<f;t++)for(r=n[t].split("\t"),i=0,u=r.length;i<u;i++)e.push(r[i]);return e},_cutShape:function(t,i,r,u){for(var o,h,e=["picture","chart"],s,f=0,c=e.length;f<c;f++)if(e[f]in t)for(this.XLShape._picCellIdx={rowIndex:i.rowIndex,colIndex:i.colIndex},o=0,h=t[e[f]].length;o<h;o++)s=n.extend(!0,{},r[e[f]][t[e[f]][o]]),this.XLShape._deleteShape(u,this.element.find("#"+s.id))},_pasteShape:function(t,i,r,u){for(var h,l,s=["picture","chart"],f,e,c,o=0,a=s.length;o<a;o++)if(s[o]in t){for(h=0,l=t.picture.length;h<l;h++)f=n.extend(!0,{},r[s[o]][t[s[o]][h]]),this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,s[o]==="picture"?(c=this._id+"_picture",this.XLShape._createPicture(u,{rowIndex:i.rowIndex,colIndex:i.colIndex},r.sharedPics[f.data],f.top,f.left,f.width,f.height,parseInt(f.id.replace(c,"")))):(e=f.range,this.XLChart.createChart(this._getAlphaRange(u,e[0],e[1],e[2],e[3]),f));s[o]==="chart"&&this.XLSelection.selectRange({rowIndex:e[0],colIndex:e[1]},{rowIndex:e[2],colIndex:e[3]},pSheetIndex)}},_undoForCopyPaste:function(i){var u={},e=this._dataContainer,k,l=this.getSheet(i.pSheetIndex).shapeMngr,f,tt,h,s,d;if(i.operation==="shape")k=i.pShapeId.indexOf("picture")>-1?"picture":"chart",f=n.extend(!0,{},i.pasteCell.obj),t.isNullOrUndefined(f)||(this.XLShape._picCellIdx={rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},k==="chart"?"chart"in f&&(this._isUndo?(u=n.extend(!0,{},l.chart[i.pShapeId]),t.isNullOrUndefined(e.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(e.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),e.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=f,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+u.id))):(this.setActiveCell(i.pasteCell.rowIndex,i.pasteCell.colIndex,i.pSheetIndex),u=n.extend(!0,{},i.pasteCell.shapeObj),u.isChartSeries?this.XLChart.createChart(null,u):(o=u.range,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,o[0],o[1],o[2],o[3]),u),this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.cSheetIndex)))):"picture"in f&&(this._isUndo?(u=n.extend(!0,{},l.picture[i.pShapeId]),t.isNullOrUndefined(e.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(e.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),e.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=f,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+u.id))):(u=n.extend(!0,{},i.pasteCell.shapeObj),it=this._id+"_picture",this.XLShape._createPicture(i.pSheetIndex,{rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},l.sharedPics[u.data],u.top,u.left,u.width,u.height,parseInt(u.id.replace(it,"")),u.bcolor,u.bstyle,u.bwidth)))),this.XLScroll._getRowHeights(i.pSheetIndex,i.pasteCell.rowIndex);else{var a,s,g,d,v,c,nt,tt,o,y,p,it,w,b,r,rt=!1,ut=[],e=this._dataContainer;for(this._getCopyText(i.text),this._dupDetails=!0,this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),this.setActiveSheetIndex(i.pSheetIndex),a=0,g=i.pasteCells.length;a<g;a++)r=i.pasteCells[a],f=t.isNullOrUndefined(e.sheets[i.pSheetIndex][r.rowIndex])?{}:e.sheets[i.pSheetIndex][r.rowIndex][r.colIndex],this._isUndo||"merge"in r.prevObj&&(this.mergeCenter=r.prevObj.merge.isCenterAlign,this.mergeCells(r.prevObj.merge.mRange,!0)),this._isRowViewable(i.pSheetIndex,r.rowIndex)&&(v=this.getCell(r.rowIndex,r.colIndex,i.pSheetIndex)[0],this._isUndo||(v.textContent=ut[a]),rt=!0),t.isNullOrUndefined(f)||(this._cutShape(f,r,l,i.pSheetIndex),c=this._generateHeaderText(r.colIndex+1)+(r.rowIndex+1),"wrap"in f&&this.setWrapText("unwrap",c+":"+c),"merge"in f&&this._isUndo&&(r.newObj=n.extend(!0,{},e.sheets[i.pSheetIndex][r.rowIndex][r.colIndex]),this.unmergeCells(this._getAlphaRange(i.pSheetIndex,r.rowIndex,r.colIndex,r.rowIndex,r.colIndex)),this.getCell(r.rowIndex,r.colIndex,i.pSheetIndex).prop("rowspan",!1).prop("colspan",!1),"merge"in r.prevObj&&(this.mergeCenter=r.prevObj.merge.isCenterAlign,this.mergeCells(r.prevObj.merge.mRange,!0),this.mergeCenter=!1))),rt&&this._isUndo&&(v.textContent="",this._removeClass(v,"e-commentcell")),t.isNullOrUndefined(e.sheets[i.pSheetIndex][r.rowIndex])&&(e.sheets[i.pSheetIndex][r.rowIndex]={}),t.isNullOrUndefined(e.sheets[i.pSheetIndex][r.rowIndex][r.colIndex])||(w=e.sheets[i.pSheetIndex][r.rowIndex][r.colIndex].overflow),this.model.allowCellFormatting&&this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0,border:!0}),e.sheets[i.pSheetIndex][r.rowIndex][r.colIndex]=n.extend(!0,{},r.prevObj),w&&(e.sheets[i.pSheetIndex][r.rowIndex][r.colIndex].overflow=w),this._textClip(r.rowIndex,r.colIndex,"delete"),this._setRowHdrHeight(i.pSheetIndex,r.rowIndex),f=t.isNullOrUndefined(e.sheets[i.pSheetIndex][r.rowIndex])?{}:e.sheets[i.pSheetIndex][r.rowIndex][r.colIndex],y=r.rowIndex,p=r.colIndex,this._applyCommentLink(f,{rowIndex:r.rowIndex,colIndex:r.colIndex},y,p),this._isPaste=!0,t.isNullOrUndefined(f)||(this._pasteShape(f,{rowIndex:y,colIndex:p},l,i.pSheetIndex),"cellType"in f&&(this._isUndo?this._removeClass(v,"e-cellreadonly"):(b=this._dataContainer.sheetCellType[f.cellType],b.text="",this.model.allowCellType&&this.XLCellType._renderControls(r.rowIndex,r.colIndex,i.pSheetIndex,b,!0))),c=this._generateHeaderText(r.colIndex+1)+(r.rowIndex+1),"wrap"in f&&(this.XLEdit._clearDataContainer({cellIdx:r,property:["wrap"]}),this.setWrapText("wrap",c+":"+c)),this._isPaste=!1),nt=r.prevObj,r.prevObj=r.newObj,r.newObj=nt;if(i.isSpecial&&(this.model.allowCellFormatting&&(this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),this.isUndefined(i.pasteBorder.prevBorder)||this.XLFormat.updateFormat(i.pasteBorder.prevBorder,i.pasteBorder.range,"format")),tt=i.pasteBorder.prevBorder,i.pasteBorder.prevBorder=i.pasteBorder.newBorder,i.pasteBorder.newBorder=tt),!t.isNullOrUndefined(i.pfat))for(h=i.pfat.ptable,s=0,d=h.length;s<d;s++)t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this._isUndo?(this.XLFormat.removeTable(h[s].id),this.XLFormat.removeStyle(h[s].range)):(h[s].header=!0,this.XLFormat.createTable(h[s],h[s].range)));t.isNullOrUndefined(i.filter)||(this.XLFilter.clearFilter(),this.XLFilter.filter(details.filter));this._dupDetails=!1}i.operation!=="shape"&&(this._isUndo?(t.isNullOrUndefined(i.cSheetIndex)||this.setActiveSheetIndex(i.cSheetIndex),i.cutCells.length>0&&this.XLSelection._focusBorder(i.cutCells[0],i.cutCells[i.cutCells.length-1],this._cutFocus),this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])):(t.isNullOrUndefined(i.cSheetIndex)||this.setActiveSheetIndex(i.cSheetIndex),i.cutCells.length>0&&this.XLSelection._focusBorder(i.cutCells[0],i.cutCells[i.cutCells.length-1],this._cutFocus),this.setActiveSheetIndex(i.pSheetIndex),i.pasteCells.length>0&&this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),this.XLScroll._getRowHeights(i.pSheetIndex,i.pasteCells[0].rowIndex))},_undoForCutPaste:function(i){var u,y,k,o={},e=this._dataContainer,p=this.getSheet(i.pSheetIndex).shapeMngr,et,rt,bt,g,ot,st,ht,nt,v,h,d,f,c,a,ct,lt,ut,r,s,ft,yt,pt,wt;if(i.operation==="shape")g=i.pShapeId.indexOf("picture")>-1?"picture":"chart",u=n.extend(!0,{},i.pasteCell.obj),t.isNullOrUndefined(u)||(this.XLShape._picCellIdx={rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},o=n.extend(!0,{},p[g][i.pShapeId]),t.isNullOrUndefined(e.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(e.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),e.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=u,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+o.id))),u=n.extend(!0,{},i.cutCell.obj),g=i.cShapeId.indexOf("picture")>-1?"picture":"chart",t.isNullOrUndefined(u)||(this.setActiveCell(i.cutCell.rowIndex,i.cutCell.colIndex,i.cSheetIndex),g==="chart"?"chart"in u&&(o=n.extend(!0,{},i.cutCell.shapeObj),h=o.range,this.setActiveSheetIndex(i.cSheetIndex),this.XLChart.createChart(o.isChartSeries?null:this._getAlphaRange(i.sheetIndex,h[0],h[1],h[2],h[3]),o),this.setActiveSheetIndex(i.sheetIndex),o.isChartSeries||this.XLSelection.selectRange({rowIndex:h[0],colIndex:h[1]},{rowIndex:h[2],colIndex:h[3]},i.cSheetIndex)):"picture"in u&&(o=n.extend(!0,{},i.cutCell.shapeObj),et=this._id+"_picture",this.XLShape._createPicture(i.cSheetIndex,{rowIndex:i.cutCell.rowIndex,colIndex:i.cutCell.colIndex},p.sharedPics[o.data],o.top,o.left,o.width,o.height,parseInt(o.id.replace(et,"")),o.bcolor,o.bstyle,o.bwidth))),this.XLShape._picCellIdx={rowIndex:i.cutCell.rowIndex,colIndex:i.cutCell.colIndex},ot=i.pasteCell,i.pasteCell=i.cutCell,i.cutCell=ot,st=i.pShapeId,i.pShapeId=i.cShapeId,i.cShapeId=st;else{for(lt=[],e=this._dataContainer,this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),this._getCopyText(i.text),r=0,ht=i.pasteCells.length;r<ht;r++)t.isNullOrUndefined(i.pSheetIndex)||(this.isUndefined(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])||(u=e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]),v=this._generateHeaderText(i.pasteCells[r].colIndex+1)+(i.pasteCells[r].rowIndex+1),"wrap"in u&&this.setWrapText("unwrap",v+":"+v),this._isRowViewable(i.pSheetIndex,i.pasteCells[r].rowIndex)&&(d=this.getCell(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pSheetIndex)[0],d.textContent="",this._removeClass(d,"e-commentcell")),this.isUndefined(u)||(this._cutShape(u,i.pasteCells[r],p,i.pSheetIndex),"merge"in u&&(this._isUndo?(n.extend(!0,i.pasteCells[r].newObj,e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]),this.setActiveSheetIndex(i.pSheetIndex),this.unmergeCells(u.merge.mRange),this.getCell(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pSheetIndex).prop("rowspan",!1).prop("colspan",!1),"merge"in i.pasteCells[r].prevObj&&(this.mergeCenter=i.pasteCells[r].prevObj.merge.isCenterAlign,this.mergeCells(i.pasteCells[r].prevObj.merge.mRange,!0),this.mergeCenter=!1)):(this.setActiveSheetIndex(i.pSheetIndex),this.unmergeCells(u.merge.mRange,!0),"merge"in i.pasteCells[r].prevObj&&(this.mergeCenter=i.pasteCells[r].prevObj.merge.isCenterAlign,this.mergeCells(i.pasteCells[r].prevObj.merge.mRange,!0),this.mergeCenter=!1),this.setActiveSheetIndex(i.cSheetIndex),this.unmergeCells(this._getAlphaRange(i.pSheetIndex,i.cutCells[r].rowIndex,i.cutCells[r].colIndex,i.cutCells[r].rowIndex,i.cutCells[r].colIndex)),h=this.getRangeIndices(i.cutCells[r].prevObj.merge.mRange),this.XLSelection.selectRange({rowIndex:h[0],colIndex:h[1]},{rowIndex:h[2],colIndex:h[3]},i.sheetIndex))),"cellType"in u&&this._removeClass(d,"e-cellreadonly")),this.isUndefined(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])&&(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex]={}),t.isNullOrUndefined(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex])||(y=e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].overflow),this.model.allowCellFormatting&&this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0,border:!0}),e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].wrap&&(rt=!0),bt=this.XLEdit.getPropertyValue(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,"tableName")||"",e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]=n.extend(!0,{},i.pasteCells[r].prevObj),this._textClip(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,"delete"),this.isUndefined(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])||(y&&(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].overflow=y),this._setRowHdrHeight(i.pSheetIndex,i.pasteCells[r].rowIndex),u=e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex],c=i.pasteCells[r].rowIndex,a=i.pasteCells[r].colIndex,this._applyCommentLink(u,{rowIndex:c,colIndex:a},c,a),rt&&(u.wrap=rt),this._isPaste=!0,t.isNullOrUndefined(u)||(this._pasteShape(u,{rowIndex:c,colIndex:a},p,i.pSheetIndex,i.sheetIndex),v=this._generateHeaderText(a+1)+(c+1),"wrap"in u&&(this.XLEdit._clearDataContainer({cellIdx:i.pasteCells[r],property:["wrap"]}),this.setWrapText("wrap",v+":"+v)))),nt=i.pasteCells[r].prevObj,i.pasteCells[r].prevObj=i.pasteCells[r].newObj,i.pasteCells[r].newObj=nt,this._isPaste=!1);for(r=0;r<i.cutCells.length;r++)t.isNullOrUndefined(i.cSheetIndex)||(f=i.cutCells[r],this._isRowViewable(i.cSheetIndex,f.rowIndex)&&(ct=this.getCell(f.rowIndex,f.colIndex,i.cSheetIndex)[0],ct.textContent=lt[r]),this.setActiveSheetIndex(i.cSheetIndex),u=t.isNullOrUndefined(e.sheets[i.cSheetIndex][f.rowIndex])?{}:e.sheets[i.cSheetIndex][f.rowIndex][f.colIndex],t.isNullOrUndefined(u)||this._cutShape(u,f,p,i.cSheetIndex),t.isNullOrUndefined(e.sheets[i.cSheetIndex][f.rowIndex])&&(e.sheets[i.cSheetIndex][f.rowIndex]={}),t.isNullOrUndefined(e.sheets[i.cSheetIndex][f.rowIndex][f.colIndex])||(y=e.sheets[i.cSheetIndex][f.rowIndex][f.colIndex].overflow),f.prevObj.tableName&&delete f.prevObj.tableName,e.sheets[i.cSheetIndex][f.rowIndex][f.colIndex]=n.extend(!0,{},f.prevObj),this.getObjectLength(y)>0&&(e.sheets[i.cSheetIndex][f.rowIndex][f.colIndex].overflow=y)&&(y={}),nt=f.prevObj,f.prevObj=f.newObj,f.newObj=nt,c=f.rowIndex,a=f.colIndex,this._setRowHdrHeight(i.cSheetIndex,c),this.XLScroll._getRowHeights(i.cSheetIndex,c),u=t.isNullOrUndefined(e.sheets[i.cSheetIndex][c])?{}:e.sheets[i.cSheetIndex][c][a],this._applyCommentLink(u,{rowIndex:c,colIndex:a},c,a),this._isPaste=!0,t.isNullOrUndefined(u)||(this._pasteShape(u,{rowIndex:c,colIndex:a},p,i.cSheetIndex),"merge"in u&&(this.mergeCenter=u.merge.isCenterAlign,this.mergeCells(u.merge.mRange,!0),this.mergeCenter=!1),"cellType"in u&&(ut=this._dataContainer.sheetCellType[u.cellType],ut.text="",this.model.allowCellType&&this.XLCellType._renderControls(f.rowIndex,f.colIndex,i.pSheetIndex,ut,!0)),this._dupDetails=!0,v=this._generateHeaderText(f.colIndex+1)+(f.rowIndex+1),"wrap"in u&&(this.XLEdit._clearDataContainer({cellIdx:f,property:["wrap"]}),this.setWrapText("wrap",v+":"+v)),this._dupDetails=!1),this._isPaste=!1);if(this.XLScroll._getRowHeights(i.pSheetIndex,i.pasteCells[0].rowIndex<i.cutCells[0].rowIndex?i.pasteCells[0].rowIndex:i.cutCells[0].rowIndex),this.model.allowCellFormatting&&!t.isNullOrUndefined(i.pSheetIndex)&&(this.setActiveSheetIndex(i.pSheetIndex),this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),this.isUndefined(i.pasteBorder.prevBorder)||this.XLFormat.updateFormat(i.pasteBorder.prevBorder,i.pasteBorder.range,"format")),k=i.pasteBorder.prevBorder,i.pasteBorder.prevBorder=i.pasteBorder.newBorder,i.pasteBorder.newBorder=k,this.model.allowCellFormatting&&!t.isNullOrUndefined(i.cSheetIndex)&&(this.setActiveSheetIndex(i.cSheetIndex),i.isSpecial&&this.XLFormat.removeStyle(i.cutBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),i.cutBorder.prevBorder&&this.XLFormat.updateFormat(i.cutBorder.prevBorder,i.cutBorder.range,"format")),k=i.cutBorder.prevBorder,i.cutBorder.prevBorder=i.cutBorder.newBorder,i.cutBorder.newBorder=k,!t.isNullOrUndefined(i.pfat)){var w,l=i.pfat.table,b,at=i.pfat.minRowIdx,vt=i.pfat.minColIdx,tt,it=i.pfat.range;for(s=0,ft=l.length;s<ft;s++)b=l[s].range,t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),tt=l[s].tblObj.tblId,w=i.pfat.ptable[s].range,this.XLFormat.removeTable(tt),this.XLFormat.removeStyle(w)),t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLClipboard._isCut=!0,this._isUndo?(this.XLFormat.createTable(l[s].tblObj,l[s].range),l[s].tblObj.totalRow&&this.XLFormat._updateTotalRow(i.sheetIndex,tt,l[s].tblObj.fnNumber,l[s].range,!0)):(w=this.getRangeIndices(this._getAlphaRange(i.cSheetIndex,b[0]+at-it[0],b[1]+vt-it[1],at-it[0]+b[2],vt-it[1]+b[3])),this.XLFormat.createTable(l[s].tblObj,w),l[s].tblObj.totalRow&&this.XLFormat._updateTotalRow(i.sheetIndex,tt,l[s].tblObj.fnNumber,w,!0)),this.XLClipboard._isCut=!1)}t.isNullOrUndefined(i.filter)||(this.XLFilter.clearFilter(),this.XLFilter.filter(details.filter))}i.operation!=="shape"&&(this._isUndo?(t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLSelection.selectRange(i.cutCells[0],i.cutCells[i.cutCells.length-1])),t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1]))):(t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection._focusBorder(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1],this._cutFocus),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])),t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLSelection.selectRange(i.cutCells[0],i.cutCells[i.cutCells.length-1]))));this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();yt=i.pasteCells;i.pasteCells=i.cutCells;i.cutCells=yt;pt=i.pasteBorder;i.pasteBorder=i.cutBorder;i.cutBorder=pt;wt=i.cSheetIndex;i.cSheetIndex=i.pSheetIndex;i.pSheetIndex=wt},_undoForDel:function(t){this._delCells=n.extend(!0,[],t.delCells);this._deletedText=n.extend(!0,[],t.text);this._removeMergeColl=n.extend(!0,[],t.removeMerge);this._deletedDimension=n.extend(!0,[],t.deletedDimension);this._isUndo&&(this._fRow.fRowCnt=t.fRow.fRowCnt,this._fCol.fColCnt=t.fCol.fColCnt,this._fRow.rowAdj=t.fRow.rowAdj,this._fCol.colAdj=t.fCol.colAdj);switch(t.action){case"deleteShiftUp":this.deleteShiftUp(t.startCell,t.endCell);break;case"deleteShiftLeft":this.deleteShiftLeft(t.startCell,t.endCell);break;case"deleteRow":this.deleteEntireRow(t.startCell.rowIndex,t.endCell.rowIndex);break;case"deleteColumn":this.deleteEntireColumn(t.startCell.colIndex,t.endCell.colIndex)}},_undoForEdit:function(n){var o,u,h,l,f,e,a,s=n.cFormatRule,r={rowIndex:n.rowIndex,colIndex:n.colIndex},c,i,v,y=this.getRows(n.sheetIndex);if(this.setActiveCell(n.rowIndex,n.colIndex,n.sheetIndex),this.XLSelection.selectRange(n.startCell,n.endCell),this._isRowViewable(n.sheetIndex,n.rowIndex)&&(i=this.getCell(n.rowIndex,n.colIndex),v=i.find("a").css("text-decoration"),n.altwrap&&(this._isUndo?(this.XLEdit._clearDataContainer({cellIdx:r,property:["altTxt"]}),this.unWrapText([n.rowIndex,n.colIndex,n.rowIndex,n.colIndex])):(this.XLEdit._updateDataContainer(r,{dataObj:{altTxt:!0}}),this.wrapText([n.rowIndex,n.colIndex,n.rowIndex,n.colIndex])))),u=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"hyperlink",n.sheetIndex),t.isNullOrUndefined(u)||(h=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"value2"),n.action=h.length<1?"add":"delete",n.reqType="edit",r.prevLink=u,r.prevText=h,n.selectedCell=[]),c=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"comment"),this.XLEdit._updateCellValue({rowIndex:n.rowIndex,colIndex:n.colIndex},n.pValue),this._dupDetails=!0,s&&s.length){for(o=0,a=s.length;o<a;o++)e=s[o].split("_"),this.XLCFormat._cFormat(e[0],e[2],e[3],e[4],e[5]);this.XLCFormat.refreshCFormat(this._getAlphaRange(n.sheetIndex,n.rowIndex,n.colIndex,n.rowIndex,n.colIndex))}n.prevFrmtObj&&n.curFrmtObj&&(l=this._isUndo?n.prevFrmtObj:n.curFrmtObj,this.XLFormat.format(l,this._getAlphaRange(n.sheetIndex,n.rowIndex,n.colIndex,n.rowIndex,n.colIndex)));this._dupDetails=!1;this._textClip(n.rowIndex,n.colIndex,n.pValue.length>0?"add":"delete");t.isNullOrUndefined(c)||(this.XLEdit._updateDataContainer({rowIndex:n.rowIndex,colIndex:n.colIndex},{dataObj:{comment:c}}),this.XLComment.setComment(),this.XLComment._updateCurCmntVal());this._isRowViewable(n.sheetIndex,n.rowIndex)&&(u&&(u.webAdr?i.html(t.buildTag("a",i.text(),"",{href:hldata.webAdr,target:"_blank","class":"e-hyperlinks"})):i.html(t.buildTag("a",i.text(),"",{"class":"e-hyperlinks"}))),i.find("a").css("text-decoration",v),i.removeClass("e-commentcell"));t.isNullOrUndefined(u)||(r.curLink=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"hyperlink"),r.curText=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"value2"),n.selectedCell.push(r));n.prevHeight!=n.newHeight&&(this.getSheet(n.sheetIndex).rowsHeightCollection[n.rowIndex]=n.prevHeight,this._isRowViewable(n.sheetIndex,n.rowIndex)&&(y[0][n.rowIndex].style.height=n.prevHeight+"px",y[1][n.rowIndex].style.height=n.prevHeight+"px"),this._setRowHdrHeight(n.sheetIndex,n.rowIndex),this.XLScroll._getRowHeights(n.sheetIndex,n.rowIndex),f=n.newHeight,n.newHeight=n.prevHeight,n.prevHeight=f);f=n.cValue;n.cValue=n.pValue;n.pValue=f;this.XLEdit._isEdit=!1;f=n.previousValue;n.previousValue=n.value;n.value=f;this.model.allowFormulaBar&&this.updateFormulaBar();this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForFilter:function(i){var y=!1,v=[],u,d,c=[],b,o,s,f,g=i.sheetIndex||this.getActiveSheetIndex(),k=this._dataContainer.sheets[g],p,nt,r,e,l,a,tt,w,h;if(i.operation==="filter"&&i.requestType!=="filterbycell")if(this._isUndo){for(r=this._undoCollection.length-1;r>=0;r--){if(this._undoCollection[r].reqType==="filter"&&this._undoCollection[r].tableID===i.tableID&&this._undoCollection[r].action==="filtering"&&this._undoCollection[r].status!=="apply-filterIcon"&&this._undoCollection[r].rowIndex===i.rowIndex&&this._undoCollection[r].colIndex===i.colIndex){for(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],u=this._undoCollection[r],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,u.tableID),r=0,e=u.filterCollection.length;r<e;r++)v.push(u.filterCollection[r]);this.model.sheets[u.sheetIndex].filterSettings.filteredColumns=v;t.isNullOrUndefined(this._excelFilter._predicates[u.sheetIndex][u.fieldName])&&(this._excelFilter._predicates[u.sheetIndex][u.fieldName]={});this._excelFilter._predicates[u.sheetIndex][u.fieldName]=u.ejpredicate;this.model.sheets[u.sheetIndex]._selectedRange=u.range;this.XLFilter._filterHandler(u);b="undo";y=!0;break}if(this._undoCollection[r].reqType==="filter"&&this._undoCollection[r].tableID===i.tableID&&this._undoCollection[r].action==="clearfiltering"){delete this._excelFilter._predicates[i.sheetIndex][i.fieldName];u=this._undoCollection[r];this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,u.tableID);y=!0;break}if(this._undoCollection[r].requestType==="filterbycell"&&this._undoCollection[r].rowIndex===i.rowIndex&&this._undoCollection[r].colIndex===i.colIndex){u=this._undoCollection[r];delete this._excelFilter._predicates[u.sheetIndex][u.fieldName];this.XLFilter._clearFilterColumn(u.fieldName,"","","Or",null,null,u.tableID);n.extend(!0,c,u.selCells);this.XLFilter._filterActiveCell(u.sheetIndex,u.activeCell,c,u.filteredValue,u.selRange);b="undo";y=!0;break}}y||(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID))}else{for(v=[],delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),r=0,e=i.filterCollection.length;r<e;r++)v.push(i.filterCollection[r]);this.model.sheets[i.sheetIndex].filterSettings.filteredColumns=v;t.isNullOrUndefined(this._excelFilter._predicates[i.sheetIndex][i.fieldName])&&(this._excelFilter._predicates[i.sheetIndex][i.fieldName]={});this._excelFilter._predicates[i.sheetIndex][i.fieldName]=i.ejpredicate;i.filterCollection.length&&this.XLFilter._filterHandler(i);b="redo"}else if(this._isUndo){if(i.operation==="apply-filter"&&i.requestType!=="filterbycell")for(r=0,e=i.filteredCells.length;r<e;r++)o=i.filteredCells[r].rowIndex,s=i.filteredCells[r].colIndex,f=this.getCell(o,s,i.sheetIndex),f.find(".e-ssfilter").remove(),this._removeClass(f[0],"e-filterhdr"),this.addClass(f[0],"e-wrapword"),(this.isNumber(f.text())||this.XLEdit._parseValue(f.text(),{rowIndex:o,colIndex:s}).type==="datetime"||this.XLEdit._parseValue(f.text(),{rowIndex:o,colIndex:s}).type==="currency"||this.XLEdit._parseValue(f.text()).type==="percentage")&&f.addClass(this._rAlign),delete k[o][s].isFilterHeader,delete k[o][s].filterState,delete k[o][s].isFilterVisible,this.XLEdit.getPropertyValue(o,s,"isFilterWrap")&&this.setWrapText("wrap",this._getAlphaRange(g,o,s,o,s));if(i.requestType==="filterbycell"&&(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),!this.isUndefined(i.filteredCells)))for(r=0,e=i.filteredCells.length;r<e;r++)f=this.getCell(i.filteredCells[r].rowIndex,i.filteredCells[r].colIndex,i.sheetIndex),f.find(".e-ssfiltered, .e-ssfilter").remove(),this._removeClass(f[0],"e-filterhdr"),this.addClass(f[0],"e-wrapword"),(this.isNumber(f.text())||this.XLEdit._parseValue(f.text(),{rowIndex:i.filteredCells[r].rowIndex,colIndex:i.filteredCells[r].colIndex}).type==="datetime"||this.XLEdit._parseValue(f.text(),{rowIndex:i.filteredCells[r].rowIndex,colIndex:i.filteredCells[r].colIndex}).type==="currency"||this.XLEdit._parseValue(f.text(),{rowIndex:i.filteredCells[r].rowIndex,colIndex:i.filteredCells[r].colIndex}).type==="percentage")&&f.addClass(this._rAlign);if(this.model.sheets[i.sheetIndex].filterSettings.range="",i.operation==="apply-filter"&&i.requestType!="filterbycell"||i.requestType==="filterbycell"&&!this.isUndefined(i.filteredCells)){for(p=this.model.sheets[i.sheetIndex].filterSettings.tableRange,r=0,e=p.length;r<e;r++)if(p[r].tableID===i.tableID){nt=r;break}i.filterRange=p.splice(nt,1)[0]}if(i.operation==="remove-filter"){if(l=this._undoCollection[this._undoCollection.length-1],h=this.getSheet(i.sheetIndex),l.requestType==="filterbycell")n.extend(!0,c,l.selCells),this.XLFilter._filterActiveCell(l.sheetIndex,l.activeCell,c,l.filteredValue,l.selRange);else for(r=0,e=i.filteredCells.length;r<e;r++)w=this.XLFilter._getFilterIcon(),this.XLFilter._applyFilterIcon(i.filteredCells[r],w);for(h._selectedRange=i.selRange,h.filterSettings.filteredRange=i.fltrdRange,h.filterSettings.filteredColumns=i.filteredCols,h.filterSettings.range=i.fRange,h.filterSettings.tableRange.push(i.filterRange),a=0,tt=i.filterCollection.length;a<tt;a++)this._excelFilter._predicates[i.sheetIndex][i.filterCollection[a].fieldName]=i.filterCollection[a].predicate,this.XLFilter._filterHandler(i.filterCollection[a])}}else if(i.operation==="remove-filter"&&(i.requestType==="filterbycell"?(this._isRowViewable(i.sheetIndex,i.activeCell.rowIndex)&&(d=this.getCell(i.activeCell.rowIndex,i.activeCell.colIndex),d.find("span.e-ssfilter").remove()),delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),n.extend(!0,c,i.selectedCell),this.XLFilter._filterActiveCell(i.sheetIndex,i.activeCell,c,i.filteredValue,i.selRange)):this.XLFilter.clearFilter("remove")),i.operation==="filter"&&i.requestType==="filterbycell"&&(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),n.extend(!0,c,i.selectedCell),this.XLFilter._filterActiveCell(i.sheetIndex,i.activeCell,c,i.filteredValue,i.selRange)),i.operation==="apply-filter"){for(h=this.getSheet(i.sheetIndex),r=0,e=i.filteredCells.length;r<e;r++)w=this.XLFilter._getFilterIcon(),this.XLFilter._applyFilterIcon({rowIndex:i.filteredCells[r].rowIndex,colIndex:i.filteredCells[r].colIndex},w);h.filterSettings.range=i.fRange;h.filterSettings.tableRange.push(i.filterRange)}},_undoForFilterByColor:function(n){var i,r=[],t;for(r.push(n),i=this._isUndo?this._undoCollection:r,delete this._excelFilter._predicates[n.sheetIndex][n.columnName],n.columnName&&this.XLFilter._clearFilterColumn(n.columnName,"","","Or",null,null,n.tableID),t=i.length-1;t>=0;t--)if((i[t].reqType==="filterbycolor"||i[t].reqType==="filter")&&i[t].tableID===n.tableID&&i[t].rowIndex===n.rowIndex&&i[t].colIndex===n.colIndex){this.XLFilter._filterHandler(i[t]);break}},_undoForFind:function(n){var i,t,r,u;switch(n.operation){case"replace":this.XLEdit._updateCellValue({rowIndex:n.rowIndex,colIndex:n.colIndex},n.prevData.value,null,n.sheetIndex);u=n.prevData;n.prevData=n.newData;n.newData=u;this.XLSelection.selectRange({rowIndex:n.rowIndex,colIndex:n.colIndex},{rowIndex:n.rowIndex,colIndex:n.colIndex});break;case"replaceAll":for(t=0,r=n.selectedCell.length;t<r;t++)this.XLEdit._updateCellValue({rowIndex:n.selectedCell[t].rowIndex,colIndex:n.selectedCell[t].colIndex},n.selectedCell[t].prevData.value,null,n.selectedCell[t].sheetIndex),u=n.selectedCell[t].prevData,n.selectedCell[t].prevData=n.selectedCell[t].newData,n.selectedCell[t].newData=u;break;case"blanks":case"conditions":case"validations":case"formulas":case"rowdiff":case"coldiff":case"comments":case"constants":for(t=0,r=n.selectedCell.length;t<r;t++)i=this.getCell(n.selectedCell[t].rowIndex,n.selectedCell[t].colIndex,n.sheetIndex),this._isUndo?i.operation==="coldiff"||i.operation==="rowdiff"?n.selectedCell[t].isApply?i.removeClass("e-selected"):i.addClass("e-selected"):n.selectedCell[t].isApply?i.addClass("e-selected"):i.removeClass("e-selected"):i.removeClass("e-selected")}this.model.allowFormulaBar&&this.updateFormulaBar()},_undoForFormat:function(i){var c=!1,y,r,f,e,o=this._dataContainer.sheets[i.sheetIndex],l,s,a,h="",u,v;if(t.isNullOrUndefined(i.process))for(i.oprType==="style"&&(this.XLFormat.removeStyle(i.range,{cellStyle:!0,format:!0}),h="e-format",!t.isNullOrUndefined(i.process)&&i.process.indexOf("border")>-1&&(h="e-border"),a=new RegExp("\\b"+h+".*?\\b","g")),y={startCell:i.selectedCell[0],endCell:i.selectedCell[i.selectedCell.length-1]},u=0,v=i.selectedCell.length;u<v;u++)r=i.selectedCell[u],this._isRowViewable(i.sheetIndex,r.rowIndex)&&(e=this.getCell(r.rowIndex,r.colIndex)[0],c=!0),t.isNullOrUndefined(o[r.rowIndex])&&(o[r.rowIndex]={}),t.isNullOrUndefined(o[r.rowIndex][r.colIndex])&&(o[r.rowIndex][r.colIndex]={}),n.extend(!0,o[r.rowIndex][r.colIndex],i.selectedCell[u].beforeFormat),c&&(i.oprType==="format"?(l=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2"),this.XLEdit._refreshTextNode(e,t.isNullOrUndefined(l)?"":l),this.XLEdit._refreshCellAlignment({cellIdx:{rowIndex:r.rowIndex,colIndex:r.colIndex}})):(f=h==="e-format"?this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"format"):this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border"),e.className=e.className.replace(a,""),f=t.isNullOrUndefined(f)?"":f,this.addClass(e,f))),i.selectedCell[0].colIndex===i.selectedCell[u].colIndex&&this.model.allowResizing&&(this._isUndo?this.XLResize.setRowHeight(i.selectedCell[u].rowIndex,i.selectedCell[u].bRowHeight):this.XLResize.setRowHeight(i.selectedCell[u].rowIndex,i.selectedCell[u].aRowHeight)),s=i.selectedCell[u].beforeFormat,i.selectedCell[u].beforeFormat=i.selectedCell[u].afterFormat,i.selectedCell[u].afterFormat=s,c=!1;!t.isNullOrUndefined(i.process)&&i.process.indexOf("border")>-1&&(this.XLFormat.removeStyle(i.range,{cellStyle:!0,tableStyle:!0,format:!1,border:!0}),this._isUndo?this.XLFormat.updateFormat(i.beforeFormat,i.range):i.process==="noborder"?this.XLFormat.format({border:{}},i.range):this.XLFormat.applyBorder(n.extend(!0,{},i.options),i.range),s=i.beforeFormat,i.beforeFormat=i.afterFormat,i.afterFormat=s);i.status="undo-cellformat";this.performSelection(i.range)},_undoForFormatPaint:function(t){var r,i,e,o,s=this._dataContainer.sheets[t.sheetIndex],u,f;for(this.XLCFormat.clearCF(t.range),this.XLFormat.removeStyle(t.range),this.updateData(n.extend(!0,[],t.beforeData),t.range),this.XLCFormat.refreshCFormat(t.range),e=this.getRangeData({range:t.range}),o=this._getSelectedRange({rowIndex:t.range[0],colIndex:t.range[1]},{rowIndex:t.range[2],colIndex:t.range[3]}),i=0,f=t.unwrapCells.length;i<f;i++)this.setWrapText("unwrap",this._getAlphaRange(t.sheetIndex,t.unwrapCells[i].rowIndex,t.unwrapCells[i].colIndex,t.unwrapCells[i].rowIndex,t.unwrapCells[i].colIndex));for(i=0,u=t.wrapCells.length;i<u;i++)this.setWrapText("wrap",this._getAlphaRange(t.sheetIndex,t.wrapCells[i].rowIndex,t.wrapCells[i].colIndex,t.wrapCells[i].rowIndex,t.wrapCells[i].colIndex));r=t.unwrapCells;t.unwrapCells=t.wrapCells;t.wrapCells=r;r=t.beforeData;t.beforeData=t.afterData;t.afterData=r},_undoForFormatTable:function(i){var o,d,c,l,a,s,p,w,y,g,f=0,u=i.sheetIndex,r=this.getSheet(u).tableManager,tt,e=i.header,it=n("#"+this._id+"_Ribbon").data("ejRibbon"),v,rt=this._isUndo,b,nt,k,h;switch(i.action){case"Design_Tools_ConvertToRange":this._isUndo?(r[i.tableID]={name:i.name,range:i.beforeRange,format:i.format,formatName:i.formatName},this.performSelection(this._getAlphaRange(u,i.beforeRange[0],i.beforeRange[1],i.beforeRange[2],i.beforeRange[3])),this.XLFilter._filterTable(u,i.tableID),this.updateUniqueData({tableName:"e-table"+i.tableID},r[i.tableID].range),r[i.tableID].isFilter=i.isFilter,r[i.tableID].firstColumn=i.firstColumn,r[i.tableID].lastColumn=i.lastColumn,r[i.tableID].totalRow=i.totalRow,r[i.tableID].fnNumber=i.fnNumber,this.getSheet(u)._header[i.tableID]=e,g=this._getDollarAlphaRange(r[i.tableID].range,!0),this.XLRibbon.addNamedRange(i.name,g,null,u)):i.tableID in r&&(tt="e-table"+i.tableID,this.XLFormat.removeTable(i.tableID),this.XLFilter._clearFilterTable(u,i.tableID),delete r[i.tableID],delete this.model.sheets[u]._header[i.tableID]);break;case"filtericon":b=n("#"+i.id).data("ejCheckBox");nt=i.tableId;i.check?b.option("checked",!1):b.option("checked",!0);r[nt].isFilter=!i.check;i.check=!i.check;break;case"firstlastcolumn":k=n("#"+i.id).data("ejCheckBox");i.check?(this.XLFormat.format({style:{"font-weight":"normal"}},i.range),k.option("checked",!1)):(this.XLFormat.format({style:{"font-weight":"bold"}},i.range),k.option("checked",!0));r[i.tableId][i.prop]=!i.check;i.check=!i.check;break;case"totalrow":n("#"+i.id).ejCheckBox("option",{checked:!i.check});i.check=!i.check;break;case"Design_Tools_ResizeTable":if(this._isUndo){for(this._isFATResize=!0,i.afterRange=n.extend(!0,[],i.afterRange),i.totalRow&&(this._dupDetails=!0,this.XLFormat._calculateTotalRow(u,i.tableId,!1),i.beforeRange[2]-=1,r[i.tableId].range[2]-=1),a=r[i.tableId].name,this.XLFormat.removeTable(i.tableId),this.XLFormat.removeStyle(i.afterRange),c=i.beforeRange[3]-i.beforeRange[1]+1,s=e[i.tableId].header?this.getRangeData({range:i.beforeRange}):this.getRangeData({range:i.beforeRange}).splice(c,this.getRangeData({range:i.beforeRange}).length),this.clearRangeData(i.beforeRange),e[i.tableId].header?this.updateData(s,[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2],i.beforeRange[3]]):this.updateData(s,[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2]-1,i.beforeRange[3]]),h={header:e[i.tableId].header,tblId:i.tableId,name:a,range:i.beforeRange,format:i.format,formatName:i.formatName,firstColumn:i.firstColumn,lastColumn:i.lastColumn,isFilter:i.isFilter,totalRow:i.totalRow},this.XLClipboard._isCut=!0,e[i.tableId].header?this.XLFormat.createTable(h,i.beforeRange):this.XLFormat.createTable(h,[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2]-1,i.beforeRange[3]]),i.totalRow&&(this._dupDetails=!0,this.XLFormat._calculateTotalRow(u,i.tableId,!0),i.beforeRange=r[i.tableId].range),v=this.getSheet(u).filterSettings.tableRange,f=0;f<v.length;f++)if(v[f].tableID==i.tableId){v[f].endRow=v[f].selectedRange.endRow=i.beforeRange[2];break}this.XLClipboard._isCut=!1;this._isFATResize=!1}else this._isFATResize=!0,i.beforeRange=n.extend(!0,[],i.beforeRange),i.totalRow&&(this.XLFormat._calculateTotalRow(u,i.tableId,!1),i.afterRange=r[i.tableId].range=[i.afterRange[0],i.afterRange[1],i.afterRange[2]-1,i.afterRange[3]]),a=r[i.tableId].name,this.XLFormat.removeTable(i.tableId),this.XLFormat.removeStyle(i.beforeRange),c=i.beforeRange[3]-i.beforeRange[1]+1,s=e[i.tableId].header?this.getRangeData({range:i.afterRange}):this.getRangeData({range:i.afterRange}).splice(c,this.getRangeData({range:i.afterRange}).length),this.clearRangeData(i.afterRange),e[i.tableId].header?this.updateData(s,i.afterRange):this.updateData(s,[i.afterRange[0],i.afterRange[1],i.afterRange[2]-1,i.afterRange[3]]),h={header:e[i.tableId].header,tblId:i.tableId,name:a,range:i.beforeRange,format:i.format,formatName:i.formatName,firstColumn:i.firstColumn,lastColumn:i.lastColumn,isFilter:i.isFilter,totalRow:i.totalRow},this.XLClipboard._isCut=!0,e[i.tableId].header?this.XLFormat.createTable(h,i.afterRange):this.XLFormat.createTable(h,[i.afterRange[0],i.afterRange[1],i.afterRange[2]-1,i.afterRange[3]]),this.XLFilter._extendFilterRange(i.tableId,i.afterRange),i.totalRow&&(this.XLFormat._calculateTotalRow(u,i.tableId,!0),i.afterRange=r[i.tableId].range),this.XLClipboard._isCut=!1,this._isFATResize=!1;break;case"renaming":this.XLRibbon.removeNamedRange(r[i.tableId].name);document.getElementById(this._id+"_Ribbon_Design_Properties_TableName")&&(document.getElementById(this._id+"_Ribbon_Design_Properties_TableName").value=r[i.tableId].name=this._isUndo?i.prevName:i.newName);this.XLRibbon.addNamedRange(r[i.tableId].name,i.range,null,u);it.showTab(this._getLocStr("Design"));break;default:if(this._isUndo){if(a=r[i.tableID].name,this.XLFormat.removeTable(i.tableID),this.XLFormat.removeStyle(i.afterRange),i.tableStyle.header)for(o=0,d=i.beforeRangeHeader.length;o<d;o++)t.isNullOrUndefined(i.beforeRangeHeader[o].value2)?this.XLEdit._updateCellValue(this._getCellIdx(i.pcells[o]),""):this.isNumber(i.pcells[o].innerHTML)&&this.XLEdit._refreshCellAlignment({cellIdx:this._getCellIdx(i.pcells[o])});else c=i.afterRange[3]-i.afterRange[1]+1,this.clearRangeData(i.afterRange),this.updateData(n.extend(!0,[],i.beforeRangeData),i.afterRange);if(this.XLFormat.updateFormat(i.beforeFormat,i.afterRange),p=i.beforeMergeRange,w=p.length,w)while(f<w)y=p[f].value,y&&(l=this.getRangeIndices(y.mRange),selCell=this._getSelectedRange({rowIndex:l[0],colIndex:l[1]},{rowIndex:l[2],colIndex:l[3]}),this.mergeCenter=y.isCenterAlign,this._mergeCells(i.sheetIndex,selCell,{},[])),f++}else this.XLFormat.createTable(i.tableStyle,i.beforeRange)}},_autosumFormatUpdate:function(n,t,i,r){var f={},u,e=this.getActiveSheetIndex();n.type!=="general"&&(this._dupDetails=!0,f.type=n.type,u=i?this._getAlphaRange(e,t[2]+1,t[3],t[2]+1,t[3]):this._getAlphaRange(e,t[0],t[1],t[2],t[3]),r?this.XLFormat.format({type:"general"},u+":"+u):this.XLFormat.format(f,u+":"+u),this._dupDetails=!1)},_undoForHyperlink:function(n){var t,i,r={rowIndex:n.selectedCell[n.selectedCell.length-1].rowIndex,colIndex:n.selectedCell[n.selectedCell.length-1].colIndex},u={rowIndex:n.selectedCell[0].rowIndex,colIndex:n.selectedCell[0].colIndex},f,e,o;for(this.setActiveCell(n.selectedCell[0].rowIndex,n.selectedCell[0].colIndex),this.XLSelection.selectRange(u,r),n.action==="add"?this._removeHyperlink(n.reqType,n.selectedCell):n.action==="edit"?this._setLink(n.selectedCell):this._setLink(n.selectedCell),t=0,i=n.selectedCell.length;t<i;t++)f=n.selectedCell[t].prevLink,n.selectedCell[t].prevLink=n.selectedCell[t].curLink,n.selectedCell[t].curLink=f,e=n.selectedCell[t].prevText,n.selectedCell[t].prevText=n.selectedCell[t].curText,n.selectedCell[t].curText=e,o=n.selectedCell[t].prevColor,n.selectedCell[t].prevColor=n.selectedCell[t].curColor,n.selectedCell[t].curColor=o;n.action==="add"?n.action="delete":n.action==="delete"&&(n.action="add");this.XLSelection.selectRange(u,r);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForIns:function(t){n.extend(!0,this._delCells,t.delCells);n.extend(!0,this._deletedText,t.text);n.extend(!0,this._removeMergeColl,t.removeMerge);switch(t.action){case"insertShiftRight":this.insertShiftRight(t.startCell,t.endCell);break;case"insertShiftBottom":this.insertShiftBottom(t.startCell,t.endCell);break;case"insertRow":this.insertEntireRow(t.startCell.rowIndex,t.endCell.rowIndex);break;case"insertColumn":this.insertEntireColumn(t.startCell.colIndex,t.endCell.colIndex)}},_undoForMerge:function(n){var r,u,s,e,f,h,i,o;this._delCells=n.hideCells;this._selMergeCells=[];switch(n.action){case"merge-all":case"merge-across":case"un-merge":for(i=0,o=n.mCells.length;i<o;i++)e=t.isNullOrUndefined(n.mCells[i].prevObj)?{}:t.isNullOrUndefined(n.mCells[i].prevObj.merge)?{}:n.mCells[i].prevObj.merge,f=t.isNullOrUndefined(n.mCells[i].curObj)?{}:t.isNullOrUndefined(n.mCells[i].curObj.merge)?{}:n.mCells[i].curObj.merge,n.action==="un-merge"?t.isNullOrUndefined(e.mRange)||(r=this.getRangeIndices(e.mRange),u=this._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),this.mergeCenter=e.isCenterAlign,this._mergeCells(n.sheetIndex,u,{},[])):(s=this._getHiddenRowColumnCount(n.sheetIndex,f.mRange),this._unMergeAllCells(n.sheetIndex,i,n.mCells,[],s.hRow,s.hCol)),h=n.mCells[i].prevObj,n.mCells[i].prevObj=n.mCells[i].curObj,n.mCells[i].curObj=h;if(n.action!=="un-merge")for(i=0,o=n.mCells.length;i<o;i++)e=t.isNullOrUndefined(n.mCells[i].prevObj)?{}:t.isNullOrUndefined(n.mCells[i].prevObj.merge)?{}:n.mCells[i].prevObj.merge,f=t.isNullOrUndefined(n.mCells[i].curObj)?{}:t.isNullOrUndefined(n.mCells[i].curObj.merge)?{}:n.mCells[i].curObj.merge,t.isNullOrUndefined(f.mRange)||(r=this.getRangeIndices(f.mRange),u=this._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),this.mergeCenter=f.isCenterAlign,this._mergeCells(n.sheetIndex,u,{},[]));n.action=n.action==="un-merge"?"merge-all":"un-merge"}r=this._getSelectedCells(n.sheetIndex,n.range).range;u=this._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]});this.performSelection(u[0],u[u.length-1]);this._delCells=[]},_undoForReOrder:function(i){var f=this.getSheet(i.sheetIndex),e=this.getSheet(i.sheetIndex).tableManager,r,u;if(this._isUndo){for(this.XLComment&&this.XLComment.deleteComment(),r=i.destinationRange[0];r<=i.destinationRange[2];r++)for(u=i.destinationRange[1];u<=i.destinationRange[3];u++)this.XLEdit.getPropertyValue(r,u,"wrap")&&this.setWrapText("unwrap",this._getAlphaRange(i.sheetIndex,r,u,r,u));this.clearRangeData(i.destinationRange,i.property);this.XLFormat.removeStyle(i.destinationRange);this.XLCFormat.clearCF(i.destinationRange);this.isUndefined(i.tblObj)||(this.XLFormat.removeTable(i.tblObj.tblId),this.XLClipboard._isCut=!0,this.XLFormat.createTable(i.tblObj,i.sourceRange),i.tblObj.totalRow&&this.XLFormat._updateTotalRow(i.sheetIndex,i.tblObj.tblId,i.tblObj.fnNumber,i.sourceRange,!1),this.XLClipboard._isCut=!1);this.updateData(n.extend(!0,[],i.sourceData),i.sourceRange);this.updateData(n.extend(!0,[],i.destinationData),i.destinationRange);i.tRange&&(this._dupDetails=!0,this.XLFilter.clearFilter("remove"),this.XLFilter.filter(i.tRange),this._dupDetails=!1);this.XLFormat.updateFormat(i.sourceFormat,i.sourceRange);this.XLFormat.updateFormat(i.destinationFormat,i.destinationRange);this.isUndefined(i.sourceCFormat)||i.sourceCFormat instanceof Array||this.XLCFormat.setCFRule(i.sourceCFormat);this.setActiveCell(i.sourceRange[0],i.sourceRange[1]);this.XLSelection.selectRange({rowIndex:i.sourceRange[0],colIndex:i.sourceRange[1]},{rowIndex:i.sourceRange[2],colIndex:i.sourceRange[3]},i.sheetIndex);f._startCell={rowIndex:i.sourceRange[0],colIndex:i.sourceRange[1]};f._endCell={rowIndex:i.sourceRange[2],colIndex:i.sourceRange[3]};this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this.setHeightToRows(i.prevDestRowHt)}else{for(this.XLSelection.selectRange({rowIndex:i.sourceRange[0],colIndex:i.sourceRange[1]},{rowIndex:i.sourceRange[2],colIndex:i.sourceRange[3]},i.sheetIndex),this.XLComment&&this.XLComment.deleteComment(),r=i.sourceRange[0];r<=i.sourceRange[2];r++)for(u=i.sourceRange[1];u<=i.sourceRange[3];u++)this.XLEdit.getPropertyValue(r,u,"wrap")&&this.setWrapText("unwrap",this._getAlphaRange(i.sheetIndex,r,u,r,u));this.clearRangeData(i.sourceRange,i.property);this.clearRangeData(i.destinationRange,i.property);t.isNullOrUndefined(this.XLEdit.getPropertyValue(i.destinationRange[0],i.destinationRange[1],"tableName"))&&this.XLFormat.removeStyle(i.destinationRange);this.isUndefined(i.tblObj)||(this.XLFormat.removeTable(i.tblObj.tblId),this.XLClipboard._isCut=!0,this.XLFormat.createTable(i.tblObj,i.destinationRange),this.XLClipboard._isCut=!1);t.isNullOrUndefined(this.XLEdit.getPropertyValue(i.sourceRange[0],i.sourceRange[1],"tableName"))&&this.XLFormat.removeStyle(i.sourceRange);this.XLCFormat.clearCF(i.sourceRange);this.updateData(n.extend(!0,[],i.sourceData),i.destinationRange);i.tRange&&(this._dupDetails=!0,this.XLFilter.clearFilter("remove"),this.XLFilter.filter(i.destinationRange),this._dupDetails=!1);this.XLFormat.updateFormat(i.sourceFormat,i.destinationRange);i.tblObj&&i.tblObj.totalRow&&this.XLFormat._updateTotalRow(i.sheetIndex,i.tblObj.tblId,i.tblObj.fnNumber,i.destinationRange,!1);this.isUndefined(i.destinationCFormat)||i.destinationCFormat instanceof Array||this.XLCFormat.setCFRule(i.destinationCFormat);this.setHeightToRows(i.destHeight);this.setActiveCell(i.destinationRange[0],i.destinationRange[1]);this.XLSelection.selectRange({rowIndex:i.destinationRange[0],colIndex:i.destinationRange[1]},{rowIndex:i.destinationRange[2],colIndex:i.destinationRange[3]},i.sheetIndex);f._startCell={rowIndex:i.destinationRange[0],colIndex:i.destinationRange[1]};f._endCell={rowIndex:i.destinationRange[2],colIndex:i.destinationRange[3]};this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()}},_undoForPivot:function(n){var t=this._isUndo?this._undoCollection:this._redoCollection,i={curOperation:n,prevOperation:t[t.length-1],isUndo:this._isUndo};this._trigger("_readUndoRedo",i)},_undoForResizeCol:function(n){this.XLResize._resizeColumnUsingDiff(n.oldWidth,n.newWidth,n.cols);var t=n.oldWidth;n.oldWidth=n.newWidth;n.newWidth=t;this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForResizeRow:function(n){this.XLResize._resizeRowUsingDiff(n.oldHeight,n.newHeight,n.rows);var t=n.oldHeight;n.oldHeight=n.newHeight;n.newHeight=t;this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForResizeFHeight:function(n){var t=this._isUndo,i=n.newHeight;n.newHeight=n.oldHeight;n.oldHeight=i;this.XLResize.setRowHeight(n.rowIndex,n.newHeight);this._isUndo?this.XLEdit._clearDataContainer({sheetIdx:n.sheetIndex,cellIdx:{rowIndex:n.rowIndex,colIndex:0},property:["isFitHeight"]}):this.XLEdit._updateDataContainer({rowIndex:n.rowIndex,colIndex:0},{dataObj:{isFitHeight:!0}});this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this._isUndo=t},_undoForResizeFWidth:function(n){var t=this.getCell(0,n.colIndex).get(0),i=this._isUndo,r=n.newWidth;n.newWidth=t.offsetWidth===n.oldWidth?n.newWidth:n.oldWidth;n.oldWidth=r;this.XLResize._applyWidth(n.target,n.sheetIndex,n.colIndex,n.newWidth);this.XLScroll._getColWidths(n.sheetIndex,n.colIndex);this._isUndo?this.XLEdit._clearDataContainer({sheetIdx:n.sheetIndex,cellIdx:{rowIndex:0,colIndex:n.colIndex},property:["isFitWidth"]}):this.XLEdit._updateDataContainer({rowIndex:0,colIndex:n.colIndex},{dataObj:{isFitWidth:!0}});this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this._isUndo=i},_undoForShape:function(i){var u,r,v,b,nt=0,k,ot=this.getSheet(i.sheetIndex).shapeMngr,y,p,l,rt,c,ut,w,ft,g,h,e,s,a,et;this.model.showRibbon&&(k=this.XLRibbon._chartThemes);i.action!="chartType"&&i.action!=="create"&&i.action!=="remove"&&i.action!=="edit"&&i.action!=="border"&&i.action!=="resetpicture"&&i.action!=="changepicture"&&i.action!=="picturesize"&&i.action!=="chartTheme"&&i.action!=="chartType"&&i.action!=="selectData"&&(u=n("#"+i.cid).data("ejChart"),r=this.getSheet(i.sheetIndex).shapeMngr.chart[this.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"chart")[0]]);switch(i.action){case"create":this.XLShape._picCellIdx=this.XLShape._getCellIndexFromOffset(i.position.top,i.position.left);this.XLShape._deleteShape(i.sheetIndex,n("#"+i.id));i.action="remove";break;case"remove":i.shapeType==="picture"?(this.XLShape._createPicture(i.sheetIndex,i.actCell,i.img,i.position.top,i.position.left,i.position.width,i.position.height,i.cnt,i.bcolor,i.bstyle,i.bwidth),this.XLRibbon._formatTabUpdate(),n(i.actCell).addClass("e-activecell")):(i.options.isChartSeries||(this.XLSelection.selectRange({rowIndex:i.range[0],colIndex:i.range[1]},{rowIndex:i.range[0],colIndex:i.range[1]},i.sheetIndex),this.setActiveCell(i.range[0],i.range[1],i.sheetIndex)),this.XLChart.createChart(i.options.isChartSeries?null:this._getAlphaRange(i.sheetIndex,i.range[0],i.range[1],i.range[2],i.range[3]),i.options,i.id));i.action="create";break;case"edit":var tt,h=this._dataContainer.sheets[i.sheetIndex],o=i.id.split("_")[1].replace(/[0-9]/g,""),d={},it,f;n("#"+i.id).css({left:i.prev.left,top:i.prev.top,height:i.prev.height,width:i.prev.width});o==="chart"&&this.XLChart.resizeChart(i.id,i.prev.height,i.prev.width);i.visualImg.hide();this.XLShape._picCellIdx=this.XLShape._getCellIndexFromOffset(i.prev.top,i.prev.left);f=this.XLShape._getCellIndexFromOffset(i.cur.top,i.cur.left);tt=this._getShapePositionInManager(f.rowIndex,f.colIndex,i.id,o);d[o]=i.obj[o][tt];i.actionType!="resize"&&(this.getObjectLength(h[f.rowIndex][f.colIndex])<2&&h[f.rowIndex][f.colIndex][o].length<2?delete h[f.rowIndex][f.colIndex]:h[f.rowIndex][f.colIndex][o].length<2?delete h[f.rowIndex][f.colIndex][o]:(h[f.rowIndex][f.colIndex][o].some(function(n,t){if(d.id===n.id)return it=t,!0}),h[f.rowIndex][f.colIndex][o].splice(it,1)));this.XLEdit._updateDataContainer({rowIndex:this.XLShape._picCellIdx.rowIndex,colIndex:this.XLShape._picCellIdx.colIndex},{dataObj:d});this.getCell(this.XLShape._picCellIdx.rowIndex,this.XLShape._picCellIdx.colIndex,i.sheetIndex).addClass("e-activecell");this.model.showRibbon&&this.element.find(".e-ss-activeimg").length<1&&(o==="picture"?this.XLRibbon._toggleFormatTab():this.XLRibbon._toggleChartDesignTab());this.XLRibbon._setShapeWidthHeight({width:i.prev.width,height:i.prev.height,shapeType:o});this._swapVal(i);break;case"PHAxis":case"PVAxis":y=i.action=="PHAxis"?"primaryXAxis":"primaryYAxis";p=i.action==="PHAxis"?"xAxis":"yAxis";i.visibility=!i.visibility;u.option(y,{visible:i.visibility});r[p].visible=i.visibility;break;case"PX":case"PY":y=i.action=="PX"?"primaryXAxis":"primaryYAxis";p=i.action==="PX"?"xAxis":"yAxis";t.isNullOrUndefined(i.prev.text)&&(i.prev.text="");u.option(y,{title:{text:i.prev.text}});r[p].title.text=i.prev.text;this._swapVal(i);break;case"CT":u.option("title",{textAlignment:i.prev.align,text:i.prev.text});r.title={text:i.prev.text,textAlignment:i.prev.align};this._swapVal(i);break;case"DLNone":u.option({series:i.prev.series});r.dataLabel={visible:i.prev.series[0].marker.dataLabel.visible};this._swapVal(i);break;case"DL":u.option({series:i.prev.series});r.dataLabel={visible:i.prev.series[0].marker.dataLabel.visible,vAlign:i.prev.series[0].marker.dataLabel.verticalTextAlignment,tPosn:i.prev.series[0].marker.dataLabel.textPosition};this._swapVal(i);break;case"PMajorH":i.visibility=!i.visibility;u.option("primaryYAxis",{majorGridLines:{visible:i.visibility}});r.yAxis.majorGridLines={visible:i.visibility};break;case"PMajorV":i.visibility=!i.visibility;u.option("primaryXAxis",{majorGridLines:{visible:i.visibility}});r.xAxis.majorGridLines={visible:i.visibility};break;case"PMinorH":i.visibility=!i.visibility;u.option("primaryYAxis",{minorGridLines:{visible:i.visibility},minorTicksPerInterval:5,minorTickLines:{visible:i.visibility}});r.yAxis.minorGridLines={visible:i.visibility};break;case"PMinorV":i.visibility=!i.visibility;u.option("primaryXAxis",{minorGridLines:{visible:i.visibility},minorTicksPerInterval:5,minorTickLines:{visible:i.visibility}});r.xAxis.minorGridLines={visible:i.visibility};break;case"LNone":i.visibility=!i.visibility;u.option("legend",{visible:i.visibility});r.legend.visible=i.visibility;break;case"Legend":u.option("legend",{position:i.prev.position});r.legend.position=i.prev.position;this._swapVal(i);break;case"width":s={width:i.prev.width,height:i.prev.height,shapeType:"chart"};l=n("#"+u._id);u.option("size",n.extend(!0,{},s));l[0].style.height=i.prev.height+"px";l[0].style.width=i.prev.width+"px";r.width=i.prev.width;r.height=i.prev.height;this.XLRibbon._setShapeWidthHeight(s);this._swapVal(i);break;case"height":s={width:i.prev.width,height:i.prev.height,shapeType:"chart"};l=n("#"+u._id);u.option("size",n.extend(!0,{},s));l[0].style.height=i.prev.height+"px";l[0].style.width=i.prev.width+"px";r.width=i.prev.width;r.height=i.prev.Height;this.XLRibbon._setShapeWidthHeight(s);this._swapVal(i);break;case"srcolumn":u.model.series.length=0;r.isRowColSwitched=!r.isRowColSwitched;rt={xRange:r.xRange,yRange:r.yRange,lRange:r.lRange,isRowColSwitched:r.isRowColSwitched,dataSheetIdx:r.dataSheetIdx};c=this.XLChart._processChartSeries(rt);u.option({series:c.series});this.getActiveSheetIndex()===r.dataSheetIdx&&this.XLChart._focusChartRange(c.xRange,c.yRange,c.lRange);r.xAxis.range=c.xRange;r.yAxis.range=c.yRange;r.legend.range=c.lRange;break;case"border":ft=this._dataContainer.sheets[i.sheetIndex][i.cellIdx.rowIndex][i.cellIdx.colIndex].picture[i.picIdx];e=n("#"+i.id);this._removeClass(e[0],i.curClass);this.addClass(e[0],i.prevClass);w=this.XLShape._getImgStyleFromHashCode(i.prevClass);ft={bcolor:w["border-color"],bstyle:w["border-style"],bwidth:w["border-width"]};ut=i.prevClass;i.prevClass=i.curClass;i.curClass=ut;break;case"resetpicture":e=n("#"+i.id);g=new RegExp("\\be-shapebdr.*?\\b","g");this._isUndo?e[0].className.match(g)&&this.XLShape.changePictureBorder(e[0].id,i.prev.bwidth,i.prev.bstyle,i.prev.bcolor):e[0].className=e[0].className.replace(g,"");i.actionType!=="resetpicture"&&(e.css({width:i.prev.width,height:i.prev.height}),this.XLShape._selectImg(e),this.XLShape._updateShapeObj(e[0]));this._swapVal(i);break;case"changepicture":h=this._dataContainer;n("#"+i.id).css("background-image","url('"+i.prev.img+"')");ot.picture[i.prev.pcIdx].data=i.prev.data;this._swapVal(i);break;case"picturesize":e=n("#"+i.id);s={width:i.prev.width,height:i.prev.height,shapeType:"picture"};e.css(s);this.XLRibbon._setShapeWidthHeight(s);this._swapVal(i);break;case"chartTheme":for(v=this.element.find("#"+this._id+"_chart").val(),b=n("#"+this._id+"_Ribbon_ChartDesign_ChartThemes_ChartThemes").data("ejDropDownList"),i.prev.theme.indexOf("dark")>-1?n("#"+v).addClass("e-ss-charttheme"):n("#"+v).removeClass("e-ss-charttheme"),this.XLChart.refreshChart(v,{theme:i.prev.theme}),a=0,et=k.length;et>a;a++)if(i.prev.theme===k[a].value.toLowerCase()){nt=a;break}b&&b.option({selectedItemIndex:nt});this._swapVal(i);break;case"chartType":this.XLChart.refreshChart(i.chartId,{type:i.prev.chartType,enable3D:i.prev.enable3D,marker:i.prev.marker});this._swapVal(i);break;case"selectData":this.XLChart.changeDataRange(document.getElementById(this._id+"_chart").value,i.prev.xRange,i.prev.yRange,i.prev.lRange);this._swapVal(i)}},_undoForShowHide:function(n){var t,i,r,u,f,e,o;if(n.operation==="row"){for(r=this._getJSSheetRowHeaderContent(n.sheetIndex),n.action==="show"?this._hideRow(n.hideRows[0],n.hideRows[n.hideRows.length-1],"isRHide"):this._showRow(n.hideRows[0],n.hideRows[n.hideRows.length-1],"isRHide"),t=0,i=n.remBRows.length;t<i;t++)this.addClass(r.find("td")[n.remBRows[t]],"e-hrow"),this.XLEdit._updateDataContainer({rowIndex:n.remBRows[t],colIndex:0},{dataObj:{hRow:!0}});for(t=0,i=n.addBRows.length;t<i;t++)this._removeClass(r.find("td")[n.addBRows[t]],"e-hrow"),this._dataContainer.sheets[n.sheetIndex][n.addBRows[t]][0].hRow;this.setActiveCell(n.bSelect.startRow,0);n.bSelect.startRow===n.bSelect.endRow?this.XLSelection.selectRow(n.bSelect.startRow,n.sheetIndex):this.XLSelection.selectRows(n.bSelect.startRow,n.bSelect.endRow,n.sheetIndex);f=n.addBRows;n.addBRows=n.remBRows;n.remBRows=f}else{for(u=this._getJSSheetHeader(n.sheetIndex).find("th"),n.action==="show"?this._hideColumn(n.hideCols[0],n.hideCols[n.hideCols.length-1]):this._showColumn(n.hideCols[0],n.hideCols[n.hideCols.length-1]),t=0,i=n.remBCols.length;t<i;t++)this.XLEdit._updateDataContainer({rowIndex:0,colIndex:n.remBCols[t]},{dataObj:{hCol:!0}}),this.addClass(u[n.remBCols[t]],"e-hcol");for(t=0,i=n.addBCols.length;t<i;t++)this._removeClass(u[n.addBCols[t]],"e-hcol"),this._dataContainer.sheets[n.sheetIndex][0][n.addBCols[t]].hCol;this.setActiveCell(0,n.bSelect.startCol);n.bSelect.startCol===n.bSelect.endCol?this.XLSelection.selectColumn(n.bSelect.startCol,n.sheetIndex):this.XLSelection.selectColumns(n.bSelect.startCol,n.bSelect.endCol,n.sheetIndex);e=n.addBCols;n.addBCols=n.remBCols;n.remBCols=e}n.action=n.action==="show"?"hide":"show";o=n.bSelect;n.bSelect=n.aSelect;n.aSelect=o;this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForSort:function(n){var o=this.XLEdit.getColumnIndexByField(n.columnName),u,i,r,f,e=this.getSheet(n.sheetIndex)._filterColl,t;if(n.colSelected<1&&(f=n.range[0],n.range[0]>0&&(f=n.range[0]-1)),n.operation==="unsort"?(this._dupDetails=!0,this.XLComment.deleteComment(n.range,null,!0,null),this._removeHyperlink(null,null,!0,n.range),this.clearRangeData(n.range,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0),this.XLFormat.removeStyle(n.range,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0}),this.XLEdit.updateCellWithContainer(n.rangeData,n.range,n.sheetIndex,!0),this.XLSort._refreshRowHeight(n.range,n.rangeData),this._dupDetails=!1,n.operation="sort"):(this.XLSort._isSortByFilter=n.isSortByFilter,this.XLSort.sortByRange(n.range,n.columnName,n.direction),n.operation="unsort"),n.isSortByFilter)for(t=0;t<n.filterIcons.length;t++)r=e[n.filterIcons[t].rowIdx][n.filterIcons[t].colIdx],r.status=r.status.indexOf("-asc")>1?r.status.replace("-asc",n.filterIcons[t].prevIcon):r.status.indexOf("-dsc")>1?r.status.replace("-dsc",n.filterIcons[t].prevIcon):r.status+n.filterIcons[t].prevIcon,this._isRowViewable(n.sheetIndex,n.filterIcons[t].rowIdx)&&(i=this.getCell(n.filterIcons[t].rowIdx,n.filterIcons[t].colIdx).find(".e-filterspan")[0],i.className=i.className.indexOf("-asc")>1?i.className.replace("-asc",n.filterIcons[t].prevIcon):i.className.indexOf("-dsc")>1?i.className.replace("-dsc",n.filterIcons[t].prevIcon):i.className.indexOf("e-ssfiltered")>-1?i.className.replace("e-ssfiltered","e-ssfiltered"+n.filterIcons[t].prevIcon):i.className.replace("e-ssfilter","e-ssfilter"+n.filterIcons[t].prevIcon)),u=n.filterIcons[t].prevIcon,n.filterIcons[t].prevIcon=n.filterIcons[t].currIcon,n.filterIcons[t].currIcon=u},_undoForSortByColor:function(n){var t=n.range,r=n.prev.data,u=this._generateColCount(n.columnName)-1,i;this.XLComment.deleteComment(t,null,!0,null);this._isSort=!0;this._dupDetails=!0;this._removeHyperlink(null,null,!0,t);this._isSort=!1;this._dupDetails=!1;this.clearRangeData(t,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0);this.XLFormat.removeStyle(t,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0});this.XLEdit.updateCellWithContainer(r,t,n.sheetIndex,!0);n.oprType.indexOf("Put")<0&&(i=this.getCell(t[0]-1,u).find(".e-filterspan"),i.length>0&&(i[0].className=i[0].className.replace(n.cur.icon,n.prev.icon)));this._swapVal(n)},_undoForStyle:function(n){this.XLFormat.updateUniqueFormat(n.beforeFormat,n.range,n.opr);this._updateRangeStyle(n.range,n.beforeFormat);var t=this.changePosition(n.beforeFormat,n.afterFormat);this._refreshRangeTRHght(this.getActiveSheetIndex(),n.range);n.beforeFormat=t[1];n.afterFormat=t[0];this._isUndoRedo=!0;n.status="undo-cellstyles"},_undoForTextWrap:function(n){n.operation==="wrap"?(this.setWrapText("unwrap",n.range),n.operation="unwrap"):(this.setWrapText("wrap",n.range),n.operation="wrap");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForValidation:function(n){var i,f,e=this.getRangeIndices(n.range),r,u,s,o;if(this.performSelection({rowIndex:e[0],colIndex:e[1]},{rowIndex:e[2],colIndex:e[3]}),n.operation==="cl-hl-data")this.XLValidate.highlightInvalidData(n.range),n.operation="hl-data";else if(n.operation==="apply-validation"){for(r=n.selectedCell,o=[],i=0,f=r.length;i<f;i++)s=this.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"rule"),u=this.changePosition(r[i].prevRule,s),n.selectedCell[i].prevRule=u[1],t.isNullOrUndefined(u[0])||(u[0].customVal=u[0].customVal,this.XLEdit._updateDataContainer({rowIndex:r[i].rowIndex,colIndex:r[i].colIndex},{dataObj:{rule:u[0]}})),o.push(r[i]);t.isNullOrUndefined(u[0])&&this.clearRangeData(null,["rule"],o)}else if(n.operation==="hl-data")this.XLValidate.clearHighlightedValData(n.range),n.operation="cl-hl-data";else if(this._isUndo){for(i=0,f=n.selectedCell.length;i<f;i++)this.XLEdit._updateDataContainer({rowIndex:n.selectedCell[i].rowIndex,colIndex:n.selectedCell[i].colIndex},{dataObj:{rule:n.selectedCell[i].rules}});n.hlStatus&&this.XLValidate.highlightInvalidData(n.range)}else this.XLValidate.clearDV(n.range)},_applyCommentLink:function(i,r,u,f){var a=this._dataContainer,w=a.cFormatData,e,c=!1,l=this.getActiveSheetIndex(),v,y,o,h,p,s;if(this._isRowViewable(l,r.rowIndex)&&(e=this.getCell(r.rowIndex,r.colIndex),c=!0,n(e).removeClass("e-redft e-yellowft e-greenft e-redf e-redt")),i){if(v=this.isNumber(i.value2)?a.sharedData[i.value2]:i.value2,i=n.extend(!0,{},i),this.XLEdit._updateCellValue(r,v),"cFormatRule"in i)for(y=i.cFormatRule,h=0,p=y.length;h<p;h++)o=w[h].split("_"),this.XLCFormat._cFormat(o[0],o[2],o[3],o[4],null,null,[u,f,u,f]);"hyperlink"in i&&(s=i.hyperlink,c&&(s&&!s.webAddr?e.html(t.buildTag("a.e-hyperlinks",this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2",l),"")):e.html(t.buildTag("a.e-hyperlinks",this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2",l),"",{href:s.webAddr,target:"_blank"}))));"comment"in i&&(c&&e.removeClass("e-commentcell"),this.XLComment.setComment([r.rowIndex,r.colIndex,r.rowIndex,r.colIndex],null,!1))}},changePosition:function(n,i){var r=[];return r.push(i),r.push(n),t.swap(r,0,1),r},_addValidationRule:function(t,i){var u=[],r,f;for(n.extend(!0,u,t),r=0,f=t.length;r<f;r++)t[r].customVal!==i.customVal&&t[r].required!==i.required&&t[r].Number!==i.number&&u.push(i);return u},_addCondFormatRule:function(t,i){var f=!1,u=[],r,e;for(n.extend(!0,u,t),r=0,e=t.length;r<e;r++)if(i=i.indexOf("true")>-1?i.replace("_true",""):i.replace("_false",""),t[r]===i){f=!0;break}return f||u.push(i),u},getCellClass:function(n){var t=this._formatRegx;return n&&n.className.indexOf("e-format")>-1?n.className.match(t)[0]:""},_renderInsertDeleteDialog:function(){var n=this._id+"_insertdeletedlg",i,r,u,f,e,o;i=t.buildTag("div#"+n,"",{display:"none"});o=t.buildTag("div#"+n+"_content.e-dlg-fields e-dlgctndiv");i.append(o);f=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");e=t.buildTag("div");r=t.buildTag("input#"+n+"_okbtn","",{"margin-left":4});u=t.buildTag("input#"+n+"_cantn");r.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._insertDeleteOk,this),enabled:!0,cssClass:"e-ss-okbtn"});u.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._insertDeleteCancel,this),showRoundedCorner:!0,width:60});f.append(e.append(r,u));i.append(f);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,width:"auto",height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg e-ss-insdeldlg",minWidth:150})},_refreshInsDelDialog:function(t){var u,i=n("#"+this._id+"_insertdeletedlg"),r,f;i.ejDialog({title:this._getLocStr(t)});i.ejDialog("open");this._insDelStatus=t.toLowerCase();r=n("#"+i[0].id+"_content");f=this._insDelStatus==="insert"?["ShiftRight","ShiftBottom","EntireRow","EntireColumn"]:["ShiftLeft","ShiftUp","EntireRow","EntireColumn"];r.children().empty();this._createRadioButton(i,r,f);u=this._insDelStatus==="insert"?"ShiftBottom":"ShiftLeft";n("#"+i[0].id+"_"+u).ejRadioButton({checked:!0});i.find("input[type='submit']:first").focus()},_createRadioButton:function(n,i,r){var o,h,s,e,u,f,c;for(s=t.buildTag("table"),f=0,c=r.length;f<c;f++)e=t.buildTag("tr"),u=t.buildTag("td"),h=t.buildTag("label",this._getLocStr(r[f]),{"padding-bottom":4},{"for":n[0].id+"_"+r[f]}),o=t.buildTag("input#"+n[0].id+"_"+r[f],"",{},{type:"radio",name:"inserdelete"}),u.append(o),e.append(u),u=t.buildTag("td"),u.append(h),o.ejRadioButton({size:"medium"}),e.append(u),s.append(e);i.append(s)},_getSelectedOption:function(t){for(var u,f=this._id+"_insertdeletedlg",r=0,i=0;i<4;i++)if(u=n("#"+f+"_"+t[i]).data("ejRadioButton"),u.model.checked){r=i;break}return r},_insertDeleteOk:function(){var o,f;this._isUndo=!1;this._isUndoRedo=!1;this._delCells=[];this._deletedText=[];this._removeMergeColl=[];this._deletedDimension=[];var t,i,e=this.getActiveSheetIndex(),r=this.model.sheets[e]._selectedCells[0],u=this.model.sheets[e]._selectedCells[this.model.sheets[e]._selectedCells.length-1];for(this._insDelStatus.indexOf("insert")>-1?(t=["ShiftRight","ShiftBottom","EntireRow","EntireColumn"],i=this._getSelectedOption(t),t[i].indexOf("ShiftRight")>-1?this.insertShiftRight(r,u):t[i].indexOf("ShiftBottom")>-1?this.insertShiftBottom(r,u):t[i].indexOf("EntireRow")>-1?this.insertEntireRow(r.rowIndex,u.rowIndex):this.insertEntireColumn(r.colIndex,u.colIndex)):(t=["ShiftLeft","ShiftUp","EntireRow","EntireColumn"],i=this._getSelectedOption(t),t[i].indexOf("ShiftLeft")>-1?this.deleteShiftLeft(r,u):t[i].indexOf("ShiftUp")>-1?this.deleteShiftUp(r,u):t[i].indexOf("EntireRow")>-1?this.deleteEntireRow(r.rowIndex,u.rowIndex):this.deleteEntireColumn(r.colIndex,u.colIndex)),n("#"+this._id+"_insertdeletedlg").ejDialog("close"),o=this.model.sheets[this.model.activeSheetIndex].shapeMngr.chart,f=0;f<o.length;f++)this.XLChart._refreshChart(o[f])},_insertDeleteCancel:function(){n("#"+this._id+"_insertdeletedlg").ejDialog("close")},_undoredoDetails:function(t,i,r,u,f){var e={sheetIndex:t,startCell:i,endCell:r,reqType:u,action:f,delCells:n.extend(!0,[],this._delCells),text:this._deletedText,deletedDimension:this._deletedDimension,removeMerge:this._removeMergeColl,fRow:n.extend(!0,{},this._fRow),fCol:n.extend(!0,{},this._fCol)};this.isImport||this._isExport||this._intrnlReq||(this._completeAction(e),this._trigActionComplete(e));this._removeMergeColl=[];this._delCells=[];this._fRow.fRowCnt=0;this._fCol.fColCnt=0;this._fRow.rowAdj=!0;this._fCol.colAdj=!0},_getRangeFrmFormula:function(n){var t=n.substring(n.indexOf("(")+1,n.indexOf(")")),i=new RegExp("^\\b[a-zA-Z][0-9]*:[a-zA-Z][0-9]*\\b$","g");if(i.test(t))return t;if(t.indexOf(",")>1){if(i.test(t.split(",")[1]))return t.split(",")[1];if(i.test(t.replace(",",":")))return t.replace(",",":")}},_refreshFormula:function(n,i,r,u,f,e,o){var y=this.getActiveSheetIndex(),c,h,a=this.XLEdit.getPropertyValue(n,i,"value"),l,v,s,p,w=this.getSheet(y);if((!this._isUndo||this._formulaChanged.pop()!=="true")&&this.isFormula(a)){if(l=this._getRangeFrmFormula(a),t.isNullOrUndefined(l))return;s=this.getRangeIndices(l);c=f==="column"?u==="insert"?s[3]+r:s[3]-r:u==="insert"?s[2]+r:s[2]-r;h=f==="column"?u==="insert"?s[1]+r:s[1]-r:u==="insert"?s[0]+r:s[0]-r;f==="column"?e>s[1]&&(h=s[1]):e>s[0]&&(h=s[0]);f==="column"?e>s[3]&&(c=s[3]):e>s[2]&&(c=s[2]);o&&(s[1]===s[3]||s[0]!==s[2]||(f==="column"?s[1]===s[3]&&(c=s[3],h=s[1]):s[0]===s[2]&&(c=s[2],h=s[0])),f==="column"?c<s[1]&&(c=s[3]):c<s[0]&&(c=s[2]),f==="column"?h<s[1]&&(h=s[1]):h<s[0]&&(h=s[0]),f==="row"&&(u==="delete"?h<s[2]&&s[1]!=i&&(c=s[2],h=s[0]):s[1]!=i&&(c=s[2],h=s[0])),f==="column"&&(u==="delete"?h<s[3]&&s[0]!=n&&(c=s[3],h=s[1]):s[0]!=n&&(c=s[3],h=s[1])));v=f==="column"?this._getAlphaRange(y,s[0],h,s[2],c):this._getAlphaRange(y,h,s[1],c,s[3]);n===s[0]&&i===s[1]&&(v="#REF!",this._ref.push(l));this._isUndo&&l==="#REF!"&&(v=this._ref.pop());a=a.replace(l,v);p=new ValueChangedArgs(n+1,i+1,a);this._calcEngine.valueChanged(w.sheetInfo.value,p);this.XLEdit._updateDataContainer({rowIndex:n,colIndex:i},{dataObj:{value:a}});this._applyFormula(y,n,i);this._isUndo||(l===v?this._formulaChanged.push("true"):this._formulaChanged.push("false"))}},_applyFormula:function(n,i,r){var u,f=this.getSheet(n),e=f._formulaCollection[i];t.isNullOrUndefined(e)&&(f._formulaCollection[i]={});u=this._calcEngine.getFormulaInfoTable().values();f._formulaCollection[i][r]=u[u.length-1]},_clearFormula:function(n,t){var u,f,i,e=this.getActiveSheetIndex(),s=this.XLEdit.getPropertyValue(n,t,"value"),r,o;if(this.isFormula(s)){for(u=this.model.sheets[e]._formulaCollection[n][t],i=this._calcEngine.getFormulaInfoTable().values(),f=i.indexOf(u),i.splice(f,1),this._calcEngine.getFormulaInfoTable().clear(),r=0,o=i.length;r<o;r++)this._calcEngine.getFormulaInfoTable().add(i[r]);delete this.model.sheets[e]._formulaCollection[n][t]}},_refreshValAndCF:function(n,t,i,r,u,f,e){var o,w=this.getActiveSheetIndex(),v=this._dataContainer.sheets[w],h=this._dataContainer.cFormatData,l,a,y,s,p,c;this.isUndefined(i)&&this.isUndefined(r)?delete v[n][t]:(this.isUndefined(i)||(v[n][t]={rule:i}),this.isUndefined(r)||(o=h[r[0]],o.indexOf("true")>-1?(c=o.replace("true","false"),p=h.indexOf()):(c=o.replace("false","true"),p=h.indexOf(c)),a=o.split("_")[5],s=this.getRangeIndices(a),e.indexOf("Bottom")>-1||e.indexOf("Row")>-1?s[2]=s[2]+u:s[3]=s[3]+f,y=this._getAlphaRange(w,s[0],s[1],s[2],s[3]),o=o.replace(a,y),c=c.replace(a,y),h[r[0]]=o,h[p]=c,l=o.replace("true","false"),h.indexOf(l)<0&&h.push(l),v[n][t]={cFormatRule:[h.indexOf(l)]}))},_refreshRows:function(n){var t=this._getRowHdrTBody(n).find("tr"),i=this._getContTBody(n).find("tr");this.setRows([t,i],n)},_refreshFilterColl:function(t,i,r,u,f){var k,o,s,e=this.getSheet(t),g=e._filterColl,a=this.getObjectKeys(g),l,y,v,p,w,b,d,h,c;if(u==="row")if(f==="insert")for(h=a.length-1;h>=0;h--)o=parseInt(a[h]),o>=i&&(e._filterColl[o+r]=n.extend(!0,{},e._filterColl[o]),delete e._filterColl[o]);else for(h=0;h<a.length;h++)o=parseInt(a[h]),o>=i&&(e._filterColl[o-r]=n.extend(!0,{},e._filterColl[o]),delete e._filterColl[o]);else for(b=!1,d=this.model.scrollSettings.allowVirtualScrolling,h=0;h<a.length;h++)if(o=parseInt(a[h]),l=this.getObjectKeys(e._filterColl[o]),f==="insert")for(w=!1,c=l.length-1;c>=0;c--)k=l[c]-l[c-(c===0?0:1)],b=k===1||k===0?!0:!1,s=parseInt(l[c]),(s>=i||w)&&(w=!0,y=e._filterColl[o][s],y.status.indexOf("filtered")>-1&&(v=n.inArray(this._generateHeaderText(s+1),e._filteredColumns),v>-1&&e._filteredColumns.splice(v,1),p=n.inArray(this._generateHeaderText(s+r+1),e._filteredColumns),p<0&&e._filteredColumns.push(this._generateHeaderText(s+r+1))),e._filterColl[o][s+r]=n.extend(!0,{},e._filterColl[o][s]),d||this._isUndoRedo?b?(e._filterColl[o][s].status="e-ssfilter",this.XLEdit._updateDataContainer({rowIndex:o,colIndex:s},{dataObj:{isFilterHeader:!0,filterState:"filter",isFilterVisible:!0},sheetIdx:t})):delete e._filterColl[o][s]:delete e._filterColl[o][s],b||(w=!1));else for(c=0;c<l.length;c++)s=parseInt(l[c]),s>=i&&(y=e._filterColl[o][s],y.status.indexOf("filtered")>-1&&(v=n.inArray(this._generateHeaderText(s+1),e._filteredColumns),v>-1&&e._filteredColumns.splice(v,1),p=n.inArray(this._generateHeaderText(s-r+1),e._filteredColumns),p<0&&e._filteredColumns.push(this._generateHeaderText(s-r+1))),s-r>=0&&(e._filterColl[o][s-r]=n.extend(!0,{},e._filterColl[o][s])),delete e._filterColl[o][s])},_refreshDataContainer:function(r,u){var p,dt,w,gt,st,ht,e,s,y,ni,ti,ii,ot=0,ei=0,oi,lt,k,d,ci,li,ai=0,vi=0,o=this._dataContainer.sheets[r],si,wt,yi,c,l,a,ct,g,nt,rt,at=this.model.scrollSettings.allowVirtualScrolling,h=this.getSheet(r),bt=h.usedRange,ut=this.getFrozenRows(),ft=this.getFrozenColumns(),it,ri,ui,fi,f,b,pt,hi,tt,kt,et,vt,v,yt;for(lt=parseInt(this.getObjectKeys(o)[this.getObjectLength(o)-1]),v=h.rowsHeightCollection,vt=h.columnsWidthCollection,f=0;f<=lt;f++)t.isNullOrUndefined(o[f])||(oi=this.getObjectKeys(o[f]),ei=parseInt(oi[oi.length-1]),ei>ot&&(ot=ei));if(yi=u.startCol<=ot?u.colCount+u.startCol:ot-1,si=u.status.indexOf("shift")>-1?yi:ot-1,wt=u.status.indexOf("shift")>-1?u.rowCount+u.startRow:lt,p=u.startRow,dt=u.startRow+u.rowCount-1,w=u.startCol,gt=u.startCol+u.colCount-1,this._isFrozen(ut-1)&&ut>p){for(f=h._frozenRows-1;f<h._ftopRowIdx;f++)ai+=h.rowsHeightCollection[f];this._scrollContent({y:-ai})}if(this._isFrozen(ft-1)&&ft>w){for(f=h._frozenColumns-1;f<h._fleftColIdx;f++)vi+=h.columnsWidthCollection[f];this._scrollContent({x:-vi})}switch(u.status){case"insertRow":for(f=lt,y=u.startRow;f>=y;f--){if(!t.isNullOrUndefined(o[f])){if(o[f+u.rowCount]=n.extend(!0,{},o[f]),!t.isNullOrUndefined(o[f+u.rowCount]))for(a=this.getObjectKeys(o[f+u.rowCount]),e=0,ni=a.length;e<ni;e++)this._clearFormula(f,a[e]),this._checkIndicesInContainer(r,f,a[e],"wrap")&&(this._wrapCollection(f+u.rowCount,a[e],h._wrapColl[f][a[e]],r),delete h._wrapColl[f][a[e]]),f>=p&&f<=dt?(st=this._checkIndicesInContainer(r,p,a[e],"rule")?this._dataContainer.sheets[r][p][a[e]].rule:i,ht=this._checkIndicesInContainer(r,p,a[e],"cFormatRule")?this._dataContainer.sheets[r][p][a[e]].cFormatRule:i,this._refreshValAndCF(f,a[e],st,ht,u.rowCount,0,u.status),at||p<1||this.addClass(this.getCell(f,a[e])[0],this.XLFormat.getFormatClass(this.getCell(p-1,a[e])[0].className,!1))):delete o[f][a[e]],this._refreshFormula(f+u.rowCount,parseInt(a[e]),u.rowCount,"insert","row",u.startRow,!1),this.XLEdit._refreshCalcEngine(f+u.rowCount,parseInt(a[e]));this.getObjectLength(o[f])<1&&delete o[f]}v[f+u.rowCount]=v[f];v[f]=this.model.rowHeight;h._rowIdxColl[f+u.rowCount]=h._rowIdxColl[f]+u.rowCount}if(this._refreshHideRowColCollection(h.hideRowsCollection,u.startRow,u.rowCount,"row","insert"),this._refreshFilterColl(r,u.startRow,u.rowCount,"row","insert"),this._isUndo&&this._delCells.length>0){for(c=this._delCells,ct=c[c.length-1].row-c[0].row,f=0,y=c.length;f<y;f++){for(o[c[f].row]=c[f].value,a=this.getObjectKeys(o[c[f].row]),e=0,ni=a.length;e<ni;e++)this._refreshFormula(c[f].row,parseInt(a[e]),ct,"insert","row","",!1),this.XLEdit._refreshCalcEngine(c[f].row,parseInt(a[e])),this._checkIndicesInContainer(r,c[f].row,a[e],"wrap")&&this._wrapCollection(c[f].row,a[e],this._delWrapColl[c[f].row][a[e]],r);v[c[f].row]=c[f].height}this._delWrapColl={}}this.model.allowFreezing&&this._isFrozen(ut)&&(p<ut||this._isUndo&&this._fRow.fRowCnt>0)&&(k=h.frozenRows+(this._fRow.fRowCnt>0?this._fRow.fRowCnt:u.rowCount),d=h.frozenColumns,this._fRow.fRowCnt=0,this._fRow.rowAdj||(k-=1,this._fRow.rowAdj=!this._fRow.rowAdj),this._isFrozen(ft)?(this.XLFreeze.unfreezePanes(),this.XLFreeze.freezePanes(k,d)):this.XLFreeze.freezeRows(k));this.XLScroll._getRowHeights(r,u.startRow);break;case"insertColumn":for(ri=!1,f=0;f<=wt;f++)for(e=ot,y=u.startCol;e>=y;e--)g=nt=null,f==0&&(t.isNullOrUndefined(o[0])||t.isNullOrUndefined(o[0][e])||"isCHide"in o[0][e]&&(this._deleteRule(e,r),ri=!0)),t.isNullOrUndefined(o[f])||(t.isNullOrUndefined(o[f][e])||(t.isNullOrUndefined(o[f][e+u.colCount])||(t.isNullOrUndefined(o[f][e+u.colCount].picture)||(g=o[f][e+u.colCount].picture),t.isNullOrUndefined(o[f][e+u.colCount].chart)||(nt=o[f][e+u.colCount].chart)),o[f][e+u.colCount]=o[f][e],t.isNullOrUndefined(o[f][e].picture)&&t.isNullOrUndefined(o[f][e].chart)||(t.isNullOrUndefined(o[f][e].picture)||(g=o[f][e].picture),t.isNullOrUndefined(o[f][e].chart)||(nt=o[f][e].chart)),t.isNullOrUndefined(o[f][e+u.colCount])||(t.isNullOrUndefined(g)||(o[f][e+u.colCount].picture=g),t.isNullOrUndefined(nt)||(o[f][e+u.colCount].chart=nt)),o[f][e].wrap&&(this._wrapCollection(f,e+u.colCount,h._wrapColl[f][e],r),delete h._wrapColl[f][e])),this._clearFormula(f,e),e>=w&&e<=gt?(st=this._checkIndicesInContainer(r,f,w,"rule")?this._dataContainer.sheets[r][f][w].rule:i,ht=this._checkIndicesInContainer(r,f,w,"cFormatRule")?this._dataContainer.sheets[r][f][w].cFormatRule:i,this._refreshValAndCF(f,e,st,ht,0,u.colCount,u.status),at||!w<1&&this.addClass(this.getCell(f,e)[0],this.XLFormat.getFormatClass(this.getCell(f,w-1)[0].className,!1))):delete o[f][e],!t.isNullOrUndefined(o[f][e])||t.isNullOrUndefined(g)&&t.isNullOrUndefined(nt)||(o[f][e]={}),t.isNullOrUndefined(g)||(o[f][e].picture=g),t.isNullOrUndefined(nt)||(o[f][e].chart=nt),this._refreshFormula(f,e+u.colCount,u.colCount,"insert","column",u.startCol,!1),this.XLEdit._refreshCalcEngine(f,e+u.colCount)),f===0&&(ri&&(this._writeRule(e+u.colCount,r),ri=!1),at&&!this._isUndoRedo&&(vt[e+u.colCount]=vt[e],vt[e]=h.columnWidth));if(this._refreshHideRowColCollection(h.hideColsCollection,u.startCol,u.colCount,"column","insert"),this._refreshFilterColl(r,u.startCol,u.colCount,"column","insert"),this.model.allowFreezing&&this._isFrozen(ft)&&(w<ft||this._isUndo&&this._fCol.fColCnt>0)&&(k=h.frozenRows,d=h.frozenColumns+(this._fCol.fColCnt>0?this._fCol.fColCnt:u.colCount),this._fCol.fColCnt=0,this._fCol.colAdj||(d-=1,this._fCol.colAdj=!this._fCol.colAdj),this._isFrozen(ut)?(this.XLFreeze.unfreezePanes(),this.XLFreeze.freezePanes(k,d)):this.XLFreeze.freezeColumns(d)),this._isUndo&&this._delCells.length>0)for(c=this._delCells,ct=c[c.length-1].col-c[0].col,s=0,y=c.length;s<y;s++)t.isNullOrUndefined(o[c[s].row])&&(o[c[s].row]={}),o[c[s].row][c[s].col]=c[s].value,this._refreshFormula(c[s].row,c[s].col,ct,"insert","column","",!1),this.XLEdit._refreshCalcEngine(c[s].row,c[s].col),c[s].value.wrap&&this._wrapCollection(c[s].row,c[s].col,c[s].height,r);break;case"deleteRow":for(this._delCells=[],l=[],f=u.startRow;f<=lt;f++){if(f<u.startRow+u.rowCount){if(this._delCells.push({row:f,value:n.extend(!0,{},o[f]),height:v[f]}),!t.isNullOrUndefined(o[f]))for(a=this.getObjectKeys(o[f]),e=0,y=a.length;e<y;e++)this._clearFormula(f,a[e]),this._checkIndicesInContainer(r,f,a[e],"wrap")&&(this._delWrapColl[f]||(this._delWrapColl[f]={}),this._delWrapColl[f][a[e]]=n.extend(!0,{},h._wrapColl[f][a[e]]),delete h._wrapColl[f][a[e]]),o[f][a[e]]={};o[f]={};l.push({row:f})}if(!t.isNullOrUndefined(o[f+u.rowCount])){for(o[f]=n.extend(!0,{},o[f+u.rowCount]),a=this.getObjectKeys(o[f]),e=0,y=a.length;e<y;e++)this._checkIndicesInContainer(r,f+u.rowCount,a[e],"wrap")&&(this._wrapCollection(f,a[e],h._wrapColl[f+u.rowCount][a[e]],r),delete h._wrapColl[f+u.rowCount][a[e]]),this._clearFormula(f+u.rowCount,a[e]),o[f+u.rowCount][a[e]]={},this._refreshFormula(f,parseInt(a[e]),u.rowCount,"delete","row",u.startRow,!1),this.XLEdit._refreshCalcEngine(f,parseInt(a[e]));o[f+u.rowCount]={};l.push({row:f+u.rowCount})}this.isUndefined(v[f+u.rowCount])||(v[f]=v[f+u.rowCount],v[f+u.rowCount]=this.model.rowHeight,h._rowIdxColl[f]=h._rowIdxColl[f+u.rowCount]-u.rowCount)}for(this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal&&(v.splice(v.length-u.rowCount,u.rowCount),h._rowHeightCollection.splice(h._rowHeightCollection.length-u.rowCount,u.rowCount)),this._refreshHideRowColCollection(h.hideRowsCollection,u.startRow,u.rowCount,"row","delete"),s=0,y=l.length;s<y;s++)this.getObjectLength(o[l[s].row])===0&&(this._clearFormula(l[s].row,l[s].col),delete o[l[s].row]);if(this._refreshFilterColl(r,u.startRow,u.rowCount,"row","delete"),this.XLScroll._getRowHeights(r,u.startRow),this.model.allowFreezing&&this._isFrozen(ut)&&p<ut){if(dt>=ut)for(f=p;f<ut;f++)this._fRow.fRowCnt++;else this._fRow.fRowCnt=0;k=h.frozenRows-(this._fRow.fRowCnt>0?this._fRow.fRowCnt:u.rowCount);ci=h.frozenRows-(this._fRow.fRowCnt>0?this._fRow.fRowCnt:u.rowCount)-h._topRow.idx;d=h.frozenColumns;this._fRow.rowAdj=ci>1;this._isFrozen(ft)?(this.XLFreeze.unfreezePanes(),this.XLFreeze.freezePanes(this._fRow.rowAdj?k:k+1,d)):this.XLFreeze.freezeRows(this._fRow.rowAdj?k:1)}break;case"deleteColumn":for(this._delCells=[],l=[],ui=!1,fi=n.extend(!0,{},o[0]),f=0;f<=wt;f++){for(e=u.startCol;e<=ot;e++)g=nt=null,f==0&&(t.isNullOrUndefined(fi)||t.isNullOrUndefined(fi[e])||"isCHide"in fi[e]&&(this._deleteRule(e,r),ui=!0)),e<u.startCol+u.colCount&&(t.isNullOrUndefined(o[f])||t.isNullOrUndefined(o[f][e])||(this._delCells.push({row:f,col:e,value:n.extend(!0,{},o[f][e],o[f][e].wrap?h._wrapColl[f][e]:v[f])}),this._clearFormula(f,e),o[f][e]={},t.isNullOrUndefined(this._delCells[this._delCells.length-1])||(rt=this._delCells.length-1,t.isNullOrUndefined(this._delCells[rt].value.picture)||(o[f][e].picture=this._delCells[rt].value.picture),t.isNullOrUndefined(this._delCells[rt].value.chart)||(o[f][e].chart=this._delCells[rt].value.chart)),l.push({row:f,col:e}),h._wrapColl[f]&&delete h._wrapColl[f][e])),t.isNullOrUndefined(o[f])||t.isNullOrUndefined(o[f][e+u.colCount])||(o[f][e]=n.extend(!0,{},o[f][e+u.colCount]),o[f][e+u.colCount].wrap&&(this._wrapCollection(f,e,h._wrapColl[f][e+u.colCount],r),delete h._wrapColl[f][e+u.colCount]),t.isNullOrUndefined(o[f][e+u.colCount].picture)||(g=o[f][e+u.colCount].picture),t.isNullOrUndefined(o[f][e+u.colCount].chart)||(nt=o[f][e+u.colCount].chart),this._clearFormula(f,e+u.colCount),o[f][e+u.colCount]={},t.isNullOrUndefined(g)||(o[f][e+u.colCount].picture=g),t.isNullOrUndefined(nt)||(o[f][e+u.colCount].chart=nt),t.isNullOrUndefined(this._delCells[this._delCells.length-1])||(rt=this._delCells.length-1,t.isNullOrUndefined(this._delCells[rt].value.picture)||(o[f][e].picture=this._delCells[rt].value.picture),t.isNullOrUndefined(this._delCells[rt].value.chart)||(o[f][e].chart=this._delCells[rt].value.chart)),l.push({row:f,col:e+u.colCount}),this._refreshFormula(f,e,u.colCount,"delete","column",u.startCol,!1),this.XLEdit._refreshCalcEngine(f,e),at||this.XLComment&&(this._isRowViewable(r,f)&&this._removeClass(this.getCell(f,e),"e-commentcell"),this.XLComment._updateCmntFrmCntnr(f,e))),f==0&&ui&&(this._writeRule(e-u.colCount,r),ui=!1);for(s=0,y=l.length;s<y;s++)this.getObjectLength(o[l[s].row][l[s].col])===0&&(this._clearFormula(l[s].row,l[s].col),delete o[l[s].row][l[s].col]);l=[]}if(this._refreshHideRowColCollection(h.hideColsCollection,u.startCol,u.colCount,"column","delete"),this.model.allowFreezing&&this._isFrozen(ft)&&w<ft){if(gt>=ft)for(f=w;f<ft;f++)this._fCol.fColCnt++;else this._fCol.fColCnt=0;k=h.frozenRows;d=h.frozenColumns-(this._fCol.fColCnt>0?this._fCol.fColCnt:u.colCount);li=h.frozenColumns-(this._fCol.fColCnt>0?this._fCol.fColCnt:u.colCount)-h._leftCol.idx;this._fCol.colAdj=li>1;this._isFrozen(ut)?(this.XLFreeze.unfreezePanes(),this.XLFreeze.freezePanes(k,this._fCol.colAdj?d:d+1)):this.XLFreeze.freezeColumns(this._fCol.colAdj?d:1)}this._refreshFilterColl(r,u.startCol,u.colCount,"column","delete");break;case"shiftRight":for(f=u.startRow;f<wt;f++)for(e=ot,y=u.startCol;e>=y;e--)t.isNullOrUndefined(o[f])||t.isNullOrUndefined(o[f][e])||(o[f][e+u.colCount]=n.extend(!0,{},o[f][e]),o[f][e].wrap&&(this._wrapCollection(f,e+u.colCount,h._wrapColl[f][e],r),delete h._wrapColl[f][e]),this._clearFormula(f,e),e>=w&&e<=gt?(this._checkIndicesInContainer(r,f,w,"rule")&&(st=this._dataContainer.sheets[r][f][w].rule),this._checkIndicesInContainer(r,f,w,"cFormatRule")&&(ht=this._dataContainer.sheets[r][f][w].cFormatRule),this._refreshValAndCF(f,e,st,ht,0,u.colCount,u.status),w<1||this.addClass(this.getCell(f,e)[0],this.XLFormat.getFormatClass(this.getCell(f,w-1)[0].className,!1))):delete o[f][e],this._refreshFormula(f,e+u.colCount,u.colCount,"insert","column",u.startCol,!0),this.XLEdit._refreshCalcEngine(f,e+u.colCount),this.XLEdit._refreshCalcEngine(f,e));if(this._isUndo&&this._delCells.length>0)for(c=this._delCells,ct=c[c.length-1].col-c[0].col,s=0,y=c.length;s<y;s++)o[c[s].row][c[s].col]=c[s].value,this._refreshFormula(c[s].row,c[s].col,ct,"insert","column",u.startRow,!1),this.XLEdit._refreshCalcEngine(c[s].row,c[s].col),at||this.XLComment&&this.XLComment._updateCmntFrmCntnr(c[s].row,c[s].col),c[s].value.wrap&&this._wrapCollection(c[s].row,c[s].col,c[s].height,r);break;case"shiftLeft":for(this._delCells=[],l=[],f=u.startRow;f<wt;f++){for(e=u.startCol;e<=ot;e++)e<u.startCol+u.colCount&&!t.isNullOrUndefined(o[f])&&(t.isNullOrUndefined(o[f][e])||(this._delCells.push({row:f,col:e,value:n.extend(!0,{},o[f][e]),height:o[f][e].wrap?h._wrapColl[f][e]:v[f]}),this._clearFormula(f,e),o[f][e].wrap&&delete h._wrapColl[f][e],o[f][e]={},l.push({row:f,col:e}))),t.isNullOrUndefined(o[f])||t.isNullOrUndefined(o[f][e+u.colCount])||(o[f][e]=n.extend(!0,{},o[f][e+u.colCount]),o[f][e+u.colCount].wrap&&(this._wrapCollection(f,e,h._wrapColl[f][e+u.colCount],r),delete h._wrapColl[f][e+u.colCount]),tt=this.getCell(f+u.rowCount,e),it=this.getCell(f,e),tt&&(ti=tt[0].outerHTML,this.clearTextNode(tt)),it&&(ii=it[0].outerHTML,this.clearTextNode(it,this.XLEdit.getPropertyValue(f,e,"value2"))),l.push({row:f,col:e+u.colCount}),this._clearFormula(f,e+u.colCount),o[f][e+u.colCount]={},this._refreshFormula(f,e,u.colCount,"delete","column",u.startCol,!0),tt&&(tt[0].outerHTML=ti),it&&(it[0].outerHTML=ii)),this.XLEdit._refreshCalcEngine(f,e);for(s=0,y=l.length;s<y;s++)this.getObjectLength(o[l[s].row][l[s].col])===0&&(this._clearFormula(l[s].row,l[s].col),this.XLEdit._refreshCalcEngine(l[s].row,l[s].col),delete o[l[s].row][l[s].col]);l=[]}break;case"shiftBottom":for(vt=this.getSheet(r).columnsWidthCollection,v=this.getSheet(r).rowsHeightCollection,f=lt,y=u.startRow;f>=y;f--){for(et=this._checkIndicesInContainer(r,f,0,"wrapRow"),e=u.startCol;e<si;e++)t.isNullOrUndefined(o[f])||t.isNullOrUndefined(o[f][e])||(t.isNullOrUndefined(o[f+u.rowCount])&&(o[f+u.rowCount]={}),et&&(yt=h._wrapColl[f][e],v[f+u.rowCount]=t.max([yt,v[f+u.rowCount]]),this._checkIndicesInContainer(r,f+u.rowCount,0,"wrapRow")||this.XLEdit._updateDataContainer({rowIndex:f+u.rowCount,colIndex:0},{dataObj:{wrapRow:!0}}),this._wrapCollection(f+u.rowCount,e,yt,r)),o[f+u.rowCount][e]=n.extend(!0,{},o[f][e]),this._clearFormula(f,e),f>=p&&f<=dt?(this._checkIndicesInContainer(r,p,e,"rule")&&(st=this._dataContainer.sheets[r][p][e].rule),this._checkIndicesInContainer(r,p,e,"cFormatRule")&&(ht=this._dataContainer.sheets[r][p][e].cFormatRule),this._refreshValAndCF(f,e,st,ht,u.rowCount,0,u.status),at||p<1||this.addClass(this.getCell(f,e)[0],this.XLFormat.getFormatClass(this.getCell(p-1,e)[0].className,!1))):delete o[f][e],et&&delete h._wrapColl[f][e],this._refreshFormula(f+u.rowCount,e,u.rowCount,"insert","row",u.startRow,!0)),this.XLEdit._refreshCalcEngine(f,e),this.XLEdit._refreshCalcEngine(f+u.rowCount,e);et&&(v[f]=t.max(this._getObjectValues(h._wrapColl[f])),v[f]||(v[f]=this.model.rowHeight),this.getObjectLength(h._wrapColl[f])||delete this._dataContainer.sheets[r][f][0].wrapRow);t.isNullOrUndefined(o[f])||this.getObjectLength(o[f])===0&&delete o[f]}if(this._isUndo&&this._delCells.length>0)for(c=this._delCells,ct=c[c.length-1].row-c[0].row,f=0,y=c.length;f<y;f++)b=c[f].row,pt=c[f].col,t.isNullOrUndefined(o[b])&&(o[b]={}),o[b][pt]=c[f].value,this._refreshFormula(b,pt,ct,"insert","row",u.startRow,!0),this.XLEdit._refreshCalcEngine(b,pt),et=this._checkIndicesInContainer(r,b,0,"wrapRow"),hi=c[f].value.wrap,(et||hi)&&(yt=hi?c[f].height:this.model.rowHeight,v[b]=t.max([yt,v[b]]),this._checkIndicesInContainer(r,b,0,"wrapRow")||this.XLEdit._updateDataContainer({rowIndex:b,colIndex:0},{dataObj:{wrapRow:!0}}),this._wrapCollection(b,pt,yt,r)),at||this.XLComment&&this.XLComment._updateCmntFrmCntnr(b,pt);break;case"shiftUp":for(l=[],vt=this.getSheet(r).columnsWidthCollection,v=this.getSheet(r).rowsHeightCollection,f=u.startRow;f<=lt;f++){for(kt=this._checkIndicesInContainer(r,f,0,"wrapRow"),et=this._checkIndicesInContainer(r,f+u.rowCount,0,"wrapRow"),e=u.startCol;e<si;e++)f<u.startRow+u.rowCount&&!t.isNullOrUndefined(o[f])&&(t.isNullOrUndefined(o[f][e])||(this._delCells.push({row:f,col:e,value:n.extend(!0,{},o[f][e]),height:kt?h._wrapColl[f][e]:v[f]}),this._clearFormula(f,e),o[f][e]={},l.push({row:f,col:e}),kt&&delete h._wrapColl[f][e])),t.isNullOrUndefined(o[f+u.rowCount])?v[f+u.rowCount]=this.model.rowHeight:t.isNullOrUndefined(o[f+u.rowCount][e])||(t.isNullOrUndefined(o[f])&&(o[f]={}),o[f][e]=n.extend(!0,{},o[f+u.rowCount][e]),et&&(this._wrapCollection(f,e,h._wrapColl[f+u.rowCount][e],r),delete h._wrapColl[f+u.rowCount][e]),tt=this.getCell(f+u.rowCount,e),it=this.getCell(f,e),tt&&(ti=tt[0].outerHTML,this.clearTextNode(tt)),it&&(ii=it[0].outerHTML,this.clearTextNode(it,this.XLEdit.getPropertyValue(f,e,"value2"))),this._clearFormula(f+u.rowCount,e),o[f+u.rowCount][e]={},l.push({row:f+u.rowCount,col:e}),this._refreshFormula(f,e,u.rowCount,"delete","row",u.startRow,!0),tt&&(tt[0].outerHTML=ti),it&&(it[0].outerHTML=ii)),this.XLEdit._refreshCalcEngine(f,e);kt&&this.getObjectLength(h._wrapColl[f])<1&&delete this._dataContainer.sheets[r][f][0].wrapRow;et&&(this.XLEdit._updateDataContainer({rowIndex:f,colIndex:0},{dataObj:{wrapRow:!0}}),v[f+u.rowCount]=t.max(this._getObjectValues(h._wrapColl[f+u.rowCount])),v[f+u.rowCount]||(v[f+u.rowCount]=this.model.rowHeight),this.getObjectLength(h._wrapColl[f+u.rowCount])||delete this._dataContainer.sheets[r][f+u.rowCount][0].wrapRow);(kt||et)&&(v[f]=t.max(this._getObjectValues(h._wrapColl[f])),v[f]||(v[f]=this.model.rowHeight))}for(s=0,y=l.length;s<y;s++)this.getObjectLength(o[l[s].row][l[s].col])===0&&(this._clearFormula(l[s].row,l[s].col),delete o[l[s].row][l[s].col]),this.getObjectLength(o[l[s].row])===0&&delete o[l[s].row]}u.status.indexOf("insert")>-1&&(bt.rowIndex=bt.rowIndex+u.rowCount,bt.colIndex=bt.colIndex+u.colCount,this.getSheet(r).usedRange=bt)},_undoInsDelMerge:function(){if(this._isUndo){this._dupDetails=!0;for(var n=0,t=this._removeMergeColl.length;n<t;n++)this.mergeCenter=this._removeMergeColl[n].merge.isCenterAlign,this.mergeCells(this._removeMergeColl[n].merge.mRange,!0);this._dupDetails=!1}},_updateCommentColl:function(n){this.getSheet(n)._commentColl={};this._isInsdel=!0;this.XLComment._updateCmntArrowPos();this._isInsdel=!1},insertShiftRight:function(n,t){if(this.model.allowInsert&&!this.model.isReadOnly){var r,f=!1,u=this.getActiveSheetIndex(),i;this._isUndo?(r="shiftLeft",this._insDelStatus="delete"):(r="shiftRight",this._insDelStatus="insert");i={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:r};this.model.allowFiltering&&this.XLFilter._checkFilterApplied(u,n.rowIndex,i.rowCount,n.colIndex,i.colCount,r);this._checkTableApplied(u,n.rowIndex,i.rowCount,n.colIndex,i.colCount,r);this._isFilterApplied||this._isTableApplied?this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630):(f=this._clearAllMergeCells(u,n.rowIndex,i.rowCount,n.colIndex,i.colCount,r),f.isAlert?this._insertShiftRight(u,n,t,i):(this._insData={sheetIdx:u,startCell:n,endCell:t,value:i},this._isUndoRedo?this._refreshMergeCells():this._showAlertDlg("Alert","MergeInsertAlert","MergeInsertDelete",498)),this._undoInsDelMerge())}},_insertShiftRight:function(t,i,r,u){var o,l=r.colIndex-i.colIndex+1,a=this.getRows(t)[1],v=this._getJSSheetHeader(t).find("col"),y=this._getContent(t).find("col"),s,h,e,f,c;if(this._isUndo){for(h=i.rowIndex;h<=r.rowIndex;h++)for(o=n(a[this._getRowIdx(h)]).find("td"),s=o.length-1,e=i.colIndex;e<=s-l;e++)o[e].outerHTML=o[e+l].outerHTML;for(f=s;f>s-l;f--)for(v.eq(f).remove(),y.eq(f).remove(),c=0;c<a.length;c++)n(a[this._getRowIdx(c)]).find("td:eq("+f+")").remove()}else this.XLScroll._createNewColumn(t,i,r,"shift");this.performSelection(i,r);this._refreshDataContainer(t,u);this._isUndo?this._refreshAllMergeCells(t,-1,0,i.colIndex,u.colCount,"delete"):this._refreshAllMergeCells(t,-1,0,i.colIndex,u.colCount,"insert");this.model.allowComments&&this._updateCommentColl(t);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._isUndoRedo||this._undoredoDetails(t,i,r,"insert","insertShiftRight");this._refreshRows(t)},insertShiftBottom:function(n,t){if(this.model.allowInsert&&!this.model.isReadOnly){var f=!1,r=this.getActiveSheetIndex(),u,i;if(u=this._isUndo?"shiftUp":"shiftBottom",i={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:u},this.model.allowFiltering&&this.XLFilter._checkFilterApplied(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u),this._checkTableApplied(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u),this._isFilterApplied||this._isTableApplied)if(this._isTotalRow)if(this._isUndoRedo)this._isUndoRedo=this._dupDetails=!0,this._isUndo||this.insertEntireRow(this._insRows.startRow,this._insRows.endRow),this._isUndoRedo=!1;else return this._showAlertDlg("","TotalRowAlert","TotalRow",630),!0;else this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630);else f=this._clearAllMergeCells(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u),f.isAlert?this._insertShiftBottom(r,n,t,i):(this._insData={sheetIdx:r,startCell:n,endCell:t,value:i},this._isUndoRedo?this._refreshMergeCells():this._showAlertDlg("Alert","MergeInsertAlert","MergeInsertDelete",498)),this._undoInsDelMerge()}},_insertShiftBottom:function(t,i,r,u){var w=this.model.scrollSettings.allowVirtualScrolling,f,e,c,a;if(this._refreshDataContainer(t,u),w)this._refreshViewport(this.getSheet(t)._scrollTop,t);else{var h,s,l,v=this.getSheet(t).rowsHeightCollection,p=this.getRows(t),o=p[1],y=p[0];if(this._isUndo){for(o=this._getContent(t).find("tbody").get(0).rows,f=i.rowIndex,a=o.length;f<a;f++){if(h=f+(r.rowIndex-i.rowIndex+1),l=n(o[f]).find("td"),h<o.length)for(s=n(o[h]).find("td"),e=i.colIndex;e<=r.colIndex;e++)l[e].outerHTML=s[e].outerHTML,s[e].innerHTML="";o[f].style.height=v[f]+"px";y[f].style.height=v[f]+"px"}for(e=i.colIndex;e<=r.colIndex;e++)for(c=a-1,length=a-1-(r.rowIndex-i.rowIndex+1);c>length;c--)n(o[c]).remove(),n(y[c]).remove(),this.model.sheets[t].rowCount=this.model.sheets[t].rowCount-1;this.XLScroll._refreshScroller(1,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"all")}else{for(f=i.rowIndex;f<=r.rowIndex;f++)this.XLScroll._createNewRow(t,-1,-1,"insert");for(f=o.length-1;f>=i.rowIndex;f--){if(h=f-(r.rowIndex-i.rowIndex+1),l=n(o[f]).find("td"),h>=i.rowIndex)for(s=n(o[h]).find("td"),e=i.colIndex;e<=r.colIndex;e++)l[e].outerHTML=s[e].outerHTML,s[e].innerHTML="",l[e].className=s[e].className,s[e].className="e-rowcell e-wrapword";o[f].style.height=v[f]+"px";y[f].style.height=v[f]+"px"}}this._refreshRows(t)}this.XLScroll._getRowHeights(t,i.rowIndex);this.performSelection(i,r);this.model.allowComments&&this._updateCommentColl(t);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._isUndo?this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"delete"):this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"insert");this._isUndoRedo||this._dupDetails||this._undoredoDetails(t,i,r,"insert","insertShiftBottom")},insertEntireRow:function(t,i){var h,v,c,l;if(this.model.allowInsert&&!this.model.isReadOnly){var y=this.model.scrollSettings.allowVirtualScrolling,u,a,o,e,r=this.getActiveSheetIndex(),f=this.getSheet(r),k=f.rowsHeightCollection,p=f._isRowSelected,s=f._selectedCells,w=s[0].colIndex,b=s[s.length-1].colIndex;if(this._isUndo?(o="deleteRow",this._insDelStatus="delete"):(o="insertRow",this._insDelStatus="insert"),e={startCol:0,colCount:f.colCount,startRow:t,rowCount:i-t+1,status:o},this.XLRibbon._isDirtySelect||this.model.allowFiltering&&this.XLFilter._checkFilterApplied(r,t,e.rowCount,0,f.colCount,o)){this._showAlertDlg("Alert","InsertDeleteAlert",440);return}if(this._clearAllMergeCells(r,t,e.rowCount,-1,0,o),this._refreshDataContainer(r,e),this._isUndo?this._batchDeleteRow(t,i,r,!0):this._batchAddRow(t,i,r),y)this.model.allowFiltering&&this.XLFilter._updateFilterCollection(r,t,i-t,"row",this._insDelStatus),f.rowCount=this._isUndo?f.rowCount-e.rowCount:f.rowCount+e.rowCount,this.refreshContent(r);else{if(this._isUndo){for(h=this.getRows(r),v=h[1],c=h[0],u=i;u>=t;u--)n(v[u]).remove(),n(c[u]).remove(),f.rowCount=f.rowCount-1;for(l=c.find("td"),u=0,a=l.length;u<a;u++)n(l[u]).text(u+1)}else for(u=t;u<=i;u++)this.XLScroll._createNewRow(r,u,0,"insert");this.model.allowFiltering&&this.XLFilter._updateFilterCollection(r,t,i-t,"row",this._insDelStatus);this.XLScroll._getRowHeights(r,t);this._refreshRows(r)}this._isFrozen(f.frozenRows)&&(t<f._frozenRows||i<f._frozenRows)&&this.XLFreeze._refreshFreezeRowDiv();this._isUndo?this._refreshAllMergeCells(r,t,e.rowCount,-1,0,"delete"):this._refreshAllMergeCells(r,t,e.rowCount,-1,0,"insert");p?this.XLSelection.selectRows(t,i):this.performSelection({rowIndex:t,colIndex:w},{rowIndex:i,colIndex:b});this.model.allowComments&&this._updateCommentColl(r);this._isUndoRedo||this._dupDetails||this._undoredoDetails(r,{rowIndex:t,colIndex:0},{rowIndex:i,colIndex:f.colCount-1},"insert","insertRow")}},insertEntireColumn:function(n,t){if(this.model.allowInsert&&!this.model.isReadOnly){var e,c=this.model.scrollSettings.allowVirtualScrolling,f,i=this.getActiveSheetIndex(),u,r=this.getSheet(i),a=r._isColSelected,o,s,h=r._selectedCells,v=h[0].rowIndex,y=h[h.length-1].rowIndex,l=r.columnsWidthCollection;if(this._isUndo?(this._insDelStatus="delete",f="deleteColumn"):(f="insertColumn",this._insDelStatus="insert"),!r._isTemplate||!(n<r._templateColCount||t<r._templateColCount)){if(u={startCol:n,colCount:t-n+1,startRow:0,rowCount:r.rowCount,status:f},this.XLRibbon._isDirtySelect||this.model.allowFiltering&&this.XLFilter._checkFilterApplied(i,u.startRow,r.rowCount,n,u.colCount,f)){this._showAlertDlg("Alert","InsertDeleteAlert",440);return}if(this._clearAllMergeCells(i,-1,0,n,u.colCount,f),f==="deleteColumn"&&c)for(e=t;e>=n;e--)l.splice(e,1),l.push(r.columnWidth);o={rowIndex:v,colIndex:n};s={rowIndex:y,colIndex:t};c?(this._refreshDataContainer(i,u),this.refreshContent(i)):(this.XLScroll._createNewColumn(i,o,s,"insert"),this._refreshDataContainer(i,u));this._isUndo?this._refreshAllMergeCells(i,-1,0,n,u.colCount,"delete"):this._refreshAllMergeCells(i,-1,0,n,u.colCount,"insert");this.model.allowFiltering&&this.XLFilter._updateFilterCollection(i,n,t-n,"column",this._insDelStatus);this._isFrozen(r.frozenColumns)&&(n<r._frozenColumns||t<r._frozenColumns)&&this.XLFreeze._refreshFreezeColDiv();this._isUndoRedo||this._undoredoDetails(i,o,s,"insert","insertColumn");this.model.allowComments&&this._updateCommentColl(i);a?this.XLSelection.selectColumns(n,t):this.performSelection(o,s);this._refreshRows(i);this._isAutoWHMode&&this._autoSSWidthHeight(i)}}},deleteShiftLeft:function(n,t){if(this.model.allowDelete&&!this.model.isReadOnly){var f=!1,u=this.getActiveSheetIndex(),r,i;this._isUndo?(this._insDelStatus="insert",r="shiftRight"):(this._insDelStatus="delete",r="shiftLeft");i={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:r};this.model.allowFiltering&&this.XLFilter._checkFilterApplied(u,n.rowIndex,i.rowCount,n.colIndex,i.colCount,r);this._checkTableApplied(u,n.rowIndex,i.rowCount,n.colIndex,i.colCount,r);this._isFilterApplied||this._isTableApplied?this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630):(f=this._clearAllMergeCells(u,n.rowIndex,i.rowCount,n.colIndex,i.colCount,r),f.isAlert?f.isCancel||this._deleteShiftLeft(u,n,t,i):(this._insData={sheetIdx:u,startCell:n,endCell:t,value:i},this._isUndoRedo?this._refreshMergeCells():this._showAlertDlg("Alert","MergeInsertAlert","MergeInsertDelete",498)),this._undoInsDelMerge())}},_deleteShiftLeft:function(t,i,r,u){var o,s,f,e,h,c=r.colIndex-i.colIndex+1,a=this.getRows(t)[1],l=[],v;if(this._isUndo)for(n.extend(!0,l,this._deletedText),o=i.rowIndex;o<=r.rowIndex;o++){for(h=this._getRowIdx(o),f=n(a[h]).find("td"),v=f.length-1,e=v-c;e>i.colIndex-1;e--)f[e+c].outerHTML=f[e].outerHTML;for(s=i.colIndex;s<=r.colIndex;s++)f[s].outerHTML=l.shift()}else for(this._insDelStatus="delete",o=i.rowIndex;o<=r.rowIndex;o++){for(h=this._getRowIdx(o),f=n(a[h]).find("td"),s=i.colIndex;s<=r.colIndex;s++)l.push(f[s].outerHTML);for(e=i.colIndex,length=f.length;e<length-c;e++)f[e].outerHTML=f[e+c].outerHTML}this.performSelection(i,r);this._refreshDataContainer(t,u);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._deletedText=l;this.model.allowComments&&this._updateCommentColl(t);this._isUndo?this._refreshAllMergeCells(t,-1,0,i.colIndex,u.colCount,"insert"):this._refreshAllMergeCells(t,-1,0,i.colIndex,u.colCount,"delete");this._isUndoRedo||this._undoredoDetails(t,i,r,"delete","deleteShiftLeft");this._refreshRows(t)},deleteShiftUp:function(n,t){if(this.model.allowDelete&&!this.model.isReadOnly){var f=!1,r=this.getActiveSheetIndex(),u,i;if(u=this._isUndo?"shiftBottom":"shiftUp",i={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:u},this.model.allowFiltering&&this.XLFilter._checkFilterApplied(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u),this._checkTableApplied(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u),this._isFilterApplied||this._isTableApplied){if(this._isTotalRow)return;this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630)}else f=this._clearAllMergeCells(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u),f.isAlert?f.isCancel||this._deleteShiftUp(r,n,t,i):(this._insData={sheetIdx:r,startCell:n,endCell:t,value:i},this._isUndoRedo?this._refreshMergeCells():this._showAlertDlg("Alert","MergeInsertAlert","MergeInsertDelete",498)),this._undoInsDelMerge()}},_deleteShiftUp:function(t,i,r,u){var b=this.model.scrollSettings.allowVirtualScrolling,f,e,y,a=[],c,s;if(this._refreshDataContainer(t,u),b)this._refreshViewport(this.getSheet(t)._scrollTop,t);else{var h,l,v=this.getSheet(t).rowsHeightCollection,p=this.getRows(t),o=p[1],w=p[0];if(!this._isUndo||this._isTotalRow)for(f=i.rowIndex,y=o.length;f<y;f++){if(c=f+(r.rowIndex-i.rowIndex+1),s=this._getRowIdx(f),h=n(o[s]).find("td"),c<o.length)for(l=n(o[this._getRowIdx(c)]).find("td"),e=i.colIndex;e<=r.colIndex;e++)a.push(h[e].outerHTML),h[e].outerHTML=l[e].outerHTML,l[e].innerHTML="";o[s].style.height=v[f]+"px";w[s].style.height=v[f]+"px"}else{for(n.extend(!0,a,this._deletedText),f=o.length-1;f>=i.rowIndex;f--){if(c=f-(r.rowIndex-i.rowIndex+1),s=this._getRowIdx(f),h=n(o[s]).find("td"),c>=i.rowIndex)for(l=n(o[this._getRowIdx(c)]).find("td"),e=i.colIndex;e<=r.colIndex;e++)h[e].outerHTML=l[e].outerHTML,l[e].innerHTML="";o[s].style.height=v[f]+"px";w[s].style.height=v[f]+"px"}for(f=i.rowIndex;f<=r.rowIndex;f++)for(h=n(o[this._getRowIdx(f)]).find("td"),e=i.colIndex;e<=r.colIndex;e++)h[e].outerHTML=a.shift()}this._refreshRows(t)}this.XLScroll._getRowHeights(t,i.rowIndex);this.performSelection(i,r);this.model.allowComments&&this._updateCommentColl(t);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._deletedText=a;this._isUndo?this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"insert"):this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"delete");this._isUndoRedo||this._dupDetails||this._undoredoDetails(t,i,r,"delete","deleteShiftUp")},deleteEntireRow:function(t,i){if(this.model.allowDelete&&!this.model.isReadOnly){var k=this.model.scrollSettings.allowVirtualScrolling,f,v,s,r=this.getActiveSheetIndex(),u=this.getSheet(r),c=u._selectedCells,d=c[0].colIndex,g=c[c.length-1].colIndex,nt=u.rowsHeightCollection;if(this._isUndo?(this._insDelStatus="insert",s="insertRow"):(s="deleteRow",this._insDelStatus="delete"),e={startCol:0,colCount:u.colCount,startRow:t,rowCount:i-t+1,status:s},!this._isUndoRedo&&(this.XLRibbon._isDirtySelect||this.model.allowFiltering&&this.XLFilter._checkFilterApplied(r,t,e.rowCount,0,u.colCount,s))){this._showAlertDlg("Alert","InsertDeleteAlert",440);return}if(this._clearAllMergeCells(r,t,e.rowCount,-1,0,s),this._refreshDataContainer(r,e),this._isUndo?this._batchAddRow(t,i,r,!0):this._batchDeleteRow(t,i,r),k)this.model.scrollSettings.scrollMode==="normal"&&(u.rowCount=this._isUndo?u.rowCount+e.rowCount:u.rowCount-e.rowCount),this.refreshContent(r);else{var l,o,y,h=[],p,e,w=this.getRows(r),a=w[1],b=w[0];if(this._isUndo){for(n.extend(!0,h,this._deletedText),f=t;f<=i;f++)o=this._getRowIdx(f),p=h.pop(),n(a[o]).before(p),y=this.XLScroll._rowHeaderTemplate(1,nt[f]),n(b[o]).before(y),u.rowCount=u.rowCount+1;this._refreshRows(r)}else for(f=i;f>=t;f--)o=this._getRowIdx(f),h.push(a[o].outerHTML),n(a[o]).remove(),n(b[o]).remove(),u.rowCount=u.rowCount-1,this.XLScroll._createNewRow(r,-1,-1,"insert");for(l=n(this.getRows(r)[0]).find("td"),f=0,v=l.length;f<v;f++)n(l[f]).text(f+1);this._refreshRows(r)}this._isFrozen(u.frozenRows)&&(t<u._frozenRows||i<u._frozenRows)&&this.XLFreeze._refreshFreezeRowDiv();u._isRowSelected?this.XLSelection.selectRows(t,i):this.performSelection({rowIndex:t,colIndex:d},{rowIndex:i,colIndex:g});this._deletedText=h;this.model.allowComments&&this._updateCommentColl(r);this._isUndo?this._refreshAllMergeCells(r,t,e.rowCount,-1,0,"insert"):this._refreshAllMergeCells(r,t,e.rowCount,-1,0,"delete");this.model.allowFiltering&&this.XLFilter._updateFilterCollection(r,t,i-t,"row",this._insDelStatus);this.XLScroll._getRowHeights(r,t);this._isUndoRedo||this._dupDetails||this._undoredoDetails(r,{rowIndex:t,colIndex:0},{rowIndex:i,colIndex:u.colCount-1},"delete","deleteRow")}},deleteEntireColumn:function(i,r){var h,g;if(this.model.allowDelete&&!this.model.isReadOnly){var u,f,p,w,tt=0,e=this.getActiveSheetIndex(),it=this.getFrozenColumns(),o=this.getSheet(e),a=this.getRows(e)[1],v=this._getContent(e).find("col"),b=this._getJSSheetHeader(e).find("col"),c=this._getJSSheetHeader(e).find("th"),nt=o._selectedCells,et=nt[0].rowIndex,ot=nt[nt.length-1].rowIndex,y,s=[],l,rt,k,ut=this.XLScroll._colGroupTemplate(1),d=o.columnsWidthCollection,ft=this.model.scrollSettings.allowVirtualScrolling,st=ft?this._getContent(e).find("tbody").get(1):this._getContent(e).find("tbody").get(0);if(this._isUndo?(y="insertColumn",this._insDelStatus="insert"):(y="deleteColumn",this._insDelStatus="delete"),!o._isTemplate||!(i<o._templateColCount||r<o._templateColCount)){if(l={startCol:i,colCount:r-i+1,startRow:0,rowCount:o.rowCount,status:y},!this._isUndoRedo&&(this.XLRibbon._isDirtySelect||this.model.allowFiltering&&this.XLFilter._checkFilterApplied(e,l.startRow,l.rowCount,0,o.colCount,y))){this._showAlertDlg("Alert","InsertDeleteAlert",440);return}if(this._clearAllMergeCells(e,-1,0,i,l.colCount,y),this._isUndo){for(s=n.extend(!0,s,this._deletedText),h=0,u=a.length-1;u>=0;u--){for(w=n(a[u]).find("td"),f=i;f<=r;f++)w.eq(f-h).before(s.pop()),h++;h=0}for(f=i;f<=r;f++)v.eq(f-h).before(s.pop()),c.eq(f-h).before("<th class='e-headercell'><div class='e-headercelldiv'><\/div><\/th>"),b.eq(f-h).before(s.pop()),h++;k=d.splice(0,i);t.merge(k,this._deletedDimension.reverse());t.merge(k,d);o.columnsWidthCollection=k;this._deletedDimension=[]}else{if(this._deletedDimension=[],this._isFrozen(it)&&it>=i){for(u=o._frozenColumns-1;u<o._fleftColIdx;u++)tt+=o.columnsWidthCollection[u];this._scrollContent({x:-tt})}for(f=r;f>=i;f--)s.push(b[f].outerHTML),s.push(v[f].outerHTML),this._deletedDimension.push(d.splice(f,1)[0]),b.eq(f).remove(),v.eq(f).remove(),b.parent().append(ut),v.parent().append(ut),d.push(o.columnWidth);for(u=0,p=a.length;u<p;u++)for(w=n(a[u]).find("td"),f=r;f>=i;f--)rt=this.XLScroll._columnTemplate(),n(a[u]).append(rt),s.push(w[f].outerHTML),n(st.rows[u]).find("td:eq("+f+")").remove()}for(this.XLScroll._getColWidths(e,i),this._isFrozen(o.frozenColumns)&&(i<o._frozenColumns||r<o._frozenColumns)&&this.XLFreeze._refreshFreezeColDiv(),this.model.allowFiltering&&this.XLFilter._updateFilterCollection(e,i,r-i,"column",this._insDelStatus),o.colCount=v.length,c=this._getJSSheetHeader(e).find("th"),this._refreshDataContainer(e,l),u=0,p=c.length;u<p;u++)this._checkIndicesInContainer(e,0,u,"hCol")&&(g="e-hcol"),this._checkIndicesInContainer(e,0,u,"isCHide")&&(g+="e-hide"),this._removeClass(c[u],"e-hcol"),this._removeClass(c[u],"e-hide"),this.addClass(c[u],g),g="",n(c[u]).find("div").text(this._generateHeaderText(u+1));ft&&this.refreshContent(e);this._isUndo?this._refreshAllMergeCells(e,-1,0,i,l.colCount,"insert"):this._refreshAllMergeCells(e,-1,0,i,l.colCount,"delete");o._isColSelected?this.XLSelection.selectColumns(i,r):this.performSelection({rowIndex:et,colIndex:i},{rowIndex:ot,colIndex:r});this._deletedText=s;this.model.allowComments&&this._updateCommentColl(e);this._isUndoRedo||this._undoredoDetails(e,{rowIndex:0,colIndex:i},{rowIndex:o.rowCount-1,colIndex:r},"delete","deleteColumn");this._refreshRows(e)}}},_getSelectedRange:function(n,t){for(var r,e,o=[],u=this.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]),i=u[0],f=u[2];i<=f;){for(r=u[1],e=u[3];r<=e;)o.push({rowIndex:i,colIndex:r}),r++;i++}return o},performSelection:function(t,i){var v=this.getActiveSheetIndex(),u,f=this.getSheet(v),e=f._selectedCells,o,s,h,c,l,a,r;if(this.getObjectLength(t)||(u=this._getRangeArgs(t,"object"),t={rowIndex:u[0],colIndex:u[1]},i={rowIndex:u[2],colIndex:u[3]}),JSON.stringify(t)===JSON.stringify(e[0])&&JSON.stringify(i)==JSON.stringify(e[e.length-1])){f._startCell=t;f._endCell=i;this.model.allowSelection&&this.XLSelection._refreshBorder();return}this.setActiveCell(t.rowIndex,t.colIndex);this.model.allowSelection&&(h=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"merge"),c=this.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"merge"),h&&(l=this.getRangeIndices(h.mRange),t={rowIndex:l[0],colIndex:l[1]}),c&&(a=this.getRangeIndices(c.mRange),i={rowIndex:a[2],colIndex:a[3]}),this.XLSelection.selectRange(t,i));this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();f._startCell=t;f._endCell=i;this.model.showRibbon&&!this._isScrolling&&(this.XLRibbon._updateRibbonIcons(),o=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"tableName",v),r=n("#"+this._id+"_Ribbon").data("ejRibbon"),o?(s=this._getTableID(o),this.isNumber(s)&&this.XLRibbon._designTabUpdate(s,t)):this.model.showRibbon&&((r.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||r.isVisible(this._getLocStr("Design")))&&this.XLRibbon._toggleDesignTab(t),(r.model.selectedItemIndex===this.XLRibbon._getTabIndex("format")||r.isVisible(this._getLocStr("FORMAT")))&&this.XLRibbon._toggleFormatTab(t),(r.model.selectedItemIndex===this.XLRibbon._getTabIndex("chartdesign")||r.isVisible(this._getLocStr("CHARTDESIGN")))&&this.XLRibbon._toggleChartDesignTab(t),(r.model.selectedItemIndex===this.XLRibbon._getTabIndex("analyze")||r.isVisible(this._getLocStr("ANALYZE")))&&this.XLRibbon._toggleAnalyzeTab(t)))},_checkRowCol:function(n,i){if(n!==0&&i!==0)return t.isNullOrUndefined(i)&&(i=n),{start:n,end:i}},hideRow:function(n,t){var i=this._checkRowCol(n,t);this._hideRow(i.start-1,i.end-1,"isRHide")},showRow:function(n,t){var i=this._checkRowCol(n,t);this._showRow(i.start,i.end,"isRHide")},hideColumn:function(n,t){var i=this._checkRowCol(n,t);this._hideColumn(i.start-1,i.end-1)},showColumn:function(n,t){var i=this._checkRowCol(n,t);this._showColumn(i.start,i.end)},_hideRow:function(n,i,r,u){var e=this.getActiveSheetIndex(),f=this.getSheet(e),a=this.getRows(e),y=a[1],p=a[0],h=this.model.scrollSettings,s=h.allowVirtualScrolling,v=f.hideRowsCollection,c=[],w=f.rowsHeightCollection,o,l;for(this._isUndoRedo||u||(this.XLEdit._updateDataContainer({rowIndex:n?n-1:n,colIndex:0},{dataObj:{hRow:!0}}),s||this.addClass(this._getJSSheetRowHeaderContent(e).find(".e-rowheader")[n?n-1:n],"e-hrow")),o=n;o<=i;o++)r==="isRHide"&&this.XLEdit._updateDataContainer({rowIndex:o,colIndex:0},{dataObj:{isRHide:!0}}),c.push(o),v.indexOf(o)===-1&&(v.push(o),s||(this._isRowViewable(e,o)&&(this.addClass(y[o],"e-r-hide"),this.addClass(p[o],"e-r-hide")),h.allowScrolling&&h.scrollMode===t.Spreadsheet.scrollMode.Infinite&&(!f._isImported||f._isLoaded)&&(this._isFilter?(f.rowsHeightCollection.push(this.model.rowHeight),this._hideRowColl.push(f.rowCount++)):this.XLScroll._createNewRow(e,-1,-1,"insert"))));this.model.allowCellFormatting&&this.XLFormat._refreshHiddenBorder(n,i,!0,!0);this._isFilter||this.XLScroll._getRowHeights(e,n);this._showHideRows(e,f,c,n,i,s,"hide");f._isImported&&!f._isLoaded||this._isFilter||this._isExport||(this.model.allowComments&&this.XLComment._updateCmntArrowPos(),this._isFrozen(f.frozenRows)&&(n<f._frozenRows||i<f._frozenRows)&&this.XLFreeze._refreshFreezeRowDiv(),this.model.scrollSettings.allowScrolling&&!s&&this.XLScroll._refreshScroller(e,"refresh","vertical"),this._isUndoRedo||u||(f._activeCell.rowIndex=i+1,l={sheetIndex:e,reqType:"show-hide",action:"hide",operation:"row",bSelect:{startRow:n,endRow:i},aSelect:{startRow:i+1,endRow:i+1},addBRows:n?[n-1]:[n],remBRows:[],hideRows:c},this._completeAction(l),this._trigActionComplete(l)));u||this._isFilter||(this.XLSelection.selectRow(i+1,e),this.model.allowAutoFill&&this.XLDragFill.hideAutoFillElement())},_showRow:function(i,r,u,f,e,o,s){var y,h,p,c=this.getActiveSheetIndex(),d=this._isUndoRedo?i:i-1>0?i-1:0,l=this.getSheet(c),g=this.getRows(c),nt=g[1],tt=g[0],w=[],it=[],ut=l.rowsHeightCollection,rt=l.hideRowsCollection,v=t.buildTag("table#wrapTable.e-table",{}),b=this._dataContainer.sheets[c],a=this.model.scrollSettings.allowVirtualScrolling,ft=l.columnsWidthCollection,k;for(e=e||this.getSheetElement(c)[0].querySelectorAll(".e-spreadsheetcolumnheader"),o=o||n(this._getJSSheetHeader(c)[0].querySelectorAll("colgroup")[0].outerHTML).attr("id","ss"),s=s||this.getSheetElement(c)[0].querySelectorAll(".e-rowheadercontent td"),a||(v.append(o),this.element[0].insertBefore(v[0],this.element[0].childNodes[0])),this.model.allowCellFormatting&&this.XLFormat._refreshHiddenBorder(i,r,!0),h=d;h<=r;h++)y=rt.indexOf(h),y>-1&&(u==="isRHide"&&delete b[h][0].isRHide,w.push(h),rt.splice(y,1),a||(this._removeClass(nt[h],"e-r-hide"),this._removeClass(tt[h],"e-r-hide")),!this._isUndoRedo&&h>0&&!f?(it.push(h-1),delete b[h-1][0].hRow,a||this._removeClass(s[h-1],"e-hrow")):h!==0||f||(delete b[0][0].hRow,a||(e.height(20.5),this._removeClass(e[0],"e-hrow")))),a||(this._setWrapHeight(c,h,nt,tt,v,"visible"),v.remove()),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this._isFilter||this.XLScroll._getRowHeights(c,d);this._showHideRows(c,l,w,i,r,a,"show");f||l._isImported&&!l._isLoaded||this._isUndoRedo||this._isFilter||(i<r?(this.setActiveCell(i,0),this.XLSelection.selectRows(i,r,c),p={startRow:i,endRow:r}):i>0&&(this.setActiveCell(i-1,0),this.XLSelection.selectRow(i-1,c),p={startRow:i-1,endRow:i-1}),this.XLDragFill.positionAutoFillElement(),k={sheetIndex:c,reqType:"show-hide",action:"show",operation:"row",bSelect:{startRow:i,endRow:r},aSelect:p,addBRows:[],remBRows:it,hideRows:w},this._completeAction(k),this._trigActionComplete(k));this._isFrozen(l.frozenRows)&&(i<l._frozenRows||r<l._frozenRows)&&this.XLFreeze._refreshFreezeRowDiv();this._isFilter||((!l._isImported||l._isLoaded)&&this.model.allowComments&&this.XLComment._updateCmntArrowPos(),this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(c,"refresh","vertical"))},_showHideRows:function(n,t,i,r,u,f,e){f&&(e==="show"&&this.refreshContent(n),this._refreshViewport(this._isFrozen(t.frozenRows)?t._contScrollTop:t._scrollTop,n));this._refreshSHMergeCells(n,i,u-r+1,"row",e);f&&e==="hide"&&this.refreshContent(n);t.selectedRange[0]<r&&t.selectedRange[2]>u&&(this.model.allowSelection&&this.XLSelection.selectRange(t._activeCell,t._activeCell),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())},_colgroupRefresh:function(t){var i,r,u,f;this.model.allowResizing&&(i=this._getJSSheetHeader(t).find("colgroup"),r=this._getContent(t).find("colgroup"));u=n(i).clone();f=n(r).clone();n(r).remove();n(i).remove();n(u).prependTo(this._getJSSheetHeader(t).find(".e-table"));n(f).prependTo(this._getContent(t).find(".e-table"))},_updateFilterIcon:function(n,i,r){t.isNullOrUndefined(r)&&(r=this.getActiveSheetIndex());for(var o=this.getSheet(r).filterSettings.tableRange,u,e,f=0,s=o.length;f<s;f++)e=o[f].multifilterIdx,n>=e[0]&&n<=e[e.length-1]&&(u=o[f].startRow-1,this._isRowViewable(r,u)&&(i==="hide"?this.addClass(this.getCell(u,n).find(".e-filterspan")[0],"e-hide"):this._removeClass(this.getCell(u,n).find(".e-filterspan")[0],"e-hide")),this.XLEdit._updateDataContainer({rowIndex:u,colIndex:n},{dataObj:{isFilterVisible:i!="hide"}}))},_hideColumn:function(n,i){for(var e,v,s,o,y=!1,u=this.getActiveSheetIndex(),k=this._getJSSheetHeader(u).find("th"),d=this._getJSSheetHeader(u).find("col"),p,f=this.getSheet(u),g=f.hideColsCollection,h=[],c=[],nt=this._getContent(u).find("col"),w=f._filterColl,tt,l=f.columnsWidthCollection,b=this.element.find(".e-spreadsheetcolumnheader"),a,r=n;r<=i;r++)if(this._getContent(u).find(".e-rowcell:nth-child("+(r+1)+")").addClass("e-soverflow"),p=this.XLEdit.getPropertyValue(0,r,"isCHide"),this._isColumnViewable(u,r)&&(y=!0),t.isNullOrUndefined(p))for(this.XLEdit._updateDataContainer({rowIndex:0,colIndex:r},{dataObj:{isCHide:!0}}),this._writeRule(r,u),y&&(this.addClass(k[r],"e-hide"),this.addClass(d[r],"e-hide"),this.addClass(nt[r],"e-hide")),h.push(r),g[r]=l[r],l[r]=0,o=this.getObjectKeys(w),e=0,v=o.length;e<v;e++)t.isNullOrUndefined(w[o[e]])||(tt=o[e],t.isNullOrUndefined(this.XLEdit.getPropertyValue(o[e],r,"isSpanHide"))&&this.XLEdit._updateDataContainer({rowIndex:o[e],colIndex:r},{dataObj:{isSpanHide:!0}}));this.model.allowCellFormatting&&this.XLFormat._refreshHiddenBorder(n,i,!1,!0);this._isUndoRedo||(n?c.push(n-1):c.push(n),this._isColumnViewable(u,n)&&(n===0?(b.width(28),this.addClass(b[0],"e-hfcol"),this.XLEdit._updateDataContainer({rowIndex:0,colIndex:0},{dataObj:{hCol:!0}})):(this.XLEdit._updateDataContainer({rowIndex:0,colIndex:n-1},{dataObj:{hCol:!0}}),this.addClass(this._getJSSheetHeader(u).find("th:eq("+(n-1)+")")[0],"e-hcol"))));this._refreshSHMergeCells(u,h,i-n+1,"column","hide");this.XLScroll._getColWidths(u,n);this._isFrozen(f.frozenColumns)&&(this.XLScroll._refreshContHgt(u),(n<f._frozenColumns||i<f._frozenColumns)&&this.XLFreeze._refreshFreezeColDiv());this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(u,"refresh","horizontal");!f._isImported||f._isLoaded?(l.length-1===i?(this.XLSelection.selectColumn(i-1,u),this.setActiveCell(0,i-1),s={startCol:i-1,endCol:i-1}):(s={startCol:i+1,endCol:i+1},this.setActiveCell(0,i+1),this.XLSelection.selectColumn(i+1,u)),this.XLDragFill.positionAutoFillElement(),this._isUndoRedo||(a={sheetIndex:u,reqType:"show-hide",action:"hide",operation:"column",bSelect:{startCol:n,endCol:i},aSelect:s,hideCols:h,addBCols:c,remBCols:[]},this._completeAction(a),this._trigActionComplete(a)),this.model.allowComments&&this.XLComment._updateCmntArrowPos()):this.setActiveCell(0,0);this._browserDetails.name.indexOf("msie")>-1&&this._colgroupRefresh(u)},_showColumn:function(n,t){var i,o,r=this.getActiveSheetIndex(),f=this._isUndoRedo?n:n-1>0?n-1:0,u=this.getSheet(r),e=u.hideColsCollection,s=[],h=!1,l=[],a=this._getJSSheetHeader(r).find("th"),v=this._getContent(r).find("col"),y=this._getJSSheetHeader(r).find("col"),w=u.columnsWidthCollection,p=this.element.find(".e-spreadsheetcolumnheader"),c;for(this.model.allowCellFormatting&&this.XLFormat._refreshHiddenBorder(n,t),i=f;i<=t;i++)this._getContent(r).find(".e-rowcell:nth-child("+(i+1)+")").removeClass("e-soverflow"),i in e&&(this._deleteRule(i,r),this._isColumnViewable(r,i)&&(h=!0),h&&(this._removeClass(a[i],"e-hide"),this._removeClass(y[i],"e-hide"),this._removeClass(v[i],"e-hide"),v[i].style.width=e[i]+"px",y[i].style.width=e[i]+"px"),w[i]=e[i],delete e[i],delete this._dataContainer.sheets[r][0][i].isCHide,this.model.allowFiltering&&this._updateFilterIcon(i,"show",r),s.push(i),!this._isUndoRedo&&i>0?(h&&this._removeClass(a.get(i-1),"e-hcol"),delete this._dataContainer.sheets[r][0][i-1].hCol,l.push(i-1)):i===0&&(p.width(29),this._removeClass(p[0],"e-hfcol"),delete this._dataContainer.sheets[r][0][0].hCol));this._refreshSHMergeCells(r,s,t-n+1,"column","show");this.XLScroll._getColWidths(r,f);this._isUndoRedo||u._isImported&&!u._isLoaded||(n<t?(this.XLSelection.selectColumns(n,t,r),o={startCol:n,endCol:t}):(this.XLSelection.selectColumn(f,r),o={startCol:f,endCol:f}),this.XLDragFill.positionAutoFillElement(),c={sheetIndex:r,reqType:"show-hide",action:"show",operation:"column",bSelect:{startCol:n,endCol:t},aSelect:o,addBCols:[],remBCols:l,hideCols:s},this._completeAction(c),this._trigActionComplete(c));this._browserDetails.name.indexOf("msie")>-1&&this._colgroupRefresh(r);(!u._isImported||u._isLoaded)&&this.model.allowComments&&this.XLComment._updateCmntArrowPos();this._isFrozen(u.frozenColumns)&&(n<u._frozenColumns||t<u._frozenColumns)&&this.XLFreeze._refreshFreezeColDiv();this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(r,"refresh","horizontal")},_refreshHideRowColCollection:function(n,t,i,r,u){var e,f;if(r==="row"){for(f=0;f<n.length;f++)if(n[f]>=t+i){u==="insert"?n[f]+=i:n[f]-=i;break}}else for(e=this.getObjectKeys(n),f=e.length-1;f>=0;f--)if(e[f]>=t+i){u==="insert"?(n[parseInt(e[f])+i]=n[e[f]],delete n[e[f]]):(n[parseInt(e[f])-i]=n[e[f]],delete n[e[f]]);break}},_destroySheet:function(n){this.element.find("#"+this._id+"_"+this.model.sheets[n].sheetInfo.value).empty()},_destroy:function(){var r,i=1,t;if(n("#"+this._id+"_sscustomformat").remove(),document.getElementById(this._id+"_sshide")&&(document.getElementById(this._id+"_sshide").outerHTML=""),this.isImport||this._isNew){while(i<=this.model.sheetCount)delete n.templates[this._id+"JSONTemplate"+i],delete n.templates[this._id+"JSONRowHdrTemplate"+i],r=this.getSheet(i).sheetInfo.value,CalcEngine.unregisterGridAsSheet(r,r),i++;this.model.sheets=[];this.model.nameManager=[];this._sheets=[];this.getActivationPanel().empty();this.model.enablePivotTable&&(this.XLPivot._hasPvtField=!1);this.isDirty=!1;this.isImport?(this._detachTable=null,this._updateFormulaCollection()):(document.getElementById(this._id+"_nmgrid")&&n("#"+this._id+"_nmgrid").ejGrid("option",{dataSource:[]}),this._dataContainer={sheets:{},hashCode:[],sharedData:[],cellType:[],valData:[],cFormatData:[]},this.XLRibbon._updateUseInFormulaTrgt(),this.XLEdit._refreshAutoComplete());this.element.append([this.getFocusTopElem(),this.getFocusRightElem(),this.getFocusBottomElem(),this.getFocusLeftElem(),this.getAutoFillElem(),this._getAutoFillOptElem()]);this.element.find(".e-spreadsheet-list .e-sheet").remove();document.getElementById(n("#"+this._id+"ddl"))&&n("#"+this._id+"ddl").data("ejDropDownList").destroy();n("#"+this._id+"ddl").remove();this._tableCnt=this._newSIndex=1;this.XLChart&&(this.XLChart._shapeCnt=1);CalcEngine._tokenCount=0;this._isVPRendered=!1}else this._wireEvents("_off"),this._destroySubControls(),this.element.empty(),this.element.css({height:"",width:"","min-height":"","min-width":""}),this.element.removeAttr("tabindex"),this.element.removeEleEmptyAttrs(),this._removeClass(this.element[0],"e-spreadsheet e-js"),this.model.cssClass.length&&this._removeClass(this.element[0],this.model.cssClass),n("#"+this._id+" _formatastable").parent().remove(),n("#"+this._id+" _cellstyles").parent().remove(),n("#"+this._id+"_Ribbon_Home_Font_BorderColor_popup").remove();t=this.getCalcEngine();t.getFormulaInfoTable().clear();t.getDependentCells().clear();t.getDependentFormulaCells().clear();t.getNamedRanges().clear();t.getDependentNamedRangeCells().clear();this._isRibbonDestroyed=!0},_destroySubControls:function(){var r,u=this._id,t,f,i,o,e;if(t=n("span.e-"+u+"-ddl input.e-dropdownlist"),t.length)for(i=0,o=t.length;i<o;i++)f=n(t[i]).data("ejDropDownList"),f&&f.destroy();if(this.model.allowFiltering){e=n(".e-"+this._id+"_customddl");e.length&&e.ejDropDownList("destroy").remove();var s=n("#"+this._id+"_filter_custom_string_acString"),h=n("#"+this._id+"_filter_custom_number_acString"),c=n("#"+this._id+"_filter_custom_date_acString");s.length&&s.ejAutocomplete("destroy").remove();h.length&&h.ejNumericTextbox("destroy").remove();c.length&&c.ejDatePicker("destroy").remove()}n("#"+this._id+"_colordlg_cpicker").ejColorPicker("destroy").remove();this.model.showRibbon&&(this.XLRibbon&&this.XLRibbon._rbnDestroy({destroy:!0}),n(".e-"+this._id+"-spltbtn").ejSplitButton("destroy"),n("#"+this._id+"_Ribbon").ejRibbon("destroy"));document.getElementById(this._id+"_nmgrid")&&n("#"+this._id+"_nmgrid").ejGrid("destroy");r=n(".e-"+u+"-dlg");r.length&&r.remove();this.model.allowFormulaBar&&n("#"+this._id+"_inputbox").ejAutocomplete("destroy");n("#"+this._id+"_AutoComplete").ejAutocomplete("destroy");this.model.allowAutoFill&&n("#"+this._id+"_dragfilloptionbtn").ejSplitButton("destroy");this.model.enableContextMenu&&(n("#"+this._id+"_contextMenuCell").ejMenu("destroy").remove(),n("#"+this._id+"_contextMenuColumnHeader").ejMenu("destroy").remove(),n("#"+this._id+"_contextMenuRowHeader").ejMenu("destroy").remove(),n("#"+this._id+"_contextMenuFooter").ejMenu("destroy").remove(),n(".e-"+u+"-cmenu").remove());this.model.allowFiltering&&(this._excelFilter&&this._excelFilter.resetExcelFilter(),n("#"+this._id+"number_excelDlg").remove(),n("#"+this._id+"string_excelDlg").remove(),n("#"+this._id+"date_excelDlg").remove());n("#"+this._id+"_copyPaste").remove();n("#"+this._id+"_wait").ejWaitingPopup("destroy");n("#"+this._id+"_wait").remove()},_getXYPos:function(n,t,i,r){var e=this.element.offset().top,o=this.element.offset().left,s=t.height(),h=t.width(),u=n.offset().left-o,f=n.offset().top-e;return f+i+s>this._responsiveHeight?f=f-(f+i+s-this._responsiveHeight)+(e-6):f+=e,f<e&&(f+=e-f),u+r+h>this._responsiveWidth?u=u-(u+r+h-this._responsiveWidth)+(o-6):u+=o+r,u<o&&(u+=o-u),{xPos:u,yPos:f}},getValueRowCol:function(n,t,i){var n=this._getSheetIdxFromSheetValue(this._getLocStr("Sheet")+n),r=this.getSheet(n);return n==-1?"#REF!":(r._isImported&&!r._isRequested&&(this._intrnlReq=!0,this._importSheet(n,!1)),this.XLEdit.getPropertyValue(t-1,i-1,"value",n))},setValueRowCol:function(n,i,r,u){if(r--,u--,r!==-2||u!==-2){var f,e,s={rowIndex:r,colIndex:u},h=!1,o,c;(typeof i=="string"&&(i=i.replace(/^\"|\"$/g,"")),n=this._getSheetIdxFromSheetValue(this._getLocStr("Sheet")+n),f=this.getRangeData({range:[r,u,r,u],property:["value","formatStr","type","thousandSeparator","decimalPlaces"],sheetIdx:n})[0],f.formatStr&&!this._isFormulaError(i)&&(isNaN(parseInt(i))&&!isNaN(Date.parse(i))&&(i=new Date(i)),e=this.XLFormat._format(i,{formatStr:f.formatStr,type:f.type,thousandSeparator:f.thousandSeparator,decimalPlaces:f.decimalPlaces})),f.type=="fraction"&&(e=this.XLFormat._format(i,{type:f.type})),e=t.isNullOrUndefined(e)?i:e,this._isInitLoad&&!this.isImport&&(h=!0),this.model.locale!=="en-US"&&this.isNumber(e)&&(e=this._getlocaleNumVal(e,!0)),o={value2:e,calcValue:this.XLEdit._parseValue(i,{rowIndex:r,colIndex:u}).value},f.type&&(o.type=f.type),c={isRefCells:!0,calcValue:o.calcValue,value:f.value,rowIndex:r,colIndex:u},this._isInitLoad||this.isImport||this.XLEdit._EditCellDetails.rowIndex===r&&this.XLEdit._EditCellDetails.columnIndex===u||!this._trigger("cellSave",c))&&(this.XLEdit._updateDataContainer(s,{dataObj:o,sheetIdx:n,skipCell:h}),this.XLEdit._refreshCellAlignment({cellIdx:s,value:i,type:f.type}))}},getActiveCellElem:function(n){n=this._getSheetIndex(n);var t=this.getSheet(n);return this.getCell(t._activeCell.rowIndex,t._activeCell.colIndex,n)},_hlDlgOpen:function(){var f=this.getActiveSheetIndex(),e=this.getActiveCellElem(f),o;if(!e.length||!this.model.allowEditing)return!1;if(this.XLEdit._rangeHasProperty(this.getSheet(f).selectedRange,"cellType")){this._showAlertDlg("Alert","CellTypeAlert","CellTypeAlert",372);return}var t=this._id,c,l=n("#"+t+"_Ribbon_webAddress"),a=n("#"+t+"_Ribbon_cellAddress"),s=n("#"+t+"_Ribbon_findText"),i,r=this.XLEdit.getPropertyValue(e.parent("tr").index(),e[0].cellIndex,"hyperlink",f),v,h,u=n("#"+t+"_Ribbon_cellText");n("#"+t+"_HLDialog").ejDialog("open");this._responsiveHeight<365&&n("#"+this._id+"_HLDialog_wrapper").css("top","0px");h=n("#"+t+"_Ribbon_sheentName").data("ejTreeView");h.option("fields",{dataSource:this.XLRibbon._sheetData()});c=n("#"+t+"_HLDialogTab").data("ejTab");u.attr("disabled",!1);s.attr("disabled",!1);this.isUndefined(r)?c.model.selectedItemIndex===0?(l.val("http://"),u.val("")):(h.selectNode(f+1),u.val(h.getText(f+1)+"!A1"),a.val("A1")):(this.isUndefined(r.webAddr)?c.option({selectedItemIndex:1}):c.option({selectedItemIndex:0}),this.isUndefined(r.cellAddr)?(l.val(r.webAddr),a.val("A1")):(a.val(r.cellAddr.split("_")[0]),v=parseInt(r.cellAddr.split("_")[1])+1,h.selectNode(v),l.val("http://")));n.validator&&(n("#"+t+"_Form_Ribbon_cellAddress").validate().resetForm(),n("#"+t+"_Form_Ribbon_webAddress").validate().resetForm());s.val("");i=this.XLEdit.getPropertyValueByElem(e);this.isUndefined(i)||(o=this.XLEdit.getPropertyValueByElem(e,"type"),this.isFormula(i)||o&&o.indexOf("date")>-1||n.isNumeric(i)||o&&o.indexOf("time")>-1?(u.val(this._getLocStr("HyperLinkHide")),s.val(this._getLocStr("HyperLinkHide")),u.attr("disabled",!0),s.attr("disabled",!0)):(u.val(i),s.val(i)))},_setLink:function(i){var o,h,s,c,e,y,l,a=this.getActiveSheetIndex(),p,u,r=this.getActiveCell(a),f,v;e=this.getSheet(a).selectedRange;n("#"+this._id+"_HLDialog").length||this.XLRibbon._initHLDialog();v=n("#"+this._id+"_HLDialogTab").ejTab("option","selectedItemIndex");o=n("#"+this._id+"_Ribbon_cellText").val();h=n("#"+this._id+"_Ribbon_cellAddress").val();s=n("#"+this._id+"_Ribbon_findText").val();c=n("#"+this._id+"_Ribbon_webAddress").val();l=n("#"+this._id+"_Ribbon_sheentName").data("ejTreeView");y=this._getSheetIndexByName(l.getSelectedNode().text()||this._getSheetNames()[this.getActiveSheetIndex()-1].text);o.length||s.length||(o=l.getSelectedNode().text()+"!"+h,s=c);f=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex);this._prevText=t.isNullOrUndefined(f)?"":this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2");this._prevVal=t.isNullOrUndefined(f)?"":this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value");u=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"type")&&(this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"type").indexOf("date")>-1||this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"type").indexOf("time")>-1)?this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2"):n.isNumeric(f)||this.isFormula(f)?f:v===0?s:o;this._isUndoRedo&&(u=i[0].prevText);this.XLEdit._updateCellValue(r,u);(this.isFormula(u)||n.isNumeric(u))&&(u=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2"));p=v===0?{webAddr:c,text:u}:{cellAddr:h,text:u};this.setHyperlink(this._getAlphaRange(a,e[0],e[1],e[2],e[3]),p,y,i);this._dlgHLClick=!1},_getRangeArgs:function(n,i,r){return t.isNullOrUndefined(n)&&(n=this.getSheet(r).selectedRange),i===typeof n?n:typeof n=="object"?this._getAlphaRange(this.getActiveSheetIndex(),n[0],n[1],n[2],n[3]):this.getRangeIndices(n)},setHyperlink:function(i,r,u,f){var c;if(i=this._getRangeArgs(i,"string"),this.model.allowHyperlink&&!this.model.isReadOnly){if(c={range:i,address:r.webAddr,text:r.text,sheetIndex:u,reqType:"hyperlink",action:"add"},this.XLEdit._rangeHasProperty(i,"cellType")){this._showAlertDlg("Alert","CellTypeAlert","CellTypeAlert",372);return}if(this._trigActionBegin(c))return;i=c.range;r.webAddr=c.address;r.text=c.text;u=c.sheetIndex;var p,h,ft,w,nt,k,d,o,tt=this.getActiveSheetIndex(),et=this.getSheet(tt),b,it,a=[],rt,l,e,v,s=this._getAlphaRangeCells(i),y={sheetIndex:this.getActiveSheetIndex(),reqType:"hyperlink"},ut,g;if(d=this._getRangeArgs(i,"object"),o=this._getSelectedCells(y.sheetIndex,d).selCells,y.action=t.isNullOrUndefined(this.XLEdit.getPropertyValue(o[0].rowIndex,o[0].colIndex,"hyperlink"))?"add":"edit",this._isUndoRedo)for(e=0,v=o.length;e<v;e++)!f||t.isNullOrUndefined(f[e])||t.isNullOrUndefined(f[e].prevLink)||(this.XLEdit._updateDataContainer({rowIndex:o[e].rowIndex,colIndex:o[e].colIndex},{dataObj:{hyperlink:f[e].prevLink}}),this._isRowViewable(u,o[e].rowIndex)&&(ut=n(s[e]).text(),n(s[e]).find("a").remove(),s[e].lastChild?s[e].lastChild.textContent="":n(s[e]).text(""),e===0?t.isNullOrUndefined(this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"hyperlink").cellAddr)?n(s[e]).append(t.buildTag("a",f[e].prevText,"",{href:this.XLEdit.getPropertyValueByElem(n(s[e]),"hyperlink").webAddr,target:"_blank"})):n(s[e]).append(t.buildTag("a",f[e].prevText,"")):t.isNullOrUndefined(this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"hyperlink").cellAddr)?n(s[e]).append(t.buildTag("a",ut,"",{href:this.XLEdit.getPropertyValueByElem(n(s[e]),"hyperlink").webAddr,target:"_blank"})):n(s[e]).append(t.buildTag("a",ut,"")),n(s[e]).find("a").addClass("e-hyperlinks")),this._dupDetails=!0,this.XLFormat.format({style:{color:this._hlColor}}),this._dupDetails=!1);else{for(t.isNullOrUndefined(r.webAddr)?(h=r.cellAddr,p=t.isNullOrUndefined(r.text)?this.XLEdit.getPropertyValue(o[0].rowIndex,o[0].colIndex,"value2"):r.text,h.indexOf("!")>-1&&(b=h.split("!"),u=b[0].indexOf("=")>-1?this._getSheetIndexByName(b[0].split("=")[1]):this._getSheetIndexByName(b[0]),h=b[1]),h.indexOf("$")>-1&&(cellAdr=h.split("$").join("")),it=t.isNullOrUndefined(p)?h:p):(nt=r.webAddr,w=t.isNullOrUndefined(r.text)?this.XLEdit.getPropertyValue(o[0].rowIndex,o[0].colIndex,"value2"):r.text,it=t.isNullOrUndefined(w)?nt:w),this._dlgHLClick||(g=this.XLEdit.getPropertyValue(o[0].rowIndex,o[0].colIndex,"value2"),this._prevText=t.isNullOrUndefined(g)?"":g,this._prevVal=t.isNullOrUndefined(g)?"":this.XLEdit.getPropertyValue(o[0].rowIndex,o[0].colIndex,"value"),this.XLEdit._updateCellValue({rowIndex:o[0].rowIndex,colIndex:o[0].colIndex},it)),e=0,v=o.length;e<v;e++)a.push({rowIndex:o[e].rowIndex,colIndex:o[e].colIndex,prevLink:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"hyperlink"),prevColor:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"formats")});for(this.isUndefined(c.text)||this.XLEdit._updateCellValue(o[0],c.text),this.isUndefined(h)?this.updateUniqueData({hyperlink:{webAddr:nt}},d):this.updateUniqueData({hyperlink:{cellAddr:h+"_"+u}},d),e=0,v=o.length;e<v;e++)l=this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"value2"),a[e].prevText=e===0?this._prevText:l,a[e].prevVal=e===0?this._prevVal:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"value"),this._isRowViewable(tt,o[e].rowIndex)&&(n(s.eq(e).find("a")).remove(),this.XLEdit._refreshTextNode(s[e]),k=!0),rt=this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"hyperlink",tt),rt.cellAddr?(l=e===0?p:l,k&&s.eq(e).append(t.buildTag("a",l,"")),a[e].curText=p):(l=e===0?w:l,k&&s.eq(e).append(t.buildTag("a",l,"",{href:rt.webAddr,target:"_blank"})),a[e].curText=w),a[e].curLink=this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"hyperlink"),k&&n(s[e]).find("a").addClass("e-hyperlinks");this._dupDetails=!0;this.XLFormat.format({style:{color:this._hlColor}},i);this._dupDetails=!1;y.selectedCell=a;ft={sheetIndex:this.getActiveSheetIndex(),range:i,linkData:r,reqType:"hyperlink",selectedCell:y.selectedCell,action:y.action};et._isImported&&(!et._isLoaded||this._isExport)||(this._completeAction(y),this._trigActionComplete(ft))}}},removeHyperlink:function(n,i,r,u,f){if(!this.model.allowHyperlink||this.model.isReadOnly)return!1;var e,c,s,a,v=[],b=this._dupDetails,o,h=this.getActiveSheetIndex(),p=this.getSheet(h),w=[],y,l={sheetIndex:h,reqType:"hyperlink",action:"delete",range:n};for(o=this._getMultiRangeCells(n),e=0,c=o.length;e<c;e++)f&&this._isHiddenRow(o[e].rowIndex)||(s={rowIndex:o[e].rowIndex,colIndex:o[e].colIndex,prevLink:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"hyperlink"),prevText:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"value2"),prevVal:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"value"),prevColor:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"formats")},this._dupDetails=!0,s.prevLink&&(i?this.XLFormat.format({style:{"text-decoration":"underline"}},this._getAlphaRange(h,o[e].rowIndex,o[e].colIndex,o[e].rowIndex,o[e].colIndex)):(t.isNullOrUndefined(u)||this.isUndefined(u[e].prevColor)||(a=u[e].prevColor.color),this.XLFormat.format({style:{color:this.isUndefined(a)?"#444445":a,"text-decoration":"none"}},this._getAlphaRange(h,o[e].rowIndex,o[e].colIndex,o[e].rowIndex,o[e].colIndex))),s.curColor=this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"formats")),this._dupDetails=b,this.clearRangeData([o[e].rowIndex,o[e].colIndex,o[e].rowIndex,o[e].colIndex],["hyperlink"]),this._isUndoRedo||(s.curLink=this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"hyperlink")),this._isUndoRedo&&!this._dupDetails&&(t.isNullOrUndefined(u[e].prevText)||this.XLEdit._updateDataContainer({rowIndex:o[e].rowIndex,colIndex:o[e].colIndex},{dataObj:{value2:u[e].prevText,value:u[e].prevVal},sheetIdx:h})),this._isUndoRedo||(s.curText=this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"value2")),!this._isUndoRedo||this._dupDetails||t.isNullOrUndefined(u[e].prevLink)||(this.XLEdit._updateDataContainer({rowIndex:o[e].rowIndex,colIndex:o[e].colIndex},{dataObj:{hyperlink:u[e].prevLink}}),y={rowIndex:u[e].rowIndex,colIndex:u[e].colIndex},this.XLSelection.selectRange(y,y),this._setLink([u[e]]),v.push(e)),w.push(s));for(e=0,c=v.length;e<c;e++)o.splice(v[e],1);l.selectedCell=w;l.reqType=t.isNullOrUndefined(r)?"hyperlink":"clear-link";p._isImported&&!p._isLoaded||this._isUndoRedo||this._dupDetails||this._isExport||(this._completeAction(l),this._trigActionComplete(l))},_removeHyperlink:function(n,t,i,r){var u=this.getActiveSheetIndex(),r=r?r:this.getSheet(u).selectedRange;this.removeHyperlink(this._getAlphaRange(u,r[0],r[1],r[2],r[3]),n==="clear",n,t,i)},_openLink:function(){var n=this.getActiveSheetIndex(),t=this.getSheetElement(n).find(".e-activecell");this._hlClick(this.XLEdit.getPropertyValue(t.closest("tr").index(),t[0].cellIndex,"hyperlink",n))},_hlClick:function(n){var r,f,t,e,s=this.getActiveSheetIndex(),h=this._getLocStr("HyperLinkAlert").split("-"),o,u,i=this.getSheet(s);this.model.enableContextMenu&&this.XLCMenu.hideCMenu();n.cellAddr?(u=n.cellAddr.split("_"),o=u[0].indexOf("$")>-1?u[0].split("$").join(""):u[0],r=this.getRangeIndices(o),t={rowIndex:r[0],colIndex:r[1]},e={rowIndex:r[2],colIndex:r[3]},f=Number(u[1]),this.gotoPage(f,!1),i._activeCell=t,this.XLSelection.selectRange(t,e,f),i._startCell=t,i._endCell=e,this.XLScroll._scrollSelectedPosition(f,t),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()):(t={rowIndex:i._activeCell.rowIndex,colIndex:i._activeCell.colIndex},i._startCell=t,i._endCell=t,this._isValidUrl(n.webAddr)?window.open(n.webAddr,"_blank"):this._showAlertDlg("Alert","HyperLinkAlert"))},_isValidUrl:function(n){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(n)},showWaitingPopUp:function(){n("#"+this._id+"_wait").data("ejWaitingPopup").show()},hideWaitingPopUp:function(){n("#"+this._id+"_wait").data("ejWaitingPopup").hide()},_getSelRange:function(n){var t,i,r=this.getActiveSheetIndex();return t=n[0],i=n[n.length-1],this._generateHeaderText(t.colIndex+1)+(t.rowIndex+1)+":"+this._generateHeaderText(i.colIndex+1)+(i.rowIndex+1)},_getSelectedCells:function(n,i){var u,r,f=this.getSheet(n?n:this.getActiveSheetIndex());return t.isNullOrUndefined(i)?(u=f._selectedCells,u.length>0?(i=this._getSelRange(u),r=this.getRangeIndices(i)):(r=[0,0,0,0],u=[{rowIndex:0,colIndex:0}])):(r=this._getRangeArgs(i,"object"),u=this._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]})),{range:r,selCells:u}},_getHiddenCells:function(i,r,u,f){var e=this._dataContainer.sheets[i],h,o,s;return t.isNullOrUndefined(f[u.rowIndex])&&(f[u.rowIndex]={}),t.isNullOrUndefined(f[u.rowIndex][u.colIndex])&&(f[u.rowIndex][u.colIndex]={value:{},text:""}),t.isNullOrUndefined(e[u.rowIndex])||(f[u.rowIndex][u.colIndex].value=n.extend(!0,{},e[u.rowIndex][u.colIndex]),h=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2",i),o=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"wrap",i),s=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"wrapRow",i),delete e[u.rowIndex][u.colIndex],f[u.rowIndex][u.colIndex].text=t.isNullOrUndefined(h)?"":h,(o||s)&&(t.isNullOrUndefined(e[u.rowIndex])&&(e[u.rowIndex]={}),t.isNullOrUndefined(e[u.rowIndex][u.colIndex])&&(e[u.rowIndex][u.colIndex]={}),o&&(e[u.rowIndex][u.colIndex].wrap=o),s&&(e[u.rowIndex][u.colIndex].wrapRow=s))),this._isRowViewable(i,r.rowIndex)&&(r=this.getCell(r.rowIndex,r.colIndex,i).empty()),f},_getRowSpan:function(n,i){for(var u=0,e=this.model.scrollSettings.allowVirtualScrolling,r=i[0].rowIndex,f=i[i.length-1].rowIndex;r<=f;r++)t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isRHide",n))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isFHide",n))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isFilterHide",n))&&this.getSheet(n)._fHMergeRows.indexOf(r)===-1&&(u=u+1);return u},_getColSpan:function(n,i){var u=0,e=this.model.scrollSettings.allowVirtualScrolling,o,r,f;for(e||(o=this._getJSSheetHeader(n).find("col")),r=i[0].colIndex,f=i[i.length-1].colIndex;r<=f;r++)t.isNullOrUndefined(this.XLEdit.getPropertyValue(0,r,"isCHide",n))&&this.getSheet(n)._fHMergeCols.indexOf(r.toString())===-1&&(u=u+1);return u},_getHiddenRowColumnCount:function(n,i){var f=this.getRangeIndices(i),e=0,o=0,r,u,s=this.model.scrollSettings.allowVirtualScrolling,h;for(s||(h=this._getJSSheetHeader(n).find("col")),r=f[0];r<=f[2];r++)t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isRHide",n))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isFHide",n))||(e=e+1);for(u=f[1];u<=f[3];u++)(s||!s&&this._hasClass(h[u],"e-hide")||!t.isNullOrUndefined(this.XLEdit.getPropertyValue(0,u,"isCHide",n)))&&(o=o+1);return{hRow:e,hCol:o}},_updateMergeColl:function(n,i,r,u,f,e,o,s){var c=this.getSheet(n),h=c._mergeColl;t.isNullOrUndefined(h[i])?(h[i]={},h[i][r]={}):t.isNullOrUndefined(h[i][r])&&(h[i][r]={});h[i][r].type=u;s&&(h[i][r].mergeType=s);f&&(h[i][r].isSamePosn=f);c.mergedCells.push({isCenterAlign:o,range:e})},mergeCells:function(i,r){if(!this.model.isReadOnly){var u,o,y,c=1,l=1,a,w=[],e=this.getActiveSheetIndex(),v=this.getSheet(e),k=n("#"+this._id+"_alertdlg"),f,h=!1,p,s=this._getRangeArgs(i,"object",e),b=s[2]-s[0]||s[3]-s[1];if(this.model.allowMerging&&this.model.allowSelection&&b&&!(this.getSheetElement(e).find(".e-ss-activeimg").length>0)&&!this.model.isReadOnly){if(f=this._getSelectedCells(e,s).selCells,this._selMergeCells=[],this._mergeType="merge-cells",(!v._isImported||v._isLoaded)&&!this._isUndoRedo)if(this.performSelection(s),this.mergeCenter){for(h=!1,u=0,a=f.length;u<a;u++)o=this.XLEdit.getPropertyValue(f[u].rowIndex,f[u].colIndex,"merge",e),t.isNullOrUndefined(o)||(c=o.mSpan.rowSpan,l=o.mSpan.colSpan,(c>1||l>1)&&(p=this._getHiddenRowColumnCount(e,this.XLEdit.getPropertyValue(f[u].rowIndex,f[u].colIndex,"merge").mRange),this._unMergeAllCells(e,u,f,w,p.hRow,p.hCol),h=!0));!h||this._dupDetails||this._isUndoRedo||(t.isNullOrUndefined(i)&&(i=this._getSelRange(f)),y={sheetIndex:e,cells:f,range:i,reqType:"merge-cells",action:"un-merge",operation:"un-merge",mCells:w},this._completeAction(y),this._trigActionComplete(y),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),this.performSelection(s))}else for(u=0,a=f.length;u<a;u++)if(o=this.XLEdit.getPropertyValue(f[u].rowIndex,f[u].colIndex,"merge",e),t.isNullOrUndefined(o)||(c=o.mSpan.rowSpan,l=o.mSpan.colSpan),c===1&&l===1){h=!1;break}v._isImported&&!v._isLoaded||this._isUndoRedo||!this._rangeHasData(s)||r||h||!b?h||this._mergeCells(e,f,{},[]):this._showAlertDlg("","MergeCellsAlert","MergeCells",498)}}},_mergeCells:function(i,r,u,f){var a,b,g=0,l=this._dataContainer.sheets[i],v,y,e,s,nt={},c,p,k,h=this.getSheet(i),d=this.XLEdit,w,it=h.columnsWidthCollection,o,tt;if(b=e=r[0].rowIndex,s=r[0].colIndex,this.model.scrollSettings.allowVirtualScrolling||(k=this._getJSSheetHeader(i).find("col")),(t.isNullOrUndefined(d.getPropertyValue(e,0,"isFRHide"))||t.isNullOrUndefined(d.getPropertyValue(e,0,"isRHide")))&&k&&k.eq(s).hasClass("e-fc-hide"))return{hideCell:[],mCells:[]};for(a={rowSpan:this._getRowSpan(i,r),colSpan:this._getColSpan(i,r)},t.isNullOrUndefined(l[e])||t.isNullOrUndefined(l[e][s])||(delete l[e][s].isMHide,delete l[e][s].mergeIdx),this._isRowViewable(i,e)&&(c=this.getCell(e,s),c[0].colSpan=a.colSpan,c[0].rowSpan=a.rowSpan,c[0].className=c[0].className.replace("e-mc-hide",""),this.mergeCenter&&c.addClass("e-calign "),c.hasClass("e-commentcell")&&this.model.allowComments&&this.XLComment._updateCmntArrowPos(c)),this._selMergeCells.push(r[0]),this._textClip(r[0].rowIndex,r[0].colIndex,"add"),this._textClip(r[0].rowIndex,r[0].colIndex,"delete","",!0),this._isRowViewable(i,r[0].rowIndex)&&this.addClass(this.getCell(r[0].rowIndex,r[0].colIndex)[0],"e-moverflow"),g=this._getRowHeight(r[0].rowIndex,i),o=1,tt=r.length;o<tt;o++)this._isRowViewable(i,r[o].rowIndex)&&(p=this.getCell(r[o].rowIndex,r[o].colIndex),this._hasClass(p[0],"e-mc-hide")||this.addClass(p[0],"e-mc-hide"),this.addClass(p[0],"e-moverflow")),b!==r[o].rowIndex&&h.hideRowsCollection.indexOf(r[o].rowIndex)==-1&&(g+=this._getRowHeight(r[o].rowIndex,i),b=r[o].rowIndex),this._textClip(r[o].rowIndex,r[o].colIndex,"add"),this._textClip(r[o].rowIndex,r[o].colIndex,"delete","",!0),u=this._getHiddenCells(i,{rowIndex:r[o].rowIndex,colIndex:r[o].colIndex},r[o],u),this.XLEdit._updateDataContainer({rowIndex:r[o].rowIndex,colIndex:r[o].colIndex},{dataObj:{isMHide:!0,mergeIdx:{rowIndex:e,colIndex:s}},sheetIdx:i}),this._selMergeCells.push(r[o]);return t.isNullOrUndefined(l[e])||n.extend(!0,nt,l[e][s]),y=this._getSelRange(r),h._activeCell=r[0],(!h._isImported||h._isLoaded)&&this.performSelection(r[0],r[r.length-1]),this.XLEdit._updateDataContainer({rowIndex:e,colIndex:s},{dataObj:{merge:{mSpan:a,isMerge:!0,mRange:y,isCenterAlign:this.mergeCenter}}}),this._updateMergeColl(i,e,s,this.mergeCenter?"center":"merge",null,y,this.mergeCenter,this._mergeType),f.push({rowIndex:e,colIndex:s,prevObj:nt,curObj:n.extend(!0,{},l[e][s])}),d.getPropertyValue(e,s,"wrap")&&(w=this._getWrapCellHeight(i,e,s).rowHt,(this._getRowHeight(e,i)<=w||h._isImported||!h._isLoaded)&&(this.setHeightToRows([{rowIndex:e,height:w}]),this._wrapCollection(e,s,w.cellHt,i))),h._isImported&&!h._isLoaded||this._isUndoRedo||this._dupDetails||this._paste||this._mergeType!=="merge-cells"||(v={sheetIndex:i,cells:[{rowIndex:e,colIndex:s}],range:y,reqType:"merge-cells",action:"merge-all",hideCells:u,mCells:f},v.operation=this.mergeCenter?"merge-center":"merge-all",this._paste||(this._completeAction(v),this._trigActionComplete(v))),this.model.showRibbon&&!this._isScrolling&&this.XLRibbon._updateRibbonIcons(),this.mergeCenter=!1,this._paste=!1,this.XLEdit._updateUsedRange(e+a.rowSpan,s+a.colSpan,i),{hideCells:u,mCells:f}},mergeAcrossCells:function(t,i){if(!this.model.isReadOnly){var u=this.getActiveSheetIndex(),f=this.getSheet(u),h=n("#"+this._id+"_alertdlg"),e,r=this._getRangeArgs(t,"object",u),s=r[2]-r[0]||r[3]-r[1],o=r[3]-r[1];!this.model.allowMerging||this.getSheetElement(u).find(".e-ss-activeimg").length>0||!s||this.model.isReadOnly||(this._selMergeCells=[],e=this._getSelectedCells(u,r),this.isUndefined(t)||this.performSelection(r),!this._isUndoRedo&&this._rangeHasData(r)&&(!f._isImported||f._isLoaded)&&!i&&o?this._showAlertDlg("","MergeCellsAlert","MergeAcrossCells",498):o&&this._mergeAcrossCells(u,e.selCells),this.performSelection(r),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons())}},_mergeAcrossCells:function(i,r){var u,e,a,o,s=1,v=1,h=!0,c,y,p,w,b,l=[],f={mCells:[],hideCells:{}},k=this.getSheet(i);for(this._mergeType="merge-across",u=0,a=r.length;u<a;u++)if(o=this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"merge",i),t.isNullOrUndefined(o)||(s=o.mSpan.rowSpan,v=o.mSpan.colSpan),s===1&&v===1){h=!1;break}else s>1&&(h=!1);if(!h)for(w=r[0].rowIndex,b=r[r.length-1].rowIndex,y=r[0].colIndex,p=r[r.length-1].colIndex,u=w;u<=b;u++){for(l=[],e=y;e<=p;e++)l.push({rowIndex:u,colIndex:e});f=this._mergeCells(i,l,f.hideCells,f.mCells)}k._isImported&&!k._isLoaded||this._isUndoRedo||this._dupDetails||(c={sheetIndex:i,cells:n.extend(!0,[],this._selMergeCells),range:this._getSelRange(this._selMergeCells),reqType:"merge-cells",action:"merge-across",operation:"merge-across",hideCells:f.hideCells,mCells:f.mCells},this._paste||(this._completeAction(c),this._trigActionComplete(c)),this._paste=!1);this._mergeType="merge-cells";this.performSelection(r[0],r[r.length-1])},unmergeCells:function(n){var u,l;if(!this.model.isReadOnly){var r=this.getActiveSheetIndex(),e=this.getSheet(r),o=[],i,s,h,f,a=e._clrMergeColl,c=this._getRangeArgs(n,"object",r);if(this.model.allowMerging&&!(this.getSheetElement(r).find(".e-ss-activeimg").length>0)&&!this.model.isReadOnly){for(this._selMergeCells=[],i=this._getSelectedCells(r,c).selCells,u=0,l=i.length;u<l;u++)f=this.XLEdit.getPropertyValue(i[u].rowIndex,i[u].colIndex,"merge",r),this.isUndefined(f)||(h=this._getHiddenRowColumnCount(r,f.mRange),o=this._unMergeAllCells(r,u,i,o,h.hRow,h.hCol),a.push({rowIdx:i[u].rowIndex,colIdx:i[u].colIndex,mergeObj:f}));t.isNullOrUndefined(n)&&(n=this._getSelRange(i));this.performSelection(c);e._isImported&&!e._isLoaded||this._isUndoRedo||this._dupDetails||this._isExport||(s={sheetIndex:r,cells:i,range:n,reqType:"merge-cells",action:"un-merge",operation:"un-merge",mCells:o},this._completeAction(s),this._trigActionComplete(s));this.model.showRibbon&&!this._isScrolling&&this.XLRibbon._updateRibbonIcons()}}},_unMergeAllCells:function(i,r,u,f,e,o){var s,h,e,o,y,k,d,g=1,nt=1,w,b=!1,l=this._dataContainer.sheets[i],ft={},p,tt,v,c,a,et,ot,it,st=this.getSheet(i),rt,ut;if(c=u[r].rowIndex,a=u[r].colIndex,et=this.getRows(i)[0],p=this.getCell(c,a),ut=this.XLEdit.getPropertyValue(c,a,"wrap",i),y=this.XLEdit.getPropertyValue(c,a,"merge",i),t.isNullOrUndefined(y)||(g=y.mSpan.rowSpan,nt=y.mSpan.colSpan),nt>1||g>1)for(it=l[c][a],n.extend(!0,ft,it),delete it.merge,this._clearMergeColl(st._mergeColl,c,a),this._isRowViewable(i,c)&&(p=this.getCell(c,a),ut&&!this.XLEdit.getPropertyValue(c,a,"cellType",i)&&(k=p.find("#"+this._id+"_MergeWrap"),k.length&&(p[0].innerHTML=k[0].innerHTML,k.remove())),t.isNullOrUndefined(y.isCenterAlign)||p.removeClass("e-calign"),p[0].colSpan=p[0].rowSpan=1,ut&&(rt=p[0].offsetHeight,n(et[c]).height()<rt&&this.setHeightToRows([{rowIndex:c,height:rt}]),this.XLScroll._getRowHeights(i,c))),f.push({rowIndex:c,colIndex:a,prevObj:ft,curObj:n.extend(!0,{},l[c][a])}),ot=[],s=c;s<c+g+e;s++)for(h=a;h<a+nt+o;h++)this._selMergeCells.push({rowIndex:s,colIndex:h}),b=!1,this._isRowViewable(i,s)&&(v=this.getCell(s,h,i),b=!0),t.isNullOrUndefined(this.XLEdit.getPropertyValue(s,h,"isMHide",i))||(this._isUndoRedo&&(w=this.XLEdit.getPropertyValue(s,h,"merge",i),t.isNullOrUndefined(w)||(w.mergeSpan.rowSpan>1||w.mergeSpan.colSpan>1)&&(ot.push({rowIndex:s,colIndex:h,rowSpan:w.mergeSpan.rowSpan,colSpan:w.mergeSpan.colSpan}),l[s][h].merge.mSpan={rowSpan:1,colSpan:1},v[0].rowSpan=1,v[0].colSpan=1)),d=this.XLEdit.getPropertyValue(s,h,"mergeIdx",i),t.isNullOrUndefined(d)||d.rowIndex===c&&d.colIndex===a&&(b&&(v.removeClass("e-mc-hide"),v[0].rowSpan=1,v[0].colSpan=1),delete l[s][h].isMHide,delete l[s][h].mergeIdx)),this._isUndoRedo&&!t.isNullOrUndefined(this._delCells)&&(t.isNullOrUndefined(this._delCells[s])||t.isNullOrUndefined(this._delCells[s][h])||t.isNullOrUndefined(l[s])||(tt=!t.isNullOrUndefined(l[s][h])&&l[s][h].overflow,l[s][h]=this._delCells[s][h].value,tt&&(l[s][h].overflow=tt),b&&v.text(this._delCells[s][h].text),y=this.XLEdit.getPropertyValue(s,h,"merge"),!t.isNullOrUndefined(y)&&y.isMerge&&this.mergeCells(y.mRange,!0))),b&&v.hasClass("e-commentcell")&&this.model.allowComments&&this.XLComment._updateCmntArrowPos(v),b&&(this._removeClass(v[0],"e-moverflow"),v.text().length>0?this._textClip(s,h,"add"):this._textClip(s,h,"delete")),t.isNullOrUndefined(l[s])||(this.getObjectLength(l[s][h])<1&&delete l[s][h],this.getObjectLength(l[s])<1&&delete l[s]);return f},_refreshMergeCells:function(){var i,t,r,n;for(this._dupDetails=!0,i=this._removeMergeColl,t=0,r=i.length;t<r;t++)this.unmergeCells(i[t].merge.mRange,!0);this._dupDetails=!1;n=this._insData;switch(n.value.status){case"shiftRight":this._insertShiftRight(n.sheetIdx,n.startCell,n.endCell,n.value);break;case"shiftBottom":this._insertShiftBottom(n.sheetIdx,n.startCell,n.endCell,n.value);break;case"shiftUp":this._deleteShiftUp(n.sheetIdx,n.startCell,n.endCell,n.value);break;case"shiftLeft":this._deleteShiftLeft(n.sheetIdx,n.startCell,n.endCell,n.value)}},_showHeadings:function(n,t){if(!this.model.isReadOnly){var i,t=t?t:this.getActiveSheetIndex(),r=this.getSheet(t),e=this._getJSSheetHeader(t),o=this._getContent(t).find(".e-content"),s=this._getJSSheetRowHeader(t),u=this.getFrozenRows(),f=this.getFrozenColumns();r.showHeadings=n;this._isDisplayHeader=!0;r.showHeadings?(s.show(),e.show(),o.removeClass("e-viewbrdr")):(s.hide(),e.hide(),o.addClass("e-viewbrdr"));this._heightWidthCalculation(t,{action:r._isLoaded?"":"initial"});this.model.showRibbon&&(i=this.element.find("#"+this._id+"_Ribbon_PageLayout_Show_Headings").data("ejCheckBox"),i&&(n?i._checked():i._unChecked()));this.model.allowFreezing&&r._isFreezed&&(this.XLFreeze.unfreezePanes(),this._isFrozen(u)&&this._isFrozen(f)?this.XLFreeze.freezePanes(u,f):this._isFrozen(u)?this.XLFreeze.freezeRows(u):this._isFrozen(f)&&this.XLFreeze.freezeColumns(f))}},showHeadings:function(n){this._showHeadings(n)},showGridlines:function(n){this._showGridlines(n)},_showGridlines:function(n,t){if(!this.model.isReadOnly){var i,t=t?t:this.getActiveSheetIndex(),r=this.getSheet(t),u=this._getContent(t).find(".e-rowcell");this.model.showRibbon&&(i=this.element.find("#"+this._id+"_Ribbon_PageLayout_Show_Gridlines").data("ejCheckBox"),i&&(n?i._checked():i._unChecked()));r.showGridlines=n;r.showGridlines?u.removeClass("e-hborder"):u.addClass("e-hborder")}},setSheetFocus:function(){if(!this._hasClass(document.activeElement,"e-datepicker"))if(t.browserInfo().name=="msie")try{this.element[0].setActive()}catch(n){}else this.element.focus();this._isInitLoad||window.scrollTo(window.pageXOffset,window.pageYOffset)},_diffNumbers:function(n,t){return n-t},_isValidDate:function(n){var t,i;return/^\d{1,4}[\.|\/|-]\d{1,2}[\.|\/|-]\d{1,4}$/.test(n)?(n=n.replace(/0*(\d*)/gi,"$1"),t=n.split(/[\.|\/|-]/),t[0]=t[0]-1,t[2].length<4&&(t[2]=parseInt(t[2])<50?2e3+parseInt(t[2]):1900+parseInt(t[2])),i=new Date(t[2],t[0],t[1]),i.getDate()!=t[1]||i.getMonth()!=t[0]||i.getFullYear()!=t[2]?!1:!0):!1},_isValidTime:function(n){for(var t,r,i=0,o=!1,f,e,u=0,s=n.length;u<s;u++){if(t=n.substring(u,u+1),(t<"0"||t>"9")&&t!=":"&&t!=" "&&t!="a"&&t!="A"&&t!="p"&&t!="P"&&t!="m"&&t!="M")return!1;t==":"&&i++;(t=="p"||t=="P"||t=="a"||t=="A")&&(o=!0)}return i<1||i>2?!1:(r=n.substring(0,n.indexOf(":")),parseFloat(r)<0||parseFloat(r)>23)?!1:o&&(parseFloat(r)<1||parseFloat(r)>12)?!1:(f=i==2?n.substring(n.indexOf(":")+1,n.lastIndexOf(":")):n.substring(n.indexOf(":")+1,n.length),parseFloat(f)<0||parseFloat(f)>59)?!1:(e=i==2?n.substring(n.lastIndexOf(":")+1,n.length):"00",parseFloat(e)<0||parseFloat(e)>59)?!1:!0},_setXY:function(n,t){var i=0,r=0;return t=t?"page":"client",n.type==="mousemove"||n.type==="mousedown"||n.type==="mouseup"?(i=n[t+"X"],r=n[t+"Y"]):n.type==="touchmove"||n.type==="touchstart"||n.type==="touchend"?(i=n.originalEvent.changedTouches[0][t+"X"],r=n.originalEvent.changedTouches[0][t+"Y"]):(n.type==="MSPointerMove"||n.type==="pointermove"||n.type==="MSPointerUp"||n.type==="pointerup"||n.type==="MSPointerDown"||n.type==="pointerdown")&&(i=n.originalEvent[t+"X"],r=n.originalEvent[t+"Y"]),[i,r]},_getSelectedItems:function(n,i,r){var f,e,o,u;return n=n?n:this.getActiveSheetIndex(),u=this.getSheet(n),t.isNullOrUndefined(r)&&t.isNullOrUndefined(i)?(f=u._selectedCells,e=u._startCell,o=u._endCell,r=this._generateHeaderText(e.colIndex+1)+(e.rowIndex+1)+":"+this._generateHeaderText(o.colIndex+1)+(o.rowIndex+1)):(i=this.isUndefined(i)?this.getRangeIndices(r):i,f=this.getRange(i,n),r=this._generateHeaderText(i[1]+1)+(i[0]+1)+":"+this._generateHeaderText(i[3]+1)+(i[2]+1)),[f,r]},setBorder:function(n,t){if(this.model.allowCellFormatting&&!this.model.isReadOnly){var u,f="",e=!1,l=n.style,r=n.type,h=n.color,o,a,c,v,i,y,s=this._getContent(this.getActiveSheetIndex()).find("div:first-child");if(this.model.allowSelection||r!=="drawborder"&&r!=="drawbordergrid"){o=["bottom","top","left","right","outside","allborder"];a=["thickbox","thickbottom","topandbottom","topandthickbottom"];c={top:{top:""},right:{right:""},bottom:{bottom:""},left:{left:""},outside:{top:"",right:"",bottom:"",left:""},thickbox:{top:"2px solid",right:"2px solid",bottom:"2px solid",left:"2px solid"},thickbottom:{bottom:"2px solid"},topandbottom:{top:"1px solid",bottom:"1px solid"},topandthickbottom:{top:"1px solid",bottom:"2px solid"}};v={solid:"1px solid",dashed:"1px dashed",dotted:"1px dotted"};this.model.allowSelection&&(this.XLSelection._isGridBordering=this.XLSelection._isOutsideBordering=!1);switch(!0){case o.indexOf(r)>-1:e=r===o[5];i=c[e?o[4]:r];for(u in i)i[u]=v[l]+" "+h;e&&(i.isGridBorder=e);i.property=n;this.XLFormat.applyBorder(i,t);break;case a.indexOf(r)>-1:i=c[r];for(u in i)f="",y=i[u].split(" "),f=y.length===2?f+i[u]+" "+h:f+i[u]+" "+l+" "+h,i[u]=f;i.property=n;this.XLFormat.applyBorder(i,t);break;case r==="noborder":this.XLFormat.applyBorder("noborder",t);break;case r==="drawborder":this.XLSelection._isOutsideBordering=!0;s.removeClass("e-ss-cursor");s.addClass("e-ss-drwbrdrcursor");this.XLSelection._cleanUp(!0);break;case r==="drawbordergrid":this.XLSelection._isGridBordering=!0;s.removeClass("e-ss-cursor");s.addClass("e-ss-drwbrdrgridcursor");this.XLSelection._cleanUp(!0)}}}},clearBorder:function(n){this.model.isReadOnly||(n=this._getRangeArgs(n,"object"),this.XLFormat.removeStyle(n,{cellStyle:!0,tableStyle:!0,border:!0}))},clearHyperlinks:function(){this.model.allowClear&&!this.model.isReadOnly&&this._removeHyperlink("clear")},clearComments:function(n){this.model.allowClear&&!this.model.isReadOnly&&this.model.allowComments&&this.XLComment.deleteComment(i,n,!1,"clear")},clearAllFormat:function(i){if(this.model.allowClear&&!this.model.isReadOnly){var c,s=this.getActiveSheetIndex(),l=this._dataContainer.sheets[s],f=[],e,o,h=this.getSheet(s),r=this._getRangeArgs(i,"object"),a,u={sheetIndex:s,reqType:"clear-format",range:r};(u.bData=n.extend(!0,[],this.getRangeData({range:r,property:["format","tformats","type","formatStr","decimalPlaces","thousandSeparator","formats","hyperlink","cFormatRule"]})),this._dupDetails=!0,e=this.getObjectKeys(l),f[0]=r[0]>parseInt(e[0])?r[0]:parseInt(e[0]),f[2]=r[2]<parseInt(e[e.length-1])?r[2]:parseInt(e[e.length-1]),o=this.getObjectKeys(l[f[2]]),f[1]=r[1]>parseInt(o[0])?r[1]:parseInt(o[0]),f[3]=r[3]<parseInt(o[o.length-1])?r[3]:parseInt(o[o.length-1]),t.isNullOrUndefined(e))||(a=this._checkTableRange(this._getAlphaRange(s,f[0],f[1],f[2],f[3])),a.status!=="partial")&&(this.clearRangeData(r,["format","formatStr","decimalPlaces","thousandSeparator","formats","hyperlink","cFormatRule","border"],"",!1,u.reqType),this.clearBorder(i),this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(r),h._clrWrapColl=[],h._clrMergeColl=[],this._isPaste=!0,this.setWrapText("unwrap",r),this._isPaste=!1,this.unmergeCells(r),u.wrapColl=n.extend(!0,[],h._clrWrapColl),u.mergeColl=n.extend(!0,[],h._clrMergeColl),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),this._dupDetails=!1,this._isUndoRedo||(this._completeAction(u),c={sheetIndex:u.sheetIndex,reqType:u.reqType,range:u.range,prevData:u.bData,prevMergeColl:u.mergeColl,prevWrapColl:u.wrapColl},this._trigActionComplete(c)))}},clearContents:function(t){if(!this.model.isReadOnly){t=this._getRangeArgs(t,"object");var r=this.getActiveSheetIndex(),u,f=this.getRangeData({range:t,property:["value","value2","type","hyperlink"]}),i={sheetIndex:r,reqType:"clear-content",range:t,bData:n.extend(!0,[],f)};this.model.allowClear&&!this._isPropExists([t],"isReadOnly",r)&&(this.clearRangeData(t,["value","value2","hyperlink"],"",!1,i.reqType),this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t),this._completeAction(i),u={sheetIndex:i.sheetIndex,reqType:i.reqType,range:i.range,prevData:i.bData},this._trigActionComplete(u),this.setSheetFocus(),this.model.allowFormulaBar&&this.updateFormulaBar())}},clearAll:function(i){if(!this.model.isReadOnly){var e,o,a,l,h,s=this.getActiveSheetIndex(),c=this.getSheet(s),f=[],u=this._getRangeArgs(i,"object"),r={sheetIndex:s,reqType:"clear-all",range:u},v=this._dataContainer.sheets[s];if(this.model.allowClear&&!this._isPropExists([u],"isReadOnly",s)&&(this._dupDetails=!0,e=this.getObjectKeys(v),f[0]=u[0]>parseInt(e[0])?u[0]:parseInt(e[0]),f[2]=u[2]<parseInt(e[e.length-1])?u[2]:parseInt(e[e.length-1]),o=this.getObjectKeys(v[f[2]]),f[1]=u[1]>parseInt(o[0])?u[1]:parseInt(o[0]),f[3]=u[3]<parseInt(o[o.length-1])?u[3]:parseInt(o[o.length-1]),l=this._getAlphaRange(s,f[0],f[1],f[2],f[3]),!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(o))){if(r.bData=n.extend(!0,[],this.getRangeData({range:u,property:["value","value2","hyperlink","merge","rule","cFormatRule","comment","format","formatStr","formats","tformat","decimalPlaces","thousandSeparator","type","borders","tborders"],sheetIdx:s})),r.bBorder=this.XLFormat.getHashCodeClassAsArray(u),h=this._checkTableRange(l),h.status==="full")r.tblObj=h.tableObj,r.tblObj.tblId=h.tblId,r.tblObj.header=!0,this.XLFormat.removeTable(r.tblObj.tblId);else if(h.status==="partial")return;this.clearRangeData(u,["value","value2","hyperlink","cFormatRule","comment","format","formats","formatStr","decimalPlaces","thousandSeparator","border"],"",!1);this.clearBorder(l);this.model.allowFiltering&&this.XLFilter.clearFilter("remove");c._clrMergeColl=[];c._clrWrapColl=[];this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(u);this.model.allowDataValidation&&this.XLValidate.clearDV();this._isPaste=!0;this.setWrapText("unwrap",u);this._isPaste=!1;this.unmergeCells(u);r.mergeColl=n.extend(!0,[],c._clrMergeColl);r.wrapColl=n.extend(!0,[],c._clrWrapColl);this._dupDetails=!1;this.model.showRibbon&&(this.XLRibbon._updateRibbonIcons(),this.XLRibbon._toggleDesignTab(this.getActiveCell()));this._completeAction(r);a={sheetIndex:r.sheetIndex,reqType:r.reqType,range:r.range,prevData:r.bData,prevBorder:r.bBorder,tblObj:r.tblObj,mergeColl:r.mergeColl,wrapColl:r.wrapColl};this._trigActionComplete(a)}}},_checkTableRange:function(n,t){var o,s=this.getActiveSheetIndex(),h=this.model.sheets[s],u,f,i,c=this.getRangeIndices(n),r,e;return t?r=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"tableName"):(e=this.XLEdit._getPropWithCellIdx(c,"tableName"),e.length&&(r=e[0].value)),r?(u=this._getTableID(r),f=h.tableManager[u],i=f.range,o=this._getAlphaRange(s,i[0],i[1],i[2],i[3]),n===o?{status:"full",tableObj:f,tblId:u}:{status:"partial"}):{status:"no-table"}},_checkFilterRange:function(n,t){var u,s=this.getActiveSheetIndex(),h=this.getSheet(s),i,c=this.getRangeIndices(n),f,e,o=h.filterSettings.tableRange,r;if(t?f=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"isFilterHeader"):(e=this.XLEdit._getPropWithCellIdx(c,"isFilterHeader"),e.length&&(f=e[0].value)),f){for(r=0;r<o.length;r++)if(o[r].tableID===-1)return i=o[r],u=this._getAlphaRange(s,i.startRow-1,i.multifilterIdx[0],i.endRow,i.multifilterIdx[i.multifilterIdx.length-1]),n===u?{status:"full",tRange:u,tblId:-1}:{status:"partial"};return{status:"no-table"}}return{status:"no-table"}},clearTextNode:function(n,i){if(!t.isNullOrUndefined(n)&&!this.model.isReadOnly){var r=this.getActiveSheetIndex(),u=n[0].parentNode.rowIndex,f=n[0].cellIndex,o=this._dataContainer.sheets[r],e=n[0].childNodes[n[0].childNodes.length-1];(i=i||"",this._checkIndicesInContainer(r,u,f,"rule")&&o[u][f].rule.type==="list")||t.isNullOrUndefined(e)||e.hasChildNodes("a")||(n[0].lastChild.textContent=i)}},_isClassHasProperty:function(n,t,i){var r=this.XLFormat.getFormatFromHashCode(n);return r[t]&&r[t].toLowerCase()===i?!0:!1},_changeTargetWithOffset:function(t){var r,i=n(t.target),u=t.offsetX||t.pageX-i.offset().left;if(this._hasClass(document.activeElement,"e-datepicker")&&t.type==="mouseup"&&n("#"+this._id).focus(),i.is("a")&&(r=t.target,t.target=t.target.parentNode),i.is("#"+this._id+"_MergeWrap"))return i.parents().closest("td")[0];if(this._hasClass(i.parents().closest("td"),"e-cellreadonly"))return this._hasClass(i,"e-datepicker")&&t.type==="mouseup"&&i.focus(),i.parents().closest("td")[0];if(i.is("td")&&this._hasClass(i,"e-cellreadonly")&&i.find(".e-chk-image").length>0&&t.type==="mouseup")return n("#"+i.find(".e-checkbox")[0].id).ejCheckBox("instance")._checkedHandler(),t.target;if((u>t.target.offsetWidth||u<0)&&i.is("td")&&i.parents(".e-spreadsheetmainpanel").length&&this._hasClass(i,"e-rowcell")){var f=this.getSheet(this.getActiveSheetIndex()),e=this._getCellIdx(t.target),o=f._colWidthCollection[e.colIndex]+u,s=f._rowHeightCollection[e.rowIndex];return r&&this.addClass(r,"e-rmanchor"),this.getCell(this.XLShape._getCellIndexFromOffset(s,o).rowIndex,this.XLShape._getCellIndexFromOffset(s,o).colIndex)[0]}return r?(this._removeClass(r,"e-rmanchor"),r):(this._removeClass(i.find("a")[0],"e-rmanchor"),t.target)},_textClip:function(n,i,r,u,f){var tt,e,y,o;if(this._canOverflow&&!this.XLEdit.getPropertyValue(n,i,"merge")&&!this.XLEdit.getPropertyValue(n,i,"wrap")){var l,w,b,p,v,it,a,st,ut,at,ht,c,ct,ft,d,et=!1,nt=!1,k=!1,lt=!1,s=this.XLEdit,h=this.getActiveSheetIndex(),ot=this.getSheet(h),g=ot._isLoaded||this.isImport,tt=this.getCell(n,i),rt=s.getPropertyValue(n,i,"format",h);if(tt&&(p=tt[0]),this._isClassHasProperty(rt,"text-align","right")&&(k=!0),!(s.getPropertyValue(n,i,"cellType",h)>-1)){if(this._dupDetails||(this._dupDetails=et=!0),r==="add"){if(!this.model.allowOverflow){this.addClass(p,"e-overflow");s._updateDataContainer({rowIndex:n,colIndex:i},{dataObj:{isOverflow:!1},skipCell:!0});et&&(this._dupDetails=!1);return}if(this._hasClass(p,"e-overflow")&&this._removeClass(p,"e-overflow"),this.clearRangeData([n,i,n,i],["isOverflow"],"","","",!0),s.getPropertyValue(n,i+1,"value2",h)&&!k&&(nt=!0),nt||(at=ot._rowHeightCollection,ht=ot._ofColWidthColl,ft=p?this.XLFormat.getFormatFromHashCode(this.XLFormat.getFormatClass(p.className)):{},u||(d=document.getElementById(this._id+"_emptySpan"),this.addClass(d,"e-rowcell e-wrapword"),this.addClass(d,rt),d.textContent=s.getPropertyValue(n,i,"value2",h),u="text-indent"in ft?Math.round(4/3*Number(ft[t.Spreadsheet.SupportedStyles.TextIndent].replace("pt",""))+this._detailsFromGlobalSpan(n,i,"width",d.textContent,null,!0)):d.offsetWidth),this._refreshGlobalSpan(d),st=this.XLShape._getCellIndexFromOffset(null,ht[i]+u,h,!0),b=st.colIndex-i),!f&&s.getPropertyValue(n,i,"value2",h)&&(c=s.getPropertyValue(n,i,"overflow",h),!t.isNullOrUndefined(c)&&c.rowIndex===n))if(ut=this.getCell(c.rowIndex,c.colIndex),ut&&this.addClass(ut[0],"e-overflow"),s._updateDataContainer({rowIndex:c.rowIndex,colIndex:c.colIndex},{dataObj:{isOverflow:!1},skipCell:!0}),c.colIndex<i)for(e=0,y=c.cellCount;e<=y;e++)e!==0&&this.clearRangeData([n,c.colIndex+e,n,c.colIndex+e],["overflow"],"","","",!0),e!==y&&(v=this.getCell(n,c.colIndex+e),g&&v&&this._removeClass(v[0],"e-ofbrdr"),this.clearRangeData([n,c.colIndex+e,n,c.colIndex+e],["isOfBrdr"],"","","",!0));else for(e=c.cellCount;e>0;e--)this.clearRangeData([n,c.colIndex-e,n,c.colIndex-e],["overflow"],"","","",!0),v=this.getCell(n,c.colIndex-e),g&&v&&this._removeClass(v[0],"e-ofbrdr"),this.clearRangeData([n,c.colIndex-e,n,c.colIndex-e],["isOfBrdr"],"","","",!0);if(k||nt){for(e=i-1,y=i-b;e>=y;e--)if(a=s.getPropertyValue(n,e,"overflow",h),a&&a.colIndex!==i&&!lt&&(lt=!0,this._textClip(a.rowIndex,a.colIndex,"delete","",!0),tt=this.getCell(a.rowIndex,a.colIndex),tt&&this.addClass(tt[0],"e-overflow")),s.getPropertyValue(n,e,"value2",h)){nt=!0;break}}else for(e=1;e<=b;e++)if(s.getPropertyValue(n,i+e,"value2",h)||s.getPropertyValue(n,i+e,"merge",h)||s.getPropertyValue(n,i+e,"isMHide",h)||s.getPropertyValue(n,i+e,"overflow",h)&&s.getPropertyValue(n,i+e,"overflow",h).colIndex!==i){nt=!0;break}if(nt)this.addClass(p,"e-overflow"),s._updateDataContainer({rowIndex:n,colIndex:i},{dataObj:{isOverflow:!1},skipCell:!0});else if(b!==0)for(e=0;e<=b;e++)it=k?i-e:i+e,e&&s._updateDataContainer({rowIndex:n,colIndex:it},{dataObj:{overflow:{rowIndex:n,colIndex:i,cellCount:b}},skipCell:!0}),((!k||k&&e!==0)&&e!==b||e===b&&k)&&(g&&this._isRowViewable(h,n)&&this.addClass(this.getCell(n,it)[0],"e-ofbrdr"),s._updateDataContainer({rowIndex:n,colIndex:it},{dataObj:{isOfBrdr:!0},skipCell:!0}))}else if(r==="delete"){if(ct=this._dataContainer.sheets[h],l=this.getObjectKeys(ct[n]),this._hasClass(p,"e-overflow"))this._removeClass(p,"e-overflow"),this.clearRangeData([n,i,n,i],["isOverflow"],"","","",!0);else if(k){if(a=s.getPropertyValue(n,i-1,"overflow",h),!t.isNullOrUndefined(a)&&a.colIndex===i)for(o=i-1,y=i-a.cellCount;o>=y;o--)this.clearRangeData([n,o,n,o],["overflow"],"","","",!0),g&&(v=this.getCell(n,o),v&&this._removeClass(v[0],"e-ofbrdr")),this.clearRangeData([n,o,n,o],["isOfBrdr"],"","","",!0)}else if(a=s.getPropertyValue(n,i+1,"overflow",h),!t.isNullOrUndefined(a)&&a.colIndex===i)for(o=i,y=i+1+a.cellCount;o<y;o++)o!==i&&this.clearRangeData([n,o,n,o],["overflow"],"","","",!0),o!==y&&(g&&(v=this.getCell(n,o),v&&this._removeClass(v[0],"e-ofbrdr")),this.clearRangeData([n,o,n,o],["isOfBrdr"],"","","",!0));if(!f&&this.model.allowOverflow){for(o=l.indexOf(i.toString())-1;o>-1;o--)if(g&&(w=this.getCell(n,l[o])),s.getPropertyValue(n,l[o],"value2",h)||s.getPropertyValue(n,l[o],"isMHide",h)){this._hasClass(w,"e-overflow")&&(w&&this._removeClass(w[0],"e-overflow"),this.clearRangeData([n,l[o],n,l[o]],["isOverflow"],"","","",!0),this._textClip(n,parseInt(l[o]),"add"));break}for(o=l.indexOf(i.toString())+1;o<l.length;o++)if(g&&(w=this.getCell(n,l[o])),s.getPropertyValue(n,l[o],"value2",h)||s.getPropertyValue(n,l[o],"isMHide",h)){rt=s.getPropertyValue(n,l[o],"format",h);this._hasClass(w,"e-overflow")&&this._isClassHasProperty(rt,"text-align","right")&&(w&&this._removeClass(w[0],"e-overflow"),this.clearRangeData([n,l[o],n,l[o]],["isOverflow"],"","","",!0),this._textClip(n,parseInt(l[o]),"add"));break}}}et&&(this._dupDetails=!1)}}},selectAll:function(n){if(this.model.allowSelection){var d,y=[],w=[],k=[],b=[],r,i,s,nt=!1,p=0,v=this.XLEdit,tt=this.getActiveCell(),e=tt.rowIndex,o=tt.colIndex,h=this.getActiveSheetIndex(),ut=this._dataContainer.sheets[h],g=this.getObjectKeys(ut),ft=parseInt(g[0]),et=parseInt(g[g.length-1]),l=this.getSheet(h),it=this._getUsedRangeFromSheet(h,!1),rt=it.rowCount+it.colCount;if(l._startCell.rowIndex!==l._endCell.rowIndex||l._startCell.colIndex!==l._endCell.colIndex&&l._isMultiSelect){var f={rowIndex:l._startCell.rowIndex,colIndex:l._startCell.colIndex},u={rowIndex:l._endCell.rowIndex,colIndex:l._endCell.colIndex},a={rowIndex:l._startCell.rowIndex,colIndex:l._startCell.colIndex},c={rowIndex:l._endCell.rowIndex,colIndex:l._endCell.colIndex};for(nt=!0,r=1;r<rt;r++){for(i=a.colIndex;i<c.colIndex+2;i++)(v.getPropertyValue(a.rowIndex-1,i,"value2",h)||this._getDataObj(a.rowIndex-1,i,"mergeIdx",h))&&(f.colIndex=a.colIndex<i?a.colIndex:i,u.colIndex=c.colIndex>i?c.colIndex:i,f.rowIndex=a.rowIndex<a.rowIndex-1?a.rowIndex:a.rowIndex-1);for(i=a.rowIndex;i<c.rowIndex+2;i++)(v.getPropertyValue(i,c.colIndex+1,"value2",h)||this._getDataObj(i,c.colIndex+1,"mergeIdx",h))&&(u.rowIndex=c.rowIndex>i?c.rowIndex:i);for(i=c.colIndex;i>a.colIndex-2;i--)(v.getPropertyValue(c.rowIndex+1,i,"value2",h)||this._getDataObj(c.rowIndex+1,i,"mergeIdx",h))&&(u.rowIndex=c.rowIndex>c.rowIndex+1?c.rowIndex:c.rowIndex+1,f.colIndex=a.colIndex<i?a.colIndex:i);for(i=c.rowIndex;i>a.rowIndex-2;i--)(v.getPropertyValue(c.rowIndex+1,i,"value2",h)||this._getDataObj(c.rowIndex+1,i,"mergeIdx",h))&&(u.rowIndex=c.rowIndex>c.rowIndex+1?c.rowIndex:c.rowIndex+1,f.colIndex=a.colIndex<i?a.colIndex:i);if(u.colIndex===c.colIndex&&u.rowIndex===c.rowIndex&&f.rowIndex===a.rowIndex&&f.colIndex===a.colIndex)if(r===1){l._isRangeSelected=!0;break}else{l._isRangeSelected=!1;break}a={rowIndex:f.rowIndex,colIndex:f.colIndex};c={rowIndex:u.rowIndex,colIndex:u.colIndex}}}if(!l._isRangeSelected&&!nt){var f={rowIndex:e,colIndex:o},u={rowIndex:e,colIndex:o},a={rowIndex:e,colIndex:o},c={rowIndex:e,colIndex:o};for(r=1;r<rt+1;r++){for(i=-p;i<p+1;i++)(v.getPropertyValue(e+i,o+r,"value2",h)||this._getDataObj(e+i,o+r,"mergeIdx",h))&&(u.rowIndex=u.rowIndex>e+i?u.rowIndex:e+i,u.colIndex=u.colIndex>o+r?u.colIndex:o+r);for((v.getPropertyValue(e+r,o+r,"value2",h)||this._getDataObj(e+r,o+r,"mergeIdx",h))&&(u.rowIndex=u.rowIndex>e+r?u.rowIndex:e+r,u.colIndex=u.colIndex>o+r?u.colIndex:o+r),i=-p;i<p+1;i++)(v.getPropertyValue(e+r,o+i,"value2",h)||this._getDataObj(e+r,o+i,"mergeIdx",h))&&(u.rowIndex=u.rowIndex>e+r?u.rowIndex:e+r,u.colIndex=u.colIndex>o+i?u.colIndex:o+i);if(!v.getPropertyValue(e,o,"value2",h)&&u.colIndex===c.colIndex&&u.rowIndex===c.rowIndex&&f.rowIndex===a.rowIndex&&f.colIndex===a.colIndex&&p===0){l._isRangeSelected=!0;break}for((v.getPropertyValue(e+r,o-r,"value2",h)||this._getDataObj(e+r,o-r,"mergeIdx",h))&&(u.rowIndex=u.rowIndex>e+r?u.rowIndex:e+r,f.colIndex=f.colIndex<o-r?f.colIndex:o-r),i=-p;i<p+1;i++)(v.getPropertyValue(e+i,o-r,"value2",h)||this._getDataObj(e+i,o-r,"mergeIdx",h))&&(f.rowIndex=f.rowIndex<e+i?f.rowIndex:e+i,f.colIndex=f.colIndex<o-r?f.colIndex:o-r,u.rowIndex=u.rowIndex>e+i?u.rowIndex:e+i);for((v.getPropertyValue(e-r,o-r,"value2",h)||this._getDataObj(e-r,o-r,"mergeIdx",h))&&(f.rowIndex=f.rowIndex<e-r?f.rowIndex:e-r,f.colIndex=f.colIndex<o-r?f.colIndex:o-r),i=-p;i<p+1;i++)(v.getPropertyValue(e-r,o+i,"value2",h)||this._getDataObj(e-r,o+i,"mergeIdx",h))&&(f.rowIndex=f.rowIndex<e-r?f.rowIndex:e-r,f.colIndex=f.colIndex<o+i?f.colIndex:o+i,u.colIndex=u.colIndex>o+i?u.colIndex:o+i);if((v.getPropertyValue(e-r,o+r,"value2",h)||this._getDataObj(e-r,o+r,"mergeIdx",h))&&(f.rowIndex=f.rowIndex<e-r?f.rowIndex:e-r,u.colIndex=u.colIndex>o+r?u.colIdx:o+r),u.colIndex===c.colIndex&&u.rowIndex===c.rowIndex&&f.rowIndex===a.rowIndex&&f.colIndex===a.colIndex)if(p!==0){l._isRangeSelected=!1;break}else{l._isRangeSelected=!0;break}a={rowIndex:f.rowIndex,colIndex:f.colIndex};c={rowIndex:u.rowIndex,colIndex:u.colIndex};p++;y.push(u.colIndex);w.push(f.rowIndex);k.push(u.rowIndex);b.push(f.colIndex)}for(b=t.dataUtil.mergeSort(t.distinct(b)),f.colIndex=b[b.length-1],s=b.length-1;s>-1;s--)if(b[s-1]===b[s]-1)f.colIndex=b[s-1];else break;for(k=t.dataUtil.mergeSort(t.distinct(k)),u.rowIndex=k[0],s=0,d=k.length-1;s<d;s++)if(k[s+1]===k[s]+1)u.rowIndex=k[s+1];else break;for(w=t.dataUtil.mergeSort(t.distinct(w)),f.rowIndex=w[w.length-1],s=w.length-1;s>-1;s--)if(w[s-1]===w[s]-1)f.rowIndex=w[s-1];else break;for(y=t.dataUtil.mergeSort(t.distinct(y)),u.colIndex=y[0],s=0,d=y.length-1;s<d;s++)if(y[s+1]===y[s]+1)u.colIndex=y[s+1];else break;for(s=0,d=y.length-1;s<d;s++)if(y[s+1]===y[s]+1)u.colIndex=y[s+1];else break}l._isEmptyActiveCell||(!l._isRangeSelected&&!g.length<1?(this.XLSelection.selectRange(f,u,h,n),l._isMultiSelect=!1,l._startCell=f,l._endCell=u,l._isRangeSelected=!0,l._isEmptyActiveCell=v.getPropertyValue(e,o,"value2",h)?!1:!0):(this.XLSelection.selectSheet(),l._isRangeSelected=!0))}},_getDataObj:function(n,t,i,r){var u=this._dataContainer.sheets[r?r:this.getActiveSheetIndex()];return u[n]&&u[n][t]?u[n][t][i]:!1},_getUsedRangeFromSheet:function(n,t){n=this._getSheetIndex(n);var f,r,o=this.getSheet(n),h=this._dataContainer,s=h.sheets[n],e=this.getObjectKeys(s),u={rowIndex:parseInt(e[0])||0,colIndex:0},i={rowIndex:parseInt(e[e.length-1])||0,colIndex:0};for(f=0,length=e.length;f<length;f++)r=this.getObjectKeys(s[parseInt(e[f])]),f===0?(u.colIndex=parseInt(r[0]),i.colIndex=parseInt(r[r.length-1])):(u.colIndex=u.colIndex<parseInt(r[0])?u.colIndex:parseInt(r[0]),i.colIndex=i.colIndex>parseInt(r[r.length-1])?i.colIndex:parseInt(r[r.length-1]));return i.rowIndex<o.usedRange.rowIndex&&(i.rowIndex=o.usedRange.rowIndex),i.colIndex<o.usedRange.colIndex&&(i.colIndex=o.usedRange.colIndex),t?this._getAlphaRange(n,u.rowIndex,u.colIndex,i.rowIndex,i.colIndex):{startCell:u,endCell:i,rowCount:i.rowIndex-u.rowIndex+1,colCount:i.colIndex-u.colIndex+1}},sheetRename:function(n){this.model.isReadOnly||this._updateSheetNames(n)},_isSubMenuOpen:function(){for(var i=["_formatastable","_cellstyles","_Ribbon_CElement","_contextMenuCell","_contextMenuColumnHeader","_contextMenuRowHeader","_contextMenuFooter"],t=0,r=i.length;t<r;){if(n("#"+this._id+i[t]).is(":visible"))return!0;t++}return!1},copySheet:function(n,i,r){if(!this.model.isReadOnly){var y=this._getSheetIndex(y),u,f,a,e,v=!1,c=2,h,s=this.model.sheets,o=this.element.find(".e-numericcontainer").children().eq(n-1),l=i;if(!r&&s[l].sheetInfo.text===o.text()){this.setSheetFocus();return}for(f=1,a=s.length;f<a;f++)s.length-1!==l&&s[l].sheetInfo.text===s[f].sheetInfo.text&&(u=f),o.text()===s[f].sheetInfo.text&&(h=f);if(r){for(o.text().match(".*[ ]+[(]+[0-9]+[)]$")===null?e=o.text()+" ("+c+")":o.text().lastIndexOf(" ")>-1&&(c=parseInt(o.text().substring(o.text().lastIndexOf("(")+1,o.text().lastIndexOf(")"))),e=o.text().substring(0,o.text().lastIndexOf(" "))+" ("+c+")");!v;){for(e=e.substring(0,e.lastIndexOf(" "))+" ("+c+")",f=1,a=s.length;f<a;f++)e===s[f].sheetInfo.text&&c++;c===parseInt(e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")")))&&(v=!0)}this._copySheetProcess(h,e);h=this.model.sheetCount;t.isNullOrUndefined(u)&&(u=h)}else!t.isNullOrUndefined(u)&&u>h&&(u=u-1);t.isNullOrUndefined(u)&&(u=l);r||u!==h?(this._swapSheetDtCntr(h,u),this.getPager().ejPager("option",{currentPage:l}),this.gotoPage(l,!1),this.setSheetFocus()):this.setSheetFocus()}},getHyperlink:function(n){return this.XLEdit.getPropertyValueByElem(n,"hyperlink",this.getActiveSheetIndex())},getComment:function(n){return this.XLEdit.getPropertyValueByElem(n,"comment",this.getActiveSheetIndex())},saveAsJSON:function(){var ut,u,ft,k;if(!this.model.isReadOnly){var y,p,c,w,d,e=1,i,f,s,g,o,l,a,r,nt,tt=[],et,v,it,b,rt,t,h,ot=["_activeCell","_endCell","_startCell","colCount","rowHeight","columnWidth","columnsWidthCollection","rowsHeightCollection","rowCount","frozenColumns","frozenRows","styleIndex","usedRange","sheetName","dataAttribute","filterSettings","tableManager","sheetInfo","hideColsCollection","hideRowsCollection","mergedCells","showGridlines","showHeadings","isSheetProtected","shapeMngr","pivotMngr","chart","rangeSettings","cellTypes","startCell","primaryKey","showHeader","fieldAsColumnHeader","headerStyles","rows"],st=["type","value","value2","decimalPlaces","format","formats","borders","formatStr","comment","hyperlink","rule","cFormatRule","wrap","merge","picture","chart","pivot","thousandSeparator","isLocked","align","isRHide"];this._isSaveAsJSON=!0;this._isExport=!0;this.model.exportSettings.allowExporting&&this.XLExport._renderAll();this._isExport=!1;y={dataContainer:n.extend(!0,{},this._dataContainer),model:n.extend(!0,{},this.model)};f=y.dataContainer;s=y.model;et=g=f.hashCode.length;v=f.sheetCellType;f.sheetCellType={};for(t in f.hashCode)r=f.hashCode[t],r.indexOf("e-border")>-1&&r.length<25&&tt.push(r);for(t=0;t<tt.length;t++)f.hashCode.splice(f.hashCode.indexOf(tt[t]),1);t="sheets";for(o in f[t])for(l in f[t][o]){for(a in f[t][o][l]){for(r in f[t][o][l][a])["format","formats","borders"].indexOf(r)>-1&&(ut=this._dataContainer.hashCode[this._dataContainer[t][o][l][a][r]],f[t][o][l][a][r]=f.hashCode.indexOf(ut)),st.indexOf(r)<0&&delete f[t][o][l][a][r];this.getObjectLength(f[t][o][l][a])||delete f[t][o][l][a]}this.getObjectLength(f[t][o][l])||delete f[t][o][l]}for(t in s)s[t]===this.defaults[t]||Object.prototype.toString.call(s[t])===Object.prototype.toString()?delete s[t]:Array.isArray(s[t])&&(s[t].length||delete s[t]);for(c=s.sheets;e<c.length;){i=c[e];for(t in i){switch(t){case"frozenColumns":case"frozenRows":i[t]===0&&delete i[t];break;case"fieldAsColumnHeader":case"isSheetProtected":i[t]||delete i[t];break;case"showHeadings":case"showGridlines":case"showHeader":i[t]&&delete i[t];break;case"filterSettings":for(r in i[t])r==="range"?this._isEmptyString(i[t][r])&&delete i[t][r]:delete i[t][r];break;case"sheetInfo":for(r in i[t])if(r!=="text"){if(r==="isVisible"&&!i[t][r])continue;delete i[t][r]}break;case"_startCell":case"_endCell":case"_activeCell":case"usedRange":for(r in i[t])i[t][r]===0&&delete i[t][r];break;case"columnWidth":i[t]===64&&delete i[t];break;case"rowHeight":i[t]===20&&delete i[t];break;case"primaryKey":i[t].length||delete i[t];break;case"startCell":i[t]==="A1"&&delete i[t]}ot.indexOf(t)<0||i[t]===null?delete i[t]:Object.prototype.toString.call(i[t])===Object.prototype.toString()?this.getObjectLength(i[t])||delete i[t]:Array.isArray(i[t])&&(i[t].length||delete i[t])}if(b=c[e].shapeMngr.picture,rt={},this.getObjectLength(b)){h=0;for(t in b)rt["picture"+h]=b[t],h++;c[e].shapeMngr.picture=n.extend(!0,{},rt)}if(p=c[e].shapeMngr.chart,nt={},this.getObjectLength(p)){h=0;for(t in p)u=n.extend(!0,{},p[t]),ft={commonSeriesOptions:{type:u.type,marker:u.marker},enable3D:u.enable3D,top:u.top,left:u.left,size:{width:u.width,height:u.height},title:u.title,legend:u.legend,primaryXAxis:u.xAxis,primaryYAxis:u.yAxis,dataSheetIdx:u.dataSheetIdx,animation:u.animation,isRowColSwitched:u.isRowColSwitched,colIndex:u.colIndex,rowIndex:u.rowIndex,theme:u.theme,range:this._getAlphaRange(e,u.range[0],u.range[1],u.range[2],u.range[3])},u.colIndex&&u.rowIndex?f.sheets[e][u.rowIndex][u.colIndex].chart=[]:f.sheets[e][u.activeCell.rowIndex][u.activeCell.colIndex].chart=[],nt["chart"+h]=ft,h++;c[e].shapeMngr.chart=nt}if(w=c[e].tableManager,d={},this.getObjectLength(w)){h=0;for(t in w){k=n.extend(!0,{},w[t]);delete k.format;for(r in s.nameManager)s.nameManager[r].name===k.name&&s.nameManager.splice(parseInt(r),1);d[h]=k;h++}c[e].tableManager=d}i.cellTypes=[];g=this.getObjectLength(v);g&&(f.sheetCellType[e]={});h=1;for(t in v)(r=v[t],this.getObjectLength(r))&&(it=r.id.split("_")[2],o=parseInt(it.match(/[0-9]+/)[0]),e===o&&(delete r.id,r.range=it.replace(/[0-9]+/,""),f.sheetCellType[e][h]={settings:r},v[t]={},h++));c[e]._scrollTop=this.getSheet(e)._scrollTop;c[e]._scrollLeft=this.getSheet(e)._scrollLeft;e++}return this._isSaveAsJSON=!1,y}},_isvalidRange:function(n){var t=new RegExp(/^\$?(?:\b[a-z]{1,3})\$?(?:\d{1,7}):\$?(?:\b[a-z]{1,3})\$?(?:\d{1,7})$/i);return t.test(n)},_renderFUpload:function(){this.element.append(t.buildTag("div","",{height:"0px"},{id:this._id+"_file"}));n("#"+this._id+"_file").ejUploadbox({width:"0px",height:"0px",uploadName:"file",autoUpload:!0,showFileDetails:!1,dialogAction:{content:this.element},saveUrl:this.model.importSettings.importMapper,fileSelect:n.proxy(this._fileSelect,this),complete:n.proxy(this._changeImport,this),error:n.proxy(this._importFailed,this)});n("#"+this._id+"_file_SelectButton").hide()},_fileSelect:function(t){if(t.files.length){var r,u=t.files[0],i=u.extension;if(this._uploadImage&&i===".xlsx"||!this._uploadImage&&((this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10)?i.indexOf("jpg")>-1||i.indexOf("png")>-1||i.indexOf("jpeg")>-1||i.indexOf("gif")>-1:u.rawFile.type.indexOf("image")>-1))return this._showAlertDlg("Alert","CorrectFormat","",290),this._uploadImage=!1,!1;this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10||this._uploadImage?this.showWaitingPopUp():(r=n("#"+this._id+"_file"),r.ejUploadbox("option","autoUpload",!1),this["import"]({file:u.rawFile,password:this.model.importSettings.password,allowSheetOnDemand:this.model.importSettings.allowSheetOnDemand}),r.find(".e-uploadinput").val(""),t.cancel=!0);this._uploadImage=!1}},_changeImport:function(t){var r,i=n("#"+this._id+"_file").data("ejUploadbox");((this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10)?t.files[0].extension.indexOf("jpg")>-1||t.files[0].extension.indexOf("png")>-1||t.files[0].extension.indexOf("jpeg")>-1||t.files[0].extension.indexOf("gif")>-1:t.files.rawFile.type.indexOf("image")>-1)?(i.updialog.ejDialog("close"),this.XLShape._insertPicture(t),this.model.showRibbon&&this.XLRibbon._formatTabUpdate(),i.option("autoUpload",!0)):(r=this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10?t.responseText:t.xhr.response,i.updialog.ejDialog("close"),this._importSuccess(r));this.hideWaitingPopUp()},_dlgBeforeOpen:function(){var t=n("#"+this._id+"_PasswordDialog").data("ejDialog");this.hideWaitingPopUp();n("#"+this._id+"_workBookName").text("'"+n("#"+this._id+"_file").data("ejUploadbox")._files[0].name+"'"+this._getLocStr("Protect"))},_dlgOk:function(){var t,i=n("#"+this._id+"_PasswordDialog").data("ejDialog"),r=n("#"+this._id+"_xlpassword"),u=n("#"+this._id+"_confirmpassword");t=n("#"+this._id+"_Ribbon_Review_Changes_ProtectWorkbook").data("ejToggleButton");i.model.title==="Protect Workbook"?r.val().length&&u.val().length?r.val()===u.val()?(this.model.exportSettings.password=r.val(),n("#"+this._id+"_AddSheet").addClass("e-disable"),n("#"+this._id+"_confirm").hide(),i.option("title",this._getLocStr("UnProtectWorkbook"))):(n("#"+this._id+"_confirm").show(),this._showAlertDlg("Alert","PasswordAlert1"),t&&t.option("toggleState",!1),i.option("title",this._getLocStr("ProtectWorkbook"))):(n("#"+this._id+"_confirm").show(),t&&t.option("toggleState",!1),i.option("title",this._getLocStr("ProtectWorkbook")),this._showAlertDlg("Alert","PasswordAlert2")):i.model.title==="Unprotect Workbook"&&(this.model.exportSettings.password===r.val()?(n("#"+this._id+"_AddSheet").removeClass("e-disable"),this.model.exportSettings.password=null,n("#"+this._id+"_confirm").show(),i.option("title",this._getLocStr("ProtectWorkbook"))):(i.option("title",this._getLocStr("UnProtectWorkbook")),t&&t.option("toggleState",!0),this._showAlertDlg("Alert","PasswordAlert3")));r.val("");u.val("");n("#"+this._id+"_PasswordDialog").ejDialog("close")},_passwordDlg:function(){var n,f,i,r,u,e;n=t.buildTag("div","","",{id:this._id+"_PasswordDialog"});u=t.buildTag("div.e-dlg-btnfields");e=t.buildTag("div.e-dlg-btnctnr");f="<div class= 'e-dlgctndiv'><table><tr class= 'e-dlgtd-fields'><td><label>"+this._getLocStr("Password")+":<\/label><\/td><td><input id ='"+this._id+"_xlpassword' type ='password' class = 'ejinputtext'/><\/td><\/tr><tr class= 'e-dlgtd-fields' id ='"+this._id+"_confirm'><td><label>"+this._getLocStr("ConfirmPassword")+"<\/label><\/td><td><input id ='"+this._id+"_confirmpassword' type ='password'  class = 'ejinputtext'/><\/td><\/tr><\/table><\/div>";n.append(f);i=t.buildTag("input","","",{type:"submit"});r=t.buildTag("input");i.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgOk,this),enabled:!0,cssClass:"e-ss-okbtn"});r.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._dlgCancel,this),showRoundedCorner:!0,width:60});u.append(e.append(i,r));n.append(u);n.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("ProtectWorkbook"),width:"auto",height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg e-ss-pwddlg",close:t.proxy(this._dlgCancel,this)})},_importPasswordDlg:function(){var i,e,r,u,f,o;return i=t.buildTag("div","","",{id:this._id+"_ImportPasswordDialog"}),f=t.buildTag("div.e-dlg-btnfields"),o=t.buildTag("div.e-dlg-btnctnr"),e="<div class= 'e-dlgctndiv'><table><tr class= 'e-dlgtd-fields'><td><label id ='"+this._id+"_workBookName' ><\/label><\/td><\/tr><tr class= 'e-dlgtd-fields'><td><label>"+this._getLocStr("Password")+":<\/label><\/td><td><input id ='"+this._id+"_importpassword' type ='password'  class = 'ejinputtext'/><\/td><\/tr><\/table><\/div>",i.append(e),r=t.buildTag("input","","",{type:"submit"}),u=t.buildTag("input"),r.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._importDlgOk,this),enabled:!0}),u.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._dlgCancel,this),showRoundedCorner:!0,width:60}),f.append(o.append(r,u)),i.append(f),i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("Password"),beforeOpen:n.proxy(this._dlgBeforeOpen,this),width:420,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg",close:t.proxy(this._dlgCancel,this)}),i},_dlgCancel:function(){this._showDialog(this._id+"_Ribbon_Review_Changes_ProtectWorkbook");var t=n("#"+this._id+"_PasswordDialog").data("ejDialog");t.model.title==="Protect Workbook"?n("#"+this._id+"_Ribbon_Review_Changes_ProtectWorkbook").ejToggleButton("option","toggleState",!1):t.model.title==="Unprotect Workbook"&&n("#"+this._id+"_Ribbon_Review_Changes_ProtectWorkbook").ejToggleButton("option","toggleState",!0);n("#"+this._id+"_confirmpassword").val("");n("#"+this._id+"_xlpassword").val("");n("#"+this._id+"_importpassword").val("");n("#"+this._id+"_PasswordDialog").ejDialog("close");n("#"+this._id+"_ImportPasswordDialog").ejDialog("close")},_importDlgOk:function(){var t={},i=n("#"+this._id+"_importpassword");this.model.importSettings.password=i.val();i.val("");n("#"+this._id+"_ImportPasswordDialog").ejDialog("close");t.file=n("#"+this._id+"_file").data("ejUploadbox")._files[0].rawFile;t.password=this.model.importSettings.password;t.allowSheetOnDemand=this.model.importSettings.allowSheetOnDemand;this["import"](t)},lockCells:function(n,t){if(!this.model.isReadOnly){var i,r,u=this.getActiveSheetIndex(),f=this.getSheet(u);if(r=t!=!1,this.model.allowLockCell&&!f.isSheetProtected){if(n=this._getRangeArgs(n,"object",u),i={reqType:"lockCells",range:n,isLock:r},this._trigActionBegin(i))return;if(n=i.range,r=i.isLock,r?this.updateUniqueData({isLocked:!0},n):this.clearRangeData(n,["isLocked"]),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),i={reqType:"lockCells",range:n,isLocked:r},this._trigActionComplete(i))return}}},protectSheet:function(t){if(!this.model.isReadOnly){var i,r,f,u=this.getActiveSheetIndex(),o=this.getSheet(u),e=this.XLRibbon;if(r=t!==!1,this.XLEdit._isEdit&&this.XLEdit.saveCell(),this.model.allowLockCell){if(i={reqType:"protectSheet",isProtect:t,sheetIdx:u},this._trigActionBegin(i))return;if(r=i.isProtect,o.isSheetProtected=r,this.model.showRibbon&&(f=n("#"+this._id+"_Ribbon_Review_Changes_LockCell").data("ejToggleButton"),f&&f.option("enabled",!r),r?e._disableRibbonIcons():e._enableRibbonIcons(),e._updateRibbonIcons()),o._showLockCellAlert=!0,this.model.allowFormulaBar&&this.updateFormulaBar(),this.model.allowUndoRedo&&(this.model.sheetCount>1?this._removeUndoRedoForCurSheet(u,"undo"):(this._undoCollection=[],this._redoCollection=[])),i={reqType:"protectSheet",isSheetProtected:t,sheetIdx:u},!this._isSheetNavigate&&this._trigActionComplete(i))return}}},_readOnly:function(){var r=this.XLRibbon,u=n("#"+this._id+"_FRDialog_FPDlgTab").data("ejTab"),t=this.element.find("#"+this._id+"_Ribbon_BackStage"),i=this.element.find("#"+this._id+"_inputbox");this.model.isReadOnly?(r._disableRibbonIcons(),r.enableRibbonItems(["Spreadsheet_Ribbon_Home_Clipboard_Copy","Spreadsheet_Ribbon_Review_Comments_ShowAllComments","Spreadsheet_Ribbon_Others_Editing_FindSelect"]),this.XLCMenu&&this.XLCMenu._disableMenuOpt(["Replace","GoTo","GoToSpecial","Formulas","Comments","CFormat","Constants","DataValidation"],"Ribbon_FindRep"),t.length&&(t.find("#saveas_backStageTab").hide(),t.find("#print_backStageTab").hide()),this.addClass(this.element.find("#"+this._id+"_AddSheet")[0],"e-disable"),i.length&&(i[0].disabled=!0)):(r._enableRibbonIcons(),this.XLCMenu&&this.XLCMenu._enableMenuOpt(["Replace","GoTo","GoToSpecial","Formulas","Comments","CFormat","Constants","DataValidation"],"Ribbon_FindRep"),t.length&&(t.find("#saveas_backStageTab").show(),t.find("#print_backStageTab").show()),this._removeClass(this.element.find("#"+this._id+"_AddSheet")[0],"e-disable"),i.length&&(i[0].disabled=!1))},_isPropExists:function(n,t,i,r){for(var u,f,h,e,c,s=0,o=!1;s<n.length;){for(u=this.swapRange(n[s]),f=u[0],h=u[2];f<=h;){for(e=u[1],c=u[3];e<=c;){if(this.XLEdit.getPropertyValue(f,e,t,i)){r||(t==="isLocked"?this._popUplockCellAlert():t==="isReadOnly"&&this._showAlertDlg("Alert","ReadOnly","",400));o=!0;break}e++}if(o)break;f++}if(o)break;s++}return o},_isCellProtected:function(n,t,i){return this.model.allowLockCell&&this.getSheet(this.getActiveSheetIndex()).isSheetProtected&&this.XLEdit.getPropertyValue(n,t,"isLocked")?(i&&this._popUplockCellAlert(),!0):this.XLEdit.getPropertyValue(n,t,"isReadOnly")?(this._showAlertDlg("Alert","ReadOnly","",400),!0):void 0},_popUplockCellAlert:function(){this.getSheet(this.getActiveSheetIndex())._showLockCellAlert&&this._showAlertDlg("Alert","LockAlert","",500)},_removeUndoRedoForCurSheet:function(n,t){var r=t==="undo"?this._undoCollection:this._redoCollection,i=r.length;if(i)while(i--)n===r[i].sheetIndex&&r.splice(i,1);t==="undo"&&this._removeUndoRedoForCurSheet(n,"redo")},_detailsFromGlobalSpan:function(i,r,u,f,e,o){var s,h,f=f||"K",c="e-rowcell e-wrapword ",l=this.getRangeData({range:[i,r,i,r],property:["format","border","wrap"]})[0],v=l.format,y=l.border,p=l.wrap,a;return a=!t.isNullOrUndefined(e),s=a?n("#"+this._id+"_emptyDiv"):n("#"+this._id+"_emptySpan"),e&&(s[0].style.width=e-4+"px"),t.isNullOrUndefined(v)||(c+=v+" "),t.isNullOrUndefined(y)?s[0].className.indexOf("e-rowcell")>-1&&(s[0].style.borderRight=0):c+=y+" ",t.isNullOrUndefined(p)||(c+="e-sswraptext"),this.addClass(s[0],c),s[0].className.indexOf("e-rowcell")>-1&&(s[0].style.padding=0),s.text(f),u==="height"?(h=s.outerHeight(),!o&&this.model.rowHeight>h&&(h=this.model.rowHeight)):(h=s.outerWidth(),!o&&this.model.columnWidth>h&&(h=this.model.columnWidth)),this._refreshGlobalSpan(null,a),h},_writeRule:function(n,t){var i,r,t=this.getSheetElement(t).index()+1;r="#"+this._id+" .e-sheet:nth-child("+t+") .e-content td.e-rowcell:nth-of-type("+(n+1)+")";i=document.getElementById(this._id+"_sshide");i.sheet.insertRule(r+"{display: none}",i.sheet.cssRules.length)},_deleteRule:function(n,t){var t=this.getSheetElement(t).index()+1,r,u,i,s;r=document.getElementById(this._id+"_sshide");var f=r.sheet.cssRules,e=" .e-sheet:nth-child("+t+") ",o=".e-rowcell:nth-of-type("+(n+1)+")";for(this._browserDetails.name==="msie"&&(e=" :nth-child("+t+").e-sheet ",o=":nth-of-type("+(n+1)+").e-rowcell"),u="#"+this._id+e+".e-content td"+o,i=0,s=f.length;i<s;i++)if(f[i].selectorText===u){r.sheet.deleteRule(i);break}},_refreshRowHeight:function(n,t){var i=this.XLEdit.getPropertyValue(t,0,"pHeight"),r=this.getSheet(n);this.isUndefined(i)||(this.XLEdit._updateDataContainer({rowIndex:t,colIndex:0},{dataObj:{cHeight:i,pHeight:r.rowsHeightCollection[t]}}),r.rowsHeightCollection[t]=i,this._isRowViewable(n,t)&&(this.getRows(n)[1][this._getRowIdx(t)].style.height=i+"px"))},_batchAddRow:function(n,t,i,r){var c,u,o,f,s,h=0,e=n,a=this.getSheet(i),l=this.getDataSettings(i);if(l)while(e<=t){while(h<l.length)u=l[h],f=u.range,s=u.batchChanges.deleted,e>f[0]&&e<=f[2]+1?(o=f[0]?this._getPosDiff(e,f[0]):e,!u.fieldAsColumnHeader&&u.showHeader&&(o=o-1),c=this._getRowData(e,f[1],f[3],u),u._jsonData.splice(o,0,c),u._isDataManager&&(r?s.length?s.pop():s.push(c):u.batchChanges.added.push(u._jsonData[o])),f[2]++,u.count++):e<=f[0]&&(f[2]++,f[0]++),h++;h=0;e++}},_batchDeleteRow:function(n,t,i,r){var s,u,h,f,o,l,c=0,e=t,v=this.getSheet(i),a=this.getDataSettings(i);if(a)while(e>=n){while(c<a.length)u=a[c],f=u.range,o=u.batchChanges.added,e>=f[0]&&e<=f[2]?(h=f[0]?this._getPosDiff(e,f[0]):e,!u.fieldAsColumnHeader&&u.showHeader&&(h=h-1),s=u._jsonData.splice(h,1)[0],u._isDataManager&&(r?o.length?(l=o.indexOf(s),l>-1&&o.splice(l,1)):o.push(s):u.batchChanges.deleted.push(s)),f[2]--,u.count--):e<f[0]&&(f[2]--,f[0]--),c++;c=0;e--}},_updateBatchDetails:function(t,i,r){var s,v,f,h,e,o,c,u,y=!0,l=0,p=this.getSheet(r),a=this.getDataSettings(r);if(a)while(l<a.length){if(u=a[l],f=u.range,f&&this.inRange(f,t,i)){c=u.batchChanges.changed;s=f[0]?this._getPosDiff(t,f[0]):t;v=f[1]?this._getPosDiff(i,f[1]):i;!u.fieldAsColumnHeader&&u.showHeader&&(t===f[0]?y=!1:s=s-1);y&&(o=u._jsonData[s],h=u.fields[v],e=this.getRangeData({range:[t,i,t,i],valueOnly:!0,sheetIdx:r,skipFormula:!0})[0],(this.isUndefined(e)||this._isEmptyString(e))&&(e=null),o[h]!==e&&(o[h]=e,!u.primaryKey||h!==u.primaryKey||this.XLEdit.getPropertyValue(t,i,"isReadOnly",r)||this.isUndefined(e)||this.XLEdit._updateDataContainer({rowIndex:t,colIndex:i},{dataObj:{isReadOnly:!0}}),u._isDataManager&&n.inArray(o,c)===-1&&n.inArray(o,u.batchChanges.added)===-1&&c.push(o)));break}l++}},_getRowData:function(n,i,r,u){for(var f,s={},e=i,o=0,c=this.getSheet(this.getActiveSheetIndex()),h=u.fields;e<=r;)f=this.getRangeData({range:[n,e,n,e],valueOnly:!0,skipDateTime:!0})[0],this._isEmptyString(f)&&(f=null),u.primaryKey&&h[o]===u.primaryKey&&t.isNullOrUndefined(f)&&(f=0),s[h[o]]=f,e++,o++;return s},saveBatchChanges:function(n){var e,r,i,o,u=0,s=this,t=this.getSheet(n),f=this.getDataSettings(n);if(f)while(u<f.length)setting=f[u],setting._isDataManager&&(i=setting.batchChanges,e={sheetIdx:n,dataSetting:setting,batchChanges:i},o=this._trigger("beforeBatchSave",e),!o&&(i.changed.length||i.added.length||i.deleted.length)&&(r=setting._dataManager.saveChanges(i,setting.primaryKey,setting.query._fromTable),setting._isOffline||(this.showWaitingPopUp(),r.done(function(){t._resCnt++;t._reqCnt===t._resCnt&&s.hideWaitingPopUp()}),r.fail(function(){t._resCnt++;t._reqCnt===t._resCnt&&s.hideWaitingPopUp()})),t._reqCnt++,setting.batchChanges={added:[],changed:[],deleted:[]})),u++},setReadOnly:function(n){this.updateUniqueData({isReadOnly:!0},n)},removeReadOnly:function(n){this.clearRangeData(n,["isReadOnly"])},_updateCustomFormulas:function(n,t){var r=this._calcEngine,u;for(var i in n)t==="add"&&this.isUndefined(this.getCalcEngine().getLibraryFunctions().getItem(n[i].formulaName))&&!this.XLEdit._isNamedRange("="+n[i].formulaName)?(u=r.addCustomFunction(n[i].formulaName,n[i].functionName),this._formulaCollection.push({text:"="+n[i].formulaName,display:n[i].formulaName})):t==="delete"&&r.getCustomLibraryFunctions().contains(n[i].formulaName)?u=r.removeFunction(n[i].formulaName,n[i].functionName):this._showAlertDlg("Alert","CorrectFormula","FormulaAlert",372);return u},addCustomFormula:function(n,t){if(!this.model.isReadOnly){var i=this._updateCustomFormulas([{formulaName:n,functionName:t}],"add");i&&(this.model.customFormulas.push({formulaName:n,functionName:t}),this.XLEdit._refreshAutoComplete())}},removeCustomFormula:function(n,t){if(!this.model.isReadOnly){var r,u=this._updateCustomFormulas([{formulaName:n.toUpperCase(),functionName:t}],"delete"),i;if(u){i=this.model.customFormulas;for(r in i)i[r].formulaName===n&&i.splice(1,parseInt(r));this._updateFormulaCollection();this.XLEdit._refreshCalcEngine(null,null,!1,null,null);this.XLEdit._refreshAutoComplete()}}},getValueFromFormulaArg:function(n){var f=1,s,c=this._getSheetIndex(),e=this._calcEngine,r,t,o={},u=[],i,h;for(r=n.split(e.getParseArgumentSeparator()),i=0,h=r.length;i<h;i++)u=u.concat(r[i].indexOf(":")>-1?e.getCellsFromArgs(r[i]):[r[i]]);for(s in u)t=e.getValueFromArg(u[s]),o["arg"+f]=this.XLEdit._parseValue(t).value,u.indexOf(t)>-1&&t[0]==='"'&&t[t.length-1]==='"'&&(o["arg"+f]=t.substring(1,t.length-1)),f++;return o},getCalcEngine:function(){return this._calcEngine},_updateFormatColl:function(n,t,i,r){var f=this.getSheet(n),u=f._formatColl;r>this.model.rowHeight?(this.isUndefined(u[t])&&(u[t]={}),u[t][i]=r):(t in u&&i in u[t]&&delete u[t][i],this.getObjectLength(u[t])<1&&delete u[t])},_getFormattedHeight:function(n,i){var u=this.getSheet(n),r;return r=t.max(this._getObjectValues(u._formatColl[i])),r?r:this.model.rowHeight}});t.Spreadsheet.Locale=t.Spreadsheet.Locale||{};t.Spreadsheet.Locale["default"]=t.Spreadsheet.Locale["en-US"]={Cut:"Cut",Copy:"Copy",FormatPainter:"Format Painter",Paste:"Paste",PasteValues:"Paste Values Only",PasteSpecial:"Paste",Filter:"Filter",FilterContent:"Turn on filtering for the selected cells.",FilterSelected:"Filter by Selected Cell's value",Sort:"Sort",Clear:"Clear",ClearContent:"Delete everything in the cell, or remove just the formatting, contents, comments or hyperlinks.",ClearFilter:"Clear Filter",ClearFilterContent:"Clear the filter and sort state for the current range of data.",SortAtoZ:"Sort A to Z",SortAtoZContent:"Lowest to Highest.",SortZtoA:"Sort Z to A",SortZtoAContent:"Highest to Lowest.",SortSmallesttoLargest:"Sort Smallest to Largest",SortLargesttoSmallest:"Sort Largest to Smallest",SortOldesttoNewest:"Sort Oldest to Newest",SortNewesttoOldest:"Sort Newest to Oldest",Insert:"Insert",InsertTitle:"Insert Cells",InsertContent:"Add new cells, rows, or columns to your workbook.",MultipleInsertContent:"FYI: To insert multiple rows or columns at a time, select multiple rows or columns in the sheet, and click Insert.",InsertSBContent:"Add cells, rows, columns, or sheets to your workbook.",Delete:"Delete",DeleteTitle:"Delete Cells",DeleteContent:"Delete cells, rows, columns, or sheets from your workbook. ",MultipleDeleteContent:"FYI: To delete multiple rows or columns at a time, select multiple rows or columns in the sheet, and click Delete.",FindSelectTitle:"Find & Select",FindSelectContent:"Click to see options for finding text in your document.",CalculationOptions:"Calculation Options",CalcOptTitle:"Calculation Options",CalcOptContent:"Choose to calculate formulas automatically or manually.",CalcOptRecalcContent:"If you make a change that affects a value, Spreadsheet will automatically recalculate it.",CalculateSheet:"Calculate Sheet",CalculateNow:"Calculate Now",CalculateNowContent:"Calculate the entire workbook now.",CalculateNowTurnOffContent:"You only need to use this if automatic calculation is turned off.",CalculateSheetContent:"Calculate the active sheet now.",CalculateSheetTurnOffContent:"You only need to use this if automatic calculation is turned off.",Title:"Spreadsheet",ColorPicker:"Color Picker",Ok:"OK",Cancel:"Cancel",Alert:"We couldn't do this for the selected range of cells. Select a single cell within a range of data and then try again.",HeaderAlert:"The command could not be completed as you are attempting to filter with the filter header. Select a single cell in the filter range and try the command again.",FlashFillAlert:"All the data next to your selection was checked and there was no pattern for filling in values.",Formatcells:"Format Cells",FontFamily:"Font",FFContent:"Pick a new font for your text.",FontSize:"Font Size",FSContent:"Change the size of your text.",IncreaseFontSize:"Increase Font Size",IFSContent:"Make your text a bit bigger.",DecreaseFontSize:"Decrease Font Size",DFSContent:"Make your text a bit smaller.",Bold:"Bold",Italic:"Italic",Underline:"Underline",Linethrough:"Linethrough",FillColor:"Fill Color",FontColor:"Font Color",TopAlign:"Top Align",TopAlignContent:"Align text to the top.",MiddleAlign:"Middle Align",MiddleAlignContent:"Align text so that it is centered between the top and bottom of the cell.",BottomAlign:"Bottom Align",BottomAlignContent:"Align text to the bottom.",WrapText:"Wrap Text",WrapTextContent:"Wrap extra-long text into multiple lines so you can see all of it.",AlignLeft:"Align Left",AlignLeftContent:"Align your content to the left.",AlignCenter:"Center",AlignCenterContent:"Center your content.",AlignRight:"Align Right",AlignRightContent:"Align your content to the right.",IncreaseIndent:"Increase Indent",IncreaseIndentContent:"Move your content farther away from the cell border.",DecreaseIndent:"Decrease Indent",DecreaseIndentContent:"Move your content closer to the cell border.",Undo:"Undo",Redo:"Redo",NumberFormat:"Number Format",NumberFormatContent:"Choose the format for your cells, such as percentage, currency, date or time.",AccountingStyle:"Accounting Style",AccountingStyleContent:"Format as dollar accounting number format.",PercentageStyle:"Percent Style",PercentageStyleContent:"Format as a percent.",CommaStyle:"Comma Style",CommaStyleContent:"Format with a thousands separator.",IncreaseDecimal:"Increase Decimal",IncreaseDecimalContent:"Show more decimal places for a more precise value.",DecreaseDecimal:"Decrease Decimal",DecreaseDecimalContent:"Show fewer decimal places.",AutoSum:"AutoSum",AutoSumTitle:"Sum",AutoSumContent:"Automatically add a quick calculation to your worksheet, such as sum or average.",Fill:"Fill",ExportXL:"Excel",ExportCsv:"CSV",ExportPdf:"PDF",SaveXml:"Save XML",BackgroundColor:"Fill Color",BGContent:"Color the background of the cells to make them stand out.",ColorContent:"Change the color of your text.",Border:"Border",BorderContent:"Apply borders to the currently selected cells.",BottomBorder:"Bottom Border",TopBorder:"Top Border",LeftBorder:"Left Border",RightBorder:"Right Border",OutsideBorder:"Outside Borders",NoBorder:"No Border",AllBorder:"All Borders",ThickBoxBorder:"Thick Box Border",ThickBottomBorder:"Thick Bottom Border",TopandThickBottomBorder:"Top and Thick Bottom Border",DrawBorderGrid:"Draw Border Grid",DrawBorder:"Draw Border",TopandBottomBorder:"Top and Bottom Border",BorderColor:"Line Color",BorderStyle:"Line Style",Number:"Number is used for general display of numbers.  Currency and Accounting offer specialized formatting for monetary value.",General:"General format cells have no specific number format.",Currency:"Currency formats are used for general monetary values.  Use Accounting formats to align decimal points in a column.",Accounting:"Accounting formats line up the currency symbols and decimal points in a column.",Text:"Text format cells are treated as text even when a number is in the cell. The cell is displayed exactly as entered.",Percentage:"Percentage formats multiply the cell value by 100 and displays the result with a percent symbol.",CustomMessage:"Type number format code, using one of existing codes as a starting point.",Fraction:"Fraction is used to indicate a part of a whole number or a ratio between two numbers.",Scientific:"Scientific is used to represent a decimal number between 1 and 10 multiplied by ten, so the large numbers using less digits.",Type:"Type:",CustomFormatAlert:"Enter a valid format",Date:"Date formats display date and time serial numbers as date values.",Time:"Time formats display date and time serial numbers as date values.",File:"FILE",New:"New",Open:"Open",SaveAs:"Save As",Print:"Print",PrintContent:"Print the current sheet.",PrintSheet:"Print Sheet",PrintSelected:"Print Selected",PrintSelectedContent:"Select an area on the sheet you would like to print.",HighlightVal:"Format Invalid Data",ClearVal:"Clear Validation",Validation:"Validation",DataValidation:"Data Validation",DVContent:"Pick from a list of rules to limit the type of data that can be entered in a cell.",A4:"A4",A3:"A3",Letter:"Letter",PageSize:"Page Size",PageSizeContent:"Choose a page size for your document.",FormatCells:"FormatCells",ConditionalFormat:"Conditional Formatting",CFContent:"Easily spot trends and patterns in your data using colors to visually highlight important values.",And:"and",With:"with",GTTitle:"Greater Than",GTContent:"Format cells that are GREATER THAN:",LTTitle:"Less Than",LTContent:"Format cells that are LESS THAN:",BWTitle:"Between",BWContent:"Format cells that are BETWEEN:",EQTitle:"Equal To",EQContent:"Format cells that are EQUAL TO:",DateTitle:"A Date Occurring",DateContent:"Format cells that contain a DATE:",ContainsTitle:"Text That Contains",ContainsContent:"Format cells that contain the text:",GreaterThan:"Greater Than",LessThan:"Less Than",Between:"Between",EqualTo:"Equal To",TextthatContains:"Text that Contains",DateOccurring:"A Date Occurring",ClearRules:"Clear Rules",ClearRulesfromSelected:"Clear Rules from Selected Cells",ClearRulesfromEntireSheets:"Clear Rules from Entire Sheet",CellStyles:"Cell Styles",CellStylesContent:"A colorful style is a great way to make important data stand out on the sheet.",CellStyleHeaderText:"Good, Bad and Neutral/Titles and Headings/Themed Cell Styles",Custom:"Type the number format code, using one of the existing codes as starting point.",CellStyleGBN:"Normal/Bad/Good/Neutral",CellStyleTH:"Heading 4/Title",CellsStyleTCS:"20% - Accent1/20% - Accent2/20% - Accent3/20% - Accent4/60% - Accent1/60% - Accent2/60% - Accent3/60% - Accent4/Accent1/Accent2/Accent3/Accent4",Style:"Style",FormatAsTable:"Format As Table",FormatasTable:"Format as Table",FATContent:"Quickly convert a range of cells to a table with its own style.",FATHeaderText:"Light/Medium/Dark",FATNameDlgText:"Table Name:/My table has headers",InvalidReference:"The range you have specified is invalid",ResizeAlert:"The specified range is invalid. The top of the table must remain in the same row, and the resulting table must overlap the original table. Specify a valid range.",RangeNotCreated:"Increasing the row beyond the maximum sheet rowcount is restricted in Format as Table.",ResizeRestrictAlert:"Increase or decrease of column count and decrease of row count is restricted in Format as Table.",FATResizeTableText:"Enter new data range for your table:",FATReizeTableNote:"Note: The headers must remain in the same row and the resulting table range must overlap the original table range.",FormatAsTableAlert:"Cannot create a table with a single row. A table must have at least two rows, one for the table header, and one for data",FormatAsTableTitle:"Light 1/Light 2/Light 3/Light 5/Light 8/Light 9/Light 10/Light 12/Light 15/Light 16/Light 17/Light 19/Medium 8/Medium 9/Medium 10/Medium 12/Medium 22/Medium 23/Medium 24/Medium 26/Dark 1/Dark 2/Dark 3/Dark 5",NewTableStyle:"New Table Style",ResizeTable:"Resize Table",ResizeTableContent:"Resize this table by adding or removing rows and columns.",ConvertToRange:"Convert to Range",ConvertToRangeContent:"Convert this table into a normal range of cells.",ConverToRangeAlert:"Do you want to convert the table to a normal range?",TableID:"Table ID:",Table:"Table",TableContent:"Create a table to organize and analyze related data.",TableStyleOptions:"First Column/Last Column/Total Row/Filter Button",Format:"Format",NameManager:"Name Manager",NameManagerContent:"Create, edit, delete and find all the names used in the workbook.",NameManagerFormulaContent:"Names can be used in formulas as substitutes for cell references.",DefinedNames:"Defined Names",DefineName:"Define Name",DefineNameContent:"Define and apply names.",UseInFormula:"Use In Formula",UseInFormulaContent:"Choose a name used in this workbook and insert it into the current formula.",RefersTo:"Refers To",Name:"Name",Scope:"Scope",NMNameAlert:"The name that you entered is not valid./Reason for this can include:/The name does not begin with a letter or an underscore/The name contains a space or other invalid characters/The name conflicts with a spreadsheet built-in name or the name of another object in the workbook",NMUniqueNameAlert:"The name entered already exists. Enter a unique name.",NMRangeAlert:"Enter a valid range",FORMULAS:"FORMULAS",Value:"Values",DataValue:"Values:",Formula:"Formulas",MissingParenthesisAlert:"Your formula is missing a parenthesis--) or (. Check the formula, and then add the parenthesis in the appropriate place.",UnsupportedFile:"Unsupported File",IncorrectPassword:"Unable to open the file or worksheet with the given password",InvalidUrl:"Please specify proper URL",Up:"Up",Down:"Down",Sheet:"Sheet",Workbook:"Workbook",Rows:"By Rows",Columns:"By Columns",FindReplace:"Find Replace",FindnReplace:"Find and Replace",Find:"Find",Replace:"Replace",FindLabel:"Find what:",ReplaceLabel:"Replace with:",ReplaceAll:"Replace All",Close:"Close",FindNext:"Find Next",FindPrev:"Find Prev",Automatic:"Automatic",Manual:"Manual",Settings:"Settings",MatchCase:"Match case",MatchAll:"Match entire cell contents",Within:"Within:",Search:"Search:",Lookin:"Look in:",ShiftRight:"Shift cells right",ShiftBottom:"Shift cells down",EntireRow:"Entire row",EntireColumn:"Entire column",ShiftUp:"Shift cells up",ShiftLeft:"Shift cells left",Direction:"Direction:",GoTo:"Go To",GoToName:"Go to:",Reference:"Reference:",Special:"Special",Select:"Select",Comments:"Comments",Formulas:"Formulas",Constants:"Constants",RowDiff:"Row differences",ColDiff:"Column differences",LastCell:"Last cell",CFormat:"Conditional formats",Blanks:"Blanks",GotoError:"Error",GotoLogicals:"Logicals",GotoNumbers:"Numbers",GotoText:"Text",FindSelect:"Find & Select",Comment:"Comment",NewComment:"New",InsertComment:"Insert Comment",EditComment:"Edit",DeleteComment:"Delete Comment",DeleteCommentContent:"Delete the selected comment.",HideComment:"Hide Comment",Next:"Next",NextContent:"Jump to the next comment.",Previous:"Previous",PreviousContent:"Jump to the previous comment.",ShowHide:"Show/Hide Comment",ShowHideContent:"Show or hide the comment on the active cell.",ShowAll:"Show All Comments",ShowAllContent:"Display all comments in the sheet.",UserName:"User Name",Hide:"Hide",Unhide:"Unhide",Add:"Add",DropAlert:"Do you want to replace the existing data?",PutCellColor:"Put Selected Cell Color To The Top",PutFontColor:"Put Selected Font Color To The Top",WebPage:"Web Page",WorkSheet:"Worksheet Reference",SheetReference:"Sheet Reference",InsertHyperLink:"Insert Hyperlink",HyperLink:"Hyperlink",EditLink:"Editlink",OpenLink:"Openlink",HyperlinkText:"Text:",RemoveLink:"Removelink",WebAddress:"Web Address:",CellAddress:"Cell Reference:",SheetIndex:"Select a place in this document",ClearAll:"Clear All",ClearFormats:"Clear Formats",ClearContents:"Clear Contents",ClearComments:"Clear Comments",ClearHyperLinks:"Clear Hyperlinks",SortFilter:"Sort & Filter",SortFilterContent:"Organize your data so it's easier to analyze.",NumberStart:"Minimum:",NumberEnd:"Maximum:",DecimalStart:"Minimum:",DecimalEnd:"Maximum:",DateStart:"Start Date:",DateEnd:"End Date:",ListStart:"Source:",FreeText:"Show error after invalid data is entered",ListEnd:"Cell Reference:",TimeStart:"Start Time:",TimeEnd:"End Time:",TextLengthStart:"Minimum:",TextLengthEnd:"Maximum:",CommentFindEndAlert:"Spreadsheet reached the end of the workbook. Do you want to continue reviewing from the beginning of the workbook?",InsertSheet:"Insert",DeleteSheet:"Delete",RenameSheet:"Rename",MoveorCopy:"Move or Copy",HideSheet:"Hide",UnhideSheet:"Unhide",SheetRenameAlert:"That name is already taken. Try a different one.",SheetRenameEmptyAlert:"You typed an invalid name for a sheet. Make sure that:",SheetRenameEmptyCharExceedAlert:"The name that you type does not exceed 31 characters.",SheetRenameEmptySplCharAlert:"The name does not contain any of the following characters: ",SheetRenameEmptyBlankAlert:"You did not leave the name blank.",SheetDeleteAlert:"You can't undo deleting sheets, and you might be removing some data. If you don't need it, click OK to delete.",SheetDeleteErrorAlert:"A workbook must contain at least one visible worksheet. To hide, delete, or move the selected sheet, you must first insert a new sheet or unhide a sheet that is already hidden.",CtrlKeyErrorAlert:"That command cannot be used on  multiple selections.",ClipboardAccessError:"Your browser can't access the clipboard, so use these shortcuts:",ClipboardAccessCutError:"Cut = Ctrl + X",ClipboardAccessCopyError:"Copy = Ctrl + C",ClipboardAccessPasteError:"Paste = Ctrl + V",MoveToEnd:"Move To End",Beforesheet:"Before sheet:",CreateaCopy:"Create a copy",AutoFillOptions:"Copy Cells/Fill Series/Fill Formatting Only/Fill Without Formatting/Flash Fill",NumberValidationMsg:"Enter only digits",DateValidationMsg:"Enter only date",Required:"Required",TimeValidationMsg:"The time you entered for the Time is invalid.",CellAddrsValidationMsg:"Reference is not valid.",PivotTable:"Pivot Table",PivotTableContent:"Easily arrange and summarize complex data in a PivotTable.",NumberTab:"Number",AlignmentTab:"Alignment",FontTab:"Font",FillTab:"Fill",TextAlignment:"Text alignment",Horizontal:"Horizontal:",Vertical:"Vertical:",Indent:"Indent",TextControl:"Text Control",FontGroup:"Font:",FontStyle:"Font style:",Size:"Size:",PSize:"Page size",Effects:"Effects:",StrikeThrough:"Strikethrough",Overline:"Overline",NormalFont:"Normal font",Preview:"Preview",PreviewText:"AaBbCcYyZz",Line:"Line",Presets:"Presets",None:"None",Outline:"Outline",AllSide:"All sides",InsCells:"Insert Cells",InsRows:"Insert Sheet Rows",InsCols:"Insert Sheet Columns",InsSheet:"Insert Sheet",DelCells:"Delete Cells",DelRows:"Delete Sheet Rows",DelCols:"Delete Sheet Columns",DelSheet:"Delete Sheet",HyperLinkAlert:"The address of this site is not valid.Check the address and try again.",ReplaceData:"All done. We made / replacements.",NotFound:"We couldn't find what you were looking for. Select settings tab for more ways to search",Data:"Data:",Allow:"Allow:",IgnoreBlank:"Ignore blank",NotFind:"Unable to find the match to replace",FreezeTopRow:"Freeze Top Row",FreezeFirstColumn:"Freeze First Column",UnFreezePanes:"Unfreeze Panes",DestroyAlert:"Are you sure you want to destroy the current workbook without saving and create a new workbook?",ImageValAlert:"Upload image files only",Pictures:"Pictures",PicturesTitle:"From File",PicturesContent:"Insert pictures from computer or from other computers that you are connected to.",ImportAlert:"Are you sure you want to destroy the current workbook without saving and open a new workbook?",UnmergeCells:"Unmerge Cells",MergeCells:"Merge Cells",MergeAcross:"Merge Across",MergeAndCenter:"Merge & Center",MergeAndCenterContent:"Combine and center the contents of the selected cells in a new larger cell.",MergeCellsAlert:"Merging Cells keeps only upper left cell value and discards the other values.",MergeInsertAlert:"This operation will causes some merged cells to unmerge. Do you wish to continue ?",Axes:"Axes",PHAxis:"Primary Horizontal",PVAxis:"Primary Vertical",AxisTitle:"Axis Title",CTNone:"None",CTCenter:"Center",CTFar:"Far",CTNear:"Near",DataLabels:"Data Labels",DLNone:"None",DLCenter:"Center",DLIEnd:"Inside End",DLIBase:"Inside Base",DLOEnd:"Outside End",ErrorBar:"Error Bars",Gridline:"Gridlines",PMajorH:"Primary Major Horizontal",PMajorV:"Primary Major Vertical",PMinorH:"Primary Minor Horizontal",PMinorV:"Primary Minor Vertical",Legend:"Legends",LNone:"None",LLeft:"Left",LRight:"Right",LBottom:"Bottom",LTop:"Top",ChartTitleDlgText:"Enter Title",ChartTitle:"Title",InvalidTitle:"You typed an invalid name for the Title.",CorrectFormat:"Select the correct Format File",ResetPicture:"Reset Picture",ResetPictureContent:"Discard all of the formatting changes made to this picture.",PictureBorder:"Picture Border",PictureBorderContent:"Pick the color, width, and line style for the outline of your shape.",ResetSize:"Reset Picture & Size",Height:"Height",Width:"Width",ThemeColor:"Theme Colors",NoOutline:"No Outline",Weight:"Weight",Dashes:"Dashes",ColumnChart:"2-D Column/3-D Column",ColumnChartTitle:"Insert Column Chart",ColumnChartContent:"Use this chart type to visually compare values across a few categories.",BarChart:"2-D Bar/3-D Bar",BarChartTitle:"Insert Bar Chart",BarChartContent:"Use this chart type to visually compare values across a few categories when the chart shows duration or the category text is long.",StockChart:"Radar",StockChartTitle:"Insert Radar Chart",StockChartContent:"Use this chart type to show values relative to a center point.",LineChart:"2-D Line",LineChartTitle:"Insert Line Chart",LineChartContent:"Use this chart type to show trends over time (years, months, and days) or categories.",AreaChart:"2-D Area/3-D Area",AreaChartTitle:"Insert Area Chart",AreaChartContent:"Use this chart type to show trends over time (years, months, and days) or categories. Use it to highlight the magnitude of change over time.",ComboChart:"Combo",PieChart:"Pie",PieChartTitle:"Insert Pie/Doughnut Chart",PieChartContent:"Use this chart type to show proportions of a whole. Use it when the total of your numbers is 100%.",ScatterChart:"Scatter",ScatterChartTitle:"Insert Scatter (X, Y) Chart",ScatterChartContent:"Use this chart type to show the relationship between sets of values.",ClusteredColumn:"Clustered&nbsp;Column",StackedColumn:"Stacked&nbsp;Column",Stacked100Column:"100%&nbsp;Stacked&nbsp;Column",Cluster3DColumn:"3-D&nbsp;Clustered&nbsp;Column",Stacked3DColumn:"3-D&nbsp;Stacked&nbsp;Column",Stacked100Column3D:"3-D&nbsp;100%&nbsp;Stacked&nbsp;Column",ClusteredBar:"Clustered&nbsp;Bar",StackedBar:"Stacked&nbsp;Bar",Stacked100Bar:"100%&nbsp;Stacked&nbsp;Bar",Cluster3DBar:"3-D&nbsp;Clustered&nbsp;Bar",Stacked3DBar:"3-D&nbsp;Stacked&nbsp;Bar",Stacked100Bar3D:"3-D&nbsp;100%&nbsp;Stacked&nbsp;Bar",Radar:"Radar",RadarMarkers:"Radar&nbsp;with&nbsp;Markers",LineMarkers:"Line&nbsp;with&nbsp;Markers",Area:"Area",StackedArea:"Stacked&nbsp;Area",Stacked100Area:"100%&nbsp;Stacked&nbsp;Area",Pie:"Pie",Pie3D:"3-D&nbsp;Pie",Doughnut:"Doughnut",Scatter:"Scatter",ChartRange:"Chart Range",XAxisRange:"Enter X-axis range:",YAxisRange:"Enter Y-axis range:",LegendRange:"Enter legend range:",YAxisMissing:"Enter Y-axis range to create chart",InvalidYAxis:"Y-axis range must be within the selected range",InvalidXAxis:"X-axis range must be within the selected range",InvalidLegend:"Legend range must be within the selected range",InvalidXAxisColumns:"X-axis range should be within a single column",FreezePanes:"Freeze Panes",FreezePanesContent:"Freeze a portion of the sheet to keep it visible while you scroll through the rest of the sheet.",PasteTitle:"Paste (Ctrl+V)",PasteContent:"Add content on the Clipboard to your document.",PasteSplitContent:"Pick a paste option, such as keeping formatting or pasting only content.",CutTitle:"Cut (Ctrl+X)",CutContent:"Remove the selection and put it on the Clipboard so you can paste it somewhere else.",CopyTitle:"Copy (Ctrl+C)",CopyContent:"Put a copy of the selection on the Clipboard so you can paste it somewhere else.",FPTitle:"Format Painter",FPContent:"Like the look of a particular selection? You can apply that look to other content in the document.",BoldTitle:"Bold (Ctrl+B)",BoldContent:"Make your text bold.",ItalicTitle:"Italic (Ctrl+I)",ItalicContent:"Italicize your text.",ULineTitle:"Underline (Ctrl+U)",ULineContent:"Underline your text.",LineTrTitle:"Strike Through (Ctrl+5)",LineTrContent:"Cross something out by drawing a strike through it.",UndoTitle:"Undo (Ctrl+Z)",UndoContent:"Undo your last action.",RedoTitle:"Redo (Ctrl+Y)",RedoContent:"Redo your last action.",TableTitle:"Table (Ctrl+T)",HyperLinkTitle:"Add a Hyperlink (Ctrl+K)",HyperLinkContent:"Create a link in your document for quick access to webpages and files. ",HyperLinkPlaceContent:"Hyperlinks can also take you to places in your document.",NewCommentTitle:"Insert a Comment",NewCommentContent:"Add a note about this part of the document.",RefreshTitle:"Refresh",RefreshContent:"Get the latest data from the source connected to the active cell",FieldListTitle:"Field List",FieldListContent:"Show or hide the Field List.",FieldListRemoveContent:"The field list allows you to add and remove fields from your PivotTable report",AddChartElement:"Add Chart Element",AddChartElementContent:"Add elements to the created chart.",SwitchRowColumn:"Switch Row/ Column",SwitchRowColumnContent:"Swap the data over the axis.",MergeAlert:"We can't do that to a merged cell.",UnhideDlgText:"Unhide Sheet:",ChartThemes:"Chart Themes",ChartThemesContent:"Pick a new theme for your chart.",ChangePicture:"Change Picture",ChangePictureContent:"Change to a different picture, preserving the formatting and size of the current picture.",ChangeChartType:"Change Chart Type",SelectData:"Select Data",SelectDataContent:"Change the data range included in the chart.",Sum:"Sum",Average:"Average",CountNumber:"Count Numbers",Max:"Max",Min:"Min",ChartTypeContent:"Change to a different chart type.",AllCharts:"All Charts",defaultfont:"Default",LGeneral:"General",LCurrency:"Currency",LAccounting:"Accounting",LDate:"Date",LTime:"Time",LPercentage:"Percentage",LFraction:"Fraction",LScientific:"Scientific",LText:"Text",LCustom:"Custom",FormatSample:"Sample",Category:"Category:",Top:"Top",Center:"Center",Bottom:"Bottom",Left:"Left (Indent)",Right:"Right",Justify:"Justify",GeneralTxt:"General format cells have no specific number format.",NegativeNumbersTxt:"Negative Numbers",ThousandSeparatorTxt:"Use 1000 Separator",DecimalPlacesTxt:"Decimal Places:",TextTxt:"Text format cells are treated as text even when a number is in the cell. The cell is displayed exactly as entered.",BoldItalic:"Bold Italic",Regular:"Regular",HyperLinkHide:"<<Selection in Document>>",InvalidSheetIndex:"Specify proper SheetIndex",HugeDataAlert:"File too large to open.",ImportExportUrl:"Give import/export URL and try again.",TitleColumnChart:"Clustered Column/Stacked Column/100% Stacked Column/3D Clustered Column/3D Stacked Column/ 3D 100% Stacked Column",TitleBarChart:"Clustered Bar/Stacked Bar/100% Stacked Bar/3D Clustered Bar/3D Stacked Bar/3D 100% Stacked Bar",TitleRadarChart:"Radar/Radar with Markers",TitleLineChart:"Line/Line with Markers",TitleAreaChart:"Area/Stacked Area/100% Stacked Area",TitlePieChart:"Pie/3D Pie/Doughnut",TitleScatterChart:"Scatter",BetweenAlert:"The Maximum must be greater or equal to the Minimum.",BorderStyles:"Solid/Dashed/Dotted",FPaneAlert:"Freeze Pane is not applied for the First Cell",ReplaceNotFound:"Spreadsheet cannot find a match.",BlankWorkbook:"Blank workbook",SaveAsExcel:"Save As Excel",SaveAsCsv:"Save As CSV",SaveAsPdf:"Save As PDF",Design:"DESIGN",NewName:"New Name",FormulaBar:"Formula Bar",NameBox:"Name Box",NumberValMsg:"Decimal values cannot be used for number conditions.",NumberAlertMsg:"Enter only digits.",ListAlert:"Cell range is incorrect, Please enter correct cell range.",ListValAlert:"The list source must be a delimited list, or a reference to single row or column.",ListAlertMsg:"The value you entered is not valid",AutoFillTitle:"AutoFillOptions",NewSheet:"New Sheet",FullSheetCopyPasteAlert:"We can't paste because the Copy area and paste area aren't the same size.",Heading:"Headings",Gridlines:"Gridlines",Firstsheet:"Scroll to the first sheet",Lastsheet:"Scroll to the last sheet",Nextsheet:"Scroll to the next sheet",Prevsheet:"Scroll to the previous sheet",ProtectWorkbook:"Protect Workbook",UnProtectWorkbook:"Unprotect Workbook",ProtectWBContent:"Keep others from making structural changes to your workbook",Password:"Password",ConfirmPassword:"Reenter password to proceed:",PasswordAlert1:"Confirmation password is not identical.",PasswordAlert2:"Please enter a password.",PasswordAlert3:"The password you supplied is not correct. Verify that the CAPS LOCK key is off and be sure to use the correct capitalization.",Protect:"is protected.",Lock:"LockCell",Unlock:"UnlockCell",Protectsheet:"Protect Sheet",ProtectSheetToolTip:"Prevent unwanted changes from others by limiting their ability to edit",Unprotect:"Unprotect Sheet",LockAlert:"The cell you are trying to change is on protected sheet. To make changes, click Unprotect Sheet in the Review tab.",InsertDeleteAlert:"This operation is not allowed. The operation is attempting to shift cells in a table/Filter range on your worksheet.",CreateRule:"New Rule",NewRule:"New Formatting Rule",NewRuleLabelContent:"Format values where this formula is true:",ReadOnly:"The range you are trying to change contains readonly cells.",CreatePivotTable:"Create PivotTable",Range:"Range:",ChoosePivotTable:"Choose where you want the PivotTable to be placed",NewWorksheet:"New Worksheet",ExistingWorksheet:"Existing Worksheet",Location:"Location:",Refresh:"Refresh",PivotRowsAlert:"This command requires at least two rows of source data. You cannot use the command on a selection in only one row.",PivotLabelsAlert:"The PivotTable field name is not valid, To create a PivotTable report, you must use data that is organized as a list with labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.",FieldList:"Field List",MergeSortAlert:"To do this, all the merged cells need to be the same size.",FormulaSortAlert:"The sort range with formula cannot be sorted.",MergePreventInsertDelete:"This operation is not allowed. The operation is attempting to shift a merge cells on your worksheet.",FormulaRuleMsg:"Please enter correct format.",MovePivotTable:"Move PivotTable",MovePivotTableContent:"Move the PivotTable to another location in the workbook.",ClearAllContent:"Remove fields and filters.",ChangeDataSource:"Modify",ChangeDataSourceContent:"Change the source data for this PivotTable",ChangePivotTableDataSource:"Change PivotTable Data Source",TotalRowAlert:"This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet. Click OK to proceed with entire row.",CellTypeAlert:"This operation is not allowed in cell type applied range.",PivotOverlapAlert:"A PivotTable report cannot overlap another PivotTable report",NoCellFound:"No cells were found",MoreValidationAlert:"The selection contains more than one type of validation. Erase current settings and continue ?",CorrectArgument:"Please enter the correct argument",CorrectFormula:"Please enter the correct formula",CorrectCellAddress:"Please enter the correct cell address",ChartType:"Chart Type",NumberValidationAlert:"The Maximum must be greater than or equal to Minimum",DateValidationAlert:"The End Date must be greater than or equal to Start Date",TimeValidationAlert:"The End Time must be greater than or equal to Start Time",NewRuleAlert:"There's a problem with this formula",DragAlert:"The command could not be completed as you are attempting to move cells within the filter range. Select a range out of the filter range and try the command again.",OR:"or",HOME:"HOME",INSERT:"INSERT",DATATAB:"DATA",PAGELAYOUT:"PAGE LAYOUT",REVIEW:"REVIEW",OTHERS:"OTHERS",FORMAT:"Format",DESIGN:"DESIGN",CHARTDESIGN:"Chart Design",ANALYZE:"Analyze",FileName:"File Name",Save:"Save",SaveFile:"Save the file ",HighlightCellRules:"Highlight Cell Rules",LightRedFillDark:"Light Red Fill with Dark Red Text",YellowFillDark:"Yellow Fill with Dark Yellow Text",GreenFillDark:"Green Fill with Dark Green Text",RedFill:"Red Fill",RedText:"Red Text",Column:"Column",Bar:"Bar",DataValidationType:"Number/Decimal/Date/Time/TextLength/List",DataValidationAction:"greater than/greater than or equal to/less than/less than or equal to/equal to/not equal to/between/not between",FilterAlert:"This will remove a filtered range on your worksheet. To complete this task, please remove auto filters."};t.Spreadsheet.scrollMode={Normal:"normal",Infinite:"infinite"};t.Spreadsheet.AutoFillOptions={CopyCells:"copycells",FillSeries:"fillseries",FillFormattingOnly:"fillformattingonly",FillWithoutFormatting:"fillwithoutformatting",FlashFill:"flashfill"};t.Spreadsheet.autoFillDirection={Up:"up",Right:"right",Down:"down",Left:"left"};t.Spreadsheet.pageSize={A4:"A4",A3:"A3",Letter:"Letter"};t.Spreadsheet.Actions={Sorting:"sorting",Selection:"selection",AutoFill:"autofill",CellNavigation:"cellnavigation",Filtering:"filtering"};t.Spreadsheet.exportType={Excel:"Excel",Csv:"Csv",Pdf:"Pdf"};t.Spreadsheet.CustomCellType={Button:"Button",CheckBox:"CheckBox",DropDownList:"DropDownList",DatePicker:"DatePicker"};t.Spreadsheet.CellType={String:"string",Number:"number",Custom:"custom",Formula:"formula",Time:"time",LongDate:"longdate",ShortDate:"shortdate",Scientific:"scientific",Fraction:"fraction",Text:"text",General:"general",Accounting:"accounting",Currency:"currency",Percentage:"percentage",Date:"date",DateTime:"datetime"};t.Spreadsheet.SupportedStyles={FontFamily:"font-family",FontSize:"font-size",FontStyle:"font-style",FontWeight:"font-weight",TextAlign:"text-align",TextDecoration:"text-decoration",VerticalAlign:"vertical-align",TextIndent:"text-indent"};t.Spreadsheet.Validation={">":"GreaterThan",">=":"GreaterOrEqualTo","<":"LessThan","<=":"LessThanOrEqualTo","==":"EqualTo","!=":"NotEqualTo","!":"Not","=":""};t.Spreadsheet.ValidationText={">":"greater than",">=":"greater than or equal to","<":"less than","<=":"less than or equal to","==":"equal to","!=":"not equal to","!":" not","=":""};t.Spreadsheet.msg=" ";t.Spreadsheet.getMsg=function(){return t.Spreadsheet.msg};t.Spreadsheet.SelectionType={Row:"row",Column:"column",Default:"default"};t.Spreadsheet.SelectionUnit={Single:"single",Range:"range",MultiRange:"multirange"};t.Spreadsheet.Align={Left:"left",Right:"right",Center:"center"};t.Spreadsheet.CFormatRule={GreaterThan:"greaterthan",LessThan:"lessthan",Between:"between",EqualTo:"equalto",TextContains:"textcontains",DateOccur:"dateoccur"};t.Spreadsheet.ContextMenu={Cell:"cell",RowHeader:"rowheader",ColumnHeader:"columnheader",Footer:"footer"};t.Spreadsheet.CFormatHighlightColor={RedFillwithDarkRedText:"redft",YellowFillwithDarkYellowText:"yellowft",GreenFillwithDarkGreenText:"greenft",RedFill:"redf",RedText:"redt"};t.Spreadsheet.BorderType={Top:"top",Left:"left",Right:"right",Bottom:"bottom",OutSide:"outside",AllBorder:"allborder",ThickBox:"thickbox",ThickBottom:"thickbottom",TopandBottom:"topandbottom",TopandThickBottom:"topandthickbottom"};t.Spreadsheet.ChartProperties={PrimaryHorizontal:"PHAxis",PrimaryVertical:"PVAxis",PrimaryHorizontalAxisTitle:"PHAxisTitle",PrimaryVerticalAxisTitle:"PVAxisTitle",TitleNone:"CTNone",TitleCenter:"CTCenter",TitleFar:"CTFar",TitleNear:"CTNear",DataLabelNone:"DLNone",DataLabelCenter:"DLCenter",DataLabelInsideBase:"DLIBase",DataLabelInsideEnd:"DLIEnd",DataLabelOutsideEnd:"DLOEnd",PrimaryMajorHorizontal:"PMajorH",PrimaryMajorVertical:"PMajorV",PrimaryMinorHorizontal:"PMinorH",PrimaryMinorVertical:"PMinorV",LegendsNone:"LNone",LegendsLeft:"LLeft",LegendsRight:"LRight",LegendsBottom:"LBottom",LegendsTop:"LTop"};t.Spreadsheet.HideTypes={Default:"default",Freeze:"freeze"}})(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.selection=function(n){this.XLObj=n;this._isRightClick=!1;this._colhdrClick=!1;this._rowhdrClick=!1;this._aFillDownHandler=!1;this._isOutsideBordering=!1;this._isGridBordering=!1;this._isRowSelected=!1;this._isColSelected=!1;this._isEndReached=!0;this._canTouchMove=!1};t.spreadsheetFeatures.selection.prototype={_selectionMouseDownHandler:function(i){var e,o,r=this.XLObj,f=r.getSheet(),u=i.target;r._isTouchEvt?(r._browserDetails.name==="msie"&&i.preventDefault(),(r._isSelected(i.target)||r._hasClass(i.target,"e-autofill"))&&(e=r._getBrowserEvt("move"),this._canTouchMove=!0),o=r._getBrowserEvt("end")):(i.preventDefault(),e=r._getBrowserEvt("move",!0),o=r._getBrowserEvt("end",!0)+" mouseleave");r._on(n(document),o,this._mouseUpHandler);i.which===3||i.button===2||r.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.Single?this._isRightClick=!0:e&&r._on(r.element,e,this._mouseMoveHandler);u.tagName=="TD"?(r.XLEdit._isFormulaEdit?(i.ctrlKey&&(this._clearBorder(r._arrayAsString(r._ctrlFormulaBorder)),r._ctrlKeyCount=r._formulaRange.length),r._dStartCell=r._getCellIdx(u)):i.shiftKey&&f._startCell.rowIndex!=-1?f._endCell=r._getCellIdx(u):(f._startCell=r._getCellIdx(u),f._activeCell=r._getCellIdx(u)),u.className.indexOf("e-rowheader")>-1&&(this._rowhdrClick=!0)):u.parentNode.tagName=="TH"?(i.shiftKey&&f._startCell.rowIndex!=-1?f._endCell={rowIndex:0,colIndex:u.parentNode.cellIndex}:(f._startCell={rowIndex:0,colIndex:u.parentNode.cellIndex},f._activeCell={rowIndex:0,colIndex:u.parentNode.cellIndex}),u.className.indexOf("e-headercelldiv")>-1&&(this._colhdrClick=!0)):u.className=="e-autofill"&&(this._aFillDownHandler=!0)},_mouseMoveHandler:function(i){var o,l,a,u=this,e=u.XLSelection,s=u.getActiveSheetIndex(),r=u.getSheet(s),f=i.target,v,h=u.model.selectionSettings.selectionType,c=t.Spreadsheet.SelectionType,y=n(i.target).get(0);if(!u._isTouchEvt||(u._isTouchMoveSel=!0,l=u._getOriginalEvt(i),f=document.elementFromPoint(l.clientX,l.clientY),f))if(n(f).hasClass("e-rowcell")||n(f).hasClass("e-rowheader")){if(this.XLSelection._isEndReached=!1,u._getContent(s).find("td").removeClass(u._ctrlFormulaBorder[u._ctrlKeyCount%6].join(" ")),u.XLEdit._isFormulaEdit){i.ctrlKey?(u._dEndCell=u._getCellIdx(f),e._processFormulaRange(u._ctrlFormulaBorder,!0)):(u._dEndCell=u._getCellIdx(f),e._processFormulaRange(u._ctrlFormulaBorder,!0));return}if(e._aFillDownHandler&&n(f).parents(".e-rowheadercontent").length===0){if(u.model.allowAutoFill){a=u._getCellIdx(i.target);r._isFreezed&&a.rowIndex<=r.frozenRows&&r._hiddenFreezeRows.indexOf(r.frozenRows)>-1?e._scrollCalculation(s,f,{position:"vertical",action:"Decrement"}):r._isFreezed&&a.colIndex<=r.frozenColumns&&r._hiddenFreezeCols.indexOf(r.frozenColumns)>-1?e._scrollCalculation(s,f,{position:"horizontal",action:"Decrement"}):u.XLDragFill._selectAutoFillRange(f);return}}else if(r._startCell=r._activeCell,r._endCell=u._getCellIdx(f),r._isFreezed&&u.XLFreeze._selectionScroll(),e._processBoundary(),n(f).parents(".e-spreadsheetcontentcontainer").length>0){if(i.ctrlKey&&u.model.selectionSettings.selectionType===t.Spreadsheet.SelectionType.Default&&u.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.MultiRange){u._getContent(u.getActiveSheetIndex()).find("td").removeClass("e-activecell e-focusright e-focusbottom");v=u.swapRange([r._startCell.rowIndex,r._startCell.colIndex,r._endCell.rowIndex,r._endCell.colIndex]);u.getRange(v).addClass("e-ctrlselected");e._focusRange(r._startCell,r._endCell,u._selectionBorder);u.model.allowAutoFill&&u.XLDragFill.hideAutoFillElement();return}h===c.Row||e._rowhdrClick?e.selectRows(r._startCell.rowIndex,r._endCell.rowIndex):h===c.Column||e._colhdrClick?e.selectColumns(r._startCell.colIndex,r._endCell.colIndex):e.selectRange(r._startCell,r._endCell,f);r._isFreezed&&u.XLFreeze._refreshSelection()}else if(n(f).parents(".e-rowheadercontent").length>0)e._colhdrClick||e._rowhdrClick?(h===c.Column?e.selectColumns(0,r.colCount-1):e.selectRows(r._startCell.rowIndex,r._endCell.rowIndex),r._isFreezed&&u.XLFreeze._refreshSelection()):(o={position:"horizontal",action:"Decrement"},e._scrollCalculation(s,f,o));else return}else if(t.isNullOrUndefined(f.parentNode)||f.parentNode.tagName!="TH")if(y.id.indexOf("chart")<1&&(f.className.indexOf("e-hhandlespace")>-1||f.className.indexOf("e-hhandle")>-1||f.className.indexOf("e-hup")>-1||f.className.indexOf("e-hdown")>-1))o={position:"vertical",action:"Increment"},e._scrollCalculation(s,f,o);else if(y.id.indexOf("chart")<1&&(f.className.indexOf("e-vhandlespace")>-1||f.className.indexOf("e-vhandle")>-1||f.className.indexOf("e-vup")>-1||f.className.indexOf("e-vdown")>-1))o={position:"horizontal",action:"Increment"},e._scrollCalculation(s,f,o);else return;else r._endCell={rowIndex:0,colIndex:f.parentNode.cellIndex},r._startCell=r._activeCell,r._isFreezed&&u.XLFreeze._selectionScroll(),e._processBoundary(),e._colhdrClick||e._rowhdrClick?(h===c.Row?e.selectRows(0,r.rowCount-1):e.selectColumns(r._startCell.colIndex,r._endCell.colIndex),r._isFreezed&&u.XLFreeze._refreshSelection()):(o={position:"vertical",action:"Decrement"},e._scrollCalculation(s,f,o))},_mouseUpHandler:function(i){i.target=this._changeTargetWithOffset(i);var e,h,v,l,k,d,a,o,g,nt,y,tt,it,p=!0,r=this,u=r.XLSelection,s=r.getActiveSheetIndex(),f=r.getSheet(s),rt=f.selectedRange,ut=r.getSheetElement(s),w=r.model.selectionSettings.selectionType,ft=f._startCell,et=f._endCell,b=t.Spreadsheet.SelectionType,c=r._getJSSheetContent(s).find(".e-spreadsheetcontentcontainer > .e-content");if(r.XLEdit._isEdit||r.setSheetFocus(),r._isTouchEvt?(tt=r._getBrowserEvt("end"),u._canTouchMove&&(y=r._getBrowserEvt("move")),r._isTouchMoveSel=!1):(y=r._getBrowserEvt("move",!0),tt=r._getBrowserEvt("end",!0)+" mouseleave"),y&&r._off(r.element,y,u._mouseMoveHandler),r._off(n(document),tt,u._mouseUpHandler),r._isTouchEvt){if(!u._aFillDownHandler&&r._isTouchScroll||!u._canTouchMove&&!r._isUniqueTarget(r._touchArgs,i)){u._canTouchMove=r._isTouchScroll=!1;return}if(u._canTouchMove=r._isTouchScroll=!1,it=r._getOriginalEvt(i),e=document.elementFromPoint(it.clientX,it.clientY),!e){this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();return}}if(e=e||i.target,h=n(e),e.tagName=="TD"||e.tagName=="INPUT"&&!h.parents(".e-formulabar").length||u._aFillDownHandler){if(h.parents(".e-rowheadercontent").length&&(u._isOutsideBordering=u._isGridBordering=!1,c.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor").addClass("e-ss-cursor")),r._preventctrlkey=i.ctrlKey,r.XLEdit._isFormulaEdit){c.find("td").removeClass(r._ctrlFormulaBorder.join(" ").replace(/,/g," "));i.ctrlKey?(r._dEndCell=r._getCellIdx(e),u._processFormulaRange(r._formulaBorder)):(u._clearBorder(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")),r._ctrlKeyCount=0,r._dEndCell=r._getCellIdx(e),u._processFormulaRange(r._formulaBorder),r._formulaRange=[]);r._formulaRange.push(r._getProperAlphaRange(s,r._dStartCell.rowIndex,r._dStartCell.colIndex,r._dEndCell.rowIndex,r._dEndCell.colIndex));return}if(u._aFillDownHandler){if(a=e.tagName==="TD"?r._getCellIdx(e):r._dautoFillCell,r.model.allowAutoFill&&(o=r.XLDragFill._getAutoFillRange(a)),!o||!o.fillRange){u._aFillDownHandler=!1;r.XLDragFill.positionAutoFillElement();return}if(k=r.swapRange(o.fillRange),r.model.allowLockCell&&r.getSheet(s).isSheetProtected&&r._isPropExists([k],"isLocked",s)&&(p=!1),p&&r._isPropExists([k],"isReadOnly",s)&&(p=!1),p)"direction"in o?(r._pStartCell=f._startCell,r._pEndCell=f._endCell,r._pFillCell=a,r.inRange(f.selectedRange,a.rowIndex,a.colIndex)?r.clearRangeData(null,null,n(u.getSelectedCells()).not(".e-autofillcell")):r.model.allowAutoFill&&r.XLDragFill.autoFill({dataRange:f.selectedRange,fillRange:o.fillRange,direction:o.direction,fillType:r.model.autoFillSettings.fillType}),f._startCell=o.startCell,f._endCell=o.endCell):u._aFillDownHandler=!1;else{u._aFillDownHandler=!1;r.XLSelection.selectRange(ft,et);r.XLDragFill.positionAutoFillElement();return}u.refreshSelection(r.swapRange([o.startCell.rowIndex,o.startCell.colIndex,o.endCell.rowIndex,o.endCell.colIndex]))}else if(u._isOutsideBordering||u._isGridBordering)if(l="1px "+r._borderStyle+" "+r._borderColor,u._isRightClick?f._endCell=f._startCell:(f._startCell=f._activeCell,f._endCell=r._getCellIdx(e),u._processBoundary()),h.parents(".e-spreadsheetcontentcontainer").length)g={top:l,right:l,bottom:l,left:l},u._isGridBordering&&(g.isGridBorder=!0),r.XLFormat.applyBorder(g,r.swapRange([f._startCell.rowIndex,f._startCell.colIndex,f._endCell.rowIndex,f._endCell.colIndex])),u._cleanUp(!0);else return;else if(e.tagName=="INPUT"&&h.parents("tr").length?f._endCell=u._isRightClick?f._startCell:r._getCellIdx(h.parents("td")[0]):u._isRightClick?f._endCell=f._startCell:(f._startCell=f._activeCell,f._endCell=r._getCellIdx(e),u._processBoundary()),h.parents(".e-spreadsheetcontentcontainer").length){if(i.ctrlKey&&r.model.selectionSettings.selectionType===t.Spreadsheet.SelectionType.Default&&r.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.MultiRange){c.find("td").removeClass("e-activecell e-focustop e-focusleft e-ctrlselected");rt=r.swapRange([f._startCell.rowIndex,f._startCell.colIndex,f._endCell.rowIndex,f._endCell.colIndex]);r.getRange(rt).addClass("e-selected");r.getCell(f._activeCell.rowIndex,f._activeCell.colIndex).addClass("e-activecell");u._focusRange(f._startCell,f._endCell,r._selectionBorder);r.model.allowAutoFill&&r.XLDragFill.hideAutoFillElement();r.getSheet(s)._selectedCells.push(r._getSelectedRange(r.getSheet(s)._startCell,r.getSheet(s)._endCell));r.model.showRibbon&&r.model.allowComments&&ut.find(".e-selected.e-commentcell").length&&r.XLRibbon._enableButtons(["Review_Comments_DeleteComment"],"ejButton");return}w===b.Row||u._rowhdrClick?u.selectRows(f._startCell.rowIndex,f._endCell.rowIndex):w===b.Column||u._colhdrClick?u.selectColumns(f._startCell.colIndex,f._endCell.colIndex):u.selectRange(f._startCell,f._endCell,e);f._isFreezed&&r.XLFreeze._refreshSelection()}else if(h.parents(".e-rowheadercontent").length)(u._colhdrClick||u._rowhdrClick)&&(w===b.Column?u.selectColumns(0,f.colCount-1):u.selectRows(f._startCell.rowIndex,f._endCell.rowIndex),u._hdrClick=!1),u._isOutsideBordering=u._isGridBordering=!1,c.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor").addClass("e-ss-cursor");else return;e.tagName==="TD"&&r.model.showRibbon&&(nt=n("#"+r._id+"_Ribbon_clearfilter").data("ejButton"),nt&&r.XLRibbon._changeClrFltrStatus(nt,"button",r._getCellIdx(e)))}else u._aFillDownHandler||t.isNullOrUndefined(e.parentNode)||e.parentNode.tagName!="TH"?typeof e.className!="object"&&e.className&&e.className.indexOf("e-spreadsheetcolumnheader")>-1&&(u.selectSheet(!0),u._isOutsideBordering=u._isGridBordering=!1,c.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor").addClass("e-ss-cursor")):(f._startCell=f._activeCell,f._endCell=u._isRightClick?f._startCell:{rowIndex:0,colIndex:e.parentNode.cellIndex},u._processBoundary(),(u._colhdrClick||u._rowhdrClick)&&(w===b.Row?u.selectRows(0,f.rowCount-1):u.selectColumns(f._startCell.colIndex,f._endCell.colIndex)),u._isOutsideBordering=u._isGridBordering=!1,c.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor").addClass("e-ss-cursor"));r.model.allowCellFormatting&&r.XLFormat._formatEnable&&r.XLFormat._fPMouseUp(i);r.model.showRibbon&&(r.XLEdit._isEdit?r.XLRibbon._disableRibbonIcons():r.XLRibbon._updateRibbonIcons());!r.model.allowAutoFill||u._isOutsideBordering||u._isGridBordering||r.XLDragFill.positionAutoFillElement(u._aFillDownHandler);u._isRightClick=u._aFillDownHandler=!1;u._colhdrClick=u._rowhdrClick=!1;r.model.showRibbon&&(v=n("#"+r._id+"_Ribbon_merge").data("ejSplitButton"),t.isNullOrUndefined(v)||!r.model.allowLockCell||f.isSheetProtected||(r.XLRibbon._isDirtySelect?v.option("enabled",!1):v.option("enabled",!0)));r.model.allowEditing&&this.XLEdit._isEdit&&(d=r.getSheet(s)._startCell,r.getCell(d.rowIndex,d.colIndex).find(".e-ss-input").focus())},_processBoundary:function(){var u,o,f,t,e,r,s=[],i=this.XLObj,c=i.getActiveSheetIndex(),h=i.getSheet(c),l=h._startCell,a=h._endCell,n=i.swapRange([l.rowIndex,l.colIndex,a.rowIndex,a.colIndex]);for(h._startCell={rowIndex:n[0],colIndex:n[1]},h._endCell={rowIndex:n[2],colIndex:n[3]},t=i._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[0],colIndex:n[3]}),t=t.concat(i._getSelectedRange({rowIndex:n[0],colIndex:n[3]},{rowIndex:n[2],colIndex:n[3]})),t=t.concat(i._getSelectedRange({rowIndex:n[2],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]})),t=t.concat(i._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[1]})),u=t.length;u--;)if(f=t[u],e=i.XLEdit.getPropertyValue(t[u].rowIndex,t[u].colIndex,"mergeIdx",c),r=(f.rowIndex+":"+f.colIndex).toString(),o=i.hasSpan(f)&&s.indexOf(r)===-1&&(s.push(r),this._updateRange(f,n)),e&&(r=(e.rowIndex+":"+e.colIndex).toString(),s.indexOf(r)===-1&&(s.push(r),o=this._updateRange(e,n))),o)break;o&&this._processBoundary()},_updateRange:function(n,t){var r=this.XLObj,c=r.getActiveSheetIndex(),u=r.getSheet(c),i=t.slice(0),f=r._getMergedIdx(n.rowIndex,n.colIndex),e=n.rowIndex,o=n.colIndex,s=f.rowIndex,h=f.colIndex;return e<t[0]&&(t[0]=e),o<t[1]&&(t[1]=o),s>t[2]&&(t[2]=s),h>t[3]&&(t[3]=h),t[0]!=i[0]||t[1]!=i[1]||t[2]!=i[2]||t[3]!=i[3]?(u._startCell={rowIndex:t[0],colIndex:t[1]},u._endCell={rowIndex:t[2],colIndex:t[3]},!0):void 0},selectRange:function(n,t,i,r){var s,c,l,e,v,a,y,p,f,h,o=n,u=this.XLObj;if(u.model.allowSelection&&(u._isObject(n)||(n=u._getRangeArgs(n,"object"),o={rowIndex:n[0],colIndex:n[1]},t={rowIndex:n[2],colIndex:n[3]}),h=u.getActiveSheetIndex(),f=u.getSheet(h),y=u.model.scrollSettings.allowVirtualScrolling,y&&(f._goToCollection={multiple:!1,selected:[]}),p=f.selectedRange,e=u.swapRange([o.rowIndex,o.colIndex,t.rowIndex,t.colIndex]),v=!u.isImport&&(!f._isImported||f._isLoaded),!v||!u.model.beforeCellSelect||(s={prevRange:p,currRange:e,sheetIdx:h},i&&(s.target=i),u._intrnlReq||!u._trigger("beforeCellSelect",s)))){if(u._dStartCell=o,u._dEndCell=t,f.selectedRange=e.slice(0),u._isScrolling||this._cleanUp(!1),u.model.scrollSettings.allowScrolling&&y&&f._isColSelected&&(f._virtualRowIdx.indexOf(e[0])===-1&&(e[0]=f._virtualRowIdx[0]),f._virtualRowIdx.indexOf(e[2])===-1&&(e[2]=f._virtualRowIdx[f._virtualRowIdx.length-1])),a=u.isUndefined(r),a&&(c=u.getRange(e),l=c.length,l))while(l--)u.addClass(c[l],"e-selected");u.inRange(f.selectedRange,f._activeCell.rowIndex,f._activeCell.colIndex)||(f._activeCell={rowIndex:f.selectedRange[0],colIndex:f.selectedRange[1]});f._activeCell=u._getMergeParent(f._activeCell.rowIndex,f._activeCell.colIndex);u._isRowViewable(h,f._activeCell.rowIndex)&&u.addClass(u.getCell(f._activeCell.rowIndex,f._activeCell.colIndex)[0],"e-activecell");a&&(this._focusRange(o,t,u._selectionBorder),this._highlightHeader(e));f._selectedCells=u._getSelectedRange(o,t);u.model.allowFormulaBar&&u.updateFormulaBar();o.rowIndex===0&&t.rowIndex===f.rowCount-1&&(this._isColSelected=!0);o.colIndex===0&&t.colIndex===f.colCount-1&&(this._isRowSelected=!0);a&&(u.model.enableContextMenu||u.model.showRibbon)&&u.XLRibbon._dirtySelect(c);u._isMultiSelect=!0;u.model.showRibbon&&!u._isScrolling&&u.XLRibbon._updateRibbonIcons();u._isSheetNavigate||(f._isEmptyActiveCell=f._isRangeSelected=f._isRowSelected=f._isColSelected=f._isSheetSelected=!1);v&&u.model.cellSelected&&(s={selectedRange:f.selectedRange,target:i,sheetIdx:h},u._intrnlReq||u._trigger("cellSelected",s))}},selectRow:function(n){var i=this.XLObj,t=i.getSheet(i.getActiveSheetIndex());i.model.allowSelection&&(t._startCell={rowIndex:n,colIndex:0},t._endCell={rowIndex:n,colIndex:t.colCount-1},this.selectRange(t._startCell,t._endCell),this._selectRow(i._getRowIdx(n),"e-rowselected"),t._isRowSelected=!0)},selectRows:function(n,t){var i,r=this.XLObj;r.model.allowSelection&&(i=r.getSheet(r.getActiveSheetIndex()),i._startCell={rowIndex:n,colIndex:0},i._endCell={rowIndex:t,colIndex:i.colCount-1},this.selectRange(i._startCell,i._endCell),this._markHeaderSelection([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],"row"),i._isRowSelected=!0)},selectColumn:function(n){var t,i=this.XLObj;i.model.allowSelection&&(t=i.getSheet(i.getActiveSheetIndex()),t._startCell={rowIndex:0,colIndex:n},t._endCell={rowIndex:t.rowCount-1,colIndex:n},this.selectRange(t._startCell,t._endCell),this._selectColumn(n,"e-colselected"),t._isColSelected=!0)},selectColumns:function(n,t){var i,r=this.XLObj;r.model.allowSelection&&(i=r.getSheet(r.getActiveSheetIndex()),i._startCell={rowIndex:0,colIndex:n},i._endCell={rowIndex:i.rowCount-1,colIndex:t},this.selectRange(i._startCell,i._endCell),this._markHeaderSelection([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],"column"),i._isColSelected=!0)},selectSheet:function(n){var i=this.XLObj,t=i.getSheet(i.getActiveSheetIndex());i.model.allowSelection&&(n&&(t._activeCell={rowIndex:t._topRow.idx,colIndex:0}),t._startCell={rowIndex:0,colIndex:0},t._endCell={rowIndex:t.rowCount-1,colIndex:t.colCount-1},this.selectRange(t._startCell,t._endCell),i.element.find(".e-spreadsheetcolumnheader").addClass("e-sheetselected"),t._isSheetSelected=!0)},refreshSelection:function(n){var t=this.XLObj,i=t.getSheet(t.getActiveSheetIndex()),n=t._getRangeArgs(n,"object"),r=n[0],u=n[1],f=n[2],e=n[3];i._isRowSelected?this.selectRows(r,f):i._isColSelected?this.selectColumns(u,e):i._isSheetSelected?this.selectSheet():this.selectRange({rowIndex:r,colIndex:u},{rowIndex:f,colIndex:e})},getSelectedCells:function(n){return this.XLObj._getContent(this.XLObj._getSheetIndex(n))[0].querySelectorAll("td.e-selected")},_select:function(n,t){var i=this.XLObj.getCell(n.rowIndex,n.colIndex);i&&i.addClass(t)},_selectRow:function(n,t){var i=this.XLObj._getJSSheetRowHeaderContent(this.XLObj.getActiveSheetIndex()).find("td:eq("+n+")");i&&i.addClass(t)},_selectRows:function(n,t,i){var r,e,u,f=this.XLObj,h=f.getActiveSheetIndex(),s=f.getSheet(h),o=f._getJSSheetRowHeaderContent(h).find("td");if(e=f._getRowIdx(n),u=f._getRowIdx(t),e===-1)if(n<s._virtualRowIdx[0])e=0;else return;if(u===-1)if(r=s._virtualRowIdx.length-1,t>s._virtualRowIdx[r])u=r;else return;if(o=e!==u?o.slice(e,u+1):o.eq(u),r=o.length,r)while(r--)f.addClass(o[r],i)},_selectColumn:function(n,t){var i=this.XLObj._getJSSheetHeader(this.XLObj.getActiveSheetIndex()).find("th:eq("+n+")");i&&i.addClass(t)},_selectColumns:function(n,t,i){var u,f=this.XLObj,r=f._getJSSheetHeader(f.getActiveSheetIndex()).find("th");if(r=t!==n?r.slice(n,t+1):r.eq(t),u=r.length,u)while(u--)f.addClass(r[u],i)},_focusBorder:function(n,t,i){var r=this.XLObj,e=r.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]),u=e[0],f=e[1],o=e[2],s=e[3];u&&r.getRange([u-1,f,u-1,s]).addClass(i[1]);r.getRange([u,s,o,s]).addClass(i[0]);r.getRange([o,f,o,s]).addClass(i[1]);f&&r.getRange([u,f-1,o,f-1]).addClass(i[0])},_focusRange:function(n,t,i){for(var f,u=4,r=this.XLObj,e=[r.getFocusTopElem(),r.getFocusRightElem(),r.getFocusBottomElem(),r.getFocusLeftElem()],o=["e-focustop ","e-focusright ","e-focusbottom ","e-focusleft "];u--;)f=e[u][0],r._removeClass(f),r.addClass(f,o[u]+i[u]);this._refreshBorder(r.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]))},_refreshBorder:function(n){n=n?n:this.XLObj.getSheet().selectedRange;for(var u,f,c,s,l,r="e-hide",w=4,b=n[0],k=n[1],i=this.XLObj,t=this._focusInfo(n),e=i.getFocusTopElem(),a=i.getFocusRightElem(),v=i.getFocusBottomElem(),o=i.getFocusLeftElem(),ut=[e,a,v,o],d=s=t.topLeft.top,g=t.topRight.left+t.topRight.width-t.topLeft.left,y=t.topRight.top,nt=t.topRight.left+t.topRight.width,tt=t.bottomRight.top+t.bottomRight.height-y,p=t.bottomLeft.top+t.bottomLeft.height,it=t.bottomRight.left+t.bottomRight.width-t.bottomLeft.left,rt=p-s,h=c=l=t.topLeft.left;w--;)i._removeClass(ut[w][0],r);i.model.selectionSettings.enableAnimation?(u=i.model.selectionSettings.animationType,f=i.model.selectionSettings.animationTime,b?e.animate({top:s.toString(),left:l.toString(),width:g.toString()},f,u):e.addClass(r),a.animate({top:y.toString(),left:nt.toString(),height:tt.toString()},f,u),v.animate({top:p.toString(),left:h.toString(),width:it.toString()},f,u),k?o.removeClass(r).animate({top:d.toString(),left:c.toString(),height:rt.toString()},f,u):o.addClass(r)):(b?e.css({top:s,left:l,width:g}):e.addClass(r),a.css({top:y,left:nt,height:tt}),v.css({top:p,left:h,width:it}),k?o.css({top:d,left:c,height:rt}):o.addClass(r))},_focusInfo:function(n){var i={},u=n[0],f=n[1],e=n[2],r=n[3],t=this.XLObj;return i.topLeft=t._getCellInfo({rowIndex:u,colIndex:f}),i.topRight=t._getCellInfo(f===r?{rowIndex:u,colIndex:r}:t._getMergedIdx(u,r)),i.bottomLeft=t._getCellInfo({rowIndex:e,colIndex:f}),i.bottomRight=t._getCellInfo(t._getMergedIdx(e,r)),i},_highlightHeader:function(n){this._selectRows(n[0],n[2],"e-rowhighlight");this._selectColumns(n[1],n[3],"e-colhighlight")},_hideShowSelElem:function(n){var t=this.XLObj,i=n==="block"?"_removeClass":"addClass";t.model.allowSelection&&(t[i](t.getAutoFillElem()[0],"e-hide"),t[i](t.getFocusBottomElem()[0],"e-hide"),t[i](t.getFocusTopElem()[0],"e-hide"),t[i](t.getFocusLeftElem()[0],"e-hide"),t[i](t.getFocusRightElem()[0],"e-hide"))},_markHeaderSelection:function(n,t){var i,r,u=this.XLObj;if(n=u.swapRange(n),i=n[0],t==="row")for(r=n[2];i<=r;)u._isRowViewable(u.getActiveSheetIndex(),i)&&this._selectRow(u._getRowIdx(i),"e-rowselected"),i++;else for(i=n[1],r=n[3];i<=r;)this._selectColumn(i,"e-colselected"),i++},_processFormulaRange:function(n){var u,t=this.XLObj,f=t.getActiveSheetIndex(),i=t._dStartCell,r=t._dEndCell,e=t._getContent(f).find(".e-editedcell");this._focusBorder(i,r,n[t._ctrlKeyCount%6]);t.model.allowAutoFill&&(u=t._getAlphaRange(f,i.rowIndex,i.colIndex,r.rowIndex,r.colIndex),t.XLDragFill.hideAutoFillElement(),t.XLEdit._updateFormulaCellRange(u));t.XLEdit._isCellEdit?t.XLEdit._focusElements(e):t._getInputBox().focus()},_scrollCalculation:function(n,i,r){var s,c,e,o,f=this.XLObj,u,h;f.model.scrollSettings.allowVirtualScrolling||(u=f.getSheet(f.getActiveSheetIndex()),f.XLSelection._isEndReached=!0,s=setInterval(function(){if(e=f.XLScroll._hScroller(n),o=f.XLScroll._vScroller(n),!f.XLSelection._isEndReached){clearInterval(s);return}if(r.position==="horizontal")r.action=="Increment"?(c=Math.ceil(parseFloat(e.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(e.element.find(".e-hhandle").width()))>=e.element.find(".e-hhandlespace").width()-2,c?f.model.scrollSettings.scrollMode!=t.Spreadsheet.scrollMode.Normal?f.XLScroll._scrollX(n):clearInterval(s):e.scroll(e.value()+u.columnWidth,!0),f.XLShape._shapeROStart||f.XLShape._shapeRSStart||(u._endCell.colIndex=u.colCount-1)):(h=e.value()-u.columnWidth,h<0&&(h=0),e.value()>=0&&e.scroll(h,!0),f.XLSelection._aFillDownHandler&&(u._endCell.colIndex=u._leftCol.idx),u._frozenColumns>1&&(u._startCell=u._activeCell,u._endCell.rowIndex=u.selectedRange[2]===u._startCell.rowIndex?u.selectedRange[0]:u.selectedRange[2],u._endCell.colIndex=u._fleftColIdx));else if(r.position==="vertical")if(r.action=="Increment")c=Math.ceil(parseFloat(o.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(o.element.find(".e-vhandle").height()))>=o.element.find(".e-vhandlespace").height()-2,c?f.model.scrollSettings.scrollMode!=t.Spreadsheet.scrollMode.Normal?f.XLScroll._scrollY(n):clearInterval(s):o.scroll(o.value()+f.model.rowHeight,!0),f.XLShape._shapeROStart||f.XLShape._shapeRSStart||(u._endCell.rowIndex=u.rowCount-1);else if(h=o.value()-f.model.rowHeight,h<0&&(h=0),o.value()>0&&o.scroll(h,!0),!f.XLShape._shapeROStart&&!f.XLShape._shapeRSStart){if(u._topRow.idx<1&&u._ftopRowIdx+1===u._frozenRows)return;u._startCell=u._activeCell;u._endCell.rowIndex=u._frozenRows>1?u._ftopRowIdx:u._topRow.idx-1;u._endCell.colIndex=u._frozenRows>1?u.selectedRange[3]===u._startCell.colIndex?u.selectedRange[1]:u.selectedRange[3]:i.parentNode.cellIndex}f.XLShape._shapeROStart||f.XLShape._shapeRSStart||(f.XLSelection._aFillDownHandler?f.XLDragFill._selectAutoFillRange(null,u._endCell):f.XLSelection.selectRange(u._startCell,u._endCell))},200),f._browserDetails.name==="msie"&&f._browserDetails.version==="8.0"?(i.attachEvent("onmouseup",function(){clearInterval(s)}),document.attachEvent("onmouseup",function(){clearInterval(s)})):(i.addEventListener("mouseup",function(){clearInterval(s)}),document.addEventListener("mouseup",function(){clearInterval(s)})))},_cleanUp:function(n){var i,r,o=!1,u="e-hide",t=this.XLObj,f=t.getActiveSheetIndex(),s=t.getSheet(f),h=t.getFocusTopElem(),e=t.getSheetElement(f);for(t.model.allowAutoFill&&t.XLDragFill._autoFillCleanUp(),s._isSheetSelected&&!t.model.scrollSettings.allowVirtualScrolling&&(o=!0,e.detach()),r=e[0].querySelectorAll(".e-selected,.e-rowselected,.e-colselected,.e-rowhighlight,.e-colhighlight,.e-sheetselected,.e-activecell"),i=r.length;i--;)r[i].className=r[i].className.replace(new RegExp("e-activecell|e-selected|e-rowhighlight|e-colhighlight|e-rowselected|e-colselected|e-sheetselected","g"),"").replace(/ +/g," ");o&&t.getMainPanel(f).find(".e-spreadsheet-list").append(e);n&&h&&(t.addClass(h[0],u),t.addClass(t.getFocusRightElem()[0],u),t.addClass(t.getFocusBottomElem()[0],u),t.addClass(t.getFocusLeftElem()[0],u));s._selectedCells=[]},clearAll:function(n){this._cleanUp(!n)},_clearBorder:function(n){var t=this.XLObj;t._getContent(t.getActiveSheetIndex()).find("td").removeClass(n)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.filter=function(n){this.XLObj=n;this._isSearchEdit=!1;this._isDecimal=!1;this._colName="";this._colType="";this._tableId=""};t.spreadsheetFeatures.filter.prototype={_renderExcelFilter:function(){var n=this.XLObj,i={instance:n,showSortOptions:n.model.allowSorting,maxFilterLimit:n.model.sheets[n.getActiveSheetIndex()].filterSettings.maxFilterChoices,filterHandler:t.proxy(this._filterHandler,this),cancelHandler:t.proxy(this._cancelHandler,this),customFilterHandler:t.proxy(this._customFilterHandler,this),enableComplexBlankFilter:!1,blankValue:"",interDeterminateState:!0};n._excelFilter=new t.excelFilter(i);n.element.append(t.buildTag("div#"+n._id+"_filter_custom.e-filterdlg.e-"+n._id+"-dlg","",{display:"none"}))},_customFilterHandler:function(){var t=this.XLObj;this._isDecimal&&(n("#"+t._id+"number_CustomValue1").ejNumericTextbox("option",{decimalPlaces:2}),n("#"+t._id+"number_CustomValue2").ejNumericTextbox("option",{decimalPlaces:2}))},_renderFilterDialogs:function(t){var i=this.XLObj;document.getElementById(i._id+"_filter_custom").className.indexOf("e-dialog")<0&&this._renderCustomFilter();i._excelFilter.renderDialog(t);this._refreshCustomFilter(t);i.element.find(".e-excelfilter.e-dlgcontainer").hide();n(document.body).append(n("#"+i._id+t+"_excelDlg"))},_createSelection:function(n,t,i,r,u){for(var e=this.XLObj,c=e.getSheet(n).usedRange.rowIndex,o=i,s,h,f=i;f<=c;f++){if(s=e.XLEdit.getPropertyValue(f,0,"isHide"),h=e.XLEdit.getPropertyValue(f,r,"value2",n),e.XLEdit.getPropertyValue(f,r,"tableName",n))break;if(!s&&!e.XLEdit.getPropertyValue(f,r,"isMHide")&&!h&&f>=i)return{endRowIndex:f,filteredIndex:u};!s&&h?(o=f+1,u.push(f)):o=o}return{endRowIndex:o,filteredIndex:u}},_getSelectedRangeData:function(n,i,r,u){var c,o=this.XLObj,s=0,w=o.getActiveSheetIndex(),l=o.getSheet(w),k=[],y,f,h,a,d=[],p,g,nt=[],v=o._dataContainer,e=v.sheets[w],b=o.getSheet(w)._multifilterIdx;for(r===-1&&(l.filterSettings.range=o._generateHeaderText(b[0]+1)+n.rowIndex+":"+o._generateHeaderText(b[b.length-1]+1)+(i.rowIndex+1)),l._multipleFiltering&&(i.colIndex=l._multifilterIdx[l._multifilterIdx.length-1]),f=n.rowIndex;f<=i.rowIndex;f++){for(c={},h=n.colIndex;h<=i.colIndex;h++)y=o._generateHeaderText(h+1),f in e&&(!(s in e[f])||s in e[f]&&t.isNullOrUndefined(e[f][s].isRHide)&&t.isNullOrUndefined(e[f][s].isFHide))&&(!(s in e[f])||s in e[f]&&(t.isNullOrUndefined(e[f][s].isFilterHide)||!t.isNullOrUndefined(e[f][s].isFilterHide)&&e[f][s].filterID===r))&&(c.idx=f,f in e&&h in e[f]?(a=e[f][h],h===u&&(p=o.XLEdit.getPropertyValue(f,h,"formats"),t.isNullOrUndefined(p)||(g={id:h,background:p["background-color"],foreground:p.color},d.push(g))),c[y]=t.isNullOrUndefined(v.sharedData[a.value])?"":o._isDateTime(v.sharedData[a.value])||o.isFormula(v.sharedData[a.value])?a.value2:v.sharedData[a.value]):c[y]=""),!(f in e)&&f<i.rowIndex&&(c.idx=f,c[y]="");o.getObjectLength(c)>0&&(nt.push(c),k.push(f))}l._selectedCellColors=d;l._selectedRange={startRow:n.rowIndex,endRow:i.rowIndex,dataSourceIndexes:k};l.filterSettings.filteredRange=nt},_getColumnType:function(t,i,r,u){for(var o="string",e,s,f=i;f<r;f++)if(e=this.XLObj.XLEdit.getPropertyValue(f,u,"value",t),s=this.XLObj.XLEdit.getPropertyValue(f,u,"type",t),s!="text"&&n.isNumeric(e))this._isDecimal||(this._isDecimal=e%1!=0),o="number";else return"string";return o},_getColumnByField:function(n,t){for(var u=this.XLObj,r=u.getSheet(n),i=0;i<r.columns.length;i++)if(r.columns[i].field===t)break;return i===r.columns.length?null:r.columns[i]},_checkEmptyText:function(n){for(var r=this.XLObj,u=r.model.sheets[n]._selectedCells,i=0,f=u.length;i<f;i++)if(!t.isNullOrUndefined(r.XLEdit.getPropertyValue(u[i].rowIndex,u[i].colIndex,"value",n)))return!0;return r._showAlertDlg("Alert","Alert",null,440),!1},_getFilterIcon:function(){var n=t.buildTag("span .e-icon","",{});return n.addClass("e-spanfilter e-filterspan e-ssfilter"),n},filterByActiveCell:function(){var n=this.XLObj,i=n.getActiveSheetIndex(),r;if(n.model.allowFiltering&&!n.model.isReadOnly){var t=n.model.sheets[i]._activeCell,u=n.getCell(t.rowIndex,t.colIndex),f=n.model.sheets[i]._selectedCells;this._checkEmptyText(i)&&(u.find("span").is(".e-ssfiltered, .e-ssfilter, .e-ssfilter-asc, .e-ssfiltered-asc, .e-ssfilter-dsc, .e-ssfiltered-dsc")?n._showAlertDlg("Alert","HeaderAlert","",440):(r=n.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"value",i),r=n._isDateTime(r)?n.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"value2",i):r,this._filterActiveCell(i,t,f,r)))}},_filterActiveCell:function(n,t,i,r,u){var f=this.XLObj,e=f.getSheet(n);e._activeCell=t;this._filterByValue(n,u,e.columns[t.colIndex].field,"or","equal",r,i);f.model.allowComments&&f.XLComment._updateCmntArrowPos()},_filterByValue:function(i,r,u,f,e,o,s){var c=this.XLObj,s,a,p,k,tt,it,d,g=-1,rt,w,h,v,ut=c.XLEdit.getColumnIndexByField(u),y=c.getSheet(i),b,nt,l;if(t.isNullOrUndefined(r)?s=s:(a=c.getRangeIndices(r),s=c._getSelectedRange({rowIndex:a[0]+1,colIndex:a[1]},{rowIndex:a[2],colIndex:a[3]})),p=s[0],!t.isNullOrUndefined(r)&&(w=c.XLEdit.getPropertyValue(p.rowIndex,p.colIndex,"value2",i),t.isNullOrUndefined(w)||w!==o))for(l=a[0];l<a[2];l++)if(w=c.XLEdit.getPropertyValue(l,ut,"value2",i),!t.isNullOrUndefined(w)&&w===o){p={rowIndex:l,colIndex:ut};break}for(v={currentFilteringColumn:u,action:"filter",predicated:f,requestType:"filterbycell",reqType:"filter",filteredValue:o,selCells:n.extend(!0,[],s),activeCell:p},h=this._applyFilterByValue(i,p,s,o),c._excelFilter._predicates[i]={},k={field:u,value:o,predicate:f,operator:e,matchcase:!1},{}.currentFilterCollection=o,c._excelFilter._predicates[i][u]=t.Predicate(u,e,o),y.filterSettings.filteredColumns.push(k),tt=t.DataManager(y.filterSettings.filteredColumns),it=(new t.Query).where("field",t.FilterOperators.equal,u),d=tt.executeLocal(it),l=0,rt=d.length;l<rt;l++)g=n.inArray(d[l],y.filterSettings.filteredColumns),g>-1&&y.filterSettings.filteredColumns.splice(g,1);if(y.filterSettings.filteredColumns.push(k),v.filteredcolumns=h.filteredColumns=y.filterSettings.filteredColumns,h.filteredColumns.length<1)for(b=h.multifilterIdx,l=b[0];l<=b[b.length-1];l++)nt=c._generateHeaderText(l+1),t.isNullOrUndefined(h.fColumns[nt])||(h.fColumns[nt]=[]);else h.fColumns[u]=n.extend(!0,[],h.filteredColumns);h.predicate=c._excelFilter._predicates[i];v.tableID=h.tableID;v.filteredCells=h.filteredCells;c.XLSelection._refreshBorder();v.operation="filterbycell";v.selRange=c._getAlphaRange(i,h.startRow-1,h.multifilterIdx[0],h.endRow,h.multifilterIdx[h.multifilterIdx.length-1]);c._processBindings(v)&&(y.filterSettings.filteredColumns=temp)},_applyFilterByValue:function(i,r,u){var s=this.XLObj,e=s.getSheet(i),k=[],v,h,y,it,a,et=s.getCell(r.rowIndex,r.colIndex)[0].className,c=e.filterSettings.tableRange,rt=[],o,l,ut=!1,g,w,p,ot=s.model.scrollSettings.allowVirtualScrolling,nt=s.getSheet(i)._filterColl,b,d,tt,f,ft;for(a=s.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tableName",i),a=a?s._getTableID(a):-1,f=0,p=c.length;f<p;f++)if(c[f].tableID===a){l=f;break}if(!t.isNullOrUndefined(l)&&c[l].tableID===a&&c[l].selectedCellIndexes.indexOf(r.colIndex)!==-1&&c[f].startRow<=r.rowIndex&&c[f].endRow>=r.rowIndex)o=c[l],e.filterSettings.filteredRange=c[l].filteredRange,e._selectedRange=c[l].selectedRange,o.action="filtering";else{for(e._multipleFiltering=!1,e._multifilterIdx=[],s._dupDetails=!0,this.clearFilter("remove"),s._dupDetails=!1,b=s.getObjectKeys(nt),f=b.length-1;f>=0;f--)for(d=s.getObjectKeys(nt[f]),w=d.length-1;w>=0;w--)s._isRowViewable(i,b[f])&&(tt=s.getCell(b[f],d[w]),tt.find(".e-filterspan").remove(),tt.removeClass("e-filterhdr")),delete nt[b[f]][d[w]];if(u.length<2||u[0].rowIndex===u[u.length-1].rowIndex){for(h=-1,y=u[u.length-1].rowIndex,f=u[0].rowIndex;f>=0;f--)if(t.isNullOrUndefined(s.XLEdit.getPropertyValue(f,u[0].colIndex,"value2"))){h=f;break}h=h===-1?1:h+2;y=this._createSelection(i,h,y,u[0].colIndex,[]).endRowIndex-1;v={rowIndex:y,colIndex:r.colIndex};this._getSelectedRangeData({rowIndex:h,colIndex:r.colIndex},v,-1,r.colIndex)}else h=r.rowIndex,y=this._createSelection(i,h,u[u.length-1].rowIndex,u[0].colIndex,[]).endRowIndex-1,v={rowIndex:y,colIndex:r.colIndex},this._getSelectedRangeData({rowIndex:h,colIndex:r.colIndex},v,-1,r.colIndex);for(ft=s.getSheet(i)._filterColl,f=u[0].colIndex,p=u[u.length-1].colIndex;f<=p;f++)k.push(f),it=this._getFilterIcon(),h=h===0?1:h,g={rowIndex:h-1,colIndex:f},this._applyFilterIcon(g,it),rt.push(g);for(s.XLScroll._getColWidths(i,u[0].colIndex),k.length>1&&(e._multipleFiltering=!0),e._multifilterIdx=k,e._selectedCellIndexes=k,f=0,p=c.length;f<p;f++)if(c[f].tableID===a){l=f;ut=!0;break}ut?(o=c[l],o.startRow=r.rowIndex,o.endRow=v.rowIndex,o.multiFiltering=e._multipleFiltering,o.multifilterIdx=e._multifilterIdx,o.selectedCellIndexes=e._multifilterIdx,o.selectedRange=n.extend(!0,{},e._selectedRange),o.filteredRange=n.extend(!0,{},e.filterSettings.filteredRange),o.hiddenIdx=[],o.flterdIdxes=[],o.fColumns={},o.tableID=a,o.filterCollection=[],o.action="filtering"):(e.filterSettings.tableRange.push({action:"filtering",filterCollection:[],startRow:h,endRow:v.rowIndex,tableID:-1,fColumns:{},flterdIdxes:[],multiFiltering:e._multipleFiltering,multifilterIdx:e._multifilterIdx,selectedCellIndexes:e._multifilterIdx,selectedRange:n.extend(!0,{},e._selectedRange),filteredRange:e.filterSettings.filteredRange,hiddenIdx:[]}),o=c[c.length-1]);o.filteredCells=rt}return o},clearFilter:function(i){var r=this.XLObj,k;if(!r.model.isReadOnly){var d=!1,g=!1,f=r.getActiveSheetIndex(),v,nt,l=r.getSheet(f),y=n.extend(!0,{},l._filterColl),ft=r._dupDetails,tt,a=l.filterSettings.tableRange,p=-1,u,e,it,rt=[],b=r._dataContainer.sheets[f],o,h,c=r.getObjectKeys(y),s,w,ut=[],et=l.filterSettings.filteredRange,ot=l.filterSettings.filteredColumns,st=l.filterSettings.range;if(a.length){for(u=0;u<a.length;u++)if(a[u].tableID===-1){p=u;g=!0;break}if(g){for(tt=a[p].selectedRange,u=c.length-1;u>=0;u--)for(s=r.getObjectKeys(y[c[u]]),e=s.length-1;e>=0;e--)o=parseInt(c[u]),h=parseInt(s[e]),t.isNullOrUndefined(r.XLEdit.getPropertyValue(o,h,"tableName",f))&&(rt.push({rowIndex:o,colIndex:h}),nt=y[c[u]][s[e]],nt.status.indexOf("e-ssfiltered")>-1&&(v=r.model.sheets[f].columns[s[e]].field,ut.push({fieldName:v,filterCollection:a[p].filterCollection,action:"filtering",tableID:-1,predicate:r._excelFilter._predicates[f][v]}),delete r._excelFilter._predicates[f][v],r._dupDetails=!0,this._clearFilterColumn(v,"","","Or","","",-1),r._dupDetails=!1,d=!0),i==="remove"&&(delete y[c[u]][s[e]],delete b[c[u]][s[e]].isFilterHeader,delete b[c[u]][s[e]].filterState,delete b[c[u]][s[e]].isFilterVisible,r._isRowViewable(f,o)&&(w=r.getCell(o,h),n.isNumeric(r.XLEdit.getPropertyValue(o,h))&&w.addClass(r._rAlign),w.find(".e-filterspan").remove(),r.addClass(w[0],"e-wrapword"),r.XLEdit.getPropertyValue(o,h,"isFilterWrap")&&r.setWrapText("wrap",r._getAlphaRange(f,o,h,o,h)),r._removeClass(w[0],"e-filterhdr"))));i==="remove"&&(r._dupDetails=ft,l._filterColl=y,p>-1&&(it=a.splice(p,1)[0]),r.model.allowComments&&r.XLComment._updateCmntArrowPos(),r._isUndoRedo||r._dupDetails||(k={sheetIndex:f,operation:"remove-filter",status:i,process:"apply-filter",filteredCells:rt,requestType:"filter",reqType:"filter",fRange:r.getSheet(f).filterSettings.range,filterRange:it,filterCollection:ut,filteredCols:ot,fltrdRange:et,selRange:tt},r._completeAction(k),r._trigActionComplete(k)));d&&n("#"+r._id+"_Ribbon_Data_SortFilter_ClearFilter").ejButton("disable")}}}},filter:function(n){var i=this.XLObj;if(i.model.allowFiltering&&!i.model.isReadOnly){var f=i.getActiveSheetIndex(),u=i.getSheet(f),o=!1,y=u._activeCell,e,l,h=u.filterSettings.tableRange,a,r,c,p,v,s;for(u._multipleFiltering=!1,u._multifilterIdx=[],e=i.XLEdit.getPropertyValue(y.rowIndex,y.colIndex,"tableName",f),t.isNullOrUndefined(e)||(e=i._getTableID(e)),r=0,c=h.length;r<c;r++)h[r].tableID===-1&&(o=!0),a=r;if(s={range:i._getRangeArgs(n,"string"),reqType:t.Spreadsheet.Actions.Filtering,sheetIndex:f},i._trigActionBegin(s))return!0;if(n=s.range,o&&(this.clearFilter("remove"),u.filterSettings.filteredRange=[],u._selectedRange={},u._selectedCellIndexes=[],u.filterSettings.filteredColumns=[],i._excelFilter._predicates[f]={}),!t.isNullOrUndefined(e)&&e>-1){for(p=h[a].startRow,l=h[a].multifilterIdx,r=0,c=l.length;r<c;r++)v=this._getFilterHeader(f,p,l[r]),!t.isNullOrUndefined(v)&&v.status.indexOf("e-ssfiltered")>-1&&this._clearFilterColumn(u.columns[r].field,"","","","","",e);this._clearFilterTableIcon(f,e);o=!0}if(o){if(s={sheetIdx:f,reqType:"clear-Filter"},i._trigActionComplete(s))return}else this._filterCellRange(f,n);i._isFiltered=!o;i.model.allowComments&&i.XLComment._updateCmntArrowPos()}},_applyFilterIcon:function(n,t){var f,r=this.XLObj,c=this.XLObj._rAlign,e=r.getActiveSheetIndex(),i=n.rowIndex,u=n.colIndex,l=r.getSheet(e),s=r._isRowViewable(e,i),o=l._filterColl,h=!1;s&&(f=r.getCell(i,u,e),f[0].insertBefore(t[0],f[0].childNodes[f[0].childNodes.length-1]),f.addClass("e-filterhdr"),f.removeClass("e-ralign"));r.XLEdit.getPropertyValue(i,u,"wrap",e)&&(h=!0,r.setWrapText("unwrap",r._getAlphaRange(e,i,u,i,u)));r.XLEdit._updateDataContainer({rowIndex:i,colIndex:u},{dataObj:{isFilterHeader:!0,filterState:"filter",isFilterVisible:!0,isFilterWrap:h},sheetIdx:e});r.isNumber(r.model.allowFiltering&&r.XLEdit.getPropertyValue(i,u,"value2",e))&&s&&r._removeClass(f[0],c);i in o||(o[i]={});u in o[i]||(o[i][u]={});o[i][u].status="e-ssfilter";o[i][u].isTable=t[0].className.indexOf("e-ft")>-1},_postionFilterIcon:function(n,t){var i=this.XLObj,u=n||i.getActiveCellElem(),o=t||u.find(".e-filterspan"),f,e,r=i._getCellIdx(u[0]);i.model.allowResizing&&(f=i.XLResize._getContentWidth(r.colIndex,i.getActiveSheetIndex(),r.rowIndex,r.rowIndex),e=i.XLResize._getContentHeight(r.rowIndex,i.getActiveSheetIndex()))},_filterCellRange:function(n,i){var f=this.XLObj,u,w=!1,tt,it,b,rt,k=[],s=-1,ut=!1,ft=0,et,e,h,a,ot,y,v,p,o,r=f.getSheet(n),st=[],ht=!1,c,l=[],d=[],g=!1,nt={sheetIndex:n,reqType:"filter",operation:"apply-filter"};if(t.isNullOrUndefined(i)){if(!f.model.allowSelection)return;u=r._selectedCells}else y=f.getRangeIndices(i),u=f._getSelectedRange({rowIndex:y[0],colIndex:y[1]},{rowIndex:y[2],colIndex:y[3]});if(u.length<2&&(c=u,t.isNullOrUndefined(i)||f.performSelection(i,n),f.selectAll(!1),u=r._selectedCells,ht=!0),f.XLRibbon._dirtySelect(),!f.XLRibbon._isDirtySelect&&u.length!=0){for(e=u[0].colIndex,a=u[u.length-1].colIndex;e<=a;e++){if(k.push(e),s=u[0].rowIndex,ht)r._isSheetSelected||(l.push(e),r._multifilterIdx.push(e),w=!0);else{if(!ut||k.length>0)for(h=s,ot=u[u.length-1].rowIndex;h<=ot;h++)rt=f._isRowVisible(n,h),rt&&(f.XLEdit.getPropertyValue(h,e,"value2",n)||l.length&&f.XLEdit.getPropertyValue(0,e,"isCHide",n))&&((s===-1||s>h)&&(s=h),ut=!0,w=!0,g=!0),s<h&&ft===0&&st.push(h);g&&(l.push(e),r._multifilterIdx.push(e),g=!1)}ft++}if(l.length>1&&(r._multipleFiltering=!0),d=[],w){for(e=0,a=l.length;e<a;e++)et=this._getFilterIcon(),this._applyFilterIcon({rowIndex:s,colIndex:l[e]},et),d.push({rowIndex:s,colIndex:l[e]});for(v={rowIndex:s+1,colIndex:u[0].colIndex},p={rowIndex:u[u.length-1].rowIndex},r._selectedRange={startRow:v.rowIndex,endRow:p.rowIndex,dataSourceIndexes:st},this._getSelectedRangeData(v,u[u.length-1],-1,v.colIndex),r._selectedCellIndexes=k,nt={sheetIndex:n,filteredCells:d,reqType:"filter",operation:"apply-filter",tableID:-1},b=r.filterSettings.tableRange,e=0,a=b.length;e<a;e++)b[e].tableID===-1&&(tt=!0,it=e);tt?(o=r.filterSettings.tableRange[it],o.startRow=v.rowIndex,o.endRow=p.rowIndex,o.multiFiltering=r._multipleFiltering,o.multifilterIdx=r._multifilterIdx,o.selectedCellIndexes=r._multifilterIdx,o.selectedRange=r._selectedRange,o.filteredRange=r.filterSettings.filteredRange,o.filteredColumns=r.filterSettings.filteredColumns,o.predicate=f._excelFilter._predicates[n],o.hiddenIdx=[],o.flterdIdxes=[],o.fColumns={},o.filterColumnName=[],o.filterCollection=[]):r.filterSettings.tableRange.push({filterCollection:[],startRow:v.rowIndex,endRow:p.rowIndex,tableID:-1,multiFiltering:r._multipleFiltering,multifilterIdx:r._multifilterIdx,selectedCellIndexes:r._multifilterIdx,selectedRange:r._selectedRange,filteredRange:r.filterSettings.filteredRange,filteredColumns:r.filterSettings.filteredColumns,fColumns:{},predicate:{},hiddenIdx:[],fltrdIdxes:[],filterColumnName:[]});f.XLScroll._getColWidths(n,r._multifilterIdx[0]);r._isImported&&!r._isLoaded||f._isExport||(i=c?[c[0].rowIndex,c[0].colIndex,c[c.length-1].rowIndex,c[c.length-1].colIndex]:f.isUndefined(i)?[u[0].rowIndex,u[0].colIndex,u[u.length-1].rowIndex,u[u.length-1].colIndex]:f.getRangeIndices(i),f._completeAction(nt),f._trigActionComplete(nt),t.isNullOrUndefined(i)||f.performSelection(i,n))}else f._showAlertDlg("Alert","Alert","",440)}},openFilterDialog:function(n){var t,i=this.XLObj;i.model.isReadOnly||(typeof n=="string"&&(n=i.getRangeIndices(n)),t=i.getCell(n[0],n[1]).find("span.e-filterspan"),t.length>0&&this._filterClickHandler({target:t[0]}))},_filterClickHandler:function(i){var r=this.XLObj,tt,it,w=n(i.target),o=r.getActiveSheetIndex(),e=r.getSheet(o),st=!1,c,y,b,ht,l,rt,ut,a,ft,h,s,f,ct=[],lt={},et,ot,k,v,p,at=r.model.scrollSettings.allowVirtualScrolling,vt=n(i.target).position(),yt=r.getSheetElement(o).find(".e-spreadsheetcontentcontainer").position(),d,g,nt=["showItems","hideItems"],u;if(y=r._generateHeaderText(i.target.parentNode.cellIndex+1),this._isDecimal=!1,(!r.model.allowLockCell||!r.getSheet(o).isSheetProtected)&&!r.preventFilterPopup){if(w[0].className.indexOf("e-ssfiltered")>-1&&(st=!0),a=i.target.parentNode.cellIndex,w[0].className.indexOf("e-ssfilter")>-1){for(f=r.model.sheets[o].filterSettings.tableRange,tt=r._getCellIdx(w.parent()[0]),it=r.XLEdit.getPropertyValue(tt.rowIndex,tt.colIndex,"tableName"),h=t.isNullOrUndefined(it)?-1:parseInt(it.replace("e-table","")),u=0,l=f.length;u<l;u++)f[u].tableID===h&&(v=u,f[u].multiFiltering?(rt=f[u].multifilterIdx[0],ut=f[u].multifilterIdx[f[u].multifilterIdx.length-1]):rt=ut=i.target.parentNode.cellIndex,ot={rowIndex:f[u].startRow,colIndex:rt},k={rowIndex:f[u].endRow,colIndex:ut},e._multipleFiltering=f[u].multiFiltering,e._multifilterIdx=f[u].multifilterIdx,s=e._selectedRange=f[u].selectedRange,e.filterSettings.filteredRange=f[u].filteredRange,e._selectedCellIndexes=f[u].selectedCellIndexes);if(h===-1){if(p=this._createSelection(o,s.startRow,s.endRow,a,s.dataSourceIndexes),c=p.endRowIndex>s.endRow?p.endRowIndex-1:p.endRowIndex,s.endRow!=c)for(u=s.endRow+1;u<=c;u++)ft={field:y,value:r.XLEdit.getPropertyValue(u,a,"value2",o),matchcase:!1,operator:"equal",predicate:"or"},e.filterSettings.filteredColumns.push(ft),f[v].filteredColumns.push(ft),f[v].selectedRange.endRow=c;k={rowIndex:c,colIndex:a};f[v].selectedRange=e._selectedRange={startRow:ot.rowIndex,endRow:k.rowIndex,dataSourceIndexes:p.filteredIndex};f[v].endRow=c}for(this._getSelectedRangeData(ot,k,h,a),b=e.columns,ht=this._getColumnType(o,s.startRow,s.endRow,a),u=0,l=b.length;u<l;u++)if(b[u].field===y){r._$colType=ht;r._$curFieldName=b[u].field;break}for(r._showDialog(r._id+"_Filter",r._$colType),et=r._getXYPos(w,n("#"+r._id+r._$colType+"_excelDlg"),18,18),f=r.model.sheets[o].filterSettings.tableRange,u=0,l=f.length;u<l;u++)f[u].tableID===h&&(ct=f[u].filteredColumns,lt=f[u].predicate);r._excelFilter._predicates[o]=lt;this._isSearchEdit=!0;n.extend(!0,r._excelFilter._columnsFiltered,e._filteredColumns);r._phoneMode||r._tabMode?this._openNormalFilterDlg(y,r._$colType,h,v):r._excelFilter.openXFDialog({field:y,dataSource:e.filterSettings.filteredRange?e.filterSettings.filteredRange:e.dataSource,position:{X:et.xPos,Y:et.yPos},type:r._$colType,format:r._$colFormat,filteredColumns:ct,sortedColumns:[],key:o,tableID:h,selectedColors:e._selectedCellColors,isFiltered:st,blank:"",enableColor:!0,filteredByColor:e._filteredByColor})}d=n("#"+r._id+"string_MenuItem").data("ejMenu");g=n("#"+r._id+"number_MenuItem").data("ejMenu");d&&d[r.model.allowSorting?nt[0]:nt[1]](d.element.find("li:lt(4)"));g&&g[r.model.allowSorting?nt[0]:nt[1]](g.element.find("li:lt(4)"))}},_cancelHandler:function(){this._isSearchEdit=!1},applyFilter:function(n){var i=this.XLObj,f=n.predicate||t.Predicate(n.field,n.operator,n.value,!n.matchcase),e,u=[],r=i.getActiveSheetIndex();e=i.model.sheets[r].filterSettings.tableRange;i._isFiltered||i.XLFilter.filter(n.filterRange);t.isNullOrUndefined(i._excelFilter._predicates[r])&&(i._excelFilter._predicates[r]={},i._excelFilter._predicates[r][n.field]={});i._excelFilter._predicates[r][n.field]=f;n.filterCollection?u=n.filterCollection:u.push({actualFilterOperator:n.operator,actualFilterValue:n.value,actualPredicate:n.predicate,field:n.field,isCustom:!0,matchcase:n.matchcase,operator:n.operator,predicate:n.predicate,value:n.value});this._filterHandler({action:"filtering",fieldName:n.field,tableID:n.tableID||-1,ejpredicate:f,filterCollection:u})},_filterHandler:function(i){var d,b,it,s,k,f,a,y,rt,ut,ft;if(!i.originalEvent||(d=i.originalEvent.target.parentElement.className,!d||!(d.indexOf("hdr")>-1))){var f,a,e,et=!1,o=-1,g,h,r={},ot,u=this.XLObj,l=u.getActiveSheetIndex(),v=u.getSheet(l),st,nt,tt,c=[],p={},w;for(r.requestType=i.action==="sorting"||i.action==="filterbycolor"?i.action:"filtering",e=v.filterSettings.tableRange,u.XLFilter._isSearchEdit=!1,f=0,a=e.length;f<a;f++)e[f].tableID===i.tableID&&(n.extend(!0,c,e[f].filteredColumns),p=e[f].predicate,et=!0,o=f);if(i.action==="clearfiltering"&&i.reqType==="filterbycolor"&&(r.requestType=e[o].action),r.tableID=i.tableID,i.action==="filtering"||i.action==="clearfiltering"){for(r.rowIndex=e[o].startRow-1,r.colIndex=u._generateColCount(i.fieldName)-1,ot=t.DataManager(c),st=(new t.Query).where("field",t.FilterOperators.equal,i.fieldName),nt=ot.executeLocal(st),r.filteredColumns=c,f=0,a=nt.length;f<a;f++)tt=n.inArray(nt[f],c),tt>=0&&c.splice(tt,1);i.action==="clearfiltering"?delete u._excelFilter._predicates[l][i.fieldName]:t.merge(c,i.filterCollection);p=u._excelFilter._predicates[l]}if(et)if(e[o].filteredColumns=c,e[o].filterCollection=i.filterCollection,e[o].predicate=p,e[o].action=i.action,c.length<1)for(b=e[o].multifilterIdx,f=b[0];f<=b[b.length-1];f++)it=u._generateHeaderText(f+1),t.isNullOrUndefined(e[o].fColumns[it])||(e[o].fColumns[it]=[]);else e[o].fColumns[i.fieldName]=n.extend(!0,[],c);if(h=v.filterSettings.tableRange[o].selectedRange,s=v.filterSettings.tableRange[o].selectedCellIndexes,k=v._filterColl,i.action==="filtering"||i.action==="clearfiltering")r.currentFilteringColumn=i.fieldName,r.ejpredicate=i.ejpredicate,r.filterCollection=n.extend(!0,[],i.filterCollection),r.action=i.action,r.reqType=r.requestType==="filterbycolor"?r.requestType:"filter",r.sheetIndex=l,r.filteredcolumns=c,r.predicate=p;else if(i.action==="sorting"){if(!u.model.allowSorting)return;if(r.requestType=r.action=i.action,g=u.XLEdit.getColumnIndexByField(i.sortDetails.field),u.XLSort._isSortByFilter=!0,u.XLSort.sortByRange(u.swapRange([h.startRow,s[0],h.endRow,s[s.length-1]]),i.sortDetails.field,i.sortDetails.direction,i.tableID))return;for(this._changeSortIcon({rowIndex:h.startRow-1,colIndex:g},i.sortDetails.direction),f=0,a=s.length;f<a;f++)s[f]!=g&&(k[h.startRow-1][s[f]].status.indexOf("-asc")>-1||k[h.startRow-1][s[f]].status.indexOf("-dsc")>-1)&&(k[h.startRow-1][s[f]].status="e-ssfilter",u._isRowViewable(l,h.startRow-1)&&(w=u.getCell(h.startRow-1,s[f]).find(".e-filterspan")[0],u._removeClass(w,"e-ssfilter-asc"),u._removeClass(w,"e-ssfilter-dsc"),u.addClass(w,"e-ssfilter")))}else{if(r.requestType=r.action=i.action,r.range=v._selectedRange,u.model.allowSorting&&u.XLSort._sortRangeAlert([h.startRow,s[0],h.endRow,s[s.length-1]]))return;i.action==="sortbycolor"?(r.sortColumn=i.sortDetails.field,r.operation=i.sortDetails.operation,y=i.sortDetails.color.replace("rgb(","").replace(")","").split(",")):(u._isUndoRedo?(r.filterColumn=i.columnName,r.operation=i.operation):(r.filterColumn=i.filterDetails.field,r.operation=i.filterDetails.operation,y=i.filterDetails.color.replace("rgb(","").replace(")","").split(",")),r.tableID=i.tableID,u.model.sheets[l]._filteredByColor=r.filterColumn);u._isUndoRedo||(rt=y[0],ut=y[1],ft=y[2]);r.operation==="sortbgcolor"||r.operation==="filterbgcolor"?r.bgcolor=u._isUndoRedo?i.bgcolor:this._convertrgbtohex(parseInt(rt),parseInt(ut),parseInt(ft)):r.fgcolor=u._isUndoRedo?i.fgcolor:this._convertrgbtohex(parseInt(rt),parseInt(ut),parseInt(ft))}r.oprType="filter";r.selRange=u._getAlphaRange(l,e[o].startRow-1,e[o].multifilterIdx[0],e[o].endRow,e[o].multifilterIdx[e[o].multifilterIdx.length-1]);i.action!=="sorting"&&u._processBindings(r)&&(c=temp);i.action==="clearfiltering"&&(u.XLRibbon._isFilterSelect.status=!1);u.model.allowComments&&u.XLComment._updateCmntArrowPos();u.model.allowSelection&&u.XLSelection._refreshBorder();u.model.showRibbon&&u.XLRibbon._refreshRibbonIcons();u._isFrozen(u.getFrozenRows())&&u.XLFreeze._refreshFreezeRowDiv()}},_convertrgbtohex:function(n,t,i){return"#"+(16777216+(n<<16)+(t<<8)+i).toString(16).slice(1)},_clearFilterColumn:function(i,r,u,f,e,o,s){var c=this.XLObj,v,l={},h,k,w=c.getActiveSheetIndex(),a=c.getSheet(w),it=!1,d={},rt,ut,g,nt,y=a.filterSettings.tableRange,p=[],tt,b,ft;for(l.requestType=t.Grid.Actions.Filtering,l.currentFilterObject=[],n.isArray(r)||(r=n.makeArray(r)),n.isArray(u)||(u=n.makeArray(u)),this._currentFilterColumn=this._getColumnByField(w,i),b=0,ft=r.length;b<ft;b++)if(d={field:i,operator:r[b],value:u[b],matchcase:e,predicate:f,actualFilterValue:o},!it){for(h=0,k=y.length;h<k;h++)y[h].tableID===s&&(v=y[h],n.extend(!0,p,y[h].filteredColumns),c._excelFilter._predicates[w]=y[h].predicate,a.filterSettings.filteredRange=a.filterSettings.tableRange[h].filteredRange,a._selectedCellIndexes=y[h].selectedCellIndexes,a._selectedRange=y[h].selectedRange,a._multifilterIdx=y[h].multifilterIdx);for(rt=t.DataManager(p),ut=(new t.Query).where("field",t.FilterOperators.equal,d.field),g=rt.executeLocal(ut),h=0,k=g.length;h<k;h++)nt=n.inArray(g[h],p),nt!==-1&&p.splice(nt,1)}(tt=n.inArray(i,a._filteredColumns),tt>-1&&a._filteredColumns.splice(tt,1),c._isUndoRedo&&c.isUndefined(v))||(it=!0,delete c._excelFilter._predicates[w][i],v.filteredColumns=p,v.predicate=c._excelFilter._predicates[w],l.currentFilterObject.push(d),l.filterCollection=p,l.currentFilteringColumn=i,l.filteredcolumns=p,l.action="clearfiltering",l.reqType="filter",l.tableID=s,l.selRange=c._getAlphaRange(w,v.startRow-1,v.multifilterIdx[0],v.endRow,v.multifilterIdx[v.multifilterIdx.length-1]),c._processBindings(l)&&(a.filterSettings.filteredColumns.reverse().splice(0,r.length),a.filterSettings.filteredColumns.reverse()),c.model.allowComments&&c.XLComment._updateCmntArrowPos(),c.model.allowSelection&&c.XLSelection._refreshBorder())},_getFilterHeader:function(n,i,r){var f=this.XLObj,e=f.getSheet(n),u=e._filterColl;if(!t.isNullOrUndefined(u[i])&&!t.isNullOrUndefined(u[i][r]))return u[i][r]},_filterTable:function(i,r,u){var c=this.XLObj,e=c.getSheet(i),l=[],y=!1,p=!1,s,a,w,v,h,o,f,b;for(e._multipleFiltering=!1,e._multifilterIdx=[],h=u?u.endCell:n.extend(!0,{},e._endCell),o=u?u.startCell:n.extend(!0,{},e._startCell),f=o.colIndex;f<=h.colIndex;f++)v=this._getFilterHeader(i,o.rowIndex,f),!t.isNullOrUndefined(v)&&v.status.indexOf("e-ssfilter")>-1?y=!0:(a=this._getFilterIcon(),w="e-ft"+r,a.addClass(w),this._applyFilterIcon({rowIndex:o.rowIndex,colIndex:f},a),l.push(f),e._multifilterIdx.push(f));if(c.XLScroll._getColWidths(i,o.colIndex),!y)if(l.length>1&&(e._multipleFiltering=!0,p=!0),o.rowIndex=o.rowIndex+1,this._getSelectedRangeData(o,h,r,o.colIndex),c._isFATResize){if(s=e.filterSettings.tableRange,s.length)for(f=0,b=s.length;f<b;f++)if(s[f].tableID===r){s[f].endRow=h.rowIndex;break}c._isFATResize=!1}else e.filterSettings.tableRange.push({filterCollection:[],startRow:o.rowIndex,endRow:h.rowIndex,tableID:r,multiFiltering:p,multifilterIdx:l,selectedCellIndexes:l,selectedRange:n.extend(!0,{},e._selectedRange),filteredRange:e.filterSettings.filteredRange,filteredColumns:e.filterSettings.filteredColumns,fColumns:{},predicate:{},hiddenIdx:[],filterColumnName:[]})},_clearFilterTable:function(n,t,i){var e=this.XLObj.getSheet(n?n:this.getActiveSheetIndex()),u,r,f;for(u=e.filterSettings.tableRange,r=0,f=u.length;r<f;r++)u[r].tableID===t&&(this._clearAllFilter(n,r,i),f=u.length)},_clearAllFilter:function(i,r,u){var b,s=this.XLObj,a=s._dataContainer.sheets[i],c=s.getSheet(i),h=c.filterSettings.tableRange,l,y,f,p,w,e,o,v;for(c._selectedRange=h[r].selectedRange,e=h[r].multifilterIdx,o=h[r].startRow,f=0,p=e.length;f<p;f++)w=c.columns[e[f]].field,v=s.XLEdit.getPropertyValue(o-1,e[f],"filterState"),!t.isNullOrUndefined(v)&&v.indexOf("filtered")>-1&&this._clearFilterColumn(w,"","","Or","","",h[r].tableID),u||(s._isRowViewable(i,o-1)&&(l=s.getCell(o-1,e[f]),s.addClass(l[0],"e-wrapword"),y=l.find(".e-filterspan"),n(y).remove(),l.removeClass("e-filterhdr")),a[o-1][e[f]]&&(delete a[o-1][e[f]].isFilterHeader,delete a[o-1][e[f]].filterState),delete c._filterColl[o-1][e[f]]);u||(h.splice(r,1),b=h.length)},_clearFilterTableIcon:function(n,t){for(var i=this.XLObj,h,c,l=i.getSheet(n),u=l.filterSettings.tableRange,e,o,f,a,s,r=0,v=u.length;r<v;r++)if(u[r].tableID===t)for(l._selectedRange=u[r].selectedRange,l.filterSettings.filteredRange=u[r].filteredRange,e=u[r].multifilterIdx,o=u[r].startRow,f=0,a=e.length;f<a;f++)h=i.XLEdit.getPropertyValue(o-1,e[f],"isFilterVisible"),i._isRowViewable(n,o-1)&&(s=i.getCell(o-1,e[f]),c=s.find(".e-filterspan"),h?(c.hide(),i._removeClass(s[0],"e-filterhdr")):(i.addClass(s[0],"e-filterhdr"),c.show())),i.XLEdit._updateDataContainer({rowIndex:o-1,colIndex:e[f]},{dataObj:{isFilterVisible:!h}})},_insertFilterIcon:function(n,t,i){var r;r=this._getFilterIcon();i.tableID>-1&&this.XLObj.XLEdit._updateDataContainer({rowIndex:n,colIndex:t},{dataObj:{tableName:"e-table"+i.tableID}});this._applyFilterIcon({rowIndex:n,colIndex:t},r)},_changeFilterIcon:function(n,t,i){var f,s,h,c=!1,r=this.XLObj,u=n.rowIndex,e=n.colIndex,l=r._rAlign,o=r.getActiveSheetIndex();h=this._getFilterHeader(o,u,e).status;r._isRowViewable(o,u)&&(s=r.getCell(u,e),f=s.find(".e-filterspan")[0],s.removeClass(l),c=!0);t==="filter"?i.indexOf("filtered")<0&&(r.XLEdit._updateDataContainer({rowIndex:u,colIndex:e},{dataObj:{filterState:i.replace("filter","filtered")}}),r.getSheet(o)._filterColl[u][e].status=h.replace("e-ssfilter","e-ssfiltered"),c&&(f.className=f.className.replace("e-ssfilter","e-ssfiltered"))):(r.XLEdit._updateDataContainer({rowIndex:u,colIndex:e},{dataObj:{filterState:i.replace("filtered","filter")}}),r.getSheet(o)._filterColl[u][e].status=h.replace("e-ssfiltered","e-ssfilter"),c&&!r.isUndefined(f)&&(f.className=f.className.replace("e-ssfiltered","e-ssfilter")))},_changeSortIcon:function(n,t){var u=this.XLObj,h=u.getActiveSheetIndex(),r,i,e,o=!1,s=u.getSheet(h)._filterColl,f;i=s[n.rowIndex][n.colIndex].status;r=i.indexOf("e-ssfiltered")>-1?12:10;e=i.substr(0,r);u._isRowViewable(h,n.rowIndex)&&(f=u.getCell(n.rowIndex,n.colIndex).find(".e-filterspan")[0],i=f.className,r=i.indexOf("e-ssfilter")+r,o=!0);t==="ascending"?(s[n.rowIndex][n.colIndex].status=e+"-asc",o&&(f.className=i.substr(0,r)+"-asc")):(s[n.rowIndex][n.colIndex].status=e+"-dsc",o&&(f.className=i.substr(0,r)+"-dsc"))},_extendFilterRange:function(n,t){var o=this.XLObj,u,r=o.getSheet(o.getActiveSheetIndex()).filterSettings.tableRange,i,e,f;if(r.length)for(i=0,f=r.length;i<f;i++)if(r[i].tableID==n){if(r[i].endRow<t[2]&&(u=r[i].selectedRange.dataSourceIndexes,r[i].endRow=r[i].selectedRange.endRow=t[2],u[u.length-1]<r[i].endRow))for(e=u[u.length-1],f=r[i].endRow;e<f;e++)u.push(e+1);break}},_updateFilterIcons:function(t,i,r,u){for(var o=this.XLObj,f,s,h=n("#"+o._id+"numberSelectAll").ejCheckBox("instance"),l=h?!1:h.model.checked,c=n("#"+o._id+"stringSelectAll").ejCheckBox("instance"),a=c?!1:c.model.checked,e=t;e<=i;e++){s={rowIndex:e,colIndex:r};f=o.XLEdit.getPropertyValue(e,r,"filterState");f.indexOf("filtered")>-1&&(u=="clearfiltering"||l||a)?this._changeFilterIcon(s,"filtered",f):f.indexOf("filtered")<0&&u!="clearfiltering"&&this._changeFilterIcon(s,"filter",f);break}},_fltrRowHighlight:function(t,i,r){var f=this.XLObj,c=f.getActiveSheetIndex(),h=f._getJSSheetRowHeaderContent(c),l=h.find("table tr:gt("+(t-1)+"):lt("+(i-t+1)+")"),e=f.model.sheets[c].filterSettings.tableRange,a,u,s=f.model.sheets[c].filteredRowsCollection,o;if(f.model.scrollSettings.allowVirtualScrolling&&(l=h.find("table tr").filter(function(){return n(this).attr("data-idx")>=t&&n(this).attr("data-idx")<=i})),r==="clear"){if(l.find("td").removeClass("e-filterhiglight"),f.clearRangeData([t,0,i,0],["isFilterHighlight"]),s.length)for(o=0;o<s.length;o++)for(u=0,a=e.length;u<a;u++)s[o]>=e[u].startRow&&s[o]<=e[u].endRow&&!f.XLEdit.getPropertyValue(s[o],0,"isRHide")&&(f.updateUniqueData({isFilterHighlight:!0},[e[u].startRow,0,e[u].endRow,0]),f.model.scrollSettings.allowVirtualScrolling?h.find("table tr").filter(function(){return n(this).attr("data-idx")>=e[u].startRow&&n(this).attr("data-idx")<=e[u].endRow}).find("td").addClass("e-filterhiglight"):h.find("table tr:gt("+(e[u].startRow-1)+"):lt("+(e[u].endRow-e[u].startRow+1)+")").find("td").addClass("e-filterhiglight"))}else r==="add"&&(l.find("td").addClass("e-filterhiglight"),f.updateUniqueData({isFilterHighlight:!0},[t,0,i,0]))},_checkFilterApplied:function(n,t,i,r,u,f){var h,s=this.XLObj,a=s.getSheet(n),o=a.filterSettings.tableRange,c,e,l;for(s._isFilterApplied=!1,e=0,l=o.length;e<l;e++)if(c=!1,o[e].filteredColumns.length?(h=s._checkFilterMerge(n,[o[e].startRow-1,o[e].multifilterIdx[0],o[e].endRow,o[e].multifilterIdx[o[e].multifilterIdx.length-1]],t,i,r,u,f,"filter",c),s._isFilterApplied=!h.isAlert):s._isFilterApplied=!1,s._isFilterApplied)return!0;return!1},_updateFilterCollection:function(i,r,u,f,e){var l,h,a,p,nt,tt,w,b,c=this.XLObj,v=c.getSheet(i),k=v.filterSettings.tableRange,o,s,ut=c.model.scrollSettings.allowVirtualScrolling,g,it,rt,d,y;if(u=u+1,f==="row")for(l=0,p=k.length;l<p;l++)o=k[l],s=o.multifilterIdx,e==="insert"?r<=o.endRow&&(o.endRow=o.endRow+u,r<o.startRow?(o.startRow=o.startRow+u,o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u,isInsertBefore:!0})):o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u})):r<=o.endRow&&(o.endRow=o.endRow-u,r<o.startRow?(o.startRow=o.startRow-u,o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u,isInsertBefore:!0})):o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u})),w={rowIndex:o.startRow,colIndex:s[0]},b={rowIndex:o.endRow,colIndex:s[s.length-1]},this._getSelectedRangeData(w,b,o.tableID),o.selectedRange=n.extend(!0,{},v._selectedRange),o.filteredRange=n.extend(!0,{},v.filterSettings.filteredRange);else for(rt=c._dataContainer.sheets[i],l=0,p=k.length;l<p;l++){if(o=k[l],s=o.multifilterIdx,y=n.extend(!0,[],s),d=0,this._updateFilteredColumns(l,r,u,e),e==="insert"){if(r<=s[0]){for(h=s.length-1;h>=0;h--)s[d]=s[d]+u,d++;o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u,isInsertBefore:!0})}else if(r<=s[s.length-1])for(o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u}),h=y[y.length-1],nt=y[y.length-1]+u;h<=nt;h++)s.indexOf(h)===-1&&s.push(h)}else if(r<=s[0]){for(h=0;h<s.length;h++)s[h]=s[h]-u;o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u,isInsertBefore:!0})}else if(r<=s[s.length-1]){for(a=r,tt=s[s.length-1];a<=tt;a++)it=c._generateHeaderText(a+1),g=c.XLEdit.getPropertyValue(o.startRow-1,a,"filterState"),!t.isNullOrUndefined(g)&&g.indexOf("filtered")>-1&&this._clearFilterColumn(it,"","","Or","","",o.tableID);s.splice(s.length-u,u);o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u})}w={rowIndex:o.startRow,colIndex:s[0]};b={rowIndex:o.endRow,colIndex:s[s.length-1]};this._getSelectedRangeData(w,b,o.tableID);o.selectedRange=n.extend(!0,{},v._selectedRange);o.filteredRange=n.extend(!0,{},v.filterSettings.filteredRange);s.length<2&&(o.multiFiltering=!1)}},_updateFilteredColumns:function(t,i,r,u){for(var c,v,f=this.XLObj,k,g=f.getActiveSheetIndex(),e=f.getSheet(g).filterSettings.tableRange[t],y=n.extend(!0,[],e.filteredColumns),d=n.extend(!0,{},e.fColumns),l=n.extend(!0,{},e.fColumns),tt=e.multifilterIdx,o=0,nt=y.length;o<nt;o++)colIdx=f.XLEdit.getColumnIndexByField(e.filteredColumns[o].field),i<=colIdx&&(u==="delete"?i===colIdx?y.splice(o,1):y[o].field=f._generateHeaderText(colIdx-r+1):y[o].field=f._generateHeaderText(colIdx+r+1));e.filteredColumns=y;var s,p,w,h,a,it=f.getObjectKeys(e.fColumns),b=f.getObjectKeys(d);for(e.predicate=e.predicate,o=b.length-1;o>=0;o--)for(k=f.XLEdit.getColumnIndexByField(b[o]),c=i;c<i+r;c++)if(c<=k){for(s=n.extend(!0,[],d[b[o]]),v=0;v<s.length;v++)colIdx=f.XLEdit.getColumnIndexByField(s[v].field),c<=colIdx&&(u==="delete"?c===colIdx?s.splice(o,1):s[v].field=f._generateHeaderText(colIdx-r+1):s[v].field=f._generateHeaderText(colIdx+r+1));p=f.XLEdit.getColumnIndexByField(b[o]);h=f._generateHeaderText(p+1);u==="delete"?(w=p-r,c===p?(delete e.predicate[h],delete l[h]):(a=f._generateHeaderText(w+1),l[a]=s,delete l[h],e.predicate[a]=f._excelFilter.generatePredicate(s),delete e.predicate[h])):(w=p+r,a=f._generateHeaderText(w+1),l[a]=s,delete l[h],e.predicate[a]=f._excelFilter.generatePredicate(s),delete e.predicate[h])}e.fColumns=l},_renderCustomFilter:function(){var i=this.XLObj,r=i._id+"_filter_custom",u=n("#"+r),o=t.buildTag("div#"+r+"_content"),f=t.buildTag("input#"+r+"_filterBtn.e-filter",{},{},{type:"button",value:"Filter"}),e=t.buildTag("input#"+r+"_clearBtn.e-clear",{},{},{type:"button",value:"Clear"});u.append(o.append(t.buildTag("div.e-fltrbtndiv").append(f).append(e)));this._createButton("filter",f);this._createButton("clear",e);u.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("Filter"),width:"100%",height:"100%",cssClass:"e-ss-dialog e-"+i._id+"-dlg",open:function(){n("#"+i._id+"_formatdlg_okbtn").focus()},close:t.proxy(this._customFltrDlgClose,this)})},_customFltrDlgClose:function(){n("#"+this.XLObj._id+"_filter_custom_"+this._colType).hide()},_refreshCustomFilter:function(i){var e=this.XLObj,r=e._id+"_filter_custom",u=t.buildTag("input#"+r+"_"+i+"_ddinput.e-"+e._id+"_customddl",{},{},{type:"text"}),f=t.buildTag("input#"+r+"_"+i+"_acString.e-filterval",{},{height:"26px",width:"100%"},{type:"text"}),o,s=n("#"+r+"_content");s.prepend(t.buildTag("div#"+r+"_"+i,"",{display:"none"}).append(t.buildTag("div.e-operdiv").append(u)).append(t.buildTag("div.e-textdiv").append(f)));u.ejDropDownList({dataSource:[{text:"Equal",value:"equal"},{text:"Not Equal",value:"notequal"},{text:"Less Than",value:"lessthan"},{text:"Less Than Or Equal",value:"lessthanorequal"},{text:"Greater Than",value:"greaterthan"},{text:"Greater Than Or Equal",value:"greaterthanorequal"},{text:"Between",value:"between"}],width:"100%",fields:{id:"value",text:"text",value:"value"},select:n.proxy(this._onNumFormatSelect,this),selectedItemIndex:0});switch(i){case"string":u.ejDropDownList("option",{dataSource:[{text:"Equal",value:"equal"},{text:"Not Equal",value:"notequal"},{text:"Starts With",value:"startswith"},{text:"Ends With",value:"endswith"},{text:"Contains",value:"contains"}],selectedItemIndex:0});f.ejAutocomplete({width:"100%",height:26,enableDistinct:!0,focusIn:function(){o=u.ejDropDownList("model.value")}});break;case"number":f.ejNumericTextbox({showSpinButton:!1,height:"26px",decimalPlaces:2,width:"100%"});break;case"boolean":$tchkBox.ejCheckBox({});break;case"date":f.ejDatePicker({width:"100%"})}},_createButton:function(n,i){var r=n=="filter"?t.proxy(this._fltrBtnHandler,this):t.proxy(this._fltrClrHandler,this);i.ejButton({size:"normal",type:"button",height:22,width:60,click:r,showRoundedCorner:!0})},_fltrBtnHandler:function(){var r=this.XLObj,e=r.getActiveSheetIndex(),i=r._id+"_filter_custom",u=n("#"+i+"_"+this._colType+"_ddinput").ejDropDownList("model.value"),f=n("#"+i+"_"+this._colType+"_acString").val();arg={action:"filtering",filterCollection:[{field:this._colName,matchcase:!0,operator:u,value:f,predicate:"or"}],fieldName:this._colName,ejpredicate:{field:this._colName,operator:u,value:f,isComplex:!1,ignoreCase:!1},tableID:this._tableId};r._excelFilter._predicates[e][this._colName]=t.Predicate(this._colName,u,f);this._filterHandler(arg);n("#"+i).ejDialog("close");n("#"+i+"_"+this._colType).hide()},_fltrClrHandler:function(){var i=this.XLObj,t=i._id+"_filter_custom",r=n("#"+t+"_"+this._colType+"_ddinput").ejDropDownList("model.value");this._clearFilterColumn(this._colName,"","","Or","","",this._tableId);n("#"+t).ejDialog("close");n("#"+t+"_"+this._colType).hide()},_openNormalFilterDlg:function(t,i,r,u){var e=this.XLObj,f=e._id+"_filter_custom";n("#"+f+"_"+i).show();n("#"+f).ejDialog("open");n("#"+f+"_"+i+"_ddinput").ejDropDownList("option",{selectedItemIndex:0});this._colName=t;this._colType=i;this._tableId=r;i==="string"&&n("#"+f+"_"+i+"_acString").ejAutocomplete("option",{fields:{key:this._colName,text:this._colName},dataSource:e.getSheet(e.getActiveSheetIndex()).filterSettings.tableRange[u].filteredRange})}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.ribbon=function(n){var i,t;this.XLObj=n;this._appTabCollection={};this._tabCollection=[];this._contextualTabCollection=[];this._smallBtnHeight=25;this._mediumBtnHeight=35;this._bigBtnHeight=75;this._splitBtnHeight=75;this._dropDownHeight=25;this._ribbonState=!0;this._isSetModel=!1;this._isDesignTab=!0;this._isDirtySelect=!1;this._isMergeSelect=!1;this._isFilterSelect={};this._hasTitle="";this._isNmgrid="";this._isPanelVisible=!1;this._ctrlCreated=!1;this._homeBtnIds=["Home_Clipboard_Paste","Home_Font_IncreaseFontSize","Home_Font_DecreaseFontSize","Home_Alignment_DecreaseIndent","Home_Alignment_IncreaseIndent","Home_Number_IncreaseDecimal","Home_Number_DecreaseDecimal","Home_Actions_Undo","Home_Actions_Redo","Home_Number_Accounting","Home_Number_CommaStyle","Home_Number_Percentage","Home_Clipboard_Cut","Home_Clipboard_Copy"];this._homeSptBtnIds=["Home_Clipboard_PasteOptions","Home_Font_Border","Home_Styles_ConditionalFormatting","Home_Styles_FormatAsTable","Home_Styles_CellStyles","Others_Editing_FindSelect","Home_Editing_Clear","Home_Alignment_Merge","Home_Editing_SortFilter","Home_Editing_AutoSum"];this._homeToggleBtnIds=["Home_Font_Bold","Home_Font_Italic","Home_Font_Underline","Home_Font_StrikeThrough","Home_Alignment_AlignLeft","Home_Alignment_AlignRight","Home_Alignment_AlignCenter","Home_Alignment_TopAlign","Home_Alignment_MiddleAlign","Home_Alignment_BottomAlign","Home_Alignment_WrapText","Home_Clipboard_FormatPainter"];this._homeDdIds=["Home_Number_NumberFormat","Home_Font_FontSize","Home_Font_FontFamily"];this._homeCpIds=["Home_Font_FillColor","Home_Font_FontColor"];this._insertBtnIds=["Insert_Tables_PivotTable","Insert_Tables_Table","Insert_Links_Hyperlink","Insert_Illustrations_Pictures"];this._insertSptBtnIds=["Insert_Charts_ColumnChart","Insert_Charts_BarChart","Insert_Charts_StockChart","Insert_Charts_LineChart","Insert_Charts_AreaChart","Insert_Charts_PieChart","Insert_Charts_ScatterChart"];this._dataBtnIds=["Data_SortFilter_SortAtoZ","Data_SortFilter_SortZtoA","Data_SortFilter_Filter","Data_SortFilter_ClearFilter","Data_DataTools_DataValidation"];this._dataSptBtnIds=["Data_DataTools_DataValidationOptions"];this._pageLayChckBxIds=["PageLayout_Show_Headings","PageLayout_Show_Gridlines"];this._pageLayBtnIds=["PageLayout_PageLayout_PageSize","PageLayout_Print_Print","PageLayout_Print_PrintSelected"];this._pageLaySptBtnIds=["PageLayout_PageLayout_PageSizeOptions"];this._reviewTglBtnIds=["Review_Changes_ProtectSheet","Review_Changes_ProtectWorkbook","Review_Changes_LockCell"];this._cmntBtnIds=["Review_Comments_NewComment","Review_Comments_DeleteComment","Review_Comments_PreviousComment","Review_Comments_NextComment","Review_Comments_ShowHideComment"];this._cmntTglBtnIds=["Review_Comments_ShowAllComments"];this._othersBtnIds=["Others_Cells_InsertCell","Others_Cells_DeleteCell","Others_Formulas_NameManager","Others_Formulas_DefineName","Others_CalCulation_CalculateNow","Others_CalCulation_CalculateSheet"];this._othersSptBtnIds=["Others_Cells_InsertCellOptions","Others_Cells_DeleteCellOptions","Others_Editing_FindSelect","Others_Window_FreezePanes","Others_CalCulation_CalculationOptions"];this._contextualBtnIds=["Design_Tools_ResizeTable","Design_Tools_ConvertToRange"];this._contextualInputIds=["Ribbon_Design_Properties_TableName"];this._contextualCheckBoxIds=["Design_TableStyleOptions_FirstColumn","Design_TableStyleOptions_LastColumn","Design_TableStyleOptions_TotalRow","Design_TableStyleOptions_FilterColumn"];this._protectStateBtnIds=["Home_Clipboard_Cut","Home_Clipboard_Copy","Others_Editing_FindSelect","Home_Clipboard_Paste","Home_Clipboard_PasteOptions","Home_Actions_Undo","Home_Actions_Redo","Review_Changes_ProtectSheet","Review_Changes_ProtectWorkbook","PageLayout_Print_Print","PageLayout_Print_PrintSelected","Others_Cells_InsertCellOptions","Others_Cells_DeleteCellOptions","Others_Cells_InsertCell","Others_Cells_DeleteCell"];this._chartDesignBtnIds=["ChartDesign_Data_SwitchRowColumn","ChartDesign_Data_SelectData","ChartDesign_Type_ChangeChartType"];this._chartDesignSptBtnIds=["ChartDesign_ChartLayouts_AddChartElement"];this._chartDesignDdIds=["ChartDesign_ChartThemes_ChartThemes"];this._formatBtnIds=["Format_Adjust_ChangePicture"];this._formatSptBtnIds=["Format_Adjust_ResetPicture","Format_Border_PictureBorder"];this._pasteMenuData=[{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:null},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:null}];this._fontFamily=[{value:"1",text:"Angsana New"},{value:"2",text:"Arial"},{value:"3",text:"Arial Black"},{value:"4",text:"Batang"},{value:"5",text:"Book Antiqua"},{value:"6",text:"Browallia New"},{value:"7",text:"Calibri"},{value:"8",text:"Cambria"},{value:"9",text:"Candara"},{value:"10",text:"Century"},{value:"11",text:"Comic Sans MS"},{value:"12",text:"Consolas"},{value:"13",text:"Constantia"},{value:"14",text:"Corbel"},{value:"15",text:"Cordia New"},{value:"16",text:"Courier"},{value:"17",text:"Courier New"},{value:"18",text:"DilleniaUPC"},{value:"19",text:"Dotum"},{value:"20",text:"FangSong"},{value:"21",text:"Garamond"},{value:"22",text:"Georgia"},{value:"23",text:"Gulim"},{value:"24",text:"GungSuh"},{value:"25",text:"KaiTi"},{value:"26",text:"JasmineUPC"},{value:"27",text:"Malgun Gothic"},{value:"28",text:"Mangal"},{value:"29",text:"Meiryo"},{value:"30",text:"Microsoft JhengHei"},{value:"31",text:"Microsoft YaHei"},{value:"32",text:"MingLiu"},{value:"33",text:"MingLiU_HKSCS"},{value:"34",text:"MS Gothic"},{value:"35",text:"MS Mincho"},{value:"36",text:"MS PGothic"},{value:"37",text:"MS PMincho"},{value:"38",text:"PMingliU"},{value:"39",text:"PMingLiU-ExtB"},{value:"40",text:"SimHei"},{value:"41",text:"SimSun"},{value:"42",text:"SimSun-ExtB"},{value:"43",text:"Tahoma"},{value:"44",text:"Times"},{value:"45",text:"Times New Roman"},{value:"46",text:"Trebuchet MS"},{value:"47",text:"Verdana"},{value:"48",text:"Yu Gothic"},{value:"49",text:"Yu Mincho"}];this._fontSize=[{value:"8pt",text:"8"},{value:"9pt",text:"9"},{value:"10pt",text:"10"},{value:"11pt",text:"11"},{value:"12pt",text:"12"},{value:"14pt",text:"14"},{value:"16pt",text:"16"},{value:"18pt",text:"18"},{value:"20pt",text:"20"},{value:"22pt",text:"22"},{value:"24pt",text:"24"},{value:"26pt",text:"26"},{value:"28pt",text:"28"},{value:"36pt",text:"36"},{value:"48pt",text:"48"},{value:"72pt",text:"72"}];this._mergeMenuData=[{id:"MergeAndCenter",text:n._getLocStr("MergeAndCenter"),parentId:null,sprite:"e-icon e-ss-mergecenter"},{id:"MergeAcross",text:n._getLocStr("MergeAcross"),parentId:null,sprite:"e-icon e-ss-mergeacross"},{id:"MergeCells",text:n._getLocStr("MergeCells"),parentId:null,sprite:"e-icon e-ss-merge"},{id:"UnmergeCells",text:n._getLocStr("UnmergeCells"),parentId:null,sprite:"e-icon e-ss-unmerge"}];this._sortFltrMenuData=[{id:"Ribbon_SortAtoZ",text:this.XLObj._getLocStr("SortAtoZ"),parentId:null,sprite:"e-icon e-ssdrop-sortatoz"},{id:"Ribbon_SortZtoA",text:this.XLObj._getLocStr("SortZtoA"),parentId:null,sprite:"e-icon e-ssdrop-sortztoa"},{id:"Ribbon_Filter",text:this.XLObj._getLocStr("Filter"),parentId:null,sprite:"e-icon e-ssdrop-filter"},{id:"Ribbon_ClearFilter",text:this.XLObj._getLocStr("ClearFilter"),parentId:null,sprite:"e-icon e-ssdrop-clearfilter"}];this._findMenuData=[{id:"Find",text:n._getLocStr("Find")+"...",parentId:null,sprite:"e-icon e-ss-find"},{id:"Replace",text:n._getLocStr("Replace")+"...",parentId:null,sprite:"e-icon e-ss-replace"},{id:"GoTo",text:n._getLocStr("GoTo")+"...",parentId:null,sprite:"e-icon e-ss-goto"},{id:"GoToSpecial",text:n._getLocStr("GoTo")+" "+n._getLocStr("Special")+"...",parentId:null},{id:"Formulas",text:n._getLocStr("Formulas"),parentId:null},{id:"Comments",text:n._getLocStr("Comments"),parentId:null},{id:"CFormat",text:n._getLocStr("ConditionalFormat"),parentId:null},{id:"Constants",text:n._getLocStr("Constants"),parentId:null},{id:"DataValidation",text:n._getLocStr("DataValidation"),parentId:null}];this._calcOptData=[{id:this.XLObj._id+"_CalcAuto",text:n._getLocStr("Automatic"),parentId:null,sprite:"e-icon e-ss-calcauto"},{id:this.XLObj._id+"_CalcManual",text:n._getLocStr("Manual"),parentId:null,sprite:"e-icon"}];this._valMenuData=[{id:"Validation",text:n._getLocStr("DataValidation")+"...",parentId:null,sprite:"e-icon e-ss-validation"},{id:"HighlightVal",text:n._getLocStr("HighlightVal"),parentId:null,sprite:"e-icon e-ss-hlval"},{id:"ClearHLVal",text:n._getLocStr("ClearFormats"),parentId:null,sprite:"e-icon e-ss-clearval"},{id:"ClearVal",text:n._getLocStr("ClearVal"),parentId:null,sprite:"e-icon e-ss-clearval"}];this._pageSizes=[{id:"A4",text:n._getLocStr("A4"),parentId:null,sprite:"e-icon e-ss-A4size"},{id:"A3",text:n._getLocStr("A3"),parentId:null,sprite:"e-icon e-ss-A3size"},{id:"Letter",text:n._getLocStr("Letter"),parentId:null,sprite:"e-icon e-ss-lettersize"}];this._viewMenuData=[{id:"freezePanes",text:n._getLocStr("FreezePanes"),parentId:null,sprite:"e-icon e-ss-frzpane"},{id:"FreezeTopRow",text:n._getLocStr("FreezeTopRow"),parentId:null,sprite:"e-icon e-ss-frzrow"},{id:"FreezeFirstColumn",text:n._getLocStr("FreezeFirstColumn"),parentId:null,sprite:"e-icon e-ss-frzcln"}];this._insertMenuData=[{id:"InsertCells",text:n._getLocStr("InsCells")+"...",parentId:null,sprite:"e-icon e-ssr-inscell"},{id:"InsertSheetRows",text:n._getLocStr("InsRows"),parentId:null,sprite:"e-icon e-ssr-insrow"},{id:"InsertSheetColumns",text:n._getLocStr("InsCols"),parentId:null,sprite:"e-icon e-ssr-inscol"},{id:"InsertSheet",text:n._getLocStr("InsSheet"),parentId:null,sprite:"e-icon e-ssr-inssheet"}];this._resetPicture=[{id:"resetpicture",text:n._getLocStr("ResetPicture"),parentId:null,sprite:"e-icon e-ss-resetpicture"},{id:"resetsize",text:n._getLocStr("ResetSize"),parentId:null,sprite:"e-icon e-ss-resetpicture"}];i=n._getLocStr("BorderStyles").split("/");this._borderMenuData=[{id:"bottom",text:n._getLocStr("BottomBorder"),parentId:null,sprite:"e-icon e-ss-bottom"},{id:"top",text:n._getLocStr("TopBorder"),parentId:null,sprite:"e-icon e-ss-top"},{id:"left",text:n._getLocStr("LeftBorder"),parentId:null,sprite:"e-icon e-ss-left"},{id:"right",text:n._getLocStr("RightBorder"),parentId:null,sprite:"e-icon e-ss-right"},{id:"noborder",text:n._getLocStr("NoBorder"),parentId:null,sprite:"e-icon e-ss-noborder"},{id:"allborder",text:n._getLocStr("AllBorder"),parentId:null,sprite:"e-icon e-ss-allborder"},{id:"outside",text:n._getLocStr("OutsideBorder"),parentId:null,sprite:"e-icon e-ss-outside"},{id:"thickbox",text:n._getLocStr("ThickBoxBorder"),parentId:null,sprite:"e-icon e-ss-thickbox"},{id:"thickbottom",text:n._getLocStr("ThickBottomBorder"),parentId:null,sprite:"e-icon e-ss-thickbottom"},{id:"topandbottom",text:n._getLocStr("TopandBottomBorder"),parentId:null,sprite:"e-icon e-ss-topandbottom"},{id:"topandthickbottom",text:n._getLocStr("TopandThickBottomBorder"),parentId:null,sprite:"e-icon e-ss-topandthickbottom"},{id:"drawborder",text:n._getLocStr("DrawBorder"),parentId:null,sprite:"e-icon e-ss-drawborder"},{id:"drawbordergrid",text:n._getLocStr("DrawBorderGrid"),parentId:null,sprite:"e-icon e-ss-drawbordergrid"},{id:n._id+"_bordercolor",text:n._getLocStr("BorderColor"),parentId:null},{id:n._id+"_Ribbon_borderstyle",text:n._getLocStr("BorderStyle"),parentId:null},{id:n._id+"_Ribbon_bordercolor",text:"",parentId:n._id+"_bordercolor"},{id:"solid",text:i[0],parentId:n._id+"_Ribbon_borderstyle"},{id:"dashed",text:i[1],parentId:n._id+"_Ribbon_borderstyle"},{id:"dotted",text:i[2],parentId:n._id+"_Ribbon_borderstyle"}];this._cFormatMenuData=[{id:n._id+"_HLCellRules",text:n._getLocStr("HighlightCellRules"),parentId:null,sprite:"e-icon e-ss-hlcellrules"},{id:"greaterthan",text:n._getLocStr("GreaterThan")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-greaterthan"},{id:"lessthan",text:n._getLocStr("LessThan")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-lessthan"},{id:"between",text:n._getLocStr("Between")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-between"},{id:"equalto",text:n._getLocStr("EqualTo")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-equalto"},{id:"textcontains",text:n._getLocStr("TextthatContains")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-textcontains"},{id:"dateoccur",text:n._getLocStr("DateOccurring")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-dateoccur"},{id:n._id+"_CreateRule",text:n._getLocStr("CreateRule"),parentId:null,sprite:"e-icon e-ss-createrule"},{id:n._id+"_ClearRules",text:n._getLocStr("ClearRules"),parentId:null,sprite:"e-icon e-ss-clearrules"},{id:"clearselected",text:n._getLocStr("ClearRulesfromSelected"),parentId:n._id+"_ClearRules"},{id:"clearall",text:n._getLocStr("ClearRulesfromEntireSheets"),parentId:n._id+"_ClearRules"}];this._textAlign=[{value:"1",text:"Left"},{value:"2",text:"Center"},{value:"3",text:"Right"}];this._verticalAlign=[{value:"1",text:"Top"},{value:"2",text:"Middle"},{value:"3",text:"Bottom"}];t=n._getLocStr("DataValidationAction").split("/");this._actions=[{value:"Greater",text:t[0]},{value:"GreaterOrEqual",text:t[1]},{value:"Less",text:t[2]},{value:"LessOrEqual",text:t[3]},{value:"Equal",text:t[4]},{value:"NotEqual",text:t[5]},{value:"Between",text:t[6]},{value:"NotBetween",text:t[7]}];t=n._getLocStr("DataValidationType").split("/");this._types=[{value:"number",text:t[0]},{value:"decimal",text:t[1]},{value:"date",text:t[2]},{value:"time",text:t[3]},{value:"text",text:t[4]},{value:"list",text:t[5]}];this._cFormatData={greaterthan:["GTTitle","GTContent"],lessthan:["LTTitle","LTContent"],between:["BWTitle","BWContent"],equalto:["EQTitle","EQContent"],textcontains:["ContainsTitle","ContainsContent"],dateoccur:["DateTitle","DateContent"]};this._styles=[{value:"redft",text:n._getLocStr("LightRedFillDark")},{value:"yellowft",text:n._getLocStr("YellowFillDark")},{value:"greenft",text:n._getLocStr("GreenFillDark")},{value:"redf",text:n._getLocStr("RedFill")},{value:"redt",text:n._getLocStr("RedText")}];this._currentCFormat="";this._addrList=[];this._within=[{value:"sheet",text:n._getLocStr("Sheet")},{value:"workbook",text:n._getLocStr("Workbook")}];this._sType=[{value:"columns",text:n._getLocStr("Columns")},{value:"rows",text:n._getLocStr("Rows")}];this._vType=[{value:"value",text:n._getLocStr("Value")},{value:"formula",text:n._getLocStr("Formula")},{value:"comment",text:n._getLocStr("Comments")}];this._direction=[{value:"down",text:n._getLocStr("Down")},{value:"up",text:n._getLocStr("Up")}];this._gotoRBtnSet1=["Comments","Blanks","LastCell","Formulas","Constants"];this._gotoRBtnSet2=["RowDiff","ColDiff","CFormat","DataValidation"];this._gotoChkBox=["GotoNumbers","GotoText","GotoLogicals","GotoError"];this._numberFormat=[{value:"1",text:"General"},{value:"2",text:"Number"},{value:"3",text:"Currency"},{value:"4",text:"Accounting"},{value:"5",text:"Percentage"},{value:"6",text:"Text"},{value:"7",text:"Shortdate"},{value:"8",text:"Longdate"},{value:"9",text:"Time"},{value:"10",text:"Scientific"},{value:"11",text:"Fraction"},{value:"12",text:"Custom"}];this._deleteMenuData=[{id:"DeleteCells",text:n._getLocStr("DelCells")+"...",parentId:null,sprite:"e-icon e-ssr-delcell"},{id:"DeleteSheetRows",text:n._getLocStr("DelRows"),parentId:null,sprite:"e-icon e-ssr-delrow"},{id:"DeleteSheetColumns",text:n._getLocStr("DelCols"),parentId:null,sprite:"e-icon e-ssr-delcol"},{id:"DeleteSheet",text:n._getLocStr("DelSheet"),parentId:null,sprite:"e-icon e-ssr-delsheet"}];this._clearMenuData=[{id:"Clear_All",text:n._getLocStr("ClearAll"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Clear_Formats",text:n._getLocStr("ClearFormats"),parentId:null,sprite:"e-icon e-ss-clearformat"},{id:"Clear_Contents",text:n._getLocStr("ClearContents"),parentId:null},{id:"Clear_Comments",text:n._getLocStr("ClearComments"),parentId:null},{id:"Clear_Hyperlinks",text:n._getLocStr("ClearHyperLinks"),parentId:null}];this._autosumMenuData=[{id:"Sum",text:n._getLocStr("Sum"),parentId:null,sprite:"e-icon e-ss-autosum"},{id:"Average",text:n._getLocStr("Average"),parentId:null},{id:"Count",text:n._getLocStr("CountNumber"),parentId:null},{id:"Max",text:n._getLocStr("Max"),parentId:null},{id:"Min",text:n._getLocStr("Min"),parentId:null}];this._chartThemes=[{value:"flatlight",text:"Flat Light"},{value:"flatdark",text:"Flat Dark"},{value:"azure",text:"Azure"},{value:"azuredark",text:"Azure Dark"},{value:"lime",text:"Lime"},{value:"limedark",text:"Lime Dark"},{value:"saffron",text:"Saffron"},{value:"saffrondark",text:"Saffron Dark"}];this._isCustomCellStyleReset=!1;this.allButtonIds=["Home_Clipboard_Paste","Home_Font_IncreaseFontSize","Home_Font_DecreaseFontSize","Home_Alignment_DecreaseIndent","Home_Alignment_IncreaseIndent","Home_Number_IncreaseDecimal","Home_Number_DecreaseDecimal","Home_Actions_Undo","Home_Actions_Redo","Home_Number_Accounting","Home_Number_CommaStyle","Home_Number_Percentage","Home_Clipboard_Cut","Home_Clipboard_Copy","Insert_Tables_PivotTable","Insert_Tables_Table","Insert_Links_Hyperlink","Insert_Illustrations_Pictures","Data_SortFilter_SortAtoZ","Data_SortFilter_SortZtoA","Data_SortFilter_Filter","Data_SortFilter_ClearFilter","Data_DataTools_DataValidation","PageLayout_PageLayout_PageSize","PageLayout_Print_Print","PageLayout_Print_PrintSelected","Review_Comments_NewComment","Review_Comments_DeleteComment","Review_Comments_PreviousComment","Review_Comments_NextComment","Review_Comments_ShowHideComment","Others_Cells_InsertCell","Others_Cells_DeleteCell","Others_Formulas_NameManager","Others_Formulas_DefineName","Others_CalCulation_CalculateNow","Others_CalCulation_CalculateSheet","Design_Tools_ResizeTable","Design_Tools_ConvertToRange","ChartDesign_Data_SwitchRowColumn","ChartDesign_Data_SelectData","ChartDesign_Type_ChangeChartType","Format_Adjust_ChangePicture"];this.allSplitButtonIds=["Home_Clipboard_PasteOptions","Home_Font_Border","Home_Styles_ConditionalFormatting","Home_Styles_FormatAsTable","Home_Styles_CellStyles","Others_Editing_FindSelect","Home_Editing_Clear","Home_Alignment_Merge","Home_Editing_SortFilter","Home_Editing_AutoSum","Insert_Charts_ColumnChart","Insert_Charts_BarChart","Insert_Charts_StockChart","Insert_Charts_LineChart","Insert_Charts_AreaChart","Insert_Charts_PieChart","Insert_Charts_ScatterChart","Data_DataTools_DataValidationOptions","PageLayout_PageLayout_PageSizeOptions","Others_Cells_InsertCellOptions","Others_Cells_DeleteCellOptions","Others_Editing_FindSelect","Others_Window_FreezePanes","Others_CalCulation_CalculationOptions","ChartDesign_ChartLayouts_AddChartElement","Format_Adjust_ResetPicture","Format_Border_PictureBorder"];this.allToggleButtonIds=["Home_Font_Bold","Home_Font_Italic","Home_Font_Underline","Home_Font_StrikeThrough","Home_Alignment_AlignLeft","Home_Alignment_AlignRight","Home_Alignment_AlignCenter","Home_Alignment_TopAlign","Home_Alignment_MiddleAlign","Home_Alignment_BottomAlign","Home_Alignment_WrapText","Home_Clipboard_FormatPainter","Review_Comments_ShowAllComments","Review_Changes_ProtectSheet","Review_Changes_ProtectWorkbook","Review_Changes_LockCell"];this.allDropDownIds=["ChartDesign_ChartThemes_ChartThemes","Home_Number_NumberFormat","Home_Font_FontSize","Home_Font_FontFamily"];this.colorPickerIds=["Home_Font_FillColor","Home_Font_FontColor"];this.checkBoxIds=["PageLayout_Show_Headings","PageLayout_Show_Gridlines","Design_TableStyleOptions_FirstColumn","Design_TableStyleOptions_LastColumn","Design_TableStyleOptions_TotalRow","Design_TableStyleOptions_FilterColumn"];this.InputIds=["Ribbon_Design_Properties_TableName"];this._fileMenuData=[{id:"File",text:n._getLocStr("File"),parentId:null},{id:"New",text:n._getLocStr("New"),parentId:"File",sprite:"e-icon e-ss-newsheet"},{id:"Open",text:n._getLocStr("Open")+"...",parentId:"File",sprite:"e-icon e-ss-open"},{id:"Save",text:n._getLocStr("SaveAs"),parentId:"File",sprite:"e-icon e-ss-saveas"},{id:"Print",text:n._getLocStr("Print"),parentId:"File",sprite:"e-icon e-ssm-print"},{id:"ExportXL",text:n._getLocStr("ExportXL"),parentId:"Save",sprite:"e-icon e-ssm-exportxl"},{id:"ExportCsv",text:n._getLocStr("ExportCsv"),parentId:"Save",sprite:"e-icon e-ssm-exportcsv"},{id:"ExportPdf",text:n._getLocStr("ExportPdf"),parentId:"Save",sprite:"e-icon e-ssm-exportpdf"},{id:"PrintSheet",text:n._getLocStr("PrintSheet"),parentId:"Print",sprite:"e-icon e-ssm-print"},{id:"PrintSelected",text:n._getLocStr("PrintSelected"),parentId:"Print",sprite:"e-icon e-ssm-printselected"}];this._isAppTabCreate=!1;this._isHomeTabCreate=!1;this._isInsertTabCreate=!1;this._isDataTabCreate=!1;this._isPageLayoutTabCreate=!1;this._isReviewTabCreate=!1;this._isOthersTabCreate=!1;this._isDesignTabCreate=!1;this._isFormatTabCreate=!1;this._isChartTabCreate=!1;this._analyzeTabCreate=!1;this._isHomeTabTrgt=!1;this._isInsertTabTrgt=!1;this._isDataTabTrgt=!1;this._isPageLayoutTrgtTab=!1;this._isReviewTabTrgt=!1;this._isOthersTabTrgt=!1;this._isDesignTabTrgt=!1;this._isFormatTabTrgt=!1;this._isChartTabTrgt=!1;this._analyzeTabTrgt=!1};t.spreadsheetFeatures.ribbon.prototype={_renderChartTypeDialog:function(){var i,u,f,e,o,s,h,c,l,a,n=this.XLObj,r=n._id+"_charttypedlg";return i=t.buildTag("div#"+r+".e-chartdialog","",{},{overflow:"hidden"}),u=t.buildTag("div#"+r+"_allcharttab.e-chtdlgtab"),l=t.buildTag("div.e-dlg-fields e-dlgctndiv"),s=t.buildTag("ul .e-ul","",""),c=t.buildTag("a",n._getLocStr("AllCharts"),{},{href:"#"+n._id+"_allchart"}),h=t.buildTag("li",c),i.append(l.append(u.append(s.append(h)))),o=t.buildTag("div#"+r+"_btndiv.e-dlg-btnfields"),a=t.buildTag("div.e-dlg-btnctnr"),f=t.buildTag("input#"+r+"_okbtn","",{},{type:"button"}),e=t.buildTag("input#"+r+"_cantn","",{},{type:"button"}),f.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._chartTypeOk,this),enabled:!0,cssClass:"e-ss-okbtn"}),e.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._chartTypeCancel,this),showRoundedCorner:!0,width:60}),o.append(a.append(f,e)),i.append(o),n.element.append(i),u.ejTab({cssClass:"e-ss-dlgtab",width:"100%",height:"auto"}),this._renderAllChartTab(),i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("ChartType"),width:"auto",height:"auto",cssClass:"e-ss-dialog e-charttype-dlg e-ss-mattab e-"+n._id+"-dlg",close:t.proxy(this._dialogClose,this)}),i},_renderAllChartTab:function(){var u,e,b,h,a,i,v,k,d,y,g=[],p="",nt="",f=this.XLObj,r=f._id,w=r+"_chartdlg_allcharttab",c=["Column-6","Bar-6","Radar-2","Line-2","Area-3","Pie-3","Scatter-1"],l,o,s;for(d=t.buildTag("div#"+w+"_content.e-ss-leftdiv",""),a=t.buildTag("div#"+w+"_content.e-chtdlgcontent e-ss-rightdiv","",{overflow:"auto",float:"right"}),y=t.buildTag("ul #"+w+"_list .e-ul"),o=0,s=c.length;o<s;o++)i=c[o].split("-")[0],nt+="<li><span class='e-icon e-ss-dlg"+i.toLowerCase()+"chart'><\/span>"+f._getLocStr(i)+"<\/li>",g.push(i);for(y.append(n(nt)),l=t.buildTag("div#"+r+"_allchart_table.e-ss-maindiv","",{cellspacing:"0",cellpadding:"0",display:"inline-flex",width:"100%"}),n("#"+r+"_allchart").append(l),l.append(d.append(y)),this._createChartList(g),l.append(a),e=0,s=c.length;e<s;e++){for(h=c[e].split("-"),k=f._getLocStr("Title"+h[0]+"Chart").split("/"),i=h[0].toLowerCase(),v=t.buildTag("div#"+r+"_"+i+"chart"),u=1,b=parseInt(h[1]);u<=b;u++)p+="<div class='e-chartimg e-dlg"+i+"chart"+u+"' title='"+k[u-1]+"'><\/div>";a.append(v.append(p));n("#"+r+"_"+i+"chart").find(".e-dlg"+i+"chart1").addClass("e-chartselect");v.hide();p=""}f._on(n("#"+r+"_allchart").find(".e-chartimg"),"click",f._allChartType);n("#"+r+"_columnchart").show()},_createChartList:function(i){var r=this.XLObj,f=r._id+"_chartdlg_allcharttab",s=n("#"+r._id+"_allchart").height(),u,e=n("#"+f+"_list"),o=t.buildTag("div.e-ss-drpdiv");u=t.buildTag("input#"+f+"_input");n("#"+r._id+"_allchart").prepend(o.append(u));u.ejDropDownList({dataSource:i,width:"100%",fields:{id:"value",text:"text",value:"text"},select:n.proxy(this._onChartChange,this),selectedItemIndex:0});e.ejListBox({selectedItemIndex:0,width:"120",height:"250",fields:{text:"text",value:"value"},select:n.proxy(this._onChartChange,this),allowMultiSelection:!1})},_onChartChange:function(t){for(var r=this.XLObj,u=t.value?t.value.toLowerCase():t.text.toLowerCase(),f=["column","bar","radar","line","area","pie","scatter"],i=0;i<f.length;i++)n("#"+r._id+"_"+f[i]+"chart").hide();n("#"+r._id+"_"+u+"chart").show();n("#"+r._id+"_allchart").find(".e-chartimg").removeClass("e-chartselect");n("#"+r._id+"_"+u+"chart").find(".e-dlg"+u+"chart1").addClass("e-chartselect")},_initValDialog:function(){var i,r,u,f,e,o,s,h,n=this.XLObj,c,l;i=t.buildTag("div#"+n._id+"_ValDialog");r=t.buildTag("div#"+n._id+"_ValDialog_valDlgTab");c=t.buildTag("div.e-dlg-fields e-dlgctndiv");o=t.buildTag("ul .e-ul");h=t.buildTag("a",n._getLocStr("Settings"),{},{href:"#"+n._id+"_Validation"});s=t.buildTag("li",h);o.append(s);r.append(o);i.append(c.append(r));e=t.buildTag("div#"+n._id+"btnDiv.e-dlg-btnfields");l=t.buildTag("div.e-dlg-btnctnr");u=t.buildTag("input#"+n._id+"Dialog_OkBtn","",{},{type:"button"});f=t.buildTag("input#"+n._id+"Dialog_CancelBtn","",{},{type:"button"});u.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._valDlgBtnClick,this,"ok"),enabled:!0,cssClass:"e-ss-okbtn"});f.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._valDlgBtnClick,this,"cancel"),showRoundedCorner:!0,width:60});e.append(l.append(u,f));n.element.append(i.append(e));r.ejTab({width:"100%",height:"auto",cssClass:"e-ss-dlgtab"});this._renderValDialog();i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("DataValidation"),width:"auto",height:"auto",cssClass:"e-ss-dialog e-ss-valdlg e-ss-mattab e-"+n._id+"-dlg",close:t.proxy(this._dialogClose,this)});this._dialogValidate("_ValDialog")},_initCFDialog:function(){var n=this.XLObj,i,e,r,u,f,o;return i=t.buildTag("div#"+n._id+"_CFDialog"),n.element.append(i),e=t.buildTag("div#"+n._id+"_CondFormat.e-dlgctndiv"),i.append(e),f=t.buildTag("div#"+n._id+"cfBtnDiv.e-dlg-btnfields"),o=t.buildTag("div.e-dlg-btnctnr"),r=t.buildTag("input#"+n._id+"cfDialog_OkBtn","",{},{type:"button"}),u=t.buildTag("input#"+n._id+"cfDialog_CancelBtn","",{},{type:"button"}),r.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._dlgCFOk,this),enabled:!0,cssClass:"e-ss-okbtn"}),u.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._dlgCFCancel,this),showRoundedCorner:!0,width:"25%"}),f.append(o.append(r,u)),i.append(f),i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("ConditionalFormat"),width:"auto",cssClass:"e-ss-dialog e-ss-cfdlg e-"+n._id+"-dlg",close:t.proxy(this._dialogClose,this)}),i},_initHLDialog:function(){var i=this.XLObj,r,u,f,e,o,s,h,c,l,a;r=t.buildTag("div#"+i._id+"_HLDialog");u=t.buildTag("div#"+i._id+"_HLDialogTab");l=t.buildTag("div.e-dlg-fields e-dlgctndiv");f=t.buildTag("ul .e-ul");o=t.buildTag("a",i._getLocStr("WebPage"),{},{href:"#"+i._id+"_Web"});e=t.buildTag("li",o);f.append(e);o=t.buildTag("a",i._getLocStr("WorkSheet"),{},{href:"#"+i._id+"_Doc"});e=t.buildTag("li",o);f.append(e);u.append(f);r.append(l.append(u));s=t.buildTag("div#"+i._id+"hlBtnDiv.e-dlg-btnfields");a=t.buildTag("div.e-dlg-btnctnr");h=t.buildTag("input#"+i._id+"hlDialog_OkBtn","",{},{type:"button"});c=t.buildTag("input#"+i._id+"hlDialog_CancelBtn","",{},{type:"button"});h.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgHLOk,this),enabled:!0,cssClass:"e-ss-okbtn"});c.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._dlgHLCancel,this),showRoundedCorner:!0,width:60});s.append(a.append(h,c));r.append(s);r.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("InsertHyperLink"),width:"auto",cssClass:"e-ss-dialog e-ss-hyperlinkdlg e-ss-mattab e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_Ribbon_webAddress"),r=n("#"+i._id+"_Ribbon_cellAddress");t.focus().setInputPos(t.val().length);r.focus().setInputPos(r.val().length)})});u.ejTab({width:"100%",itemActive:t.proxy(this._hlTabChange,this),cssClass:"e-ss-dlgtab"});this._renderHLDialog()},_initFRDialog:function(){var i=this.XLObj,e,o,s,h,c,l,y,f,r,p,u,a,v;e=t.buildTag("div#"+i._id+"_FRDialog");o=t.buildTag("div#"+i._id+"_FRDialog_FPDlgTab");p=t.buildTag("div.e-dlg-fields e-dlgctndiv");f=t.buildTag("ul .e-ul");u=t.buildTag("a",i._getLocStr("Find"),{},{href:"#"+i._id+"_Find"});r=t.buildTag("li",u);f.append(r);u=t.buildTag("a",i._getLocStr("Replace"),{},{href:"#"+i._id+"_Replace"});r=t.buildTag("li",u);f.append(r);u=t.buildTag("a",i._getLocStr("Settings"),{},{href:"#"+i._id+"_Settings"});r=t.buildTag("li",u);f.append(r);o.append(f);e.append(p.append(o));l=t.buildTag("div#"+i._id+"btnFRDiv.e-dlg-btnfields");y=t.buildTag("div.e-dlg-btnctnr");a=t.buildTag("input#"+i._id+"FR_ReplaceBtn","",{"margin-left":0},{type:"button"});v=t.buildTag("input#"+i._id+"FR_ReplaceAllBtn","",{},{type:"button"});s=t.buildTag("input#"+i._id+"FR_NextBtn","",{},{type:"button"});h=t.buildTag("input#"+i._id+"FR_PrevBtn","",{},{type:"button"});c=t.buildTag("input#"+i._id+"FR_CloseBtn","",{},{type:"button"});a.ejButton({text:i._getLocStr("Replace"),showRoundedCorner:!0,width:55,click:t.proxy(this._btnFROnClick,this,"FR_ReplaceBtn"),enabled:!0}).css("visibility","hidden");v.ejButton({text:i._getLocStr("ReplaceAll"),showRoundedCorner:!0,click:t.proxy(this._btnFROnClick,this,"FR_ReplaceAllBtn"),enabled:!0}).css("visibility","hidden");s.ejButton({text:i._getLocStr("FindNext"),showRoundedCorner:!0,width:69,click:t.proxy(this._btnFROnClick,this,"FR_NextBtn"),enabled:!0});h.ejButton({text:i._getLocStr("FindPrev"),showRoundedCorner:!0,width:69,click:t.proxy(this._btnFROnClick,this,"FR_PrevBtn"),enabled:!0});c.ejButton({text:i._getLocStr("Close"),click:t.proxy(this._btnFROnClick,this,"FR_CloseBtn"),showRoundedCorner:!0,width:47});l.append(y.append(a,v,s,h,c));e.append(l);e.ejDialog({showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("FindnReplace"),width:"auto",height:"auto",cssClass:"e-ss-dialog e-ss-mattab e-ss-frdlg e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){i._phoneMode?(n("#"+i._id+"FR_ReplaceBtn").hide(),n("#"+i._id+"FR_ReplaceAllBtn").hide()):(n("#"+i._id+"FR_ReplaceBtn").show(),n("#"+i._id+"FR_ReplaceAllBtn").show());var t=n("#"+i._id+"_Ribbon_textFind");t.focus().setInputPos(t.val().length)})});o.ejTab({width:"100%",itemActive:t.proxy(this._findTabChange,this),cssClass:"e-ss-dlgtab"})},_initGoToDialog:function(){var n=this.XLObj,i,e,c,r,u,f,o,s,l,h;i=t.buildTag("div#"+n._id+"_GoDialog");e=t.buildTag("div#"+n._id+"_GoToDlgTab");l=t.buildTag("div.e-dlg-fields e-dlgctndiv");r=t.buildTag("ul .e-ul");f=t.buildTag("a",n._getLocStr("GoTo"),{},{href:"#"+n._id+"_GoTo"});u=t.buildTag("li",f);r.append(u);f=t.buildTag("a",n._getLocStr("GoTo")+" "+n._getLocStr("Special"),{},{href:"#"+n._id+"_GoToSp"});u=t.buildTag("li",f);r.append(u);e.append(r);i.append(l.append(e));c=t.buildTag("div#"+n._id+"btnDiv.e-dlg-btnfields");h=t.buildTag("div.e-dlg-btnctnr");i.append(c.append(h));o=t.buildTag("input#"+n._id+"Dialog_GoOkBtn","",{},{type:"button"});s=t.buildTag("input#"+n._id+"Dialog_GoCancelBtn","",{},{type:"button"});o.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:"23%",click:t.proxy(this._gotoBtnClick,this,"ok"),cssClass:"e-ss-okbtn"});s.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._gotoBtnClick,this,"cancel"),showRoundedCorner:!0,width:60});h.append(o,s);n.element.append(i)},_initPvtDialog:function(){var n=this.XLObj,i,r,u,f,e;i=t.buildTag("div#"+n._id+"_PvtDialog");n.element.append(i);i.append(t.buildTag("div#"+n._id+"_Pivot.e-dlgctndiv"));f=t.buildTag("div#"+n._id+"pvtBtnDiv.e-dlg-btnfields");e=t.buildTag("div.e-dlg-btnctnr");r=t.buildTag("input#"+n._id+"PvtDialog_OkBtn");u=t.buildTag("input#"+n._id+"PvtDialog_CancelBtn");r.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._dlgPvtOk,this),enabled:!0,cssClass:"e-ss-okbtn"});u.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._dlgPvtCancel,this),showRoundedCorner:!0,width:"25%"});f.append(e.append(r,u));i.append(f);i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("CreatePivotTable"),width:"auto",cssClass:"e-ss-dialog e-"+n._id+"-dlg e-ss-pvtdlg",close:t.proxy(this._dialogClose,this)})},_dialogClose:function(){this.XLObj.setSheetFocus()},_beforeDlgClose:function(t){var i=n("#"+this.XLObj._id+"_nmgrid_dialogEdit_overLay");i.length&&(t.cancel=!0)},_homeTabObj:function(){var n,f=this.XLObj,u="imagetop",r={id:"home",text:f._getLocStr("HOME"),groups:[]},i=f._id,e=f.model;n={text:"Clipboard",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Home_Clipboard_Paste","paste","textandimage","e-icon e-ssr-paste",45,this._mediumBtnHeight,"PasteTitle","PasteContent",!1,u),this._generateSplitBtn("Home_Clipboard_PasteOptions","Paste","textandimage",i+"_Ribbon_Paste",{dataSource:this._pasteMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,45,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-pastesbtn","PasteTitle","PasteSplitContent")]},{groups:[this._generateBtn("Home_Clipboard_Cut","Cut","textandimage","e-icon e-ssr-cut",58,this._smallBtnHeight,"CutTitle","CutContent"),this._generateBtn("Home_Clipboard_Copy","Copy","textandimage","e-icon e-ssr-copy",67,this._smallBtnHeight,"CopyTitle","CopyContent"),this._generateToggleBtn("Home_Clipboard_FormatPainter","FormatPainter","textandimage","e-icon e-ss-formatpainter","FPTitle",110,this._smallBtnHeight,"FPContent")]}]};r.groups.push(n);n={text:"Font",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateDD("Home_Font_FontFamily","FontFamily",this._fontFamily,"7",150,this._smallBtnHeight,"FontFamily","FFContent"),this._generateDD("Home_Font_FontSize","FontSize",this._fontSize,"11pt",65,this._smallBtnHeight,"FontSize","FSContent"),this._generateBtn("Home_Font_IncreaseFontSize","IncreaseFontSize","imageonly","e-icon e-ss-increasefontsize","",this._smallBtnHeight,"IncreaseFontSize","IFSContent"),this._generateBtn("Home_Font_DecreaseFontSize","DecreaseFontSize","imageonly","e-icon e-ss-decreasefontsize","",this._smallBtnHeight,"DecreaseFontSize","DFSContent")]},{groups:[this._generateToggleBtn("Home_Font_Bold","Bold","imageonly","e-icon e-ss-bold","BoldTitle","",this._smallBtnHeight,"BoldContent"),this._generateToggleBtn("Home_Font_Italic","Italic","imageonly","e-icon e-ss-italic","ItalicTitle","",this._smallBtnHeight,"ItalicContent"),this._generateToggleBtn("Home_Font_Underline","Underline","imageonly","e-icon e-ss-underline","ULineTitle","",this._smallBtnHeight,"ULineContent"),this._generateToggleBtn("Home_Font_StrikeThrough","Linethrough","imageonly","e-icon e-ss-linethrough","LineTrTitle",25,this._smallBtnHeight,"LineTrContent",!0),this._generateSplitBtn("Home_Font_Border","Border","imageonly",i+"_Ribbon_Border",{dataSource:this._borderMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-bottom",!0,37,this._smallBtnHeight,"","","","e-borderbtn","Border","BorderContent"),this._generateCustomControl(i+"_Ribbon_Home_Font_FillColor","BackgroundColor","BackgroundColor","BGContent"),this._generateCustomControl(i+"_Ribbon_Home_Font_FontColor","FontColor","Color","ColorContent")]}]};r.groups.push(n);n={text:"Alignment",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateToggleBtn("Home_Alignment_TopAlign","TopAlign","imageonly","e-icon e-ss-topalign","TopAlign","","","TopAlignContent"),this._generateToggleBtn("Home_Alignment_MiddleAlign","MiddleAlign","imageonly","e-icon e-ss-middlealign","MiddleAlign","","","MiddleAlignContent"),this._generateToggleBtn("Home_Alignment_BottomAlign","BottomAlign","imageonly","e-icon e-ss-bottomalign","BottomAlign","","","BottomAlignContent",!0),this._generateToggleBtn("Home_Alignment_WrapText","WrapText","textandimage","e-icon e-ss-wraptext","WrapText",85,25,"WrapTextContent")]},{groups:[this._generateToggleBtn("Home_Alignment_AlignLeft","AlignLeft","imageonly","e-icon e-ss-alignleft","AlignLeft","","","AlignLeftContent"),this._generateToggleBtn("Home_Alignment_AlignCenter","AlignCenter","imageonly","e-icon e-ss-aligncenter","AlignCenter","","","AlignCenterContent"),this._generateToggleBtn("Home_Alignment_AlignRight","AlignRight","imageonly","e-icon e-ss-alignright","AlignRight","","","AlignRightContent",!0),this._generateSplitBtn("Home_Alignment_Merge","MergeAndCenter","textandimage",i+"_Ribbon_Merge",{dataSource:this._mergeMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-merge",!1,136,25,"right","","","e-spreadsheet e-mergebtn","MergeAndCenter","MergeAndCenterContent")]},{groups:[this._generateBtn("Home_Alignment_DecreaseIndent","DecreaseIndent","imageonly","e-icon e-ss-decreaseindent","",this._smallBtnHeight,"DecreaseIndent","DecreaseIndentContent"),this._generateBtn("Home_Alignment_IncreaseIndent","IncreaseIndent","imageonly","e-icon e-ss-increaseindent","",this._smallBtnHeight,"IncreaseIndent","IncreaseIndentContent")]}]};r.groups.push(n);n={text:"Actions",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("Home_Actions_Undo","Undo","textandimage","e-icon e-ss-undo",40,this._bigBtnHeight,"UndoTitle","UndoContent",!1,u,""),this._generateBtn("Home_Actions_Redo","Redo","textandimage","e-icon e-ss-redo",40,this._bigBtnHeight,"RedoTitle","RedoContent",!1,u,"")]}]};r.groups.push(n);n={text:"Number",alignType:t.Ribbon.alignType.rows,enableGroupExpander:!0,content:[{groups:[this._generateDD("Home_Number_NumberFormat","NumberFormat",this._numberFormat,"1",125,this._smallBtnHeight,"NumberFormat","NumberFormatContent")]},{groups:[this._generateBtn("Home_Number_Accounting","AccountingStyle","imageonly","e-icon e-ss-accounting","",this._smallBtnHeight,"AccountingStyle","AccountingStyleContent"),this._generateBtn("Home_Number_Percentage","PercentageStyle","imageonly","e-icon e-ss-percentage","",this._smallBtnHeight,"PercentageStyle","PercentageStyleContent"),this._generateBtn("Home_Number_CommaStyle","CommaStyle","imageonly","e-icon e-ss-comma","",this._smallBtnHeight,"CommaStyle","CommaStyleContent",!0),this._generateBtn("Home_Number_IncreaseDecimal","IncreaseDecimal","imageonly","e-icon e-ss-increasedecimal","",this._smallBtnHeight,"IncreaseDecimal","IncreaseDecimalContent"),this._generateBtn("Home_Number_DecreaseDecimal","DecreaseDecimal","imageonly","e-icon e-ss-decreasedecimal","",this._smallBtnHeight,"DecreaseDecimal","DecreaseDecimalContent")]}]};r.groups.push(n);n={text:"Styles",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("Home_Styles_ConditionalFormatting","ConditionalFormat","textandimage",i+"_CFormat",{dataSource:this._cFormatMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-condformat",!1,75,this._splitBtnHeight,"bottom",u,"dropdown","e-spreadsheet e-cformatbtn","ConditionalFormat","CFContent"),this._generateSplitBtn("Home_Styles_FormatAsTable","FormatasTable","textandimage",i+"_formatastable","","e-icon e-ssr-formatastable",!1,65,this._splitBtnHeight,"bottom",t.ImagePosition.ImageTop,"dropdown","e-spreadsheet e-formatastablebtn","FormatAsTable","FATContent"),this._generateSplitBtn("Home_Styles_CellStyles","CellStyles","textandimage",i+"_cellstyles","","e-icon e-ssr-cellstyles",!1,55,this._splitBtnHeight,"bottom",t.ImagePosition.ImageTop,"dropdown","e-spreadsheet e-cellstylebtn","CellStyles","CellStylesContent")]}]};r.groups.push(n);n={text:"Editing",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("Home_Editing_SortFilter","SortFilter","textandimage",i+"_Ribbon_SortFilter",{dataSource:this._sortFltrMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-sortfilter",!1,50,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-sortfltrbtn","SortFilter","SortFilterContent")]},{groups:[this._generateSplitBtn("Home_Editing_AutoSum","AutoSum","textandimage",i+"_Ribbon_AutoSum",{dataSource:this._autosumMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-autosum",!1,100,25,"right","","","e-spreadsheet e-autosumbtn","AutoSumTitle","AutoSumContent"),this._generateSplitBtn("Home_Editing_Clear","Clear","textandimage",i+"_Ribbon_Clear",{dataSource:this._clearMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-clear",!1,80,25,"right","","dropdown","e-spreadsheet e-clearbtn","Clear","ClearContent")]}]};r.groups.push(n);this._tabCollection.push(r)},_insertTabObj:function(){var n,f=this.XLObj,u="imagetop",r={id:"insert",text:f._getLocStr("INSERT"),groups:[]},i=f._id;n={text:"Tables",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("Insert_Tables_PivotTable","PivotTable","textandimage","e-icon e-ssr-pivottable",65,this._bigBtnHeight,"PivotTable","PivotTableContent",!1,u),this._generateBtn("Insert_Tables_Table","Table","textandimage","e-icon e-ssr-table",50,this._bigBtnHeight,"Table","TableContent",!1,u)]}]};r.groups.push(n);n={text:"Illustrations",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("Insert_Illustrations_Pictures","Pictures","textandimage","e-icon e-ssr-pictures",50,this._bigBtnHeight,"PicturesTitle","PicturesContent",!1,u,"")]}]};r.groups.push(n);n={text:"Links",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("Insert_Links_Hyperlink","HyperLink","textandimage","e-icon e-ssr-hyperlink",60,this._bigBtnHeight,"HyperLinkTitle",["HyperLinkContent","HyperLinkPlaceContent"],!1,u,"")]}]};r.groups.push(n);n={text:"Charts",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("Insert_Charts_ColumnChart","ColumnChart","imageonly",i+"_Ribbon_ColumnChart","","e-icon e-ss-colchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","ColumnChartTitle","ColumnChartContent"),this._generateSplitBtn("Insert_Charts_BarChart","BarChart","imageonly",i+"_Ribbon_BarChart","","e-icon e-ss-barchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","BarChartTitle","BarChartContent"),this._generateSplitBtn("Insert_Charts_StockChart","StockChart","imageonly",i+"_Ribbon_StockChart","","e-icon e-ss-stockchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","StockChartTitle","StockChartContent")]},{groups:[this._generateSplitBtn("Insert_Charts_LineChart","LineChart","imageonly",i+"_Ribbon_LineChart","","e-icon e-ss-linechart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","LineChartTitle","LineChartContent"),this._generateSplitBtn("Insert_Charts_AreaChart","AreaChart","imageonly",i+"_Ribbon_AreaChart","","e-icon e-ss-areachart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","AreaChartTitle","AreaChartContent"),this._generateSplitBtn("Insert_Charts_PieChart","PieChart","imageonly",i+"_Ribbon_PieChart","","e-icon e-ss-piechart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","PieChartTitle","PieChartContent")]},{groups:[this._generateSplitBtn("Insert_Charts_ScatterChart","ScatterChart","imageonly",i+"_Ribbon_ScatterChart","","e-icon e-ss-scterchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","ScatterChartTitle","ScatterChartContent")]}]};r.groups.push(n);this._tabCollection.push(r)},_dataTabObj:function(){var n,r=this.XLObj,i={id:"data",text:r._getLocStr("DATATAB"),groups:[]};n={text:"Sort & Filter",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Data_SortFilter_SortAtoZ","SortAtoZ","textandimage","e-icon e-ssr-sortatoz",90,this._smallBtnHeight,"SortAtoZ","SortAtoZContent",!1,"","e-datapadding"),this._generateBtn("Data_SortFilter_SortZtoA","SortZtoA","textandimage","e-icon e-ssr-sortztoa",90,this._smallBtnHeight,"SortZtoA","SortZtoAContent",!1,"","e-datapadding")]},{groups:[this._generateBtn("Data_SortFilter_Filter","Filter","textandimage","e-icon e-ssr-filter",60,this._smallBtnHeight,"Filter","FilterContent",!1,"","e-datapadding"),this._generateBtn("Data_SortFilter_ClearFilter","ClearFilter","textandimage","e-icon e-ss-clearfilter",90,this._smallBtnHeight,"ClearFilter","ClearFilterContent",!1,"","e-datapadding")]}]};i.groups.push(n);n={text:"Data Tools",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Data_DataTools_DataValidation","Validation","imageonly","e-icon e-ssr-validation",70,39,"DataValidation","DVContent",!1,"imagetop"),this._generateSplitBtn("Data_DataTools_DataValidationOptions","DataValidation","textandimage",r._id+"_Ribbon_Validation",{dataSource:this._valMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,70,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-validationsbtn","DataValidation","DVContent")]}]};i.groups.push(n);this._tabCollection.push(i)},_pageTabObj:function(){var n,r=this.XLObj,u="imagetop",i={id:"pagelayout",text:r._getLocStr("PAGELAYOUT"),groups:[]};n={text:"Show",alignType:t.Ribbon.alignType.rows,width:105,content:[{groups:[{contentID:r._id+"_Ribbon_pagesetupleft",type:t.Ribbon.type.custom,height:80},]}]};i.groups.push(n);n={text:"Page Layout",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("PageLayout_PageLayout_PageSize","size","imageonly","e-icon e-ssr-pagesize",65,44,"size","PageSizeContent",!1,u,""),this._generateSplitBtn("PageLayout_PageLayout_PageSizeOptions","PageSize","textandimage",r._id+"_Ribbon_PageSize",{dataSource:this._pageSizes,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,65,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-pagesizesbtn","PageSize","PageSizeContent")]}]};i.groups.push(n);n={text:"Print",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("PageLayout_Print_Print","Print","textandimage","e-icon e-ssr-print",50,this._bigBtnHeight,"Print","PrintContent",!1,u,"")]},{groups:[this._generateBtn("PageLayout_Print_PrintSelected","PrintSelected","textandimage","e-icon e-ssr-printselected",55,this._bigBtnHeight,"PrintSelected","PrintSelectedContent",!0,u,"")]}]};i.groups.push(n);this._tabCollection.push(i)},_reviewTabObj:function(){var n,u=this.XLObj,i="imagetop",r={id:"review",text:u._getLocStr("REVIEW"),groups:[]};n={text:"Comments",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Review_Comments_NewComment","New","textandimage","e-icon e-ssr-newcmnt",49,this._bigBtnHeight,"NewCommentTitle","NewCommentContent",!1,i)]},{groups:[this._generateBtn("Review_Comments_DeleteComment","Delete","textandimage","e-icon e-ssr-deletecmnt",49,this._bigBtnHeight,"DeleteComment","DeleteCommentContent",!1,i)]},{groups:[this._generateBtn("Review_Comments_PreviousComment","Previous","textandimage","e-icon e-ssr-previouscmnt",49,this._bigBtnHeight,"Previous","PreviousContent",!1,i)]},{groups:[this._generateBtn("Review_Comments_NextComment","Next","textandimage","e-icon e-ssr-nextcmnt",49,this._bigBtnHeight,"Next","NextContent",!1,i)]},{groups:[this._generateBtn("Review_Comments_ShowHideComment","ShowHide","textandimage","e-icon e-ssr-showhidecmnt",160,this._smallBtnHeight,"ShowHide","ShowHideContent",!1,"imageLeft","e-ssr-cmntcolbtn"),this._generateToggleBtn("Review_Comments_ShowAllComments","ShowAll","textandimage","e-icon e-ssr-showallcmnt","ShowAll",155,this._smallBtnHeight,"ShowAllContent",!1,"e-ssr-cmntcolbtn")]}]};r.groups.push(n);n={text:"Changes",alignType:t.Ribbon.alignType.row,content:[{groups:[this._generateToggleBtn("Review_Changes_ProtectSheet","Protectsheet","textandimage","e-icon e-ssr-protectsheet","Protectsheet",60,this._bigBtnHeight,"ProtectSheetToolTip",!1,"e-ssr-protectsheetbtn","imagetop","Unprotect"),this._generateToggleBtn("Review_Changes_ProtectWorkbook","ProtectWorkbook","textandimage","e-icon e-ssr-protect","ProtectWorkbook",60,this._bigBtnHeight,"ProtectWBContent",!1,"e-ssr-cmntcolbtn","imagetop"),this._generateToggleBtn("Review_Changes_LockCell","Lock","textandimage","e-icon e-ssr-protlockcell","lock",90,this._smallBtnHeight,"Lock",!1,"e-ssr-lockbtn","","Unlock","e-icon e-ssr-protunlockcell"),]},]};r.groups.push(n);this._tabCollection.push(r)},_otherTabObj:function(){var n,r=this.XLObj,u="imagetop",i={id:"others",text:r._getLocStr("OTHERS"),groups:[]},f=r._id,e=t.ContentType;n={text:"Window",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("Others_Window_FreezePanes","FreezePanes","textandimage",r._id+"_Ribbon_FPane",{dataSource:this._viewMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-frzpane",!1,55,this._splitBtnHeight,"bottom",u,"dropdown","e-spreadsheet e-fpanebtn","FreezePanes","FreezePanesContent")]}]};i.groups.push(n);n={text:r._getLocStr("Formula"),alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Others_Formulas_NameManager","NameManager",e.TextAndImage,"e-icon e-ssr-namemngr",55,this._bigBtnHeight,"NameManager",["NameManagerContent","NameManagerFormulaContent"],!1,u,"")]},{groups:[this._generateBtn("Others_Formulas_DefineName","DefineName",e.TextAndImage,"e-icon e-ssr-definename",110,25,"DefineName","DefineNameContent"),this._generateSplitBtn("Others_Formulas_UseInFormula","UseInFormula","textandimage",r._id+"_nmuseinformula","","e-icon e-ssr-useformula",!1,125,25,t.ArrowPosition.Bottom,t.ImagePosition.ImageLeft,"dropdown","e-spreadsheet e-useinformulabtn","UseInFormula","UseInFormulaContent")]}]};i.groups.push(n);n={text:"Cells",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Others_Cells_InsertCell","Insert","imageonly","e-icon e-ssr-insert",54,40,"InsertTitle",["InsertContent","MultipleInsertContent"],!1,u),this._generateSplitBtn("Others_Cells_InsertCellOptions","Insert","textandimage",f+"_Ribbon_Ins",{dataSource:this._insertMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,54,this._mediumBtnHeight,"bottom","","dropdown","e-insertsbtn","InsertTitle","InsertSBContent")]},{groups:[this._generateBtn("Others_Cells_DeleteCell","Delete","imageonly","e-icon e-ssr-delete",54,40,"DeleteTitle",["DeleteContent","MultipleDeleteContent"],!1,u),this._generateSplitBtn("Others_Cells_DeleteCellOptions","Delete","textandimage",f+"_Ribbon_Del",{dataSource:this._deleteMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,54,this._mediumBtnHeight,"bottom","","dropdown","e-deletesbtn","DeleteTitle",["DeleteContent","MultipleDeleteContent"])]}]};i.groups.push(n);n={text:"Editing",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("Others_Editing_FindSelect","FindSelect","textandimage",f+"_Ribbon_FindRep",{dataSource:this._findMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-findselect",!1,55,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-findbtn","FindSelectTitle","FindSelectContent")]}]};i.groups.push(n);n={text:"Calculation",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("Others_CalCulation_CalculationOptions","CalculationOptions","textandimage",f+"_Ribbon_CalcOpt",{dataSource:this._calcOptData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-calcopt",!1,67,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-coptbtn","CalcOptTitle",["CalcOptContent","CalcOptRecalcContent"])]},{groups:[this._generateBtn("Others_CalCulation_CalculateNow","CalculateNow",e.TextAndImage,"e-icon e-ss-calcnow",110,30,"CalculateNow",["CalculateNowContent","CalculateNowTurnOffContent"]),this._generateBtn("Others_CalCulation_CalculateSheet","CalculateSheet",e.TextAndImage,"e-icon e-ss-calcsheet",110,30,"CalculateSheet",["CalculateSheetContent","CalculateSheetTurnOffContent"])]}]};i.groups.push(n);this._tabCollection.push(i)},_renderRibbon:function(i){var r=this.XLObj,e=r._id,o=r.element,h,l=r.model,u=t.buildTag("div","","",{id:e+"_Ribbon"}),c=[r._getLocStr("HOME"),r._getLocStr("INSERT"),r._getLocStr("DATATAB"),r._getLocStr("PAGELAYOUT"),r._getLocStr("REVIEW"),r._getLocStr("OTHERS")],s,f;if(i?o.prepend(u):o.append(u),o.append(t.buildTag("ul","",{display:"none"},{id:e+"_Menu"})),h=t.SplitButton.prototype._documentClick,t.SplitButton.prototype._documentClick=function(t){n(t.target).is(".e-formatastable")||n(t.target).is(".e-formatastable-adaptive")||h.call(this,t)},s=[r._getLocStr("HOME"),r._getLocStr("INSERT"),r._getLocStr("PAGELAYOUT"),r._getLocStr("DATATAB"),r._getLocStr("OTHERS"),r._getLocStr("FORMAT"),r._getLocStr("DESIGN"),r._getLocStr("CHARTDESIGN"),r._getLocStr("ANALYZE")],r.model.ribbonSettings.enableOnDemand&&!r._isRibbonDestroyed)this._createTrgtElement(r._getLocStr("HOME"));else for(f=0;f<s.length;f++)this._createTrgtElement(s[f],u);if(this._menuCustomize(),this._homeTabObj(),this._insertTabObj(),this._dataTabObj(),this._pageTabObj(),this._reviewTabObj(),this._otherTabObj(),this._contextualTabObj(),u.attr("style","overflow:hidden"),u.height(0),u.width(0),u.ejRibbon({width:"100%",allowResizing:!0,applicationTab:this._appTabCollection,tabs:this._tabCollection,contextualTabs:this._contextualTabCollection,tabClick:n.proxy(this._onTabClick,this),tabSelect:n.proxy(this._onTabSelect,this),create:n.proxy(this._onControlCreated,this),collapse:n.proxy(this._onCollapse,this),backstageItemClick:n.proxy(this._onBackStageItemClick,this),groupExpand:n.proxy(this._onGroupExpander,this),pinState:n.proxy(this._onRibbonPin,this),expand:n.proxy(this._onRibbonExpand,this),groupClick:n.proxy(this._onRibbonGroupClick,this),_destroyed:n.proxy(this._rbnDestroy,this),enableOnDemand:r.model.ribbonSettings.enableOnDemand,beforeTabClick:n.proxy(this._onBeforeTabClick,this)}),u.css("height","auto"),u.width("100%"),l.scrollSettings.isResponsive&&(u.ejRibbon("option",{allowResizing:!0}),(r._phoneMode||r._tabMode)&&r._orientation==="landscape"&&u.ejRibbon("collapse")),r.model.ribbonSettings.enableOnDemand&&!r._isRibbonDestroyed)this._homeTabControls(),this._updateRibCustomCss(r._getLocStr("HOME")),this._isHomeTabCreate=!0,this._hideRibbonElem(r._getLocStr("HOME"));else for(this._isHomeTabCreate=!0,this._isInsertTabCreate=!0,this._isDataTabCreate=!0,this._isPageLayoutTabCreate=!0,this._isReviewTabCreate=!0,this._isOthersTabCreate=!0,this._isDesignTabCreate=!0,this._isFormatTabCreate=!0,this._isChartTabCreate=!0,this._analyzeTabCreate=!0,this._isAppTabCreate=!0,n("#"+e+"_Ribbon_review_Comments_5").css("vertical-align","middle"),f=0;f<6;f++)f!==1&&f!==4&&this._updateRibCustomCss(c[f]),this._hideRibbonElem(c[f]);this._hideOtherControls()},_createTabControls:function(t){var i=this.XLObj;switch(t){case i._getLocStr("HOME"):this._isHomeTabCreate||(this._homeTabControls(),this._isHomeTabCreate=!0,i._on(n("#"+i._id+"_cellstyles"),"click",i._cellStyleClick),i._on(n("#"+i._id+"_formatastable"),"click",i._formatAsTableClick),this._updateRibCustomCss(t),this._hideRibbonElem(t));break;case i._getLocStr("INSERT"):this._isInsertTabCreate||(this._isInsertTabCreate=!0,i._on(n(".e-"+i._id+".e-chartcell"),"click",i._chartClickHandler),this._hideRibbonElem(t));break;case i._getLocStr("DATATAB"):this._isDataTabCreate||(this._isDataTabCreate=!0,this._updateRibCustomCss(t),this._hideRibbonElem(t));break;case i._getLocStr("PAGELAYOUT"):this._isPageLayoutTabCreate||(this._pageTabControls(),this._isPageLayoutTabCreate=!0,this._updateRibCustomCss(t),this._hideRibbonElem(t));break;case i._getLocStr("REVIEW"):this._isReviewTabCreate||(n("#"+i._id+"_Ribbon_review_Comments_5").css("vertical-align","middle"),this._isReviewTabCreate=!0,this._hideRibbonElem(t));break;case i._getLocStr("OTHERS"):this._isOthersTabCreate||(this._othersTabControls(),this._isOthersTabCreate=!0,this._updateRibCustomCss(t),i._on(n("#"+i._id+"_nmuseinformula"),"click",".e-nmuseinformularow",i._useInFormulaClick),this._hideRibbonElem(t));break;case i._getLocStr("FORMAT"):this._isFormatTabCreate||(this._isFormatTabCreate=!0);break;case i._getLocStr("DESIGN"):this._isDesignTabCreate||(this._isDesignTabCreate=!0);break;case i._getLocStr("CHARTDESIGN"):this._isChartTabCreate||(this._isChartTabCreate=!0);break;case i._getLocStr("ANALYZE"):this._analyzeTabCreate||(this._isFormatTabCreate=!0)}},_createTrgtElement:function(t,i){var r=this.XLObj,i=i?i:n("#"+r._id+"_Ribbon");switch(t){case r._getLocStr("HOME"):this._isHomeTabTrgt||this._homeTabTrgtElem();this._isHomeTabTrgt=!0;break;case r._getLocStr("INSERT"):this._isInsertTabTrgt||this._onTabCreate();this._isInsertTabTrgt=!0;break;case r._getLocStr("DATATAB"):this._isDataTabTrgt||this._dataTabTrgtElem();this._isDataTabTrgt=!0;break;case r._getLocStr("PAGELAYOUT"):this._isPageLayoutTabTrgt||this._pageTabTrgtElem(i);this._isPageLayoutTabTrgt=!0;break;case r._getLocStr("OTHERS"):this._isOthersTabTrgt||this._othersTabTrgtElem();this._isOthersTabTrgt=!0;break;case r._getLocStr("CHARTDESIGN"):this._isChartTabTrgt||this._renderChartDesignTab();this._isChartTabTrgt=!0;break;case r._getLocStr("ANALYZE"):this._analyzeTabTrgt||this._renderAnalyzeTab();this._analyzeTabTrgt=!0;break;case r._getLocStr("FORMAT"):this._isFormatTabTrgt||this._renderFormatTab();this._isFormatTabTrgt=!0;break;case r._getLocStr("DESIGN"):this._isDesignTabTrgt||this._renderDesignTab();this._isDesignTabTrgt=!0}},_onTabCreate:function(){var i=this.XLObj,u=i._id,t=i.element,r=n("#"+i._id+"_Ribbon");t.append(this._chartType("ColumnChart",6,2,2,["column","stackingcolumn","stackingcolumn100","column","stackingcolumn","stackingcolumn100"],["ClusteredColumn","StackedColumn","Stacked100Column","Cluster3DColumn","Stacked3DColumn","Stacked100Column3D"]));t.append(this._chartType("BarChart",6,2,2,["bar","stackingbar","stackingbar100","bar","stackingbar","stackingbar100"],["ClusteredBar","StackedBar","Stacked100Bar","Cluster3DBar","Stacked3DBar","Stacked100Bar3D"]));t.append(this._chartType("StockChart",2,2,2,["radar","radar"],["Radar","RadarMarkers"]));t.append(this._chartType("LineChart",2,2,3,["line","line"],["Line","LineMarkers"]));t.append(this._chartType("AreaChart",3,3,3,["Area","stackingarea","stackingarea100"],["Area","StackedArea","Stacked100Area"]));t.append(this._chartType("PieChart",3,3,4,["pie","pie","doughnut"],["Pie","Pie3D","Doughnut"]));t.append(this._chartType("ScatterChart",1,2,2,["scatter"],["Scatter"]));r.append("<div id='"+i._id+"_nmuseinformula' class='e-nmuseinformula' style='width:125px'><\/div>")},_rbnDestroy:function(i){var r=this.XLObj,u=r._id,s="#"+u+"_Ribbon_Home_Font_FillColor",h="#"+u+"_Ribbon_Home_Font_FontColor",c="#"+u+"_Ribbon_PictureColor",e="#"+u+"_Ribbon_Home_Font_BorderColor",l="#"+u+"_Ribbon_BorderCP",a=n("#"+u+"_Ribbon").ejRibbon("instance"),v=a.getTabText(a.model.selectedItemIndex),y=r.model.ribbonSettings.enableOnDemand;if(n(s).data("ejColorPicker")&&n(s).ejColorPicker("destroy"),n(h).data("ejColorPicker")&&n(h).ejColorPicker("destroy"),n(c).data("ejColorPicker")&&n(c).ejColorPicker("destroy"),n(e).data("ejColorPicker")&&n(e).ejColorPicker("destroy"),n("#"+u+"_Ribbon_Home_Font_BorderColor_Presets").parent().remove(),n(l).data("ejColorPicker")&&n(l).ejColorPicker("destroy"),i&&!i.destroy){if(r._off(n("#"+u+"_cellstyles"),"click",r._cellStyleClick),r._off(n("#"+u+"_formatastable"),"click",r._formatAsTableClick),n(e)[0].style.display="none",r._off(n(".e-"+u+".e-chartcell"),"click",r._chartClickHandler),!y||this._isHomeTabTrgt&&v===r._getLocStr("HOME")){var u=r._id,f=r.element,p=u+"_Ribbon_",o=p+"Home_Font_";f.append(t.buildTag("input","",{display:"none"},{id:o+"FillColor",type:"text"}));f.append(t.buildTag("input","",{display:"none"},{id:o+"FontColor",type:"text"}));f.append(t.buildTag("input","",{display:"none"},{id:o+"BorderColor",type:"text"}));f.append(t.buildTag("div.e-spreadsheet e-formatastable","",{display:"none"},{id:r._id+"_formatastable"}));r.element.append(this._renderCellStyles())}else this._isHomeTabTrgt=!1;!y||this._isInsertTabTrgt&&v===r._getLocStr("INSERT")?this._onTabCreate():this._isInsertTabTrgt=!1;this._isHomeTabCreate=this._isInsertTabCreate=this._isDataTabCreate=this._isPageLayoutTabCreate=this._isReviewTabCreate=!1;this._isOthersTabCreate=this._isDesignTabCreate=this._isFormatTabCreate=this._isChartTabCreate=this._analyzeTabCreate=this._isAppTabCreate=!1;r._isRibbonDestroyed=!0}else n(document.body).append(n("#"+u+" _formatastable").parent()),n(document.body).append(n("#"+u+" _cellstyles").parent())},_updateRibCustomCss:function(n){var r=this.XLObj,i=r._id,y,p,w,b,u,s,a,t=0,k,h="Options",e,o,c,f,v;switch(n){case r._getLocStr("HOME"):var d="e-ssr-colpickHprt",g="_Ribbon_Home_Font",nt="_Ribbon_home_Font_Home_Font_",tt="_Ribbon_home_Clipboard_Home_Clipboard_Paste",st=["e-mergebtn","e-borderbtn","e-autosumbtn"],it=[i+nt+"FontFamily",i+nt+"FontSize"],rt=["e-ssr-fontfamily","e-ssr-fontsize"];for(c=[i+tt+h],o=[i+tt],e=[i+"_Ribbon_home_Clipboard_1"],f=[" e-ssr-pastebtnHprt"],r.addClass(document.getElementById(i+g+"_FillColorWrapper").children[0],d),r.addClass(document.getElementById(i+g+"_FontColorWrapper").children[0],d),b=r.element[0].querySelectorAll(".e-ssr-colpickHprt .e-color-container,.e-ssr-colpickHprt .e-select");t<4;)r.addClass(b[t],"e-ssr-colorcontainer"),t++;for(t=0;t<3;)r.addClass(document.querySelectorAll("."+st[t])[0].parentNode,"e-ssr-horizontalprt"),t++;for(t=0;t<2;)r.addClass(document.getElementById(it[t]),rt[t]),t++;break;case r._getLocStr("DATATAB"):v="_Ribbon_data_DataTools_Data_DataTools_DataValidation";c=[i+v+h];o=[i+v];e=[i+"_Ribbon_data_DataTools_1"];f=[" e-ssr-dtvaldtnHprt"];break;case r._getLocStr("PAGELAYOUT"):var ut="_Ribbon_pagelayout_PageLayout_PageLayout_PageLayout_PageSize",ft="_Ribbon_PageLayout_Show_",it=["ej"+i+ft+"Headings","ej"+i+ft+"Gridlines"],rt=["e-vheading","e-vgridlines"];for(c=[i+ut+h],o=[i+ut],e=[i+"_Ribbon_pagelayout_PageLayout_1"],f=[" e-ssr-pagesizebtnHprt"," e-ssr-sizebtnHprt"],t=0;t<2;)r.addClass(document.getElementById(it[t]),rt[t]),t++;break;case r._getLocStr("OTHERS"):var et="InsertCell",l="_Ribbon_others_Cells_Others_Cells_",ot="DeleteCell";c=[i+l+et+h,i+l+ot+h];o=[i+l+et,i+l+ot];e=[i+"_Ribbon_others_Cells_1",i+"_Ribbon_others_Cells_2"];f=[" e-ssr-insertbtnHprt"," e-ssr-deletebtnHprt"]}for(t=0,k=e.length;t<k;)a=document.getElementById(e[t]),w=document.getElementById(o[t]),y=document.getElementById(o[t]),p=document.getElementById(c[t]),u=document.createElement("span"),u.className="e-ssr-verticalHparent"+f[t],u.style.display="inherit",a.insertBefore(u,w),u.appendChild(y),u.appendChild(p),f[0]===" e-ssr-pagesizebtnHprt"&&(s=document.createElement("span"),s.className="e-ssr-verticalHparent"+f[t+1],s.style.display="inherit",s.appendChild(u),a.appendChild(s)),t++},_hideOtherControls:function(){for(var t=0,i=["CElement","Paste","Border","Merge","SortFilter","Clear","ColumnChart","BarChart","Validation","PageSize","FPane","Ins","Del","FindRep","PastePic","PictureBorder","AutoSum","ResetPic","PictureBorder","StockChart","LineChart","AreaChart","PieChart","ScatterChart","color_Presets","PictureColor_Presets","Home_Font_BorderColor_Presets"],r=i.length;t--;)n("#"+this._id+"_Ribbon_"+i[t]).hide();for(t=0,i=["CFormat","formatastable","cellstyles","ctxtmenu"],r=i.length;t--;)n("#"+this._id+"_"+i[t]).hide()},_renderAppTab:function(){var i,n=this.XLObj,r=[];i="<div  id='"+n._id+"_backstagetabnew' style='display:none' class='e-ssr-bstabnew'><div class='e-ssr-bscontent' title='"+n._getLocStr("BlankWorkbook")+"'><div class='e-ssr-bsnewtmpl' ><button id='"+n._id+"_bstab_new_blank' type='button' class = 'e-rbn-button' ><\/button><\/div><\/div><\/div>";i=i.concat("<div id='"+n._id+"_backstagetabsaveas' style='display:none' class='e-ssr-bstabsaveas'><div class='e-ssr-bscontent'><div class='e-ssr-bssaveasopt'><button id='"+n._id+"_bstab_saveas_excel' type='button' class = 'e-rbn-button'><\/button><span>"+n._getLocStr("SaveAsExcel")+"<\/span><\/div><div class='e-ssr-bssaveasopt'><button id='"+n._id+"_bstab_saveas_csv' type='button' class = 'e-rbn-button'><\/button><span>"+n._getLocStr("SaveAsCsv")+"<\/span><\/div><div class='e-ssr-bssaveasopt'><button id='"+n._id+"_bstab_saveas_pdf' type='button' class = 'e-rbn-button'><\/button><span>"+n._getLocStr("SaveAsPdf")+"<\/span><\/div><\/div><\/div>");i=i.concat("<div id='"+n._id+"_backstagetabprint' style='display:none' class='e-ssr-bstabprint'><div class='e-ssr-bscontent'><div class='e-ssr-bsprintopt'><button id='"+n._id+"_bstab_print_sheet' type='button' class = 'e-rbn-button'><\/button><span>"+n._getLocStr("PrintSheet")+"<\/span><\/div><div class='e-ssr-bsprintopt'><button id='"+n._id+"_bstab_print_selected' type='button' class = 'e-rbn-button'><\/button><span>"+n._getLocStr("PrintSelected")+"<\/span><\/div><\/div><\/div>");n.element.append(i);r.push({id:"new",text:n._getLocStr("New"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabnew"});r.push({id:"open",text:n._getLocStr("Open")+"...",itemType:t.Ribbon.itemType.tab});r.push({id:"saveas",text:n._getLocStr("SaveAs"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabsaveas"});r.push({id:"print",text:n._getLocStr("Print"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabprint"});this._appTabCollection={type:t.Ribbon.applicationTabType.backstage,backstageSettings:{text:n._getLocStr("File"),headerWidth:124,height:n._responsiveHeight-2,width:n._responsiveWidth-3,pages:r}}},_onBackStageItemClick:function(t){var i,e,r,f,u;if(this._isAppTabCreate||(this._appTabControls(),this._isAppTabCreate=!0),i=this.XLObj,f=i.model.ribbonSettings.applicationTab,i.XLEdit._isEdit&&i.XLEdit.saveCell(),i.XLComment&&i.XLComment._isCommentEdit&&i.XLComment._updateCurCmntVal(),i._isSheetRename&&!i._updateSheetNames(null,!1)){i.element.find("#"+i._id+"_Ribbon").ejRibbon("hideBackstage");return}if(f.type==="menu"){if(e={element:t.element},i._trigger("menuClick",e))return;t.ID==="Open"?(i.XLEdit._isEdit&&i.XLEdit.saveCell(),this._bSBtnClickHandler(t.ID.toLowerCase(),t)):this._bSBtnClickHandler(t.ID.toLowerCase(),t)}if(f.type==="backstage")if(t.type==="backstageItemClick"){if(r={id:t.id,text:t.text,type:t.type,target:t.target,prop:t.model},i._trigger("menuClick",r))return;t.id==="open_backStageTab"&&(i.XLEdit._isEdit&&i.XLEdit.saveCell(),this._bSBtnClickHandler("open",t))}else{if(r={e:t.e,type:t.type,status:t.status,target:t.target,id:t.target.id},i._trigger("menuClick",r))return;n("#"+i._id+"_Ribbon").ejRibbon("hideBackstage");i._phoneMode&&n("#"+i._id+"_Ribbon").ejRibbon("goToMainContent");u=t.model.prefixIcon;this._bSBtnClickHandler(u.indexOf("blank")>-1?u.split("-")[2]:u.split("-")[3],t)}},_bSBtnClickHandler:function(t,i){var r=this.XLObj,f=r.getActiveSheetIndex(),u,e={id:i.id||i.ID||i.target.id,status:i.status,prop:i.model,model:r.model};if(!r._trigger("ribbonClick",e)){n("#"+r._id+"_Ribbon").ejRibbon("hideBackstage");switch(t){case"open":if(r.isDirty)r._showAlertDlg("confirm","ImportAlert","Open",470);else{if(r.model.importSettings.importMapper.length<1){r._showAlertDlg("Alert","ImportExportUrl");return}n("#"+r._id+"_file .e-uploadinput").click();r._browserDetails.name!="msie"&&r._browserDetails.name!="edge"&&n("#"+r._id+"_Ribbon_BackStage").show();n("#"+r._id+"_Ribbon").find(".e-backstagetitlecontent").text("").append("Open")}break;case"new":case"blank":r._isSheetsDirty()&&r._showAlertDlg("confirm","DestroyAlert","New",470);break;case"exportxl":case"exportcsv":case"exportpdf":r._showDialog(t);n("#"+r._id+"_ExportFileNameDialog").ejDialog("open");u=t.split("export")[1];r.XLExport._exportType=u.indexOf("xl")>-1?"Excel":u.charAt(0).toUpperCase()+u.slice(1);break;case"print":case"printsheet":r.XLPrint.printSheet(f);break;case"printselected":r.XLPrint.printSelection(f)}}},_contextualTabObj:function(){var r=this.XLObj,n=r._id,u="imagetop",i;i={backgroundColor:"#FCFBEB",borderColor:"#F2CC1C",tabs:[{id:"design",text:r._getLocStr("Design"),groups:[{text:"Properties",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_Ribbon_Design_Properties_TableProperties"},{text:"Tools",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Design_Tools_ResizeTable","ResizeTable","textandimage","e-icon e-ssr-resizetable",101,this._smallBtnHeight,"ResizeTable","ResizeTableContent"),this._generateBtn("Design_Tools_ConvertToRange","ConvertToRange","textandimage","e-icon e-ssr-range",130,this._smallBtnHeight,"ConvertToRange","ConvertToRangeContent")]}]},{text:"Table Style Options",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_Ribbon_Design_TableStyleOptions"}]}]};this._contextualTabCollection.push(i);i={backgroundColor:"#EAF6BD",borderColor:"#90AA3C",tabs:[{id:"chartdesign",text:r._getLocStr("CHARTDESIGN"),groups:[{text:"Chart Layouts",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("ChartDesign_ChartLayouts_AddChartElement","AddChartElement","textandimage",n+"_Ribbon_CElement","","e-icon e-ssr-celements",!0,65,this._bigBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-chartlayoutbtn","AddChartElement","AddChartElementContent")]}]},{text:"Data",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("ChartDesign_Data_SwitchRowColumn","SwitchRowColumn","textandimage","e-icon e-ssr-srcolumn",72,this._bigBtnHeight,"SwitchRowColumn","SwitchRowColumnContent","","imagetop"),this._generateBtn("ChartDesign_Data_SelectData","SelectData","textandimage","e-icon e-ssr-selectdata",50,this._bigBtnHeight,"SelectData","SelectDataContent",!1,u)]}]},{text:"Type",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("ChartDesign_Type_ChangeChartType","ChartType","textandimage","e-icon e-ssr-charttype",65,this._bigBtnHeight,"ChartType","ChartTypeContent",!1,u)]}]},{text:"Chart Themes",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateDD("ChartDesign_ChartThemes_ChartThemes","ChartThemes",this._chartThemes,"1",130,this._smallBtnHeight,"ChartThemes","ChartThemesContent")]}]},{text:"Size",alignType:t.Ribbon.alignType.columns,content:[{groups:[{contentID:n+"_Ribbon_ChartDesign_Size_ChartSize",enableSeparator:!0,type:t.Ribbon.type.custom,height:80}]}]}]}]};this._contextualTabCollection.push(i);i={backgroundColor:"#FCFBEB",borderColor:"#F2CC1C",tabs:[{id:"format",text:r._getLocStr("FORMAT"),groups:[{text:"Adjust",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Format_Adjust_ChangePicture","ChangePicture","textandimage","e-icon e-ssr-changepicture",120,this._mediumBtnHeight,"ChangePicture","ChangePictureContent"),this._generateSplitBtn("Format_Adjust_ResetPicture","ResetPicture","textandimage",n+"_Ribbon_ResetPic",{dataSource:this._resetPicture,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-resetpicture",!1,120,this._mediumBtnHeight,"left","","dropdown","e-ss-resetpictbtn","ResetPicture","ResetPictureContent")]}]},{text:"Border",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("Format_Border_PictureBorder","PictureBorder","textandimage",n+"_Ribbon_PictureBorder","","e-icon e-ssr-pictureborder",!1,120,this._mediumBtnHeight,"left","","dropdown","e-ss-pictbrdrbtn","PictureBorder","PictureBorderContent")]}]},{text:"Size",alignType:t.Ribbon.alignType.columns,type:"custom",contentID:n+"_Ribbon_Format_Size_PictureSize"}]}]};this._contextualTabCollection.push(i);i={backgroundColor:"#FCF0F7",borderColor:"#C9599C",tabs:[{id:"analyze",text:r._getLocStr("ANALYZE"),groups:[{text:"PivotTable",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_pvttableproperties"},{text:"DataSource",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("Analyze_DataSource_Refresh","Refresh","textandimage","e-icon e-ssr-datarefresh",50,this._bigBtnHeight,"RefreshTitle","RefreshContent",!1,u),this._generateBtn("Analyze_DataSource_ChangeDataSource","ChangeDataSource","textandimage","e-icon e-ssr-changedatasource",50,this._bigBtnHeight,"ChangeDataSource","ChangeDataSourceContent",!1,u)]}]},{text:"Actions",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Analyze_Actions_ClearAll","ClearAll","textandimage","e-icon e-ssr-pivotclearall",75,this._smallBtnHeight,"ClearAll","ClearAllContent",!1,"","e-datapadding"),this._generateBtn("Analyze_Actions_MovePivotTable","MovePivotTable","textandimage","e-icon e-ssr-movepivottable",120,this._smallBtnHeight,"MovePivotTable","MovePivotTableContent",!1,"","e-datapadding")]}]},{text:"Show",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateToggleBtn("Analyze_Show_FieldList","FieldList","textandimage","e-icon e-ssr-fieldlist","FieldListTitle",50,this._bigBtnHeight,["FieldListContent","FieldListRemoveContent"],!1,"",u,null,null,!0)]}]}]}]};this._contextualTabCollection.push(i)},_onRibbonPin:function(t){var i=this.XLObj,u=n.extend(!0,{},i.model.scrollSettings),r;this._ribbonState=!0;t.action="toggleBtn";i.model._isActPanelVisible=this._isPanelVisible;i._isAutoWHMode?(this._refreshBackstageHeight(),r=i._getElementDimension(),i.element.css({height:r.height,width:r.width})):i._heightWidthCalculation(i.getActiveSheetIndex(),u,t);i.model._isActPanelVisible&&i._refreshActivationPanel();i.getSheet(i.getActiveSheetIndex())._isRibCollapsed=!1},_onRibbonExpand:function(t){var i=this.XLObj,u=n.extend(!0,{},i.model.scrollSettings),r;t.action="toggleBtn";t.type==="expand"&&t.clickType==="dblclick"||i._isKeyCtrlShftF2||i._phoneMode?(this._ribbonState=!0,i._isAutoWHMode?(this._refreshBackstageHeight(),r=i._getElementDimension(),i.element.css({height:r.height,width:r.width})):i._heightWidthCalculation(i.getActiveSheetIndex(),u,t),this.XLObj.model._isActPanelVisible&&i._refreshActivationPanel(),i.getSheet(i.getActiveSheetIndex())._isRibCollapsed=!1,i._isKeyCtrlShftF2=!1):this.XLObj.model._isActPanelVisible&&(i.getActivationPanel().hide(),this._isPanelVisible=i.model._isActPanelVisible,i.model._isActPanelVisible=!1,i._heightWidthCalculation(i.getActiveSheetIndex(),u,t))},_onRibbonGroupClick:function(t){var i=this.XLObj,u,r;i._phoneMode&&(n(t.target).parents(".e-resizegroupdiv").length>0||t.target.className.indexOf("e-resizegroupdiv")>-1||t.target.className.indexOf("e-ribdownarrow")>-1||t.target.className.indexOf("e-ribuparrow")>-1||t.target.className.indexOf("e-ribleftarrow")>-1)&&(u=n.extend(!0,{},i.model.scrollSettings),this._ribbonState=!0,t.action="toggleBtn",i.model._isActPanelVisible=this._isPanelVisible,i._isAutoWHMode?(this._refreshBackstageHeight(),r=i._getElementDimension(),i.element.css({height:r.height,width:r.width})):i._heightWidthCalculation(i.getActiveSheetIndex(),u,t),i.model._isActPanelVisible&&i._refreshActivationPanel())},_hideTabs:function(){for(var r=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("instance"),i=["",this.XLObj._getLocStr("Design"),this.XLObj._getLocStr("CHARTDESIGN"),this.XLObj._getLocStr("FORMAT"),this.XLObj._getLocStr("ANALYZE")],t=i.length;t=t-1;)r.hideTab(i[t])},_renderDesignTab:function(){var i=this.XLObj,r="",u=i._getLocStr("TableStyleOptions").split("/"),t=i._id+"_Ribbon_Design_TableStyleOptions";i.element.append("<input id="+i._id+'_tableid type="text" style = "display:none"/>');r="<div id="+i._id+'_Ribbon_Design_Properties_TableProperties><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell">Table Name:<\/div><\/div><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell"><input type="text" id='+i._id+'_Ribbon_Design_Properties_TableName class="ejinputtext" style="width:86px;opacity:0.7;height: 18px;text-indent: 3px;padding-left: 0px;box-sizing: content-box;" /><\/div><\/div><\/div>';r=r+"<div id="+t+'><div class="e-tablestyleoptionsrow" ><div class="e-tablestyleoptionscell"><input id='+t+'_FirstColumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+t+'_FirstColumn">'+u[0]+'<\/label><\/div><div class="e-tablestyleoptionscell" ><input id='+t+'_LastColumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+t+'_LastColumn">'+u[1]+'<\/label><\/div><\/div><div class="e-tablestyleoptionsrow" ><div class="e-tablestyleoptionscell"><input id='+t+'_TotalRow type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+t+'_TotalRow">'+u[2]+'<\/label><\/div><div class="e-tablestyleoptionscell" ><input id='+t+'_FilterColumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+t+'_FilterColumn">'+u[3]+"<\/label><\/div><\/div><\/div>";i.element.append(r);n("#"+t+"_FirstColumn").ejCheckBox({change:this._ribbonClickHandler});n("#"+t+"_LastColumn").ejCheckBox({change:this._ribbonClickHandler});n("#"+t+"_TotalRow").ejCheckBox({change:this._ribbonClickHandler});n("#"+t+"_FilterColumn").ejCheckBox({change:this._ribbonClickHandler})},_renderFormatTab:function(){var u=this.XLObj,f=u._id,e=u.element,i=f+"_Ribbon",r=i+"_Format_Size_";e.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:i+"_ResetPic"}));e.append(this._borderPicture());e.append("<div id="+r+"PictureSize class= e-ss-numeric style='display:none'><table><tr><td style='padding-right:4px;'>"+u._getLocStr("Height")+": <\/label><\/td><td style='padding-bottom:3px;'><input id='"+r+"PictureHeight' type='text' /><\/td><\/tr><tr><td><labe>"+u._getLocStr("Width")+": <\/label><\/td><td><input id='"+r+"PictureWidth' type='text' /><\/td><\/tr><\/table><\/div>");n("#"+r+"PictureHeight").ejNumericTextbox({name:"numeric",value:100,minValue:25,incrementStep:5,change:n.proxy(this._pictureSizeChange,this,"PictureWidth")});n("#"+r+"PictureWidth").ejNumericTextbox({name:"numeric",value:100,minValue:25,incrementStep:5,change:n.proxy(this._pictureSizeChange,this,"PictureHeight")});n("#"+i+"_PictureColor").ejColorPicker({modelType:"palette",presetType:"basic",cssClass:"e-ss-colorpicker e-ss-menuclrpkr",change:this._ribbonClickHandler});n("#"+i+"_PictureColorWrapper").hide();n("#"+i+"_PictureColor_popup").css({display:"block"});n("#"+f+"picturecolor ul li").find("a").remove();n("#"+f+"picturecolor ul li").append(n("#"+i+"_PictureColor_popup"))},_renderAnalyzeTab:function(){var n=this.XLObj;n.element.find("#"+n._id+"_Ribbon_analyze_PivotTable_content").width(132);n.element.find("#"+n._id+"_pvttableproperties").length||n.element.append("<div id="+n._id+'_pvttableproperties style="display:none" ><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell">PivotTable Name:<\/div><\/div><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell"><input type="text" id='+n._id+'_Ribbon_Analyze_PivotTable_PivotTableName class="ejinputtext" style="width:106px;opacity:0.7;height: 18px;text-indent: 3px;" /><\/div><\/div><\/div>')},_renderChartDesignTab:function(){var r=this.XLObj,u=r.element,i=r._id,t=i+"_Ribbon_ChartDesign_Size_";u.append(this._chartElementTag());u.append("<div id="+t+"ChartSize class= e-ss-numeric style='width: 180;height: 80;'><table><tr><td><label class ='e-icon e-ssr-chartheight' style='width:25;height:25;display: visible' id = "+i+"_Ribbon_chartheightlbl /><\/td><td><input id='"+t+"ChartHeight' type='text' /><\/td><\/tr><tr><td><label class ='e-icon e-ssr-chartwidth' style='width: 180;height: 80;' id = "+i+"_Ribbon_chartwidthlbl /><\/td><td><input id='"+t+"ChartWidth' type='text' /><\/td><\/tr><\/table><\/div>");n("#"+t+"ChartWidth").ejNumericTextbox({name:"numeric",value:200,minValue:180,decimalPlaces:1,incrementStep:5,change:this._ribbonClickHandler});n("#"+t+"ChartHeight").ejNumericTextbox({name:"numeric",value:200,minValue:180,decimalPlaces:1,incrementStep:5,change:this._ribbonClickHandler})},_renderNameManagerDlg:function(){var i=this.XLObj,r="<div id = '"+i._id+"_nmdlg' style=display:'none'; ><div class='e-dlgctndiv' style='width: 100%;' ><div class='e-dlg-fields e-nmdlg-content' style='width: 100%;'><div class='e-ss-nm-dlg-grid' style='height: 180px;'><div id='"+i._id+"_nmgrid' style=display:'none';><\/div><\/div><\/div><div class='e-dlg-fields'><label class='e-dlg-fields'>"+i._getLocStr("RefersTo")+":<\/label><input type='text' class='e-nmrange ejinputtext' id='"+i._id+"_nmrange' disabled='true' /><\/div><div class='e-dlg-btnfields' ><div class='e-dlg-btnctnr'><button id='"+i._id+"_nmclose' >"+i._getLocStr("Close")+"<\/button><\/div><\/div><\/div><\/div>";r=r+"<script id='"+i._id+"_nmeditortemplate' class='e-hide' type='text/x-jsrender' ><div class='e-dlg-fields e-dlgctndiv'><table cellpadding='0' cellspacing='0'><tr><td>"+i._getLocStr("Name")+":<\/td><td><input id='"+i._id+"_nmgridname' type='text' class='ejinputtext' name='name' value='{{: name}}'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+i._getLocStr("Scope")+":<\/td><td><input class='e-nmscope ejinputtext' id='"+i._id+"_nmgridscope' type='text' disabled='disabled' name='scope' value='Workbook'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+i._getLocStr("Comment")+":<\/td><td><textarea id='"+i._id+"_nmgridcomment' class='e-ss-textarea' style=' resize: none; height: 44px; width: 100%;' name='comment' value='{{: comment}}'>{{: comment}}<\/textarea><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+i._getLocStr("RefersTo")+":<\/td><td><input type='text' class='ejinputtext' id='"+i._id+"_nmgridrefersto' name = 'refersto' value='{{: refersto}}' /><\/td><\/tr><\/table><\/div><\/script>";i.element.append(r);n("#"+i._id+"_nmclose").ejButton({showRoundedCorner:!0,width:68,click:n.proxy(this._nmdlgClose,i)});this._renderNMGrid();n("#"+i._id+"_nmdlg").ejDialog({enableResize:!1,showOnInit:!1,title:i._getLocStr("NameManager"),enableModal:!0,width:"auto",height:"auto",cssClass:"e-ss-dialog e-ss-nmdlg e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),beforeClose:t.proxy(this._beforeDlgClose,this),open:t.proxy(this._nmDlgOpen,this)})},_renderNMGrid:function(){var i=this.XLObj;n("#"+i._id+"_nmgrid").ejGrid({dataSource:i.model.nameManager.slice(0),allowScrolling:!0,allowSorting:!0,enableAltRow:!1,isResponsive:!0,minWidth:400,allowPaging:!1,scrollSettings:{height:"100%"},cssClass:"e-ss-dialog e-ss-grid e-"+i._id+"-dlg",selectionType:t.Grid.SelectionType.Single,editSettings:{allowAdding:!0,allowDeleting:!1,editMode:t.Grid.EditMode.DialogTemplate,dialogEditorTemplateID:"#"+i._id+"_nmeditortemplate"},toolbarSettings:{showToolbar:!0,toolbarItems:[t.Grid.ToolBarItems.Add]},actionBegin:n.proxy(this._nmActionBegin,i),actionComplete:n.proxy(this._nmActionComplete,i),rowSelected:n.proxy(this._nmRecordSelected,i),columns:[{field:"name",headerText:i._getLocStr("Name"),isPrimaryKey:!0,width:100},{field:"refersto",headerText:i._getLocStr("RefersTo"),width:120},{field:"scope",headerText:i._getLocStr("Scope"),width:80},{field:"comment",headerText:i._getLocStr("Comment"),width:100}]})},_updateNMRange:function(){var t=this.XLObj;n("#"+t._id+"_nmgridEditForm").find("#"+t._id+"_nmgridrefersto").val("="+t._getDollarAlphaRange(t.getSheet(t.getActiveSheetIndex()).selectedRange,!0))},_nmdlgClose:function(){n("#"+this._id+"_nmdlg").ejDialog("close")},_nmRecordSelected:function(t){n("#"+this._id+"_nmdlg").find(".e-nmrange").val(t.data.refersto)},_nmDlgOpen:function(){var t=this.XLObj;this._isNmgrid==="DefineName"&&(n("#"+t._id+"_nmgrid").ejGrid("instance").addRecord(),n("#"+t._id+"_nmgridEditForm input")[0].focus());this._isNmgrid=""},_nmActionBegin:function(n){var t=0,u=!1,f,e,r,i=this.getSheet(this.getActiveSheetIndex());if(n.requestType==="save"&&n.data.refersto){if(r=n.data,r.sheetIndex=this._getSheetIndexByName(n.data.refersto.split("!")[0].replace(/[=\']/g,"")),n.cancel=!0,!r.sheetIndex){this._showAlertDlg("Alert","InvalidSheetIndex","NMRangeAlert",275);return}if(i._nmEdit)for(e in i._nmValue){for(f=this.model.nameManager.length;t<f;){if(this.model.nameManager[t].name===i._nmValue.name){this.model.nameManager.splice(t,1);this._calcEngine.removeNamedRange(i._nmValue.name);break}t++}for(t=this._formulaCollection.length;t--;)if(this._formulaCollection[t].display===i._nmValue.name){u=!0;this._formulaCollection.splice(t,1);break}if(u)break}this.XLRibbon._validateNamedRange(r.name,r.refersto)?n.cancel=!1:u&&this.model.nameManager.push(i._nmValue)}n.requestType==="beginedit"&&(i._nmEdit=!0,i._nmValue={name:n.model.dataSource[n.model.selectedRowIndex].name,refersto:n.model.dataSource[n.model.selectedRowIndex].refersto,comment:n.model.dataSource[n.model.selectedRowIndex].comment,sheetIndex:n.model.dataSource[n.model.selectedRowIndex].sheetIndex,scope:n.model.dataSource[n.model.selectedRowIndex].scope})},_nmActionComplete:function(t){var r=n("#"+this._id+"_nmgrid").data("ejGrid"),f=t.requestType,i,u;switch(f){case"add":i=n("#"+this._id+"_nmgrid_dialogEdit").data("ejDialog");i.model.open=n.proxy(this.XLRibbon._updateNMRange(),this);i.option("allowDraggable",!1);i.option("title",this._getLocStr("NewName"));u=n("#"+this._id+"_nmgridEditForm").find("input[type='button']:first");u.data("ejButton").option({text:"OK",cssClass:"e-ss-okbtn"});u.parent().addClass("e-dlg-btnfields").css("text-align","right");break;case"save":this.XLRibbon._addNamedRange(r,t.data.name,t.data.refersto,t.data.comment,t.data.sheetIndex);break;case"delete":this.XLRibbon._removeNamedRange(r,t.data.name);break;case"cancel":r.element.focus()}},_updateNamedRanges:function(n,t,i){var r=this.XLObj;t=r.XLEdit._parseSheetRef(t,!0);r._calcEngine.addNamedRange(n,t.replace("=",""));r._formulaCollection.push({text:"="+n,display:n});i||r.XLEdit._refreshAutoComplete()},_updateUseInFormulaTrgt:function(){for(var i=0,t=this.XLObj,r="",e=n("#"+t._id+"_nmuseinformula"),u=t.model.nameManager,f=u.length;i<f;)r=r+"<div class='e-nmuseinformularow' style = 'color:#333333'>"+u[i].name+"<\/div>",i++;f?n("#"+t._id+"_Ribbon_Others_Formulas_UseInFormula").ejSplitButton("enable"):n("#"+t._id+"_Ribbon_Others_Formulas_UseInFormula").ejSplitButton("disable");e.html("<div>"+r+"<\/div>")},addNamedRange:function(t,i,r,u){var e=this.XLObj,f=n("#"+e._id+"_nmgrid").data("ejGrid"),u=u||e.getActiveSheetIndex();this._validateNamedRange(t,i)&&(f?(f.addRecord({name:t,refersto:i,comment:r?r:"",scope:"WorkBook",sheetIndex:u}),f.refreshContent()):(e.model.nameManager.push({name:t,refersto:i,comment:r,sheetIndex:u,scope:"workbook"}),this._addNamedRange(f,t,i,r,u)))},_addNamedRange:function(n,t,i,r,u){var f=this.XLObj;n&&(f.model.nameManager=n.model.dataSource.slice(0));this._updateNamedRanges(t,i);this._updateUseInFormulaTrgt();f._isSheetNavigate||f._trigActionComplete({sheetIndex:u,reqType:"named-range",name:t,refersTo:i,comment:r})},removeNamedRange:function(t){if(t||t){var r=this.XLObj,i=n("#"+r._id+"_nmgrid").data("ejGrid"),f,u;i?(i.option("editSettings",{allowDeleting:!0}),i.deleteRecord("name",{name:t}),i.option("editSettings",{allowDeleting:!1})):(f=r.model.nameManager,u=this._validateNameManager(t),r.model.nameManager.splice(u,1),this._removeNamedRange(i,t))}},_removeNamedRange:function(n,t){var r,u,i=this.XLObj,f=i.model.nameManager[i.model.nameManager.length-1];if(n&&(i.model.nameManager=n.model.dataSource.slice(0)),u=i.model.nameManager,i._calcEngine.removeNamedRange(t),i._updateFormulaCollection(),r=u.length,r)while(r--)i._formulaCollection.push({text:"="+u[r].name,display:u[r].name});this._updateUseInFormulaTrgt()},_validateNamedRange:function(t,i){var e,o,s,a,u,r=this.XLObj,h="NMRangeAlert",c="NMNameAlert",l="NMUniqueNameAlert",f;if(e=this._validateDollarRange(i),t&&t.length>0&&(o=/^([a-zA-Z_0-9]){0,255}$/.test(t)&&this._validateLibraryFunctions(t)),s=this._validateNameManager(t),r._isUndoRedo||e&&o&&s<0)return!0;a=n("#"+r._id+"_alertdlg");e?o?(u=r._getLocStr(l),f=l):(u=r._getLocStr(c).split("/")[0],f=c):(u=r._getLocStr(h),f=h);r._showAlertDlg("Alert","T-"+u,f,370)},_validateLibraryFunctions:function(n){var i,r=[],u=this.XLObj.getCalcEngine().getLibraryFunctions();n=t.isNullOrUndefined(n)?"":n.toString().toUpperCase();for(i in u.items)r.push(i);for(i=r.length;i--;)if(r[i]===n)return!1;return!0},_validateNameManager:function(n){var i=0,r=this.XLObj.model.nameManager,u=r.length;for(n=t.isNullOrUndefined(n)?"":n.toString().toUpperCase();i<u;){if(r[i].name.toUpperCase()===n)return i;i++}return-1},_validateDollarRange:function(n){try{if(n&&n.indexOf("!")>-1)return n=n.split("!")[1].replace(/\$/g,""),this.XLObj.getRangeIndices(n),!0}catch(t){return!1}},_renderFormatAsTable:function(){for(var f,a,it,e=this.XLObj,u=0,at=[11,19],rt=0,l="",ut="",i="w:bold",r="c:#FFFFFF",t="c:#000000",p="c:#2F75B5",w="c:#ED7D31",b="c:#FFC000",o="1px solid #000000",s="1px solid #2f75b5",h="1px solid #ED7D31",c="1px solid #FFC000",k="b:#D9D9D9",v="b:#DDEBF7",d="b:#FCE4D6",g="b:#FFF2CC",ft="b:#000000",et="b:#FFE2C6",ot="b:#FFF1BF",y="b:#000000",st="b:#D7D7D7",nt="b:#FFC000",tt="b:#5B9BD5",ht="b:#Ed7D31",ct="hl?"+i+";"+t+";bo:tb-"+o+"&cl?"+k+";"+t+","+t+"&cb?b-"+o+"/hl?"+i+";bo:tb-"+s+";"+p+"&cl?"+v+";"+p+","+p+"&cb?b-"+s+"/hl?"+i+";bo:tb-"+h+";"+w+"&cl?"+d+";"+w+","+w+"&cb?b-"+h+"/hl?"+i+";bo:tb-"+c+";"+b+"&cl?"+g+";"+b+","+b+"&cb?b-"+c+"/hl?"+i+";"+ft+";"+r+";bo:o-"+o+"&cl?bo:t-"+o+";"+t+"&cb?o-"+o+"/hl?bo:o-"+s+";"+i+";"+tt+";"+r+"&cl?bo:t-"+s+";"+t+"&cb?o-"+s+"/hl?"+i+";b:#EB7E2F;"+r+";bo:o-"+h+"&cl?bo:t-"+h+";"+t+"&cb?o-"+h+"/hl?"+i+";"+nt+";"+r+";bo:o-"+c+"&cl?bo:t-"+c+";"+t+"&cb?o-"+c+"/hl?"+i+";bo:gb-"+o+";"+t+"&cl?"+k+";"+t+","+t+"&cb?gb-"+o+"/hl?"+i+";bo:gb-"+s+";"+t+"&cl?"+v+";"+t+","+t+"&cb?gb-"+s+"/hl?"+i+";bo:gb-"+h+";"+t+"&cl?"+d+";"+t+","+t+"&cb?gb-"+h+"/hl?"+i+";bo:gb-"+c+";"+t+"&cl?"+g+";"+t+","+t+"&cb?gb-"+c+"/hl?"+i+";"+ft+";"+r+"&cl?b:#A6A6A6;"+t+","+k+";"+t+"/hl?"+i+";"+tt+";"+r+"&cl?b:#BDD7EE;"+t+","+v+";"+t+"/hl?"+i+";"+ht+";"+r+"&cl?b:#F8CBAD;"+t+","+d+";"+t+"/hl?"+i+";"+nt+";"+r+"&cl?b:#FFE699;"+t+","+g+";"+t+"/hl?"+i+";"+st+";"+t+";bo:gb-"+o+"&cl?b:#A7A7A7;"+t+","+st+";"+t+"&cb?gb-"+o+"/hl?"+i+";b:#DBECF6;"+t+";bo:gb-"+s+"&cl?b:#BED8F1;"+t+","+v+";"+t+"&cb?gb-"+s+"/hl?"+i+";"+et+";"+t+";bo:gb-"+h+"&cl?b:#F6CAAD;"+t+","+et+";"+t+"&cb?gb-"+h+"/hl?"+i+";"+ot+";"+t+";bo:gb-"+c+"&cl?b:#FDE18D;"+t+","+ot+";"+t+"&cb?gb-"+c+"/hl?"+i+";"+y+";"+r+"&cl?b:#404040;"+r+",b:#737373;"+r+"/hl?"+i+";"+y+";"+r+"&cl?b:#2F75B5;"+r+","+tt+";"+r+"/hl?"+i+";"+y+";"+r+"&cl?b:#C65911;"+r+","+ht+";"+r+"/hl?"+i+";"+y+";"+r+"&cl?b:#BF8F00;"+r+","+nt+";"+r,lt=e._getLocStr("FATHeaderText").split("/"),vt=e._getLocStr("FormatAsTableTitle").split("/"),yt=["Light1","Light2","Light3","Light5","Light8","Light9","Light10","Light12","Light15","Light16","Light17","Light19","Medium8","Medium9","Medium10","Medium12","Medium22","Medium23","Medium24","Medium26","Dark1","Dark2","Dark3","Dark5"],ct=ct.split("/");u<24;)l=l+e._renderDIV("e-formatastablecell",'<div class="e-ss-cellstyles-'+(u+1)+'" ><\/div>'),u===at[rt]&&(l+="<\/br>",rt++),u++;for(u=0,l=l.split("<\/br>");u<lt.length*2;)ut+=e._renderDIV(u%2==0?"e-formatastableheader":"e-formatastablecontent",u%2==0?lt[u/2]:l[0]),u%2!=0&&l.shift(),u++;for(f=document.getElementById(e._id+"_formatastable"),f.innerHTML=ut,f=n(f),a=f.find(".e-formatastablecell"),u=0,it=a.length;u<it;)n(a[u]).attr("id","Table Style "+yt[u]),n(a[u]).attr("title","Table Style "+vt[u]),u++;return e.XLFormat&&(e.XLFormat._formatAsTableStyle=e._FATStyles.TableStyleLight1),f.find(".e-formatastableheader:eq(0)").append("<span id ='"+e._id+"_formatastable_back' class = 'e-formatastable-back e-icon e-ss-leftarrow'/>"),f.data("ejMenu").model.open=function(){f.scrollTop(0)},f},_renderFATNameDlg:function(){var r,i=this.XLObj,u=i._getLocStr("FATNameDlgText").split("/"),f={showRoundedCorner:!0,width:"27%",click:n.proxy(this._fatNameDlgBtnClick,this)};r="<div id="+i._id+'_fatnamedlg><div class="e-dlg-fields e-dlgctndiv e-ss-nmdlg"><table cellspacing="0" cellpadding="0"><tr><td>'+u[0]+'<\/td><td><input id="'+i._id+'_fatname" class="ejinputtext" /><\/td><\/tr><tr class="e-dlgtd-fields"><td><\/td><td><input type="checkbox" id="'+i._id+'_fatheader" style="background-color:#ffffff"/> <label for="'+i._id+'_fatheader" class="e-ss-fathdr">'+u[1]+'<\/label><\/td><\/tr><\/table><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_fatnamedlgok>"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_fatnamedlgcancel>"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(r);n("#"+i._id+"_fatheader").ejCheckBox();n("#"+i._id+"_fatnamedlgok").ejButton(f);n("#"+i._id+"_fatnamedlgok").ejButton("option","cssClass","e-ss-okbtn");n("#"+i._id+"_fatnamedlgcancel").ejButton(f);n("#"+i._id+"_fatnamedlg").ejDialog({showOnInit:!1,width:"auto",showRoundedCorner:!0,title:i._getLocStr("FormatAsTable"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_renderChartNameDlg:function(){var r,i=this.XLObj,f=i._getLocStr("ChartTitleDlgText"),u={showRoundedCorner:!0,width:"23%",click:n.proxy(this._chartNameDlgBtnClick,this)};r="<div id="+i._id+'_chartnamedlg ><div class="e-dlg-fields e-dlgctndiv"><table cellpadding="0" cellspacing="0"><tr><td>'+f+'<\/td><td><input id="'+i._id+'_chartname" class="ejinputtext" /><\/td><\/tr><\/table><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_chartnamedlgok >"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_chartnamedlgcancel>"+i._getLocStr("Cancel")+"<\/button><\/div><\/div>";i.element.append(r);n("#"+i._id+"_chartnamedlgok").ejButton(u);n("#"+i._id+"_chartnamedlgok").ejButton("option","cssClass","e-ss-okbtn");n("#"+i._id+"_chartnamedlgcancel").ejButton(u);n("#"+i._id+"_chartnamedlg").ejDialog({showOnInit:!1,width:"334px",minHeight:"auto",showRoundedCorner:!0,title:i._getLocStr("ChartTitle"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_renderFATResizeTableDlg:function(){var i=this.XLObj,r={showRoundedCorner:!0,width:"15%",click:n.proxy(this._fatResizeTableBtnClick,this)},u="<div id="+i._id+'_fatresizetabledlg ><div class="e-dlgctndiv"><table><tr><td>'+i._getLocStr("FATResizeTableText")+'<\/td><td style="width: 50%;"><input id="'+i._id+'_fatresizetablerange" class="ejinputtext" style="margin-left: 2px;"><\/td><\/tr><\/table><div class="e-dlg-fields">'+i._getLocStr("FATReizeTableNote")+'<\/div><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_fatresizetabledlgok >"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_fatresizetabledlgcancel >"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(u);n("#"+i._id+"_fatresizetabledlgok").ejButton(r);n("#"+i._id+"_fatresizetabledlgok").ejButton("option","cssClass","e-ss-okbtn");n("#"+i._id+"_fatresizetabledlgcancel").ejButton(r);n("#"+i._id+"_fatresizetabledlg").ejDialog({showOnInit:!1,width:"494px",showRoundedCorner:!0,title:i._getLocStr("ResizeTable"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_fatResizeTableBtnClick:function(t){var r=this.XLObj,h,f=document.getElementById(r._id+"_fatresizetablerange").value,o=r.getActiveSheetIndex(),i=document.getElementById(r._id+"_tableid").value,u=r.getSheet(o).tableManager,c,s,e={sheetIndex:o,reqType:"format-table",action:"Design_Tools_ResizeTable",tableId:i},l=!0;t.model.text===r._getLocStr("Ok")&&(r._isvalidRange(f)?(f=f.indexOf(":")!=-1?r.getRangeIndices(f):[],h=this._validateResizeRange(f,u[i].range),h?r._showAlertDlg("Alert",h,"",500):(e.beforeRange=n.extend(!0,[],u[i].range),u[i].totalRow?(c=n("#"+r._id+"_Ribbon_Design_TableStyleOptions_TotalRow").data("ejCheckBox"),r._dupDetails=!0,c.option("checked",!1),u[i].range=[f[0],f[1],f[2]-1,f[3]]):u[i].range=f,this._isFilterSelect.isFiltered&&r.XLFilter._clearFilterTable(o,parseInt(i),!0),r.XLFormat._createTable(i,{format:u[i].format}),r.XLFilter._extendFilterRange(i,u[i].range),u[i].range[2]==f[2]-1&&(r._dupDetails=!0,c.option("checked",!0)),u[i].firstColumn&&(r._dupDetails=!0,s=r._getProperAlphaRange(o,u[i].range[0]+1,u[i].range[1],u[i].range[2],u[i].range[1]),r.XLFormat.format({style:{"font-weight":"bold"}},s),r._dupDetails=!1),u[i].lastColumn&&(r._dupDetails=!0,s=r._getProperAlphaRange(o,u[i].range[0]+1,u[i].range[3],u[i].range[2],u[i].range[3]),r.XLFormat.format({style:{"font-weight":"bold"}},s),r._dupDetails=!1),e.afterRange=f,e.format=u[i].format,e.formatName=u[i].formatName,e.header=n.extend(!0,{},r.model.sheets[o]._header),e.isFilter=u[i].isFilter,e.firstColumn=u[i].firstColumn,e.lastColumn=u[i].lastColumn,e.totalRow=u[i].totalRow,r.XLSelection.selectRange(u[i].range),r._completeAction(e),r._trigActionComplete(e))):(l=!1,r._showAlertDlg("Alert","InvalidReference","",375)));l&&n("#"+r._id+"_fatresizetabledlg").ejDialog("close")},_fatNameDlgBtnClick:function(t){var r,i=this.XLObj,u=i._id;n("#"+u+"_fatnamedlg").ejDialog("close");t.model.text===i._getLocStr("Ok")&&(r={header:n("#"+u+"_fatheader").ejCheckBox("checked"),name:document.getElementById(u+"_fatname").value,format:i.XLFormat._formatAsTableStyle.format},i.XLFormat._formatAsTableStyle.formatName&&(r.formatName=i.XLFormat._formatAsTableStyle.formatName),i.XLFormat.createTable(r))},_validateResizeRange:function(n,t){var i=this.XLObj;if(n.length){if(n[0]!=t[0]||n[1]!=t[1])return"ResizeAlert";if(n[3]!=t[3]||n[2]<t[2])return"ResizeRestrictAlert";if(n[2]>i.getSheet(i.getActiveSheetIndex()).rowCount)return"RangeNotCreated"}else return"InvalidReference"},_chartNameDlgBtnClick:function(t,i,r){var o,f,u=this.XLObj,c=u.getActiveSheetIndex(),h=u.getSheet(c).shapeMngr.chart[u.XLEdit.getPropertyValue(u.XLShape._picCellIdx.rowIndex,u.XLShape._picCellIdx.colIndex,"chart")[0]],e,s=u._id,l=document.getElementById(s+"_chart").value;if(o=n("#"+l).data("ejChart"),f={sheetIndex:c,reqType:"shape",shapeType:"chart",cid:l,rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,prev:{},cur:{}},e=i||document.getElementById(s+"_chartname").value,t.model.text===u._getLocStr("Ok")){if(!e.length){u._showAlertDlg("Alert","InvalidTitle","InvalidChartTitleActn",375);return}switch(u._hasTitle){case"PX":o.option("primaryXAxis",{title:{text:e}});h.xAxis.title.text=e;f.action="PX";f.operation=r?r:"PHAxisTitle";break;case"PY":o.option("primaryYAxis",{title:{text:e}});h.yAxis.title.text=e;f.action="PY";f.operation=r?r:"PVAxisTitle";break;case"CT":o.option("title",{text:e});h.title.text=e;f.action=f.operation="CT"}}f.prev.text=u._cOpt.prevText;u._hasTitle=="CT"&&(f.prev.align=u._cOpt.prevAlign,f.cur.align=u._cOpt.curAlign);f.cur.text=e;u._completeAction(f);u._trigActionComplete(f);u._cOpt={};document.getElementById(s+"_chartname").value="";n("#"+s+"_chartnamedlg").ejDialog("close")},_designTabUpdate:function(t,i){var r=this.XLObj;if(r.model.showRibbon&&!r._phoneMode){var u=r._id,e,o=n("#"+r._id+"_Ribbon").ejRibbon("instance"),f=r.getSheet(r.getActiveSheetIndex()).tableManager;o.showTab(r._getLocStr("Design"));this._isDesignTab&&!o._isCollapsed&&o.option({selectedItemIndex:this._getTabIndex("design")});document.getElementById(r._id+"_Ribbon_Design_Properties_TableName")&&(document.getElementById(r._id+"_Ribbon_Design_Properties_TableName").value=f[t].name);document.getElementById(r._id+"_tableid")&&(document.getElementById(r._id+"_tableid").value=t);this._isSetModel=!0;n("#"+u+"_Ribbon_Design_TableStyleOptions_TotalRow").data("ejCheckBox").option({checked:f[t].totalRow?!0:!1});n("#"+u+"_Ribbon_Design_TableStyleOptions_FirstColumn").data("ejCheckBox").option({checked:f[t].firstColumn?!0:!1});n("#"+u+"_Ribbon_Design_TableStyleOptions_LastColumn").data("ejCheckBox").option({checked:f[t].lastColumn?!0:!1});n("#"+u+"_Ribbon_Design_TableStyleOptions_FilterColumn").data("ejCheckBox").option({enabled:r.model.allowFiltering?!0:!1});n("#"+u+"_Ribbon_Design_TableStyleOptions_FilterColumn").data("ejCheckBox").option({checked:f[t].isFilter?!0:!1});this._isSetModel=!1;e=n("#"+r._id+"_Ribbon_Data_SortFilter_ClearFilter").data("ejButton");e&&this._changeClrFltrStatus(e,"button",i)}},_formatTabUpdate:function(){var t=this.XLObj;if(t.model.showRibbon&&!t._phoneMode){var i=n("#"+t._id+"_Ribbon").ejRibbon("instance"),r=t.element.find("#"+t._id+"_Ribbon_Format_Size_PictureHeight"),u=t.element.find("#"+t._id+"_Ribbon_Format_Size_PictureWidth");i.showTab(t._getLocStr("FORMAT"));t._shapeChange=!0;r.length&&r.ejNumericTextbox("option","value",t.element.find(".e-ss-activeimg").height());u&&u.ejNumericTextbox("option","value",t.element.find(".e-ss-activeimg").width());t.model.showRibbon&&!i._isCollapsed&&i.option({selectedItemIndex:t.XLRibbon._getTabIndex("format")});t._shapeChange=!1}},_analyzeTabUpdate:function(){var t=this.XLObj,r,i;if(!t.model.enablePivotTable)return!1;r=t.element.find("#"+t._id+"_Ribbon_Analyze_PivotTable_PivotTableName");i=n("#"+t._id+"_Ribbon").data("ejRibbon");r.length&&r.val(t.XLPivot.names[t._getContent(t.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id]);i.showTab(t._getLocStr("ANALYZE"));i._isCollapsed||i.option({selectedItemIndex:t.XLRibbon._getTabIndex("analyze")})},_chartDesignTabUpdate:function(t){var i=this.XLObj,e,u,f;if(i.model.showRibbon&&!i._phoneMode){var r=n("#"+i._id+"_Ribbon").data("ejRibbon"),o=t.get(0).id,c=t.get(0).offsetLeft,l=t.get(0).offsetTop,s=t.ejChart("model"),h=r.element.find("#"+i._id+"_Ribbon_ChartDesign_ChartThemes_ChartThemes");u=i._getIdxWithOffset(l,c,!0);i.XLShape._picCellIdx={rowIndex:u.rowIdx,colIndex:u.colIdx};r.showTab(i._getLocStr("CHARTDESIGN"));e=i.XLChart._getShapeObj(o,"chart");f=e.isChartSeries?"disable":"enable";n("#"+i._id+"_Ribbon_ChartDesign_Data_SelectData").ejButton(f);n("#"+i._id+"_Ribbon_ChartDesign_Data_SwitchRowColumn").ejButton(f);r._isCollapsed||r.option({selectedItemIndex:i.XLRibbon._getTabIndex("chartdesign")});document.getElementById(i._id+"_chart").value=o;this._isSetModel=!0;this._setShapeWidthHeight({height:s.size.height,width:s.size.width,shapeType:"chart"});h.length&&h.ejDropDownList("setSelectedValue",t.ejChart("option","theme"));this._isSetModel=!1;i.model.allowFormulaBar&&i.updateFormulaBar()}},_setShapeWidthHeight:function(t){var i=this.XLObj,r,u;t.shapeType=="chart"?(r=n("#"+i._id+"_Ribbon_ChartDesign_Size_ChartWidth").data("ejNumericTextbox"),u=n("#"+i._id+"_Ribbon_ChartDesign_Size_ChartHeight").data("ejNumericTextbox")):(r=n("#"+i._id+"_Ribbon_Format_Size_PictureWidth").data("ejNumericTextbox"),u=n("#"+i._id+"_Ribbon_Format_Size_PictureHeight").data("ejNumericTextbox"));i._shapeChange=!0;i.model.showRibbon&&(u.option({value:t.height}),r.option({value:t.width}));i._shapeChange=!1},changeDimension:function(t){var u=this.XLObj,h=u.getActiveSheetIndex(),o,c,e,s,f,i={sheetIndex:h,reqType:"shape",rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,actionType:"shapechange"},r;t.shapeType=="picture"?(o=u.getSheetElement(h).find(".e-ss-activeimg"),f=o.length?o[0]:n("#"+t.id),i.prev={width:f.width(),height:f.height()},c=n("#"+t.id),e={width:t.width,height:t.height},c.css(e),i.action="picturesize",i.shapeType="picture",i.cur={width:f.width(),height:f.height()}):(r=n("#"+t.id).data("ejChart"),i.prev={width:r.model.size.width,height:r.model.size.height},e={width:t.width.toString(),height:t.height.toString()},s=r.element,r.option("size",e),s[0].style.height=t.height+"px",s[0].style.width=t.width+"px",i.action="width",i.shapeType="chart",i.cid=t.id,i.cur={width:r.model.size.width,height:r.model.size.height});u._completeAction(i);u._trigActionComplete(i);this._setShapeWidthHeight(t)},_toggleDesignTab:function(i){var r=this.XLObj,f,u,e=r.getActiveSheetIndex();r.model.showRibbon&&(u=n("#"+r._id+"_Ribbon").data("ejRibbon"),(t.isNullOrUndefined(r.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"tableName"))||r.getSheetElement(e).find(".e-ss-activeimg").length)&&(u.hideTab(r._getLocStr("Design")),u._isCollapsed||u.option({selectedItemIndex:1})));f=n("#"+r._id+"_Ribbon_Data_SortFilter_ClearFilter").data("ejButton");this._changeClrFltrStatus(f,"button",i)},_toggleChartDesignTab:function(){this._toggleContextualTab(this.XLObj._getLocStr("CHARTDESIGN"))},_toggleFormatTab:function(){this._toggleContextualTab(this.XLObj._getLocStr("FORMAT"))},_toggleAnalyzeTab:function(){this._toggleContextualTab(this.XLObj._getLocStr("ANALYZE"))},_toggleContextualTab:function(t){var r=this.XLObj,i;r.model.showRibbon&&(i=n("#"+r._id+"_Ribbon").data("ejRibbon"),i.hideTab(t),i._isCollapsed||i.option({selectedItemIndex:1}))},_getTabIndex:function(t){if(this.XLObj.model.showRibbon){for(var u=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("model"),r=u.tabs,f=u.contextualTabs,i=0;i<f.length;)r=r.concat(f[i].tabs),i++;for(i=r.length;i--;)if(r[i].id===t)return++i}},_getFormatAsTableInput:function(n){var h=this.XLObj,t,r,e,i,o=0,u=0,c=[],s={hl:"headerLayout",cl:"contentLayout",hb:"headerBorder",cb:"contentBorder"},f={};for(n=n.split("&");o<n.length;){if(e=n[o].split("?"),t=e[0],r=e[1],t==="hl")f[s[t]]=h._getStyleAsJSON(r,!0);else if(t==="cl"){for(i=r.split(",");u<i.length;)c.push(i[u].length?h._getStyleAsJSON(i[u],!0):{}),u++;f[s[t]]=c}else t==="cb"&&(i=r.split("-"),f[s[t]]={border:this._getBorderObj(i[0],i[1])});o++}return f},_getBorderObj:function(n,t){var r,i={t:{top:""},r:{right:""},b:{bottom:""},l:{left:""},o:{top:"",right:"",bottom:"",left:""},tb:{top:"",bottom:""},gb:{top:"",right:"",bottom:"",left:""}};for(r in i[n])i[n][r]=t;return n==="gb"&&(i[n].isGridBorder=!0),i[n]},_renderCellStyles:function(){for(var s,r,t=0,e=4,o=[],h="e-cellstylecell ",i="",u=this.XLObj,f=u._dataContainer.hashCode,l=u._getLocStr("CellStyleHeaderText").split("/"),v=u._getLocStr("CellStyleGBN").split("/"),y=[f[0],f[1],f[2],f[3]],p=u._getLocStr("CellStyleTH").split("/"),a=f.slice(4,6),w=u._getLocStr("CellsStyleTCS").split("/"),b=f.slice(6,18),c;t<e;)r=v[t],i=i+u._renderDIV(h+y[t],r,r),t++;for(o.push(i),i="",t=0,e=2;t<e;)r=p[t],i=t===1?i+'<div class="'+h+a[t]+'"  style="font-size: 11pt;" title="'+r+'">'+r+"<\/div>":i+u._renderDIV(h+a[t],r,r),t++;for(o.push(i),i="",t=0,e=12;t<e;)r=w[t],i=i+u._renderDIV(h+b[t],r,r),t++;for(o.push(i),i="",t=0;t<l.length*2;)s=t%2,i=i+u._renderDIV(s===0?"e-cellstyleheader":"e-cellstylecontent",s===0?l[t/2]:o[0]),s!=0&&o.shift(),t++;return c=n("<div id="+u._id+'_cellstyles class="e-spreadsheet e-cellstyles" style="display:none;">'+i+"<\/div>"),c.find(".e-cellstyleheader:eq(0)").append("<span id ='"+u._id+"_cellstyles_back' class = 'e-cellstyles-back e-icon e-ss-leftarrow'/>"),c},_homeTabTrgtElem:function(){var r=this.XLObj,u=r._id,n=r.element,i=u+"_Ribbon_",f=i+"Home_Font_";n.append(t.buildTag("input","",{display:"none"},{id:f+"FillColor",type:"text"}));n.append(t.buildTag("input","",{display:"none"},{id:f+"FontColor",type:"text"}));n.append(t.buildTag("input","",{display:"none"},{id:f+"BorderColor",type:"text"}));n.append(t.buildTag("div.e-spreadsheet e-formatastable","",{display:"none"},{id:r._id+"_formatastable"}));n.append(this._renderCellStyles());n.append(t.buildTag("ul","",{display:"none"},{id:u+"_Ribbon_Merge"}));n.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:i+"Paste"}));n.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:i+"Border"}));n.append(t.buildTag("ul.e-spreadsheet","",{display:"none"},{id:u+"_CFormat"}));n.append(t.buildTag("ul","",{display:"none"},{id:i+"Clear"}));n.append(t.buildTag("ul","",{display:"none"},{id:i+"SortFilter"}));n.append(t.buildTag("ul","",{display:"none"},{id:i+"AutoSum"}))},_pageTabTrgtElem:function(i){var f=this.XLObj,p=f._id,g=f.element,e,o,s,h,c,l,a,v,y,w,b,k,d,r=p+"_Ribbon_",u=r+"PageLayout_Show_";i=f.isUndefined(i)?n("#"+p+"_Ribbon").data("ejRibbon").element:i;g.append(t.buildTag("ul","",{display:"none"},{id:r+"PageSize"}));e=t.buildTag("div","",{width:"140",height:"80",display:"none"},{id:r+"pagesetup"});o=t.buildTag("div","",{width:"70",height:"80",float:"left"},{id:r+"pagesetupleft"});s=t.buildTag("table");a=t.buildTag("tr");v=t.buildTag("tr");h=t.buildTag("td","",{padding:"6px 0px 6px 6px"});c=t.buildTag("td","",{padding:"6px 0px 6px 6px"});l=t.buildTag("td","",{padding:"6px 0px 6px 6px"});y=t.buildTag("td","",{padding:"6px 0px 6px 6px"});w=t.buildTag("label.e-viewlinlbl","",{width:"40"},{id:r+"pagesetup_viewgrdlnlbl","for":u+"Gridlines"});b=t.buildTag("label.e-viewhdrlbl","",{width:"40",display:"visible"},{id:r+"pagesetup_viewhdrlbl","for":u+"Headings"});k=t.buildTag("input","","",{id:u+"Headings",type:"checkbox"});d=t.buildTag("input","","",{id:u+"Gridlines",type:"checkbox"});h.append(d);c.append(w);a.append(h).append(c);l.append(k);y.append(b);v.append(l).append(y);s.append(v).append(a);o.append(s);e.append(o);i.append(e)},_othersTabTrgtElem:function(){var r=this.XLObj,u=r._id,n=r.element,i=u+"_Ribbon_";n.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:i+"FPane"}));n.append(t.buildTag("ul","",{width:"auto"},{id:i+"Ins"}));n.append(t.buildTag("ul","",{width:"auto"},{id:i+"Del"}));n.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:i+"FindRep"}));n.append(t.buildTag("ul","",{display:"none"},{id:i+"CalcOpt"}))},_dataTabTrgtElem:function(){var n=this.XLObj;n.element.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:n._id+"_Ribbon_Validation"}))},_formatTabTrgtElem:function(){var n=this.XLObj;n.element.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:n._id+"_Ribbon_ResetPic"}))},_onBeforeTabClick:function(n){this.XLObj.model.ribbonSettings.enableOnDemand&&this._createTrgtElement(n.activeHeader.innerText)},_onTabClick:function(t){var i=this.XLObj,u=n.extend(!0,{},i.model.scrollSettings),r=t.activeHeader.innerText;i._trigger("beforeTabClick",t);t.prevActiveIndex!==-1&&i.model.allowComments&&i.model.allowEditing&&(i.XLEdit._isEdit||i.XLComment._isCommentEdit||i._isSheetRename||!i.getSheet(i.getActiveSheetIndex()).isSheetProtected)&&!this._isDirtySelect&&this._enableRibbonIcons(t.activeIndex);i.model.ribbonSettings.enableOnDemand&&this._createTabControls(r);i._trigger("tabClick",t)},_onCollapse:function(t){var i=this.XLObj,u=n.extend(!0,{},i.model.scrollSettings),r;(this._ribbonState||t.isMobile)&&(i._phoneMode||(this._ribbonState=!1),t.action="toggleBtn",i._isAutoWHMode?(this._refreshBackstageHeight(),r=i._getElementDimension(),i.element.css({height:r.height,width:r.width})):i._heightWidthCalculation(i.getActiveSheetIndex(),u,t),i.model._isActPanelVisible&&i._refreshActivationPanel(),i.getSheet(i.getActiveSheetIndex())._isRibCollapsed=!0)},_onTabSelect:function(t){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),f,u;i.model.showRibbon&&(i.XLEdit._isEdit||i.model.allowComments&&i.XLComment._isCommentEdit||i._isSheetRename||r.isSheetProtected?this._disableRibbonIcons():this._enableRibbonIcons(),this._updateRibbonIcons(),i.model.isReadOnly&&i._readOnly(),i._phoneMode&&(f=n.extend(!0,{},i.model.scrollSettings),this._ribbonState=!0,t.action="toggleBtn",i.model._isActPanelVisible=this._isPanelVisible,i._isAutoWHMode?(this._refreshBackstageHeight(),u=i._getElementDimension(),i.element.css({height:u.height,width:u.width})):i._heightWidthCalculation(i.getActiveSheetIndex(),f,t)));i.XLEdit.getPropertyValue(r._activeCell.rowIndex,r._activeCell.colIndex,"tableName")&&(this._isDesignTab=t.activeIndex==this._getTabIndex("design")||t.activeIndex==this._getTabIndex("format")||t.activeIndex==this._getTabIndex("chartdesign"));i._trigger("tabSelect",t)},_valDTypeOnChange:function(t){var i=this.XLObj;n.validator&&n("#"+i._id+"_Form_ValDialog").validate().resetForm();t.value==="Between"||t.value==="NotBetween"?(n("#"+i._id+"_Ribbon_lbMax").show(),n("#"+i._id+"_Ribbon_btnMax").show(),n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr("NumberStart"))):(n("#"+i._id+"_Ribbon_lbMax").hide(),n("#"+i._id+"_Ribbon_btnMax").hide(),n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr("DataValue")));this._dialogValidate("_ValDialog")},_valTypeOnChange:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList");r.enable();t.model.dataSource[t.model.selectedItemIndex].value==="list"?(n("#"+i._id+"_Ribbon_lbMax").hide(),n("#"+i._id+"_Ribbon_btnMax").hide(),r.disable()):(r._selectedValue==="Between"||r._selectedValue==="NotBetween")&&(n("#"+i._id+"_Ribbon_lbMax").show(),n("#"+i._id+"_Ribbon_btnMax").show());n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr(t.selectedText+"Start"));n("#"+i._id+"_Ribbon_lbMax").text(i._getLocStr(t.selectedText+"End"));this._dialogValidate("_ValDialog")},_valDlgBtnClick:function(t){var i=this.XLObj,f,e;if(t==="ok"&&n.validator&&n("#"+i._id+"_Form_ValDialog").valid()){var s=n("#"+i._id+"_Ribbon_blank").data("ejCheckBox"),h=n("#"+i._id+"_Ribbon_freetext").data("ejCheckBox").isChecked(),o=n("#"+i._id+"_Ribbon_ddType").data("ejDropDownList"),v=n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList");if(o._selectedValue==="List"){var r=n("#"+i._id+"_Ribbon_btnMin").val(),a=r,c,u,f=n("#"+i._id+"_alertdlg"),l;if(r.indexOf("=")>-1){if(r=r.split("=")[1],r.indexOf("!")>-1&&(c=r.split("!"),e=i._getSheetIndexByName(c[0]),r=c[1]),e===!1){i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}if(r.indexOf("$")>-1&&(r=r.split("$").join("")),r.indexOf(":")<0&&(r=r+":"+r),e=i.isUndefined(e)?i.getActiveSheetIndex():e,l=i.getSheet(e),u=i.getRangeIndices(r),isNaN(u[0])||isNaN(u[1])||isNaN(u[2])||isNaN(u[3])||l.colCount<=u[3]||l.rowCount<=u[2]){i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}if(u[2]===u[0]||u[3]===u[1])i.XLValidate.applyDVRules(null,["list",a],this._types[o.selectedIndexValue].value,s.isChecked(),h);else{i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListValAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}}else i.XLValidate.applyDVRules(null,["list",a],this._types[o.selectedIndexValue].value,s.isChecked(),h)}else i.XLValidate.applyDVRules(null,[this._actions[v.selectedIndexValue].value,n("#"+i._id+"_Ribbon_btnMin").val(),n("#"+i._id+"_Ribbon_btnMax").val()],this._types[o.selectedIndexValue].value,s.isChecked(),h);i._setddlCell()}else n.validator||(t="cancel");(t==="cancel"||t==="ok"&&n.validator&&n("#"+i._id+"_Form_ValDialog").valid())&&(n("#"+i._id+"_Ribbon_ddType").data("ejDropDownList").option({selectedItemIndex:0}),n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList").option({selectedItemIndex:6}),n("#"+i._id+"_Ribbon_blank").data("ejCheckBox").option({checked:!0}),n("#"+i._id+"_Ribbon_freetext").data("ejCheckBox").option({checked:!0}),n("#"+i._id+"_Ribbon_btnMin").val(""),n("#"+i._id+"_Ribbon_btnMax").val(""),n("#"+i._id+"_ValDialog").ejDialog("close"),i.setSheetFocus())},_renderValDialog:function(){var i=this.XLObj,h,e,v,o,c,u,a,y,p;if(n("#"+i._id+"_Ribbon_MainDiv").length<1){h=t.buildTag("div.e-dlgctndiv","",{},{height:"100%"});e=t.buildTag("div.e-dlg-fields","",{},{id:i._id+"_Ribbon_MainDiv"});n("#"+i._id+"_Validation").append(h);n("#"+i._id+"_Validation").append(e);o=t.buildTag("label.e-dlg-fields",i._getLocStr("Allow"));e.append(o);c=t.buildTag("input.e-"+i._id+"-ddl","","",{id:i._id+"_Ribbon_ddType",type:"text"});e.append(c);c.ejDropDownList({dataSource:this._types,fields:{id:"Types",text:"text",value:"text"},selectedItemIndex:1,cssClass:"e-"+i._id+"-ddl",width:"100%",change:n.proxy(this._valTypeOnChange,this)});var s=t.buildTag("input#"+i._id+"_Ribbon_blank"),l=t.buildTag("label",i._getLocStr("IgnoreBlank"),{},{"for":i._id+"_Ribbon_blank"}),f=t.buildTag("table"),u=t.buildTag("tr"),r=t.buildTag("td","",{},{width:30});r.append(s);u.append(r);r=t.buildTag("td");r.append(l);u.append(r);f.append(u);s.ejCheckBox();s=t.buildTag("input#"+i._id+"_Ribbon_freetext");l=t.buildTag("label#"+i._id+"_Ribbon_lblfreetext",i._getLocStr("FreeText"),{},{"for":i._id+"_Ribbon_lblfreetext"});u=t.buildTag("tr#"+i._id+"_val_freetext");r=t.buildTag("td","",{},{width:30});r.append(s);u.append(r);r=t.buildTag("td");r.append(l);u.append(r);f.append(u);e.append(f);s.ejCheckBox({checked:!0});o=t.buildTag("label.e-dlg-fields").text(i._getLocStr("Data"));e.append(o);a=t.buildTag("input.e-"+i._id+"-ddl","","",{id:i._id+"_Ribbon_ddAction",type:"text"});e.append(a);a.ejDropDownList({dataSource:this._actions,fields:{id:"Types",text:"text",value:"value"},selectedItemIndex:6,cssClass:"e-"+i._id+"-ddl",width:"100%",change:n.proxy(this._valDTypeOnChange,this)});v=t.buildTag("div.e-dlgctndiv e-dlg-fields","",{},{id:i._id+"_Ribbon_SubDiv"});f=t.buildTag("table");u=t.buildTag("tr");r=t.buildTag("td");o=t.buildTag("label.e-dlg-fields","","",{id:i._id+"_Ribbon_lbMin"}).text(i._getLocStr("NumberStart"));f.append(u.append(r.append(o)));u=t.buildTag("tr");r=t.buildTag("td");y=t.buildTag("input.ejinputtext","",{width:"100%"},{id:i._id+"_Ribbon_btnMin",type:"text",name:i._id+"_valMin"});f.append(u.append(r.append(y)));u=t.buildTag("tr");r=t.buildTag("td");o=t.buildTag("label.e-dlg-fields","","",{id:i._id+"_Ribbon_lbMax"}).text(i._getLocStr("NumberEnd"));f.append(u.append(r.append(o)));u=t.buildTag("tr");r=t.buildTag("td");p=t.buildTag("input.ejinputtext","",{width:"100%"},{id:i._id+"_Ribbon_btnMax",type:"text",name:i._id+"_valMax"});f.append(u.append(r.append(p)));h.append(e,v.append(f));n("#"+i._id+"_Ribbon_SubDiv").wrapInner('<form id="'+i._id+'_Form_ValDialog" onsubmit="return false"><\/form>')}},_dialogValidate:function(t,i){var f=this.XLObj,e=f._id,l,tt=n("#"+e+"_Form"+t),o,r,a,v,s,y,p,u,w,b,h,k=!0,c,d,g,nt;if(n.validator){tt.validate({errorElement:"div",wrapper:"div",errorPlacement:function(n,t){n.insertAfter(t.closest("input"));n.children().addClass("e-dlg-field-validation-error");n.css({position:"relative"});n.offset({left:t.offset().left,top:t.offset().top+19})},onfocusout:function(n){this.element(n)}});c=n("#"+e+"_Ribbon_ddAction").ejDropDownList("getValue");switch(t){case"_ValDialog":l=n("#"+e+"_Ribbon_ddType").data("ejDropDownList");o=l.getSelectedValue();break;case"_CFDialog":o=i===e+"_CreateRule"?"formulaRule":i.charAt(0).toUpperCase()+i.slice(1).toLowerCase();break;case"_GoToDiv":case"_Ribbon_PvtRange":case"_Ribbon_PvtLocation":case"_Ribbon_cellAddress":o="cellAddr";break;case"_xlFileName":case"_Ribbon_webAddress":o="webAddr"}for(n("#"+e+"_Form"+t).validate().resetForm(),u=[],p=n("#"+e+"_Form"+t).find("input").length,y={required:!0,date:!0,messages:{date:f._getLocStr("DateValidationMsg"),required:f._getLocStr("RequiredField")}},v={required:!0,celladdr:!0},w={required:!0,numberVal:!0},g={required:!0,number:!0,messages:{required:f._getLocStr("RequiredField"),number:f._getLocStr("NumberValidationMsg")}},b={required:!0,time:!0},s={required:!0},d={required:!0,betweentype:!0},nt={required:!0,formularule:!0},n.validator.addMethod("time",function(n){return n===""||n.match(/^(([0-1]?[0-9])|([2][0-3])):([0-5]?[0-9])(:([0-5]?[0-9]))?(\s(AM|am|PM|pm))?$/)},f._getLocStr("TimeValidationMsg")),n.validator.addMethod("date",function(n,t){var i=n.split("/");return this.optional(t)||!/Invalid|NaN/.test(new Date(/chrom(e|ium)/.test(navigator.userAgent.toLowerCase())?n:i[1]+"/"+i[0]+"/"+i[2]))},f._getLocStr("DateValidationMsg")),n.validator.addMethod("celladdr",function(t,i){var f,o=n(i).data("parentID"),r=n("#"+o).data("ejSpreadsheet"),u,e;return n("#"+r._id+"_Ribbon_sheentName").length&&(u=n("#"+r._id+"_Ribbon_sheentName").ejTreeView("option","selectedNode")),(r.isUndefined(u)||u<0)&&(u=r.getActiveSheetIndex()),t.indexOf("=")>-1&&(t=t.split("=")[1]),t.indexOf("!")>-1&&(h=t.split("!"),u=r._getSheetIndexByName(h[0]),t=h[1]),u<1&&(k=!1),e=r.getSheet(u),t.indexOf("$")>-1&&(t=t.split("$").join("")),f=r.getRangeIndices(t),f=e.colCount<=f[3]||e.rowCount<=f[2]?null:t,(t.match(/^(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9]):(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9])$/)||t.match(/^(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9])$/)&&k)&&f},f._getLocStr("CellAddrsValidationMsg")),n.validator.addMethod("betweentype",function(t,i){var e=i.id.split("_")[0],f=n("#"+i.id.split("_")[0]+"_Ribbon_ddType").ejDropDownList("getSelectedValue"),r=n("#"+e+"_Ribbon_btnMin").val(),u=n("#"+i.id.split("_")[0]+"_Ribbon_btnMax").val();return(r===""||u===""||parseFloat(r)>parseFloat(u))&&(t=null),f==="Date"&&Date.parse(r)>Date.parse(u)&&(t=null),f==="Time"&&new Date("01/01/1990 "+r).getTime()>new Date("01/01/1990 "+u).getTime()&&(t=null),t},f._getLocStr("BetweenAlert")),n.validator.addMethod("numberVal",function(t){if(n.isNumeric(t))return parseFloat(t)%1!=0&&(t=null),n.validator.messages.numberVal=f._getLocStr("NumberValMsg"),t;n.validator.messages.numberVal=f._getLocStr("NumberAlertMsg")},n.validator.messages.numberVal),n.validator.addMethod("formularule",function(n){return n===""||n.startsWith("=")&&n.indexOf("!")<0},f._getLocStr("FormulaRuleMsg")),r=0,a=p;r<a;r++){u[r]=n("#"+e+"_Form"+t).find("input")[r].id;switch(o){case"Date":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",y);break;case"Time":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",b);break;case"Number":case"TextLength":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",w);break;case"Decimal":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",g);break;case"List":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",s);break;case"cellAddr":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",v);break;case"webAddr":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",s);break;case"formulaRule":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",nt)}o!=="List"&&(c==="Between"||c==="NotBetween")&&n("#"+e+"_Ribbon_btnMax").rules("add",d)}}},_renderCFDialog:function(i){var u,o,f,e,s,r=this.XLObj,h;s=n("#"+r._id+"_CFDialog").data("ejDialog");i.ID===r._id+"_CreateRule"?s.option({title:r._getLocStr("NewRule")}):s.option({title:r._getLocStr(this._cFormatData[i.ID][0])});n("#"+r._id+"_Ribbon_CFSubDiv").length<1&&(o=t.buildTag("div.e-dlg-fields","",{},{id:r._id+"_Ribbon_CFSubDiv"}),f=t.buildTag("label.e-dlg-fields").text(r._getLocStr("With")),o.append(f),h=t.buildTag("input.e-"+r._id+"-ddl","",{},{id:r._id+"_Ribbon_ddStyle",type:"text"}),o.append(h),h.ejDropDownList({dataSource:this._styles,fields:{id:"Types",text:"text",value:"value"},selectedItemIndex:0,cssClass:"e-"+r._id+"-ddl",width:"100%",change:n.proxy(this._ddOnChange,this)}),n("#"+r._id+"_CondFormat").append(o),n("#"+r._id+"_CondFormat").addClass("e-cfdiv"));n("#"+r._id+"_Ribbon_CFMainDiv").length>0&&n("#"+r._id+"_Ribbon_CFMainDiv").remove();u=t.buildTag("div.e-dlg-fields","","",{id:r._id+"_Ribbon_CFMainDiv"});n("#"+r._id+"_CondFormat").prepend(u);i.ID=="between"&&(e=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_input2",type:"text"}),u.prepend(e),f=t.buildTag("label.e-dlg-fields").text(r._getLocStr("And")).css("display","table"),u.prepend(f));e=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_input1",type:"text"});u.prepend(e);f=i.ID===r._id+"_CreateRule"?t.buildTag("label.e-dlg-fields").text(r._getLocStr("NewRuleLabelContent")):t.buildTag("label.e-dlg-fields").text(r._getLocStr(this._cFormatData[i.ID][1]));u.prepend(f);(i.ID==="aboveavg"||i.ID==="belowavg")&&e.hide();n("#"+r._id+"_Ribbon_CFMainDiv").wrapInner('<form id="'+r._id+'_Form_CFDialog" onsubmit="return false"><\/form>');this._dialogValidate("_CFDialog",i.ID)},_dlgCFOk:function(){var t=this.XLObj,i,r;n("#"+t._id+"_Form_CFDialog").valid()&&(i=n("#"+t._id+"_Ribbon_ddStyle").data("ejDropDownList"),r=t.XLRibbon._currentCFormat===t._id+"_CreateRule"?"formularule":t.XLRibbon._currentCFormat,t.XLCFormat._cFormat(r,n("#"+t._id+"_Ribbon_input1").val(),n("#"+t._id+"_Ribbon_input2").val(),i.getSelectedValue()),n("#"+t._id+"_CFDialog").ejDialog("close"),t.setSheetFocus())},_dlgCFCancel:function(){var t=this.XLObj;n("#"+t._id+"_Form_CFDialog").validate().resetForm();n("#"+t._id+"_CFDialog").ejDialog("close");t.setSheetFocus()},_sheetData:function(){var r=this.XLObj,u=[],t=[],n,f,i=r._getSheetNames();for(t[0]={id:1,name:r._getLocStr("SheetReference"),hasChild:!0,expanded:!0},n=1,f=i.length;n<=f;n++)i[n-1].isVisible&&(u[n]=i[n-1].text,t[n]={id:n+1,pid:1,name:u[n],hasChild:!0,expanded:!0});return t},_renderHLDialog:function(){var i=this.XLObj,l,f,e,h,c,s,o,u,a,r;n("#"+i._id+"_Ribbon_WebDiv").length<1&&(l=t.buildTag("div.e-dlgctndiv","",{},{id:i._id+"_Ribbon_WebDiv"}),o=t.buildTag("table","",{},{cellpadding:0,cellspacing:0}),u=t.buildTag("tr"),r=t.buildTag("td","",{width:"32%"}),o.append(u.append(r)),f=t.buildTag("label",i._getLocStr("HyperlinkText")),r.append(f),r=t.buildTag("td"),e=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_findText",type:"text"}),u.append(r.append(e)),u=t.buildTag("tr.e-dlgtd-fields"),r=t.buildTag("td"),o.append(u.append(r)),f=t.buildTag("label",i._getLocStr("WebAddress"),"",{id:i._id+"_Ribbon_address"}),r.append(f),r=t.buildTag("td"),e=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_webAddress",type:"text"}),u.append(r.append(e)),n("#"+i._id+"_Web").append(l.append(o)),h=t.buildTag("div.e-dlgctndiv","","",{id:i._id+"_Ribbon_DocDiv"}),a=t.buildTag("div.e-dlg-fields"),o=t.buildTag("table"),u=t.buildTag("tr"),r=t.buildTag("td","",{width:"32%"}),o.append(u.append(r)),f=t.buildTag("label",i._getLocStr("HyperlinkText")),r.append(f),r=t.buildTag("td"),e=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_cellText",type:"text"}),u.append(r.append(e)),u=t.buildTag("tr.e-dlgtd-fields"),r=t.buildTag("td"),o.append(u.append(r)),f=t.buildTag("label",i._getLocStr("CellAddress")),r.append(f),r=t.buildTag("td"),e=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_cellAddress",type:"text"}),e.data("parentID",i._id),u.append(r.append(e)),s=t.buildTag("div.e-dlg-fields","","",{id:i._id+"_Ribbon_Sheet"}),h.append(a.append(o),s),f=t.buildTag("label",i._getLocStr("SheetIndex")),s.append(f),c=t.buildTag("div","","",{id:i._id+"_Ribbon_sheentName"}),s.append(c),c.ejTreeView({fields:{id:"id",parentId:"pid",text:"name",hasChild:"hasChild",dataSource:this._sheetData(),expanded:"expanded"},nodeSelect:n.proxy(this._sheetSelect,i),height:90}),n("#"+i._id+"_Doc").append(h),n("#"+i._id+"_Ribbon_cellAddress").wrap("<form id='"+i._id+"_Form_Ribbon_cellAddress' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_cellAddress"),n("#"+i._id+"_Ribbon_webAddress").wrap("<form id='"+i._id+"_Form_Ribbon_webAddress' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_webAddress"))},_sheetSelect:function(t){var i,u,f=this._getSheetNames(),r=n("#"+this._id+"_Ribbon_cellAddress"),e=n("#"+this._id+"hlDialog_OkBtn").data("ejButton"),o=n("#"+this._id+"_Ribbon_cellText");if(t.model.selectedNode>0)for(r.attr("disabled",!1),e.enable(),r.focus().setInputPos(1),i=0,u=f.length;i<u;i++)f[i].text===o.val().split("!")[0]&&o.val(t.value+"!"+r.val());else r.attr("disabled",!0),e.disable()},_dlgHLOk:function(){var t=this.XLObj;n("#"+t._id+"_Form_Ribbon_cellAddress").valid()&&n("#"+t._id+"_Form_Ribbon_webAddress").valid()&&(this.XLObj._dlgHLClick=!0,t._setLink(),this._dlgHLCancel())},_dlgHLCancel:function(){n("#"+this.XLObj._id+"_HLDialog").ejDialog("close")},_renderFRDialog:function(){var h,f,c,l,s,e,a,r=this.XLObj,o,u,i;n("#"+r._id+"_Ribbon_FindDiv").length<1&&(h=t.buildTag("div.e-dlgctndiv e-ss-finddiv","",{height:"auto"},{id:r._id+"_Ribbon_FindDiv"}),n("#"+r._id+"_Find").append(h),o=t.buildTag("table"),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td","",{width:"30%"}),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("FindLabel"),"",{id:r._id+"_Ribbon_lbFind"}),i.append(f),i=t.buildTag("td"),c=t.buildTag("input.ejinputtext","","",{id:r._id+"_Ribbon_textFind",type:"text"}),i.append(c),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("ReplaceLabel"),"",{id:r._id+"_Ribbon_lbReplace"}),i.append(f),i=t.buildTag("td"),l=t.buildTag("input.ejinputtext","","",{id:r._id+"_Ribbon_textReplace",type:"text"}),i.append(l),u.append(i),h.append(o),n("#"+r._id+"_Ribbon_lbReplace").hide(),n("#"+r._id+"_Ribbon_textReplace").hide(),a=t.buildTag("div.e-dlgctndiv e-ss-stgdiv","",{},{id:r._id+"_Ribbon_SettingsDiv"}),o=t.buildTag("table"),u=t.buildTag("tr"),i=t.buildTag("td","",{width:"50%"}),o.append(u.append(i)),s=t.buildTag("input#"+r._id+"_Ribbon_Case"),f=t.buildTag("label",r._getLocStr("MatchCase"),{},{"for":r._id+"_Ribbon_Case"}),i.append(s),i.append(f),s.ejCheckBox(),i=t.buildTag("td"),s=t.buildTag("input#"+r._id+"_Ribbon_AllContent"),f=t.buildTag("label",r._getLocStr("MatchAll"),{},{"for":r._id+"_Ribbon_AllContent"}),i.append(s),s.ejCheckBox(),i.append(f),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label").text(r._getLocStr("Within")),i.append(f),i=t.buildTag("td"),f=t.buildTag("label").text(r._getLocStr("Search")),i.append(f),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddWithin",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._within,{id:"Types",text:"text",value:"value"},0,110,25)),i=t.buildTag("td"),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddSearch",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._sType,{id:"Types",text:"text",value:"value"},0,120,25)),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("Lookin")),i.append(f),i=t.buildTag("td"),f=t.buildTag("label",r._getLocStr("Replace")+" "+r._getLocStr("Direction")),u.append(i.append(f)),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddLookin",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._vType,{id:"Types",text:"text",value:"value"},0,110,25,"Type")),i=t.buildTag("td"),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddDirection",type:"text"}),u.append(i.append(e)),e.ejDropDownList(r._generateEJDD(this._direction,{id:"Types",text:"text",value:"value"},0,120,25)),n("#"+r._id+"_Settings").append(a.append(o)))},_frTypeChange:function(t,i){t==="Type"&&i.value==="comment"?(n("#"+this._id+"_Ribbon_textReplace").attr("disabled",!0),n("#"+this._id+"FR_ReplaceBtn").ejButton("disable"),n("#"+this._id+"FR_ReplaceAllBtn").ejButton("disable")):(n("#"+this._id+"_Ribbon_textReplace").prop("disabled",!1),n("#"+this._id+"FR_ReplaceBtn").ejButton("enable"),n("#"+this._id+"FR_ReplaceAllBtn").ejButton("enable"))},_hlTabChange:function(t){var i=this.XLObj,s=n("#"+i._id+"_Ribbon_sheentName").data("ejTreeView"),r=i.getActiveSheetIndex(),h=n("#"+i._id+"_Doc"),c=n("#"+i._id+"_Web"),l=n("#"+i._id+"_Ribbon_webAddress"),f=n("#"+i._id+"_Ribbon_findText"),u=n("#"+i._id+"_Ribbon_cellAddress"),e=n("#"+i._id+"_Ribbon_cellText"),a=i.getActiveCell(r),o=i.XLEdit.getPropertyValue(a.rowIndex,a.colIndex,"hyperlink",r);switch(t.activeIndex){case 0:l.focus().setInputPos(l.val().length);f.val(e.val());h.hide();c.show();n("#"+i._id+"hlDialog_OkBtn").ejButton("enable");break;case 1:u.val().length||u.val("A1");h.show();c.hide();o&&o.cellAddr&&(r=parseInt(o.cellAddr.split("_")[1]));s.selectNode(r+1);f.val().length?e.val(f.val()):e.val(s.getText(r+1)+"!A1");u.focus().setInputPos(u.val().length)}},_findTabChange:function(t){var r,i=this.XLObj;switch(t.activeIndex){case 0:r=n("#"+i._id+"_Ribbon_FindDiv");n("#"+i._id+"_Ribbon_lbReplace").hide();n("#"+i._id+"_Ribbon_textReplace").hide();n("#"+i._id+"FR_ReplaceBtn").css("visibility","hidden");n("#"+i._id+"FR_ReplaceAllBtn").css("visibility","hidden");n("#"+i._id+"_Find").append(r);n("#"+i._id+"FR_PrevBtn").show();n("#"+i._id+"FR_NextBtn").show();n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length);i._phoneMode?(n("#"+i._id+"FR_ReplaceBtn").hide(),n("#"+i._id+"FR_ReplaceAllBtn").hide()):(n("#"+i._id+"FR_ReplaceBtn").show(),n("#"+i._id+"FR_ReplaceAllBtn").show());break;case 1:r=n("#"+i._id+"_Ribbon_FindDiv");n("#"+i._id+"_Ribbon_lbReplace").show();n("#"+i._id+"_Ribbon_textReplace").show();n("#"+i._id+"FR_ReplaceBtn").css("visibility","visible").show();n("#"+i._id+"FR_ReplaceAllBtn").css("visibility","visible").show();i._phoneMode?(n("#"+i._id+"FR_PrevBtn").hide(),n("#"+i._id+"FR_NextBtn").hide()):(n("#"+i._id+"FR_PrevBtn").show(),n("#"+i._id+"FR_NextBtn").show());n("#"+i._id+"_Replace").append(r);n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length);break;case 2:n("#"+i._id+"FR_PrevBtn").hide();n("#"+i._id+"FR_NextBtn").hide();n("#"+i._id+"FR_ReplaceBtn").css("visibility","hidden");n("#"+i._id+"FR_ReplaceAllBtn").css("visibility","hidden");n("#"+i._id+"_Ribbon_ddWithin").focus();i._phoneMode?n("#"+i._id+"_Ribbon_SettingsDiv").find("td:eq(1)").hide():n("#"+i._id+"_Ribbon_SettingsDiv").find("td:eq(1)").show()}},_gotoTabChange:function(t){var i=this.XLObj;t.activeIndex==0&&n("#"+i._id+"_textRef").focus().setInputPos(n("#"+i._id+"_textRef").val().length)},_btnFROnClick:function(t){var i=this.XLObj;i.showWaitingPopUp();var r=i.getActiveSheetIndex(),c=i.getSheet(r)._startCell.rowIndex,l=i.getSheet(r)._startCell.colIndex,u=n("#"+i._id+"_Ribbon_Case").data("ejCheckBox").isChecked(),f=n("#"+i._id+"_Ribbon_AllContent").data("ejCheckBox").isChecked(),e=this._within[n("#"+i._id+"_Ribbon_ddWithin").data("ejDropDownList").selectedIndexValue].value,s=this._sType[n("#"+i._id+"_Ribbon_ddSearch").data("ejDropDownList").selectedIndexValue].value,o=this._vType[n("#"+i._id+"_Ribbon_ddLookin").data("ejDropDownList").selectedIndexValue].value,a=this._direction[n("#"+i._id+"_Ribbon_ddDirection").data("ejDropDownList").selectedIndexValue].value,h;switch(t){case"FR_NextBtn":case"FR_PrevBtn":i.XLSearch._findCount=0;h=t==="FR_NextBtn"?i.XLSearch._findNext(n("#"+i._id+"_Ribbon_textFind").val(),r,u,f,o,e,s):i.XLSearch._findPrev(n("#"+i._id+"_Ribbon_textFind").val(),r,u,f,o,e,s);h||(i.XLSearch._updateSelection(c,l,r),i.hideWaitingPopUp(),i._showAlertDlg("Alert","NotFound"));break;case"FR_ReplaceBtn":i.XLSearch._replaceData(n("#"+i._id+"_Ribbon_textFind").val(),n("#"+i._id+"_Ribbon_textReplace").val(),r,u,f,o,a,e,s);break;case"FR_ReplaceAllBtn":i.XLSearch._replaceAllData(n("#"+i._id+"_Ribbon_textFind").val(),n("#"+i._id+"_Ribbon_textReplace").val(),u,f,o,e);break;case"FR_CloseBtn":n("#"+i._id+"_FRDialog").ejDialog("close");i.setSheetFocus()}i.hideWaitingPopUp()},_renderGoToDialog:function(){var f,o,u,s,e,i=this.XLObj,r;n("#"+i._id+"_GoToDlgTab").ejTab({width:"100%",itemActive:t.proxy(this._gotoTabChange,this),cssClass:"e-ss-dlgtab"});n("#"+i._id+"_GoToDiv").length<1&&(f=t.buildTag("div.e-dlgctndiv","",{},{id:i._id+"_GoToDiv"}),n("#"+i._id+"_GoTo").append(f),r=t.buildTag("div.e-dlg-fields"),u=t.buildTag("label.e-dlg-fields",i._getLocStr("GoToName")),s=t.buildTag("ul#"+i._id+"_GotoAddr"),f.append(r.append(u,s)),n("#"+i._id+"_GotoAddr").ejListBox({dataSource:this._addrList,height:"120",width:"100%",selected:n.proxy(this._gotoValChange,this),fields:{id:"Types",text:"text",value:"value"}}),r=t.buildTag("div.e-dlg-fields"),u=t.buildTag("label.e-dlg-fields",i._getLocStr("Reference")),e=t.buildTag("input.ejinputtext","","",{id:i._id+"_textRef",type:"text"}),e.data("parentID",i._id),f.append(r.append(u,e)),o=t.buildTag("div#"+i._id+"_GoToSpDiv.e-dlgctndiv","",""),r=t.buildTag("div.e-dlg-fields e-dlgctndiv"),n("#"+i._id+"_GoToSp").append(o.append(r)),n("#"+i._id+"_GoToSp").css({overflow:"auto",height:"auto"}),u=t.buildTag("label.e-dlg-fields").text(i._getLocStr("Select")).css("display","table"),r.append(u),this._renderGotoSp(r,this._gotoRBtnSet1,this._gotoRBtnSet2,this._gotoChkBox),n("#"+i._id+"_GoDialog").ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,width:"auto",allowKeyboardNavigation:!1,title:i._getLocStr("GoTo"),cssClass:"e-ss-dialog e-ss-gotodlg e-ss-mattab e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_textRef");t.focus().setInputPos(t.val().length)})}),n("#"+i._id+"_GoToDiv").wrapInner('<form id="'+i._id+'_Form_GoToDiv" onsubmit="return false"><\/form>'),this._dialogValidate("_GoToDiv"))},_renderGotoSp:function(i,r,u,f){for(var l,c,s,e,h=this.XLObj,v=h._id+"_gotoSpDiv",a,y=t.buildTag("table"),o=0;o<r.length;o++)s=t.buildTag("tr","",{height:35}),e=t.buildTag("td"),l=t.buildTag("input#"+v+"_"+r[o],"",{},{type:"radio",name:"gotospecial"}),e.append(l),s.append(e),l.ejRadioButton({size:"medium",change:n.proxy(this._rBtnOnClick,this,r[o])}),e=t.buildTag("td","",{width:100}),c=t.buildTag("label",h._getLocStr(r[o]),{},{"for":v+"_"+r[o]}),e.append(c),s.append(e),h.isUndefined(u[o])||(e=t.buildTag("td"),l=t.buildTag("input#"+v+"_"+u[o],"",{},{type:"radio",name:"gotospecial"}),e.append(l),s.append(e),l.ejRadioButton({size:"medium",change:n.proxy(this._rBtnOnClick,this,u[o])}),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(u[o]),{},{"for":v+"_"+u[o]}),e.append(c),s.append(e)),y.append(s);for(o=0;o<f.length;o=o+2)s=t.buildTag("tr"),e=t.buildTag("td"),a=t.buildTag("input#"+h._id+"_"+f[o]),e.append(a),s.append(e),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(f[o]),{},{"for":h._id+"_"+f[o]}),e.append(c),s.append(e),a.ejCheckBox({checked:!0,enabled:!1}),e=t.buildTag("td"),a=t.buildTag("input#"+h._id+"_"+f[o+1]),e.append(a),s.append(e),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(f[o+1]),{},{"for":h._id+"_"+f[o+1]}),e.append(c),s.append(e),a.ejCheckBox({checked:!0,enabled:!1}),y.append(s);i.append(y);n("#"+v+"_Blanks").ejRadioButton("option",{checked:!0})},_renderPvtDialog:function(){var r=this.XLObj,s,e,o,u,i,f;n("#"+r._id+"_Ribbon_PvtDiv").length<1&&(s=t.buildTag("div.e-dlgctndiv","",{},{id:r._id+"_Ribbon_PvtDiv"}),o=t.buildTag("table","",{},{cellpadding:0,cellspacing:0}),u=t.buildTag("tr.e-ss-changerange"),i=t.buildTag("td",""),e=t.buildTag("label",r._getLocStr("Range")),i.append(e),u.append(i),i=t.buildTag("td",""),f=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_PvtRange",type:"text"}),f.data("parentID",r._id),u.append(i.append(f)),o.append(u),u=t.buildTag("tr.e-ss-movepvttbl"),i=t.buildTag("td"),e=t.buildTag("label",r._getLocStr("ChoosePivotTable")),i.append(e),i.attr("colspan",2),o.append(u.append(i)),u=t.buildTag("tr.e-ss-movepvttbl"),i=t.buildTag("td"),i.attr("colspan",2),f=t.buildTag("input#"+r._id+"_dlg_newsheet","",{},{type:"radio",name:"sheet"}),i.append(f),e=t.buildTag("label"," "+r._getLocStr("NewWorksheet")),i.append(e),o.append(u.append(i)),f.ejRadioButton({size:"medium",checked:!0,change:n.proxy(this._rBtnPvtOnClick,this,"new")}),u=t.buildTag("tr.e-ss-movepvttbl"),i=t.buildTag("td"),i.attr("colspan",2),f=t.buildTag("input#"+r._id+"_dlg_existsheet","",{},{type:"radio",name:"sheet"}),i.append(f),e=t.buildTag("label"," "+r._getLocStr("ExistingWorksheet")),i.append(e),o.append(u.append(i)),f.ejRadioButton({size:"medium",change:n.proxy(this._rBtnPvtOnClick,this,"existing")}),u=t.buildTag("tr.e-ss-movepvttbl"),i=t.buildTag("td"),e=t.buildTag("label",r._getLocStr("Location")),i.append(e),u.append(i),i=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_PvtLocation",type:"text"}),f.data("parentID",r._id),u.append(i.append(f)),o.append(u),n("#"+r._id+"_Pivot").append(s.append(o)),n("#"+r._id+"_Ribbon_PvtLocation").wrap("<form id='"+r._id+"_Form_Ribbon_PvtLocation' onsubmit='return false'><\/form>").prop("disabled",!0),this._dialogValidate("_Ribbon_PvtLocation"),n("#"+r._id+"_Ribbon_PvtRange").wrap("<form id='"+r._id+"_Form_Ribbon_PvtRange' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_PvtRange"))},_dlgPvtOk:function(){var t=this.XLObj,r=n("#"+t._id+"_PvtDialog"),i;n("#"+t._id+"_Form_Ribbon_PvtRange").valid()&&n("#"+t._id+"_Form_Ribbon_PvtLocation").valid()&&(i=t.XLPivot._checkRange(n("#"+t._id+"_Ribbon_PvtRange").val(),n("#"+t._id+"_Ribbon_PvtLocation").val()),i.isRows?t._showAlertDlg("Alert","PivotRowsAlert","",450):i.isHeader?t._showAlertDlg("Alert","PivotLabelsAlert","",550):i.isOverlap?t._showAlertDlg("Alert","PivotOverlapAlert","",450):(n("#"+t._id+"_PvtDialog").ejDialog("close"),r.find(".e-ss-changerange:visible").length&&r.find(".e-ss-movepvttbl:visible").length?t.XLPivot.createPivotTable(n("#"+t._id+"_Ribbon_PvtRange").val(),n("#"+t._id+"_Ribbon_PvtLocation").val(),null):r.find(".e-ss-changerange:visible").length?t.XLPivot._changeDataSource():t.XLPivot._movePivotTable()))},_dlgPvtCancel:function(){var t=this.XLObj;n("#"+t._id+"_PvtDialog").ejDialog("close");t.setSheetFocus()},_rBtnPvtOnClick:function(t){var r=this.XLObj,u=n("#"+r._id+"_Ribbon_PvtRange"),i=n("#"+r._id+"_Ribbon_PvtLocation");i.prop("disabled",t==="new");t==="new"?(u.focus().setInputPos(u.val().length),n("#"+this.XLObj._id+"_Form_Ribbon_PvtLocation").validate().resetForm()):i.setInputPos(i.val().length)},_rBtnOnClick:function(t){var r=this.XLObj,i;if(t==="Formulas"||t==="Constants")for(i=0;i<this._gotoChkBox.length;i++)n("#"+r._id+"_"+this._gotoChkBox[i]).data("ejCheckBox").option({enabled:!0});else for(i=0;i<this._gotoChkBox.length;i++)n("#"+r._id+"_"+this._gotoChkBox[i]).data("ejCheckBox").option({enabled:!1})},_gotoValChange:function(t){n("#"+this.XLObj._id+"_textRef").val(t.model.value)},_getAddrFromDollarAddr:function(n){var i,t;return n.indexOf("!")>-1&&(t=n.split("!"),i=this.XLObj._getSheetIndexByName(t[0]),n=t[1]),n.indexOf("$")>-1&&(n=n.split("$").join("")),n.indexOf(":")<0&&(n=n+":"+n),n=n.replace("=",""),[i,n]},_gotoBtnClick:function(t){var i=this.XLObj,r;switch(t){case"ok":n("#"+i._id+"_Form_GoToDiv").valid()&&(r=n("#"+i._id+"_GoToDlgTab").data("ejTab"),r.model.selectedItemIndex?i.XLSearch._applyGoToRule(n("#"+i._id+"_GoToSpDiv").find(".e-circle_01").parents("div")[0].id.split("ej"+i._id+"_gotoSpDiv_")[1].toLowerCase(),n("#"+i._id+"_"+this._gotoChkBox[0]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[1]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[2]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[3]).data("ejCheckBox").isChecked()):i.XLSearch.goTo(n.trim(n("#"+i._id+"_textRef").val().toString())),n("#"+i._id+"_GoDialog").ejDialog("close"));break;case"cancel":n.validator&&n("#"+i._id+"_Form_GoToDiv").validate().resetForm();n("#"+i._id+"_GoDialog").ejDialog("close")}i.setSheetFocus()},_borderPicture:function(){var n=this.XLObj;return"<ul id="+n._id+"_Ribbon_PictureBorder style='display:none' class='e-ss-pictureborder'><li id='"+n._id+"picturecolor'><a>"+n._getLocStr("ThemeColor")+"<\/a><ul><li><input id='"+n._id+"_Ribbon_PictureColor'><\/input><\/li><\/ul><\/li><li id='nooutline' class='picturecolor'><a>"+n._getLocStr("NoOutline")+"<\/a><\/li><li id='weight' class='picturecolor'><a>"+n._getLocStr("Weight")+"<\/a><ul><li id='1px'><a>1px<\/a><\/li><li id='2px'><a>2px<\/a><\/li><li id='3px'><a>3px<\/a><\/li><\/ul><\/li><li id='dashes' class='picturecolor'><a>"+n._getLocStr("Dashes")+"<\/a><ul><li id='solid'><a><div style='border:2px solid black'><\/div><\/a><\/li><li id='dotted'><a><div style='border:2px dotted black'><\/div><\/a><\/li><li id='dashed'><a><div style='border:2px dashed black'><\/div><\/a><\/li><\/ul><\/li><\/ul>"},_chartElementTag:function(){var n=this.XLObj,t="<ul id="+n._id+'_Ribbon_CElement class="e-spreadsheet" style="display:none">';return t+='<li class="axes" id="Axes"><a><span class="e-ss-chartimg e-icon e-ss-axes"><\/span>'+n._getLocStr("Axes")+'<\/a><ul><li class="phaxis e-ss-cmenuitem" id="PHAxis"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-phaxis"><\/span>'+n._getLocStr("PHAxis")+'<\/a><\/li><li class="pvaxis e-ss-cmenuitem" id="PVAxis"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pvaxis"><\/span>'+n._getLocStr("PVAxis")+"<\/a><\/li><\/ul><\/li>",t+='<li class="axistitle" id="AxisTitle"><a><span class="e-ss-chartimg e-icon e-ss-axistitle"><\/span>'+n._getLocStr("AxisTitle")+'<\/a><ul><li class="phaxistitle e-ss-cmenuitem" id="PHAxisTitle"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-phaxistitle"><\/span>'+n._getLocStr("PHAxis")+'<\/a><\/li><li class="pvaxistitle e-ss-cmenuitem" id="PVAxisTitle"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pvaxistitle"><\/span>'+n._getLocStr("PVAxis")+"<\/a><\/li><\/ul><\/li>",t+='<li class="charttitle" id="ChartTitle"><a><span class="e-ss-chartimg e-icon e-ss-charttitle"><\/span>'+n._getLocStr("ChartTitle")+'<\/a><ul><li class="ctnone e-ss-cmenuitem" id="CTNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctnone"><\/span>'+n._getLocStr("CTNone")+'<\/a><\/li><li class="ctcenter e-ss-cmenuitem" id="CTCenter"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctcenter"><\/span>'+n._getLocStr("CTCenter")+'<\/a><\/li><li class="ctfar e-ss-cmenuitem" id="CTFar"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctfar"><\/span>'+n._getLocStr("CTFar")+'<\/a><\/li><li class="ctnear e-ss-cmenuitem" id="CTNear"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctnear"><\/span>'+n._getLocStr("CTNear")+"<\/a><\/li><\/ul><\/li>",t+='<li class="datalabels" id="DataLabels"><a><span class="e-ss-chartimg e-icon e-ss-datalabels"><\/span>'+n._getLocStr("DataLabels")+'<\/a><ul><li class="dlnone e-ss-cmenuitem" id="DLNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlnone"><\/span>'+n._getLocStr("DLNone")+'<\/a><\/li><li class="dlcenter e-ss-cmenuitem" id="DLCenter"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlcenter"><\/span>'+n._getLocStr("DLCenter")+'<\/a><\/li><li class="dliend e-ss-cmenuitem" id="DLIEnd"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dliend"><\/span>'+n._getLocStr("DLIEnd")+'<\/a><\/li><li class="dlibase e-ss-cmenuitem" id="DLIBase"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlibase"><\/span>'+n._getLocStr("DLIBase")+'<\/a><\/li><li class="dloend e-ss-cmenuitem" id="DLOEnd"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dloend"><\/span>'+n._getLocStr("DLOEnd")+"<\/a><\/li><\/ul><\/li>",t+='<li class="gridline" id="Gridline"><a><span class="e-ss-chartimg e-icon e-ss-gridline"><\/span>'+n._getLocStr("Gridline")+'<\/a><ul><li class="pmajorh e-ss-cmenuitem" id="PMajorH"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pmajorh"><\/span>'+n._getLocStr("PMajorH")+'<\/a><\/li><li class="pmajorv e-ss-cmenuitem" id="PMajorV"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pmajorv"><\/span>'+n._getLocStr("PMajorV")+'<\/a><\/li><li class="pminorh e-ss-cmenuitem" id="PMinorH"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon  e-ss-pminorh"><\/span>'+n._getLocStr("PMinorH")+'<\/a><\/li><li class="pminorv e-ss-cmenuitem" id="PMinorV"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pminorv"><\/span>'+n._getLocStr("PMinorV")+"<\/a><\/li><\/ul><\/li>",t+('<li class="legend" id="Legend"><a><span class="e-ss-chartimg e-icon e-ss-legend"><\/span>'+n._getLocStr("Legend")+'<\/a><ul><li class="lnone e-ss-cmenuitem" id="LNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lnone"><\/span>'+n._getLocStr("LNone")+'<\/a><\/li><li class="lright e-ss-cmenuitem" id="LRight"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lright"><\/span>'+n._getLocStr("LRight")+'<\/a><\/li><li class="lleft e-ss-cmenuitem" id="LLeft"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lleft"><\/span>'+n._getLocStr("LLeft")+'<\/a><\/li><li class="lbottom e-ss-cmenuitem" id="LBottom"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lbottom"><\/span>'+n._getLocStr("LBottom")+'<\/a><\/li><li class="ltop e-ss-cmenuitem" id="LTop"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ltop"><\/span>'+n._getLocStr("LTop")+"<\/a><\/li><\/ul><\/li>")},_cpClickHandler:function(t){var i=this.XLObj;t==="Ribbon_Home_Font_FillColor"?i.XLFormat.format({style:{"background-color":n("#"+i._id+"_Ribbon_Home_Font_FillColor").ejColorPicker("option","value")}}):t==="Ribbon_Home_Font_FontColor"&&i.XLFormat.format({style:{color:n("#"+i._id+"_Ribbon_Home_Font_FontColor").ejColorPicker("option","value")}});i.setSheetFocus()},_ribbonClickHandler:function(i){var rt,vi,yi,gt,nt,ni,c,l,pi,et,ht,g,ot,st,pt,ut,tt,ti={},r=n("#"+this._id.split("_Ribbon")[0]).data("ejSpreadsheet"),f=r.getActiveSheetIndex(),e=r.getSheet(f),a={},o={},h=this._id.split("_"),w=t.Spreadsheet.SupportedStyles,wi,ct,gi,y,p=e._selectedCells,d,k,v,lt,ii,wt,ri,bt,at,bi,ki,kt,fi,it,dt,ei,s,oi,si,hi,b,ft,u,nr,yt,ci,ai;if(!r._shapeChange&&!r.XLRibbon._isSetModel){if(r._isRibbonClick=!0,ct=r._getJSSheetContent(f).find(".e-spreadsheetcontentcontainer > .e-content"),gi=r.getMainPanel(),rt=n("#"+r._id+"_Ribbon_Home_Number_NumberFormat").data("ejDropDownList"),ut=n("#"+r._id+"_Ribbon_Home_Font_FontSize").data("ejDropDownList"),pt=n(r.getCell(e._activeCell.rowIndex,e._activeCell.colIndex)),r.model.allowSelection&&r.model.allowFormatAsTable&&r.model.allowCellFormatting&&(r.XLFormat._formatEnable||r.XLSelection._isOutsideBordering||r.XLSelection._isGridBordering)&&(r._id+"_Ribbon_Home_Font_BorderColor"===this._id||r._id+"_Ribbon_bordercolor"===i.ID||r._borderStyles.indexOf(i.ID)>-1||(r.XLSelection._isGridBordering=r.XLSelection._isOutsideBordering=r.XLFormat._formatEnable=!1,n("#"+r._id+"_Ribbon_Home_Clipboard_FormatPainter").ejToggleButton("option",{toggleState:!1}),(i.type==="itemSelected"||i.type==="click")&&!r.isUndefined(i.model.prefixIcon)&&(i.model.prefixIcon.split("e-ss-")[1]===i.ID||i.model.prefixIcon.indexOf("e-ss-drawborder")>-1||i.model.prefixIcon.indexOf("e-ss-drawbordergrid")>-1)&&(r.XLSelection._isGridBordering=r.XLSelection._isOutsideBordering=!0),ct.addClass("e-ss-cursor"),ct.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor e-ss-fpcursor"),r.XLSelection._cleanUp(!0))),wi={Id:this._id,isChecked:i.isChecked,status:i.status,prop:i.model,model:r.model},r._trigger("ribbonClick",wi)){r.model.showRibbon&&r.XLRibbon._updateRibbonIcons();return}!t.isNullOrUndefined(r._getAutoFillOptElem())&&r.model.autoFillSettings.showFillOptions&&(r._getAutoFillOptElem().addClass("e-hide"),n("#"+r._id+"_ctxtmenu").hide());switch(this._id){case r._id+"_Ribbon_Home_Clipboard_Cut":r.XLClipboard.cut();break;case r._id+"_Ribbon_Home_Clipboard_Copy":r.XLClipboard.copy();break;case r._id+"_Ribbon_Home_Clipboard_Paste":case r._id+"_Ribbon_Home_Clipboard_PasteOptions":r.XLClipboard._isSpecial=!(i.ID==="PasteValues");r.XLClipboard.paste();break;case r._id+"_Ribbon_Home_Actions_Undo":r.XLClipboard._triggerKeyDown(90,!0);break;case r._id+"_Ribbon_Home_Actions_Redo":r.XLClipboard._triggerKeyDown(89,!0);break;case r._id+"_Ribbon_Home_Alignment_WrapText":r._textFormatting("wrapText");break;case r._id+"_Ribbon_PageLayout_Print_Print":r.XLPrint.printSheet(f);break;case r._id+"_Ribbon_PageLayout_Print_PrintSelected":r.XLPrint.printSelection(f);break;case r._id+"_Ribbon_new":r._cellFormatHandler(this._id.replace(r._id+"_Ribbon_",""),i.selectedText);break;case r._id+"_Ribbon_Home_Font_Bold":o[w.FontWeight]=i.model.toggleState?"bold":"normal";a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Font_Italic":o[w.FontStyle]=i.model.toggleState?"italic":"normal";a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Font_Underline":case r._id+"_Ribbon_Home_Font_StrikeThrough":d=r.XLFormat.getFormatFromHashCode(r.XLFormat.getFormatClass(pt[0].className))["text-decoration"]||"";h.indexOf("StrikeThrough")>-1?h[h.indexOf("StrikeThrough")]="line-through":h.indexOf("Underline")>-1&&(h[h.indexOf("Underline")]="underline");i.model.toggleState?(d=d.replace("none",""),o[w.TextDecoration]=d?d.indexOf("underline")<0?d+" "+h[h.length-1]:h[h.length-1]+" "+d:h[h.length-1]):(d=n.trim(d.replace(h[h.length-1],"")),o[w.TextDecoration]=d.length?d:"none");a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Font_FontSize":o[w.FontSize]=i.value;a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Font_IncreaseFontSize":case r._id+"_Ribbon_Home_Font_DecreaseFontSize":this._id==r._id+"_Ribbon_Home_Font_IncreaseFontSize"?(st=t.isNullOrUndefined(ut.selectedIndexValue)?6:ut.selectedIndexValue+1,t.isNullOrUndefined(r.XLRibbon._fontSize[st])||ut.option({selectedItemIndex:st})):this._id==r._id+"_Ribbon_Home_Font_DecreaseFontSize"&&(st=t.isNullOrUndefined(ut.selectedIndexValue)?4:ut.selectedIndexValue-1,t.isNullOrUndefined(r.XLRibbon._fontSize[st])||ut.option({selectedItemIndex:st}));break;case r._id+"_Ribbon_Home_Alignment_AlignLeft":case r._id+"_Ribbon_Home_Alignment_AlignRight":case r._id+"_Ribbon_Home_Alignment_AlignCenter":g=n(this.element.parents("div").eq(1)).find(".e-text-align");t.isNullOrUndefined(g[0])?this.element.addClass("e-text-align"):(n("#"+g[0].id).ejToggleButton("option","toggleState",!1),g.removeClass("e-text-align"),g[0].id!=this.element[0].id&&this.element.addClass("e-text-align"));o[w.TextAlign]=i.model.toggleState?h[h.length-1].split("Align")[1]:"left";a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Alignment_DecreaseIndent":case r._id+"_Ribbon_Home_Alignment_IncreaseIndent":if(ii=0,ri=!1,p.length<2)bt=r.getActiveCell(),k=r.XLFormat.getFormatFromHashCode(r.XLFormat.getFormatClass(r.getCell(bt.rowIndex,bt.colIndex)[0].className)),wt=w.TextIndent in k?this._id===r._id+"_Ribbon_Home_Alignment_IncreaseIndent"?Number(k[w.TextIndent].replace("pt",""))+6:Number(k[w.TextIndent].replace("pt",""))-6:this._id===r._id+"_Ribbon_Home_Alignment_DecreaseIndent"?-6:6,r.XLRibbon._applyTextIndent(bt,k,wt,this);else{for(v=0,lt=p.length;v<lt;v++)k=r.XLFormat.getFormatFromHashCode(r.XLFormat.getFormatClass(r.getCell(p[v].rowIndex,p[v].colIndex)[0].className)),k[w.TextAlign]=="right"&&ii++;for(ii===p.length&&(ri=!0),v=0,lt=p.length;v<lt;v++)k=r.XLFormat.getFormatFromHashCode(r.XLFormat.getFormatClass(r.getCell(p[v].rowIndex,p[v].colIndex)[0].className)),ri||(k[w.TextAlign]="left"),wt=w.TextIndent in k?this._id===r._id+"_Ribbon_Home_Alignment_IncreaseIndent"?Number(k[w.TextIndent].replace("pt",""))+6:Number(k[w.TextIndent].replace("pt",""))-6:this._id===r._id+"_Ribbon_Home_Alignment_DecreaseIndent"?-6:6,r.XLRibbon._applyTextIndent(p[v],k,wt,this)}r.XLSelection.refreshSelection();r.XLDragFill.positionAutoFillElement();break;case r._id+"_Ribbon_Home_Alignment_TopAlign":case r._id+"_Ribbon_Home_Alignment_MiddleAlign":case r._id+"_Ribbon_Home_Alignment_BottomAlign":g=n(this.element.parents("div").eq(1)).find(".e-vertical-align");t.isNullOrUndefined(g[0])?this.element.addClass("e-vertical-align"):(n("#"+g[0].id).ejToggleButton("option","toggleState",!1),g.removeClass("e-vertical-align"),g[0].id!=this.element[0].id&&this.element.addClass("e-vertical-align"));o[w.VerticalAlign]=i.model.toggleState?h[h.length-1].split("Align")[0]:"bottom";a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Font_FontFamily":o[w.FontFamily]=i.text;a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_PageLayout_Show_Headings":r.showHeadings(i.isChecked);break;case r._id+"_Ribbon_PageLayout_Show_Gridlines":r.showGridlines(i.isChecked);break;case r._id+"_Ribbon_PageLayout_PageLayout_PageSize":case r._id+"_Ribbon_PageLayout_PageLayout_PageSizeOptions":at=t.isNullOrUndefined(i.ID)?i.model.prefixIcon.substring(12):i.ID;r.XLPrint._printSetting(at);break;case r._id+"_Ribbon_Home_Number_NumberFormat":a.type=i.text.toLowerCase();a.type!=="custom"?r.XLFormat.format(a):r._showDialog(r._id+"_FormatCells");break;case r._id+"_Ribbon_Home_Number_IncreaseDecimal":case r._id+"_Ribbon_Home_Number_DecreaseDecimal":pt.data("type")!="number"&&n.isNumeric(r.XLEdit.getPropertyValueByElem(pt))&&(r.XLRibbon._isSetModel=!0,rt.option({selectedItemIndex:1}),r.XLRibbon._isSetModel=!1);r.XLFormat.updateDecimalPlaces(h[h.length-1]);break;case r._id+"_Ribbon_Home_Number_Accounting":case r._id+"_Ribbon_Home_Number_Percentage":this._id===r._id+"_Ribbon_Home_Number_Accounting"?rt.option({selectedItemIndex:3}):rt.option({selectedItemIndex:4});a.type=rt.selectedTextValue.toLowerCase();break;case r._id+"_Ribbon_Home_Number_CommaStyle":rt.option({selectedItemIndex:1});a.type=rt.selectedTextValue.toLowerCase();break;case r._id+"_Ribbon_Data_SortFilter_SortAtoZ":r.XLSort._sortHandler("SortAtoZ");break;case r._id+"_Ribbon_Data_SortFilter_SortZtoA":r.XLSort._sortHandler("SortZtoA");break;case r._id+"_Ribbon_Data_SortFilter_Filter":r.XLFilter.filter();break;case r._id+"_Ribbon_Data_SortFilter_ClearFilter":ot=r.XLEdit.getPropertyValue(r.getActiveCell().rowIndex,r.getActiveCell().colIndex,"tableName");t.isNullOrUndefined(ot)?r.XLFilter.clearFilter():(s=r._getTableID(ot),r.XLFilter._clearFilterTable(r.getActiveSheetIndex(),s,!0));break;case r._id+"_Ribbon_Home_Font_BorderColor":ti=n("#"+r._id+"_Ribbon_BorderColor").data("ejColorPicker");t.isNullOrUndefined(ti)||ti.hide();t.isNullOrUndefined(i.value)||(r._borderColor=i.value);break;case r._id+"_Ribbon_Home_Font_Border":r._borderStyles.indexOf(i.ID)<0?t.isNullOrUndefined(i.ID)?i.ID=i.model.prefixIcon.substring(12):i.ID.indexOf("bordercolor")<0&&n(this.element).find(".e-icon ").removeClass().addClass("e-icon e-ss-"+i.ID)&&this.option({prefixIcon:"e-icon e-ss-"+i.ID}):r.XLRibbon._updateBordeStyle(i);yi=r._borderColor||"#000000";c=e._startCell;l=e._endCell;bi=r._getAlphaRange(f,c.rowIndex,c.colIndex,l.rowIndex,l.colIndex);r.model.allowSelection&&(r.XLSelection._isOutsideBordering||r.XLSelection._isGridBordering)?!(r._borderStyles.indexOf(i.ID)>-1)&&i.ID.indexOf("bordercolor")<0&&(r.XLSelection._isOutsideBordering=r.XLSelection._isGridBordering=!1):r.setBorder({type:i.ID,color:yi,style:r._borderStyle},bi);break;case r._id+"_Ribbon_Data_DataTools_DataValidation":case r._id+"_Ribbon_Data_DataTools_DataValidationOptions":if(r._showDialog(this._id),i.ID=="ClearVal")r.XLValidate.clearDV();else if(i.ID=="HighlightVal")r.XLValidate.highlightInvalidData();else if(i.ID=="ClearHLVal")r.XLValidate.clearHighlightedValData();else{for(var e=r.getSheet(f),vt=e._selectedCells,lt=vt.length,at=[],ui,v=0;v<lt;v++)ki=r.XLEdit.getPropertyValue(vt[v].rowIndex,vt[v].colIndex,"rule"),ki&&(ui=r._dataContainer.sheets[f][vt[v].rowIndex][vt[v].colIndex].rule.customVal,at.indexOf(ui)==-1&&at.push(ui));at.length>0?r._showAlertDlg("","MoreValidationAlert","OpenValDlg",400,130):(n("#"+r._id+"_ValDialog").ejDialog("open"),n.validator&&n("#"+r._id+"_Form_ValDialog").validate().resetForm(),n("#"+r._id+"_Ribbon_ddType_wrapper").focus(),kt=r.XLEdit.getPropertyValueByElem(r.getActiveCellElem(f),"rule"),kt?(fi=kt.customVal,it=fi.split("_"),fi.indexOf("list")>-1?(n("#"+r._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",5),n("#"+r._id+"_Ribbon_btnMin").val(it[0])):(r.XLRibbon._types.some(function(n,t){if(it[4]===n.value)return dt=t,!0}),n("#"+r._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",dt),r.XLRibbon._actions.some(function(n,t){if(it[0]===n.value)return dt=t,!0}),n("#"+r._id+"_Ribbon_ddAction").ejDropDownList("option","selectedItemIndex",dt),n("#"+r._id+"_Ribbon_btnMin").val(it[1].replace("^","")),n("#"+r._id+"_Ribbon_btnMax").val(it[2].replace("^",""))),n("#"+r._id+"_Ribbon_blank").ejCheckBox("option","checked",!kt.required),n("#"+r._id+"_Ribbon_freetext").ejCheckBox("option","checked",JSON.parse(it[it.length-3]))):(n("#"+r._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",1),n("#"+r._id+"_Ribbon_ddAction").ejDropDownList("option","selectedItemIndex",6),n("#"+r._id+"_Ribbon_btnMin").val(""),n("#"+r._id+"_Ribbon_btnMax").val(""),n("#"+r._id+"_Ribbon_blank").ejCheckBox("option","checked",!0),n("#"+r._id+"_Ribbon_freetext").ejCheckBox("option","checked",!0)))}break;case r._id+"_Ribbon_Home_Styles_ConditionalFormatting":if(!i.ID.length)break;r.XLRibbon._currentCFormat=i.ID;i.ID.startsWith("clear")?i.ID==="clearselected"?r.XLCFormat.clearCF(r.getSheet(f).selectedRange):r.XLCFormat.clearCF():i.ID.indexOf("_HLCellRules")>0||i.ID.indexOf("_ClearRules")>0||i.ID.indexOf("_CreateRule")<-1||(r._showDialog(this._id),r.XLRibbon._renderCFDialog(i));break;case r._id+"_Ribbon_Others_Editing_FindSelect":r._showDialog(this._id);gt=n("#"+r._id+"_GoToDlgTab").data("ejTab");ei=n("#"+r._id+"_FRDialog_FPDlgTab").data("ejTab");switch(i.ID){case"Find":r._responsiveHeight<365&&n("#"+r._id+"_FRDialog_wrapper").css("top","0px");n("#"+r._id+"_FRDialog").ejDialog("open");r.XLRibbon._refreshFRDlg();ei.option({selectedItemIndex:0});n("#"+r._id+"_Ribbon_textFind").focus().setInputPos(n("#"+r._id+"_Ribbon_textFind").val().length);r.model.isReadOnly?n("#"+r._id+"_FRDialog_FPDlgTab").ejTab("option",{disabledItemIndex:[1,2]}):n("#"+r._id+"_FRDialog_FPDlgTab").ejTab("option",{enabledItemIndex:[1,2]});break;case"Replace":r._responsiveHeight<365&&n("#"+r._id+"_FRDialog_wrapper").css("top","0px");n("#"+r._id+"_FRDialog").ejDialog("open");r.XLRibbon._refreshFRDlg();ei.option({selectedItemIndex:1});n("#"+r._id+"_Ribbon_textFind").focus().setInputPos(n("#"+r._id+"_Ribbon_textFind").val().length);break;case"GoTo":n("#"+r._id+"_GoDialog").ejDialog("open");gt.option({selectedItemIndex:0});n("#"+r._id+"_textRef").focus().setInputPos(n("#"+r._id+"_Ribbon_textFind").val().length);n.validator&&n("#"+r._id+"_Form_GoToDiv").validate().resetForm();break;case"GoToSpecial":n("#"+r._id+"_GoDialog").ejDialog("open");gt.option({selectedItemIndex:1});n("#"+r._id+"_Blanks").focus();break;default:r.XLSearch._applyGoToRule(i.ID.toLowerCase(),!0,!0,!0,!0)}break;case r._id+"_Ribbon_Others_CalCulation_CalculationOptions":switch(i.ID){case r._id+"_CalcAuto":r.XLEdit.calcOption(!0);break;case r._id+"_CalcManual":r.XLEdit.calcOption(!1)}break;case r._id+"_Ribbon_Others_CalCulation_CalculateNow":r.XLEdit.calcNow();break;case r._id+"_Ribbon_Others_CalCulation_CalculateSheet":r.XLEdit.calcNow(r.getActiveSheetIndex());break;case r._id+"_Ribbon_Home_Clipboard_FormatPainter":if(!i.model.toggleState)return r.performSelection(r.getActiveCell(),r.getActiveCell()),!1;r.XLFormat._formatEnable=!0;ct.removeClass("e-ss-cursor");ct.addClass("e-ss-fpcursor");r.XLFormat._formatPainter();break;case r._id+"_Ribbon_Design_Tools_ConvertToRange":r.XLFormat.convertToRange({alert:!0});break;case r._id+"_Ribbon_Design_Tools_ResizeTable":s=parseInt(document.getElementById(r._id+"_tableid").value);u=e.tableManager[s].range;r._showDialog(r._id+"_Ribbon_Design_Tools_ResizeTable");n("#"+r._id+"_fatresizetablerange").val(r._getAlphaRange(f,u[0],u[1],u[2],u[3]));n("#"+r._id+"_fatresizetabledlg").ejDialog("open");break;case r._id+"_Ribbon_Design_TableStyleOptions_FirstColumn":case r._id+"_Ribbon_Design_TableStyleOptions_LastColumn":tt=e.tableManager;s=document.getElementById(r._id+"_tableid").value;s in tt&&(u=tt[s].range,u=this._id===r._id+"_Ribbon_Design_TableStyleOptions_FirstColumn"?r._getProperAlphaRange(f,u[0]+1,u[1],u[2],u[1]):r._getProperAlphaRange(f,u[0]+1,u[3],u[2],u[3]),this._id===r._id+"_Ribbon_Design_TableStyleOptions_FirstColumn"?(i.isChecked?tt[s].firstColumn=!0:delete tt[s].firstColumn,ni="firstColumn"):(i.isChecked?tt[s].lastColumn=!0:delete tt[s].lastColumn,ni="lastColumn"),r._dupDetails=!0,r.XLFormat.format({style:{"font-weight":i.isChecked?"bold":"normal"}},u),r._dupDetails=!1,et={sheetIndex:f,reqType:"format-table",action:"firstlastcolumn",range:u,check:i.isChecked,id:i.model.id,tableId:parseInt(s),prop:ni},r._completeAction(et),r._trigActionComplete(et));break;case r._id+"_Ribbon_Design_TableStyleOptions_TotalRow":s=document.getElementById(r._id+"_tableid").value;s in e.tableManager&&r.XLFormat._calculateTotalRow(f,s,i.isChecked,i.isChecked);break;case r._id+"_Ribbon_Design_TableStyleOptions_FilterColumn":if(!r.model.allowFiltering)return;tt=e.tableManager;s=document.getElementById(r._id+"_tableid").value;r.XLFilter._clearFilterTableIcon(f,parseInt(document.getElementById(r._id+"_tableid").value));tt[s].isFilter=i.isChecked;et={sheetIndex:f,reqType:"format-table",action:"filtericon",id:i.model.id,check:i.isChecked,tableId:parseInt(s)};r._completeAction(et);r._trigActionComplete(et);break;case r._id+"_Ribbon_Insert_Tables_Table":r._showDialog(this._id);r.XLRibbon._openFATDlg();break;case r._id+"_Ribbon_Review_Comments_NewComment":n("#"+r._id+"_Ribbon_Review_Comments_NewComment").text()===r._getLocStr("NewComment")?r.XLComment.setComment():r.XLComment.editComment();break;case r._id+"_Ribbon_Review_Comments_DeleteComment":r.XLComment.deleteComment();break;case r._id+"_Ribbon_Review_Comments_ShowAllComments":r.XLComment.showAllComments();break;case r._id+"_Ribbon_Review_Comments_ShowHideComment":r.XLComment.showHideComment();break;case r._id+"_Ribbon_Review_Comments_NextComment":r.XLComment.findNextComment();break;case r._id+"_Ribbon_Review_Comments_PreviousComment":r.XLComment.findPrevComment();break;case r._id+"_Ribbon_Insert_Links_Hyperlink":r._showDialog(this._id);break;case r._id+"_Ribbon_Home_Editing_SortFilter":switch(i.ID){case"Ribbon_SortAtoZ":case"Ribbon_SortZtoA":r.model.allowSorting&&r.XLSort._sortHandler(i.ID);break;case"Ribbon_Filter":r.model.allowFiltering&&r.XLFilter.filter();break;default:ot=r.getCell(r.getActiveCell().rowIndex,r.getActiveCell().colIndex)[0].className;ot.indexOf("e-table")<0?r.XLFilter.clearFilter():(s=r._getTableID(ot),r.XLFilter._clearFilterTable(r.getActiveSheetIndex(),parseInt(s),!0))}break;case r._id+"_Ribbon_Others_Cells_InsertCell":case r._id+"_Ribbon_Others_Cells_InsertCellOptions":if(p.length<1)return;c=p[0];l=p[p.length-1];switch(i.ID){case"InsertCells":r._getJSSheetRowHeaderContent(f).find(".e-rowselected").length?r.insertEntireRow(c.rowIndex,l.rowIndex):r._getJSSheetHeader(f).find(".e-colselected").length?(r._insDelStatus="insert",r.insertEntireColumn(c.colIndex,l.colIndex)):r._showDialog(this._id);break;case"InsertSheetRows":r.insertEntireRow(c.rowIndex,l.rowIndex);break;case"InsertSheetColumns":r._insDelStatus="insert";r.insertEntireColumn(c.colIndex,l.colIndex);break;case"InsertSheet":r.insertSheet();break;default:r.element.find(".e-rowselected").length>0?r.insertEntireRow(c.rowIndex,l.rowIndex):r.element.find(".e-colselected").length>0?(r._insDelStatus="insert",r.insertEntireColumn(c.colIndex,l.colIndex)):r.insertShiftBottom(c,l)}break;case r._id+"_Ribbon_Others_Cells_DeleteCell":case r._id+"_Ribbon_Others_Cells_DeleteCellOptions":if(p.length<1)return;c=p[0];l=p[p.length-1];switch(i.ID){case"DeleteCells":r._getJSSheetRowHeaderContent(f).find(".e-rowselected").length?r.deleteEntireRow(c.rowIndex,l.rowIndex,[]):r._getJSSheetHeader(f).find(".e-colselected").length?(r._insDelStatus="delete",r.deleteEntireColumn(c.colIndex,l.colIndex,[])):r._showDialog(this._id);break;case"DeleteSheetRows":r.deleteEntireRow(c.rowIndex,l.rowIndex,[]);break;case"DeleteSheetColumns":r._insDelStatus="delete";r.deleteEntireColumn(c.colIndex,l.colIndex,[]);break;case"DeleteSheet":r.deleteSheet(f);break;default:r.element.find(".e-rowselected").length>0?r.deleteEntireRow(c.rowIndex,l.rowIndex):r.element.find(".e-colselected").length>0?(r._insDelStatus="insert",r.deleteEntireColumn(c.colIndex,l.colIndex)):r.deleteShiftUp(c,l)}break;case r._id+"_Ribbon_Home_Editing_Clear":u=e.selectedRange;switch(i.ID){case"Clear_All":u=r._getAlphaRange(f,u[0],u[1],u[2],u[3]);r.clearAll(u);break;case"Clear_Formats":u=r._getAlphaRange(f,u[0],u[1],u[2],u[3]);r.clearAllFormat(u);break;case"Clear_Contents":u=r._getAlphaRange(f,u[0],u[1],u[2],u[3]);r.clearContents(u);break;case"Clear_Comments":r.clearComments(f);break;default:r.clearHyperlinks()}r.model.allowSelection&&r.XLSelection._clearBorder(r._arrayAsString(r._cutFocus),f);break;case r._id+"_Ribbon_Insert_Tables_PivotTable":if(r._showDialog(this._id),b=n("#"+r._id+"_PvtDialog"),e=r.getSheet(f),pi={sheetIndex:f,model:r.model.sheets},r._trigger("_createPivotTable",pi))return;n("#"+r._id+"_Ribbon_PvtRange").val("");n("#"+r._id+"_Ribbon_PvtLocation").val("");e._selectedCells.length>1?(u=e.selectedRange,n("#"+r._id+"_Ribbon_PvtRange").val(e.sheetInfo.text+"!$"+r._generateHeaderText(u[1]+1)+"$"+(u[0]+1)+":$"+r._generateHeaderText(u[3]+1)+"$"+(u[2]+1))):r.isUndefined(r.XLEdit.getPropertyValueByElem(r.getActiveCellElem()))||(r.selectAll(!1),n("#"+r._id+"_Ribbon_PvtRange").val(e.sheetInfo.text+"!$"+r._generateHeaderText(e._startCell.colIndex+1)+"$"+(e._startCell.rowIndex+1)+":$"+r._generateHeaderText(e._endCell.colIndex+1)+"$"+(e._endCell.rowIndex+1)));b.find(".e-ss-changerange").show();b.find(".e-ss-movepvttbl").show();b.data("ejDialog").option("title",r._getLocStr("CreatePivotTable"));n("#"+r._id+"_dlg_newsheet").click();b.ejDialog("open");break;case r._id+"_Ribbon_Analyze_Show_FieldList":i.model.toggleState?(r.XLPivot._displayActPanel=!0,r.getActivationPanel().find("#"+r._id+"_PivotTableSchema_"+r._getContent(f).find(".e-ss-activepivot")[0].id).show(),r.showActivationPanel()):(r.hideActivationPanel(),r.XLPivot._displayActPanel=!1);break;case r._id+"_Ribbon_Analyze_Actions_ClearAll":oi=r.element.find(".e-ss-activepivot")[0].id;si=n("#"+oi).data("ejPivotGrid");hi=n("#"+r._id+"_PivotTableSchema_"+oi).data("ejPivotSchemaDesigner");r.XLPivot._clearFilters(si,hi);hi.model.pivotControl=si;break;case r._id+"_Ribbon_Analyze_Actions_MovePivotTable":b=n("#"+r._id+"_PvtDialog");f=r.getActiveSheetIndex();b.find(".e-ss-movepvttbl").show();b.find(".e-ss-changerange").hide();ft=r.getSheet(f).pivotMngr.pivot[r.element.find(".e-ss-activepivot")[0].id];n("#"+r._id+"_Ribbon_PvtLocation").val(r.getSheet(f).sheetInfo.text+"!$"+r._generateHeaderText(ft.colIndex+1)+"$"+(ft.rowIndex+1));b.data("ejDialog").option("title",r._getLocStr("MovePivotTable"));n("#"+r._id+"_dlg_existsheet").click();b.ejDialog("open");break;case r._id+"_Ribbon_Analyze_DataSource_Refresh":r.XLPivot.refreshDataSource();break;case r._id+"_Ribbon_Analyze_DataSource_ChangeDataSource":b=n("#"+r._id+"_PvtDialog");b.find(".e-ss-changerange").show();b.find(".e-ss-movepvttbl").hide();ft=r.getSheet(f).pivotMngr.pivot[r.element.find(".e-ss-activepivot")[0].id];u=ft.dataRange;nr=r.XLPivot._getSheetIdxFromName(ft.dataSheetName);n("#"+r._id+"_Ribbon_PvtRange").val(ft.dataSheetName+"!$"+r._generateHeaderText(u[1]+1)+"$"+(u[0]+1)+":$"+r._generateHeaderText(u[3]+1)+"$"+(u[2]+1));b.data("ejDialog").option("title",r._getLocStr("ChangePivotTableDataSource"));b.ejDialog("open");break;case r._id+"_Ribbon_ChartDesign_Type_ChangeChartType":r._showDialog(this._id);r.XLRibbon._refreshChartTypeDlg();break;case r._id+"_Ribbon_Insert_Illustrations_Pictures":if(r.model.importSettings.importMapper.length<1){r._showAlertDlg("Alert","ImportExportUrl","",266);return}r._uploadImage=!0;n("#"+r._id+"_file .e-uploadinput").click();r.XLRibbon._toggleFormatTab();break;case r._id+"_Ribbon_Others_Formulas_NameManager":r.XLRibbon._openNameManagerDlg();r.XLRibbon._isNmgrid="NameManager";break;case r._id+"_Ribbon_Others_Formulas_DefineName":r._showDialog(r._id+"_Ribbon_Others_NameManager");yt=n("#"+r._id+"_nmgrid").data("ejGrid");yt.getContentTable().find("td").addClass("e-ss-emptyrecord");yt.model.dataSource.length<1?yt.getContentTable().find("td").addClass("e-ss-emptyrecord"):yt.getContentTable().find(".e-ss-emptyrecord").removeClass("e-ss-emptyrecord");r.XLRibbon._refreshNMDlg();r.XLRibbon._isNmgrid="DefineName";break;case r._id+"_Ribbon_Others_Window_FreezePanes":switch(i.ID){case"freezePanes":r.XLFreeze.freezePanes();break;case"FreezeTopRow":r.XLFreeze.freezeTopRow();break;case"FreezeFirstColumn":r.XLFreeze.freezeLeftColumn();break;case"UnFreezePanes":r.XLFreeze.unfreezePanes()}break;case r._id+"_Ribbon_Home_Alignment_Merge":t.isNullOrUndefined(i.ID)&&(r.mergeCenter=!0,r.mergeCells());switch(i.ID){case"MergeCells":r.mergeCells();break;case"MergeAcross":r.mergeAcrossCells();break;case"MergeAndCenter":r.mergeCenter=!0;r.mergeCells();break;case"UnmergeCells":r.unmergeCells(e.selectedRange)}break;case r._id+"_Ribbon_Home_Editing_AutoSum":nt=e.selectedRange;i.type==="click"?r.XLRibbon.autoSum("SUM",r._getAlphaRange(f,nt[0],nt[1],nt[2],nt[3])):r.XLRibbon.autoSum(i.ID.toUpperCase(),r._getAlphaRange(f,nt[0],nt[1],nt[2],nt[3]));break;case r._id+"_Ribbon_ChartDesign_ChartLayouts_AddChartElement":r.XLChart.updateChartElement(null,i.ID);break;case r._id+"_Ribbon_ChartDesign_Size_ChartWidth":r.XLRibbon._changeChartSize("height",i.value);break;case r._id+"_Ribbon_ChartDesign_Size_ChartHeight":r.XLRibbon._changeChartSize("width",i.value);break;case r._id+"_Ribbon_ChartDesign_Data_SwitchRowColumn":r.XLChart.switchRowColumn();break;case r._id+"_Ribbon_PictureColor":case r._id+"_Ribbon_Format_Border_PictureBorder":if(["weight","dashes",r._id+"picturecolor",""].indexOf(i.ID)===-1){ht=r.getSheetElement(f).find(".e-ss-activeimg");ci=new RegExp("\\be-shapebdr.*?\\b","g");o=ht[0].className.match(ci)?r.XLShape._getImgStyleFromHashCode(ht[0].className.match(ci)[0]):{"border-color":"transparent","border-width":"1px","border-style":"solid"};var li=o["border-color"],di=o["border-width"],o=o["border-style"];if(ht[0]){switch(!0){case this._id.indexOf("PictureColor")>-1:li=i.value;break;case i.ID.indexOf("px")>-1:di=i.ID;break;case i.ID==="nooutline":li="transparent";break;default:o=i.ID}r.XLShape.changePictureBorder(ht[0].id,di,o,li)}}break;case r._id+"_Ribbon_Format_Adjust_ResetPicture":r.XLShape.resetPicture(null,i.ID);break;case r._id+"_Ribbon_Format_Adjust_ChangePicture":r._uploadImage=!0;r.XLShape._changePicture=!0;r.element.find("#"+r._id+"_file .e-uploadinput").click();r.XLRibbon._toggleFormatTab();break;case r._id+"_Ribbon_ChartDesign_Data_SelectData":r._showDialog(this._id);vi=document.getElementById(r._id+"_chart").value;y=r.XLChart._getShapeObj(vi,"chart");y.isChartSeries||(n("#"+r._id+"_crxaxis").val(y.xRange?r._getAlphaRange(f,y.xRange[0],y.xRange[1],y.xRange[2],y.xRange[3]):""),n("#"+r._id+"_cryaxis").val(y.yRange?r._getAlphaRange(f,y.yRange[0],y.yRange[1],y.yRange[2],y.yRange[3]):""),n("#"+r._id+"_crlaxis").val(y.lRange?r._getAlphaRange(f,y.lRange[0],y.lRange[1],y.lRange[2],y.lRange[3]):""),r._selectDataval={xRange:n("#"+r._id+"_crxaxis").val(),yRange:n("#"+r._id+"_cryaxis").val(),lRange:n("#"+r._id+"_crlaxis").val()},n("#"+r._id+"_chartrangedlg").ejDialog("open"),n("#"+r._id+"_crxaxis").focus().setInputPos(0));break;case r._id+"_Ribbon_ChartDesign_ChartThemes_ChartThemes":r.XLChart.changeTheme(r.element.find("#"+r._id+"_chart").val(),this._selectedValue);break;case r._id+"_Ribbon_Review_Changes_LockCell":r.lockCells(null,i.model.toggleState);break;case r._id+"_Ribbon_Review_Changes_ProtectSheet":r.protectSheet(i.model.toggleState);break;case r._id+"_Ribbon_Review_Changes_ProtectWorkbook":r._showDialog(this._id);ai=n("#"+r._id+"_PasswordDialog").data("ejDialog");r.model.exportSettings.password||(ai.option("title",r._getLocStr("ProtectWorkbook")),n("#"+r._id+"_confirm").show());ai.open()}(this._id.indexOf("Comment")<0&&this._id.indexOf("FindSelect")<0||r.XLSearch._isApplied)&&(r.setSheetFocus(),r.XLSearch._isApplied=!1);r._isRibbonClick=!1}},_applyTextIndent:function(n,i,r,u){var f=this.XLObj,h=f.getActiveSheetIndex(),y={},e=t.Spreadsheet.SupportedStyles,p,w,b,c,l,o,s,a=f.getCell(n.rowIndex,n.colIndex),v=f.getSheet(h);if(l=f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"value2"),o=f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"value"),!(u._id.indexOf("DecreaseIndent")<0)||!f._hasClass(a[0],"e-sswraptext")||!(Math.round(4/3*r)+f._detailsFromGlobalSpan(n.rowIndex,n.colIndex,"width","W")>v.columnsWidthCollection[n.colIndex])){if(f.isFormula(o)&&(o=l),!i[e.TextIndent]&&u._id===f._id+"_Ribbon_Home_Alignment_DecreaseIndent"||r<0)return!1;i[e.TextIndent]=r+"pt";(i[e.TextAlign]==="center"||f.isNumber(o)&&!i[e.TextAlign])&&(i[e.TextAlign]="left");y.style=i;f.XLFormat.format(y,[n.rowIndex,n.colIndex,n.rowIndex,n.colIndex]);!i[e.TextIndent]||f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"merge")||f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"mergeIdx")||(s=a.outerHeight(),s>=f.model.rowHeight&&(a.parent().outerHeight(s),v.rowsHeightCollection[n.rowIndex]=s,f._updateFormatColl(h,n.rowIndex,n.colIndex,s),f._setRowHdrHeight(h,n.rowIndex)),p=f._detailsFromGlobalSpan(n.rowIndex,n.colIndex,"width",l,null,!0),b=4/3*r,w=Math.round(b+p),c=v.columnsWidthCollection[n.colIndex],f.XLResize&&f.isNumber(o)&&u._id===f._id+"_Ribbon_Home_Alignment_IncreaseIndent"&&w>=c&&f.XLResize.setColWidth(n.colIndex,8+c))}},_changeChartSize:function(t,i){if(!this._ctrlCreated){var r=this.XLObj,f,c,e=document.getElementById(r._id+"_chart").value,u=n("#"+e).ejChart("instance"),s=n("#"+e),h=r.XLChart._getShapeObj(e,"chart"),o={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:t,cid:e,rowIndex:r.XLShape._picCellIdx.rowIndex,colIndex:r.XLShape._picCellIdx.colIndex,prev:{width:u.model.size.width,height:u.model.size.height}};c=u.model.size;r.model.allowFormulaBar&&(f=r.element.find(".e-formulabar")[0]);f&&(f.style.display="none");t==="height"?(u.option("size",{width:i.toString()}),h.width=i,s[0].style.width=i+"px",o.cur={width:i.toString(),height:u.model.size.height}):(u.option("size",{height:i.toString()}),h.height=i,s[0].style.height=i+"px",o.cur={width:u.model.size.width,height:i.toString()});f&&(f.style.display="block");r._completeAction(o);r._trigActionComplete(o);r.XLShape._shapeType="chart";r.XLShape._updateShapeObj(s[0]);r.XLShape._shapeType="img"}},_updateBordeStyle:function(n){var t=this.XLObj;t._borderStyle=n.ID&&n.ID.length>0&&n.ID},_colorPickerHandler:function(t,i){var u,r=this.XLObj,f;i.type==="open"?(n("#"+r._id+"_"+t+"_popup").find(".e-buttons, .e-button").hide(),n("#"+r._id+"_"+t+"_popup").focus()):i.type==="change"&&(u=r.XLFormat,f=n("#"+r._id+"_"+t).data("ejColorPicker"),t==="Ribbon_Home_Font_FontColor"?(u.format({style:{color:i.value}}),n("#"+r._id+"_Ribbon_home_Font_Color").find(".e-selected-color").css("background-color",i.value)):(u.format({style:{"background-color":i.value}}),n("#"+r._id+"_Ribbon_home_Font_Background").find(".e-selected-color").css("background-color",i.value)),f.hide(),r._dupDetails=!0,f.setValue(i.value),r._dupDetails=!1)},updateRibbonIcons:function(){this._updateRibbonIcons()},_updateRibbonIcons:function(){var k,i=this.XLObj,d=i.getActiveSheetIndex(),e=i.getSheet(d),r,a,b;if(this.XLObj.model.showRibbon&&(!e._isImported||e._isLoaded)){var y,p,g,w,v,u,o,s=n("#"+i._id+"_Ribbon_Home_Number_NumberFormat").data("ejDropDownList"),h,c=n("#"+i._id+"_Ribbon_Home_Font_FontSize").data("ejDropDownList"),nt=!1;n("#"+i._id+"_Ribbon_Home_Font_FontSize").css("width","auto");var l=n("#"+i._id+"_Ribbon_Home_Font_FontFamily").data("ejDropDownList"),f=-1,tt=n("#"+i._id+"_Ribbon").data("ejRibbon"),it=tt.getTabText(tt.model.selectedItemIndex);switch(it){case i._getLocStr("HOME"):if(o=e._activeCell,w=i.XLEdit.getPropertyValue(o.rowIndex,o.colIndex,"wrap"),g=i.XLEdit.getPropertyValue(o.rowIndex,o.colIndex,"merge"),k=i.XLEdit.getPropertyValue(o.rowIndex,o.colIndex,"format"),v=i.XLEdit.getPropertyValue(o.rowIndex,o.colIndex,"type"),t.isNullOrUndefined(i.XLFormat)||(u=i.XLFormat.getFormatFromHashCode(k)),i.isUndefined(w)&&(w=!1),n("#"+i._id+"_Ribbon_Home_Alignment_WrapText").ejToggleButton("option",{toggleState:w}),i.isUndefined(g)?(n("#"+i._id+"_Ribbon_Home_Alignment_Merge").removeClass("e-ss-active"),n("#"+i._id+"_Ribbon_Home_Alignment_Mergedrpbtn").removeClass("e-ss-active")):(n("#"+i._id+"_Ribbon_Home_Alignment_Merge").addClass("e-ss-active"),n("#"+i._id+"_Ribbon_Home_Alignment_Mergedrpbtn").addClass("e-ss-active")),["date"].indexOf(v)>-1&&(v="custom"),v)for(f=-1,r=0,a=this._numberFormat.length;r<a;r++)if(v===this._numberFormat[r].text.toLowerCase()){f=r;break}if(t.isNullOrUndefined(s)||(s._initValue=!0,f>-1?s.option({selectedItemIndex:f}):!t.isNullOrUndefined(s.selectedIndexValue)&&s.selectedIndexValue!=0&&s.option({selectedItemIndex:0}),s._initValue=!1),u){if(f=-1,!t.isNullOrUndefined(u["font-size"]))for(r=0,a=this._fontSize.length;r<a;r++)if(u["font-size"]===this._fontSize[r].value){f=r;break}if(!t.isNullOrUndefined(c)&&(c._initValue=!0,f>-1?c.option({selectedItemIndex:f})||(f=-1):!t.isNullOrUndefined(c.selectedIndexValue)&&c.selectedIndexValue!=3&&c.option({selectedItemIndex:3}),c._initValue=!1,f=-1,!t.isNullOrUndefined(u["font-family"])))for(r=0,a=this._fontFamily.length;r<a;r++)if(u["font-family"]===this._fontFamily[r].text.toLowerCase()){f=r;break}t.isNullOrUndefined(l)||(l._initValue=!0,f>-1?l.option({selectedItemIndex:f}):!t.isNullOrUndefined(l.selectedIndexValue)&&l.selectedIndexValue!=6&&l.option({selectedItemIndex:6}),l._initValue=!1);n("#"+i._id+"_Ribbon_Home_Font_Bold").length&&(u["font-weight"]=="bold"?n("#"+i._id+"_Ribbon_Home_Font_Bold").data("ejToggleButton").option("toggleState",!0):n("#"+i._id+"_Ribbon_Home_Font_Bold").data("ejToggleButton").option("toggleState",!1));n("#"+i._id+"_Ribbon_Home_Font_Italic").length&&(u["font-style"]=="italic"?n("#"+i._id+"_Ribbon_Home_Font_Italic").data("ejToggleButton").option("toggleState",!0):n("#"+i._id+"_Ribbon_Home_Font_Italic").data("ejToggleButton").option("toggleState",!1));u["text-decoration"]=u["text-decoration"]||"";n("#"+i._id+"_Ribbon_Home_Font_Underline").length&&n("#"+i._id+"_Ribbon_Home_Font_Underline").data("ejToggleButton").option("toggleState",u["text-decoration"].indexOf("underline")!==-1);n("#"+i._id+"_Ribbon_Home_Font_StrikeThrough").length&&n("#"+i._id+"_Ribbon_Home_Font_StrikeThrough").data("ejToggleButton").option("toggleState",u["text-decoration"].indexOf("line-through")!==-1);this._tglAlignBtn(n(i.element).find(".e-text-align"),u,"text-align");nt=this._tglAlignBtn(n(i.element).find(".e-vertical-align"),u,"vertical-align").isVertical;nt||(h=i.element.find("#"+i._id+"_Ribbon_Home_Alignment_BottomAlign"),h.length&&(h.data("ejToggleButton").option("toggleState",!0),h.addClass("e-vertical-align")));i.getSheetElement(d).find(".e-ss-activeimg").length>0&&(h=i.element.find("#"+i._id+"_Ribbon_Home_Alignment_Merge"),h.length&&h.data("ejSplitButton").option("enabled",!1))}break;case i._getLocStr("REVIEW"):b=n("#"+i._id+"_Ribbon_Review_Changes_LockCell");!i.model.allowLockCell||i.XLComment&&i.XLComment._isCommentEdit||i.XLEdit._isEdit||i._isSheetRename||!b.length||(p=b.data("ejToggleButton"),y=i.XLEdit.getPropertyValue(e._activeCell.rowIndex,e._activeCell.colIndex,"isLocked"),i.isUndefined(y)&&(y=!1),p.option("toggleState",y),n("#"+i._id+"_Ribbon_Review_Changes_ProtectSheet").length&&n("#"+i._id+"_Ribbon_Review_Changes_ProtectSheet").data("ejToggleButton").option("toggleState",e.isSheetProtected),e.isSheetProtected?p.disable():p.enable());e.isSheetProtected&&i.model.allowLockCell||!i.model.allowComments||i.XLComment._isCommentEdit||i.XLEdit._isEdit||i._isSheetRename||i.XLComment._updateCmntRibIcons(i.getActiveCell())}!i.model.allowLockCell||e.isSheetProtected||!i.model.allowComments||i.XLComment._isCommentEdit||i._isSheetRename||this._refreshRibbonIcons(it);i.model.isReadOnly&&i._readOnly()}},_tglAlignBtn:function(n,i,r){var e=!1,u,f=this.XLObj;return t.isNullOrUndefined(n[0])||(u=f.element.find("#"+n[0].id),u.length&&u.data("ejToggleButton").option("toggleState",!1),n.removeClass("e-"+r)),t.isNullOrUndefined(i[r])||(u=r==="vertical-align"?f.element.find("#"+f._id+"_Ribbon_Home_Alignment_"+i[r].charAt(0).toUpperCase()+i[r].slice(1)+"Align"):f.element.find("#"+f._id+"_Ribbon_Home_Alignment_Align"+i[r].charAt(0).toUpperCase()+i[r].slice(1)),u.length&&(u.data("ejToggleButton").option("toggleState",!0),u.addClass("e-"+r)),r==="vertical-align"&&(e=!0)),{isVertical:e}},_disableButtons:function(n,i){for(var e=-1,f,r=this.XLObj,u=0,o=n.length;u<o;u++)r.model.allowLockCell&&(r.XLEdit._isEdit||r._isSheetRename||!r.getSheet(r.getActiveSheetIndex()).isSheetProtected||(e=this._protectStateBtnIds.indexOf(n[u]))),e===-1&&(f=r.element.find("#"+r._id+"_Ribbon_"+n[u]),f.length&&!t.isNullOrUndefined(f.data(i))&&f.data(i).disable())},_enableButtons:function(n,i){for(var e=0,f,r=this.XLObj,u=0,o=n.length;u<o;u++)r.model.allowLockCell&&!r._isSheetRename&&r.getSheet(r.getActiveSheetIndex()).isSheetProtected&&(e=this._protectStateBtnIds.indexOf(n[u])),e>-1&&(f=r.element.find("#"+r._id+"_Ribbon_"+n[u]),f.length&&!t.isNullOrUndefined(f.data(i))&&f.data(i).enable())},_disableInputs:function(t,i){for(var r=0,u=t.length;r<u;r++)n("#"+this.XLObj._id+"_"+t[r]).attr("disabled",i)},_enableRibbonIcons:function(t){if(this.XLObj.model.showRibbon){var c,i=this.XLObj,r=n("#"+i._id+"_Ribbon").data("ejRibbon"),l=i.getActiveSheetIndex(),f=i.getSheet(l)._filterColl,h,u,e,o,s;c=t?t:r.model.selectedItemIndex;switch(r.getTabText(c)){case i._getLocStr("HOME"):this._enableButtons(this._homeBtnIds,"ejButton");this._enableButtons(this._homeSptBtnIds,"ejSplitButton");this._enableButtons(this._homeToggleBtnIds,"ejToggleButton");this._enableButtons(this._homeDdIds,"ejDropDownList");this._enableButtons(this._homeCpIds,"ejColorPicker");i._removeClass(r.element.find("#"+r._id+"_Number_e-groupexpander")[0],"e-disable");break;case i._getLocStr("INSERT"):this._enableButtons(this._insertBtnIds,"ejButton");this._enableButtons(this._insertSptBtnIds,"ejSplitButton");break;case i._getLocStr("DATATAB"):this._enableButtons(this._dataBtnIds,"ejButton");this._enableButtons(this._dataSptBtnIds,"ejSplitButton");break;case i._getLocStr("PAGELAYOUT"):this._enableButtons(this._pageLayBtnIds,"ejButton");this._enableButtons(this._pageLaySptBtnIds,"ejSplitButton");this._enableButtons(this._pageLayChckBxIds,"ejCheckBox");n("#"+r._id+"_pagesetup_viewhdrlbl").eq(0).removeClass("e-disable");n("#"+r._id+"_pagesetup_viewgrdlnlbl").eq(0).removeClass("e-disable");break;case i._getLocStr("REVIEW"):i.model.allowComments&&!i.XLComment._isCommentEdit&&i.XLComment._updateCmntRibIcons();this._enableButtons(this._reviewTglBtnIds,"ejToggleButton");break;case i._getLocStr("OTHERS"):this._enableButtons(this._othersBtnIds,"ejButton");this._enableButtons(this._othersSptBtnIds,"ejSplitButton");break;case i._getLocStr("Design"):this._enableButtons(this._contextualBtnIds,"ejButton");this._enableButtons(this._contextualCheckBoxIds,"ejCheckBox");this._disableInputs(this._contextualInputIds,!1)}for(i.XLClipboard._copyBackup.cells||i.XLClipboard._copyBackup.elem||(i.XLRibbon._disableButtons(["Home_Clipboard_Paste"],"ejButton")||i.XLRibbon._disableButtons(["Home_Clipboard_PasteOptions"],"ejSplitButton"),i.isPasteValuesOnly&&n("#"+i._id+"_Ribbon_Paste").data("ejMenu").disableItemByID("PasteSpecial")),n.isEmptyObject(f)&&this._disableButtons(["Data_SortFilter_ClearFilter"],"ejButton"),s=i.getObjectKeys(f),u=0,o=s.length;u<o;u++)for(h=i.getObjectKeys(f[s[u]]),e=0,o=h.length;e<o;e++)f[s[u]][h[e]].status.indexOf("e-ssfiltered")<0&&this._disableButtons(["Data_SortFilter_ClearFilter"],"ejButton");i._updateUndoRedoIcons()}},_disableRibbonIcons:function(){var t=this.XLObj,i;if(t.model.showRibbon){i=n("#"+t._id+"_Ribbon").data("ejRibbon");switch(i.getTabText(i.model.selectedItemIndex)){case t._getLocStr("HOME"):this._disableButtons(this._homeBtnIds,"ejButton");this._disableButtons(this._homeSptBtnIds,"ejSplitButton");this._disableButtons(this._homeToggleBtnIds,"ejToggleButton");this._disableButtons(this._homeDdIds,"ejDropDownList");this._disableButtons(this._homeCpIds,"ejColorPicker");t.addClass(i.element.find("#"+i._id+"_Number_e-groupexpander"),"e-disable");break;case t._getLocStr("INSERT"):this._disableButtons(this._insertBtnIds,"ejButton");this._disableButtons(this._insertSptBtnIds,"ejSplitButton");break;case t._getLocStr("DATATAB"):this._disableButtons(this._dataBtnIds,"ejButton");this._disableButtons(this._dataSptBtnIds,"ejSplitButton");break;case t._getLocStr("PAGELAYOUT"):this._disableButtons(this._pageLayBtnIds,"ejButton");this._disableButtons(this._pageLaySptBtnIds,"ejSplitButton");this._disableButtons(this._pageLayChckBxIds,"ejCheckBox");n("#"+i._id+"_pagesetup_viewhdrlbl:eq(0)").addClass("e-disable");n("#"+i._id+"_pagesetup_viewgrdlnlbl:eq(0)").addClass("e-disable");break;case t._getLocStr("REVIEW"):this._disableButtons(this._cmntBtnIds,"ejButton");this._disableButtons(this._cmntTglBtnIds,"ejToggleButton");this._disableButtons(this._reviewTglBtnIds,"ejToggleButton");break;case t._getLocStr("OTHERS"):this._disableButtons(this._othersBtnIds,"ejButton");this._disableButtons(this._othersSptBtnIds,"ejSplitButton");break;case this.XLObj._getLocStr("Design"):this._disableButtons(this._contextualBtnIds,"ejButton");this._disableButtons(this._contextualCheckBoxIds,"ejCheckBox");this._disableInputs(this._contextualInputIds,!0)}}},_capitalize:function(n){return n[0].toUpperCase()+n.slice(1)},_generateToggleBtn:function(n,i,r,u,f,e,o,s,h,c,l,a,v,y){var p=s instanceof Array?this.XLObj._getLocStr(s[0])+"<br /><br />"+this.XLObj._getLocStr(s[1]):this.XLObj._getLocStr(s);return{id:n,toolTip:this.XLObj._getLocStr(i),type:t.Ribbon.type.toggleButton,enableSeparator:h,toggleButtonSettings:{width:e,height:o,contentType:r,cssClass:c,toggleState:y,defaultPrefixIcon:u,activePrefixIcon:v?v:u,defaultText:this.XLObj._getLocStr(i),activeText:a?this.XLObj._getLocStr(a):this.XLObj._getLocStr(i),imagePosition:l=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,click:this._ribbonClickHandler},customToolTip:{title:this.XLObj._getLocStr(f),content:"<h6>"+p+"<\/h6>"}}},_generateBtn:function(n,i,r,u,f,e,o,s,h,c,l){var a=s instanceof Array?this.XLObj._getLocStr(s[0])+"<br /><br />"+this.XLObj._getLocStr(s[1]):this.XLObj._getLocStr(s);return{id:n,text:this.XLObj._getLocStr(i),toolTip:this.XLObj._getLocStr(i),cssClass:l,enableSeparator:h,buttonSettings:{type:t.Ribbon.type.button,contentType:r,width:f,height:e,imagePosition:c=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,prefixIcon:u,click:this._ribbonClickHandler},customToolTip:{title:this.XLObj._getLocStr(o),content:"<h6>"+a+"<\/h6>"}}},_generateDD:function(n,i,r,u,f,e,o,s){return{id:n,text:this.XLObj._getLocStr(i),toolTip:this.XLObj._getLocStr(i),type:t.Ribbon.type.dropDownList,dropdownSettings:{dataSource:r,value:u,change:this._ribbonClickHandler,width:f,height:e-1,cssClass:"e-"+this.XLObj._id+"-ddl"},customToolTip:{title:this.XLObj._getLocStr(o),content:"<h6>"+this.XLObj._getLocStr(s)+"<\/h6>"}}},_generateCustomControl:function(n,i,r,u){return{type:t.Ribbon.type.custom,contentID:n,toolTip:this.XLObj._getLocStr(i),click:this._ribbonClickHandler,change:this._ribbonClickHandler,customToolTip:{title:this.XLObj._getLocStr(r),content:"<h6>"+this.XLObj._getLocStr(u)+"<\/h6>"}}},_generateSplitBtn:function(i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){var b=w instanceof Array?this.XLObj._getLocStr(w[0])+"<br /><br />"+this.XLObj._getLocStr(w[1]):this.XLObj._getLocStr(w);return{id:i,toolTip:this.XLObj._getLocStr(r),text:this.XLObj._getLocStr(r),type:t.Ribbon.type.splitButton,cssClass:y+" e-"+this.XLObj._id+"-spltbtn",enableSeparator:s,splitButtonSettings:{contentType:u,targetID:f,arrowPosition:l=="bottom"?t.ArrowPosition.Bottom:t.ArrowPosition.Right,imagePosition:a=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,buttonMode:v=="dropdown"?t.ButtonMode.Dropdown:t.ButtonMode.Split,fields:e,prefixIcon:o,click:this._ribbonClickHandler,itemSelected:this._ribbonClickHandler,height:c,width:h,beforeOpen:n.proxy(this._splitBeforeOpen,this,i),close:i==="Others_Cells_InsertCellOptions"||i==="Others_Cells_DeleteCellOptions"||i==="Data_DataTools_DataValidationOptions"||i==="Home_Clipboard_PasteOptions"?n.proxy(this._splitbtnClose,this,i):null},customToolTip:{title:this.XLObj._getLocStr(p),content:"<h6>"+b+"<\/h6>"}}},_splitBeforeOpen:function(t,i){var r=this.XLObj,u;t==="Home_Editing_SortFilter"?this._sfbeforeOpen(i):t==="Others_Cells_InsertCellOptions"||t==="Others_Cells_DeleteCellOptions"?this._insdelbeforOpen(i):t==="Others_Window_FreezePanes"?this._fpbeforeOpen(i):t==="ChartDesign_ChartLayouts_AddChartElement"?this._celementpbeforeOpen(i):t==="Data_DataTools_DataValidationOptions"||t==="Home_Clipboard_PasteOptions"?this._validpasteOpen(i):t==="Home_Editing_Clear"?this._clearbeforeOpen(i):t==="Home_Styles_FormatAsTable"?(u=document.getElementById(r._id+"_formatastable"),u&&(!u||u.children.length)||this._renderFormatAsTable(),r.XLFormat._resizeFormatTableMenu()):t==="Home_Styles_CellStyles"?r.XLFormat._resizeStyleMenu():t==="Home_Font_Border"?(r.XLFormat._resizeBorderMenu(i),this._renderBorderCP(i)):t==="Home_Styles_ConditionalFormatting"&&(n("#"+r._id+"_CFormat").width(200),r._phoneMode?n("#"+r._id+"_CFormat").find("ul").addClass("e-adaptive"):n("#"+r._id+"_CFormat").find("ul").removeClass("e-adaptive"))},_renderBorderCP:function(){var i=this.XLObj._id,t=i+"_Ribbon_Home_Font_",r=n("#"+t+"BorderColor").data("ejColorPicker");r||(n("#"+t+"BorderColor").ejColorPicker({modelType:"palette",presetType:"basic",cssClass:"e-ss-colorpicker e-ss-menuclrpkr",change:this._ribbonClickHandler}),n("#"+t+"BorderColorWrapper").hide(),n("#"+i+"_bordercolor ul li").find("a").remove(),n("#"+i+"_bordercolor ul li").append(n("#"+t+"BorderColor_popup")),n("#"+t+"BorderColor_popup").css({display:"block"}))},_splitbtnClose:function(n){this.XLObj.element.find("#"+this.XLObj._id+"_Ribbon_"+n).parents("div.e-controlpadding").siblings().children("button").removeClass("e-active")},_fpbeforeOpen:function(){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_FPane").data("ejMenu"),t=r.model.fields.dataSource.slice(0);i.getSheet()._isFreezed?(t[0].id="UnFreezePanes",t[0].text=i._getLocStr("UnFreezePanes")):(t[0].id="freezePanes",t[0].text=i._getLocStr("FreezePanes"));r.option("fields",{id:"id",dataSource:t,parentId:"parentId"})},_sfbeforeOpen:function(){var i=this.XLObj,t=n("#"+i._id+"_Ribbon_SortFilter").data("ejMenu");i.model.allowFiltering||t.disableItemByID("Ribbon_Filter");i.model.allowSorting||(t.disableItemByID("Ribbon_SortAtoZ"),t.disableItemByID("Ribbon_SortZtoA"));this._refreshRibbonIcons();this._isFilterSelect.isFiltered?t.enableItemByID("Ribbon_ClearFilter"):t.disableItemByID("Ribbon_ClearFilter")},_validpasteOpen:function(n){var t=this.XLObj;n.model.targetID===t._id+"_Ribbon_Validation"?t.element.find("#"+t._id+"_Ribbon_Data_DataTools_DataValidation").addClass("e-active"):t.element.find("#"+t._id+"_Ribbon_Home_Clipboard_Paste").addClass("e-active")},_insdelbeforOpen:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_Ins").data("ejMenu"),u=n("#"+i._id+"_Ribbon_Del").data("ejMenu"),h=["DeleteCells","DeleteSheetRows","DeleteSheetColumns"],c=["InsertCells","InsertSheetRows","InsertSheetColumns"],e,o,s,f;if(t.model.targetID===i._id+"_Ribbon_Ins"?i.element.find("#"+i._id+"_Ribbon_Others_Cells_InsertCell").addClass("e-active"):i.element.find("#"+i._id+"_Ribbon_Others_Cells_DeleteCell").addClass("e-active"),e=i.element.find(".e-colselected").length?"disableItemByID":"enableItemByID",r&&r[e]("InsertSheetRows"),u&&u[e]("DeleteSheetRows"),o=i.element.find(".e-rowselected").length?"disableItemByID":"enableItemByID",r&&r[o]("InsertSheetColumns"),u&&u[o]("DeleteSheetColumns"),s=i.model.exportSettings.password?"disableItemByID":"enableItemByID",r&&r[s]("InsertSheet"),u&&u[s]("DeleteSheet"),i.getSheet(i.getActiveSheetIndex()).isSheetProtected)for(f=0;f<3;f++)u&&u.disableItemByID(h[f]),r&&r.disableItemByID(c[f]);else u&&u.enableItemByID("DeleteCells"),r&&r.enableItemByID("InsertCells")},_celementpbeforeOpen:function(){var u=this.XLObj,h=n("#"+u._id+"_chart").val(),f=u.XLChart._getShapeObj(h,"chart").type,r=n("#"+u._id+"_Ribbon_CElement").data("ejMenu"),e=["Axes","AxisTitle","Gridline"],o=["AxisTitle","PMinorH","PMinorV"],s=["Axes","AxisTitle","Gridline","PMinorH","PMinorV"],t,i=0;if(r)return!1;for(t=0,i=s.length;t<i;t++)r.enableItemByID(s[t]);if(f==="pie"||f==="doughnut")for(t=0,i=e.length;t<i;t++)r.disableItemByID(e[t]);else if(f==="radar")for(t=0,i=o.length;t<i;t++)r.disableItemByID(o[t])},_clearbeforeOpen:function(){var i=this.XLObj,t=0,u=n("#"+i._id+"_Ribbon_Clear").data("ejMenu"),r=["Clear_Hyperlinks","Clear_Comments"];if(i.model.allowLockCell)if(i.getSheet(i.getActiveSheetIndex()).isSheetProtected)while(t<r.length)u.disableItemByID(r[t]),t++;else while(t<r.length)u.enableItemByID(r[t]),t++},_changeClrFltrStatus:function(n,t){var i=this.XLObj,r=i.getActiveSheetIndex();i.isUndefined(n)||(this._isFilterSelect.isFiltered?t==="menu"?n._id.indexOf("Ribbon")>-1?n.enableItemByID("Ribbon_ClearFilter"):n.enableItemByID("ClearFilter"):n.enable():t==="menu"?n._id.indexOf("Ribbon")>-1?n.disableItemByID("Ribbon_ClearFilter"):n.disableItemByID("ClearFilter"):n.disable())},_onControlCreated:function(){var t=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("instance");this._ctrlCreated=!0;this.XLObj.model.ribbonSettings.enableOnDemand||(this._homeTabControls(),this._othersTabControls(),this._pageTabControls(),this._appTabControls());this._hideTabs();this._ctrlCreated=!1},_appTabControls:function(){var r=this.XLObj,u=r.element,i=r._id,t={height:158,width:163,text:r._getLocStr("BlankWorkbook"),contentType:"textandimage",imagePosition:"imagetop",prefixIcon:"e-ss-blank",click:n.proxy(this._onBackStageItemClick,this)};n("#"+i+"_bstab_new_blank").ejButton(t);delete t.text;t.height=t.width=72;t.prefixIcon="e-icon e-ss-exportxl";n("#"+i+"_bstab_saveas_excel").ejButton(t);t.prefixIcon="e-icon e-ss-exportcsv";n("#"+i+"_bstab_saveas_csv").ejButton(t);t.prefixIcon="e-icon e-ss-exportpdf";n("#"+i+"_bstab_saveas_pdf").ejButton(t);t.prefixIcon="e-icon e-ss-print";n("#"+i+"_bstab_print_sheet").ejButton(t);t.prefixIcon="e-icon e-ss-printselected";n("#"+i+"_bstab_print_selected").ejButton(t)},_othersTabControls:function(){var n=this.XLObj;!n.model.allowInsert&&n.model.scrollSettings.allowScrolling&&(this._disableButtons(["Others_Cells_InsertCellOptions"],"ejSplitButton"),this._disableButtons(["Others_Cells_InsertCell"],"ejButton"));!n.model.allowDelete&&n.model.scrollSettings.allowScrolling&&(this._disableButtons(["Others_Cells_DeleteCellOptions"],"ejSplitButton"),this._disableButtons(["Others_Cells_DeleteCell"],"ejButton"))},_pageTabControls:function(){var t=this.XLObj,r=t._id,i=r+"_Ribbon_pagesetup",u=r+"_Ribbon_PageLayout_Show_";n("#"+i+"left").show();n("#"+u+"Headings").ejCheckBox({change:this._ribbonClickHandler,checked:!0});n("#"+u+"Gridlines").ejCheckBox({change:this._ribbonClickHandler,checked:!0});n("#"+i+"_viewhdrlbl").text(t._getLocStr("Heading"));n("#"+i+"_viewgrdlnlbl").text(t._getLocStr("Gridlines"))},_homeTabControls:function(){var r=this.XLObj,u=r._id,f=r.element,i=u+"_Ribbon_",t=i+"Home_Font_";n("#"+t+"FillColor").ejColorPicker({value:"#FFFF00",modelType:"palette",showSwitcher:!1,cssClass:"e-ss-colorpicker",toolIcon:"e-ss-backgroundcolor",open:n.proxy(this._colorPickerHandler,this,"Ribbon_Home_Font_FillColor"),change:n.proxy(this._colorPickerHandler,this,"Ribbon_Home_Font_FillColor"),select:n.proxy(this._cpClickHandler,this,"Ribbon_Home_Font_FillColor")});n("#"+t+"FontColor").ejColorPicker({value:"#FF0000",modelType:"palette",showSwitcher:!1,cssClass:"e-ss-colorpicker",toolIcon:"e-ss-fontcolor",open:n.proxy(this._colorPickerHandler,this,"Ribbon_Home_Font_FontColor"),change:n.proxy(this._colorPickerHandler,this,"Ribbon_Home_Font_FontColor"),select:n.proxy(this._cpClickHandler,this,"Ribbon_Home_Font_FontColor")});n("#"+i+"BorderCP").ejColorPicker({value:"#278787",displayInline:!0,modelType:"picker"});n("#"+i+"BorderCP_Presets").hide();n("#"+i+"Border").addClass("e-spreadsheet e-border");n("#"+t+"FontColor_Presets").css({top:"40px"});n("#"+t+"FillColor_Presets").css({top:"40px"});this._disableButtons(["Home_Clipboard_Paste"],"ejButton");this._disableButtons(["Home_Clipboard_PasteOptions","Others_Formulas_UseInFormula"],"ejSplitButton");n("#"+t+"FillColor_popup").find(".e-buttons, .e-button").hide();n("#"+t+"FontColor_popup").find(".e-buttons, .e-button").hide()},_hideRibbonElem:function(t){var f=this.XLObj,s=f._id,h=n("#"+f._id+"_Ribbon").data("ejRibbon"),i=f.model,r=h.element,u=s+"_Ribbon",y=u+"_home_Clipboard_Home_Clipboard_",e=u+"_home_Alignment_Home_Alignment_",p=u+"_separator_Home_Alignment_",a=u+"_home_Styles_Home_Styles_",b=u+"_home_Font_Home_Font_",k=u+"_home_Number_Home_Number_",w=u+"_home_Editing_Home_Editing_",o=u+"_insert_",v=u+"_data_",d=u+"_pagelayout_PageLayout",g=u+"_review_Changes_Review_Changes_",c=u+"_others_",l;i.allowFormulaBar||f.hideFormulaBar();switch(t){case f._getLocStr("HOME"):i.allowAutoSum||i.allowFiltering||i.allowUndoRedo||i.allowSorting||i.allowClipboard||i.allowFormatPainter||i.allowCellFormatting||i.allowMerging||i.allowWrap||i.allowConditionalFormats||i.allowFormatAsTable||h.hideTab(f._getLocStr("HOME"));i.allowFormatPainter||r.find("#"+y+"FormatPainter").hide();i.allowClipboard||(r.find("#"+u+"_home_Clipboard_1").hide(),r.find("#"+y+"Cut").hide(),r.find("#"+y+"Copy").hide());i.allowClipboard||i.allowFormatPainter||r.find("#"+u+"_home_Clipboard").hide();i.allowCellFormatting||(r.find("#"+u+"_home_Font").hide(),r.find("#"+u+"_home_Number").hide(),r.find("#"+e+"TopAlign").hide(),r.find("#"+e+"MiddleAlign").hide(),r.find("#"+e+"BottomAlign").hide(),r.find("#"+p+"BottomAlign").hide(),r.find("#"+e+"AlignLeft").hide(),r.find("#"+e+"AlignCenter").hide(),r.find("#"+e+"AlignRight").hide(),r.find("#"+p+"AlignRight").hide(),r.find("#"+e+"DecreaseIndent").hide(),r.find("#"+e+"IncreaseIndent").hide(),r.find("#"+p+"IncreaseIndent").hide(),r.find("#"+a+"CellStyles").hide(),i.allowConditionalFormats||i.allowFormatAsTable||r.find("#"+u+"_home_Styles").hide());i.allowCellFormatting&&(i.formatSettings.allowFontFamily||r.find("#"+b+"FontFamily").hide(),i.formatSettings.allowDecimalPlaces||(r.find("#"+k+"IncreaseDecimal").hide(),r.find("#"+k+"DecreaseDecimal").hide(),r.find("#"+u+"_separator_Home_Number_CommaStyle").hide()),i.formatSettings.allowCellBorder||r.find("#"+b+"Border").hide());i.allowMerging||r.find("#"+e+"Merge").hide();i.allowWrap||r.find("#"+e+"WrapText").hide();i.allowUndoRedo||r.find("#"+u+"_home_Actions").hide();i.allowFormatAsTable||r.find("#"+a+"FormatAsTable").hide();i.allowConditionalFormats||i.allowFormatAsTable||i.allowCellFormatting||r.find("#"+u+"_home_Styles").hide();i.allowConditionalFormats||r.find("#"+a+"ConditionalFormatting").hide();i.allowEditing&&(i.allowAutoSum||r.find("#"+w+"AutoSum").hide(),i.allowSorting||i.allowFiltering||r.find("#"+f._id+"_Ribbon_home_Editing_1").hide());i.allowAutoSum||r.find("#"+w+"AutoSum").hide();i.allowClear||r.find("#"+w+"Clear").hide();break;case f._getLocStr("INSERT"):i.allowFormatAsTable||i.allowPictures||i.allowHyperlink||i.allowCharts||h.hideTab(f._getLocStr("INSERT"));i.enablePivotTable||i.allowFormatAsTable?i.enablePivotTable?i.allowFormatAsTable||r.find("#"+o+"Tables_Insert_Tables_Table").hide():r.find("#"+o+"Tables_Insert_Tables_PivotTable").hide():(r.find("#"+o+"Tables").hide(),r.find("#"+a+"FormatAsTable").hide(),r.find("#"+o+"Tables_Insert_Tables_PivotTable").hide());i.pictureSettings.allowPictures||r.find("#"+o+"Illustrations").hide();i.allowHyperlink||r.find("#"+o+"Links").hide();i.allowCharts||r.find("#"+o+"Charts").hide();i.allowFormatAsTable||i.enablePivotTable||r.find("#"+o+"Tables").hide();break;case f._getLocStr("DATATAB"):i.allowDataValidation||i.allowFiltering||i.allowSorting||h.hideTab(f._getLocStr("DATATAB"));i.allowFiltering||r.find("#"+v+"SortFilter_2").hide();i.allowSorting||r.find("#"+v+"SortFilter_1").hide();i.allowDataValidation||r.find("#"+v+"DataTools").hide();i.allowFiltering||i.allowSorting||r.find("#"+v+"Sort").hide();break;case f._getLocStr("PAGELAYOUT"):i.printSettings.allowPrinting||h.hideTab(f._getLocStr("PAGELAYOUT"));i.printSettings.allowPrinting||r.find("#"+d+"Print_Print").hide();i.printSettings.allowPageSize||r.find("#"+d).hide();i.allowComments||i.allowLockCell||h.hideTab(f._getLocStr("REVIEW"));i.allowLockCell||(r.find("#"+g+"ProtectSheet").hide(),r.find("#"+g+"LockCell").hide());i.allowComments||r.find("#"+u+"_review_Comments").hide();break;case f._getLocStr("OTHERS"):i.allowFreezing||i.allowInsert||i.allowDelete||i.allowSearching||h.hideTab(f._getLocStr("OTHERS"));i.allowInsert||i.allowDelete||r.find("#"+c+"Cells").hide();i.allowInsert||r.find("#"+c+"Cells_1").hide();i.allowDelete||r.find("#"+c+"Cells_2").hide();i.allowFreezing||(f._phoneMode?r.find("#"+c+"Window_1").hide():r.find("#"+c+"Window").hide());i.allowSearching||r.find("#"+c+"Editing").hide()}i.allowImport||r.find("#open_backStageTab").hide();i.serverEvents?(l=i.serverEvents,l.indexOf("excelExporting")<0&&!i.exportSettings.excelUrl&&r.find("#"+s+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(0)").hide(),l.indexOf("csvExporting")<0&&!i.exportSettings.csvUrl&&r.find("#"+s+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(1)").hide(),l.indexOf("pdfExporting")<0&&!i.exportSettings.pdfUrl&&r.find("#"+s+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(2)").hide(),l.length||i.exportSettings.excelUrl||i.exportSettings.csvUrl||i.exportSettings.pdfUrl||r.find("#saveas_backStageTab").hide()):(i.exportSettings.excelUrl||r.find("#"+s+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(0)").hide(),i.exportSettings.csvUrl||r.find("#"+s+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(1)").hide(),i.exportSettings.pdfUrl||r.find("#"+s+"_backstagetabsaveas .e-ssr-bssaveasopt:eq(2)").hide(),i.exportSettings.allowExporting&&(i.exportSettings.excelUrl||i.exportSettings.csvUrl||i.exportSettings.pdfUrl)||r.find("#saveas_backStageTab").hide());i.printSettings.allowPrinting||r.find("#print_backStageTab").hide()},_pictureSizeChange:function(t,i){var u=this.XLObj,f,o=u.getActiveSheetIndex(),r=u.getSheetElement(o).find(".e-ss-activeimg"),e={sheetIndex:o,reqType:"shape",shapeType:"picture",action:"picturesize",name:t,id:n(r).attr("id"),prev:{},cur:{}};u._shapeChange||this._isSetModel||(e.prev={width:r.width(),height:r.height()},t==="PictureHeight"?(f=parseInt(r.height()*i.value/r.width()),r.css({width:i.value,height:f}),e.cur={width:i.value,height:f}):(f=parseInt(r.width()*i.value/r.height()),r.css({height:i.value,width:f}),e.cur={height:i.value,width:f}),this._isSetModel=!0,n("#"+u._id+"_Ribbon_Format_Size_"+t).ejNumericTextbox("option",{value:f}),this._isSetModel=!1,u._completeAction(e),u._trigActionComplete(e),u.XLShape._updateShapeObj(r[0]))},_chartTypeOk:function(){var r=this.XLObj,o=r.element.find("#"+r._id+"_chart").val(),u=n("#"+o).data("ejChart"),f,t,e,s,h,i;e=n("#"+r._id+"_allchart").find(".e-chartselect:eq(0)").attr("class").split(" ")[1];t=e.split("e-dlg")[1].split("chart");s=["e-dlgcolumnchart4","e-dlgcolumnchart5","e-dlgcolumnchart6","e-dlgbarchart4","e-dlgbarchart5","e-dlgbarchart6","e-dlgpiechart2"];h=["e-dlgstockchart2","e-dlglinechart2","dlgradarchart2"];i={type:t[0],enable3D:!1,marker:{visible:!1}};(t[0]==="column"||t[0]==="bar"||t[0]==="area")&&(t[1]==="1"||t[1]==="4"?i.type=t[0]:t[1]==="2"||t[1]==="5"?i.type="stacking"+t[0]:(t[1]==="3"||t[1]==="6")&&(i.type="stacking"+t[0]+"100"));s.indexOf(e)>-1&&(i.enable3D=!0);h.indexOf(e)>-1&&(i.marker={visible:!0});e==="e-dlgpiechart3"&&(i.type="doughnut");f={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:"chartType",chartId:o};f.prev={chartType:u.model.series[0].type,enable3D:u.model.enable3D,marker:u.model.series[0].marker.visible};i.series=u.model.series;r.XLChart.refreshChart(o,i);f.cur={chartType:u.model.series[0].type,enable3D:u.model.enable3D,marker:u.model.series[0].marker.visible};n("#"+r._id+"_charttypedlg").ejDialog("close");r._completeAction(f);r._trigActionComplete(f)},_chartTypeCancel:function(){var t=this.XLObj;n("#"+t._id+"_charttypedlg").ejDialog("close");t.setSheetFocus()},_chartType:function(t,i,r,u,f,e){for(var v,y,l,c,a,p="<div class='e-chartheader'><span>",s="<div class='e-chartcontent'>",w=t.toLowerCase(),b={visible:!1},h=this.XLObj,k=h._getLocStr(t).split("/"),o=0;o<i;o++)v="<div class='e-"+h._id+" e-chartcell e-"+w+(o+1)+"' title="+h._getLocStr(e[o])+"><\/div>",s+=v,o===r&&(s+="<\/div>"+p+k[1]+"<\/span><\/div><div class='e-chartcontent'>");for(s+="<\/div>",c=n("<div id="+h._id+"_Ribbon_"+t+" class='e-ss-dialog e-ss-chart e-ss-"+h._id+"' style='height:auto;'>"+p+k[0]+"<\/span><\/div>"+s+"<\/div>"),y=c.find(".e-chartcell"),o=0;o<i;o++)l=n(y[o]),a=f[o],l.data({type:a,enable3D:!1,marker:b}),o>u&&l.data({type:a,enable3D:!0,marker:b});s=n(c).find(".e-"+w+"2");(t==="StockChart"||t==="LineChart")&&s.data({marker:{visible:!0}});t==="PieChart"&&s.data({enable3D:!0});h.element[0].appendChild(c[0])},autoSum:function(i,r){var nt;if(this.XLObj.model.allowAutoSum){var f=this.XLObj,b=f.XLEdit,s=f.getActiveSheetIndex(),k=f.getActiveCell(s),tt=!1,a;if(!t.isNullOrUndefined(k)){var l,d,y=f.getActiveCell(s),p,g=f._getRangeArgs(r,"object"),o=f._getSelectedCells(s,g).selCells,c=o.length-1,it=o[c].rowIndex-o[0].rowIndex,rt=o[c].colIndex-o[0].colIndex,v={sheetIndex:s,range:r,reqType:"auto-sum",oprType:i,updCell:[]},u,e,w,ut=f.getRangeData({range:[o[0].rowIndex,o[0].colIndex,o[c].rowIndex,o[c].colIndex],valueOnly:!0}).length,h=f._dataContainer.sheets[s];if(c!==0&&ut)if(it===0&&rt>0){for(p=f._getAlphaRange(s,o[0].rowIndex,o[0].colIndex,o[c].rowIndex,o[c].colIndex),u=o[c].rowIndex,e=o[c].colIndex+1,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2");!t.isNullOrUndefined(a)&&a!="";)e++,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2");e===f.getSheet(s).colCount&&f.XLScroll._createNewColumn(s,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert");f._isUndoRedo||v.updCell.push({rowIndex:u,colIndex:e,pObj:{},pValue:t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,e,"value2"))?"":f.XLEdit.getPropertyValue(u,e,"value2")});t.isNullOrUndefined(h[u])&&(h[u]={});t.isNullOrUndefined(h[u][e])&&(h[u][e]={});f._isUndoRedo||n.extend(!0,v.updCell[0].pObj,h[u][e]);f._isRowViewable(s,u)&&(w=f.getCell(u,e,s),w.addClass("e-ralign"));b._updateCellValue({rowIndex:u,colIndex:e},"="+i+"("+p+")");"COUNT".indexOf(i)<0&&f._autosumFormatUpdate(f.getRangeData({range:[o[0].rowIndex,o[0].colIndex,o[0].rowIndex,o[0].colIndex]})[0],[u,e,u,e],!1,!1)}else{for(d=o[c].colIndex-o[0].colIndex,u=o[c].rowIndex+1,l=0;l<=d;l++)for(e=o[l].colIndex,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2"),nt=u;!t.isNullOrUndefined(a)&&a!="";)u++,nt=u,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2");for(l=0;l<=d;l++)e=o[l].colIndex,u=nt,p=f._getAlphaRange(s,o[0].rowIndex,e,o[c].rowIndex,e),o[c].rowIndex===f.getSheet(s).rowCount-1&&f.XLScroll._createNewRow(s,-1,-1,"insert"),f._isUndoRedo||v.updCell.push({rowIndex:u,colIndex:e,pObj:{},pValue:t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,e,"value2"))?"":f.XLEdit.getPropertyValue(u,e,"value2")}),t.isNullOrUndefined(h[u])&&(h[u]={}),t.isNullOrUndefined(h[u][e])&&(h[u][e]={}),f._isUndoRedo||n.extend(!0,v.updCell[l].pObj,h[u][e]),f._isRowViewable(s,u)&&(w=f.getCell(u,e,s),w.addClass("e-ralign")),b._updateCellValue({rowIndex:u,colIndex:e},"="+i+"("+p+")"),"COUNT".indexOf(i)<0&&f._autosumFormatUpdate(f.getRangeData({range:[o[0].rowIndex,o[l].colIndex,o[0].rowIndex,o[l].colIndex]})[0],[u,e,u,e],!1,!1)}else u=k.rowIndex,e=k.colIndex,v.updCell.push({rowIndex:u,colIndex:e,pObj:{},pValue:t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,e,"value2"))?"":f.XLEdit.getPropertyValue(u,e,"value2")}),t.isNullOrUndefined(h[u])&&(h[u]={}),t.isNullOrUndefined(h[u][e])&&(h[u][e]={}),n.extend(!0,v.updCell[0].pObj,h[u][e]),f._isRowViewable(s,y.rowIndex)||f.XLScroll._scrollSelectedPosition(s,y),b.editCell(y.rowIndex,y.colIndex,!0),f.model.allowFormulaBar&&f._getInputBox().val("="+i+"()"),f._isRowViewable(s,u)&&(f.XLEdit._editElem.text("="+i+"()"),f.XLEdit._editElem.focusEnd()),tt=!0;f.performSelection({rowIndex:g[0],colIndex:g[1]},{rowIndex:u,colIndex:e});f._isUndoRedo||tt||(f._completeAction(v),f._trigActionComplete(v))}}},_openNameManagerDlg:function(){var i=this.XLObj,t;i._showDialog(i._id+"_Ribbon_Others_NameManager");t=n("#"+i._id+"_nmgrid").data("ejGrid");t.getContentTable().find("td").addClass("e-ss-emptyrecord");t.model.dataSource.length<1?t.getContentTable().find("td").addClass("e-ss-emptyrecord"):t.getContentTable().find(".e-ss-emptyrecord").removeClass("e-ss-emptyrecord");this._refreshNMDlg();i._browserDetails.name=="msie"&&t.refreshContent();n("#"+i._id+"_nmgrid").focus()},_openFATDlg:function(){var t=this.XLObj;n("#"+t._id+"_fatnamedlg").ejDialog("open");n("#"+t._id+"_fatheader").ejCheckBox("option","checked",!1);n("#"+t._id+"_fatname").val("Table"+t._tableCnt).focus().setInputPos(n("#"+t._id+"_fatname").val().length)},_dirtySelect:function(){var e=this.XLObj,y=e.getActiveSheetIndex(),n,i=e.getSheet(y).filterSettings.tableRange,b=!1,r=!1,p=!1,h=!1,c=!1,l=!1,w=!1,o=!1,s=!1,u=!1,f=!1,k=-2,a=!1,v=!1,t,d;if(!e.model.allowLockCell||!e.getSheet(y).isSheetProtected){if(n=e.getSheet(y)._selectedCells,n.length>0)for(t=0,d=i.length;t<d;t++){if(f=o=h=c=a=!1,u=s=l=w=v=!1,i[t].startRow-1<=n[0].rowIndex&&i[t].endRow>=n[n.length-1].rowIndex?f=!0:i[t].startRow-1>n[0].rowIndex&&n[n.length-1].rowIndex>=i[t].startRow-1&&i[t].endRow>=n[n.length-1].rowIndex?o=!0:i[t].startRow-1<=n[0].rowIndex&&n[0].rowIndex<=i[t].endRow&&i[t].endRow<n[n.length-1].rowIndex?o=!0:i[t].startRow-1>n[n.length-1].rowIndex?h=!0:i[t].endRow<n[0].rowIndex?c=!0:i[t].endRow<n[n.length-1].rowIndex&&i[t].startRow>n[0].rowIndex?a=!0:f=!1,i[t].multifilterIdx[0]<=n[0].colIndex&&i[t].multifilterIdx[i[t].multifilterIdx.length-1]>=n[n.length-1].colIndex?u=!0:i[t].multifilterIdx[0]>n[0].colIndex&&n[n.length-1].colIndex>=i[t].multifilterIdx[0]&&i[t].multifilterIdx[i[t].multifilterIdx.length-1]>=n[n.length-1].colIndex?s=!0:i[t].multifilterIdx[0]<=n[0].colIndex&&n[0].colIndex<=i[t].multifilterIdx[i[t].multifilterIdx.length-1]&&i[t].multifilterIdx[i[t].multifilterIdx.length-1]<n[n.length-1].colIndex?s=!0:i[t].multifilterIdx[0]>n[n.length-1].colIndex?l=!0:i[t].multifilterIdx[i[t].multifilterIdx.length-1]<n[0].colIndex?w=!0:i[t].multifilterIdx[0]>n[0].colIndex&&i[t].multifilterIdx[i[t].multifilterIdx.length-1]<n[n.length-1].colIndex?v=!0:u=!1,(o&&s||o&&u||f&&s||o&&!w&&!l||s&&!h&&!c||a&&v||f&&v||u&&a)&&(r=!0,e.XLSelection._isRowSelected&&f&&(r=!1),e.XLSelection._isColSelected&&u&&(r=!1),r))break;r||(k=t,(h||c||l)&&(r=!1,b=!1),f&&u&&(p=!0),f||u||(b=!0))}this._isDirtySelect=r;this._isMergeSelect=p||r;this._isFilterSelect={status:p,tableIdx:k,isFiltered:!1}}},_refreshRibbonIcons:function(){var f,t=this.XLObj,s=t.getActiveSheetIndex(),i=n("#"+t._id+"_contextMenuCell").data("ejMenu"),h=["Home_Editing_SortFilter","Home_Editing_Clear","Home_Styles_FormatAsTable"],e=["Insert_Tables_Table","Data_SortFilter_Filter","Data_SortFilter_ClearFilter"],c=n("#"+t._id+"_Ribbon_Home_Alignment_Merge").data("ejSplitButton"),r,a,o,u,l;if(!t.XLEdit._isEdit&&t.getSheetElement(s).find(".e-ss-activeimg").length<1&&c&&c.option("enabled",!this._isMergeSelect),t._checkTableRange(t._getRangeArgs()).status!="full"&&e.push("Design_Tools_ConvertToRange"),this._isDirtySelect?(this._disableButtons(h,"ejSplitButton"),this._disableButtons(e,"ejButton"),i&&i.disableItemByID("Sort")):t.XLEdit._isEdit||(this._enableButtons(h,"ejSplitButton"),this._enableButtons(e,"ejButton"),!t.model.isReadOnly&&i&&t.model.allowSorting&&i.enableItemByID("Sort")),r=t.getSheet(s).filterSettings.tableRange[this._isFilterSelect.tableIdx],this._isFilterSelect.status&&r)for(a=!1,o=r.multifilterIdx,u=0,l=o.length;u<l;u++)if(f=t.XLEdit.getPropertyValue(r.startRow-1,o[u],"filterState"),f&&f.indexOf("filtered")>-1){this._isFilterSelect.isFiltered=!0;break}this._isFilterSelect.isFiltered?this._isDataTabCreate&&this._enableButtons(["Data_SortFilter_ClearFilter"],"ejButton"):this._isDataTabCreate&&this._disableButtons(["Data_SortFilter_ClearFilter"],"ejButton")},_onGroupExpander:function(n){var t=this.XLObj;if(!t.model.isReadOnly&&!t.XLEdit._isEdit)switch(n.target.id){case t._id+"_Ribbon_Number_e-groupexpander":t._showDialog(t._id+"_FormatCells")}},disableRibbonItems:function(t){var s=this.XLObj,r,h,u,c,i,e,o,f,l;if(!s.model.isReadOnly)for(u=0,c=t.length;u<c;u++){h=t[u].split("_")[2].toUpperCase();i=t[u].split("_Ribbon_")[1];do{switch(h){case"HOME":this._homeBtnIds.indexOf(i)>-1?(r="ejButton",this._homeBtnIds.splice(this._homeBtnIds.indexOf(i),1)):this._homeSptBtnIds.indexOf(i)>-1?(r="ejSplitButton",this._homeSptBtnIds.splice(this._homeSptBtnIds.indexOf(i),1)):this._homeToggleBtnIds.indexOf(i)>-1?(r="ejToggleButton",this._homeToggleBtnIds.splice(this._homeToggleBtnIds.indexOf(i),1)):this._homeDdIds.indexOf(i)>-1?(r="ejDropDownList",this._homeDdIds.splice(this._homeDdIds.indexOf(i),1)):this._homeCpIds.indexOf(i)>-1&&(r="ejColorPicker",this._homeCpIds.splice(this._homeCpIds.indexOf(i),1));break;case"INSERT":this._insertBtnIds.indexOf(i)>-1?(r="ejButton",this._insertBtnIds.splice(this._insertBtnIds.indexOf(i),1)):this._insertSptBtnIds.indexOf(i)>-1&&(r="ejSplitButton",this._insertSptBtnIds.splice(this._insertSptBtnIds.indexOf(i),1));break;case"DATA":this._dataBtnIds.indexOf(i)>-1?(r="ejButton",this._dataBtnIds.splice(this._dataBtnIds.indexOf(i),1)):this._dataSptBtnIds.indexOf(i)>-1&&(r="ejSplitButton",this._dataSptBtnIds.splice(this._dataSptBtnIds.indexOf(i),1));break;case"PAGELAYOUT":this._pageLayBtnIds.indexOf(i)>-1?(r="ejButton",this._pageLayBtnIds.splice(this._pageLayBtnIds.indexOf(i),1)):this._pageLaySptBtnIds.indexOf(i)>-1?(r="ejSplitButton",this._pageLaySptBtnIds.splice(this._pageLaySptBtnIds.indexOf(i),1)):this._pageLayChckBxIds.indexOf(i)>-1&&(r="ejCheckBox",this._pageLayChckBxIds.splice(this._pageLayChckBxIds.indexOf(i),1));break;case"REVIEW":this._cmntBtnIds.indexOf(i)>-1?(r="ejButton",this._cmntBtnIds.splice(this._cmntBtnIds.indexOf(i),1)):this._cmntTglBtnIds.indexOf(i)>-1?(r="ejToggleButton",this._cmntTglBtnIds.splice(this._cmntTglBtnIds.indexOf(i),1)):this._reviewTglBtnIds.indexOf(i)>-1&&(r="ejToggleButton",this._reviewTglBtnIds.splice(this._reviewTglBtnIds.indexOf(i),1));break;case"OTHERS":this._othersBtnIds.indexOf(i)>-1?(r="ejButton",this._othersBtnIds.splice(this._othersBtnIds.indexOf(i),1)):this._othersSptBtnIds.indexOf(i)>-1&&(r="ejSplitButton",this._othersSptBtnIds.splice(this._othersSptBtnIds.indexOf(i),1));break;case"FORMAT":this._formatBtnIds.indexOf(i)>-1?(r="ejButton",this._formatBtnIds.splice(this._formatBtnIds.indexOf(i),1)):this._formatSptBtnIds.indexOf(i)>-1&&(r="ejSplitButton",this._formatSptBtnIds.splice(this._formatSptBtnIds.indexOf(i),1));break;case"DESIGN":this._contextualBtnIds.indexOf(i)>-1?(r="ejButton",this._contextualBtnIds.splice(this._contextualBtnIds.indexOf(i),1)):this._contextualCheckBoxIds.indexOf(i)>-1?(r="ejCheckBox",this._contextualCheckBoxIds.splice(this._contextualCheckBoxIds.indexOf(i),1)):this._contextualInputIds.indexOf(i)>-1&&(r=!0);break;case"CHARTDESIGN":this._chartDesignBtnIds.indexOf(i)>-1?(r="ejButton",this._chartDesignBtnIds.splice(this._chartDesignBtnIds.indexOf(i),1)):this._chartDesignSptBtnIds.indexOf(i)>-1?(r="ejSplitButton",this._chartDesignSptBtnIds.splice(this._chartDesignSptBtnIds.indexOf(i),1)):this._chartDesignDdIds.indexOf(i)>-1&&(r="ejDropDownList",this._chartDesignDdIds.splice(this._chartDesignDdIds.indexOf(i),1))}if(r)this._disableButtons([i],r);else for(e=["ejSplitButton","ejButton","ejDropDownList","ejCheckBox","ejToggleButton","ejColorPicker"],o=n("#"+s._id+"_Ribbon_"+i),f=0,l=e.length;f<l;f++)if(o.data(e[f])){o.data(e[f]).disable();break}}while((i==="PageLayout_PageLayout_PageSize"||i==="Home_Clipboard_Paste"||i==="Others_Cells_InsertCell"||i==="Others_Cells_DeleteCell"||i==="Data_DataTools_DataValidation")&&(i=i+"Options"))}},enableRibbonItems:function(t){for(var l=this.XLObj,r,s,i,e,o,f,c,u=0,h=t.length;u<h;u++){s=t[u].split("_")[2].toUpperCase();i=t[u].split("_Ribbon_")[1];do{switch(s){case"HOME":this.allButtonIds.indexOf(i)>-1?(r="ejButton",this._homeBtnIds.push(i)):this.allSplitButtonIds.indexOf(i)>-1?(r="ejSplitButton",this._homeSptBtnIds.push(i)):this.allToggleButtonIds.indexOf(i)>-1?(r="ejToggleButton",this._homeToggleBtnIds.push(i)):this.allDropDownIds.indexOf(i)>-1?(r="ejDropDownList",this._homeDdIds.push(i)):this.colorPickerIds.indexOf(i)>-1&&(r="ejColorPicker",this._homeCpIds.push(i));break;case"INSERT":this.allButtonIds.indexOf(i)>-1?(r="ejButton",this._insertBtnIds.push(i)):this.allSplitButtonIds.indexOf(i)>-1&&(r="ejSplitButton",this._insertSptBtnIds.push(i));break;case"DATA":this.allButtonIds.indexOf(i)>-1?(r="ejButton",this._dataBtnIds.push(i)):this.allSplitButtonIds.indexOf(i)>-1&&(r="ejSplitButton",this._dataSptBtnIds.push(i));break;case"PAGELAYOUT":this.allButtonIds.indexOf(i)>-1?(r="ejButton",this._pageLayBtnIds.push(i)):this.allSplitButtonIds.indexOf(i)>-1?(r="ejSplitButton",this._pageLaySptBtnIds.push(i)):this.checkBoxIds.indexOf(i)>-1&&(r="ejCheckBox",this._pageLayChckBxIds.push(i));break;case"REVIEW":this.allButtonIds.indexOf(i)>-1?(r="ejButton",this._cmntBtnIds.push(i)):this.allToggleButtonIds.indexOf(i)>-1&&t[u].split("_")[4]==="ShowAllComment"?(r="ejToggleButton",this._cmntTglBtnIds.push(i)):this.allToggleButtonIds.indexOf(i)>-1&&(r="ejToggleButton",this._reviewTglBtnIds.push(i));break;case"OTHERS":this.allButtonIds.indexOf(i)>-1?(r="ejButton",this._othersBtnIds.push(i)):this.allSplitButtonIds.indexOf(i)>-1&&(r="ejSplitButton",this._othersSptBtnIds.push(i));break;case"FORMAT":this.allButtonIds.indexOf(i)>-1?(r="ejButton",this._formatBtnIds.push(i)):this.allSplitButtonIds.indexOf(i)>-1&&(r="ejSplitButton",this._formatSptBtnIds.push(i));break;case"DESIGN":this.allButtonIds.indexOf(i)>-1?(r="ejButton",this._contextualBtnIds.push(i)):this.checkBoxIds.indexOf(i)>-1?(r="ejCheckBox",this._contextualCheckBoxIds.push(i)):this._contextualInputIds.indexOf(i)>-1&&(r=!0);break;case"CHARTDESIGN":this.allButtonIds.indexOf(i)>-1?(r="ejButton",this._chartDesignBtnIds.push(i)):this.allSplitButtonIds.indexOf(i)>-1?(r="ejSplitButton",this._chartDesignSptBtnIds.push(i)):this.allDropDownIds.indexOf(i)>-1&&(r="ejDropDownList",this._chartDesignDdIds.push(i))}if(r)this._enableButtons([i],r);else for(e=["ejSplitButton","ejButton","ejDropDownList","ejCheckBox","ejToggleButton","ejColorPicker"],o=n("#"+l._id+"_Ribbon_"+i),f=0,c=e.length;f<c;f++)if(o.data(e[f])){o.data(e[f]).enable();break}}while((i==="PageLayout_PageLayout_PageSize"||i==="Home_Clipboard_Paste"||i==="Others_Cells_InsertCell"||i==="Others_Cells_DeleteCell"||i==="Data_DataTools_DataValidation")&&(i=i+"Options"))}},_refreshFRDlg:function(){var t=this.XLObj;t._dlgWidth<365?(n("#"+t._id+"_Ribbon_lbFind").text(t._getLocStr("Find")),n("#"+t._id+"_Ribbon_lbReplace").text(t._getLocStr("Replace"))):(n("#"+t._id+"_Ribbon_lbFind").text(t._getLocStr("FindLabel")),n("#"+t._id+"_Ribbon_lbReplace").text(t._getLocStr("ReplaceLabel")))},_refreshChartTypeDlg:function(){var t=this.XLObj;n("#"+t._id+"_charttypedlg").ejDialog("open");n("#"+t._id+"_chartdlg_allcharttab_list").ejListBox("refresh")},_refreshNMDlg:function(){var t=this.XLObj,i;n("#"+t._id+"_nmdlg").ejDialog("open");i=n("#"+t._id+"_nmgrid").data("ejGrid");i._refreshScroller({requestType:"refresh"})},_menuCustomize:function(){var r=this.XLObj,f=r._id,u=r.model.ribbonSettings.applicationTab,i=u.menuSettings;u.type==="menu"?(i.isAppend?this._fileMenuData=this._fileMenuData.concat(i.dataSource):i.dataSource.length&&(this._fileMenuData=[{id:"File",text:r._getLocStr("File"),parentId:null},].concat(i.dataSource)),this._appTabCollection={type:t.Ribbon.ApplicationTabType.Menu,menuItemID:f+"_Menu",menuSettings:{click:n.proxy(this._onBackStageItemClick,this),openOnClick:!1,fields:{dataSource:this._fileMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"}}}):i.isAppend?(this._renderAppTab(),this._appTabCollection.backstageSettings.pages=this._appTabCollection.backstageSettings.pages.concat(i.dataSource)):i.dataSource.length?this._appTabCollection={type:t.Ribbon.applicationTabType.backstage,backstageSettings:{text:r._getLocStr("File"),headerWidth:124,height:r._responsiveHeight,width:r.model.scrollSettings.width,pages:i.dataSource}}:this._renderAppTab()},_refreshBackstageHeight:function(){var n=this.XLObj,i=n.element.find("#"+n._id+"_Ribbon").data("ejRibbon"),r=n._isAutoWHMode?n._responsiveHeight:n._responsiveHeight-2;i.model.applicationTab.type===t.Ribbon.ApplicationTabType.Backstage&&(i.setModel({applicationTab:{backstageSettings:{height:r,width:n._isAutoWHMode?n._responsiveWidth:n._responsiveWidth-2}}}),i.element.find(".e-responsivebackstagecontent .e-resbackstagecontent").css({height:r-(10+i.element.find(".e-backstagerestop").outerHeight())}))},_refreshBSItems:function(i){var r=this.XLObj;i===t.Ribbon.ApplicationTabType.Menu&&(n("#"+r._id+"_backstagetabnew").remove(),n("#"+r._id+"_backstagetabsaveas").remove(),n("#"+r._id+"_backstagetabprint").remove())},hideMenu:function(){var t=this.XLObj;t.model.isReadOnly||(t.model.ribbonSettings.applicationTab.type==="menu"?n("#"+t._id+"_Menu").hide():t.element.find("#"+t._id+"_Ribbon").find(".e-backstagetab").hide())},showMenu:function(){var t=this.XLObj;t.model.isReadOnly||(t.model.ribbonSettings.applicationTab.type==="menu"?n("#"+t._id+"_Menu").show():t.element.find("#"+t._id+"_Ribbon").find(".e-backstagetab").show())},addTab:function(n,t,i){var r=this.XLObj;r.model.isReadOnly||r.element.find("#"+r._id+"_Ribbon").ejRibbon("addTab",n,t,i)},addTabGroup:function(n,t,i){var r=this.XLObj;r.model.isReadOnly||r.element.find("#"+r._id+"_Ribbon").ejRibbon("addTabGroup",n,t,i)},addContextualTabs:function(n,t){var i=this.XLObj;i.model.isReadOnly||i.element.find("#"+this.XLObj._id+"_Ribbon").ejRibbon("addContextualTabs",n,t)},removeTab:function(n,i){var r=this.XLObj,u;r.model.isReadOnly||(t.isNullOrUndefined(n)&&i?(u=r.element.find("#"+r._id+"_Ribbon .e-apptab"),u.length&&(u.find("a").empty(),u.find(".e-menu-wrap").remove(),u.hide(),r.element.find("#"+r._id+"_Ribbon_BackStage").remove())):r.element.find("#"+r._id+"_Ribbon").ejRibbon("removeTab",n))},removeTabGroup:function(n,t){var i=this.XLObj;i.model.isReadOnly||i.element.find("#"+i._id+"_Ribbon").ejRibbon("removeTabGroup",n,t)},addBackStageItem:function(n,t){var i=this.XLObj;i.model.isReadOnly||i.element.find("#"+i._id+"_Ribbon").ejRibbon("addBackStageItem",n,t)},removeBackStageItem:function(n){var t=this.XLObj;t.model.isReadOnly||t.element.find("#"+t._id+"_Ribbon").ejRibbon("removeBackStageItem",n)},updateBackStageItem:function(n,t){var i=this.XLObj;i.model.isReadOnly||i.element.find("#"+i._id+"_Ribbon").ejRibbon("updateBackStageItem",t,n)},removeMenuItem:function(t){var r=this.XLObj,i,u;r.model.isReadOnly||(i=n("#"+r._id+"_Menu"),u=i.data("ejMenu"),u.remove(["#"+i.find("li").eq(t).attr("id")]))},updateMenuItem:function(t,i){var f=this.XLObj,r,u;f.model.isReadOnly||(r=n("#"+f._id+"_Menu"),u=r.data("ejMenu"),u.insertBefore(t,"#"+r.find("li").eq(i).attr("id")),u.remove(["#"+r.find("li").eq(i+1).attr("id")]))},addMenuItem:function(t,i){var u=this.XLObj,r,f;u.model.isReadOnly||(r=n("#"+u._id+"_Menu"),f=r.data("ejMenu"),f.insertAfter(t,"#"+r.find("li").eq(i).attr("id")))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.freezepane=function(n){this.XLObj=n;this._hfreeze=null;this._vfreeze=null};t.spreadsheetFeatures.freezepane.prototype={_setHFreeze:function(n){this._hfreeze=n},_getHFreeze:function(){return this._hfreeze},_setVFreeze:function(n){this._vfreeze=n},_getVFreeze:function(){return this._vfreeze},_initFreeze:function(){var t,i,u="div",f="e-hide",r=this.XLObj,o=r.getSheet(),e=r.getMainPanel().find(".e-spreadsheet-list")[0];t=document.createElement(u);t.id=r._id+"_hfreeze";t.className="e-frow "+f;e.appendChild(t);this._setHFreeze(n(t));i=document.createElement(u);i.id=r._id+"_vfreeze";i.className="e-fcol "+f;e.appendChild(i);this._setVFreeze(n(i))},_refreshFreeze:function(){var u="px",r="e-hide",n=this.XLObj,i=n.getSheet(),t=this._getHFreeze()[0];t||this._initFreeze();n._isFrozen(n.getFrozenRows())?(n._removeClass(t,r),t.style.top=i._fDivTop,t.style.width=n.model._isActPanelVisible?n._getJSSheetContent(n.getActiveSheetIndex()).width()-(i.showHeadings?n._rowHeaderWidth:0)+10+u:i._vPortWth+(i.showHeadings?n._rowHeaderWidth:0)-4+u):n.addClass(t,r);t=this._getVFreeze()[0];n._isFrozen(n.getFrozenColumns())?(n._removeClass(t,r),t.style.left=i._fDivLeft,t.style.height=i._vPortHgt+(i.showHeadings?n._colHeaderHeight:0)-4+u):n.addClass(t,r)},freezeTopRow:function(){var n=this.XLObj.getSheet();(this.XLObj._isFrozen(n.frozenRows)||this.XLObj._isFrozen(n.frozenColumns))&&this.unfreezePanes();this._freeze(n._topRow.idx+1)},freezeLeftColumn:function(){var n=this.XLObj.getSheet();this.XLObj._isFrozen(n.frozenColumns)&&this.unfreezePanes();this._freeze(null,n._leftCol.idx+1)},freezeRows:function(n){var t=this.XLObj.getSheet();(this.XLObj._isFrozen(t.frozenRows)||this.XLObj._isFrozen(t.frozenColumns))&&this.unfreezePanes();this._freeze(n)},freezeColumns:function(n){var t=this.XLObj.getSheet();this.XLObj._isFrozen(t.frozenColumns)&&this.unfreezePanes();this._freeze(null,n)},freezePanes:function(n,t){var i,r=this.XLObj;r.isNumber(n)||(i=r._toIntrnlRange(n),n=i[0],t=i[1]);this._freeze(n,t)},unfreezePanes:function(){this._freeze();this._refreshSelection()},_freeze:function(n,i){var c,f,l,r,e,o,s,h,u=this.XLObj,a,v;if(s=h=!0,u.model.allowFreezing){if(c="px",l="e-hide",r=u.getSheet(),o=this._getHFreeze()[0],t.isNullOrUndefined(n))if(f=u.getFrozenRows(),u._isFrozen(f)){for(n=0,a=r._ftopRowIdx-1,this._showFreezeRow(f,a),u.model.scrollSettings.allowVirtualScrolling&&u.refreshContent();a>=f;)r._fHMergeRows.indexOf(f)>-1&&(r._fHMergeRows.splice(r._fHMergeRows.indexOf(f),1),u._refreshSHMergeCells(null,[f],1,"row","show")),f++;u.addClass(o,l);r._isFreezed=!1}else s=!1;else(n===0||n<r._topRow.idx||n>r._bottomRow.idx)&&(n=u._getMidCell().rowIdx),e=u._getIdxWithOffset(n).yOffset,r._topRow.idx===n&&r._scrollTop!==e&&u.XLScroll._vScroller().scroll(e),u._removeClass(o,l),r._isFreezed=!0,o.style.top=r._fDivTop=e-r._scrollTop+(r.showHeadings?u._colHeaderHeight-2:0)+c,o.style.width=r._vPortWth+(r.showHeadings?u._rowHeaderWidth:0)-4+c,r._contScrollTop=r._scrollTop;if(s&&(r._ftopRowIdx=n,r._frozenHeight=u._getRowOffsetTop(r,n),r.paneTopLeftCell=u.getAlphaRange(n,r._fleftColIdx),u.setFrozenRows(n),r._frozenRows=n+1),o=this._getVFreeze()[0],t.isNullOrUndefined(i))if(f=u.getFrozenColumns(),u._isFrozen(f)){for(i=0,v=r._fleftColIdx-1,this._showFreezeCol(f,v);v>=f;)r._fHMergeCols.indexOf(f.toString())>-1&&(r._fHMergeCols.splice(r._fHMergeCols.indexOf(f.toString()),1),u._refreshSHMergeCells(null,[f],1,"column","show")),f++;u.addClass(o,l);r._isFreezed=!1}else h=!1;else(i===0||i<r._leftCol.idx||i>r._rightCol.idx)&&(i=u._getMidCell().colIdx),e=u._getIdxWithOffset(null,i).xOffset,r._leftCol.idx===i&&r._scrollLeft!==e&&u.XLScroll._hScroller().scroll(e),e=e+(r.showHeadings?u._rowHeaderWidth:0)-1,u._removeClass(o,l),r._isFreezed=!0,o.style.left=r._fDivLeft=e-r._scrollLeft+c,o.style.height=r._vPortHgt+(r.showHeadings?u._colHeaderHeight:0)-4+c,r._contScrollLeft=r._scrollLeft;h&&(r._fleftColIdx=i,r._frozenWidth=u._getColOffsetLeft(r,i),r.paneTopLeftCell=u.getAlphaRange(r._ftopRowIdx,i),u.setFrozenColumns(i),r._frozenColumns=i+1);(s||h)&&(u.XLScroll._refreshScroller(null,null,s&&h?"all":s?"vertical":"horizontal"),s&&u.model.scrollSettings.allowScrolling&&u.XLScroll._vScroller().scroll(u._isFrozen(u.getFrozenRows())?0:r._contScrollTop),h&&u.model.scrollSettings.allowScrolling&&u.XLScroll._hScroller().scroll(u._isFrozen(u.getFrozenColumns())?0:r._contScrollLeft))}},_frozenScrollHandler:function(n){var o,f,s=0,r=this.XLObj,u=r.XLScroll,i=r.getSheet(),e=r.getActiveSheetIndex(),h=u._vScroller(e),c=u._hScroller(e);if(n.model.orientation===t.ScrollBar.Orientation.Vertical){if(n.reachedEnd=Math.ceil(parseFloat(h.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(h.element.find(".e-vhandle").height()))>=h.element.find(".e-vhandlespace").height()-2,n.scrollData.up||n.reachedEnd&&r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite){if(o=(n.scrollTop-i._scrollTop)/i.rowHeight,i._bottomRow.idx+o>=i.rowCount-1)if(r.model.scrollSettings.allowVirtualScrolling)while(o>=i.rowCount)for(s=0,i._virtualBlockCnt++,i.rowCount+=i._virtualBlockRowCnt;s<i._virtualBlockRowCnt;)i.rowsHeightCollection.push(i.rowHeight),s++;else r.XLScroll._scrollBottom(e);r.XLScroll._refreshScroller(e,"refresh","vertical")}u._isIntrnlScroll?(this._scrollFreeze(u._scrollIdx),u._scrollIdx=0,i._scrollTop=n.scrollTop):n.scrollTop==i._scrollTop||n.reachedEnd&&r.model.scrollSettings.scrollMode!==t.Spreadsheet.scrollMode.Infinite||(f=this._ensureFreezeScrollPos(n),r.isUndefined(f.resetTo)?(this._scrollFreeze(f.rowIdx),i._scrollTop=n.scrollTop):(u._isIntrnlScroll=!0,u._scrollIdx=f.rowIdx,u._vScroller().scroll(f.resetTo),u._isIntrnlScroll=!1))}else n.reachedEnd=Math.ceil(parseFloat(c.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(c.element.find(".e-hhandle").width()))>=r.element.find(".e-hhandlespace").width()-2,o=(n.scrollLeft-i._scrollLeft)/i.columnWidth,(n.reachedEnd||r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&i._rightCol.idx+o>=i.colCount-1)&&(r.XLScroll._scrollRight(e),r.XLScroll._refreshScroller(e,"refresh","horizontal")),u._isIntrnlScroll?(this._scrollFreeze(null,u._scrollIdx),u._scrollIdx=0,i._scrollLeft=n.scrollLeft):n.scrollLeft==i._scrollLeft||n.reachedEnd&&r.model.scrollSettings.scrollMode!==t.Spreadsheet.scrollMode.Infinite||(f=this._ensureFreezeScrollPos(n),r.isUndefined(f.resetTo)?(this._scrollFreeze(null,f.colIdx),i._scrollLeft=n.scrollLeft):(u._isIntrnlScroll=!0,u._scrollIdx=f.colIdx,u._hScroller().scroll(f.resetTo),u._isIntrnlScroll=!1));r.model.allowComments&&r.XLComment._updateCmntArrowPos()},_ensureFreezeScrollPos:function(n){var r,i,u={},o=[t.Spreadsheet.HideTypes.Freeze],e=this.XLObj,f=e.getSheet();return n.model.orientation===t.ScrollBar.Orientation.Vertical?(r=n.scrollTop+f._frozenHeight,i=e._getIdxWithOffset(r,null,!0,o),u.rowIdx=i.rowIdx,r!==i.yOffset&&(u.resetTo=i.yOffset-f._frozenHeight)):(r=n.scrollLeft+f._frozenWidth,i=e._getIdxWithOffset(null,r,!0,o),u.colIdx=i.colIdx,r!==i.xOffset&&(u.resetTo=i.xOffset-f._frozenWidth)),u},_scrollFreeze:function(n,t){var r,u=this.XLObj,i=u.getSheet(),f=u.getActiveSheetIndex();if(n&&i._ftopRowIdx!==n){for(i._ftopRowIdx<n?(r=n-i._ftopRowIdx==1?i._ftopRowIdx:n-1,this._hideFreezeRow(i._ftopRowIdx,r),this._refreshShape(i._ftopRowIdx,r,!0)):(r=i._ftopRowIdx-n==1?n:i._ftopRowIdx-1,this._showFreezeRow(n,r),this._refreshShape(n,r,!0)),u.model.scrollSettings.allowVirtualScrolling&&u.refreshContent();r>=n;)i._fHMergeRows.indexOf(r)>-1&&(i._fHMergeRows.splice(i._fHMergeRows.length-1,1),u._refreshSHMergeCells(null,[r],1,"row","show")),r--;i._ftopRowIdx=n;i.paneTopLeftCell=u.getAlphaRange(n,i._fleftColIdx)}else if(t&&i._fleftColIdx!==t){for(i._fleftColIdx<t?(r=t-i._fleftColIdx==1?i._fleftColIdx:t-1,this._hideFreezeCol(i._fleftColIdx,r),this._refreshShape(i._fleftColIdx,r)):(r=i._fleftColIdx-t==1?t:i._fleftColIdx-1,this._showFreezeCol(t,r),this._refreshShape(t,r));r>=t;)i._fHMergeCols.indexOf(r.toString())>-1&&(i._fHMergeCols.splice(i._fHMergeCols.length-1,1),u._refreshSHMergeCells(null,[r],1,"column","show")),r--;i._fleftColIdx=t;i.paneTopLeftCell=u.getAlphaRange(i._ftopRowIdx,t)}u.model.scrollSettings.allowScrolling&&(u.XLScroll._getRowHeights(f,1),u.XLScroll._refreshScroller(f,"refresh","vertical"),u.XLScroll._getFirstRow(f));this._refreshSelection()},_refreshShape:function(t,i,r){var u,f,h,o,c,l,v,s=this.XLObj,p=s.getActiveSheetIndex(),e=s.getSheet(p),a=e.shapeMngr,y=e.pivotMngr;for(v=r?[t,0,i,e.colCount]:[0,t,e.rowCount,i],f=s.getRangeData({range:v,property:["picture","chart"]}),u=0;u<f.length;u++)f[u].picture&&(c=f[u].picture[s.getObjectLength(f[u].picture)],o=r?a.picture[c].rowIndex:a.picture[c].colIndex,this._freezeShape(n("#"+c)[0],r?e._hiddenFreezeRows.indexOf(o)>-1:e._hiddenFreezeCols.indexOf(o)>-1)),f[u].chart&&(h=f[u].chart[s.getObjectLength(f[u].chart)],o=r?a.chart[h].rowIndex:a.chart[h].colIndex,this._freezeShape(n("#"+h)[0],r?e._hiddenFreezeRows.indexOf(o)>-1:e._hiddenFreezeCols.indexOf(o)>-1)),f[u].pivot&&(l=f[u].pivot[s.getObjectLength(f[u].pivot)],o=r?y.pivot[l].rowIndex:y.pivot[l].colIndex,this._freezeShape(n("#"+l)[0],r?e._hiddenFreezeRows.indexOf(o)>-1:e._hiddenFreezeCols.indexOf(o)>-1));this._updateShapePos(r)},_updateShapePos:function(n){var i,r,h,c,l=0,a=0,v,u,t,f,e,o=this.XLObj,s=o.getSheet(),y=s.shapeMngr,p=s._hiddenFreezeRows,w=s._hiddenFreezeCols;n?l=this._getFreezeHidenDim(!0):a=this._getFreezeHidenDim();for(e in y)if(["chart","picture"].indexOf(e)>-1){f=y[e];for(v in f)t=f[v],u=t.id,i=t.top,r=t.left,h=p[p.length-1]||0,c=w[w.length-1]||0,n?h<=t.rowIndex&&(i-=l,o.getSheetElement().find("#"+u).css({top:i})):c<=t.colIndex&&(r-=a,o.getSheetElement().find("#"+u).css({left:r}))}},_getFreezeHidenDim:function(n){var e=this.XLObj,t=e.getSheet(),i,u,f=0,r=0;for(n?(i=t._hiddenFreezeRows,u=t.rowsHeightCollection):(i=t._hiddenFreezeCols,u=t.columnsWidthCollection),r=0;r<i.length;r++)f+=u[i[r]];return f},_freezeShape:function(n,t){var i=this.XLObj;t?i.addClass(n,"e-hide"):i._removeClass(n,"e-hide")},_hideFreezeRow:function(n,t){for(var r,i=this.XLObj,e=i.model.scrollSettings,s=e.allowScrolling&&e.allowVirtualScrolling,u=i.getActiveSheetIndex(),o=i.getRows(u),h=o[0],c=o[1],f=i.getSheet(u),l=f.usedRange;n<=t;){for(r=0,f._hiddenFreezeRows.indexOf(n)===-1&&f._hiddenFreezeRows.push(n),!s&&i._isRowViewable(u,n)&&(i.addClass(c[n],"e-r-hide"),i.addClass(h[n],"e-r-hide"));r<l.colIndex;){if(i.XLCellNav._isMergedCell({rowIndex:n,colIndex:r})){f._fHMergeRows.push(n);i._refreshSHMergeCells(u,[n],1,"row","hide");break}r++}n++}},_showFreezeRow:function(n,t){for(var r,u,i=this.XLObj,f=i.model.scrollSettings,h=f.allowScrolling&&f.allowVirtualScrolling,e=i.getActiveSheetIndex(),o=i.getRows(e),c=o[0],l=o[1],s=i.getSheet();n<=t;)r=s._hiddenFreezeRows.indexOf(n),i.model.allowFiltering&&(u=this._refreshFiltering(n)),r>-1&&(s._hiddenFreezeRows.splice(r,1),h||!i._isRowViewable(e,n)||u||(i._removeClass(l[n],"e-r-hide"),i._removeClass(c[n],"e-r-hide"))),n++},_refreshFiltering:function(n){var i=this.XLObj,u=i.getActiveSheetIndex(),r=i.getSheet();return t.isNullOrUndefined(i.XLEdit.getPropertyValue(n,0,"isFilterHide",u))?!1:(r._filterHRowsColl.indexOf(n)===-1&&r._filterHRowsColl.push(n),!0)},_hideFreezeCol:function(n,t){for(var s,e,o="e-fcol-hide",i=n,r=this.XLObj,h=r.getActiveSheetIndex(),u=r.getSheet(),y=u.usedRange,c=r.model.scrollSettings.allowVirtualScrolling?u._virtualRowIdx:u._rowIdxColl,l=r._getJSSheetHeader(h),a=r._getContent(h),p=l.find("th"),w=l.find("col"),b=a.find("col"),v=l.find("table"),f=r._getWidth(n,t);i<=t;){for(e=0,u._hiddenFreezeCols.indexOf(i)===-1&&u._hiddenFreezeCols.push(i),r.addClass(p[i],o),r.addClass(w[i],o),r.addClass(b[i],o);e<y.rowIndex;){if(r.XLCellNav._isMergedCell({rowIndex:e,colIndex:i})){u._fHMergeCols.push(i.toString());r._refreshSHMergeCells(h,[i],1,"column","hide");break}e++}i++}if(s=r.getRange([c[0],n,c[c.length-1],t]),i=s.length,i)while(i--)r.addClass(s[i],o);f=v.width()-f;v.width(f);a.find(".e-table").width(f)},_getWidth:function(n,t){for(var i=0,r=this.XLObj.getSheet();n<=t;n++)i+=r.columnsWidthCollection[n];return i},_showFreezeCol:function(n,t){for(var e,s,f="e-fcol-hide",r=n,i=this.XLObj,l=i.getActiveSheetIndex(),u=i.getSheet(),h=i._getJSSheetHeader(l),a=i._getContent(l),v=h.find("th"),c=i.model.scrollSettings.allowVirtualScrolling?u._virtualRowIdx:u._rowIdxColl,y=h.find("col"),p=a.find("col"),w=h.find("table"),o=i._getWidth(0,u.colCount-1)-(u._frozenColumns-1<n?i._getWidth(u._frozenColumns-1,n):0);r<=t;)e=u._hiddenFreezeCols.indexOf(r),e>-1&&(u._hiddenFreezeCols.splice(e,1),i._removeClass(v[r],f),i._removeClass(y[r],f),i._removeClass(p[r],f)),r++;if(s=i.getRange([c[0],n,c[c.length-1],t]),r=s.length,r)while(r--)i._removeClass(s[r],f);w.width(o);a.find(".e-table").width(o)},_refreshSelection:function(){var r,f,u,e,o=!1,i=this.XLObj,n=i.getSheet(),t=n.selectedRange,s=t[2],h=t[3],c=t[0],l=t[1];if(n._endCell.rowIndex+1>=n._frozenRows&&n._endCell.rowIndex<n._ftopRowIdx&&n._startCell.rowIndex<n._frozenRows-1)s=n._frozenRows-2,o=!0;else if(r=t[0],f=t[2],n._frozenRows-1<=r)while(r<=f)if(r<n._ftopRowIdx)r++;else{c=r;break}if(t[3]+1>=n._frozenColumns&&t[3]<n._fleftColIdx&&t[1]<n._frozenColumns-1)h=n._frozenColumns-2,o=!0;else if(u=t[1],e=t[3],n._frozenColumns-1<=u)while(u<=e)if(u<n._fleftColIdx)u++;else{l=u;break}r==f+1||u==e+1?i.XLSelection._hideShowSelElem("hide"):(i.model.allowSelection&&i.XLSelection._refreshBorder([c,l,s,h]),o?i.addClass(i.getAutoFillElem()[0],"e-hide"):i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement())},_selectionScroll:function(){var i,r,u,f,e=f=0,t=this.XLObj,n=t.getSheet(),o=t.getActiveSheetIndex();if(t._isFrozen(n.frozenRows))if(n._startCell.rowIndex+1<n._frozenRows&&n._endCell.rowIndex+1>n._frozenRows&&n.selectedRange[2]<n._ftopRowIdx){if(n._ftopRowIdx+1-n._frozenRows>0){for(r=n._endCell.rowIndex-n._ftopRowIdx,n._endCell.rowIndex=n._frozenRows-1+r,i=n._frozenRows-1;i<n._ftopRowIdx;i++)e+=n.rowsHeightCollection[i];t._scrollContent({y:-e})}}else n.selectedRange[2]-n._endCell.rowIndex>0&&n._ftopRowIdx>n._frozenRows-1&&!n._isColSelected&&n._endCell.rowIndex<n._frozenRows-1&&n.selectedRange[2]-n.selectedRange[0]>0&&n.selectedRange[2]>=n._ftopRowIdx-1&&(n._endCell.rowIndex=n._ftopRowIdx-1,u=t.getCell(n._frozenRows-2,n._endCell.colIndex)[0],t.XLSelection._scrollCalculation(o,u,{position:"vertical",action:"Decrement"}));if(t._isFrozen(n.frozenColumns))if(n._startCell.colIndex+1<n._frozenColumns&&n._endCell.colIndex+1>n._frozenColumns&&n.selectedRange[3]<n._fleftColIdx){if(n._fleftColIdx+1-n._frozenColumns>0){for(r=n._endCell.colIndex-n._fleftColIdx,n._endCell.colIndex=n._frozenColumns-1+r,i=n._frozenColumns-1;i<n._fleftColIdx;i++)f+=n.columnsWidthCollection[i];t._scrollContent({x:-f})}}else n.selectedRange[3]-n._endCell.colIndex>0&&n._fleftColIdx>n._frozenColumns-1&&!n._isRowSelected&&n._endCell.colIndex<n._frozenColumns-1&&n.selectedRange[3]-n.selectedRange[1]>0&&n.selectedRange[3]>=n._fleftColIdx-1&&(n._endCell.colIndex=n._fleftColIdx-1,u=t.getCell(n._frozenColumns-2,n._endCell.colIndex)[0],t.XLSelection._scrollCalculation(o,u,{position:"horizontal",action:"Decrement"}))},_refreshFColResize:function(n){var u,f="px",i=this.XLObj,s=i.getActiveSheetIndex(),t=i.getSheet(),e=i.getFrozenColumns()+1,h=this._getVFreeze()[0],r=t._frozenWidth,o=parseInt(this._getVFreeze()[0].style.left);i.XLScroll._getColWidths(s,n);t._frozenWidth=i._getColOffsetLeft(t,e-1);u=r>t._frozenWidth?r-t._frozenWidth:t._frozenWidth-r;n<e-1&&(h.style.left=t._fDivLeft=r>=t._frozenWidth?o-u+f:o+u+f)},_refreshFRowResize:function(n){var u,f="px",i=this.XLObj,s=i.getActiveSheetIndex(),t=i.getSheet(),e=i.getFrozenRows()+1,h=this._getHFreeze()[0],r=t._frozenHeight,o=parseInt(this._getHFreeze()[0].style.top);i.XLScroll._getRowHeights(s,n);t._frozenHeight=i._getRowOffsetTop(t,e-1);u=r>t._frozenHeight?r-t._frozenHeight:t._frozenHeight-r;n<e-1&&(h.style.top=t._fDivTop=r>=t._frozenHeight?o-u+f:o+u+f)},_refreshFreezeRowDiv:function(){var t=this.XLObj,n=t.getSheet();n._fDivTop=t._getIdxWithOffset(n._frozenRows-1).yOffset-n._contScrollTop+(n.showHeadings?t._colHeaderHeight-2:0)+"px";n._frozenHeight=t._getRowOffsetTop(n,n._frozenRows-1);this._refreshFreeze()},_refreshFreezeColDiv:function(){var t=this.XLObj,n=t.getSheet();n._fDivLeft=t._getColOffsetLeft(n,n._frozenColumns-1)-n._contScrollLeft+(n.showHeadings?t._rowHeaderWidth:0)-1+"px";n._frozenWidth=t._getColOffsetLeft(n,n._frozenColumns-1);this._refreshFreeze()}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.math={toFraction:function(n){if(this.isNumber(n)){var r=n.toString(),e=r.split(".")[0],t=r.split(".")[1];if(!t)return{integer:n};var i=(+t).toString(),u=this.getPlaceValue(t,i),f=this.getGcd(i,u);return{integer:e,numerator:Number(i)/f,denominator:Number(u)/f}}return null},toExponential:function(n,t){if(this.isNumber(n)){var i,r=Number(n);return t=t||2,t>20&&(t=20),i=r.toExponential(t).split("e+"),i[0]+"E+"+this.padZeros(i[1])}return null},toAccounting:function(i,r,u){if(this.isNumber(r)&&i){var e,o,s=t.widgetBase.formatting(i,r,u),f=this._currencySymbol,h=n.trim(s.replace(f,"")),c=s.indexOf(f);!c||r<0&&c===1?(e=f,o=Number(r)?h:"-"):(e=Number(r)?h:"-",o=f);r=e+"   "+o}return r},intToDate:function(n){return new Date((Number(n)-2)*864e5+new Date("01/01/1900").getTime())},getGcd:function(n,t){return(n=Number(n),t=Number(t),!t)?n:this.getGcd(t,n%t)},isNumber:function(n){return n-parseFloat(n)>=0},isTime:function(n){return n?n.toString().indexOf(":")!==-1:!1},isFormula:function(n){var t,i;return n&&!n.toString().indexOf("=")&&n.length>1?(t=n.split("(").length-1,i=n.split(")").length-1,t===i):!1},getPlaceValue:function(n,t){var i=n.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},padZeros:function(n,i,r){return this.isNumber(n)?(i=this.isNumber(i)?i:2,r=t.isNullOrUndefined(t.Spreadsheet.autoFillDirection[r])?t.Spreadsheet.autoFillDirection.Left:t.Spreadsheet.autoFillDirection[r],r===t.Spreadsheet.autoFillDirection.Left?n<=this.maxValue(i)?Array(i-this.getDigits(n)+1).join("0")+n.toString():n.toString():n<this.minValue(i)?n.toString()+Array(i-this.getDigits(n)+1).join("0"):n.toString()):null},maxValue:function(n){return this.isNumber(n)?Number(Array(n+1).join("9")):null},minValue:function(n){return this.isNumber(n)?Number("1"+Array(n).join("0")):null},getDigits:function(n){return this.isNumber(n)?n.toString().length:null},_round:function(n,t){return Number(Math.round(n+"e"+t)+"e-"+t)},_parseTime:function(n){var u,t,i=0,r=3,f={},e;if(this.isTime(n))for(n=n.toString(),t=n.split(" "),u=t.length;i<u;){if(this.isTime(t[i]))for(e=t[i].split(":");r<6;)f[this._datePattern[r]]=e[r-3]||"0",r++;i++}return f},_dateToInt:function(n,t){var r=new Date("01/01/1900"),u=this._isDateTime(n)?n:new Date(n),f=u.getTime()-r.getTime(),i=f/864e5+2;return t?i%1:i},_defTimeFormat:function(n){return[n.getHours(),n.getMinutes(),n.getSeconds()].join(":")},_isDate:function(n){var i={};return t.isNullOrUndefined(t.parseDate(n.toString()))||(n=this._dateToInt(n.toString())),/^((0?[1-9]|1[012])[-.](0?[1-9]|[12][0-9]|3[01])[-.](19|20)?[0-9]{2})*$/.test(n.toString())?(n=n.toString().replace("-","/","g"),n=this._dateToInt(n.toString()),i.text=n,i.isDate=!0):(i.text=n,i.isDate=!1),i},_defDateFormat:function(n){return[n.getMonth()+1,n.getDate(),n.getFullYear()].join("/")},_isCellReference:function(n){return/^[a-z]{1,3}\d{1,7}$/gi.test(n)?"relative":/^\$[a-z]{1,3}\$\d{1,7}$/gi.test(n)?"absolute":/^((\$[a-z]{1,3})\d{1,7}|[a-z]{1,3}(\$\d{1,7}))$/gi.test(n)?"mixed":!1},_isDateTime:function(n){return Object.prototype.toString.call(n)==="[object Date]"&&!isNaN(n.valueOf())},_decimalCnt:function(n){var t,i;return this.isNumber(n)&&(n=Number(n),t=n.toString(),t.indexOf(this._decimalSeparator)>-1)?(i=n.toFixed(),t.length-i.length-1):0},_getPosDiff:function(n,t){return n>t?n-t:t-n}}}(jQuery,Syncfusion),function(n,t,i){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.resizing=function(t){this.XLObj=t;this._$visualElem=n();this._currentHCell=-1;this._colMinWidth=15;this._rowMinHeight=20;this._allowStart=!1;this._resizeStart=!1;this._resizeType="";this._tableY=null;this._oldWidth=null;this._orgX=null;this._orgY=null;this._extra=null;this._initialTableWidth=null;this._resizeElt=null;this._tableX=null;this._oldHeight=null;this._initialTableHeight=null;this._resizerowId=0};t.spreadsheetFeatures.resizing.prototype={getColWidth:function(n){return this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).columnsWidthCollection[n]},getRowHeight:function(n){return this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).rowsHeightCollection[n]},setColWidth:function(n,t){if(this.XLObj.model.allowResizing){var i=this.XLObj.getActiveSheetIndex();this._currentHCell=n;this._resizeColumnUsingDiff(t,this.XLObj.getSheet(i).columnsWidthCollection[n],[n]);this.XLObj.XLScroll._getColWidths(i,n);this.XLObj.XLSelection.refreshSelection()}},setRowHeight:function(n,t){var r=this.XLObj,i;this.XLObj.model.allowResizing&&(i=this.XLObj.getActiveSheetIndex(),this._currentHCell=n,this._resizeRowUsingDiff(t,this.XLObj.getSheet(i).rowsHeightCollection[n],[n]))},_headerMouseDown:function(n){n.preventDefault();this._colMouseDown(n)},_colMouseDown:function(t){var u,r=this.XLObj,i={};if(u=r._setXY(t,navigator.userAgent.indexOf("WebKit")>-1),this._orgX=u[0]+document.documentElement.scrollLeft,this._orgY=u[1],r._isTouchEvt&&this._mouseHover(t),this._allowStart&&(n(t.target).css("cursor")==="col-resize"||r._isTouchEvt)){if(i.event=t,i.target=t.target,i.colIndex=this._currentHCell,i.oldWidth=t.target.getBoundingClientRect().width,i.reqType="column-resize",r._trigger("resizeStart",i))return;t.button!==2&&this._start(this._orgX,this._orgY);this._resizeType="Col";t.preventDefault()}},_mouseHover:function(t){var s,i=this.XLObj,r=t.target,c=i.getActiveSheetIndex(),o=i._getJSSheetHeader(c);if(!this._$visualElem.is(":visible")&&(i._hasClass(r,"e-headercelldiv")&&(r=r.parentNode),i._hasClass(r,"e-headercell"))){var e=r,u=e.getBoundingClientRect(),h=i._setXY(t),f=h[0],l=h[1];if(s=n(o.find(".e-table")[0]).width()+n(o.find(".e-columnheader")[0]).offset().left,(f>=u.left+document.documentElement.scrollLeft+e.offsetWidth-(i._isTouchEvt?15:7)||f<u.left+(i._isTouchEvt?13:0))&&f<s&&f>=u.left&&l<=u.top+document.documentElement.scrollTop+r.offsetHeight){if(this._currentHCell=o.find(".e-headercell").index(e),this._currentHCell<1&&f<u.left+e.offsetWidth-(i._isTouchEvt?15:5)||this._preventColResize(this._currentHCell,!1))return;i.addClass(r,"e-ss-colresize");this._allowStart=!0}else i._removeClass(n(".e-ss-colresize")[0],"e-ss-colresize"),this._allowStart=!1,this._currentHCell=-1}},_preventColResize:function(n,t){this._currentHCell=n;var r=this.XLObj,c=r.getActiveSheetIndex(),u=[],s=r.getSheet(c).pivotMngr.pivot,u=r.getObjectKeys(s),f,o,h,e,i,l=u.length;if(u.length)for(i=0;i<l;i++)return f=s[u[i]].colIndex,h=r.element.find("#"+u[i]).data("ejPivotGrid"),e=h.calculateCellWidths().columnWidths.length,e||(e=3),o=f+e,t?this._currentHCell>=f&&this._currentHCell<o:this._currentHCell>=f&&this._currentHCell<=o},_start:function(i){var r=this.XLObj,f,e=r.getActiveSheetIndex(),o=r._getJSSheetHeader(e),c=o.find(".e-columnheader"),s=c.find(".e-headercell"),u,h;(this._currentHCell>-1&&this._currentHCell<s.length&&(u=s[this._currentHCell]),t.isNullOrUndefined(u))||(h=u.getBoundingClientRect(),this._tableY=h.top+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart?(this._$visualElem=n(document.createElement("div")),f=r._getJSSheetContent(e).height()+o.height(),this._$visualElem.addClass("e-reSizeColbg").appendTo(r.element).css({height:f+"px"}).addClass("e-ss-colresize"),this._$visualElem.css({left:i-1,top:this._tableY}),this._oldWidth=u.offsetWidth,this._extra=i-this._orgX,this._resizeStart=!0):this._currentHCell=-1)},_cMouseMove:function(n){if(this._resizeStart){var t=this.XLObj._setXY(n,navigator.userAgent.indexOf("WebKit")>-1)[0];t+=document.documentElement.scrollLeft;n.preventDefault();this._moveVisual(t);this.XLObj.addClass(n.target,"e-ss-colresize")}else this._mouseHover(n)},_reSize:function(t){var f,i=this.XLObj,s,r=i.getActiveSheetIndex(),e,l=i._getJSSheetHeader(r),h=l.find(".e-colselected"),c=h.length,u,o=[];if(this._initialTableWidth=i._getJSSheetHeader(r).find(".e-headercontent").width(),this._getResizableCell(),this._currentHCell>-1&&this._resizeStart){for(f=i.getSheet(r).columnsWidthCollection[this._currentHCell],c>0&&(u=h[0].cellIndex),e=0;e<c;e++)this._currentHCell===u&&(s=!0),o.push(u),u++;s||(o=[this._currentHCell]);this._resizeColumnUsingDiff(t-this._orgX+f,f,o);i._isAutoWHMode&&i._autoSSWidthHeight();i.model.allowAutoFill&&(i.XLDragFill.positionAutoFillElement(),i.XLDragFill.hideAutoFillOptions());n("#"+i._id+"ddlspan").length&&i._ddlPosition()}i.XLScroll._getRowHeights(r,this._currentHCell);i.model.allowFreezing&&i.XLFreeze._refreshFColResize(this._currentHCell);i.model.allowSelection&&i.XLSelection._refreshBorder();this._removeVisualElem()},_resizeColumnUsingDiff:function(t,i,r){var h,f,c,l,a,v,p,w,u=this.XLObj,y={},o=u.getActiveSheetIndex(),b=u._getJSSheetHeader(o),e,k,d,s,g;if(t>0){for(t=t>this._colMinWidth?t:this._colMinWidth,e=0,k=r.length;e<k;e++){if(u.XLEdit.getPropertyValue(0,r[e],"wrapCol")&&u.XLEdit.getPropertyValue(0,r[e],"wrapWidth")>t){u._dupDetails=!0;continue}if(p=b.find("col:eq("+r[e]+")"),w=u._getJSSheetContent(o).find(".e-spreadsheetcontentcontainer").find("col:eq("+r[e]+")"),p.outerWidth(t),w.width(t),u.getSheet(o).columnsWidthCollection[r[e]]=t,t<i)for(a=u._getContent(o).find(".e-rowcell:nth-child("+(r[e]+1)+")"),s=0,d=a.length;s<d;s++)f=u._getCellIdx(a[s]),c=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2"),c&&(u._refreshGlobalSpan(),h=n("#"+u._id+"_emptySpan"),u.addClass(h[0],"e-rowcell"),h.text(c),l=h.outerWidth(),u._refreshGlobalSpan(),t<l&&(u._textClip(f.rowIndex,f.colIndex,"delete"),u._textClip(f.rowIndex,f.colIndex,"add",l)));else for(v=u._getContent(o).find(".e-rowcell.e-ofbrdr:nth-child("+(r[e]+1)+")"),s=0,g=v.length;s<g;s++)f=u._getCellIdx(v[s]),u._textClip(f.rowIndex,f.colIndex,"delete","",!0),u._textClip(f.rowIndex,f.colIndex,"add","",!0)}b.find(".e-columnheader").css("cursor","default");u._dupDetails||(y={sheetIndex:o,cols:r,newWidth:t,oldWidth:i,reqType:"resize-column"},i!==t&&(u._completeAction(y),u._trigActionComplete(y)));u._dupDetails&&(u._dupDetails=!1);u.XLScroll._getColWidths(o,r[0]);u.model.scrollSettings.allowScrolling&&(u.XLScroll._refreshScroller(o,"refresh","all"),u.XLScroll._getFirstColumn(o))}},_calculateWidth:function(){for(var t=this.XLObj,i=t._getJSSheetHeader(t.getActiveSheetIndex()).find("col"),r=0,n=0;n<i.length;n++)r+=i.eq(n).width();return r},_cMouseUp:function(n){if(this._resizeStart){var r,i=this.XLObj,u=this._currentHCell,f=i.getSheet(i.getActiveSheetIndex()).columnsWidthCollection,t={};if(r=i._setXY(n,navigator.userAgent.indexOf("WebKit")>-1)[0],r+=document.documentElement.scrollLeft,t.event=n,t.target=n.target,t.oldWidth=f[u],t.colIndex=this._currentHCell,this._reSize(r),t.newWidth=f[u],t.reqType="column-resize",this.XLObj._trigger("resizeEnd",t))return;i.element.find("#"+i._id+"ddl").ejDropDownList("hidePopup")}},_getResizableCell:function(n){for(var i=this.XLObj,r=i.getActiveSheetIndex(),o=i._getJSSheetHeader(r).find(".e-columnheader"),u=o.find(".e-headercell"),s=navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollLeft:document.documentElement.scrollLeft,f,e,t=0,h=u.length;t<h;t++)if(e=u[t].getBoundingClientRect(),f=e.left+s+5,f>this._orgX){i.isUndefined(n)?this._currentHCell=t-1:n.target=i._getJSSheetHeader(r).find("th:eq("+(t-1)+")")[0];return}},_moveVisual:function(n){var i=this.XLObj,t=i._getJSSheetHeader(i.getActiveSheetIndex()).find(".e-headercontent")[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<n||n<t.left+document.documentElement.scrollLeft?this._$visualElem.remove():this._currentHCell>-1&&this._$visualElem.css({left:n-1,top:this._tableY})},_rowMouseDown:function(t){var f,r,u,i={},e=this.XLObj;if(e._isTouchEvt&&this._rowMouseHover(t),this._allowStart&&n(t.target).css("cursor")==="row-resize"){if(u=e._setXY(t,navigator.userAgent.indexOf("WebKit")>-1),f=u[0],r=u[1],r+=document.documentElement.scrollTop,i.event=t,i.target=t.target,i.rowIndex=this._currentHCell,i.oldHeight=t.target.getBoundingClientRect().height,i.reqType="row-resize",this.XLObj._trigger("resizeStart",i))return;t.button!==2&&this._rowStart(f,r);this._resizeType="Row";t.preventDefault()}return!1},_rowMouseHover:function(t){var r;if(!this._$visualElem.is(":visible")&&(r=n(t.target),r.hasClass("e-rowheader"))){var i=this.XLObj,o=i.getActiveSheetIndex(),h=i._getJSSheetRowHeaderContent(o),e=r.get(0),u=e.getBoundingClientRect(),s=i._setXY(t),c=s[0],f=s[1],l=i._getJSSheetRowHeader(o).find(".e-table").height()+h.find("tbody").offset().top;if((f>=u.top+document.documentElement.scrollTop+e.offsetHeight-(i._isTouchEvt?8:7)||f<u.top+(i._isTouchEvt?8:0))&&f<l&&f>=u.top&&c<=u.left+document.documentElement.scrollLeft+t.target.offsetWidth){if(this._resizeElt=r.parent(),this._currentHCell=i.model.scrollSettings.allowVirtualScrolling?parseInt(this._resizeElt.attr("data-idx")):this._resizeElt[0].rowIndex,this._currentHCell<1&&f<u.top+e.offsetHeight-(i._isTouchEvt?8:5)||this._preventRowResize(this._currentHCell,!1))return;r.addClass("e-ss-rowresize");this._allowStart=!0}else n(".e-ss-rowresize").removeClass("e-ss-rowresize"),this._allowStart=!1,this._currentHCell=-1;this._resizerowId=t.target.parentNode.getAttribute("data-idx")}},_preventRowResize:function(n,t){this._currentHCell=n;var r=this.XLObj,c=r.getActiveSheetIndex(),u=[],s=r.getSheet(c).pivotMngr.pivot,u=r.getObjectKeys(s),f,o,h,e,i,l=u.length;if(u.length)for(i=0;i<l;i++)return f=s[u[i]].rowIndex,h=r.element.find("#"+u[i]).data("ejPivotGrid"),e=h._rowCount,e||(e=4),o=f+e,t?this._currentHCell>=f&&this._currentHCell<o:this._currentHCell>=f-1&&this._currentHCell<=o},_rowStart:function(t,i){var r=this.XLObj,f=r.getActiveSheetIndex(),e=this._resizeElt[0].rowIndex,o=r._getJSSheetRowHeader(f).find(".e-rowheader"),u,s,h;(this._currentHCell>-1&&e<o.length&&(u=o[e]),u)&&(s=u.getBoundingClientRect(),this._tableX=s.left+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollLeft:document.documentElement.scrollLeft),this._allowStart?(this._$visualElem=n(document.createElement("div")),h=r._getJSSheetContent(f).width(),this._$visualElem.addClass("e-reSizeRowbg").appendTo(r.element).css({width:h+"px"}).addClass("e-ss-rowresize"),this._$visualElem.css({top:i-3,left:this._tableX}),this._oldHeight=u.offsetHeight,this._orgX=t,this._orgY=i,this._extra=i-this._orgY,this._resizeStart=!0):this._currentHCell=-1)},_rMouseMove:function(t){if(this._resizeStart){var i=this.XLObj._setXY(t,navigator.userAgent.indexOf("WebKit")>-1)[1];i+=document.documentElement.scrollTop;t.preventDefault();n(t.target).addClass("e-ss-rowresize");this._moveRowVisual(i)}else this._rowMouseHover(t)},_rowResize:function(t,i){var u,r=this.XLObj,f=r.getActiveSheetIndex(),p=r.getRows(f)[1],s=!1,h,w=r._getJSSheetRowHeaderContent(f),l=w.find(".e-rowselected"),a=l.length,e,v,c=[],y=0,o;if(this._initialTableHeight=r._getJSSheetRowHeader(f).find(".e-rowheadercontent").height(),this._getResizableRowCell(),s=n(p[this._currentHCell]).find(".e-sswraptext").length>0,this._currentHCell>-1&&this._resizeStart){for(o=0;o<=this._resizerowId;o++)r.XLEdit.getPropertyValue(o,0,"isRHide")&&y++;if(u=r.getSheet(f).rowsHeightCollection[this._currentHCell+y],!s||s&&i-this._orgY+u>u){for(a>0&&(e=l[0].parentNode.rowIndex),h=0;h<a;h++)this._currentHCell===e&&(v=!0),c.push(e),e++;v||(c=[this._currentHCell]);this._resizeRowUsingDiff(i-this._orgY+u,u,c)}r.model.allowAutoFill&&(r.XLDragFill.positionAutoFillElement(),r.XLDragFill.hideAutoFillOptions());r._isAutoWHMode&&r.model.showRibbon&&r._autoSSWidthHeight(f,!0)}r.model.allowSelection&&r.XLSelection._refreshBorder();this._removeVisualElem()},_resizeRowUsingDiff:function(n,t,i){var r=this.XLObj,u=r.getActiveSheetIndex(),o={},s=r._getJSSheetRowHeaderContent(u),a,v,f,h,c,e,l;if(n>0){for(n=n>this._rowMinHeight?n:this._rowMinHeight,e=0,l=i.length;e<l;e++)f=i[e],h=r.model.scrollSettings.allowVirtualScrolling?r.getSheet(u)._virtualRowIdx.indexOf(f):f,c=this._getContentHeight(f,u)<=n,r._isRowViewable(u,f)&&(r._isUndoRedo||c)&&(a=s.find("tr:eq("+h+")"),v=r._getJSSheetContent(u).find(".e-content").find("tr:eq("+h+")"),a.outerHeight(n),v.height(n)),(r._isUndoRedo||c)&&(r.getSheet(u).rowsHeightCollection[f]=n);r.XLScroll._getRowHeights(u,i[0]);s.find("tbody").css("cursor","default");s.find("tbody").children().css("cursor","default");r._dupDetails||(o={sheetIndex:u,rows:i,newHeight:n,oldHeight:t,reqType:"resize-row"},t!==n&&(r._completeAction(o),r._trigActionComplete(o)));r.model.allowFreezing&&r.XLFreeze._refreshFRowResize(f);r.model.scrollSettings.allowScrolling&&(r.XLScroll._refreshScroller(u,"refresh","all"),r.XLScroll._getFirstRow(u))}},_findRowsHeight:function(n){for(var t=this.XLObj,i=t.getActiveSheetIndex(),f=t.getSheet(i),e=t._getJSSheetContent(i).find("tbody").children(),r,u=0,o=n.length;u<o;u++)r=n[u],t._sheets[i]._Rows[0]&&(f.rowsHeightCollection[r]=e.eq(r).height())},_calculateHeight:function(){for(var t=this.XLObj,i=t.getRows(t.getActiveSheetIndex())[0],r=0,n=0,u=i.length;n<u;n++)r+=i.eq(n).height();return r},_rMouseUp:function(t){if(this._resizeStart){var r=this.XLObj,f=this._currentHCell,e=r.getSheet(r.getActiveSheetIndex()).rowsHeightCollection,i={},o,u,s=r._setXY(t,navigator.userAgent.indexOf("WebKit")>-1);if(o=s[0],u=s[1],u+=document.documentElement.scrollTop,i.event=t,i.target=t.target,i.oldHeight=e[f],i.rowIndex=this._currentHCell,this._rowResize(o,u),i.newHeight=e[f],i.reqType="row-resize",this.XLObj._trigger("resizeEnd",i))return;n("#"+this.XLObj._id+"ddlspan").length&&this.XLObj._ddlPosition()}},_getResizableRowCell:function(t){for(var r=this.XLObj,e=r.getActiveSheetIndex(),u=r._getJSSheetContent(e).find(".e-rowheader"),c=navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop,o,f,s=1,h,i=0,l=u.length;i<l;i++)if(f=u[i].getBoundingClientRect(),f.top===0&&s++,o=f.top+c+5,o>this._orgY){r.isUndefined(t)?(h=n(u[i-1]).is(":visible")?i-1:i-s,this._currentHCell=r._getCellIdx(u[h]).rowIndex):t.target=r._getJSSheetRowHeader(e).find("tr:eq("+i+") td")[0];return}},_moveRowVisual:function(n){var i=this.XLObj,t=i._getJSSheetContent(i.getActiveSheetIndex()).find(".e-rowheadercontent")[0].getBoundingClientRect();t.top+document.documentElement.scrollTop+t.height<n||n<t.top+document.documentElement.scrollTop?this._$visualElem.remove():this._currentHCell>-1&&this._$visualElem.css({top:n-3,left:this._tableX})},_apMouseDown:function(t){var i,r=this.XLObj;return r._isTouchEvt&&this._apMouseHover(t),this._allowStart&&n(t.target).closest("div").css("cursor")==="col-resize"&&(i=r._setXY(t,navigator.userAgent.indexOf("WebKit")>-1)[0],i+=document.documentElement.scrollLeft,t.button!==2&&this._apStart(i),this._resizeType="AP",t.preventDefault()),!1},_apMouseHover:function(t){var i=this.XLObj;if(!this._$visualElem.is(":visible")){var r=n(t.target),e=r.get(0),u=i.getActivationPanel()[0].getBoundingClientRect(),f=i._setXY(t)[0];f<=u.left+(i._isTouchEvt?20:4)&&f>=u.left?(r.parent().addClass("e-ss-apresize"),this._allowStart=!0):(i.element.find(".e-ss-apresize").removeClass("e-ss-apresize"),this._allowStart=!1)}},_apStart:function(t){var i=this.XLObj,f=i.getActivationPanel()[0],e=f.getBoundingClientRect(),r=i.getActiveSheetIndex(),u;this._tableY=e.top+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop);this._allowStart&&(this._$visualElem=n(document.createElement("div")),u=i._getJSSheetContent(r).height()+i._getJSSheetHeader(r).height(),this._$visualElem.addClass("e-reSizeAPbg").appendTo(i.element).css({height:u+"px"}).addClass("e-ss-apresize"),this._$visualElem.css({left:t,top:this._tableY}),this._resizeStart=!0)},_apMouseMove:function(n){if(this._resizeStart){var i=this.XLObj,t=i._setXY(n,navigator.userAgent.indexOf("WebKit")>-1)[0];t+=document.documentElement.scrollLeft;n.preventDefault();this._apMoveVisual(t)}else this._apMouseHover(n)},_apMouseUp:function(n){if(this._resizeStart){var i=this.XLObj,t=i._setXY(n,navigator.userAgent.indexOf("WebKit")>-1)[0];t+=document.documentElement.scrollLeft;this._apReSize(t)}},_apMoveVisual:function(n){this._$visualElem.css({left:n-5,top:this._tableY})},_apReSize:function(t){var i=this.XLObj,s=i.model.activationPanelWidth,f=0,r=n.extend(!0,{},i.model.scrollSettings),e=i.getActivationPanel(),o,u;r.width=i._responsiveWidth;r.height=i._responsiveHeight;i.model.activationPanelWidth=Math.abs(r.width-(t-i.element.offset().left));i.model.enablePivotTable&&(u=i.getActivationPanel().data("ejScroller"),f=i.getActivationPanel().find(".e-vscrollbar").length?20:2,e.find(".e-ss-pivotfield").width(i.model.activationPanelWidth-f),e.find("#"+i._id+"_PivotField").width(i.model.activationPanelWidth-f),s>i.model.activationPanelWidth?(u.option({width:i.model.activationPanelWidth-1}),i._setSheetWidthHeight(i.getActiveSheetIndex(),{width:r.width,height:r.height},null,"resize")):(i._setSheetWidthHeight(i.getActiveSheetIndex(),{width:r.width,height:r.height},null,"resize"),u.option({width:i.model.activationPanelWidth-1})),o=i.getActivationPanel().find("#"+i._id+"_PivotTableSchema_"+i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id).data("ejPivotSchemaDesigner"),o._reSizeHandler(),u.refresh());this._removeVisualElem()},_removeVisualElem:function(){var n=this.XLObj;this._$visualElem.remove();n.element.find(".e-reSizeRowbg").remove();this._resizeStart=!1;this._currentHCell=-1;this._resizeType="";this._allowStart=!1;n.model.allowComments&&n.XLComment._updateCmntArrowPos()},fitWidth:function(n){var t=this.XLObj,r=t.getActiveSheetIndex(),i,u;if(t.model.allowResizing){for(i=0,u=n.length;i<u;i++)this._fitWidth(n[i],0,t.getSheet(r).usedRange.rowIndex);t.model.scrollSettings.allowScrolling&&(t.XLScroll._getColWidths(r,n[0]+1),t.XLScroll._refreshScroller(r,"refresh","horizontal"));t.model.allowSelection&&t.XLSelection._refreshBorder();t.model.allowComments&&t.XLComment._updateCmntArrowPos(null,r,{colIndex:n[i]})}},_resizeToFitWidth:function(t){var i=this.XLObj,f=n(t.target),r=i.getActiveSheetIndex(),u=i.getSheet(r).usedRange.rowIndex;this._getResizableCell(t);this._fitWidth(t.target.cellIndex,0,u);i.model.scrollSettings.allowScrolling&&(i.XLScroll._getColWidths(i.getActiveSheetIndex(),t.target.cellIndex+1),i.XLScroll._refreshScroller(r,"refresh","horizontal"));i.model.allowSelection&&i.XLSelection._refreshBorder();i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement();i.model.allowComments&&i.XLComment._updateCmntArrowPos(null,r,{colIndex:t.target.cellIndex})},_fitWidth:function(t,i,r){var u=this.XLObj,f=u.getActiveSheetIndex(),o=u._getJSSheetHeader(f).find(".e-headercell")[t],a=n(o).children(".e-headercelldiv"),e=0,h=0,s=0,c=u.getSheet(f),l;r=r?r:c.usedRange.rowIndex;s=this._getContentWidth(t,f,i,r);h=this._getHeaderContentWidth(a,f);s>1&&(e=h>s?h:s,l={target:o,sheetIndex:f,colIndex:t,newWidth:e,oldWidth:o.offsetWidth,reqType:"resize-fit-width"},e>0&&(e<20&&(e=30),this._applyWidth(o,f,t,e),u.model.allowFreezing&&u.XLFreeze._refreshFColResize(t),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement(),c._isImported&&!c._isLoaded||u._isUndoRedo||u._dupDetails||u._isExport||(u._completeAction(l),u._trigActionComplete(l))));u.XLEdit._updateDataContainer({rowIndex:0,colIndex:t},{dataObj:{isFitWidth:!0}})},_applyWidth:function(n,t,i,r){var u=this.XLObj;u._getJSSheetHeader(t).find("col:eq("+i+")").width(r);u._getJSSheetContent(t).find("col:eq("+(i+1)+")").width(r);u.getSheet(t).columnsWidthCollection[i]=r;u.getSheet(t).columns[i].width=r},_getContentWidth:function(n,r,u,f){for(var c=0,s,h,l=this.XLObj,a=l._dataContainer.sheets[r],o,e=u;e<=f;e++)t.isNullOrUndefined(a[e])||(s=a[e][n]),t.isNullOrUndefined(s)?(s={},h={spanWidth:0,paddingWidth:0}):h=this._getCalculatedCellWidth(r,s),o=l._detailsFromGlobalSpan(e,n,"width",l.XLEdit.getPropertyValue(e,n,"value2"),i,!0),o=o+h.spanWidth+h.paddingWidth+4,o>c&&(c=o);return c},_getCalculatedCellWidth:function(n,t){var i=0,r=0;return"isFilterHeader"in t?"isFilterVisible"in t&&(i+=17):i+=0,r=3,{spanWidth:i,paddingWidth:r}},_getHeaderContentWidth:function(n){var i=0,r=t.buildTag("span",{},{}),u=n.html();return r.html(u),n.html(r),i=n.find("span:first").width(),i=i+10,n.html(u),i},fitHeight:function(n){var i=this.XLObj,u,r,f;if(i.model.allowResizing){for(u=i.getActiveSheetIndex(),r=0,f=n.length;r<f;r++)t.isNullOrUndefined(i.XLEdit.getPropertyValue(n[r],0,"wrapRow"))&&this._fitHeight(n[r],n[r]),i._setRowHdrHeight(u,n[r]);i.model.scrollSettings.allowScrolling&&(i.XLScroll._getRowHeights(u,n[0]),i.XLScroll._refreshScroller(u,"refresh","vertical"));i.model.allowSelection&&i.XLSelection._refreshBorder();i.model.allowComments&&i.XLComment._updateCmntArrowPos(null,u,{rowIndex:n[0]})}},_resizeToFitHeight:function(n){var t=this.XLObj,i=t.getActiveSheetIndex(),r=n.target.parentNode.rowIndex,u;u=t.model.scrollSettings.allowVirtualScrolling?t.getSheet(i)._virtualRowIdx[r]:r;this._getResizableRowCell(n);this._fitHeight(r,u);t._setRowHdrHeight(i,u);t.model.scrollSettings.allowScrolling&&(t.XLScroll._getRowHeights(t.getActiveSheetIndex(),u),t.XLScroll._refreshScroller(i,"refresh","vertical"));t.model.allowSelection&&t.XLSelection._refreshBorder();t.model.allowAutoFill&&t.XLDragFill.positionAutoFillElement();t.model.allowComments&&t.XLComment._updateCmntArrowPos(null,i,{rowIndex:r})},_fitHeight:function(i,r){var u=this.XLObj,f=u.getActiveSheetIndex(),s=u.getSheet(f),l=u._getJSSheetRowHeader(f).find(".e-rowheader")[i],e=0,h=0,o,a=t.buildTag("span",{},{height:20,width:30}),c;h=this._getContentHeight(r,f,u.XLEdit.getPropertyValue(r,0,"wrapRow"));a.html(r+1);u.element.append(a);o=u.element.find("span:last").outerHeight(!0);u.element.find("span:last").remove();o=o+4;e=h<o?o:h;c={target:l,sheetIndex:f,rowIndex:r,newHeight:e,oldHeight:s.rowsHeightCollection[i],reqType:"resize-fit-height"};u._isRowViewable(f,r)&&(n(l.parentElement).height(e),n(u._getContent(f).find("tr")[i]).height(e));u.getSheet(f).rowsHeightCollection[r]=e;u.model.allowFreezing&&u.XLFreeze._refreshFRowResize(i);u.model.scrollSettings.allowScrolling&&u.XLScroll._refreshScroller(f,"refresh","all");s._isImported&&!s._isLoaded||u._dupDetails||u._isExport||(u._completeAction(c),u._trigActionComplete(c));u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement();u.XLEdit._updateDataContainer({rowIndex:r,colIndex:0},{dataObj:{isFitHeight:!0}})},_getContentHeight:function(n,t,r){for(var u=this.XLObj,e=0,o,a=u._formatRegx,h=u.getSheet(t),s=u.getObjectKeys(u._dataContainer.sheets[t][n]),v=h.rowsHeightCollection[n],c=h.columnsWidthCollection,f=0,l=s.length;f<l;f++)o=u._detailsFromGlobalSpan(n,s[f],"height",u.XLEdit.getPropertyValue(n,s[f],"value2"),r?c[f]:i,!0),o>e&&(e=o);return e+3},_setRowHdrHeightResize:function(i,r){for(var f=this.XLObj,e=f.getRows(i),o=e[0],s=f.getSheet(i).usedRange.rowIndex,u=0;u<=s;u++)t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,r,"mergeIdx"))&&t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,r,"merge"))&&f._isRowViewable(i,u)&&(tdHeight=f._detailsFromGlobalSpan(u,r,"height",f.XLEdit.getPropertyValue(u,r,"value2")),n(o[u]).height(tdHeight))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.editing=function(n){this.XLObj=n;this._EditCellDetails={value:null,rowIndex:-1,columnIndex:-1,fieldName:null,cell:null};this._isEdit=!1;this._isFEdit=!1;this._isFormulaEdit=!1;this._isFBarFocused=!1;this._skipHTML=!1;this._editElem=null;this._filterIcon=null;this._isCellEdit=!0;this._validOperators=["+","-","*","/",","];this._invalidOperators=["%"];this._validCharacters=["+","-","*","/",",","(","="];this._textDecoration=!1;this._editCell=null;this._acPosition={left:0,top:0};this._isValidation=!1};t.spreadsheetFeatures.editing.prototype={getCurrentEditCellData:function(){var r,n,t=this.XLObj,i;return this._isEdit?(r=t.element.find("#"+t._id+"_Edit"),n=r.text(),i=t._getCellIdx(this._editCell[0]),this.getPropertyValue(i.rowIndex,i.colIndex,"type")!="text"&&t.isNumber(n)&&(n=parseFloat(n)),n):null},getColumnIndexByField:function(n){for(var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),t=0,u=r.columns.length;t<u;t++)if(r.columns[t].field===n)break;return t},_processEditing:function(){this._editElem||(this._editElem=t.buildTag("div.e-field e-ss-input","",{},{id:this.XLObj._id+"_Edit",contenteditable:!0}),this._editElem.data("parentID",this.XLObj._id))},editCell:function(i,r,u){var f=this.XLObj,c,s,o,a,e,v,w,h,l,b,k,y,p,d;f.model.allowEditing&&f.model.allowSelection&&!f._isCellProtected(i,r,!0)&&!f.model.isReadOnly&&((f=this.XLObj,b=f.element.find("#"+f._id+"_ValElem"),l={rowIndex:i,colIndex:r},s=f.getActiveSheetIndex(),o=f.getSheet(s),v=f.getActiveCell(s),f._isRowViewable(s,i)&&(this._textDecoration=f.getCell(i,r).find("a").css("text-decoration")==="none"),h=f.getCell(i,r),c=o.columns[r],this._editCell=h,e={columnName:c.field,value:f.getRangeData({range:[i,r,i,r],valueOnly:!0,sheetIdx:s,skipDateTime:!0})[0],columnObject:c,cell:h,rowIndex:i,colIndex:r},f.model.locale!="en-US"&&f.isNumber(e.value)&&(k=this.getPropertyValue(i,r,"value2",s),y=e.value+"",p=t.preferredCulture(f.model.locale).numberFormat,d=new RegExp("\\"+p[","]+"\\d{3}"),p[","]=="."&&(d.test(y)||e.value!=k)&&(e.value=f._getlocaleNumVal(y,!0))),f._trigger("cellEdit",e))||(f._cureditedCell=e.value,this._isValidation&&(b.rules("remove"),this._isValidation=!1),(v.rowIndex!==i||v.colIndex!==r)&&(o._activeCell=l,o._startCell.rowIndex<=i&&o._startCell.colIndex<=r&&o._endCell.rowIndex>=i&&o._endCell.colIndex>=r?f.XLSelection.selectRange(o._startCell,o._endCell):f.XLSelection.selectRange(l,l),f.model.allowAutoFill&&f.XLDragFill.positionAutoFillElement()),this._EditCellDetails={rowIndex:i,value:e.value,columnIndex:r,fieldName:c.field,cell:h},u||(e.value=""),w=e.value,this._renderBulkEditObject(e,h,w),this.getPropertyValue(o._activeCell.rowIndex,o._activeCell.colIndex,"rule",s)&&f.model.allowDataValidation&&f.XLValidate._setValidation(),a=n("#"+f._id+"_Edit"),this.getPropertyValue(i,r,"hyperlink",s)&&a.addClass("e-hyperlinks"),this._textDecoration&&a.css("text-decoration","none"),f.model.allowComments&&h.hasClass("e-commentcell")&&f.XLComment._visibleCmntCnt(h),e.cell.addClass(f._browserDetails.name==="msie"?"e-editedcell e-msie-edit":"e-editedcell"),f.isFormula(e.value)&&this._processFormulaEditRange(e.value),f.model.allowKeyboardNavigation&&(f.XLCellNav._isNavigate=!1),f.model.enableContextMenu&&n("#"+f._id+"_contextMenuCell").data("ejMenu")._contextMenuEvents("_off")))},_renderBulkEditObject:function(i,r,u){var s,a,f=this.XLObj,v=r.height(),o=f.getActiveSheetIndex(),h=r.find(".e-filterspan"),l=f._getJSSheetContent(o).find(".e-spreadsheetcontentcontainer > .e-content"),y=f.XLFormat.getFormatClass(r[0].className),c,e;({})[i.columnObject.field]=i.value;h.length&&(a={filterIcon:h,rowIndex:h.parentsUntil("table").eq(1).index(),colIndex:h.parent().index()},this._filterIcon=a);s=r.height();this._refreshTextNode(r[0]);r.hasClass("e-sswraptext")&&v!==s&&r.height(v);e=this._editElem;e.text("");t.isNullOrUndefined(u)||e.text(u);l.append(e);c=f._isClassHasProperty(y,"text-align","right")?{right:l.width()-r[0].offsetLeft-r[0].offsetWidth+2,left:"",maxWidth:r[0].offsetLeft+r[0].offsetWidth+2}:{left:r[0].offsetLeft+2,right:"",maxWidth:l.width()-(r.offset().left-(f.element.offset().left+n(f.getRows(o)[0][0]).width()))-2};e.css({left:c.left,right:c.right,top:r[0].offsetTop+1,"-webkit-user-select":"text",cursor:"text","min-height":s-1,height:"auto",lineHeight:"normal",wordWrap:"break-word",position:"absolute",minWidth:r.width(),whiteSpace:"pre-wrap"});this._editCell.hasClass("e-sswraptext")?(e.css({width:r.width(),maxWidth:""}),n(f.getRows(o)[1][r.parent().attr("data-idx")]).height(f.model.sheets[o].rowsHeightCollection[r.parent().attr("idx")]),f.XLScroll._getRowHeights(o,r.parent().index())):e.css({width:"",maxWidth:c.maxWidth});e.show();this._refreshEditForm(r,e,i.value,u,s);this._isEdit=!0;f.model.showRibbon&&f.XLRibbon._disableRibbonIcons()},_refreshEditForm:function(t,i,r,u){var h,e,c={},f=this.XLObj,l=document.getElementById(f._id+"EditForm"),a=n(l).find("input,select"),o=f._dataContainer.sheets[f.getActiveSheetIndex()],s=t.parent().index();o&&o[s]&&o[s][t[0].cellIndex]&&(c=o[s][t[0].cellIndex]);i[0].className="";e=this.getPropertyValueByElem(t,"type")||"";!f.isNumber(u)||e.indexOf("text")>-1||i.addClass("e-ralign");(e.indexOf("date")>-1||e.indexOf("time")>-1)&&i.addClass("e-ralign");i.css({border:"none",outline:"none"});this.XLObj.model.allowCellFormatting&&(h=f.XLFormat.getFormatClass(t[0].className));i.addClass(h);f.model.allowCellFormatting&&(i.css({color:t.css("color")}),i.css({"background-color":t.css("background-color")}));i.on("keyup",{xlObj:f},function(t){var i=t.data.xlObj;i.XLEdit._isFormulaEdit=!n(t.target).text().indexOf("=");i.XLEdit._isFormulaEdit&&i.XLEdit._processFormulaEditRange(n(t.target).text());i.model.allowFormulaBar&&i._getInputBox().val(n(t.target).text());i.XLEdit._isCellEdit=!0});i.on("focus",{xlObj:f},function(n){var t=n.data.xlObj;t.XLEdit._isCellEdit=!0});f._setFormulaSuggElem(n("#"+f._id+"_AutoComplete_suggestion"));i.focusEnd()},_renderAutoComplete:function(t,i,r,u){var f=this.XLObj,e=u?" e-cell-ac e-ss-editinput":"";t.ejAutocomplete({dataSource:f._formulaCollection,value:i,cssClass:"e-ss-autocomplete"+e,width:"100%",height:r,htmlattributes:u?{display:"none"}:"",delaySuggestionTimeout:10,minCharacter:2,popupWidth:"170px",popupHeight:"150px",showEmptyResultText:!1,autoFocus:!0,template:"<span class='e-icon e-ss-function'> <\/span><div> ${display} <\/div>",select:n.proxy(this._formulaSelect,f),open:n.proxy(this._formulaSuggestionStatus,f),close:n.proxy(this._formulaSuggestionStatus,f)});t.data("ejAutocomplete")._bubbleEvent(!0)},_refreshAutoComplete:function(){var t=this.XLObj,i,r,u="ejAutocomplete",f="dataSource";r=n("#"+t._id+"_inputbox").data(u);i=n("#"+t._id+"_AutoComplete").data(u);t.model.allowFormulaBar&&r&&r.option(f,t._formulaCollection);i&&i.option(f,t._formulaCollection)},_captureEditing:function(){var t=this.XLObj,i,f,e,r,u=document.activeElement,o=t.getActiveCell();u&&u.tagName==="DIV"&&t._isRowViewable(null,o.rowIndex)&&(i=t.element.find("#"+t._id+"_AutoComplete"),i.val(n(u).text()),i.data("ejAutocomplete").search(),f=t.getActiveCellElem(),e=t.element.find("#"+t._id+"_Edit")[0],r=f[0].getBoundingClientRect(),this._acPosition.left=r.left+window.pageXOffset,this._acPosition.top=r.top+window.pageYOffset+n(e).height(),n("#"+t._id+"_AutoComplete_suggestion").css({left:this._acPosition.left,top:this._acPosition.top}))},saveCell:function(){var t=this.XLObj,b,v,y,p,g,o,s,h,ft,nt,c,tt,it,rt,k,d,et,r,u,ot,e,f,l,st,a,i,ut,lt,ht,ct,w;if(t.model.allowEditing&&!t.model.isReadOnly&&(ut=!1,ht=["ABS","LEFT","RIGHT","TRIM","UPPER","VALUE"],this._isEdit)){if(f=t.getActiveSheetIndex(),l=t.getSheet(f),lt=t.getRows(f),p=n("#"+t._id+"EditForm"),tt=this._editCell,nt=l.columns[this._EditCellDetails.columnIndex],it=t.element.find("#"+t._id+"_ValElem"),ct=t.element.find("#"+t._id+"_Edit")[0],w=n(ct).html(),rt=t._getCellIdx(tt[0]),i=rt.rowIndex,r=rt.colIndex,u={columnName:nt.field,value:this.getCurrentEditCellData(),prevValue:this._EditCellDetails.value,columnObject:nt,rowIndex:i,colIndex:r,cell:tt,isRefCells:!1},t.model.allowDataValidation&&this._isValidation){if(it.val(u.value),p.css("display","block"),!p.validate().element(it[0]))return p.css("display","none"),!1;p.css("display","none");u.hasValidation=!0}if(u.value!==u.prevValue&&t._trigger("cellSave",u))return;if(h=t.getRangeData({range:[i,r,i,r],property:["type","formatStr","decimalPlaces"]})[0],t.isFormula(u.value)&&!this._formulaValidate(u.value))return;if(ot=this._EditCellDetails.value||"",e={sheetIndex:f,rowIndex:i,colIndex:r,cValue:u.value,reqType:"edit",iconName:"",pValue:ot},e.prevHeight=l.rowsHeightCollection[i],t._dupDetails=!0,this._updateCellValue({rowIndex:i,colIndex:r},u.value),t._dupDetails=!1,this.getPropertyValue(i,r,"wrap",f)&&(k=t._getWrapCellHeight(f,i,r),t._wrapCollection(i,r,k.cellHt,f),t._getRowHeight(i,f)<k.rowHt&&(t.setHeightToRows([{rowIndex:i,height:k.rowHt}]),t.model.allowAutoFill&&t.XLDragFill.positionAutoFillElement()),this._updateDataContainer({rowIndex:i,colIndex:r},{dataObj:{}})),t.XLEdit.getPropertyValue(i,r,"isFilterHeader")&&t._removeClass(u.cell[0],t._rAlign),this._textDecoration&&u.cell.find("a").css("text-decoration","none"),u.hasValidation&&(e.hasValidation=!0),t.isFormula(u.value)&&(!t.getObjectLength(h)||h.type==="general")&&(e.operation="formula",s=u.value,s=t.XLDragFill._parseFormula(s),ht.indexOf(s[0])===-1)){for(v=0,ft=s.length;v<ft;v++)if(o=s[v],o!="("&&s[v+1]!="(")break;o.indexOf(":")>-1&&(o=o.split(":")[0]);t._isCellReference(o)&&(o=o.replace(/\$/g,""),st=t.getRangeIndices(o),a=t.getRangeData({range:st,property:["type","formatStr","decimalPlaces"]})[0],t.getObjectLength(a)&&a.type!=h.type&&a.type!=="general"&&(t._dupDetails=!0,ut=!0,t.XLFormat.format(a,t._getAlphaRange(t.getActiveSheetIndex(),i,r,i,r)),t._dupDetails=!1,e.prevFrmtObj=t.getObjectLength(h)?h:{type:"general"},e.curFrmtObj=a))}if(t._setRowHdrHeight(f,i),t.model.allowFormulaBar&&t.updateFormulaBar(),t.model.scrollSettings.allowScrolling&&t.XLScroll._getRowHeights(f,i),this._isEdit=this._isFormulaEdit=!1,u.cell.removeClass("e-editedcell e-msie-edit"),t.model.allowKeyboardNavigation&&(t.XLCellNav._isNavigate=!0),t.model.showRibbon&&(t.XLRibbon._enableRibbonIcons(),t.XLRibbon._updateRibbonIcons()),t._updateUndoRedoIcons(),t.model.allowInsert||(t.XLRibbon._disableButtons(["Others_Cells_InsertCellOptions"],"ejSplitButton"),t.XLRibbon._disableButtons(["Others_Cells_InsertCell"],"ejButton")),t.model.allowDelete||(t.XLRibbon._disableButtons(["Others_Cells_DeleteCellOptions"],"ejSplitButton"),t.XLRibbon._disableButtons(["Others_Cells_DeleteCell"],"ejButton")),e.cFormatRule=d=this.getPropertyValue(i,r,"cFormatRule",f),t._dupDetails=!0,t.model.allowConditionalFormats&&d){for(b=0,et=d.length;b<et;b++)c=d[b].split("_"),c[0]!=="formularule"&&t.XLCFormat._cFormat(c[0],c[2],c[3],c[4],t._generateHeaderText(r+1)+(i+1));t.XLCFormat.refreshCFormat(t._getAlphaRange(f,i,r,i,r))}return t._dupDetails=!1,e.endCell=l._endCell,e.startCell=l._startCell,y=t.getActiveCellElem(),y&&(t.model.allowComments&&y.hasClass("e-commentcell")&&t.XLComment._visibleCmntCnt(y,!0),y.hasClass("e-hlcell")&&t.XLValidate.highlightInvalidData()),this._shiftKeyEnabled=this._isFBarFocused=!1,t._ctrlKeyCount=0,!this._isFormulaEdit&&t.model.allowSelection&&t.XLSelection._clearBorder(t._formulaBorder.join(" ").replace(/,/g," ")+" "+t._ctrlFormulaBorder.join(" ").replace(/,/g," ")),t.model.allowFormulaBar&&(g=n("#"+t._id+"_inputbox").data("ejAutocomplete"),g&&g.hide()),this._editElem.hide(),t.setSheetFocus(),t._browserDetails.name==="mozilla"&&(w=w.slice(0,-4)),w.indexOf("\n")>-1&&(e.altwrap=!0,this._updateDataContainer({rowIndex:i,colIndex:r},{dataObj:{altTxt:!0}})),this.getPropertyValue(i,r,"altTxt",f)&&(this.getPropertyValue(i,r,"wrap",f)||t.wrapText([i,r,i,r]),w.match(/\n/g)||this._clearDataContainer({cellIdx:{rowIndex:i,colIndex:r},property:["altTxt"]})),e.newHeight=l.rowsHeightCollection[i],t.XLScroll._getRowHeights(f,i),t.model.enableContextMenu&&n("#"+t._id+"_contextMenuCell").data("ejMenu")._contextMenuEvents("_on"),(u.value!==u.prevValue||ut)&&(t._completeAction(e),t._trigActionComplete(e)),!0}},_formulaValidate:function(n){for(var t,e,o,s,h,r,c,i=n,u=this.XLObj,l=u.model.customFormulas,a=["TODAY","NOW","TRUE","FALSE","ROW","COLUMN","SHEET","SHEETS"],f=0;f<l.length;f++)a.push(l[f].formulaName.toUpperCase());if(!this._isNamedRange(n)&&(s=i.length,e=i.split("(").length,o=i.split(")").length,h=u.getCalcEngine().getLibraryFunctions(),i.startsWith("=")&&s>1)){if(t=i=i.substring(1),e!==o){u._showAlertDlg("Alert","MissingParenthesisAlert","FormulaAlert",440);return}if(e===1&&o===1&&u.isUndefined(h.getItem(t.toUpperCase()))&&!this._isValidCell(i)&&!(t.substring(0,r)=="TRUE"||t.substring(0,r)=="FALSE")){u._showAlertDlg("Alert","CorrectFormula","FormulaAlert",372);return}do{if(r=t.indexOf("("),c=t.indexOf(")"),a.indexOf(t.substring(0,r).toUpperCase())<0&&r+1===c){u._showAlertDlg("Alert","CorrectArgument","FormulaAlert",372);return}t=t.substring(r+1);t.indexOf(",")>-1&&(t=t.substring(t.indexOf(",")+1))}while(t.indexOf("(")>-1)}return!0},_isValidCell:function(n){for(var u=this.XLObj,f,r,e,s=!0,h,t,o=["<=",">=","<",">","=","+","-","/","*","^","&"],i=0,c=o.length;i<c;i++){if(n.indexOf(o[i])>-1)for(r=n.split(o[i]),t=0,e=r.length;t<e;t++)if(r[t].length){if(e==t+1&&r[t].length)return!0}else return!1;if(n.indexOf("%")>-1&&n.split("%").length==2)return!0}return n=n.trim(),n=n.startsWith("=")?n.substring(1):n,n.indexOf("!")>-1&&(f=n.split("!"),n=f[1],u._getSheetIndexByName(f[0])<1&&(s=!1)),h=n.indexOf(":")>-1?u._isvalidRange(n):u._isvalidRange(n+":"+n),h&&s},updateValue:function(n,t,i,r){var u=this.XLObj,f,e;u.model.isReadOnly||(f=u.getRangeIndices(n),e={rowIndex:f[0],colIndex:f[1]},u._isPublic=!0,u.model.allowCellFormatting&&u.XLFormat._hasFormat(i)&&(u.XLFormat._createFormatClass(u.XLFormat.getFormatFromHashCode(i),i),u.XLFormat._updateFormatClass(e,i)),this._updateCellValue(e,t,i,r),u._isPublic=!1)},updateCellValue:function(n,t,i,r){var u=this.XLObj;u._isPublic=!0;u.model.allowCellFormatting&&u.XLFormat._hasFormat(i)&&(u.XLFormat._createFormatClass(u.XLFormat.getFormatFromHashCode(i),i),u.XLFormat._updateFormatClass(n,i));this._updateCellValue(n,t,i,r);u._isPublic=!1},_updateCellValue:function(n,t,i,r){var u=this.XLObj;if(n&&!u.model.isReadOnly){var f=n.colIndex,e=n.rowIndex,r=u._getSheetIndex(r),o=u.getActiveCell();u.isFormula(t)?(this._refreshCalcEngine(e,f,!0,t,r),this._updateDataContainer({rowIndex:e,colIndex:f},{dataObj:{value:t},sheetIdx:r}),u._isFormulaSuggestion=!1):t&&t[0]=="'"?this._updateDataContainer({rowIndex:e,colIndex:f},{dataObj:{value:t,value2:t.substr(1)},sheetIdx:r}):(this._updateCell({rowIndex:e,colIndex:f},t,r),this._refreshCalcEngine(e,f,!1,null,r));u._isPublic&&(u.model.allowDataValidation&&this.getPropertyValue(e,f,"isHighlight",r)&&u.XLValidate.highlightInvalidData(),u.model.allowConditionalFormats&&u.XLCFormat.refreshCFormat([e,f,e,f]),u.model.allowComments&&u.XLComment._updateCmntArrowPos(),o.rowIndex===e&&o.colIndex===f&&(u.model.showRibbon&&u.XLRibbon._updateRibbonIcons(),u.model.allowFormulaBar&&u.updateFormulaBar()))}},updateCell:function(n,t,i){var r=this.XLObj;r._isPublic=!0;this._updateCell(n,t,i);r._isPublic=!1},_updateCell:function(n,i,r){var u=this.XLObj;if(n&&!u.model.isReadOnly){r=u._getSheetIndex(r);var h,v=!0,c=u.getSheet(r),f=n.rowIndex,o=n.colIndex,l=t.Spreadsheet.CellType,a,y=this.getPropertyValue(f,o,"value2")||"",p=c.rowsHeightCollection[f],s=this._parseValue(i,n),e=u.getRangeData({range:[f,o,f,o],property:["formatStr","type","thousandSeparator","decimalPlaces","cellType"],sheetIdx:r})[0];u.model.isReadOnly||(e.type&&e.type!=l.General&&(s.type=e.type,delete s.formatStr),(e.formatStr||e.type===l.Scientific||e.type===l.Fraction)&&(s.value2=u.XLFormat._format(s.value,{formatStr:e.formatStr,type:e.type,thousandSeparator:e.thousandSeparator,decimalPlaces:e.decimalPlaces})),u.model.allowCellType&&!u.isUndefined(e.cellType)&&(v=u.XLCellType._rfrshCtrlText(e,s.value)),v&&this._updateDataContainer(n,{dataObj:s,sheetIdx:r}),u._isPublic&&!u._isScrolling&&(h=u._getWrapCellHeight(r,f,o),(this.getPropertyValue(f,o,"wrap")||h.cellHt>c.rowsHeightCollection[f])&&(u._isRowViewable(r,f)?u.setHeightToRows([{rowIndex:f,height:h.rowHt}]):(c.rowsHeightCollection[f]=h.rowHt,u.XLScroll._getRowHeights(r,f)),u._wrapCollection(f,o,h.cellHt,r))),a={sheetIndex:r?r:u.getActiveSheetIndex(),rowIndex:f,colIndex:o,reqType:"edit",cValue:i,pValue:y?y:"",prevHeight:p,newHeight:c.rowsHeightCollection[f]},u._isPublic&&!u._dupDetails&&(u._completeAction(a),u._trigActionComplete(a)))}},_parseValue:function(i,r){var p;r&&this.getPropertyValue(r.rowIndex,r.colIndex,"type")=="text"||(r&&this.getPropertyValue(r.rowIndex,r.colIndex,"type")==="percentage"&&this.getPropertyValue(r.rowIndex,r.colIndex,"value")!=i&&(i/=100),p=this.XLObj._getlocaleNumVal(i),i=this.XLObj.isNumber(i)?Number(i):t.isNullOrUndefined(i)?"":typeof i=="object"&&!this.XLObj._isDateTime(i)?JSON.stringify(i):i);var h,f,w,l,b,a,y,k,o,e=this.XLObj,c=e.model.locale,s=t.Spreadsheet.CellType,d=t.Spreadsheet.Align.Right,u=typeof i=="object"&&!this.XLObj._isDateTime(i)?JSON.stringify(i):i+"",v=s.General,g=u.indexOf(e._currencySymbol);if(p&&(i=p),(g===0||g>-1&&g===u.length-1)&&(f=t.parseFloat(u,10,c),f))return o=u.indexOf(e._decimalSeparator)>-1?e._decimalCnt(f):0,{type:s.Currency,value:f,value2:u,formatStr:e._getFormatString(s.Currency,o),decimalPlaces:o,align:d};if(u.indexOf(e._percentSymbol)>-1&&(f=n.trim(u).replace(e._percentSymbol,""),e.isNumber(f)))return o=u.indexOf(e._decimalSeparator)>-1?e._decimalCnt(f):0,{type:s.Percentage,value:Number(f)/100,value2:u,formatStr:e._getFormatString(s.Percentage,o),decimalPlaces:o,align:d};if(y=t.preferredCulture(c),w=y.numberFormat[","]||",",a=new RegExp("\\"+w+"\\d{3}"),u.indexOf(e._decimalSeparator)>-1&&a.test(u)&&(f=t.parseFloat(u,10,c),f))return o=u.substr(u.indexOf(e._decimalSeparator)+1).length,o>2&&(o=2),u=t.format(f,"N"+o,c),{type:s.Number,value:f,value2:u,formatStr:e._getFormatString(s.Number,o),decimalPlaces:o,thousandSeparator:!0};if(u.indexOf(w)>-1&&a.test(u)&&(f=t.parseInt(u,10,c),f))return o=0,u=t.format(f,"N"+o,c),{type:s.Number,value:f,value2:u,formatStr:e._getFormatString(s.Number,o),decimalPlaces:o,thousandSeparator:!0};l=y.calendar.patterns;b=!0;a=y.calendar._parseRegExp;for(h in l)if(a&&l[h]in a?f=new RegExp(a[l[h]].regExp).exec(u):(b=!1,f=t.parseDate(u,l[h],c)),f)break;return f&&(b&&(f=t.parseDate(u,l[h],c)),f)?(h==="T"||h==="t"||e.XLFormat._customFormatSpecifierType[h]===s.Time?(f.setYear(1990),f.setMonth(0),f.setDate(1),v=s.Time):v=h==="d"?s.ShortDate:h==="D"?s.LongDate:s.Date,k="{0:"+l[h]+"}",u=e.XLFormat._format(f,{type:v,formatStr:k}),{type:v,value:f,value2:u,formatStr:k,align:d}):((u.toLowerCase()==="true"||u.toLowerCase()==="false")&&(i=u=u.toUpperCase()),{type:v,value:i,value2:u})},updateCellWithContainer:function(n,i,r,u){var f=this.XLObj;if(!f.model.isReadOnly){for(var o,h,s,e,c,a=0,y=0,r=f._getSheetIndex(r),i=i?i:f.getSheet(r).selectedRange,l=f._getSelectedRange({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]}),v=l.length;a<v;)c=l[a],s=c.rowIndex,u&&f._isHiddenRow(s)||(h=c.colIndex,e=n[y],o=f.getCell(s,h,r),this._updateDataContainer(c,{dataObj:e}),this._refreshCalcEngine(s,h,f.isFormula(e.value),e.value),o&&e.format&&f.addClass(o[0],e.format),o&&e.hyperlink&&o.html(t.buildTag("a.e-hyperlinks",e.value2,"","cellAdr"in e.hyperlink?{href:"#"}:{href:e.hyperlink.webAdr,target:"_blank"})),e.comment&&f.XLComment.setComment([s,h,s,h],null,!1),e.border&&f.XLFormat.applyBorder(f.XLFormat.getBorderFromHashCode(e.border),f._getAlphaRange(r,s,h,s,h)),o&&(e.rule&&e.rule.isApply?f.addClass(o[0],"e-hlcell"):f._removeClass(o[0],"e-hlcell")),y++),a++;f.model.allowConditionalFormats&&f.XLCFormat.refreshCFormat(i)}},_refreshCellAlignment:function(n){n=n||{};var o,s,f=t.Spreadsheet.Align,i=this.XLObj,r=n.cellIdx.rowIndex,u=n.cellIdx.colIndex,e=this.getPropertyValue(r,u,"merge");f in n||(n.value=t.isNullOrUndefined(n.value)?this.getPropertyValue(r,u,"value"):n.value,i.isFormula(n.value)&&(n.value=i.XLEdit.getPropertyValue(r,u,"calcValue")),n.type=n.type?n.type:this.getPropertyValue(r,u,"type"),n.align=!i.isNumber(n.value)&&typeof n.value!="object"||n.type===t.Spreadsheet.CellType.Text||e&&e.isCenterAlign?i._isBool(n.value)||e&&e.isCenterAlign?f.Center:f.Left:f.Right);o=this.getPropertyValue(r,u,"align");i._isInitLoad&&!i.isImport&&(s=!0);(!n.align||o&&o!=n.align)&&i.clearRangeData([r,u,r,u],["align"],"","","",s);n.align&&this._updateDataContainer(n.cellIdx,{dataObj:{align:n.align},skipCell:s})},_editingHandler:function(i){var ot,it,r,e,u,o,b,c,s,h,rt,l,k,p,d,st,g,nt,a,ht,at,v,f,ut,ct,ft,w,tt,y,lt,et;if(!n(i.target).parents(".e-backstagecontent").length)if(r=this.XLObj,!(i.keyCode===61||!i.shiftKey&&i.keyCode===32||i.keyCode>=48&&i.keyCode<=59||i.keyCode>=65&&i.keyCode<=90||i.keyCode>=96&&i.keyCode<=111||i.keyCode===173||i.keyCode>=186&&i.keyCode<=192||i.keyCode>=219&&i.keyCode<=222)||i.ctrlKey||i.altKey)if(i.keyCode!==113||i.shiftKey||i.ctrlKey)if(i.keyCode===27&&this._isEdit)e=r.getActiveSheetIndex(),u=r.getSheet(e),s=u._activeCell.rowIndex,h=u._activeCell.colIndex,o=r.getCell(s,h),b=r._dataContainer.sheets[e],r.XLEdit.getPropertyValue(s,h,"wrap")&&r.XLEdit.getPropertyValue(s,h,"merge")&&(ct=r.getCell(s,h,e),ft=ct.find("#"+r._id+"_MergeWrap")[0]),c=s in b&&h in b[s]?b[s][h]:c,w=c?typeof c.value2=="string"?c.value2:r._dataContainer.sharedData[c.value]:"",r.isFormula(w)&&(w=this.getPropertyValue(s,h,"value2")),r.element.find("#"+r._id+"_Edit").hide(),it=r._isRowViewable(e,s),it&&(ft?ft.innerHTML=w:this._refreshTextNode(o[0],w),r.setSheetFocus(),r._setRowHdrHeight(e,u._selectedCells[0].rowIndex)),r.model.allowFormulaBar&&r.updateFormulaBar(),this._isFormulaEdit&&n("#"+r._id+"_AutoComplete").data("ejAutocomplete").suggestionList.hide(),this._isEdit=this._isFormulaEdit=this._isFBarFocused=!1,r._getContent(e).find("td").removeClass(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")),it&&(r.model.allowComments&&o.hasClass("e-commentcell")&&r.XLComment._visibleCmntCnt(o,!0),r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement(),o.removeClass("e-editedcell e-msie-edit")),r.model.showRibbon&&r.XLRibbon._enableRibbonIcons(),r._getContent(r.getActiveSheetIndex()).find(".e-error").remove(),t.isNullOrUndefined(r.XLCellNav)||(r.XLCellNav._isNavigate=!0);else if(i.keyCode===46)if(this._isEdit)r._ctrlKeyCount>0&&(r._ctrlKeyCount=0,r._formulaRange=[],r.XLSelection._clearBorder(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")));else{if(r._preventctrlkey){r._showAlertDlg("Alert","CtrlKeyErrorAlert","CtrlKeyErrorAction",450);return}if(e=r.getActiveSheetIndex(),u=r.getSheet(e),o=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),at=new RegExp("\\be-format.*?\\b","g"),v,f=u._selectedCells,ot=r.getRangeData({range:[f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex]}),r.model.allowLockCell&&u.isSheetProtected&&r._isPropExists([u.selectedRange],"isLocked",e))return;if(r._isPropExists([u.selectedRange],"isReadOnly",e))return;if(!this._isEdit){for(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),tt=r.model.sheets[e].tableManager,lt=r.getObjectKeys(tt),g=0,nt=r.getObjectLength(tt);g<nt;g++)if(y=tt[lt[g]].range,r.XLClipboard._compareRange([f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex],y)){ht=r._getAlphaRange(e,y[0],y[1],y[2],y[3]);r.clearAll(ht);return}for(r._hasClass(o,"e-readonly")||r.clearRangeData(null,["value2","value","hyperlink"]),rt=f[0].rowIndex,p=0,st=f.length;p<st;p++)if(l=f[p].rowIndex,k=f[p].colIndex,r._textClip(l,k,"delete"),!this.getPropertyValue(l,k,"isReadOnly")){if(r.model.allowFormulaBar&&r._getInputBox().val(""),v=this.getPropertyValue(l,k,"cFormatRule"),r.model.allowConditionalFormats&&v&&v.length)for(d=0,nt=v.length;d<nt;d++)a=v[d].split("_"),r.XLCFormat._cFormat(a[0],a[2],a[3],a[4],a[5]);rt!==l&&(r._setRowHdrHeight(e,l),rt++)}r.XLSelection._refreshBorder()}ut={sheetIndex:e,range:[f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex],bData:ot,reqType:"clear-content"};r._completeAction(ut);r._trigActionComplete(ut)}else i.ctrlKey||i.shiftKey||i.keyCode!==8?(i.keyCode!==13||i.altKey)&&i.keyCode!==9||!this._isEdit||!r.model.allowKeyboardNavigation||r.XLCellNav._isNavigate||this._isFormulaEdit?i.keyCode===13&&i.altKey&&this._isEdit&&(i.preventDefault(),et=r.element.find("#"+r._id+"_Edit"),et.focus(),et.altEnter()):(i.preventDefault(),t.isNullOrUndefined(r.XLCellNav)||(r.XLCellNav._isNavigate=!0)):(e=r.getActiveSheetIndex(),u=r.getSheet(e),o=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this._isEdit||r._hasClass(o,"e-readonly")||r._hasClass(o,"e-cellreadonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),o=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this.editCell(u._activeCell.rowIndex,u._activeCell.colIndex,!1),r._setRowHdrHeight(e,u._activeCell.rowIndex),r.model.allowFormulaBar&&r._getInputBox().val("")));else e=r.getActiveSheetIndex(),u=r.getSheet(e),o=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this._isFEdit=!0,this._isEdit||r._hasClass(o,"e-readonly")||r._hasClass(o,"e-cellreadonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),r.XLCellNav._navToCell(u._activeCell.rowIndex,u._activeCell.colIndex),this.editCell(u._activeCell.rowIndex,u._activeCell.colIndex,!0));else e=r.getActiveSheetIndex(),u=r.getSheet(e),o=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this._isEdit||r._hasClass(o,"e-readonly")||r._hasClass(o,"e-cellreadonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),r.XLCellNav._navToCell(u._activeCell.rowIndex,u._activeCell.colIndex),this.editCell(u._activeCell.rowIndex,u._activeCell.colIndex,!1))},_focusElements:function(t){n(t).not(":hidden").focus().setInputPos(n(t).text().length)},_updateUsedRange:function(n,t,i){var u=this.XLObj,r=u.getSheet(i?i:u.getActiveSheetIndex()).usedRange;r.rowIndex<n&&(r.rowIndex=n);r.colIndex<t&&(r.colIndex=t)},_updateDataContainer:function(i,r){var g,wt,k,l,w,nt,et,ot,st,o,f,s,c,tt,v,y,ht,ct,lt,at,bt,p,it,d,kt,dt,rt,b,vt,ut,yt,pt=!1,h=r.dataObj,u=this.XLObj,a=u._getSheetIndex(r.sheetIdx),ft=u.getSheet(a),gt,ni,e;if(!r.skipCell&&u._isRowViewable(a,i.rowIndex)&&(k=u.getCell(i.rowIndex,i.colIndex,a),l=k[0]),h){ot=t.Spreadsheet.CellType;st=t.Spreadsheet.Align;p=u._dataContainer;v=i.colIndex;y=i.rowIndex;c=u._cellProp;it=p.sheets[a];y in it?(d=it[y],v in d?o=d[v]:d[v]=o={}):(d=it[y]={},d[v]=o={});l&&(u._hasClass(l,"e-sswraptext")&&(u._removeClass(l,"e-sswraptext"),u.addClass(l,"e-sswraptext")),this.getPropertyValue(i.rowIndex,i.colIndex,"wrap",a)&&this.getPropertyValue(i.rowIndex,i.colIndex,"merge",a)&&(w=k.find("#"+u._id+"_MergeWrap")[0],w&&(b=w.lastChild,b?b.nodeType===1?(u._hasClass(b,"e-hyperlinks")&&(b.textContent=""),u._hasClass(b,"e-comment")&&(b.lastChild.textContent="")):b.textContent="":w.textContent="",nt=w.innerHTML,w.remove())));for(e in h){s=h[e];typeof s=="string"&&n.trim(s).length===0&&(s="");switch(e){case c[0]:case c[4]:case c[5]:case c[11]:f=p.sharedData.indexOf(s);f===-1&&(f=p.sharedData.push(s),f--);o[e]=f;ft._isLoaded&&e===c[0]&&!u._intrnlUpdate&&(pt=!0);break;case c[1]:if(rt=this.getPropertyValue(y,v,"value2",a),h.type&&h.type!=ot.General&&h.type!=ot.Text?o[e]=h.value2:(f=p.sharedData.indexOf(h.value2),f===-1&&(f=p.sharedData.push(h.value2),f--),o[e]=f),l&&!("cellType"in h)){if(bt=l.getElementsByTagName("a"),bt.length)this._refreshTextNode(l,h.value2);else if(o[c[24]]>-1){if(lt=p.sheetCellType[o[c[24]]],at=lt.id,n("#"+at).length===0)return;if(h.value2)switch(lt.type){case"Button":n("#"+at).ejButton("instance").option("text",h.value2)}}else ht=h.value2.toString().length>7&&!isNaN(new Date(h.value2).valueOf()),ct=["true","yes","false","no"].indexOf(h.value2.toString().toLowerCase())>-1,u.model.allowCellType&&u.model.allowAutoCellType&&(ht||ct)?ht?(u.XLCellType._rangeCellTypes([{settings:{type:"DatePicker"},range:u._getAlphaRange(a,y,v,y,v)}],a,!0),n("#"+u._dataContainer.sheetCellType[o[c[24]]].id).ejDatePicker("instance").option("value",h.value2)):ct&&(u.XLCellType._rangeCellTypes([{settings:{type:"CheckBox"},range:u._getAlphaRange(a,y,v,y,v)}],a,!0),n("#"+u._dataContainer.sheetCellType[o[c[24]]].id).ejCheckBox("instance").option("checked",["true","yes"].indexOf(h.value2.toString().toLowerCase())>-1?!0:!1)):this._skipHTML?l.innerHTML.concat(h.value2):this._refreshTextNode(l,h.value2);this._refreshCellAlignment({cellIdx:i,value:h.value,type:h.type})}u._isSort||(u.model.allowOverflow&&u._canOverflow?(rt||h.value2)&&(vt=t.isNullOrUndefined(rt)?!0:rt.length<=h.value2.length?!0:!1,u._textClip(y,v,vt?"add":"delete"),!vt&&h.value2.length>0&&u._textClip(y,v,"add")):u._canOverflow&&u.refreshOverflow([y,v,y,v],a));o.isDirty=!0;break;case c[2]:o[e]=p.cellType.indexOf(h.type);break;case c[3]:for(g=0,wt=s.length;g<wt;)f=p.cFormatData.indexOf(s[g]),f===-1&&(f=p.cFormatData.push(s[g]),f--),o[e]?o[e].indexOf(f)===-1&&o[e].push(f):o[e]=[f],g++;break;case c[6]:f=p.valData.indexOf(s.customVal);f===-1&&(f=p.valData.push(s.customVal),f--);o[e]=JSON.parse(JSON.stringify(s));o[e].customVal=f;break;case c[7]:case c[8]:l&&(kt=e===c[8]?"e-border":"e-format",dt=new RegExp("\\b"+kt+".*?\\b","g"),l.className=l.className.replace(dt,""),u.addClass(l,s));f=p.hashCode.indexOf(s);f===-1&&(f=p.hashCode.push(s),f--);o[e]=f;break;case c[9]:case c[10]:case c[26]:o[e]?o[e].indexOf(s)===-1&&o[e].push(s):o[e]=[s];break;case c[12]:o[e]=s;l&&(s===st.Center?u.addClass(l,u._cAlign):s===st.Right?u.addClass(l,u._rAlign):n(l).removeClass(u._rAlign+" "+u._cAlign));break;case c[14]:case c[16]:ut=u.XLFormat.getFormatHashCode(s);f=p.hashCode.indexOf(ut);f===-1&&(u.XLFormat._createFormatClass(s,ut),f=p.hashCode.push(ut),f--);o[e]=f;break;case c[15]:case c[17]:s=u.XLFormat._getBorderHashCode(s,!0);f=p.hashCode.indexOf(s);f===-1&&(f=p.hashCode.push(s),f--);o[e]=f;break;default:o[e]=s}}if(this._updateUsedRange(i.rowIndex,i.colIndex,a),pt&&(u.model.allowCharts&&u.XLChart._refreshChartElements(y,v,a),u.model.allowConditionalFormats&&u.XLCFormat._refreshCFormatFormula(y,v,a),u._updateBatchDetails(y,v,a),pt=!1),l&&this.getPropertyValue(i.rowIndex,i.colIndex,"wrap",a)&&this.getPropertyValue(i.rowIndex,i.colIndex,"merge",a)&&(gt=this.getPropertyValue(i.rowIndex,i.colIndex,"merge",a),ni=ft._rowHeightCollection[i.rowIndex+gt.mSpan.rowSpan]-ft._rowHeightCollection[i.rowIndex]||Math.floor(k.height()),u._isRowViewable(a,i.rowIndex)&&(et=this.getPropertyValue(i.rowIndex,i.colIndex,"value2",a),this._refreshTextNode(l),nt=nt?nt.concat(h.value2||et):h.value2||et,w=k.find("#"+u._id+"_MergeWrap")[0],w||(l.innerHTML="<div id ="+u._id+"_MergeWrap style = 'border :0px;overflow: hidden;max-height:"+(ni-1)+"px'>"+l.innerHTML.concat(nt||"")+"<\/div>",w=k.find("#"+u._id+"_MergeWrap")[0]),yt=w.children,yt.length)))for(e=0;e<yt.length;e++)u._hasClass(w.children[e],"e-comment")&&(w.children[e].lastChild.textContent=this.getPropertyValue(i.rowIndex,i.colIndex,"comment",a).value),u._hasClass(w.children[e],"e-hyperlinks")&&(w.lastChild.textContent="",w.children[e].textContent=this.getPropertyValue(i.rowIndex,i.colIndex,"value2",a));(Object.keys?Object.keys(o).length:u.getObjectLength(o))===3&&(tt=u.getRangeData({range:[y,v,y,v],property:c.slice(0,3)})[0],tt.value===""&&tt.value2===""&&tt.type===t.Spreadsheet.CellType.General&&u.clearRangeData([y,v,y,v],c.slice(0,3)));!ft._isLoaded||u.isDirty||u._intrnlReq||u.isImport||(u.isDirty=!0)}else l&&this._refreshTextNode(l)},_clearDataContainer:function(i){var p,u,w,s,a,g,v,b,k,o,nt=!1,e=this.XLObj,l=e._getSheetIndex(i.sheetIdx),h=e._cellProp,r=i.cellIdx.rowIndex,f=i.cellIdx.colIndex,d=i.property||[],tt=!1,it,y,rt=e._dataContainer,c=rt.sheets[l];if(d.length&&r in c&&f in c[r]){for(v=c[r][f],p=d.length,!i.skipCell&&e._isRowViewable(l,r)&&(u=e.getCell(r,f,l));p--;){o=null;k=!1;s=d[p];switch(s){case h[0]:o=this.getPropertyValue(r,f,s,l);e._updateBatchDetails(r,f,l);k=!0;break;case h[1]:g=this.getPropertyValue(r,f,"value2");u&&(this._refreshTextNode(u[0]),a=u.find("#"+e._id+"_MergeWrap"),a.length&&(a[0].innerHTML=""));g&&(nt=!0);break;case h[3]:o=this.getPropertyValue(r,f,s,l);o&&u&&n(u).removeClass("e-redft e-yellowft e-greenft e-redf e-redt");break;case h[7]:case h[8]:o=this.getPropertyValue(r,f,s,l);o&&u&&e._removeClass(u[0],o);break;case h[14]:o=this.getPropertyValue(r,f,s,l);o&&o["text-align"]&&o["text-align"]==="right"&&u&&e._removeClass(u[0],"e-rightalign");break;case h[12]:o=v[s];o&&u&&e._removeClass(u[0],o===t.Spreadsheet.Align.Center?e._cAlign:e._rAlign);break;case h[13]:if(o=v[s],o&&u){if(b=u[0].lastChild.textContent,i.status==="clear-content"){u[0].lastChild.textContent="";break}else if(i.status==="clear-format"){w=u.find("a");e._hasClass(w[0],"e-hyperlinks")&&w.css({color:"#444445","text-decoration":"none"}).removeClass("e-hyperlinks");break}u.find("a").remove();t.isNullOrUndefined(u[0].lastChild)?u[0].textContent=b:u[0].lastChild.textContent=b}break;case h[18]:o=v[s];o&&u&&(u.removeClass("e-filterhdr"),u.find(".e-filterspan").remove());break;case h[21]:e.XLComment&&e.XLComment.deleteComment([r,f,r,f]);break;case h[5]:case h[22]:case h[23]:tt||(o=this.getPropertyValue(r,f),y={decimalPlaces:0,thousandSeparator:!1,formatStr:"",type:"general",value:o},y.value2=it=e.XLFormat._getFormattedValue(r,f,y,o),e.XLEdit._updateDataContainer({rowIndex:r,colIndex:f},{dataObj:y}),tt=!0);break;case h[25]:delete c[r][f][s]}i.status==="clear-content"&&s==="hyperlink"?this.getPropertyValue(r,f,s,l)&&(delete c[r][f][s].webAddr,delete c[r][f][s].cellAddr):delete c[r][f][s];s==="wrap"&&u&&(a=u.find("#"+e._id+"_MergeWrap"),a.length&&(u[0].innerHTML=a[0].innerHTML,a.remove()));k&&(this._refreshCalcEngine(r,f,!1,o),e.model.allowCharts&&e.XLChart._refreshChartElements(r,f,l))}nt&&e._textClip(r,f,"delete");c[r]&&!e.getObjectLength(c[r][f])&&delete c[r][f];e.getObjectLength(c[r])||delete c[r]}},getPropertyValue:function(i,r,u,f){var e,o,s,l,y,p,h=this.XLObj,c=h._dataContainer,a=c.sheets,v=h._cellProp;if(f=h._getSheetIndex(f),h._intrnlUpdate||this._refreshContainer(i,f),a[f]&&a[f][i]&&a[f][i][r]&&(o=a[f][i][r],o)){u=u||"value";s=o[u];switch(u){case"value":case"range":case"thousandSeparator":case"calcValue":e=c.sharedData[s];break;case"format":case"border":e=c.hashCode[s];break;case"value2":p=t.Spreadsheet.CellType;e=!h.isUndefined(o.type)&&[p.General,p.Text].indexOf(c.cellType[o.type])===-1?o.value2:c.sharedData[o.value2];break;case"type":e=c.cellType[o.type];break;case"cFormatRule":for(l=y=0,e=[],h.isUndefined(s)||(y=s.length);l<y;)o[u][l]in c.cFormatData&&e.push(c.cFormatData[o[u][l]]),l++;break;case"rule":h.isUndefined(s)||(e={},n.extend(!0,e,s),e.customVal=c.valData[e.customVal]);break;case v[14]:case v[15]:case v[16]:case v[17]:h.isUndefined(s)||(e=c.hashCode[s],e=e.indexOf("e-format")===-1?h.XLFormat.getBorderFromHashCode(e,!0):h.XLFormat.getFormatFromHashCode(e));break;default:e=s}}return e},_refreshContainer:function(n,t){var r,i=this.XLObj,u=i.getSheet(t);!u._isImported&&u._hasDataSrc&&(i._intrnlUpdate=!0,i.model.scrollSettings.allowVirtualScrolling?(r=i._getBlockInfo(n,t,!0),u._virtualDataMngrLoadedBlks.indexOf(r.orgIdx)===-1&&(u._virtualDataMngrLoadedBlks.push(r.orgIdx),this._ensureDataMngr(r.orgRange,t)),u._virtualDataLoadedBlks.indexOf(r.orgIdx)===-1&&(u._virtualDataLoadedBlks.push(r.orgIdx),i._canOverflow=!1,i._refreshDataSrc(r.orgRange,t),i._refreshCellData(r.orgRange,t),i._canOverflow=!0,i._refreshOverflow(r.orgRange))):u._isLoaded||u._isDataMoved||(u._isDataMoved=!0,i._canOverflow=!1,i._refreshDataSrc(null,t),i._refreshCellData(null,t),i._canOverflow=!0,i._refreshOverflow()),i._intrnlUpdate=!1)},_ensureDataMngr:function(n,i){var s,e,o,u,r,l,h=0,a=this.XLObj,c=a.getDataSettings(i),v,f;if(c)for(v=c.length;h<v;)r=c[h],a._inRow(r.range,n[0])&&r._dataManager&&(u=this._getQueryPropWithValues(n.slice(0),r.range),f=t.pvt.filterQueries(r.query.queries,"onSkip"),o=u.skip||0,r._skip&&(o+=r._skip),o&&(f.length?f[0].e.nos=o:r.query.skip(o)),f=t.pvt.filterQueries(r.query.queries,"onTake"),u.take&&(f.length?f[0].e.nos=u.take:r.query.take(u.take)),r._dataManager.dataSource.async=!1,l=r._dataManager.executeQuery(r.query),l.done(function(n){if(s=n.result.length,s)for(e=0;e<s;)r._jsonData[u.skip+e]=n.result[e],e++}),r._dataManager.dataSource.async=!0),h++},_getQueryPropWithValues:function(n,t){var i,r={},u=this.XLObj;return i=n[0]-t[0],r.skip=i,t[2]<n[2]&&(n[2]=t[2]),u._inRow(t,n[2])&&(i=n[2]-n[0]+1,r.take=i),r},getPropertyValueByElem:function(n,i,r){if(!t.isNullOrUndefined(n[0])){var u;return u=n.hasClass("e-hyperlinks")?this.XLObj._getCellIdx(n.parent()[0]):this.XLObj._getCellIdx(n[0]),this.getPropertyValue(u.rowIndex,u.colIndex,i,r)}},_getPropWithCellIdx:function(n,t,i,r){for(var e,s=[],u=n[0],c=n[2],f,l=n[3],o=this.XLObj,i=o._getSheetIndex(i),h=o._dataContainer.sheets[i];u<=c;){if(h[u])for(f=n[1];f<=l;)h[u][f]&&(e=this.getPropertyValue(u,f,t,i),o.isUndefined(e)||(r?o.isFormula(e)&&s.push({rowIdx:u,colIdx:f,value:e}):s.push({rowIdx:u,colIdx:f,value:e}))),f++;u++}return s},_refreshCalcEngine:function(n,i,r,u,f){var w,c,e,s=this.XLObj,f=s._getSheetIndex(f),l=s.getSheet(f),o=s._calcEngine,b,a,v,y,p,h,k;if(r)u=this._parseSheetRef(u),w=new ValueChangedArgs(n+1,i+1,u),o.valueChanged(l.sheetInfo.value,w),s._applyFormula(f,n,i);else if(c=CalcEngine.getSheetFamilyItem(l.sheetInfo.value),e=RangeInfo.getAlphaLabel(i+1)+(n+1),o.isSheetMember()&&!t.isNullOrUndefined(c.parentObjectToToken)&&(e=c.parentObjectToToken.getItem(l.sheetInfo.value)+e),o.getFormulaInfoTable().containsKey(e)&&(o.getFormulaInfoTable().remove(e),o.getDependentCells().contains(e)&&o.clearFormulaDependentCells(e)),o.refresh(e),b=o.getDependentCells(),a=b.keys().indexOf(e),a>-1)for(p=o.getDependentCells().values()[a],h=0,k=p.length;h<k;h++)v=p[h].split("!"),y=s.getRangeIndices(v[2]),s.model.allowCharts&&s.XLChart._refreshChartElements(y[0],y[1],parseInt(v[1])+1)},_parseSheetRef:function(n,t){for(var u,h=new RegExp("[!@#$%^&()+=';,.{}|\":<>~_-]","g"),i=0,f=this.XLObj,c=f.model.sheetCount,e=[],s=[],r=f._getSheetNames(),o='(?=[\'!])(?=[^"]*(?:"[^"]*"[^"]*)*$)';i<r.length;)s.push(r[i].text),i++;for(i=0;i<c;i++)r[i].value!==r[i].text&&(u=new RegExp(r[i].text.replace(h,"\\$&")+o,"gi"),n.match(u)&&(n=n.replace(u,i+"/"),e.push(i)),s.indexOf(r[i].value)<0&&n.indexOf(r[i].value)>-1&&!t&&(u=new RegExp(r[i].value+o,"gi"),n.match(u)&&(n=n.replace(u,f._newSIndex+"/"),e.push(f._newSIndex))));for(i=0;i<e.length;)u=new RegExp(e[i]+"/"+o,"gi"),n=n.replace(u,e[i]===f._newSIndex?f._generateSheetName(f._newSIndex):r[e[i]].value),i++;return n},_refreshTextNode:function(n,i){var u=this.XLObj,r;i=t.isNullOrUndefined(i)?"":i;u.isUndefined(n)||(r=n.lastChild,r&&(r.nodeType===3||r.nodeType===1&&r.tagName==="A")?u._browserDetails.name==="msie"&&u._browserDetails.version==="8.0"?r.nodeValue=i:r.textContent=i:n.appendChild(document.createTextNode(i)))},_formulaSelect:function(n){var i,t=i=n.text;this.XLEdit._isNamedRange(i)||t.slice(1)=="TRUE"||t.slice(1)=="FALSE"||(t+="(");this.XLEdit._editElem.text(t);this.model.allowFormulaBar&&this._getInputBox().val(t);this.XLEdit._editElem.focusEnd();this._isFormulaSuggestion=!1;this.XLCellNav._canKeyBoardNavigate=!1},_isNamedRange:function(n){var i=this.XLObj.model.nameManager,t=i.length;if(n=n.slice(1),t)while(t--)if(i[t].name.toUpperCase()===n.toUpperCase())return!0;return!1},_formulaBoxInputChange:function(n){var r=this.getActiveSheetIndex(),t=this.getSheet(r)._activeCell,i=this.element.find("#"+this._id+"_Edit");this.XLEdit._isFormulaEdit=!n.target.value.indexOf("=");this.XLEdit._isFormulaEdit&&this.XLEdit._processFormulaEditRange(n.target.value,!0);this.XLEdit._isEdit||(this.XLCellNav._navToCell(t.rowIndex,t.colIndex),this.XLEdit.editCell(t.rowIndex,t.colIndex,!0),i=this.element.find("#"+this._id+"_Edit"));i.text(n.target.value);n.target.focus();this.XLEdit._isCellEdit=!1},_formulaSuggestionStatus:function(n){this._isFormulaSuggestion=n.type==="open"},_updateFormulaCellRange:function(n,t){var u,r=this.XLObj,f=r.element.find("#"+r._id+"_Edit").not(":hidden"),i=f.text(),e=i[i.length-1];t&&this._validCharacters.indexOf(e)===-1?i=i+",":(u=this._getCharPosition(i),u>-1&&(i=i.substr(0,[u+1])));n=i+n;f.text(n);this._editElem.focusEnd();r.model.allowFormulaBar&&r._getInputBox().val(n)},_getCharPosition:function(n){for(var t=n.length;t--;)if(this._validCharacters.indexOf(n[t])>-1)return t;return-1},_processFormulaEditRange:function(t,i){var u,e,f=0,r=this.XLObj,o=r.XLDragFill._parseFormula(t),s=o.length;for(r._ctrlKeyCount=0,r._formulaRange=[],r.XLSelection._clearBorder(r._arrayAsString(r._ctrlFormulaBorder.concat(r._formulaBorder)));f<s;){if(u=o[f],this._invalidOperators.indexOf(u)>-1)break;r._isCellReference(u)&&(u=u.replace(/\$/g,""),o[f+1]===":"&&(f++,r._isCellReference(o[f+1])&&(u=u+":"+o[f+1],f++)),this._updateFormulaEditRange(u,r._ctrlKeyCount),r._ctrlKeyCount++);f++}e=t.charAt(t.length-1);e==="("&&t.split("(").length===2?(r._isFormulaSuggestion=!1,r.model.allowFormulaBar&&r._getInputBox().val(t),i?n("#"+r._id+"_inputbox_suggestion").hide():r._getFormulaSuggElem().hide()):e===")"&&r.isFormula(t)&&(r.XLEdit._isFormulaEdit=!1,r._formulaRange=[],r._ctrlKeyCount=0);e===":"?(r._shiftKeyEnabled=!0,r._ctrlKeyCount--):this._validOperators.indexOf(e)>-1&&(r._dStartCell=r.getSheet(r.getActiveSheetIndex())._activeCell,r._shiftKeyEnabled=!1)},_updateFormulaEditRange:function(n,t){var i=this.XLObj,r=i.getRangeIndices(n);i._formulaRange[t]=n;i._dStartCell={rowIndex:r[0],colIndex:r[1]};i._dEndCell={rowIndex:r[2],colIndex:r[3]};i.XLSelection._focusBorder(i._dStartCell,i._dEndCell,i._formulaBorder[t%6])},calcOption:function(t){var i=this.XLObj,u,f,e,r,o;if(!i.model.isReadOnly){for(e=i.getActiveSheetIndex(),t?(n("#"+i._id+"_CalcAuto").find("span").addClass("e-ss-calcauto"),n("#"+i._id+"_CalcManual").find("span").removeClass("e-ss-calcauto")):(n("#"+i._id+"_CalcManual").find("span").addClass("e-ss-calcauto"),n("#"+i._id+"_CalcAuto").find("span").removeClass("e-ss-calcauto")),r=1,o=i._sheets.length;r<o;r++)u=i._calcEngine,t?(u.setCalculatingSuspended(!1),f=i.getSheet(r).usedRange,i.setActiveSheetIndex(r),u.grid=i.model.sheets[r].sheetInfo.value,u.refreshRange(RangeInfo.cells(1,1,f.rowIndex+1,f.colIndex+1))):u.setCalculatingSuspended(!0);i.setActiveSheetIndex(e)}},calcNow:function(n){var t=this.XLObj;if(!t.model.isReadOnly){var i=1,r,u,e=t._sheets.length,o=t.getActiveSheetIndex(),f;for(n&&(i=n,e=n+1);i<e;)r=t._calcEngine,r.setCalculatingSuspended(!1),u=t.getSheet(i).usedRange,t.setActiveSheetIndex(i),r.grid=t.model.sheets[i].sheetInfo.value,r.refreshRange(RangeInfo.cells(1,1,u.rowIndex+1,u.colIndex+1)),r.setCalculatingSuspended(!0),i++;t.setActiveSheetIndex(o);f={sheetIndex:o,reqType:"calc-now"};t._completeAction(f);t._trigActionComplete(f)}},_rangeHasProperty:function(n,t,i){n&&(i=this.XLObj.getRangeData({range:n,property:[t]}));for(var r=0,u=i.length;r<u;){if(!this.XLObj.isUndefined(i[r][t]))return!0;r++}},saveEditingValue:function(){var l=this.XLObj;if(!l.model.isReadOnly){var u,f,t,i,e,n,r,a,v,o,s={},h,y,p,w=l._dataContainer,c;for(e=Object.getOwnPropertyNames(w.sheets),s.EditedData=[],t=0,a=e.length;t<a;t++)for(i=w.sheets[e[t]],o=Object.getOwnPropertyNames(i),u=0,y=o.length;u<y;u++)for(n=parseInt(o[u]),h=Object.getOwnPropertyNames(i[n]),f=0,p=h.length;f<p;f++)r=parseInt(h[f]),i[n][r].isDirty&&(c=parseInt(e[t]),v={SheetIndex:c,Value:this.getPropertyValue(n,r,"value2",c),CellIndex:{RowIndex:n,ColIndex:r}},delete i[n][r].isDirty,s.EditedData.push(v));return s}}};n.fn.focusEnd=function(){var r;n(this).focus();var u=n("<span />").appendTo(n(this)),f=u.get(0),t=null,i=null;return document.selection?(t=document.body.createTextRange(),t.moveToElementText(f),t.select()):window.getSelection&&(r=this[0],t=document.createRange(),i=window.getSelection(),t.setStart(r,1),t.collapse(!0),i.removeAllRanges(),i.addRange(t),r.focus()),u.remove(),this};n.fn.altEnter=function(){var r,t,i,f,e,o,u;r=window.getSelection();t=r.anchorNode;i=t.nodeType===3?r.anchorOffset:t.textContent.length-1;f=t.textContent;e=f.slice(0,i);o=f.slice(i)||" ";t.textContent=e+"\n"+o;u=document.createRange();t.nodeType===3?(u.setStart(t,i+1),u.setEnd(t,i+1)):n(t).setInputPos(i);r.removeAllRanges();r.addRange(u)};n.fn.setCursorPosition=function(n){var u=this,t,i,r;u.focus();t=u[0].firstChild;i=document.createRange();t&&(i.setStart(t,n),i.setEnd(t,n));r=window.getSelection();r.removeAllRanges();r.addRange(i)}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.validation=function(n){this.XLObj=n;this._ruleSymbols={Greater:">",GreaterOrEqual:">=",Less:"<",LessOrEqual:"<=",Equal:"==",NotEqual:"!=",Between:">=&&<=&&=",NotBetween:">=&&<=&&!"};this._isErrorVisible=!1};t.spreadsheetFeatures.validation.prototype={_setValidation:function(){this.XLObj.model.allowDataValidation&&n.validator&&(this._initValidator(),this._setValidationToField())},_initValidator:function(){var i=n("#"+this.XLObj._id+"EditForm");t.isOnWebForms&&n.data(i[0],"validator",null);i.validate({errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(i,r){var u=n("#"+n(r).data("id")).data("ejSpreadsheet"),o=u._getJSSheetContent(u.getActiveSheetIndex()).find(".e-spreadsheetcontentcontainer > .e-content"),f=u.XLEdit._editCell,e=n(i).addClass("e-error");o.append(e);e.prepend(t.buildTag("div.e-errortail e-toparrow"));e.css({left:f[0].offsetLeft,top:f[0].offsetTop+f.height()});u.XLValidate._isErrorVisible=!0}})},_setValidationToField:function(){var n=this.XLObj,i=n.XLEdit.getPropertyValueByElem(n.getActiveCellElem(),"rule"),r;delete i.type;delete i.isApply;delete i.isHighlight;n.element.find("#"+n._id+"_ValElem").rules("add",i);r=n.element.find("#"+n._id+"EditForm").validate();t.isNullOrUndefined(i.required)||(r.settings.messages[name]={},r.settings.messages[name].required=n.XLEdit._EditCellDetails.fieldName+(n.XLEdit._EditCellDetails.rowIndex+1)+" is required");n.XLEdit._isValidation=!0},applyDVRules:function(n,i,r,u,f){var h,a,w,c={},e=this.XLObj,l=e.getActiveSheetIndex(),b=e.getSheet(l),k=!1,d,o,g,nt,tt,it,y,v,s,p;switch(r){case"decimal":if(parseFloat(i[1])>parseFloat(i[2])){e._showAlertDlg("Alert","NumberValidationAlert","",400);return}break;case"date":if(new Date(i[1])>new Date(i[2])){e._showAlertDlg("Alert","DateValidationAlert","",400);return}break;case"time":if(nt=Date.parse("01/01/1990 "+i[1]),tt=Date.parse("01/01/1990 "+i[2]),i[2]&&i[2].length&&nt>tt){e._showAlertDlg("Alert","TimeValidationAlert","",400);return}break;default:if(parseInt(i[1])>parseInt(i[2])){e._showAlertDlg("Alert","NumberValidationAlert","",400);return}}if(!e.model.isReadOnly&&e.model.allowDataValidation&&(e.model.allowSelection||!t.isNullOrUndefined(n))){d=e._getRangeArgs(n,"object");o=e._getSelectedCells(l,d).selCells;e._showDialog(e._id+"_Ribbon_Data_DataTools_DataValidation");c.required=!u;(i[0]!="Between"||i[0]!="NotBetween")&&i.length<3&&i.push("");switch(r){case"number":i.push("parseInt");c.digits=!0;i.push("number");break;case"decimal":i.push("parseFloat");c.number=!0;i.push("decimal");break;case"date":i.push("parseDate");c.date=!0;i.push("date");break;case"time":i.push("parseTime");i.push("time");break;case"text":i[1]="^"+i[1];i[2]="^"+i[2];i.push("length");i.push("text");break;case"list":it=i[1];i=[];i.push(it);i.push("list")}for(i.push(f),i.push(n?n:e._getSelectedItems(l,n)[1]),i.push(l),c.customVal=i.join("_"),c.isApply=!1,c.type=r,y=[],v={},s=0,p=o.length;s<p;s++)v={rowIndex:o[s].rowIndex,colIndex:o[s].colIndex,prevRule:e.XLEdit.getPropertyValue(o[s].rowIndex,o[s].colIndex,"rule")},e._isRowViewable(l,o[s].rowIndex)&&(a=e.getCell(o[s].rowIndex,o[s].colIndex),a.hasClass("e-hlcell")&&(k=!0),a.removeData("rule"),a.removeClass("e-hlcell")),e.XLEdit._updateDataContainer({rowIndex:o[s].rowIndex,colIndex:o[s].colIndex},{dataObj:{rule:c}}),e.model.actionComplete!==null&&(v.newRule=e.XLEdit.getPropertyValue(o[s].rowIndex,o[s].colIndex,"rule")),y.push(v);k===!0&&this.highlightInvalidData();b._isImported&&!b._isLoaded||e._isUndoRedo||e._isExport||(g=i[2]==""?[i[0],i[1]]:[i[0],i[1],i[2]],h={showErrorAlert:i[5],values:g,required:!c.required,rule:c,sheetIndex:l,reqType:"validation",operation:"apply-validation",selectedCell:y,range:e._getAlphaRange(l,o[0].rowIndex,o[0].colIndex,o[o.length-1].rowIndex,o[o.length-1].colIndex)},w={showErrorAlert:h.showErrorAlert,values:h.values,isRequired:h.required,rule:h.rule,sheetIndex:h.sheetIndex,reqType:h.reqType,operation:h.operation,selectedCell:h.selectedCell,range:h.range},e._completeAction(h),e._trigActionComplete(w))}},clearDV:function(n){var i=this.XLObj,o,r,s,e,f,u,h;if(i.model.allowDataValidation&&!i.model.isReadOnly&&i.model.allowSelection){for(e=i.getActiveSheetIndex(),f={sheetIndex:e,reqType:"validation",operation:"clear-validation",selectedCell:[]},s=i._getRangeArgs(n,"object"),r=i._getSelectedCells(e,s).selCells,u=0,h=r.length;u<h;u++)f.selectedCell.push({rowIndex:r[u].rowIndex,colIndex:r[u].colIndex,rules:i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"rule")}),i.clearRangeData([r[u].rowIndex,r[u].colIndex,r[u].rowIndex,r[u].colIndex],["rule"]),i._isRowViewable(e,r[u].rowIndex)&&(o=i.getCell(r[u].rowIndex,r[u].colIndex),t.isNullOrUndefined(i._ddlCell)||(i.element.find("#"+i._id+"ddl").ejDropDownList("hidePopup"),i.element.find("#"+i._id+"ddlspan").remove(),i._ddlCell=null),f.hlStatus=o.hasClass("e-hlcell"),o.removeClass("e-hlcell"));f.range=i._getAlphaRange(e,r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex);i._isUndoRedo||i._dupDetails||(i._completeAction(f),i._trigActionComplete(f))}},clearHighlightedValData:function(n){var r=this.XLObj,i,o,s,f,u,h,e;if(r.model.allowDataValidation&&!r.model.isReadOnly){for(f=r.getActiveSheetIndex(),o=r._getRangeArgs(n,"object"),i=r._getSelectedCells(f,o).selCells,u=0,h=i.length;u<h;u++)r._isRowViewable(f,i[u].rowIndex)&&(s=r.getCell(i[u].rowIndex,i[u].colIndex),s.removeClass("e-hlcell")),t.isNullOrUndefined(r.XLEdit.getPropertyValue(i[u].rowIndex,i[u].colIndex,"rule"))||(r._dataContainer.sheets[f][i[u].rowIndex][i[u].colIndex].rule.isApply=!1);r._isUndoRedo||(e={sheetIndex:f,reqType:"validation",operation:"cl-hl-data",range:t.isNullOrUndefined(n)?this.XLObj._getAlphaRange(1,i[0].rowIndex,i[0].colIndex,i[i.length-1].rowIndex,i[i.length-1].colIndex):n},r._completeAction(e),r._trigActionComplete(e))}},_checkValidation:function(n,i,r,u){var f=this.XLObj,v,c,e,l,a,o,s,h;if(u=f._getSheetIndex(u),!JSON.parse(i[i.length-3])&&!r)return!0;if(n=this._convertValueByType(n,i[4]),i[1]=this._convertValueByType(i[1],i[4]),i[2]=this._convertValueByType(i[2],i[4]),n.length){if(i[i.length-4]==="list"){for(a=!1,i[0].indexOf(",")>-1?c=i[0].split(","):i[0].indexOf("=")>-1?(e=i[0].split("=")[1],c=e.indexOf("!")>-1?e.split("!")[1].indexOf("$")>-1?f.getRangeData({sheetIdx:u,range:f.getRangeIndices(e.split("!")[1].split("$").join("")),valueOnly:!0}):e.indexOf("$")>-1?f.getRangeData({sheetIdx:u,range:f.getRangeIndices(e.split("$").join("")),valueOnly:!0}):f.getRangeData({sheetIdx:u,range:f.getRangeIndices(e.split("!")[1]),valueOnly:!0}):f.getRangeData({sheetIdx:u,range:f.getRangeIndices(e),valueOnly:!0})):c=n,l=0,v=c.length;l<v;l++)if(a=c[l].toString()===n,a)break;return t.Spreadsheet.msg=f._getLocStr("ListAlertMsg"),a}return i[0]=this._ruleSymbols[i[0]],i[1].indexOf("=")>-1&&(o=i[1].replace("=",""),s=this.getRangeIndices(o+":"+o),i[1]=f.XLEdit.getPropertyValue(s[0],s[1],null,u).toString()),i[2].indexOf("=")>-1&&(o=i[2].replace("=",""),s=this.getRangeIndices(o+":"+o),i[2]=f.XLEdit.getPropertyValue(s[0],s[1],null,u).toString()),i[0].length<=2?(t.Spreadsheet.msg="The "+i[4]+" should be "+t.Spreadsheet.ValidationText[i[0]]+" "+i[1].replace("^",""),f.operators[i[0]](f.parse[i[3]](n),f.parse[i[3]](i[1]))):(h=[],h=i[0].split("&&"),t.Spreadsheet.msg="The "+i[4]+" should"+t.Spreadsheet.ValidationText[h[2]]+" be between "+i[1].replace("^","")+" and "+i[2].replace("^",""),f.operators[h[2]](f.operators[h[0]](f.parse[i[3]](n),f.parse[i[3]](i[1]))&&f.operators[h[1]](f.parse[i[3]](n),f.parse[i[3]](i[2]))))}return!0},_convertValueByType:function(t,i){if(t.length){var r=this.XLObj;switch(i){case"number":case"decimal":r._isValidDate(t)&&(t=r._dateToInt(t));break;case"date":n.isNumeric(t)&&(t=r.intToDate(t).toString())}}return t},highlightInvalidData:function(n){var u=this.XLObj,l,a,r,h,s,i,o,f,e,c;if(u.model.allowDataValidation&&!u.model.isReadOnly){for(f=u.getActiveSheetIndex(),o=u._getRangeArgs(n,"object"),r=u._getSelectedCells(f,o).selCells,n=u._getAlphaRange(f,o[0],o[1],o[2],o[3]),i=0,l=r.length;i<l;i++)(e=u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"rule",f),e)&&(u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,null,f)&&!t.isNullOrUndefined(e)?(a=u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"type",f)==="datetime"||u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"type",f)==="time"?u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"value2",f).toString():u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,null,f).toString(),s=e?!this._checkValidation(a,e.customVal.split("_"),!0,f):!1,u._dataContainer.sheets[f][r[i].rowIndex][r[i].colIndex].rule.isApply=s):t.isNullOrUndefined(e)||(s=e.required),u._isRowViewable(f,r[i].rowIndex)&&(h=u.getCell(r[i].rowIndex,r[i].colIndex,f),s?h.addClass("e-hlcell"):h.removeClass("e-hlcell")),u.XLEdit._updateDataContainer({rowIndex:r[i].rowIndex,colIndex:r[i].colIndex},{dataObj:{isHighlight:!0},sheetIdx:f}));u._isUndoRedo||(c={sheetIndex:f,reqType:"validation",operation:"hl-data",range:n},u._completeAction(c),u._trigActionComplete(c))}},_replaceRule:function(n,t){this.XLObj._dataContainer.cFormatData[n]=t},_addDVMethod:function(){t.isNullOrUndefined(n.validator)||n.validator.addMethod("customVal",function(t,i,r){var u=n("#"+n(i).data("id")).data("ejSpreadsheet"),f=u._getJSSheetContent(u.getActiveSheetIndex()).find(".e-spreadsheetcontentcontainer > .e-content");return(f.find(".e-error").remove(),u.model.showRibbon&&n("#"+u._id+"_Ribbon_freetext").length&&!n("#"+u._id+"_Ribbon_freetext").data("ejCheckBox").isChecked())?!0:u.XLValidate._checkValidation(t,r.split("_"))},t.Spreadsheet.getMsg)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.dragFill=function(n){this.XLObj=n;this._customList=[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]];this._property=["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","format","rule"];this._fillInfo=null;this._verticalFill=!1;this._uniqueOBracket=String.fromCharCode(129);this._uniqueCBracket=String.fromCharCode(130);this._uniqueCSeparator=String.fromCharCode(131);this._uniqueCOperator=String.fromCharCode(132);this._uniquePOperator=String.fromCharCode(133);this._uniqueSOperator=String.fromCharCode(134);this._uniqueMOperator=String.fromCharCode(135);this._uniqueDOperator=String.fromCharCode(136);this._uniqueModOperator=String.fromCharCode(137);this._uniqueConcateOperator=String.fromCharCode(138)};t.spreadsheetFeatures.dragFill.prototype={positionAutoFillElement:function(n){var l,r,u,f,s,t,e=0,o=0,a=0,h=0,v=0,c=0,i=this.XLObj,y="e-hide";if(i.model.allowAutoFill&&i.model.allowSelection){if(s=i.getActiveSheetIndex(),t=i.getSheet(s),t._isRowSelected)a=-3,h=-1,v=5,c=4,r=t.selectedRange[2],u=t.selectedRange[1],o=i._isFrozen(t.frozenColumns)?i._getContent(s).find(".e-content").scrollLeft():t._scrollLeft;else if(t._isColSelected)h=-3,c=5,r=t.selectedRange[0],u=t.selectedRange[3],e=i._isFrozen(t.frozenRows)?i._getContent(s).find(".e-content").scrollTop():t._scrollTop;else{if(t._isSheetSelected){this.hideAutoFillElement();return}a=-3;h=-3;v=1;c=3;r=t.selectedRange[2];u=t.selectedRange[3]}l=i._getMergedIdx(r,u);r=l.rowIndex;u=l.colIndex;f=i._getCellInfo({rowIndex:r,colIndex:u});t._isColSelected||(e+=f.height);t._isRowSelected||(o+=f.width);e+=f.top;o+=f.left;i.getAutoFillElem()&&i.getAutoFillElem().removeClass(y).css({top:Math.round(e)+a,left:Math.round(o)+h});i.model.autoFillSettings.showFillOptions&&n&&i.model.allowEditing&&!i.model.isReadOnly&&i._getAutoFillOptElem().removeClass(y).css({top:e+v,left:o+c});t._autoFillCell=i._dautoFillCell={rowIndex:r,colIndex:u}}},hideAutoFillElement:function(){var n=this.XLObj.getAutoFillElem();n&&n.addClass("e-hide")},hideAutoFillOptions:function(){var n=this.XLObj._getAutoFillOptElem();n&&(n.find("button").data("ejSplitButton")._hidePopup(),n.addClass("e-hide"))},autoFill:function(i){var r=this.XLObj;if(i=i||{},r.model.allowAutoFill&&i.dataRange&&i.fillRange&&i.direction&&r.model.allowEditing&&!r.model.isReadOnly){var s,u,e=r.getActiveSheetIndex(),o=r.getSheet(e),f=t.Spreadsheet.AutoFillOptions;if(this._fillInfo=this._getFillInfo(i),i.fillType=i.fillType||this._fillInfo.fillType,this._verticalFill=i.direction==="down"||i.direction==="up",i.sheetIdx=e,i.dataRange=r._toIntrnlRange(i.dataRange,e),i.fillRange=r._toIntrnlRange(i.fillRange,e),s=n.extend(!0,{},o.rowsHeightCollection),u={sheetIndex:i.sheetIdx,bHeight:s,reqType:"auto-fill",direction:i.direction,range:i.fillRange,bRange:i.dataRange,bData:r.getRangeData({range:i.fillRange}),bFormat:r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(i.fillRange)},u.rowSel=o._isRowSelected,u.colSel=o._isColSelected,!r._trigger("autoFillBegin",i)){switch(i.fillType){case f.FillSeries:case f.FillWithoutFormatting:this._fillSeries(i);break;case f.CopyCells:case f.FillFormattingOnly:this._copyCells(i);break;case f.FlashFill:u.actionType="flash-fill";u.bdData=r.getRangeData({range:i.dataRange});this._flashFill(i);u.adData=r.getRangeData({range:i.dataRange})}u.aData=r.getRangeData({range:i.fillRange});u.aHeight=n.extend(!0,{},o.rowsHeightCollection);r.model.allowCellFormatting&&(u.aFormat=r.XLFormat.getHashCodeClassAsArray(i.fillRange));i.isKeyFill||this.positionAutoFillElement(!0);r._completeAction(u);r._trigActionComplete(u);r._trigger("autoFillComplete",i)}}},_updateFillValues:function(n,t,i,r,u,f,e,o,s,h){var c,l,a,v,y,p;return n?(c={rowIndex:t,colIndex:i+h},l={rowIndex:r,colIndex:i+h},a={rowIndex:f,colIndex:e+h},v={rowIndex:o,colIndex:e+h}):(c={rowIndex:t+h,colIndex:i},l={rowIndex:t+h,colIndex:u},a={rowIndex:f+h,colIndex:e},v={rowIndex:f+h,colIndex:s}),y=[c.rowIndex,c.colIndex,l.rowIndex,l.colIndex],p=[a.rowIndex,a.colIndex,v.rowIndex,v.colIndex],{patrnRange:y,fillRange:p}},_fillSeries:function(n){for(var u,ot,o,i,rt,k,h,v,s,st,c,d,g,ht,l,ut,y,ft,p,ct,f,e,et=0,w={},r=this.XLObj,nt=t.Spreadsheet.autoFillDirection,tt=t.Spreadsheet.CellType,lt=n.dataRange[0],at=n.dataRange[1],vt=n.dataRange[2],yt=n.dataRange[3],pt=n.fillRange[0],wt=n.fillRange[1],bt=n.fillRange[2],kt=n.fillRange[3],it=[nt.Down,nt.Up].indexOf(n.direction)>-1,b=[nt.Up,nt.Left].indexOf(n.direction)>-1,dt=it?yt-at:vt-lt,a=n.fillType===t.Spreadsheet.AutoFillOptions.FillSeries;et<=dt;){if(rt=this._updateFillValues(it,lt,at,vt,yt,pt,wt,bt,kt,et),k=rt.patrnRange,h=rt.fillRange,o=this._getPattern(k,{isRFill:b,isVFill:it}),v=r.getRangeData({range:k,property:["hyperlink","rule","cFormatRule","type","formatStr","decimalPlaces","wrap"]}),st=v.length,!o)return;for(ot=o.length,r.clearRangeData(h,[a?"formatStr":null,"hyperlink",a?"cFormatRule":null,"rule","format"]),a&&(r.model.allowCellFormatting&&r.XLFormat.removeStyle(h),y=r.getRangeData({range:k,property:["format","formats"]})),p=r._getSelectedRange({rowIndex:h[0],colIndex:h[1]},{rowIndex:h[2],colIndex:h[3]}),ct=p.length,b&&(p=p.reverse(),o=o.reverse(),o=this._ensurePattern(o),v=v.reverse(),a&&(y=y.reverse())),c=0;c<ct;){w={};f=p[c];i=o[c%ot];r.isNumber(i)&&(i=o[i]);switch(i.type){case tt.Number:u=r._round(i.regVal.a+i.regVal.b*i.i,5);b?i.i--:i.i++;break;case tt.String:u=i.val[i.i%i.val.length];i.i++;break;case tt.Formula:for(ut=!1,u="=",d=0,ht=i.val.length;d<ht;)s=i.val[d],r._isObject(s)?(ut=!0,l=r._round(s.a+s.b*i.i,0),u+=l<1?"#REF!":it?s.c+(s.b?l:"$"+l):(s.b?r._generateHeaderText(l):"$"+r._generateHeaderText(l))+s.c):u+=s,d++;ut&&b?i.i--:i.i++;break;case tt.Custom:u=r._round(i.regVal.a+i.regVal.b*i.i,0);u<0&&(u=u%i.len+i.len);u>=i.len&&(u=u%i.len);u=i.val[u];b?i.i--:i.i++}g=c%st;e=v[g];r._dupDetails=!0;r.XLEdit.updateCellValue(f,u,a?y[g].format:null);r._dupDetails=!1;a&&(r.model.allowCellFormatting&&e.type&&e.type!="general"&&this._updateNFormat(e,f.rowIndex,f.colIndex),r.model.allowConditionalFormats&&e.cFormatRule&&this._updateCFormat(f,e.cFormatRule),ft=y[g].formats,ft&&(w.formats=ft),r.model.allowHyperlink&&e.hyperlink&&this._updateHyperlinkTag(e.hyperlink,f));r.model.allowDataValidation&&e.rule&&(w.rule=e.rule);r.getObjectLength(w)&&r.XLEdit._updateDataContainer(f,{dataObj:w});r.model.allowWrap&&e.wrap&&r.setWrapText("wrap",[f.rowIndex,f.colIndex,f.rowIndex,f.colIndex]);c++}et++}},_copyCells:function(n){for(var e,s,p,r,k,l,d,h,a,v,g,w,u,f,o={},i=this.XLObj,vt=i.getActiveSheetIndex(),nt=0,b=t.Spreadsheet.autoFillDirection,it=n.dataRange[0],rt=n.dataRange[1],ut=n.dataRange[2],ft=n.dataRange[3],ot=n.fillRange[0],st=n.fillRange[1],ht=n.fillRange[2],ct=n.fillRange[3],et=[b.Down,b.Up].indexOf(n.direction)>-1,lt=[b.Up,b.Left].indexOf(n.direction)>-1,at=et?ft-rt:ut-it,tt=n.fillType===t.Spreadsheet.AutoFillOptions.FillFormattingOnly,c,y;nt<=at;){if(k=this._updateFillValues(et,it,rt,ut,ft,ot,st,ht,ct,nt),p=k.patrnRange,r=k.fillRange,i.model.allowCellFormatting)if(r[0]==r[2])for(c=[1];c<=[3];c++)i.XLEdit.getPropertyValue(r[0],c,"tformats")||i.XLEdit.getPropertyValue(r[0],c,"formats")||i.XLFormat.removeStyle([r[0],c,r[2],c]);else for(y=r[0];y<=r[2];y++)i.XLEdit.getPropertyValue(y,r[1],"tformats")||i.XLEdit.getPropertyValue(r[0],c,"formats")||i.XLFormat.removeStyle([y,r[1],y,r[3]]);if(tt?(i.clearRangeData(r,["format"]),l=i.getRangeData({range:p,property:["cFormatRule","type","decimalPlaces","formatStr"]})):(w=["value","value2","type","formatStr","format","decimalPlaces","thousandSeparator","hyperlink"],i.model.allowConditionalFormats&&w.push("cFormatRule"),i.model.allowDataValidation&&w.push("rule"),i.clearRangeData(r,w),l=i.getRangeData({range:p,property:["value","hyperlink","rule","cFormatRule","type","decimalPlaces","formatStr"]})),h=i.getRangeData({range:p,property:["format","formats"]}),d=h.length,v=i._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),g=v.length,e=0,lt&&(v=v.reverse(),h=h.reverse(),tt||(l=l.reverse())),tt)while(e<g)o={},s=e%d,f=v[e],u=l[s],i.model.allowCellFormatting&&(i.XLFormat._updateFormatClass(f,h[s].format),this._updateNFormat(u,f.rowIndex,f.colIndex)),a=h[s].formats,a&&(o.formats=a),i.getObjectLength(o)&&i.XLEdit._updateDataContainer(f,{dataObj:o}),i.model.allowConditionalFormats&&u.cFormatRule&&this._updateCFormat(f,u.cFormatRule),i.model.allowCellType&&i.XLCellType._rfrshCtrlText(f),e++;else while(e<g)o={},s=e%d,f=v[e],u=l[s],i._dupDetails=!0,i.XLEdit.updateCellValue(f,u.value,h[s].format),i._dupDetails=!1,i.model.allowCellFormatting&&u.type&&u.type!="general"&&this._updateNFormat(u,f.rowIndex,f.colIndex),i.model.allowHyperlink&&u.hyperlink&&this._updateHyperlinkTag(u.hyperlink,f),a=h[s].formats,a&&(o.formats=a),i.model.allowDataValidation&&u.rule&&(o.rule=u.rule),i.getObjectLength(o)&&i.XLEdit._updateDataContainer(f,{dataObj:o}),i.model.allowConditionalFormats&&u.cFormatRule&&this._updateCFormat(f,u.cFormatRule),e++;nt++}},_flashFill:function(n){var o,f,e,t=this.XLObj,s=n.dataRange[0],h=n.dataRange[2],i=n.fillRange[0],c=n.fillRange[1],r=n.fillRange[2],l=n.fillRange[3],u=this._getFlashFillPattern(n.dataRange,"left");if(u)for(f=t.getRangeData({range:[i,u.colIndex,r,u.colIndex],valueOnly:!0,skipDateTime:!0}),u.subStr>-1&&(f=this._splitString(f," ",u.subStr)),o=t._getSelectedRange({rowIndex:i,colIndex:c},{rowIndex:r,colIndex:l}),e=o.length;e--;)t.XLEdit._updateCellValue(o[e],f[e]);else i>s&&(i=s),r<h&&(r=h),t._getAutoFillOptElem().addClass("e-hide"),t.updateUniqueData({value:"",value2:"",type:"general"},[i,c,r,l]),t._showAlertDlg("Alert","FlashFillAlert")},_getFlashFillPattern:function(n,i){var u,f,c,y,e,l,r=0,o=-1,a=this.XLObj,s=a.getRangeData({range:n,valueOnly:!0,skipDateTime:!0}),p=s.length,v=n[0],w=t.Spreadsheet.autoFillDirection.Right,h=i===w;if(s.join().replace(/,/g,"").length){for(l=s[0].toString(),r=n[1],r===0&&(h=!0),h?r++:r--;r>-1;)if(f=a.XLEdit.getPropertyValue(v,r),f=a.isUndefined(f)?"":f.toString(),f.length){if(f===l)if(p>1){if(u=this._matchData(v,r,s),u)return u}else return{colIndex:r,subStr:o};for(c=f.split(" "),y=c.length,e=0;e<y;){if(l===c[e])if(o=e,p>1){if(u=this._matchData(v,r,s),u)return o>u.subStr&&(u.subStr=o),u}else return{colIndex:r,subStr:o};e++}h?r++:r--}else break;if(!h)return this._getFlashFillPattern(n,w)}},_matchData:function(n,i,r){for(var u,o=!1,s,f,h,l,e=1,c=-1,a=r.length;e<a;){if(o=!1,s=r[e].toString(),f=this.XLObj.XLEdit.getPropertyValue(n+e,i),f=t.isNullOrUndefined(f)?"":f.toString(),s===f){o=!0;e++;continue}for(h=f.split(" "),l=h.length,u=0;u<l;){if(s===h[u]){c<u&&(c=u);o=!0;break}u++}e++}if(o&&e===a)return{colIndex:i,subStr:c}},_splitString:function(n,t,i){for(var e,u,f=n.length,r;f--;){for(r=i,e=n[f].split(t);r>-1;){if(u=e[r],u)break;r--}n[f]=u}return n},_getPattern:function(n,i){var u,o,s,a,l,v,w,b,h,e,y=0,f=[],k=this.XLObj,c=t.Spreadsheet.CellType,p=this._getDataPattern(n),d=p.length,r;if(p){while(y<d){r=p[y];switch(r.type){case c.Number:for(o=f.length,e=r.val.length,h=i.isRFill?-1:e,e===1&&r.val.push(r.val[0]+1),a=this._getPredictionValue(r.val),s={regVal:a,type:r.type,i:h},f.push(s),u=1;u<e;)f.push(o),u++;break;case c.String:for(o=f.length,s={val:r.val,type:r.type,i:0},f.push(s),u=1,e=r.val.length;u<e;)f.push(o),u++;break;case c.Formula:if(e=r.val.length,r=this._getFormulaPattern(r.val,i),h=i.isRFill?-1:e,r.isInPattern)for(o=f.length,s={val:r.val,type:c.Formula,i:h},f.push(s),u=1;u<e;)f.push(o),u++;else for(u=0,h=i.isRFill?-1:1;u<e;)f.push({val:r.val[u],type:c.Formula,i:h}),u++;break;default:if(r.type.indexOf(c.Custom)>-1)for(o=f.length,e=r.val.length,h=i.isRFill?-1:e,l=this._customList[Number(r.type.replace(c.Custom,""))],b=l.indexOf(r.val[0])===-1,v=k.toArrayLowerCase(l.slice(0)),w=k.toArrayLowerCase(r.val),a=this._getCustomPredictionValue(w,v),s={val:b?v:l,regVal:a,i:h,type:c.Custom,len:l.length},f.push(s),u=1;u<e;)f.push(o),u++}y++}return f}},_getCustomPredictionValue:function(n,t){for(var r=0,i=[],u=n.length;r<u;)i.push(t.indexOf(n[r])),r++;return i.length===1&&i.push(i[0]+1),this._getPredictionValue(i)},_getDataPattern:function(n){var i,r,u=0,t={},f=[],e=this.XLObj.getRangeData({range:n,valueOnly:!0,skipDateTime:!0}),o=e.length;if(o){while(u<o)i=e[u],r=this._getType(i),u===0?t={val:[i],type:r}:r===t.type?t.val.push(i):(f.push(t),t={val:[i],type:r}),u++;return f.push(t),f}},_getFormulaPattern:function(n,t){for(var r,o,f,s,c=this.XLObj,e=[],i=0,h=n.length,u;i<h;)e.push(this._parseFormula(n[i])),i++;if(s=this._isInPattern(e,t.isVFill),s){for(r=e[0],i=r.length;i--;)f=r[i],u=c._isCellReference(f),u&&u!=="absolute"&&(r[i]=this._getCellRefPrediction(f,t,null,u));return{isInPattern:s,val:r}}for(i=0;i<h;){for(r=e[i],o=r.length;o--;)f=r[o],u=c._isCellReference(f),u&&u!=="absolute"&&(e[i][o]=this._getCellRefPrediction(f,t,h,u));i++}return{isInPattern:s,val:e}},_getCellRefPrediction:function(n,t,i,r){n=n.toUpperCase();var f="",s=new RegExp("[a-z$]","gi"),h=new RegExp("[0-9$]","g"),e=t.isVFill?n.replace(h,f):n.replace(s,f),u=t.isVFill?Number(n.replace(s,f)):this.XLObj._generateColCount(n.replace(h,f)),o=[u],c=n[0]==="$";return i&&i!==1?o.push(u+i):o.push(u+1),u=this._getPredictionValue(o),r&&r==="mixed"&&(c===t.isVFill?e="$"+e:u.b=0),u.c=e,u},_isInPattern:function(n,t){var o,i,s,a,r,u,h,c,f=this.XLObj,e="",v=0,l=1,y=n.length,p=new RegExp("[0-9$]","g"),w=new RegExp("[a-z$]","gi");if(y===1)return!1;while(l<y){if(o=n[v],s=n[l],i=o.length,a=s.length,i!==a)return!1;while(i--)if(r=o[i],u=s[i],f._isCellReference(r)===f._isCellReference(u)){if(t?(h=Number(r.replace(w,e)),c=Number(u.replace(w,e))):(h=f._generateColCount(r.replace(p,e)),c=f._generateColCount(u.replace(p,e))),h!==c-1)return!1}else if(r!==u)return!1;v++;l++}return!0},_parseFormula:function(n){var t,i,f,u=0,r=[];for(n=this._markSpecialChar(n.replace("=","")),n=n.split(/\(|\)|,|:|\+|-|\*|\/|%|&/g),f=n.length;u<f;){if(t=n[u],!t){u++;continue}t.length===1?r.push(this._isUniqueChar(t)?this._getUniqueCharVal(t):t):(i=t[0],t.indexOf("!")>0?(this._isUniqueChar(i)&&(r.push(this._getUniqueCharVal(i)),t=t.substr(1)),i=t.indexOf("!")+1,r.push(t.substr(0,i)),r.push(t.substr(i))):this._isUniqueChar(i)?(r.push(this._getUniqueCharVal(i)),r.push(t.substr(1))):r.push(t));u++}return r},_getUniqueCharVal:function(n){switch(n){case this._uniqueOBracket:return"(";case this._uniqueCBracket:return")";case this._uniqueCSeparator:return",";case this._uniqueCOperator:return":";case this._uniquePOperator:return"+";case this._uniqueSOperator:return"-";case this._uniqueMOperator:return"*";case this._uniqueDOperator:return"/";case this._uniqueModOperator:return"%";case this._uniqueConcateOperator:return"&"}return""},_isUniqueChar:function(n){var t=n.charCodeAt(n);return t>=129&&t<=138},_markSpecialChar:function(n){return n=n.replace(/\(/g,"("+this._uniqueOBracket).replace(/\)/g,")"+this._uniqueCBracket),n=n.replace(/,/g,","+this._uniqueCSeparator).replace(/:/g,":"+this._uniqueCOperator),n=n.replace(/\+/g,"+"+this._uniquePOperator).replace(/-/g,"-"+this._uniqueSOperator),n=n.replace(/\*/g,"*"+this._uniqueMOperator).replace(/\//g,"/"+this._uniqueDOperator),n=n.replace(/&/g,"&"+this._uniqueConcateOperator),n.replace(/%/g,"%"+this._uniqueModOperator)},_getPredictionValue:function(n){for(var t=0,i=0,u=0,f=0,r=0,e=n.length,o,s;t<e;)i=i+t,u=u+Number(n[t]),f=f+t*Number(n[t]),r=r+t*t,t++;return o=this.XLObj._round((u*r-i*f)/(e*r-i*i),5),s=this.XLObj._round((e*f-i*u)/(e*r-i*i),5),{a:o,b:s}},_getType:function(n){var i=this._isCustomType(n),r=t.Spreadsheet.CellType,u=this.XLObj;return i?i=i:u.isFormula(n)?i=r.Formula:u.isNumber(n)&&(i=r.Number),i||r.String},_isCustomType:function(n){n=n+"";n=n.toLowerCase();for(var i=this._customList.length;i--;)if(this.XLObj.toArrayLowerCase(this._customList[i].slice(0)).indexOf(n)>-1)return t.Spreadsheet.CellType.Custom+i;return!1},_ensurePattern:function(n){for(var i,u=-1,r=n.length;r--;)i=n[r],this.XLObj._isObject(i)?(u=r,i.type===t.Spreadsheet.CellType.String&&(i.val=i.val.reverse())):n[r]=u;return n},_selectAutoFillRange:function(n,t){n&&(t=this.XLObj._getCellIdx(n));var u,f,r=this.XLObj,i=this._getAutoFillRange(t);if(i){for(this._autoFillCleanUp(),f=r.getRange([i.startCell.rowIndex,i.startCell.colIndex,i.endCell.rowIndex,i.endCell.colIndex]),u=f.length;u--;)r.addClass(f[u],"e-autofillcell");r.XLSelection._focusRange(i.startCell,i.endCell,r._autofillBorder);r._dautoFillCell=t}},_getAutoFillRange:function(n){var o=t.Spreadsheet.autoFillDirection,a=this.XLObj,r=a.getSheet(a.getActiveSheetIndex()),y=r._startCell,p=r._endCell,s=r._autoFillCell,c=r.selectedRange,f=c[0],e=c[1],u=c[2],i=c[3],v=a.inRange(c,n.rowIndex,n.colIndex),h={rowIndex:f,colIndex:e},l={rowIndex:u,colIndex:i};if(n.rowIndex<s.rowIndex){if(r._isFreezed&&n.rowIndex<=r.frozenRows&&r._hiddenFreezeRows.indexOf(r.frozenRows)>-1&&(n.rowIndex=r._ftopRowIdx),f-n.rowIndex>n.colIndex-i&&f-n.rowIndex>e-n.colIndex)return v?{startCell:h,endCell:{rowIndex:n.rowIndex,colIndex:i}}:{startCell:l,endCell:{rowIndex:n.rowIndex,colIndex:e},fillRange:[n.rowIndex,e,f-1,i],direction:o.Up};if(n.colIndex>s.colIndex)return{startCell:h,endCell:{rowIndex:u,colIndex:n.colIndex},fillRange:[f,i+1,u,n.colIndex],direction:o.Right};if(n.colIndex<s.colIndex)return v?{startCell:h,endCell:l}:{startCell:l,endCell:{rowIndex:f,colIndex:n.colIndex},fillRange:[f,n.colIndex,u,e-1],direction:o.Left}}else{if(n.colIndex>s.colIndex)return n.rowIndex-u>n.colIndex-i?{startCell:h,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[u+1,e,n.rowIndex,i],direction:o.Down}:{startCell:h,endCell:{rowIndex:u,colIndex:n.colIndex},fillRange:[f,i+1,u,n.colIndex],direction:o.Right};if(n.colIndex<s.colIndex)return r._isFreezed&&n.colIndex<=r.frozenColumns&&r._hiddenFreezeCols.indexOf(r.frozenColumns)>-1&&(n.colIndex=r._fleftColIdx),n.rowIndex-u>i-n.colIndex||n.rowIndex-f>i-n.colIndex&&n.rowIndex!==u?{startCell:h,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[u+1,e,n.rowIndex,i],direction:o.Down}:v?{startCell:h,endCell:l}:{startCell:l,endCell:{rowIndex:f,colIndex:n.colIndex},fillRange:[f,n.colIndex,u,e-1],direction:o.Left};if(n.rowIndex>s.rowIndex)return{startCell:h,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[u+1,e,n.rowIndex,i],direction:o.Down};if(n.rowIndex===s.rowIndex&&n.colIndex===s.colIndex)return{startCell:y,endCell:p}}},_getDirection:function(n,i,r){var u=t.Spreadsheet.autoFillDirection;if(r=this.XLObj.isUndefined(r)?this._verticalFill:r,r){if(i.rowIndex<n.rowIndex)return u.Up;if(i.rowIndex>n.rowIndex)return u.Down;if(i.colIndex>n.colIndex)return u.Right;if(i.colIndex<n.colIndex)return u.Left}else{if(i.colIndex>n.colIndex)return u.Right;if(i.colIndex<n.colIndex)return u.Left;if(i.rowIndex<n.rowIndex)return u.Up;if(i.rowIndex>n.rowIndex)return u.Down}return null},_getFillRange:function(n,i,r,u){var f=t.Spreadsheet.autoFillDirection;switch(u){case f.Up:return[r.rowIndex,n.colIndex,n.rowIndex-1,i.colIndex];case f.Right:return[n.rowIndex,i.colIndex+1,i.rowIndex,r.colIndex];case f.Down:return[i.rowIndex+1,n.colIndex,r.rowIndex,i.colIndex];case f.Left:return[n.rowIndex,r.colIndex,i.rowIndex,n.colIndex-1]}return null},_autoFillOptionClick:function(t){var r,i,u,f,e,o,s,h=n("#"+t.model.targetID).find("#"+t.ID).find(">>");this._hasClass(h[0],"e-ss-fillselect")||(r=this.XLDragFill,i=this.getSheet(this.getActiveSheetIndex()),u=r._getDirection(this._pEndCell,this._pFillCell),f=this.swapRange([this._pStartCell.rowIndex,this._pStartCell.colIndex,this._pEndCell.rowIndex,this._pEndCell.colIndex]),e=r._getFillRange(this._pStartCell,this._pEndCell,this._pFillCell,u),o=i._startCell,s=i._endCell,this._isUndo=!0,this._performUndoRedo(),i._isColSelected||i._isRowSelected||(i._startCell=o,i._endCell=s,this.XLSelection.selectRange(i._startCell,i._endCell)),r.positionAutoFillElement(!0),r.autoFill({dataRange:f,fillRange:e,direction:u,fillType:t.ID}),r._fillInfo.fillType=t.ID,this._isUndo=!1)},_autoFillCleanUp:function(){var i,n,r,u,f="e-hide",t=this.XLObj,e=t.getAutoFillElem(),o=t._getAutoFillOptElem();for(e&&t.addClass(e[0],f),o&&t.addClass(o[0],f),r=t._getContent(t.getActiveSheetIndex())[0].querySelectorAll("td.e-autofillcell"),i=r.length;i--;)u=r[i],n=u.className,n=n.replace(/e-autofillcell|e-blur/g,""),n=n.replace(/ +/g," "),u.className=n},_autoFillClick:function(){var f,r=0,u="e-ss-fillselect",i=n("#"+this._id+"_ctxtmenu").find("li"),t=i.find("."+u);for(t.length&&(t=t[0],this._removeClass(t,u),this.addClass(t,"e-ss-filloption")),i.show(),f=this.XLDragFill._fillInfo.disableItems.length;r<f;)n(i[this.XLDragFill._fillInfo.disableItems[r]]).hide(),r++;i.filter("#"+this.XLDragFill._fillInfo.fillType).find("span").addClass(u)},_fillRange:function(n,i){var c,v,l,r,u,o,s,f={isKeyFill:!0},e=this.XLObj,a=e.getActiveSheetIndex(),y=e.getSheet(a),h=t.Spreadsheet.autoFillDirection;if(i=i?i:y.selectedRange,r=i[0],u=i[1],o=i[2],s=i[3],c=this._getDirection({rowIndex:r,colIndex:u},{rowIndex:o,colIndex:s},n),v=n?c===h.Down:c===h.Right,e.isRange(i)&&v)n?(f.dataRange=[r,u,r,s],f.fillRange=[r+1,u,o,s]):(f.dataRange=[r,u,o,u],f.fillRange=[r,u+1,o,s]);else{if(n){if(!r)return;f.dataRange=[r-1,u,r-1,s]}else{if(!u)return;f.dataRange=[r,u-1,o,u-1]}f.fillRange=i}(f.direction=n?h.Down:h.Right,f.fillType=t.Spreadsheet.AutoFillOptions.CopyCells,l=e.swapRange(f.fillRange),e.model.allowLockCell&&y.isSheetProtected&&e._isPropExists([l],"isLocked",a))||e._isPropExists([l],"isReadOnly",a)||this.autoFill(f)},_getFillInfo:function(n){var e,i,o=!0,u=t.Spreadsheet.AutoFillOptions.CopyCells,s=[],r=this.XLObj,h=t.Spreadsheet.autoFillDirection,c=[h.Down,h.Up].indexOf(n.direction)>-1,f=r.getRangeData({range:n.dataRange,valueOnly:!0,skipDateTime:!0}),l=f.join().replace(/,/g,"").length;if(r.isRange(n.dataRange)&&l){for(e=f.length;e--;)if(i=f[e],r.isNumber(i)||r.isFormula(i)||this._isCustomType(i)){o=!1;u=r.model.autoFillSettings.fillType;break}}else i=f[0],(r.isNumber(i)||r.isFormula(i)||this._isCustomType(i))&&(o=!1,u=r.model.autoFillSettings.fillType);return(!l||o)&&(s.push(1),u=n.fillType=="fillseries"?u:n.fillType),(!c||c&&n.dataRange[1]!==n.dataRange[3])&&s.push(4),{fillType:u,disableItems:s}},_updateHyperlinkTag:function(i,r){var f,u=this.XLObj,e=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2");u._isRowViewable(u.getActiveSheetIndex(),r.rowIndex)&&(f=u.getCell(r.rowIndex,r.colIndex),f[0].lastChild.nodeType===3&&n(f[0].lastChild).remove(),f.append(t.buildTag("a.e-hyperlinks",e,"",i.webAddr?{href:i.webAddr,target:"_blank"}:{href:"#"})));u.XLEdit._updateDataContainer(r,{dataObj:{hyperlink:i}})},_updateCFormat:function(n,t){var i,r=0,u=this.XLObj,f=t.length;for(u._dupDetails=!0;r<f;)i=t[r].split("_"),u.XLCFormat._cFormat(i[0],i[2],i[3],i[4],null,null,[n.rowIndex,n.colIndex,n.rowIndex,n.colIndex]),r++;u._dupDetails=!1},_updateNFormat:function(n,t,i){var u={type:n.type},r=this.XLObj;n.type!="general"&&(n.formatStr&&(u.formatStr=n.formatStr),"decimalPlaces"in n&&(u.decimalPlaces=n.decimalPlaces));r._dupDetails=!0;r.XLFormat.format(u,r._getAlphaRange(r.getActiveSheetIndex(),t,i,t,i));r._dupDetails=!1}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellNavigation=function(n){this.XLObj=n;this._canKeyBoardNavigate=!0;this._isNavigate=!0};t.spreadsheetFeatures.cellNavigation.prototype={_selectionKeyDownHandler:function(n){var a,p,e,w,v,g,ut,rt,ft=!1,d=[],t=this.XLObj,b=t.getActiveSheetIndex(),i=t.getSheet(b),f=n.keyCode,k=n.shiftKey,nt=n.ctrlKey,o={keyCode:f,shiftKey:k,ctrlKey:nt,altKey:n.altKey},tt=!1,r=i._activeCell,l=i._endCell,s=i.rowCount,c=i.colCount,it=t._dataContainer,y,u,h=i.usedRange;if((f===9&&this._canKeyBoardNavigate||f===13)&&!nt){if(n.preventDefault(),a=t.XLEdit.getCurrentEditCellData(),t.isFormula(a)&&!t.XLEdit._formulaValidate(a))return;if(t.XLEdit._isFormulaEdit&&!t._isFormulaSuggestion)if(a.length>1)if(this._isValidParameter(a))t.isFormula(a)||(a=a+")",t.XLEdit._editElem.text(a),t.model.allowFormulaBar&&t._getInputBox().val(a)),t.XLEdit.saveCell(),t._getContent(b).find("td").removeClass(t._formulaBorder.join(" ").replace(/,/g," ")+" "+t._ctrlFormulaBorder.join(" ").replace(/,/g," ")),t.XLSelection._cleanUp(),t.XLSelection.selectRange(i._activeCell,i._activeCell),t.XLEdit._isFormulaEdit=!1,t._formulaRange=[],t._ctrlKeyCount=0;else{t._showAlertDlg("Alert","MissingParenthesisAlert","FormulaAlert",440);return}else t.XLEdit.saveCell(),t.XLEdit._isFormulaEdit=!1;else f===9&&t.XLEdit._isEdit&&t.XLEdit.saveCell();p=i.selectedRange;rt=i._isRowSelected||i._isColSelected;rt?p[0]===p[2]||p[1]===p[3]?d.push({rowIndex:p[0],colIndex:p[1]}):d=i._selectedCells:d=i._selectedCells;d.length&&(d.length===1||!rt&&this._isRangeMerged(d)?i._isRowSelected?k?r.colIndex>0&&this._navigateRow("Backward",o):r.colIndex<39&&this._navigateRow("Forward",o):i._isColSelected?k?r.rowIndex>0&&this._navigateCol("Backward",o):r.rowIndex<39&&this._navigateCol("Forward",o):k?f===9&&r.colIndex>0?this._navigateCell(r.rowIndex,r.colIndex-1,o):f===13&&r.rowIndex>0&&this._navigateCell(r.rowIndex-1,r.colIndex,o):f===9&&r.colIndex<c?this._navigateCell(r.rowIndex,r.colIndex+1,o):f===13&&r.rowIndex<s&&this._navigateCell(r.rowIndex+1,r.colIndex,o):k?f===9?this._navigateRange("ShiftTab",o):this._navigateRange("ShiftEnter",o):f===9?this._navigateRange("Tab",o):this._navigateRange("Enter",o))}else if((f===37||f===38&&!t._isFormulaSuggestion||f===39||f===40&&!t._isFormulaSuggestion)&&this._isNavigate)if(n.preventDefault(),t.XLEdit._isFormulaEdit)v=t.swapRange([t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex]),t.getRange([v[0]?v[0]-1:v[0],v[1]?v[1]-1:v[1],v[2],v[3]]).removeClass(t._formulaBorder[t._ctrlKeyCount%6].join(" ")+" "+t._ctrlFormulaBorder[t._ctrlKeyCount%6].join(" ")),nt&&(e=t._dStartCell,f===37&&e.colIndex>0?t._dStartCell=t._dEndCell={rowIndex:e.rowIndex,colIndex:0}:f===38&&e.rowIndex>0?t._dStartCell=t._dEndCell={rowIndex:0,colIndex:e.colIndex}:f===39&&e.colIndex<i.colCount?t._dStartCell=t._dEndCell={rowIndex:e.rowIndex,colIndex:i.colCount}:f===40&&e.rowIndex<s&&(t._dStartCell=t._dEndCell={rowIndex:i.colCount,colIndex:e.colIndex})),k||t._shiftKeyEnabled?(w=t._dEndCell,e=t._dStartCell,f===37&&e.colIndex>0?t._dStartCell={rowIndex:e.rowIndex,colIndex:e.colIndex-1}:f===38&&e.rowIndex>0?t._dStartCell={rowIndex:e.rowIndex-1,colIndex:e.colIndex}:f===39&&w.colIndex<i.colCount?t._dEndCell={rowIndex:w.rowIndex,colIndex:w.colIndex+1}:f===40&&w.rowIndex<i.rowCount&&(t._dEndCell={rowIndex:w.rowIndex+1,colIndex:w.colIndex})):(e=t._dStartCell,f===37&&e.colIndex>0?t._dStartCell=t._dEndCell={rowIndex:e.rowIndex,colIndex:e.colIndex-1}:f===38&&e.rowIndex>0?t._dStartCell=t._dEndCell={rowIndex:e.rowIndex-1,colIndex:e.colIndex}:f===39&&e.colIndex<i.colCount?t._dStartCell=t._dEndCell={rowIndex:e.rowIndex,colIndex:e.colIndex+1}:f===40&&e.rowIndex<i.rowCount&&(t._dStartCell=t._dEndCell={rowIndex:e.rowIndex+1,colIndex:e.colIndex})),t.XLSelection._processFormulaRange(t._ctrlFormulaBorder),t._formulaRange[t._ctrlKeyCount]=t._getProperAlphaRange(b,t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex);else if(nt){if(f===37&&r.colIndex>0){if(y=it.sheets[b][r.rowIndex],u=r.colIndex-1,y&&u<h.colIndex)if(t.XLEdit.getPropertyValue(r.rowIndex,u+1,"value2")&&t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")){while(t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")&&u<=h.colIndex)u--;c=u+1}else{while(!t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")&&u<h.colIndex&&u>0)u--;c=u}else if(t.XLEdit.getPropertyValue(r.rowIndex,h.colIndex,"value2"))c=h.colIndex;else{for(u=h.colIndex;u>0&&!t.XLEdit.getPropertyValue(r.rowIndex,u,"value2");)u--;c=u}this._navigateCell(r.rowIndex,c,o)}else if(f===38&&r.rowIndex>0){if(y=it.sheets[b],u=r.rowIndex-1,u<=h.rowIndex)if(y[u]&&t.XLEdit.getPropertyValue(u+1,r.colIndex,"value2")&&t.XLEdit.getPropertyValue(u,r.colIndex,"value2")){while(t.XLEdit.getPropertyValue(u,r.colIndex,"value2")&&u<=h.rowIndex)u--;s=u+1}else{while(!t.XLEdit.getPropertyValue(u,r.colIndex,"value2")&&u>0)u--;s=u}else if(t.XLEdit.getPropertyValue(h.rowIndex,r.colIndex,"value2"))s=h.rowIndex;else{for(u=h.rowIndex;u>0&&!t.XLEdit.getPropertyValue(u,r.colIndex,"value2");)u--;s=u}this._navigateCell(s,r.colIndex,o)}else if(f===39&&r.colIndex<c-1){if(y=it.sheets[b][r.rowIndex],u=r.colIndex+1,y&&u<=h.colIndex)if(t.XLEdit.getPropertyValue(r.rowIndex,u-1,"value2")&&t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")){while(t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")&&u<=h.colIndex)u++;c=u-1}else{while(!t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")&&u<h.colIndex)u++;c=t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")?u:i.colCount}else c=i.colCount;c===i.colCount&&--c;this._navigateCell(r.rowIndex,c,o)}else if(f===40&&r.rowIndex<s-1){if(y=it.sheets[b],u=r.rowIndex+1,u<h.rowIndex)if(y[u]&&t.XLEdit.getPropertyValue(u-1,r.colIndex,"value2")&&t.XLEdit.getPropertyValue(u,r.colIndex,"value2")){while(t.XLEdit.getPropertyValue(u,r.colIndex,"value2")&&u<=h.rowIndex)u++;s=u-1}else{while(!t.XLEdit.getPropertyValue(u,r.colIndex,"value2")&&u<i.rowCount)u++;s=u}else s=i.rowCount-1;s===i.rowCount&&--s;this._navigateCell(s,r.colIndex,o)}}else if(k){if(f===37&&l.colIndex>0?i._endCell={rowIndex:l.rowIndex,colIndex:l.colIndex-1}:f===38&&l.rowIndex>0?(tt=!0,i._endCell={rowIndex:l.rowIndex-1,colIndex:l.colIndex}):f===39&&l.colIndex<c?i._endCell={rowIndex:l.rowIndex,colIndex:l.colIndex+1}:f===40&&l.rowIndex<s&&(tt=!0,i._endCell={rowIndex:l.rowIndex+1,colIndex:l.colIndex}),(i.rowCount===i._endCell.rowIndex||i.colCount===i._endCell.colIndex)&&t.model.scrollSettings.scrollMode==="normal")return;if((i.rowCount===i._endCell.rowIndex||i.colCount===i._endCell.colIndex)&&!t.model.scrollSettings.allowScrolling)return;t.model.scrollSettings.allowScrolling&&(i.rowCount===i._endCell.rowIndex&&f===40?t._scrollContent({x:0,y:+t.model.rowHeight}):i.colCount-1===i._endCell.colIndex&&f===39&&t._scrollContent({x:+t.model.columnWidth,y:0}));this._isHiddenCell(i._endCell)&&(g={rowIndex:i._endCell.rowIndex,colIndex:i._endCell.colIndex},this._skipHiddenRowsAndCols(g,o),i._endCell.rowIndex=g.rowIndex,i._endCell.colIndex=g.colIndex);(t._isPropExists([[i._startCell.rowIndex,i._endCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]],"merge")||t._isPropExists([[i._startCell.rowIndex,i._endCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]],"isMHide"))&&(ft=!0);(t.XLEdit.getPropertyValue(i._endCell.rowIndex,i._endCell.colIndex,"isMHide")||t.XLEdit.getPropertyValue(i._endCell.rowIndex,i._endCell.colIndex,"merge")||tt&&t._isPropExists([[i._endCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]],"merge")||t._isPropExists([[i._endCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]],"isMHide")||ft)&&(tt=!1,t.XLSelection._processBoundary(),(f===37||f==38)&&(ut=i._endCell,i._endCell=i._startCell,i._startCell=ut));(i._endCell.colIndex<=i._leftCol.idx||i._endCell.colIndex>=i._rightCol.idx||i._endCell.rowIndex<=i._topRow.idx||i._endCell.rowIndex>=i._bottomRow.idx)&&this._scrollToCell(i._endCell,o);t.XLSelection.selectRange(i._startCell,i._endCell);t.model.allowAutoFill&&t.XLDragFill.positionAutoFillElement()}else if(o={keyCode:f,shiftKey:!1,ctrlKey:!1,altKey:!1},f===37&&r.colIndex>0)this._navigateCell(r.rowIndex,r.colIndex-1,o);else if(f===38&&r.rowIndex>0)this._navigateCell(r.rowIndex-1,r.colIndex,o);else if(f===39&&r.colIndex<c)this._navigateCell(r.rowIndex,r.colIndex+1,o);else if(f===40&&r.rowIndex<s)this._navigateCell(r.rowIndex+1,r.colIndex,o);else return!1},_navigateCell:function(i,r,u){var p,s,nt,tt,w,b,it,rt,ut,k,d,et,ot,o={rowIndex:i,colIndex:r},e=this.XLObj,c=e.getActiveSheetIndex(),f=e.getSheet(c),a=e._getContent(c),h=a.find("#hscrollBar").data("ejScrollBar"),l=a.find("#vscrollBar").data("ejScrollBar"),y=a.find(".e-content"),ft=e.XLEdit,v=!1,g=y[0].offsetWidth;if((et=ot=0,f.rowCount!==o.rowIndex&&f.colCount!==o.colIndex||e.model.scrollSettings.scrollMode!=="normal")&&(f.rowCount!==o.rowIndex||!e.model.scrollSettings.allowVirtualScrolling)&&(f.rowCount!==o.rowIndex&&f.colCount!==o.colIndex||e.model.scrollSettings.allowScrolling)){for(f.rowCount===o.rowIndex&&(e.XLScroll._scrollY(c),v=!0),e._isAutoWHMode||f.colCount!==o.colIndex||e.model.scrollSettings.scrollMode!==t.Spreadsheet.scrollMode.Infinite||(e.XLScroll._scrollX(c),v=!0),this._navToCell(i,r),tt=e.getCell(o.rowIndex,o.colIndex),this._isHiddenCell(o)&&this._skipHiddenRowsAndCols(o,u),b=ft.getPropertyValue(f._activeCell.rowIndex,f._activeCell.colIndex,"merge"),b&&ft.getPropertyValue(o.rowIndex,o.colIndex,"mergeIdx")&&this._updateMergeRange(b,o,u),f._activeCell=f._endCell=f._startCell=o,(e.XLEdit.getPropertyValue(o.rowIndex,o.colIndex,"mergeIdx")||e.hasSpan(o))&&(e.XLSelection._processBoundary(),f._activeCell=f._startCell,tt=e.getCell(f._activeCell.rowIndex,f._activeCell.colIndex),nt=!0),s=e._getCellInfo(o,c),w=f._leftCol.idx>0?f._leftCol.idx-1:f._leftCol.idx,e.model.scrollSettings.allowScrolling&&f._bottomRow.idx<=o.rowIndex&&(u.keyCode===40||u.keyCode===13&&!u.shiftKey)&&!v&&!f._isFreezed?(l._scrollData.step=1,u.ctrlKey&&u.keyCode===40?e.XLScroll._scrollSelectedPosition(c,e.getActiveCell(c)):l.scroll(l.value()+(e._isFrozen(f.frozenRows)?e._getRowHeight(f._ftopRowIdx,c):s.height),!0)):e.model.scrollSettings.allowScrolling&&!e._isFrozen(f.frozenRows)&&f._topRow.idx>o.rowIndex&&(u.keyCode===38||u.keyCode===13&&u.shiftKey)&&!v&&!e._hasClass(a.find("tr").eq(o.rowIndex)[0],"e-fr-hide")&&(l._scrollData.step=-1,o.rowIndex>0?u.ctrlKey?l.scroll(s.top,!0):l.scroll(l.value()-s.height,!0):l.scroll(0)),e.model.scrollSettings.allowScrolling&&r>=f._rightCol.idx&&g<=f._colWidthCollection[f._activeCell.colIndex]-f._colWidthCollection[w]+s.width&&(u.keyCode===39||u.keyCode===9&&!u.shiftKey)&&!v&&!f._isFreezed?(h._scrollData.step=1,u.ctrlKey&&u.keyCode===39?h.scroll(s.left+s.width-h._scrollData.handleSpace,!0):h.scroll(h.value()+(e._isFrozen(f.frozenColumns)?e._getColWidth(f._fleftColIdx,c):s.width),!0)):e.model.scrollSettings.allowScrolling&&!e._isFrozen(f.frozenColumns)&&w>=o.colIndex&&(u.keyCode===37||u.keyCode===9&&u.shiftKey)&&!v&&!f._isFreezed?(h._scrollData.step=-1,o.colIndex>0?u.ctrlKey?h.scroll(s.left,!0):h.scroll(h.value()-s.width,!0):h.scroll(0)):e.model.scrollSettings.allowScrolling&&u.ctrlKey&&!v&&!f._isFreezed&&(u.keyCode===37?h.scroll(s.left,!0):u.keyCode===38?l.scroll(s.top,!0):u.keyCode===39?h.scroll(s.left-h._scrollData.handleSpace,!0):e.XLScroll._scrollSelectedPosition(c,e.getActiveCell(c))),p=a.find("col"),it=n(e.getRows(c)[1]),rt=f._startCell.rowIndex,ut=f._startCell.colIndex,(g>=s.left||y.offset().left+g>=s.left+s.width)&&(u.keyCode==39||u.keyCode==9&&!u.shiftKey)?e.XLSelection.selectRange(f._startCell,f._startCell):!p.eq(ut).hasClass("e-fc-hide")||u.keyCode==37||u.keyCode==9&&u.shiftKey?e.XLSelection.selectRange(f._startCell,f._endCell):!it.eq(rt).hasClass("e-fr-hide")&&(u.keyCode==38||u.keyCode==13&&u.shiftKey)?e.XLSelection.selectRange(f._startCell,f._endCell):(y.offset().top+y[0].offsetHeight>=s.top||y.offset().top+y[0].offsetHeight>=s.top+s.height)&&(u.keyCode==40||u.keyCode==13&&!u.shiftKey)&&e.XLSelection.selectRange(f._startCell,f._endCell),nt&&(u.keyCode===37||u.shiftKey&&u.keyCode===9?o.colIndex=f._startCell.colIndex:u.keyCode===38||u.shiftKey&&u.keyCode===13?o.rowIndex=f._startCell.rowIndex:u.keyCode===39||u.keyCode===9?o.colIndex=f._endCell.colIndex:(u.keyCode===40||u.keyCode===13)&&(o.rowIndex=f._endCell.rowIndex),f._activeCell=o),f._startCell=o;(u.keyCode===37||u.shiftKey&&u.keyCode===9)&&e._hasClass(p[f._startCell.colIndex],"e-c-hide");)e._removeClass(p[f._startCell.colIndex],"e-fc-hide"),f._startCell.colIndex--;while((u.keyCode===38||u.shiftKey&&u.keyCode===13)&&e._hasClass(a.find("tr")[f._startCell.rowIndex],"e-r-hide"))e._removeClass(a.find("tr")[f._startCell.rowIndex],"e-fr-hide"),f._startCell.rowIndex--;while((u.keyCode===39||u.keyCode===9)&&e._hasClass(p[f._startCell.colIndex],"e-c-hide"))f._startCell.colIndex++;while((u.keyCode===40||u.keyCode===13)&&e._hasClass(a.find("tr")[f._startCell.rowIndex],"e-r-hide"))f._startCell.rowIndex++;k=f._startCell.rowIndex;d=f._startCell.colIndex;e.model.selectionSettings.selectionType==="row"?e.XLSelection.selectRows(k,k):e.model.selectionSettings.selectionType==="column"&&e.XLSelection.selectColumns(d,d);e.model.showRibbon&&e.XLRibbon._updateRibbonIcons();e.model.allowAutoFill&&e.XLDragFill.positionAutoFillElement()}},_navToCell:function(n,t){var u=this.XLObj,o=u.getActiveSheetIndex(),r=u.getSheet(),f,e;if(f=e=0,r._isFreezed){if(r._frozenRows-1<=n&&n<r._ftopRowIdx){for(i=n;i<r._ftopRowIdx;i++)f+=r.rowsHeightCollection[i];u._scrollContent({y:-f})}else if(r._frozenRows-1<=n&&n>r._bottomRow.idx){for(i=r._bottomRow.idx;i<n;i++)f+=r.rowsHeightCollection[i];u._scrollContent({y:+f})}if(r._frozenColumns-1<=t&&t<r._fleftColIdx){for(i=t;i<r._fleftColIdx;i++)e+=r.columnsWidthCollection[i];u._scrollContent({x:-e})}else if(r._frozenColumns-1<=t&&t>r._rightCol.idx){for(i=r._rightCol.idx;i<t;i++)e+=r.columnsWidthCollection[i];u._scrollContent({x:+e})}}},_navigateRange:function(n,t){var c=this.XLObj,h=c.getSheet(c.getActiveSheetIndex()),r=h._startCell,u=h._endCell,i=h._activeCell,f=r.rowIndex<u.rowIndex?r.rowIndex:u.rowIndex,e=r.rowIndex>u.rowIndex?r.rowIndex:u.rowIndex,o=r.colIndex<u.colIndex?r.colIndex:u.colIndex,s=r.colIndex>u.colIndex?r.colIndex:u.colIndex;if(n=="Tab")if(i.colIndex<s)this._navigateRow("Forward",t);else if(i.rowIndex<e)this._updateActiveCell(i.rowIndex+1,o,t,n);else if(i.rowIndex==e&&i.colIndex==s)this._updateActiveCell(f,o,t,n);else return!1;else if(n=="Enter")if(i.rowIndex<e)this._navigateCol("Forward",t);else if(i.colIndex<s)this._updateActiveCell(f,i.colIndex+1,t,n);else if(i.rowIndex==e&&i.colIndex==s)this._updateActiveCell(f,o,t,n);else return!1;else if(n=="ShiftTab")if(i.colIndex>o)this._navigateRow("Backward",t);else if(i.rowIndex>f)this._updateActiveCell(i.rowIndex-1,s,t,n);else if(i.rowIndex==f&&i.colIndex==o)this._updateActiveCell(e,s,t,n);else return!1;else if(i.rowIndex>f)this._navigateCol("Backward",t);else if(i.colIndex>o)this._updateActiveCell(e,i.colIndex-1,t,n);else if(i.rowIndex==f&&i.colIndex==o)this._updateActiveCell(e,s,t,n);else return!1},_navigateRow:function(n,t){var i,r,u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex())._activeCell;n==="Forward"?(i=1,r="Tab"):(i=-1,r="ShiftTab");this._updateActiveCell(f.rowIndex,f.colIndex+i,t,r)},_navigateCol:function(n,t){var i,r,u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex())._activeCell;n==="Forward"?(i=1,r="Enter"):(i=-1,r="ShiftEnter");this._updateActiveCell(f.rowIndex+i,f.colIndex,t,r)},_updateActiveCell:function(n,t,i,r){var u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex()),e=f._activeCell;u._removeClass(u.getCell(e.rowIndex,e.colIndex),"e-activecell");f._activeCell={rowIndex:n,colIndex:t};i&&this._isHiddenCell(f._activeCell)&&this._skipHiddenRowsAndCols(f._activeCell,i,!0,r);this._isMergedCell(f._activeCell)&&this._skipMergedCells(f._activeCell,i);this._scrollToCell(f._activeCell,i);u.addClass(u.getCell(f._activeCell.rowIndex,f._activeCell.colIndex),"e-activecell");u.model.allowFormulaBar&&u.updateFormulaBar();u.setSheetFocus()},_isValidParameter:function(n){var t=n.indexOf("(");return t>-1?(n=n.split("("),n[1].length>0):!0},_skipHiddenRowsAndCols:function(n,t,i,r){var e=this.XLObj,u=e.getSheet(e.getActiveSheetIndex()),f=!0;i?this._navigateRange(r,t):((t.keyCode===37||t.keyCode===9&&t.shiftKey||t.keyCode===39&&t.ctrlKey)&&n.colIndex?n.colIndex--:(t.keyCode===38||t.keyCode===13&&t.shiftKey||t.keyCode===40&&t.ctrlKey)&&n.rowIndex?n.rowIndex--:(t.keyCode===39||t.keyCode===9||t.keyCode===37&&t.ctrlKey)&&n.colIndex<u.colCount?n.colIndex++:(t.keyCode===40||t.keyCode===13||t.keyCode===38&&t.ctrlKey)&&n.rowIndex<u.rowCount?n.rowIndex++:f=!1,this._isHiddenCell(n)&&f?this._skipHiddenRowsAndCols(n,t):f||((t.keyCode===37||t.keyCode===9&&t.shiftKey)&&!n.colIndex?n.colIndex=t.keyCode===37&&t.shiftKey?u._endCell.colIndex+1:u._startCell.colIndex:(t.keyCode===38||t.keyCode===13&&t.shiftKey)&&!n.rowIndex&&(n.rowIndex=t.keyCode===38&&t.shiftKey?u._endCell.rowIndex+1:u._startCell.rowIndex)))},_isHiddenCell:function(n){return this.XLObj.XLEdit.getPropertyValue(0,n.colIndex,"isCHide")||this.XLObj.XLEdit.getPropertyValue(n.rowIndex,0,"isRHide")||!1},_isMergedCell:function(n){return this.XLObj.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"isMHide")||this.XLObj.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"merge")},_skipMergedCells:function(n,t){var u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex()),i=f._startCell,r=f._endCell,e=!0,o=u._rcRegx;minr=i.rowIndex<r.rowIndex?i.rowIndex:r.rowIndex;maxr=i.rowIndex>r.rowIndex?i.rowIndex:r.rowIndex;minc=i.colIndex<r.colIndex?i.colIndex:r.colIndex;maxc=i.colIndex>r.colIndex?i.colIndex:r.colIndex;t.shiftKey&&t.keyCode===9?n.colIndex--:t.keyCode===9?n.colIndex++:t.shiftKey&&t.keyCode===13?n.rowIndex--:t.keyCode===13?n.rowIndex++:e=!1;n.colIndex>maxc?(n.colIndex=minc,n.rowIndex=n.rowIndex===maxr?minr:n.rowIndex+1):n.colIndex<minc?(n.colIndex=maxc,n.rowIndex=n.rowIndex===minr?maxr:n.rowIndex-1):n.rowIndex>maxr?(n.rowIndex=minr,n.colIndex=n.colIndex===maxc?minc:n.colIndex+1):n.rowIndex<minr&&(n.rowIndex=maxr,n.colIndex=n.colIndex===minc?maxc:n.colIndex-1);this._isMergedCell(n)&&e&&this._skipMergedCells(n,t)},_updateMergeRange:function(n,t,i){var f=this.XLObj,r=n.mSpan.colSpan-1,u=n.mSpan.rowSpan-1;i.shiftKey||i.keyCode!==39&&i.keyCode!==9?i.shiftKey||i.keyCode!==40&&i.keyCode!==13||(t.rowIndex=t.rowIndex+u):t.colIndex=t.colIndex+r},_isRangeMerged:function(n){var i,r={},u=this.XLObj,f=n[0],t=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"merge");if(t&&(r={rowIndex:n[0].rowIndex+t.mSpan.rowSpan-1,colIndex:n[0].colIndex+t.mSpan.colSpan-1},i=u._getSelectedRange(n[0],r),i.length===n.length))return!0},_scrollToCell:function(n,t){var f=this.XLObj,o=f.getActiveSheetIndex(),i=f._getCellInfo(n,o),r=f.getSheet(o),s=f._getContent(o),h=s.find(".e-content"),u=s.find("#hscrollBar").data("ejScrollBar"),e=s.find("#vscrollBar").data("ejScrollBar");(f.model.scrollSettings.scrollMode!=="normal"||r.colCount-1!==n.colIndex)&&(r._bottomRow.idx>0&&n.rowIndex>r._bottomRow.idx-1&&r.rowCount-1>n.rowIndex&&t.keyCode===40?e.scroll(e.value()+i.height,!0):n.rowIndex-1<r._topRow.idx&&t.keyCode===38?(e._scrollData.step=-1,n.rowIndex>0?e.scroll(i.top,!0):e.scroll(0)):n.colIndex<r._leftCol.idx?n.colIndex>0?u.scroll(u.value()-i.width,!0):u.scroll(0):h[0].offsetWidth<=i.left+i.width&&(t.keyCode===39?r.colCount===n.colIndex+1?f.XLScroll._scrollX(o):u.scroll(u.value()+i.width,!0):t.keyCode===37&&(u._scrollData.step=-1,u.scroll(i.left,!0))))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellFormatting=function(n){this.XLObj=n;this._formatEnable=!1;this._thousandSeparator=t.preferredCulture(this.XLObj.model.locale).numberFormat[","];this._formatAsTableStyle={};this._rowLength=null;this._colLength=null;this._getFormat=null;this._getEformatClass=null;this._borderPosition=["top","right","bottom","left"];this._cellObj=null;this._isFAT=!1;this._customFormatSpecifierType={};this._customFontFamily={}};t.spreadsheetFeatures.cellFormatting.prototype={format:function(i,r){var u=this.XLObj,yt,v;if(u.model.allowCellFormatting&&!u.model.isReadOnly){var f,e,y,b,rt,ct,ut,ft,l,g,h,k,c,et,nt,a,lt,ot=0,d={},at=[],tt="style",it="format",s=u.getActiveSheetIndex(),o=u.getSheet(s),wt=u._rAlign,p=u._dataContainer,w={sheetIndex:s,reqType:"cell-format"},pt=u._dupDetails,st=!1,vt=o.rowsHeightCollection,ht=0;if((y=u._getMultiRangeCells(r),g=y.length,!u._trigger("beforeCellFormat",{sheetIndex:s,format:i,cells:y}))&&g){if(i=this._getFormatObj(i),tt in i||it in i){for(w.oprType=(tt in i)?"style":"format",lt=y[g-1].colIndex;ot<g;){if(e=y[ot],k={sheetIndex:s,format:i,cell:e},this._cellObj={},f={rowIndex:e.rowIndex,colIndex:e.colIndex,beforeFormat:{},afterFormat:{},bRowHeight:u.model.allowResizing&&u.XLResize.getRowHeight(e.rowIndex)},d=t.isNullOrUndefined(p.sheets[s][f.rowIndex])?{}:t.isNullOrUndefined(p.sheets[s][f.rowIndex][f.colIndex])?{}:p.sheets[s][f.rowIndex][f.colIndex],u._isRowViewable(s,e.rowIndex)&&(ft=u.getCell(e.rowIndex,e.colIndex),l=ft[0]),tt in i&&(f.prevClass=u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,it),f.prevClass=f.prevClass?f.prevClass:"",a=this._getExtendedFormat(e,i.style),a.format["text-align"]&&a.format["text-align"].toLowerCase()==="right"&&!u._hasClass(l,"e-rightalign")?u.addClass(l,"e-rightalign"):(!a.format["text-align"]||a.format["text-align"].toLowerCase()!=="right")&&u._hasClass(l,"e-rightalign")&&u._removeClass(l,"e-rightalign"),this._cellObj.formats=n.extend(!0,{},a.format),rt=u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"tformats"),rt&&(a.format=n.extend(rt,a.format)),this._cellObj.format=f.className=this._createFormatClass(a.format),f.beforeFormat=n.extend(!0,{},d),("font-family"in i.style||"font-size"in i.style)&&!u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"isMHide")&&t.isNullOrUndefined(u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"merge"))&&(nt=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex),u.model.allowResizing&&(u.isNumber(nt)||u._isDateTime(nt)||u.isTime(nt))&&(et=u.XLResize._getContentWidth(f.colIndex,s,f.rowIndex,f.rowIndex)+2,et>o.columnsWidthCollection[f.colIndex]&&u.setWidthToColumns([{colIndex:f.colIndex,width:et}])),u.model.allowSelection&&u.XLSelection._refreshBorder(),st=!0),k.cssClass=a.className),it in i&&i.type&&(h=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex),h=t.isNullOrUndefined(h)?"":h,this._cellObj.value=h,this._cellObj.type=i.type,this._cellObj.formatStr=i.format.formatStr,this._cellObj.decimalPlaces=i.format.decimalPlaces,this._cellObj.thousandSeparator=i.format["thousandSeparator"]?!0:!1,this._cellObj.canUpdate=!0,f.beforeFormat=n.extend(!0,{},d),h=this._getFormattedValue(f.rowIndex,f.colIndex,this._cellObj,h),k.value=this._cellObj.value,k.value2=this._cellObj.value2=t.isNullOrUndefined(h)?"":h[0]=="'"?h.substr(1):h+"",delete this._cellObj.canUpdate,f.beforeFormat.Oprtype=this._cellObj.type),u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2")&&u._textClip(f.rowIndex,f.colIndex,"delete"),u.XLEdit._updateDataContainer(f,{dataObj:this._cellObj}),tt in i&&("font-family"in i.style||"font-size"in i.style)&&!u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"isMHide")){if(b=o.columnsWidthCollection[f.colIndex],u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"merge")&&u._isRowViewable(s,e.rowIndex)){if(l.colSpan>1)for(v=e.colIndex+1,yt=e.colIndex+l.colSpan;v<yt;v++)b=b+o.columnsWidthCollection[v];if(c=u._detailsFromGlobalSpan(f.rowIndex,f.colIndex,"height",u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2"),b),l.rowSpan>1)for(v=e.rowIndex;v<e.rowIndex+l.rowSpan;v++)ht=ht+vt[v];c=c-(ht-vt[e.rowIndex])}else c=u._detailsFromGlobalSpan(f.rowIndex,f.colIndex,"height",u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2"),b);(u.XLEdit.getPropertyValue(f.rowIndex,0,"wrapRow")?o.rowsHeightCollection[f.rowIndex]<c:!0)&&(!(c>=u.model.rowHeight)||u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"wrap")&&u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"merge")||u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"mergeIdx")||(u._updateFormatColl(s,f.rowIndex,f.colIndex,c),c=u._getFormattedHeight(s,f.rowIndex),l&&ft.parent().outerHeight(c),o.rowsHeightCollection[f.rowIndex]=c,u.XLEdit._updateDataContainer({rowIndex:f.rowIndex,colIndex:0},{dataObj:{pHeight:o.rowsHeightCollection[f.rowIndex],cHeight:c}}),st=!0,u.model.allowFreezing&&(u.XLFreeze._refreshFRowResize(e.rowIndex),u.XLFreeze._refreshFColResize(e.colIndex))))}ct=u._getCellInfo(e);u._dupDetails=!0;it in i&&["text","general"].indexOf(this._cellObj.type)===-1&&(ut=u._detailsFromGlobalSpan(e.rowIndex,e.colIndex,"width",this._cellObj.value2),ut>ct.width&&u.XLResize.setColWidth(e.colIndex,ut),u.model.allowFreezing&&u.XLFreeze._refreshFColResize(e.colIndex));u._dupDetails=!1;u._dupDetails=pt;o._isColSelected&&o.selectedRange[1]<=f.colIndex&&f.colIndex<=o.selectedRange[3]&&(o._columnStyles[f.colIndex]=n.extend(!0,o._columnStyles[f.colIndex],this._cellObj));o._isRowSelected&&o.selectedRange[0]<=f.rowIndex&&f.rowIndex<=o.selectedRange[2]&&(o._rowStyles[f.rowIndex]=n.extend(!0,o._rowStyles[f.rowIndex],this._cellObj));this._cellObj=null;d=t.isNullOrUndefined(p.sheets[s][f.rowIndex])?{}:t.isNullOrUndefined(p.sheets[s][f.rowIndex][f.colIndex])?{}:p.sheets[s][f.rowIndex][f.colIndex];f.afterFormat=n.extend(!0,{},d);f.afterFormat.Oprtype=f.beforeFormat.Oprtype;f.aRowHeight=u.model.allowResizing&&u.XLResize.getRowHeight(e.rowIndex);at.push(f);u._trigger("cellFormatting",k);u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2")&&u._textClip(f.rowIndex,f.colIndex,"add");lt===f.colIndex&&u._setRowHdrHeight(s,f.rowIndex);ot++}w.selectedCell=at;w.range=o.selectedRange;u.XLScroll._getRowHeights(s,y[0].rowIndex);st&&(!o._isImported||o._isLoaded)&&u.model.allowComments&&!u._isExport&&u.XLComment._updateCmntArrowPos(null,s)}"border"in i&&!u._isMultiRange(r)?this.applyBorder(i.border,r,w):o._isImported&&!o._isLoaded||u._isUndoRedo||u._dupDetails||u._isSort||u._isExport||(u._completeAction(w),u._trigActionComplete(w))}}},_getFormattedValue:function(n,i,r,u){var o,f=this.XLObj,e={},u=t.isNullOrUndefined(u)?"":f.XLEdit.getPropertyValue(n,i);return t.isNullOrUndefined(u)&&(u=""),f.isFormula(u)&&(u=f.XLEdit.getPropertyValue(n,i,"calcValue"),r.canUpdate=!1),["text","general"].indexOf(r.type)!==-1?(f._isDateTime(u)&&(o=f.XLEdit.getPropertyValue(n,i,"type"),u=f._dateToInt(u,o===t.Spreadsheet.CellType.Time),r.value=u),r.type===t.Spreadsheet.CellType.Text?e.align="":f.isNumber(u)&&f.XLEdit.getPropertyValue(n,i,"align")!="right"&&(e.align=t.Spreadsheet.Align.Right),"align"in e&&(e.cellIdx={rowIndex:n,colIndex:i},f.XLEdit._refreshCellAlignment(e))):u=this._format(u,{formatStr:r.formatStr,type:r.type,thousandSeparator:r.thousandSeparator,decimalPlaces:r.decimalPlaces,cellObj:r}),u},_format:function(n,i){var u=this.XLObj,e=i.formatStr,r=u.isUndefined(n)?"":n,l=i.type||"",f=t.Spreadsheet.CellType,h=u.model.locale,a=["."].indexOf(this._thousandSeparator)>-1?"\\":"",v=new RegExp(a+this._thousandSeparator,"g");n=r.toString();switch(l){case f.Accounting:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toAccounting(e,r,h));break;case f.Currency:case f.Number:case f.Percentage:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.formatting(e,r,h),!i.thousandSeparator&&[f.Number,f.Percentage].indexOf(l)>-1&&this._thousandSeparator&&(r=r.replace(v,"")));break;case f.Scientific:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toExponential(r,i.decimalPlaces));break;case f.Fraction:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toFraction(r),r="numerator"in r?r.integer+" "+r.numerator+"/"+r.denominator:r.integer);break;case f.LongDate:case f.ShortDate:case f.Date:case f.Time:case f.DateTime:u.isNumber(r)?(r=u.intToDate(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r)):u._isDateTime(r)||(r=t.parseDate(r));u._isDateTime(r)&&(r=u.formatting(e,r,h));break;case f.String:var c=e.indexOf("\\"),o=e.indexOf("#"),s=e.split("\\").join("");o<0&&(o=e.indexOf("0"));c<o?r=s.substr(c,s.length-1)+n:c>o&&(r=n+s.substr(o+1,s.length))}return t.isNullOrUndefined(r)?n:r},createTable:function(i,r){var u=this.XLObj,k,d;if(u.model.allowFormatAsTable&&(u.model.allowSelection||!t.isNullOrUndefined(r))&&!u.model.isReadOnly){t.isNullOrUndefined(i.format)&&(i.format=this._getTableLayoutFromName(i.formatName).format);t.isNullOrUndefined(i.showHeaderRow)&&(i.showHeaderRow=!0);var o,w,tt,f,g,c,s,v=i.name||"",nt,h=u.getActiveSheetIndex(),e=u.getSheet(h),y=e.tableManager,l=e._startCell,a=e._endCell,it="formatName",b={sheetIndex:h,tableStyle:i,reqType:"format-table"},rt=i.format||this._getTableLayoutFromName(i.formatName).format,p={format:rt},ft=u._dupDetails,ut=u.element.find("#"+u._id+"_Ribbon_tsofiltercolumn");if(w={range:t.isNullOrUndefined(r)?[l.rowIndex,l.colIndex,a.rowIndex,a.colIndex]:r,sheetIndex:b.sheetIndex,tableStyle:b.tableStyle,reqType:b.reqType},!u._trigActionBegin(w)&&rt){if(i=b.tableStyle,this._isFAT=!0,r=u._getRangeArgs(r,"object"),u._isUndoRedo)f=n.merge([],r);else for(f=r?r:e.selectedRange,k=f[0];k<=f[2];k++)for(d=f[1];d<=f[3];d++)if(nt=u.XLFilter._getFilterHeader(h,k,d),!t.isNullOrUndefined(nt)&&nt.status.indexOf("e-ssfilter")>-1){u._showAlertDlg("Alert","FilterAlert","",440);return}if(!i.name||u.XLRibbon._validateNamedRange(i.name,u._getDollarAlphaRange(f,!0))||u.XLClipboard._isCut){if(g=u.XLEdit.getPropertyValue(f[0],f[1],"tableName")||"",(!e._isImported||e._isLoaded)&&(tt=u.getRange(f),o={sheetIndex:h,reqType:"format-table",beforeFormat:this.getHashCodeClassAsArray(),beforeRange:n.extend(!0,[],f),pcells:tt,beforeRangeHeader:u.getRangeData({range:[f[0],f[1],f[0],f[3]]})},c=i.header?[f[0],f[1],f[2],f[3]]:[f[0],f[1],f[2]+1,f[3]],o.beforeRangeData=u.getRangeData({range:c}),o.beforeMergeRange=u.XLEdit._getPropWithCellIdx(c,"merge",h),u._dupDetails=!0,o.beforeMergeRange.length&&u.unmergeCells(u._getAlphaRange(h,c[0],c[1],c[2],c[3])),u._dupDetails=!1),it in i&&(p[it]=i.formatName),"showHeaderRow"in i&&(p.showHeaderRow=i.showHeaderRow),g)this._formatAsTableStyle=p,u._dupDetails=!0,this._createTable(u._getTableID(g),p),u._dupDetails=!1,u._undoCollection.pop(),u._undoCollection.pop();else{if(u.XLClipboard._isCut){while(i.tblId in y)i.tblId++;s=parseInt(i.tblId)}else s=u.getObjectLength(y)+1;v=v.length?v:"Table"+s;u.model.sheets[h]._header[s]={header:i.header};e._isLoaded&&(i.header?(r?(e._startCell={rowIndex:r[0],colIndex:r[1]},e._endCell={rowIndex:r[2],colIndex:r[3]},u.XLSelection.selectRange(e._startCell,e._endCell),u.model.allowAutoFill&&(!e._isImported||e._isLoaded)&&u.XLDragFill.positionAutoFillElement()):r=u.swapRange([l.rowIndex,l.colIndex,a.rowIndex,a.colIndex]),r[0]===r[2]&&(f=r,f[2]=f[2]+1)):(u._isUndoRedo?f=n.extend(!0,[],r):(f=r?r:u.swapRange([l.rowIndex,l.colIndex,a.rowIndex,a.colIndex]),r=f),u.model.allowDragAndDrop&&u.XLDragDrop._moveRangeTo(f,[f[0]+1,f[1],f[2]+1,f[3]],["value","value2","type","formatStr","decimalPlaces","thousandSeparator","range","format","border","borders","comment","hyperlink","picture","cFormatRule","rule","chart","isLocked","wrap","formats","tformats","tborders","tableName"]),e._startCell={rowIndex:f[0],colIndex:f[1]},e._endCell={rowIndex:f[2]+1,colIndex:f[3]},u.XLSelection.selectRange(e._startCell,e._endCell),u.model.allowAutoFill&&(!e._isImported||e._isLoaded)&&u.XLDragFill.positionAutoFillElement(),f[2]=f[2]+1));"dataSource"in i&&u.updateRange(h,{showHeader:"showHeader"in i?i.showHeader:!0,startCell:u._getAlphaRange(h,r[0],r[1],r[0],r[1]),dataSource:i.dataSource});u.updateUniqueData({tableName:"e-table"+s},r);y[s]={name:v,range:f,showHeaderRow:i.showHeaderRow};i.fnNumber&&(y[s].fnNumber=i.fnNumber);y[s].isFilter=i.showHeaderRow;u.XLRibbon._isDesignTab=!0;u._dupDetails=!0;this._createTable(s,p);i.showHeaderRow&&u.model.allowFiltering&&u.XLFilter._filterTable(h,s,{startCell:{rowIndex:r[0],colIndex:r[1]},endCell:{rowIndex:r[2],colIndex:r[3]}});u._dupDetails=!1;this._updateTblStyleOptns(s,i);e._isImported&&!e._isLoaded||i.hideTab||u.XLRibbon._designTabUpdate(s,{rowIndex:r[0],colIndex:r[1]});u.model.allowComments&&u.XLComment._updateCmntArrowPos()}return(!e._isImported||e._isLoaded)&&(u.XLRibbon._dirtySelect(u.getRange(r)),o.tableID=s,o.tableStyle=i,o.afterRange=f,u._dupDetails=ft,w={pCells:o.pcells,reqType:o.reqType,sheetIndex:o.sheetIndex,tableID:o.tableID,tableStyle:o.tableStyle},u._isPaste||u._isUndoRedo||u._dupDetails||u._isExport||(u._completeAction(o),u._trigActionComplete(w))),ut.length&&ut.ejCheckBox("option",{checked:!0}),u.XLRibbon.addNamedRange(v,u._getDollarAlphaRange(r,!0),null,h),e._isLoaded&&u.XLSelection._refreshBorder(),this._isFAT=!1,i.name}}}},_createTable:function(t,i){var c,f,s,h,rt,u,l,tt,it,ut,k,d,e,g,a=1,ft="format",ct=ft+"s",at="t"+ct,et="border",ot="tableName",nt="e-table"+t,st=!1,r=this.XLObj,o=r.getActiveSheetIndex(),lt=r.getSheet(o),y=lt.tableManager[t],p=y.range,v=p[0],w=p[1],ht=p[2],b=p[3],vt=r.element.find("#"+r._id+"_Ribbon_tsofiltercolumn");if(y[ft]=i.format,i.formatName&&(y["formatName"]=i.formatName),y.showHeaderRow&&(i.showHeaderRow=y.showHeaderRow),this.removeStyle(p,{tableStyle:!0,border:!0,sheetIdx:o}),i.showHeaderRow&&"headerLayout"in i.format&&(u=n.extend(!0,{},i.format.headerLayout),et in u&&(l=r._getProperAlphaRange(o,v,w,v,b),r._intrnlReq=!0,this.applyBorder(u.border,l),r._intrnlReq=!1,delete u.border)),st=r.getObjectLength(u)>0,f=v,s=w,h=b,i.showHeaderRow)while(s<=h)d=!1,e={},c={rowIndex:f,colIndex:s},tt=r.XLEdit.getPropertyValue(f,s,"value2")||"",it="Column"+a,r.XLEdit.getPropertyValue(f,s,ot,o)!==nt&&(e.tableName=nt,d=!0),tt.length?tt.toLowerCase()===it.toLowerCase()&&a++:(r.XLEdit._updateCell(c,it),a++),st&&(k=this._getExtendedFormat(c,u,this._isFAT),e.format=this._createFormatClass(k.format),e.tformats=u,d=!0),d&&r.XLEdit._updateDataContainer(c,{dataObj:e,sheetIdx:o}),s++;if("contentLayout"in i.format)for(ut=i.format.contentLayout.length,a=0,f=i.showHeaderRow?v+1:v,s=ht;f<=s;){if(u=n.extend(!0,{},i.format.contentLayout[a%ut]),et in u&&(l=r._getProperAlphaRange(o,f,w,f,b),r._intrnlReq=!0,this.applyBorder(u.border,l),r._intrnlReq=!1,delete u.border),r.getObjectLength(u))for(h=w,rt=b;h<=rt;)e={},c={rowIndex:f,colIndex:h},g=n.extend({},u),r.XLEdit.getPropertyValue(f,h,ot,o)!==nt&&(e.tableName=nt),g.color&&r.XLEdit.getPropertyValue(f,h,"hyperlink")&&delete g.color,k=this._getExtendedFormat(c,g,this._isFAT),e.format=this._createFormatClass(k.format),e.tformats=u,r.XLEdit._updateDataContainer(c,{dataObj:e,sheetIdx:o}),h++;f++;a++}"contentBorder"in i.format&&(l=r._getProperAlphaRange(o,v+1,w,ht,b),r._intrnlReq=!0,this.applyBorder(n.extend({},i.format.contentBorder.border),l),r._intrnlReq=!1);r.XLClipboard._isCut||r._tableCnt++},_updateTblStyleOptns:function(n,t){var i,r,e="firstColumn",o="lastColumn",h="bold",c="normal",l="totalRow",s="isFilter",u=this.XLObj,f=u._getSheetIndex(),v=u.getSheet(f),a=v.tableManager;n in a&&(i=a[n],r=i.range,i[s]=s in t?t.isFilter:"showHeaderRow"in t?t.showHeaderRow:!0,u.model.allowFiltering&&!i[s]&&u.XLFilter._clearFilterTableIcon(f,n),u._dupDetails=!0,e in t&&(i[e]=t.firstColumn,this.format({style:{"font-weight":i[e]?h:c}},u._getProperAlphaRange(f,r[0]+1,r[1],r[2],r[1]))),o in t&&(i[o]=t.lastColumn,this.format({style:{"font-weight":i[o]?h:c}},u._getProperAlphaRange(f,r[0]+1,r[3],r[2],r[3]))),u._dupDetails=!1,l in t&&(i[l]=t.totalRow))},removeTable:function(t){var i=this.XLObj;if(i.model.allowFormatAsTable&&!i.model.isReadOnly){var r,c,l,e,a,o,u=0,s=i.getActiveSheetIndex(),h=i.getSheet(s).tableManager,f=h[t].range,y=h[t].name,v=i.element.find("#"+i._id+"_Ribbon_tsofiltercolumn");if(t in h){if(i.clearRangeData(f,["tableName"]),r=i._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]}),c=r.length,c)while(u<c)l=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"formats"),e=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"tformats"),a=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"borders"),o=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"tborders"),e&&(n.extend(e,l),i.XLEdit._updateDataContainer(r[u],{dataObj:{formats:e}})),o&&(n.extend(o,a),i.XLEdit._updateDataContainer(r[u],{dataObj:{borders:o}})),i.XLEdit._clearDataContainer({cellIdx:{rowIndex:r[u].rowIndex,colIndex:r[u].colIndex},property:["tformats","tborders"]}),u++;i.model.allowFiltering&&!i._isFATResize&&i.XLFilter._clearFilterTable(s,parseInt(t));delete h[t];delete i.model.sheets[s]._header[t];i.XLRibbon.removeNamedRange(y);v.length&&v.ejCheckBox("option",{checked:!1});i.XLRibbon._toggleDesignTab(i.getActiveCell(s))}}},_renameTable:function(t){var i=this.XLObj,h=i.getActiveSheetIndex(),u=i.getSheet(h).tableManager,r=i._getTableID(t),f,e,o,c=n("#"+i._id+"_Ribbon").data("ejRibbon"),s;r&&(s=document.getElementById(i._id+"_Ribbon_Design_Properties_TableName")&&document.getElementById(i._id+"_Ribbon_Design_Properties_TableName").value,f=u[r].name,f!=s&&(e=i._getDollarAlphaRange(u[r].range,!0),i.XLRibbon._validateNamedRange(s,e)&&(o={sheetIndex:h,reqType:"format-table",action:"renaming",range:e,tableId:parseInt(r),prevName:f},i.XLRibbon.removeNamedRange(f),u[r].name=s,i.XLRibbon.addNamedRange(u[r].name,e,null,h),o.newName=u[r].name,c.showTab(i._getLocStr("Design")),i._completeAction(o),i._trigActionComplete(o))))},_getTableLayoutFromName:function(n){if(n)return this.XLObj._FATStyles[n]},_getTableIdxFromName:function(n){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()).tableManager,t=i.getObjectLength(r);if(t)while(t--)if(r[t].name===n)return t;return-1},convertToRange:function(n){var t=this.XLObj;t.model.isReadOnly||(n.alert?t._showAlertDlg("","ConverToRangeAlert","ConvertToRange",498):this._convertToRange(n))},_convertToRange:function(t){for(var h,i=this.XLObj,e=t.sheetIdx||i.getActiveSheetIndex(),c=i.getSheet(e),o,u=i.getSheet(e).tableManager,s=c.filterSettings.tableRange,r=t.tableId||i._getTableID(null,document.getElementById(i._id+"_Ribbon_Design_Properties_TableName")&&document.getElementById(i._id+"_Ribbon_Design_Properties_TableName").value),f=0;f<s.length;f++)s[f].tableID==r&&(h=f);i.getObjectLength(u)&&(o={sheetIndex:e,reqType:"format-table",action:"Design_Tools_ConvertToRange",beforeFormat:i.XLFormat.getHashCodeClassAsArray(),tableID:r,name:u[r].name,format:u[r].format,formatName:u[r].formatName,tableRange:s[h],beforeRange:u[r].range,isFilter:u[r].isFilter,header:n.extend(!0,[],c._header[r]),firstColumn:u[r].firstColumn,lastColumn:u[r].lastColumn,totalRow:u[r].totalRow,fnNumber:u[r].fnNumber});i.isNumber(r)&&i.XLFormat.removeTable(r);i.model.showRibbon&&i.XLRibbon._toggleDesignTab(i.getActiveCell());i._completeAction(o);i._trigActionComplete(o)},_calculateTotalRow:function(i,r,u,f,e){var w,o=this.XLObj,a,g=[],nt=[],b,y,s,k=!1,p,tt=o.getSheet(i),c=tt.tableManager,it,v=tt._selectedCells,d,rt=o._id+"_Ribbon_Design_TableStyleOptions_TotalRow",ot=n("#"+rt).data("ejCheckBox"),h,l,ut=o._isUndo,ft=o._isUndoRedo,et=o._dupDetails;if(r=r||parseInt(document.getElementById(o._id+"_tableid").value),s=c[r].range,g.push(o.getRangeData({range:[s[2]+1,s[1],s[2]+1,s[3]]})),b=o._getProperAlphaRange(i,s[0]+1,s[3],s[2],s[3]),a=o._getSelectedRange({rowIndex:s[2]+1,colIndex:s[1]},{rowIndex:s[2]+1,colIndex:s[3]}),u){if(h={rowIndex:s[2]+1,colIndex:s[1]},l={rowIndex:s[2]+1,colIndex:s[3]},o._dupDetails=o._isTotalRow=!0,o._insRows={startRow:h.rowIndex,endRow:l.rowIndex},o._isUndo=!1,!e&&(it=o.insertShiftBottom(h,l),it))return;if(o._isUndo=ut,o._isUndoRedo=ft,o._dupDetails=o._isTotalRow=!1,!o._isFilterApplied||o._insDelStatus=="insert"){if(a.length>1&&o.XLEdit._updateCellValue(a[0],u?"Total":""),!c[r].fnNumber&&u){if(p=t.distinct(o.getRangeData({range:o.getRangeIndices(b),valueOnly:!0})),p=p.filter(Boolean),w=p.length,w){while(w--)if(!o.isNumber(p[w])){k=!0;break}}else k=!0;c[r].fnNumber=k?103:109}o.XLEdit._updateCellValue(a[a.length-1],u?"=SUBTOTAL("+c[r].fnNumber+","+b+")":"");c[r].range[2]+=1;o._insDelStatus==""}}else h={rowIndex:s[2],colIndex:s[1]},l={rowIndex:s[2],colIndex:s[3]},o._dupDetails=o._isTotalRow=!0,o.model.allowFiltering&&o.XLFilter._checkFilterApplied(i,h.rowIndex,1,h.colIndex,1,"filter"),o._checkTableApplied(i,h.rowIndex,1,h.colIndex,1,"shiftUp"),o._isFilterApplied||o._isTableApplied?(o._intrnlReq=!0,o._isUndo=!1,o.deleteEntireRow(h.rowIndex,l.rowIndex),o._isUndo=ut,o._intrnlReq=!1,f=!1):o._deleteShiftUp(i,h,l,{startCol:h.colIndex,colCount:l.colIndex-h.colIndex+1,startRow:h.rowIndex,rowCount:l.rowIndex-h.rowIndex+1,status:"shiftUp"}),o._isTotalRow=!1,c[r].range[2]-=1;o._dupDetails=et;u?c[r].totalRow=!0:"totalRow"in c[r]&&delete c[r].totalRow;y=c[r].range;o.XLFormat._createTable(r,{format:c[r].format});nt.push(o.getRangeData({range:[y[2]+1,y[1],y[2]+1,y[3]]}));d={sheetIndex:i,reqType:"format-table",action:"totalrow",range:b,check:u,id:rt,cell:a,tmgr:c,tableId:r,pcells:g[0],curCells:nt[0],fnNumber:c[r].fnNumber,isShift:f};e&&(o._dupDetails=o._isUndoRedo=!1);o._dupDetails||(o._completeAction(d),o._trigActionComplete(d));o.performSelection({rowIndex:v[0].rowIndex,colIndex:v[0].colIndex},{rowIndex:v[v.length-1].rowIndex,colIndex:v[v.length-1].colIndex});o._dupDetails=!1},_updateTotalRow:function(n,t,i,r,u){var f=this.XLObj,o=f.getSheet(n),e=o.tableManager;e[t].fnNumber=i;u&&f._clearFormula(r[2],r[3]);f.XLEdit._updateCellValue({rowIndex:r[2],colIndex:r[3]},"=SUBTOTAL("+e[t].fnNumber+","+f._getAlphaRange(n,r[0]+1,r[3],r[2]-1,r[3])+")")},customFormatParser:function(n){if(this.XLObj.model.allowCellFormatting){var i,f,e,o={},h=t.Spreadsheet.CellType,r="{0:",u="}",c="N",a="P",s=".",l="0";return n=t.isNullOrUndefined(n)?"":n.toString(),Number(n)===0?(n.indexOf(s)>-1?(e=n.split(s),i=r+c+e[1].length+u):i=r+"D"+n.length+u,f=h.Number):!n.indexOf("#")&&n.indexOf(",")>-1&&n.lastIndexOf(l)===n.length-1?(n.indexOf(s)>-1?(e=n.split(s),i=r+c+e[1].length+u):i=r+c+l+u,o.thousandSeparator=!0,f=h.Number):n.lastIndexOf("%")===n.length-1&&Number(n.replace(/%/g,""))===0?(n.indexOf(s)>-1?(e=n.split(s),i=r+a+--e[1].length+u):i=r+a+l+u,f=h.Percentage):/^[dMy/\-\s,]+$/.test(n)?(i=r+n+u,f=h.Date):/^[hmst:\s]+$/.test(n)?(i=r+n+u,f=h.Time):n.indexOf("\\")>-1&&(o.formatStr=n,o.type="string"),i&&(o.formatStr=i,o.type=f),o}},addCustomFormatSpecifier:function(n,i,r){var e,u=t.Spreadsheet.CellType,f=t.cultures[this.XLObj.model.locale];if([u.Date,u.DateTime,u.LongDate,u.ShortDate,u.Time].indexOf(r)>-1){for(e in f.calendar.patterns)if(f.calendar.patterns[e]==i)return;n||(n="cDFrmt"+Object.keys(f.calendar.patterns).length);f.calendar.patterns[n]=i;this._customFormatSpecifierType[n]=r}},addFontFamily:function(i){var h,r,e,c,l=i,o=this._customFontFamily,f=this.XLObj,u=49,s;if(i=i.toLowerCase(),f.isUndefined(o[i])){for(h in o)s=parseInt(o[h]),s>u&&(u=s);u++;f.model.showRibbon&&(r=n("#"+f._id+"_Ribbon_Home_Font_FontFamily").data("ejDropDownList"),e=n.extend(!0,[],f.XLRibbon._fontFamily),e.push({text:l,value:u}),r&&(c=r.model.selectedItemIndex,r.option({dataSource:e}),r._initValue=!0,r.selectItemByIndex(c),r._initValue=!1,f.XLRibbon._fontFamily=e));o[i]=u+"";t.Spreadsheet.FontFamily[i]=u+""}},removeFontFamily:function(i){var e,r,o=this._customFontFamily,u=this.XLObj,f,s;if(u.model.showRibbon)for(r=n("#"+u._id+"_Ribbon_Home_Font_FontFamily").data("ejDropDownList"),f=n.extend(!0,[],u.XLRibbon._fontFamily),e=0;e<f.length;e++)if(f[e].text===i){f.splice(e,1);r&&(s=r.model.selectedItemIndex,r.option({dataSource:f}),r._initValue=!0,r.selectItemByIndex(s),r._initValue=!1);u.XLRibbon._fontFamily=f;break}i=i.toLowerCase();u.isUndefined(o[i])||(delete o[i],u.isUndefined(t.Spreadsheet.FontFamily[i])||delete t.Spreadsheet.FontFamily[i])},applyBorder:function(i,r,u){var f=this.XLObj,e,o;f.model.allowCellFormatting&&f.model.formatSettings.allowCellBorder&&!f.model.isReadOnly&&(e=f.getActiveSheetIndex(),o=f.getSheet(e),r=f._getRangeArgs(r,"object",e),(!o._isImported||o._isLoaded)&&(u||(u={sheetIndex:e,reqType:"cell-format",process:"border",options:n.extend(!0,{},i)}),u.range=r,u.beforeFormat=this.getHashCodeClassAsArray(r),u.property=i.property,delete i.property),f.getObjectLength(i)?i.isGridBorder?this._applyAllBorderCss(i,r,u):this._applyBorderCss(i,r,u):this.removeStyle(r,{cellStyle:!0,border:!0,sheetIdx:e}),o._isImported&&!o._isLoaded||f._isUndoRedo||(f._refreshRangeTRHght(e,r),t.isNullOrUndefined(i.tableID)&&!this._dupDetails&&(u.afterFormat=this.getHashCodeClassAsArray(r),f._intrnlReq||(f._completeAction(u),f._trigActionComplete(u)))))},updateDecimalPlaces:function(i,r){var u=this.XLObj;if(u.model.allowCellFormatting&&u.model.formatSettings.allowDecimalPlaces&&!u.model.isReadOnly){var p,h,w,l,s,e,f,a=0,o={},v,c=u.getActiveSheetIndex(),k=u.getSheet(c),d=u._dataContainer,y={action:"decimal",reqType:"cell-format",sheetIndex:c,oprType:"format"},b=[];for(r=u._getRangeArgs(r,"object"),l=u._getSelectedCells(c,r).selCells,p=l.length;a<p;)s=l[a].rowIndex,e=l[a].colIndex,f=u.getRangeData({range:[s,e,s,e]})[0],h={rowIndex:s,colIndex:e,afterFormat:{},beforeFormat:{}},v=u._dataContainer.sheets[c][s][e],n.extend(!0,h.beforeFormat,v),u.isNumber(f.value)&&(u.isUndefined(f.decimalPlaces)&&(f.decimalPlaces=u._decimalCnt(f.value)),o.type=f.type===t.Spreadsheet.CellType.General?t.Spreadsheet.CellType.Number:f.type,o.decimalPlaces=f.decimalPlaces=i==="DecreaseDecimal"?f.decimalPlaces>0?f.decimalPlaces-1:f.decimalPlaces:f.decimalPlaces+1,o.formatStr=u._getFormatString(o.type,o.decimalPlaces),w=this._format(f.value,{formatStr:o.formatStr,type:o.type,thousandSeparator:f.thousandSeparator,decimalPlaces:o.decimalPlaces}),o.value2=w,u.XLResize&&u.XLResize._getContentWidth(e,c,0,u.getSheet(c).usedRange.rowIndex)>=k.columnsWidthCollection[e]-5&&(u._dupDetails=!0,u.XLResize._fitWidth(e),u._dupDetails=!1,u.XLSelection.refreshSelection(),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement()),u.XLEdit._updateDataContainer({rowIndex:s,colIndex:e},{dataObj:o}),h.beforeFormat.Oprtype=o.type),f=u.getRangeData({range:[s,e,s,e]})[0],v=u._dataContainer.sheets[c][s][e],n.extend(!0,h.afterFormat,v),h.afterFormat.Oprtype=h.beforeFormat.Oprtype,b.push(h),a++;y.selectedCell=b;u._isUndoRedo||(u._completeAction(y),u._trigActionComplete(y))}},getFormatClass:function(n,t){var i=t?"e-border":"e-format",r=new RegExp("\\b"+i+".*?\\b","g");return n.indexOf(i)!==-1?n.match(r)[0]:""},getHashCodeClassAsArray:function(n){var r,e,u,t=0,f={format:[]},i=this.XLObj,o=i.getActiveSheetIndex(),s=["topborder","leftborder"];for(n=i._toIntrnlRange(n,o),n=n?i.swapRange(n):i.getSheet(o).selectedRange,r=i.getRange(n),e=r.length;t<e;)u=r[t].className,f.format.push(this.getFormatClass(u)+" "+this.getFormatClass(u,!0)),t++;for(t=2;t--;)f[s[t]]=this._getBorderArray(n,s[t]);return f},_getBorderArray:function(n,t){var i,r=0,u=[],o=this.XLObj,f="topborder",s=t===f?n[0]-1:n[1]-1,e;if(s>=0)for(e=t===f?o.getRange([n[0]-1,n[1],n[0]-1,n[3]]):o.getRange([n[0],n[1]-1,n[2],n[1]-1]),i=e.length;r<i;)u.push(this.getFormatClass(e[r].className,!0)),r++;else for(i=t===f?n[3]-n[1]+1:n[2]-n[0]+1;i--;)u.push("");return u},removeStyle:function(t,i){var u=this.XLObj;if(!u.model.isReadOnly){i=i||{cellStyle:!0,tableStyle:!0,format:!0,border:!0};var w,nt,e,r,o,b,l,h,f,c,s,k,a,y,d=0,v=this._borderPosition,tt=u._getSheetIndex(i.sheetIdx),p=u.getSheet(tt),g=u.getActiveSheetIndex();for(t=u._getRangeArgs(t,"object"),w=u._getSelectedCells(tt,t).selCells,nt=w.length,i.sheetIdx&&i.sheetIdx!=g&&u.gotoPage(i.sheetIdx,!1);d<nt;)a=!1,r=w[d],i.skipHiddenRow&&u._isHiddenRow(r.rowIndex,i.sheetIdx)||(i.format&&(i.cellStyle&&i.tableStyle?u.XLEdit._clearDataContainer({cellIdx:r,property:["format","formats","tformats"],sheetIdx:i.sheetIdx}):(i.cellStyle&&u._hasCellStyle(r.rowIndex,r.colIndex,i.sheetIdx)||i.tableStyle&&u._isTableRange(r.rowIndex,r.colIndex,i.sheetIdx))&&(k=[i.cellStyle?"formats":"tformats"],b=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,i.cellStyle?"tformats":"formats",i.sheetIdx),b?(o=this.getFormatHashCode(b),this._updateFormatClass(r,o)):k.push("format"),u.XLEdit._clearDataContainer({cellIdx:r,property:k,sheetIdx:i.sheetIdx}))),i.border&&(i.cellStyle&&i.tableStyle?(l=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"borders",i.sheetIdx)||{},h=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(h,l),v[0]in h&&r.rowIndex&&(e=r.rowIndex-1,o=u.XLEdit.getPropertyValue(e,r.colIndex,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),c=u.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(e,r.colIndex,s,f,"bottom","bottom",!0),a=!0),v[1]in h&&(y=!0,e=r.colIndex+1,o=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),e<p.colCount&&(c=u.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),v[3]in s&&(f.right!=s.left&&(f.right=s.left,o=this._getBorderHashCode(f),this._updateFormatClass(r,o,!0)),y=!1)),y&&(delete f.right,u.getObjectLength(f)?(o=this._getBorderHashCode(f),this._updateFormatClass(r,o,!0)):u.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),v[2]in h&&(y=!0,e=r.rowIndex+1,o=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),e<p.rowCount&&(c=u.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),v[0]in s&&(f.bottom!=s.top&&(f.bottom=s.top,o=this._getBorderHashCode(f),this._updateFormatClass(r,o,!0)),y=!1)),y&&(delete f.bottom,u.getObjectLength(f)?(o=this._getBorderHashCode(f),this._updateFormatClass(r,o,!0)):u.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),v[3]in h&&r.colIndex&&(e=r.colIndex-1,o=u.XLEdit.getPropertyValue(r.rowIndex,e,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),c=u.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(r.rowIndex,e,s,f,"right","right",!0),a=!0),a&&u.XLEdit._clearDataContainer({cellIdx:r,property:["borders","tborders"]})):i.cellStyle?(l=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"borders",i.sheetIdx)||{},h=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tborders",i.sheetIdx)||{},v[0]in l&&r.rowIndex&&(e=r.rowIndex-1,o=u.XLEdit.getPropertyValue(e,r.colIndex,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),c=u.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),"bottom"in s?l.bottom===f.bottom&&("top"in h?(f.bottom=h.top,o=this._getBorderHashCode(f),this._updateFormatClass({rowIndex:e,colIndex:r.colIndex},o,!0)):s.bottom!=f.bottom&&(f.bottom=s.bottom,o=this._getBorderHashCode(f),this._updateFormatClass({rowIndex:e,colIndex:r.colIndex},o,!0))):this._remStyle(e,r.colIndex,s,f,"top","bottom"),a=!0),v[1]in l&&(e=r.colIndex+1,o=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),e<p.colCount?(c=u.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),"left"in s?l.right===f.right&&("right"in h?(f.right=h.right,o=this._getBorderHashCode(f),this._updateFormatClass(r,o,!0)):s.left!=f.right&&(f.right=s.left,o=this._getBorderHashCode(f),this._updateFormatClass(r,o,!0))):this._remStyle(r.rowIndex,r.colIndex,h,f,"right","right")):this._remStyle(r.rowIndex,r.colIndex,h,f,"right","right"),a=!0),v[2]in l&&(e=r.rowIndex+1,o=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),e<p.rowCount?(c=u.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),"top"in s?l.bottom===f.bottom&&("bottom"in h?(f.bottom=h.bottom,o=this._getBorderHashCode(f),this._updateFormatClass(r,o,!0)):s.top!=f.bottom&&(f.bottom=s.top,o=this._getBorderHashCode(f),this._updateFormatClass(r,o,!0))):this._remStyle(r.rowIndex,r.colIndex,h,f,"bottom","bottom")):this._remStyle(r.rowIndex,r.colIndex,h,f,"bottom","bottom"),a=!0),v[3]in l&&r.colIndex&&(e=r.colIndex-1,o=u.XLEdit.getPropertyValue(r.rowIndex,e,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),c=u.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),"right"in s?l.left===f.right&&("left"in h?(f.right=h.left,o=this._getBorderHashCode(f),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:e},o,!0)):s.right!=f.right&&(f.right=s.right,o=this._getBorderHashCode(f),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:e},o,!0))):this._remStyle(r.rowIndex,e,h,f,"left","right"),a=!0),a&&u.XLEdit._clearDataContainer({cellIdx:r,property:["borders"]})):i.tableStyle&&(l=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"borders",i.sheetIdx)||{},h=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tborders",i.sheetIdx)||{},"top"in h&&!("top"in l)&&r.rowIndex&&(e=r.rowIndex-1,o=u.XLEdit.getPropertyValue(e,r.colIndex,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),c=u.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(e,r.colIndex,s,f,"bottom","bottom",!0),a=!0),"right"in h&&!("right"in l)&&(e=r.colIndex+1,o=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),e<p.colCount?(c=u.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(r.rowIndex,r.colIndex,s,f,"left","right",!0)):(delete f.right,u.getObjectLength(f)?(o=this._getBorderHashCode(f),this._updateFormatClass(r,o,!0)):u.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),"bottom"in h&&!("bottom"in l)&&(e=r.rowIndex+1,o=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),e<p.rowCount?(c=u.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(r.rowIndex,r.colIndex,s,f,"top","bottom",!0)):(delete f.bottom,u.getObjectLength(f)?(o=this._getBorderHashCode(f),this._updateFormatClass(r,o,!0)):u.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),"left"in h&&!("left"in l)&&r.colIndex&&(e=r.colIndex-1,o=u.XLEdit.getPropertyValue(r.rowIndex,e,"border",i.sheetIdx),f=this.getBorderFromHashCode(o),c=u.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=u.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(r.rowIndex,e,s,f,"right","right",!0),a=!0),a&&u.XLEdit._clearDataContainer({cellIdx:r,property:["tborders"]})))),d++;i.sheetIdx&&i.sheetIdx!=g&&u.gotoPage(g,!1)}},_remStyle:function(n,t,i,r,u,f,e){var o=this.XLObj;u in i?e&&i[u]==r[f]||(r[f]=i[u],this._updateFormatClass({rowIndex:n,colIndex:t},this._getBorderHashCode(r),!0)):(delete r[f],o.getObjectLength(r)?this._updateFormatClass({rowIndex:n,colIndex:t},this._getBorderHashCode(r),!0):o.XLEdit._clearDataContainer({cellIdx:{rowIndex:n,colIndex:t},property:["border"]}))},_refreshStyles:function(t,i,r){for(var e,f,o,h="format",s="border",a=!i||i===h,v=!i||i===s,u=this.XLObj,c=u._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]}),l=c.length;l--;)cellIdx=c[l],a&&(e=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"formats")||{},f=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"tformats")||{},n.extend(f,e),u.getObjectLength(f)?(o=this._createFormatClass(f),this._updateFormatClass(cellIdx,o,!1)):u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,h)&&u.XLEdit._clearDataContainer({cellIdx:cellIdx,property:[h]})),v&&(e=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"borders")||{},f=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"tborders")||{},n.extend(f,e),u.getObjectLength(f)?(o=this._getBorderHashCode(f),this._updateFormatClass(cellIdx,o,!0)):u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,s)&&(r,style=this.getBorderFromHashCode(hCode),"right"in style,u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,s)&&u.XLEdit._clearDataContainer({cellIdx:cellIdx,property:[s]})))},updateFormat:function(n,t){var u=this.XLObj,i,f,e,r;if(!u.model.isReadOnly){for(e=["topborder","leftborder"],r=n.format,t=u._getRangeArgs(t,"object"),f=u._getSelectedCells(u.getActiveSheetIndex(),t).selCells,i=f.length;i--;)r[i]&&this._createFormatClass(this.getFormatFromHashCode(r[i]),r[i]),this._updateHashCodeClass(f[i],r[i]);for(i=2;i--;)this._updateBorderClass(t,n[e[i]],e[i])}},_updateBorderClass:function(n,t,i){var r,u,f=this.XLObj,e="topborder",o=i===e?n[0]-1:n[1]-1;if(o>=0)for(u=i===e?f._getSelectedRange({rowIndex:n[0]-1,colIndex:n[1]},{rowIndex:n[0]-1,colIndex:n[3]}):f._getSelectedRange({rowIndex:n[0],colIndex:n[1]-1},{rowIndex:n[2],colIndex:n[1]-1}),r=u.length;r--;)this._createFormatClass({border:this.getBorderFromHashCode(t[r])},t[r]),this._updateFormatClass(u[r],t[r],!0)},updateUniqueFormat:function(n,i,r){var e=this.XLObj,o,c,i,f,s,u,h,l;if(!e.model.isReadOnly){for(o=e.getActiveSheetIndex(),c=e.getSheet(o),i=e._getRangeArgs(i,"object"),f=e._getSelectedCells(o,i).selCells,u=f.length;u--;)s=e._isUndoRedo?t.isNullOrUndefined(n[u].format)?"e-format":n[u].format:n,this._createFormatClass(s.indexOf("e-format")>-1?this.getFormatFromHashCode(s):{border:this.getBorderFromHashCode(s)},s,r),this._updateFormatClass(f[u],s),e.XLEdit._updateDataContainer(f[u],{dataObj:{formats:this.getFormatFromHashCode(s)},sheetIdx:o}),(r=="Title"||r=="Heading 4")&&(e._isRowViewable(o,f[u].rowIndex)&&(l=e.getCell(f[u].rowIndex,f[u].colIndex)),h=e._detailsFromGlobalSpan(f[u].rowIndex,f[u].colIndex,"height",e.XLEdit.getPropertyValue(f[u].rowIndex,f[u].colIndex,"value2"),c.columnsWidthCollection[f[u].colIndex]),!(h>=e.model.rowHeight)||e.XLEdit.getPropertyValue(f[u].rowIndex,f[u].colIndex,"wrap")&&e.XLEdit.getPropertyValue(f[u].rowIndex,f[u].colIndex,"merge")||e.XLEdit.getPropertyValue(f[u].rowIndex,f[u].colIndex,"mergeIdx")||(e._updateFormatColl(o,f[u].rowIndex,f[u].colIndex,h),h=e._getFormattedHeight(o,f[u].rowIndex),l&&l.parent().outerHeight(h),e.XLEdit._updateDataContainer({rowIndex:f[u].rowIndex,colIndex:0},{dataObj:{pHeight:c.rowsHeightCollection[f[u].rowIndex],cHeight:h}}),c.rowsHeightCollection[f[u].rowIndex]=h),e.model.allowFreezing&&e.XLFreeze._refreshFRowResize(f[u].rowIndex));e._refreshRangeTRHght(o,e.swapRange(i))}},_hasFormat:function(n){return n?!t.isNullOrUndefined(n.match(/e-format|e-border/)):!1},getFormatHashCode:function(n){var i,u,t="",r=0,f="background-color",e="color",o="font-family",s="font-size",h=["font-style","text-decoration","vertical-align","text-align","font-weight"],l=h.length,a=["FontStyle","TextDecoration","VerticalAlign","TextAlign","FontWeight"],c="text-indent";for(t=(f in n)?n[f].replace("#",""):"6N",t+=(e in n)?n[e].replace("#",""):"6N",(o in n)?(i=this._getStyleCode("FontFamily",n[o]),t+=i||"2N"):t+="2N",t+=(s in n)?this._getFontCode(n[s]):"2N";r<l;)u=h[r],u in n?(i=this._getStyleCode(a[r],n[u]),t+=i||"1N"):t+="1N",r++;return t.endsWith("N")||(t=t+"N"),c in n&&(t+=n[c].replace(/pt|-|\+/g,"")),"e-format"+t},getFormatFromHashCode:function(n){var t,f,e,o,s,h,c,l,u,a,i,r={},v="e-format";if(n=n||"",!n.indexOf(v)){for(e="pt",t=f=0,a=["FontStyle","TextDecoration","VerticalAlign","TextAlign"],c=["font-style","text-decoration","vertical-align","text-align"],l=c.length,i=n.replace(v,"").split("N"),i[t].length===1?t++:(r["background-color"]="#"+i[t].slice(0,6),i[t]=i[t].substr(6)),i[t].length===1?t++:(r.color="#"+i[t].slice(0,6),i[t]=i[t].substr(6)),u=i[t].length,u===1?t++:(s="FontFamily",o="font-family",u===2?(r[o]=this._getCodeStyle(s,i[t].slice(0,1)+"1N"),t++):(r[o]=this._getCodeStyle(s,i[t].slice(0,2)),i[t]=i[t].substr(2))),u=i[t].length,u===1?t++:(h="font-size",u===2?(r[h]=i[t].slice(0,1)+e,t++):(r[h]=i[t].slice(0,2)+e,i[t]=i[t].substr(2)));f<l;)i[t].length===1?t++:(r[c[f]]=this._getCodeStyle(a[f],i[t].slice(0,1)),i[t]=i[t].substr(1)),f++;i[t]==="2"&&(r["font-weight"]="bold");t++;i[t]&&(r["text-indent"]=i[t]+e)}return r},getBorderFromHashCode:function(n,t){var r,i=0,u={},e="e-border",f=this._borderPosition;return n=n||"",n.indexOf(e)||(r=n.replace(e,"").split("N"),r[i].length>1?(u[f[1]]=this._concatBorderCode(r[i]),r[i]=r[i].substr(8)):i+=3,r[i].length>1?(u[f[2]]=this._concatBorderCode(r[i]),t&&(r[i]=r[i].substr(8))):i+=3,t&&(r[i].length>1?(u[f[0]]=this._concatBorderCode(r[i]),r[i]=r[i].substr(8)):i+=3,r[i].length>1&&(u[f[3]]=this._concatBorderCode(r[i])))),u},_formatPainter:function(){var n=this.XLObj,f,e,h;if(n.model.allowFormatPainter&&n.model.allowCellFormatting){var c=n.getActiveSheetIndex(),t,i,o=0,s=n.getSheet(c),r=s._startCell,u=s._endCell;for(this._rowLength=u.rowIndex-r.rowIndex+1,this._colLength=u.colIndex-r.colIndex+1,f=this._rowLength,e=this._colLength,h=n.getRangeData({range:[r.rowIndex,r.colIndex,u.rowIndex,u.colIndex],property:["value","value2","type","wrap","formatStr","thousandSeparator","decimalPlaces","cFormatRule","hyperlink","format","cellType"]}),this._getEformatClass=new Array(f),t=0;t<f;t++)for(this._getEformatClass[t]=new Array(e),i=0;i<e;i++)this._getEformatClass[t][i]={rangeData:h[o]},o++}},_fPMouseUp:function(){var s,a,k,g,n=this.XLObj,e=n.getActiveSheetIndex(),w=n.getSheet(e),nt=n._getContent(e).find("div.e-content"),d=0,tt,u=w._selectedCells,it=w._startCell,rt=w._endCell,h,c,i=0,ut=0,l,v,ft,et,b,ot=rt.rowIndex-it.rowIndex,st=rt.colIndex-it.colIndex,o,ct=n.XLEdit,r,y=w.selectedRange,p=n.getRangeData({range:y,property:["wrap","hyperlink","value","value2","cFormatRule","format","cellType","formats","formatStr","decimalPlaces","thousandSeparator","type"]}),f={sheetIndex:e,reqType:"format-painter",range:y,beforeData:p,bFormat:this.getHashCodeClassAsArray(y),unwrapCells:[],wrapCells:[]},ht=n.element.find("#"+n._id+"_Ribbon_Home_Clipboard_FormatPainter");for(n._dupDetails=!0,h=0;h<=ot;h++){for(ut++,c=0;c<=st;c++){if(d++,o=n._getAlphaRange(e,u[i].rowIndex,u[i].colIndex,u[i].rowIndex,u[i].colIndex),a=u[i],r=this._getEformatClass[h][c],this.removeStyle([u[i].rowIndex,u[i].colIndex,u[i].rowIndex,u[i].colIndex],{cellStyle:!0,tableStyle:!1,format:!0}),s={type:r.rangeData.type?r.rangeData.type:"general"},r.rangeData.format&&(s.style=this.getFormatFromHashCode(r.rangeData.format)),r.rangeData.formatStr&&(s.formatStr=r.rangeData.formatStr),r.rangeData.decimalPlaces&&(s.decimalPlaces=r.rangeData.decimalPlaces),r.rangeData.thousandSeparator&&(s.thousandSeparator=r.rangeData.thousandSeparator),this.format(s,o),r.rangeData.cellType&&(k=n._dataContainer.sheetCellType[r.rangeData.cellType],k.text="",n.XLCellType._renderControls(u[i].rowIndex,u[i].colIndex,e,k)),!t.isNullOrUndefined(r.rangeData.cFormatRule))for(b=0,et=r.rangeData.cFormatRule.length;b<et;b++)tt=r.rangeData.cFormatRule[b],v=tt.split("_"),ft=v[5],v[v.indexOf(ft)]=o,n._dataContainer.cFormatRule=v.join("_"),l=n._dataContainer.cFormatRule.split("_"),n.XLCFormat._cFormat(l[0],l[2],l[3],l[4],l[5]);if(p[i].wrap&&!r.rangeData.wrap?(n.setWrapText("unwrap",o),f.wrapCells.push({rowIndex:u[i].rowIndex,colIndex:u[i].colIndex})):!p[i].wrap&&r.rangeData.wrap&&(n.setWrapText("wrap",o),f.unwrapCells.push({rowIndex:u[i].rowIndex,colIndex:u[i].colIndex})),r.rangeData.hyperlink&&!p[i].hyperlink?this.format({style:{"text-decoration":"underline",color:n._hlColor}},o):!r.rangeData.hyperlink&&p[i].hyperlink&&(this.format({style:{"text-decoration":"none"}},o),n.addClass(n.getCell(a.rowIndex,a.colIndex,e).find("a"),ct.getPropertyValue(a.rowIndex,a.colIndex,"format",e))),i++,d===st+1){d=0;break}this._colLength===c+1&&(c=-1)}if(ut===ot+1)break;this._rowLength===h+1&&(h=-1)}this._formatEnable=!1;nt.addClass("e-ss-cursor");nt.removeClass("e-ss-fpcursor");ht.length&&ht.ejToggleButton("option",{toggleState:!1});n._dupDetails=!1;f.afterData=n.getRangeData({range:y,property:["wrap","hyperlink","value","value2","cFormatRule","format","cellType","formats","formatStr","decimalPlaces","thousandSeparator","type"]});f.aFormat=this.getHashCodeClassAsArray(y);n.XLSelection.refreshSelection();n.XLDragFill.positionAutoFillElement();g={sheetIndex:f.sheetIndex,currData:f.afterData,currFormat:f.aFormat,reqType:f.reqType,range:f.range,prevData:f.beforeData,prevFormat:f.bFormat,unwrapCells:f.unwrapCells,wrapCells:f.wrapCells};n._isUndoRedo||(n._completeAction(f),n._trigActionComplete(g))},_getFormatObj:function(n){if("type"in n||"formatStr"in n){var t={},i="thousandSeparator";t.formatStr="formatStr"in n?n.formatStr:this.XLObj._getFormatString(n.type,n.decimalPlaces);t.decimalPlaces="decimalPlaces"in n?n.decimalPlaces:["currency","accounting","number"].indexOf(n.type)!==-1?parseInt(t.formatStr.replace(/{0:|[A-Z]|}/g,"")):0;i in n?t[i]=n[i]:n.type==="number"&&(t[i]=!0);n.format=t}return"style"in n&&n.style.border&&(n.border=n.style.border,delete n.style.border,this.XLObj.getObjectLength(n.style)||delete n.style),n},_createFormatClass:function(n,t,i){var r,u=this.XLObj._dataContainer.hashCode;return(t=t||this.getFormatHashCode(n),u.indexOf(t)!==-1)?t:(r=this._getCssPropertyAsString(n),this._writeCssRules(t,r,i),u.push(t),t)},_writeCssRules:function(n,t,i,r){var u=document.getElementById(this.XLObj._id+"_sscustomformat"),f=".e-spreadsheet .e-spreadsheetmainpanel ."+n+" {"+t+"}";r||(u.styleSheet?u.styleSheet.cssText+=f:u.appendChild(document.createTextNode(f)));i&&(f=f.replace(".e-spreadsheetmainpanel ",""),u.styleSheet?u.styleSheet.cssText+=f:u.appendChild(document.createTextNode(f)))},_getCssPropertyAsString:function(n){var t="",i,r,u;if("border"in n){i=n.border;for(r in i)n["border-"+r]=i[r];delete n.border}for(u in n)t=t+(u+":"+n[u]+";");return t},_splitBorderCode:function(n){return n=n.split(" "),n[0].replace("px","")+this._getStyleCode("BorderStyle",n[1])+n[2].replace("#","")},_concatBorderCode:function(n){return n.substr(0,1)+"px "+this._getCodeStyle("BorderStyle",n.substr(1,1))+" #"+n.substr(2,6)},_getCodeStyle:function(n,i){n=t.Spreadsheet[n];for(var r in n)if(n.hasOwnProperty(r)&&n[r]===i)return r;return""},_getStyleCode:function(n,i){return i=i||"",t.Spreadsheet[n][i.toLowerCase()]},_getFontCode:function(n){var t=n.replace(/pt|-|\+/g,"");return t.length===2?t:t.length===1?t+"1N":"2N"},_getExtendedFormat:function(t,i,r){var u=this.XLObj.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"formats")||{};return r?(n.extend(i,u),{format:i}):u["text-indent"]&&i["text-align"]?(delete u["text-indent"],delete u["text-align"],n.extend(i,u),{format:i}):(n.extend(u,i),{format:u})},_updateHashCodeClass:function(n,t){var i,r,u=this.XLObj,f={},e=u._formatRegx,o=u._borderRegx;t&&(i=t.indexOf("e-format")>-1,r=t.indexOf("e-border")>-1,i&&(f.format=t.match(e)[0]),r&&(f.border=t.match(o)[0]),(i||r)&&u.XLEdit._updateDataContainer({rowIndex:n.rowIndex,colIndex:n.colIndex},{dataObj:f}))},_updateFormatClass:function(n,t,i){t&&(t.indexOf("e-format")>-1||t.indexOf("e-border")>-1)&&this.XLObj.XLEdit._updateDataContainer(n,{dataObj:i?{border:t}:{format:t}})},_applyBorderCss:function(n,t){var e=this._borderPosition,h=e[0],o=e[1],s=e[2],c=e[3],i=t[0],r=t[1],u=t[2],f=t[3];h in n&&(i?this._updateBorder([i-1,r,i-1,f],n,s,!0):this._updateBorderObj([i,r,i,f],n,h));o in n&&this._updateBorder([i,f,u,f],n,o);s in n&&this._updateBorder([u,r,u,f],n,s);c in n&&(r?this._updateBorder([i,r-1,u,r-1],n,o,!0):this._updateBorderObj([i,r,u,r],n,c))},_applyAllBorderCss:function(n,t){var u=this._borderPosition[1],f=this._borderPosition[2],i=t[0],r=t[1],e=t[2],o=t[3];this._updateBorder(t,n,u+" "+f);i&&this._updateBorder([i-1,r,i-1,o],n,f,!0);r&&this._updateBorder([i,r-1,e,r-1],n,u,!0)},_updateBorderObj:function(n,t,i){for(var r,o,u,f,e=n[0],s=n[2];e<=s;){for(r=n[1],o=n[3];r<=o;)f={rowIndex:e,colIndex:r},u=this._extendBorderObj(f,this._parseBorder(t,i).border,this._isFAT),this.XLObj.XLEdit._updateDataContainer(f,{dataObj:this._isFAT?{tborders:u}:{borders:u}}),r++;e++}},_updateBorder:function(t,i,r,u){var v,tt,p,w,h,c,l,b,k,o,e,d,s,g=!1,nt=!1,f=this._borderPosition,y=t[0],it=t[2],rt=i.isGridBorder,a=this.XLObj;for(delete i.isGridBorder;y<=it;){for(v=t[1],tt=t[3];v<=tt;){if(l={rowIndex:y,colIndex:v},p=y,w=v,u?(nt=r===f[2],nt?p++:w++,o=this._parseBorder(i,nt?f[0]:f[3]).border):o=this._parseBorder(i,r).border,rt?u||(e=this._extendBorderObj(l,i,this._isFAT),g=!0):u?(b={rowIndex:p,colIndex:w},e=this._extendBorderObj(b,o,this._isFAT),a.XLEdit._updateDataContainer(b,{dataObj:this._isFAT?{tborders:e}:{borders:e},skipCell:i.skipCell})):(e=this._extendBorderObj(l,this._parseBorder(i,r).border,this._isFAT),g=!0),g&&a.XLEdit._updateDataContainer(l,{dataObj:this._isFAT?{tborders:e}:{borders:e},skipCell:i.skipCell}),!(u&&a.hasSpan(l))){if(h=l.colIndex,r===f[1]&&u&&h)while(h){if(!a.XLEdit.getPropertyValue(0,h,"isCHide"))break;h--}if(c=l.rowIndex,r===f[2]&&u&&c)while(c){if(!a.XLEdit.getPropertyValue(c,0,"isRHide"))break;c--}s=a.XLEdit.getPropertyValue(c,h,"border");s=s?this.getBorderFromHashCode(s):a.XLEdit.getPropertyValue(c,h,"borders")||{};u?(e={},f[1]in s&&(e[f[3]]=s[f[1]]),f[2]in s&&(e[f[0]]=s[f[2]]),o=this._isFAT?n.extend(o,e):n.extend(e,o)):o=this._isFAT?n.extend(o,s):n.extend(s,o);d=this._parseBorder(o,f[1]+" "+f[2],u);k=this._getBorderHashCode(d.border);this._createFormatClass(d,k);this._updateFormatClass({rowIndex:c,colIndex:h},k,!0)}v++}y++}},_extendBorderObj:function(t,i,r){var f=this.XLObj,u=f.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,r?"tborders":"borders")||{};return n.extend(u,i),u},_getBorderHashCode:function(n,t){var i="",r="1N1N6N",u=this._borderPosition,f=u[0],e=u[1],o=u[2],s=u[3];return i=e in n?this._splitBorderCode(n[e]):r,i+=o in n?this._splitBorderCode(n[o]):r,t&&(i+=f in n?this._splitBorderCode(n[f]):r,i+=s in n?this._splitBorderCode(n[s]):r),"e-border"+i},_parseBorder:function(n,t,i){var r,u,f,e,s={border:{}},o=this._borderPosition;for(t=t.split(" "),r=t.length;r--;)f=u=t[r],i&&(f=u===o[1]?o[3]:o[0]),e=n[f],e&&(s.border[u]=e);return s},_refreshTableRowCol:function(n){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),u=r.tableManager,t=u[n.tid];t&&(n.isInsertBefore?n.pos==="row"?(t.range[0]+=n.cnt,t.range[2]+=n.cnt):(t.range[1]+=n.cnt,t.range[3]+=n.cnt):(n.pos==="row"?t.range[2]=t.range[2]+n.cnt:t.range[3]=t.range[3]+n.cnt,i._dupDetails=!0,i.XLFormat._createTable(n.tid,{format:t.format}),i._dupDetails=!1))},_refreshHiddenBorder:function(n,t,i,r){var c,u,s,e,o,k,d,w,nt,it,h,rt,l,v,g,a,b,y,p,tt,f=this.XLObj.XLEdit,ut=this.XLObj.getSheet().usedRange;if(i?(h="bottom",v="top",rt="isRHide",ut=ut.colIndex):(h="right",v="left",rt="isCHide",ut=ut.rowIndex),r){for(w=n,nt=t;nt++;)if(e=i?nt:0,o=i?0:nt,!f.getPropertyValue(e,o,rt))break;while(w){if(e=i?w:0,o=i?0:w,!f.getPropertyValue(e,o,rt))break;w--}for(c=0;c<=ut;c++)i?(e=w,u=k=n,s=o=d=c):(o=w,u=e=k=c,s=d=n),f.getPropertyValue(u,s,"isMHide")&&(u=f.getPropertyValue(u,s,"mergeIdx"),s=u.colIndex,u=u.rowIndex),g=f.getPropertyValue(e,o,"borders"),a=f.getPropertyValue(u,s,"borders"),b=f.getPropertyValue(e,o,"tborders"),y=f.getPropertyValue(k,d,"tborders"),(!g||g&&!g[h])&&(a&&a[v]||(!b||b&&!b[h])&&y&&y[v])&&(it=f.getPropertyValue(e,o,"border"),l=this.getBorderFromHashCode(it),delete l[h],b&&b[h]&&(l[h]=b[h]),l.bottom||l.right?(it=this._getBorderHashCode(l),f._updateDataContainer({rowIndex:e,colIndex:o},{dataObj:{border:it}})):f._clearDataContainer({cellIdx:{rowIndex:e,colIndex:o},property:["border"]})),i?(d=w,u=e=nt,s=o=k=c):(k=w,s=o=nt,u=e=d=c),f.getPropertyValue(u,s,"isMHide")&&(u=f.getPropertyValue(u,s,"mergeIdx"),s=u.colIndex,u=u.rowIndex),p=f.getPropertyValue(u,s,"borders"),tt=f.getPropertyValue(e,o,"tborders"),(!g||g&&!g[h])&&(p&&p[v]||(!b||b&&!b[h])&&tt&&tt[v])&&(l={},(g||f.getPropertyValue(d,k,"border"))&&(it=f.getPropertyValue(d,k,"border"),l=this.getBorderFromHashCode(it)),l[h]=p&&p[v]?p[v]:tt[v],it=this._getBorderHashCode(l),f._updateDataContainer({rowIndex:d,colIndex:k},{dataObj:{border:it}}))}else{if(e=i?n-1:0,o=i?0:n-1,f.getPropertyValue(e,o,rt)){for(w=n-1;w;){if(e=i?w:0,o=i?0:w,!f.getPropertyValue(e,o,rt))break;w--}for(c=0;c<=ut;c++)i?(e=w,s=o=d=c,u=k=n-1):(o=w,u=e=k=c,s=d=n-1),f.getPropertyValue(u,s,"isMHide")&&(u=f.getPropertyValue(u,s,"mergeIdx"),s=u.colIndex,u=u.rowIndex),g=f.getPropertyValue(e,o,"borders"),a=f.getPropertyValue(u,s,"borders"),b=f.getPropertyValue(e,o,"tborders"),y=f.getPropertyValue(k,d,"tborders"),l=this.getBorderFromHashCode(f.getPropertyValue(e,o,"border")),(!g||g&&!g[h]||g&&g[h]!==(l&&l[h]))&&(!b||b&&!b[h]||b&&b[h]&&(f.getPropertyValue(e,o,"border")!==this._getBorderHashCode(b)||a&&a[v]))&&(a&&a[v]||l&&l[h]&&(!a||a&&!a[v])||y&&y[v])&&(e=i?u:s,o=i?s:u,this._showHiddenBorder(w,e,o,c,i));for(c=0;c<=ut;c++)i?(e=u-1,u=k=n,s=d=o=c):(o=s-1,u=e=k=c,s=d=n),f.getPropertyValue(u,s,"isMHide")&&(u=f.getPropertyValue(u,s,"mergeIdx"),s=u.colIndex,u=u.rowIndex),a=f.getPropertyValue(e,o,"borders"),p=f.getPropertyValue(u,s,"borders"),y=f.getPropertyValue(e,o,"tborders"),tt=f.getPropertyValue(k,d,"tborders"),l=this.getBorderFromHashCode(f.getPropertyValue(e,o,"border")),(!a||a&&!a[h]||a&&a[h]!==(l&&l[h]))&&(!y||y&&!y[h]||y&&y[h]&&f.getPropertyValue(k,d,"border")!==this._getBorderHashCode(y))&&(p&&p[v]||l&&l[h]&&(!p||p&&!p[v])||tt&&tt[v])&&(e=i?u:s,o=i?s:u,this._showHiddenBorder(n-1,e,o,c,i))}for(n;n<t;n++)if(nt=n+1,i?(e=nt,o=s=0,u=n):(o=nt,e=u=0,s=n),f.getPropertyValue(e,o,rt)||f.getPropertyValue(u,s,rt))for(c=0;c<=ut;c++)i?(u=nt,s=o=c,e=n):(u=e=c,s=nt,o=n),f.getPropertyValue(u,s,"isMHide")&&(u=f.getPropertyValue(u,s,"mergeIdx"),s=u.colIndex,u=u.rowIndex),a=f.getPropertyValue(e,o,"borders"),p=f.getPropertyValue(u,s,"borders"),y=f.getPropertyValue(e,o,"tborders"),tt=f.getPropertyValue(u,s,"tborders"),l=this.getBorderFromHashCode(f.getPropertyValue(e,o,"border")),(!a||a&&!a[h]||a&&a[h]!==(l&&l[h]))&&(!y||y&&!y[h]||y&&y[h]&&(f.getPropertyValue(e,o,"border")!==this._getBorderHashCode(y)||p&&p[v]))&&(p&&p[v]||l&&l[h]&&(!p||p&&!p[v])||tt&&tt[v])&&(u=i?s:u,this._showHiddenBorder(n,nt,u,c,i))}},_showHiddenBorder:function(n,t,i,r,u){var c,l,a,v,y,p,f,w,e,b,k,d,s,h,o=this.XLObj.XLEdit;u?(a=t,p=r,l=v=i,c=y=n,f="bottom",h="top"):(v=t,y=r,c=a=i,l=p=n,f="right",h="left");w=o.getPropertyValue(c,l,"border");e=this.getBorderFromHashCode(w);e[f]&&delete e[f];s=o.getPropertyValue(c,l,"tborders");k=o.getPropertyValue(a,v,"borders");d=o.getPropertyValue(a,v,"tborders");b=o.getPropertyValue(y,p,"borders");b&&b[f]?e[f]=b[f]:k&&k[h]?e[f]=k[h]:(s&&s[f]||d&&d[h])&&(e[f]=s&&s[f]?s[f]:d[h]);e.bottom||e.right?(w=this._getBorderHashCode(e),o._updateDataContainer({rowIndex:y,colIndex:p},{dataObj:{border:w}})):o._clearDataContainer({cellIdx:{rowIndex:c,colIndex:l},property:["border"]})},_resizeFormatTableMenu:function(){var t=this.XLObj,i=document.getElementById(t._id+"_formatastable");t._tabMode||t._phoneMode?(n("#"+t._id+"_Ribbon").append(n("#"+t._id+"_formatastable").parent()),t._removeClass(i,"e-formatastable"),t.addClass(i,"e-formatastable-adaptive"),i.style.height=t._dlgHeight+"px"):(t._removeClass(i,"e-formatastable-adaptive"),t.addClass(i,"e-formatastable"))},_resizeStyleMenu:function(){var t=this.XLObj,i=document.getElementById(t._id+"_cellstyles");t._tabMode||t._phoneMode?(n("#"+t._id+"_Ribbon").append(n("#"+t._id+"_cellstyles").parent()),t._removeClass(i,"e-cellstyles"),t.addClass(i,"e-cellstyles-adaptive"),i.style.height=t._dlgHeight+"px"):(t._removeClass(i,"e-cellstyles-adaptive"),t.addClass(i,"e-cellstyles"),i.style.height="auto")},_resizeBorderMenu:function(t){var i=this.XLObj,r=i.element.find(".e-bordercontainer"),u;i._phoneMode&&(n("#"+i._id+"_Ribbon").append(n("#"+i._id+"_Ribbon_Border").parent()),r.length?r.show():(this._createBorderDiv(),i.element.find(".e-bordercontainer").show()),i.addClass(r[0],"e-border e-adaptive"),t.cancel=!0,u=n("#"+i._id+"_Ribbon_Home_Font_Border").ejSplitButton("instance"),u.contstatus=!0)},_createBorderDiv:function(){for(var i=this.XLObj,f="<div class='e-ss-bdr-header'><span id ='"+i._id+"_border_back' class = 'e-border-back e-icon e-ss-leftarrow'/><\/div><div class='e-ss-border-content'>",e="",o=t.buildTag("div#"+i._id+"_bordercontainer.e-bordercontainer",{},{display:"none",height:i._responsiveHeight-2}),u=i.XLRibbon._borderMenuData,r=0;r<13;r++)e+="<div class = 'e-bordercell' id="+u[r].id+">"+i._renderDIV("e-ss-border "+u[r].sprite+" e-ss-menu","",u[r].text)+"<\/div>";f+=e+"<\/div>";o.append(n(f));n("#"+i._id+"_Ribbon").append(o);i._on(n("#"+i._id+"_bordercontainer"),"click",i._borderSelectionClick)}};t.Spreadsheet.FontFamily={"angsana new":"11N",arial:"21N","arial black":"31N",batang:"41N","book antiqua":"51N","browallia new":"61N",calibri:"71N",cambria:"81N",candara:"91N",century:"10","comic sans ms":"11",consolas:"12",constantia:"13",corbel:"14","cordia new":"15",courier:"16","courier new":"17",dilleniaupc:"18",dotum:"19",fangsong:"20",garamond:"21",georgia:"22",gulim:"23",gungsuh:"24",kaiti:"25",jasmineupc:"26","malgun gothic":"27",mangal:"28",meiryo:"29","microsoft jhenghei":"30","microsoft yahei":"31",mingliu:"32",mingliu_hkscs:"33","ms gothic":"34","ms mincho":"35","ms pgothic":"36","ms pmincho":"37",pmingliu:"38","pmingliu-extb":"39",simhei:"40",simsun:"41","simsun-extb":"42",tahoma:"43",times:"44","times new roman":"45","trebuchet ms":"46",verdana:"47","yu gothic":"48","yu mincho":"49"};t.Spreadsheet.FontStyle={normal:"1",italic:"2",oblique:"3"};t.Spreadsheet.TextAlign={left:"1",right:"2",center:"3",justify:"4"};t.Spreadsheet.VerticalAlign={top:"1",middle:"2",bottom:"3"};t.Spreadsheet.TextDecoration={none:"1",underline:"2",overline:"3","line-through":"4","line-through underline":"5"};t.Spreadsheet.FontWeight={normal:"1",bold:"2"};t.Spreadsheet.BorderStyle={solid:"1",dashed:"2",dotted:"3"};t.Spreadsheet.CellFormat={number:"{0:N2}",currency:"{0:C2}",accounting:"{0:C2}",percentage:"{0:P2}",shortdate:"{0:M/d/yyyy}",longdate:"{0:dddd, MMMM dd, yyyy}",time:"{0:h:mm:ss tt}",scientific:"{0:N2}"}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellType=function(n){this.XLObj=n;this._isIntrnlUpdate=!1};t.spreadsheetFeatures.cellType.prototype={_renderControls:function(i,r,u,f,e){var ft,ot,tt,s,g,w;if(f){var h,c,y,it,b,o=this.XLObj,et=o._browserDetails.name,a,l=o._getSheetIndex(u),rt=o.getCell(i,r,l),st=o.getSheet(l),v=o.XLEdit.getPropertyValue(i,r,"value2",l),nt=f.type,k=o._generateHeaderText(r+1),d=o._dataContainer.sheetCellType,ct=o._getColWidth(r,u),ht=o._getRowHeight(i,u),ut=o.XLEdit.getPropertyValue(i,r,"cellType"),p=ut>-1?ut:o.getObjectLength(d);o._textClip(i,r,"delete","",!0);o._textClip(i,r,"add","");rt&&(c=rt[0]);o.addClass(c,"e-cellreadonly");o._dupDetails||(ut?f.isChecked=d[p].isChecked:st.cellTypes.push({range:o._getAlphaRange(u,i,r,i,r),settings:f}));switch(nt){case"Button":h=o._id+"_btn_"+l+k+(i+1);o.XLFormat._writeCssRules("e-btncls"+i+r,"border: 0px; vertical-align: middle;padding: 0px;color:"+f.color+";background:"+f["background-color"]+";",!0,!0);c&&(c.innerHTML="<button id ="+h+' class = "e-btncls'+i+r+'"><\/button>');c&&(et==="mozilla"||et==="msie")&&(o.addClass(c,"e-btnhgt"),o.addClass(rt.parents(".e-table")[0],"e-btnhgt"));e||(y={type:nt,id:h,text:f.text||v||f.type+k+(i+1),color:f.color||"","background-color":f["background-color"]||""},d[p]=y,o.XLEdit._updateDataContainer({rowIndex:i,colIndex:r},{dataObj:{cellType:p},sheetIdx:l}));n("#"+h).ejButton({type:"button",width:"100%",height:"100%",text:f.text||v||f.type+k+(i+1),create:n.proxy(this._onButtonCreate),click:n.proxy(this.onButtonClick),cssClass:f["class"]||""});break;case"CheckBox":h=o._id+"_chk_"+l+k+(i+1);c&&(c.innerHTML="<input id ="+h+' style = "" />');e||(y={type:nt,id:h,isChecked:f.isChecked||v&&v.toLowerCase()==="true"||!1},d[p]=y,it=o.XLEdit._parseValue(y.isChecked,{rowIndex:i,colIndex:r}),it.cellType=p,o.XLEdit._updateDataContainer({rowIndex:i,colIndex:r},{dataObj:it,sheetIdx:l}),c&&(c.lastChild.textContent=""));n("#"+h).ejCheckBox({size:"small",change:n.proxy(this.onActiveStateChange),checked:f.isChecked,cssClass:f["class"]||""});break;case"DropDownList":if(a=f.dataSourceSheetIndex||l,h=o._id+"_drpdwn_"+l+k+(i+1),b=f.dataSourceRange&&o.getRangeIndices(f.dataSourceRange),c&&(c.innerHTML="<input id ="+h+" />"),a===l||o.getSheet(a)._isLoaded||o._initSheet(a),o.isUndefined(f.selectedIndex)&&v)for(ft=f.dataSource||o.getRangeData({range:b,sheetIdx:a}),ot=f.field=f.field||"value2",tt=ft.length;--tt>=0;)if(ft[tt][ot]===v){f.selectedIndex=tt;break}if(e||(y={type:nt,id:h,text:v,style:"",dataSource:f.dataSource||"",dataSourceRange:f.dataSourceRange||"",selectedIndex:f.selectedIndex>-1?f.selectedIndex:-1,dataSourceSheetIndex:a},d[p]=y,o.XLEdit._updateDataContainer({rowIndex:i,colIndex:r},{dataObj:{cellType:p},sheetIdx:l})),f.dataSourceRange)if(s=o._getSelectedRange({rowIndex:b[0],colIndex:b[1]},{rowIndex:b[2],colIndex:b[3]}),g=o.XLEdit._getPropWithCellIdx([s[0].rowIndex,s[0].colIndex,s[s.length-1].rowIndex,s[s.length-1].colIndex],"ddlRange",a),g.length===0)o.updateUniqueData({ddlRange:[{rowIndex:i,colIndex:r,sheetIndex:l}]},[s[0].rowIndex,s[0].colIndex,s[s.length-1].rowIndex,s[s.length-1].colIndex],"",a);else for(w=0;w<s.length;w++)g=o.XLEdit.getPropertyValue(s[w].rowIndex,s[w].colIndex,"ddlRange",a),g?(g.push({rowIndex:i,colIndex:r}),o.XLEdit._updateDataContainer({rowIndex:s[w].rowIndex,colIndex:s[w].colIndex},{dataObj:{ddlRange:g},sheetIdx:a})):o.XLEdit._updateDataContainer({rowIndex:s[w].rowIndex,colIndex:s[w].colIndex},{dataObj:{ddlRange:[{rowIndex:i,colIndex:r}]},sheetIdx:a});n("#"+h).ejDropDownList({width:"100%",height:o.model.rowHeight-1,change:n.proxy(this.onActiveValueChange),dataSource:f.dataSource||o.getRangeData({range:b,sheetIdx:a}),fields:{text:f.field||"value2"},watermarkText:f.watermarkText||"Select an option",cssClass:f["class"]||"",selectedIndex:f.selectedIndex>-1?f.selectedIndex:-1,beforePopupShown:n.proxy(this._onBeforePopupOpen)});break;case"DatePicker":h=o._id+"_dp_"+l+k+(i+1);c&&(c.innerHTML="<input id ="+h+' style = "height:'+(ht-1)+'px" />');e||(y={type:nt,id:h,text:v,style:""},d[p]=y,o.XLEdit._updateDataContainer({rowIndex:i,colIndex:r},{dataObj:{cellType:p},sheetIdx:l}));n("#"+h).ejDatePicker({width:"100%",height:o.model.rowHeight-1,value:f.value||v&&t.parseDate(v)||new Date,create:n.proxy(this._onDateCreate),change:n.proxy(this.onDateChange),cssClass:f["class"]||""})}}},addCellTypes:function(n,t,i){var r=this.XLObj;r.model.allowCellType&&(r.model.isReadOnly||(Array.isArray(n)&&(n=r._getAlphaRange(i,n[0],n[1],n[2],n[3])),this._rangeCellTypes([{range:n,settings:t}],i,!0)))},_rangeCellTypes:function(i,r,u){var w,at,tt,vt,ut,ot,st,o,yt;if(i){var y,f=this.XLObj,it,ft,b,v=[],ht=f._browserDetails.name,s=f._getSheetIndex(r),h,ct=f._dataContainer,g,e,a,k,nt,c,et,rt,d=f.getSheet(s),lt=0,l,p;for((u||!d._isLoaded)&&(lt=d.cellTypes.length,t.merge(d.cellTypes,i),i=d.cellTypes),w=lt,at=d.cellTypes.length;w<at;w++)if(et=f.getRangeIndices(i[w].range),e=i[w].settings,g=f._getSelectedRange({rowIndex:et[0],colIndex:et[1]},{rowIndex:et[2],colIndex:et[3]}),g.length===1)f._dupDetails=!0,this._renderControls(g[0].rowIndex,g[0].colIndex,s,e),f._dupDetails=!1;else{for(tt=0,vt=g.length;tt<vt;tt++){b=e.dataSourceSheetIndex||s;l=g[tt].rowIndex;p=g[tt].colIndex;f._textClip(l,p,"delete","",!0);f._textClip(l,p,"add");rt=f.getObjectLength(ct.sheetCellType);a=f._isRowViewable(s,l)?f.getCell(l,p,s)[0]:null;y=f.XLEdit.getPropertyValue(l,p,"value2",s);a&&(a.innerHTML="");f._hasClass(a,"e-cellreadonly")||f.addClass(a,"e-cellreadonly");ft=f._generateHeaderText(p+1);switch(e.type){case"Button":k=f._id+"_btn"+w+"_"+s+ft+(l+1);f.XLFormat._writeCssRules("e-btncls"+l+p,"border: 0px; vertical-align: middle; padding: 0px;color:"+(e.color||"")+";background:"+(e["background-color"]||"")+";",!0,!0);a&&(a.innerHTML="<button id ="+k+' type="button" class = "e-btncls'+l+p+'"><\/button>');(a&&ht==="mozilla"||ht==="msie")&&(f.addClass(a,"e-btnhgt"),f.addClass($cell.parents(".e-table")[0],"e-btnhgt"));(u||!d._isLoaded)&&(h={type:e.type,id:k,text:e.text||y||e.type+f._generateHeaderText(g[tt].colIndex+1)+(g[tt].rowIndex+1),color:e.color||"","background-color":e["background-color"]||""},it={cellType:rt});break;case"CheckBox":k=f._id+"_chk"+w+"_"+s+ft+(l+1);a&&(a.innerHTML="<input id ="+k+" />");(u||!d._isLoaded)&&(y&&["false","true","yes","no"].indexOf(y.toLowerCase())===-1&&(y=""),h={type:e.type,id:k,isChecked:e.isChecked||y||!1},it=f.XLEdit._parseValue(h.isChecked,{rowIndex:l,colIndex:p}),it.cellType=rt,h.isChecked.toString().toLowerCase()==="true"&&v.push({type:h.type,id:h.id}));a&&(a.lastChild.textContent="");break;case"DropDownList":if(k=f._id+"_drpdwn"+w+"_"+s+ft+(l+1),a&&(a.innerHTML="<input id ="+k+" value = "+y+" />"),h={type:e.type,id:k,style:"",dataSource:e.dataSource||"",dataSourceRange:e.dataSourceRange||"",selectedIndex:e.selectedIndex>-1?e.selectedIndex:"",dataSourceSheetIndex:b},u||!d._isLoaded){if(e.dataSourceRange)if(nt=f.getRangeIndices(e.dataSourceRange),c=f._getSelectedRange({rowIndex:nt[0],colIndex:nt[1]},{rowIndex:nt[2],colIndex:nt[3]}),ut=f.XLEdit._getPropWithCellIdx([c[0].rowIndex,c[0].colIndex,c[c.length-1].rowIndex,c[c.length-1].colIndex],"ddlRange",b),ut.length===0)f.updateUniqueData({ddlRange:[{rowIndex:l,colIndex:p,sheetIndex:s}]},[c[0].rowIndex,c[0].colIndex,c[c.length-1].rowIndex,c[c.length-1].colIndex],"",b);else for(o=0;o<c.length;o++)ut=f.XLEdit.getPropertyValue(c[o].rowIndex,c[o].colIndex,"ddlRange",b),ut?(ut.push({rowIndex:l,colIndex:p,sheetIndex:s}),f.XLEdit._updateDataContainer({rowIndex:c[o].rowIndex,colIndex:c[o].colIndex},{dataObj:{ddlRange:ut},sheetIdx:b})):f.XLEdit._updateDataContainer({rowIndex:c[o].rowIndex,colIndex:c[o].colIndex},{dataObj:{ddlRange:[{rowIndex:l,colIndex:p,sheetIndex:s}]},sheetIdx:b});if(b===s||f.getSheet(b)._isLoaded||f._initSheet(b),f.isUndefined(e.selectedIndex)&&y)for(ot=e.dataSource||f.getRangeData({range:nt,sheetIdx:b}),st=e.field||"value2",e.field||(e.field=st),o=ot.length;--o>=0;){if(ot[o][st]===y){h.selectedIndex=o;break}o==0&&delete h.selectedIndex}h.selectedIndex&&h.selectedIndex>-1&&v.push({type:h.type,id:h.id,selectedIndex:h.selectedIndex});it={cellType:rt}}break;case"DatePicker":k=f._id+"_dp"+w+"_"+s+ft+(l+1);a&&(a.innerHTML="<input id ="+k+" value = "+y+' style = "height:'+(f._getRowHeight(l,s)-1)+'px" />');(u||!d._isLoaded)&&(h={type:e.type,id:k,value:e.value||y&&t.parseDate(y)||new Date},it={cellType:rt},h.value&&v.push({type:h.type,id:h.id,value:h.value}))}(u||!d._isLoaded)&&(ct.sheetCellType[rt]=h,f.XLEdit._updateDataContainer({rowIndex:l,colIndex:p},{dataObj:it,sheetIdx:s}))}switch(e.type){case"Button":n("[id^='"+f._id+"_btn"+w+"_"+s+"']").ejButton({type:"button",width:"100%",height:"100%",text:y,create:n.proxy(this._onButtonCreate),click:n.proxy(this.onButtonClick),cssClass:i["class"]||""});break;case"CheckBox":n("[id^='"+f._id+"_chk"+w+"_"+s+"']").ejCheckBox({change:n.proxy(this.onActiveStateChange),checked:!1,cssClass:i["class"]||""});break;case"DropDownList":n("[id^='"+f._id+"_drpdwn"+w+"_"+s+"']").ejDropDownList({width:"100%",height:f.model.rowHeight-1,change:n.proxy(this.onActiveValueChange),dataSource:e.dataSource||f.getRangeData({range:nt,sheetIdx:b}),fields:{text:e.field||"value2"},watermarkText:e.watermarkText||"Select an option",cssClass:e["class"]||"",selectedIndex:e.selectedIndex>-1?e.selectedIndex:"",beforePopupShown:n.proxy(this._onBeforePopupOpen)});break;case"DatePicker":n("[id^='"+f._id+"_dp"+w+"_"+s+"']").ejDatePicker({width:"100%",height:f.model.rowHeight-1,value:e.value||new Date,create:n.proxy(this._onDateCreate),change:n.proxy(this.onDateChange),cssClass:i["class"]||""})}for(o=0,yt=v.length;o<yt;o++)this._isIntrnlUpdate=!0,v[o].type==="CheckBox"?n("#"+v[o].id).length&&n("#"+v[o].id).ejCheckBox("instance").option("checked",!0):v[o].type==="DropDownList"?n("#"+v[o].id).length&&n("#"+v[o].id).ejDropDownList("instance").option("selectedIndex",v[o].selectedIndex):v[o].type==="DatePicker"&&n("#"+v[o].id).length&&n("#"+v[o].id).ejDatePicker("instance").option("value",v[o].value),this._isIntrnlUpdate=!1}}},removeCellTypes:function(n,t){var r=this.XLObj;if(!r.model.isReadOnly)for(var t=r._getSheetIndex(t),e=r._getRangeArgs(n,"object"),u=r.XLEdit._getPropWithCellIdx(e,"cellType",t),i=0,f=u.length;i<f;i++)this._removeControls(u[i].rowIdx,u[i].colIdx,t)},_removeControls:function(n,t,i,r){var f,u=this.XLObj,i=u._getSheetIndex(i),e=u._dataContainer,s=u.getSheet(i),o;r||(delete e.sheetCellType[e.sheets[i][n][t].cellType],delete e.sheets[i][n][t].cellType,o=this._rangeInColl(u._getAlphaRange(i,n,t,n,t),i),o>-1&&s.cellTypes.splice(o,1));u._isRowViewable(i,n)&&(f=u.getCell(n,t,i)[0],f.innerHTML=u.XLEdit.getPropertyValue(n,t,"value2",i)||"",u._removeClass(f,"e-cellreadonly"))},onActiveValueChange:function(n){var t=this.element.closest(".e-spreadsheet").data("ejSpreadsheet");if(!t.model.isReadOnly){var o=t._dataContainer,s=this.element.closest("td"),h=t.getActiveSheetIndex(),u=t._getCellIdx(s[0]),i=u.rowIndex,r=u.colIndex,f=o.sheetCellType[o.sheets[h][i][r].cellType],e=f.dataSourceRange&&t.getRangeIndices(f.dataSourceRange);f.selectedIndex=n.itemId;t.XLEdit._updateDataContainer({rowIndex:i,colIndex:r},{dataObj:t.XLEdit._parseValue(n.text,{rowIndex:i,colIndex:r})});e&&t.XLEdit.getPropertyValue(e[0]+n.itemId,e[1],"type")==="number"&&t.XLFormat.format({type:"number"},[i,r,i,r]);n.cellIndex=u;n.cellType="dropdownlist";t._trigger("cellSave",n);t.model.allowFormulaBar&&t.updateFormulaBar()}},onActiveStateChange:function(n){var t=this.element.closest(".e-spreadsheet").data("ejSpreadsheet");if(!t.model.isReadOnly&&!t.XLCellType._isIntrnlUpdate){var u=t._dataContainer,f,o=this.element.closest("td"),e=t.getActiveSheetIndex(),i=t._getCellIdx(o[0]),s=t._getRowIdx(i.rowIndex,e),r=i.colIndex;u.sheetCellType[u.sheets[e][i.rowIndex][r].cellType].isChecked=n.isChecked;f=["yes","no"].indexOf(t.XLEdit.getPropertyValue(i.rowIndex,r,"value2").toString().toLowerCase())>-1?n.isChecked?"YES":"NO":n.isChecked.toString().toUpperCase();t.XLEdit._updateDataContainer({rowIndex:i.rowIndex,colIndex:r},{dataObj:t.XLEdit._parseValue(f,{rowIndex:i.rowIndex,colIndex:r})});n.cellIndex=i;n.cellType="checkbox";t._trigger("cellSave",n);t.model.allowFormulaBar&&t.updateFormulaBar()}},_onDateCreate:function(n){var t=this.element.closest(".e-spreadsheet").data("ejSpreadsheet"),o=t._dataContainer,f=this.element.closest("td"),e=t.getActiveSheetIndex(),i=t._getCellIdx(f[0]),r=t._getRowIdx(i.rowIndex,e),u=i.colIndex;t.XLEdit._updateDataContainer({rowIndex:r,colIndex:u},{dataObj:t.XLEdit._parseValue(n.model.value?n.model.value.toLocaleString().split(", ")[0]:"",{rowIndex:r,colIndex:u})})},onDateChange:function(n){var i=this.element.closest(".e-spreadsheet").data("ejSpreadsheet");if(!i.model.isReadOnly){var s=i._dataContainer,e=this.element.closest("td"),o=i.getActiveSheetIndex(),r=i._getCellIdx(e[0]),u=i._getRowIdx(r.rowIndex,o),f=r.colIndex;i.XLEdit._updateDataContainer({rowIndex:u,colIndex:f},{dataObj:i.XLEdit._parseValue(n.model.value?n.model.value.toLocaleString().split(t.isNullOrUndefined(n.model.value.toLocaleString().match(/[,]/))?" ":", ")[0]:"",{rowIndex:u,colIndex:f})});n.cellIndex=r;n.cellType="datepicker";i._trigger("cellSave",n);i.model.allowFormulaBar&&i.updateFormulaBar()}},_onButtonCreate:function(n){var t=this.element.closest(".e-spreadsheet").data("ejSpreadsheet"),o=t._dataContainer,f=this.element.closest("td"),e=t.getActiveSheetIndex(),i=t._getCellIdx(f[0]),r=t._getRowIdx(i.rowIndex,e),u=i.colIndex;t.XLEdit._updateDataContainer({rowIndex:r,colIndex:u},{dataObj:t.XLEdit._parseValue(n.model.text,{rowIndex:r,colIndex:u})})},onButtonClick:function(t){var i=this.element.closest(".e-spreadsheet").data("ejSpreadsheet");i.model.isReadOnly||(t.cellIndex=i._getCellIdx(n(t.target).closest("td")[0]),t.cellType="button",i._trigger("cellClick",t))},_onBeforePopupOpen:function(){var t=this.element.closest(".e-spreadsheet").data("ejSpreadsheet"),u=t.getActiveSheetIndex(),f=t._dataContainer,s=this.element.closest("td"),e=t._getCellIdx(s[0]),h=e.rowIndex,c=e.colIndex,i=f.sheetCellType[f.sheets[u][h][c].cellType],r=i.dataSourceSheetIndex||u,o;t.getSheet(r)._isLoaded||t._initSheet(r);o=i.dataSource||t.getRangeData({range:t.getRangeIndices(i.dataSourceRange),sheetIdx:r});n("#"+i.id).ejDropDownList("instance").option("dataSource",o);n("#"+i.id).ejDropDownList("instance").option("selectedItemIndex",i.selectedIndex)},_rangeInColl:function(n,t){for(var r=this.XLObj,f=r.getSheet(r._getSheetIndex(t)),u=f.cellTypes,i=0,e=u.length;i<e;i++)if(u[i].range===n)return i},_rfrshCtrlText:function(i,r){var e=this.XLObj,s=!0,f,u,o;if(e.isUndefined(i.rowIndex)||e.isUndefined(i.colIndex)||(i=e.getRangeData({range:[i.rowIndex,i.colIndex,i.rowIndex,i.colIndex],property:["cellType","value"]})[0],r=i.value),f=e._dataContainer.sheetCellType[i.cellType],f)switch(f.type){case t.Spreadsheet.CustomCellType.DropDownList:u=n("#"+f.id).data("ej"+f.type);u&&(o=u.selectedIndexValue,u._raiseEvents=!1,u.selectItemByText(r),u._raiseEvents=!0,o!==-1&&o!==u.selectedIndexValue?f.selectedIndex=u.selectedIndexValue:s=!1)}return s}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cFormat=function(n){this.XLObj=n};t.spreadsheetFeatures.cFormat.prototype={getCFRule:function(n,t){var u=this.XLObj,h=u.getActiveSheetIndex(),f=u.XLEdit.getPropertyValue(n,t,["cFormatRule"]),e=[],s=u._dataContainer.cFormatData,i,r,o;if(f)for(r=0,o=f.length;r<o;r++)i=s[f[r]].split("_"),e.push({action:i[0],inputs:[i[2],i[3]],color:i[4],range:i[5],isApplied:JSON.parse(i[7])});return e},setCFRule:function(n){var t=this.XLObj,i,r;t.model.isReadOnly||t.model.allowConditionalFormats&&(i=n.inputs[0],r=n.inputs[1],this._cFormat(n.action,i,r,n.color,n.range,t.getActiveSheetIndex()))},_updateCFormatRule:function(n,t){return n.indexOf("true")>-1?n.replace("true",t):n.replace("false",t)},_getRuleIndex:function(n,i){if(t.isNullOrUndefined(i))return-1;for(var r=0,u=i.length;r<u;r++)if(i[r]===n)return r;return-1},_refreshCFormatFormula:function(n,t,i){var u=this.XLObj,f=u.getSheet(i)._cFormatFormula,r,e;u.isUndefined(f[n])||u.isUndefined(f[n][t])||(r=f[n][t][0].Formula,this._applyFormulaValues(r.referCell,r.cFColor,"formularule",r.addr,i,e,r.applyCell))},_applyFormulaValues:function(n,i,r,u,f,e,o,s,h){var c=this.XLObj,v,l,b,y,ht,ct,tt,ft=c.getSheet(f),p,k,d,it,g,lt=!0,at=-1,et,a=[],rt,w,nt,ot,st,o,n,ut;if(v=t.isNullOrUndefined(e)&&t.isNullOrUndefined(u)?ft._selectedCells:t.isNullOrUndefined(u)?c._getMultiRangeCells(e):c._getMultiRangeCells(u),u=c._getAlphaRange(f,v[0].rowIndex,v[0].colIndex,v[v.length-1].rowIndex,v[v.length-1].colIndex),c.isUndefined(r))w=c._calcEngine,ut=new ValueChangedArgs(-1,-1,n),w.valueChanged(ft.sheetInfo.value,ut),n=w.getFormulaInfoTable().getItem("!"+(f-1)+"!-1").getFormulaValue()==="TRUE"?!0:!1,g=c._isBool(n)?n:!1,it="formularule_"+r+"_"+n+"__"+i+"_"+u+"_"+c.getActiveSheetIndex(),this._applyCFormatRule({rowIndex:o.rowIndex,colIndex:o.colIndex},it,at,g,lt,i);else{if(d=["<=",">=","<",">","="],n.startsWith("=")&&(n=n.substr(1)),n.indexOf("==")>-1)return c._showAlertDlg("Alert","NewRuleAlert","",430),!0;for(l=0,y=d.length;l<y;l++)n.indexOf(d[l])>-1&&(a=n.split(d[l]),rt=d[l]);if(a.length||(a[0]=n),ht=a.slice(),s==="paste"){for(n="",l=0,y=a.length;l<y;l++)c._isvalidRange(a[l]+":"+a[l])&&(o=c._getMultiRangeCells(a[l]),ot=e[0]-h.rowIndex,st=e[1]-h.colIndex,a[l]=c._getAlphaRange(f,o[0].rowIndex+ot,o[0].colIndex+st,o[0].rowIndex+ot,o[0].colIndex+st));n=y===2?a[0]+rt+a[1]:a[0]}for(ct=this._formulaCellRefer(a,v),l=0,y=v.length;l<y;l++){for(p=v[l].rowIndex,k=v[l].colIndex,nt=this._formulaCellRange({rowIndex:p,colIndex:k},ct,ht,rt,f),tt=nt.formula,w=c._calcEngine,ut=new ValueChangedArgs(-1,-1,tt),w.valueChanged(ft.sheetInfo.value,ut),et=w.getFormulaInfoTable().getItem("!"+(f-1)+"!-1").getFormulaValue()==="TRUE"?!0:!1,g=c._isBool(et)?et:!1,it="formularule_"+rt+"_"+n+"/"+tt+"__"+i+"_"+u+"_"+c.getActiveSheetIndex(),b=0;b<c.getObjectLength(nt)-1;b++)this._formulaCellUpdate({rowIndex:nt["referCell"+b].rowIndex,colIndex:nt["referCell"+b].colIndex},{rowIndex:p,colIndex:k},n,tt,u,i,f);this._applyCFormatRule({rowIndex:p,colIndex:k},it,at,g,lt,i);!g&&c._isRowViewable(f,p)&&c.getCell(p,k,f).removeClass("e-redft e-yellowft e-greenft e-redf e-redt")}}},_formulaCellUpdate:function(n,t,i,r,u,f,e){var l=this.XLObj,h=l.getSheet(e)._cFormatFormula,o,c=n.rowIndex,s=n.colIndex;c in h?(o=h[c],s in o?o[s].push({Formula:{applyCell:t,formula:i,referCell:r,addr:u,cFColor:f}}):(o[s]=[],o[s].push({Formula:{applyCell:t,formula:i,referCell:r,addr:u,cFColor:f}}))):(o=h[c]={},o[s]=[],o[s].push({Formula:{applyCell:t,formula:i,referCell:r,addr:u,cFColor:f}}))},_formulaCellRange:function(n,t,i,r,u){for(var y,p,e=this.XLObj,w=0,c,l=[],b=0,k=e.getObjectLength(t),o,s,h,a={},v={},f=0;f<k;f++)e._isObject(t["range"+f])?(s=n.rowIndex+t["range"+f].rowIndex,h=n.colIndex+t["range"+f].colIndex,a["range"+f]=e._getAlphaRange(u,s,h,s,h)):(s=n.rowIndex,h=n.colIndex,a["range"+f]=t["range"+f]),v["referCell"+f]={rowIndex:s,colIndex:h};for(c=0;c<i.length;c++){for(o=e.XLDragFill._parseFormula("="+i[c]),f=0,y=o.length;f<y;f++)e._isvalidRange(o[f]+":"+o[f])&&(o[f]=a["range"+w],w++);l[b]=o.join("");b++}return p=e.isUndefined(r)?"="+l[0]:"="+l[0]+r+l[1],v.formula=p,v},_formulaCellRefer:function(n,t){for(var f=this.XLObj,i,y,r,l=0,o,a=[],u,v,s,h,p={},c,e=0;e<n.length;e++)if(f.isFormula("="+n[e]))for(o=f.XLDragFill._parseFormula(n[e]),i=0,y=o.length;i<y;i++)f._isvalidRange(o[i]+":"+o[i])&&(a[l]=o[i],l++);else a[l]=n[e],l++;for(n=a,i=0;i<n.length;i++){if(u=n[i].startsWith("=")?n[i].split("=")[1]:n[i],v=u.split("$").length,f._isvalidRange(n[i]+":"+n[i])){f._isvalidRange(u+":"+u)&&(u.indexOf("$")<0?c="RCRefer":u.startsWith("$")&&v===3?c="CellRefer":u.startsWith("$")&&v===2?c="RRefer":!u.startsWith("$")&&u.indexOf("$")>-1&&(c="CRefer"));n[i].indexOf("$")>-1&&(n[i]=n[i].split("$").join(""));r=f._getMultiRangeCells(n[i]);switch(c){case"RCRefer":s=r[0].rowIndex-t[0].rowIndex;h=r[0].colIndex-t[0].colIndex;break;case"RRefer":s=r[0].rowIndex-t[0].rowIndex;h=r[0].colIndex;break;case"CRefer":s=r[0].rowIndex;h=r[0].colIndex-t[0].colIndex;break;case"CellRefer":s=r[0].rowIndex;h=r[0].colIndex}n[i]={rowIndex:s,colIndex:h}}p["range"+i]=n[i]}return p},_clearCFormula:function(n,t,i){var u=this.XLObj,e=[],c=[],l=0,s,r,o,v=u.XLEdit.getPropertyValue(n,t,"cFormatRule"),f,a,h=u.getSheet(i)._cFormatFormula;if(v&&v[0].split("_")[0]==="formularule"&&(input=v[0].split("_")[2].split("/")[1],input.startsWith("=")&&(input=input.substr(1)),u.isFormula("="+input))){for(a=["<=",">=","<",">","="],r=0,o=a.length;r<o;r++)input.indexOf(a[r])>-1&&(e=input.split(a[r]));for(e.length||(e[0]=input),r=0,o=e.length;r<o;r++)if(u.isFormula("="+e[r]))for(s=u.XLDragFill._parseFormula(e[r]),j=0;j<s.length;j++)u._isvalidRange(s[j]+":"+s[j])&&(c[l]=s[j],l++);else c[l]=e[r],l++;for(r=0,o=c.length;r<o;r++)f=u._getMultiRangeCells(c[r])[0],u.isUndefined(h[f.rowIndex])||(u.isUndefined(h[f.rowIndex][f.colIndex])||delete h[f.rowIndex][f.colIndex],u.getObjectLength(h[f.rowIndex])||delete h[f.rowIndex])}},_cFormat:function(n,i,r,u,f,e,o,s,h){var c=this.XLObj,y,l;if(c.model.allowConditionalFormats){c.showWaitingPopUp();e=e?e:c.getActiveSheetIndex();t.isNullOrUndefined(n)&&(n="lessthan");var a=c.getSheet(e),p=o?c._getRangeArgs(o,"object"):c._getRangeArgs(f,"object"),v={cFAction:n,input1:i,input2:r,cFColor:u,sheetIndex:e,reqType:"cond-format",action:"add",range:f,data:p};switch(n){case"greaterthan":this._applyGLEValues(">",i,u,n,f,e,o);break;case"greaterequalto":this._applyGLEValues(">=",i,u,n,f,e,o);break;case"lessthan":this._applyGLEValues("<",i,u,n,f,e,o);break;case"lessequalto":this._applyGLEValues("<=",i,u,n,f,e,o);break;case"equalto":this._applyGLEValues("==",i,u,n,f,e,o);break;case"notequalto":this._applyGLEValues("!=",i,u,n,f,e,o);break;case"between":this._applyBetweenValues("=",i,r,u,n,f,e,o);break;case"notbetween":this._applyBetweenValues("!",i,r,u,n,f,e,o);break;case"textcontains":this._applyContainsValues(i,u,n,f,e,o);break;case"dateoccur":this._applyDateContainsValues(i,u,n,f,e,o);break;case"formularule":i.indexOf("/")>-1&&(i=i.split("/")[1]);l=this._applyFormulaValues(i,u,n,f,e,o,y,s,h)}a._isImported&&!a._isLoaded||c._isUndoRedo||s==="paste"||c._dupDetails||c._isExport||l||(c._completeAction(v),c._trigActionComplete(v));c.hideWaitingPopUp()}},clearCF:function(n){var i=this.XLObj,o,a,h,s,c;if(!i.model.isReadOnly){var r=i.getActiveSheetIndex(),u,f,e={sheetIndex:r,reqType:"cond-format",action:"clear",rule:[]},l=i.getSheet(r);if(i.model.allowConditionalFormats){for(h=i._dataContainer.cFormatData,e.selection=!i.isUndefined(n),n=n?i._getRangeArgs(n,"object"):[0,0,l.rowCount-1,l.colCount-1],s=i._getSelectedCells(r,n).selCells,o=0,a=s.length;o<a;o++)u=s[o].rowIndex,f=s[o].colIndex,t.isNullOrUndefined(i._dataContainer.sheets[r][u])||t.isNullOrUndefined(i._dataContainer.sheets[r][u][f])||t.isNullOrUndefined(i._dataContainer.sheets[r][u][f].cFormatRule)||(e.rule.push(this.getCFRule(u,f)),this._clearCFormula(u,f,r),i.clearRangeData([u,f,u,f],["cFormatRule"]));c=e.selection?"clear_"+r+"_"+i._getSelectedItems()[1]:"clear_"+r+"_entire";h.indexOf(c)===-1&&h.push(c);i._isUndoRedo||i._dupDetails||(i._completeAction(e),i._trigActionComplete(e))}}},_getValueForCFormat:function(n,i){var f=this.XLObj,r=n.rowIndex,u=n.colIndex,s=f.getRangeData({range:[r,u,r,u],sheetIdx:i}),e=f.XLEdit.getPropertyValue(r,u),o=f.XLEdit.getPropertyValue(r,u,"value2");return e=t.isNullOrUndefined(e)?"":e.toString(),(o&&typeof o=="string"&&!s.formatStr&&e[0]==="="||f.XLEdit.getPropertyValue(r,u,"type")==="datetime"||f.XLEdit.getPropertyValue(r,u,"type")==="shortdate"||f.XLEdit.getPropertyValue(r,u,"type")==="longdate"||f.XLEdit.getPropertyValue(r,u,"type")==="time")&&(e=o),e},_applyGLEValues:function(i,r,u,f,e,o,s){var h=this.XLObj,c,k,v,y,l,ft,rt,et,tt,it=new RegExp(/[^.0-9]+/g),vt=new RegExp(/[^.-a-zA-Z 0-9]+/g),ot=h.getSheet(o),st=ot._startCell,ht=ot._endCell,d,p=r,w,ct,b=[],yt=s?h._getRangeArgs(s,"object"):h._getRangeArgs(e,"object"),lt,g,a,nt,ut,at;if(k=h._getSelectedCells(o,yt).selCells,p.startsWith("=")){for(p=p.substr(1),g=["<=",">=","<",">","="],a=0,nt=g.length;a<nt;a++)p.indexOf(g[a])>-1&&(b=b.split(g[a]),lt=g[a]);b.length||(b[0]=p);ct=this._formulaCellRefer(b,k)}for(a=0,nt=k.length;a<nt;a++)if(v=k[a].rowIndex,y=k[a].colIndex,r.startsWith("=")&&(ut=h._calcEngine,w=this._formulaCellRange({rowIndex:v,colIndex:y},ct,b,lt,o),at=new ValueChangedArgs(-1,-1,w.formula),ut.valueChanged(h.getSheet(o).sheetInfo.value,at),r=ut.getFormulaInfoTable().getItem("!0!-1").getFormulaValue(),l=h._isBool(r)?r==="TRUE"?!0:!1:!1,t.isNullOrUndefined(r)&&(r="0")),!h.XLEdit.getPropertyValue(v,y,"isMHide")&&!h.XLEdit.getPropertyValue(v,y,"isFilterHide")){if(c=this._getValueForCFormat({rowIndex:v,colIndex:y},o),tt=h.XLEdit.getPropertyValue(v,y,"type")?h.XLEdit.getPropertyValue(v,y,"type"):"general",ft=!0,et=-1,t.isNullOrUndefined(c)||!c.length&&f!="equalto"||r=="0")n.isNumeric(r)&&(l=r>0?f==="lessthan"||f==="lessequalto"||f==="notequalto":r<0?f==="greaterthan"||f==="greaterequalto"||f==="notequalto":f==="equalto"||f==="lessequalto"||f==="greaterequalto");else if(n.isNumeric(r))if(n.isNumeric(c))c=parseFloat(c),l=h.operators[i](c,parseFloat(r.replace(vt,"")));else if(h._isValidDate(c))l=h.operators[i](h._dateToInt(c),parseFloat(r));else if(h._isValidTime(c))continue;else l=h.operators[i](c.toLowerCase(),r.toLowerCase());else r.lastIndexOf("%")===r.length-1&&n.isNumeric(r.replace(it,""))?l=tt==="percentage"?h.operators[i](parseFloat(c),parseFloat(r.replace(it,""))):n.isNumeric(c)?h.operators[i](parseFloat(c),0):h.operators[i](c.length,0):r.indexOf("$")===0&&n.isNumeric(r.replace(it,""))?l=tt==="accounting"||tt!=="currency"||n.isNumeric(c)?h.operators[i](parseFloat(c),parseFloat(r.replace(it,""))):(h.operators[i](c.length,0)||h._isValidDate(c))&&!h._isValidTime(c):h._isValidDate(r)?h._isValidDate(c)?l=h.operators[i](h._dateToInt(new Date(c)),h._dateToInt(new Date(r))):h._isValidTime(c)||(l=n.isNumeric(c)?h.operators[i](parseFloat(c),h._dateToInt(r)):h.operators[i](c.length,h._dateToInt(r))):l=h._isValidTime(r)?h._isValidTime(c)?h.operators[i](h.parse.parseTime(c),h.parse.parseTime(r)):n.isNumeric(c)?h.operators[i](parseFloat(c),0):h.operators[i](c.length,0):h.operators[i](c.toLowerCase(),r.toLowerCase());if(t.isNullOrUndefined(e)&&(e=h._generateHeaderText(st.colIndex+1)+(st.rowIndex+1)+":"+h._generateHeaderText(ht.colIndex+1)+(ht.rowIndex+1)),rt=f+"_"+i+"_"+r+"__"+u+"_"+e+"_"+h.getActiveSheetIndex(),p.startsWith("="))for(r=p.substr(1),rt=f+"_"+i+"_"+r+"__"+u+"_"+e+"_"+h.getActiveSheetIndex(),d=0;d<h.getObjectLength(w)-1;d++)this._formulaCellUpdate({rowIndex:w["referCell"+d].rowIndex,colIndex:w["referCell"+d].colIndex},{rowIndex:v,colIndex:y},r,w.formula,e,u,o);this._applyCFormatRule({rowIndex:v,colIndex:y},rt,et,l,ft,u)}},_applyBetweenValues:function(i,r,u,f,e,o,s,h){var y,p,c=this.XLObj,l,k,g,a,nt,tt,it,w,v=new RegExp(/[^.0-9]+/g),d=new RegExp(/[^.-a-zA-Z 0-9]+/g),st,rt=c.getSheet(s),ut=rt._startCell,ft=rt._endCell,b,et;for(c.operators["<"](c.isNumber(r)?parseFloat(r):r,c.isNumber(u)?parseFloat(u):u)||(g=u,u=r,r=g),k=t.isNullOrUndefined(h)&&t.isNullOrUndefined(o)?c.getSheet(s)._selectedCells:c._getSelectedCells(s,o).selCells,b=0,et=k.length;b<et;b++)if(y=k[b].rowIndex,p=k[b].colIndex,!c.XLEdit.getPropertyValue(y,p,"isMHide")&&!c.XLEdit.getPropertyValue(y,p,"isFilterHide")){if(l=this._getValueForCFormat({rowIndex:y,colIndex:p},s),w=c.XLEdit.getPropertyValue(y,p,"type")?c.XLEdit.getPropertyValue(y,p,"type"):"general",nt=!0,it=-1,t.isNullOrUndefined(l)||!l.length)n.isNumeric(r)&&n.isNumeric(u)&&(a=r>0&&u>0||r<0&&u<0?e==="notbetween":e==="between");else if(n.isNumeric(r.replace(d,""))&&n.isNumeric(u.replace(d,""))&&w!=="percentage"&&w!=="currency"&&w!=="accounting")if(r=r.replace(d,""),u=u.replace(d,""),n.isNumeric(l))a=c.operators[i](parseFloat(l)>=parseFloat(r)&&parseFloat(l)<=parseFloat(u));else if(c._isValidDate(l))a=c.operators[i](c._dateToInt(l)>=parseFloat(r)&&st<=parseFloat(u));else if(c._isValidTime(l))continue;else a=c.operators[i](l.toLowerCase()>=r.toLowerCase()&&l.toLowerCase()<=u.toLowerCase());else if(r.lastIndexOf("%")===r.length-1&&n.isNumeric(r.replace(v,""))&&u.lastIndexOf("%")===u.length-1&&n.isNumeric(u.replace(v,""))&&w==="percentage")a=c.operators[i](parseFloat(l)>=parseFloat(r.replace(v,""))&&parseFloat(l)<=parseFloat(u.replace(v,"")));else if(r.indexOf("$")===0&&n.isNumeric(r.replace(v,""))&&u.indexOf("$")===0&&n.isNumeric(u.replace(v,""))&&(w==="accounting"||w!=="currency"))a=c.operators[i](parseFloat(l)>=parseFloat(r.replace(v,""))&&parseFloat(l)<=parseFloat(u.replace(v,"")));else if(c._isValidDate(r)&&c._isValidDate(u)){var ot=c._dateToInt(new Date(l)),ht=c._dateToInt(new Date(r)),ct=c._dateToInt(new Date(u));a=c.operators[i](ot>=ht&&ot<=ct)}else a=c._isValidTime(r)&&c._isValidTime(u)&&c._isValidTime(l)?c.operators[i](c.parse.parseTime(l)>=c.parse.parseTime(r)&&c.parse.parseTime(l)<=c.parse.parseTime(u)):n.isNumeric(l)?c.operators[i](parseFloat(l)>=parseFloat(r)&&parseFloat(l)<=parseFloat(u)):c.operators[i](l.toLowerCase()>=r.toLowerCase()&&l.toLowerCase()<=u.toLowerCase());t.isNullOrUndefined(o)&&(o=c._generateHeaderText(ut.colIndex+1)+(ut.rowIndex+1)+":"+c._generateHeaderText(ft.colIndex+1)+(ft.rowIndex+1));tt=e+"_"+i+"_"+r+"_"+u+"_"+f+"_"+o+"_"+c.getActiveSheetIndex();this._applyCFormatRule({rowIndex:y,colIndex:p},tt,it,a,nt,f)}},_applyContainsValues:function(i,r,u,f,e,o){var c,l,it,s=this.XLObj,h,y,a,p,w,b,k=new RegExp(/[^.-a-zA-Z 0-9]+/g),d=s.getSheet(e),g=d._startCell,nt=d._endCell,v,tt;for(y=t.isNullOrUndefined(o)&&t.isNullOrUndefined(f)?s.getSheet(e)._selectedCells:s._getSelectedCells(e,f).selCells,v=0,tt=y.length;v<tt;v++)(c=y[v].rowIndex,l=y[v].colIndex,s.XLEdit.getPropertyValue(c,l,"isMHide")||s.XLEdit.getPropertyValue(c,l,"isFilterHide"))||(h=this._getValueForCFormat({rowIndex:c,colIndex:l},e),it=s.XLEdit.getPropertyValue(c,l,"type")?s.XLEdit.getPropertyValue(c,l,"type"):"general",p=!0,b=-1,t.isNullOrUndefined(h)||!h.length?a=!1:n.isNumeric(i.replace(k,""))?(i=i.replace(k,""),s._isValidDate(h)&&(h=s._dateToInt(h).toString()),a=h.indexOf(i)>-1):s._isValidDate(i)?(s._isValidDate(h)&&(h=s._dateToInt(h).toString()),a=h.indexOf(s._dateToInt(i))>-1):s._isValidTime(i)?(s._isValidTime(h)&&(h=s._dateToInt("01/01/1990 "+h).toString()),a=h.indexOf(s._dateToInt("01/01/1990 "+i))>-1):a=h.toLowerCase().indexOf(i.toLowerCase())>-1,t.isNullOrUndefined(f)&&(f=s._generateHeaderText(g.colIndex+1)+(g.rowIndex+1)+":"+s._generateHeaderText(nt.colIndex+1)+(nt.rowIndex+1)),w=u+"__"+i+"__"+r+"_"+f+"_"+s.getActiveSheetIndex(),this._applyCFormatRule({rowIndex:c,colIndex:l},w,b,a,p,r))},_applyDateContainsValues:function(n,i,r,u,f,e){var s,h,o=this.XLObj,l,v=!1,y,p,w=o.getSheet(f),b=w._startCell,k=w._endCell,a,c,d,g,nt;for(a=t.isNullOrUndefined(e)&&t.isNullOrUndefined(u)?o.getSheet(f)._selectedCells:o._getSelectedCells(f,u).selCells,c=0,d=a.length;c<d;c++)(s=a[c].rowIndex,h=a[c].colIndex,o.XLEdit.getPropertyValue(s,h,"isMHide")||o.XLEdit.getPropertyValue(s,h,"isFilterHide"))||(l=this._getValueForCFormat({rowIndex:s,colIndex:h},f),p=-1,t.isNullOrUndefined(l)||!l.length?v=!1:o._isValidDate(n)&&(g=new Date(l),nt=new Date(n),v=g-nt==0),t.isNullOrUndefined(u)&&(u=o._generateHeaderText(b.colIndex+1)+(b.rowIndex+1)+":"+o._generateHeaderText(k.colIndex+1)+(k.rowIndex+1)),y=r+"__"+n+"__"+i+"_"+u+"_"+o.getActiveSheetIndex(),this._applyCFormatRule({rowIndex:s,colIndex:h},y,p,v,!0,i))},refreshCFormat:function(n){var t=this.XLObj,v=t._dupDetails,u,i,o,c,f,s,r,a,l,e,h;if(!t.model.isReadOnly&&(t._dupDetails=!0,t.model.allowConditionalFormats)){for(o=[],c=t.getActiveSheetIndex(),s=t._getSelectedCells(c,n).selCells,u=0,a=s.length;u<a;u++){if(e=s[u].rowIndex,h=s[u].colIndex,r=t.XLEdit.getPropertyValue(e,h,"cFormatRule"),!t.isUndefined(r)&&r.length)for(i=0,l=r.length;i<l;i++)r[i]=r[i].replace("_true","").replace("_false",""),o.indexOf(r[i])<0&&o.push(r[i]);t._isRowViewable(c,e)&&t.getCell(e,h,c).removeClass("e-redft e-yellowft e-greenft e-redf e-redt");t.clearRangeData([e,h,e,h],["cFormatRule"],s[u])}for(i=0,l=o.length;i<l;i++)f=o[i].split("_"),this._cFormat(f[0],f[2],f[3],f[4],f[5]);t._dupDetails=v}},_applyCFormatRule:function(n,t,i,r,u,f){var o=this.XLObj,a=o.getActiveSheetIndex(),s=n.rowIndex,h=n.colIndex,v,y,e=o.XLEdit.getPropertyValue(s,h,"cFormatRule"),c,p,b=!0,l,k;if(this._getRuleIndex(t+"_true",e)>-1&&(i=this._getRuleIndex(t+"_true",e)),this._getRuleIndex(t+"_false",e)>-1&&(i=this._getRuleIndex(t+"_false",e)),i>-1&&(c=e[i],p=o._dataContainer.cFormatData.indexOf(this._updateCFormatRule(c,r)),p>-1?o._dataContainer.sheets[a][s][h].cFormatRule[i]=p:(o._dataContainer.cFormatData.push(this._updateCFormatRule(c,r)),o._dataContainer.sheets[a][s][h].cFormatRule[i]=o._dataContainer.cFormatData.length-1)),e=o.XLEdit.getPropertyValue(s,h,"cFormatRule"),o._isRowViewable(a,s)&&(v=!0,y=o.getCell(s,h)),!o.isUndefined(e)&&e.length>0&&(!(t+"_true"===e[i]||t+"_false"===e[i])||e.length>1)){for(l=0,k=e.length;l<k;l++)c=e[l].split("_");v&&r&&y.removeClass("e-redft e-yellowft e-greenft e-redf e-redt").addClass("e-"+f)}else v&&r&&y.removeClass("e-redft e-yellowft e-greenft e-redf e-redt").addClass("e-"+f);if(e&&e.length){var d=o.getRangeIndices(t.split("_")[5]),g=o.getRangeIndices(e[0].split("_")[5]),w=t.split("_");w.splice(6,1);w.splice(5,1);e[0].indexOf(w.join("_"))>-1&&o.inRange(g,d[0],d[1])&&(b=!1)}b&&this._getRuleIndex(t+"_true",e)<0&&this._getRuleIndex(t+"_false",e)<0&&o.XLEdit._updateDataContainer(n,{dataObj:{cFormatRule:[t+"_"+r]},skipCell:!r})}}}(jQuery,Syncfusion),function(n,t,i){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.clipboard=function(n){this.XLObj=n;this._cutCells=[];this._copyCells=[];this._copyBackup={};this._cData="";this._isCut=!1;this._copyRange=[];this._isSpecial=!n.isPasteValuesOnly;this._isShape=!1};t.spreadsheetFeatures.clipboard.prototype={copy:function(){this._triggerKeyDown(67,!0)},cut:function(){this.XLObj.model.isReadOnly||this._triggerKeyDown(88,!0)},paste:function(){this.XLObj.model.isReadOnly||this._triggerKeyDown(86,!0)},_initCopyPaste:function(){var i=this.XLObj._id,r=t.buildTag("div",{},{position:"fixed",top:-1e3,left:-1e3},{id:i+"_copyPaste"});n("body").append(r);r.append(t.buildTag("textarea ."+i+"_copyTxt",{},{width:1,height:1,overflow:"hidden",opacity:0,resize:"none",cursor:"default"},{id:i+"_hiddenTxt"}))},_copyPasteHandler:function(t){var f,i=this.XLObj,u=i.getActiveSheetIndex(),r=i.getSheet(u),e;if(i._isUndoRedo=!1,!i.model.allowEditing&&(t.keyCode===88||t.keyCode===86))return!1;if((t.keyCode===67||t.keyCode===88||t.keyCode===86)&&i._preventctrlkey){i._showAlertDlg("Alert","CtrlKeyErrorAlert","CtrlKeyErrorAction",450);return}if(t.ctrlKey){if(t.keyCode===67)this._getClipboard(t),this._cutCells=[],n.extend(!0,this._copyCells,r._selectedCells),this._copyCells.length||(this._copyCells=[i.XLShape._picCellIdx]),setTimeout(function(){i.setSheetFocus()},0);else if(t.keyCode===88){if(f=r._selectedCells,i.model.allowLockCell&&r.isSheetProtected&&i._isPropExists([r.selectedRange],"isLocked",u))return;if(f.length&&i._isPropExists([r.selectedRange],"isReadOnly",u))return;f.length&&i._isPropExists([r.selectedRange],"rule",u)&&i.getRange(r.selectedRange,u).removeClass("e-hlcell");this._copyCells=[];n.extend(!0,this._cutCells,f);this._cutCells.length||(this._cutCells=[i.XLShape._picCellIdx]);this._getClipboard(t);setTimeout(function(){i.setSheetFocus()},0)}else if(t.keyCode===86){if(e={reqType:"paste",isCopy:!this._cutCells.length,isShape:this._isShape},this._isShape||(e.cRange=this._copyRange),i._trigActionBegin(e))return;if(i.isUndefined(t.bubbles)||(this._isSpecial=!i.isPasteValuesOnly),this._cData.length||this._copyBackup.elem)n("#"+i._id+"_hiddenTxt").val(this._cData).select();else if(t.originalEvent)n("#"+i._id+"_hiddenTxt").select();else{n("#"+i._id+"_hiddenTxt").val("");i._showAlertDlg("Alert",["ClipboardAccessError","ClipboardAccessCutError","ClipboardAccessCopyError","ClipboardAccessPasteError"],"ClipboardAccessError",450);return}setTimeout(function(){i.XLClipboard._setClipboard()},0)}}else t.keyCode===27&&i.element.find(".e-cdata").length&&(i.element.find("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),n("#"+i._id+"_hiddenTxt").val(""),this._cData="",this._copyCells=[])},_triggerKeyDown:function(t,i){var u=this.XLObj,r;u.setSheetFocus();r=n.Event("keydown");r.keyCode=t;r.ctrlKey=i;n("#"+u._id).trigger(r)},_getClipboard:function(t){var i=this.XLObj,r=i.getActiveSheetIndex(),e=i.getSheet(r),o=e._startCell,s=e._endCell,f=i._getContent(r).find(".e-selected"),h=i.getActiveCellElem(r)[0],u;i.model.allowClipboard&&(i.XLClipboard._copyBackup.cells||!i.model.showRibbon||i.model.isReadOnly||(i.XLRibbon._enableButtons(["Home_Clipboard_Paste"],"ejButton"),i.XLRibbon._enableButtons(["Home_Clipboard_PasteOptions"],"ejSplitButton"),i.isPasteValuesOnly&&n("#"+i._id+"_Ribbon_Paste").data("ejMenu").disableItemByID("PasteSpecial")),f.length?(this._copyBackup={cells:[],border:i.model.allowCellFormatting&&i.XLFormat.getHashCodeClassAsArray(),table:[],filterRange:[]},u=this._getSelectedData(o,s),i.element.find(".e-cdata").length&&i.element.find("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),n(f).addClass("e-cdata"),i.XLSelection._focusBorder(o,s,i._cutFocus),this._cData=f.length<2&&!u.length?u=" ":u,this._isCut=!1,n("#"+i._id+"_hiddenTxt").val(u).select(),navigator.platform.toLowerCase().indexOf("mac")>-1&&document.execCommand("copy"),this._copyBackup.actCellPos={top:h.offsetTop,left:h.offsetLeft},this._copyBackup.cells[0].cell.wrap&&(this._copyBackup.cells[0].cell.wrap=""),t.keyCode==67&&(this._copyBackup.copypaste=!0),this._isShape=!1):(this._isShape=!0,this._copyBackup={elem:i.getSheetElement(r).find(".e-ss-activeimg"),isCut:t.keyCode===88,sIdx:r}))},_getSelectedData:function(t,i){var f,u=this.XLObj,c="",e,r,s,l=u.getActiveSheetIndex(),p,h,d,y;for(t.rowIndex>=i.rowIndex&&(p=t,t=i,i=p),this._copyRange=[],this._copyRange.push(u.getActiveSheetIndex()),this._copyRange.push(u._getSelectedItems()[1]),e=t.rowIndex;e<=i.rowIndex;e++)if(e!==t.rowIndex&&(c+="\n"),t.colIndex<=i.colIndex)for(r=t.colIndex;r<=i.colIndex;r++)f=u.getRangeData({range:[e,r,e,r],property:["type","value","value2"]})[0],s=u.getObjectLength(f)?f.type!=="general"?f.value2:f.value:"",this._updateCBackupData(e,r),c+=r!==i.colIndex?s+"\t":s;else for(r=i.colIndex;r<=t.colIndex;r++)f=u.getRangeData({range:[e,r,e,r],property:["type","value","value2"]})[0],s=u.getObjectLength(f)?f.type!=="general"?f.value2:f.value:"",this._updateCBackupData(e,r),c+=r!==t.colIndex?s+"\t":s;var w=u.model.sheets[l].tableManager,a,o,v,b=[],k=u.model.sheets[l].selectedRange;for(a=u.getObjectKeys(w),h=0,d=a.length;h<=d;h++)if(o=n.extend(!0,{},w[a[h]]),u.getObjectLength(o)&&(v=o.range,this._compareRange(k,v))){b.push(o.name);o.header=!0;o.tblId=a[h];this._copyBackup.table.push({tblName:b,tblObj:o,range:v,sheetIdx:l});break}return y=u.getRangeIndices(u.model.sheets[l].filterSettings.range),this._compareRange(k,y)&&(this._copyBackup.filterRange=y),c},_updateCBackupData:function(t,i){var e=this.XLObj,o=e.getActiveSheetIndex(),u,f=e._dataContainer.sheets[o],r,s=new RegExp("\\be-format.*?\\b","g");t in f&&i in f[t]?(r=n.extend(!0,{},f[t][i]),u=r.format?r.format:""):(r={},u="");this._copyBackup.cells.push({cell:r,format:u})},_setClipboard:function(){var r=this.XLObj,fr,lt,pt,kr,du,er,yi,gu,ef,nf,or,pi,tr,tf,s,f,sr,dr,gr,wt,su,hr,vt,wi,nu,tu,ti,cr,fu,lr,eu,ou,ir;if(!r.model.isReadOnly){var tt,ki,st,di,ft,ar,su,hu,uf,kt,o,at,ht=[],v=[],rt,cu=new RegExp("\\be-format.*?\\b","g"),k,ii=!1,fi=!1,g,u=r.getActiveSheetIndex(),h={cSheetIndex:this._copyRange[0],pSheetIndex:u,sheetIndex:u},ei=[],oi=r.getSheet(u)._startCell,si=r.getSheet(u)._endCell,p,nt,et=0,c,ut,hi,vr,gi,a={},d,yr,ri,lu=new RegExp("\\be-shapebdr.*?\\b","g"),au=["solid","dashed","dotted"],ff,y=oi.rowIndex<si.rowIndex?oi.rowIndex:si.rowIndex,pr,nr,ci=this._copyBackup.table,dt,rr,ur,b=oi.colIndex<si.colIndex?oi.colIndex:si.colIndex,l=r._dataContainer,e,gt,wr,li,ni=this._copyCells.length,yt=this._cutCells.length;if(r.isPasteValuesOnly&&(this._isSpecial=!1),this._copyRange.length){if(at=r.swapRange(r.getRangeIndices(this._copyRange[1])),li=r._getSelectedRange({rowIndex:at[0],colIndex:at[1]},{rowIndex:at[2],colIndex:at[3]}),st=[y,b,y+(at[2]-at[0]),b+(at[3]-at[1])],wr=r._getSelectedRange({rowIndex:st[0],colIndex:st[1]},{rowIndex:st[2],colIndex:st[3]}),r.model.allowLockCell&&r.getSheet(u).isSheetProtected&&r._isPropExists([st],"isLocked",u))return;if(r._isPropExists([st],"isReadOnly",u))return}if(y===0&&b===0&&ni===this.XLObj.model.rowCount*this.XLObj.model.columnCount||ni!==this.XLObj.model.rowCount*this.XLObj.model.columnCount){var vu,yu=r.model.sheets[u],pu=r.model.sheets[this._copyBackup.sIdx],ai=r.getSheetElement(u).find(".e-activecell"),ct=r.getSheet(this._copyBackup.sIdx||this._copyRange[0]||u).shapeMngr,vi,it,wu,bu,ku,br,w=this._copyRange[0];if(this._isShape){if(!this._isSpecial)return!1;lt=r.XLShape._picCellIdx;pt=r.getActiveCell(u);d=this._copyBackup.elem;fr=d[0].id;rt=fr.indexOf("picture")>-1?"picture":"chart";h={sheetIndex:u,cSheetIndex:this._copyBackup.sIdx,pSheetIndex:u,operation:"shape",cShapeId:fr,reqType:this._copyBackup.isCut?"cut-paste":"copy-paste"};o=n.extend(!0,{},l.sheets[this._copyBackup.sIdx][lt.rowIndex][lt.colIndex]);v=r.getCell(pt.rowIndex,pt.colIndex);n.extend(!0,a,ct[rt][fr]);h.cutCell={rowIndex:lt.rowIndex,colIndex:lt.colIndex,obj:o,shapeObj:n.extend(!0,{},a)};d=r.element.find("#"+a.id);rt==="picture"?(it=d[0].className,it.indexOf("e-shapebdr")>-1?(it=d[0].className.match(lu)[0],dt=it.replace("e-shapebdr","").split("N"),rr=dt[2],r.XLShape._createPicture(u,pt,ct.sharedPics[a.data],v[0].offsetTop,v[0].offsetLeft,a.width,a.height,null,"#"+rr,au[parseInt(dt[1])-1],dt[0]+"px"),r.model.showRibbon&&r.XLRibbon._formatTabUpdate()):(r.XLShape._createPicture(u,pt,ct.sharedPics[a.data],v[0].offsetTop,v[0].offsetLeft,a.width,a.height),r.model.showRibbon&&r.XLRibbon._formatTabUpdate())):(a.isChartSeries||(e=a.range,e=r._getAlphaRange(u,e[0],e[1],e[2],e[3]),e.indexOf(":")===-1&&(e=e+":"+e)),a.top=v[0].offsetTop,a.left=v[0].offsetLeft,r.XLChart.createChart(a.isChartSeries?null:e,n.extend(!0,{},a)));this._isShape=this._copyBackup.isCut?!1:!0;this._cutCells=[];r._isUndoRedo||(o=n.extend(!0,{},l.sheets[u][pt.rowIndex][pt.colIndex]),a=n.extend(!0,{},yu.shapeMngr[rt][o[rt][0]]),h.pShapeId=o[rt][0],h.pasteCell={rowIndex:pt.rowIndex,colIndex:pt.colIndex,obj:o,shapeObj:a},ft={sheetIndex:h.sheetIndex,cutCell:h.cutCell,pasteSheetIndex:h.pSheetIndex,operation:h.operation,reqType:h.reqType,pasteShapeId:h.pShapeId,pasteCell:h.pasteCell},ft.reqType==="cut-paste"?(ft.cutSheetIndex=h.cSheetIndex,ft.cutShapeId=h.cShapeId):(ft.copySheetIndex=h.cSheetIndex,ft.copyshapeId=h.cShapeId),r._completeAction(h),r._trigActionComplete(ft),this._copyBackup.isCut&&(o=n.extend(!0,{},l.sheets[this._copyBackup.sIdx][lt.rowIndex][lt.colIndex]),o[rt].some(function(n,t){return d[0].id===pu.shapeMngr[rt][o[rt][t]].id?(vu=t,!0):!1}),Object.keys(o).length<2&&o[rt].length<2?(delete l.sheets[this._copyBackup.sIdx][lt.rowIndex][lt.colIndex],r.getObjectLength(l.sheets[this._copyBackup.sIdx][lt.rowIndex])<1&&delete l.sheets[this._copyBackup.sIdx][lt.rowIndex]):o[rt].length<2?delete o[rt]:o[rt].splice(vu,1),delete pu.shapeMngr[rt][h.cShapeId]));this._copyBackup.isCut&&d.remove()}else{if(ii=this._cData===n("#"+r._id+"_hiddenTxt").val()&&this._copyRange.length>0,ii){if(r.model.allowLockCell&&r.getSheet(u).isSheetProtected&&r._isPropExists([st],"isLocked",u))return;if(r._isPropExists([st],"isReadOnly",u))return}if(du=[],h.reqType=yt>0?"cut-paste":"copy-paste",r.element.find(".e-selected").hasClass("e-readonly")){r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom");return}if(h.text=ht=n("#"+r._id+"_hiddenTxt").val().length?n("#"+r._id+"_hiddenTxt").val().split("\n"):[],this._cData.length<1&&h.text.length<1)return;if(ii||ht[ht.length-1]!==""||ht.splice(ht.length-1,1),kr=[],du=[],ii?(h.isSpecial=this._isSpecial,e=r.getRangeIndices(this._copyRange[1]),r.setActiveSheetIndex(this._copyRange[0]),h.cutBorder={range:e,prevBorder:r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(e)},r.setActiveSheetIndex(u)):h.isSpecial=!1,yt){for(br=[],w=this._copyRange[0],ci.length||this._cutPasteBorder(at,st),p=0;p<yt;p++){if(f=this._cutCells[p].rowIndex,s=this._cutCells[p].colIndex,k=r.getCell(f,s,w),ff=r.XLEdit.getPropertyValue(f,s,"tableName")||"",v={rowIndex:f,colIndex:s,prevObj:{},newObj:{},shapes:[]},t.isNullOrUndefined(l.sheets[w][f])?v.prevObj={}:n.extend(!0,v.prevObj,l.sheets[w][f][s]),o=t.isNullOrUndefined(l.sheets[w][f])?{}:n.extend(!0,{},l.sheets[w][f][s]),k&&k[0]){if("merge"in v.prevObj||(r.XLEdit._updateCellValue({rowIndex:f,colIndex:s},"","",w),r._refreshRowHeight(w,f)),"wrap"in o&&(hi=r._generateHeaderText(s+1)+(f+1),r._dupDetails=!0,r.setActiveSheetIndex(w),r.setWrapText("unwrap",hi+":"+hi),r.setActiveSheetIndex(u),r._dupDetails=!1),"cellType"in o&&r.model.allowCellType&&r.XLCellType._removeControls(f,s,w,!0),k.removeClass("e-hyperlinks e-redft e-yellowft e-greenft e-redf e-redt"),k.find("a").remove(),k.hasClass("e-commentcell")&&r.XLComment.deleteComment([f,s,f,s],w),r.model.allowCellFormatting&&!r.XLRibbon._isDirtySelect)if(fi=r._checkTableRange(r._getRangeArgs(e,"string")).status=="partial",ci.length)for(c=0,ut=ci.length;c<ut;c++)r.XLFormat.removeStyle(e,{cellStyle:!0,tableStyle:!0,format:!0,border:!0,sheetIdx:ci[c].sheetIdx});else fi||r.XLFormat.removeStyle(e,{cellStyle:!0,tableStyle:!0,format:!0});f in l.sheets[w]&&s in l.sheets[w][f]&&(t.isNullOrUndefined(l.sheets[w][f][s])||(uf=l.sheets[w][f][s].overflow),fi?r.XLEdit._clearDataContainer({cellIdx:{rowIndex:f,colIndex:s},sheetIdx:w,property:["value","value2","type","cFormatRule","thousandSeparator","rule","calcValue","align","hyperlink","comment","decimalPlaces","formatStr"]}):(delete l.sheets[w][f][s],r._textClip(f,s,"delete")));k[0].className.match(cu)&&r._checkTableRange(r._getRangeArgs(e,"string")).status!="partial"&&(k[0].className=k[0].className.replace(cu,""));t.isNullOrUndefined(l.sheets[w][f])?v.newObj={}:n.extend(!0,v.newObj,l.sheets[w][f][s]);r._setRowHdrHeight(w,r._getCellIdx(k[0]).rowIndex)}else r.getObjectLength(o)&&(kt=r.getObjectKeys(o),fi=r._checkTableRange(r._getRangeArgs(e,"string")).status=="partial",fi&&(kt.splice(kt.indexOf("tableName"),1),kt.splice(kt.indexOf("tformats"),1),kt.splice(kt.indexOf("format"),1)),r.clearRangeData([f,s,f,s],kt),r.model.allowCellType&&"cellType"in o&&delete l.sheetCellType[l.sheets[w][f][s].cellType]);br.push(v)}for(c=0,ut=ci.length;c<ut;c++)nf=r.getActiveSheetIndex(),r.gotoPage(w,!1),pr=n.trim(ci[c].tblName),r.XLFormat.removeTable(r._getTableID(null,pr,w)),r.gotoPage(nf,!1);r.model.allowCellFormatting&&!fi&&r.XLFormat.removeStyle(e,{cellStyle:!0,tableStyle:!0,format:!0});r.setActiveSheetIndex(w);r.setActiveSheetIndex(u);h.cutCells=br;h.cfat={table:pr,range:e};ku=!0;r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom")}else{if(or=[],this._isSpecial)for(p=0;p<ni;p++)f=this._copyCells[p].rowIndex,s=this._copyCells[p].colIndex,v={rowIndex:f,colIndex:s,prevObj:{},newObj:{}},t.isNullOrUndefined(l.sheets[u][f])||n.extend(!0,v.prevObj,l.sheets[u][f][s]),or.push(v);else or=this._copyCells;h.cutCells=or}if(ht.length?vi=[y,b,y+ht.length-1,b+ht[0].split("\t").length-1]:(vi=[y,b,y,b],p=nt=1),h.pasteBorder={range:vi,prevBorder:r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(vi)},ni)for(sr=[],r.XLFormat.removeStyle(st,{border:!0,cellStyle:!0,format:!0}),pi=0,tf=wr.length;pi<tf;pi++)tr=wr[pi],f=li[pi].rowIndex,s=li[pi].colIndex,sr=r.XLEdit.getPropertyValue(f,s,"borders",this._copyRange[0]),r.isUndefined(sr)||r.XLFormat.applyBorder(sr,[tr.rowIndex,tr.colIndex,tr.rowIndex,tr.colIndex]);for(su=r._getContTBody(u).find("rows"),p=0,wu=ht.length;p<wu;p++){for(v=ht[p].split("\t"),nt=0,bu=v.length;nt<bu;nt++){if(k=su[r._getRowIdx(y+p)]?r.getCell(y+p,b+nt)[0]:i,t.isNullOrUndefined(k)?(yu.colCount<=b+nt?r.XLScroll._createNewColumn(u,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert"):r.model.scrollSettings.allowScrolling&&!r.model.scrollSettings.allowVirtualScrolling&&r.XLScroll._createNewRow(u,-1,-1,"insert"),r.XLScroll._refreshScroller(u,"refresh","all"),k=r.getCell(y+p,b+nt)):k=n(k),g={rowIndex:y+p,colIndex:b+nt},g.prevObj=t.isNullOrUndefined(l.sheets[u][y+p])?{}:n.extend(!0,{},l.sheets[u][y+p][b+nt]),t.isNullOrUndefined(g.prevObj)||(delete g.prevObj.isMHide,delete g.prevObj.mergeIdx),this._isCut&&ii)return;if(tt={rowIndex:y+p,colIndex:b+nt},this._isSpecial&&ii)if(f=tt.rowIndex,s=tt.colIndex,gu=li[et].rowIndex,ef=li[et].colIndex,it=r._dataContainer.hashCode[this._copyBackup.cells[et].format],"merge"in this._copyBackup.cells[et].cell||t.isNullOrUndefined(it)||r.addClass(k,it),o=n.extend(!0,{},this._copyBackup.cells[et].cell),f in l.sheets[u]||(l.sheets[u][f]={}),s in l.sheets[u][f]?"comment"in l.sheets[u][f][s]&&r.getCell(f,s).removeClass("e-commentcell"):l.sheets[u][f][s]={},o){if(ti=n.extend(!0,{},r.XLEdit.getPropertyValue(f,s,"merge")),dr=r.XLEdit.getPropertyValue(f,s,"isMHide"),gr=n.extend(!0,{},r.XLEdit.getPropertyValue(f,s,"mergeIdx")),delete o.overflow,delete o.isOverflow,delete o.tableName,n.extend(!0,l.sheets[u][f][s],o),wt=l.sheets[u][f][s],r.getObjectLength(ti)?wt.merge=ti:delete wt.merge,r.getObjectLength(gr)?wt.mergeIdx=gr:delete wt.mergeIdx,r.isUndefined(dr)?delete wt.isMHide:wt.isMHide=dr,r.XLEdit.getPropertyValue(f,s,"value2")&&(r._textClip(f,s,"delete"),r._textClip(f,s,"add")),yi=o.value2&&typeof o.value2=="string"&&!o.formatStr?l.sharedData[o.value][0]==="="?l.sharedData[o.value]:o.value2:l.sharedData[o.value],o.type===3&&(yi=this._getUpdatedCellFormula(yi,this._copyCells[et],{rowIdx:f,colIdx:s})),"merge"in o||(r.XLEdit._updateCellValue(tt,yi),ki=r.XLEdit.getPropertyValue(gu,0,h.reqType==="copy-paste"?"cHeight":"pHeight",this._copyRange[0]),r.isUndefined(ki)||(r.XLEdit._updateDataContainer({rowIndex:tt.rowIndex,colIndex:0},{dataObj:{pHeight:r.getSheet(u).rowsHeightCollection[tt.rowIndex],cHeight:ki}}),r.getSheet(u).rowsHeightCollection[tt.rowIndex]=ki,r._isRowViewable(u,tt.rowIndex)&&(r.getRows(u)[1][r._getRowIdx(tt.rowIndex)].style.height=ki+"px"))),"merge"in o){hr=0;ti=o.merge;e=r.getRangeIndices(ti.mRange);var iu=e[2]-e[0],ru=e[3]-e[1],of=r.getSheet(u)._selectedCells,uu=r._getAlphaRange(u,g.rowIndex,g.colIndex,g.rowIndex+iu,g.colIndex+ru),bi,sf=si.rowIndex-oi.rowIndex,hf=si.colIndex-oi.colIndex;if(vt=r._getSelectedRange({rowIndex:g.rowIndex,colIndex:g.colIndex},{rowIndex:g.rowIndex+iu,colIndex:g.colIndex+ru}),li.length>=of.length||!((hf+1)%(ru+1)==0&&(sf+1)%(iu+1)==0)){for(c=0,ut=vt.length;c<ut;c++)t.isNullOrUndefined(r.XLEdit.getPropertyValue(vt[c].rowIndex,vt[c].colIndex,"isMHide"))&&(wi=r.XLEdit.getPropertyValue(vt[c].rowIndex,vt[c].colIndex,"merge"),hr++,t.isNullOrUndefined(wi)||(wi&&(nu=wi.mSpan.rowSpan,tu=wi.mSpan.colSpan),t.isNullOrUndefined(nu)||t.isNullOrUndefined(tu)||(hr+=parseInt(nu)*parseInt(tu)-1),wi.isCenterAlign&&r._isRowViewable(u,vt[c].rowIndex)&&r.getCell(vt[c].rowIndex,vt[c].colIndex).addClass("e-calign").removeClass("e-ralign")));if(vt.length===hr&&yt){for(var rf=!1,bi=r._getSelectedCells(w,ti.mRange).range,bt,ui=r._dataContainer.sheets[w],ot=bi[0];ot<=bi[2];ot++)for(bt=bi[1];bt<=bi[3];bt++)r._isRowViewable(w,ot)&&r.getCell(ot,bt,w).text(""),t.isNullOrUndefined(ui[ot])&&(ui[ot]={}),t.isNullOrUndefined(ui[ot][bt])&&(ui[ot][bt]={}),rf?(ui[ot][bt].isMHide=!0,ui[ot][bt].mergeIdx={rowIndex:e[0],colIndex:e[1]}):(ui[ot][bt].merge=ti,rf=!0);r.setActiveSheetIndex(w);r._unMergeAllCells(this._copyRange[0],0,r._getSelectedRange({rowIndex:e[0],colIndex:e[1]},{rowIndex:e[2],colIndex:e[3]}),[],0,0);r.setActiveSheetIndex(u)}r._paste=!0;r._dupDetails=!0;r.isUndefined(g.prevObj.merge)||r.unmergeCells(g.prevObj.merge.mRange);r.unmergeCells(uu);r.mergeCenter=ti.isCenterAlign;r.isUndefined(bi)||bi!=="1"?r.mergeCells(uu,!0):r.mergeAcrossCells(uu,!0);r._dupDetails=!1;r.XLEdit._updateCellValue(tt,yi);t.isNullOrUndefined(it)||r.addClass(k,it)}else{cr=n.extend(!0,{},o);cr.value=cr.value2=yi;t.isNullOrUndefined(it)||r.getCell(e[0],e[1],this._copyRange[0]).addClass(it);r.XLEdit._updateDataContainer({rowIndex:e[0],colIndex:e[1]},{dataObj:cr});r._showAlertDlg("Alert","MergeAlert","",250);return}}if("hyperlink"in o&&(er=o.hyperlink,k&&(er&&!er.webAddr?k.html(t.buildTag("a.e-hyperlinks",r.XLEdit.getPropertyValue(f,s,"value2"),"",{href:"#"})):k.html(t.buildTag("a.e-hyperlinks",r.XLEdit.getPropertyValue(f,s,"value2"),"",{href:er.webAddr,target:"_blank"})))),"comment"in o&&(r._removeClass(k,"e-commentcell"),r.XLComment.setComment([f,s,f,s],null,!1)),"cFormatRule"in o)for(vr=n.extend(!0,[],o.cFormatRule),o.cFormatRule=[],c=0,ut=vr.length;c<ut;c++)gi=r._dataContainer.cFormatData[vr[c]].split("_"),r.XLCFormat._cFormat(gi[0],gi[2],gi[3],gi[4],null,null,[f,s,f,s],"paste",this._copyCells[et]);if(r._isPaste=!0,"wrap"in o&&(r._dupDetails=!0,hi=r._generateHeaderText(s+1)+(f+1),r.setWrapText("wrap",hi+":"+hi),r._dupDetails=!1),"cellType"in o&&(ar=r._dataContainer.sheetCellType[o.cellType],ar.text="",r.model.allowCellType&&r.XLCellType._renderControls(f,s,u,ar,!yt)),r._isPaste=!0,"picture"in o)for(delete wt.picture,c=0,ut=o.picture.length;c<ut;c++)v=ni?this._copyCells[et]:this._cutCells[et],gt=this._copyBackup.actCellPos,ri=r.getRangeData([v.rowIndex,v.colIndex,v.rowIndex,v.colIndex],"","",this._copyRange[0])[0],(!r.isUndefined(ri.picture)&&ri.picture.indexOf(o.picture[c])>-1||!ni)&&(n.extend(!0,a,ct.picture[o.picture[c]]),d=r.element.find("#"+a.id),a.rowIndex===v.rowIndex&&a.colIndex===v.colIndex&&(d=r.element.find("#"+a.id),it=d[0].className,it.indexOf("e-shapebdr")>-1?(it=d[0].className.match(lu)[0],dt=it.replace("e-shapebdr","").split("N"),rr=dt[2],r.XLShape._createPicture(u,tt,ct.sharedPics[a.data],parseInt(d.css("top"))-gt.top+ai[0].offsetTop,parseInt(d.css("left"))-gt.left+ai[0].offsetLeft,a.width,a.height,null,"#"+rr,au[parseInt(dt[1])-1],dt[0]+"px")):r.XLShape._createPicture(u,tt,ct.sharedPics[a.data],parseInt(d.css("top"))-gt.top+ai[0].offsetTop,parseInt(d.css("left"))-gt.left+ai[0].offsetLeft,a.width,a.height),this._copyRange[0]===u&&(l.sheets[u][y+p][b+nt].picture[c]=r.getObjectKeys(ct.picture)[r.getObjectLength(ct.picture)-1]),yt&&d.remove()));if("chart"in o)for(delete wt.chart,ri=r.getRangeData([f,s,f,s]),c=0,ut=o.chart.length;c<ut;c++)v=ni?this._copyCells[et]:this._cutCells[et],gt=this._copyBackup.actCellPos,ri=r.getRangeData([v.rowIndex,v.colIndex,v.rowIndex,v.colIndex])[0],(!r.isUndefined(ri.chart)&&ri.chart.indexOf(o.chart[c])>-1||!ni)&&(n.extend(!0,a,ct.chart[o.chart[c]]),d=r.element.find("#"+a.id),a.rowIndex===v.rowIndex&&a.colIndex===v.colIndex&&(a.isChartSeries||(e=a.range,e=r._getAlphaRange(u,e[0],e[1],e[2],e[3]),e.indexOf(":")<0&&(e=e+":"+e)),a.top=parseInt(d.css("top"))-gt.top+ai[0].offsetTop,a.left=parseInt(d.css("left"))-gt.left+ai[0].offsetLeft,r.XLChart.createChart(a.isChartSeries?null:e,a),l.sheets[u][y+p][b+nt].chart[c]=r.getObjectKeys(ct.chart)[r.getObjectLength(ct.chart)-1],yt&&d.remove()));"rule"in o&&o.rule.type==="list"&&r._setddlCell();r._isPaste=!1}else r.XLEdit._updateCellValue(tt,""),t.isNullOrUndefined(l.sheets[u][f])||delete l.sheets[u][f][s];else di=r.XLEdit._parseValue(v[nt],tt),di.type=="time"||di.type=="datetime"?(hu=r._dateToInt(di.value),r.XLEdit._updateCellValue(tt,hu)):r.XLEdit._updateCellValue(tt,di.value),v[nt].indexOf("=")>-1&&r.XLEdit._updateCellValue(tt,k.html());et++;g.newObj=t.isNullOrUndefined(l.sheets[u][y+p])?{}:n.extend(!0,{},l.sheets[u][y+p][b+nt]);t.isNullOrUndefined(g.newObj)&&(g.newObj={});kr.push(g)}t.isNullOrUndefined(k)||(r._setRowHdrHeight(u,r._getCellIdx(k[0]).rowIndex),r.model.allowFreezing&&r.getSheet(u)._isFreezed&&r.XLFreeze._refreshFRowResize(r._getCellIdx(k[0]).rowIndex))}if(ht.length<1&&(p=1),yt&&(this._isCut=ku,this._cutCells=[],this._cData=""),this._isSpecial&&ii){for(fu=this._copyBackup.table,eu=r.getSheet(u).tableManager,e=r.getRangeIndices(this._copyRange[1]),c=0,ut=fu.length;c<ut;c++)nr=this._copyBackup.table[c].range,lr=n.extend(!0,{},this._copyBackup.table[c].tblObj),this._copyBackup.copypaste&&(lr.name="Table"+r._tableCnt),r._dupDetails=!0,r.XLFormat.createTable(lr,r._getAlphaRange(this._copyRange[0],nr[0]+y-e[0],nr[1]+b-e[1],y-e[0]+nr[2],b-e[1]+nr[3])),r._dupDetails=!1,ou=this._isCut?lr.tblId:this.XLObj.getObjectLength(eu),ei.push(eu[ou]),ei[c].id=ou,ei[c].totalRow&&r.XLFormat._updateTotalRow(u,ei[c].id,fu[0].tblObj.fnNumber,ei[c].range,!0);vi=[y,b,p+y-1,nt+b-1];yt&&this._copyBackup.filterRange.length>0&&this._copyRange[0]===u&&(ir=this._copyBackup.filterRange,r.XLFilter.clearFilter(),yr=r._generateHeaderText(ir[1]+b-e[1]+1)+(ir[0]+y-e[0]+1)+":"+r._generateHeaderText(b-e[1]+ir[3]+1)+(y-e[0]+ir[2]+1),r.XLFilter.filter(yr));h.pasteBorder.newBorder=r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(vi);r.setActiveSheetIndex(this._copyRange[0]);h.cutBorder.newBorder=r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(e);r.setActiveSheetIndex(u)}h.pfat={table:this._copyBackup.table,range:e,minRowIdx:y,minColIdx:b,ptable:ei};h.pfilter=yr;h.pasteCells=kr;r.XLSelection.selectRange({rowIndex:y,colIndex:b},{rowIndex:p+y-1,colIndex:nt+b-1});r.getSheet(u)._startCell={rowIndex:y,colIndex:b};r.getSheet(u)._endCell={rowIndex:p+y-1,colIndex:nt+b-1};r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement();h.sheetIndex=u;r.setSheetFocus();r.model.showRibbon&&r.XLRibbon._updateRibbonIcons();ft={sheetIndex:h.sheetIndex,pasteCells:h.pasteCells,reqType:h.reqType,isSpecial:h.isSpecial,cutCells:h.cutCells,pasteSheetIndex:h.pSheetIndex};ft.reqType==="cut-paste"?ft.cutSheetIndex=h.cSheetIndex:ft.copySheetIndex=h.cSheetIndex;r._isUndoRedo||(r._completeAction(h),r._trigActionComplete(ft));ur=h.cutCells.length<1?y:h.cutCells[0].rowIndex;r.XLScroll._getRowHeights(u,y<ur?y>0?y-1:0:ur>0?ur-1:0)}r._isPaste=!1;this._isCut=!1;r.XLSelection._refreshBorder();r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement();r.getSheet(u)._isFreezed&&r.XLFreeze._refreshSelection()}else r._showAlertDlg("Alert","FullSheetCopyPasteAlert","",375)}},_getUpdatedCellFormula:function(n,t,i){for(var f=this.XLObj,c=/([A-Z].*?[0-9])/g,l=i.rowIdx-t.rowIndex,a=i.colIdx-t.colIndex,r=f.XLDragFill._parseFormula(n),e,o,s,u=0,h=r.length;u<h;u++)r[u].match(c)&&(e=r[u].trim().match(/(\d+|\D+)/g),o=f._generateColCount(e[0])+a,s=parseInt(e[1])+l,r[u]=s>0&&o>0?f._generateHeaderText(o)+s.toString():"#REF!");return r=r.join(""),"="+r},_compareRange:function(n,t){return n[0]<=t[0]&&n[1]<=t[1]&&n[2]>=t[2]&&n[3]>=t[3]},_cutPasteBorder:function(n,t){var r,u,s,h,c,i=this.XLObj,l=i.getActiveSheetIndex(),f=[],e=[],o=[];for(i.XLFormat.removeStyle(t,{cellStyle:!0,border:!0,format:!0,sheetIdx:l}),e=i._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]}),o=i._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]}),r=0,c=o.length;r<c;r++)u=o[r],h=e[r].rowIndex,s=e[r].colIndex,f=i.XLEdit.getPropertyValue(h,s,"borders",this._copyRange[0]),i.isUndefined(f)||i.XLFormat.applyBorder(f,[u.rowIndex,u.colIndex,u.rowIndex,u.colIndex]);i.setActiveSheetIndex(this._copyRange[0]);i.XLFormat.removeStyle(n,{cellStyle:!0,border:!0,format:!0});i.setActiveSheetIndex(l)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.comments=function(n){this.XLObj=n;this._isCommentEdit=!1;this._isShowAllComments=!1;this._curCommentHCell=null};t.spreadsheetFeatures.comments.prototype={setComment:function(n,i,r,u){var f=this.XLObj,a;if(f.model.allowComments&&f.model.allowEditing&&!f.model.isReadOnly){var nt,p,w=!1,y,c,e,o,b,v,k,s,h,d,g=[],l={sheetIndex:f.getActiveSheetIndex(),reqType:"comment"};if(s=f.getActiveSheetIndex(),h=f.getSheet(s),f.model.allowLockCell&&h.isSheetProtected)return!1;if(n)p=f._getRangeArgs(n,"object"),e=p[0],o=p[1],c={rowIndex:e,colIndex:o};else{if(!f.model.allowSelection)return;c=f.getActiveCell(s);e=c.rowIndex;o=c.colIndex}if(a={reqType:"beforeEditComment",cellIndex:c,value:i,sheetIdx:s,disable:!1},f._trigger("beforeEditComment",a)&&(a.disable=!0),i=a.value,!f._isCellProtected(e,o,!1)){if(!f.isUndefined(f.XLEdit.getPropertyValue(e,o,"cellType"))){f._showAlertDlg("Alert","CellTypeAlert","CellTypeAlert",372);return}f.model.showRibbon&&(f._isPaste?!f.XLClipboard._cutCells.length:!0)&&f._commentCount++;f._isRibbonClick||(l.action="add",g.push(c),l.selectedCell=g,l.selectedCell[0].prevComment=f.XLEdit.getPropertyValue(e,o,"comment"));f._isAutoWHMode||f.XLClipboard._copyCells.length||h._isFreezed||f.XLScroll._scrollSelectedPosition(s,c);e in h._commentColl||(h._commentColl[e]={});h._commentColl[e][o]={isComment:!0};r=t.isNullOrUndefined(r)?!0:r;u=t.isNullOrUndefined(u)?!0:u;k=(f.model.userName.length>0?f.model.userName:f._getLocStr("UserName"))+":\n";nt=f.XLEdit.getPropertyValue(e,o,"comment",s);t.isNullOrUndefined(i)?a.disable&&f.XLEdit._updateDataContainer(c,{dataObj:{comment:{value:k,isVisible:t.isNullOrUndefined(f.XLEdit.getPropertyValue(e,o,"comment",s))?r:f.XLEdit.getPropertyValue(e,o,"comment",s).isVisible}}}):(u&&(i=k+i),f.XLEdit._updateDataContainer(c,{dataObj:{comment:{value:i,isVisible:t.isNullOrUndefined(f.XLEdit.getPropertyValue(e,o,"comment",s))?r:f.XLEdit.getPropertyValue(e,o,"comment",s).isVisible}}}));b=t.isNullOrUndefined(f.XLEdit.getPropertyValue(e,o,"comment",s))?(f.model.userName.length>0?f.model.userName:f._getLocStr("UserName"))+":\n":f.XLEdit.getPropertyValue(e,o,"comment",s).value;!f.model.allowComments||f.XLEdit._isEdit||f._isSheetRename||(f._isRowViewable(s,e)&&(y=f.getCell(e,o),y.prepend(t.buildTag("span.e-comment",t.buildTag("span.e-celltoparrow")).append(t.buildTag("textarea.e-comment-txtarea",b,{"z-index":10,"text-align":"left"}))).addClass("e-commentcell"),this._updateCmntArrowPos(y),v=y.find(".e-comment-txtarea"),this._updateCmtAreaPos(y,v),v.focus().setInputPos(v.val().length),w=!0,a.disable&&(v[0].disabled=!0)),(!h._isImported||h._isLoaded)&&(d=f.XLEdit.getPropertyValue(e,o,"comment",s),t.isNullOrUndefined(d)||(d.value=b)),r&&w?(v.focus(),!this._curCommentHCell||t.isNullOrUndefined(f.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment"))||f.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment").isVisible||(this._curCommentHCell.find(".e-comment-txtarea").hide(),this._curCommentHCell=null),f.model.allowDragAndDrop&&!f.XLDragDrop._isDragAndDropped&&this._updateCurrentCell(e,o),a.disable?this._updateCmntRibIcons():(this._isCommentEdit=!0,f.model.showRibbon&&f.XLRibbon._disableRibbonIcons())):w&&(this._isShowAllComments||f.XLEdit.getPropertyValue(e,o,"comment",s).isVisible||v.hide(),f.model.showRibbon&&(!h._isImported||h._isLoaded)&&f.model.allowDragAndDrop&&!f.XLDragDrop._isDragAndDropped&&this._updateCmntRibIcons(f.XLClipboard._isSpecial?f.getActiveCell():{rowIndex:e,colIndex:o})),f._isRibbonClick||f._isUndoRedo||f._hasComment||f._isExport||f._dupDetails||(l.selectedCell[0].curComment=f.XLEdit.getPropertyValue(e,o,"comment"),l.showUserName=u,l.showEditPanel=r,f._completeAction(l),f._trigActionComplete(l)))}}},_updateCmtAreaPos:function(n,t){var r=this.XLObj,u=r.getActiveSheetIndex(),s=r._getContent(u).find("#hscrollBar").offset(),f=r._getContent(u).find("#vscrollBar").offset(),h=r._getJSSheetHeader(u).offset(),i=t.offset(),e=t.height(),o=t.width();r.model.scrollSettings.allowScrolling&&(i.top+e+5>s.top&&i.left+o<f.left?t.css({top:-77}):i.left+o>f.left&&i.top+e+5>s.top?t.css({left:-136,top:-81}):i.top+e>h.top&&i.left+o>f.left&&t.css({left:-137,top:n.height()+8}))},deleteComment:function(i,r,u,f){var e=this.XLObj,o;if(e.model.allowComments&&!e.model.isReadOnly){var w,h,c,v,y=[],p=[],l=r||e.getActiveSheetIndex(),s,a={sheetIndex:l,reqType:"comment",action:"delete",range:i};for(i=e._getRangeArgs(i,"object"),s=e._getSelectedCells(r,i).selCells,o=0;o<s.length;o++)e.XLEdit.getPropertyValue(s[o].rowIndex,s[o].colIndex,"comment",r)&&y.push(s[o]);if(e.model.allowComments){for(o=0;o<s.length;o++)if(h=s[o].rowIndex,c=s[o].colIndex,v=e.XLEdit.getPropertyValue(h,c,"comment",r),!t.isNullOrUndefined(v)){if(w=n(s[o]),u&&e._isHiddenRow(h)){s.splice(o,1);continue}e.model.showRibbon&&e._commentCount&&e._commentCount--;p.push({rowIndex:h,colIndex:c,prevComment:v,currComment:{}});e._isRowViewable(l,h)&&e.getCell(h,c,l).removeClass("e-commentcell").find(".e-comment").remove();e.getSheet(l)._commentColl[h]&&delete e.getSheet(l)._commentColl[h][c];delete e._dataContainer.sheets[l][h][c].comment}a.selectedCell=p;e.model.showRibbon&&y.length&&e.model.allowDragAndDrop&&!e.XLDragDrop._isDragAndDropped&&e.XLComment._updateCmntRibIcons();a.reqType=t.isNullOrUndefined(f)?"comment":"clear-comment";e._isUndoRedo||e._dupDetails||(e._completeAction(a),e._trigActionComplete(a))}}},editComment:function(n){var i=this.XLObj,r,f,u,e;if(i.model.allowComments&&!i.model.isReadOnly){if(u=i.getActiveSheetIndex(),i.model.allowLockCell&&i.getSheet(u).isSheetProtected)return!1;t.isNullOrUndefined(n)&&(n=i.getActiveCell());f=i.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"comment",u);r={reqType:"beforeEditComment",cellIndex:n,value:f.value,sheetIndex:u,isDisable:!1};i._trigger("beforeEditComment",r)&&(r.disable=!0);f.value=r.value;i.XLEdit._updateDataContainer(n,{dataObj:{comment:{value:f.value,isVisible:f.isVisible}}});i.XLEdit._isEdit||i._isSheetRename||(i.model.allowComments&&(t.isNullOrUndefined(i.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"comment"))||(i._isAutoWHMode||i.XLScroll._scrollSelectedPosition(u,n),i._isRowViewable(u,n.rowIndex)&&(e=i.getCell(n.rowIndex,n.colIndex).find(".e-comment-txtarea"),e.text(r.data),e.css("display","inline-table").focus().setInputPos(e.text().length)),r.disable||(this._isCommentEdit=!0))),i.model.showRibbon&&!r.disable&&i.XLRibbon._disableRibbonIcons())}},showHideComment:function(n){var i=this.XLObj;if(i.model.allowComments&&!i.model.isReadOnly){var s=i.getActiveSheetIndex(),r,u,e,o=!1,f=!1;r=t.isNullOrUndefined(n)?i.getActiveCell():i._getCellIdx(n[0]);u=i.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"comment");t.isNullOrUndefined(u)||(i._isRowViewable(s,r.rowIndex)&&(e=i.getCell(r.rowIndex,r.colIndex).find(".e-comment-txtarea"),o=!0),u.isVisible?(o&&e.hide(),f=!1):(o&&e.css("display","inline-table"),this._curCommentHCell=null,f=!0));i.isUndefined(f)||(u.isVisible=f)}},showAllComments:function(){var t=this.XLObj,f;if(t.model.allowComments){for(var r,e,i,a=t.getActiveSheetIndex(),o,s,h,c=n("#"+t._id+"_Ribbon_Review_Comments_ShowAllComments").data("ejToggleButton"),l=["Review_Comments_PreviousComment","Review_Comments_NextComment"],v=this._isShowAllComments?!1:!0,u=1;u<=t.model.sheetCount;u++)for(o=t.getSheet(u)._commentColl,r=t.getObjectKeys(o),i=0;i<r.length;i++){for(e=t.getObjectKeys(o[r[i]]),f=0;f<e.length;f++)t._isRowViewable(a,parseInt(r[i]))&&(s=t.getCell(parseInt(r[i]),parseInt(e[f]),u).find(".e-comment-txtarea"),this._isShowAllComments?s.hide():s.css("display","inline-table")),t.XLEdit.getPropertyValue(r[i],e[f],"comment",u).isVisible=!this._isShowAllComments;i==0&&(h=!0)}this._isShowAllComments=!this._isShowAllComments;t.model.showRibbon&&c&&c.model.toggleState?t.XLRibbon._disableButtons(l,"ejButton"):t.model.showRibbon&&h&&t.XLRibbon._enableButtons(l,"ejButton")}},findPrevComment:function(){var i=this.XLObj,o,u,y,c,l,a,f,r,e,s,p,h,v;if(i.model.allowComments&&!i.model.isReadOnly){for(o=i.getActiveSheetIndex(),p=n("#"+i._id+"_Ribbon_Review_Comments_NewComment"),f=o;f>0;f--)if(u=i.getSheet(f),i.getObjectLength(u._commentColl))for(f!==o&&i.gotoPage(f,!1),i.model.showRibbon&&(v=i.XLRibbon._getTabIndex("review"),v&&n("#"+i._id+"_Ribbon").ejRibbon("option","selectedItemIndex",v)),y=u.rowCount-1,c=u.colCount-1,f!==o&&this._updateCurrentCell(y-1,c-1),l=u._activeCell.rowIndex,a=u._activeCell.colIndex,r=l;r>=0;r--)for(r!==l&&(a=c-1),e=a;e>=0;e--)if(i.XLEdit.getPropertyValue(r,e,"comment",o)&&(u._hiddenFreezeRows.indexOf(r)>-1&&u._isFreezed?i.XLSearch._freezeScroll(r,e,u):i._isRowViewable(o,r)||i._scrollContent({y:i._getRowOffsetTop(u,r)},!0)),i._isRowViewable(o,r)){if(s=n(i.getCell(r,e)),h=n(s.find(".e-comment-txtarea")),u._activeCell.rowIndex!==r&&u._activeCell.colIndex!==e&&!t.isNullOrUndefined(i.XLEdit.getPropertyValueByElem(s,"comment"))&&i.XLEdit.getPropertyValueByElem(s,"comment").isVisible&&h.hide(),s.hasClass("e-commentcell")&&!h.is(":visible"))return h.css("display","inline-table").focus()&&this._updateCurrentCell(r,e),this._updateCommentsBtns(p),i.setSheetFocus(),!0;this._isShowAllComments||this._isCommentEdit||!s.hasClass("e-commentcell")||i.XLEdit.getPropertyValueByElem(s,"comment").isVisible||h.hide()}f===0&&i._showAlertDlg("","CommentFindEndAlert","findPrevComment",630)}},_updateCommentsBtns:function(n){var t=this.XLObj;t.model.showRibbon&&(t.XLRibbon._enableButtons(["Review_Comments_DeleteComment","Review_Comments_ShowHideComment"],"ejButton"),n.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt"),n.find(".e-btntxt").text(t._getLocStr("EditComment")))},findNextComment:function(){var i=this.XLObj;if(i.model.allowComments&&!i.model.isReadOnly){for(var u,c,l,v,y,r,o,e,h,a,p=!1,s=i.getActiveSheetIndex(),w=n("#"+i._id+"_Ribbon_Review_Comments_NewComment"),f=s;f<=i.model.sheetCount;f++)if(u=i.getSheet(f),i.getObjectLength(u._commentColl))for(f!==s&&i.gotoPage(f,!1),i.model.showRibbon&&(a=i.XLRibbon._getTabIndex("review"),a&&n("#"+i._id+"_Ribbon").ejRibbon("option","selectedItemIndex",a)),f!==s&&this._updateCurrentCell(0,0),c=u._activeCell.rowIndex,l=u._activeCell.colIndex,v=u.rowCount-1,y=u.colCount-1,r=c;r<v;r++)for(r!==c&&(l=0),o=l;o<y;o++){if(i.XLEdit.getPropertyValue(r,o,"comment",s)&&(u._isFreezed?i.XLSearch._freezeScroll(r,o,u):i._isRowViewable(s,r)||i._scrollContent({y:i._getRowOffsetTop(u,r)},!0),p=!i.getActiveCellElem()),i._isRowViewable(s,r)&&(e=n(i.getCell(r,o)),h=n(e.find(".e-comment-txtarea")),p||i.getActiveCellElem()[0]===e[0]||t.isNullOrUndefined(i.XLEdit.getPropertyValueByElem(e,"comment"))||!i.XLEdit.getPropertyValueByElem(e,"comment").isVisible||h.hide(),e.hasClass("e-commentcell")&&!h.is(":visible")))return h.css("display","inline-table").focus(),this._updateCurrentCell(r,o),this._updateCommentsBtns(w),i.setSheetFocus(),!0;this._isShowAllComments||this._isCommentEdit||!e.hasClass("e-commentcell")||i.XLEdit.getPropertyValueByElem(e,"comment").isVisible||h.hide()}f===i.model.sheetCount+1&&i._showAlertDlg("","CommentFindEndAlert","findNextComment",630)}},_commentMouseMove:function(i){var e=this.XLObj,r,f,u;(r=i.target.tagName==="TD"?n(i.target):n(i.target).parent("td"),r.length)&&(f=r.find(".e-comment-txtarea"),this._isCommentEdit||(t.isNullOrUndefined(this._curCommentHCell)||r!==this._curCommentHCell&&(u=e.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment"),t.isNullOrUndefined(u)||u.isVisible||(this._curCommentHCell.find(".e-comment-txtarea").hide(),this._curCommentHCell=null)),r[0].tagName==="TD"&&r.hasClass("e-commentcell")&&(f.css("display","inline-table"),this._curCommentHCell=r)))},_commentMouseDownHandler:function(t){var i=this.XLObj,r=i.getActiveCell(),o=i.getActiveSheetIndex(),u,f,e;i._isRowViewable(o,r.rowIndex)&&(u=i.getCell(r.rowIndex,r.colIndex,o),e=n(u.find(".e-comment-txtarea")),u.hasClass("e-commentcell")&&e.get()[0]!==t.target&&(f=i.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"comment"),this._isCommentEdit&&this._updateCurCmntVal(r),this._isShowAllComments||i.isUndefined(f)||f.isVisible||e.hide()));i._hasClass(t.target,"e-comment-txtarea")&&!t.target.disabled&&(n(t.target).focus().css("z-index",10)&&(this._isCommentEdit=!0),this._updateCurrentCell(n(t.target).parents("td").parent().index(),n(t.target).parents("td").index()),i.model.showRibbon&&i.XLRibbon._disableRibbonIcons())},_updateCmntRibIcons:function(t){var f,i=this.XLObj,e=["Review_Comments_ShowHideComment","Review_Comments_DeleteComment"],u=i.getActiveSheetIndex(),l=i.getSheetElement(u),r=n("#"+i._id+"_Ribbon_Review_Comments_NewComment"),h=i.getActiveCell(),o=i.getSheet(u),c=o._selectedCells,s=o.selectedRange;t=i.model.allowDragAndDrop&&!i.XLDragDrop._isDragAndDropped?t?t:h:{rowIndex:i._dStartCell.rowIndex,colIndex:i._dStartCell.colIndex};i.XLRibbon._enableButtons(["Review_Comments_NewComment"],"ejButton");i.XLRibbon._enableButtons(i.XLRibbon._cmntTglBtnIds,"ejToggleButton");f=i.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"comment",u);f?(i.XLRibbon._enableButtons(e,"ejButton"),r.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt"),r.find(".e-btntxt").text(i._getLocStr("EditComment"))):(r.find(".e-icon").removeClass("e-ssr-editcmnt").addClass("e-ssr-newcmnt"),r.find(".e-btntxt").text(i._getLocStr("NewComment")),i.XLRibbon._disableButtons(e,"ejButton"));this._isShowAllComments||i._commentCount===0?i.XLRibbon._disableButtons(["Review_Comments_PreviousComment","Review_Comments_NextComment"],"ejButton"):i.XLRibbon._enableButtons(["Review_Comments_PreviousComment","Review_Comments_NextComment"],"ejButton");c.length&&i.inRange(s,t.rowIndex,t.colIndex)&&i.XLEdit._rangeHasProperty(s,"comment")&&i.XLRibbon._enableButtons(["Review_Comments_DeleteComment"],"ejButton")},_updateCurCmntVal:function(n,i){i=t.isNullOrUndefined(i)?"":i;var r=this.XLObj,s=r.getActiveSheetIndex(),c=t.isNullOrUndefined(n)?r.getActiveCell():n,o,l=[],a="User Name:",h=!1,e={sheetIndex:s,reqType:"comment"},u=c.rowIndex,f=c.colIndex;r._isRowViewable(e.sheetIndex,u)&&(o=r.getCell(u,f,s).find(".e-comment-txtarea"),h=!0,o.scrollTop(0));l.push({rowIndex:u,colIndex:f});e.action=t.isNullOrUndefined(r.XLEdit.getPropertyValue(u,f,"comment"))?"add":"edit";e.selectedCell=l;e.selectedCell[0].prevComment=r.XLEdit.getPropertyValue(u,f,"comment");h&&(a=o.css("z-index",9).val());r.XLEdit._updateDataContainer({rowIndex:u,colIndex:f},{dataObj:{comment:{value:a,isVisible:r.isUndefined(r.XLEdit.getPropertyValue(u,f,"comment"))?this._isShowAllComments:r.XLEdit.getPropertyValue(u,f,"comment").isVisible}}});!h||this._isShowAllComments||r.XLEdit.getPropertyValue(u,f,"comment").isVisible||o.hide();r.setSheetFocus();this._isCommentEdit=!1;r.XLCellNav._isNavigate=!0;r.model.showRibbon&&r.XLRibbon._enableRibbonIcons();r.XLEdit._updateUsedRange(u,f,s);e.selectedCell[0].curComment=r.XLEdit.getPropertyValue(u,f,"comment");r._isUndoRedo||i==="paste"||(r._completeAction(e),r._trigActionComplete(e))},_updateCurrentCell:function(n,t,i){var r=this.XLObj,u={rowIndex:n,colIndex:t},f;i=i?i:r.model.activeSheetIndex;f=r.getSheet(i);f._activeCell=u;r.model.allowSelection&&r.XLSelection.selectRange(u,u,i);f._startCell=f._endCell=u;r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement()},_visibleCmntCnt:function(n,t){n.find(".e-comment")[t?"show":"hide"]()},_updateCmntArrowPos:function(t,i,r){var o,l,u,c,e,s,f=this.XLObj,i=f._getSheetIndex(i),h=f.getSheet(i),a=t||f._getContent(i).find(".e-commentcell");if(r=r||{},f.model.allowComments)for(o=0,l=a.length;o<l;o++)if((s=n(a[o]),u=f._getCellIdx(s[0]),!(u.rowIndex<r.rowIndex)&&!(u.colIndex<r.colIndex))&&(e=s.find(".e-comment"),f._isInsdel&&(u.rowIndex in h._commentColl||(h._commentColl[u.rowIndex]={}),h._commentColl[u.rowIndex][u.colIndex]={isComment:!0}),e.length)){if(c=f._getCellInfo(u,i),h.columnsWidthCollection[u.colIndex]<5){e.hide();continue}e.is(":hidden")&&e.show();e.css({top:c.top+"px",left:c.left+s.width()+"px"})}},_updateCmntFrmCntnr:function(n,t){var i=this.XLObj;i.XLEdit.getPropertyValue(n,t,"comment")&&(i._isRowViewable(null,t)&&i.getCell(n,t).hasClass("e-commentcell")&&this.deleteComment([n,t,n,t]),i._dupDetails=!0,this.setComment([n,t,n,t],null,!1),i._dupDetails=!1)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.contextmenu=function(n){this.XLObj=n;this._clrFltrEnable=!1;this._isMenuOpened=!1;this._uniqueClass=n._id+"-cmenu";this._selColor="";this._changedDataSource=!1;this._rowCellMenuDataMobile=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"PasteSpecial",text:n._getLocStr("Paste"),parentId:null,spriteCssClass:"e-icon e-ss-paste"},{id:"FormatCells",text:n._getLocStr("FormatCells")+"...",parentId:null,spriteCssClass:"e-icon e-ss-formatcells"},{id:"BackgroundColor",text:n._getLocStr("BackgroundColor"),parentId:null,spriteCssClass:"e-icon e-ss-backgroundcolor"},{id:"FontColor",text:n._getLocStr("FontColor"),parentId:null,spriteCssClass:"e-icon e-ss-fontcolor"},];this._headerMenuDataMobile=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"PasteSpecial",text:n._getLocStr("Paste"),parentId:null,spriteCssClass:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert"),parentId:null},{id:"Delete",text:n._getLocStr("Delete"),parentId:null},{id:"Hide",text:n._getLocStr("Hide"),parentId:null},{id:"Unhide",text:n._getLocStr("Unhide"),parentId:null},];this._rowCellMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,spriteCssClass:"e-icon e-ss-paste"},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"},{id:"Insert",text:n._getLocStr("Insert")+"...",parentId:null},{id:"Delete",text:n._getLocStr("Delete")+"...",parentId:null},{id:"Filter",text:n._getLocStr("Filter"),parentId:null,spriteCssClass:"e-icon e-ss-filter"},{id:"ClearFilter",parentId:"Filter",text:n._getLocStr("ClearFilter"),spriteCssClass:"e-icon e-ss-filternone"},{id:"FilterSelected",parentId:"Filter",text:n._getLocStr("FilterSelected"),spriteCssClass:"e-icon e-ss-filter"},{id:"Sort",text:n._getLocStr("Sort"),parentId:null,spriteCssClass:"e-icon e-ss-sortatoz"},{id:"SortAtoZ",parentId:"Sort",text:n._getLocStr("SortAtoZ"),spriteCssClass:"e-icon e-ss-sortatoz"},{id:"SortZtoA",parentId:"Sort",text:n._getLocStr("SortZtoA"),spriteCssClass:"e-icon e-ss-sortztoa"},{id:"PutCellColor",parentId:"Sort",text:n._getLocStr("PutCellColor"),spriteCssClass:""},{id:"PutFontColor",parentId:"Sort",text:n._getLocStr("PutFontColor"),spriteCssClass:""},{id:"ctxComment",parentId:null,text:n._getLocStr("Comment")},{id:"ctxInsrtCmnt",text:n._getLocStr("InsertComment"),parentId:"ctxComment",spriteCssClass:"e-icon e-ss-newcmnt"},{id:"ctxEditCmnt",text:n._getLocStr("EditComment"),parentId:"ctxComment",spriteCssClass:"e-icon e-ss-editcmnt"},{id:"ctxDeleteCmnt",text:n._getLocStr("DeleteComment"),parentId:"ctxComment",spriteCssClass:"e-icon e-ss-deletecmnt"},{id:"ctxShwHdCmnt",text:n._getLocStr("ShowHide"),parentId:"ctxComment",spriteCssClass:"e-icon"},{id:"FormatCells",text:n._getLocStr("FormatCells")+"...",parentId:null,spriteCssClass:"e-icon e-ss-formatcells"},{id:"CmHyperLink",text:n._getLocStr("HyperLink"),parentId:null,spriteCssClass:"e-icon e-ss-hyperlink"},{id:"HyperLink",text:n._getLocStr("HyperLink")+"...",parentId:"CmHyperLink",spriteCssClass:"e-icon e-ss-hyperlink"},{id:"EditLink",text:n._getLocStr("EditLink")+"...",parentId:"CmHyperLink"},{id:"OpenLink",text:n._getLocStr("OpenLink"),parentId:"CmHyperLink"},{id:"RemoveLink",text:n._getLocStr("RemoveLink"),parentId:"CmHyperLink",spriteCssClass:"e-icon e-ss-removelink"},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,spriteCssClass:"e-icon e-ss-clear"}];this._rowHeaderMenuData=this._columnHeaderMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,spriteCssClass:"e-icon e-ss-paste"},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"},{id:"Insert",text:n._getLocStr("Insert"),parentId:null},{id:"Delete",text:n._getLocStr("Delete"),parentId:null},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,spriteCssClass:"e-icon e-ss-clear"},{id:"Hide",text:n._getLocStr("Hide"),parentId:null},{id:"Unhide",text:n._getLocStr("Unhide"),parentId:null}];this._footerMenuData=[{id:"InsertSheet",text:n._getLocStr("InsertSheet"),parentId:null},{id:"DeleteSheet",text:n._getLocStr("DeleteSheet"),parentId:null,spriteCssClass:"e-icon e-ss-delete"},{id:"RenameSheet",text:n._getLocStr("RenameSheet"),parentId:null,spriteCssClass:"e-icon "},{id:"MoveorCopy",text:n._getLocStr("MoveorCopy")+"...",parentId:null,spriteCssClass:"e-icon "},{id:"HideSheet",text:n._getLocStr("HideSheet"),parentId:null,spriteCssClass:"e-icon "},{id:"UnhideSheet",text:n._getLocStr("UnhideSheet"),parentId:null,spriteCssClass:"e-icon "},{id:"ProtectSheet",text:n._getLocStr("Protectsheet"),parentId:null,spriteCssClass:"e-icon e-ss-cmenuprotect"}];this._chartMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"ChartType",text:n._getLocStr("ChangeChartType")+"...",parentId:null},{id:"SelectData",text:n._getLocStr("SelectData")+"...",parentId:null}];this._imgMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"ChangePicture",text:n._getLocStr("ChangePicture"),parentId:null}];this._pivotMenuData=[{id:"Refresh",text:n._getLocStr("Refresh"),parentId:null,spriteCssClass:"e-icon e-ss-pivotrefresh"}];this._protectRowMenuIds=["Insert","Delete","Filter","ctxComment","Sort","LockCells","CmHyperLink","FormatCells","ClearContents"];this._prtctHeaderIds=["Insert","Delete","Hide","Unhide","ClearContents"];this._footerIds=["InsertSheet","DeleteSheet","RenameSheet","MoveorCopy","HideSheet","UnhideSheet"]};t.Menu.prototype._calculateContextMenuPosition=function(t){var s=this.element.get(0).id,e=this.element.data("id"),o=n("#"+e).data("ejSpreadsheet"),i,r,u,f;return this.element.css({top:"",left:""}),i=t.clientX+this.element.width()<n(window).width()?t.pageX:t.pageX-this.element.width(),u=o&&s.indexOf(e+"_contextMenuFooter")>-1?o.element.height():n(window).height(),r=t.clientY+this.element.height()<u?t.pageY:t.clientY>this.element.height()?t.pageY-this.element.height():u-this.element.outerHeight(),f=n("body").css("position")!="static"?n("body").offset():{left:0,top:0},i-=f.left,r-=f.top,{X:i,Y:r}};t.spreadsheetFeatures.contextmenu.prototype={_initContextMenu:function(){var n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none",width:"auto"},{id:this.XLObj._id+"_contextMenuCell"});this._createMenu(n,this.XLObj._phoneMode||this.XLObj._tabMode?this._rowCellMenuDataMobile:this._rowCellMenuData,"#"+this.XLObj._id+" .e-spreadsheetcontentcontainer");n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none"},{id:this.XLObj._id+"_contextMenuColumnHeader"});this._createMenu(n,this._columnHeaderMenuData,"#"+this.XLObj._id+" .e-spreadsheetheader .e-headercontent");n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none"},{id:this.XLObj._id+"_contextMenuRowHeader"});this._createMenu(n,this._rowHeaderMenuData,"#"+this.XLObj._id+" .e-rowheadercontent")},_initCMenuFooter:function(){var n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none"},{id:this.XLObj._id+"_contextMenuFooter"});n.data("id",this.XLObj._id);this._createMenu(n,this._footerMenuData,"#"+this.XLObj._id+" .e-pagercontainer")},_createMenu:function(i,r,u){i.ejMenu({fields:{dataSource:r,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"},menuType:t.MenuType.ContextMenu,openOnClick:!1,beforeOpen:n.proxy(this._beforeOpen,this),close:n.proxy(this._menuClose,this),click:n.proxy(this._menuClick,this),contextMenuTarget:u})},hideCMenu:function(){var t=this.XLObj;t.model.enableContextMenu&&(n("#"+t._id+"_contextMenuCell").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuColumnHeader").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuRowHeader").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuFooter").data("ejMenu").element.hide())},_getCMenuObj:function(i){var r=this.XLObj;switch(i){case t.Spreadsheet.ContextMenu.Cell:return n("#"+r._id+"_contextMenuCell").data("ejMenu");case t.Spreadsheet.ContextMenu.RowHeader:return n("#"+r._id+"_contextMenuRowHeader").data("ejMenu");case t.Spreadsheet.ContextMenu.ColumnHeader:return n("#"+r._id+"_contextMenuColumnHeader").data("ejMenu");case t.Spreadsheet.ContextMenu.Footer:return n("#"+r._id+"_contextMenuFooter").data("ejMenu")}},addItem:function(t,i,r,u){if(t&&!this.XLObj.model.isReadOnly){var c=this._getCMenuObj(t),s=!1,f,e,h,o;f=n.extend(!0,[],c.model.fields.dataSource);switch(r){case"insert":n.merge(f,i);s=!0;break;case"insertbefore":for(e=i.length,o=u-1||0;e>0;)f.splice(o,0,i[e-1]),e--;s=!0;break;case"insertafter":for(e=i.length,h=0,o=u||f.length;h<e;)f.splice(o,0,i[h]),h++,o++;s=!0}s&&this.changeDataSource(t,f)}},removeItem:function(t,i){if(t&&!this.XLObj.model.isReadOnly){var e=this._getCMenuObj(t),r,u,f=[];for(u=n.extend(!0,[],e.model.fields.dataSource),r=0,length=u.length;r<length;r++)i.indexOf(r+1)==-1&&f.push(u[r]);this.changeDataSource(t,f)}},enableItem:function(n,t){if(n&&!this.XLObj.model.isReadOnly){var r=this._getCMenuObj(n),i;if(t&&t.length>0)for(i=0,length=t.length;i<length;i++)r.enableItemByID(r.element.find("li:eq("+(t[i]-1)+")")[0].id);else r.enable()}},disableItem:function(n,t){if(n&&!this.XLObj.model.isReadOnly){var r=this._getCMenuObj(n),i;if(t&&t.length>0)for(i=0,length=t.length;i<length;i++)r.disableItemByID(r.element.find("li:eq("+(t[i]-1)+")")[0].id);else r.disable()}},changeDataSource:function(n,i){if(n&&!this.XLObj.model.isReadOnly&&i){var r=this._getCMenuObj(n);this._changedDataSource=!0;switch(n){case t.Spreadsheet.ContextMenu.Cell:this._rowCellMenuDataMobile=this._rowCellMenuData=i;break;case t.Spreadsheet.ContextMenu.RowHeader:this._headerMenuDataMobile=this._rowHeaderMenuData=i;break;case t.Spreadsheet.ContextMenu.ColumnHeader:this._headerMenuDataMobile=this._columnHeaderMenuData=i;break;case t.Spreadsheet.ContextMenu.Footer:this._footerMenuData=i}r&&r.option("fields",{dataSource:i})}},_updateContextMenuItems:function(i){var r=this.XLObj,k,d,ht=n("#"+r._id+"_contextMenuColumnHeader").data("ejMenu"),ct=n("#"+r._id+"_contextMenuRowHeader").data("ejMenu"),ut,g=i[0],h=r.getActiveSheetIndex(),v=r.getSheet(h),st=!t.isNullOrUndefined(r.getActiveCellElem())&&r.getActiveCellElem().length>0?r.getActiveCellElem():i,f=r._phoneMode||r._tabMode?this._rowCellMenuDataMobile:this._rowCellMenuData,u=n("#"+r._id+"_contextMenuCell").data("ejMenu"),e=n("#"+r._id+"_contextMenuFooter").data("ejMenu"),a=r.getActiveCell(h),c,s,ft,tt,it,et,p,ot,b,rt,o;if(i.hasClass("e-rowcell")||i.hasClass("e-hyperlinks")){var l,y=[],lt=r._getJSSheetHeader(h).find("th"),at=r._getJSSheetRowHeader(h).find("td"),nt=r.XLEdit.getPropertyValue(v._activeCell.rowIndex,v._activeCell.colIndex),w=r._getCellIdx(r._hasClass(i,"e-hyperlinks")?i.parents("td")[0]:g);if(this._isMenuOpened=!0,r.model.allowLockCell&&v.isSheetProtected&&r.XLEdit.getPropertyValue(w.rowIndex,w.colIndex,"isLocked",h))this._disableMenuOpt(this._protectRowMenuIds);else{if(i.hasClass("e-hyperlinks")&&(i=i.parents("td"),g=i[0]),r.model.allowHyperlink?(this._enableMenuOpt(["CmHyperLink"]),ft=r.XLEdit.getPropertyValue(w.rowIndex,w.colIndex,"hyperlink",h),tt=["EditLink","OpenLink","RemoveLink"],t.isNullOrUndefined(ft)?(this._disableMenuOpt(tt),this._enableMenuOpt(["HyperLink"])):(this._enableMenuOpt(tt),this._disableMenuOpt(["HyperLink"]))):this._disableMenuOpt(["CmHyperLink"]),r.model.allowFiltering){if(u.enableItemByID("Filter"),s=r.model.sheets[h].filterSettings.tableRange,it=r.XLEdit.getPropertyValue(a.rowIndex,a.colIndex,"tableName"),et=t.isNullOrUndefined(it)?-1:parseInt(it.replace("e-table","")),s.length>0){for(p=0,ot=s.length;p<ot;p++)if(s[p].tableID===et){c=p;break}!t.isNullOrUndefined(c)&&a.rowIndex<s[c].selectedRange.endRow+1&&a.rowIndex>s[c].selectedRange.startRow-2&&a.colIndex<s[c].multifilterIdx[s[c].multifilterIdx.length-1]+1&&a.colIndex>s[c].multifilterIdx[0]-1&&(k=r.getCell(s[c].selectedRange.startRow-1,a.colIndex,h).find("span"),k.length&&k[0].className.indexOf("e-ssfiltered")>-1&&(u.enableItemByID("ClearFilter"),this._clrFltrEnable=!0))}this._clrFltrEnable||u.disableItemByID("ClearFilter")}else u.disableItemByID("Filter");r.model.allowInsert?u.enableItemByID("Insert"):u.disableItemByID("Insert");r.model.allowDelete?u.enableItemByID("Delete"):u.disableItemByID("Delete");(r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem)&&!r.model.isReadOnly?(this._enableMenuOpt(["Paste"]),r.isPasteValuesOnly&&u.disableItemByID("PasteSpecial")):this._disableMenuOpt(["Paste"]);r.model.allowSorting?this._enableMenuOpt(["Sort"]):this._disableMenuOpt(["Sort"]);r.model.allowClear?this._enableMenuOpt(["ClearContents"]):this._disableMenuOpt(["ClearContents"]);r.model.allowCellFormatting?this._enableMenuOpt(["FormatCells"]):this._disableMenuOpt(["FormatCells"]);r._phoneMode||r._tabMode||(y=!t.isNullOrUndefined(nt)&&n.isNumeric(nt)?[r._getLocStr("SortSmallesttoLargest"),r._getLocStr("SortLargesttoSmallest")]:t.isNullOrUndefined(t.parseDate(nt))?[r._getLocStr("SortAtoZ"),r._getLocStr("SortZtoA")]:[r._getLocStr("SortOldesttoNewest"),r._getLocStr("SortNewesttoOldest")],r.model.allowComments?(u.element.find("#ctxComment").hasClass("e-disable-item")&&this._enableMenuOpt(["ctxComment"]),b=r.getSheetElement(r.getActiveSheetIndex()).find(".e-selected"),rt=b.length>1?st:i,rt.hasClass("e-commentcell")?(this._disableMenuOpt(["ctxInsrtCmnt"]),r.XLEdit.getPropertyValueByElem(rt,"comment").isVisible?(l=n.extend(f[19],{text:r._getLocStr("HideComment")}),u.remove(["#"+f[19].id]),u.insert([l],"#"+f[15].id)):(l=n.extend(f[19],{text:r._getLocStr("ShowHide")}),u.remove(["#"+f[19].id]),u.insert([l],"#"+f[15].id)),this._enableMenuOpt(["ctxEditCmnt","ctxDeleteCmnt","ctxShwHdCmnt"])):(this._enableMenuOpt(["ctxInsrtCmnt"]),this._disableMenuOpt(["ctxEditCmnt","ctxDeleteCmnt","ctxShwHdCmnt"])),b.filter(g).length>0&&b.filter(".e-commentcell").length>0&&this._enableMenuOpt(["ctxDeleteCmnt"])):this._disableMenuOpt(["ctxComment"]),f[11].text!==y[0]&&(l=n.extend(f[11],{text:y[0],spriteCssClass:f[11].sprite}),u.remove(["#"+f[11].id]),u.insertBefore([l],"#"+f[13].id)),f[12].text!==y[1]&&(l=n.extend(f[12],{text:y[1],spriteCssClass:f[12].sprite}),u.remove(["#"+f[12].id]),u.insertBefore([l],"#"+f[13].id)));r.model.showRibbon&&r.XLRibbon._dirtySelect(r._getContent(r.getActiveSheetIndex()).find(".e-selected"))}r.model.allowInsert?e.enableItemByID("InsertSheet"):e.disableItemByID("InsertSheet");r.model.allowDelete?e.enableItemByID("DeleteSheet"):e.disableItemByID("DeleteSheet");r.model.allowClipboard?this._enableMenuOpt(["Cut","Copy"]):this._disableMenuOpt(["Cut","Copy"]);(r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem)&&!r.model.isReadOnly?this._enableMenuOpt(["Paste"],o):this._disableMenuOpt(["Paste"],o)}else if(i.hasClass("e-link")){if(d=e.model.fields.dataSource.slice(0),r._isSheetRename&&!r._updateSheetNames()){args.cancel=!0;return}ut=r.model.allowLockCell&&v.isSheetProtected?r._getLocStr("Unprotect"):r._getLocStr("Protectsheet");d[6].text=ut;e.option("fields",{id:"id",dataSource:d,parentId:"parentId"});this._isMenuOpened=!0;r._isCommentEdit&&r.XLComment._updateCurCmntVal();i.not("a.e-currentitem, a.e-PP, a.e-NP").hasClass("e-numericitem")&&r.gotoPage(i.data("index"));r.model.exportSettings.password?this._disableMenuOpt(this._footerIds,"contextMenuFooter"):(r._getSheetNames(!1).length>0?e.enableItemByID("UnhideSheet"):e.disableItemByID("UnhideSheet"),r._getSheetNames(!0).length>1?(e.enableItemByID("DeleteSheet"),e.enableItemByID("HideSheet"),e.enableItemByID("MoveorCopy")):(e.disableItemByID("DeleteSheet"),e.disableItemByID("HideSheet"),e.disableItemByID("MoveorCopy")));r.model.allowLockCell?e.enableItemByID("ProtectSheet"):e.disableItemByID("ProtectSheet")}else(i.hasClass("e-headercelldiv")||i.hasClass("e-headercell")||i.hasClass("e-rowheader"))&&(o=i.hasClass("e-rowheader")?"contextMenuRowHeader":"contextMenuColumnHeader",r.model.allowClipboard?this._enableMenuOpt(["Cut","Copy"],o):this._disableMenuOpt(["Cut","Copy"],o),(r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem)&&!r.model.isReadOnly?this._enableMenuOpt(["Paste"],o):this._disableMenuOpt(["Paste"],o),r.model.allowLockCell&&v.isSheetProtected?this._disableMenuOpt(this._prtctHeaderIds,o):(r.model.allowClear?this._enableMenuOpt(["ClearContents"],o):this._disableMenuOpt(["ClearContents"],o),r.model.allowInsert?this._enableMenuOpt(["Insert"],o):this._disableMenuOpt(["Insert"],o),r.model.allowDelete?this._enableMenuOpt(["Delete"],o):this._disableMenuOpt(["Delete"],o),this._enableMenuOpt(["Hide","Unhide"],o)),r.model.showRibbon&&r.XLRibbon._dirtySelect(r._getContent(r.getActiveSheetIndex()).find(".e-selected")));r.model.allowInsert&&t.isNullOrUndefined(r.model.exportSettings.password)?this._enableMenuOpt(["InsertSheet","MoveorCopy"],"contextMenuFooter"):this._disableMenuOpt(["InsertSheet","MoveorCopy"],"contextMenuFooter");r.model.exportSettings.password?this._disableMenuOpt(["RenameSheet"]):this._enableMenuOpt(["RenameSheet"]);r.model.allowDelete&&r._getSheetNames(!0).length>1?this._enableMenuOpt(["DeleteSheet"],"contextMenuFooter"):this._disableMenuOpt(["DeleteSheet"],"contextMenuFooter");r.model.allowEditing?this._enableMenuOpt(["RenameSheet"],"contextMenuFooter"):this._disableMenuOpt(["RenameSheet"],"contextMenuFooter");r.model.isReadOnly&&(this._disableMenuOpt(["Cut","Insert","Delete","ClearContents"],"contextMenuColumnHeader"),this._disableMenuOpt(["Cut","Insert","Delete","ClearContents"],"contextMenuRowHeader"),this._disableMenuOpt(["Cut","Insert","Delete","Filter","Sort","ctxComment","FormatCells","CmHyperLink","ClearContents"],"contextMenuCell"))},_beforeOpen:function(i){var r=this.XLObj,s=r.XLResize,a,p,c;if(!r.model.enableContextMenu||i.events.type=="mousedown"&&i.target.id.indexOf("_picture")>-1||n(i.target).hasClass("e-numericitem")&&r.model.isReadOnly)return i.cancel=!0,!1;this._clrFltrEnable=!1;this.hideCMenu();var v=n("#"+r._id+"_contextMenuColumnHeader").data("ejMenu"),y=n("#"+r._id+"_contextMenuRowHeader").data("ejMenu"),l=i.target,b={target:l},u=n(l),o=r.getActiveSheetIndex(),h=r.getSheet(o),g=!t.isNullOrUndefined(r.getActiveCellElem())&&r.getActiveCellElem().length>0?r.getActiveCellElem():u,f=r._phoneMode||r._tabMode?this._rowCellMenuDataMobile:this._rowCellMenuData,e=n("#"+r._id+"_contextMenuCell").data("ejMenu"),nt=n("#"+r._id+"_contextMenuFooter").data("ejMenu"),tt=r.getActiveCell(o);if(!r._trigger("beforeOpen",b)){if((r.XLEdit._isEdit||r.model.allowComments&&r.XLComment._isCommentEdit||u.hasClass("e-filterspan")||i.events.which===1&&u.hasClass("e-hyperlinks")||u.parents("div").hasClass("e-vscroll")||u.parents("div").hasClass("e-hscroll")||n(l.parentNode).hasClass("e-pagercontainer")&&!u.hasClass("e-link")||!t.isNullOrUndefined(r.XLResize)&&r.XLResize._resizeStart||i.target.id.indexOf("Sheet_RenamePanel")>-1||u.parents().hasClass("e-grid")||u.hasClass("e-autofill"))&&(i.cancel=!0),s&&s._preventColResize(u.parent()[0].cellIndex,!0)&&u.hasClass("e-headercelldiv")&&(i.cancel=!0),s&&s._preventRowResize(parseInt(u.parent().attr("idx")),!0)&&u.hasClass("e-rowheader")&&(i.cancel=!0),u.hasClass("e-rowcell")||u.hasClass("e-hyperlinks"))a=r._getJSSheetHeader(o).find("th"),p=r._getJSSheetRowHeader(o).find("td"),t.isNullOrUndefined(r.XLEdit.getPropertyValueByElem(r.getCell(h._activeCell.rowIndex,h._activeCell.colIndex),"range"))?n(a[u.index()]).hasClass("e-colselected")||n(p[u.parent().index()]).hasClass("e-rowselected")?(f=n(a[u.index()]).hasClass("e-colselected")?this._columnHeaderMenuData:this._rowHeaderMenuData,JSON.stringify(f)!==JSON.stringify(i.model.fields.dataSource)&&this._changedDataSource&&e.option("fields",{dataSource:f,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"})):JSON.stringify(f)!==JSON.stringify(i.model.fields.dataSource)&&e.option("fields",{dataSource:f,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"}):(c=r.model.sheets[o].rangeSettings[r.XLEdit.getPropertyValueByElem(r.getCell(h._activeCell.rowIndex,h._activeCell.colIndex),"range")],e.option("fields",{dataSource:c.contextMenuSettings.dataSource,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"}),e.option("width",c.contextMenuSettings.width),e.option("height",c.contextMenuSettings.height));else if(u.hasClass("e-ss-imgvisual")||u.hasClass("e-ss-object")||u.closest("div").hasClass("e-ss-object")){if(this._isMenuOpened=!0,r.XLShape._shapeType==="chart"){var w=n.extend(!0,[],this._chartMenuData),k=document.getElementById(r._id+"_chart").value,d=r.XLChart._getShapeObj(k,"chart");f=this.XLObj.model.showRibbon?d.isChartSeries?w.splice(0,3):this._chartMenuData:w.splice(0,2)}else f=this._imgMenuData;JSON.stringify(f)!==JSON.stringify(i.model.fields.dataSource)&&e.option("fields",{dataSource:f,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"})}else u.hasClass("e-ss-pivot")||u.closest("div").hasClass("e-ss-pivot")?(f=this._pivotMenuData,JSON.stringify(f)!==JSON.stringify(i.model.fields.dataSource)&&e.option("fields",{dataSource:f,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"})):(u.hasClass("e-headercelldiv")||u.hasClass("e-headercell")||u.hasClass("e-rowheader"))&&(r._phoneMode||r._tabMode?(v.option("fields",{dataSource:this._headerMenuDataMobile}),y.option("fields",{dataSource:this._headerMenuDataMobile})):this._changedDataSource&&(v.option("fields",{dataSource:this._columnHeaderMenuData}),y.option("fields",{dataSource:this._rowHeaderMenuData})));this._changedDataSource||this._updateContextMenuItems(u);i.cancel&&(this._isMenuOpened=!1)}},_menuClick:function(n){this.XLObj._trigger("contextMenuClick",n)||this._processCMenu(n.ID,n.events.element)},_menuClose:function(){this._isMenuOpened=!1},_processCMenu:function(i,r){var k,f,u=this.XLObj,e=u.getActiveSheetIndex(),a,v,s=u.getSheet(e),y,p,h,c,o=s._selectedCells,w,b,l;switch(i){case"Cut":u.XLClipboard.cut();break;case"Copy":u.XLClipboard.copy();break;case"PasteSpecial":case"PasteValues":u.XLClipboard._isSpecial=!(i==="PasteValues");u.XLClipboard.paste();break;case"Insert":u._insDelStatus="insert";s._isColSelected?(h=u._getJSSheetHeader(e).find(".e-colhighlight"),u.insertEntireColumn(h[0].cellIndex,h[h.length-1].cellIndex)):s._isRowSelected?(c=u._getJSSheetRowHeader(e).find(".e-rowhighlight"),a=u._getCellIdx(c[0]),v=u._getCellIdx(c[c.length-1]),u.insertEntireRow(a.rowIndex,v.rowIndex)):u._showDialog(u._id+"_Ribbon_Others_Cells_InsertCellOptions");break;case"Delete":h=n(u._getJSSheetHeader(e).find("tr")[0]).find(".e-colselected");c=n(u.getRows(e)[0]).find(".e-rowselected");r.parentElement.id.indexOf("ColumnHeader")>-1||s._isColSelected?(h=u._getJSSheetHeader(e).find(".e-colhighlight"),u.deleteEntireColumn(h[0].cellIndex,h[h.length-1].cellIndex,[])):r.parentElement.id.indexOf("RowHeader")>-1||s._isRowSelected?(c=u._getJSSheetRowHeader(e).find(".e-rowhighlight"),a=u._getCellIdx(c[0]),v=u._getCellIdx(c[c.length-1]),u.deleteEntireRow(a.rowIndex,v.rowIndex,[])):u._showDialog(u._id+"_Ribbon_Others_Cells_DeleteCellOptions");break;case"FilterSelected":u._showDialog(u._id+"_Ribbon_Data_SortFilter_Filter");u.XLFilter.filterByActiveCell();this._clrFltrEnable=!1;break;case"ClearFilter":y=u.getActiveCell(e);w=u.XLEdit.getPropertyValue(y.rowIndex,y.colIndex,"tableName");b=t.isNullOrUndefined(w)?-1:parseInt(w.replace("e-table",""));b>-1?(p=u.model.sheets[e].columns[y.colIndex].field,u.XLFilter._clearFilterColumn(p,"","","","","",b),delete u._excelFilter._predicates[e][p]):u.XLFilter.clearFilter("apply");this._clrFltrEnable=!1;break;case"SortAtoZ":case"SortZtoA":case"SortSmallesttoLargest":case"SortLargesttoSmallest":case"SortOldesttoNewest":case"SortNewesttoOldest":case"PutCellColor":case"PutFontColor":u.model.allowSorting&&u.XLSort._sortHandler(i);break;case"ClearContents":l=u.model.sheets[e].selectedRange;u.clearContents(u._getAlphaRange(e,l[0],l[1],l[2],l[3]));break;case"InsertSheet":u.insertSheet();break;case"DeleteSheet":u.deleteSheet(e);break;case"RenameSheet":u._renameSheet();break;case"MoveorCopy":u._showDialog(u._id+"_MoveorCopy");break;case"Hide":s._isColSelected&&u._hideColumn(o[0].colIndex,o[o.length-1].colIndex);s._isRowSelected&&u._hideRow(o[0].rowIndex,o[o.length-1].rowIndex,"isRHide");break;case"Unhide":s._isColSelected&&u._showColumn(o[0].colIndex,o[o.length-1].colIndex);s._isRowSelected&&u._showRow(o[0].rowIndex,o[o.length-1].rowIndex,"isRHide");break;case"HyperLink":case"EditLink":u._showDialog(u._id+"_Ribbon_Insert_Links_Hyperlink");break;case"RemoveLink":u._removeHyperlink();break;case"OpenLink":u._openLink();break;case"ctxInsrtCmnt":u._dupDetails=!0;u.XLComment.setComment();u._dupDetails=!1;break;case"ctxEditCmnt":u.XLComment.editComment();break;case"ctxDeleteCmnt":u.XLComment.deleteComment();break;case"ctxShwHdCmnt":u.XLComment.showHideComment();break;case"ChangePicture":u._uploadImage=!0;u.XLShape._changePicture=!0;u.element.find("#"+u._id+"_file .e-uploadinput").click();break;case"ChartType":u._showDialog(u._id+"_Ribbon_ChartDesign_Type_ChangeChartType");u.XLRibbon._refreshChartTypeDlg();break;case"SelectData":u._showDialog(u._id+"_Ribbon_ChartDesign_Data_SelectData");k=document.getElementById(u._id+"_chart").value;f=u.XLChart._getShapeObj(k,"chart");f.isChartSeries||(n("#"+u._id+"_crxaxis").val(f.xRange?u._getAlphaRange(e,f.xRange[0],f.xRange[1],f.xRange[2],f.xRange[3]):""),n("#"+u._id+"_cryaxis").val(f.yRange?u._getAlphaRange(e,f.yRange[0],f.yRange[1],f.yRange[2],f.yRange[3]):""),n("#"+u._id+"_crlaxis").val(f.lRange?u._getAlphaRange(e,f.lRange[0],f.lRange[1],f.lRange[2],f.lRange[3]):""),u._selectDataval={xRange:n("#"+u._id+"_crxaxis").val(),yRange:n("#"+u._id+"_cryaxis").val(),lRange:n("#"+u._id+"_crlaxis").val()},n("#"+u._id+"_chartrangedlg").ejDialog("open"));break;case"HideSheet":u.hideSheet();break;case"UnhideSheet":u._showDialog(u._id+"_UnhideSheet");break;case"ProtectSheet":u.protectSheet(!s.isSheetProtected);break;case"FormatCells":u._showDialog(u._id+"_FormatCells");break;case"Refresh":u.XLPivot.refreshDataSource();break;case"BackgroundColor":n("#"+this.XLObj._id+"_colordlg").ejDialog("open");this._selColor={action:"bg-color",color:""};break;case"FontColor":n("#"+this.XLObj._id+"_colordlg").ejDialog("open");this._selColor={action:"color",color:""}}},_disableMenuOpt:function(t,i){var e=i||"contextMenuCell",u=n("#"+this.XLObj._id+"_"+e).data("ejMenu"),r,f;if(u)for(r=0,f=t.length;r<f;r++)u.disableItemByID(t[r])},_enableMenuOpt:function(t,i){var e=i||"contextMenuCell",u=n("#"+this.XLObj._id+"_"+e).data("ejMenu"),r,f;if(u)for(r=0,f=t.length;r<f;r++)u.enableItemByID(t[r])},_initColorDialog:function(){var r=this.XLObj,i=r._id+"_colordlg";if(!n("#"+i).length){var u=t.buildTag("div#"+i+".e-colordlg e-"+r._id+"-dlg ","",{display:"none"}),f=t.buildTag("div#"+i+"_dlgcontent .e-colordlgcontent"),h=t.buildTag("input#"+i+"_cpicker"),c=t.buildTag("div#"+i+"_condiv .e-dlg-btnctnr"),e=t.buildTag("input#"+this._id+"_dialog_Ok"),o=t.buildTag("input#"+this._id+"_dialog_Can","",{"margin-left":10}),s=t.buildTag("div#"+i+"_dlgbtncontent .e-dlg-btnfields");f.append(h);u.append(f);r.element.append(u);u.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:r._getLocStr("ColorPicker"),width:"240",height:"auto",minHeight:0,cssClass:"e-ss-dialog e-"+r._id+"-dlg"});n("#"+i+"_cpicker").ejColorPicker({value:"#278787",modelType:"palette",presetType:"basic",cssClass:"e-ss-colorpicker e-ss-menuclrpkr",select:n.proxy(this._cpClickHandler,this),showApplyCancel:!1});n("#"+i+"_cpickerWrapper").hide();f.append(n("#"+i+"_cpicker_popup").css("display","block"));e.ejButton({text:r._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._colorOkClick,this),enabled:!0});o.ejButton({text:r._getLocStr("Cancel"),showRoundedCorner:!0,width:60,click:t.proxy(this._colorCanClick,this)});s.append(c.append(e,o));u.append(s)}},_cpClickHandler:function(n){this._selColor.color=n.value},_colorOkClick:function(){var t=this.XLObj;t.XLFormat.format({style:this._selColor.action==="bg-color"?{"background-color":this._selColor.color}:{color:this._selColor.color}});t.setSheetFocus();n("#"+t._id+"_colordlg").ejDialog("close")},_colorCanClick:function(){n("#"+this.XLObj._id+"_colordlg").ejDialog("close")}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.sorting=function(n){this.XLObj=n;this._isSortByFilter=!1};t.spreadsheetFeatures.sorting.prototype={_sortHandler:function(n){var e,v,y,p,w,b,k,l,s,h,d,o,a={},g="",r={},i=this.XLObj,tt=i._formatRegx,c=i.getActiveSheetIndex(),u=i.getSheet(c),f=u._selectedCells,nt;if(g=u.columns[u._activeCell.colIndex].field,this._isSortByFilter=!1,n!="PutCellColor"&&n!="PutFontColor"){if(!i.model.allowSorting||!u._selectedCells.length)return;if(f.length===1&&i.selectAll(!1),b=n==="Ribbon_SortZtoA"||n==="SortZtoA"?t.sortOrder.Descending:t.sortOrder.Ascending,k=i.XLEdit.getPropertyValue(u._activeCell.rowIndex,u._activeCell.colIndex,"tableName",c)||"",l=i._getTableID(k),t.isNullOrUndefined(l)){if(r=u.selectedRange.slice(0),s=r[0],h=r[1],s===r[2])return;for(p=i.XLEdit.getPropertyValue(s,h),e=s+1;e<=r[2];e++)if(!i._isHiddenRow(e)){w=i.XLEdit.getPropertyValue(e,h);break}v=i.isNumber(p)?t.Spreadsheet.CellType.Number:t.Spreadsheet.CellType.String;y=i.isNumber(w)?t.Spreadsheet.CellType.Number:t.Spreadsheet.CellType.String;i.XLEdit.getPropertyValue(s,h,"merge")||i.XLEdit.getPropertyValue(e,h,"merge")||i.XLEdit.getPropertyValue(r[0],r[1],"calcValue")||(v!=y||i.XLEdit.getPropertyValue(r[0],r[1],"wrap")||i.XLEdit.getPropertyValue(r[0],r[1],"isFilterHeader"))&&r[0]++}else r=u.tableManager[l].range.slice(0),r[0]++;this.sortByRange(r,g,b)}else nt=f.length===1?this._selectSortRange(c,f[0]):u._startCell.rowIndex,d=i._getAlphaRange(c,nt,f[0].colIndex,f.length===1?f[0].rowIndex:u._endCell.rowIndex,f[0].colIndex),o=i.XLEdit.getPropertyValue(u._activeCell.rowIndex,u._activeCell.colIndex,"formats"),i.isUndefined(o)||(o["background-color"]&&(a["background-color"]=o["background-color"].toLowerCase()),o.color&&(a.color=o.color.toLowerCase()),this.sortByColor(n,a,d));f.length===1&&(i.XLSelection.selectRange(f[0],f[0],c),u._startCell=u._endCell=f[0],i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement())},_selectSortRange:function(n,t){for(var u=this.XLObj,r=u.getSheet(n).filterSettings.tableRange,i=0,f=r.length;i<f;i++)if(r[i].multifilterIdx.indexOf(t.colIndex)>-1&&t.rowIndex>r[i].startRow-1&&t.rowIndex<r[i].endRow+1)return r[i].startRow;return u.selectAll(),u.getSheet(n)._selectedCells[0].rowIndex},sortByColor:function(n,i,r){var f=this.XLObj;if(r=f._getRangeArgs(r,"object"),f.model.allowSorting&&!this._sortRangeAlert(r)&&!f.model.isReadOnly){var o=f.getActiveSheetIndex(),u={oprType:n},e,s,c=f.getSheet(o),h;h=c.columns[r[1]].field;t.isNullOrUndefined(i)||(n==="PutCellColor"?(i["background-color"]&&(i=i["background-color"]),u.operation="sortbgcolor",u.bgcolor=i):(i.color&&(i=i.color),u.operation="sortfgcolor",u.fgcolor=i),u.requestType=u.action="sortbycolor",u.sortColumn=h,u.selRange={startCell:{rowIndex:r[0],colIndex:r[1]},endCell:{rowIndex:r[2],colIndex:r[3]}},u.rangeData=f.getRangeDataAsObject(u.selRange.startCell,u.selRange.endCell,!0)[0],u.sortRange=r,e=r[0],t.isNullOrUndefined(e)||(s=f.XLFilter._createSelection(o,e,r[2],r[1],[]).endRowIndex,e=n==="PutCellColor"||n==="PutFontColor"?e:e,u.range=f.model.sheets[o]._selectedRange={startRow:e,endRow:s,dataSourceIndexes:[]},f._processBindings(u)))}},_getSortColorRange:function(n){var r=this.XLObj,i=r.getCell(n.rowIndex,n.colIndex),u=!1,s,t,e=0,h=!1,f=n.rowIndex,o=n.colIndex;if(i.text().length<1){for(t=f;t<f+2;t++)if(i=r.getCell(t,o),i.is(":visible")&&i.text().length>0){u=!0;e=t;break}if(!u){for(t=f;t>f-2;t--)t>-1&&(i=r.getCell(t,o),i.text().length===0&&t>0&&(i=r.getCell(t-1,o),i.text().length==0&&(h=!0)));if(!h)for(t=f-2;t>0;t--)if(i=r.getCell(t,o),i.is(":visible")&&i.text().length===0){s=t+1;u=!0;e=s;break}}}else for(t=f;t>=0;t--){if(i=r.getCell(t,o),i.is(":visible")&&i.text().length===0){s=t+1;u=!0;e=s;break}u||t!=0||(e=t,u=!0)}if(u)return e;r._showAlertDlg("Alert","Alert",null,630)},_sortRangeAlert:function(n){for(var f,c,t=this.XLObj,e,i,r=r?r:t.getActiveSheetIndex(),s,h=t.getSheet(r)._mergeColl,n=t._getRangeArgs(n,"object"),o=t.getObjectKeys(h),u=0,l=o.length;u<l;u++)for(e=t.getObjectKeys(h[o[u]]),f=0,c=e.length;f<c;f++)if(s=t._dataContainer.sheets[r][o[u]][e[f]].merge,i=t.getRangeIndices(s.mRange),n[0]<=i[0]&&n[2]>=i[2]||n[0]>=i[0]&&n[2]<i[2])return t._showAlertDlg("Alert","MergeSortAlert","",380),!0;return t.XLEdit._rangeHasProperty(n,"calcValue")?(t._showAlertDlg("Alert","FormulaSortAlert","",315),!0):!1},sortByRange:function(n,i,r){var u=this.XLObj;if(u.model.allowSorting&&!u.model.isReadOnly){var c,l=u.getActiveSheetIndex(),o=0,a=[],f={},v=[],e,y,s,h=u._getJSSheetHeader(l).find(".e-colselected").length;if(u.model.allowSorting){if(n=u._getRangeArgs(n,"object"),this._sortRangeAlert(n))return!0;if(this._isSortByFilter&&h<1){for(s=this._isSortByFilter?n[0]-1:n[0],y=u._getAlphaRange(l,s,n[1],s+1,n[3]),e=u._getAlphaRangeCells(y).find(".e-filterspan"),c=e.length;o<c;)v.push({colIndex:e[o].parentNode.cellIndex,rowIndex:e.eq(o).parents("tr").index()}),o++;e.length&&(n[0]=this._isSortByFilter?n[0]:n[0]+1)}return a=u.getRangeDataAsObject({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]},!0)[0],f.requestType=f.reqType=t.Spreadsheet.Actions.Sorting,f.range=n,f.columnName=i,f.rangeData=a,f.action="sorting",f.sortDirection=r,f.filterIcon=v,f.isSortByFilter=this._isSortByFilter,f.colSelected=h,u._processBindings(f),h&&this._isSortByFilter&&u.XLFilter._changeSortIcon({rowIndex:n[0]-1,colIndex:n[1]},r),!1}}},_sortComplete:function(n){var t=this.XLObj,i=n.range,r=this._swapSortedDatas(n),u=r[1];t._dupDetails=!0;n.rangeData=r[0];t.model.allowComments&&t.XLComment.deleteComment(i,null,!0,"comment");t._removeHyperlink(null,null,!0,i);t._isSort=!0;t.clearRangeData(i,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0);t.model.allowCellFormatting&&t.XLFormat.removeStyle(i,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0});t.XLEdit.updateCellWithContainer(u,i,null,!0);t._isSort=!1;t.refreshOverflow([i[0],i[1],i[2],i[3]],t.getActiveSheetIndex());this._refreshRowHeight(i,u);t._dupDetails=!1},_refreshRowHeight:function(n,t){for(var i,u,f=0,s=0,r=this.XLObj,e=r._getSheetIndex(),o=r.getSheet(e),h=r._getJSSheetContent(e).find(".e-content"),c=r._getJSSheetRowHeaderContent(e);n[0]+f<=n[2];){for(i=n[0]+f,u=(f-s)*(n[3]-n[1]+1);o.hideRowsCollection.indexOf(i)>-1||o._hiddenFreezeRows.indexOf(i)>-1&&i<n[2];)i++&&f++&&s++;!r.model.scrollSettings.allowVirtualScrolling&&t[u]&&(h.find("tr:eq("+i+")").height(t[u].rheight),c.find("tr:eq("+i+")").height(t[u].rheight));t[u]&&(o.rowsHeightCollection[i]=t[u].rheight);f++}r.XLScroll._getRowHeights(e,i);r.model.scrollSettings.allowVirtualScrolling&&r.refreshContent(e);o._isFreezed&&r.XLFreeze._refreshFreezeRowDiv()},_swapSortedDatas:function(t){for(var v,f,e,r,s=0,o=0,y=0,p=[],h=[],c=[],l=this.XLObj.getSheet(),w=t.model.currentViewData,k=w.length,d=this.XLObj._generateColCount(t.columnName)-1,b,i=t.range,a=i[3]-i[1]+1,g=d-i[1],u=this.XLObj.getRangeData({range:i,property:["value","value2","type","formatStr","formats","decimalPlaces","thousandSeparator","range","format","comment","hyperlink","rule"],skipHiddenRow:!0});i[0]+o<=i[2];){for(r=i[0]+o,f=(o-y)*(i[3]-i[1]+1);(l.hideRowsCollection.indexOf(r)>-1||l._hiddenFreezeRows.indexOf(r)>-1)&&r<i[2];)r++&&o++&&y++;u[f]&&(u[f].rheight=l.rowsHeightCollection[r]);o++}for(n.extend(!0,p,u),h.push(p);s<k;){for(v=w[s][t.columnName],e=g,b=u.length;e<b;){if(u[e].value===v){f=this._getMinIdx(e,a);c=c.concat(u.splice(f,a));break}e+=a}s++}return h.push(c),h},_getMinIdx:function(n,t){var i,r;if(i=r=t,n<t)return 0;while(i<=n){if(r+=t,r>n)return i;i+=t}}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.dragAndDrop=function(n){this.XLObj=n;this._isDragAndDropStart=!1;this._dragAndDropCell={rowIndex:0,colIndex:0};this._isDragAndDropped=!1;this._allowDragAndDrop=!1;this._target=null;this._cellIdx={}};t.spreadsheetFeatures.dragAndDrop.prototype={moveRangeTo:function(n,t){this._moveRangeTo(n,t)},_moveRangeTo:function(i,r,u){var f=this.XLObj,p,tt,ut,o;if(f.model.allowDragAndDrop&&!f.model.isReadOnly&&f.model.allowEditing){var s,a,b,e,k,c,v,y,d,h,it,l,g=[],nt=[],rt=[],w;for(s=f.getActiveSheetIndex(),a=f.getSheet(s),i=f.swapRange(f._toIntrnlRange(i,s)),r=f.swapRange(f._toIntrnlRange(r,s)),r[2]=r[0]+(i[2]-i[0]),r[3]=r[1]+(i[3]-i[1]),c={rowIndex:r[0],colIndex:r[1]},v={rowIndex:r[2],colIndex:r[3]},u=u||["value","value2","type","formatStr","decimalPlaces","thousandSeparator","range","format","border","borders","comment","hyperlink","picture","cFormatRule","rule","chart","isLocked","wrap","formats","tformats","tborders","isFilterHeader","filterState","isFilterVisible","tableName"],b=f.getRangeData({range:i,property:u}),f.model.allowCellFormatting&&(k=f.XLFormat.getHashCodeClassAsArray(i)),f.model.allowConditionalFormats&&(y=f.XLEdit.getPropertyValue(i[0],i[1],"cFormatRule")),!f.isUndefined(y)&&y.length>0&&(h=y[0].split("_"),y={action:h[0],inputs:[h[2],h[3]],color:h[4],range:h[5]}),o=i[0];o<=i[2];o++)for(g.push({rowIndex:o,height:a.rowsHeightCollection[o]}),p=i[1];p<=i[3];p++)f.XLEdit.getPropertyValue(o,p,"wrap")&&f.setWrapText("unwrap",f._getAlphaRange(s,o,p,o,p));if(e={sheetIndex:s,reqType:"reorder-cells",sourceData:n.extend(!0,[],b),sourceRange:i,destinationRange:r,sourceFormat:k,destinationFormat:f.model.allowCellFormatting&&f.XLFormat.getHashCodeClassAsArray(r),destinationData:f.getRangeData({range:r}),sourceCFormat:y,sourceHeight:g,property:u},f.XLRibbon._isDirtySelect){f._showAlertDlg("Alert","DragAlert",null,440);f.performSelection(i);return}if(l=f._checkTableRange(f._getAlphaRange(s,i[0],i[1],i[2],i[3])),w=f._checkFilterRange(f._getAlphaRange(s,i[0],i[1],i[2],i[3])),f._dupDetails=!0,l.status==="full")e.tblObj=l.tableObj,e.tblObj.tblId=l.tblId,e.tblObj.header=!0,f.XLFormat.removeTable(l.tblId),f.XLFormat.removeStyle(l.range);else if(w.status==="full")e.tRange=w.tRange,f.XLFilter.clearFilter("remove");else if(l.status==="partial"||w.status==="partial"||f.XLRibbon._isFilterSelect.isFiltered){f._showAlertDlg("Alert","DragAlert",null,440);f.performSelection(i);return}for(f.model.allowComments&&f.XLComment.deleteComment(),f.clearRangeData(i,u),f.clearRangeData(r,u),t.isNullOrUndefined(f._ddlCell)||(f.element.find("#"+f._id+"ddl").ejDropDownList("hidePopup"),f.element.find("#"+f._id+"ddlspan").remove(),f._ddlCell=null),f.model.allowCellFormatting&&!f.XLRibbon._isDirtySelect&&(f.XLFormat.removeStyle(i),f.XLFormat.removeStyle(r,{cellStyle:!0,format:!0,border:!0})),f.model.allowConditionalFormats&&f.XLCFormat.clearCF(i,!0),b[0].cFormatRule=[],e.tblObj&&(e.tblObj.destrange=f._getAlphaRange(s,r[0],r[1],r[2],r[3]),f.XLClipboard._isCut=!0,f.XLFormat.createTable(e.tblObj,e.tblObj.destrange),f.XLClipboard._isCut=!1),this._dragDefineName(i,r,s),tt=0,ut=n.extend(!0,[],a.rowsHeightCollection),o=r[0];o<=r[2];o++)rt.push({rowIndex:o,height:ut[o]}),nt.push({rowIndex:f._getRowIdx(o),height:g[tt].height}),tt++;f.updateData(b,r);w.tRange&&(f.XLFilter.filter(f._getAlphaRange(s,r[0],r[1],r[2],r[3])),f._dupDetails=!1);e.tblObj&&e.tblObj.totalRow&&f.XLFormat._updateTotalRow(s,e.tblObj.tblId,e.tblObj.fnNumber,r,!1);f.model.allowCellFormatting&&f.XLFormat.updateFormat(k,r);f.model.allowConditionalFormats&&!f.isUndefined(h)&&(it=f._getAlphaRange(1,r[0],r[1],r[2],r[3]),d={action:h[0],inputs:[h[2],h[3]],color:h[4],range:it},e.destinationCFormat=d,f.XLCFormat.setCFRule(d));f.setHeightToRows(nt);e.destHeight=nt;e.prevDestRowHt=rt;f.setActiveCell(c.rowIndex,c.colIndex);f.model.allowSelection&&(c.rowIndex||v.rowIndex!==a.rowCount-1?c.colIndex||v.colIndex!==a.colCount-1?f.XLSelection.selectRange(c,v):f.XLSelection.selectRows(c.rowIndex,v.rowIndex):f.XLSelection.selectColumns(c.colIndex,v.colIndex),a._isFreezed&&f.XLFreeze._refreshSelection());f._dupDetails=!1;f._isUndoRedo||!f.XLFormat||f.XLFormat._isFAT||(f._completeAction(e),f._trigActionComplete(e))}},_dragDefineName:function(n,t,i){var r=this.XLObj,y=r.model.nameManager,g=y.length,p=r._getSelectedCells(i,n).selCells,c,w,l,b,nt=r.getSheet(i),tt=r._getSelectedCells(i,t).selCells,it,f,e,s,a=r._calcEngine,k,d,v,o,u,h;if(g){for(o=0;o<g;o++)if(s=r._getRangeArgs(r.XLRibbon._getAddrFromDollarAddr(y[o].refersto)[1],"object"),r.XLClipboard._compareRange(n,s))for(u=0;u<p.length;u++)p[u].rowIndex==s[0]&&p[u].colIndex==s[3]&&(f=tt[u].rowIndex,e=tt[u].colIndex,calcDpdntCells=a.getDependentCells().items,obj=Object.keys(calcDpdntCells)[o],obj&&(k=obj.split("!")[2],d=r._getRangeArgs(s,"string"),k==d&&(y[o].refersto=r._getDollarAlphaRange([f,e,f,e])),v=a.getDependentCells().remove("!0!"+k),c=obj.replace(d,r._getRangeArgs([f,e,f,e],"string")),a.getDependentCells().add(c,v),it=!0));if(b=Object.keys(nt._formulaCollection).length,b)for(h=0;h<b;h++)it&&v[h]&&(w=r._getRangeArgs(v[h].split("!")[2],"object"),l=nt._formulaCollection[w[0]][w[1]],l._formulaValue=r.XLEdit.getPropertyValue(f,e,"value2",i),l._parsedFormula=c,a.getNamedRanges().items[l._formulaText.split("=")[1].toUpperCase()]=c)}},_dMouseHover:function(n){var r,e,o,s,h,i,l,u,f,a=n.target,t=this.XLObj,v=t.getActiveSheetIndex(),c=t.getSheet(v).selectedRange;if(t._hasClass(a,"e-rowcell")&&(r=t._getCellIdx(a)),r&&t.inRange(c,r.rowIndex,r.colIndex)&&(r.rowIndex===c[0]||r.rowIndex===c[2]||r.colIndex===c[1]||r.colIndex===c[3])&&!t._isTouchEvt&&(i=n.target.getBoundingClientRect(),l=t._setXY(n),u=l[0],f=l[1],e=u-t.getFocusLeftElem().offset().left,e=e>=0&&e<=5,o=f-t.getFocusTopElem()[0].getBoundingClientRect().top,o=o>=0&&o<=5,s=t.getFocusRightElem().offset().left-u,s=s>=0&&s<=5,h=t.getFocusBottomElem()[0].getBoundingClientRect().top-f,h=h>=0&&h<=5,e&&u<=i.left+5&&u>=i.left||o&&f<=i.top+5&&f>=i.top||s&&u>=i.right-5&&u<=i.right||h&&f>=i.bottom-5&&f<=i.bottom)){t.addClass(a,"e-cursormove");this._isDragAndDropStart=!0;return}this._isDragAndDropStart&&!t._isTouchEvt&&(t._getContent(v).find(".e-cursormove").removeClass("e-cursormove"),this._isDragAndDropStart=!1)},_dragtouch:function(n,t){var r,u,f,e,i=this.XLObj;r=n-i.getFocusLeftElem().offset().left;u=t-i.getFocusTopElem().offset().top;f=i.getFocusRightElem().offset().left-n;e=i.getFocusBottomElem().offset().top-t;this._isDragAndDropStart=r>=-10&&r<=10||u>=-5&&u<=0||f>=-10&&f<=10||e>=-5&&e<=0?!0:!1},_dMouseDown:function(n){var t=this.XLObj,r,u,i;!t.model.isReadOnly&&t.model.allowEditing&&((u=t.getActiveSheetIndex(),i=t.getSheet(u),n.preventDefault(),n.stopImmediatePropagation(),r=t.swapRange([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]),n.target.nodeName==="TD"&&(this._dragAndDropCell=t._getCellIdx(n.target)),t._dStartCell={rowIndex:r[0],colIndex:r[1]},t._dEndCell={rowIndex:r[2],colIndex:r[3]},t._trigger("dragStart",{sheetIndex:u,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}}))||(this._allowDragAndDrop=!0))},_dMouseMove:function(n){if(this._allowDragAndDrop){var i=this.XLObj,e=i.getActiveSheetIndex(),t=i.getSheet(e),u=n.target,r=i._getCellIdx(u),f;if(i._isTouchEvt&&(f=i._getOriginalEvt(n),u=document.elementFromPoint(f.clientX,f.clientY),u.parentNode&&u.parentNode.attributes.getNamedItem("data-idx")&&(r=i._getCellIdx(u))),i._trigger("drag",{sheetIndex:e,target:u,currentCell:r,dragAndDropRange:{startCell:t._startCell,endCell:t._endCell}}))return;i._isFrozen(t.frozenRows)&&this._isDragAndDropped&&t._frozenRows-1<t._ftopRowIdx&&t._startCell.rowIndex>t._frozenRows-1&&r.rowIndex<t._frozenRows-1&&(r.rowIndex=t._ftopRowIdx);i._isFrozen(t.frozenColumns)&&this._isDragAndDropped&&t._frozenColumns-1<t._fleftColIdx&&t._startCell.colIndex>t._frozenColumns-1&&r.colIndex<t._frozenColumns-1&&(r.colIndex=t._fleftColIdx);this._cellIdx=r;i.XLSelection._focusBorder(t._startCell,t._endCell,i._thinBorder);this._updateDCells(r);t._isFreezed?this._refreshFocusRange():i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder)}else this.XLObj._isTouchEvt||this._dMouseHover(n)},_refreshFocusRange:function(){var t=this.XLObj,n=t.getSheet(),u=t._dEndCell.colIndex,f=t._dEndCell.rowIndex,i=t._dStartCell.colIndex,r=t._dStartCell.rowIndex;n._frozenRows-1<n._ftopRowIdx&&(n._startCell.rowIndex<n._frozenRows-1?f>=n._frozenRows-1&&(f<n._ftopRowIdx?f=n._frozenRows-2:f>n._ftopRowIdx&&r<n._ftopRowIdx&&(r=n._ftopRowIdx)):r=r<n._ftopRowIdx&&r>n._frozenRows-1?n._ftopRowIdx:t._dStartCell.rowIndex);n._frozenColumns-1<n._fleftColIdx&&(n._startCell.colIndex<n._frozenColumns-1?u>=n._frozenColumns-1&&(u<n._fleftColIdx?u=n._frozenColumns-2:u>n._fleftColIdx&&i<n._fleftColIdx&&(i=n._fleftColIdx)):i=i<n._fleftColIdx&&i>n._frozenColumns-1?n._fleftColIdx:t._dStartCell.colIndex);t.XLSelection._focusRange({rowIndex:r,colIndex:i},{rowIndex:f,colIndex:u},t._autofillBorder)},_dMouseUp:function(t){var f,s;if(this._isDragAndDropped){var i=this.XLObj,o=!0,u=i.getActiveSheetIndex(),r=i.getSheet(u),h=n("#vscrollBar").data("ejScrollBar"),c=n("#hscrollBar").data("ejScrollBar"),l=!1,e=[i._dStartCell.rowIndex,i._dStartCell.colIndex,i._dEndCell.rowIndex,i._dEndCell.colIndex],a={rowIndex:-1,colIndex:-1},v={sheetIndex:u,isAlert:!1,target:t.target,currCell:this._dragAndDropCell,dragAndDropRange:{startCell:r._startCell,endCell:r._endCell}},y=i._arrayAsString(i._thinBorder);if(i.model.scrollSettings.allowScrolling&&i._dEndCell.rowIndex>r.rowCount){for(f=0,s=i._dEndCell.rowIndex-i._dStartCell.rowIndex;f<s;f++)i.XLScroll._createNewRow(u,-1,-1,"insert");h._scrollData.step=1;h.scroll(r._scrollTop+(i._dEndCell.rowIndex-i._dStartCell.rowIndex)*r.rowHeight)}if(i._dEndCell.colIndex>r.colCount){for(f=0,s=i._dEndCell.colIndex-i._dStartCell.colIndex;f<s;f++)i.XLScroll._createNewColumn(u,a,a,"insert");c._scrollData.step=1;c.scroll(r._scrollLeft+(i._dEndCell.colIndex-i._dStartCell.colIndex)*r.columnWidth)}if(this._target=t.target,i._isUniqueRange(r.selectedRange,i.swapRange(e)))this._preventDrop(r);else{if(i.model.allowLockCell&&r.isSheetProtected&&i._isPropExists([e,r.selectedRange],"isLocked",u)&&(o=!1),o&&i._isPropExists([e,r.selectedRange],"isReadOnly",u)&&(o=!1),!o){this._preventDrop(r);i.XLSelection._clearBorder(y);this._allowDragAndDrop=this._isDragAndDropStart=this._isDragAndDropped=!1;return}l=i._trigger("beforeDrop",v);v.isAlert||l||!i._rangeHasData(e)?i._rangeHasData(e)?this._preventDrop(r):(this.moveRangeTo([r._startCell.rowIndex,r._startCell.colIndex,r._endCell.rowIndex,r._endCell.colIndex],[i._dStartCell.rowIndex,i._dStartCell.colIndex,i._dEndCell.rowIndex,i._dEndCell.colIndex]),r._startCell=i._dStartCell,r._endCell=i._dEndCell,r._isFreezed&&i.XLFreeze._refreshSelection()):i._showAlertDlg("","DropAlert","Drop",498)}i.XLSelection._clearBorder(y);i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement()}this._allowDragAndDrop=this._isDragAndDropStart=this._isDragAndDropped=!1},_scrollHover:function(t){var u,f,s,i=this.XLObj,h=i.getActiveSheetIndex(),r=i.getSheet(h),c=this._cellIdx.colIndex,l=this._cellIdx.rowIndex,a=i.XLScroll,e=a._vScroller(h),o=a._hScroller(h);n(t.target).parents(".e-vscrollbar").length>0?f=setInterval(function(){u=r._scrollLeft+(i._isFrozen(r.frozenColumns)?r.columnsWidthCollection[r._fleftColIdx]:r.columnWidth);o._scrollData.step=1;o.scroll(u);i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:l,colIndex:r._rightCol.idx-1});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);return},200):t.target.className.indexOf("e-rowheader")>-1?f=setInterval(function(){u=r._scrollLeft-r.columnWidth;o._scrollData.step=-1;u>-1?o.scroll(u):o.scroll(0);i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:l,colIndex:r._leftCol.idx});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);return},200):n(t.target).parents(".e-spreadsheetfooter").length>0||t.target.className.indexOf("e-spreadsheetfooter")>-1||n(t.target).parents(".e-hscrollbar").length>0?f=setInterval(function(){i.model.scrollSettings.allowVirtualScrolling?r._isVirtualEndReached?e.scroll(r._scrollTop):e.scroll(r._scrollTop+(i._isFrozen(r.frozenRows)?r.rowsHeightCollection[r._ftopRowIdx]:r.rowHeight)):(e._scrollData.step=1,e.scroll(r._scrollTop+(i._isFrozen(r.frozenRows)?r.rowsHeightCollection[r._ftopRowIdx]:r.rowHeight)));i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:r._bottomRow.idx-1,colIndex:c});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);return},200):t.target.className.indexOf("e-headercell")>-1?f=setInterval(function(){u=r._scrollTop-r.rowHeight;e._scrollData.step=-1;u>-1?e.scroll(u):e.scroll(0);i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:r._topRow.idx,colIndex:c});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);return},200):t.target.className.indexOf("e-rowcell")>-1&&(s=i._getCellIdx(t.target),i._isFrozen(r.frozenRows)&&s.rowIndex<r._frozenRows-1&&r._startCell.rowIndex>=r._frozenRows-1&&(f=setInterval(function(){if(i._dStartCell.rowIndex>r._ftopRowIdx||!i.XLDragDrop._isDragAndDropped||r._frozenRows-1===r._ftopRowIdx){(i._dStartCell.colIndex>r._fleftColIdx||!i.XLDragDrop._isDragAndDropped||r._frozenColumns-1===r._fleftColIdx)&&clearInterval(f);return}u=r._scrollTop-r.rowHeight;e._scrollData.step=-1;u>-1?e.scroll(u):e.scroll(0);i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:r._ftopRowIdx,colIndex:i.XLDragDrop._cellIdx.colIndex});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);i.XLDragDrop._refreshFocusRange();return},200)),i._isFrozen(r.frozenColumns)&&s.colIndex<r._frozenColumns-1&&r._startCell.colIndex>=r._frozenColumns-1&&(f=setInterval(function(){if(i._dStartCell.colIndex>r._fleftColIdx||!i.XLDragDrop._isDragAndDropped||r._frozenColumns-1===r._fleftColIdx){(i._dStartCell.rowIndex>r._ftopRowIdx||!i.XLDragDrop._isDragAndDropped||r._frozenRows-1===r._ftopRowIdx)&&clearInterval(f);return}u=r._scrollLeft-r.columnWidth;o._scrollData.step=-1;u>-1?o.scroll(u):o.scroll(0);i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:i.XLDragDrop._cellIdx.rowIndex,colIndex:r._fleftColIdx});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);i.XLDragDrop._refreshFocusRange();return},200)));i._browserDetails.name==="msie"&&i._browserDetails.version==="8.0"?(t.target.attachEvent("onmouseleave",function(){clearInterval(f);return}),document.attachEvent("onmouseleave",function(){clearInterval(f);return}),t.target.attachEvent("onmouseup",function(){clearInterval(f);return})):(t.target.addEventListener("mouseleave",function(){clearInterval(f);return}),document.addEventListener("mouseleave",function(){clearInterval(f);return}),t.target.addEventListener("mouseup",function(){clearInterval(f);i.XLDragDrop._dMouseUp(t);return}))},_preventDrop:function(n){var t=this.XLObj;t.XLSelection._focusRange(n._startCell,n._endCell,t._selectionBorder);t._dStartCell=n._startCell;t._dEndCell=n._endCell},_updateDCells:function(n){var t=this.XLObj,u=t.getActiveSheetIndex(),i=t.getSheet(u),r=t.isRange(i.selectedRange);i._isColSelected&&t.inRange(i.selectedRange,0,i._startCell.colIndex)||(n.rowIndex<this._dragAndDropCell.rowIndex&&t._dStartCell.rowIndex?(t._dStartCell.rowIndex=t._dStartCell.rowIndex-(this._dragAndDropCell.rowIndex-n.rowIndex),t._dEndCell.rowIndex=r?t._dEndCell.rowIndex-(this._dragAndDropCell.rowIndex-n.rowIndex):t._dStartCell.rowIndex):n.rowIndex>this._dragAndDropCell.rowIndex&&(t._dStartCell.rowIndex=t._dStartCell.rowIndex+(n.rowIndex-this._dragAndDropCell.rowIndex),t._dEndCell.rowIndex=r?t._dEndCell.rowIndex+(n.rowIndex-this._dragAndDropCell.rowIndex):t._dStartCell.rowIndex));i._isRowSelected&&t.inRange(i.selectedRange,i._startCell.rowIndex,0)||(n.colIndex<this._dragAndDropCell.colIndex&&t._dStartCell.colIndex?(t._dStartCell.colIndex=t._dStartCell.colIndex-(this._dragAndDropCell.colIndex-n.colIndex),t._dEndCell.colIndex=r?t._dEndCell.colIndex-(this._dragAndDropCell.colIndex-n.colIndex):t._dStartCell.colIndex):n.colIndex>this._dragAndDropCell.colIndex&&(t._dStartCell.colIndex=t._dStartCell.colIndex+(n.colIndex-this._dragAndDropCell.colIndex),t._dEndCell.colIndex=r?t._dEndCell.colIndex+(n.colIndex-this._dragAndDropCell.colIndex):t._dStartCell.colIndex));this._dragAndDropCell=n;this._isDragAndDropped=!0}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.exporting=function(n){this.XLObj=n;this._exportType=""};t.spreadsheetFeatures.exporting.prototype={"export":function(i,r){var u=this.XLObj,o,p,s,f,e,c,l,a,w,v,h,y;if(u.model.exportSettings.allowExporting&&!u.model.isReadOnly)if(u._isExport=!0,t.isNullOrUndefined(r)&&(r="Sample"),this._renderAll(),u._isExport=!1,o=u.model.exportSettings,c=i===t.Spreadsheet.exportType.Excel?o.excelUrl:i===t.Spreadsheet.exportType.Csv?o.csvUrl:o.pdfUrl,l=this.getExportProps(),h={exportType:i,url:c,customParams:{}},a=t.raiseWebFormsServerEvents?i.toLowerCase()+"Exporting":"",t.raiseWebFormsServerEvents&&u.model.serverEvents&&u.model.serverEvents.indexOf(a)>-1){if(w={model:n.extend(!0,{},u.model),originalEventType:a},v={sheetModel:l.model,sheetData:l.data,fileName:r,password:o.password?o.password:""},u._trigger("onExport",h))return;u.getObjectLength(h.customParams)&&n.extend(v,h.customParams);t.raiseWebFormsServerEvents(a,w,v);setTimeout(function(){t.isOnWebForms=!0},1e3)}else{if(t.isNullOrUndefined(c)){u._showAlertDlg("Alert","ImportExportUrl","",266);return}if(!o.allowExporting||u.isUndefined(c))return;if(u._trigger("onExport",h))return;c=h.url;p={action:c,method:"post"};s=t.buildTag("form","",null,p);f={name:"sheetData",type:"hidden",value:l.data};e=t.buildTag("input","",null,f);s.append(e);f={name:"sheetModel",type:"hidden",value:l.model};e=t.buildTag("input","",null,f);s.append(e);f={name:"fileName",type:"hidden",value:r};e=t.buildTag("input","",null,f);s.append(e);f={name:"Password",type:"hidden",value:o.password};e=t.buildTag("input","",null,f);s.append(e);for(y in h.customParams)f={name:y,type:"hidden",value:h.customParams[y]},e=t.buildTag("input","",null,f),s.append(e);n("body").append(s);s.submit()}},_dropElements:function(n){var r=n.sheets,f=["_spreadSheetPager","dataSource","rangeSettings"],u,t,i;n.undoCollection=[];for(u in r){i=r[u];for(t in i)f.indexOf(t)>-1&&(i[t]=null)}return n},_getRequriedProp:function(n){for(var f=this.XLObj,r={},u,i=["sheetCount","activeSheetIndex","nameManager"],s,o,h,t=0,e=i.length;t<e;t++)r[i[t]]=n[i[t]];f.model.allowCellFormatting&&f.getObjectLength(f.XLFormat._customFontFamily)>0&&(r.customFontFamily=f.XLFormat._customFontFamily);o=n.sheets;r.sheets=[];i=["_activeCell","_endCell","_startCell","colCount","columnsWidthCollection","rowsHeightCollection","rowCount","frozenColumns","frozenRows","usedRange","dataAttribute","filterSettings","tableManager","sheetInfo","hideColsCollection","hideRowsCollection","showGridlines","showHeadings","isSheetProtected","shapeMngr","chart","pivotMngr","topLeftCell","paneTopLeftCell"];for(t in o)for(r.sheets[t]={},h=r.sheets[t],s=o[t],u=0,e=i.length;u<e;u++)h[i[u]]=s[i[u]];return r},getExportProps:function(){var s=this.XLObj,r,e,f,v,b,y,w,o,k=n.extend(!0,{},s._dataContainer),i={},c=[],t,d,u={},a,l,p,h;for(s._refreshHashCode(k.hashCode),i=JSON.parse(JSON.stringify(s.model)),r=1;r<i.sheets.length;r++){for(u={},d={},n.extend(!0,u,i.sheets[r].shapeMngr.chart),c=s.getObjectKeys(u),i.sheets[r].shapeMngr.chart={},e=0,v=c.length;e<v;e++)if(t=u[c[e]].id,y=n("#"+t).data("ejChart"),y){for(y.model.event=null,w=JSON.parse(JSON.stringify(y.model)),o=w.series,f=0,b=o.length;f<b;f++)delete o[f].dataSource,delete o[f].query,o[f].fill=jQuery.type(o[f].fill)=="array"?o[f].fill[0].color:o[f].fill;if(i.sheets[r].shapeMngr.chart[t]=w,u[t].isChartSeries)for(l=u[t].seriesRange,i.sheets[r].shapeMngr.chart[t].seriesRange=l,h=0;h<l.length;h++)p=i.sheets[r].shapeMngr.chart[t].seriesRange[h],p.xRange=l[h].xRange,p.yRange=l[h].yRange,p.lRange=l[h].lRange;else a=u[t].range,i.sheets[r].shapeMngr.chart[t].range=s._generateHeaderText(a[1]+1)+(a[0]+1)+":"+s._generateHeaderText(a[3]+1)+(a[2]+1);i.sheets[r].shapeMngr.chart[t].top=u[t].top;i.sheets[r].shapeMngr.chart[t].left=u[t].left;i.sheets[r].shapeMngr.chart[t].height=u[t].height;i.sheets[r].shapeMngr.chart[t].width=u[t].width;i.sheets[r].shapeMngr.chart[t].isRowColSwitched=u[t].isRowColSwitched}for(c=s.getObjectKeys(i.sheets[r].pivotMngr.pivot),e=0,v=c.length;e<v;e++)t=c[e],pivotObj=n("#"+t).data("ejPivotGrid"),pivotObj&&(i.sheets[r].pivotMngr.pivot[t].rows=pivotObj.getOlapReport().rows,i.sheets[r].pivotMngr.pivot[t].columns=pivotObj.getOlapReport().columns,i.sheets[r].pivotMngr.pivot[t].filters=pivotObj.getOlapReport().filters,i.sheets[r].pivotMngr.pivot[t].values=pivotObj.getOlapReport().values)}return i.sheets.shift(),{model:JSON.stringify(this._getRequriedProp(i)),data:JSON.stringify(k)}},_renderAll:function(){for(var r,i,u,n=this.XLObj,f=n.getSheets(),e=n.getActiveSheetIndex(),t=1;t<f.length;t++)if(i=f[t],n.model.importSettings.allowSheetOnDemand&&i._isImported&&!i._isRequested&&n._importSheet(t,!1),i._isLoaded||n.gotoPage(t),n.model.scrollSettings.allowVirtualScrolling&&!i._isImported&&i._hasDataSrc)for(r=1;r<=i._virtualBlockCnt;r++)i._virtualDataLoadedBlks.indexOf(r)===-1&&(i._virtualDataLoadedBlks.push(r),u=this._getRange(r,t),n._refreshDataSrc(u,t),n._refreshCellData(u,t));n.hideWaitingPopUp();n.gotoPage(e)},_getRange:function(n,t){var u=this.XLObj,i=u.getSheet(t),r=[0,0,0,i.colCount-1];return r[0]=i._virtualBlockRowCnt*(n-1),r[2]=i._virtualBlockRowCnt*n-1,r},_exportFileNameDlg:function(){var i=this.XLObj,r,o,u,f,e,s;r=t.buildTag("div","","",{id:i._id+"_ExportFileNameDialog"});e=t.buildTag("div.e-dlg-btnfields");s=t.buildTag("div.e-dlg-btnctnr");o="<div class= 'e-dlgctndiv'><table><tr class= 'e-dlgtd-fields'><td><label>"+i._getLocStr("FileName")+":<\/label><\/td><td><form id='"+i._id+"_Form_xlFileName' onsubmit='return false'><input id ='"+i._id+"_xlFileName' type ='text' value = 'Sample' class = 'ejinputtext'/><\/form><\/td><\/tr><\/table><\/div>";r.append(o);u=t.buildTag("input","","",{type:"submit"});f=t.buildTag("input");u.ejButton({text:i._getLocStr("Save"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgSave,this),enabled:!0,cssClass:"e-ss-okbtn"});f.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._dlgCancel,i),showRoundedCorner:!0,width:60});e.append(s.append(u,f));r.append(e);r.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("SaveFile"),width:"auto",height:"auto",cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dlgCancel,i),open:t.proxy(function(){var t=n("#"+i._id+"_xlFileName");t.focus().setInputPos(t.val().length).select()})});i.XLRibbon._dialogValidate("_xlFileName")},_dlgSave:function(){var r=this.XLObj,i=r._id;n("#"+i+"_Form_xlFileName").valid()&&(this["export"](t.Spreadsheet.exportType[this._exportType],n("#"+i+"_xlFileName").val()),n("#"+i+"_ExportFileNameDialog").ejDialog("close"))},_dlgCancel:function(){n("#"+this._id+"_ExportFileNameDialog").ejDialog("close")}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.findnreplace=function(n){this.XLObj=n;this._findCount=0;this._isApplied=!1;this.caseSen={"true":function(n){return n.toString()},"false":function(n){return n.toString().toLowerCase()}};this.isEMatch={"true":function(n,t){return n==t},"false":function(n,t){if(!n.length||t.length)return n.indexOf(t)>-1}}};t.spreadsheetFeatures.findnreplace.prototype={replaceAllBySheet:function(n,t,i,r){this.XLObj.model.allowSearching&&this.XLObj.model.allowEditing&&!this.XLObj.model.isReadOnly&&this._replaceAllData(n,t,i,r,"value","sheet")},replaceAllByBook:function(n,t,i,r){this.XLObj.model.allowSearching&&this.XLObj.model.allowEditing&&!this.XLObj.model.isReadOnly&&this._replaceAllData(n,t,i,r,"value","workbook")},findNext:function(n,i,r){t.isNullOrUndefined(r)&&(r=this.XLObj.getActiveSheetIndex());this._findNext(n,r,i.isCSen,i.isEMatch,i.type,i.mode,i.searchBy)},findPrevious:function(n,i,r){t.isNullOrUndefined(r)&&(r=this.XLObj.getActiveSheetIndex());this._findPrev(n,r,i.isCSen,i.isEMatch,i.type,i.mode,i.searchBy)},_findNext:function(n,t,i,r,u,f,e){var s,h,y,ct,tt,w,b,a,p,ot,it,rt,v,k,d,lt,ut,ft,g=[],l=e==="rows",c=this.XLObj,st=!1,nt=t?t:c.getActiveSheetIndex(),ht=c.getSheet(nt),et=ht._activeCell,o={sheetIndex:t,value:n,isCaseSensitive:i,isEntireMatch:r,searchBy:e,mode:f,findType:u,reqType:"findNext"};if(lt={sheetIndex:o.sheetIndex,value:o.value,isCaseSensitive:o.isCaseSensitive,isEntireMatch:o.isEntireMatch,searchBy:o.searchBy,mode:o.mode,findType:o.findType,reqType:o.reqType},!c._intrnlReq&&c._trigActionBegin(lt))return!0;if(c.model.allowEditing&&c.XLEdit._isEdit&&c.XLEdit.saveCell(),n=o.value,t=o.sheetIndex,i=o.isCaseSensitive,r=o.isEntireMatch,u=o.findType,f=o.mode,e=o.searchBy,w=ht._selectedCells,ot=w.length,p=ht.usedRange,ot===1||f==="workbook"?g=[et.rowIndex,et.colIndex,p.rowIndex+1,p.colIndex+1]:(st=!0,b=w[ot-1],g=[et.rowIndex,et.colIndex,b.rowIndex+1,b.colIndex+1]),a=g[0],v=g[1],k=g[2],d=g[3],l||(tt=a,a=v,v=tt,tt=k,k=d,d=tt),f==="sheet"){for(s=a;s<k;s++)for(s!==a&&(b=w[0],v=st?l?b.colIndex:b.rowIndex:0),h=v;h<d;h++)if(ut=this._compareValues(l?s:h,l?h:s,nt,n,i,r,u),ut&&!(s===a&&h===v))return(this._updateSelection(l?s:h,l?h:s),this._findCount++,o={reqType:"findNext",activeCell:c.getActiveCellElem()},c._trigActionComplete(o))?void 0:!0}else for(y=nt,ct=c.model.sheetCount;y<=ct;y++)for(p=c.model.sheets[y].usedRange,y!==nt&&(v=0,a=0,k=l?p.rowIndex:p.colIndex,d=l?p.colIndex:p.rowIndex),s=a;s<k+1;s++)for(s!==a&&(v=0),h=v;h<d+1;h++)if(ut=this._compareValues(l?s:h,l?h:s,y,n,i,r,u),ut&&!(y===nt&&s===a&&h===v))return(this._updateSelection(l?s:h,l?h:s,y),this._findCount++,c._intrnlReq=!1,o={reqType:"findNext",activeCell:c.getActiveCellElem()},c._trigActionComplete(o))?void 0:!0;return this._findCount?!1:(it=0,rt=0,ft=f==="sheet"?nt:1,st&&(b=w[0],rt=w[0].rowIndex,it=w[0].colIndex),this._updateSelection(rt,it,ft),this._findCount++,this._compareValues(rt,it,ft,n,i,r,u)?!0:(c._intrnlReq=!0,this._findNext(n,ft,i,r,u,f,e)))},_findPrev:function(n,t,i,r,u,f,e){var s,h,p,it,k,a,nt,rt,ut,ft,v,y,tt,ct,w,st=!1,d=[],lt=0,at=0,l=e==="rows",et,c=this.XLObj,g=t?t:c.getActiveSheetIndex(),ht=c.getSheet(g),b=ht.usedRange,ot=ht._activeCell,o={sheetIndex:t,value:n,isCaseSensitive:i,isEntireMatch:r,searchBy:e,mode:f,findType:u,reqType:"findPrevious"};if(ct={sheetIndex:o.sheetIndex,value:o.value,isCaseSensitive:o.isCaseSensitive,isEntireMatch:o.isEntireMatch,searchBy:o.searchBy,mode:o.mode,findType:o.findType,reqType:o.reqType},c._trigActionBegin(ct))return!0;if(c.model.allowEditing&&c.XLEdit._isEdit&&c.XLEdit.saveCell(),n=o.value,t=o.sheetIndex,i=o.isCaseSensitive,r=o.isEntireMatch,u=o.findType,f=o.mode,e=o.searchBy,nt=ht._selectedCells,rt=nt.length,rt===1||f==="workbook"?d=[ot.rowIndex,ot.colIndex,b.rowIndex+1,b.colIndex+1]:(a=nt[rt-1],d=[ot.rowIndex,ot.colIndex,a.rowIndex,a.colIndex],st=!0),v=d[0],y=d[1],tt=d[2],w=d[3],l||(et=v,v=y,y=et,et=tt,tt=w,w=et),f==="sheet"){for(st&&(a=nt[0],lt=l?a.rowIndex:a.colIndex,at=l?a.colIndex:a.rowIndex),s=v;s>=lt;s--)for(s!==v&&(y=w),h=y;h>=at;h--)if(it=this._compareValues(l?s:h,l?h:s,g,n,i,r,u),it&&!(s===v&&h===y))return(this._updateSelection(l?s:h,l?h:s),this._findCount++,o={reqType:"findPrevious",activeCell:c.getActiveCellElem()},c._trigActionComplete(o))?void 0:!0}else for(p=g;p>=1;p--)for(b=c.model.sheets[p].usedRange,p!==g&&(tt=l?b.rowIndex:b.colIndex,w=l?b.colIndex:b.rowIndex,y=w,v=tt),s=v;s>=0;s--)for(s!==v&&(y=w+1),h=y;h>=0;h--)if(it=this._compareValues(l?s:h,l?h:s,p,n,i,r,u),it&&!(p===g&&s===v&&h===y))return(this._updateSelection(l?s:h,l?h:s,p),this._findCount++,o={reqType:"findPrevious",activeCell:c.getActiveCellElem()},c._trigActionComplete(o))?void 0:!0;return this._findCount?!1:(k=f==="sheet"?g:c.model.sheetCount,ft=c.model.sheets[k].usedRange.rowIndex,ut=c.model.sheets[k].usedRange.colIndex,st&&(a=nt[rt-1],ft=a.rowIndex,ut=a.colIndex),this._updateSelection(ft,ut,k),this._findCount++,this._compareValues(ft,ut,k,n,i,r,u)?!0:this._findPrev(n,k,i,r,u,f,e))},_compareValues:function(n,t,i,r,u,f,e){var o=this.XLObj,s=o.XLEdit.getPropertyValue(n,t,null,i)?o.XLEdit.getPropertyValue(n,t,null,i).toString():"",h=o.isFormula(s)||e==="formula"&&s==="=",c=o._isDateTime(o.XLEdit.getPropertyValue(n,t,"value",i));return s=e==="value"?c?s?this.caseSen[u](o.XLEdit.getPropertyValue(n,t,"value2",i)):"":s&&!h?this.caseSen[u](s):"":e==="formula"?h?this.caseSen[u](s):"":o.XLEdit.getPropertyValue(n,t,"comment",i)?this.caseSen[u](o.XLEdit.getPropertyValue(n,t,"comment",i).value):"",r=this.caseSen[u](r),this.isEMatch[f](s,r)},_replace:function(n,t,i,r,u){var f=this.XLObj,o=f.getActiveSheetIndex();if(f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"isLocked",o))return!1;var e=f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,null,t)?f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,null,t).toString():"",s=new RegExp(i.toString().replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),h=e!==""&&i!==""?u?e.replace(i,r):e.replace(s,r):r;t===o||f.gotoPage(t);f.XLEdit._updateCellValue(n,h)},_replaceData:function(n,t,i,r,u,f,e,o,s){var v,y,h=this.XLObj,c=i?i:h.model.activeSheetIndex,p=h.getSheet(c),l=p._activeCell.rowIndex,a=p._activeCell.colIndex,w;if(!h.model.allowEditing)return!1;if(h.model.allowLockCell&&h.XLEdit.getPropertyValue(l,a,"isLocked",c)){h._popUplockCellAlert();return}h.model.allowEditing&&h.XLEdit._isEdit&&h.XLEdit.saveCell();this._compareValues(l,a,c,n,r,u,f)?(y=f==="formula"?"value":"value2",v={sheetIndex:c,reqType:"find-replace",operation:"replace",rowIndex:l,colIndex:a,sIndex:i},v.prevData={value:h.XLEdit.getPropertyValue(l,a,y)},this._replace({rowIndex:l,colIndex:a},i,n,t,r),v.newData={value:h.XLEdit.getPropertyValue(l,a,y)},this._findCount=0,w=e==="up"?this._findPrev(n,c,r,u,f,o,s):this._findNext(n,c,r,u,f,o,s),w||this._updateSelection(l,a,c),h._isUndoRedo||(h._completeAction(v),h._trigActionComplete(v))):h._showAlertDlg("Alert","ReplaceNotFound","")},_replaceAllData:function(t,i,r,u,f,e){var w,a,l,g=[],it=0,rt=!1,nt,o=this.XLObj,ut=o.model.sheetCount,v=o.model.activeSheetIndex,b=o.getSheet(v),y=b.usedRange,ft=b._activeCell.rowIndex,et=b._activeCell.colIndex,s,h,c,k,d,tt=0,p;if(w={sheetIndex:v,reqType:"find-replace",operation:"replaceAll",isCSen:r,isEMatch:u},a=f==="formula"?"value":"value2",!o.model.allowEditing)return!1;if(o._dupDetails=!0,o.model.allowEditing&&o.XLEdit._isEdit&&o.XLEdit.saveCell(),e==="sheet")if(o.model.allowLockCell&&b.isSheetProtected)rt=!0;else for(s=0,k=y.rowIndex+1;s<k;s++)for(h=0,d=y.colIndex+1;h<d;h++)this._compareValues(s,h,v,t,r,u,f)&&(l={rowIndex:s,colIndex:h,prevData:{value:o.XLEdit.getPropertyValue(s,h,a)},sheetIndex:v},this._replace({rowIndex:s,colIndex:h},v,t,i,r),tt++,l.newData={value:o.XLEdit.getPropertyValue(s,h,a)},g.push(l));else for(c=1;c<=ut;c++){if(nt=o.model.sheets[c],o.model.allowLockCell&&nt.isSheetProtected){it++;continue}for(y=nt.usedRange,s=0,k=y.rowIndex+1;s<k;s++)for(h=0,d=y.colIndex+1;h<d;h++)this._compareValues(s,h,c,t,r,u,f)&&(l={rowIndex:s,colIndex:h,prevData:{value:o.XLEdit.getPropertyValue(s,h,a,c)},sheetIndex:c},this._replace({rowIndex:s,colIndex:h},c,t,i,r),tt++,l.newData={value:o.XLEdit.getPropertyValue(s,h,a)},g.push(l))}if(rt||it===ut){o._popUplockCellAlert();return}o._dupDetails=!1;w.selectedCell=g;this._updateSelection(ft,et);o._isUndoRedo||(o._completeAction(w),o._trigActionComplete(w));o.hideWaitingPopUp();p=o._getLocStr("ReplaceData").split("/");p="T-"+p[0]+tt+" "+p[1];n("#"+o._id+"_FRDialog").ejDialog("close");o._showAlertDlg("Alert",p,"",325)},_updateSelection:function(n,t,i){var u={rowIndex:n,colIndex:t},r=this.XLObj,e=r.getActiveSheetIndex(),f=r.getSheet(e);i||(i=e);i&&i!==e&&r.gotoPage(i,!1);r.getSheetElement(e).find(".e-selected:visible").length<2||!r.inRange(f.selectedRange,n,t)?(r.setActiveCell(u.rowIndex,u.colIndex,i),r.XLSelection.selectRange(u,u),f._startCell=u,f._endCell=u):r.XLCellNav._updateActiveCell(n,t);r.model.scrollSettings.allowScrolling&&(r._isFrozen(f.frozenRows)||r._isFrozen(f.frozenColumns)?this._freezeScroll(u.rowIndex,u.colIndex,f):r.XLScroll._scrollSelectedPosition(i,r.getActiveCell(i)));r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement()},_getSelRangeDetails:function(n){var t=n[n.length-1].rowIndex-n[0].rowIndex,i=n[n.length-1].colIndex-n[0].colIndex,r=n[0].rowIndex,u=n[0].colIndex;return[t,i,r,u]},goTo:function(t){var i=this.XLObj;if(!i.model.isReadOnly){i._showDialog(i._id+"_Ribbon_Others_Editing_FindSelect");t.startsWith("=")&&(t=t.split("=")[1]);var c,e,f,l=i.getActiveSheetIndex(),u=i.getSheet(l),r,o,s=i._getDollarAlphaRange(u.selectedRange),h=i.XLRibbon._getAddrFromDollarAddr(t);t=h[1];h[0]&&i.gotoPage(h[0],!1);t=i.getRangeIndices(t);f=i._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]});r=f[0];o=f[f.length-1];i.setActiveCell(r.rowIndex,r.colIndex);i.model.allowSelection&&i.XLSelection.selectRange(r,o);i._isFrozen(u.frozenRows)||i._isFrozen(u.frozenColumns)?this._freezeScroll(r.rowIndex,r.colIndex,u):i.XLScroll._scrollSelectedPosition(i.getActiveSheetIndex(),r);i.XLDragFill.positionAutoFillElement();u._startCell=r;u._endCell=o;i.setSheetFocus();c=n.grep(i.XLRibbon._addrList,function(n){return n.value===s});c.length<1&&(i.XLRibbon._addrList.push({value:s,text:s}),e=n("#"+i._id+"_GotoAddr").data("ejListBox"),i.XLRibbon._addrList=JSON.parse(JSON.stringify(i.XLRibbon._addrList)),e.model.dataSource=i.XLRibbon._addrList,e.option("fields",{dataSource:i.XLRibbon._addrList}))}},goToSpecial:function(n,t){this._applyGoToRule(n,t.isNumber,t.isText,t.isLogical,t.isError)},_applyGoToRule:function(n,t,i,r,u){var e=this.XLObj,o,f;e.showWaitingPopUp();switch(n){case"blanks":this._applyGotoBlanks();break;case"formulas":this._applyGotoFormulas(t,i,r,u);break;case"comments":this._applyGotoComments();break;case"datavalidation":this._applyGotoValidation();break;case"cformat":this._applyGotoCFormat();break;case"lastcell":o=e.getActiveSheetIndex();f=e.model.sheets[o].usedRange;e.XLSelection.selectRange({rowIndex:f.rowIndex,colIndex:f.colIndex},{rowIndex:f.rowIndex,colIndex:f.colIndex});this._updateSelection(f.rowIndex,f.colIndex,o);break;case"constants":this._applyGotoConstants(t,i,r,u);break;case"rowdiff":this._applyGotoRowDiff();break;case"coldiff":this._applyGotoColDiff()}e.hideWaitingPopUp()},_applyGotoBlanks:function(){var o,s,c,u,l,i,r,h=!1,v=[],f,n=this.XLObj,e=n.getActiveSheetIndex(),y=n.model.sheets[e].usedRange,p,w=y.rowIndex,b=y.colIndex,t=n.getSheet(e),k=t._selectedCells,d=0,g=0,a={sheetIndex:e,reqType:"find-replace",operation:"blanks"};for(t._goToCollection={multiple:!1,selected:[]},k.length>1&&(f=this._getSelRangeDetails(k),w=f[0],b=f[1],d=f[2],g=f[3],t._goToCollection.multiple=!0),o=0;o<=w;o++){for(s=0;s<=b;s++)i=o+d,r=s+g,p=n.XLEdit.getPropertyValue(i,r)?n.XLEdit.getPropertyValue(i,r).toString():"",n._isRowViewable(e,i)&&(c=n.getCell(i,r,e),h=!0),p.length?h&&c.removeClass("e-selected"):(v.push({rowIndex:i,colIndex:r,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&t._goToCollection.selected.push(i+":"+r),h&&(c.addClass("e-selected"),u=[i,r]));h=!1}l=t._goToCollection.selected.length;(n._isFrozen(t.frozenRows)||n._isFrozen(t.frozenColumns))&&(l&&(u=t._goToCollection.selected[l-1].split(":")),u&&u.length&&this._freezeScroll(u[0],u[1],t));a.selectedCell=v;n._isUndoRedo||(n._completeAction(a),n._trigActionComplete(a))},_applyGotoComments:function(){var s,h,a,u,c,r,f,l=!1,y=[],e,n=this.XLObj,o=n.getActiveSheetIndex(),p=n.getSheet(o).usedRange,w,b=p.rowIndex,k=p.colIndex,i=n.getSheet(o),d=i._selectedCells,g=0,nt=0,v={sheetIndex:o,reqType:"find-replace",operation:"comments"};for(i._goToCollection={multiple:!1,selected:[]},this._isApplied=!1,d.length>1&&(e=this._getSelRangeDetails(d),b=e[0],k=e[1],g=e[2],nt=e[3],i._goToCollection.multiple=!0),s=0;s<=b;s++){for(h=0;h<=k;h++)r=s+g,f=h+nt,w=n.XLEdit.getPropertyValue(r,f,"comment"),n._isRowViewable(o,r)&&(a=n.getCell(r,f,o),l=!0),t.isNullOrUndefined(w)?l&&a.removeClass("e-selected"):(y.push({rowIndex:r,colIndex:f,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&i._goToCollection.selected.push(r+":"+f),l&&(a.addClass("e-selected"),this._isApplied=!0,u=[r,f]));l=!1}c=i._goToCollection.selected.length;(n._isFrozen(i.frozenRows)||n._isFrozen(i.frozenColumns))&&(c&&(u=i._goToCollection.selected[c-1].split(":")),u&&u.length&&this._freezeScroll(u[0],u[1],i));this._isApplied||c||n._showAlertDlg("Alert","NoCellFound","",200);v.selectedCell=y;!n._isUndoRedo&&this._isApplied&&(n._completeAction(v),n._trigActionComplete(v))},_applyGotoFormulas:function(i,r,u,f){var p,a,k,s,c,l,w,b=!1,nt=[],v,e=this.XLObj,y=e.getActiveSheetIndex(),tt,o,it,rt=e.model.sheets[y].usedRange,ut=rt.rowIndex,ft=rt.colIndex,h=e.getSheet(y),et=h._selectedCells,ot=0,d=0,g={sheetIndex:y,reqType:"find-replace",operation:"formulas"};for(h._goToCollection={multiple:!1,selected:[]},this._isApplied=!1,et.length>1&&(v=this._getSelRangeDetails(et),ut=v[0],ft=v[1],ot=v[2],d=v[3],h._goToCollection.multiple=!0),p=0;p<=ut;p++){for(a=0;a<=ft;a++)s=p+ot,c=a+d,tt=t.isNullOrUndefined(e.XLEdit.getPropertyValue(s,c))?"":e.XLEdit.getPropertyValue(s,a+d).toString(),o=t.isNullOrUndefined(e.XLEdit.getPropertyValue(s,c,"value2"))?"":e.XLEdit.getPropertyValue(s,c,"value2").toString(),it=tt.charAt(0)==="="&&typeof o=="string",e._isRowViewable(y,s)&&(k=e.getCell(s,c,y),b=!0),it&&(i&&n.isNumeric(o)||r&&!(o.toLowerCase()==="true"||o.toLowerCase()==="false")&&!n.isNumeric(o)&&!(o.length!==0&&o.indexOf("#")===0&&o.lastIndexOf("?")===o.length-1&&o.length>0)||u&&(o.toLowerCase()==="true"||o.toLowerCase()==="false")||f&&o.length!==0&&e._calcEngine.getErrorStrings().indexOf(o)>-1)?(nt.push({rowIndex:s,colIndex:c,isApply:!0}),e.model.scrollSettings.allowVirtualScrolling&&h._goToCollection.selected.push(s+":"+c),b&&(k.addClass("e-selected"),this._isApplied=!0,l=[s,c])):b&&k.removeClass("e-selected");b=!1}w=h._goToCollection.selected.length;(e._isFrozen(h.frozenRows)||e._isFrozen(h.frozenColumns))&&(w&&(l=h._goToCollection.selected[w-1].split(":")),l&&l.length&&this._freezeScroll(l[0],l[1],h));this._isApplied||w||e._showAlertDlg("Alert","NoCellFound","",200);g.selectedCell=nt;!e._isUndoRedo&&this._isApplied&&(e._completeAction(g),e._trigActionComplete(g))},_applyGotoValidation:function(){var s,h,a,r,u,f,c,l=!1,y=[],e,n=this.XLObj,o=n.getActiveSheetIndex(),p=n.model.sheets[o].usedRange,w,b=p.rowIndex,k=p.colIndex,i=n.getSheet(o),d=i._selectedCells,g=0,nt=0,v={sheetIndex:o,reqType:"find-replace",operation:"validations"};for(this._isApplied=!1,i._goToCollection={multiple:!1,selected:[]},d.length>1&&(e=this._getSelRangeDetails(d),b=e[0],k=e[1],g=e[2],nt=e[3],i._goToCollection.multiple=!0),s=0;s<=b;s++){for(h=0;h<=k;h++)r=s+g,u=h+nt,w=n.XLEdit.getPropertyValue(r,u,"rule"),n._isRowViewable(o,r)&&(a=n.getCell(r,u,o),l=!0),t.isNullOrUndefined(w)?l&&a.removeClass("e-selected"):(y.push({rowIndex:r,colIndex:u,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&i._goToCollection.selected.push(r+":"+u),l&&(a.addClass("e-selected"),this._isApplied=!0,f=[r,u]));l=!1}c=i._goToCollection.selected.length;(n._isFrozen(i.frozenRows)||n._isFrozen(i.frozenColumns))&&(c&&(f=i._goToCollection.selected[c-1].split(":")),f&&f.length&&this._freezeScroll(f[0],f[1],i));this._isApplied||c||n._showAlertDlg("Alert","NoCellFound","",200);v.selectedCell=y;!n._isUndoRedo&&this._isApplied&&(n._completeAction(v),n._trigActionComplete(v))},_applyGotoCFormat:function(){var s,h,a,r,u,f,c,l=!1,p=[],e,n=this.XLObj,o=n.getActiveSheetIndex(),w=n.model.sheets[o].usedRange,v,b=w.rowIndex,k=w.colIndex,i=n.getSheet(o),d=i._selectedCells,g=0,nt=0,y={sheetIndex:o,reqType:"find-replace",operation:"conditions"};for(this._isApplied=!1,i._goToCollection={multiple:!1,selected:[]},d.length>1&&(e=this._getSelRangeDetails(d),b=e[0],k=e[1],g=e[2],nt=e[3],i._goToCollection.multiple=!0),s=0;s<=b;s++){for(h=0;h<=k;h++)r=s+g,u=h+nt,v=n.XLEdit.getPropertyValue(r,u,"cFormatRule"),n._isRowViewable(o,r)&&(a=n.getCell(r,u,o),l=!0),!t.isNullOrUndefined(v)&&v.length?(p.push({rowIndex:r,colIndex:u,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&i._goToCollection.selected.push(r+":"+u),l&&(a.addClass("e-selected"),this._isApplied=!0,f=[r,u])):l&&a.removeClass("e-selected");l=!1}c=i._goToCollection.selected.length;(n._isFrozen(i.frozenRows)||n._isFrozen(i.frozenColumns))&&(c&&(f=i._goToCollection.selected[c-1].split(":")),f&&f.length&&this._freezeScroll(f[0],f[1],i));this._isApplied||c||n._showAlertDlg("Alert","NoCellFound","",200);y.selectedCell=p;!n._isUndoRedo&&this._isApplied&&(n._completeAction(y),n._trigActionComplete(y))},_applyGotoConstants:function(i,r,u,f){var v,y,d,o,s,l,p,w=!1,et=[],g,a,e=this.XLObj,b=e.getActiveSheetIndex(),h,k,nt=e.model.sheets[b].usedRange,tt=nt.rowIndex,it=nt.colIndex,c=e.getSheet(b),rt=c._selectedCells,ut=0,ft=0;for(this._isApplied=!1,c._goToCollection={multiple:!1,selected:[]},rt.length>1&&(a=this._getSelRangeDetails(rt),tt=a[0],it=a[1],ut=a[2],ft=a[3],c._goToCollection.multiple=!0),v=0;v<=tt;v++){for(y=0;y<=it;y++)o=v+ut,s=y+ft,h=t.isNullOrUndefined(e.XLEdit.getPropertyValue(o,s))?"":e.XLEdit.getPropertyValue(o,s).toString(),k=t.isNullOrUndefined(e.XLEdit.getPropertyValue(o,s,"value2"))?"":e.XLEdit.getPropertyValue(o,s,"value2").toString(),g=h.charAt(0)==="="&&typeof k=="string",e._isRowViewable(b,o)&&(d=e.getCell(o,s,b),w=!0),!g&&(i&&n.isNumeric(h)||r&&!(h.toLowerCase()==="true"||h.toLowerCase()==="false")&&!n.isNumeric(h)&&h.length>0||u&&(h.toLowerCase()==="true"||h.toLowerCase()==="false")||f&&k.length!==0&&k.indexOf("#")===0)?(et.push({rowIndex:o,colIndex:s,isApply:!0}),e.model.scrollSettings.allowVirtualScrolling&&c._goToCollection.selected.push(o+":"+s),w&&(d.addClass("e-selected"),this._isApplied=!0,l=[o,s])):w&&d.removeClass("e-selected");w=!1}p=c._goToCollection.selected.length;(e._isFrozen(c.frozenRows)||e._isFrozen(c.frozenColumns))&&(p&&(l=c._goToCollection.selected[p-1].split(":")),l&&l.length&&this._freezeScroll(l[0],l[1],c));this._isApplied||p||e._showAlertDlg("Alert","NoCellFound","",200)},_applyGotoColDiff:function(){var o,s,a,t,r,u,h,c=!1,y=[],f,n=this.XLObj,e=n.getActiveSheetIndex(),p=n.model.sheets[e].usedRange,w,b=p.rowIndex,k=p.colIndex,i=n.getSheet(e),d=i._selectedCells,l=0,g=0,v={sheetIndex:e,reqType:"find-replace",operation:"coldiff"},nt;if(this._isApplied=!1,i._goToCollection={multiple:!1,selected:[]},d.length>1)for(f=this._getSelRangeDetails(d),b=f[0],k=f[1],l=f[2],g=f[3],i._goToCollection.multiple=!0,o=0;o<=k;o++){for(t=o+g,nt=n.XLEdit.getPropertyValue(l,t)?n.XLEdit.getPropertyValue(l,t).toString():"",s=0;s<=b;s++)r=s+l,w=n.XLEdit.getPropertyValue(r,t)?n.XLEdit.getPropertyValue(r,t).toString():"",n._isRowViewable(e,r)&&(a=n.getCell(r,t,e),c=!0),w===nt?c&&a.removeClass("e-selected"):(y.push({rowIndex:r,colIndex:t,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&i._goToCollection.selected.push(r+":"+t),c&&(a.addClass("e-selected"),this._isApplied=!0,u=[r,t]));c=!1}h=i._goToCollection.selected.length;(n._isFrozen(i.frozenRows)||n._isFrozen(i.frozenColumns))&&(h&&(u=i._goToCollection.selected[h-1].split(":")),u&&u.length&&this._freezeScroll(u[0],u[1],i));this._isApplied||h||n._showAlertDlg("Alert","NoCellFound","",200);v.selectedCell=y;!n._isUndoRedo&&this._isApplied&&(n._completeAction(v),n._trigActionComplete(v))},_applyGotoRowDiff:function(){var o,s,a,u,h,t,r,c=!1,y=[],f,n=this.XLObj,e=n.getActiveSheetIndex(),p=n.model.sheets[e].usedRange,w,b=p.rowIndex,k=p.colIndex,i=n.getSheet(e),d=i._selectedCells,g=0,l=0,nt,v={sheetIndex:e,reqType:"find-replace",operation:"rowdiff"};if(this._isApplied=!1,i._goToCollection={multiple:!1,selected:[]},d.length>1)for(f=this._getSelRangeDetails(d),b=f[0],k=f[1],g=f[2],l=f[3],i._goToCollection.multiple=!0,o=0;o<=b;o++){for(t=o+g,nt=n.XLEdit.getPropertyValue(t,l)?n.XLEdit.getPropertyValue(t,l).toString():"",s=0;s<=k;s++)r=s+l,w=n.XLEdit.getPropertyValue(t,r)?n.XLEdit.getPropertyValue(t,r).toString():"",n._isRowViewable(e,t)&&(a=n.getCell(t,r,e),c=!0),w===nt?c&&a.removeClass("e-selected"):(y.push({rowIndex:t,colIndex:r,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&i._goToCollection.selected.push(t+":"+r),c&&(a.addClass("e-selected"),this._isApplied=!0,u=[t,r]));c=!1}h=i._goToCollection.selected.length;(n._isFrozen(i.frozenRows)||n._isFrozen(i.frozenColumns))&&(h&&(u=i._goToCollection.selected[h-1].split(":")),u&&u.length&&this._freezeScroll(u[0],u[1],i));this._isApplied||h||n._showAlertDlg("Alert","NoCellFound","",200);v.selectedCell=y;!n._isUndoRedo&&this._isApplied&&(n._completeAction(v),n._trigActionComplete(v))},_freezeScroll:function(n,t,i){var r,u=this.XLObj;r=u._getIdxWithOffset(n,t,!1,["freeze"]);(i._ftopRowIdx>n||n>i._bottomRow.idx)&&u._scrollContent({y:r.yOffset-i._frozenHeight+1},!0);(i._fleftColIdx>t||t>i._rightCol.idx)&&u._scrollContent({x:r.xOffset-i._frozenWidth+1},!0)}}}(jQuery,Syncfusion);$.fn.setInputPos=function(n,t){return t||(t=n),$(this).is(":visible")?this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(n,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",n);i.select()}}):void 0},function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.formatCellDialog=function(n){this.XLObj=n;this._categories=[{value:"General",text:n._getLocStr("LGeneral")},{value:"Number",text:n._getLocStr("NumberTab")},{value:"Currency",text:n._getLocStr("LCurrency")},{value:"Accounting",text:n._getLocStr("LAccounting")},{value:"Date",text:n._getLocStr("LDate")},{value:"Time",text:n._getLocStr("LTime")},{value:"Percentage",text:n._getLocStr("LPercentage")},{value:"Fraction",text:n._getLocStr("LFraction")},{value:"Scientific",text:n._getLocStr("LScientific")},{value:"Text",text:n._getLocStr("LText")},{value:"Custom",text:n._getLocStr("LCustom")}];this._selValue="General"};t.spreadsheetFeatures.formatCellDialog.prototype={_renderCellFrmtDlg:function(){var i=this.XLObj,y=i._id,r=y+"_formatdlg",e,u,f,o,l,a,s,v,h,c;e=t.buildTag("div#"+r);u=t.buildTag("div#"+r+"_formattab");f=t.buildTag("div.e-dlg-fields e-dlgctndiv");o=t.buildTag("ul .e-ul");l=t.buildTag("a",i._getLocStr("NumberTab"),{},{href:"#"+r+"_number"});a=t.buildTag("li",l);o.append(a);u.append(o);f.append(u);s=t.buildTag("div.e-dlg-btnfields");v=t.buildTag("div.e-dlg-btnctnr");h=t.buildTag("input#"+r+"_okbtn");c=t.buildTag("input#"+r+"_cantn");h.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgCFOk,this),cssClass:"e-ss-okbtn"});c.ejButton({text:i._getLocStr("Cancel"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgCFCancel,this)});s.append(v.append(h,c));f.append(t.buildTag("div#"+r+"_format_dataMnger","",{display:"none"}));i.element.append(e.append(f,s));u.ejTab({width:"100%",height:"auto",cssClass:"e-ss-dlgtab",allowKeyboardNavigation:!1});this._renderNumberTab();e.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("Formatcells"),width:"auto",height:"auto",cssClass:"e-ss-dialog e-ss-mattab e-ss-fcdlg e-"+i._id+"-dlg",open:function(){n("#"+i._id+"_formatdlg_okbtn").focus()}})},_renderNumberTab:function(){var l,f=this.XLObj,i=f._id+"_fdlg_nTab",ut=this._categories,b,k,d,h,g,s,e,r,u,a,v,y,p,w,nt,tt;b=[{text:"Wednesday, March 14, 2012",value:"{0:dddd, MMMM dd, yyyy}"},{text:"3/14/2012",value:"{0:M/d/yyyy}"},{text:"March 03",value:"{0:MMMM dd}"},{text:"2012 March",value:"{0:yyyy MMMM}"},{text:"3/14/12 1:30 PM",value:"{0:dd/MM/yyyy h:mm tt}"}];k=[{text:"0",type:"default"},{text:"0.00",type:"default"},{text:"#,##0",type:"default"},{text:"#,##00.00",type:"default"},{text:"0%",type:"default"},{text:"0.00%",type:"default"},{text:"MM/dd/yyyy",type:"default"},{text:"d-MMM",type:"default"},{text:"h:mm",type:"default"},{text:"mm:ss",type:"default"}];d=[{text:"1:30:55 PM",value:"{0:h:mm:ss tt}"},{text:"1:30 PM",value:"{0:h:mm tt}"},{text:"13:30:55",value:"{0:h:mm:ss}"},{text:"1:30",value:"{0:hh:mm}"}];var ft=t.buildTag("div.e-ss-maindiv"),it=t.buildTag("div.e-ss-topdiv","",{display:"inline-flex",width:"100%"}),rt=t.buildTag("div.e-ss-centerdiv","",{display:"inline-flex",width:"100%"}),c=t.buildTag("div.e-ss-lefttopdiv",""),o=t.buildTag("div.e-ss-righttopdiv","",{float:"right"});g=t.buildTag("label.e-dlg-fields",f._getLocStr("FormatSample"));o.append(g);it.append(c,o);c=t.buildTag("div.e-ss-leftdiv","");o=t.buildTag("div.e-ss-rightdiv","",{float:"right"});s=t.buildTag("input#"+i+"_sinput.ejinputtext","",{},{disabled:"disabled"});o.append(s);l=t.buildTag("div#div"+i,"");e=t.buildTag("table","",{"white-space":"normal"});r=t.buildTag("tr#"+i+"_decimal.e-fdlg-num-options");u=t.buildTag("td",t.buildTag("label.e-dlg-fields",f._getLocStr("DecimalPlacesTxt")),"",{width:"103px"});e.append(r.append(u));r=t.buildTag("tr#"+i+"_decimaldrop.e-fdlg-num-options");u=t.buildTag("td");s=t.buildTag("input#"+i+"_decimalplace","");o.append(l.append(e.append(r.append(u.append(s)))));r=t.buildTag("tr#"+i+"_tseparator.e-fdlg-num-options");u=t.buildTag("td","","",{colspan:"2"});h=t.buildTag("input#"+i+"_kseptr");e.append(r.append(u.append(h)));r=t.buildTag("tr#"+i+"_dtypes.e-fdlg-num-options");u=t.buildTag("td",t.buildTag("label.e-dlg-fields",f._getLocStr("Type")));a=t.buildTag("ul#"+i+"_datetypes");e.append(r.append(u.append(a)));r=t.buildTag("tr#"+i+"_ttypes.e-fdlg-num-options");u=t.buildTag("td",t.buildTag("label.e-dlg-fields",f._getLocStr("Type")));v=t.buildTag("ul#"+i+"_timetypes");e.append(r.append(u.append(v)));r=t.buildTag("tr#"+i+"_custom.e-fdlg-num-options");u=t.buildTag("td",t.buildTag("label.e-dlg-fields",f._getLocStr("Type")));y=t.buildTag("input#"+i+"_custominput.ejinputtext");p=t.buildTag("ul#"+i+"_customtypes");w=t.buildTag("button#"+i+"_delBtn",f._getLocStr("Delete"),{},{type:"button"});nt=t.buildTag("div",w);e.append(r.append(u.append(y,p,nt)));f._on(y,"keydown",this._validateCustomFormat);tt=t.buildTag("div#"+i+"_typeinfo.e-ss-fcgdiv","",{});o.append(l);rt.append(c,o);n("#"+f._id+"_formatdlg_number").append(ft.append(it,rt,tt));e.find(".e-fdlg-num-options").hide();this._createNumList(ut,c);s.ejNumericTextbox({name:"numeric",value:2,height:27,width:"100%",minValue:0,maxValue:30,change:n.proxy(this._refreshFrmtPropChanges,this)});h.ejCheckBox({change:n.proxy(this._refreshFrmtPropChanges,this)});h.parent().append(t.buildTag("label.e-dlg-fields",f._getLocStr("ThousandSeparatorTxt"),{"margin-left":6}));a.ejListBox({selectedItemIndex:"0",dataSource:b,fields:{text:"text",value:"value"},width:"100%",height:"120",selected:n.proxy(this._refreshFrmtPropChanges,this)});v.ejListBox({selectedItemIndex:"0",dataSource:d,fields:{text:"text",value:"value"},width:"100%",height:"120",selected:n.proxy(this._refreshFrmtPropChanges,this)});p.ejListBox({selectedItemIndex:"0",dataSource:k,fields:{text:"text",value:"value"},width:"100%",height:"100",selected:n.proxy(this._refreshFrmtPropChanges,this)});n("#"+i+"_datetypes_container").addClass("e-ss-datetypes");n("#"+i+"_timetypes_container").addClass("e-ss-timetypes");n("#"+i+"_customtypes_container").addClass("e-ss-customtypes");w.ejButton({showRoundedCorner:!0,width:60,click:n.proxy(this._customFormatDelete,this)})},_initFormatCellDlg:function(){var t=this.XLObj;if(!t.model.allowCellFormatting)return!1;n("#"+t._id+"_formatdlg").ejDialog("open");this._updateFormtdata();n("#"+t._id+"_formatdlg_format_dataMnger").removeData()},_updateFormtdata:function(){var i=this.XLObj,s=i.getActiveCell(),r=n("#"+i._id+"_fdlg_nTab_list").data("ejListBox"),w=n("#"+i._id+"_fdlg_nTab_decimalplace").data("ejNumericTextbox"),a=n("#"+i._id+"_fdlg_nTab_datetypes").data("ejListBox"),v=n("#"+i._id+"_fdlg_nTab_timetypes").data("ejListBox"),b=n("#"+i._id+"_fdlg_nTab_input").data("ejDropDownList"),u=n("#"+i._id+"_fdlg_nTab_customtypes").data("ejListBox"),t,y,p,f,e,o,h,c,l;r&&r._refreshScroller();t=i.getRangeData({range:[s.rowIndex,s.colIndex,s.rowIndex,s.colIndex]})[0];y="decimalPlaces"in t?t.decimalPlaces:2;p="thousandSeparator"in t?t.thousandSeparator:!1;f="type"in t?t.type.indexOf("date")>-1?"date":t.type:"general";"formatStr"in t?(e=a.getIndexByValue(t.formatStr),o=v.getIndexByValue(t.formatStr),i.isUndefined(e)&&i.isUndefined(o)&&["date"].indexOf(f)>-1&&(h=u.model.dataSource,c=t.formatStr.replace(/^\{0\:|\}$/g,""),i._isValueAlreadyExist(h,"text",c)||(h.push({text:c,type:"custom"}),u._setModel({dataSource:h})),l=u.getIndexByText(c),f="custom")):e=o=0;r&&r.selectItemByValue(n.camelCase("-"+f));a.selectItemByIndex(e>-1?e:0);v.selectItemByIndex(o>-1?o:0);u.selectItemByIndex(l>-1?l:0);f==="string"&&(r.selectItemByIndex(10),u.selectItemByText(t.formatStr));w.option("value",y);n("#"+i._id+"_fdlg_nTab_kseptr").ejCheckBox({checked:p});this._onNumFormatSelect({value:r?r.model.value:b.model.value})},_onNumFormatSelect:function(t){var i=this.XLObj,r="#"+i._id+"_fdlg_nTab_",e=n("#"+i._id+"_fdlg_nTab_typeinfo"),f,u=t.value;n("#"+i._id+"_formatdlg_number").find(".e-fdlg-num-options").hide();switch(u){case"Number":i.model.formatSettings.allowDecimalPlaces&&n(r+"decimal, "+r+"tseparator, "+r+"decimaldrop").show();break;case"Currency":case"Accounting":case"Percentage":case"Scientific":n(r+"decimal").show();n(r+"decimaldrop").show();break;case"Date":n(r+"dtypes").show();n("#"+i._id+"_fdlg_nTab_datetypes").data("ejListBox")._refreshScroller();break;case"Time":n(r+"ttypes").show();n("#"+i._id+"_fdlg_nTab_timetypes").data("ejListBox")._refreshScroller();break;case"Custom":n(r+"custom").show();n("#"+i._id+"_fdlg_nTab_customtypes").data("ejListBox")._refreshScroller()}f=this._getFormattedText(u);n("#"+i._id+"_fdlg_nTab_decimalplace").data("ejNumericTextbox").option("maxValue",u==="Scientific"?20:30);n("#"+i._id+"_fdlg_nTab_sinput").val(f);e.text(i._getLocStr(u));this._selValue=u},_getFormattedText:function(i){var f,o,r,h,c,e=0,u=this.XLObj,a=u.getActiveCell(),p=n("#"+u._id+"_fdlg_nTab_decimalplace").data("ejNumericTextbox"),w=n("#"+u._id+"_fdlg_nTab_datetypes").data("ejListBox"),v={Number:"0:N",Currency:"0:C",Accounting:"0:C",Percentage:"0:P",Scientific:"0:N"},b=n("#"+u._id+"_fdlg_nTab_timetypes").data("ejListBox"),l=t.Spreadsheet.CellType,y=t.Spreadsheet.CellFormat,s=n("#"+u._id+"_fdlg_nTab_customtypes").data("ejListBox");u.model.formatSettings.allowDecimalPlaces&&(e=p.getValue());r=u.XLEdit.getPropertyValue(a.rowIndex,a.colIndex)||"";o=n("#"+u._id+"_fdlg_nTab_kseptr").ejCheckBox("checked");switch(i){case"Number":case"Currency":case"Accounting":case"Percentage":f="{"+v[i]+e+"}";u._isDateTime(r)&&(r=u._dateToInt(r));r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,thousandSeparator:o,type:l[i],decimalPlaces:e}));break;case"Date":f=w.getSelectedItems()[0].value;i=f===y.longdate?"longdate":f===y.shortdate?"shortdate":"date";r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,type:i}));break;case"Time":f=b.getSelectedItems()[0].value;r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,type:l[i]}));e=0;break;case"Scientific":f="{"+v[i]+e+"}";u._isDateTime(r)&&(r=u._dateToInt(r));r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,thousandSeparator:o,type:l[i],decimalPlaces:e}));break;case"Fraction":u._isDateTime(r)&&(r=u._dateToInt(r));r=u.toFraction(r);r&&(r=t.isNullOrUndefined(r.numerator)?r.integer:r.integer+" "+r.numerator+"/"+r.denominator);break;case"General":case"Text":u._isDateTime(r)&&(r=u._dateToInt(r));break;case"Custom":h=s.getSelectedItems()[0].text;c=u.XLFormat.customFormatParser(h);n("#"+u._id+"_fdlg_nTab_custominput").val(h);r=u.XLFormat._format(r,c);s.getSelectedItems()[0].index>-1&&n("#"+u._id+"_fdlg_nTab_delBtn").data("ejButton")._setModel({enabled:s.model.dataSource[s.getSelectedItems()[0].index].type==="custom"})}return n("#"+u._id+"_formatdlg_format_dataMnger").data("NumFormat",i==="Custom"?c:{type:i.toLowerCase(),decimalPlaces:e,thousandSeparator:o,formatStr:f}),r},_refreshFrmtPropChanges:function(){var i=this.XLObj,t;t=this._getFormattedText(this._selValue);n("#"+i._id+"_fdlg_nTab_sinput").val(t)},_dlgCFCancel:function(){var t=this.XLObj;n("#"+t._id+"_formatdlg").ejDialog("close");t.model.showRibbon&&t.XLRibbon._updateRibbonIcons();t.setSheetFocus()},_dlgCFOk:function(t){var i=this.XLObj,r=n("#"+i._id+"_formatdlg_format_dataMnger").data();t&&this._selValue==="Custom"&&this._validateCustomFormat()||(i.getObjectLength(r.NumFormat)&&i.XLFormat.format(r.NumFormat),i.model.showRibbon&&i.XLRibbon._updateRibbonIcons(),n("#"+i._id+"_formatdlg").ejDialog("close"),i.setSheetFocus())},_customFormatDelete:function(){var t=n("#"+this.XLObj._id+"_fdlg_nTab_customtypes").data("ejListBox"),i=t.model.dataSource;i.splice(t.model.selectedItemIndex,1);t._setModel({dataSource:i});t.selectItemByIndex(0);this._refreshFrmtPropChanges()},_validateCustomFormat:function(t){var i=t?this:this.XLObj,u,r,f,e=n("#"+i._id+"_fdlg_nTab_custominput").val(),o=i.XLFormat.customFormatParser(e);if(!t||t.keyCode===13)if(i.getObjectLength(o))u=n("#"+i._id+"_fdlg_nTab_customtypes").data("ejListBox"),r=u.model.dataSource,i._isValueAlreadyExist(r,"text",e)||(r.push({text:e,type:"custom"}),u._setModel({dataSource:r})),n("#"+i._id+"_formatdlg_format_dataMnger").data("NumFormat",o),t&&i.XLCellFrmtDlg._dlgCFOk();else return f=n("#"+i._id+"_alertdlg"),i._renderAlertDlgContent(f,"Alert",i._getLocStr("CustomFormatAlert")),f.ejDialog("open"),!0},_createNumList:function(i,r){var u=this.XLObj,f=u._id+"_fdlg_nTab",s,e,o,h=t.buildTag("div.e-ss-drpdiv");e=t.buildTag("input#"+f+"_input");h.append(e);n("#"+u._id+"_formatdlg_number").prepend(h);e.ejDropDownList({dataSource:i,cssClass:"e-ss-num-format",width:"100%",fields:{id:"value",text:"text",value:"text"},select:n.proxy(this._onNumFormatSelect,this),selectedItemIndex:0});s=t.buildTag("label#"+f+"_clabel.e-dlg-fields",u._getLocStr("Category"));u.element.find(".e-ss-lefttopdiv").append(s);o=t.buildTag("ul#"+f+"_list");r.append(o);o.ejListBox({selectedItemIndex:"0",width:"120",height:"250",dataSource:i,fields:{text:"text",value:"value"},select:n.proxy(this._onNumFormatSelect,this),allowMultiSelection:!1})}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.shape=function(n){this.XLObj=n;this._imgX=0;this._imgY=0;this._imgOffsetleft=0;this._imgOffsetTop=0;this._shapeType="img";this._shapeROStart=!1;this._shapeRSStart=!1;this._imgRSWStart=!1;this._imgRSEStart=!1;this._imgRSNStart=!1;this._imgRSSStart=!1;this._changePicture=!1;this._picCellIdx={};this._insertShape=!1};t.spreadsheetFeatures.shape.prototype={_insertPicture:function(n){var i=this.XLObj,u=i._browserDetails.name==="msie"&&parseInt(i._browserDetails.version)<10?n.responseText:n.xhr.response,f,e,s,h,o,l;if(u.startsWith("Invalid"))i._showAlertDlg("Alert","ImageValAlert");else if(f=i.getActiveSheetIndex(),e=i.getSheet(f),this._changePicture)this.changePicture(null,u);else{var r=i.getActiveCell(),c=i.model.pictureSettings,a=c.height,v=c.width;t.isNullOrUndefined(r)&&(o=i.element.find(".e-ss-activeimg").get(0),l=this._getCellIndexFromOffset(o.offsetTop,o.offsetLeft));s=e._colWidthCollection[r.colIndex];h=e._rowHeightCollection[r.rowIndex];this._insertShape=!0;this._createPicture(f,r,u,h,s,v,a)}},changePicture:function(t,i){var u=this.XLObj,s=u.getActiveSheetIndex(),a=u.getSheet(s),r,h,c,l,f,e,o;r=t?n("#"+t).get(0):u.getSheetElement(s).find(".e-ss-activeimg").get(0);h=r.offsetLeft;c=r.offsetTop;l=this._getCellIndexFromOffset(c,h);f=a.shapeMngr;n(r).css("background-image","url('"+i+"')");e=f.picture[r.id];o={sheetIndex:s,reqType:"shape",shapeType:"picture",action:"changepicture",id:n(r).attr("id"),cell:l,prev:{img:f.sharedPics[e.data],data:e.data,pcIdx:r.id},cur:{img:i,pcIdx:r.id}};f.sharedPics.indexOf(i)===-1&&f.sharedPics.push(i);e.data=f.sharedPics.indexOf(i);o.cur.data=e.data;this._changePicture=!1;u.setSheetFocus();u._completeAction(o);u._trigActionComplete(o)},setPicture:function(n,t,i,r,u,f){var e=this.XLObj,o,s,h,c,l;if(e.model.pictureSettings.allowPictures&&!e.model.isReadOnly)return(n=e._getRangeArgs(n,"object"),o=n[0],s=n[1],e.model.allowLockCell&&e._isCellProtected(o,s,!1))?void 0:(h=e.getActiveSheetIndex(),l=e.model.pictureSettings,r=r?r:l.height,i=i?i:l.width,e._isRowViewable(h,o)?(c=e.getCell(o,s)[0],u=u?u:c.offsetTop,f=f?f:c.offsetLeft):(u=u?u:0,f=f?f:0),this._createPicture(h,{rowIndex:o,colIndex:s},t,u,f,i,r))},resetPicture:function(i,r){var f=this.XLObj,u,s,e,o;u=i?n("#"+i):f.element.find(".e-ss-activeimg");s=new RegExp("\\be-shapebdr.*?\\b","g");e={sheetIndex:f.getActiveSheetIndex(),reqType:"shape",shapeType:"picture",action:"resetpicture",id:n(u).attr("id"),actionType:r};f._dupDetails=!0;t.isNullOrUndefined(u[0].className.match(s))||(o=f.XLShape._getImgStyleFromHashCode(u[0].className.match(s)[0]));e.prev=o?{bcolor:o["border-color"],bstyle:o["border-style"],bwidth:o["border-width"]}:{};u[0].className=u[0].className.replace(s,"");e.cur={bcolor:u.css("border-color"),bstyle:u.css("border-style"),bwidth:u.css("border-width")};r!="resetpicture"&&(e.prev.width=u.css("width"),e.prev.height=u.css("height"),u.css({width:f.model.pictureSettings.width,height:f.model.pictureSettings.height}),e.cur.width=u.css("width"),e.cur.height=u.css("height"),f.XLShape._updateShapeObj(u[0]),f._hasClass(u[0],"e-ss-activeimg")&&f.XLRibbon._formatTabUpdate());f._dupDetails=!1;f._completeAction(e);f._trigActionComplete(e)},_createPicture:function(n,i,r,u,f,e,o,s,h,c,l,a){var w,d,g;h=h?h:"transparent";c=c?c:"solid";l=l?l:"1px";var v=this.XLObj,k,b=v.getSheet(n),y={sheetIndex:n,targetCell:i,top:u,left:f,width:e,height:o,bcolor:h,bstyle:c,bwidth:l,reqType:"picture",add:"add"},p;if(k={sheetIndex:y.sheetIndex,targetCell:y.targetCell,top:y.top,left:y.left,width:y.width,height:y.height,bcolor:y.bcolor,bstyle:y.bstyle,bwidth:y.bwidth,reqType:"picture",action:"add"},!v._trigActionBegin(k))return b._isImported||(this._insertShape=!0),u=y.top,f=y.left,e=y.width,o=y.height,s=t.isNullOrUndefined(s)?v.model.allowCharts&&v.XLChart._shapeCnt:s,v._isExport&&(a.cnt=s),p=v._id+"_picture"+s,i||(i=this._getCellIndexFromOffset(u,f,n)),d=i.rowIndex,g=i.colIndex,!v._isUndoRedo&&v.model.allowCharts&&v.XLChart._shapeCnt++,this._updateShapeMngr(i,{picture:{data:r,id:p,height:o,width:e,left:f,top:u,rowIndex:d,colIndex:g,bwidth:l,bcolor:h,bstyle:c}},"picture"),v._isExport||this._refreshPictureElement({top:u,left:f,width:e,height:o,bcolor:h,bstyle:c,bwidth:l,imgData:r,cnt:s,sheetIdx:n}),v.setSheetFocus(),b._isImported&&!b._isLoaded||v._isUndoRedo||v._isPaste||v.XLClipboard._isShape||v._isExport||(w={sheetIndex:n,reqType:"shape",shapeType:"picture",action:"create",id:p,actCell:i,img:r,cnt:s},w.position={top:u,left:f,height:o,width:e},v._completeAction(w),v._trigActionComplete(w)),v.model.showRibbon&&v.XLRibbon._formatTabUpdate(),p},_refreshPictureElement:function(i){var r=this.XLObj,u,f,e;r._getJSSheetContent(i.sheetIdx).find(".e-spreadsheetcontentcontainer > .e-content").append(t.buildTag("div.e-ss-object","","",{id:r._id+"_picture"+i.cnt}));u=n("#"+r._id+"_picture"+i.cnt);u.data("parentID",r._id);u.css({"background-image":"url('"+i.imgData+"')",height:i.height,width:i.width,left:i.left,top:i.top});f=i.bwidth+" "+i.bstyle+" "+i.bcolor;e=this._getImgBorderHashCode({"border-color":i.bcolor,"border-style":i.bstyle,"border-width":i.bwidth});r.model.allowCellFormatting&&r.XLFormat._writeCssRules(e,r.XLFormat._getCssPropertyAsString({border:{left:f,right:f,top:f,bottom:f}}));u.addClass(e);this._selectImg(u)},_shapeMouseDown:function(t){var i,f;t.preventDefault();i=this.XLObj;f=document.activeElement.id;i._isTouchEvt&&this._imgMouseMove(t);(f.indexOf("PictureHeight")>-1||f.indexOf("PictureWidth")>-1)&&i.setSheetFocus();var u,s=t.target.id,r=n(t.target),h=r.get(0),e=h.offsetLeft,o=h.offsetTop,c=i._setXY(t);this._selectImg(r);this._picCellIdx=this._getCellIndexFromOffset(o,e);this._imgOffsetleft=e;this._imgOffsetTop=o;this._imgX=c[0];this._imgY=c[1];this._shapeType=s.indexOf("chart")>-1?"chart":"img";r.css("cursor")==="move"?this._shapeROStart=!0:(r.css("cursor")==="col-resize"||r.css("cursor")==="row-resize")&&(this._shapeRSStart=!0,i._getContent(i.getActiveSheetIndex()).find(".e-ss-imgvisual").css({left:e,top:o,height:r.height(),width:r.width()}));this._shapeType==="chart"&&(u=i.XLChart._getShapeObj(s,this._shapeType),i.getActiveSheetIndex()!==u.dataSheetIdx||u.isChartSeries||i.XLChart._focusChartRange(u.xAxis.range,u.yAxis.range,u.legend.range));i.model.enableContextMenu&&i.XLCMenu._isMenuOpened&&i.XLCMenu.hideCMenu()},_imgKeyDown:function(n){var r=this.XLObj,s=r.getActiveSheetIndex(),t=r._getContent(s).find(".e-ss-activeimg"),i=t.get(0),e=i.offsetLeft,o=i.offsetTop,u,f,h;if(this._shapeType=t[0].id.indexOf("chart")>-1?"chart":"img",this._picCellIdx=this._getCellIndexFromOffset(o,e),n.shiftKey||n.ctrlKey)n.shiftKey&&!n.ctrlKey&&(n.keyCode===39||n.keyCode===38?(n.preventDefault(),u=t.height()+2,f=t.width()+2,u<400&&f<600&&t.css({width:f,height:u}),this._updateShapeObj(i),r.XLRibbon._formatTabUpdate()):(n.keyCode===37||n.keyCode===40)&&(n.preventDefault(),u=t.height()-2,f=t.width()-2,u>40&&f>60&&t.css({width:f,height:u}),this._updateShapeObj(i),r.XLRibbon._formatTabUpdate()));else{switch(n.keyCode){case 39:n.preventDefault();t.css({left:e+2});this._updateShapeObj(i);break;case 37:n.preventDefault();e>1&&t.css({left:e-2});this._updateShapeObj(i);break;case 38:n.preventDefault();o>1&&t.css({top:o-2});this._updateShapeObj(i);break;case 40:n.preventDefault();t.css({top:o+2});this._updateShapeObj(i)}this._onKeyscrollShape(s,t,n)}n.keyCode===46&&(n.preventDefault(),h=!1,r.XLClipboard._isShape&&(r.XLClipboard._isShape=!1,h=!0),this._deleteShape(s,t),h&&(r.XLClipboard._isShape=!0))},_shapeMouseUp:function(t){var r=this.XLObj,o={};if(!r._isExport){var l,a,c="chart",f,s=r.getActiveSheetIndex(),v=r.getSheet(s),y=r._getContent(s),u=y.find(".e-ss-activeimg"),h=y.find(".e-ss-imgvisual"),e=n(t.target),i=e.get(0);if((e.hasClass("e-ss-picture")||e[0].id.indexOf(r._id+"_picture")>-1)&&r.model.showRibbon&&r.XLRibbon._formatTabUpdate(),i.id.indexOf(c)>-1&&i.id.indexOf("Ribbon")<0&&(i=i.id.indexOf("_svg")>-1?n(i).parents(".e-ss-object").get(0):i),u.length<1&&(this._shapeROStart=!1),i.className.indexOf("e-ss-imgvisual")>-1||i.className.indexOf("e-ss-object")>-1||(this._shapeROStart&&(i=u[0]),this._shapeRSStart&&(i=h[0])),this._shapeROStart)r._isTouchEvt&&(a=r._getOriginalEvt(t),i=document.elementFromPoint(a.clientX,a.clientY)),r._isUndoRedo||(parseInt(u.css("top"))!==i.offsetTop||parseInt(u.css("left"))!==i.offsetLeft)&&(f={sheetIndex:s,reqType:"shape",shapeType:"chart",action:"edit",actionType:"reorder",id:n(u).attr("id"),visualImg:h,trgt:e},f.prev={top:parseInt(u.css("top")),left:parseInt(u.css("left")),height:parseInt(u.css("height")),width:parseInt(u.css("width"))},f.cur={top:i.offsetTop,left:i.offsetLeft,height:e.height(),width:e.width()},u[0].id.indexOf(c)>-1&&(l=r._getIdxWithOffset(f.cur.top,f.cur.left,!0),v.shapeMngr[c][u[0].id].rowIndex=l.rowIdx,v.shapeMngr[c][u[0].id].colIndex=l.colIdx),r._checkIndicesInContainer(s,this._picCellIdx.rowIndex,this._picCellIdx.colIndex)&&(f.obj=n.extend(!0,{},r._dataContainer.sheets[s][this._picCellIdx.rowIndex][this._picCellIdx.colIndex]),r._completeAction(f),r._trigActionComplete(f))),u.css({left:i.offsetLeft,top:i.offsetTop}),this._updateShapeObj(i),h.removeClass("e-ss-picture").hide();else if(this._shapeRSStart&&(r._isUndoRedo||(r._isTouchEvt&&(i=h[0]),i.className.indexOf("e-ss-imgvisual")<0&&h.length>0&&this._shapeROStart&&(i=h[0]),e=n(i),(parseInt(u.css("height"))!==e.height()||parseInt(u.css("width"))!==e.width())&&r._checkIndicesInContainer(s,this._picCellIdx.rowIndex,this._picCellIdx.colIndex)&&(f={sheetIndex:s,reqType:"shape",shapeType:"chart",action:"edit",actionType:"resize",id:n(u).attr("id"),visualImg:h,trgt:e},f.prev={top:parseInt(u.css("top")),left:parseInt(u.css("left")),height:parseInt(u.css("height")),width:parseInt(u.css("width"))},f.cur={top:i.offsetTop,left:i.offsetLeft,height:e.height(),width:e.width()},f.obj=n.extend(!0,{},r._dataContainer.sheets[s][this._picCellIdx.rowIndex][this._picCellIdx.colIndex]),r._completeAction(f),r._trigActionComplete(f))),f&&u.css({left:i.offsetLeft,top:i.offsetTop,height:e.height(),width:e.width()}),this._updateShapeObj(i),h.removeClass("e-ss-picture").hide(),this._shapeType==="img"&&r.model.showRibbon&&r.XLRibbon._formatTabUpdate(),this._shapeType===c&&(r.XLChart.resizeChart(u.attr("id"),e.height(),e.width()),r.model.showRibbon&&r.XLRibbon._chartDesignTabUpdate(n("#"+u.attr("id")))),o.event=t,o.target=t.target,f&&f.cur&&f.prev&&(o.newHeight=f.cur.height,o.newWidth=f.cur.width,o.oldHeight=f.prev.height,o.oldWidth=f.prev.width),o.reqType=i.id.indexOf(c)>-1?"chart-resize":"picture-resize",this.XLObj._trigger("resizeEnd",o))){this._refreshImgResizing();this._shapeRSStart=!1;return}this._refreshImgResizing();this._shapeROStart=this._shapeRSStart=!1}},_imgMouseMove:function(n){var i=this.XLObj,s={};if(i._getContent(i.getActiveSheetIndex()).find(".e-ss-activeimg").length){n.preventDefault();var p=i.getActiveSheetIndex(),h=i._getContent(p),u=h.find(".e-ss-activeimg"),t=h.find(".e-ss-imgvisual"),c=u.get(0),o=c.getBoundingClientRect(),w=i._setXY(n),f=w[0],e=w[1],r,l,a;if(this._shapeROStart){if(this.XLObj._trigger("dragShape",n))return;t.show();c.id.indexOf("picture")>-1&&t.addClass("e-ss-picture");l=f-(this._imgX-this._imgOffsetleft);a=e-(this._imgY-this._imgOffsetTop);l>-1&&a>-1&&t.css({left:l,top:a,height:u.height(),width:u.width()})}else{var v=t.width(),y=t.height(),b=c.offsetWidth,k=c.offsetHeight,d=i._getJSSheetContent(p).find(".e-spreadsheetcontentcontainer > .e-content"),g=h.find(".e-hscrollbar").data("ejScrollBar"),nt=h.find(".e-vscrollbar").data("ejScrollBar");if(this._shapeRSStart){if(s.event=n,s.target=n.target,s.height=u.height(),s.width=u.width(),s.reqType=c.id.indexOf("chart")>-1?"chart-resize":"picture-resize",this.XLObj._trigger("resizeStart",s)){this._shapeRSStart=!1;return}if(t.show(),c.id.indexOf("picture")>-1&&t.addClass("e-ss-picture"),u.css("cursor")==="col-resize"||u.css("cursor")==="row-resize")switch(!0){case this._imgRSWStart:r=this._imgX-f;l=t[0].offsetLeft-r;l>-1&&(t.css({width:v+r,left:l}),this._imgX=f);break;case this._imgRSEStart:r=this._imgX-f;i.model.scrollSettings.allowScrolling&&v-r+t[0].offsetLeft+5<d.width()+g.value()&&(t.css({width:v-r}),this._imgX=f);break;case this._imgRSNStart:r=this._imgY-e;a=t[0].offsetTop-r;a>-1&&(t.css({height:y+r,top:a}),this._imgY=e);break;case this._imgRSSStart:r=this._imgY-e;i.model.scrollSettings.allowScrolling&&y-r+t[0].offsetTop+5<d.height()+nt.value()&&(t.css({height:y-r}),this._imgY=e)}}else this._refreshImgResizing(),f<=o.left+(i._isTouchEvt?20:4)&&f>=o.left?(u.addClass("e-ss-imgcresize"),this._imgRSWStart=!0):f<=o.left+b&&f>=o.left+b-(i._isTouchEvt?20:4)?(u.addClass("e-ss-imgcresize"),this._imgRSEStart=!0):h.find(".e-ss-imgcresize").removeClass("e-ss-imgcresize"),e<=o.top+(i._isTouchEvt?20:4)&&e>=o.top?(u.addClass("e-ss-imgrresize"),this._imgRSNStart=!0):e<=o.top+k&&e>=o.top+k-(i._isTouchEvt?20:4)?(u.addClass("e-ss-imgrresize"),this._imgRSSStart=!0):h.find(".e-ss-imgrresize").removeClass("e-ss-imgrresize")}}},_deleteShape:function(n,t){var l,i=this.XLObj,r=this._picCellIdx,s=i._dataContainer,a=i.getSheet(n),h=a.shapeMngr,e=s.sheets[n][r.rowIndex][r.colIndex],o,p=t.data("parentID"),v=t.get(0).id.replace(p+"_",""),u=v.replace(/[0-9]/g,""),c=t.get(0),y,f=h[u][e[u][0]];i._isUndoRedo||i._isPaste||i.XLClipboard._isShape||(o={sheetIndex:n,id:c.id,picIndex:c.id,reqType:"shape",shapeType:u,action:"remove",options:f,range:f.range,img:h.sharedPics[f.data],bcolor:f.bcolor,bstyle:f.bstyle,bwidth:f.bwidth},o.actCell={rowIndex:r.rowIndex,colIndex:r.colIndex},o.position={height:f.height,width:f.width,top:f.top,left:f.left},o.cnt=v.replace(/[a-z]/g,""),i._completeAction(o),i._trigActionComplete(o));e[u].some(function(n,t){return c.id===h[u][e[u][t]].id?(y=t,!0):!1});Object.keys(e).length<2&&e[u].length<2?(delete s.sheets[n][r.rowIndex][r.colIndex],i.getObjectLength(s.sheets[n][r.rowIndex])<1&&delete s.sheets[n][r.rowIndex]):e[u].length<2?delete e[u]:e[u].splice(y,1);delete h[u][c.id];l={rowIndex:r.rowIndex,colIndex:r.colIndex};n===i._getSheetIndex()&&(i.setActiveCell(r.rowIndex,r.colIndex),i.performSelection(l,l));t.remove();i.model.allowFormulaBar&&i.updateFormulaBar();i.model.showRibbon&&(u==="picture"?i.XLRibbon._toggleFormatTab():i.XLRibbon._toggleChartDesignTab());a._isChartBorderDrawn&&i.XLChart._clearChartRange(i._arrayAsString(i._chartBorder))},_selectImg:function(n){this.XLObj._getContent(this.XLObj.getActiveSheetIndex()).find(".e-ss-activeimg").removeClass("e-ss-activeimg");n.addClass("e-ss-activeimg");this.XLObj.XLSelection._cleanUp(!0);this.XLObj.model.allowFormulaBar&&this.XLObj.updateFormulaBar()},_refreshImgResizing:function(){this._imgRSEStart=!1;this._imgRSWStart=!1;this._imgRSNStart=!1;this._imgRSSStart=!1},_getShapePropeties:function(n,t,i){for(var r,u=this.XLObj.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,i);r in u;)return u[r].id===t?u[r]:void 0},_updateShapeMngr:function(t,i,r,u){var s,h={},f=this.XLObj,o=u||f.getActiveSheetIndex(),e=f.getSheet(o).shapeMngr,c=e[r];c[i[r].id]=n.extend(!0,{},i[r]);r==="picture"&&(e.sharedPics.indexOf(i[r].data)<0&&e.sharedPics.push(i[r].data),s=e.sharedPics.indexOf(i[r].data),c[i[r].id].data=s);(f._isPaste||this._insertShape||f.XLClipboard._isShape||f.isImport||!f.getSheet(o)._isUpdated)&&(h[r]=i[r].id,f.XLEdit._updateDataContainer(t,{dataObj:h,sheetIdx:o}),this._insertShape=!1)},_updateShapeObj:function(t){var f,r=this.XLObj,s=r.getActiveSheetIndex(),h=r._dataContainer,o,e,u=this._shapeType==="img"?"picture":"chart",i=this._picCellIdx,c=r.getSheet(s),a=c.shapeMngr,l,v={},y=r._getContent(s).find(".e-ss-activeimg");(r.getObjectLength(this._picCellIdx)||(i=this._picCellIdx=this._getCellIndexFromOffset(t.offsetTop,t.offsetLeft)),f=y.length?y:n("#"+t.id),e=h.sheets[s][i.rowIndex][i.colIndex],e&&e[u])&&(o=a[u][f[0].id],e[u].some(function(n,t){return f[0].id===a[u][e[u][t]].id?(l=t,!0):!1}),v[u]=e[u][l],r.getObjectLength(e)<2&&e[u].length<2?delete h.sheets[s][i.rowIndex][i.colIndex]:e[u].length<2?delete h.sheets[s][i.rowIndex][i.colIndex][u]:h.sheets[s][i.rowIndex][i.colIndex][u].splice(l,1),this._picCellIdx=i=this._getCellIndexFromOffset(t.offsetTop,t.offsetLeft),o.height=f.height(),o.width=f.width(),o.left=c._isFreezed&&r._isFrozen(r.getFrozenColumns())?r.XLFreeze._getFreezeHidenDim()+f[0].offsetLeft:f[0].offsetLeft,o.top=c._isFreezed&&r._isFrozen(r.getFrozenRows())?r.XLFreeze._getFreezeHidenDim(!0)+f[0].offsetTop:f[0].offsetTop,o.rowIndex=i.rowIndex,o.colIndex=i.colIndex,r.XLEdit._updateDataContainer({rowIndex:i.rowIndex,colIndex:i.colIndex},{dataObj:v}))},changePictureBorder:function(i,r,u,f){var e=this.XLObj,v=e.getActiveSheetIndex(),o=n("#"+i)[0],y=o.offsetLeft,p=o.offsetTop,s,w=this._getCellIndexFromOffset(p,y),b=e.getSheet(v).shapeMngr,l,k,a=new RegExp("\\be-shapebdr.*?\\b","g"),h,c;l=b.picture[o.id];s={sheetIndex:v,reqType:"shape",shapeType:"picture",action:"border",id:n(e.getSheetElement(v).find(".e-ss-activeimg")).attr("id"),prevClass:t.isNullOrUndefined(o.className.match(a))?o.className:o.className.match(a)[0],picIdx:k,cellIdx:w};h=r+" "+u+" "+f;c=this._getImgBorderHashCode({"border-color":f,"border-style":u,"border-width":r});e.model.allowCellFormatting&&e.XLFormat._writeCssRules(c,e.XLFormat._getCssPropertyAsString({border:{left:h,right:h,top:h,bottom:h}}));l.bcolor=f;l.bstyle=u;l.bwidth=r;o.className.match(a)&&(o.className=o.className.replace(a,""));n(o).addClass(c);s.curClass=c;s.borderProp=this._getImgStyleFromHashCode(c);e._dupDetails||e._isUndoRedo||(e._completeAction(s),e._trigActionComplete(s))},_getCellIndexFromOffset:function(n,i,r,u){var f,o,s=0,h={},l,c=this.XLObj,e=c.getSheet(c._getSheetIndex(r));if(!t.isNullOrUndefined(n))for(h.rowIndex=c._getMinRowIdx(e),f=0,o=e._rowHeightCollection.length;f<o;f++){if(l=e._rowHeightCollection[f],s=c.isUndefined(l)?s+c.model.rowHeight:l,s>n){h.rowIndex=f-1;break}f==o-1&&o++}if(!t.isNullOrUndefined(i))for(h.colIndex=0,f=0,s=0,o=e.columnsWidthCollection.length;f<o;f++)if(s+=e.columnsWidthCollection[f]===0&&u?e.hideColsCollection[f]:e.columnsWidthCollection[f],s>i){h.colIndex=f;break}return h},_getImgBorderHashCode:function(n){var i=this.XLObj,t="";return"border-width"in n&&(t=parseInt(n["border-width"])+"N"),i.model.allowCellFormatting&&"border-style"in n&&(t=t+i.XLFormat._getStyleCode("BorderStyle",n["border-style"])+"N"),"border-color"in n&&(t=t+n["border-color"].replace("#","")),"e-shapebdr"+t},_getImgStyleFromHashCode:function(n){var i=this.XLObj,t={};return n=n||"",n=n.replace("e-shapebdr","").split("N"),n.length>1&&(t["border-width"]=n[0]+"px",t["border-style"]=["","solid","dashed","dotted"][n[1]],t["border-color"]="#"+n[2]),t},_scrollShape:function(n,t,i,r){var f={position:"none",action:"none"},u=this.XLObj,e=u._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content");parseInt(t.css("width"))+(t.offset().left-u._getContent(n).find(".e-content").offset().left)>u._getContent(n).find(".e-content").width()&&this._imgX<=i?f={position:"horizontal",action:"Increment"}:t.offset().left-e.offset().left<=0?f={position:"horizontal",action:"Decrement"}:parseInt(t.css("height"))+(t.offset().top-u._getContent(n).find(".e-content").offset().top)>u._getContent(n).find(".e-content").height()&&this._imgY<=r?f={position:"vertical",action:"Increment"}:t.offset().top-e.offset().top<=0&&(f={position:"vertical",action:"Decrement"});u.XLSelection._scrollCalculation(n,t.get(0),f)},_onKeyscrollShape:function(n,t,i){var r=this.XLObj,u=r._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content"),f=r._getContent(n).find("#hscrollBar").ejScrollBar("instance"),e=r._getContent(n).find("#vscrollBar").ejScrollBar("instance");u.offset().top+u[0].offsetHeight<=t.offset().top+t[0].offsetHeight&&(i.keyCode===40||i.keyCode===13&&!i.shiftKey)?e.scroll(e.value()+2,!0):t.offset().top-r.model.sheets[n]._frozenHeight<=u.offset().top&&(i.keyCode===38||i.keyCode===13&&i.shiftKey)&&e.value()-2>=0&&e.scroll(e.value()-2,!0);u[0].offsetWidth<=t.offset().left+t[0].offsetWidth&&(i.keyCode===39||i.keyCode===9&&!i.shiftKey)?f.scroll(f.value()+2,!0):t.offset().left-r.model.sheets[n]._frozenWidth<=u.offset().left&&(i.keyCode===37||i.keyCode===9&&i.shiftKey)&&f.value()-2>=0&&f.scroll(f.value()-2,!0)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.chart=function(n){this.XLObj=n;this._shapeCnt=1};t.spreadsheetFeatures.chart.prototype={createChart:function(n,i){var r=this.XLObj;if(r.model.allowCharts&&!r.model.isReadOnly){i=i||{};var o,e,f,c,l,a,u,s,v="chart",y=r._getSheetIndex(i.sheetIdx),h=r.getSheet(y),p;if(r._isUndoRedo&&(p=i.id.split("_"),o=p[p.length-1].replace(/[a-z]/g,"")),i.isChartSeries||(i.isChartSeries=i.series&&n==null),i.isChartSeries||(n=r._getRangeArgs(n,"object")),t.isNullOrUndefined(i.top)||t.isNullOrUndefined(i.left)||(i.activeCell=r.XLShape._getCellIndexFromOffset(i.top,i.left)),i.activeCell||(i.activeCell=h._activeCell),r.isRange(n)&&i.activeCell||i.isChartSeries)return a=r._getCellInfo(i.activeCell),i.id=o?r._id+"_"+v+o:r._id+"_"+v+this._shapeCnt,i.type=i.type?i.type:"column",i.animation=i.animation?i.animation:!1,i.isChartSeries||(i.range=n),i.dataSheetIdx=i.dataSheetIdx?i.dataSheetIdx:y,i.height=i.height?i.height:r.model.chartSettings.height,i.width=i.width?i.width:r.model.chartSettings.width,i.top=i.top?i.top:a.top+2,i.left=i.left?i.left:a.left+2,i.isRowColSwitched=i.isRowColSwitched?i.isRowColSwitched:!1,l=r._getIdxWithOffset(i.top,i.left,!0),i.rowIndex=l.rowIdx,i.colIndex=l.colIdx,i.isResponsive=!1,i.canResize=!1,i.isChartSeries||(r.isUndefined(i.xRange)&&(s=this._processChartRange(n,i.dataSheetIdx),i.xRange=s.xRange,i.yRange=s.yRange,i.lRange=s.lRange),f=this._processChartSeries(i),i.series&&(r.XLClipboard._copyCells.length||r.XLClipboard._cutCells.length)&&(f.series=i.series)),i.isChartSeries&&r.isUndefined(i.series)&&(f=this._processChartSeries(i),i.series=f.series),i.isChartSeries||r.getActiveSheetIndex()===i.dataSheetIdx&&this._focusChartRange(f.xRange,f.yRange,f.lRange),e=this._renderBaseElem(v,i.top,i.left,o),e.ejChart(this._processChartOptions(i,i.isChartSeries?null:f.series)),this._afterChartRefresh(),u=e.ejChart("model"),i.series=u.series,i.theme=u.theme,i.title={text:u.title.text.length?u.title.text:"",align:u.title.textAlignment},i.xAxis={min:u.primaryXAxis.range.min,max:u.primaryXAxis.range.max,interval:u.primaryXAxis.range.interval,title:{text:u.primaryXAxis.title.text.length?u.primaryXAxis.title.text:""},range:i.isChartSeries?null:f.xRange},i.yAxis={min:u.primaryYAxis.range.min,max:u.primaryYAxis.range.max,interval:u.primaryYAxis.range.interval,title:{text:u.primaryYAxis.title.text.length?u.primaryYAxis.title.text:""},range:i.isChartSeries?null:f.yRange},i.legend={visible:u.legend.visible,range:i.isChartSeries?null:f.lRange,position:u.legend.position},h._isImported||(r.XLShape._insertShape=!0),r.XLShape._updateShapeMngr(i.activeCell,{chart:i},"chart"),r.element.append("<input id="+r._id+'_chart type="text" style="display:none;"/>'),i.theme.indexOf("dark")>-1&&e.addClass("e-ss-charttheme"),r.model.showRibbon&&!i.hideTab&&r.XLRibbon._chartDesignTabUpdate(e),r._on(e,t.eventType.mouseDown,r._mouseDownHandler),r._on(e,t.eventType.mouseMove,r._mouseMove),r.setSheetFocus(),r._isSheetNavigate||h._isImported&&!h._isLoaded||r._isUndoRedo||r._isPaste||r.XLClipboard._isShape||(c={sheetIndex:y,reqType:"shape",shapeType:"chart",action:"create",options:i,range:i.range,id:i.id,position:{top:i.top,left:i.left},operation:"create"},r._completeAction(c),r._trigActionComplete(c)),i.id}},resizeChart:function(i,r,u){var o={},s=n("#"+i),h=s.ejChart("model"),e=this.XLObj,f;e.model.isReadOnly||s.length&&(o.height=!t.isNullOrUndefined(r)&&r>180?r.toString():"180",o.width=!t.isNullOrUndefined(u)&&u>180?u.toString():"180",e.model.allowFormulaBar&&(f=e.element.find(".e-formulabar")[0]),f&&(f.style.display="none"),s.ejChart("option",{size:o}),f&&(f.style.display="block"),e.XLRibbon._setShapeWidthHeight({height:h.size.height,width:h.size.width,shapeType:"chart"}))},refreshChart:function(t,i){var f=this.XLObj;if(f.model.allowCharts&&!f.model.isReadOnly){var e,s="marker",r=this._getShapeObj(t,"chart"),o,h=n("#"+t).data("ejChart"),u,c;if(r){for(e in i)r[e]=i[e];i.type&&(i.commonSeriesOptions={type:i.type},delete i.type);s in i&&(i.commonSeriesOptions?i.commonSeriesOptions.marker={visible:i.marker.visible}:i.commonSeriesOptions={marker:i.marker},delete i[s]);i.range&&(h.model.series.length=0,i.range[0].xRange||i.range[0].yRange||i.range[0].lRange?(r.isChartSeries=!0,r.seriesRange=i.range,o=this._processSeriesValues(r)):(h.model.series.length=0,c=f._getRangeArgs(i.range,"object"),u=this._processChartRange(c,r.dataSheetIdx),r.isChartSeries=!1,r.xRange=u.xRange,r.yRange=u.yRange,r.lRange=u.lRange,r.legend.range=u.lRange,o=this._processChartSeries(r),i.xRange=u.xRange,i.yRange=u.yRange,i.lRange=u.lRange,this._focusChartRange(u.xRange,u.yRange,u.lRange)),r.xAxis.range=r.isChartSeries?null:u.xRange,r.yAxis.range=r.isChartSeries?null:u.yRange,i.series=o.series);n("#"+t).ejChart("option",i)}}},_processChartOptions:function(n,t){var r,u,i={commonSeriesOptions:{type:n.type,enableAnimation:n.animation},series:t==null?n.series:t,canResize:n.canResize,size:{height:n.height.toString(),width:n.width.toString()},enableRotation:!1,depth:100,wallSize:2,tilt:0,rotation:34,perspectiveAngle:90,sideBySideSeriesPlacement:!0};return r=u=!1,n.enable3D&&(i.enable3D=!0),n.marker&&(i.commonSeriesOptions.marker=n.marker),n.theme&&(i.theme=n.theme),i.title=n.title||{},this.XLObj.getObjectLength(i.title)>0&&(i.title.textAlignment=n.title.align,delete i.title.align),i.legend=n.legend||{},n.xAxis&&n.xAxis.minorGridLines&&(r=n.xAxis.minorGridLines.visible),n.yAxis&&n.yAxis.minorGridLines&&(u=n.yAxis.minorGridLines.visible),i.primaryYAxis=n.primaryYAxis||{labelFormat:this._chartYAxisFormat(n.yRange),minorTicksPerInterval:5,minorGridLines:{visible:u},minorTickLines:{visible:!1}},i.primaryXAxis=n.primaryXAxis||{labelFormat:this._chartYAxisFormat(n.xRange),minorTicksPerInterval:5,minorGridLines:{visible:r},minorTickLines:{visible:!1},valueType:"category"},i},_chartYAxisFormat:function(n){if(!t.isNullOrUndefined(n)){var u=this.XLObj,i,r=t.globalize.preferredCulture().numberFormat.currency.symbol;return i=u.XLEdit.getPropertyValue(n[0],n[1],"type"),i==="accounting"?r+" {value}":i==="currency"?r+"{value}":i==="percentage"?"{value}%":"{value}"}},_processChartRange:function(n,i){var f=this.XLObj,v,e,c,h,l,a,r=n[0],u=n[1],s=n[2],o=n[3],y=r===s,p=u===o;return h=f.XLEdit.getPropertyValue(r,o,"value2",i),h=f.XLEdit._parseValue(h).value,l=f.XLEdit.getPropertyValue(s,u,"value2",i),l=f.XLEdit._parseValue(l).value,a=f.XLEdit.getPropertyValue(r,u,"value2",i),a=f.XLEdit._parseValue(a).value,!f.isUndefined(a)||y||p?t.isNullOrUndefined(l)||f.isNumber(l)||y||p?(e=[r,u,s,o],t.isNullOrUndefined(h)||f.isNumber(h)||f._isDateTime(h)?t.isNullOrUndefined(a)&&(y||p)&&(c=[r,u,r,o],y?(e[1]=e[1]+1,c[3]=c[1]):e[0]=e[0]+1):(c=[r,u,r,o],e[0]=e[0]+1)):t.isNullOrUndefined(h)||f.isNumber(h)?(v=[r,u,s,u],e=[r,u+1,s,o]):(v=[r+1,u,s,u],e=[r+1,u+1,s,o],c=[r,u+1,r,o]):(v=[r+1,u,s,u],e=[r+1,u+1,s,o],c=[r,u+1,r,o]),{xRange:v,yRange:e,lRange:c}},_processChartSeries:function(n){n=n||{};var t=this.XLObj,v,k,i=n.xRange,r=n.yRange,u=n.lRange,e,d,o,s,y,p,w,f,h,g,c=0,l=0,b=[],a=["value2"];if(n.isChartSeries)b=this._processSeriesValues(n).series;else for(d=t.getRangeData({range:r,valueOnly:!0,sheetIdx:n.dataSheetIdx,skipFormula:!0}),y=r[2]-r[0]+1,p=r[3]-r[1]+1,n.isRowColSwitched?(e=u?t._toArrayData(t.getRangeData({range:u,property:a,sheetIdx:n.dataSheetIdx})):this._getVirtualXValues(p+1),i&&(o=t._toArrayData(t.getRangeData({range:i,property:a,sheetIdx:n.dataSheetIdx}))),s=y):(e=i?t._toArrayData(t.getRangeData({range:i,property:a,sheetIdx:n.dataSheetIdx})):this._getVirtualXValues(y+1),u&&(o=t._toArrayData(t.getRangeData({range:u,property:a,sheetIdx:n.dataSheetIdx}))),s=p),k=e.length,g=n.isRowColSwitched?1:s;c<s;){for(h=0,w=[],l=n.isRowColSwitched?l:c;h<k;)v=d[l],w.push({x:e[h],y:t.isNumber(v)?Number(v):0}),l+=g,h++;f={points:w};n.type==="doughnut"&&(f.explode=n.explode,f.enableAnimation=n.enableAnimation);o&&(f.name=o[c]);b.push(f);c++}return{series:b,xRange:n.isChartSeries?null:n.isRowColSwitched?u:i,yRange:n.isChartSeries?null:r,lRange:n.isChartSeries?null:n.isRowColSwitched?i:u}},_processSeriesValues:function(n){for(var l,f,e,o,a,v,y,p,w,b,k,d,g,rt=this.XLObj,r=n.seriesRange,tt=r.length,it=[],u=[],nt={},s,h,c,i=0;i<tt;i++){if(u[i]={xValues:[],yValues:[],lValues:[]},y=r[i].xRange,t.isNullOrUndefined(y))for(a=t.isNullOrUndefined(r[i].points)?n.series[i].points.length:r[i].points.length,v=t.isNullOrUndefined(r[i].points)?n.series[i].points:r[i].points,o=0;o<a;o++)u[i].xValues[o]=v[o].x;else for(p=this._processRangeValues(y),s=0;s<p.length;s++)u[i].xValues[s]=p[s];if(w=r[i].yRange,t.isNullOrUndefined(w))for(a=t.isNullOrUndefined(r[i].points)?n.series[i].points.length:r[i].points.length,v=t.isNullOrUndefined(r[i].points)?n.series[i].points:r[i].points,e=0;e<a;e++)u[i].yValues[e]=v[e].y;else for(b=this._processRangeValues(w),h=0;h<b.length;h++)u[i].yValues[h]=b[h];if(k=r[i].lRange,t.isNullOrUndefined(k))u[i].lValues[0]=t.isNullOrUndefined(r[i].name)?n.series[i].name:r[i].name;else for(d=this._processRangeValues(k),c=0;c<d.length;c++)u[i].lValues[c]=d[c]}for(m=0;m<tt;){for(f=0,g=[];f<u[m].xValues.length;)g.push({x:u[m].xValues[f],y:rt.isNumber(u[m].yValues[f])?Number(u[m].yValues[f]):0}),f++;for(nt={points:g},l=0;l<u[m].lValues.length;)nt.name=u[m].lValues[l],l++;it.push(nt);m++}return{series:it}},_processRangeValues:function(n){var t=this.XLObj,i,u,f,r;if(n.indexOf(":")>=0)i=t._toArrayData(t.getRangeData({range:n,property:["value"],sheetIdx:n.dataSheetIdx}));else if(n.indexOf(",")>=0)for(u=n.split(","),i=[],r=0;r<u.length;r++)f=t._toArrayData(t.getRangeData({range:u[r],property:["value"],sheetIdx:n.dataSheetIdx}))[0],i.push(f);else i=t._toArrayData(t.getRangeData({range:n,property:["value"],sheetIdx:n.dataSheetIdx}));return i},_getVirtualXValues:function(n){for(var t=1,i=[];t<n;)i.push(t.toString()),t++;return i},_focusChartRange:function(n,t,i){var r=this.XLObj,u=r._chartBorder;this._clearChartRange(r._arrayAsString(u));i&&r.XLSelection._focusBorder({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]},u[0]);n&&r.XLSelection._focusBorder({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]},u[1]);r.XLSelection._focusBorder({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]},u[2]);r.getSheet(r.getActiveSheetIndex())._isChartBorderDrawn=!0},_clearChartRange:function(n){var t=this.XLObj;t.XLSelection._clearBorder(n);t.getSheet(t.getActiveSheetIndex())._isChartBorderDrawn=!1},_renderBaseElem:function(i,r,u,f){f=t.isNullOrUndefined(f)?this._shapeCnt:f;var e=this.XLObj,o=n("<div id='"+e._id+"_"+i+f+"' class='e-ss-object' style='top:"+r+"px;left:"+u+"px; min-height:180px; min-width:180px' ><\/div>");return o.data("parentID",e._id),e._getContent(e.getActiveSheetIndex()).find(".e-content").first().append(o),e.XLShape._selectImg(o),e._isUndoRedo||this._shapeCnt++,o},_refreshChartElements:function(n,t,i){for(var u,f,r,e=this.XLObj,o=1,s=e.model.sheetCount+1;o<s;){if(u=e.getSheet(o).shapeMngr.chart,f=e.getObjectLength(u),f)while(f--)r=u[e.getObjectKeys(u)[f]],r.dataSheetIdx===i&&(this.XLObj.inRange(r.range,n,t)||this.XLObj._inRow(r.range,n)||this.XLObj._inColumn(r.range,t)||this.XLObj.XLChart._isSeriesRange(r,n,t))&&this._refreshChart(r);o++}},_isSeriesRange:function(n,t,i){var r,f,e,o,s,u;if(n.seriesRange)for(u=0;u<n.seriesRange.length;u++)if(r=n.seriesRange[u],r.xRange&&(e=this._isChartSeriesRange(r.xRange,t,i)),r.yRange&&(o=this._isChartSeriesRange(r.yRange,t,i)),r.lRange&&(s=this._isChartSeriesRange(r.lRange,t,i)),f=e||o||s,f)return f;return!1},_isChartSeriesRange:function(n,t,i){var r=this.XLObj,u,e,o,f;if(n.indexOf(":")>=0){if(u=r._getRangeArgs(n),r.inRange(u,t,i))return!0}else if(n.indexOf(",")>=0){for(e=n.split(","),f=0;f<e.length;f++)if(o=r._getRangeArgs(e[f]),r.inRange(o,t,i))return!0}else if(u=r._getRangeArgs(n),r.inRange(u,t,i))return!0;return!1},_refreshChart:function(t){if(n("#"+t.id).length!==0){var r=this.XLObj,i,u=n("#"+t.id).data("ejChart"),e={xRange:t.xRange,yRange:t.yRange,lRange:t.lRange,isRowColSwitched:t.isRowColSwitched,dataSheetIdx:t.dataSheetIdx,seriesRange:t.seriesRange,isChartSeries:t.isChartSeries,series:t.series},f;u.model.series.length=0;f=this._processChartSeries(e);r.model.allowFormulaBar&&(i=r.element.find(".e-formulabar")[0]);i&&(i.style.display="none");u.option({series:f.series,primaryXAxis:{labelFormat:this._chartYAxisFormat(t.xRange)},primaryYAxis:{labelFormat:this._chartYAxisFormat(t.yRange)}});i&&(i.style.display="block")}},switchRowColumn:function(t){var r=this.XLObj;if(!r.model.isReadOnly){var u,e,f=t||document.getElementById(r._id+"_chart").value,o=n("#"+f).ejChart("instance"),i=r.XLChart._getShapeObj(f,"chart"),s={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:"srcolumn",cid:f,rowIndex:r.XLShape._picCellIdx.rowIndex,colIndex:r.XLShape._picCellIdx.colIndex};i.isChartSeries||(o.model.series.length=0,i.isRowColSwitched=!i.isRowColSwitched,e={xRange:i.xRange,yRange:i.yRange,lRange:i.lRange,isRowColSwitched:i.isRowColSwitched,dataSheetIdx:i.dataSheetIdx},u=r.XLChart._processChartSeries(e),o.option({series:u.series}),r.getActiveSheetIndex()===i.dataSheetIdx&&r.XLChart._focusChartRange(u.xRange,u.yRange,u.lRange),i.xAxis.range=u.xRange,i.yAxis.range=u.yRange,i.legend.range=u.lRange,r._completeAction(s),r._trigActionComplete(s))}},updateChartElement:function(i,r,u){var o=this.XLObj;if(!o.model.isReadOnly){o._showDialog(o._id+"_chartname");var a,v=i||document.getElementById(o._id+"_chart").value,l,h,e=n("#"+v).ejChart("instance"),y=o.getActiveSheetIndex(),c,f={sheetIndex:y,reqType:"shape",shapeType:"chart",cid:v,rowIndex:o.XLShape._picCellIdx.rowIndex,colIndex:o.XLShape._picCellIdx.colIndex},s=o.getSheet(y).shapeMngr.chart[o.XLEdit.getPropertyValue(o.XLShape._picCellIdx.rowIndex,o.XLShape._picCellIdx.colIndex,"chart")[0]];u?l={model:{text:o._getLocStr("Ok")}}:u="";o.model.allowFormulaBar&&(a=o.element.find(".e-formulabar")[0]);a&&(a.style.display="none");switch(r){case"PHAxis":f.visibility=!e.model.primaryXAxis.visible;e.option("primaryXAxis",{visible:f.visibility});s.xAxis.visible=f.visibility;f.action=f.operation=r;break;case"PVAxis":f.visibility=!e.model.primaryYAxis.visible;e.option("primaryYAxis",{visible:f.visibility});s.yAxis.visible=f.visibility;f.action=f.operation=r;break;case"PHAxisTitle":o._cOpt.prev={text:s.xAxis.title.text};e.model.primaryXAxis.title.text.length!=0?(e.option("primaryXAxis",{title:{text:""}}),s.xAxis.title.text="",f={sheetIndex:y,reqType:"shape",shapeType:"chart",operation:"PHAxisTitle",action:"PX",cid:v,rowIndex:o.XLShape._picCellIdx.rowIndex,colIndex:o.XLShape._picCellIdx.colIndex,prev:{text:o._cOpt.prev.text},cur:{text:""}},o._completeAction(f),o._trigActionComplete(f)):(o._hasTitle="PX",document.getElementById(o._id+"_chartname").value=s.xAxis.title.text,u.length<1?(n("#"+o._id+"_chartnamedlg").ejDialog("open"),n("#"+o._id+"_chartname").focus().setInputPos(s.xAxis.title.text.length)):o.XLRibbon._chartNameDlgBtnClick(l,u,"PHAxisTitle"),o._cOpt={prevText:s.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"PVAxisTitle":o._cOpt.prev={text:s.yAxis.title.text};e.model.primaryYAxis.title.text.length!=0?(e.option("primaryYAxis",{title:{text:""}}),s.yAxis.title.text="",f={sheetIndex:y,reqType:"shape",shapeType:"chart",operation:"PVAxisTitle",action:"PY",cid:v,rowIndex:o.XLShape._picCellIdx.rowIndex,colIndex:o.XLShape._picCellIdx.colIndex,prev:{text:o._cOpt.prev.text},cur:{text:""}},o._completeAction(f),o._trigActionComplete(f)):(o._hasTitle="PY",document.getElementById(o._id+"_chartname").value=s.yAxis.title.text,u.length<1?(n("#"+o._id+"_chartnamedlg").ejDialog("open"),n("#"+o._id+"_chartname").focus().setInputPos(s.yAxis.title.text.length)):o.XLRibbon._chartNameDlgBtnClick(l,u,"PVAxisTitle"),o._cOpt={prevText:s.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"CTNone":case"CTnone":o._cOpt.prev={text:s.title.text};e.model.title.text.length&&(e.option("title",{text:""}),s.title.text="",f={sheetIndex:y,reqType:"shape",shapeType:"chart",action:"CT",operation:"CTNone",cid:v,rowIndex:o.XLShape._picCellIdx.rowIndex,colIndex:o.XLShape._picCellIdx.colIndex,prev:{text:o._cOpt.prev.text},cur:{text:""}},o._completeAction(f),o._trigActionComplete(f));break;case"CTCenter":case"CTcenter":o._hasTitle="CT";o._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(o._id+"_chartname").value=s.title.text;u.length<1?(n("#"+o._id+"_chartnamedlg").ejDialog("open"),n("#"+o._id+"_chartname").focus().setInputPos(s.title.text.length)):o.XLRibbon._chartNameDlgBtnClick(l,u,"CTCenter");e.option("title",{textAlignment:"center"});o._cOpt.curAlign=e.model.title.textAlignment;s.title.align="center";break;case"CTFar":case"CTfar":o._hasTitle="CT";o._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(o._id+"_chartname").value=s.title.text;u.length<1?(n("#"+o._id+"_chartnamedlg").ejDialog("open"),n("#"+o._id+"_chartname").focus().setInputPos(s.title.text.length)):o.XLRibbon._chartNameDlgBtnClick(l,u,"CTFar");e.option("title",{textAlignment:"far"});o._cOpt.curAlign=e.model.title.textAlignment;s.title.align="far";break;case"CTNear":case"CTnear":o._hasTitle="CT";o._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(o._id+"_chartname").value=s.title.text;u.length<1?(n("#"+o._id+"_chartnamedlg").ejDialog("open"),n("#"+o._id+"_chartname").focus().setInputPos(s.title.text.length)):o.XLRibbon._chartNameDlgBtnClick(l,u,"CTNear");e.option("title",{textAlignment:"near"});o._cOpt.curAlign=e.model.title.textAlignment;s.title.align="near";break;case"DLNone":for(h=[],f.action="DL",f.operation="DLNone",f.prev={series:n.extend(!0,[],e.model.series)},c=0;c<e.model.series.length;c++)h.push({marker:{dataLabel:{visible:!1,verticalTextAlignment:"far",textPosition:"top"}}});e.option({series:h});f.cur={series:n.extend(!0,[],e.model.series)};s.dataLabel={visible:!1};s.series=e.model.series;break;case"DLCenter":for(h=[],f.action="DL",f.operation="DLCenter",f.prev={series:n.extend(!0,[],e.model.series)},c=0;c<e.model.series.length;c++)h.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"center",textPosition:"middle",offset:{y:0}}}});e.option({series:h});f.cur={series:n.extend(!0,[],e.model.series)};s.dataLabel={visible:!0,vAlign:"center",tPosn:"middle"};s.series=e.model.series;break;case"DLIBase":for(h=[],f.action="DL",f.operation="DLIBase",f.prev={series:n.extend(!0,[],e.model.series)},c=0;c<e.model.series.length;c++)h.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"far",textPosition:"bottom",offset:{y:0}}}});e.option({series:h});f.cur={series:n.extend(!0,[],e.model.series)};s.dataLabel={visible:!0,vAlign:"far",tPosn:"bottom"};s.series=e.model.series;break;case"DLIEnd":for(h=[],f.action="DL",f.operation="DLIEnd",f.prev={series:n.extend(!0,[],e.model.series)},c=0;c<e.model.series.length;c++)h.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"near",textPosition:"top",offset:{y:-10}}}});e.option({series:h});f.cur={series:n.extend(!0,[],e.model.series)};s.dataLabel={visible:!0,vAlign:"near",tPosn:"top"};s.series=e.model.series;break;case"DLOEnd":for(h=[],f.action="DL",f.operation="DLOEnd",f.prev={series:n.extend(!0,[],e.model.series)},c=0;c<e.model.series.length;c++)h.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"near",textPosition:"top",offset:{y:0}}}});e.option({series:h});f.cur={series:n.extend(!0,[],e.model.series)};s.dataLabel={visible:!0,vAlign:"near",tPosn:"top"};s.series=e.model.series;break;case"PMajorH":f.visibility=!e.model.primaryYAxis.majorGridLines.visible;e.option("primaryYAxis",{majorGridLines:{visible:f.visibility}});s.yAxis.majorGridLines={visible:f.visibility};f.action=f.operation=r;break;case"PMajorV":f.visibility=!e.model.primaryXAxis.majorGridLines.visible;e.option("primaryXAxis",{majorGridLines:{visible:f.visibility}});s.xAxis.majorGridLines={visible:f.visibility};f.action=f.operation=r;break;case"PMinorH":f.visibility=!e.model.primaryYAxis.minorGridLines.visible;e.option("primaryYAxis",{minorGridLines:{visible:f.visibility},minorTicksPerInterval:5,minorTickLines:{visible:f.visibility}});s.yAxis.minorGridLines={visible:f.visibility};f.action=f.operation=r;break;case"PMinorV":f.visibility=!e.model.primaryXAxis.minorGridLines.visible;e.option("primaryXAxis",{minorGridLines:{visible:f.visibility},minorTicksPerInterval:5,minorTickLines:{visible:f.visibility}});s.xAxis.minorGridLines={visible:f.visibility};f.action=f.operation=r;break;case"LNone":f.visibility=!1;e.option("legend",{visible:f.visibility});s.legend.visible=f.visibility;f.action=r;f.operation="LNone";break;case"LLeft":f.prev={position:e.model.legend.position};e.option("legend",{position:"left",visible:!0});s.legend.position="left";f.cur={position:e.model.legend.position};f.action="Legend";f.operation="LLeft";break;case"LRight":f.prev={position:e.model.legend.position};e.option("legend",{position:"right",visible:!0});s.legend.position="right";f.cur={position:e.model.legend.position};f.action="Legend";f.operation="LRight";break;case"LBottom":f.prev={position:e.model.legend.position};e.option("legend",{position:"bottom",visible:!0});s.legend.position="bottom";f.cur={position:e.model.legend.position};f.action="Legend";f.operation="LBottom";break;case"LTop":f.prev={position:e.model.legend.position};e.option("legend",{position:"top"});s.legend.position="top";f.cur={position:e.model.legend.position};f.action="Legend";f.operation="LTop"}a&&(a.style.display="block");t.isNullOrUndefined(f.action)||(o._completeAction(f),o._trigActionComplete(f))}},changeTheme:function(t,i){var r=this.XLObj,t=t||r.element.find("#"+r._id+"_chart").val(),u;u={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",action:"chartTheme",chartId:t};u.prev={theme:n("#"+t).data("ejChart").model.theme};i&&i.indexOf("dark")>-1?n("#"+t).addClass("e-ss-charttheme"):n("#"+t).removeClass("e-ss-charttheme");r.XLChart.refreshChart(t,{theme:i});u.cur={theme:i};r._completeAction(u);r._trigActionComplete(u)},changeType:function(t,i){var u=this.XLObj,r=n("#"+t).data("ejChart"),f={sheetIndex:u.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:"chartType",chartId:t};f.prev={chartType:r.model.series[0].type,enable3D:r.model.enable3D,marker:r.model.series[0].marker.visible};u.XLChart.refreshChart(t,i);f.cur={chartType:r.model.series[0].type,enable3D:r.model.enable3D,marker:r.model.series[0].marker.visible};n("#"+u._id+"_charttypedlg").ejDialog("close");u._completeAction(f);u._trigActionComplete(f)},_getShapeObj:function(n,t){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()).shapeMngr[t],u=i.getObjectLength(r);if(u)return r[n]},_validateChartRange:function(n,t,i,r){var u=this.XLObj;if(!i)return{msg:u._getLocStr("YAxisMissing")};if(!(u.inRange(n,i[0],i[1])||u.inRange(n,i[2],i[3])))return{msg:u._getLocStr("InvalidYAxis")};if(t)if(u.inRange(n,t[0],t[1])||u.inRange(n,n[2],n[3])){if(t[3]-t[1]!=0)return{msg:u._getLocStr("InvalidXAxisColumns")}}else return{msg:u._getLocStr("InvalidXAxis")};return r&&!(u.inRange(n,r[0],r[1])||u.inRange(n,r[2],r[3]))?{msg:u._getLocStr("InvalidLegend")}:{status:!0}},_renderChartRangeDialog:function(){var t=this.XLObj,i={width:"25%",showRoundedCorner:!0,click:n.proxy(this._chartRangeDlgBtnClick,this)},r=n("<div id='"+t._id+"_chartrangedlg'><div class='e-dlgctndiv e-dlg-fields'><table cellpadding='0' cellspacing='0'><tr class='e-dlgtd-fields'><td>"+t._getLocStr("XAxisRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_crxaxis'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+t._getLocStr("YAxisRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_cryaxis' /><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+t._getLocStr("LegendRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_crlaxis'/><\/td><\/tr><\/table><\/div><div class='e-dlg-btnfields' ><div class='e-dlg-btnctnr'><button id='"+t._id+"_crok' >"+t._getLocStr("Ok")+"<\/button><button id='"+t._id+"_crcancel'>"+t._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>");t.element.append(r);r.ejDialog({width:310,height:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,cssClass:"e-ss-dialog e-"+t._id+"-dlg e-ss-chartrange",title:t._getLocStr("ChartRange")});n("#"+t._id+"_crok").ejButton(i);n("#"+t._id+"_crok").ejButton("option","cssClass","e-ss-okbtn");n("#"+t._id+"_crcancel").ejButton(i)},_chartRangeDlgBtnClick:function(t){var r,u,f,e,i=this.XLObj;t.model.text===i._getLocStr("Ok")&&(r=document.getElementById(i._id+"_chart").value,u=n("#"+i._id+"_crxaxis").val(),f=n("#"+i._id+"_cryaxis").val(),e=n("#"+i._id+"_crlaxis").val(),this.changeDataRange(r,u,f,e));!0&&n("#"+i._id+"_chartrangedlg").ejDialog("close")},changeDataRange:function(t,i,r,u){var l,o,f=this.XLObj,w,s,h,c,v=f._getSheetIndex(f.getActiveSheetIndex()),y=f.getSheet(v),a,p,e;o=this._getShapeObj(t,"chart");i.length&&(s=f.getRangeIndices(i));r.length&&(h=f.getRangeIndices(r));u.length&&(c=f.getRangeIndices(u));p={xRange:i,yRange:r,lRange:u};l=this._validateChartRange(o.range,s,h,c);l.status?(o.xRange=s,o.yRange=h,o.lRange=c,this._refreshChart(o),e=n("#"+t).ejChart("model"),o.xAxis={min:e.primaryXAxis.range.min,max:e.primaryXAxis.range.max,interval:e.primaryXAxis.range.interval,title:{text:e.primaryXAxis.title.text.length?e.primaryXAxis.title.text:""},range:s},o.yAxis={min:e.primaryYAxis.range.min,max:e.primaryYAxis.range.max,interval:e.primaryYAxis.range.interval,title:{text:e.primaryYAxis.title.text.length?e.primaryYAxis.title.text:""},range:h},o.legend={visible:e.legend.visible,range:c},f.getActiveSheetIndex()===o.dataSheetIdx&&this._focusChartRange(s,h,c)):(w=!1,f._showAlertDlg("Alert","T-"+l.msg,"",400));y._isImported&&!y._isLoaded||f._isUndoRedo||f._isExport||(a={sheetIndex:v,reqType:"shape",shapeType:"chart",action:"selectData",id:t,prev:f._selectDataval,cur:p},f._completeAction(a),f._trigActionComplete(a))},_afterChartRefresh:function(){var n=this.XLObj,t,i=n.model.scrollSettings;n.model.allowFormulaBar&&(t=n.element.find(".e-formulabar")[0],t.style.display="none",t.style.display="block")}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.print=function(n){this.XLObj=n;this._printHeight=950;this._pageHeight=970;this._pageWidth=750;this._marginTop=30;this._marginBottom=150;this._printRowLabels=!1;this._isPrintSelection=!1;this._stRow=0;this._stColumn=0;this.shpIndex=[];this.shpObj=[];this.shpPicObj=[]};t.spreadsheetFeatures.print.prototype={_printSetting:function(n){this.XLObj.model.pageSize=n;switch(n){case t.Spreadsheet.pageSize.A4:this._printHeight=950;this._pageHeight=970;this._pageWidth=750;this._marginTop=30;this._marginBottom=150;break;case t.Spreadsheet.pageSize.A3:this._printHeight=1350;this._pageHeight=1330;this._pageWidth=860;this._marginTop=30;this._marginBottom=150;break;case t.Spreadsheet.pageSize.Letter:this._printHeight=1040;this._pageHeight=920;this._pageWidth=860;this._marginTop=30;this._marginBottom=60}},printSelection:function(){var i=this.XLObj;if(i.model.printSettings.allowPrinting&&!i.model.isReadOnly)if(i.model.printSettings.allowPageSize){var l,a,v,u=i.getActiveSheetIndex(),e=i.getSheet(u)._selectedCells,r=e[0],s=e[e.length-1],y=s.colIndex-r.colIndex,h=t.buildTag("table.e-table"),p=t.buildTag("colgroup"),d=i._getContent(u).find("col"),w=t.buildTag("div#printDiv.e-spreadsheet e-js",null,{border:"none"});for(i._refreshTemplates(u,!0,r.colIndex,r.colIndex+y+1),i._isPrint=!0,l=r.colIndex;l<s.colIndex;l++)n(d[l].outerHTML).attr("id","cc").appendTo(p);v=i.getRangeData({range:[r.rowIndex,r.colIndex,s.rowIndex,s.colIndex],property:["value","value2","format","border","type","isFilterHide","isRHide","isFHide","isMHide","merge","hRow","wrap","overflow","align","hyperlink","cFormatRule","rule"],sheetIdx:u,withRowIdx:!0});h.html(i._renderData(v,u,r.colIndex,y+1,!0));p.insertBefore(h.find("tbody"));this._stRow=r.rowIndex;this._stCol=r.colIndex;this._isPrintSelection=!0;i._isPrint=!1;this._printRowLabels?this._calculateTabCount(w,u,h):this._constructSheet(w,u,h,h[0].rows);i._refreshTemplates(u,!0)}else{var f,o,c,b=[],e=i.getSheet(u)._selectedCells,r=e[0],s=e[e.length-1],k=i.element.find(".e-ss-activeimg").clone();if(e.length)this._flatPrint([r.rowIndex,r.colIndex,s.rowIndex,s.colIndex]);else if(k.length){for(o=n("head").find("link").add("style"),f=0,a=o.length;f<a;f++)c=o[f].href||"",(o[f].tagName==="STYLE"&&(o[f].id.indexOf(i._id+"_sshide")>-1||o[f].id.indexOf(i._id+"_sscustomformat")>-1)||c.indexOf("ej.pivotintegration.css")>-1||c.indexOf("ej.widgets.core")>-1||c.indexOf("ej.web.all")>-1||c.indexOf("ej.theme")>-1)&&b.push(o[f]);this.print(t.buildTag("div#printDiv.e-spreadsheet e-js",k.css({top:0,left:0}),{border:"none"}),b)}}},printSheet:function(){var i=this.XLObj;if(i.model.printSettings.allowPrinting&&!i.model.isReadOnly)if(i.model.printSettings.allowPageSize){var e,o,s,h=t.buildTag("div#printDiv"),r=i.getActiveSheetIndex(),u=i.getSheet(r),l=u.columnsWidthCollection,a=i._getContent(r).find("col"),f=t.buildTag("table"),c=t.buildTag("colgroup");for(i._refreshTemplates(r,!0,0,u.usedRange.colIndex+1),i._isPrint=!0,e=0,o=l.length;e<o;e++)n(a[e].outerHTML).attr("id","cc").appendTo(c);s=i.getRangeData({range:[0,0,u.usedRange.rowIndex,u.usedRange.colIndex],property:["value","value2","format","border","type","isFilterHide","isRHide","isFHide","isMHide","merge","hRow","wrap","overflow","align","hyperlink","cFormatRule","rule"],sheetIdx:r,withRowIdx:!0});f.html(i._renderData(s,r,0,u.usedRange.colIndex+1,!0));c.insertBefore(f.find("tbody"));this._printRowLabels?this._calculateTabCount(h,r,f):this._constructSheet(h,r,f,f[0].rows);i._isPrint=!1;i._refreshTemplates(r,!0)}else this._flatPrint()},_flatPrint:function(i){var w,u=this.XLObj,e,r,b=0,o,v=0,k,d,g,nt,tt,y=t.buildTag("div#printDiv.e-spreadsheet e-js",null,{border:"none"}),s=u.getActiveSheetIndex(),f=u.getSheet(s),it=f.columnsWidthCollection,rt=f.usedRange.colIndex,ot=u._getContent(s).find("col"),c=t.buildTag("table.e-table"),ut=t.buildTag("colgroup"),h=n("head").find("link").add("style"),ft=[],l=u.element.find(".e-ss-object, .e-ss-pivot").clone(),a,p="",et=f.hideRowsCollection;for(u._refreshTemplates(s,!0,0,f.usedRange.colIndex+1),u._isPrint=!0,i&&(b=i[1],rt=i[3]),r=b;r<=rt;r++)n(ot[r].outerHTML).attr("id","cc").appendTo(ut),v+=it[r],it[r]===0&&(p+="td.e-rowcell:nth-of-type("+(r+1)+"){display: none}");for(y.width(v),tt=u.getRangeData({range:i?i:[0,0,f.usedRange.rowIndex,f.usedRange.colIndex],property:["value","value2","format","border","type","isFilterHide","isRHide","isFHide","isMHide","merge","hRow","wrap","overflow","align","hyperlink","cFormatRule","rule","isOverflow","isOfBrdr"],sheetIdx:s,withRowIdx:!0}),c.append(ut,u._renderData(tt,s,i?i[1]:0,(i?i[3]-i[1]:f.usedRange.colIndex)+1,!0)),c.width(v),i&&c.find('td[class=""]').remove(),r=0;r<et.length;r++)(!i||u.inRange(i,r,i[1]))&&c.find("tr:eq("+et[r]+")").addClass("e-r-hide");if(i)for(y.css({overflow:"hidden"}),k=f._colWidthCollection[i[1]],nt=f._rowHeightCollection[i[0]],r=0;r<l.length;r++)d=parseInt(l[r].style.top),g=parseInt(l[r].style.left),n(l[r]).css({top:d-nt,left:g-k});for(o=t.buildTag("div.e-content e-ss-cursor",c),o.append(l),o=t.buildTag("div.e-spreadsheetcontentcontainer",o),o=t.buildTag("div.e-spreadsheetmainpanel",o,{width:v,float:"none"}),p+=".e-spreadsheet .e-spreadsheetmainpanel .e-content .e-table tr td:first-child{ border-left-width: 1px; }.e-spreadsheet .e-spreadsheetmainpanel .e-content .e-table tr:first-child td{border-top-width: 1px;}table{page-break-inside: auto !important;}table tr{page-break-inside: avoid !important;}html,body{margin: 0; padding: 0; }",y.append(o,t.buildTag("style",p,{},{type:"text/css"})),e=0,w=h.length;e<w;e++)a=h[e].href||"",(h[e].tagName==="STYLE"&&(h[e].id.indexOf(u._id+"_sshide")>-1||h[e].id.indexOf(u._id+"_sscustomformat")>-1)||a.indexOf("ej.pivotintegration.css")>-1||a.indexOf("ej.widgets.core")>-1||a.indexOf("ej.web.all")>-1||a.indexOf("ej.theme")>-1)&&ft.push(h[e]);this.print(y,ft);u._isPrint=!1;u._refreshTemplates(s,!0)},_calculateTabCount:function(){for(var i=this.XLObj,u=[],t=0,r=i.getSheet(i.getActiveSheetIndex()).columnsWidthCollection,n=0,f=r.length;n<f;n++)t+=r[n],t>=this._pageWidth&&(u.push({tCount:1,cellCount:n}),t=0)},_calculateCellRowCount:function(n,t,i){for(var o=this.XLObj,b=o.getActiveSheetIndex(),s=o.getSheet(b),h=s.columnsWidthCollection,c=s.rowsHeightCollection,f,l=0,a=0,v=12,y=40,p=0,w=0,u,r=t,e=h.length;r<e;r++)if(l+=h[r],l>=this._pageWidth){w=v=r;break}else f=Math.floor((this._pageWidth-l)/s.columnWidth),w=v=h.length+f;for(u=i,e=c.length;u<e;u++)if(a+=c[u],a>=this._pageHeight){p=y=u;break}else f=Math.floor((this._pageHeight-a)/o.model.rowHeight),p=y=c.length+f;return{startCell:t,endCell:w,startRow:i,endRow:p,cellCount:v,rowCount:y}},_constructSheet:function(n,i,r,u){var o=t.buildTag("div .e-spreadsheet","",{}),c=t.buildTag("div .e-spreadsheetmainpanel","",{}),e=0,f=this._calculateCellRowCount(u,0,0),s=u[0].cells.length,h=u.length;e=Math.ceil(s/f.cellCount);e=e*Math.ceil(h/f.rowCount);e==1&&(f.rowCount=u.length);o.append(c);this._constructPrintableElement(i,n,o.find(".e-spreadsheetmainpanel"),r,u,h,s,e,f.cellCount,f.rowCount,f.startRow,f.startCell,f.endRow,f.endCell)},_constructPrintableElement:function(i,r,u,f,e,o,s,h,c,l,a,v,y,p){for(var ut,ct,d,lt,et=!1,ft,k=this.XLObj,g=k.getSheet(i),at=t.buildTag("div"),nt,gt,ot=!1,st,ht=!0,vt=!1,yt=!1,pt=0,tt,w,it,rt,wt,b,ti=k._getContent(i).find("col"),ii=g.columnsWidthCollection,ni=g.rowsHeightCollection,bt,kt,dt=h;dt>0;dt--){for(nt=this._calculateCellRowCount(e,v,a),v=nt.startCell,p=nt.endCell,a=nt.startRow,y=nt.endRow,c=nt.cellCount,l=nt.rowCount,ft=this._constructTable(i,v,p),g.showHeadings&&this._constructHeaders(v,p,y,ft),gt=this._isPrintSelection?a<this._stRow?this._stRow:a:a,w=a;w<y;w++){for(t.isNullOrUndefined(f[0].rows[w])?(ht=!1,d=t.buildTag("tr","",{height:k.model.rowHeight})):(st=ni[w],ht=!0,d=st>0?t.buildTag("tr","",{height:st}):t.buildTag("tr","",{height:k.model.rowHeight})),ht&&(vt=k.XLEdit.getPropertyValue(w,0,"isRHide"),t.isNullOrUndefined(vt)||k.addClass(d[0],"e-r-hide")),it=v;it<p;it++)g.showHeadings&&!et&&(lt='<td class="{0}">{1}<\/td>',n(String.format(lt,"e-rowcell e-header",w+1)).appendTo(d),et=!0),n(e[w]).length>0&&n(e[w].cells[it]).length>0?(rt=n(e[w].cells[it].outerHTML).attr("id","ss"),rt.appendTo(d)):(rt=t.buildTag("td.e-rowcell"),rt.appendTo(d)),yt=k.XLEdit.getPropertyValue(0,it,"isCHide"),t.isNullOrUndefined(yt)||k.addClass(rt[0],"e-col-hide");et=!1;ft.append(d)}if(r.append(ft),y<o)a=y,y=y+l;else if(y>=o){if(p>=s)break;a=0;y=l;v=p;p=p+c}}for(w=r.find("table").length-1;w>=0;--w)tt=n(r.find("table")[w]),ot||this._checkEmptyRow(i,tt,"first"),pt=g.showHeadings?tt.find("tr.empty").length+1:tt.find("tr.empty").length,(tt.find("tr").length!==pt||ot)&&(n(tt.get(0).outerHTML).attr("id","cc").appendTo(at),ot=!0);for(b=at.find("table"),w=b.length-1;w>=0;--w)b.length-1!==w?(k.model.pageSize===t.Spreadsheet.pageSize.A4&&b.eq(w).css({"margin-top":300,"margin-bottom":300}),k.model.pageSize===t.Spreadsheet.pageSize.A3&&b.eq(w).css({"margin-top":120,"margin-bottom":110}),k.model.pageSize===t.Spreadsheet.pageSize.Letter&&(g.showHeadings?b.eq(w).css({"margin-top":70,"margin-bottom":50}):b.eq(w).css({"margin-top":0,"margin-bottom":50}))):b.length-1===w&&b.eq(w).css({"margin-top":30,"margin-bottom":g.showHeadings?20:0}),w||(b.length>1&&b.eq(w).css({"margin-top":120,"margin-bottom":0}),this._checkEmptyRow(i,b.eq(w),"last")),n(b[w].outerHTML).attr("id","cc").appendTo(u);for(ut=n("head").find("link"),ct=[],w=0,wt=ut.length;w<wt;w++)if(kt=ut[w].href||"",ut[w].href.indexOf("ej.pivotintegration.css")>-1||kt.indexOf("ej.theme")>-1){ct.push(ut[w]);break}bt=this._constructChartPicElement(u);u.append(bt);u=u.parent();k._trigger("_pivotPrint",{element:u});this.print(u,ct,i)},_hideShapeElement:function(n){var i,u,e;if(this._isPrintSelection){var r=this.XLObj,o=r.getActiveSheetIndex(),f=r.getSheet(o)._selectedCells,t=r.getSheet(o).shapeMngr,s=r.getObjectLength(t.chart),h=r.getObjectLength(t.picture);if(n.find(".e-ss-object").hide(),s>=1)for(i=0;i<s;i++)for(u=0,e=f.length;u<e;u++)t.chart[r.getObjectKeys(t.chart)[i]].rowIndex==f[u].rowIndex&&t.chart[r.getObjectKeys(t.chart)[i]].colIndex==f[u].colIndex&&n.find("#"+t.chart[r.getObjectKeys(t.chart)[i]].id).show();if(h>=1)for(i=0;i<h;i++)for(u=0,e=f.length;u<e;u++)t.picture[r.getObjectKeys(t.picture)[i]].rowIndex==f[u].rowIndex&&t.picture[r.getObjectKeys(t.picture)[i]].colIndex==f[u].colIndex&&n.find("#"+t.picture[r.getObjectKeys(t.picture)[i]].id).show()}},_constructChartPicElement:function(t){var s=this.XLObj,g=s.getActiveSheetIndex(),u=s.element.find(".e-ss-object").clone(),h=s.getSheet(g).shapeMngr,o=s.getObjectLength(h.chart),w=s.getObjectLength(h.picture),b=t.find("table"),nt=b.length,c,y,p,k,d,f,e,l,a,i,r,v;for(this.shpIndex=[],this.shpObj=[],this.shpPicObj=[],a=0;a<nt;a++)c=b[a],l=n(c).find("tr"),y=parseInt(l.eq(1).find("td").eq(0).text())-1,p=s.XLEdit.getColumnIndexByField(l.eq(0).find("td").eq(1).children().text().trim()),k=y+(l.length-1),d=p+l.eq(0).children().length-1,this.shpIndex.push({pageNumber:a,startColIdx:p,startRowIdx:y,endRowIdx:k,endColIdx:d,top:c.style.marginTop,bottom:c.style.marginBottom,height:c.style.height});if(o>=1)for(i=0;i<o;i++){for(f=h.chart[u[i].id].rowIndex,e=h.chart[u[i].id].colIndex,r=0,v=this.shpIndex.length;r<v;r++)f>=this.shpIndex[r].startRowIdx&&f<this.shpIndex[r].endRowIdx&&e>=this.shpIndex[r].startColIdx&&e<this.shpIndex[r].endColIdx&&(this.shpObj.push({ID:u[i].id,rowIndex:f,colIndex:e,tableNumber:r}),this.shpObj[i].colIndex=this.shpObj[i].colIndex-this.shpIndex[r].startColIdx,this.shpObj[i].rowIndex=this.shpObj[i].rowIndex-this.shpIndex[r].startRowIdx);n(u[i]).addClass(".e-spreadsheet .e-ss-object .e-datavisualization-chart .e-js");n(u[i]).css({border:"1px solid gray",position:"absolute"})}if(w>=1)for(i=0;i<w;i++){for(f=h.picture[u[o+i].id].rowIndex,e=h.picture[u[o+i].id].colIndex,r=0,v=this.shpIndex.length;r<v;r++)f>=this.shpIndex[r].startRowIdx&&f<this.shpIndex[r].endRowIdx&&e>=this.shpIndex[r].startColIdx&&e<this.shpIndex[r].endColIdx&&(this.shpPicObj.push({ID:u[o+i].id,rowIndex:f,colIndex:e,tableNumber:r}),this.shpPicObj[i].colIndex=this.shpPicObj[i].colIndex-this.shpIndex[r].startColIdx,this.shpPicObj[i].rowIndex=this.shpPicObj[i].rowIndex-this.shpIndex[r].startRowIdx);n(u[o+i]).addClass(".e-spreadsheet .e-ss-object");n(u[o+i]).css({position:"absolute","background-size":"100% 100%"})}return u},_calculateTopForShapes:function(n){for(var s,h=this.XLObj,v=h.getActiveSheetIndex(),r=h.getSheet(v),u,f,c,l,a,i=this.shpObj.concat(this.shpPicObj),y=i.length,e,o,t=0;t<y;t++)if(i[t].tableNumber==0)e=r._colWidthCollection[i[t].colIndex],o=r._rowHeightCollection[i[t].rowIndex],n.find("#"+i[t].ID).css({top:o+60,left:e+20+8});else{for(u=0,s=0;s<i[t].tableNumber;s++)f=n.find(".e-table")[s],c=f.getBoundingClientRect(),l=parseInt(f.style.marginBottom),a=parseInt(f.style.marginTop),u=u+(c.height+l+a);e=r._colWidthCollection[i[t].colIndex];o=r._rowHeightCollection[i[t].rowIndex];n.find("#"+i[t].ID).css({top:o+u+30+parseInt(this.shpIndex[i[t].tableNumber].top),left:e+20+18})}},_checkEmptyRow:function(t,i,r){for(var o,e,f=i.find("tr"),s,h,c,u=f.length-1;u>=0;--u)if(o=n(f[u]).find(".e-rowcell").length,e=n(f[u]).find(".e-rowcell:empty").length,e=this.XLObj.getSheet(t).showHeadings?e+1:e,s=n(f[u]).find('td[class *= "e-format"]').length,h=n(f[u]).find('td[class *= "e-border"]').length,c=n(f[u]).find('td[class *= "e-mc-hide"]').length,e===o&&s<1&&h<1&&c<1)n(f[u]).addClass("empty");else{n(f[u]).addClass("nonempty");break}r==="last"&&(i.find("tr.empty").find("td").removeClass("e-rowcell"),i.find("tr.empty").find("td.e-header").text(""))},_constructTable:function(i,r,u){var e=t.buildTag("colgroup"),s=this.XLObj,l=t.buildTag("div","",{height:this._printHeight,"margin-top":this._marginTop,"margin-bottom":this._marginBottom}),h=t.buildTag("table.e-table","",{height:this._printHeight,"margin-top":this._marginTop,"margin-bottom":this._marginBottom}),c=s._getContent(s.getActiveSheetIndex()).find("col"),o,f;for(s.getSheet(i).showHeadings&&(o='<col class="{0}" style= "width: 30px;" >{1}<\/col>',n(o).appendTo(e)),f=r;f<u;f++)n(c[f]).length>0?n(c[f].outerHTML).attr("id","cc").appendTo(e):(o='<col style= "width: 64px;" ><\/col>',n(o).appendTo(e));return h.append(e),l.append(h),h},_constructHeaders:function(i,r,u,f){var o=this.XLObj,w=o.getActiveSheetIndex(),h=t.buildTag("tr","",{height:30}),c,l,s,a,v,y=!1,b=o._getContent(w).find("col"),p="e-rowcell",e;for(this._isPrintSelection&&i<this._stCol&&(r=r+(this._stCol-i),i=this._stCol),c='<td class="{0}">{1}<\/td>',l='<div class = "{0}" > {1}<\/div>',e=i;e<=r;e++)y?(s=o._generateHeaderText(e),p=t.isNullOrUndefined(o.XLEdit.getPropertyValue(0,e-1,"isCHide"))?"e-rowcell e-headercell":"e-rowcell e-col-hide"):(s="",y=!0),a=String.format(l,"e-headercelldiv",s),v=String.format(c,p,a),n(h[0]).append(v);f.append(h)},print:function(i,r,u){var e=this.XLObj,f,o,c,s,h,l;e.model.printSettings.allowPrinting&&!e.model.isReadOnly&&((f=window.open("","print","height="+screen.height+",width="+screen.width+",tabbar=no"),e.isUndefined(f))||(h=t.buildTag("div"),l=i.clone(),h.append(l),f.document.write("<!DOCTYPE html>"),e._browserDetails.name==="msie"?(s="",r.length>0&&n(r).each(function(t,i){n(i).attr("href",i.href);s+=i.tagName=="STYLE"&&i.styleSheet?"<style>"+i.styleSheet.cssText+"<\/style>":i.outerHTML}),f.document.write("<html><head><\/head><body>"+s+h[0].innerHTML+"<\/body><\/html>")):(s="",f.document.write("<html><head>"),r.length>0&&n(r).each(function(t,i){n(i).attr("href",i.href);s+=i.outerHTML}),f.document.writeln(s+"<\/head><body>"),f.document.writeln(h[0].innerHTML+"<\/body><\/html>"),e.model.printSettings.allowPageSize&&(n(f.document.head).append("<style><\/style>"),o=e.model.sheets[u].showGridlines?".e-spreadsheet .e-table{table-layout: fixed; width: 100%;}.e-spreadsheet .e-rowcell {border: 1px solid #000000;line-height: 14px;overflow: hidden;white-space: pre;vertical-align: bottom;}.e-spreadsheet .e-table{border-collapse: collapse}":".e-spreadsheet .e-table{table-layout: fixed; width: 100%;}.e-spreadsheet .e-rowcell {line-height: 14px;overflow: hidden;white-space: pre;vertical-align: bottom;}.e-spreadsheet .e-table{border-collapse: collapse}",o=o.concat(n(document).find("style#"+this.XLObj._id+"_sscustomformat").text()),c=n(f.document.head).find("style"),o=o.concat(".e-spreadsheet .e-fr-hide { display: none !important;}.e-spreadsheet .e-fc-hide { display: none !important;}.e-spreadsheet .e-sswraptext {word-break: break-all; white-space: normal;}.e-spreadsheet .e-headercell{text-align:center;}.e-spreadsheet .e-ralign{text-align:right;}.e-spreadsheet .e-calign{text-align:center;}"),o=o.concat(".e-spreadsheet .e-hyperlinks { text-decoration: underline;}"),c.append(o))),e.model.printSettings.allowPageSize&&n(f.document).find(".e-ss-object").clone().length&&(this._calculateTopForShapes(n(f.document).find(".e-spreadsheetmainpanel")),this._hideShapeElement(n(f.document).find(".e-spreadsheetmainpanel"))),this._isPrintSelection=!1,f.document.close(),f.focus(),setTimeout(function(){(e._browserDetails.name==="msie"?!e.getObjectLength(f)||t.isNullOrUndefined(f.window)||t.isNullOrUndefined(f.location):t.isNullOrUndefined(f.window)||t.isNullOrUndefined(f.location))||f.print();setTimeout(function(){f.close()},2e3)},2e3)))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.scroller=function(n){this.XLObj=n;this._isIntrnlScroll=!1};t.spreadsheetFeatures.scroller.prototype={_getColWidths:function(n,t){var i,f,h=this.XLObj,r=h.getSheet(n),u=r.columnsWidthCollection,e=r._colWidthCollection,o,s=r._ofColWidthColl;for(t||(t=1),i=t,f=u.length;i<f;i++)e[i]=e[i-1]+u[i-1],o=u[i-1]===0?r.hideColsCollection[i-1]:u[i-1],s[i]=s[i-1]+o},_getRowHeights:function(n,t,i){var r,s,e=this.XLObj,o=e.getSheet(n),f=o.rowsHeightCollection,u=o._rowHeightCollection,h=o.hideRowsCollection;for(t||(t=1),r=t,s=f.length;r<s;r++)u[r]=u[r-1]+(h.indexOf(r-1)>-1?0:f[r-1]);u[u.length-1]=u[u.length-2]+(h.indexOf(f.length-1)===-1?f[f.length-2]:0);!i&&e.model.scrollSettings.allowScrolling&&(e.model.scrollSettings.allowVirtualScrolling&&e._refreshVrtlBlocks(n),this._refreshScroller(n,"refresh","vertical"))},_createScroller:function(i,r,u){var f=this.XLObj,e=!0,o=!0,a=f._getContent(i),h=t.buildTag("div#vscrollBar"),c=t.buildTag("div#hscrollBar"),s=f.getSheet(i),l=f.model.scrollSettings.isResponsive?r.width-2:r.width;s._contWidth=l;s._contHeight=r.height;f.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal&&(s._contWidth>f._getEntireColWidth(i)&&(e=!1),s._contHeight>f._getEntireRowHeight(i)&&(o=!1),c[0].style.display=e?"block":"none",h[0].style.display=o?"block":"none");a.append(h).append(c);f._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").width(l-(o?18:0)).height(r.height-(e?18:0));h.ejScrollBar({orientation:"vertical",height:r.height-(e?18:0),minimum:0,viewportsize:r.height,infiniteScrolling:!0,scroll:n.proxy(this._scrollSpreadY,this)});c.ejScrollBar({orientation:"horizontal",width:l-(o?17:0),minimum:0,infiniteScrolling:!0,viewportsize:r.width,scroll:n.proxy(this._scrollSpreadX,this)});u!="initial"&&this._refreshScroller(i,"initial","all")},_hScroller:function(n){return this.XLObj._getContent(this.XLObj._getSheetIndex(n)).find("#hscrollBar").data("ejScrollBar")},_vScroller:function(n){return this.XLObj._getContent(this.XLObj._getSheetIndex(n)).find("#vscrollBar").data("ejScrollBar")},_refreshScroller:function(n,i,r){var c,s,l,h,b,k,a=0,e=this.XLObj,n=e._getSheetIndex(n),o=e.getSheet(n),f=this._hScroller(n),y=o.columnWidth,p=o.rowHeight,u=this._vScroller(n),w=e.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal,d=e._getContent(n),g=d.find(".e-content")[0],v;if(w&&f&&u&&d.find("table").length&&(this._refreshContHgt(n),r=r==="horizontal"?"all":r),f&&(r==="all"||r==="horizontal")){if(c=g.offsetWidth,s=e._getWidth(0,o.colCount-1,n)-o._frozenWidth,s<c+2*y&&!w)for(b=Math.floor((c+y*5-s)/y),v=0;v<b;v++)this._createNewColumn(n,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert"),s=s+y;f._scrollData.handleSpace=c-2*f.model.buttonSize;a=e._isFrozen(e.getFrozenColumns())?e._getColOffsetLeft(o,e.getFrozenColumns())-o._contScrollLeft:0;f._scrollData.handle=Math.floor((c-a)/s*f._scrollData.handleSpace);f._scrollData.handle<15&&(f._scrollData.handle=15);f._scrollData.scrollable=f.model.maximum=s-(c-a);f._scrollData.onePx=f._scrollData.scrollable/(f._scrollData.handleSpace-f._scrollData.handle)||1;f["e-hhandle"].width(f._scrollData.handle);f.model.scrollLeft=f._scrollData.handleSpace-f._scrollData.handle}if(u&&(r==="all"||r==="vertical")){if(l=g.offsetHeight,h=e._getMaxHgt(n,!0,!0)-o._frozenHeight,!w&&h<l+2*p)for(k=Math.floor((l+p*5-h)/p),v=0;v<k;v++)this._createNewRow(n,-1,-1,"insert"),h=h+p;u._scrollData.handleSpace=l-2*u.model.buttonSize;a=e._isFrozen(e.getFrozenRows())?e._getRowOffsetTop(o,e.getFrozenRows())-o._contScrollTop:0;u._scrollData.handle=Math.floor((l-a)/h*u._scrollData.handleSpace);u._scrollData.handle<15&&(u._scrollData.handle=15);u._scrollData.handle>u._scrollData.handleSpace&&e.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal&&(u._scrollData.handle=u._scrollData.handleSpace);u._scrollData.scrollable=u.model.maximum=h-(l-a);u._scrollData.onePx=u._scrollData.scrollable/(u._scrollData.handleSpace-u._scrollData.handle);u["e-vhandle"].height(u._scrollData.handle);u.model.scrollTop=u._scrollData.handleSpace-u._scrollData.handle}},_refreshContHgt:function(n){var t,i,r,u,v,d,g,y,f="px",p="none",s="block",e="width",h="height",o=this.XLObj,w=o.getSheet(n),c=o._getEntireColWidth(n),nt=o._getEntireRowHeight(n),l=o._getContent(n),a=l.find(".e-content"),k=l.find("#hscrollBar")[0].style,b=l.find("#vscrollBar")[0].style;t=a[0].offsetHeight;i=a[0].offsetWidth;r=k.display===p&&w._contWidth<c;u=b.display===p&&w._contHeight<nt;(r||k.display===s&&w._contWidth>c)&&(k.display=r?s:p,t=r?t-18:t+19,r=!0);(u||b.display===s&&w._contHeight>nt)&&(b.display=u?s:p,i=u?i-19:i+19,u=!0);(r||u)&&(d=t-36+f,t+=f,v=l.find("#vscrollBar"),a[0].style[h]=t,o._getJSSheetRowHeaderContent(n)[0].style[h]=t,v[0].style[h]=t,v.find(".e-vscroll")[0].style[h]=t,v.find(".e-vhandlespace")[0].style[h]=d,y=l.find("#hscrollBar"),a[0].style[e]=i+f,b.display===s&&i++,g=i-36+f,i+=f,y[0].style[e]=i,y.find(".e-hscroll")[0].style[e]=i,y.find(".e-hhandlespace")[0].style[e]=g);c+=f;a.find("table")[0].style[e]=c;o._getJSSheetHeader(n).find("table")[0].style[e]=c},_changeTopSpread:function(n,t,i,r){var f=n.value(),u=f+i;t.step=i;(t.enableRTL?u<t.scrollable:u>t.scrollable)&&(u=t.scrollable);(t.enableRTL?u>0:u<0)&&(u=0);n.scroll(u,r)},_spreadMouseWheel:function(i){var r=this.XLObj,e,f=this._vScroller(r.getActiveSheetIndex()),u,o;t.isNullOrUndefined(f)||(r._filterClose(i.target),i.stopImmediatePropagation(),i.preventDefault(),r.element.find(".e-excelfilter.e-dlgcontainer").is(":visible")||r._isSubMenuOpen()||r._isSheetRename)||(r.model.allowComments&&r.XLComment._isCommentEdit&&(e=r.getActiveCell(),t.isNullOrUndefined(e)||r.XLComment._updateCurCmntVal({rowIndex:e.rowIndex,colIndex:e.colIndex})),r.model.allowDataValidation&&n("#"+r._id+"ddl").ejDropDownList("hidePopup"),u=0,o=i,i=i.originalEvent,i.wheelDelta?(u=-i.wheelDelta/120,window.opera&&parseFloat(window.opera.version,10)<10&&(u=-u)):i.detail&&(u=i.detail/3),u)&&(this._changeTopSpread(f,f._scrollData,u*f._scrollData.scrollOneStepBy,"wheel")&&(i.preventDefault?i.preventDefault():o.preventDefault()),n.data(this,"timer",setTimeout(function(){r._trigger("scrollStop",{originalEvent:i,scrollData:f._scrollData,reqType:"vertical",position:f.model.value})},250)))},_scrollSpreadX:function(n){var t=this.XLObj;t._isScrolling=!0;t.getSheet()._isFreezed&&t._isFrozen(t.getFrozenColumns())?(t.XLFreeze._frozenScrollHandler(n),this._getFirstColumn(t.getActiveSheetIndex())):this._spreadHS(n);t._isScrolling=!1},_scrollDirection:function(n,t){var i=this.XLObj,n=i._getContent(i.getActiveSheetIndex()).find("#"+n).ejScrollBar("instance");n.value()<t?n._scrollData.step=1:n.value()>t&&(n._scrollData.step=-1);n.scroll(t)},_spreadHS:function(n){var e,i=this.XLObj,u=i.getActiveSheetIndex(),r=i.getSheet(u),f=this._hScroller(u),o=i._getContent(u),s=o.find(".e-content"),c=o.find("col"),r=i.getSheet(u),h=(n.scrollLeft-r._scrollLeft)/r.columnWidth;if(n.reachedEnd=Math.ceil(parseFloat(f.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(f.element.find(".e-hhandle").width()))>=i.element.find(".e-hhandlespace").width()-2,e=n.scrollLeft,i.model.enableContextMenu&&i.XLCMenu.hideCMenu(),i.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&n.scrollData.step>-1&&!i._scrollReverse)if(n.reachedEnd&&r._leftCol.idx+h<=r.colCount)n.cancel=!0,this._scrollRight(u),e=(f._scrollData.handleSpace-f._scrollData.handle)*f._scrollData.onePx,this._refreshScroller(u,"refresh","horizontal"),f.element.find(".e-hhandle").css("left",f._scrollData.handleSpace-(f._scrollData.handle+1)),f.value(e);else if(r._leftCol.idx+h>r.colCount&&n.scrollLeft>=r._scrollLeft&&n.scrollLeft>0&&r.colCount<i._maxColCnt){while(n.scrollLeft>r._colWidthCollection[r._colWidthCollection.length-1])this._scrollRight(u);this._refreshScroller(u,"refresh","horizontal")}r._scrollLeft=n.scrollLeft=e;i._scrollReverse=!1;s.scrollLeft(n.scrollLeft);r._scrollLeft=s.scrollLeft();f.value(n.scrollLeft);this._getFirstColumn(u);i._refreshViewVar(null,n.scrollLeft,u)},_scrollSpreadY:function(n){var u,f,h,c,e,s=0,i=this.XLObj,r=i.getActiveSheetIndex(),o=i.getSheet(r),l=i.getSheetElement(r).find("#vscrollBar");i._isScrolling=!0;o._isFreezed&&i._isFrozen(i.getFrozenRows())?(i.XLFreeze._frozenScrollHandler(n),this._getFirstRow(i.getActiveSheetIndex())):(c=i.getDigits(o._bottomRow.idx),this.XLObj.model.scrollSettings.allowVirtualScrolling?this._scrollHandler(n):this._spreadVS(n),this.XLObj.model.allowComments&&this.XLObj.XLComment._isCommentEdit&&(e=this.XLObj.getActiveCell(),t.isNullOrUndefined(e)||this.XLObj.XLComment._updateCurCmntVal({rowIndex:e.rowIndex,colIndex:e.colIndex})),u=i.getDigits(o._bottomRow.idx),h=u-c,h&&(u>3&&(s=(u-3)*10),f=i._rowHeaderWidth+s,i._getJSSheetRowHeaderContent(r).find("col").width(f),i._getJSSheetRowHeader(r).width(f),i._getJSSheetHeader(r).find(".e-spreadsheetcolumnheader").width(f-1),i._getJSSheetContent(r).find(".e-spreadsheetcontentcontainer > .e-content").width(o._contWidth-s-(l[0].style.display==="none"?0:18))));i._isScrolling=!1},_scrollHandler:function(n){var k,l,h,o,d,e,a,it,g,nt,rt,v,ot,f,y,c,s,p,tt,ut,ft,r=this.XLObj,u=r.getActiveSheetIndex(),i=r.getSheet(u),ht=r.getActiveCell(u),et=n.scrollTop>=i._scrollTop,ct=this._vScroller(u),st=(n.scrollTop-i._scrollTop)/i.rowHeight+1,w=r._getContent(u).find(".e-content"),b;if(ot=f=y=c=0,s=p=!1,(n.scrollTop===i._scrollTop||i._bottomRow.idx+st>i.rowCount)&&r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite){if(et&&n.scrollTop>0&&i.rowCount<r._maxRowCnt){h=i.rowCount;do{i._virtualBlockCnt++;i.rowCount+=i._virtualBlockRowCnt;for(k in i._columnStyles)for(l=i._virtualBlockRowCnt;l<i.rowCount;)r.XLEdit._updateDataContainer({rowIndex:l,colIndex:parseInt(k)},{dataObj:i._columnStyles[k]}),l++;while(f<i._virtualBlockRowCnt)i.rowsHeightCollection.push(i.rowHeight),i.hideRowsCollection.indexOf(h)===-1&&i._hiddenFreezeRows.indexOf(h)===-1?(i._rowIdxColl.push(h),y=i._rowHeightCollection[i._rowHeightCollection.length-1]+i.rowHeight,i._virtualTBodyHgt+=i.rowHeight):y=i._rowHeightCollection[i._rowHeightCollection.length-1],i._rowHeightCollection.push(y),h++,f++;f=0}while(n.scrollTop+i._virtualBlockRowCnt*i.rowHeight>i._rowHeightCollection[i._rowHeightCollection.length-1]);this._refreshScroller(u,"refresh","vertical");i._scrollTop=n.scrollTop;r._refreshViewport(n.scrollTop,u);w.scrollTop(n.scrollTop);i._scrollTop=w.scrollTop();s=!0}}else tt=["value","value2","comment","hyperlink","format","border","type","isFilterHide","filterState","isMHide","isFHide","merge","isFilterHeader","isFilterVisible","text","general","cFormatRule","wrap","wrapRow","rule","align","isOverflow","isOfBrdr","altTxt"],d=r._getRowHdrTBody(u),o=r._getContTBody(u),et?(n.scrollTop>=i._virtualContTBodyOffset.bottom&&n.scrollTop<=i._virtualBottomTBodyOffset.bottom?(c=i._virtualTopTBodyOffset.bottom-i._virtualTopTBodyOffset.top,i._virtualTopTBodyOffset.top=i._virtualContTBodyOffset.top,i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.bottom,i._virtualContTBodyOffset.top=i._virtualBottomTBodyOffset.top,i._virtualContTBodyOffset.bottom=i._virtualBottomTBodyOffset.bottom,i._virtualContBlockIdx++,i._virtualContBlockIdx===i._virtualBlockCnt?(i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom=0,i._isVirtualEndReached=!0):(i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom,it=r._getRowIdx(i._virtualContBlockIdx*i._virtualBlockRowCnt,u,!0),g=r._getRowIdx(i._virtualContBlockIdx*i._virtualBlockRowCnt+(i._virtualBlockRowCnt-1),u,!0),i._virtualBottomTBodyOffset.bottom=r._getRowOffsetBottom(g,u),v=i._rowIdxColl.slice(i._rowIdxColl.indexOf(it),i._rowIdxColl.indexOf(g)+1),e=r.getRangeData({property:tt,sheetIdx:u,rowIdxs:v,withRowIdx:!0}),d.append(r._renderRowHdr(e.rowIdx,u)),o.append(r._renderData(e,u)),i._virtualRowIdx=i._virtualRowIdx.concat(e.rowIdx),s=!0),i._isVirtualTopReached||(r._removeRange(0,i._virtualBlockRowCnt),i._virtualRowIdx.splice(0,i._virtualBlockRowCnt),i._virtualTopTBodyHgt+=c),b=r._browserDetails.name==="msie"?o[0].getBoundingClientRect().height:window.getComputedStyle(o[0],null).height,i._virtualBottomTBodyHgt=i._virtualTBodyHgt-(i._virtualTopTBodyHgt+Math.floor(parseFloat(b))),r._refreshTBodiesHgt(),i._isVirtualTopReached=!1):!i._isVirtualEndReached&&n.scrollTop>=i._virtualBottomTBodyOffset.bottom&&(r._refreshViewport(n.scrollTop,u),s=p=!0),r.model.allowCellType&&r.XLCellType._rangeCellTypes(i.cellTypes,u)):n.scrollTop+n.model.viewportsize<i._virtualContTBodyOffset.top&&n.scrollTop+n.model.viewportsize>=i._virtualTopTBodyOffset.top?(c=i._virtualBottomTBodyOffset.bottom-i._virtualBottomTBodyOffset.top,i._virtualBottomTBodyOffset.top=i._virtualContTBodyOffset.top,i._virtualBottomTBodyOffset.bottom=i._virtualContTBodyOffset.bottom,i._virtualContTBodyOffset.top=i._virtualTopTBodyOffset.top,i._virtualContTBodyOffset.bottom=i._virtualTopTBodyOffset.bottom,i._virtualContBlockIdx--,i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.top,i._virtualContBlockIdx===1?(i._virtualTopTBodyOffset.top=0,i._isVirtualTopReached=!0):(nt=r._getRowIdx((i._virtualContBlockIdx-2)*i._virtualBlockRowCnt,u,!0),rt=r._getRowIdx((i._virtualContBlockIdx-2)*i._virtualBlockRowCnt+(i._virtualBlockRowCnt-1),u,!0),i._virtualTopTBodyOffset.top=r._getRowOffsetTop(i,nt),v=i._rowIdxColl.slice(i._rowIdxColl.indexOf(nt),i._rowIdxColl.indexOf(rt)+1),e=r.getRangeData({property:tt,sheetIdx:u,rowIdxs:v,withRowIdx:!0}),d.prepend(r._renderRowHdr(e.rowIdx,u)),o.prepend(r._renderData(e,u)),i._virtualRowIdx=e.rowIdx.concat(i._virtualRowIdx),s=!0),i._isVirtualEndReached||(r._removeRange(i._virtualContBlockIdx===1?2*i._virtualBlockRowCnt:3*i._virtualBlockRowCnt,i._virtualBlockRowCnt),i._virtualRowIdx.splice(i._virtualContBlockIdx===1?2*i._virtualBlockRowCnt:3*i._virtualBlockRowCnt,i._virtualBlockRowCnt),i._virtualBottomTBodyHgt+=c),b=r._browserDetails.name==="msie"?o[0].getBoundingClientRect().height:window.getComputedStyle(o[0],null).height,i._virtualTopTBodyHgt=i._virtualTBodyHgt-(i._virtualBottomTBodyHgt+Math.floor(parseFloat(b))),r._refreshTBodiesHgt(),i._isVirtualEndReached=!1,r.model.allowCellType&&r.XLCellType._rangeCellTypes(i.cellTypes,u)):!i._isVirtualTopReached&&n.scrollTop+n.model.viewportsize<=i._virtualTopTBodyOffset.top&&(r._refreshViewport(n.scrollTop,u),s=p=!0),p||r._refreshViewVar(n.scrollTop,null,u),i._scrollTop=n.scrollTop;if(w.scrollTop(n.scrollTop),i._scrollTop=w.scrollTop(),this._getFirstRow(u),r.model.allowSelection&&(i._isRowSelected||i._isColSelected||i._isSheetSelected)&&(r.XLSelection.refreshSelection(),r.XLDragFill.positionAutoFillElement()),s){for(r.XLComment&&r.XLComment._updateCmntArrowPos(r._getContent(u).find(".e-commentcell")),a=r.getObjectKeys(r._dataContainer.sheets[u][0]),r._dupDetails=!0,f=0,ut=a.length;f<ut;f++)ft=r.XLEdit.getPropertyValue(0,a[f],"isFitWidth"),t.isNullOrUndefined(ft)||r.XLResize._fitWidth(a[f]);r._dupDetails=!1}},_spreadVS:function(n){var e,r=this.XLObj,f=r.getActiveSheetIndex(),u=r.getSheet(f),i=this._vScroller(f),h=r._getJSSheetContent(f).find(".e-spreadsheetcontentcontainer > .e-content"),c=(n.scrollTop-u._scrollTop)/u.rowHeight;if(n.reachedEnd=Math.ceil(parseFloat(i.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(i.element.find(".e-vhandle").height()))>=i.element.find(".e-vhandlespace").height()-2,e=n.scrollTop,r.model.enableContextMenu&&r.XLCMenu.hideCMenu(),r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&n.scrollData.step>-1&&!r._scrollReverse)if(n.reachedEnd&&u._bottomRow.idx+c<=u.rowCount){var l=!1,a=!1,s=this,o;!r.isUndefined(n.scrollData.target)&&r._hasClass(n.scrollData.target,"e-vdown")&&(o=setInterval(function(){l=!0;for(var n=0;n<20;n++)s._scrollBottom(f);e=(i._scrollData.handleSpace-i._scrollData.handle)*i._scrollData.onePx;s._refreshScroller(f,"refresh","vertical");i.element.find(".e-vhandle").css("top",i._scrollData.handleSpace-i._scrollData.handle);i.scroll(e);clearInterval(o);return},1e3),r._browserDetails.name==="msie"&&r._browserDetails.version==="8.0"?(i.element.find(".e-vdown")[0].attachEvent("onmouseup",function(){clearInterval(o);return}),document.attachEvent("onmouseup",function(){clearInterval(o);return})):(i.element.find(".e-vdown")[0].addEventListener("mouseup",function(){clearInterval(o);return}),document.addEventListener("mouseup",function(){clearInterval(o);return})),a=!0);n.cancel=!0;l&&a||(this._scrollBottom(f,(n.scrollTop-u._scrollTop)/20+1),e=(i._scrollData.handleSpace-i._scrollData.handle)*i._scrollData.onePx,s._refreshScroller(f,"refresh","vertical"),i.element.find(".e-vhandle").css("top",i._scrollData.handleSpace-i._scrollData.handle),i.value(e))}else u._bottomRow.idx+c>u.rowCount-1&&n.scrollTop>=u._scrollTop&&n.scrollTop>0&&u.rowCount<r._maxRowCnt&&(this._scrollBottom(f,(n.scrollTop-u._scrollTop)/20+1),this._refreshScroller(f,"refresh","vertical"));n.scrollTop=u._scrollTop=e;r._scrollReverse=!1;h.scrollTop(n.scrollTop);u._scrollTop=h.scrollTop();this._getFirstRow(f)},_scrollX:function(i){var e,h,u=this.XLObj,r=this._hScroller(i),o,s=[1],c=u._getContent(i).find("colgroup"),f=u.getSheet(i);for(u.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&this._scrollRight(i),r.model.maximum=r.model.maximum+f.columnWidth,r._scrollData.scrollable=r._scrollData.scrollable+f.columnWidth,this._refreshScroller(i,"refresh","horizontal"),r.element.find(".e-hhandle").css("left",r._scrollData.handleSpace-(r._scrollData.handle+1)),o=(r._scrollData.handleSpace-r._scrollData.handle)*r._scrollData.onePx,r.value(o),e=0,h=u.model.sheets[i]._fCol;e<h;e++)s.push(s[s.length-1]+n(c.find("col")[e]).width());f._isFreezed&&u._isFrozen(u.getFrozenColumns())?r.scroll(r.value()+u._getColWidth(f._fleftColIdx,i),!0):u._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").scrollLeft(o,r._scrollData.onePx);f._scrollLeft=o;this._getFirstColumn(i)},_scrollY:function(i){var f,u=this.XLObj,r=this._vScroller(i),e,o=[1],s=u.getRows(i)[1];for(u.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&this._scrollBottom(i),r.model.maximum=r.model.maximum+u.model.rowHeight,r._scrollData.scrollable=r._scrollData.scrollable+u.model.rowHeight,this._refreshScroller(i,"refresh","vertical"),r.element.find(".e-vhandle").css("top",r._scrollData.handleSpace-(r._scrollData.handle+1)),e=(r._scrollData.handleSpace-r._scrollData.handle)*r._scrollData.onePx,r.value(e),f=0,len=u.model.sheets[i]._fRow;f<len;f++)o.push(o[o.length-1]+n(s[f]).height());u._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").scrollTop(e,r._scrollData.onePx);this._getFirstRow(i)},_getFirstRow:function(n){var i=this.XLObj,t=i.getSheet(n),r,u,f,e=t._rowHeightCollection;r=i._getContent(n).find(".e-content").scrollTop();u=i._getIdxWithOffset(r,null,!0,null,n).rowIdx;t._topRow={idx:u,value:e[u]};f=i._getIdxWithOffset(r+t._vPortHgt,null,!0,null,n).rowIdx||t.rowCount-1;t._bottomRow={idx:f,value:e[f]};t.topLeftCell=i.getAlphaRange(t._topRow.idx,t._leftCol.idx)},_getFirstColumn:function(n){var i=this.XLObj,t=i.getSheet(n),r,u,f,e=t._colWidthCollection;r=i._getContent(n).find(".e-content").scrollLeft();u=i._getIdxWithOffset(null,r,!0,null,n).colIdx;t._leftCol={idx:u,value:e[u]};f=i._getIdxWithOffset(null,r+t._vPortWth,!0,null,n).colIdx||t.colCount-1;t._rightCol={idx:f,value:e[f]};t.topLeftCell=i.getAlphaRange(t._topRow.idx,t._leftCol.idx)},scrollToCell:function(n){var u,f,o=0,s=0,i=this.XLObj,r=i.getRangeIndices(n),e=i.getActiveSheetIndex(),t=i.getSheet(e);u=r[0]>t.rowCount?i._getRowOffsetBottom(t.rowCount-1,e)+(r[0]-t.rowCount)*t.rowHeight:i._getRowOffsetBottom(r[0]-1,e);f=r[1]>t.colCount?i._getWidth(0,t.colCount-1)+(r[1]-t.colCount)*t.columnWidth:i._getWidth(0,r[1]-1);i._isFrozen(t.frozenRows)&&(o=i._getRowOffsetTop(t,t._frozenRows-1));i._isFrozen(t.frozenColumns)&&(s=i._getColOffsetLeft(t,t._frozenColumns-1));i._scrollContent({x:(f?f:0)-t._scrollLeft-s,y:(u?u:0)-t._scrollTop-o})},_scrollSelectedPosition:function(n,t){if(!this.XLObj._isExport){var s,h,c=0,u=this.XLObj,r=this._hScroller(n),f=this._vScroller(n),i=u._getCellInfo(t),o=u.getSheet(n),e=u._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content"),l=u._dupDetails,a=Math.ceil(parseFloat(f.element.find(".e-vhandle").css("top")))+f._scrollData.handle>=f._scrollData.handleSpace,v=Math.ceil(parseFloat(r.element.find(".e-hhandle").css("left")))+r._scrollData.handle>=r._scrollData.handleSpace;u.isUndefined(r)||parseInt(i.width)+(i.left-e.offset().left)>e.width()&&(s=i.left-(r._scrollData.handleSpace+r.model.buttonSize),s<0?r.scroll(0):(v&&(u._scrollReverse=!0),(parseInt(i.width)+i.left>r._scrollData.handleSpace+r.model.buttonSize*2||i.left-e.offset().left<=0)&&s!=0&&r.scroll(i.left+i.width+1-(r._scrollData.handleSpace+r.model.buttonSize*2)),u._scrollReverse=!1));u.isUndefined(f)||(parseInt(i.height)+(i.top-e.offset().top)>e.height()||i.top-e.offset().top<=0)&&(t.rowIndex<o._topRow.idx||t.rowIndex>o._bottomRow.idx)&&(!t.rowIndex<o._bottomRow.idx&&t.rowIndex<o.rowCount-1&&(c=i.height),h=i.top+c-(f._scrollData.handleSpace+f.model.buttonSize),h<0?f.scroll(0):(a&&(u._scrollReverse=!0),f.scroll(i.top+i.height+1-(f._scrollData.handleSpace+f.model.buttonSize*2)),u._scrollReverse=!1));u._dupDetails=l}},_rowTemplate:function(n,t){for(var i,e="",u=this.XLObj,o=u.getSheet(n),r=0,f=u.model.sheets[n].colCount;r<f;r++)i="e-rowcell",o.showGridlines||(i=i.concat(" e-hborder")),o._hiddenFreezeCols.indexOf(r)>-1&&(i+=" e-fcol-hide"),e+=String.format('<td class="{0}" style="{2}"  >{1}<\/td>',i,"");return String.format("<tr style='{0}' idx=\"{1}\">"+e+"<\/tr>","height:"+u.model.rowHeight+"px;",t-1)},_rowHeaderTemplate:function(n,t){var i,t=t?t:this.XLObj.model.rowHeight;return i=String.format('<td class="{0}"  >{1}<\/td>',"e-rowheader",n),String.format("<tr style='{0}' idx=\"{1}\">"+i+"<\/tr>","height:"+t+"px;",n-1)},_columnTemplate:function(){var n="e-rowcell e-wrapword",t=this.XLObj,i=t.getActiveSheetIndex();return t.getSheet(i).showGridlines||(n=n.concat(" e-hborder")),String.format('<td class="{0}" style="{2}" >{1}<\/td>',n,"")},_colGroupTemplate:function(n,t){var t=t?t:this.XLObj.getSheet(n).columnWidth;return String.format("<col style = '{0}'><\/col>","width:"+t+"px;")},_columnHeaderTemplate:function(n){var t,i;return t=this.XLObj._generateHeaderText(n),i=String.format('<div class = "{0}" > {1}<\/div>',"e-headercelldiv",t),String.format('<th class="{0}"  >{1}<\/th>',"e-headercell",i)},_createNewRow:function(t,i,r,u){var s,h,l,e,a,f=this.XLObj,y=f.model.scrollSettings.allowVirtualScrolling,p=f.XLSelection,o=f.getSheet(t),w,c,v;if(y?(s=f._getContent(t).find("tbody")[1],e=f._getJSSheetRowHeaderContent(t).find("tbody")[1]):(s=f._getContent(t).find("tbody")[0],e=f._getJSSheetRowHeaderContent(t).find("tbody")[0]),l=this._rowTemplate(t,parseInt(e.lastChild.textContent)+1),i===-1||r>-1&&i>-1&&u==="shift"?(n(e).append(this._rowHeaderTemplate(parseInt(e.lastChild.textContent)+1)),n(s).append(l),u=="shift"&&(n(s).find("tr:last td:last").remove(),w=f._getRowIdx(i),n(s).find("tr: eq(' + rowElemIdx + ') td:eq(' + (colIdx - 1) + ')").after(this._columnTemplate()))):(h=s.insertRow(i),n(h).height(f.model.rowHeight),n(h).append(n(l)[0].innerHTML),h=e.insertRow(i),n(h).height(f.model.rowHeight),n(h).append("<td class='e-rowheader'><\/td>")),o.rowCount=f.model.sheets[t].rowCount+1,o.rowsHeightCollection.push(f.model.rowHeight),i>-1){for(a=n(e).find("td"),c=0,v=a.length;c<v;c++)n(a[c]).text(c+1);f.XLScroll._getRowHeights(t,i+1)}o._rowHeightCollection.push(o._rowHeightCollection[o._rowHeightCollection.length-1]+f.model.rowHeight);f.model.allowSelection&&(o._isColSelected||o._isSheetSelected)&&p.refreshSelection();f._refreshRows(t)},_createNewColumn:function(i,r,u,f){var e,s,l,o=this.XLObj,h=o.getSheet(i),st=o.XLSelection,c,d,nt,tt,ft,v,a,p,it,et,ot,rt,w=!1,b,y,ht=h.columnsWidthCollection,ct=o.model.scrollSettings.allowVirtualScrolling,ut,k,g;for(c=o._getContTBody(i)[0],d=o._getJSSheetHeader(i).find("tr")[0],nt=o._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer colgroup"),tt=o._getJSSheetHeader(i).find("colgroup"),ft=h.colCount,y=h.filterSettings.tableRange,e=0,l=y.length;e<l;e++)if(rt=y[e].multifilterIdx,r.colIndex>rt[0]&&u.colIndex<rt[rt.length-1]){w=!0;b=y[e].startRow-1;y=y[e];break}if(r.colIndex===-1||r.colIndex>-1&&r.rowIndex>-1&&f==="shift"){if(r.colIndex===-1&&f==="insert"){for(p=this._columnHeaderTemplate(ft+1,i),n(d).append(p),v=this._colGroupTemplate(i),tt.append(v),e=0,l=c.rows.length;e<l;e++)a=this._columnTemplate(e),n(c.rows[o._getRowIdx(e,i,!1,!0)]).append(a);nt.append(v)}if(f==="shift"){for(ut=ft,e=r.colIndex;e<=u.colIndex;e++)p=this._columnHeaderTemplate(ut+1,i),n(d).append(p),v=this._colGroupTemplate(i),tt.append(v),nt.append(v),ut=ut+1;for(e=0,l=c.rows.length;e<l;e++)for(s=r.colIndex;s<=u.colIndex;s++)a=this._columnTemplate(e),n(c.rows[o._getRowIdx(e)]).append(a);if(o._insDelStatus.indexOf("insert")>-1)for(e=r.rowIndex;e<=u.rowIndex;e++)for(s=r.colIndex;s<=u.colIndex;s++)n(c).find("tr:eq("+o._getRowIdx(e)+") td:last").remove(),a=this._columnTemplate(e),n(c).find("tr").eq(o._getRowIdx(e)).find("td:eq("+s+")").before(a),w&&e===b&&o.model.allowFiltering&&o.XLFilter._insertFilterIcon(e,s,y,b,w);else for(e=r.rowIndex;e<=u.rowIndex;e++)for(s=u.colIndex;s>=r.colIndex;s--)n(c).find("tr:eq("+o._getRowIdx(e)+") td:eq("+s+")").remove(),a=this._columnTemplate(e),n(c).find("tr:eq("+o._getRowIdx(e)+")").append(a),w&&e===b&&o.model.allowFiltering&&o.XLFilter._insertFilterIcon(e,s,y,b,w)}h.colCount=h.colCount+1;h.columnsWidthCollection.push(h.columnWidth)}else{if(h._isTemplate&&(r.colIndex<h._templateColCount||u.colIndex<h._templateColCount))return;if(g=n.extend(!0,[],o.getSheet(i).columnsWidthCollection),o._insDelStatus.indexOf("insert")>-1){for(k=g.splice(0,r.colIndex),e=r.colIndex;e<=u.colIndex;e++)p=this._columnHeaderTemplate(e+1,i),n(d).find("th:eq("+e+")").before(p),v=this._colGroupTemplate(i),k.push(h.columnWidth),tt.find("col:eq("+e+")").before(v),nt.find("col:eq("+e+")").before(v),h.colCount=h.colCount+1;for(t.merge(k,g),h.columnsWidthCollection=k,e=0,l=c.rows.length;e<l;e++)for(s=r.colIndex;s<=u.colIndex;s++)a=this._columnTemplate(e),n(c.rows[o._getRowIdx(e)]).find("td:eq("+s+")").before(a),w&&e===b&&o.model.allowFiltering&&o.XLFilter._insertFilterIcon(e,s,y,b,w)}else{for(k=g.splice(0,r.colIndex),e=u.colIndex;e>=r.colIndex;e--)n(d).find("th:eq("+e+")").remove(),tt.find("col:eq("+e+")").remove(),nt.find("col:eq("+e+")").remove(),h.colCount=h.colCount-1;for(g.splice(0,u.colIndex-r.colIndex+1),t.merge(k,g),h.columnsWidthCollection=k,e=0,l=c.rows.length;e<l;e++)for(s=u.colIndex;s>=r.colIndex;s--)n(c.rows[o._getRowIdx(e)]).find("td:eq("+s+")").remove()}for(et=n(d).find("th>.e-headercelldiv"),e=0,l=et.length;e<l;e++)n(et[e]).text(o._generateHeaderText(e+1))}ot=n.trim(n(p).text());it=n(a).text();h.columns.push({field:ot,type:it!=null?it.getDay?"date":typeof it:null,width:n(a).width()});o.XLScroll._getColWidths(i,r.colIndex>-1?r.colIndex:h.colCount-2);o.model.allowSelection&&(h._isRowSelected||h._isSheetSelected)&&st.refreshSelection();o._refreshTemplates(i,!0)},_insertColHeaders:function(t,i,r){var f=this._columnHeaderTemplate(i+1,t),u;n(r).append(f);u=this._colGroupTemplate(t);n(r.parentNode.previousSibling).append(u)},_scrollBottom:function(n,t){var i=this.XLObj.getSheet(n),r,u;if(t)this._createRows(i.rowCount-1,i.rowCount+t,n);else{this._createNewRow(n,-1,-1,"insert");for(r in i._columnStyles)u=parseInt(r),this.XLObj.XLEdit._updateDataContainer({rowIndex:i.rowCount-1,colIndex:u},{dataObj:i._columnStyles[r]})}},_createRows:function(n,t,i){for(var r=this.XLObj,i=i||r.getActiveSheetIndex(),e=r.getSheet(i),o=r.getSheetElement(i),u=n,f=t;u<f;u++)this._createNewRow(i,-1,-1,"insert")},_scrollRight:function(n){var r={rowIndex:-1,colIndex:-1},t,u,i;this._createNewColumn(n,r,r,"insert");t=this.XLObj.getSheet(n);for(i in t._rowStyles)u=parseInt(i),this.XLObj.XLEdit._updateDataContainer({rowIndex:u,colIndex:t.colCount-1},{dataObj:t._rowStyles[i]})},_refreshRowCol:function(n,t){t=this.XLObj._getSheetIndex(t);var i,r=this.XLObj.getSheet(t),u=!1;if(r.colCount<n[3]+1){for(i=n[3]-(r.colCount-1);i--;)this._scrollRight(t);u=!0}if(r.rowCount<n[2]+1){for(i=n[2]-(r.rowCount-1);i--;)this._scrollBottom(t);u=!0}u&&this._refreshScroller(t,"refresh","all")}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.pivot=function(n){this.XLObj=n;this._pivotCnt=1;this._hasPvtField=!1;this._displayActPanel=!0;this.names={}};t.spreadsheetFeatures.pivot.prototype={createPivotTable:function(t,i,r,u,f){var e=this.XLObj,h,l,a=new RegExp("[^a-z0-9\\s]","gi");if(r&&(r.indexOf(" ")>-1||r.match(a))&&(l=r,r=r.replace(a,"").replace(/ /g,"_")),e.model.enablePivotTable&&!e.model.isReadOnly){var v=e.XLRibbon,c=e.getActiveSheetIndex(),s=[],y,p,w,o,b=0,k=0,d;if(e._showDialog(e._id+"_Ribbon_Insert_Tables_PivotTable"),o=v._getAddrFromDollarAddr(t),y=e.model.sheets[o[0]].sheetInfo.text,t=e.getRangeIndices(o[1]),p=e.getRangeDataAsJSON({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]},!1,o[0]),n("#"+e._id+"_dlg_existsheet").data("ejRadioButton").model.checked||e.isImport||!e.getSheet(c)._isLoaded?(o=v._getAddrFromDollarAddr(i),s=e.getRangeIndices(o[1]),e._isExport||c===o[0]||(e.gotoPage(o[0],!1),c=o[0])):(e.insertSheet(),c=e.getActiveSheetIndex(),s=[2,0]),e.isUndefined(f)&&(f={}),k=e.model.sheets[o[0]]._rowHeightCollection[s[0]],b=e.model.sheets[o[0]]._colWidthCollection[s[1]],e.hideActivationPanel(),r&&r.length){if(e.getObjectKeys(this.names).indexOf(r)>-1)do r=r+this._pivotCnt,this._pivotCnt++;while(e.getObjectKeys(this.names).indexOf(r)>-1)}else do r="PivotTable"+this._pivotCnt,this._pivotCnt++;while(e.getObjectKeys(this.names).indexOf(r)>-1);return h=e._id+"_"+r,this.names[h]=l?l:r,f.pvtRange=s,f.sheetIdx=c,f.temp=o[0],f.datasource=p,e.getSheet(c)._isUpdated||this._updatePivotMngr({},{pivot:{id:h,top:k,left:b,rowIndex:s[0],colIndex:s[1],dataRange:t,dataSheetName:y,sheetIdx:c,tableName:this.names[h]}}),this._refreshPivotElement(t,i,r,u,f),d=e.element.find("#"+h).data("ejPivotGrid"),this._refreshRowColumn(s,d),e.showActivationPanel(),w={sheetIndex:f.sheetIdx,reqType:"shape",shapeType:"pivot",range:f.pvtRange,ID:h,dataSource:f.datasource},e._trigActionComplete(w),h}},_refreshRowColumn:function(n,t){var f,r=this.XLObj,s=r.getActiveSheetIndex(),h=r.getSheet(s),e=[],u,t,i,o;for(u=t._rowCount,o=t.calculateCellWidths().rowHeight,e=t.calculateCellWidths().columnWidths,f=e.length,u||(u=4),i=n[0];i<u+n[0];i++)r.XLResize.setRowHeight(i,o);if(f>0)for(i=0;i<f+n[1];i++)r.XLResize.setColWidth(i+n[1],e[i]);else for(i=0;i<3+n[1];i++)r.XLResize.setColWidth(i+n[1],81);h._isFreezed&&(r.XLFreeze._refreshFreezeRowDiv(),r.XLFreeze._refreshFreezeColDiv())},_refreshPivotElement:function(i,r,u,f,e){var o=this.XLObj,s,h,c,l,a;l=o.model.sheets[e.sheetIdx]._rowHeightCollection[e.pvtRange[0]];a=o.model.sheets[e.sheetIdx]._colWidthCollection[e.pvtRange[1]];c={dataSource:{data:e.datasource},enableToolTipAnimation:!1,cellDoubleClick:n.proxy(this._cellDblClick,this),enableCellDoubleClick:!0,renderSuccess:n.proxy(this._renderSuccess,this),drillSuccess:n.proxy(this._renderSuccess,this)};t.isNullOrUndefined(f)||(c.dataSource={data:e.datasource,rows:f.rows,columns:f.columns,values:f.values,filters:f.filters});o.getSheetElement(o.getActiveSheetIndex()).find(".e-ss-activepivot").removeClass("e-ss-activepivot");s=t.buildTag("div.e-ss-pivot","","",{id:o._id+"_"+u});s.css({left:a-2,top:l-2}).addClass("e-ss-activepivot");o._getContent(e.sheetIdx).find(".e-content").append(s);this._hasPvtField||o.getActivationPanel().append(t.buildTag("div","",{overflow:"hidden"},{id:o._id+"_PivotField"}));o.element.find("#"+o._id+"_PivotField").append(t.buildTag("div.e-ss-pivotfield","","",{id:o._id+"_PivotTableSchema_"+o._id+"_"+u}));h=o.element.find("#"+o._id+"_PivotTableSchema_"+o._id+"_"+u);o.getActivationPanel().find("#"+h[0].id).show();s.ejPivotGrid(c);h.find("#"+o._id+"_PivotTableSchema_"+o._id+"_"+u+"_schemaFieldTree").data("ejTreeView").option("allowDragAndDrop",!1);h.css({float:"left",width:o.model.activationPanelWidth-20});h.find(".schemaFieldList").css({height:150});this._hasPvtField||(o.getActivationPanel().ejScroller({width:o.model.activationPanelWidth,height:o._getContent(e.sheetIdx).height(),scroll:n.proxy(this._pivotScroll,this)}),this._hasPvtField=!0);this._clearBackgroundData(s.data("ejPivotGrid"),o.getSheet(e.sheetIdx).pivotMngr.pivot[s[0].id],e.sheetIdx,"update");o.XLRibbon&&o.XLRibbon._analyzeTabUpdate();o.XLSelection._cleanUp(!0);o.getActivationPanel().data("ejScroller").refresh()},deletePivotTable:function(n){var o,u=this._getPivotIDFromName(n),t=this.XLObj,f,e=t._dataContainer,r,i;if(t.model.enablePivotTable&&!t.model.isReadOnly)for(i=1,o=t.model.sheetCount;i<=o;i++)t._getContent(i).find("#"+u).length&&(r=t.getSheet(i).pivotMngr.pivot[u],f=e.sheets[i][r.rowIndex][r.colIndex],t.getObjectLength(f)<2&&f.pivot.length<2?delete e.sheets[i][r.rowIndex][r.colIndex]:f.pivot.length<2&&delete e.sheets[i][r.rowIndex][r.colIndex].pivot,delete t.getSheet(i).pivotMngr.pivot[u],t._getContent(i).find("#"+u).remove(),t.hideActivationPanel(),t.getActivationPanel().find("#"+t._id+"_PivotTableSchema_"+u).remove(),t.XLRibbon._toggleAnalyzeTab(),t._trigActionComplete({ID:u,rowIndex:r.rowIndex,colIndex:r.colIndex,reqType:"shape",shapeType:"pivot",sheetIndex:i}))},refreshDataSource:function(n,t){var i=this.XLObj,r,f,e,u,o;i.model.enablePivotTable&&!i.model.isReadOnly&&(n&&t?(r=i.element.find("#"+i._id+"_"+n),r&&(f=r[0].id)):(t=i.getActiveSheetIndex(),r=i._getContent(t).find(".e-ss-activepivot"),f=r[0].id),e=r.data("ejPivotGrid"),e&&(u=i.getSheet(t).pivotMngr.pivot[f].dataRange,o=i.getRangeDataAsJSON({rowIndex:u[0],colIndex:u[1]},{rowIndex:u[2],colIndex:u[3]},!1,i._getSheetIndexByName(i.getSheet(t).pivotMngr.pivot[f].dataSheetName)),e.model.dataSource.data=o,e.refreshPivotGrid()))},clearPivotFieldList:function(n){var t=this.XLObj,i=this._getPivotIDFromName(n);t.model.enablePivotTable&&!t.model.isReadOnly&&this._clearFilters(t.element.find("#"+i).data("ejPivotGrid"),t.getActivationPanel().find("#"+t._id+"_PivotTableSchema_"+i).data("ejPivotSchemaDesigner"))},_cellDblClick:function(n){if(n.selectedData.length){var t=this.XLObj,i=t.XLFormat,r;t.insertSheet();r=t.getActiveSheetIndex();t.updateRange(r,{dataSource:n.selectedData,startCell:"A1",showHeader:!0});i.createTable({header:!0,name:"Table"+t._tableCnt,format:i._getTableLayoutFromName("TableStyleMedium9").format,formatName:"TableStyleMedium9"},"A1:"+t._generateHeaderText(t.getObjectLength(n.selectedData[0]))+(n.selectedData.length+1))}},_dragMove:function(){var i=this.XLObj,t,r=i.getActivationPanel().data("ejScroller"),f=i.element.find(".e-spreadsheetactpanel"),u=f.offset().top;f.height()+u-45<n(".e-dragedNode").offset().top?t=setInterval(function(){f.height()+u-45<n(".e-dragedNode").offset().top&&r.scrollY(r.model.scrollTop+25)},300):u+45>n(".e-dragedNode").offset().top&&(t=setInterval(function(){u+45>n(".e-dragedNode").offset().top&&r.scrollY(r.model.scrollTop-25)},300));i._browserDetails.name==="msie"&&i._browserDetails.version==="8.0"?(n(".e-dragedNode")[0].attachEvent("onmouseup",function(){clearInterval(t)}),document.attachEvent("onmouseup",function(){clearInterval(t)})):(n(".e-dragedNode")[0].addEventListener("mouseup",function(){clearInterval(t)}),document.addEventListener("mouseup",function(){clearInterval(t)}))},_renderSuccess:function(i){i.type==="drillSuccess"&&(i=i.gridObj);var r=this.XLObj,e=r.getActiveSheetIndex(),o,s,u,f=i,h=[];r._isExport||this._clearBackgroundData(i,r.getSheet(e).pivotMngr.pivot[i._id],e,"update");r.element.find("#"+r._id+"_PivotTableSchema_"+i._id).ejPivotSchemaDesigner({pivotControl:i,layout:t.PivotSchemaDesigner.Layouts.Excel,dragMove:n.proxy(this._dragMove,this),fieldItemDropped:n.proxy(this._fieldItemDropped,this)});u=r.getSheet(e).pivotMngr.pivot[i._id];s=f._rowCount;o=f.getJSONRecords().length/f._rowCount;h=[u.rowIndex,u.colIndex,u.rowIndex+s,u.colIndex+o];this._refreshRowColumn(h,f);n(".e-spreadsheet .e-pivotgrid th[role='columnheader'").addClass("e-ss-pivottableheader");n(".e-spreadsheet .e-pivotgrid tr:last th.rgtot").addClass("e-ss-pivottableheader");r.XLDragFill.hideAutoFillElement()},_clearBackgroundData:function(n,t,i,r){var u=this.XLObj,f,e,o,s;f=n.getJSONRecords().length/n._rowCount;e=n._rowCount;o=!e||isNaN(e)?t.rowIndex+17:t.rowIndex+e;s=!f||isNaN(f)?t.colIndex+2:t.colIndex+f-1;r&&r!=="update"?u.getRange([t.rowIndex,t.colIndex,o,s],i).removeClass("e-readOnly"):u.getRange([t.rowIndex,t.colIndex,o,s],i).removeClass("e-readOnly").addClass("e-readonly");u._dupDetails=!0;u.clearRangeData([t.rowIndex,t.colIndex,o,s],["value","value2","hyperlink","cFormatRule","comment","format","formats"],"",!1);u._dupDetails=!1},_fieldItemDropped:function(n){if(n.axis==="filter"){var t=this.XLObj,u=t.getActiveSheetIndex(),r,i;for(i=t._getContent(u).find(".e-ss-activepivot").data("ejPivotGrid"),pivot=t.getSheet(u).pivotMngr.pivot[i._id];pivot.rowIndex<=i.getOlapReport().filters.length;)pivot.rowIndex=pivot.rowIndex+1,r=t.getCell(pivot.rowIndex,pivot.colIndex)[0],i.element.css({left:r.offsetLeft-2,top:r.offsetTop-2})}},_updatePivotMngr:function(t,i){var r=this.XLObj,u=r.getSheet(r.getActiveSheetIndex()).pivotMngr,f=u.pivot;f[i.pivot.id]=n.extend(!0,{},i.pivot);r.XLEdit._updateDataContainer({rowIndex:i.pivot.rowIndex,colIndex:i.pivot.colIndex},{dataObj:{pivot:i.pivot.id}})},_pivotMouseDown:function(t){var i=this.XLObj;t.preventDefault();i.getActivationPanel().find("#"+i._id+"_PivotTableSchema_"+t.target.id).show();i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot").removeClass("e-ss-activepivot");n(t.target).hasClass("e-ss-pivot")?n(t.target).addClass("e-ss-activepivot"):n(t.target).parents("e-ss-object").addClass("e-ss-activepivot");i.XLSelection._cleanUp(!0);i.showActivationPanel()},_pivotScroll:function(t){var i=this.XLObj,r=i.getActivationPanel().find("#"+i._id+"_PivotTableSchema_"+i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id).data("ejPivotSchemaDesigner");t.source==="thumb"&&(n(".e-dragedNode").length||r._isDragging||this.XLObj.XLResize._allowStart)&&(t.cancel=!0)},_pivotMouseUp:function(t){var i=this.XLObj,r=n(t.target),u=n("#"+i._id+"_Ribbon").data("ejRibbon");i.model.showRibbon&&(i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot").length&&(r.hasClass("e-ss-pivot")||r.parents(".e-ss-pivot").length)?i.XLRibbon._analyzeTabUpdate():!i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot").length&&(u.model.selectedItemIndex===i.XLRibbon._getTabIndex("analyze")||u.isVisible("Analyze"))&&i.XLRibbon._toggleAnalyzeTab())},_changePvtName:function(){var n=this.XLObj,r=n.element.find("#"+n._id+"_Ribbon_Analyze_PivotTable_PivotTableName").val(),t=n.getActiveSheetIndex(),i=n._getContent(t).find(".e-ss-activepivot")[0].id;n.getSheet(t).pivotMngr.pivot[i].tableName=this.names[i]=r;n._trigActionComplete({pvtName:r,reqType:"shape",shapeType:"pivot",sheetIndex:t,ID:i})},_checkRange:function(n,t){var i=this.XLObj,g=i.getActiveCell(),y,p=g.rowIndex,w=g.colIndex,b,r=[],k=i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot"),e,u,h,c={isHeader:!1,isRows:!1},d,s,o,nt,l,a,v,tt,it,f;if(e=i.XLRibbon._getAddrFromDollarAddr(n),y=e[0],r=i.getRangeIndices(e[1]),p=r[0],w=r[1],n.length)for(u=0,h=r[3]-w+1;u<h;u++)b=i.XLEdit.getPropertyValue(p,w+u,"value",y),(i.isUndefined(b)||b=="")&&(c.isHeader=!0);if(p===r[2]&&(c.isRows=!0),t.length)for(e=i.XLRibbon._getAddrFromDollarAddr(t),y=e[0],r=i.getRangeIndices(e[1]),u=1,h=i.model.sheetCount;u<=h;u++)for(d=i.model.sheets[u].pivotMngr.pivot,s=i.getObjectKeys(d),o=0,nt=s.length;o<nt;o++)if((!k.length||k.length&&s[o]!==k[0].id)&&(l=i.element.find("#"+s[o]).data("ejPivotGrid"),f=d[s[o]],a=l.getJSONRecords().length/l.rowCount,v=l.rowCount,tt=!v||isNaN(v)?f.rowIndex+17:f.rowIndex+v-1,it=!a||isNaN(a)?f.colIndex+2:f.colIndex+a-1,r[0]>=f.rowIndex&&r[0]<=tt&&r[1]>=f.colIndex&&r[1]<=it)){c.isOverlap=!0;break}return c},_updateSheetName:function(n){for(var t=this.XLObj,i,u,f,o,s=t.getSheet(t.getActiveSheetIndex()).sheetInfo.text,r=1,e=t.model.sheetCount;r<=e;r++)for(u=t.getSheet(r).pivotMngr.pivot,f=t.getObjectKeys(u),i=0,o=f.length;i<o;i++)u[f[i]].dataSheetName===s&&(u[f[i]].dataSheetName=n)},_getSheetIdxFromName:function(n){for(var i=this.XLObj,t=1,r=i.model.sheetCount;t<=r;t++)if(i.model.sheets[t].sheetInfo.text==n)return t},_changeDataSource:function(){var i,t=this.XLObj,s=t.getActiveSheetIndex(),r=t._getContent(s).find(".e-ss-activepivot")[0].id,o=n("#"+r).data("ejPivotGrid"),h,u,c,f,e;u=t.XLRibbon._getAddrFromDollarAddr(n("#"+t._id+"_Ribbon_PvtRange").val());c=t.model.sheets[u[0]].sheetInfo.text;i=t.getRangeIndices(u[1]);e=t.getSheet(t.getActiveSheetIndex()).pivotMngr.pivot[r];e.dataRange=i;e.dataSheetName=c;f=t.getRangeDataAsJSON({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]},!1,u[0]);o.getOlapReport().data=f;h=n("#"+t._id+"_PivotTableSchema_"+r).data("ejPivotSchemaDesigner");o.model.dataSource.data=f;this._clearFilters(o,h);t._trigActionComplete({sheetIndex:s,dataRange:e.dataRange,ID:r,pvtData:f,reqType:"shape",shapeType:"pivot"})},_getPivotIDFromName:function(n){for(var t in this.names)if(n===this.names[t])return t},_clearFilters:function(t,i){var u=this.XLObj,r=t.getOlapReport();r.rows=[];r.columns=[];r.values=[];r.filters=[];t.refreshPivotGrid();i.model.pivotControl=t;n(i.element).html("");i._load();u._refreshActivationPanel()},_movePivotTable:function(){var t=this.XLObj,u=t.getActiveSheetIndex(),f=t._getContent(u).find(".e-ss-activepivot"),o=f[0].id,r,s=f.data("ejPivotGrid"),a,h,e,c,i,l,v=!0,y,w,b,p;if(r=t.getSheet(u).pivotMngr.pivot[o],n("#"+t._id+"_dlg_existsheet").data("ejRadioButton").model.checked?(v=!1,a=n("#"+t._id+"_Ribbon_PvtLocation").val().split("!"),h=this._getSheetIdxFromName(a[0]),i=t.getRangeIndices(t.XLRibbon._getAddrFromDollarAddr(a[1])[1]),u!==h&&(t._getContent(h).find(".e-content").append(f),t.gotoPage(h,!1),t.XLSelection._cleanUp(!0),v=!0),r.rowIndex=i[0],r.colIndex=i[1]):(t.insertSheet(),u=t.getActiveSheetIndex(),t._getContent(u).find(".e-content").append(f),i=[2,0]),v&&(l=t.getActiveSheetIndex(),t.getSheet(l).pivotMngr.pivot[o]={},n.extend(!0,t.getSheet(l).pivotMngr.pivot[o],r),l!==u&&delete t.getSheet(u).pivotMngr.pivot[o]),c=t.getCell(i[0],i[1]),!c&&t.model.scrollSettings.allowVirtualScrolling&&(p=t.getSheet(t.getActiveSheetIndex()),t._scrollContent({y:p._rowHeightCollection[i[0]+1]-p._scrollTop}),c=t.getCell(i[0],i[1])),e=c[0],f.css({left:e.offsetLeft-2,top:e.offsetTop-2}),s.getOlapReport().filters.length)while(r.rowIndex<=s.getOlapReport().filters.length)r.rowIndex=r.rowIndex+1,e=t.getCell(r.rowIndex,r.colIndex)[0],f.css({left:e.offsetLeft-2,top:e.offsetTop-2});b=s._rowCount;w=s.calculateCellWidths().columnWidths.length;y=[i[0],i[1],i[0]+b,i[1]+w];this._refreshRowColumn(y,s);t._trigActionComplete({sheetIndex:u,newRange:y,ID:o,reqType:"shape",shapeType:"pivot"})}}}(jQuery,Syncfusion)});
